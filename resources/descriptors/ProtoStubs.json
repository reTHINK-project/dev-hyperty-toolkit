{
  "VertxProtoStub": {
    "cguid": "4-6f652c34-f0d9-fb93-9407-7f3e29ded6aa0",
    "type": "ProtoStubs",
    "version": 1.0999999999999999,
    "sourcePackageURL": "/sourcePackage",
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiYWN0aXZhdGUiLCBbXSwgZmFjdG9yeSk7CgllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JykKCQlleHBvcnRzWyJhY3RpdmF0ZSJdID0gZmFjdG9yeSgpOwoJZWxzZQoJCXJvb3RbImFjdGl2YXRlIl0gPSBmYWN0b3J5KCk7Cn0pKHRoaXMsIGZ1bmN0aW9uKCkgewpyZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsKCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewoKLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7CgovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewovKioqKioqLyAJCQlleHBvcnRzOiB7fSwKLyoqKioqKi8gCQkJaWQ6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsb2FkZWQ6IGZhbHNlCi8qKioqKiovIAkJfTsKCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7CgovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubG9hZGVkID0gdHJ1ZTsKCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9CgoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwoKLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwovKioqKioqLyB9KQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAoWwovKiAwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsKCglleHBvcnRzLmRlZmF1bHQgPSBhY3RpdmF0ZTsKCglmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCgkvKioKCSogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCgkqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoJKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKCSogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSoKCSogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkqCgkqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkqCgkqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkqKi8KCgl2YXIgVmVydHhQcm90b1N0dWIgPSBmdW5jdGlvbiAoKSB7CgkgIC8qIHByaXZhdGUKCSAgICBfY29udGludW91c09wZW46IGJvb2xlYW4KCSAgICAgX3J1bnRpbWVQcm90b1N0dWJVUkw6IHN0cmluZwoJICAgIF9idXM6IE1pbmlCdXMKCSAgICBfbXNnQ2FsbGJhY2s6IChNZXNzYWdlKSA9PiB2b2lkCgkgICAgX2NvbmZpZzogeyB1cmwsIHJ1bnRpbWVVUkwgfQoJICAgICBfc29jazogKFdlYlNvY2tldCB8IFNvY2tKUykKCSAgICBfcmVPcGVuOiBib29sZWFuCgkgICovCgoJICAvKioKCSAgICogVmVydHggUHJvdG9TdHViIGNyZWF0aW9uCgkgICAqIEBwYXJhbSAge3N0cmluZ30gcnVudGltZVByb3RvU3R1YlVSTCAtIFVSTCB1c2VkIGludGVybmFsbHkgZm9yIG1lc3NhZ2UgZGVsaXZlcnkgcG9pbnQuIE5vdCB1c2VkIGZvciBNZXNzYWdlTm9kZSBkZWxpdmVyLgoJICAgKiBAcGFyYW0gIHtNaW5pQnVzfSBidXMgLSBNaW5pQnVzIHVzZWQgdG8gc2VuZC9yZWNlaXZlIG1lc3NhZ2VzLiBOb3JtYWxseSBjb25uZWN0ZWQgdG8gdGhlIE1lc3NhZ2VCdXMuCgkgICAqIEBwYXJhbSAge09iamVjdH0gY29uZmlnIC0gTWFuZGF0b3J5IGZpZWxkcyBhcmU6ICJ1cmwiIG9mIHRoZSBNZXNzYWdlTm9kZSBhZGRyZXNzIGFuZCAicnVudGltZVVSTCIuCgkgICAqIEByZXR1cm4ge1ZlcnR4UHJvdG9TdHVifQoJICAgKi8KCSAgZnVuY3Rpb24gVmVydHhQcm90b1N0dWIocnVudGltZVByb3RvU3R1YlVSTCwgYnVzLCBjb25maWcpIHsKCSAgICB2YXIgX3RoaXMyID0gdGhpczsKCgkgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZlcnR4UHJvdG9TdHViKTsKCgkgICAgaWYgKCFydW50aW1lUHJvdG9TdHViVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBydW50aW1lUHJvdG9TdHViVVJMIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoJICAgIGlmICghYnVzKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBidXMgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CgkgICAgaWYgKCFjb25maWcpIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZyBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCgkgICAgaWYgKCFjb25maWcudXJsKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWcudXJsIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoJICAgIGlmICghY29uZmlnLnJ1bnRpbWVVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZy5ydW50aW1lVVJMIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoKCSAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICB0aGlzLl9pZCA9IDA7CgkgICAgdGhpcy5fY29udGludW91c09wZW4gPSB0cnVlOwoKCSAgICB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMID0gcnVudGltZVByb3RvU3R1YlVSTDsKCSAgICB0aGlzLl9idXMgPSBidXM7CgkgICAgdGhpcy5fY29uZmlnID0gY29uZmlnOwoKCSAgICB0aGlzLl9ydW50aW1lU2Vzc2lvblVSTCA9IGNvbmZpZy5ydW50aW1lVVJMOwoJICAgIHRoaXMuX3JlT3BlbiA9IGZhbHNlOwoKCSAgICBidXMuYWRkTGlzdGVuZXIoJyonLCBmdW5jdGlvbiAobXNnKSB7CgkgICAgICBfdGhpcy5fb3BlbihmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmIChfdGhpcy5fZmlsdGVyKG1zZykpIHsKCSAgICAgICAgICBtc2cuYm9keS52aWEgPSBfdGhpczIuX3J1bnRpbWVQcm90b1N0dWJVUkw7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tWZXJ0eFByb3RvU3R1YjogUHJvdG9TdHViIC0+IE1OXScsIG1zZyk7CgkgICAgICAgICAgX3RoaXMuX3NvY2suc2VuZChKU09OLnN0cmluZ2lmeShtc2cpKTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfSk7CgoJICAgIF90aGlzLl9zZW5kU3RhdHVzKCdjcmVhdGVkJyk7CgkgIH0KCgkgIC8qKgoJICAgKiBHZXQgdGhlIGNvbmZpZ3VyYXRpb24gZm9yIHRoaXMgUHJvdG9TdHViCgkgICAqIEByZXR1cm4ge09iamVjdH0gLSBNYW5kYXRvcnkgZmllbGRzIGFyZTogInVybCIgb2YgdGhlIE1lc3NhZ2VOb2RlIGFkZHJlc3MgYW5kICJydW50aW1lVVJMIi4KCSAgICovCgoKCSAgX2NyZWF0ZUNsYXNzKFZlcnR4UHJvdG9TdHViLCBbewoJICAgIGtleTogJ2Nvbm5lY3QnLAoKCgkgICAgLyoqCgkgICAgICogVHJ5IHRvIG9wZW4gdGhlIGNvbm5lY3Rpb24gdG8gdGhlIE1lc3NhZ2VOb2RlLiBDb25uZWN0aW9uIGlzIGF1dG8gbWFuYWdlZCwgdGhlcmUgaXMgbm8gbmVlZCB0byBjYWxsIHRoaXMgZXhwbGljaXRseS4KCSAgICAgKiBIb3dldmVyLCBpZiAiZGlzY29ubmVjdCgpIiBpcyBjYWxsZWQsIGl0J3MgbmVjZXNzYXJ5IHRvIGNhbGwgdGhpcyB0byBlbmFibGUgY29ubmVjdGlvbnMgYWdhaW4uCgkgICAgICogQSBzdGF0dXMgbWVzc2FnZSBpcyBzZW50IHRvICJydW50aW1lUHJvdG9TdHViVVJML3N0YXR1cyIsIGNvbnRhaW5pbmcgdGhlIHZhbHVlICJjb25uZWN0ZWQiIGlmIHN1Y2Nlc3NmdWwsIG9yICJkaXNjb25uZWN0ZWQiIGlmIHNvbWUgZXJyb3Igb2NjdXJzLgoJICAgICAqLwoJICAgIHZhbHVlOiBmdW5jdGlvbiBjb25uZWN0KCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBfdGhpcy5fY29udGludW91c09wZW4gPSB0cnVlOwoJICAgICAgX3RoaXMuX29wZW4oZnVuY3Rpb24gKCkge30pOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogSXQgd2lsbCBkaXNjb25uZWN0IGFuZCBvcmRlciB0byBzdGF5IGRpc2Nvbm5lY3RlZC4gUmVjb25uZWN0aW9uIHRyaWVzLCB3aWxsIG5vdCBiZSBhdHRlbXB0ZWQsIHVubGVzcyAiY29ubmVjdCgpIiBpcyBjYWxsZWQuCgkgICAgICogQSBzdGF0dXMgbWVzc2FnZSBpcyBzZW50IHRvICJydW50aW1lUHJvdG9TdHViVVJML3N0YXR1cyIgd2l0aCB2YWx1ZSAiZGlzY29ubmVjdGVkIi4KCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdkaXNjb25uZWN0JywKCSAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY29ubmVjdCgpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2Rpc2Nvbm5lY3RlZCcpOwoKCSAgICAgIF90aGlzLl9jb250aW51b3VzT3BlbiA9IGZhbHNlOwoJICAgICAgaWYgKF90aGlzLl9zb2NrKSB7CgkgICAgICAgIF90aGlzLl9zZW5kQ2xvc2UoKTsKCSAgICAgIH0KCSAgICB9CgoJICAgIC8vdG9kbzogYWRkIGRvY3VtZW50YXRpb24KCgkgIH0sIHsKCSAgICBrZXk6ICdfc2VuZE9wZW4nLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VuZE9wZW4oY2FsbGJhY2spIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgdGhpcy5fc2VuZFN0YXR1cygnaW4tcHJvZ3Jlc3MnKTsKCgkgICAgICBfdGhpcy5faWQrKzsKCSAgICAgIHZhciBtc2cgPSB7CgkgICAgICAgIGlkOiBfdGhpcy5faWQsIHR5cGU6ICdvcGVuJywgZnJvbTogX3RoaXMuX3J1bnRpbWVTZXNzaW9uVVJMLCB0bzogJ21uOi9zZXNzaW9uJwoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX3JlT3BlbikgewoJICAgICAgICBtc2cudHlwZSA9ICdyZS1vcGVuJzsKCSAgICAgIH0KCgkgICAgICAvL3JlZ2lzdGVyIGFuZCB3YWl0IGZvciBvcGVuIHJlcGx5Li4uCgkgICAgICB2YXIgaGFzUmVzcG9uc2UgPSBmYWxzZTsKCSAgICAgIF90aGlzLl9zZXNzaW9uQ2FsbGJhY2sgPSBmdW5jdGlvbiAocmVwbHkpIHsKCSAgICAgICAgaWYgKHJlcGx5LnR5cGUgPT09ICdyZXNwb25zZScgJiByZXBseS5pZCA9PT0gbXNnLmlkKSB7CgkgICAgICAgICAgaGFzUmVzcG9uc2UgPSB0cnVlOwoJICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewoJICAgICAgICAgICAgaWYgKHJlcGx5LmJvZHkucnVudGltZVRva2VuKSB7CgkgICAgICAgICAgICAgIC8vc2V0dXAgcnVudGltZVNlc3Npb24KCSAgICAgICAgICAgICAgX3RoaXMuX3JlT3BlbiA9IHRydWU7CgkgICAgICAgICAgICAgIF90aGlzLl9ydW50aW1lU2Vzc2lvblVSTCA9IF90aGlzLl9jb25maWcucnVudGltZVVSTCArICcvJyArIHJlcGx5LmJvZHkucnVudGltZVRva2VuOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIF90aGlzLl9zZW5kU3RhdHVzKCdsaXZlJyk7CgkgICAgICAgICAgICBjYWxsYmFjaygpOwoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygnZmFpbGVkJywgcmVwbHkuYm9keS5kZXNjKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgIH07CgoJICAgICAgX3RoaXMuX3NvY2suc2VuZChKU09OLnN0cmluZ2lmeShtc2cpKTsKCSAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewoJICAgICAgICBpZiAoIWhhc1Jlc3BvbnNlKSB7CgkgICAgICAgICAgLy9ubyByZXNwb25zZSBhZnRlciB4IHNlY29uZHMuLi4KCSAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygnZGlzY29ubmVjdGVkJywgJ1RpbWVvdXQgZnJvbSBtbjovc2Vzc2lvbicpOwoJICAgICAgICB9CgkgICAgICB9LCAzMDAwKTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfc2VuZENsb3NlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRDbG9zZSgpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX2lkKys7CgkgICAgICB2YXIgbXNnID0gewoJICAgICAgICBpZDogX3RoaXMuX2lkLCB0eXBlOiAnY2xvc2UnLCBmcm9tOiBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwsIHRvOiAnbW46L3Nlc3Npb24nCgkgICAgICB9OwoKCSAgICAgIC8vaW52YWxpZGF0ZSBydW50aW1lU2Vzc2lvbgoJICAgICAgX3RoaXMuX3JlT3BlbiA9IGZhbHNlOwoJICAgICAgX3RoaXMuX3J1bnRpbWVTZXNzaW9uVVJMID0gX3RoaXMuX2NvbmZpZy5fcnVudGltZVVSTDsKCgkgICAgICBfdGhpcy5fc29jay5zZW5kKEpTT04uc3RyaW5naWZ5KG1zZykpOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19zZW5kU3RhdHVzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRTdGF0dXModmFsdWUsIHJlYXNvbikgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBjb25zb2xlLmxvZygnW1ZlcnR4UHJvdG9zdHViIHN0YXR1cyBjaGFuZ2VkXSB0byAnLCB2YWx1ZSk7CgoJICAgICAgX3RoaXMuX3N0YXRlID0gdmFsdWU7CgoJICAgICAgdmFyIG1zZyA9IHsKCSAgICAgICAgdHlwZTogJ3VwZGF0ZScsCgkgICAgICAgIGZyb206IF90aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMLAoJICAgICAgICB0bzogX3RoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgKyAnL3N0YXR1cycsCgkgICAgICAgIGJvZHk6IHsKCSAgICAgICAgICB2YWx1ZTogdmFsdWUKCSAgICAgICAgfQoJICAgICAgfTsKCgkgICAgICBpZiAocmVhc29uKSB7CgkgICAgICAgIG1zZy5ib2R5LmRlc2MgPSByZWFzb247CgkgICAgICB9CgoJICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShtc2cpOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ193YWl0UmVhZHknLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfd2FpdFJlYWR5KGNhbGxiYWNrKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGlmIChfdGhpcy5fc29jay5yZWFkeVN0YXRlID09PSAxKSB7CgkgICAgICAgIGNhbGxiYWNrKCk7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICBfdGhpcy5fd2FpdFJlYWR5KGNhbGxiYWNrKTsKCSAgICAgICAgfSk7CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2ZpbHRlcicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9maWx0ZXIobXNnKSB7CgkgICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkudmlhID09PSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgIH0KCgkgICAgICBkZWxldGUgbXNnLmJvZHkudmlhOwoJICAgICAgcmV0dXJuIHRydWU7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2RlbGl2ZXInLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsaXZlcihtc2cpIHsKCSAgICAgIGlmICghbXNnLmJvZHkpIG1zZy5ib2R5ID0ge307CgoJICAgICAgbXNnLmJvZHkudmlhID0gdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTDsKCSAgICAgIGNvbnNvbGUubG9nKCdbVmVydHhQcm90b1N0dWI6IE1OIC0+IFByb3RvU3R1Yl0nLCBtc2cpOwoJICAgICAgdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1zZyk7CgkgICAgfQoKCSAgICAvLyBhZGQgZG9jdW1lbnRhdGlvbgoKCSAgfSwgewoJICAgIGtleTogJ19vcGVuJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29wZW4oY2FsbGJhY2spIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgaWYgKCF0aGlzLl9jb250aW51b3VzT3BlbikgewoJICAgICAgICAvL1RPRE86IHNlbmQgc3RhdHVzIChzZW50IG1lc3NhZ2UgZXJyb3IgLSBkaXNjb25uZWN0ZWQpCgkgICAgICAgIHJldHVybjsKCSAgICAgIH0KCgkgICAgICBpZiAoIV90aGlzLl9zb2NrKSB7CgkgICAgICAgIGlmIChfdGhpcy5fY29uZmlnLnVybC5zdWJzdHJpbmcoMCwgMikgPT09ICd3cycpIHsKCSAgICAgICAgICBfdGhpcy5fc29jayA9IG5ldyBXZWJTb2NrZXQoX3RoaXMuX2NvbmZpZy51cmwpOwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgIF90aGlzLl9zb2NrID0gbmV3IFNvY2tKUyhfdGhpcy5fY29uZmlnLnVybCk7CgkgICAgICAgIH0KCgkgICAgICAgIF90aGlzLl9zb2NrLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICBfdGhpcy5fc2VuZE9wZW4oZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgY2FsbGJhY2soKTsKCSAgICAgICAgICB9KTsKCSAgICAgICAgfTsKCgkgICAgICAgIF90aGlzLl9zb2NrLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgdmFyIG1zZyA9IEpTT04ucGFyc2UoZS5kYXRhKTsKCSAgICAgICAgICBjb25zb2xlLmxvZygnW1ZlcnR4UHJvdG9TdHViOiBNTiAtPiBTT0NLRVQgT04gTUVTU0FHRV0nLCBtc2cpOwoJICAgICAgICAgIGlmIChtc2cuZnJvbSA9PT0gJ21uOi9zZXNzaW9uJykgewoJICAgICAgICAgICAgaWYgKF90aGlzLl9zZXNzaW9uQ2FsbGJhY2spIHsKCSAgICAgICAgICAgICAgX3RoaXMuX3Nlc3Npb25DYWxsYmFjayhtc2cpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBpZiAoX3RoaXMuX2ZpbHRlcihtc2cpKSB7CgkgICAgICAgICAgICAgIF90aGlzLl9kZWxpdmVyKG1zZyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfQoJICAgICAgICB9OwoKCSAgICAgICAgX3RoaXMuX3NvY2sub25jbG9zZSA9IGZ1bmN0aW9uIChldmVudCkgewoJICAgICAgICAgIHZhciByZWFzb24gPSB2b2lkIDA7CgoJICAgICAgICAgIC8vU2VlIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM2NDU1I3NlY3Rpb24tNy40CgkgICAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDApIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdOb3JtYWwgY2xvc3VyZSwgbWVhbmluZyB0aGF0IHRoZSBwdXJwb3NlIGZvciB3aGljaCB0aGUgY29ubmVjdGlvbiB3YXMgZXN0YWJsaXNoZWQgaGFzIGJlZW4gZnVsZmlsbGVkLic7CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDAxKSB7CgkgICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgXCdnb2luZyBhd2F5XCcsIHN1Y2ggYXMgYSBzZXJ2ZXIgZ29pbmcgZG93biBvciBhIGJyb3dzZXIgaGF2aW5nIG5hdmlnYXRlZCBhd2F5IGZyb20gYSBwYWdlLic7CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDAyKSB7CgkgICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gZHVlIHRvIGEgcHJvdG9jb2wgZXJyb3InOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwMykgewoJICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgaGFzIHJlY2VpdmVkIGEgdHlwZSBvZiBkYXRhIGl0IGNhbm5vdCBhY2NlcHQgKGUuZy4sIGFuIGVuZHBvaW50IHRoYXQgdW5kZXJzdGFuZHMgb25seSB0ZXh0IGRhdGEgTUFZIHNlbmQgdGhpcyBpZiBpdCByZWNlaXZlcyBhIGJpbmFyeSBtZXNzYWdlKS4nOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwNCkgewoJICAgICAgICAgICAgcmVhc29uID0gJ1Jlc2VydmVkLiBUaGUgc3BlY2lmaWMgbWVhbmluZyBtaWdodCBiZSBkZWZpbmVkIGluIHRoZSBmdXR1cmUuJzsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDUpIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdObyBzdGF0dXMgY29kZSB3YXMgYWN0dWFsbHkgcHJlc2VudC4nOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwNikgewoJICAgICAgICAgICAgcmVhc29uID0gJ1RoZSBjb25uZWN0aW9uIHdhcyBjbG9zZWQgYWJub3JtYWxseSwgZS5nLiwgd2l0aG91dCBzZW5kaW5nIG9yIHJlY2VpdmluZyBhIENsb3NlIGNvbnRyb2wgZnJhbWUnOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwNykgewoJICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgaGFzIHJlY2VpdmVkIGRhdGEgd2l0aGluIGEgbWVzc2FnZSB0aGF0IHdhcyBub3QgY29uc2lzdGVudCB3aXRoIHRoZSB0eXBlIG9mIHRoZSBtZXNzYWdlIChlLmcuLCBub24tVVRGLTggW2h0dHA6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzM2MjldIGRhdGEgd2l0aGluIGEgdGV4dCBtZXNzYWdlKS4nOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwOCkgewoJICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgaGFzIHJlY2VpdmVkIGEgbWVzc2FnZSB0aGF0ICJ2aW9sYXRlcyBpdHMgcG9saWN5Ii4gVGhpcyByZWFzb24gaXMgZ2l2ZW4gZWl0aGVyIGlmIHRoZXJlIGlzIG5vIG90aGVyIHN1dGlibGUgcmVhc29uLCBvciBpZiB0aGVyZSBpcyBhIG5lZWQgdG8gaGlkZSBzcGVjaWZpYyBkZXRhaWxzIGFib3V0IHRoZSBwb2xpY3kuJzsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDkpIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGhhcyByZWNlaXZlZCBhIG1lc3NhZ2UgdGhhdCBpcyB0b28gYmlnIGZvciBpdCB0byBwcm9jZXNzLic7CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDEwKSB7CgkgICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgKGNsaWVudCkgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBoYXMgZXhwZWN0ZWQgdGhlIHNlcnZlciB0byBuZWdvdGlhdGUgb25lIG9yIG1vcmUgZXh0ZW5zaW9uLCBidXQgdGhlIHNlcnZlciBkaWRuXCd0IHJldHVybiB0aGVtIGluIHRoZSByZXNwb25zZSBtZXNzYWdlIG9mIHRoZSBXZWJTb2NrZXQgaGFuZHNoYWtlLiA8YnIgLz4gU3BlY2lmaWNhbGx5LCB0aGUgZXh0ZW5zaW9ucyB0aGF0IGFyZSBuZWVkZWQgYXJlOiAnICsgZXZlbnQucmVhc29uOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAxMSkgewoJICAgICAgICAgICAgcmVhc29uID0gJ0Egc2VydmVyIGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgZW5jb3VudGVyZWQgYW4gdW5leHBlY3RlZCBjb25kaXRpb24gdGhhdCBwcmV2ZW50ZWQgaXQgZnJvbSBmdWxmaWxsaW5nIHRoZSByZXF1ZXN0Lic7CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDE1KSB7CgkgICAgICAgICAgICByZWFzb24gPSAnVGhlIGNvbm5lY3Rpb24gd2FzIGNsb3NlZCBkdWUgdG8gYSBmYWlsdXJlIHRvIHBlcmZvcm0gYSBUTFMgaGFuZHNoYWtlIChlLmcuLCB0aGUgc2VydmVyIGNlcnRpZmljYXRlIGNhblwndCBiZSB2ZXJpZmllZCkuJzsKCSAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgcmVhc29uID0gJ1Vua25vd24gcmVhc29uJzsKCSAgICAgICAgICB9CgoJICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fc29jazsKCSAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygnZGlzY29ubmVjdGVkJywgcmVhc29uKTsKCSAgICAgICAgfTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIF90aGlzLl93YWl0UmVhZHkoY2FsbGJhY2spOwoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ2NvbmZpZycsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fY29uZmlnOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ3J1bnRpbWVTZXNzaW9uJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9ydW50aW1lU2Vzc2lvblVSTDsKCSAgICB9CgkgIH1dKTsKCgkgIHJldHVybiBWZXJ0eFByb3RvU3R1YjsKCX0oKTsKCglmdW5jdGlvbiBhY3RpdmF0ZSh1cmwsIGJ1cywgY29uZmlnKSB7CgkgIHJldHVybiB7CgkgICAgbmFtZTogJ1ZlcnR4UHJvdG9TdHViJywKCSAgICBpbnN0YW5jZTogbmV3IFZlcnR4UHJvdG9TdHViKHVybCwgYnVzLCBjb25maWcpCgkgIH07Cgl9CgoJLyoqCgkqIENhbGxiYWNrIHVzZWQgdG8gc2VuZCBtZXNzYWdlcwoJKiBAY2FsbGJhY2sgUG9zdE1lc3NhZ2UKCSogQHBhcmFtIHtNZXNzYWdlfSBtc2cgLSBNZXNzYWdlIHRvIHNlbmQKCSovCgoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9Ci8qKioqKiovIF0pCn0pOwo7",
      "sourceCodeClassname": "VertxProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "language": "javascript",
    "signature": "",
    "messageSchemas": "",
    "configuration": {
      "url": "wss://msg-node.hysmart.rethink.ptinovacao.pt/localhost/ws"
    },
    "constraints": {
      "browser": true
    },
    "policies": "",
    "dataObjects": [],
    "interworking": false,
    "description": "Description of VertxProtoStub",
    "objectName": "default",
    "accessControlPolicy": "somePolicy"
  },
  "VertxProtoStubNode": {
    "sourcePackage": {
      "sourceCode": "J3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gYWN0aXZhdGU7Cgp2YXIgX3dzID0gcmVxdWlyZSgnd3MnKTsKCnZhciBfd3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfd3MpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKdmFyIFZlcnR4UHJvdG9TdHViID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgIF9jb250aW51b3VzT3BlbjogYm9vbGVhbgogICAgIF9ydW50aW1lUHJvdG9TdHViVVJMOiBzdHJpbmcKICAgIF9idXM6IE1pbmlCdXMKICAgIF9tc2dDYWxsYmFjazogKE1lc3NhZ2UpID0+IHZvaWQKICAgIF9jb25maWc6IHsgdXJsLCBydW50aW1lVVJMIH0KICAgICBfc29jazogKFdlYlNvY2tldCB8IFNvY2tKUykKICAgIF9yZU9wZW46IGJvb2xlYW4KICAqLwoKICAvKioKICAgKiBWZXJ0eCBQcm90b1N0dWIgY3JlYXRpb24KICAgKiBAcGFyYW0gIHtzdHJpbmd9IHJ1bnRpbWVQcm90b1N0dWJVUkwgLSBVUkwgdXNlZCBpbnRlcm5hbGx5IGZvciBtZXNzYWdlIGRlbGl2ZXJ5IHBvaW50LiBOb3QgdXNlZCBmb3IgTWVzc2FnZU5vZGUgZGVsaXZlci4KICAgKiBAcGFyYW0gIHtNaW5pQnVzfSBidXMgLSBNaW5pQnVzIHVzZWQgdG8gc2VuZC9yZWNlaXZlIG1lc3NhZ2VzLiBOb3JtYWxseSBjb25uZWN0ZWQgdG8gdGhlIE1lc3NhZ2VCdXMuCiAgICogQHBhcmFtICB7T2JqZWN0fSBjb25maWcgLSBNYW5kYXRvcnkgZmllbGRzIGFyZTogInVybCIgb2YgdGhlIE1lc3NhZ2VOb2RlIGFkZHJlc3MgYW5kICJydW50aW1lVVJMIi4KICAgKiBAcmV0dXJuIHtWZXJ0eFByb3RvU3R1Yn0KICAgKi8KICBmdW5jdGlvbiBWZXJ0eFByb3RvU3R1YihydW50aW1lUHJvdG9TdHViVVJMLCBidXMsIGNvbmZpZykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZlcnR4UHJvdG9TdHViKTsKCiAgICBpZiAoIXJ1bnRpbWVQcm90b1N0dWJVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIHJ1bnRpbWVQcm90b1N0dWJVUkwgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFjb25maWcpIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZyBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCiAgICBpZiAoIWNvbmZpZy51cmwpIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZy51cmwgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWNvbmZpZy5ydW50aW1lVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWcucnVudGltZVVSTCBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHRoaXMuX2lkID0gMDsKICAgIHRoaXMuX2NvbnRpbnVvdXNPcGVuID0gdHJ1ZTsKCiAgICB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMID0gcnVudGltZVByb3RvU3R1YlVSTDsKICAgIHRoaXMuX2J1cyA9IGJ1czsKICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZzsKCiAgICB0aGlzLl9ydW50aW1lU2Vzc2lvblVSTCA9IGNvbmZpZy5ydW50aW1lVVJMOwogICAgdGhpcy5fcmVPcGVuID0gZmFsc2U7CgogICAgYnVzLmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24gKG1zZykgewogICAgICBfdGhpcy5fb3BlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKF90aGlzLl9maWx0ZXIobXNnKSkgewogICAgICAgICAgX3RoaXMuX3NvY2suc2VuZChKU09OLnN0cmluZ2lmeShtc2cpKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIGNvbmZpZ3VyYXRpb24gZm9yIHRoaXMgUHJvdG9TdHViCiAgICogQHJldHVybiB7T2JqZWN0fSAtIE1hbmRhdG9yeSBmaWVsZHMgYXJlOiAidXJsIiBvZiB0aGUgTWVzc2FnZU5vZGUgYWRkcmVzcyBhbmQgInJ1bnRpbWVVUkwiLgogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKFZlcnR4UHJvdG9TdHViLCBbewogICAga2V5OiAnY29ubmVjdCcsCgoKICAgIC8qKgogICAgICogVHJ5IHRvIG9wZW4gdGhlIGNvbm5lY3Rpb24gdG8gdGhlIE1lc3NhZ2VOb2RlLiBDb25uZWN0aW9uIGlzIGF1dG8gbWFuYWdlZCwgdGhlcmUgaXMgbm8gbmVlZCB0byBjYWxsIHRoaXMgZXhwbGljaXRseS4KICAgICAqIEhvd2V2ZXIsIGlmICJkaXNjb25uZWN0KCkiIGlzIGNhbGxlZCwgaXQncyBuZWNlc3NhcnkgdG8gY2FsbCB0aGlzIHRvIGVuYWJsZSBjb25uZWN0aW9ucyBhZ2Fpbi4KICAgICAqIEEgc3RhdHVzIG1lc3NhZ2UgaXMgc2VudCB0byAicnVudGltZVByb3RvU3R1YlVSTC9zdGF0dXMiLCBjb250YWluaW5nIHRoZSB2YWx1ZSAiY29ubmVjdGVkIiBpZiBzdWNjZXNzZnVsLCBvciAiZGlzY29ubmVjdGVkIiBpZiBzb21lIGVycm9yIG9jY3Vycy4KICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbm5lY3QoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY29udGludW91c09wZW4gPSB0cnVlOwogICAgICBfdGhpcy5fb3BlbihmdW5jdGlvbiAoKSB7fSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJdCB3aWxsIGRpc2Nvbm5lY3QgYW5kIG9yZGVyIHRvIHN0YXkgZGlzY29ubmVjdGVkLiBSZWNvbm5lY3Rpb24gdHJpZXMsIHdpbGwgbm90IGJlIGF0dGVtcHRlZCwgdW5sZXNzICJjb25uZWN0KCkiIGlzIGNhbGxlZC4KICAgICAqIEEgc3RhdHVzIG1lc3NhZ2UgaXMgc2VudCB0byAicnVudGltZVByb3RvU3R1YlVSTC9zdGF0dXMiIHdpdGggdmFsdWUgImRpc2Nvbm5lY3RlZCIuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGlzY29ubmVjdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY29ubmVjdCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9jb250aW51b3VzT3BlbiA9IGZhbHNlOwogICAgICBpZiAoX3RoaXMuX3NvY2spIHsKICAgICAgICBfdGhpcy5fc2VuZENsb3NlKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc2VuZE9wZW4nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kT3BlbihjYWxsYmFjaykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2lkKys7CiAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgaWQ6IF90aGlzLl9pZCwgdHlwZTogJ29wZW4nLCBmcm9tOiBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwsIHRvOiAnbW46L3Nlc3Npb24nCiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX3JlT3BlbikgewogICAgICAgIG1zZy50eXBlID0gJ3JlLW9wZW4nOwogICAgICB9CgogICAgICAvL3JlZ2lzdGVyIGFuZCB3YWl0IGZvciBvcGVuIHJlcGx5Li4uCiAgICAgIHZhciBoYXNSZXNwb25zZSA9IGZhbHNlOwogICAgICBfdGhpcy5fc2Vzc2lvbkNhbGxiYWNrID0gZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgaWYgKHJlcGx5LnR5cGUgPT09ICdyZXNwb25zZScgJiByZXBseS5pZCA9PT0gbXNnLmlkKSB7CiAgICAgICAgICBoYXNSZXNwb25zZSA9IHRydWU7CiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgaWYgKHJlcGx5LmJvZHkucnVudGltZVRva2VuKSB7CiAgICAgICAgICAgICAgLy9zZXR1cCBydW50aW1lU2Vzc2lvbgogICAgICAgICAgICAgIF90aGlzLl9yZU9wZW4gPSB0cnVlOwogICAgICAgICAgICAgIF90aGlzLl9ydW50aW1lU2Vzc2lvblVSTCA9IF90aGlzLl9jb25maWcucnVudGltZVVSTCArICcvJyArIHJlcGx5LmJvZHkucnVudGltZVRva2VuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygnY29ubmVjdGVkJyk7CiAgICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygnZGlzY29ubmVjdGVkJywgcmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CgogICAgICBfdGhpcy5fc29jay5zZW5kKEpTT04uc3RyaW5naWZ5KG1zZykpOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWhhc1Jlc3BvbnNlKSB7CiAgICAgICAgICAvL25vIHJlc3BvbnNlIGFmdGVyIHggc2Vjb25kcy4uLgogICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2Rpc2Nvbm5lY3RlZCcsICdUaW1lb3V0IGZyb20gbW46L3Nlc3Npb24nKTsKICAgICAgICB9CiAgICAgIH0sIDMwMDApOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZW5kQ2xvc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kQ2xvc2UoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5faWQrKzsKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICBpZDogX3RoaXMuX2lkLCB0eXBlOiAnY2xvc2UnLCBmcm9tOiBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwsIHRvOiAnbW46L3Nlc3Npb24nCiAgICAgIH07CgogICAgICAvL2ludmFsaWRhdGUgcnVudGltZVNlc3Npb24KICAgICAgX3RoaXMuX3JlT3BlbiA9IGZhbHNlOwogICAgICBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwgPSBfdGhpcy5fY29uZmlnLl9ydW50aW1lVVJMOwoKICAgICAgX3RoaXMuX3NvY2suc2VuZChKU09OLnN0cmluZ2lmeShtc2cpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc2VuZFN0YXR1cycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRTdGF0dXModmFsdWUsIHJlYXNvbikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICB0eXBlOiAndXBkYXRlJywKICAgICAgICBmcm9tOiBfdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCwKICAgICAgICB0bzogX3RoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgKyAnL3N0YXR1cycsCiAgICAgICAgYm9keTogewogICAgICAgICAgdmFsdWU6IHZhbHVlCiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKHJlYXNvbikgewogICAgICAgIG1zZy5ib2R5LmRlc2MgPSByZWFzb247CiAgICAgIH0KCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfd2FpdFJlYWR5JywKICAgIHZhbHVlOiBmdW5jdGlvbiBfd2FpdFJlYWR5KGNhbGxiYWNrKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoX3RoaXMuX3NvY2sucmVhZHlTdGF0ZSA9PT0gMSkgewogICAgICAgIGNhbGxiYWNrKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5fd2FpdFJlYWR5KGNhbGxiYWNrKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19maWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maWx0ZXIobXNnKSB7CiAgICAgIGlmIChtc2cuYm9keSAmJiBtc2cuYm9keS52aWEgPT09IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwpIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2RlbGl2ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxpdmVyKG1zZykgewogICAgICBpZiAoIW1zZy5ib2R5KSBtc2cuYm9keSA9IHt9OwoKICAgICAgbXNnLmJvZHkudmlhID0gdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTDsKICAgICAgdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1zZyk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX29wZW4nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vcGVuKGNhbGxiYWNrKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuX2NvbnRpbnVvdXNPcGVuKSB7CiAgICAgICAgLy9UT0RPOiBzZW5kIHN0YXR1cyAoc2VudCBtZXNzYWdlIGVycm9yIC0gZGlzY29ubmVjdGVkKQogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCFfdGhpcy5fc29jaykgewogICAgICAgIGlmIChfdGhpcy5fY29uZmlnLnVybC5zdWJzdHJpbmcoMCwgMikgPT09ICd3cycpIHsKICAgICAgICAgIF90aGlzLl9zb2NrID0gbmV3IF93czIuZGVmYXVsdChfdGhpcy5fY29uZmlnLnVybCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzLl9zb2NrID0gbmV3IFNvY2tKUyhfdGhpcy5fY29uZmlnLnVybCk7CiAgICAgICAgfQoKICAgICAgICBfdGhpcy5fc29jay5vbm9wZW4gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5fc2VuZE9wZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjYWxsYmFjaygpOwogICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgX3RoaXMuX3NvY2sub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHZhciBtc2cgPSBKU09OLnBhcnNlKGUuZGF0YSk7CiAgICAgICAgICBpZiAobXNnLmZyb20gPT09ICdtbjovc2Vzc2lvbicpIHsKICAgICAgICAgICAgaWYgKF90aGlzLl9zZXNzaW9uQ2FsbGJhY2spIHsKICAgICAgICAgICAgICBfdGhpcy5fc2Vzc2lvbkNhbGxiYWNrKG1zZyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzLl9kZWxpdmVyKG1zZyk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgX3RoaXMuX3NvY2sub25jbG9zZSA9IGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgdmFyIHJlYXNvbiA9IHZvaWQgMDsKCiAgICAgICAgICAvL1NlZSBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjNjQ1NSNzZWN0aW9uLTcuNAogICAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDApIHsKICAgICAgICAgICAgcmVhc29uID0gJ05vcm1hbCBjbG9zdXJlLCBtZWFuaW5nIHRoYXQgdGhlIHB1cnBvc2UgZm9yIHdoaWNoIHRoZSBjb25uZWN0aW9uIHdhcyBlc3RhYmxpc2hlZCBoYXMgYmVlbiBmdWxmaWxsZWQuJzsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwMSkgewogICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgXCdnb2luZyBhd2F5XCcsIHN1Y2ggYXMgYSBzZXJ2ZXIgZ29pbmcgZG93biBvciBhIGJyb3dzZXIgaGF2aW5nIG5hdmlnYXRlZCBhd2F5IGZyb20gYSBwYWdlLic7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDIpIHsKICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGR1ZSB0byBhIHByb3RvY29sIGVycm9yJzsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwMykgewogICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBoYXMgcmVjZWl2ZWQgYSB0eXBlIG9mIGRhdGEgaXQgY2Fubm90IGFjY2VwdCAoZS5nLiwgYW4gZW5kcG9pbnQgdGhhdCB1bmRlcnN0YW5kcyBvbmx5IHRleHQgZGF0YSBNQVkgc2VuZCB0aGlzIGlmIGl0IHJlY2VpdmVzIGEgYmluYXJ5IG1lc3NhZ2UpLic7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDQpIHsKICAgICAgICAgICAgcmVhc29uID0gJ1Jlc2VydmVkLiBUaGUgc3BlY2lmaWMgbWVhbmluZyBtaWdodCBiZSBkZWZpbmVkIGluIHRoZSBmdXR1cmUuJzsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwNSkgewogICAgICAgICAgICByZWFzb24gPSAnTm8gc3RhdHVzIGNvZGUgd2FzIGFjdHVhbGx5IHByZXNlbnQuJzsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwNikgewogICAgICAgICAgICByZWFzb24gPSAnVGhlIGNvbm5lY3Rpb24gd2FzIGNsb3NlZCBhYm5vcm1hbGx5LCBlLmcuLCB3aXRob3V0IHNlbmRpbmcgb3IgcmVjZWl2aW5nIGEgQ2xvc2UgY29udHJvbCBmcmFtZSc7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDcpIHsKICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgaGFzIHJlY2VpdmVkIGRhdGEgd2l0aGluIGEgbWVzc2FnZSB0aGF0IHdhcyBub3QgY29uc2lzdGVudCB3aXRoIHRoZSB0eXBlIG9mIHRoZSBtZXNzYWdlIChlLmcuLCBub24tVVRGLTggW2h0dHA6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzM2MjldIGRhdGEgd2l0aGluIGEgdGV4dCBtZXNzYWdlKS4nOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA4KSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGhhcyByZWNlaXZlZCBhIG1lc3NhZ2UgdGhhdCAidmlvbGF0ZXMgaXRzIHBvbGljeSIuIFRoaXMgcmVhc29uIGlzIGdpdmVuIGVpdGhlciBpZiB0aGVyZSBpcyBubyBvdGhlciBzdXRpYmxlIHJlYXNvbiwgb3IgaWYgdGhlcmUgaXMgYSBuZWVkIHRvIGhpZGUgc3BlY2lmaWMgZGV0YWlscyBhYm91dCB0aGUgcG9saWN5Lic7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDkpIHsKICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgaGFzIHJlY2VpdmVkIGEgbWVzc2FnZSB0aGF0IGlzIHRvbyBiaWcgZm9yIGl0IHRvIHByb2Nlc3MuJzsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAxMCkgewogICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgKGNsaWVudCkgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBoYXMgZXhwZWN0ZWQgdGhlIHNlcnZlciB0byBuZWdvdGlhdGUgb25lIG9yIG1vcmUgZXh0ZW5zaW9uLCBidXQgdGhlIHNlcnZlciBkaWRuXCd0IHJldHVybiB0aGVtIGluIHRoZSByZXNwb25zZSBtZXNzYWdlIG9mIHRoZSBXZWJTb2NrZXQgaGFuZHNoYWtlLiA8YnIgLz4gU3BlY2lmaWNhbGx5LCB0aGUgZXh0ZW5zaW9ucyB0aGF0IGFyZSBuZWVkZWQgYXJlOiAnICsgZXZlbnQucmVhc29uOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDExKSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdBIHNlcnZlciBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGVuY291bnRlcmVkIGFuIHVuZXhwZWN0ZWQgY29uZGl0aW9uIHRoYXQgcHJldmVudGVkIGl0IGZyb20gZnVsZmlsbGluZyB0aGUgcmVxdWVzdC4nOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDE1KSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdUaGUgY29ubmVjdGlvbiB3YXMgY2xvc2VkIGR1ZSB0byBhIGZhaWx1cmUgdG8gcGVyZm9ybSBhIFRMUyBoYW5kc2hha2UgKGUuZy4sIHRoZSBzZXJ2ZXIgY2VydGlmaWNhdGUgY2FuXCd0IGJlIHZlcmlmaWVkKS4nOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVhc29uID0gJ1Vua25vd24gcmVhc29uJzsKICAgICAgICAgIH0KCiAgICAgICAgICBkZWxldGUgX3RoaXMuX3NvY2s7CiAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygnZGlzY29ubmVjdGVkJywgcmVhc29uKTsKICAgICAgICB9OwogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzLl93YWl0UmVhZHkoY2FsbGJhY2spOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnY29uZmlnJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY29uZmlnOwogICAgfQogIH0sIHsKICAgIGtleTogJ3J1bnRpbWVTZXNzaW9uJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fcnVudGltZVNlc3Npb25VUkw7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVmVydHhQcm90b1N0dWI7Cn0oKTsKCmZ1bmN0aW9uIGFjdGl2YXRlKHVybCwgYnVzLCBjb25maWcpIHsKICByZXR1cm4gewogICAgbmFtZTogJ1ZlcnR4UHJvdG9TdHViJywKICAgIGluc3RhbmNlOiBuZXcgVmVydHhQcm90b1N0dWIodXJsLCBidXMsIGNvbmZpZykKICB9Owp9CgovKioKKiBDYWxsYmFjayB1c2VkIHRvIHNlbmQgbWVzc2FnZXMKKiBAY2FsbGJhY2sgUG9zdE1lc3NhZ2UKKiBAcGFyYW0ge01lc3NhZ2V9IG1zZyAtIE1lc3NhZ2UgdG8gc2VuZAoqLw==",
      "sourceCodeClassname": "VertxProtoStubNode",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-6f652c34-f0d9-fb93-9407-7f3e29ded6aa1",
    "version": 1.8000000000000005,
    "description": "Description of VertxProtoStubNode",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "default",
    "configuration": {
      "url": "wss://msg-node.hysmart.rethink.ptinovacao.pt/localhost/ws"
    },
    "messageSchemas": "",
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": {
      "node": true
    },
    "dataObjects": [],
    "interworking": false
  },
  "P2PHandlerProtoStub": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBTRFAgaGVscGVycy4KdmFyIFNEUFV0aWxzID0ge307CgovLyBHZW5lcmF0ZSBhbiBhbHBoYW51bWVyaWMgaWRlbnRpZmllciBmb3IgY25hbWUgb3IgbWlkcy4KLy8gVE9ETzogdXNlIFVVSURzIGluc3RlYWQ/IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2plZC85ODI4ODMKU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCAxMCk7Cn07CgovLyBUaGUgUlRDUCBDTkFNRSB1c2VkIGJ5IGFsbCBwZWVyY29ubmVjdGlvbnMgZnJvbSB0aGUgc2FtZSBKUy4KU0RQVXRpbHMubG9jYWxDTmFtZSA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwoKLy8gU3BsaXRzIFNEUCBpbnRvIGxpbmVzLCBkZWFsaW5nIHdpdGggYm90aCBDUkxGIGFuZCBMRi4KU0RQVXRpbHMuc3BsaXRMaW5lcyA9IGZ1bmN0aW9uKGJsb2IpIHsKICByZXR1cm4gYmxvYi50cmltKCkuc3BsaXQoJ1xuJykubWFwKGZ1bmN0aW9uKGxpbmUpIHsKICAgIHJldHVybiBsaW5lLnRyaW0oKTsKICB9KTsKfTsKLy8gU3BsaXRzIFNEUCBpbnRvIHNlc3Npb25wYXJ0IGFuZCBtZWRpYXNlY3Rpb25zLiBFbnN1cmVzIENSTEYuClNEUFV0aWxzLnNwbGl0U2VjdGlvbnMgPSBmdW5jdGlvbihibG9iKSB7CiAgdmFyIHBhcnRzID0gYmxvYi5zcGxpdCgnXG5tPScpOwogIHJldHVybiBwYXJ0cy5tYXAoZnVuY3Rpb24ocGFydCwgaW5kZXgpIHsKICAgIHJldHVybiAoaW5kZXggPiAwID8gJ209JyArIHBhcnQgOiBwYXJ0KS50cmltKCkgKyAnXHJcbic7CiAgfSk7Cn07CgovLyBSZXR1cm5zIGxpbmVzIHRoYXQgc3RhcnQgd2l0aCBhIGNlcnRhaW4gcHJlZml4LgpTRFBVdGlscy5tYXRjaFByZWZpeCA9IGZ1bmN0aW9uKGJsb2IsIHByZWZpeCkgewogIHJldHVybiBTRFBVdGlscy5zcGxpdExpbmVzKGJsb2IpLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gbGluZS5pbmRleE9mKHByZWZpeCkgPT09IDA7CiAgfSk7Cn07CgovLyBQYXJzZXMgYW4gSUNFIGNhbmRpZGF0ZSBsaW5lLiBTYW1wbGUgaW5wdXQ6Ci8vIGNhbmRpZGF0ZTo3MDI3ODYzNTAgMiB1ZHAgNDE4MTk5MDIgOC44LjguOCA2MDc2OSB0eXAgcmVsYXkgcmFkZHIgOC44LjguOAovLyBycG9ydCA1NTk5NiIKU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzOwogIC8vIFBhcnNlIGJvdGggdmFyaWFudHMuCiAgaWYgKGxpbmUuaW5kZXhPZignYT1jYW5kaWRhdGU6JykgPT09IDApIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTIpLnNwbGl0KCcgJyk7CiAgfSBlbHNlIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTApLnNwbGl0KCcgJyk7CiAgfQoKICB2YXIgY2FuZGlkYXRlID0gewogICAgZm91bmRhdGlvbjogcGFydHNbMF0sCiAgICBjb21wb25lbnQ6IHBhcnRzWzFdLAogICAgcHJvdG9jb2w6IHBhcnRzWzJdLnRvTG93ZXJDYXNlKCksCiAgICBwcmlvcml0eTogcGFyc2VJbnQocGFydHNbM10sIDEwKSwKICAgIGlwOiBwYXJ0c1s0XSwKICAgIHBvcnQ6IHBhcnNlSW50KHBhcnRzWzVdLCAxMCksCiAgICAvLyBza2lwIHBhcnRzWzZdID09ICd0eXAnCiAgICB0eXBlOiBwYXJ0c1s3XQogIH07CgogIGZvciAodmFyIGkgPSA4OyBpIDwgcGFydHMubGVuZ3RoOyBpICs9IDIpIHsKICAgIHN3aXRjaCAocGFydHNbaV0pIHsKICAgICAgY2FzZSAncmFkZHInOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAncnBvcnQnOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCA9IHBhcnNlSW50KHBhcnRzW2kgKyAxXSwgMTApOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICd0Y3B0eXBlJzoKICAgICAgICBjYW5kaWRhdGUudGNwVHlwZSA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDogLy8gVW5rbm93biBleHRlbnNpb25zIGFyZSBzaWxlbnRseSBpZ25vcmVkLgogICAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gY2FuZGlkYXRlOwp9OwoKLy8gVHJhbnNsYXRlcyBhIGNhbmRpZGF0ZSBvYmplY3QgaW50byBTRFAgY2FuZGlkYXRlIGF0dHJpYnV0ZS4KU0RQVXRpbHMud3JpdGVDYW5kaWRhdGUgPSBmdW5jdGlvbihjYW5kaWRhdGUpIHsKICB2YXIgc2RwID0gW107CiAgc2RwLnB1c2goY2FuZGlkYXRlLmZvdW5kYXRpb24pOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5jb21wb25lbnQpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5wcm90b2NvbC50b1VwcGVyQ2FzZSgpKTsKICBzZHAucHVzaChjYW5kaWRhdGUucHJpb3JpdHkpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5pcCk7CiAgc2RwLnB1c2goY2FuZGlkYXRlLnBvcnQpOwoKICB2YXIgdHlwZSA9IGNhbmRpZGF0ZS50eXBlOwogIHNkcC5wdXNoKCd0eXAnKTsKICBzZHAucHVzaCh0eXBlKTsKICBpZiAodHlwZSAhPT0gJ2hvc3QnICYmIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyAmJgogICAgICBjYW5kaWRhdGUucmVsYXRlZFBvcnQpIHsKICAgIHNkcC5wdXNoKCdyYWRkcicpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnJlbGF0ZWRBZGRyZXNzKTsgLy8gd2FzOiByZWxBZGRyCiAgICBzZHAucHVzaCgncnBvcnQnKTsKICAgIHNkcC5wdXNoKGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCk7IC8vIHdhczogcmVsUG9ydAogIH0KICBpZiAoY2FuZGlkYXRlLnRjcFR5cGUgJiYgY2FuZGlkYXRlLnByb3RvY29sLnRvTG93ZXJDYXNlKCkgPT09ICd0Y3AnKSB7CiAgICBzZHAucHVzaCgndGNwdHlwZScpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnRjcFR5cGUpOwogIH0KICByZXR1cm4gJ2NhbmRpZGF0ZTonICsgc2RwLmpvaW4oJyAnKTsKfTsKCi8vIFBhcnNlcyBhbiBydHBtYXAgbGluZSwgcmV0dXJucyBSVENSdHBDb2RkZWNQYXJhbWV0ZXJzLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9cnRwbWFwOjExMSBvcHVzLzQ4MDAwLzIKU0RQVXRpbHMucGFyc2VSdHBNYXAgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIoOSkuc3BsaXQoJyAnKTsKICB2YXIgcGFyc2VkID0gewogICAgcGF5bG9hZFR5cGU6IHBhcnNlSW50KHBhcnRzLnNoaWZ0KCksIDEwKSAvLyB3YXM6IGlkCiAgfTsKCiAgcGFydHMgPSBwYXJ0c1swXS5zcGxpdCgnLycpOwoKICBwYXJzZWQubmFtZSA9IHBhcnRzWzBdOwogIHBhcnNlZC5jbG9ja1JhdGUgPSBwYXJzZUludChwYXJ0c1sxXSwgMTApOyAvLyB3YXM6IGNsb2NrcmF0ZQogIC8vIHdhczogY2hhbm5lbHMKICBwYXJzZWQubnVtQ2hhbm5lbHMgPSBwYXJ0cy5sZW5ndGggPT09IDMgPyBwYXJzZUludChwYXJ0c1syXSwgMTApIDogMTsKICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGUgYW4gYT1ydHBtYXAgbGluZSBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvcgovLyBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRwTWFwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgcmV0dXJuICdhPXJ0cG1hcDonICsgcHQgKyAnICcgKyBjb2RlYy5uYW1lICsgJy8nICsgY29kZWMuY2xvY2tSYXRlICsKICAgICAgKGNvZGVjLm51bUNoYW5uZWxzICE9PSAxID8gJy8nICsgY29kZWMubnVtQ2hhbm5lbHMgOiAnJykgKyAnXHJcbic7Cn07CgovLyBQYXJzZXMgYW4gYT1leHRtYXAgbGluZSAoaGVhZGVyZXh0ZW5zaW9uIGZyb20gUkZDIDUyODUpLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9ZXh0bWFwOjIgdXJuOmlldGY6cGFyYW1zOnJ0cC1oZHJleHQ6dG9mZnNldApTRFBVdGlscy5wYXJzZUV4dG1hcCA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cig5KS5zcGxpdCgnICcpOwogIHJldHVybiB7CiAgICBpZDogcGFyc2VJbnQocGFydHNbMF0sIDEwKSwKICAgIHVyaTogcGFydHNbMV0KICB9Owp9OwoKLy8gR2VuZXJhdGVzIGE9ZXh0bWFwIGxpbmUgZnJvbSBSVENSdHBIZWFkZXJFeHRlbnNpb25QYXJhbWV0ZXJzIG9yCi8vIFJUQ1J0cEhlYWRlckV4dGVuc2lvbi4KU0RQVXRpbHMud3JpdGVFeHRtYXAgPSBmdW5jdGlvbihoZWFkZXJFeHRlbnNpb24pIHsKICByZXR1cm4gJ2E9ZXh0bWFwOicgKyAoaGVhZGVyRXh0ZW5zaW9uLmlkIHx8IGhlYWRlckV4dGVuc2lvbi5wcmVmZXJyZWRJZCkgKwogICAgICAgJyAnICsgaGVhZGVyRXh0ZW5zaW9uLnVyaSArICdcclxuJzsKfTsKCi8vIFBhcnNlcyBhbiBmdG1wIGxpbmUsIHJldHVybnMgZGljdGlvbmFyeS4gU2FtcGxlIGlucHV0OgovLyBhPWZtdHA6OTYgdmJyPW9uO2NuZz1vbgovLyBBbHNvIGRlYWxzIHdpdGggdmJyPW9uOyBjbmc9b24KU0RQVXRpbHMucGFyc2VGbXRwID0gZnVuY3Rpb24obGluZSkgewogIHZhciBwYXJzZWQgPSB7fTsKICB2YXIga3Y7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIobGluZS5pbmRleE9mKCcgJykgKyAxKS5zcGxpdCgnOycpOwogIGZvciAodmFyIGogPSAwOyBqIDwgcGFydHMubGVuZ3RoOyBqKyspIHsKICAgIGt2ID0gcGFydHNbal0udHJpbSgpLnNwbGl0KCc9Jyk7CiAgICBwYXJzZWRba3ZbMF0udHJpbSgpXSA9IGt2WzFdOwogIH0KICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGVzIGFuIGE9ZnRtcCBsaW5lIGZyb20gUlRDUnRwQ29kZWNDYXBhYmlsaXR5IG9yIFJUQ1J0cENvZGVjUGFyYW1ldGVycy4KU0RQVXRpbHMud3JpdGVGbXRwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZSA9ICcnOwogIHZhciBwdCA9IGNvZGVjLnBheWxvYWRUeXBlOwogIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICBwdCA9IGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlOwogIH0KICBpZiAoY29kZWMucGFyYW1ldGVycyAmJiBPYmplY3Qua2V5cyhjb2RlYy5wYXJhbWV0ZXJzKS5sZW5ndGgpIHsKICAgIHZhciBwYXJhbXMgPSBbXTsKICAgIE9iamVjdC5rZXlzKGNvZGVjLnBhcmFtZXRlcnMpLmZvckVhY2goZnVuY3Rpb24ocGFyYW0pIHsKICAgICAgcGFyYW1zLnB1c2gocGFyYW0gKyAnPScgKyBjb2RlYy5wYXJhbWV0ZXJzW3BhcmFtXSk7CiAgICB9KTsKICAgIGxpbmUgKz0gJ2E9Zm10cDonICsgcHQgKyAnICcgKyBwYXJhbXMuam9pbignOycpICsgJ1xyXG4nOwogIH0KICByZXR1cm4gbGluZTsKfTsKCi8vIFBhcnNlcyBhbiBydGNwLWZiIGxpbmUsIHJldHVybnMgUlRDUFJ0Y3BGZWVkYmFjayBvYmplY3QuIFNhbXBsZSBpbnB1dDoKLy8gYT1ydGNwLWZiOjk4IG5hY2sgcnBzaQpTRFBVdGlscy5wYXJzZVJ0Y3BGYiA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cihsaW5lLmluZGV4T2YoJyAnKSArIDEpLnNwbGl0KCcgJyk7CiAgcmV0dXJuIHsKICAgIHR5cGU6IHBhcnRzLnNoaWZ0KCksCiAgICBwYXJhbWV0ZXI6IHBhcnRzLmpvaW4oJyAnKQogIH07Cn07Ci8vIEdlbmVyYXRlIGE9cnRjcC1mYiBsaW5lcyBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvciBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRjcEZiID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZXMgPSAnJzsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgaWYgKGNvZGVjLnJ0Y3BGZWVkYmFjayAmJiBjb2RlYy5ydGNwRmVlZGJhY2subGVuZ3RoKSB7CiAgICAvLyBGSVhNRTogc3BlY2lhbCBoYW5kbGluZyBmb3IgdHJyLWludD8KICAgIGNvZGVjLnJ0Y3BGZWVkYmFjay5mb3JFYWNoKGZ1bmN0aW9uKGZiKSB7CiAgICAgIGxpbmVzICs9ICdhPXJ0Y3AtZmI6JyArIHB0ICsgJyAnICsgZmIudHlwZSArCiAgICAgIChmYi5wYXJhbWV0ZXIgJiYgZmIucGFyYW1ldGVyLmxlbmd0aCA/ICcgJyArIGZiLnBhcmFtZXRlciA6ICcnKSArCiAgICAgICAgICAnXHJcbic7CiAgICB9KTsKICB9CiAgcmV0dXJuIGxpbmVzOwp9OwoKLy8gUGFyc2VzIGFuIFJGQyA1NTc2IHNzcmMgbWVkaWEgYXR0cmlidXRlLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9c3NyYzozNzM1OTI4NTU5IGNuYW1lOnNvbWV0aGluZwpTRFBVdGlscy5wYXJzZVNzcmNNZWRpYSA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgc3AgPSBsaW5lLmluZGV4T2YoJyAnKTsKICB2YXIgcGFydHMgPSB7CiAgICBzc3JjOiBwYXJzZUludChsaW5lLnN1YnN0cig3LCBzcCAtIDcpLCAxMCkKICB9OwogIHZhciBjb2xvbiA9IGxpbmUuaW5kZXhPZignOicsIHNwKTsKICBpZiAoY29sb24gPiAtMSkgewogICAgcGFydHMuYXR0cmlidXRlID0gbGluZS5zdWJzdHIoc3AgKyAxLCBjb2xvbiAtIHNwIC0gMSk7CiAgICBwYXJ0cy52YWx1ZSA9IGxpbmUuc3Vic3RyKGNvbG9uICsgMSk7CiAgfSBlbHNlIHsKICAgIHBhcnRzLmF0dHJpYnV0ZSA9IGxpbmUuc3Vic3RyKHNwICsgMSk7CiAgfQogIHJldHVybiBwYXJ0czsKfTsKCi8vIEV4dHJhY3RzIERUTFMgcGFyYW1ldGVycyBmcm9tIFNEUCBtZWRpYSBzZWN0aW9uIG9yIHNlc3Npb25wYXJ0LgovLyBGSVhNRTogZm9yIGNvbnNpc3RlbmN5IHdpdGggb3RoZXIgZnVuY3Rpb25zIHRoaXMgc2hvdWxkIG9ubHkKLy8gICBnZXQgdGhlIGZpbmdlcnByaW50IGxpbmUgYXMgaW5wdXQuIFNlZSBhbHNvIGdldEljZVBhcmFtZXRlcnMuClNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBmcExpbmUgPSBsaW5lcy5maWx0ZXIoZnVuY3Rpb24obGluZSkgewogICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1maW5nZXJwcmludDonKSA9PT0gMDsKICB9KVswXS5zdWJzdHIoMTQpOwogIC8vIE5vdGU6IGE9c2V0dXAgbGluZSBpcyBpZ25vcmVkIHNpbmNlIHdlIHVzZSB0aGUgJ2F1dG8nIHJvbGUuCiAgdmFyIGR0bHNQYXJhbWV0ZXJzID0gewogICAgcm9sZTogJ2F1dG8nLAogICAgZmluZ2VycHJpbnRzOiBbewogICAgICBhbGdvcml0aG06IGZwTGluZS5zcGxpdCgnICcpWzBdLAogICAgICB2YWx1ZTogZnBMaW5lLnNwbGl0KCcgJylbMV0KICAgIH1dCiAgfTsKICByZXR1cm4gZHRsc1BhcmFtZXRlcnM7Cn07CgovLyBTZXJpYWxpemVzIERUTFMgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMgPSBmdW5jdGlvbihwYXJhbXMsIHNldHVwVHlwZSkgewogIHZhciBzZHAgPSAnYT1zZXR1cDonICsgc2V0dXBUeXBlICsgJ1xyXG4nOwogIHBhcmFtcy5maW5nZXJwcmludHMuZm9yRWFjaChmdW5jdGlvbihmcCkgewogICAgc2RwICs9ICdhPWZpbmdlcnByaW50OicgKyBmcC5hbGdvcml0aG0gKyAnICcgKyBmcC52YWx1ZSArICdcclxuJzsKICB9KTsKICByZXR1cm4gc2RwOwp9OwovLyBQYXJzZXMgSUNFIGluZm9ybWF0aW9uIGZyb20gU0RQIG1lZGlhIHNlY3Rpb24gb3Igc2Vzc2lvbnBhcnQuCi8vIEZJWE1FOiBmb3IgY29uc2lzdGVuY3kgd2l0aCBvdGhlciBmdW5jdGlvbnMgdGhpcyBzaG91bGQgb25seQovLyAgIGdldCB0aGUgaWNlLXVmcmFnIGFuZCBpY2UtcHdkIGxpbmVzIGFzIGlucHV0LgpTRFBVdGlscy5nZXRJY2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBpY2VQYXJhbWV0ZXJzID0gewogICAgdXNlcm5hbWVGcmFnbWVudDogbGluZXMuZmlsdGVyKGZ1bmN0aW9uKGxpbmUpIHsKICAgICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1pY2UtdWZyYWc6JykgPT09IDA7CiAgICB9KVswXS5zdWJzdHIoMTIpLAogICAgcGFzc3dvcmQ6IGxpbmVzLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICAgIHJldHVybiBsaW5lLmluZGV4T2YoJ2E9aWNlLXB3ZDonKSA9PT0gMDsKICAgIH0pWzBdLnN1YnN0cigxMCkKICB9OwogIHJldHVybiBpY2VQYXJhbWV0ZXJzOwp9OwoKLy8gU2VyaWFsaXplcyBJQ0UgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlSWNlUGFyYW1ldGVycyA9IGZ1bmN0aW9uKHBhcmFtcykgewogIHJldHVybiAnYT1pY2UtdWZyYWc6JyArIHBhcmFtcy51c2VybmFtZUZyYWdtZW50ICsgJ1xyXG4nICsKICAgICAgJ2E9aWNlLXB3ZDonICsgcGFyYW1zLnBhc3N3b3JkICsgJ1xyXG4nOwp9OwoKLy8gUGFyc2VzIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBhbmQgcmV0dXJucyBSVENSdHBQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHsKICB2YXIgZGVzY3JpcHRpb24gPSB7CiAgICBjb2RlY3M6IFtdLAogICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICBmZWNNZWNoYW5pc21zOiBbXSwKICAgIHJ0Y3A6IFtdCiAgfTsKICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7CiAgdmFyIG1saW5lID0gbGluZXNbMF0uc3BsaXQoJyAnKTsKICBmb3IgKHZhciBpID0gMzsgaSA8IG1saW5lLmxlbmd0aDsgaSsrKSB7IC8vIGZpbmQgYWxsIGNvZGVjcyBmcm9tIG1saW5lWzMuLl0KICAgIHZhciBwdCA9IG1saW5lW2ldOwogICAgdmFyIHJ0cG1hcGxpbmUgPSBTRFBVdGlscy5tYXRjaFByZWZpeCgKICAgICAgICBtZWRpYVNlY3Rpb24sICdhPXJ0cG1hcDonICsgcHQgKyAnICcpWzBdOwogICAgaWYgKHJ0cG1hcGxpbmUpIHsKICAgICAgdmFyIGNvZGVjID0gU0RQVXRpbHMucGFyc2VSdHBNYXAocnRwbWFwbGluZSk7CiAgICAgIHZhciBmbXRwcyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1mbXRwOicgKyBwdCArICcgJyk7CiAgICAgIC8vIE9ubHkgdGhlIGZpcnN0IGE9Zm10cDo8cHQ+IGlzIGNvbnNpZGVyZWQuCiAgICAgIGNvZGVjLnBhcmFtZXRlcnMgPSBmbXRwcy5sZW5ndGggPyBTRFBVdGlscy5wYXJzZUZtdHAoZm10cHNbMF0pIDoge307CiAgICAgIGNvZGVjLnJ0Y3BGZWVkYmFjayA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1ydGNwLWZiOicgKyBwdCArICcgJykKICAgICAgICAubWFwKFNEUFV0aWxzLnBhcnNlUnRjcEZiKTsKICAgICAgZGVzY3JpcHRpb24uY29kZWNzLnB1c2goY29kZWMpOwogICAgICAvLyBwYXJzZSBGRUMgbWVjaGFuaXNtcyBmcm9tIHJ0cG1hcCBsaW5lcy4KICAgICAgc3dpdGNoIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkpIHsKICAgICAgICBjYXNlICdSRUQnOgogICAgICAgIGNhc2UgJ1VMUEZFQyc6CiAgICAgICAgICBkZXNjcmlwdGlvbi5mZWNNZWNoYW5pc21zLnB1c2goY29kZWMubmFtZS50b1VwcGVyQ2FzZSgpKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IC8vIG9ubHkgUkVEIGFuZCBVTFBGRUMgYXJlIHJlY29nbml6ZWQgYXMgRkVDIG1lY2hhbmlzbXMuCiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0KICBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPWV4dG1hcDonKS5mb3JFYWNoKGZ1bmN0aW9uKGxpbmUpIHsKICAgIGRlc2NyaXB0aW9uLmhlYWRlckV4dGVuc2lvbnMucHVzaChTRFBVdGlscy5wYXJzZUV4dG1hcChsaW5lKSk7CiAgfSk7CiAgLy8gRklYTUU6IHBhcnNlIHJ0Y3AuCiAgcmV0dXJuIGRlc2NyaXB0aW9uOwp9OwoKLy8gR2VuZXJhdGVzIHBhcnRzIG9mIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBkZXNjcmliaW5nIHRoZSBjYXBhYmlsaXRpZXMgLwovLyBwYXJhbWV0ZXJzLgpTRFBVdGlscy53cml0ZVJ0cERlc2NyaXB0aW9uID0gZnVuY3Rpb24oa2luZCwgY2FwcykgewogIHZhciBzZHAgPSAnJzsKCiAgLy8gQnVpbGQgdGhlIG1saW5lLgogIHNkcCArPSAnbT0nICsga2luZCArICcgJzsKICBzZHAgKz0gY2Fwcy5jb2RlY3MubGVuZ3RoID4gMCA/ICc5JyA6ICcwJzsgLy8gcmVqZWN0IGlmIG5vIGNvZGVjcy4KICBzZHAgKz0gJyBVRFAvVExTL1JUUC9TQVZQRiAnOwogIHNkcCArPSBjYXBzLmNvZGVjcy5tYXAoZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICAgIH0KICAgIHJldHVybiBjb2RlYy5wYXlsb2FkVHlwZTsKICB9KS5qb2luKCcgJykgKyAnXHJcbic7CgogIHNkcCArPSAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nOwogIHNkcCArPSAnYT1ydGNwOjkgSU4gSVA0IDAuMC4wLjBcclxuJzsKCiAgLy8gQWRkIGE9cnRwbWFwIGxpbmVzIGZvciBlYWNoIGNvZGVjLiBBbHNvIGZtdHAgYW5kIHJ0Y3AtZmIuCiAgY2Fwcy5jb2RlY3MuZm9yRWFjaChmdW5jdGlvbihjb2RlYykgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRwTWFwKGNvZGVjKTsKICAgIHNkcCArPSBTRFBVdGlscy53cml0ZUZtdHAoY29kZWMpOwogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRjcEZiKGNvZGVjKTsKICB9KTsKICB2YXIgbWF4cHRpbWUgPSAwOwogIGNhcHMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5tYXhwdGltZSA+IG1heHB0aW1lKSB7CiAgICAgIG1heHB0aW1lID0gY29kZWMubWF4cHRpbWU7CiAgICB9CiAgfSk7CiAgaWYgKG1heHB0aW1lID4gMCkgewogICAgc2RwICs9ICdhPW1heHB0aW1lOicgKyBtYXhwdGltZSArICdcclxuJzsKICB9CiAgc2RwICs9ICdhPXJ0Y3AtbXV4XHJcbic7CgogIGNhcHMuaGVhZGVyRXh0ZW5zaW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGV4dGVuc2lvbikgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlRXh0bWFwKGV4dGVuc2lvbik7CiAgfSk7CiAgLy8gRklYTUU6IHdyaXRlIGZlY01lY2hhbmlzbXMuCiAgcmV0dXJuIHNkcDsKfTsKCi8vIFBhcnNlcyB0aGUgU0RQIG1lZGlhIHNlY3Rpb24gYW5kIHJldHVybnMgYW4gYXJyYXkgb2YKLy8gUlRDUnRwRW5jb2RpbmdQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cEVuY29kaW5nUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikgewogIHZhciBlbmNvZGluZ1BhcmFtZXRlcnMgPSBbXTsKICB2YXIgZGVzY3JpcHRpb24gPSBTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMobWVkaWFTZWN0aW9uKTsKICB2YXIgaGFzUmVkID0gZGVzY3JpcHRpb24uZmVjTWVjaGFuaXNtcy5pbmRleE9mKCdSRUQnKSAhPT0gLTE7CiAgdmFyIGhhc1VscGZlYyA9IGRlc2NyaXB0aW9uLmZlY01lY2hhbmlzbXMuaW5kZXhPZignVUxQRkVDJykgIT09IC0xOwoKICAvLyBmaWx0ZXIgYT1zc3JjOi4uLiBjbmFtZTosIGlnbm9yZSBQbGFuQi1tc2lkCiAgdmFyIHNzcmNzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjOicpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgfSkKICAuZmlsdGVyKGZ1bmN0aW9uKHBhcnRzKSB7CiAgICByZXR1cm4gcGFydHMuYXR0cmlidXRlID09PSAnY25hbWUnOwogIH0pOwogIHZhciBwcmltYXJ5U3NyYyA9IHNzcmNzLmxlbmd0aCA+IDAgJiYgc3NyY3NbMF0uc3NyYzsKICB2YXIgc2Vjb25kYXJ5U3NyYzsKCiAgdmFyIGZsb3dzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjLWdyb3VwOkZJRCcpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICB2YXIgcGFydHMgPSBsaW5lLnNwbGl0KCcgJyk7CiAgICBwYXJ0cy5zaGlmdCgpOwogICAgcmV0dXJuIHBhcnRzLm1hcChmdW5jdGlvbihwYXJ0KSB7CiAgICAgIHJldHVybiBwYXJzZUludChwYXJ0LCAxMCk7CiAgICB9KTsKICB9KTsKICBpZiAoZmxvd3MubGVuZ3RoID4gMCAmJiBmbG93c1swXS5sZW5ndGggPiAxICYmIGZsb3dzWzBdWzBdID09PSBwcmltYXJ5U3NyYykgewogICAgc2Vjb25kYXJ5U3NyYyA9IGZsb3dzWzBdWzFdOwogIH0KCiAgZGVzY3JpcHRpb24uY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkgPT09ICdSVFgnICYmIGNvZGVjLnBhcmFtZXRlcnMuYXB0KSB7CiAgICAgIHZhciBlbmNQYXJhbSA9IHsKICAgICAgICBzc3JjOiBwcmltYXJ5U3NyYywKICAgICAgICBjb2RlY1BheWxvYWRUeXBlOiBwYXJzZUludChjb2RlYy5wYXJhbWV0ZXJzLmFwdCwgMTApLAogICAgICAgIHJ0eDogewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYwogICAgICAgIH0KICAgICAgfTsKICAgICAgZW5jb2RpbmdQYXJhbWV0ZXJzLnB1c2goZW5jUGFyYW0pOwogICAgICBpZiAoaGFzUmVkKSB7CiAgICAgICAgZW5jUGFyYW0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVuY1BhcmFtKSk7CiAgICAgICAgZW5jUGFyYW0uZmVjID0gewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYywKICAgICAgICAgIG1lY2hhbmlzbTogaGFzVWxwZmVjID8gJ3JlZCt1bHBmZWMnIDogJ3JlZCcKICAgICAgICB9OwogICAgICAgIGVuY29kaW5nUGFyYW1ldGVycy5wdXNoKGVuY1BhcmFtKTsKICAgICAgfQogICAgfQogIH0pOwogIGlmIChlbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoID09PSAwICYmIHByaW1hcnlTc3JjKSB7CiAgICBlbmNvZGluZ1BhcmFtZXRlcnMucHVzaCh7CiAgICAgIHNzcmM6IHByaW1hcnlTc3JjCiAgICB9KTsKICB9CgogIC8vIHdlIHN1cHBvcnQgYm90aCBiPUFTIGFuZCBiPVRJQVMgYnV0IGludGVycHJldCBBUyBhcyBUSUFTLgogIHZhciBiYW5kd2lkdGggPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdiPScpOwogIGlmIChiYW5kd2lkdGgubGVuZ3RoKSB7CiAgICBpZiAoYmFuZHdpZHRoWzBdLmluZGV4T2YoJ2I9VElBUzonKSA9PT0gMCkgewogICAgICBiYW5kd2lkdGggPSBwYXJzZUludChiYW5kd2lkdGhbMF0uc3Vic3RyKDcpLCAxMCk7CiAgICB9IGVsc2UgaWYgKGJhbmR3aWR0aFswXS5pbmRleE9mKCdiPUFTOicpID09PSAwKSB7CiAgICAgIGJhbmR3aWR0aCA9IHBhcnNlSW50KGJhbmR3aWR0aFswXS5zdWJzdHIoNSksIDEwKTsKICAgIH0KICAgIGVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtcykgewogICAgICBwYXJhbXMubWF4Qml0cmF0ZSA9IGJhbmR3aWR0aDsKICAgIH0pOwogIH0KICByZXR1cm4gZW5jb2RpbmdQYXJhbWV0ZXJzOwp9OwoKU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUgPSBmdW5jdGlvbigpIHsKICAvLyBGSVhNRTogc2Vzcy1pZCBzaG91bGQgYmUgYW4gTlRQIHRpbWVzdGFtcC4KICByZXR1cm4gJ3Y9MFxyXG4nICsKICAgICAgJ289dGhpc2lzYWRhcHRlcm9ydGMgODE2OTYzOTkxNTY0Njk0MzEzNyAyIElOIElQNCAxMjcuMC4wLjFcclxuJyArCiAgICAgICdzPS1cclxuJyArCiAgICAgICd0PTAgMFxyXG4nOwp9OwoKU0RQVXRpbHMud3JpdGVNZWRpYVNlY3Rpb24gPSBmdW5jdGlvbih0cmFuc2NlaXZlciwgY2FwcywgdHlwZSwgc3RyZWFtKSB7CiAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlUnRwRGVzY3JpcHRpb24odHJhbnNjZWl2ZXIua2luZCwgY2Fwcyk7CgogIC8vIE1hcCBJQ0UgcGFyYW1ldGVycyAodWZyYWcsIHB3ZCkgdG8gU0RQLgogIHNkcCArPSBTRFBVdGlscy53cml0ZUljZVBhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmdldExvY2FsUGFyYW1ldGVycygpKTsKCiAgLy8gTWFwIERUTFMgcGFyYW1ldGVycyB0byBTRFAuCiAgc2RwICs9IFNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuZ2V0TG9jYWxQYXJhbWV0ZXJzKCksCiAgICAgIHR5cGUgPT09ICdvZmZlcicgPyAnYWN0cGFzcycgOiAnYWN0aXZlJyk7CgogIHNkcCArPSAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlciAmJiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcikgewogICAgc2RwICs9ICdhPXNlbmRyZWN2XHJcbic7CiAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHsKICAgIHNkcCArPSAnYT1zZW5kb25seVxyXG4nOwogIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgIHNkcCArPSAnYT1yZWN2b25seVxyXG4nOwogIH0gZWxzZSB7CiAgICBzZHAgKz0gJ2E9aW5hY3RpdmVcclxuJzsKICB9CgogIC8vIEZJWE1FOiBmb3IgUlRYIHRoZXJlIG1pZ2h0IGJlIG11bHRpcGxlIFNTUkNzLiBOb3QgaW1wbGVtZW50ZWQgaW4gRWRnZSB5ZXQuCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlcikgewogICAgdmFyIG1zaWQgPSAnbXNpZDonICsgc3RyZWFtLmlkICsgJyAnICsKICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIudHJhY2suaWQgKyAnXHJcbic7CiAgICBzZHAgKz0gJ2E9JyArIG1zaWQ7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgICAnICcgKyBtc2lkOwogICAgaWYgKHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICAgIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICcgJyArIG1zaWQ7CiAgICAgIHNkcCArPSAnYT1zc3JjLWdyb3VwOkZJRCAnICsKICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYyArICcgJyArCiAgICAgICAgICB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICdcclxuJzsKICAgIH0KICB9CiAgLy8gRklYTUU6IHRoaXMgc2hvdWxkIGJlIHdyaXR0ZW4gYnkgd3JpdGVSdHBEZXNjcmlwdGlvbi4KICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHguc3NyYyArCiAgICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICB9CiAgcmV0dXJuIHNkcDsKfTsKCi8vIEdldHMgdGhlIGRpcmVjdGlvbiBmcm9tIHRoZSBtZWRpYVNlY3Rpb24gb3IgdGhlIHNlc3Npb25wYXJ0LgpTRFBVdGlscy5nZXREaXJlY3Rpb24gPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KSB7CiAgLy8gTG9vayBmb3Igc2VuZHJlY3YsIHNlbmRvbmx5LCByZWN2b25seSwgaW5hY3RpdmUsIGRlZmF1bHQgdG8gc2VuZHJlY3YuCiAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHsKICAgIHN3aXRjaCAobGluZXNbaV0pIHsKICAgICAgY2FzZSAnYT1zZW5kcmVjdic6CiAgICAgIGNhc2UgJ2E9c2VuZG9ubHknOgogICAgICBjYXNlICdhPXJlY3Zvbmx5JzoKICAgICAgY2FzZSAnYT1pbmFjdGl2ZSc6CiAgICAgICAgcmV0dXJuIGxpbmVzW2ldLnN1YnN0cigyKTsKICAgICAgZGVmYXVsdDoKICAgICAgICAvLyBGSVhNRTogV2hhdCBzaG91bGQgaGFwcGVuIGhlcmU/CiAgICB9CiAgfQogIGlmIChzZXNzaW9ucGFydCkgewogICAgcmV0dXJuIFNEUFV0aWxzLmdldERpcmVjdGlvbihzZXNzaW9ucGFydCk7CiAgfQogIHJldHVybiAnc2VuZHJlY3YnOwp9OwoKLy8gRXhwb3NlIHB1YmxpYyBtZXRob2RzLgptb2R1bGUuZXhwb3J0cyA9IFNEUFV0aWxzOwoKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8vIHZlcnNpb246IDAuNS4xCi8vIGRhdGU6IFR1ZSBGZWIgMDcgMjAxNyAxNjowMDozOSBHTVQrMDAwMCAoV0VUKQovLyBsaWNlbmNlOiAKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgoKKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiU3luY2hlciIsIFtdLCBmYWN0b3J5KTsKCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCWV4cG9ydHNbIlN5bmNoZXIiXSA9IGZhY3RvcnkoKTsKCWVsc2UKCQlyb290WyIiXSA9IHJvb3RbIiJdIHx8IHt9LCByb290WyIiXVsiU3luY2hlciJdID0gZmFjdG9yeSgpOwp9KSh0aGlzLCBmdW5jdGlvbigpIHsKcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXAKLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCXZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307Ci8qKioqKiovCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLwovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQovKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJaTogbW9kdWxlSWQsCi8qKioqKiovIAkJCWw6IGZhbHNlLAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAovKioqKioqLyAJCW1vZHVsZS5sID0gdHJ1ZTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8KLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7Ci8qKioqKiovCi8qKioqKiovIAkvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0Ci8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHMKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikgewovKioqKioqLyAJCWlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKLyoqKioqKi8gCQkJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsKLyoqKioqKi8gCQkJCWNvbmZpZ3VyYWJsZTogZmFsc2UsCi8qKioqKiovIAkJCQllbnVtZXJhYmxlOiB0cnVlLAovKioqKioqLyAJCQkJZ2V0OiBnZXR0ZXIKLyoqKioqKi8gCQkJfSk7Ci8qKioqKiovIAkJfQovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHsKLyoqKioqKi8gCQl2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID8KLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTsKLyoqKioqKi8gCQlfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7Ci8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKLyoqKioqKi8KLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMTYyKTsKLyoqKioqKi8gfSkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gKFsKLyogMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0ge3ZlcnNpb246ICcyLjQuMCd9OwppZih0eXBlb2YgX19lID09ICdudW1iZXInKV9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy84NiNpc3N1ZWNvbW1lbnQtMTE1NzU5MDI4CnZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aAogID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsKaWYodHlwZW9mIF9fZyA9PSAnbnVtYmVyJylfX2cgPSBnbG9iYWw7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzdG9yZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ3drcycpCiAgLCB1aWQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykKICAsIFN5bWJvbCAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLlN5bWJvbAogICwgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJzsKCnZhciAkZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obmFtZSl7CiAgcmV0dXJuIHN0b3JlW25hbWVdIHx8IChzdG9yZVtuYW1lXSA9CiAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IHVpZCkoJ1N5bWJvbC4nICsgbmFtZSkpOwp9OwoKJGV4cG9ydHMuc3RvcmUgPSBzdG9yZTsKCi8qKiovIH0pLAovKiAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHkKbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGRQICAgICAgICAgICAgID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpewogIGFuT2JqZWN0KE8pOwogIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKICBhbk9iamVjdChBdHRyaWJ1dGVzKTsKICBpZihJRThfRE9NX0RFRklORSl0cnkgewogICAgcmV0dXJuIGRQKE8sIFAsIEF0dHJpYnV0ZXMpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICBpZignZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpdGhyb3cgVHlwZUVycm9yKCdBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEnKTsKICBpZigndmFsdWUnIGluIEF0dHJpYnV0ZXMpT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZighaXNPYmplY3QoaXQpKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKICAsIGNyZWF0ZURlc2MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpID8gZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICByZXR1cm4gZFAuZihvYmplY3QsIGtleSwgY3JlYXRlRGVzYygxLCB2YWx1ZSkpOwp9IDogZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICBvYmplY3Rba2V5XSA9IHZhbHVlOwogIHJldHVybiBvYmplY3Q7Cn07CgovKioqLyB9KSwKLyogNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nOwp9OwoKLyoqKi8gfSksCi8qIDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGNvcmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGN0eCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCiAgLCBoaWRlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCiAgLCBQUk9UT1RZUEUgPSAncHJvdG90eXBlJzsKCnZhciAkZXhwb3J0ID0gZnVuY3Rpb24odHlwZSwgbmFtZSwgc291cmNlKXsKICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRgogICAgLCBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HCiAgICAsIElTX1NUQVRJQyA9IHR5cGUgJiAkZXhwb3J0LlMKICAgICwgSVNfUFJPVE8gID0gdHlwZSAmICRleHBvcnQuUAogICAgLCBJU19CSU5EICAgPSB0eXBlICYgJGV4cG9ydC5CCiAgICAsIElTX1dSQVAgICA9IHR5cGUgJiAkZXhwb3J0LlcKICAgICwgZXhwb3J0cyAgID0gSVNfR0xPQkFMID8gY29yZSA6IGNvcmVbbmFtZV0gfHwgKGNvcmVbbmFtZV0gPSB7fSkKICAgICwgZXhwUHJvdG8gID0gZXhwb3J0c1tQUk9UT1RZUEVdCiAgICAsIHRhcmdldCAgICA9IElTX0dMT0JBTCA/IGdsb2JhbCA6IElTX1NUQVRJQyA/IGdsb2JhbFtuYW1lXSA6IChnbG9iYWxbbmFtZV0gfHwge30pW1BST1RPVFlQRV0KICAgICwga2V5LCBvd24sIG91dDsKICBpZihJU19HTE9CQUwpc291cmNlID0gbmFtZTsKICBmb3Ioa2V5IGluIHNvdXJjZSl7CiAgICAvLyBjb250YWlucyBpbiBuYXRpdmUKICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIHRhcmdldFtrZXldICE9PSB1bmRlZmluZWQ7CiAgICBpZihvd24gJiYga2V5IGluIGV4cG9ydHMpY29udGludWU7CiAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZAogICAgb3V0ID0gb3duID8gdGFyZ2V0W2tleV0gOiBzb3VyY2Vba2V5XTsKICAgIC8vIHByZXZlbnQgZ2xvYmFsIHBvbGx1dGlvbiBmb3IgbmFtZXNwYWNlcwogICAgZXhwb3J0c1trZXldID0gSVNfR0xPQkFMICYmIHR5cGVvZiB0YXJnZXRba2V5XSAhPSAnZnVuY3Rpb24nID8gc291cmNlW2tleV0KICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0CiAgICA6IElTX0JJTkQgJiYgb3duID8gY3R4KG91dCwgZ2xvYmFsKQogICAgLy8gd3JhcCBnbG9iYWwgY29uc3RydWN0b3JzIGZvciBwcmV2ZW50IGNoYW5nZSB0aGVtIGluIGxpYnJhcnkKICAgIDogSVNfV1JBUCAmJiB0YXJnZXRba2V5XSA9PSBvdXQgPyAoZnVuY3Rpb24oQyl7CiAgICAgIHZhciBGID0gZnVuY3Rpb24oYSwgYiwgYyl7CiAgICAgICAgaWYodGhpcyBpbnN0YW5jZW9mIEMpewogICAgICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpewogICAgICAgICAgICBjYXNlIDA6IHJldHVybiBuZXcgQzsKICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gbmV3IEMoYSk7CiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBDKGEsIGIpOwogICAgICAgICAgfSByZXR1cm4gbmV3IEMoYSwgYiwgYyk7CiAgICAgICAgfSByZXR1cm4gQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgICBGW1BST1RPVFlQRV0gPSBDW1BST1RPVFlQRV07CiAgICAgIHJldHVybiBGOwogICAgLy8gbWFrZSBzdGF0aWMgdmVyc2lvbnMgZm9yIHByb3RvdHlwZSBtZXRob2RzCiAgICB9KShvdXQpIDogSVNfUFJPVE8gJiYgdHlwZW9mIG91dCA9PSAnZnVuY3Rpb24nID8gY3R4KEZ1bmN0aW9uLmNhbGwsIG91dCkgOiBvdXQ7CiAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUubWV0aG9kcy4lTkFNRSUKICAgIGlmKElTX1BST1RPKXsKICAgICAgKGV4cG9ydHMudmlydHVhbCB8fCAoZXhwb3J0cy52aXJ0dWFsID0ge30pKVtrZXldID0gb3V0OwogICAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUucHJvdG90eXBlLiVOQU1FJQogICAgICBpZih0eXBlICYgJGV4cG9ydC5SICYmIGV4cFByb3RvICYmICFleHBQcm90b1trZXldKWhpZGUoZXhwUHJvdG8sIGtleSwgb3V0KTsKICAgIH0KICB9Cn07Ci8vIHR5cGUgYml0bWFwCiRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkCiRleHBvcnQuRyA9IDI7ICAgLy8gZ2xvYmFsCiRleHBvcnQuUyA9IDQ7ICAgLy8gc3RhdGljCiRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG8KJGV4cG9ydC5CID0gMTY7ICAvLyBiaW5kCiRleHBvcnQuVyA9IDMyOyAgLy8gd3JhcAokZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmUKJGV4cG9ydC5SID0gMTI4OyAvLyByZWFsIHByb3RvIG1ldGhvZCBmb3IgYGxpYnJhcnlgIAptb2R1bGUuZXhwb3J0cyA9ICRleHBvcnQ7CgovKioqLyB9KSwKLyogOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDEwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMzYpOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZWZpbmVQcm9wZXJ0eSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICAgICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogICAgfQogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICAgIHJldHVybiBDb25zdHJ1Y3RvcjsKICB9Owp9KCk7CgovKioqLyB9KSwKLyogMTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjKXsKICB0cnkgewogICAgcmV0dXJuICEhZXhlYygpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn07CgovKioqLyB9KSwKLyogMTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGhhc093blByb3BlcnR5ID0ge30uaGFzT3duUHJvcGVydHk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIGtleSl7CiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoaXQsIGtleSk7Cn07CgovKioqLyB9KSwKLyogMTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzCnZhciBJT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NikKICAsIGRlZmluZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpOwp9OwoKLyoqKi8gfSksCi8qIDE0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZwp2YXIgYUZ1bmN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIHRoYXQsIGxlbmd0aCl7CiAgYUZ1bmN0aW9uKGZuKTsKICBpZih0aGF0ID09PSB1bmRlZmluZWQpcmV0dXJuIGZuOwogIHN3aXRjaChsZW5ndGgpewogICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpOwogICAgfTsKICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTsKICAgIH07CiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7CiAgICB9OwogIH0KICByZXR1cm4gZnVuY3Rpb24oLyogLi4uYXJncyAqLyl7CiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDE1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0ge307CgovKioqLyB9KSwKLyogMTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiaXRtYXAsIHZhbHVlKXsKICByZXR1cm4gewogICAgZW51bWVyYWJsZSAgOiAhKGJpdG1hcCAmIDEpLAogICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLAogICAgd3JpdGFibGUgICAgOiAhKGJpdG1hcCAmIDQpLAogICAgdmFsdWUgICAgICAgOiB2YWx1ZQogIH07Cn07CgovKioqLyB9KSwKLyogMTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjE0IC8gMTUuMi4zLjE0IE9iamVjdC5rZXlzKE8pCnZhciAka2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpOwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pewogIHJldHVybiAka2V5cyhPLCBlbnVtQnVnS2V5cyk7Cn07CgovKioqLyB9KSwKLyogMTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpOwp9OwoKLyoqKi8gfSksCi8qIDE5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5kb2N1bWVudAogIC8vIGluIG9sZCBJRSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JwogICwgaXMgPSBpc09iamVjdChkb2N1bWVudCkgJiYgaXNPYmplY3QoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307Cn07CgovKioqLyB9KSwKLyogMjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRlZiA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaGFzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIFRBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3RvU3RyaW5nVGFnJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCB0YWcsIHN0YXQpewogIGlmKGl0ICYmICFoYXMoaXQgPSBzdGF0ID8gaXQgOiBpdC5wcm90b3R5cGUsIFRBRykpZGVmKGl0LCBUQUcsIHtjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiB0YWd9KTsKfTsKCi8qKiovIH0pLAovKiAyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSkKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2UKLy8gYW5kIHRoZSBzZWNvbmQgYXJndW1lbnQgLSBmbGFnIC0gcHJlZmVycmVkIHR5cGUgaXMgYSBzdHJpbmcKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgUyl7CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gaXQ7CiAgdmFyIGZuLCB2YWw7CiAgaWYoUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIGlmKHR5cGVvZiAoZm4gPSBpdC52YWx1ZU9mKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICBpZighUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIHRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlIik7Cn07CgovKioqLyB9KSwKLyogMjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGlkID0gMAogICwgcHggPSBNYXRoLnJhbmRvbSgpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7CiAgcmV0dXJuICdTeW1ib2woJy5jb25jYXQoa2V5ID09PSB1bmRlZmluZWQgPyAnJyA6IGtleSwgJylfJywgKCsraWQgKyBweCkudG9TdHJpbmcoMzYpKTsKfTsKCi8qKiovIH0pLAovKiAyNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyA3LjIuMSBSZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGFyZ3VtZW50KQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIiArIGl0KTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSB0cnVlOwoKLyoqKi8gfSksCi8qIDI2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzaGFyZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKSgna2V5cycpCiAgLCB1aWQgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzaGFyZWRba2V5XSB8fCAoc2hhcmVkW2tleV0gPSB1aWQoa2V5KSk7Cn07CgovKioqLyB9KSwKLyogMjcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gNy4xLjQgVG9JbnRlZ2VyCnZhciBjZWlsICA9IE1hdGguY2VpbAogICwgZmxvb3IgPSBNYXRoLmZsb29yOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXNOYU4oaXQgPSAraXQpID8gMCA6IChpdCA+IDAgPyBmbG9vciA6IGNlaWwpKGl0KTsKfTsKCi8qKiovIH0pLAovKiAyOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzCm1vZHVsZS5leHBvcnRzID0gKAogICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnCikuc3BsaXQoJywnKTsKCi8qKiovIH0pLAovKiAyOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDMpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoX193ZWJwYWNrX3JlcXVpcmVfXygxOSkoJ2RpdicpLCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiAzMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXycKICAsIHN0b3JlICA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzdG9yZVtrZXldIHx8IChzdG9yZVtrZXldID0ge30pOwp9OwoKLyoqKi8gfSksCi8qIDMxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNzkpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogMzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KQp2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gT2JqZWN0KGRlZmluZWQoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAzMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfc2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc1KTsKCnZhciBfc2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jcmVhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc0KTsKCnZhciBfY3JlYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZSk7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHN1cGVyQ2xhc3MgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoc3VwZXJDbGFzcykpKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9ICgwLCBfY3JlYXRlMi5kZWZhdWx0KShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZjIuZGVmYXVsdCA/ICgwLCBfc2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7Cn07CgovKioqLyB9KSwKLyogMzQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzZWxmLCBjYWxsKSB7CiAgaWYgKCFzZWxmKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIGNhbGwgJiYgKCh0eXBlb2YgY2FsbCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6ICgwLCBfdHlwZW9mMy5kZWZhdWx0KShjYWxsKSkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOwp9OwoKLyoqKi8gfSksCi8qIDM1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQp2YXIgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBkUHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBFbXB0eSAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KICAsIFBST1RPVFlQRSAgID0gJ3Byb3RvdHlwZSc7CgovLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlCnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24oKXsKICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1ZwogIHZhciBpZnJhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KSgnaWZyYW1lJykKICAgICwgaSAgICAgID0gZW51bUJ1Z0tleXMubGVuZ3RoCiAgICAsIGx0ICAgICA9ICc8JwogICAgLCBndCAgICAgPSAnPicKICAgICwgaWZyYW1lRG9jdW1lbnQ7CiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg0MikuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsCiAgLy8gY3JlYXRlRGljdCA9IGlmcmFtZS5jb250ZW50V2luZG93Lk9iamVjdDsKICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7CiAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKICBpZnJhbWVEb2N1bWVudC5vcGVuKCk7CiAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpOwogIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7CiAgY3JlYXRlRGljdCA9IGlmcmFtZURvY3VtZW50LkY7CiAgd2hpbGUoaS0tKWRlbGV0ZSBjcmVhdGVEaWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbaV1dOwogIHJldHVybiBjcmVhdGVEaWN0KCk7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpewogIHZhciByZXN1bHQ7CiAgaWYoTyAhPT0gbnVsbCl7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7CiAgICByZXN1bHQgPSBuZXcgRW1wdHk7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gbnVsbDsKICAgIC8vIGFkZCAiX19wcm90b19fIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsCiAgICByZXN1bHRbSUVfUFJPVE9dID0gTzsKICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpOwogIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkUHMocmVzdWx0LCBQcm9wZXJ0aWVzKTsKfTsKCgovKioqLyB9KSwKLyogMzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygzNyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAzNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKXsKICByZXR1cm4gJE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKTsKfTsKCi8qKiovIH0pLAovKiAzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgTElCUkFSWSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBoaWRlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIEl0ZXJhdG9ycyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsICRpdGVyQ3JlYXRlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MikKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MykKICAsIElURVJBVE9SICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgQlVHR1kgICAgICAgICAgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSkgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YAogICwgRkZfSVRFUkFUT1IgICAgPSAnQEBpdGVyYXRvcicKICAsIEtFWVMgICAgICAgICAgID0gJ2tleXMnCiAgLCBWQUxVRVMgICAgICAgICA9ICd2YWx1ZXMnOwoKdmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKXsKICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7CiAgdmFyIGdldE1ldGhvZCA9IGZ1bmN0aW9uKGtpbmQpewogICAgaWYoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pcmV0dXJuIHByb3RvW2tpbmRdOwogICAgc3dpdGNoKGtpbmQpewogICAgICBjYXNlIEtFWVM6IHJldHVybiBmdW5jdGlvbiBrZXlzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgfTsKICB2YXIgVEFHICAgICAgICA9IE5BTUUgKyAnIEl0ZXJhdG9yJwogICAgLCBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVMKICAgICwgVkFMVUVTX0JVRyA9IGZhbHNlCiAgICAsIHByb3RvICAgICAgPSBCYXNlLnByb3RvdHlwZQogICAgLCAkbmF0aXZlICAgID0gcHJvdG9bSVRFUkFUT1JdIHx8IHByb3RvW0ZGX0lURVJBVE9SXSB8fCBERUZBVUxUICYmIHByb3RvW0RFRkFVTFRdCiAgICAsICRkZWZhdWx0ICAgPSAkbmF0aXZlIHx8IGdldE1ldGhvZChERUZBVUxUKQogICAgLCAkZW50cmllcyAgID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZAogICAgLCAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZQogICAgLCBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlOwogIC8vIEZpeCBuYXRpdmUKICBpZigkYW55TmF0aXZlKXsKICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoJGFueU5hdGl2ZS5jYWxsKG5ldyBCYXNlKSk7CiAgICBpZihJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSl7CiAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnMKICAgICAgc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JQcm90b3R5cGUsIFRBRywgdHJ1ZSk7CiAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lcwogICAgICBpZighTElCUkFSWSAmJiAhaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikpaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwogICAgfQogIH0KICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGCiAgaWYoREVGX1ZBTFVFUyAmJiAkbmF0aXZlICYmICRuYXRpdmUubmFtZSAhPT0gVkFMVUVTKXsKICAgIFZBTFVFU19CVUcgPSB0cnVlOwogICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTsKICB9CiAgLy8gRGVmaW5lIGl0ZXJhdG9yCiAgaWYoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpewogICAgaGlkZShwcm90bywgSVRFUkFUT1IsICRkZWZhdWx0KTsKICB9CiAgLy8gUGx1ZyBmb3IgbGlicmFyeQogIEl0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0OwogIEl0ZXJhdG9yc1tUQUddICA9IHJldHVyblRoaXM7CiAgaWYoREVGQVVMVCl7CiAgICBtZXRob2RzID0gewogICAgICB2YWx1ZXM6ICBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSwKICAgICAga2V5czogICAgSVNfU0VUICAgICA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLAogICAgICBlbnRyaWVzOiAkZW50cmllcwogICAgfTsKICAgIGlmKEZPUkNFRClmb3Ioa2V5IGluIG1ldGhvZHMpewogICAgICBpZighKGtleSBpbiBwcm90bykpcmVkZWZpbmUocHJvdG8sIGtleSwgbWV0aG9kc1trZXldKTsKICAgIH0gZWxzZSAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7CiAgfQogIHJldHVybiBtZXRob2RzOwp9OwoKLyoqKi8gfSksCi8qIDM5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKLy8gMTkuMS4yLjQgLyAxNS4yLjMuNiBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhX193ZWJwYWNrX3JlcXVpcmVfXygzKSwgJ09iamVjdCcsIHtkZWZpbmVQcm9wZXJ0eTogX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mfSk7CgovKioqLyB9KSwKLyogNDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg1MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA0MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTsKCi8qKiovIH0pLAovKiA0MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZG9jdW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKLyoqKi8gfSksCi8qIDQzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi45IC8gMTUuMi4zLjIgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciBoYXMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCB0b09iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBPYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihPKXsKICBPID0gdG9PYmplY3QoTyk7CiAgaWYoaGFzKE8sIElFX1BST1RPKSlyZXR1cm4gT1tJRV9QUk9UT107CiAgaWYodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcil7CiAgICByZXR1cm4gTy5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7CiAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvIDogbnVsbDsKfTsKCi8qKiovIH0pLAovKiA0NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaGFzICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIHRvSU9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCBhcnJheUluZGV4T2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKShmYWxzZSkKICAsIElFX1BST1RPICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIG5hbWVzKXsKICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKICAgICwgaSAgICAgID0gMAogICAgLCByZXN1bHQgPSBbXQogICAgLCBrZXk7CiAgZm9yKGtleSBpbiBPKWlmKGtleSAhPSBJRV9QUk9UTyloYXMoTywga2V5KSAmJiByZXN1bHQucHVzaChrZXkpOwogIC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXMKICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKWlmKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSl7CiAgICB+YXJyYXlJbmRleE9mKHJlc3VsdCwga2V5KSB8fCByZXN1bHQucHVzaChrZXkpOwogIH0KICByZXR1cm4gcmVzdWx0Owp9OwoKLyoqKi8gfSksCi8qIDQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG1vc3QgT2JqZWN0IG1ldGhvZHMgYnkgRVM2IHNob3VsZCBhY2NlcHQgcHJpbWl0aXZlcwp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKICAsIGNvcmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBmYWlscyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBleGVjKXsKICB2YXIgZm4gID0gKGNvcmUuT2JqZWN0IHx8IHt9KVtLRVldIHx8IE9iamVjdFtLRVldCiAgICAsIGV4cCA9IHt9OwogIGV4cFtLRVldID0gZXhlYyhmbik7CiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbigpeyBmbigxKTsgfSksICdPYmplY3QnLCBleHApOwp9OwoKLyoqKi8gfSksCi8qIDQ2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCi8qKiovIH0pLAovKiA0NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMTUgVG9MZW5ndGgKdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpCiAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ID4gMCA/IG1pbih0b0ludGVnZXIoaXQpLCAweDFmZmZmZmZmZmZmZmZmKSA6IDA7IC8vIHBvdygyLCA1MykgLSAxID09IDkwMDcxOTkyNTQ3NDA5OTEKfTsKCi8qKiovIH0pLAovKiA0OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIExJQlJBUlkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKICAsIHdrc0V4dCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkKICAsIGRlZmluZVByb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewogIHZhciAkU3ltYm9sID0gY29yZS5TeW1ib2wgfHwgKGNvcmUuU3ltYm9sID0gTElCUkFSWSA/IHt9IDogZ2xvYmFsLlN5bWJvbCB8fCB7fSk7CiAgaWYobmFtZS5jaGFyQXQoMCkgIT0gJ18nICYmICEobmFtZSBpbiAkU3ltYm9sKSlkZWZpbmVQcm9wZXJ0eSgkU3ltYm9sLCBuYW1lLCB7dmFsdWU6IHdrc0V4dC5mKG5hbWUpfSk7Cn07CgovKioqLyB9KSwKLyogNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTsKCi8qKiovIH0pLAovKiA1MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgJGF0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNjYpKHRydWUpOwoKLy8gMjEuMS4zLjI3IFN0cmluZy5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQpfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KShTdHJpbmcsICdTdHJpbmcnLCBmdW5jdGlvbihpdGVyYXRlZCl7CiAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4Ci8vIDIxLjEuNS4yLjEgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKfSwgZnVuY3Rpb24oKXsKICB2YXIgTyAgICAgPSB0aGlzLl90CiAgICAsIGluZGV4ID0gdGhpcy5faQogICAgLCBwb2ludDsKICBpZihpbmRleCA+PSBPLmxlbmd0aClyZXR1cm4ge3ZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWV9OwogIHBvaW50ID0gJGF0KE8sIGluZGV4KTsKICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDsKICByZXR1cm4ge3ZhbHVlOiBwb2ludCwgZG9uZTogZmFsc2V9Owp9KTsKCi8qKiovIH0pLAovKiA1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDY5KTsKdmFyIGdsb2JhbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBoaWRlICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgSXRlcmF0b3JzICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCBUT19TVFJJTkdfVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKTsKCmZvcih2YXIgY29sbGVjdGlvbnMgPSBbJ05vZGVMaXN0JywgJ0RPTVRva2VuTGlzdCcsICdNZWRpYUxpc3QnLCAnU3R5bGVTaGVldExpc3QnLCAnQ1NTUnVsZUxpc3QnXSwgaSA9IDA7IGkgPCA1OyBpKyspewogIHZhciBOQU1FICAgICAgID0gY29sbGVjdGlvbnNbaV0KICAgICwgQ29sbGVjdGlvbiA9IGdsb2JhbFtOQU1FXQogICAgLCBwcm90byAgICAgID0gQ29sbGVjdGlvbiAmJiBDb2xsZWN0aW9uLnByb3RvdHlwZTsKICBpZihwcm90byAmJiAhcHJvdG9bVE9fU1RSSU5HX1RBR10paGlkZShwcm90bywgVE9fU1RSSU5HX1RBRywgTkFNRSk7CiAgSXRlcmF0b3JzW05BTUVdID0gSXRlcmF0b3JzLkFycmF5Owp9CgovKioqLyB9KSwKLyogNTIgKi8sCi8qIDUzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjb3JlICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsICRKU09OID0gY29yZS5KU09OIHx8IChjb3JlLkpTT04gPSB7c3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeX0pOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICByZXR1cm4gJEpTT04uc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmd1bWVudHMpOwp9OwoKLyoqKi8gfSksCi8qIDU0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgoKLyoqKi8gfSksCi8qIDU1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGdldHRpbmcgdGFnIGZyb20gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KQogICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKQogIC8vIEVTMyB3cm9uZyBoZXJlCiAgLCBBUkcgPSBjb2YoZnVuY3Rpb24oKXsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJzsKCi8vIGZhbGxiYWNrIGZvciBJRTExIFNjcmlwdCBBY2Nlc3MgRGVuaWVkIGVycm9yCnZhciB0cnlHZXQgPSBmdW5jdGlvbihpdCwga2V5KXsKICB0cnkgewogICAgcmV0dXJuIGl0W2tleV07CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgdmFyIE8sIFQsIEI7CiAgcmV0dXJuIGl0ID09PSB1bmRlZmluZWQgPyAnVW5kZWZpbmVkJyA6IGl0ID09PSBudWxsID8gJ051bGwnCiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2UKICAgIDogdHlwZW9mIChUID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUQUcpKSA9PSAnc3RyaW5nJyA/IFQKICAgIC8vIGJ1aWx0aW5UYWcgY2FzZQogICAgOiBBUkcgPyBjb2YoTykKICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2sKICAgIDogKEIgPSBjb2YoTykpID09ICdPYmplY3QnICYmIHR5cGVvZiBPLmNhbGxlZSA9PSAnZnVuY3Rpb24nID8gJ0FyZ3VtZW50cycgOiBCOwp9OwoKLyoqKi8gfSksCi8qIDU2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gY29mKGl0KSA9PSAnU3RyaW5nJyA/IGl0LnNwbGl0KCcnKSA6IE9iamVjdChpdCk7Cn07CgovKioqLyB9KSwKLyogNTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHBJRSAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIGdPUEQgICAgICAgICAgID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKCmV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBnT1BEIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApewogIE8gPSB0b0lPYmplY3QoTyk7CiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwogIGlmKElFOF9ET01fREVGSU5FKXRyeSB7CiAgICByZXR1cm4gZ09QRChPLCBQKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgaWYoaGFzKE8sIFApKXJldHVybiBjcmVhdGVEZXNjKCFwSUUuZi5jYWxsKE8sIFApLCBPW1BdKTsKfTsKCi8qKiovIH0pLAovKiA1OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKLyoqKi8gfSksCi8qIDU5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9pdGVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oNzcpOwoKdmFyIF9pdGVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pdGVyYXRvcik7Cgp2YXIgX3N5bWJvbCA9IF9fd2VicGFja19yZXF1aXJlX18oNzYpOwoKdmFyIF9zeW1ib2wyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3ltYm9sKTsKCnZhciBfdHlwZW9mID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIF9pdGVyYXRvcjIuZGVmYXVsdCA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YoX2l0ZXJhdG9yMi5kZWZhdWx0KSA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG9iaik7Cn0gOiBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IF9zeW1ib2wyLmRlZmF1bHQgJiYgb2JqICE9PSBfc3ltYm9sMi5kZWZhdWx0LnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iaiA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yob2JqKTsKfTsKCi8qKiovIH0pLAovKiA2MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH07CgovKioqLyB9KSwKLyogNjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsc2UgLT4gQXJyYXkjaW5kZXhPZgovLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlcwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvTGVuZ3RoICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCB0b0luZGV4ICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY4KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihJU19JTkNMVURFUyl7CiAgcmV0dXJuIGZ1bmN0aW9uKCR0aGlzLCBlbCwgZnJvbUluZGV4KXsKICAgIHZhciBPICAgICAgPSB0b0lPYmplY3QoJHRoaXMpCiAgICAgICwgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpCiAgICAgICwgaW5kZXggID0gdG9JbmRleChmcm9tSW5kZXgsIGxlbmd0aCkKICAgICAgLCB2YWx1ZTsKICAgIC8vIEFycmF5I2luY2x1ZGVzIHVzZXMgU2FtZVZhbHVlWmVybyBlcXVhbGl0eSBhbGdvcml0aG0KICAgIGlmKElTX0lOQ0xVREVTICYmIGVsICE9IGVsKXdoaWxlKGxlbmd0aCA+IGluZGV4KXsKICAgICAgdmFsdWUgPSBPW2luZGV4KytdOwogICAgICBpZih2YWx1ZSAhPSB2YWx1ZSlyZXR1cm4gdHJ1ZTsKICAgIC8vIEFycmF5I3RvSW5kZXggaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3QKICAgIH0gZWxzZSBmb3IoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKWlmKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pewogICAgICBpZihPW2luZGV4XSA9PT0gZWwpcmV0dXJuIElTX0lOQ0xVREVTIHx8IGluZGV4IHx8IDA7CiAgICB9IHJldHVybiAhSVNfSU5DTFVERVMgJiYgLTE7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgY3JlYXRlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KQogICwgZGVzY3JpcHRvciAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTsKCi8vIDI1LjEuMi4xLjEgJUl0ZXJhdG9yUHJvdG90eXBlJVtAQGl0ZXJhdG9yXSgpCl9fd2VicGFja19yZXF1aXJlX18oNikoSXRlcmF0b3JQcm90b3R5cGUsIF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJyksIGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9KTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpewogIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwge25leHQ6IGRlc2NyaXB0b3IoMSwgbmV4dCl9KTsKICBzZXRUb1N0cmluZ1RhZyhDb25zdHJ1Y3RvciwgTkFNRSArICcgSXRlcmF0b3InKTsKfTsKCi8qKiovIH0pLAovKiA2MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGRvbmUsIHZhbHVlKXsKICByZXR1cm4ge3ZhbHVlOiB2YWx1ZSwgZG9uZTogISFkb25lfTsKfTsKCi8qKiovIH0pLAovKiA2NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIGdldEtleXMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcyl7CiAgYW5PYmplY3QoTyk7CiAgdmFyIGtleXMgICA9IGdldEtleXMoUHJvcGVydGllcykKICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgKICAgICwgaSA9IDAKICAgICwgUDsKICB3aGlsZShsZW5ndGggPiBpKWRQLmYoTywgUCA9IGtleXNbaSsrXSwgUHJvcGVydGllc1tQXSk7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjcgLyAxNS4yLjMuNCBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKQp2YXIgJGtleXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBoaWRkZW5LZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKE8pewogIHJldHVybiAka2V5cyhPLCBoaWRkZW5LZXlzKTsKfTsKCi8qKiovIH0pLAovKiA2NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykKICAsIGRlZmluZWQgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwovLyB0cnVlICAtPiBTdHJpbmcjYXQKLy8gZmFsc2UgLT4gU3RyaW5nI2NvZGVQb2ludEF0Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oVE9fU1RSSU5HKXsKICByZXR1cm4gZnVuY3Rpb24odGhhdCwgcG9zKXsKICAgIHZhciBzID0gU3RyaW5nKGRlZmluZWQodGhhdCkpCiAgICAgICwgaSA9IHRvSW50ZWdlcihwb3MpCiAgICAgICwgbCA9IHMubGVuZ3RoCiAgICAgICwgYSwgYjsKICAgIGlmKGkgPCAwIHx8IGkgPj0gbClyZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7CiAgICBhID0gcy5jaGFyQ29kZUF0KGkpOwogICAgcmV0dXJuIGEgPCAweGQ4MDAgfHwgYSA+IDB4ZGJmZiB8fCBpICsgMSA9PT0gbCB8fCAoYiA9IHMuY2hhckNvZGVBdChpICsgMSkpIDwgMHhkYzAwIHx8IGIgPiAweGRmZmYKICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGEKICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGludm9rZSAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODgpCiAgLCBodG1sICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKQogICwgY2VsICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSkKICAsIGdsb2JhbCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBzZXRUYXNrICAgICAgICAgICAgPSBnbG9iYWwuc2V0SW1tZWRpYXRlCiAgLCBjbGVhclRhc2sgICAgICAgICAgPSBnbG9iYWwuY2xlYXJJbW1lZGlhdGUKICAsIE1lc3NhZ2VDaGFubmVsICAgICA9IGdsb2JhbC5NZXNzYWdlQ2hhbm5lbAogICwgY291bnRlciAgICAgICAgICAgID0gMAogICwgcXVldWUgICAgICAgICAgICAgID0ge30KICAsIE9OUkVBRFlTVEFURUNIQU5HRSA9ICdvbnJlYWR5c3RhdGVjaGFuZ2UnCiAgLCBkZWZlciwgY2hhbm5lbCwgcG9ydDsKdmFyIHJ1biA9IGZ1bmN0aW9uKCl7CiAgdmFyIGlkID0gK3RoaXM7CiAgaWYocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKXsKICAgIHZhciBmbiA9IHF1ZXVlW2lkXTsKICAgIGRlbGV0ZSBxdWV1ZVtpZF07CiAgICBmbigpOwogIH0KfTsKdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpewogIHJ1bi5jYWxsKGV2ZW50LmRhdGEpOwp9OwovLyBOb2RlLmpzIDAuOSsgJiBJRTEwKyBoYXMgc2V0SW1tZWRpYXRlLCBvdGhlcndpc2U6CmlmKCFzZXRUYXNrIHx8ICFjbGVhclRhc2spewogIHNldFRhc2sgPSBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoZm4pewogICAgdmFyIGFyZ3MgPSBbXSwgaSA9IDE7CiAgICB3aGlsZShhcmd1bWVudHMubGVuZ3RoID4gaSlhcmdzLnB1c2goYXJndW1lbnRzW2krK10pOwogICAgcXVldWVbKytjb3VudGVyXSA9IGZ1bmN0aW9uKCl7CiAgICAgIGludm9rZSh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pLCBhcmdzKTsKICAgIH07CiAgICBkZWZlcihjb3VudGVyKTsKICAgIHJldHVybiBjb3VudGVyOwogIH07CiAgY2xlYXJUYXNrID0gZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaWQpewogICAgZGVsZXRlIHF1ZXVlW2lkXTsKICB9OwogIC8vIE5vZGUuanMgMC44LQogIGlmKF9fd2VicGFja19yZXF1aXJlX18oMTgpKHByb2Nlc3MpID09ICdwcm9jZXNzJyl7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgcHJvY2Vzcy5uZXh0VGljayhjdHgocnVuLCBpZCwgMSkpOwogICAgfTsKICAvLyBCcm93c2VycyB3aXRoIE1lc3NhZ2VDaGFubmVsLCBpbmNsdWRlcyBXZWJXb3JrZXJzCiAgfSBlbHNlIGlmKE1lc3NhZ2VDaGFubmVsKXsKICAgIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWw7CiAgICBwb3J0ICAgID0gY2hhbm5lbC5wb3J0MjsKICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gbGlzdGVuZXI7CiAgICBkZWZlciA9IGN0eChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTsKICAvLyBCcm93c2VycyB3aXRoIHBvc3RNZXNzYWdlLCBza2lwIFdlYldvcmtlcnMKICAvLyBJRTggaGFzIHBvc3RNZXNzYWdlLCBidXQgaXQncyBzeW5jICYgdHlwZW9mIGl0cyBwb3N0TWVzc2FnZSBpcyAnb2JqZWN0JwogIH0gZWxzZSBpZihnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lciAmJiB0eXBlb2YgcG9zdE1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJyAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShpZCArICcnLCAnKicpOwogICAgfTsKICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbGlzdGVuZXIsIGZhbHNlKTsKICAvLyBJRTgtCiAgfSBlbHNlIGlmKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKXsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBodG1sLmFwcGVuZENoaWxkKGNlbCgnc2NyaXB0JykpW09OUkVBRFlTVEFURUNIQU5HRV0gPSBmdW5jdGlvbigpewogICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7CiAgICAgICAgcnVuLmNhbGwoaWQpOwogICAgICB9OwogICAgfTsKICAvLyBSZXN0IG9sZCBicm93c2VycwogIH0gZWxzZSB7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgc2V0VGltZW91dChjdHgocnVuLCBpZCwgMSksIDApOwogICAgfTsKICB9Cn0KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2V0OiAgIHNldFRhc2ssCiAgY2xlYXI6IGNsZWFyVGFzawp9OwoKLyoqKi8gfSksCi8qIDY4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KQogICwgbWF4ICAgICAgID0gTWF0aC5tYXgKICAsIG1pbiAgICAgICA9IE1hdGgubWluOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGluZGV4LCBsZW5ndGgpewogIGluZGV4ID0gdG9JbnRlZ2VyKGluZGV4KTsKICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbihpbmRleCwgbGVuZ3RoKTsKfTsKCi8qKiovIH0pLAovKiA2OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgYWRkVG9VbnNjb3BhYmxlcyA9IF9fd2VicGFja19yZXF1aXJlX18oNjApCiAgLCBzdGVwICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MykKICAsIEl0ZXJhdG9ycyAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQogICwgdG9JT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwoKLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKQovLyAyMi4xLjMuMTMgQXJyYXkucHJvdG90eXBlLmtleXMoKQovLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpCi8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzgpKEFycmF5LCAnQXJyYXknLCBmdW5jdGlvbihpdGVyYXRlZCwga2luZCl7CiAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4CiAgdGhpcy5fayA9IGtpbmQ7ICAgICAgICAgICAgICAgIC8vIGtpbmQKLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpCn0sIGZ1bmN0aW9uKCl7CiAgdmFyIE8gICAgID0gdGhpcy5fdAogICAgLCBraW5kICA9IHRoaXMuX2sKICAgICwgaW5kZXggPSB0aGlzLl9pKys7CiAgaWYoIU8gfHwgaW5kZXggPj0gTy5sZW5ndGgpewogICAgdGhpcy5fdCA9IHVuZGVmaW5lZDsKICAgIHJldHVybiBzdGVwKDEpOwogIH0KICBpZihraW5kID09ICdrZXlzJyAgKXJldHVybiBzdGVwKDAsIGluZGV4KTsKICBpZihraW5kID09ICd2YWx1ZXMnKXJldHVybiBzdGVwKDAsIE9baW5kZXhdKTsKICByZXR1cm4gc3RlcCgwLCBbaW5kZXgsIE9baW5kZXhdXSk7Cn0sICd2YWx1ZXMnKTsKCi8vIGFyZ3VtZW50c0xpc3RbQEBpdGVyYXRvcl0gaXMgJUFycmF5UHJvdG9fdmFsdWVzJSAoOS40LjQuNiwgOS40LjQuNykKSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTsKCmFkZFRvVW5zY29wYWJsZXMoJ2tleXMnKTsKYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7CmFkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTsKCi8qKiovIH0pLAovKiA3MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDcxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODIpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIE1FVEEgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykoJ21ldGEnKQogICwgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBoYXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBzZXREZXNjICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaWQgICAgICAgPSAwOwp2YXIgaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZSB8fCBmdW5jdGlvbigpewogIHJldHVybiB0cnVlOwp9Owp2YXIgRlJFRVpFID0gIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGlzRXh0ZW5zaWJsZShPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe30pKTsKfSk7CnZhciBzZXRNZXRhID0gZnVuY3Rpb24oaXQpewogIHNldERlc2MoaXQsIE1FVEEsIHt2YWx1ZTogewogICAgaTogJ08nICsgKytpZCwgLy8gb2JqZWN0IElECiAgICB3OiB7fSAgICAgICAgICAvLyB3ZWFrIGNvbGxlY3Rpb25zIElEcwogIH19KTsKfTsKdmFyIGZhc3RLZXkgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICAvLyByZXR1cm4gcHJpbWl0aXZlIHdpdGggcHJlZml4CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnID8gaXQgOiAodHlwZW9mIGl0ID09ICdzdHJpbmcnID8gJ1MnIDogJ1AnKSArIGl0OwogIGlmKCFoYXMoaXQsIE1FVEEpKXsKICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0CiAgICBpZighaXNFeHRlbnNpYmxlKGl0KSlyZXR1cm4gJ0YnOwogICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGEKICAgIGlmKCFjcmVhdGUpcmV0dXJuICdFJzsKICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhCiAgICBzZXRNZXRhKGl0KTsKICAvLyByZXR1cm4gb2JqZWN0IElECiAgfSByZXR1cm4gaXRbTUVUQV0uaTsKfTsKdmFyIGdldFdlYWsgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICBpZighaGFzKGl0LCBNRVRBKSl7CiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdAogICAgaWYoIWlzRXh0ZW5zaWJsZShpdCkpcmV0dXJuIHRydWU7CiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YQogICAgaWYoIWNyZWF0ZSlyZXR1cm4gZmFsc2U7CiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YQogICAgc2V0TWV0YShpdCk7CiAgLy8gcmV0dXJuIGhhc2ggd2VhayBjb2xsZWN0aW9ucyBJRHMKICB9IHJldHVybiBpdFtNRVRBXS53Owp9OwovLyBhZGQgbWV0YWRhdGEgb24gZnJlZXplLWZhbWlseSBtZXRob2RzIGNhbGxpbmcKdmFyIG9uRnJlZXplID0gZnVuY3Rpb24oaXQpewogIGlmKEZSRUVaRSAmJiBtZXRhLk5FRUQgJiYgaXNFeHRlbnNpYmxlKGl0KSAmJiAhaGFzKGl0LCBNRVRBKSlzZXRNZXRhKGl0KTsKICByZXR1cm4gaXQ7Cn07CnZhciBtZXRhID0gbW9kdWxlLmV4cG9ydHMgPSB7CiAgS0VZOiAgICAgIE1FVEEsCiAgTkVFRDogICAgIGZhbHNlLAogIGZhc3RLZXk6ICBmYXN0S2V5LAogIGdldFdlYWs6ICBnZXRXZWFrLAogIG9uRnJlZXplOiBvbkZyZWV6ZQp9OwoKLyoqKi8gfSksCi8qIDczICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjbGFzc29mICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KQogICwgSVRFUkFUT1IgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgSXRlcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCAhPSB1bmRlZmluZWQpcmV0dXJuIGl0W0lURVJBVE9SXQogICAgfHwgaXRbJ0BAaXRlcmF0b3InXQogICAgfHwgSXRlcmF0b3JzW2NsYXNzb2YoaXQpXTsKfTsKCi8qKiovIH0pLAovKiA3NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDc4KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODEpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDg0KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAwKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGUoUCwgRCl7CiAgcmV0dXJuICRPYmplY3QuY3JlYXRlKFAsIEQpOwp9OwoKLyoqKi8gfSksCi8qIDc5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAxKTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5nZXRQcm90b3R5cGVPZjsKCi8qKiovIH0pLAovKiA4MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMik7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Qua2V5czsKCi8qKiovIH0pLAovKiA4MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMyk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Quc2V0UHJvdG90eXBlT2Y7CgovKioqLyB9KSwKLyogODIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg1NCk7Cl9fd2VicGFja19yZXF1aXJlX18oNTApOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKX193ZWJwYWNrX3JlcXVpcmVfXygxMDQpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuUHJvbWlzZTsKCi8qKiovIH0pLAovKiA4MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNSk7Cl9fd2VicGFja19yZXF1aXJlX18oNTQpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNik7Cl9fd2VicGFja19yZXF1aXJlX18oMTA3KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLlN5bWJvbDsKCi8qKiovIH0pLAovKiA4NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkuZignaXRlcmF0b3InKTsKCi8qKiovIH0pLAovKiA4NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSwgZm9yYmlkZGVuRmllbGQpewogIGlmKCEoaXQgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikgfHwgKGZvcmJpZGRlbkZpZWxkICE9PSB1bmRlZmluZWQgJiYgZm9yYmlkZGVuRmllbGQgaW4gaXQpKXsKICAgIHRocm93IFR5cGVFcnJvcihuYW1lICsgJzogaW5jb3JyZWN0IGludm9jYXRpb24hJyk7CiAgfSByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogODYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gYWxsIGVudW1lcmFibGUgb2JqZWN0IGtleXMsIGluY2x1ZGVzIHN5bWJvbHMKdmFyIGdldEtleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QUyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHZhciByZXN1bHQgICAgID0gZ2V0S2V5cyhpdCkKICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZjsKICBpZihnZXRTeW1ib2xzKXsKICAgIHZhciBzeW1ib2xzID0gZ2V0U3ltYm9scyhpdCkKICAgICAgLCBpc0VudW0gID0gcElFLmYKICAgICAgLCBpICAgICAgID0gMAogICAgICAsIGtleTsKICAgIHdoaWxlKHN5bWJvbHMubGVuZ3RoID4gaSlpZihpc0VudW0uY2FsbChpdCwga2V5ID0gc3ltYm9sc1tpKytdKSlyZXN1bHQucHVzaChrZXkpOwogIH0gcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiA4NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgY2FsbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkxKQogICwgaXNBcnJheUl0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg5KQogICwgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCB0b0xlbmd0aCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCBnZXRJdGVyRm4gICA9IF9fd2VicGFja19yZXF1aXJlX18oNzMpCiAgLCBCUkVBSyAgICAgICA9IHt9CiAgLCBSRVRVUk4gICAgICA9IHt9Owp2YXIgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXRlcmFibGUsIGVudHJpZXMsIGZuLCB0aGF0LCBJVEVSQVRPUil7CiAgdmFyIGl0ZXJGbiA9IElURVJBVE9SID8gZnVuY3Rpb24oKXsgcmV0dXJuIGl0ZXJhYmxlOyB9IDogZ2V0SXRlckZuKGl0ZXJhYmxlKQogICAgLCBmICAgICAgPSBjdHgoZm4sIHRoYXQsIGVudHJpZXMgPyAyIDogMSkKICAgICwgaW5kZXggID0gMAogICAgLCBsZW5ndGgsIHN0ZXAsIGl0ZXJhdG9yLCByZXN1bHQ7CiAgaWYodHlwZW9mIGl0ZXJGbiAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdGVyYWJsZSArICcgaXMgbm90IGl0ZXJhYmxlIScpOwogIC8vIGZhc3QgY2FzZSBmb3IgYXJyYXlzIHdpdGggZGVmYXVsdCBpdGVyYXRvcgogIGlmKGlzQXJyYXlJdGVyKGl0ZXJGbikpZm9yKGxlbmd0aCA9IHRvTGVuZ3RoKGl0ZXJhYmxlLmxlbmd0aCk7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKXsKICAgIHJlc3VsdCA9IGVudHJpZXMgPyBmKGFuT2JqZWN0KHN0ZXAgPSBpdGVyYWJsZVtpbmRleF0pWzBdLCBzdGVwWzFdKSA6IGYoaXRlcmFibGVbaW5kZXhdKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9IGVsc2UgZm9yKGl0ZXJhdG9yID0gaXRlckZuLmNhbGwoaXRlcmFibGUpOyAhKHN0ZXAgPSBpdGVyYXRvci5uZXh0KCkpLmRvbmU7ICl7CiAgICByZXN1bHQgPSBjYWxsKGl0ZXJhdG9yLCBmLCBzdGVwLnZhbHVlLCBlbnRyaWVzKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9Cn07CmV4cG9ydHMuQlJFQUsgID0gQlJFQUs7CmV4cG9ydHMuUkVUVVJOID0gUkVUVVJOOwoKLyoqKi8gfSksCi8qIDg4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGZhc3QgYXBwbHksIGh0dHA6Ly9qc3BlcmYubG5raXQuY29tL2Zhc3QtYXBwbHkvNQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCBhcmdzLCB0aGF0KXsKICB2YXIgdW4gPSB0aGF0ID09PSB1bmRlZmluZWQ7CiAgc3dpdGNoKGFyZ3MubGVuZ3RoKXsKICAgIGNhc2UgMDogcmV0dXJuIHVuID8gZm4oKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQpOwogICAgY2FzZSAxOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0pOwogICAgY2FzZSAyOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0pOwogICAgY2FzZSAzOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pOwogICAgY2FzZSA0OiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pOwogIH0gcmV0dXJuICAgICAgICAgICAgICBmbi5hcHBseSh0aGF0LCBhcmdzKTsKfTsKCi8qKiovIH0pLAovKiA4OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBjaGVjayBvbiBkZWZhdWx0IEFycmF5IGl0ZXJhdG9yCnZhciBJdGVyYXRvcnMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsIElURVJBVE9SICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpCiAgLCBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b1tJVEVSQVRPUl0gPT09IGl0KTsKfTsKCi8qKiovIH0pLAovKiA5MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjIuMiBJc0FycmF5KGFyZ3VtZW50KQp2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7Cm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5KGFyZyl7CiAgcmV0dXJuIGNvZihhcmcpID09ICdBcnJheSc7Cn07CgovKioqLyB9KSwKLyogOTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gY2FsbCBzb21ldGhpbmcgb24gaXRlcmF0b3Igc3RlcCB3aXRoIHNhZmUgY2xvc2luZyBvbiBlcnJvcgp2YXIgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhdG9yLCBmbiwgdmFsdWUsIGVudHJpZXMpewogIHRyeSB7CiAgICByZXR1cm4gZW50cmllcyA/IGZuKGFuT2JqZWN0KHZhbHVlKVswXSwgdmFsdWVbMV0pIDogZm4odmFsdWUpOwogIC8vIDcuNC42IEl0ZXJhdG9yQ2xvc2UoaXRlcmF0b3IsIGNvbXBsZXRpb24pCiAgfSBjYXRjaChlKXsKICAgIHZhciByZXQgPSBpdGVyYXRvclsncmV0dXJuJ107CiAgICBpZihyZXQgIT09IHVuZGVmaW5lZClhbk9iamVjdChyZXQuY2FsbChpdGVyYXRvcikpOwogICAgdGhyb3cgZTsKICB9Cn07CgovKioqLyB9KSwKLyogOTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIElURVJBVE9SICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJykKICAsIFNBRkVfQ0xPU0lORyA9IGZhbHNlOwoKdHJ5IHsKICB2YXIgcml0ZXIgPSBbN11bSVRFUkFUT1JdKCk7CiAgcml0ZXJbJ3JldHVybiddID0gZnVuY3Rpb24oKXsgU0FGRV9DTE9TSU5HID0gdHJ1ZTsgfTsKICBBcnJheS5mcm9tKHJpdGVyLCBmdW5jdGlvbigpeyB0aHJvdyAyOyB9KTsKfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjLCBza2lwQ2xvc2luZyl7CiAgaWYoIXNraXBDbG9zaW5nICYmICFTQUZFX0NMT1NJTkcpcmV0dXJuIGZhbHNlOwogIHZhciBzYWZlID0gZmFsc2U7CiAgdHJ5IHsKICAgIHZhciBhcnIgID0gWzddCiAgICAgICwgaXRlciA9IGFycltJVEVSQVRPUl0oKTsKICAgIGl0ZXIubmV4dCA9IGZ1bmN0aW9uKCl7IHJldHVybiB7ZG9uZTogc2FmZSA9IHRydWV9OyB9OwogICAgYXJyW0lURVJBVE9SXSA9IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyOyB9OwogICAgZXhlYyhhcnIpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICByZXR1cm4gc2FmZTsKfTsKCi8qKiovIH0pLAovKiA5MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2V0S2V5cyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykKICAsIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgZWwpewogIHZhciBPICAgICAgPSB0b0lPYmplY3Qob2JqZWN0KQogICAgLCBrZXlzICAgPSBnZXRLZXlzKE8pCiAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCiAgICAsIGluZGV4ICA9IDAKICAgICwga2V5OwogIHdoaWxlKGxlbmd0aCA+IGluZGV4KWlmKE9ba2V5ID0ga2V5c1tpbmRleCsrXV0gPT09IGVsKXJldHVybiBrZXk7Cn07CgovKioqLyB9KSwKLyogOTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIG1hY3JvdGFzayA9IF9fd2VicGFja19yZXF1aXJlX18oNjcpLnNldAogICwgT2JzZXJ2ZXIgID0gZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIKICAsIHByb2Nlc3MgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBQcm9taXNlICAgPSBnbG9iYWwuUHJvbWlzZQogICwgaXNOb2RlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkocHJvY2VzcykgPT0gJ3Byb2Nlc3MnOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpewogIHZhciBoZWFkLCBsYXN0LCBub3RpZnk7CgogIHZhciBmbHVzaCA9IGZ1bmN0aW9uKCl7CiAgICB2YXIgcGFyZW50LCBmbjsKICAgIGlmKGlzTm9kZSAmJiAocGFyZW50ID0gcHJvY2Vzcy5kb21haW4pKXBhcmVudC5leGl0KCk7CiAgICB3aGlsZShoZWFkKXsKICAgICAgZm4gICA9IGhlYWQuZm47CiAgICAgIGhlYWQgPSBoZWFkLm5leHQ7CiAgICAgIHRyeSB7CiAgICAgICAgZm4oKTsKICAgICAgfSBjYXRjaChlKXsKICAgICAgICBpZihoZWFkKW5vdGlmeSgpOwogICAgICAgIGVsc2UgbGFzdCA9IHVuZGVmaW5lZDsKICAgICAgICB0aHJvdyBlOwogICAgICB9CiAgICB9IGxhc3QgPSB1bmRlZmluZWQ7CiAgICBpZihwYXJlbnQpcGFyZW50LmVudGVyKCk7CiAgfTsKCiAgLy8gTm9kZS5qcwogIGlmKGlzTm9kZSl7CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBwcm9jZXNzLm5leHRUaWNrKGZsdXNoKTsKICAgIH07CiAgLy8gYnJvd3NlcnMgd2l0aCBNdXRhdGlvbk9ic2VydmVyCiAgfSBlbHNlIGlmKE9ic2VydmVyKXsKICAgIHZhciB0b2dnbGUgPSB0cnVlCiAgICAgICwgbm9kZSAgID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpOwogICAgbmV3IE9ic2VydmVyKGZsdXNoKS5vYnNlcnZlKG5vZGUsIHtjaGFyYWN0ZXJEYXRhOiB0cnVlfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBub2RlLmRhdGEgPSB0b2dnbGUgPSAhdG9nZ2xlOwogICAgfTsKICAvLyBlbnZpcm9ubWVudHMgd2l0aCBtYXliZSBub24tY29tcGxldGVseSBjb3JyZWN0LCBidXQgZXhpc3RlbnQgUHJvbWlzZQogIH0gZWxzZSBpZihQcm9taXNlICYmIFByb21pc2UucmVzb2x2ZSl7CiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpOwogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgcHJvbWlzZS50aGVuKGZsdXNoKTsKICAgIH07CiAgLy8gZm9yIG90aGVyIGVudmlyb25tZW50cyAtIG1hY3JvdGFzayBiYXNlZCBvbjoKICAvLyAtIHNldEltbWVkaWF0ZQogIC8vIC0gTWVzc2FnZUNoYW5uZWwKICAvLyAtIHdpbmRvdy5wb3N0TWVzc2FnCiAgLy8gLSBvbnJlYWR5c3RhdGVjaGFuZ2UKICAvLyAtIHNldFRpbWVvdXQKICB9IGVsc2UgewogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgLy8gc3RyYW5nZSBJRSArIHdlYnBhY2sgZGV2IHNlcnZlciBidWcgLSB1c2UgLmNhbGwoZ2xvYmFsKQogICAgICBtYWNyb3Rhc2suY2FsbChnbG9iYWwsIGZsdXNoKTsKICAgIH07CiAgfQoKICByZXR1cm4gZnVuY3Rpb24oZm4pewogICAgdmFyIHRhc2sgPSB7Zm46IGZuLCBuZXh0OiB1bmRlZmluZWR9OwogICAgaWYobGFzdClsYXN0Lm5leHQgPSB0YXNrOwogICAgaWYoIWhlYWQpewogICAgICBoZWFkID0gdGFzazsKICAgICAgbm90aWZ5KCk7CiAgICB9IGxhc3QgPSB0YXNrOwogIH07Cn07CgovKioqLyB9KSwKLyogOTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsbGJhY2sgZm9yIElFMTEgYnVnZ3kgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgd2l0aCBpZnJhbWUgYW5kIHdpbmRvdwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIGdPUE4gICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjUpLmYKICAsIHRvU3RyaW5nICA9IHt9LnRvU3RyaW5nOwoKdmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMKICA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdykgOiBbXTsKCnZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uKGl0KXsKICB0cnkgewogICAgcmV0dXJuIGdPUE4oaXQpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gd2luZG93TmFtZXMuc2xpY2UoKTsKICB9Cn07Cgptb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCl7CiAgcmV0dXJuIHdpbmRvd05hbWVzICYmIHRvU3RyaW5nLmNhbGwoaXQpID09ICdbb2JqZWN0IFdpbmRvd10nID8gZ2V0V2luZG93TmFtZXMoaXQpIDogZ09QTih0b0lPYmplY3QoaXQpKTsKfTsKCgovKioqLyB9KSwKLyogOTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGhpZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHRhcmdldCwgc3JjLCBzYWZlKXsKICBmb3IodmFyIGtleSBpbiBzcmMpewogICAgaWYoc2FmZSAmJiB0YXJnZXRba2V5XSl0YXJnZXRba2V5XSA9IHNyY1trZXldOwogICAgZWxzZSBoaWRlKHRhcmdldCwga2V5LCBzcmNba2V5XSk7CiAgfSByZXR1cm4gdGFyZ2V0Owp9OwoKLyoqKi8gfSksCi8qIDk3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFdvcmtzIHdpdGggX19wcm90b19fIG9ubHkuIE9sZCB2OCBjYW4ndCB3b3JrIHdpdGggbnVsbCBwcm90byBvYmplY3RzLgovKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqLwp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CnZhciBjaGVjayA9IGZ1bmN0aW9uKE8sIHByb3RvKXsKICBhbk9iamVjdChPKTsKICBpZighaXNPYmplY3QocHJvdG8pICYmIHByb3RvICE9PSBudWxsKXRocm93IFR5cGVFcnJvcihwcm90byArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7Cn07Cm1vZHVsZS5leHBvcnRzID0gewogIHNldDogT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8ICgnX19wcm90b19fJyBpbiB7fSA/IC8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAgIGZ1bmN0aW9uKHRlc3QsIGJ1Z2d5LCBzZXQpewogICAgICB0cnkgewogICAgICAgIHNldCA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpKEZ1bmN0aW9uLmNhbGwsIF9fd2VicGFja19yZXF1aXJlX18oNTcpLmYoT2JqZWN0LnByb3RvdHlwZSwgJ19fcHJvdG9fXycpLnNldCwgMik7CiAgICAgICAgc2V0KHRlc3QsIFtdKTsKICAgICAgICBidWdneSA9ICEodGVzdCBpbnN0YW5jZW9mIEFycmF5KTsKICAgICAgfSBjYXRjaChlKXsgYnVnZ3kgPSB0cnVlOyB9CiAgICAgIHJldHVybiBmdW5jdGlvbiBzZXRQcm90b3R5cGVPZihPLCBwcm90byl7CiAgICAgICAgY2hlY2soTywgcHJvdG8pOwogICAgICAgIGlmKGJ1Z2d5KU8uX19wcm90b19fID0gcHJvdG87CiAgICAgICAgZWxzZSBzZXQoTywgcHJvdG8pOwogICAgICAgIHJldHVybiBPOwogICAgICB9OwogICAgfSh7fSwgZmFsc2UpIDogdW5kZWZpbmVkKSwKICBjaGVjazogY2hlY2sKfTsKCi8qKiovIH0pLAovKiA5OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZ2xvYmFsICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGRQICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgREVTQ1JJUFRPUlMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpCiAgLCBTUEVDSUVTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZKXsKICB2YXIgQyA9IHR5cGVvZiBjb3JlW0tFWV0gPT0gJ2Z1bmN0aW9uJyA/IGNvcmVbS0VZXSA6IGdsb2JhbFtLRVldOwogIGlmKERFU0NSSVBUT1JTICYmIEMgJiYgIUNbU1BFQ0lFU10pZFAuZihDLCBTUEVDSUVTLCB7CiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9CiAgfSk7Cn07CgovKioqLyB9KSwKLyogOTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpCnZhciBhbk9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBhRnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgU1BFQ0lFUyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnc3BlY2llcycpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE8sIEQpewogIHZhciBDID0gYW5PYmplY3QoTykuY29uc3RydWN0b3IsIFM7CiAgcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBEIDogYUZ1bmN0aW9uKFMpOwp9OwoKLyoqKi8gfSksCi8qIDEwMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0Jywge2NyZWF0ZTogX193ZWJwYWNrX3JlcXVpcmVfXygzNSl9KTsKCi8qKiovIH0pLAovKiAxMDEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjkgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciB0b09iamVjdCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Myk7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KSgnZ2V0UHJvdG90eXBlT2YnLCBmdW5jdGlvbigpewogIHJldHVybiBmdW5jdGlvbiBnZXRQcm90b3R5cGVPZihpdCl7CiAgICByZXR1cm4gJGdldFByb3RvdHlwZU9mKHRvT2JqZWN0KGl0KSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4xNCBPYmplY3Qua2V5cyhPKQp2YXIgdG9PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGtleXMgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCl9fd2VicGFja19yZXF1aXJlX18oNDUpKCdrZXlzJywgZnVuY3Rpb24oKXsKICByZXR1cm4gZnVuY3Rpb24ga2V5cyhpdCl7CiAgICByZXR1cm4gJGtleXModG9PYmplY3QoaXQpKTsKICB9Owp9KTsKCi8qKiovIH0pLAovKiAxMDMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjE5IE9iamVjdC5zZXRQcm90b3R5cGVPZihPLCBwcm90bykKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwokZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtzZXRQcm90b3R5cGVPZjogX193ZWJwYWNrX3JlcXVpcmVfXyg5Nykuc2V0fSk7CgovKioqLyB9KSwKLyogMTA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBMSUJSQVJZICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgZ2xvYmFsICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGNsYXNzb2YgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTUpCiAgLCAkZXhwb3J0ICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCBpc09iamVjdCAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhRnVuY3Rpb24gICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgYW5JbnN0YW5jZSAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NSkKICAsIGZvck9mICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODcpCiAgLCBzcGVjaWVzQ29uc3RydWN0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KQogICwgdGFzayAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Nykuc2V0CiAgLCBtaWNyb3Rhc2sgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk0KSgpCiAgLCBQUk9NSVNFICAgICAgICAgICAgPSAnUHJvbWlzZScKICAsIFR5cGVFcnJvciAgICAgICAgICA9IGdsb2JhbC5UeXBlRXJyb3IKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCAkUHJvbWlzZSAgICAgICAgICAgPSBnbG9iYWxbUFJPTUlTRV0KICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBpc05vZGUgICAgICAgICAgICAgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJwogICwgZW1wdHkgICAgICAgICAgICAgID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfQogICwgSW50ZXJuYWwsIEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSwgV3JhcHBlcjsKCnZhciBVU0VfTkFUSVZFID0gISFmdW5jdGlvbigpewogIHRyeSB7CiAgICAvLyBjb3JyZWN0IHN1YmNsYXNzaW5nIHdpdGggQEBzcGVjaWVzIHN1cHBvcnQKICAgIHZhciBwcm9taXNlICAgICA9ICRQcm9taXNlLnJlc29sdmUoMSkKICAgICAgLCBGYWtlUHJvbWlzZSA9IChwcm9taXNlLmNvbnN0cnVjdG9yID0ge30pW19fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKV0gPSBmdW5jdGlvbihleGVjKXsgZXhlYyhlbXB0eSwgZW1wdHkpOyB9OwogICAgLy8gdW5oYW5kbGVkIHJlamVjdGlvbnMgdHJhY2tpbmcgc3VwcG9ydCwgTm9kZUpTIFByb21pc2Ugd2l0aG91dCBpdCBmYWlscyBAQHNwZWNpZXMgdGVzdAogICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKSAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2U7CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9KCk7CgovLyBoZWxwZXJzCnZhciBzYW1lQ29uc3RydWN0b3IgPSBmdW5jdGlvbihhLCBiKXsKICAvLyB3aXRoIGxpYnJhcnkgd3JhcHBlciBzcGVjaWFsIGNhc2UKICByZXR1cm4gYSA9PT0gYiB8fCBhID09PSAkUHJvbWlzZSAmJiBiID09PSBXcmFwcGVyOwp9Owp2YXIgaXNUaGVuYWJsZSA9IGZ1bmN0aW9uKGl0KXsKICB2YXIgdGhlbjsKICByZXR1cm4gaXNPYmplY3QoaXQpICYmIHR5cGVvZiAodGhlbiA9IGl0LnRoZW4pID09ICdmdW5jdGlvbicgPyB0aGVuIDogZmFsc2U7Cn07CnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewogIHJldHVybiBzYW1lQ29uc3RydWN0b3IoJFByb21pc2UsIEMpCiAgICA/IG5ldyBQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgOiBuZXcgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5KEMpOwp9Owp2YXIgUHJvbWlzZUNhcGFiaWxpdHkgPSBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbihDKXsKICB2YXIgcmVzb2x2ZSwgcmVqZWN0OwogIHRoaXMucHJvbWlzZSA9IG5ldyBDKGZ1bmN0aW9uKCQkcmVzb2x2ZSwgJCRyZWplY3QpewogICAgaWYocmVzb2x2ZSAhPT0gdW5kZWZpbmVkIHx8IHJlamVjdCAhPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcignQmFkIFByb21pc2UgY29uc3RydWN0b3InKTsKICAgIHJlc29sdmUgPSAkJHJlc29sdmU7CiAgICByZWplY3QgID0gJCRyZWplY3Q7CiAgfSk7CiAgdGhpcy5yZXNvbHZlID0gYUZ1bmN0aW9uKHJlc29sdmUpOwogIHRoaXMucmVqZWN0ICA9IGFGdW5jdGlvbihyZWplY3QpOwp9Owp2YXIgcGVyZm9ybSA9IGZ1bmN0aW9uKGV4ZWMpewogIHRyeSB7CiAgICBleGVjKCk7CiAgfSBjYXRjaChlKXsKICAgIHJldHVybiB7ZXJyb3I6IGV9OwogIH0KfTsKdmFyIG5vdGlmeSA9IGZ1bmN0aW9uKHByb21pc2UsIGlzUmVqZWN0KXsKICBpZihwcm9taXNlLl9uKXJldHVybjsKICBwcm9taXNlLl9uID0gdHJ1ZTsKICB2YXIgY2hhaW4gPSBwcm9taXNlLl9jOwogIG1pY3JvdGFzayhmdW5jdGlvbigpewogICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgogICAgICAsIG9rICAgID0gcHJvbWlzZS5fcyA9PSAxCiAgICAgICwgaSAgICAgPSAwOwogICAgdmFyIHJ1biA9IGZ1bmN0aW9uKHJlYWN0aW9uKXsKICAgICAgdmFyIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbAogICAgICAgICwgcmVzb2x2ZSA9IHJlYWN0aW9uLnJlc29sdmUKICAgICAgICAsIHJlamVjdCAgPSByZWFjdGlvbi5yZWplY3QKICAgICAgICAsIGRvbWFpbiAgPSByZWFjdGlvbi5kb21haW4KICAgICAgICAsIHJlc3VsdCwgdGhlbjsKICAgICAgdHJ5IHsKICAgICAgICBpZihoYW5kbGVyKXsKICAgICAgICAgIGlmKCFvayl7CiAgICAgICAgICAgIGlmKHByb21pc2UuX2ggPT0gMilvbkhhbmRsZVVuaGFuZGxlZChwcm9taXNlKTsKICAgICAgICAgICAgcHJvbWlzZS5faCA9IDE7CiAgICAgICAgICB9CiAgICAgICAgICBpZihoYW5kbGVyID09PSB0cnVlKXJlc3VsdCA9IHZhbHVlOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZW50ZXIoKTsKICAgICAgICAgICAgcmVzdWx0ID0gaGFuZGxlcih2YWx1ZSk7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZXhpdCgpOwogICAgICAgICAgfQogICAgICAgICAgaWYocmVzdWx0ID09PSByZWFjdGlvbi5wcm9taXNlKXsKICAgICAgICAgICAgcmVqZWN0KFR5cGVFcnJvcignUHJvbWlzZS1jaGFpbiBjeWNsZScpKTsKICAgICAgICAgIH0gZWxzZSBpZih0aGVuID0gaXNUaGVuYWJsZShyZXN1bHQpKXsKICAgICAgICAgICAgdGhlbi5jYWxsKHJlc3VsdCwgcmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgICAgIH0gZWxzZSByZXNvbHZlKHJlc3VsdCk7CiAgICAgICAgfSBlbHNlIHJlamVjdCh2YWx1ZSk7CiAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgcmVqZWN0KGUpOwogICAgICB9CiAgICB9OwogICAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSlydW4oY2hhaW5baSsrXSk7IC8vIHZhcmlhYmxlIGxlbmd0aCAtIGNhbid0IHVzZSBmb3JFYWNoCiAgICBwcm9taXNlLl9jID0gW107CiAgICBwcm9taXNlLl9uID0gZmFsc2U7CiAgICBpZihpc1JlamVjdCAmJiAhcHJvbWlzZS5faClvblVuaGFuZGxlZChwcm9taXNlKTsKICB9KTsKfTsKdmFyIG9uVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YKICAgICAgLCBhYnJ1cHQsIGhhbmRsZXIsIGNvbnNvbGU7CiAgICBpZihpc1VuaGFuZGxlZChwcm9taXNlKSl7CiAgICAgIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgICBpZihpc05vZGUpewogICAgICAgICAgcHJvY2Vzcy5lbWl0KCd1bmhhbmRsZWRSZWplY3Rpb24nLCB2YWx1ZSwgcHJvbWlzZSk7CiAgICAgICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub251bmhhbmRsZWRyZWplY3Rpb24pewogICAgICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiB2YWx1ZX0pOwogICAgICAgIH0gZWxzZSBpZigoY29uc29sZSA9IGdsb2JhbC5jb25zb2xlKSAmJiBjb25zb2xlLmVycm9yKXsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbicsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBCcm93c2VycyBzaG91bGQgbm90IHRyaWdnZXIgYHJlamVjdGlvbkhhbmRsZWRgIGV2ZW50IGlmIGl0IHdhcyBoYW5kbGVkIGhlcmUsIE5vZGVKUyAtIHNob3VsZAogICAgICBwcm9taXNlLl9oID0gaXNOb2RlIHx8IGlzVW5oYW5kbGVkKHByb21pc2UpID8gMiA6IDE7CiAgICB9IHByb21pc2UuX2EgPSB1bmRlZmluZWQ7CiAgICBpZihhYnJ1cHQpdGhyb3cgYWJydXB0LmVycm9yOwogIH0pOwp9Owp2YXIgaXNVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKICBpZihwcm9taXNlLl9oID09IDEpcmV0dXJuIGZhbHNlOwogIHZhciBjaGFpbiA9IHByb21pc2UuX2EgfHwgcHJvbWlzZS5fYwogICAgLCBpICAgICA9IDAKICAgICwgcmVhY3Rpb247CiAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSl7CiAgICByZWFjdGlvbiA9IGNoYWluW2krK107CiAgICBpZihyZWFjdGlvbi5mYWlsIHx8ICFpc1VuaGFuZGxlZChyZWFjdGlvbi5wcm9taXNlKSlyZXR1cm4gZmFsc2U7CiAgfSByZXR1cm4gdHJ1ZTsKfTsKdmFyIG9uSGFuZGxlVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciBoYW5kbGVyOwogICAgaWYoaXNOb2RlKXsKICAgICAgcHJvY2Vzcy5lbWl0KCdyZWplY3Rpb25IYW5kbGVkJywgcHJvbWlzZSk7CiAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnJlamVjdGlvbmhhbmRsZWQpewogICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHByb21pc2UuX3Z9KTsKICAgIH0KICB9KTsKfTsKdmFyICRyZWplY3QgPSBmdW5jdGlvbih2YWx1ZSl7CiAgdmFyIHByb21pc2UgPSB0aGlzOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHByb21pc2UuX3YgPSB2YWx1ZTsKICBwcm9taXNlLl9zID0gMjsKICBpZighcHJvbWlzZS5fYSlwcm9taXNlLl9hID0gcHJvbWlzZS5fYy5zbGljZSgpOwogIG5vdGlmeShwcm9taXNlLCB0cnVlKTsKfTsKdmFyICRyZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpewogIHZhciBwcm9taXNlID0gdGhpcwogICAgLCB0aGVuOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHRyeSB7CiAgICBpZihwcm9taXNlID09PSB2YWx1ZSl0aHJvdyBUeXBlRXJyb3IoIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmIik7CiAgICBpZih0aGVuID0gaXNUaGVuYWJsZSh2YWx1ZSkpewogICAgICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKICAgICAgICB2YXIgd3JhcHBlciA9IHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfTsgLy8gd3JhcAogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGVuLmNhbGwodmFsdWUsIGN0eCgkcmVzb2x2ZSwgd3JhcHBlciwgMSksIGN0eCgkcmVqZWN0LCB3cmFwcGVyLCAxKSk7CiAgICAgICAgfSBjYXRjaChlKXsKICAgICAgICAgICRyZWplY3QuY2FsbCh3cmFwcGVyLCBlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgcHJvbWlzZS5fdiA9IHZhbHVlOwogICAgICBwcm9taXNlLl9zID0gMTsKICAgICAgbm90aWZ5KHByb21pc2UsIGZhbHNlKTsKICAgIH0KICB9IGNhdGNoKGUpewogICAgJHJlamVjdC5jYWxsKHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfSwgZSk7IC8vIHdyYXAKICB9Cn07CgovLyBjb25zdHJ1Y3RvciBwb2x5ZmlsbAppZighVVNFX05BVElWRSl7CiAgLy8gMjUuNC4zLjEgUHJvbWlzZShleGVjdXRvcikKICAkUHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpewogICAgYW5JbnN0YW5jZSh0aGlzLCAkUHJvbWlzZSwgUFJPTUlTRSwgJ19oJyk7CiAgICBhRnVuY3Rpb24oZXhlY3V0b3IpOwogICAgSW50ZXJuYWwuY2FsbCh0aGlzKTsKICAgIHRyeSB7CiAgICAgIGV4ZWN1dG9yKGN0eCgkcmVzb2x2ZSwgdGhpcywgMSksIGN0eCgkcmVqZWN0LCB0aGlzLCAxKSk7CiAgICB9IGNhdGNoKGVycil7CiAgICAgICRyZWplY3QuY2FsbCh0aGlzLCBlcnIpOwogICAgfQogIH07CiAgSW50ZXJuYWwgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKICAgIHRoaXMuX2MgPSBbXTsgICAgICAgICAgICAgLy8gPC0gYXdhaXRpbmcgcmVhY3Rpb25zCiAgICB0aGlzLl9hID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIGNoZWNrZWQgaW4gaXNVbmhhbmRsZWQgcmVhY3Rpb25zCiAgICB0aGlzLl9zID0gMDsgICAgICAgICAgICAgIC8vIDwtIHN0YXRlCiAgICB0aGlzLl9kID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIGRvbmUKICAgIHRoaXMuX3YgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gdmFsdWUKICAgIHRoaXMuX2ggPSAwOyAgICAgICAgICAgICAgLy8gPC0gcmVqZWN0aW9uIHN0YXRlLCAwIC0gZGVmYXVsdCwgMSAtIGhhbmRsZWQsIDIgLSB1bmhhbmRsZWQKICAgIHRoaXMuX24gPSBmYWxzZTsgICAgICAgICAgLy8gPC0gbm90aWZ5CiAgfTsKICBJbnRlcm5hbC5wcm90b3R5cGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KSgkUHJvbWlzZS5wcm90b3R5cGUsIHsKICAgIC8vIDI1LjQuNS4zIFByb21pc2UucHJvdG90eXBlLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpCiAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKXsKICAgICAgdmFyIHJlYWN0aW9uICAgID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsICRQcm9taXNlKSk7CiAgICAgIHJlYWN0aW9uLm9rICAgICA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PSAnZnVuY3Rpb24nID8gb25GdWxmaWxsZWQgOiB0cnVlOwogICAgICByZWFjdGlvbi5mYWlsICAgPSB0eXBlb2Ygb25SZWplY3RlZCA9PSAnZnVuY3Rpb24nICYmIG9uUmVqZWN0ZWQ7CiAgICAgIHJlYWN0aW9uLmRvbWFpbiA9IGlzTm9kZSA/IHByb2Nlc3MuZG9tYWluIDogdW5kZWZpbmVkOwogICAgICB0aGlzLl9jLnB1c2gocmVhY3Rpb24pOwogICAgICBpZih0aGlzLl9hKXRoaXMuX2EucHVzaChyZWFjdGlvbik7CiAgICAgIGlmKHRoaXMuX3Mpbm90aWZ5KHRoaXMsIGZhbHNlKTsKICAgICAgcmV0dXJuIHJlYWN0aW9uLnByb21pc2U7CiAgICB9LAogICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2gob25SZWplY3RlZCkKICAgICdjYXRjaCc6IGZ1bmN0aW9uKG9uUmVqZWN0ZWQpewogICAgICByZXR1cm4gdGhpcy50aGVuKHVuZGVmaW5lZCwgb25SZWplY3RlZCk7CiAgICB9CiAgfSk7CiAgUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbigpewogICAgdmFyIHByb21pc2UgID0gbmV3IEludGVybmFsOwogICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTsKICAgIHRoaXMucmVzb2x2ZSA9IGN0eCgkcmVzb2x2ZSwgcHJvbWlzZSwgMSk7CiAgICB0aGlzLnJlamVjdCAgPSBjdHgoJHJlamVjdCwgcHJvbWlzZSwgMSk7CiAgfTsKfQoKJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1Byb21pc2U6ICRQcm9taXNlfSk7Cl9fd2VicGFja19yZXF1aXJlX18oMjEpKCRQcm9taXNlLCBQUk9NSVNFKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg5OCkoUFJPTUlTRSk7CldyYXBwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApW1BST01JU0VdOwoKLy8gc3RhdGljcwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCBQUk9NSVNFLCB7CiAgLy8gMjUuNC40LjUgUHJvbWlzZS5yZWplY3QocikKICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyKXsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlamVjdCAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgICAkJHJlamVjdChyKTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQp9KTsKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoTElCUkFSWSB8fCAhVVNFX05BVElWRSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuNiBQcm9taXNlLnJlc29sdmUoeCkKICByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKHgpewogICAgLy8gaW5zdGFuY2VvZiBpbnN0ZWFkIG9mIGludGVybmFsIHNsb3QgY2hlY2sgYmVjYXVzZSB3ZSBzaG91bGQgZml4IGl0IHdpdGhvdXQgcmVwbGFjZW1lbnQgbmF0aXZlIFByb21pc2UgY29yZQogICAgaWYoeCBpbnN0YW5jZW9mICRQcm9taXNlICYmIHNhbWVDb25zdHJ1Y3Rvcih4LmNvbnN0cnVjdG9yLCB0aGlzKSlyZXR1cm4geDsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlc29sdmUgID0gY2FwYWJpbGl0eS5yZXNvbHZlOwogICAgJCRyZXNvbHZlKHgpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoVVNFX05BVElWRSAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fKDkyKShmdW5jdGlvbihpdGVyKXsKICAkUHJvbWlzZS5hbGwoaXRlcilbJ2NhdGNoJ10oZW1wdHkpOwp9KSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuMSBQcm9taXNlLmFsbChpdGVyYWJsZSkKICBhbGw6IGZ1bmN0aW9uIGFsbChpdGVyYWJsZSl7CiAgICB2YXIgQyAgICAgICAgICA9IHRoaXMKICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKICAgICAgLCByZXNvbHZlICAgID0gY2FwYWJpbGl0eS5yZXNvbHZlCiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwogICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgdmFyIHZhbHVlcyAgICA9IFtdCiAgICAgICAgLCBpbmRleCAgICAgPSAwCiAgICAgICAgLCByZW1haW5pbmcgPSAxOwogICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2UpewogICAgICAgIHZhciAkaW5kZXggICAgICAgID0gaW5kZXgrKwogICAgICAgICAgLCBhbHJlYWR5Q2FsbGVkID0gZmFsc2U7CiAgICAgICAgdmFsdWVzLnB1c2godW5kZWZpbmVkKTsKICAgICAgICByZW1haW5pbmcrKzsKICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgICBpZihhbHJlYWR5Q2FsbGVkKXJldHVybjsKICAgICAgICAgIGFscmVhZHlDYWxsZWQgID0gdHJ1ZTsKICAgICAgICAgIHZhbHVlc1skaW5kZXhdID0gdmFsdWU7CiAgICAgICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgfSk7CiAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9LAogIC8vIDI1LjQuNC40IFByb21pc2UucmFjZShpdGVyYWJsZSkKICByYWNlOiBmdW5jdGlvbiByYWNlKGl0ZXJhYmxlKXsKICAgIHZhciBDICAgICAgICAgID0gdGhpcwogICAgICAsIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgICAsIHJlamVjdCAgICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oY2FwYWJpbGl0eS5yZXNvbHZlLCByZWplY3QpOwogICAgICB9KTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwoKLyoqKi8gfSksCi8qIDEwNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyBFQ01BU2NyaXB0IDYgc3ltYm9scyBzaGltCnZhciBnbG9iYWwgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIERFU0NSSVBUT1JTICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBNRVRBICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpLktFWQogICwgJGZhaWxzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKQogICwgc2hhcmVkICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgdWlkICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKQogICwgd2tzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpCiAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCiAgLCB3a3NEZWZpbmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDgpCiAgLCBrZXlPZiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTMpCiAgLCBlbnVtS2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODYpCiAgLCBpc0FycmF5ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTApCiAgLCBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIF9jcmVhdGUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSkKICAsIGdPUE5FeHQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NSkKICAsICRHT1BEICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NykKICAsICREUCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgJGtleXMgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QRCAgICAgICAgICAgPSAkR09QRC5mCiAgLCBkUCAgICAgICAgICAgICA9ICREUC5mCiAgLCBnT1BOICAgICAgICAgICA9IGdPUE5FeHQuZgogICwgJFN5bWJvbCAgICAgICAgPSBnbG9iYWwuU3ltYm9sCiAgLCAkSlNPTiAgICAgICAgICA9IGdsb2JhbC5KU09OCiAgLCBfc3RyaW5naWZ5ICAgICA9ICRKU09OICYmICRKU09OLnN0cmluZ2lmeQogICwgUFJPVE9UWVBFICAgICAgPSAncHJvdG90eXBlJwogICwgSElEREVOICAgICAgICAgPSB3a3MoJ19oaWRkZW4nKQogICwgVE9fUFJJTUlUSVZFICAgPSB3a3MoJ3RvUHJpbWl0aXZlJykKICAsIGlzRW51bSAgICAgICAgID0ge30ucHJvcGVydHlJc0VudW1lcmFibGUKICAsIFN5bWJvbFJlZ2lzdHJ5ID0gc2hhcmVkKCdzeW1ib2wtcmVnaXN0cnknKQogICwgQWxsU3ltYm9scyAgICAgPSBzaGFyZWQoJ3N5bWJvbHMnKQogICwgT1BTeW1ib2xzICAgICAgPSBzaGFyZWQoJ29wLXN5bWJvbHMnKQogICwgT2JqZWN0UHJvdG8gICAgPSBPYmplY3RbUFJPVE9UWVBFXQogICwgVVNFX05BVElWRSAgICAgPSB0eXBlb2YgJFN5bWJvbCA9PSAnZnVuY3Rpb24nCiAgLCBRT2JqZWN0ICAgICAgICA9IGdsb2JhbC5RT2JqZWN0OwovLyBEb24ndCB1c2Ugc2V0dGVycyBpbiBRdCBTY3JpcHQsIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8xNzMKdmFyIHNldHRlciA9ICFRT2JqZWN0IHx8ICFRT2JqZWN0W1BST1RPVFlQRV0gfHwgIVFPYmplY3RbUFJPVE9UWVBFXS5maW5kQ2hpbGQ7CgovLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODcKdmFyIHNldFN5bWJvbERlc2MgPSBERVNDUklQVE9SUyAmJiAkZmFpbHMoZnVuY3Rpb24oKXsKICByZXR1cm4gX2NyZWF0ZShkUCh7fSwgJ2EnLCB7CiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBkUCh0aGlzLCAnYScsIHt2YWx1ZTogN30pLmE7IH0KICB9KSkuYSAhPSA3Owp9KSA/IGZ1bmN0aW9uKGl0LCBrZXksIEQpewogIHZhciBwcm90b0Rlc2MgPSBnT1BEKE9iamVjdFByb3RvLCBrZXkpOwogIGlmKHByb3RvRGVzYylkZWxldGUgT2JqZWN0UHJvdG9ba2V5XTsKICBkUChpdCwga2V5LCBEKTsKICBpZihwcm90b0Rlc2MgJiYgaXQgIT09IE9iamVjdFByb3RvKWRQKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7Cn0gOiBkUDsKCnZhciB3cmFwID0gZnVuY3Rpb24odGFnKXsKICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pOwogIHN5bS5fayA9IHRhZzsKICByZXR1cm4gc3ltOwp9OwoKdmFyIGlzU3ltYm9sID0gVVNFX05BVElWRSAmJiB0eXBlb2YgJFN5bWJvbC5pdGVyYXRvciA9PSAnc3ltYm9sJyA/IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnOwp9IDogZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCBpbnN0YW5jZW9mICRTeW1ib2w7Cn07Cgp2YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCl7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvKSRkZWZpbmVQcm9wZXJ0eShPUFN5bWJvbHMsIGtleSwgRCk7CiAgYW5PYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgYW5PYmplY3QoRCk7CiAgaWYoaGFzKEFsbFN5bWJvbHMsIGtleSkpewogICAgaWYoIUQuZW51bWVyYWJsZSl7CiAgICAgIGlmKCFoYXMoaXQsIEhJRERFTikpZFAoaXQsIEhJRERFTiwgY3JlYXRlRGVzYygxLCB7fSkpOwogICAgICBpdFtISURERU5dW2tleV0gPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgaWYoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSlpdFtISURERU5dW2tleV0gPSBmYWxzZTsKICAgICAgRCA9IF9jcmVhdGUoRCwge2VudW1lcmFibGU6IGNyZWF0ZURlc2MoMCwgZmFsc2UpfSk7CiAgICB9IHJldHVybiBzZXRTeW1ib2xEZXNjKGl0LCBrZXksIEQpOwogIH0gcmV0dXJuIGRQKGl0LCBrZXksIEQpOwp9Owp2YXIgJGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKGl0LCBQKXsKICBhbk9iamVjdChpdCk7CiAgdmFyIGtleXMgPSBlbnVtS2V5cyhQID0gdG9JT2JqZWN0KFApKQogICAgLCBpICAgID0gMAogICAgLCBsID0ga2V5cy5sZW5ndGgKICAgICwga2V5OwogIHdoaWxlKGwgPiBpKSRkZWZpbmVQcm9wZXJ0eShpdCwga2V5ID0ga2V5c1tpKytdLCBQW2tleV0pOwogIHJldHVybiBpdDsKfTsKdmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaXQsIFApewogIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfY3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9jcmVhdGUoaXQpLCBQKTsKfTsKdmFyICRwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IGZ1bmN0aW9uIHByb3BlcnR5SXNFbnVtZXJhYmxlKGtleSl7CiAgdmFyIEUgPSBpc0VudW0uY2FsbCh0aGlzLCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKTsKICBpZih0aGlzID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSlyZXR1cm4gZmFsc2U7CiAgcmV0dXJuIEUgfHwgIWhhcyh0aGlzLCBrZXkpIHx8ICFoYXMoQWxsU3ltYm9scywga2V5KSB8fCBoYXModGhpcywgSElEREVOKSAmJiB0aGlzW0hJRERFTl1ba2V5XSA/IEUgOiB0cnVlOwp9Owp2YXIgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICBpdCAgPSB0b0lPYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKXJldHVybjsKICB2YXIgRCA9IGdPUEQoaXQsIGtleSk7CiAgaWYoRCAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKUQuZW51bWVyYWJsZSA9IHRydWU7CiAgcmV0dXJuIEQ7Cn07CnZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpewogIHZhciBuYW1lcyAgPSBnT1BOKHRvSU9iamVjdChpdCkpCiAgICAsIHJlc3VsdCA9IFtdCiAgICAsIGkgICAgICA9IDAKICAgICwga2V5OwogIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewogICAgaWYoIWhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiBrZXkgIT0gSElEREVOICYmIGtleSAhPSBNRVRBKXJlc3VsdC5wdXNoKGtleSk7CiAgfSByZXR1cm4gcmVzdWx0Owp9Owp2YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCl7CiAgdmFyIElTX09QICA9IGl0ID09PSBPYmplY3RQcm90bwogICAgLCBuYW1lcyAgPSBnT1BOKElTX09QID8gT1BTeW1ib2xzIDogdG9JT2JqZWN0KGl0KSkKICAgICwgcmVzdWx0ID0gW10KICAgICwgaSAgICAgID0gMAogICAgLCBrZXk7CiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7CiAgICBpZihoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYgKElTX09QID8gaGFzKE9iamVjdFByb3RvLCBrZXkpIDogdHJ1ZSkpcmVzdWx0LnB1c2goQWxsU3ltYm9sc1trZXldKTsKICB9IHJldHVybiByZXN1bHQ7Cn07CgovLyAxOS40LjEuMSBTeW1ib2woW2Rlc2NyaXB0aW9uXSkKaWYoIVVTRV9OQVRJVkUpewogICRTeW1ib2wgPSBmdW5jdGlvbiBTeW1ib2woKXsKICAgIGlmKHRoaXMgaW5zdGFuY2VvZiAkU3ltYm9sKXRocm93IFR5cGVFcnJvcignU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIScpOwogICAgdmFyIHRhZyA9IHVpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7CiAgICB2YXIgJHNldCA9IGZ1bmN0aW9uKHZhbHVlKXsKICAgICAgaWYodGhpcyA9PT0gT2JqZWN0UHJvdG8pJHNldC5jYWxsKE9QU3ltYm9scywgdmFsdWUpOwogICAgICBpZihoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKXRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7CiAgICAgIHNldFN5bWJvbERlc2ModGhpcywgdGFnLCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7CiAgICB9OwogICAgaWYoREVTQ1JJUFRPUlMgJiYgc2V0dGVyKXNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0fSk7CiAgICByZXR1cm4gd3JhcCh0YWcpOwogIH07CiAgcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEVdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpewogICAgcmV0dXJuIHRoaXMuX2s7CiAgfSk7CgogICRHT1BELmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwogICREUC5mICAgPSAkZGVmaW5lUHJvcGVydHk7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg2NSkuZiA9IGdPUE5FeHQuZiA9ICRnZXRPd25Qcm9wZXJ0eU5hbWVzOwogIF9fd2VicGFja19yZXF1aXJlX18oNDEpLmYgID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlOwogIF9fd2VicGFja19yZXF1aXJlX18oNTgpLmYgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKICBpZihERVNDUklQVE9SUyAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygyNSkpewogICAgcmVkZWZpbmUoT2JqZWN0UHJvdG8sICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsICRwcm9wZXJ0eUlzRW51bWVyYWJsZSwgdHJ1ZSk7CiAgfQoKICB3a3NFeHQuZiA9IGZ1bmN0aW9uKG5hbWUpewogICAgcmV0dXJuIHdyYXAod2tzKG5hbWUpKTsKICB9Cn0KCiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtTeW1ib2w6ICRTeW1ib2x9KTsKCmZvcih2YXIgc3ltYm9scyA9ICgKICAvLyAxOS40LjIuMiwgMTkuNC4yLjMsIDE5LjQuMi40LCAxOS40LjIuNiwgMTkuNC4yLjgsIDE5LjQuMi45LCAxOS40LjIuMTAsIDE5LjQuMi4xMSwgMTkuNC4yLjEyLCAxOS40LjIuMTMsIDE5LjQuMi4xNAogICdoYXNJbnN0YW5jZSxpc0NvbmNhdFNwcmVhZGFibGUsaXRlcmF0b3IsbWF0Y2gscmVwbGFjZSxzZWFyY2gsc3BlY2llcyxzcGxpdCx0b1ByaW1pdGl2ZSx0b1N0cmluZ1RhZyx1bnNjb3BhYmxlcycKKS5zcGxpdCgnLCcpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzKHN5bWJvbHNbaSsrXSk7Cgpmb3IodmFyIHN5bWJvbHMgPSAka2V5cyh3a3Muc3RvcmUpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzRGVmaW5lKHN5bWJvbHNbaSsrXSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywgewogIC8vIDE5LjQuMi4xIFN5bWJvbC5mb3Ioa2V5KQogICdmb3InOiBmdW5jdGlvbihrZXkpewogICAgcmV0dXJuIGhhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKQogICAgICA/IFN5bWJvbFJlZ2lzdHJ5W2tleV0KICAgICAgOiBTeW1ib2xSZWdpc3RyeVtrZXldID0gJFN5bWJvbChrZXkpOwogIH0sCiAgLy8gMTkuNC4yLjUgU3ltYm9sLmtleUZvcihzeW0pCiAga2V5Rm9yOiBmdW5jdGlvbiBrZXlGb3Ioa2V5KXsKICAgIGlmKGlzU3ltYm9sKGtleSkpcmV0dXJuIGtleU9mKFN5bWJvbFJlZ2lzdHJ5LCBrZXkpOwogICAgdGhyb3cgVHlwZUVycm9yKGtleSArICcgaXMgbm90IGEgc3ltYm9sIScpOwogIH0sCiAgdXNlU2V0dGVyOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSB0cnVlOyB9LAogIHVzZVNpbXBsZTogZnVuY3Rpb24oKXsgc2V0dGVyID0gZmFsc2U7IH0KfSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnT2JqZWN0JywgewogIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKICBjcmVhdGU6ICRjcmVhdGUsCiAgLy8gMTkuMS4yLjQgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCiAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSwKICAvLyAxOS4xLjIuMyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKQogIGRlZmluZVByb3BlcnRpZXM6ICRkZWZpbmVQcm9wZXJ0aWVzLAogIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkKICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsCiAgLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcywKICAvLyAxOS4xLjIuOCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKE8pCiAgZ2V0T3duUHJvcGVydHlTeW1ib2xzOiAkZ2V0T3duUHJvcGVydHlTeW1ib2xzCn0pOwoKLy8gMjQuMy4yIEpTT04uc3RyaW5naWZ5KHZhbHVlIFssIHJlcGxhY2VyIFssIHNwYWNlXV0pCiRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbigpewogIHZhciBTID0gJFN5bWJvbCgpOwogIC8vIE1TIEVkZ2UgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIHt9CiAgLy8gV2ViS2l0IGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyBudWxsCiAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHMKICByZXR1cm4gX3N0cmluZ2lmeShbU10pICE9ICdbbnVsbF0nIHx8IF9zdHJpbmdpZnkoe2E6IFN9KSAhPSAne30nIHx8IF9zdHJpbmdpZnkoT2JqZWN0KFMpKSAhPSAne30nOwp9KSksICdKU09OJywgewogIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXsKICAgIGlmKGl0ID09PSB1bmRlZmluZWQgfHwgaXNTeW1ib2woaXQpKXJldHVybjsgLy8gSUU4IHJldHVybnMgc3RyaW5nIG9uIHVuZGVmaW5lZAogICAgdmFyIGFyZ3MgPSBbaXRdCiAgICAgICwgaSAgICA9IDEKICAgICAgLCByZXBsYWNlciwgJHJlcGxhY2VyOwogICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKICAgIHJlcGxhY2VyID0gYXJnc1sxXTsKICAgIGlmKHR5cGVvZiByZXBsYWNlciA9PSAnZnVuY3Rpb24nKSRyZXBsYWNlciA9IHJlcGxhY2VyOwogICAgaWYoJHJlcGxhY2VyIHx8ICFpc0FycmF5KHJlcGxhY2VyKSlyZXBsYWNlciA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpewogICAgICBpZigkcmVwbGFjZXIpdmFsdWUgPSAkcmVwbGFjZXIuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTsKICAgICAgaWYoIWlzU3ltYm9sKHZhbHVlKSlyZXR1cm4gdmFsdWU7CiAgICB9OwogICAgYXJnc1sxXSA9IHJlcGxhY2VyOwogICAgcmV0dXJuIF9zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3MpOwogIH0KfSk7CgovLyAxOS40LjMuNCBTeW1ib2wucHJvdG90eXBlW0BAdG9QcmltaXRpdmVdKGhpbnQpCiRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IF9fd2VicGFja19yZXF1aXJlX18oNikoJFN5bWJvbFtQUk9UT1RZUEVdLCBUT19QUklNSVRJVkUsICRTeW1ib2xbUFJPVE9UWVBFXS52YWx1ZU9mKTsKLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXQpzZXRUb1N0cmluZ1RhZygkU3ltYm9sLCAnU3ltYm9sJyk7Ci8vIDIwLjIuMS45IE1hdGhbQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTsKLy8gMjQuMy4zIEpTT05bQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoZ2xvYmFsLkpTT04sICdKU09OJywgdHJ1ZSk7CgovKioqLyB9KSwKLyogMTA2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdhc3luY0l0ZXJhdG9yJyk7CgovKioqLyB9KSwKLyogMTA3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdvYnNlcnZhYmxlJyk7CgovKioqLyB9KSwKLyogMTA4ICovLAovKiAxMDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfc3RyaW5naWZ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7Cgp2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKZXhwb3J0cy5kaXZpZGVFbWFpbCA9IGRpdmlkZUVtYWlsOwpleHBvcnRzLmVtcHR5T2JqZWN0ID0gZW1wdHlPYmplY3Q7CmV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwpleHBvcnRzLmdldFVzZXJVUkxGcm9tRW1haWwgPSBnZXRVc2VyVVJMRnJvbUVtYWlsOwpleHBvcnRzLmdldFVzZXJFbWFpbEZyb21VUkwgPSBnZXRVc2VyRW1haWxGcm9tVVJMOwpleHBvcnRzLmNvbnZlcnRUb1VzZXJVUkwgPSBjb252ZXJ0VG9Vc2VyVVJMOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwovKioKICogU3VwcG9ydCBtb2R1bGUgd2l0aCBzb21lIGZ1bmN0aW9ucyB3aWxsIGJlIHVzZWZ1bAogKiBAbW9kdWxlIHV0aWxzCiAqLwoKLyoqCiAqIEB0eXBlZGVmIGRpdmlkZVVSTAogKiBAdHlwZSBPYmplY3QKICogQHByb3BlcnR5IHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgVVJMCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkb21haW4gVGhlIGRvbWFpbiBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiBVUkwKICovCgovKioKICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5CiAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAqIEByZXR1cm4ge2RpdmlkZVVSTH0gdGhlIHJlc3VsdCBvZiBkaXZpZGVVUkwKICovCmZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHsKCiAgaWYgKCF1cmwpIHRocm93IEVycm9yKCdVUkwgaXMgbmVlZGVkIHRvIHNwbGl0Jyk7CgogIGZ1bmN0aW9uIHJlY3Vyc2UodmFsdWUpIHsKICAgIHZhciByZWdleCA9IC8oW2EtekEtWi1dKikoOlwvXC8oPzpcLik/fDopKFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTsKICAgIHZhciBzdWJzdCA9ICckMSwkMywkNCc7CiAgICB2YXIgcGFydHMgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBzdWJzdCkuc3BsaXQoJywnKTsKICAgIHJldHVybiBwYXJ0czsKICB9CgogIHZhciBwYXJ0cyA9IHJlY3Vyc2UodXJsKTsKCiAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lCiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgIXBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKCiAgICB2YXIgX3Jlc3VsdCA9IHsKICAgICAgdHlwZTogIiIsCiAgICAgIGRvbWFpbjogdXJsLAogICAgICBpZGVudGl0eTogIiIKICAgIH07CgogICAgY29uc29sZS5lcnJvcignW0RpdmlkZVVSTF0gRGl2aWRlVVJMIGRvblwndCBzdXBwb3J0IHVybCB3aXRob3V0IHNjaGVtZS4gUGxlYXNlIHJldmlldyB5b3VyIHVybCBhZGRyZXNzJywgdXJsKTsKCiAgICByZXR1cm4gX3Jlc3VsdDsKICB9CgogIC8vIGNoZWNrIGlmIHRoZSB1cmwgaGFzIHRoZSBzY2hlbWUgYW5kIGluY2x1ZGVzIGFuIEAKICBpZiAocGFydHNbMF0gPT09IHVybCAmJiBwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CiAgICB2YXIgc2NoZW1lID0gcGFydHNbMF0gPT09IHVybCA/ICdzbXRwJyA6IHBhcnRzWzBdOwogICAgcGFydHMgPSByZWN1cnNlKHNjaGVtZSArICc6Ly8nICsgcGFydHNbMF0pOwogIH0KCiAgLy8gaWYgdGhlIGRvbWFpbiBpbmNsdWRlcyBhbiBALCBkaXZpZGUgaXQgdG8gZG9tYWluIGFuZCBpZGVudGl0eSByZXNwZWN0aXZlbHkKICBpZiAocGFydHNbMV0uaW5jbHVkZXMoJ0AnKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1swXSArICc6Ly8nICsgcGFydHNbMV07CiAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdLnN1YnN0cihwYXJ0c1sxXS5pbmRleE9mKCdAJykgKyAxKTsKICB9IC8qZWxzZSBpZiAocGFydHNbMl0uaW5jbHVkZXMoJy8nKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1syXS5zdWJzdHIocGFydHNbMl0ubGFzdEluZGV4T2YoJy8nKSsxKTsKICAgIH0qLwoKICB2YXIgcmVzdWx0ID0gewogICAgdHlwZTogcGFydHNbMF0sCiAgICBkb21haW46IHBhcnRzWzFdLAogICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgfTsKCiAgcmV0dXJuIHJlc3VsdDsKfQoKZnVuY3Rpb24gZGl2aWRlRW1haWwoZW1haWwpIHsKICB2YXIgaW5kZXhPZkF0ID0gZW1haWwuaW5kZXhPZignQCcpOwoKICB2YXIgcmVzdWx0ID0gewogICAgdXNlcm5hbWU6IGVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpLAogICAgZG9tYWluOiBlbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgZW1haWwubGVuZ3RoKQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBDaGVjayBpZiBhbiBPYmplY3QgaXMgZW1wdHkKICogQHBhcmFtICB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IHRvIGJlIGNoZWNrZWQKICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgc3RhdHVzIG9mIE9iamVjdCwgZW1wdHkgb3Igbm90ICh0cnVlfGZhbHNlKTsKICovCmZ1bmN0aW9uIGVtcHR5T2JqZWN0KG9iamVjdCkgewogIHJldHVybiAoMCwgX2tleXMyLmRlZmF1bHQpKG9iamVjdCkubGVuZ3RoID4gMCA/IGZhbHNlIDogdHJ1ZTsKfQoKLyoqCiAqIE1ha2UgYSBDT1BZIG9mIHRoZSBvcmlnaW5hbCBkYXRhCiAqIEBwYXJhbSAge09iamVjdH0gIG9iaiAtIG9iamVjdCB0byBiZSBjbG9uZWQKICogQHJldHVybiB7T2JqZWN0fQogKi8KZnVuY3Rpb24gZGVlcENsb25lKG9iaikgewogIC8vVE9ETzogc2ltcGxlIGJ1dCBpbmVmZmljaWVudCBKU09OIGRlZXAgY2xvbmUuLi4KICBpZiAob2JqKSByZXR1cm4gSlNPTi5wYXJzZSgoMCwgX3N0cmluZ2lmeTIuZGVmYXVsdCkob2JqKSk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIFVSTCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gZW1haWwKICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICogQHJldHVybiB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICovCmZ1bmN0aW9uIGdldFVzZXJVUkxGcm9tRW1haWwodXNlckVtYWlsKSB7CiAgdmFyIGluZGV4T2ZBdCA9IHVzZXJFbWFpbC5pbmRleE9mKCdAJyk7CiAgcmV0dXJuICd1c2VyOi8vJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgdXNlckVtYWlsLmxlbmd0aCkgKyAnLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIGVtYWlsIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBVUkwKICogQHBhcmFtICB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICogQHJldHVybiB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICovCmZ1bmN0aW9uIGdldFVzZXJFbWFpbEZyb21VUkwodXNlclVSTCkgewogIHZhciB1cmwgPSBkaXZpZGVVUkwodXNlclVSTCk7CiAgcmV0dXJuIHVybC5pZGVudGl0eS5yZXBsYWNlKCcvJywgJycpICsgJ0AnICsgdXJsLmRvbWFpbjsgLy8gaWRlbnRpdHkgZmllbGQgaGFzICcvZXhhbXBsZUlEJyBpbnN0ZWFkIG9mICdleGFtcGxlSUQnCn0KCi8qKgogKiBDaGVjayBpZiB0aGUgdXNlciBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIFVSTCBmb3JtYXQsIGlmIG5vdCwgY29udmVydCB0byBVUkwgZm9ybWF0CiAqIEBwYXJhbSAge3N0cmluZ30gICBpZGVudGlmaWVyICB1c2VyIGlkZW50aWZpZXIKICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMCiAqLwpmdW5jdGlvbiBjb252ZXJ0VG9Vc2VyVVJMKGlkZW50aWZpZXIpIHsKCiAgLy8gY2hlY2sgaWYgdGhlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgdXJsIGZvcm1hdAogIGlmIChpZGVudGlmaWVyLnN1YnN0cmluZygwLCA3KSA9PT0gJ3VzZXI6Ly8nKSB7CiAgICB2YXIgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChpZGVudGlmaWVyKTsKCiAgICAvL2NoZWNrIGlmIHRoZSB1cmwgaXMgd2VsbCBmb3JtYXRlZAogICAgaWYgKGRpdmlkZWRVUkwuZG9tYWluICYmIGRpdmlkZWRVUkwuaWRlbnRpdHkpIHsKICAgICAgcmV0dXJuIGlkZW50aWZpZXI7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyAndXNlclVSTCB3aXRoIHdyb25nIGZvcm1hdCc7CiAgICB9CgogICAgLy9pZiBub3QsIGNvbnZlcnQgdGhlIHVzZXIgZW1haWwgdG8gVVJMIGZvcm1hdAogIH0gZWxzZSB7CiAgICByZXR1cm4gZ2V0VXNlclVSTEZyb21FbWFpbChpZGVudGlmaWVyKTsKICB9Cn0KCi8qKiovIH0pLAovKiAxMTAgKi8sCi8qIDExMSAqLywKLyogMTEyICovLAovKiAxMTMgKi8sCi8qIDExNCAqLywKLyogMTE1ICovLAovKiAxMTYgKi8sCi8qIDExNyAqLywKLyogMTE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMik7Cgp2YXIgX2dldDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMyk7Cgp2YXIgX2dldDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXQyKTsKCnZhciBfaW5oZXJpdHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMyk7Cgp2YXIgX2luaGVyaXRzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2luaGVyaXRzMik7Cgp2YXIgX0RhdGFPYmplY3QyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjApOwoKdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCnZhciBfRGF0YU9iamVjdENoaWxkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjEpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdENoaWxkKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBGaWx0ZXJUeXBlID0geyBBTlk6ICdhbnknLCBTVEFSVDogJ3N0YXJ0JywgRVhBQ1Q6ICdleGFjdCcgfTsKCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBzdWJzY3JpYmUgY2FsbC4KICogVG8gYmUgdXNlZCBhcyBhbiBvYnNlcnZhdGlvbiBwb2ludCBmcm9tIGEgRGF0YU9iamVjdFJlcG9ydGVyIGNoYW5nZS4KICovCgp2YXIgRGF0YU9iamVjdE9ic2VydmVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CiAgKDAsIF9pbmhlcml0czMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBfRGF0YU9iamVjdCk7CgogIC8qIHByaXZhdGUKICBfY2hhbmdlTGlzdGVuZXI6IE1zZ0xpc3RlbmVyCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfZmlsdGVyczogezxmaWx0ZXI+OiB7dHlwZTogPHN0YXJ0LCBleGFjdD4sIGNhbGxiYWNrOiA8ZnVuY3Rpb24+fSB9CiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyLnN1YnNjcmliZSBtZXRob2QKICAgKi8KCiAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogIGZ1bmN0aW9uIERhdGFPYmplY3RPYnNlcnZlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucywgaW5pdGlhbFZlcnNpb24sIG11dHVhbCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdE9ic2VydmVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdE9ic2VydmVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YS5kYXRhLCBjaGlsZHJlbnMsIG11dHVhbCkpOwoKICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IGluaXRpYWxWZXJzaW9uOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewogICAgICBfdGhpcy5fb25GaWx0ZXIoZXZlbnQpOwogICAgfSk7CgogICAgLy9zZXR1cCBjaGlsZHJlbnMgZGF0YSBmcm9tIHN1YnNjcmlwdGlvbgogICAgKDAsIF9rZXlzMi5kZWZhdWx0KShpbml0aWFsRGF0YS5jaGlsZHJlbnMpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkSWQpIHsKICAgICAgdmFyIGNoaWxkRGF0YSA9IGluaXRpYWxEYXRhLmNoaWxkcmVuc1tjaGlsZElkXTsKICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBjaGlsZElkLCBjaGlsZERhdGEpOwogICAgfSk7CgogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwgKyAnL2NoYW5nZXMnLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgaWYgKG1zZy50eXBlID09PSAndXBkYXRlJykgewogICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwogICAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChfdGhpcy5fc3luY09iaiwgbXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICd1bnN1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsVW5TdWJzY3JpYmUKICAgICAgdmFyIHVuU3Vic2NyaWJlTXNnID0gewogICAgICAgIHR5cGU6ICd1bnN1YnNjcmliZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHVuU3Vic2NyaWJlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdE9ic2VydmVyLVVOU1VCU0NSSUJFOiAnLCByZXBseSk7CiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsdGVyIC0gRmlsdGVyIHRoYXQgaWRlbnRpZmllcyB0aGUgZmllbGQgKHNlcGFyYXRlZCBkb3QgcGF0aCkuIEFjY2VwdHMgKiBhdCB0aGUgZW5kIGZvciBhIG1vcmUgdW5yZXN0cmljdGVkIGZpbHRlcmluZy4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkNoYW5nZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2UoZmlsdGVyLCBjYWxsYmFjaykgewogICAgICB2YXIga2V5ID0gZmlsdGVyOwogICAgICB2YXIgZmlsdGVyT2JqID0gewogICAgICAgIHR5cGU6IEZpbHRlclR5cGUuRVhBQ1QsCiAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrCiAgICAgIH07CgogICAgICB2YXIgaWR4ID0gZmlsdGVyLmluZGV4T2YoJyonKTsKICAgICAgaWYgKGlkeCA9PT0gZmlsdGVyLmxlbmd0aCAtIDEpIHsKICAgICAgICBpZiAoaWR4ID09PSAwKSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuQU5ZOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuU1RBUlQ7CiAgICAgICAgICBrZXkgPSBmaWx0ZXIuc3Vic3RyKDAsIGZpbHRlci5sZW5ndGggLSAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuX2ZpbHRlcnNba2V5XSA9IGZpbHRlck9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25GaWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZpbHRlcihldmVudCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fZmlsdGVycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdmFyIGZpbHRlciA9IF90aGlzLl9maWx0ZXJzW2tleV07CiAgICAgICAgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLkFOWSkgewogICAgICAgICAgLy9tYXRjaCBhbnl0aGluZwogICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKICAgICAgICB9IGVsc2UgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLlNUQVJUKSB7CiAgICAgICAgICAvL2lmIHN0YXJ0cyB3aXRoIGZpbHRlci4uLgogICAgICAgICAgaWYgKGV2ZW50LmZpZWxkLmluZGV4T2Yoa2V5KSA9PT0gMCkgewogICAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuRVhBQ1QpIHsKICAgICAgICAgIC8vZXhhY3QgbWF0Y2gKICAgICAgICAgIGlmIChldmVudC5maWVsZCA9PT0ga2V5KSB7CiAgICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFPYmplY3RPYnNlcnZlcjsKfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdE9ic2VydmVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKdmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yKTsKCnZhciBfZ2V0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCnZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKdmFyIF9pbmhlcml0czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTsKCnZhciBfaW5oZXJpdHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5oZXJpdHMyKTsKCnZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCk7Cgp2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgY3JlYXRlIGNhbGwuCiAqIFRvIGJlIHVzZWQgYXMgYSByZXBvcnRlciBwb2ludCwgY2hhbmdlcyB3aWxsIGJlIHN1Ym1pdGVkIHRvIERhdGFPYmplY3RPYnNlcnZlciBpbnN0YW5jZXMuCiAqLwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBEYXRhT2JqZWN0UmVwb3J0ZXIgPSBmdW5jdGlvbiAoX0RhdGFPYmplY3QpIHsKICAoMCwgX2luaGVyaXRzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIF9EYXRhT2JqZWN0KTsKCiAgLyogcHJpdmF0ZQogIF9zdWJzY3JpcHRpb25zOiA8aHlwZXJ0eVVybDogeyBzdGF0dXM6IHN0cmluZyB9IH0+CiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25TdWJzY3JpcHRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICBfb25SZXNwb25zZUhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlYWRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuY3JlYXRlIG1ldGhvZAogICAqLwogIGZ1bmN0aW9uIERhdGFPYmplY3RSZXBvcnRlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdFJlcG9ydGVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdFJlcG9ydGVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSk7CgogICAgdmFyIF90aGlzID0gX3RoaXMyOwoKICAgIF90aGlzLl9zdWJzY3JpcHRpb25zID0ge307CgogICAgX3RoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci0nICsgdXJsICsgJy1TRU5EOiAnLCBldmVudCk7CiAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCk7CiAgICB9KTsKCiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgIHJldHVybiBfdGhpczI7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX2FsbG9jYXRlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9vYmplY3RMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgewogICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0LScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewogICAgICAgICAgY2FzZSAncmVzcG9uc2UnOgogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpO2JyZWFrOwogICAgICAgICAgY2FzZSAncmVhZCc6CiAgICAgICAgICAgIF90aGlzLl9vblJlYWQobXNnKTticmVhazsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX29iamVjdExpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogU2VuZCBpbnZpdGF0aW9ucyAoY3JlYXRlIG1lc3NhZ2VzKSB0byBoeXBlcnRpZXMsIG9ic2VydmVycyBsaXN0LgogICAgICogQHBhcmFtICB7SHlwZXJ0eVVSTFtdfSBvYnNlcnZlcnMgTGlzdCBvZiBIeXBlcnR5IFVSTCdzCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnaW52aXRlT2JzZXJ2ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnZpdGVPYnNlcnZlcnMob2JzZXJ2ZXJzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkNyZWF0ZQogICAgICB2YXIgaW52aXRlTXNnID0gewogICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fc3luY2hlci5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAogICAgICAgIGJvZHk6IHsgcmVzdW1lOiBmYWxzZSwgcmVzb3VyY2U6IF90aGlzLl91cmwsIHNjaGVtYTogX3RoaXMuX3NjaGVtYSwgdmFsdWU6IF90aGlzLl9zeW5jT2JqLmRhdGEsIGF1dGhvcmlzZTogb2JzZXJ2ZXJzIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoaW52aXRlTXNnKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uRGVsZXRlCiAgICAgIHZhciBkZWxldGVNc2cgPSB7CiAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGRlbGV0ZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1ERUxFVEU6ICcsIHJlcGx5KTsKICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX3JlcG9ydGVyc1tfdGhpcy5fdXJsXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU3Vic2NyaXB0aW9ucyByZXF1ZXN0ZWQgYW5kIGFjY2VwdGVkIHRvIHRoaXMgcmVwb3J0ZXIKICAgICAqIEB0eXBlIHtPYmplY3Q8SHlwZXJ0eVVSTCwgU3luY1N1YnNjcmlwdGlvbj59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25TdWJzY3JpcHRpb24nLAoKCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHN1YnNjcmliZSBhbmQgdW5zdWJzY3JpYmUgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TdWJzY3JpcHRpb24oY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZXNwb25zZSBub3RpZmljYXRpb25zIG9mIHRoZSBjcmVhdGUncwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlYWQgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVhZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZWFkKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVhZEhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBwYXJlbnQgU3luY2hlciAtPiBfb25Gb3J3YXJkCgogIH0sIHsKICAgIGtleTogJ19vbkZvcndhcmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLVJDVjogJywgbXNnKTsKICAgICAgc3dpdGNoIChtc2cuYm9keS50eXBlKSB7CiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblN1YnNjcmliZShtc2cpO2JyZWFrOwogICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGlzIC0+IF9vbkZvcndhcmQ6IGVtaXR0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBzdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uU3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdWJzY3JpYmUobXNnKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwogICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RSZXBvcnRlci5fb25TdWJzY3JpYmVdJywgbXNnKTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIC8vY3JlYXRlIG5ldyBzdWJzY3JpcHRpb24KICAgICAgICAgIHZhciBzdWIgPSB7IHVybDogaHlwZXJ0eVVybCwgc3RhdHVzOiAnb24nIH07CiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjsKCiAgICAgICAgICAvL3Byb2Nlc3MgYW5kIHNlbmQgY2hpbGRyZW5zIGRhdGEKICAgICAgICAgIHZhciBjaGlsZHJlblZhbHVlcyA9IHt9OwogICAgICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CiAgICAgICAgICAgIHZhciBjaGlsZERhdGEgPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLmRhdGE7CiAgICAgICAgICAgIGNoaWxkcmVuVmFsdWVzW2NoaWxkSWRdID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGNoaWxkRGF0YSk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgc2VuZE1zZyA9IHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoX3RoaXMuZGF0YSksIGNoaWxkcmVuczogY2hpbGRyZW5WYWx1ZXMgfSB9CiAgICAgICAgICB9OwoKICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsQXV0aGVudGljYXRpb24nKSAmJiAhbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24pIHsKICAgICAgICAgICAgc2VuZE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbjsKICAgICAgICAgICAgX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBvayByZXNwb25zZSBtZXNzYWdlCiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHNlbmRNc2cpOwoKICAgICAgICAgIHJldHVybiBzdWI7CiAgICAgICAgfSwKCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7CiAgICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdTVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoaXMgLT4gX29uRm9yd2FyZDogZW1pdHRlZCBieSBhIHJlbW90ZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgLT4gdW5zdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uVW5TdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblVuU3Vic2NyaWJlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgaHlwZXJ0eVVybCA9IG1zZy5ib2R5LmZyb207CgogICAgICB2YXIgc3ViID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CiAgICAgIGRlbGV0ZSBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKICAgICAgICBvYmplY3Q6IHN1YgogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBSZXBvcnRlclVSTCBhZGRyZXNzOiBlbWl0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBfb25SZW1vdGVDcmVhdGUgLT4gZXZlbnQuYWNrCgogIH0sIHsKICAgIGtleTogJ19vblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZXNwb25zZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICB1cmw6IG1zZy5mcm9tLAogICAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGUKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVTUE9OU0UtRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gcmVhZAoKICB9LCB7CiAgICBrZXk6ICdfb25SZWFkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWFkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmZyb20sCgogICAgICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgdmFsdWU6ICgwLCBfdXRpbHMuZGVlcENsb25lKShfdGhpcy5kYXRhKSB9CiAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDEsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uUmVhZEhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVBRC1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblJlYWRIYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3N1YnNjcmlwdGlvbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdFJlcG9ydGVyOwp9KF9EYXRhT2JqZWN0My5kZWZhdWx0IC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0UmVwb3J0ZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEyMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9wcm9taXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7Cgp2YXIgX3Byb21pc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvbWlzZSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX1Byb3h5T2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKdmFyIF9Qcm94eU9iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Qcm94eU9iamVjdCk7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCnZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7Cgp2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBNYWluIGV4dGVuc2lvbiBjbGFzcyBmb3Igb2JzZXJ2ZXJzIGFuZCByZXBvcnRlcnMsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIG1ldGhvZHMuCiAqIENoaWxkcmVuIG1hbmFnZW1lbnQgaXMgY29tbW9uIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycy4KICovCnZhciBEYXRhT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICBfdmVyc2lvbjogbnVtYmVyCiAgIF9vd25lcjogSHlwZXJ0eVVSTAogIF91cmw6IE9iamVjdFVSTAogIF9zY2hlbWE6IFNjaGVtYQogIF9idXM6IE1pbmlCdXMKICBfc3RhdHVzOiBvbiB8IHBhdXNlZAogIF9zeW5jT2JqOiBTeW5jRGF0YQogICBfY2hpbGRyZW46IHsgaWQ6IERhdGFPYmplY3RDaGlsZCB9CiAgX2NoaWxkcmVuTGlzdGVuZXJzOiBbTXNnTGlzdGVuZXJdCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25BZGRDaGlsZEhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogICovCgogIC8qKgogICAqIEBpZ25vcmUKICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlciBjcmVhdGUgb3Igc3Vic2NyaWJlIG1ldGhvZCdzCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdChzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgdmFyIG11dHVhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDogdHJ1ZTsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX3N5bmNoZXIgPSBzeW5jaGVyOwogICAgX3RoaXMuX3VybCA9IHVybDsKICAgIF90aGlzLl9zY2hlbWEgPSBzY2hlbWE7CiAgICBfdGhpcy5fc3RhdHVzID0gaW5pdGlhbFN0YXR1czsKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CiAgICBfdGhpcy5fY2hpbGRyZW5zID0gY2hpbGRyZW5zOwoKICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgIF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbDsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IDA7CiAgICBfdGhpcy5fY2hpbGRJZCA9IDA7CiAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzID0ge307CiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTsKCiAgICBfdGhpcy5fb3duZXIgPSBzeW5jaGVyLl9vd25lcjsKICAgIF90aGlzLl9idXMgPSBzeW5jaGVyLl9idXM7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0LCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBjaGlsZEJhc2VVUkwgPSBfdGhpcy5fdXJsICsgJy9jaGlsZHJlbi8nOwogICAgICBjb25zb2xlLmxvZygnW0RhdGEgT2JqZWN0IC0gQWxsb2NhdGVMaXN0ZW5lcnNdIC0gJywgX3RoaXMuX2NoaWxkcmVucyk7CiAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW5zKSB7CiAgICAgICAgX3RoaXMuX2NoaWxkcmVucy5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkgewogICAgICAgICAgdmFyIGNoaWxkVVJMID0gY2hpbGRCYXNlVVJMICsgY2hpbGQ7CiAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgICAgICAgaWYgKG1zZy5mcm9tICE9PSBfdGhpczIuX293bmVyKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3QtQ2hpbGRyZW4tUkNWOiAnLCBtc2cpOwogICAgICAgICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6CiAgICAgICAgICAgICAgICAgIF90aGlzLl9vbkNoaWxkQ3JlYXRlKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOgogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO2JyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgX3RoaXMuX2NoYW5nZUNoaWxkcmVuKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHsKICAgICAgICBsaXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfSk7CgogICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNba2V5XS5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBVUkwgb2YgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIKICAgICAqIEB0eXBlIHtPYmplY3RVUkx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncGF1c2UnLAoKCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkgewogICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CiAgICB9CgogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncmVzdW1lJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7CiAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdG9wJywKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICAvL1RPRE86IHNob3VsZCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBhbmQgc2VuZCBtZXNzYWdlIHVuc3Vic2NyaWJlPwogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgYWRkIGEgRGF0YU9iamVjdENoaWxkIHRvIGEgY2hpbGRyZW4gY29sbGVjdGlvbi4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGlsZHJlbiAtIENoaWxkcmVuIG5hbWUgd2hlcmUgdGhlIGNoaWxkIGlzIGFkZGVkLgogICAgICogQHBhcmFtIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgY2hpbGQKICAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdENoaWxkPn0gLSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBEYXRhT2JqZWN0Q2hpbGQuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnYWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENoaWxkKGNoaWxkcmVuLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9jcmVhdGUgbmV3IGNoaWxkIHVuaXF1ZSBJRCwgYmFzZWQgb24gaHlwZXJ0eVVSTAogICAgICBfdGhpcy5fY2hpbGRJZCsrOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IF90aGlzLl9vd25lciArICcjJyArIF90aGlzLl9jaGlsZElkOwogICAgICB2YXIgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJyArIGNoaWxkcmVuOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoaWxkIGFkZHJlc3M6IE1lc3NhZ2VCdXMKICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IG1zZ0NoaWxkUGF0aCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBtc2dDaGlsZElkLCB2YWx1ZTogaW5pdGlhbERhdGEgfQogICAgICB9OwoKICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgcmVxdWVzdE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uOwoKICAgICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbAogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgdmFyIG1zZ0lkID0gX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXF1ZXN0TXNnKTsKCiAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZS1yZXBvcnRlci1jaGlsZCggJyArIF90aGlzLl9vd25lciArICcgKTogJywgcmVxdWVzdE1zZyk7CiAgICAgICAgdmFyIG5ld0NoaWxkID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIG1zZ0NoaWxkSWQsIGluaXRpYWxEYXRhLCBfdGhpcy5fb3duZXIsIG1zZ0lkKTsKICAgICAgICBuZXdDaGlsZC5vbkNoYW5nZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCwgeyBwYXRoOiBtc2dDaGlsZFBhdGgsIGNoaWxkSWQ6IG1zZ0NoaWxkSWQgfSk7CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgICAgcmVzb2x2ZShuZXdDaGlsZCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgY3JlYXRlIGFuZCBkZWxldGUgb2YgY2hpbGRyZW5zLgogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uQWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQWRkQ2hpbGQoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IGFkZENoaWxkCgogIH0sIHsKICAgIGtleTogJ19vbkNoaWxkQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGlsZENyZWF0ZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIG1zZ0NoaWxkSWQgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUtb2JzZXJ2ZXItY2hpbGQoICcgKyBfdGhpcy5fb3duZXIgKyAnICk6ICcsIG1zZyk7CiAgICAgIHZhciBuZXdDaGlsZCA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBtc2dDaGlsZElkLCBtc2cuYm9keS52YWx1ZSk7CiAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIC8vRkxPVy1PVVQ6IHdpbGwgZmxvdyB0byBEYXRhT2JqZWN0Q2hpbGQgLT4gX29uUmVzcG9uc2UKICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHNvdXJjZTogX3RoaXMuX293bmVyIH0KICAgICAgICB9KTsKICAgICAgfSk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmZyb20sCiAgICAgICAgdXJsOiBtc2cudG8sCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGNoaWxkSWQ6IG1zZ0NoaWxkSWQsCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ0FERC1DSElMRFJFTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL3NlbmQgZGVsdGEgbWVzc2FnZXMgdG8gc3Vic2NyaXB0aW9ucwoKICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoYW5nZShldmVudCwgY2hpbGRJbmZvKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fdmVyc2lvbisrOwoKICAgICAgaWYgKF90aGlzLl9zdGF0dXMgPT09ICdvbicpIHsKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIGEgcmVzb3VyY2UgY2hhbmdlcyBhZGRyZXNzOiBNZXNzYWdlQnVzCiAgICAgICAgdmFyIGNoYW5nZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogX3RoaXMuX3VybCArICcvY2hhbmdlcycsCiAgICAgICAgICBib2R5OiB7IHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCBzb3VyY2U6IF90aGlzLl9vd25lciwgYXR0cmlidXRlOiBldmVudC5maWVsZCB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0IC0gX29uQ2hhbmdlXSAtICcsIGV2ZW50LCBjaGlsZEluZm8sIGNoYW5nZU1zZyk7CgogICAgICAgIGlmIChldmVudC5vVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuT0JKRUNUKSB7CiAgICAgICAgICBpZiAoZXZlbnQuY1R5cGUgIT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPSBldmVudC5vVHlwZTsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKICAgICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuVVBEQVRFKSB7CiAgICAgICAgICAgIGNoYW5nZU1zZy5ib2R5Lm9wZXJhdGlvbiA9IGV2ZW50LmNUeXBlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy9jaGlsZEluZm8gbXVzdCBoYXZlIChwYXRoLCBjaGlsZElkKQogICAgICAgIGlmIChjaGlsZEluZm8pIHsKICAgICAgICAgIGNoYW5nZU1zZy50byA9IGNoaWxkSW5mby5wYXRoOwogICAgICAgICAgY2hhbmdlTXNnLmJvZHkucmVzb3VyY2UgPSBjaGlsZEluZm8uY2hpbGRJZDsKICAgICAgICB9CgogICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgY2hhbmdlTXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoY2hhbmdlTXNnKTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogZGVsdGEgbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RSZXBvcnRlciBvciBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VPYmplY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VPYmplY3Qoc3luY09iaiwgbXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL1RPRE86IHVwZGF0ZSB2ZXJzaW9uID8KICAgICAgLy9ob3cgdG8gaGFuZGxlIGFuIGluY29ycmVjdCB2ZXJzaW9uID8gRXhhbXBsZTogcmVjZWl2ZSBhIHZlcnNpb24gMyB3aGVuIHRoZSBvYnNlcnZlciBpcyBpbiB2ZXJzaW9uIDEsIHdoZXJlIGlzIHRoZSB2ZXJzaW9uIDIgPwogICAgICAvL3dpbGwgd2UgbmVlZCB0byBjb25maXJtIHRoZSByZWNlcHRpb24gPwogICAgICBpZiAoX3RoaXMuX3ZlcnNpb24gKyAxID09PSBtc2cuYm9keS52ZXJzaW9uKSB7CiAgICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKICAgICAgICB2YXIgcGF0aCA9IG1zZy5ib2R5LmF0dHJpYnV0ZTsKICAgICAgICB2YXIgdmFsdWUgPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkobXNnLmJvZHkudmFsdWUpOwogICAgICAgIHZhciBmaW5kUmVzdWx0ID0gc3luY09iai5maW5kQmVmb3JlKHBhdGgpOwoKICAgICAgICBpZiAobXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuQVJSQVkpIHsKICAgICAgICAgIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLkFERCkgewogICAgICAgICAgICB2YXIgYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBpbmRleCA9IGZpbmRSZXN1bHQubGFzdDsKICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShhcnIsIFtpbmRleCwgMF0uY29uY2F0KHZhbHVlKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CiAgICAgICAgICAgIHZhciBfYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBfaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIF9hcnIuc3BsaWNlKF9pbmRleCwgdmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XSA9IHZhbHVlOyAvLyBVUERBVEUKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKG1zZy5ib2R5LnZhbHVlKSB7CiAgICAgICAgICAgIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF0gPSB2YWx1ZTsgLy8gVVBEQVRFIG9yIEFERAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVsZXRlIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF07IC8vIFJFTU9WRQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvL1RPRE86IGhvdyB0byBoYW5kbGUgdW5zeW5jaHJvbml6ZWQgdmVyc2lvbnM/CiAgICAgICAgY29uc29sZS5sb2coJ1VOU1lOQ0hST05JWkVEIFZFUlNJT046IChkYXRhID0+ICcgKyBfdGhpcy5fdmVyc2lvbiArICcsIG1zZyA9PiAnICsgbXNnLmJvZHkudmVyc2lvbiArICcpJyk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VDaGlsZHJlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NoYW5nZUNoaWxkcmVuKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBjb25zb2xlLmxvZygnQ2hhbmdlIGNoaWxkcmVuOiAnLCBfdGhpcy5fb3duZXIsIG1zZyk7CgogICAgICB2YXIgY2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlOwogICAgICB2YXIgY2hpbGRyZW4gPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdOwoKICAgICAgaWYgKGNoaWxkcmVuKSB7CiAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChjaGlsZHJlbi5fc3luY09iaiwgbXNnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygnTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAnLCBjaGlsZElkKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3VybCcsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3VybDsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBzY2hlbWEgVVJMICh0aGlzIGZpZWxkIGlzIG5vdCB5ZXQgc3RhYmxlLCBhbmQgaXMgc3Vic2plY3QgdG8gY2hhbmdlKQogICAgICogQHR5cGUge1NjaGVtYVVSTH0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzY2hlbWEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zY2hlbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdGF0dXMgb2YgdGhlIHJlcG9ydGVyIG9yIG9ic2VydmVyIGNvbm5lY3Rpb24gKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpCiAgICAgKiBAdHlwZSB7U3RhdHVzfSAtIEVudW0gb2Y6IG9uIHwgcGF1c2VkCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnc3RhdHVzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3RhdHVzOwogICAgfQoKICAgIC8qKgogICAgICogRGF0YSBzdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLgogICAgICogQHR5cGUge0pTT059IC0gSlNPTiBzdHJ1Y3R1cmUgdGhhdCBzaG91bGQgZm9sbG93IHRoZSBkZWZpbmVkIHNjaGVtYSwgaWYgYW55LgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RhdGEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGwgY3JlYXRlZCBjaGlsZHJlbidzIHNpbmNlIHRoZSBzdWJzY3JpcHRpb24sIGRvZXNuJ3QgY29udGFpbiBhbGwgY2hpbGRyZW4ncyBzaW5jZSByZXBvcnRlciBjcmVhdGlvbi4KICAgICAqIEB0eXBlIHtPYmplY3Q8Q2hpbGRJZCwgRGF0YU9iamVjdENoaWxkPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdjaGlsZHJlbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhT2JqZWN0Owp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTIxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIyKTsKCnZhciBfUHJveHlPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUHJveHlPYmplY3QpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgRGF0YU9iamVjdCBhZGRDaGlsZHJlbiBjYWxsIG9yIGZyb20gb25BZGRDaGlsZHJlbiBpZiByZW1vdGVseSBjcmVhdGVkLgogKiBDaGlsZHJlbiBvYmplY3Qgc3luY2hyb25pemF0aW9uIGlzIGEgYSBmYXN0IGZvcndhcmQgbWVjaGFuaXNtLCBubyBuZWVkIGZvciBkaXJlY3Qgc3Vic2NyaXB0aW9ucywgaXQgdXNlcyB0aGUgYWxyZWFkeSBhdXRob3JpemVkIHN1YnNjcmlwdGlvbiBmcm9tIHRoZSBwYXJlbnQgRGF0YU9iamVjdC4KICovCnZhciBEYXRhT2JqZWN0Q2hpbGQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBEYXRhT2JqZWN0LmFkZENoaWxkcmVuCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdENoaWxkKHBhcmVudCwgY2hpbGRJZCwgaW5pdGlhbERhdGEsIG93bmVyLCBtc2dJZCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdENoaWxkKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9wYXJlbnQgPSBwYXJlbnQ7CiAgICBfdGhpcy5fY2hpbGRJZCA9IGNoaWxkSWQ7CiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl9tc2dJZCA9IG1zZ0lkOwoKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CgogICAgX3RoaXMuX2J1cyA9IHBhcmVudC5fYnVzOwogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0Q2hpbGQsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vdGhpcyBpcyBvbmx5IG5lZWRlZCBmb3IgY2hpbGRyZW4gcmVwb3J0ZXJzCiAgICAgIGlmIChfdGhpcy5fb3duZXIpIHsKICAgICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl9vd25lciwgZnVuY3Rpb24gKG1zZykgewogICAgICAgICAgaWYgKG1zZy50eXBlID09PSAncmVzcG9uc2UnICYmIG1zZy5pZCA9PT0gX3RoaXMuX21zZ0lkKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZTonLCBtc2cpOwogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKF90aGlzLl9saXN0ZW5lcikgewogICAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgZGVsZXRlIF90aGlzLl9wYXJlbnQuX2NoaWxkcmVuW190aGlzLl9jaGlsZElkXTsKCiAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgogICAgICAvL1RPRE86IHNlbmQgZGVsZXRlIG1lc3NhZ2UgPwogICAgfQoKICAgIC8qKgogICAgICogQ2hpbGRyZW4gSUQgZ2VuZXJhdGVkIG9uIGFkZENoaWxkcmVuLiBVbmlxdWUgaWRlbnRpZmllcgogICAgICogQHR5cGUge1VSTH0gLSBVUkwgb2YgdGhlIGZvcm1hdCA8SHlwZXJ0eVVSTD4jPG51bWVyaWMtc2VxdWVuY2U+CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25DaGFuZ2UnLAoKCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyIGNoaWxkCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZShjYWxsYmFjaykgewogICAgICB0aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlc3BvbnNlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIGNyZWF0ZXMKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlc3BvbnNlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVzcG9uc2VIYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdCAtPiBfb25DaGlsZENyZWF0ZQoKICB9LCB7CiAgICBrZXk6ICdfb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVzcG9uc2UobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgdXJsOiBtc2cuYm9keS5zb3VyY2UsCiAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdjaGlsZElkJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKICAgIH0KCiAgICAvKioKICAgICAqIERhdGEgU3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC4KICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdENoaWxkOwp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdENoaWxkOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5PYmplY3RUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0gdW5kZWZpbmVkOwoKdmFyIF9zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCnZhciBfc3RyaW5naWZ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmeSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKX193ZWJwYWNrX3JlcXVpcmVfXygxNTMpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBvYmplY3RUeXBlID0geyBBUlJBWTogJ1tvYmplY3QgQXJyYXldJywgT0JKRUNUOiAnW29iamVjdCBPYmplY3RdJyB9OwoKLyoqCiAqIEBhY2Nlc3MgcHJpdmF0ZQogKiBNYWluIGNsYXNzIHRoYXQgbWFpbnRhaW5zIGEgSlNPTiBvYmplY3QsIGFuZCBvYnNlcnZlcyBjaGFuZ2VzIGluIHRoaXMgb2JqZWN0LCByZWN1cnNpdmVseS4KICogSW50ZXJuYWwgb2JqZWN0cyBhbmQgYXJyYXlzIGFyZSBhbHNvIG9ic2VydmVkLgogKi8KCnZhciBTeW5jT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFN5bmNPYmplY3QoaW5pdGlhbERhdGEpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFN5bmNPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX29ic2VydmVycyA9IFtdOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICB0aGlzLl9kYXRhID0gaW5pdGlhbERhdGEgfHwge307CgogICAgdGhpcy5faW50ZXJuYWxPYnNlcnZlKHRoaXMuX2RhdGEpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoU3luY09iamVjdCwgW3sKICAgIGtleTogJ29ic2VydmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnB1c2goY2FsbGJhY2spOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmQocGF0aCkgewogICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCiAgICAgIHJldHVybiB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmRCZWZvcmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRCZWZvcmUocGF0aCkgewogICAgICB2YXIgcmVzdWx0ID0ge307CiAgICAgIHZhciBsaXN0ID0gcGF0aC5zcGxpdCgnLicpOwogICAgICByZXN1bHQubGFzdCA9IGxpc3QucG9wKCk7CiAgICAgIHJlc3VsdC5vYmogPSB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmluZFdpdGhTcGxpdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbmRXaXRoU3BsaXQobGlzdCkgewogICAgICB2YXIgb2JqID0gdGhpcy5fZGF0YTsKICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIG9iaiA9IG9ialt2YWx1ZV07CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIG9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfaXNPYnNlcnZhYmxlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNPYnNlcnZhYmxlKG9iaikgewogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBPYmplY3QgfHwgb2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2ludGVybmFsT2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsT2JzZXJ2ZShvYmplY3QpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoY2hhbmdlc2V0KSB7CgogICAgICAgIGNoYW5nZXNldC5ldmVyeShmdW5jdGlvbiAoY2hhbmdlKSB7CiAgICAgICAgICBfdGhpczIuX29uQ2hhbmdlcyhjaGFuZ2UpOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgdGhpcy5fZGF0YSA9IE9iamVjdC5kZWVwT2JzZXJ2ZShvYmplY3QsIGhhbmRsZXIpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19maXJlRXZlbnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maXJlRXZlbnQoZXZlbnQpIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2VzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2VzKGNoYW5nZSkgewoKICAgICAgdmFyIG9iaiA9IGNoYW5nZS5vYmplY3Q7CiAgICAgIHZhciBvYmpUeXBlID0gdm9pZCAwOwoKICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuT0JKRUNUOwogICAgICB9CgogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIG9ialR5cGUgPSBPYmplY3RUeXBlLkFSUkFZOwogICAgICB9CgogICAgICB2YXIgZmllbGRTdHJpbmcgPSBjaGFuZ2Uua2V5cGF0aDsKCiAgICAgIC8vIGNvbnNvbGUubG9nKCdGaWVsZDonLCBmaWVsZFN0cmluZyk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCd0eXBlOicsIGNoYW5nZS50eXBlKTsKCiAgICAgIC8vbGV0IG9sZFZhbHVlID0gY2hhbmdlLm9sZFZhbHVlOwogICAgICB2YXIgbmV3VmFsdWUgPSBvYmpbY2hhbmdlLm5hbWVdOwoKICAgICAgY29uc29sZS5pbmZvKGNoYW5nZS50eXBlICsgJyB8IEZpZWxkOiAnICsgZmllbGRTdHJpbmcgKyAnIHwgTmV3IFZhbHVlOicsICgwLCBfc3RyaW5naWZ5Mi5kZWZhdWx0KShuZXdWYWx1ZSkpOwoKICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAndXBkYXRlJykgewogICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5VUERBVEUsCiAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZywKICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2FkZCcpIHsKICAgICAgICB0aGlzLl9maXJlRXZlbnQoewogICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuQURELAogICAgICAgICAgb1R5cGU6IG9ialR5cGUsCiAgICAgICAgICBmaWVsZDogZmllbGRTdHJpbmcsCiAgICAgICAgICBkYXRhOiBuZXdWYWx1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdkZWxldGUnKSB7CiAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLlJFTU9WRSwKICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fZGF0YTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFN5bmNPYmplY3Q7Cn0oKTsKCnZhciBDaGFuZ2VUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0geyBVUERBVEU6ICd1cGRhdGUnLCBBREQ6ICdhZGQnLCBSRU1PVkU6ICdyZW1vdmUnIH07CnZhciBPYmplY3RUeXBlID0gZXhwb3J0cy5PYmplY3RUeXBlID0geyBPQkpFQ1Q6ICdvYmplY3QnLCBBUlJBWTogJ2FycmF5JyB9OwpleHBvcnRzLmRlZmF1bHQgPSBTeW5jT2JqZWN0OwoKLyoqKi8gfSksCi8qIDEyMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzOCk7Cgp2YXIgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgewogIGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsKICB2YXIgZGVzYyA9ICgwLCBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMi5kZWZhdWx0KShvYmplY3QsIHByb3BlcnR5KTsKCiAgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgewogICAgdmFyIHBhcmVudCA9ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKG9iamVjdCk7CgogICAgaWYgKHBhcmVudCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7CiAgICB9CiAgfSBlbHNlIGlmICgidmFsdWUiIGluIGRlc2MpIHsKICAgIHJldHVybiBkZXNjLnZhbHVlOwogIH0gZWxzZSB7CiAgICB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7CgogICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsKICB9Cn07CgovKioqLyB9KSwKLyogMTI0ICovLAovKiAxMjUgKi8sCi8qIDEyNiAqLywKLyogMTI3ICovLAovKiAxMjggKi8sCi8qIDEyOSAqLywKLyogMTMwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX3Byb21pc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCnZhciBfYXNzaWduID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzYpOwoKdmFyIF9hc3NpZ24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXNzaWduKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE5KTsKCnZhciBfRGF0YU9iamVjdFJlcG9ydGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RSZXBvcnRlcik7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE4KTsKCnZhciBfRGF0YU9iamVjdE9ic2VydmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RPYnNlcnZlcik7Cgp2YXIgX0RhdGFQcm92aXNpb25hbCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMzKTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFQcm92aXNpb25hbCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogVGhlIG1haW4gY2xhc3MgZm9yIHRoZSBzeW5jaGVyIHBhY2thZ2UuCiogVGhlIFN5bmNoZXIgaXMgYSBzaW5nbGV0b24gY2xhc3MgcGVyIEh5cGVydHkvVVJMIGFuZCBpdCBpcyB0aGUgb3duZXIgb2YgYWxsIGNyZWF0ZWQgRGF0YSBTeW5jIE9iamVjdHMgYWNjb3JkaW5nIHRvIHRoZSBSZXBvcnRlciAtIE9ic2VydmVyIHBhdHRlcm4uCiogTWFpbiBmdW5jdGlvbmFsaXR5IGlzIHRvIGNyZWF0ZSByZXBvcnRlcnMgYW5kIHRvIHN1YnNjcmliZSB0byBleGlzdGluZyBvbmVzLgoqLwp2YXIgU3luY2hlciA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgX293bmVyOiBVUkwKICBfYnVzOiBNaW5pQnVzCiAgIF9zdWJVUkw6IFVSTAogICBfcmVwb3J0ZXJzOiA8dXJsOiBEYXRhT2JqZWN0UmVwb3J0ZXI+CiAgX29ic2VydmVyczogPHVybDogRGF0YU9iamVjdE9ic2VydmVyPgogIF9wcm92aXNpb25hbHM6IDx1cmw6IERhdGFQcm92aXNpb25hbD4KICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vbk5vdGlmaWNhdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlc3VtZTogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgKiBDb25zdHJ1Y3RvciB0aGF0IHNob3VsZCBiZSB1c2VkIGJ5IHRoZSBIeXBlcnR5IG93bmVyCiAgKiBAcGFyYW0ge0h5cGVydHlVUkx9IG93bmVyIC0gSHlwZXJ0eSBVUkwgb3duZXIuIEFuIFVSTCBhbGxvY2F0ZWQgYnkgdGhlIHJ1bnRpbWUgdGhhdCB1bmlxdWVseSBpZGVudGlmaWVzIHRoZSBIeXBlcnR5LgogICogQHBhcmFtIHtNaW5pQnVzfSBidXMgLSBBbiBpbnN0YW5jZSBvZiB0aGUgTWluaUJ1cyBwcm92aWRlZCBpbiB0aGUgc2FuZGJveC4gV2hlbiBhbiBvYmplY3QgKFJlcG9ydGVyIG9yIE9ic2VydmVkKSBpcyBjcmVhdGVkLCB0aGUgU3luY2hlck1hbmFnZXIgd2lsbCBhZGQgYSBsaXN0ZW5lciBpbiB0aGUgTWluaUJ1cyB0byByZWNlaXZlL3NlbmQgTWVzc2FnZXMgb2YgdGhhdCBvYmplY3QuCiAgKiBAcGFyYW0ge0pTT059IGNvbmZpZyAtIENvbmZpZ3VyYXRpb24gZGF0YS4gVGhlIG9ubHkgcmVxdWlyZWQgZmllbGQgZm9yIG5vdyBpcyB0aGUgcnVudGltZVVSTC4KICAqLwogIGZ1bmN0aW9uIFN5bmNoZXIob3duZXIsIGJ1cywgY29uZmlnKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBTeW5jaGVyKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX2J1cyA9IGJ1czsKCiAgICBfdGhpcy5fc3ViVVJMID0gY29uZmlnLnJ1bnRpbWVVUkwgKyAnL3NtJzsKCiAgICBfdGhpcy5fcmVwb3J0ZXJzID0ge307CiAgICBfdGhpcy5fb2JzZXJ2ZXJzID0ge307CiAgICBfdGhpcy5fcHJvdmlzaW9uYWxzID0ge307CgogICAgYnVzLmFkZExpc3RlbmVyKG93bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikgewogICAgICAgIGNvbnNvbGUuaW5mbygnW1N5bmNoZXJdIFN5bmNoZXItUkNWOiAnLCBtc2cpOwogICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgIGNhc2UgJ2ZvcndhcmQnOgogICAgICAgICAgICBfdGhpcy5fb25Gb3J3YXJkKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdjcmVhdGUnOgogICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVDcmVhdGUobXNnKTticmVhazsKICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAgIF90aGlzLl9vblJlbW90ZURlbGV0ZShtc2cpO2JyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQoKICAvKioKICAqIFRoZSBvd25lciBvZiB0aGUgU3luY2hlciBhbmQgYWxsIGNyZWF0ZWQgcmVwb3J0ZXJzLgogICogQHR5cGUge0h5cGVydHlVUkx9CiAgKi8KCgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKFN5bmNoZXIsIFt7CiAgICBrZXk6ICdjcmVhdGUnLAoKCiAgICAvKioKICAgICogUmVxdWVzdCBhIERhdGFPYmplY3RSZXBvcnRlciBjcmVhdGlvbi4gVGhlIFVSTCB3aWxsIGJlIGJlIHJlcXVlc3RlZCBieSB0aGUgYWxsb2NhdGlvbiBtZWNoYW5pc20uCiAgICAqIEBwYXJhbSAge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hCiAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIC0gTGlzdCBvZiBoeXBlcnRpZXMgdGhhdCBhcmUgcHJlLWF1dGhvcml6ZWQgZm9yIHN1YnNjcmlwdGlvbgogICAgKiBAcGFyYW0gIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICogQHBhcmFtICB7c3RyaW5nfSBvYmplY3RVUkwgLSByZXVzYWJsZSBkYXRhT2JqZWN0IFVSTAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IFJlcG9ydGVyLiBUaGUgcmVwb3J0ZXIgY2FuIGJlIGFjY2VwdGVkIG9yIHJlamVjdGVkIGJ5IHRoZSBQRVAKICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKHNjaGVtYSwgb2JzZXJ2ZXJzLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgc3RvcmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgcDJwID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiBmYWxzZTsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBjcml0ZXJpYSA9IHt9OwoKICAgICAgY3JpdGVyaWEucDJwID0gcDJwOwogICAgICBjcml0ZXJpYS5zdG9yZSA9IHN0b3JlOwogICAgICBjcml0ZXJpYS5zY2hlbWEgPSBzY2hlbWE7CiAgICAgIGNyaXRlcmlhLm9ic2VydmVycyA9IG9ic2VydmVyczsKICAgICAgY3JpdGVyaWEuaW5pdGlhbERhdGEgPSBpbml0aWFsRGF0YTsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUgUmVwb3J0ZXIgLSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogZmFsc2UgfSk7CgogICAgICByZXR1cm4gX3RoaXMuX2NyZWF0ZShjcml0ZXJpYSk7CiAgICB9CiAgfSwgewogICAga2V5OiAncmVzdW1lUmVwb3J0ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVSZXBvcnRlcnMoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBSZXBvcnRlciAtIGNyaXRlcmlhOiAnLCBjcml0ZXJpYSk7CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiB0cnVlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9jcmVhdGUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtTY2hlbWFVUkx9IHNjaGVtYSAtIEh5cGVydHkgQ2F0YWxvZ3VlIFVSTCBhZGRyZXNzIHRoYXQgY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIEpTT04tU2NoZW1hIGRlc2NyaWJpbmcgdGhlIERhdGEgT2JqZWN0IHNjaGVtYQogICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gQWRkcmVzcyBvZiB0aGUgZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIG9ic2VydmVkCiAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3N0b3JlPWZhbHNlXSAtIFNhdmUgdGhlIHN1YnNjcmlwdGlvbiBvbiB0aGUgU3luY2hlciBNYW5hZ2VyIGZvciBmdXJ0aGVyIHJlc3VtZSAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbcDJwPWZhbHNlXSAtIEluZm8gYWJvdXQgaWYgc2hvdWxkIHVzZSBwMnAgY29ubmVjdGlvbiAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbbXV0dWFsPXRydWVdIC0gSW5mbyBhYm91dCBpZiBtZXNzYWdlcyBvZiB0aGlzIG9iamVjdCBzaG91bGQgYmUgZW5jcnlwdGVkIChEZWZhdWx0IGlzIHRydWUpCiAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdE9ic2VydmVyPn0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgb2JzZXJ2ZXIuIEl0J3MgYXNzb2NpYXRlZCB3aXRoIHRoZSByZXBvcnRlci4KICAgICovCgogIH0sIHsKICAgIGtleTogJ3N1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3Vic2NyaWJlKHNjaGVtYSwgb2JqVVJMKSB7CiAgICAgIHZhciBzdG9yZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgIHZhciBwMnAgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgbXV0dWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB0cnVlOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGNyaXRlcmlhID0ge307CgogICAgICBjcml0ZXJpYS5wMnAgPSBwMnA7CiAgICAgIGNyaXRlcmlhLnN0b3JlID0gc3RvcmU7CiAgICAgIGNyaXRlcmlhLnNjaGVtYSA9IHNjaGVtYTsKICAgICAgY3JpdGVyaWEucmVzb3VyY2UgPSBvYmpVUkw7CgogICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgIGNyaXRlcmlhLm11dHVhbCA9IG11dHVhbDsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIHN1YnNjcmliZV0gLSBzdWJzY3JpYmUgY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCiAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShjcml0ZXJpYSwgeyByZXN1bWU6IGZhbHNlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9zdWJzY3JpYmUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtjcml0ZXJpYX0gY3JpdGVyaWEgLSBJbmZvcm1hdGlvbiB0byBkaXNjb3ZlcnkgdGhlIG9ic2VydmVyIG9iamVjdAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXN1bWVPYnNlcnZlcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZU9ic2VydmVycyhjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgX2NyaXRlcmlhID0gY3JpdGVyaWEgfHwge307CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoX2NyaXRlcmlhLCB7IHJlc3VtZTogdHJ1ZSB9KTsKCiAgICAgIHJldHVybiBfdGhpcy5fc3Vic2NyaWJlKF9jcml0ZXJpYSk7CiAgICB9CgogICAgLyoqCiAgICAqIFJlcXVlc3QgYSByZWFkIGFjdGlvbiBvbiB0aGUgcmVwb3J0ZXIgb2JqZWN0CiAgICAqIEBwYXJhbSB7T2JqZWN0VVJMfSBvYmpVUkwgLSBVUkwgb2YgdGhlIHJlcG9ydGVyIG9iamVjdCB0byBiZSByZWFkCiAgICAqIEByZXR1cm4ge1Byb21pc2U8T2JqZWN0Pn0gUmV0dXJuIFByb21pc2UgdG8gbGFzdCBhdmFpbGFibGUgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICovCgogIH0sIHsKICAgIGtleTogJ3JlYWQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWQob2JqVVJMKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIHJlcG9ydGVyIG9iamVjdCAobWF5YmUgdGhlcmUgaXMgbm8gbGlzdGVuZXIgYXZhaWxhYmxlLCBzbyBpdCB3aWxsIGJlIHJlc29sdmVkIHdpdGggTWVzc2FnZUJ1cyAtPiByZXNvbHZlKQogICAgICAvL3dpbGwgcmVhY2ggdGhlIHJlbW90ZSBvYmplY3QgaW4gRGF0YU9iamVjdFJlcG9ydGVyIC0+IF9vblJlYWQKICAgICAgdmFyIHJlYWRNc2cgPSB7CiAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBvYmpVUkwKICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVhZE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygncmVhZC1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIGV2ZW50cyBvZiByZW1vdmUgUmVwb3J0ZXIgb2JqZWN0cy4KICAgICogVGhpcyBpcyByZWxlYXRlZCB0byB0aGUgbWVzc2FnZW5zIHNlbnQgYnkgY3JlYXRlIHRvIHRoZSBvYnNlcnZlcnMgSHlwZXJ0eSBhcnJheS4KICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgKi8KCiAgfSwgewogICAga2V5OiAnb25Ob3RpZmljYXRpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uTm90aWZpY2F0aW9uKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ19jcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciByZXN1bWUgPSBjcml0ZXJpYS5yZXN1bWU7CiAgICAgICAgdmFyIGluaXRpYWxEYXRhID0gY3JpdGVyaWEuaW5pdGlhbERhdGEgfHwge307CiAgICAgICAgdmFyIHNjaGVtYSA9IHZvaWQgMDsKCiAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKICAgICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keTogeyByZXN1bWU6IHJlc3VtZSB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXTogJywgY3JpdGVyaWEsIHJlcXVlc3RNc2cpOwoKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUgPSBpbml0aWFsRGF0YTsKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUucmVwb3J0ZXIgPSBfdGhpcy5fb3duZXI7CgogICAgICAgIGlmIChjcml0ZXJpYS5zY2hlbWEpIHsKICAgICAgICAgIHNjaGVtYSA9IGNyaXRlcmlhLnNjaGVtYTsKICAgICAgICAgIHJlcXVlc3RNc2cuYm9keS5zY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CiAgICAgICAgfQoKICAgICAgICBpZiAoY3JpdGVyaWEucDJwKSByZXF1ZXN0TXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgIGlmIChjcml0ZXJpYS5zdG9yZSkgcmVxdWVzdE1zZy5ib2R5LnN0b3JlID0gY3JpdGVyaWEuc3RvcmU7CiAgICAgICAgaWYgKGNyaXRlcmlhLm9ic2VydmVycykgcmVxdWVzdE1zZy5ib2R5LmF1dGhvcmlzZSA9IGNyaXRlcmlhLm9ic2VydmVyczsKCiAgICAgICAgaWYgKHJlc3VtZSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9CgogICAgICAgIC8vcmVxdWVzdCBjcmVhdGUgdG8gdGhlIGFsbG9jYXRpb24gc3lzdGVtLiBDYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIFBvbGljeUVuZ2luZS4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gYWNjZXB0ZWQKICAgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgICBpZiAocmVzdW1lKSB7CiAgICAgICAgICAgICAgc2NoZW1hID0gcmVwbHkuYm9keS5zY2hlbWE7CiAgICAgICAgICAgICAgaW5pdGlhbERhdGEgPSByZXBseS5ib2R5LnZhbHVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgc2NoZW1hLCAnb24nLCBpbml0aWFsRGF0YSwgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CiAgICAgICAgICAgIF90aGlzLl9yZXBvcnRlcnNbb2JqVVJMXSA9IG5ld09iajsKCiAgICAgICAgICAgIHJlc29sdmUobmV3T2JqKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gcmVqZWN0ZWQKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zdWJzY3JpYmUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsU3Vic2NyaWJlCiAgICAgICAgdmFyIHN1YnNjcmliZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keToge30KICAgICAgICB9OwoKICAgICAgICAvLyBIeXBlcnR5IHJlcXVlc3QgdG8gYmUgYW4gT2JzZXJ2ZXIKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNoeXBlcnR5LXJlcXVlc3QtdG8tYmUtYW4tb2JzZXJ2ZXIKCiAgICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIHRoZSBzYW1lIEh5cGVydHkgVVJMCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLXRoZS1zYW1lLWh5cGVydHktdXJsCgogICAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciBhIGNlcnRhaW4gdXNlciBhbmQgZGF0YSBzY2hlbWEgaW5kZXBlbmRlbnRseSBvZiB0aGUgSHlwZXJ0eSBVUkwuCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLWEtY2VydGFpbi11c2VyLWFuZC1kYXRhLXNjaGVtYS1pbmRlcGVuZGVudGx5LW9mLXRoZS1oeXBlcnR5LXVybAogICAgICAgIGlmIChjcml0ZXJpYSkgewogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdwMnAnKSkgc3Vic2NyaWJlTXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzdG9yZScpKSBzdWJzY3JpYmVNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzY2hlbWEnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdpZGVudGl0eScpKSBzdWJzY3JpYmVNc2cuYm9keS5pZGVudGl0eSA9IGNyaXRlcmlhLmlkZW50aXR5OwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZScpKSBzdWJzY3JpYmVNc2cuYm9keS5yZXNvdXJjZSA9IGNyaXRlcmlhLnJlc291cmNlOwogICAgICAgIH0KCiAgICAgICAgc3Vic2NyaWJlTXNnLmJvZHkucmVzdW1lID0gY3JpdGVyaWEucmVzdW1lOwoKICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgdmFyIG11dHVhbEF1dGhlbnRpY2F0aW9uID0gY3JpdGVyaWEubXV0dWFsOwogICAgICAgIGlmICghbXV0dWFsQXV0aGVudGljYXRpb24pIHN1YnNjcmliZU1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUgbWVzc2FnZTogJywgY3JpdGVyaWEsIHN1YnNjcmliZU1zZyk7CgogICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KICAgICAgICAvL1Byb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICAgICAgICAvL2ZvciBtb3JlIGluZm8gc2VlIHRoZSBEYXRhUHJvdmlzaW9uYWwgY2xhc3MgZG9jdW1lbnRhdGlvbi4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gc3Vic2NyaWJlLXJlc3BvbnNlOiAnLCByZXBseSk7CgogICAgICAgICAgdmFyIHNjaGVtYSA9IHJlcGx5LmJvZHkuc2NoZW1hOwogICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgdmFyIG5ld1Byb3Zpc2lvbmFsID0gX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKICAgICAgICAgIGlmIChuZXdQcm92aXNpb25hbCkgbmV3UHJvdmlzaW9uYWwuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlIDwgMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YVByb3Zpc2lvbmFsOiAnLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzLCBvYmpVUkwpOwogICAgICAgICAgICBuZXdQcm92aXNpb25hbCA9IG5ldyBfRGF0YVByb3Zpc2lvbmFsMi5kZWZhdWx0KF90aGlzLl9vd25lciwgb2JqVVJMLCBfdGhpcy5fYnVzLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKICAgICAgICAgICAgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdID0gbmV3UHJvdmlzaW9uYWw7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YSBPYmplY3QgT2JzZXJ2ZXI6ICcsIHJlcGx5LCBfdGhpcy5fcHJvdmlzaW9uYWxzKTsKCiAgICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgICAgdmFyIG5ld09iaiA9IG5ldyBfRGF0YU9iamVjdE9ic2VydmVyMi5kZWZhdWx0KF90aGlzLCBvYmpVUkwsIHNjaGVtYSwgJ29uJywgcmVwbHkuYm9keS52YWx1ZSwgbmV3UHJvdmlzaW9uYWwuY2hpbGRyZW4sIHJlcGx5LmJvZHkudmVyc2lvbiwgbXV0dWFsQXV0aGVudGljYXRpb24pOwogICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF0gPSBuZXdPYmo7CgogICAgICAgICAgICByZXNvbHZlKG5ld09iaik7CiAgICAgICAgICAgIG5ld1Byb3Zpc2lvbmFsLmFwcGx5KG5ld09iaik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSBsb2NhbCBydW50aW1lIFJlcG9ydGVyT2JqZWN0IC0+IF9vblJlbW90ZVN1YnNjcmliZQoKICB9LCB7CiAgICBrZXk6ICdfb25Gb3J3YXJkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Gb3J3YXJkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHJlcG9ydGVyID0gX3RoaXMuX3JlcG9ydGVyc1ttc2cuYm9keS50b107CiAgICAgIHJlcG9ydGVyLl9vbkZvcndhcmQobXNnKTsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBTeW5jaGVyIC0+IGNyZWF0ZSAodGhpcyBpcyBhY3R1YWxseSBhbiBpbnZpdGF0aW9uIHRvIHN1YnNjcmliZSkKCiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVDcmVhdGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5mcm9tLnNsaWNlKDAsIC0xMyk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmJvZHkuc291cmNlLAogICAgICAgIHVybDogcmVzb3VyY2UsCiAgICAgICAgc2NoZW1hOiBtc2cuYm9keS5zY2hlbWEsCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgYWNrOiBmdW5jdGlvbiBhY2sodHlwZSkgewogICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgbFR5cGUgPSB0eXBlOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbU3luY2hlcl0gTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gZGVsZXRlCgogIH0sIHsKICAgIGtleTogJ19vblJlbW90ZURlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVtb3RlRGVsZXRlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9yZW1vdmUgIi9zdWJzY3JpcHRpb24iIGZyb20gdGhlIFVSTAogICAgICB2YXIgcmVzb3VyY2UgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIHZhciBvYmplY3QgPSBfdGhpcy5fb2JzZXJ2ZXJzW3Jlc291cmNlXTsKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIHZhciBldmVudCA9IHsKICAgICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgICAgdXJsOiByZXNvdXJjZSwKICAgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgICBhY2s6IGZ1bmN0aW9uIGFjayh0eXBlKSB7CiAgICAgICAgICAgIHZhciBsVHlwZSA9IDIwMDsKICAgICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgICBsVHlwZSA9IHR5cGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vVE9ETzogYW55IG90aGVyIGRpZmZlcmVudCBvcHRpb25zIGZvciB0aGUgcmVsZWFzZSBwcm9jZXNzLCBsaWtlIGFjY2VwdCBidXQgbm9yIHJlbGVhc2UgbG9jYWw/CiAgICAgICAgICAgIGlmIChsVHlwZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgb2JqZWN0LmRlbGV0ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL3NlbmQgYWNrIHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgICAgYm9keTogeyBjb2RlOiBsVHlwZSwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBpZiAoX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcikgewogICAgICAgICAgY29uc29sZS5sb2coJ05PVElGSUNBVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwNCwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnb3duZXInLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9vd25lcjsKICAgIH0KCiAgICAvKioKICAgICogQWxsIG93bmVkIHJlcG9ydGVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBjcmVhdGUKICAgICogQHR5cGUge09iamVjdDxVUkwsIERhdGFPYmplY3RSZXBvcnRlcj59CiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnRlcnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9yZXBvcnRlcnM7CiAgICB9CgogICAgLyoqCiAgICAqIEFsbCBvd25lZCBvYnNlcnZlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgbG9jYWwgc3Vic2NyaXB0aW9uCiAgICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0T2JzZXJ2ZXI+fQogICAgKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZXJzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fb2JzZXJ2ZXJzOwogICAgfQogIH1dKTsKICByZXR1cm4gU3luY2hlcjsKfSgpOyAvKioKICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICoKICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgKgogICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAqCiAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IFN5bmNoZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEzMSAqLywKLyogMTMyICovLAovKiAxMzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovKioKICogQGFjY2VzcyBwcml2YXRlCiAqIFRoaXMgY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIGNvbGxlY3RpbmcgZGVsdGEgY2hhbmdlcyBpbiByZW1vdGUgb2JqZWN0cywgYmVmb3JlIHRoZSByZXNwb25zZSBvZiBzdWJzY3JpcHRpb24gcmVhY2ggdGhlIG9ic2VydmVyLgogKiBJdCdzIHVzZWQgaW4gU3luY2hlciAtPiBzdWJzY3JpYmUuIFRoZSBmbG93IGlzIGRlZmluZWQgYXM6CiAqIDEuIChvYnNlcnZlcikgLS1zdWJzY3JpYmUtLT4gKHJlcG9ydGVyKQogKiAyLiAob2JzZXJ2ZXIpIDwtLWRlbHRhIHVwZGF0ZXMtLSAocmVwb3J0ZXIpCiAqIDMuIChvYnNlcnZlcikgPC0tc3Vic2NyaWJlIHJlc3BvbnNlLS0gKHJlcG9ydGVyKQogKiBUaGlzIG1lYW5zIHRoYXQgdGhlcmUgY291bGQgYmUgZGVsdGEgdXBkYXRlcyB0cmFuc2ZlcnJlZCBiZWZvcmUgdGhlIHN1YnNjcmlwdGlvbiBjb25maXJtYXRpb24uCiAqIFNpbmNlIHRoZXJlIGlzIG5vIERhdGFPYmplY3RPYnNlcnZlciBiZWZvcmUgdGhlIHVic2NyaXB0aW9uIGNvbmZpcm1hdGlvbiwgdGhlcmUgc2hvdWxkIGJlIHNvbWUgb3RoZXIgb2JqZWN0IGNvbGxlY3RpbmcgdGhlIHVwZGF0ZXMuCiAqIFByb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICovCnZhciBEYXRhUHJvdmlzaW9uYWwgPSBmdW5jdGlvbiAoKSB7CiAgLyogcHJpdmF0ZQogIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXQogIF9saXN0ZW5lcjogTXNnTGlzdGVuZXIKICAgX2NoYW5nZXM6IFtdCiAgKi8KCiAgZnVuY3Rpb24gRGF0YVByb3Zpc2lvbmFsKG93bmVyLCB1cmwsIGJ1cywgY2hpbGRyZW4pIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFQcm92aXNpb25hbCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl91cmwgPSB1cmw7CiAgICBfdGhpcy5fYnVzID0gYnVzOwogICAgX3RoaXMuX2NoaWxkcmVuID0gY2hpbGRyZW47CgogICAgX3RoaXMuX2NoYW5nZXMgPSBbXTsKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YVByb3Zpc2lvbmFsLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YVByb3Zpc2lvbmFsLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgX3RoaXMuX2NoYW5nZXMucHVzaChtc2cpOwogICAgICB9KTsKCiAgICAgIC8qCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwogICAgICBpZiAoX3RoaXMuX2NoaWxkcmVuKSB7CiAgICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IHVybCArICcvY2hpbGRyZW4vJzsKICAgICAgICBfdGhpcy5fY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHsKICAgICAgICAgIGxldCBjaGlsZFVSTCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOwogICAgICAgICAgbGV0IGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgKG1zZykgPT4gewogICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCiAgICAgICAgICAgIGlmIChtc2cuZnJvbSAhPT0gb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0qLwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKCiAgICAgIC8qX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7CiAgICAgICAgbGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgIH0pOyovCiAgICB9CiAgfSwgewogICAga2V5OiAnYXBwbHknLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5KG9ic2VydmVyKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIF90aGlzLl9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZSkgewogICAgICAgIG9ic2VydmVyLl9jaGFuZ2VPYmplY3Qob2JzZXJ2ZXIuX3N5bmNPYmosIGNoYW5nZSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ2NoaWxkcmVuJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW47CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhUHJvdmlzaW9uYWw7Cn0oKTsKCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFQcm92aXNpb25hbDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTM0ICovLAovKiAxMzUgKi8sCi8qIDEzNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzcgKi8sCi8qIDEzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0NSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzkgKi8sCi8qIDE0MCAqLywKLyogMTQxICovLAovKiAxNDIgKi8sCi8qIDE0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDE0OSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3QuYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NCAqLywKLyogMTQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTUxKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7CiAgcmV0dXJuICRPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpOwp9OwoKLyoqKi8gfSksCi8qIDE0NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyAxOS4xLjIuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlLCAuLi4pCnZhciBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpCiAgLCBnT1BTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCiAgLCB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJT2JqZWN0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpCiAgLCAkYXNzaWduICA9IE9iamVjdC5hc3NpZ247CgovLyBzaG91bGQgd29yayB3aXRoIHN5bWJvbHMgYW5kIHNob3VsZCBoYXZlIGRldGVybWluaXN0aWMgcHJvcGVydHkgb3JkZXIgKFY4IGJ1ZykKbW9kdWxlLmV4cG9ydHMgPSAhJGFzc2lnbiB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHZhciBBID0ge30KICAgICwgQiA9IHt9CiAgICAsIFMgPSBTeW1ib2woKQogICAgLCBLID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0JzsKICBBW1NdID0gNzsKICBLLnNwbGl0KCcnKS5mb3JFYWNoKGZ1bmN0aW9uKGspeyBCW2tdID0gazsgfSk7CiAgcmV0dXJuICRhc3NpZ24oe30sIEEpW1NdICE9IDcgfHwgT2JqZWN0LmtleXMoJGFzc2lnbih7fSwgQikpLmpvaW4oJycpICE9IEs7Cn0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycwogIHZhciBUICAgICA9IHRvT2JqZWN0KHRhcmdldCkKICAgICwgYUxlbiAgPSBhcmd1bWVudHMubGVuZ3RoCiAgICAsIGluZGV4ID0gMQogICAgLCBnZXRTeW1ib2xzID0gZ09QUy5mCiAgICAsIGlzRW51bSAgICAgPSBwSUUuZjsKICB3aGlsZShhTGVuID4gaW5kZXgpewogICAgdmFyIFMgICAgICA9IElPYmplY3QoYXJndW1lbnRzW2luZGV4KytdKQogICAgICAsIGtleXMgICA9IGdldFN5bWJvbHMgPyBnZXRLZXlzKFMpLmNvbmNhdChnZXRTeW1ib2xzKFMpKSA6IGdldEtleXMoUykKICAgICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAogICAgICAsIGogICAgICA9IDAKICAgICAgLCBrZXk7CiAgICB3aGlsZShsZW5ndGggPiBqKWlmKGlzRW51bS5jYWxsKFMsIGtleSA9IGtleXNbaisrXSkpVFtrZXldID0gU1trZXldOwogIH0gcmV0dXJuIFQ7Cn0gOiAkYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NyAqLywKLyogMTQ4ICovLAovKiAxNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSkKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYsICdPYmplY3QnLCB7YXNzaWduOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Nil9KTsKCi8qKiovIH0pLAovKiAxNTAgKi8sCi8qIDE1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApCnZhciB0b0lPYmplY3QgICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KS5mOwoKX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2dldE93blByb3BlcnR5RGVzY3JpcHRvcicsIGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICAgIHJldHVybiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRvSU9iamVjdChpdCksIGtleSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTUyICovLAovKiAxNTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gICAgIHByb3h5LW9ic2VydmUgdjAuMC4xOAovLyAgICAgQ29weXJpZ2h0IChjKSAyMDE1LCAyMDE2IFNpbW9uIFkuIEJsYWNrd2VsbCwgQW55V2hpY2hXYXkKLy8gICAgIE1JVCBMaWNlbnNlIC0gaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocAooZnVuY3Rpb24oKSB7CgkidXNlIHN0cmljdCI7CgkvLyBDcmVhdGVzIGFuZCByZXR1cm5zIGEgUHJveHkgd3JhcHBpbmcgYSB0YXJnZXQgc28gdGhhdCBhbGwgY2hhbmdlcyBjYW4gYmUgdHJhcHBlZCBhbmQgZm9yd2FyZGVkIHRvCgkvLyBhIGNhbGxiYWNrLiBUaGUgY2FsbGJhY2sgdGFrZXMgYW4gYXJyYXkgb2YgY2hhbmdlcyBqdXN0IGxpa2UgdGhlIHRyYWRpdGlvbmFsIG9yaWdpbmFsIENocm9tZSBPYmplY3Qub2JzZXJ2ZQoJLy8ge29iamVjdDo8b2JqZWN0IGNoYW5nZWQ+LG5hbWU6PGZpZWxkIGNoYW5nZWQ+LHR5cGU6YWRkfHVwZGF0ZXxkZWxldGV8cmVjb25maWd1cmV8cHJldmVudEV4dGVuc2lvbnN8c2V0UHJvdG90eXBlLG9sZFZhbHVlOjxvbGQgdmFsdWUgaWYgdXBkYXRlIHwgZGVsZXRlPn0KCS8vIFRoZSBhY2NlcHRsaXN0IGNhbiBiZSBhZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUuCgkvLyB2IDAuMC4xMCB0byBzdXBwb3J0IHBhdXNpbmcgYW5kIHJlc3RhcnRpbmcgb2JzZXJ2YXRpb24gdHdvIGFkZGl0aW9uYWwgY29uc3RydWN0b3IgYXJndW1lbnRzIGFyZSBhdmFpbGFibGUgdG8gT2JqZWN0Lm9ic2VydmU6CgkvLyBwYXVzYWJsZSAtIGNyZWF0ZSB0aGUgT2JzZXJ2ZXIgc28gaXQgY2FuIGJlIHBhdXNlZAoJLy8gcGF1c2UgLSBjcmVhdGUgb2JzZXJ2ZXIgaW4gcGF1c2VkIHN0YXRlCgkvLyBpZiBwYXVzYWJsZSBpcyB0cnVlIHRoZW4gYW4gYWRkaXRpb25hbCBtZXRob2QgZGVsaXZlcihpZ25vcmVQcmV2aW91cykgaXMgYXZhaWxhYmxlIHRvIHN0YXJ0IGRlbGl2ZXJ5CgkvLyB0byBwYXVzZSBkZWxpdmVyeSBzZXQgYSBwcm9wZXJ0eSBjYWxsZWQgcGF1c2Ugb24gdGhlIGZ1bmN0aW9uIGRlbGl2ZXIgdG8gdHJ1ZQoJLy8gcGF1c2FibGUgaXMgb3B0aW9uYWwgdG8gcmVkdWNlIHRoZSBjaGFuY2Ugb2Ygc2hhZG93aW5nIGEgcHJvcGVydHkgb3IgbWV0aG9kIG9uIGFueSBleGlzdGluZyBjb2RlIGNhbGxlZCBkZWxpdmVyCglpZighT2JqZWN0Lm9ic2VydmUgJiYgdHlwZW9mKFByb3h5KT09PSJmdW5jdGlvbiIpIHsKCQlmdW5jdGlvbiBPYnNlcnZlcih0YXJnZXQsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgewoJICAgIAl2YXIgbWUgPSB0aGlzLCBwcm94eTsKCSAgICAJZnVuY3Rpb24gZGVsaXZlcihpZ25vcmVQcmV2aW91cyxkZWxheSkgewoJICAgIAkJZGVsaXZlci5kZWxheSA9IGRlbGF5OwoJICAgIAkJaWYoIWRlbGl2ZXIucGF1c2UpIHsKCSAgICAgICAgCQlpZihtZS5jaGFuZ2VzZXQubGVuZ3RoPjApIHsKCSAgICAgICAgCQkJaWYoIWlnbm9yZVByZXZpb3VzKSB7CgkJICAgIAkgICAgCQl2YXIgY2hhbmdlcyA9IG1lLmNoYW5nZXNldC5maWx0ZXIoZnVuY3Rpb24oY2hhbmdlKSB7IHJldHVybiAhYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wOyB9KTsKCQkgICAgICAgIAkJCWlmKGNoYW5nZXMubGVuZ3RoPjApIHsKCQkgICAgICAgIAkJCQljYWxsYmFjayhjaGFuZ2VzKTsKCQkgICAgICAgIAkJCX0KCSAgICAgICAgCQkJfQoJICAgICAgICAJCQltZS5jaGFuZ2VzZXQgPSBbXTsKCSAgICAgICAgCQl9CgkgICAgCQl9CgkgICAgCX0KCSAgICAJZGVsaXZlci5wYXVzZSA9IHBhdXNlOwoJICAgIAlkZWxpdmVyLmRlbGF5ID0gZGVsYXk7CgkJICAgIG1lLmdldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCQkgICAgCWlmKHByb3BlcnR5PT09Il9fb2JzZXJ2ZXJfXyIpIHsKCQkgICAgCQlyZXR1cm4gbWU7CgkJICAgIAl9CgkJICAgIAlpZihwcm9wZXJ0eT09PSJ1bm9ic2VydmUiKSB7CgkJICAgIAkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCSAgICAJCQlPYmplY3QudW5vYnNlcnZlKHRhcmdldCk7CgkJICAgIAkJCXJldHVybiB0YXJnZXQ7CgkJICAgIAkJfTsKCQkgICAgCX0KCQkgICAgCWlmKHByb3BlcnR5PT09ImRlbGl2ZXIiKSB7CgkJICAgIAkJcmV0dXJuIGRlbGl2ZXI7CgkJICAgIAl9CgkJICAgIAlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCQkgICAgfQoJICAgIAltZS50YXJnZXQgPSB0YXJnZXQ7CgkgICAgCW1lLmNoYW5nZXNldCA9IFtdOwoJICAgIAlpZighbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXykgewoJICAgIAkJLy8gX19vYnNlcnZlckNhbGxiYWNrc19fIGlzIHVzZWQgYXMgYW4gaW5kZXggdG8gZ2V0IGF0IHRoZSBwcm94eSB3aGljaCBpcyB0aGUgb2JzZXJ2ZXIsIHNvIHdlIGNhbiB1bm9ic2VydmUKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJDYWxsYmFja3NfXyIse2VudW1lcmFibGU6ZmFsc2UsY29uZmlndXJhYmxlOnRydWUsd3JpdGFibGU6ZmFsc2UsdmFsdWU6W119KTsKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJzX18iLHtlbnVtZXJhYmxlOmZhbHNlLGNvbmZpZ3VyYWJsZTp0cnVlLHdyaXRhYmxlOmZhbHNlLHZhbHVlOltdfSk7CgkgICAgCX0KCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5wdXNoKGNhbGxiYWNrKTsKCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJzX18ucHVzaCh0aGlzKTsKCSAgICAJcHJveHkgPSBuZXcgUHJveHkodGFyZ2V0LG1lKTsKCSAgICAJZGVsaXZlcihmYWxzZSxkZWxheSk7CgkgICAgCXJldHVybiBwcm94eTsKCSAgICB9CgkJT2JzZXJ2ZXIucHJvdG90eXBlLmRlbGl2ZXIgPSBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMuZ2V0KG51bGwsImRlbGl2ZXIiKTsKCQl9CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIHZhbHVlKSB7IC8vICwgcmVjZWl2ZXIKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJdmFyIHR5cGUgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKTsKCSAgICAJdGFyZ2V0W3Byb3BlcnR5XSA9IHZhbHVlOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICghdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKHR5cGUpPj0wKSkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZTp0eXBlfSwKCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAgICAgCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAlpZih0eXBlPT09InVwZGF0ZSIpIHsKCSAgICAgICAgCQljaGFuZ2Uub2xkVmFsdWUgPSBvbGR2YWx1ZTsKCSAgICAgICAgCX0KCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWxldGVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJLy9pZih0eXBlb2Yob2xkdmFsdWUpIT09InVuZGVmaW5lZCIpIHsKCQkgICAgCWRlbGV0ZSB0YXJnZXRbcHJvcGVydHldOwoJCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJkZWxldGUiKT49MCkgewoJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6ImRlbGV0ZSIsb2xkVmFsdWU6b2xkdmFsdWV9LAoJCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCQkgICAgICAgIAkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCQkgICAgICAgIAlpZihzdGFydCkgewoJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJCSAgICAgICAgCX0KCQkgICAgCX0KCSAgICAJLy99CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcikgewoJICAgIAlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcik7CgkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigicmVjb25maWd1cmUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZToicmVjb25maWd1cmUifSwKICAgICAgICAJCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKICAgICAgICAJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7CgkgICAgICAgIAlpZihzdGFydCkgewoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7CgkgICAgICAgIAl9CgkgICAgCX0KCSAgICAJcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBPYnNlcnZlci5wcm90b3R5cGUuc2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbih0YXJnZXQsIHByb3RvdHlwZSkgewoJICAgIAl2YXIgb2xkdmFsdWUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KTsKCSAgICAJT2JqZWN0LnNldFByb3RvdHlwZU9mKHRhcmdldCwgcHJvdG90eXBlKTsKCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJzZXRQcm90b3R5cGUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6Il9fcHJvdG9fXyIsdHlwZToic2V0UHJvdG90eXBlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sCiAgICAJCQkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsCiAgICAJCQkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgICAgICAJaWYoc3RhcnQpIHsKCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgICAgICAJfQoJICAgIAl9CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnByZXZlbnRFeHRlbnNpb25zID0gZnVuY3Rpb24odGFyZ2V0KSB7CgkgICAgICAgIE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh0YXJnZXQpOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInByZXZlbnRFeHRlbnNpb25zIik+PTApIHsKCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCx0eXBlOiJwcmV2ZW50RXh0ZW5zaW9ucyJ9LAoJCQkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLAoJCQkJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsKCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9iamVjdC5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJcmV0dXJuIG5ldyBPYnNlcnZlcihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSk7CgkgICAgfTsKCSAgICBPYmplY3QudW5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrKSB7CgkgICAgCWlmKG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsKCSAgICAJCWlmKCFjYWxsYmFjaykgewoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uc3BsaWNlKDAsb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5sZW5ndGgpOwoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZSgwLG9iamVjdC5fX29ic2VydmVyc19fLmxlbmd0aCk7CgkgICAgCQkJcmV0dXJuOwoJICAgIAkJfQoJICAgIAkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5mb3JFYWNoKGZ1bmN0aW9uKG9ic2VydmVyY2FsbGJhY2ssaSkgewoJICAgIAkJCWlmKGNhbGxiYWNrPT09b2JzZXJ2ZXJjYWxsYmFjaykgewoJICAgIAkJCQlvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLnNwbGljZShpLDEpOwoJICAgIAkJCQlkZWxldGUgb2JqZWN0Ll9fb2JzZXJ2ZXJzX19baV0uY2FsbGJhY2s7CgkgICAgCQkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZShpLDEpOwoJICAgIAkJCX0KCSAgICAJCX0pOwoJICAgIAl9CgkgICAgfTsKCSAgICBBcnJheS5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJaWYoIShvYmplY3QgaW5zdGFuY2VvZiBBcnJheSkgJiYgIUFycmF5LmlzQXJyYXkob2JqZWN0KSkgewoJICAgIAkJdGhyb3cgbmV3IFR5cGVFcnJvcigiRmlyc3QgYXJndW1lbnQgdG8gQXJyYXkub2JzZXJ2ZXIgaXMgbm90IGFuIEFycmF5Iik7CgkgICAgCX0KICAgICAgICAgICAgCWFjY2VwdGxpc3QgPSBhY2NlcHRsaXN0IHx8IFsiYWRkIiwgInVwZGF0ZSIsICJkZWxldGUiLCAic3BsaWNlIl07CgkgICAgCXZhciBhcnJheXByb3h5ID0gbmV3IFByb3h5KG9iamVjdCx7Z2V0OiBmdW5jdGlvbih0YXJnZXQscHJvcGVydHkpIHsKCSAgICAJCWlmKHByb3BlcnR5PT09InVub2JzZXJ2ZSIpIHsKCQkgICAgCQlyZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2spIHsKCQkgICAgCQkJaWYoY2FsbGJhY2spIHsKCQkgICAgCQkJCXJldHVybiBPYmplY3QudW5vYnNlcnZlKHRhcmdldCxjYWxsYmFjayk7CgkJICAgIAkJCX0KCQkgICAgCQkJcmV0dXJuIHRhcmdldC51bm9ic2VydmUoKTsKCQkgICAgCQl9OwoJCSAgICAJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic3BsaWNlIikgewoJICAgIAkJCXJldHVybiBmdW5jdGlvbihzdGFydCxlbmQpIHsKCSAgICAJCQkJaWYodHlwZW9mKHN0YXJ0KSE9PSJudW1iZXIiIHx8IHR5cGVvZihlbmQpIT09Im51bWJlciIpIHsKCSAgICAJCQkJCXRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IHR3byBhcmd1bWVudHMgdG8gQXJyYXkgc3BsaWNlIGFyZSBub3QgbnVtYmVyLCBudW1iZXIiKTsKCSAgICAJCQkJfQoJICAgIAkgICAgCQl2YXIgcmVtb3ZlZCA9IHRoaXMuc2xpY2Uoc3RhcnQsc3RhcnQrZW5kKSwKCSAgICAJICAgIAkJCWFkZGVkQ291bnQgPSAoYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHMubGVuZ3RoLTIgOiAwKSwKCSAgICAJICAgIAkJCWNoYW5nZSA9ICB7b2JqZWN0Om9iamVjdCx0eXBlOiJzcGxpY2UiLGluZGV4OnN0YXJ0LHJlbW92ZWQ6cmVtb3ZlZCxhZGRlZENvdW50OmFkZGVkQ291bnR9OwoJICAgIAkgICAgCQl0YXJnZXQuc3BsaWNlLmFwcGx5KHRhcmdldCxhcmd1bWVudHMpOwoJICAgIAkgICAgCQlpZihhY2NlcHRsaXN0LmluZGV4T2YoInNwbGljZSIpPj0wKSB7CgkgICAgCSAgICAJCQl2YXIgc3RhcnQgPSBwcm94eS5fX29ic2VydmVyX18uY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAJICAgICAgICAJCQlkZWxpdmVyID0gcHJveHkuX19vYnNlcnZlcl9fLmRlbGl2ZXIoKTsKCSAgICAJICAgIAkJCXByb3h5Ll9fb2JzZXJ2ZXJfXy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgIAkgICAgCQkJaWYoc3RhcnQpIHsKCSAgICAJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgIAkJICAgICAgICAJfQoJICAgIAkgICAgCQl9CgkgICAgCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icHVzaCIpIHsKCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHsKCSAgICAJCSAgICAJcmV0dXJuIHRoaXMuc3BsaWNlKHRoaXMubGVuZ3RoLDAsaXRlbSk7CgkgICAgCQkgICAgfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icG9wIikgewoJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oKSB7CgkgICAgCQkgICAgCXJldHVybiB0aGlzLnNwbGljZSh0aGlzLmxlbmd0aC0xLDEpOwoJICAgIAkJICAgIH0KCSAgICAJCX0KCSAgICAJCWlmKHByb3BlcnR5PT09InVuc2hpZnQiKSB7CgkgICAgCQkJIHJldHVybiBmdW5jdGlvbihpdGVtKSB7CiAgICAJCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDAsaXRlbSk7CiAgICAJCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic2hpZnQiKSB7CgkgICAgCQkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJICAgIAkgICAgCQlyZXR1cm4gdGhpcy5zcGxpY2UoMCwxKTsKCSAgICAJICAgIAl9CgkgICAgCQl9CgkgICAgCQlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJfX0pOwoJICAgIAl2YXIgcHJveHkgPSBPYmplY3Qub2JzZXJ2ZShhcnJheXByb3h5LGZ1bmN0aW9uKGNoYW5nZXNldCkgeyAKCSAgICAJCXZhciBjaGFuZ2VzID0gY2hhbmdlc2V0LmZpbHRlcihmdW5jdGlvbihjaGFuZ2UpIHsgcmV0dXJuIGNoYW5nZS5uYW1lIT09Imxlbmd0aCIgJiYgY2hhbmdlLm5hbWUhPT0iYWRkIiAmJiAoIWFjY2VwdGxpc3QgfHwgYWNjZXB0bGlzdC5pbmRleE9mKGNoYW5nZS50eXBlKT49MCk7IH0pOwoJICAgIAkJaWYoY2hhbmdlcy5sZW5ndGg+MCkgewoJICAgIAkJCWNhbGxiYWNrKGNoYW5nZXMpOwoJICAgIAkJfQoJICAgIAl9LGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpOwoJICAgIAlyZXR1cm4gcHJveHk7CgkgICAgfTsKCSAgICBBcnJheS51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsKCQkgIHJldHVybiBvYmplY3QudW5vYnNlcnZlKGNhbGxiYWNrKTsKCSAgICB9Cgl9CglPYmplY3QuZGVlcE9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2sscGFydHMpIHsKCgkJcGFydHMgPSAocGFydHMgPyBwYXJ0cyA6IFtdKTsKCgkJdmFyIHRvVHlwZU5hbWUgPSBmdW5jdGlvbihvYmopIHsKCQkJcmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvYmopLm1hdGNoKC9ccyhbYS16QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKQoJCX0KCgkJZnVuY3Rpb24gcmVvYnNlcnZlKHZhbHVlLCBwYXJ0cykgewoJCQl2YXIga2V5cyA9IE9iamVjdC5rZXlzKHZhbHVlKTsKCQkJa2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJaWYoKHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdvYmplY3QnIHx8IHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdhcnJheScpICYmICF2YWx1ZVtrZXldLmhhc093blByb3BlcnR5KCdfX29ic2VydmVyc19fJykpIHsKCQkJCQl2YXIgbmV3cGFydHMgPSBwYXJ0cy5zbGljZSgwKTsKCQkJCQluZXdwYXJ0cy5wdXNoKGtleSk7CgkJCQkJdmFsdWVba2V5XSA9IE9iamVjdC5kZWVwT2JzZXJ2ZSh2YWx1ZVtrZXldLGNhbGxiYWNrLG5ld3BhcnRzKTsKCQkJCX0KCQkJfSk7CgkJfQoKCQlyZW9ic2VydmUob2JqZWN0LCBwYXJ0cyk7CgoJCXZhciBvYnNlcnZlZCA9IE9iamVjdC5vYnNlcnZlKG9iamVjdCxmdW5jdGlvbihjaGFuZ2VzZXQpIHsKCQkJdmFyIGNoYW5nZXMgPSBbXTsKCQkJZnVuY3Rpb24gcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0LG5ld09iamVjdCxwYXRoKSB7CgkJCQlpZihuZXdPYmplY3QgaW5zdGFuY2VvZiBPYmplY3QpIHsKCQkJCQl2YXIgbmV3a2V5cyA9IE9iamVjdC5rZXlzKG5ld09iamVjdCk7CgkJCQkJbmV3a2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJCQlpZighb2xkT2JqZWN0IHx8IChvbGRPYmplY3Rba2V5XSE9PW5ld09iamVjdFtrZXldKSkgewoJCQkJCQkJdmFyIG9sZHZhbHVlID0gKG9sZE9iamVjdCAmJiBvbGRPYmplY3Rba2V5XSE9PXVuZGVmaW5lZCA/IG9sZE9iamVjdFtrZXldIDogdW5kZWZpbmVkKSwKCQkJCQkJCQljaGFuZ2UgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKSwKCQkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCgkJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGR2YWx1ZSxuZXdWYWx1ZTpuZXdPYmplY3Rba2V5XSxrZXlwYXRoOmtleXBhdGh9KTsKCQkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZHZhbHVlLG5ld09iamVjdFtrZXldLGtleXBhdGgpOwoJCQkJCQl9CgkJCQkJfSk7CgkJCQl9IGVsc2UgaWYob2xkT2JqZWN0IGluc3RhbmNlb2YgT2JqZWN0KSB7CgkJCQkJdmFyIG9sZGtleXMgPSBPYmplY3Qua2V5cyhvbGRPYmplY3QpOwoJCQkJCW9sZGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsKCQkJCQkJdmFyIGNoYW5nZSA9IChuZXdPYmplY3Q9PT1udWxsID8gInVwZGF0ZSIgOiAiZGVsZXRlIiksCgkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCQkJCQkJCQoJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGRPYmplY3Rba2V5XSxuZXdWYWx1ZTpuZXdPYmplY3Qsa2V5cGF0aDprZXlwYXRofSk7CgkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZE9iamVjdFtrZXldLHVuZGVmaW5lZCxrZXlwYXRoKTsKCQkJCQl9KTsKCQkJCX0KCQkJfQoJCQljaGFuZ2VzZXQuZm9yRWFjaChmdW5jdGlvbihjaGFuZ2UpIHsKCQkJCXZhciBrZXlwYXRoID0gKHBhcnRzLmxlbmd0aD4wID8gcGFydHMuam9pbigiLiIpICsgIi4iIDogIiIpICsgY2hhbmdlLm5hbWU7CgoJCQkJaWYgKGNoYW5nZS50eXBlID09PSAidXBkYXRlIiB8fCBjaGFuZ2UudHlwZSA9PT0gImFkZCIpIHsgCgkJCQkJcmVvYnNlcnZlKGNoYW5nZS5vYmplY3QsIHBhcnRzKTsKCQkJCX0KCgkJCQljaGFuZ2VzLnB1c2goe25hbWU6Y2hhbmdlLm5hbWUsb2JqZWN0OmNoYW5nZS5vYmplY3QsdHlwZTpjaGFuZ2UudHlwZSxvbGRWYWx1ZTpjaGFuZ2Uub2xkVmFsdWUsbmV3VmFsdWU6Y2hhbmdlLm9iamVjdFtjaGFuZ2UubmFtZV0sa2V5cGF0aDprZXlwYXRofSk7CgkJCQlyZWN1cnNlKGNoYW5nZS5uYW1lLGNoYW5nZS5vYmplY3QsY2hhbmdlLm9sZFZhbHVlLGNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGgpOwoJCQl9KTsKCQkJY2FsbGJhY2soY2hhbmdlcyk7CgkJfSk7CgkJcmV0dXJuIG9ic2VydmVkOwoJfTsKfSkoKTsKCgovKioqLyB9KSwKLyogMTU0ICovLAovKiAxNTUgKi8sCi8qIDE1NiAqLywKLyogMTU3ICovLAovKiAxNTggKi8sCi8qIDE1OSAqLywKLyogMTYwICovLAovKiAxNjEgKi8sCi8qIDE2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkRhdGFPYmplY3RPYnNlcnZlciA9IGV4cG9ydHMuRGF0YU9iamVjdFJlcG9ydGVyID0gZXhwb3J0cy5TeW5jaGVyID0gdW5kZWZpbmVkOwoKdmFyIF9TeW5jaGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzApOwoKdmFyIF9TeW5jaGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1N5bmNoZXIpOwoKdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOSk7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuU3luY2hlciA9IF9TeW5jaGVyMi5kZWZhdWx0OwpleHBvcnRzLkRhdGFPYmplY3RSZXBvcnRlciA9IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQ7CmV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdDsKCi8qKiovIH0pCi8qKioqKiovIF0pOwp9KTsKCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwoKJ3VzZSBzdHJpY3QnOwoKLy8gU2hpbW1pbmcgc3RhcnRzIGhlcmUuCihmdW5jdGlvbigpIHsKICAvLyBVdGlscy4KICB2YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7CiAgdmFyIGxvZ2dpbmcgPSB1dGlscy5sb2c7CiAgdmFyIGJyb3dzZXJEZXRhaWxzID0gdXRpbHMuYnJvd3NlckRldGFpbHM7CiAgLy8gRXhwb3J0IHRvIHRoZSBhZGFwdGVyIGdsb2JhbCBvYmplY3QgdmlzaWJsZSBpbiB0aGUgYnJvd3Nlci4KICBtb2R1bGUuZXhwb3J0cy5icm93c2VyRGV0YWlscyA9IGJyb3dzZXJEZXRhaWxzOwogIG1vZHVsZS5leHBvcnRzLmV4dHJhY3RWZXJzaW9uID0gdXRpbHMuZXh0cmFjdFZlcnNpb247CiAgbW9kdWxlLmV4cG9ydHMuZGlzYWJsZUxvZyA9IHV0aWxzLmRpc2FibGVMb2c7CgogIC8vIFVuY29tbWVudCB0aGUgbGluZSBiZWxvdyBpZiB5b3Ugd2FudCBsb2dnaW5nIHRvIG9jY3VyLCBpbmNsdWRpbmcgbG9nZ2luZwogIC8vIGZvciB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdy4gQ2FuIGFsc28gYmUgdHVybmVkIG9uIGluIHRoZSBicm93c2VyIHZpYQogIC8vIGFkYXB0ZXIuZGlzYWJsZUxvZyhmYWxzZSksIGJ1dCB0aGVuIGxvZ2dpbmcgZnJvbSB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdwogIC8vIHdpbGwgbm90IGFwcGVhci4KICAvLyByZXF1aXJlKCcuL3V0aWxzJykuZGlzYWJsZUxvZyhmYWxzZSk7CgogIC8vIEJyb3dzZXIgc2hpbXMuCiAgdmFyIGNocm9tZVNoaW0gPSByZXF1aXJlKCcuL2Nocm9tZS9jaHJvbWVfc2hpbScpIHx8IG51bGw7CiAgdmFyIGVkZ2VTaGltID0gcmVxdWlyZSgnLi9lZGdlL2VkZ2Vfc2hpbScpIHx8IG51bGw7CiAgdmFyIGZpcmVmb3hTaGltID0gcmVxdWlyZSgnLi9maXJlZm94L2ZpcmVmb3hfc2hpbScpIHx8IG51bGw7CiAgdmFyIHNhZmFyaVNoaW0gPSByZXF1aXJlKCcuL3NhZmFyaS9zYWZhcmlfc2hpbScpIHx8IG51bGw7CgogIC8vIFNoaW0gYnJvd3NlciBpZiBmb3VuZC4KICBzd2l0Y2ggKGJyb3dzZXJEZXRhaWxzLmJyb3dzZXIpIHsKICAgIGNhc2UgJ2Nocm9tZSc6CiAgICAgIGlmICghY2hyb21lU2hpbSB8fCAhY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdDaHJvbWUgc2hpbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhpcyBhZGFwdGVyIHJlbGVhc2UuJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGxvZ2dpbmcoJ2FkYXB0ZXIuanMgc2hpbW1pbmcgY2hyb21lLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGNocm9tZVNoaW07CgogICAgICBjaHJvbWVTaGltLnNoaW1HZXRVc2VyTWVkaWEoKTsKICAgICAgY2hyb21lU2hpbS5zaGltTWVkaWFTdHJlYW0oKTsKICAgICAgdXRpbHMuc2hpbUNyZWF0ZU9iamVjdFVSTCgpOwogICAgICBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QoKTsKICAgICAgY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgY2hyb21lU2hpbS5zaGltT25UcmFjaygpOwogICAgICBicmVhazsKICAgIGNhc2UgJ2ZpcmVmb3gnOgogICAgICBpZiAoIWZpcmVmb3hTaGltIHx8ICFmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdGaXJlZm94IHNoaW0gaXMgbm90IGluY2x1ZGVkIGluIHRoaXMgYWRhcHRlciByZWxlYXNlLicpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBsb2dnaW5nKCdhZGFwdGVyLmpzIHNoaW1taW5nIGZpcmVmb3guJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gZmlyZWZveFNoaW07CgogICAgICBmaXJlZm94U2hpbS5zaGltR2V0VXNlck1lZGlhKCk7CiAgICAgIHV0aWxzLnNoaW1DcmVhdGVPYmplY3RVUkwoKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbVNvdXJjZU9iamVjdCgpOwogICAgICBmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbU9uVHJhY2soKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdlZGdlJzoKICAgICAgaWYgKCFlZGdlU2hpbSB8fCAhZWRnZVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uKSB7CiAgICAgICAgbG9nZ2luZygnTVMgZWRnZSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBlZGdlLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGVkZ2VTaGltOwoKICAgICAgZWRnZVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMKCk7CiAgICAgIGVkZ2VTaGltLnNoaW1QZWVyQ29ubmVjdGlvbigpOwogICAgICBicmVhazsKICAgIGNhc2UgJ3NhZmFyaSc6CiAgICAgIGlmICghc2FmYXJpU2hpbSkgewogICAgICAgIGxvZ2dpbmcoJ1NhZmFyaSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBzYWZhcmkuJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gc2FmYXJpU2hpbTsKCiAgICAgIHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgIGxvZ2dpbmcoJ1Vuc3VwcG9ydGVkIGJyb3dzZXIhJyk7CiAgfQp9KSgpOwoKfSx7Ii4vY2hyb21lL2Nocm9tZV9zaGltIjo0LCIuL2VkZ2UvZWRnZV9zaGltIjo2LCIuL2ZpcmVmb3gvZmlyZWZveF9zaGltIjo4LCIuL3NhZmFyaS9zYWZhcmlfc2hpbSI6MTAsIi4vdXRpbHMiOjExfV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CgovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzLmpzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgY2hyb21lU2hpbSA9IHsKICBzaGltTWVkaWFTdHJlYW06IGZ1bmN0aW9uKCkgewogICAgd2luZG93Lk1lZGlhU3RyZWFtID0gd2luZG93Lk1lZGlhU3RyZWFtIHx8IHdpbmRvdy53ZWJraXRNZWRpYVN0cmVhbTsKICB9LAoKICBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmICEoJ29udHJhY2snIGluCiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUsICdvbnRyYWNrJywgewogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5fb250cmFjazsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24oZikgewogICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgaWYgKHRoaXMuX29udHJhY2spIHsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFjaycsIHRoaXMuX29udHJhY2spOwogICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5KTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrID0gZik7CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5ID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAvLyBvbmFkZHN0cmVhbSBkb2VzIG5vdCBmaXJlIHdoZW4gYSB0cmFjayBpcyBhZGRlZCB0byBhbiBleGlzdGluZwogICAgICAgICAgICAvLyBzdHJlYW0uIEJ1dCBzdHJlYW0ub25hZGR0cmFjayBpcyBpbXBsZW1lbnRlZCBzbyB3ZSB1c2UgdGhhdC4KICAgICAgICAgICAgZS5zdHJlYW0uYWRkRXZlbnRMaXN0ZW5lcignYWRkdHJhY2snLCBmdW5jdGlvbih0ZSkgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRlLnRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0ZS50cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGUuc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHsKICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ3RyYWNrJyk7CiAgICAgICAgICAgICAgZXZlbnQudHJhY2sgPSB0cmFjazsKICAgICAgICAgICAgICBldmVudC5yZWNlaXZlciA9IHt0cmFjazogdHJhY2t9OwogICAgICAgICAgICAgIGV2ZW50LnN0cmVhbXMgPSBbZS5zdHJlYW1dOwogICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgICB9LmJpbmQodGhpcykpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKCiAgc2hpbVNvdXJjZU9iamVjdDogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHsKICAgICAgaWYgKHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50ICYmCiAgICAgICAgISgnc3JjT2JqZWN0JyBpbiB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUpKSB7CiAgICAgICAgLy8gU2hpbSB0aGUgc3JjT2JqZWN0IHByb3BlcnR5LCBvbmNlLCB3aGVuIEhUTUxNZWRpYUVsZW1lbnQgaXMgZm91bmQuCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyY09iamVjdCcsIHsKICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zcmNPYmplY3Q7CiAgICAgICAgICB9LAogICAgICAgICAgc2V0OiBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgICAvLyBVc2UgX3NyY09iamVjdCBhcyBhIHByaXZhdGUgcHJvcGVydHkgZm9yIHRoaXMgc2hpbQogICAgICAgICAgICB0aGlzLl9zcmNPYmplY3QgPSBzdHJlYW07CiAgICAgICAgICAgIGlmICh0aGlzLnNyYykgewogICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5zcmMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIXN0cmVhbSkgewogICAgICAgICAgICAgIHRoaXMuc3JjID0gJyc7CiAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTsKICAgICAgICAgICAgLy8gV2UgbmVlZCB0byByZWNyZWF0ZSB0aGUgYmxvYiB1cmwgd2hlbiBhIHRyYWNrIGlzIGFkZGVkIG9yCiAgICAgICAgICAgIC8vIHJlbW92ZWQuIERvaW5nIGl0IG1hbnVhbGx5IHNpbmNlIHdlIHdhbnQgdG8gYXZvaWQgYSByZWN1cnNpb24uCiAgICAgICAgICAgIHN0cmVhbS5hZGRFdmVudExpc3RlbmVyKCdhZGR0cmFjaycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIGlmIChzZWxmLnNyYykgewogICAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChzZWxmLnNyYyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHNlbGYuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc3RyZWFtLmFkZEV2ZW50TGlzdGVuZXIoJ3JlbW92ZXRyYWNrJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgaWYgKHNlbGYuc3JjKSB7CiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHNlbGYuc3JjKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgc2VsZi5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIC8vIFRoZSBSVENQZWVyQ29ubmVjdGlvbiBvYmplY3QuCiAgICBpZiAoIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikgewogICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gPSBmdW5jdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cykgewogICAgICAgIC8vIFRyYW5zbGF0ZSBpY2VUcmFuc3BvcnRQb2xpY3kgdG8gaWNlVHJhbnNwb3J0cywKICAgICAgICAvLyBzZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD00ODY5CiAgICAgICAgLy8gdGhpcyB3YXMgZml4ZWQgaW4gTTU2IGFsb25nIHdpdGggdW5wcmVmaXhpbmcgUlRDUGVlckNvbm5lY3Rpb24uCiAgICAgICAgbG9nZ2luZygnUGVlckNvbm5lY3Rpb24nKTsKICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5KSB7CiAgICAgICAgICBwY0NvbmZpZy5pY2VUcmFuc3BvcnRzID0gcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CiAgICAgIC8vIHdyYXAgc3RhdGljIG1ldGhvZHMuIEN1cnJlbnRseSBqdXN0IGdlbmVyYXRlQ2VydGlmaWNhdGUuCiAgICAgIGlmICh3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5nZW5lcmF0ZUNlcnRpZmljYXRlKSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiwgJ2dlbmVyYXRlQ2VydGlmaWNhdGUnLCB7CiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gd2Via2l0UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIHZhciBvcmlnR2V0U3RhdHMgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHM7CiAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbihzZWxlY3RvciwKICAgICAgICBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgYXJncyA9IGFyZ3VtZW50czsKCiAgICAgIC8vIElmIHNlbGVjdG9yIGlzIGEgZnVuY3Rpb24gdGhlbiB3ZSBhcmUgaW4gdGhlIG9sZCBzdHlsZSBzdGF0cyBzbyBqdXN0CiAgICAgIC8vIHBhc3MgYmFjayB0aGUgb3JpZ2luYWwgZ2V0U3RhdHMgZm9ybWF0IHRvIGF2b2lkIGJyZWFraW5nIG9sZCB1c2Vycy4KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHJldHVybiBvcmlnR2V0U3RhdHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgLy8gV2hlbiBzcGVjLXN0eWxlIGdldFN0YXRzIGlzIHN1cHBvcnRlZCwgcmV0dXJuIHRob3NlIHdoZW4gY2FsbGVkIHdpdGgKICAgICAgLy8gZWl0aGVyIG5vIGFyZ3VtZW50cyBvciB0aGUgc2VsZWN0b3IgYXJndW1lbnQgaXMgbnVsbC4KICAgICAgaWYgKG9yaWdHZXRTdGF0cy5sZW5ndGggPT09IDAgJiYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHwKICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpKSB7CiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbXSk7CiAgICAgIH0KCiAgICAgIHZhciBmaXhDaHJvbWVTdGF0c18gPSBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgIHZhciBzdGFuZGFyZFJlcG9ydCA9IHt9OwogICAgICAgIHZhciByZXBvcnRzID0gcmVzcG9uc2UucmVzdWx0KCk7CiAgICAgICAgcmVwb3J0cy5mb3JFYWNoKGZ1bmN0aW9uKHJlcG9ydCkgewogICAgICAgICAgdmFyIHN0YW5kYXJkU3RhdHMgPSB7CiAgICAgICAgICAgIGlkOiByZXBvcnQuaWQsCiAgICAgICAgICAgIHRpbWVzdGFtcDogcmVwb3J0LnRpbWVzdGFtcCwKICAgICAgICAgICAgdHlwZTogewogICAgICAgICAgICAgIGxvY2FsY2FuZGlkYXRlOiAnbG9jYWwtY2FuZGlkYXRlJywKICAgICAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgICAgICB9W3JlcG9ydC50eXBlXSB8fCByZXBvcnQudHlwZQogICAgICAgICAgfTsKICAgICAgICAgIHJlcG9ydC5uYW1lcygpLmZvckVhY2goZnVuY3Rpb24obmFtZSkgewogICAgICAgICAgICBzdGFuZGFyZFN0YXRzW25hbWVdID0gcmVwb3J0LnN0YXQobmFtZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHN0YW5kYXJkUmVwb3J0W3N0YW5kYXJkU3RhdHMuaWRdID0gc3RhbmRhcmRTdGF0czsKICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIHN0YW5kYXJkUmVwb3J0OwogICAgICB9OwoKICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICB2YXIgbWFrZU1hcFN0YXRzID0gZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICByZXR1cm4gbmV3IE1hcChPYmplY3Qua2V5cyhzdGF0cykubWFwKGZ1bmN0aW9uKGtleSkgewogICAgICAgICAgcmV0dXJuW2tleSwgc3RhdHNba2V5XV07CiAgICAgICAgfSkpOwogICAgICB9OwoKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMikgewogICAgICAgIHZhciBzdWNjZXNzQ2FsbGJhY2tXcmFwcGVyXyA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICBhcmdzWzFdKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgfTsKCiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbc3VjY2Vzc0NhbGxiYWNrV3JhcHBlcl8sCiAgICAgICAgICAgIGFyZ3VtZW50c1swXV0pOwogICAgICB9CgogICAgICAvLyBwcm9taXNlLXN1cHBvcnQKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIG9yaWdHZXRTdGF0cy5hcHBseShzZWxmLCBbCiAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICByZXNvbHZlKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgICB9LCByZWplY3RdKTsKICAgICAgfSkudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spOwogICAgfTsKCiAgICAvLyBhZGQgcHJvbWlzZSBzdXBwb3J0IC0tIG5hdGl2ZWx5IGF2YWlsYWJsZSBpbiBDaHJvbWUgNTEKICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNTEpIHsKICAgICAgWydzZXRMb2NhbERlc2NyaXB0aW9uJywgJ3NldFJlbW90ZURlc2NyaXB0aW9uJywgJ2FkZEljZUNhbmRpZGF0ZSddCiAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzOwogICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFthcmdzWzBdLCByZXNvbHZlLCByZWplY3RdKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGFyZ3NbMV0uYXBwbHkobnVsbCwgW10pOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZnVuY3Rpb24oZXJyKSB7CiAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPj0gMykgewogICAgICAgICAgICAgICAgICBhcmdzWzJdLmFwcGx5KG51bGwsIFtlcnJdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgfQoKICAgIC8vIHByb21pc2Ugc3VwcG9ydCBmb3IgY3JlYXRlT2ZmZXIgYW5kIGNyZWF0ZUFuc3dlci4gQXZhaWxhYmxlICh3aXRob3V0CiAgICAvLyBidWdzKSBzaW5jZSBNNTI6IGNyYnVnLzYxOTI4OQogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MikgewogICAgICBbJ2NyZWF0ZU9mZmVyJywgJ2NyZWF0ZUFuc3dlciddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDEgfHwgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYKICAgICAgICAgICAgICB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnb2JqZWN0JykpIHsKICAgICAgICAgICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkOwogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFtyZXNvbHZlLCByZWplY3QsIG9wdHNdKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CgogICAgLy8gc2hpbSBpbXBsaWNpdCBjcmVhdGlvbiBvZiBSVENTZXNzaW9uRGVzY3JpcHRpb24vUlRDSWNlQ2FuZGlkYXRlCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfQp9OwoKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbU1lZGlhU3RyZWFtOiBjaHJvbWVTaGltLnNoaW1NZWRpYVN0cmVhbSwKICBzaGltT25UcmFjazogY2hyb21lU2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QsCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBjaHJvbWVTaGltLnNoaW1QZWVyQ29ubmVjdGlvbiwKICBzaGltR2V0VXNlck1lZGlhOiByZXF1aXJlKCcuL2dldHVzZXJtZWRpYScpCn07Cgp9LHsiLi4vdXRpbHMuanMiOjExLCIuL2dldHVzZXJtZWRpYSI6NX1dLDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIGNvbnN0cmFpbnRzVG9DaHJvbWVfID0gZnVuY3Rpb24oYykgewogICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLm1hbmRhdG9yeSB8fCBjLm9wdGlvbmFsKSB7CiAgICAgIHJldHVybiBjOwogICAgfQogICAgdmFyIGNjID0ge307CiAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICBpZiAoa2V5ID09PSAncmVxdWlyZScgfHwga2V5ID09PSAnYWR2YW5jZWQnIHx8IGtleSA9PT0gJ21lZGlhU291cmNlJykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgciA9ICh0eXBlb2YgY1trZXldID09PSAnb2JqZWN0JykgPyBjW2tleV0gOiB7aWRlYWw6IGNba2V5XX07CiAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHIuZXhhY3QgPT09ICdudW1iZXInKSB7CiAgICAgICAgci5taW4gPSByLm1heCA9IHIuZXhhY3Q7CiAgICAgIH0KICAgICAgdmFyIG9sZG5hbWVfID0gZnVuY3Rpb24ocHJlZml4LCBuYW1lKSB7CiAgICAgICAgaWYgKHByZWZpeCkgewogICAgICAgICAgcmV0dXJuIHByZWZpeCArIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gKG5hbWUgPT09ICdkZXZpY2VJZCcpID8gJ3NvdXJjZUlkJyA6IG5hbWU7CiAgICAgIH07CiAgICAgIGlmIChyLmlkZWFsICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjYy5vcHRpb25hbCA9IGNjLm9wdGlvbmFsIHx8IFtdOwogICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgIGlmICh0eXBlb2Ygci5pZGVhbCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCdtaW4nLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICAgIG9jID0ge307CiAgICAgICAgICBvY1tvbGRuYW1lXygnbWF4Jywga2V5KV0gPSByLmlkZWFsOwogICAgICAgICAgY2Mub3B0aW9uYWwucHVzaChvYyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHIuZXhhY3QgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygci5leGFjdCAhPT0gJ251bWJlcicpIHsKICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgY2MubWFuZGF0b3J5W29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuZXhhY3Q7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgWydtaW4nLCAnbWF4J10uZm9yRWFjaChmdW5jdGlvbihtaXgpIHsKICAgICAgICAgIGlmIChyW21peF0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgICAgIGNjLm1hbmRhdG9yeVtvbGRuYW1lXyhtaXgsIGtleSldID0gclttaXhdOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICAgIGlmIChjLmFkdmFuY2VkKSB7CiAgICAgIGNjLm9wdGlvbmFsID0gKGNjLm9wdGlvbmFsIHx8IFtdKS5jb25jYXQoYy5hZHZhbmNlZCk7CiAgICB9CiAgICByZXR1cm4gY2M7CiAgfTsKCiAgdmFyIHNoaW1Db25zdHJhaW50c18gPSBmdW5jdGlvbihjb25zdHJhaW50cywgZnVuYykgewogICAgY29uc3RyYWludHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7CiAgICBpZiAoY29uc3RyYWludHMgJiYgY29uc3RyYWludHMuYXVkaW8pIHsKICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy5hdWRpbyk7CiAgICB9CiAgICBpZiAoY29uc3RyYWludHMgJiYgdHlwZW9mIGNvbnN0cmFpbnRzLnZpZGVvID09PSAnb2JqZWN0JykgewogICAgICAvLyBTaGltIGZhY2luZ01vZGUgZm9yIG1vYmlsZSwgd2hlcmUgaXQgZGVmYXVsdHMgdG8gInVzZXIiLgogICAgICB2YXIgZmFjZSA9IGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgIGZhY2UgPSBmYWNlICYmICgodHlwZW9mIGZhY2UgPT09ICdvYmplY3QnKSA/IGZhY2UgOiB7aWRlYWw6IGZhY2V9KTsKCiAgICAgIGlmICgoZmFjZSAmJiAoZmFjZS5leGFjdCA9PT0gJ3VzZXInIHx8IGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwKICAgICAgICAgICAgICAgICAgICBmYWNlLmlkZWFsID09PSAndXNlcicgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykpICYmCiAgICAgICAgICAhKG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0U3VwcG9ydGVkQ29uc3RyYWludHMgJiYKICAgICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRTdXBwb3J0ZWRDb25zdHJhaW50cygpLmZhY2luZ01vZGUpKSB7CiAgICAgICAgZGVsZXRlIGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgICAgaWYgKGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykgewogICAgICAgICAgLy8gTG9vayBmb3IgImJhY2siIGluIGxhYmVsLCBvciB1c2UgbGFzdCBjYW0gKHR5cGljYWxseSBiYWNrIGNhbSkuCiAgICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzKCkKICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgZGV2aWNlcyA9IGRldmljZXMuZmlsdGVyKGZ1bmN0aW9uKGQpIHsKICAgICAgICAgICAgICByZXR1cm4gZC5raW5kID09PSAndmlkZW9pbnB1dCc7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgYmFjayA9IGRldmljZXMuZmluZChmdW5jdGlvbihkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGQubGFiZWwudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdiYWNrJykgIT09IC0xOwogICAgICAgICAgICB9KSB8fCAoZGV2aWNlcy5sZW5ndGggJiYgZGV2aWNlc1tkZXZpY2VzLmxlbmd0aCAtIDFdKTsKICAgICAgICAgICAgaWYgKGJhY2spIHsKICAgICAgICAgICAgICBjb25zdHJhaW50cy52aWRlby5kZXZpY2VJZCA9IGZhY2UuZXhhY3QgPyB7ZXhhY3Q6IGJhY2suZGV2aWNlSWR9IDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aWRlYWw6IGJhY2suZGV2aWNlSWR9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0Nocm9tZV8oY29uc3RyYWludHMudmlkZW8pOwogICAgICAgICAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgICAgICAgICByZXR1cm4gZnVuYyhjb25zdHJhaW50cyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3RyYWludHMudmlkZW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy52aWRlbyk7CiAgICB9CiAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgcmV0dXJuIGZ1bmMoY29uc3RyYWludHMpOwogIH07CgogIHZhciBzaGltRXJyb3JfID0gZnVuY3Rpb24oZSkgewogICAgcmV0dXJuIHsKICAgICAgbmFtZTogewogICAgICAgIFBlcm1pc3Npb25EZW5pZWRFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgQ29uc3RyYWludE5vdFNhdGlzZmllZEVycm9yOiAnT3ZlcmNvbnN0cmFpbmVkRXJyb3InCiAgICAgIH1bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50TmFtZSwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgc2hpbUNvbnN0cmFpbnRzXyhjb25zdHJhaW50cywgZnVuY3Rpb24oYykgewogICAgICBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKGMsIG9uU3VjY2VzcywgZnVuY3Rpb24oZSkgewogICAgICAgIG9uRXJyb3Ioc2hpbUVycm9yXyhlKSk7CiAgICAgIH0pOwogICAgfSk7CiAgfTsKCiAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IGdldFVzZXJNZWRpYV87CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICBpZiAoIW5hdmlnYXRvci5tZWRpYURldmljZXMpIHsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMgPSB7CiAgICAgIGdldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGVudW1lcmF0ZURldmljZXM6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIga2luZHMgPSB7YXVkaW86ICdhdWRpb2lucHV0JywgdmlkZW86ICd2aWRlb2lucHV0J307CiAgICAgICAgICByZXR1cm4gTWVkaWFTdHJlYW1UcmFjay5nZXRTb3VyY2VzKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgcmVzb2x2ZShkZXZpY2VzLm1hcChmdW5jdGlvbihkZXZpY2UpIHsKICAgICAgICAgICAgICByZXR1cm4ge2xhYmVsOiBkZXZpY2UubGFiZWwsCiAgICAgICAgICAgICAgICAgICAgICBraW5kOiBraW5kc1tkZXZpY2Uua2luZF0sCiAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZDogZGV2aWNlLmlkLAogICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogJyd9OwogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfTsKICB9CgogIC8vIEEgc2hpbSBmb3IgZ2V0VXNlck1lZGlhIG1ldGhvZCBvbiB0aGUgbWVkaWFEZXZpY2VzIG9iamVjdC4KICAvLyBUT0RPKEthcHRlbkphbnNzb24pIHJlbW92ZSBvbmNlIGltcGxlbWVudGVkIGluIENocm9tZSBzdGFibGUuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSkgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cykgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhUHJvbWlzZV8oY29uc3RyYWludHMpOwogICAgfTsKICB9IGVsc2UgewogICAgLy8gRXZlbiB0aG91Z2ggQ2hyb21lIDQ1IGhhcyBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzIGFuZCBhIGdldFVzZXJNZWRpYQogICAgLy8gZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhIFByb21pc2UsIGl0IGRvZXMgbm90IGFjY2VwdCBzcGVjLXN0eWxlCiAgICAvLyBjb25zdHJhaW50cy4KICAgIHZhciBvcmlnR2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEuCiAgICAgICAgYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY3MpIHsKICAgICAgcmV0dXJuIHNoaW1Db25zdHJhaW50c18oY3MsIGZ1bmN0aW9uKGMpIHsKICAgICAgICByZXR1cm4gb3JpZ0dldFVzZXJNZWRpYShjKS50aGVuKGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICAgIGMudmlkZW8gJiYgIXN0cmVhbS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCkgewogICAgICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJycsICdOb3RGb3VuZEVycm9yJyk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gc3RyZWFtOwogICAgICAgIH0sIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KCiAgLy8gRHVtbXkgZGV2aWNlY2hhbmdlIGV2ZW50IG1ldGhvZHMuCiAgLy8gVE9ETyhLYXB0ZW5KYW5zc29uKSByZW1vdmUgb25jZSBpbXBsZW1lbnRlZCBpbiBDaHJvbWUgc3RhYmxlLgogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQp9OwoKfSx7Ii4uL3V0aWxzLmpzIjoxMX1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7Cgp2YXIgU0RQVXRpbHMgPSByZXF1aXJlKCdzZHAnKTsKdmFyIGJyb3dzZXJEZXRhaWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5icm93c2VyRGV0YWlsczsKCnZhciBlZGdlU2hpbSA9IHsKICBzaGltUGVlckNvbm5lY3Rpb246IGZ1bmN0aW9uKCkgewogICAgaWYgKHdpbmRvdy5SVENJY2VHYXRoZXJlcikgewogICAgICAvLyBPUlRDIGRlZmluZXMgYW4gUlRDSWNlQ2FuZGlkYXRlIG9iamVjdCBidXQgbm8gY29uc3RydWN0b3IuCiAgICAgIC8vIE5vdCBpbXBsZW1lbnRlZCBpbiBFZGdlLgogICAgICBpZiAoIXdpbmRvdy5SVENJY2VDYW5kaWRhdGUpIHsKICAgICAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oYXJncykgewogICAgICAgICAgcmV0dXJuIGFyZ3M7CiAgICAgICAgfTsKICAgICAgfQogICAgICAvLyBPUlRDIGRvZXMgbm90IGhhdmUgYSBzZXNzaW9uIGRlc2NyaXB0aW9uIG9iamVjdCBidXQKICAgICAgLy8gb3RoZXIgYnJvd3NlcnMgKGkuZS4gQ2hyb21lKSB0aGF0IHdpbGwgc3VwcG9ydCBib3RoIFBDIGFuZCBPUlRDCiAgICAgIC8vIGluIHRoZSBmdXR1cmUgbWlnaHQgaGF2ZSB0aGlzIGRlZmluZWQgYWxyZWFkeS4KICAgICAgaWYgKCF3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKSB7CiAgICAgICAgd2luZG93LlJUQ1Nlc3Npb25EZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGFyZ3MpIHsKICAgICAgICAgIHJldHVybiBhcmdzOwogICAgICAgIH07CiAgICAgIH0KICAgICAgLy8gdGhpcyBhZGRzIGFuIGFkZGl0aW9uYWwgZXZlbnQgbGlzdGVuZXIgdG8gTWVkaWFTdHJhY2tUcmFjayB0aGF0IHNpZ25hbHMKICAgICAgLy8gd2hlbiBhIHRyYWNrcyBlbmFibGVkIHByb3BlcnR5IHdhcyBjaGFuZ2VkLiBXb3JrYXJvdW5kIGZvciBhIGJ1ZyBpbgogICAgICAvLyBhZGRTdHJlYW0sIHNlZSBiZWxvdy4gTm8gbG9uZ2VyIHJlcXVpcmVkIGluIDE1MDI1KwogICAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDE1MDI1KSB7CiAgICAgICAgdmFyIG9yaWdNU1RFbmFibGVkID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcigKICAgICAgICAgICAgTWVkaWFTdHJlYW1UcmFjay5wcm90b3R5cGUsICdlbmFibGVkJyk7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLCAnZW5hYmxlZCcsIHsKICAgICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgb3JpZ01TVEVuYWJsZWQuc2V0LmNhbGwodGhpcywgdmFsdWUpOwogICAgICAgICAgICB2YXIgZXYgPSBuZXcgRXZlbnQoJ2VuYWJsZWQnKTsKICAgICAgICAgICAgZXYuZW5hYmxlZCA9IHZhbHVlOwogICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24oY29uZmlnKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgIHZhciBfZXZlbnRUYXJnZXQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CiAgICAgIFsnYWRkRXZlbnRMaXN0ZW5lcicsICdyZW1vdmVFdmVudExpc3RlbmVyJywgJ2Rpc3BhdGNoRXZlbnQnXQogICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgICAgIHNlbGZbbWV0aG9kXSA9IF9ldmVudFRhcmdldFttZXRob2RdLmJpbmQoX2V2ZW50VGFyZ2V0KTsKICAgICAgICAgIH0pOwoKICAgICAgdGhpcy5vbmljZWNhbmRpZGF0ZSA9IG51bGw7CiAgICAgIHRoaXMub25hZGRzdHJlYW0gPSBudWxsOwogICAgICB0aGlzLm9udHJhY2sgPSBudWxsOwogICAgICB0aGlzLm9ucmVtb3Zlc3RyZWFtID0gbnVsbDsKICAgICAgdGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlID0gbnVsbDsKICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCA9IG51bGw7CiAgICAgIHRoaXMub25kYXRhY2hhbm5lbCA9IG51bGw7CgogICAgICB0aGlzLmxvY2FsU3RyZWFtcyA9IFtdOwogICAgICB0aGlzLnJlbW90ZVN0cmVhbXMgPSBbXTsKICAgICAgdGhpcy5nZXRMb2NhbFN0cmVhbXMgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gc2VsZi5sb2NhbFN0cmVhbXM7CiAgICAgIH07CiAgICAgIHRoaXMuZ2V0UmVtb3RlU3RyZWFtcyA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBzZWxmLnJlbW90ZVN0cmVhbXM7CiAgICAgIH07CgogICAgICB0aGlzLmxvY2FsRGVzY3JpcHRpb24gPSBuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHsKICAgICAgICB0eXBlOiAnJywKICAgICAgICBzZHA6ICcnCiAgICAgIH0pOwogICAgICB0aGlzLnJlbW90ZURlc2NyaXB0aW9uID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJycsCiAgICAgICAgc2RwOiAnJwogICAgICB9KTsKICAgICAgdGhpcy5zaWduYWxpbmdTdGF0ZSA9ICdzdGFibGUnOwogICAgICB0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSA9ICduZXcnOwogICAgICB0aGlzLmljZUdhdGhlcmluZ1N0YXRlID0gJ25ldyc7CgogICAgICB0aGlzLmljZU9wdGlvbnMgPSB7CiAgICAgICAgZ2F0aGVyUG9saWN5OiAnYWxsJywKICAgICAgICBpY2VTZXJ2ZXJzOiBbXQogICAgICB9OwogICAgICBpZiAoY29uZmlnICYmIGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICBzd2l0Y2ggKGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICAgIGNhc2UgJ2FsbCc6CiAgICAgICAgICBjYXNlICdyZWxheSc6CiAgICAgICAgICAgIHRoaXMuaWNlT3B0aW9ucy5nYXRoZXJQb2xpY3kgPSBjb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgJ25vbmUnOgogICAgICAgICAgICAvLyBGSVhNRTogcmVtb3ZlIG9uY2UgaW1wbGVtZW50YXRpb24gYW5kIHNwZWMgaGF2ZSBhZGRlZCB0aGlzLgogICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpY2VUcmFuc3BvcnRQb2xpY3kgIm5vbmUiIG5vdCBzdXBwb3J0ZWQnKTsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIC8vIGRvbid0IHNldCBpY2VUcmFuc3BvcnRQb2xpY3kuCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnVzaW5nQnVuZGxlID0gY29uZmlnICYmIGNvbmZpZy5idW5kbGVQb2xpY3kgPT09ICdtYXgtYnVuZGxlJzsKCiAgICAgIGlmIChjb25maWcgJiYgY29uZmlnLmljZVNlcnZlcnMpIHsKICAgICAgICAvLyBFZGdlIGRvZXMgbm90IGxpa2UKICAgICAgICAvLyAxKSBzdHVuOgogICAgICAgIC8vIDIpIHR1cm46IHRoYXQgZG9lcyBub3QgaGF2ZSBhbGwgb2YgdHVybjpob3N0OnBvcnQ/dHJhbnNwb3J0PXVkcAogICAgICAgIC8vIDMpIHR1cm46IHdpdGggaXB2NiBhZGRyZXNzZXMKICAgICAgICB2YXIgaWNlU2VydmVycyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29uZmlnLmljZVNlcnZlcnMpKTsKICAgICAgICB0aGlzLmljZU9wdGlvbnMuaWNlU2VydmVycyA9IGljZVNlcnZlcnMuZmlsdGVyKGZ1bmN0aW9uKHNlcnZlcikgewogICAgICAgICAgaWYgKHNlcnZlciAmJiBzZXJ2ZXIudXJscykgewogICAgICAgICAgICB2YXIgdXJscyA9IHNlcnZlci51cmxzOwogICAgICAgICAgICBpZiAodHlwZW9mIHVybHMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgdXJscyA9IFt1cmxzXTsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cmxzID0gdXJscy5maWx0ZXIoZnVuY3Rpb24odXJsKSB7CiAgICAgICAgICAgICAgcmV0dXJuICh1cmwuaW5kZXhPZigndHVybjonKSA9PT0gMCAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHJhbnNwb3J0PXVkcCcpICE9PSAtMSAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHVybjpbJykgPT09IC0xKSB8fAogICAgICAgICAgICAgICAgICAodXJsLmluZGV4T2YoJ3N0dW46JykgPT09IDAgJiYKICAgICAgICAgICAgICAgICAgICBicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE0MzkzKTsKICAgICAgICAgICAgfSlbMF07CiAgICAgICAgICAgIHJldHVybiAhIXVybHM7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnOwoKICAgICAgLy8gcGVyLXRyYWNrIGljZUdhdGhlcnMsIGljZVRyYW5zcG9ydHMsIGR0bHNUcmFuc3BvcnRzLCBydHBTZW5kZXJzLCAuLi4KICAgICAgLy8gZXZlcnl0aGluZyB0aGF0IGlzIG5lZWRlZCB0byBkZXNjcmliZSBhIFNEUCBtLWxpbmUuCiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzID0gW107CgogICAgICAvLyBzaW5jZSB0aGUgaWNlR2F0aGVyZXIgaXMgY3VycmVudGx5IGNyZWF0ZWQgaW4gY3JlYXRlT2ZmZXIgYnV0IHdlCiAgICAgIC8vIG11c3Qgbm90IGVtaXQgY2FuZGlkYXRlcyB1bnRpbCBhZnRlciBzZXRMb2NhbERlc2NyaXB0aW9uIHdlIGJ1ZmZlcgogICAgICAvLyB0aGVtIGluIHRoaXMgYXJyYXkuCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlciA9IFtdOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZScpOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICBpZiAodGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgdGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlKGV2ZW50KTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLmxvY2FsRGVzY3JpcHRpb24uc2RwKTsKICAgICAgLy8gRklYTUU6IG5lZWQgdG8gYXBwbHkgaWNlIGNhbmRpZGF0ZXMgaW4gYSB3YXkgd2hpY2ggaXMgYXN5bmMgYnV0CiAgICAgIC8vIGluLW9yZGVyCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlci5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgdmFyIGVuZCA9ICFldmVudC5jYW5kaWRhdGUgfHwgT2JqZWN0LmtleXMoZXZlbnQuY2FuZGlkYXRlKS5sZW5ndGggPT09IDA7CiAgICAgICAgaWYgKGVuZCkgewogICAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBzZWN0aW9ucy5sZW5ndGg7IGorKykgewogICAgICAgICAgICBpZiAoc2VjdGlvbnNbal0uaW5kZXhPZignXHJcbmE9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJykgPT09IC0xKSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbal0gKz0gJ2E9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWN0aW9uc1tldmVudC5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleCArIDFdICs9CiAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgfQogICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICBzZWxmLm9uaWNlY2FuZGlkYXRlKGV2ZW50KTsKICAgICAgICB9CiAgICAgICAgaWYgKCFldmVudC5jYW5kaWRhdGUgJiYgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSAhPT0gJ2NvbXBsZXRlJykgewogICAgICAgICAgdmFyIGNvbXBsZXRlID0gc2VsZi50cmFuc2NlaXZlcnMuZXZlcnkoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICB0cmFuc2NlaXZlci5pY2VHYXRoZXJlci5zdGF0ZSA9PT0gJ2NvbXBsZXRlZCc7CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChjb21wbGV0ZSAmJiBzZWxmLmljZUdhdGhlcmluZ1N0YXRlQ2hhbmdlICE9PSAnY29tcGxldGUnKSB7CiAgICAgICAgICAgIHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUgPSAnY29tcGxldGUnOwogICAgICAgICAgICBzZWxmLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIgPSBbXTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRDb25maWd1cmF0aW9uID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLl9jb25maWc7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkU3RyZWFtID0gZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE1MDI1KSB7CiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXMucHVzaChzdHJlYW0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIENsb25lIGlzIG5lY2Vzc2FyeSBmb3IgbG9jYWwgZGVtb3MgbW9zdGx5LCBhdHRhY2hpbmcgZGlyZWN0bHkKICAgICAgICAvLyB0byB0d28gZGlmZmVyZW50IHNlbmRlcnMgZG9lcyBub3Qgd29yayAoYnVpbGQgMTA1NDcpLgogICAgICAgIC8vIEZpeGVkIGluIDE1MDI1IChvciBlYXJsaWVyKQogICAgICAgIHZhciBjbG9uZWRTdHJlYW0gPSBzdHJlYW0uY2xvbmUoKTsKICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaywgaWR4KSB7CiAgICAgICAgICB2YXIgY2xvbmVkVHJhY2sgPSBjbG9uZWRTdHJlYW0uZ2V0VHJhY2tzKClbaWR4XTsKICAgICAgICAgIHRyYWNrLmFkZEV2ZW50TGlzdGVuZXIoJ2VuYWJsZWQnLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBjbG9uZWRUcmFjay5lbmFibGVkID0gZXZlbnQuZW5hYmxlZDsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHRoaXMubG9jYWxTdHJlYW1zLnB1c2goY2xvbmVkU3RyZWFtKTsKICAgICAgfQogICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICB2YXIgaWR4ID0gdGhpcy5sb2NhbFN0cmVhbXMuaW5kZXhPZihzdHJlYW0pOwogICAgICBpZiAoaWR4ID4gLTEpIHsKICAgICAgICB0aGlzLmxvY2FsU3RyZWFtcy5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy50cmFuc2NlaXZlcnMuZmlsdGVyKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuICEhdHJhbnNjZWl2ZXIucnRwU2VuZGVyOwogICAgICB9KQogICAgICAubWFwKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLnJ0cFNlbmRlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVjZWl2ZXJzID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLnRyYW5zY2VpdmVycy5maWx0ZXIoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICByZXR1cm4gISF0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSkKICAgICAgLm1hcChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIHJldHVybiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIC8vIERldGVybWluZXMgdGhlIGludGVyc2VjdGlvbiBvZiBsb2NhbCBhbmQgcmVtb3RlIGNhcGFiaWxpdGllcy4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2dldENvbW1vbkNhcGFiaWxpdGllcyA9CiAgICAgICAgZnVuY3Rpb24obG9jYWxDYXBhYmlsaXRpZXMsIHJlbW90ZUNhcGFiaWxpdGllcykgewogICAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHsKICAgICAgICAgICAgY29kZWNzOiBbXSwKICAgICAgICAgICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICAgICAgICAgIGZlY01lY2hhbmlzbXM6IFtdCiAgICAgICAgICB9OwogICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24obENvZGVjKSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3RlQ2FwYWJpbGl0aWVzLmNvZGVjcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIHZhciByQ29kZWMgPSByZW1vdGVDYXBhYmlsaXRpZXMuY29kZWNzW2ldOwogICAgICAgICAgICAgIGlmIChsQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpID09PSByQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpICYmCiAgICAgICAgICAgICAgICAgIGxDb2RlYy5jbG9ja1JhdGUgPT09IHJDb2RlYy5jbG9ja1JhdGUpIHsKICAgICAgICAgICAgICAgIC8vIG51bWJlciBvZiBjaGFubmVscyBpcyB0aGUgaGlnaGVzdCBjb21tb24gbnVtYmVyIG9mIGNoYW5uZWxzCiAgICAgICAgICAgICAgICByQ29kZWMubnVtQ2hhbm5lbHMgPSBNYXRoLm1pbihsQ29kZWMubnVtQ2hhbm5lbHMsCiAgICAgICAgICAgICAgICAgICAgckNvZGVjLm51bUNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIC8vIHB1c2ggckNvZGVjIHNvIHdlIHJlcGx5IHdpdGggb2ZmZXJlciBwYXlsb2FkIHR5cGUKICAgICAgICAgICAgICAgIGNvbW1vbkNhcGFiaWxpdGllcy5jb2RlY3MucHVzaChyQ29kZWMpOwoKICAgICAgICAgICAgICAgIC8vIGRldGVybWluZSBjb21tb24gZmVlZGJhY2sgbWVjaGFuaXNtcwogICAgICAgICAgICAgICAgckNvZGVjLnJ0Y3BGZWVkYmFjayA9IHJDb2RlYy5ydGNwRmVlZGJhY2suZmlsdGVyKGZ1bmN0aW9uKGZiKSB7CiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbENvZGVjLnJ0Y3BGZWVkYmFjay5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGlmIChsQ29kZWMucnRjcEZlZWRiYWNrW2pdLnR5cGUgPT09IGZiLnR5cGUgJiYKICAgICAgICAgICAgICAgICAgICAgICAgbENvZGVjLnJ0Y3BGZWVkYmFja1tqXS5wYXJhbWV0ZXIgPT09IGZiLnBhcmFtZXRlcikgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFsc28gbmVlZCB0byBkZXRlcm1pbmUgLnBhcmFtZXRlcnMKICAgICAgICAgICAgICAgIC8vICBzZWUgaHR0cHM6Ly9naXRodWIuY29tL29wZW5wZWVyL29ydGMvaXNzdWVzLzU2OQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zCiAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obEhlYWRlckV4dGVuc2lvbikgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZW1vdGVDYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9ucy5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgIGkrKykgewogICAgICAgICAgICAgICAgICB2YXIgckhlYWRlckV4dGVuc2lvbiA9IHJlbW90ZUNhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zW2ldOwogICAgICAgICAgICAgICAgICBpZiAobEhlYWRlckV4dGVuc2lvbi51cmkgPT09IHJIZWFkZXJFeHRlbnNpb24udXJpKSB7CiAgICAgICAgICAgICAgICAgICAgY29tbW9uQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMucHVzaChySGVhZGVyRXh0ZW5zaW9uKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgIC8vIEZJWE1FOiBmZWNNZWNoYW5pc21zCiAgICAgICAgICByZXR1cm4gY29tbW9uQ2FwYWJpbGl0aWVzOwogICAgICAgIH07CgogICAgLy8gQ3JlYXRlIElDRSBnYXRoZXJlciwgSUNFIHRyYW5zcG9ydCBhbmQgRFRMUyB0cmFuc3BvcnQuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyA9CiAgICAgICAgZnVuY3Rpb24obWlkLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgaWNlR2F0aGVyZXIgPSBuZXcgUlRDSWNlR2F0aGVyZXIoc2VsZi5pY2VPcHRpb25zKTsKICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSBuZXcgUlRDSWNlVHJhbnNwb3J0KGljZUdhdGhlcmVyKTsKICAgICAgICAgIGljZUdhdGhlcmVyLm9ubG9jYWxjYW5kaWRhdGUgPSBmdW5jdGlvbihldnQpIHsKICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKTsKICAgICAgICAgICAgZXZlbnQuY2FuZGlkYXRlID0ge3NkcE1pZDogbWlkLCBzZHBNTGluZUluZGV4OiBzZHBNTGluZUluZGV4fTsKCiAgICAgICAgICAgIHZhciBjYW5kID0gZXZ0LmNhbmRpZGF0ZTsKICAgICAgICAgICAgdmFyIGVuZCA9ICFjYW5kIHx8IE9iamVjdC5rZXlzKGNhbmQpLmxlbmd0aCA9PT0gMDsKICAgICAgICAgICAgLy8gRWRnZSBlbWl0cyBhbiBlbXB0eSBvYmplY3QgZm9yIFJUQ0ljZUNhbmRpZGF0ZUNvbXBsZXRl4oClCiAgICAgICAgICAgIGlmIChlbmQpIHsKICAgICAgICAgICAgICAvLyBwb2x5ZmlsbCBzaW5jZSBSVENJY2VHYXRoZXJlci5zdGF0ZSBpcyBub3QgaW1wbGVtZW50ZWQgaW4KICAgICAgICAgICAgICAvLyBFZGdlIDEwNTQ3IHlldC4KICAgICAgICAgICAgICBpZiAoaWNlR2F0aGVyZXIuc3RhdGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgaWNlR2F0aGVyZXIuc3RhdGUgPSAnY29tcGxldGVkJzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gUlRDSWNlQ2FuZGlkYXRlIGRvZXNuJ3QgaGF2ZSBhIGNvbXBvbmVudCwgbmVlZHMgdG8gYmUgYWRkZWQKICAgICAgICAgICAgICBjYW5kLmNvbXBvbmVudCA9IGljZVRyYW5zcG9ydC5jb21wb25lbnQgPT09ICdSVENQJyA/IDIgOiAxOwogICAgICAgICAgICAgIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgPSBTRFBVdGlscy53cml0ZUNhbmRpZGF0ZShjYW5kKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdXBkYXRlIGxvY2FsIGRlc2NyaXB0aW9uLgogICAgICAgICAgICB2YXIgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHApOwogICAgICAgICAgICBpZiAoIWVuZCkgewogICAgICAgICAgICAgIHNlY3Rpb25zW2V2ZW50LmNhbmRpZGF0ZS5zZHBNTGluZUluZGV4ICsgMV0gKz0KICAgICAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbZXZlbnQuY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXggKyAxXSArPQogICAgICAgICAgICAgICAgICAnYT1lbmQtb2YtY2FuZGlkYXRlc1xyXG4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IHNlbGYuX3BlbmRpbmdPZmZlciA/IHNlbGYuX3BlbmRpbmdPZmZlciA6CiAgICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyczsKICAgICAgICAgICAgdmFyIGNvbXBsZXRlID0gdHJhbnNjZWl2ZXJzLmV2ZXJ5KGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLnN0YXRlID09PSAnY29tcGxldGVkJzsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBFbWl0IGNhbmRpZGF0ZSBpZiBsb2NhbERlc2NyaXB0aW9uIGlzIHNldC4KICAgICAgICAgICAgLy8gQWxzbyBlbWl0cyBudWxsIGNhbmRpZGF0ZSB3aGVuIGFsbCBnYXRoZXJlcnMgYXJlIGNvbXBsZXRlLgogICAgICAgICAgICBzd2l0Y2ggKHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUpIHsKICAgICAgICAgICAgICBjYXNlICduZXcnOgogICAgICAgICAgICAgICAgaWYgKCFlbmQpIHsKICAgICAgICAgICAgICAgICAgc2VsZi5fbG9jYWxJY2VDYW5kaWRhdGVzQnVmZmVyLnB1c2goZXZlbnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGVuZCAmJiBjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIucHVzaCgKICAgICAgICAgICAgICAgICAgICAgIG5ldyBFdmVudCgnaWNlY2FuZGlkYXRlJykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAnZ2F0aGVyaW5nJzoKICAgICAgICAgICAgICAgIHNlbGYuX2VtaXRCdWZmZXJlZENhbmRpZGF0ZXMoKTsKICAgICAgICAgICAgICAgIGlmICghZW5kKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShldmVudCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKSk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShuZXcgRXZlbnQoJ2ljZWNhbmRpZGF0ZScpKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBzZWxmLmljZUdhdGhlcmluZ1N0YXRlID0gJ2NvbXBsZXRlJzsKICAgICAgICAgICAgICAgICAgc2VsZi5fZW1pdEdhdGhlcmluZ1N0YXRlQ2hhbmdlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlICdjb21wbGV0ZSc6CiAgICAgICAgICAgICAgICAvLyBzaG91bGQgbm90IGhhcHBlbi4uLiBjdXJyZW50bHkhCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBkZWZhdWx0OiAvLyBuby1vcC4KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgaWNlVHJhbnNwb3J0Lm9uaWNlc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHZhciBkdGxzVHJhbnNwb3J0ID0gbmV3IFJUQ0R0bHNUcmFuc3BvcnQoaWNlVHJhbnNwb3J0KTsKICAgICAgICAgIGR0bHNUcmFuc3BvcnQub25kdGxzc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwogICAgICAgICAgZHRsc1RyYW5zcG9ydC5vbmVycm9yID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIC8vIG9uZXJyb3IgZG9lcyBub3Qgc2V0IHN0YXRlIHRvIGZhaWxlZCBieSBpdHNlbGYuCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQuc3RhdGUgPSAnZmFpbGVkJzsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGljZUdhdGhlcmVyOiBpY2VHYXRoZXJlciwKICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiBpY2VUcmFuc3BvcnQsCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IGR0bHNUcmFuc3BvcnQKICAgICAgICAgIH07CiAgICAgICAgfTsKCiAgICAvLyBTdGFydCB0aGUgUlRQIFNlbmRlciBhbmQgUmVjZWl2ZXIgZm9yIGEgdHJhbnNjZWl2ZXIuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl90cmFuc2NlaXZlID0gZnVuY3Rpb24odHJhbnNjZWl2ZXIsCiAgICAgICAgc2VuZCwgcmVjdikgewogICAgICB2YXIgcGFyYW1zID0gdGhpcy5fZ2V0Q29tbW9uQ2FwYWJpbGl0aWVzKHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLAogICAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzKTsKICAgICAgaWYgKHNlbmQgJiYgdHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgcGFyYW1zLmVuY29kaW5ncyA9IHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgcGFyYW1zLnJ0Y3AgPSB7CiAgICAgICAgICBjbmFtZTogU0RQVXRpbHMubG9jYWxDTmFtZQogICAgICAgIH07CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLnJlY3ZFbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoKSB7CiAgICAgICAgICBwYXJhbXMucnRjcC5zc3JjID0gdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjOwogICAgICAgIH0KICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc2VuZChwYXJhbXMpOwogICAgICB9CiAgICAgIGlmIChyZWN2ICYmIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyKSB7CiAgICAgICAgLy8gcmVtb3ZlIFJUWCBmaWVsZCBpbiBFZGdlIDE0OTQyCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmtpbmQgPT09ICd2aWRlbycKICAgICAgICAgICAgJiYgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycykgewogICAgICAgICAgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHApIHsKICAgICAgICAgICAgZGVsZXRlIHAucnR4OwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHBhcmFtcy5lbmNvZGluZ3MgPSB0cmFuc2NlaXZlci5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgIHBhcmFtcy5ydGNwID0gewogICAgICAgICAgY25hbWU6IHRyYW5zY2VpdmVyLmNuYW1lCiAgICAgICAgfTsKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycy5sZW5ndGgpIHsKICAgICAgICAgIHBhcmFtcy5ydGNwLnNzcmMgPSB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmM7CiAgICAgICAgfQogICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnJlY2VpdmUocGFyYW1zKTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb24gPQogICAgICAgIGZ1bmN0aW9uKGRlc2NyaXB0aW9uKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgc2VjdGlvbnM7CiAgICAgICAgICB2YXIgc2Vzc2lvbnBhcnQ7CiAgICAgICAgICBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ29mZmVyJykgewogICAgICAgICAgICAvLyBGSVhNRTogV2hhdCB3YXMgdGhlIHB1cnBvc2Ugb2YgdGhpcyBlbXB0eSBpZiBzdGF0ZW1lbnQ/CiAgICAgICAgICAgIC8vIGlmICghdGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgICAgIC8vIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nT2ZmZXIpIHsKICAgICAgICAgICAgICAvLyBWRVJZIGxpbWl0ZWQgc3VwcG9ydCBmb3IgU0RQIG11bmdpbmcuIExpbWl0ZWQgdG86CiAgICAgICAgICAgICAgLy8gKiBjaGFuZ2luZyB0aGUgb3JkZXIgb2YgY29kZWNzCiAgICAgICAgICAgICAgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKGRlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQgPSBzZWN0aW9ucy5zaGlmdCgpOwogICAgICAgICAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICAgICAgICB2YXIgY2FwcyA9IFNEUFV0aWxzLnBhcnNlUnRwUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICAgICAgc2VsZi5fcGVuZGluZ09mZmVyW3NkcE1MaW5lSW5kZXhdLmxvY2FsQ2FwYWJpbGl0aWVzID0gY2FwczsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0aGlzLnRyYW5zY2VpdmVycyA9IHRoaXMuX3BlbmRpbmdPZmZlcjsKICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcGVuZGluZ09mZmVyOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgICAgIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgIHNlc3Npb25wYXJ0ID0gc2VjdGlvbnMuc2hpZnQoKTsKICAgICAgICAgICAgdmFyIGlzSWNlTGl0ZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgICBzZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKG1lZGlhU2VjdGlvbiwgc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQ7CiAgICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0OwogICAgICAgICAgICAgIHZhciBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwogICAgICAgICAgICAgIHZhciByZW1vdGVDYXBhYmlsaXRpZXMgPSB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IG1lZGlhU2VjdGlvbi5zcGxpdCgnXG4nLCAxKVswXQogICAgICAgICAgICAgICAgICAuc3BsaXQoJyAnLCAyKVsxXSA9PT0gJzAnOwoKICAgICAgICAgICAgICBpZiAoIXJlamVjdGVkICYmICF0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSWNlUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldEljZVBhcmFtZXRlcnMoCiAgICAgICAgICAgICAgICAgICAgbWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCk7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnMgPSBTRFBVdGlscy5nZXREdGxzUGFyYW1ldGVycygKICAgICAgICAgICAgICAgICAgICBtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICAgIGlmIChpc0ljZUxpdGUpIHsKICAgICAgICAgICAgICAgICAgcmVtb3RlRHRsc1BhcmFtZXRlcnMucm9sZSA9ICdzZXJ2ZXInOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydC5zdGFydChpY2VHYXRoZXJlciwgcmVtb3RlSWNlUGFyYW1ldGVycywKICAgICAgICAgICAgICAgICAgICAgIGlzSWNlTGl0ZSA/ICdjb250cm9sbGluZycgOiAnY29udHJvbGxlZCcpOwogICAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgaW50ZXJzZWN0aW9uIG9mIGNhcGFiaWxpdGllcy4KICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSBzZWxmLl9nZXRDb21tb25DYXBhYmlsaXRpZXMobG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgICAgICAgICAgcmVtb3RlQ2FwYWJpbGl0aWVzKTsKCiAgICAgICAgICAgICAgICAvLyBTdGFydCB0aGUgUlRDUnRwU2VuZGVyLiBUaGUgUlRDUnRwUmVjZWl2ZXIgZm9yIHRoaXMKICAgICAgICAgICAgICAgIC8vIHRyYW5zY2VpdmVyIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBpbiBzZXRSZW1vdGVEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmNvZGVjcy5sZW5ndGggPiAwLAogICAgICAgICAgICAgICAgICAgIGZhbHNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMubG9jYWxEZXNjcmlwdGlvbiA9IHsKICAgICAgICAgICAgdHlwZTogZGVzY3JpcHRpb24udHlwZSwKICAgICAgICAgICAgc2RwOiBkZXNjcmlwdGlvbi5zZHAKICAgICAgICAgIH07CiAgICAgICAgICBzd2l0Y2ggKGRlc2NyaXB0aW9uLnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAnb2ZmZXInOgogICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdoYXZlLWxvY2FsLW9mZmVyJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2Fuc3dlcic6CiAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ3N0YWJsZScpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3Vuc3VwcG9ydGVkIHR5cGUgIicgKyBkZXNjcmlwdGlvbi50eXBlICsKICAgICAgICAgICAgICAgICAgJyInKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBJZiBhIHN1Y2Nlc3MgY2FsbGJhY2sgd2FzIHByb3ZpZGVkLCBlbWl0IElDRSBjYW5kaWRhdGVzIGFmdGVyIGl0CiAgICAgICAgICAvLyBoYXMgYmVlbiBleGVjdXRlZC4gT3RoZXJ3aXNlLCBlbWl0IGNhbGxiYWNrIGFmdGVyIHRoZSBQcm9taXNlIGlzCiAgICAgICAgICAvLyByZXNvbHZlZC4KICAgICAgICAgIHZhciBoYXNDYWxsYmFjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmCiAgICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbic7CiAgICAgICAgICBpZiAoaGFzQ2FsbGJhY2spIHsKICAgICAgICAgICAgdmFyIGNiID0gYXJndW1lbnRzWzFdOwogICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICBjYigpOwogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBzZWxmLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzKCk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHAgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICAgIHAudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgaWYgKCFoYXNDYWxsYmFjaykgewogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBVc3VhbGx5IGNhbmRpZGF0ZXMgd2lsbCBiZSBlbWl0dGVkIGVhcmxpZXIuCiAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoc2VsZi5fZW1pdEJ1ZmZlcmVkQ2FuZGlkYXRlcy5iaW5kKHNlbGYpLCA1MDApOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBwOwogICAgICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbiA9CiAgICAgICAgZnVuY3Rpb24oZGVzY3JpcHRpb24pIHsKICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgIHZhciBzdHJlYW0gPSBuZXcgTWVkaWFTdHJlYW0oKTsKICAgICAgICAgIHZhciByZWNlaXZlckxpc3QgPSBbXTsKICAgICAgICAgIHZhciBzZWN0aW9ucyA9IFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMoZGVzY3JpcHRpb24uc2RwKTsKICAgICAgICAgIHZhciBzZXNzaW9ucGFydCA9IHNlY3Rpb25zLnNoaWZ0KCk7CiAgICAgICAgICB2YXIgaXNJY2VMaXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoc2Vzc2lvbnBhcnQsCiAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgdGhpcy51c2luZ0J1bmRsZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICdhPWdyb3VwOkJVTkRMRSAnKS5sZW5ndGggPiAwOwogICAgICAgICAgc2VjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNkcE1MaW5lSW5kZXgpIHsKICAgICAgICAgICAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICB2YXIgbWxpbmUgPSBsaW5lc1swXS5zdWJzdHIoMikuc3BsaXQoJyAnKTsKICAgICAgICAgICAgdmFyIGtpbmQgPSBtbGluZVswXTsKICAgICAgICAgICAgdmFyIHJlamVjdGVkID0gbWxpbmVbMV0gPT09ICcwJzsKICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IFNEUFV0aWxzLmdldERpcmVjdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKCiAgICAgICAgICAgIHZhciBtaWQgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPW1pZDonKTsKICAgICAgICAgICAgaWYgKG1pZC5sZW5ndGgpIHsKICAgICAgICAgICAgICBtaWQgPSBtaWRbMF0uc3Vic3RyKDYpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG1pZCA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBSZWplY3QgZGF0YWNoYW5uZWxzIHdoaWNoIGFyZSBub3QgaW1wbGVtZW50ZWQgeWV0LgogICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2FwcGxpY2F0aW9uJyAmJiBtbGluZVsyXSA9PT0gJ0RUTFMvU0NUUCcpIHsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIG1pZDogbWlkLAogICAgICAgICAgICAgICAgaXNEYXRhY2hhbm5lbDogdHJ1ZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgdHJhbnNjZWl2ZXI7CiAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlcjsKICAgICAgICAgICAgdmFyIGljZVRyYW5zcG9ydDsKICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQ7CiAgICAgICAgICAgIHZhciBydHBTZW5kZXI7CiAgICAgICAgICAgIHZhciBydHBSZWNlaXZlcjsKICAgICAgICAgICAgdmFyIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgICAgIHZhciByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICB2YXIgdHJhY2s7CiAgICAgICAgICAgIC8vIEZJWE1FOiBlbnN1cmUgdGhlIG1lZGlhU2VjdGlvbiBoYXMgcnRjcC1tdXggc2V0LgogICAgICAgICAgICB2YXIgcmVtb3RlQ2FwYWJpbGl0aWVzID0gU0RQVXRpbHMucGFyc2VSdHBQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CiAgICAgICAgICAgIHZhciByZW1vdGVJY2VQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnM7CiAgICAgICAgICAgIGlmICghcmVqZWN0ZWQpIHsKICAgICAgICAgICAgICByZW1vdGVJY2VQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0SWNlUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24sCiAgICAgICAgICAgICAgICAgIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICByZW1vdGVEdGxzUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbiwKICAgICAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQpOwogICAgICAgICAgICAgIHJlbW90ZUR0bHNQYXJhbWV0ZXJzLnJvbGUgPSAnY2xpZW50JzsKICAgICAgICAgICAgfQogICAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgIFNEUFV0aWxzLnBhcnNlUnRwRW5jb2RpbmdQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CgogICAgICAgICAgICB2YXIgY25hbWU7CiAgICAgICAgICAgIC8vIEdldHMgdGhlIGZpcnN0IFNTUkMuIE5vdGUgdGhhdCB3aXRoIFJUWCB0aGVyZSBtaWdodCBiZSBtdWx0aXBsZQogICAgICAgICAgICAvLyBTU1JDcy4KICAgICAgICAgICAgdmFyIHJlbW90ZVNzcmMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNzcmM6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24obGluZSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihvYmopIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iai5hdHRyaWJ1dGUgPT09ICdjbmFtZSc7CiAgICAgICAgICAgICAgICB9KVswXTsKICAgICAgICAgICAgaWYgKHJlbW90ZVNzcmMpIHsKICAgICAgICAgICAgICBjbmFtZSA9IHJlbW90ZVNzcmMudmFsdWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBpc0NvbXBsZXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLAogICAgICAgICAgICAgICAgJ2E9ZW5kLW9mLWNhbmRpZGF0ZXMnLCBzZXNzaW9ucGFydCkubGVuZ3RoID4gMDsKICAgICAgICAgICAgdmFyIGNhbmRzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1jYW5kaWRhdGU6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24oY2FuZCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUoY2FuZCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihjYW5kKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBjYW5kLmNvbXBvbmVudCA9PT0gJzEnOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInICYmICFyZWplY3RlZCkgewogICAgICAgICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiBzZWxmLnRyYW5zY2VpdmVyc1swXS5pY2VHYXRoZXJlciwKICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uaWNlVHJhbnNwb3J0LAogICAgICAgICAgICAgICAgZHRsc1RyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICAgICAgICBpZiAoaXNDb21wbGV0ZSAmJiAoIXNlbGYudXNpbmdCdW5kbGUgfHwgc2RwTUxpbmVJbmRleCA9PT0gMCkpIHsKICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuaWNlVHJhbnNwb3J0LnNldFJlbW90ZUNhbmRpZGF0ZXMoY2FuZHMpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBSZWNlaXZlci5nZXRDYXBhYmlsaXRpZXMoa2luZCk7CgogICAgICAgICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMgPSBbewogICAgICAgICAgICAgICAgc3NyYzogKDIgKiBzZHBNTGluZUluZGV4ICsgMikgKiAxMDAxCiAgICAgICAgICAgICAgfV07CgogICAgICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CgogICAgICAgICAgICAgIHRyYWNrID0gcnRwUmVjZWl2ZXIudHJhY2s7CiAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgIC8vIEZJWE1FOiBub3QgY29ycmVjdCB3aGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBzdHJlYW1zIGJ1dCB0aGF0IGlzCiAgICAgICAgICAgICAgLy8gbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgaW4gdGhpcyBzaGltLgogICAgICAgICAgICAgIHN0cmVhbS5hZGRUcmFjayh0cmFjayk7CgogICAgICAgICAgICAgIC8vIEZJWE1FOiBsb29rIGF0IGRpcmVjdGlvbi4KICAgICAgICAgICAgICBpZiAoc2VsZi5sb2NhbFN0cmVhbXMubGVuZ3RoID4gMCAmJgogICAgICAgICAgICAgICAgICBzZWxmLmxvY2FsU3RyZWFtc1swXS5nZXRUcmFja3MoKS5sZW5ndGggPj0gc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgICAgdmFyIGxvY2FsVHJhY2s7CiAgICAgICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0QXVkaW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2luZCA9PT0gJ3ZpZGVvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0VmlkZW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChsb2NhbFRyYWNrKSB7CiAgICAgICAgICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIobG9jYWxUcmFjaywKICAgICAgICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc3BvcnRzLmljZUdhdGhlcmVyLAogICAgICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmljZVRyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzOiBsb2NhbENhcGFiaWxpdGllcywKICAgICAgICAgICAgICAgIHJlbW90ZUNhcGFiaWxpdGllczogcmVtb3RlQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAgICAgcnRwU2VuZGVyOiBydHBTZW5kZXIsCiAgICAgICAgICAgICAgICBydHBSZWNlaXZlcjogcnRwUmVjZWl2ZXIsCiAgICAgICAgICAgICAgICBraW5kOiBraW5kLAogICAgICAgICAgICAgICAgbWlkOiBtaWQsCiAgICAgICAgICAgICAgICBjbmFtZTogY25hbWUsCiAgICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzOiBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzLAogICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczogcmVjdkVuY29kaW5nUGFyYW1ldGVycwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgLy8gU3RhcnQgdGhlIFJUQ1J0cFJlY2VpdmVyIG5vdy4gVGhlIFJUUFNlbmRlciBpcyBzdGFydGVkIGluCiAgICAgICAgICAgICAgLy8gc2V0TG9jYWxEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICBzZWxmLl90cmFuc2NlaXZlKHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLAogICAgICAgICAgICAgICAgICBmYWxzZSwKICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uID09PSAnc2VuZHJlY3YnIHx8IGRpcmVjdGlvbiA9PT0gJ3NlbmRvbmx5Jyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ2Fuc3dlcicgJiYgIXJlamVjdGVkKSB7CiAgICAgICAgICAgICAgdHJhbnNjZWl2ZXIgPSBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XTsKICAgICAgICAgICAgICBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIGljZVRyYW5zcG9ydCA9IHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydDsKICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0ID0gdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydDsKICAgICAgICAgICAgICBydHBTZW5kZXIgPSB0cmFuc2NlaXZlci5ydHBTZW5kZXI7CiAgICAgICAgICAgICAgcnRwUmVjZWl2ZXIgPSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzID0gdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZW1vdGVDYXBhYmlsaXRpZXMgPQogICAgICAgICAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM7CiAgICAgICAgICAgICAgc2VsZi50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uY25hbWUgPSBjbmFtZTsKCiAgICAgICAgICAgICAgaWYgKChpc0ljZUxpdGUgfHwgaXNDb21wbGV0ZSkgJiYgY2FuZHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc2V0UmVtb3RlQ2FuZGlkYXRlcyhjYW5kcyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc3RhcnQoaWNlR2F0aGVyZXIsIHJlbW90ZUljZVBhcmFtZXRlcnMsCiAgICAgICAgICAgICAgICAgICAgJ2NvbnRyb2xsaW5nJyk7CiAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdyZWN2b25seScsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpOwoKICAgICAgICAgICAgICBpZiAocnRwUmVjZWl2ZXIgJiYKICAgICAgICAgICAgICAgICAgKGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpKSB7CiAgICAgICAgICAgICAgICB0cmFjayA9IHJ0cFJlY2VpdmVyLnRyYWNrOwogICAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgICAgc3RyZWFtLmFkZFRyYWNrKHRyYWNrKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFjdHVhbGx5IHRoZSByZWNlaXZlciBzaG91bGQgYmUgY3JlYXRlZCBsYXRlci4KICAgICAgICAgICAgICAgIGRlbGV0ZSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIHRoaXMucmVtb3RlRGVzY3JpcHRpb24gPSB7CiAgICAgICAgICAgIHR5cGU6IGRlc2NyaXB0aW9uLnR5cGUsCiAgICAgICAgICAgIHNkcDogZGVzY3JpcHRpb24uc2RwCiAgICAgICAgICB9OwogICAgICAgICAgc3dpdGNoIChkZXNjcmlwdGlvbi50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgJ29mZmVyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnaGF2ZS1yZW1vdGUtb2ZmZXInKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnYW5zd2VyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnc3RhYmxlJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigndW5zdXBwb3J0ZWQgdHlwZSAiJyArIGRlc2NyaXB0aW9uLnR5cGUgKwogICAgICAgICAgICAgICAgICAnIicpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHN0cmVhbS5nZXRUcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgICAgc2VsZi5yZW1vdGVTdHJlYW1zLnB1c2goc3RyZWFtKTsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdhZGRzdHJlYW0nKTsKICAgICAgICAgICAgICBldmVudC5zdHJlYW0gPSBzdHJlYW07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgICBpZiAoc2VsZi5vbmFkZHN0cmVhbSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYub25hZGRzdHJlYW0oZXZlbnQpOwogICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZWNlaXZlckxpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CiAgICAgICAgICAgICAgICB2YXIgdHJhY2sgPSBpdGVtWzBdOwogICAgICAgICAgICAgICAgdmFyIHJlY2VpdmVyID0gaXRlbVsxXTsKICAgICAgICAgICAgICAgIHZhciB0cmFja0V2ZW50ID0gbmV3IEV2ZW50KCd0cmFjaycpOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5yZWNlaXZlciA9IHJlY2VpdmVyOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5zdHJlYW1zID0gW3N0cmVhbV07CiAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQodHJhY2tFdmVudCk7CiAgICAgICAgICAgICAgICBpZiAoc2VsZi5vbnRyYWNrICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHNlbGYub250cmFjayh0cmFja0V2ZW50KTsKICAgICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoYXJndW1lbnRzWzFdLCAwKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIC8qIG5vdCB5ZXQKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgICovCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCkgewogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0b3AoKTsKICAgICAgICB9CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBGSVhNRTogY2xlYW4gdXAgdHJhY2tzLCBsb2NhbCBzdHJlYW1zLCByZW1vdGUgc3RyZWFtcywgZXRjCiAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdjbG9zZWQnKTsKICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBzaWduYWxpbmcgc3RhdGUuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl91cGRhdGVTaWduYWxpbmdTdGF0ZSA9CiAgICAgICAgZnVuY3Rpb24obmV3U3RhdGUpIHsKICAgICAgICAgIHRoaXMuc2lnbmFsaW5nU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnc2lnbmFsaW5nc3RhdGVjaGFuZ2UnKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICBpZiAodGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHRoaXMub25zaWduYWxpbmdzdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAvLyBEZXRlcm1pbmUgd2hldGhlciB0byBmaXJlIHRoZSBuZWdvdGlhdGlvbm5lZWRlZCBldmVudC4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX21heWJlRmlyZU5lZ290aWF0aW9uTmVlZGVkID0KICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgIC8vIEZpcmUgYXdheSAoZm9yIG5vdykuCiAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ25lZ290aWF0aW9ubmVlZGVkJyk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgICAgaWYgKHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCAhPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLm9ubmVnb3RpYXRpb25uZWVkZWQoZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBjb25uZWN0aW9uIHN0YXRlLgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fdXBkYXRlQ29ubmVjdGlvblN0YXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIG5ld1N0YXRlOwogICAgICB2YXIgc3RhdGVzID0gewogICAgICAgICduZXcnOiAwLAogICAgICAgIGNsb3NlZDogMCwKICAgICAgICBjb25uZWN0aW5nOiAwLAogICAgICAgIGNoZWNraW5nOiAwLAogICAgICAgIGNvbm5lY3RlZDogMCwKICAgICAgICBjb21wbGV0ZWQ6IDAsCiAgICAgICAgZmFpbGVkOiAwCiAgICAgIH07CiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICBzdGF0ZXNbdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICAgIHN0YXRlc1t0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICB9KTsKICAgICAgLy8gSUNFVHJhbnNwb3J0LmNvbXBsZXRlZCBhbmQgY29ubmVjdGVkIGFyZSB0aGUgc2FtZSBmb3IgdGhpcyBwdXJwb3NlLgogICAgICBzdGF0ZXMuY29ubmVjdGVkICs9IHN0YXRlcy5jb21wbGV0ZWQ7CgogICAgICBuZXdTdGF0ZSA9ICduZXcnOwogICAgICBpZiAoc3RhdGVzLmZhaWxlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdmYWlsZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5jb25uZWN0aW5nID4gMCB8fCBzdGF0ZXMuY2hlY2tpbmcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnY29ubmVjdGluZyc7CiAgICAgIH0gZWxzZSBpZiAoc3RhdGVzLmRpc2Nvbm5lY3RlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdkaXNjb25uZWN0ZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5uZXcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnbmV3JzsKICAgICAgfSBlbHNlIGlmIChzdGF0ZXMuY29ubmVjdGVkID4gMCB8fCBzdGF0ZXMuY29tcGxldGVkID4gMCkgewogICAgICAgIG5ld1N0YXRlID0gJ2Nvbm5lY3RlZCc7CiAgICAgIH0KCiAgICAgIGlmIChuZXdTdGF0ZSAhPT0gc2VsZi5pY2VDb25uZWN0aW9uU3RhdGUpIHsKICAgICAgICBzZWxmLmljZUNvbm5lY3Rpb25TdGF0ZSA9IG5ld1N0YXRlOwogICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlJyk7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICBpZiAodGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSAhPT0gbnVsbCkgewogICAgICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY3JlYXRlT2ZmZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAodGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjcmVhdGVPZmZlciBjYWxsZWQgd2hpbGUgdGhlcmUgaXMgYSBwZW5kaW5nIG9mZmVyLicpOwogICAgICB9CiAgICAgIHZhciBvZmZlck9wdGlvbnM7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpIHsKICAgICAgICBvZmZlck9wdGlvbnMgPSBhcmd1bWVudHNbMF07CiAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykgewogICAgICAgIG9mZmVyT3B0aW9ucyA9IGFyZ3VtZW50c1syXTsKICAgICAgfQoKICAgICAgdmFyIHRyYWNrcyA9IFtdOwogICAgICB2YXIgbnVtQXVkaW9UcmFja3MgPSAwOwogICAgICB2YXIgbnVtVmlkZW9UcmFja3MgPSAwOwogICAgICAvLyBEZWZhdWx0IHRvIHNlbmRyZWN2LgogICAgICBpZiAodGhpcy5sb2NhbFN0cmVhbXMubGVuZ3RoKSB7CiAgICAgICAgbnVtQXVkaW9UcmFja3MgPSB0aGlzLmxvY2FsU3RyZWFtc1swXS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aDsKICAgICAgICBudW1WaWRlb1RyYWNrcyA9IHRoaXMubG9jYWxTdHJlYW1zWzBdLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoOwogICAgICB9CiAgICAgIC8vIERldGVybWluZSBudW1iZXIgb2YgYXVkaW8gYW5kIHZpZGVvIHRyYWNrcyB3ZSBuZWVkIHRvIHNlbmQvcmVjdi4KICAgICAgaWYgKG9mZmVyT3B0aW9ucykgewogICAgICAgIC8vIFJlamVjdCBDaHJvbWUgbGVnYWN5IGNvbnN0cmFpbnRzLgogICAgICAgIGlmIChvZmZlck9wdGlvbnMubWFuZGF0b3J5IHx8IG9mZmVyT3B0aW9ucy5vcHRpb25hbCkgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigKICAgICAgICAgICAgICAnTGVnYWN5IG1hbmRhdG9yeS9vcHRpb25hbCBjb25zdHJhaW50cyBub3Qgc3VwcG9ydGVkLicpOwogICAgICAgIH0KICAgICAgICBpZiAob2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgbnVtQXVkaW9UcmFja3MgPSBvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbzsKICAgICAgICB9CiAgICAgICAgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzID0gb2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlVmlkZW87CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmxvY2FsU3RyZWFtcy5sZW5ndGgpIHsKICAgICAgICAvLyBQdXNoIGxvY2FsIHN0cmVhbXMuCiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXNbMF0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiB0cmFjay5raW5kLAogICAgICAgICAgICB0cmFjazogdHJhY2ssCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cmFjay5raW5kID09PSAnYXVkaW8nID8KICAgICAgICAgICAgICAgIG51bUF1ZGlvVHJhY2tzID4gMCA6IG51bVZpZGVvVHJhY2tzID4gMAogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAodHJhY2sua2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgICAgfSBlbHNlIGlmICh0cmFjay5raW5kID09PSAndmlkZW8nKSB7CiAgICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgLy8gQ3JlYXRlIE0tbGluZXMgZm9yIHJlY3Zvbmx5IHN0cmVhbXMuCiAgICAgIHdoaWxlIChudW1BdWRpb1RyYWNrcyA+IDAgfHwgbnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgaWYgKG51bUF1ZGlvVHJhY2tzID4gMCkgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiAnYXVkaW8nLAogICAgICAgICAgICB3YW50UmVjZWl2ZTogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgIH0KICAgICAgICBpZiAobnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgICB0cmFja3MucHVzaCh7CiAgICAgICAgICAgIGtpbmQ6ICd2aWRlbycsCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUoKTsKICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IFtdOwogICAgICB0cmFja3MuZm9yRWFjaChmdW5jdGlvbihtbGluZSwgc2RwTUxpbmVJbmRleCkgewogICAgICAgIC8vIEZvciBlYWNoIHRyYWNrLCBjcmVhdGUgYW4gaWNlIGdhdGhlcmVyLCBpY2UgdHJhbnNwb3J0LAogICAgICAgIC8vIGR0bHMgdHJhbnNwb3J0LCBwb3RlbnRpYWxseSBydHBzZW5kZXIgYW5kIHJ0cHJlY2VpdmVyLgogICAgICAgIHZhciB0cmFjayA9IG1saW5lLnRyYWNrOwogICAgICAgIHZhciBraW5kID0gbWxpbmUua2luZDsKICAgICAgICB2YXIgbWlkID0gU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyKCk7CgogICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc2NlaXZlcnNbMF0uaWNlR2F0aGVyZXIsCiAgICAgICAgICBpY2VUcmFuc3BvcnQ6IHRyYW5zY2VpdmVyc1swXS5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBTZW5kZXIuZ2V0Q2FwYWJpbGl0aWVzKGtpbmQpOwogICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgfSk7CiAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgICAgICAgIC8vIHdvcmsgYXJvdW5kIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD02NTUyCiAgICAgICAgICAvLyBieSBhZGRpbmcgbGV2ZWwtYXN5bW1ldHJ5LWFsbG93ZWQ9MQogICAgICAgICAgaWYgKGNvZGVjLm5hbWUgPT09ICdIMjY0JyAmJgogICAgICAgICAgICAgIGNvZGVjLnBhcmFtZXRlcnNbJ2xldmVsLWFzeW1tZXRyeS1hbGxvd2VkJ10gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb2RlYy5wYXJhbWV0ZXJzWydsZXZlbC1hc3ltbWV0cnktYWxsb3dlZCddID0gJzEnOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICB2YXIgcnRwU2VuZGVyOwogICAgICAgIHZhciBydHBSZWNlaXZlcjsKCiAgICAgICAgLy8gZ2VuZXJhdGUgYW4gc3NyYyBub3csIHRvIGJlIHVzZWQgbGF0ZXIgaW4gcnRwU2VuZGVyLnNlbmQKICAgICAgICB2YXIgc2VuZEVuY29kaW5nUGFyYW1ldGVycyA9IFt7CiAgICAgICAgICBzc3JjOiAoMiAqIHNkcE1MaW5lSW5kZXggKyAxKSAqIDEwMDEKICAgICAgICB9XTsKICAgICAgICBpZiAodHJhY2spIHsKICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIodHJhY2ssIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgfQoKICAgICAgICBpZiAobWxpbmUud2FudFJlY2VpdmUpIHsKICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CiAgICAgICAgfQoKICAgICAgICB0cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0gPSB7CiAgICAgICAgICBpY2VHYXRoZXJlcjogdHJhbnNwb3J0cy5pY2VHYXRoZXJlciwKICAgICAgICAgIGljZVRyYW5zcG9ydDogdHJhbnNwb3J0cy5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmR0bHNUcmFuc3BvcnQsCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllczogbG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM6IG51bGwsCiAgICAgICAgICBydHBTZW5kZXI6IHJ0cFNlbmRlciwKICAgICAgICAgIHJ0cFJlY2VpdmVyOiBydHBSZWNlaXZlciwKICAgICAgICAgIGtpbmQ6IGtpbmQsCiAgICAgICAgICBtaWQ6IG1pZCwKICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM6IHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMsCiAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOiBudWxsCiAgICAgICAgfTsKICAgICAgfSk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdHJhbnNjZWl2ZXJzLm1hcChmdW5jdGlvbih0KSB7CiAgICAgICAgICByZXR1cm4gdC5taWQ7CiAgICAgICAgfSkuam9pbignICcpICsgJ1xyXG4nOwogICAgICB9CiAgICAgIHRyYWNrcy5mb3JFYWNoKGZ1bmN0aW9uKG1saW5lLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgdmFyIHRyYW5zY2VpdmVyID0gdHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsICdvZmZlcicsIHNlbGYubG9jYWxTdHJlYW1zWzBdKTsKICAgICAgfSk7CgogICAgICB0aGlzLl9wZW5kaW5nT2ZmZXIgPSB0cmFuc2NlaXZlcnM7CiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ29mZmVyJywKICAgICAgICBzZHA6IHNkcAogICAgICB9KTsKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGFyZ3VtZW50c1swXSwgMCwgZGVzYyk7CiAgICAgIH0KICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZXNjKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVBbnN3ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlU2Vzc2lvbkJvaWxlcnBsYXRlKCk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdGhpcy50cmFuc2NlaXZlcnMubWFwKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgIHJldHVybiB0Lm1pZDsKICAgICAgICB9KS5qb2luKCcgJykgKyAnXHJcbic7CiAgICAgIH0KICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIGlmICh0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICBzZHAgKz0gJ209YXBwbGljYXRpb24gMCBEVExTL1NDVFAgNTAwMFxyXG4nICsKICAgICAgICAgICAgICAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nICsKICAgICAgICAgICAgICAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gQ2FsY3VsYXRlIGludGVyc2VjdGlvbiBvZiBjYXBhYmlsaXRpZXMuCiAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHNlbGYuX2dldENvbW1vbkNhcGFiaWxpdGllcygKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgIHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcyk7CgogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwgY29tbW9uQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAnYW5zd2VyJywgc2VsZi5sb2NhbFN0cmVhbXNbMF0pOwogICAgICB9KTsKCiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ2Fuc3dlcicsCiAgICAgICAgc2RwOiBzZHAKICAgICAgfSk7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMF0sIDAsIGRlc2MpOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGVzYyk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oY2FuZGlkYXRlKSB7CiAgICAgIGlmICghY2FuZGlkYXRlKSB7CiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnRyYW5zY2VpdmVycy5sZW5ndGg7IGorKykgewogICAgICAgICAgdGhpcy50cmFuc2NlaXZlcnNbal0uaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZSh7fSk7CiAgICAgICAgICBpZiAodGhpcy51c2luZ0J1bmRsZSkgewogICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBtTGluZUluZGV4ID0gY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXg7CiAgICAgICAgaWYgKGNhbmRpZGF0ZS5zZHBNaWQpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFuc2NlaXZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNjZWl2ZXJzW2ldLm1pZCA9PT0gY2FuZGlkYXRlLnNkcE1pZCkgewogICAgICAgICAgICAgIG1MaW5lSW5kZXggPSBpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHRoaXMudHJhbnNjZWl2ZXJzW21MaW5lSW5kZXhdOwogICAgICAgIGlmICh0cmFuc2NlaXZlcikgewogICAgICAgICAgdmFyIGNhbmQgPSBPYmplY3Qua2V5cyhjYW5kaWRhdGUuY2FuZGlkYXRlKS5sZW5ndGggPiAwID8KICAgICAgICAgICAgICBTRFBVdGlscy5wYXJzZUNhbmRpZGF0ZShjYW5kaWRhdGUuY2FuZGlkYXRlKSA6IHt9OwogICAgICAgICAgLy8gSWdub3JlIENocm9tZSdzIGludmFsaWQgY2FuZGlkYXRlcyBzaW5jZSBFZGdlIGRvZXMgbm90IGxpa2UgdGhlbS4KICAgICAgICAgIGlmIChjYW5kLnByb3RvY29sID09PSAndGNwJyAmJiAoY2FuZC5wb3J0ID09PSAwIHx8IGNhbmQucG9ydCA9PT0gOSkpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgLy8gSWdub3JlIFJUQ1AgY2FuZGlkYXRlcywgd2UgYXNzdW1lIFJUQ1AtTVVYLgogICAgICAgICAgaWYgKGNhbmQuY29tcG9uZW50ICE9PSAnMScpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZShjYW5kKTsKCiAgICAgICAgICAvLyB1cGRhdGUgdGhlIHJlbW90ZURlc2NyaXB0aW9uLgogICAgICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyh0aGlzLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICBzZWN0aW9uc1ttTGluZUluZGV4ICsgMV0gKz0gKGNhbmQudHlwZSA/IGNhbmRpZGF0ZS5jYW5kaWRhdGUudHJpbSgpCiAgICAgICAgICAgICAgOiAnYT1lbmQtb2YtY2FuZGlkYXRlcycpICsgJ1xyXG4nOwogICAgICAgICAgdGhpcy5yZW1vdGVEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMV0sIDApOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcHJvbWlzZXMgPSBbXTsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIFsncnRwU2VuZGVyJywgJ3J0cFJlY2VpdmVyJywgJ2ljZUdhdGhlcmVyJywgJ2ljZVRyYW5zcG9ydCcsCiAgICAgICAgICAgICdkdGxzVHJhbnNwb3J0J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgICBpZiAodHJhbnNjZWl2ZXJbbWV0aG9kXSkgewogICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0cmFuc2NlaXZlclttZXRob2RdLmdldFN0YXRzKCkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB2YXIgY2IgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnZnVuY3Rpb24nICYmCiAgICAgICAgICBhcmd1bWVudHNbMV07CiAgICAgIHZhciBmaXhTdGF0c1R5cGUgPSBmdW5jdGlvbihzdGF0KSB7CiAgICAgICAgc3RhdC50eXBlID0gewogICAgICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgICAgIG91dGJvdW5kcnRwOiAnb3V0Ym91bmQtcnRwJywKICAgICAgICAgIGNhbmRpZGF0ZXBhaXI6ICdjYW5kaWRhdGUtcGFpcicsCiAgICAgICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgIH1bc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgcmV0dXJuIHN0YXQ7CiAgICAgIH07CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICAgIHZhciByZXN1bHRzID0gbmV3IE1hcCgpOwogICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKHJlcykgewogICAgICAgICAgcmVzLmZvckVhY2goZnVuY3Rpb24ocmVzdWx0KSB7CiAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlc3VsdCkuZm9yRWFjaChmdW5jdGlvbihpZCkgewogICAgICAgICAgICAgIHJlc3VsdFtpZF0udHlwZSA9IGZpeFN0YXRzVHlwZShyZXN1bHRbaWRdKTsKICAgICAgICAgICAgICByZXN1bHRzLnNldChpZCwgcmVzdWx0W2lkXSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoY2IpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoY2IsIDAsIHJlc3VsdHMpOwogICAgICAgICAgfQogICAgICAgICAgcmVzb2x2ZShyZXN1bHRzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KfTsKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbVBlZXJDb25uZWN0aW9uOiBlZGdlU2hpbS5zaGltUGVlckNvbm5lY3Rpb24sCiAgc2hpbUdldFVzZXJNZWRpYTogcmVxdWlyZSgnLi9nZXR1c2VybWVkaWEnKQp9OwoKfSx7Ii4uL3V0aWxzIjoxMSwiLi9nZXR1c2VybWVkaWEiOjcsInNkcCI6MX1dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7UGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJ31bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50LAogICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTsKICAgICAgfQogICAgfTsKICB9OwoKICAvLyBnZXRVc2VyTWVkaWEgZXJyb3Igc2hpbS4KICB2YXIgb3JpZ0dldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhLgogICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oYykgewogICAgcmV0dXJuIG9yaWdHZXRVc2VyTWVkaWEoYykuY2F0Y2goZnVuY3Rpb24oZSkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3Qoc2hpbUVycm9yXyhlKSk7CiAgICB9KTsKICB9Owp9OwoKfSx7fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgZmlyZWZveFNoaW0gPSB7CiAgc2hpbU9uVHJhY2s6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnICYmIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiAmJiAhKCdvbnRyYWNrJyBpbgogICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnb250cmFjaycsIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX29udHJhY2s7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKGYpIHsKICAgICAgICAgIGlmICh0aGlzLl9vbnRyYWNrKSB7CiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrKTsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgdGhpcy5fb250cmFjayA9IGYpOwogICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgZS5zdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTsKICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAoKICBzaGltU291cmNlT2JqZWN0OiBmdW5jdGlvbigpIHsKICAgIC8vIEZpcmVmb3ggaGFzIHN1cHBvcnRlZCBtb3pTcmNPYmplY3Qgc2luY2UgRkYyMiwgdW5wcmVmaXhlZCBpbiA0Mi4KICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgewogICAgICBpZiAod2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAhKCdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgICAvLyBTaGltIHRoZSBzcmNPYmplY3QgcHJvcGVydHksIG9uY2UsIHdoZW4gSFRNTE1lZGlhRWxlbWVudCBpcyBmb3VuZC4KICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLCAnc3JjT2JqZWN0JywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMubW96U3JjT2JqZWN0OwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgICAgIHRoaXMubW96U3JjT2JqZWN0ID0gc3RyZWFtOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAnb2JqZWN0JyB8fCAhKHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiB8fAogICAgICAgIHdpbmRvdy5tb3pSVENQZWVyQ29ubmVjdGlvbikpIHsKICAgICAgcmV0dXJuOyAvLyBwcm9iYWJseSBtZWRpYS5wZWVyY29ubmVjdGlvbi5lbmFibGVkPWZhbHNlIGluIGFib3V0OmNvbmZpZwogICAgfQogICAgLy8gVGhlIFJUQ1BlZXJDb25uZWN0aW9uIG9iamVjdC4KICAgIGlmICghd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uKSB7CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiA9IGZ1bmN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKSB7CiAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICAgICAgLy8gLnVybHMgaXMgbm90IHN1cHBvcnRlZCBpbiBGRiA8IDM4LgogICAgICAgICAgLy8gY3JlYXRlIFJUQ0ljZVNlcnZlcnMgd2l0aCBhIHNpbmdsZSB1cmwuCiAgICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlU2VydmVycykgewogICAgICAgICAgICB2YXIgbmV3SWNlU2VydmVycyA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBjQ29uZmlnLmljZVNlcnZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICB2YXIgc2VydmVyID0gcGNDb25maWcuaWNlU2VydmVyc1tpXTsKICAgICAgICAgICAgICBpZiAoc2VydmVyLmhhc093blByb3BlcnR5KCd1cmxzJykpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VydmVyLnVybHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgdmFyIG5ld1NlcnZlciA9IHsKICAgICAgICAgICAgICAgICAgICB1cmw6IHNlcnZlci51cmxzW2pdCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIGlmIChzZXJ2ZXIudXJsc1tqXS5pbmRleE9mKCd0dXJuJykgPT09IDApIHsKICAgICAgICAgICAgICAgICAgICBuZXdTZXJ2ZXIudXNlcm5hbWUgPSBzZXJ2ZXIudXNlcm5hbWU7CiAgICAgICAgICAgICAgICAgICAgbmV3U2VydmVyLmNyZWRlbnRpYWwgPSBzZXJ2ZXIuY3JlZGVudGlhbDsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBuZXdJY2VTZXJ2ZXJzLnB1c2gobmV3U2VydmVyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV3SWNlU2VydmVycy5wdXNoKHBjQ29uZmlnLmljZVNlcnZlcnNbaV0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBwY0NvbmZpZy5pY2VTZXJ2ZXJzID0gbmV3SWNlU2VydmVyczsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBtb3pSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSBtb3pSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CgogICAgICAvLyB3cmFwIHN0YXRpYyBtZXRob2RzLiBDdXJyZW50bHkganVzdCBnZW5lcmF0ZUNlcnRpZmljYXRlLgogICAgICBpZiAobW96UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24sICdnZW5lcmF0ZUNlcnRpZmljYXRlJywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIG1velJUQ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24gPSBtb3pSVENTZXNzaW9uRGVzY3JpcHRpb247CiAgICAgIHdpbmRvdy5SVENJY2VDYW5kaWRhdGUgPSBtb3pSVENJY2VDYW5kaWRhdGU7CiAgICB9CgogICAgLy8gc2hpbSBhd2F5IG5lZWQgZm9yIG9ic29sZXRlIFJUQ0ljZUNhbmRpZGF0ZS9SVENTZXNzaW9uRGVzY3JpcHRpb24uCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgdmFyIG1ha2VNYXBTdGF0cyA9IGZ1bmN0aW9uKHN0YXRzKSB7CiAgICAgIHZhciBtYXAgPSBuZXcgTWFwKCk7CiAgICAgIE9iamVjdC5rZXlzKHN0YXRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIG1hcC5zZXQoa2V5LCBzdGF0c1trZXldKTsKICAgICAgICBtYXBba2V5XSA9IHN0YXRzW2tleV07CiAgICAgIH0pOwogICAgICByZXR1cm4gbWFwOwogICAgfTsKCiAgICB2YXIgbW9kZXJuU3RhdHNUeXBlcyA9IHsKICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgb3V0Ym91bmRydHA6ICdvdXRib3VuZC1ydHAnLAogICAgICBjYW5kaWRhdGVwYWlyOiAnY2FuZGlkYXRlLXBhaXInLAogICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgIHJlbW90ZWNhbmRpZGF0ZTogJ3JlbW90ZS1jYW5kaWRhdGUnCiAgICB9OwoKICAgIHZhciBuYXRpdmVHZXRTdGF0cyA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0czsKICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBvblN1Y2MsIG9uRXJyKSB7CiAgICAgIHJldHVybiBuYXRpdmVHZXRTdGF0cy5hcHBseSh0aGlzLCBbc2VsZWN0b3IgfHwgbnVsbF0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNDgpIHsKICAgICAgICAgICAgc3RhdHMgPSBtYWtlTWFwU3RhdHMoc3RhdHMpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MyAmJiAhb25TdWNjKSB7CiAgICAgICAgICAgIC8vIFNoaW0gb25seSBwcm9taXNlIGdldFN0YXRzIHdpdGggc3BlYy1oeXBoZW5zIGluIHR5cGUgbmFtZXMKICAgICAgICAgICAgLy8gTGVhdmUgY2FsbGJhY2sgdmVyc2lvbiBhbG9uZTsgbWlzYyBvbGQgdXNlcyBvZiBmb3JFYWNoIGJlZm9yZSBNYXAKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBzdGF0cy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXQpIHsKICAgICAgICAgICAgICAgIHN0YXQudHlwZSA9IG1vZGVyblN0YXRzVHlwZXNbc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICBpZiAoZS5uYW1lICE9PSAnVHlwZUVycm9yJykgewogICAgICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gQXZvaWQgVHlwZUVycm9yOiAidHlwZSIgaXMgcmVhZC1vbmx5LCBpbiBvbGQgdmVyc2lvbnMuIDM0LTQzaXNoCiAgICAgICAgICAgICAgc3RhdHMuZm9yRWFjaChmdW5jdGlvbihzdGF0LCBpKSB7CiAgICAgICAgICAgICAgICBzdGF0cy5zZXQoaSwgT2JqZWN0LmFzc2lnbih7fSwgc3RhdCwgewogICAgICAgICAgICAgICAgICB0eXBlOiBtb2Rlcm5TdGF0c1R5cGVzW3N0YXQudHlwZV0gfHwgc3RhdC50eXBlCiAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBzdGF0czsKICAgICAgICB9KQogICAgICAgIC50aGVuKG9uU3VjYywgb25FcnIpOwogICAgfTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1PblRyYWNrOiBmaXJlZm94U2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBmaXJlZm94U2hpbS5zaGltU291cmNlT2JqZWN0LAogIHNoaW1QZWVyQ29ubmVjdGlvbjogZmlyZWZveFNoaW0uc2hpbVBlZXJDb25uZWN0aW9uLAogIHNoaW1HZXRVc2VyTWVkaWE6IHJlcXVpcmUoJy4vZ2V0dXNlcm1lZGlhJykKfTsKCn0seyIuLi91dGlscyI6MTEsIi4vZ2V0dXNlcm1lZGlhIjo5fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7CiAgICAgICAgU2VjdXJpdHlFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgUGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJwogICAgICB9W2UubmFtZV0gfHwgZS5uYW1lLAogICAgICBtZXNzYWdlOiB7CiAgICAgICAgJ1RoZSBvcGVyYXRpb24gaXMgaW5zZWN1cmUuJzogJ1RoZSByZXF1ZXN0IGlzIG5vdCBhbGxvd2VkIGJ5IHRoZSAnICsKICAgICAgICAndXNlciBhZ2VudCBvciB0aGUgcGxhdGZvcm0gaW4gdGhlIGN1cnJlbnQgY29udGV4dC4nCiAgICAgIH1bZS5tZXNzYWdlXSB8fCBlLm1lc3NhZ2UsCiAgICAgIGNvbnN0cmFpbnQ6IGUuY29uc3RyYWludCwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIC8vIGdldFVzZXJNZWRpYSBjb25zdHJhaW50cyBzaGltLgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgdmFyIGNvbnN0cmFpbnRzVG9GRjM3XyA9IGZ1bmN0aW9uKGMpIHsKICAgICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLnJlcXVpcmUpIHsKICAgICAgICByZXR1cm4gYzsKICAgICAgfQogICAgICB2YXIgcmVxdWlyZSA9IFtdOwogICAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIGlmIChrZXkgPT09ICdyZXF1aXJlJyB8fCBrZXkgPT09ICdhZHZhbmNlZCcgfHwga2V5ID09PSAnbWVkaWFTb3VyY2UnKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciByID0gY1trZXldID0gKHR5cGVvZiBjW2tleV0gPT09ICdvYmplY3QnKSA/CiAgICAgICAgICAgIGNba2V5XSA6IHtpZGVhbDogY1trZXldfTsKICAgICAgICBpZiAoci5taW4gIT09IHVuZGVmaW5lZCB8fAogICAgICAgICAgICByLm1heCAhPT0gdW5kZWZpbmVkIHx8IHIuZXhhY3QgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmVxdWlyZS5wdXNoKGtleSk7CiAgICAgICAgfQogICAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmICh0eXBlb2Ygci5leGFjdCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgci4gbWluID0gci5tYXggPSByLmV4YWN0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY1trZXldID0gci5leGFjdDsKICAgICAgICAgIH0KICAgICAgICAgIGRlbGV0ZSByLmV4YWN0OwogICAgICAgIH0KICAgICAgICBpZiAoci5pZGVhbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBjLmFkdmFuY2VkID0gYy5hZHZhbmNlZCB8fCBbXTsKICAgICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgICAgaWYgKHR5cGVvZiByLmlkZWFsID09PSAnbnVtYmVyJykgewogICAgICAgICAgICBvY1trZXldID0ge21pbjogci5pZGVhbCwgbWF4OiByLmlkZWFsfTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9jW2tleV0gPSByLmlkZWFsOwogICAgICAgICAgfQogICAgICAgICAgYy5hZHZhbmNlZC5wdXNoKG9jKTsKICAgICAgICAgIGRlbGV0ZSByLmlkZWFsOwogICAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhyKS5sZW5ndGgpIHsKICAgICAgICAgICAgZGVsZXRlIGNba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAocmVxdWlyZS5sZW5ndGgpIHsKICAgICAgICBjLnJlcXVpcmUgPSByZXF1aXJlOwogICAgICB9CiAgICAgIHJldHVybiBjOwogICAgfTsKICAgIGNvbnN0cmFpbnRzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICBsb2dnaW5nKCdzcGVjOiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgICAgaWYgKGNvbnN0cmFpbnRzLmF1ZGlvKSB7CiAgICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvRkYzN18oY29uc3RyYWludHMuYXVkaW8pOwogICAgICB9CiAgICAgIGlmIChjb25zdHJhaW50cy52aWRlbykgewogICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0ZGMzdfKGNvbnN0cmFpbnRzLnZpZGVvKTsKICAgICAgfQogICAgICBsb2dnaW5nKCdmZjM3OiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgIH0KICAgIHJldHVybiBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzLCBvblN1Y2Nlc3MsIGZ1bmN0aW9uKGUpIHsKICAgICAgb25FcnJvcihzaGltRXJyb3JfKGUpKTsKICAgIH0pOwogIH07CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGdldFVzZXJNZWRpYV8oY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICAvLyBTaGltIGZvciBtZWRpYURldmljZXMgb24gb2xkZXIgdmVyc2lvbnMuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKSB7CiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzID0ge2dldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKCkgeyB9LAogICAgICByZW1vdmVFdmVudExpc3RlbmVyOiBmdW5jdGlvbigpIHsgfQogICAgfTsKICB9CiAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzID0KICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzIHx8IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIgaW5mb3MgPSBbCiAgICAgICAgICAgIHtraW5kOiAnYXVkaW9pbnB1dCcsIGRldmljZUlkOiAnZGVmYXVsdCcsIGxhYmVsOiAnJywgZ3JvdXBJZDogJyd9LAogICAgICAgICAgICB7a2luZDogJ3ZpZGVvaW5wdXQnLCBkZXZpY2VJZDogJ2RlZmF1bHQnLCBsYWJlbDogJycsIGdyb3VwSWQ6ICcnfQogICAgICAgICAgXTsKICAgICAgICAgIHJlc29sdmUoaW5mb3MpOwogICAgICAgIH0pOwogICAgICB9OwoKICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDQxKSB7CiAgICAvLyBXb3JrIGFyb3VuZCBodHRwOi8vYnVnemlsLmxhLzExNjk2NjUKICAgIHZhciBvcmdFbnVtZXJhdGVEZXZpY2VzID0KICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMuYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gb3JnRW51bWVyYXRlRGV2aWNlcygpLnRoZW4odW5kZWZpbmVkLCBmdW5jdGlvbihlKSB7CiAgICAgICAgaWYgKGUubmFtZSA9PT0gJ05vdEZvdW5kRXJyb3InKSB7CiAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgfQogICAgICAgIHRocm93IGU7CiAgICAgIH0pOwogICAgfTsKICB9CiAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0OSkgewogICAgdmFyIG9yaWdHZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYS4KICAgICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjKSB7CiAgICAgIHJldHVybiBvcmlnR2V0VXNlck1lZGlhKGMpLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgLy8gV29yayBhcm91bmQgaHR0cHM6Ly9idWd6aWwubGEvODAyMzI2CiAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICBjLnZpZGVvICYmICFzdHJlYW0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7CiAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgIH0pOwogICAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignVGhlIG9iamVjdCBjYW4gbm90IGJlIGZvdW5kIGhlcmUuJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ05vdEZvdW5kRXJyb3InKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cmVhbTsKICAgICAgfSwgZnVuY3Rpb24oZSkgewogICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgfSk7CiAgICB9OwogIH0KICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0NCkgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhXyhjb25zdHJhaW50cywgb25TdWNjZXNzLCBvbkVycm9yKTsKICAgIH0KICAgIC8vIFJlcGxhY2UgRmlyZWZveCA0NCsncyBkZXByZWNhdGlvbiB3YXJuaW5nIHdpdGggdW5wcmVmaXhlZCB2ZXJzaW9uLgogICAgY29uc29sZS53YXJuKCduYXZpZ2F0b3IuZ2V0VXNlck1lZGlhIGhhcyBiZWVuIHJlcGxhY2VkIGJ5ICcgKwogICAgICAgICAgICAgICAgICduYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYScpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTsKICB9Owp9OwoKfSx7Ii4uL3V0aWxzIjoxMX1dLDEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLyoKICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICoKICogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlIGxpY2Vuc2UKICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZQogKiAgdHJlZS4KICovCid1c2Ugc3RyaWN0JzsKdmFyIHNhZmFyaVNoaW0gPSB7CiAgLy8gVE9ETzogRHJBbGV4LCBzaG91bGQgYmUgaGVyZSwgZG91YmxlIGNoZWNrIGFnYWluc3QgTGF5b3V0VGVzdHMKICAvLyBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7IH0sCgogIC8vIFRPRE86IG9uY2UgdGhlIGJhY2stZW5kIGZvciB0aGUgbWFjIHBvcnQgaXMgZG9uZSwgYWRkLgogIC8vIFRPRE86IGNoZWNrIGZvciB3ZWJraXRHVEsrCiAgLy8gc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsgfSwKCiAgc2hpbUdldFVzZXJNZWRpYTogZnVuY3Rpb24oKSB7CiAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1HZXRVc2VyTWVkaWE6IHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYQogIC8vIFRPRE8KICAvLyBzaGltT25UcmFjazogc2FmYXJpU2hpbS5zaGltT25UcmFjaywKICAvLyBzaGltUGVlckNvbm5lY3Rpb246IHNhZmFyaVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uCn07Cgp9LHt9XSwxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dEaXNhYmxlZF8gPSB0cnVlOwoKLy8gVXRpbGl0eSBtZXRob2RzLgp2YXIgdXRpbHMgPSB7CiAgZGlzYWJsZUxvZzogZnVuY3Rpb24oYm9vbCkgewogICAgaWYgKHR5cGVvZiBib29sICE9PSAnYm9vbGVhbicpIHsKICAgICAgcmV0dXJuIG5ldyBFcnJvcignQXJndW1lbnQgdHlwZTogJyArIHR5cGVvZiBib29sICsKICAgICAgICAgICcuIFBsZWFzZSB1c2UgYSBib29sZWFuLicpOwogICAgfQogICAgbG9nRGlzYWJsZWRfID0gYm9vbDsKICAgIHJldHVybiAoYm9vbCkgPyAnYWRhcHRlci5qcyBsb2dnaW5nIGRpc2FibGVkJyA6CiAgICAgICAgJ2FkYXB0ZXIuanMgbG9nZ2luZyBlbmFibGVkJzsKICB9LAoKICBsb2c6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSB7CiAgICAgIGlmIChsb2dEaXNhYmxlZF8pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5sb2cgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLyoqCiAgICogRXh0cmFjdCBicm93c2VyIHZlcnNpb24gb3V0IG9mIHRoZSBwcm92aWRlZCB1c2VyIGFnZW50IHN0cmluZy4KICAgKgogICAqIEBwYXJhbSB7IXN0cmluZ30gdWFzdHJpbmcgdXNlckFnZW50IHN0cmluZy4KICAgKiBAcGFyYW0geyFzdHJpbmd9IGV4cHIgUmVndWxhciBleHByZXNzaW9uIHVzZWQgYXMgbWF0Y2ggY3JpdGVyaWEuCiAgICogQHBhcmFtIHshbnVtYmVyfSBwb3MgcG9zaXRpb24gaW4gdGhlIHZlcnNpb24gc3RyaW5nIHRvIGJlIHJldHVybmVkLgogICAqIEByZXR1cm4geyFudW1iZXJ9IGJyb3dzZXIgdmVyc2lvbi4KICAgKi8KICBleHRyYWN0VmVyc2lvbjogZnVuY3Rpb24odWFzdHJpbmcsIGV4cHIsIHBvcykgewogICAgdmFyIG1hdGNoID0gdWFzdHJpbmcubWF0Y2goZXhwcik7CiAgICByZXR1cm4gbWF0Y2ggJiYgbWF0Y2gubGVuZ3RoID49IHBvcyAmJiBwYXJzZUludChtYXRjaFtwb3NdLCAxMCk7CiAgfSwKCiAgLyoqCiAgICogQnJvd3NlciBkZXRlY3Rvci4KICAgKgogICAqIEByZXR1cm4ge29iamVjdH0gcmVzdWx0IGNvbnRhaW5pbmcgYnJvd3NlciBhbmQgdmVyc2lvbgogICAqICAgICBwcm9wZXJ0aWVzLgogICAqLwogIGRldGVjdEJyb3dzZXI6IGZ1bmN0aW9uKCkgewogICAgLy8gUmV0dXJuZWQgcmVzdWx0IG9iamVjdC4KICAgIHZhciByZXN1bHQgPSB7fTsKICAgIHJlc3VsdC5icm93c2VyID0gbnVsbDsKICAgIHJlc3VsdC52ZXJzaW9uID0gbnVsbDsKCiAgICAvLyBGYWlsIGVhcmx5IGlmIGl0J3Mgbm90IGEgYnJvd3NlcgogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8ICF3aW5kb3cubmF2aWdhdG9yKSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIGJyb3dzZXIuJzsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvLyBGaXJlZm94LgogICAgaWYgKG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEpIHsKICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnZmlyZWZveCc7CiAgICAgIHJlc3VsdC52ZXJzaW9uID0gdGhpcy5leHRyYWN0VmVyc2lvbihuYXZpZ2F0b3IudXNlckFnZW50LAogICAgICAgICAgL0ZpcmVmb3hcLyhbMC05XSspXC4vLCAxKTsKCiAgICAvLyBhbGwgd2Via2l0LWJhc2VkIGJyb3dzZXJzCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEpIHsKICAgICAgLy8gQ2hyb21lLCBDaHJvbWl1bSwgV2VidmlldywgT3BlcmEsIGFsbCB1c2UgdGhlIGNocm9tZSBzaGltIGZvciBub3cKICAgICAgaWYgKHdpbmRvdy53ZWJraXRSVENQZWVyQ29ubmVjdGlvbikgewogICAgICAgIHJlc3VsdC5icm93c2VyID0gJ2Nocm9tZSc7CiAgICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvQ2hyb20oZXxpdW0pXC8oWzAtOV0rKVwuLywgMik7CgogICAgICAvLyBTYWZhcmkgb3IgdW5rbm93biB3ZWJraXQtYmFzZWQKICAgICAgLy8gZm9yIHRoZSB0aW1lIGJlaW5nIFNhZmFyaSBoYXMgc3VwcG9ydCBmb3IgTWVkaWFTdHJlYW1zIGJ1dCBub3Qgd2ViUlRDCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gU2FmYXJpIFVBIHN1YnN0cmluZ3Mgb2YgaW50ZXJlc3QgZm9yIHJlZmVyZW5jZToKICAgICAgICAvLyAtIHdlYmtpdCB2ZXJzaW9uOiAgICAgICAgICAgQXBwbGVXZWJLaXQvNjAyLjEuMjUgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLyAtIHNhZmFyaSBVSSB2ZXJzaW9uOiAgICAgICAgVmVyc2lvbi85LjAuMyAodW5pcXVlIHRvIFNhZmFyaSkKICAgICAgICAvLyAtIHNhZmFyaSBVSSB3ZWJraXQgdmVyc2lvbjogU2FmYXJpLzYwMS40LjQgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLwogICAgICAgIC8vIGlmIHRoZSB3ZWJraXQgdmVyc2lvbiBhbmQgc2FmYXJpIFVJIHdlYmtpdCB2ZXJzaW9ucyBhcmUgZXF1YWxzLAogICAgICAgIC8vIC4uLiB0aGlzIGlzIGEgc3RhYmxlIHZlcnNpb24uCiAgICAgICAgLy8KICAgICAgICAvLyBvbmx5IHRoZSBpbnRlcm5hbCB3ZWJraXQgdmVyc2lvbiBpcyBpbXBvcnRhbnQgdG9kYXkgdG8ga25vdyBpZgogICAgICAgIC8vIG1lZGlhIHN0cmVhbXMgYXJlIHN1cHBvcnRlZAogICAgICAgIC8vCiAgICAgICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1ZlcnNpb25cLyhcZCspLihcZCspLykpIHsKICAgICAgICAgIHJlc3VsdC5icm93c2VyID0gJ3NhZmFyaSc7CiAgICAgICAgICByZXN1bHQudmVyc2lvbiA9IHRoaXMuZXh0cmFjdFZlcnNpb24obmF2aWdhdG9yLnVzZXJBZ2VudCwKICAgICAgICAgICAgL0FwcGxlV2ViS2l0XC8oWzAtOV0rKVwuLywgMSk7CgogICAgICAgIC8vIHVua25vd24gd2Via2l0LWJhc2VkIGJyb3dzZXIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnVW5zdXBwb3J0ZWQgd2Via2l0LWJhc2VkIGJyb3dzZXIgJyArCiAgICAgICAgICAgICAgJ3dpdGggR1VNIHN1cHBvcnQgYnV0IG5vIFdlYlJUQyBzdXBwb3J0Lic7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgICAgfQoKICAgIC8vIEVkZ2UuCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMgJiYKICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9FZGdlXC8oXGQrKS4oXGQrKSQvKSkgewogICAgICByZXN1bHQuYnJvd3NlciA9ICdlZGdlJzsKICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvRWRnZVwvKFxkKykuKFxkKykkLywgMik7CgogICAgLy8gRGVmYXVsdCBmYWxsdGhyb3VnaDogbm90IHN1cHBvcnRlZC4KICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIHN1cHBvcnRlZCBicm93c2VyLic7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9LAoKICAvLyBzaGltQ3JlYXRlT2JqZWN0VVJMIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBzaGltU291cmNlT2JqZWN0IHRvIGF2b2lkIGxvb3AuCgogIHNoaW1DcmVhdGVPYmplY3RVUkw6IGZ1bmN0aW9uKCkgewogICAgaWYgKCEodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAgICdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgLy8gT25seSBzaGltIENyZWF0ZU9iamVjdFVSTCB1c2luZyBzcmNPYmplY3QgaWYgc3JjT2JqZWN0IGV4aXN0cy4KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICB2YXIgbmF0aXZlQ3JlYXRlT2JqZWN0VVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgbmF0aXZlUmV2b2tlT2JqZWN0VVJMID0gVVJMLnJldm9rZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgc3RyZWFtcyA9IG5ldyBNYXAoKSwgbmV3SWQgPSAwOwoKICAgIFVSTC5jcmVhdGVPYmplY3RVUkwgPSBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgaWYgKCdnZXRUcmFja3MnIGluIHN0cmVhbSkgewogICAgICAgIHZhciB1cmwgPSAncG9seWJsb2I6JyArICgrK25ld0lkKTsKICAgICAgICBzdHJlYW1zLnNldCh1cmwsIHN0cmVhbSk7CiAgICAgICAgY29uc29sZS5sb2coJ1VSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKSBpcyBkZXByZWNhdGVkISAnICsKICAgICAgICAgICAgICAgICAgICAnVXNlIGVsZW0uc3JjT2JqZWN0ID0gc3RyZWFtIGluc3RlYWQhJyk7CiAgICAgICAgcmV0dXJuIHVybDsKICAgICAgfQogICAgICByZXR1cm4gbmF0aXZlQ3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICB9OwogICAgVVJMLnJldm9rZU9iamVjdFVSTCA9IGZ1bmN0aW9uKHVybCkgewogICAgICBuYXRpdmVSZXZva2VPYmplY3RVUkwodXJsKTsKICAgICAgc3RyZWFtcy5kZWxldGUodXJsKTsKICAgIH07CgogICAgdmFyIGRzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NyYycpOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyYycsIHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gZHNjLmdldC5hcHBseSh0aGlzKTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbih1cmwpIHsKICAgICAgICB0aGlzLnNyY09iamVjdCA9IHN0cmVhbXMuZ2V0KHVybCkgfHwgbnVsbDsKICAgICAgICByZXR1cm4gZHNjLnNldC5hcHBseSh0aGlzLCBbdXJsXSk7CiAgICAgIH0KICAgIH0pOwogIH0KfTsKCi8vIEV4cG9ydC4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgbG9nOiB1dGlscy5sb2csCiAgZGlzYWJsZUxvZzogdXRpbHMuZGlzYWJsZUxvZywKICBicm93c2VyRGV0YWlsczogdXRpbHMuZGV0ZWN0QnJvd3NlcigpLAogIGV4dHJhY3RWZXJzaW9uOiB1dGlscy5leHRyYWN0VmVyc2lvbiwKICBzaGltQ3JlYXRlT2JqZWN0VVJMOiB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMCn07Cgp9LHt9XSwxMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCnJlcXVpcmUoJ3dlYnJ0Yy1hZGFwdGVyJyk7CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCi8qKgogIFRoZSBDb25uZWN0aW9uQ29udHJvbGxlciBoYXMgYSBnZW5lcmljIGRlc2lnbiBzbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGluIGJvdGggc3R1YnMuCiAgSXQgbWFuYWdlcyBhIHNpbmdsZSBEYXRhQ2hhbm5lbCwgaXQgaXMgbm90IHJlcXVlc3RpbmcgYWNjZXNzIHRvIG1lZGlhIGlucHV0LCBpLmUuCiAgZG9lcyBub3QgaGF2ZSBhdWRpby92aWRlbyBzdHJlYW1zLgoqKi8KdmFyIENvbm5lY3Rpb25Db250cm9sbGVyID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENvbm5lY3Rpb25Db250cm9sbGVyKG15VXJsLCBzeW5jaGVyLCBjb25maWd1cmF0aW9uLCBjYWxsZXIpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb25uZWN0aW9uQ29udHJvbGxlcik7CgogICAgaWYgKCFteVVybCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgb3duIHVybCAobXlVcmwpIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFzeW5jaGVyKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzeW5jaGVyIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFjb25maWd1cmF0aW9uKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWd1cmF0aW9uIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoKICAgIHRoaXMuX2RvbWFpbiA9IHRoaXMuX2RpdmlkZVVSTChteVVybClbImRvbWFpbiJdOwogICAgdGhpcy5fb2JqZWN0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovL2NhdGFsb2d1ZS4nICsgdGhpcy5fZG9tYWluICsgJy8ud2VsbC1rbm93bi9kYXRhc2NoZW1hL0Nvbm5lY3Rpb24nOwoKICAgIHRoaXMuX215VXJsID0gbXlVcmw7CiAgICB0aGlzLl9zeW5jaGVyID0gc3luY2hlcjsKICAgIHRoaXMuX2NvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uOwogICAgdGhpcy5fY2FsbGVyID0gY2FsbGVyOwogICAgdGhpcy5fZGF0YU9iamVjdE9ic2VydmVyOwogICAgdGhpcy5fZGF0YU9iamVjdFJlcG9ydGVyOwogICAgdGhpcy5fcGVlclVybDsKICAgIHRoaXMuX2RhdGFDaGFubmVsOwogICAgdGhpcy5fb25TdGF0dXNVcGRhdGU7CiAgICB0aGlzLl9yZW1vdGVSdW50aW1lVVJMOwoKICAgIHRoaXMuX3BlZXJDb25uZWN0aW9uID0gdGhpcy5fY3JlYXRlUGVlckNvbm5lY3Rpb24oKTsKICB9CgogIC8vY3JlYXRlIGEgcGVlciBjb25uZWN0aW9uIHdpdGggaXRzIGV2ZW50IGhhbmRsZXJzCgoKICBfY3JlYXRlQ2xhc3MoQ29ubmVjdGlvbkNvbnRyb2xsZXIsIFt7CiAgICBrZXk6ICdfY3JlYXRlUGVlckNvbm5lY3Rpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVQZWVyQ29ubmVjdGlvbigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBwYyA9IHRoaXMuX3BlZXJDb25uZWN0aW9uOwogICAgICBpZiAoIXBjKSB7CiAgICAgICAgcGMgPSBuZXcgUlRDUGVlckNvbm5lY3Rpb24odGhpcy5fY29uZmlndXJhdGlvbik7CiAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiBjcmVhdGVkIFBlZXJDb25uZWN0aW9uIik7CgogICAgICAgIC8vIGFkZCBoYW5kbGVyIGZvciBkYXRhY2hhbm5lbCBjcmVhdGlvbiBmcm9tIHBlZXIgc2lkZQogICAgICAgIHBjLm9uZGF0YWNoYW5uZWwgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogb25kYXRhY2hhbm5lbCAtPiByZW1vdGUgc2lkZSBoYXMgY3JlYXRlZCBhIGRhdGFjaGFubmVsIik7CiAgICAgICAgICBfdGhpcy5fZGF0YUNoYW5uZWwgPSBldmVudC5jaGFubmVsOwogICAgICAgICAgX3RoaXMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfTsKCiAgICAgICAgLy8gZXZlbnQgaGFuZGxlciBmb3IgbG9jYWwgaWNlIGNhbmRpZGF0ZXMKICAgICAgICBwYy5vbmljZWNhbmRpZGF0ZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IGljZWNhbmRpZGF0ZWV2ZW50IG9jY3VyZWQ6ICIsIGUpOwogICAgICAgICAgaWYgKCFlLmNhbmRpZGF0ZSkgcmV0dXJuOwogICAgICAgICAgdmFyIGljZWNhbmRpZGF0ZSA9IHsKICAgICAgICAgICAgdHlwZTogJ2NhbmRpZGF0ZScsCiAgICAgICAgICAgIGNhbmRpZGF0ZTogZS5jYW5kaWRhdGUuY2FuZGlkYXRlLAogICAgICAgICAgICBzZHBNaWQ6IGUuY2FuZGlkYXRlLnNkcE1pZCwKICAgICAgICAgICAgc2RwTUxpbmVJbmRleDogZS5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleAogICAgICAgICAgfTsKICAgICAgICAgIC8vIHNlbmQgY2FuZGlkYXRlIHRvIHJlbW90ZSBwZWVyIGJ5IHB1c2hpbmcgaXQgdG8gdGhlIHJlcG9ydGVyIG9iamVjdAogICAgICAgICAgX3RoaXMuX2RhdGFPYmplY3RSZXBvcnRlci5kYXRhLmljZUNhbmRpZGF0ZXMucHVzaChpY2VjYW5kaWRhdGUpOwogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIHBjOwogICAgfQoKICAgIC8qKgogICAgUmVhY3QgdG8gdGhlIGdpdmVuIGludml0YXRpb24gZXZlbnQgYnkgc3Vic2NyaWJpbmcgdG8gdGhlIHByb3ZpZGVkIGludml0YXRpb25FdmVudC51cmwuCiAgICAqKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb2JzZXJ2ZShpbnZpdGF0aW9uRXZlbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLl9wZWVyVXJsID0gaW52aXRhdGlvbkV2ZW50LmZyb207CiAgICAgIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwgPSBpbnZpdGF0aW9uRXZlbnQudmFsdWUucnVudGltZVVSTDsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIF90aGlzMi5fc3luY2hlci5zdWJzY3JpYmUoX3RoaXMyLl9vYmplY3REZXNjVVJMLCBpbnZpdGF0aW9uRXZlbnQudXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgICAgIGNvbnNvbGUuaW5mbygnK1tQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIGdvdCBEYXRhIE9iamVjdCBPYnNlcnZlcicsIGRhdGFPYmplY3RPYnNlcnZlcik7CiAgICAgICAgICBfdGhpczIuX3NldHVwT2JzZXJ2ZXIoZGF0YU9iamVjdE9ic2VydmVyKTsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICByZWplY3QoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICBDcmVhdGVzIGEgc3luY2hlciBvYmplY3QgYW5kIGludml0ZSB0aGUgZ2l2ZW4gcGVlclVybCB0byBzdWJzY3JpYmUgZm9yIGl0LgogICAgQWxzbyBjcmVhdGVzIHRoZSBsb2NhbCBvZmZlciwgcGVyZm9ybXMgc2V0TG9jYWxEZXNjcmlwdGlvbiBhbmQgcHVibGlzaGVzIHRoZSBvZmZlciB2aWEgdGhlIHJlcG9ydGVyIG9iamVjdC4KICAgICoqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcG9ydChwZWVyVXJsLCBvd25SdW50aW1lVXJsKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLl9wZWVyVXJsKSB0aGlzLl9wZWVyVXJsID0gcGVlclVybDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgLy8gIGlmIHdlIGFyZSB0aGUgY2FsbGVyIChpLmUuIG5vIHJlcG9ydGVyIG9iamVjdCBwcmVzZW50IHlldCwgaW5pdGFsaXplIHRoZSBjcmVhdGlvbiBvZiB0aGUgRGF0YUNoYW5uZWwpCiAgICAgICAgaWYgKF90aGlzMy5fY2FsbGVyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHdlIGFyZSBpbiBjYWxsZXIgcm9sZSAtLT4gY3JlYXRlRGF0YUNoYW5uZWwgLi4uIik7CiAgICAgICAgICBfdGhpczMuX2RhdGFDaGFubmVsID0gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVEYXRhQ2hhbm5lbCgiUDJQQ2hhbm5lbCIsIHsgcmVsaWFibGU6IGZhbHNlIH0pOwogICAgICAgICAgY29uc29sZS5sb2coIlAyUDogZGF0YWNoYW5uZWwgb2JqZWN0IiwgX3RoaXMzLl9kYXRhQ2hhbm5lbCk7CiAgICAgICAgICBfdGhpczMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBpbml0aWFsIGRhdGEgZm9yIHJlcG9ydGVyIHN5bmMgb2JqZWN0CiAgICAgICAgdmFyIGRhdGFPYmplY3QgPSB7CiAgICAgICAgICBuYW1lOiAiUDJQQ29ubmVjdGlvbiIsCiAgICAgICAgICBzdGF0dXM6ICIiLAogICAgICAgICAgb3duZXI6IF90aGlzMy5fbXlVcmwsCiAgICAgICAgICBydW50aW1lVVJMOiBvd25SdW50aW1lVXJsLCAvLyBwdXQgdGhlIG93biBydW50aW1lVVJMIHRvIHRoZSBkYXRhT2JqZWN0IChhcyBkaXNjdXNzZWQgd2l0aCBQYXVsbykKICAgICAgICAgIGNvbm5lY3Rpb25EZXNjcmlwdGlvbjoge30sCiAgICAgICAgICBpY2VDYW5kaWRhdGVzOiBbXQogICAgICAgIH07CiAgICAgICAgLy8gZW5zdXJlIHRoaXMgdGhlIG9ialJlcG9ydGVyIG9iamVjdCBpcyBjcmVhdGVkIGJlZm9yZSB3ZSBjcmVhdGUgdGhlIG9mZmVyCiAgICAgICAgX3RoaXMzLl9zeW5jaGVyLmNyZWF0ZShfdGhpczMuX29iamVjdERlc2NVUkwsIFtfdGhpczMuX3BlZXJVcmxdLCBkYXRhT2JqZWN0KS50aGVuKGZ1bmN0aW9uIChvYmpSZXBvcnRlcikgewogICAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBDcmVhdGVkIFdlYlJUQyBPYmplY3QgUmVwb3J0ZXInLCBvYmpSZXBvcnRlcik7CgogICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIgPSBvYmpSZXBvcnRlcjsKICAgICAgICAgIF90aGlzMy5fZGF0YU9iamVjdFJlcG9ydGVyLm9uU3Vic2NyaXB0aW9uKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICBldmVudC5hY2NlcHQoKTsgLy8gYWxsIHN1YnNjcmlwdGlvbiByZXF1ZXN0ZWQgYXJlIGFjY2VwdGVkCiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgY29uc3RyYWludHMgPSB7CiAgICAgICAgICAgIG9mZmVyVG9SZWNlaXZlQXVkaW86IGZhbHNlLAogICAgICAgICAgICBvZmZlclRvUmVjZWl2ZVZpZGVvOiBmYWxzZQogICAgICAgICAgfTsKICAgICAgICAgIC8vIGVpdGhlciBpbnZva2UgY3JlYXRlT2ZmZXIgb3IgY3JlYXRlQW5zd2VyLCBkZXBlbmRpbmcgb24gdGhlIHJvbGVzCiAgICAgICAgICB2YXIgc2RwUHJvbWlzZSA9IF90aGlzMy5fY2FsbGVyID8gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVPZmZlcihjb25zdHJhaW50cykgOiBfdGhpczMuX3BlZXJDb25uZWN0aW9uLmNyZWF0ZUFuc3dlcigpOwogICAgICAgICAgc2RwUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChzZHApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIFNEUCBjcmVhdGVkIiwgc2RwKTsKICAgICAgICAgICAgX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5zZXRMb2NhbERlc2NyaXB0aW9uKG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oc2RwKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gbG9jYWxEZXNjcmlwdGlvbiBzZXQgc3VjY2Vzc2Z1bGx5Jyk7CiAgICAgICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIuZGF0YS5jb25uZWN0aW9uRGVzY3JpcHRpb24gPSBzZHA7CiAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHJlamVjdCgic2V0dGluZyBvZiBsb2NhbERlc2NyaXB0aW9uIGZhaWxlZDogIiwgZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICAgIHJlamVjdChyZWFzb24pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25NZXNzYWdlKGNhbGxiYWNrKSB7CiAgICAgIC8vIGFkZCB0aGUgbWVzc2FnZSBjYWxsYmFjawogICAgICB0aGlzLl9vbkRhdGFDaGFubmVsTWVzc2FnZSA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uU3RhdHVzVXBkYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblN0YXR1c1VwZGF0ZShjYWxsYmFjaykgewogICAgICAvLyBhZGQgYSBjb25uZWN0aW9uIHN0YXR1cyB1cGRhdGUgY2FsbGJhY2sKICAgICAgdGhpcy5fb25TdGF0dXNVcGRhdGUgPSBjYWxsYmFjazsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdzZW5kTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZE1lc3NhZ2UobSkgewogICAgICAvLyB0b2RvOiBvbmx5IHNlbmQgaWYgZGF0YSBjaGFubmVsIGlzIGNvbm5lY3RlZAogICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gLS0+IG91dGdvaW5nIG1zZzogIiwgbSk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLnNlbmQobSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnY2xlYW51cCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYW51cCgpIHsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RPYnNlcnZlcjsKICAgICAgaWYgKHRoaXMuX2RhdGFDaGFubmVsKSB0aGlzLl9kYXRhQ2hhbm5lbC5jbG9zZSgpOwogICAgICBpZiAodGhpcy5fcGVlckNvbm5lY3Rpb24pIHRoaXMuX3BlZXJDb25uZWN0aW9uLmNsb3NlKCk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsID0gbnVsbDsKICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24gPSBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogJ19hZGREYXRhQ2hhbm5lbExpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxPcGVuKCk7CiAgICAgIH07CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzNC5fb25EYXRhQ2hhbm5lbEVycm9yKGUpOwogICAgICB9OwogICAgICB0aGlzLl9kYXRhQ2hhbm5lbC5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAobSkgewogICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSA8LS0gaW5jb21pbmcgbXNnOiAiLCBtKTsKICAgICAgICBpZiAoX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZSkgX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZShtKTsKICAgICAgfTsKICAgICAgdGhpcy5fZGF0YUNoYW5uZWwub25jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxDbG9zZSgpOwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZXR1cE9ic2VydmVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0dXBPYnNlcnZlcihkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIgPSBkYXRhT2JqZWN0T2JzZXJ2ZXI7CgogICAgICB2YXIgcGVlckRhdGEgPSB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YTsKICAgICAgY29uc29sZS5pbmZvKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogX3NldHVwT2JzZXJ2ZXIgUGVlciBEYXRhOiIsIHBlZXJEYXRhKTsKCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnY29ubmVjdGlvbkRlc2NyaXB0aW9uJykpIHsKICAgICAgICB0aGlzLl9wcm9jZXNzUGVlckluZm9ybWF0aW9uKHBlZXJEYXRhLmNvbm5lY3Rpb25EZXNjcmlwdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnaWNlQ2FuZGlkYXRlcycpKSB7CiAgICAgICAgcGVlckRhdGEuaWNlQ2FuZGlkYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChpY2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogaGFuZGxlT2JzZXJ2ZXJPYmplY3QgZm9yIGljZSIsIGljZSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oaWNlKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgLy8gc2V0dXAgbGlzdGVuZXIgZm9yIGZ1dHVyZSBjaGFuZ2VzIG9uIHRoZSBvYnNlcnZlZCBkYXRhIG9iamVjdAogICAgICBkYXRhT2JqZWN0T2JzZXJ2ZXIub25DaGFuZ2UoJyonLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBjb25zb2xlLmRlYnVnKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogT2JzZXJ2ZXIgb24gY2hhbmdlIG1lc3NhZ2U6ICcsIGV2ZW50KTsKICAgICAgICAvLyB3ZSBuZWVkIHRvIHByb2Nlc3MgdGhlIGFuc3dlciBmcm9tIGV2ZW50LmRhdGEgYW5kIHRoZSBjYW5kaWRhdGVzIHdoaWNoIG1pZ2h0IHRyaWNrbGUKICAgICAgICAvLyBmcm9tIGV2ZW50LmRhdGFbMF0KICAgICAgICBpZiAoZXZlbnQuZGF0YVswXSkgewogICAgICAgICAgLy8gWzBdIHRoaXMgZG9lcyB0aGUgdHJpY2sgd2hlbiBpY2UgY2FuZGlkYXRlcyBhcmUgdHJpY2tsaW5nIDspCiAgICAgICAgICBjb25zb2xlLmxvZygnPj5ldmVudC5kYXRhWzBdJywgZXZlbnQuZGF0YVswXSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oZXZlbnQuZGF0YVswXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogPj5ldmVudCcsIGV2ZW50KTsKICAgICAgICAgIF90aGlzNS5fcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihldmVudC5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19wcm9jZXNzUGVlckluZm9ybWF0aW9uJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihkYXRhKSB7CiAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246ICIsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgaWYgKCF0aGlzLl9wZWVyQ29ubmVjdGlvbikgewogICAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246IG5vIFBlZXJDb25uZWN0aW9uIGV4aXN0aW5nIC0tPiBtYXliZSBpbiBkaXNjb25uZWN0aW5nIHByb2Nlc3MuIC0tPiBpZ25vcmluZyB0aGlzIHVwZGF0ZSIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGRhdGEudHlwZSA9PT0gJ29mZmVyJyB8fCBkYXRhLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogUHJvY2VzcyBDb25uZWN0aW9uIERlc2NyaXB0aW9uOiAnLCBkYXRhKTsKICAgICAgICB0aGlzLl9wZWVyQ29ubmVjdGlvbi5zZXRSZW1vdGVEZXNjcmlwdGlvbihuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKGRhdGEpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogcmVtb3RlIHN1Y2Nlc3MiKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiByZW1vdGUgZXJyb3I6ICIsIGUpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoZGF0YS5jYW5kaWRhdGUpIHsKICAgICAgICBjb25zb2xlLmluZm8oJ1Byb2Nlc3MgSWNlIENhbmRpZGF0ZTogJywgZGF0YSk7CiAgICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24uYWRkSWNlQ2FuZGlkYXRlKG5ldyBSVENJY2VDYW5kaWRhdGUoewogICAgICAgICAgY2FuZGlkYXRlOiBkYXRhLmNhbmRpZGF0ZQogICAgICAgIH0pKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsT3BlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRGF0YUNoYW5uZWxPcGVuKCkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgb3BlbmVkJyk7CiAgICAgIGlmICh0aGlzLl9vblN0YXR1c1VwZGF0ZSkgdGhpcy5fb25TdGF0dXNVcGRhdGUoImxpdmUiLCB1bmRlZmluZWQsIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsRXJyb3InLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsRXJyb3IoZSkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgZXJyb3I6ICcsIGUpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiIiArIGUpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsQ2xvc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsQ2xvc2UoKSB7CiAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBEYXRhQ2hhbm5lbCBjbG9zZWQ6ICcpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiY2xvc2VkIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICAgICAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAgICAgKiBAcmV0dXJuIHtkaXZpZGVVUkx9IHRoZSByZXN1bHQgb2YgZGl2aWRlVVJMCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnX2RpdmlkZVVSTCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RpdmlkZVVSTCh1cmwpIHsKCiAgICAgIC8vIGxldCByZSA9IC8oW2EtekEtWi1dKik/OlwvXC8oPzpcLik/KFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIpKihcL1tcL1xkXHdcLi1dKikqKD86W1w/XSkqKC4rKSovZ2k7CiAgICAgIHZhciByZSA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogICAgICB2YXIgc3Vic3QgPSAnJDEsJDIsJDMnOwogICAgICB2YXIgcGFydHMgPSB1cmwucmVwbGFjZShyZSwgc3Vic3QpLnNwbGl0KCcsJyk7CgogICAgICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzCiAgICAgIGlmIChwYXJ0c1swXSA9PT0gdXJsKSB7CiAgICAgICAgcGFydHNbMF0gPSAnaHR0cHMnOwogICAgICAgIHBhcnRzWzFdID0gdXJsOwogICAgICB9CgogICAgICB2YXIgcmVzdWx0ID0gewogICAgICAgIHR5cGU6IHBhcnRzWzBdLAogICAgICAgIGRvbWFpbjogcGFydHNbMV0sCiAgICAgICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgICAgIH07CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIENvbm5lY3Rpb25Db250cm9sbGVyOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBDb25uZWN0aW9uQ29udHJvbGxlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsid2VicnRjLWFkYXB0ZXIiOjN9XSwxMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCi8vIFRPRE86IGludGVncmF0ZSB0aGUgc3RhdHVzIGV2ZW50aW5nCgpleHBvcnRzLmRlZmF1bHQgPSBhY3RpdmF0ZTsKCnZhciBfU3luY2hlciA9IHJlcXVpcmUoJ3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlcicpOwoKdmFyIF9Db25uZWN0aW9uQ29udHJvbGxlciA9IHJlcXVpcmUoJy4vQ29ubmVjdGlvbkNvbnRyb2xsZXInKTsKCnZhciBfQ29ubmVjdGlvbkNvbnRyb2xsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQ29ubmVjdGlvbkNvbnRyb2xsZXIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKLyoqCiAqIFByb3RvU3R1YiBJbnRlcmZhY2UKICovCnZhciBQMlBIYW5kbGVyU3R1YiA9IGZ1bmN0aW9uICgpIHsKCiAgLyoqCiAgICogSW5pdGlhbGlzZSB0aGUgcHJvdG9jb2wgc3R1YiBpbmNsdWRpbmcgYXMgaW5wdXQgcGFyYW1ldGVycyBpdHMgYWxsb2NhdGVkCiAgICogY29tcG9uZW50IHJ1bnRpbWUgdXJsLCB0aGUgcnVudGltZSBCVVMgcG9zdE1lc3NhZ2UgZnVuY3Rpb24gdG8gYmUgaW52b2tlZAogICAqIG9uIG1lc3NhZ2VzIHJlY2VpdmVkIGJ5IHRoZSBwcm90b2NvbCBzdHViIGFuZCByZXF1aXJlZCBjb25maWd1cmF0aW9uIHJldHJpZXZlZCBmcm9tIHByb3RvY29sU3R1YiBkZXNjcmlwdG9yLgogICAqIEBwYXJhbSAge1VSTC5ydW50aW1lUHJvdG9TdHViVVJMfSAgICAgICAgICAgICAgICAgICBydW50aW1lUHJvdG9TdHViVVJMIHJ1bnRpbWVQcm90b1N1YlVSTAogICAqIEBwYXJhbSAge01lc3NhZ2UuTWVzc2FnZX0gICAgICAgICAgICAgICAgICAgICAgICAgICBidXNQb3N0TWVzc2FnZSAgICAgY29uZmlndXJhdGlvbgogICAqIEBwYXJhbSAge1Byb3RvU3R1YkRlc2NyaXB0b3IuQ29uZmlndXJhdGlvbkRhdGFMaXN0fSBjb25maWd1cmF0aW9uICAgICAgY29uZmlndXJhdGlvbgogICAqLwogIGZ1bmN0aW9uIFAyUEhhbmRsZXJTdHViKHJ1bnRpbWVQcm90b1N0dWJVUkwsIG1pbmlCdXMsIGNvbmZpZ3VyYXRpb24pIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFAyUEhhbmRsZXJTdHViKTsKCiAgICBpZiAoIXJ1bnRpbWVQcm90b1N0dWJVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIHJ1bnRpbWVQcm90b1N0dWJVUkwgaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKICAgIGlmICghbWluaUJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWNvbmZpZ3VyYXRpb24pIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZ3VyYXRpb24gaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKCiAgICBjb25zb2xlLmxvZygnK1tQMlBIYW5kbGVyU3R1Yi5jb25zdHJ1Y3Rvcl0gY29uZmlnIGlzOiAnLCBjb25maWd1cmF0aW9uKTsKCiAgICB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMID0gcnVudGltZVByb3RvU3R1YlVSTDsKICAgIHRoaXMuX3J1bnRpbWVVUkwgPSBjb25maWd1cmF0aW9uLnJ1bnRpbWVVUkw7CiAgICB0aGlzLl9jb25maWd1cmF0aW9uID0gY29uZmlndXJhdGlvbjsKICAgIHRoaXMuX2J1cyA9IG1pbmlCdXM7CiAgICB0aGlzLl9idXMuYWRkTGlzdGVuZXIoJyonLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgIF90aGlzLl9zZW5kQ2hhbm5lbE1zZyhtc2cpOwogICAgfSk7CgogICAgdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXJzID0ge307CgogICAgdGhpcy5fc3luY2hlciA9IG5ldyBfU3luY2hlci5TeW5jaGVyKHJ1bnRpbWVQcm90b1N0dWJVUkwsIG1pbmlCdXMsIGNvbmZpZ3VyYXRpb24pOwogICAgdGhpcy5fc3luY2hlci5vbk5vdGlmaWNhdGlvbihmdW5jdGlvbiAoZXZlbnQpIHsKCiAgICAgIGNvbnNvbGUubG9nKCcrW1AyUEhhbmRsZXJTdHViXSBPbiBTeW5jaGVyIE5vdGlmaWNhdGlvbjogJywgZXZlbnQpOwogICAgICBldmVudC5hY2soMjAwKTsKCiAgICAgIHN3aXRjaCAoZXZlbnQudHlwZSkgewoKICAgICAgICBjYXNlICdjcmVhdGUnOgoKICAgICAgICAgIC8vIGFzIGRpc2N1c3NlZCB3aXRoIFBhdWxvLCB3ZSBleHBlY3QgdGhlICJyZW1vdGVSdW50aW1lVVJMIiBhcyBmaWVsZCAicnVudGltZVVSTCIgaW4gdGhlIGluaXRpYWwgZGF0YU9iamVjdAogICAgICAgICAgLy8gZW1pdCB0aGUgImNyZWF0ZSIgZXZlbnQgYXMgcmVxdWVzdGVkIGluIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2Rldi1wcm90b3N0dWJzL2lzc3Vlcy81CiAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygiY3JlYXRlIiwgdW5kZWZpbmVkLCBldmVudC52YWx1ZS5ydW50aW1lVVJMKTsKCiAgICAgICAgICBfdGhpcy5fY3JlYXRlQ29ubmVjdGlvbkNvbnRyb2xsZXIoZXZlbnQpLnRoZW4oZnVuY3Rpb24gKGNvbm5lY3Rpb25Db250cm9sbGVyKSB7CiAgICAgICAgICAgIF90aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcnNbZXZlbnQuZnJvbV0gPSBjb25uZWN0aW9uQ29udHJvbGxlcjsKICAgICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIub25TdGF0dXNVcGRhdGUoZnVuY3Rpb24gKHN0YXR1cywgcmVhc29uLCByZW1vdGVSdW50aW1lVVJMKSB7CiAgICAgICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoc3RhdHVzLCByZWFzb24sIHJlbW90ZVJ1bnRpbWVVUkwpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIub25NZXNzYWdlKGZ1bmN0aW9uIChtKSB7CiAgICAgICAgICAgICAgX3RoaXMuX2RlbGl2ZXIobSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnZGVsZXRlJzoKICAgICAgICAgIC8vIFRPRE86IHF1ZXN0aW9uIGNvZGUgaW4gQ29ubmVjdG9yIC0tPiB0aGVyZSBpdCBkZWxldGVzIGFsbCBjb250cm9sbGVycyAtLT4gd2h5PwogICAgICAgICAgY29uc29sZS5sb2coIitbUDJQSGFuZGxlclN0dWJdIGRlbGV0aW5nIGNvbm5lY3Rpb24gaGFuZGxlciBmb3IgIiArIGV2ZW50LmZyb20pOwogICAgICAgICAgdmFyIGNvbm5lY3Rpb25Db250cm9sbGVyID0gX3RoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyc1tldmVudC5mcm9tXTsKCiAgICAgICAgICBpZiAoY29ubmVjdGlvbkNvbnRyb2xsZXIpIHsKICAgICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIuY2xlYW51cCgpOwogICAgICAgICAgICBkZWxldGUgX3RoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyc1tldmVudC5mcm9tXTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICB9CiAgICB9KTsKICB9CgogIC8qKgogICAqIFRvIGRpc2Nvbm5lY3QgdGhlIHByb3RvY29sIHN0dWIuCiAgICovCgoKICBfY3JlYXRlQ2xhc3MoUDJQSGFuZGxlclN0dWIsIFt7CiAgICBrZXk6ICdkaXNjb25uZWN0JywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb25uZWN0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIC8vIGNsZWFudXAgQUxMIGNvbm5lY3Rpb25Db250cm9sbGVycwogICAgICBPYmplY3Qua2V5cyh0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcnMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF90aGlzMi5fY29udHJvbGxlcnNba2V5XS5jbGVhbnVwKCk7OwogICAgICAgIGRlbGV0ZSBfdGhpczIuX2NvbnRyb2xsZXJzW2tleV07CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19jcmVhdGVDb25uZWN0aW9uQ29udHJvbGxlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZUNvbm5lY3Rpb25Db250cm9sbGVyKGludml0YXRpb25FdmVudCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIGNvbm5lY3Rpb25Db250cm9sbGVyID0gbmV3IF9Db25uZWN0aW9uQ29udHJvbGxlcjIuZGVmYXVsdChfdGhpczMuX3J1bnRpbWVQcm90b1N0dWJVUkwsIF90aGlzMy5fc3luY2hlciwgX3RoaXMzLl9jb25maWd1cmF0aW9uLCBmYWxzZSk7CiAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIub2JzZXJ2ZShpbnZpdGF0aW9uRXZlbnQpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgY29uc29sZS5sb2coIitbUDJQSGFuZGxlclN0dWJdIG9ic2VydmVyIHNldHVwIHN1Y2Nlc3NmdWwiKTsKICAgICAgICAgIC8vIGNyZWF0ZSB0aGUgcmVwb3J0ZXIgYXV0b21hdGljYWxseQogICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIucmVwb3J0KGludml0YXRpb25FdmVudC5mcm9tLCBfdGhpczMuX3J1bnRpbWVVUkwpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiK1tQMlBIYW5kbGVyU3R1Yl0gcmVwb3J0ZXIgc2V0dXAgc3VjY2Vzc2Z1bCIpOwogICAgICAgICAgICBfdGhpczMuX3NlbmRTdGF0dXMoImluLXByb2dyZXNzIiwgdW5kZWZpbmVkLCBpbnZpdGF0aW9uRXZlbnQudmFsdWUucnVudGltZVVSTCk7CiAgICAgICAgICAgIHJlc29sdmUoY29ubmVjdGlvbkNvbnRyb2xsZXIpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZW5kQ2hhbm5lbE1zZycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRDaGFubmVsTXNnKG1zZykgewogICAgICBpZiAodGhpcy5fZmlsdGVyKG1zZykpIHsKICAgICAgICAvLyBUT0RPOiB2ZXJpZnk6IGlzIHRoaXMgc2VsZWN0aW9uIGNvcnJlY3Q/CiAgICAgICAgdmFyIGNvbm5lY3Rpb25Db250cm9sbGVyID0gdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXJzW21zZy50b107CiAgICAgICAgaWYgKGNvbm5lY3Rpb25Db250cm9sbGVyKSBjb25uZWN0aW9uQ29udHJvbGxlci5zZW5kTWVzc2FnZShKU09OLnN0cmluZ2lmeShtc2cpKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19zZW5kU3RhdHVzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VuZFN0YXR1cyh2YWx1ZSwgcmVhc29uLCByZW1vdGVSdW50aW1lVVJMKSB7CiAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgdHlwZTogJ3VwZGF0ZScsCiAgICAgICAgZnJvbTogdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCwKICAgICAgICB0bzogdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCArICcvc3RhdHVzJywKICAgICAgICBib2R5OiB7CiAgICAgICAgICB2YWx1ZTogdmFsdWUKICAgICAgICB9CiAgICAgIH07CiAgICAgIGlmIChyZW1vdGVSdW50aW1lVVJMKSBtc2cuYm9keS5yZXNvdXJjZSA9IHJlbW90ZVJ1bnRpbWVVUkw7CgogICAgICBpZiAocmVhc29uKSB7CiAgICAgICAgbXNnLmJvZHkuZGVzYyA9IHJlYXNvbjsKICAgICAgfQogICAgICBjb25zb2xlLmxvZygiK1tQMlBIYW5kbGVyU3R1Yl0gc2VuZGluZyBzdGF0dXMgdXBkYXRlOiAiLCBtc2cpOwogICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnKTsKICAgIH0KCiAgICAvKioKICAgICAqIEZpbHRlciBtZXRob2QgdGhhdCBzaG91bGQgYmUgdXNlZCBmb3IgZXZlcnkgbWVzc2FnZXMgaW4gZGlyZWN0aW9uOiBQcm90b3N0dWIgLT4gTWVzc2FnZU5vZGUKICAgICAqIEBwYXJhbSAge01lc3NhZ2V9IG1zZyBPcmlnaW5hbCBtZXNzYWdlIGZyb20gdGhlIE1lc3NhZ2VCdXMKICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IHRydWUgaWYgaXQncyB0byBiZSBkZWxpdmVyIGluIHRoZSBNZXNzYWdlTm9kZQogICAgICovCgogIH0sIHsKICAgIGtleTogJ19maWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maWx0ZXIobXNnKSB7CiAgICAgIC8vIHRvZG86IG9ubHkgdHJ5IHRvIHNlbmQgd2hlbiBjb25uZWN0ZWQgKGxpdmUgc3RhdHVzKQogICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkudmlhID09PSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMKSByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogTWV0aG9kIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gZGVsaXZlciB0aGUgbWVzc2FnZSBpbiBkaXJlY3Rpb246IFByb3Rvc3R1YiAtPiBNZXNzYWdlQnVzIChjb3JlKQogICAgICogQHBhcmFtICB7TWVzc2FnZX0gbXNnIE9yaWdpbmFsIG1lc3NhZ2UgZnJvbSB0aGUgTWVzc2FnZU5vZGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdfZGVsaXZlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGl2ZXIobXNnKSB7CgogICAgICBjb25zb2xlLmxvZygiK1tQMlBIYW5kbGVyU3R1Yl0gcG9zdGluZyBtZXNzYWdlIHRvIG1zZyBidXM6ICIsIG1zZyk7CiAgICAgIHZhciBtZXNzYWdlID0gSlNPTi5wYXJzZShtc2cuZGF0YSk7CgogICAgICBpZiAoIW1lc3NhZ2UuYm9keSkgbXNnLmJvZHkgPSB7fTsKCiAgICAgIG1lc3NhZ2UuYm9keS52aWEgPSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMOwogICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UobWVzc2FnZSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUDJQSGFuZGxlclN0dWI7Cn0oKTsKCmZ1bmN0aW9uIGFjdGl2YXRlKHVybCwgYnVzLCBjb25maWcpIHsKICByZXR1cm4gewogICAgbmFtZTogJ1AyUEhhbmRsZXJTdHViJywKICAgIGluc3RhbmNlOiBuZXcgUDJQSGFuZGxlclN0dWIodXJsLCBidXMsIGNvbmZpZykKICB9Owp9Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4vQ29ubmVjdGlvbkNvbnRyb2xsZXIiOjEyLCJzZXJ2aWNlLWZyYW1ld29yay9kaXN0L1N5bmNoZXIiOjJ9XX0se30sWzEzXSkoMTMpCn0pOw==",
      "sourceCodeClassname": "P2PHandlerProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-6f652c34-f0d9-fb93-9407-7f3e29ded6aa2",
    "version": 0.7999999999999999,
    "description": "Description of P2PHandlerProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "P2PHandlerProtoStub",
    "configuration": {
      "iceServers": [
        {
          "urls": "stun:stun.voiparound.com"
        },
        {
          "urls": "stun:stun.voipbuster.com"
        },
        {
          "urls": "stun:stun.voipstunt.com"
        },
        {
          "urls": "stun:stun.voxgratia.org"
        },
        {
          "urls": "stun:stun.ekiga.net"
        },
        {
          "urls": "stun:stun.schlund.de"
        },
        {
          "urls": "stun:stun.iptel.org"
        },
        {
          "urls": "stun:stun.l.google.com:19302"
        },
        {
          "urls": "stun:stun1.l.google.com:19302"
        },
        {
          "urls": "stun:stun.ideasip.com"
        },
        {
          "urls": "stun:stun4.l.google.com:19302"
        },
        {
          "urls": "stun:stun2.l.google.com:19302"
        },
        {
          "urls": "stun:stun3.l.google.com:19302"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=tcp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=udp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:numb.viagenie.ca",
          "credential": "muazkh",
          "username": "webrtc@live.com"
        }
      ]
    },
    "messageSchemas": "",
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": "{ windowSandbox: true }",
    "interworking": false,
    "dataObjects": []
  },
  "P2PRequesterProtoStub": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBTRFAgaGVscGVycy4KdmFyIFNEUFV0aWxzID0ge307CgovLyBHZW5lcmF0ZSBhbiBhbHBoYW51bWVyaWMgaWRlbnRpZmllciBmb3IgY25hbWUgb3IgbWlkcy4KLy8gVE9ETzogdXNlIFVVSURzIGluc3RlYWQ/IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2plZC85ODI4ODMKU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCAxMCk7Cn07CgovLyBUaGUgUlRDUCBDTkFNRSB1c2VkIGJ5IGFsbCBwZWVyY29ubmVjdGlvbnMgZnJvbSB0aGUgc2FtZSBKUy4KU0RQVXRpbHMubG9jYWxDTmFtZSA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwoKLy8gU3BsaXRzIFNEUCBpbnRvIGxpbmVzLCBkZWFsaW5nIHdpdGggYm90aCBDUkxGIGFuZCBMRi4KU0RQVXRpbHMuc3BsaXRMaW5lcyA9IGZ1bmN0aW9uKGJsb2IpIHsKICByZXR1cm4gYmxvYi50cmltKCkuc3BsaXQoJ1xuJykubWFwKGZ1bmN0aW9uKGxpbmUpIHsKICAgIHJldHVybiBsaW5lLnRyaW0oKTsKICB9KTsKfTsKLy8gU3BsaXRzIFNEUCBpbnRvIHNlc3Npb25wYXJ0IGFuZCBtZWRpYXNlY3Rpb25zLiBFbnN1cmVzIENSTEYuClNEUFV0aWxzLnNwbGl0U2VjdGlvbnMgPSBmdW5jdGlvbihibG9iKSB7CiAgdmFyIHBhcnRzID0gYmxvYi5zcGxpdCgnXG5tPScpOwogIHJldHVybiBwYXJ0cy5tYXAoZnVuY3Rpb24ocGFydCwgaW5kZXgpIHsKICAgIHJldHVybiAoaW5kZXggPiAwID8gJ209JyArIHBhcnQgOiBwYXJ0KS50cmltKCkgKyAnXHJcbic7CiAgfSk7Cn07CgovLyBSZXR1cm5zIGxpbmVzIHRoYXQgc3RhcnQgd2l0aCBhIGNlcnRhaW4gcHJlZml4LgpTRFBVdGlscy5tYXRjaFByZWZpeCA9IGZ1bmN0aW9uKGJsb2IsIHByZWZpeCkgewogIHJldHVybiBTRFBVdGlscy5zcGxpdExpbmVzKGJsb2IpLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gbGluZS5pbmRleE9mKHByZWZpeCkgPT09IDA7CiAgfSk7Cn07CgovLyBQYXJzZXMgYW4gSUNFIGNhbmRpZGF0ZSBsaW5lLiBTYW1wbGUgaW5wdXQ6Ci8vIGNhbmRpZGF0ZTo3MDI3ODYzNTAgMiB1ZHAgNDE4MTk5MDIgOC44LjguOCA2MDc2OSB0eXAgcmVsYXkgcmFkZHIgOC44LjguOAovLyBycG9ydCA1NTk5NiIKU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzOwogIC8vIFBhcnNlIGJvdGggdmFyaWFudHMuCiAgaWYgKGxpbmUuaW5kZXhPZignYT1jYW5kaWRhdGU6JykgPT09IDApIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTIpLnNwbGl0KCcgJyk7CiAgfSBlbHNlIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTApLnNwbGl0KCcgJyk7CiAgfQoKICB2YXIgY2FuZGlkYXRlID0gewogICAgZm91bmRhdGlvbjogcGFydHNbMF0sCiAgICBjb21wb25lbnQ6IHBhcnRzWzFdLAogICAgcHJvdG9jb2w6IHBhcnRzWzJdLnRvTG93ZXJDYXNlKCksCiAgICBwcmlvcml0eTogcGFyc2VJbnQocGFydHNbM10sIDEwKSwKICAgIGlwOiBwYXJ0c1s0XSwKICAgIHBvcnQ6IHBhcnNlSW50KHBhcnRzWzVdLCAxMCksCiAgICAvLyBza2lwIHBhcnRzWzZdID09ICd0eXAnCiAgICB0eXBlOiBwYXJ0c1s3XQogIH07CgogIGZvciAodmFyIGkgPSA4OyBpIDwgcGFydHMubGVuZ3RoOyBpICs9IDIpIHsKICAgIHN3aXRjaCAocGFydHNbaV0pIHsKICAgICAgY2FzZSAncmFkZHInOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAncnBvcnQnOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCA9IHBhcnNlSW50KHBhcnRzW2kgKyAxXSwgMTApOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICd0Y3B0eXBlJzoKICAgICAgICBjYW5kaWRhdGUudGNwVHlwZSA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDogLy8gVW5rbm93biBleHRlbnNpb25zIGFyZSBzaWxlbnRseSBpZ25vcmVkLgogICAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gY2FuZGlkYXRlOwp9OwoKLy8gVHJhbnNsYXRlcyBhIGNhbmRpZGF0ZSBvYmplY3QgaW50byBTRFAgY2FuZGlkYXRlIGF0dHJpYnV0ZS4KU0RQVXRpbHMud3JpdGVDYW5kaWRhdGUgPSBmdW5jdGlvbihjYW5kaWRhdGUpIHsKICB2YXIgc2RwID0gW107CiAgc2RwLnB1c2goY2FuZGlkYXRlLmZvdW5kYXRpb24pOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5jb21wb25lbnQpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5wcm90b2NvbC50b1VwcGVyQ2FzZSgpKTsKICBzZHAucHVzaChjYW5kaWRhdGUucHJpb3JpdHkpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5pcCk7CiAgc2RwLnB1c2goY2FuZGlkYXRlLnBvcnQpOwoKICB2YXIgdHlwZSA9IGNhbmRpZGF0ZS50eXBlOwogIHNkcC5wdXNoKCd0eXAnKTsKICBzZHAucHVzaCh0eXBlKTsKICBpZiAodHlwZSAhPT0gJ2hvc3QnICYmIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyAmJgogICAgICBjYW5kaWRhdGUucmVsYXRlZFBvcnQpIHsKICAgIHNkcC5wdXNoKCdyYWRkcicpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnJlbGF0ZWRBZGRyZXNzKTsgLy8gd2FzOiByZWxBZGRyCiAgICBzZHAucHVzaCgncnBvcnQnKTsKICAgIHNkcC5wdXNoKGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCk7IC8vIHdhczogcmVsUG9ydAogIH0KICBpZiAoY2FuZGlkYXRlLnRjcFR5cGUgJiYgY2FuZGlkYXRlLnByb3RvY29sLnRvTG93ZXJDYXNlKCkgPT09ICd0Y3AnKSB7CiAgICBzZHAucHVzaCgndGNwdHlwZScpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnRjcFR5cGUpOwogIH0KICByZXR1cm4gJ2NhbmRpZGF0ZTonICsgc2RwLmpvaW4oJyAnKTsKfTsKCi8vIFBhcnNlcyBhbiBydHBtYXAgbGluZSwgcmV0dXJucyBSVENSdHBDb2RkZWNQYXJhbWV0ZXJzLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9cnRwbWFwOjExMSBvcHVzLzQ4MDAwLzIKU0RQVXRpbHMucGFyc2VSdHBNYXAgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIoOSkuc3BsaXQoJyAnKTsKICB2YXIgcGFyc2VkID0gewogICAgcGF5bG9hZFR5cGU6IHBhcnNlSW50KHBhcnRzLnNoaWZ0KCksIDEwKSAvLyB3YXM6IGlkCiAgfTsKCiAgcGFydHMgPSBwYXJ0c1swXS5zcGxpdCgnLycpOwoKICBwYXJzZWQubmFtZSA9IHBhcnRzWzBdOwogIHBhcnNlZC5jbG9ja1JhdGUgPSBwYXJzZUludChwYXJ0c1sxXSwgMTApOyAvLyB3YXM6IGNsb2NrcmF0ZQogIC8vIHdhczogY2hhbm5lbHMKICBwYXJzZWQubnVtQ2hhbm5lbHMgPSBwYXJ0cy5sZW5ndGggPT09IDMgPyBwYXJzZUludChwYXJ0c1syXSwgMTApIDogMTsKICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGUgYW4gYT1ydHBtYXAgbGluZSBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvcgovLyBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRwTWFwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgcmV0dXJuICdhPXJ0cG1hcDonICsgcHQgKyAnICcgKyBjb2RlYy5uYW1lICsgJy8nICsgY29kZWMuY2xvY2tSYXRlICsKICAgICAgKGNvZGVjLm51bUNoYW5uZWxzICE9PSAxID8gJy8nICsgY29kZWMubnVtQ2hhbm5lbHMgOiAnJykgKyAnXHJcbic7Cn07CgovLyBQYXJzZXMgYW4gYT1leHRtYXAgbGluZSAoaGVhZGVyZXh0ZW5zaW9uIGZyb20gUkZDIDUyODUpLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9ZXh0bWFwOjIgdXJuOmlldGY6cGFyYW1zOnJ0cC1oZHJleHQ6dG9mZnNldApTRFBVdGlscy5wYXJzZUV4dG1hcCA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cig5KS5zcGxpdCgnICcpOwogIHJldHVybiB7CiAgICBpZDogcGFyc2VJbnQocGFydHNbMF0sIDEwKSwKICAgIHVyaTogcGFydHNbMV0KICB9Owp9OwoKLy8gR2VuZXJhdGVzIGE9ZXh0bWFwIGxpbmUgZnJvbSBSVENSdHBIZWFkZXJFeHRlbnNpb25QYXJhbWV0ZXJzIG9yCi8vIFJUQ1J0cEhlYWRlckV4dGVuc2lvbi4KU0RQVXRpbHMud3JpdGVFeHRtYXAgPSBmdW5jdGlvbihoZWFkZXJFeHRlbnNpb24pIHsKICByZXR1cm4gJ2E9ZXh0bWFwOicgKyAoaGVhZGVyRXh0ZW5zaW9uLmlkIHx8IGhlYWRlckV4dGVuc2lvbi5wcmVmZXJyZWRJZCkgKwogICAgICAgJyAnICsgaGVhZGVyRXh0ZW5zaW9uLnVyaSArICdcclxuJzsKfTsKCi8vIFBhcnNlcyBhbiBmdG1wIGxpbmUsIHJldHVybnMgZGljdGlvbmFyeS4gU2FtcGxlIGlucHV0OgovLyBhPWZtdHA6OTYgdmJyPW9uO2NuZz1vbgovLyBBbHNvIGRlYWxzIHdpdGggdmJyPW9uOyBjbmc9b24KU0RQVXRpbHMucGFyc2VGbXRwID0gZnVuY3Rpb24obGluZSkgewogIHZhciBwYXJzZWQgPSB7fTsKICB2YXIga3Y7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIobGluZS5pbmRleE9mKCcgJykgKyAxKS5zcGxpdCgnOycpOwogIGZvciAodmFyIGogPSAwOyBqIDwgcGFydHMubGVuZ3RoOyBqKyspIHsKICAgIGt2ID0gcGFydHNbal0udHJpbSgpLnNwbGl0KCc9Jyk7CiAgICBwYXJzZWRba3ZbMF0udHJpbSgpXSA9IGt2WzFdOwogIH0KICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGVzIGFuIGE9ZnRtcCBsaW5lIGZyb20gUlRDUnRwQ29kZWNDYXBhYmlsaXR5IG9yIFJUQ1J0cENvZGVjUGFyYW1ldGVycy4KU0RQVXRpbHMud3JpdGVGbXRwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZSA9ICcnOwogIHZhciBwdCA9IGNvZGVjLnBheWxvYWRUeXBlOwogIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICBwdCA9IGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlOwogIH0KICBpZiAoY29kZWMucGFyYW1ldGVycyAmJiBPYmplY3Qua2V5cyhjb2RlYy5wYXJhbWV0ZXJzKS5sZW5ndGgpIHsKICAgIHZhciBwYXJhbXMgPSBbXTsKICAgIE9iamVjdC5rZXlzKGNvZGVjLnBhcmFtZXRlcnMpLmZvckVhY2goZnVuY3Rpb24ocGFyYW0pIHsKICAgICAgcGFyYW1zLnB1c2gocGFyYW0gKyAnPScgKyBjb2RlYy5wYXJhbWV0ZXJzW3BhcmFtXSk7CiAgICB9KTsKICAgIGxpbmUgKz0gJ2E9Zm10cDonICsgcHQgKyAnICcgKyBwYXJhbXMuam9pbignOycpICsgJ1xyXG4nOwogIH0KICByZXR1cm4gbGluZTsKfTsKCi8vIFBhcnNlcyBhbiBydGNwLWZiIGxpbmUsIHJldHVybnMgUlRDUFJ0Y3BGZWVkYmFjayBvYmplY3QuIFNhbXBsZSBpbnB1dDoKLy8gYT1ydGNwLWZiOjk4IG5hY2sgcnBzaQpTRFBVdGlscy5wYXJzZVJ0Y3BGYiA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cihsaW5lLmluZGV4T2YoJyAnKSArIDEpLnNwbGl0KCcgJyk7CiAgcmV0dXJuIHsKICAgIHR5cGU6IHBhcnRzLnNoaWZ0KCksCiAgICBwYXJhbWV0ZXI6IHBhcnRzLmpvaW4oJyAnKQogIH07Cn07Ci8vIEdlbmVyYXRlIGE9cnRjcC1mYiBsaW5lcyBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvciBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRjcEZiID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZXMgPSAnJzsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgaWYgKGNvZGVjLnJ0Y3BGZWVkYmFjayAmJiBjb2RlYy5ydGNwRmVlZGJhY2subGVuZ3RoKSB7CiAgICAvLyBGSVhNRTogc3BlY2lhbCBoYW5kbGluZyBmb3IgdHJyLWludD8KICAgIGNvZGVjLnJ0Y3BGZWVkYmFjay5mb3JFYWNoKGZ1bmN0aW9uKGZiKSB7CiAgICAgIGxpbmVzICs9ICdhPXJ0Y3AtZmI6JyArIHB0ICsgJyAnICsgZmIudHlwZSArCiAgICAgIChmYi5wYXJhbWV0ZXIgJiYgZmIucGFyYW1ldGVyLmxlbmd0aCA/ICcgJyArIGZiLnBhcmFtZXRlciA6ICcnKSArCiAgICAgICAgICAnXHJcbic7CiAgICB9KTsKICB9CiAgcmV0dXJuIGxpbmVzOwp9OwoKLy8gUGFyc2VzIGFuIFJGQyA1NTc2IHNzcmMgbWVkaWEgYXR0cmlidXRlLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9c3NyYzozNzM1OTI4NTU5IGNuYW1lOnNvbWV0aGluZwpTRFBVdGlscy5wYXJzZVNzcmNNZWRpYSA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgc3AgPSBsaW5lLmluZGV4T2YoJyAnKTsKICB2YXIgcGFydHMgPSB7CiAgICBzc3JjOiBwYXJzZUludChsaW5lLnN1YnN0cig3LCBzcCAtIDcpLCAxMCkKICB9OwogIHZhciBjb2xvbiA9IGxpbmUuaW5kZXhPZignOicsIHNwKTsKICBpZiAoY29sb24gPiAtMSkgewogICAgcGFydHMuYXR0cmlidXRlID0gbGluZS5zdWJzdHIoc3AgKyAxLCBjb2xvbiAtIHNwIC0gMSk7CiAgICBwYXJ0cy52YWx1ZSA9IGxpbmUuc3Vic3RyKGNvbG9uICsgMSk7CiAgfSBlbHNlIHsKICAgIHBhcnRzLmF0dHJpYnV0ZSA9IGxpbmUuc3Vic3RyKHNwICsgMSk7CiAgfQogIHJldHVybiBwYXJ0czsKfTsKCi8vIEV4dHJhY3RzIERUTFMgcGFyYW1ldGVycyBmcm9tIFNEUCBtZWRpYSBzZWN0aW9uIG9yIHNlc3Npb25wYXJ0LgovLyBGSVhNRTogZm9yIGNvbnNpc3RlbmN5IHdpdGggb3RoZXIgZnVuY3Rpb25zIHRoaXMgc2hvdWxkIG9ubHkKLy8gICBnZXQgdGhlIGZpbmdlcnByaW50IGxpbmUgYXMgaW5wdXQuIFNlZSBhbHNvIGdldEljZVBhcmFtZXRlcnMuClNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBmcExpbmUgPSBsaW5lcy5maWx0ZXIoZnVuY3Rpb24obGluZSkgewogICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1maW5nZXJwcmludDonKSA9PT0gMDsKICB9KVswXS5zdWJzdHIoMTQpOwogIC8vIE5vdGU6IGE9c2V0dXAgbGluZSBpcyBpZ25vcmVkIHNpbmNlIHdlIHVzZSB0aGUgJ2F1dG8nIHJvbGUuCiAgdmFyIGR0bHNQYXJhbWV0ZXJzID0gewogICAgcm9sZTogJ2F1dG8nLAogICAgZmluZ2VycHJpbnRzOiBbewogICAgICBhbGdvcml0aG06IGZwTGluZS5zcGxpdCgnICcpWzBdLAogICAgICB2YWx1ZTogZnBMaW5lLnNwbGl0KCcgJylbMV0KICAgIH1dCiAgfTsKICByZXR1cm4gZHRsc1BhcmFtZXRlcnM7Cn07CgovLyBTZXJpYWxpemVzIERUTFMgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMgPSBmdW5jdGlvbihwYXJhbXMsIHNldHVwVHlwZSkgewogIHZhciBzZHAgPSAnYT1zZXR1cDonICsgc2V0dXBUeXBlICsgJ1xyXG4nOwogIHBhcmFtcy5maW5nZXJwcmludHMuZm9yRWFjaChmdW5jdGlvbihmcCkgewogICAgc2RwICs9ICdhPWZpbmdlcnByaW50OicgKyBmcC5hbGdvcml0aG0gKyAnICcgKyBmcC52YWx1ZSArICdcclxuJzsKICB9KTsKICByZXR1cm4gc2RwOwp9OwovLyBQYXJzZXMgSUNFIGluZm9ybWF0aW9uIGZyb20gU0RQIG1lZGlhIHNlY3Rpb24gb3Igc2Vzc2lvbnBhcnQuCi8vIEZJWE1FOiBmb3IgY29uc2lzdGVuY3kgd2l0aCBvdGhlciBmdW5jdGlvbnMgdGhpcyBzaG91bGQgb25seQovLyAgIGdldCB0aGUgaWNlLXVmcmFnIGFuZCBpY2UtcHdkIGxpbmVzIGFzIGlucHV0LgpTRFBVdGlscy5nZXRJY2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBpY2VQYXJhbWV0ZXJzID0gewogICAgdXNlcm5hbWVGcmFnbWVudDogbGluZXMuZmlsdGVyKGZ1bmN0aW9uKGxpbmUpIHsKICAgICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1pY2UtdWZyYWc6JykgPT09IDA7CiAgICB9KVswXS5zdWJzdHIoMTIpLAogICAgcGFzc3dvcmQ6IGxpbmVzLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICAgIHJldHVybiBsaW5lLmluZGV4T2YoJ2E9aWNlLXB3ZDonKSA9PT0gMDsKICAgIH0pWzBdLnN1YnN0cigxMCkKICB9OwogIHJldHVybiBpY2VQYXJhbWV0ZXJzOwp9OwoKLy8gU2VyaWFsaXplcyBJQ0UgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlSWNlUGFyYW1ldGVycyA9IGZ1bmN0aW9uKHBhcmFtcykgewogIHJldHVybiAnYT1pY2UtdWZyYWc6JyArIHBhcmFtcy51c2VybmFtZUZyYWdtZW50ICsgJ1xyXG4nICsKICAgICAgJ2E9aWNlLXB3ZDonICsgcGFyYW1zLnBhc3N3b3JkICsgJ1xyXG4nOwp9OwoKLy8gUGFyc2VzIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBhbmQgcmV0dXJucyBSVENSdHBQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHsKICB2YXIgZGVzY3JpcHRpb24gPSB7CiAgICBjb2RlY3M6IFtdLAogICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICBmZWNNZWNoYW5pc21zOiBbXSwKICAgIHJ0Y3A6IFtdCiAgfTsKICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7CiAgdmFyIG1saW5lID0gbGluZXNbMF0uc3BsaXQoJyAnKTsKICBmb3IgKHZhciBpID0gMzsgaSA8IG1saW5lLmxlbmd0aDsgaSsrKSB7IC8vIGZpbmQgYWxsIGNvZGVjcyBmcm9tIG1saW5lWzMuLl0KICAgIHZhciBwdCA9IG1saW5lW2ldOwogICAgdmFyIHJ0cG1hcGxpbmUgPSBTRFBVdGlscy5tYXRjaFByZWZpeCgKICAgICAgICBtZWRpYVNlY3Rpb24sICdhPXJ0cG1hcDonICsgcHQgKyAnICcpWzBdOwogICAgaWYgKHJ0cG1hcGxpbmUpIHsKICAgICAgdmFyIGNvZGVjID0gU0RQVXRpbHMucGFyc2VSdHBNYXAocnRwbWFwbGluZSk7CiAgICAgIHZhciBmbXRwcyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1mbXRwOicgKyBwdCArICcgJyk7CiAgICAgIC8vIE9ubHkgdGhlIGZpcnN0IGE9Zm10cDo8cHQ+IGlzIGNvbnNpZGVyZWQuCiAgICAgIGNvZGVjLnBhcmFtZXRlcnMgPSBmbXRwcy5sZW5ndGggPyBTRFBVdGlscy5wYXJzZUZtdHAoZm10cHNbMF0pIDoge307CiAgICAgIGNvZGVjLnJ0Y3BGZWVkYmFjayA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1ydGNwLWZiOicgKyBwdCArICcgJykKICAgICAgICAubWFwKFNEUFV0aWxzLnBhcnNlUnRjcEZiKTsKICAgICAgZGVzY3JpcHRpb24uY29kZWNzLnB1c2goY29kZWMpOwogICAgICAvLyBwYXJzZSBGRUMgbWVjaGFuaXNtcyBmcm9tIHJ0cG1hcCBsaW5lcy4KICAgICAgc3dpdGNoIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkpIHsKICAgICAgICBjYXNlICdSRUQnOgogICAgICAgIGNhc2UgJ1VMUEZFQyc6CiAgICAgICAgICBkZXNjcmlwdGlvbi5mZWNNZWNoYW5pc21zLnB1c2goY29kZWMubmFtZS50b1VwcGVyQ2FzZSgpKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IC8vIG9ubHkgUkVEIGFuZCBVTFBGRUMgYXJlIHJlY29nbml6ZWQgYXMgRkVDIG1lY2hhbmlzbXMuCiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0KICBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPWV4dG1hcDonKS5mb3JFYWNoKGZ1bmN0aW9uKGxpbmUpIHsKICAgIGRlc2NyaXB0aW9uLmhlYWRlckV4dGVuc2lvbnMucHVzaChTRFBVdGlscy5wYXJzZUV4dG1hcChsaW5lKSk7CiAgfSk7CiAgLy8gRklYTUU6IHBhcnNlIHJ0Y3AuCiAgcmV0dXJuIGRlc2NyaXB0aW9uOwp9OwoKLy8gR2VuZXJhdGVzIHBhcnRzIG9mIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBkZXNjcmliaW5nIHRoZSBjYXBhYmlsaXRpZXMgLwovLyBwYXJhbWV0ZXJzLgpTRFBVdGlscy53cml0ZVJ0cERlc2NyaXB0aW9uID0gZnVuY3Rpb24oa2luZCwgY2FwcykgewogIHZhciBzZHAgPSAnJzsKCiAgLy8gQnVpbGQgdGhlIG1saW5lLgogIHNkcCArPSAnbT0nICsga2luZCArICcgJzsKICBzZHAgKz0gY2Fwcy5jb2RlY3MubGVuZ3RoID4gMCA/ICc5JyA6ICcwJzsgLy8gcmVqZWN0IGlmIG5vIGNvZGVjcy4KICBzZHAgKz0gJyBVRFAvVExTL1JUUC9TQVZQRiAnOwogIHNkcCArPSBjYXBzLmNvZGVjcy5tYXAoZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICAgIH0KICAgIHJldHVybiBjb2RlYy5wYXlsb2FkVHlwZTsKICB9KS5qb2luKCcgJykgKyAnXHJcbic7CgogIHNkcCArPSAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nOwogIHNkcCArPSAnYT1ydGNwOjkgSU4gSVA0IDAuMC4wLjBcclxuJzsKCiAgLy8gQWRkIGE9cnRwbWFwIGxpbmVzIGZvciBlYWNoIGNvZGVjLiBBbHNvIGZtdHAgYW5kIHJ0Y3AtZmIuCiAgY2Fwcy5jb2RlY3MuZm9yRWFjaChmdW5jdGlvbihjb2RlYykgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRwTWFwKGNvZGVjKTsKICAgIHNkcCArPSBTRFBVdGlscy53cml0ZUZtdHAoY29kZWMpOwogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRjcEZiKGNvZGVjKTsKICB9KTsKICB2YXIgbWF4cHRpbWUgPSAwOwogIGNhcHMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5tYXhwdGltZSA+IG1heHB0aW1lKSB7CiAgICAgIG1heHB0aW1lID0gY29kZWMubWF4cHRpbWU7CiAgICB9CiAgfSk7CiAgaWYgKG1heHB0aW1lID4gMCkgewogICAgc2RwICs9ICdhPW1heHB0aW1lOicgKyBtYXhwdGltZSArICdcclxuJzsKICB9CiAgc2RwICs9ICdhPXJ0Y3AtbXV4XHJcbic7CgogIGNhcHMuaGVhZGVyRXh0ZW5zaW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGV4dGVuc2lvbikgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlRXh0bWFwKGV4dGVuc2lvbik7CiAgfSk7CiAgLy8gRklYTUU6IHdyaXRlIGZlY01lY2hhbmlzbXMuCiAgcmV0dXJuIHNkcDsKfTsKCi8vIFBhcnNlcyB0aGUgU0RQIG1lZGlhIHNlY3Rpb24gYW5kIHJldHVybnMgYW4gYXJyYXkgb2YKLy8gUlRDUnRwRW5jb2RpbmdQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cEVuY29kaW5nUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikgewogIHZhciBlbmNvZGluZ1BhcmFtZXRlcnMgPSBbXTsKICB2YXIgZGVzY3JpcHRpb24gPSBTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMobWVkaWFTZWN0aW9uKTsKICB2YXIgaGFzUmVkID0gZGVzY3JpcHRpb24uZmVjTWVjaGFuaXNtcy5pbmRleE9mKCdSRUQnKSAhPT0gLTE7CiAgdmFyIGhhc1VscGZlYyA9IGRlc2NyaXB0aW9uLmZlY01lY2hhbmlzbXMuaW5kZXhPZignVUxQRkVDJykgIT09IC0xOwoKICAvLyBmaWx0ZXIgYT1zc3JjOi4uLiBjbmFtZTosIGlnbm9yZSBQbGFuQi1tc2lkCiAgdmFyIHNzcmNzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjOicpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgfSkKICAuZmlsdGVyKGZ1bmN0aW9uKHBhcnRzKSB7CiAgICByZXR1cm4gcGFydHMuYXR0cmlidXRlID09PSAnY25hbWUnOwogIH0pOwogIHZhciBwcmltYXJ5U3NyYyA9IHNzcmNzLmxlbmd0aCA+IDAgJiYgc3NyY3NbMF0uc3NyYzsKICB2YXIgc2Vjb25kYXJ5U3NyYzsKCiAgdmFyIGZsb3dzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjLWdyb3VwOkZJRCcpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICB2YXIgcGFydHMgPSBsaW5lLnNwbGl0KCcgJyk7CiAgICBwYXJ0cy5zaGlmdCgpOwogICAgcmV0dXJuIHBhcnRzLm1hcChmdW5jdGlvbihwYXJ0KSB7CiAgICAgIHJldHVybiBwYXJzZUludChwYXJ0LCAxMCk7CiAgICB9KTsKICB9KTsKICBpZiAoZmxvd3MubGVuZ3RoID4gMCAmJiBmbG93c1swXS5sZW5ndGggPiAxICYmIGZsb3dzWzBdWzBdID09PSBwcmltYXJ5U3NyYykgewogICAgc2Vjb25kYXJ5U3NyYyA9IGZsb3dzWzBdWzFdOwogIH0KCiAgZGVzY3JpcHRpb24uY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkgPT09ICdSVFgnICYmIGNvZGVjLnBhcmFtZXRlcnMuYXB0KSB7CiAgICAgIHZhciBlbmNQYXJhbSA9IHsKICAgICAgICBzc3JjOiBwcmltYXJ5U3NyYywKICAgICAgICBjb2RlY1BheWxvYWRUeXBlOiBwYXJzZUludChjb2RlYy5wYXJhbWV0ZXJzLmFwdCwgMTApLAogICAgICAgIHJ0eDogewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYwogICAgICAgIH0KICAgICAgfTsKICAgICAgZW5jb2RpbmdQYXJhbWV0ZXJzLnB1c2goZW5jUGFyYW0pOwogICAgICBpZiAoaGFzUmVkKSB7CiAgICAgICAgZW5jUGFyYW0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVuY1BhcmFtKSk7CiAgICAgICAgZW5jUGFyYW0uZmVjID0gewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYywKICAgICAgICAgIG1lY2hhbmlzbTogaGFzVWxwZmVjID8gJ3JlZCt1bHBmZWMnIDogJ3JlZCcKICAgICAgICB9OwogICAgICAgIGVuY29kaW5nUGFyYW1ldGVycy5wdXNoKGVuY1BhcmFtKTsKICAgICAgfQogICAgfQogIH0pOwogIGlmIChlbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoID09PSAwICYmIHByaW1hcnlTc3JjKSB7CiAgICBlbmNvZGluZ1BhcmFtZXRlcnMucHVzaCh7CiAgICAgIHNzcmM6IHByaW1hcnlTc3JjCiAgICB9KTsKICB9CgogIC8vIHdlIHN1cHBvcnQgYm90aCBiPUFTIGFuZCBiPVRJQVMgYnV0IGludGVycHJldCBBUyBhcyBUSUFTLgogIHZhciBiYW5kd2lkdGggPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdiPScpOwogIGlmIChiYW5kd2lkdGgubGVuZ3RoKSB7CiAgICBpZiAoYmFuZHdpZHRoWzBdLmluZGV4T2YoJ2I9VElBUzonKSA9PT0gMCkgewogICAgICBiYW5kd2lkdGggPSBwYXJzZUludChiYW5kd2lkdGhbMF0uc3Vic3RyKDcpLCAxMCk7CiAgICB9IGVsc2UgaWYgKGJhbmR3aWR0aFswXS5pbmRleE9mKCdiPUFTOicpID09PSAwKSB7CiAgICAgIGJhbmR3aWR0aCA9IHBhcnNlSW50KGJhbmR3aWR0aFswXS5zdWJzdHIoNSksIDEwKTsKICAgIH0KICAgIGVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtcykgewogICAgICBwYXJhbXMubWF4Qml0cmF0ZSA9IGJhbmR3aWR0aDsKICAgIH0pOwogIH0KICByZXR1cm4gZW5jb2RpbmdQYXJhbWV0ZXJzOwp9OwoKU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUgPSBmdW5jdGlvbigpIHsKICAvLyBGSVhNRTogc2Vzcy1pZCBzaG91bGQgYmUgYW4gTlRQIHRpbWVzdGFtcC4KICByZXR1cm4gJ3Y9MFxyXG4nICsKICAgICAgJ289dGhpc2lzYWRhcHRlcm9ydGMgODE2OTYzOTkxNTY0Njk0MzEzNyAyIElOIElQNCAxMjcuMC4wLjFcclxuJyArCiAgICAgICdzPS1cclxuJyArCiAgICAgICd0PTAgMFxyXG4nOwp9OwoKU0RQVXRpbHMud3JpdGVNZWRpYVNlY3Rpb24gPSBmdW5jdGlvbih0cmFuc2NlaXZlciwgY2FwcywgdHlwZSwgc3RyZWFtKSB7CiAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlUnRwRGVzY3JpcHRpb24odHJhbnNjZWl2ZXIua2luZCwgY2Fwcyk7CgogIC8vIE1hcCBJQ0UgcGFyYW1ldGVycyAodWZyYWcsIHB3ZCkgdG8gU0RQLgogIHNkcCArPSBTRFBVdGlscy53cml0ZUljZVBhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmdldExvY2FsUGFyYW1ldGVycygpKTsKCiAgLy8gTWFwIERUTFMgcGFyYW1ldGVycyB0byBTRFAuCiAgc2RwICs9IFNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuZ2V0TG9jYWxQYXJhbWV0ZXJzKCksCiAgICAgIHR5cGUgPT09ICdvZmZlcicgPyAnYWN0cGFzcycgOiAnYWN0aXZlJyk7CgogIHNkcCArPSAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlciAmJiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcikgewogICAgc2RwICs9ICdhPXNlbmRyZWN2XHJcbic7CiAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHsKICAgIHNkcCArPSAnYT1zZW5kb25seVxyXG4nOwogIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgIHNkcCArPSAnYT1yZWN2b25seVxyXG4nOwogIH0gZWxzZSB7CiAgICBzZHAgKz0gJ2E9aW5hY3RpdmVcclxuJzsKICB9CgogIC8vIEZJWE1FOiBmb3IgUlRYIHRoZXJlIG1pZ2h0IGJlIG11bHRpcGxlIFNTUkNzLiBOb3QgaW1wbGVtZW50ZWQgaW4gRWRnZSB5ZXQuCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlcikgewogICAgdmFyIG1zaWQgPSAnbXNpZDonICsgc3RyZWFtLmlkICsgJyAnICsKICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIudHJhY2suaWQgKyAnXHJcbic7CiAgICBzZHAgKz0gJ2E9JyArIG1zaWQ7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgICAnICcgKyBtc2lkOwogICAgaWYgKHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICAgIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICcgJyArIG1zaWQ7CiAgICAgIHNkcCArPSAnYT1zc3JjLWdyb3VwOkZJRCAnICsKICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYyArICcgJyArCiAgICAgICAgICB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICdcclxuJzsKICAgIH0KICB9CiAgLy8gRklYTUU6IHRoaXMgc2hvdWxkIGJlIHdyaXR0ZW4gYnkgd3JpdGVSdHBEZXNjcmlwdGlvbi4KICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHguc3NyYyArCiAgICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICB9CiAgcmV0dXJuIHNkcDsKfTsKCi8vIEdldHMgdGhlIGRpcmVjdGlvbiBmcm9tIHRoZSBtZWRpYVNlY3Rpb24gb3IgdGhlIHNlc3Npb25wYXJ0LgpTRFBVdGlscy5nZXREaXJlY3Rpb24gPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KSB7CiAgLy8gTG9vayBmb3Igc2VuZHJlY3YsIHNlbmRvbmx5LCByZWN2b25seSwgaW5hY3RpdmUsIGRlZmF1bHQgdG8gc2VuZHJlY3YuCiAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHsKICAgIHN3aXRjaCAobGluZXNbaV0pIHsKICAgICAgY2FzZSAnYT1zZW5kcmVjdic6CiAgICAgIGNhc2UgJ2E9c2VuZG9ubHknOgogICAgICBjYXNlICdhPXJlY3Zvbmx5JzoKICAgICAgY2FzZSAnYT1pbmFjdGl2ZSc6CiAgICAgICAgcmV0dXJuIGxpbmVzW2ldLnN1YnN0cigyKTsKICAgICAgZGVmYXVsdDoKICAgICAgICAvLyBGSVhNRTogV2hhdCBzaG91bGQgaGFwcGVuIGhlcmU/CiAgICB9CiAgfQogIGlmIChzZXNzaW9ucGFydCkgewogICAgcmV0dXJuIFNEUFV0aWxzLmdldERpcmVjdGlvbihzZXNzaW9ucGFydCk7CiAgfQogIHJldHVybiAnc2VuZHJlY3YnOwp9OwoKLy8gRXhwb3NlIHB1YmxpYyBtZXRob2RzLgptb2R1bGUuZXhwb3J0cyA9IFNEUFV0aWxzOwoKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8vIHZlcnNpb246IDAuNS4xCi8vIGRhdGU6IFR1ZSBGZWIgMDcgMjAxNyAxNjowMDozOSBHTVQrMDAwMCAoV0VUKQovLyBsaWNlbmNlOiAKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgoKKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiU3luY2hlciIsIFtdLCBmYWN0b3J5KTsKCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCWV4cG9ydHNbIlN5bmNoZXIiXSA9IGZhY3RvcnkoKTsKCWVsc2UKCQlyb290WyIiXSA9IHJvb3RbIiJdIHx8IHt9LCByb290WyIiXVsiU3luY2hlciJdID0gZmFjdG9yeSgpOwp9KSh0aGlzLCBmdW5jdGlvbigpIHsKcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXAKLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCXZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307Ci8qKioqKiovCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLwovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQovKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJaTogbW9kdWxlSWQsCi8qKioqKiovIAkJCWw6IGZhbHNlLAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAovKioqKioqLyAJCW1vZHVsZS5sID0gdHJ1ZTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8KLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7Ci8qKioqKiovCi8qKioqKiovIAkvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0Ci8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHMKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikgewovKioqKioqLyAJCWlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKLyoqKioqKi8gCQkJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsKLyoqKioqKi8gCQkJCWNvbmZpZ3VyYWJsZTogZmFsc2UsCi8qKioqKiovIAkJCQllbnVtZXJhYmxlOiB0cnVlLAovKioqKioqLyAJCQkJZ2V0OiBnZXR0ZXIKLyoqKioqKi8gCQkJfSk7Ci8qKioqKiovIAkJfQovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHsKLyoqKioqKi8gCQl2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID8KLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTsKLyoqKioqKi8gCQlfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7Ci8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKLyoqKioqKi8KLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMTYyKTsKLyoqKioqKi8gfSkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gKFsKLyogMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0ge3ZlcnNpb246ICcyLjQuMCd9OwppZih0eXBlb2YgX19lID09ICdudW1iZXInKV9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy84NiNpc3N1ZWNvbW1lbnQtMTE1NzU5MDI4CnZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aAogID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsKaWYodHlwZW9mIF9fZyA9PSAnbnVtYmVyJylfX2cgPSBnbG9iYWw7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzdG9yZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ3drcycpCiAgLCB1aWQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykKICAsIFN5bWJvbCAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLlN5bWJvbAogICwgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJzsKCnZhciAkZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obmFtZSl7CiAgcmV0dXJuIHN0b3JlW25hbWVdIHx8IChzdG9yZVtuYW1lXSA9CiAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IHVpZCkoJ1N5bWJvbC4nICsgbmFtZSkpOwp9OwoKJGV4cG9ydHMuc3RvcmUgPSBzdG9yZTsKCi8qKiovIH0pLAovKiAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHkKbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGRQICAgICAgICAgICAgID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpewogIGFuT2JqZWN0KE8pOwogIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKICBhbk9iamVjdChBdHRyaWJ1dGVzKTsKICBpZihJRThfRE9NX0RFRklORSl0cnkgewogICAgcmV0dXJuIGRQKE8sIFAsIEF0dHJpYnV0ZXMpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICBpZignZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpdGhyb3cgVHlwZUVycm9yKCdBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEnKTsKICBpZigndmFsdWUnIGluIEF0dHJpYnV0ZXMpT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZighaXNPYmplY3QoaXQpKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKICAsIGNyZWF0ZURlc2MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpID8gZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICByZXR1cm4gZFAuZihvYmplY3QsIGtleSwgY3JlYXRlRGVzYygxLCB2YWx1ZSkpOwp9IDogZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICBvYmplY3Rba2V5XSA9IHZhbHVlOwogIHJldHVybiBvYmplY3Q7Cn07CgovKioqLyB9KSwKLyogNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nOwp9OwoKLyoqKi8gfSksCi8qIDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGNvcmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGN0eCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCiAgLCBoaWRlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCiAgLCBQUk9UT1RZUEUgPSAncHJvdG90eXBlJzsKCnZhciAkZXhwb3J0ID0gZnVuY3Rpb24odHlwZSwgbmFtZSwgc291cmNlKXsKICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRgogICAgLCBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HCiAgICAsIElTX1NUQVRJQyA9IHR5cGUgJiAkZXhwb3J0LlMKICAgICwgSVNfUFJPVE8gID0gdHlwZSAmICRleHBvcnQuUAogICAgLCBJU19CSU5EICAgPSB0eXBlICYgJGV4cG9ydC5CCiAgICAsIElTX1dSQVAgICA9IHR5cGUgJiAkZXhwb3J0LlcKICAgICwgZXhwb3J0cyAgID0gSVNfR0xPQkFMID8gY29yZSA6IGNvcmVbbmFtZV0gfHwgKGNvcmVbbmFtZV0gPSB7fSkKICAgICwgZXhwUHJvdG8gID0gZXhwb3J0c1tQUk9UT1RZUEVdCiAgICAsIHRhcmdldCAgICA9IElTX0dMT0JBTCA/IGdsb2JhbCA6IElTX1NUQVRJQyA/IGdsb2JhbFtuYW1lXSA6IChnbG9iYWxbbmFtZV0gfHwge30pW1BST1RPVFlQRV0KICAgICwga2V5LCBvd24sIG91dDsKICBpZihJU19HTE9CQUwpc291cmNlID0gbmFtZTsKICBmb3Ioa2V5IGluIHNvdXJjZSl7CiAgICAvLyBjb250YWlucyBpbiBuYXRpdmUKICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIHRhcmdldFtrZXldICE9PSB1bmRlZmluZWQ7CiAgICBpZihvd24gJiYga2V5IGluIGV4cG9ydHMpY29udGludWU7CiAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZAogICAgb3V0ID0gb3duID8gdGFyZ2V0W2tleV0gOiBzb3VyY2Vba2V5XTsKICAgIC8vIHByZXZlbnQgZ2xvYmFsIHBvbGx1dGlvbiBmb3IgbmFtZXNwYWNlcwogICAgZXhwb3J0c1trZXldID0gSVNfR0xPQkFMICYmIHR5cGVvZiB0YXJnZXRba2V5XSAhPSAnZnVuY3Rpb24nID8gc291cmNlW2tleV0KICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0CiAgICA6IElTX0JJTkQgJiYgb3duID8gY3R4KG91dCwgZ2xvYmFsKQogICAgLy8gd3JhcCBnbG9iYWwgY29uc3RydWN0b3JzIGZvciBwcmV2ZW50IGNoYW5nZSB0aGVtIGluIGxpYnJhcnkKICAgIDogSVNfV1JBUCAmJiB0YXJnZXRba2V5XSA9PSBvdXQgPyAoZnVuY3Rpb24oQyl7CiAgICAgIHZhciBGID0gZnVuY3Rpb24oYSwgYiwgYyl7CiAgICAgICAgaWYodGhpcyBpbnN0YW5jZW9mIEMpewogICAgICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpewogICAgICAgICAgICBjYXNlIDA6IHJldHVybiBuZXcgQzsKICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gbmV3IEMoYSk7CiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBDKGEsIGIpOwogICAgICAgICAgfSByZXR1cm4gbmV3IEMoYSwgYiwgYyk7CiAgICAgICAgfSByZXR1cm4gQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgICBGW1BST1RPVFlQRV0gPSBDW1BST1RPVFlQRV07CiAgICAgIHJldHVybiBGOwogICAgLy8gbWFrZSBzdGF0aWMgdmVyc2lvbnMgZm9yIHByb3RvdHlwZSBtZXRob2RzCiAgICB9KShvdXQpIDogSVNfUFJPVE8gJiYgdHlwZW9mIG91dCA9PSAnZnVuY3Rpb24nID8gY3R4KEZ1bmN0aW9uLmNhbGwsIG91dCkgOiBvdXQ7CiAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUubWV0aG9kcy4lTkFNRSUKICAgIGlmKElTX1BST1RPKXsKICAgICAgKGV4cG9ydHMudmlydHVhbCB8fCAoZXhwb3J0cy52aXJ0dWFsID0ge30pKVtrZXldID0gb3V0OwogICAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUucHJvdG90eXBlLiVOQU1FJQogICAgICBpZih0eXBlICYgJGV4cG9ydC5SICYmIGV4cFByb3RvICYmICFleHBQcm90b1trZXldKWhpZGUoZXhwUHJvdG8sIGtleSwgb3V0KTsKICAgIH0KICB9Cn07Ci8vIHR5cGUgYml0bWFwCiRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkCiRleHBvcnQuRyA9IDI7ICAgLy8gZ2xvYmFsCiRleHBvcnQuUyA9IDQ7ICAgLy8gc3RhdGljCiRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG8KJGV4cG9ydC5CID0gMTY7ICAvLyBiaW5kCiRleHBvcnQuVyA9IDMyOyAgLy8gd3JhcAokZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmUKJGV4cG9ydC5SID0gMTI4OyAvLyByZWFsIHByb3RvIG1ldGhvZCBmb3IgYGxpYnJhcnlgIAptb2R1bGUuZXhwb3J0cyA9ICRleHBvcnQ7CgovKioqLyB9KSwKLyogOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDEwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMzYpOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZWZpbmVQcm9wZXJ0eSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICAgICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogICAgfQogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICAgIHJldHVybiBDb25zdHJ1Y3RvcjsKICB9Owp9KCk7CgovKioqLyB9KSwKLyogMTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjKXsKICB0cnkgewogICAgcmV0dXJuICEhZXhlYygpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn07CgovKioqLyB9KSwKLyogMTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGhhc093blByb3BlcnR5ID0ge30uaGFzT3duUHJvcGVydHk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIGtleSl7CiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoaXQsIGtleSk7Cn07CgovKioqLyB9KSwKLyogMTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzCnZhciBJT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NikKICAsIGRlZmluZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpOwp9OwoKLyoqKi8gfSksCi8qIDE0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZwp2YXIgYUZ1bmN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIHRoYXQsIGxlbmd0aCl7CiAgYUZ1bmN0aW9uKGZuKTsKICBpZih0aGF0ID09PSB1bmRlZmluZWQpcmV0dXJuIGZuOwogIHN3aXRjaChsZW5ndGgpewogICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpOwogICAgfTsKICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTsKICAgIH07CiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7CiAgICB9OwogIH0KICByZXR1cm4gZnVuY3Rpb24oLyogLi4uYXJncyAqLyl7CiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDE1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0ge307CgovKioqLyB9KSwKLyogMTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiaXRtYXAsIHZhbHVlKXsKICByZXR1cm4gewogICAgZW51bWVyYWJsZSAgOiAhKGJpdG1hcCAmIDEpLAogICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLAogICAgd3JpdGFibGUgICAgOiAhKGJpdG1hcCAmIDQpLAogICAgdmFsdWUgICAgICAgOiB2YWx1ZQogIH07Cn07CgovKioqLyB9KSwKLyogMTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjE0IC8gMTUuMi4zLjE0IE9iamVjdC5rZXlzKE8pCnZhciAka2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpOwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pewogIHJldHVybiAka2V5cyhPLCBlbnVtQnVnS2V5cyk7Cn07CgovKioqLyB9KSwKLyogMTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpOwp9OwoKLyoqKi8gfSksCi8qIDE5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5kb2N1bWVudAogIC8vIGluIG9sZCBJRSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JwogICwgaXMgPSBpc09iamVjdChkb2N1bWVudCkgJiYgaXNPYmplY3QoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307Cn07CgovKioqLyB9KSwKLyogMjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRlZiA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaGFzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIFRBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3RvU3RyaW5nVGFnJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCB0YWcsIHN0YXQpewogIGlmKGl0ICYmICFoYXMoaXQgPSBzdGF0ID8gaXQgOiBpdC5wcm90b3R5cGUsIFRBRykpZGVmKGl0LCBUQUcsIHtjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiB0YWd9KTsKfTsKCi8qKiovIH0pLAovKiAyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSkKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2UKLy8gYW5kIHRoZSBzZWNvbmQgYXJndW1lbnQgLSBmbGFnIC0gcHJlZmVycmVkIHR5cGUgaXMgYSBzdHJpbmcKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgUyl7CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gaXQ7CiAgdmFyIGZuLCB2YWw7CiAgaWYoUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIGlmKHR5cGVvZiAoZm4gPSBpdC52YWx1ZU9mKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICBpZighUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIHRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlIik7Cn07CgovKioqLyB9KSwKLyogMjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGlkID0gMAogICwgcHggPSBNYXRoLnJhbmRvbSgpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7CiAgcmV0dXJuICdTeW1ib2woJy5jb25jYXQoa2V5ID09PSB1bmRlZmluZWQgPyAnJyA6IGtleSwgJylfJywgKCsraWQgKyBweCkudG9TdHJpbmcoMzYpKTsKfTsKCi8qKiovIH0pLAovKiAyNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyA3LjIuMSBSZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGFyZ3VtZW50KQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIiArIGl0KTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSB0cnVlOwoKLyoqKi8gfSksCi8qIDI2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzaGFyZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKSgna2V5cycpCiAgLCB1aWQgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzaGFyZWRba2V5XSB8fCAoc2hhcmVkW2tleV0gPSB1aWQoa2V5KSk7Cn07CgovKioqLyB9KSwKLyogMjcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gNy4xLjQgVG9JbnRlZ2VyCnZhciBjZWlsICA9IE1hdGguY2VpbAogICwgZmxvb3IgPSBNYXRoLmZsb29yOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXNOYU4oaXQgPSAraXQpID8gMCA6IChpdCA+IDAgPyBmbG9vciA6IGNlaWwpKGl0KTsKfTsKCi8qKiovIH0pLAovKiAyOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzCm1vZHVsZS5leHBvcnRzID0gKAogICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnCikuc3BsaXQoJywnKTsKCi8qKiovIH0pLAovKiAyOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDMpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoX193ZWJwYWNrX3JlcXVpcmVfXygxOSkoJ2RpdicpLCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiAzMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXycKICAsIHN0b3JlICA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzdG9yZVtrZXldIHx8IChzdG9yZVtrZXldID0ge30pOwp9OwoKLyoqKi8gfSksCi8qIDMxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNzkpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogMzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KQp2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gT2JqZWN0KGRlZmluZWQoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAzMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfc2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc1KTsKCnZhciBfc2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jcmVhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc0KTsKCnZhciBfY3JlYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZSk7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHN1cGVyQ2xhc3MgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoc3VwZXJDbGFzcykpKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9ICgwLCBfY3JlYXRlMi5kZWZhdWx0KShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZjIuZGVmYXVsdCA/ICgwLCBfc2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7Cn07CgovKioqLyB9KSwKLyogMzQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzZWxmLCBjYWxsKSB7CiAgaWYgKCFzZWxmKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIGNhbGwgJiYgKCh0eXBlb2YgY2FsbCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6ICgwLCBfdHlwZW9mMy5kZWZhdWx0KShjYWxsKSkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOwp9OwoKLyoqKi8gfSksCi8qIDM1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQp2YXIgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBkUHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBFbXB0eSAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KICAsIFBST1RPVFlQRSAgID0gJ3Byb3RvdHlwZSc7CgovLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlCnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24oKXsKICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1ZwogIHZhciBpZnJhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KSgnaWZyYW1lJykKICAgICwgaSAgICAgID0gZW51bUJ1Z0tleXMubGVuZ3RoCiAgICAsIGx0ICAgICA9ICc8JwogICAgLCBndCAgICAgPSAnPicKICAgICwgaWZyYW1lRG9jdW1lbnQ7CiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg0MikuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsCiAgLy8gY3JlYXRlRGljdCA9IGlmcmFtZS5jb250ZW50V2luZG93Lk9iamVjdDsKICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7CiAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKICBpZnJhbWVEb2N1bWVudC5vcGVuKCk7CiAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpOwogIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7CiAgY3JlYXRlRGljdCA9IGlmcmFtZURvY3VtZW50LkY7CiAgd2hpbGUoaS0tKWRlbGV0ZSBjcmVhdGVEaWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbaV1dOwogIHJldHVybiBjcmVhdGVEaWN0KCk7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpewogIHZhciByZXN1bHQ7CiAgaWYoTyAhPT0gbnVsbCl7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7CiAgICByZXN1bHQgPSBuZXcgRW1wdHk7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gbnVsbDsKICAgIC8vIGFkZCAiX19wcm90b19fIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsCiAgICByZXN1bHRbSUVfUFJPVE9dID0gTzsKICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpOwogIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkUHMocmVzdWx0LCBQcm9wZXJ0aWVzKTsKfTsKCgovKioqLyB9KSwKLyogMzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygzNyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAzNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKXsKICByZXR1cm4gJE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKTsKfTsKCi8qKiovIH0pLAovKiAzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgTElCUkFSWSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBoaWRlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIEl0ZXJhdG9ycyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsICRpdGVyQ3JlYXRlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MikKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MykKICAsIElURVJBVE9SICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgQlVHR1kgICAgICAgICAgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSkgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YAogICwgRkZfSVRFUkFUT1IgICAgPSAnQEBpdGVyYXRvcicKICAsIEtFWVMgICAgICAgICAgID0gJ2tleXMnCiAgLCBWQUxVRVMgICAgICAgICA9ICd2YWx1ZXMnOwoKdmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKXsKICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7CiAgdmFyIGdldE1ldGhvZCA9IGZ1bmN0aW9uKGtpbmQpewogICAgaWYoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pcmV0dXJuIHByb3RvW2tpbmRdOwogICAgc3dpdGNoKGtpbmQpewogICAgICBjYXNlIEtFWVM6IHJldHVybiBmdW5jdGlvbiBrZXlzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgfTsKICB2YXIgVEFHICAgICAgICA9IE5BTUUgKyAnIEl0ZXJhdG9yJwogICAgLCBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVMKICAgICwgVkFMVUVTX0JVRyA9IGZhbHNlCiAgICAsIHByb3RvICAgICAgPSBCYXNlLnByb3RvdHlwZQogICAgLCAkbmF0aXZlICAgID0gcHJvdG9bSVRFUkFUT1JdIHx8IHByb3RvW0ZGX0lURVJBVE9SXSB8fCBERUZBVUxUICYmIHByb3RvW0RFRkFVTFRdCiAgICAsICRkZWZhdWx0ICAgPSAkbmF0aXZlIHx8IGdldE1ldGhvZChERUZBVUxUKQogICAgLCAkZW50cmllcyAgID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZAogICAgLCAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZQogICAgLCBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlOwogIC8vIEZpeCBuYXRpdmUKICBpZigkYW55TmF0aXZlKXsKICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoJGFueU5hdGl2ZS5jYWxsKG5ldyBCYXNlKSk7CiAgICBpZihJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSl7CiAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnMKICAgICAgc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JQcm90b3R5cGUsIFRBRywgdHJ1ZSk7CiAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lcwogICAgICBpZighTElCUkFSWSAmJiAhaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikpaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwogICAgfQogIH0KICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGCiAgaWYoREVGX1ZBTFVFUyAmJiAkbmF0aXZlICYmICRuYXRpdmUubmFtZSAhPT0gVkFMVUVTKXsKICAgIFZBTFVFU19CVUcgPSB0cnVlOwogICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTsKICB9CiAgLy8gRGVmaW5lIGl0ZXJhdG9yCiAgaWYoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpewogICAgaGlkZShwcm90bywgSVRFUkFUT1IsICRkZWZhdWx0KTsKICB9CiAgLy8gUGx1ZyBmb3IgbGlicmFyeQogIEl0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0OwogIEl0ZXJhdG9yc1tUQUddICA9IHJldHVyblRoaXM7CiAgaWYoREVGQVVMVCl7CiAgICBtZXRob2RzID0gewogICAgICB2YWx1ZXM6ICBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSwKICAgICAga2V5czogICAgSVNfU0VUICAgICA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLAogICAgICBlbnRyaWVzOiAkZW50cmllcwogICAgfTsKICAgIGlmKEZPUkNFRClmb3Ioa2V5IGluIG1ldGhvZHMpewogICAgICBpZighKGtleSBpbiBwcm90bykpcmVkZWZpbmUocHJvdG8sIGtleSwgbWV0aG9kc1trZXldKTsKICAgIH0gZWxzZSAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7CiAgfQogIHJldHVybiBtZXRob2RzOwp9OwoKLyoqKi8gfSksCi8qIDM5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKLy8gMTkuMS4yLjQgLyAxNS4yLjMuNiBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhX193ZWJwYWNrX3JlcXVpcmVfXygzKSwgJ09iamVjdCcsIHtkZWZpbmVQcm9wZXJ0eTogX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mfSk7CgovKioqLyB9KSwKLyogNDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg1MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA0MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTsKCi8qKiovIH0pLAovKiA0MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZG9jdW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKLyoqKi8gfSksCi8qIDQzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi45IC8gMTUuMi4zLjIgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciBoYXMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCB0b09iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBPYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihPKXsKICBPID0gdG9PYmplY3QoTyk7CiAgaWYoaGFzKE8sIElFX1BST1RPKSlyZXR1cm4gT1tJRV9QUk9UT107CiAgaWYodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcil7CiAgICByZXR1cm4gTy5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7CiAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvIDogbnVsbDsKfTsKCi8qKiovIH0pLAovKiA0NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaGFzICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIHRvSU9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCBhcnJheUluZGV4T2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKShmYWxzZSkKICAsIElFX1BST1RPICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIG5hbWVzKXsKICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKICAgICwgaSAgICAgID0gMAogICAgLCByZXN1bHQgPSBbXQogICAgLCBrZXk7CiAgZm9yKGtleSBpbiBPKWlmKGtleSAhPSBJRV9QUk9UTyloYXMoTywga2V5KSAmJiByZXN1bHQucHVzaChrZXkpOwogIC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXMKICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKWlmKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSl7CiAgICB+YXJyYXlJbmRleE9mKHJlc3VsdCwga2V5KSB8fCByZXN1bHQucHVzaChrZXkpOwogIH0KICByZXR1cm4gcmVzdWx0Owp9OwoKLyoqKi8gfSksCi8qIDQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG1vc3QgT2JqZWN0IG1ldGhvZHMgYnkgRVM2IHNob3VsZCBhY2NlcHQgcHJpbWl0aXZlcwp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKICAsIGNvcmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBmYWlscyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBleGVjKXsKICB2YXIgZm4gID0gKGNvcmUuT2JqZWN0IHx8IHt9KVtLRVldIHx8IE9iamVjdFtLRVldCiAgICAsIGV4cCA9IHt9OwogIGV4cFtLRVldID0gZXhlYyhmbik7CiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbigpeyBmbigxKTsgfSksICdPYmplY3QnLCBleHApOwp9OwoKLyoqKi8gfSksCi8qIDQ2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCi8qKiovIH0pLAovKiA0NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMTUgVG9MZW5ndGgKdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpCiAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ID4gMCA/IG1pbih0b0ludGVnZXIoaXQpLCAweDFmZmZmZmZmZmZmZmZmKSA6IDA7IC8vIHBvdygyLCA1MykgLSAxID09IDkwMDcxOTkyNTQ3NDA5OTEKfTsKCi8qKiovIH0pLAovKiA0OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIExJQlJBUlkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKICAsIHdrc0V4dCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkKICAsIGRlZmluZVByb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewogIHZhciAkU3ltYm9sID0gY29yZS5TeW1ib2wgfHwgKGNvcmUuU3ltYm9sID0gTElCUkFSWSA/IHt9IDogZ2xvYmFsLlN5bWJvbCB8fCB7fSk7CiAgaWYobmFtZS5jaGFyQXQoMCkgIT0gJ18nICYmICEobmFtZSBpbiAkU3ltYm9sKSlkZWZpbmVQcm9wZXJ0eSgkU3ltYm9sLCBuYW1lLCB7dmFsdWU6IHdrc0V4dC5mKG5hbWUpfSk7Cn07CgovKioqLyB9KSwKLyogNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTsKCi8qKiovIH0pLAovKiA1MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgJGF0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNjYpKHRydWUpOwoKLy8gMjEuMS4zLjI3IFN0cmluZy5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQpfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KShTdHJpbmcsICdTdHJpbmcnLCBmdW5jdGlvbihpdGVyYXRlZCl7CiAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4Ci8vIDIxLjEuNS4yLjEgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKfSwgZnVuY3Rpb24oKXsKICB2YXIgTyAgICAgPSB0aGlzLl90CiAgICAsIGluZGV4ID0gdGhpcy5faQogICAgLCBwb2ludDsKICBpZihpbmRleCA+PSBPLmxlbmd0aClyZXR1cm4ge3ZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWV9OwogIHBvaW50ID0gJGF0KE8sIGluZGV4KTsKICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDsKICByZXR1cm4ge3ZhbHVlOiBwb2ludCwgZG9uZTogZmFsc2V9Owp9KTsKCi8qKiovIH0pLAovKiA1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDY5KTsKdmFyIGdsb2JhbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBoaWRlICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgSXRlcmF0b3JzICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCBUT19TVFJJTkdfVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKTsKCmZvcih2YXIgY29sbGVjdGlvbnMgPSBbJ05vZGVMaXN0JywgJ0RPTVRva2VuTGlzdCcsICdNZWRpYUxpc3QnLCAnU3R5bGVTaGVldExpc3QnLCAnQ1NTUnVsZUxpc3QnXSwgaSA9IDA7IGkgPCA1OyBpKyspewogIHZhciBOQU1FICAgICAgID0gY29sbGVjdGlvbnNbaV0KICAgICwgQ29sbGVjdGlvbiA9IGdsb2JhbFtOQU1FXQogICAgLCBwcm90byAgICAgID0gQ29sbGVjdGlvbiAmJiBDb2xsZWN0aW9uLnByb3RvdHlwZTsKICBpZihwcm90byAmJiAhcHJvdG9bVE9fU1RSSU5HX1RBR10paGlkZShwcm90bywgVE9fU1RSSU5HX1RBRywgTkFNRSk7CiAgSXRlcmF0b3JzW05BTUVdID0gSXRlcmF0b3JzLkFycmF5Owp9CgovKioqLyB9KSwKLyogNTIgKi8sCi8qIDUzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjb3JlICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsICRKU09OID0gY29yZS5KU09OIHx8IChjb3JlLkpTT04gPSB7c3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeX0pOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICByZXR1cm4gJEpTT04uc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmd1bWVudHMpOwp9OwoKLyoqKi8gfSksCi8qIDU0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgoKLyoqKi8gfSksCi8qIDU1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGdldHRpbmcgdGFnIGZyb20gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KQogICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKQogIC8vIEVTMyB3cm9uZyBoZXJlCiAgLCBBUkcgPSBjb2YoZnVuY3Rpb24oKXsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJzsKCi8vIGZhbGxiYWNrIGZvciBJRTExIFNjcmlwdCBBY2Nlc3MgRGVuaWVkIGVycm9yCnZhciB0cnlHZXQgPSBmdW5jdGlvbihpdCwga2V5KXsKICB0cnkgewogICAgcmV0dXJuIGl0W2tleV07CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgdmFyIE8sIFQsIEI7CiAgcmV0dXJuIGl0ID09PSB1bmRlZmluZWQgPyAnVW5kZWZpbmVkJyA6IGl0ID09PSBudWxsID8gJ051bGwnCiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2UKICAgIDogdHlwZW9mIChUID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUQUcpKSA9PSAnc3RyaW5nJyA/IFQKICAgIC8vIGJ1aWx0aW5UYWcgY2FzZQogICAgOiBBUkcgPyBjb2YoTykKICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2sKICAgIDogKEIgPSBjb2YoTykpID09ICdPYmplY3QnICYmIHR5cGVvZiBPLmNhbGxlZSA9PSAnZnVuY3Rpb24nID8gJ0FyZ3VtZW50cycgOiBCOwp9OwoKLyoqKi8gfSksCi8qIDU2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gY29mKGl0KSA9PSAnU3RyaW5nJyA/IGl0LnNwbGl0KCcnKSA6IE9iamVjdChpdCk7Cn07CgovKioqLyB9KSwKLyogNTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHBJRSAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIGdPUEQgICAgICAgICAgID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKCmV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBnT1BEIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApewogIE8gPSB0b0lPYmplY3QoTyk7CiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwogIGlmKElFOF9ET01fREVGSU5FKXRyeSB7CiAgICByZXR1cm4gZ09QRChPLCBQKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgaWYoaGFzKE8sIFApKXJldHVybiBjcmVhdGVEZXNjKCFwSUUuZi5jYWxsKE8sIFApLCBPW1BdKTsKfTsKCi8qKiovIH0pLAovKiA1OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKLyoqKi8gfSksCi8qIDU5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9pdGVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oNzcpOwoKdmFyIF9pdGVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pdGVyYXRvcik7Cgp2YXIgX3N5bWJvbCA9IF9fd2VicGFja19yZXF1aXJlX18oNzYpOwoKdmFyIF9zeW1ib2wyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3ltYm9sKTsKCnZhciBfdHlwZW9mID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIF9pdGVyYXRvcjIuZGVmYXVsdCA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YoX2l0ZXJhdG9yMi5kZWZhdWx0KSA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG9iaik7Cn0gOiBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IF9zeW1ib2wyLmRlZmF1bHQgJiYgb2JqICE9PSBfc3ltYm9sMi5kZWZhdWx0LnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iaiA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yob2JqKTsKfTsKCi8qKiovIH0pLAovKiA2MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH07CgovKioqLyB9KSwKLyogNjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsc2UgLT4gQXJyYXkjaW5kZXhPZgovLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlcwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvTGVuZ3RoICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCB0b0luZGV4ICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY4KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihJU19JTkNMVURFUyl7CiAgcmV0dXJuIGZ1bmN0aW9uKCR0aGlzLCBlbCwgZnJvbUluZGV4KXsKICAgIHZhciBPICAgICAgPSB0b0lPYmplY3QoJHRoaXMpCiAgICAgICwgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpCiAgICAgICwgaW5kZXggID0gdG9JbmRleChmcm9tSW5kZXgsIGxlbmd0aCkKICAgICAgLCB2YWx1ZTsKICAgIC8vIEFycmF5I2luY2x1ZGVzIHVzZXMgU2FtZVZhbHVlWmVybyBlcXVhbGl0eSBhbGdvcml0aG0KICAgIGlmKElTX0lOQ0xVREVTICYmIGVsICE9IGVsKXdoaWxlKGxlbmd0aCA+IGluZGV4KXsKICAgICAgdmFsdWUgPSBPW2luZGV4KytdOwogICAgICBpZih2YWx1ZSAhPSB2YWx1ZSlyZXR1cm4gdHJ1ZTsKICAgIC8vIEFycmF5I3RvSW5kZXggaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3QKICAgIH0gZWxzZSBmb3IoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKWlmKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pewogICAgICBpZihPW2luZGV4XSA9PT0gZWwpcmV0dXJuIElTX0lOQ0xVREVTIHx8IGluZGV4IHx8IDA7CiAgICB9IHJldHVybiAhSVNfSU5DTFVERVMgJiYgLTE7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgY3JlYXRlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KQogICwgZGVzY3JpcHRvciAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTsKCi8vIDI1LjEuMi4xLjEgJUl0ZXJhdG9yUHJvdG90eXBlJVtAQGl0ZXJhdG9yXSgpCl9fd2VicGFja19yZXF1aXJlX18oNikoSXRlcmF0b3JQcm90b3R5cGUsIF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJyksIGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9KTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpewogIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwge25leHQ6IGRlc2NyaXB0b3IoMSwgbmV4dCl9KTsKICBzZXRUb1N0cmluZ1RhZyhDb25zdHJ1Y3RvciwgTkFNRSArICcgSXRlcmF0b3InKTsKfTsKCi8qKiovIH0pLAovKiA2MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGRvbmUsIHZhbHVlKXsKICByZXR1cm4ge3ZhbHVlOiB2YWx1ZSwgZG9uZTogISFkb25lfTsKfTsKCi8qKiovIH0pLAovKiA2NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIGdldEtleXMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcyl7CiAgYW5PYmplY3QoTyk7CiAgdmFyIGtleXMgICA9IGdldEtleXMoUHJvcGVydGllcykKICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgKICAgICwgaSA9IDAKICAgICwgUDsKICB3aGlsZShsZW5ndGggPiBpKWRQLmYoTywgUCA9IGtleXNbaSsrXSwgUHJvcGVydGllc1tQXSk7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjcgLyAxNS4yLjMuNCBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKQp2YXIgJGtleXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBoaWRkZW5LZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKE8pewogIHJldHVybiAka2V5cyhPLCBoaWRkZW5LZXlzKTsKfTsKCi8qKiovIH0pLAovKiA2NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykKICAsIGRlZmluZWQgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwovLyB0cnVlICAtPiBTdHJpbmcjYXQKLy8gZmFsc2UgLT4gU3RyaW5nI2NvZGVQb2ludEF0Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oVE9fU1RSSU5HKXsKICByZXR1cm4gZnVuY3Rpb24odGhhdCwgcG9zKXsKICAgIHZhciBzID0gU3RyaW5nKGRlZmluZWQodGhhdCkpCiAgICAgICwgaSA9IHRvSW50ZWdlcihwb3MpCiAgICAgICwgbCA9IHMubGVuZ3RoCiAgICAgICwgYSwgYjsKICAgIGlmKGkgPCAwIHx8IGkgPj0gbClyZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7CiAgICBhID0gcy5jaGFyQ29kZUF0KGkpOwogICAgcmV0dXJuIGEgPCAweGQ4MDAgfHwgYSA+IDB4ZGJmZiB8fCBpICsgMSA9PT0gbCB8fCAoYiA9IHMuY2hhckNvZGVBdChpICsgMSkpIDwgMHhkYzAwIHx8IGIgPiAweGRmZmYKICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGEKICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGludm9rZSAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODgpCiAgLCBodG1sICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKQogICwgY2VsICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSkKICAsIGdsb2JhbCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBzZXRUYXNrICAgICAgICAgICAgPSBnbG9iYWwuc2V0SW1tZWRpYXRlCiAgLCBjbGVhclRhc2sgICAgICAgICAgPSBnbG9iYWwuY2xlYXJJbW1lZGlhdGUKICAsIE1lc3NhZ2VDaGFubmVsICAgICA9IGdsb2JhbC5NZXNzYWdlQ2hhbm5lbAogICwgY291bnRlciAgICAgICAgICAgID0gMAogICwgcXVldWUgICAgICAgICAgICAgID0ge30KICAsIE9OUkVBRFlTVEFURUNIQU5HRSA9ICdvbnJlYWR5c3RhdGVjaGFuZ2UnCiAgLCBkZWZlciwgY2hhbm5lbCwgcG9ydDsKdmFyIHJ1biA9IGZ1bmN0aW9uKCl7CiAgdmFyIGlkID0gK3RoaXM7CiAgaWYocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKXsKICAgIHZhciBmbiA9IHF1ZXVlW2lkXTsKICAgIGRlbGV0ZSBxdWV1ZVtpZF07CiAgICBmbigpOwogIH0KfTsKdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpewogIHJ1bi5jYWxsKGV2ZW50LmRhdGEpOwp9OwovLyBOb2RlLmpzIDAuOSsgJiBJRTEwKyBoYXMgc2V0SW1tZWRpYXRlLCBvdGhlcndpc2U6CmlmKCFzZXRUYXNrIHx8ICFjbGVhclRhc2spewogIHNldFRhc2sgPSBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoZm4pewogICAgdmFyIGFyZ3MgPSBbXSwgaSA9IDE7CiAgICB3aGlsZShhcmd1bWVudHMubGVuZ3RoID4gaSlhcmdzLnB1c2goYXJndW1lbnRzW2krK10pOwogICAgcXVldWVbKytjb3VudGVyXSA9IGZ1bmN0aW9uKCl7CiAgICAgIGludm9rZSh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pLCBhcmdzKTsKICAgIH07CiAgICBkZWZlcihjb3VudGVyKTsKICAgIHJldHVybiBjb3VudGVyOwogIH07CiAgY2xlYXJUYXNrID0gZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaWQpewogICAgZGVsZXRlIHF1ZXVlW2lkXTsKICB9OwogIC8vIE5vZGUuanMgMC44LQogIGlmKF9fd2VicGFja19yZXF1aXJlX18oMTgpKHByb2Nlc3MpID09ICdwcm9jZXNzJyl7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgcHJvY2Vzcy5uZXh0VGljayhjdHgocnVuLCBpZCwgMSkpOwogICAgfTsKICAvLyBCcm93c2VycyB3aXRoIE1lc3NhZ2VDaGFubmVsLCBpbmNsdWRlcyBXZWJXb3JrZXJzCiAgfSBlbHNlIGlmKE1lc3NhZ2VDaGFubmVsKXsKICAgIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWw7CiAgICBwb3J0ICAgID0gY2hhbm5lbC5wb3J0MjsKICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gbGlzdGVuZXI7CiAgICBkZWZlciA9IGN0eChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTsKICAvLyBCcm93c2VycyB3aXRoIHBvc3RNZXNzYWdlLCBza2lwIFdlYldvcmtlcnMKICAvLyBJRTggaGFzIHBvc3RNZXNzYWdlLCBidXQgaXQncyBzeW5jICYgdHlwZW9mIGl0cyBwb3N0TWVzc2FnZSBpcyAnb2JqZWN0JwogIH0gZWxzZSBpZihnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lciAmJiB0eXBlb2YgcG9zdE1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJyAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShpZCArICcnLCAnKicpOwogICAgfTsKICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbGlzdGVuZXIsIGZhbHNlKTsKICAvLyBJRTgtCiAgfSBlbHNlIGlmKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKXsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBodG1sLmFwcGVuZENoaWxkKGNlbCgnc2NyaXB0JykpW09OUkVBRFlTVEFURUNIQU5HRV0gPSBmdW5jdGlvbigpewogICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7CiAgICAgICAgcnVuLmNhbGwoaWQpOwogICAgICB9OwogICAgfTsKICAvLyBSZXN0IG9sZCBicm93c2VycwogIH0gZWxzZSB7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgc2V0VGltZW91dChjdHgocnVuLCBpZCwgMSksIDApOwogICAgfTsKICB9Cn0KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2V0OiAgIHNldFRhc2ssCiAgY2xlYXI6IGNsZWFyVGFzawp9OwoKLyoqKi8gfSksCi8qIDY4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KQogICwgbWF4ICAgICAgID0gTWF0aC5tYXgKICAsIG1pbiAgICAgICA9IE1hdGgubWluOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGluZGV4LCBsZW5ndGgpewogIGluZGV4ID0gdG9JbnRlZ2VyKGluZGV4KTsKICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbihpbmRleCwgbGVuZ3RoKTsKfTsKCi8qKiovIH0pLAovKiA2OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgYWRkVG9VbnNjb3BhYmxlcyA9IF9fd2VicGFja19yZXF1aXJlX18oNjApCiAgLCBzdGVwICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MykKICAsIEl0ZXJhdG9ycyAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQogICwgdG9JT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwoKLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKQovLyAyMi4xLjMuMTMgQXJyYXkucHJvdG90eXBlLmtleXMoKQovLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpCi8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzgpKEFycmF5LCAnQXJyYXknLCBmdW5jdGlvbihpdGVyYXRlZCwga2luZCl7CiAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4CiAgdGhpcy5fayA9IGtpbmQ7ICAgICAgICAgICAgICAgIC8vIGtpbmQKLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpCn0sIGZ1bmN0aW9uKCl7CiAgdmFyIE8gICAgID0gdGhpcy5fdAogICAgLCBraW5kICA9IHRoaXMuX2sKICAgICwgaW5kZXggPSB0aGlzLl9pKys7CiAgaWYoIU8gfHwgaW5kZXggPj0gTy5sZW5ndGgpewogICAgdGhpcy5fdCA9IHVuZGVmaW5lZDsKICAgIHJldHVybiBzdGVwKDEpOwogIH0KICBpZihraW5kID09ICdrZXlzJyAgKXJldHVybiBzdGVwKDAsIGluZGV4KTsKICBpZihraW5kID09ICd2YWx1ZXMnKXJldHVybiBzdGVwKDAsIE9baW5kZXhdKTsKICByZXR1cm4gc3RlcCgwLCBbaW5kZXgsIE9baW5kZXhdXSk7Cn0sICd2YWx1ZXMnKTsKCi8vIGFyZ3VtZW50c0xpc3RbQEBpdGVyYXRvcl0gaXMgJUFycmF5UHJvdG9fdmFsdWVzJSAoOS40LjQuNiwgOS40LjQuNykKSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTsKCmFkZFRvVW5zY29wYWJsZXMoJ2tleXMnKTsKYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7CmFkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTsKCi8qKiovIH0pLAovKiA3MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDcxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODIpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIE1FVEEgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykoJ21ldGEnKQogICwgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBoYXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBzZXREZXNjICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaWQgICAgICAgPSAwOwp2YXIgaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZSB8fCBmdW5jdGlvbigpewogIHJldHVybiB0cnVlOwp9Owp2YXIgRlJFRVpFID0gIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGlzRXh0ZW5zaWJsZShPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe30pKTsKfSk7CnZhciBzZXRNZXRhID0gZnVuY3Rpb24oaXQpewogIHNldERlc2MoaXQsIE1FVEEsIHt2YWx1ZTogewogICAgaTogJ08nICsgKytpZCwgLy8gb2JqZWN0IElECiAgICB3OiB7fSAgICAgICAgICAvLyB3ZWFrIGNvbGxlY3Rpb25zIElEcwogIH19KTsKfTsKdmFyIGZhc3RLZXkgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICAvLyByZXR1cm4gcHJpbWl0aXZlIHdpdGggcHJlZml4CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnID8gaXQgOiAodHlwZW9mIGl0ID09ICdzdHJpbmcnID8gJ1MnIDogJ1AnKSArIGl0OwogIGlmKCFoYXMoaXQsIE1FVEEpKXsKICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0CiAgICBpZighaXNFeHRlbnNpYmxlKGl0KSlyZXR1cm4gJ0YnOwogICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGEKICAgIGlmKCFjcmVhdGUpcmV0dXJuICdFJzsKICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhCiAgICBzZXRNZXRhKGl0KTsKICAvLyByZXR1cm4gb2JqZWN0IElECiAgfSByZXR1cm4gaXRbTUVUQV0uaTsKfTsKdmFyIGdldFdlYWsgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICBpZighaGFzKGl0LCBNRVRBKSl7CiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdAogICAgaWYoIWlzRXh0ZW5zaWJsZShpdCkpcmV0dXJuIHRydWU7CiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YQogICAgaWYoIWNyZWF0ZSlyZXR1cm4gZmFsc2U7CiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YQogICAgc2V0TWV0YShpdCk7CiAgLy8gcmV0dXJuIGhhc2ggd2VhayBjb2xsZWN0aW9ucyBJRHMKICB9IHJldHVybiBpdFtNRVRBXS53Owp9OwovLyBhZGQgbWV0YWRhdGEgb24gZnJlZXplLWZhbWlseSBtZXRob2RzIGNhbGxpbmcKdmFyIG9uRnJlZXplID0gZnVuY3Rpb24oaXQpewogIGlmKEZSRUVaRSAmJiBtZXRhLk5FRUQgJiYgaXNFeHRlbnNpYmxlKGl0KSAmJiAhaGFzKGl0LCBNRVRBKSlzZXRNZXRhKGl0KTsKICByZXR1cm4gaXQ7Cn07CnZhciBtZXRhID0gbW9kdWxlLmV4cG9ydHMgPSB7CiAgS0VZOiAgICAgIE1FVEEsCiAgTkVFRDogICAgIGZhbHNlLAogIGZhc3RLZXk6ICBmYXN0S2V5LAogIGdldFdlYWs6ICBnZXRXZWFrLAogIG9uRnJlZXplOiBvbkZyZWV6ZQp9OwoKLyoqKi8gfSksCi8qIDczICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjbGFzc29mICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KQogICwgSVRFUkFUT1IgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgSXRlcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCAhPSB1bmRlZmluZWQpcmV0dXJuIGl0W0lURVJBVE9SXQogICAgfHwgaXRbJ0BAaXRlcmF0b3InXQogICAgfHwgSXRlcmF0b3JzW2NsYXNzb2YoaXQpXTsKfTsKCi8qKiovIH0pLAovKiA3NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDc4KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODEpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDg0KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAwKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGUoUCwgRCl7CiAgcmV0dXJuICRPYmplY3QuY3JlYXRlKFAsIEQpOwp9OwoKLyoqKi8gfSksCi8qIDc5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAxKTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5nZXRQcm90b3R5cGVPZjsKCi8qKiovIH0pLAovKiA4MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMik7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Qua2V5czsKCi8qKiovIH0pLAovKiA4MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMyk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Quc2V0UHJvdG90eXBlT2Y7CgovKioqLyB9KSwKLyogODIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg1NCk7Cl9fd2VicGFja19yZXF1aXJlX18oNTApOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKX193ZWJwYWNrX3JlcXVpcmVfXygxMDQpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuUHJvbWlzZTsKCi8qKiovIH0pLAovKiA4MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNSk7Cl9fd2VicGFja19yZXF1aXJlX18oNTQpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNik7Cl9fd2VicGFja19yZXF1aXJlX18oMTA3KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLlN5bWJvbDsKCi8qKiovIH0pLAovKiA4NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkuZignaXRlcmF0b3InKTsKCi8qKiovIH0pLAovKiA4NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSwgZm9yYmlkZGVuRmllbGQpewogIGlmKCEoaXQgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikgfHwgKGZvcmJpZGRlbkZpZWxkICE9PSB1bmRlZmluZWQgJiYgZm9yYmlkZGVuRmllbGQgaW4gaXQpKXsKICAgIHRocm93IFR5cGVFcnJvcihuYW1lICsgJzogaW5jb3JyZWN0IGludm9jYXRpb24hJyk7CiAgfSByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogODYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gYWxsIGVudW1lcmFibGUgb2JqZWN0IGtleXMsIGluY2x1ZGVzIHN5bWJvbHMKdmFyIGdldEtleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QUyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHZhciByZXN1bHQgICAgID0gZ2V0S2V5cyhpdCkKICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZjsKICBpZihnZXRTeW1ib2xzKXsKICAgIHZhciBzeW1ib2xzID0gZ2V0U3ltYm9scyhpdCkKICAgICAgLCBpc0VudW0gID0gcElFLmYKICAgICAgLCBpICAgICAgID0gMAogICAgICAsIGtleTsKICAgIHdoaWxlKHN5bWJvbHMubGVuZ3RoID4gaSlpZihpc0VudW0uY2FsbChpdCwga2V5ID0gc3ltYm9sc1tpKytdKSlyZXN1bHQucHVzaChrZXkpOwogIH0gcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiA4NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgY2FsbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkxKQogICwgaXNBcnJheUl0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg5KQogICwgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCB0b0xlbmd0aCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCBnZXRJdGVyRm4gICA9IF9fd2VicGFja19yZXF1aXJlX18oNzMpCiAgLCBCUkVBSyAgICAgICA9IHt9CiAgLCBSRVRVUk4gICAgICA9IHt9Owp2YXIgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXRlcmFibGUsIGVudHJpZXMsIGZuLCB0aGF0LCBJVEVSQVRPUil7CiAgdmFyIGl0ZXJGbiA9IElURVJBVE9SID8gZnVuY3Rpb24oKXsgcmV0dXJuIGl0ZXJhYmxlOyB9IDogZ2V0SXRlckZuKGl0ZXJhYmxlKQogICAgLCBmICAgICAgPSBjdHgoZm4sIHRoYXQsIGVudHJpZXMgPyAyIDogMSkKICAgICwgaW5kZXggID0gMAogICAgLCBsZW5ndGgsIHN0ZXAsIGl0ZXJhdG9yLCByZXN1bHQ7CiAgaWYodHlwZW9mIGl0ZXJGbiAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdGVyYWJsZSArICcgaXMgbm90IGl0ZXJhYmxlIScpOwogIC8vIGZhc3QgY2FzZSBmb3IgYXJyYXlzIHdpdGggZGVmYXVsdCBpdGVyYXRvcgogIGlmKGlzQXJyYXlJdGVyKGl0ZXJGbikpZm9yKGxlbmd0aCA9IHRvTGVuZ3RoKGl0ZXJhYmxlLmxlbmd0aCk7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKXsKICAgIHJlc3VsdCA9IGVudHJpZXMgPyBmKGFuT2JqZWN0KHN0ZXAgPSBpdGVyYWJsZVtpbmRleF0pWzBdLCBzdGVwWzFdKSA6IGYoaXRlcmFibGVbaW5kZXhdKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9IGVsc2UgZm9yKGl0ZXJhdG9yID0gaXRlckZuLmNhbGwoaXRlcmFibGUpOyAhKHN0ZXAgPSBpdGVyYXRvci5uZXh0KCkpLmRvbmU7ICl7CiAgICByZXN1bHQgPSBjYWxsKGl0ZXJhdG9yLCBmLCBzdGVwLnZhbHVlLCBlbnRyaWVzKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9Cn07CmV4cG9ydHMuQlJFQUsgID0gQlJFQUs7CmV4cG9ydHMuUkVUVVJOID0gUkVUVVJOOwoKLyoqKi8gfSksCi8qIDg4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGZhc3QgYXBwbHksIGh0dHA6Ly9qc3BlcmYubG5raXQuY29tL2Zhc3QtYXBwbHkvNQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCBhcmdzLCB0aGF0KXsKICB2YXIgdW4gPSB0aGF0ID09PSB1bmRlZmluZWQ7CiAgc3dpdGNoKGFyZ3MubGVuZ3RoKXsKICAgIGNhc2UgMDogcmV0dXJuIHVuID8gZm4oKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQpOwogICAgY2FzZSAxOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0pOwogICAgY2FzZSAyOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0pOwogICAgY2FzZSAzOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pOwogICAgY2FzZSA0OiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pOwogIH0gcmV0dXJuICAgICAgICAgICAgICBmbi5hcHBseSh0aGF0LCBhcmdzKTsKfTsKCi8qKiovIH0pLAovKiA4OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBjaGVjayBvbiBkZWZhdWx0IEFycmF5IGl0ZXJhdG9yCnZhciBJdGVyYXRvcnMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsIElURVJBVE9SICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpCiAgLCBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b1tJVEVSQVRPUl0gPT09IGl0KTsKfTsKCi8qKiovIH0pLAovKiA5MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjIuMiBJc0FycmF5KGFyZ3VtZW50KQp2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7Cm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5KGFyZyl7CiAgcmV0dXJuIGNvZihhcmcpID09ICdBcnJheSc7Cn07CgovKioqLyB9KSwKLyogOTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gY2FsbCBzb21ldGhpbmcgb24gaXRlcmF0b3Igc3RlcCB3aXRoIHNhZmUgY2xvc2luZyBvbiBlcnJvcgp2YXIgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhdG9yLCBmbiwgdmFsdWUsIGVudHJpZXMpewogIHRyeSB7CiAgICByZXR1cm4gZW50cmllcyA/IGZuKGFuT2JqZWN0KHZhbHVlKVswXSwgdmFsdWVbMV0pIDogZm4odmFsdWUpOwogIC8vIDcuNC42IEl0ZXJhdG9yQ2xvc2UoaXRlcmF0b3IsIGNvbXBsZXRpb24pCiAgfSBjYXRjaChlKXsKICAgIHZhciByZXQgPSBpdGVyYXRvclsncmV0dXJuJ107CiAgICBpZihyZXQgIT09IHVuZGVmaW5lZClhbk9iamVjdChyZXQuY2FsbChpdGVyYXRvcikpOwogICAgdGhyb3cgZTsKICB9Cn07CgovKioqLyB9KSwKLyogOTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIElURVJBVE9SICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJykKICAsIFNBRkVfQ0xPU0lORyA9IGZhbHNlOwoKdHJ5IHsKICB2YXIgcml0ZXIgPSBbN11bSVRFUkFUT1JdKCk7CiAgcml0ZXJbJ3JldHVybiddID0gZnVuY3Rpb24oKXsgU0FGRV9DTE9TSU5HID0gdHJ1ZTsgfTsKICBBcnJheS5mcm9tKHJpdGVyLCBmdW5jdGlvbigpeyB0aHJvdyAyOyB9KTsKfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjLCBza2lwQ2xvc2luZyl7CiAgaWYoIXNraXBDbG9zaW5nICYmICFTQUZFX0NMT1NJTkcpcmV0dXJuIGZhbHNlOwogIHZhciBzYWZlID0gZmFsc2U7CiAgdHJ5IHsKICAgIHZhciBhcnIgID0gWzddCiAgICAgICwgaXRlciA9IGFycltJVEVSQVRPUl0oKTsKICAgIGl0ZXIubmV4dCA9IGZ1bmN0aW9uKCl7IHJldHVybiB7ZG9uZTogc2FmZSA9IHRydWV9OyB9OwogICAgYXJyW0lURVJBVE9SXSA9IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyOyB9OwogICAgZXhlYyhhcnIpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICByZXR1cm4gc2FmZTsKfTsKCi8qKiovIH0pLAovKiA5MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2V0S2V5cyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykKICAsIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgZWwpewogIHZhciBPICAgICAgPSB0b0lPYmplY3Qob2JqZWN0KQogICAgLCBrZXlzICAgPSBnZXRLZXlzKE8pCiAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCiAgICAsIGluZGV4ICA9IDAKICAgICwga2V5OwogIHdoaWxlKGxlbmd0aCA+IGluZGV4KWlmKE9ba2V5ID0ga2V5c1tpbmRleCsrXV0gPT09IGVsKXJldHVybiBrZXk7Cn07CgovKioqLyB9KSwKLyogOTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIG1hY3JvdGFzayA9IF9fd2VicGFja19yZXF1aXJlX18oNjcpLnNldAogICwgT2JzZXJ2ZXIgID0gZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIKICAsIHByb2Nlc3MgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBQcm9taXNlICAgPSBnbG9iYWwuUHJvbWlzZQogICwgaXNOb2RlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkocHJvY2VzcykgPT0gJ3Byb2Nlc3MnOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpewogIHZhciBoZWFkLCBsYXN0LCBub3RpZnk7CgogIHZhciBmbHVzaCA9IGZ1bmN0aW9uKCl7CiAgICB2YXIgcGFyZW50LCBmbjsKICAgIGlmKGlzTm9kZSAmJiAocGFyZW50ID0gcHJvY2Vzcy5kb21haW4pKXBhcmVudC5leGl0KCk7CiAgICB3aGlsZShoZWFkKXsKICAgICAgZm4gICA9IGhlYWQuZm47CiAgICAgIGhlYWQgPSBoZWFkLm5leHQ7CiAgICAgIHRyeSB7CiAgICAgICAgZm4oKTsKICAgICAgfSBjYXRjaChlKXsKICAgICAgICBpZihoZWFkKW5vdGlmeSgpOwogICAgICAgIGVsc2UgbGFzdCA9IHVuZGVmaW5lZDsKICAgICAgICB0aHJvdyBlOwogICAgICB9CiAgICB9IGxhc3QgPSB1bmRlZmluZWQ7CiAgICBpZihwYXJlbnQpcGFyZW50LmVudGVyKCk7CiAgfTsKCiAgLy8gTm9kZS5qcwogIGlmKGlzTm9kZSl7CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBwcm9jZXNzLm5leHRUaWNrKGZsdXNoKTsKICAgIH07CiAgLy8gYnJvd3NlcnMgd2l0aCBNdXRhdGlvbk9ic2VydmVyCiAgfSBlbHNlIGlmKE9ic2VydmVyKXsKICAgIHZhciB0b2dnbGUgPSB0cnVlCiAgICAgICwgbm9kZSAgID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpOwogICAgbmV3IE9ic2VydmVyKGZsdXNoKS5vYnNlcnZlKG5vZGUsIHtjaGFyYWN0ZXJEYXRhOiB0cnVlfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBub2RlLmRhdGEgPSB0b2dnbGUgPSAhdG9nZ2xlOwogICAgfTsKICAvLyBlbnZpcm9ubWVudHMgd2l0aCBtYXliZSBub24tY29tcGxldGVseSBjb3JyZWN0LCBidXQgZXhpc3RlbnQgUHJvbWlzZQogIH0gZWxzZSBpZihQcm9taXNlICYmIFByb21pc2UucmVzb2x2ZSl7CiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpOwogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgcHJvbWlzZS50aGVuKGZsdXNoKTsKICAgIH07CiAgLy8gZm9yIG90aGVyIGVudmlyb25tZW50cyAtIG1hY3JvdGFzayBiYXNlZCBvbjoKICAvLyAtIHNldEltbWVkaWF0ZQogIC8vIC0gTWVzc2FnZUNoYW5uZWwKICAvLyAtIHdpbmRvdy5wb3N0TWVzc2FnCiAgLy8gLSBvbnJlYWR5c3RhdGVjaGFuZ2UKICAvLyAtIHNldFRpbWVvdXQKICB9IGVsc2UgewogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgLy8gc3RyYW5nZSBJRSArIHdlYnBhY2sgZGV2IHNlcnZlciBidWcgLSB1c2UgLmNhbGwoZ2xvYmFsKQogICAgICBtYWNyb3Rhc2suY2FsbChnbG9iYWwsIGZsdXNoKTsKICAgIH07CiAgfQoKICByZXR1cm4gZnVuY3Rpb24oZm4pewogICAgdmFyIHRhc2sgPSB7Zm46IGZuLCBuZXh0OiB1bmRlZmluZWR9OwogICAgaWYobGFzdClsYXN0Lm5leHQgPSB0YXNrOwogICAgaWYoIWhlYWQpewogICAgICBoZWFkID0gdGFzazsKICAgICAgbm90aWZ5KCk7CiAgICB9IGxhc3QgPSB0YXNrOwogIH07Cn07CgovKioqLyB9KSwKLyogOTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsbGJhY2sgZm9yIElFMTEgYnVnZ3kgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgd2l0aCBpZnJhbWUgYW5kIHdpbmRvdwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIGdPUE4gICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjUpLmYKICAsIHRvU3RyaW5nICA9IHt9LnRvU3RyaW5nOwoKdmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMKICA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdykgOiBbXTsKCnZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uKGl0KXsKICB0cnkgewogICAgcmV0dXJuIGdPUE4oaXQpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gd2luZG93TmFtZXMuc2xpY2UoKTsKICB9Cn07Cgptb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCl7CiAgcmV0dXJuIHdpbmRvd05hbWVzICYmIHRvU3RyaW5nLmNhbGwoaXQpID09ICdbb2JqZWN0IFdpbmRvd10nID8gZ2V0V2luZG93TmFtZXMoaXQpIDogZ09QTih0b0lPYmplY3QoaXQpKTsKfTsKCgovKioqLyB9KSwKLyogOTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGhpZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHRhcmdldCwgc3JjLCBzYWZlKXsKICBmb3IodmFyIGtleSBpbiBzcmMpewogICAgaWYoc2FmZSAmJiB0YXJnZXRba2V5XSl0YXJnZXRba2V5XSA9IHNyY1trZXldOwogICAgZWxzZSBoaWRlKHRhcmdldCwga2V5LCBzcmNba2V5XSk7CiAgfSByZXR1cm4gdGFyZ2V0Owp9OwoKLyoqKi8gfSksCi8qIDk3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFdvcmtzIHdpdGggX19wcm90b19fIG9ubHkuIE9sZCB2OCBjYW4ndCB3b3JrIHdpdGggbnVsbCBwcm90byBvYmplY3RzLgovKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqLwp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CnZhciBjaGVjayA9IGZ1bmN0aW9uKE8sIHByb3RvKXsKICBhbk9iamVjdChPKTsKICBpZighaXNPYmplY3QocHJvdG8pICYmIHByb3RvICE9PSBudWxsKXRocm93IFR5cGVFcnJvcihwcm90byArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7Cn07Cm1vZHVsZS5leHBvcnRzID0gewogIHNldDogT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8ICgnX19wcm90b19fJyBpbiB7fSA/IC8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAgIGZ1bmN0aW9uKHRlc3QsIGJ1Z2d5LCBzZXQpewogICAgICB0cnkgewogICAgICAgIHNldCA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpKEZ1bmN0aW9uLmNhbGwsIF9fd2VicGFja19yZXF1aXJlX18oNTcpLmYoT2JqZWN0LnByb3RvdHlwZSwgJ19fcHJvdG9fXycpLnNldCwgMik7CiAgICAgICAgc2V0KHRlc3QsIFtdKTsKICAgICAgICBidWdneSA9ICEodGVzdCBpbnN0YW5jZW9mIEFycmF5KTsKICAgICAgfSBjYXRjaChlKXsgYnVnZ3kgPSB0cnVlOyB9CiAgICAgIHJldHVybiBmdW5jdGlvbiBzZXRQcm90b3R5cGVPZihPLCBwcm90byl7CiAgICAgICAgY2hlY2soTywgcHJvdG8pOwogICAgICAgIGlmKGJ1Z2d5KU8uX19wcm90b19fID0gcHJvdG87CiAgICAgICAgZWxzZSBzZXQoTywgcHJvdG8pOwogICAgICAgIHJldHVybiBPOwogICAgICB9OwogICAgfSh7fSwgZmFsc2UpIDogdW5kZWZpbmVkKSwKICBjaGVjazogY2hlY2sKfTsKCi8qKiovIH0pLAovKiA5OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZ2xvYmFsICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGRQICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgREVTQ1JJUFRPUlMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpCiAgLCBTUEVDSUVTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZKXsKICB2YXIgQyA9IHR5cGVvZiBjb3JlW0tFWV0gPT0gJ2Z1bmN0aW9uJyA/IGNvcmVbS0VZXSA6IGdsb2JhbFtLRVldOwogIGlmKERFU0NSSVBUT1JTICYmIEMgJiYgIUNbU1BFQ0lFU10pZFAuZihDLCBTUEVDSUVTLCB7CiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9CiAgfSk7Cn07CgovKioqLyB9KSwKLyogOTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpCnZhciBhbk9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBhRnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgU1BFQ0lFUyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnc3BlY2llcycpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE8sIEQpewogIHZhciBDID0gYW5PYmplY3QoTykuY29uc3RydWN0b3IsIFM7CiAgcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBEIDogYUZ1bmN0aW9uKFMpOwp9OwoKLyoqKi8gfSksCi8qIDEwMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0Jywge2NyZWF0ZTogX193ZWJwYWNrX3JlcXVpcmVfXygzNSl9KTsKCi8qKiovIH0pLAovKiAxMDEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjkgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciB0b09iamVjdCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Myk7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KSgnZ2V0UHJvdG90eXBlT2YnLCBmdW5jdGlvbigpewogIHJldHVybiBmdW5jdGlvbiBnZXRQcm90b3R5cGVPZihpdCl7CiAgICByZXR1cm4gJGdldFByb3RvdHlwZU9mKHRvT2JqZWN0KGl0KSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4xNCBPYmplY3Qua2V5cyhPKQp2YXIgdG9PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGtleXMgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCl9fd2VicGFja19yZXF1aXJlX18oNDUpKCdrZXlzJywgZnVuY3Rpb24oKXsKICByZXR1cm4gZnVuY3Rpb24ga2V5cyhpdCl7CiAgICByZXR1cm4gJGtleXModG9PYmplY3QoaXQpKTsKICB9Owp9KTsKCi8qKiovIH0pLAovKiAxMDMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjE5IE9iamVjdC5zZXRQcm90b3R5cGVPZihPLCBwcm90bykKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwokZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtzZXRQcm90b3R5cGVPZjogX193ZWJwYWNrX3JlcXVpcmVfXyg5Nykuc2V0fSk7CgovKioqLyB9KSwKLyogMTA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBMSUJSQVJZICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgZ2xvYmFsICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGNsYXNzb2YgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTUpCiAgLCAkZXhwb3J0ICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCBpc09iamVjdCAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhRnVuY3Rpb24gICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgYW5JbnN0YW5jZSAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NSkKICAsIGZvck9mICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODcpCiAgLCBzcGVjaWVzQ29uc3RydWN0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KQogICwgdGFzayAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Nykuc2V0CiAgLCBtaWNyb3Rhc2sgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk0KSgpCiAgLCBQUk9NSVNFICAgICAgICAgICAgPSAnUHJvbWlzZScKICAsIFR5cGVFcnJvciAgICAgICAgICA9IGdsb2JhbC5UeXBlRXJyb3IKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCAkUHJvbWlzZSAgICAgICAgICAgPSBnbG9iYWxbUFJPTUlTRV0KICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBpc05vZGUgICAgICAgICAgICAgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJwogICwgZW1wdHkgICAgICAgICAgICAgID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfQogICwgSW50ZXJuYWwsIEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSwgV3JhcHBlcjsKCnZhciBVU0VfTkFUSVZFID0gISFmdW5jdGlvbigpewogIHRyeSB7CiAgICAvLyBjb3JyZWN0IHN1YmNsYXNzaW5nIHdpdGggQEBzcGVjaWVzIHN1cHBvcnQKICAgIHZhciBwcm9taXNlICAgICA9ICRQcm9taXNlLnJlc29sdmUoMSkKICAgICAgLCBGYWtlUHJvbWlzZSA9IChwcm9taXNlLmNvbnN0cnVjdG9yID0ge30pW19fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKV0gPSBmdW5jdGlvbihleGVjKXsgZXhlYyhlbXB0eSwgZW1wdHkpOyB9OwogICAgLy8gdW5oYW5kbGVkIHJlamVjdGlvbnMgdHJhY2tpbmcgc3VwcG9ydCwgTm9kZUpTIFByb21pc2Ugd2l0aG91dCBpdCBmYWlscyBAQHNwZWNpZXMgdGVzdAogICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKSAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2U7CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9KCk7CgovLyBoZWxwZXJzCnZhciBzYW1lQ29uc3RydWN0b3IgPSBmdW5jdGlvbihhLCBiKXsKICAvLyB3aXRoIGxpYnJhcnkgd3JhcHBlciBzcGVjaWFsIGNhc2UKICByZXR1cm4gYSA9PT0gYiB8fCBhID09PSAkUHJvbWlzZSAmJiBiID09PSBXcmFwcGVyOwp9Owp2YXIgaXNUaGVuYWJsZSA9IGZ1bmN0aW9uKGl0KXsKICB2YXIgdGhlbjsKICByZXR1cm4gaXNPYmplY3QoaXQpICYmIHR5cGVvZiAodGhlbiA9IGl0LnRoZW4pID09ICdmdW5jdGlvbicgPyB0aGVuIDogZmFsc2U7Cn07CnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewogIHJldHVybiBzYW1lQ29uc3RydWN0b3IoJFByb21pc2UsIEMpCiAgICA/IG5ldyBQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgOiBuZXcgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5KEMpOwp9Owp2YXIgUHJvbWlzZUNhcGFiaWxpdHkgPSBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbihDKXsKICB2YXIgcmVzb2x2ZSwgcmVqZWN0OwogIHRoaXMucHJvbWlzZSA9IG5ldyBDKGZ1bmN0aW9uKCQkcmVzb2x2ZSwgJCRyZWplY3QpewogICAgaWYocmVzb2x2ZSAhPT0gdW5kZWZpbmVkIHx8IHJlamVjdCAhPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcignQmFkIFByb21pc2UgY29uc3RydWN0b3InKTsKICAgIHJlc29sdmUgPSAkJHJlc29sdmU7CiAgICByZWplY3QgID0gJCRyZWplY3Q7CiAgfSk7CiAgdGhpcy5yZXNvbHZlID0gYUZ1bmN0aW9uKHJlc29sdmUpOwogIHRoaXMucmVqZWN0ICA9IGFGdW5jdGlvbihyZWplY3QpOwp9Owp2YXIgcGVyZm9ybSA9IGZ1bmN0aW9uKGV4ZWMpewogIHRyeSB7CiAgICBleGVjKCk7CiAgfSBjYXRjaChlKXsKICAgIHJldHVybiB7ZXJyb3I6IGV9OwogIH0KfTsKdmFyIG5vdGlmeSA9IGZ1bmN0aW9uKHByb21pc2UsIGlzUmVqZWN0KXsKICBpZihwcm9taXNlLl9uKXJldHVybjsKICBwcm9taXNlLl9uID0gdHJ1ZTsKICB2YXIgY2hhaW4gPSBwcm9taXNlLl9jOwogIG1pY3JvdGFzayhmdW5jdGlvbigpewogICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgogICAgICAsIG9rICAgID0gcHJvbWlzZS5fcyA9PSAxCiAgICAgICwgaSAgICAgPSAwOwogICAgdmFyIHJ1biA9IGZ1bmN0aW9uKHJlYWN0aW9uKXsKICAgICAgdmFyIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbAogICAgICAgICwgcmVzb2x2ZSA9IHJlYWN0aW9uLnJlc29sdmUKICAgICAgICAsIHJlamVjdCAgPSByZWFjdGlvbi5yZWplY3QKICAgICAgICAsIGRvbWFpbiAgPSByZWFjdGlvbi5kb21haW4KICAgICAgICAsIHJlc3VsdCwgdGhlbjsKICAgICAgdHJ5IHsKICAgICAgICBpZihoYW5kbGVyKXsKICAgICAgICAgIGlmKCFvayl7CiAgICAgICAgICAgIGlmKHByb21pc2UuX2ggPT0gMilvbkhhbmRsZVVuaGFuZGxlZChwcm9taXNlKTsKICAgICAgICAgICAgcHJvbWlzZS5faCA9IDE7CiAgICAgICAgICB9CiAgICAgICAgICBpZihoYW5kbGVyID09PSB0cnVlKXJlc3VsdCA9IHZhbHVlOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZW50ZXIoKTsKICAgICAgICAgICAgcmVzdWx0ID0gaGFuZGxlcih2YWx1ZSk7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZXhpdCgpOwogICAgICAgICAgfQogICAgICAgICAgaWYocmVzdWx0ID09PSByZWFjdGlvbi5wcm9taXNlKXsKICAgICAgICAgICAgcmVqZWN0KFR5cGVFcnJvcignUHJvbWlzZS1jaGFpbiBjeWNsZScpKTsKICAgICAgICAgIH0gZWxzZSBpZih0aGVuID0gaXNUaGVuYWJsZShyZXN1bHQpKXsKICAgICAgICAgICAgdGhlbi5jYWxsKHJlc3VsdCwgcmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgICAgIH0gZWxzZSByZXNvbHZlKHJlc3VsdCk7CiAgICAgICAgfSBlbHNlIHJlamVjdCh2YWx1ZSk7CiAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgcmVqZWN0KGUpOwogICAgICB9CiAgICB9OwogICAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSlydW4oY2hhaW5baSsrXSk7IC8vIHZhcmlhYmxlIGxlbmd0aCAtIGNhbid0IHVzZSBmb3JFYWNoCiAgICBwcm9taXNlLl9jID0gW107CiAgICBwcm9taXNlLl9uID0gZmFsc2U7CiAgICBpZihpc1JlamVjdCAmJiAhcHJvbWlzZS5faClvblVuaGFuZGxlZChwcm9taXNlKTsKICB9KTsKfTsKdmFyIG9uVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YKICAgICAgLCBhYnJ1cHQsIGhhbmRsZXIsIGNvbnNvbGU7CiAgICBpZihpc1VuaGFuZGxlZChwcm9taXNlKSl7CiAgICAgIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgICBpZihpc05vZGUpewogICAgICAgICAgcHJvY2Vzcy5lbWl0KCd1bmhhbmRsZWRSZWplY3Rpb24nLCB2YWx1ZSwgcHJvbWlzZSk7CiAgICAgICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub251bmhhbmRsZWRyZWplY3Rpb24pewogICAgICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiB2YWx1ZX0pOwogICAgICAgIH0gZWxzZSBpZigoY29uc29sZSA9IGdsb2JhbC5jb25zb2xlKSAmJiBjb25zb2xlLmVycm9yKXsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbicsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBCcm93c2VycyBzaG91bGQgbm90IHRyaWdnZXIgYHJlamVjdGlvbkhhbmRsZWRgIGV2ZW50IGlmIGl0IHdhcyBoYW5kbGVkIGhlcmUsIE5vZGVKUyAtIHNob3VsZAogICAgICBwcm9taXNlLl9oID0gaXNOb2RlIHx8IGlzVW5oYW5kbGVkKHByb21pc2UpID8gMiA6IDE7CiAgICB9IHByb21pc2UuX2EgPSB1bmRlZmluZWQ7CiAgICBpZihhYnJ1cHQpdGhyb3cgYWJydXB0LmVycm9yOwogIH0pOwp9Owp2YXIgaXNVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKICBpZihwcm9taXNlLl9oID09IDEpcmV0dXJuIGZhbHNlOwogIHZhciBjaGFpbiA9IHByb21pc2UuX2EgfHwgcHJvbWlzZS5fYwogICAgLCBpICAgICA9IDAKICAgICwgcmVhY3Rpb247CiAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSl7CiAgICByZWFjdGlvbiA9IGNoYWluW2krK107CiAgICBpZihyZWFjdGlvbi5mYWlsIHx8ICFpc1VuaGFuZGxlZChyZWFjdGlvbi5wcm9taXNlKSlyZXR1cm4gZmFsc2U7CiAgfSByZXR1cm4gdHJ1ZTsKfTsKdmFyIG9uSGFuZGxlVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciBoYW5kbGVyOwogICAgaWYoaXNOb2RlKXsKICAgICAgcHJvY2Vzcy5lbWl0KCdyZWplY3Rpb25IYW5kbGVkJywgcHJvbWlzZSk7CiAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnJlamVjdGlvbmhhbmRsZWQpewogICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHByb21pc2UuX3Z9KTsKICAgIH0KICB9KTsKfTsKdmFyICRyZWplY3QgPSBmdW5jdGlvbih2YWx1ZSl7CiAgdmFyIHByb21pc2UgPSB0aGlzOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHByb21pc2UuX3YgPSB2YWx1ZTsKICBwcm9taXNlLl9zID0gMjsKICBpZighcHJvbWlzZS5fYSlwcm9taXNlLl9hID0gcHJvbWlzZS5fYy5zbGljZSgpOwogIG5vdGlmeShwcm9taXNlLCB0cnVlKTsKfTsKdmFyICRyZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpewogIHZhciBwcm9taXNlID0gdGhpcwogICAgLCB0aGVuOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHRyeSB7CiAgICBpZihwcm9taXNlID09PSB2YWx1ZSl0aHJvdyBUeXBlRXJyb3IoIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmIik7CiAgICBpZih0aGVuID0gaXNUaGVuYWJsZSh2YWx1ZSkpewogICAgICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKICAgICAgICB2YXIgd3JhcHBlciA9IHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfTsgLy8gd3JhcAogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGVuLmNhbGwodmFsdWUsIGN0eCgkcmVzb2x2ZSwgd3JhcHBlciwgMSksIGN0eCgkcmVqZWN0LCB3cmFwcGVyLCAxKSk7CiAgICAgICAgfSBjYXRjaChlKXsKICAgICAgICAgICRyZWplY3QuY2FsbCh3cmFwcGVyLCBlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgcHJvbWlzZS5fdiA9IHZhbHVlOwogICAgICBwcm9taXNlLl9zID0gMTsKICAgICAgbm90aWZ5KHByb21pc2UsIGZhbHNlKTsKICAgIH0KICB9IGNhdGNoKGUpewogICAgJHJlamVjdC5jYWxsKHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfSwgZSk7IC8vIHdyYXAKICB9Cn07CgovLyBjb25zdHJ1Y3RvciBwb2x5ZmlsbAppZighVVNFX05BVElWRSl7CiAgLy8gMjUuNC4zLjEgUHJvbWlzZShleGVjdXRvcikKICAkUHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpewogICAgYW5JbnN0YW5jZSh0aGlzLCAkUHJvbWlzZSwgUFJPTUlTRSwgJ19oJyk7CiAgICBhRnVuY3Rpb24oZXhlY3V0b3IpOwogICAgSW50ZXJuYWwuY2FsbCh0aGlzKTsKICAgIHRyeSB7CiAgICAgIGV4ZWN1dG9yKGN0eCgkcmVzb2x2ZSwgdGhpcywgMSksIGN0eCgkcmVqZWN0LCB0aGlzLCAxKSk7CiAgICB9IGNhdGNoKGVycil7CiAgICAgICRyZWplY3QuY2FsbCh0aGlzLCBlcnIpOwogICAgfQogIH07CiAgSW50ZXJuYWwgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKICAgIHRoaXMuX2MgPSBbXTsgICAgICAgICAgICAgLy8gPC0gYXdhaXRpbmcgcmVhY3Rpb25zCiAgICB0aGlzLl9hID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIGNoZWNrZWQgaW4gaXNVbmhhbmRsZWQgcmVhY3Rpb25zCiAgICB0aGlzLl9zID0gMDsgICAgICAgICAgICAgIC8vIDwtIHN0YXRlCiAgICB0aGlzLl9kID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIGRvbmUKICAgIHRoaXMuX3YgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gdmFsdWUKICAgIHRoaXMuX2ggPSAwOyAgICAgICAgICAgICAgLy8gPC0gcmVqZWN0aW9uIHN0YXRlLCAwIC0gZGVmYXVsdCwgMSAtIGhhbmRsZWQsIDIgLSB1bmhhbmRsZWQKICAgIHRoaXMuX24gPSBmYWxzZTsgICAgICAgICAgLy8gPC0gbm90aWZ5CiAgfTsKICBJbnRlcm5hbC5wcm90b3R5cGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KSgkUHJvbWlzZS5wcm90b3R5cGUsIHsKICAgIC8vIDI1LjQuNS4zIFByb21pc2UucHJvdG90eXBlLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpCiAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKXsKICAgICAgdmFyIHJlYWN0aW9uICAgID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsICRQcm9taXNlKSk7CiAgICAgIHJlYWN0aW9uLm9rICAgICA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PSAnZnVuY3Rpb24nID8gb25GdWxmaWxsZWQgOiB0cnVlOwogICAgICByZWFjdGlvbi5mYWlsICAgPSB0eXBlb2Ygb25SZWplY3RlZCA9PSAnZnVuY3Rpb24nICYmIG9uUmVqZWN0ZWQ7CiAgICAgIHJlYWN0aW9uLmRvbWFpbiA9IGlzTm9kZSA/IHByb2Nlc3MuZG9tYWluIDogdW5kZWZpbmVkOwogICAgICB0aGlzLl9jLnB1c2gocmVhY3Rpb24pOwogICAgICBpZih0aGlzLl9hKXRoaXMuX2EucHVzaChyZWFjdGlvbik7CiAgICAgIGlmKHRoaXMuX3Mpbm90aWZ5KHRoaXMsIGZhbHNlKTsKICAgICAgcmV0dXJuIHJlYWN0aW9uLnByb21pc2U7CiAgICB9LAogICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2gob25SZWplY3RlZCkKICAgICdjYXRjaCc6IGZ1bmN0aW9uKG9uUmVqZWN0ZWQpewogICAgICByZXR1cm4gdGhpcy50aGVuKHVuZGVmaW5lZCwgb25SZWplY3RlZCk7CiAgICB9CiAgfSk7CiAgUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbigpewogICAgdmFyIHByb21pc2UgID0gbmV3IEludGVybmFsOwogICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTsKICAgIHRoaXMucmVzb2x2ZSA9IGN0eCgkcmVzb2x2ZSwgcHJvbWlzZSwgMSk7CiAgICB0aGlzLnJlamVjdCAgPSBjdHgoJHJlamVjdCwgcHJvbWlzZSwgMSk7CiAgfTsKfQoKJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1Byb21pc2U6ICRQcm9taXNlfSk7Cl9fd2VicGFja19yZXF1aXJlX18oMjEpKCRQcm9taXNlLCBQUk9NSVNFKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg5OCkoUFJPTUlTRSk7CldyYXBwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApW1BST01JU0VdOwoKLy8gc3RhdGljcwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCBQUk9NSVNFLCB7CiAgLy8gMjUuNC40LjUgUHJvbWlzZS5yZWplY3QocikKICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyKXsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlamVjdCAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgICAkJHJlamVjdChyKTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQp9KTsKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoTElCUkFSWSB8fCAhVVNFX05BVElWRSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuNiBQcm9taXNlLnJlc29sdmUoeCkKICByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKHgpewogICAgLy8gaW5zdGFuY2VvZiBpbnN0ZWFkIG9mIGludGVybmFsIHNsb3QgY2hlY2sgYmVjYXVzZSB3ZSBzaG91bGQgZml4IGl0IHdpdGhvdXQgcmVwbGFjZW1lbnQgbmF0aXZlIFByb21pc2UgY29yZQogICAgaWYoeCBpbnN0YW5jZW9mICRQcm9taXNlICYmIHNhbWVDb25zdHJ1Y3Rvcih4LmNvbnN0cnVjdG9yLCB0aGlzKSlyZXR1cm4geDsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlc29sdmUgID0gY2FwYWJpbGl0eS5yZXNvbHZlOwogICAgJCRyZXNvbHZlKHgpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoVVNFX05BVElWRSAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fKDkyKShmdW5jdGlvbihpdGVyKXsKICAkUHJvbWlzZS5hbGwoaXRlcilbJ2NhdGNoJ10oZW1wdHkpOwp9KSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuMSBQcm9taXNlLmFsbChpdGVyYWJsZSkKICBhbGw6IGZ1bmN0aW9uIGFsbChpdGVyYWJsZSl7CiAgICB2YXIgQyAgICAgICAgICA9IHRoaXMKICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKICAgICAgLCByZXNvbHZlICAgID0gY2FwYWJpbGl0eS5yZXNvbHZlCiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwogICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgdmFyIHZhbHVlcyAgICA9IFtdCiAgICAgICAgLCBpbmRleCAgICAgPSAwCiAgICAgICAgLCByZW1haW5pbmcgPSAxOwogICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2UpewogICAgICAgIHZhciAkaW5kZXggICAgICAgID0gaW5kZXgrKwogICAgICAgICAgLCBhbHJlYWR5Q2FsbGVkID0gZmFsc2U7CiAgICAgICAgdmFsdWVzLnB1c2godW5kZWZpbmVkKTsKICAgICAgICByZW1haW5pbmcrKzsKICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgICBpZihhbHJlYWR5Q2FsbGVkKXJldHVybjsKICAgICAgICAgIGFscmVhZHlDYWxsZWQgID0gdHJ1ZTsKICAgICAgICAgIHZhbHVlc1skaW5kZXhdID0gdmFsdWU7CiAgICAgICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgfSk7CiAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9LAogIC8vIDI1LjQuNC40IFByb21pc2UucmFjZShpdGVyYWJsZSkKICByYWNlOiBmdW5jdGlvbiByYWNlKGl0ZXJhYmxlKXsKICAgIHZhciBDICAgICAgICAgID0gdGhpcwogICAgICAsIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgICAsIHJlamVjdCAgICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oY2FwYWJpbGl0eS5yZXNvbHZlLCByZWplY3QpOwogICAgICB9KTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwoKLyoqKi8gfSksCi8qIDEwNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyBFQ01BU2NyaXB0IDYgc3ltYm9scyBzaGltCnZhciBnbG9iYWwgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIERFU0NSSVBUT1JTICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBNRVRBICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpLktFWQogICwgJGZhaWxzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKQogICwgc2hhcmVkICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgdWlkICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKQogICwgd2tzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpCiAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCiAgLCB3a3NEZWZpbmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDgpCiAgLCBrZXlPZiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTMpCiAgLCBlbnVtS2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODYpCiAgLCBpc0FycmF5ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTApCiAgLCBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIF9jcmVhdGUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSkKICAsIGdPUE5FeHQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NSkKICAsICRHT1BEICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NykKICAsICREUCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgJGtleXMgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QRCAgICAgICAgICAgPSAkR09QRC5mCiAgLCBkUCAgICAgICAgICAgICA9ICREUC5mCiAgLCBnT1BOICAgICAgICAgICA9IGdPUE5FeHQuZgogICwgJFN5bWJvbCAgICAgICAgPSBnbG9iYWwuU3ltYm9sCiAgLCAkSlNPTiAgICAgICAgICA9IGdsb2JhbC5KU09OCiAgLCBfc3RyaW5naWZ5ICAgICA9ICRKU09OICYmICRKU09OLnN0cmluZ2lmeQogICwgUFJPVE9UWVBFICAgICAgPSAncHJvdG90eXBlJwogICwgSElEREVOICAgICAgICAgPSB3a3MoJ19oaWRkZW4nKQogICwgVE9fUFJJTUlUSVZFICAgPSB3a3MoJ3RvUHJpbWl0aXZlJykKICAsIGlzRW51bSAgICAgICAgID0ge30ucHJvcGVydHlJc0VudW1lcmFibGUKICAsIFN5bWJvbFJlZ2lzdHJ5ID0gc2hhcmVkKCdzeW1ib2wtcmVnaXN0cnknKQogICwgQWxsU3ltYm9scyAgICAgPSBzaGFyZWQoJ3N5bWJvbHMnKQogICwgT1BTeW1ib2xzICAgICAgPSBzaGFyZWQoJ29wLXN5bWJvbHMnKQogICwgT2JqZWN0UHJvdG8gICAgPSBPYmplY3RbUFJPVE9UWVBFXQogICwgVVNFX05BVElWRSAgICAgPSB0eXBlb2YgJFN5bWJvbCA9PSAnZnVuY3Rpb24nCiAgLCBRT2JqZWN0ICAgICAgICA9IGdsb2JhbC5RT2JqZWN0OwovLyBEb24ndCB1c2Ugc2V0dGVycyBpbiBRdCBTY3JpcHQsIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8xNzMKdmFyIHNldHRlciA9ICFRT2JqZWN0IHx8ICFRT2JqZWN0W1BST1RPVFlQRV0gfHwgIVFPYmplY3RbUFJPVE9UWVBFXS5maW5kQ2hpbGQ7CgovLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODcKdmFyIHNldFN5bWJvbERlc2MgPSBERVNDUklQVE9SUyAmJiAkZmFpbHMoZnVuY3Rpb24oKXsKICByZXR1cm4gX2NyZWF0ZShkUCh7fSwgJ2EnLCB7CiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBkUCh0aGlzLCAnYScsIHt2YWx1ZTogN30pLmE7IH0KICB9KSkuYSAhPSA3Owp9KSA/IGZ1bmN0aW9uKGl0LCBrZXksIEQpewogIHZhciBwcm90b0Rlc2MgPSBnT1BEKE9iamVjdFByb3RvLCBrZXkpOwogIGlmKHByb3RvRGVzYylkZWxldGUgT2JqZWN0UHJvdG9ba2V5XTsKICBkUChpdCwga2V5LCBEKTsKICBpZihwcm90b0Rlc2MgJiYgaXQgIT09IE9iamVjdFByb3RvKWRQKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7Cn0gOiBkUDsKCnZhciB3cmFwID0gZnVuY3Rpb24odGFnKXsKICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pOwogIHN5bS5fayA9IHRhZzsKICByZXR1cm4gc3ltOwp9OwoKdmFyIGlzU3ltYm9sID0gVVNFX05BVElWRSAmJiB0eXBlb2YgJFN5bWJvbC5pdGVyYXRvciA9PSAnc3ltYm9sJyA/IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnOwp9IDogZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCBpbnN0YW5jZW9mICRTeW1ib2w7Cn07Cgp2YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCl7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvKSRkZWZpbmVQcm9wZXJ0eShPUFN5bWJvbHMsIGtleSwgRCk7CiAgYW5PYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgYW5PYmplY3QoRCk7CiAgaWYoaGFzKEFsbFN5bWJvbHMsIGtleSkpewogICAgaWYoIUQuZW51bWVyYWJsZSl7CiAgICAgIGlmKCFoYXMoaXQsIEhJRERFTikpZFAoaXQsIEhJRERFTiwgY3JlYXRlRGVzYygxLCB7fSkpOwogICAgICBpdFtISURERU5dW2tleV0gPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgaWYoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSlpdFtISURERU5dW2tleV0gPSBmYWxzZTsKICAgICAgRCA9IF9jcmVhdGUoRCwge2VudW1lcmFibGU6IGNyZWF0ZURlc2MoMCwgZmFsc2UpfSk7CiAgICB9IHJldHVybiBzZXRTeW1ib2xEZXNjKGl0LCBrZXksIEQpOwogIH0gcmV0dXJuIGRQKGl0LCBrZXksIEQpOwp9Owp2YXIgJGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKGl0LCBQKXsKICBhbk9iamVjdChpdCk7CiAgdmFyIGtleXMgPSBlbnVtS2V5cyhQID0gdG9JT2JqZWN0KFApKQogICAgLCBpICAgID0gMAogICAgLCBsID0ga2V5cy5sZW5ndGgKICAgICwga2V5OwogIHdoaWxlKGwgPiBpKSRkZWZpbmVQcm9wZXJ0eShpdCwga2V5ID0ga2V5c1tpKytdLCBQW2tleV0pOwogIHJldHVybiBpdDsKfTsKdmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaXQsIFApewogIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfY3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9jcmVhdGUoaXQpLCBQKTsKfTsKdmFyICRwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IGZ1bmN0aW9uIHByb3BlcnR5SXNFbnVtZXJhYmxlKGtleSl7CiAgdmFyIEUgPSBpc0VudW0uY2FsbCh0aGlzLCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKTsKICBpZih0aGlzID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSlyZXR1cm4gZmFsc2U7CiAgcmV0dXJuIEUgfHwgIWhhcyh0aGlzLCBrZXkpIHx8ICFoYXMoQWxsU3ltYm9scywga2V5KSB8fCBoYXModGhpcywgSElEREVOKSAmJiB0aGlzW0hJRERFTl1ba2V5XSA/IEUgOiB0cnVlOwp9Owp2YXIgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICBpdCAgPSB0b0lPYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKXJldHVybjsKICB2YXIgRCA9IGdPUEQoaXQsIGtleSk7CiAgaWYoRCAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKUQuZW51bWVyYWJsZSA9IHRydWU7CiAgcmV0dXJuIEQ7Cn07CnZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpewogIHZhciBuYW1lcyAgPSBnT1BOKHRvSU9iamVjdChpdCkpCiAgICAsIHJlc3VsdCA9IFtdCiAgICAsIGkgICAgICA9IDAKICAgICwga2V5OwogIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewogICAgaWYoIWhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiBrZXkgIT0gSElEREVOICYmIGtleSAhPSBNRVRBKXJlc3VsdC5wdXNoKGtleSk7CiAgfSByZXR1cm4gcmVzdWx0Owp9Owp2YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCl7CiAgdmFyIElTX09QICA9IGl0ID09PSBPYmplY3RQcm90bwogICAgLCBuYW1lcyAgPSBnT1BOKElTX09QID8gT1BTeW1ib2xzIDogdG9JT2JqZWN0KGl0KSkKICAgICwgcmVzdWx0ID0gW10KICAgICwgaSAgICAgID0gMAogICAgLCBrZXk7CiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7CiAgICBpZihoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYgKElTX09QID8gaGFzKE9iamVjdFByb3RvLCBrZXkpIDogdHJ1ZSkpcmVzdWx0LnB1c2goQWxsU3ltYm9sc1trZXldKTsKICB9IHJldHVybiByZXN1bHQ7Cn07CgovLyAxOS40LjEuMSBTeW1ib2woW2Rlc2NyaXB0aW9uXSkKaWYoIVVTRV9OQVRJVkUpewogICRTeW1ib2wgPSBmdW5jdGlvbiBTeW1ib2woKXsKICAgIGlmKHRoaXMgaW5zdGFuY2VvZiAkU3ltYm9sKXRocm93IFR5cGVFcnJvcignU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIScpOwogICAgdmFyIHRhZyA9IHVpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7CiAgICB2YXIgJHNldCA9IGZ1bmN0aW9uKHZhbHVlKXsKICAgICAgaWYodGhpcyA9PT0gT2JqZWN0UHJvdG8pJHNldC5jYWxsKE9QU3ltYm9scywgdmFsdWUpOwogICAgICBpZihoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKXRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7CiAgICAgIHNldFN5bWJvbERlc2ModGhpcywgdGFnLCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7CiAgICB9OwogICAgaWYoREVTQ1JJUFRPUlMgJiYgc2V0dGVyKXNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0fSk7CiAgICByZXR1cm4gd3JhcCh0YWcpOwogIH07CiAgcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEVdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpewogICAgcmV0dXJuIHRoaXMuX2s7CiAgfSk7CgogICRHT1BELmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwogICREUC5mICAgPSAkZGVmaW5lUHJvcGVydHk7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg2NSkuZiA9IGdPUE5FeHQuZiA9ICRnZXRPd25Qcm9wZXJ0eU5hbWVzOwogIF9fd2VicGFja19yZXF1aXJlX18oNDEpLmYgID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlOwogIF9fd2VicGFja19yZXF1aXJlX18oNTgpLmYgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKICBpZihERVNDUklQVE9SUyAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygyNSkpewogICAgcmVkZWZpbmUoT2JqZWN0UHJvdG8sICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsICRwcm9wZXJ0eUlzRW51bWVyYWJsZSwgdHJ1ZSk7CiAgfQoKICB3a3NFeHQuZiA9IGZ1bmN0aW9uKG5hbWUpewogICAgcmV0dXJuIHdyYXAod2tzKG5hbWUpKTsKICB9Cn0KCiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtTeW1ib2w6ICRTeW1ib2x9KTsKCmZvcih2YXIgc3ltYm9scyA9ICgKICAvLyAxOS40LjIuMiwgMTkuNC4yLjMsIDE5LjQuMi40LCAxOS40LjIuNiwgMTkuNC4yLjgsIDE5LjQuMi45LCAxOS40LjIuMTAsIDE5LjQuMi4xMSwgMTkuNC4yLjEyLCAxOS40LjIuMTMsIDE5LjQuMi4xNAogICdoYXNJbnN0YW5jZSxpc0NvbmNhdFNwcmVhZGFibGUsaXRlcmF0b3IsbWF0Y2gscmVwbGFjZSxzZWFyY2gsc3BlY2llcyxzcGxpdCx0b1ByaW1pdGl2ZSx0b1N0cmluZ1RhZyx1bnNjb3BhYmxlcycKKS5zcGxpdCgnLCcpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzKHN5bWJvbHNbaSsrXSk7Cgpmb3IodmFyIHN5bWJvbHMgPSAka2V5cyh3a3Muc3RvcmUpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzRGVmaW5lKHN5bWJvbHNbaSsrXSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywgewogIC8vIDE5LjQuMi4xIFN5bWJvbC5mb3Ioa2V5KQogICdmb3InOiBmdW5jdGlvbihrZXkpewogICAgcmV0dXJuIGhhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKQogICAgICA/IFN5bWJvbFJlZ2lzdHJ5W2tleV0KICAgICAgOiBTeW1ib2xSZWdpc3RyeVtrZXldID0gJFN5bWJvbChrZXkpOwogIH0sCiAgLy8gMTkuNC4yLjUgU3ltYm9sLmtleUZvcihzeW0pCiAga2V5Rm9yOiBmdW5jdGlvbiBrZXlGb3Ioa2V5KXsKICAgIGlmKGlzU3ltYm9sKGtleSkpcmV0dXJuIGtleU9mKFN5bWJvbFJlZ2lzdHJ5LCBrZXkpOwogICAgdGhyb3cgVHlwZUVycm9yKGtleSArICcgaXMgbm90IGEgc3ltYm9sIScpOwogIH0sCiAgdXNlU2V0dGVyOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSB0cnVlOyB9LAogIHVzZVNpbXBsZTogZnVuY3Rpb24oKXsgc2V0dGVyID0gZmFsc2U7IH0KfSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnT2JqZWN0JywgewogIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKICBjcmVhdGU6ICRjcmVhdGUsCiAgLy8gMTkuMS4yLjQgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCiAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSwKICAvLyAxOS4xLjIuMyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKQogIGRlZmluZVByb3BlcnRpZXM6ICRkZWZpbmVQcm9wZXJ0aWVzLAogIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkKICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsCiAgLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcywKICAvLyAxOS4xLjIuOCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKE8pCiAgZ2V0T3duUHJvcGVydHlTeW1ib2xzOiAkZ2V0T3duUHJvcGVydHlTeW1ib2xzCn0pOwoKLy8gMjQuMy4yIEpTT04uc3RyaW5naWZ5KHZhbHVlIFssIHJlcGxhY2VyIFssIHNwYWNlXV0pCiRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbigpewogIHZhciBTID0gJFN5bWJvbCgpOwogIC8vIE1TIEVkZ2UgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIHt9CiAgLy8gV2ViS2l0IGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyBudWxsCiAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHMKICByZXR1cm4gX3N0cmluZ2lmeShbU10pICE9ICdbbnVsbF0nIHx8IF9zdHJpbmdpZnkoe2E6IFN9KSAhPSAne30nIHx8IF9zdHJpbmdpZnkoT2JqZWN0KFMpKSAhPSAne30nOwp9KSksICdKU09OJywgewogIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXsKICAgIGlmKGl0ID09PSB1bmRlZmluZWQgfHwgaXNTeW1ib2woaXQpKXJldHVybjsgLy8gSUU4IHJldHVybnMgc3RyaW5nIG9uIHVuZGVmaW5lZAogICAgdmFyIGFyZ3MgPSBbaXRdCiAgICAgICwgaSAgICA9IDEKICAgICAgLCByZXBsYWNlciwgJHJlcGxhY2VyOwogICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKICAgIHJlcGxhY2VyID0gYXJnc1sxXTsKICAgIGlmKHR5cGVvZiByZXBsYWNlciA9PSAnZnVuY3Rpb24nKSRyZXBsYWNlciA9IHJlcGxhY2VyOwogICAgaWYoJHJlcGxhY2VyIHx8ICFpc0FycmF5KHJlcGxhY2VyKSlyZXBsYWNlciA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpewogICAgICBpZigkcmVwbGFjZXIpdmFsdWUgPSAkcmVwbGFjZXIuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTsKICAgICAgaWYoIWlzU3ltYm9sKHZhbHVlKSlyZXR1cm4gdmFsdWU7CiAgICB9OwogICAgYXJnc1sxXSA9IHJlcGxhY2VyOwogICAgcmV0dXJuIF9zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3MpOwogIH0KfSk7CgovLyAxOS40LjMuNCBTeW1ib2wucHJvdG90eXBlW0BAdG9QcmltaXRpdmVdKGhpbnQpCiRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IF9fd2VicGFja19yZXF1aXJlX18oNikoJFN5bWJvbFtQUk9UT1RZUEVdLCBUT19QUklNSVRJVkUsICRTeW1ib2xbUFJPVE9UWVBFXS52YWx1ZU9mKTsKLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXQpzZXRUb1N0cmluZ1RhZygkU3ltYm9sLCAnU3ltYm9sJyk7Ci8vIDIwLjIuMS45IE1hdGhbQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTsKLy8gMjQuMy4zIEpTT05bQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoZ2xvYmFsLkpTT04sICdKU09OJywgdHJ1ZSk7CgovKioqLyB9KSwKLyogMTA2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdhc3luY0l0ZXJhdG9yJyk7CgovKioqLyB9KSwKLyogMTA3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdvYnNlcnZhYmxlJyk7CgovKioqLyB9KSwKLyogMTA4ICovLAovKiAxMDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfc3RyaW5naWZ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7Cgp2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKZXhwb3J0cy5kaXZpZGVFbWFpbCA9IGRpdmlkZUVtYWlsOwpleHBvcnRzLmVtcHR5T2JqZWN0ID0gZW1wdHlPYmplY3Q7CmV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwpleHBvcnRzLmdldFVzZXJVUkxGcm9tRW1haWwgPSBnZXRVc2VyVVJMRnJvbUVtYWlsOwpleHBvcnRzLmdldFVzZXJFbWFpbEZyb21VUkwgPSBnZXRVc2VyRW1haWxGcm9tVVJMOwpleHBvcnRzLmNvbnZlcnRUb1VzZXJVUkwgPSBjb252ZXJ0VG9Vc2VyVVJMOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwovKioKICogU3VwcG9ydCBtb2R1bGUgd2l0aCBzb21lIGZ1bmN0aW9ucyB3aWxsIGJlIHVzZWZ1bAogKiBAbW9kdWxlIHV0aWxzCiAqLwoKLyoqCiAqIEB0eXBlZGVmIGRpdmlkZVVSTAogKiBAdHlwZSBPYmplY3QKICogQHByb3BlcnR5IHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgVVJMCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkb21haW4gVGhlIGRvbWFpbiBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiBVUkwKICovCgovKioKICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5CiAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAqIEByZXR1cm4ge2RpdmlkZVVSTH0gdGhlIHJlc3VsdCBvZiBkaXZpZGVVUkwKICovCmZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHsKCiAgaWYgKCF1cmwpIHRocm93IEVycm9yKCdVUkwgaXMgbmVlZGVkIHRvIHNwbGl0Jyk7CgogIGZ1bmN0aW9uIHJlY3Vyc2UodmFsdWUpIHsKICAgIHZhciByZWdleCA9IC8oW2EtekEtWi1dKikoOlwvXC8oPzpcLik/fDopKFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTsKICAgIHZhciBzdWJzdCA9ICckMSwkMywkNCc7CiAgICB2YXIgcGFydHMgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBzdWJzdCkuc3BsaXQoJywnKTsKICAgIHJldHVybiBwYXJ0czsKICB9CgogIHZhciBwYXJ0cyA9IHJlY3Vyc2UodXJsKTsKCiAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lCiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgIXBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKCiAgICB2YXIgX3Jlc3VsdCA9IHsKICAgICAgdHlwZTogIiIsCiAgICAgIGRvbWFpbjogdXJsLAogICAgICBpZGVudGl0eTogIiIKICAgIH07CgogICAgY29uc29sZS5lcnJvcignW0RpdmlkZVVSTF0gRGl2aWRlVVJMIGRvblwndCBzdXBwb3J0IHVybCB3aXRob3V0IHNjaGVtZS4gUGxlYXNlIHJldmlldyB5b3VyIHVybCBhZGRyZXNzJywgdXJsKTsKCiAgICByZXR1cm4gX3Jlc3VsdDsKICB9CgogIC8vIGNoZWNrIGlmIHRoZSB1cmwgaGFzIHRoZSBzY2hlbWUgYW5kIGluY2x1ZGVzIGFuIEAKICBpZiAocGFydHNbMF0gPT09IHVybCAmJiBwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CiAgICB2YXIgc2NoZW1lID0gcGFydHNbMF0gPT09IHVybCA/ICdzbXRwJyA6IHBhcnRzWzBdOwogICAgcGFydHMgPSByZWN1cnNlKHNjaGVtZSArICc6Ly8nICsgcGFydHNbMF0pOwogIH0KCiAgLy8gaWYgdGhlIGRvbWFpbiBpbmNsdWRlcyBhbiBALCBkaXZpZGUgaXQgdG8gZG9tYWluIGFuZCBpZGVudGl0eSByZXNwZWN0aXZlbHkKICBpZiAocGFydHNbMV0uaW5jbHVkZXMoJ0AnKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1swXSArICc6Ly8nICsgcGFydHNbMV07CiAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdLnN1YnN0cihwYXJ0c1sxXS5pbmRleE9mKCdAJykgKyAxKTsKICB9IC8qZWxzZSBpZiAocGFydHNbMl0uaW5jbHVkZXMoJy8nKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1syXS5zdWJzdHIocGFydHNbMl0ubGFzdEluZGV4T2YoJy8nKSsxKTsKICAgIH0qLwoKICB2YXIgcmVzdWx0ID0gewogICAgdHlwZTogcGFydHNbMF0sCiAgICBkb21haW46IHBhcnRzWzFdLAogICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgfTsKCiAgcmV0dXJuIHJlc3VsdDsKfQoKZnVuY3Rpb24gZGl2aWRlRW1haWwoZW1haWwpIHsKICB2YXIgaW5kZXhPZkF0ID0gZW1haWwuaW5kZXhPZignQCcpOwoKICB2YXIgcmVzdWx0ID0gewogICAgdXNlcm5hbWU6IGVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpLAogICAgZG9tYWluOiBlbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgZW1haWwubGVuZ3RoKQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBDaGVjayBpZiBhbiBPYmplY3QgaXMgZW1wdHkKICogQHBhcmFtICB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IHRvIGJlIGNoZWNrZWQKICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgc3RhdHVzIG9mIE9iamVjdCwgZW1wdHkgb3Igbm90ICh0cnVlfGZhbHNlKTsKICovCmZ1bmN0aW9uIGVtcHR5T2JqZWN0KG9iamVjdCkgewogIHJldHVybiAoMCwgX2tleXMyLmRlZmF1bHQpKG9iamVjdCkubGVuZ3RoID4gMCA/IGZhbHNlIDogdHJ1ZTsKfQoKLyoqCiAqIE1ha2UgYSBDT1BZIG9mIHRoZSBvcmlnaW5hbCBkYXRhCiAqIEBwYXJhbSAge09iamVjdH0gIG9iaiAtIG9iamVjdCB0byBiZSBjbG9uZWQKICogQHJldHVybiB7T2JqZWN0fQogKi8KZnVuY3Rpb24gZGVlcENsb25lKG9iaikgewogIC8vVE9ETzogc2ltcGxlIGJ1dCBpbmVmZmljaWVudCBKU09OIGRlZXAgY2xvbmUuLi4KICBpZiAob2JqKSByZXR1cm4gSlNPTi5wYXJzZSgoMCwgX3N0cmluZ2lmeTIuZGVmYXVsdCkob2JqKSk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIFVSTCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gZW1haWwKICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICogQHJldHVybiB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICovCmZ1bmN0aW9uIGdldFVzZXJVUkxGcm9tRW1haWwodXNlckVtYWlsKSB7CiAgdmFyIGluZGV4T2ZBdCA9IHVzZXJFbWFpbC5pbmRleE9mKCdAJyk7CiAgcmV0dXJuICd1c2VyOi8vJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgdXNlckVtYWlsLmxlbmd0aCkgKyAnLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIGVtYWlsIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBVUkwKICogQHBhcmFtICB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICogQHJldHVybiB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICovCmZ1bmN0aW9uIGdldFVzZXJFbWFpbEZyb21VUkwodXNlclVSTCkgewogIHZhciB1cmwgPSBkaXZpZGVVUkwodXNlclVSTCk7CiAgcmV0dXJuIHVybC5pZGVudGl0eS5yZXBsYWNlKCcvJywgJycpICsgJ0AnICsgdXJsLmRvbWFpbjsgLy8gaWRlbnRpdHkgZmllbGQgaGFzICcvZXhhbXBsZUlEJyBpbnN0ZWFkIG9mICdleGFtcGxlSUQnCn0KCi8qKgogKiBDaGVjayBpZiB0aGUgdXNlciBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIFVSTCBmb3JtYXQsIGlmIG5vdCwgY29udmVydCB0byBVUkwgZm9ybWF0CiAqIEBwYXJhbSAge3N0cmluZ30gICBpZGVudGlmaWVyICB1c2VyIGlkZW50aWZpZXIKICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMCiAqLwpmdW5jdGlvbiBjb252ZXJ0VG9Vc2VyVVJMKGlkZW50aWZpZXIpIHsKCiAgLy8gY2hlY2sgaWYgdGhlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgdXJsIGZvcm1hdAogIGlmIChpZGVudGlmaWVyLnN1YnN0cmluZygwLCA3KSA9PT0gJ3VzZXI6Ly8nKSB7CiAgICB2YXIgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChpZGVudGlmaWVyKTsKCiAgICAvL2NoZWNrIGlmIHRoZSB1cmwgaXMgd2VsbCBmb3JtYXRlZAogICAgaWYgKGRpdmlkZWRVUkwuZG9tYWluICYmIGRpdmlkZWRVUkwuaWRlbnRpdHkpIHsKICAgICAgcmV0dXJuIGlkZW50aWZpZXI7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyAndXNlclVSTCB3aXRoIHdyb25nIGZvcm1hdCc7CiAgICB9CgogICAgLy9pZiBub3QsIGNvbnZlcnQgdGhlIHVzZXIgZW1haWwgdG8gVVJMIGZvcm1hdAogIH0gZWxzZSB7CiAgICByZXR1cm4gZ2V0VXNlclVSTEZyb21FbWFpbChpZGVudGlmaWVyKTsKICB9Cn0KCi8qKiovIH0pLAovKiAxMTAgKi8sCi8qIDExMSAqLywKLyogMTEyICovLAovKiAxMTMgKi8sCi8qIDExNCAqLywKLyogMTE1ICovLAovKiAxMTYgKi8sCi8qIDExNyAqLywKLyogMTE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMik7Cgp2YXIgX2dldDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMyk7Cgp2YXIgX2dldDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXQyKTsKCnZhciBfaW5oZXJpdHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMyk7Cgp2YXIgX2luaGVyaXRzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2luaGVyaXRzMik7Cgp2YXIgX0RhdGFPYmplY3QyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjApOwoKdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCnZhciBfRGF0YU9iamVjdENoaWxkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjEpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdENoaWxkKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBGaWx0ZXJUeXBlID0geyBBTlk6ICdhbnknLCBTVEFSVDogJ3N0YXJ0JywgRVhBQ1Q6ICdleGFjdCcgfTsKCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBzdWJzY3JpYmUgY2FsbC4KICogVG8gYmUgdXNlZCBhcyBhbiBvYnNlcnZhdGlvbiBwb2ludCBmcm9tIGEgRGF0YU9iamVjdFJlcG9ydGVyIGNoYW5nZS4KICovCgp2YXIgRGF0YU9iamVjdE9ic2VydmVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CiAgKDAsIF9pbmhlcml0czMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBfRGF0YU9iamVjdCk7CgogIC8qIHByaXZhdGUKICBfY2hhbmdlTGlzdGVuZXI6IE1zZ0xpc3RlbmVyCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfZmlsdGVyczogezxmaWx0ZXI+OiB7dHlwZTogPHN0YXJ0LCBleGFjdD4sIGNhbGxiYWNrOiA8ZnVuY3Rpb24+fSB9CiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyLnN1YnNjcmliZSBtZXRob2QKICAgKi8KCiAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogIGZ1bmN0aW9uIERhdGFPYmplY3RPYnNlcnZlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucywgaW5pdGlhbFZlcnNpb24sIG11dHVhbCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdE9ic2VydmVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdE9ic2VydmVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YS5kYXRhLCBjaGlsZHJlbnMsIG11dHVhbCkpOwoKICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IGluaXRpYWxWZXJzaW9uOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewogICAgICBfdGhpcy5fb25GaWx0ZXIoZXZlbnQpOwogICAgfSk7CgogICAgLy9zZXR1cCBjaGlsZHJlbnMgZGF0YSBmcm9tIHN1YnNjcmlwdGlvbgogICAgKDAsIF9rZXlzMi5kZWZhdWx0KShpbml0aWFsRGF0YS5jaGlsZHJlbnMpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkSWQpIHsKICAgICAgdmFyIGNoaWxkRGF0YSA9IGluaXRpYWxEYXRhLmNoaWxkcmVuc1tjaGlsZElkXTsKICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBjaGlsZElkLCBjaGlsZERhdGEpOwogICAgfSk7CgogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwgKyAnL2NoYW5nZXMnLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgaWYgKG1zZy50eXBlID09PSAndXBkYXRlJykgewogICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwogICAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChfdGhpcy5fc3luY09iaiwgbXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICd1bnN1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsVW5TdWJzY3JpYmUKICAgICAgdmFyIHVuU3Vic2NyaWJlTXNnID0gewogICAgICAgIHR5cGU6ICd1bnN1YnNjcmliZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHVuU3Vic2NyaWJlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdE9ic2VydmVyLVVOU1VCU0NSSUJFOiAnLCByZXBseSk7CiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsdGVyIC0gRmlsdGVyIHRoYXQgaWRlbnRpZmllcyB0aGUgZmllbGQgKHNlcGFyYXRlZCBkb3QgcGF0aCkuIEFjY2VwdHMgKiBhdCB0aGUgZW5kIGZvciBhIG1vcmUgdW5yZXN0cmljdGVkIGZpbHRlcmluZy4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkNoYW5nZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2UoZmlsdGVyLCBjYWxsYmFjaykgewogICAgICB2YXIga2V5ID0gZmlsdGVyOwogICAgICB2YXIgZmlsdGVyT2JqID0gewogICAgICAgIHR5cGU6IEZpbHRlclR5cGUuRVhBQ1QsCiAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrCiAgICAgIH07CgogICAgICB2YXIgaWR4ID0gZmlsdGVyLmluZGV4T2YoJyonKTsKICAgICAgaWYgKGlkeCA9PT0gZmlsdGVyLmxlbmd0aCAtIDEpIHsKICAgICAgICBpZiAoaWR4ID09PSAwKSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuQU5ZOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuU1RBUlQ7CiAgICAgICAgICBrZXkgPSBmaWx0ZXIuc3Vic3RyKDAsIGZpbHRlci5sZW5ndGggLSAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuX2ZpbHRlcnNba2V5XSA9IGZpbHRlck9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25GaWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZpbHRlcihldmVudCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fZmlsdGVycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdmFyIGZpbHRlciA9IF90aGlzLl9maWx0ZXJzW2tleV07CiAgICAgICAgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLkFOWSkgewogICAgICAgICAgLy9tYXRjaCBhbnl0aGluZwogICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKICAgICAgICB9IGVsc2UgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLlNUQVJUKSB7CiAgICAgICAgICAvL2lmIHN0YXJ0cyB3aXRoIGZpbHRlci4uLgogICAgICAgICAgaWYgKGV2ZW50LmZpZWxkLmluZGV4T2Yoa2V5KSA9PT0gMCkgewogICAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuRVhBQ1QpIHsKICAgICAgICAgIC8vZXhhY3QgbWF0Y2gKICAgICAgICAgIGlmIChldmVudC5maWVsZCA9PT0ga2V5KSB7CiAgICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFPYmplY3RPYnNlcnZlcjsKfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdE9ic2VydmVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKdmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yKTsKCnZhciBfZ2V0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCnZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKdmFyIF9pbmhlcml0czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTsKCnZhciBfaW5oZXJpdHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5oZXJpdHMyKTsKCnZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCk7Cgp2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgY3JlYXRlIGNhbGwuCiAqIFRvIGJlIHVzZWQgYXMgYSByZXBvcnRlciBwb2ludCwgY2hhbmdlcyB3aWxsIGJlIHN1Ym1pdGVkIHRvIERhdGFPYmplY3RPYnNlcnZlciBpbnN0YW5jZXMuCiAqLwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBEYXRhT2JqZWN0UmVwb3J0ZXIgPSBmdW5jdGlvbiAoX0RhdGFPYmplY3QpIHsKICAoMCwgX2luaGVyaXRzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIF9EYXRhT2JqZWN0KTsKCiAgLyogcHJpdmF0ZQogIF9zdWJzY3JpcHRpb25zOiA8aHlwZXJ0eVVybDogeyBzdGF0dXM6IHN0cmluZyB9IH0+CiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25TdWJzY3JpcHRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICBfb25SZXNwb25zZUhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlYWRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuY3JlYXRlIG1ldGhvZAogICAqLwogIGZ1bmN0aW9uIERhdGFPYmplY3RSZXBvcnRlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdFJlcG9ydGVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdFJlcG9ydGVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSk7CgogICAgdmFyIF90aGlzID0gX3RoaXMyOwoKICAgIF90aGlzLl9zdWJzY3JpcHRpb25zID0ge307CgogICAgX3RoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci0nICsgdXJsICsgJy1TRU5EOiAnLCBldmVudCk7CiAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCk7CiAgICB9KTsKCiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgIHJldHVybiBfdGhpczI7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX2FsbG9jYXRlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9vYmplY3RMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgewogICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0LScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewogICAgICAgICAgY2FzZSAncmVzcG9uc2UnOgogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpO2JyZWFrOwogICAgICAgICAgY2FzZSAncmVhZCc6CiAgICAgICAgICAgIF90aGlzLl9vblJlYWQobXNnKTticmVhazsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX29iamVjdExpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogU2VuZCBpbnZpdGF0aW9ucyAoY3JlYXRlIG1lc3NhZ2VzKSB0byBoeXBlcnRpZXMsIG9ic2VydmVycyBsaXN0LgogICAgICogQHBhcmFtICB7SHlwZXJ0eVVSTFtdfSBvYnNlcnZlcnMgTGlzdCBvZiBIeXBlcnR5IFVSTCdzCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnaW52aXRlT2JzZXJ2ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnZpdGVPYnNlcnZlcnMob2JzZXJ2ZXJzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkNyZWF0ZQogICAgICB2YXIgaW52aXRlTXNnID0gewogICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fc3luY2hlci5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAogICAgICAgIGJvZHk6IHsgcmVzdW1lOiBmYWxzZSwgcmVzb3VyY2U6IF90aGlzLl91cmwsIHNjaGVtYTogX3RoaXMuX3NjaGVtYSwgdmFsdWU6IF90aGlzLl9zeW5jT2JqLmRhdGEsIGF1dGhvcmlzZTogb2JzZXJ2ZXJzIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoaW52aXRlTXNnKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uRGVsZXRlCiAgICAgIHZhciBkZWxldGVNc2cgPSB7CiAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGRlbGV0ZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1ERUxFVEU6ICcsIHJlcGx5KTsKICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX3JlcG9ydGVyc1tfdGhpcy5fdXJsXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU3Vic2NyaXB0aW9ucyByZXF1ZXN0ZWQgYW5kIGFjY2VwdGVkIHRvIHRoaXMgcmVwb3J0ZXIKICAgICAqIEB0eXBlIHtPYmplY3Q8SHlwZXJ0eVVSTCwgU3luY1N1YnNjcmlwdGlvbj59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25TdWJzY3JpcHRpb24nLAoKCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHN1YnNjcmliZSBhbmQgdW5zdWJzY3JpYmUgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TdWJzY3JpcHRpb24oY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZXNwb25zZSBub3RpZmljYXRpb25zIG9mIHRoZSBjcmVhdGUncwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlYWQgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVhZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZWFkKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVhZEhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBwYXJlbnQgU3luY2hlciAtPiBfb25Gb3J3YXJkCgogIH0sIHsKICAgIGtleTogJ19vbkZvcndhcmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLVJDVjogJywgbXNnKTsKICAgICAgc3dpdGNoIChtc2cuYm9keS50eXBlKSB7CiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblN1YnNjcmliZShtc2cpO2JyZWFrOwogICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGlzIC0+IF9vbkZvcndhcmQ6IGVtaXR0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBzdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uU3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdWJzY3JpYmUobXNnKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwogICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RSZXBvcnRlci5fb25TdWJzY3JpYmVdJywgbXNnKTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIC8vY3JlYXRlIG5ldyBzdWJzY3JpcHRpb24KICAgICAgICAgIHZhciBzdWIgPSB7IHVybDogaHlwZXJ0eVVybCwgc3RhdHVzOiAnb24nIH07CiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjsKCiAgICAgICAgICAvL3Byb2Nlc3MgYW5kIHNlbmQgY2hpbGRyZW5zIGRhdGEKICAgICAgICAgIHZhciBjaGlsZHJlblZhbHVlcyA9IHt9OwogICAgICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CiAgICAgICAgICAgIHZhciBjaGlsZERhdGEgPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLmRhdGE7CiAgICAgICAgICAgIGNoaWxkcmVuVmFsdWVzW2NoaWxkSWRdID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGNoaWxkRGF0YSk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgc2VuZE1zZyA9IHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoX3RoaXMuZGF0YSksIGNoaWxkcmVuczogY2hpbGRyZW5WYWx1ZXMgfSB9CiAgICAgICAgICB9OwoKICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsQXV0aGVudGljYXRpb24nKSAmJiAhbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24pIHsKICAgICAgICAgICAgc2VuZE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbjsKICAgICAgICAgICAgX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBvayByZXNwb25zZSBtZXNzYWdlCiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHNlbmRNc2cpOwoKICAgICAgICAgIHJldHVybiBzdWI7CiAgICAgICAgfSwKCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7CiAgICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdTVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoaXMgLT4gX29uRm9yd2FyZDogZW1pdHRlZCBieSBhIHJlbW90ZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgLT4gdW5zdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uVW5TdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblVuU3Vic2NyaWJlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgaHlwZXJ0eVVybCA9IG1zZy5ib2R5LmZyb207CgogICAgICB2YXIgc3ViID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CiAgICAgIGRlbGV0ZSBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKICAgICAgICBvYmplY3Q6IHN1YgogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBSZXBvcnRlclVSTCBhZGRyZXNzOiBlbWl0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBfb25SZW1vdGVDcmVhdGUgLT4gZXZlbnQuYWNrCgogIH0sIHsKICAgIGtleTogJ19vblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZXNwb25zZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICB1cmw6IG1zZy5mcm9tLAogICAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGUKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVTUE9OU0UtRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gcmVhZAoKICB9LCB7CiAgICBrZXk6ICdfb25SZWFkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWFkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmZyb20sCgogICAgICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgdmFsdWU6ICgwLCBfdXRpbHMuZGVlcENsb25lKShfdGhpcy5kYXRhKSB9CiAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDEsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uUmVhZEhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVBRC1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblJlYWRIYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3N1YnNjcmlwdGlvbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdFJlcG9ydGVyOwp9KF9EYXRhT2JqZWN0My5kZWZhdWx0IC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0UmVwb3J0ZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEyMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9wcm9taXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7Cgp2YXIgX3Byb21pc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvbWlzZSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX1Byb3h5T2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKdmFyIF9Qcm94eU9iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Qcm94eU9iamVjdCk7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCnZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7Cgp2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBNYWluIGV4dGVuc2lvbiBjbGFzcyBmb3Igb2JzZXJ2ZXJzIGFuZCByZXBvcnRlcnMsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIG1ldGhvZHMuCiAqIENoaWxkcmVuIG1hbmFnZW1lbnQgaXMgY29tbW9uIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycy4KICovCnZhciBEYXRhT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICBfdmVyc2lvbjogbnVtYmVyCiAgIF9vd25lcjogSHlwZXJ0eVVSTAogIF91cmw6IE9iamVjdFVSTAogIF9zY2hlbWE6IFNjaGVtYQogIF9idXM6IE1pbmlCdXMKICBfc3RhdHVzOiBvbiB8IHBhdXNlZAogIF9zeW5jT2JqOiBTeW5jRGF0YQogICBfY2hpbGRyZW46IHsgaWQ6IERhdGFPYmplY3RDaGlsZCB9CiAgX2NoaWxkcmVuTGlzdGVuZXJzOiBbTXNnTGlzdGVuZXJdCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25BZGRDaGlsZEhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogICovCgogIC8qKgogICAqIEBpZ25vcmUKICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlciBjcmVhdGUgb3Igc3Vic2NyaWJlIG1ldGhvZCdzCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdChzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgdmFyIG11dHVhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDogdHJ1ZTsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX3N5bmNoZXIgPSBzeW5jaGVyOwogICAgX3RoaXMuX3VybCA9IHVybDsKICAgIF90aGlzLl9zY2hlbWEgPSBzY2hlbWE7CiAgICBfdGhpcy5fc3RhdHVzID0gaW5pdGlhbFN0YXR1czsKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CiAgICBfdGhpcy5fY2hpbGRyZW5zID0gY2hpbGRyZW5zOwoKICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgIF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbDsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IDA7CiAgICBfdGhpcy5fY2hpbGRJZCA9IDA7CiAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzID0ge307CiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTsKCiAgICBfdGhpcy5fb3duZXIgPSBzeW5jaGVyLl9vd25lcjsKICAgIF90aGlzLl9idXMgPSBzeW5jaGVyLl9idXM7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0LCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBjaGlsZEJhc2VVUkwgPSBfdGhpcy5fdXJsICsgJy9jaGlsZHJlbi8nOwogICAgICBjb25zb2xlLmxvZygnW0RhdGEgT2JqZWN0IC0gQWxsb2NhdGVMaXN0ZW5lcnNdIC0gJywgX3RoaXMuX2NoaWxkcmVucyk7CiAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW5zKSB7CiAgICAgICAgX3RoaXMuX2NoaWxkcmVucy5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkgewogICAgICAgICAgdmFyIGNoaWxkVVJMID0gY2hpbGRCYXNlVVJMICsgY2hpbGQ7CiAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgICAgICAgaWYgKG1zZy5mcm9tICE9PSBfdGhpczIuX293bmVyKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3QtQ2hpbGRyZW4tUkNWOiAnLCBtc2cpOwogICAgICAgICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6CiAgICAgICAgICAgICAgICAgIF90aGlzLl9vbkNoaWxkQ3JlYXRlKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOgogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO2JyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgX3RoaXMuX2NoYW5nZUNoaWxkcmVuKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHsKICAgICAgICBsaXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfSk7CgogICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNba2V5XS5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBVUkwgb2YgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIKICAgICAqIEB0eXBlIHtPYmplY3RVUkx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncGF1c2UnLAoKCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkgewogICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CiAgICB9CgogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncmVzdW1lJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7CiAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdG9wJywKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICAvL1RPRE86IHNob3VsZCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBhbmQgc2VuZCBtZXNzYWdlIHVuc3Vic2NyaWJlPwogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgYWRkIGEgRGF0YU9iamVjdENoaWxkIHRvIGEgY2hpbGRyZW4gY29sbGVjdGlvbi4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGlsZHJlbiAtIENoaWxkcmVuIG5hbWUgd2hlcmUgdGhlIGNoaWxkIGlzIGFkZGVkLgogICAgICogQHBhcmFtIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgY2hpbGQKICAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdENoaWxkPn0gLSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBEYXRhT2JqZWN0Q2hpbGQuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnYWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENoaWxkKGNoaWxkcmVuLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9jcmVhdGUgbmV3IGNoaWxkIHVuaXF1ZSBJRCwgYmFzZWQgb24gaHlwZXJ0eVVSTAogICAgICBfdGhpcy5fY2hpbGRJZCsrOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IF90aGlzLl9vd25lciArICcjJyArIF90aGlzLl9jaGlsZElkOwogICAgICB2YXIgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJyArIGNoaWxkcmVuOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoaWxkIGFkZHJlc3M6IE1lc3NhZ2VCdXMKICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IG1zZ0NoaWxkUGF0aCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBtc2dDaGlsZElkLCB2YWx1ZTogaW5pdGlhbERhdGEgfQogICAgICB9OwoKICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgcmVxdWVzdE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uOwoKICAgICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbAogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgdmFyIG1zZ0lkID0gX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXF1ZXN0TXNnKTsKCiAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZS1yZXBvcnRlci1jaGlsZCggJyArIF90aGlzLl9vd25lciArICcgKTogJywgcmVxdWVzdE1zZyk7CiAgICAgICAgdmFyIG5ld0NoaWxkID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIG1zZ0NoaWxkSWQsIGluaXRpYWxEYXRhLCBfdGhpcy5fb3duZXIsIG1zZ0lkKTsKICAgICAgICBuZXdDaGlsZC5vbkNoYW5nZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCwgeyBwYXRoOiBtc2dDaGlsZFBhdGgsIGNoaWxkSWQ6IG1zZ0NoaWxkSWQgfSk7CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgICAgcmVzb2x2ZShuZXdDaGlsZCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgY3JlYXRlIGFuZCBkZWxldGUgb2YgY2hpbGRyZW5zLgogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uQWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQWRkQ2hpbGQoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IGFkZENoaWxkCgogIH0sIHsKICAgIGtleTogJ19vbkNoaWxkQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGlsZENyZWF0ZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIG1zZ0NoaWxkSWQgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUtb2JzZXJ2ZXItY2hpbGQoICcgKyBfdGhpcy5fb3duZXIgKyAnICk6ICcsIG1zZyk7CiAgICAgIHZhciBuZXdDaGlsZCA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBtc2dDaGlsZElkLCBtc2cuYm9keS52YWx1ZSk7CiAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIC8vRkxPVy1PVVQ6IHdpbGwgZmxvdyB0byBEYXRhT2JqZWN0Q2hpbGQgLT4gX29uUmVzcG9uc2UKICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHNvdXJjZTogX3RoaXMuX293bmVyIH0KICAgICAgICB9KTsKICAgICAgfSk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmZyb20sCiAgICAgICAgdXJsOiBtc2cudG8sCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGNoaWxkSWQ6IG1zZ0NoaWxkSWQsCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ0FERC1DSElMRFJFTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL3NlbmQgZGVsdGEgbWVzc2FnZXMgdG8gc3Vic2NyaXB0aW9ucwoKICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoYW5nZShldmVudCwgY2hpbGRJbmZvKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fdmVyc2lvbisrOwoKICAgICAgaWYgKF90aGlzLl9zdGF0dXMgPT09ICdvbicpIHsKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIGEgcmVzb3VyY2UgY2hhbmdlcyBhZGRyZXNzOiBNZXNzYWdlQnVzCiAgICAgICAgdmFyIGNoYW5nZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogX3RoaXMuX3VybCArICcvY2hhbmdlcycsCiAgICAgICAgICBib2R5OiB7IHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCBzb3VyY2U6IF90aGlzLl9vd25lciwgYXR0cmlidXRlOiBldmVudC5maWVsZCB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0IC0gX29uQ2hhbmdlXSAtICcsIGV2ZW50LCBjaGlsZEluZm8sIGNoYW5nZU1zZyk7CgogICAgICAgIGlmIChldmVudC5vVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuT0JKRUNUKSB7CiAgICAgICAgICBpZiAoZXZlbnQuY1R5cGUgIT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPSBldmVudC5vVHlwZTsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKICAgICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuVVBEQVRFKSB7CiAgICAgICAgICAgIGNoYW5nZU1zZy5ib2R5Lm9wZXJhdGlvbiA9IGV2ZW50LmNUeXBlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy9jaGlsZEluZm8gbXVzdCBoYXZlIChwYXRoLCBjaGlsZElkKQogICAgICAgIGlmIChjaGlsZEluZm8pIHsKICAgICAgICAgIGNoYW5nZU1zZy50byA9IGNoaWxkSW5mby5wYXRoOwogICAgICAgICAgY2hhbmdlTXNnLmJvZHkucmVzb3VyY2UgPSBjaGlsZEluZm8uY2hpbGRJZDsKICAgICAgICB9CgogICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgY2hhbmdlTXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoY2hhbmdlTXNnKTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogZGVsdGEgbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RSZXBvcnRlciBvciBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VPYmplY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VPYmplY3Qoc3luY09iaiwgbXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL1RPRE86IHVwZGF0ZSB2ZXJzaW9uID8KICAgICAgLy9ob3cgdG8gaGFuZGxlIGFuIGluY29ycmVjdCB2ZXJzaW9uID8gRXhhbXBsZTogcmVjZWl2ZSBhIHZlcnNpb24gMyB3aGVuIHRoZSBvYnNlcnZlciBpcyBpbiB2ZXJzaW9uIDEsIHdoZXJlIGlzIHRoZSB2ZXJzaW9uIDIgPwogICAgICAvL3dpbGwgd2UgbmVlZCB0byBjb25maXJtIHRoZSByZWNlcHRpb24gPwogICAgICBpZiAoX3RoaXMuX3ZlcnNpb24gKyAxID09PSBtc2cuYm9keS52ZXJzaW9uKSB7CiAgICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKICAgICAgICB2YXIgcGF0aCA9IG1zZy5ib2R5LmF0dHJpYnV0ZTsKICAgICAgICB2YXIgdmFsdWUgPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkobXNnLmJvZHkudmFsdWUpOwogICAgICAgIHZhciBmaW5kUmVzdWx0ID0gc3luY09iai5maW5kQmVmb3JlKHBhdGgpOwoKICAgICAgICBpZiAobXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuQVJSQVkpIHsKICAgICAgICAgIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLkFERCkgewogICAgICAgICAgICB2YXIgYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBpbmRleCA9IGZpbmRSZXN1bHQubGFzdDsKICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShhcnIsIFtpbmRleCwgMF0uY29uY2F0KHZhbHVlKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CiAgICAgICAgICAgIHZhciBfYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBfaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIF9hcnIuc3BsaWNlKF9pbmRleCwgdmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XSA9IHZhbHVlOyAvLyBVUERBVEUKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKG1zZy5ib2R5LnZhbHVlKSB7CiAgICAgICAgICAgIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF0gPSB2YWx1ZTsgLy8gVVBEQVRFIG9yIEFERAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVsZXRlIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF07IC8vIFJFTU9WRQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvL1RPRE86IGhvdyB0byBoYW5kbGUgdW5zeW5jaHJvbml6ZWQgdmVyc2lvbnM/CiAgICAgICAgY29uc29sZS5sb2coJ1VOU1lOQ0hST05JWkVEIFZFUlNJT046IChkYXRhID0+ICcgKyBfdGhpcy5fdmVyc2lvbiArICcsIG1zZyA9PiAnICsgbXNnLmJvZHkudmVyc2lvbiArICcpJyk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VDaGlsZHJlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NoYW5nZUNoaWxkcmVuKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBjb25zb2xlLmxvZygnQ2hhbmdlIGNoaWxkcmVuOiAnLCBfdGhpcy5fb3duZXIsIG1zZyk7CgogICAgICB2YXIgY2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlOwogICAgICB2YXIgY2hpbGRyZW4gPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdOwoKICAgICAgaWYgKGNoaWxkcmVuKSB7CiAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChjaGlsZHJlbi5fc3luY09iaiwgbXNnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygnTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAnLCBjaGlsZElkKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3VybCcsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3VybDsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBzY2hlbWEgVVJMICh0aGlzIGZpZWxkIGlzIG5vdCB5ZXQgc3RhYmxlLCBhbmQgaXMgc3Vic2plY3QgdG8gY2hhbmdlKQogICAgICogQHR5cGUge1NjaGVtYVVSTH0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzY2hlbWEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zY2hlbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdGF0dXMgb2YgdGhlIHJlcG9ydGVyIG9yIG9ic2VydmVyIGNvbm5lY3Rpb24gKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpCiAgICAgKiBAdHlwZSB7U3RhdHVzfSAtIEVudW0gb2Y6IG9uIHwgcGF1c2VkCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnc3RhdHVzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3RhdHVzOwogICAgfQoKICAgIC8qKgogICAgICogRGF0YSBzdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLgogICAgICogQHR5cGUge0pTT059IC0gSlNPTiBzdHJ1Y3R1cmUgdGhhdCBzaG91bGQgZm9sbG93IHRoZSBkZWZpbmVkIHNjaGVtYSwgaWYgYW55LgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RhdGEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGwgY3JlYXRlZCBjaGlsZHJlbidzIHNpbmNlIHRoZSBzdWJzY3JpcHRpb24sIGRvZXNuJ3QgY29udGFpbiBhbGwgY2hpbGRyZW4ncyBzaW5jZSByZXBvcnRlciBjcmVhdGlvbi4KICAgICAqIEB0eXBlIHtPYmplY3Q8Q2hpbGRJZCwgRGF0YU9iamVjdENoaWxkPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdjaGlsZHJlbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhT2JqZWN0Owp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTIxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIyKTsKCnZhciBfUHJveHlPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUHJveHlPYmplY3QpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgRGF0YU9iamVjdCBhZGRDaGlsZHJlbiBjYWxsIG9yIGZyb20gb25BZGRDaGlsZHJlbiBpZiByZW1vdGVseSBjcmVhdGVkLgogKiBDaGlsZHJlbiBvYmplY3Qgc3luY2hyb25pemF0aW9uIGlzIGEgYSBmYXN0IGZvcndhcmQgbWVjaGFuaXNtLCBubyBuZWVkIGZvciBkaXJlY3Qgc3Vic2NyaXB0aW9ucywgaXQgdXNlcyB0aGUgYWxyZWFkeSBhdXRob3JpemVkIHN1YnNjcmlwdGlvbiBmcm9tIHRoZSBwYXJlbnQgRGF0YU9iamVjdC4KICovCnZhciBEYXRhT2JqZWN0Q2hpbGQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBEYXRhT2JqZWN0LmFkZENoaWxkcmVuCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdENoaWxkKHBhcmVudCwgY2hpbGRJZCwgaW5pdGlhbERhdGEsIG93bmVyLCBtc2dJZCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdENoaWxkKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9wYXJlbnQgPSBwYXJlbnQ7CiAgICBfdGhpcy5fY2hpbGRJZCA9IGNoaWxkSWQ7CiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl9tc2dJZCA9IG1zZ0lkOwoKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CgogICAgX3RoaXMuX2J1cyA9IHBhcmVudC5fYnVzOwogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0Q2hpbGQsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vdGhpcyBpcyBvbmx5IG5lZWRlZCBmb3IgY2hpbGRyZW4gcmVwb3J0ZXJzCiAgICAgIGlmIChfdGhpcy5fb3duZXIpIHsKICAgICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl9vd25lciwgZnVuY3Rpb24gKG1zZykgewogICAgICAgICAgaWYgKG1zZy50eXBlID09PSAncmVzcG9uc2UnICYmIG1zZy5pZCA9PT0gX3RoaXMuX21zZ0lkKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZTonLCBtc2cpOwogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKF90aGlzLl9saXN0ZW5lcikgewogICAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgZGVsZXRlIF90aGlzLl9wYXJlbnQuX2NoaWxkcmVuW190aGlzLl9jaGlsZElkXTsKCiAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgogICAgICAvL1RPRE86IHNlbmQgZGVsZXRlIG1lc3NhZ2UgPwogICAgfQoKICAgIC8qKgogICAgICogQ2hpbGRyZW4gSUQgZ2VuZXJhdGVkIG9uIGFkZENoaWxkcmVuLiBVbmlxdWUgaWRlbnRpZmllcgogICAgICogQHR5cGUge1VSTH0gLSBVUkwgb2YgdGhlIGZvcm1hdCA8SHlwZXJ0eVVSTD4jPG51bWVyaWMtc2VxdWVuY2U+CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25DaGFuZ2UnLAoKCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyIGNoaWxkCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZShjYWxsYmFjaykgewogICAgICB0aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlc3BvbnNlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIGNyZWF0ZXMKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlc3BvbnNlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVzcG9uc2VIYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdCAtPiBfb25DaGlsZENyZWF0ZQoKICB9LCB7CiAgICBrZXk6ICdfb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVzcG9uc2UobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgdXJsOiBtc2cuYm9keS5zb3VyY2UsCiAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdjaGlsZElkJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKICAgIH0KCiAgICAvKioKICAgICAqIERhdGEgU3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC4KICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdENoaWxkOwp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdENoaWxkOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5PYmplY3RUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0gdW5kZWZpbmVkOwoKdmFyIF9zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCnZhciBfc3RyaW5naWZ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmeSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKX193ZWJwYWNrX3JlcXVpcmVfXygxNTMpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBvYmplY3RUeXBlID0geyBBUlJBWTogJ1tvYmplY3QgQXJyYXldJywgT0JKRUNUOiAnW29iamVjdCBPYmplY3RdJyB9OwoKLyoqCiAqIEBhY2Nlc3MgcHJpdmF0ZQogKiBNYWluIGNsYXNzIHRoYXQgbWFpbnRhaW5zIGEgSlNPTiBvYmplY3QsIGFuZCBvYnNlcnZlcyBjaGFuZ2VzIGluIHRoaXMgb2JqZWN0LCByZWN1cnNpdmVseS4KICogSW50ZXJuYWwgb2JqZWN0cyBhbmQgYXJyYXlzIGFyZSBhbHNvIG9ic2VydmVkLgogKi8KCnZhciBTeW5jT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFN5bmNPYmplY3QoaW5pdGlhbERhdGEpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFN5bmNPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX29ic2VydmVycyA9IFtdOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICB0aGlzLl9kYXRhID0gaW5pdGlhbERhdGEgfHwge307CgogICAgdGhpcy5faW50ZXJuYWxPYnNlcnZlKHRoaXMuX2RhdGEpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoU3luY09iamVjdCwgW3sKICAgIGtleTogJ29ic2VydmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnB1c2goY2FsbGJhY2spOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmQocGF0aCkgewogICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCiAgICAgIHJldHVybiB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmRCZWZvcmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRCZWZvcmUocGF0aCkgewogICAgICB2YXIgcmVzdWx0ID0ge307CiAgICAgIHZhciBsaXN0ID0gcGF0aC5zcGxpdCgnLicpOwogICAgICByZXN1bHQubGFzdCA9IGxpc3QucG9wKCk7CiAgICAgIHJlc3VsdC5vYmogPSB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmluZFdpdGhTcGxpdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbmRXaXRoU3BsaXQobGlzdCkgewogICAgICB2YXIgb2JqID0gdGhpcy5fZGF0YTsKICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIG9iaiA9IG9ialt2YWx1ZV07CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIG9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfaXNPYnNlcnZhYmxlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNPYnNlcnZhYmxlKG9iaikgewogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBPYmplY3QgfHwgb2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2ludGVybmFsT2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsT2JzZXJ2ZShvYmplY3QpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoY2hhbmdlc2V0KSB7CgogICAgICAgIGNoYW5nZXNldC5ldmVyeShmdW5jdGlvbiAoY2hhbmdlKSB7CiAgICAgICAgICBfdGhpczIuX29uQ2hhbmdlcyhjaGFuZ2UpOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgdGhpcy5fZGF0YSA9IE9iamVjdC5kZWVwT2JzZXJ2ZShvYmplY3QsIGhhbmRsZXIpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19maXJlRXZlbnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maXJlRXZlbnQoZXZlbnQpIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2VzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2VzKGNoYW5nZSkgewoKICAgICAgdmFyIG9iaiA9IGNoYW5nZS5vYmplY3Q7CiAgICAgIHZhciBvYmpUeXBlID0gdm9pZCAwOwoKICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuT0JKRUNUOwogICAgICB9CgogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIG9ialR5cGUgPSBPYmplY3RUeXBlLkFSUkFZOwogICAgICB9CgogICAgICB2YXIgZmllbGRTdHJpbmcgPSBjaGFuZ2Uua2V5cGF0aDsKCiAgICAgIC8vIGNvbnNvbGUubG9nKCdGaWVsZDonLCBmaWVsZFN0cmluZyk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCd0eXBlOicsIGNoYW5nZS50eXBlKTsKCiAgICAgIC8vbGV0IG9sZFZhbHVlID0gY2hhbmdlLm9sZFZhbHVlOwogICAgICB2YXIgbmV3VmFsdWUgPSBvYmpbY2hhbmdlLm5hbWVdOwoKICAgICAgY29uc29sZS5pbmZvKGNoYW5nZS50eXBlICsgJyB8IEZpZWxkOiAnICsgZmllbGRTdHJpbmcgKyAnIHwgTmV3IFZhbHVlOicsICgwLCBfc3RyaW5naWZ5Mi5kZWZhdWx0KShuZXdWYWx1ZSkpOwoKICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAndXBkYXRlJykgewogICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5VUERBVEUsCiAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZywKICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2FkZCcpIHsKICAgICAgICB0aGlzLl9maXJlRXZlbnQoewogICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuQURELAogICAgICAgICAgb1R5cGU6IG9ialR5cGUsCiAgICAgICAgICBmaWVsZDogZmllbGRTdHJpbmcsCiAgICAgICAgICBkYXRhOiBuZXdWYWx1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdkZWxldGUnKSB7CiAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLlJFTU9WRSwKICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fZGF0YTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFN5bmNPYmplY3Q7Cn0oKTsKCnZhciBDaGFuZ2VUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0geyBVUERBVEU6ICd1cGRhdGUnLCBBREQ6ICdhZGQnLCBSRU1PVkU6ICdyZW1vdmUnIH07CnZhciBPYmplY3RUeXBlID0gZXhwb3J0cy5PYmplY3RUeXBlID0geyBPQkpFQ1Q6ICdvYmplY3QnLCBBUlJBWTogJ2FycmF5JyB9OwpleHBvcnRzLmRlZmF1bHQgPSBTeW5jT2JqZWN0OwoKLyoqKi8gfSksCi8qIDEyMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzOCk7Cgp2YXIgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgewogIGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsKICB2YXIgZGVzYyA9ICgwLCBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMi5kZWZhdWx0KShvYmplY3QsIHByb3BlcnR5KTsKCiAgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgewogICAgdmFyIHBhcmVudCA9ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKG9iamVjdCk7CgogICAgaWYgKHBhcmVudCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7CiAgICB9CiAgfSBlbHNlIGlmICgidmFsdWUiIGluIGRlc2MpIHsKICAgIHJldHVybiBkZXNjLnZhbHVlOwogIH0gZWxzZSB7CiAgICB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7CgogICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsKICB9Cn07CgovKioqLyB9KSwKLyogMTI0ICovLAovKiAxMjUgKi8sCi8qIDEyNiAqLywKLyogMTI3ICovLAovKiAxMjggKi8sCi8qIDEyOSAqLywKLyogMTMwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX3Byb21pc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCnZhciBfYXNzaWduID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzYpOwoKdmFyIF9hc3NpZ24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXNzaWduKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE5KTsKCnZhciBfRGF0YU9iamVjdFJlcG9ydGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RSZXBvcnRlcik7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE4KTsKCnZhciBfRGF0YU9iamVjdE9ic2VydmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RPYnNlcnZlcik7Cgp2YXIgX0RhdGFQcm92aXNpb25hbCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMzKTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFQcm92aXNpb25hbCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogVGhlIG1haW4gY2xhc3MgZm9yIHRoZSBzeW5jaGVyIHBhY2thZ2UuCiogVGhlIFN5bmNoZXIgaXMgYSBzaW5nbGV0b24gY2xhc3MgcGVyIEh5cGVydHkvVVJMIGFuZCBpdCBpcyB0aGUgb3duZXIgb2YgYWxsIGNyZWF0ZWQgRGF0YSBTeW5jIE9iamVjdHMgYWNjb3JkaW5nIHRvIHRoZSBSZXBvcnRlciAtIE9ic2VydmVyIHBhdHRlcm4uCiogTWFpbiBmdW5jdGlvbmFsaXR5IGlzIHRvIGNyZWF0ZSByZXBvcnRlcnMgYW5kIHRvIHN1YnNjcmliZSB0byBleGlzdGluZyBvbmVzLgoqLwp2YXIgU3luY2hlciA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgX293bmVyOiBVUkwKICBfYnVzOiBNaW5pQnVzCiAgIF9zdWJVUkw6IFVSTAogICBfcmVwb3J0ZXJzOiA8dXJsOiBEYXRhT2JqZWN0UmVwb3J0ZXI+CiAgX29ic2VydmVyczogPHVybDogRGF0YU9iamVjdE9ic2VydmVyPgogIF9wcm92aXNpb25hbHM6IDx1cmw6IERhdGFQcm92aXNpb25hbD4KICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vbk5vdGlmaWNhdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlc3VtZTogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgKiBDb25zdHJ1Y3RvciB0aGF0IHNob3VsZCBiZSB1c2VkIGJ5IHRoZSBIeXBlcnR5IG93bmVyCiAgKiBAcGFyYW0ge0h5cGVydHlVUkx9IG93bmVyIC0gSHlwZXJ0eSBVUkwgb3duZXIuIEFuIFVSTCBhbGxvY2F0ZWQgYnkgdGhlIHJ1bnRpbWUgdGhhdCB1bmlxdWVseSBpZGVudGlmaWVzIHRoZSBIeXBlcnR5LgogICogQHBhcmFtIHtNaW5pQnVzfSBidXMgLSBBbiBpbnN0YW5jZSBvZiB0aGUgTWluaUJ1cyBwcm92aWRlZCBpbiB0aGUgc2FuZGJveC4gV2hlbiBhbiBvYmplY3QgKFJlcG9ydGVyIG9yIE9ic2VydmVkKSBpcyBjcmVhdGVkLCB0aGUgU3luY2hlck1hbmFnZXIgd2lsbCBhZGQgYSBsaXN0ZW5lciBpbiB0aGUgTWluaUJ1cyB0byByZWNlaXZlL3NlbmQgTWVzc2FnZXMgb2YgdGhhdCBvYmplY3QuCiAgKiBAcGFyYW0ge0pTT059IGNvbmZpZyAtIENvbmZpZ3VyYXRpb24gZGF0YS4gVGhlIG9ubHkgcmVxdWlyZWQgZmllbGQgZm9yIG5vdyBpcyB0aGUgcnVudGltZVVSTC4KICAqLwogIGZ1bmN0aW9uIFN5bmNoZXIob3duZXIsIGJ1cywgY29uZmlnKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBTeW5jaGVyKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX2J1cyA9IGJ1czsKCiAgICBfdGhpcy5fc3ViVVJMID0gY29uZmlnLnJ1bnRpbWVVUkwgKyAnL3NtJzsKCiAgICBfdGhpcy5fcmVwb3J0ZXJzID0ge307CiAgICBfdGhpcy5fb2JzZXJ2ZXJzID0ge307CiAgICBfdGhpcy5fcHJvdmlzaW9uYWxzID0ge307CgogICAgYnVzLmFkZExpc3RlbmVyKG93bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikgewogICAgICAgIGNvbnNvbGUuaW5mbygnW1N5bmNoZXJdIFN5bmNoZXItUkNWOiAnLCBtc2cpOwogICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgIGNhc2UgJ2ZvcndhcmQnOgogICAgICAgICAgICBfdGhpcy5fb25Gb3J3YXJkKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdjcmVhdGUnOgogICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVDcmVhdGUobXNnKTticmVhazsKICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAgIF90aGlzLl9vblJlbW90ZURlbGV0ZShtc2cpO2JyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQoKICAvKioKICAqIFRoZSBvd25lciBvZiB0aGUgU3luY2hlciBhbmQgYWxsIGNyZWF0ZWQgcmVwb3J0ZXJzLgogICogQHR5cGUge0h5cGVydHlVUkx9CiAgKi8KCgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKFN5bmNoZXIsIFt7CiAgICBrZXk6ICdjcmVhdGUnLAoKCiAgICAvKioKICAgICogUmVxdWVzdCBhIERhdGFPYmplY3RSZXBvcnRlciBjcmVhdGlvbi4gVGhlIFVSTCB3aWxsIGJlIGJlIHJlcXVlc3RlZCBieSB0aGUgYWxsb2NhdGlvbiBtZWNoYW5pc20uCiAgICAqIEBwYXJhbSAge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hCiAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIC0gTGlzdCBvZiBoeXBlcnRpZXMgdGhhdCBhcmUgcHJlLWF1dGhvcml6ZWQgZm9yIHN1YnNjcmlwdGlvbgogICAgKiBAcGFyYW0gIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICogQHBhcmFtICB7c3RyaW5nfSBvYmplY3RVUkwgLSByZXVzYWJsZSBkYXRhT2JqZWN0IFVSTAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IFJlcG9ydGVyLiBUaGUgcmVwb3J0ZXIgY2FuIGJlIGFjY2VwdGVkIG9yIHJlamVjdGVkIGJ5IHRoZSBQRVAKICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKHNjaGVtYSwgb2JzZXJ2ZXJzLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgc3RvcmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgcDJwID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiBmYWxzZTsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBjcml0ZXJpYSA9IHt9OwoKICAgICAgY3JpdGVyaWEucDJwID0gcDJwOwogICAgICBjcml0ZXJpYS5zdG9yZSA9IHN0b3JlOwogICAgICBjcml0ZXJpYS5zY2hlbWEgPSBzY2hlbWE7CiAgICAgIGNyaXRlcmlhLm9ic2VydmVycyA9IG9ic2VydmVyczsKICAgICAgY3JpdGVyaWEuaW5pdGlhbERhdGEgPSBpbml0aWFsRGF0YTsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUgUmVwb3J0ZXIgLSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogZmFsc2UgfSk7CgogICAgICByZXR1cm4gX3RoaXMuX2NyZWF0ZShjcml0ZXJpYSk7CiAgICB9CiAgfSwgewogICAga2V5OiAncmVzdW1lUmVwb3J0ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVSZXBvcnRlcnMoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBSZXBvcnRlciAtIGNyaXRlcmlhOiAnLCBjcml0ZXJpYSk7CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiB0cnVlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9jcmVhdGUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtTY2hlbWFVUkx9IHNjaGVtYSAtIEh5cGVydHkgQ2F0YWxvZ3VlIFVSTCBhZGRyZXNzIHRoYXQgY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIEpTT04tU2NoZW1hIGRlc2NyaWJpbmcgdGhlIERhdGEgT2JqZWN0IHNjaGVtYQogICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gQWRkcmVzcyBvZiB0aGUgZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIG9ic2VydmVkCiAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3N0b3JlPWZhbHNlXSAtIFNhdmUgdGhlIHN1YnNjcmlwdGlvbiBvbiB0aGUgU3luY2hlciBNYW5hZ2VyIGZvciBmdXJ0aGVyIHJlc3VtZSAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbcDJwPWZhbHNlXSAtIEluZm8gYWJvdXQgaWYgc2hvdWxkIHVzZSBwMnAgY29ubmVjdGlvbiAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbbXV0dWFsPXRydWVdIC0gSW5mbyBhYm91dCBpZiBtZXNzYWdlcyBvZiB0aGlzIG9iamVjdCBzaG91bGQgYmUgZW5jcnlwdGVkIChEZWZhdWx0IGlzIHRydWUpCiAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdE9ic2VydmVyPn0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgb2JzZXJ2ZXIuIEl0J3MgYXNzb2NpYXRlZCB3aXRoIHRoZSByZXBvcnRlci4KICAgICovCgogIH0sIHsKICAgIGtleTogJ3N1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3Vic2NyaWJlKHNjaGVtYSwgb2JqVVJMKSB7CiAgICAgIHZhciBzdG9yZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgIHZhciBwMnAgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgbXV0dWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB0cnVlOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGNyaXRlcmlhID0ge307CgogICAgICBjcml0ZXJpYS5wMnAgPSBwMnA7CiAgICAgIGNyaXRlcmlhLnN0b3JlID0gc3RvcmU7CiAgICAgIGNyaXRlcmlhLnNjaGVtYSA9IHNjaGVtYTsKICAgICAgY3JpdGVyaWEucmVzb3VyY2UgPSBvYmpVUkw7CgogICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgIGNyaXRlcmlhLm11dHVhbCA9IG11dHVhbDsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIHN1YnNjcmliZV0gLSBzdWJzY3JpYmUgY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCiAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShjcml0ZXJpYSwgeyByZXN1bWU6IGZhbHNlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9zdWJzY3JpYmUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtjcml0ZXJpYX0gY3JpdGVyaWEgLSBJbmZvcm1hdGlvbiB0byBkaXNjb3ZlcnkgdGhlIG9ic2VydmVyIG9iamVjdAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXN1bWVPYnNlcnZlcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZU9ic2VydmVycyhjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgX2NyaXRlcmlhID0gY3JpdGVyaWEgfHwge307CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoX2NyaXRlcmlhLCB7IHJlc3VtZTogdHJ1ZSB9KTsKCiAgICAgIHJldHVybiBfdGhpcy5fc3Vic2NyaWJlKF9jcml0ZXJpYSk7CiAgICB9CgogICAgLyoqCiAgICAqIFJlcXVlc3QgYSByZWFkIGFjdGlvbiBvbiB0aGUgcmVwb3J0ZXIgb2JqZWN0CiAgICAqIEBwYXJhbSB7T2JqZWN0VVJMfSBvYmpVUkwgLSBVUkwgb2YgdGhlIHJlcG9ydGVyIG9iamVjdCB0byBiZSByZWFkCiAgICAqIEByZXR1cm4ge1Byb21pc2U8T2JqZWN0Pn0gUmV0dXJuIFByb21pc2UgdG8gbGFzdCBhdmFpbGFibGUgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICovCgogIH0sIHsKICAgIGtleTogJ3JlYWQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWQob2JqVVJMKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIHJlcG9ydGVyIG9iamVjdCAobWF5YmUgdGhlcmUgaXMgbm8gbGlzdGVuZXIgYXZhaWxhYmxlLCBzbyBpdCB3aWxsIGJlIHJlc29sdmVkIHdpdGggTWVzc2FnZUJ1cyAtPiByZXNvbHZlKQogICAgICAvL3dpbGwgcmVhY2ggdGhlIHJlbW90ZSBvYmplY3QgaW4gRGF0YU9iamVjdFJlcG9ydGVyIC0+IF9vblJlYWQKICAgICAgdmFyIHJlYWRNc2cgPSB7CiAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBvYmpVUkwKICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVhZE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygncmVhZC1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIGV2ZW50cyBvZiByZW1vdmUgUmVwb3J0ZXIgb2JqZWN0cy4KICAgICogVGhpcyBpcyByZWxlYXRlZCB0byB0aGUgbWVzc2FnZW5zIHNlbnQgYnkgY3JlYXRlIHRvIHRoZSBvYnNlcnZlcnMgSHlwZXJ0eSBhcnJheS4KICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgKi8KCiAgfSwgewogICAga2V5OiAnb25Ob3RpZmljYXRpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uTm90aWZpY2F0aW9uKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ19jcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciByZXN1bWUgPSBjcml0ZXJpYS5yZXN1bWU7CiAgICAgICAgdmFyIGluaXRpYWxEYXRhID0gY3JpdGVyaWEuaW5pdGlhbERhdGEgfHwge307CiAgICAgICAgdmFyIHNjaGVtYSA9IHZvaWQgMDsKCiAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKICAgICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keTogeyByZXN1bWU6IHJlc3VtZSB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXTogJywgY3JpdGVyaWEsIHJlcXVlc3RNc2cpOwoKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUgPSBpbml0aWFsRGF0YTsKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUucmVwb3J0ZXIgPSBfdGhpcy5fb3duZXI7CgogICAgICAgIGlmIChjcml0ZXJpYS5zY2hlbWEpIHsKICAgICAgICAgIHNjaGVtYSA9IGNyaXRlcmlhLnNjaGVtYTsKICAgICAgICAgIHJlcXVlc3RNc2cuYm9keS5zY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CiAgICAgICAgfQoKICAgICAgICBpZiAoY3JpdGVyaWEucDJwKSByZXF1ZXN0TXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgIGlmIChjcml0ZXJpYS5zdG9yZSkgcmVxdWVzdE1zZy5ib2R5LnN0b3JlID0gY3JpdGVyaWEuc3RvcmU7CiAgICAgICAgaWYgKGNyaXRlcmlhLm9ic2VydmVycykgcmVxdWVzdE1zZy5ib2R5LmF1dGhvcmlzZSA9IGNyaXRlcmlhLm9ic2VydmVyczsKCiAgICAgICAgaWYgKHJlc3VtZSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9CgogICAgICAgIC8vcmVxdWVzdCBjcmVhdGUgdG8gdGhlIGFsbG9jYXRpb24gc3lzdGVtLiBDYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIFBvbGljeUVuZ2luZS4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gYWNjZXB0ZWQKICAgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgICBpZiAocmVzdW1lKSB7CiAgICAgICAgICAgICAgc2NoZW1hID0gcmVwbHkuYm9keS5zY2hlbWE7CiAgICAgICAgICAgICAgaW5pdGlhbERhdGEgPSByZXBseS5ib2R5LnZhbHVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgc2NoZW1hLCAnb24nLCBpbml0aWFsRGF0YSwgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CiAgICAgICAgICAgIF90aGlzLl9yZXBvcnRlcnNbb2JqVVJMXSA9IG5ld09iajsKCiAgICAgICAgICAgIHJlc29sdmUobmV3T2JqKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gcmVqZWN0ZWQKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zdWJzY3JpYmUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsU3Vic2NyaWJlCiAgICAgICAgdmFyIHN1YnNjcmliZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keToge30KICAgICAgICB9OwoKICAgICAgICAvLyBIeXBlcnR5IHJlcXVlc3QgdG8gYmUgYW4gT2JzZXJ2ZXIKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNoeXBlcnR5LXJlcXVlc3QtdG8tYmUtYW4tb2JzZXJ2ZXIKCiAgICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIHRoZSBzYW1lIEh5cGVydHkgVVJMCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLXRoZS1zYW1lLWh5cGVydHktdXJsCgogICAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciBhIGNlcnRhaW4gdXNlciBhbmQgZGF0YSBzY2hlbWEgaW5kZXBlbmRlbnRseSBvZiB0aGUgSHlwZXJ0eSBVUkwuCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLWEtY2VydGFpbi11c2VyLWFuZC1kYXRhLXNjaGVtYS1pbmRlcGVuZGVudGx5LW9mLXRoZS1oeXBlcnR5LXVybAogICAgICAgIGlmIChjcml0ZXJpYSkgewogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdwMnAnKSkgc3Vic2NyaWJlTXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzdG9yZScpKSBzdWJzY3JpYmVNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzY2hlbWEnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdpZGVudGl0eScpKSBzdWJzY3JpYmVNc2cuYm9keS5pZGVudGl0eSA9IGNyaXRlcmlhLmlkZW50aXR5OwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZScpKSBzdWJzY3JpYmVNc2cuYm9keS5yZXNvdXJjZSA9IGNyaXRlcmlhLnJlc291cmNlOwogICAgICAgIH0KCiAgICAgICAgc3Vic2NyaWJlTXNnLmJvZHkucmVzdW1lID0gY3JpdGVyaWEucmVzdW1lOwoKICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgdmFyIG11dHVhbEF1dGhlbnRpY2F0aW9uID0gY3JpdGVyaWEubXV0dWFsOwogICAgICAgIGlmICghbXV0dWFsQXV0aGVudGljYXRpb24pIHN1YnNjcmliZU1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUgbWVzc2FnZTogJywgY3JpdGVyaWEsIHN1YnNjcmliZU1zZyk7CgogICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KICAgICAgICAvL1Byb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICAgICAgICAvL2ZvciBtb3JlIGluZm8gc2VlIHRoZSBEYXRhUHJvdmlzaW9uYWwgY2xhc3MgZG9jdW1lbnRhdGlvbi4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gc3Vic2NyaWJlLXJlc3BvbnNlOiAnLCByZXBseSk7CgogICAgICAgICAgdmFyIHNjaGVtYSA9IHJlcGx5LmJvZHkuc2NoZW1hOwogICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgdmFyIG5ld1Byb3Zpc2lvbmFsID0gX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKICAgICAgICAgIGlmIChuZXdQcm92aXNpb25hbCkgbmV3UHJvdmlzaW9uYWwuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlIDwgMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YVByb3Zpc2lvbmFsOiAnLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzLCBvYmpVUkwpOwogICAgICAgICAgICBuZXdQcm92aXNpb25hbCA9IG5ldyBfRGF0YVByb3Zpc2lvbmFsMi5kZWZhdWx0KF90aGlzLl9vd25lciwgb2JqVVJMLCBfdGhpcy5fYnVzLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKICAgICAgICAgICAgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdID0gbmV3UHJvdmlzaW9uYWw7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YSBPYmplY3QgT2JzZXJ2ZXI6ICcsIHJlcGx5LCBfdGhpcy5fcHJvdmlzaW9uYWxzKTsKCiAgICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgICAgdmFyIG5ld09iaiA9IG5ldyBfRGF0YU9iamVjdE9ic2VydmVyMi5kZWZhdWx0KF90aGlzLCBvYmpVUkwsIHNjaGVtYSwgJ29uJywgcmVwbHkuYm9keS52YWx1ZSwgbmV3UHJvdmlzaW9uYWwuY2hpbGRyZW4sIHJlcGx5LmJvZHkudmVyc2lvbiwgbXV0dWFsQXV0aGVudGljYXRpb24pOwogICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF0gPSBuZXdPYmo7CgogICAgICAgICAgICByZXNvbHZlKG5ld09iaik7CiAgICAgICAgICAgIG5ld1Byb3Zpc2lvbmFsLmFwcGx5KG5ld09iaik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSBsb2NhbCBydW50aW1lIFJlcG9ydGVyT2JqZWN0IC0+IF9vblJlbW90ZVN1YnNjcmliZQoKICB9LCB7CiAgICBrZXk6ICdfb25Gb3J3YXJkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Gb3J3YXJkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHJlcG9ydGVyID0gX3RoaXMuX3JlcG9ydGVyc1ttc2cuYm9keS50b107CiAgICAgIHJlcG9ydGVyLl9vbkZvcndhcmQobXNnKTsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBTeW5jaGVyIC0+IGNyZWF0ZSAodGhpcyBpcyBhY3R1YWxseSBhbiBpbnZpdGF0aW9uIHRvIHN1YnNjcmliZSkKCiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVDcmVhdGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5mcm9tLnNsaWNlKDAsIC0xMyk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmJvZHkuc291cmNlLAogICAgICAgIHVybDogcmVzb3VyY2UsCiAgICAgICAgc2NoZW1hOiBtc2cuYm9keS5zY2hlbWEsCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgYWNrOiBmdW5jdGlvbiBhY2sodHlwZSkgewogICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgbFR5cGUgPSB0eXBlOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbU3luY2hlcl0gTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gZGVsZXRlCgogIH0sIHsKICAgIGtleTogJ19vblJlbW90ZURlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVtb3RlRGVsZXRlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9yZW1vdmUgIi9zdWJzY3JpcHRpb24iIGZyb20gdGhlIFVSTAogICAgICB2YXIgcmVzb3VyY2UgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIHZhciBvYmplY3QgPSBfdGhpcy5fb2JzZXJ2ZXJzW3Jlc291cmNlXTsKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIHZhciBldmVudCA9IHsKICAgICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgICAgdXJsOiByZXNvdXJjZSwKICAgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgICBhY2s6IGZ1bmN0aW9uIGFjayh0eXBlKSB7CiAgICAgICAgICAgIHZhciBsVHlwZSA9IDIwMDsKICAgICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgICBsVHlwZSA9IHR5cGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vVE9ETzogYW55IG90aGVyIGRpZmZlcmVudCBvcHRpb25zIGZvciB0aGUgcmVsZWFzZSBwcm9jZXNzLCBsaWtlIGFjY2VwdCBidXQgbm9yIHJlbGVhc2UgbG9jYWw/CiAgICAgICAgICAgIGlmIChsVHlwZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgb2JqZWN0LmRlbGV0ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL3NlbmQgYWNrIHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgICAgYm9keTogeyBjb2RlOiBsVHlwZSwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBpZiAoX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcikgewogICAgICAgICAgY29uc29sZS5sb2coJ05PVElGSUNBVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwNCwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnb3duZXInLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9vd25lcjsKICAgIH0KCiAgICAvKioKICAgICogQWxsIG93bmVkIHJlcG9ydGVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBjcmVhdGUKICAgICogQHR5cGUge09iamVjdDxVUkwsIERhdGFPYmplY3RSZXBvcnRlcj59CiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnRlcnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9yZXBvcnRlcnM7CiAgICB9CgogICAgLyoqCiAgICAqIEFsbCBvd25lZCBvYnNlcnZlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgbG9jYWwgc3Vic2NyaXB0aW9uCiAgICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0T2JzZXJ2ZXI+fQogICAgKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZXJzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fb2JzZXJ2ZXJzOwogICAgfQogIH1dKTsKICByZXR1cm4gU3luY2hlcjsKfSgpOyAvKioKICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICoKICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgKgogICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAqCiAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IFN5bmNoZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEzMSAqLywKLyogMTMyICovLAovKiAxMzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovKioKICogQGFjY2VzcyBwcml2YXRlCiAqIFRoaXMgY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIGNvbGxlY3RpbmcgZGVsdGEgY2hhbmdlcyBpbiByZW1vdGUgb2JqZWN0cywgYmVmb3JlIHRoZSByZXNwb25zZSBvZiBzdWJzY3JpcHRpb24gcmVhY2ggdGhlIG9ic2VydmVyLgogKiBJdCdzIHVzZWQgaW4gU3luY2hlciAtPiBzdWJzY3JpYmUuIFRoZSBmbG93IGlzIGRlZmluZWQgYXM6CiAqIDEuIChvYnNlcnZlcikgLS1zdWJzY3JpYmUtLT4gKHJlcG9ydGVyKQogKiAyLiAob2JzZXJ2ZXIpIDwtLWRlbHRhIHVwZGF0ZXMtLSAocmVwb3J0ZXIpCiAqIDMuIChvYnNlcnZlcikgPC0tc3Vic2NyaWJlIHJlc3BvbnNlLS0gKHJlcG9ydGVyKQogKiBUaGlzIG1lYW5zIHRoYXQgdGhlcmUgY291bGQgYmUgZGVsdGEgdXBkYXRlcyB0cmFuc2ZlcnJlZCBiZWZvcmUgdGhlIHN1YnNjcmlwdGlvbiBjb25maXJtYXRpb24uCiAqIFNpbmNlIHRoZXJlIGlzIG5vIERhdGFPYmplY3RPYnNlcnZlciBiZWZvcmUgdGhlIHVic2NyaXB0aW9uIGNvbmZpcm1hdGlvbiwgdGhlcmUgc2hvdWxkIGJlIHNvbWUgb3RoZXIgb2JqZWN0IGNvbGxlY3RpbmcgdGhlIHVwZGF0ZXMuCiAqIFByb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICovCnZhciBEYXRhUHJvdmlzaW9uYWwgPSBmdW5jdGlvbiAoKSB7CiAgLyogcHJpdmF0ZQogIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXQogIF9saXN0ZW5lcjogTXNnTGlzdGVuZXIKICAgX2NoYW5nZXM6IFtdCiAgKi8KCiAgZnVuY3Rpb24gRGF0YVByb3Zpc2lvbmFsKG93bmVyLCB1cmwsIGJ1cywgY2hpbGRyZW4pIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFQcm92aXNpb25hbCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl91cmwgPSB1cmw7CiAgICBfdGhpcy5fYnVzID0gYnVzOwogICAgX3RoaXMuX2NoaWxkcmVuID0gY2hpbGRyZW47CgogICAgX3RoaXMuX2NoYW5nZXMgPSBbXTsKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YVByb3Zpc2lvbmFsLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YVByb3Zpc2lvbmFsLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgX3RoaXMuX2NoYW5nZXMucHVzaChtc2cpOwogICAgICB9KTsKCiAgICAgIC8qCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwogICAgICBpZiAoX3RoaXMuX2NoaWxkcmVuKSB7CiAgICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IHVybCArICcvY2hpbGRyZW4vJzsKICAgICAgICBfdGhpcy5fY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHsKICAgICAgICAgIGxldCBjaGlsZFVSTCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOwogICAgICAgICAgbGV0IGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgKG1zZykgPT4gewogICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCiAgICAgICAgICAgIGlmIChtc2cuZnJvbSAhPT0gb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0qLwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKCiAgICAgIC8qX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7CiAgICAgICAgbGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgIH0pOyovCiAgICB9CiAgfSwgewogICAga2V5OiAnYXBwbHknLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5KG9ic2VydmVyKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIF90aGlzLl9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZSkgewogICAgICAgIG9ic2VydmVyLl9jaGFuZ2VPYmplY3Qob2JzZXJ2ZXIuX3N5bmNPYmosIGNoYW5nZSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ2NoaWxkcmVuJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW47CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhUHJvdmlzaW9uYWw7Cn0oKTsKCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFQcm92aXNpb25hbDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTM0ICovLAovKiAxMzUgKi8sCi8qIDEzNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzcgKi8sCi8qIDEzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0NSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzkgKi8sCi8qIDE0MCAqLywKLyogMTQxICovLAovKiAxNDIgKi8sCi8qIDE0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDE0OSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3QuYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NCAqLywKLyogMTQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTUxKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7CiAgcmV0dXJuICRPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpOwp9OwoKLyoqKi8gfSksCi8qIDE0NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyAxOS4xLjIuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlLCAuLi4pCnZhciBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpCiAgLCBnT1BTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCiAgLCB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJT2JqZWN0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpCiAgLCAkYXNzaWduICA9IE9iamVjdC5hc3NpZ247CgovLyBzaG91bGQgd29yayB3aXRoIHN5bWJvbHMgYW5kIHNob3VsZCBoYXZlIGRldGVybWluaXN0aWMgcHJvcGVydHkgb3JkZXIgKFY4IGJ1ZykKbW9kdWxlLmV4cG9ydHMgPSAhJGFzc2lnbiB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHZhciBBID0ge30KICAgICwgQiA9IHt9CiAgICAsIFMgPSBTeW1ib2woKQogICAgLCBLID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0JzsKICBBW1NdID0gNzsKICBLLnNwbGl0KCcnKS5mb3JFYWNoKGZ1bmN0aW9uKGspeyBCW2tdID0gazsgfSk7CiAgcmV0dXJuICRhc3NpZ24oe30sIEEpW1NdICE9IDcgfHwgT2JqZWN0LmtleXMoJGFzc2lnbih7fSwgQikpLmpvaW4oJycpICE9IEs7Cn0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycwogIHZhciBUICAgICA9IHRvT2JqZWN0KHRhcmdldCkKICAgICwgYUxlbiAgPSBhcmd1bWVudHMubGVuZ3RoCiAgICAsIGluZGV4ID0gMQogICAgLCBnZXRTeW1ib2xzID0gZ09QUy5mCiAgICAsIGlzRW51bSAgICAgPSBwSUUuZjsKICB3aGlsZShhTGVuID4gaW5kZXgpewogICAgdmFyIFMgICAgICA9IElPYmplY3QoYXJndW1lbnRzW2luZGV4KytdKQogICAgICAsIGtleXMgICA9IGdldFN5bWJvbHMgPyBnZXRLZXlzKFMpLmNvbmNhdChnZXRTeW1ib2xzKFMpKSA6IGdldEtleXMoUykKICAgICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAogICAgICAsIGogICAgICA9IDAKICAgICAgLCBrZXk7CiAgICB3aGlsZShsZW5ndGggPiBqKWlmKGlzRW51bS5jYWxsKFMsIGtleSA9IGtleXNbaisrXSkpVFtrZXldID0gU1trZXldOwogIH0gcmV0dXJuIFQ7Cn0gOiAkYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NyAqLywKLyogMTQ4ICovLAovKiAxNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSkKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYsICdPYmplY3QnLCB7YXNzaWduOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Nil9KTsKCi8qKiovIH0pLAovKiAxNTAgKi8sCi8qIDE1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApCnZhciB0b0lPYmplY3QgICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KS5mOwoKX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2dldE93blByb3BlcnR5RGVzY3JpcHRvcicsIGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICAgIHJldHVybiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRvSU9iamVjdChpdCksIGtleSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTUyICovLAovKiAxNTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gICAgIHByb3h5LW9ic2VydmUgdjAuMC4xOAovLyAgICAgQ29weXJpZ2h0IChjKSAyMDE1LCAyMDE2IFNpbW9uIFkuIEJsYWNrd2VsbCwgQW55V2hpY2hXYXkKLy8gICAgIE1JVCBMaWNlbnNlIC0gaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocAooZnVuY3Rpb24oKSB7CgkidXNlIHN0cmljdCI7CgkvLyBDcmVhdGVzIGFuZCByZXR1cm5zIGEgUHJveHkgd3JhcHBpbmcgYSB0YXJnZXQgc28gdGhhdCBhbGwgY2hhbmdlcyBjYW4gYmUgdHJhcHBlZCBhbmQgZm9yd2FyZGVkIHRvCgkvLyBhIGNhbGxiYWNrLiBUaGUgY2FsbGJhY2sgdGFrZXMgYW4gYXJyYXkgb2YgY2hhbmdlcyBqdXN0IGxpa2UgdGhlIHRyYWRpdGlvbmFsIG9yaWdpbmFsIENocm9tZSBPYmplY3Qub2JzZXJ2ZQoJLy8ge29iamVjdDo8b2JqZWN0IGNoYW5nZWQ+LG5hbWU6PGZpZWxkIGNoYW5nZWQ+LHR5cGU6YWRkfHVwZGF0ZXxkZWxldGV8cmVjb25maWd1cmV8cHJldmVudEV4dGVuc2lvbnN8c2V0UHJvdG90eXBlLG9sZFZhbHVlOjxvbGQgdmFsdWUgaWYgdXBkYXRlIHwgZGVsZXRlPn0KCS8vIFRoZSBhY2NlcHRsaXN0IGNhbiBiZSBhZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUuCgkvLyB2IDAuMC4xMCB0byBzdXBwb3J0IHBhdXNpbmcgYW5kIHJlc3RhcnRpbmcgb2JzZXJ2YXRpb24gdHdvIGFkZGl0aW9uYWwgY29uc3RydWN0b3IgYXJndW1lbnRzIGFyZSBhdmFpbGFibGUgdG8gT2JqZWN0Lm9ic2VydmU6CgkvLyBwYXVzYWJsZSAtIGNyZWF0ZSB0aGUgT2JzZXJ2ZXIgc28gaXQgY2FuIGJlIHBhdXNlZAoJLy8gcGF1c2UgLSBjcmVhdGUgb2JzZXJ2ZXIgaW4gcGF1c2VkIHN0YXRlCgkvLyBpZiBwYXVzYWJsZSBpcyB0cnVlIHRoZW4gYW4gYWRkaXRpb25hbCBtZXRob2QgZGVsaXZlcihpZ25vcmVQcmV2aW91cykgaXMgYXZhaWxhYmxlIHRvIHN0YXJ0IGRlbGl2ZXJ5CgkvLyB0byBwYXVzZSBkZWxpdmVyeSBzZXQgYSBwcm9wZXJ0eSBjYWxsZWQgcGF1c2Ugb24gdGhlIGZ1bmN0aW9uIGRlbGl2ZXIgdG8gdHJ1ZQoJLy8gcGF1c2FibGUgaXMgb3B0aW9uYWwgdG8gcmVkdWNlIHRoZSBjaGFuY2Ugb2Ygc2hhZG93aW5nIGEgcHJvcGVydHkgb3IgbWV0aG9kIG9uIGFueSBleGlzdGluZyBjb2RlIGNhbGxlZCBkZWxpdmVyCglpZighT2JqZWN0Lm9ic2VydmUgJiYgdHlwZW9mKFByb3h5KT09PSJmdW5jdGlvbiIpIHsKCQlmdW5jdGlvbiBPYnNlcnZlcih0YXJnZXQsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgewoJICAgIAl2YXIgbWUgPSB0aGlzLCBwcm94eTsKCSAgICAJZnVuY3Rpb24gZGVsaXZlcihpZ25vcmVQcmV2aW91cyxkZWxheSkgewoJICAgIAkJZGVsaXZlci5kZWxheSA9IGRlbGF5OwoJICAgIAkJaWYoIWRlbGl2ZXIucGF1c2UpIHsKCSAgICAgICAgCQlpZihtZS5jaGFuZ2VzZXQubGVuZ3RoPjApIHsKCSAgICAgICAgCQkJaWYoIWlnbm9yZVByZXZpb3VzKSB7CgkJICAgIAkgICAgCQl2YXIgY2hhbmdlcyA9IG1lLmNoYW5nZXNldC5maWx0ZXIoZnVuY3Rpb24oY2hhbmdlKSB7IHJldHVybiAhYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wOyB9KTsKCQkgICAgICAgIAkJCWlmKGNoYW5nZXMubGVuZ3RoPjApIHsKCQkgICAgICAgIAkJCQljYWxsYmFjayhjaGFuZ2VzKTsKCQkgICAgICAgIAkJCX0KCSAgICAgICAgCQkJfQoJICAgICAgICAJCQltZS5jaGFuZ2VzZXQgPSBbXTsKCSAgICAgICAgCQl9CgkgICAgCQl9CgkgICAgCX0KCSAgICAJZGVsaXZlci5wYXVzZSA9IHBhdXNlOwoJICAgIAlkZWxpdmVyLmRlbGF5ID0gZGVsYXk7CgkJICAgIG1lLmdldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCQkgICAgCWlmKHByb3BlcnR5PT09Il9fb2JzZXJ2ZXJfXyIpIHsKCQkgICAgCQlyZXR1cm4gbWU7CgkJICAgIAl9CgkJICAgIAlpZihwcm9wZXJ0eT09PSJ1bm9ic2VydmUiKSB7CgkJICAgIAkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCSAgICAJCQlPYmplY3QudW5vYnNlcnZlKHRhcmdldCk7CgkJICAgIAkJCXJldHVybiB0YXJnZXQ7CgkJICAgIAkJfTsKCQkgICAgCX0KCQkgICAgCWlmKHByb3BlcnR5PT09ImRlbGl2ZXIiKSB7CgkJICAgIAkJcmV0dXJuIGRlbGl2ZXI7CgkJICAgIAl9CgkJICAgIAlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCQkgICAgfQoJICAgIAltZS50YXJnZXQgPSB0YXJnZXQ7CgkgICAgCW1lLmNoYW5nZXNldCA9IFtdOwoJICAgIAlpZighbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXykgewoJICAgIAkJLy8gX19vYnNlcnZlckNhbGxiYWNrc19fIGlzIHVzZWQgYXMgYW4gaW5kZXggdG8gZ2V0IGF0IHRoZSBwcm94eSB3aGljaCBpcyB0aGUgb2JzZXJ2ZXIsIHNvIHdlIGNhbiB1bm9ic2VydmUKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJDYWxsYmFja3NfXyIse2VudW1lcmFibGU6ZmFsc2UsY29uZmlndXJhYmxlOnRydWUsd3JpdGFibGU6ZmFsc2UsdmFsdWU6W119KTsKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJzX18iLHtlbnVtZXJhYmxlOmZhbHNlLGNvbmZpZ3VyYWJsZTp0cnVlLHdyaXRhYmxlOmZhbHNlLHZhbHVlOltdfSk7CgkgICAgCX0KCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5wdXNoKGNhbGxiYWNrKTsKCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJzX18ucHVzaCh0aGlzKTsKCSAgICAJcHJveHkgPSBuZXcgUHJveHkodGFyZ2V0LG1lKTsKCSAgICAJZGVsaXZlcihmYWxzZSxkZWxheSk7CgkgICAgCXJldHVybiBwcm94eTsKCSAgICB9CgkJT2JzZXJ2ZXIucHJvdG90eXBlLmRlbGl2ZXIgPSBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMuZ2V0KG51bGwsImRlbGl2ZXIiKTsKCQl9CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIHZhbHVlKSB7IC8vICwgcmVjZWl2ZXIKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJdmFyIHR5cGUgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKTsKCSAgICAJdGFyZ2V0W3Byb3BlcnR5XSA9IHZhbHVlOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICghdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKHR5cGUpPj0wKSkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZTp0eXBlfSwKCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAgICAgCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAlpZih0eXBlPT09InVwZGF0ZSIpIHsKCSAgICAgICAgCQljaGFuZ2Uub2xkVmFsdWUgPSBvbGR2YWx1ZTsKCSAgICAgICAgCX0KCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWxldGVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJLy9pZih0eXBlb2Yob2xkdmFsdWUpIT09InVuZGVmaW5lZCIpIHsKCQkgICAgCWRlbGV0ZSB0YXJnZXRbcHJvcGVydHldOwoJCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJkZWxldGUiKT49MCkgewoJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6ImRlbGV0ZSIsb2xkVmFsdWU6b2xkdmFsdWV9LAoJCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCQkgICAgICAgIAkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCQkgICAgICAgIAlpZihzdGFydCkgewoJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJCSAgICAgICAgCX0KCQkgICAgCX0KCSAgICAJLy99CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcikgewoJICAgIAlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcik7CgkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigicmVjb25maWd1cmUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZToicmVjb25maWd1cmUifSwKICAgICAgICAJCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKICAgICAgICAJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7CgkgICAgICAgIAlpZihzdGFydCkgewoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7CgkgICAgICAgIAl9CgkgICAgCX0KCSAgICAJcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBPYnNlcnZlci5wcm90b3R5cGUuc2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbih0YXJnZXQsIHByb3RvdHlwZSkgewoJICAgIAl2YXIgb2xkdmFsdWUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KTsKCSAgICAJT2JqZWN0LnNldFByb3RvdHlwZU9mKHRhcmdldCwgcHJvdG90eXBlKTsKCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJzZXRQcm90b3R5cGUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6Il9fcHJvdG9fXyIsdHlwZToic2V0UHJvdG90eXBlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sCiAgICAJCQkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsCiAgICAJCQkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgICAgICAJaWYoc3RhcnQpIHsKCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgICAgICAJfQoJICAgIAl9CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnByZXZlbnRFeHRlbnNpb25zID0gZnVuY3Rpb24odGFyZ2V0KSB7CgkgICAgICAgIE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh0YXJnZXQpOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInByZXZlbnRFeHRlbnNpb25zIik+PTApIHsKCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCx0eXBlOiJwcmV2ZW50RXh0ZW5zaW9ucyJ9LAoJCQkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLAoJCQkJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsKCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9iamVjdC5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJcmV0dXJuIG5ldyBPYnNlcnZlcihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSk7CgkgICAgfTsKCSAgICBPYmplY3QudW5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrKSB7CgkgICAgCWlmKG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsKCSAgICAJCWlmKCFjYWxsYmFjaykgewoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uc3BsaWNlKDAsb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5sZW5ndGgpOwoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZSgwLG9iamVjdC5fX29ic2VydmVyc19fLmxlbmd0aCk7CgkgICAgCQkJcmV0dXJuOwoJICAgIAkJfQoJICAgIAkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5mb3JFYWNoKGZ1bmN0aW9uKG9ic2VydmVyY2FsbGJhY2ssaSkgewoJICAgIAkJCWlmKGNhbGxiYWNrPT09b2JzZXJ2ZXJjYWxsYmFjaykgewoJICAgIAkJCQlvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLnNwbGljZShpLDEpOwoJICAgIAkJCQlkZWxldGUgb2JqZWN0Ll9fb2JzZXJ2ZXJzX19baV0uY2FsbGJhY2s7CgkgICAgCQkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZShpLDEpOwoJICAgIAkJCX0KCSAgICAJCX0pOwoJICAgIAl9CgkgICAgfTsKCSAgICBBcnJheS5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJaWYoIShvYmplY3QgaW5zdGFuY2VvZiBBcnJheSkgJiYgIUFycmF5LmlzQXJyYXkob2JqZWN0KSkgewoJICAgIAkJdGhyb3cgbmV3IFR5cGVFcnJvcigiRmlyc3QgYXJndW1lbnQgdG8gQXJyYXkub2JzZXJ2ZXIgaXMgbm90IGFuIEFycmF5Iik7CgkgICAgCX0KICAgICAgICAgICAgCWFjY2VwdGxpc3QgPSBhY2NlcHRsaXN0IHx8IFsiYWRkIiwgInVwZGF0ZSIsICJkZWxldGUiLCAic3BsaWNlIl07CgkgICAgCXZhciBhcnJheXByb3h5ID0gbmV3IFByb3h5KG9iamVjdCx7Z2V0OiBmdW5jdGlvbih0YXJnZXQscHJvcGVydHkpIHsKCSAgICAJCWlmKHByb3BlcnR5PT09InVub2JzZXJ2ZSIpIHsKCQkgICAgCQlyZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2spIHsKCQkgICAgCQkJaWYoY2FsbGJhY2spIHsKCQkgICAgCQkJCXJldHVybiBPYmplY3QudW5vYnNlcnZlKHRhcmdldCxjYWxsYmFjayk7CgkJICAgIAkJCX0KCQkgICAgCQkJcmV0dXJuIHRhcmdldC51bm9ic2VydmUoKTsKCQkgICAgCQl9OwoJCSAgICAJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic3BsaWNlIikgewoJICAgIAkJCXJldHVybiBmdW5jdGlvbihzdGFydCxlbmQpIHsKCSAgICAJCQkJaWYodHlwZW9mKHN0YXJ0KSE9PSJudW1iZXIiIHx8IHR5cGVvZihlbmQpIT09Im51bWJlciIpIHsKCSAgICAJCQkJCXRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IHR3byBhcmd1bWVudHMgdG8gQXJyYXkgc3BsaWNlIGFyZSBub3QgbnVtYmVyLCBudW1iZXIiKTsKCSAgICAJCQkJfQoJICAgIAkgICAgCQl2YXIgcmVtb3ZlZCA9IHRoaXMuc2xpY2Uoc3RhcnQsc3RhcnQrZW5kKSwKCSAgICAJICAgIAkJCWFkZGVkQ291bnQgPSAoYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHMubGVuZ3RoLTIgOiAwKSwKCSAgICAJICAgIAkJCWNoYW5nZSA9ICB7b2JqZWN0Om9iamVjdCx0eXBlOiJzcGxpY2UiLGluZGV4OnN0YXJ0LHJlbW92ZWQ6cmVtb3ZlZCxhZGRlZENvdW50OmFkZGVkQ291bnR9OwoJICAgIAkgICAgCQl0YXJnZXQuc3BsaWNlLmFwcGx5KHRhcmdldCxhcmd1bWVudHMpOwoJICAgIAkgICAgCQlpZihhY2NlcHRsaXN0LmluZGV4T2YoInNwbGljZSIpPj0wKSB7CgkgICAgCSAgICAJCQl2YXIgc3RhcnQgPSBwcm94eS5fX29ic2VydmVyX18uY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAJICAgICAgICAJCQlkZWxpdmVyID0gcHJveHkuX19vYnNlcnZlcl9fLmRlbGl2ZXIoKTsKCSAgICAJICAgIAkJCXByb3h5Ll9fb2JzZXJ2ZXJfXy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgIAkgICAgCQkJaWYoc3RhcnQpIHsKCSAgICAJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgIAkJICAgICAgICAJfQoJICAgIAkgICAgCQl9CgkgICAgCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icHVzaCIpIHsKCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHsKCSAgICAJCSAgICAJcmV0dXJuIHRoaXMuc3BsaWNlKHRoaXMubGVuZ3RoLDAsaXRlbSk7CgkgICAgCQkgICAgfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icG9wIikgewoJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oKSB7CgkgICAgCQkgICAgCXJldHVybiB0aGlzLnNwbGljZSh0aGlzLmxlbmd0aC0xLDEpOwoJICAgIAkJICAgIH0KCSAgICAJCX0KCSAgICAJCWlmKHByb3BlcnR5PT09InVuc2hpZnQiKSB7CgkgICAgCQkJIHJldHVybiBmdW5jdGlvbihpdGVtKSB7CiAgICAJCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDAsaXRlbSk7CiAgICAJCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic2hpZnQiKSB7CgkgICAgCQkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJICAgIAkgICAgCQlyZXR1cm4gdGhpcy5zcGxpY2UoMCwxKTsKCSAgICAJICAgIAl9CgkgICAgCQl9CgkgICAgCQlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJfX0pOwoJICAgIAl2YXIgcHJveHkgPSBPYmplY3Qub2JzZXJ2ZShhcnJheXByb3h5LGZ1bmN0aW9uKGNoYW5nZXNldCkgeyAKCSAgICAJCXZhciBjaGFuZ2VzID0gY2hhbmdlc2V0LmZpbHRlcihmdW5jdGlvbihjaGFuZ2UpIHsgcmV0dXJuIGNoYW5nZS5uYW1lIT09Imxlbmd0aCIgJiYgY2hhbmdlLm5hbWUhPT0iYWRkIiAmJiAoIWFjY2VwdGxpc3QgfHwgYWNjZXB0bGlzdC5pbmRleE9mKGNoYW5nZS50eXBlKT49MCk7IH0pOwoJICAgIAkJaWYoY2hhbmdlcy5sZW5ndGg+MCkgewoJICAgIAkJCWNhbGxiYWNrKGNoYW5nZXMpOwoJICAgIAkJfQoJICAgIAl9LGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpOwoJICAgIAlyZXR1cm4gcHJveHk7CgkgICAgfTsKCSAgICBBcnJheS51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsKCQkgIHJldHVybiBvYmplY3QudW5vYnNlcnZlKGNhbGxiYWNrKTsKCSAgICB9Cgl9CglPYmplY3QuZGVlcE9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2sscGFydHMpIHsKCgkJcGFydHMgPSAocGFydHMgPyBwYXJ0cyA6IFtdKTsKCgkJdmFyIHRvVHlwZU5hbWUgPSBmdW5jdGlvbihvYmopIHsKCQkJcmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvYmopLm1hdGNoKC9ccyhbYS16QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKQoJCX0KCgkJZnVuY3Rpb24gcmVvYnNlcnZlKHZhbHVlLCBwYXJ0cykgewoJCQl2YXIga2V5cyA9IE9iamVjdC5rZXlzKHZhbHVlKTsKCQkJa2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJaWYoKHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdvYmplY3QnIHx8IHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdhcnJheScpICYmICF2YWx1ZVtrZXldLmhhc093blByb3BlcnR5KCdfX29ic2VydmVyc19fJykpIHsKCQkJCQl2YXIgbmV3cGFydHMgPSBwYXJ0cy5zbGljZSgwKTsKCQkJCQluZXdwYXJ0cy5wdXNoKGtleSk7CgkJCQkJdmFsdWVba2V5XSA9IE9iamVjdC5kZWVwT2JzZXJ2ZSh2YWx1ZVtrZXldLGNhbGxiYWNrLG5ld3BhcnRzKTsKCQkJCX0KCQkJfSk7CgkJfQoKCQlyZW9ic2VydmUob2JqZWN0LCBwYXJ0cyk7CgoJCXZhciBvYnNlcnZlZCA9IE9iamVjdC5vYnNlcnZlKG9iamVjdCxmdW5jdGlvbihjaGFuZ2VzZXQpIHsKCQkJdmFyIGNoYW5nZXMgPSBbXTsKCQkJZnVuY3Rpb24gcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0LG5ld09iamVjdCxwYXRoKSB7CgkJCQlpZihuZXdPYmplY3QgaW5zdGFuY2VvZiBPYmplY3QpIHsKCQkJCQl2YXIgbmV3a2V5cyA9IE9iamVjdC5rZXlzKG5ld09iamVjdCk7CgkJCQkJbmV3a2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJCQlpZighb2xkT2JqZWN0IHx8IChvbGRPYmplY3Rba2V5XSE9PW5ld09iamVjdFtrZXldKSkgewoJCQkJCQkJdmFyIG9sZHZhbHVlID0gKG9sZE9iamVjdCAmJiBvbGRPYmplY3Rba2V5XSE9PXVuZGVmaW5lZCA/IG9sZE9iamVjdFtrZXldIDogdW5kZWZpbmVkKSwKCQkJCQkJCQljaGFuZ2UgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKSwKCQkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCgkJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGR2YWx1ZSxuZXdWYWx1ZTpuZXdPYmplY3Rba2V5XSxrZXlwYXRoOmtleXBhdGh9KTsKCQkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZHZhbHVlLG5ld09iamVjdFtrZXldLGtleXBhdGgpOwoJCQkJCQl9CgkJCQkJfSk7CgkJCQl9IGVsc2UgaWYob2xkT2JqZWN0IGluc3RhbmNlb2YgT2JqZWN0KSB7CgkJCQkJdmFyIG9sZGtleXMgPSBPYmplY3Qua2V5cyhvbGRPYmplY3QpOwoJCQkJCW9sZGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsKCQkJCQkJdmFyIGNoYW5nZSA9IChuZXdPYmplY3Q9PT1udWxsID8gInVwZGF0ZSIgOiAiZGVsZXRlIiksCgkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCQkJCQkJCQoJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGRPYmplY3Rba2V5XSxuZXdWYWx1ZTpuZXdPYmplY3Qsa2V5cGF0aDprZXlwYXRofSk7CgkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZE9iamVjdFtrZXldLHVuZGVmaW5lZCxrZXlwYXRoKTsKCQkJCQl9KTsKCQkJCX0KCQkJfQoJCQljaGFuZ2VzZXQuZm9yRWFjaChmdW5jdGlvbihjaGFuZ2UpIHsKCQkJCXZhciBrZXlwYXRoID0gKHBhcnRzLmxlbmd0aD4wID8gcGFydHMuam9pbigiLiIpICsgIi4iIDogIiIpICsgY2hhbmdlLm5hbWU7CgoJCQkJaWYgKGNoYW5nZS50eXBlID09PSAidXBkYXRlIiB8fCBjaGFuZ2UudHlwZSA9PT0gImFkZCIpIHsgCgkJCQkJcmVvYnNlcnZlKGNoYW5nZS5vYmplY3QsIHBhcnRzKTsKCQkJCX0KCgkJCQljaGFuZ2VzLnB1c2goe25hbWU6Y2hhbmdlLm5hbWUsb2JqZWN0OmNoYW5nZS5vYmplY3QsdHlwZTpjaGFuZ2UudHlwZSxvbGRWYWx1ZTpjaGFuZ2Uub2xkVmFsdWUsbmV3VmFsdWU6Y2hhbmdlLm9iamVjdFtjaGFuZ2UubmFtZV0sa2V5cGF0aDprZXlwYXRofSk7CgkJCQlyZWN1cnNlKGNoYW5nZS5uYW1lLGNoYW5nZS5vYmplY3QsY2hhbmdlLm9sZFZhbHVlLGNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGgpOwoJCQl9KTsKCQkJY2FsbGJhY2soY2hhbmdlcyk7CgkJfSk7CgkJcmV0dXJuIG9ic2VydmVkOwoJfTsKfSkoKTsKCgovKioqLyB9KSwKLyogMTU0ICovLAovKiAxNTUgKi8sCi8qIDE1NiAqLywKLyogMTU3ICovLAovKiAxNTggKi8sCi8qIDE1OSAqLywKLyogMTYwICovLAovKiAxNjEgKi8sCi8qIDE2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkRhdGFPYmplY3RPYnNlcnZlciA9IGV4cG9ydHMuRGF0YU9iamVjdFJlcG9ydGVyID0gZXhwb3J0cy5TeW5jaGVyID0gdW5kZWZpbmVkOwoKdmFyIF9TeW5jaGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzApOwoKdmFyIF9TeW5jaGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1N5bmNoZXIpOwoKdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOSk7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuU3luY2hlciA9IF9TeW5jaGVyMi5kZWZhdWx0OwpleHBvcnRzLkRhdGFPYmplY3RSZXBvcnRlciA9IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQ7CmV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdDsKCi8qKiovIH0pCi8qKioqKiovIF0pOwp9KTsKCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwoKJ3VzZSBzdHJpY3QnOwoKLy8gU2hpbW1pbmcgc3RhcnRzIGhlcmUuCihmdW5jdGlvbigpIHsKICAvLyBVdGlscy4KICB2YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7CiAgdmFyIGxvZ2dpbmcgPSB1dGlscy5sb2c7CiAgdmFyIGJyb3dzZXJEZXRhaWxzID0gdXRpbHMuYnJvd3NlckRldGFpbHM7CiAgLy8gRXhwb3J0IHRvIHRoZSBhZGFwdGVyIGdsb2JhbCBvYmplY3QgdmlzaWJsZSBpbiB0aGUgYnJvd3Nlci4KICBtb2R1bGUuZXhwb3J0cy5icm93c2VyRGV0YWlscyA9IGJyb3dzZXJEZXRhaWxzOwogIG1vZHVsZS5leHBvcnRzLmV4dHJhY3RWZXJzaW9uID0gdXRpbHMuZXh0cmFjdFZlcnNpb247CiAgbW9kdWxlLmV4cG9ydHMuZGlzYWJsZUxvZyA9IHV0aWxzLmRpc2FibGVMb2c7CgogIC8vIFVuY29tbWVudCB0aGUgbGluZSBiZWxvdyBpZiB5b3Ugd2FudCBsb2dnaW5nIHRvIG9jY3VyLCBpbmNsdWRpbmcgbG9nZ2luZwogIC8vIGZvciB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdy4gQ2FuIGFsc28gYmUgdHVybmVkIG9uIGluIHRoZSBicm93c2VyIHZpYQogIC8vIGFkYXB0ZXIuZGlzYWJsZUxvZyhmYWxzZSksIGJ1dCB0aGVuIGxvZ2dpbmcgZnJvbSB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdwogIC8vIHdpbGwgbm90IGFwcGVhci4KICAvLyByZXF1aXJlKCcuL3V0aWxzJykuZGlzYWJsZUxvZyhmYWxzZSk7CgogIC8vIEJyb3dzZXIgc2hpbXMuCiAgdmFyIGNocm9tZVNoaW0gPSByZXF1aXJlKCcuL2Nocm9tZS9jaHJvbWVfc2hpbScpIHx8IG51bGw7CiAgdmFyIGVkZ2VTaGltID0gcmVxdWlyZSgnLi9lZGdlL2VkZ2Vfc2hpbScpIHx8IG51bGw7CiAgdmFyIGZpcmVmb3hTaGltID0gcmVxdWlyZSgnLi9maXJlZm94L2ZpcmVmb3hfc2hpbScpIHx8IG51bGw7CiAgdmFyIHNhZmFyaVNoaW0gPSByZXF1aXJlKCcuL3NhZmFyaS9zYWZhcmlfc2hpbScpIHx8IG51bGw7CgogIC8vIFNoaW0gYnJvd3NlciBpZiBmb3VuZC4KICBzd2l0Y2ggKGJyb3dzZXJEZXRhaWxzLmJyb3dzZXIpIHsKICAgIGNhc2UgJ2Nocm9tZSc6CiAgICAgIGlmICghY2hyb21lU2hpbSB8fCAhY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdDaHJvbWUgc2hpbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhpcyBhZGFwdGVyIHJlbGVhc2UuJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGxvZ2dpbmcoJ2FkYXB0ZXIuanMgc2hpbW1pbmcgY2hyb21lLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGNocm9tZVNoaW07CgogICAgICBjaHJvbWVTaGltLnNoaW1HZXRVc2VyTWVkaWEoKTsKICAgICAgY2hyb21lU2hpbS5zaGltTWVkaWFTdHJlYW0oKTsKICAgICAgdXRpbHMuc2hpbUNyZWF0ZU9iamVjdFVSTCgpOwogICAgICBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QoKTsKICAgICAgY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgY2hyb21lU2hpbS5zaGltT25UcmFjaygpOwogICAgICBicmVhazsKICAgIGNhc2UgJ2ZpcmVmb3gnOgogICAgICBpZiAoIWZpcmVmb3hTaGltIHx8ICFmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdGaXJlZm94IHNoaW0gaXMgbm90IGluY2x1ZGVkIGluIHRoaXMgYWRhcHRlciByZWxlYXNlLicpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBsb2dnaW5nKCdhZGFwdGVyLmpzIHNoaW1taW5nIGZpcmVmb3guJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gZmlyZWZveFNoaW07CgogICAgICBmaXJlZm94U2hpbS5zaGltR2V0VXNlck1lZGlhKCk7CiAgICAgIHV0aWxzLnNoaW1DcmVhdGVPYmplY3RVUkwoKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbVNvdXJjZU9iamVjdCgpOwogICAgICBmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbU9uVHJhY2soKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdlZGdlJzoKICAgICAgaWYgKCFlZGdlU2hpbSB8fCAhZWRnZVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uKSB7CiAgICAgICAgbG9nZ2luZygnTVMgZWRnZSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBlZGdlLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGVkZ2VTaGltOwoKICAgICAgZWRnZVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMKCk7CiAgICAgIGVkZ2VTaGltLnNoaW1QZWVyQ29ubmVjdGlvbigpOwogICAgICBicmVhazsKICAgIGNhc2UgJ3NhZmFyaSc6CiAgICAgIGlmICghc2FmYXJpU2hpbSkgewogICAgICAgIGxvZ2dpbmcoJ1NhZmFyaSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBzYWZhcmkuJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gc2FmYXJpU2hpbTsKCiAgICAgIHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgIGxvZ2dpbmcoJ1Vuc3VwcG9ydGVkIGJyb3dzZXIhJyk7CiAgfQp9KSgpOwoKfSx7Ii4vY2hyb21lL2Nocm9tZV9zaGltIjo0LCIuL2VkZ2UvZWRnZV9zaGltIjo2LCIuL2ZpcmVmb3gvZmlyZWZveF9zaGltIjo4LCIuL3NhZmFyaS9zYWZhcmlfc2hpbSI6MTAsIi4vdXRpbHMiOjExfV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CgovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzLmpzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgY2hyb21lU2hpbSA9IHsKICBzaGltTWVkaWFTdHJlYW06IGZ1bmN0aW9uKCkgewogICAgd2luZG93Lk1lZGlhU3RyZWFtID0gd2luZG93Lk1lZGlhU3RyZWFtIHx8IHdpbmRvdy53ZWJraXRNZWRpYVN0cmVhbTsKICB9LAoKICBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmICEoJ29udHJhY2snIGluCiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUsICdvbnRyYWNrJywgewogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5fb250cmFjazsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24oZikgewogICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgaWYgKHRoaXMuX29udHJhY2spIHsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFjaycsIHRoaXMuX29udHJhY2spOwogICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5KTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrID0gZik7CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5ID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAvLyBvbmFkZHN0cmVhbSBkb2VzIG5vdCBmaXJlIHdoZW4gYSB0cmFjayBpcyBhZGRlZCB0byBhbiBleGlzdGluZwogICAgICAgICAgICAvLyBzdHJlYW0uIEJ1dCBzdHJlYW0ub25hZGR0cmFjayBpcyBpbXBsZW1lbnRlZCBzbyB3ZSB1c2UgdGhhdC4KICAgICAgICAgICAgZS5zdHJlYW0uYWRkRXZlbnRMaXN0ZW5lcignYWRkdHJhY2snLCBmdW5jdGlvbih0ZSkgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRlLnRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0ZS50cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGUuc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHsKICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ3RyYWNrJyk7CiAgICAgICAgICAgICAgZXZlbnQudHJhY2sgPSB0cmFjazsKICAgICAgICAgICAgICBldmVudC5yZWNlaXZlciA9IHt0cmFjazogdHJhY2t9OwogICAgICAgICAgICAgIGV2ZW50LnN0cmVhbXMgPSBbZS5zdHJlYW1dOwogICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgICB9LmJpbmQodGhpcykpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKCiAgc2hpbVNvdXJjZU9iamVjdDogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHsKICAgICAgaWYgKHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50ICYmCiAgICAgICAgISgnc3JjT2JqZWN0JyBpbiB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUpKSB7CiAgICAgICAgLy8gU2hpbSB0aGUgc3JjT2JqZWN0IHByb3BlcnR5LCBvbmNlLCB3aGVuIEhUTUxNZWRpYUVsZW1lbnQgaXMgZm91bmQuCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyY09iamVjdCcsIHsKICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zcmNPYmplY3Q7CiAgICAgICAgICB9LAogICAgICAgICAgc2V0OiBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgICAvLyBVc2UgX3NyY09iamVjdCBhcyBhIHByaXZhdGUgcHJvcGVydHkgZm9yIHRoaXMgc2hpbQogICAgICAgICAgICB0aGlzLl9zcmNPYmplY3QgPSBzdHJlYW07CiAgICAgICAgICAgIGlmICh0aGlzLnNyYykgewogICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5zcmMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIXN0cmVhbSkgewogICAgICAgICAgICAgIHRoaXMuc3JjID0gJyc7CiAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTsKICAgICAgICAgICAgLy8gV2UgbmVlZCB0byByZWNyZWF0ZSB0aGUgYmxvYiB1cmwgd2hlbiBhIHRyYWNrIGlzIGFkZGVkIG9yCiAgICAgICAgICAgIC8vIHJlbW92ZWQuIERvaW5nIGl0IG1hbnVhbGx5IHNpbmNlIHdlIHdhbnQgdG8gYXZvaWQgYSByZWN1cnNpb24uCiAgICAgICAgICAgIHN0cmVhbS5hZGRFdmVudExpc3RlbmVyKCdhZGR0cmFjaycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIGlmIChzZWxmLnNyYykgewogICAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChzZWxmLnNyYyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHNlbGYuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc3RyZWFtLmFkZEV2ZW50TGlzdGVuZXIoJ3JlbW92ZXRyYWNrJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgaWYgKHNlbGYuc3JjKSB7CiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHNlbGYuc3JjKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgc2VsZi5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIC8vIFRoZSBSVENQZWVyQ29ubmVjdGlvbiBvYmplY3QuCiAgICBpZiAoIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikgewogICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gPSBmdW5jdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cykgewogICAgICAgIC8vIFRyYW5zbGF0ZSBpY2VUcmFuc3BvcnRQb2xpY3kgdG8gaWNlVHJhbnNwb3J0cywKICAgICAgICAvLyBzZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD00ODY5CiAgICAgICAgLy8gdGhpcyB3YXMgZml4ZWQgaW4gTTU2IGFsb25nIHdpdGggdW5wcmVmaXhpbmcgUlRDUGVlckNvbm5lY3Rpb24uCiAgICAgICAgbG9nZ2luZygnUGVlckNvbm5lY3Rpb24nKTsKICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5KSB7CiAgICAgICAgICBwY0NvbmZpZy5pY2VUcmFuc3BvcnRzID0gcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CiAgICAgIC8vIHdyYXAgc3RhdGljIG1ldGhvZHMuIEN1cnJlbnRseSBqdXN0IGdlbmVyYXRlQ2VydGlmaWNhdGUuCiAgICAgIGlmICh3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5nZW5lcmF0ZUNlcnRpZmljYXRlKSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiwgJ2dlbmVyYXRlQ2VydGlmaWNhdGUnLCB7CiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gd2Via2l0UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIHZhciBvcmlnR2V0U3RhdHMgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHM7CiAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbihzZWxlY3RvciwKICAgICAgICBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgYXJncyA9IGFyZ3VtZW50czsKCiAgICAgIC8vIElmIHNlbGVjdG9yIGlzIGEgZnVuY3Rpb24gdGhlbiB3ZSBhcmUgaW4gdGhlIG9sZCBzdHlsZSBzdGF0cyBzbyBqdXN0CiAgICAgIC8vIHBhc3MgYmFjayB0aGUgb3JpZ2luYWwgZ2V0U3RhdHMgZm9ybWF0IHRvIGF2b2lkIGJyZWFraW5nIG9sZCB1c2Vycy4KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHJldHVybiBvcmlnR2V0U3RhdHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgLy8gV2hlbiBzcGVjLXN0eWxlIGdldFN0YXRzIGlzIHN1cHBvcnRlZCwgcmV0dXJuIHRob3NlIHdoZW4gY2FsbGVkIHdpdGgKICAgICAgLy8gZWl0aGVyIG5vIGFyZ3VtZW50cyBvciB0aGUgc2VsZWN0b3IgYXJndW1lbnQgaXMgbnVsbC4KICAgICAgaWYgKG9yaWdHZXRTdGF0cy5sZW5ndGggPT09IDAgJiYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHwKICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpKSB7CiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbXSk7CiAgICAgIH0KCiAgICAgIHZhciBmaXhDaHJvbWVTdGF0c18gPSBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgIHZhciBzdGFuZGFyZFJlcG9ydCA9IHt9OwogICAgICAgIHZhciByZXBvcnRzID0gcmVzcG9uc2UucmVzdWx0KCk7CiAgICAgICAgcmVwb3J0cy5mb3JFYWNoKGZ1bmN0aW9uKHJlcG9ydCkgewogICAgICAgICAgdmFyIHN0YW5kYXJkU3RhdHMgPSB7CiAgICAgICAgICAgIGlkOiByZXBvcnQuaWQsCiAgICAgICAgICAgIHRpbWVzdGFtcDogcmVwb3J0LnRpbWVzdGFtcCwKICAgICAgICAgICAgdHlwZTogewogICAgICAgICAgICAgIGxvY2FsY2FuZGlkYXRlOiAnbG9jYWwtY2FuZGlkYXRlJywKICAgICAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgICAgICB9W3JlcG9ydC50eXBlXSB8fCByZXBvcnQudHlwZQogICAgICAgICAgfTsKICAgICAgICAgIHJlcG9ydC5uYW1lcygpLmZvckVhY2goZnVuY3Rpb24obmFtZSkgewogICAgICAgICAgICBzdGFuZGFyZFN0YXRzW25hbWVdID0gcmVwb3J0LnN0YXQobmFtZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHN0YW5kYXJkUmVwb3J0W3N0YW5kYXJkU3RhdHMuaWRdID0gc3RhbmRhcmRTdGF0czsKICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIHN0YW5kYXJkUmVwb3J0OwogICAgICB9OwoKICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICB2YXIgbWFrZU1hcFN0YXRzID0gZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICByZXR1cm4gbmV3IE1hcChPYmplY3Qua2V5cyhzdGF0cykubWFwKGZ1bmN0aW9uKGtleSkgewogICAgICAgICAgcmV0dXJuW2tleSwgc3RhdHNba2V5XV07CiAgICAgICAgfSkpOwogICAgICB9OwoKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMikgewogICAgICAgIHZhciBzdWNjZXNzQ2FsbGJhY2tXcmFwcGVyXyA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICBhcmdzWzFdKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgfTsKCiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbc3VjY2Vzc0NhbGxiYWNrV3JhcHBlcl8sCiAgICAgICAgICAgIGFyZ3VtZW50c1swXV0pOwogICAgICB9CgogICAgICAvLyBwcm9taXNlLXN1cHBvcnQKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIG9yaWdHZXRTdGF0cy5hcHBseShzZWxmLCBbCiAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICByZXNvbHZlKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgICB9LCByZWplY3RdKTsKICAgICAgfSkudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spOwogICAgfTsKCiAgICAvLyBhZGQgcHJvbWlzZSBzdXBwb3J0IC0tIG5hdGl2ZWx5IGF2YWlsYWJsZSBpbiBDaHJvbWUgNTEKICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNTEpIHsKICAgICAgWydzZXRMb2NhbERlc2NyaXB0aW9uJywgJ3NldFJlbW90ZURlc2NyaXB0aW9uJywgJ2FkZEljZUNhbmRpZGF0ZSddCiAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzOwogICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFthcmdzWzBdLCByZXNvbHZlLCByZWplY3RdKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGFyZ3NbMV0uYXBwbHkobnVsbCwgW10pOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZnVuY3Rpb24oZXJyKSB7CiAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPj0gMykgewogICAgICAgICAgICAgICAgICBhcmdzWzJdLmFwcGx5KG51bGwsIFtlcnJdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgfQoKICAgIC8vIHByb21pc2Ugc3VwcG9ydCBmb3IgY3JlYXRlT2ZmZXIgYW5kIGNyZWF0ZUFuc3dlci4gQXZhaWxhYmxlICh3aXRob3V0CiAgICAvLyBidWdzKSBzaW5jZSBNNTI6IGNyYnVnLzYxOTI4OQogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MikgewogICAgICBbJ2NyZWF0ZU9mZmVyJywgJ2NyZWF0ZUFuc3dlciddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDEgfHwgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYKICAgICAgICAgICAgICB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnb2JqZWN0JykpIHsKICAgICAgICAgICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkOwogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFtyZXNvbHZlLCByZWplY3QsIG9wdHNdKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CgogICAgLy8gc2hpbSBpbXBsaWNpdCBjcmVhdGlvbiBvZiBSVENTZXNzaW9uRGVzY3JpcHRpb24vUlRDSWNlQ2FuZGlkYXRlCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfQp9OwoKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbU1lZGlhU3RyZWFtOiBjaHJvbWVTaGltLnNoaW1NZWRpYVN0cmVhbSwKICBzaGltT25UcmFjazogY2hyb21lU2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QsCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBjaHJvbWVTaGltLnNoaW1QZWVyQ29ubmVjdGlvbiwKICBzaGltR2V0VXNlck1lZGlhOiByZXF1aXJlKCcuL2dldHVzZXJtZWRpYScpCn07Cgp9LHsiLi4vdXRpbHMuanMiOjExLCIuL2dldHVzZXJtZWRpYSI6NX1dLDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIGNvbnN0cmFpbnRzVG9DaHJvbWVfID0gZnVuY3Rpb24oYykgewogICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLm1hbmRhdG9yeSB8fCBjLm9wdGlvbmFsKSB7CiAgICAgIHJldHVybiBjOwogICAgfQogICAgdmFyIGNjID0ge307CiAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICBpZiAoa2V5ID09PSAncmVxdWlyZScgfHwga2V5ID09PSAnYWR2YW5jZWQnIHx8IGtleSA9PT0gJ21lZGlhU291cmNlJykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgciA9ICh0eXBlb2YgY1trZXldID09PSAnb2JqZWN0JykgPyBjW2tleV0gOiB7aWRlYWw6IGNba2V5XX07CiAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHIuZXhhY3QgPT09ICdudW1iZXInKSB7CiAgICAgICAgci5taW4gPSByLm1heCA9IHIuZXhhY3Q7CiAgICAgIH0KICAgICAgdmFyIG9sZG5hbWVfID0gZnVuY3Rpb24ocHJlZml4LCBuYW1lKSB7CiAgICAgICAgaWYgKHByZWZpeCkgewogICAgICAgICAgcmV0dXJuIHByZWZpeCArIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gKG5hbWUgPT09ICdkZXZpY2VJZCcpID8gJ3NvdXJjZUlkJyA6IG5hbWU7CiAgICAgIH07CiAgICAgIGlmIChyLmlkZWFsICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjYy5vcHRpb25hbCA9IGNjLm9wdGlvbmFsIHx8IFtdOwogICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgIGlmICh0eXBlb2Ygci5pZGVhbCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCdtaW4nLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICAgIG9jID0ge307CiAgICAgICAgICBvY1tvbGRuYW1lXygnbWF4Jywga2V5KV0gPSByLmlkZWFsOwogICAgICAgICAgY2Mub3B0aW9uYWwucHVzaChvYyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHIuZXhhY3QgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygci5leGFjdCAhPT0gJ251bWJlcicpIHsKICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgY2MubWFuZGF0b3J5W29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuZXhhY3Q7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgWydtaW4nLCAnbWF4J10uZm9yRWFjaChmdW5jdGlvbihtaXgpIHsKICAgICAgICAgIGlmIChyW21peF0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgICAgIGNjLm1hbmRhdG9yeVtvbGRuYW1lXyhtaXgsIGtleSldID0gclttaXhdOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICAgIGlmIChjLmFkdmFuY2VkKSB7CiAgICAgIGNjLm9wdGlvbmFsID0gKGNjLm9wdGlvbmFsIHx8IFtdKS5jb25jYXQoYy5hZHZhbmNlZCk7CiAgICB9CiAgICByZXR1cm4gY2M7CiAgfTsKCiAgdmFyIHNoaW1Db25zdHJhaW50c18gPSBmdW5jdGlvbihjb25zdHJhaW50cywgZnVuYykgewogICAgY29uc3RyYWludHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7CiAgICBpZiAoY29uc3RyYWludHMgJiYgY29uc3RyYWludHMuYXVkaW8pIHsKICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy5hdWRpbyk7CiAgICB9CiAgICBpZiAoY29uc3RyYWludHMgJiYgdHlwZW9mIGNvbnN0cmFpbnRzLnZpZGVvID09PSAnb2JqZWN0JykgewogICAgICAvLyBTaGltIGZhY2luZ01vZGUgZm9yIG1vYmlsZSwgd2hlcmUgaXQgZGVmYXVsdHMgdG8gInVzZXIiLgogICAgICB2YXIgZmFjZSA9IGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgIGZhY2UgPSBmYWNlICYmICgodHlwZW9mIGZhY2UgPT09ICdvYmplY3QnKSA/IGZhY2UgOiB7aWRlYWw6IGZhY2V9KTsKCiAgICAgIGlmICgoZmFjZSAmJiAoZmFjZS5leGFjdCA9PT0gJ3VzZXInIHx8IGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwKICAgICAgICAgICAgICAgICAgICBmYWNlLmlkZWFsID09PSAndXNlcicgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykpICYmCiAgICAgICAgICAhKG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0U3VwcG9ydGVkQ29uc3RyYWludHMgJiYKICAgICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRTdXBwb3J0ZWRDb25zdHJhaW50cygpLmZhY2luZ01vZGUpKSB7CiAgICAgICAgZGVsZXRlIGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgICAgaWYgKGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykgewogICAgICAgICAgLy8gTG9vayBmb3IgImJhY2siIGluIGxhYmVsLCBvciB1c2UgbGFzdCBjYW0gKHR5cGljYWxseSBiYWNrIGNhbSkuCiAgICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzKCkKICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgZGV2aWNlcyA9IGRldmljZXMuZmlsdGVyKGZ1bmN0aW9uKGQpIHsKICAgICAgICAgICAgICByZXR1cm4gZC5raW5kID09PSAndmlkZW9pbnB1dCc7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgYmFjayA9IGRldmljZXMuZmluZChmdW5jdGlvbihkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGQubGFiZWwudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdiYWNrJykgIT09IC0xOwogICAgICAgICAgICB9KSB8fCAoZGV2aWNlcy5sZW5ndGggJiYgZGV2aWNlc1tkZXZpY2VzLmxlbmd0aCAtIDFdKTsKICAgICAgICAgICAgaWYgKGJhY2spIHsKICAgICAgICAgICAgICBjb25zdHJhaW50cy52aWRlby5kZXZpY2VJZCA9IGZhY2UuZXhhY3QgPyB7ZXhhY3Q6IGJhY2suZGV2aWNlSWR9IDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aWRlYWw6IGJhY2suZGV2aWNlSWR9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0Nocm9tZV8oY29uc3RyYWludHMudmlkZW8pOwogICAgICAgICAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgICAgICAgICByZXR1cm4gZnVuYyhjb25zdHJhaW50cyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3RyYWludHMudmlkZW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy52aWRlbyk7CiAgICB9CiAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgcmV0dXJuIGZ1bmMoY29uc3RyYWludHMpOwogIH07CgogIHZhciBzaGltRXJyb3JfID0gZnVuY3Rpb24oZSkgewogICAgcmV0dXJuIHsKICAgICAgbmFtZTogewogICAgICAgIFBlcm1pc3Npb25EZW5pZWRFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgQ29uc3RyYWludE5vdFNhdGlzZmllZEVycm9yOiAnT3ZlcmNvbnN0cmFpbmVkRXJyb3InCiAgICAgIH1bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50TmFtZSwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgc2hpbUNvbnN0cmFpbnRzXyhjb25zdHJhaW50cywgZnVuY3Rpb24oYykgewogICAgICBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKGMsIG9uU3VjY2VzcywgZnVuY3Rpb24oZSkgewogICAgICAgIG9uRXJyb3Ioc2hpbUVycm9yXyhlKSk7CiAgICAgIH0pOwogICAgfSk7CiAgfTsKCiAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IGdldFVzZXJNZWRpYV87CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICBpZiAoIW5hdmlnYXRvci5tZWRpYURldmljZXMpIHsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMgPSB7CiAgICAgIGdldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGVudW1lcmF0ZURldmljZXM6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIga2luZHMgPSB7YXVkaW86ICdhdWRpb2lucHV0JywgdmlkZW86ICd2aWRlb2lucHV0J307CiAgICAgICAgICByZXR1cm4gTWVkaWFTdHJlYW1UcmFjay5nZXRTb3VyY2VzKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgcmVzb2x2ZShkZXZpY2VzLm1hcChmdW5jdGlvbihkZXZpY2UpIHsKICAgICAgICAgICAgICByZXR1cm4ge2xhYmVsOiBkZXZpY2UubGFiZWwsCiAgICAgICAgICAgICAgICAgICAgICBraW5kOiBraW5kc1tkZXZpY2Uua2luZF0sCiAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZDogZGV2aWNlLmlkLAogICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogJyd9OwogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfTsKICB9CgogIC8vIEEgc2hpbSBmb3IgZ2V0VXNlck1lZGlhIG1ldGhvZCBvbiB0aGUgbWVkaWFEZXZpY2VzIG9iamVjdC4KICAvLyBUT0RPKEthcHRlbkphbnNzb24pIHJlbW92ZSBvbmNlIGltcGxlbWVudGVkIGluIENocm9tZSBzdGFibGUuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSkgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cykgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhUHJvbWlzZV8oY29uc3RyYWludHMpOwogICAgfTsKICB9IGVsc2UgewogICAgLy8gRXZlbiB0aG91Z2ggQ2hyb21lIDQ1IGhhcyBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzIGFuZCBhIGdldFVzZXJNZWRpYQogICAgLy8gZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhIFByb21pc2UsIGl0IGRvZXMgbm90IGFjY2VwdCBzcGVjLXN0eWxlCiAgICAvLyBjb25zdHJhaW50cy4KICAgIHZhciBvcmlnR2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEuCiAgICAgICAgYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY3MpIHsKICAgICAgcmV0dXJuIHNoaW1Db25zdHJhaW50c18oY3MsIGZ1bmN0aW9uKGMpIHsKICAgICAgICByZXR1cm4gb3JpZ0dldFVzZXJNZWRpYShjKS50aGVuKGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICAgIGMudmlkZW8gJiYgIXN0cmVhbS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCkgewogICAgICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJycsICdOb3RGb3VuZEVycm9yJyk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gc3RyZWFtOwogICAgICAgIH0sIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KCiAgLy8gRHVtbXkgZGV2aWNlY2hhbmdlIGV2ZW50IG1ldGhvZHMuCiAgLy8gVE9ETyhLYXB0ZW5KYW5zc29uKSByZW1vdmUgb25jZSBpbXBsZW1lbnRlZCBpbiBDaHJvbWUgc3RhYmxlLgogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQp9OwoKfSx7Ii4uL3V0aWxzLmpzIjoxMX1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7Cgp2YXIgU0RQVXRpbHMgPSByZXF1aXJlKCdzZHAnKTsKdmFyIGJyb3dzZXJEZXRhaWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5icm93c2VyRGV0YWlsczsKCnZhciBlZGdlU2hpbSA9IHsKICBzaGltUGVlckNvbm5lY3Rpb246IGZ1bmN0aW9uKCkgewogICAgaWYgKHdpbmRvdy5SVENJY2VHYXRoZXJlcikgewogICAgICAvLyBPUlRDIGRlZmluZXMgYW4gUlRDSWNlQ2FuZGlkYXRlIG9iamVjdCBidXQgbm8gY29uc3RydWN0b3IuCiAgICAgIC8vIE5vdCBpbXBsZW1lbnRlZCBpbiBFZGdlLgogICAgICBpZiAoIXdpbmRvdy5SVENJY2VDYW5kaWRhdGUpIHsKICAgICAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oYXJncykgewogICAgICAgICAgcmV0dXJuIGFyZ3M7CiAgICAgICAgfTsKICAgICAgfQogICAgICAvLyBPUlRDIGRvZXMgbm90IGhhdmUgYSBzZXNzaW9uIGRlc2NyaXB0aW9uIG9iamVjdCBidXQKICAgICAgLy8gb3RoZXIgYnJvd3NlcnMgKGkuZS4gQ2hyb21lKSB0aGF0IHdpbGwgc3VwcG9ydCBib3RoIFBDIGFuZCBPUlRDCiAgICAgIC8vIGluIHRoZSBmdXR1cmUgbWlnaHQgaGF2ZSB0aGlzIGRlZmluZWQgYWxyZWFkeS4KICAgICAgaWYgKCF3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKSB7CiAgICAgICAgd2luZG93LlJUQ1Nlc3Npb25EZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGFyZ3MpIHsKICAgICAgICAgIHJldHVybiBhcmdzOwogICAgICAgIH07CiAgICAgIH0KICAgICAgLy8gdGhpcyBhZGRzIGFuIGFkZGl0aW9uYWwgZXZlbnQgbGlzdGVuZXIgdG8gTWVkaWFTdHJhY2tUcmFjayB0aGF0IHNpZ25hbHMKICAgICAgLy8gd2hlbiBhIHRyYWNrcyBlbmFibGVkIHByb3BlcnR5IHdhcyBjaGFuZ2VkLiBXb3JrYXJvdW5kIGZvciBhIGJ1ZyBpbgogICAgICAvLyBhZGRTdHJlYW0sIHNlZSBiZWxvdy4gTm8gbG9uZ2VyIHJlcXVpcmVkIGluIDE1MDI1KwogICAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDE1MDI1KSB7CiAgICAgICAgdmFyIG9yaWdNU1RFbmFibGVkID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcigKICAgICAgICAgICAgTWVkaWFTdHJlYW1UcmFjay5wcm90b3R5cGUsICdlbmFibGVkJyk7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLCAnZW5hYmxlZCcsIHsKICAgICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgb3JpZ01TVEVuYWJsZWQuc2V0LmNhbGwodGhpcywgdmFsdWUpOwogICAgICAgICAgICB2YXIgZXYgPSBuZXcgRXZlbnQoJ2VuYWJsZWQnKTsKICAgICAgICAgICAgZXYuZW5hYmxlZCA9IHZhbHVlOwogICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24oY29uZmlnKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgIHZhciBfZXZlbnRUYXJnZXQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CiAgICAgIFsnYWRkRXZlbnRMaXN0ZW5lcicsICdyZW1vdmVFdmVudExpc3RlbmVyJywgJ2Rpc3BhdGNoRXZlbnQnXQogICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgICAgIHNlbGZbbWV0aG9kXSA9IF9ldmVudFRhcmdldFttZXRob2RdLmJpbmQoX2V2ZW50VGFyZ2V0KTsKICAgICAgICAgIH0pOwoKICAgICAgdGhpcy5vbmljZWNhbmRpZGF0ZSA9IG51bGw7CiAgICAgIHRoaXMub25hZGRzdHJlYW0gPSBudWxsOwogICAgICB0aGlzLm9udHJhY2sgPSBudWxsOwogICAgICB0aGlzLm9ucmVtb3Zlc3RyZWFtID0gbnVsbDsKICAgICAgdGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlID0gbnVsbDsKICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCA9IG51bGw7CiAgICAgIHRoaXMub25kYXRhY2hhbm5lbCA9IG51bGw7CgogICAgICB0aGlzLmxvY2FsU3RyZWFtcyA9IFtdOwogICAgICB0aGlzLnJlbW90ZVN0cmVhbXMgPSBbXTsKICAgICAgdGhpcy5nZXRMb2NhbFN0cmVhbXMgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gc2VsZi5sb2NhbFN0cmVhbXM7CiAgICAgIH07CiAgICAgIHRoaXMuZ2V0UmVtb3RlU3RyZWFtcyA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBzZWxmLnJlbW90ZVN0cmVhbXM7CiAgICAgIH07CgogICAgICB0aGlzLmxvY2FsRGVzY3JpcHRpb24gPSBuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHsKICAgICAgICB0eXBlOiAnJywKICAgICAgICBzZHA6ICcnCiAgICAgIH0pOwogICAgICB0aGlzLnJlbW90ZURlc2NyaXB0aW9uID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJycsCiAgICAgICAgc2RwOiAnJwogICAgICB9KTsKICAgICAgdGhpcy5zaWduYWxpbmdTdGF0ZSA9ICdzdGFibGUnOwogICAgICB0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSA9ICduZXcnOwogICAgICB0aGlzLmljZUdhdGhlcmluZ1N0YXRlID0gJ25ldyc7CgogICAgICB0aGlzLmljZU9wdGlvbnMgPSB7CiAgICAgICAgZ2F0aGVyUG9saWN5OiAnYWxsJywKICAgICAgICBpY2VTZXJ2ZXJzOiBbXQogICAgICB9OwogICAgICBpZiAoY29uZmlnICYmIGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICBzd2l0Y2ggKGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICAgIGNhc2UgJ2FsbCc6CiAgICAgICAgICBjYXNlICdyZWxheSc6CiAgICAgICAgICAgIHRoaXMuaWNlT3B0aW9ucy5nYXRoZXJQb2xpY3kgPSBjb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgJ25vbmUnOgogICAgICAgICAgICAvLyBGSVhNRTogcmVtb3ZlIG9uY2UgaW1wbGVtZW50YXRpb24gYW5kIHNwZWMgaGF2ZSBhZGRlZCB0aGlzLgogICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpY2VUcmFuc3BvcnRQb2xpY3kgIm5vbmUiIG5vdCBzdXBwb3J0ZWQnKTsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIC8vIGRvbid0IHNldCBpY2VUcmFuc3BvcnRQb2xpY3kuCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnVzaW5nQnVuZGxlID0gY29uZmlnICYmIGNvbmZpZy5idW5kbGVQb2xpY3kgPT09ICdtYXgtYnVuZGxlJzsKCiAgICAgIGlmIChjb25maWcgJiYgY29uZmlnLmljZVNlcnZlcnMpIHsKICAgICAgICAvLyBFZGdlIGRvZXMgbm90IGxpa2UKICAgICAgICAvLyAxKSBzdHVuOgogICAgICAgIC8vIDIpIHR1cm46IHRoYXQgZG9lcyBub3QgaGF2ZSBhbGwgb2YgdHVybjpob3N0OnBvcnQ/dHJhbnNwb3J0PXVkcAogICAgICAgIC8vIDMpIHR1cm46IHdpdGggaXB2NiBhZGRyZXNzZXMKICAgICAgICB2YXIgaWNlU2VydmVycyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29uZmlnLmljZVNlcnZlcnMpKTsKICAgICAgICB0aGlzLmljZU9wdGlvbnMuaWNlU2VydmVycyA9IGljZVNlcnZlcnMuZmlsdGVyKGZ1bmN0aW9uKHNlcnZlcikgewogICAgICAgICAgaWYgKHNlcnZlciAmJiBzZXJ2ZXIudXJscykgewogICAgICAgICAgICB2YXIgdXJscyA9IHNlcnZlci51cmxzOwogICAgICAgICAgICBpZiAodHlwZW9mIHVybHMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgdXJscyA9IFt1cmxzXTsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cmxzID0gdXJscy5maWx0ZXIoZnVuY3Rpb24odXJsKSB7CiAgICAgICAgICAgICAgcmV0dXJuICh1cmwuaW5kZXhPZigndHVybjonKSA9PT0gMCAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHJhbnNwb3J0PXVkcCcpICE9PSAtMSAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHVybjpbJykgPT09IC0xKSB8fAogICAgICAgICAgICAgICAgICAodXJsLmluZGV4T2YoJ3N0dW46JykgPT09IDAgJiYKICAgICAgICAgICAgICAgICAgICBicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE0MzkzKTsKICAgICAgICAgICAgfSlbMF07CiAgICAgICAgICAgIHJldHVybiAhIXVybHM7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnOwoKICAgICAgLy8gcGVyLXRyYWNrIGljZUdhdGhlcnMsIGljZVRyYW5zcG9ydHMsIGR0bHNUcmFuc3BvcnRzLCBydHBTZW5kZXJzLCAuLi4KICAgICAgLy8gZXZlcnl0aGluZyB0aGF0IGlzIG5lZWRlZCB0byBkZXNjcmliZSBhIFNEUCBtLWxpbmUuCiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzID0gW107CgogICAgICAvLyBzaW5jZSB0aGUgaWNlR2F0aGVyZXIgaXMgY3VycmVudGx5IGNyZWF0ZWQgaW4gY3JlYXRlT2ZmZXIgYnV0IHdlCiAgICAgIC8vIG11c3Qgbm90IGVtaXQgY2FuZGlkYXRlcyB1bnRpbCBhZnRlciBzZXRMb2NhbERlc2NyaXB0aW9uIHdlIGJ1ZmZlcgogICAgICAvLyB0aGVtIGluIHRoaXMgYXJyYXkuCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlciA9IFtdOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZScpOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICBpZiAodGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgdGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlKGV2ZW50KTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLmxvY2FsRGVzY3JpcHRpb24uc2RwKTsKICAgICAgLy8gRklYTUU6IG5lZWQgdG8gYXBwbHkgaWNlIGNhbmRpZGF0ZXMgaW4gYSB3YXkgd2hpY2ggaXMgYXN5bmMgYnV0CiAgICAgIC8vIGluLW9yZGVyCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlci5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgdmFyIGVuZCA9ICFldmVudC5jYW5kaWRhdGUgfHwgT2JqZWN0LmtleXMoZXZlbnQuY2FuZGlkYXRlKS5sZW5ndGggPT09IDA7CiAgICAgICAgaWYgKGVuZCkgewogICAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBzZWN0aW9ucy5sZW5ndGg7IGorKykgewogICAgICAgICAgICBpZiAoc2VjdGlvbnNbal0uaW5kZXhPZignXHJcbmE9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJykgPT09IC0xKSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbal0gKz0gJ2E9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWN0aW9uc1tldmVudC5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleCArIDFdICs9CiAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgfQogICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICBzZWxmLm9uaWNlY2FuZGlkYXRlKGV2ZW50KTsKICAgICAgICB9CiAgICAgICAgaWYgKCFldmVudC5jYW5kaWRhdGUgJiYgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSAhPT0gJ2NvbXBsZXRlJykgewogICAgICAgICAgdmFyIGNvbXBsZXRlID0gc2VsZi50cmFuc2NlaXZlcnMuZXZlcnkoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICB0cmFuc2NlaXZlci5pY2VHYXRoZXJlci5zdGF0ZSA9PT0gJ2NvbXBsZXRlZCc7CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChjb21wbGV0ZSAmJiBzZWxmLmljZUdhdGhlcmluZ1N0YXRlQ2hhbmdlICE9PSAnY29tcGxldGUnKSB7CiAgICAgICAgICAgIHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUgPSAnY29tcGxldGUnOwogICAgICAgICAgICBzZWxmLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIgPSBbXTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRDb25maWd1cmF0aW9uID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLl9jb25maWc7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkU3RyZWFtID0gZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE1MDI1KSB7CiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXMucHVzaChzdHJlYW0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIENsb25lIGlzIG5lY2Vzc2FyeSBmb3IgbG9jYWwgZGVtb3MgbW9zdGx5LCBhdHRhY2hpbmcgZGlyZWN0bHkKICAgICAgICAvLyB0byB0d28gZGlmZmVyZW50IHNlbmRlcnMgZG9lcyBub3Qgd29yayAoYnVpbGQgMTA1NDcpLgogICAgICAgIC8vIEZpeGVkIGluIDE1MDI1IChvciBlYXJsaWVyKQogICAgICAgIHZhciBjbG9uZWRTdHJlYW0gPSBzdHJlYW0uY2xvbmUoKTsKICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaywgaWR4KSB7CiAgICAgICAgICB2YXIgY2xvbmVkVHJhY2sgPSBjbG9uZWRTdHJlYW0uZ2V0VHJhY2tzKClbaWR4XTsKICAgICAgICAgIHRyYWNrLmFkZEV2ZW50TGlzdGVuZXIoJ2VuYWJsZWQnLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBjbG9uZWRUcmFjay5lbmFibGVkID0gZXZlbnQuZW5hYmxlZDsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHRoaXMubG9jYWxTdHJlYW1zLnB1c2goY2xvbmVkU3RyZWFtKTsKICAgICAgfQogICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICB2YXIgaWR4ID0gdGhpcy5sb2NhbFN0cmVhbXMuaW5kZXhPZihzdHJlYW0pOwogICAgICBpZiAoaWR4ID4gLTEpIHsKICAgICAgICB0aGlzLmxvY2FsU3RyZWFtcy5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy50cmFuc2NlaXZlcnMuZmlsdGVyKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuICEhdHJhbnNjZWl2ZXIucnRwU2VuZGVyOwogICAgICB9KQogICAgICAubWFwKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLnJ0cFNlbmRlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVjZWl2ZXJzID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLnRyYW5zY2VpdmVycy5maWx0ZXIoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICByZXR1cm4gISF0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSkKICAgICAgLm1hcChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIHJldHVybiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIC8vIERldGVybWluZXMgdGhlIGludGVyc2VjdGlvbiBvZiBsb2NhbCBhbmQgcmVtb3RlIGNhcGFiaWxpdGllcy4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2dldENvbW1vbkNhcGFiaWxpdGllcyA9CiAgICAgICAgZnVuY3Rpb24obG9jYWxDYXBhYmlsaXRpZXMsIHJlbW90ZUNhcGFiaWxpdGllcykgewogICAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHsKICAgICAgICAgICAgY29kZWNzOiBbXSwKICAgICAgICAgICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICAgICAgICAgIGZlY01lY2hhbmlzbXM6IFtdCiAgICAgICAgICB9OwogICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24obENvZGVjKSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3RlQ2FwYWJpbGl0aWVzLmNvZGVjcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIHZhciByQ29kZWMgPSByZW1vdGVDYXBhYmlsaXRpZXMuY29kZWNzW2ldOwogICAgICAgICAgICAgIGlmIChsQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpID09PSByQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpICYmCiAgICAgICAgICAgICAgICAgIGxDb2RlYy5jbG9ja1JhdGUgPT09IHJDb2RlYy5jbG9ja1JhdGUpIHsKICAgICAgICAgICAgICAgIC8vIG51bWJlciBvZiBjaGFubmVscyBpcyB0aGUgaGlnaGVzdCBjb21tb24gbnVtYmVyIG9mIGNoYW5uZWxzCiAgICAgICAgICAgICAgICByQ29kZWMubnVtQ2hhbm5lbHMgPSBNYXRoLm1pbihsQ29kZWMubnVtQ2hhbm5lbHMsCiAgICAgICAgICAgICAgICAgICAgckNvZGVjLm51bUNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIC8vIHB1c2ggckNvZGVjIHNvIHdlIHJlcGx5IHdpdGggb2ZmZXJlciBwYXlsb2FkIHR5cGUKICAgICAgICAgICAgICAgIGNvbW1vbkNhcGFiaWxpdGllcy5jb2RlY3MucHVzaChyQ29kZWMpOwoKICAgICAgICAgICAgICAgIC8vIGRldGVybWluZSBjb21tb24gZmVlZGJhY2sgbWVjaGFuaXNtcwogICAgICAgICAgICAgICAgckNvZGVjLnJ0Y3BGZWVkYmFjayA9IHJDb2RlYy5ydGNwRmVlZGJhY2suZmlsdGVyKGZ1bmN0aW9uKGZiKSB7CiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbENvZGVjLnJ0Y3BGZWVkYmFjay5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGlmIChsQ29kZWMucnRjcEZlZWRiYWNrW2pdLnR5cGUgPT09IGZiLnR5cGUgJiYKICAgICAgICAgICAgICAgICAgICAgICAgbENvZGVjLnJ0Y3BGZWVkYmFja1tqXS5wYXJhbWV0ZXIgPT09IGZiLnBhcmFtZXRlcikgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFsc28gbmVlZCB0byBkZXRlcm1pbmUgLnBhcmFtZXRlcnMKICAgICAgICAgICAgICAgIC8vICBzZWUgaHR0cHM6Ly9naXRodWIuY29tL29wZW5wZWVyL29ydGMvaXNzdWVzLzU2OQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zCiAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obEhlYWRlckV4dGVuc2lvbikgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZW1vdGVDYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9ucy5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgIGkrKykgewogICAgICAgICAgICAgICAgICB2YXIgckhlYWRlckV4dGVuc2lvbiA9IHJlbW90ZUNhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zW2ldOwogICAgICAgICAgICAgICAgICBpZiAobEhlYWRlckV4dGVuc2lvbi51cmkgPT09IHJIZWFkZXJFeHRlbnNpb24udXJpKSB7CiAgICAgICAgICAgICAgICAgICAgY29tbW9uQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMucHVzaChySGVhZGVyRXh0ZW5zaW9uKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgIC8vIEZJWE1FOiBmZWNNZWNoYW5pc21zCiAgICAgICAgICByZXR1cm4gY29tbW9uQ2FwYWJpbGl0aWVzOwogICAgICAgIH07CgogICAgLy8gQ3JlYXRlIElDRSBnYXRoZXJlciwgSUNFIHRyYW5zcG9ydCBhbmQgRFRMUyB0cmFuc3BvcnQuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyA9CiAgICAgICAgZnVuY3Rpb24obWlkLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgaWNlR2F0aGVyZXIgPSBuZXcgUlRDSWNlR2F0aGVyZXIoc2VsZi5pY2VPcHRpb25zKTsKICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSBuZXcgUlRDSWNlVHJhbnNwb3J0KGljZUdhdGhlcmVyKTsKICAgICAgICAgIGljZUdhdGhlcmVyLm9ubG9jYWxjYW5kaWRhdGUgPSBmdW5jdGlvbihldnQpIHsKICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKTsKICAgICAgICAgICAgZXZlbnQuY2FuZGlkYXRlID0ge3NkcE1pZDogbWlkLCBzZHBNTGluZUluZGV4OiBzZHBNTGluZUluZGV4fTsKCiAgICAgICAgICAgIHZhciBjYW5kID0gZXZ0LmNhbmRpZGF0ZTsKICAgICAgICAgICAgdmFyIGVuZCA9ICFjYW5kIHx8IE9iamVjdC5rZXlzKGNhbmQpLmxlbmd0aCA9PT0gMDsKICAgICAgICAgICAgLy8gRWRnZSBlbWl0cyBhbiBlbXB0eSBvYmplY3QgZm9yIFJUQ0ljZUNhbmRpZGF0ZUNvbXBsZXRl4oClCiAgICAgICAgICAgIGlmIChlbmQpIHsKICAgICAgICAgICAgICAvLyBwb2x5ZmlsbCBzaW5jZSBSVENJY2VHYXRoZXJlci5zdGF0ZSBpcyBub3QgaW1wbGVtZW50ZWQgaW4KICAgICAgICAgICAgICAvLyBFZGdlIDEwNTQ3IHlldC4KICAgICAgICAgICAgICBpZiAoaWNlR2F0aGVyZXIuc3RhdGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgaWNlR2F0aGVyZXIuc3RhdGUgPSAnY29tcGxldGVkJzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gUlRDSWNlQ2FuZGlkYXRlIGRvZXNuJ3QgaGF2ZSBhIGNvbXBvbmVudCwgbmVlZHMgdG8gYmUgYWRkZWQKICAgICAgICAgICAgICBjYW5kLmNvbXBvbmVudCA9IGljZVRyYW5zcG9ydC5jb21wb25lbnQgPT09ICdSVENQJyA/IDIgOiAxOwogICAgICAgICAgICAgIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgPSBTRFBVdGlscy53cml0ZUNhbmRpZGF0ZShjYW5kKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdXBkYXRlIGxvY2FsIGRlc2NyaXB0aW9uLgogICAgICAgICAgICB2YXIgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHApOwogICAgICAgICAgICBpZiAoIWVuZCkgewogICAgICAgICAgICAgIHNlY3Rpb25zW2V2ZW50LmNhbmRpZGF0ZS5zZHBNTGluZUluZGV4ICsgMV0gKz0KICAgICAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbZXZlbnQuY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXggKyAxXSArPQogICAgICAgICAgICAgICAgICAnYT1lbmQtb2YtY2FuZGlkYXRlc1xyXG4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IHNlbGYuX3BlbmRpbmdPZmZlciA/IHNlbGYuX3BlbmRpbmdPZmZlciA6CiAgICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyczsKICAgICAgICAgICAgdmFyIGNvbXBsZXRlID0gdHJhbnNjZWl2ZXJzLmV2ZXJ5KGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLnN0YXRlID09PSAnY29tcGxldGVkJzsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBFbWl0IGNhbmRpZGF0ZSBpZiBsb2NhbERlc2NyaXB0aW9uIGlzIHNldC4KICAgICAgICAgICAgLy8gQWxzbyBlbWl0cyBudWxsIGNhbmRpZGF0ZSB3aGVuIGFsbCBnYXRoZXJlcnMgYXJlIGNvbXBsZXRlLgogICAgICAgICAgICBzd2l0Y2ggKHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUpIHsKICAgICAgICAgICAgICBjYXNlICduZXcnOgogICAgICAgICAgICAgICAgaWYgKCFlbmQpIHsKICAgICAgICAgICAgICAgICAgc2VsZi5fbG9jYWxJY2VDYW5kaWRhdGVzQnVmZmVyLnB1c2goZXZlbnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGVuZCAmJiBjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIucHVzaCgKICAgICAgICAgICAgICAgICAgICAgIG5ldyBFdmVudCgnaWNlY2FuZGlkYXRlJykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAnZ2F0aGVyaW5nJzoKICAgICAgICAgICAgICAgIHNlbGYuX2VtaXRCdWZmZXJlZENhbmRpZGF0ZXMoKTsKICAgICAgICAgICAgICAgIGlmICghZW5kKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShldmVudCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKSk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShuZXcgRXZlbnQoJ2ljZWNhbmRpZGF0ZScpKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBzZWxmLmljZUdhdGhlcmluZ1N0YXRlID0gJ2NvbXBsZXRlJzsKICAgICAgICAgICAgICAgICAgc2VsZi5fZW1pdEdhdGhlcmluZ1N0YXRlQ2hhbmdlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlICdjb21wbGV0ZSc6CiAgICAgICAgICAgICAgICAvLyBzaG91bGQgbm90IGhhcHBlbi4uLiBjdXJyZW50bHkhCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBkZWZhdWx0OiAvLyBuby1vcC4KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgaWNlVHJhbnNwb3J0Lm9uaWNlc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHZhciBkdGxzVHJhbnNwb3J0ID0gbmV3IFJUQ0R0bHNUcmFuc3BvcnQoaWNlVHJhbnNwb3J0KTsKICAgICAgICAgIGR0bHNUcmFuc3BvcnQub25kdGxzc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwogICAgICAgICAgZHRsc1RyYW5zcG9ydC5vbmVycm9yID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIC8vIG9uZXJyb3IgZG9lcyBub3Qgc2V0IHN0YXRlIHRvIGZhaWxlZCBieSBpdHNlbGYuCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQuc3RhdGUgPSAnZmFpbGVkJzsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGljZUdhdGhlcmVyOiBpY2VHYXRoZXJlciwKICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiBpY2VUcmFuc3BvcnQsCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IGR0bHNUcmFuc3BvcnQKICAgICAgICAgIH07CiAgICAgICAgfTsKCiAgICAvLyBTdGFydCB0aGUgUlRQIFNlbmRlciBhbmQgUmVjZWl2ZXIgZm9yIGEgdHJhbnNjZWl2ZXIuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl90cmFuc2NlaXZlID0gZnVuY3Rpb24odHJhbnNjZWl2ZXIsCiAgICAgICAgc2VuZCwgcmVjdikgewogICAgICB2YXIgcGFyYW1zID0gdGhpcy5fZ2V0Q29tbW9uQ2FwYWJpbGl0aWVzKHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLAogICAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzKTsKICAgICAgaWYgKHNlbmQgJiYgdHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgcGFyYW1zLmVuY29kaW5ncyA9IHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgcGFyYW1zLnJ0Y3AgPSB7CiAgICAgICAgICBjbmFtZTogU0RQVXRpbHMubG9jYWxDTmFtZQogICAgICAgIH07CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLnJlY3ZFbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoKSB7CiAgICAgICAgICBwYXJhbXMucnRjcC5zc3JjID0gdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjOwogICAgICAgIH0KICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc2VuZChwYXJhbXMpOwogICAgICB9CiAgICAgIGlmIChyZWN2ICYmIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyKSB7CiAgICAgICAgLy8gcmVtb3ZlIFJUWCBmaWVsZCBpbiBFZGdlIDE0OTQyCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmtpbmQgPT09ICd2aWRlbycKICAgICAgICAgICAgJiYgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycykgewogICAgICAgICAgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHApIHsKICAgICAgICAgICAgZGVsZXRlIHAucnR4OwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHBhcmFtcy5lbmNvZGluZ3MgPSB0cmFuc2NlaXZlci5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgIHBhcmFtcy5ydGNwID0gewogICAgICAgICAgY25hbWU6IHRyYW5zY2VpdmVyLmNuYW1lCiAgICAgICAgfTsKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycy5sZW5ndGgpIHsKICAgICAgICAgIHBhcmFtcy5ydGNwLnNzcmMgPSB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmM7CiAgICAgICAgfQogICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnJlY2VpdmUocGFyYW1zKTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb24gPQogICAgICAgIGZ1bmN0aW9uKGRlc2NyaXB0aW9uKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgc2VjdGlvbnM7CiAgICAgICAgICB2YXIgc2Vzc2lvbnBhcnQ7CiAgICAgICAgICBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ29mZmVyJykgewogICAgICAgICAgICAvLyBGSVhNRTogV2hhdCB3YXMgdGhlIHB1cnBvc2Ugb2YgdGhpcyBlbXB0eSBpZiBzdGF0ZW1lbnQ/CiAgICAgICAgICAgIC8vIGlmICghdGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgICAgIC8vIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nT2ZmZXIpIHsKICAgICAgICAgICAgICAvLyBWRVJZIGxpbWl0ZWQgc3VwcG9ydCBmb3IgU0RQIG11bmdpbmcuIExpbWl0ZWQgdG86CiAgICAgICAgICAgICAgLy8gKiBjaGFuZ2luZyB0aGUgb3JkZXIgb2YgY29kZWNzCiAgICAgICAgICAgICAgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKGRlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQgPSBzZWN0aW9ucy5zaGlmdCgpOwogICAgICAgICAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICAgICAgICB2YXIgY2FwcyA9IFNEUFV0aWxzLnBhcnNlUnRwUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICAgICAgc2VsZi5fcGVuZGluZ09mZmVyW3NkcE1MaW5lSW5kZXhdLmxvY2FsQ2FwYWJpbGl0aWVzID0gY2FwczsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0aGlzLnRyYW5zY2VpdmVycyA9IHRoaXMuX3BlbmRpbmdPZmZlcjsKICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcGVuZGluZ09mZmVyOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgICAgIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgIHNlc3Npb25wYXJ0ID0gc2VjdGlvbnMuc2hpZnQoKTsKICAgICAgICAgICAgdmFyIGlzSWNlTGl0ZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgICBzZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKG1lZGlhU2VjdGlvbiwgc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQ7CiAgICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0OwogICAgICAgICAgICAgIHZhciBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwogICAgICAgICAgICAgIHZhciByZW1vdGVDYXBhYmlsaXRpZXMgPSB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IG1lZGlhU2VjdGlvbi5zcGxpdCgnXG4nLCAxKVswXQogICAgICAgICAgICAgICAgICAuc3BsaXQoJyAnLCAyKVsxXSA9PT0gJzAnOwoKICAgICAgICAgICAgICBpZiAoIXJlamVjdGVkICYmICF0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSWNlUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldEljZVBhcmFtZXRlcnMoCiAgICAgICAgICAgICAgICAgICAgbWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCk7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnMgPSBTRFBVdGlscy5nZXREdGxzUGFyYW1ldGVycygKICAgICAgICAgICAgICAgICAgICBtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICAgIGlmIChpc0ljZUxpdGUpIHsKICAgICAgICAgICAgICAgICAgcmVtb3RlRHRsc1BhcmFtZXRlcnMucm9sZSA9ICdzZXJ2ZXInOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydC5zdGFydChpY2VHYXRoZXJlciwgcmVtb3RlSWNlUGFyYW1ldGVycywKICAgICAgICAgICAgICAgICAgICAgIGlzSWNlTGl0ZSA/ICdjb250cm9sbGluZycgOiAnY29udHJvbGxlZCcpOwogICAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgaW50ZXJzZWN0aW9uIG9mIGNhcGFiaWxpdGllcy4KICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSBzZWxmLl9nZXRDb21tb25DYXBhYmlsaXRpZXMobG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgICAgICAgICAgcmVtb3RlQ2FwYWJpbGl0aWVzKTsKCiAgICAgICAgICAgICAgICAvLyBTdGFydCB0aGUgUlRDUnRwU2VuZGVyLiBUaGUgUlRDUnRwUmVjZWl2ZXIgZm9yIHRoaXMKICAgICAgICAgICAgICAgIC8vIHRyYW5zY2VpdmVyIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBpbiBzZXRSZW1vdGVEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmNvZGVjcy5sZW5ndGggPiAwLAogICAgICAgICAgICAgICAgICAgIGZhbHNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMubG9jYWxEZXNjcmlwdGlvbiA9IHsKICAgICAgICAgICAgdHlwZTogZGVzY3JpcHRpb24udHlwZSwKICAgICAgICAgICAgc2RwOiBkZXNjcmlwdGlvbi5zZHAKICAgICAgICAgIH07CiAgICAgICAgICBzd2l0Y2ggKGRlc2NyaXB0aW9uLnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAnb2ZmZXInOgogICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdoYXZlLWxvY2FsLW9mZmVyJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2Fuc3dlcic6CiAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ3N0YWJsZScpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3Vuc3VwcG9ydGVkIHR5cGUgIicgKyBkZXNjcmlwdGlvbi50eXBlICsKICAgICAgICAgICAgICAgICAgJyInKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBJZiBhIHN1Y2Nlc3MgY2FsbGJhY2sgd2FzIHByb3ZpZGVkLCBlbWl0IElDRSBjYW5kaWRhdGVzIGFmdGVyIGl0CiAgICAgICAgICAvLyBoYXMgYmVlbiBleGVjdXRlZC4gT3RoZXJ3aXNlLCBlbWl0IGNhbGxiYWNrIGFmdGVyIHRoZSBQcm9taXNlIGlzCiAgICAgICAgICAvLyByZXNvbHZlZC4KICAgICAgICAgIHZhciBoYXNDYWxsYmFjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmCiAgICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbic7CiAgICAgICAgICBpZiAoaGFzQ2FsbGJhY2spIHsKICAgICAgICAgICAgdmFyIGNiID0gYXJndW1lbnRzWzFdOwogICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICBjYigpOwogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBzZWxmLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzKCk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHAgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICAgIHAudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgaWYgKCFoYXNDYWxsYmFjaykgewogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBVc3VhbGx5IGNhbmRpZGF0ZXMgd2lsbCBiZSBlbWl0dGVkIGVhcmxpZXIuCiAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoc2VsZi5fZW1pdEJ1ZmZlcmVkQ2FuZGlkYXRlcy5iaW5kKHNlbGYpLCA1MDApOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBwOwogICAgICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbiA9CiAgICAgICAgZnVuY3Rpb24oZGVzY3JpcHRpb24pIHsKICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgIHZhciBzdHJlYW0gPSBuZXcgTWVkaWFTdHJlYW0oKTsKICAgICAgICAgIHZhciByZWNlaXZlckxpc3QgPSBbXTsKICAgICAgICAgIHZhciBzZWN0aW9ucyA9IFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMoZGVzY3JpcHRpb24uc2RwKTsKICAgICAgICAgIHZhciBzZXNzaW9ucGFydCA9IHNlY3Rpb25zLnNoaWZ0KCk7CiAgICAgICAgICB2YXIgaXNJY2VMaXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoc2Vzc2lvbnBhcnQsCiAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgdGhpcy51c2luZ0J1bmRsZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICdhPWdyb3VwOkJVTkRMRSAnKS5sZW5ndGggPiAwOwogICAgICAgICAgc2VjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNkcE1MaW5lSW5kZXgpIHsKICAgICAgICAgICAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICB2YXIgbWxpbmUgPSBsaW5lc1swXS5zdWJzdHIoMikuc3BsaXQoJyAnKTsKICAgICAgICAgICAgdmFyIGtpbmQgPSBtbGluZVswXTsKICAgICAgICAgICAgdmFyIHJlamVjdGVkID0gbWxpbmVbMV0gPT09ICcwJzsKICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IFNEUFV0aWxzLmdldERpcmVjdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKCiAgICAgICAgICAgIHZhciBtaWQgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPW1pZDonKTsKICAgICAgICAgICAgaWYgKG1pZC5sZW5ndGgpIHsKICAgICAgICAgICAgICBtaWQgPSBtaWRbMF0uc3Vic3RyKDYpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG1pZCA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBSZWplY3QgZGF0YWNoYW5uZWxzIHdoaWNoIGFyZSBub3QgaW1wbGVtZW50ZWQgeWV0LgogICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2FwcGxpY2F0aW9uJyAmJiBtbGluZVsyXSA9PT0gJ0RUTFMvU0NUUCcpIHsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIG1pZDogbWlkLAogICAgICAgICAgICAgICAgaXNEYXRhY2hhbm5lbDogdHJ1ZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgdHJhbnNjZWl2ZXI7CiAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlcjsKICAgICAgICAgICAgdmFyIGljZVRyYW5zcG9ydDsKICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQ7CiAgICAgICAgICAgIHZhciBydHBTZW5kZXI7CiAgICAgICAgICAgIHZhciBydHBSZWNlaXZlcjsKICAgICAgICAgICAgdmFyIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgICAgIHZhciByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICB2YXIgdHJhY2s7CiAgICAgICAgICAgIC8vIEZJWE1FOiBlbnN1cmUgdGhlIG1lZGlhU2VjdGlvbiBoYXMgcnRjcC1tdXggc2V0LgogICAgICAgICAgICB2YXIgcmVtb3RlQ2FwYWJpbGl0aWVzID0gU0RQVXRpbHMucGFyc2VSdHBQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CiAgICAgICAgICAgIHZhciByZW1vdGVJY2VQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnM7CiAgICAgICAgICAgIGlmICghcmVqZWN0ZWQpIHsKICAgICAgICAgICAgICByZW1vdGVJY2VQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0SWNlUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24sCiAgICAgICAgICAgICAgICAgIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICByZW1vdGVEdGxzUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbiwKICAgICAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQpOwogICAgICAgICAgICAgIHJlbW90ZUR0bHNQYXJhbWV0ZXJzLnJvbGUgPSAnY2xpZW50JzsKICAgICAgICAgICAgfQogICAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgIFNEUFV0aWxzLnBhcnNlUnRwRW5jb2RpbmdQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CgogICAgICAgICAgICB2YXIgY25hbWU7CiAgICAgICAgICAgIC8vIEdldHMgdGhlIGZpcnN0IFNTUkMuIE5vdGUgdGhhdCB3aXRoIFJUWCB0aGVyZSBtaWdodCBiZSBtdWx0aXBsZQogICAgICAgICAgICAvLyBTU1JDcy4KICAgICAgICAgICAgdmFyIHJlbW90ZVNzcmMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNzcmM6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24obGluZSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihvYmopIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iai5hdHRyaWJ1dGUgPT09ICdjbmFtZSc7CiAgICAgICAgICAgICAgICB9KVswXTsKICAgICAgICAgICAgaWYgKHJlbW90ZVNzcmMpIHsKICAgICAgICAgICAgICBjbmFtZSA9IHJlbW90ZVNzcmMudmFsdWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBpc0NvbXBsZXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLAogICAgICAgICAgICAgICAgJ2E9ZW5kLW9mLWNhbmRpZGF0ZXMnLCBzZXNzaW9ucGFydCkubGVuZ3RoID4gMDsKICAgICAgICAgICAgdmFyIGNhbmRzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1jYW5kaWRhdGU6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24oY2FuZCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUoY2FuZCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihjYW5kKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBjYW5kLmNvbXBvbmVudCA9PT0gJzEnOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInICYmICFyZWplY3RlZCkgewogICAgICAgICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiBzZWxmLnRyYW5zY2VpdmVyc1swXS5pY2VHYXRoZXJlciwKICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uaWNlVHJhbnNwb3J0LAogICAgICAgICAgICAgICAgZHRsc1RyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICAgICAgICBpZiAoaXNDb21wbGV0ZSAmJiAoIXNlbGYudXNpbmdCdW5kbGUgfHwgc2RwTUxpbmVJbmRleCA9PT0gMCkpIHsKICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuaWNlVHJhbnNwb3J0LnNldFJlbW90ZUNhbmRpZGF0ZXMoY2FuZHMpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBSZWNlaXZlci5nZXRDYXBhYmlsaXRpZXMoa2luZCk7CgogICAgICAgICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMgPSBbewogICAgICAgICAgICAgICAgc3NyYzogKDIgKiBzZHBNTGluZUluZGV4ICsgMikgKiAxMDAxCiAgICAgICAgICAgICAgfV07CgogICAgICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CgogICAgICAgICAgICAgIHRyYWNrID0gcnRwUmVjZWl2ZXIudHJhY2s7CiAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgIC8vIEZJWE1FOiBub3QgY29ycmVjdCB3aGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBzdHJlYW1zIGJ1dCB0aGF0IGlzCiAgICAgICAgICAgICAgLy8gbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgaW4gdGhpcyBzaGltLgogICAgICAgICAgICAgIHN0cmVhbS5hZGRUcmFjayh0cmFjayk7CgogICAgICAgICAgICAgIC8vIEZJWE1FOiBsb29rIGF0IGRpcmVjdGlvbi4KICAgICAgICAgICAgICBpZiAoc2VsZi5sb2NhbFN0cmVhbXMubGVuZ3RoID4gMCAmJgogICAgICAgICAgICAgICAgICBzZWxmLmxvY2FsU3RyZWFtc1swXS5nZXRUcmFja3MoKS5sZW5ndGggPj0gc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgICAgdmFyIGxvY2FsVHJhY2s7CiAgICAgICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0QXVkaW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2luZCA9PT0gJ3ZpZGVvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0VmlkZW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChsb2NhbFRyYWNrKSB7CiAgICAgICAgICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIobG9jYWxUcmFjaywKICAgICAgICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc3BvcnRzLmljZUdhdGhlcmVyLAogICAgICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmljZVRyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzOiBsb2NhbENhcGFiaWxpdGllcywKICAgICAgICAgICAgICAgIHJlbW90ZUNhcGFiaWxpdGllczogcmVtb3RlQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAgICAgcnRwU2VuZGVyOiBydHBTZW5kZXIsCiAgICAgICAgICAgICAgICBydHBSZWNlaXZlcjogcnRwUmVjZWl2ZXIsCiAgICAgICAgICAgICAgICBraW5kOiBraW5kLAogICAgICAgICAgICAgICAgbWlkOiBtaWQsCiAgICAgICAgICAgICAgICBjbmFtZTogY25hbWUsCiAgICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzOiBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzLAogICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczogcmVjdkVuY29kaW5nUGFyYW1ldGVycwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgLy8gU3RhcnQgdGhlIFJUQ1J0cFJlY2VpdmVyIG5vdy4gVGhlIFJUUFNlbmRlciBpcyBzdGFydGVkIGluCiAgICAgICAgICAgICAgLy8gc2V0TG9jYWxEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICBzZWxmLl90cmFuc2NlaXZlKHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLAogICAgICAgICAgICAgICAgICBmYWxzZSwKICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uID09PSAnc2VuZHJlY3YnIHx8IGRpcmVjdGlvbiA9PT0gJ3NlbmRvbmx5Jyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ2Fuc3dlcicgJiYgIXJlamVjdGVkKSB7CiAgICAgICAgICAgICAgdHJhbnNjZWl2ZXIgPSBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XTsKICAgICAgICAgICAgICBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIGljZVRyYW5zcG9ydCA9IHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydDsKICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0ID0gdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydDsKICAgICAgICAgICAgICBydHBTZW5kZXIgPSB0cmFuc2NlaXZlci5ydHBTZW5kZXI7CiAgICAgICAgICAgICAgcnRwUmVjZWl2ZXIgPSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzID0gdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZW1vdGVDYXBhYmlsaXRpZXMgPQogICAgICAgICAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM7CiAgICAgICAgICAgICAgc2VsZi50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uY25hbWUgPSBjbmFtZTsKCiAgICAgICAgICAgICAgaWYgKChpc0ljZUxpdGUgfHwgaXNDb21wbGV0ZSkgJiYgY2FuZHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc2V0UmVtb3RlQ2FuZGlkYXRlcyhjYW5kcyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc3RhcnQoaWNlR2F0aGVyZXIsIHJlbW90ZUljZVBhcmFtZXRlcnMsCiAgICAgICAgICAgICAgICAgICAgJ2NvbnRyb2xsaW5nJyk7CiAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdyZWN2b25seScsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpOwoKICAgICAgICAgICAgICBpZiAocnRwUmVjZWl2ZXIgJiYKICAgICAgICAgICAgICAgICAgKGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpKSB7CiAgICAgICAgICAgICAgICB0cmFjayA9IHJ0cFJlY2VpdmVyLnRyYWNrOwogICAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgICAgc3RyZWFtLmFkZFRyYWNrKHRyYWNrKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFjdHVhbGx5IHRoZSByZWNlaXZlciBzaG91bGQgYmUgY3JlYXRlZCBsYXRlci4KICAgICAgICAgICAgICAgIGRlbGV0ZSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIHRoaXMucmVtb3RlRGVzY3JpcHRpb24gPSB7CiAgICAgICAgICAgIHR5cGU6IGRlc2NyaXB0aW9uLnR5cGUsCiAgICAgICAgICAgIHNkcDogZGVzY3JpcHRpb24uc2RwCiAgICAgICAgICB9OwogICAgICAgICAgc3dpdGNoIChkZXNjcmlwdGlvbi50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgJ29mZmVyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnaGF2ZS1yZW1vdGUtb2ZmZXInKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnYW5zd2VyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnc3RhYmxlJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigndW5zdXBwb3J0ZWQgdHlwZSAiJyArIGRlc2NyaXB0aW9uLnR5cGUgKwogICAgICAgICAgICAgICAgICAnIicpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHN0cmVhbS5nZXRUcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgICAgc2VsZi5yZW1vdGVTdHJlYW1zLnB1c2goc3RyZWFtKTsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdhZGRzdHJlYW0nKTsKICAgICAgICAgICAgICBldmVudC5zdHJlYW0gPSBzdHJlYW07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgICBpZiAoc2VsZi5vbmFkZHN0cmVhbSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYub25hZGRzdHJlYW0oZXZlbnQpOwogICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZWNlaXZlckxpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CiAgICAgICAgICAgICAgICB2YXIgdHJhY2sgPSBpdGVtWzBdOwogICAgICAgICAgICAgICAgdmFyIHJlY2VpdmVyID0gaXRlbVsxXTsKICAgICAgICAgICAgICAgIHZhciB0cmFja0V2ZW50ID0gbmV3IEV2ZW50KCd0cmFjaycpOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5yZWNlaXZlciA9IHJlY2VpdmVyOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5zdHJlYW1zID0gW3N0cmVhbV07CiAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQodHJhY2tFdmVudCk7CiAgICAgICAgICAgICAgICBpZiAoc2VsZi5vbnRyYWNrICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHNlbGYub250cmFjayh0cmFja0V2ZW50KTsKICAgICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoYXJndW1lbnRzWzFdLCAwKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIC8qIG5vdCB5ZXQKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgICovCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCkgewogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0b3AoKTsKICAgICAgICB9CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBGSVhNRTogY2xlYW4gdXAgdHJhY2tzLCBsb2NhbCBzdHJlYW1zLCByZW1vdGUgc3RyZWFtcywgZXRjCiAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdjbG9zZWQnKTsKICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBzaWduYWxpbmcgc3RhdGUuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl91cGRhdGVTaWduYWxpbmdTdGF0ZSA9CiAgICAgICAgZnVuY3Rpb24obmV3U3RhdGUpIHsKICAgICAgICAgIHRoaXMuc2lnbmFsaW5nU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnc2lnbmFsaW5nc3RhdGVjaGFuZ2UnKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICBpZiAodGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHRoaXMub25zaWduYWxpbmdzdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAvLyBEZXRlcm1pbmUgd2hldGhlciB0byBmaXJlIHRoZSBuZWdvdGlhdGlvbm5lZWRlZCBldmVudC4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX21heWJlRmlyZU5lZ290aWF0aW9uTmVlZGVkID0KICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgIC8vIEZpcmUgYXdheSAoZm9yIG5vdykuCiAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ25lZ290aWF0aW9ubmVlZGVkJyk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgICAgaWYgKHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCAhPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLm9ubmVnb3RpYXRpb25uZWVkZWQoZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBjb25uZWN0aW9uIHN0YXRlLgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fdXBkYXRlQ29ubmVjdGlvblN0YXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIG5ld1N0YXRlOwogICAgICB2YXIgc3RhdGVzID0gewogICAgICAgICduZXcnOiAwLAogICAgICAgIGNsb3NlZDogMCwKICAgICAgICBjb25uZWN0aW5nOiAwLAogICAgICAgIGNoZWNraW5nOiAwLAogICAgICAgIGNvbm5lY3RlZDogMCwKICAgICAgICBjb21wbGV0ZWQ6IDAsCiAgICAgICAgZmFpbGVkOiAwCiAgICAgIH07CiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICBzdGF0ZXNbdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICAgIHN0YXRlc1t0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICB9KTsKICAgICAgLy8gSUNFVHJhbnNwb3J0LmNvbXBsZXRlZCBhbmQgY29ubmVjdGVkIGFyZSB0aGUgc2FtZSBmb3IgdGhpcyBwdXJwb3NlLgogICAgICBzdGF0ZXMuY29ubmVjdGVkICs9IHN0YXRlcy5jb21wbGV0ZWQ7CgogICAgICBuZXdTdGF0ZSA9ICduZXcnOwogICAgICBpZiAoc3RhdGVzLmZhaWxlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdmYWlsZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5jb25uZWN0aW5nID4gMCB8fCBzdGF0ZXMuY2hlY2tpbmcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnY29ubmVjdGluZyc7CiAgICAgIH0gZWxzZSBpZiAoc3RhdGVzLmRpc2Nvbm5lY3RlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdkaXNjb25uZWN0ZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5uZXcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnbmV3JzsKICAgICAgfSBlbHNlIGlmIChzdGF0ZXMuY29ubmVjdGVkID4gMCB8fCBzdGF0ZXMuY29tcGxldGVkID4gMCkgewogICAgICAgIG5ld1N0YXRlID0gJ2Nvbm5lY3RlZCc7CiAgICAgIH0KCiAgICAgIGlmIChuZXdTdGF0ZSAhPT0gc2VsZi5pY2VDb25uZWN0aW9uU3RhdGUpIHsKICAgICAgICBzZWxmLmljZUNvbm5lY3Rpb25TdGF0ZSA9IG5ld1N0YXRlOwogICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlJyk7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICBpZiAodGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSAhPT0gbnVsbCkgewogICAgICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY3JlYXRlT2ZmZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAodGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjcmVhdGVPZmZlciBjYWxsZWQgd2hpbGUgdGhlcmUgaXMgYSBwZW5kaW5nIG9mZmVyLicpOwogICAgICB9CiAgICAgIHZhciBvZmZlck9wdGlvbnM7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpIHsKICAgICAgICBvZmZlck9wdGlvbnMgPSBhcmd1bWVudHNbMF07CiAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykgewogICAgICAgIG9mZmVyT3B0aW9ucyA9IGFyZ3VtZW50c1syXTsKICAgICAgfQoKICAgICAgdmFyIHRyYWNrcyA9IFtdOwogICAgICB2YXIgbnVtQXVkaW9UcmFja3MgPSAwOwogICAgICB2YXIgbnVtVmlkZW9UcmFja3MgPSAwOwogICAgICAvLyBEZWZhdWx0IHRvIHNlbmRyZWN2LgogICAgICBpZiAodGhpcy5sb2NhbFN0cmVhbXMubGVuZ3RoKSB7CiAgICAgICAgbnVtQXVkaW9UcmFja3MgPSB0aGlzLmxvY2FsU3RyZWFtc1swXS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aDsKICAgICAgICBudW1WaWRlb1RyYWNrcyA9IHRoaXMubG9jYWxTdHJlYW1zWzBdLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoOwogICAgICB9CiAgICAgIC8vIERldGVybWluZSBudW1iZXIgb2YgYXVkaW8gYW5kIHZpZGVvIHRyYWNrcyB3ZSBuZWVkIHRvIHNlbmQvcmVjdi4KICAgICAgaWYgKG9mZmVyT3B0aW9ucykgewogICAgICAgIC8vIFJlamVjdCBDaHJvbWUgbGVnYWN5IGNvbnN0cmFpbnRzLgogICAgICAgIGlmIChvZmZlck9wdGlvbnMubWFuZGF0b3J5IHx8IG9mZmVyT3B0aW9ucy5vcHRpb25hbCkgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigKICAgICAgICAgICAgICAnTGVnYWN5IG1hbmRhdG9yeS9vcHRpb25hbCBjb25zdHJhaW50cyBub3Qgc3VwcG9ydGVkLicpOwogICAgICAgIH0KICAgICAgICBpZiAob2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgbnVtQXVkaW9UcmFja3MgPSBvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbzsKICAgICAgICB9CiAgICAgICAgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzID0gb2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlVmlkZW87CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmxvY2FsU3RyZWFtcy5sZW5ndGgpIHsKICAgICAgICAvLyBQdXNoIGxvY2FsIHN0cmVhbXMuCiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXNbMF0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiB0cmFjay5raW5kLAogICAgICAgICAgICB0cmFjazogdHJhY2ssCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cmFjay5raW5kID09PSAnYXVkaW8nID8KICAgICAgICAgICAgICAgIG51bUF1ZGlvVHJhY2tzID4gMCA6IG51bVZpZGVvVHJhY2tzID4gMAogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAodHJhY2sua2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgICAgfSBlbHNlIGlmICh0cmFjay5raW5kID09PSAndmlkZW8nKSB7CiAgICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgLy8gQ3JlYXRlIE0tbGluZXMgZm9yIHJlY3Zvbmx5IHN0cmVhbXMuCiAgICAgIHdoaWxlIChudW1BdWRpb1RyYWNrcyA+IDAgfHwgbnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgaWYgKG51bUF1ZGlvVHJhY2tzID4gMCkgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiAnYXVkaW8nLAogICAgICAgICAgICB3YW50UmVjZWl2ZTogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgIH0KICAgICAgICBpZiAobnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgICB0cmFja3MucHVzaCh7CiAgICAgICAgICAgIGtpbmQ6ICd2aWRlbycsCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUoKTsKICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IFtdOwogICAgICB0cmFja3MuZm9yRWFjaChmdW5jdGlvbihtbGluZSwgc2RwTUxpbmVJbmRleCkgewogICAgICAgIC8vIEZvciBlYWNoIHRyYWNrLCBjcmVhdGUgYW4gaWNlIGdhdGhlcmVyLCBpY2UgdHJhbnNwb3J0LAogICAgICAgIC8vIGR0bHMgdHJhbnNwb3J0LCBwb3RlbnRpYWxseSBydHBzZW5kZXIgYW5kIHJ0cHJlY2VpdmVyLgogICAgICAgIHZhciB0cmFjayA9IG1saW5lLnRyYWNrOwogICAgICAgIHZhciBraW5kID0gbWxpbmUua2luZDsKICAgICAgICB2YXIgbWlkID0gU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyKCk7CgogICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc2NlaXZlcnNbMF0uaWNlR2F0aGVyZXIsCiAgICAgICAgICBpY2VUcmFuc3BvcnQ6IHRyYW5zY2VpdmVyc1swXS5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBTZW5kZXIuZ2V0Q2FwYWJpbGl0aWVzKGtpbmQpOwogICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgfSk7CiAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgICAgICAgIC8vIHdvcmsgYXJvdW5kIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD02NTUyCiAgICAgICAgICAvLyBieSBhZGRpbmcgbGV2ZWwtYXN5bW1ldHJ5LWFsbG93ZWQ9MQogICAgICAgICAgaWYgKGNvZGVjLm5hbWUgPT09ICdIMjY0JyAmJgogICAgICAgICAgICAgIGNvZGVjLnBhcmFtZXRlcnNbJ2xldmVsLWFzeW1tZXRyeS1hbGxvd2VkJ10gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb2RlYy5wYXJhbWV0ZXJzWydsZXZlbC1hc3ltbWV0cnktYWxsb3dlZCddID0gJzEnOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICB2YXIgcnRwU2VuZGVyOwogICAgICAgIHZhciBydHBSZWNlaXZlcjsKCiAgICAgICAgLy8gZ2VuZXJhdGUgYW4gc3NyYyBub3csIHRvIGJlIHVzZWQgbGF0ZXIgaW4gcnRwU2VuZGVyLnNlbmQKICAgICAgICB2YXIgc2VuZEVuY29kaW5nUGFyYW1ldGVycyA9IFt7CiAgICAgICAgICBzc3JjOiAoMiAqIHNkcE1MaW5lSW5kZXggKyAxKSAqIDEwMDEKICAgICAgICB9XTsKICAgICAgICBpZiAodHJhY2spIHsKICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIodHJhY2ssIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgfQoKICAgICAgICBpZiAobWxpbmUud2FudFJlY2VpdmUpIHsKICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CiAgICAgICAgfQoKICAgICAgICB0cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0gPSB7CiAgICAgICAgICBpY2VHYXRoZXJlcjogdHJhbnNwb3J0cy5pY2VHYXRoZXJlciwKICAgICAgICAgIGljZVRyYW5zcG9ydDogdHJhbnNwb3J0cy5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmR0bHNUcmFuc3BvcnQsCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllczogbG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM6IG51bGwsCiAgICAgICAgICBydHBTZW5kZXI6IHJ0cFNlbmRlciwKICAgICAgICAgIHJ0cFJlY2VpdmVyOiBydHBSZWNlaXZlciwKICAgICAgICAgIGtpbmQ6IGtpbmQsCiAgICAgICAgICBtaWQ6IG1pZCwKICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM6IHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMsCiAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOiBudWxsCiAgICAgICAgfTsKICAgICAgfSk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdHJhbnNjZWl2ZXJzLm1hcChmdW5jdGlvbih0KSB7CiAgICAgICAgICByZXR1cm4gdC5taWQ7CiAgICAgICAgfSkuam9pbignICcpICsgJ1xyXG4nOwogICAgICB9CiAgICAgIHRyYWNrcy5mb3JFYWNoKGZ1bmN0aW9uKG1saW5lLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgdmFyIHRyYW5zY2VpdmVyID0gdHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsICdvZmZlcicsIHNlbGYubG9jYWxTdHJlYW1zWzBdKTsKICAgICAgfSk7CgogICAgICB0aGlzLl9wZW5kaW5nT2ZmZXIgPSB0cmFuc2NlaXZlcnM7CiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ29mZmVyJywKICAgICAgICBzZHA6IHNkcAogICAgICB9KTsKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGFyZ3VtZW50c1swXSwgMCwgZGVzYyk7CiAgICAgIH0KICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZXNjKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVBbnN3ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlU2Vzc2lvbkJvaWxlcnBsYXRlKCk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdGhpcy50cmFuc2NlaXZlcnMubWFwKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgIHJldHVybiB0Lm1pZDsKICAgICAgICB9KS5qb2luKCcgJykgKyAnXHJcbic7CiAgICAgIH0KICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIGlmICh0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICBzZHAgKz0gJ209YXBwbGljYXRpb24gMCBEVExTL1NDVFAgNTAwMFxyXG4nICsKICAgICAgICAgICAgICAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nICsKICAgICAgICAgICAgICAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gQ2FsY3VsYXRlIGludGVyc2VjdGlvbiBvZiBjYXBhYmlsaXRpZXMuCiAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHNlbGYuX2dldENvbW1vbkNhcGFiaWxpdGllcygKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgIHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcyk7CgogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwgY29tbW9uQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAnYW5zd2VyJywgc2VsZi5sb2NhbFN0cmVhbXNbMF0pOwogICAgICB9KTsKCiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ2Fuc3dlcicsCiAgICAgICAgc2RwOiBzZHAKICAgICAgfSk7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMF0sIDAsIGRlc2MpOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGVzYyk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oY2FuZGlkYXRlKSB7CiAgICAgIGlmICghY2FuZGlkYXRlKSB7CiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnRyYW5zY2VpdmVycy5sZW5ndGg7IGorKykgewogICAgICAgICAgdGhpcy50cmFuc2NlaXZlcnNbal0uaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZSh7fSk7CiAgICAgICAgICBpZiAodGhpcy51c2luZ0J1bmRsZSkgewogICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBtTGluZUluZGV4ID0gY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXg7CiAgICAgICAgaWYgKGNhbmRpZGF0ZS5zZHBNaWQpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFuc2NlaXZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNjZWl2ZXJzW2ldLm1pZCA9PT0gY2FuZGlkYXRlLnNkcE1pZCkgewogICAgICAgICAgICAgIG1MaW5lSW5kZXggPSBpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHRoaXMudHJhbnNjZWl2ZXJzW21MaW5lSW5kZXhdOwogICAgICAgIGlmICh0cmFuc2NlaXZlcikgewogICAgICAgICAgdmFyIGNhbmQgPSBPYmplY3Qua2V5cyhjYW5kaWRhdGUuY2FuZGlkYXRlKS5sZW5ndGggPiAwID8KICAgICAgICAgICAgICBTRFBVdGlscy5wYXJzZUNhbmRpZGF0ZShjYW5kaWRhdGUuY2FuZGlkYXRlKSA6IHt9OwogICAgICAgICAgLy8gSWdub3JlIENocm9tZSdzIGludmFsaWQgY2FuZGlkYXRlcyBzaW5jZSBFZGdlIGRvZXMgbm90IGxpa2UgdGhlbS4KICAgICAgICAgIGlmIChjYW5kLnByb3RvY29sID09PSAndGNwJyAmJiAoY2FuZC5wb3J0ID09PSAwIHx8IGNhbmQucG9ydCA9PT0gOSkpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgLy8gSWdub3JlIFJUQ1AgY2FuZGlkYXRlcywgd2UgYXNzdW1lIFJUQ1AtTVVYLgogICAgICAgICAgaWYgKGNhbmQuY29tcG9uZW50ICE9PSAnMScpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZShjYW5kKTsKCiAgICAgICAgICAvLyB1cGRhdGUgdGhlIHJlbW90ZURlc2NyaXB0aW9uLgogICAgICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyh0aGlzLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICBzZWN0aW9uc1ttTGluZUluZGV4ICsgMV0gKz0gKGNhbmQudHlwZSA/IGNhbmRpZGF0ZS5jYW5kaWRhdGUudHJpbSgpCiAgICAgICAgICAgICAgOiAnYT1lbmQtb2YtY2FuZGlkYXRlcycpICsgJ1xyXG4nOwogICAgICAgICAgdGhpcy5yZW1vdGVEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMV0sIDApOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcHJvbWlzZXMgPSBbXTsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIFsncnRwU2VuZGVyJywgJ3J0cFJlY2VpdmVyJywgJ2ljZUdhdGhlcmVyJywgJ2ljZVRyYW5zcG9ydCcsCiAgICAgICAgICAgICdkdGxzVHJhbnNwb3J0J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgICBpZiAodHJhbnNjZWl2ZXJbbWV0aG9kXSkgewogICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0cmFuc2NlaXZlclttZXRob2RdLmdldFN0YXRzKCkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB2YXIgY2IgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnZnVuY3Rpb24nICYmCiAgICAgICAgICBhcmd1bWVudHNbMV07CiAgICAgIHZhciBmaXhTdGF0c1R5cGUgPSBmdW5jdGlvbihzdGF0KSB7CiAgICAgICAgc3RhdC50eXBlID0gewogICAgICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgICAgIG91dGJvdW5kcnRwOiAnb3V0Ym91bmQtcnRwJywKICAgICAgICAgIGNhbmRpZGF0ZXBhaXI6ICdjYW5kaWRhdGUtcGFpcicsCiAgICAgICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgIH1bc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgcmV0dXJuIHN0YXQ7CiAgICAgIH07CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICAgIHZhciByZXN1bHRzID0gbmV3IE1hcCgpOwogICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKHJlcykgewogICAgICAgICAgcmVzLmZvckVhY2goZnVuY3Rpb24ocmVzdWx0KSB7CiAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlc3VsdCkuZm9yRWFjaChmdW5jdGlvbihpZCkgewogICAgICAgICAgICAgIHJlc3VsdFtpZF0udHlwZSA9IGZpeFN0YXRzVHlwZShyZXN1bHRbaWRdKTsKICAgICAgICAgICAgICByZXN1bHRzLnNldChpZCwgcmVzdWx0W2lkXSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoY2IpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoY2IsIDAsIHJlc3VsdHMpOwogICAgICAgICAgfQogICAgICAgICAgcmVzb2x2ZShyZXN1bHRzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KfTsKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbVBlZXJDb25uZWN0aW9uOiBlZGdlU2hpbS5zaGltUGVlckNvbm5lY3Rpb24sCiAgc2hpbUdldFVzZXJNZWRpYTogcmVxdWlyZSgnLi9nZXR1c2VybWVkaWEnKQp9OwoKfSx7Ii4uL3V0aWxzIjoxMSwiLi9nZXR1c2VybWVkaWEiOjcsInNkcCI6MX1dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7UGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJ31bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50LAogICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTsKICAgICAgfQogICAgfTsKICB9OwoKICAvLyBnZXRVc2VyTWVkaWEgZXJyb3Igc2hpbS4KICB2YXIgb3JpZ0dldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhLgogICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oYykgewogICAgcmV0dXJuIG9yaWdHZXRVc2VyTWVkaWEoYykuY2F0Y2goZnVuY3Rpb24oZSkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3Qoc2hpbUVycm9yXyhlKSk7CiAgICB9KTsKICB9Owp9OwoKfSx7fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgZmlyZWZveFNoaW0gPSB7CiAgc2hpbU9uVHJhY2s6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnICYmIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiAmJiAhKCdvbnRyYWNrJyBpbgogICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnb250cmFjaycsIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX29udHJhY2s7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKGYpIHsKICAgICAgICAgIGlmICh0aGlzLl9vbnRyYWNrKSB7CiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrKTsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgdGhpcy5fb250cmFjayA9IGYpOwogICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgZS5zdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTsKICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAoKICBzaGltU291cmNlT2JqZWN0OiBmdW5jdGlvbigpIHsKICAgIC8vIEZpcmVmb3ggaGFzIHN1cHBvcnRlZCBtb3pTcmNPYmplY3Qgc2luY2UgRkYyMiwgdW5wcmVmaXhlZCBpbiA0Mi4KICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgewogICAgICBpZiAod2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAhKCdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgICAvLyBTaGltIHRoZSBzcmNPYmplY3QgcHJvcGVydHksIG9uY2UsIHdoZW4gSFRNTE1lZGlhRWxlbWVudCBpcyBmb3VuZC4KICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLCAnc3JjT2JqZWN0JywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMubW96U3JjT2JqZWN0OwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgICAgIHRoaXMubW96U3JjT2JqZWN0ID0gc3RyZWFtOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAnb2JqZWN0JyB8fCAhKHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiB8fAogICAgICAgIHdpbmRvdy5tb3pSVENQZWVyQ29ubmVjdGlvbikpIHsKICAgICAgcmV0dXJuOyAvLyBwcm9iYWJseSBtZWRpYS5wZWVyY29ubmVjdGlvbi5lbmFibGVkPWZhbHNlIGluIGFib3V0OmNvbmZpZwogICAgfQogICAgLy8gVGhlIFJUQ1BlZXJDb25uZWN0aW9uIG9iamVjdC4KICAgIGlmICghd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uKSB7CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiA9IGZ1bmN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKSB7CiAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICAgICAgLy8gLnVybHMgaXMgbm90IHN1cHBvcnRlZCBpbiBGRiA8IDM4LgogICAgICAgICAgLy8gY3JlYXRlIFJUQ0ljZVNlcnZlcnMgd2l0aCBhIHNpbmdsZSB1cmwuCiAgICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlU2VydmVycykgewogICAgICAgICAgICB2YXIgbmV3SWNlU2VydmVycyA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBjQ29uZmlnLmljZVNlcnZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICB2YXIgc2VydmVyID0gcGNDb25maWcuaWNlU2VydmVyc1tpXTsKICAgICAgICAgICAgICBpZiAoc2VydmVyLmhhc093blByb3BlcnR5KCd1cmxzJykpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VydmVyLnVybHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgdmFyIG5ld1NlcnZlciA9IHsKICAgICAgICAgICAgICAgICAgICB1cmw6IHNlcnZlci51cmxzW2pdCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIGlmIChzZXJ2ZXIudXJsc1tqXS5pbmRleE9mKCd0dXJuJykgPT09IDApIHsKICAgICAgICAgICAgICAgICAgICBuZXdTZXJ2ZXIudXNlcm5hbWUgPSBzZXJ2ZXIudXNlcm5hbWU7CiAgICAgICAgICAgICAgICAgICAgbmV3U2VydmVyLmNyZWRlbnRpYWwgPSBzZXJ2ZXIuY3JlZGVudGlhbDsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBuZXdJY2VTZXJ2ZXJzLnB1c2gobmV3U2VydmVyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV3SWNlU2VydmVycy5wdXNoKHBjQ29uZmlnLmljZVNlcnZlcnNbaV0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBwY0NvbmZpZy5pY2VTZXJ2ZXJzID0gbmV3SWNlU2VydmVyczsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBtb3pSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSBtb3pSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CgogICAgICAvLyB3cmFwIHN0YXRpYyBtZXRob2RzLiBDdXJyZW50bHkganVzdCBnZW5lcmF0ZUNlcnRpZmljYXRlLgogICAgICBpZiAobW96UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24sICdnZW5lcmF0ZUNlcnRpZmljYXRlJywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIG1velJUQ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24gPSBtb3pSVENTZXNzaW9uRGVzY3JpcHRpb247CiAgICAgIHdpbmRvdy5SVENJY2VDYW5kaWRhdGUgPSBtb3pSVENJY2VDYW5kaWRhdGU7CiAgICB9CgogICAgLy8gc2hpbSBhd2F5IG5lZWQgZm9yIG9ic29sZXRlIFJUQ0ljZUNhbmRpZGF0ZS9SVENTZXNzaW9uRGVzY3JpcHRpb24uCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgdmFyIG1ha2VNYXBTdGF0cyA9IGZ1bmN0aW9uKHN0YXRzKSB7CiAgICAgIHZhciBtYXAgPSBuZXcgTWFwKCk7CiAgICAgIE9iamVjdC5rZXlzKHN0YXRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIG1hcC5zZXQoa2V5LCBzdGF0c1trZXldKTsKICAgICAgICBtYXBba2V5XSA9IHN0YXRzW2tleV07CiAgICAgIH0pOwogICAgICByZXR1cm4gbWFwOwogICAgfTsKCiAgICB2YXIgbW9kZXJuU3RhdHNUeXBlcyA9IHsKICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgb3V0Ym91bmRydHA6ICdvdXRib3VuZC1ydHAnLAogICAgICBjYW5kaWRhdGVwYWlyOiAnY2FuZGlkYXRlLXBhaXInLAogICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgIHJlbW90ZWNhbmRpZGF0ZTogJ3JlbW90ZS1jYW5kaWRhdGUnCiAgICB9OwoKICAgIHZhciBuYXRpdmVHZXRTdGF0cyA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0czsKICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBvblN1Y2MsIG9uRXJyKSB7CiAgICAgIHJldHVybiBuYXRpdmVHZXRTdGF0cy5hcHBseSh0aGlzLCBbc2VsZWN0b3IgfHwgbnVsbF0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNDgpIHsKICAgICAgICAgICAgc3RhdHMgPSBtYWtlTWFwU3RhdHMoc3RhdHMpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MyAmJiAhb25TdWNjKSB7CiAgICAgICAgICAgIC8vIFNoaW0gb25seSBwcm9taXNlIGdldFN0YXRzIHdpdGggc3BlYy1oeXBoZW5zIGluIHR5cGUgbmFtZXMKICAgICAgICAgICAgLy8gTGVhdmUgY2FsbGJhY2sgdmVyc2lvbiBhbG9uZTsgbWlzYyBvbGQgdXNlcyBvZiBmb3JFYWNoIGJlZm9yZSBNYXAKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBzdGF0cy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXQpIHsKICAgICAgICAgICAgICAgIHN0YXQudHlwZSA9IG1vZGVyblN0YXRzVHlwZXNbc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICBpZiAoZS5uYW1lICE9PSAnVHlwZUVycm9yJykgewogICAgICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gQXZvaWQgVHlwZUVycm9yOiAidHlwZSIgaXMgcmVhZC1vbmx5LCBpbiBvbGQgdmVyc2lvbnMuIDM0LTQzaXNoCiAgICAgICAgICAgICAgc3RhdHMuZm9yRWFjaChmdW5jdGlvbihzdGF0LCBpKSB7CiAgICAgICAgICAgICAgICBzdGF0cy5zZXQoaSwgT2JqZWN0LmFzc2lnbih7fSwgc3RhdCwgewogICAgICAgICAgICAgICAgICB0eXBlOiBtb2Rlcm5TdGF0c1R5cGVzW3N0YXQudHlwZV0gfHwgc3RhdC50eXBlCiAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBzdGF0czsKICAgICAgICB9KQogICAgICAgIC50aGVuKG9uU3VjYywgb25FcnIpOwogICAgfTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1PblRyYWNrOiBmaXJlZm94U2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBmaXJlZm94U2hpbS5zaGltU291cmNlT2JqZWN0LAogIHNoaW1QZWVyQ29ubmVjdGlvbjogZmlyZWZveFNoaW0uc2hpbVBlZXJDb25uZWN0aW9uLAogIHNoaW1HZXRVc2VyTWVkaWE6IHJlcXVpcmUoJy4vZ2V0dXNlcm1lZGlhJykKfTsKCn0seyIuLi91dGlscyI6MTEsIi4vZ2V0dXNlcm1lZGlhIjo5fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7CiAgICAgICAgU2VjdXJpdHlFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgUGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJwogICAgICB9W2UubmFtZV0gfHwgZS5uYW1lLAogICAgICBtZXNzYWdlOiB7CiAgICAgICAgJ1RoZSBvcGVyYXRpb24gaXMgaW5zZWN1cmUuJzogJ1RoZSByZXF1ZXN0IGlzIG5vdCBhbGxvd2VkIGJ5IHRoZSAnICsKICAgICAgICAndXNlciBhZ2VudCBvciB0aGUgcGxhdGZvcm0gaW4gdGhlIGN1cnJlbnQgY29udGV4dC4nCiAgICAgIH1bZS5tZXNzYWdlXSB8fCBlLm1lc3NhZ2UsCiAgICAgIGNvbnN0cmFpbnQ6IGUuY29uc3RyYWludCwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIC8vIGdldFVzZXJNZWRpYSBjb25zdHJhaW50cyBzaGltLgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgdmFyIGNvbnN0cmFpbnRzVG9GRjM3XyA9IGZ1bmN0aW9uKGMpIHsKICAgICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLnJlcXVpcmUpIHsKICAgICAgICByZXR1cm4gYzsKICAgICAgfQogICAgICB2YXIgcmVxdWlyZSA9IFtdOwogICAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIGlmIChrZXkgPT09ICdyZXF1aXJlJyB8fCBrZXkgPT09ICdhZHZhbmNlZCcgfHwga2V5ID09PSAnbWVkaWFTb3VyY2UnKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciByID0gY1trZXldID0gKHR5cGVvZiBjW2tleV0gPT09ICdvYmplY3QnKSA/CiAgICAgICAgICAgIGNba2V5XSA6IHtpZGVhbDogY1trZXldfTsKICAgICAgICBpZiAoci5taW4gIT09IHVuZGVmaW5lZCB8fAogICAgICAgICAgICByLm1heCAhPT0gdW5kZWZpbmVkIHx8IHIuZXhhY3QgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmVxdWlyZS5wdXNoKGtleSk7CiAgICAgICAgfQogICAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmICh0eXBlb2Ygci5leGFjdCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgci4gbWluID0gci5tYXggPSByLmV4YWN0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY1trZXldID0gci5leGFjdDsKICAgICAgICAgIH0KICAgICAgICAgIGRlbGV0ZSByLmV4YWN0OwogICAgICAgIH0KICAgICAgICBpZiAoci5pZGVhbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBjLmFkdmFuY2VkID0gYy5hZHZhbmNlZCB8fCBbXTsKICAgICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgICAgaWYgKHR5cGVvZiByLmlkZWFsID09PSAnbnVtYmVyJykgewogICAgICAgICAgICBvY1trZXldID0ge21pbjogci5pZGVhbCwgbWF4OiByLmlkZWFsfTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9jW2tleV0gPSByLmlkZWFsOwogICAgICAgICAgfQogICAgICAgICAgYy5hZHZhbmNlZC5wdXNoKG9jKTsKICAgICAgICAgIGRlbGV0ZSByLmlkZWFsOwogICAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhyKS5sZW5ndGgpIHsKICAgICAgICAgICAgZGVsZXRlIGNba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAocmVxdWlyZS5sZW5ndGgpIHsKICAgICAgICBjLnJlcXVpcmUgPSByZXF1aXJlOwogICAgICB9CiAgICAgIHJldHVybiBjOwogICAgfTsKICAgIGNvbnN0cmFpbnRzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICBsb2dnaW5nKCdzcGVjOiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgICAgaWYgKGNvbnN0cmFpbnRzLmF1ZGlvKSB7CiAgICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvRkYzN18oY29uc3RyYWludHMuYXVkaW8pOwogICAgICB9CiAgICAgIGlmIChjb25zdHJhaW50cy52aWRlbykgewogICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0ZGMzdfKGNvbnN0cmFpbnRzLnZpZGVvKTsKICAgICAgfQogICAgICBsb2dnaW5nKCdmZjM3OiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgIH0KICAgIHJldHVybiBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzLCBvblN1Y2Nlc3MsIGZ1bmN0aW9uKGUpIHsKICAgICAgb25FcnJvcihzaGltRXJyb3JfKGUpKTsKICAgIH0pOwogIH07CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGdldFVzZXJNZWRpYV8oY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICAvLyBTaGltIGZvciBtZWRpYURldmljZXMgb24gb2xkZXIgdmVyc2lvbnMuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKSB7CiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzID0ge2dldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKCkgeyB9LAogICAgICByZW1vdmVFdmVudExpc3RlbmVyOiBmdW5jdGlvbigpIHsgfQogICAgfTsKICB9CiAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzID0KICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzIHx8IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIgaW5mb3MgPSBbCiAgICAgICAgICAgIHtraW5kOiAnYXVkaW9pbnB1dCcsIGRldmljZUlkOiAnZGVmYXVsdCcsIGxhYmVsOiAnJywgZ3JvdXBJZDogJyd9LAogICAgICAgICAgICB7a2luZDogJ3ZpZGVvaW5wdXQnLCBkZXZpY2VJZDogJ2RlZmF1bHQnLCBsYWJlbDogJycsIGdyb3VwSWQ6ICcnfQogICAgICAgICAgXTsKICAgICAgICAgIHJlc29sdmUoaW5mb3MpOwogICAgICAgIH0pOwogICAgICB9OwoKICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDQxKSB7CiAgICAvLyBXb3JrIGFyb3VuZCBodHRwOi8vYnVnemlsLmxhLzExNjk2NjUKICAgIHZhciBvcmdFbnVtZXJhdGVEZXZpY2VzID0KICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMuYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gb3JnRW51bWVyYXRlRGV2aWNlcygpLnRoZW4odW5kZWZpbmVkLCBmdW5jdGlvbihlKSB7CiAgICAgICAgaWYgKGUubmFtZSA9PT0gJ05vdEZvdW5kRXJyb3InKSB7CiAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgfQogICAgICAgIHRocm93IGU7CiAgICAgIH0pOwogICAgfTsKICB9CiAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0OSkgewogICAgdmFyIG9yaWdHZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYS4KICAgICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjKSB7CiAgICAgIHJldHVybiBvcmlnR2V0VXNlck1lZGlhKGMpLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgLy8gV29yayBhcm91bmQgaHR0cHM6Ly9idWd6aWwubGEvODAyMzI2CiAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICBjLnZpZGVvICYmICFzdHJlYW0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7CiAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgIH0pOwogICAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignVGhlIG9iamVjdCBjYW4gbm90IGJlIGZvdW5kIGhlcmUuJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ05vdEZvdW5kRXJyb3InKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cmVhbTsKICAgICAgfSwgZnVuY3Rpb24oZSkgewogICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgfSk7CiAgICB9OwogIH0KICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0NCkgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhXyhjb25zdHJhaW50cywgb25TdWNjZXNzLCBvbkVycm9yKTsKICAgIH0KICAgIC8vIFJlcGxhY2UgRmlyZWZveCA0NCsncyBkZXByZWNhdGlvbiB3YXJuaW5nIHdpdGggdW5wcmVmaXhlZCB2ZXJzaW9uLgogICAgY29uc29sZS53YXJuKCduYXZpZ2F0b3IuZ2V0VXNlck1lZGlhIGhhcyBiZWVuIHJlcGxhY2VkIGJ5ICcgKwogICAgICAgICAgICAgICAgICduYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYScpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTsKICB9Owp9OwoKfSx7Ii4uL3V0aWxzIjoxMX1dLDEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLyoKICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICoKICogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlIGxpY2Vuc2UKICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZQogKiAgdHJlZS4KICovCid1c2Ugc3RyaWN0JzsKdmFyIHNhZmFyaVNoaW0gPSB7CiAgLy8gVE9ETzogRHJBbGV4LCBzaG91bGQgYmUgaGVyZSwgZG91YmxlIGNoZWNrIGFnYWluc3QgTGF5b3V0VGVzdHMKICAvLyBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7IH0sCgogIC8vIFRPRE86IG9uY2UgdGhlIGJhY2stZW5kIGZvciB0aGUgbWFjIHBvcnQgaXMgZG9uZSwgYWRkLgogIC8vIFRPRE86IGNoZWNrIGZvciB3ZWJraXRHVEsrCiAgLy8gc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsgfSwKCiAgc2hpbUdldFVzZXJNZWRpYTogZnVuY3Rpb24oKSB7CiAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1HZXRVc2VyTWVkaWE6IHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYQogIC8vIFRPRE8KICAvLyBzaGltT25UcmFjazogc2FmYXJpU2hpbS5zaGltT25UcmFjaywKICAvLyBzaGltUGVlckNvbm5lY3Rpb246IHNhZmFyaVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uCn07Cgp9LHt9XSwxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dEaXNhYmxlZF8gPSB0cnVlOwoKLy8gVXRpbGl0eSBtZXRob2RzLgp2YXIgdXRpbHMgPSB7CiAgZGlzYWJsZUxvZzogZnVuY3Rpb24oYm9vbCkgewogICAgaWYgKHR5cGVvZiBib29sICE9PSAnYm9vbGVhbicpIHsKICAgICAgcmV0dXJuIG5ldyBFcnJvcignQXJndW1lbnQgdHlwZTogJyArIHR5cGVvZiBib29sICsKICAgICAgICAgICcuIFBsZWFzZSB1c2UgYSBib29sZWFuLicpOwogICAgfQogICAgbG9nRGlzYWJsZWRfID0gYm9vbDsKICAgIHJldHVybiAoYm9vbCkgPyAnYWRhcHRlci5qcyBsb2dnaW5nIGRpc2FibGVkJyA6CiAgICAgICAgJ2FkYXB0ZXIuanMgbG9nZ2luZyBlbmFibGVkJzsKICB9LAoKICBsb2c6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSB7CiAgICAgIGlmIChsb2dEaXNhYmxlZF8pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5sb2cgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLyoqCiAgICogRXh0cmFjdCBicm93c2VyIHZlcnNpb24gb3V0IG9mIHRoZSBwcm92aWRlZCB1c2VyIGFnZW50IHN0cmluZy4KICAgKgogICAqIEBwYXJhbSB7IXN0cmluZ30gdWFzdHJpbmcgdXNlckFnZW50IHN0cmluZy4KICAgKiBAcGFyYW0geyFzdHJpbmd9IGV4cHIgUmVndWxhciBleHByZXNzaW9uIHVzZWQgYXMgbWF0Y2ggY3JpdGVyaWEuCiAgICogQHBhcmFtIHshbnVtYmVyfSBwb3MgcG9zaXRpb24gaW4gdGhlIHZlcnNpb24gc3RyaW5nIHRvIGJlIHJldHVybmVkLgogICAqIEByZXR1cm4geyFudW1iZXJ9IGJyb3dzZXIgdmVyc2lvbi4KICAgKi8KICBleHRyYWN0VmVyc2lvbjogZnVuY3Rpb24odWFzdHJpbmcsIGV4cHIsIHBvcykgewogICAgdmFyIG1hdGNoID0gdWFzdHJpbmcubWF0Y2goZXhwcik7CiAgICByZXR1cm4gbWF0Y2ggJiYgbWF0Y2gubGVuZ3RoID49IHBvcyAmJiBwYXJzZUludChtYXRjaFtwb3NdLCAxMCk7CiAgfSwKCiAgLyoqCiAgICogQnJvd3NlciBkZXRlY3Rvci4KICAgKgogICAqIEByZXR1cm4ge29iamVjdH0gcmVzdWx0IGNvbnRhaW5pbmcgYnJvd3NlciBhbmQgdmVyc2lvbgogICAqICAgICBwcm9wZXJ0aWVzLgogICAqLwogIGRldGVjdEJyb3dzZXI6IGZ1bmN0aW9uKCkgewogICAgLy8gUmV0dXJuZWQgcmVzdWx0IG9iamVjdC4KICAgIHZhciByZXN1bHQgPSB7fTsKICAgIHJlc3VsdC5icm93c2VyID0gbnVsbDsKICAgIHJlc3VsdC52ZXJzaW9uID0gbnVsbDsKCiAgICAvLyBGYWlsIGVhcmx5IGlmIGl0J3Mgbm90IGEgYnJvd3NlcgogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8ICF3aW5kb3cubmF2aWdhdG9yKSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIGJyb3dzZXIuJzsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvLyBGaXJlZm94LgogICAgaWYgKG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEpIHsKICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnZmlyZWZveCc7CiAgICAgIHJlc3VsdC52ZXJzaW9uID0gdGhpcy5leHRyYWN0VmVyc2lvbihuYXZpZ2F0b3IudXNlckFnZW50LAogICAgICAgICAgL0ZpcmVmb3hcLyhbMC05XSspXC4vLCAxKTsKCiAgICAvLyBhbGwgd2Via2l0LWJhc2VkIGJyb3dzZXJzCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEpIHsKICAgICAgLy8gQ2hyb21lLCBDaHJvbWl1bSwgV2VidmlldywgT3BlcmEsIGFsbCB1c2UgdGhlIGNocm9tZSBzaGltIGZvciBub3cKICAgICAgaWYgKHdpbmRvdy53ZWJraXRSVENQZWVyQ29ubmVjdGlvbikgewogICAgICAgIHJlc3VsdC5icm93c2VyID0gJ2Nocm9tZSc7CiAgICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvQ2hyb20oZXxpdW0pXC8oWzAtOV0rKVwuLywgMik7CgogICAgICAvLyBTYWZhcmkgb3IgdW5rbm93biB3ZWJraXQtYmFzZWQKICAgICAgLy8gZm9yIHRoZSB0aW1lIGJlaW5nIFNhZmFyaSBoYXMgc3VwcG9ydCBmb3IgTWVkaWFTdHJlYW1zIGJ1dCBub3Qgd2ViUlRDCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gU2FmYXJpIFVBIHN1YnN0cmluZ3Mgb2YgaW50ZXJlc3QgZm9yIHJlZmVyZW5jZToKICAgICAgICAvLyAtIHdlYmtpdCB2ZXJzaW9uOiAgICAgICAgICAgQXBwbGVXZWJLaXQvNjAyLjEuMjUgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLyAtIHNhZmFyaSBVSSB2ZXJzaW9uOiAgICAgICAgVmVyc2lvbi85LjAuMyAodW5pcXVlIHRvIFNhZmFyaSkKICAgICAgICAvLyAtIHNhZmFyaSBVSSB3ZWJraXQgdmVyc2lvbjogU2FmYXJpLzYwMS40LjQgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLwogICAgICAgIC8vIGlmIHRoZSB3ZWJraXQgdmVyc2lvbiBhbmQgc2FmYXJpIFVJIHdlYmtpdCB2ZXJzaW9ucyBhcmUgZXF1YWxzLAogICAgICAgIC8vIC4uLiB0aGlzIGlzIGEgc3RhYmxlIHZlcnNpb24uCiAgICAgICAgLy8KICAgICAgICAvLyBvbmx5IHRoZSBpbnRlcm5hbCB3ZWJraXQgdmVyc2lvbiBpcyBpbXBvcnRhbnQgdG9kYXkgdG8ga25vdyBpZgogICAgICAgIC8vIG1lZGlhIHN0cmVhbXMgYXJlIHN1cHBvcnRlZAogICAgICAgIC8vCiAgICAgICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1ZlcnNpb25cLyhcZCspLihcZCspLykpIHsKICAgICAgICAgIHJlc3VsdC5icm93c2VyID0gJ3NhZmFyaSc7CiAgICAgICAgICByZXN1bHQudmVyc2lvbiA9IHRoaXMuZXh0cmFjdFZlcnNpb24obmF2aWdhdG9yLnVzZXJBZ2VudCwKICAgICAgICAgICAgL0FwcGxlV2ViS2l0XC8oWzAtOV0rKVwuLywgMSk7CgogICAgICAgIC8vIHVua25vd24gd2Via2l0LWJhc2VkIGJyb3dzZXIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnVW5zdXBwb3J0ZWQgd2Via2l0LWJhc2VkIGJyb3dzZXIgJyArCiAgICAgICAgICAgICAgJ3dpdGggR1VNIHN1cHBvcnQgYnV0IG5vIFdlYlJUQyBzdXBwb3J0Lic7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgICAgfQoKICAgIC8vIEVkZ2UuCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMgJiYKICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9FZGdlXC8oXGQrKS4oXGQrKSQvKSkgewogICAgICByZXN1bHQuYnJvd3NlciA9ICdlZGdlJzsKICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvRWRnZVwvKFxkKykuKFxkKykkLywgMik7CgogICAgLy8gRGVmYXVsdCBmYWxsdGhyb3VnaDogbm90IHN1cHBvcnRlZC4KICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIHN1cHBvcnRlZCBicm93c2VyLic7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9LAoKICAvLyBzaGltQ3JlYXRlT2JqZWN0VVJMIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBzaGltU291cmNlT2JqZWN0IHRvIGF2b2lkIGxvb3AuCgogIHNoaW1DcmVhdGVPYmplY3RVUkw6IGZ1bmN0aW9uKCkgewogICAgaWYgKCEodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAgICdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgLy8gT25seSBzaGltIENyZWF0ZU9iamVjdFVSTCB1c2luZyBzcmNPYmplY3QgaWYgc3JjT2JqZWN0IGV4aXN0cy4KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICB2YXIgbmF0aXZlQ3JlYXRlT2JqZWN0VVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgbmF0aXZlUmV2b2tlT2JqZWN0VVJMID0gVVJMLnJldm9rZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgc3RyZWFtcyA9IG5ldyBNYXAoKSwgbmV3SWQgPSAwOwoKICAgIFVSTC5jcmVhdGVPYmplY3RVUkwgPSBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgaWYgKCdnZXRUcmFja3MnIGluIHN0cmVhbSkgewogICAgICAgIHZhciB1cmwgPSAncG9seWJsb2I6JyArICgrK25ld0lkKTsKICAgICAgICBzdHJlYW1zLnNldCh1cmwsIHN0cmVhbSk7CiAgICAgICAgY29uc29sZS5sb2coJ1VSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKSBpcyBkZXByZWNhdGVkISAnICsKICAgICAgICAgICAgICAgICAgICAnVXNlIGVsZW0uc3JjT2JqZWN0ID0gc3RyZWFtIGluc3RlYWQhJyk7CiAgICAgICAgcmV0dXJuIHVybDsKICAgICAgfQogICAgICByZXR1cm4gbmF0aXZlQ3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICB9OwogICAgVVJMLnJldm9rZU9iamVjdFVSTCA9IGZ1bmN0aW9uKHVybCkgewogICAgICBuYXRpdmVSZXZva2VPYmplY3RVUkwodXJsKTsKICAgICAgc3RyZWFtcy5kZWxldGUodXJsKTsKICAgIH07CgogICAgdmFyIGRzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NyYycpOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyYycsIHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gZHNjLmdldC5hcHBseSh0aGlzKTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbih1cmwpIHsKICAgICAgICB0aGlzLnNyY09iamVjdCA9IHN0cmVhbXMuZ2V0KHVybCkgfHwgbnVsbDsKICAgICAgICByZXR1cm4gZHNjLnNldC5hcHBseSh0aGlzLCBbdXJsXSk7CiAgICAgIH0KICAgIH0pOwogIH0KfTsKCi8vIEV4cG9ydC4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgbG9nOiB1dGlscy5sb2csCiAgZGlzYWJsZUxvZzogdXRpbHMuZGlzYWJsZUxvZywKICBicm93c2VyRGV0YWlsczogdXRpbHMuZGV0ZWN0QnJvd3NlcigpLAogIGV4dHJhY3RWZXJzaW9uOiB1dGlscy5leHRyYWN0VmVyc2lvbiwKICBzaGltQ3JlYXRlT2JqZWN0VVJMOiB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMCn07Cgp9LHt9XSwxMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCnJlcXVpcmUoJ3dlYnJ0Yy1hZGFwdGVyJyk7CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCi8qKgogIFRoZSBDb25uZWN0aW9uQ29udHJvbGxlciBoYXMgYSBnZW5lcmljIGRlc2lnbiBzbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGluIGJvdGggc3R1YnMuCiAgSXQgbWFuYWdlcyBhIHNpbmdsZSBEYXRhQ2hhbm5lbCwgaXQgaXMgbm90IHJlcXVlc3RpbmcgYWNjZXNzIHRvIG1lZGlhIGlucHV0LCBpLmUuCiAgZG9lcyBub3QgaGF2ZSBhdWRpby92aWRlbyBzdHJlYW1zLgoqKi8KdmFyIENvbm5lY3Rpb25Db250cm9sbGVyID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENvbm5lY3Rpb25Db250cm9sbGVyKG15VXJsLCBzeW5jaGVyLCBjb25maWd1cmF0aW9uLCBjYWxsZXIpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb25uZWN0aW9uQ29udHJvbGxlcik7CgogICAgaWYgKCFteVVybCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgb3duIHVybCAobXlVcmwpIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFzeW5jaGVyKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzeW5jaGVyIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFjb25maWd1cmF0aW9uKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWd1cmF0aW9uIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoKICAgIHRoaXMuX2RvbWFpbiA9IHRoaXMuX2RpdmlkZVVSTChteVVybClbImRvbWFpbiJdOwogICAgdGhpcy5fb2JqZWN0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovL2NhdGFsb2d1ZS4nICsgdGhpcy5fZG9tYWluICsgJy8ud2VsbC1rbm93bi9kYXRhc2NoZW1hL0Nvbm5lY3Rpb24nOwoKICAgIHRoaXMuX215VXJsID0gbXlVcmw7CiAgICB0aGlzLl9zeW5jaGVyID0gc3luY2hlcjsKICAgIHRoaXMuX2NvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uOwogICAgdGhpcy5fY2FsbGVyID0gY2FsbGVyOwogICAgdGhpcy5fZGF0YU9iamVjdE9ic2VydmVyOwogICAgdGhpcy5fZGF0YU9iamVjdFJlcG9ydGVyOwogICAgdGhpcy5fcGVlclVybDsKICAgIHRoaXMuX2RhdGFDaGFubmVsOwogICAgdGhpcy5fb25TdGF0dXNVcGRhdGU7CiAgICB0aGlzLl9yZW1vdGVSdW50aW1lVVJMOwoKICAgIHRoaXMuX3BlZXJDb25uZWN0aW9uID0gdGhpcy5fY3JlYXRlUGVlckNvbm5lY3Rpb24oKTsKICB9CgogIC8vY3JlYXRlIGEgcGVlciBjb25uZWN0aW9uIHdpdGggaXRzIGV2ZW50IGhhbmRsZXJzCgoKICBfY3JlYXRlQ2xhc3MoQ29ubmVjdGlvbkNvbnRyb2xsZXIsIFt7CiAgICBrZXk6ICdfY3JlYXRlUGVlckNvbm5lY3Rpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVQZWVyQ29ubmVjdGlvbigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBwYyA9IHRoaXMuX3BlZXJDb25uZWN0aW9uOwogICAgICBpZiAoIXBjKSB7CiAgICAgICAgcGMgPSBuZXcgUlRDUGVlckNvbm5lY3Rpb24odGhpcy5fY29uZmlndXJhdGlvbik7CiAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiBjcmVhdGVkIFBlZXJDb25uZWN0aW9uIik7CgogICAgICAgIC8vIGFkZCBoYW5kbGVyIGZvciBkYXRhY2hhbm5lbCBjcmVhdGlvbiBmcm9tIHBlZXIgc2lkZQogICAgICAgIHBjLm9uZGF0YWNoYW5uZWwgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogb25kYXRhY2hhbm5lbCAtPiByZW1vdGUgc2lkZSBoYXMgY3JlYXRlZCBhIGRhdGFjaGFubmVsIik7CiAgICAgICAgICBfdGhpcy5fZGF0YUNoYW5uZWwgPSBldmVudC5jaGFubmVsOwogICAgICAgICAgX3RoaXMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfTsKCiAgICAgICAgLy8gZXZlbnQgaGFuZGxlciBmb3IgbG9jYWwgaWNlIGNhbmRpZGF0ZXMKICAgICAgICBwYy5vbmljZWNhbmRpZGF0ZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IGljZWNhbmRpZGF0ZWV2ZW50IG9jY3VyZWQ6ICIsIGUpOwogICAgICAgICAgaWYgKCFlLmNhbmRpZGF0ZSkgcmV0dXJuOwogICAgICAgICAgdmFyIGljZWNhbmRpZGF0ZSA9IHsKICAgICAgICAgICAgdHlwZTogJ2NhbmRpZGF0ZScsCiAgICAgICAgICAgIGNhbmRpZGF0ZTogZS5jYW5kaWRhdGUuY2FuZGlkYXRlLAogICAgICAgICAgICBzZHBNaWQ6IGUuY2FuZGlkYXRlLnNkcE1pZCwKICAgICAgICAgICAgc2RwTUxpbmVJbmRleDogZS5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleAogICAgICAgICAgfTsKICAgICAgICAgIC8vIHNlbmQgY2FuZGlkYXRlIHRvIHJlbW90ZSBwZWVyIGJ5IHB1c2hpbmcgaXQgdG8gdGhlIHJlcG9ydGVyIG9iamVjdAogICAgICAgICAgX3RoaXMuX2RhdGFPYmplY3RSZXBvcnRlci5kYXRhLmljZUNhbmRpZGF0ZXMucHVzaChpY2VjYW5kaWRhdGUpOwogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIHBjOwogICAgfQoKICAgIC8qKgogICAgUmVhY3QgdG8gdGhlIGdpdmVuIGludml0YXRpb24gZXZlbnQgYnkgc3Vic2NyaWJpbmcgdG8gdGhlIHByb3ZpZGVkIGludml0YXRpb25FdmVudC51cmwuCiAgICAqKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb2JzZXJ2ZShpbnZpdGF0aW9uRXZlbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLl9wZWVyVXJsID0gaW52aXRhdGlvbkV2ZW50LmZyb207CiAgICAgIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwgPSBpbnZpdGF0aW9uRXZlbnQudmFsdWUucnVudGltZVVSTDsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIF90aGlzMi5fc3luY2hlci5zdWJzY3JpYmUoX3RoaXMyLl9vYmplY3REZXNjVVJMLCBpbnZpdGF0aW9uRXZlbnQudXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgICAgIGNvbnNvbGUuaW5mbygnK1tQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIGdvdCBEYXRhIE9iamVjdCBPYnNlcnZlcicsIGRhdGFPYmplY3RPYnNlcnZlcik7CiAgICAgICAgICBfdGhpczIuX3NldHVwT2JzZXJ2ZXIoZGF0YU9iamVjdE9ic2VydmVyKTsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICByZWplY3QoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICBDcmVhdGVzIGEgc3luY2hlciBvYmplY3QgYW5kIGludml0ZSB0aGUgZ2l2ZW4gcGVlclVybCB0byBzdWJzY3JpYmUgZm9yIGl0LgogICAgQWxzbyBjcmVhdGVzIHRoZSBsb2NhbCBvZmZlciwgcGVyZm9ybXMgc2V0TG9jYWxEZXNjcmlwdGlvbiBhbmQgcHVibGlzaGVzIHRoZSBvZmZlciB2aWEgdGhlIHJlcG9ydGVyIG9iamVjdC4KICAgICoqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcG9ydChwZWVyVXJsLCBvd25SdW50aW1lVXJsKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLl9wZWVyVXJsKSB0aGlzLl9wZWVyVXJsID0gcGVlclVybDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgLy8gIGlmIHdlIGFyZSB0aGUgY2FsbGVyIChpLmUuIG5vIHJlcG9ydGVyIG9iamVjdCBwcmVzZW50IHlldCwgaW5pdGFsaXplIHRoZSBjcmVhdGlvbiBvZiB0aGUgRGF0YUNoYW5uZWwpCiAgICAgICAgaWYgKF90aGlzMy5fY2FsbGVyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHdlIGFyZSBpbiBjYWxsZXIgcm9sZSAtLT4gY3JlYXRlRGF0YUNoYW5uZWwgLi4uIik7CiAgICAgICAgICBfdGhpczMuX2RhdGFDaGFubmVsID0gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVEYXRhQ2hhbm5lbCgiUDJQQ2hhbm5lbCIsIHsgcmVsaWFibGU6IGZhbHNlIH0pOwogICAgICAgICAgY29uc29sZS5sb2coIlAyUDogZGF0YWNoYW5uZWwgb2JqZWN0IiwgX3RoaXMzLl9kYXRhQ2hhbm5lbCk7CiAgICAgICAgICBfdGhpczMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBpbml0aWFsIGRhdGEgZm9yIHJlcG9ydGVyIHN5bmMgb2JqZWN0CiAgICAgICAgdmFyIGRhdGFPYmplY3QgPSB7CiAgICAgICAgICBuYW1lOiAiUDJQQ29ubmVjdGlvbiIsCiAgICAgICAgICBzdGF0dXM6ICIiLAogICAgICAgICAgb3duZXI6IF90aGlzMy5fbXlVcmwsCiAgICAgICAgICBydW50aW1lVVJMOiBvd25SdW50aW1lVXJsLCAvLyBwdXQgdGhlIG93biBydW50aW1lVVJMIHRvIHRoZSBkYXRhT2JqZWN0IChhcyBkaXNjdXNzZWQgd2l0aCBQYXVsbykKICAgICAgICAgIGNvbm5lY3Rpb25EZXNjcmlwdGlvbjoge30sCiAgICAgICAgICBpY2VDYW5kaWRhdGVzOiBbXQogICAgICAgIH07CiAgICAgICAgLy8gZW5zdXJlIHRoaXMgdGhlIG9ialJlcG9ydGVyIG9iamVjdCBpcyBjcmVhdGVkIGJlZm9yZSB3ZSBjcmVhdGUgdGhlIG9mZmVyCiAgICAgICAgX3RoaXMzLl9zeW5jaGVyLmNyZWF0ZShfdGhpczMuX29iamVjdERlc2NVUkwsIFtfdGhpczMuX3BlZXJVcmxdLCBkYXRhT2JqZWN0KS50aGVuKGZ1bmN0aW9uIChvYmpSZXBvcnRlcikgewogICAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBDcmVhdGVkIFdlYlJUQyBPYmplY3QgUmVwb3J0ZXInLCBvYmpSZXBvcnRlcik7CgogICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIgPSBvYmpSZXBvcnRlcjsKICAgICAgICAgIF90aGlzMy5fZGF0YU9iamVjdFJlcG9ydGVyLm9uU3Vic2NyaXB0aW9uKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICBldmVudC5hY2NlcHQoKTsgLy8gYWxsIHN1YnNjcmlwdGlvbiByZXF1ZXN0ZWQgYXJlIGFjY2VwdGVkCiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgY29uc3RyYWludHMgPSB7CiAgICAgICAgICAgIG9mZmVyVG9SZWNlaXZlQXVkaW86IGZhbHNlLAogICAgICAgICAgICBvZmZlclRvUmVjZWl2ZVZpZGVvOiBmYWxzZQogICAgICAgICAgfTsKICAgICAgICAgIC8vIGVpdGhlciBpbnZva2UgY3JlYXRlT2ZmZXIgb3IgY3JlYXRlQW5zd2VyLCBkZXBlbmRpbmcgb24gdGhlIHJvbGVzCiAgICAgICAgICB2YXIgc2RwUHJvbWlzZSA9IF90aGlzMy5fY2FsbGVyID8gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVPZmZlcihjb25zdHJhaW50cykgOiBfdGhpczMuX3BlZXJDb25uZWN0aW9uLmNyZWF0ZUFuc3dlcigpOwogICAgICAgICAgc2RwUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChzZHApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIFNEUCBjcmVhdGVkIiwgc2RwKTsKICAgICAgICAgICAgX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5zZXRMb2NhbERlc2NyaXB0aW9uKG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oc2RwKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gbG9jYWxEZXNjcmlwdGlvbiBzZXQgc3VjY2Vzc2Z1bGx5Jyk7CiAgICAgICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIuZGF0YS5jb25uZWN0aW9uRGVzY3JpcHRpb24gPSBzZHA7CiAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHJlamVjdCgic2V0dGluZyBvZiBsb2NhbERlc2NyaXB0aW9uIGZhaWxlZDogIiwgZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICAgIHJlamVjdChyZWFzb24pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25NZXNzYWdlKGNhbGxiYWNrKSB7CiAgICAgIC8vIGFkZCB0aGUgbWVzc2FnZSBjYWxsYmFjawogICAgICB0aGlzLl9vbkRhdGFDaGFubmVsTWVzc2FnZSA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uU3RhdHVzVXBkYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblN0YXR1c1VwZGF0ZShjYWxsYmFjaykgewogICAgICAvLyBhZGQgYSBjb25uZWN0aW9uIHN0YXR1cyB1cGRhdGUgY2FsbGJhY2sKICAgICAgdGhpcy5fb25TdGF0dXNVcGRhdGUgPSBjYWxsYmFjazsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdzZW5kTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZE1lc3NhZ2UobSkgewogICAgICAvLyB0b2RvOiBvbmx5IHNlbmQgaWYgZGF0YSBjaGFubmVsIGlzIGNvbm5lY3RlZAogICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gLS0+IG91dGdvaW5nIG1zZzogIiwgbSk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLnNlbmQobSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnY2xlYW51cCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYW51cCgpIHsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RPYnNlcnZlcjsKICAgICAgaWYgKHRoaXMuX2RhdGFDaGFubmVsKSB0aGlzLl9kYXRhQ2hhbm5lbC5jbG9zZSgpOwogICAgICBpZiAodGhpcy5fcGVlckNvbm5lY3Rpb24pIHRoaXMuX3BlZXJDb25uZWN0aW9uLmNsb3NlKCk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsID0gbnVsbDsKICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24gPSBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogJ19hZGREYXRhQ2hhbm5lbExpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxPcGVuKCk7CiAgICAgIH07CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzNC5fb25EYXRhQ2hhbm5lbEVycm9yKGUpOwogICAgICB9OwogICAgICB0aGlzLl9kYXRhQ2hhbm5lbC5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAobSkgewogICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSA8LS0gaW5jb21pbmcgbXNnOiAiLCBtKTsKICAgICAgICBpZiAoX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZSkgX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZShtKTsKICAgICAgfTsKICAgICAgdGhpcy5fZGF0YUNoYW5uZWwub25jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxDbG9zZSgpOwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZXR1cE9ic2VydmVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0dXBPYnNlcnZlcihkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIgPSBkYXRhT2JqZWN0T2JzZXJ2ZXI7CgogICAgICB2YXIgcGVlckRhdGEgPSB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YTsKICAgICAgY29uc29sZS5pbmZvKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogX3NldHVwT2JzZXJ2ZXIgUGVlciBEYXRhOiIsIHBlZXJEYXRhKTsKCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnY29ubmVjdGlvbkRlc2NyaXB0aW9uJykpIHsKICAgICAgICB0aGlzLl9wcm9jZXNzUGVlckluZm9ybWF0aW9uKHBlZXJEYXRhLmNvbm5lY3Rpb25EZXNjcmlwdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnaWNlQ2FuZGlkYXRlcycpKSB7CiAgICAgICAgcGVlckRhdGEuaWNlQ2FuZGlkYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChpY2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogaGFuZGxlT2JzZXJ2ZXJPYmplY3QgZm9yIGljZSIsIGljZSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oaWNlKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgLy8gc2V0dXAgbGlzdGVuZXIgZm9yIGZ1dHVyZSBjaGFuZ2VzIG9uIHRoZSBvYnNlcnZlZCBkYXRhIG9iamVjdAogICAgICBkYXRhT2JqZWN0T2JzZXJ2ZXIub25DaGFuZ2UoJyonLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBjb25zb2xlLmRlYnVnKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogT2JzZXJ2ZXIgb24gY2hhbmdlIG1lc3NhZ2U6ICcsIGV2ZW50KTsKICAgICAgICAvLyB3ZSBuZWVkIHRvIHByb2Nlc3MgdGhlIGFuc3dlciBmcm9tIGV2ZW50LmRhdGEgYW5kIHRoZSBjYW5kaWRhdGVzIHdoaWNoIG1pZ2h0IHRyaWNrbGUKICAgICAgICAvLyBmcm9tIGV2ZW50LmRhdGFbMF0KICAgICAgICBpZiAoZXZlbnQuZGF0YVswXSkgewogICAgICAgICAgLy8gWzBdIHRoaXMgZG9lcyB0aGUgdHJpY2sgd2hlbiBpY2UgY2FuZGlkYXRlcyBhcmUgdHJpY2tsaW5nIDspCiAgICAgICAgICBjb25zb2xlLmxvZygnPj5ldmVudC5kYXRhWzBdJywgZXZlbnQuZGF0YVswXSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oZXZlbnQuZGF0YVswXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogPj5ldmVudCcsIGV2ZW50KTsKICAgICAgICAgIF90aGlzNS5fcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihldmVudC5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19wcm9jZXNzUGVlckluZm9ybWF0aW9uJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihkYXRhKSB7CiAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246ICIsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgaWYgKCF0aGlzLl9wZWVyQ29ubmVjdGlvbikgewogICAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246IG5vIFBlZXJDb25uZWN0aW9uIGV4aXN0aW5nIC0tPiBtYXliZSBpbiBkaXNjb25uZWN0aW5nIHByb2Nlc3MuIC0tPiBpZ25vcmluZyB0aGlzIHVwZGF0ZSIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGRhdGEudHlwZSA9PT0gJ29mZmVyJyB8fCBkYXRhLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogUHJvY2VzcyBDb25uZWN0aW9uIERlc2NyaXB0aW9uOiAnLCBkYXRhKTsKICAgICAgICB0aGlzLl9wZWVyQ29ubmVjdGlvbi5zZXRSZW1vdGVEZXNjcmlwdGlvbihuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKGRhdGEpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogcmVtb3RlIHN1Y2Nlc3MiKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiByZW1vdGUgZXJyb3I6ICIsIGUpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoZGF0YS5jYW5kaWRhdGUpIHsKICAgICAgICBjb25zb2xlLmluZm8oJ1Byb2Nlc3MgSWNlIENhbmRpZGF0ZTogJywgZGF0YSk7CiAgICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24uYWRkSWNlQ2FuZGlkYXRlKG5ldyBSVENJY2VDYW5kaWRhdGUoewogICAgICAgICAgY2FuZGlkYXRlOiBkYXRhLmNhbmRpZGF0ZQogICAgICAgIH0pKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsT3BlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRGF0YUNoYW5uZWxPcGVuKCkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgb3BlbmVkJyk7CiAgICAgIGlmICh0aGlzLl9vblN0YXR1c1VwZGF0ZSkgdGhpcy5fb25TdGF0dXNVcGRhdGUoImxpdmUiLCB1bmRlZmluZWQsIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsRXJyb3InLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsRXJyb3IoZSkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgZXJyb3I6ICcsIGUpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiIiArIGUpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsQ2xvc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsQ2xvc2UoKSB7CiAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBEYXRhQ2hhbm5lbCBjbG9zZWQ6ICcpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiY2xvc2VkIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICAgICAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAgICAgKiBAcmV0dXJuIHtkaXZpZGVVUkx9IHRoZSByZXN1bHQgb2YgZGl2aWRlVVJMCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnX2RpdmlkZVVSTCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RpdmlkZVVSTCh1cmwpIHsKCiAgICAgIC8vIGxldCByZSA9IC8oW2EtekEtWi1dKik/OlwvXC8oPzpcLik/KFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIpKihcL1tcL1xkXHdcLi1dKikqKD86W1w/XSkqKC4rKSovZ2k7CiAgICAgIHZhciByZSA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogICAgICB2YXIgc3Vic3QgPSAnJDEsJDIsJDMnOwogICAgICB2YXIgcGFydHMgPSB1cmwucmVwbGFjZShyZSwgc3Vic3QpLnNwbGl0KCcsJyk7CgogICAgICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzCiAgICAgIGlmIChwYXJ0c1swXSA9PT0gdXJsKSB7CiAgICAgICAgcGFydHNbMF0gPSAnaHR0cHMnOwogICAgICAgIHBhcnRzWzFdID0gdXJsOwogICAgICB9CgogICAgICB2YXIgcmVzdWx0ID0gewogICAgICAgIHR5cGU6IHBhcnRzWzBdLAogICAgICAgIGRvbWFpbjogcGFydHNbMV0sCiAgICAgICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgICAgIH07CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIENvbm5lY3Rpb25Db250cm9sbGVyOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBDb25uZWN0aW9uQ29udHJvbGxlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsid2VicnRjLWFkYXB0ZXIiOjN9XSwxMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IGFjdGl2YXRlOwoKdmFyIF9TeW5jaGVyID0gcmVxdWlyZSgnc2VydmljZS1mcmFtZXdvcmsvZGlzdC9TeW5jaGVyJyk7Cgp2YXIgX0Nvbm5lY3Rpb25Db250cm9sbGVyID0gcmVxdWlyZSgnLi9Db25uZWN0aW9uQ29udHJvbGxlcicpOwoKdmFyIF9Db25uZWN0aW9uQ29udHJvbGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Db25uZWN0aW9uQ29udHJvbGxlcik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgovLyBUT0RPOiBpbnRlZ3JhdGUgdGhlIHN0YXR1cyBldmVudGluZwoKLyoqCiAqIFByb3RvU3R1YiBJbnRlcmZhY2UKICovCnZhciBQMlBSZXF1ZXN0ZXJTdHViID0gZnVuY3Rpb24gKCkgewoKICAvKioKICAgKiBJbml0aWFsaXNlIHRoZSBwcm90b2NvbCBzdHViIGluY2x1ZGluZyBhcyBpbnB1dCBwYXJhbWV0ZXJzIGl0cyBhbGxvY2F0ZWQKICAgKiBjb21wb25lbnQgcnVudGltZSB1cmwsIHRoZSBydW50aW1lIEJVUyBwb3N0TWVzc2FnZSBmdW5jdGlvbiB0byBiZSBpbnZva2VkCiAgICogb24gbWVzc2FnZXMgcmVjZWl2ZWQgYnkgdGhlIHByb3RvY29sIHN0dWIgYW5kIHJlcXVpcmVkIGNvbmZpZ3VyYXRpb24gcmV0cmlldmVkIGZyb20gcHJvdG9jb2xTdHViIGRlc2NyaXB0b3IuCiAgICogQHBhcmFtICB7VVJMLnJ1bnRpbWVQcm90b1N0dWJVUkx9ICAgICAgICAgICAgICAgICAgIHJ1bnRpbWVQcm90b1N0dWJVUkwgcnVudGltZVByb3RvU3ViVVJMCiAgICogQHBhcmFtICB7TWVzc2FnZS5NZXNzYWdlfSAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1c1Bvc3RNZXNzYWdlICAgICBjb25maWd1cmF0aW9uCiAgICogQHBhcmFtICB7UHJvdG9TdHViRGVzY3JpcHRvci5Db25maWd1cmF0aW9uRGF0YUxpc3R9IGNvbmZpZ3VyYXRpb24gICAgICBjb25maWd1cmF0aW9uCiAgICovCiAgZnVuY3Rpb24gUDJQUmVxdWVzdGVyU3R1YihydW50aW1lUHJvdG9TdHViVVJMLCBtaW5pQnVzLCBjb25maWd1cmF0aW9uKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQMlBSZXF1ZXN0ZXJTdHViKTsKCiAgICBpZiAoIXJ1bnRpbWVQcm90b1N0dWJVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIHJ1bnRpbWVQcm90b1N0dWJVUkwgaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKICAgIGlmICghbWluaUJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWNvbmZpZ3VyYXRpb24pIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZ3VyYXRpb24gaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKICAgIC8vIGlmICghY29uZmlndXJhdGlvbi5wMnBIYW5kbGVyKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBwMnBIYW5kbGVyIGlzIGEgcmVxdWlyZWQgYXR0cmlidXRlIGluIHRoZSBjb25maWd1cmF0aW9uIHBhcmFtZXRlcicpOwoKICAgIGNvbnNvbGUubG9nKCcrW1AyUFJlcXVlc3RlclN0dWIuY29uc3RydWN0b3JdIGNvbmZpZyBpczogJywgY29uZmlndXJhdGlvbik7CiAgICB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMID0gcnVudGltZVByb3RvU3R1YlVSTDsKICAgIHRoaXMuX3J1bnRpbWVVUkwgPSBjb25maWd1cmF0aW9uLnJ1bnRpbWVVUkw7CiAgICB0aGlzLl9yZW1vdGVSdW50aW1lVVJMID0gY29uZmlndXJhdGlvbi5yZW1vdGVSdW50aW1lVVJMOyAvLyByZXF1aXJlZCBmb3Igc3RhdHVzIGV2ZW50cwogICAgdGhpcy5fY29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247CiAgICB0aGlzLl9idXMgPSBtaW5pQnVzOwogICAgdGhpcy5fYnVzLmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24gKG1zZykgewogICAgICBfdGhpcy5fc2VuZENoYW5uZWxNc2cobXNnKTsKICAgIH0pOwoKICAgIHRoaXMuX3N5bmNoZXIgPSBuZXcgX1N5bmNoZXIuU3luY2hlcihydW50aW1lUHJvdG9TdHViVVJMLCBtaW5pQnVzLCBjb25maWd1cmF0aW9uKTsKICAgIHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyID0gbmV3IF9Db25uZWN0aW9uQ29udHJvbGxlcjIuZGVmYXVsdCh0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMLCB0aGlzLl9zeW5jaGVyLCB0aGlzLl9jb25maWd1cmF0aW9uLCB0cnVlKTsKICAgIHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyLm9uU3RhdHVzVXBkYXRlKGZ1bmN0aW9uIChzdGF0dXMsIHJlYXNvbikgewogICAgICBfdGhpcy5fc2VuZFN0YXR1cyhzdGF0dXMsIHJlYXNvbik7CiAgICB9KTsKCiAgICB0aGlzLl9zeW5jaGVyLm9uTm90aWZpY2F0aW9uKGZ1bmN0aW9uIChldmVudCkgewogICAgICBjb25zb2xlLmxvZygnK1tQMlBSZXF1ZXN0ZXJTdHViXSBPbiBTeW5jaGVyIE5vdGlmaWNhdGlvbjogJywgZXZlbnQpOwogICAgICBldmVudC5hY2soMjAwKTsKCiAgICAgIHN3aXRjaCAoZXZlbnQudHlwZSkgewoKICAgICAgICBjYXNlICdjcmVhdGUnOgogICAgICAgICAgLy8gaW5jb21pbmcgb2JzZXJ2ZSBpbnZpdGF0aW9uIGZyb20gcGVlcgogICAgICAgICAgaWYgKF90aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcikgewogICAgICAgICAgICBfdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXIub2JzZXJ2ZShldmVudCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIitbUDJQUmVxdWVzdGVyU3R1Yl0gb2JzZXJ2ZXIgY3JlYXRlZCAiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnZGVsZXRlJzoKICAgICAgICAgIC8vIFRPRE86IHF1ZXN0aW9uIHJlZ2FyZGluZyBjb2RlIGluIENvbm5lY3RvcjogLS0+IHRoZXJlIGl0IGRlbGV0ZXMgYWxsIGNvbnRyb2xsZXJzIC0tPiB3aHk/CiAgICAgICAgICBjb25zb2xlLmxvZygiK1tQMlBSZXF1ZXN0ZXJTdHViXSBkZWxldGluZyBjb25uZWN0aW9uIGhhbmRsZXIgZm9yICIgKyBldmVudC5mcm9tKTsKCiAgICAgICAgICBkaXNjb25uZWN0KCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgfQogICAgfSk7CgogICAgdGhpcy5fc2VuZFN0YXR1cygiY3JlYXRlIik7CgogICAgLy8gdGhlIHRhcmdldCBoYW5kbGVyIHN0dWIgdXJsIG11c3QgYmUgcHJlc2VudCBpbiB0aGUgY29uZmlndXJhdGlvbiBhcyAicDJwSGFuZGxlciIgYXR0cmlidXRlCiAgICBpZiAodGhpcy5fY29uZmlndXJhdGlvbi5wMnBIYW5kbGVyKSB0aGlzLmNvbm5lY3QodGhpcy5fY29uZmlndXJhdGlvbi5wMnBIYW5kbGVyKTsKICB9CgogIF9jcmVhdGVDbGFzcyhQMlBSZXF1ZXN0ZXJTdHViLCBbewogICAga2V5OiAnY29ubmVjdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29ubmVjdChoYW5kbGVyVVJMKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXIucmVwb3J0KGhhbmRsZXJVUkwsIHRoaXMuX3J1bnRpbWVVUkwpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIC8vIHNlbmQgImluLXByb2dyZXNzIiBldmVudCwgaWYgdGhlIHN5bmNoZXIuY3JlYXRlIHdhcyBkb25lCiAgICAgICAgX3RoaXMyLl9zZW5kU3RhdHVzKCJpbi1wcm9ncmVzcyIpOwogICAgICAgIF90aGlzMi5fY29ubmVjdGlvbkNvbnRyb2xsZXIub25NZXNzYWdlKGZ1bmN0aW9uIChtKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiK1tQMlBSZXF1ZXN0ZXJTdHViXSBvbk1lc3NhZ2U6ICIsIG0pOwogICAgICAgICAgX3RoaXMyLl9kZWxpdmVyKG0pOwogICAgICAgIH0pOwogICAgICAgIGNvbnNvbGUubG9nKCIrW1AyUFJlcXVlc3RlclN0dWJdIHNldHVwIHJlcG9ydGVyIG9iamVjdCBzdWNjZXNzZnVsbHkiKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUbyBkaXNjb25uZWN0IHRoZSBwcm90b2NvbCBzdHViLgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2Rpc2Nvbm5lY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2Nvbm5lY3QoKSB7CiAgICAgIGlmICh0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcikgewogICAgICAgIHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyLmNsZWFudXAoKTsKICAgICAgICB0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlciA9IG51bGw7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc2VuZENoYW5uZWxNc2cnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kQ2hhbm5lbE1zZyhtc2cpIHsKICAgICAgaWYgKHRoaXMuX2ZpbHRlcihtc2cpKSB7CiAgICAgICAgaWYgKHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyKSB7CiAgICAgICAgICB0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlci5zZW5kTWVzc2FnZShKU09OLnN0cmluZ2lmeShtc2cpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc2VuZFN0YXR1cycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRTdGF0dXModmFsdWUsIHJlYXNvbikgewogICAgICB2YXIgbXNnID0gewogICAgICAgIHR5cGU6ICd1cGRhdGUnLAogICAgICAgIGZyb206IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwsCiAgICAgICAgdG86IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgKyAnL3N0YXR1cycsCiAgICAgICAgYm9keTogewogICAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgICAgcmVzb3VyY2U6IHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwKICAgICAgICB9CiAgICAgIH07CiAgICAgIGlmIChyZWFzb24pIHsKICAgICAgICBtc2cuYm9keS5kZXNjID0gcmVhc29uOwogICAgICB9CiAgICAgIHRoaXMuX2J1cy5wb3N0TWVzc2FnZShtc2cpOwogICAgICBjb25zb2xlLmxvZygiK1tQMlByZXF1ZXN0ZXJTdHViXSBzZW5kaW5nIHN0YXR1cyB1cGRhdGU6ICIsIG1zZyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBGaWx0ZXIgbWV0aG9kIHRoYXQgc2hvdWxkIGJlIHVzZWQgZm9yIGV2ZXJ5IG1lc3NhZ2VzIGluIGRpcmVjdGlvbjogUHJvdG9zdHViIC0+IE1lc3NhZ2VOb2RlCiAgICAgKiBAcGFyYW0gIHtNZXNzYWdlfSBtc2cgT3JpZ2luYWwgbWVzc2FnZSBmcm9tIHRoZSBNZXNzYWdlQnVzCiAgICAgKiBAcmV0dXJuIHtib29sZWFufSB0cnVlIGlmIGl0J3MgdG8gYmUgZGVsaXZlciBpbiB0aGUgTWVzc2FnZU5vZGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdfZmlsdGVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlsdGVyKG1zZykgewogICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkudmlhID09PSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMKSByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogTWV0aG9kIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gZGVsaXZlciB0aGUgbWVzc2FnZSBpbiBkaXJlY3Rpb246IFByb3Rvc3R1YiAtPiBNZXNzYWdlQnVzIChjb3JlKQogICAgICogQHBhcmFtICB7TWVzc2FnZX0gbXNnIE9yaWdpbmFsIG1lc3NhZ2UgZnJvbSB0aGUgTWVzc2FnZU5vZGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdfZGVsaXZlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGl2ZXIobXNnKSB7CiAgICAgIGNvbnNvbGUubG9nKCIrW1AyUHJlcXVlc3RlclN0dWJdIHBvc3RpbmcgbWVzc2FnZSB0byBtc2cgYnVzOiAiLCBtc2cpOwoKICAgICAgdmFyIG1lc3NhZ2UgPSBKU09OLnBhcnNlKG1zZy5kYXRhKTsKCiAgICAgIGlmICghbWVzc2FnZS5ib2R5KSBtc2cuYm9keSA9IHt9OwoKICAgICAgbWVzc2FnZS5ib2R5LnZpYSA9IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkw7CiAgICAgIHRoaXMuX2J1cy5wb3N0TWVzc2FnZShtZXNzYWdlKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBQMlBSZXF1ZXN0ZXJTdHViOwp9KCk7CgpmdW5jdGlvbiBhY3RpdmF0ZSh1cmwsIGJ1cywgY29uZmlnKSB7CiAgcmV0dXJuIHsKICAgIG5hbWU6ICdQMlBSZXF1ZXN0ZXJTdHViJywKICAgIGluc3RhbmNlOiBuZXcgUDJQUmVxdWVzdGVyU3R1Yih1cmwsIGJ1cywgY29uZmlnKQogIH07Cn0KbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi9Db25uZWN0aW9uQ29udHJvbGxlciI6MTIsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlciI6Mn1dfSx7fSxbMTNdKSgxMykKfSk7",
      "sourceCodeClassname": "P2PRequesterProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-6f652c34-f0d9-fb93-9407-7f3e29ded6aa3",
    "version": 0.7999999999999999,
    "description": "Description of P2PRequesterProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "P2PRequesterProtoStub",
    "configuration": {
      "iceServers": [
        {
          "urls": "stun:stun.voiparound.com"
        },
        {
          "urls": "stun:stun.voipbuster.com"
        },
        {
          "urls": "stun:stun.voipstunt.com"
        },
        {
          "urls": "stun:stun.voxgratia.org"
        },
        {
          "urls": "stun:stun.ekiga.net"
        },
        {
          "urls": "stun:stun.schlund.de"
        },
        {
          "urls": "stun:stun.iptel.org"
        },
        {
          "urls": "stun:stun.l.google.com:19302"
        },
        {
          "urls": "stun:stun1.l.google.com:19302"
        },
        {
          "urls": "stun:stun.ideasip.com"
        },
        {
          "urls": "stun:stun4.l.google.com:19302"
        },
        {
          "urls": "stun:stun2.l.google.com:19302"
        },
        {
          "urls": "stun:stun3.l.google.com:19302"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=tcp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=udp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:numb.viagenie.ca",
          "credential": "muazkh",
          "username": "webrtc@live.com"
        }
      ]
    },
    "messageSchemas": "",
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": "{ windowSandbox: true }",
    "interworking": false,
    "dataObjects": []
  },
  "SlackProtoStub": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiYWN0aXZhdGUiLCBbXSwgZmFjdG9yeSk7CgllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JykKCQlleHBvcnRzWyJhY3RpdmF0ZSJdID0gZmFjdG9yeSgpOwoJZWxzZQoJCXJvb3RbImFjdGl2YXRlIl0gPSBmYWN0b3J5KCk7Cn0pKHRoaXMsIGZ1bmN0aW9uKCkgewpyZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsKCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewoKLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7CgovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewovKioqKioqLyAJCQlleHBvcnRzOiB7fSwKLyoqKioqKi8gCQkJaWQ6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsb2FkZWQ6IGZhbHNlCi8qKioqKiovIAkJfTsKCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7CgovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubG9hZGVkID0gdHJ1ZTsKCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9CgoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwoKLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwovKioqKioqLyB9KQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAoWwovKiAwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsKCglleHBvcnRzLmRlZmF1bHQgPSBhY3RpdmF0ZTsKCgl2YXIgX3NsYWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTsKCgl2YXIgX3NsYWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NsYWNrKTsKCgl2YXIgX1N5bmNoZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3OCk7CgoJdmFyIF9JZGVudGl0eUZhY3RvcnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3OSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCgl2YXIgU2xhY2tQcm90b1N0dWIgPSBmdW5jdGlvbiAoKSB7CgkgIGZ1bmN0aW9uIFNsYWNrUHJvdG9TdHViKHJ1bnRpbWVQcm90b1N0dWJVUkwsIGJ1cywgY29uZmlnKSB7CgkgICAgdmFyIF90aGlzMiA9IHRoaXM7CgoJICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTbGFja1Byb3RvU3R1Yik7CgoJICAgIGlmICghcnVudGltZVByb3RvU3R1YlVSTCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgcnVudGltZVByb3RvU3R1YlVSTCBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCSAgICBpZiAoIWJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoJICAgIGlmICghY29uZmlnKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWcgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CgoJICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIENvbnN0cnVjdG9yIExvYWRlZCcpOwoKCSAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICB0aGlzLl9zdWJzY3JpYmVkTGlzdCA9IFtdOwoJICAgIHRoaXMuX3VzZXJzTGlzdCA9IFtdOwoJICAgIHRoaXMuX2dyb3Vwc0xpc3QgPSBbXTsKCSAgICB0aGlzLl9jaGFubmVsc0xpc3QgPSBbXTsKCSAgICB0aGlzLl9pbXNMaXN0ID0gW107CgkgICAgdGhpcy5fb2JzZXJ2ZXI7CgkgICAgdGhpcy5fY2hhbm5lbElEID0gJyc7CgkgICAgdGhpcy5faWQgPSAwOwoJICAgIHRoaXMuX2NvbnRpbnVvdXNPcGVuID0gdHJ1ZTsKCSAgICB0aGlzLl90b2tlbiA9ICcnOwoKCSAgICB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMID0gcnVudGltZVByb3RvU3R1YlVSTDsKCSAgICB0aGlzLl9idXMgPSBidXM7CgkgICAgdGhpcy5fY29uZmlnID0gY29uZmlnOwoKCSAgICB0aGlzLl9ydW50aW1lU2Vzc2lvblVSTCA9IGNvbmZpZy5ydW50aW1lVVJMOwoJICAgIHRoaXMuX3JlT3BlbiA9IGZhbHNlOwoJICAgIHRoaXMuX3NsYWNrID0gX3NsYWNrMi5kZWZhdWx0OwoJICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIGluc3RhdGlhdGUgc3luY2hlciB3aXRoIHJ1bnRpbWVVcmwnLCBydW50aW1lUHJvdG9TdHViVVJMKTsKCSAgICB0aGlzLl9zeW5jaGVyID0gbmV3IF9TeW5jaGVyLlN5bmNoZXIocnVudGltZVByb3RvU3R1YlVSTCwgYnVzLCBjb25maWcpOwoKCSAgICB0aGlzLl9zeW5jaGVyLm9uTm90aWZpY2F0aW9uKGZ1bmN0aW9uIChldmVudCkgewoJICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gT24gU3luY2hlciBOb3RpZmljYXRpb24nLCBldmVudCk7CgkgICAgfSk7CgoJICAgIGJ1cy5hZGRMaXN0ZW5lcignKicsIGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIG5ldyBtc2cnLCBtc2cpOwoJICAgICAgaWYgKG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdpZGVudGl0eScpICYmIG1zZy5ib2R5LmlkZW50aXR5Lmhhc093blByb3BlcnR5KCdhY2Nlc3NfdG9rZW4nKSAmJiBtc2cuYm9keS5pZGVudGl0eS5hY2Nlc3NfdG9rZW4pIHsKCgkgICAgICAgIHZhciB0b2tlbiA9IG1zZy5ib2R5LmlkZW50aXR5LmFjY2Vzc190b2tlbjsKCSAgICAgICAgX3RoaXMyLl90b2tlbiA9IHRva2VuOwoKCSAgICAgICAgX3RoaXMuX29wZW4odG9rZW4sIGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICBpZiAoX3RoaXMuX2ZpbHRlcihtc2cpKSB7CgoJICAgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gQWZ0ZXIgRmlsdGVyJywgbXNnKTsKCSAgICAgICAgICAgIHZhciBzY2hlbWFVcmwgPSBtc2cuYm9keS5zY2hlbWE7CgkgICAgICAgICAgICBpZiAoc2NoZW1hVXJsICYmIG1zZy5ib2R5LnZhbHVlLm5hbWUpIHsKCgkgICAgICAgICAgICAgIHZhciBzY2hlbWFTcGxpdHRlZCA9IHNjaGVtYVVybC5zcGxpdCgnLycpOwoKCSAgICAgICAgICAgICAgaWYgKHNjaGVtYVNwbGl0dGVkW3NjaGVtYVNwbGl0dGVkLmxlbmd0aCAtIDFdID09PSAnQ29tbXVuaWNhdGlvbicpIHsKCgkgICAgICAgICAgICAgICAgX3RoaXMuX2dldFNsYWNrSW5mb3JtYXRpb24obXNnLnRvKS50aGVuKGZ1bmN0aW9uICh1c2VySW5mbykgewoKCSAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTbGFjayBVc2VyIGluZm9ybWF0aW9uOiAnLCB1c2VySW5mbyk7CgoJICAgICAgICAgICAgICAgICAgLy8gdXNlcm5hbWUsIHVzZXJVUkwsIGF2YXRhciwgY24sIGxvY2FsZSwgaWRwLCBhc3NlcnRpb24KCSAgICAgICAgICAgICAgICAgIHZhciBpZGVudGl0eSA9IG5ldyBfSWRlbnRpdHlGYWN0b3J5Lk1lc3NhZ2VCb2R5SWRlbnRpdHkodXNlckluZm8ubmFtZSwgJ3NsYWNrOi8vc2xhY2suY29tLycgKyB1c2VySW5mby5uYW1lICsgJ0BzbGFjay5jb20nLCB1c2VySW5mby5wcm9maWxlLmltYWdlXzE5MiwgdXNlckluZm8ubmFtZSwgJycsICdzbGFjay5jb20nKTsKCgkgICAgICAgICAgICAgICAgICBfdGhpcy5fc3Vic2NyaWJlKHNjaGVtYVVybCwgbXNnLmZyb20sIGlkZW50aXR5KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKCSAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gc3Vic2NyaWJlIHJlc3VsdCcsIHJlc3VsdCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHsKCgkgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3Rva2VuID0gdG9rZW47CgoJICAgICAgICAgICAgICAgICAgICAgIGlmIChtc2cuYm9keS5pZGVudGl0eS51c2VyUHJvZmlsZS5pZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2lkID0gbXNnLmJvZHkuaWRlbnRpdHkudXNlclByb2ZpbGUuaWQ7CgkgICAgICAgICAgICAgICAgICAgICAgfQoKCSAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fY3JlYXRlQ2hhbm5lbChtc2csIHVzZXJJbmZvLmlkKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfQoJICAgIH0pOwoJICB9CgoJICBfY3JlYXRlQ2xhc3MoU2xhY2tQcm90b1N0dWIsIFt7CgkgICAga2V5OiAnX2dldFNsYWNrSW5mb3JtYXRpb24nLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0U2xhY2tJbmZvcm1hdGlvbih0bykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKCSAgICAgICAgdmFyIFVSTFVzZXJzTGlzdCA9ICdodHRwczovL3NsYWNrLmNvbS9hcGkvdXNlcnMubGlzdD90b2tlbj0nICsgX3RoaXMuX3Rva2VuOwoJICAgICAgICB2YXIgVVJMR3JvdXBzTGlzdCA9ICdodHRwczovL3NsYWNrLmNvbS9hcGkvZ3JvdXBzLmxpc3Q/dG9rZW49JyArIF90aGlzLl90b2tlbjsKCSAgICAgICAgdmFyIFVSTENoYW5uZWxzTGlzdCA9ICdodHRwczovL3NsYWNrLmNvbS9hcGkvY2hhbm5lbHMubGlzdD90b2tlbj0nICsgX3RoaXMuX3Rva2VuOwoJICAgICAgICB2YXIgVVJMSW1zTGlzdCA9ICdodHRwczovL3NsYWNrLmNvbS9hcGkvaW0ubGlzdD90b2tlbj0nICsgX3RoaXMuX3Rva2VuOwoKCSAgICAgICAgdmFyIFVzZXJzTGlzdFByb21pc2UgPSBfdGhpcy5fc2VuZEhUVFBSZXF1ZXN0KCdHRVQnLCBVUkxVc2Vyc0xpc3QpOwoJICAgICAgICB2YXIgR3JvdXBzTGlzdFByb21pc2UgPSBfdGhpcy5fc2VuZEhUVFBSZXF1ZXN0KCdHRVQnLCBVUkxHcm91cHNMaXN0KTsKCSAgICAgICAgdmFyIENoYW5uZWxzTGlzdFByb21pc2UgPSBfdGhpcy5fc2VuZEhUVFBSZXF1ZXN0KCdHRVQnLCBVUkxDaGFubmVsc0xpc3QpOwoJICAgICAgICB2YXIgSW1zTGlzdFByb21pc2UgPSBfdGhpcy5fc2VuZEhUVFBSZXF1ZXN0KCdHRVQnLCBVUkxJbXNMaXN0KTsKCgkgICAgICAgIFByb21pc2UuYWxsKFtVc2Vyc0xpc3RQcm9taXNlLCBHcm91cHNMaXN0UHJvbWlzZSwgQ2hhbm5lbHNMaXN0UHJvbWlzZSwgSW1zTGlzdFByb21pc2VdKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKCSAgICAgICAgICBfdGhpcy5fdXNlcnNMaXN0ID0gcmVzdWx0WzBdLm1lbWJlcnM7CgkgICAgICAgICAgX3RoaXMuX2dyb3Vwc0xpc3QgPSByZXN1bHRbMV0uZ3JvdXBzOwoJICAgICAgICAgIF90aGlzLl9jaGFubmVsc0xpc3QgPSByZXN1bHRbMl0uY2hhbm5lbHM7CgkgICAgICAgICAgX3RoaXMuX2ltc0xpc3QgPSByZXN1bHRbM10uaW1zOwoKCSAgICAgICAgICAvL2dldCB1c2VySUQgdG8gaW52aXRlCgkgICAgICAgICAgdmFyIHRvU3BsaXR0ZWQgPSB0by5zcGxpdCgnOi8vJylbMV07CgkgICAgICAgICAgdmFyIHVzZXIgPSB0b1NwbGl0dGVkLnNwbGl0KCdAJylbMF07CgkgICAgICAgICAgdmFyIHVzZXJJbmZvID0gX3RoaXMuX3VzZXJzTGlzdC5maWx0ZXIoZnVuY3Rpb24gKHZhbHVlKSB7CgkgICAgICAgICAgICByZXR1cm4gdmFsdWUubmFtZSA9PT0gdXNlcjsKCSAgICAgICAgICB9KVswXTsKCgkgICAgICAgICAgcmVzb2x2ZSh1c2VySW5mbyk7CgkgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikgewoJICAgICAgICAgIGNvbnNvbGUuZXJyKCdbU2xhY2tQcm90b3N0dWJdICcsIGVycm9yKTsKCSAgICAgICAgICByZWplY3QoZXJyb3IpOwoJICAgICAgICB9KTsKCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19jcmVhdGVDaGFubmVsJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZUNoYW5uZWwobXNnLCB1c2VySUQpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICB2YXIgY2hhbm5lbEV4aXN0cyA9IF90aGlzLl9jaGFubmVsc0xpc3QuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZSkgewoJICAgICAgICByZXR1cm4gdmFsdWUubmFtZSA9PT0gbXNnLmJvZHkudmFsdWUubmFtZTsKCSAgICAgIH0pWzBdOwoKCSAgICAgIC8vIGlmIGNoYW5uZWwgZXhpc3QsIGludml0ZSB1c2VyLCBlbHNlIGNoYW5uZWwgbmVlZCB0byBiZSBjcmVhdGVkIGFuZCB0aGVuIGludml0ZSB1c2VyCgkgICAgICBpZiAoY2hhbm5lbEV4aXN0cykgewoJICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBjaGFubmVsIGV4aXN0JywgY2hhbm5lbEV4aXN0cyk7CgoJICAgICAgICB2YXIgY2hhbm5lbE1lbWJlcnMgPSBfdGhpcy5fY2hhbm5lbHNMaXN0LmZpbHRlcihmdW5jdGlvbiAodmFsdWUpIHsKCSAgICAgICAgICByZXR1cm4gdmFsdWUubmFtZSA9PT0gbXNnLmJvZHkudmFsdWUubmFtZTsKCSAgICAgICAgfSlbMF0ubWVtYmVyczsKCSAgICAgICAgdmFyIGFscmVhZHlPbkNoYW5uZWwgPSBmYWxzZTsKCgkgICAgICAgIGNoYW5uZWxNZW1iZXJzLmZvckVhY2goZnVuY3Rpb24gKHMpIHsKCSAgICAgICAgICBpZiAocyA9PT0gdXNlcklEKSB7CgkgICAgICAgICAgICBhbHJlYWR5T25DaGFubmVsID0gdHJ1ZTsKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBjaGFubmVsIG1lbWJlcnMnLCBjaGFubmVsTWVtYmVycywgJyAgIC0+JywgYWxyZWFkeU9uQ2hhbm5lbCk7CgoJICAgICAgICAvLyBpZiB1c2VyIGlzbnQgb24gQ2hhbm5lbCBpbnZpdGUsIGVsc2UganVzdCBzZXQgY2hhbm5lbElECgkgICAgICAgIGlmICghYWxyZWFkeU9uQ2hhbm5lbCkgewoJICAgICAgICAgIF90aGlzLl9pbnZpdGUodXNlcklELCBjaGFubmVsRXhpc3RzLmlkKTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICBfdGhpcy5fY2hhbm5lbElEID0gY2hhbm5lbEV4aXN0cy5pZDsKCSAgICAgICAgfQoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgX3RoaXMuX2NyZWF0ZShtc2cuYm9keS52YWx1ZS5uYW1lLCB1c2VySUQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewoJICAgICAgICAgIGlmIChyZXN1bHQpIHsKCSAgICAgICAgICAgIF90aGlzLl9pbnZpdGUodXNlcklEKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19maWx0ZXInLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlsdGVyKG1zZykgewoJICAgICAgaWYgKG1zZy5ib2R5ICYmIG1zZy5ib2R5LnZpYSA9PT0gdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICB9CgoJICAgICAgcmV0dXJuIHRydWU7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX29wZW4nLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb3Blbih0b2tlbiwgY2FsbGJhY2spIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgaWYgKCFfdGhpcy5fc2Vzc2lvbikgewoJICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBuZXcgU2Vzc2lvbiBmb3IgdG9rZW46JywgdG9rZW4pOwoJICAgICAgICBfdGhpcy5fc2Vzc2lvbiA9IF90aGlzLl9zbGFjay5ydG0uY2xpZW50KCk7CgoJICAgICAgICBfdGhpcy5fc2Vzc2lvbi5saXN0ZW4oeyB0b2tlbjogdG9rZW4gfSk7CgoJICAgICAgICBfdGhpcy5fc2Vzc2lvbi5tZXNzYWdlKGZ1bmN0aW9uIChtZXNzYWdlKSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gbmV3IG1lc3NhZ2Ugb24gc2Vzc2lvbicsIG1lc3NhZ2UpOwoJICAgICAgICAgIGlmIChtZXNzYWdlLmNoYW5uZWwpIHsKCSAgICAgICAgICAgIGlmIChtZXNzYWdlLmNoYW5uZWwgPT09IF90aGlzLl9jaGFubmVsSUQgJiYgbWVzc2FnZS51c2VyICE9PSBfdGhpcy5faWQgfHwgIW1lc3NhZ2UuaGFzT3duUHJvcGVydHkoJ2JvdF9pZCcpICYmIG1lc3NhZ2UudXNlciA9PT0gX3RoaXMuX2lkICYmIG1lc3NhZ2UuY2hhbm5lbCA9PT0gX3RoaXMuX2NoYW5uZWxJRCkgewoKCSAgICAgICAgICAgICAgX3RoaXMuX2dldFVzZXJJbmZvKG1lc3NhZ2UudXNlcikudGhlbihmdW5jdGlvbiAoaWRlbnRpdHkpIHsKCSAgICAgICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXIuYWRkQ2hpbGQoJ2NoYXRtZXNzYWdlcycsIHsgbWVzc2FnZTogbWVzc2FnZS50ZXh0IH0sIGlkZW50aXR5KTsKCSAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIHNlc3Npb24gYWxyZWFkeSBleGlzdCcpOwoJICAgICAgfQoJICAgICAgY2FsbGJhY2soKTsKCSAgICB9CgoJICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoJICAgICogSXQgcmV0cmlldmVzIGluZm9ybWF0aW9uIGZyb20gYSBzbGFjayB1c2VyIGFuZCBjcmVhdGVzIGEgcmVUSElOSyBJZGVudGl0eSBvYmplY3Qgd2l0aCBpdAoJICAgICogQHBhcmFtIHtzdHJpbmd9IHVzZXIgLSBzbGFjayB1c2VyIGlkCgkgICAgKiBAcmV0dXJuIHtQcm9taXNlPE9iamVjdD59IFJldHVybnMgYSBwcm9taXNlIHdpdGggYW4gSWRlbnRpdHkgb2JqZWN0IHJlc29sdmVkCgkgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdfZ2V0VXNlckluZm8nLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0VXNlckluZm8odXNlcikgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKCSAgICAgICAgX3RoaXMuX3NsYWNrLnVzZXJzLmluZm8oeyB0b2tlbjogX3RoaXMuX3Rva2VuLCB1c2VyOiB1c2VyIH0sIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKCSAgICAgICAgICBpZiAoZXJyKSB7CgkgICAgICAgICAgICBjb25zb2xlLmVycignW1NsYWNrUHJvdG9zdHViXSBlcnJvcicsIGVycik7CgkgICAgICAgICAgfSBlbHNlIHsKCgkgICAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViIGdldFVzZXJJbmZvXSAnLCBkYXRhKTsKCSAgICAgICAgICAgIHZhciBpZGVudGl0eSA9IG5ldyBfSWRlbnRpdHlGYWN0b3J5Lk1lc3NhZ2VCb2R5SWRlbnRpdHkoZGF0YS51c2VyLm5hbWUsICdzbGFjazovL3NsYWNrLmNvbS8nICsgZGF0YS51c2VyLm5hbWUgKyAnQHNsYWNrLmNvbScsIGRhdGEudXNlci5wcm9maWxlLmltYWdlXzE5MiwgZGF0YS51c2VyLm5hbWUsICcnLCAnc2xhY2suY29tJyk7CgoJICAgICAgICAgICAgcmVzb2x2ZShpZGVudGl0eSk7CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19zdWJzY3JpYmUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfc3Vic2NyaWJlKHNjaGVtYSwgdXJsRGF0YU9iaiwgaWRlbnRpdHkpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CgoJICAgICAgICBfdGhpcy5fc3Vic2NyaWJlZExpc3QuZm9yRWFjaChmdW5jdGlvbiAob2JqKSB7CgkgICAgICAgICAgaWYgKG9iai51cmxEYXRhT2JqID09PSB1cmxEYXRhT2JqICYmIG9iai5zdWJzY3JpYmVkKSB7CgkgICAgICAgICAgICByZXNvbHZlKHRydWUpOwoJICAgICAgICAgIH0KCSAgICAgICAgfSk7CgoJICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0geyB1cmxEYXRhT2JqOiB1cmxEYXRhT2JqLCBzY2hlbWE6IHNjaGVtYSwgc3Vic2NyaWJlZDogdHJ1ZSB9OwoKCSAgICAgICAgdmFyIG9iamVjdERlc2NVUkwgPSBzY2hlbWE7CgkgICAgICAgIHZhciBkYXRhT2JqZWN0VXJsID0gdXJsRGF0YU9iai5zdWJzdHJpbmcoMCwgdXJsRGF0YU9iai5sYXN0SW5kZXhPZignLycpKTsKCgkgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIG5ldyBzdWJzY3JpcHRpb24gZm9yIHNjaGVtYTonLCBvYmplY3REZXNjVVJMLCAnIGFuZCBkYXRhT2JqZWN0OicsIGRhdGFPYmplY3RVcmwpOwoKCSAgICAgICAgcmV0dXJuIF90aGlzLl9zeW5jaGVyLnN1YnNjcmliZShvYmplY3REZXNjVVJMLCBkYXRhT2JqZWN0VXJsLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBpZGVudGl0eSkudGhlbihmdW5jdGlvbiAob2JzZXJ2ZXIpIHsKCSAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXIgPSBvYnNlcnZlcjsKCSAgICAgICAgICBfdGhpcy5fc3Vic2NyaWJlZExpc3QucHVzaChzdWJzY3JpcHRpb24pOwoJICAgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIHN1YnNjcmliZWQnLCBkYXRhT2JqZWN0VXJsKTsKCSAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBPYnNlcnZlcicsIG9ic2VydmVyKTsKCSAgICAgICAgICBvYnNlcnZlci5vbkFkZENoaWxkKGZ1bmN0aW9uIChjaGlsZCkgewoJICAgICAgICAgICAgY29uc29sZS5pbmZvKCdbU2xhY2tQcm90b3N0dWJdIE9ic2VydmVyIC0gQWRkIENoaWxkOiAnLCBjaGlsZCk7CgkgICAgICAgICAgICBfdGhpcy5fZGVsaXZlcihjaGlsZCk7CgkgICAgICAgICAgfSk7CgoJICAgICAgICAgIG9ic2VydmVyLm9uQ2hhbmdlKCcqJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkgICAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBPYnNlcnZlciAtIG9uQ2hhbmdlOiAnLCBldmVudCk7CgkgICAgICAgICAgfSk7CgkgICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKCSAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CgkgICAgICAgICAgY29uc29sZS5lcnIoJ1tTbGFja1Byb3Rvc3R1Yl0gU3Vic2NyaWJlJywgZXJyb3IpOwoJICAgICAgICAgIHJlc29sdmUoZmFsc2UpOwoJICAgICAgICB9KTsKCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19pbnZpdGUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfaW52aXRlKGlkVXNlciwgaWRDaGFubmVsKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGlmICghaWRDaGFubmVsKSB7CgkgICAgICAgIGlkQ2hhbm5lbCA9IF90aGlzLl9jaGFubmVsSUQ7CgkgICAgICB9CgoJICAgICAgdmFyIHRvSW52aXRlID0geyB0b2tlbjogX3RoaXMuX3Rva2VuLCBjaGFubmVsOiBpZENoYW5uZWwsIHVzZXI6IGlkVXNlciB9OwoKCSAgICAgIF90aGlzLl9zbGFjay5jaGFubmVscy5pbnZpdGUodG9JbnZpdGUsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKCSAgICAgICAgaWYgKGVycikgewoJICAgICAgICAgIGNvbnNvbGUuZXJyKCdbU2xhY2tQcm90b3N0dWJdIGVycm9yJywgZXJyKTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICBfdGhpcy5fY2hhbm5lbElEID0gaWRDaGFubmVsOwoJICAgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIHVzZXIgaW52aXRlZCB3aXRoIHN1Y2VzcycsIGRhdGEpOwoJICAgICAgICB9CgkgICAgICB9KTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfZGVsaXZlcicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxpdmVyKGNoaWxkKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGlmIChfdGhpcy5fY2hhbm5lbElEICE9PSAnJyAmJiBjaGlsZC52YWx1ZS5tZXNzYWdlKSB7CgoJICAgICAgICBpZiAoY2hpbGQuaGFzT3duUHJvcGVydHkoJ2lkZW50aXR5JykgJiYgY2hpbGQuaWRlbnRpdHkuaGFzT3duUHJvcGVydHkoJ3VzZXJQcm9maWxlJykgJiYgY2hpbGQuaWRlbnRpdHkudXNlclByb2ZpbGUuaGFzT3duUHJvcGVydHkoJ3VzZXJuYW1lJykgJiYgY2hpbGQuaWRlbnRpdHkudXNlclByb2ZpbGUudXNlcm5hbWUpIHsKCgkgICAgICAgICAgdmFyIHRleHQgPSAnJyArIGNoaWxkLmlkZW50aXR5LnVzZXJQcm9maWxlLnVzZXJuYW1lICsgJzogJyArIGNoaWxkLnZhbHVlLm1lc3NhZ2U7CgkgICAgICAgICAgdmFyIG1lc3NhZ2UgPSB7IGFzX3VzZXI6IHRydWUsIHRva2VuOiBfdGhpcy5fdG9rZW4sIGNoYW5uZWw6IF90aGlzLl9jaGFubmVsSUQsIHRleHQ6IHRleHQgfTsKCSAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSAoUG9zdE1lc3NhZ2Ugc2xhY2sgYXBpKSB0b2tlbignLCBfdGhpcy5fdG9rZW4sICcpICBjaGFubmVsKCcsIF90aGlzLl9jaGFubmVsSUQsICcpIHRleHQoJywgY2hpbGQudmFsdWUubWVzc2FnZSwgJyknKTsKCgkgICAgICAgICAgX3RoaXMuX3NsYWNrLmNoYXQucG9zdE1lc3NhZ2UobWVzc2FnZSwgZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJICAgICAgICAgICAgaWYgKGVycikgewoJICAgICAgICAgICAgICBjb25zb2xlLmVycignW1NsYWNrUHJvdG9zdHViXSBlcnJvcicsIGVycik7CgkgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBQb3N0TWVzc2FnZSB3aXRoIFN1Y2VzcycsIGRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0pOwoJICAgICAgICB9CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2NyZWF0ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGUoY2hhbm5lbE5hbWUpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CgkgICAgICAgIHZhciB0b0NyZWF0ZSA9IHsgdG9rZW46IF90aGlzLl90b2tlbiwgbmFtZTogY2hhbm5lbE5hbWUgfTsKCSAgICAgICAgX3RoaXMuX3NsYWNrLmNoYW5uZWxzLmNyZWF0ZSh0b0NyZWF0ZSwgZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJICAgICAgICAgIGlmIChlcnIpIHsKCSAgICAgICAgICAgIGNvbnNvbGUuZXJyKCdbU2xhY2tQcm90b3N0dWJdICcsIGVycik7CgkgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIGlmIChkYXRhLm9rKSB7CgkgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIENoYW5uZWwgQ3JlYXRlZCB3aXRoIFN1Y2VzcyAnLCBkYXRhKTsKCSAgICAgICAgICAgICAgX3RoaXMuX2NoYW5uZWxJRCA9IGRhdGEuY2hhbm5lbC5pZDsKCSAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3NlbmRIVFRQUmVxdWVzdCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kSFRUUFJlcXVlc3QobWV0aG9kLCB1cmwpIHsKCSAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgkgICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKCSAgICAgICAgaWYgKCd3aXRoQ3JlZGVudGlhbHMnIGluIHhocikgewoJICAgICAgICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsLCB0cnVlKTsKCSAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgWERvbWFpblJlcXVlc3QgIT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgLy8gT3RoZXJ3aXNlLCBjaGVjayBpZiBYRG9tYWluUmVxdWVzdC4KCSAgICAgICAgICAvLyBYRG9tYWluUmVxdWVzdCBvbmx5IGV4aXN0cyBpbiBJRSwgYW5kIGlzIElFJ3Mgd2F5IG9mIG1ha2luZyBDT1JTIHJlcXVlc3RzLgoJICAgICAgICAgIHhociA9IG5ldyBYRG9tYWluUmVxdWVzdCgpOwoJICAgICAgICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsKTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAvLyBPdGhlcndpc2UsIENPUlMgaXMgbm90IHN1cHBvcnRlZCBieSB0aGUgYnJvd3Nlci4KCSAgICAgICAgICB4aHIgPSBudWxsOwoJICAgICAgICB9CgkgICAgICAgIGlmICh4aHIpIHsKCSAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7CgkgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHsKCSAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7CgkgICAgICAgICAgICAgICAgcmVzb2x2ZShpbmZvKTsKCSAgICAgICAgICAgICAgfSBlbHNlIGlmICh4aHIuc3RhdHVzID09PSA0MDApIHsKCSAgICAgICAgICAgICAgICByZWplY3QoJ1RoZXJlIHdhcyBhbiBlcnJvciBwcm9jZXNzaW5nIHRoZSB0b2tlbicpOwoJICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgIHJlamVjdCgnc29tZXRoaW5nIGVsc2Ugb3RoZXIgdGhhbiAyMDAgd2FzIHJldHVybmVkJyk7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9OwoJICAgICAgICAgIHhoci5zZW5kKCk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgcmVqZWN0KCdDT1JTIG5vdCBzdXBwb3J0ZWQnKTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnY29uZmlnJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9jb25maWc7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAncnVudGltZVNlc3Npb24nLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX3J1bnRpbWVTZXNzaW9uVVJMOwoJICAgIH0KCSAgfV0pOwoKCSAgcmV0dXJuIFNsYWNrUHJvdG9TdHViOwoJfSgpOwoKCWZ1bmN0aW9uIGFjdGl2YXRlKHVybCwgYnVzLCBjb25maWcpIHsKCSAgcmV0dXJuIHsKCSAgICBuYW1lOiAnU2xhY2tQcm90b1N0dWInLAoJICAgIGluc3RhbmNlOiBuZXcgU2xhY2tQcm90b1N0dWIodXJsLCBidXMsIGNvbmZpZykKCSAgfTsKCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9hcGkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpOwoKCXZhciBfYXBpMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2FwaSk7CgoJdmFyIF9hcGkzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1Mik7CgoJdmFyIF9hcGk0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXBpMyk7CgoJdmFyIF9ib3RzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTkpOwoKCXZhciBfYm90czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ib3RzKTsKCgl2YXIgX2F1dGggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUzKTsKCgl2YXIgX2F1dGgyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXV0aCk7CgoJdmFyIF9jaGFubmVscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTYwKTsKCgl2YXIgX2NoYW5uZWxzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzKTsKCgl2YXIgX2NoYXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2MSk7CgoJdmFyIF9jaGF0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYXQpOwoKCXZhciBfZG5kID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNjIpOwoKCXZhciBfZG5kMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RuZCk7CgoJdmFyIF9lbW9qaSA9IF9fd2VicGFja19yZXF1aXJlX18oNzkpOwoKCXZhciBfZW1vamkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZW1vamkpOwoKCXZhciBfZmlsZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2Myk7CgoJdmFyIF9maWxlczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlcyk7CgoJdmFyIF9ncm91cHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2NCk7CgoJdmFyIF9ncm91cHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzKTsKCgl2YXIgX2ltID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNjUpOwoKCXZhciBfaW0yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW0pOwoKCXZhciBfbXBpbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTY2KTsKCgl2YXIgX21waW0yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXBpbSk7CgoJdmFyIF9vYXV0aCA9IF9fd2VicGFja19yZXF1aXJlX18oMTY3KTsKCgl2YXIgX29hdXRoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX29hdXRoKTsKCgl2YXIgX3JlYWN0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oMTY4KTsKCgl2YXIgX3JlYWN0aW9uczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdGlvbnMpOwoKCXZhciBfcmVtaW5kZXJzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNjkpOwoKCXZhciBfcmVtaW5kZXJzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlbWluZGVycyk7CgoJdmFyIF9waW5zID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNzApOwoKCXZhciBfcGluczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9waW5zKTsKCgl2YXIgX3J0bSA9IF9fd2VicGFja19yZXF1aXJlX18oMTcxKTsKCgl2YXIgX3J0bTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ydG0pOwoKCXZhciBfcnRtMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTMwKTsKCgl2YXIgX3J0bTQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ydG0zKTsKCgl2YXIgX3NlYXJjaCA9IF9fd2VicGFja19yZXF1aXJlX18oMTczKTsKCgl2YXIgX3NlYXJjaDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZWFyY2gpOwoKCXZhciBfc3RhcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3NCk7CgoJdmFyIF9zdGFyczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdGFycyk7CgoJdmFyIF90ZWFtID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNzUpOwoKCXZhciBfdGVhbTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZWFtKTsKCgl2YXIgX3VzZXJncm91cHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3Nik7CgoJdmFyIF91c2VyZ3JvdXBzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJncm91cHMpOwoKCXZhciBfdXNlcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3Nyk7CgoJdmFyIF91c2VyczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2Vycyk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgl2YXIgZGVzY3JpYmUgPSAnXG4gIHNsYWNrXG4gICAgYXBpLmNsaWVudCh0b2tlbilcbiAgICBhcGkudGVzdChwYXJhbXMsIChlcnIsIGRhdGEpPT4pXG4gICAgYXV0aC50ZXN0KHRva2VuLCAoZXJyLCBkYXRhKT0+KVxuICAgIGJvdHMuaW5mb1xuICAgIGNoYW5uZWxzLmFyY2hpdmUoe3Rva2VuLCBjaGFubmVsfSwgKGVyciwgZGF0YSk9PilcbiAgICBjaGFubmVscy5jcmVhdGUoe3Rva2VuLCBuYW1lfSwgKGVyciwgZGF0YSk9PilcbiAgICBjaGFubmVscy5oaXN0b3J5KHt0b2tlbiwgY2hhbm5lbH0sIChlcnIsIGRhdGEpPT4pXG4gICAgY2hhbm5lbHMuaW5mb1xuICAgIGNoYW5uZWxzLmludml0ZVxuICAgIGNoYW5uZWxzLmpvaW5cbiAgICBjaGFubmVscy5raWNrXG4gICAgY2hhbm5lbHMubGVhdmVcbiAgICBjaGFubmVscy5saXN0KHt0b2tlbiwgZXhjbHVkZV9hcmNoaXZlZH0sIChlcnIsIGRhdGEpPT4pXG4gICAgY2hhbm5lbHMubWFya1xuICAgIGNoYW5uZWxzLnJlbmFtZVxuICAgIGNoYW5uZWxzLnNldFB1cnBvc2VcbiAgICBjaGFubmVscy5zZXRUb3BpY1xuICAgIGNoYW5uZWxzLnVuYXJjaGl2ZVxuICAgIGNoYXQuZGVsZXRlXG4gICAgY2hhdC5wb3N0TWVzc2FnZSh7dG9rZW4sIHRleHQsIGNoYW5uZWx9LCAoZXJyLCBkYXRhKT0+KVxuICAgIGNoYXQudXBkYXRlXG4gICAgZW1vamkubGlzdFxuICAgIGZpbGVzLmRlbGV0ZVxuICAgIGZpbGVzLmluZm9cbiAgICBmaWxlcy5saXN0XG4gICAgZmlsZXMudXBsb2FkXG4gICAgZ3JvdXBzLmFyY2hpdmVcbiAgICBncm91cHMuY2xvc2VcbiAgICBncm91cHMuY3JlYXRlXG4gICAgZ3JvdXBzLmNyZWF0ZUNoaWxkXG4gICAgZ3JvdXBzLmhpc3RvcnlcbiAgICBncm91cHMuaW5mb1xuICAgIGdyb3Vwcy5pbnZpdGVcbiAgICBncm91cHMua2lja1xuICAgIGdyb3Vwcy5sZWF2ZVxuICAgIGdyb3Vwcy5saXN0XG4gICAgZ3JvdXBzLm1hcmtcbiAgICBncm91cHMub3BlblxuICAgIGdyb3Vwcy5yZW5hbWVcbiAgICBncm91cHMuc2V0UHVycG9zZVxuICAgIGdyb3Vwcy5zZXRUb3BpY1xuICAgIGdyb3Vwcy51bmFyY2hpdmVcbiAgICBpbS5jbG9zZVxuICAgIGltLmhpc3RvcnlcbiAgICBpbS5saXN0XG4gICAgaW0ubWFya1xuICAgIGltLm9wZW5cbiAgICBtcGltLmNsb3NlXG4gICAgbXBpbS5oaXN0b3J5XG4gICAgbXBpbS5saXN0XG4gICAgbXBpbS5tYXJrXG4gICAgbXBpbS5vcGVuXG4gICAgb2F1dGguYWNjZXNzKHtjbGllbnRfaWQsIGNsaWVudF9zZWNyZXQsIGNvZGV9LCAoZXJyLCBkYXRhKT0+KVxuICAgIHBpbnMuYWRkXG4gICAgcGlucy5saXN0XG4gICAgcGlucy5yZW1vdmVcbiAgICByZWFjdGlvbnMuYWRkXG4gICAgcmVhY3Rpb25zLmdldFxuICAgIHJlYWN0aW9ucy5saXN0XG4gICAgcmVhY3Rpb25zLnJlbW92ZVxuICAgIHJlbWluZGVycy5hZGRcbiAgICByZW1pbmRlcnMuY29tcGxldGVcbiAgICByZW1pbmRlcnMuZGVsZXRlXG4gICAgcmVtaW5kZXJzLmluZm9cbiAgICByZW1pbmRlcnMubGlzdFxuICAgIHJ0bS5jbGllbnQoKVxuICAgIHJ0bS5zdGFydCh7dG9rZW59LCAoZXJyLCBkYXRhKT0+KVxuICAgIHNlYXJjaC5hbGxcbiAgICBzZWFyY2guZmlsZXNcbiAgICBzZWFyY2gubWVzc2FnZXNcbiAgICBzdGFycy5hZGRcbiAgICBzdGFycy5saXN0XG4gICAgc3RhcnMucmVtb3ZlXG4gICAgdGVhbS5hY2NjZXNzTG9nc1xuICAgIHRlYW0uYmlsbGFibGVJbmZvXG4gICAgdGVhbS5pbmZvKHRva2VuLCAoZXJyLCBkYXRhKT0+KVxuICAgIHRlYW0uaW50ZWdyYXRpb25Mb2dzXG4gICAgdGVhbS5wcm9maWxlLmdldFxuICAgIHVzZXJncm91cHMuY3JlYXRlXG4gICAgdXNlcmdyb3Vwcy5kaXNhYmxlXG4gICAgdXNlcmdyb3Vwcy5lbmFibGVcbiAgICB1c2VyZ3JvdXBzLmxpc3RcbiAgICB1c2VyZ3JvdXBzLnVwZGF0ZVxuICAgIHVzZXJncm91cHMudXNlcnMubGlzdFxuICAgIHVzZXJncm91cHMudXNlcnMudXBkYXRlXG4gICAgdXNlcnMuZ2V0UHJlc2VuY2VcbiAgICB1c2Vycy5pZGVudGl0eVxuICAgIHVzZXJzLmluZm9cbiAgICB1c2Vycy5saXN0KHRva2VuLCAoZXJyLCBkYXRhKT0+KVxuICAgIHVzZXJzLnNldEFjdGl2ZVxuICAgIHVzZXJzLnNldFByZXNlbmNlXG4nOwoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgZGVzY3JpYmU6IGRlc2NyaWJlLAoJICBhcGk6IHsgdGVzdDogX2FwaTIuZGVmYXVsdCwgY2xpZW50OiBfYXBpNC5kZWZhdWx0IH0sCgkgIGF1dGg6IHsgdGVzdDogX2F1dGgyLmRlZmF1bHQgfSwKCSAgYm90czogX2JvdHMyLmRlZmF1bHQsCgkgIGNoYW5uZWxzOiBfY2hhbm5lbHMyLmRlZmF1bHQsCgkgIGNoYXQ6IF9jaGF0Mi5kZWZhdWx0LAoJICBkbmQ6IF9kbmQyLmRlZmF1bHQsCgkgIGVtb2ppOiB7IGxpc3Q6IF9lbW9qaTIuZGVmYXVsdCB9LAoJICBmaWxlczogX2ZpbGVzMi5kZWZhdWx0LAoJICBncm91cHM6IF9ncm91cHMyLmRlZmF1bHQsCgkgIGltOiBfaW0yLmRlZmF1bHQsCgkgIG1waW06IF9tcGltMi5kZWZhdWx0LAoJICBvYXV0aDogeyBhY2Nlc3M6IF9vYXV0aDIuZGVmYXVsdCB9LAoJICByZWFjdGlvbnM6IF9yZWFjdGlvbnMyLmRlZmF1bHQsCgkgIHJlbWluZGVyczogX3JlbWluZGVyczIuZGVmYXVsdCwKCSAgcGluczogX3BpbnMyLmRlZmF1bHQsCgkgIHJ0bTogeyBjbGllbnQ6IF9ydG0yLmRlZmF1bHQsIHN0YXJ0OiBfcnRtNC5kZWZhdWx0IH0sCgkgIHNlYXJjaDogX3NlYXJjaDIuZGVmYXVsdCwKCSAgc3RhcnM6IF9zdGFyczIuZGVmYXVsdCwKCSAgdGVhbTogX3RlYW0yLmRlZmF1bHQsCgkgIHVzZXJncm91cHM6IF91c2VyZ3JvdXBzMi5kZWZhdWx0LAoJICB1c2VyczogX3VzZXJzMi5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGFwaXRlc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGFwaXRlc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnYXBpLnRlc3QnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07CgoJZXhwb3J0cy5kZWZhdWx0ID0gZXhlYzsKCgl2YXIgX3RpbnlKc29uSHR0cCA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7CgoJdmFyIF90aW55SnNvbkh0dHAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGlueUpzb25IdHRwKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWZ1bmN0aW9uIGV4ZWModXJsLCBmb3JtLCBjYWxsYmFjaykgewoKCSAgLy8gc3RyaW5naWZ5IGFueSBvYmplY3RzIHVuZGVyIGtleXMgc2luY2UgZm9ybSBpcyBwb3N0ZWQgYXMgYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkCgkgIE9iamVjdC5rZXlzKGZvcm0pLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewoJICAgIGlmIChfdHlwZW9mKGZvcm1ba2V5XSkgPT09ICdvYmplY3QnKSB7CgkgICAgICBmb3JtW2tleV0gPSBKU09OLnN0cmluZ2lmeShmb3JtW2tleV0pOwoJICAgIH0KCSAgfSk7CgoJICAvLyBhbHdheXMgcG9zdAoJICBfdGlueUpzb25IdHRwMi5kZWZhdWx0LnBvc3QoewoJICAgIHVybDogJ2h0dHBzOi8vc2xhY2suY29tL2FwaS8nICsgdXJsLAoJICAgIGhlYWRlcnM6IHsKCSAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJwoJICAgIH0sCgkgICAgZGF0YTogZm9ybQoJICB9LCBmdW5jdGlvbiBfcmVzKGVyciwgcmVzKSB7CgkgICAgLy8gdmFyIHJhdGVMaW1pdCA9ICdZb3UgYXJlIHNlbmRpbmcgdG9vIG1hbnkgcmVxdWVzdHMuIFBsZWFzZSByZWxheC4nCgkgICAgaWYgKHJlcykgcmVzID0gSlNPTi5wYXJzZShyZXMpOwoJICAgIGlmIChlcnIpIHsKCSAgICAgIC8vIGlmIHJlcXVlc3QgZmFpbGVkIGJ1YmJsZSB0aGUgZXJyb3IKCSAgICAgIGNhbGxiYWNrKGVycik7CgkgICAgfSBlbHNlIGlmIChyZXMuZXJyb3IpIHsKCSAgICAgIGNhbGxiYWNrKEVycm9yKHJlcy5lcnJvcikpOwoJICAgIH0gZWxzZSB7CgkgICAgICBjYWxsYmFjayhudWxsLCByZXMpOwoJICAgIH0KCSAgfSk7Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIF9nZXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCgl2YXIgX3Bvc3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KQoKCW1vZHVsZS5leHBvcnRzID0gewoJICBnZXQ6IF9nZXQsCgkgIHBvc3Q6IF9wb3N0LAoJfQoKCi8qKiovIH0sCi8qIDUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGh0dHAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCgl2YXIgaHR0cHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ4KQoJdmFyIHVybCA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBHRVQob3B0aW9ucywgY2FsbGJhY2spIHsKCgkgIC8vIHJlcXVpcmUgb3B0aW9ucy51cmwgb3IgZmFpbCBub2lzaWx5IAoJICBpZiAoIW9wdGlvbnMudXJsKSB7CgkgICAgdGhyb3cgRXJyb3IoJ29wdGlvbnMudXJsIHJlcXVpcmVkJykKCSAgfQoKCSAgLy8gcGFyc2Ugb3V0IHRoZSBvcHRpb25zIGZyb20gb3B0aW9ucy51cmwKCSAgdmFyIG9wdHMgPSB1cmwucGFyc2Uob3B0aW9ucy51cmwpCgkgIHZhciBtZXRob2QgPSBvcHRzLnByb3RvY29sID09PSAnaHR0cHM6Jz8gaHR0cHMuZ2V0IDogaHR0cC5nZXQKCgkgIG9wdHMucmVqZWN0VW5hdXRob3JpemVkID0gZmFsc2UKCSAgb3B0cy5hZ2VudCA9IGZhbHNlCgkgIG9wdHMuaGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycyB8fCB7fQoJICBvcHRzLmhlYWRlcnNbJ1VzZXItQWdlbnQnXSA9IG9wdHMuaGVhZGVyc1snVXNlci1BZ2VudCddIHx8ICd0aW55LWh0dHAnCgkgIG9wdHMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSBvcHRzLmhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddIHx8ICdhcHBsaWNhdGlvbi9qc29uJwoJICAKCSAgLy8gbWFrZSBhIHJlcXVlc3QKCSAgbWV0aG9kKG9wdHMsIGZ1bmN0aW9uIF9fcmVzKHJlcykgewoJICAgCgkgICAgdmFyIHJhd0RhdGEgPSAnJwoJICAgIHZhciBzdGF0dXNDb2RlID0gcmVzLnN0YXR1c0NvZGUKCSAgICB2YXIgY29udGVudFR5cGUgPSByZXMuaGVhZGVyc1snY29udGVudC10eXBlJ10KCSAgICB2YXIgaXNKU09OID0gY29udGVudFR5cGUuc3RhcnRzV2l0aCgnYXBwbGljYXRpb24vanNvbicpCgoJICAgIGlmIChzdGF0dXNDb2RlICE9PSAyMDApIHsKCSAgICAgIGNhbGxiYWNrKEVycm9yKCdHRVQgZmFpbGVkIHdpdGg6ICcgKyBzdGF0dXNDb2RlKSkKCSAgICAgIHJlcy5yZXN1bWUoKQoJICAgICAgcmV0dXJuCgkgICAgfQoJIAoJICAgIHJlcy5zZXRFbmNvZGluZygndXRmOCcpCgkgICAgcmVzLm9uKCdkYXRhJywgZnVuY3Rpb24oY2h1bmspIHtyYXdEYXRhICs9IGNodW5rfSkKCSAgICByZXMub24oJ2VuZCcsIGZ1bmN0aW9uKHgpIHsKCSAgICAgIHRyeSB7CgkgICAgICAgIHZhciBwYXJzZWREYXRhID0gaXNKU09OPyBKU09OLnBhcnNlKHJhd0RhdGEpIDogcmF3RGF0YQoJICAgICAgICBjYWxsYmFjayhudWxsLCBwYXJzZWREYXRhKQoJICAgICAgfSAKCSAgICAgIGNhdGNoIChlKSB7CgkgICAgICAgIGNhbGxiYWNrKGUubWVzc2FnZSkKCSAgICAgIH0KCSAgICB9KQoJICB9KS5vbignZXJyb3InLCBmdW5jdGlvbihlKSB7IGNhbGxiYWNrKEVycm9yKGUubWVzc2FnZSkpIH0gKQoJfQoKCi8qKiovIH0sCi8qIDYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCkge3ZhciBDbGllbnRSZXF1ZXN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KQoJdmFyIGV4dGVuZCA9IF9fd2VicGFja19yZXF1aXJlX18oMzkpCgl2YXIgc3RhdHVzQ29kZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKQoJdmFyIHVybCA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCgoJdmFyIGh0dHAgPSBleHBvcnRzCgoJaHR0cC5yZXF1ZXN0ID0gZnVuY3Rpb24gKG9wdHMsIGNiKSB7CgkJaWYgKHR5cGVvZiBvcHRzID09PSAnc3RyaW5nJykKCQkJb3B0cyA9IHVybC5wYXJzZShvcHRzKQoJCWVsc2UKCQkJb3B0cyA9IGV4dGVuZChvcHRzKQoKCQkvLyBOb3JtYWxseSwgdGhlIHBhZ2UgaXMgbG9hZGVkIGZyb20gaHR0cCBvciBodHRwcywgc28gbm90IHNwZWNpZnlpbmcgYSBwcm90b2NvbAoJCS8vIHdpbGwgcmVzdWx0IGluIGEgKHZhbGlkKSBwcm90b2NvbC1yZWxhdGl2ZSB1cmwuIEhvd2V2ZXIsIHRoaXMgd29uJ3Qgd29yayBpZgoJCS8vIHRoZSBwcm90b2NvbCBpcyBzb21ldGhpbmcgZWxzZSwgbGlrZSAnZmlsZTonCgkJdmFyIGRlZmF1bHRQcm90b2NvbCA9IGdsb2JhbC5sb2NhdGlvbi5wcm90b2NvbC5zZWFyY2goL15odHRwcz86JC8pID09PSAtMSA/ICdodHRwOicgOiAnJwoKCQl2YXIgcHJvdG9jb2wgPSBvcHRzLnByb3RvY29sIHx8IGRlZmF1bHRQcm90b2NvbAoJCXZhciBob3N0ID0gb3B0cy5ob3N0bmFtZSB8fCBvcHRzLmhvc3QKCQl2YXIgcG9ydCA9IG9wdHMucG9ydAoJCXZhciBwYXRoID0gb3B0cy5wYXRoIHx8ICcvJwoKCQkvLyBOZWNlc3NhcnkgZm9yIElQdjYgYWRkcmVzc2VzCgkJaWYgKGhvc3QgJiYgaG9zdC5pbmRleE9mKCc6JykgIT09IC0xKQoJCQlob3N0ID0gJ1snICsgaG9zdCArICddJwoKCQkvLyBUaGlzIG1heSBiZSBhIHJlbGF0aXZlIHVybC4gVGhlIGJyb3dzZXIgc2hvdWxkIGFsd2F5cyBiZSBhYmxlIHRvIGludGVycHJldCBpdCBjb3JyZWN0bHkuCgkJb3B0cy51cmwgPSAoaG9zdCA/IChwcm90b2NvbCArICcvLycgKyBob3N0KSA6ICcnKSArIChwb3J0ID8gJzonICsgcG9ydCA6ICcnKSArIHBhdGgKCQlvcHRzLm1ldGhvZCA9IChvcHRzLm1ldGhvZCB8fCAnR0VUJykudG9VcHBlckNhc2UoKQoJCW9wdHMuaGVhZGVycyA9IG9wdHMuaGVhZGVycyB8fCB7fQoKCQkvLyBBbHNvIHZhbGlkIG9wdHMuYXV0aCwgb3B0cy5tb2RlCgoJCXZhciByZXEgPSBuZXcgQ2xpZW50UmVxdWVzdChvcHRzKQoJCWlmIChjYikKCQkJcmVxLm9uKCdyZXNwb25zZScsIGNiKQoJCXJldHVybiByZXEKCX0KCglodHRwLmdldCA9IGZ1bmN0aW9uIGdldCAob3B0cywgY2IpIHsKCQl2YXIgcmVxID0gaHR0cC5yZXF1ZXN0KG9wdHMsIGNiKQoJCXJlcS5lbmQoKQoJCXJldHVybiByZXEKCX0KCglodHRwLkFnZW50ID0gZnVuY3Rpb24gKCkge30KCWh0dHAuQWdlbnQuZGVmYXVsdE1heFNvY2tldHMgPSA0CgoJaHR0cC5TVEFUVVNfQ09ERVMgPSBzdGF0dXNDb2RlcwoKCWh0dHAuTUVUSE9EUyA9IFsKCQknQ0hFQ0tPVVQnLAoJCSdDT05ORUNUJywKCQknQ09QWScsCgkJJ0RFTEVURScsCgkJJ0dFVCcsCgkJJ0hFQUQnLAoJCSdMT0NLJywKCQknTS1TRUFSQ0gnLAoJCSdNRVJHRScsCgkJJ01LQUNUSVZJVFknLAoJCSdNS0NPTCcsCgkJJ01PVkUnLAoJCSdOT1RJRlknLAoJCSdPUFRJT05TJywKCQknUEFUQ0gnLAoJCSdQT1NUJywKCQknUFJPUEZJTkQnLAoJCSdQUk9QUEFUQ0gnLAoJCSdQVVJHRScsCgkJJ1BVVCcsCgkJJ1JFUE9SVCcsCgkJJ1NFQVJDSCcsCgkJJ1NVQlNDUklCRScsCgkJJ1RSQUNFJywKCQknVU5MT0NLJywKCQknVU5TVUJTQ1JJQkUnCgldCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpCgovKioqLyB9LAovKiA3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIsIGdsb2JhbCwgcHJvY2Vzcykge3ZhciBjYXBhYmlsaXR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKCXZhciBpbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCgl2YXIgcmVzcG9uc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQoJdmFyIHN0cmVhbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCgl2YXIgdG9BcnJheUJ1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMzgpCgoJdmFyIEluY29taW5nTWVzc2FnZSA9IHJlc3BvbnNlLkluY29taW5nTWVzc2FnZQoJdmFyIHJTdGF0ZXMgPSByZXNwb25zZS5yZWFkeVN0YXRlcwoKCWZ1bmN0aW9uIGRlY2lkZU1vZGUgKHByZWZlckJpbmFyeSwgdXNlRmV0Y2gpIHsKCQlpZiAoY2FwYWJpbGl0eS5mZXRjaCAmJiB1c2VGZXRjaCkgewoJCQlyZXR1cm4gJ2ZldGNoJwoJCX0gZWxzZSBpZiAoY2FwYWJpbGl0eS5tb3pjaHVua2VkYXJyYXlidWZmZXIpIHsKCQkJcmV0dXJuICdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcicKCQl9IGVsc2UgaWYgKGNhcGFiaWxpdHkubXNzdHJlYW0pIHsKCQkJcmV0dXJuICdtcy1zdHJlYW0nCgkJfSBlbHNlIGlmIChjYXBhYmlsaXR5LmFycmF5YnVmZmVyICYmIHByZWZlckJpbmFyeSkgewoJCQlyZXR1cm4gJ2FycmF5YnVmZmVyJwoJCX0gZWxzZSBpZiAoY2FwYWJpbGl0eS52YkFycmF5ICYmIHByZWZlckJpbmFyeSkgewoJCQlyZXR1cm4gJ3RleHQ6dmJhcnJheScKCQl9IGVsc2UgewoJCQlyZXR1cm4gJ3RleHQnCgkJfQoJfQoKCXZhciBDbGllbnRSZXF1ZXN0ID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob3B0cykgewoJCXZhciBzZWxmID0gdGhpcwoJCXN0cmVhbS5Xcml0YWJsZS5jYWxsKHNlbGYpCgoJCXNlbGYuX29wdHMgPSBvcHRzCgkJc2VsZi5fYm9keSA9IFtdCgkJc2VsZi5faGVhZGVycyA9IHt9CgkJaWYgKG9wdHMuYXV0aCkKCQkJc2VsZi5zZXRIZWFkZXIoJ0F1dGhvcml6YXRpb24nLCAnQmFzaWMgJyArIG5ldyBCdWZmZXIob3B0cy5hdXRoKS50b1N0cmluZygnYmFzZTY0JykpCgkJT2JqZWN0LmtleXMob3B0cy5oZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CgkJCXNlbGYuc2V0SGVhZGVyKG5hbWUsIG9wdHMuaGVhZGVyc1tuYW1lXSkKCQl9KQoKCQl2YXIgcHJlZmVyQmluYXJ5CgkJdmFyIHVzZUZldGNoID0gdHJ1ZQoJCWlmIChvcHRzLm1vZGUgPT09ICdkaXNhYmxlLWZldGNoJyB8fCAndGltZW91dCcgaW4gb3B0cykgewoJCQkvLyBJZiB0aGUgdXNlIG9mIFhIUiBzaG91bGQgYmUgcHJlZmVycmVkIGFuZCBpbmNsdWRlcyBwcmVzZXJ2aW5nIHRoZSAnY29udGVudC10eXBlJyBoZWFkZXIuCgkJCS8vIEZvcmNlIFhIUiB0byBiZSB1c2VkIHNpbmNlIHRoZSBGZXRjaCBBUEkgZG9lcyBub3QgeWV0IHN1cHBvcnQgdGltZW91dHMuCgkJCXVzZUZldGNoID0gZmFsc2UKCQkJcHJlZmVyQmluYXJ5ID0gdHJ1ZQoJCX0gZWxzZSBpZiAob3B0cy5tb2RlID09PSAncHJlZmVyLXN0cmVhbWluZycpIHsKCQkJLy8gSWYgc3RyZWFtaW5nIGlzIGEgaGlnaCBwcmlvcml0eSBidXQgYmluYXJ5IGNvbXBhdGliaWxpdHkgYW5kCgkJCS8vIHRoZSBhY2N1cmFjeSBvZiB0aGUgJ2NvbnRlbnQtdHlwZScgaGVhZGVyIGFyZW4ndAoJCQlwcmVmZXJCaW5hcnkgPSBmYWxzZQoJCX0gZWxzZSBpZiAob3B0cy5tb2RlID09PSAnYWxsb3ctd3JvbmctY29udGVudC10eXBlJykgewoJCQkvLyBJZiBzdHJlYW1pbmcgaXMgbW9yZSBpbXBvcnRhbnQgdGhhbiBwcmVzZXJ2aW5nIHRoZSAnY29udGVudC10eXBlJyBoZWFkZXIKCQkJcHJlZmVyQmluYXJ5ID0gIWNhcGFiaWxpdHkub3ZlcnJpZGVNaW1lVHlwZQoJCX0gZWxzZSBpZiAoIW9wdHMubW9kZSB8fCBvcHRzLm1vZGUgPT09ICdkZWZhdWx0JyB8fCBvcHRzLm1vZGUgPT09ICdwcmVmZXItZmFzdCcpIHsKCQkJLy8gVXNlIGJpbmFyeSBpZiB0ZXh0IHN0cmVhbWluZyBtYXkgY29ycnVwdCBkYXRhIG9yIHRoZSBjb250ZW50LXR5cGUgaGVhZGVyLCBvciBmb3Igc3BlZWQKCQkJcHJlZmVyQmluYXJ5ID0gdHJ1ZQoJCX0gZWxzZSB7CgkJCXRocm93IG5ldyBFcnJvcignSW52YWxpZCB2YWx1ZSBmb3Igb3B0cy5tb2RlJykKCQl9CgkJc2VsZi5fbW9kZSA9IGRlY2lkZU1vZGUocHJlZmVyQmluYXJ5LCB1c2VGZXRjaCkKCgkJc2VsZi5vbignZmluaXNoJywgZnVuY3Rpb24gKCkgewoJCQlzZWxmLl9vbkZpbmlzaCgpCgkJfSkKCX0KCglpbmhlcml0cyhDbGllbnRSZXF1ZXN0LCBzdHJlYW0uV3JpdGFibGUpCgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuc2V0SGVhZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJdmFyIGxvd2VyTmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKQoJCS8vIFRoaXMgY2hlY2sgaXMgbm90IG5lY2Vzc2FyeSwgYnV0IGl0IHByZXZlbnRzIHdhcm5pbmdzIGZyb20gYnJvd3NlcnMgYWJvdXQgc2V0dGluZyB1bnNhZmUKCQkvLyBoZWFkZXJzLiBUbyBiZSBob25lc3QgSSdtIG5vdCBlbnRpcmVseSBzdXJlIGhpZGluZyB0aGVzZSB3YXJuaW5ncyBpcyBhIGdvb2QgdGhpbmcsIGJ1dAoJCS8vIGh0dHAtYnJvd3NlcmlmeSBkaWQgaXQsIHNvIEkgd2lsbCB0b28uCgkJaWYgKHVuc2FmZUhlYWRlcnMuaW5kZXhPZihsb3dlck5hbWUpICE9PSAtMSkKCQkJcmV0dXJuCgoJCXNlbGYuX2hlYWRlcnNbbG93ZXJOYW1lXSA9IHsKCQkJbmFtZTogbmFtZSwKCQkJdmFsdWU6IHZhbHVlCgkJfQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLmdldEhlYWRlciA9IGZ1bmN0aW9uIChuYW1lKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJcmV0dXJuIHNlbGYuX2hlYWRlcnNbbmFtZS50b0xvd2VyQ2FzZSgpXS52YWx1ZQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLnJlbW92ZUhlYWRlciA9IGZ1bmN0aW9uIChuYW1lKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJZGVsZXRlIHNlbGYuX2hlYWRlcnNbbmFtZS50b0xvd2VyQ2FzZSgpXQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLl9vbkZpbmlzaCA9IGZ1bmN0aW9uICgpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCgkJaWYgKHNlbGYuX2Rlc3Ryb3llZCkKCQkJcmV0dXJuCgkJdmFyIG9wdHMgPSBzZWxmLl9vcHRzCgoJCXZhciBoZWFkZXJzT2JqID0gc2VsZi5faGVhZGVycwoJCXZhciBib2R5ID0gbnVsbAoJCWlmIChvcHRzLm1ldGhvZCA9PT0gJ1BPU1QnIHx8IG9wdHMubWV0aG9kID09PSAnUFVUJyB8fCBvcHRzLm1ldGhvZCA9PT0gJ1BBVENIJyB8fCBvcHRzLm1ldGhvZCA9PT0gJ01FUkdFJykgewoJCQlpZiAoY2FwYWJpbGl0eS5ibG9iQ29uc3RydWN0b3IpIHsKCQkJCWJvZHkgPSBuZXcgZ2xvYmFsLkJsb2Ioc2VsZi5fYm9keS5tYXAoZnVuY3Rpb24gKGJ1ZmZlcikgewoJCQkJCXJldHVybiB0b0FycmF5QnVmZmVyKGJ1ZmZlcikKCQkJCX0pLCB7CgkJCQkJdHlwZTogKGhlYWRlcnNPYmpbJ2NvbnRlbnQtdHlwZSddIHx8IHt9KS52YWx1ZSB8fCAnJwoJCQkJfSkKCQkJfSBlbHNlIHsKCQkJCS8vIGdldCB1dGY4IHN0cmluZwoJCQkJYm9keSA9IEJ1ZmZlci5jb25jYXQoc2VsZi5fYm9keSkudG9TdHJpbmcoKQoJCQl9CgkJfQoKCQlpZiAoc2VsZi5fbW9kZSA9PT0gJ2ZldGNoJykgewoJCQl2YXIgaGVhZGVycyA9IE9iamVjdC5rZXlzKGhlYWRlcnNPYmopLm1hcChmdW5jdGlvbiAobmFtZSkgewoJCQkJcmV0dXJuIFtoZWFkZXJzT2JqW25hbWVdLm5hbWUsIGhlYWRlcnNPYmpbbmFtZV0udmFsdWVdCgkJCX0pCgoJCQlnbG9iYWwuZmV0Y2goc2VsZi5fb3B0cy51cmwsIHsKCQkJCW1ldGhvZDogc2VsZi5fb3B0cy5tZXRob2QsCgkJCQloZWFkZXJzOiBoZWFkZXJzLAoJCQkJYm9keTogYm9keSB8fCB1bmRlZmluZWQsCgkJCQltb2RlOiAnY29ycycsCgkJCQljcmVkZW50aWFsczogb3B0cy53aXRoQ3JlZGVudGlhbHMgPyAnaW5jbHVkZScgOiAnc2FtZS1vcmlnaW4nCgkJCX0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CgkJCQlzZWxmLl9mZXRjaFJlc3BvbnNlID0gcmVzcG9uc2UKCQkJCXNlbGYuX2Nvbm5lY3QoKQoJCQl9LCBmdW5jdGlvbiAocmVhc29uKSB7CgkJCQlzZWxmLmVtaXQoJ2Vycm9yJywgcmVhc29uKQoJCQl9KQoJCX0gZWxzZSB7CgkJCXZhciB4aHIgPSBzZWxmLl94aHIgPSBuZXcgZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0KCkKCQkJdHJ5IHsKCQkJCXhoci5vcGVuKHNlbGYuX29wdHMubWV0aG9kLCBzZWxmLl9vcHRzLnVybCwgdHJ1ZSkKCQkJfSBjYXRjaCAoZXJyKSB7CgkJCQlwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsKCQkJCQlzZWxmLmVtaXQoJ2Vycm9yJywgZXJyKQoJCQkJfSkKCQkJCXJldHVybgoJCQl9CgoJCQkvLyBDYW4ndCBzZXQgcmVzcG9uc2VUeXBlIG9uIHJlYWxseSBvbGQgYnJvd3NlcnMKCQkJaWYgKCdyZXNwb25zZVR5cGUnIGluIHhocikKCQkJCXhoci5yZXNwb25zZVR5cGUgPSBzZWxmLl9tb2RlLnNwbGl0KCc6JylbMF0KCgkJCWlmICgnd2l0aENyZWRlbnRpYWxzJyBpbiB4aHIpCgkJCQl4aHIud2l0aENyZWRlbnRpYWxzID0gISFvcHRzLndpdGhDcmVkZW50aWFscwoKCQkJaWYgKHNlbGYuX21vZGUgPT09ICd0ZXh0JyAmJiAnb3ZlcnJpZGVNaW1lVHlwZScgaW4geGhyKQoJCQkJeGhyLm92ZXJyaWRlTWltZVR5cGUoJ3RleHQvcGxhaW47IGNoYXJzZXQ9eC11c2VyLWRlZmluZWQnKQoKCQkJaWYgKCd0aW1lb3V0JyBpbiBvcHRzKSB7CgkJCQl4aHIudGltZW91dCA9IG9wdHMudGltZW91dAoJCQkJeGhyLm9udGltZW91dCA9IGZ1bmN0aW9uICgpIHsKCQkJCQlzZWxmLmVtaXQoJ3RpbWVvdXQnKQoJCQkJfQoJCQl9CgoJCQlPYmplY3Qua2V5cyhoZWFkZXJzT2JqKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CgkJCQl4aHIuc2V0UmVxdWVzdEhlYWRlcihoZWFkZXJzT2JqW25hbWVdLm5hbWUsIGhlYWRlcnNPYmpbbmFtZV0udmFsdWUpCgkJCX0pCgoJCQlzZWxmLl9yZXNwb25zZSA9IG51bGwKCQkJeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKCQkJCXN3aXRjaCAoeGhyLnJlYWR5U3RhdGUpIHsKCQkJCQljYXNlIHJTdGF0ZXMuTE9BRElORzoKCQkJCQljYXNlIHJTdGF0ZXMuRE9ORToKCQkJCQkJc2VsZi5fb25YSFJQcm9ncmVzcygpCgkJCQkJCWJyZWFrCgkJCQl9CgkJCX0KCQkJLy8gTmVjZXNzYXJ5IGZvciBzdHJlYW1pbmcgaW4gRmlyZWZveCwgc2luY2UgeGhyLnJlc3BvbnNlIGlzIE9OTFkgZGVmaW5lZAoJCQkvLyBpbiBvbnByb2dyZXNzLCBub3QgaW4gb25yZWFkeXN0YXRlY2hhbmdlIHdpdGggeGhyLnJlYWR5U3RhdGUgPSAzCgkJCWlmIChzZWxmLl9tb2RlID09PSAnbW96LWNodW5rZWQtYXJyYXlidWZmZXInKSB7CgkJCQl4aHIub25wcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHsKCQkJCQlzZWxmLl9vblhIUlByb2dyZXNzKCkKCQkJCX0KCQkJfQoKCQkJeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7CgkJCQlpZiAoc2VsZi5fZGVzdHJveWVkKQoJCQkJCXJldHVybgoJCQkJc2VsZi5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignWEhSIGVycm9yJykpCgkJCX0KCgkJCXRyeSB7CgkJCQl4aHIuc2VuZChib2R5KQoJCQl9IGNhdGNoIChlcnIpIHsKCQkJCXByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gKCkgewoJCQkJCXNlbGYuZW1pdCgnZXJyb3InLCBlcnIpCgkJCQl9KQoJCQkJcmV0dXJuCgkJCX0KCQl9Cgl9CgoJLyoqCgkgKiBDaGVja3MgaWYgeGhyLnN0YXR1cyBpcyByZWFkYWJsZSBhbmQgbm9uLXplcm8sIGluZGljYXRpbmcgbm8gZXJyb3IuCgkgKiBFdmVuIHRob3VnaCB0aGUgc3BlYyBzYXlzIGl0IHNob3VsZCBiZSBhdmFpbGFibGUgaW4gcmVhZHlTdGF0ZSAzLAoJICogYWNjZXNzaW5nIGl0IHRocm93cyBhbiBleGNlcHRpb24gaW4gSUU4CgkgKi8KCWZ1bmN0aW9uIHN0YXR1c1ZhbGlkICh4aHIpIHsKCQl0cnkgewoJCQl2YXIgc3RhdHVzID0geGhyLnN0YXR1cwoJCQlyZXR1cm4gKHN0YXR1cyAhPT0gbnVsbCAmJiBzdGF0dXMgIT09IDApCgkJfSBjYXRjaCAoZSkgewoJCQlyZXR1cm4gZmFsc2UKCQl9Cgl9CgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuX29uWEhSUHJvZ3Jlc3MgPSBmdW5jdGlvbiAoKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgoJCWlmICghc3RhdHVzVmFsaWQoc2VsZi5feGhyKSB8fCBzZWxmLl9kZXN0cm95ZWQpCgkJCXJldHVybgoKCQlpZiAoIXNlbGYuX3Jlc3BvbnNlKQoJCQlzZWxmLl9jb25uZWN0KCkKCgkJc2VsZi5fcmVzcG9uc2UuX29uWEhSUHJvZ3Jlc3MoKQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLl9jb25uZWN0ID0gZnVuY3Rpb24gKCkgewoJCXZhciBzZWxmID0gdGhpcwoKCQlpZiAoc2VsZi5fZGVzdHJveWVkKQoJCQlyZXR1cm4KCgkJc2VsZi5fcmVzcG9uc2UgPSBuZXcgSW5jb21pbmdNZXNzYWdlKHNlbGYuX3hociwgc2VsZi5fZmV0Y2hSZXNwb25zZSwgc2VsZi5fbW9kZSkKCQlzZWxmLl9yZXNwb25zZS5vbignZXJyb3InLCBmdW5jdGlvbihlcnIpIHsKCQkJc2VsZi5lbWl0KCdlcnJvcicsIGVycikKCQl9KQoKCQlzZWxmLmVtaXQoJ3Jlc3BvbnNlJywgc2VsZi5fcmVzcG9uc2UpCgl9CgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuX3dyaXRlID0gZnVuY3Rpb24gKGNodW5rLCBlbmNvZGluZywgY2IpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCgkJc2VsZi5fYm9keS5wdXNoKGNodW5rKQoJCWNiKCkKCX0KCglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5hYm9ydCA9IENsaWVudFJlcXVlc3QucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJc2VsZi5fZGVzdHJveWVkID0gdHJ1ZQoJCWlmIChzZWxmLl9yZXNwb25zZSkKCQkJc2VsZi5fcmVzcG9uc2UuX2Rlc3Ryb3llZCA9IHRydWUKCQlpZiAoc2VsZi5feGhyKQoJCQlzZWxmLl94aHIuYWJvcnQoKQoJCS8vIEN1cnJlbnRseSwgdGhlcmUgaXNuJ3QgYSB3YXkgdG8gdHJ1bHkgYWJvcnQgYSBmZXRjaC4KCQkvLyBJZiB5b3UgbGlrZSBiaWtlc2hlZGRpbmcsIHNlZSBodHRwczovL2dpdGh1Yi5jb20vd2hhdHdnL2ZldGNoL2lzc3Vlcy8yNwoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uIChkYXRhLCBlbmNvZGluZywgY2IpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCQlpZiAodHlwZW9mIGRhdGEgPT09ICdmdW5jdGlvbicpIHsKCQkJY2IgPSBkYXRhCgkJCWRhdGEgPSB1bmRlZmluZWQKCQl9CgoJCXN0cmVhbS5Xcml0YWJsZS5wcm90b3R5cGUuZW5kLmNhbGwoc2VsZiwgZGF0YSwgZW5jb2RpbmcsIGNiKQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLmZsdXNoSGVhZGVycyA9IGZ1bmN0aW9uICgpIHt9CglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5zZXRUaW1lb3V0ID0gZnVuY3Rpb24gKCkge30KCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLnNldE5vRGVsYXkgPSBmdW5jdGlvbiAoKSB7fQoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuc2V0U29ja2V0S2VlcEFsaXZlID0gZnVuY3Rpb24gKCkge30KCgkvLyBUYWtlbiBmcm9tIGh0dHA6Ly93d3cudzMub3JnL1RSL1hNTEh0dHBSZXF1ZXN0LyN0aGUtc2V0cmVxdWVzdGhlYWRlciUyOCUyOS1tZXRob2QKCXZhciB1bnNhZmVIZWFkZXJzID0gWwoJCSdhY2NlcHQtY2hhcnNldCcsCgkJJ2FjY2VwdC1lbmNvZGluZycsCgkJJ2FjY2Vzcy1jb250cm9sLXJlcXVlc3QtaGVhZGVycycsCgkJJ2FjY2Vzcy1jb250cm9sLXJlcXVlc3QtbWV0aG9kJywKCQknY29ubmVjdGlvbicsCgkJJ2NvbnRlbnQtbGVuZ3RoJywKCQknY29va2llJywKCQknY29va2llMicsCgkJJ2RhdGUnLAoJCSdkbnQnLAoJCSdleHBlY3QnLAoJCSdob3N0JywKCQkna2VlcC1hbGl2ZScsCgkJJ29yaWdpbicsCgkJJ3JlZmVyZXInLAoJCSd0ZScsCgkJJ3RyYWlsZXInLAoJCSd0cmFuc2Zlci1lbmNvZGluZycsCgkJJ3VwZ3JhZGUnLAoJCSd1c2VyLWFnZW50JywKCQkndmlhJwoJXQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpLkJ1ZmZlciwgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSwgX193ZWJwYWNrX3JlcXVpcmVfXygxMikpKQoKLyoqKi8gfSwKLyogOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7LyohCgkgKiBUaGUgYnVmZmVyIG1vZHVsZSBmcm9tIG5vZGUuanMsIGZvciB0aGUgYnJvd3Nlci4KCSAqCgkgKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8ZmVyb3NzQGZlcm9zcy5vcmc+IDxodHRwOi8vZmVyb3NzLm9yZz4KCSAqIEBsaWNlbnNlICBNSVQKCSAqLwoJLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi8KCgkndXNlIHN0cmljdCcKCgl2YXIgYmFzZTY0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KQoJdmFyIGllZWU3NTQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKQoJdmFyIGlzQXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKQoKCWV4cG9ydHMuQnVmZmVyID0gQnVmZmVyCglleHBvcnRzLlNsb3dCdWZmZXIgPSBTbG93QnVmZmVyCglleHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTID0gNTAKCgkvKioKCSAqIElmIGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGA6CgkgKiAgID09PSB0cnVlICAgIFVzZSBVaW50OEFycmF5IGltcGxlbWVudGF0aW9uIChmYXN0ZXN0KQoJICogICA9PT0gZmFsc2UgICBVc2UgT2JqZWN0IGltcGxlbWVudGF0aW9uIChtb3N0IGNvbXBhdGlibGUsIGV2ZW4gSUU2KQoJICoKCSAqIEJyb3dzZXJzIHRoYXQgc3VwcG9ydCB0eXBlZCBhcnJheXMgYXJlIElFIDEwKywgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBTYWZhcmkgNS4xKywKCSAqIE9wZXJhIDExLjYrLCBpT1MgNC4yKy4KCSAqCgkgKiBEdWUgdG8gdmFyaW91cyBicm93c2VyIGJ1Z3MsIHNvbWV0aW1lcyB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uIHdpbGwgYmUgdXNlZCBldmVuCgkgKiB3aGVuIHRoZSBicm93c2VyIHN1cHBvcnRzIHR5cGVkIGFycmF5cy4KCSAqCgkgKiBOb3RlOgoJICoKCSAqICAgLSBGaXJlZm94IDQtMjkgbGFja3Mgc3VwcG9ydCBmb3IgYWRkaW5nIG5ldyBwcm9wZXJ0aWVzIHRvIGBVaW50OEFycmF5YCBpbnN0YW5jZXMsCgkgKiAgICAgU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02OTU0MzguCgkgKgoJICogICAtIENocm9tZSA5LTEwIGlzIG1pc3NpbmcgdGhlIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24uCgkgKgoJICogICAtIElFMTAgaGFzIGEgYnJva2VuIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhcnJheXMgb2YKCSAqICAgICBpbmNvcnJlY3QgbGVuZ3RoIGluIHNvbWUgc2l0dWF0aW9ucy4KCgkgKiBXZSBkZXRlY3QgdGhlc2UgYnVnZ3kgYnJvd3NlcnMgYW5kIHNldCBgQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRgIHRvIGBmYWxzZWAgc28gdGhleQoJICogZ2V0IHRoZSBPYmplY3QgaW1wbGVtZW50YXRpb24sIHdoaWNoIGlzIHNsb3dlciBidXQgYmVoYXZlcyBjb3JyZWN0bHkuCgkgKi8KCUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUID0gZ2xvYmFsLlRZUEVEX0FSUkFZX1NVUFBPUlQgIT09IHVuZGVmaW5lZAoJICA/IGdsb2JhbC5UWVBFRF9BUlJBWV9TVVBQT1JUCgkgIDogdHlwZWRBcnJheVN1cHBvcnQoKQoKCS8qCgkgKiBFeHBvcnQga01heExlbmd0aCBhZnRlciB0eXBlZCBhcnJheSBzdXBwb3J0IGlzIGRldGVybWluZWQuCgkgKi8KCWV4cG9ydHMua01heExlbmd0aCA9IGtNYXhMZW5ndGgoKQoKCWZ1bmN0aW9uIHR5cGVkQXJyYXlTdXBwb3J0ICgpIHsKCSAgdHJ5IHsKCSAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMSkKCSAgICBhcnIuX19wcm90b19fID0ge19fcHJvdG9fXzogVWludDhBcnJheS5wcm90b3R5cGUsIGZvbzogZnVuY3Rpb24gKCkgeyByZXR1cm4gNDIgfX0KCSAgICByZXR1cm4gYXJyLmZvbygpID09PSA0MiAmJiAvLyB0eXBlZCBhcnJheSBpbnN0YW5jZXMgY2FuIGJlIGF1Z21lbnRlZAoJICAgICAgICB0eXBlb2YgYXJyLnN1YmFycmF5ID09PSAnZnVuY3Rpb24nICYmIC8vIGNocm9tZSA5LTEwIGxhY2sgYHN1YmFycmF5YAoJICAgICAgICBhcnIuc3ViYXJyYXkoMSwgMSkuYnl0ZUxlbmd0aCA9PT0gMCAvLyBpZTEwIGhhcyBicm9rZW4gYHN1YmFycmF5YAoJICB9IGNhdGNoIChlKSB7CgkgICAgcmV0dXJuIGZhbHNlCgkgIH0KCX0KCglmdW5jdGlvbiBrTWF4TGVuZ3RoICgpIHsKCSAgcmV0dXJuIEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUCgkgICAgPyAweDdmZmZmZmZmCgkgICAgOiAweDNmZmZmZmZmCgl9CgoJZnVuY3Rpb24gY3JlYXRlQnVmZmVyICh0aGF0LCBsZW5ndGgpIHsKCSAgaWYgKGtNYXhMZW5ndGgoKSA8IGxlbmd0aCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHR5cGVkIGFycmF5IGxlbmd0aCcpCgkgIH0KCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlCgkgICAgdGhhdCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCkKCSAgICB0aGF0Ll9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGUKCSAgfSBlbHNlIHsKCSAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzCgkgICAgaWYgKHRoYXQgPT09IG51bGwpIHsKCSAgICAgIHRoYXQgPSBuZXcgQnVmZmVyKGxlbmd0aCkKCSAgICB9CgkgICAgdGhhdC5sZW5ndGggPSBsZW5ndGgKCSAgfQoKCSAgcmV0dXJuIHRoYXQKCX0KCgkvKioKCSAqIFRoZSBCdWZmZXIgY29uc3RydWN0b3IgcmV0dXJucyBpbnN0YW5jZXMgb2YgYFVpbnQ4QXJyYXlgIHRoYXQgaGF2ZSB0aGVpcgoJICogcHJvdG90eXBlIGNoYW5nZWQgdG8gYEJ1ZmZlci5wcm90b3R5cGVgLiBGdXJ0aGVybW9yZSwgYEJ1ZmZlcmAgaXMgYSBzdWJjbGFzcyBvZgoJICogYFVpbnQ4QXJyYXlgLCBzbyB0aGUgcmV0dXJuZWQgaW5zdGFuY2VzIHdpbGwgaGF2ZSBhbGwgdGhlIG5vZGUgYEJ1ZmZlcmAgbWV0aG9kcwoJICogYW5kIHRoZSBgVWludDhBcnJheWAgbWV0aG9kcy4gU3F1YXJlIGJyYWNrZXQgbm90YXRpb24gd29ya3MgYXMgZXhwZWN0ZWQgLS0gaXQKCSAqIHJldHVybnMgYSBzaW5nbGUgb2N0ZXQuCgkgKgoJICogVGhlIGBVaW50OEFycmF5YCBwcm90b3R5cGUgcmVtYWlucyB1bm1vZGlmaWVkLgoJICovCgoJZnVuY3Rpb24gQnVmZmVyIChhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkgewoJICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmICEodGhpcyBpbnN0YW5jZW9mIEJ1ZmZlcikpIHsKCSAgICByZXR1cm4gbmV3IEJ1ZmZlcihhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkKCSAgfQoKCSAgLy8gQ29tbW9uIGNhc2UuCgkgIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykgewoJICAgIGlmICh0eXBlb2YgZW5jb2RpbmdPck9mZnNldCA9PT0gJ3N0cmluZycpIHsKCSAgICAgIHRocm93IG5ldyBFcnJvcigKCSAgICAgICAgJ0lmIGVuY29kaW5nIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nJwoJICAgICAgKQoJICAgIH0KCSAgICByZXR1cm4gYWxsb2NVbnNhZmUodGhpcywgYXJnKQoJICB9CgkgIHJldHVybiBmcm9tKHRoaXMsIGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKQoJfQoKCUJ1ZmZlci5wb29sU2l6ZSA9IDgxOTIgLy8gbm90IHVzZWQgYnkgdGhpcyBpbXBsZW1lbnRhdGlvbgoKCS8vIFRPRE86IExlZ2FjeSwgbm90IG5lZWRlZCBhbnltb3JlLiBSZW1vdmUgaW4gbmV4dCBtYWpvciB2ZXJzaW9uLgoJQnVmZmVyLl9hdWdtZW50ID0gZnVuY3Rpb24gKGFycikgewoJICBhcnIuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZQoJICByZXR1cm4gYXJyCgl9CgoJZnVuY3Rpb24gZnJvbSAodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkgewoJICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyJ2YWx1ZSIgYXJndW1lbnQgbXVzdCBub3QgYmUgYSBudW1iZXInKQoJICB9CgoJICBpZiAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7CgkgICAgcmV0dXJuIGZyb21BcnJheUJ1ZmZlcih0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKQoJICB9CgoJICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgewoJICAgIHJldHVybiBmcm9tU3RyaW5nKHRoYXQsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0KQoJICB9CgoJICByZXR1cm4gZnJvbU9iamVjdCh0aGF0LCB2YWx1ZSkKCX0KCgkvKioKCSAqIEZ1bmN0aW9uYWxseSBlcXVpdmFsZW50IHRvIEJ1ZmZlcihhcmcsIGVuY29kaW5nKSBidXQgdGhyb3dzIGEgVHlwZUVycm9yCgkgKiBpZiB2YWx1ZSBpcyBhIG51bWJlci4KCSAqIEJ1ZmZlci5mcm9tKHN0clssIGVuY29kaW5nXSkKCSAqIEJ1ZmZlci5mcm9tKGFycmF5KQoJICogQnVmZmVyLmZyb20oYnVmZmVyKQoJICogQnVmZmVyLmZyb20oYXJyYXlCdWZmZXJbLCBieXRlT2Zmc2V0WywgbGVuZ3RoXV0pCgkgKiovCglCdWZmZXIuZnJvbSA9IGZ1bmN0aW9uICh2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBmcm9tKG51bGwsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpCgl9CgoJaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgIEJ1ZmZlci5wcm90b3R5cGUuX19wcm90b19fID0gVWludDhBcnJheS5wcm90b3R5cGUKCSAgQnVmZmVyLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXkKCSAgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC5zcGVjaWVzICYmCgkgICAgICBCdWZmZXJbU3ltYm9sLnNwZWNpZXNdID09PSBCdWZmZXIpIHsKCSAgICAvLyBGaXggc3ViYXJyYXkoKSBpbiBFUzIwMTYuIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2Zlcm9zcy9idWZmZXIvcHVsbC85NwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWZmZXIsIFN5bWJvbC5zcGVjaWVzLCB7CgkgICAgICB2YWx1ZTogbnVsbCwKCSAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQoJICAgIH0pCgkgIH0KCX0KCglmdW5jdGlvbiBhc3NlcnRTaXplIChzaXplKSB7CgkgIGlmICh0eXBlb2Ygc2l6ZSAhPT0gJ251bWJlcicpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcic2l6ZSIgYXJndW1lbnQgbXVzdCBiZSBhIG51bWJlcicpCgkgIH0gZWxzZSBpZiAoc2l6ZSA8IDApIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignInNpemUiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG5lZ2F0aXZlJykKCSAgfQoJfQoKCWZ1bmN0aW9uIGFsbG9jICh0aGF0LCBzaXplLCBmaWxsLCBlbmNvZGluZykgewoJICBhc3NlcnRTaXplKHNpemUpCgkgIGlmIChzaXplIDw9IDApIHsKCSAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpCgkgIH0KCSAgaWYgKGZpbGwgIT09IHVuZGVmaW5lZCkgewoJICAgIC8vIE9ubHkgcGF5IGF0dGVudGlvbiB0byBlbmNvZGluZyBpZiBpdCdzIGEgc3RyaW5nLiBUaGlzCgkgICAgLy8gcHJldmVudHMgYWNjaWRlbnRhbGx5IHNlbmRpbmcgaW4gYSBudW1iZXIgdGhhdCB3b3VsZAoJICAgIC8vIGJlIGludGVycHJldHRlZCBhcyBhIHN0YXJ0IG9mZnNldC4KCSAgICByZXR1cm4gdHlwZW9mIGVuY29kaW5nID09PSAnc3RyaW5nJwoJICAgICAgPyBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkuZmlsbChmaWxsLCBlbmNvZGluZykKCSAgICAgIDogY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpLmZpbGwoZmlsbCkKCSAgfQoJICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpCgl9CgoJLyoqCgkgKiBDcmVhdGVzIGEgbmV3IGZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuCgkgKiBhbGxvYyhzaXplWywgZmlsbFssIGVuY29kaW5nXV0pCgkgKiovCglCdWZmZXIuYWxsb2MgPSBmdW5jdGlvbiAoc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHsKCSAgcmV0dXJuIGFsbG9jKG51bGwsIHNpemUsIGZpbGwsIGVuY29kaW5nKQoJfQoKCWZ1bmN0aW9uIGFsbG9jVW5zYWZlICh0aGF0LCBzaXplKSB7CgkgIGFzc2VydFNpemUoc2l6ZSkKCSAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplIDwgMCA/IDAgOiBjaGVja2VkKHNpemUpIHwgMCkKCSAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgKytpKSB7CgkgICAgICB0aGF0W2ldID0gMAoJICAgIH0KCSAgfQoJICByZXR1cm4gdGhhdAoJfQoKCS8qKgoJICogRXF1aXZhbGVudCB0byBCdWZmZXIobnVtKSwgYnkgZGVmYXVsdCBjcmVhdGVzIGEgbm9uLXplcm8tZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS4KCSAqICovCglCdWZmZXIuYWxsb2NVbnNhZmUgPSBmdW5jdGlvbiAoc2l6ZSkgewoJICByZXR1cm4gYWxsb2NVbnNhZmUobnVsbCwgc2l6ZSkKCX0KCS8qKgoJICogRXF1aXZhbGVudCB0byBTbG93QnVmZmVyKG51bSksIGJ5IGRlZmF1bHQgY3JlYXRlcyBhIG5vbi16ZXJvLWZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuCgkgKi8KCUJ1ZmZlci5hbGxvY1Vuc2FmZVNsb3cgPSBmdW5jdGlvbiAoc2l6ZSkgewoJICByZXR1cm4gYWxsb2NVbnNhZmUobnVsbCwgc2l6ZSkKCX0KCglmdW5jdGlvbiBmcm9tU3RyaW5nICh0aGF0LCBzdHJpbmcsIGVuY29kaW5nKSB7CgkgIGlmICh0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnIHx8IGVuY29kaW5nID09PSAnJykgewoJICAgIGVuY29kaW5nID0gJ3V0ZjgnCgkgIH0KCgkgIGlmICghQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignImVuY29kaW5nIiBtdXN0IGJlIGEgdmFsaWQgc3RyaW5nIGVuY29kaW5nJykKCSAgfQoKCSAgdmFyIGxlbmd0aCA9IGJ5dGVMZW5ndGgoc3RyaW5nLCBlbmNvZGluZykgfCAwCgkgIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKQoKCSAgdmFyIGFjdHVhbCA9IHRoYXQud3JpdGUoc3RyaW5nLCBlbmNvZGluZykKCgkgIGlmIChhY3R1YWwgIT09IGxlbmd0aCkgewoJICAgIC8vIFdyaXRpbmcgYSBoZXggc3RyaW5nLCBmb3IgZXhhbXBsZSwgdGhhdCBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMgd2lsbAoJICAgIC8vIGNhdXNlIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGZpcnN0IGludmFsaWQgY2hhcmFjdGVyIHRvIGJlIGlnbm9yZWQuIChlLmcuCgkgICAgLy8gJ2FieHhjZCcgd2lsbCBiZSB0cmVhdGVkIGFzICdhYicpCgkgICAgdGhhdCA9IHRoYXQuc2xpY2UoMCwgYWN0dWFsKQoJICB9CgoJICByZXR1cm4gdGhhdAoJfQoKCWZ1bmN0aW9uIGZyb21BcnJheUxpa2UgKHRoYXQsIGFycmF5KSB7CgkgIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGggPCAwID8gMCA6IGNoZWNrZWQoYXJyYXkubGVuZ3RoKSB8IDAKCSAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBsZW5ndGgpCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHsKCSAgICB0aGF0W2ldID0gYXJyYXlbaV0gJiAyNTUKCSAgfQoJICByZXR1cm4gdGhhdAoJfQoKCWZ1bmN0aW9uIGZyb21BcnJheUJ1ZmZlciAodGhhdCwgYXJyYXksIGJ5dGVPZmZzZXQsIGxlbmd0aCkgewoJICBhcnJheS5ieXRlTGVuZ3RoIC8vIHRoaXMgdGhyb3dzIGlmIGBhcnJheWAgaXMgbm90IGEgdmFsaWQgQXJyYXlCdWZmZXIKCgkgIGlmIChieXRlT2Zmc2V0IDwgMCB8fCBhcnJheS5ieXRlTGVuZ3RoIDwgYnl0ZU9mZnNldCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcJ29mZnNldFwnIGlzIG91dCBvZiBib3VuZHMnKQoJICB9CgoJICBpZiAoYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQgKyAobGVuZ3RoIHx8IDApKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wnbGVuZ3RoXCcgaXMgb3V0IG9mIGJvdW5kcycpCgkgIH0KCgkgIGlmIChieXRlT2Zmc2V0ID09PSB1bmRlZmluZWQgJiYgbGVuZ3RoID09PSB1bmRlZmluZWQpIHsKCSAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5KQoJICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldCkKCSAgfSBlbHNlIHsKCSAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0LCBsZW5ndGgpCgkgIH0KCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIC8vIFJldHVybiBhbiBhdWdtZW50ZWQgYFVpbnQ4QXJyYXlgIGluc3RhbmNlLCBmb3IgYmVzdCBwZXJmb3JtYW5jZQoJICAgIHRoYXQgPSBhcnJheQoJICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZQoJICB9IGVsc2UgewoJICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3MKCSAgICB0aGF0ID0gZnJvbUFycmF5TGlrZSh0aGF0LCBhcnJheSkKCSAgfQoJICByZXR1cm4gdGhhdAoJfQoKCWZ1bmN0aW9uIGZyb21PYmplY3QgKHRoYXQsIG9iaikgewoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKG9iaikpIHsKCSAgICB2YXIgbGVuID0gY2hlY2tlZChvYmoubGVuZ3RoKSB8IDAKCSAgICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbikKCgkgICAgaWYgKHRoYXQubGVuZ3RoID09PSAwKSB7CgkgICAgICByZXR1cm4gdGhhdAoJICAgIH0KCgkgICAgb2JqLmNvcHkodGhhdCwgMCwgMCwgbGVuKQoJICAgIHJldHVybiB0aGF0CgkgIH0KCgkgIGlmIChvYmopIHsKCSAgICBpZiAoKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYKCSAgICAgICAgb2JqLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB8fCAnbGVuZ3RoJyBpbiBvYmopIHsKCSAgICAgIGlmICh0eXBlb2Ygb2JqLmxlbmd0aCAhPT0gJ251bWJlcicgfHwgaXNuYW4ob2JqLmxlbmd0aCkpIHsKCSAgICAgICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCAwKQoJICAgICAgfQoJICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqKQoJICAgIH0KCgkgICAgaWYgKG9iai50eXBlID09PSAnQnVmZmVyJyAmJiBpc0FycmF5KG9iai5kYXRhKSkgewoJICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqLmRhdGEpCgkgICAgfQoJICB9CgoJICB0aHJvdyBuZXcgVHlwZUVycm9yKCdGaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nLCBCdWZmZXIsIEFycmF5QnVmZmVyLCBBcnJheSwgb3IgYXJyYXktbGlrZSBvYmplY3QuJykKCX0KCglmdW5jdGlvbiBjaGVja2VkIChsZW5ndGgpIHsKCSAgLy8gTm90ZTogY2Fubm90IHVzZSBgbGVuZ3RoIDwga01heExlbmd0aCgpYCBoZXJlIGJlY2F1c2UgdGhhdCBmYWlscyB3aGVuCgkgIC8vIGxlbmd0aCBpcyBOYU4gKHdoaWNoIGlzIG90aGVyd2lzZSBjb2VyY2VkIHRvIHplcm8uKQoJICBpZiAobGVuZ3RoID49IGtNYXhMZW5ndGgoKSkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIGFsbG9jYXRlIEJ1ZmZlciBsYXJnZXIgdGhhbiBtYXhpbXVtICcgKwoJICAgICAgICAgICAgICAgICAgICAgICAgICdzaXplOiAweCcgKyBrTWF4TGVuZ3RoKCkudG9TdHJpbmcoMTYpICsgJyBieXRlcycpCgkgIH0KCSAgcmV0dXJuIGxlbmd0aCB8IDAKCX0KCglmdW5jdGlvbiBTbG93QnVmZmVyIChsZW5ndGgpIHsKCSAgaWYgKCtsZW5ndGggIT0gbGVuZ3RoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZXFlcWVxCgkgICAgbGVuZ3RoID0gMAoJICB9CgkgIHJldHVybiBCdWZmZXIuYWxsb2MoK2xlbmd0aCkKCX0KCglCdWZmZXIuaXNCdWZmZXIgPSBmdW5jdGlvbiBpc0J1ZmZlciAoYikgewoJICByZXR1cm4gISEoYiAhPSBudWxsICYmIGIuX2lzQnVmZmVyKQoJfQoKCUJ1ZmZlci5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAoYSwgYikgewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihhKSB8fCAhQnVmZmVyLmlzQnVmZmVyKGIpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnRzIG11c3QgYmUgQnVmZmVycycpCgkgIH0KCgkgIGlmIChhID09PSBiKSByZXR1cm4gMAoKCSAgdmFyIHggPSBhLmxlbmd0aAoJICB2YXIgeSA9IGIubGVuZ3RoCgoJICBmb3IgKHZhciBpID0gMCwgbGVuID0gTWF0aC5taW4oeCwgeSk7IGkgPCBsZW47ICsraSkgewoJICAgIGlmIChhW2ldICE9PSBiW2ldKSB7CgkgICAgICB4ID0gYVtpXQoJICAgICAgeSA9IGJbaV0KCSAgICAgIGJyZWFrCgkgICAgfQoJICB9CgoJICBpZiAoeCA8IHkpIHJldHVybiAtMQoJICBpZiAoeSA8IHgpIHJldHVybiAxCgkgIHJldHVybiAwCgl9CgoJQnVmZmVyLmlzRW5jb2RpbmcgPSBmdW5jdGlvbiBpc0VuY29kaW5nIChlbmNvZGluZykgewoJICBzd2l0Y2ggKFN0cmluZyhlbmNvZGluZykudG9Mb3dlckNhc2UoKSkgewoJICAgIGNhc2UgJ2hleCc6CgkgICAgY2FzZSAndXRmOCc6CgkgICAgY2FzZSAndXRmLTgnOgoJICAgIGNhc2UgJ2FzY2lpJzoKCSAgICBjYXNlICdsYXRpbjEnOgoJICAgIGNhc2UgJ2JpbmFyeSc6CgkgICAgY2FzZSAnYmFzZTY0JzoKCSAgICBjYXNlICd1Y3MyJzoKCSAgICBjYXNlICd1Y3MtMic6CgkgICAgY2FzZSAndXRmMTZsZSc6CgkgICAgY2FzZSAndXRmLTE2bGUnOgoJICAgICAgcmV0dXJuIHRydWUKCSAgICBkZWZhdWx0OgoJICAgICAgcmV0dXJuIGZhbHNlCgkgIH0KCX0KCglCdWZmZXIuY29uY2F0ID0gZnVuY3Rpb24gY29uY2F0IChsaXN0LCBsZW5ndGgpIHsKCSAgaWYgKCFpc0FycmF5KGxpc3QpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignImxpc3QiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpCgkgIH0KCgkgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMCkgewoJICAgIHJldHVybiBCdWZmZXIuYWxsb2MoMCkKCSAgfQoKCSAgdmFyIGkKCSAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgbGVuZ3RoID0gMAoJICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7CgkgICAgICBsZW5ndGggKz0gbGlzdFtpXS5sZW5ndGgKCSAgICB9CgkgIH0KCgkgIHZhciBidWZmZXIgPSBCdWZmZXIuYWxsb2NVbnNhZmUobGVuZ3RoKQoJICB2YXIgcG9zID0gMAoJICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7ICsraSkgewoJICAgIHZhciBidWYgPSBsaXN0W2ldCgkgICAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmKSkgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignImxpc3QiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpCgkgICAgfQoJICAgIGJ1Zi5jb3B5KGJ1ZmZlciwgcG9zKQoJICAgIHBvcyArPSBidWYubGVuZ3RoCgkgIH0KCSAgcmV0dXJuIGJ1ZmZlcgoJfQoKCWZ1bmN0aW9uIGJ5dGVMZW5ndGggKHN0cmluZywgZW5jb2RpbmcpIHsKCSAgaWYgKEJ1ZmZlci5pc0J1ZmZlcihzdHJpbmcpKSB7CgkgICAgcmV0dXJuIHN0cmluZy5sZW5ndGgKCSAgfQoJICBpZiAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgQXJyYXlCdWZmZXIuaXNWaWV3ID09PSAnZnVuY3Rpb24nICYmCgkgICAgICAoQXJyYXlCdWZmZXIuaXNWaWV3KHN0cmluZykgfHwgc3RyaW5nIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpKSB7CgkgICAgcmV0dXJuIHN0cmluZy5ieXRlTGVuZ3RoCgkgIH0KCSAgaWYgKHR5cGVvZiBzdHJpbmcgIT09ICdzdHJpbmcnKSB7CgkgICAgc3RyaW5nID0gJycgKyBzdHJpbmcKCSAgfQoKCSAgdmFyIGxlbiA9IHN0cmluZy5sZW5ndGgKCSAgaWYgKGxlbiA9PT0gMCkgcmV0dXJuIDAKCgkgIC8vIFVzZSBhIGZvciBsb29wIHRvIGF2b2lkIHJlY3Vyc2lvbgoJICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZQoJICBmb3IgKDs7KSB7CgkgICAgc3dpdGNoIChlbmNvZGluZykgewoJICAgICAgY2FzZSAnYXNjaWknOgoJICAgICAgY2FzZSAnbGF0aW4xJzoKCSAgICAgIGNhc2UgJ2JpbmFyeSc6CgkgICAgICAgIHJldHVybiBsZW4KCSAgICAgIGNhc2UgJ3V0ZjgnOgoJICAgICAgY2FzZSAndXRmLTgnOgoJICAgICAgY2FzZSB1bmRlZmluZWQ6CgkgICAgICAgIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aAoJICAgICAgY2FzZSAndWNzMic6CgkgICAgICBjYXNlICd1Y3MtMic6CgkgICAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIGNhc2UgJ3V0Zi0xNmxlJzoKCSAgICAgICAgcmV0dXJuIGxlbiAqIDIKCSAgICAgIGNhc2UgJ2hleCc6CgkgICAgICAgIHJldHVybiBsZW4gPj4+IDEKCSAgICAgIGNhc2UgJ2Jhc2U2NCc6CgkgICAgICAgIHJldHVybiBiYXNlNjRUb0J5dGVzKHN0cmluZykubGVuZ3RoCgkgICAgICBkZWZhdWx0OgoJICAgICAgICBpZiAobG93ZXJlZENhc2UpIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aCAvLyBhc3N1bWUgdXRmOAoJICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpCgkgICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZQoJICAgIH0KCSAgfQoJfQoJQnVmZmVyLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoCgoJZnVuY3Rpb24gc2xvd1RvU3RyaW5nIChlbmNvZGluZywgc3RhcnQsIGVuZCkgewoJICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZQoKCSAgLy8gTm8gbmVlZCB0byB2ZXJpZnkgdGhhdCAidGhpcy5sZW5ndGggPD0gTUFYX1VJTlQzMiIgc2luY2UgaXQncyBhIHJlYWQtb25seQoJICAvLyBwcm9wZXJ0eSBvZiBhIHR5cGVkIGFycmF5LgoKCSAgLy8gVGhpcyBiZWhhdmVzIG5laXRoZXIgbGlrZSBTdHJpbmcgbm9yIFVpbnQ4QXJyYXkgaW4gdGhhdCB3ZSBzZXQgc3RhcnQvZW5kCgkgIC8vIHRvIHRoZWlyIHVwcGVyL2xvd2VyIGJvdW5kcyBpZiB0aGUgdmFsdWUgcGFzc2VkIGlzIG91dCBvZiByYW5nZS4KCSAgLy8gdW5kZWZpbmVkIGlzIGhhbmRsZWQgc3BlY2lhbGx5IGFzIHBlciBFQ01BLTI2MiA2dGggRWRpdGlvbiwKCSAgLy8gU2VjdGlvbiAxMy4zLjMuNyBSdW50aW1lIFNlbWFudGljczogS2V5ZWRCaW5kaW5nSW5pdGlhbGl6YXRpb24uCgkgIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkIHx8IHN0YXJ0IDwgMCkgewoJICAgIHN0YXJ0ID0gMAoJICB9CgkgIC8vIFJldHVybiBlYXJseSBpZiBzdGFydCA+IHRoaXMubGVuZ3RoLiBEb25lIGhlcmUgdG8gcHJldmVudCBwb3RlbnRpYWwgdWludDMyCgkgIC8vIGNvZXJjaW9uIGZhaWwgYmVsb3cuCgkgIGlmIChzdGFydCA+IHRoaXMubGVuZ3RoKSB7CgkgICAgcmV0dXJuICcnCgkgIH0KCgkgIGlmIChlbmQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPiB0aGlzLmxlbmd0aCkgewoJICAgIGVuZCA9IHRoaXMubGVuZ3RoCgkgIH0KCgkgIGlmIChlbmQgPD0gMCkgewoJICAgIHJldHVybiAnJwoJICB9CgoJICAvLyBGb3JjZSBjb2Vyc2lvbiB0byB1aW50MzIuIFRoaXMgd2lsbCBhbHNvIGNvZXJjZSBmYWxzZXkvTmFOIHZhbHVlcyB0byAwLgoJICBlbmQgPj4+PSAwCgkgIHN0YXJ0ID4+Pj0gMAoKCSAgaWYgKGVuZCA8PSBzdGFydCkgewoJICAgIHJldHVybiAnJwoJICB9CgoJICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4JwoKCSAgd2hpbGUgKHRydWUpIHsKCSAgICBzd2l0Y2ggKGVuY29kaW5nKSB7CgkgICAgICBjYXNlICdoZXgnOgoJICAgICAgICByZXR1cm4gaGV4U2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICd1dGY4JzoKCSAgICAgIGNhc2UgJ3V0Zi04JzoKCSAgICAgICAgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGNhc2UgJ2FzY2lpJzoKCSAgICAgICAgcmV0dXJuIGFzY2lpU2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICdsYXRpbjEnOgoJICAgICAgY2FzZSAnYmluYXJ5JzoKCSAgICAgICAgcmV0dXJuIGxhdGluMVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgY2FzZSAnYmFzZTY0JzoKCSAgICAgICAgcmV0dXJuIGJhc2U2NFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgY2FzZSAndWNzMic6CgkgICAgICBjYXNlICd1Y3MtMic6CgkgICAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIGNhc2UgJ3V0Zi0xNmxlJzoKCSAgICAgICAgcmV0dXJuIHV0ZjE2bGVTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGRlZmF1bHQ6CgkgICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKQoJICAgICAgICBlbmNvZGluZyA9IChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpCgkgICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZQoJICAgIH0KCSAgfQoJfQoKCS8vIFRoZSBwcm9wZXJ0eSBpcyB1c2VkIGJ5IGBCdWZmZXIuaXNCdWZmZXJgIGFuZCBgaXMtYnVmZmVyYCAoaW4gU2FmYXJpIDUtNykgdG8gZGV0ZWN0CgkvLyBCdWZmZXIgaW5zdGFuY2VzLgoJQnVmZmVyLnByb3RvdHlwZS5faXNCdWZmZXIgPSB0cnVlCgoJZnVuY3Rpb24gc3dhcCAoYiwgbiwgbSkgewoJICB2YXIgaSA9IGJbbl0KCSAgYltuXSA9IGJbbV0KCSAgYlttXSA9IGkKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXAxNiA9IGZ1bmN0aW9uIHN3YXAxNiAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgMiAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMTYtYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDEpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXAzMiA9IGZ1bmN0aW9uIHN3YXAzMiAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgNCAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMzItYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDMpCgkgICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDIpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXA2NCA9IGZ1bmN0aW9uIHN3YXA2NCAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgOCAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNjQtYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gOCkgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDcpCgkgICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDYpCgkgICAgc3dhcCh0aGlzLCBpICsgMiwgaSArIDUpCgkgICAgc3dhcCh0aGlzLCBpICsgMywgaSArIDQpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkgewoJICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGggfCAwCgkgIGlmIChsZW5ndGggPT09IDApIHJldHVybiAnJwoJICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCAwLCBsZW5ndGgpCgkgIHJldHVybiBzbG93VG9TdHJpbmcuYXBwbHkodGhpcywgYXJndW1lbnRzKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gZXF1YWxzIChiKSB7CgkgIGlmICghQnVmZmVyLmlzQnVmZmVyKGIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyJykKCSAgaWYgKHRoaXMgPT09IGIpIHJldHVybiB0cnVlCgkgIHJldHVybiBCdWZmZXIuY29tcGFyZSh0aGlzLCBiKSA9PT0gMAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuaW5zcGVjdCA9IGZ1bmN0aW9uIGluc3BlY3QgKCkgewoJICB2YXIgc3RyID0gJycKCSAgdmFyIG1heCA9IGV4cG9ydHMuSU5TUEVDVF9NQVhfQllURVMKCSAgaWYgKHRoaXMubGVuZ3RoID4gMCkgewoJICAgIHN0ciA9IHRoaXMudG9TdHJpbmcoJ2hleCcsIDAsIG1heCkubWF0Y2goLy57Mn0vZykuam9pbignICcpCgkgICAgaWYgKHRoaXMubGVuZ3RoID4gbWF4KSBzdHIgKz0gJyAuLi4gJwoJICB9CgkgIHJldHVybiAnPEJ1ZmZlciAnICsgc3RyICsgJz4nCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAodGFyZ2V0LCBzdGFydCwgZW5kLCB0aGlzU3RhcnQsIHRoaXNFbmQpIHsKCSAgaWYgKCFCdWZmZXIuaXNCdWZmZXIodGFyZ2V0KSkgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKQoJICB9CgoJICBpZiAoc3RhcnQgPT09IHVuZGVmaW5lZCkgewoJICAgIHN0YXJ0ID0gMAoJICB9CgkgIGlmIChlbmQgPT09IHVuZGVmaW5lZCkgewoJICAgIGVuZCA9IHRhcmdldCA/IHRhcmdldC5sZW5ndGggOiAwCgkgIH0KCSAgaWYgKHRoaXNTdGFydCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgdGhpc1N0YXJ0ID0gMAoJICB9CgkgIGlmICh0aGlzRW5kID09PSB1bmRlZmluZWQpIHsKCSAgICB0aGlzRW5kID0gdGhpcy5sZW5ndGgKCSAgfQoKCSAgaWYgKHN0YXJ0IDwgMCB8fCBlbmQgPiB0YXJnZXQubGVuZ3RoIHx8IHRoaXNTdGFydCA8IDAgfHwgdGhpc0VuZCA+IHRoaXMubGVuZ3RoKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ291dCBvZiByYW5nZSBpbmRleCcpCgkgIH0KCgkgIGlmICh0aGlzU3RhcnQgPj0gdGhpc0VuZCAmJiBzdGFydCA+PSBlbmQpIHsKCSAgICByZXR1cm4gMAoJICB9CgkgIGlmICh0aGlzU3RhcnQgPj0gdGhpc0VuZCkgewoJICAgIHJldHVybiAtMQoJICB9CgkgIGlmIChzdGFydCA+PSBlbmQpIHsKCSAgICByZXR1cm4gMQoJICB9CgoJICBzdGFydCA+Pj49IDAKCSAgZW5kID4+Pj0gMAoJICB0aGlzU3RhcnQgPj4+PSAwCgkgIHRoaXNFbmQgPj4+PSAwCgoJICBpZiAodGhpcyA9PT0gdGFyZ2V0KSByZXR1cm4gMAoKCSAgdmFyIHggPSB0aGlzRW5kIC0gdGhpc1N0YXJ0CgkgIHZhciB5ID0gZW5kIC0gc3RhcnQKCSAgdmFyIGxlbiA9IE1hdGgubWluKHgsIHkpCgoJICB2YXIgdGhpc0NvcHkgPSB0aGlzLnNsaWNlKHRoaXNTdGFydCwgdGhpc0VuZCkKCSAgdmFyIHRhcmdldENvcHkgPSB0YXJnZXQuc2xpY2Uoc3RhcnQsIGVuZCkKCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHsKCSAgICBpZiAodGhpc0NvcHlbaV0gIT09IHRhcmdldENvcHlbaV0pIHsKCSAgICAgIHggPSB0aGlzQ29weVtpXQoJICAgICAgeSA9IHRhcmdldENvcHlbaV0KCSAgICAgIGJyZWFrCgkgICAgfQoJICB9CgoJICBpZiAoeCA8IHkpIHJldHVybiAtMQoJICBpZiAoeSA8IHgpIHJldHVybiAxCgkgIHJldHVybiAwCgl9CgoJLy8gRmluZHMgZWl0aGVyIHRoZSBmaXJzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPj0gYGJ5dGVPZmZzZXRgLAoJLy8gT1IgdGhlIGxhc3QgaW5kZXggb2YgYHZhbGAgaW4gYGJ1ZmZlcmAgYXQgb2Zmc2V0IDw9IGBieXRlT2Zmc2V0YC4KCS8vCgkvLyBBcmd1bWVudHM6CgkvLyAtIGJ1ZmZlciAtIGEgQnVmZmVyIHRvIHNlYXJjaAoJLy8gLSB2YWwgLSBhIHN0cmluZywgQnVmZmVyLCBvciBudW1iZXIKCS8vIC0gYnl0ZU9mZnNldCAtIGFuIGluZGV4IGludG8gYGJ1ZmZlcmA7IHdpbGwgYmUgY2xhbXBlZCB0byBhbiBpbnQzMgoJLy8gLSBlbmNvZGluZyAtIGFuIG9wdGlvbmFsIGVuY29kaW5nLCByZWxldmFudCBpcyB2YWwgaXMgYSBzdHJpbmcKCS8vIC0gZGlyIC0gdHJ1ZSBmb3IgaW5kZXhPZiwgZmFsc2UgZm9yIGxhc3RJbmRleE9mCglmdW5jdGlvbiBiaWRpcmVjdGlvbmFsSW5kZXhPZiAoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHsKCSAgLy8gRW1wdHkgYnVmZmVyIG1lYW5zIG5vIG1hdGNoCgkgIGlmIChidWZmZXIubGVuZ3RoID09PSAwKSByZXR1cm4gLTEKCgkgIC8vIE5vcm1hbGl6ZSBieXRlT2Zmc2V0CgkgIGlmICh0eXBlb2YgYnl0ZU9mZnNldCA9PT0gJ3N0cmluZycpIHsKCSAgICBlbmNvZGluZyA9IGJ5dGVPZmZzZXQKCSAgICBieXRlT2Zmc2V0ID0gMAoJICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPiAweDdmZmZmZmZmKSB7CgkgICAgYnl0ZU9mZnNldCA9IDB4N2ZmZmZmZmYKCSAgfSBlbHNlIGlmIChieXRlT2Zmc2V0IDwgLTB4ODAwMDAwMDApIHsKCSAgICBieXRlT2Zmc2V0ID0gLTB4ODAwMDAwMDAKCSAgfQoJICBieXRlT2Zmc2V0ID0gK2J5dGVPZmZzZXQgIC8vIENvZXJjZSB0byBOdW1iZXIuCgkgIGlmIChpc05hTihieXRlT2Zmc2V0KSkgewoJICAgIC8vIGJ5dGVPZmZzZXQ6IGl0IGl0J3MgdW5kZWZpbmVkLCBudWxsLCBOYU4sICJmb28iLCBldGMsIHNlYXJjaCB3aG9sZSBidWZmZXIKCSAgICBieXRlT2Zmc2V0ID0gZGlyID8gMCA6IChidWZmZXIubGVuZ3RoIC0gMSkKCSAgfQoKCSAgLy8gTm9ybWFsaXplIGJ5dGVPZmZzZXQ6IG5lZ2F0aXZlIG9mZnNldHMgc3RhcnQgZnJvbSB0aGUgZW5kIG9mIHRoZSBidWZmZXIKCSAgaWYgKGJ5dGVPZmZzZXQgPCAwKSBieXRlT2Zmc2V0ID0gYnVmZmVyLmxlbmd0aCArIGJ5dGVPZmZzZXQKCSAgaWYgKGJ5dGVPZmZzZXQgPj0gYnVmZmVyLmxlbmd0aCkgewoJICAgIGlmIChkaXIpIHJldHVybiAtMQoJICAgIGVsc2UgYnl0ZU9mZnNldCA9IGJ1ZmZlci5sZW5ndGggLSAxCgkgIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA8IDApIHsKCSAgICBpZiAoZGlyKSBieXRlT2Zmc2V0ID0gMAoJICAgIGVsc2UgcmV0dXJuIC0xCgkgIH0KCgkgIC8vIE5vcm1hbGl6ZSB2YWwKCSAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7CgkgICAgdmFsID0gQnVmZmVyLmZyb20odmFsLCBlbmNvZGluZykKCSAgfQoKCSAgLy8gRmluYWxseSwgc2VhcmNoIGVpdGhlciBpbmRleE9mIChpZiBkaXIgaXMgdHJ1ZSkgb3IgbGFzdEluZGV4T2YKCSAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWwpKSB7CgkgICAgLy8gU3BlY2lhbCBjYXNlOiBsb29raW5nIGZvciBlbXB0eSBzdHJpbmcvYnVmZmVyIGFsd2F5cyBmYWlscwoJICAgIGlmICh2YWwubGVuZ3RoID09PSAwKSB7CgkgICAgICByZXR1cm4gLTEKCSAgICB9CgkgICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikKCSAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykgewoJICAgIHZhbCA9IHZhbCAmIDB4RkYgLy8gU2VhcmNoIGZvciBhIGJ5dGUgdmFsdWUgWzAtMjU1XQoJICAgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCAmJgoJICAgICAgICB0eXBlb2YgVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA9PT0gJ2Z1bmN0aW9uJykgewoJICAgICAgaWYgKGRpcikgewoJICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KQoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgcmV0dXJuIFVpbnQ4QXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpCgkgICAgICB9CgkgICAgfQoJICAgIHJldHVybiBhcnJheUluZGV4T2YoYnVmZmVyLCBbIHZhbCBdLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKQoJICB9CgoJICB0aHJvdyBuZXcgVHlwZUVycm9yKCd2YWwgbXVzdCBiZSBzdHJpbmcsIG51bWJlciBvciBCdWZmZXInKQoJfQoKCWZ1bmN0aW9uIGFycmF5SW5kZXhPZiAoYXJyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHsKCSAgdmFyIGluZGV4U2l6ZSA9IDEKCSAgdmFyIGFyckxlbmd0aCA9IGFyci5sZW5ndGgKCSAgdmFyIHZhbExlbmd0aCA9IHZhbC5sZW5ndGgKCgkgIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkKSB7CgkgICAgZW5jb2RpbmcgPSBTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkKCSAgICBpZiAoZW5jb2RpbmcgPT09ICd1Y3MyJyB8fCBlbmNvZGluZyA9PT0gJ3Vjcy0yJyB8fAoJICAgICAgICBlbmNvZGluZyA9PT0gJ3V0ZjE2bGUnIHx8IGVuY29kaW5nID09PSAndXRmLTE2bGUnKSB7CgkgICAgICBpZiAoYXJyLmxlbmd0aCA8IDIgfHwgdmFsLmxlbmd0aCA8IDIpIHsKCSAgICAgICAgcmV0dXJuIC0xCgkgICAgICB9CgkgICAgICBpbmRleFNpemUgPSAyCgkgICAgICBhcnJMZW5ndGggLz0gMgoJICAgICAgdmFsTGVuZ3RoIC89IDIKCSAgICAgIGJ5dGVPZmZzZXQgLz0gMgoJICAgIH0KCSAgfQoKCSAgZnVuY3Rpb24gcmVhZCAoYnVmLCBpKSB7CgkgICAgaWYgKGluZGV4U2l6ZSA9PT0gMSkgewoJICAgICAgcmV0dXJuIGJ1ZltpXQoJICAgIH0gZWxzZSB7CgkgICAgICByZXR1cm4gYnVmLnJlYWRVSW50MTZCRShpICogaW5kZXhTaXplKQoJICAgIH0KCSAgfQoKCSAgdmFyIGkKCSAgaWYgKGRpcikgewoJICAgIHZhciBmb3VuZEluZGV4ID0gLTEKCSAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpIDwgYXJyTGVuZ3RoOyBpKyspIHsKCSAgICAgIGlmIChyZWFkKGFyciwgaSkgPT09IHJlYWQodmFsLCBmb3VuZEluZGV4ID09PSAtMSA/IDAgOiBpIC0gZm91bmRJbmRleCkpIHsKCSAgICAgICAgaWYgKGZvdW5kSW5kZXggPT09IC0xKSBmb3VuZEluZGV4ID0gaQoJICAgICAgICBpZiAoaSAtIGZvdW5kSW5kZXggKyAxID09PSB2YWxMZW5ndGgpIHJldHVybiBmb3VuZEluZGV4ICogaW5kZXhTaXplCgkgICAgICB9IGVsc2UgewoJICAgICAgICBpZiAoZm91bmRJbmRleCAhPT0gLTEpIGkgLT0gaSAtIGZvdW5kSW5kZXgKCSAgICAgICAgZm91bmRJbmRleCA9IC0xCgkgICAgICB9CgkgICAgfQoJICB9IGVsc2UgewoJICAgIGlmIChieXRlT2Zmc2V0ICsgdmFsTGVuZ3RoID4gYXJyTGVuZ3RoKSBieXRlT2Zmc2V0ID0gYXJyTGVuZ3RoIC0gdmFsTGVuZ3RoCgkgICAgZm9yIChpID0gYnl0ZU9mZnNldDsgaSA+PSAwOyBpLS0pIHsKCSAgICAgIHZhciBmb3VuZCA9IHRydWUKCSAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdmFsTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgaWYgKHJlYWQoYXJyLCBpICsgaikgIT09IHJlYWQodmFsLCBqKSkgewoJICAgICAgICAgIGZvdW5kID0gZmFsc2UKCSAgICAgICAgICBicmVhawoJICAgICAgICB9CgkgICAgICB9CgkgICAgICBpZiAoZm91bmQpIHJldHVybiBpCgkgICAgfQoJICB9CgoJICByZXR1cm4gLTEKCX0KCglCdWZmZXIucHJvdG90eXBlLmluY2x1ZGVzID0gZnVuY3Rpb24gaW5jbHVkZXMgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHsKCSAgcmV0dXJuIHRoaXMuaW5kZXhPZih2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSAhPT0gLTEKCX0KCglCdWZmZXIucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiBpbmRleE9mICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7CgkgIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCB0cnVlKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUubGFzdEluZGV4T2YgPSBmdW5jdGlvbiBsYXN0SW5kZXhPZiAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgewoJICByZXR1cm4gYmlkaXJlY3Rpb25hbEluZGV4T2YodGhpcywgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZmFsc2UpCgl9CgoJZnVuY3Rpb24gaGV4V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkgewoJICBvZmZzZXQgPSBOdW1iZXIob2Zmc2V0KSB8fCAwCgkgIHZhciByZW1haW5pbmcgPSBidWYubGVuZ3RoIC0gb2Zmc2V0CgkgIGlmICghbGVuZ3RoKSB7CgkgICAgbGVuZ3RoID0gcmVtYWluaW5nCgkgIH0gZWxzZSB7CgkgICAgbGVuZ3RoID0gTnVtYmVyKGxlbmd0aCkKCSAgICBpZiAobGVuZ3RoID4gcmVtYWluaW5nKSB7CgkgICAgICBsZW5ndGggPSByZW1haW5pbmcKCSAgICB9CgkgIH0KCgkgIC8vIG11c3QgYmUgYW4gZXZlbiBudW1iZXIgb2YgZGlnaXRzCgkgIHZhciBzdHJMZW4gPSBzdHJpbmcubGVuZ3RoCgkgIGlmIChzdHJMZW4gJSAyICE9PSAwKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGhleCBzdHJpbmcnKQoKCSAgaWYgKGxlbmd0aCA+IHN0ckxlbiAvIDIpIHsKCSAgICBsZW5ndGggPSBzdHJMZW4gLyAyCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewoJICAgIHZhciBwYXJzZWQgPSBwYXJzZUludChzdHJpbmcuc3Vic3RyKGkgKiAyLCAyKSwgMTYpCgkgICAgaWYgKGlzTmFOKHBhcnNlZCkpIHJldHVybiBpCgkgICAgYnVmW29mZnNldCArIGldID0gcGFyc2VkCgkgIH0KCSAgcmV0dXJuIGkKCX0KCglmdW5jdGlvbiB1dGY4V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkgewoJICByZXR1cm4gYmxpdEJ1ZmZlcih1dGY4VG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIGFzY2lpV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkgewoJICByZXR1cm4gYmxpdEJ1ZmZlcihhc2NpaVRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aCkKCX0KCglmdW5jdGlvbiBsYXRpbjFXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBhc2NpaVdyaXRlKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCX0KCglmdW5jdGlvbiBiYXNlNjRXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKGJhc2U2NFRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aCkKCX0KCglmdW5jdGlvbiB1Y3MyV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkgewoJICByZXR1cm4gYmxpdEJ1ZmZlcih1dGYxNmxlVG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiB3cml0ZSAoc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCwgZW5jb2RpbmcpIHsKCSAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZykKCSAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgZW5jb2RpbmcgPSAndXRmOCcKCSAgICBsZW5ndGggPSB0aGlzLmxlbmd0aAoJICAgIG9mZnNldCA9IDAKCSAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgZW5jb2RpbmcpCgkgIH0gZWxzZSBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgJiYgdHlwZW9mIG9mZnNldCA9PT0gJ3N0cmluZycpIHsKCSAgICBlbmNvZGluZyA9IG9mZnNldAoJICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoCgkgICAgb2Zmc2V0ID0gMAoJICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBvZmZzZXRbLCBsZW5ndGhdWywgZW5jb2RpbmddKQoJICB9IGVsc2UgaWYgKGlzRmluaXRlKG9mZnNldCkpIHsKCSAgICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgICAgaWYgKGlzRmluaXRlKGxlbmd0aCkpIHsKCSAgICAgIGxlbmd0aCA9IGxlbmd0aCB8IDAKCSAgICAgIGlmIChlbmNvZGluZyA9PT0gdW5kZWZpbmVkKSBlbmNvZGluZyA9ICd1dGY4JwoJICAgIH0gZWxzZSB7CgkgICAgICBlbmNvZGluZyA9IGxlbmd0aAoJICAgICAgbGVuZ3RoID0gdW5kZWZpbmVkCgkgICAgfQoJICAvLyBsZWdhY3kgd3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0LCBsZW5ndGgpIC0gcmVtb3ZlIGluIHYwLjEzCgkgIH0gZWxzZSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKAoJICAgICAgJ0J1ZmZlci53cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXRbLCBsZW5ndGhdKSBpcyBubyBsb25nZXIgc3VwcG9ydGVkJwoJICAgICkKCSAgfQoKCSAgdmFyIHJlbWFpbmluZyA9IHRoaXMubGVuZ3RoIC0gb2Zmc2V0CgkgIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCB8fCBsZW5ndGggPiByZW1haW5pbmcpIGxlbmd0aCA9IHJlbWFpbmluZwoKCSAgaWYgKChzdHJpbmcubGVuZ3RoID4gMCAmJiAobGVuZ3RoIDwgMCB8fCBvZmZzZXQgPCAwKSkgfHwgb2Zmc2V0ID4gdGhpcy5sZW5ndGgpIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQXR0ZW1wdCB0byB3cml0ZSBvdXRzaWRlIGJ1ZmZlciBib3VuZHMnKQoJICB9CgoJICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4JwoKCSAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2UKCSAgZm9yICg7OykgewoJICAgIHN3aXRjaCAoZW5jb2RpbmcpIHsKCSAgICAgIGNhc2UgJ2hleCc6CgkgICAgICAgIHJldHVybiBoZXhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGNhc2UgJ3V0ZjgnOgoJICAgICAgY2FzZSAndXRmLTgnOgoJICAgICAgICByZXR1cm4gdXRmOFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgY2FzZSAnYXNjaWknOgoJICAgICAgICByZXR1cm4gYXNjaWlXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGNhc2UgJ2xhdGluMSc6CgkgICAgICBjYXNlICdiaW5hcnknOgoJICAgICAgICByZXR1cm4gbGF0aW4xV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBjYXNlICdiYXNlNjQnOgoJICAgICAgICAvLyBXYXJuaW5nOiBtYXhMZW5ndGggbm90IHRha2VuIGludG8gYWNjb3VudCBpbiBiYXNlNjRXcml0ZQoJICAgICAgICByZXR1cm4gYmFzZTY0V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBjYXNlICd1Y3MyJzoKCSAgICAgIGNhc2UgJ3Vjcy0yJzoKCSAgICAgIGNhc2UgJ3V0ZjE2bGUnOgoJICAgICAgY2FzZSAndXRmLTE2bGUnOgoJICAgICAgICByZXR1cm4gdWNzMldyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgZGVmYXVsdDoKCSAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpCgkgICAgICAgIGVuY29kaW5nID0gKCcnICsgZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkKCSAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlCgkgICAgfQoJICB9Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiB0b0pTT04gKCkgewoJICByZXR1cm4gewoJICAgIHR5cGU6ICdCdWZmZXInLAoJICAgIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKQoJICB9Cgl9CgoJZnVuY3Rpb24gYmFzZTY0U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICBpZiAoc3RhcnQgPT09IDAgJiYgZW5kID09PSBidWYubGVuZ3RoKSB7CgkgICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1ZikKCSAgfSBlbHNlIHsKCSAgICByZXR1cm4gYmFzZTY0LmZyb21CeXRlQXJyYXkoYnVmLnNsaWNlKHN0YXJ0LCBlbmQpKQoJICB9Cgl9CgoJZnVuY3Rpb24gdXRmOFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKQoJICB2YXIgcmVzID0gW10KCgkgIHZhciBpID0gc3RhcnQKCSAgd2hpbGUgKGkgPCBlbmQpIHsKCSAgICB2YXIgZmlyc3RCeXRlID0gYnVmW2ldCgkgICAgdmFyIGNvZGVQb2ludCA9IG51bGwKCSAgICB2YXIgYnl0ZXNQZXJTZXF1ZW5jZSA9IChmaXJzdEJ5dGUgPiAweEVGKSA/IDQKCSAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4REYpID8gMwoJICAgICAgOiAoZmlyc3RCeXRlID4gMHhCRikgPyAyCgkgICAgICA6IDEKCgkgICAgaWYgKGkgKyBieXRlc1BlclNlcXVlbmNlIDw9IGVuZCkgewoJICAgICAgdmFyIHNlY29uZEJ5dGUsIHRoaXJkQnl0ZSwgZm91cnRoQnl0ZSwgdGVtcENvZGVQb2ludAoKCSAgICAgIHN3aXRjaCAoYnl0ZXNQZXJTZXF1ZW5jZSkgewoJICAgICAgICBjYXNlIDE6CgkgICAgICAgICAgaWYgKGZpcnN0Qnl0ZSA8IDB4ODApIHsKCSAgICAgICAgICAgIGNvZGVQb2ludCA9IGZpcnN0Qnl0ZQoJICAgICAgICAgIH0KCSAgICAgICAgICBicmVhawoJICAgICAgICBjYXNlIDI6CgkgICAgICAgICAgc2Vjb25kQnl0ZSA9IGJ1ZltpICsgMV0KCSAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkgewoJICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweDFGKSA8PCAweDYgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpCgkgICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4N0YpIHsKCSAgICAgICAgICAgICAgY29kZVBvaW50ID0gdGVtcENvZGVQb2ludAoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0KCSAgICAgICAgICBicmVhawoJICAgICAgICBjYXNlIDM6CgkgICAgICAgICAgc2Vjb25kQnl0ZSA9IGJ1ZltpICsgMV0KCSAgICAgICAgICB0aGlyZEJ5dGUgPSBidWZbaSArIDJdCgkgICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHhDIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweDYgfCAodGhpcmRCeXRlICYgMHgzRikKCSAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3RkYgJiYgKHRlbXBDb2RlUG9pbnQgPCAweEQ4MDAgfHwgdGVtcENvZGVQb2ludCA+IDB4REZGRikpIHsKCSAgICAgICAgICAgICAgY29kZVBvaW50ID0gdGVtcENvZGVQb2ludAoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0KCSAgICAgICAgICBicmVhawoJICAgICAgICBjYXNlIDQ6CgkgICAgICAgICAgc2Vjb25kQnl0ZSA9IGJ1ZltpICsgMV0KCSAgICAgICAgICB0aGlyZEJ5dGUgPSBidWZbaSArIDJdCgkgICAgICAgICAgZm91cnRoQnl0ZSA9IGJ1ZltpICsgM10KCSAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAodGhpcmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKGZvdXJ0aEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkgewoJICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweEYpIDw8IDB4MTIgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpIDw8IDB4QyB8ICh0aGlyZEJ5dGUgJiAweDNGKSA8PCAweDYgfCAoZm91cnRoQnl0ZSAmIDB4M0YpCgkgICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4RkZGRiAmJiB0ZW1wQ29kZVBvaW50IDwgMHgxMTAwMDApIHsKCSAgICAgICAgICAgICAgY29kZVBvaW50ID0gdGVtcENvZGVQb2ludAoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0KCSAgICAgIH0KCSAgICB9CgoJICAgIGlmIChjb2RlUG9pbnQgPT09IG51bGwpIHsKCSAgICAgIC8vIHdlIGRpZCBub3QgZ2VuZXJhdGUgYSB2YWxpZCBjb2RlUG9pbnQgc28gaW5zZXJ0IGEKCSAgICAgIC8vIHJlcGxhY2VtZW50IGNoYXIgKFUrRkZGRCkgYW5kIGFkdmFuY2Ugb25seSAxIGJ5dGUKCSAgICAgIGNvZGVQb2ludCA9IDB4RkZGRAoJICAgICAgYnl0ZXNQZXJTZXF1ZW5jZSA9IDEKCSAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA+IDB4RkZGRikgewoJICAgICAgLy8gZW5jb2RlIHRvIHV0ZjE2IChzdXJyb2dhdGUgcGFpciBkYW5jZSkKCSAgICAgIGNvZGVQb2ludCAtPSAweDEwMDAwCgkgICAgICByZXMucHVzaChjb2RlUG9pbnQgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApCgkgICAgICBjb2RlUG9pbnQgPSAweERDMDAgfCBjb2RlUG9pbnQgJiAweDNGRgoJICAgIH0KCgkgICAgcmVzLnB1c2goY29kZVBvaW50KQoJICAgIGkgKz0gYnl0ZXNQZXJTZXF1ZW5jZQoJICB9CgoJICByZXR1cm4gZGVjb2RlQ29kZVBvaW50c0FycmF5KHJlcykKCX0KCgkvLyBCYXNlZCBvbiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yMjc0NzI3Mi82ODA3NDIsIHRoZSBicm93c2VyIHdpdGgKCS8vIHRoZSBsb3dlc3QgbGltaXQgaXMgQ2hyb21lLCB3aXRoIDB4MTAwMDAgYXJncy4KCS8vIFdlIGdvIDEgbWFnbml0dWRlIGxlc3MsIGZvciBzYWZldHkKCXZhciBNQVhfQVJHVU1FTlRTX0xFTkdUSCA9IDB4MTAwMAoKCWZ1bmN0aW9uIGRlY29kZUNvZGVQb2ludHNBcnJheSAoY29kZVBvaW50cykgewoJICB2YXIgbGVuID0gY29kZVBvaW50cy5sZW5ndGgKCSAgaWYgKGxlbiA8PSBNQVhfQVJHVU1FTlRTX0xFTkdUSCkgewoJICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZywgY29kZVBvaW50cykgLy8gYXZvaWQgZXh0cmEgc2xpY2UoKQoJICB9CgoJICAvLyBEZWNvZGUgaW4gY2h1bmtzIHRvIGF2b2lkICJjYWxsIHN0YWNrIHNpemUgZXhjZWVkZWQiLgoJICB2YXIgcmVzID0gJycKCSAgdmFyIGkgPSAwCgkgIHdoaWxlIChpIDwgbGVuKSB7CgkgICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoCgkgICAgICBTdHJpbmcsCgkgICAgICBjb2RlUG9pbnRzLnNsaWNlKGksIGkgKz0gTUFYX0FSR1VNRU5UU19MRU5HVEgpCgkgICAgKQoJICB9CgkgIHJldHVybiByZXMKCX0KCglmdW5jdGlvbiBhc2NpaVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgdmFyIHJldCA9ICcnCgkgIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZCkKCgkgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7CgkgICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldICYgMHg3RikKCSAgfQoJICByZXR1cm4gcmV0Cgl9CgoJZnVuY3Rpb24gbGF0aW4xU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICB2YXIgcmV0ID0gJycKCSAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKQoKCSAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHsKCSAgICByZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZbaV0pCgkgIH0KCSAgcmV0dXJuIHJldAoJfQoKCWZ1bmN0aW9uIGhleFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgdmFyIGxlbiA9IGJ1Zi5sZW5ndGgKCgkgIGlmICghc3RhcnQgfHwgc3RhcnQgPCAwKSBzdGFydCA9IDAKCSAgaWYgKCFlbmQgfHwgZW5kIDwgMCB8fCBlbmQgPiBsZW4pIGVuZCA9IGxlbgoKCSAgdmFyIG91dCA9ICcnCgkgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7CgkgICAgb3V0ICs9IHRvSGV4KGJ1ZltpXSkKCSAgfQoJICByZXR1cm4gb3V0Cgl9CgoJZnVuY3Rpb24gdXRmMTZsZVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgdmFyIGJ5dGVzID0gYnVmLnNsaWNlKHN0YXJ0LCBlbmQpCgkgIHZhciByZXMgPSAnJwoJICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzLmxlbmd0aDsgaSArPSAyKSB7CgkgICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0gKyBieXRlc1tpICsgMV0gKiAyNTYpCgkgIH0KCSAgcmV0dXJuIHJlcwoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiBzbGljZSAoc3RhcnQsIGVuZCkgewoJICB2YXIgbGVuID0gdGhpcy5sZW5ndGgKCSAgc3RhcnQgPSB+fnN0YXJ0CgkgIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogfn5lbmQKCgkgIGlmIChzdGFydCA8IDApIHsKCSAgICBzdGFydCArPSBsZW4KCSAgICBpZiAoc3RhcnQgPCAwKSBzdGFydCA9IDAKCSAgfSBlbHNlIGlmIChzdGFydCA+IGxlbikgewoJICAgIHN0YXJ0ID0gbGVuCgkgIH0KCgkgIGlmIChlbmQgPCAwKSB7CgkgICAgZW5kICs9IGxlbgoJICAgIGlmIChlbmQgPCAwKSBlbmQgPSAwCgkgIH0gZWxzZSBpZiAoZW5kID4gbGVuKSB7CgkgICAgZW5kID0gbGVuCgkgIH0KCgkgIGlmIChlbmQgPCBzdGFydCkgZW5kID0gc3RhcnQKCgkgIHZhciBuZXdCdWYKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgbmV3QnVmID0gdGhpcy5zdWJhcnJheShzdGFydCwgZW5kKQoJICAgIG5ld0J1Zi5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlCgkgIH0gZWxzZSB7CgkgICAgdmFyIHNsaWNlTGVuID0gZW5kIC0gc3RhcnQKCSAgICBuZXdCdWYgPSBuZXcgQnVmZmVyKHNsaWNlTGVuLCB1bmRlZmluZWQpCgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzbGljZUxlbjsgKytpKSB7CgkgICAgICBuZXdCdWZbaV0gPSB0aGlzW2kgKyBzdGFydF0KCSAgICB9CgkgIH0KCgkgIHJldHVybiBuZXdCdWYKCX0KCgkvKgoJICogTmVlZCB0byBtYWtlIHN1cmUgdGhhdCBidWZmZXIgaXNuJ3QgdHJ5aW5nIHRvIHdyaXRlIG91dCBvZiBib3VuZHMuCgkgKi8KCWZ1bmN0aW9uIGNoZWNrT2Zmc2V0IChvZmZzZXQsIGV4dCwgbGVuZ3RoKSB7CgkgIGlmICgob2Zmc2V0ICUgMSkgIT09IDAgfHwgb2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ29mZnNldCBpcyBub3QgdWludCcpCgkgIGlmIChvZmZzZXQgKyBleHQgPiBsZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoJykKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50TEUgPSBmdW5jdGlvbiByZWFkVUludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpCgoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdCgkgIHZhciBtdWwgPSAxCgkgIHZhciBpID0gMAoJICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsCgkgIH0KCgkgIHJldHVybiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50QkUgPSBmdW5jdGlvbiByZWFkVUludEJFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwCgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKQoJICB9CgoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWJ5dGVMZW5ndGhdCgkgIHZhciBtdWwgPSAxCgkgIHdoaWxlIChieXRlTGVuZ3RoID4gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0gKiBtdWwKCSAgfQoKCSAgcmV0dXJuIHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQ4ID0gZnVuY3Rpb24gcmVhZFVJbnQ4IChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiB0aGlzW29mZnNldF0KCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gKHRoaXNbb2Zmc2V0XSA8PCA4KSB8IHRoaXNbb2Zmc2V0ICsgMV0KCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MzJMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MzJMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoKCSAgcmV0dXJuICgodGhpc1tvZmZzZXRdKSB8CgkgICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8CgkgICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikpICsKCSAgICAgICh0aGlzW29mZnNldCArIDNdICogMHgxMDAwMDAwKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkJFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgoJICByZXR1cm4gKHRoaXNbb2Zmc2V0XSAqIDB4MTAwMDAwMCkgKwoJICAgICgodGhpc1tvZmZzZXQgKyAxXSA8PCAxNikgfAoJICAgICh0aGlzW29mZnNldCArIDJdIDw8IDgpIHwKCSAgICB0aGlzW29mZnNldCArIDNdKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludExFID0gZnVuY3Rpb24gcmVhZEludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpCgoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdCgkgIHZhciBtdWwgPSAxCgkgIHZhciBpID0gMAoJICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsCgkgIH0KCSAgbXVsICo9IDB4ODAKCgkgIGlmICh2YWwgPj0gbXVsKSB2YWwgLT0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpCgoJICByZXR1cm4gdmFsCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50QkUgPSBmdW5jdGlvbiByZWFkSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCkKCgkgIHZhciBpID0gYnl0ZUxlbmd0aAoJICB2YXIgbXVsID0gMQoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWldCgkgIHdoaWxlIChpID4gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0taV0gKiBtdWwKCSAgfQoJICBtdWwgKj0gMHg4MAoKCSAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkKCgkgIHJldHVybiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQ4ID0gZnVuY3Rpb24gcmVhZEludDggKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aCkKCSAgaWYgKCEodGhpc1tvZmZzZXRdICYgMHg4MCkpIHJldHVybiAodGhpc1tvZmZzZXRdKQoJICByZXR1cm4gKCgweGZmIC0gdGhpc1tvZmZzZXRdICsgMSkgKiAtMSkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkxFID0gZnVuY3Rpb24gcmVhZEludDE2TEUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aCkKCSAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XSB8ICh0aGlzW29mZnNldCArIDFdIDw8IDgpCgkgIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkJFID0gZnVuY3Rpb24gcmVhZEludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aCkKCSAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgMV0gfCAodGhpc1tvZmZzZXRdIDw8IDgpCgkgIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkxFID0gZnVuY3Rpb24gcmVhZEludDMyTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aCkKCgkgIHJldHVybiAodGhpc1tvZmZzZXRdKSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkgfAoJICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgM10gPDwgMjQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgoJICByZXR1cm4gKHRoaXNbb2Zmc2V0XSA8PCAyNCkgfAoJICAgICh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfAoJICAgICh0aGlzW29mZnNldCArIDNdKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0TEUgPSBmdW5jdGlvbiByZWFkRmxvYXRMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgMjMsIDQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRCRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdEJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgMjMsIDQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlTEUgPSBmdW5jdGlvbiByZWFkRG91YmxlTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aCkKCSAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIHRydWUsIDUyLCA4KQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUJFID0gZnVuY3Rpb24gcmVhZERvdWJsZUJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgNTIsIDgpCgl9CgoJZnVuY3Rpb24gY2hlY2tJbnQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikgewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCciYnVmZmVyIiBhcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyIGluc3RhbmNlJykKCSAgaWYgKHZhbHVlID4gbWF4IHx8IHZhbHVlIDwgbWluKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignInZhbHVlIiBhcmd1bWVudCBpcyBvdXQgb2YgYm91bmRzJykKCSAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIHZhciBtYXhCeXRlcyA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSAtIDEKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBtYXhCeXRlcywgMCkKCSAgfQoKCSAgdmFyIG11bCA9IDEKCSAgdmFyIGkgPSAwCgkgIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRgoJICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRgoJICB9CgoJICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnRCRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIHZhciBtYXhCeXRlcyA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSAtIDEKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBtYXhCeXRlcywgMCkKCSAgfQoKCSAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMQoJICB2YXIgbXVsID0gMQoJICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGCgkgIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRgoJICB9CgoJICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50OCA9IGZ1bmN0aW9uIHdyaXRlVUludDggKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMSwgMHhmZiwgMCkKCSAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKQoJICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKQoJICByZXR1cm4gb2Zmc2V0ICsgMQoJfQoKCWZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDE2IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikgewoJICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZiArIHZhbHVlICsgMQoJICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDIpOyBpIDwgajsgKytpKSB7CgkgICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlICYgKDB4ZmYgPDwgKDggKiAobGl0dGxlRW5kaWFuID8gaSA6IDEgLSBpKSkpKSA+Pj4KCSAgICAgIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpICogOAoJICB9Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKQoJICB9CgkgIHJldHVybiBvZmZzZXQgKyAyCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkJFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOCkKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZikKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgMgoJfQoKCWZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDMyIChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikgewoJICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZmZmZmYgKyB2YWx1ZSArIDEKCSAgZm9yICh2YXIgaSA9IDAsIGogPSBNYXRoLm1pbihidWYubGVuZ3RoIC0gb2Zmc2V0LCA0KTsgaSA8IGo7ICsraSkgewoJICAgIGJ1ZltvZmZzZXQgKyBpXSA9ICh2YWx1ZSA+Pj4gKGxpdHRsZUVuZGlhbiA/IGkgOiAzIC0gaSkgKiA4KSAmIDB4ZmYKCSAgfQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpCgkgICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpCgkgIH0KCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQzMkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpCgkgICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZikKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgNAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlSW50TEUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSkKCgkgICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbGltaXQgLSAxLCAtbGltaXQpCgkgIH0KCgkgIHZhciBpID0gMAoJICB2YXIgbXVsID0gMQoJICB2YXIgc3ViID0gMAoJICB0aGlzW29mZnNldF0gPSB2YWx1ZSAmIDB4RkYKCSAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHsKCSAgICBpZiAodmFsdWUgPCAwICYmIHN1YiA9PT0gMCAmJiB0aGlzW29mZnNldCArIGkgLSAxXSAhPT0gMCkgewoJICAgICAgc3ViID0gMQoJICAgIH0KCSAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGCgkgIH0KCgkgIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUludEJFID0gZnVuY3Rpb24gd3JpdGVJbnRCRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgdmFyIGxpbWl0ID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGggLSAxKQoKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdCkKCSAgfQoKCSAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMQoJICB2YXIgbXVsID0gMQoJICB2YXIgc3ViID0gMAoJICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGCgkgIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSArIDFdICE9PSAwKSB7CgkgICAgICBzdWIgPSAxCgkgICAgfQoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50OCA9IGZ1bmN0aW9uIHdyaXRlSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweDdmLCAtMHg4MCkKCSAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKQoJICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmYgKyB2YWx1ZSArIDEKCSAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgcmV0dXJuIG9mZnNldCArIDEKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKQoJICB9CgkgIHJldHVybiBvZmZzZXQgKyAyCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZUludDE2QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHg3ZmZmLCAtMHg4MDAwKQoJICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDgpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSAmIDB4ZmYpCgkgIH0gZWxzZSB7CgkgICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpCgkgIH0KCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KQoJICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KQoJICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpCgkgIH0KCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMCkKCSAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpCgkgICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZikKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgNAoJfQoKCWZ1bmN0aW9uIGNoZWNrSUVFRTc1NCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBleHQsIG1heCwgbWluKSB7CgkgIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJykKCSAgaWYgKG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKQoJfQoKCWZ1bmN0aW9uIHdyaXRlRmxvYXQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgNCwgMy40MDI4MjM0NjYzODUyODg2ZSszOCwgLTMuNDAyODIzNDY2Mzg1Mjg4NmUrMzgpCgkgIH0KCSAgaWVlZTc1NC53cml0ZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgMjMsIDQpCgkgIHJldHVybiBvZmZzZXQgKyA0Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0TEUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUsIG5vQXNzZXJ0KQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdEJFID0gZnVuY3Rpb24gd3JpdGVGbG9hdEJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICByZXR1cm4gd3JpdGVGbG9hdCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpCgl9CgoJZnVuY3Rpb24gd3JpdGVEb3VibGUgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgOCwgMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgsIC0xLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCkKCSAgfQoJICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCA1MiwgOCkKCSAgcmV0dXJuIG9mZnNldCArIDgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlTEUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUJFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgcmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydCkKCX0KCgkvLyBjb3B5KHRhcmdldEJ1ZmZlciwgdGFyZ2V0U3RhcnQ9MCwgc291cmNlU3RhcnQ9MCwgc291cmNlRW5kPWJ1ZmZlci5sZW5ndGgpCglCdWZmZXIucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiBjb3B5ICh0YXJnZXQsIHRhcmdldFN0YXJ0LCBzdGFydCwgZW5kKSB7CgkgIGlmICghc3RhcnQpIHN0YXJ0ID0gMAoJICBpZiAoIWVuZCAmJiBlbmQgIT09IDApIGVuZCA9IHRoaXMubGVuZ3RoCgkgIGlmICh0YXJnZXRTdGFydCA+PSB0YXJnZXQubGVuZ3RoKSB0YXJnZXRTdGFydCA9IHRhcmdldC5sZW5ndGgKCSAgaWYgKCF0YXJnZXRTdGFydCkgdGFyZ2V0U3RhcnQgPSAwCgkgIGlmIChlbmQgPiAwICYmIGVuZCA8IHN0YXJ0KSBlbmQgPSBzdGFydAoKCSAgLy8gQ29weSAwIGJ5dGVzOyB3ZSdyZSBkb25lCgkgIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm4gMAoJICBpZiAodGFyZ2V0Lmxlbmd0aCA9PT0gMCB8fCB0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDAKCgkgIC8vIEZhdGFsIGVycm9yIGNvbmRpdGlvbnMKCSAgaWYgKHRhcmdldFN0YXJ0IDwgMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCd0YXJnZXRTdGFydCBvdXQgb2YgYm91bmRzJykKCSAgfQoJICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlU3RhcnQgb3V0IG9mIGJvdW5kcycpCgkgIGlmIChlbmQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlRW5kIG91dCBvZiBib3VuZHMnKQoKCSAgLy8gQXJlIHdlIG9vYj8KCSAgaWYgKGVuZCA+IHRoaXMubGVuZ3RoKSBlbmQgPSB0aGlzLmxlbmd0aAoJICBpZiAodGFyZ2V0Lmxlbmd0aCAtIHRhcmdldFN0YXJ0IDwgZW5kIC0gc3RhcnQpIHsKCSAgICBlbmQgPSB0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgKyBzdGFydAoJICB9CgoJICB2YXIgbGVuID0gZW5kIC0gc3RhcnQKCSAgdmFyIGkKCgkgIGlmICh0aGlzID09PSB0YXJnZXQgJiYgc3RhcnQgPCB0YXJnZXRTdGFydCAmJiB0YXJnZXRTdGFydCA8IGVuZCkgewoJICAgIC8vIGRlc2NlbmRpbmcgY29weSBmcm9tIGVuZAoJICAgIGZvciAoaSA9IGxlbiAtIDE7IGkgPj0gMDsgLS1pKSB7CgkgICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XQoJICAgIH0KCSAgfSBlbHNlIGlmIChsZW4gPCAxMDAwIHx8ICFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIC8vIGFzY2VuZGluZyBjb3B5IGZyb20gc3RhcnQKCSAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyArK2kpIHsKCSAgICAgIHRhcmdldFtpICsgdGFyZ2V0U3RhcnRdID0gdGhpc1tpICsgc3RhcnRdCgkgICAgfQoJICB9IGVsc2UgewoJICAgIFVpbnQ4QXJyYXkucHJvdG90eXBlLnNldC5jYWxsKAoJICAgICAgdGFyZ2V0LAoJICAgICAgdGhpcy5zdWJhcnJheShzdGFydCwgc3RhcnQgKyBsZW4pLAoJICAgICAgdGFyZ2V0U3RhcnQKCSAgICApCgkgIH0KCgkgIHJldHVybiBsZW4KCX0KCgkvLyBVc2FnZToKCS8vICAgIGJ1ZmZlci5maWxsKG51bWJlclssIG9mZnNldFssIGVuZF1dKQoJLy8gICAgYnVmZmVyLmZpbGwoYnVmZmVyWywgb2Zmc2V0WywgZW5kXV0pCgkvLyAgICBidWZmZXIuZmlsbChzdHJpbmdbLCBvZmZzZXRbLCBlbmRdXVssIGVuY29kaW5nXSkKCUJ1ZmZlci5wcm90b3R5cGUuZmlsbCA9IGZ1bmN0aW9uIGZpbGwgKHZhbCwgc3RhcnQsIGVuZCwgZW5jb2RpbmcpIHsKCSAgLy8gSGFuZGxlIHN0cmluZyBjYXNlczoKCSAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7CgkgICAgaWYgKHR5cGVvZiBzdGFydCA9PT0gJ3N0cmluZycpIHsKCSAgICAgIGVuY29kaW5nID0gc3RhcnQKCSAgICAgIHN0YXJ0ID0gMAoJICAgICAgZW5kID0gdGhpcy5sZW5ndGgKCSAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbmQgPT09ICdzdHJpbmcnKSB7CgkgICAgICBlbmNvZGluZyA9IGVuZAoJICAgICAgZW5kID0gdGhpcy5sZW5ndGgKCSAgICB9CgkgICAgaWYgKHZhbC5sZW5ndGggPT09IDEpIHsKCSAgICAgIHZhciBjb2RlID0gdmFsLmNoYXJDb2RlQXQoMCkKCSAgICAgIGlmIChjb2RlIDwgMjU2KSB7CgkgICAgICAgIHZhbCA9IGNvZGUKCSAgICAgIH0KCSAgICB9CgkgICAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIGVuY29kaW5nICE9PSAnc3RyaW5nJykgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZW5jb2RpbmcgbXVzdCBiZSBhIHN0cmluZycpCgkgICAgfQoJICAgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnICYmICFCdWZmZXIuaXNFbmNvZGluZyhlbmNvZGluZykpIHsKCSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZykKCSAgICB9CgkgIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHsKCSAgICB2YWwgPSB2YWwgJiAyNTUKCSAgfQoKCSAgLy8gSW52YWxpZCByYW5nZXMgYXJlIG5vdCBzZXQgdG8gYSBkZWZhdWx0LCBzbyBjYW4gcmFuZ2UgY2hlY2sgZWFybHkuCgkgIGlmIChzdGFydCA8IDAgfHwgdGhpcy5sZW5ndGggPCBzdGFydCB8fCB0aGlzLmxlbmd0aCA8IGVuZCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdPdXQgb2YgcmFuZ2UgaW5kZXgnKQoJICB9CgoJICBpZiAoZW5kIDw9IHN0YXJ0KSB7CgkgICAgcmV0dXJuIHRoaXMKCSAgfQoKCSAgc3RhcnQgPSBzdGFydCA+Pj4gMAoJICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IHRoaXMubGVuZ3RoIDogZW5kID4+PiAwCgoJICBpZiAoIXZhbCkgdmFsID0gMAoKCSAgdmFyIGkKCSAgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7CgkgICAgZm9yIChpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkgewoJICAgICAgdGhpc1tpXSA9IHZhbAoJICAgIH0KCSAgfSBlbHNlIHsKCSAgICB2YXIgYnl0ZXMgPSBCdWZmZXIuaXNCdWZmZXIodmFsKQoJICAgICAgPyB2YWwKCSAgICAgIDogdXRmOFRvQnl0ZXMobmV3IEJ1ZmZlcih2YWwsIGVuY29kaW5nKS50b1N0cmluZygpKQoJICAgIHZhciBsZW4gPSBieXRlcy5sZW5ndGgKCSAgICBmb3IgKGkgPSAwOyBpIDwgZW5kIC0gc3RhcnQ7ICsraSkgewoJICAgICAgdGhpc1tpICsgc3RhcnRdID0gYnl0ZXNbaSAlIGxlbl0KCSAgICB9CgkgIH0KCgkgIHJldHVybiB0aGlzCgl9CgoJLy8gSEVMUEVSIEZVTkNUSU9OUwoJLy8gPT09PT09PT09PT09PT09PQoKCXZhciBJTlZBTElEX0JBU0U2NF9SRSA9IC9bXitcLzAtOUEtWmEtei1fXS9nCgoJZnVuY3Rpb24gYmFzZTY0Y2xlYW4gKHN0cikgewoJICAvLyBOb2RlIHN0cmlwcyBvdXQgaW52YWxpZCBjaGFyYWN0ZXJzIGxpa2UgXG4gYW5kIFx0IGZyb20gdGhlIHN0cmluZywgYmFzZTY0LWpzIGRvZXMgbm90CgkgIHN0ciA9IHN0cmluZ3RyaW0oc3RyKS5yZXBsYWNlKElOVkFMSURfQkFTRTY0X1JFLCAnJykKCSAgLy8gTm9kZSBjb252ZXJ0cyBzdHJpbmdzIHdpdGggbGVuZ3RoIDwgMiB0byAnJwoJICBpZiAoc3RyLmxlbmd0aCA8IDIpIHJldHVybiAnJwoJICAvLyBOb2RlIGFsbG93cyBmb3Igbm9uLXBhZGRlZCBiYXNlNjQgc3RyaW5ncyAobWlzc2luZyB0cmFpbGluZyA9PT0pLCBiYXNlNjQtanMgZG9lcyBub3QKCSAgd2hpbGUgKHN0ci5sZW5ndGggJSA0ICE9PSAwKSB7CgkgICAgc3RyID0gc3RyICsgJz0nCgkgIH0KCSAgcmV0dXJuIHN0cgoJfQoKCWZ1bmN0aW9uIHN0cmluZ3RyaW0gKHN0cikgewoJICBpZiAoc3RyLnRyaW0pIHJldHVybiBzdHIudHJpbSgpCgkgIHJldHVybiBzdHIucmVwbGFjZSgvXlxzK3xccyskL2csICcnKQoJfQoKCWZ1bmN0aW9uIHRvSGV4IChuKSB7CgkgIGlmIChuIDwgMTYpIHJldHVybiAnMCcgKyBuLnRvU3RyaW5nKDE2KQoJICByZXR1cm4gbi50b1N0cmluZygxNikKCX0KCglmdW5jdGlvbiB1dGY4VG9CeXRlcyAoc3RyaW5nLCB1bml0cykgewoJICB1bml0cyA9IHVuaXRzIHx8IEluZmluaXR5CgkgIHZhciBjb2RlUG9pbnQKCSAgdmFyIGxlbmd0aCA9IHN0cmluZy5sZW5ndGgKCSAgdmFyIGxlYWRTdXJyb2dhdGUgPSBudWxsCgkgIHZhciBieXRlcyA9IFtdCgoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CgkgICAgY29kZVBvaW50ID0gc3RyaW5nLmNoYXJDb2RlQXQoaSkKCgkgICAgLy8gaXMgc3Vycm9nYXRlIGNvbXBvbmVudAoJICAgIGlmIChjb2RlUG9pbnQgPiAweEQ3RkYgJiYgY29kZVBvaW50IDwgMHhFMDAwKSB7CgkgICAgICAvLyBsYXN0IGNoYXIgd2FzIGEgbGVhZAoJICAgICAgaWYgKCFsZWFkU3Vycm9nYXRlKSB7CgkgICAgICAgIC8vIG5vIGxlYWQgeWV0CgkgICAgICAgIGlmIChjb2RlUG9pbnQgPiAweERCRkYpIHsKCSAgICAgICAgICAvLyB1bmV4cGVjdGVkIHRyYWlsCgkgICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpCgkgICAgICAgICAgY29udGludWUKCSAgICAgICAgfSBlbHNlIGlmIChpICsgMSA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgLy8gdW5wYWlyZWQgbGVhZAoJICAgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKQoJICAgICAgICAgIGNvbnRpbnVlCgkgICAgICAgIH0KCgkgICAgICAgIC8vIHZhbGlkIGxlYWQKCSAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludAoKCSAgICAgICAgY29udGludWUKCSAgICAgIH0KCgkgICAgICAvLyAyIGxlYWRzIGluIGEgcm93CgkgICAgICBpZiAoY29kZVBvaW50IDwgMHhEQzAwKSB7CgkgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKQoJICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50CgkgICAgICAgIGNvbnRpbnVlCgkgICAgICB9CgoJICAgICAgLy8gdmFsaWQgc3Vycm9nYXRlIHBhaXIKCSAgICAgIGNvZGVQb2ludCA9IChsZWFkU3Vycm9nYXRlIC0gMHhEODAwIDw8IDEwIHwgY29kZVBvaW50IC0gMHhEQzAwKSArIDB4MTAwMDAKCSAgICB9IGVsc2UgaWYgKGxlYWRTdXJyb2dhdGUpIHsKCSAgICAgIC8vIHZhbGlkIGJtcCBjaGFyLCBidXQgbGFzdCBjaGFyIHdhcyBhIGxlYWQKCSAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKQoJICAgIH0KCgkgICAgbGVhZFN1cnJvZ2F0ZSA9IG51bGwKCgkgICAgLy8gZW5jb2RlIHV0ZjgKCSAgICBpZiAoY29kZVBvaW50IDwgMHg4MCkgewoJICAgICAgaWYgKCh1bml0cyAtPSAxKSA8IDApIGJyZWFrCgkgICAgICBieXRlcy5wdXNoKGNvZGVQb2ludCkKCSAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4ODAwKSB7CgkgICAgICBpZiAoKHVuaXRzIC09IDIpIDwgMCkgYnJlYWsKCSAgICAgIGJ5dGVzLnB1c2goCgkgICAgICAgIGNvZGVQb2ludCA+PiAweDYgfCAweEMwLAoJICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MAoJICAgICAgKQoJICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHgxMDAwMCkgewoJICAgICAgaWYgKCh1bml0cyAtPSAzKSA8IDApIGJyZWFrCgkgICAgICBieXRlcy5wdXNoKAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHhDIHwgMHhFMCwKCSAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLAoJICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MAoJICAgICAgKQoJICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHgxMTAwMDApIHsKCSAgICAgIGlmICgodW5pdHMgLT0gNCkgPCAwKSBicmVhawoJICAgICAgYnl0ZXMucHVzaCgKCSAgICAgICAgY29kZVBvaW50ID4+IDB4MTIgfCAweEYwLAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHhDICYgMHgzRiB8IDB4ODAsCgkgICAgICAgIGNvZGVQb2ludCA+PiAweDYgJiAweDNGIHwgMHg4MCwKCSAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODAKCSAgICAgICkKCSAgICB9IGVsc2UgewoJICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNvZGUgcG9pbnQnKQoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIGJ5dGVzCgl9CgoJZnVuY3Rpb24gYXNjaWlUb0J5dGVzIChzdHIpIHsKCSAgdmFyIGJ5dGVBcnJheSA9IFtdCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7CgkgICAgLy8gTm9kZSdzIGNvZGUgc2VlbXMgdG8gYmUgZG9pbmcgdGhpcyBhbmQgbm90ICYgMHg3Ri4uCgkgICAgYnl0ZUFycmF5LnB1c2goc3RyLmNoYXJDb2RlQXQoaSkgJiAweEZGKQoJICB9CgkgIHJldHVybiBieXRlQXJyYXkKCX0KCglmdW5jdGlvbiB1dGYxNmxlVG9CeXRlcyAoc3RyLCB1bml0cykgewoJICB2YXIgYywgaGksIGxvCgkgIHZhciBieXRlQXJyYXkgPSBbXQoJICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7ICsraSkgewoJICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVhawoKCSAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSkKCSAgICBoaSA9IGMgPj4gOAoJICAgIGxvID0gYyAlIDI1NgoJICAgIGJ5dGVBcnJheS5wdXNoKGxvKQoJICAgIGJ5dGVBcnJheS5wdXNoKGhpKQoJICB9CgoJICByZXR1cm4gYnl0ZUFycmF5Cgl9CgoJZnVuY3Rpb24gYmFzZTY0VG9CeXRlcyAoc3RyKSB7CgkgIHJldHVybiBiYXNlNjQudG9CeXRlQXJyYXkoYmFzZTY0Y2xlYW4oc3RyKSkKCX0KCglmdW5jdGlvbiBibGl0QnVmZmVyIChzcmMsIGRzdCwgb2Zmc2V0LCBsZW5ndGgpIHsKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewoJICAgIGlmICgoaSArIG9mZnNldCA+PSBkc3QubGVuZ3RoKSB8fCAoaSA+PSBzcmMubGVuZ3RoKSkgYnJlYWsKCSAgICBkc3RbaSArIG9mZnNldF0gPSBzcmNbaV0KCSAgfQoJICByZXR1cm4gaQoJfQoKCWZ1bmN0aW9uIGlzbmFuICh2YWwpIHsKCSAgcmV0dXJuIHZhbCAhPT0gdmFsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2VsZi1jb21wYXJlCgl9CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKQoKLyoqKi8gfSwKLyogOSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkndXNlIHN0cmljdCcKCglleHBvcnRzLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoCglleHBvcnRzLnRvQnl0ZUFycmF5ID0gdG9CeXRlQXJyYXkKCWV4cG9ydHMuZnJvbUJ5dGVBcnJheSA9IGZyb21CeXRlQXJyYXkKCgl2YXIgbG9va3VwID0gW10KCXZhciByZXZMb29rdXAgPSBbXQoJdmFyIEFyciA9IHR5cGVvZiBVaW50OEFycmF5ICE9PSAndW5kZWZpbmVkJyA/IFVpbnQ4QXJyYXkgOiBBcnJheQoKCXZhciBjb2RlID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nCglmb3IgKHZhciBpID0gMCwgbGVuID0gY29kZS5sZW5ndGg7IGkgPCBsZW47ICsraSkgewoJICBsb29rdXBbaV0gPSBjb2RlW2ldCgkgIHJldkxvb2t1cFtjb2RlLmNoYXJDb2RlQXQoaSldID0gaQoJfQoKCXJldkxvb2t1cFsnLScuY2hhckNvZGVBdCgwKV0gPSA2MgoJcmV2TG9va3VwWydfJy5jaGFyQ29kZUF0KDApXSA9IDYzCgoJZnVuY3Rpb24gcGxhY2VIb2xkZXJzQ291bnQgKGI2NCkgewoJICB2YXIgbGVuID0gYjY0Lmxlbmd0aAoJICBpZiAobGVuICUgNCA+IDApIHsKCSAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgc3RyaW5nLiBMZW5ndGggbXVzdCBiZSBhIG11bHRpcGxlIG9mIDQnKQoJICB9CgoJICAvLyB0aGUgbnVtYmVyIG9mIGVxdWFsIHNpZ25zIChwbGFjZSBob2xkZXJzKQoJICAvLyBpZiB0aGVyZSBhcmUgdHdvIHBsYWNlaG9sZGVycywgdGhhbiB0aGUgdHdvIGNoYXJhY3RlcnMgYmVmb3JlIGl0CgkgIC8vIHJlcHJlc2VudCBvbmUgYnl0ZQoJICAvLyBpZiB0aGVyZSBpcyBvbmx5IG9uZSwgdGhlbiB0aGUgdGhyZWUgY2hhcmFjdGVycyBiZWZvcmUgaXQgcmVwcmVzZW50IDIgYnl0ZXMKCSAgLy8gdGhpcyBpcyBqdXN0IGEgY2hlYXAgaGFjayB0byBub3QgZG8gaW5kZXhPZiB0d2ljZQoJICByZXR1cm4gYjY0W2xlbiAtIDJdID09PSAnPScgPyAyIDogYjY0W2xlbiAtIDFdID09PSAnPScgPyAxIDogMAoJfQoKCWZ1bmN0aW9uIGJ5dGVMZW5ndGggKGI2NCkgewoJICAvLyBiYXNlNjQgaXMgNC8zICsgdXAgdG8gdHdvIGNoYXJhY3RlcnMgb2YgdGhlIG9yaWdpbmFsIGRhdGEKCSAgcmV0dXJuIGI2NC5sZW5ndGggKiAzIC8gNCAtIHBsYWNlSG9sZGVyc0NvdW50KGI2NCkKCX0KCglmdW5jdGlvbiB0b0J5dGVBcnJheSAoYjY0KSB7CgkgIHZhciBpLCBqLCBsLCB0bXAsIHBsYWNlSG9sZGVycywgYXJyCgkgIHZhciBsZW4gPSBiNjQubGVuZ3RoCgkgIHBsYWNlSG9sZGVycyA9IHBsYWNlSG9sZGVyc0NvdW50KGI2NCkKCgkgIGFyciA9IG5ldyBBcnIobGVuICogMyAvIDQgLSBwbGFjZUhvbGRlcnMpCgoJICAvLyBpZiB0aGVyZSBhcmUgcGxhY2Vob2xkZXJzLCBvbmx5IGdldCB1cCB0byB0aGUgbGFzdCBjb21wbGV0ZSA0IGNoYXJzCgkgIGwgPSBwbGFjZUhvbGRlcnMgPiAwID8gbGVuIC0gNCA6IGxlbgoKCSAgdmFyIEwgPSAwCgoJICBmb3IgKGkgPSAwLCBqID0gMDsgaSA8IGw7IGkgKz0gNCwgaiArPSAzKSB7CgkgICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMTgpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDEyKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDIpXSA8PCA2KSB8IHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMyldCgkgICAgYXJyW0wrK10gPSAodG1wID4+IDE2KSAmIDB4RkYKCSAgICBhcnJbTCsrXSA9ICh0bXAgPj4gOCkgJiAweEZGCgkgICAgYXJyW0wrK10gPSB0bXAgJiAweEZGCgkgIH0KCgkgIGlmIChwbGFjZUhvbGRlcnMgPT09IDIpIHsKCSAgICB0bXAgPSAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAyKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDEpXSA+PiA0KQoJICAgIGFycltMKytdID0gdG1wICYgMHhGRgoJICB9IGVsc2UgaWYgKHBsYWNlSG9sZGVycyA9PT0gMSkgewoJICAgIHRtcCA9IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDEwKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDEpXSA8PCA0KSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDIpXSA+PiAyKQoJICAgIGFycltMKytdID0gKHRtcCA+PiA4KSAmIDB4RkYKCSAgICBhcnJbTCsrXSA9IHRtcCAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIGFycgoJfQoKCWZ1bmN0aW9uIHRyaXBsZXRUb0Jhc2U2NCAobnVtKSB7CgkgIHJldHVybiBsb29rdXBbbnVtID4+IDE4ICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDEyICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDYgJiAweDNGXSArIGxvb2t1cFtudW0gJiAweDNGXQoJfQoKCWZ1bmN0aW9uIGVuY29kZUNodW5rICh1aW50OCwgc3RhcnQsIGVuZCkgewoJICB2YXIgdG1wCgkgIHZhciBvdXRwdXQgPSBbXQoJICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkgKz0gMykgewoJICAgIHRtcCA9ICh1aW50OFtpXSA8PCAxNikgKyAodWludDhbaSArIDFdIDw8IDgpICsgKHVpbnQ4W2kgKyAyXSkKCSAgICBvdXRwdXQucHVzaCh0cmlwbGV0VG9CYXNlNjQodG1wKSkKCSAgfQoJICByZXR1cm4gb3V0cHV0LmpvaW4oJycpCgl9CgoJZnVuY3Rpb24gZnJvbUJ5dGVBcnJheSAodWludDgpIHsKCSAgdmFyIHRtcAoJICB2YXIgbGVuID0gdWludDgubGVuZ3RoCgkgIHZhciBleHRyYUJ5dGVzID0gbGVuICUgMyAvLyBpZiB3ZSBoYXZlIDEgYnl0ZSBsZWZ0LCBwYWQgMiBieXRlcwoJICB2YXIgb3V0cHV0ID0gJycKCSAgdmFyIHBhcnRzID0gW10KCSAgdmFyIG1heENodW5rTGVuZ3RoID0gMTYzODMgLy8gbXVzdCBiZSBtdWx0aXBsZSBvZiAzCgoJICAvLyBnbyB0aHJvdWdoIHRoZSBhcnJheSBldmVyeSB0aHJlZSBieXRlcywgd2UnbGwgZGVhbCB3aXRoIHRyYWlsaW5nIHN0dWZmIGxhdGVyCgkgIGZvciAodmFyIGkgPSAwLCBsZW4yID0gbGVuIC0gZXh0cmFCeXRlczsgaSA8IGxlbjI7IGkgKz0gbWF4Q2h1bmtMZW5ndGgpIHsKCSAgICBwYXJ0cy5wdXNoKGVuY29kZUNodW5rKHVpbnQ4LCBpLCAoaSArIG1heENodW5rTGVuZ3RoKSA+IGxlbjIgPyBsZW4yIDogKGkgKyBtYXhDaHVua0xlbmd0aCkpKQoJICB9CgoJICAvLyBwYWQgdGhlIGVuZCB3aXRoIHplcm9zLCBidXQgbWFrZSBzdXJlIHRvIG5vdCBmb3JnZXQgdGhlIGV4dHJhIGJ5dGVzCgkgIGlmIChleHRyYUJ5dGVzID09PSAxKSB7CgkgICAgdG1wID0gdWludDhbbGVuIC0gMV0KCSAgICBvdXRwdXQgKz0gbG9va3VwW3RtcCA+PiAyXQoJICAgIG91dHB1dCArPSBsb29rdXBbKHRtcCA8PCA0KSAmIDB4M0ZdCgkgICAgb3V0cHV0ICs9ICc9PScKCSAgfSBlbHNlIGlmIChleHRyYUJ5dGVzID09PSAyKSB7CgkgICAgdG1wID0gKHVpbnQ4W2xlbiAtIDJdIDw8IDgpICsgKHVpbnQ4W2xlbiAtIDFdKQoJICAgIG91dHB1dCArPSBsb29rdXBbdG1wID4+IDEwXQoJICAgIG91dHB1dCArPSBsb29rdXBbKHRtcCA+PiA0KSAmIDB4M0ZdCgkgICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wIDw8IDIpICYgMHgzRl0KCSAgICBvdXRwdXQgKz0gJz0nCgkgIH0KCgkgIHBhcnRzLnB1c2gob3V0cHV0KQoKCSAgcmV0dXJuIHBhcnRzLmpvaW4oJycpCgl9CgoKLyoqKi8gfSwKLyogMTAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJZXhwb3J0cy5yZWFkID0gZnVuY3Rpb24gKGJ1ZmZlciwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHsKCSAgdmFyIGUsIG0KCSAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDEKCSAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDEKCSAgdmFyIGVCaWFzID0gZU1heCA+PiAxCgkgIHZhciBuQml0cyA9IC03CgkgIHZhciBpID0gaXNMRSA/IChuQnl0ZXMgLSAxKSA6IDAKCSAgdmFyIGQgPSBpc0xFID8gLTEgOiAxCgkgIHZhciBzID0gYnVmZmVyW29mZnNldCArIGldCgoJICBpICs9IGQKCgkgIGUgPSBzICYgKCgxIDw8ICgtbkJpdHMpKSAtIDEpCgkgIHMgPj49ICgtbkJpdHMpCgkgIG5CaXRzICs9IGVMZW4KCSAgZm9yICg7IG5CaXRzID4gMDsgZSA9IGUgKiAyNTYgKyBidWZmZXJbb2Zmc2V0ICsgaV0sIGkgKz0gZCwgbkJpdHMgLT0gOCkge30KCgkgIG0gPSBlICYgKCgxIDw8ICgtbkJpdHMpKSAtIDEpCgkgIGUgPj49ICgtbkJpdHMpCgkgIG5CaXRzICs9IG1MZW4KCSAgZm9yICg7IG5CaXRzID4gMDsgbSA9IG0gKiAyNTYgKyBidWZmZXJbb2Zmc2V0ICsgaV0sIGkgKz0gZCwgbkJpdHMgLT0gOCkge30KCgkgIGlmIChlID09PSAwKSB7CgkgICAgZSA9IDEgLSBlQmlhcwoJICB9IGVsc2UgaWYgKGUgPT09IGVNYXgpIHsKCSAgICByZXR1cm4gbSA/IE5hTiA6ICgocyA/IC0xIDogMSkgKiBJbmZpbml0eSkKCSAgfSBlbHNlIHsKCSAgICBtID0gbSArIE1hdGgucG93KDIsIG1MZW4pCgkgICAgZSA9IGUgLSBlQmlhcwoJICB9CgkgIHJldHVybiAocyA/IC0xIDogMSkgKiBtICogTWF0aC5wb3coMiwgZSAtIG1MZW4pCgl9CgoJZXhwb3J0cy53cml0ZSA9IGZ1bmN0aW9uIChidWZmZXIsIHZhbHVlLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykgewoJICB2YXIgZSwgbSwgYwoJICB2YXIgZUxlbiA9IG5CeXRlcyAqIDggLSBtTGVuIC0gMQoJICB2YXIgZU1heCA9ICgxIDw8IGVMZW4pIC0gMQoJICB2YXIgZUJpYXMgPSBlTWF4ID4+IDEKCSAgdmFyIHJ0ID0gKG1MZW4gPT09IDIzID8gTWF0aC5wb3coMiwgLTI0KSAtIE1hdGgucG93KDIsIC03NykgOiAwKQoJICB2YXIgaSA9IGlzTEUgPyAwIDogKG5CeXRlcyAtIDEpCgkgIHZhciBkID0gaXNMRSA/IDEgOiAtMQoJICB2YXIgcyA9IHZhbHVlIDwgMCB8fCAodmFsdWUgPT09IDAgJiYgMSAvIHZhbHVlIDwgMCkgPyAxIDogMAoKCSAgdmFsdWUgPSBNYXRoLmFicyh2YWx1ZSkKCgkgIGlmIChpc05hTih2YWx1ZSkgfHwgdmFsdWUgPT09IEluZmluaXR5KSB7CgkgICAgbSA9IGlzTmFOKHZhbHVlKSA/IDEgOiAwCgkgICAgZSA9IGVNYXgKCSAgfSBlbHNlIHsKCSAgICBlID0gTWF0aC5mbG9vcihNYXRoLmxvZyh2YWx1ZSkgLyBNYXRoLkxOMikKCSAgICBpZiAodmFsdWUgKiAoYyA9IE1hdGgucG93KDIsIC1lKSkgPCAxKSB7CgkgICAgICBlLS0KCSAgICAgIGMgKj0gMgoJICAgIH0KCSAgICBpZiAoZSArIGVCaWFzID49IDEpIHsKCSAgICAgIHZhbHVlICs9IHJ0IC8gYwoJICAgIH0gZWxzZSB7CgkgICAgICB2YWx1ZSArPSBydCAqIE1hdGgucG93KDIsIDEgLSBlQmlhcykKCSAgICB9CgkgICAgaWYgKHZhbHVlICogYyA+PSAyKSB7CgkgICAgICBlKysKCSAgICAgIGMgLz0gMgoJICAgIH0KCgkgICAgaWYgKGUgKyBlQmlhcyA+PSBlTWF4KSB7CgkgICAgICBtID0gMAoJICAgICAgZSA9IGVNYXgKCSAgICB9IGVsc2UgaWYgKGUgKyBlQmlhcyA+PSAxKSB7CgkgICAgICBtID0gKHZhbHVlICogYyAtIDEpICogTWF0aC5wb3coMiwgbUxlbikKCSAgICAgIGUgPSBlICsgZUJpYXMKCSAgICB9IGVsc2UgewoJICAgICAgbSA9IHZhbHVlICogTWF0aC5wb3coMiwgZUJpYXMgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pCgkgICAgICBlID0gMAoJICAgIH0KCSAgfQoKCSAgZm9yICg7IG1MZW4gPj0gODsgYnVmZmVyW29mZnNldCArIGldID0gbSAmIDB4ZmYsIGkgKz0gZCwgbSAvPSAyNTYsIG1MZW4gLT0gOCkge30KCgkgIGUgPSAoZSA8PCBtTGVuKSB8IG0KCSAgZUxlbiArPSBtTGVuCgkgIGZvciAoOyBlTGVuID4gMDsgYnVmZmVyW29mZnNldCArIGldID0gZSAmIDB4ZmYsIGkgKz0gZCwgZSAvPSAyNTYsIGVMZW4gLT0gOCkge30KCgkgIGJ1ZmZlcltvZmZzZXQgKyBpIC0gZF0gfD0gcyAqIDEyOAoJfQoKCi8qKiovIH0sCi8qIDExICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCXZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nOwoKCW1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoYXJyKSB7CgkgIHJldHVybiB0b1N0cmluZy5jYWxsKGFycikgPT0gJ1tvYmplY3QgQXJyYXldJzsKCX07CgoKLyoqKi8gfSwKLyogMTIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyCgl2YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307CgoJLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0CgkvLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXMKCS8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGEKCS8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuCgoJdmFyIGNhY2hlZFNldFRpbWVvdXQ7Cgl2YXIgY2FjaGVkQ2xlYXJUaW1lb3V0OwoKCWZ1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKCdzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7Cgl9CglmdW5jdGlvbiBkZWZhdWx0Q2xlYXJUaW1lb3V0ICgpIHsKCSAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpOwoJfQoJKGZ1bmN0aW9uICgpIHsKCSAgICB0cnkgewoJICAgICAgICBpZiAodHlwZW9mIHNldFRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHsKCSAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0OwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7CgkgICAgICAgIH0KCSAgICB9IGNhdGNoIChlKSB7CgkgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0OwoJICAgIH0KCSAgICB0cnkgewoJICAgICAgICBpZiAodHlwZW9mIGNsZWFyVGltZW91dCA9PT0gJ2Z1bmN0aW9uJykgewoJICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0OwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDsKCSAgICAgICAgfQoJICAgIH0gY2F0Y2ggKGUpIHsKCSAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDsKCSAgICB9Cgl9ICgpKQoJZnVuY3Rpb24gcnVuVGltZW91dChmdW4pIHsKCSAgICBpZiAoY2FjaGVkU2V0VGltZW91dCA9PT0gc2V0VGltZW91dCkgewoJICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnMKCSAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTsKCSAgICB9CgkgICAgLy8gaWYgc2V0VGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWQKCSAgICBpZiAoKGNhY2hlZFNldFRpbWVvdXQgPT09IGRlZmF1bHRTZXRUaW1vdXQgfHwgIWNhY2hlZFNldFRpbWVvdXQpICYmIHNldFRpbWVvdXQpIHsKCSAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7CgkgICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7CgkgICAgfQoJICAgIHRyeSB7CgkgICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3MKCSAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQoZnVuLCAwKTsKCSAgICB9IGNhdGNoKGUpewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0IHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5CgkgICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKG51bGwsIGZ1biwgMCk7CgkgICAgICAgIH0gY2F0Y2goZSl7CgkgICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvcgoJICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbCh0aGlzLCBmdW4sIDApOwoJICAgICAgICB9CgkgICAgfQoKCgl9CglmdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7CgkgICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7CgkgICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9ucwoJICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7CgkgICAgfQoJICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWQKCSAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHsKCSAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0OwoJICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7CgkgICAgfQoJICAgIHRyeSB7CgkgICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3MKCSAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpOwoJICAgIH0gY2F0Y2ggKGUpewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseQoJICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7CgkgICAgICAgIH0gY2F0Y2ggKGUpewoJICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuCgkgICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0CgkgICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTsKCSAgICAgICAgfQoJICAgIH0KCgoKCX0KCXZhciBxdWV1ZSA9IFtdOwoJdmFyIGRyYWluaW5nID0gZmFsc2U7Cgl2YXIgY3VycmVudFF1ZXVlOwoJdmFyIHF1ZXVlSW5kZXggPSAtMTsKCglmdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7CgkgICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7CgkgICAgICAgIHJldHVybjsKCSAgICB9CgkgICAgZHJhaW5pbmcgPSBmYWxzZTsKCSAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkgewoJICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpOwoJICAgIH0gZWxzZSB7CgkgICAgICAgIHF1ZXVlSW5kZXggPSAtMTsKCSAgICB9CgkgICAgaWYgKHF1ZXVlLmxlbmd0aCkgewoJICAgICAgICBkcmFpblF1ZXVlKCk7CgkgICAgfQoJfQoKCWZ1bmN0aW9uIGRyYWluUXVldWUoKSB7CgkgICAgaWYgKGRyYWluaW5nKSB7CgkgICAgICAgIHJldHVybjsKCSAgICB9CgkgICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7CgkgICAgZHJhaW5pbmcgPSB0cnVlOwoKCSAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoOwoJICAgIHdoaWxlKGxlbikgewoJICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTsKCSAgICAgICAgcXVldWUgPSBbXTsKCSAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikgewoJICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkgewoJICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBxdWV1ZUluZGV4ID0gLTE7CgkgICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDsKCSAgICB9CgkgICAgY3VycmVudFF1ZXVlID0gbnVsbDsKCSAgICBkcmFpbmluZyA9IGZhbHNlOwoJICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTsKCX0KCglwcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikgewoJICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTsKCSAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldOwoJICAgICAgICB9CgkgICAgfQoJICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7CgkgICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHsKCSAgICAgICAgcnVuVGltZW91dChkcmFpblF1ZXVlKTsKCSAgICB9Cgl9OwoKCS8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHMKCWZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkgewoJICAgIHRoaXMuZnVuID0gZnVuOwoJICAgIHRoaXMuYXJyYXkgPSBhcnJheTsKCX0KCUl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHsKCSAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTsKCX07Cglwcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInOwoJcHJvY2Vzcy5icm93c2VyID0gdHJ1ZTsKCXByb2Nlc3MuZW52ID0ge307Cglwcm9jZXNzLmFyZ3YgPSBbXTsKCXByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3VlcwoJcHJvY2Vzcy52ZXJzaW9ucyA9IHt9OwoKCWZ1bmN0aW9uIG5vb3AoKSB7fQoKCXByb2Nlc3Mub24gPSBub29wOwoJcHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7Cglwcm9jZXNzLm9uY2UgPSBub29wOwoJcHJvY2Vzcy5vZmYgPSBub29wOwoJcHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7Cglwcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7Cglwcm9jZXNzLmVtaXQgPSBub29wOwoKCXByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpOwoJfTsKCglwcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9OwoJcHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHsKCSAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpOwoJfTsKCXByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07CgoKLyoqKi8gfSwKLyogMTMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCkge2V4cG9ydHMuZmV0Y2ggPSBpc0Z1bmN0aW9uKGdsb2JhbC5mZXRjaCkgJiYgaXNGdW5jdGlvbihnbG9iYWwuUmVhZGFibGVTdHJlYW0pCgoJZXhwb3J0cy5ibG9iQ29uc3RydWN0b3IgPSBmYWxzZQoJdHJ5IHsKCQluZXcgQmxvYihbbmV3IEFycmF5QnVmZmVyKDEpXSkKCQlleHBvcnRzLmJsb2JDb25zdHJ1Y3RvciA9IHRydWUKCX0gY2F0Y2ggKGUpIHt9CgoJLy8gVGhlIHhociByZXF1ZXN0IHRvIGV4YW1wbGUuY29tIG1heSB2aW9sYXRlIHNvbWUgcmVzdHJpY3RpdmUgQ1NQIGNvbmZpZ3VyYXRpb25zLAoJLy8gc28gaWYgd2UncmUgcnVubmluZyBpbiBhIGJyb3dzZXIgdGhhdCBzdXBwb3J0cyBgZmV0Y2hgLCBhdm9pZCBjYWxsaW5nIGdldFhIUigpCgkvLyBhbmQgYXNzdW1lIHN1cHBvcnQgZm9yIGNlcnRhaW4gZmVhdHVyZXMgYmVsb3cuCgl2YXIgeGhyCglmdW5jdGlvbiBnZXRYSFIgKCkgewoJCS8vIENhY2hlIHRoZSB4aHIgdmFsdWUKCQlpZiAoeGhyICE9PSB1bmRlZmluZWQpIHJldHVybiB4aHIKCgkJaWYgKGdsb2JhbC5YTUxIdHRwUmVxdWVzdCkgewoJCQl4aHIgPSBuZXcgZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0KCkKCQkJLy8gSWYgWERvbWFpblJlcXVlc3QgaXMgYXZhaWxhYmxlIChpZSBvbmx5LCB3aGVyZSB4aHIgbWlnaHQgbm90IHdvcmsKCQkJLy8gY3Jvc3MgZG9tYWluKSwgdXNlIHRoZSBwYWdlIGxvY2F0aW9uLiBPdGhlcndpc2UgdXNlIGV4YW1wbGUuY29tCgkJCS8vIE5vdGU6IHRoaXMgZG9lc24ndCBhY3R1YWxseSBtYWtlIGFuIGh0dHAgcmVxdWVzdC4KCQkJdHJ5IHsKCQkJCXhoci5vcGVuKCdHRVQnLCBnbG9iYWwuWERvbWFpblJlcXVlc3QgPyAnLycgOiAnaHR0cHM6Ly9leGFtcGxlLmNvbScpCgkJCX0gY2F0Y2goZSkgewoJCQkJeGhyID0gbnVsbAoJCQl9CgkJfSBlbHNlIHsKCQkJLy8gU2VydmljZSB3b3JrZXJzIGRvbid0IGhhdmUgWEhSCgkJCXhociA9IG51bGwKCQl9CgkJcmV0dXJuIHhocgoJfQoKCWZ1bmN0aW9uIGNoZWNrVHlwZVN1cHBvcnQgKHR5cGUpIHsKCQl2YXIgeGhyID0gZ2V0WEhSKCkKCQlpZiAoIXhocikgcmV0dXJuIGZhbHNlCgkJdHJ5IHsKCQkJeGhyLnJlc3BvbnNlVHlwZSA9IHR5cGUKCQkJcmV0dXJuIHhoci5yZXNwb25zZVR5cGUgPT09IHR5cGUKCQl9IGNhdGNoIChlKSB7fQoJCXJldHVybiBmYWxzZQoJfQoKCS8vIEZvciBzb21lIHN0cmFuZ2UgcmVhc29uLCBTYWZhcmkgNy4wIHJlcG9ydHMgdHlwZW9mIGdsb2JhbC5BcnJheUJ1ZmZlciA9PT0gJ29iamVjdCcuCgkvLyBTYWZhcmkgNy4xIGFwcGVhcnMgdG8gaGF2ZSBmaXhlZCB0aGlzIGJ1Zy4KCXZhciBoYXZlQXJyYXlCdWZmZXIgPSB0eXBlb2YgZ2xvYmFsLkFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJwoJdmFyIGhhdmVTbGljZSA9IGhhdmVBcnJheUJ1ZmZlciAmJiBpc0Z1bmN0aW9uKGdsb2JhbC5BcnJheUJ1ZmZlci5wcm90b3R5cGUuc2xpY2UpCgoJLy8gSWYgZmV0Y2ggaXMgc3VwcG9ydGVkLCB0aGVuIGFycmF5YnVmZmVyIHdpbGwgYmUgc3VwcG9ydGVkIHRvby4gU2tpcCBjYWxsaW5nCgkvLyBjaGVja1R5cGVTdXBwb3J0KCksIHNpbmNlIHRoYXQgY2FsbHMgZ2V0WEhSKCkuCglleHBvcnRzLmFycmF5YnVmZmVyID0gZXhwb3J0cy5mZXRjaCB8fCAoaGF2ZUFycmF5QnVmZmVyICYmIGNoZWNrVHlwZVN1cHBvcnQoJ2FycmF5YnVmZmVyJykpCgoJLy8gVGhlc2UgbmV4dCB0d28gdGVzdHMgdW5hdm9pZGFibHkgc2hvdyB3YXJuaW5ncyBpbiBDaHJvbWUuIFNpbmNlIGZldGNoIHdpbGwgYWx3YXlzCgkvLyBiZSB1c2VkIGlmIGl0J3MgYXZhaWxhYmxlLCBqdXN0IHJldHVybiBmYWxzZSBmb3IgdGhlc2UgdG8gYXZvaWQgdGhlIHdhcm5pbmdzLgoJZXhwb3J0cy5tc3N0cmVhbSA9ICFleHBvcnRzLmZldGNoICYmIGhhdmVTbGljZSAmJiBjaGVja1R5cGVTdXBwb3J0KCdtcy1zdHJlYW0nKQoJZXhwb3J0cy5tb3pjaHVua2VkYXJyYXlidWZmZXIgPSAhZXhwb3J0cy5mZXRjaCAmJiBoYXZlQXJyYXlCdWZmZXIgJiYKCQljaGVja1R5cGVTdXBwb3J0KCdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcicpCgoJLy8gSWYgZmV0Y2ggaXMgc3VwcG9ydGVkLCB0aGVuIG92ZXJyaWRlTWltZVR5cGUgd2lsbCBiZSBzdXBwb3J0ZWQgdG9vLiBTa2lwIGNhbGxpbmcKCS8vIGdldFhIUigpLgoJZXhwb3J0cy5vdmVycmlkZU1pbWVUeXBlID0gZXhwb3J0cy5mZXRjaCB8fCAoZ2V0WEhSKCkgPyBpc0Z1bmN0aW9uKGdldFhIUigpLm92ZXJyaWRlTWltZVR5cGUpIDogZmFsc2UpCgoJZXhwb3J0cy52YkFycmF5ID0gaXNGdW5jdGlvbihnbG9iYWwuVkJBcnJheSkKCglmdW5jdGlvbiBpc0Z1bmN0aW9uICh2YWx1ZSkgewoJCXJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicKCX0KCgl4aHIgPSBudWxsIC8vIEhlbHAgZ2MKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpCgovKioqLyB9LAovKiAxNCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCglpZiAodHlwZW9mIE9iamVjdC5jcmVhdGUgPT09ICdmdW5jdGlvbicpIHsKCSAgLy8gaW1wbGVtZW50YXRpb24gZnJvbSBzdGFuZGFyZCBub2RlLmpzICd1dGlsJyBtb2R1bGUKCSAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpbmhlcml0cyhjdG9yLCBzdXBlckN0b3IpIHsKCSAgICBjdG9yLnN1cGVyXyA9IHN1cGVyQ3RvcgoJICAgIGN0b3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckN0b3IucHJvdG90eXBlLCB7CgkgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICB2YWx1ZTogY3RvciwKCSAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICAgIHdyaXRhYmxlOiB0cnVlLAoJICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgIH0KCSAgICB9KTsKCSAgfTsKCX0gZWxzZSB7CgkgIC8vIG9sZCBzY2hvb2wgc2hpbSBmb3Igb2xkIGJyb3dzZXJzCgkgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaW5oZXJpdHMoY3Rvciwgc3VwZXJDdG9yKSB7CgkgICAgY3Rvci5zdXBlcl8gPSBzdXBlckN0b3IKCSAgICB2YXIgVGVtcEN0b3IgPSBmdW5jdGlvbiAoKSB7fQoJICAgIFRlbXBDdG9yLnByb3RvdHlwZSA9IHN1cGVyQ3Rvci5wcm90b3R5cGUKCSAgICBjdG9yLnByb3RvdHlwZSA9IG5ldyBUZW1wQ3RvcigpCgkgICAgY3Rvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBjdG9yCgkgIH0KCX0KCgovKioqLyB9LAovKiAxNSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24ocHJvY2VzcywgQnVmZmVyLCBnbG9iYWwpIHt2YXIgY2FwYWJpbGl0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCgl2YXIgaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQoJdmFyIHN0cmVhbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCgoJdmFyIHJTdGF0ZXMgPSBleHBvcnRzLnJlYWR5U3RhdGVzID0gewoJCVVOU0VOVDogMCwKCQlPUEVORUQ6IDEsCgkJSEVBREVSU19SRUNFSVZFRDogMiwKCQlMT0FESU5HOiAzLAoJCURPTkU6IDQKCX0KCgl2YXIgSW5jb21pbmdNZXNzYWdlID0gZXhwb3J0cy5JbmNvbWluZ01lc3NhZ2UgPSBmdW5jdGlvbiAoeGhyLCByZXNwb25zZSwgbW9kZSkgewoJCXZhciBzZWxmID0gdGhpcwoJCXN0cmVhbS5SZWFkYWJsZS5jYWxsKHNlbGYpCgoJCXNlbGYuX21vZGUgPSBtb2RlCgkJc2VsZi5oZWFkZXJzID0ge30KCQlzZWxmLnJhd0hlYWRlcnMgPSBbXQoJCXNlbGYudHJhaWxlcnMgPSB7fQoJCXNlbGYucmF3VHJhaWxlcnMgPSBbXQoKCQkvLyBGYWtlIHRoZSAnY2xvc2UnIGV2ZW50LCBidXQgb25seSBvbmNlICdlbmQnIGZpcmVzCgkJc2VsZi5vbignZW5kJywgZnVuY3Rpb24gKCkgewoJCQkvLyBUaGUgbmV4dFRpY2sgaXMgbmVjZXNzYXJ5IHRvIHByZXZlbnQgdGhlICdyZXF1ZXN0JyBtb2R1bGUgZnJvbSBjYXVzaW5nIGFuIGluZmluaXRlIGxvb3AKCQkJcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7CgkJCQlzZWxmLmVtaXQoJ2Nsb3NlJykKCQkJfSkKCQl9KQoKCQlpZiAobW9kZSA9PT0gJ2ZldGNoJykgewoJCQlzZWxmLl9mZXRjaFJlc3BvbnNlID0gcmVzcG9uc2UKCgkJCXNlbGYudXJsID0gcmVzcG9uc2UudXJsCgkJCXNlbGYuc3RhdHVzQ29kZSA9IHJlc3BvbnNlLnN0YXR1cwoJCQlzZWxmLnN0YXR1c01lc3NhZ2UgPSByZXNwb25zZS5zdGF0dXNUZXh0CgkJCQoJCQlyZXNwb25zZS5oZWFkZXJzLmZvckVhY2goZnVuY3Rpb24oaGVhZGVyLCBrZXkpewoJCQkJc2VsZi5oZWFkZXJzW2tleS50b0xvd2VyQ2FzZSgpXSA9IGhlYWRlcgoJCQkJc2VsZi5yYXdIZWFkZXJzLnB1c2goa2V5LCBoZWFkZXIpCgkJCX0pCgoKCQkJLy8gVE9ETzogdGhpcyBkb2Vzbid0IHJlc3BlY3QgYmFja3ByZXNzdXJlLiBPbmNlIFdyaXRhYmxlU3RyZWFtIGlzIGF2YWlsYWJsZSwgdGhpcyBjYW4gYmUgZml4ZWQKCQkJdmFyIHJlYWRlciA9IHJlc3BvbnNlLmJvZHkuZ2V0UmVhZGVyKCkKCQkJZnVuY3Rpb24gcmVhZCAoKSB7CgkJCQlyZWFkZXIucmVhZCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewoJCQkJCWlmIChzZWxmLl9kZXN0cm95ZWQpCgkJCQkJCXJldHVybgoJCQkJCWlmIChyZXN1bHQuZG9uZSkgewoJCQkJCQlzZWxmLnB1c2gobnVsbCkKCQkJCQkJcmV0dXJuCgkJCQkJfQoJCQkJCXNlbGYucHVzaChuZXcgQnVmZmVyKHJlc3VsdC52YWx1ZSkpCgkJCQkJcmVhZCgpCgkJCQl9KS5jYXRjaChmdW5jdGlvbihlcnIpIHsKCQkJCQlzZWxmLmVtaXQoJ2Vycm9yJywgZXJyKQoJCQkJfSkKCQkJfQoJCQlyZWFkKCkKCgkJfSBlbHNlIHsKCQkJc2VsZi5feGhyID0geGhyCgkJCXNlbGYuX3BvcyA9IDAKCgkJCXNlbGYudXJsID0geGhyLnJlc3BvbnNlVVJMCgkJCXNlbGYuc3RhdHVzQ29kZSA9IHhoci5zdGF0dXMKCQkJc2VsZi5zdGF0dXNNZXNzYWdlID0geGhyLnN0YXR1c1RleHQKCQkJdmFyIGhlYWRlcnMgPSB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkuc3BsaXQoL1xyP1xuLykKCQkJaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHsKCQkJCXZhciBtYXRjaGVzID0gaGVhZGVyLm1hdGNoKC9eKFteOl0rKTpccyooLiopLykKCQkJCWlmIChtYXRjaGVzKSB7CgkJCQkJdmFyIGtleSA9IG1hdGNoZXNbMV0udG9Mb3dlckNhc2UoKQoJCQkJCWlmIChrZXkgPT09ICdzZXQtY29va2llJykgewoJCQkJCQlpZiAoc2VsZi5oZWFkZXJzW2tleV0gPT09IHVuZGVmaW5lZCkgewoJCQkJCQkJc2VsZi5oZWFkZXJzW2tleV0gPSBbXQoJCQkJCQl9CgkJCQkJCXNlbGYuaGVhZGVyc1trZXldLnB1c2gobWF0Y2hlc1syXSkKCQkJCQl9IGVsc2UgaWYgKHNlbGYuaGVhZGVyc1trZXldICE9PSB1bmRlZmluZWQpIHsKCQkJCQkJc2VsZi5oZWFkZXJzW2tleV0gKz0gJywgJyArIG1hdGNoZXNbMl0KCQkJCQl9IGVsc2UgewoJCQkJCQlzZWxmLmhlYWRlcnNba2V5XSA9IG1hdGNoZXNbMl0KCQkJCQl9CgkJCQkJc2VsZi5yYXdIZWFkZXJzLnB1c2gobWF0Y2hlc1sxXSwgbWF0Y2hlc1syXSkKCQkJCX0KCQkJfSkKCgkJCXNlbGYuX2NoYXJzZXQgPSAneC11c2VyLWRlZmluZWQnCgkJCWlmICghY2FwYWJpbGl0eS5vdmVycmlkZU1pbWVUeXBlKSB7CgkJCQl2YXIgbWltZVR5cGUgPSBzZWxmLnJhd0hlYWRlcnNbJ21pbWUtdHlwZSddCgkJCQlpZiAobWltZVR5cGUpIHsKCQkJCQl2YXIgY2hhcnNldE1hdGNoID0gbWltZVR5cGUubWF0Y2goLztccypjaGFyc2V0PShbXjtdKSg7fCQpLykKCQkJCQlpZiAoY2hhcnNldE1hdGNoKSB7CgkJCQkJCXNlbGYuX2NoYXJzZXQgPSBjaGFyc2V0TWF0Y2hbMV0udG9Mb3dlckNhc2UoKQoJCQkJCX0KCQkJCX0KCQkJCWlmICghc2VsZi5fY2hhcnNldCkKCQkJCQlzZWxmLl9jaGFyc2V0ID0gJ3V0Zi04JyAvLyBiZXN0IGd1ZXNzCgkJCX0KCQl9Cgl9CgoJaW5oZXJpdHMoSW5jb21pbmdNZXNzYWdlLCBzdHJlYW0uUmVhZGFibGUpCgoJSW5jb21pbmdNZXNzYWdlLnByb3RvdHlwZS5fcmVhZCA9IGZ1bmN0aW9uICgpIHt9CgoJSW5jb21pbmdNZXNzYWdlLnByb3RvdHlwZS5fb25YSFJQcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCgkJdmFyIHhociA9IHNlbGYuX3hocgoKCQl2YXIgcmVzcG9uc2UgPSBudWxsCgkJc3dpdGNoIChzZWxmLl9tb2RlKSB7CgkJCWNhc2UgJ3RleHQ6dmJhcnJheSc6IC8vIEZvciBJRTkKCQkJCWlmICh4aHIucmVhZHlTdGF0ZSAhPT0gclN0YXRlcy5ET05FKQoJCQkJCWJyZWFrCgkJCQl0cnkgewoJCQkJCS8vIFRoaXMgZmFpbHMgaW4gSUU4CgkJCQkJcmVzcG9uc2UgPSBuZXcgZ2xvYmFsLlZCQXJyYXkoeGhyLnJlc3BvbnNlQm9keSkudG9BcnJheSgpCgkJCQl9IGNhdGNoIChlKSB7fQoJCQkJaWYgKHJlc3BvbnNlICE9PSBudWxsKSB7CgkJCQkJc2VsZi5wdXNoKG5ldyBCdWZmZXIocmVzcG9uc2UpKQoJCQkJCWJyZWFrCgkJCQl9CgkJCQkvLyBGYWxscyB0aHJvdWdoIGluIElFOAkKCQkJY2FzZSAndGV4dCc6CgkJCQl0cnkgeyAvLyBUaGlzIHdpbGwgZmFpbCB3aGVuIHJlYWR5U3RhdGUgPSAzIGluIElFOS4gU3dpdGNoIG1vZGUgYW5kIHdhaXQgZm9yIHJlYWR5U3RhdGUgPSA0CgkJCQkJcmVzcG9uc2UgPSB4aHIucmVzcG9uc2VUZXh0CgkJCQl9IGNhdGNoIChlKSB7CgkJCQkJc2VsZi5fbW9kZSA9ICd0ZXh0OnZiYXJyYXknCgkJCQkJYnJlYWsKCQkJCX0KCQkJCWlmIChyZXNwb25zZS5sZW5ndGggPiBzZWxmLl9wb3MpIHsKCQkJCQl2YXIgbmV3RGF0YSA9IHJlc3BvbnNlLnN1YnN0cihzZWxmLl9wb3MpCgkJCQkJaWYgKHNlbGYuX2NoYXJzZXQgPT09ICd4LXVzZXItZGVmaW5lZCcpIHsKCQkJCQkJdmFyIGJ1ZmZlciA9IG5ldyBCdWZmZXIobmV3RGF0YS5sZW5ndGgpCgkJCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgbmV3RGF0YS5sZW5ndGg7IGkrKykKCQkJCQkJCWJ1ZmZlcltpXSA9IG5ld0RhdGEuY2hhckNvZGVBdChpKSAmIDB4ZmYKCgkJCQkJCXNlbGYucHVzaChidWZmZXIpCgkJCQkJfSBlbHNlIHsKCQkJCQkJc2VsZi5wdXNoKG5ld0RhdGEsIHNlbGYuX2NoYXJzZXQpCgkJCQkJfQoJCQkJCXNlbGYuX3BvcyA9IHJlc3BvbnNlLmxlbmd0aAoJCQkJfQoJCQkJYnJlYWsKCQkJY2FzZSAnYXJyYXlidWZmZXInOgoJCQkJaWYgKHhoci5yZWFkeVN0YXRlICE9PSByU3RhdGVzLkRPTkUgfHwgIXhoci5yZXNwb25zZSkKCQkJCQlicmVhawoJCQkJcmVzcG9uc2UgPSB4aHIucmVzcG9uc2UKCQkJCXNlbGYucHVzaChuZXcgQnVmZmVyKG5ldyBVaW50OEFycmF5KHJlc3BvbnNlKSkpCgkJCQlicmVhawoJCQljYXNlICdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcic6IC8vIHRha2Ugd2hvbGUKCQkJCXJlc3BvbnNlID0geGhyLnJlc3BvbnNlCgkJCQlpZiAoeGhyLnJlYWR5U3RhdGUgIT09IHJTdGF0ZXMuTE9BRElORyB8fCAhcmVzcG9uc2UpCgkJCQkJYnJlYWsKCQkJCXNlbGYucHVzaChuZXcgQnVmZmVyKG5ldyBVaW50OEFycmF5KHJlc3BvbnNlKSkpCgkJCQlicmVhawoJCQljYXNlICdtcy1zdHJlYW0nOgoJCQkJcmVzcG9uc2UgPSB4aHIucmVzcG9uc2UKCQkJCWlmICh4aHIucmVhZHlTdGF0ZSAhPT0gclN0YXRlcy5MT0FESU5HKQoJCQkJCWJyZWFrCgkJCQl2YXIgcmVhZGVyID0gbmV3IGdsb2JhbC5NU1N0cmVhbVJlYWRlcigpCgkJCQlyZWFkZXIub25wcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHsKCQkJCQlpZiAocmVhZGVyLnJlc3VsdC5ieXRlTGVuZ3RoID4gc2VsZi5fcG9zKSB7CgkJCQkJCXNlbGYucHVzaChuZXcgQnVmZmVyKG5ldyBVaW50OEFycmF5KHJlYWRlci5yZXN1bHQuc2xpY2Uoc2VsZi5fcG9zKSkpKQoJCQkJCQlzZWxmLl9wb3MgPSByZWFkZXIucmVzdWx0LmJ5dGVMZW5ndGgKCQkJCQl9CgkJCQl9CgkJCQlyZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkgewoJCQkJCXNlbGYucHVzaChudWxsKQoJCQkJfQoJCQkJLy8gcmVhZGVyLm9uZXJyb3IgPSA/Pz8gLy8gVE9ETzogdGhpcwoJCQkJcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKHJlc3BvbnNlKQoJCQkJYnJlYWsKCQl9CgoJCS8vIFRoZSBtcy1zdHJlYW0gY2FzZSBoYW5kbGVzIGVuZCBzZXBhcmF0ZWx5IGluIHJlYWRlci5vbmxvYWQoKQoJCWlmIChzZWxmLl94aHIucmVhZHlTdGF0ZSA9PT0gclN0YXRlcy5ET05FICYmIHNlbGYuX21vZGUgIT09ICdtcy1zdHJlYW0nKSB7CgkJCXNlbGYucHVzaChudWxsKQoJCX0KCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygxMiksIF9fd2VicGFja19yZXF1aXJlX18oOCkuQnVmZmVyLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSkKCi8qKiovIH0sCi8qIDE2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihwcm9jZXNzKSB7dmFyIFN0cmVhbSA9IChmdW5jdGlvbiAoKXsKCSAgdHJ5IHsKCSAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7IC8vIGhhY2sgdG8gZml4IGEgY2lyY3VsYXIgZGVwZW5kZW5jeSBpc3N1ZSB3aGVuIHVzZWQgd2l0aCBicm93c2VyaWZ5CgkgIH0gY2F0Y2goXyl7fQoJfSgpKTsKCWV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpOwoJZXhwb3J0cy5TdHJlYW0gPSBTdHJlYW0gfHwgZXhwb3J0czsKCWV4cG9ydHMuUmVhZGFibGUgPSBleHBvcnRzOwoJZXhwb3J0cy5Xcml0YWJsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwoJZXhwb3J0cy5EdXBsZXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KTsKCWV4cG9ydHMuVHJhbnNmb3JtID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSk7CglleHBvcnRzLlBhc3NUaHJvdWdoID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNyk7CgoJaWYgKCFwcm9jZXNzLmJyb3dzZXIgJiYgcHJvY2Vzcy5lbnYuUkVBREFCTEVfU1RSRUFNID09PSAnZGlzYWJsZScgJiYgU3RyZWFtKSB7CgkgIG1vZHVsZS5leHBvcnRzID0gU3RyZWFtOwoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKSkpCgovKioqLyB9LAovKiAxNyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCW1vZHVsZS5leHBvcnRzID0gU3RyZWFtOwoKCXZhciBFRSA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpLkV2ZW50RW1pdHRlcjsKCXZhciBpbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpOwoKCWluaGVyaXRzKFN0cmVhbSwgRUUpOwoJU3RyZWFtLlJlYWRhYmxlID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNik7CglTdHJlYW0uV3JpdGFibGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KTsKCVN0cmVhbS5EdXBsZXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTsKCVN0cmVhbS5UcmFuc2Zvcm0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCVN0cmVhbS5QYXNzVGhyb3VnaCA9IF9fd2VicGFja19yZXF1aXJlX18oMzYpOwoKCS8vIEJhY2t3YXJkcy1jb21wYXQgd2l0aCBub2RlIDAuNC54CglTdHJlYW0uU3RyZWFtID0gU3RyZWFtOwoKCgoJLy8gb2xkLXN0eWxlIHN0cmVhbXMuICBOb3RlIHRoYXQgdGhlIHBpcGUgbWV0aG9kICh0aGUgb25seSByZWxldmFudAoJLy8gcGFydCBvZiB0aGlzIGNsYXNzKSBpcyBvdmVycmlkZGVuIGluIHRoZSBSZWFkYWJsZSBjbGFzcy4KCglmdW5jdGlvbiBTdHJlYW0oKSB7CgkgIEVFLmNhbGwodGhpcyk7Cgl9CgoJU3RyZWFtLnByb3RvdHlwZS5waXBlID0gZnVuY3Rpb24oZGVzdCwgb3B0aW9ucykgewoJICB2YXIgc291cmNlID0gdGhpczsKCgkgIGZ1bmN0aW9uIG9uZGF0YShjaHVuaykgewoJICAgIGlmIChkZXN0LndyaXRhYmxlKSB7CgkgICAgICBpZiAoZmFsc2UgPT09IGRlc3Qud3JpdGUoY2h1bmspICYmIHNvdXJjZS5wYXVzZSkgewoJICAgICAgICBzb3VyY2UucGF1c2UoKTsKCSAgICAgIH0KCSAgICB9CgkgIH0KCgkgIHNvdXJjZS5vbignZGF0YScsIG9uZGF0YSk7CgoJICBmdW5jdGlvbiBvbmRyYWluKCkgewoJICAgIGlmIChzb3VyY2UucmVhZGFibGUgJiYgc291cmNlLnJlc3VtZSkgewoJICAgICAgc291cmNlLnJlc3VtZSgpOwoJICAgIH0KCSAgfQoKCSAgZGVzdC5vbignZHJhaW4nLCBvbmRyYWluKTsKCgkgIC8vIElmIHRoZSAnZW5kJyBvcHRpb24gaXMgbm90IHN1cHBsaWVkLCBkZXN0LmVuZCgpIHdpbGwgYmUgY2FsbGVkIHdoZW4KCSAgLy8gc291cmNlIGdldHMgdGhlICdlbmQnIG9yICdjbG9zZScgZXZlbnRzLiAgT25seSBkZXN0LmVuZCgpIG9uY2UuCgkgIGlmICghZGVzdC5faXNTdGRpbyAmJiAoIW9wdGlvbnMgfHwgb3B0aW9ucy5lbmQgIT09IGZhbHNlKSkgewoJICAgIHNvdXJjZS5vbignZW5kJywgb25lbmQpOwoJICAgIHNvdXJjZS5vbignY2xvc2UnLCBvbmNsb3NlKTsKCSAgfQoKCSAgdmFyIGRpZE9uRW5kID0gZmFsc2U7CgkgIGZ1bmN0aW9uIG9uZW5kKCkgewoJICAgIGlmIChkaWRPbkVuZCkgcmV0dXJuOwoJICAgIGRpZE9uRW5kID0gdHJ1ZTsKCgkgICAgZGVzdC5lbmQoKTsKCSAgfQoKCgkgIGZ1bmN0aW9uIG9uY2xvc2UoKSB7CgkgICAgaWYgKGRpZE9uRW5kKSByZXR1cm47CgkgICAgZGlkT25FbmQgPSB0cnVlOwoKCSAgICBpZiAodHlwZW9mIGRlc3QuZGVzdHJveSA9PT0gJ2Z1bmN0aW9uJykgZGVzdC5kZXN0cm95KCk7CgkgIH0KCgkgIC8vIGRvbid0IGxlYXZlIGRhbmdsaW5nIHBpcGVzIHdoZW4gdGhlcmUgYXJlIGVycm9ycy4KCSAgZnVuY3Rpb24gb25lcnJvcihlcikgewoJICAgIGNsZWFudXAoKTsKCSAgICBpZiAoRUUubGlzdGVuZXJDb3VudCh0aGlzLCAnZXJyb3InKSA9PT0gMCkgewoJICAgICAgdGhyb3cgZXI7IC8vIFVuaGFuZGxlZCBzdHJlYW0gZXJyb3IgaW4gcGlwZS4KCSAgICB9CgkgIH0KCgkgIHNvdXJjZS5vbignZXJyb3InLCBvbmVycm9yKTsKCSAgZGVzdC5vbignZXJyb3InLCBvbmVycm9yKTsKCgkgIC8vIHJlbW92ZSBhbGwgdGhlIGV2ZW50IGxpc3RlbmVycyB0aGF0IHdlcmUgYWRkZWQuCgkgIGZ1bmN0aW9uIGNsZWFudXAoKSB7CgkgICAgc291cmNlLnJlbW92ZUxpc3RlbmVyKCdkYXRhJywgb25kYXRhKTsKCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdkcmFpbicsIG9uZHJhaW4pOwoKCSAgICBzb3VyY2UucmVtb3ZlTGlzdGVuZXIoJ2VuZCcsIG9uZW5kKTsKCSAgICBzb3VyY2UucmVtb3ZlTGlzdGVuZXIoJ2Nsb3NlJywgb25jbG9zZSk7CgoJICAgIHNvdXJjZS5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBvbmVycm9yKTsKCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdlcnJvcicsIG9uZXJyb3IpOwoKCSAgICBzb3VyY2UucmVtb3ZlTGlzdGVuZXIoJ2VuZCcsIGNsZWFudXApOwoJICAgIHNvdXJjZS5yZW1vdmVMaXN0ZW5lcignY2xvc2UnLCBjbGVhbnVwKTsKCgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignY2xvc2UnLCBjbGVhbnVwKTsKCSAgfQoKCSAgc291cmNlLm9uKCdlbmQnLCBjbGVhbnVwKTsKCSAgc291cmNlLm9uKCdjbG9zZScsIGNsZWFudXApOwoKCSAgZGVzdC5vbignY2xvc2UnLCBjbGVhbnVwKTsKCgkgIGRlc3QuZW1pdCgncGlwZScsIHNvdXJjZSk7CgoJICAvLyBBbGxvdyBmb3IgdW5peC1saWtlIHVzYWdlOiBBLnBpcGUoQikucGlwZShDKQoJICByZXR1cm4gZGVzdDsKCX07CgoKLyoqKi8gfSwKLyogMTggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuCgkvLwoJLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKCS8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKCS8vICJTb2Z0d2FyZSIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcKCS8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwKCS8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQKCS8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZQoJLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6CgkvLwoJLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQKCS8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgoJLy8KCS8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTCgkvLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GCgkvLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOCgkvLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwKCS8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUgoJLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRQoJLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KCglmdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7CgkgIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fTsKCSAgdGhpcy5fbWF4TGlzdGVuZXJzID0gdGhpcy5fbWF4TGlzdGVuZXJzIHx8IHVuZGVmaW5lZDsKCX0KCW1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyOwoKCS8vIEJhY2t3YXJkcy1jb21wYXQgd2l0aCBub2RlIDAuMTAueAoJRXZlbnRFbWl0dGVyLkV2ZW50RW1pdHRlciA9IEV2ZW50RW1pdHRlcjsKCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLl9ldmVudHMgPSB1bmRlZmluZWQ7CglFdmVudEVtaXR0ZXIucHJvdG90eXBlLl9tYXhMaXN0ZW5lcnMgPSB1bmRlZmluZWQ7CgoJLy8gQnkgZGVmYXVsdCBFdmVudEVtaXR0ZXJzIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIG1vcmUgdGhhbiAxMCBsaXN0ZW5lcnMgYXJlCgkvLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLgoJRXZlbnRFbWl0dGVyLmRlZmF1bHRNYXhMaXN0ZW5lcnMgPSAxMDsKCgkvLyBPYnZpb3VzbHkgbm90IGFsbCBFbWl0dGVycyBzaG91bGQgYmUgbGltaXRlZCB0byAxMC4gVGhpcyBmdW5jdGlvbiBhbGxvd3MKCS8vIHRoYXQgdG8gYmUgaW5jcmVhc2VkLiBTZXQgdG8gemVybyBmb3IgdW5saW1pdGVkLgoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5zZXRNYXhMaXN0ZW5lcnMgPSBmdW5jdGlvbihuKSB7CgkgIGlmICghaXNOdW1iZXIobikgfHwgbiA8IDAgfHwgaXNOYU4obikpCgkgICAgdGhyb3cgVHlwZUVycm9yKCduIG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXInKTsKCSAgdGhpcy5fbWF4TGlzdGVuZXJzID0gbjsKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uKHR5cGUpIHsKCSAgdmFyIGVyLCBoYW5kbGVyLCBsZW4sIGFyZ3MsIGksIGxpc3RlbmVyczsKCgkgIGlmICghdGhpcy5fZXZlbnRzKQoJICAgIHRoaXMuX2V2ZW50cyA9IHt9OwoKCSAgLy8gSWYgdGhlcmUgaXMgbm8gJ2Vycm9yJyBldmVudCBsaXN0ZW5lciB0aGVuIHRocm93LgoJICBpZiAodHlwZSA9PT0gJ2Vycm9yJykgewoJICAgIGlmICghdGhpcy5fZXZlbnRzLmVycm9yIHx8CgkgICAgICAgIChpc09iamVjdCh0aGlzLl9ldmVudHMuZXJyb3IpICYmICF0aGlzLl9ldmVudHMuZXJyb3IubGVuZ3RoKSkgewoJICAgICAgZXIgPSBhcmd1bWVudHNbMV07CgkgICAgICBpZiAoZXIgaW5zdGFuY2VvZiBFcnJvcikgewoJICAgICAgICB0aHJvdyBlcjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnQKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIC8vIEF0IGxlYXN0IGdpdmUgc29tZSBraW5kIG9mIGNvbnRleHQgdG8gdGhlIHVzZXIKCSAgICAgICAgdmFyIGVyciA9IG5ldyBFcnJvcignVW5jYXVnaHQsIHVuc3BlY2lmaWVkICJlcnJvciIgZXZlbnQuICgnICsgZXIgKyAnKScpOwoJICAgICAgICBlcnIuY29udGV4dCA9IGVyOwoJICAgICAgICB0aHJvdyBlcnI7CgkgICAgICB9CgkgICAgfQoJICB9CgoJICBoYW5kbGVyID0gdGhpcy5fZXZlbnRzW3R5cGVdOwoKCSAgaWYgKGlzVW5kZWZpbmVkKGhhbmRsZXIpKQoJICAgIHJldHVybiBmYWxzZTsKCgkgIGlmIChpc0Z1bmN0aW9uKGhhbmRsZXIpKSB7CgkgICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7CgkgICAgICAvLyBmYXN0IGNhc2VzCgkgICAgICBjYXNlIDE6CgkgICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzKTsKCSAgICAgICAgYnJlYWs7CgkgICAgICBjYXNlIDI6CgkgICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0pOwoJICAgICAgICBicmVhazsKCSAgICAgIGNhc2UgMzoKCSAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTsKCSAgICAgICAgYnJlYWs7CgkgICAgICAvLyBzbG93ZXIKCSAgICAgIGRlZmF1bHQ6CgkgICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOwoJICAgICAgICBoYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIH0KCSAgfSBlbHNlIGlmIChpc09iamVjdChoYW5kbGVyKSkgewoJICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOwoJICAgIGxpc3RlbmVycyA9IGhhbmRsZXIuc2xpY2UoKTsKCSAgICBsZW4gPSBsaXN0ZW5lcnMubGVuZ3RoOwoJICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykKCSAgICAgIGxpc3RlbmVyc1tpXS5hcHBseSh0aGlzLCBhcmdzKTsKCSAgfQoKCSAgcmV0dXJuIHRydWU7Cgl9OwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikgewoJICB2YXIgbTsKCgkgIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpCgkgICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTsKCgkgIGlmICghdGhpcy5fZXZlbnRzKQoJICAgIHRoaXMuX2V2ZW50cyA9IHt9OwoKCSAgLy8gVG8gYXZvaWQgcmVjdXJzaW9uIGluIHRoZSBjYXNlIHRoYXQgdHlwZSA9PT0gIm5ld0xpc3RlbmVyIiEgQmVmb3JlCgkgIC8vIGFkZGluZyBpdCB0byB0aGUgbGlzdGVuZXJzLCBmaXJzdCBlbWl0ICJuZXdMaXN0ZW5lciIuCgkgIGlmICh0aGlzLl9ldmVudHMubmV3TGlzdGVuZXIpCgkgICAgdGhpcy5lbWl0KCduZXdMaXN0ZW5lcicsIHR5cGUsCgkgICAgICAgICAgICAgIGlzRnVuY3Rpb24obGlzdGVuZXIubGlzdGVuZXIpID8KCSAgICAgICAgICAgICAgbGlzdGVuZXIubGlzdGVuZXIgOiBsaXN0ZW5lcik7CgoJICBpZiAoIXRoaXMuX2V2ZW50c1t0eXBlXSkKCSAgICAvLyBPcHRpbWl6ZSB0aGUgY2FzZSBvZiBvbmUgbGlzdGVuZXIuIERvbid0IG5lZWQgdGhlIGV4dHJhIGFycmF5IG9iamVjdC4KCSAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjsKCSAgZWxzZSBpZiAoaXNPYmplY3QodGhpcy5fZXZlbnRzW3R5cGVdKSkKCSAgICAvLyBJZiB3ZSd2ZSBhbHJlYWR5IGdvdCBhbiBhcnJheSwganVzdCBhcHBlbmQuCgkgICAgdGhpcy5fZXZlbnRzW3R5cGVdLnB1c2gobGlzdGVuZXIpOwoJICBlbHNlCgkgICAgLy8gQWRkaW5nIHRoZSBzZWNvbmQgZWxlbWVudCwgbmVlZCB0byBjaGFuZ2UgdG8gYXJyYXkuCgkgICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gW3RoaXMuX2V2ZW50c1t0eXBlXSwgbGlzdGVuZXJdOwoKCSAgLy8gQ2hlY2sgZm9yIGxpc3RlbmVyIGxlYWsKCSAgaWYgKGlzT2JqZWN0KHRoaXMuX2V2ZW50c1t0eXBlXSkgJiYgIXRoaXMuX2V2ZW50c1t0eXBlXS53YXJuZWQpIHsKCSAgICBpZiAoIWlzVW5kZWZpbmVkKHRoaXMuX21heExpc3RlbmVycykpIHsKCSAgICAgIG0gPSB0aGlzLl9tYXhMaXN0ZW5lcnM7CgkgICAgfSBlbHNlIHsKCSAgICAgIG0gPSBFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVyczsKCSAgICB9CgoJICAgIGlmIChtICYmIG0gPiAwICYmIHRoaXMuX2V2ZW50c1t0eXBlXS5sZW5ndGggPiBtKSB7CgkgICAgICB0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkID0gdHJ1ZTsKCSAgICAgIGNvbnNvbGUuZXJyb3IoJyhub2RlKSB3YXJuaW5nOiBwb3NzaWJsZSBFdmVudEVtaXR0ZXIgbWVtb3J5ICcgKwoJICAgICAgICAgICAgICAgICAgICAnbGVhayBkZXRlY3RlZC4gJWQgbGlzdGVuZXJzIGFkZGVkLiAnICsKCSAgICAgICAgICAgICAgICAgICAgJ1VzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvIGluY3JlYXNlIGxpbWl0LicsCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuX2V2ZW50c1t0eXBlXS5sZW5ndGgpOwoJICAgICAgaWYgKHR5cGVvZiBjb25zb2xlLnRyYWNlID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICAgIC8vIG5vdCBzdXBwb3J0ZWQgaW4gSUUgMTAKCSAgICAgICAgY29uc29sZS50cmFjZSgpOwoJICAgICAgfQoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUub24gPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyOwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7CgkgIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpCgkgICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTsKCgkgIHZhciBmaXJlZCA9IGZhbHNlOwoKCSAgZnVuY3Rpb24gZygpIHsKCSAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGcpOwoKCSAgICBpZiAoIWZpcmVkKSB7CgkgICAgICBmaXJlZCA9IHRydWU7CgkgICAgICBsaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICAgIH0KCSAgfQoKCSAgZy5saXN0ZW5lciA9IGxpc3RlbmVyOwoJICB0aGlzLm9uKHR5cGUsIGcpOwoKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCS8vIGVtaXRzIGEgJ3JlbW92ZUxpc3RlbmVyJyBldmVudCBpZmYgdGhlIGxpc3RlbmVyIHdhcyByZW1vdmVkCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHsKCSAgdmFyIGxpc3QsIHBvc2l0aW9uLCBsZW5ndGgsIGk7CgoJICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKQoJICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7CgoJICBpZiAoIXRoaXMuX2V2ZW50cyB8fCAhdGhpcy5fZXZlbnRzW3R5cGVdKQoJICAgIHJldHVybiB0aGlzOwoKCSAgbGlzdCA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCSAgbGVuZ3RoID0gbGlzdC5sZW5ndGg7CgkgIHBvc2l0aW9uID0gLTE7CgoJICBpZiAobGlzdCA9PT0gbGlzdGVuZXIgfHwKCSAgICAgIChpc0Z1bmN0aW9uKGxpc3QubGlzdGVuZXIpICYmIGxpc3QubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkgewoJICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07CgkgICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikKCSAgICAgIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lcik7CgoJICB9IGVsc2UgaWYgKGlzT2JqZWN0KGxpc3QpKSB7CgkgICAgZm9yIChpID0gbGVuZ3RoOyBpLS0gPiAwOykgewoJICAgICAgaWYgKGxpc3RbaV0gPT09IGxpc3RlbmVyIHx8CgkgICAgICAgICAgKGxpc3RbaV0ubGlzdGVuZXIgJiYgbGlzdFtpXS5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7CgkgICAgICAgIHBvc2l0aW9uID0gaTsKCSAgICAgICAgYnJlYWs7CgkgICAgICB9CgkgICAgfQoKCSAgICBpZiAocG9zaXRpb24gPCAwKQoJICAgICAgcmV0dXJuIHRoaXM7CgoJICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMSkgewoJICAgICAgbGlzdC5sZW5ndGggPSAwOwoJICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTsKCSAgICB9IGVsc2UgewoJICAgICAgbGlzdC5zcGxpY2UocG9zaXRpb24sIDEpOwoJICAgIH0KCgkgICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikKCSAgICAgIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lcik7CgkgIH0KCgkgIHJldHVybiB0aGlzOwoJfTsKCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycyA9IGZ1bmN0aW9uKHR5cGUpIHsKCSAgdmFyIGtleSwgbGlzdGVuZXJzOwoKCSAgaWYgKCF0aGlzLl9ldmVudHMpCgkgICAgcmV0dXJuIHRoaXM7CgoJICAvLyBub3QgbGlzdGVuaW5nIGZvciByZW1vdmVMaXN0ZW5lciwgbm8gbmVlZCB0byBlbWl0CgkgIGlmICghdGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKSB7CgkgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApCgkgICAgICB0aGlzLl9ldmVudHMgPSB7fTsKCSAgICBlbHNlIGlmICh0aGlzLl9ldmVudHNbdHlwZV0pCgkgICAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdOwoJICAgIHJldHVybiB0aGlzOwoJICB9CgoJICAvLyBlbWl0IHJlbW92ZUxpc3RlbmVyIGZvciBhbGwgbGlzdGVuZXJzIG9uIGFsbCBldmVudHMKCSAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsKCSAgICBmb3IgKGtleSBpbiB0aGlzLl9ldmVudHMpIHsKCSAgICAgIGlmIChrZXkgPT09ICdyZW1vdmVMaXN0ZW5lcicpIGNvbnRpbnVlOwoJICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoa2V5KTsKCSAgICB9CgkgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ3JlbW92ZUxpc3RlbmVyJyk7CgkgICAgdGhpcy5fZXZlbnRzID0ge307CgkgICAgcmV0dXJuIHRoaXM7CgkgIH0KCgkgIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCgkgIGlmIChpc0Z1bmN0aW9uKGxpc3RlbmVycykpIHsKCSAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVycyk7CgkgIH0gZWxzZSBpZiAobGlzdGVuZXJzKSB7CgkgICAgLy8gTElGTyBvcmRlcgoJICAgIHdoaWxlIChsaXN0ZW5lcnMubGVuZ3RoKQoJICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnNbbGlzdGVuZXJzLmxlbmd0aCAtIDFdKTsKCSAgfQoJICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdOwoKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24odHlwZSkgewoJICB2YXIgcmV0OwoJICBpZiAoIXRoaXMuX2V2ZW50cyB8fCAhdGhpcy5fZXZlbnRzW3R5cGVdKQoJICAgIHJldCA9IFtdOwoJICBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoaXMuX2V2ZW50c1t0eXBlXSkpCgkgICAgcmV0ID0gW3RoaXMuX2V2ZW50c1t0eXBlXV07CgkgIGVsc2UKCSAgICByZXQgPSB0aGlzLl9ldmVudHNbdHlwZV0uc2xpY2UoKTsKCSAgcmV0dXJuIHJldDsKCX07CgoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24odHlwZSkgewoJICBpZiAodGhpcy5fZXZlbnRzKSB7CgkgICAgdmFyIGV2bGlzdGVuZXIgPSB0aGlzLl9ldmVudHNbdHlwZV07CgoJICAgIGlmIChpc0Z1bmN0aW9uKGV2bGlzdGVuZXIpKQoJICAgICAgcmV0dXJuIDE7CgkgICAgZWxzZSBpZiAoZXZsaXN0ZW5lcikKCSAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDsKCSAgfQoJICByZXR1cm4gMDsKCX07CgoJRXZlbnRFbWl0dGVyLmxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbihlbWl0dGVyLCB0eXBlKSB7CgkgIHJldHVybiBlbWl0dGVyLmxpc3RlbmVyQ291bnQodHlwZSk7Cgl9OwoKCWZ1bmN0aW9uIGlzRnVuY3Rpb24oYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnZnVuY3Rpb24nOwoJfQoKCWZ1bmN0aW9uIGlzTnVtYmVyKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ251bWJlcic7Cgl9CgoJZnVuY3Rpb24gaXNPYmplY3QoYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiBhcmcgIT09IG51bGw7Cgl9CgoJZnVuY3Rpb24gaXNVbmRlZmluZWQoYXJnKSB7CgkgIHJldHVybiBhcmcgPT09IHZvaWQgMDsKCX0KCgovKioqLyB9LAovKiAxOSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjApCgoKLyoqKi8gfSwKLyogMjAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKHByb2Nlc3MsIHNldEltbWVkaWF0ZSkgey8vIEEgYml0IHNpbXBsZXIgdGhhbiByZWFkYWJsZSBzdHJlYW1zLgoJLy8gSW1wbGVtZW50IGFuIGFzeW5jIC5fd3JpdGUoY2h1bmssIGVuY29kaW5nLCBjYiksIGFuZCBpdCdsbCBoYW5kbGUgYWxsCgkvLyB0aGUgZHJhaW4gZXZlbnQgZW1pc3Npb24gYW5kIGJ1ZmZlcmluZy4KCgkndXNlIHN0cmljdCc7CgoJbW9kdWxlLmV4cG9ydHMgPSBXcml0YWJsZTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHByb2Nlc3NOZXh0VGljayA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBhc3luY1dyaXRlID0gIXByb2Nlc3MuYnJvd3NlciAmJiBbJ3YwLjEwJywgJ3YwLjkuJ10uaW5kZXhPZihwcm9jZXNzLnZlcnNpb24uc2xpY2UoMCwgNSkpID4gLTEgPyBzZXRJbW1lZGlhdGUgOiBwcm9jZXNzTmV4dFRpY2s7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIER1cGxleDsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCVdyaXRhYmxlLldyaXRhYmxlU3RhdGUgPSBXcml0YWJsZVN0YXRlOwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgdXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwoJdXRpbC5pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBpbnRlcm5hbFV0aWwgPSB7CgkgIGRlcHJlY2F0ZTogX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKCX07CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIFN0cmVhbTsKCShmdW5jdGlvbiAoKSB7CgkgIHRyeSB7CgkgICAgU3RyZWFtID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7CgkgIH0gY2F0Y2ggKF8pIHt9IGZpbmFsbHkgewoJICAgIGlmICghU3RyZWFtKSBTdHJlYW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KS5FdmVudEVtaXR0ZXI7CgkgIH0KCX0pKCk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl2YXIgQnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNikuQnVmZmVyOwoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBidWZmZXJTaGltID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNyk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl1dGlsLmluaGVyaXRzKFdyaXRhYmxlLCBTdHJlYW0pOwoKCWZ1bmN0aW9uIG5vcCgpIHt9CgoJZnVuY3Rpb24gV3JpdGVSZXEoY2h1bmssIGVuY29kaW5nLCBjYikgewoJICB0aGlzLmNodW5rID0gY2h1bms7CgkgIHRoaXMuZW5jb2RpbmcgPSBlbmNvZGluZzsKCSAgdGhpcy5jYWxsYmFjayA9IGNiOwoJICB0aGlzLm5leHQgPSBudWxsOwoJfQoKCWZ1bmN0aW9uIFdyaXRhYmxlU3RhdGUob3B0aW9ucywgc3RyZWFtKSB7CgkgIER1cGxleCA9IER1cGxleCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KTsKCgkgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKCSAgLy8gb2JqZWN0IHN0cmVhbSBmbGFnIHRvIGluZGljYXRlIHdoZXRoZXIgb3Igbm90IHRoaXMgc3RyZWFtCgkgIC8vIGNvbnRhaW5zIGJ1ZmZlcnMgb3Igb2JqZWN0cy4KCSAgdGhpcy5vYmplY3RNb2RlID0gISFvcHRpb25zLm9iamVjdE1vZGU7CgoJICBpZiAoc3RyZWFtIGluc3RhbmNlb2YgRHVwbGV4KSB0aGlzLm9iamVjdE1vZGUgPSB0aGlzLm9iamVjdE1vZGUgfHwgISFvcHRpb25zLndyaXRhYmxlT2JqZWN0TW9kZTsKCgkgIC8vIHRoZSBwb2ludCBhdCB3aGljaCB3cml0ZSgpIHN0YXJ0cyByZXR1cm5pbmcgZmFsc2UKCSAgLy8gTm90ZTogMCBpcyBhIHZhbGlkIHZhbHVlLCBtZWFucyB0aGF0IHdlIGFsd2F5cyByZXR1cm4gZmFsc2UgaWYKCSAgLy8gdGhlIGVudGlyZSBidWZmZXIgaXMgbm90IGZsdXNoZWQgaW1tZWRpYXRlbHkgb24gd3JpdGUoKQoJICB2YXIgaHdtID0gb3B0aW9ucy5oaWdoV2F0ZXJNYXJrOwoJICB2YXIgZGVmYXVsdEh3bSA9IHRoaXMub2JqZWN0TW9kZSA/IDE2IDogMTYgKiAxMDI0OwoJICB0aGlzLmhpZ2hXYXRlck1hcmsgPSBod20gfHwgaHdtID09PSAwID8gaHdtIDogZGVmYXVsdEh3bTsKCgkgIC8vIGNhc3QgdG8gaW50cy4KCSAgdGhpcy5oaWdoV2F0ZXJNYXJrID0gfiB+dGhpcy5oaWdoV2F0ZXJNYXJrOwoKCSAgLy8gZHJhaW4gZXZlbnQgZmxhZy4KCSAgdGhpcy5uZWVkRHJhaW4gPSBmYWxzZTsKCSAgLy8gYXQgdGhlIHN0YXJ0IG9mIGNhbGxpbmcgZW5kKCkKCSAgdGhpcy5lbmRpbmcgPSBmYWxzZTsKCSAgLy8gd2hlbiBlbmQoKSBoYXMgYmVlbiBjYWxsZWQsIGFuZCByZXR1cm5lZAoJICB0aGlzLmVuZGVkID0gZmFsc2U7CgkgIC8vIHdoZW4gJ2ZpbmlzaCcgaXMgZW1pdHRlZAoJICB0aGlzLmZpbmlzaGVkID0gZmFsc2U7CgoJICAvLyBzaG91bGQgd2UgZGVjb2RlIHN0cmluZ3MgaW50byBidWZmZXJzIGJlZm9yZSBwYXNzaW5nIHRvIF93cml0ZT8KCSAgLy8gdGhpcyBpcyBoZXJlIHNvIHRoYXQgc29tZSBub2RlLWNvcmUgc3RyZWFtcyBjYW4gb3B0aW1pemUgc3RyaW5nCgkgIC8vIGhhbmRsaW5nIGF0IGEgbG93ZXIgbGV2ZWwuCgkgIHZhciBub0RlY29kZSA9IG9wdGlvbnMuZGVjb2RlU3RyaW5ncyA9PT0gZmFsc2U7CgkgIHRoaXMuZGVjb2RlU3RyaW5ncyA9ICFub0RlY29kZTsKCgkgIC8vIENyeXB0byBpcyBraW5kIG9mIG9sZCBhbmQgY3J1c3R5LiAgSGlzdG9yaWNhbGx5LCBpdHMgZGVmYXVsdCBzdHJpbmcKCSAgLy8gZW5jb2RpbmcgaXMgJ2JpbmFyeScgc28gd2UgaGF2ZSB0byBtYWtlIHRoaXMgY29uZmlndXJhYmxlLgoJICAvLyBFdmVyeXRoaW5nIGVsc2UgaW4gdGhlIHVuaXZlcnNlIHVzZXMgJ3V0ZjgnLCB0aG91Z2guCgkgIHRoaXMuZGVmYXVsdEVuY29kaW5nID0gb3B0aW9ucy5kZWZhdWx0RW5jb2RpbmcgfHwgJ3V0ZjgnOwoKCSAgLy8gbm90IGFuIGFjdHVhbCBidWZmZXIgd2Uga2VlcCB0cmFjayBvZiwgYnV0IGEgbWVhc3VyZW1lbnQKCSAgLy8gb2YgaG93IG11Y2ggd2UncmUgd2FpdGluZyB0byBnZXQgcHVzaGVkIHRvIHNvbWUgdW5kZXJseWluZwoJICAvLyBzb2NrZXQgb3IgZmlsZS4KCSAgdGhpcy5sZW5ndGggPSAwOwoKCSAgLy8gYSBmbGFnIHRvIHNlZSB3aGVuIHdlJ3JlIGluIHRoZSBtaWRkbGUgb2YgYSB3cml0ZS4KCSAgdGhpcy53cml0aW5nID0gZmFsc2U7CgoJICAvLyB3aGVuIHRydWUgYWxsIHdyaXRlcyB3aWxsIGJlIGJ1ZmZlcmVkIHVudGlsIC51bmNvcmsoKSBjYWxsCgkgIHRoaXMuY29ya2VkID0gMDsKCgkgIC8vIGEgZmxhZyB0byBiZSBhYmxlIHRvIHRlbGwgaWYgdGhlIG9ud3JpdGUgY2IgaXMgY2FsbGVkIGltbWVkaWF0ZWx5LAoJICAvLyBvciBvbiBhIGxhdGVyIHRpY2suICBXZSBzZXQgdGhpcyB0byB0cnVlIGF0IGZpcnN0LCBiZWNhdXNlIGFueQoJICAvLyBhY3Rpb25zIHRoYXQgc2hvdWxkbid0IGhhcHBlbiB1bnRpbCAibGF0ZXIiIHNob3VsZCBnZW5lcmFsbHkgYWxzbwoJICAvLyBub3QgaGFwcGVuIGJlZm9yZSB0aGUgZmlyc3Qgd3JpdGUgY2FsbC4KCSAgdGhpcy5zeW5jID0gdHJ1ZTsKCgkgIC8vIGEgZmxhZyB0byBrbm93IGlmIHdlJ3JlIHByb2Nlc3NpbmcgcHJldmlvdXNseSBidWZmZXJlZCBpdGVtcywgd2hpY2gKCSAgLy8gbWF5IGNhbGwgdGhlIF93cml0ZSgpIGNhbGxiYWNrIGluIHRoZSBzYW1lIHRpY2ssIHNvIHRoYXQgd2UgZG9uJ3QKCSAgLy8gZW5kIHVwIGluIGFuIG92ZXJsYXBwZWQgb253cml0ZSBzaXR1YXRpb24uCgkgIHRoaXMuYnVmZmVyUHJvY2Vzc2luZyA9IGZhbHNlOwoKCSAgLy8gdGhlIGNhbGxiYWNrIHRoYXQncyBwYXNzZWQgdG8gX3dyaXRlKGNodW5rLGNiKQoJICB0aGlzLm9ud3JpdGUgPSBmdW5jdGlvbiAoZXIpIHsKCSAgICBvbndyaXRlKHN0cmVhbSwgZXIpOwoJICB9OwoKCSAgLy8gdGhlIGNhbGxiYWNrIHRoYXQgdGhlIHVzZXIgc3VwcGxpZXMgdG8gd3JpdGUoY2h1bmssZW5jb2RpbmcsY2IpCgkgIHRoaXMud3JpdGVjYiA9IG51bGw7CgoJICAvLyB0aGUgYW1vdW50IHRoYXQgaXMgYmVpbmcgd3JpdHRlbiB3aGVuIF93cml0ZSBpcyBjYWxsZWQuCgkgIHRoaXMud3JpdGVsZW4gPSAwOwoKCSAgdGhpcy5idWZmZXJlZFJlcXVlc3QgPSBudWxsOwoJICB0aGlzLmxhc3RCdWZmZXJlZFJlcXVlc3QgPSBudWxsOwoKCSAgLy8gbnVtYmVyIG9mIHBlbmRpbmcgdXNlci1zdXBwbGllZCB3cml0ZSBjYWxsYmFja3MKCSAgLy8gdGhpcyBtdXN0IGJlIDAgYmVmb3JlICdmaW5pc2gnIGNhbiBiZSBlbWl0dGVkCgkgIHRoaXMucGVuZGluZ2NiID0gMDsKCgkgIC8vIGVtaXQgcHJlZmluaXNoIGlmIHRoZSBvbmx5IHRoaW5nIHdlJ3JlIHdhaXRpbmcgZm9yIGlzIF93cml0ZSBjYnMKCSAgLy8gVGhpcyBpcyByZWxldmFudCBmb3Igc3luY2hyb25vdXMgVHJhbnNmb3JtIHN0cmVhbXMKCSAgdGhpcy5wcmVmaW5pc2hlZCA9IGZhbHNlOwoKCSAgLy8gVHJ1ZSBpZiB0aGUgZXJyb3Igd2FzIGFscmVhZHkgZW1pdHRlZCBhbmQgc2hvdWxkIG5vdCBiZSB0aHJvd24gYWdhaW4KCSAgdGhpcy5lcnJvckVtaXR0ZWQgPSBmYWxzZTsKCgkgIC8vIGNvdW50IGJ1ZmZlcmVkIHJlcXVlc3RzCgkgIHRoaXMuYnVmZmVyZWRSZXF1ZXN0Q291bnQgPSAwOwoKCSAgLy8gYWxsb2NhdGUgdGhlIGZpcnN0IENvcmtlZFJlcXVlc3QsIHRoZXJlIGlzIGFsd2F5cwoJICAvLyBvbmUgYWxsb2NhdGVkIGFuZCBmcmVlIHRvIHVzZSwgYW5kIHdlIG1haW50YWluIGF0IG1vc3QgdHdvCgkgIHRoaXMuY29ya2VkUmVxdWVzdHNGcmVlID0gbmV3IENvcmtlZFJlcXVlc3QodGhpcyk7Cgl9CgoJV3JpdGFibGVTdGF0ZS5wcm90b3R5cGUuZ2V0QnVmZmVyID0gZnVuY3Rpb24gZ2V0QnVmZmVyKCkgewoJICB2YXIgY3VycmVudCA9IHRoaXMuYnVmZmVyZWRSZXF1ZXN0OwoJICB2YXIgb3V0ID0gW107CgkgIHdoaWxlIChjdXJyZW50KSB7CgkgICAgb3V0LnB1c2goY3VycmVudCk7CgkgICAgY3VycmVudCA9IGN1cnJlbnQubmV4dDsKCSAgfQoJICByZXR1cm4gb3V0OwoJfTsKCgkoZnVuY3Rpb24gKCkgewoJICB0cnkgewoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXcml0YWJsZVN0YXRlLnByb3RvdHlwZSwgJ2J1ZmZlcicsIHsKCSAgICAgIGdldDogaW50ZXJuYWxVdGlsLmRlcHJlY2F0ZShmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdldEJ1ZmZlcigpOwoJICAgICAgfSwgJ193cml0YWJsZVN0YXRlLmJ1ZmZlciBpcyBkZXByZWNhdGVkLiBVc2UgX3dyaXRhYmxlU3RhdGUuZ2V0QnVmZmVyICcgKyAnaW5zdGVhZC4nKQoJICAgIH0pOwoJICB9IGNhdGNoIChfKSB7fQoJfSkoKTsKCgkvLyBUZXN0IF93cml0YWJsZVN0YXRlIGZvciBpbmhlcml0YW5jZSB0byBhY2NvdW50IGZvciBEdXBsZXggc3RyZWFtcywKCS8vIHdob3NlIHByb3RvdHlwZSBjaGFpbiBvbmx5IHBvaW50cyB0byBSZWFkYWJsZS4KCXZhciByZWFsSGFzSW5zdGFuY2U7CglpZiAodHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJiBTeW1ib2wuaGFzSW5zdGFuY2UgJiYgdHlwZW9mIEZ1bmN0aW9uLnByb3RvdHlwZVtTeW1ib2wuaGFzSW5zdGFuY2VdID09PSAnZnVuY3Rpb24nKSB7CgkgIHJlYWxIYXNJbnN0YW5jZSA9IEZ1bmN0aW9uLnByb3RvdHlwZVtTeW1ib2wuaGFzSW5zdGFuY2VdOwoJICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV3JpdGFibGUsIFN5bWJvbC5oYXNJbnN0YW5jZSwgewoJICAgIHZhbHVlOiBmdW5jdGlvbiAob2JqZWN0KSB7CgkgICAgICBpZiAocmVhbEhhc0luc3RhbmNlLmNhbGwodGhpcywgb2JqZWN0KSkgcmV0dXJuIHRydWU7CgoJICAgICAgcmV0dXJuIG9iamVjdCAmJiBvYmplY3QuX3dyaXRhYmxlU3RhdGUgaW5zdGFuY2VvZiBXcml0YWJsZVN0YXRlOwoJICAgIH0KCSAgfSk7Cgl9IGVsc2UgewoJICByZWFsSGFzSW5zdGFuY2UgPSBmdW5jdGlvbiAob2JqZWN0KSB7CgkgICAgcmV0dXJuIG9iamVjdCBpbnN0YW5jZW9mIHRoaXM7CgkgIH07Cgl9CgoJZnVuY3Rpb24gV3JpdGFibGUob3B0aW9ucykgewoJICBEdXBsZXggPSBEdXBsZXggfHwgX193ZWJwYWNrX3JlcXVpcmVfXygyOCk7CgoJICAvLyBXcml0YWJsZSBjdG9yIGlzIGFwcGxpZWQgdG8gRHVwbGV4ZXMsIHRvby4KCSAgLy8gYHJlYWxIYXNJbnN0YW5jZWAgaXMgbmVjZXNzYXJ5IGJlY2F1c2UgdXNpbmcgcGxhaW4gYGluc3RhbmNlb2ZgCgkgIC8vIHdvdWxkIHJldHVybiBmYWxzZSwgYXMgbm8gYF93cml0YWJsZVN0YXRlYCBwcm9wZXJ0eSBpcyBhdHRhY2hlZC4KCgkgIC8vIFRyeWluZyB0byB1c2UgdGhlIGN1c3RvbSBgaW5zdGFuY2VvZmAgZm9yIFdyaXRhYmxlIGhlcmUgd2lsbCBhbHNvIGJyZWFrIHRoZQoJICAvLyBOb2RlLmpzIExhenlUcmFuc2Zvcm0gaW1wbGVtZW50YXRpb24sIHdoaWNoIGhhcyBhIG5vbi10cml2aWFsIGdldHRlciBmb3IKCSAgLy8gYF93cml0YWJsZVN0YXRlYCB0aGF0IHdvdWxkIGxlYWQgdG8gaW5maW5pdGUgcmVjdXJzaW9uLgoJICBpZiAoIXJlYWxIYXNJbnN0YW5jZS5jYWxsKFdyaXRhYmxlLCB0aGlzKSAmJiAhKHRoaXMgaW5zdGFuY2VvZiBEdXBsZXgpKSB7CgkgICAgcmV0dXJuIG5ldyBXcml0YWJsZShvcHRpb25zKTsKCSAgfQoKCSAgdGhpcy5fd3JpdGFibGVTdGF0ZSA9IG5ldyBXcml0YWJsZVN0YXRlKG9wdGlvbnMsIHRoaXMpOwoKCSAgLy8gbGVnYWN5LgoJICB0aGlzLndyaXRhYmxlID0gdHJ1ZTsKCgkgIGlmIChvcHRpb25zKSB7CgkgICAgaWYgKHR5cGVvZiBvcHRpb25zLndyaXRlID09PSAnZnVuY3Rpb24nKSB0aGlzLl93cml0ZSA9IG9wdGlvbnMud3JpdGU7CgoJICAgIGlmICh0eXBlb2Ygb3B0aW9ucy53cml0ZXYgPT09ICdmdW5jdGlvbicpIHRoaXMuX3dyaXRldiA9IG9wdGlvbnMud3JpdGV2OwoJICB9CgoJICBTdHJlYW0uY2FsbCh0aGlzKTsKCX0KCgkvLyBPdGhlcndpc2UgcGVvcGxlIGNhbiBwaXBlIFdyaXRhYmxlIHN0cmVhbXMsIHdoaWNoIGlzIGp1c3Qgd3JvbmcuCglXcml0YWJsZS5wcm90b3R5cGUucGlwZSA9IGZ1bmN0aW9uICgpIHsKCSAgdGhpcy5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignQ2Fubm90IHBpcGUsIG5vdCByZWFkYWJsZScpKTsKCX07CgoJZnVuY3Rpb24gd3JpdGVBZnRlckVuZChzdHJlYW0sIGNiKSB7CgkgIHZhciBlciA9IG5ldyBFcnJvcignd3JpdGUgYWZ0ZXIgZW5kJyk7CgkgIC8vIFRPRE86IGRlZmVyIGVycm9yIGV2ZW50cyBjb25zaXN0ZW50bHkgZXZlcnl3aGVyZSwgbm90IGp1c3QgdGhlIGNiCgkgIHN0cmVhbS5lbWl0KCdlcnJvcicsIGVyKTsKCSAgcHJvY2Vzc05leHRUaWNrKGNiLCBlcik7Cgl9CgoJLy8gSWYgd2UgZ2V0IHNvbWV0aGluZyB0aGF0IGlzIG5vdCBhIGJ1ZmZlciwgc3RyaW5nLCBudWxsLCBvciB1bmRlZmluZWQsCgkvLyBhbmQgd2UncmUgbm90IGluIG9iamVjdE1vZGUsIHRoZW4gdGhhdCdzIGFuIGVycm9yLgoJLy8gT3RoZXJ3aXNlIHN0cmVhbSBjaHVua3MgYXJlIGFsbCBjb25zaWRlcmVkIHRvIGJlIG9mIGxlbmd0aD0xLCBhbmQgdGhlCgkvLyB3YXRlcm1hcmtzIGRldGVybWluZSBob3cgbWFueSBvYmplY3RzIHRvIGtlZXAgaW4gdGhlIGJ1ZmZlciwgcmF0aGVyIHRoYW4KCS8vIGhvdyBtYW55IGJ5dGVzIG9yIGNoYXJhY3RlcnMuCglmdW5jdGlvbiB2YWxpZENodW5rKHN0cmVhbSwgc3RhdGUsIGNodW5rLCBjYikgewoJICB2YXIgdmFsaWQgPSB0cnVlOwoJICB2YXIgZXIgPSBmYWxzZTsKCSAgLy8gQWx3YXlzIHRocm93IGVycm9yIGlmIGEgbnVsbCBpcyB3cml0dGVuCgkgIC8vIGlmIHdlIGFyZSBub3QgaW4gb2JqZWN0IG1vZGUgdGhlbiB0aHJvdwoJICAvLyBpZiBpdCBpcyBub3QgYSBidWZmZXIsIHN0cmluZywgb3IgdW5kZWZpbmVkLgoJICBpZiAoY2h1bmsgPT09IG51bGwpIHsKCSAgICBlciA9IG5ldyBUeXBlRXJyb3IoJ01heSBub3Qgd3JpdGUgbnVsbCB2YWx1ZXMgdG8gc3RyZWFtJyk7CgkgIH0gZWxzZSBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihjaHVuaykgJiYgdHlwZW9mIGNodW5rICE9PSAnc3RyaW5nJyAmJiBjaHVuayAhPT0gdW5kZWZpbmVkICYmICFzdGF0ZS5vYmplY3RNb2RlKSB7CgkgICAgZXIgPSBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIG5vbi1zdHJpbmcvYnVmZmVyIGNodW5rJyk7CgkgIH0KCSAgaWYgKGVyKSB7CgkgICAgc3RyZWFtLmVtaXQoJ2Vycm9yJywgZXIpOwoJICAgIHByb2Nlc3NOZXh0VGljayhjYiwgZXIpOwoJICAgIHZhbGlkID0gZmFsc2U7CgkgIH0KCSAgcmV0dXJuIHZhbGlkOwoJfQoKCVdyaXRhYmxlLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIHZhciBzdGF0ZSA9IHRoaXMuX3dyaXRhYmxlU3RhdGU7CgkgIHZhciByZXQgPSBmYWxzZTsKCgkgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdmdW5jdGlvbicpIHsKCSAgICBjYiA9IGVuY29kaW5nOwoJICAgIGVuY29kaW5nID0gbnVsbDsKCSAgfQoKCSAgaWYgKEJ1ZmZlci5pc0J1ZmZlcihjaHVuaykpIGVuY29kaW5nID0gJ2J1ZmZlcic7ZWxzZSBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9IHN0YXRlLmRlZmF1bHRFbmNvZGluZzsKCgkgIGlmICh0eXBlb2YgY2IgIT09ICdmdW5jdGlvbicpIGNiID0gbm9wOwoKCSAgaWYgKHN0YXRlLmVuZGVkKSB3cml0ZUFmdGVyRW5kKHRoaXMsIGNiKTtlbHNlIGlmICh2YWxpZENodW5rKHRoaXMsIHN0YXRlLCBjaHVuaywgY2IpKSB7CgkgICAgc3RhdGUucGVuZGluZ2NiKys7CgkgICAgcmV0ID0gd3JpdGVPckJ1ZmZlcih0aGlzLCBzdGF0ZSwgY2h1bmssIGVuY29kaW5nLCBjYik7CgkgIH0KCgkgIHJldHVybiByZXQ7Cgl9OwoKCVdyaXRhYmxlLnByb3RvdHlwZS5jb3JrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgc3RhdGUgPSB0aGlzLl93cml0YWJsZVN0YXRlOwoKCSAgc3RhdGUuY29ya2VkKys7Cgl9OwoKCVdyaXRhYmxlLnByb3RvdHlwZS51bmNvcmsgPSBmdW5jdGlvbiAoKSB7CgkgIHZhciBzdGF0ZSA9IHRoaXMuX3dyaXRhYmxlU3RhdGU7CgoJICBpZiAoc3RhdGUuY29ya2VkKSB7CgkgICAgc3RhdGUuY29ya2VkLS07CgoJICAgIGlmICghc3RhdGUud3JpdGluZyAmJiAhc3RhdGUuY29ya2VkICYmICFzdGF0ZS5maW5pc2hlZCAmJiAhc3RhdGUuYnVmZmVyUHJvY2Vzc2luZyAmJiBzdGF0ZS5idWZmZXJlZFJlcXVlc3QpIGNsZWFyQnVmZmVyKHRoaXMsIHN0YXRlKTsKCSAgfQoJfTsKCglXcml0YWJsZS5wcm90b3R5cGUuc2V0RGVmYXVsdEVuY29kaW5nID0gZnVuY3Rpb24gc2V0RGVmYXVsdEVuY29kaW5nKGVuY29kaW5nKSB7CgkgIC8vIG5vZGU6OlBhcnNlRW5jb2RpbmcoKSByZXF1aXJlcyBsb3dlciBjYXNlLgoJICBpZiAodHlwZW9mIGVuY29kaW5nID09PSAnc3RyaW5nJykgZW5jb2RpbmcgPSBlbmNvZGluZy50b0xvd2VyQ2FzZSgpOwoJICBpZiAoIShbJ2hleCcsICd1dGY4JywgJ3V0Zi04JywgJ2FzY2lpJywgJ2JpbmFyeScsICdiYXNlNjQnLCAndWNzMicsICd1Y3MtMicsICd1dGYxNmxlJywgJ3V0Zi0xNmxlJywgJ3JhdyddLmluZGV4T2YoKGVuY29kaW5nICsgJycpLnRvTG93ZXJDYXNlKCkpID4gLTEpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpOwoJICB0aGlzLl93cml0YWJsZVN0YXRlLmRlZmF1bHRFbmNvZGluZyA9IGVuY29kaW5nOwoJICByZXR1cm4gdGhpczsKCX07CgoJZnVuY3Rpb24gZGVjb2RlQ2h1bmsoc3RhdGUsIGNodW5rLCBlbmNvZGluZykgewoJICBpZiAoIXN0YXRlLm9iamVjdE1vZGUgJiYgc3RhdGUuZGVjb2RlU3RyaW5ncyAhPT0gZmFsc2UgJiYgdHlwZW9mIGNodW5rID09PSAnc3RyaW5nJykgewoJICAgIGNodW5rID0gYnVmZmVyU2hpbS5mcm9tKGNodW5rLCBlbmNvZGluZyk7CgkgIH0KCSAgcmV0dXJuIGNodW5rOwoJfQoKCS8vIGlmIHdlJ3JlIGFscmVhZHkgd3JpdGluZyBzb21ldGhpbmcsIHRoZW4ganVzdCBwdXQgdGhpcwoJLy8gaW4gdGhlIHF1ZXVlLCBhbmQgd2FpdCBvdXIgdHVybi4gIE90aGVyd2lzZSwgY2FsbCBfd3JpdGUKCS8vIElmIHdlIHJldHVybiBmYWxzZSwgdGhlbiB3ZSBuZWVkIGEgZHJhaW4gZXZlbnQsIHNvIHNldCB0aGF0IGZsYWcuCglmdW5jdGlvbiB3cml0ZU9yQnVmZmVyKHN0cmVhbSwgc3RhdGUsIGNodW5rLCBlbmNvZGluZywgY2IpIHsKCSAgY2h1bmsgPSBkZWNvZGVDaHVuayhzdGF0ZSwgY2h1bmssIGVuY29kaW5nKTsKCgkgIGlmIChCdWZmZXIuaXNCdWZmZXIoY2h1bmspKSBlbmNvZGluZyA9ICdidWZmZXInOwoJICB2YXIgbGVuID0gc3RhdGUub2JqZWN0TW9kZSA/IDEgOiBjaHVuay5sZW5ndGg7CgoJICBzdGF0ZS5sZW5ndGggKz0gbGVuOwoKCSAgdmFyIHJldCA9IHN0YXRlLmxlbmd0aCA8IHN0YXRlLmhpZ2hXYXRlck1hcms7CgkgIC8vIHdlIG11c3QgZW5zdXJlIHRoYXQgcHJldmlvdXMgbmVlZERyYWluIHdpbGwgbm90IGJlIHJlc2V0IHRvIGZhbHNlLgoJICBpZiAoIXJldCkgc3RhdGUubmVlZERyYWluID0gdHJ1ZTsKCgkgIGlmIChzdGF0ZS53cml0aW5nIHx8IHN0YXRlLmNvcmtlZCkgewoJICAgIHZhciBsYXN0ID0gc3RhdGUubGFzdEJ1ZmZlcmVkUmVxdWVzdDsKCSAgICBzdGF0ZS5sYXN0QnVmZmVyZWRSZXF1ZXN0ID0gbmV3IFdyaXRlUmVxKGNodW5rLCBlbmNvZGluZywgY2IpOwoJICAgIGlmIChsYXN0KSB7CgkgICAgICBsYXN0Lm5leHQgPSBzdGF0ZS5sYXN0QnVmZmVyZWRSZXF1ZXN0OwoJICAgIH0gZWxzZSB7CgkgICAgICBzdGF0ZS5idWZmZXJlZFJlcXVlc3QgPSBzdGF0ZS5sYXN0QnVmZmVyZWRSZXF1ZXN0OwoJICAgIH0KCSAgICBzdGF0ZS5idWZmZXJlZFJlcXVlc3RDb3VudCArPSAxOwoJICB9IGVsc2UgewoJICAgIGRvV3JpdGUoc3RyZWFtLCBzdGF0ZSwgZmFsc2UsIGxlbiwgY2h1bmssIGVuY29kaW5nLCBjYik7CgkgIH0KCgkgIHJldHVybiByZXQ7Cgl9CgoJZnVuY3Rpb24gZG9Xcml0ZShzdHJlYW0sIHN0YXRlLCB3cml0ZXYsIGxlbiwgY2h1bmssIGVuY29kaW5nLCBjYikgewoJICBzdGF0ZS53cml0ZWxlbiA9IGxlbjsKCSAgc3RhdGUud3JpdGVjYiA9IGNiOwoJICBzdGF0ZS53cml0aW5nID0gdHJ1ZTsKCSAgc3RhdGUuc3luYyA9IHRydWU7CgkgIGlmICh3cml0ZXYpIHN0cmVhbS5fd3JpdGV2KGNodW5rLCBzdGF0ZS5vbndyaXRlKTtlbHNlIHN0cmVhbS5fd3JpdGUoY2h1bmssIGVuY29kaW5nLCBzdGF0ZS5vbndyaXRlKTsKCSAgc3RhdGUuc3luYyA9IGZhbHNlOwoJfQoKCWZ1bmN0aW9uIG9ud3JpdGVFcnJvcihzdHJlYW0sIHN0YXRlLCBzeW5jLCBlciwgY2IpIHsKCSAgLS1zdGF0ZS5wZW5kaW5nY2I7CgkgIGlmIChzeW5jKSBwcm9jZXNzTmV4dFRpY2soY2IsIGVyKTtlbHNlIGNiKGVyKTsKCgkgIHN0cmVhbS5fd3JpdGFibGVTdGF0ZS5lcnJvckVtaXR0ZWQgPSB0cnVlOwoJICBzdHJlYW0uZW1pdCgnZXJyb3InLCBlcik7Cgl9CgoJZnVuY3Rpb24gb253cml0ZVN0YXRlVXBkYXRlKHN0YXRlKSB7CgkgIHN0YXRlLndyaXRpbmcgPSBmYWxzZTsKCSAgc3RhdGUud3JpdGVjYiA9IG51bGw7CgkgIHN0YXRlLmxlbmd0aCAtPSBzdGF0ZS53cml0ZWxlbjsKCSAgc3RhdGUud3JpdGVsZW4gPSAwOwoJfQoKCWZ1bmN0aW9uIG9ud3JpdGUoc3RyZWFtLCBlcikgewoJICB2YXIgc3RhdGUgPSBzdHJlYW0uX3dyaXRhYmxlU3RhdGU7CgkgIHZhciBzeW5jID0gc3RhdGUuc3luYzsKCSAgdmFyIGNiID0gc3RhdGUud3JpdGVjYjsKCgkgIG9ud3JpdGVTdGF0ZVVwZGF0ZShzdGF0ZSk7CgoJICBpZiAoZXIpIG9ud3JpdGVFcnJvcihzdHJlYW0sIHN0YXRlLCBzeW5jLCBlciwgY2IpO2Vsc2UgewoJICAgIC8vIENoZWNrIGlmIHdlJ3JlIGFjdHVhbGx5IHJlYWR5IHRvIGZpbmlzaCwgYnV0IGRvbid0IGVtaXQgeWV0CgkgICAgdmFyIGZpbmlzaGVkID0gbmVlZEZpbmlzaChzdGF0ZSk7CgoJICAgIGlmICghZmluaXNoZWQgJiYgIXN0YXRlLmNvcmtlZCAmJiAhc3RhdGUuYnVmZmVyUHJvY2Vzc2luZyAmJiBzdGF0ZS5idWZmZXJlZFJlcXVlc3QpIHsKCSAgICAgIGNsZWFyQnVmZmVyKHN0cmVhbSwgc3RhdGUpOwoJICAgIH0KCgkgICAgaWYgKHN5bmMpIHsKCSAgICAgIC8qPHJlcGxhY2VtZW50PiovCgkgICAgICBhc3luY1dyaXRlKGFmdGVyV3JpdGUsIHN0cmVhbSwgc3RhdGUsIGZpbmlzaGVkLCBjYik7CgkgICAgICAvKjwvcmVwbGFjZW1lbnQ+Ki8KCSAgICB9IGVsc2UgewoJICAgICAgICBhZnRlcldyaXRlKHN0cmVhbSwgc3RhdGUsIGZpbmlzaGVkLCBjYik7CgkgICAgICB9CgkgIH0KCX0KCglmdW5jdGlvbiBhZnRlcldyaXRlKHN0cmVhbSwgc3RhdGUsIGZpbmlzaGVkLCBjYikgewoJICBpZiAoIWZpbmlzaGVkKSBvbndyaXRlRHJhaW4oc3RyZWFtLCBzdGF0ZSk7CgkgIHN0YXRlLnBlbmRpbmdjYi0tOwoJICBjYigpOwoJICBmaW5pc2hNYXliZShzdHJlYW0sIHN0YXRlKTsKCX0KCgkvLyBNdXN0IGZvcmNlIGNhbGxiYWNrIHRvIGJlIGNhbGxlZCBvbiBuZXh0VGljaywgc28gdGhhdCB3ZSBkb24ndAoJLy8gZW1pdCAnZHJhaW4nIGJlZm9yZSB0aGUgd3JpdGUoKSBjb25zdW1lciBnZXRzIHRoZSAnZmFsc2UnIHJldHVybgoJLy8gdmFsdWUsIGFuZCBoYXMgYSBjaGFuY2UgdG8gYXR0YWNoIGEgJ2RyYWluJyBsaXN0ZW5lci4KCWZ1bmN0aW9uIG9ud3JpdGVEcmFpbihzdHJlYW0sIHN0YXRlKSB7CgkgIGlmIChzdGF0ZS5sZW5ndGggPT09IDAgJiYgc3RhdGUubmVlZERyYWluKSB7CgkgICAgc3RhdGUubmVlZERyYWluID0gZmFsc2U7CgkgICAgc3RyZWFtLmVtaXQoJ2RyYWluJyk7CgkgIH0KCX0KCgkvLyBpZiB0aGVyZSdzIHNvbWV0aGluZyBpbiB0aGUgYnVmZmVyIHdhaXRpbmcsIHRoZW4gcHJvY2VzcyBpdAoJZnVuY3Rpb24gY2xlYXJCdWZmZXIoc3RyZWFtLCBzdGF0ZSkgewoJICBzdGF0ZS5idWZmZXJQcm9jZXNzaW5nID0gdHJ1ZTsKCSAgdmFyIGVudHJ5ID0gc3RhdGUuYnVmZmVyZWRSZXF1ZXN0OwoKCSAgaWYgKHN0cmVhbS5fd3JpdGV2ICYmIGVudHJ5ICYmIGVudHJ5Lm5leHQpIHsKCSAgICAvLyBGYXN0IGNhc2UsIHdyaXRlIGV2ZXJ5dGhpbmcgdXNpbmcgX3dyaXRldigpCgkgICAgdmFyIGwgPSBzdGF0ZS5idWZmZXJlZFJlcXVlc3RDb3VudDsKCSAgICB2YXIgYnVmZmVyID0gbmV3IEFycmF5KGwpOwoJICAgIHZhciBob2xkZXIgPSBzdGF0ZS5jb3JrZWRSZXF1ZXN0c0ZyZWU7CgkgICAgaG9sZGVyLmVudHJ5ID0gZW50cnk7CgoJICAgIHZhciBjb3VudCA9IDA7CgkgICAgd2hpbGUgKGVudHJ5KSB7CgkgICAgICBidWZmZXJbY291bnRdID0gZW50cnk7CgkgICAgICBlbnRyeSA9IGVudHJ5Lm5leHQ7CgkgICAgICBjb3VudCArPSAxOwoJICAgIH0KCgkgICAgZG9Xcml0ZShzdHJlYW0sIHN0YXRlLCB0cnVlLCBzdGF0ZS5sZW5ndGgsIGJ1ZmZlciwgJycsIGhvbGRlci5maW5pc2gpOwoKCSAgICAvLyBkb1dyaXRlIGlzIGFsbW9zdCBhbHdheXMgYXN5bmMsIGRlZmVyIHRoZXNlIHRvIHNhdmUgYSBiaXQgb2YgdGltZQoJICAgIC8vIGFzIHRoZSBob3QgcGF0aCBlbmRzIHdpdGggZG9Xcml0ZQoJICAgIHN0YXRlLnBlbmRpbmdjYisrOwoJICAgIHN0YXRlLmxhc3RCdWZmZXJlZFJlcXVlc3QgPSBudWxsOwoJICAgIGlmIChob2xkZXIubmV4dCkgewoJICAgICAgc3RhdGUuY29ya2VkUmVxdWVzdHNGcmVlID0gaG9sZGVyLm5leHQ7CgkgICAgICBob2xkZXIubmV4dCA9IG51bGw7CgkgICAgfSBlbHNlIHsKCSAgICAgIHN0YXRlLmNvcmtlZFJlcXVlc3RzRnJlZSA9IG5ldyBDb3JrZWRSZXF1ZXN0KHN0YXRlKTsKCSAgICB9CgkgIH0gZWxzZSB7CgkgICAgLy8gU2xvdyBjYXNlLCB3cml0ZSBjaHVua3Mgb25lLWJ5LW9uZQoJICAgIHdoaWxlIChlbnRyeSkgewoJICAgICAgdmFyIGNodW5rID0gZW50cnkuY2h1bms7CgkgICAgICB2YXIgZW5jb2RpbmcgPSBlbnRyeS5lbmNvZGluZzsKCSAgICAgIHZhciBjYiA9IGVudHJ5LmNhbGxiYWNrOwoJICAgICAgdmFyIGxlbiA9IHN0YXRlLm9iamVjdE1vZGUgPyAxIDogY2h1bmsubGVuZ3RoOwoKCSAgICAgIGRvV3JpdGUoc3RyZWFtLCBzdGF0ZSwgZmFsc2UsIGxlbiwgY2h1bmssIGVuY29kaW5nLCBjYik7CgkgICAgICBlbnRyeSA9IGVudHJ5Lm5leHQ7CgkgICAgICAvLyBpZiB3ZSBkaWRuJ3QgY2FsbCB0aGUgb253cml0ZSBpbW1lZGlhdGVseSwgdGhlbgoJICAgICAgLy8gaXQgbWVhbnMgdGhhdCB3ZSBuZWVkIHRvIHdhaXQgdW50aWwgaXQgZG9lcy4KCSAgICAgIC8vIGFsc28sIHRoYXQgbWVhbnMgdGhhdCB0aGUgY2h1bmsgYW5kIGNiIGFyZSBjdXJyZW50bHkKCSAgICAgIC8vIGJlaW5nIHByb2Nlc3NlZCwgc28gbW92ZSB0aGUgYnVmZmVyIGNvdW50ZXIgcGFzdCB0aGVtLgoJICAgICAgaWYgKHN0YXRlLndyaXRpbmcpIHsKCSAgICAgICAgYnJlYWs7CgkgICAgICB9CgkgICAgfQoKCSAgICBpZiAoZW50cnkgPT09IG51bGwpIHN0YXRlLmxhc3RCdWZmZXJlZFJlcXVlc3QgPSBudWxsOwoJICB9CgoJICBzdGF0ZS5idWZmZXJlZFJlcXVlc3RDb3VudCA9IDA7CgkgIHN0YXRlLmJ1ZmZlcmVkUmVxdWVzdCA9IGVudHJ5OwoJICBzdGF0ZS5idWZmZXJQcm9jZXNzaW5nID0gZmFsc2U7Cgl9CgoJV3JpdGFibGUucHJvdG90eXBlLl93cml0ZSA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIGNiKG5ldyBFcnJvcignX3dyaXRlKCkgaXMgbm90IGltcGxlbWVudGVkJykpOwoJfTsKCglXcml0YWJsZS5wcm90b3R5cGUuX3dyaXRldiA9IG51bGw7CgoJV3JpdGFibGUucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIHZhciBzdGF0ZSA9IHRoaXMuX3dyaXRhYmxlU3RhdGU7CgoJICBpZiAodHlwZW9mIGNodW5rID09PSAnZnVuY3Rpb24nKSB7CgkgICAgY2IgPSBjaHVuazsKCSAgICBjaHVuayA9IG51bGw7CgkgICAgZW5jb2RpbmcgPSBudWxsOwoJICB9IGVsc2UgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIGNiID0gZW5jb2Rpbmc7CgkgICAgZW5jb2RpbmcgPSBudWxsOwoJICB9CgoJICBpZiAoY2h1bmsgIT09IG51bGwgJiYgY2h1bmsgIT09IHVuZGVmaW5lZCkgdGhpcy53cml0ZShjaHVuaywgZW5jb2RpbmcpOwoKCSAgLy8gLmVuZCgpIGZ1bGx5IHVuY29ya3MKCSAgaWYgKHN0YXRlLmNvcmtlZCkgewoJICAgIHN0YXRlLmNvcmtlZCA9IDE7CgkgICAgdGhpcy51bmNvcmsoKTsKCSAgfQoKCSAgLy8gaWdub3JlIHVubmVjZXNzYXJ5IGVuZCgpIGNhbGxzLgoJICBpZiAoIXN0YXRlLmVuZGluZyAmJiAhc3RhdGUuZmluaXNoZWQpIGVuZFdyaXRhYmxlKHRoaXMsIHN0YXRlLCBjYik7Cgl9OwoKCWZ1bmN0aW9uIG5lZWRGaW5pc2goc3RhdGUpIHsKCSAgcmV0dXJuIHN0YXRlLmVuZGluZyAmJiBzdGF0ZS5sZW5ndGggPT09IDAgJiYgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0ID09PSBudWxsICYmICFzdGF0ZS5maW5pc2hlZCAmJiAhc3RhdGUud3JpdGluZzsKCX0KCglmdW5jdGlvbiBwcmVmaW5pc2goc3RyZWFtLCBzdGF0ZSkgewoJICBpZiAoIXN0YXRlLnByZWZpbmlzaGVkKSB7CgkgICAgc3RhdGUucHJlZmluaXNoZWQgPSB0cnVlOwoJICAgIHN0cmVhbS5lbWl0KCdwcmVmaW5pc2gnKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIGZpbmlzaE1heWJlKHN0cmVhbSwgc3RhdGUpIHsKCSAgdmFyIG5lZWQgPSBuZWVkRmluaXNoKHN0YXRlKTsKCSAgaWYgKG5lZWQpIHsKCSAgICBpZiAoc3RhdGUucGVuZGluZ2NiID09PSAwKSB7CgkgICAgICBwcmVmaW5pc2goc3RyZWFtLCBzdGF0ZSk7CgkgICAgICBzdGF0ZS5maW5pc2hlZCA9IHRydWU7CgkgICAgICBzdHJlYW0uZW1pdCgnZmluaXNoJyk7CgkgICAgfSBlbHNlIHsKCSAgICAgIHByZWZpbmlzaChzdHJlYW0sIHN0YXRlKTsKCSAgICB9CgkgIH0KCSAgcmV0dXJuIG5lZWQ7Cgl9CgoJZnVuY3Rpb24gZW5kV3JpdGFibGUoc3RyZWFtLCBzdGF0ZSwgY2IpIHsKCSAgc3RhdGUuZW5kaW5nID0gdHJ1ZTsKCSAgZmluaXNoTWF5YmUoc3RyZWFtLCBzdGF0ZSk7CgkgIGlmIChjYikgewoJICAgIGlmIChzdGF0ZS5maW5pc2hlZCkgcHJvY2Vzc05leHRUaWNrKGNiKTtlbHNlIHN0cmVhbS5vbmNlKCdmaW5pc2gnLCBjYik7CgkgIH0KCSAgc3RhdGUuZW5kZWQgPSB0cnVlOwoJICBzdHJlYW0ud3JpdGFibGUgPSBmYWxzZTsKCX0KCgkvLyBJdCBzZWVtcyBhIGxpbmtlZCBsaXN0IGJ1dCBpdCBpcyBub3QKCS8vIHRoZXJlIHdpbGwgYmUgb25seSAyIG9mIHRoZXNlIGZvciBlYWNoIHN0cmVhbQoJZnVuY3Rpb24gQ29ya2VkUmVxdWVzdChzdGF0ZSkgewoJICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgdGhpcy5uZXh0ID0gbnVsbDsKCSAgdGhpcy5lbnRyeSA9IG51bGw7CgoJICB0aGlzLmZpbmlzaCA9IGZ1bmN0aW9uIChlcnIpIHsKCSAgICB2YXIgZW50cnkgPSBfdGhpcy5lbnRyeTsKCSAgICBfdGhpcy5lbnRyeSA9IG51bGw7CgkgICAgd2hpbGUgKGVudHJ5KSB7CgkgICAgICB2YXIgY2IgPSBlbnRyeS5jYWxsYmFjazsKCSAgICAgIHN0YXRlLnBlbmRpbmdjYi0tOwoJICAgICAgY2IoZXJyKTsKCSAgICAgIGVudHJ5ID0gZW50cnkubmV4dDsKCSAgICB9CgkgICAgaWYgKHN0YXRlLmNvcmtlZFJlcXVlc3RzRnJlZSkgewoJICAgICAgc3RhdGUuY29ya2VkUmVxdWVzdHNGcmVlLm5leHQgPSBfdGhpczsKCSAgICB9IGVsc2UgewoJICAgICAgc3RhdGUuY29ya2VkUmVxdWVzdHNGcmVlID0gX3RoaXM7CgkgICAgfQoJICB9OwoJfQoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMTIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKS5zZXRJbW1lZGlhdGUpKQoKLyoqKi8gfSwKLyogMjEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGFwcGx5ID0gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5OwoKCS8vIERPTSBBUElzLCBmb3IgY29tcGxldGVuZXNzCgoJZXhwb3J0cy5zZXRUaW1lb3V0ID0gZnVuY3Rpb24oKSB7CgkgIHJldHVybiBuZXcgVGltZW91dChhcHBseS5jYWxsKHNldFRpbWVvdXQsIHdpbmRvdywgYXJndW1lbnRzKSwgY2xlYXJUaW1lb3V0KTsKCX07CglleHBvcnRzLnNldEludGVydmFsID0gZnVuY3Rpb24oKSB7CgkgIHJldHVybiBuZXcgVGltZW91dChhcHBseS5jYWxsKHNldEludGVydmFsLCB3aW5kb3csIGFyZ3VtZW50cyksIGNsZWFySW50ZXJ2YWwpOwoJfTsKCWV4cG9ydHMuY2xlYXJUaW1lb3V0ID0KCWV4cG9ydHMuY2xlYXJJbnRlcnZhbCA9IGZ1bmN0aW9uKHRpbWVvdXQpIHsKCSAgaWYgKHRpbWVvdXQpIHsKCSAgICB0aW1lb3V0LmNsb3NlKCk7CgkgIH0KCX07CgoJZnVuY3Rpb24gVGltZW91dChpZCwgY2xlYXJGbikgewoJICB0aGlzLl9pZCA9IGlkOwoJICB0aGlzLl9jbGVhckZuID0gY2xlYXJGbjsKCX0KCVRpbWVvdXQucHJvdG90eXBlLnVucmVmID0gVGltZW91dC5wcm90b3R5cGUucmVmID0gZnVuY3Rpb24oKSB7fTsKCVRpbWVvdXQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oKSB7CgkgIHRoaXMuX2NsZWFyRm4uY2FsbCh3aW5kb3csIHRoaXMuX2lkKTsKCX07CgoJLy8gRG9lcyBub3Qgc3RhcnQgdGhlIHRpbWUsIGp1c3Qgc2V0cyB1cCB0aGUgbWVtYmVycyBuZWVkZWQuCglleHBvcnRzLmVucm9sbCA9IGZ1bmN0aW9uKGl0ZW0sIG1zZWNzKSB7CgkgIGNsZWFyVGltZW91dChpdGVtLl9pZGxlVGltZW91dElkKTsKCSAgaXRlbS5faWRsZVRpbWVvdXQgPSBtc2VjczsKCX07CgoJZXhwb3J0cy51bmVucm9sbCA9IGZ1bmN0aW9uKGl0ZW0pIHsKCSAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpOwoJICBpdGVtLl9pZGxlVGltZW91dCA9IC0xOwoJfTsKCglleHBvcnRzLl91bnJlZkFjdGl2ZSA9IGV4cG9ydHMuYWN0aXZlID0gZnVuY3Rpb24oaXRlbSkgewoJICBjbGVhclRpbWVvdXQoaXRlbS5faWRsZVRpbWVvdXRJZCk7CgoJICB2YXIgbXNlY3MgPSBpdGVtLl9pZGxlVGltZW91dDsKCSAgaWYgKG1zZWNzID49IDApIHsKCSAgICBpdGVtLl9pZGxlVGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiBvblRpbWVvdXQoKSB7CgkgICAgICBpZiAoaXRlbS5fb25UaW1lb3V0KQoJICAgICAgICBpdGVtLl9vblRpbWVvdXQoKTsKCSAgICB9LCBtc2Vjcyk7CgkgIH0KCX07CgoJLy8gc2V0aW1tZWRpYXRlIGF0dGFjaGVzIGl0c2VsZiB0byB0aGUgZ2xvYmFsIG9iamVjdAoJX193ZWJwYWNrX3JlcXVpcmVfXygyMik7CglleHBvcnRzLnNldEltbWVkaWF0ZSA9IHNldEltbWVkaWF0ZTsKCWV4cG9ydHMuY2xlYXJJbW1lZGlhdGUgPSBjbGVhckltbWVkaWF0ZTsKCgovKioqLyB9LAovKiAyMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsLCBwcm9jZXNzKSB7KGZ1bmN0aW9uIChnbG9iYWwsIHVuZGVmaW5lZCkgewoJICAgICJ1c2Ugc3RyaWN0IjsKCgkgICAgaWYgKGdsb2JhbC5zZXRJbW1lZGlhdGUpIHsKCSAgICAgICAgcmV0dXJuOwoJICAgIH0KCgkgICAgdmFyIG5leHRIYW5kbGUgPSAxOyAvLyBTcGVjIHNheXMgZ3JlYXRlciB0aGFuIHplcm8KCSAgICB2YXIgdGFza3NCeUhhbmRsZSA9IHt9OwoJICAgIHZhciBjdXJyZW50bHlSdW5uaW5nQVRhc2sgPSBmYWxzZTsKCSAgICB2YXIgZG9jID0gZ2xvYmFsLmRvY3VtZW50OwoJICAgIHZhciByZWdpc3RlckltbWVkaWF0ZTsKCgkgICAgZnVuY3Rpb24gc2V0SW1tZWRpYXRlKGNhbGxiYWNrKSB7CgkgICAgICAvLyBDYWxsYmFjayBjYW4gZWl0aGVyIGJlIGEgZnVuY3Rpb24gb3IgYSBzdHJpbmcKCSAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICJmdW5jdGlvbiIpIHsKCSAgICAgICAgY2FsbGJhY2sgPSBuZXcgRnVuY3Rpb24oIiIgKyBjYWxsYmFjayk7CgkgICAgICB9CgkgICAgICAvLyBDb3B5IGZ1bmN0aW9uIGFyZ3VtZW50cwoJICAgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpOwoJICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpICsgMV07CgkgICAgICB9CgkgICAgICAvLyBTdG9yZSBhbmQgcmVnaXN0ZXIgdGhlIHRhc2sKCSAgICAgIHZhciB0YXNrID0geyBjYWxsYmFjazogY2FsbGJhY2ssIGFyZ3M6IGFyZ3MgfTsKCSAgICAgIHRhc2tzQnlIYW5kbGVbbmV4dEhhbmRsZV0gPSB0YXNrOwoJICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUobmV4dEhhbmRsZSk7CgkgICAgICByZXR1cm4gbmV4dEhhbmRsZSsrOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaGFuZGxlKSB7CgkgICAgICAgIGRlbGV0ZSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07CgkgICAgfQoKCSAgICBmdW5jdGlvbiBydW4odGFzaykgewoJICAgICAgICB2YXIgY2FsbGJhY2sgPSB0YXNrLmNhbGxiYWNrOwoJICAgICAgICB2YXIgYXJncyA9IHRhc2suYXJnczsKCSAgICAgICAgc3dpdGNoIChhcmdzLmxlbmd0aCkgewoJICAgICAgICBjYXNlIDA6CgkgICAgICAgICAgICBjYWxsYmFjaygpOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgIGNhc2UgMToKCSAgICAgICAgICAgIGNhbGxiYWNrKGFyZ3NbMF0pOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgIGNhbGxiYWNrKGFyZ3NbMF0sIGFyZ3NbMV0pOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgIGNhbGxiYWNrKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgIGRlZmF1bHQ6CgkgICAgICAgICAgICBjYWxsYmFjay5hcHBseSh1bmRlZmluZWQsIGFyZ3MpOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgIH0KCSAgICB9CgoJICAgIGZ1bmN0aW9uIHJ1bklmUHJlc2VudChoYW5kbGUpIHsKCSAgICAgICAgLy8gRnJvbSB0aGUgc3BlYzogIldhaXQgdW50aWwgYW55IGludm9jYXRpb25zIG9mIHRoaXMgYWxnb3JpdGhtIHN0YXJ0ZWQgYmVmb3JlIHRoaXMgb25lIGhhdmUgY29tcGxldGVkLiIKCSAgICAgICAgLy8gU28gaWYgd2UncmUgY3VycmVudGx5IHJ1bm5pbmcgYSB0YXNrLCB3ZSdsbCBuZWVkIHRvIGRlbGF5IHRoaXMgaW52b2NhdGlvbi4KCSAgICAgICAgaWYgKGN1cnJlbnRseVJ1bm5pbmdBVGFzaykgewoJICAgICAgICAgICAgLy8gRGVsYXkgYnkgZG9pbmcgYSBzZXRUaW1lb3V0LiBzZXRJbW1lZGlhdGUgd2FzIHRyaWVkIGluc3RlYWQsIGJ1dCBpbiBGaXJlZm94IDcgaXQgZ2VuZXJhdGVkIGEKCSAgICAgICAgICAgIC8vICJ0b28gbXVjaCByZWN1cnNpb24iIGVycm9yLgoJICAgICAgICAgICAgc2V0VGltZW91dChydW5JZlByZXNlbnQsIDAsIGhhbmRsZSk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICB2YXIgdGFzayA9IHRhc2tzQnlIYW5kbGVbaGFuZGxlXTsKCSAgICAgICAgICAgIGlmICh0YXNrKSB7CgkgICAgICAgICAgICAgICAgY3VycmVudGx5UnVubmluZ0FUYXNrID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBydW4odGFzayk7CgkgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICAgICAgY2xlYXJJbW1lZGlhdGUoaGFuZGxlKTsKCSAgICAgICAgICAgICAgICAgICAgY3VycmVudGx5UnVubmluZ0FUYXNrID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQoKCSAgICBmdW5jdGlvbiBpbnN0YWxsTmV4dFRpY2tJbXBsZW1lbnRhdGlvbigpIHsKCSAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHsKCSAgICAgICAgICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gKCkgeyBydW5JZlByZXNlbnQoaGFuZGxlKTsgfSk7CgkgICAgICAgIH07CgkgICAgfQoKCSAgICBmdW5jdGlvbiBjYW5Vc2VQb3N0TWVzc2FnZSgpIHsKCSAgICAgICAgLy8gVGhlIHRlc3QgYWdhaW5zdCBgaW1wb3J0U2NyaXB0c2AgcHJldmVudHMgdGhpcyBpbXBsZW1lbnRhdGlvbiBmcm9tIGJlaW5nIGluc3RhbGxlZCBpbnNpZGUgYSB3ZWIgd29ya2VyLAoJICAgICAgICAvLyB3aGVyZSBgZ2xvYmFsLnBvc3RNZXNzYWdlYCBtZWFucyBzb21ldGhpbmcgY29tcGxldGVseSBkaWZmZXJlbnQgYW5kIGNhbid0IGJlIHVzZWQgZm9yIHRoaXMgcHVycG9zZS4KCSAgICAgICAgaWYgKGdsb2JhbC5wb3N0TWVzc2FnZSAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpIHsKCSAgICAgICAgICAgIHZhciBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzID0gdHJ1ZTsKCSAgICAgICAgICAgIHZhciBvbGRPbk1lc3NhZ2UgPSBnbG9iYWwub25tZXNzYWdlOwoJICAgICAgICAgICAgZ2xvYmFsLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKCkgewoJICAgICAgICAgICAgICAgIHBvc3RNZXNzYWdlSXNBc3luY2hyb25vdXMgPSBmYWxzZTsKCSAgICAgICAgICAgIH07CgkgICAgICAgICAgICBnbG9iYWwucG9zdE1lc3NhZ2UoIiIsICIqIik7CgkgICAgICAgICAgICBnbG9iYWwub25tZXNzYWdlID0gb2xkT25NZXNzYWdlOwoJICAgICAgICAgICAgcmV0dXJuIHBvc3RNZXNzYWdlSXNBc3luY2hyb25vdXM7CgkgICAgICAgIH0KCSAgICB9CgoJICAgIGZ1bmN0aW9uIGluc3RhbGxQb3N0TWVzc2FnZUltcGxlbWVudGF0aW9uKCkgewoJICAgICAgICAvLyBJbnN0YWxscyBhbiBldmVudCBoYW5kbGVyIG9uIGBnbG9iYWxgIGZvciB0aGUgYG1lc3NhZ2VgIGV2ZW50OiBzZWUKCSAgICAgICAgLy8gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9ET00vd2luZG93LnBvc3RNZXNzYWdlCgkgICAgICAgIC8vICogaHR0cDovL3d3dy53aGF0d2cub3JnL3NwZWNzL3dlYi1hcHBzL2N1cnJlbnQtd29yay9tdWx0aXBhZ2UvY29tbXMuaHRtbCNjcm9zc0RvY3VtZW50TWVzc2FnZXMKCgkgICAgICAgIHZhciBtZXNzYWdlUHJlZml4ID0gInNldEltbWVkaWF0ZSQiICsgTWF0aC5yYW5kb20oKSArICIkIjsKCSAgICAgICAgdmFyIG9uR2xvYmFsTWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkgICAgICAgICAgICBpZiAoZXZlbnQuc291cmNlID09PSBnbG9iYWwgJiYKCSAgICAgICAgICAgICAgICB0eXBlb2YgZXZlbnQuZGF0YSA9PT0gInN0cmluZyIgJiYKCSAgICAgICAgICAgICAgICBldmVudC5kYXRhLmluZGV4T2YobWVzc2FnZVByZWZpeCkgPT09IDApIHsKCSAgICAgICAgICAgICAgICBydW5JZlByZXNlbnQoK2V2ZW50LmRhdGEuc2xpY2UobWVzc2FnZVByZWZpeC5sZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfTsKCgkgICAgICAgIGlmIChnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcikgewoJICAgICAgICAgICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBvbkdsb2JhbE1lc3NhZ2UsIGZhbHNlKTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIGdsb2JhbC5hdHRhY2hFdmVudCgib25tZXNzYWdlIiwgb25HbG9iYWxNZXNzYWdlKTsKCSAgICAgICAgfQoKCSAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHsKCSAgICAgICAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShtZXNzYWdlUHJlZml4ICsgaGFuZGxlLCAiKiIpOwoJICAgICAgICB9OwoJICAgIH0KCgkgICAgZnVuY3Rpb24gaW5zdGFsbE1lc3NhZ2VDaGFubmVsSW1wbGVtZW50YXRpb24oKSB7CgkgICAgICAgIHZhciBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7CgkgICAgICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQpIHsKCSAgICAgICAgICAgIHZhciBoYW5kbGUgPSBldmVudC5kYXRhOwoJICAgICAgICAgICAgcnVuSWZQcmVzZW50KGhhbmRsZSk7CgkgICAgICAgIH07CgoJICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkgewoJICAgICAgICAgICAgY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZShoYW5kbGUpOwoJICAgICAgICB9OwoJICAgIH0KCgkgICAgZnVuY3Rpb24gaW5zdGFsbFJlYWR5U3RhdGVDaGFuZ2VJbXBsZW1lbnRhdGlvbigpIHsKCSAgICAgICAgdmFyIGh0bWwgPSBkb2MuZG9jdW1lbnRFbGVtZW50OwoJICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkgewoJICAgICAgICAgICAgLy8gQ3JlYXRlIGEgPHNjcmlwdD4gZWxlbWVudDsgaXRzIHJlYWR5c3RhdGVjaGFuZ2UgZXZlbnQgd2lsbCBiZSBmaXJlZCBhc3luY2hyb25vdXNseSBvbmNlIGl0IGlzIGluc2VydGVkCgkgICAgICAgICAgICAvLyBpbnRvIHRoZSBkb2N1bWVudC4gRG8gc28sIHRodXMgcXVldWluZyB1cCB0aGUgdGFzay4gUmVtZW1iZXIgdG8gY2xlYW4gdXAgb25jZSBpdCdzIGJlZW4gY2FsbGVkLgoJICAgICAgICAgICAgdmFyIHNjcmlwdCA9IGRvYy5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsKCSAgICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICAgICAgcnVuSWZQcmVzZW50KGhhbmRsZSk7CgkgICAgICAgICAgICAgICAgc2NyaXB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7CgkgICAgICAgICAgICAgICAgaHRtbC5yZW1vdmVDaGlsZChzY3JpcHQpOwoJICAgICAgICAgICAgICAgIHNjcmlwdCA9IG51bGw7CgkgICAgICAgICAgICB9OwoJICAgICAgICAgICAgaHRtbC5hcHBlbmRDaGlsZChzY3JpcHQpOwoJICAgICAgICB9OwoJICAgIH0KCgkgICAgZnVuY3Rpb24gaW5zdGFsbFNldFRpbWVvdXRJbXBsZW1lbnRhdGlvbigpIHsKCSAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHsKCSAgICAgICAgICAgIHNldFRpbWVvdXQocnVuSWZQcmVzZW50LCAwLCBoYW5kbGUpOwoJICAgICAgICB9OwoJICAgIH0KCgkgICAgLy8gSWYgc3VwcG9ydGVkLCB3ZSBzaG91bGQgYXR0YWNoIHRvIHRoZSBwcm90b3R5cGUgb2YgZ2xvYmFsLCBzaW5jZSB0aGF0IGlzIHdoZXJlIHNldFRpbWVvdXQgZXQgYWwuIGxpdmUuCgkgICAgdmFyIGF0dGFjaFRvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mICYmIE9iamVjdC5nZXRQcm90b3R5cGVPZihnbG9iYWwpOwoJICAgIGF0dGFjaFRvID0gYXR0YWNoVG8gJiYgYXR0YWNoVG8uc2V0VGltZW91dCA/IGF0dGFjaFRvIDogZ2xvYmFsOwoKCSAgICAvLyBEb24ndCBnZXQgZm9vbGVkIGJ5IGUuZy4gYnJvd3NlcmlmeSBlbnZpcm9ubWVudHMuCgkgICAgaWYgKHt9LnRvU3RyaW5nLmNhbGwoZ2xvYmFsLnByb2Nlc3MpID09PSAiW29iamVjdCBwcm9jZXNzXSIpIHsKCSAgICAgICAgLy8gRm9yIE5vZGUuanMgYmVmb3JlIDAuOQoJICAgICAgICBpbnN0YWxsTmV4dFRpY2tJbXBsZW1lbnRhdGlvbigpOwoKCSAgICB9IGVsc2UgaWYgKGNhblVzZVBvc3RNZXNzYWdlKCkpIHsKCSAgICAgICAgLy8gRm9yIG5vbi1JRTEwIG1vZGVybiBicm93c2VycwoJICAgICAgICBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpOwoKCSAgICB9IGVsc2UgaWYgKGdsb2JhbC5NZXNzYWdlQ2hhbm5lbCkgewoJICAgICAgICAvLyBGb3Igd2ViIHdvcmtlcnMsIHdoZXJlIHN1cHBvcnRlZAoJICAgICAgICBpbnN0YWxsTWVzc2FnZUNoYW5uZWxJbXBsZW1lbnRhdGlvbigpOwoKCSAgICB9IGVsc2UgaWYgKGRvYyAmJiAib25yZWFkeXN0YXRlY2hhbmdlIiBpbiBkb2MuY3JlYXRlRWxlbWVudCgic2NyaXB0IikpIHsKCSAgICAgICAgLy8gRm9yIElFIDbigJM4CgkgICAgICAgIGluc3RhbGxSZWFkeVN0YXRlQ2hhbmdlSW1wbGVtZW50YXRpb24oKTsKCgkgICAgfSBlbHNlIHsKCSAgICAgICAgLy8gRm9yIG9sZGVyIGJyb3dzZXJzCgkgICAgICAgIGluc3RhbGxTZXRUaW1lb3V0SW1wbGVtZW50YXRpb24oKTsKCSAgICB9CgoJICAgIGF0dGFjaFRvLnNldEltbWVkaWF0ZSA9IHNldEltbWVkaWF0ZTsKCSAgICBhdHRhY2hUby5jbGVhckltbWVkaWF0ZSA9IGNsZWFySW1tZWRpYXRlOwoJfSh0eXBlb2Ygc2VsZiA9PT0gInVuZGVmaW5lZCIgPyB0eXBlb2YgZ2xvYmFsID09PSAidW5kZWZpbmVkIiA/IHRoaXMgOiBnbG9iYWwgOiBzZWxmKSk7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSksIF9fd2VicGFja19yZXF1aXJlX18oMTIpKSkKCi8qKiovIH0sCi8qIDIzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihwcm9jZXNzKSB7J3VzZSBzdHJpY3QnOwoKCWlmICghcHJvY2Vzcy52ZXJzaW9uIHx8CgkgICAgcHJvY2Vzcy52ZXJzaW9uLmluZGV4T2YoJ3YwLicpID09PSAwIHx8CgkgICAgcHJvY2Vzcy52ZXJzaW9uLmluZGV4T2YoJ3YxLicpID09PSAwICYmIHByb2Nlc3MudmVyc2lvbi5pbmRleE9mKCd2MS44LicpICE9PSAwKSB7CgkgIG1vZHVsZS5leHBvcnRzID0gbmV4dFRpY2s7Cgl9IGVsc2UgewoJICBtb2R1bGUuZXhwb3J0cyA9IHByb2Nlc3MubmV4dFRpY2s7Cgl9CgoJZnVuY3Rpb24gbmV4dFRpY2soZm4sIGFyZzEsIGFyZzIsIGFyZzMpIHsKCSAgaWYgKHR5cGVvZiBmbiAhPT0gJ2Z1bmN0aW9uJykgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyJjYWxsYmFjayIgYXJndW1lbnQgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7CgkgIH0KCSAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7CgkgIHZhciBhcmdzLCBpOwoJICBzd2l0Y2ggKGxlbikgewoJICBjYXNlIDA6CgkgIGNhc2UgMToKCSAgICByZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmbik7CgkgIGNhc2UgMjoKCSAgICByZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiBhZnRlclRpY2tPbmUoKSB7CgkgICAgICBmbi5jYWxsKG51bGwsIGFyZzEpOwoJICAgIH0pOwoJICBjYXNlIDM6CgkgICAgcmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gYWZ0ZXJUaWNrVHdvKCkgewoJICAgICAgZm4uY2FsbChudWxsLCBhcmcxLCBhcmcyKTsKCSAgICB9KTsKCSAgY2FzZSA0OgoJICAgIHJldHVybiBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uIGFmdGVyVGlja1RocmVlKCkgewoJICAgICAgZm4uY2FsbChudWxsLCBhcmcxLCBhcmcyLCBhcmczKTsKCSAgICB9KTsKCSAgZGVmYXVsdDoKCSAgICBhcmdzID0gbmV3IEFycmF5KGxlbiAtIDEpOwoJICAgIGkgPSAwOwoJICAgIHdoaWxlIChpIDwgYXJncy5sZW5ndGgpIHsKCSAgICAgIGFyZ3NbaSsrXSA9IGFyZ3VtZW50c1tpXTsKCSAgICB9CgkgICAgcmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gYWZ0ZXJUaWNrKCkgewoJICAgICAgZm4uYXBwbHkobnVsbCwgYXJncyk7CgkgICAgfSk7CgkgIH0KCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygxMikpKQoKLyoqKi8gfSwKLyogMjQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKEJ1ZmZlcikgey8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLgoJLy8KCS8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCgkvLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCgkvLyAiU29mdHdhcmUiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nCgkvLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCgkvLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0CgkvLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUKCS8vIGZvbGxvd2luZyBjb25kaXRpb25zOgoJLy8KCS8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkCgkvLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCS8vCgkvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUwoJLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgoJLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTgoJLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sCgkvLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKCS8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUKCS8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCgoJLy8gTk9URTogVGhlc2UgdHlwZSBjaGVja2luZyBmdW5jdGlvbnMgaW50ZW50aW9uYWxseSBkb24ndCB1c2UgYGluc3RhbmNlb2ZgCgkvLyBiZWNhdXNlIGl0IGlzIGZyYWdpbGUgYW5kIGNhbiBiZSBlYXNpbHkgZmFrZWQgd2l0aCBgT2JqZWN0LmNyZWF0ZSgpYC4KCglmdW5jdGlvbiBpc0FycmF5KGFyZykgewoJICBpZiAoQXJyYXkuaXNBcnJheSkgewoJICAgIHJldHVybiBBcnJheS5pc0FycmF5KGFyZyk7CgkgIH0KCSAgcmV0dXJuIG9iamVjdFRvU3RyaW5nKGFyZykgPT09ICdbb2JqZWN0IEFycmF5XSc7Cgl9CglleHBvcnRzLmlzQXJyYXkgPSBpc0FycmF5OwoKCWZ1bmN0aW9uIGlzQm9vbGVhbihhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdib29sZWFuJzsKCX0KCWV4cG9ydHMuaXNCb29sZWFuID0gaXNCb29sZWFuOwoKCWZ1bmN0aW9uIGlzTnVsbChhcmcpIHsKCSAgcmV0dXJuIGFyZyA9PT0gbnVsbDsKCX0KCWV4cG9ydHMuaXNOdWxsID0gaXNOdWxsOwoKCWZ1bmN0aW9uIGlzTnVsbE9yVW5kZWZpbmVkKGFyZykgewoJICByZXR1cm4gYXJnID09IG51bGw7Cgl9CglleHBvcnRzLmlzTnVsbE9yVW5kZWZpbmVkID0gaXNOdWxsT3JVbmRlZmluZWQ7CgoJZnVuY3Rpb24gaXNOdW1iZXIoYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnbnVtYmVyJzsKCX0KCWV4cG9ydHMuaXNOdW1iZXIgPSBpc051bWJlcjsKCglmdW5jdGlvbiBpc1N0cmluZyhhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnOwoJfQoJZXhwb3J0cy5pc1N0cmluZyA9IGlzU3RyaW5nOwoKCWZ1bmN0aW9uIGlzU3ltYm9sKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ3N5bWJvbCc7Cgl9CglleHBvcnRzLmlzU3ltYm9sID0gaXNTeW1ib2w7CgoJZnVuY3Rpb24gaXNVbmRlZmluZWQoYXJnKSB7CgkgIHJldHVybiBhcmcgPT09IHZvaWQgMDsKCX0KCWV4cG9ydHMuaXNVbmRlZmluZWQgPSBpc1VuZGVmaW5lZDsKCglmdW5jdGlvbiBpc1JlZ0V4cChyZSkgewoJICByZXR1cm4gb2JqZWN0VG9TdHJpbmcocmUpID09PSAnW29iamVjdCBSZWdFeHBdJzsKCX0KCWV4cG9ydHMuaXNSZWdFeHAgPSBpc1JlZ0V4cDsKCglmdW5jdGlvbiBpc09iamVjdChhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdvYmplY3QnICYmIGFyZyAhPT0gbnVsbDsKCX0KCWV4cG9ydHMuaXNPYmplY3QgPSBpc09iamVjdDsKCglmdW5jdGlvbiBpc0RhdGUoZCkgewoJICByZXR1cm4gb2JqZWN0VG9TdHJpbmcoZCkgPT09ICdbb2JqZWN0IERhdGVdJzsKCX0KCWV4cG9ydHMuaXNEYXRlID0gaXNEYXRlOwoKCWZ1bmN0aW9uIGlzRXJyb3IoZSkgewoJICByZXR1cm4gKG9iamVjdFRvU3RyaW5nKGUpID09PSAnW29iamVjdCBFcnJvcl0nIHx8IGUgaW5zdGFuY2VvZiBFcnJvcik7Cgl9CglleHBvcnRzLmlzRXJyb3IgPSBpc0Vycm9yOwoKCWZ1bmN0aW9uIGlzRnVuY3Rpb24oYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnZnVuY3Rpb24nOwoJfQoJZXhwb3J0cy5pc0Z1bmN0aW9uID0gaXNGdW5jdGlvbjsKCglmdW5jdGlvbiBpc1ByaW1pdGl2ZShhcmcpIHsKCSAgcmV0dXJuIGFyZyA9PT0gbnVsbCB8fAoJICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ2Jvb2xlYW4nIHx8CgkgICAgICAgICB0eXBlb2YgYXJnID09PSAnbnVtYmVyJyB8fAoJICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ3N0cmluZycgfHwKCSAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdzeW1ib2wnIHx8ICAvLyBFUzYgc3ltYm9sCgkgICAgICAgICB0eXBlb2YgYXJnID09PSAndW5kZWZpbmVkJzsKCX0KCWV4cG9ydHMuaXNQcmltaXRpdmUgPSBpc1ByaW1pdGl2ZTsKCglleHBvcnRzLmlzQnVmZmVyID0gQnVmZmVyLmlzQnVmZmVyOwoKCWZ1bmN0aW9uIG9iamVjdFRvU3RyaW5nKG8pIHsKCSAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKTsKCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg4KS5CdWZmZXIpKQoKLyoqKi8gfSwKLyogMjUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCkgewoJLyoqCgkgKiBNb2R1bGUgZXhwb3J0cy4KCSAqLwoKCW1vZHVsZS5leHBvcnRzID0gZGVwcmVjYXRlOwoKCS8qKgoJICogTWFyayB0aGF0IGEgbWV0aG9kIHNob3VsZCBub3QgYmUgdXNlZC4KCSAqIFJldHVybnMgYSBtb2RpZmllZCBmdW5jdGlvbiB3aGljaCB3YXJucyBvbmNlIGJ5IGRlZmF1bHQuCgkgKgoJICogSWYgYGxvY2FsU3RvcmFnZS5ub0RlcHJlY2F0aW9uID0gdHJ1ZWAgaXMgc2V0LCB0aGVuIGl0IGlzIGEgbm8tb3AuCgkgKgoJICogSWYgYGxvY2FsU3RvcmFnZS50aHJvd0RlcHJlY2F0aW9uID0gdHJ1ZWAgaXMgc2V0LCB0aGVuIGRlcHJlY2F0ZWQgZnVuY3Rpb25zCgkgKiB3aWxsIHRocm93IGFuIEVycm9yIHdoZW4gaW52b2tlZC4KCSAqCgkgKiBJZiBgbG9jYWxTdG9yYWdlLnRyYWNlRGVwcmVjYXRpb24gPSB0cnVlYCBpcyBzZXQsIHRoZW4gZGVwcmVjYXRlZCBmdW5jdGlvbnMKCSAqIHdpbGwgaW52b2tlIGBjb25zb2xlLnRyYWNlKClgIGluc3RlYWQgb2YgYGNvbnNvbGUuZXJyb3IoKWAuCgkgKgoJICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gLSB0aGUgZnVuY3Rpb24gdG8gZGVwcmVjYXRlCgkgKiBAcGFyYW0ge1N0cmluZ30gbXNnIC0gdGhlIHN0cmluZyB0byBwcmludCB0byB0aGUgY29uc29sZSB3aGVuIGBmbmAgaXMgaW52b2tlZAoJICogQHJldHVybnMge0Z1bmN0aW9ufSBhIG5ldyAiZGVwcmVjYXRlZCIgdmVyc2lvbiBvZiBgZm5gCgkgKiBAYXBpIHB1YmxpYwoJICovCgoJZnVuY3Rpb24gZGVwcmVjYXRlIChmbiwgbXNnKSB7CgkgIGlmIChjb25maWcoJ25vRGVwcmVjYXRpb24nKSkgewoJICAgIHJldHVybiBmbjsKCSAgfQoKCSAgdmFyIHdhcm5lZCA9IGZhbHNlOwoJICBmdW5jdGlvbiBkZXByZWNhdGVkKCkgewoJICAgIGlmICghd2FybmVkKSB7CgkgICAgICBpZiAoY29uZmlnKCd0aHJvd0RlcHJlY2F0aW9uJykpIHsKCSAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7CgkgICAgICB9IGVsc2UgaWYgKGNvbmZpZygndHJhY2VEZXByZWNhdGlvbicpKSB7CgkgICAgICAgIGNvbnNvbGUudHJhY2UobXNnKTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGNvbnNvbGUud2Fybihtc2cpOwoJICAgICAgfQoJICAgICAgd2FybmVkID0gdHJ1ZTsKCSAgICB9CgkgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgkgIH0KCgkgIHJldHVybiBkZXByZWNhdGVkOwoJfQoKCS8qKgoJICogQ2hlY2tzIGBsb2NhbFN0b3JhZ2VgIGZvciBib29sZWFuIHZhbHVlcyBmb3IgdGhlIGdpdmVuIGBuYW1lYC4KCSAqCgkgKiBAcGFyYW0ge1N0cmluZ30gbmFtZQoJICogQHJldHVybnMge0Jvb2xlYW59CgkgKiBAYXBpIHByaXZhdGUKCSAqLwoKCWZ1bmN0aW9uIGNvbmZpZyAobmFtZSkgewoJICAvLyBhY2Nlc3NpbmcgZ2xvYmFsLmxvY2FsU3RvcmFnZSBjYW4gdHJpZ2dlciBhIERPTUV4Y2VwdGlvbiBpbiBzYW5kYm94ZWQgaWZyYW1lcwoJICB0cnkgewoJICAgIGlmICghZ2xvYmFsLmxvY2FsU3RvcmFnZSkgcmV0dXJuIGZhbHNlOwoJICB9IGNhdGNoIChfKSB7CgkgICAgcmV0dXJuIGZhbHNlOwoJICB9CgkgIHZhciB2YWwgPSBnbG9iYWwubG9jYWxTdG9yYWdlW25hbWVdOwoJICBpZiAobnVsbCA9PSB2YWwpIHJldHVybiBmYWxzZTsKCSAgcmV0dXJuIFN0cmluZyh2YWwpLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJzsKCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpCgovKioqLyB9LAovKiAyNiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oQnVmZmVyKSB7LyohCgkgKiBUaGUgYnVmZmVyIG1vZHVsZSBmcm9tIG5vZGUuanMsIGZvciB0aGUgYnJvd3Nlci4KCSAqCgkgKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8ZmVyb3NzQGZlcm9zcy5vcmc+IDxodHRwOi8vZmVyb3NzLm9yZz4KCSAqIEBsaWNlbnNlICBNSVQKCSAqLwoJLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi8KCgkndXNlIHN0cmljdCcKCgl2YXIgYmFzZTY0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KQoJdmFyIGllZWU3NTQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKQoKCWV4cG9ydHMuQnVmZmVyID0gQnVmZmVyCglleHBvcnRzLlNsb3dCdWZmZXIgPSBTbG93QnVmZmVyCglleHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTID0gNTAKCgl2YXIgS19NQVhfTEVOR1RIID0gMHg3ZmZmZmZmZgoJZXhwb3J0cy5rTWF4TGVuZ3RoID0gS19NQVhfTEVOR1RICgoJLyoqCgkgKiBJZiBgQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRgOgoJICogICA9PT0gdHJ1ZSAgICBVc2UgVWludDhBcnJheSBpbXBsZW1lbnRhdGlvbiAoZmFzdGVzdCkKCSAqICAgPT09IGZhbHNlICAgUHJpbnQgd2FybmluZyBhbmQgcmVjb21tZW5kIHVzaW5nIGBidWZmZXJgIHY0Lnggd2hpY2ggaGFzIGFuIE9iamVjdAoJICogICAgICAgICAgICAgICBpbXBsZW1lbnRhdGlvbiAobW9zdCBjb21wYXRpYmxlLCBldmVuIElFNikKCSAqCgkgKiBCcm93c2VycyB0aGF0IHN1cHBvcnQgdHlwZWQgYXJyYXlzIGFyZSBJRSAxMCssIEZpcmVmb3ggNCssIENocm9tZSA3KywgU2FmYXJpIDUuMSssCgkgKiBPcGVyYSAxMS42KywgaU9TIDQuMisuCgkgKgoJICogV2UgcmVwb3J0IHRoYXQgdGhlIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCB0eXBlZCBhcnJheXMgaWYgdGhlIGFyZSBub3Qgc3ViY2xhc3NhYmxlCgkgKiB1c2luZyBfX3Byb3RvX18uIEZpcmVmb3ggNC0yOSBsYWNrcyBzdXBwb3J0IGZvciBhZGRpbmcgbmV3IHByb3BlcnRpZXMgdG8gYFVpbnQ4QXJyYXlgCgkgKiAoU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02OTU0MzgpLiBJRSAxMCBsYWNrcyBzdXBwb3J0CgkgKiBmb3IgX19wcm90b19fIGFuZCBoYXMgYSBidWdneSB0eXBlZCBhcnJheSBpbXBsZW1lbnRhdGlvbi4KCSAqLwoJQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgPSB0eXBlZEFycmF5U3VwcG9ydCgpCgoJaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCAmJiB0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcgJiYKCSAgICB0eXBlb2YgY29uc29sZS5lcnJvciA9PT0gJ2Z1bmN0aW9uJykgewoJICBjb25zb2xlLmVycm9yKAoJICAgICdUaGlzIGJyb3dzZXIgbGFja3MgdHlwZWQgYXJyYXkgKFVpbnQ4QXJyYXkpIHN1cHBvcnQgd2hpY2ggaXMgcmVxdWlyZWQgYnkgJyArCgkgICAgJ2BidWZmZXJgIHY1LnguIFVzZSBgYnVmZmVyYCB2NC54IGlmIHlvdSByZXF1aXJlIG9sZCBicm93c2VyIHN1cHBvcnQuJwoJICApCgl9CgoJZnVuY3Rpb24gdHlwZWRBcnJheVN1cHBvcnQgKCkgewoJICAvLyBDYW4gdHlwZWQgYXJyYXkgaW5zdGFuY2VzIGNhbiBiZSBhdWdtZW50ZWQ/CgkgIHRyeSB7CgkgICAgdmFyIGFyciA9IG5ldyBVaW50OEFycmF5KDEpCgkgICAgYXJyLl9fcHJvdG9fXyA9IHtfX3Byb3RvX186IFVpbnQ4QXJyYXkucHJvdG90eXBlLCBmb286IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDQyIH19CgkgICAgcmV0dXJuIGFyci5mb28oKSA9PT0gNDIKCSAgfSBjYXRjaCAoZSkgewoJICAgIHJldHVybiBmYWxzZQoJICB9Cgl9CgoJZnVuY3Rpb24gY3JlYXRlQnVmZmVyIChsZW5ndGgpIHsKCSAgaWYgKGxlbmd0aCA+IEtfTUFYX0xFTkdUSCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHR5cGVkIGFycmF5IGxlbmd0aCcpCgkgIH0KCSAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UKCSAgdmFyIGJ1ZiA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCkKCSAgYnVmLl9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGUKCSAgcmV0dXJuIGJ1ZgoJfQoKCS8qKgoJICogVGhlIEJ1ZmZlciBjb25zdHJ1Y3RvciByZXR1cm5zIGluc3RhbmNlcyBvZiBgVWludDhBcnJheWAgdGhhdCBoYXZlIHRoZWlyCgkgKiBwcm90b3R5cGUgY2hhbmdlZCB0byBgQnVmZmVyLnByb3RvdHlwZWAuIEZ1cnRoZXJtb3JlLCBgQnVmZmVyYCBpcyBhIHN1YmNsYXNzIG9mCgkgKiBgVWludDhBcnJheWAsIHNvIHRoZSByZXR1cm5lZCBpbnN0YW5jZXMgd2lsbCBoYXZlIGFsbCB0aGUgbm9kZSBgQnVmZmVyYCBtZXRob2RzCgkgKiBhbmQgdGhlIGBVaW50OEFycmF5YCBtZXRob2RzLiBTcXVhcmUgYnJhY2tldCBub3RhdGlvbiB3b3JrcyBhcyBleHBlY3RlZCAtLSBpdAoJICogcmV0dXJucyBhIHNpbmdsZSBvY3RldC4KCSAqCgkgKiBUaGUgYFVpbnQ4QXJyYXlgIHByb3RvdHlwZSByZW1haW5zIHVubW9kaWZpZWQuCgkgKi8KCglmdW5jdGlvbiBCdWZmZXIgKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7CgkgIC8vIENvbW1vbiBjYXNlLgoJICBpZiAodHlwZW9mIGFyZyA9PT0gJ251bWJlcicpIHsKCSAgICBpZiAodHlwZW9mIGVuY29kaW5nT3JPZmZzZXQgPT09ICdzdHJpbmcnKSB7CgkgICAgICB0aHJvdyBuZXcgRXJyb3IoCgkgICAgICAgICdJZiBlbmNvZGluZyBpcyBzcGVjaWZpZWQgdGhlbiB0aGUgZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZycKCSAgICAgICkKCSAgICB9CgkgICAgcmV0dXJuIGFsbG9jVW5zYWZlKGFyZykKCSAgfQoJICByZXR1cm4gZnJvbShhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkKCX0KCgkvLyBGaXggc3ViYXJyYXkoKSBpbiBFUzIwMTYuIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2Zlcm9zcy9idWZmZXIvcHVsbC85NwoJaWYgKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC5zcGVjaWVzICYmCgkgICAgQnVmZmVyW1N5bWJvbC5zcGVjaWVzXSA9PT0gQnVmZmVyKSB7CgkgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWZmZXIsIFN5bWJvbC5zcGVjaWVzLCB7CgkgICAgdmFsdWU6IG51bGwsCgkgICAgY29uZmlndXJhYmxlOiB0cnVlLAoJICAgIGVudW1lcmFibGU6IGZhbHNlLAoJICAgIHdyaXRhYmxlOiBmYWxzZQoJICB9KQoJfQoKCUJ1ZmZlci5wb29sU2l6ZSA9IDgxOTIgLy8gbm90IHVzZWQgYnkgdGhpcyBpbXBsZW1lbnRhdGlvbgoKCWZ1bmN0aW9uIGZyb20gKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHsKCSAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcidmFsdWUiIGFyZ3VtZW50IG11c3Qgbm90IGJlIGEgbnVtYmVyJykKCSAgfQoKCSAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsKCSAgICByZXR1cm4gZnJvbUFycmF5QnVmZmVyKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpCgkgIH0KCgkgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7CgkgICAgcmV0dXJuIGZyb21TdHJpbmcodmFsdWUsIGVuY29kaW5nT3JPZmZzZXQpCgkgIH0KCgkgIHJldHVybiBmcm9tT2JqZWN0KHZhbHVlKQoJfQoKCS8qKgoJICogRnVuY3Rpb25hbGx5IGVxdWl2YWxlbnQgdG8gQnVmZmVyKGFyZywgZW5jb2RpbmcpIGJ1dCB0aHJvd3MgYSBUeXBlRXJyb3IKCSAqIGlmIHZhbHVlIGlzIGEgbnVtYmVyLgoJICogQnVmZmVyLmZyb20oc3RyWywgZW5jb2RpbmddKQoJICogQnVmZmVyLmZyb20oYXJyYXkpCgkgKiBCdWZmZXIuZnJvbShidWZmZXIpCgkgKiBCdWZmZXIuZnJvbShhcnJheUJ1ZmZlclssIGJ5dGVPZmZzZXRbLCBsZW5ndGhdXSkKCSAqKi8KCUJ1ZmZlci5mcm9tID0gZnVuY3Rpb24gKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHsKCSAgcmV0dXJuIGZyb20odmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkKCX0KCgkvLyBOb3RlOiBDaGFuZ2UgcHJvdG90eXBlICphZnRlciogQnVmZmVyLmZyb20gaXMgZGVmaW5lZCB0byB3b3JrYXJvdW5kIENocm9tZSBidWc6CgkvLyBodHRwczovL2dpdGh1Yi5jb20vZmVyb3NzL2J1ZmZlci9wdWxsLzE0OAoJQnVmZmVyLnByb3RvdHlwZS5fX3Byb3RvX18gPSBVaW50OEFycmF5LnByb3RvdHlwZQoJQnVmZmVyLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXkKCglmdW5jdGlvbiBhc3NlcnRTaXplIChzaXplKSB7CgkgIGlmICh0eXBlb2Ygc2l6ZSAhPT0gJ251bWJlcicpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcic2l6ZSIgYXJndW1lbnQgbXVzdCBiZSBhIG51bWJlcicpCgkgIH0gZWxzZSBpZiAoc2l6ZSA8IDApIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignInNpemUiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG5lZ2F0aXZlJykKCSAgfQoJfQoKCWZ1bmN0aW9uIGFsbG9jIChzaXplLCBmaWxsLCBlbmNvZGluZykgewoJICBhc3NlcnRTaXplKHNpemUpCgkgIGlmIChzaXplIDw9IDApIHsKCSAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHNpemUpCgkgIH0KCSAgaWYgKGZpbGwgIT09IHVuZGVmaW5lZCkgewoJICAgIC8vIE9ubHkgcGF5IGF0dGVudGlvbiB0byBlbmNvZGluZyBpZiBpdCdzIGEgc3RyaW5nLiBUaGlzCgkgICAgLy8gcHJldmVudHMgYWNjaWRlbnRhbGx5IHNlbmRpbmcgaW4gYSBudW1iZXIgdGhhdCB3b3VsZAoJICAgIC8vIGJlIGludGVycHJldHRlZCBhcyBhIHN0YXJ0IG9mZnNldC4KCSAgICByZXR1cm4gdHlwZW9mIGVuY29kaW5nID09PSAnc3RyaW5nJwoJICAgICAgPyBjcmVhdGVCdWZmZXIoc2l6ZSkuZmlsbChmaWxsLCBlbmNvZGluZykKCSAgICAgIDogY3JlYXRlQnVmZmVyKHNpemUpLmZpbGwoZmlsbCkKCSAgfQoJICByZXR1cm4gY3JlYXRlQnVmZmVyKHNpemUpCgl9CgoJLyoqCgkgKiBDcmVhdGVzIGEgbmV3IGZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuCgkgKiBhbGxvYyhzaXplWywgZmlsbFssIGVuY29kaW5nXV0pCgkgKiovCglCdWZmZXIuYWxsb2MgPSBmdW5jdGlvbiAoc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHsKCSAgcmV0dXJuIGFsbG9jKHNpemUsIGZpbGwsIGVuY29kaW5nKQoJfQoKCWZ1bmN0aW9uIGFsbG9jVW5zYWZlIChzaXplKSB7CgkgIGFzc2VydFNpemUoc2l6ZSkKCSAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcihzaXplIDwgMCA/IDAgOiBjaGVja2VkKHNpemUpIHwgMCkKCX0KCgkvKioKCSAqIEVxdWl2YWxlbnQgdG8gQnVmZmVyKG51bSksIGJ5IGRlZmF1bHQgY3JlYXRlcyBhIG5vbi16ZXJvLWZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuCgkgKiAqLwoJQnVmZmVyLmFsbG9jVW5zYWZlID0gZnVuY3Rpb24gKHNpemUpIHsKCSAgcmV0dXJuIGFsbG9jVW5zYWZlKHNpemUpCgl9CgkvKioKCSAqIEVxdWl2YWxlbnQgdG8gU2xvd0J1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLgoJICovCglCdWZmZXIuYWxsb2NVbnNhZmVTbG93ID0gZnVuY3Rpb24gKHNpemUpIHsKCSAgcmV0dXJuIGFsbG9jVW5zYWZlKHNpemUpCgl9CgoJZnVuY3Rpb24gZnJvbVN0cmluZyAoc3RyaW5nLCBlbmNvZGluZykgewoJICBpZiAodHlwZW9mIGVuY29kaW5nICE9PSAnc3RyaW5nJyB8fCBlbmNvZGluZyA9PT0gJycpIHsKCSAgICBlbmNvZGluZyA9ICd1dGY4JwoJICB9CgoJICBpZiAoIUJ1ZmZlci5pc0VuY29kaW5nKGVuY29kaW5nKSkgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyJlbmNvZGluZyIgbXVzdCBiZSBhIHZhbGlkIHN0cmluZyBlbmNvZGluZycpCgkgIH0KCgkgIHZhciBsZW5ndGggPSBieXRlTGVuZ3RoKHN0cmluZywgZW5jb2RpbmcpIHwgMAoJICB2YXIgYnVmID0gY3JlYXRlQnVmZmVyKGxlbmd0aCkKCgkgIHZhciBhY3R1YWwgPSBidWYud3JpdGUoc3RyaW5nLCBlbmNvZGluZykKCgkgIGlmIChhY3R1YWwgIT09IGxlbmd0aCkgewoJICAgIC8vIFdyaXRpbmcgYSBoZXggc3RyaW5nLCBmb3IgZXhhbXBsZSwgdGhhdCBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMgd2lsbAoJICAgIC8vIGNhdXNlIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGZpcnN0IGludmFsaWQgY2hhcmFjdGVyIHRvIGJlIGlnbm9yZWQuIChlLmcuCgkgICAgLy8gJ2FieHhjZCcgd2lsbCBiZSB0cmVhdGVkIGFzICdhYicpCgkgICAgYnVmID0gYnVmLnNsaWNlKDAsIGFjdHVhbCkKCSAgfQoKCSAgcmV0dXJuIGJ1ZgoJfQoKCWZ1bmN0aW9uIGZyb21BcnJheUxpa2UgKGFycmF5KSB7CgkgIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGggPCAwID8gMCA6IGNoZWNrZWQoYXJyYXkubGVuZ3RoKSB8IDAKCSAgdmFyIGJ1ZiA9IGNyZWF0ZUJ1ZmZlcihsZW5ndGgpCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHsKCSAgICBidWZbaV0gPSBhcnJheVtpXSAmIDI1NQoJICB9CgkgIHJldHVybiBidWYKCX0KCglmdW5jdGlvbiBmcm9tQXJyYXlCdWZmZXIgKGFycmF5LCBieXRlT2Zmc2V0LCBsZW5ndGgpIHsKCSAgaWYgKGJ5dGVPZmZzZXQgPCAwIHx8IGFycmF5LmJ5dGVMZW5ndGggPCBieXRlT2Zmc2V0KSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wnb2Zmc2V0XCcgaXMgb3V0IG9mIGJvdW5kcycpCgkgIH0KCgkgIGlmIChhcnJheS5ieXRlTGVuZ3RoIDwgYnl0ZU9mZnNldCArIChsZW5ndGggfHwgMCkpIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXCdsZW5ndGhcJyBpcyBvdXQgb2YgYm91bmRzJykKCSAgfQoKCSAgdmFyIGJ1ZgoJICBpZiAoYnl0ZU9mZnNldCA9PT0gdW5kZWZpbmVkICYmIGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgYnVmID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXkpCgkgIH0gZWxzZSBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIHsKCSAgICBidWYgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldCkKCSAgfSBlbHNlIHsKCSAgICBidWYgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKQoJICB9CgoJICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZQoJICBidWYuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZQoJICByZXR1cm4gYnVmCgl9CgoJZnVuY3Rpb24gZnJvbU9iamVjdCAob2JqKSB7CgkgIGlmIChCdWZmZXIuaXNCdWZmZXIob2JqKSkgewoJICAgIHZhciBsZW4gPSBjaGVja2VkKG9iai5sZW5ndGgpIHwgMAoJICAgIHZhciBidWYgPSBjcmVhdGVCdWZmZXIobGVuKQoKCSAgICBpZiAoYnVmLmxlbmd0aCA9PT0gMCkgewoJICAgICAgcmV0dXJuIGJ1ZgoJICAgIH0KCgkgICAgb2JqLmNvcHkoYnVmLCAwLCAwLCBsZW4pCgkgICAgcmV0dXJuIGJ1ZgoJICB9CgoJICBpZiAob2JqKSB7CgkgICAgaWYgKEFycmF5QnVmZmVyLmlzVmlldyhvYmopIHx8ICdsZW5ndGgnIGluIG9iaikgewoJICAgICAgaWYgKHR5cGVvZiBvYmoubGVuZ3RoICE9PSAnbnVtYmVyJyB8fCBpc25hbihvYmoubGVuZ3RoKSkgewoJICAgICAgICByZXR1cm4gY3JlYXRlQnVmZmVyKDApCgkgICAgICB9CgkgICAgICByZXR1cm4gZnJvbUFycmF5TGlrZShvYmopCgkgICAgfQoKCSAgICBpZiAob2JqLnR5cGUgPT09ICdCdWZmZXInICYmIEFycmF5LmlzQXJyYXkob2JqLmRhdGEpKSB7CgkgICAgICByZXR1cm4gZnJvbUFycmF5TGlrZShvYmouZGF0YSkKCSAgICB9CgkgIH0KCgkgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgQXJyYXlCdWZmZXIsIEFycmF5LCBvciBhcnJheS1saWtlIG9iamVjdC4nKQoJfQoKCWZ1bmN0aW9uIGNoZWNrZWQgKGxlbmd0aCkgewoJICAvLyBOb3RlOiBjYW5ub3QgdXNlIGBsZW5ndGggPCBLX01BWF9MRU5HVEhgIGhlcmUgYmVjYXVzZSB0aGF0IGZhaWxzIHdoZW4KCSAgLy8gbGVuZ3RoIGlzIE5hTiAod2hpY2ggaXMgb3RoZXJ3aXNlIGNvZXJjZWQgdG8gemVyby4pCgkgIGlmIChsZW5ndGggPj0gS19NQVhfTEVOR1RIKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gYWxsb2NhdGUgQnVmZmVyIGxhcmdlciB0aGFuIG1heGltdW0gJyArCgkgICAgICAgICAgICAgICAgICAgICAgICAgJ3NpemU6IDB4JyArIEtfTUFYX0xFTkdUSC50b1N0cmluZygxNikgKyAnIGJ5dGVzJykKCSAgfQoJICByZXR1cm4gbGVuZ3RoIHwgMAoJfQoKCWZ1bmN0aW9uIFNsb3dCdWZmZXIgKGxlbmd0aCkgewoJICBpZiAoK2xlbmd0aCAhPSBsZW5ndGgpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBlcWVxZXEKCSAgICBsZW5ndGggPSAwCgkgIH0KCSAgcmV0dXJuIEJ1ZmZlci5hbGxvYygrbGVuZ3RoKQoJfQoKCUJ1ZmZlci5pc0J1ZmZlciA9IGZ1bmN0aW9uIGlzQnVmZmVyIChiKSB7CgkgIHJldHVybiBiICE9IG51bGwgJiYgYi5faXNCdWZmZXIgPT09IHRydWUKCX0KCglCdWZmZXIuY29tcGFyZSA9IGZ1bmN0aW9uIGNvbXBhcmUgKGEsIGIpIHsKCSAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYSkgfHwgIUJ1ZmZlci5pc0J1ZmZlcihiKSkgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50cyBtdXN0IGJlIEJ1ZmZlcnMnKQoJICB9CgoJICBpZiAoYSA9PT0gYikgcmV0dXJuIDAKCgkgIHZhciB4ID0gYS5sZW5ndGgKCSAgdmFyIHkgPSBiLmxlbmd0aAoKCSAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IE1hdGgubWluKHgsIHkpOyBpIDwgbGVuOyArK2kpIHsKCSAgICBpZiAoYVtpXSAhPT0gYltpXSkgewoJICAgICAgeCA9IGFbaV0KCSAgICAgIHkgPSBiW2ldCgkgICAgICBicmVhawoJICAgIH0KCSAgfQoKCSAgaWYgKHggPCB5KSByZXR1cm4gLTEKCSAgaWYgKHkgPCB4KSByZXR1cm4gMQoJICByZXR1cm4gMAoJfQoKCUJ1ZmZlci5pc0VuY29kaW5nID0gZnVuY3Rpb24gaXNFbmNvZGluZyAoZW5jb2RpbmcpIHsKCSAgc3dpdGNoIChTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkpIHsKCSAgICBjYXNlICdoZXgnOgoJICAgIGNhc2UgJ3V0ZjgnOgoJICAgIGNhc2UgJ3V0Zi04JzoKCSAgICBjYXNlICdhc2NpaSc6CgkgICAgY2FzZSAnbGF0aW4xJzoKCSAgICBjYXNlICdiaW5hcnknOgoJICAgIGNhc2UgJ2Jhc2U2NCc6CgkgICAgY2FzZSAndWNzMic6CgkgICAgY2FzZSAndWNzLTInOgoJICAgIGNhc2UgJ3V0ZjE2bGUnOgoJICAgIGNhc2UgJ3V0Zi0xNmxlJzoKCSAgICAgIHJldHVybiB0cnVlCgkgICAgZGVmYXVsdDoKCSAgICAgIHJldHVybiBmYWxzZQoJICB9Cgl9CgoJQnVmZmVyLmNvbmNhdCA9IGZ1bmN0aW9uIGNvbmNhdCAobGlzdCwgbGVuZ3RoKSB7CgkgIGlmICghQXJyYXkuaXNBcnJheShsaXN0KSkgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyJsaXN0IiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKQoJICB9CgoJICBpZiAobGlzdC5sZW5ndGggPT09IDApIHsKCSAgICByZXR1cm4gQnVmZmVyLmFsbG9jKDApCgkgIH0KCgkgIHZhciBpCgkgIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkgewoJICAgIGxlbmd0aCA9IDAKCSAgICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7ICsraSkgewoJICAgICAgbGVuZ3RoICs9IGxpc3RbaV0ubGVuZ3RoCgkgICAgfQoJICB9CgoJICB2YXIgYnVmZmVyID0gQnVmZmVyLmFsbG9jVW5zYWZlKGxlbmd0aCkKCSAgdmFyIHBvcyA9IDAKCSAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyArK2kpIHsKCSAgICB2YXIgYnVmID0gbGlzdFtpXQoJICAgIGlmICghQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHsKCSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyJsaXN0IiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKQoJICAgIH0KCSAgICBidWYuY29weShidWZmZXIsIHBvcykKCSAgICBwb3MgKz0gYnVmLmxlbmd0aAoJICB9CgkgIHJldHVybiBidWZmZXIKCX0KCglmdW5jdGlvbiBieXRlTGVuZ3RoIChzdHJpbmcsIGVuY29kaW5nKSB7CgkgIGlmIChCdWZmZXIuaXNCdWZmZXIoc3RyaW5nKSkgewoJICAgIHJldHVybiBzdHJpbmcubGVuZ3RoCgkgIH0KCSAgaWYgKEFycmF5QnVmZmVyLmlzVmlldyhzdHJpbmcpIHx8IHN0cmluZyBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7CgkgICAgcmV0dXJuIHN0cmluZy5ieXRlTGVuZ3RoCgkgIH0KCSAgaWYgKHR5cGVvZiBzdHJpbmcgIT09ICdzdHJpbmcnKSB7CgkgICAgc3RyaW5nID0gJycgKyBzdHJpbmcKCSAgfQoKCSAgdmFyIGxlbiA9IHN0cmluZy5sZW5ndGgKCSAgaWYgKGxlbiA9PT0gMCkgcmV0dXJuIDAKCgkgIC8vIFVzZSBhIGZvciBsb29wIHRvIGF2b2lkIHJlY3Vyc2lvbgoJICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZQoJICBmb3IgKDs7KSB7CgkgICAgc3dpdGNoIChlbmNvZGluZykgewoJICAgICAgY2FzZSAnYXNjaWknOgoJICAgICAgY2FzZSAnbGF0aW4xJzoKCSAgICAgIGNhc2UgJ2JpbmFyeSc6CgkgICAgICAgIHJldHVybiBsZW4KCSAgICAgIGNhc2UgJ3V0ZjgnOgoJICAgICAgY2FzZSAndXRmLTgnOgoJICAgICAgY2FzZSB1bmRlZmluZWQ6CgkgICAgICAgIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aAoJICAgICAgY2FzZSAndWNzMic6CgkgICAgICBjYXNlICd1Y3MtMic6CgkgICAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIGNhc2UgJ3V0Zi0xNmxlJzoKCSAgICAgICAgcmV0dXJuIGxlbiAqIDIKCSAgICAgIGNhc2UgJ2hleCc6CgkgICAgICAgIHJldHVybiBsZW4gPj4+IDEKCSAgICAgIGNhc2UgJ2Jhc2U2NCc6CgkgICAgICAgIHJldHVybiBiYXNlNjRUb0J5dGVzKHN0cmluZykubGVuZ3RoCgkgICAgICBkZWZhdWx0OgoJICAgICAgICBpZiAobG93ZXJlZENhc2UpIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aCAvLyBhc3N1bWUgdXRmOAoJICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpCgkgICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZQoJICAgIH0KCSAgfQoJfQoJQnVmZmVyLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoCgoJZnVuY3Rpb24gc2xvd1RvU3RyaW5nIChlbmNvZGluZywgc3RhcnQsIGVuZCkgewoJICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZQoKCSAgLy8gTm8gbmVlZCB0byB2ZXJpZnkgdGhhdCAidGhpcy5sZW5ndGggPD0gTUFYX1VJTlQzMiIgc2luY2UgaXQncyBhIHJlYWQtb25seQoJICAvLyBwcm9wZXJ0eSBvZiBhIHR5cGVkIGFycmF5LgoKCSAgLy8gVGhpcyBiZWhhdmVzIG5laXRoZXIgbGlrZSBTdHJpbmcgbm9yIFVpbnQ4QXJyYXkgaW4gdGhhdCB3ZSBzZXQgc3RhcnQvZW5kCgkgIC8vIHRvIHRoZWlyIHVwcGVyL2xvd2VyIGJvdW5kcyBpZiB0aGUgdmFsdWUgcGFzc2VkIGlzIG91dCBvZiByYW5nZS4KCSAgLy8gdW5kZWZpbmVkIGlzIGhhbmRsZWQgc3BlY2lhbGx5IGFzIHBlciBFQ01BLTI2MiA2dGggRWRpdGlvbiwKCSAgLy8gU2VjdGlvbiAxMy4zLjMuNyBSdW50aW1lIFNlbWFudGljczogS2V5ZWRCaW5kaW5nSW5pdGlhbGl6YXRpb24uCgkgIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkIHx8IHN0YXJ0IDwgMCkgewoJICAgIHN0YXJ0ID0gMAoJICB9CgkgIC8vIFJldHVybiBlYXJseSBpZiBzdGFydCA+IHRoaXMubGVuZ3RoLiBEb25lIGhlcmUgdG8gcHJldmVudCBwb3RlbnRpYWwgdWludDMyCgkgIC8vIGNvZXJjaW9uIGZhaWwgYmVsb3cuCgkgIGlmIChzdGFydCA+IHRoaXMubGVuZ3RoKSB7CgkgICAgcmV0dXJuICcnCgkgIH0KCgkgIGlmIChlbmQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPiB0aGlzLmxlbmd0aCkgewoJICAgIGVuZCA9IHRoaXMubGVuZ3RoCgkgIH0KCgkgIGlmIChlbmQgPD0gMCkgewoJICAgIHJldHVybiAnJwoJICB9CgoJICAvLyBGb3JjZSBjb2Vyc2lvbiB0byB1aW50MzIuIFRoaXMgd2lsbCBhbHNvIGNvZXJjZSBmYWxzZXkvTmFOIHZhbHVlcyB0byAwLgoJICBlbmQgPj4+PSAwCgkgIHN0YXJ0ID4+Pj0gMAoKCSAgaWYgKGVuZCA8PSBzdGFydCkgewoJICAgIHJldHVybiAnJwoJICB9CgoJICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4JwoKCSAgd2hpbGUgKHRydWUpIHsKCSAgICBzd2l0Y2ggKGVuY29kaW5nKSB7CgkgICAgICBjYXNlICdoZXgnOgoJICAgICAgICByZXR1cm4gaGV4U2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICd1dGY4JzoKCSAgICAgIGNhc2UgJ3V0Zi04JzoKCSAgICAgICAgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGNhc2UgJ2FzY2lpJzoKCSAgICAgICAgcmV0dXJuIGFzY2lpU2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICdsYXRpbjEnOgoJICAgICAgY2FzZSAnYmluYXJ5JzoKCSAgICAgICAgcmV0dXJuIGxhdGluMVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgY2FzZSAnYmFzZTY0JzoKCSAgICAgICAgcmV0dXJuIGJhc2U2NFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgY2FzZSAndWNzMic6CgkgICAgICBjYXNlICd1Y3MtMic6CgkgICAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIGNhc2UgJ3V0Zi0xNmxlJzoKCSAgICAgICAgcmV0dXJuIHV0ZjE2bGVTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGRlZmF1bHQ6CgkgICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKQoJICAgICAgICBlbmNvZGluZyA9IChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpCgkgICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZQoJICAgIH0KCSAgfQoJfQoKCS8vIFRoaXMgcHJvcGVydHkgaXMgdXNlZCBieSBgQnVmZmVyLmlzQnVmZmVyYCAoYW5kIHRoZSBgaXMtYnVmZmVyYCBucG0gcGFja2FnZSkKCS8vIHRvIGRldGVjdCBhIEJ1ZmZlciBpbnN0YW5jZS4gSXQncyBub3QgcG9zc2libGUgdG8gdXNlIGBpbnN0YW5jZW9mIEJ1ZmZlcmAKCS8vIHJlbGlhYmx5IGluIGEgYnJvd3NlcmlmeSBjb250ZXh0IGJlY2F1c2UgdGhlcmUgY291bGQgYmUgbXVsdGlwbGUgZGlmZmVyZW50CgkvLyBjb3BpZXMgb2YgdGhlICdidWZmZXInIHBhY2thZ2UgaW4gdXNlLiBUaGlzIG1ldGhvZCB3b3JrcyBldmVuIGZvciBCdWZmZXIKCS8vIGluc3RhbmNlcyB0aGF0IHdlcmUgY3JlYXRlZCBmcm9tIGFub3RoZXIgY29weSBvZiB0aGUgYGJ1ZmZlcmAgcGFja2FnZS4KCS8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2Zlcm9zcy9idWZmZXIvaXNzdWVzLzE1NAoJQnVmZmVyLnByb3RvdHlwZS5faXNCdWZmZXIgPSB0cnVlCgoJZnVuY3Rpb24gc3dhcCAoYiwgbiwgbSkgewoJICB2YXIgaSA9IGJbbl0KCSAgYltuXSA9IGJbbV0KCSAgYlttXSA9IGkKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXAxNiA9IGZ1bmN0aW9uIHN3YXAxNiAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgMiAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMTYtYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDEpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXAzMiA9IGZ1bmN0aW9uIHN3YXAzMiAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgNCAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMzItYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDMpCgkgICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDIpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXA2NCA9IGZ1bmN0aW9uIHN3YXA2NCAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgOCAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNjQtYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gOCkgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDcpCgkgICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDYpCgkgICAgc3dhcCh0aGlzLCBpICsgMiwgaSArIDUpCgkgICAgc3dhcCh0aGlzLCBpICsgMywgaSArIDQpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkgewoJICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgKCSAgaWYgKGxlbmd0aCA9PT0gMCkgcmV0dXJuICcnCgkgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIDAsIGxlbmd0aCkKCSAgcmV0dXJuIHNsb3dUb1N0cmluZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiBlcXVhbHMgKGIpIHsKCSAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYikpIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKQoJICBpZiAodGhpcyA9PT0gYikgcmV0dXJuIHRydWUKCSAgcmV0dXJuIEJ1ZmZlci5jb21wYXJlKHRoaXMsIGIpID09PSAwCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5pbnNwZWN0ID0gZnVuY3Rpb24gaW5zcGVjdCAoKSB7CgkgIHZhciBzdHIgPSAnJwoJICB2YXIgbWF4ID0gZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFUwoJICBpZiAodGhpcy5sZW5ndGggPiAwKSB7CgkgICAgc3RyID0gdGhpcy50b1N0cmluZygnaGV4JywgMCwgbWF4KS5tYXRjaCgvLnsyfS9nKS5qb2luKCcgJykKCSAgICBpZiAodGhpcy5sZW5ndGggPiBtYXgpIHN0ciArPSAnIC4uLiAnCgkgIH0KCSAgcmV0dXJuICc8QnVmZmVyICcgKyBzdHIgKyAnPicKCX0KCglCdWZmZXIucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlICh0YXJnZXQsIHN0YXJ0LCBlbmQsIHRoaXNTdGFydCwgdGhpc0VuZCkgewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcih0YXJnZXQpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpCgkgIH0KCgkgIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgc3RhcnQgPSAwCgkgIH0KCSAgaWYgKGVuZCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgZW5kID0gdGFyZ2V0ID8gdGFyZ2V0Lmxlbmd0aCA6IDAKCSAgfQoJICBpZiAodGhpc1N0YXJ0ID09PSB1bmRlZmluZWQpIHsKCSAgICB0aGlzU3RhcnQgPSAwCgkgIH0KCSAgaWYgKHRoaXNFbmQgPT09IHVuZGVmaW5lZCkgewoJICAgIHRoaXNFbmQgPSB0aGlzLmxlbmd0aAoJICB9CgoJICBpZiAoc3RhcnQgPCAwIHx8IGVuZCA+IHRhcmdldC5sZW5ndGggfHwgdGhpc1N0YXJ0IDwgMCB8fCB0aGlzRW5kID4gdGhpcy5sZW5ndGgpIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignb3V0IG9mIHJhbmdlIGluZGV4JykKCSAgfQoKCSAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kICYmIHN0YXJ0ID49IGVuZCkgewoJICAgIHJldHVybiAwCgkgIH0KCSAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kKSB7CgkgICAgcmV0dXJuIC0xCgkgIH0KCSAgaWYgKHN0YXJ0ID49IGVuZCkgewoJICAgIHJldHVybiAxCgkgIH0KCgkgIHN0YXJ0ID4+Pj0gMAoJICBlbmQgPj4+PSAwCgkgIHRoaXNTdGFydCA+Pj49IDAKCSAgdGhpc0VuZCA+Pj49IDAKCgkgIGlmICh0aGlzID09PSB0YXJnZXQpIHJldHVybiAwCgoJICB2YXIgeCA9IHRoaXNFbmQgLSB0aGlzU3RhcnQKCSAgdmFyIHkgPSBlbmQgLSBzdGFydAoJICB2YXIgbGVuID0gTWF0aC5taW4oeCwgeSkKCgkgIHZhciB0aGlzQ29weSA9IHRoaXMuc2xpY2UodGhpc1N0YXJ0LCB0aGlzRW5kKQoJICB2YXIgdGFyZ2V0Q29weSA9IHRhcmdldC5zbGljZShzdGFydCwgZW5kKQoKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkgewoJICAgIGlmICh0aGlzQ29weVtpXSAhPT0gdGFyZ2V0Q29weVtpXSkgewoJICAgICAgeCA9IHRoaXNDb3B5W2ldCgkgICAgICB5ID0gdGFyZ2V0Q29weVtpXQoJICAgICAgYnJlYWsKCSAgICB9CgkgIH0KCgkgIGlmICh4IDwgeSkgcmV0dXJuIC0xCgkgIGlmICh5IDwgeCkgcmV0dXJuIDEKCSAgcmV0dXJuIDAKCX0KCgkvLyBGaW5kcyBlaXRoZXIgdGhlIGZpcnN0IGluZGV4IG9mIGB2YWxgIGluIGBidWZmZXJgIGF0IG9mZnNldCA+PSBgYnl0ZU9mZnNldGAsCgkvLyBPUiB0aGUgbGFzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPD0gYGJ5dGVPZmZzZXRgLgoJLy8KCS8vIEFyZ3VtZW50czoKCS8vIC0gYnVmZmVyIC0gYSBCdWZmZXIgdG8gc2VhcmNoCgkvLyAtIHZhbCAtIGEgc3RyaW5nLCBCdWZmZXIsIG9yIG51bWJlcgoJLy8gLSBieXRlT2Zmc2V0IC0gYW4gaW5kZXggaW50byBgYnVmZmVyYDsgd2lsbCBiZSBjbGFtcGVkIHRvIGFuIGludDMyCgkvLyAtIGVuY29kaW5nIC0gYW4gb3B0aW9uYWwgZW5jb2RpbmcsIHJlbGV2YW50IGlzIHZhbCBpcyBhIHN0cmluZwoJLy8gLSBkaXIgLSB0cnVlIGZvciBpbmRleE9mLCBmYWxzZSBmb3IgbGFzdEluZGV4T2YKCWZ1bmN0aW9uIGJpZGlyZWN0aW9uYWxJbmRleE9mIChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikgewoJICAvLyBFbXB0eSBidWZmZXIgbWVhbnMgbm8gbWF0Y2gKCSAgaWYgKGJ1ZmZlci5sZW5ndGggPT09IDApIHJldHVybiAtMQoKCSAgLy8gTm9ybWFsaXplIGJ5dGVPZmZzZXQKCSAgaWYgKHR5cGVvZiBieXRlT2Zmc2V0ID09PSAnc3RyaW5nJykgewoJICAgIGVuY29kaW5nID0gYnl0ZU9mZnNldAoJICAgIGJ5dGVPZmZzZXQgPSAwCgkgIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA+IDB4N2ZmZmZmZmYpIHsKCSAgICBieXRlT2Zmc2V0ID0gMHg3ZmZmZmZmZgoJICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAtMHg4MDAwMDAwMCkgewoJICAgIGJ5dGVPZmZzZXQgPSAtMHg4MDAwMDAwMAoJICB9CgkgIGJ5dGVPZmZzZXQgPSArYnl0ZU9mZnNldCAgLy8gQ29lcmNlIHRvIE51bWJlci4KCSAgaWYgKGlzTmFOKGJ5dGVPZmZzZXQpKSB7CgkgICAgLy8gYnl0ZU9mZnNldDogaXQgaXQncyB1bmRlZmluZWQsIG51bGwsIE5hTiwgImZvbyIsIGV0Yywgc2VhcmNoIHdob2xlIGJ1ZmZlcgoJICAgIGJ5dGVPZmZzZXQgPSBkaXIgPyAwIDogKGJ1ZmZlci5sZW5ndGggLSAxKQoJICB9CgoJICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldDogbmVnYXRpdmUgb2Zmc2V0cyBzdGFydCBmcm9tIHRoZSBlbmQgb2YgdGhlIGJ1ZmZlcgoJICBpZiAoYnl0ZU9mZnNldCA8IDApIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoICsgYnl0ZU9mZnNldAoJICBpZiAoYnl0ZU9mZnNldCA+PSBidWZmZXIubGVuZ3RoKSB7CgkgICAgaWYgKGRpcikgcmV0dXJuIC0xCgkgICAgZWxzZSBieXRlT2Zmc2V0ID0gYnVmZmVyLmxlbmd0aCAtIDEKCSAgfSBlbHNlIGlmIChieXRlT2Zmc2V0IDwgMCkgewoJICAgIGlmIChkaXIpIGJ5dGVPZmZzZXQgPSAwCgkgICAgZWxzZSByZXR1cm4gLTEKCSAgfQoKCSAgLy8gTm9ybWFsaXplIHZhbAoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHsKCSAgICB2YWwgPSBCdWZmZXIuZnJvbSh2YWwsIGVuY29kaW5nKQoJICB9CgoJICAvLyBGaW5hbGx5LCBzZWFyY2ggZWl0aGVyIGluZGV4T2YgKGlmIGRpciBpcyB0cnVlKSBvciBsYXN0SW5kZXhPZgoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKHZhbCkpIHsKCSAgICAvLyBTcGVjaWFsIGNhc2U6IGxvb2tpbmcgZm9yIGVtcHR5IHN0cmluZy9idWZmZXIgYWx3YXlzIGZhaWxzCgkgICAgaWYgKHZhbC5sZW5ndGggPT09IDApIHsKCSAgICAgIHJldHVybiAtMQoJICAgIH0KCSAgICByZXR1cm4gYXJyYXlJbmRleE9mKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKQoJICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7CgkgICAgdmFsID0gdmFsICYgMHhGRiAvLyBTZWFyY2ggZm9yIGEgYnl0ZSB2YWx1ZSBbMC0yNTVdCgkgICAgaWYgKHR5cGVvZiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICBpZiAoZGlyKSB7CgkgICAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpCgkgICAgICB9IGVsc2UgewoJICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUubGFzdEluZGV4T2YuY2FsbChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCkKCSAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIFsgdmFsIF0sIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpCgkgIH0KCgkgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ZhbCBtdXN0IGJlIHN0cmluZywgbnVtYmVyIG9yIEJ1ZmZlcicpCgl9CgoJZnVuY3Rpb24gYXJyYXlJbmRleE9mIChhcnIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikgewoJICB2YXIgaW5kZXhTaXplID0gMQoJICB2YXIgYXJyTGVuZ3RoID0gYXJyLmxlbmd0aAoJICB2YXIgdmFsTGVuZ3RoID0gdmFsLmxlbmd0aAoKCSAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQpIHsKCSAgICBlbmNvZGluZyA9IFN0cmluZyhlbmNvZGluZykudG9Mb3dlckNhc2UoKQoJICAgIGlmIChlbmNvZGluZyA9PT0gJ3VjczInIHx8IGVuY29kaW5nID09PSAndWNzLTInIHx8CgkgICAgICAgIGVuY29kaW5nID09PSAndXRmMTZsZScgfHwgZW5jb2RpbmcgPT09ICd1dGYtMTZsZScpIHsKCSAgICAgIGlmIChhcnIubGVuZ3RoIDwgMiB8fCB2YWwubGVuZ3RoIDwgMikgewoJICAgICAgICByZXR1cm4gLTEKCSAgICAgIH0KCSAgICAgIGluZGV4U2l6ZSA9IDIKCSAgICAgIGFyckxlbmd0aCAvPSAyCgkgICAgICB2YWxMZW5ndGggLz0gMgoJICAgICAgYnl0ZU9mZnNldCAvPSAyCgkgICAgfQoJICB9CgoJICBmdW5jdGlvbiByZWFkIChidWYsIGkpIHsKCSAgICBpZiAoaW5kZXhTaXplID09PSAxKSB7CgkgICAgICByZXR1cm4gYnVmW2ldCgkgICAgfSBlbHNlIHsKCSAgICAgIHJldHVybiBidWYucmVhZFVJbnQxNkJFKGkgKiBpbmRleFNpemUpCgkgICAgfQoJICB9CgoJICB2YXIgaQoJICBpZiAoZGlyKSB7CgkgICAgdmFyIGZvdW5kSW5kZXggPSAtMQoJICAgIGZvciAoaSA9IGJ5dGVPZmZzZXQ7IGkgPCBhcnJMZW5ndGg7IGkrKykgewoJICAgICAgaWYgKHJlYWQoYXJyLCBpKSA9PT0gcmVhZCh2YWwsIGZvdW5kSW5kZXggPT09IC0xID8gMCA6IGkgLSBmb3VuZEluZGV4KSkgewoJICAgICAgICBpZiAoZm91bmRJbmRleCA9PT0gLTEpIGZvdW5kSW5kZXggPSBpCgkgICAgICAgIGlmIChpIC0gZm91bmRJbmRleCArIDEgPT09IHZhbExlbmd0aCkgcmV0dXJuIGZvdW5kSW5kZXggKiBpbmRleFNpemUKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGlmIChmb3VuZEluZGV4ICE9PSAtMSkgaSAtPSBpIC0gZm91bmRJbmRleAoJICAgICAgICBmb3VuZEluZGV4ID0gLTEKCSAgICAgIH0KCSAgICB9CgkgIH0gZWxzZSB7CgkgICAgaWYgKGJ5dGVPZmZzZXQgKyB2YWxMZW5ndGggPiBhcnJMZW5ndGgpIGJ5dGVPZmZzZXQgPSBhcnJMZW5ndGggLSB2YWxMZW5ndGgKCSAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpID49IDA7IGktLSkgewoJICAgICAgdmFyIGZvdW5kID0gdHJ1ZQoJICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB2YWxMZW5ndGg7IGorKykgewoJICAgICAgICBpZiAocmVhZChhcnIsIGkgKyBqKSAhPT0gcmVhZCh2YWwsIGopKSB7CgkgICAgICAgICAgZm91bmQgPSBmYWxzZQoJICAgICAgICAgIGJyZWFrCgkgICAgICAgIH0KCSAgICAgIH0KCSAgICAgIGlmIChmb3VuZCkgcmV0dXJuIGkKCSAgICB9CgkgIH0KCgkgIHJldHVybiAtMQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuaW5jbHVkZXMgPSBmdW5jdGlvbiBpbmNsdWRlcyAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgewoJICByZXR1cm4gdGhpcy5pbmRleE9mKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpICE9PSAtMQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHsKCSAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIHRydWUpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5sYXN0SW5kZXhPZiA9IGZ1bmN0aW9uIGxhc3RJbmRleE9mICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7CgkgIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBmYWxzZSkKCX0KCglmdW5jdGlvbiBoZXhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIG9mZnNldCA9IE51bWJlcihvZmZzZXQpIHx8IDAKCSAgdmFyIHJlbWFpbmluZyA9IGJ1Zi5sZW5ndGggLSBvZmZzZXQKCSAgaWYgKCFsZW5ndGgpIHsKCSAgICBsZW5ndGggPSByZW1haW5pbmcKCSAgfSBlbHNlIHsKCSAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKQoJICAgIGlmIChsZW5ndGggPiByZW1haW5pbmcpIHsKCSAgICAgIGxlbmd0aCA9IHJlbWFpbmluZwoJICAgIH0KCSAgfQoKCSAgLy8gbXVzdCBiZSBhbiBldmVuIG51bWJlciBvZiBkaWdpdHMKCSAgdmFyIHN0ckxlbiA9IHN0cmluZy5sZW5ndGgKCSAgaWYgKHN0ckxlbiAlIDIgIT09IDApIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpCgoJICBpZiAobGVuZ3RoID4gc3RyTGVuIC8gMikgewoJICAgIGxlbmd0aCA9IHN0ckxlbiAvIDIKCSAgfQoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CgkgICAgdmFyIHBhcnNlZCA9IHBhcnNlSW50KHN0cmluZy5zdWJzdHIoaSAqIDIsIDIpLCAxNikKCSAgICBpZiAoaXNOYU4ocGFyc2VkKSkgcmV0dXJuIGkKCSAgICBidWZbb2Zmc2V0ICsgaV0gPSBwYXJzZWQKCSAgfQoJICByZXR1cm4gaQoJfQoKCWZ1bmN0aW9uIHV0ZjhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKHV0ZjhUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpCgl9CgoJZnVuY3Rpb24gYXNjaWlXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKGFzY2lpVG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIGxhdGluMVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHsKCSAgcmV0dXJuIGFzY2lpV3JpdGUoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIGJhc2U2NFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHsKCSAgcmV0dXJuIGJsaXRCdWZmZXIoYmFzZTY0VG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIHVjczJXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKHV0ZjE2bGVUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIHdyaXRlIChzdHJpbmcsIG9mZnNldCwgbGVuZ3RoLCBlbmNvZGluZykgewoJICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nKQoJICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIHsKCSAgICBlbmNvZGluZyA9ICd1dGY4JwoJICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoCgkgICAgb2Zmc2V0ID0gMAoJICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBlbmNvZGluZykKCSAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygb2Zmc2V0ID09PSAnc3RyaW5nJykgewoJICAgIGVuY29kaW5nID0gb2Zmc2V0CgkgICAgbGVuZ3RoID0gdGhpcy5sZW5ndGgKCSAgICBvZmZzZXQgPSAwCgkgIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcsIG9mZnNldFssIGxlbmd0aF1bLCBlbmNvZGluZ10pCgkgIH0gZWxzZSBpZiAoaXNGaW5pdGUob2Zmc2V0KSkgewoJICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICAgIGlmIChpc0Zpbml0ZShsZW5ndGgpKSB7CgkgICAgICBsZW5ndGggPSBsZW5ndGggPj4+IDAKCSAgICAgIGlmIChlbmNvZGluZyA9PT0gdW5kZWZpbmVkKSBlbmNvZGluZyA9ICd1dGY4JwoJICAgIH0gZWxzZSB7CgkgICAgICBlbmNvZGluZyA9IGxlbmd0aAoJICAgICAgbGVuZ3RoID0gdW5kZWZpbmVkCgkgICAgfQoJICB9IGVsc2UgewoJICAgIHRocm93IG5ldyBFcnJvcigKCSAgICAgICdCdWZmZXIud3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0WywgbGVuZ3RoXSkgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCcKCSAgICApCgkgIH0KCgkgIHZhciByZW1haW5pbmcgPSB0aGlzLmxlbmd0aCAtIG9mZnNldAoJICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgfHwgbGVuZ3RoID4gcmVtYWluaW5nKSBsZW5ndGggPSByZW1haW5pbmcKCgkgIGlmICgoc3RyaW5nLmxlbmd0aCA+IDAgJiYgKGxlbmd0aCA8IDAgfHwgb2Zmc2V0IDwgMCkpIHx8IG9mZnNldCA+IHRoaXMubGVuZ3RoKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gd3JpdGUgb3V0c2lkZSBidWZmZXIgYm91bmRzJykKCSAgfQoKCSAgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSAndXRmOCcKCgkgIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlCgkgIGZvciAoOzspIHsKCSAgICBzd2l0Y2ggKGVuY29kaW5nKSB7CgkgICAgICBjYXNlICdoZXgnOgoJICAgICAgICByZXR1cm4gaGV4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBjYXNlICd1dGY4JzoKCSAgICAgIGNhc2UgJ3V0Zi04JzoKCSAgICAgICAgcmV0dXJuIHV0ZjhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGNhc2UgJ2FzY2lpJzoKCSAgICAgICAgcmV0dXJuIGFzY2lpV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBjYXNlICdsYXRpbjEnOgoJICAgICAgY2FzZSAnYmluYXJ5JzoKCSAgICAgICAgcmV0dXJuIGxhdGluMVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgY2FzZSAnYmFzZTY0JzoKCSAgICAgICAgLy8gV2FybmluZzogbWF4TGVuZ3RoIG5vdCB0YWtlbiBpbnRvIGFjY291bnQgaW4gYmFzZTY0V3JpdGUKCSAgICAgICAgcmV0dXJuIGJhc2U2NFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgY2FzZSAndWNzMic6CgkgICAgICBjYXNlICd1Y3MtMic6CgkgICAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIGNhc2UgJ3V0Zi0xNmxlJzoKCSAgICAgICAgcmV0dXJuIHVjczJXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGRlZmF1bHQ6CgkgICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKQoJICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpCgkgICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZQoJICAgIH0KCSAgfQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gdG9KU09OICgpIHsKCSAgcmV0dXJuIHsKCSAgICB0eXBlOiAnQnVmZmVyJywKCSAgICBkYXRhOiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0aGlzLl9hcnIgfHwgdGhpcywgMCkKCSAgfQoJfQoKCWZ1bmN0aW9uIGJhc2U2NFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgaWYgKHN0YXJ0ID09PSAwICYmIGVuZCA9PT0gYnVmLmxlbmd0aCkgewoJICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYpCgkgIH0gZWxzZSB7CgkgICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1Zi5zbGljZShzdGFydCwgZW5kKSkKCSAgfQoJfQoKCWZ1bmN0aW9uIHV0ZjhTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZCkKCSAgdmFyIHJlcyA9IFtdCgoJICB2YXIgaSA9IHN0YXJ0CgkgIHdoaWxlIChpIDwgZW5kKSB7CgkgICAgdmFyIGZpcnN0Qnl0ZSA9IGJ1ZltpXQoJICAgIHZhciBjb2RlUG9pbnQgPSBudWxsCgkgICAgdmFyIGJ5dGVzUGVyU2VxdWVuY2UgPSAoZmlyc3RCeXRlID4gMHhFRikgPyA0CgkgICAgICA6IChmaXJzdEJ5dGUgPiAweERGKSA/IDMKCSAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4QkYpID8gMgoJICAgICAgOiAxCgoJICAgIGlmIChpICsgYnl0ZXNQZXJTZXF1ZW5jZSA8PSBlbmQpIHsKCSAgICAgIHZhciBzZWNvbmRCeXRlLCB0aGlyZEJ5dGUsIGZvdXJ0aEJ5dGUsIHRlbXBDb2RlUG9pbnQKCgkgICAgICBzd2l0Y2ggKGJ5dGVzUGVyU2VxdWVuY2UpIHsKCSAgICAgICAgY2FzZSAxOgoJICAgICAgICAgIGlmIChmaXJzdEJ5dGUgPCAweDgwKSB7CgkgICAgICAgICAgICBjb2RlUG9pbnQgPSBmaXJzdEJ5dGUKCSAgICAgICAgICB9CgkgICAgICAgICAgYnJlYWsKCSAgICAgICAgY2FzZSAyOgoJICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdCgkgICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHsKCSAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHgxRikgPDwgMHg2IHwgKHNlY29uZEJ5dGUgJiAweDNGKQoJICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGKSB7CgkgICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnQKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgICAgYnJlYWsKCSAgICAgICAgY2FzZSAzOgoJICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdCgkgICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXQoJICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkgewoJICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweEYpIDw8IDB4QyB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKHRoaXJkQnl0ZSAmIDB4M0YpCgkgICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4N0ZGICYmICh0ZW1wQ29kZVBvaW50IDwgMHhEODAwIHx8IHRlbXBDb2RlUG9pbnQgPiAweERGRkYpKSB7CgkgICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnQKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgICAgYnJlYWsKCSAgICAgICAgY2FzZSA0OgoJICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdCgkgICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXQoJICAgICAgICAgIGZvdXJ0aEJ5dGUgPSBidWZbaSArIDNdCgkgICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwICYmIChmb3VydGhCeXRlICYgMHhDMCkgPT09IDB4ODApIHsKCSAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweDEyIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweEMgfCAodGhpcmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKGZvdXJ0aEJ5dGUgJiAweDNGKQoJICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweEZGRkYgJiYgdGVtcENvZGVQb2ludCA8IDB4MTEwMDAwKSB7CgkgICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnQKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICB9CgkgICAgfQoKCSAgICBpZiAoY29kZVBvaW50ID09PSBudWxsKSB7CgkgICAgICAvLyB3ZSBkaWQgbm90IGdlbmVyYXRlIGEgdmFsaWQgY29kZVBvaW50IHNvIGluc2VydCBhCgkgICAgICAvLyByZXBsYWNlbWVudCBjaGFyIChVK0ZGRkQpIGFuZCBhZHZhbmNlIG9ubHkgMSBieXRlCgkgICAgICBjb2RlUG9pbnQgPSAweEZGRkQKCSAgICAgIGJ5dGVzUGVyU2VxdWVuY2UgPSAxCgkgICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPiAweEZGRkYpIHsKCSAgICAgIC8vIGVuY29kZSB0byB1dGYxNiAoc3Vycm9nYXRlIHBhaXIgZGFuY2UpCgkgICAgICBjb2RlUG9pbnQgLT0gMHgxMDAwMAoJICAgICAgcmVzLnB1c2goY29kZVBvaW50ID4+PiAxMCAmIDB4M0ZGIHwgMHhEODAwKQoJICAgICAgY29kZVBvaW50ID0gMHhEQzAwIHwgY29kZVBvaW50ICYgMHgzRkYKCSAgICB9CgoJICAgIHJlcy5wdXNoKGNvZGVQb2ludCkKCSAgICBpICs9IGJ5dGVzUGVyU2VxdWVuY2UKCSAgfQoKCSAgcmV0dXJuIGRlY29kZUNvZGVQb2ludHNBcnJheShyZXMpCgl9CgoJLy8gQmFzZWQgb24gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjI3NDcyNzIvNjgwNzQyLCB0aGUgYnJvd3NlciB3aXRoCgkvLyB0aGUgbG93ZXN0IGxpbWl0IGlzIENocm9tZSwgd2l0aCAweDEwMDAwIGFyZ3MuCgkvLyBXZSBnbyAxIG1hZ25pdHVkZSBsZXNzLCBmb3Igc2FmZXR5Cgl2YXIgTUFYX0FSR1VNRU5UU19MRU5HVEggPSAweDEwMDAKCglmdW5jdGlvbiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkgKGNvZGVQb2ludHMpIHsKCSAgdmFyIGxlbiA9IGNvZGVQb2ludHMubGVuZ3RoCgkgIGlmIChsZW4gPD0gTUFYX0FSR1VNRU5UU19MRU5HVEgpIHsKCSAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsIGNvZGVQb2ludHMpIC8vIGF2b2lkIGV4dHJhIHNsaWNlKCkKCSAgfQoKCSAgLy8gRGVjb2RlIGluIGNodW5rcyB0byBhdm9pZCAiY2FsbCBzdGFjayBzaXplIGV4Y2VlZGVkIi4KCSAgdmFyIHJlcyA9ICcnCgkgIHZhciBpID0gMAoJICB3aGlsZSAoaSA8IGxlbikgewoJICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KAoJICAgICAgU3RyaW5nLAoJICAgICAgY29kZVBvaW50cy5zbGljZShpLCBpICs9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKQoJICAgICkKCSAgfQoJICByZXR1cm4gcmVzCgl9CgoJZnVuY3Rpb24gYXNjaWlTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIHZhciByZXQgPSAnJwoJICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpCgoJICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkgewoJICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSAmIDB4N0YpCgkgIH0KCSAgcmV0dXJuIHJldAoJfQoKCWZ1bmN0aW9uIGxhdGluMVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgdmFyIHJldCA9ICcnCgkgIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZCkKCgkgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7CgkgICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldKQoJICB9CgkgIHJldHVybiByZXQKCX0KCglmdW5jdGlvbiBoZXhTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIHZhciBsZW4gPSBidWYubGVuZ3RoCgoJICBpZiAoIXN0YXJ0IHx8IHN0YXJ0IDwgMCkgc3RhcnQgPSAwCgkgIGlmICghZW5kIHx8IGVuZCA8IDAgfHwgZW5kID4gbGVuKSBlbmQgPSBsZW4KCgkgIHZhciBvdXQgPSAnJwoJICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkgewoJICAgIG91dCArPSB0b0hleChidWZbaV0pCgkgIH0KCSAgcmV0dXJuIG91dAoJfQoKCWZ1bmN0aW9uIHV0ZjE2bGVTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIHZhciBieXRlcyA9IGJ1Zi5zbGljZShzdGFydCwgZW5kKQoJICB2YXIgcmVzID0gJycKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBieXRlcy5sZW5ndGg7IGkgKz0gMikgewoJICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ5dGVzW2ldICsgKGJ5dGVzW2kgKyAxXSAqIDI1NikpCgkgIH0KCSAgcmV0dXJuIHJlcwoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiBzbGljZSAoc3RhcnQsIGVuZCkgewoJICB2YXIgbGVuID0gdGhpcy5sZW5ndGgKCSAgc3RhcnQgPSB+fnN0YXJ0CgkgIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogfn5lbmQKCgkgIGlmIChzdGFydCA8IDApIHsKCSAgICBzdGFydCArPSBsZW4KCSAgICBpZiAoc3RhcnQgPCAwKSBzdGFydCA9IDAKCSAgfSBlbHNlIGlmIChzdGFydCA+IGxlbikgewoJICAgIHN0YXJ0ID0gbGVuCgkgIH0KCgkgIGlmIChlbmQgPCAwKSB7CgkgICAgZW5kICs9IGxlbgoJICAgIGlmIChlbmQgPCAwKSBlbmQgPSAwCgkgIH0gZWxzZSBpZiAoZW5kID4gbGVuKSB7CgkgICAgZW5kID0gbGVuCgkgIH0KCgkgIGlmIChlbmQgPCBzdGFydCkgZW5kID0gc3RhcnQKCgkgIHZhciBuZXdCdWYgPSB0aGlzLnN1YmFycmF5KHN0YXJ0LCBlbmQpCgkgIC8vIFJldHVybiBhbiBhdWdtZW50ZWQgYFVpbnQ4QXJyYXlgIGluc3RhbmNlCgkgIG5ld0J1Zi5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlCgkgIHJldHVybiBuZXdCdWYKCX0KCgkvKgoJICogTmVlZCB0byBtYWtlIHN1cmUgdGhhdCBidWZmZXIgaXNuJ3QgdHJ5aW5nIHRvIHdyaXRlIG91dCBvZiBib3VuZHMuCgkgKi8KCWZ1bmN0aW9uIGNoZWNrT2Zmc2V0IChvZmZzZXQsIGV4dCwgbGVuZ3RoKSB7CgkgIGlmICgob2Zmc2V0ICUgMSkgIT09IDAgfHwgb2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ29mZnNldCBpcyBub3QgdWludCcpCgkgIGlmIChvZmZzZXQgKyBleHQgPiBsZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoJykKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50TEUgPSBmdW5jdGlvbiByZWFkVUludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKQoKCSAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XQoJICB2YXIgbXVsID0gMQoJICB2YXIgaSA9IDAKCSAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHsKCSAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyBpXSAqIG11bAoJICB9CgoJICByZXR1cm4gdmFsCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludEJFID0gZnVuY3Rpb24gcmVhZFVJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpCgkgIH0KCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0KCSAgdmFyIG11bCA9IDEKCSAgd2hpbGUgKGJ5dGVMZW5ndGggPiAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXSAqIG11bAoJICB9CgoJICByZXR1cm4gdmFsCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiByZWFkVUludDggKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiB0aGlzW29mZnNldF0KCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aCkKCSAgcmV0dXJuIHRoaXNbb2Zmc2V0XSB8ICh0aGlzW29mZnNldCArIDFdIDw8IDgpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2QkUgPSBmdW5jdGlvbiByZWFkVUludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDgpIHwgdGhpc1tvZmZzZXQgKyAxXQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoKCSAgcmV0dXJuICgodGhpc1tvZmZzZXRdKSB8CgkgICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8CgkgICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikpICsKCSAgICAgICh0aGlzW29mZnNldCArIDNdICogMHgxMDAwMDAwKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkJFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoKCSAgcmV0dXJuICh0aGlzW29mZnNldF0gKiAweDEwMDAwMDApICsKCSAgICAoKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHwKCSAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8CgkgICAgdGhpc1tvZmZzZXQgKyAzXSkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnRMRSA9IGZ1bmN0aW9uIHJlYWRJbnRMRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCkKCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldF0KCSAgdmFyIG11bCA9IDEKCSAgdmFyIGkgPSAwCgkgIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWwKCSAgfQoJICBtdWwgKj0gMHg4MAoKCSAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkKCgkgIHJldHVybiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnRCRSA9IGZ1bmN0aW9uIHJlYWRJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCkKCgkgIHZhciBpID0gYnl0ZUxlbmd0aAoJICB2YXIgbXVsID0gMQoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWldCgkgIHdoaWxlIChpID4gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0taV0gKiBtdWwKCSAgfQoJICBtdWwgKj0gMHg4MAoKCSAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkKCgkgIHJldHVybiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQ4ID0gZnVuY3Rpb24gcmVhZEludDggKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpCgkgIGlmICghKHRoaXNbb2Zmc2V0XSAmIDB4ODApKSByZXR1cm4gKHRoaXNbb2Zmc2V0XSkKCSAgcmV0dXJuICgoMHhmZiAtIHRoaXNbb2Zmc2V0XSArIDEpICogLTEpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRJbnQxNkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKQoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkKCSAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2QkUgPSBmdW5jdGlvbiByZWFkSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aCkKCSAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgMV0gfCAodGhpc1tvZmZzZXRdIDw8IDgpCgkgIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkxFID0gZnVuY3Rpb24gcmVhZEludDMyTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgoJICByZXR1cm4gKHRoaXNbb2Zmc2V0XSkgfAoJICAgICh0aGlzW29mZnNldCArIDFdIDw8IDgpIHwKCSAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikgfAoJICAgICh0aGlzW29mZnNldCArIDNdIDw8IDI0KQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyQkUgPSBmdW5jdGlvbiByZWFkSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aCkKCgkgIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDI0KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHwKCSAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgM10pCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRMRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdExFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgMjMsIDQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRCRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdEJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgZmFsc2UsIDIzLCA0KQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUxFID0gZnVuY3Rpb24gcmVhZERvdWJsZUxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDgsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgNTIsIDgpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlQkUgPSBmdW5jdGlvbiByZWFkRG91YmxlQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgNTIsIDgpCgl9CgoJZnVuY3Rpb24gY2hlY2tJbnQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikgewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCciYnVmZmVyIiBhcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyIGluc3RhbmNlJykKCSAgaWYgKHZhbHVlID4gbWF4IHx8IHZhbHVlIDwgbWluKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignInZhbHVlIiBhcmd1bWVudCBpcyBvdXQgb2YgYm91bmRzJykKCSAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICB2YXIgbWF4Qnl0ZXMgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkgLSAxCgkgICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbWF4Qnl0ZXMsIDApCgkgIH0KCgkgIHZhciBtdWwgPSAxCgkgIHZhciBpID0gMAoJICB0aGlzW29mZnNldF0gPSB2YWx1ZSAmIDB4RkYKCSAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHsKCSAgICB0aGlzW29mZnNldCArIGldID0gKHZhbHVlIC8gbXVsKSAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlVUludEJFID0gZnVuY3Rpb24gd3JpdGVVSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMQoJICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKQoJICB9CgoJICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxCgkgIHZhciBtdWwgPSAxCgkgIHRoaXNbb2Zmc2V0ICsgaV0gPSB2YWx1ZSAmIDB4RkYKCSAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGCgkgIH0KCgkgIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVVSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4ZmYsIDApCgkgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgIHJldHVybiBvZmZzZXQgKyAxCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMCkKCSAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKQoJICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDgpCgkgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKQoJICByZXR1cm4gb2Zmc2V0ICsgMgoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKQoJICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlID4+PiAyNCkKCSAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpCgkgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpCgkgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgIHJldHVybiBvZmZzZXQgKyA0Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkJFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApCgkgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpCgkgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KQoJICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KQoJICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZikKCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50TEUgPSBmdW5jdGlvbiB3cml0ZUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsICg4ICogYnl0ZUxlbmd0aCkgLSAxKQoKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdCkKCSAgfQoKCSAgdmFyIGkgPSAwCgkgIHZhciBtdWwgPSAxCgkgIHZhciBzdWIgPSAwCgkgIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRgoJICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSAtIDFdICE9PSAwKSB7CgkgICAgICBzdWIgPSAxCgkgICAgfQoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50QkUgPSBmdW5jdGlvbiB3cml0ZUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsICg4ICogYnl0ZUxlbmd0aCkgLSAxKQoKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdCkKCSAgfQoKCSAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMQoJICB2YXIgbXVsID0gMQoJICB2YXIgc3ViID0gMAoJICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGCgkgIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSArIDFdICE9PSAwKSB7CgkgICAgICBzdWIgPSAxCgkgICAgfQoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50OCA9IGZ1bmN0aW9uIHdyaXRlSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4N2YsIC0weDgwKQoJICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmYgKyB2YWx1ZSArIDEKCSAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgcmV0dXJuIG9mZnNldCArIDEKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMCkKCSAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMCkKCSAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KQoJICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZikKCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKQoJICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKQoJICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KQoJICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiAxNikKCSAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpCgkgIHJldHVybiBvZmZzZXQgKyA0Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMCkKCSAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxCgkgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpCgkgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KQoJICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KQoJICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZikKCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglmdW5jdGlvbiBjaGVja0lFRUU3NTQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikgewoJICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpCgkgIGlmIChvZmZzZXQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJykKCX0KCglmdW5jdGlvbiB3cml0ZUZsb2F0IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA0LCAzLjQwMjgyMzQ2NjM4NTI4ODZlKzM4LCAtMy40MDI4MjM0NjYzODUyODg2ZSszOCkKCSAgfQoJICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCAyMywgNCkKCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRMRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0QkUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydCkKCX0KCglmdW5jdGlvbiB3cml0ZURvdWJsZSAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgOCwgMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgsIC0xLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCkKCSAgfQoJICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCA1MiwgOCkKCSAgcmV0dXJuIG9mZnNldCArIDgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlTEUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUJFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgcmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydCkKCX0KCgkvLyBjb3B5KHRhcmdldEJ1ZmZlciwgdGFyZ2V0U3RhcnQ9MCwgc291cmNlU3RhcnQ9MCwgc291cmNlRW5kPWJ1ZmZlci5sZW5ndGgpCglCdWZmZXIucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiBjb3B5ICh0YXJnZXQsIHRhcmdldFN0YXJ0LCBzdGFydCwgZW5kKSB7CgkgIGlmICghc3RhcnQpIHN0YXJ0ID0gMAoJICBpZiAoIWVuZCAmJiBlbmQgIT09IDApIGVuZCA9IHRoaXMubGVuZ3RoCgkgIGlmICh0YXJnZXRTdGFydCA+PSB0YXJnZXQubGVuZ3RoKSB0YXJnZXRTdGFydCA9IHRhcmdldC5sZW5ndGgKCSAgaWYgKCF0YXJnZXRTdGFydCkgdGFyZ2V0U3RhcnQgPSAwCgkgIGlmIChlbmQgPiAwICYmIGVuZCA8IHN0YXJ0KSBlbmQgPSBzdGFydAoKCSAgLy8gQ29weSAwIGJ5dGVzOyB3ZSdyZSBkb25lCgkgIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm4gMAoJICBpZiAodGFyZ2V0Lmxlbmd0aCA9PT0gMCB8fCB0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDAKCgkgIC8vIEZhdGFsIGVycm9yIGNvbmRpdGlvbnMKCSAgaWYgKHRhcmdldFN0YXJ0IDwgMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCd0YXJnZXRTdGFydCBvdXQgb2YgYm91bmRzJykKCSAgfQoJICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlU3RhcnQgb3V0IG9mIGJvdW5kcycpCgkgIGlmIChlbmQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlRW5kIG91dCBvZiBib3VuZHMnKQoKCSAgLy8gQXJlIHdlIG9vYj8KCSAgaWYgKGVuZCA+IHRoaXMubGVuZ3RoKSBlbmQgPSB0aGlzLmxlbmd0aAoJICBpZiAodGFyZ2V0Lmxlbmd0aCAtIHRhcmdldFN0YXJ0IDwgZW5kIC0gc3RhcnQpIHsKCSAgICBlbmQgPSB0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgKyBzdGFydAoJICB9CgoJICB2YXIgbGVuID0gZW5kIC0gc3RhcnQKCSAgdmFyIGkKCgkgIGlmICh0aGlzID09PSB0YXJnZXQgJiYgc3RhcnQgPCB0YXJnZXRTdGFydCAmJiB0YXJnZXRTdGFydCA8IGVuZCkgewoJICAgIC8vIGRlc2NlbmRpbmcgY29weSBmcm9tIGVuZAoJICAgIGZvciAoaSA9IGxlbiAtIDE7IGkgPj0gMDsgLS1pKSB7CgkgICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XQoJICAgIH0KCSAgfSBlbHNlIGlmIChsZW4gPCAxMDAwKSB7CgkgICAgLy8gYXNjZW5kaW5nIGNvcHkgZnJvbSBzdGFydAoJICAgIGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSkgewoJICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF0KCSAgICB9CgkgIH0gZWxzZSB7CgkgICAgVWludDhBcnJheS5wcm90b3R5cGUuc2V0LmNhbGwoCgkgICAgICB0YXJnZXQsCgkgICAgICB0aGlzLnN1YmFycmF5KHN0YXJ0LCBzdGFydCArIGxlbiksCgkgICAgICB0YXJnZXRTdGFydAoJICAgICkKCSAgfQoKCSAgcmV0dXJuIGxlbgoJfQoKCS8vIFVzYWdlOgoJLy8gICAgYnVmZmVyLmZpbGwobnVtYmVyWywgb2Zmc2V0WywgZW5kXV0pCgkvLyAgICBidWZmZXIuZmlsbChidWZmZXJbLCBvZmZzZXRbLCBlbmRdXSkKCS8vICAgIGJ1ZmZlci5maWxsKHN0cmluZ1ssIG9mZnNldFssIGVuZF1dWywgZW5jb2RpbmddKQoJQnVmZmVyLnByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gZmlsbCAodmFsLCBzdGFydCwgZW5kLCBlbmNvZGluZykgewoJICAvLyBIYW5kbGUgc3RyaW5nIGNhc2VzOgoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHsKCSAgICBpZiAodHlwZW9mIHN0YXJ0ID09PSAnc3RyaW5nJykgewoJICAgICAgZW5jb2RpbmcgPSBzdGFydAoJICAgICAgc3RhcnQgPSAwCgkgICAgICBlbmQgPSB0aGlzLmxlbmd0aAoJICAgIH0gZWxzZSBpZiAodHlwZW9mIGVuZCA9PT0gJ3N0cmluZycpIHsKCSAgICAgIGVuY29kaW5nID0gZW5kCgkgICAgICBlbmQgPSB0aGlzLmxlbmd0aAoJICAgIH0KCSAgICBpZiAodmFsLmxlbmd0aCA9PT0gMSkgewoJICAgICAgdmFyIGNvZGUgPSB2YWwuY2hhckNvZGVBdCgwKQoJICAgICAgaWYgKGNvZGUgPCAyNTYpIHsKCSAgICAgICAgdmFsID0gY29kZQoJICAgICAgfQoJICAgIH0KCSAgICBpZiAoZW5jb2RpbmcgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnKSB7CgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdlbmNvZGluZyBtdXN0IGJlIGEgc3RyaW5nJykKCSAgICB9CgkgICAgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycgJiYgIUJ1ZmZlci5pc0VuY29kaW5nKGVuY29kaW5nKSkgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKQoJICAgIH0KCSAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykgewoJICAgIHZhbCA9IHZhbCAmIDI1NQoJICB9CgoJICAvLyBJbnZhbGlkIHJhbmdlcyBhcmUgbm90IHNldCB0byBhIGRlZmF1bHQsIHNvIGNhbiByYW5nZSBjaGVjayBlYXJseS4KCSAgaWYgKHN0YXJ0IDwgMCB8fCB0aGlzLmxlbmd0aCA8IHN0YXJ0IHx8IHRoaXMubGVuZ3RoIDwgZW5kKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ091dCBvZiByYW5nZSBpbmRleCcpCgkgIH0KCgkgIGlmIChlbmQgPD0gc3RhcnQpIHsKCSAgICByZXR1cm4gdGhpcwoJICB9CgoJICBzdGFydCA9IHN0YXJ0ID4+PiAwCgkgIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gdGhpcy5sZW5ndGggOiBlbmQgPj4+IDAKCgkgIGlmICghdmFsKSB2YWwgPSAwCgoJICB2YXIgaQoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHsKCSAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7CgkgICAgICB0aGlzW2ldID0gdmFsCgkgICAgfQoJICB9IGVsc2UgewoJICAgIHZhciBieXRlcyA9IEJ1ZmZlci5pc0J1ZmZlcih2YWwpCgkgICAgICA/IHZhbAoJICAgICAgOiBuZXcgQnVmZmVyKHZhbCwgZW5jb2RpbmcpCgkgICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aAoJICAgIGZvciAoaSA9IDA7IGkgPCBlbmQgLSBzdGFydDsgKytpKSB7CgkgICAgICB0aGlzW2kgKyBzdGFydF0gPSBieXRlc1tpICUgbGVuXQoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIHRoaXMKCX0KCgkvLyBIRUxQRVIgRlVOQ1RJT05TCgkvLyA9PT09PT09PT09PT09PT09CgoJdmFyIElOVkFMSURfQkFTRTY0X1JFID0gL1teKy8wLTlBLVphLXotX10vZwoKCWZ1bmN0aW9uIGJhc2U2NGNsZWFuIChzdHIpIHsKCSAgLy8gTm9kZSBzdHJpcHMgb3V0IGludmFsaWQgY2hhcmFjdGVycyBsaWtlIFxuIGFuZCBcdCBmcm9tIHRoZSBzdHJpbmcsIGJhc2U2NC1qcyBkb2VzIG5vdAoJICBzdHIgPSBzdHJpbmd0cmltKHN0cikucmVwbGFjZShJTlZBTElEX0JBU0U2NF9SRSwgJycpCgkgIC8vIE5vZGUgY29udmVydHMgc3RyaW5ncyB3aXRoIGxlbmd0aCA8IDIgdG8gJycKCSAgaWYgKHN0ci5sZW5ndGggPCAyKSByZXR1cm4gJycKCSAgLy8gTm9kZSBhbGxvd3MgZm9yIG5vbi1wYWRkZWQgYmFzZTY0IHN0cmluZ3MgKG1pc3NpbmcgdHJhaWxpbmcgPT09KSwgYmFzZTY0LWpzIGRvZXMgbm90CgkgIHdoaWxlIChzdHIubGVuZ3RoICUgNCAhPT0gMCkgewoJICAgIHN0ciA9IHN0ciArICc9JwoJICB9CgkgIHJldHVybiBzdHIKCX0KCglmdW5jdGlvbiBzdHJpbmd0cmltIChzdHIpIHsKCSAgaWYgKHN0ci50cmltKSByZXR1cm4gc3RyLnRyaW0oKQoJICByZXR1cm4gc3RyLnJlcGxhY2UoL15ccyt8XHMrJC9nLCAnJykKCX0KCglmdW5jdGlvbiB0b0hleCAobikgewoJICBpZiAobiA8IDE2KSByZXR1cm4gJzAnICsgbi50b1N0cmluZygxNikKCSAgcmV0dXJuIG4udG9TdHJpbmcoMTYpCgl9CgoJZnVuY3Rpb24gdXRmOFRvQnl0ZXMgKHN0cmluZywgdW5pdHMpIHsKCSAgdW5pdHMgPSB1bml0cyB8fCBJbmZpbml0eQoJICB2YXIgY29kZVBvaW50CgkgIHZhciBsZW5ndGggPSBzdHJpbmcubGVuZ3RoCgkgIHZhciBsZWFkU3Vycm9nYXRlID0gbnVsbAoJICB2YXIgYnl0ZXMgPSBbXQoKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewoJICAgIGNvZGVQb2ludCA9IHN0cmluZy5jaGFyQ29kZUF0KGkpCgoJICAgIC8vIGlzIHN1cnJvZ2F0ZSBjb21wb25lbnQKCSAgICBpZiAoY29kZVBvaW50ID4gMHhEN0ZGICYmIGNvZGVQb2ludCA8IDB4RTAwMCkgewoJICAgICAgLy8gbGFzdCBjaGFyIHdhcyBhIGxlYWQKCSAgICAgIGlmICghbGVhZFN1cnJvZ2F0ZSkgewoJICAgICAgICAvLyBubyBsZWFkIHlldAoJICAgICAgICBpZiAoY29kZVBvaW50ID4gMHhEQkZGKSB7CgkgICAgICAgICAgLy8gdW5leHBlY3RlZCB0cmFpbAoJICAgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKQoJICAgICAgICAgIGNvbnRpbnVlCgkgICAgICAgIH0gZWxzZSBpZiAoaSArIDEgPT09IGxlbmd0aCkgewoJICAgICAgICAgIC8vIHVucGFpcmVkIGxlYWQKCSAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRCkKCSAgICAgICAgICBjb250aW51ZQoJICAgICAgICB9CgoJICAgICAgICAvLyB2YWxpZCBsZWFkCgkgICAgICAgIGxlYWRTdXJyb2dhdGUgPSBjb2RlUG9pbnQKCgkgICAgICAgIGNvbnRpbnVlCgkgICAgICB9CgoJICAgICAgLy8gMiBsZWFkcyBpbiBhIHJvdwoJICAgICAgaWYgKGNvZGVQb2ludCA8IDB4REMwMCkgewoJICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRCkKCSAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludAoJICAgICAgICBjb250aW51ZQoJICAgICAgfQoKCSAgICAgIC8vIHZhbGlkIHN1cnJvZ2F0ZSBwYWlyCgkgICAgICBjb2RlUG9pbnQgPSAobGVhZFN1cnJvZ2F0ZSAtIDB4RDgwMCA8PCAxMCB8IGNvZGVQb2ludCAtIDB4REMwMCkgKyAweDEwMDAwCgkgICAgfSBlbHNlIGlmIChsZWFkU3Vycm9nYXRlKSB7CgkgICAgICAvLyB2YWxpZCBibXAgY2hhciwgYnV0IGxhc3QgY2hhciB3YXMgYSBsZWFkCgkgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRCkKCSAgICB9CgoJICAgIGxlYWRTdXJyb2dhdGUgPSBudWxsCgoJICAgIC8vIGVuY29kZSB1dGY4CgkgICAgaWYgKGNvZGVQb2ludCA8IDB4ODApIHsKCSAgICAgIGlmICgodW5pdHMgLT0gMSkgPCAwKSBicmVhawoJICAgICAgYnl0ZXMucHVzaChjb2RlUG9pbnQpCgkgICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDgwMCkgewoJICAgICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrCgkgICAgICBieXRlcy5wdXNoKAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHg2IHwgMHhDMCwKCSAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODAKCSAgICAgICkKCSAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTAwMDApIHsKCSAgICAgIGlmICgodW5pdHMgLT0gMykgPCAwKSBicmVhawoJICAgICAgYnl0ZXMucHVzaCgKCSAgICAgICAgY29kZVBvaW50ID4+IDB4QyB8IDB4RTAsCgkgICAgICAgIGNvZGVQb2ludCA+PiAweDYgJiAweDNGIHwgMHg4MCwKCSAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODAKCSAgICAgICkKCSAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTEwMDAwKSB7CgkgICAgICBpZiAoKHVuaXRzIC09IDQpIDwgMCkgYnJlYWsKCSAgICAgIGJ5dGVzLnB1c2goCgkgICAgICAgIGNvZGVQb2ludCA+PiAweDEyIHwgMHhGMCwKCSAgICAgICAgY29kZVBvaW50ID4+IDB4QyAmIDB4M0YgfCAweDgwLAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsCgkgICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwCgkgICAgICApCgkgICAgfSBlbHNlIHsKCSAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjb2RlIHBvaW50JykKCSAgICB9CgkgIH0KCgkgIHJldHVybiBieXRlcwoJfQoKCWZ1bmN0aW9uIGFzY2lpVG9CeXRlcyAoc3RyKSB7CgkgIHZhciBieXRlQXJyYXkgPSBbXQoJICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7ICsraSkgewoJICAgIC8vIE5vZGUncyBjb2RlIHNlZW1zIHRvIGJlIGRvaW5nIHRoaXMgYW5kIG5vdCAmIDB4N0YuLgoJICAgIGJ5dGVBcnJheS5wdXNoKHN0ci5jaGFyQ29kZUF0KGkpICYgMHhGRikKCSAgfQoJICByZXR1cm4gYnl0ZUFycmF5Cgl9CgoJZnVuY3Rpb24gdXRmMTZsZVRvQnl0ZXMgKHN0ciwgdW5pdHMpIHsKCSAgdmFyIGMsIGhpLCBsbwoJICB2YXIgYnl0ZUFycmF5ID0gW10KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyArK2kpIHsKCSAgICBpZiAoKHVuaXRzIC09IDIpIDwgMCkgYnJlYWsKCgkgICAgYyA9IHN0ci5jaGFyQ29kZUF0KGkpCgkgICAgaGkgPSBjID4+IDgKCSAgICBsbyA9IGMgJSAyNTYKCSAgICBieXRlQXJyYXkucHVzaChsbykKCSAgICBieXRlQXJyYXkucHVzaChoaSkKCSAgfQoKCSAgcmV0dXJuIGJ5dGVBcnJheQoJfQoKCWZ1bmN0aW9uIGJhc2U2NFRvQnl0ZXMgKHN0cikgewoJICByZXR1cm4gYmFzZTY0LnRvQnl0ZUFycmF5KGJhc2U2NGNsZWFuKHN0cikpCgl9CgoJZnVuY3Rpb24gYmxpdEJ1ZmZlciAoc3JjLCBkc3QsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKCSAgICBpZiAoKGkgKyBvZmZzZXQgPj0gZHN0Lmxlbmd0aCkgfHwgKGkgPj0gc3JjLmxlbmd0aCkpIGJyZWFrCgkgICAgZHN0W2kgKyBvZmZzZXRdID0gc3JjW2ldCgkgIH0KCSAgcmV0dXJuIGkKCX0KCglmdW5jdGlvbiBpc25hbiAodmFsKSB7CgkgIHJldHVybiB2YWwgIT09IHZhbCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXNlbGYtY29tcGFyZQoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpLkJ1ZmZlcikpCgovKioqLyB9LAovKiAyNyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7J3VzZSBzdHJpY3QnOwoKCXZhciBidWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KTsKCXZhciBCdWZmZXIgPSBidWZmZXIuQnVmZmVyOwoJdmFyIFNsb3dCdWZmZXIgPSBidWZmZXIuU2xvd0J1ZmZlcjsKCXZhciBNQVhfTEVOID0gYnVmZmVyLmtNYXhMZW5ndGggfHwgMjE0NzQ4MzY0NzsKCWV4cG9ydHMuYWxsb2MgPSBmdW5jdGlvbiBhbGxvYyhzaXplLCBmaWxsLCBlbmNvZGluZykgewoJICBpZiAodHlwZW9mIEJ1ZmZlci5hbGxvYyA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIHJldHVybiBCdWZmZXIuYWxsb2Moc2l6ZSwgZmlsbCwgZW5jb2RpbmcpOwoJICB9CgkgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZW5jb2RpbmcgbXVzdCBub3QgYmUgbnVtYmVyJyk7CgkgIH0KCSAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3NpemUgbXVzdCBiZSBhIG51bWJlcicpOwoJICB9CgkgIGlmIChzaXplID4gTUFYX0xFTikgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdzaXplIGlzIHRvbyBsYXJnZScpOwoJICB9CgkgIHZhciBlbmMgPSBlbmNvZGluZzsKCSAgdmFyIF9maWxsID0gZmlsbDsKCSAgaWYgKF9maWxsID09PSB1bmRlZmluZWQpIHsKCSAgICBlbmMgPSB1bmRlZmluZWQ7CgkgICAgX2ZpbGwgPSAwOwoJICB9CgkgIHZhciBidWYgPSBuZXcgQnVmZmVyKHNpemUpOwoJICBpZiAodHlwZW9mIF9maWxsID09PSAnc3RyaW5nJykgewoJICAgIHZhciBmaWxsQnVmID0gbmV3IEJ1ZmZlcihfZmlsbCwgZW5jKTsKCSAgICB2YXIgZmxlbiA9IGZpbGxCdWYubGVuZ3RoOwoJICAgIHZhciBpID0gLTE7CgkgICAgd2hpbGUgKCsraSA8IHNpemUpIHsKCSAgICAgIGJ1ZltpXSA9IGZpbGxCdWZbaSAlIGZsZW5dOwoJICAgIH0KCSAgfSBlbHNlIHsKCSAgICBidWYuZmlsbChfZmlsbCk7CgkgIH0KCSAgcmV0dXJuIGJ1ZjsKCX0KCWV4cG9ydHMuYWxsb2NVbnNhZmUgPSBmdW5jdGlvbiBhbGxvY1Vuc2FmZShzaXplKSB7CgkgIGlmICh0eXBlb2YgQnVmZmVyLmFsbG9jVW5zYWZlID09PSAnZnVuY3Rpb24nKSB7CgkgICAgcmV0dXJuIEJ1ZmZlci5hbGxvY1Vuc2FmZShzaXplKTsKCSAgfQoJICBpZiAodHlwZW9mIHNpemUgIT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignc2l6ZSBtdXN0IGJlIGEgbnVtYmVyJyk7CgkgIH0KCSAgaWYgKHNpemUgPiBNQVhfTEVOKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NpemUgaXMgdG9vIGxhcmdlJyk7CgkgIH0KCSAgcmV0dXJuIG5ldyBCdWZmZXIoc2l6ZSk7Cgl9CglleHBvcnRzLmZyb20gPSBmdW5jdGlvbiBmcm9tKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHsKCSAgaWYgKHR5cGVvZiBCdWZmZXIuZnJvbSA9PT0gJ2Z1bmN0aW9uJyAmJiAoIWdsb2JhbC5VaW50OEFycmF5IHx8IFVpbnQ4QXJyYXkuZnJvbSAhPT0gQnVmZmVyLmZyb20pKSB7CgkgICAgcmV0dXJuIEJ1ZmZlci5mcm9tKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpOwoJICB9CgkgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignInZhbHVlIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpOwoJICB9CgkgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7CgkgICAgcmV0dXJuIG5ldyBCdWZmZXIodmFsdWUsIGVuY29kaW5nT3JPZmZzZXQpOwoJICB9CgkgIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIHZhbHVlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsKCSAgICB2YXIgb2Zmc2V0ID0gZW5jb2RpbmdPck9mZnNldDsKCSAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkgewoJICAgICAgcmV0dXJuIG5ldyBCdWZmZXIodmFsdWUpOwoJICAgIH0KCSAgICBpZiAodHlwZW9mIG9mZnNldCA9PT0gJ3VuZGVmaW5lZCcpIHsKCSAgICAgIG9mZnNldCA9IDA7CgkgICAgfQoJICAgIHZhciBsZW4gPSBsZW5ndGg7CgkgICAgaWYgKHR5cGVvZiBsZW4gPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICBsZW4gPSB2YWx1ZS5ieXRlTGVuZ3RoIC0gb2Zmc2V0OwoJICAgIH0KCSAgICBpZiAob2Zmc2V0ID49IHZhbHVlLmJ5dGVMZW5ndGgpIHsKCSAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcJ29mZnNldFwnIGlzIG91dCBvZiBib3VuZHMnKTsKCSAgICB9CgkgICAgaWYgKGxlbiA+IHZhbHVlLmJ5dGVMZW5ndGggLSBvZmZzZXQpIHsKCSAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcJ2xlbmd0aFwnIGlzIG91dCBvZiBib3VuZHMnKTsKCSAgICB9CgkgICAgcmV0dXJuIG5ldyBCdWZmZXIodmFsdWUuc2xpY2Uob2Zmc2V0LCBvZmZzZXQgKyBsZW4pKTsKCSAgfQoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKHZhbHVlKSkgewoJICAgIHZhciBvdXQgPSBuZXcgQnVmZmVyKHZhbHVlLmxlbmd0aCk7CgkgICAgdmFsdWUuY29weShvdXQsIDAsIDAsIHZhbHVlLmxlbmd0aCk7CgkgICAgcmV0dXJuIG91dDsKCSAgfQoJICBpZiAodmFsdWUpIHsKCSAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgfHwgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHx8ICdsZW5ndGgnIGluIHZhbHVlKSB7CgkgICAgICByZXR1cm4gbmV3IEJ1ZmZlcih2YWx1ZSk7CgkgICAgfQoJICAgIGlmICh2YWx1ZS50eXBlID09PSAnQnVmZmVyJyAmJiBBcnJheS5pc0FycmF5KHZhbHVlLmRhdGEpKSB7CgkgICAgICByZXR1cm4gbmV3IEJ1ZmZlcih2YWx1ZS5kYXRhKTsKCSAgICB9CgkgIH0KCgkgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgJyArICdBcnJheUJ1ZmZlciwgQXJyYXksIG9yIGFycmF5LWxpa2Ugb2JqZWN0LicpOwoJfQoJZXhwb3J0cy5hbGxvY1Vuc2FmZVNsb3cgPSBmdW5jdGlvbiBhbGxvY1Vuc2FmZVNsb3coc2l6ZSkgewoJICBpZiAodHlwZW9mIEJ1ZmZlci5hbGxvY1Vuc2FmZVNsb3cgPT09ICdmdW5jdGlvbicpIHsKCSAgICByZXR1cm4gQnVmZmVyLmFsbG9jVW5zYWZlU2xvdyhzaXplKTsKCSAgfQoJICBpZiAodHlwZW9mIHNpemUgIT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignc2l6ZSBtdXN0IGJlIGEgbnVtYmVyJyk7CgkgIH0KCSAgaWYgKHNpemUgPj0gTUFYX0xFTikgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdzaXplIGlzIHRvbyBsYXJnZScpOwoJICB9CgkgIHJldHVybiBuZXcgU2xvd0J1ZmZlcihzaXplKTsKCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpCgovKioqLyB9LAovKiAyOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBhIGR1cGxleCBzdHJlYW0gaXMganVzdCBhIHN0cmVhbSB0aGF0IGlzIGJvdGggcmVhZGFibGUgYW5kIHdyaXRhYmxlLgoJLy8gU2luY2UgSlMgZG9lc24ndCBoYXZlIG11bHRpcGxlIHByb3RvdHlwYWwgaW5oZXJpdGFuY2UsIHRoaXMgY2xhc3MKCS8vIHByb3RvdHlwYWxseSBpbmhlcml0cyBmcm9tIFJlYWRhYmxlLCBhbmQgdGhlbiBwYXJhc2l0aWNhbGx5IGZyb20KCS8vIFdyaXRhYmxlLgoKCSd1c2Ugc3RyaWN0JzsKCgkvKjxyZXBsYWNlbWVudD4qLwoKCXZhciBvYmplY3RLZXlzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24gKG9iaikgewoJICB2YXIga2V5cyA9IFtdOwoJICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CgkgICAga2V5cy5wdXNoKGtleSk7CgkgIH1yZXR1cm4ga2V5czsKCX07CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgltb2R1bGUuZXhwb3J0cyA9IER1cGxleDsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHByb2Nlc3NOZXh0VGljayA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cgl1dGlsLmluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl2YXIgUmVhZGFibGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KTsKCXZhciBXcml0YWJsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwoKCXV0aWwuaW5oZXJpdHMoRHVwbGV4LCBSZWFkYWJsZSk7CgoJdmFyIGtleXMgPSBvYmplY3RLZXlzKFdyaXRhYmxlLnByb3RvdHlwZSk7Cglmb3IgKHZhciB2ID0gMDsgdiA8IGtleXMubGVuZ3RoOyB2KyspIHsKCSAgdmFyIG1ldGhvZCA9IGtleXNbdl07CgkgIGlmICghRHVwbGV4LnByb3RvdHlwZVttZXRob2RdKSBEdXBsZXgucHJvdG90eXBlW21ldGhvZF0gPSBXcml0YWJsZS5wcm90b3R5cGVbbWV0aG9kXTsKCX0KCglmdW5jdGlvbiBEdXBsZXgob3B0aW9ucykgewoJICBpZiAoISh0aGlzIGluc3RhbmNlb2YgRHVwbGV4KSkgcmV0dXJuIG5ldyBEdXBsZXgob3B0aW9ucyk7CgoJICBSZWFkYWJsZS5jYWxsKHRoaXMsIG9wdGlvbnMpOwoJICBXcml0YWJsZS5jYWxsKHRoaXMsIG9wdGlvbnMpOwoKCSAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5yZWFkYWJsZSA9PT0gZmFsc2UpIHRoaXMucmVhZGFibGUgPSBmYWxzZTsKCgkgIGlmIChvcHRpb25zICYmIG9wdGlvbnMud3JpdGFibGUgPT09IGZhbHNlKSB0aGlzLndyaXRhYmxlID0gZmFsc2U7CgoJICB0aGlzLmFsbG93SGFsZk9wZW4gPSB0cnVlOwoJICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmFsbG93SGFsZk9wZW4gPT09IGZhbHNlKSB0aGlzLmFsbG93SGFsZk9wZW4gPSBmYWxzZTsKCgkgIHRoaXMub25jZSgnZW5kJywgb25lbmQpOwoJfQoKCS8vIHRoZSBuby1oYWxmLW9wZW4gZW5mb3JjZXIKCWZ1bmN0aW9uIG9uZW5kKCkgewoJICAvLyBpZiB3ZSBhbGxvdyBoYWxmLW9wZW4gc3RhdGUsIG9yIGlmIHRoZSB3cml0YWJsZSBzaWRlIGVuZGVkLAoJICAvLyB0aGVuIHdlJ3JlIG9rLgoJICBpZiAodGhpcy5hbGxvd0hhbGZPcGVuIHx8IHRoaXMuX3dyaXRhYmxlU3RhdGUuZW5kZWQpIHJldHVybjsKCgkgIC8vIG5vIG1vcmUgZGF0YSBjYW4gYmUgd3JpdHRlbi4KCSAgLy8gQnV0IGFsbG93IG1vcmUgd3JpdGVzIHRvIGhhcHBlbiBpbiB0aGlzIHRpY2suCgkgIHByb2Nlc3NOZXh0VGljayhvbkVuZE5ULCB0aGlzKTsKCX0KCglmdW5jdGlvbiBvbkVuZE5UKHNlbGYpIHsKCSAgc2VsZi5lbmQoKTsKCX0KCglmdW5jdGlvbiBmb3JFYWNoKHhzLCBmKSB7CgkgIGZvciAodmFyIGkgPSAwLCBsID0geHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgZih4c1tpXSwgaSk7CgkgIH0KCX0KCi8qKiovIH0sCi8qIDI5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihwcm9jZXNzKSB7J3VzZSBzdHJpY3QnOwoKCW1vZHVsZS5leHBvcnRzID0gUmVhZGFibGU7CgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBwcm9jZXNzTmV4dFRpY2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgaXNBcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBEdXBsZXg7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCglSZWFkYWJsZS5SZWFkYWJsZVN0YXRlID0gUmVhZGFibGVTdGF0ZTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIEVFID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkuRXZlbnRFbWl0dGVyOwoKCXZhciBFRWxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbiAoZW1pdHRlciwgdHlwZSkgewoJICByZXR1cm4gZW1pdHRlci5saXN0ZW5lcnModHlwZSkubGVuZ3RoOwoJfTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgU3RyZWFtOwoJKGZ1bmN0aW9uICgpIHsKCSAgdHJ5IHsKCSAgICBTdHJlYW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCSAgfSBjYXRjaCAoXykge30gZmluYWxseSB7CgkgICAgaWYgKCFTdHJlYW0pIFN0cmVhbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpLkV2ZW50RW1pdHRlcjsKCSAgfQoJfSkoKTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXZhciBCdWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KS5CdWZmZXI7CgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIGJ1ZmZlclNoaW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgdXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwoJdXRpbC5pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBkZWJ1Z1V0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKTsKCXZhciBkZWJ1ZyA9IHZvaWQgMDsKCWlmIChkZWJ1Z1V0aWwgJiYgZGVidWdVdGlsLmRlYnVnbG9nKSB7CgkgIGRlYnVnID0gZGVidWdVdGlsLmRlYnVnbG9nKCdzdHJlYW0nKTsKCX0gZWxzZSB7CgkgIGRlYnVnID0gZnVuY3Rpb24gKCkge307Cgl9CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl2YXIgQnVmZmVyTGlzdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoJdmFyIFN0cmluZ0RlY29kZXI7CgoJdXRpbC5pbmhlcml0cyhSZWFkYWJsZSwgU3RyZWFtKTsKCglmdW5jdGlvbiBwcmVwZW5kTGlzdGVuZXIoZW1pdHRlciwgZXZlbnQsIGZuKSB7CgkgIC8vIFNhZGx5IHRoaXMgaXMgbm90IGNhY2hlYWJsZSBhcyBzb21lIGxpYnJhcmllcyBidW5kbGUgdGhlaXIgb3duCgkgIC8vIGV2ZW50IGVtaXR0ZXIgaW1wbGVtZW50YXRpb24gd2l0aCB0aGVtLgoJICBpZiAodHlwZW9mIGVtaXR0ZXIucHJlcGVuZExpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7CgkgICAgcmV0dXJuIGVtaXR0ZXIucHJlcGVuZExpc3RlbmVyKGV2ZW50LCBmbik7CgkgIH0gZWxzZSB7CgkgICAgLy8gVGhpcyBpcyBhIGhhY2sgdG8gbWFrZSBzdXJlIHRoYXQgb3VyIGVycm9yIGhhbmRsZXIgaXMgYXR0YWNoZWQgYmVmb3JlIGFueQoJICAgIC8vIHVzZXJsYW5kIG9uZXMuICBORVZFUiBETyBUSElTLiBUaGlzIGlzIGhlcmUgb25seSBiZWNhdXNlIHRoaXMgY29kZSBuZWVkcwoJICAgIC8vIHRvIGNvbnRpbnVlIHRvIHdvcmsgd2l0aCBvbGRlciB2ZXJzaW9ucyBvZiBOb2RlLmpzIHRoYXQgZG8gbm90IGluY2x1ZGUKCSAgICAvLyB0aGUgcHJlcGVuZExpc3RlbmVyKCkgbWV0aG9kLiBUaGUgZ29hbCBpcyB0byBldmVudHVhbGx5IHJlbW92ZSB0aGlzIGhhY2suCgkgICAgaWYgKCFlbWl0dGVyLl9ldmVudHMgfHwgIWVtaXR0ZXIuX2V2ZW50c1tldmVudF0pIGVtaXR0ZXIub24oZXZlbnQsIGZuKTtlbHNlIGlmIChpc0FycmF5KGVtaXR0ZXIuX2V2ZW50c1tldmVudF0pKSBlbWl0dGVyLl9ldmVudHNbZXZlbnRdLnVuc2hpZnQoZm4pO2Vsc2UgZW1pdHRlci5fZXZlbnRzW2V2ZW50XSA9IFtmbiwgZW1pdHRlci5fZXZlbnRzW2V2ZW50XV07CgkgIH0KCX0KCglmdW5jdGlvbiBSZWFkYWJsZVN0YXRlKG9wdGlvbnMsIHN0cmVhbSkgewoJICBEdXBsZXggPSBEdXBsZXggfHwgX193ZWJwYWNrX3JlcXVpcmVfXygyOCk7CgoJICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCgkgIC8vIG9iamVjdCBzdHJlYW0gZmxhZy4gVXNlZCB0byBtYWtlIHJlYWQobikgaWdub3JlIG4gYW5kIHRvCgkgIC8vIG1ha2UgYWxsIHRoZSBidWZmZXIgbWVyZ2luZyBhbmQgbGVuZ3RoIGNoZWNrcyBnbyBhd2F5CgkgIHRoaXMub2JqZWN0TW9kZSA9ICEhb3B0aW9ucy5vYmplY3RNb2RlOwoKCSAgaWYgKHN0cmVhbSBpbnN0YW5jZW9mIER1cGxleCkgdGhpcy5vYmplY3RNb2RlID0gdGhpcy5vYmplY3RNb2RlIHx8ICEhb3B0aW9ucy5yZWFkYWJsZU9iamVjdE1vZGU7CgoJICAvLyB0aGUgcG9pbnQgYXQgd2hpY2ggaXQgc3RvcHMgY2FsbGluZyBfcmVhZCgpIHRvIGZpbGwgdGhlIGJ1ZmZlcgoJICAvLyBOb3RlOiAwIGlzIGEgdmFsaWQgdmFsdWUsIG1lYW5zICJkb24ndCBjYWxsIF9yZWFkIHByZWVtcHRpdmVseSBldmVyIgoJICB2YXIgaHdtID0gb3B0aW9ucy5oaWdoV2F0ZXJNYXJrOwoJICB2YXIgZGVmYXVsdEh3bSA9IHRoaXMub2JqZWN0TW9kZSA/IDE2IDogMTYgKiAxMDI0OwoJICB0aGlzLmhpZ2hXYXRlck1hcmsgPSBod20gfHwgaHdtID09PSAwID8gaHdtIDogZGVmYXVsdEh3bTsKCgkgIC8vIGNhc3QgdG8gaW50cy4KCSAgdGhpcy5oaWdoV2F0ZXJNYXJrID0gfiB+dGhpcy5oaWdoV2F0ZXJNYXJrOwoKCSAgLy8gQSBsaW5rZWQgbGlzdCBpcyB1c2VkIHRvIHN0b3JlIGRhdGEgY2h1bmtzIGluc3RlYWQgb2YgYW4gYXJyYXkgYmVjYXVzZSB0aGUKCSAgLy8gbGlua2VkIGxpc3QgY2FuIHJlbW92ZSBlbGVtZW50cyBmcm9tIHRoZSBiZWdpbm5pbmcgZmFzdGVyIHRoYW4KCSAgLy8gYXJyYXkuc2hpZnQoKQoJICB0aGlzLmJ1ZmZlciA9IG5ldyBCdWZmZXJMaXN0KCk7CgkgIHRoaXMubGVuZ3RoID0gMDsKCSAgdGhpcy5waXBlcyA9IG51bGw7CgkgIHRoaXMucGlwZXNDb3VudCA9IDA7CgkgIHRoaXMuZmxvd2luZyA9IG51bGw7CgkgIHRoaXMuZW5kZWQgPSBmYWxzZTsKCSAgdGhpcy5lbmRFbWl0dGVkID0gZmFsc2U7CgkgIHRoaXMucmVhZGluZyA9IGZhbHNlOwoKCSAgLy8gYSBmbGFnIHRvIGJlIGFibGUgdG8gdGVsbCBpZiB0aGUgb253cml0ZSBjYiBpcyBjYWxsZWQgaW1tZWRpYXRlbHksCgkgIC8vIG9yIG9uIGEgbGF0ZXIgdGljay4gIFdlIHNldCB0aGlzIHRvIHRydWUgYXQgZmlyc3QsIGJlY2F1c2UgYW55CgkgIC8vIGFjdGlvbnMgdGhhdCBzaG91bGRuJ3QgaGFwcGVuIHVudGlsICJsYXRlciIgc2hvdWxkIGdlbmVyYWxseSBhbHNvCgkgIC8vIG5vdCBoYXBwZW4gYmVmb3JlIHRoZSBmaXJzdCB3cml0ZSBjYWxsLgoJICB0aGlzLnN5bmMgPSB0cnVlOwoKCSAgLy8gd2hlbmV2ZXIgd2UgcmV0dXJuIG51bGwsIHRoZW4gd2Ugc2V0IGEgZmxhZyB0byBzYXkKCSAgLy8gdGhhdCB3ZSdyZSBhd2FpdGluZyBhICdyZWFkYWJsZScgZXZlbnQgZW1pc3Npb24uCgkgIHRoaXMubmVlZFJlYWRhYmxlID0gZmFsc2U7CgkgIHRoaXMuZW1pdHRlZFJlYWRhYmxlID0gZmFsc2U7CgkgIHRoaXMucmVhZGFibGVMaXN0ZW5pbmcgPSBmYWxzZTsKCSAgdGhpcy5yZXN1bWVTY2hlZHVsZWQgPSBmYWxzZTsKCgkgIC8vIENyeXB0byBpcyBraW5kIG9mIG9sZCBhbmQgY3J1c3R5LiAgSGlzdG9yaWNhbGx5LCBpdHMgZGVmYXVsdCBzdHJpbmcKCSAgLy8gZW5jb2RpbmcgaXMgJ2JpbmFyeScgc28gd2UgaGF2ZSB0byBtYWtlIHRoaXMgY29uZmlndXJhYmxlLgoJICAvLyBFdmVyeXRoaW5nIGVsc2UgaW4gdGhlIHVuaXZlcnNlIHVzZXMgJ3V0ZjgnLCB0aG91Z2guCgkgIHRoaXMuZGVmYXVsdEVuY29kaW5nID0gb3B0aW9ucy5kZWZhdWx0RW5jb2RpbmcgfHwgJ3V0ZjgnOwoKCSAgLy8gd2hlbiBwaXBpbmcsIHdlIG9ubHkgY2FyZSBhYm91dCAncmVhZGFibGUnIGV2ZW50cyB0aGF0IGhhcHBlbgoJICAvLyBhZnRlciByZWFkKClpbmcgYWxsIHRoZSBieXRlcyBhbmQgbm90IGdldHRpbmcgYW55IHB1c2hiYWNrLgoJICB0aGlzLnJhbk91dCA9IGZhbHNlOwoKCSAgLy8gdGhlIG51bWJlciBvZiB3cml0ZXJzIHRoYXQgYXJlIGF3YWl0aW5nIGEgZHJhaW4gZXZlbnQgaW4gLnBpcGUoKXMKCSAgdGhpcy5hd2FpdERyYWluID0gMDsKCgkgIC8vIGlmIHRydWUsIGEgbWF5YmVSZWFkTW9yZSBoYXMgYmVlbiBzY2hlZHVsZWQKCSAgdGhpcy5yZWFkaW5nTW9yZSA9IGZhbHNlOwoKCSAgdGhpcy5kZWNvZGVyID0gbnVsbDsKCSAgdGhpcy5lbmNvZGluZyA9IG51bGw7CgkgIGlmIChvcHRpb25zLmVuY29kaW5nKSB7CgkgICAgaWYgKCFTdHJpbmdEZWNvZGVyKSBTdHJpbmdEZWNvZGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMikuU3RyaW5nRGVjb2RlcjsKCSAgICB0aGlzLmRlY29kZXIgPSBuZXcgU3RyaW5nRGVjb2RlcihvcHRpb25zLmVuY29kaW5nKTsKCSAgICB0aGlzLmVuY29kaW5nID0gb3B0aW9ucy5lbmNvZGluZzsKCSAgfQoJfQoKCWZ1bmN0aW9uIFJlYWRhYmxlKG9wdGlvbnMpIHsKCSAgRHVwbGV4ID0gRHVwbGV4IHx8IF9fd2VicGFja19yZXF1aXJlX18oMjgpOwoKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFJlYWRhYmxlKSkgcmV0dXJuIG5ldyBSZWFkYWJsZShvcHRpb25zKTsKCgkgIHRoaXMuX3JlYWRhYmxlU3RhdGUgPSBuZXcgUmVhZGFibGVTdGF0ZShvcHRpb25zLCB0aGlzKTsKCgkgIC8vIGxlZ2FjeQoJICB0aGlzLnJlYWRhYmxlID0gdHJ1ZTsKCgkgIGlmIChvcHRpb25zICYmIHR5cGVvZiBvcHRpb25zLnJlYWQgPT09ICdmdW5jdGlvbicpIHRoaXMuX3JlYWQgPSBvcHRpb25zLnJlYWQ7CgoJICBTdHJlYW0uY2FsbCh0aGlzKTsKCX0KCgkvLyBNYW51YWxseSBzaG92ZSBzb21ldGhpbmcgaW50byB0aGUgcmVhZCgpIGJ1ZmZlci4KCS8vIFRoaXMgcmV0dXJucyB0cnVlIGlmIHRoZSBoaWdoV2F0ZXJNYXJrIGhhcyBub3QgYmVlbiBoaXQgeWV0LAoJLy8gc2ltaWxhciB0byBob3cgV3JpdGFibGUud3JpdGUoKSByZXR1cm5zIHRydWUgaWYgeW91IHNob3VsZAoJLy8gd3JpdGUoKSBzb21lIG1vcmUuCglSZWFkYWJsZS5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcpIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsKCgkgIGlmICghc3RhdGUub2JqZWN0TW9kZSAmJiB0eXBlb2YgY2h1bmsgPT09ICdzdHJpbmcnKSB7CgkgICAgZW5jb2RpbmcgPSBlbmNvZGluZyB8fCBzdGF0ZS5kZWZhdWx0RW5jb2Rpbmc7CgkgICAgaWYgKGVuY29kaW5nICE9PSBzdGF0ZS5lbmNvZGluZykgewoJICAgICAgY2h1bmsgPSBidWZmZXJTaGltLmZyb20oY2h1bmssIGVuY29kaW5nKTsKCSAgICAgIGVuY29kaW5nID0gJyc7CgkgICAgfQoJICB9CgoJICByZXR1cm4gcmVhZGFibGVBZGRDaHVuayh0aGlzLCBzdGF0ZSwgY2h1bmssIGVuY29kaW5nLCBmYWxzZSk7Cgl9OwoKCS8vIFVuc2hpZnQgc2hvdWxkICphbHdheXMqIGJlIHNvbWV0aGluZyBkaXJlY3RseSBvdXQgb2YgcmVhZCgpCglSZWFkYWJsZS5wcm90b3R5cGUudW5zaGlmdCA9IGZ1bmN0aW9uIChjaHVuaykgewoJICB2YXIgc3RhdGUgPSB0aGlzLl9yZWFkYWJsZVN0YXRlOwoJICByZXR1cm4gcmVhZGFibGVBZGRDaHVuayh0aGlzLCBzdGF0ZSwgY2h1bmssICcnLCB0cnVlKTsKCX07CgoJUmVhZGFibGUucHJvdG90eXBlLmlzUGF1c2VkID0gZnVuY3Rpb24gKCkgewoJICByZXR1cm4gdGhpcy5fcmVhZGFibGVTdGF0ZS5mbG93aW5nID09PSBmYWxzZTsKCX07CgoJZnVuY3Rpb24gcmVhZGFibGVBZGRDaHVuayhzdHJlYW0sIHN0YXRlLCBjaHVuaywgZW5jb2RpbmcsIGFkZFRvRnJvbnQpIHsKCSAgdmFyIGVyID0gY2h1bmtJbnZhbGlkKHN0YXRlLCBjaHVuayk7CgkgIGlmIChlcikgewoJICAgIHN0cmVhbS5lbWl0KCdlcnJvcicsIGVyKTsKCSAgfSBlbHNlIGlmIChjaHVuayA9PT0gbnVsbCkgewoJICAgIHN0YXRlLnJlYWRpbmcgPSBmYWxzZTsKCSAgICBvbkVvZkNodW5rKHN0cmVhbSwgc3RhdGUpOwoJICB9IGVsc2UgaWYgKHN0YXRlLm9iamVjdE1vZGUgfHwgY2h1bmsgJiYgY2h1bmsubGVuZ3RoID4gMCkgewoJICAgIGlmIChzdGF0ZS5lbmRlZCAmJiAhYWRkVG9Gcm9udCkgewoJICAgICAgdmFyIGUgPSBuZXcgRXJyb3IoJ3N0cmVhbS5wdXNoKCkgYWZ0ZXIgRU9GJyk7CgkgICAgICBzdHJlYW0uZW1pdCgnZXJyb3InLCBlKTsKCSAgICB9IGVsc2UgaWYgKHN0YXRlLmVuZEVtaXR0ZWQgJiYgYWRkVG9Gcm9udCkgewoJICAgICAgdmFyIF9lID0gbmV3IEVycm9yKCdzdHJlYW0udW5zaGlmdCgpIGFmdGVyIGVuZCBldmVudCcpOwoJICAgICAgc3RyZWFtLmVtaXQoJ2Vycm9yJywgX2UpOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgc2tpcEFkZDsKCSAgICAgIGlmIChzdGF0ZS5kZWNvZGVyICYmICFhZGRUb0Zyb250ICYmICFlbmNvZGluZykgewoJICAgICAgICBjaHVuayA9IHN0YXRlLmRlY29kZXIud3JpdGUoY2h1bmspOwoJICAgICAgICBza2lwQWRkID0gIXN0YXRlLm9iamVjdE1vZGUgJiYgY2h1bmsubGVuZ3RoID09PSAwOwoJICAgICAgfQoKCSAgICAgIGlmICghYWRkVG9Gcm9udCkgc3RhdGUucmVhZGluZyA9IGZhbHNlOwoKCSAgICAgIC8vIERvbid0IGFkZCB0byB0aGUgYnVmZmVyIGlmIHdlJ3ZlIGRlY29kZWQgdG8gYW4gZW1wdHkgc3RyaW5nIGNodW5rIGFuZAoJICAgICAgLy8gd2UncmUgbm90IGluIG9iamVjdCBtb2RlCgkgICAgICBpZiAoIXNraXBBZGQpIHsKCSAgICAgICAgLy8gaWYgd2Ugd2FudCB0aGUgZGF0YSBub3csIGp1c3QgZW1pdCBpdC4KCSAgICAgICAgaWYgKHN0YXRlLmZsb3dpbmcgJiYgc3RhdGUubGVuZ3RoID09PSAwICYmICFzdGF0ZS5zeW5jKSB7CgkgICAgICAgICAgc3RyZWFtLmVtaXQoJ2RhdGEnLCBjaHVuayk7CgkgICAgICAgICAgc3RyZWFtLnJlYWQoMCk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgLy8gdXBkYXRlIHRoZSBidWZmZXIgaW5mby4KCSAgICAgICAgICBzdGF0ZS5sZW5ndGggKz0gc3RhdGUub2JqZWN0TW9kZSA/IDEgOiBjaHVuay5sZW5ndGg7CgkgICAgICAgICAgaWYgKGFkZFRvRnJvbnQpIHN0YXRlLmJ1ZmZlci51bnNoaWZ0KGNodW5rKTtlbHNlIHN0YXRlLmJ1ZmZlci5wdXNoKGNodW5rKTsKCgkgICAgICAgICAgaWYgKHN0YXRlLm5lZWRSZWFkYWJsZSkgZW1pdFJlYWRhYmxlKHN0cmVhbSk7CgkgICAgICAgIH0KCSAgICAgIH0KCgkgICAgICBtYXliZVJlYWRNb3JlKHN0cmVhbSwgc3RhdGUpOwoJICAgIH0KCSAgfSBlbHNlIGlmICghYWRkVG9Gcm9udCkgewoJICAgIHN0YXRlLnJlYWRpbmcgPSBmYWxzZTsKCSAgfQoKCSAgcmV0dXJuIG5lZWRNb3JlRGF0YShzdGF0ZSk7Cgl9CgoJLy8gaWYgaXQncyBwYXN0IHRoZSBoaWdoIHdhdGVyIG1hcmssIHdlIGNhbiBwdXNoIGluIHNvbWUgbW9yZS4KCS8vIEFsc28sIGlmIHdlIGhhdmUgbm8gZGF0YSB5ZXQsIHdlIGNhbiBzdGFuZCBzb21lCgkvLyBtb3JlIGJ5dGVzLiAgVGhpcyBpcyB0byB3b3JrIGFyb3VuZCBjYXNlcyB3aGVyZSBod209MCwKCS8vIHN1Y2ggYXMgdGhlIHJlcGwuICBBbHNvLCBpZiB0aGUgcHVzaCgpIHRyaWdnZXJlZCBhCgkvLyByZWFkYWJsZSBldmVudCwgYW5kIHRoZSB1c2VyIGNhbGxlZCByZWFkKGxhcmdlTnVtYmVyKSBzdWNoIHRoYXQKCS8vIG5lZWRSZWFkYWJsZSB3YXMgc2V0LCB0aGVuIHdlIG91Z2h0IHRvIHB1c2ggbW9yZSwgc28gdGhhdCBhbm90aGVyCgkvLyAncmVhZGFibGUnIGV2ZW50IHdpbGwgYmUgdHJpZ2dlcmVkLgoJZnVuY3Rpb24gbmVlZE1vcmVEYXRhKHN0YXRlKSB7CgkgIHJldHVybiAhc3RhdGUuZW5kZWQgJiYgKHN0YXRlLm5lZWRSZWFkYWJsZSB8fCBzdGF0ZS5sZW5ndGggPCBzdGF0ZS5oaWdoV2F0ZXJNYXJrIHx8IHN0YXRlLmxlbmd0aCA9PT0gMCk7Cgl9CgoJLy8gYmFja3dhcmRzIGNvbXBhdGliaWxpdHkuCglSZWFkYWJsZS5wcm90b3R5cGUuc2V0RW5jb2RpbmcgPSBmdW5jdGlvbiAoZW5jKSB7CgkgIGlmICghU3RyaW5nRGVjb2RlcikgU3RyaW5nRGVjb2RlciA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpLlN0cmluZ0RlY29kZXI7CgkgIHRoaXMuX3JlYWRhYmxlU3RhdGUuZGVjb2RlciA9IG5ldyBTdHJpbmdEZWNvZGVyKGVuYyk7CgkgIHRoaXMuX3JlYWRhYmxlU3RhdGUuZW5jb2RpbmcgPSBlbmM7CgkgIHJldHVybiB0aGlzOwoJfTsKCgkvLyBEb24ndCByYWlzZSB0aGUgaHdtID4gOE1CCgl2YXIgTUFYX0hXTSA9IDB4ODAwMDAwOwoJZnVuY3Rpb24gY29tcHV0ZU5ld0hpZ2hXYXRlck1hcmsobikgewoJICBpZiAobiA+PSBNQVhfSFdNKSB7CgkgICAgbiA9IE1BWF9IV007CgkgIH0gZWxzZSB7CgkgICAgLy8gR2V0IHRoZSBuZXh0IGhpZ2hlc3QgcG93ZXIgb2YgMiB0byBwcmV2ZW50IGluY3JlYXNpbmcgaHdtIGV4Y2Vzc2l2ZWx5IGluCgkgICAgLy8gdGlueSBhbW91bnRzCgkgICAgbi0tOwoJICAgIG4gfD0gbiA+Pj4gMTsKCSAgICBuIHw9IG4gPj4+IDI7CgkgICAgbiB8PSBuID4+PiA0OwoJICAgIG4gfD0gbiA+Pj4gODsKCSAgICBuIHw9IG4gPj4+IDE2OwoJICAgIG4rKzsKCSAgfQoJICByZXR1cm4gbjsKCX0KCgkvLyBUaGlzIGZ1bmN0aW9uIGlzIGRlc2lnbmVkIHRvIGJlIGlubGluYWJsZSwgc28gcGxlYXNlIHRha2UgY2FyZSB3aGVuIG1ha2luZwoJLy8gY2hhbmdlcyB0byB0aGUgZnVuY3Rpb24gYm9keS4KCWZ1bmN0aW9uIGhvd011Y2hUb1JlYWQobiwgc3RhdGUpIHsKCSAgaWYgKG4gPD0gMCB8fCBzdGF0ZS5sZW5ndGggPT09IDAgJiYgc3RhdGUuZW5kZWQpIHJldHVybiAwOwoJICBpZiAoc3RhdGUub2JqZWN0TW9kZSkgcmV0dXJuIDE7CgkgIGlmIChuICE9PSBuKSB7CgkgICAgLy8gT25seSBmbG93IG9uZSBidWZmZXIgYXQgYSB0aW1lCgkgICAgaWYgKHN0YXRlLmZsb3dpbmcgJiYgc3RhdGUubGVuZ3RoKSByZXR1cm4gc3RhdGUuYnVmZmVyLmhlYWQuZGF0YS5sZW5ndGg7ZWxzZSByZXR1cm4gc3RhdGUubGVuZ3RoOwoJICB9CgkgIC8vIElmIHdlJ3JlIGFza2luZyBmb3IgbW9yZSB0aGFuIHRoZSBjdXJyZW50IGh3bSwgdGhlbiByYWlzZSB0aGUgaHdtLgoJICBpZiAobiA+IHN0YXRlLmhpZ2hXYXRlck1hcmspIHN0YXRlLmhpZ2hXYXRlck1hcmsgPSBjb21wdXRlTmV3SGlnaFdhdGVyTWFyayhuKTsKCSAgaWYgKG4gPD0gc3RhdGUubGVuZ3RoKSByZXR1cm4gbjsKCSAgLy8gRG9uJ3QgaGF2ZSBlbm91Z2gKCSAgaWYgKCFzdGF0ZS5lbmRlZCkgewoJICAgIHN0YXRlLm5lZWRSZWFkYWJsZSA9IHRydWU7CgkgICAgcmV0dXJuIDA7CgkgIH0KCSAgcmV0dXJuIHN0YXRlLmxlbmd0aDsKCX0KCgkvLyB5b3UgY2FuIG92ZXJyaWRlIGVpdGhlciB0aGlzIG1ldGhvZCwgb3IgdGhlIGFzeW5jIF9yZWFkKG4pIGJlbG93LgoJUmVhZGFibGUucHJvdG90eXBlLnJlYWQgPSBmdW5jdGlvbiAobikgewoJICBkZWJ1ZygncmVhZCcsIG4pOwoJICBuID0gcGFyc2VJbnQobiwgMTApOwoJICB2YXIgc3RhdGUgPSB0aGlzLl9yZWFkYWJsZVN0YXRlOwoJICB2YXIgbk9yaWcgPSBuOwoKCSAgaWYgKG4gIT09IDApIHN0YXRlLmVtaXR0ZWRSZWFkYWJsZSA9IGZhbHNlOwoKCSAgLy8gaWYgd2UncmUgZG9pbmcgcmVhZCgwKSB0byB0cmlnZ2VyIGEgcmVhZGFibGUgZXZlbnQsIGJ1dCB3ZQoJICAvLyBhbHJlYWR5IGhhdmUgYSBidW5jaCBvZiBkYXRhIGluIHRoZSBidWZmZXIsIHRoZW4ganVzdCB0cmlnZ2VyCgkgIC8vIHRoZSAncmVhZGFibGUnIGV2ZW50IGFuZCBtb3ZlIG9uLgoJICBpZiAobiA9PT0gMCAmJiBzdGF0ZS5uZWVkUmVhZGFibGUgJiYgKHN0YXRlLmxlbmd0aCA+PSBzdGF0ZS5oaWdoV2F0ZXJNYXJrIHx8IHN0YXRlLmVuZGVkKSkgewoJICAgIGRlYnVnKCdyZWFkOiBlbWl0UmVhZGFibGUnLCBzdGF0ZS5sZW5ndGgsIHN0YXRlLmVuZGVkKTsKCSAgICBpZiAoc3RhdGUubGVuZ3RoID09PSAwICYmIHN0YXRlLmVuZGVkKSBlbmRSZWFkYWJsZSh0aGlzKTtlbHNlIGVtaXRSZWFkYWJsZSh0aGlzKTsKCSAgICByZXR1cm4gbnVsbDsKCSAgfQoKCSAgbiA9IGhvd011Y2hUb1JlYWQobiwgc3RhdGUpOwoKCSAgLy8gaWYgd2UndmUgZW5kZWQsIGFuZCB3ZSdyZSBub3cgY2xlYXIsIHRoZW4gZmluaXNoIGl0IHVwLgoJICBpZiAobiA9PT0gMCAmJiBzdGF0ZS5lbmRlZCkgewoJICAgIGlmIChzdGF0ZS5sZW5ndGggPT09IDApIGVuZFJlYWRhYmxlKHRoaXMpOwoJICAgIHJldHVybiBudWxsOwoJICB9CgoJICAvLyBBbGwgdGhlIGFjdHVhbCBjaHVuayBnZW5lcmF0aW9uIGxvZ2ljIG5lZWRzIHRvIGJlCgkgIC8vICpiZWxvdyogdGhlIGNhbGwgdG8gX3JlYWQuICBUaGUgcmVhc29uIGlzIHRoYXQgaW4gY2VydGFpbgoJICAvLyBzeW50aGV0aWMgc3RyZWFtIGNhc2VzLCBzdWNoIGFzIHBhc3N0aHJvdWdoIHN0cmVhbXMsIF9yZWFkCgkgIC8vIG1heSBiZSBhIGNvbXBsZXRlbHkgc3luY2hyb25vdXMgb3BlcmF0aW9uIHdoaWNoIG1heSBjaGFuZ2UKCSAgLy8gdGhlIHN0YXRlIG9mIHRoZSByZWFkIGJ1ZmZlciwgcHJvdmlkaW5nIGVub3VnaCBkYXRhIHdoZW4KCSAgLy8gYmVmb3JlIHRoZXJlIHdhcyAqbm90KiBlbm91Z2guCgkgIC8vCgkgIC8vIFNvLCB0aGUgc3RlcHMgYXJlOgoJICAvLyAxLiBGaWd1cmUgb3V0IHdoYXQgdGhlIHN0YXRlIG9mIHRoaW5ncyB3aWxsIGJlIGFmdGVyIHdlIGRvCgkgIC8vIGEgcmVhZCBmcm9tIHRoZSBidWZmZXIuCgkgIC8vCgkgIC8vIDIuIElmIHRoYXQgcmVzdWx0aW5nIHN0YXRlIHdpbGwgdHJpZ2dlciBhIF9yZWFkLCB0aGVuIGNhbGwgX3JlYWQuCgkgIC8vIE5vdGUgdGhhdCB0aGlzIG1heSBiZSBhc3luY2hyb25vdXMsIG9yIHN5bmNocm9ub3VzLiAgWWVzLCBpdCBpcwoJICAvLyBkZWVwbHkgdWdseSB0byB3cml0ZSBBUElzIHRoaXMgd2F5LCBidXQgdGhhdCBzdGlsbCBkb2Vzbid0IG1lYW4KCSAgLy8gdGhhdCB0aGUgUmVhZGFibGUgY2xhc3Mgc2hvdWxkIGJlaGF2ZSBpbXByb3Blcmx5LCBhcyBzdHJlYW1zIGFyZQoJICAvLyBkZXNpZ25lZCB0byBiZSBzeW5jL2FzeW5jIGFnbm9zdGljLgoJICAvLyBUYWtlIG5vdGUgaWYgdGhlIF9yZWFkIGNhbGwgaXMgc3luYyBvciBhc3luYyAoaWUsIGlmIHRoZSByZWFkIGNhbGwKCSAgLy8gaGFzIHJldHVybmVkIHlldCksIHNvIHRoYXQgd2Uga25vdyB3aGV0aGVyIG9yIG5vdCBpdCdzIHNhZmUgdG8gZW1pdAoJICAvLyAncmVhZGFibGUnIGV0Yy4KCSAgLy8KCSAgLy8gMy4gQWN0dWFsbHkgcHVsbCB0aGUgcmVxdWVzdGVkIGNodW5rcyBvdXQgb2YgdGhlIGJ1ZmZlciBhbmQgcmV0dXJuLgoKCSAgLy8gaWYgd2UgbmVlZCBhIHJlYWRhYmxlIGV2ZW50LCB0aGVuIHdlIG5lZWQgdG8gZG8gc29tZSByZWFkaW5nLgoJICB2YXIgZG9SZWFkID0gc3RhdGUubmVlZFJlYWRhYmxlOwoJICBkZWJ1ZygnbmVlZCByZWFkYWJsZScsIGRvUmVhZCk7CgoJICAvLyBpZiB3ZSBjdXJyZW50bHkgaGF2ZSBsZXNzIHRoYW4gdGhlIGhpZ2hXYXRlck1hcmssIHRoZW4gYWxzbyByZWFkIHNvbWUKCSAgaWYgKHN0YXRlLmxlbmd0aCA9PT0gMCB8fCBzdGF0ZS5sZW5ndGggLSBuIDwgc3RhdGUuaGlnaFdhdGVyTWFyaykgewoJICAgIGRvUmVhZCA9IHRydWU7CgkgICAgZGVidWcoJ2xlbmd0aCBsZXNzIHRoYW4gd2F0ZXJtYXJrJywgZG9SZWFkKTsKCSAgfQoKCSAgLy8gaG93ZXZlciwgaWYgd2UndmUgZW5kZWQsIHRoZW4gdGhlcmUncyBubyBwb2ludCwgYW5kIGlmIHdlJ3JlIGFscmVhZHkKCSAgLy8gcmVhZGluZywgdGhlbiBpdCdzIHVubmVjZXNzYXJ5LgoJICBpZiAoc3RhdGUuZW5kZWQgfHwgc3RhdGUucmVhZGluZykgewoJICAgIGRvUmVhZCA9IGZhbHNlOwoJICAgIGRlYnVnKCdyZWFkaW5nIG9yIGVuZGVkJywgZG9SZWFkKTsKCSAgfSBlbHNlIGlmIChkb1JlYWQpIHsKCSAgICBkZWJ1ZygnZG8gcmVhZCcpOwoJICAgIHN0YXRlLnJlYWRpbmcgPSB0cnVlOwoJICAgIHN0YXRlLnN5bmMgPSB0cnVlOwoJICAgIC8vIGlmIHRoZSBsZW5ndGggaXMgY3VycmVudGx5IHplcm8sIHRoZW4gd2UgKm5lZWQqIGEgcmVhZGFibGUgZXZlbnQuCgkgICAgaWYgKHN0YXRlLmxlbmd0aCA9PT0gMCkgc3RhdGUubmVlZFJlYWRhYmxlID0gdHJ1ZTsKCSAgICAvLyBjYWxsIGludGVybmFsIHJlYWQgbWV0aG9kCgkgICAgdGhpcy5fcmVhZChzdGF0ZS5oaWdoV2F0ZXJNYXJrKTsKCSAgICBzdGF0ZS5zeW5jID0gZmFsc2U7CgkgICAgLy8gSWYgX3JlYWQgcHVzaGVkIGRhdGEgc3luY2hyb25vdXNseSwgdGhlbiBgcmVhZGluZ2Agd2lsbCBiZSBmYWxzZSwKCSAgICAvLyBhbmQgd2UgbmVlZCB0byByZS1ldmFsdWF0ZSBob3cgbXVjaCBkYXRhIHdlIGNhbiByZXR1cm4gdG8gdGhlIHVzZXIuCgkgICAgaWYgKCFzdGF0ZS5yZWFkaW5nKSBuID0gaG93TXVjaFRvUmVhZChuT3JpZywgc3RhdGUpOwoJICB9CgoJICB2YXIgcmV0OwoJICBpZiAobiA+IDApIHJldCA9IGZyb21MaXN0KG4sIHN0YXRlKTtlbHNlIHJldCA9IG51bGw7CgoJICBpZiAocmV0ID09PSBudWxsKSB7CgkgICAgc3RhdGUubmVlZFJlYWRhYmxlID0gdHJ1ZTsKCSAgICBuID0gMDsKCSAgfSBlbHNlIHsKCSAgICBzdGF0ZS5sZW5ndGggLT0gbjsKCSAgfQoKCSAgaWYgKHN0YXRlLmxlbmd0aCA9PT0gMCkgewoJICAgIC8vIElmIHdlIGhhdmUgbm90aGluZyBpbiB0aGUgYnVmZmVyLCB0aGVuIHdlIHdhbnQgdG8ga25vdwoJICAgIC8vIGFzIHNvb24gYXMgd2UgKmRvKiBnZXQgc29tZXRoaW5nIGludG8gdGhlIGJ1ZmZlci4KCSAgICBpZiAoIXN0YXRlLmVuZGVkKSBzdGF0ZS5uZWVkUmVhZGFibGUgPSB0cnVlOwoKCSAgICAvLyBJZiB3ZSB0cmllZCB0byByZWFkKCkgcGFzdCB0aGUgRU9GLCB0aGVuIGVtaXQgZW5kIG9uIHRoZSBuZXh0IHRpY2suCgkgICAgaWYgKG5PcmlnICE9PSBuICYmIHN0YXRlLmVuZGVkKSBlbmRSZWFkYWJsZSh0aGlzKTsKCSAgfQoKCSAgaWYgKHJldCAhPT0gbnVsbCkgdGhpcy5lbWl0KCdkYXRhJywgcmV0KTsKCgkgIHJldHVybiByZXQ7Cgl9OwoKCWZ1bmN0aW9uIGNodW5rSW52YWxpZChzdGF0ZSwgY2h1bmspIHsKCSAgdmFyIGVyID0gbnVsbDsKCSAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoY2h1bmspICYmIHR5cGVvZiBjaHVuayAhPT0gJ3N0cmluZycgJiYgY2h1bmsgIT09IG51bGwgJiYgY2h1bmsgIT09IHVuZGVmaW5lZCAmJiAhc3RhdGUub2JqZWN0TW9kZSkgewoJICAgIGVyID0gbmV3IFR5cGVFcnJvcignSW52YWxpZCBub24tc3RyaW5nL2J1ZmZlciBjaHVuaycpOwoJICB9CgkgIHJldHVybiBlcjsKCX0KCglmdW5jdGlvbiBvbkVvZkNodW5rKHN0cmVhbSwgc3RhdGUpIHsKCSAgaWYgKHN0YXRlLmVuZGVkKSByZXR1cm47CgkgIGlmIChzdGF0ZS5kZWNvZGVyKSB7CgkgICAgdmFyIGNodW5rID0gc3RhdGUuZGVjb2Rlci5lbmQoKTsKCSAgICBpZiAoY2h1bmsgJiYgY2h1bmsubGVuZ3RoKSB7CgkgICAgICBzdGF0ZS5idWZmZXIucHVzaChjaHVuayk7CgkgICAgICBzdGF0ZS5sZW5ndGggKz0gc3RhdGUub2JqZWN0TW9kZSA/IDEgOiBjaHVuay5sZW5ndGg7CgkgICAgfQoJICB9CgkgIHN0YXRlLmVuZGVkID0gdHJ1ZTsKCgkgIC8vIGVtaXQgJ3JlYWRhYmxlJyBub3cgdG8gbWFrZSBzdXJlIGl0IGdldHMgcGlja2VkIHVwLgoJICBlbWl0UmVhZGFibGUoc3RyZWFtKTsKCX0KCgkvLyBEb24ndCBlbWl0IHJlYWRhYmxlIHJpZ2h0IGF3YXkgaW4gc3luYyBtb2RlLCBiZWNhdXNlIHRoaXMgY2FuIHRyaWdnZXIKCS8vIGFub3RoZXIgcmVhZCgpIGNhbGwgPT4gc3RhY2sgb3ZlcmZsb3cuICBUaGlzIHdheSwgaXQgbWlnaHQgdHJpZ2dlcgoJLy8gYSBuZXh0VGljayByZWN1cnNpb24gd2FybmluZywgYnV0IHRoYXQncyBub3Qgc28gYmFkLgoJZnVuY3Rpb24gZW1pdFJlYWRhYmxlKHN0cmVhbSkgewoJICB2YXIgc3RhdGUgPSBzdHJlYW0uX3JlYWRhYmxlU3RhdGU7CgkgIHN0YXRlLm5lZWRSZWFkYWJsZSA9IGZhbHNlOwoJICBpZiAoIXN0YXRlLmVtaXR0ZWRSZWFkYWJsZSkgewoJICAgIGRlYnVnKCdlbWl0UmVhZGFibGUnLCBzdGF0ZS5mbG93aW5nKTsKCSAgICBzdGF0ZS5lbWl0dGVkUmVhZGFibGUgPSB0cnVlOwoJICAgIGlmIChzdGF0ZS5zeW5jKSBwcm9jZXNzTmV4dFRpY2soZW1pdFJlYWRhYmxlXywgc3RyZWFtKTtlbHNlIGVtaXRSZWFkYWJsZV8oc3RyZWFtKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIGVtaXRSZWFkYWJsZV8oc3RyZWFtKSB7CgkgIGRlYnVnKCdlbWl0IHJlYWRhYmxlJyk7CgkgIHN0cmVhbS5lbWl0KCdyZWFkYWJsZScpOwoJICBmbG93KHN0cmVhbSk7Cgl9CgoJLy8gYXQgdGhpcyBwb2ludCwgdGhlIHVzZXIgaGFzIHByZXN1bWFibHkgc2VlbiB0aGUgJ3JlYWRhYmxlJyBldmVudCwKCS8vIGFuZCBjYWxsZWQgcmVhZCgpIHRvIGNvbnN1bWUgc29tZSBkYXRhLiAgdGhhdCBtYXkgaGF2ZSB0cmlnZ2VyZWQKCS8vIGluIHR1cm4gYW5vdGhlciBfcmVhZChuKSBjYWxsLCBpbiB3aGljaCBjYXNlIHJlYWRpbmcgPSB0cnVlIGlmCgkvLyBpdCdzIGluIHByb2dyZXNzLgoJLy8gSG93ZXZlciwgaWYgd2UncmUgbm90IGVuZGVkLCBvciByZWFkaW5nLCBhbmQgdGhlIGxlbmd0aCA8IGh3bSwKCS8vIHRoZW4gZ28gYWhlYWQgYW5kIHRyeSB0byByZWFkIHNvbWUgbW9yZSBwcmVlbXB0aXZlbHkuCglmdW5jdGlvbiBtYXliZVJlYWRNb3JlKHN0cmVhbSwgc3RhdGUpIHsKCSAgaWYgKCFzdGF0ZS5yZWFkaW5nTW9yZSkgewoJICAgIHN0YXRlLnJlYWRpbmdNb3JlID0gdHJ1ZTsKCSAgICBwcm9jZXNzTmV4dFRpY2sobWF5YmVSZWFkTW9yZV8sIHN0cmVhbSwgc3RhdGUpOwoJICB9Cgl9CgoJZnVuY3Rpb24gbWF5YmVSZWFkTW9yZV8oc3RyZWFtLCBzdGF0ZSkgewoJICB2YXIgbGVuID0gc3RhdGUubGVuZ3RoOwoJICB3aGlsZSAoIXN0YXRlLnJlYWRpbmcgJiYgIXN0YXRlLmZsb3dpbmcgJiYgIXN0YXRlLmVuZGVkICYmIHN0YXRlLmxlbmd0aCA8IHN0YXRlLmhpZ2hXYXRlck1hcmspIHsKCSAgICBkZWJ1ZygnbWF5YmVSZWFkTW9yZSByZWFkIDAnKTsKCSAgICBzdHJlYW0ucmVhZCgwKTsKCSAgICBpZiAobGVuID09PSBzdGF0ZS5sZW5ndGgpCgkgICAgICAvLyBkaWRuJ3QgZ2V0IGFueSBkYXRhLCBzdG9wIHNwaW5uaW5nLgoJICAgICAgYnJlYWs7ZWxzZSBsZW4gPSBzdGF0ZS5sZW5ndGg7CgkgIH0KCSAgc3RhdGUucmVhZGluZ01vcmUgPSBmYWxzZTsKCX0KCgkvLyBhYnN0cmFjdCBtZXRob2QuICB0byBiZSBvdmVycmlkZGVuIGluIHNwZWNpZmljIGltcGxlbWVudGF0aW9uIGNsYXNzZXMuCgkvLyBjYWxsIGNiKGVyLCBkYXRhKSB3aGVyZSBkYXRhIGlzIDw9IG4gaW4gbGVuZ3RoLgoJLy8gZm9yIHZpcnR1YWwgKG5vbi1zdHJpbmcsIG5vbi1idWZmZXIpIHN0cmVhbXMsICJsZW5ndGgiIGlzIHNvbWV3aGF0CgkvLyBhcmJpdHJhcnksIGFuZCBwZXJoYXBzIG5vdCB2ZXJ5IG1lYW5pbmdmdWwuCglSZWFkYWJsZS5wcm90b3R5cGUuX3JlYWQgPSBmdW5jdGlvbiAobikgewoJICB0aGlzLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdfcmVhZCgpIGlzIG5vdCBpbXBsZW1lbnRlZCcpKTsKCX07CgoJUmVhZGFibGUucHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbiAoZGVzdCwgcGlwZU9wdHMpIHsKCSAgdmFyIHNyYyA9IHRoaXM7CgkgIHZhciBzdGF0ZSA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgoJICBzd2l0Y2ggKHN0YXRlLnBpcGVzQ291bnQpIHsKCSAgICBjYXNlIDA6CgkgICAgICBzdGF0ZS5waXBlcyA9IGRlc3Q7CgkgICAgICBicmVhazsKCSAgICBjYXNlIDE6CgkgICAgICBzdGF0ZS5waXBlcyA9IFtzdGF0ZS5waXBlcywgZGVzdF07CgkgICAgICBicmVhazsKCSAgICBkZWZhdWx0OgoJICAgICAgc3RhdGUucGlwZXMucHVzaChkZXN0KTsKCSAgICAgIGJyZWFrOwoJICB9CgkgIHN0YXRlLnBpcGVzQ291bnQgKz0gMTsKCSAgZGVidWcoJ3BpcGUgY291bnQ9JWQgb3B0cz0laicsIHN0YXRlLnBpcGVzQ291bnQsIHBpcGVPcHRzKTsKCgkgIHZhciBkb0VuZCA9ICghcGlwZU9wdHMgfHwgcGlwZU9wdHMuZW5kICE9PSBmYWxzZSkgJiYgZGVzdCAhPT0gcHJvY2Vzcy5zdGRvdXQgJiYgZGVzdCAhPT0gcHJvY2Vzcy5zdGRlcnI7CgoJICB2YXIgZW5kRm4gPSBkb0VuZCA/IG9uZW5kIDogY2xlYW51cDsKCSAgaWYgKHN0YXRlLmVuZEVtaXR0ZWQpIHByb2Nlc3NOZXh0VGljayhlbmRGbik7ZWxzZSBzcmMub25jZSgnZW5kJywgZW5kRm4pOwoKCSAgZGVzdC5vbigndW5waXBlJywgb251bnBpcGUpOwoJICBmdW5jdGlvbiBvbnVucGlwZShyZWFkYWJsZSkgewoJICAgIGRlYnVnKCdvbnVucGlwZScpOwoJICAgIGlmIChyZWFkYWJsZSA9PT0gc3JjKSB7CgkgICAgICBjbGVhbnVwKCk7CgkgICAgfQoJICB9CgoJICBmdW5jdGlvbiBvbmVuZCgpIHsKCSAgICBkZWJ1Zygnb25lbmQnKTsKCSAgICBkZXN0LmVuZCgpOwoJICB9CgoJICAvLyB3aGVuIHRoZSBkZXN0IGRyYWlucywgaXQgcmVkdWNlcyB0aGUgYXdhaXREcmFpbiBjb3VudGVyCgkgIC8vIG9uIHRoZSBzb3VyY2UuICBUaGlzIHdvdWxkIGJlIG1vcmUgZWxlZ2FudCB3aXRoIGEgLm9uY2UoKQoJICAvLyBoYW5kbGVyIGluIGZsb3coKSwgYnV0IGFkZGluZyBhbmQgcmVtb3ZpbmcgcmVwZWF0ZWRseSBpcwoJICAvLyB0b28gc2xvdy4KCSAgdmFyIG9uZHJhaW4gPSBwaXBlT25EcmFpbihzcmMpOwoJICBkZXN0Lm9uKCdkcmFpbicsIG9uZHJhaW4pOwoKCSAgdmFyIGNsZWFuZWRVcCA9IGZhbHNlOwoJICBmdW5jdGlvbiBjbGVhbnVwKCkgewoJICAgIGRlYnVnKCdjbGVhbnVwJyk7CgkgICAgLy8gY2xlYW51cCBldmVudCBoYW5kbGVycyBvbmNlIHRoZSBwaXBlIGlzIGJyb2tlbgoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2Nsb3NlJywgb25jbG9zZSk7CgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignZmluaXNoJywgb25maW5pc2gpOwoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2RyYWluJywgb25kcmFpbik7CgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBvbmVycm9yKTsKCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCd1bnBpcGUnLCBvbnVucGlwZSk7CgkgICAgc3JjLnJlbW92ZUxpc3RlbmVyKCdlbmQnLCBvbmVuZCk7CgkgICAgc3JjLnJlbW92ZUxpc3RlbmVyKCdlbmQnLCBjbGVhbnVwKTsKCSAgICBzcmMucmVtb3ZlTGlzdGVuZXIoJ2RhdGEnLCBvbmRhdGEpOwoKCSAgICBjbGVhbmVkVXAgPSB0cnVlOwoKCSAgICAvLyBpZiB0aGUgcmVhZGVyIGlzIHdhaXRpbmcgZm9yIGEgZHJhaW4gZXZlbnQgZnJvbSB0aGlzCgkgICAgLy8gc3BlY2lmaWMgd3JpdGVyLCB0aGVuIGl0IHdvdWxkIGNhdXNlIGl0IHRvIG5ldmVyIHN0YXJ0CgkgICAgLy8gZmxvd2luZyBhZ2Fpbi4KCSAgICAvLyBTbywgaWYgdGhpcyBpcyBhd2FpdGluZyBhIGRyYWluLCB0aGVuIHdlIGp1c3QgY2FsbCBpdCBub3cuCgkgICAgLy8gSWYgd2UgZG9uJ3Qga25vdywgdGhlbiBhc3N1bWUgdGhhdCB3ZSBhcmUgd2FpdGluZyBmb3Igb25lLgoJICAgIGlmIChzdGF0ZS5hd2FpdERyYWluICYmICghZGVzdC5fd3JpdGFibGVTdGF0ZSB8fCBkZXN0Ll93cml0YWJsZVN0YXRlLm5lZWREcmFpbikpIG9uZHJhaW4oKTsKCSAgfQoKCSAgLy8gSWYgdGhlIHVzZXIgcHVzaGVzIG1vcmUgZGF0YSB3aGlsZSB3ZSdyZSB3cml0aW5nIHRvIGRlc3QgdGhlbiB3ZSdsbCBlbmQgdXAKCSAgLy8gaW4gb25kYXRhIGFnYWluLiBIb3dldmVyLCB3ZSBvbmx5IHdhbnQgdG8gaW5jcmVhc2UgYXdhaXREcmFpbiBvbmNlIGJlY2F1c2UKCSAgLy8gZGVzdCB3aWxsIG9ubHkgZW1pdCBvbmUgJ2RyYWluJyBldmVudCBmb3IgdGhlIG11bHRpcGxlIHdyaXRlcy4KCSAgLy8gPT4gSW50cm9kdWNlIGEgZ3VhcmQgb24gaW5jcmVhc2luZyBhd2FpdERyYWluLgoJICB2YXIgaW5jcmVhc2VkQXdhaXREcmFpbiA9IGZhbHNlOwoJICBzcmMub24oJ2RhdGEnLCBvbmRhdGEpOwoJICBmdW5jdGlvbiBvbmRhdGEoY2h1bmspIHsKCSAgICBkZWJ1Zygnb25kYXRhJyk7CgkgICAgaW5jcmVhc2VkQXdhaXREcmFpbiA9IGZhbHNlOwoJICAgIHZhciByZXQgPSBkZXN0LndyaXRlKGNodW5rKTsKCSAgICBpZiAoZmFsc2UgPT09IHJldCAmJiAhaW5jcmVhc2VkQXdhaXREcmFpbikgewoJICAgICAgLy8gSWYgdGhlIHVzZXIgdW5waXBlZCBkdXJpbmcgYGRlc3Qud3JpdGUoKWAsIGl0IGlzIHBvc3NpYmxlCgkgICAgICAvLyB0byBnZXQgc3R1Y2sgaW4gYSBwZXJtYW5lbnRseSBwYXVzZWQgc3RhdGUgaWYgdGhhdCB3cml0ZQoJICAgICAgLy8gYWxzbyByZXR1cm5lZCBmYWxzZS4KCSAgICAgIC8vID0+IENoZWNrIHdoZXRoZXIgYGRlc3RgIGlzIHN0aWxsIGEgcGlwaW5nIGRlc3RpbmF0aW9uLgoJICAgICAgaWYgKChzdGF0ZS5waXBlc0NvdW50ID09PSAxICYmIHN0YXRlLnBpcGVzID09PSBkZXN0IHx8IHN0YXRlLnBpcGVzQ291bnQgPiAxICYmIGluZGV4T2Yoc3RhdGUucGlwZXMsIGRlc3QpICE9PSAtMSkgJiYgIWNsZWFuZWRVcCkgewoJICAgICAgICBkZWJ1ZygnZmFsc2Ugd3JpdGUgcmVzcG9uc2UsIHBhdXNlJywgc3JjLl9yZWFkYWJsZVN0YXRlLmF3YWl0RHJhaW4pOwoJICAgICAgICBzcmMuX3JlYWRhYmxlU3RhdGUuYXdhaXREcmFpbisrOwoJICAgICAgICBpbmNyZWFzZWRBd2FpdERyYWluID0gdHJ1ZTsKCSAgICAgIH0KCSAgICAgIHNyYy5wYXVzZSgpOwoJICAgIH0KCSAgfQoKCSAgLy8gaWYgdGhlIGRlc3QgaGFzIGFuIGVycm9yLCB0aGVuIHN0b3AgcGlwaW5nIGludG8gaXQuCgkgIC8vIGhvd2V2ZXIsIGRvbid0IHN1cHByZXNzIHRoZSB0aHJvd2luZyBiZWhhdmlvciBmb3IgdGhpcy4KCSAgZnVuY3Rpb24gb25lcnJvcihlcikgewoJICAgIGRlYnVnKCdvbmVycm9yJywgZXIpOwoJICAgIHVucGlwZSgpOwoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25lcnJvcik7CgkgICAgaWYgKEVFbGlzdGVuZXJDb3VudChkZXN0LCAnZXJyb3InKSA9PT0gMCkgZGVzdC5lbWl0KCdlcnJvcicsIGVyKTsKCSAgfQoKCSAgLy8gTWFrZSBzdXJlIG91ciBlcnJvciBoYW5kbGVyIGlzIGF0dGFjaGVkIGJlZm9yZSB1c2VybGFuZCBvbmVzLgoJICBwcmVwZW5kTGlzdGVuZXIoZGVzdCwgJ2Vycm9yJywgb25lcnJvcik7CgoJICAvLyBCb3RoIGNsb3NlIGFuZCBmaW5pc2ggc2hvdWxkIHRyaWdnZXIgdW5waXBlLCBidXQgb25seSBvbmNlLgoJICBmdW5jdGlvbiBvbmNsb3NlKCkgewoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2ZpbmlzaCcsIG9uZmluaXNoKTsKCSAgICB1bnBpcGUoKTsKCSAgfQoJICBkZXN0Lm9uY2UoJ2Nsb3NlJywgb25jbG9zZSk7CgkgIGZ1bmN0aW9uIG9uZmluaXNoKCkgewoJICAgIGRlYnVnKCdvbmZpbmlzaCcpOwoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2Nsb3NlJywgb25jbG9zZSk7CgkgICAgdW5waXBlKCk7CgkgIH0KCSAgZGVzdC5vbmNlKCdmaW5pc2gnLCBvbmZpbmlzaCk7CgoJICBmdW5jdGlvbiB1bnBpcGUoKSB7CgkgICAgZGVidWcoJ3VucGlwZScpOwoJICAgIHNyYy51bnBpcGUoZGVzdCk7CgkgIH0KCgkgIC8vIHRlbGwgdGhlIGRlc3QgdGhhdCBpdCdzIGJlaW5nIHBpcGVkIHRvCgkgIGRlc3QuZW1pdCgncGlwZScsIHNyYyk7CgoJICAvLyBzdGFydCB0aGUgZmxvdyBpZiBpdCBoYXNuJ3QgYmVlbiBzdGFydGVkIGFscmVhZHkuCgkgIGlmICghc3RhdGUuZmxvd2luZykgewoJICAgIGRlYnVnKCdwaXBlIHJlc3VtZScpOwoJICAgIHNyYy5yZXN1bWUoKTsKCSAgfQoKCSAgcmV0dXJuIGRlc3Q7Cgl9OwoKCWZ1bmN0aW9uIHBpcGVPbkRyYWluKHNyYykgewoJICByZXR1cm4gZnVuY3Rpb24gKCkgewoJICAgIHZhciBzdGF0ZSA9IHNyYy5fcmVhZGFibGVTdGF0ZTsKCSAgICBkZWJ1ZygncGlwZU9uRHJhaW4nLCBzdGF0ZS5hd2FpdERyYWluKTsKCSAgICBpZiAoc3RhdGUuYXdhaXREcmFpbikgc3RhdGUuYXdhaXREcmFpbi0tOwoJICAgIGlmIChzdGF0ZS5hd2FpdERyYWluID09PSAwICYmIEVFbGlzdGVuZXJDb3VudChzcmMsICdkYXRhJykpIHsKCSAgICAgIHN0YXRlLmZsb3dpbmcgPSB0cnVlOwoJICAgICAgZmxvdyhzcmMpOwoJICAgIH0KCSAgfTsKCX0KCglSZWFkYWJsZS5wcm90b3R5cGUudW5waXBlID0gZnVuY3Rpb24gKGRlc3QpIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsKCgkgIC8vIGlmIHdlJ3JlIG5vdCBwaXBpbmcgYW55d2hlcmUsIHRoZW4gZG8gbm90aGluZy4KCSAgaWYgKHN0YXRlLnBpcGVzQ291bnQgPT09IDApIHJldHVybiB0aGlzOwoKCSAgLy8ganVzdCBvbmUgZGVzdGluYXRpb24uICBtb3N0IGNvbW1vbiBjYXNlLgoJICBpZiAoc3RhdGUucGlwZXNDb3VudCA9PT0gMSkgewoJICAgIC8vIHBhc3NlZCBpbiBvbmUsIGJ1dCBpdCdzIG5vdCB0aGUgcmlnaHQgb25lLgoJICAgIGlmIChkZXN0ICYmIGRlc3QgIT09IHN0YXRlLnBpcGVzKSByZXR1cm4gdGhpczsKCgkgICAgaWYgKCFkZXN0KSBkZXN0ID0gc3RhdGUucGlwZXM7CgoJICAgIC8vIGdvdCBhIG1hdGNoLgoJICAgIHN0YXRlLnBpcGVzID0gbnVsbDsKCSAgICBzdGF0ZS5waXBlc0NvdW50ID0gMDsKCSAgICBzdGF0ZS5mbG93aW5nID0gZmFsc2U7CgkgICAgaWYgKGRlc3QpIGRlc3QuZW1pdCgndW5waXBlJywgdGhpcyk7CgkgICAgcmV0dXJuIHRoaXM7CgkgIH0KCgkgIC8vIHNsb3cgY2FzZS4gbXVsdGlwbGUgcGlwZSBkZXN0aW5hdGlvbnMuCgoJICBpZiAoIWRlc3QpIHsKCSAgICAvLyByZW1vdmUgYWxsLgoJICAgIHZhciBkZXN0cyA9IHN0YXRlLnBpcGVzOwoJICAgIHZhciBsZW4gPSBzdGF0ZS5waXBlc0NvdW50OwoJICAgIHN0YXRlLnBpcGVzID0gbnVsbDsKCSAgICBzdGF0ZS5waXBlc0NvdW50ID0gMDsKCSAgICBzdGF0ZS5mbG93aW5nID0gZmFsc2U7CgoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKCSAgICAgIGRlc3RzW2ldLmVtaXQoJ3VucGlwZScsIHRoaXMpOwoJICAgIH1yZXR1cm4gdGhpczsKCSAgfQoKCSAgLy8gdHJ5IHRvIGZpbmQgdGhlIHJpZ2h0IG9uZS4KCSAgdmFyIGluZGV4ID0gaW5kZXhPZihzdGF0ZS5waXBlcywgZGVzdCk7CgkgIGlmIChpbmRleCA9PT0gLTEpIHJldHVybiB0aGlzOwoKCSAgc3RhdGUucGlwZXMuc3BsaWNlKGluZGV4LCAxKTsKCSAgc3RhdGUucGlwZXNDb3VudCAtPSAxOwoJICBpZiAoc3RhdGUucGlwZXNDb3VudCA9PT0gMSkgc3RhdGUucGlwZXMgPSBzdGF0ZS5waXBlc1swXTsKCgkgIGRlc3QuZW1pdCgndW5waXBlJywgdGhpcyk7CgoJICByZXR1cm4gdGhpczsKCX07CgoJLy8gc2V0IHVwIGRhdGEgZXZlbnRzIGlmIHRoZXkgYXJlIGFza2VkIGZvcgoJLy8gRW5zdXJlIHJlYWRhYmxlIGxpc3RlbmVycyBldmVudHVhbGx5IGdldCBzb21ldGhpbmcKCVJlYWRhYmxlLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldiwgZm4pIHsKCSAgdmFyIHJlcyA9IFN0cmVhbS5wcm90b3R5cGUub24uY2FsbCh0aGlzLCBldiwgZm4pOwoKCSAgaWYgKGV2ID09PSAnZGF0YScpIHsKCSAgICAvLyBTdGFydCBmbG93aW5nIG9uIG5leHQgdGljayBpZiBzdHJlYW0gaXNuJ3QgZXhwbGljaXRseSBwYXVzZWQKCSAgICBpZiAodGhpcy5fcmVhZGFibGVTdGF0ZS5mbG93aW5nICE9PSBmYWxzZSkgdGhpcy5yZXN1bWUoKTsKCSAgfSBlbHNlIGlmIChldiA9PT0gJ3JlYWRhYmxlJykgewoJICAgIHZhciBzdGF0ZSA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgkgICAgaWYgKCFzdGF0ZS5lbmRFbWl0dGVkICYmICFzdGF0ZS5yZWFkYWJsZUxpc3RlbmluZykgewoJICAgICAgc3RhdGUucmVhZGFibGVMaXN0ZW5pbmcgPSBzdGF0ZS5uZWVkUmVhZGFibGUgPSB0cnVlOwoJICAgICAgc3RhdGUuZW1pdHRlZFJlYWRhYmxlID0gZmFsc2U7CgkgICAgICBpZiAoIXN0YXRlLnJlYWRpbmcpIHsKCSAgICAgICAgcHJvY2Vzc05leHRUaWNrKG5SZWFkaW5nTmV4dFRpY2ssIHRoaXMpOwoJICAgICAgfSBlbHNlIGlmIChzdGF0ZS5sZW5ndGgpIHsKCSAgICAgICAgZW1pdFJlYWRhYmxlKHRoaXMsIHN0YXRlKTsKCSAgICAgIH0KCSAgICB9CgkgIH0KCgkgIHJldHVybiByZXM7Cgl9OwoJUmVhZGFibGUucHJvdG90eXBlLmFkZExpc3RlbmVyID0gUmVhZGFibGUucHJvdG90eXBlLm9uOwoKCWZ1bmN0aW9uIG5SZWFkaW5nTmV4dFRpY2soc2VsZikgewoJICBkZWJ1ZygncmVhZGFibGUgbmV4dHRpY2sgcmVhZCAwJyk7CgkgIHNlbGYucmVhZCgwKTsKCX0KCgkvLyBwYXVzZSgpIGFuZCByZXN1bWUoKSBhcmUgcmVtbmFudHMgb2YgdGhlIGxlZ2FjeSByZWFkYWJsZSBzdHJlYW0gQVBJCgkvLyBJZiB0aGUgdXNlciB1c2VzIHRoZW0sIHRoZW4gc3dpdGNoIGludG8gb2xkIG1vZGUuCglSZWFkYWJsZS5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkgewoJICB2YXIgc3RhdGUgPSB0aGlzLl9yZWFkYWJsZVN0YXRlOwoJICBpZiAoIXN0YXRlLmZsb3dpbmcpIHsKCSAgICBkZWJ1ZygncmVzdW1lJyk7CgkgICAgc3RhdGUuZmxvd2luZyA9IHRydWU7CgkgICAgcmVzdW1lKHRoaXMsIHN0YXRlKTsKCSAgfQoJICByZXR1cm4gdGhpczsKCX07CgoJZnVuY3Rpb24gcmVzdW1lKHN0cmVhbSwgc3RhdGUpIHsKCSAgaWYgKCFzdGF0ZS5yZXN1bWVTY2hlZHVsZWQpIHsKCSAgICBzdGF0ZS5yZXN1bWVTY2hlZHVsZWQgPSB0cnVlOwoJICAgIHByb2Nlc3NOZXh0VGljayhyZXN1bWVfLCBzdHJlYW0sIHN0YXRlKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIHJlc3VtZV8oc3RyZWFtLCBzdGF0ZSkgewoJICBpZiAoIXN0YXRlLnJlYWRpbmcpIHsKCSAgICBkZWJ1ZygncmVzdW1lIHJlYWQgMCcpOwoJICAgIHN0cmVhbS5yZWFkKDApOwoJICB9CgoJICBzdGF0ZS5yZXN1bWVTY2hlZHVsZWQgPSBmYWxzZTsKCSAgc3RhdGUuYXdhaXREcmFpbiA9IDA7CgkgIHN0cmVhbS5lbWl0KCdyZXN1bWUnKTsKCSAgZmxvdyhzdHJlYW0pOwoJICBpZiAoc3RhdGUuZmxvd2luZyAmJiAhc3RhdGUucmVhZGluZykgc3RyZWFtLnJlYWQoMCk7Cgl9CgoJUmVhZGFibGUucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKCkgewoJICBkZWJ1ZygnY2FsbCBwYXVzZSBmbG93aW5nPSVqJywgdGhpcy5fcmVhZGFibGVTdGF0ZS5mbG93aW5nKTsKCSAgaWYgKGZhbHNlICE9PSB0aGlzLl9yZWFkYWJsZVN0YXRlLmZsb3dpbmcpIHsKCSAgICBkZWJ1ZygncGF1c2UnKTsKCSAgICB0aGlzLl9yZWFkYWJsZVN0YXRlLmZsb3dpbmcgPSBmYWxzZTsKCSAgICB0aGlzLmVtaXQoJ3BhdXNlJyk7CgkgIH0KCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCWZ1bmN0aW9uIGZsb3coc3RyZWFtKSB7CgkgIHZhciBzdGF0ZSA9IHN0cmVhbS5fcmVhZGFibGVTdGF0ZTsKCSAgZGVidWcoJ2Zsb3cnLCBzdGF0ZS5mbG93aW5nKTsKCSAgd2hpbGUgKHN0YXRlLmZsb3dpbmcgJiYgc3RyZWFtLnJlYWQoKSAhPT0gbnVsbCkge30KCX0KCgkvLyB3cmFwIGFuIG9sZC1zdHlsZSBzdHJlYW0gYXMgdGhlIGFzeW5jIGRhdGEgc291cmNlLgoJLy8gVGhpcyBpcyAqbm90KiBwYXJ0IG9mIHRoZSByZWFkYWJsZSBzdHJlYW0gaW50ZXJmYWNlLgoJLy8gSXQgaXMgYW4gdWdseSB1bmZvcnR1bmF0ZSBtZXNzIG9mIGhpc3RvcnkuCglSZWFkYWJsZS5wcm90b3R5cGUud3JhcCA9IGZ1bmN0aW9uIChzdHJlYW0pIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsKCSAgdmFyIHBhdXNlZCA9IGZhbHNlOwoKCSAgdmFyIHNlbGYgPSB0aGlzOwoJICBzdHJlYW0ub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsKCSAgICBkZWJ1Zygnd3JhcHBlZCBlbmQnKTsKCSAgICBpZiAoc3RhdGUuZGVjb2RlciAmJiAhc3RhdGUuZW5kZWQpIHsKCSAgICAgIHZhciBjaHVuayA9IHN0YXRlLmRlY29kZXIuZW5kKCk7CgkgICAgICBpZiAoY2h1bmsgJiYgY2h1bmsubGVuZ3RoKSBzZWxmLnB1c2goY2h1bmspOwoJICAgIH0KCgkgICAgc2VsZi5wdXNoKG51bGwpOwoJICB9KTsKCgkgIHN0cmVhbS5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewoJICAgIGRlYnVnKCd3cmFwcGVkIGRhdGEnKTsKCSAgICBpZiAoc3RhdGUuZGVjb2RlcikgY2h1bmsgPSBzdGF0ZS5kZWNvZGVyLndyaXRlKGNodW5rKTsKCgkgICAgLy8gZG9uJ3Qgc2tpcCBvdmVyIGZhbHN5IHZhbHVlcyBpbiBvYmplY3RNb2RlCgkgICAgaWYgKHN0YXRlLm9iamVjdE1vZGUgJiYgKGNodW5rID09PSBudWxsIHx8IGNodW5rID09PSB1bmRlZmluZWQpKSByZXR1cm47ZWxzZSBpZiAoIXN0YXRlLm9iamVjdE1vZGUgJiYgKCFjaHVuayB8fCAhY2h1bmsubGVuZ3RoKSkgcmV0dXJuOwoKCSAgICB2YXIgcmV0ID0gc2VsZi5wdXNoKGNodW5rKTsKCSAgICBpZiAoIXJldCkgewoJICAgICAgcGF1c2VkID0gdHJ1ZTsKCSAgICAgIHN0cmVhbS5wYXVzZSgpOwoJICAgIH0KCSAgfSk7CgoJICAvLyBwcm94eSBhbGwgdGhlIG90aGVyIG1ldGhvZHMuCgkgIC8vIGltcG9ydGFudCB3aGVuIHdyYXBwaW5nIGZpbHRlcnMgYW5kIGR1cGxleGVzLgoJICBmb3IgKHZhciBpIGluIHN0cmVhbSkgewoJICAgIGlmICh0aGlzW2ldID09PSB1bmRlZmluZWQgJiYgdHlwZW9mIHN0cmVhbVtpXSA9PT0gJ2Z1bmN0aW9uJykgewoJICAgICAgdGhpc1tpXSA9IGZ1bmN0aW9uIChtZXRob2QpIHsKCSAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICByZXR1cm4gc3RyZWFtW21ldGhvZF0uYXBwbHkoc3RyZWFtLCBhcmd1bWVudHMpOwoJICAgICAgICB9OwoJICAgICAgfShpKTsKCSAgICB9CgkgIH0KCgkgIC8vIHByb3h5IGNlcnRhaW4gaW1wb3J0YW50IGV2ZW50cy4KCSAgdmFyIGV2ZW50cyA9IFsnZXJyb3InLCAnY2xvc2UnLCAnZGVzdHJveScsICdwYXVzZScsICdyZXN1bWUnXTsKCSAgZm9yRWFjaChldmVudHMsIGZ1bmN0aW9uIChldikgewoJICAgIHN0cmVhbS5vbihldiwgc2VsZi5lbWl0LmJpbmQoc2VsZiwgZXYpKTsKCSAgfSk7CgoJICAvLyB3aGVuIHdlIHRyeSB0byBjb25zdW1lIHNvbWUgbW9yZSBieXRlcywgc2ltcGx5IHVucGF1c2UgdGhlCgkgIC8vIHVuZGVybHlpbmcgc3RyZWFtLgoJICBzZWxmLl9yZWFkID0gZnVuY3Rpb24gKG4pIHsKCSAgICBkZWJ1Zygnd3JhcHBlZCBfcmVhZCcsIG4pOwoJICAgIGlmIChwYXVzZWQpIHsKCSAgICAgIHBhdXNlZCA9IGZhbHNlOwoJICAgICAgc3RyZWFtLnJlc3VtZSgpOwoJICAgIH0KCSAgfTsKCgkgIHJldHVybiBzZWxmOwoJfTsKCgkvLyBleHBvc2VkIGZvciB0ZXN0aW5nIHB1cnBvc2VzIG9ubHkuCglSZWFkYWJsZS5fZnJvbUxpc3QgPSBmcm9tTGlzdDsKCgkvLyBQbHVjayBvZmYgbiBieXRlcyBmcm9tIGFuIGFycmF5IG9mIGJ1ZmZlcnMuCgkvLyBMZW5ndGggaXMgdGhlIGNvbWJpbmVkIGxlbmd0aHMgb2YgYWxsIHRoZSBidWZmZXJzIGluIHRoZSBsaXN0LgoJLy8gVGhpcyBmdW5jdGlvbiBpcyBkZXNpZ25lZCB0byBiZSBpbmxpbmFibGUsIHNvIHBsZWFzZSB0YWtlIGNhcmUgd2hlbiBtYWtpbmcKCS8vIGNoYW5nZXMgdG8gdGhlIGZ1bmN0aW9uIGJvZHkuCglmdW5jdGlvbiBmcm9tTGlzdChuLCBzdGF0ZSkgewoJICAvLyBub3RoaW5nIGJ1ZmZlcmVkCgkgIGlmIChzdGF0ZS5sZW5ndGggPT09IDApIHJldHVybiBudWxsOwoKCSAgdmFyIHJldDsKCSAgaWYgKHN0YXRlLm9iamVjdE1vZGUpIHJldCA9IHN0YXRlLmJ1ZmZlci5zaGlmdCgpO2Vsc2UgaWYgKCFuIHx8IG4gPj0gc3RhdGUubGVuZ3RoKSB7CgkgICAgLy8gcmVhZCBpdCBhbGwsIHRydW5jYXRlIHRoZSBsaXN0CgkgICAgaWYgKHN0YXRlLmRlY29kZXIpIHJldCA9IHN0YXRlLmJ1ZmZlci5qb2luKCcnKTtlbHNlIGlmIChzdGF0ZS5idWZmZXIubGVuZ3RoID09PSAxKSByZXQgPSBzdGF0ZS5idWZmZXIuaGVhZC5kYXRhO2Vsc2UgcmV0ID0gc3RhdGUuYnVmZmVyLmNvbmNhdChzdGF0ZS5sZW5ndGgpOwoJICAgIHN0YXRlLmJ1ZmZlci5jbGVhcigpOwoJICB9IGVsc2UgewoJICAgIC8vIHJlYWQgcGFydCBvZiBsaXN0CgkgICAgcmV0ID0gZnJvbUxpc3RQYXJ0aWFsKG4sIHN0YXRlLmJ1ZmZlciwgc3RhdGUuZGVjb2Rlcik7CgkgIH0KCgkgIHJldHVybiByZXQ7Cgl9CgoJLy8gRXh0cmFjdHMgb25seSBlbm91Z2ggYnVmZmVyZWQgZGF0YSB0byBzYXRpc2Z5IHRoZSBhbW91bnQgcmVxdWVzdGVkLgoJLy8gVGhpcyBmdW5jdGlvbiBpcyBkZXNpZ25lZCB0byBiZSBpbmxpbmFibGUsIHNvIHBsZWFzZSB0YWtlIGNhcmUgd2hlbiBtYWtpbmcKCS8vIGNoYW5nZXMgdG8gdGhlIGZ1bmN0aW9uIGJvZHkuCglmdW5jdGlvbiBmcm9tTGlzdFBhcnRpYWwobiwgbGlzdCwgaGFzU3RyaW5ncykgewoJICB2YXIgcmV0OwoJICBpZiAobiA8IGxpc3QuaGVhZC5kYXRhLmxlbmd0aCkgewoJICAgIC8vIHNsaWNlIGlzIHRoZSBzYW1lIGZvciBidWZmZXJzIGFuZCBzdHJpbmdzCgkgICAgcmV0ID0gbGlzdC5oZWFkLmRhdGEuc2xpY2UoMCwgbik7CgkgICAgbGlzdC5oZWFkLmRhdGEgPSBsaXN0LmhlYWQuZGF0YS5zbGljZShuKTsKCSAgfSBlbHNlIGlmIChuID09PSBsaXN0LmhlYWQuZGF0YS5sZW5ndGgpIHsKCSAgICAvLyBmaXJzdCBjaHVuayBpcyBhIHBlcmZlY3QgbWF0Y2gKCSAgICByZXQgPSBsaXN0LnNoaWZ0KCk7CgkgIH0gZWxzZSB7CgkgICAgLy8gcmVzdWx0IHNwYW5zIG1vcmUgdGhhbiBvbmUgYnVmZmVyCgkgICAgcmV0ID0gaGFzU3RyaW5ncyA/IGNvcHlGcm9tQnVmZmVyU3RyaW5nKG4sIGxpc3QpIDogY29weUZyb21CdWZmZXIobiwgbGlzdCk7CgkgIH0KCSAgcmV0dXJuIHJldDsKCX0KCgkvLyBDb3BpZXMgYSBzcGVjaWZpZWQgYW1vdW50IG9mIGNoYXJhY3RlcnMgZnJvbSB0aGUgbGlzdCBvZiBidWZmZXJlZCBkYXRhCgkvLyBjaHVua3MuCgkvLyBUaGlzIGZ1bmN0aW9uIGlzIGRlc2lnbmVkIHRvIGJlIGlubGluYWJsZSwgc28gcGxlYXNlIHRha2UgY2FyZSB3aGVuIG1ha2luZwoJLy8gY2hhbmdlcyB0byB0aGUgZnVuY3Rpb24gYm9keS4KCWZ1bmN0aW9uIGNvcHlGcm9tQnVmZmVyU3RyaW5nKG4sIGxpc3QpIHsKCSAgdmFyIHAgPSBsaXN0LmhlYWQ7CgkgIHZhciBjID0gMTsKCSAgdmFyIHJldCA9IHAuZGF0YTsKCSAgbiAtPSByZXQubGVuZ3RoOwoJICB3aGlsZSAocCA9IHAubmV4dCkgewoJICAgIHZhciBzdHIgPSBwLmRhdGE7CgkgICAgdmFyIG5iID0gbiA+IHN0ci5sZW5ndGggPyBzdHIubGVuZ3RoIDogbjsKCSAgICBpZiAobmIgPT09IHN0ci5sZW5ndGgpIHJldCArPSBzdHI7ZWxzZSByZXQgKz0gc3RyLnNsaWNlKDAsIG4pOwoJICAgIG4gLT0gbmI7CgkgICAgaWYgKG4gPT09IDApIHsKCSAgICAgIGlmIChuYiA9PT0gc3RyLmxlbmd0aCkgewoJICAgICAgICArK2M7CgkgICAgICAgIGlmIChwLm5leHQpIGxpc3QuaGVhZCA9IHAubmV4dDtlbHNlIGxpc3QuaGVhZCA9IGxpc3QudGFpbCA9IG51bGw7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBsaXN0LmhlYWQgPSBwOwoJICAgICAgICBwLmRhdGEgPSBzdHIuc2xpY2UobmIpOwoJICAgICAgfQoJICAgICAgYnJlYWs7CgkgICAgfQoJICAgICsrYzsKCSAgfQoJICBsaXN0Lmxlbmd0aCAtPSBjOwoJICByZXR1cm4gcmV0OwoJfQoKCS8vIENvcGllcyBhIHNwZWNpZmllZCBhbW91bnQgb2YgYnl0ZXMgZnJvbSB0aGUgbGlzdCBvZiBidWZmZXJlZCBkYXRhIGNodW5rcy4KCS8vIFRoaXMgZnVuY3Rpb24gaXMgZGVzaWduZWQgdG8gYmUgaW5saW5hYmxlLCBzbyBwbGVhc2UgdGFrZSBjYXJlIHdoZW4gbWFraW5nCgkvLyBjaGFuZ2VzIHRvIHRoZSBmdW5jdGlvbiBib2R5LgoJZnVuY3Rpb24gY29weUZyb21CdWZmZXIobiwgbGlzdCkgewoJICB2YXIgcmV0ID0gYnVmZmVyU2hpbS5hbGxvY1Vuc2FmZShuKTsKCSAgdmFyIHAgPSBsaXN0LmhlYWQ7CgkgIHZhciBjID0gMTsKCSAgcC5kYXRhLmNvcHkocmV0KTsKCSAgbiAtPSBwLmRhdGEubGVuZ3RoOwoJICB3aGlsZSAocCA9IHAubmV4dCkgewoJICAgIHZhciBidWYgPSBwLmRhdGE7CgkgICAgdmFyIG5iID0gbiA+IGJ1Zi5sZW5ndGggPyBidWYubGVuZ3RoIDogbjsKCSAgICBidWYuY29weShyZXQsIHJldC5sZW5ndGggLSBuLCAwLCBuYik7CgkgICAgbiAtPSBuYjsKCSAgICBpZiAobiA9PT0gMCkgewoJICAgICAgaWYgKG5iID09PSBidWYubGVuZ3RoKSB7CgkgICAgICAgICsrYzsKCSAgICAgICAgaWYgKHAubmV4dCkgbGlzdC5oZWFkID0gcC5uZXh0O2Vsc2UgbGlzdC5oZWFkID0gbGlzdC50YWlsID0gbnVsbDsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGxpc3QuaGVhZCA9IHA7CgkgICAgICAgIHAuZGF0YSA9IGJ1Zi5zbGljZShuYik7CgkgICAgICB9CgkgICAgICBicmVhazsKCSAgICB9CgkgICAgKytjOwoJICB9CgkgIGxpc3QubGVuZ3RoIC09IGM7CgkgIHJldHVybiByZXQ7Cgl9CgoJZnVuY3Rpb24gZW5kUmVhZGFibGUoc3RyZWFtKSB7CgkgIHZhciBzdGF0ZSA9IHN0cmVhbS5fcmVhZGFibGVTdGF0ZTsKCgkgIC8vIElmIHdlIGdldCBoZXJlIGJlZm9yZSBjb25zdW1pbmcgYWxsIHRoZSBieXRlcywgdGhlbiB0aGF0IGlzIGEKCSAgLy8gYnVnIGluIG5vZGUuICBTaG91bGQgbmV2ZXIgaGFwcGVuLgoJICBpZiAoc3RhdGUubGVuZ3RoID4gMCkgdGhyb3cgbmV3IEVycm9yKCciZW5kUmVhZGFibGUoKSIgY2FsbGVkIG9uIG5vbi1lbXB0eSBzdHJlYW0nKTsKCgkgIGlmICghc3RhdGUuZW5kRW1pdHRlZCkgewoJICAgIHN0YXRlLmVuZGVkID0gdHJ1ZTsKCSAgICBwcm9jZXNzTmV4dFRpY2soZW5kUmVhZGFibGVOVCwgc3RhdGUsIHN0cmVhbSk7CgkgIH0KCX0KCglmdW5jdGlvbiBlbmRSZWFkYWJsZU5UKHN0YXRlLCBzdHJlYW0pIHsKCSAgLy8gQ2hlY2sgdGhhdCB3ZSBkaWRuJ3QgZ2V0IG9uZSBsYXN0IHVuc2hpZnQuCgkgIGlmICghc3RhdGUuZW5kRW1pdHRlZCAmJiBzdGF0ZS5sZW5ndGggPT09IDApIHsKCSAgICBzdGF0ZS5lbmRFbWl0dGVkID0gdHJ1ZTsKCSAgICBzdHJlYW0ucmVhZGFibGUgPSBmYWxzZTsKCSAgICBzdHJlYW0uZW1pdCgnZW5kJyk7CgkgIH0KCX0KCglmdW5jdGlvbiBmb3JFYWNoKHhzLCBmKSB7CgkgIGZvciAodmFyIGkgPSAwLCBsID0geHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgZih4c1tpXSwgaSk7CgkgIH0KCX0KCglmdW5jdGlvbiBpbmRleE9mKHhzLCB4KSB7CgkgIGZvciAodmFyIGkgPSAwLCBsID0geHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgaWYgKHhzW2ldID09PSB4KSByZXR1cm4gaTsKCSAgfQoJICByZXR1cm4gLTE7Cgl9CgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygxMikpKQoKLyoqKi8gfSwKLyogMzAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLyogKGlnbm9yZWQpICovCgovKioqLyB9LAovKiAzMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJdmFyIEJ1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpLkJ1ZmZlcjsKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgYnVmZmVyU2hpbSA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJbW9kdWxlLmV4cG9ydHMgPSBCdWZmZXJMaXN0OwoKCWZ1bmN0aW9uIEJ1ZmZlckxpc3QoKSB7CgkgIHRoaXMuaGVhZCA9IG51bGw7CgkgIHRoaXMudGFpbCA9IG51bGw7CgkgIHRoaXMubGVuZ3RoID0gMDsKCX0KCglCdWZmZXJMaXN0LnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKHYpIHsKCSAgdmFyIGVudHJ5ID0geyBkYXRhOiB2LCBuZXh0OiBudWxsIH07CgkgIGlmICh0aGlzLmxlbmd0aCA+IDApIHRoaXMudGFpbC5uZXh0ID0gZW50cnk7ZWxzZSB0aGlzLmhlYWQgPSBlbnRyeTsKCSAgdGhpcy50YWlsID0gZW50cnk7CgkgICsrdGhpcy5sZW5ndGg7Cgl9OwoKCUJ1ZmZlckxpc3QucHJvdG90eXBlLnVuc2hpZnQgPSBmdW5jdGlvbiAodikgewoJICB2YXIgZW50cnkgPSB7IGRhdGE6IHYsIG5leHQ6IHRoaXMuaGVhZCB9OwoJICBpZiAodGhpcy5sZW5ndGggPT09IDApIHRoaXMudGFpbCA9IGVudHJ5OwoJICB0aGlzLmhlYWQgPSBlbnRyeTsKCSAgKyt0aGlzLmxlbmd0aDsKCX07CgoJQnVmZmVyTGlzdC5wcm90b3R5cGUuc2hpZnQgPSBmdW5jdGlvbiAoKSB7CgkgIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwoJICB2YXIgcmV0ID0gdGhpcy5oZWFkLmRhdGE7CgkgIGlmICh0aGlzLmxlbmd0aCA9PT0gMSkgdGhpcy5oZWFkID0gdGhpcy50YWlsID0gbnVsbDtlbHNlIHRoaXMuaGVhZCA9IHRoaXMuaGVhZC5uZXh0OwoJICAtLXRoaXMubGVuZ3RoOwoJICByZXR1cm4gcmV0OwoJfTsKCglCdWZmZXJMaXN0LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgdGhpcy5oZWFkID0gdGhpcy50YWlsID0gbnVsbDsKCSAgdGhpcy5sZW5ndGggPSAwOwoJfTsKCglCdWZmZXJMaXN0LnByb3RvdHlwZS5qb2luID0gZnVuY3Rpb24gKHMpIHsKCSAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm4gJyc7CgkgIHZhciBwID0gdGhpcy5oZWFkOwoJICB2YXIgcmV0ID0gJycgKyBwLmRhdGE7CgkgIHdoaWxlIChwID0gcC5uZXh0KSB7CgkgICAgcmV0ICs9IHMgKyBwLmRhdGE7CgkgIH1yZXR1cm4gcmV0OwoJfTsKCglCdWZmZXJMaXN0LnByb3RvdHlwZS5jb25jYXQgPSBmdW5jdGlvbiAobikgewoJICBpZiAodGhpcy5sZW5ndGggPT09IDApIHJldHVybiBidWZmZXJTaGltLmFsbG9jKDApOwoJICBpZiAodGhpcy5sZW5ndGggPT09IDEpIHJldHVybiB0aGlzLmhlYWQuZGF0YTsKCSAgdmFyIHJldCA9IGJ1ZmZlclNoaW0uYWxsb2NVbnNhZmUobiA+Pj4gMCk7CgkgIHZhciBwID0gdGhpcy5oZWFkOwoJICB2YXIgaSA9IDA7CgkgIHdoaWxlIChwKSB7CgkgICAgcC5kYXRhLmNvcHkocmV0LCBpKTsKCSAgICBpICs9IHAuZGF0YS5sZW5ndGg7CgkgICAgcCA9IHAubmV4dDsKCSAgfQoJICByZXR1cm4gcmV0OwoJfTsKCi8qKiovIH0sCi8qIDMyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLgoJLy8KCS8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCgkvLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCgkvLyAiU29mdHdhcmUiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nCgkvLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCgkvLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0CgkvLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUKCS8vIGZvbGxvd2luZyBjb25kaXRpb25zOgoJLy8KCS8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkCgkvLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCS8vCgkvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUwoJLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgoJLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTgoJLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sCgkvLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKCS8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUKCS8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCgoJdmFyIEJ1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpLkJ1ZmZlcjsKCgl2YXIgaXNCdWZmZXJFbmNvZGluZyA9IEJ1ZmZlci5pc0VuY29kaW5nCgkgIHx8IGZ1bmN0aW9uKGVuY29kaW5nKSB7CgkgICAgICAgc3dpdGNoIChlbmNvZGluZyAmJiBlbmNvZGluZy50b0xvd2VyQ2FzZSgpKSB7CgkgICAgICAgICBjYXNlICdoZXgnOiBjYXNlICd1dGY4JzogY2FzZSAndXRmLTgnOiBjYXNlICdhc2NpaSc6IGNhc2UgJ2JpbmFyeSc6IGNhc2UgJ2Jhc2U2NCc6IGNhc2UgJ3VjczInOiBjYXNlICd1Y3MtMic6IGNhc2UgJ3V0ZjE2bGUnOiBjYXNlICd1dGYtMTZsZSc6IGNhc2UgJ3Jhdyc6IHJldHVybiB0cnVlOwoJICAgICAgICAgZGVmYXVsdDogcmV0dXJuIGZhbHNlOwoJICAgICAgIH0KCSAgICAgfQoKCglmdW5jdGlvbiBhc3NlcnRFbmNvZGluZyhlbmNvZGluZykgewoJICBpZiAoZW5jb2RpbmcgJiYgIWlzQnVmZmVyRW5jb2RpbmcoZW5jb2RpbmcpKSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpOwoJICB9Cgl9CgoJLy8gU3RyaW5nRGVjb2RlciBwcm92aWRlcyBhbiBpbnRlcmZhY2UgZm9yIGVmZmljaWVudGx5IHNwbGl0dGluZyBhIHNlcmllcyBvZgoJLy8gYnVmZmVycyBpbnRvIGEgc2VyaWVzIG9mIEpTIHN0cmluZ3Mgd2l0aG91dCBicmVha2luZyBhcGFydCBtdWx0aS1ieXRlCgkvLyBjaGFyYWN0ZXJzLiBDRVNVLTggaXMgaGFuZGxlZCBhcyBwYXJ0IG9mIHRoZSBVVEYtOCBlbmNvZGluZy4KCS8vCgkvLyBAVE9ETyBIYW5kbGluZyBhbGwgZW5jb2RpbmdzIGluc2lkZSBhIHNpbmdsZSBvYmplY3QgbWFrZXMgaXQgdmVyeSBkaWZmaWN1bHQKCS8vIHRvIHJlYXNvbiBhYm91dCB0aGlzIGNvZGUsIHNvIGl0IHNob3VsZCBiZSBzcGxpdCB1cCBpbiB0aGUgZnV0dXJlLgoJLy8gQFRPRE8gVGhlcmUgc2hvdWxkIGJlIGEgdXRmOC1zdHJpY3QgZW5jb2RpbmcgdGhhdCByZWplY3RzIGludmFsaWQgVVRGLTggY29kZQoJLy8gcG9pbnRzIGFzIHVzZWQgYnkgQ0VTVS04LgoJdmFyIFN0cmluZ0RlY29kZXIgPSBleHBvcnRzLlN0cmluZ0RlY29kZXIgPSBmdW5jdGlvbihlbmNvZGluZykgewoJICB0aGlzLmVuY29kaW5nID0gKGVuY29kaW5nIHx8ICd1dGY4JykudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bLV9dLywgJycpOwoJICBhc3NlcnRFbmNvZGluZyhlbmNvZGluZyk7CgkgIHN3aXRjaCAodGhpcy5lbmNvZGluZykgewoJICAgIGNhc2UgJ3V0ZjgnOgoJICAgICAgLy8gQ0VTVS04IHJlcHJlc2VudHMgZWFjaCBvZiBTdXJyb2dhdGUgUGFpciBieSAzLWJ5dGVzCgkgICAgICB0aGlzLnN1cnJvZ2F0ZVNpemUgPSAzOwoJICAgICAgYnJlYWs7CgkgICAgY2FzZSAndWNzMic6CgkgICAgY2FzZSAndXRmMTZsZSc6CgkgICAgICAvLyBVVEYtMTYgcmVwcmVzZW50cyBlYWNoIG9mIFN1cnJvZ2F0ZSBQYWlyIGJ5IDItYnl0ZXMKCSAgICAgIHRoaXMuc3Vycm9nYXRlU2l6ZSA9IDI7CgkgICAgICB0aGlzLmRldGVjdEluY29tcGxldGVDaGFyID0gdXRmMTZEZXRlY3RJbmNvbXBsZXRlQ2hhcjsKCSAgICAgIGJyZWFrOwoJICAgIGNhc2UgJ2Jhc2U2NCc6CgkgICAgICAvLyBCYXNlLTY0IHN0b3JlcyAzIGJ5dGVzIGluIDQgY2hhcnMsIGFuZCBwYWRzIHRoZSByZW1haW5kZXIuCgkgICAgICB0aGlzLnN1cnJvZ2F0ZVNpemUgPSAzOwoJICAgICAgdGhpcy5kZXRlY3RJbmNvbXBsZXRlQ2hhciA9IGJhc2U2NERldGVjdEluY29tcGxldGVDaGFyOwoJICAgICAgYnJlYWs7CgkgICAgZGVmYXVsdDoKCSAgICAgIHRoaXMud3JpdGUgPSBwYXNzVGhyb3VnaFdyaXRlOwoJICAgICAgcmV0dXJuOwoJICB9CgoJICAvLyBFbm91Z2ggc3BhY2UgdG8gc3RvcmUgYWxsIGJ5dGVzIG9mIGEgc2luZ2xlIGNoYXJhY3Rlci4gVVRGLTggbmVlZHMgNAoJICAvLyBieXRlcywgYnV0IENFU1UtOCBtYXkgcmVxdWlyZSB1cCB0byA2ICgzIGJ5dGVzIHBlciBzdXJyb2dhdGUpLgoJICB0aGlzLmNoYXJCdWZmZXIgPSBuZXcgQnVmZmVyKDYpOwoJICAvLyBOdW1iZXIgb2YgYnl0ZXMgcmVjZWl2ZWQgZm9yIHRoZSBjdXJyZW50IGluY29tcGxldGUgbXVsdGktYnl0ZSBjaGFyYWN0ZXIuCgkgIHRoaXMuY2hhclJlY2VpdmVkID0gMDsKCSAgLy8gTnVtYmVyIG9mIGJ5dGVzIGV4cGVjdGVkIGZvciB0aGUgY3VycmVudCBpbmNvbXBsZXRlIG11bHRpLWJ5dGUgY2hhcmFjdGVyLgoJICB0aGlzLmNoYXJMZW5ndGggPSAwOwoJfTsKCgoJLy8gd3JpdGUgZGVjb2RlcyB0aGUgZ2l2ZW4gYnVmZmVyIGFuZCByZXR1cm5zIGl0IGFzIEpTIHN0cmluZyB0aGF0IGlzCgkvLyBndWFyYW50ZWVkIHRvIG5vdCBjb250YWluIGFueSBwYXJ0aWFsIG11bHRpLWJ5dGUgY2hhcmFjdGVycy4gQW55IHBhcnRpYWwKCS8vIGNoYXJhY3RlciBmb3VuZCBhdCB0aGUgZW5kIG9mIHRoZSBidWZmZXIgaXMgYnVmZmVyZWQgdXAsIGFuZCB3aWxsIGJlCgkvLyByZXR1cm5lZCB3aGVuIGNhbGxpbmcgd3JpdGUgYWdhaW4gd2l0aCB0aGUgcmVtYWluaW5nIGJ5dGVzLgoJLy8KCS8vIE5vdGU6IENvbnZlcnRpbmcgYSBCdWZmZXIgY29udGFpbmluZyBhbiBvcnBoYW4gc3Vycm9nYXRlIHRvIGEgU3RyaW5nCgkvLyBjdXJyZW50bHkgd29ya3MsIGJ1dCBjb252ZXJ0aW5nIGEgU3RyaW5nIHRvIGEgQnVmZmVyICh2aWEgYG5ldyBCdWZmZXJgLCBvcgoJLy8gQnVmZmVyI3dyaXRlKSB3aWxsIHJlcGxhY2UgaW5jb21wbGV0ZSBzdXJyb2dhdGVzIHdpdGggdGhlIHVuaWNvZGUKCS8vIHJlcGxhY2VtZW50IGNoYXJhY3Rlci4gU2VlIGh0dHBzOi8vY29kZXJldmlldy5jaHJvbWl1bS5vcmcvMTIxMTczMDA5LyAuCglTdHJpbmdEZWNvZGVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uKGJ1ZmZlcikgewoJICB2YXIgY2hhclN0ciA9ICcnOwoJICAvLyBpZiBvdXIgbGFzdCB3cml0ZSBlbmRlZCB3aXRoIGFuIGluY29tcGxldGUgbXVsdGlieXRlIGNoYXJhY3RlcgoJICB3aGlsZSAodGhpcy5jaGFyTGVuZ3RoKSB7CgkgICAgLy8gZGV0ZXJtaW5lIGhvdyBtYW55IHJlbWFpbmluZyBieXRlcyB0aGlzIGJ1ZmZlciBoYXMgdG8gb2ZmZXIgZm9yIHRoaXMgY2hhcgoJICAgIHZhciBhdmFpbGFibGUgPSAoYnVmZmVyLmxlbmd0aCA+PSB0aGlzLmNoYXJMZW5ndGggLSB0aGlzLmNoYXJSZWNlaXZlZCkgPwoJICAgICAgICB0aGlzLmNoYXJMZW5ndGggLSB0aGlzLmNoYXJSZWNlaXZlZCA6CgkgICAgICAgIGJ1ZmZlci5sZW5ndGg7CgoJICAgIC8vIGFkZCB0aGUgbmV3IGJ5dGVzIHRvIHRoZSBjaGFyIGJ1ZmZlcgoJICAgIGJ1ZmZlci5jb3B5KHRoaXMuY2hhckJ1ZmZlciwgdGhpcy5jaGFyUmVjZWl2ZWQsIDAsIGF2YWlsYWJsZSk7CgkgICAgdGhpcy5jaGFyUmVjZWl2ZWQgKz0gYXZhaWxhYmxlOwoKCSAgICBpZiAodGhpcy5jaGFyUmVjZWl2ZWQgPCB0aGlzLmNoYXJMZW5ndGgpIHsKCSAgICAgIC8vIHN0aWxsIG5vdCBlbm91Z2ggY2hhcnMgaW4gdGhpcyBidWZmZXI/IHdhaXQgZm9yIG1vcmUgLi4uCgkgICAgICByZXR1cm4gJyc7CgkgICAgfQoKCSAgICAvLyByZW1vdmUgYnl0ZXMgYmVsb25naW5nIHRvIHRoZSBjdXJyZW50IGNoYXJhY3RlciBmcm9tIHRoZSBidWZmZXIKCSAgICBidWZmZXIgPSBidWZmZXIuc2xpY2UoYXZhaWxhYmxlLCBidWZmZXIubGVuZ3RoKTsKCgkgICAgLy8gZ2V0IHRoZSBjaGFyYWN0ZXIgdGhhdCB3YXMgc3BsaXQKCSAgICBjaGFyU3RyID0gdGhpcy5jaGFyQnVmZmVyLnNsaWNlKDAsIHRoaXMuY2hhckxlbmd0aCkudG9TdHJpbmcodGhpcy5lbmNvZGluZyk7CgoJICAgIC8vIENFU1UtODogbGVhZCBzdXJyb2dhdGUgKEQ4MDAtREJGRikgaXMgYWxzbyB0aGUgaW5jb21wbGV0ZSBjaGFyYWN0ZXIKCSAgICB2YXIgY2hhckNvZGUgPSBjaGFyU3RyLmNoYXJDb2RlQXQoY2hhclN0ci5sZW5ndGggLSAxKTsKCSAgICBpZiAoY2hhckNvZGUgPj0gMHhEODAwICYmIGNoYXJDb2RlIDw9IDB4REJGRikgewoJICAgICAgdGhpcy5jaGFyTGVuZ3RoICs9IHRoaXMuc3Vycm9nYXRlU2l6ZTsKCSAgICAgIGNoYXJTdHIgPSAnJzsKCSAgICAgIGNvbnRpbnVlOwoJICAgIH0KCSAgICB0aGlzLmNoYXJSZWNlaXZlZCA9IHRoaXMuY2hhckxlbmd0aCA9IDA7CgoJICAgIC8vIGlmIHRoZXJlIGFyZSBubyBtb3JlIGJ5dGVzIGluIHRoaXMgYnVmZmVyLCBqdXN0IGVtaXQgb3VyIGNoYXIKCSAgICBpZiAoYnVmZmVyLmxlbmd0aCA9PT0gMCkgewoJICAgICAgcmV0dXJuIGNoYXJTdHI7CgkgICAgfQoJICAgIGJyZWFrOwoJICB9CgoJICAvLyBkZXRlcm1pbmUgYW5kIHNldCBjaGFyTGVuZ3RoIC8gY2hhclJlY2VpdmVkCgkgIHRoaXMuZGV0ZWN0SW5jb21wbGV0ZUNoYXIoYnVmZmVyKTsKCgkgIHZhciBlbmQgPSBidWZmZXIubGVuZ3RoOwoJICBpZiAodGhpcy5jaGFyTGVuZ3RoKSB7CgkgICAgLy8gYnVmZmVyIHRoZSBpbmNvbXBsZXRlIGNoYXJhY3RlciBieXRlcyB3ZSBnb3QKCSAgICBidWZmZXIuY29weSh0aGlzLmNoYXJCdWZmZXIsIDAsIGJ1ZmZlci5sZW5ndGggLSB0aGlzLmNoYXJSZWNlaXZlZCwgZW5kKTsKCSAgICBlbmQgLT0gdGhpcy5jaGFyUmVjZWl2ZWQ7CgkgIH0KCgkgIGNoYXJTdHIgKz0gYnVmZmVyLnRvU3RyaW5nKHRoaXMuZW5jb2RpbmcsIDAsIGVuZCk7CgoJICB2YXIgZW5kID0gY2hhclN0ci5sZW5ndGggLSAxOwoJICB2YXIgY2hhckNvZGUgPSBjaGFyU3RyLmNoYXJDb2RlQXQoZW5kKTsKCSAgLy8gQ0VTVS04OiBsZWFkIHN1cnJvZ2F0ZSAoRDgwMC1EQkZGKSBpcyBhbHNvIHRoZSBpbmNvbXBsZXRlIGNoYXJhY3RlcgoJICBpZiAoY2hhckNvZGUgPj0gMHhEODAwICYmIGNoYXJDb2RlIDw9IDB4REJGRikgewoJICAgIHZhciBzaXplID0gdGhpcy5zdXJyb2dhdGVTaXplOwoJICAgIHRoaXMuY2hhckxlbmd0aCArPSBzaXplOwoJICAgIHRoaXMuY2hhclJlY2VpdmVkICs9IHNpemU7CgkgICAgdGhpcy5jaGFyQnVmZmVyLmNvcHkodGhpcy5jaGFyQnVmZmVyLCBzaXplLCAwLCBzaXplKTsKCSAgICBidWZmZXIuY29weSh0aGlzLmNoYXJCdWZmZXIsIDAsIDAsIHNpemUpOwoJICAgIHJldHVybiBjaGFyU3RyLnN1YnN0cmluZygwLCBlbmQpOwoJICB9CgoJICAvLyBvciBqdXN0IGVtaXQgdGhlIGNoYXJTdHIKCSAgcmV0dXJuIGNoYXJTdHI7Cgl9OwoKCS8vIGRldGVjdEluY29tcGxldGVDaGFyIGRldGVybWluZXMgaWYgdGhlcmUgaXMgYW4gaW5jb21wbGV0ZSBVVEYtOCBjaGFyYWN0ZXIgYXQKCS8vIHRoZSBlbmQgb2YgdGhlIGdpdmVuIGJ1ZmZlci4gSWYgc28sIGl0IHNldHMgdGhpcy5jaGFyTGVuZ3RoIHRvIHRoZSBieXRlCgkvLyBsZW5ndGggdGhhdCBjaGFyYWN0ZXIsIGFuZCBzZXRzIHRoaXMuY2hhclJlY2VpdmVkIHRvIHRoZSBudW1iZXIgb2YgYnl0ZXMKCS8vIHRoYXQgYXJlIGF2YWlsYWJsZSBmb3IgdGhpcyBjaGFyYWN0ZXIuCglTdHJpbmdEZWNvZGVyLnByb3RvdHlwZS5kZXRlY3RJbmNvbXBsZXRlQ2hhciA9IGZ1bmN0aW9uKGJ1ZmZlcikgewoJICAvLyBkZXRlcm1pbmUgaG93IG1hbnkgYnl0ZXMgd2UgaGF2ZSB0byBjaGVjayBhdCB0aGUgZW5kIG9mIHRoaXMgYnVmZmVyCgkgIHZhciBpID0gKGJ1ZmZlci5sZW5ndGggPj0gMykgPyAzIDogYnVmZmVyLmxlbmd0aDsKCgkgIC8vIEZpZ3VyZSBvdXQgaWYgb25lIG9mIHRoZSBsYXN0IGkgYnl0ZXMgb2Ygb3VyIGJ1ZmZlciBhbm5vdW5jZXMgYW4KCSAgLy8gaW5jb21wbGV0ZSBjaGFyLgoJICBmb3IgKDsgaSA+IDA7IGktLSkgewoJICAgIHZhciBjID0gYnVmZmVyW2J1ZmZlci5sZW5ndGggLSBpXTsKCgkgICAgLy8gU2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVVRGLTgjRGVzY3JpcHRpb24KCgkgICAgLy8gMTEwWFhYWFgKCSAgICBpZiAoaSA9PSAxICYmIGMgPj4gNSA9PSAweDA2KSB7CgkgICAgICB0aGlzLmNoYXJMZW5ndGggPSAyOwoJICAgICAgYnJlYWs7CgkgICAgfQoKCSAgICAvLyAxMTEwWFhYWAoJICAgIGlmIChpIDw9IDIgJiYgYyA+PiA0ID09IDB4MEUpIHsKCSAgICAgIHRoaXMuY2hhckxlbmd0aCA9IDM7CgkgICAgICBicmVhazsKCSAgICB9CgoJICAgIC8vIDExMTEwWFhYCgkgICAgaWYgKGkgPD0gMyAmJiBjID4+IDMgPT0gMHgxRSkgewoJICAgICAgdGhpcy5jaGFyTGVuZ3RoID0gNDsKCSAgICAgIGJyZWFrOwoJICAgIH0KCSAgfQoJICB0aGlzLmNoYXJSZWNlaXZlZCA9IGk7Cgl9OwoKCVN0cmluZ0RlY29kZXIucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uKGJ1ZmZlcikgewoJICB2YXIgcmVzID0gJyc7CgkgIGlmIChidWZmZXIgJiYgYnVmZmVyLmxlbmd0aCkKCSAgICByZXMgPSB0aGlzLndyaXRlKGJ1ZmZlcik7CgoJICBpZiAodGhpcy5jaGFyUmVjZWl2ZWQpIHsKCSAgICB2YXIgY3IgPSB0aGlzLmNoYXJSZWNlaXZlZDsKCSAgICB2YXIgYnVmID0gdGhpcy5jaGFyQnVmZmVyOwoJICAgIHZhciBlbmMgPSB0aGlzLmVuY29kaW5nOwoJICAgIHJlcyArPSBidWYuc2xpY2UoMCwgY3IpLnRvU3RyaW5nKGVuYyk7CgkgIH0KCgkgIHJldHVybiByZXM7Cgl9OwoKCWZ1bmN0aW9uIHBhc3NUaHJvdWdoV3JpdGUoYnVmZmVyKSB7CgkgIHJldHVybiBidWZmZXIudG9TdHJpbmcodGhpcy5lbmNvZGluZyk7Cgl9CgoJZnVuY3Rpb24gdXRmMTZEZXRlY3RJbmNvbXBsZXRlQ2hhcihidWZmZXIpIHsKCSAgdGhpcy5jaGFyUmVjZWl2ZWQgPSBidWZmZXIubGVuZ3RoICUgMjsKCSAgdGhpcy5jaGFyTGVuZ3RoID0gdGhpcy5jaGFyUmVjZWl2ZWQgPyAyIDogMDsKCX0KCglmdW5jdGlvbiBiYXNlNjREZXRlY3RJbmNvbXBsZXRlQ2hhcihidWZmZXIpIHsKCSAgdGhpcy5jaGFyUmVjZWl2ZWQgPSBidWZmZXIubGVuZ3RoICUgMzsKCSAgdGhpcy5jaGFyTGVuZ3RoID0gdGhpcy5jaGFyUmVjZWl2ZWQgPyAzIDogMDsKCX0KCgovKioqLyB9LAovKiAzMyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCgoKLyoqKi8gfSwKLyogMzQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KQoKCi8qKiovIH0sCi8qIDM1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGEgdHJhbnNmb3JtIHN0cmVhbSBpcyBhIHJlYWRhYmxlL3dyaXRhYmxlIHN0cmVhbSB3aGVyZSB5b3UgZG8KCS8vIHNvbWV0aGluZyB3aXRoIHRoZSBkYXRhLiAgU29tZXRpbWVzIGl0J3MgY2FsbGVkIGEgImZpbHRlciIsCgkvLyBidXQgdGhhdCdzIG5vdCBhIGdyZWF0IG5hbWUgZm9yIGl0LCBzaW5jZSB0aGF0IGltcGxpZXMgYSB0aGluZyB3aGVyZQoJLy8gc29tZSBiaXRzIHBhc3MgdGhyb3VnaCwgYW5kIG90aGVycyBhcmUgc2ltcGx5IGlnbm9yZWQuICAoVGhhdCB3b3VsZAoJLy8gYmUgYSB2YWxpZCBleGFtcGxlIG9mIGEgdHJhbnNmb3JtLCBvZiBjb3Vyc2UuKQoJLy8KCS8vIFdoaWxlIHRoZSBvdXRwdXQgaXMgY2F1c2FsbHkgcmVsYXRlZCB0byB0aGUgaW5wdXQsIGl0J3Mgbm90IGEKCS8vIG5lY2Vzc2FyaWx5IHN5bW1ldHJpYyBvciBzeW5jaHJvbm91cyB0cmFuc2Zvcm1hdGlvbi4gIEZvciBleGFtcGxlLAoJLy8gYSB6bGliIHN0cmVhbSBtaWdodCB0YWtlIG11bHRpcGxlIHBsYWluLXRleHQgd3JpdGVzKCksIGFuZCB0aGVuCgkvLyBlbWl0IGEgc2luZ2xlIGNvbXByZXNzZWQgY2h1bmsgc29tZSB0aW1lIGluIHRoZSBmdXR1cmUuCgkvLwoJLy8gSGVyZSdzIGhvdyB0aGlzIHdvcmtzOgoJLy8KCS8vIFRoZSBUcmFuc2Zvcm0gc3RyZWFtIGhhcyBhbGwgdGhlIGFzcGVjdHMgb2YgdGhlIHJlYWRhYmxlIGFuZCB3cml0YWJsZQoJLy8gc3RyZWFtIGNsYXNzZXMuICBXaGVuIHlvdSB3cml0ZShjaHVuayksIHRoYXQgY2FsbHMgX3dyaXRlKGNodW5rLGNiKQoJLy8gaW50ZXJuYWxseSwgYW5kIHJldHVybnMgZmFsc2UgaWYgdGhlcmUncyBhIGxvdCBvZiBwZW5kaW5nIHdyaXRlcwoJLy8gYnVmZmVyZWQgdXAuICBXaGVuIHlvdSBjYWxsIHJlYWQoKSwgdGhhdCBjYWxscyBfcmVhZChuKSB1bnRpbAoJLy8gdGhlcmUncyBlbm91Z2ggcGVuZGluZyByZWFkYWJsZSBkYXRhIGJ1ZmZlcmVkIHVwLgoJLy8KCS8vIEluIGEgdHJhbnNmb3JtIHN0cmVhbSwgdGhlIHdyaXR0ZW4gZGF0YSBpcyBwbGFjZWQgaW4gYSBidWZmZXIuICBXaGVuCgkvLyBfcmVhZChuKSBpcyBjYWxsZWQsIGl0IHRyYW5zZm9ybXMgdGhlIHF1ZXVlZCB1cCBkYXRhLCBjYWxsaW5nIHRoZQoJLy8gYnVmZmVyZWQgX3dyaXRlIGNiJ3MgYXMgaXQgY29uc3VtZXMgY2h1bmtzLiAgSWYgY29uc3VtaW5nIGEgc2luZ2xlCgkvLyB3cml0dGVuIGNodW5rIHdvdWxkIHJlc3VsdCBpbiBtdWx0aXBsZSBvdXRwdXQgY2h1bmtzLCB0aGVuIHRoZSBmaXJzdAoJLy8gb3V0cHV0dGVkIGJpdCBjYWxscyB0aGUgcmVhZGNiLCBhbmQgc3Vic2VxdWVudCBjaHVua3MganVzdCBnbyBpbnRvCgkvLyB0aGUgcmVhZCBidWZmZXIsIGFuZCB3aWxsIGNhdXNlIGl0IHRvIGVtaXQgJ3JlYWRhYmxlJyBpZiBuZWNlc3NhcnkuCgkvLwoJLy8gVGhpcyB3YXksIGJhY2stcHJlc3N1cmUgaXMgYWN0dWFsbHkgZGV0ZXJtaW5lZCBieSB0aGUgcmVhZGluZyBzaWRlLAoJLy8gc2luY2UgX3JlYWQgaGFzIHRvIGJlIGNhbGxlZCB0byBzdGFydCBwcm9jZXNzaW5nIGEgbmV3IGNodW5rLiAgSG93ZXZlciwKCS8vIGEgcGF0aG9sb2dpY2FsIGluZmxhdGUgdHlwZSBvZiB0cmFuc2Zvcm0gY2FuIGNhdXNlIGV4Y2Vzc2l2ZSBidWZmZXJpbmcKCS8vIGhlcmUuICBGb3IgZXhhbXBsZSwgaW1hZ2luZSBhIHN0cmVhbSB3aGVyZSBldmVyeSBieXRlIG9mIGlucHV0IGlzCgkvLyBpbnRlcnByZXRlZCBhcyBhbiBpbnRlZ2VyIGZyb20gMC0yNTUsIGFuZCB0aGVuIHJlc3VsdHMgaW4gdGhhdCBtYW55CgkvLyBieXRlcyBvZiBvdXRwdXQuICBXcml0aW5nIHRoZSA0IGJ5dGVzIHtmZixmZixmZixmZn0gd291bGQgcmVzdWx0IGluCgkvLyAxa2Igb2YgZGF0YSBiZWluZyBvdXRwdXQuICBJbiB0aGlzIGNhc2UsIHlvdSBjb3VsZCB3cml0ZSBhIHZlcnkgc21hbGwKCS8vIGFtb3VudCBvZiBpbnB1dCwgYW5kIGVuZCB1cCB3aXRoIGEgdmVyeSBsYXJnZSBhbW91bnQgb2Ygb3V0cHV0LiAgSW4KCS8vIHN1Y2ggYSBwYXRob2xvZ2ljYWwgaW5mbGF0aW5nIG1lY2hhbmlzbSwgdGhlcmUnZCBiZSBubyB3YXkgdG8gdGVsbAoJLy8gdGhlIHN5c3RlbSB0byBzdG9wIGRvaW5nIHRoZSB0cmFuc2Zvcm0uICBBIHNpbmdsZSA0TUIgd3JpdGUgY291bGQKCS8vIGNhdXNlIHRoZSBzeXN0ZW0gdG8gcnVuIG91dCBvZiBtZW1vcnkuCgkvLwoJLy8gSG93ZXZlciwgZXZlbiBpbiBzdWNoIGEgcGF0aG9sb2dpY2FsIGNhc2UsIG9ubHkgYSBzaW5nbGUgd3JpdHRlbiBjaHVuawoJLy8gd291bGQgYmUgY29uc3VtZWQsIGFuZCB0aGVuIHRoZSByZXN0IHdvdWxkIHdhaXQgKHVuLXRyYW5zZm9ybWVkKSB1bnRpbAoJLy8gdGhlIHJlc3VsdHMgb2YgdGhlIHByZXZpb3VzIHRyYW5zZm9ybWVkIGNodW5rIHdlcmUgY29uc3VtZWQuCgoJJ3VzZSBzdHJpY3QnOwoKCW1vZHVsZS5leHBvcnRzID0gVHJhbnNmb3JtOwoKCXZhciBEdXBsZXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKCXV0aWwuaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXV0aWwuaW5oZXJpdHMoVHJhbnNmb3JtLCBEdXBsZXgpOwoKCWZ1bmN0aW9uIFRyYW5zZm9ybVN0YXRlKHN0cmVhbSkgewoJICB0aGlzLmFmdGVyVHJhbnNmb3JtID0gZnVuY3Rpb24gKGVyLCBkYXRhKSB7CgkgICAgcmV0dXJuIGFmdGVyVHJhbnNmb3JtKHN0cmVhbSwgZXIsIGRhdGEpOwoJICB9OwoKCSAgdGhpcy5uZWVkVHJhbnNmb3JtID0gZmFsc2U7CgkgIHRoaXMudHJhbnNmb3JtaW5nID0gZmFsc2U7CgkgIHRoaXMud3JpdGVjYiA9IG51bGw7CgkgIHRoaXMud3JpdGVjaHVuayA9IG51bGw7CgkgIHRoaXMud3JpdGVlbmNvZGluZyA9IG51bGw7Cgl9CgoJZnVuY3Rpb24gYWZ0ZXJUcmFuc2Zvcm0oc3RyZWFtLCBlciwgZGF0YSkgewoJICB2YXIgdHMgPSBzdHJlYW0uX3RyYW5zZm9ybVN0YXRlOwoJICB0cy50cmFuc2Zvcm1pbmcgPSBmYWxzZTsKCgkgIHZhciBjYiA9IHRzLndyaXRlY2I7CgoJICBpZiAoIWNiKSByZXR1cm4gc3RyZWFtLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdubyB3cml0ZWNiIGluIFRyYW5zZm9ybSBjbGFzcycpKTsKCgkgIHRzLndyaXRlY2h1bmsgPSBudWxsOwoJICB0cy53cml0ZWNiID0gbnVsbDsKCgkgIGlmIChkYXRhICE9PSBudWxsICYmIGRhdGEgIT09IHVuZGVmaW5lZCkgc3RyZWFtLnB1c2goZGF0YSk7CgoJICBjYihlcik7CgoJICB2YXIgcnMgPSBzdHJlYW0uX3JlYWRhYmxlU3RhdGU7CgkgIHJzLnJlYWRpbmcgPSBmYWxzZTsKCSAgaWYgKHJzLm5lZWRSZWFkYWJsZSB8fCBycy5sZW5ndGggPCBycy5oaWdoV2F0ZXJNYXJrKSB7CgkgICAgc3RyZWFtLl9yZWFkKHJzLmhpZ2hXYXRlck1hcmspOwoJICB9Cgl9CgoJZnVuY3Rpb24gVHJhbnNmb3JtKG9wdGlvbnMpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFRyYW5zZm9ybSkpIHJldHVybiBuZXcgVHJhbnNmb3JtKG9wdGlvbnMpOwoKCSAgRHVwbGV4LmNhbGwodGhpcywgb3B0aW9ucyk7CgoJICB0aGlzLl90cmFuc2Zvcm1TdGF0ZSA9IG5ldyBUcmFuc2Zvcm1TdGF0ZSh0aGlzKTsKCgkgIHZhciBzdHJlYW0gPSB0aGlzOwoKCSAgLy8gc3RhcnQgb3V0IGFza2luZyBmb3IgYSByZWFkYWJsZSBldmVudCBvbmNlIGRhdGEgaXMgdHJhbnNmb3JtZWQuCgkgIHRoaXMuX3JlYWRhYmxlU3RhdGUubmVlZFJlYWRhYmxlID0gdHJ1ZTsKCgkgIC8vIHdlIGhhdmUgaW1wbGVtZW50ZWQgdGhlIF9yZWFkIG1ldGhvZCwgYW5kIGRvbmUgdGhlIG90aGVyIHRoaW5ncwoJICAvLyB0aGF0IFJlYWRhYmxlIHdhbnRzIGJlZm9yZSB0aGUgZmlyc3QgX3JlYWQgY2FsbCwgc28gdW5zZXQgdGhlCgkgIC8vIHN5bmMgZ3VhcmQgZmxhZy4KCSAgdGhpcy5fcmVhZGFibGVTdGF0ZS5zeW5jID0gZmFsc2U7CgoJICBpZiAob3B0aW9ucykgewoJICAgIGlmICh0eXBlb2Ygb3B0aW9ucy50cmFuc2Zvcm0gPT09ICdmdW5jdGlvbicpIHRoaXMuX3RyYW5zZm9ybSA9IG9wdGlvbnMudHJhbnNmb3JtOwoKCSAgICBpZiAodHlwZW9mIG9wdGlvbnMuZmx1c2ggPT09ICdmdW5jdGlvbicpIHRoaXMuX2ZsdXNoID0gb3B0aW9ucy5mbHVzaDsKCSAgfQoKCSAgLy8gV2hlbiB0aGUgd3JpdGFibGUgc2lkZSBmaW5pc2hlcywgdGhlbiBmbHVzaCBvdXQgYW55dGhpbmcgcmVtYWluaW5nLgoJICB0aGlzLm9uY2UoJ3ByZWZpbmlzaCcsIGZ1bmN0aW9uICgpIHsKCSAgICBpZiAodHlwZW9mIHRoaXMuX2ZsdXNoID09PSAnZnVuY3Rpb24nKSB0aGlzLl9mbHVzaChmdW5jdGlvbiAoZXIsIGRhdGEpIHsKCSAgICAgIGRvbmUoc3RyZWFtLCBlciwgZGF0YSk7CgkgICAgfSk7ZWxzZSBkb25lKHN0cmVhbSk7CgkgIH0pOwoJfQoKCVRyYW5zZm9ybS5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcpIHsKCSAgdGhpcy5fdHJhbnNmb3JtU3RhdGUubmVlZFRyYW5zZm9ybSA9IGZhbHNlOwoJICByZXR1cm4gRHVwbGV4LnByb3RvdHlwZS5wdXNoLmNhbGwodGhpcywgY2h1bmssIGVuY29kaW5nKTsKCX07CgoJLy8gVGhpcyBpcyB0aGUgcGFydCB3aGVyZSB5b3UgZG8gc3R1ZmYhCgkvLyBvdmVycmlkZSB0aGlzIGZ1bmN0aW9uIGluIGltcGxlbWVudGF0aW9uIGNsYXNzZXMuCgkvLyAnY2h1bmsnIGlzIGFuIGlucHV0IGNodW5rLgoJLy8KCS8vIENhbGwgYHB1c2gobmV3Q2h1bmspYCB0byBwYXNzIGFsb25nIHRyYW5zZm9ybWVkIG91dHB1dAoJLy8gdG8gdGhlIHJlYWRhYmxlIHNpZGUuICBZb3UgbWF5IGNhbGwgJ3B1c2gnIHplcm8gb3IgbW9yZSB0aW1lcy4KCS8vCgkvLyBDYWxsIGBjYihlcnIpYCB3aGVuIHlvdSBhcmUgZG9uZSB3aXRoIHRoaXMgY2h1bmsuICBJZiB5b3UgcGFzcwoJLy8gYW4gZXJyb3IsIHRoZW4gdGhhdCdsbCBwdXQgdGhlIGh1cnQgb24gdGhlIHdob2xlIG9wZXJhdGlvbi4gIElmIHlvdQoJLy8gbmV2ZXIgY2FsbCBjYigpLCB0aGVuIHlvdSdsbCBuZXZlciBnZXQgYW5vdGhlciBjaHVuay4KCVRyYW5zZm9ybS5wcm90b3R5cGUuX3RyYW5zZm9ybSA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIHRocm93IG5ldyBFcnJvcignX3RyYW5zZm9ybSgpIGlzIG5vdCBpbXBsZW1lbnRlZCcpOwoJfTsKCglUcmFuc2Zvcm0ucHJvdG90eXBlLl93cml0ZSA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIHZhciB0cyA9IHRoaXMuX3RyYW5zZm9ybVN0YXRlOwoJICB0cy53cml0ZWNiID0gY2I7CgkgIHRzLndyaXRlY2h1bmsgPSBjaHVuazsKCSAgdHMud3JpdGVlbmNvZGluZyA9IGVuY29kaW5nOwoJICBpZiAoIXRzLnRyYW5zZm9ybWluZykgewoJICAgIHZhciBycyA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgkgICAgaWYgKHRzLm5lZWRUcmFuc2Zvcm0gfHwgcnMubmVlZFJlYWRhYmxlIHx8IHJzLmxlbmd0aCA8IHJzLmhpZ2hXYXRlck1hcmspIHRoaXMuX3JlYWQocnMuaGlnaFdhdGVyTWFyayk7CgkgIH0KCX07CgoJLy8gRG9lc24ndCBtYXR0ZXIgd2hhdCB0aGUgYXJncyBhcmUgaGVyZS4KCS8vIF90cmFuc2Zvcm0gZG9lcyBhbGwgdGhlIHdvcmsuCgkvLyBUaGF0IHdlIGdvdCBoZXJlIG1lYW5zIHRoYXQgdGhlIHJlYWRhYmxlIHNpZGUgd2FudHMgbW9yZSBkYXRhLgoJVHJhbnNmb3JtLnByb3RvdHlwZS5fcmVhZCA9IGZ1bmN0aW9uIChuKSB7CgkgIHZhciB0cyA9IHRoaXMuX3RyYW5zZm9ybVN0YXRlOwoKCSAgaWYgKHRzLndyaXRlY2h1bmsgIT09IG51bGwgJiYgdHMud3JpdGVjYiAmJiAhdHMudHJhbnNmb3JtaW5nKSB7CgkgICAgdHMudHJhbnNmb3JtaW5nID0gdHJ1ZTsKCSAgICB0aGlzLl90cmFuc2Zvcm0odHMud3JpdGVjaHVuaywgdHMud3JpdGVlbmNvZGluZywgdHMuYWZ0ZXJUcmFuc2Zvcm0pOwoJICB9IGVsc2UgewoJICAgIC8vIG1hcmsgdGhhdCB3ZSBuZWVkIGEgdHJhbnNmb3JtLCBzbyB0aGF0IGFueSBkYXRhIHRoYXQgY29tZXMgaW4KCSAgICAvLyB3aWxsIGdldCBwcm9jZXNzZWQsIG5vdyB0aGF0IHdlJ3ZlIGFza2VkIGZvciBpdC4KCSAgICB0cy5uZWVkVHJhbnNmb3JtID0gdHJ1ZTsKCSAgfQoJfTsKCglmdW5jdGlvbiBkb25lKHN0cmVhbSwgZXIsIGRhdGEpIHsKCSAgaWYgKGVyKSByZXR1cm4gc3RyZWFtLmVtaXQoJ2Vycm9yJywgZXIpOwoKCSAgaWYgKGRhdGEgIT09IG51bGwgJiYgZGF0YSAhPT0gdW5kZWZpbmVkKSBzdHJlYW0ucHVzaChkYXRhKTsKCgkgIC8vIGlmIHRoZXJlJ3Mgbm90aGluZyBpbiB0aGUgd3JpdGUgYnVmZmVyLCB0aGVuIHRoYXQgbWVhbnMKCSAgLy8gdGhhdCBub3RoaW5nIG1vcmUgd2lsbCBldmVyIGJlIHByb3ZpZGVkCgkgIHZhciB3cyA9IHN0cmVhbS5fd3JpdGFibGVTdGF0ZTsKCSAgdmFyIHRzID0gc3RyZWFtLl90cmFuc2Zvcm1TdGF0ZTsKCgkgIGlmICh3cy5sZW5ndGgpIHRocm93IG5ldyBFcnJvcignQ2FsbGluZyB0cmFuc2Zvcm0gZG9uZSB3aGVuIHdzLmxlbmd0aCAhPSAwJyk7CgoJICBpZiAodHMudHJhbnNmb3JtaW5nKSB0aHJvdyBuZXcgRXJyb3IoJ0NhbGxpbmcgdHJhbnNmb3JtIGRvbmUgd2hlbiBzdGlsbCB0cmFuc2Zvcm1pbmcnKTsKCgkgIHJldHVybiBzdHJlYW0ucHVzaChudWxsKTsKCX0KCi8qKiovIH0sCi8qIDM2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNykKCgovKioqLyB9LAovKiAzNyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBhIHBhc3N0aHJvdWdoIHN0cmVhbS4KCS8vIGJhc2ljYWxseSBqdXN0IHRoZSBtb3N0IG1pbmltYWwgc29ydCBvZiBUcmFuc2Zvcm0gc3RyZWFtLgoJLy8gRXZlcnkgd3JpdHRlbiBjaHVuayBnZXRzIG91dHB1dCBhcy1pcy4KCgkndXNlIHN0cmljdCc7CgoJbW9kdWxlLmV4cG9ydHMgPSBQYXNzVGhyb3VnaDsKCgl2YXIgVHJhbnNmb3JtID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSk7CgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cgl1dGlsLmluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl1dGlsLmluaGVyaXRzKFBhc3NUaHJvdWdoLCBUcmFuc2Zvcm0pOwoKCWZ1bmN0aW9uIFBhc3NUaHJvdWdoKG9wdGlvbnMpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFBhc3NUaHJvdWdoKSkgcmV0dXJuIG5ldyBQYXNzVGhyb3VnaChvcHRpb25zKTsKCgkgIFRyYW5zZm9ybS5jYWxsKHRoaXMsIG9wdGlvbnMpOwoJfQoKCVBhc3NUaHJvdWdoLnByb3RvdHlwZS5fdHJhbnNmb3JtID0gZnVuY3Rpb24gKGNodW5rLCBlbmNvZGluZywgY2IpIHsKCSAgY2IobnVsbCwgY2h1bmspOwoJfTsKCi8qKiovIH0sCi8qIDM4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBCdWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KS5CdWZmZXIKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChidWYpIHsKCQkvLyBJZiB0aGUgYnVmZmVyIGlzIGJhY2tlZCBieSBhIFVpbnQ4QXJyYXksIGEgZmFzdGVyIHZlcnNpb24gd2lsbCB3b3JrCgkJaWYgKGJ1ZiBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsKCQkJLy8gSWYgdGhlIGJ1ZmZlciBpc24ndCBhIHN1YmFycmF5LCByZXR1cm4gdGhlIHVuZGVybHlpbmcgQXJyYXlCdWZmZXIKCQkJaWYgKGJ1Zi5ieXRlT2Zmc2V0ID09PSAwICYmIGJ1Zi5ieXRlTGVuZ3RoID09PSBidWYuYnVmZmVyLmJ5dGVMZW5ndGgpIHsKCQkJCXJldHVybiBidWYuYnVmZmVyCgkJCX0gZWxzZSBpZiAodHlwZW9mIGJ1Zi5idWZmZXIuc2xpY2UgPT09ICdmdW5jdGlvbicpIHsKCQkJCS8vIE90aGVyd2lzZSB3ZSBuZWVkIHRvIGdldCBhIHByb3BlciBjb3B5CgkJCQlyZXR1cm4gYnVmLmJ1ZmZlci5zbGljZShidWYuYnl0ZU9mZnNldCwgYnVmLmJ5dGVPZmZzZXQgKyBidWYuYnl0ZUxlbmd0aCkKCQkJfQoJCX0KCgkJaWYgKEJ1ZmZlci5pc0J1ZmZlcihidWYpKSB7CgkJCS8vIFRoaXMgaXMgdGhlIHNsb3cgdmVyc2lvbiB0aGF0IHdpbGwgd29yayB3aXRoIGFueSBCdWZmZXIKCQkJLy8gaW1wbGVtZW50YXRpb24gKGV2ZW4gaW4gb2xkIGJyb3dzZXJzKQoJCQl2YXIgYXJyYXlDb3B5ID0gbmV3IFVpbnQ4QXJyYXkoYnVmLmxlbmd0aCkKCQkJdmFyIGxlbiA9IGJ1Zi5sZW5ndGgKCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewoJCQkJYXJyYXlDb3B5W2ldID0gYnVmW2ldCgkJCX0KCQkJcmV0dXJuIGFycmF5Q29weS5idWZmZXIKCQl9IGVsc2UgewoJCQl0aHJvdyBuZXcgRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKQoJCX0KCX0KCgovKioqLyB9LAovKiAzOSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgltb2R1bGUuZXhwb3J0cyA9IGV4dGVuZAoKCXZhciBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7CgoJZnVuY3Rpb24gZXh0ZW5kKCkgewoJICAgIHZhciB0YXJnZXQgPSB7fQoKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewoJICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldCgoJICAgICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7CgkgICAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsKCSAgICAgICAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldCgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9CgoJICAgIHJldHVybiB0YXJnZXQKCX0KCgovKioqLyB9LAovKiA0MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsKCSAgIjEwMCI6ICJDb250aW51ZSIsCgkgICIxMDEiOiAiU3dpdGNoaW5nIFByb3RvY29scyIsCgkgICIxMDIiOiAiUHJvY2Vzc2luZyIsCgkgICIyMDAiOiAiT0siLAoJICAiMjAxIjogIkNyZWF0ZWQiLAoJICAiMjAyIjogIkFjY2VwdGVkIiwKCSAgIjIwMyI6ICJOb24tQXV0aG9yaXRhdGl2ZSBJbmZvcm1hdGlvbiIsCgkgICIyMDQiOiAiTm8gQ29udGVudCIsCgkgICIyMDUiOiAiUmVzZXQgQ29udGVudCIsCgkgICIyMDYiOiAiUGFydGlhbCBDb250ZW50IiwKCSAgIjIwNyI6ICJNdWx0aS1TdGF0dXMiLAoJICAiMjA4IjogIkFscmVhZHkgUmVwb3J0ZWQiLAoJICAiMjI2IjogIklNIFVzZWQiLAoJICAiMzAwIjogIk11bHRpcGxlIENob2ljZXMiLAoJICAiMzAxIjogIk1vdmVkIFBlcm1hbmVudGx5IiwKCSAgIjMwMiI6ICJGb3VuZCIsCgkgICIzMDMiOiAiU2VlIE90aGVyIiwKCSAgIjMwNCI6ICJOb3QgTW9kaWZpZWQiLAoJICAiMzA1IjogIlVzZSBQcm94eSIsCgkgICIzMDciOiAiVGVtcG9yYXJ5IFJlZGlyZWN0IiwKCSAgIjMwOCI6ICJQZXJtYW5lbnQgUmVkaXJlY3QiLAoJICAiNDAwIjogIkJhZCBSZXF1ZXN0IiwKCSAgIjQwMSI6ICJVbmF1dGhvcml6ZWQiLAoJICAiNDAyIjogIlBheW1lbnQgUmVxdWlyZWQiLAoJICAiNDAzIjogIkZvcmJpZGRlbiIsCgkgICI0MDQiOiAiTm90IEZvdW5kIiwKCSAgIjQwNSI6ICJNZXRob2QgTm90IEFsbG93ZWQiLAoJICAiNDA2IjogIk5vdCBBY2NlcHRhYmxlIiwKCSAgIjQwNyI6ICJQcm94eSBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCIsCgkgICI0MDgiOiAiUmVxdWVzdCBUaW1lb3V0IiwKCSAgIjQwOSI6ICJDb25mbGljdCIsCgkgICI0MTAiOiAiR29uZSIsCgkgICI0MTEiOiAiTGVuZ3RoIFJlcXVpcmVkIiwKCSAgIjQxMiI6ICJQcmVjb25kaXRpb24gRmFpbGVkIiwKCSAgIjQxMyI6ICJQYXlsb2FkIFRvbyBMYXJnZSIsCgkgICI0MTQiOiAiVVJJIFRvbyBMb25nIiwKCSAgIjQxNSI6ICJVbnN1cHBvcnRlZCBNZWRpYSBUeXBlIiwKCSAgIjQxNiI6ICJSYW5nZSBOb3QgU2F0aXNmaWFibGUiLAoJICAiNDE3IjogIkV4cGVjdGF0aW9uIEZhaWxlZCIsCgkgICI0MTgiOiAiSSdtIGEgdGVhcG90IiwKCSAgIjQyMSI6ICJNaXNkaXJlY3RlZCBSZXF1ZXN0IiwKCSAgIjQyMiI6ICJVbnByb2Nlc3NhYmxlIEVudGl0eSIsCgkgICI0MjMiOiAiTG9ja2VkIiwKCSAgIjQyNCI6ICJGYWlsZWQgRGVwZW5kZW5jeSIsCgkgICI0MjUiOiAiVW5vcmRlcmVkIENvbGxlY3Rpb24iLAoJICAiNDI2IjogIlVwZ3JhZGUgUmVxdWlyZWQiLAoJICAiNDI4IjogIlByZWNvbmRpdGlvbiBSZXF1aXJlZCIsCgkgICI0MjkiOiAiVG9vIE1hbnkgUmVxdWVzdHMiLAoJICAiNDMxIjogIlJlcXVlc3QgSGVhZGVyIEZpZWxkcyBUb28gTGFyZ2UiLAoJICAiNDUxIjogIlVuYXZhaWxhYmxlIEZvciBMZWdhbCBSZWFzb25zIiwKCSAgIjUwMCI6ICJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiLAoJICAiNTAxIjogIk5vdCBJbXBsZW1lbnRlZCIsCgkgICI1MDIiOiAiQmFkIEdhdGV3YXkiLAoJICAiNTAzIjogIlNlcnZpY2UgVW5hdmFpbGFibGUiLAoJICAiNTA0IjogIkdhdGV3YXkgVGltZW91dCIsCgkgICI1MDUiOiAiSFRUUCBWZXJzaW9uIE5vdCBTdXBwb3J0ZWQiLAoJICAiNTA2IjogIlZhcmlhbnQgQWxzbyBOZWdvdGlhdGVzIiwKCSAgIjUwNyI6ICJJbnN1ZmZpY2llbnQgU3RvcmFnZSIsCgkgICI1MDgiOiAiTG9vcCBEZXRlY3RlZCIsCgkgICI1MDkiOiAiQmFuZHdpZHRoIExpbWl0IEV4Y2VlZGVkIiwKCSAgIjUxMCI6ICJOb3QgRXh0ZW5kZWQiLAoJICAiNTExIjogIk5ldHdvcmsgQXV0aGVudGljYXRpb24gUmVxdWlyZWQiCgl9CgoKLyoqKi8gfSwKLyogNDEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuCgkvLwoJLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKCS8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKCS8vICJTb2Z0d2FyZSIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcKCS8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwKCS8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQKCS8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZQoJLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6CgkvLwoJLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQKCS8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgoJLy8KCS8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTCgkvLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GCgkvLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOCgkvLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwKCS8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUgoJLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRQoJLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KCgkndXNlIHN0cmljdCc7CgoJdmFyIHB1bnljb2RlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Mik7Cgl2YXIgdXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpOwoKCWV4cG9ydHMucGFyc2UgPSB1cmxQYXJzZTsKCWV4cG9ydHMucmVzb2x2ZSA9IHVybFJlc29sdmU7CglleHBvcnRzLnJlc29sdmVPYmplY3QgPSB1cmxSZXNvbHZlT2JqZWN0OwoJZXhwb3J0cy5mb3JtYXQgPSB1cmxGb3JtYXQ7CgoJZXhwb3J0cy5VcmwgPSBVcmw7CgoJZnVuY3Rpb24gVXJsKCkgewoJICB0aGlzLnByb3RvY29sID0gbnVsbDsKCSAgdGhpcy5zbGFzaGVzID0gbnVsbDsKCSAgdGhpcy5hdXRoID0gbnVsbDsKCSAgdGhpcy5ob3N0ID0gbnVsbDsKCSAgdGhpcy5wb3J0ID0gbnVsbDsKCSAgdGhpcy5ob3N0bmFtZSA9IG51bGw7CgkgIHRoaXMuaGFzaCA9IG51bGw7CgkgIHRoaXMuc2VhcmNoID0gbnVsbDsKCSAgdGhpcy5xdWVyeSA9IG51bGw7CgkgIHRoaXMucGF0aG5hbWUgPSBudWxsOwoJICB0aGlzLnBhdGggPSBudWxsOwoJICB0aGlzLmhyZWYgPSBudWxsOwoJfQoKCS8vIFJlZmVyZW5jZTogUkZDIDM5ODYsIFJGQyAxODA4LCBSRkMgMjM5NgoKCS8vIGRlZmluZSB0aGVzZSBoZXJlIHNvIGF0IGxlYXN0IHRoZXkgb25seSBoYXZlIHRvIGJlCgkvLyBjb21waWxlZCBvbmNlIG9uIHRoZSBmaXJzdCBtb2R1bGUgbG9hZC4KCXZhciBwcm90b2NvbFBhdHRlcm4gPSAvXihbYS16MC05ListXSs6KS9pLAoJICAgIHBvcnRQYXR0ZXJuID0gLzpbMC05XSokLywKCgkgICAgLy8gU3BlY2lhbCBjYXNlIGZvciBhIHNpbXBsZSBwYXRoIFVSTAoJICAgIHNpbXBsZVBhdGhQYXR0ZXJuID0gL14oXC9cLz8oPyFcLylbXlw/XHNdKikoXD9bXlxzXSopPyQvLAoKCSAgICAvLyBSRkMgMjM5NjogY2hhcmFjdGVycyByZXNlcnZlZCBmb3IgZGVsaW1pdGluZyBVUkxzLgoJICAgIC8vIFdlIGFjdHVhbGx5IGp1c3QgYXV0by1lc2NhcGUgdGhlc2UuCgkgICAgZGVsaW1zID0gWyc8JywgJz4nLCAnIicsICdgJywgJyAnLCAnXHInLCAnXG4nLCAnXHQnXSwKCgkgICAgLy8gUkZDIDIzOTY6IGNoYXJhY3RlcnMgbm90IGFsbG93ZWQgZm9yIHZhcmlvdXMgcmVhc29ucy4KCSAgICB1bndpc2UgPSBbJ3snLCAnfScsICd8JywgJ1xcJywgJ14nLCAnYCddLmNvbmNhdChkZWxpbXMpLAoKCSAgICAvLyBBbGxvd2VkIGJ5IFJGQ3MsIGJ1dCBjYXVzZSBvZiBYU1MgYXR0YWNrcy4gIEFsd2F5cyBlc2NhcGUgdGhlc2UuCgkgICAgYXV0b0VzY2FwZSA9IFsnXCcnXS5jb25jYXQodW53aXNlKSwKCSAgICAvLyBDaGFyYWN0ZXJzIHRoYXQgYXJlIG5ldmVyIGV2ZXIgYWxsb3dlZCBpbiBhIGhvc3RuYW1lLgoJICAgIC8vIE5vdGUgdGhhdCBhbnkgaW52YWxpZCBjaGFycyBhcmUgYWxzbyBoYW5kbGVkLCBidXQgdGhlc2UKCSAgICAvLyBhcmUgdGhlIG9uZXMgdGhhdCBhcmUgKmV4cGVjdGVkKiB0byBiZSBzZWVuLCBzbyB3ZSBmYXN0LXBhdGgKCSAgICAvLyB0aGVtLgoJICAgIG5vbkhvc3RDaGFycyA9IFsnJScsICcvJywgJz8nLCAnOycsICcjJ10uY29uY2F0KGF1dG9Fc2NhcGUpLAoJICAgIGhvc3RFbmRpbmdDaGFycyA9IFsnLycsICc/JywgJyMnXSwKCSAgICBob3N0bmFtZU1heExlbiA9IDI1NSwKCSAgICBob3N0bmFtZVBhcnRQYXR0ZXJuID0gL15bK2EtejAtOUEtWl8tXXswLDYzfSQvLAoJICAgIGhvc3RuYW1lUGFydFN0YXJ0ID0gL14oWythLXowLTlBLVpfLV17MCw2M30pKC4qKSQvLAoJICAgIC8vIHByb3RvY29scyB0aGF0IGNhbiBhbGxvdyAidW5zYWZlIiBhbmQgInVud2lzZSIgY2hhcnMuCgkgICAgdW5zYWZlUHJvdG9jb2wgPSB7CgkgICAgICAnamF2YXNjcmlwdCc6IHRydWUsCgkgICAgICAnamF2YXNjcmlwdDonOiB0cnVlCgkgICAgfSwKCSAgICAvLyBwcm90b2NvbHMgdGhhdCBuZXZlciBoYXZlIGEgaG9zdG5hbWUuCgkgICAgaG9zdGxlc3NQcm90b2NvbCA9IHsKCSAgICAgICdqYXZhc2NyaXB0JzogdHJ1ZSwKCSAgICAgICdqYXZhc2NyaXB0Oic6IHRydWUKCSAgICB9LAoJICAgIC8vIHByb3RvY29scyB0aGF0IGFsd2F5cyBjb250YWluIGEgLy8gYml0LgoJICAgIHNsYXNoZWRQcm90b2NvbCA9IHsKCSAgICAgICdodHRwJzogdHJ1ZSwKCSAgICAgICdodHRwcyc6IHRydWUsCgkgICAgICAnZnRwJzogdHJ1ZSwKCSAgICAgICdnb3BoZXInOiB0cnVlLAoJICAgICAgJ2ZpbGUnOiB0cnVlLAoJICAgICAgJ2h0dHA6JzogdHJ1ZSwKCSAgICAgICdodHRwczonOiB0cnVlLAoJICAgICAgJ2Z0cDonOiB0cnVlLAoJICAgICAgJ2dvcGhlcjonOiB0cnVlLAoJICAgICAgJ2ZpbGU6JzogdHJ1ZQoJICAgIH0sCgkgICAgcXVlcnlzdHJpbmcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KTsKCglmdW5jdGlvbiB1cmxQYXJzZSh1cmwsIHBhcnNlUXVlcnlTdHJpbmcsIHNsYXNoZXNEZW5vdGVIb3N0KSB7CgkgIGlmICh1cmwgJiYgdXRpbC5pc09iamVjdCh1cmwpICYmIHVybCBpbnN0YW5jZW9mIFVybCkgcmV0dXJuIHVybDsKCgkgIHZhciB1ID0gbmV3IFVybDsKCSAgdS5wYXJzZSh1cmwsIHBhcnNlUXVlcnlTdHJpbmcsIHNsYXNoZXNEZW5vdGVIb3N0KTsKCSAgcmV0dXJuIHU7Cgl9CgoJVXJsLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpIHsKCSAgaWYgKCF1dGlsLmlzU3RyaW5nKHVybCkpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJQYXJhbWV0ZXIgJ3VybCcgbXVzdCBiZSBhIHN0cmluZywgbm90ICIgKyB0eXBlb2YgdXJsKTsKCSAgfQoKCSAgLy8gQ29weSBjaHJvbWUsIElFLCBvcGVyYSBiYWNrc2xhc2gtaGFuZGxpbmcgYmVoYXZpb3IuCgkgIC8vIEJhY2sgc2xhc2hlcyBiZWZvcmUgdGhlIHF1ZXJ5IHN0cmluZyBnZXQgY29udmVydGVkIHRvIGZvcndhcmQgc2xhc2hlcwoJICAvLyBTZWU6IGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0yNTkxNgoJICB2YXIgcXVlcnlJbmRleCA9IHVybC5pbmRleE9mKCc/JyksCgkgICAgICBzcGxpdHRlciA9CgkgICAgICAgICAgKHF1ZXJ5SW5kZXggIT09IC0xICYmIHF1ZXJ5SW5kZXggPCB1cmwuaW5kZXhPZignIycpKSA/ICc/JyA6ICcjJywKCSAgICAgIHVTcGxpdCA9IHVybC5zcGxpdChzcGxpdHRlciksCgkgICAgICBzbGFzaFJlZ2V4ID0gL1xcL2c7CgkgIHVTcGxpdFswXSA9IHVTcGxpdFswXS5yZXBsYWNlKHNsYXNoUmVnZXgsICcvJyk7CgkgIHVybCA9IHVTcGxpdC5qb2luKHNwbGl0dGVyKTsKCgkgIHZhciByZXN0ID0gdXJsOwoKCSAgLy8gdHJpbSBiZWZvcmUgcHJvY2VlZGluZy4KCSAgLy8gVGhpcyBpcyB0byBzdXBwb3J0IHBhcnNlIHN0dWZmIGxpa2UgIiAgaHR0cDovL2Zvby5jb20gIFxuIgoJICByZXN0ID0gcmVzdC50cmltKCk7CgoJICBpZiAoIXNsYXNoZXNEZW5vdGVIb3N0ICYmIHVybC5zcGxpdCgnIycpLmxlbmd0aCA9PT0gMSkgewoJICAgIC8vIFRyeSBmYXN0IHBhdGggcmVnZXhwCgkgICAgdmFyIHNpbXBsZVBhdGggPSBzaW1wbGVQYXRoUGF0dGVybi5leGVjKHJlc3QpOwoJICAgIGlmIChzaW1wbGVQYXRoKSB7CgkgICAgICB0aGlzLnBhdGggPSByZXN0OwoJICAgICAgdGhpcy5ocmVmID0gcmVzdDsKCSAgICAgIHRoaXMucGF0aG5hbWUgPSBzaW1wbGVQYXRoWzFdOwoJICAgICAgaWYgKHNpbXBsZVBhdGhbMl0pIHsKCSAgICAgICAgdGhpcy5zZWFyY2ggPSBzaW1wbGVQYXRoWzJdOwoJICAgICAgICBpZiAocGFyc2VRdWVyeVN0cmluZykgewoJICAgICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeXN0cmluZy5wYXJzZSh0aGlzLnNlYXJjaC5zdWJzdHIoMSkpOwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgIHRoaXMucXVlcnkgPSB0aGlzLnNlYXJjaC5zdWJzdHIoMSk7CgkgICAgICAgIH0KCSAgICAgIH0gZWxzZSBpZiAocGFyc2VRdWVyeVN0cmluZykgewoJICAgICAgICB0aGlzLnNlYXJjaCA9ICcnOwoJICAgICAgICB0aGlzLnF1ZXJ5ID0ge307CgkgICAgICB9CgkgICAgICByZXR1cm4gdGhpczsKCSAgICB9CgkgIH0KCgkgIHZhciBwcm90byA9IHByb3RvY29sUGF0dGVybi5leGVjKHJlc3QpOwoJICBpZiAocHJvdG8pIHsKCSAgICBwcm90byA9IHByb3RvWzBdOwoJICAgIHZhciBsb3dlclByb3RvID0gcHJvdG8udG9Mb3dlckNhc2UoKTsKCSAgICB0aGlzLnByb3RvY29sID0gbG93ZXJQcm90bzsKCSAgICByZXN0ID0gcmVzdC5zdWJzdHIocHJvdG8ubGVuZ3RoKTsKCSAgfQoKCSAgLy8gZmlndXJlIG91dCBpZiBpdCdzIGdvdCBhIGhvc3QKCSAgLy8gdXNlckBzZXJ2ZXIgaXMgKmFsd2F5cyogaW50ZXJwcmV0ZWQgYXMgYSBob3N0bmFtZSwgYW5kIHVybAoJICAvLyByZXNvbHV0aW9uIHdpbGwgdHJlYXQgLy9mb28vYmFyIGFzIGhvc3Q9Zm9vLHBhdGg9YmFyIGJlY2F1c2UgdGhhdCdzCgkgIC8vIGhvdyB0aGUgYnJvd3NlciByZXNvbHZlcyByZWxhdGl2ZSBVUkxzLgoJICBpZiAoc2xhc2hlc0Rlbm90ZUhvc3QgfHwgcHJvdG8gfHwgcmVzdC5tYXRjaCgvXlwvXC9bXkBcL10rQFteQFwvXSsvKSkgewoJICAgIHZhciBzbGFzaGVzID0gcmVzdC5zdWJzdHIoMCwgMikgPT09ICcvLyc7CgkgICAgaWYgKHNsYXNoZXMgJiYgIShwcm90byAmJiBob3N0bGVzc1Byb3RvY29sW3Byb3RvXSkpIHsKCSAgICAgIHJlc3QgPSByZXN0LnN1YnN0cigyKTsKCSAgICAgIHRoaXMuc2xhc2hlcyA9IHRydWU7CgkgICAgfQoJICB9CgoJICBpZiAoIWhvc3RsZXNzUHJvdG9jb2xbcHJvdG9dICYmCgkgICAgICAoc2xhc2hlcyB8fCAocHJvdG8gJiYgIXNsYXNoZWRQcm90b2NvbFtwcm90b10pKSkgewoKCSAgICAvLyB0aGVyZSdzIGEgaG9zdG5hbWUuCgkgICAgLy8gdGhlIGZpcnN0IGluc3RhbmNlIG9mIC8sID8sIDssIG9yICMgZW5kcyB0aGUgaG9zdC4KCSAgICAvLwoJICAgIC8vIElmIHRoZXJlIGlzIGFuIEAgaW4gdGhlIGhvc3RuYW1lLCB0aGVuIG5vbi1ob3N0IGNoYXJzICphcmUqIGFsbG93ZWQKCSAgICAvLyB0byB0aGUgbGVmdCBvZiB0aGUgbGFzdCBAIHNpZ24sIHVubGVzcyBzb21lIGhvc3QtZW5kaW5nIGNoYXJhY3RlcgoJICAgIC8vIGNvbWVzICpiZWZvcmUqIHRoZSBALXNpZ24uCgkgICAgLy8gVVJMcyBhcmUgb2Jub3hpb3VzLgoJICAgIC8vCgkgICAgLy8gZXg6CgkgICAgLy8gaHR0cDovL2FAYkBjLyA9PiB1c2VyOmFAYiBob3N0OmMKCSAgICAvLyBodHRwOi8vYUBiP0BjID0+IHVzZXI6YSBob3N0OmMgcGF0aDovP0BjCgoJICAgIC8vIHYwLjEyIFRPRE8oaXNhYWNzKTogVGhpcyBpcyBub3QgcXVpdGUgaG93IENocm9tZSBkb2VzIHRoaW5ncy4KCSAgICAvLyBSZXZpZXcgb3VyIHRlc3QgY2FzZSBhZ2FpbnN0IGJyb3dzZXJzIG1vcmUgY29tcHJlaGVuc2l2ZWx5LgoKCSAgICAvLyBmaW5kIHRoZSBmaXJzdCBpbnN0YW5jZSBvZiBhbnkgaG9zdEVuZGluZ0NoYXJzCgkgICAgdmFyIGhvc3RFbmQgPSAtMTsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhvc3RFbmRpbmdDaGFycy5sZW5ndGg7IGkrKykgewoJICAgICAgdmFyIGhlYyA9IHJlc3QuaW5kZXhPZihob3N0RW5kaW5nQ2hhcnNbaV0pOwoJICAgICAgaWYgKGhlYyAhPT0gLTEgJiYgKGhvc3RFbmQgPT09IC0xIHx8IGhlYyA8IGhvc3RFbmQpKQoJICAgICAgICBob3N0RW5kID0gaGVjOwoJICAgIH0KCgkgICAgLy8gYXQgdGhpcyBwb2ludCwgZWl0aGVyIHdlIGhhdmUgYW4gZXhwbGljaXQgcG9pbnQgd2hlcmUgdGhlCgkgICAgLy8gYXV0aCBwb3J0aW9uIGNhbm5vdCBnbyBwYXN0LCBvciB0aGUgbGFzdCBAIGNoYXIgaXMgdGhlIGRlY2lkZXIuCgkgICAgdmFyIGF1dGgsIGF0U2lnbjsKCSAgICBpZiAoaG9zdEVuZCA9PT0gLTEpIHsKCSAgICAgIC8vIGF0U2lnbiBjYW4gYmUgYW55d2hlcmUuCgkgICAgICBhdFNpZ24gPSByZXN0Lmxhc3RJbmRleE9mKCdAJyk7CgkgICAgfSBlbHNlIHsKCSAgICAgIC8vIGF0U2lnbiBtdXN0IGJlIGluIGF1dGggcG9ydGlvbi4KCSAgICAgIC8vIGh0dHA6Ly9hQGIvY0BkID0+IGhvc3Q6YiBhdXRoOmEgcGF0aDovY0BkCgkgICAgICBhdFNpZ24gPSByZXN0Lmxhc3RJbmRleE9mKCdAJywgaG9zdEVuZCk7CgkgICAgfQoKCSAgICAvLyBOb3cgd2UgaGF2ZSBhIHBvcnRpb24gd2hpY2ggaXMgZGVmaW5pdGVseSB0aGUgYXV0aC4KCSAgICAvLyBQdWxsIHRoYXQgb2ZmLgoJICAgIGlmIChhdFNpZ24gIT09IC0xKSB7CgkgICAgICBhdXRoID0gcmVzdC5zbGljZSgwLCBhdFNpZ24pOwoJICAgICAgcmVzdCA9IHJlc3Quc2xpY2UoYXRTaWduICsgMSk7CgkgICAgICB0aGlzLmF1dGggPSBkZWNvZGVVUklDb21wb25lbnQoYXV0aCk7CgkgICAgfQoKCSAgICAvLyB0aGUgaG9zdCBpcyB0aGUgcmVtYWluaW5nIHRvIHRoZSBsZWZ0IG9mIHRoZSBmaXJzdCBub24taG9zdCBjaGFyCgkgICAgaG9zdEVuZCA9IC0xOwoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9uSG9zdENoYXJzLmxlbmd0aDsgaSsrKSB7CgkgICAgICB2YXIgaGVjID0gcmVzdC5pbmRleE9mKG5vbkhvc3RDaGFyc1tpXSk7CgkgICAgICBpZiAoaGVjICE9PSAtMSAmJiAoaG9zdEVuZCA9PT0gLTEgfHwgaGVjIDwgaG9zdEVuZCkpCgkgICAgICAgIGhvc3RFbmQgPSBoZWM7CgkgICAgfQoJICAgIC8vIGlmIHdlIHN0aWxsIGhhdmUgbm90IGhpdCBpdCwgdGhlbiB0aGUgZW50aXJlIHRoaW5nIGlzIGEgaG9zdC4KCSAgICBpZiAoaG9zdEVuZCA9PT0gLTEpCgkgICAgICBob3N0RW5kID0gcmVzdC5sZW5ndGg7CgoJICAgIHRoaXMuaG9zdCA9IHJlc3Quc2xpY2UoMCwgaG9zdEVuZCk7CgkgICAgcmVzdCA9IHJlc3Quc2xpY2UoaG9zdEVuZCk7CgoJICAgIC8vIHB1bGwgb3V0IHBvcnQuCgkgICAgdGhpcy5wYXJzZUhvc3QoKTsKCgkgICAgLy8gd2UndmUgaW5kaWNhdGVkIHRoYXQgdGhlcmUgaXMgYSBob3N0bmFtZSwKCSAgICAvLyBzbyBldmVuIGlmIGl0J3MgZW1wdHksIGl0IGhhcyB0byBiZSBwcmVzZW50LgoJICAgIHRoaXMuaG9zdG5hbWUgPSB0aGlzLmhvc3RuYW1lIHx8ICcnOwoKCSAgICAvLyBpZiBob3N0bmFtZSBiZWdpbnMgd2l0aCBbIGFuZCBlbmRzIHdpdGggXQoJICAgIC8vIGFzc3VtZSB0aGF0IGl0J3MgYW4gSVB2NiBhZGRyZXNzLgoJICAgIHZhciBpcHY2SG9zdG5hbWUgPSB0aGlzLmhvc3RuYW1lWzBdID09PSAnWycgJiYKCSAgICAgICAgdGhpcy5ob3N0bmFtZVt0aGlzLmhvc3RuYW1lLmxlbmd0aCAtIDFdID09PSAnXSc7CgoJICAgIC8vIHZhbGlkYXRlIGEgbGl0dGxlLgoJICAgIGlmICghaXB2Nkhvc3RuYW1lKSB7CgkgICAgICB2YXIgaG9zdHBhcnRzID0gdGhpcy5ob3N0bmFtZS5zcGxpdCgvXC4vKTsKCSAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gaG9zdHBhcnRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewoJICAgICAgICB2YXIgcGFydCA9IGhvc3RwYXJ0c1tpXTsKCSAgICAgICAgaWYgKCFwYXJ0KSBjb250aW51ZTsKCSAgICAgICAgaWYgKCFwYXJ0Lm1hdGNoKGhvc3RuYW1lUGFydFBhdHRlcm4pKSB7CgkgICAgICAgICAgdmFyIG5ld3BhcnQgPSAnJzsKCSAgICAgICAgICBmb3IgKHZhciBqID0gMCwgayA9IHBhcnQubGVuZ3RoOyBqIDwgazsgaisrKSB7CgkgICAgICAgICAgICBpZiAocGFydC5jaGFyQ29kZUF0KGopID4gMTI3KSB7CgkgICAgICAgICAgICAgIC8vIHdlIHJlcGxhY2Ugbm9uLUFTQ0lJIGNoYXIgd2l0aCBhIHRlbXBvcmFyeSBwbGFjZWhvbGRlcgoJICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRoaXMgdG8gbWFrZSBzdXJlIHNpemUgb2YgaG9zdG5hbWUgaXMgbm90CgkgICAgICAgICAgICAgIC8vIGJyb2tlbiBieSByZXBsYWNpbmcgbm9uLUFTQ0lJIGJ5IG5vdGhpbmcKCSAgICAgICAgICAgICAgbmV3cGFydCArPSAneCc7CgkgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICBuZXdwYXJ0ICs9IHBhcnRbal07CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfQoJICAgICAgICAgIC8vIHdlIHRlc3QgYWdhaW4gd2l0aCBBU0NJSSBjaGFyIG9ubHkKCSAgICAgICAgICBpZiAoIW5ld3BhcnQubWF0Y2goaG9zdG5hbWVQYXJ0UGF0dGVybikpIHsKCSAgICAgICAgICAgIHZhciB2YWxpZFBhcnRzID0gaG9zdHBhcnRzLnNsaWNlKDAsIGkpOwoJICAgICAgICAgICAgdmFyIG5vdEhvc3QgPSBob3N0cGFydHMuc2xpY2UoaSArIDEpOwoJICAgICAgICAgICAgdmFyIGJpdCA9IHBhcnQubWF0Y2goaG9zdG5hbWVQYXJ0U3RhcnQpOwoJICAgICAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgICB2YWxpZFBhcnRzLnB1c2goYml0WzFdKTsKCSAgICAgICAgICAgICAgbm90SG9zdC51bnNoaWZ0KGJpdFsyXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAobm90SG9zdC5sZW5ndGgpIHsKCSAgICAgICAgICAgICAgcmVzdCA9ICcvJyArIG5vdEhvc3Quam9pbignLicpICsgcmVzdDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHRoaXMuaG9zdG5hbWUgPSB2YWxpZFBhcnRzLmpvaW4oJy4nKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgfQoJICAgIH0KCgkgICAgaWYgKHRoaXMuaG9zdG5hbWUubGVuZ3RoID4gaG9zdG5hbWVNYXhMZW4pIHsKCSAgICAgIHRoaXMuaG9zdG5hbWUgPSAnJzsKCSAgICB9IGVsc2UgewoJICAgICAgLy8gaG9zdG5hbWVzIGFyZSBhbHdheXMgbG93ZXIgY2FzZS4KCSAgICAgIHRoaXMuaG9zdG5hbWUgPSB0aGlzLmhvc3RuYW1lLnRvTG93ZXJDYXNlKCk7CgkgICAgfQoKCSAgICBpZiAoIWlwdjZIb3N0bmFtZSkgewoJICAgICAgLy8gSUROQSBTdXBwb3J0OiBSZXR1cm5zIGEgcHVueWNvZGVkIHJlcHJlc2VudGF0aW9uIG9mICJkb21haW4iLgoJICAgICAgLy8gSXQgb25seSBjb252ZXJ0cyBwYXJ0cyBvZiB0aGUgZG9tYWluIG5hbWUgdGhhdAoJICAgICAgLy8gaGF2ZSBub24tQVNDSUkgY2hhcmFjdGVycywgaS5lLiBpdCBkb2Vzbid0IG1hdHRlciBpZgoJICAgICAgLy8geW91IGNhbGwgaXQgd2l0aCBhIGRvbWFpbiB0aGF0IGFscmVhZHkgaXMgQVNDSUktb25seS4KCSAgICAgIHRoaXMuaG9zdG5hbWUgPSBwdW55Y29kZS50b0FTQ0lJKHRoaXMuaG9zdG5hbWUpOwoJICAgIH0KCgkgICAgdmFyIHAgPSB0aGlzLnBvcnQgPyAnOicgKyB0aGlzLnBvcnQgOiAnJzsKCSAgICB2YXIgaCA9IHRoaXMuaG9zdG5hbWUgfHwgJyc7CgkgICAgdGhpcy5ob3N0ID0gaCArIHA7CgkgICAgdGhpcy5ocmVmICs9IHRoaXMuaG9zdDsKCgkgICAgLy8gc3RyaXAgWyBhbmQgXSBmcm9tIHRoZSBob3N0bmFtZQoJICAgIC8vIHRoZSBob3N0IGZpZWxkIHN0aWxsIHJldGFpbnMgdGhlbSwgdGhvdWdoCgkgICAgaWYgKGlwdjZIb3N0bmFtZSkgewoJICAgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUuc3Vic3RyKDEsIHRoaXMuaG9zdG5hbWUubGVuZ3RoIC0gMik7CgkgICAgICBpZiAocmVzdFswXSAhPT0gJy8nKSB7CgkgICAgICAgIHJlc3QgPSAnLycgKyByZXN0OwoJICAgICAgfQoJICAgIH0KCSAgfQoKCSAgLy8gbm93IHJlc3QgaXMgc2V0IHRvIHRoZSBwb3N0LWhvc3Qgc3R1ZmYuCgkgIC8vIGNob3Agb2ZmIGFueSBkZWxpbSBjaGFycy4KCSAgaWYgKCF1bnNhZmVQcm90b2NvbFtsb3dlclByb3RvXSkgewoKCSAgICAvLyBGaXJzdCwgbWFrZSAxMDAlIHN1cmUgdGhhdCBhbnkgImF1dG9Fc2NhcGUiIGNoYXJzIGdldAoJICAgIC8vIGVzY2FwZWQsIGV2ZW4gaWYgZW5jb2RlVVJJQ29tcG9uZW50IGRvZXNuJ3QgdGhpbmsgdGhleQoJICAgIC8vIG5lZWQgdG8gYmUuCgkgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBhdXRvRXNjYXBlLmxlbmd0aDsgaSA8IGw7IGkrKykgewoJICAgICAgdmFyIGFlID0gYXV0b0VzY2FwZVtpXTsKCSAgICAgIGlmIChyZXN0LmluZGV4T2YoYWUpID09PSAtMSkKCSAgICAgICAgY29udGludWU7CgkgICAgICB2YXIgZXNjID0gZW5jb2RlVVJJQ29tcG9uZW50KGFlKTsKCSAgICAgIGlmIChlc2MgPT09IGFlKSB7CgkgICAgICAgIGVzYyA9IGVzY2FwZShhZSk7CgkgICAgICB9CgkgICAgICByZXN0ID0gcmVzdC5zcGxpdChhZSkuam9pbihlc2MpOwoJICAgIH0KCSAgfQoKCgkgIC8vIGNob3Agb2ZmIGZyb20gdGhlIHRhaWwgZmlyc3QuCgkgIHZhciBoYXNoID0gcmVzdC5pbmRleE9mKCcjJyk7CgkgIGlmIChoYXNoICE9PSAtMSkgewoJICAgIC8vIGdvdCBhIGZyYWdtZW50IHN0cmluZy4KCSAgICB0aGlzLmhhc2ggPSByZXN0LnN1YnN0cihoYXNoKTsKCSAgICByZXN0ID0gcmVzdC5zbGljZSgwLCBoYXNoKTsKCSAgfQoJICB2YXIgcW0gPSByZXN0LmluZGV4T2YoJz8nKTsKCSAgaWYgKHFtICE9PSAtMSkgewoJICAgIHRoaXMuc2VhcmNoID0gcmVzdC5zdWJzdHIocW0pOwoJICAgIHRoaXMucXVlcnkgPSByZXN0LnN1YnN0cihxbSArIDEpOwoJICAgIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7CgkgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnlzdHJpbmcucGFyc2UodGhpcy5xdWVyeSk7CgkgICAgfQoJICAgIHJlc3QgPSByZXN0LnNsaWNlKDAsIHFtKTsKCSAgfSBlbHNlIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7CgkgICAgLy8gbm8gcXVlcnkgc3RyaW5nLCBidXQgcGFyc2VRdWVyeVN0cmluZyBzdGlsbCByZXF1ZXN0ZWQKCSAgICB0aGlzLnNlYXJjaCA9ICcnOwoJICAgIHRoaXMucXVlcnkgPSB7fTsKCSAgfQoJICBpZiAocmVzdCkgdGhpcy5wYXRobmFtZSA9IHJlc3Q7CgkgIGlmIChzbGFzaGVkUHJvdG9jb2xbbG93ZXJQcm90b10gJiYKCSAgICAgIHRoaXMuaG9zdG5hbWUgJiYgIXRoaXMucGF0aG5hbWUpIHsKCSAgICB0aGlzLnBhdGhuYW1lID0gJy8nOwoJICB9CgoJICAvL3RvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0CgkgIGlmICh0aGlzLnBhdGhuYW1lIHx8IHRoaXMuc2VhcmNoKSB7CgkgICAgdmFyIHAgPSB0aGlzLnBhdGhuYW1lIHx8ICcnOwoJICAgIHZhciBzID0gdGhpcy5zZWFyY2ggfHwgJyc7CgkgICAgdGhpcy5wYXRoID0gcCArIHM7CgkgIH0KCgkgIC8vIGZpbmFsbHksIHJlY29uc3RydWN0IHRoZSBocmVmIGJhc2VkIG9uIHdoYXQgaGFzIGJlZW4gdmFsaWRhdGVkLgoJICB0aGlzLmhyZWYgPSB0aGlzLmZvcm1hdCgpOwoJICByZXR1cm4gdGhpczsKCX07CgoJLy8gZm9ybWF0IGEgcGFyc2VkIG9iamVjdCBpbnRvIGEgdXJsIHN0cmluZwoJZnVuY3Rpb24gdXJsRm9ybWF0KG9iaikgewoJICAvLyBlbnN1cmUgaXQncyBhbiBvYmplY3QsIGFuZCBub3QgYSBzdHJpbmcgdXJsLgoJICAvLyBJZiBpdCdzIGFuIG9iaiwgdGhpcyBpcyBhIG5vLW9wLgoJICAvLyB0aGlzIHdheSwgeW91IGNhbiBjYWxsIHVybF9mb3JtYXQoKSBvbiBzdHJpbmdzCgkgIC8vIHRvIGNsZWFuIHVwIHBvdGVudGlhbGx5IHdvbmt5IHVybHMuCgkgIGlmICh1dGlsLmlzU3RyaW5nKG9iaikpIG9iaiA9IHVybFBhcnNlKG9iaik7CgkgIGlmICghKG9iaiBpbnN0YW5jZW9mIFVybCkpIHJldHVybiBVcmwucHJvdG90eXBlLmZvcm1hdC5jYWxsKG9iaik7CgkgIHJldHVybiBvYmouZm9ybWF0KCk7Cgl9CgoJVXJsLnByb3RvdHlwZS5mb3JtYXQgPSBmdW5jdGlvbigpIHsKCSAgdmFyIGF1dGggPSB0aGlzLmF1dGggfHwgJyc7CgkgIGlmIChhdXRoKSB7CgkgICAgYXV0aCA9IGVuY29kZVVSSUNvbXBvbmVudChhdXRoKTsKCSAgICBhdXRoID0gYXV0aC5yZXBsYWNlKC8lM0EvaSwgJzonKTsKCSAgICBhdXRoICs9ICdAJzsKCSAgfQoKCSAgdmFyIHByb3RvY29sID0gdGhpcy5wcm90b2NvbCB8fCAnJywKCSAgICAgIHBhdGhuYW1lID0gdGhpcy5wYXRobmFtZSB8fCAnJywKCSAgICAgIGhhc2ggPSB0aGlzLmhhc2ggfHwgJycsCgkgICAgICBob3N0ID0gZmFsc2UsCgkgICAgICBxdWVyeSA9ICcnOwoKCSAgaWYgKHRoaXMuaG9zdCkgewoJICAgIGhvc3QgPSBhdXRoICsgdGhpcy5ob3N0OwoJICB9IGVsc2UgaWYgKHRoaXMuaG9zdG5hbWUpIHsKCSAgICBob3N0ID0gYXV0aCArICh0aGlzLmhvc3RuYW1lLmluZGV4T2YoJzonKSA9PT0gLTEgPwoJICAgICAgICB0aGlzLmhvc3RuYW1lIDoKCSAgICAgICAgJ1snICsgdGhpcy5ob3N0bmFtZSArICddJyk7CgkgICAgaWYgKHRoaXMucG9ydCkgewoJICAgICAgaG9zdCArPSAnOicgKyB0aGlzLnBvcnQ7CgkgICAgfQoJICB9CgoJICBpZiAodGhpcy5xdWVyeSAmJgoJICAgICAgdXRpbC5pc09iamVjdCh0aGlzLnF1ZXJ5KSAmJgoJICAgICAgT2JqZWN0LmtleXModGhpcy5xdWVyeSkubGVuZ3RoKSB7CgkgICAgcXVlcnkgPSBxdWVyeXN0cmluZy5zdHJpbmdpZnkodGhpcy5xdWVyeSk7CgkgIH0KCgkgIHZhciBzZWFyY2ggPSB0aGlzLnNlYXJjaCB8fCAocXVlcnkgJiYgKCc/JyArIHF1ZXJ5KSkgfHwgJyc7CgoJICBpZiAocHJvdG9jb2wgJiYgcHJvdG9jb2wuc3Vic3RyKC0xKSAhPT0gJzonKSBwcm90b2NvbCArPSAnOic7CgoJICAvLyBvbmx5IHRoZSBzbGFzaGVkUHJvdG9jb2xzIGdldCB0aGUgLy8uICBOb3QgbWFpbHRvOiwgeG1wcDosIGV0Yy4KCSAgLy8gdW5sZXNzIHRoZXkgaGFkIHRoZW0gdG8gYmVnaW4gd2l0aC4KCSAgaWYgKHRoaXMuc2xhc2hlcyB8fAoJICAgICAgKCFwcm90b2NvbCB8fCBzbGFzaGVkUHJvdG9jb2xbcHJvdG9jb2xdKSAmJiBob3N0ICE9PSBmYWxzZSkgewoJICAgIGhvc3QgPSAnLy8nICsgKGhvc3QgfHwgJycpOwoJICAgIGlmIChwYXRobmFtZSAmJiBwYXRobmFtZS5jaGFyQXQoMCkgIT09ICcvJykgcGF0aG5hbWUgPSAnLycgKyBwYXRobmFtZTsKCSAgfSBlbHNlIGlmICghaG9zdCkgewoJICAgIGhvc3QgPSAnJzsKCSAgfQoKCSAgaWYgKGhhc2ggJiYgaGFzaC5jaGFyQXQoMCkgIT09ICcjJykgaGFzaCA9ICcjJyArIGhhc2g7CgkgIGlmIChzZWFyY2ggJiYgc2VhcmNoLmNoYXJBdCgwKSAhPT0gJz8nKSBzZWFyY2ggPSAnPycgKyBzZWFyY2g7CgoJICBwYXRobmFtZSA9IHBhdGhuYW1lLnJlcGxhY2UoL1s/I10vZywgZnVuY3Rpb24obWF0Y2gpIHsKCSAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KG1hdGNoKTsKCSAgfSk7CgkgIHNlYXJjaCA9IHNlYXJjaC5yZXBsYWNlKCcjJywgJyUyMycpOwoKCSAgcmV0dXJuIHByb3RvY29sICsgaG9zdCArIHBhdGhuYW1lICsgc2VhcmNoICsgaGFzaDsKCX07CgoJZnVuY3Rpb24gdXJsUmVzb2x2ZShzb3VyY2UsIHJlbGF0aXZlKSB7CgkgIHJldHVybiB1cmxQYXJzZShzb3VyY2UsIGZhbHNlLCB0cnVlKS5yZXNvbHZlKHJlbGF0aXZlKTsKCX0KCglVcmwucHJvdG90eXBlLnJlc29sdmUgPSBmdW5jdGlvbihyZWxhdGl2ZSkgewoJICByZXR1cm4gdGhpcy5yZXNvbHZlT2JqZWN0KHVybFBhcnNlKHJlbGF0aXZlLCBmYWxzZSwgdHJ1ZSkpLmZvcm1hdCgpOwoJfTsKCglmdW5jdGlvbiB1cmxSZXNvbHZlT2JqZWN0KHNvdXJjZSwgcmVsYXRpdmUpIHsKCSAgaWYgKCFzb3VyY2UpIHJldHVybiByZWxhdGl2ZTsKCSAgcmV0dXJuIHVybFBhcnNlKHNvdXJjZSwgZmFsc2UsIHRydWUpLnJlc29sdmVPYmplY3QocmVsYXRpdmUpOwoJfQoKCVVybC5wcm90b3R5cGUucmVzb2x2ZU9iamVjdCA9IGZ1bmN0aW9uKHJlbGF0aXZlKSB7CgkgIGlmICh1dGlsLmlzU3RyaW5nKHJlbGF0aXZlKSkgewoJICAgIHZhciByZWwgPSBuZXcgVXJsKCk7CgkgICAgcmVsLnBhcnNlKHJlbGF0aXZlLCBmYWxzZSwgdHJ1ZSk7CgkgICAgcmVsYXRpdmUgPSByZWw7CgkgIH0KCgkgIHZhciByZXN1bHQgPSBuZXcgVXJsKCk7CgkgIHZhciB0a2V5cyA9IE9iamVjdC5rZXlzKHRoaXMpOwoJICBmb3IgKHZhciB0ayA9IDA7IHRrIDwgdGtleXMubGVuZ3RoOyB0aysrKSB7CgkgICAgdmFyIHRrZXkgPSB0a2V5c1t0a107CgkgICAgcmVzdWx0W3RrZXldID0gdGhpc1t0a2V5XTsKCSAgfQoKCSAgLy8gaGFzaCBpcyBhbHdheXMgb3ZlcnJpZGRlbiwgbm8gbWF0dGVyIHdoYXQuCgkgIC8vIGV2ZW4gaHJlZj0iIiB3aWxsIHJlbW92ZSBpdC4KCSAgcmVzdWx0Lmhhc2ggPSByZWxhdGl2ZS5oYXNoOwoKCSAgLy8gaWYgdGhlIHJlbGF0aXZlIHVybCBpcyBlbXB0eSwgdGhlbiB0aGVyZSdzIG5vdGhpbmcgbGVmdCB0byBkbyBoZXJlLgoJICBpZiAocmVsYXRpdmUuaHJlZiA9PT0gJycpIHsKCSAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTsKCSAgICByZXR1cm4gcmVzdWx0OwoJICB9CgoJICAvLyBocmVmcyBsaWtlIC8vZm9vL2JhciBhbHdheXMgY3V0IHRvIHRoZSBwcm90b2NvbC4KCSAgaWYgKHJlbGF0aXZlLnNsYXNoZXMgJiYgIXJlbGF0aXZlLnByb3RvY29sKSB7CgkgICAgLy8gdGFrZSBldmVyeXRoaW5nIGV4Y2VwdCB0aGUgcHJvdG9jb2wgZnJvbSByZWxhdGl2ZQoJICAgIHZhciBya2V5cyA9IE9iamVjdC5rZXlzKHJlbGF0aXZlKTsKCSAgICBmb3IgKHZhciByayA9IDA7IHJrIDwgcmtleXMubGVuZ3RoOyByaysrKSB7CgkgICAgICB2YXIgcmtleSA9IHJrZXlzW3JrXTsKCSAgICAgIGlmIChya2V5ICE9PSAncHJvdG9jb2wnKQoJICAgICAgICByZXN1bHRbcmtleV0gPSByZWxhdGl2ZVtya2V5XTsKCSAgICB9CgoJICAgIC8vdXJsUGFyc2UgYXBwZW5kcyB0cmFpbGluZyAvIHRvIHVybHMgbGlrZSBodHRwOi8vd3d3LmV4YW1wbGUuY29tCgkgICAgaWYgKHNsYXNoZWRQcm90b2NvbFtyZXN1bHQucHJvdG9jb2xdICYmCgkgICAgICAgIHJlc3VsdC5ob3N0bmFtZSAmJiAhcmVzdWx0LnBhdGhuYW1lKSB7CgkgICAgICByZXN1bHQucGF0aCA9IHJlc3VsdC5wYXRobmFtZSA9ICcvJzsKCSAgICB9CgoJICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpOwoJICAgIHJldHVybiByZXN1bHQ7CgkgIH0KCgkgIGlmIChyZWxhdGl2ZS5wcm90b2NvbCAmJiByZWxhdGl2ZS5wcm90b2NvbCAhPT0gcmVzdWx0LnByb3RvY29sKSB7CgkgICAgLy8gaWYgaXQncyBhIGtub3duIHVybCBwcm90b2NvbCwgdGhlbiBjaGFuZ2luZwoJICAgIC8vIHRoZSBwcm90b2NvbCBkb2VzIHdlaXJkIHRoaW5ncwoJICAgIC8vIGZpcnN0LCBpZiBpdCdzIG5vdCBmaWxlOiwgdGhlbiB3ZSBNVVNUIGhhdmUgYSBob3N0LAoJICAgIC8vIGFuZCBpZiB0aGVyZSB3YXMgYSBwYXRoCgkgICAgLy8gdG8gYmVnaW4gd2l0aCwgdGhlbiB3ZSBNVVNUIGhhdmUgYSBwYXRoLgoJICAgIC8vIGlmIGl0IGlzIGZpbGU6LCB0aGVuIHRoZSBob3N0IGlzIGRyb3BwZWQsCgkgICAgLy8gYmVjYXVzZSB0aGF0J3Mga25vd24gdG8gYmUgaG9zdGxlc3MuCgkgICAgLy8gYW55dGhpbmcgZWxzZSBpcyBhc3N1bWVkIHRvIGJlIGFic29sdXRlLgoJICAgIGlmICghc2xhc2hlZFByb3RvY29sW3JlbGF0aXZlLnByb3RvY29sXSkgewoJICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhyZWxhdGl2ZSk7CgkgICAgICBmb3IgKHZhciB2ID0gMDsgdiA8IGtleXMubGVuZ3RoOyB2KyspIHsKCSAgICAgICAgdmFyIGsgPSBrZXlzW3ZdOwoJICAgICAgICByZXN1bHRba10gPSByZWxhdGl2ZVtrXTsKCSAgICAgIH0KCSAgICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpOwoJICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9CgoJICAgIHJlc3VsdC5wcm90b2NvbCA9IHJlbGF0aXZlLnByb3RvY29sOwoJICAgIGlmICghcmVsYXRpdmUuaG9zdCAmJiAhaG9zdGxlc3NQcm90b2NvbFtyZWxhdGl2ZS5wcm90b2NvbF0pIHsKCSAgICAgIHZhciByZWxQYXRoID0gKHJlbGF0aXZlLnBhdGhuYW1lIHx8ICcnKS5zcGxpdCgnLycpOwoJICAgICAgd2hpbGUgKHJlbFBhdGgubGVuZ3RoICYmICEocmVsYXRpdmUuaG9zdCA9IHJlbFBhdGguc2hpZnQoKSkpOwoJICAgICAgaWYgKCFyZWxhdGl2ZS5ob3N0KSByZWxhdGl2ZS5ob3N0ID0gJyc7CgkgICAgICBpZiAoIXJlbGF0aXZlLmhvc3RuYW1lKSByZWxhdGl2ZS5ob3N0bmFtZSA9ICcnOwoJICAgICAgaWYgKHJlbFBhdGhbMF0gIT09ICcnKSByZWxQYXRoLnVuc2hpZnQoJycpOwoJICAgICAgaWYgKHJlbFBhdGgubGVuZ3RoIDwgMikgcmVsUGF0aC51bnNoaWZ0KCcnKTsKCSAgICAgIHJlc3VsdC5wYXRobmFtZSA9IHJlbFBhdGguam9pbignLycpOwoJICAgIH0gZWxzZSB7CgkgICAgICByZXN1bHQucGF0aG5hbWUgPSByZWxhdGl2ZS5wYXRobmFtZTsKCSAgICB9CgkgICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDsKCSAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTsKCSAgICByZXN1bHQuaG9zdCA9IHJlbGF0aXZlLmhvc3QgfHwgJyc7CgkgICAgcmVzdWx0LmF1dGggPSByZWxhdGl2ZS5hdXRoOwoJICAgIHJlc3VsdC5ob3N0bmFtZSA9IHJlbGF0aXZlLmhvc3RuYW1lIHx8IHJlbGF0aXZlLmhvc3Q7CgkgICAgcmVzdWx0LnBvcnQgPSByZWxhdGl2ZS5wb3J0OwoJICAgIC8vIHRvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0CgkgICAgaWYgKHJlc3VsdC5wYXRobmFtZSB8fCByZXN1bHQuc2VhcmNoKSB7CgkgICAgICB2YXIgcCA9IHJlc3VsdC5wYXRobmFtZSB8fCAnJzsKCSAgICAgIHZhciBzID0gcmVzdWx0LnNlYXJjaCB8fCAnJzsKCSAgICAgIHJlc3VsdC5wYXRoID0gcCArIHM7CgkgICAgfQoJICAgIHJlc3VsdC5zbGFzaGVzID0gcmVzdWx0LnNsYXNoZXMgfHwgcmVsYXRpdmUuc2xhc2hlczsKCSAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTsKCSAgICByZXR1cm4gcmVzdWx0OwoJICB9CgoJICB2YXIgaXNTb3VyY2VBYnMgPSAocmVzdWx0LnBhdGhuYW1lICYmIHJlc3VsdC5wYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJyksCgkgICAgICBpc1JlbEFicyA9ICgKCSAgICAgICAgICByZWxhdGl2ZS5ob3N0IHx8CgkgICAgICAgICAgcmVsYXRpdmUucGF0aG5hbWUgJiYgcmVsYXRpdmUucGF0aG5hbWUuY2hhckF0KDApID09PSAnLycKCSAgICAgICksCgkgICAgICBtdXN0RW5kQWJzID0gKGlzUmVsQWJzIHx8IGlzU291cmNlQWJzIHx8CgkgICAgICAgICAgICAgICAgICAgIChyZXN1bHQuaG9zdCAmJiByZWxhdGl2ZS5wYXRobmFtZSkpLAoJICAgICAgcmVtb3ZlQWxsRG90cyA9IG11c3RFbmRBYnMsCgkgICAgICBzcmNQYXRoID0gcmVzdWx0LnBhdGhuYW1lICYmIHJlc3VsdC5wYXRobmFtZS5zcGxpdCgnLycpIHx8IFtdLAoJICAgICAgcmVsUGF0aCA9IHJlbGF0aXZlLnBhdGhuYW1lICYmIHJlbGF0aXZlLnBhdGhuYW1lLnNwbGl0KCcvJykgfHwgW10sCgkgICAgICBwc3ljaG90aWMgPSByZXN1bHQucHJvdG9jb2wgJiYgIXNsYXNoZWRQcm90b2NvbFtyZXN1bHQucHJvdG9jb2xdOwoKCSAgLy8gaWYgdGhlIHVybCBpcyBhIG5vbi1zbGFzaGVkIHVybCwgdGhlbiByZWxhdGl2ZQoJICAvLyBsaW5rcyBsaWtlIC4uLy4uIHNob3VsZCBiZSBhYmxlCgkgIC8vIHRvIGNyYXdsIHVwIHRvIHRoZSBob3N0bmFtZSwgYXMgd2VsbC4gIFRoaXMgaXMgc3RyYW5nZS4KCSAgLy8gcmVzdWx0LnByb3RvY29sIGhhcyBhbHJlYWR5IGJlZW4gc2V0IGJ5IG5vdy4KCSAgLy8gTGF0ZXIgb24sIHB1dCB0aGUgZmlyc3QgcGF0aCBwYXJ0IGludG8gdGhlIGhvc3QgZmllbGQuCgkgIGlmIChwc3ljaG90aWMpIHsKCSAgICByZXN1bHQuaG9zdG5hbWUgPSAnJzsKCSAgICByZXN1bHQucG9ydCA9IG51bGw7CgkgICAgaWYgKHJlc3VsdC5ob3N0KSB7CgkgICAgICBpZiAoc3JjUGF0aFswXSA9PT0gJycpIHNyY1BhdGhbMF0gPSByZXN1bHQuaG9zdDsKCSAgICAgIGVsc2Ugc3JjUGF0aC51bnNoaWZ0KHJlc3VsdC5ob3N0KTsKCSAgICB9CgkgICAgcmVzdWx0Lmhvc3QgPSAnJzsKCSAgICBpZiAocmVsYXRpdmUucHJvdG9jb2wpIHsKCSAgICAgIHJlbGF0aXZlLmhvc3RuYW1lID0gbnVsbDsKCSAgICAgIHJlbGF0aXZlLnBvcnQgPSBudWxsOwoJICAgICAgaWYgKHJlbGF0aXZlLmhvc3QpIHsKCSAgICAgICAgaWYgKHJlbFBhdGhbMF0gPT09ICcnKSByZWxQYXRoWzBdID0gcmVsYXRpdmUuaG9zdDsKCSAgICAgICAgZWxzZSByZWxQYXRoLnVuc2hpZnQocmVsYXRpdmUuaG9zdCk7CgkgICAgICB9CgkgICAgICByZWxhdGl2ZS5ob3N0ID0gbnVsbDsKCSAgICB9CgkgICAgbXVzdEVuZEFicyA9IG11c3RFbmRBYnMgJiYgKHJlbFBhdGhbMF0gPT09ICcnIHx8IHNyY1BhdGhbMF0gPT09ICcnKTsKCSAgfQoKCSAgaWYgKGlzUmVsQWJzKSB7CgkgICAgLy8gaXQncyBhYnNvbHV0ZS4KCSAgICByZXN1bHQuaG9zdCA9IChyZWxhdGl2ZS5ob3N0IHx8IHJlbGF0aXZlLmhvc3QgPT09ICcnKSA/CgkgICAgICAgICAgICAgICAgICByZWxhdGl2ZS5ob3N0IDogcmVzdWx0Lmhvc3Q7CgkgICAgcmVzdWx0Lmhvc3RuYW1lID0gKHJlbGF0aXZlLmhvc3RuYW1lIHx8IHJlbGF0aXZlLmhvc3RuYW1lID09PSAnJykgPwoJICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aXZlLmhvc3RuYW1lIDogcmVzdWx0Lmhvc3RuYW1lOwoJICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7CgkgICAgcmVzdWx0LnF1ZXJ5ID0gcmVsYXRpdmUucXVlcnk7CgkgICAgc3JjUGF0aCA9IHJlbFBhdGg7CgkgICAgLy8gZmFsbCB0aHJvdWdoIHRvIHRoZSBkb3QtaGFuZGxpbmcgYmVsb3cuCgkgIH0gZWxzZSBpZiAocmVsUGF0aC5sZW5ndGgpIHsKCSAgICAvLyBpdCdzIHJlbGF0aXZlCgkgICAgLy8gdGhyb3cgYXdheSB0aGUgZXhpc3RpbmcgZmlsZSwgYW5kIHRha2UgdGhlIG5ldyBwYXRoIGluc3RlYWQuCgkgICAgaWYgKCFzcmNQYXRoKSBzcmNQYXRoID0gW107CgkgICAgc3JjUGF0aC5wb3AoKTsKCSAgICBzcmNQYXRoID0gc3JjUGF0aC5jb25jYXQocmVsUGF0aCk7CgkgICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDsKCSAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTsKCSAgfSBlbHNlIGlmICghdXRpbC5pc051bGxPclVuZGVmaW5lZChyZWxhdGl2ZS5zZWFyY2gpKSB7CgkgICAgLy8ganVzdCBwdWxsIG91dCB0aGUgc2VhcmNoLgoJICAgIC8vIGxpa2UgaHJlZj0nP2ZvbycuCgkgICAgLy8gUHV0IHRoaXMgYWZ0ZXIgdGhlIG90aGVyIHR3byBjYXNlcyBiZWNhdXNlIGl0IHNpbXBsaWZpZXMgdGhlIGJvb2xlYW5zCgkgICAgaWYgKHBzeWNob3RpYykgewoJICAgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVzdWx0Lmhvc3QgPSBzcmNQYXRoLnNoaWZ0KCk7CgkgICAgICAvL29jY2F0aW9uYWx5IHRoZSBhdXRoIGNhbiBnZXQgc3R1Y2sgb25seSBpbiBob3N0CgkgICAgICAvL3RoaXMgZXNwZWNpYWxseSBoYXBwZW5zIGluIGNhc2VzIGxpa2UKCSAgICAgIC8vdXJsLnJlc29sdmVPYmplY3QoJ21haWx0bzpsb2NhbDFAZG9tYWluMScsICdsb2NhbDJAZG9tYWluMicpCgkgICAgICB2YXIgYXV0aEluSG9zdCA9IHJlc3VsdC5ob3N0ICYmIHJlc3VsdC5ob3N0LmluZGV4T2YoJ0AnKSA+IDAgPwoJICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuaG9zdC5zcGxpdCgnQCcpIDogZmFsc2U7CgkgICAgICBpZiAoYXV0aEluSG9zdCkgewoJICAgICAgICByZXN1bHQuYXV0aCA9IGF1dGhJbkhvc3Quc2hpZnQoKTsKCSAgICAgICAgcmVzdWx0Lmhvc3QgPSByZXN1bHQuaG9zdG5hbWUgPSBhdXRoSW5Ib3N0LnNoaWZ0KCk7CgkgICAgICB9CgkgICAgfQoJICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7CgkgICAgcmVzdWx0LnF1ZXJ5ID0gcmVsYXRpdmUucXVlcnk7CgkgICAgLy90byBzdXBwb3J0IGh0dHAucmVxdWVzdAoJICAgIGlmICghdXRpbC5pc051bGwocmVzdWx0LnBhdGhuYW1lKSB8fCAhdXRpbC5pc051bGwocmVzdWx0LnNlYXJjaCkpIHsKCSAgICAgIHJlc3VsdC5wYXRoID0gKHJlc3VsdC5wYXRobmFtZSA/IHJlc3VsdC5wYXRobmFtZSA6ICcnKSArCgkgICAgICAgICAgICAgICAgICAgIChyZXN1bHQuc2VhcmNoID8gcmVzdWx0LnNlYXJjaCA6ICcnKTsKCSAgICB9CgkgICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7CgkgICAgcmV0dXJuIHJlc3VsdDsKCSAgfQoKCSAgaWYgKCFzcmNQYXRoLmxlbmd0aCkgewoJICAgIC8vIG5vIHBhdGggYXQgYWxsLiAgZWFzeS4KCSAgICAvLyB3ZSd2ZSBhbHJlYWR5IGhhbmRsZWQgdGhlIG90aGVyIHN0dWZmIGFib3ZlLgoJICAgIHJlc3VsdC5wYXRobmFtZSA9IG51bGw7CgkgICAgLy90byBzdXBwb3J0IGh0dHAucmVxdWVzdAoJICAgIGlmIChyZXN1bHQuc2VhcmNoKSB7CgkgICAgICByZXN1bHQucGF0aCA9ICcvJyArIHJlc3VsdC5zZWFyY2g7CgkgICAgfSBlbHNlIHsKCSAgICAgIHJlc3VsdC5wYXRoID0gbnVsbDsKCSAgICB9CgkgICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7CgkgICAgcmV0dXJuIHJlc3VsdDsKCSAgfQoKCSAgLy8gaWYgYSB1cmwgRU5EcyBpbiAuIG9yIC4uLCB0aGVuIGl0IG11c3QgZ2V0IGEgdHJhaWxpbmcgc2xhc2guCgkgIC8vIGhvd2V2ZXIsIGlmIGl0IGVuZHMgaW4gYW55dGhpbmcgZWxzZSBub24tc2xhc2h5LAoJICAvLyB0aGVuIGl0IG11c3QgTk9UIGdldCBhIHRyYWlsaW5nIHNsYXNoLgoJICB2YXIgbGFzdCA9IHNyY1BhdGguc2xpY2UoLTEpWzBdOwoJICB2YXIgaGFzVHJhaWxpbmdTbGFzaCA9ICgKCSAgICAgIChyZXN1bHQuaG9zdCB8fCByZWxhdGl2ZS5ob3N0IHx8IHNyY1BhdGgubGVuZ3RoID4gMSkgJiYKCSAgICAgIChsYXN0ID09PSAnLicgfHwgbGFzdCA9PT0gJy4uJykgfHwgbGFzdCA9PT0gJycpOwoKCSAgLy8gc3RyaXAgc2luZ2xlIGRvdHMsIHJlc29sdmUgZG91YmxlIGRvdHMgdG8gcGFyZW50IGRpcgoJICAvLyBpZiB0aGUgcGF0aCB0cmllcyB0byBnbyBhYm92ZSB0aGUgcm9vdCwgYHVwYCBlbmRzIHVwID4gMAoJICB2YXIgdXAgPSAwOwoJICBmb3IgKHZhciBpID0gc3JjUGF0aC5sZW5ndGg7IGkgPj0gMDsgaS0tKSB7CgkgICAgbGFzdCA9IHNyY1BhdGhbaV07CgkgICAgaWYgKGxhc3QgPT09ICcuJykgewoJICAgICAgc3JjUGF0aC5zcGxpY2UoaSwgMSk7CgkgICAgfSBlbHNlIGlmIChsYXN0ID09PSAnLi4nKSB7CgkgICAgICBzcmNQYXRoLnNwbGljZShpLCAxKTsKCSAgICAgIHVwKys7CgkgICAgfSBlbHNlIGlmICh1cCkgewoJICAgICAgc3JjUGF0aC5zcGxpY2UoaSwgMSk7CgkgICAgICB1cC0tOwoJICAgIH0KCSAgfQoKCSAgLy8gaWYgdGhlIHBhdGggaXMgYWxsb3dlZCB0byBnbyBhYm92ZSB0aGUgcm9vdCwgcmVzdG9yZSBsZWFkaW5nIC4ucwoJICBpZiAoIW11c3RFbmRBYnMgJiYgIXJlbW92ZUFsbERvdHMpIHsKCSAgICBmb3IgKDsgdXAtLTsgdXApIHsKCSAgICAgIHNyY1BhdGgudW5zaGlmdCgnLi4nKTsKCSAgICB9CgkgIH0KCgkgIGlmIChtdXN0RW5kQWJzICYmIHNyY1BhdGhbMF0gIT09ICcnICYmCgkgICAgICAoIXNyY1BhdGhbMF0gfHwgc3JjUGF0aFswXS5jaGFyQXQoMCkgIT09ICcvJykpIHsKCSAgICBzcmNQYXRoLnVuc2hpZnQoJycpOwoJICB9CgoJICBpZiAoaGFzVHJhaWxpbmdTbGFzaCAmJiAoc3JjUGF0aC5qb2luKCcvJykuc3Vic3RyKC0xKSAhPT0gJy8nKSkgewoJICAgIHNyY1BhdGgucHVzaCgnJyk7CgkgIH0KCgkgIHZhciBpc0Fic29sdXRlID0gc3JjUGF0aFswXSA9PT0gJycgfHwKCSAgICAgIChzcmNQYXRoWzBdICYmIHNyY1BhdGhbMF0uY2hhckF0KDApID09PSAnLycpOwoKCSAgLy8gcHV0IHRoZSBob3N0IGJhY2sKCSAgaWYgKHBzeWNob3RpYykgewoJICAgIHJlc3VsdC5ob3N0bmFtZSA9IHJlc3VsdC5ob3N0ID0gaXNBYnNvbHV0ZSA/ICcnIDoKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyY1BhdGgubGVuZ3RoID8gc3JjUGF0aC5zaGlmdCgpIDogJyc7CgkgICAgLy9vY2NhdGlvbmFseSB0aGUgYXV0aCBjYW4gZ2V0IHN0dWNrIG9ubHkgaW4gaG9zdAoJICAgIC8vdGhpcyBlc3BlY2lhbGx5IGhhcHBlbnMgaW4gY2FzZXMgbGlrZQoJICAgIC8vdXJsLnJlc29sdmVPYmplY3QoJ21haWx0bzpsb2NhbDFAZG9tYWluMScsICdsb2NhbDJAZG9tYWluMicpCgkgICAgdmFyIGF1dGhJbkhvc3QgPSByZXN1bHQuaG9zdCAmJiByZXN1bHQuaG9zdC5pbmRleE9mKCdAJykgPiAwID8KCSAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ob3N0LnNwbGl0KCdAJykgOiBmYWxzZTsKCSAgICBpZiAoYXV0aEluSG9zdCkgewoJICAgICAgcmVzdWx0LmF1dGggPSBhdXRoSW5Ib3N0LnNoaWZ0KCk7CgkgICAgICByZXN1bHQuaG9zdCA9IHJlc3VsdC5ob3N0bmFtZSA9IGF1dGhJbkhvc3Quc2hpZnQoKTsKCSAgICB9CgkgIH0KCgkgIG11c3RFbmRBYnMgPSBtdXN0RW5kQWJzIHx8IChyZXN1bHQuaG9zdCAmJiBzcmNQYXRoLmxlbmd0aCk7CgoJICBpZiAobXVzdEVuZEFicyAmJiAhaXNBYnNvbHV0ZSkgewoJICAgIHNyY1BhdGgudW5zaGlmdCgnJyk7CgkgIH0KCgkgIGlmICghc3JjUGF0aC5sZW5ndGgpIHsKCSAgICByZXN1bHQucGF0aG5hbWUgPSBudWxsOwoJICAgIHJlc3VsdC5wYXRoID0gbnVsbDsKCSAgfSBlbHNlIHsKCSAgICByZXN1bHQucGF0aG5hbWUgPSBzcmNQYXRoLmpvaW4oJy8nKTsKCSAgfQoKCSAgLy90byBzdXBwb3J0IHJlcXVlc3QuaHR0cAoJICBpZiAoIXV0aWwuaXNOdWxsKHJlc3VsdC5wYXRobmFtZSkgfHwgIXV0aWwuaXNOdWxsKHJlc3VsdC5zZWFyY2gpKSB7CgkgICAgcmVzdWx0LnBhdGggPSAocmVzdWx0LnBhdGhuYW1lID8gcmVzdWx0LnBhdGhuYW1lIDogJycpICsKCSAgICAgICAgICAgICAgICAgIChyZXN1bHQuc2VhcmNoID8gcmVzdWx0LnNlYXJjaCA6ICcnKTsKCSAgfQoJICByZXN1bHQuYXV0aCA9IHJlbGF0aXZlLmF1dGggfHwgcmVzdWx0LmF1dGg7CgkgIHJlc3VsdC5zbGFzaGVzID0gcmVzdWx0LnNsYXNoZXMgfHwgcmVsYXRpdmUuc2xhc2hlczsKCSAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7CgkgIHJldHVybiByZXN1bHQ7Cgl9OwoKCVVybC5wcm90b3R5cGUucGFyc2VIb3N0ID0gZnVuY3Rpb24oKSB7CgkgIHZhciBob3N0ID0gdGhpcy5ob3N0OwoJICB2YXIgcG9ydCA9IHBvcnRQYXR0ZXJuLmV4ZWMoaG9zdCk7CgkgIGlmIChwb3J0KSB7CgkgICAgcG9ydCA9IHBvcnRbMF07CgkgICAgaWYgKHBvcnQgIT09ICc6JykgewoJICAgICAgdGhpcy5wb3J0ID0gcG9ydC5zdWJzdHIoMSk7CgkgICAgfQoJICAgIGhvc3QgPSBob3N0LnN1YnN0cigwLCBob3N0Lmxlbmd0aCAtIHBvcnQubGVuZ3RoKTsKCSAgfQoJICBpZiAoaG9zdCkgdGhpcy5ob3N0bmFtZSA9IGhvc3Q7Cgl9OwoKCi8qKiovIH0sCi8qIDQyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24obW9kdWxlLCBnbG9iYWwpIHsvKiEgaHR0cHM6Ly9tdGhzLmJlL3B1bnljb2RlIHYxLjMuMiBieSBAbWF0aGlhcyAqLwoJOyhmdW5jdGlvbihyb290KSB7CgoJCS8qKiBEZXRlY3QgZnJlZSB2YXJpYWJsZXMgKi8KCQl2YXIgZnJlZUV4cG9ydHMgPSB0eXBlb2YgZXhwb3J0cyA9PSAnb2JqZWN0JyAmJiBleHBvcnRzICYmCgkJCSFleHBvcnRzLm5vZGVUeXBlICYmIGV4cG9ydHM7CgkJdmFyIGZyZWVNb2R1bGUgPSB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZSAmJgoJCQkhbW9kdWxlLm5vZGVUeXBlICYmIG1vZHVsZTsKCQl2YXIgZnJlZUdsb2JhbCA9IHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgZ2xvYmFsOwoJCWlmICgKCQkJZnJlZUdsb2JhbC5nbG9iYWwgPT09IGZyZWVHbG9iYWwgfHwKCQkJZnJlZUdsb2JhbC53aW5kb3cgPT09IGZyZWVHbG9iYWwgfHwKCQkJZnJlZUdsb2JhbC5zZWxmID09PSBmcmVlR2xvYmFsCgkJKSB7CgkJCXJvb3QgPSBmcmVlR2xvYmFsOwoJCX0KCgkJLyoqCgkJICogVGhlIGBwdW55Y29kZWAgb2JqZWN0LgoJCSAqIEBuYW1lIHB1bnljb2RlCgkJICogQHR5cGUgT2JqZWN0CgkJICovCgkJdmFyIHB1bnljb2RlLAoKCQkvKiogSGlnaGVzdCBwb3NpdGl2ZSBzaWduZWQgMzItYml0IGZsb2F0IHZhbHVlICovCgkJbWF4SW50ID0gMjE0NzQ4MzY0NywgLy8gYWthLiAweDdGRkZGRkZGIG9yIDJeMzEtMQoKCQkvKiogQm9vdHN0cmluZyBwYXJhbWV0ZXJzICovCgkJYmFzZSA9IDM2LAoJCXRNaW4gPSAxLAoJCXRNYXggPSAyNiwKCQlza2V3ID0gMzgsCgkJZGFtcCA9IDcwMCwKCQlpbml0aWFsQmlhcyA9IDcyLAoJCWluaXRpYWxOID0gMTI4LCAvLyAweDgwCgkJZGVsaW1pdGVyID0gJy0nLCAvLyAnXHgyRCcKCgkJLyoqIFJlZ3VsYXIgZXhwcmVzc2lvbnMgKi8KCQlyZWdleFB1bnljb2RlID0gL154bi0tLywKCQlyZWdleE5vbkFTQ0lJID0gL1teXHgyMC1ceDdFXS8sIC8vIHVucHJpbnRhYmxlIEFTQ0lJIGNoYXJzICsgbm9uLUFTQ0lJIGNoYXJzCgkJcmVnZXhTZXBhcmF0b3JzID0gL1tceDJFXHUzMDAyXHVGRjBFXHVGRjYxXS9nLCAvLyBSRkMgMzQ5MCBzZXBhcmF0b3JzCgoJCS8qKiBFcnJvciBtZXNzYWdlcyAqLwoJCWVycm9ycyA9IHsKCQkJJ292ZXJmbG93JzogJ092ZXJmbG93OiBpbnB1dCBuZWVkcyB3aWRlciBpbnRlZ2VycyB0byBwcm9jZXNzJywKCQkJJ25vdC1iYXNpYyc6ICdJbGxlZ2FsIGlucHV0ID49IDB4ODAgKG5vdCBhIGJhc2ljIGNvZGUgcG9pbnQpJywKCQkJJ2ludmFsaWQtaW5wdXQnOiAnSW52YWxpZCBpbnB1dCcKCQl9LAoKCQkvKiogQ29udmVuaWVuY2Ugc2hvcnRjdXRzICovCgkJYmFzZU1pbnVzVE1pbiA9IGJhc2UgLSB0TWluLAoJCWZsb29yID0gTWF0aC5mbG9vciwKCQlzdHJpbmdGcm9tQ2hhckNvZGUgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLAoKCQkvKiogVGVtcG9yYXJ5IHZhcmlhYmxlICovCgkJa2V5OwoKCQkvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCgkJLyoqCgkJICogQSBnZW5lcmljIGVycm9yIHV0aWxpdHkgZnVuY3Rpb24uCgkJICogQHByaXZhdGUKCQkgKiBAcGFyYW0ge1N0cmluZ30gdHlwZSBUaGUgZXJyb3IgdHlwZS4KCQkgKiBAcmV0dXJucyB7RXJyb3J9IFRocm93cyBhIGBSYW5nZUVycm9yYCB3aXRoIHRoZSBhcHBsaWNhYmxlIGVycm9yIG1lc3NhZ2UuCgkJICovCgkJZnVuY3Rpb24gZXJyb3IodHlwZSkgewoJCQl0aHJvdyBSYW5nZUVycm9yKGVycm9yc1t0eXBlXSk7CgkJfQoKCQkvKioKCQkgKiBBIGdlbmVyaWMgYEFycmF5I21hcGAgdXRpbGl0eSBmdW5jdGlvbi4KCQkgKiBAcHJpdmF0ZQoJCSAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpdGVyYXRlIG92ZXIuCgkJICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRoYXQgZ2V0cyBjYWxsZWQgZm9yIGV2ZXJ5IGFycmF5CgkJICogaXRlbS4KCQkgKiBAcmV0dXJucyB7QXJyYXl9IEEgbmV3IGFycmF5IG9mIHZhbHVlcyByZXR1cm5lZCBieSB0aGUgY2FsbGJhY2sgZnVuY3Rpb24uCgkJICovCgkJZnVuY3Rpb24gbWFwKGFycmF5LCBmbikgewoJCQl2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoOwoJCQl2YXIgcmVzdWx0ID0gW107CgkJCXdoaWxlIChsZW5ndGgtLSkgewoJCQkJcmVzdWx0W2xlbmd0aF0gPSBmbihhcnJheVtsZW5ndGhdKTsKCQkJfQoJCQlyZXR1cm4gcmVzdWx0OwoJCX0KCgkJLyoqCgkJICogQSBzaW1wbGUgYEFycmF5I21hcGAtbGlrZSB3cmFwcGVyIHRvIHdvcmsgd2l0aCBkb21haW4gbmFtZSBzdHJpbmdzIG9yIGVtYWlsCgkJICogYWRkcmVzc2VzLgoJCSAqIEBwcml2YXRlCgkJICogQHBhcmFtIHtTdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcy4KCQkgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCBmb3IgZXZlcnkKCQkgKiBjaGFyYWN0ZXIuCgkJICogQHJldHVybnMge0FycmF5fSBBIG5ldyBzdHJpbmcgb2YgY2hhcmFjdGVycyByZXR1cm5lZCBieSB0aGUgY2FsbGJhY2sKCQkgKiBmdW5jdGlvbi4KCQkgKi8KCQlmdW5jdGlvbiBtYXBEb21haW4oc3RyaW5nLCBmbikgewoJCQl2YXIgcGFydHMgPSBzdHJpbmcuc3BsaXQoJ0AnKTsKCQkJdmFyIHJlc3VsdCA9ICcnOwoJCQlpZiAocGFydHMubGVuZ3RoID4gMSkgewoJCQkJLy8gSW4gZW1haWwgYWRkcmVzc2VzLCBvbmx5IHRoZSBkb21haW4gbmFtZSBzaG91bGQgYmUgcHVueWNvZGVkLiBMZWF2ZQoJCQkJLy8gdGhlIGxvY2FsIHBhcnQgKGkuZS4gZXZlcnl0aGluZyB1cCB0byBgQGApIGludGFjdC4KCQkJCXJlc3VsdCA9IHBhcnRzWzBdICsgJ0AnOwoJCQkJc3RyaW5nID0gcGFydHNbMV07CgkJCX0KCQkJLy8gQXZvaWQgYHNwbGl0KHJlZ2V4KWAgZm9yIElFOCBjb21wYXRpYmlsaXR5LiBTZWUgIzE3LgoJCQlzdHJpbmcgPSBzdHJpbmcucmVwbGFjZShyZWdleFNlcGFyYXRvcnMsICdceDJFJyk7CgkJCXZhciBsYWJlbHMgPSBzdHJpbmcuc3BsaXQoJy4nKTsKCQkJdmFyIGVuY29kZWQgPSBtYXAobGFiZWxzLCBmbikuam9pbignLicpOwoJCQlyZXR1cm4gcmVzdWx0ICsgZW5jb2RlZDsKCQl9CgoJCS8qKgoJCSAqIENyZWF0ZXMgYW4gYXJyYXkgY29udGFpbmluZyB0aGUgbnVtZXJpYyBjb2RlIHBvaW50cyBvZiBlYWNoIFVuaWNvZGUKCQkgKiBjaGFyYWN0ZXIgaW4gdGhlIHN0cmluZy4gV2hpbGUgSmF2YVNjcmlwdCB1c2VzIFVDUy0yIGludGVybmFsbHksCgkJICogdGhpcyBmdW5jdGlvbiB3aWxsIGNvbnZlcnQgYSBwYWlyIG9mIHN1cnJvZ2F0ZSBoYWx2ZXMgKGVhY2ggb2Ygd2hpY2gKCQkgKiBVQ1MtMiBleHBvc2VzIGFzIHNlcGFyYXRlIGNoYXJhY3RlcnMpIGludG8gYSBzaW5nbGUgY29kZSBwb2ludCwKCQkgKiBtYXRjaGluZyBVVEYtMTYuCgkJICogQHNlZSBgcHVueWNvZGUudWNzMi5lbmNvZGVgCgkJICogQHNlZSA8aHR0cHM6Ly9tYXRoaWFzYnluZW5zLmJlL25vdGVzL2phdmFzY3JpcHQtZW5jb2Rpbmc+CgkJICogQG1lbWJlck9mIHB1bnljb2RlLnVjczIKCQkgKiBAbmFtZSBkZWNvZGUKCQkgKiBAcGFyYW0ge1N0cmluZ30gc3RyaW5nIFRoZSBVbmljb2RlIGlucHV0IHN0cmluZyAoVUNTLTIpLgoJCSAqIEByZXR1cm5zIHtBcnJheX0gVGhlIG5ldyBhcnJheSBvZiBjb2RlIHBvaW50cy4KCQkgKi8KCQlmdW5jdGlvbiB1Y3MyZGVjb2RlKHN0cmluZykgewoJCQl2YXIgb3V0cHV0ID0gW10sCgkJCSAgICBjb3VudGVyID0gMCwKCQkJICAgIGxlbmd0aCA9IHN0cmluZy5sZW5ndGgsCgkJCSAgICB2YWx1ZSwKCQkJICAgIGV4dHJhOwoJCQl3aGlsZSAoY291bnRlciA8IGxlbmd0aCkgewoJCQkJdmFsdWUgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspOwoJCQkJaWYgKHZhbHVlID49IDB4RDgwMCAmJiB2YWx1ZSA8PSAweERCRkYgJiYgY291bnRlciA8IGxlbmd0aCkgewoJCQkJCS8vIGhpZ2ggc3Vycm9nYXRlLCBhbmQgdGhlcmUgaXMgYSBuZXh0IGNoYXJhY3RlcgoJCQkJCWV4dHJhID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTsKCQkJCQlpZiAoKGV4dHJhICYgMHhGQzAwKSA9PSAweERDMDApIHsgLy8gbG93IHN1cnJvZ2F0ZQoJCQkJCQlvdXRwdXQucHVzaCgoKHZhbHVlICYgMHgzRkYpIDw8IDEwKSArIChleHRyYSAmIDB4M0ZGKSArIDB4MTAwMDApOwoJCQkJCX0gZWxzZSB7CgkJCQkJCS8vIHVubWF0Y2hlZCBzdXJyb2dhdGU7IG9ubHkgYXBwZW5kIHRoaXMgY29kZSB1bml0LCBpbiBjYXNlIHRoZSBuZXh0CgkJCQkJCS8vIGNvZGUgdW5pdCBpcyB0aGUgaGlnaCBzdXJyb2dhdGUgb2YgYSBzdXJyb2dhdGUgcGFpcgoJCQkJCQlvdXRwdXQucHVzaCh2YWx1ZSk7CgkJCQkJCWNvdW50ZXItLTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCW91dHB1dC5wdXNoKHZhbHVlKTsKCQkJCX0KCQkJfQoJCQlyZXR1cm4gb3V0cHV0OwoJCX0KCgkJLyoqCgkJICogQ3JlYXRlcyBhIHN0cmluZyBiYXNlZCBvbiBhbiBhcnJheSBvZiBudW1lcmljIGNvZGUgcG9pbnRzLgoJCSAqIEBzZWUgYHB1bnljb2RlLnVjczIuZGVjb2RlYAoJCSAqIEBtZW1iZXJPZiBwdW55Y29kZS51Y3MyCgkJICogQG5hbWUgZW5jb2RlCgkJICogQHBhcmFtIHtBcnJheX0gY29kZVBvaW50cyBUaGUgYXJyYXkgb2YgbnVtZXJpYyBjb2RlIHBvaW50cy4KCQkgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgbmV3IFVuaWNvZGUgc3RyaW5nIChVQ1MtMikuCgkJICovCgkJZnVuY3Rpb24gdWNzMmVuY29kZShhcnJheSkgewoJCQlyZXR1cm4gbWFwKGFycmF5LCBmdW5jdGlvbih2YWx1ZSkgewoJCQkJdmFyIG91dHB1dCA9ICcnOwoJCQkJaWYgKHZhbHVlID4gMHhGRkZGKSB7CgkJCQkJdmFsdWUgLT0gMHgxMDAwMDsKCQkJCQlvdXRwdXQgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlID4+PiAxMCAmIDB4M0ZGIHwgMHhEODAwKTsKCQkJCQl2YWx1ZSA9IDB4REMwMCB8IHZhbHVlICYgMHgzRkY7CgkJCQl9CgkJCQlvdXRwdXQgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlKTsKCQkJCXJldHVybiBvdXRwdXQ7CgkJCX0pLmpvaW4oJycpOwoJCX0KCgkJLyoqCgkJICogQ29udmVydHMgYSBiYXNpYyBjb2RlIHBvaW50IGludG8gYSBkaWdpdC9pbnRlZ2VyLgoJCSAqIEBzZWUgYGRpZ2l0VG9CYXNpYygpYAoJCSAqIEBwcml2YXRlCgkJICogQHBhcmFtIHtOdW1iZXJ9IGNvZGVQb2ludCBUaGUgYmFzaWMgbnVtZXJpYyBjb2RlIHBvaW50IHZhbHVlLgoJCSAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBudW1lcmljIHZhbHVlIG9mIGEgYmFzaWMgY29kZSBwb2ludCAoZm9yIHVzZSBpbgoJCSAqIHJlcHJlc2VudGluZyBpbnRlZ2VycykgaW4gdGhlIHJhbmdlIGAwYCB0byBgYmFzZSAtIDFgLCBvciBgYmFzZWAgaWYKCQkgKiB0aGUgY29kZSBwb2ludCBkb2VzIG5vdCByZXByZXNlbnQgYSB2YWx1ZS4KCQkgKi8KCQlmdW5jdGlvbiBiYXNpY1RvRGlnaXQoY29kZVBvaW50KSB7CgkJCWlmIChjb2RlUG9pbnQgLSA0OCA8IDEwKSB7CgkJCQlyZXR1cm4gY29kZVBvaW50IC0gMjI7CgkJCX0KCQkJaWYgKGNvZGVQb2ludCAtIDY1IDwgMjYpIHsKCQkJCXJldHVybiBjb2RlUG9pbnQgLSA2NTsKCQkJfQoJCQlpZiAoY29kZVBvaW50IC0gOTcgPCAyNikgewoJCQkJcmV0dXJuIGNvZGVQb2ludCAtIDk3OwoJCQl9CgkJCXJldHVybiBiYXNlOwoJCX0KCgkJLyoqCgkJICogQ29udmVydHMgYSBkaWdpdC9pbnRlZ2VyIGludG8gYSBiYXNpYyBjb2RlIHBvaW50LgoJCSAqIEBzZWUgYGJhc2ljVG9EaWdpdCgpYAoJCSAqIEBwcml2YXRlCgkJICogQHBhcmFtIHtOdW1iZXJ9IGRpZ2l0IFRoZSBudW1lcmljIHZhbHVlIG9mIGEgYmFzaWMgY29kZSBwb2ludC4KCQkgKiBAcmV0dXJucyB7TnVtYmVyfSBUaGUgYmFzaWMgY29kZSBwb2ludCB3aG9zZSB2YWx1ZSAod2hlbiB1c2VkIGZvcgoJCSAqIHJlcHJlc2VudGluZyBpbnRlZ2VycykgaXMgYGRpZ2l0YCwgd2hpY2ggbmVlZHMgdG8gYmUgaW4gdGhlIHJhbmdlCgkJICogYDBgIHRvIGBiYXNlIC0gMWAuIElmIGBmbGFnYCBpcyBub24temVybywgdGhlIHVwcGVyY2FzZSBmb3JtIGlzCgkJICogdXNlZDsgZWxzZSwgdGhlIGxvd2VyY2FzZSBmb3JtIGlzIHVzZWQuIFRoZSBiZWhhdmlvciBpcyB1bmRlZmluZWQKCQkgKiBpZiBgZmxhZ2AgaXMgbm9uLXplcm8gYW5kIGBkaWdpdGAgaGFzIG5vIHVwcGVyY2FzZSBmb3JtLgoJCSAqLwoJCWZ1bmN0aW9uIGRpZ2l0VG9CYXNpYyhkaWdpdCwgZmxhZykgewoJCQkvLyAgMC4uMjUgbWFwIHRvIEFTQ0lJIGEuLnogb3IgQS4uWgoJCQkvLyAyNi4uMzUgbWFwIHRvIEFTQ0lJIDAuLjkKCQkJcmV0dXJuIGRpZ2l0ICsgMjIgKyA3NSAqIChkaWdpdCA8IDI2KSAtICgoZmxhZyAhPSAwKSA8PCA1KTsKCQl9CgoJCS8qKgoJCSAqIEJpYXMgYWRhcHRhdGlvbiBmdW5jdGlvbiBhcyBwZXIgc2VjdGlvbiAzLjQgb2YgUkZDIDM0OTIuCgkJICogaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzQ5MiNzZWN0aW9uLTMuNAoJCSAqIEBwcml2YXRlCgkJICovCgkJZnVuY3Rpb24gYWRhcHQoZGVsdGEsIG51bVBvaW50cywgZmlyc3RUaW1lKSB7CgkJCXZhciBrID0gMDsKCQkJZGVsdGEgPSBmaXJzdFRpbWUgPyBmbG9vcihkZWx0YSAvIGRhbXApIDogZGVsdGEgPj4gMTsKCQkJZGVsdGEgKz0gZmxvb3IoZGVsdGEgLyBudW1Qb2ludHMpOwoJCQlmb3IgKC8qIG5vIGluaXRpYWxpemF0aW9uICovOyBkZWx0YSA+IGJhc2VNaW51c1RNaW4gKiB0TWF4ID4+IDE7IGsgKz0gYmFzZSkgewoJCQkJZGVsdGEgPSBmbG9vcihkZWx0YSAvIGJhc2VNaW51c1RNaW4pOwoJCQl9CgkJCXJldHVybiBmbG9vcihrICsgKGJhc2VNaW51c1RNaW4gKyAxKSAqIGRlbHRhIC8gKGRlbHRhICsgc2tldykpOwoJCX0KCgkJLyoqCgkJICogQ29udmVydHMgYSBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzIHRvIGEgc3RyaW5nIG9mIFVuaWNvZGUKCQkgKiBzeW1ib2xzLgoJCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy4KCQkgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgcmVzdWx0aW5nIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMuCgkJICovCgkJZnVuY3Rpb24gZGVjb2RlKGlucHV0KSB7CgkJCS8vIERvbid0IHVzZSBVQ1MtMgoJCQl2YXIgb3V0cHV0ID0gW10sCgkJCSAgICBpbnB1dExlbmd0aCA9IGlucHV0Lmxlbmd0aCwKCQkJICAgIG91dCwKCQkJICAgIGkgPSAwLAoJCQkgICAgbiA9IGluaXRpYWxOLAoJCQkgICAgYmlhcyA9IGluaXRpYWxCaWFzLAoJCQkgICAgYmFzaWMsCgkJCSAgICBqLAoJCQkgICAgaW5kZXgsCgkJCSAgICBvbGRpLAoJCQkgICAgdywKCQkJICAgIGssCgkJCSAgICBkaWdpdCwKCQkJICAgIHQsCgkJCSAgICAvKiogQ2FjaGVkIGNhbGN1bGF0aW9uIHJlc3VsdHMgKi8KCQkJICAgIGJhc2VNaW51c1Q7CgoJCQkvLyBIYW5kbGUgdGhlIGJhc2ljIGNvZGUgcG9pbnRzOiBsZXQgYGJhc2ljYCBiZSB0aGUgbnVtYmVyIG9mIGlucHV0IGNvZGUKCQkJLy8gcG9pbnRzIGJlZm9yZSB0aGUgbGFzdCBkZWxpbWl0ZXIsIG9yIGAwYCBpZiB0aGVyZSBpcyBub25lLCB0aGVuIGNvcHkKCQkJLy8gdGhlIGZpcnN0IGJhc2ljIGNvZGUgcG9pbnRzIHRvIHRoZSBvdXRwdXQuCgoJCQliYXNpYyA9IGlucHV0Lmxhc3RJbmRleE9mKGRlbGltaXRlcik7CgkJCWlmIChiYXNpYyA8IDApIHsKCQkJCWJhc2ljID0gMDsKCQkJfQoKCQkJZm9yIChqID0gMDsgaiA8IGJhc2ljOyArK2opIHsKCQkJCS8vIGlmIGl0J3Mgbm90IGEgYmFzaWMgY29kZSBwb2ludAoJCQkJaWYgKGlucHV0LmNoYXJDb2RlQXQoaikgPj0gMHg4MCkgewoJCQkJCWVycm9yKCdub3QtYmFzaWMnKTsKCQkJCX0KCQkJCW91dHB1dC5wdXNoKGlucHV0LmNoYXJDb2RlQXQoaikpOwoJCQl9CgoJCQkvLyBNYWluIGRlY29kaW5nIGxvb3A6IHN0YXJ0IGp1c3QgYWZ0ZXIgdGhlIGxhc3QgZGVsaW1pdGVyIGlmIGFueSBiYXNpYyBjb2RlCgkJCS8vIHBvaW50cyB3ZXJlIGNvcGllZDsgc3RhcnQgYXQgdGhlIGJlZ2lubmluZyBvdGhlcndpc2UuCgoJCQlmb3IgKGluZGV4ID0gYmFzaWMgPiAwID8gYmFzaWMgKyAxIDogMDsgaW5kZXggPCBpbnB1dExlbmd0aDsgLyogbm8gZmluYWwgZXhwcmVzc2lvbiAqLykgewoKCQkJCS8vIGBpbmRleGAgaXMgdGhlIGluZGV4IG9mIHRoZSBuZXh0IGNoYXJhY3RlciB0byBiZSBjb25zdW1lZC4KCQkJCS8vIERlY29kZSBhIGdlbmVyYWxpemVkIHZhcmlhYmxlLWxlbmd0aCBpbnRlZ2VyIGludG8gYGRlbHRhYCwKCQkJCS8vIHdoaWNoIGdldHMgYWRkZWQgdG8gYGlgLiBUaGUgb3ZlcmZsb3cgY2hlY2tpbmcgaXMgZWFzaWVyCgkJCQkvLyBpZiB3ZSBpbmNyZWFzZSBgaWAgYXMgd2UgZ28sIHRoZW4gc3VidHJhY3Qgb2ZmIGl0cyBzdGFydGluZwoJCQkJLy8gdmFsdWUgYXQgdGhlIGVuZCB0byBvYnRhaW4gYGRlbHRhYC4KCQkJCWZvciAob2xkaSA9IGksIHcgPSAxLCBrID0gYmFzZTsgLyogbm8gY29uZGl0aW9uICovOyBrICs9IGJhc2UpIHsKCgkJCQkJaWYgKGluZGV4ID49IGlucHV0TGVuZ3RoKSB7CgkJCQkJCWVycm9yKCdpbnZhbGlkLWlucHV0Jyk7CgkJCQkJfQoKCQkJCQlkaWdpdCA9IGJhc2ljVG9EaWdpdChpbnB1dC5jaGFyQ29kZUF0KGluZGV4KyspKTsKCgkJCQkJaWYgKGRpZ2l0ID49IGJhc2UgfHwgZGlnaXQgPiBmbG9vcigobWF4SW50IC0gaSkgLyB3KSkgewoJCQkJCQllcnJvcignb3ZlcmZsb3cnKTsKCQkJCQl9CgoJCQkJCWkgKz0gZGlnaXQgKiB3OwoJCQkJCXQgPSBrIDw9IGJpYXMgPyB0TWluIDogKGsgPj0gYmlhcyArIHRNYXggPyB0TWF4IDogayAtIGJpYXMpOwoKCQkJCQlpZiAoZGlnaXQgPCB0KSB7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCgkJCQkJYmFzZU1pbnVzVCA9IGJhc2UgLSB0OwoJCQkJCWlmICh3ID4gZmxvb3IobWF4SW50IC8gYmFzZU1pbnVzVCkpIHsKCQkJCQkJZXJyb3IoJ292ZXJmbG93Jyk7CgkJCQkJfQoKCQkJCQl3ICo9IGJhc2VNaW51c1Q7CgoJCQkJfQoKCQkJCW91dCA9IG91dHB1dC5sZW5ndGggKyAxOwoJCQkJYmlhcyA9IGFkYXB0KGkgLSBvbGRpLCBvdXQsIG9sZGkgPT0gMCk7CgoJCQkJLy8gYGlgIHdhcyBzdXBwb3NlZCB0byB3cmFwIGFyb3VuZCBmcm9tIGBvdXRgIHRvIGAwYCwKCQkJCS8vIGluY3JlbWVudGluZyBgbmAgZWFjaCB0aW1lLCBzbyB3ZSdsbCBmaXggdGhhdCBub3c6CgkJCQlpZiAoZmxvb3IoaSAvIG91dCkgPiBtYXhJbnQgLSBuKSB7CgkJCQkJZXJyb3IoJ292ZXJmbG93Jyk7CgkJCQl9CgoJCQkJbiArPSBmbG9vcihpIC8gb3V0KTsKCQkJCWkgJT0gb3V0OwoKCQkJCS8vIEluc2VydCBgbmAgYXQgcG9zaXRpb24gYGlgIG9mIHRoZSBvdXRwdXQKCQkJCW91dHB1dC5zcGxpY2UoaSsrLCAwLCBuKTsKCgkJCX0KCgkJCXJldHVybiB1Y3MyZW5jb2RlKG91dHB1dCk7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMgKGUuZy4gYSBkb21haW4gbmFtZSBsYWJlbCkgdG8gYQoJCSAqIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMuCgkJICogQG1lbWJlck9mIHB1bnljb2RlCgkJICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBzdHJpbmcgb2YgVW5pY29kZSBzeW1ib2xzLgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSByZXN1bHRpbmcgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy4KCQkgKi8KCQlmdW5jdGlvbiBlbmNvZGUoaW5wdXQpIHsKCQkJdmFyIG4sCgkJCSAgICBkZWx0YSwKCQkJICAgIGhhbmRsZWRDUENvdW50LAoJCQkgICAgYmFzaWNMZW5ndGgsCgkJCSAgICBiaWFzLAoJCQkgICAgaiwKCQkJICAgIG0sCgkJCSAgICBxLAoJCQkgICAgaywKCQkJICAgIHQsCgkJCSAgICBjdXJyZW50VmFsdWUsCgkJCSAgICBvdXRwdXQgPSBbXSwKCQkJICAgIC8qKiBgaW5wdXRMZW5ndGhgIHdpbGwgaG9sZCB0aGUgbnVtYmVyIG9mIGNvZGUgcG9pbnRzIGluIGBpbnB1dGAuICovCgkJCSAgICBpbnB1dExlbmd0aCwKCQkJICAgIC8qKiBDYWNoZWQgY2FsY3VsYXRpb24gcmVzdWx0cyAqLwoJCQkgICAgaGFuZGxlZENQQ291bnRQbHVzT25lLAoJCQkgICAgYmFzZU1pbnVzVCwKCQkJICAgIHFNaW51c1Q7CgoJCQkvLyBDb252ZXJ0IHRoZSBpbnB1dCBpbiBVQ1MtMiB0byBVbmljb2RlCgkJCWlucHV0ID0gdWNzMmRlY29kZShpbnB1dCk7CgoJCQkvLyBDYWNoZSB0aGUgbGVuZ3RoCgkJCWlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoOwoKCQkJLy8gSW5pdGlhbGl6ZSB0aGUgc3RhdGUKCQkJbiA9IGluaXRpYWxOOwoJCQlkZWx0YSA9IDA7CgkJCWJpYXMgPSBpbml0aWFsQmlhczsKCgkJCS8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHMKCQkJZm9yIChqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHsKCQkJCWN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdOwoJCQkJaWYgKGN1cnJlbnRWYWx1ZSA8IDB4ODApIHsKCQkJCQlvdXRwdXQucHVzaChzdHJpbmdGcm9tQ2hhckNvZGUoY3VycmVudFZhbHVlKSk7CgkJCQl9CgkJCX0KCgkJCWhhbmRsZWRDUENvdW50ID0gYmFzaWNMZW5ndGggPSBvdXRwdXQubGVuZ3RoOwoKCQkJLy8gYGhhbmRsZWRDUENvdW50YCBpcyB0aGUgbnVtYmVyIG9mIGNvZGUgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIGhhbmRsZWQ7CgkJCS8vIGBiYXNpY0xlbmd0aGAgaXMgdGhlIG51bWJlciBvZiBiYXNpYyBjb2RlIHBvaW50cy4KCgkJCS8vIEZpbmlzaCB0aGUgYmFzaWMgc3RyaW5nIC0gaWYgaXQgaXMgbm90IGVtcHR5IC0gd2l0aCBhIGRlbGltaXRlcgoJCQlpZiAoYmFzaWNMZW5ndGgpIHsKCQkJCW91dHB1dC5wdXNoKGRlbGltaXRlcik7CgkJCX0KCgkJCS8vIE1haW4gZW5jb2RpbmcgbG9vcDoKCQkJd2hpbGUgKGhhbmRsZWRDUENvdW50IDwgaW5wdXRMZW5ndGgpIHsKCgkJCQkvLyBBbGwgbm9uLWJhc2ljIGNvZGUgcG9pbnRzIDwgbiBoYXZlIGJlZW4gaGFuZGxlZCBhbHJlYWR5LiBGaW5kIHRoZSBuZXh0CgkJCQkvLyBsYXJnZXIgb25lOgoJCQkJZm9yIChtID0gbWF4SW50LCBqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHsKCQkJCQljdXJyZW50VmFsdWUgPSBpbnB1dFtqXTsKCQkJCQlpZiAoY3VycmVudFZhbHVlID49IG4gJiYgY3VycmVudFZhbHVlIDwgbSkgewoJCQkJCQltID0gY3VycmVudFZhbHVlOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBJbmNyZWFzZSBgZGVsdGFgIGVub3VnaCB0byBhZHZhbmNlIHRoZSBkZWNvZGVyJ3MgPG4saT4gc3RhdGUgdG8gPG0sMD4sCgkJCQkvLyBidXQgZ3VhcmQgYWdhaW5zdCBvdmVyZmxvdwoJCQkJaGFuZGxlZENQQ291bnRQbHVzT25lID0gaGFuZGxlZENQQ291bnQgKyAxOwoJCQkJaWYgKG0gLSBuID4gZmxvb3IoKG1heEludCAtIGRlbHRhKSAvIGhhbmRsZWRDUENvdW50UGx1c09uZSkpIHsKCQkJCQllcnJvcignb3ZlcmZsb3cnKTsKCQkJCX0KCgkJCQlkZWx0YSArPSAobSAtIG4pICogaGFuZGxlZENQQ291bnRQbHVzT25lOwoJCQkJbiA9IG07CgoJCQkJZm9yIChqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHsKCQkJCQljdXJyZW50VmFsdWUgPSBpbnB1dFtqXTsKCgkJCQkJaWYgKGN1cnJlbnRWYWx1ZSA8IG4gJiYgKytkZWx0YSA+IG1heEludCkgewoJCQkJCQllcnJvcignb3ZlcmZsb3cnKTsKCQkJCQl9CgoJCQkJCWlmIChjdXJyZW50VmFsdWUgPT0gbikgewoJCQkJCQkvLyBSZXByZXNlbnQgZGVsdGEgYXMgYSBnZW5lcmFsaXplZCB2YXJpYWJsZS1sZW5ndGggaW50ZWdlcgoJCQkJCQlmb3IgKHEgPSBkZWx0YSwgayA9IGJhc2U7IC8qIG5vIGNvbmRpdGlvbiAqLzsgayArPSBiYXNlKSB7CgkJCQkJCQl0ID0gayA8PSBiaWFzID8gdE1pbiA6IChrID49IGJpYXMgKyB0TWF4ID8gdE1heCA6IGsgLSBiaWFzKTsKCQkJCQkJCWlmIChxIDwgdCkgewoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJfQoJCQkJCQkJcU1pbnVzVCA9IHEgLSB0OwoJCQkJCQkJYmFzZU1pbnVzVCA9IGJhc2UgLSB0OwoJCQkJCQkJb3V0cHV0LnB1c2goCgkJCQkJCQkJc3RyaW5nRnJvbUNoYXJDb2RlKGRpZ2l0VG9CYXNpYyh0ICsgcU1pbnVzVCAlIGJhc2VNaW51c1QsIDApKQoJCQkJCQkJKTsKCQkJCQkJCXEgPSBmbG9vcihxTWludXNUIC8gYmFzZU1pbnVzVCk7CgkJCQkJCX0KCgkJCQkJCW91dHB1dC5wdXNoKHN0cmluZ0Zyb21DaGFyQ29kZShkaWdpdFRvQmFzaWMocSwgMCkpKTsKCQkJCQkJYmlhcyA9IGFkYXB0KGRlbHRhLCBoYW5kbGVkQ1BDb3VudFBsdXNPbmUsIGhhbmRsZWRDUENvdW50ID09IGJhc2ljTGVuZ3RoKTsKCQkJCQkJZGVsdGEgPSAwOwoJCQkJCQkrK2hhbmRsZWRDUENvdW50OwoJCQkJCX0KCQkJCX0KCgkJCQkrK2RlbHRhOwoJCQkJKytuOwoKCQkJfQoJCQlyZXR1cm4gb3V0cHV0LmpvaW4oJycpOwoJCX0KCgkJLyoqCgkJICogQ29udmVydHMgYSBQdW55Y29kZSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgZG9tYWluIG5hbWUgb3IgYW4gZW1haWwgYWRkcmVzcwoJCSAqIHRvIFVuaWNvZGUuIE9ubHkgdGhlIFB1bnljb2RlZCBwYXJ0cyBvZiB0aGUgaW5wdXQgd2lsbCBiZSBjb252ZXJ0ZWQsIGkuZS4KCQkgKiBpdCBkb2Vzbid0IG1hdHRlciBpZiB5b3UgY2FsbCBpdCBvbiBhIHN0cmluZyB0aGF0IGhhcyBhbHJlYWR5IGJlZW4KCQkgKiBjb252ZXJ0ZWQgdG8gVW5pY29kZS4KCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUKCQkgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIFB1bnljb2RlZCBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzIHRvCgkJICogY29udmVydCB0byBVbmljb2RlLgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBVbmljb2RlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBQdW55Y29kZQoJCSAqIHN0cmluZy4KCQkgKi8KCQlmdW5jdGlvbiB0b1VuaWNvZGUoaW5wdXQpIHsKCQkJcmV0dXJuIG1hcERvbWFpbihpbnB1dCwgZnVuY3Rpb24oc3RyaW5nKSB7CgkJCQlyZXR1cm4gcmVnZXhQdW55Y29kZS50ZXN0KHN0cmluZykKCQkJCQk/IGRlY29kZShzdHJpbmcuc2xpY2UoNCkudG9Mb3dlckNhc2UoKSkKCQkJCQk6IHN0cmluZzsKCQkJfSk7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIFVuaWNvZGUgc3RyaW5nIHJlcHJlc2VudGluZyBhIGRvbWFpbiBuYW1lIG9yIGFuIGVtYWlsIGFkZHJlc3MgdG8KCQkgKiBQdW55Y29kZS4gT25seSB0aGUgbm9uLUFTQ0lJIHBhcnRzIG9mIHRoZSBkb21haW4gbmFtZSB3aWxsIGJlIGNvbnZlcnRlZCwKCQkgKiBpLmUuIGl0IGRvZXNuJ3QgbWF0dGVyIGlmIHlvdSBjYWxsIGl0IHdpdGggYSBkb21haW4gdGhhdCdzIGFscmVhZHkgaW4KCQkgKiBBU0NJSS4KCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUKCQkgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIGRvbWFpbiBuYW1lIG9yIGVtYWlsIGFkZHJlc3MgdG8gY29udmVydCwgYXMgYQoJCSAqIFVuaWNvZGUgc3RyaW5nLgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBQdW55Y29kZSByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gZG9tYWluIG5hbWUgb3IKCQkgKiBlbWFpbCBhZGRyZXNzLgoJCSAqLwoJCWZ1bmN0aW9uIHRvQVNDSUkoaW5wdXQpIHsKCQkJcmV0dXJuIG1hcERvbWFpbihpbnB1dCwgZnVuY3Rpb24oc3RyaW5nKSB7CgkJCQlyZXR1cm4gcmVnZXhOb25BU0NJSS50ZXN0KHN0cmluZykKCQkJCQk/ICd4bi0tJyArIGVuY29kZShzdHJpbmcpCgkJCQkJOiBzdHJpbmc7CgkJCX0pOwoJCX0KCgkJLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgoJCS8qKiBEZWZpbmUgdGhlIHB1YmxpYyBBUEkgKi8KCQlwdW55Y29kZSA9IHsKCQkJLyoqCgkJCSAqIEEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBQdW55Y29kZS5qcyB2ZXJzaW9uIG51bWJlci4KCQkJICogQG1lbWJlck9mIHB1bnljb2RlCgkJCSAqIEB0eXBlIFN0cmluZwoJCQkgKi8KCQkJJ3ZlcnNpb24nOiAnMS4zLjInLAoJCQkvKioKCQkJICogQW4gb2JqZWN0IG9mIG1ldGhvZHMgdG8gY29udmVydCBmcm9tIEphdmFTY3JpcHQncyBpbnRlcm5hbCBjaGFyYWN0ZXIKCQkJICogcmVwcmVzZW50YXRpb24gKFVDUy0yKSB0byBVbmljb2RlIGNvZGUgcG9pbnRzLCBhbmQgYmFjay4KCQkJICogQHNlZSA8aHR0cHM6Ly9tYXRoaWFzYnluZW5zLmJlL25vdGVzL2phdmFzY3JpcHQtZW5jb2Rpbmc+CgkJCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJCQkgKiBAdHlwZSBPYmplY3QKCQkJICovCgkJCSd1Y3MyJzogewoJCQkJJ2RlY29kZSc6IHVjczJkZWNvZGUsCgkJCQknZW5jb2RlJzogdWNzMmVuY29kZQoJCQl9LAoJCQknZGVjb2RlJzogZGVjb2RlLAoJCQknZW5jb2RlJzogZW5jb2RlLAoJCQkndG9BU0NJSSc6IHRvQVNDSUksCgkJCSd0b1VuaWNvZGUnOiB0b1VuaWNvZGUKCQl9OwoKCQkvKiogRXhwb3NlIGBwdW55Y29kZWAgKi8KCQkvLyBTb21lIEFNRCBidWlsZCBvcHRpbWl6ZXJzLCBsaWtlIHIuanMsIGNoZWNrIGZvciBzcGVjaWZpYyBjb25kaXRpb24gcGF0dGVybnMKCQkvLyBsaWtlIHRoZSBmb2xsb3dpbmc6CgkJaWYgKAoJCQl0cnVlCgkJKSB7CgkJCSEoX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSBmdW5jdGlvbigpIHsKCQkJCXJldHVybiBwdW55Y29kZTsKCQkJfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18sIGV4cG9ydHMsIG1vZHVsZSksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTsKCQl9IGVsc2UgaWYgKGZyZWVFeHBvcnRzICYmIGZyZWVNb2R1bGUpIHsKCQkJaWYgKG1vZHVsZS5leHBvcnRzID09IGZyZWVFeHBvcnRzKSB7IC8vIGluIE5vZGUuanMgb3IgUmluZ29KUyB2MC44LjArCgkJCQlmcmVlTW9kdWxlLmV4cG9ydHMgPSBwdW55Y29kZTsKCQkJfSBlbHNlIHsgLy8gaW4gTmFyd2hhbCBvciBSaW5nb0pTIHYwLjcuMC0KCQkJCWZvciAoa2V5IGluIHB1bnljb2RlKSB7CgkJCQkJcHVueWNvZGUuaGFzT3duUHJvcGVydHkoa2V5KSAmJiAoZnJlZUV4cG9ydHNba2V5XSA9IHB1bnljb2RlW2tleV0pOwoJCQkJfQoJCQl9CgkJfSBlbHNlIHsgLy8gaW4gUmhpbm8gb3IgYSB3ZWIgYnJvd3NlcgoJCQlyb290LnB1bnljb2RlID0gcHVueWNvZGU7CgkJfQoKCX0odGhpcykpOwoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDQzKShtb2R1bGUpLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSkKCi8qKiovIH0sCi8qIDQzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlKSB7DQoJCWlmKCFtb2R1bGUud2VicGFja1BvbHlmaWxsKSB7DQoJCQltb2R1bGUuZGVwcmVjYXRlID0gZnVuY3Rpb24oKSB7fTsNCgkJCW1vZHVsZS5wYXRocyA9IFtdOw0KCQkJLy8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0DQoJCQltb2R1bGUuY2hpbGRyZW4gPSBbXTsNCgkJCW1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxOw0KCQl9DQoJCXJldHVybiBtb2R1bGU7DQoJfQ0KCgovKioqLyB9LAovKiA0NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkndXNlIHN0cmljdCc7CgoJbW9kdWxlLmV4cG9ydHMgPSB7CgkgIGlzU3RyaW5nOiBmdW5jdGlvbihhcmcpIHsKCSAgICByZXR1cm4gdHlwZW9mKGFyZykgPT09ICdzdHJpbmcnOwoJICB9LAoJICBpc09iamVjdDogZnVuY3Rpb24oYXJnKSB7CgkgICAgcmV0dXJuIHR5cGVvZihhcmcpID09PSAnb2JqZWN0JyAmJiBhcmcgIT09IG51bGw7CgkgIH0sCgkgIGlzTnVsbDogZnVuY3Rpb24oYXJnKSB7CgkgICAgcmV0dXJuIGFyZyA9PT0gbnVsbDsKCSAgfSwKCSAgaXNOdWxsT3JVbmRlZmluZWQ6IGZ1bmN0aW9uKGFyZykgewoJICAgIHJldHVybiBhcmcgPT0gbnVsbDsKCSAgfQoJfTsKCgovKioqLyB9LAovKiA0NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJZXhwb3J0cy5kZWNvZGUgPSBleHBvcnRzLnBhcnNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nik7CglleHBvcnRzLmVuY29kZSA9IGV4cG9ydHMuc3RyaW5naWZ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoKLyoqKi8gfSwKLyogNDYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuCgkvLwoJLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKCS8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKCS8vICJTb2Z0d2FyZSIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcKCS8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwKCS8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQKCS8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZQoJLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6CgkvLwoJLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQKCS8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgoJLy8KCS8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTCgkvLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GCgkvLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOCgkvLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwKCS8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUgoJLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRQoJLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KCgkndXNlIHN0cmljdCc7CgoJLy8gSWYgb2JqLmhhc093blByb3BlcnR5IGhhcyBiZWVuIG92ZXJyaWRkZW4sIHRoZW4gY2FsbGluZwoJLy8gb2JqLmhhc093blByb3BlcnR5KHByb3ApIHdpbGwgYnJlYWsuCgkvLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9qb3llbnQvbm9kZS9pc3N1ZXMvMTcwNwoJZnVuY3Rpb24gaGFzT3duUHJvcGVydHkob2JqLCBwcm9wKSB7CgkgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsKCX0KCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHFzLCBzZXAsIGVxLCBvcHRpb25zKSB7CgkgIHNlcCA9IHNlcCB8fCAnJic7CgkgIGVxID0gZXEgfHwgJz0nOwoJICB2YXIgb2JqID0ge307CgoJICBpZiAodHlwZW9mIHFzICE9PSAnc3RyaW5nJyB8fCBxcy5sZW5ndGggPT09IDApIHsKCSAgICByZXR1cm4gb2JqOwoJICB9CgoJICB2YXIgcmVnZXhwID0gL1wrL2c7CgkgIHFzID0gcXMuc3BsaXQoc2VwKTsKCgkgIHZhciBtYXhLZXlzID0gMTAwMDsKCSAgaWYgKG9wdGlvbnMgJiYgdHlwZW9mIG9wdGlvbnMubWF4S2V5cyA9PT0gJ251bWJlcicpIHsKCSAgICBtYXhLZXlzID0gb3B0aW9ucy5tYXhLZXlzOwoJICB9CgoJICB2YXIgbGVuID0gcXMubGVuZ3RoOwoJICAvLyBtYXhLZXlzIDw9IDAgbWVhbnMgdGhhdCB3ZSBzaG91bGQgbm90IGxpbWl0IGtleXMgY291bnQKCSAgaWYgKG1heEtleXMgPiAwICYmIGxlbiA+IG1heEtleXMpIHsKCSAgICBsZW4gPSBtYXhLZXlzOwoJICB9CgoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7CgkgICAgdmFyIHggPSBxc1tpXS5yZXBsYWNlKHJlZ2V4cCwgJyUyMCcpLAoJICAgICAgICBpZHggPSB4LmluZGV4T2YoZXEpLAoJICAgICAgICBrc3RyLCB2c3RyLCBrLCB2OwoKCSAgICBpZiAoaWR4ID49IDApIHsKCSAgICAgIGtzdHIgPSB4LnN1YnN0cigwLCBpZHgpOwoJICAgICAgdnN0ciA9IHguc3Vic3RyKGlkeCArIDEpOwoJICAgIH0gZWxzZSB7CgkgICAgICBrc3RyID0geDsKCSAgICAgIHZzdHIgPSAnJzsKCSAgICB9CgoJICAgIGsgPSBkZWNvZGVVUklDb21wb25lbnQoa3N0cik7CgkgICAgdiA9IGRlY29kZVVSSUNvbXBvbmVudCh2c3RyKTsKCgkgICAgaWYgKCFoYXNPd25Qcm9wZXJ0eShvYmosIGspKSB7CgkgICAgICBvYmpba10gPSB2OwoJICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShvYmpba10pKSB7CgkgICAgICBvYmpba10ucHVzaCh2KTsKCSAgICB9IGVsc2UgewoJICAgICAgb2JqW2tdID0gW29ialtrXSwgdl07CgkgICAgfQoJICB9CgoJICByZXR1cm4gb2JqOwoJfTsKCgovKioqLyB9LAovKiA0NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCSd1c2Ugc3RyaWN0JzsKCgl2YXIgc3RyaW5naWZ5UHJpbWl0aXZlID0gZnVuY3Rpb24odikgewoJICBzd2l0Y2ggKHR5cGVvZiB2KSB7CgkgICAgY2FzZSAnc3RyaW5nJzoKCSAgICAgIHJldHVybiB2OwoKCSAgICBjYXNlICdib29sZWFuJzoKCSAgICAgIHJldHVybiB2ID8gJ3RydWUnIDogJ2ZhbHNlJzsKCgkgICAgY2FzZSAnbnVtYmVyJzoKCSAgICAgIHJldHVybiBpc0Zpbml0ZSh2KSA/IHYgOiAnJzsKCgkgICAgZGVmYXVsdDoKCSAgICAgIHJldHVybiAnJzsKCSAgfQoJfTsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaiwgc2VwLCBlcSwgbmFtZSkgewoJICBzZXAgPSBzZXAgfHwgJyYnOwoJICBlcSA9IGVxIHx8ICc9JzsKCSAgaWYgKG9iaiA9PT0gbnVsbCkgewoJICAgIG9iaiA9IHVuZGVmaW5lZDsKCSAgfQoKCSAgaWYgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnKSB7CgkgICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubWFwKGZ1bmN0aW9uKGspIHsKCSAgICAgIHZhciBrcyA9IGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUoaykpICsgZXE7CgkgICAgICBpZiAoQXJyYXkuaXNBcnJheShvYmpba10pKSB7CgkgICAgICAgIHJldHVybiBvYmpba10ubWFwKGZ1bmN0aW9uKHYpIHsKCSAgICAgICAgICByZXR1cm4ga3MgKyBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKHYpKTsKCSAgICAgICAgfSkuam9pbihzZXApOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgcmV0dXJuIGtzICsgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShvYmpba10pKTsKCSAgICAgIH0KCSAgICB9KS5qb2luKHNlcCk7CgoJICB9CgoJICBpZiAoIW5hbWUpIHJldHVybiAnJzsKCSAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUobmFtZSkpICsgZXEgKwoJICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShvYmopKTsKCX07CgoKLyoqKi8gfSwKLyogNDggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGh0dHAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwoKCXZhciBodHRwcyA9IG1vZHVsZS5leHBvcnRzOwoKCWZvciAodmFyIGtleSBpbiBodHRwKSB7CgkgICAgaWYgKGh0dHAuaGFzT3duUHJvcGVydHkoa2V5KSkgaHR0cHNba2V5XSA9IGh0dHBba2V5XTsKCX07CgoJaHR0cHMucmVxdWVzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNiKSB7CgkgICAgaWYgKCFwYXJhbXMpIHBhcmFtcyA9IHt9OwoJICAgIHBhcmFtcy5zY2hlbWUgPSAnaHR0cHMnOwoJICAgIHBhcmFtcy5wcm90b2NvbCA9ICdodHRwczonOwoJICAgIHJldHVybiBodHRwLnJlcXVlc3QuY2FsbCh0aGlzLCBwYXJhbXMsIGNiKTsKCX0KCgovKioqLyB9LAovKiA0OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgcXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KQoJdmFyIGh0dHAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCgl2YXIgaHR0cHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ4KQoJdmFyIHVybCA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBQT1NUKG9wdGlvbnMsIGNhbGxiYWNrKSB7CgoJICAvLyByZXF1aXJlIG9wdGlvbnMudXJsIG9yIGZhaWwgbm9pc2lseSAKCSAgaWYgKCFvcHRpb25zLnVybCkgewoJICAgIHRocm93IEVycm9yKCdvcHRpb25zLnVybCByZXF1aXJlZCcpCgkgIH0KCgkgIC8vIHBhcnNlIG91dCB0aGUgb3B0aW9ucyBmcm9tIG9wdGlvbnMudXJsCgkgIHZhciBvcHRzID0gdXJsLnBhcnNlKG9wdGlvbnMudXJsKQoJICB2YXIgbWV0aG9kID0gb3B0cy5wcm90b2NvbCA9PT0gJ2h0dHBzOic/IGh0dHBzLnJlcXVlc3QgOiBodHRwLnJlcXVlc3QKCSAgdmFyIGRlZmF1bHRDb250ZW50VHlwZSA9ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JwoKCSAgb3B0cy5tZXRob2QgPSAnUE9TVCcKCSAgb3B0cy5yZWplY3RVbmF1dGhvcml6ZWQgPSBmYWxzZQoJICBvcHRzLmFnZW50ID0gZmFsc2UKCSAgb3B0cy5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzIHx8IHt9CgkgIG9wdHMuaGVhZGVyc1snVXNlci1BZ2VudCddID0gb3B0cy5oZWFkZXJzWydVc2VyLUFnZW50J10gfHwgJ3RpbnktaHR0cCcKCSAgb3B0cy5oZWFkZXJzWydDb250ZW50LVR5cGUnXSA9IG9wdHMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gfHwgZGVmYXVsdENvbnRlbnRUeXBlCgkgIC8vIG9wdHMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJwoJICB2YXIgcmVxSlNPTiA9IG9wdHMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10uc3RhcnRzV2l0aCgnYXBwbGljYXRpb24vanNvbicpCgkgIHZhciBwb3N0RGF0YSA9IHJlcUpTT04/IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMuZGF0YSB8fCB7fSkgOiBxcy5zdHJpbmdpZnkob3B0aW9ucy5kYXRhIHx8IHt9KQoKCSAgLy8gbWFrZSBhIFBPU1QgcmVxdWVzdAoJICB2YXIgcmVxID0gbWV0aG9kKG9wdHMsIGZ1bmN0aW9uKHJlcykgewoJICAgCgkgICAgdmFyIHJhd0RhdGEgPSAnJwoJICAgIHZhciBzdGF0dXNDb2RlID0gcmVzLnN0YXR1c0NvZGUKCSAgICB2YXIgY29udGVudFR5cGUgPSByZXMuaGVhZGVyc1snY29udGVudC10eXBlJ10KCSAgICB2YXIgaXNKU09OID0gY29udGVudFR5cGUgPT09ICdhcHBsaWNhdGlvbi9qc29uJwoKCSAgICBpZiAoc3RhdHVzQ29kZSAhPT0gMjAwKSB7CgkgICAgICBjYWxsYmFjayhFcnJvcignR0VUIGZhaWxlZCB3aXRoOiAnICsgc3RhdHVzQ29kZSkpCgkgICAgICByZXMucmVzdW1lKCkKCSAgICAgIHJldHVybgoJICAgIH0KCSAKCSAgICByZXMuc2V0RW5jb2RpbmcoJ3V0ZjgnKQoJICAgIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uKGNodW5rKSB7IHJhd0RhdGEgKz0gY2h1bmsgfSkKCSAgICByZXMub24oJ2VuZCcsIGZ1bmN0aW9uKHgpIHsKCSAgICAgIHRyeSB7CgkgICAgICAgIHZhciBwYXJzZWREYXRhID0gaXNKU09OPyBKU09OLnBhcnNlKHJhd0RhdGEpIDogcmF3RGF0YQoJICAgICAgICBjYWxsYmFjayhudWxsLCBwYXJzZWREYXRhKQoJICAgICAgfSAKCSAgICAgIGNhdGNoIChlKSB7CgkgICAgICAgIGNhbGxiYWNrKGUubWVzc2FnZSkKCSAgICAgIH0KCSAgICB9KQoJICB9KQoKCSAgcmVxLm9uKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHsgY2FsbGJhY2soRXJyb3IoZS5tZXNzYWdlKSkgfSkKCgkgIHJlcS53cml0ZShwb3N0RGF0YSkKCSAKCSAgcmVxLmVuZCgpCgl9CgoKLyoqKi8gfSwKLyogNTAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdmFsaWRhdGU7CgoJdmFyIF9hcGkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKCgl2YXIgX2FwaTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hcGkpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZnVuY3Rpb24gdmFsaWRhdGUobWV0aG9kLCBwYXJhbXMpIHsKCSAgLy8gZ2V0IGFsbCB0aGUgcmVxdXJpZWQgcGFyYW1zIGZvciB0aGlzIG1ldGhvZAoJICB2YXIgcmVxdWlyZWQgPSBfYXBpMi5kZWZhdWx0W21ldGhvZF0uZmlsdGVyKGZ1bmN0aW9uIChwYXJhbSkgewoJICAgIHJldHVybiBwYXJhbS5yZXF1aXJlZCA9PT0gJ1JlcXVpcmVkJzsKCSAgfSk7CgkgIC8vIGNvbGxlY3QgYW55IG1pc3NpbmcgcGFyYW1zCgkgIHZhciBtaXNzaW5nID0gcmVxdWlyZWQuZmlsdGVyKGZ1bmN0aW9uIChwYXJhbSkgewoJICAgIHJldHVybiB0eXBlb2YgcGFyYW1zW3BhcmFtLm5hbWVdID09PSAndW5kZWZpbmVkJzsKCSAgfSk7CgkgIC8vIG9wdGltaXNpdGNhbGx5IGFzc3VtZSB0aGUgYmVzdAoJICB2YXIgZXJyID0gZmFsc2U7CgkgIC8vIGJ1dCBoYXZlIGEgcGxhbiBmb3IgdGhlIHdvcnN0CgkgIGlmIChtaXNzaW5nLmxlbmd0aCkgewoJICAgIHZhciBidWxsZXRzID0gbWlzc2luZy5tYXAoZnVuY3Rpb24gKHBhcmFtKSB7CgkgICAgICByZXR1cm4gJy0gJyArIHBhcmFtLm5hbWUgKyAnIC4uLiAnICsgcGFyYW0uZGVzY3JpcHRpb247CgkgICAgfSk7CgkgICAgdmFyIG1zZyA9IG1ldGhvZCArICcgbWlzc2luZyBwYXJhbXM6XG4nICsgYnVsbGV0cy5qb2luKCdcbicpOwoJICAgIGVyciA9IEVycm9yKG1zZyk7CgkgIH0KCSAgcmV0dXJuIGVycjsKCX0gLy8KCS8vIHZhbGlkYXRlIHJldHVybnMgYW4gZXJyb3Igb2JqZWN0IGlmIGFueSByZXF1aXJlZCBwYXJhbXMgYXJlIG1pc3NpbmcKCS8vCgkvLyBleGFtcGxlIHVzYWdlOgoJLy8gCgkvLyAgIC8vIHRva2VuIGFuZCBpZCBhcmUgcmVxdWlyZWQgcGFyYW1zCgkvLyAgIGZ1bmN0aW9uIGFwaUNhbGwocGFyYW1zLCBjYWxsYmFjaykgeyAKCS8vICAgICBsZXQgZXJyID0gdmFsaWRhdGUoJ2FwaS5zaWduYXR1cmUnLCBwYXJhbXMpCgkvLyAgICAgaWYgKGVycikgewoJLy8gICAgICAgY2FsbGJhY2soZXJyKQoJLy8gICAgIH0KCS8vICAgICBlbHNlIHsKCS8vICAgICAgIC8vIGRvIGFwaSBjYWxsCgkvLyAgICAgfQoJLy8gICB9CgkvLwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsKCQkiYXBpLnRlc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogImVycm9yIiwKCQkJCSJleGFtcGxlIjogIm15X2Vycm9yIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRXJyb3IgcmVzcG9uc2UgdG8gcmV0dXJuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZvbyIsCgkJCQkiZXhhbXBsZSI6ICJiYXIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJleGFtcGxlIHByb3BlcnR5IHRvIHJldHVyblxuIgoJCQl9CgkJXSwKCQkiYXV0aC5yZXZva2UiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGVzdCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU2V0dGluZyB0aGlzIHBhcmFtZXRlciB0byAxIHRyaWdnZXJzIGEgdGVzdGluZyBtb2RlIHdoZXJlIHRoZSBzcGVjaWZpZWQgdG9rZW4gd2lsbCBub3QgYWN0dWFsbHkgYmUgcmV2b2tlZC5cbiIKCQkJfQoJCV0sCgkJImF1dGgudGVzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGlkZW50aWZ5XG4iCgkJCX0KCQldLAoJCSJib3RzLmluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2VyczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImJvdCIsCgkJCQkiZXhhbXBsZSI6ICJCMTIzNDU2NzgiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJCb3QgdXNlciB0byBnZXQgaW5mbyBvblxuIgoJCQl9CgkJXSwKCQkiY2hhbm5lbHMuYXJjaGl2ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIGFyY2hpdmVcbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLmNyZWF0ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm5hbWUiLAoJCQkJImV4YW1wbGUiOiAibXljaGFubmVsIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTmFtZSBvZiBjaGFubmVsIHRvIGNyZWF0ZVxuIgoJCQl9CgkJXSwKCQkiY2hhbm5lbHMuaGlzdG9yeSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOmhpc3RvcnlcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gZmV0Y2ggaGlzdG9yeSBmb3IuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImxhdGVzdCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9bm93IiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJFbmQgb2YgdGltZSByYW5nZSBvZiBtZXNzYWdlcyB0byBpbmNsdWRlIGluIHJlc3VsdHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm9sZGVzdCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU3RhcnQgb2YgdGltZSByYW5nZSBvZiBtZXNzYWdlcyB0byBpbmNsdWRlIGluIHJlc3VsdHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImluY2x1c2l2ZSIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIG1lc3NhZ2VzIHdpdGggbGF0ZXN0IG9yIG9sZGVzdCB0aW1lc3RhbXAgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMTAwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xMDAiLAoJCQkJImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBtZXNzYWdlcyB0byByZXR1cm4sIGJldHdlZW4gMSBhbmQgMTAwMC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidW5yZWFkcyIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHVucmVhZF9jb3VudF9kaXNwbGF5IGluIHRoZSBvdXRwdXQ/XG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5pbmZvIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byBnZXQgaW5mbyBvblxuIgoJCQl9CgkJXSwKCQkiY2hhbm5lbHMuaW52aXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gaW52aXRlIHVzZXIgdG8uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIGludml0ZSB0byBjaGFubmVsLlxuIgoJCQl9CgkJXSwKCQkiY2hhbm5lbHMuam9pbiI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm5hbWUiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOYW1lIG9mIGNoYW5uZWwgdG8gam9pblxuIgoJCQl9CgkJXSwKCQkiY2hhbm5lbHMua2ljayI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIHJlbW92ZSB1c2VyIGZyb20uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIHJlbW92ZSBmcm9tIGNoYW5uZWwuXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5sZWF2ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIGxlYXZlXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJleGNsdWRlX2FyY2hpdmVkIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PWZhbHNlIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJEb24ndCByZXR1cm4gYXJjaGl2ZWQgY2hhbm5lbHMuXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5tYXJrIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gc2V0IHJlYWRpbmcgY3Vyc29yIGluLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0cyIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbW9zdCByZWNlbnRseSBzZWVuIG1lc3NhZ2UuXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5yZW5hbWUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byByZW5hbWVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIk5ldyBuYW1lIGZvciBjaGFubmVsLlxuIgoJCQl9CgkJXSwKCQkiY2hhbm5lbHMucmVwbGllcyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOmhpc3RvcnlcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gZmV0Y2ggdGhyZWFkIGZyb21cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGhyZWFkX3RzIiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVW5pcXVlIGlkZW50aWZpZXIgb2YgYSB0aHJlYWQncyBwYXJlbnQgbWVzc2FnZVxuIgoJCQl9CgkJXSwKCQkiY2hhbm5lbHMuc2V0UHVycG9zZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIHNldCB0aGUgcHVycG9zZSBvZlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwdXJwb3NlIiwKCQkJCSJleGFtcGxlIjogIk15IFB1cnBvc2UiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgbmV3IHB1cnBvc2VcbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLnNldFRvcGljIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gc2V0IHRoZSB0b3BpYyBvZlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0b3BpYyIsCgkJCQkiZXhhbXBsZSI6ICJNeSBUb3BpYyIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRoZSBuZXcgdG9waWNcbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLnVuYXJjaGl2ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIHVuYXJjaGl2ZVxuIgoJCQl9CgkJXSwKCQkiY2hhdC5kZWxldGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGF0OndyaXRlOmJvdCBvciBjaGF0OndyaXRlOnVzZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHMiLAoJCQkJImV4YW1wbGUiOiAiMTQwNTg5NDMyMi4wMDI3NjgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1lc3NhZ2UgdG8gYmUgZGVsZXRlZC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgY29udGFpbmluZyB0aGUgbWVzc2FnZSB0byBiZSBkZWxldGVkLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJhc191c2VyIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYXNzIHRydWUgdG8gZGVsZXRlIHRoZSBtZXNzYWdlIGFzIHRoZSBhdXRoZWQgdXNlci4gQm90IHVzZXJzIGluIHRoaXMgY29udGV4dCBhcmUgY29uc2lkZXJlZCBhdXRoZWQgdXNlcnMuXG4iCgkJCX0KCQldLAoJCSJjaGF0Lm1lTWVzc2FnZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYXQ6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byBzZW5kIG1lc3NhZ2UgdG8uIENhbiBiZSBhIHB1YmxpYyBjaGFubmVsLCBwcml2YXRlIGdyb3VwIG9yIElNIGNoYW5uZWwuIENhbiBiZSBhbiBlbmNvZGVkIElELCBvciBhIG5hbWUuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRleHQiLAoJCQkJImV4YW1wbGUiOiAiSGVsbG8gd29ybGQiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUZXh0IG9mIHRoZSBtZXNzYWdlIHRvIHNlbmQuXG4iCgkJCX0KCQldLAoJCSJjaGF0LnBvc3RNZXNzYWdlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhdDp3cml0ZTpib3Qgb3IgY2hhdDp3cml0ZTp1c2VyXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsLCBwcml2YXRlIGdyb3VwLCBvciBJTSBjaGFubmVsIHRvIHNlbmQgbWVzc2FnZSB0by4gQ2FuIGJlIGFuIGVuY29kZWQgSUQsIG9yIGEgbmFtZS4gU2VlIGJlbG93IGZvciBtb3JlIGRldGFpbHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRleHQiLAoJCQkJImV4YW1wbGUiOiAiSGVsbG8gd29ybGQiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUZXh0IG9mIHRoZSBtZXNzYWdlIHRvIHNlbmQuIFNlZSBiZWxvdyBmb3IgYW4gZXhwbGFuYXRpb24gb2YgZm9ybWF0dGluZy4gVGhpcyBmaWVsZCBpcyB1c3VhbGx5IHJlcXVpcmVkLCB1bmxlc3MgeW91J3JlIHByb3ZpZGluZyBvbmx5IGF0dGFjaG1lbnRzIGluc3RlYWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInBhcnNlIiwKCQkJCSJleGFtcGxlIjogImZ1bGwiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFuZ2UgaG93IG1lc3NhZ2VzIGFyZSB0cmVhdGVkLiBEZWZhdWx0cyB0byBub25lLiBTZWUgYmVsb3cuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImxpbmtfbmFtZXMiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbmQgYW5kIGxpbmsgY2hhbm5lbCBuYW1lcyBhbmQgdXNlcm5hbWVzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJhdHRhY2htZW50cyIsCgkJCQkiZXhhbXBsZSI6ICJbe1wicHJldGV4dFwiOiBcInByZS1oZWxsb1wiLCBcInRleHRcIjogXCJ0ZXh0LXdvcmxkXCJ9XSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlN0cnVjdHVyZWQgbWVzc2FnZSBhdHRhY2htZW50cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidW5mdXJsX2xpbmtzIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYXNzIHRydWUgdG8gZW5hYmxlIHVuZnVybGluZyBvZiBwcmltYXJpbHkgdGV4dC1iYXNlZCBjb250ZW50LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1bmZ1cmxfbWVkaWEiLAoJCQkJImV4YW1wbGUiOiAiZmFsc2UiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYXNzIGZhbHNlIHRvIGRpc2FibGUgdW5mdXJsaW5nIG9mIG1lZGlhIGNvbnRlbnQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXJuYW1lIiwKCQkJCSJleGFtcGxlIjogIk15IEJvdCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlNldCB5b3VyIGJvdCdzIHVzZXIgbmFtZS4gTXVzdCBiZSB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggYXNfdXNlciBzZXQgdG8gZmFsc2UsIG90aGVyd2lzZSBpZ25vcmVkLiBTZWUgYXV0aG9yc2hpcCBiZWxvdy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYXNfdXNlciIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyB0cnVlIHRvIHBvc3QgdGhlIG1lc3NhZ2UgYXMgdGhlIGF1dGhlZCB1c2VyLCBpbnN0ZWFkIG9mIGFzIGEgYm90LiBEZWZhdWx0cyB0byBmYWxzZS4gU2VlIGF1dGhvcnNoaXAgYmVsb3cuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImljb25fdXJsIiwKCQkJCSJleGFtcGxlIjogImh0dHA6Ly9sb3JlbXBpeGVsLmNvbS80OC80OCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVSTCB0byBhbiBpbWFnZSB0byB1c2UgYXMgdGhlIGljb24gZm9yIHRoaXMgbWVzc2FnZS4gTXVzdCBiZSB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggYXNfdXNlciBzZXQgdG8gZmFsc2UsIG90aGVyd2lzZSBpZ25vcmVkLiBTZWUgYXV0aG9yc2hpcCBiZWxvdy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaWNvbl9lbW9qaSIsCgkJCQkiZXhhbXBsZSI6ICI6Y2hhcnRfd2l0aF91cHdhcmRzX3RyZW5kOiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkVtb2ppIHRvIHVzZSBhcyB0aGUgaWNvbiBmb3IgdGhpcyBtZXNzYWdlLiBPdmVycmlkZXMgaWNvbl91cmwuIE11c3QgYmUgdXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIGFzX3VzZXIgc2V0IHRvIGZhbHNlLCBvdGhlcndpc2UgaWdub3JlZC4gU2VlIGF1dGhvcnNoaXAgYmVsb3cuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRocmVhZF90cyIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByb3ZpZGUgYW5vdGhlciBtZXNzYWdlJ3MgdHMgdmFsdWUgdG8gbWFrZSB0aGlzIG1lc3NhZ2UgYSByZXBseS4gQXZvaWQgdXNpbmcgYSByZXBseSdzIHRzIHZhbHVlOyB1c2UgaXRzIHBhcmVudCBpbnN0ZWFkLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJyZXBseV9icm9hZGNhc3QiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCB0aHJlYWRfdHMgYW5kIGluZGljYXRlcyB3aGV0aGVyIHJlcGx5IHNob3VsZCBiZSBtYWRlIHZpc2libGUgdG8gZXZlcnlvbmUgaW4gdGhlIGNoYW5uZWwgb3IgY29udmVyc2F0aW9uLiBEZWZhdWx0cyB0byBmYWxzZS5cbiIKCQkJfQoJCV0sCgkJImNoYXQudXBkYXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhdDp3cml0ZTpib3Qgb3IgY2hhdDp3cml0ZTp1c2VyXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRzIiwKCQkJCSJleGFtcGxlIjogIjE0MDU4OTQzMjIuMDAyNzY4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtZXNzYWdlIHRvIGJlIHVwZGF0ZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIGNvbnRhaW5pbmcgdGhlIG1lc3NhZ2UgdG8gYmUgdXBkYXRlZC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGV4dCIsCgkJCQkiZXhhbXBsZSI6ICJIZWxsbyB3b3JsZCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIk5ldyB0ZXh0IGZvciB0aGUgbWVzc2FnZSwgdXNpbmcgdGhlIGRlZmF1bHQgZm9ybWF0dGluZyBydWxlcy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYXR0YWNobWVudHMiLAoJCQkJImV4YW1wbGUiOiAiW3tcInByZXRleHRcIjogXCJwcmUtaGVsbG9cIiwgXCJ0ZXh0XCI6IFwidGV4dC13b3JsZFwifV0iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTdHJ1Y3R1cmVkIG1lc3NhZ2UgYXR0YWNobWVudHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInBhcnNlIiwKCQkJCSJleGFtcGxlIjogIm5vbmUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFuZ2UgaG93IG1lc3NhZ2VzIGFyZSB0cmVhdGVkLiBEZWZhdWx0cyB0byBjbGllbnQsIHVubGlrZSBjaGF0LnBvc3RNZXNzYWdlLiBTZWUgYmVsb3cuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImxpbmtfbmFtZXMiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbmQgYW5kIGxpbmsgY2hhbm5lbCBuYW1lcyBhbmQgdXNlcm5hbWVzLiBEZWZhdWx0cyB0byBub25lLiBUaGlzIHBhcmFtZXRlciBzaG91bGQgYmUgdXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIHBhcnNlLiBUbyBzZXQgbGlua19uYW1lcyB0byAxLCBzcGVjaWZ5IGEgcGFyc2UgbW9kZSBvZiBmdWxsLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJhc191c2VyIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYXNzIHRydWUgdG8gdXBkYXRlIHRoZSBtZXNzYWdlIGFzIHRoZSBhdXRoZWQgdXNlci4gQm90IHVzZXJzIGluIHRoaXMgY29udGV4dCBhcmUgY29uc2lkZXJlZCBhdXRoZWQgdXNlcnMuXG4iCgkJCX0KCQldLAoJCSJkbmQuZW5kRG5kIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZG5kOndyaXRlXG4iCgkJCX0KCQldLAoJCSJkbmQuZW5kU25vb3plIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZG5kOndyaXRlXG4iCgkJCX0KCQldLAoJCSJkbmQuaW5mbyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGRuZDpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIGZldGNoIHN0YXR1cyBmb3IgKGRlZmF1bHRzIHRvIGN1cnJlbnQgdXNlcilcbiIKCQkJfQoJCV0sCgkJImRuZC5zZXRTbm9vemUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBkbmQ6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibnVtX21pbnV0ZXMiLAoJCQkJImV4YW1wbGUiOiAiNjAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgbWludXRlcywgZnJvbSBub3csIHRvIHNub296ZSB1bnRpbC5cbiIKCQkJfQoJCV0sCgkJImRuZC50ZWFtSW5mbyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGRuZDpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXJzIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0LFU0NTY3IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgdXNlcnMgdG8gZmV0Y2ggRG8gTm90IERpc3R1cmIgc3RhdHVzIGZvclxuIgoJCQl9CgkJXSwKCQkiZW1vamkubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGVtb2ppOnJlYWRcbiIKCQkJfQoJCV0sCgkJImZpbGVzLmNvbW1lbnRzLmFkZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGZpbGVzOndyaXRlOnVzZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDQ2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gYWRkIGEgY29tbWVudCB0by5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY29tbWVudCIsCgkJCQkiZXhhbXBsZSI6ICJFdmVyeW9uZSBzaG91bGQgdGFrZSBhIG1vbWVudCB0byByZWFkIHRoaXMgZmlsZS4iLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUZXh0IG9mIHRoZSBjb21tZW50IHRvIGFkZC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDQ2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgaWQgKGVuY29kZWQpIG9mIHdoaWNoIGxvY2F0aW9uIHRvIGFzc29jaWF0ZSB3aXRoIHRoZSBuZXcgY29tbWVudC5cbiIKCQkJfQoJCV0sCgkJImZpbGVzLmNvbW1lbnRzLmRlbGV0ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGZpbGVzOndyaXRlOnVzZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gZGVsZXRlIGEgY29tbWVudCBmcm9tLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpZCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgY29tbWVudCB0byBkZWxldGUuXG4iCgkJCX0KCQldLAoJCSJmaWxlcy5jb21tZW50cy5lZGl0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZmlsZXM6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSBjb250YWluaW5nIHRoZSBjb21tZW50IHRvIGVkaXQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImlkIiwKCQkJCSJleGFtcGxlIjogIkZjMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRoZSBjb21tZW50IHRvIGVkaXQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNvbW1lbnQiLAoJCQkJImV4YW1wbGUiOiAiRXZlcnlvbmUgc2hvdWxkIHRha2UgYSBtb21lbnQgdG8gcmVhZCB0aGlzIGZpbGUsIHNlcmlvdXNseS4iLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUZXh0IG9mIHRoZSBjb21tZW50IHRvIGVkaXQuXG4iCgkJCX0KCQldLAoJCSJmaWxlcy5kZWxldGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBmaWxlczp3cml0ZTp1c2VyXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGUiLAoJCQkJImV4YW1wbGUiOiAiRjEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJRCBvZiBmaWxlIHRvIGRlbGV0ZS5cbiIKCQkJfQoJCV0sCgkJImZpbGVzLmluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBmaWxlczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGUiLAoJCQkJImV4YW1wbGUiOiAiRjIxNDc0ODM4NjIiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTcGVjaWZ5IGEgZmlsZSBieSBwcm92aWRpbmcgaXRzIElELlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkiZmlsZXMubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGZpbGVzOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbHRlciBmaWxlcyBjcmVhdGVkIGJ5IGEgc2luZ2xlIHVzZXIuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgZmlsZXMgYXBwZWFyaW5nIGluIGEgc3BlY2lmaWMgY2hhbm5lbCwgaW5kaWNhdGVkIGJ5IGl0cyBJRC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHNfZnJvbSIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbHRlciBmaWxlcyBjcmVhdGVkIGFmdGVyIHRoaXMgdGltZXN0YW1wIChpbmNsdXNpdmUpLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0c190byIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PW5vdyIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsdGVyIGZpbGVzIGNyZWF0ZWQgYmVmb3JlIHRoaXMgdGltZXN0YW1wIChpbmNsdXNpdmUpLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0eXBlcyIsCgkJCQkiZXhhbXBsZSI6ICJpbWFnZXMiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PWFsbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsdGVyIGZpbGVzIGJ5IHR5cGU6XG5cblxuYWxsIC0gQWxsIGZpbGVzXG5zcGFjZXMgLSBQb3N0c1xuc25pcHBldHMgLSBTbmlwcGV0c1xuaW1hZ2VzIC0gSW1hZ2UgZmlsZXNcbmdkb2NzIC0gR29vZ2xlIGRvY3NcbnppcHMgLSBaaXAgZmlsZXNcbnBkZnMgLSBQREYgZmlsZXNcblxuXG5Zb3UgY2FuIHBhc3MgbXVsdGlwbGUgdmFsdWVzIGluIHRoZSB0eXBlcyBhcmd1bWVudCwgbGlrZSB0eXBlcz1zcGFjZXMsc25pcHBldHMuVGhlIGRlZmF1bHQgdmFsdWUgaXMgYWxsLCB3aGljaCBkb2VzIG5vdCBmaWx0ZXIgdGhlIGxpc3QuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNvdW50IiwKCQkJCSJleGFtcGxlIjogIjIwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xMDAiLAoJCQkJImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBpdGVtcyB0byByZXR1cm4gcGVyIHBhZ2UuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInBhZ2UiLAoJCQkJImV4YW1wbGUiOiAiMiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MSIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFnZSBudW1iZXIgb2YgcmVzdWx0cyB0byByZXR1cm4uXG4iCgkJCX0KCQldLAoJCSJmaWxlcy5yZXZva2VQdWJsaWNVUkwiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBmaWxlczp3cml0ZTp1c2VyXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGUiLAoJCQkJImV4YW1wbGUiOiAiRjEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIHRvIHJldm9rZVxuIgoJCQl9CgkJXSwKCQkiZmlsZXMuc2hhcmVkUHVibGljVVJMIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZmlsZXM6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSB0byBzaGFyZVxuIgoJCQl9CgkJXSwKCQkiZmlsZXMudXBsb2FkIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZmlsZXM6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIi4uLiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgY29udGVudHMgdmlhIG11bHRpcGFydC9mb3JtLWRhdGEuIElmIG9taXR0aW5nIHRoaXMgcGFyYW1ldGVyLCB5b3UgbXVzdCBzdWJtaXQgY29udGVudC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY29udGVudCIsCgkJCQkiZXhhbXBsZSI6ICIuLi4iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbnRlbnRzIHZpYSBhIFBPU1QgdmFyaWFibGUuIElmIG9taXR0aW5nIHRoaXMgcGFyYW1ldGVyLCB5b3UgbXVzdCBwcm92aWRlIGEgZmlsZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZXR5cGUiLAoJCQkJImV4YW1wbGUiOiAicGhwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSBmaWxlIHR5cGUgaWRlbnRpZmllci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZW5hbWUiLAoJCQkJImV4YW1wbGUiOiAiZm9vLnR4dCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGVuYW1lIG9mIGZpbGUuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRpdGxlIiwKCQkJCSJleGFtcGxlIjogIk15IEZpbGUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaXRsZSBvZiBmaWxlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbml0aWFsX2NvbW1lbnQiLAoJCQkJImV4YW1wbGUiOiAiQmVzdCEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbml0aWFsIGNvbW1lbnQgdG8gYWRkIHRvIGZpbGUuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWxzIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwLEMyMzQ1Njc4OTAxLEMzNDU2Nzg5MDEyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgY2hhbm5lbCBuYW1lcyBvciBJRHMgd2hlcmUgdGhlIGZpbGUgd2lsbCBiZSBzaGFyZWQuXG4iCgkJCX0KCQldLAoJCSJncm91cHMuYXJjaGl2ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIGFyY2hpdmVcbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5jbG9zZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIGNsb3NlLlxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLmNyZWF0ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJuYW1lIiwKCQkJCSJleGFtcGxlIjogIsKgIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTmFtZSBvZiBwcml2YXRlIGNoYW5uZWwgdG8gY3JlYXRlXG4iCgkJCX0KCQldLAoJCSJncm91cHMuY3JlYXRlQ2hpbGQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBjbG9uZSBhbmQgYXJjaGl2ZS5cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5oaXN0b3J5IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOmhpc3RvcnlcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBmZXRjaCBoaXN0b3J5IGZvci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibGF0ZXN0IiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1ub3ciLAoJCQkJImRlc2NyaXB0aW9uIjogIkVuZCBvZiB0aW1lIHJhbmdlIG9mIG1lc3NhZ2VzIHRvIGluY2x1ZGUgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAib2xkZXN0IiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTdGFydCBvZiB0aW1lIHJhbmdlIG9mIG1lc3NhZ2VzIHRvIGluY2x1ZGUgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVzaXZlIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgbWVzc2FnZXMgd2l0aCBsYXRlc3Qgb3Igb2xkZXN0IHRpbWVzdGFtcCBpbiByZXN1bHRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIxMDAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIG1lc3NhZ2VzIHRvIHJldHVybiwgYmV0d2VlbiAxIGFuZCAxMDAwLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1bnJlYWRzIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgdW5yZWFkX2NvdW50X2Rpc3BsYXkgaW4gdGhlIG91dHB1dD9cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5pbmZvIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBnZXQgaW5mbyBvblxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLmludml0ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIGludml0ZSB1c2VyIHRvLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVXNlciB0byBpbnZpdGUuXG4iCgkJCX0KCQldLAoJCSJncm91cHMua2ljayI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIHJlbW92ZSB1c2VyIGZyb20uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIHJlbW92ZSBmcm9tIHByaXZhdGUgY2hhbm5lbC5cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5sZWF2ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIGxlYXZlXG4iCgkJCX0KCQldLAoJCSJncm91cHMubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3VwczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImV4Y2x1ZGVfYXJjaGl2ZWQiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRG9uJ3QgcmV0dXJuIGFyY2hpdmVkIHByaXZhdGUgY2hhbm5lbHMuXG4iCgkJCX0KCQldLAoJCSJncm91cHMubWFyayI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIHNldCByZWFkaW5nIGN1cnNvciBpbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1vc3QgcmVjZW50bHkgc2VlbiBtZXNzYWdlLlxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLm9wZW4iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBvcGVuLlxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLnJlbmFtZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIHJlbmFtZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJuYW1lIiwKCQkJCSJleGFtcGxlIjogIsKgIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTmV3IG5hbWUgZm9yIHByaXZhdGUgY2hhbm5lbC5cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5yZXBsaWVzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOmhpc3RvcnlcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBmZXRjaCB0aHJlYWQgZnJvbVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aHJlYWRfdHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVbmlxdWUgaWRlbnRpZmllciBvZiBhIHRocmVhZCdzIHBhcmVudCBtZXNzYWdlXG4iCgkJCX0KCQldLAoJCSJncm91cHMuc2V0UHVycG9zZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIHNldCB0aGUgcHVycG9zZSBvZlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwdXJwb3NlIiwKCQkJCSJleGFtcGxlIjogIk15IFB1cnBvc2UiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgbmV3IHB1cnBvc2VcbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5zZXRUb3BpYyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIHNldCB0aGUgdG9waWMgb2ZcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidG9waWMiLAoJCQkJImV4YW1wbGUiOiAiTXkgVG9waWMiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgbmV3IHRvcGljXG4iCgkJCX0KCQldLAoJCSJncm91cHMudW5hcmNoaXZlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gdW5hcmNoaXZlXG4iCgkJCX0KCQldLAoJCSJpbS5jbG9zZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGltOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRDEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJEaXJlY3QgbWVzc2FnZSBjaGFubmVsIHRvIGNsb3NlLlxuIgoJCQl9CgkJXSwKCQkiaW0uaGlzdG9yeSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGltOmhpc3RvcnlcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJEMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkRpcmVjdCBtZXNzYWdlIGNoYW5uZWwgdG8gZmV0Y2ggaGlzdG9yeSBmb3IuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImxhdGVzdCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9bm93IiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJFbmQgb2YgdGltZSByYW5nZSBvZiBtZXNzYWdlcyB0byBpbmNsdWRlIGluIHJlc3VsdHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm9sZGVzdCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU3RhcnQgb2YgdGltZSByYW5nZSBvZiBtZXNzYWdlcyB0byBpbmNsdWRlIGluIHJlc3VsdHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImluY2x1c2l2ZSIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIG1lc3NhZ2VzIHdpdGggbGF0ZXN0IG9yIG9sZGVzdCB0aW1lc3RhbXAgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMTAwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xMDAiLAoJCQkJImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBtZXNzYWdlcyB0byByZXR1cm4sIGJldHdlZW4gMSBhbmQgMTAwMC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidW5yZWFkcyIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHVucmVhZF9jb3VudF9kaXNwbGF5IGluIHRoZSBvdXRwdXQ/XG4iCgkJCX0KCQldLAoJCSJpbS5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogaW06cmVhZFxuIgoJCQl9CgkJXSwKCQkiaW0ubWFyayI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGltOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRDEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJEaXJlY3QgbWVzc2FnZSBjaGFubmVsIHRvIHNldCByZWFkaW5nIGN1cnNvciBpbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1vc3QgcmVjZW50bHkgc2VlbiBtZXNzYWdlLlxuIgoJCQl9CgkJXSwKCQkiaW0ub3BlbiI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGltOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIG9wZW4gYSBkaXJlY3QgbWVzc2FnZSBjaGFubmVsIHdpdGguXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInJldHVybl9pbSIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQm9vbGVhbiwgaW5kaWNhdGVzIHlvdSB3YW50IHRoZSBmdWxsIElNIGNoYW5uZWwgZGVmaW5pdGlvbiBpbiB0aGUgcmVzcG9uc2UuXG4iCgkJCX0KCQldLAoJCSJpbS5yZXBsaWVzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogaW06aGlzdG9yeVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRGlyZWN0IG1lc3NhZ2UgY2hhbm5lbCB0byBmZXRjaCB0aHJlYWQgZnJvbVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aHJlYWRfdHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVbmlxdWUgaWRlbnRpZmllciBvZiBhIHRocmVhZCdzIHBhcmVudCBtZXNzYWdlXG4iCgkJCX0KCQldLAoJCSJtcGltLmNsb3NlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogbXBpbTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTVBJTSB0byBjbG9zZS5cbiIKCQkJfQoJCV0sCgkJIm1waW0uaGlzdG9yeSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IG1waW06aGlzdG9yeVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTXVsdGlwYXJ0eSBkaXJlY3QgbWVzc2FnZSB0byBmZXRjaCBoaXN0b3J5IGZvci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibGF0ZXN0IiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1ub3ciLAoJCQkJImRlc2NyaXB0aW9uIjogIkVuZCBvZiB0aW1lIHJhbmdlIG9mIG1lc3NhZ2VzIHRvIGluY2x1ZGUgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAib2xkZXN0IiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTdGFydCBvZiB0aW1lIHJhbmdlIG9mIG1lc3NhZ2VzIHRvIGluY2x1ZGUgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVzaXZlIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgbWVzc2FnZXMgd2l0aCBsYXRlc3Qgb3Igb2xkZXN0IHRpbWVzdGFtcCBpbiByZXN1bHRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIxMDAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIG1lc3NhZ2VzIHRvIHJldHVybiwgYmV0d2VlbiAxIGFuZCAxMDAwLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1bnJlYWRzIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgdW5yZWFkX2NvdW50X2Rpc3BsYXkgaW4gdGhlIG91dHB1dD9cbiIKCQkJfQoJCV0sCgkJIm1waW0ubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IG1waW06cmVhZFxuIgoJCQl9CgkJXSwKCQkibXBpbS5tYXJrIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogbXBpbTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAibXVsdGlwYXJ0eSBkaXJlY3QgbWVzc2FnZSBjaGFubmVsIHRvIHNldCByZWFkaW5nIGN1cnNvciBpbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1vc3QgcmVjZW50bHkgc2VlbiBtZXNzYWdlLlxuIgoJCQl9CgkJXSwKCQkibXBpbS5vcGVuIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogbXBpbTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VycyIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCxVMjM0NTY3ODkwMSxVMzQ1Njc4OTAxMiIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNvbW1hIHNlcGFyYXRlZCBsaXN0cyBvZiB1c2Vycy4gIFRoZSBvcmRlcmluZyBvZiB0aGUgdXNlcnMgaXMgcHJlc2VydmVkIHdoZW5ldmVyIGEgTVBJTSBncm91cCBpcyByZXR1cm5lZC5cbiIKCQkJfQoJCV0sCgkJIm1waW0ucmVwbGllcyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IG1waW06aGlzdG9yeVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTXVsdGlwYXJ0eSBkaXJlY3QgbWVzc2FnZSBjaGFubmVsIHRvIGZldGNoIHRocmVhZCBmcm9tLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aHJlYWRfdHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVbmlxdWUgaWRlbnRpZmllciBvZiBhIHRocmVhZCdzIHBhcmVudCBtZXNzYWdlLlxuIgoJCQl9CgkJXSwKCQkib2F1dGguYWNjZXNzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJjbGllbnRfaWQiLAoJCQkJImV4YW1wbGUiOiAiNGIzOWU5LTc1MmM0IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSXNzdWVkIHdoZW4geW91IGNyZWF0ZWQgeW91ciBhcHBsaWNhdGlvbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2xpZW50X3NlY3JldCIsCgkJCQkiZXhhbXBsZSI6ICIzM2ZlYTAxMTNmNWIxIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSXNzdWVkIHdoZW4geW91IGNyZWF0ZWQgeW91ciBhcHBsaWNhdGlvbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY29kZSIsCgkJCQkiZXhhbXBsZSI6ICJjY2RhYTcyYWQiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgY29kZSBwYXJhbSByZXR1cm5lZCB2aWEgdGhlIE9BdXRoIGNhbGxiYWNrLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJyZWRpcmVjdF91cmkiLAoJCQkJImV4YW1wbGUiOiAiaHR0cDovL2V4YW1wbGUuY29tIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhpcyBtdXN0IG1hdGNoIHRoZSBvcmlnaW5hbGx5IHN1Ym1pdHRlZCBVUkkgKGlmIG9uZSB3YXMgc2VudCkuXG4iCgkJCX0KCQldLAoJCSJwaW5zLmFkZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHBpbnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gcGluIHRoZSBpdGVtIGluLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSB0byBwaW4uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVfY29tbWVudCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbW1lbnQgdG8gcGluLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aW1lc3RhbXAiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1lc3NhZ2UgdG8gcGluLlxuIgoJCQl9CgkJXSwKCQkicGlucy5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogcGluczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIGdldCBwaW5uZWQgaXRlbXMgZm9yLlxuIgoJCQl9CgkJXSwKCQkicGlucy5yZW1vdmUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBwaW5zOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHdoZXJlIHRoZSBpdGVtIGlzIHBpbm5lZCB0by5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gdW4tcGluLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlX2NvbW1lbnQiLAoJCQkJImV4YW1wbGUiOiAiRmMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSBjb21tZW50IHRvIHVuLXBpbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGltZXN0YW1wIiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtZXNzYWdlIHRvIHVuLXBpbi5cbiIKCQkJfQoJCV0sCgkJInJlYWN0aW9ucy5hZGQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZWFjdGlvbnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJ0aHVtYnN1cCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlJlYWN0aW9uIChlbW9qaSkgbmFtZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gYWRkIHJlYWN0aW9uIHRvLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlX2NvbW1lbnQiLAoJCQkJImV4YW1wbGUiOiAiRmMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSBjb21tZW50IHRvIGFkZCByZWFjdGlvbiB0by5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgd2hlcmUgdGhlIG1lc3NhZ2UgdG8gYWRkIHJlYWN0aW9uIHRvIHdhcyBwb3N0ZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRpbWVzdGFtcCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbWVzc2FnZSB0byBhZGQgcmVhY3Rpb24gdG8uXG4iCgkJCX0KCQldLAoJCSJyZWFjdGlvbnMuZ2V0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogcmVhY3Rpb25zOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gZ2V0IHJlYWN0aW9ucyBmb3IuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVfY29tbWVudCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbW1lbnQgdG8gZ2V0IHJlYWN0aW9ucyBmb3IuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHdoZXJlIHRoZSBtZXNzYWdlIHRvIGdldCByZWFjdGlvbnMgZm9yIHdhcyBwb3N0ZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRpbWVzdGFtcCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbWVzc2FnZSB0byBnZXQgcmVhY3Rpb25zIGZvci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZnVsbCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSWYgdHJ1ZSBhbHdheXMgcmV0dXJuIHRoZSBjb21wbGV0ZSByZWFjdGlvbiBsaXN0LlxuIgoJCQl9CgkJXSwKCQkicmVhY3Rpb25zLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZWFjdGlvbnM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU2hvdyByZWFjdGlvbnMgbWFkZSBieSB0aGlzIHVzZXIuIERlZmF1bHRzIHRvIHRoZSBhdXRoZWQgdXNlci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZnVsbCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSWYgdHJ1ZSBhbHdheXMgcmV0dXJuIHRoZSBjb21wbGV0ZSByZWFjdGlvbiBsaXN0LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkicmVhY3Rpb25zLnJlbW92ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHJlYWN0aW9uczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJuYW1lIiwKCQkJCSJleGFtcGxlIjogInRodW1ic3VwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUmVhY3Rpb24gKGVtb2ppKSBuYW1lLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSB0byByZW1vdmUgcmVhY3Rpb24gZnJvbS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZV9jb21tZW50IiwKCQkJCSJleGFtcGxlIjogIkZjMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgY29tbWVudCB0byByZW1vdmUgcmVhY3Rpb24gZnJvbS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgd2hlcmUgdGhlIG1lc3NhZ2UgdG8gcmVtb3ZlIHJlYWN0aW9uIGZyb20gd2FzIHBvc3RlZC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGltZXN0YW1wIiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtZXNzYWdlIHRvIHJlbW92ZSByZWFjdGlvbiBmcm9tLlxuIgoJCQl9CgkJXSwKCQkicmVtaW5kZXJzLmFkZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHJlbWluZGVyczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0ZXh0IiwKCQkJCSJleGFtcGxlIjogImVhdCBhIGJhbmFuYSIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRoZSBjb250ZW50IG9mIHRoZSByZW1pbmRlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aW1lIiwKCQkJCSJleGFtcGxlIjogIjE2MDIyODgwMDAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJXaGVuIHRoaXMgcmVtaW5kZXIgc2hvdWxkIGhhcHBlbjogdGhlIFVuaXggdGltZXN0YW1wICh1cCB0byBmaXZlIHllYXJzIGZyb20gbm93KSwgdGhlIG51bWJlciBvZiBzZWNvbmRzIHVudGlsIHRoZSByZW1pbmRlciAoaWYgd2l0aGluIDI0IGhvdXJzKSwgb3IgYSBuYXR1cmFsIGxhbmd1YWdlIGRlc2NyaXB0aW9uIChFeC4gXCJpbiAxNSBtaW51dGVzLFwiIG9yIFwiZXZlcnkgVGh1cnNkYXlcIilcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTg4ODg4ODgiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgdXNlciB3aG8gd2lsbCByZWNlaXZlIHRoZSByZW1pbmRlci4gSWYgbm8gdXNlciBpcyBzcGVjaWZpZWQsIHRoZSByZW1pbmRlciB3aWxsIGdvIHRvIHVzZXIgd2hvIGNyZWF0ZWQgaXQuXG4iCgkJCX0KCQldLAoJCSJyZW1pbmRlcnMuY29tcGxldGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZW1pbmRlcnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicmVtaW5kZXIiLAoJCQkJImV4YW1wbGUiOiAiUm0xMjM0NTY3OCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRoZSBJRCBvZiB0aGUgcmVtaW5kZXIgdG8gYmUgbWFya2VkIGFzIGNvbXBsZXRlXG4iCgkJCX0KCQldLAoJCSJyZW1pbmRlcnMuZGVsZXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogcmVtaW5kZXJzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInJlbWluZGVyIiwKCQkJCSJleGFtcGxlIjogIlJtMTIzNDU2NzgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgSUQgb2YgdGhlIHJlbWluZGVyXG4iCgkJCX0KCQldLAoJCSJyZW1pbmRlcnMuaW5mbyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHJlbWluZGVyczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInJlbWluZGVyIiwKCQkJCSJleGFtcGxlIjogIlJtMjM0NTY3ODkiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgSUQgb2YgdGhlIHJlbWluZGVyXG4iCgkJCX0KCQldLAoJCSJyZW1pbmRlcnMubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHJlbWluZGVyczpyZWFkXG4iCgkJCX0KCQldLAoJCSJydG0uc3RhcnQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjbGllbnRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAic2ltcGxlX2xhdGVzdCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUmV0dXJuIHRpbWVzdGFtcCBvbmx5IGZvciBsYXRlc3QgbWVzc2FnZSBvYmplY3Qgb2YgZWFjaCBjaGFubmVsIChpbXByb3ZlcyBwZXJmb3JtYW5jZSkuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm5vX3VucmVhZHMiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlNraXAgdW5yZWFkIGNvdW50cyBmb3IgZWFjaCBjaGFubmVsIChpbXByb3ZlcyBwZXJmb3JtYW5jZSkuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm1waW1fYXdhcmUiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlJldHVybnMgTVBJTXMgdG8gdGhlIGNsaWVudCBpbiB0aGUgQVBJIHJlc3BvbnNlLlxuIgoJCQl9CgkJXSwKCQkic2VhcmNoLmFsbCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHNlYXJjaDpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInF1ZXJ5IiwKCQkJCSJleGFtcGxlIjogInBpY2tsZWZhY2UiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTZWFyY2ggcXVlcnkuIE1heSBjb250YWlucyBib29sZWFucywgZXRjLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJzb3J0IiwKCQkJCSJleGFtcGxlIjogInRpbWVzdGFtcCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9c2NvcmUiLAoJCQkJImRlc2NyaXB0aW9uIjogIlJldHVybiBtYXRjaGVzIHNvcnRlZCBieSBlaXRoZXIgc2NvcmUgb3IgdGltZXN0YW1wLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJzb3J0X2RpciIsCgkJCQkiZXhhbXBsZSI6ICJhc2MiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PWRlc2MiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5nZSBzb3J0IGRpcmVjdGlvbiB0byBhc2NlbmRpbmcgKGFzYykgb3IgZGVzY2VuZGluZyAoZGVzYykuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImhpZ2hsaWdodCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyBhIHZhbHVlIG9mIHRydWUgdG8gZW5hYmxlIHF1ZXJ5IGhpZ2hsaWdodCBtYXJrZXJzIChzZWUgYmVsb3cpLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MjAiLAoJCQkJImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBpdGVtcyB0byByZXR1cm4gcGVyIHBhZ2UuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInBhZ2UiLAoJCQkJImV4YW1wbGUiOiAiMiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MSIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFnZSBudW1iZXIgb2YgcmVzdWx0cyB0byByZXR1cm4uXG4iCgkJCX0KCQldLAoJCSJzZWFyY2guZmlsZXMiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBzZWFyY2g6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJxdWVyeSIsCgkJCQkiZXhhbXBsZSI6ICJwaWNrbGVmYWNlIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU2VhcmNoIHF1ZXJ5LiBNYXkgY29udGFpbiBib29sZWFucywgZXRjLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJzb3J0IiwKCQkJCSJleGFtcGxlIjogInRpbWVzdGFtcCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9c2NvcmUiLAoJCQkJImRlc2NyaXB0aW9uIjogIlJldHVybiBtYXRjaGVzIHNvcnRlZCBieSBlaXRoZXIgc2NvcmUgb3IgdGltZXN0YW1wLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJzb3J0X2RpciIsCgkJCQkiZXhhbXBsZSI6ICJhc2MiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PWRlc2MiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5nZSBzb3J0IGRpcmVjdGlvbiB0byBhc2NlbmRpbmcgKGFzYykgb3IgZGVzY2VuZGluZyAoZGVzYykuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImhpZ2hsaWdodCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyBhIHZhbHVlIG9mIHRydWUgdG8gZW5hYmxlIHF1ZXJ5IGhpZ2hsaWdodCBtYXJrZXJzIChzZWUgYmVsb3cpLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MjAiLAoJCQkJImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBpdGVtcyB0byByZXR1cm4gcGVyIHBhZ2UuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInBhZ2UiLAoJCQkJImV4YW1wbGUiOiAiMiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MSIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFnZSBudW1iZXIgb2YgcmVzdWx0cyB0byByZXR1cm4uXG4iCgkJCX0KCQldLAoJCSJzZWFyY2gubWVzc2FnZXMiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBzZWFyY2g6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJxdWVyeSIsCgkJCQkiZXhhbXBsZSI6ICJwaWNrbGVmYWNlIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU2VhcmNoIHF1ZXJ5LiBNYXkgY29udGFpbnMgYm9vbGVhbnMsIGV0Yy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAic29ydCIsCgkJCQkiZXhhbXBsZSI6ICJ0aW1lc3RhbXAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PXNjb3JlIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJSZXR1cm4gbWF0Y2hlcyBzb3J0ZWQgYnkgZWl0aGVyIHNjb3JlIG9yIHRpbWVzdGFtcC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAic29ydF9kaXIiLAoJCQkJImV4YW1wbGUiOiAiYXNjIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1kZXNjIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFuZ2Ugc29ydCBkaXJlY3Rpb24gdG8gYXNjZW5kaW5nIChhc2MpIG9yIGRlc2NlbmRpbmcgKGRlc2MpLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJoaWdobGlnaHQiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhc3MgYSB2YWx1ZSBvZiB0cnVlIHRvIGVuYWJsZSBxdWVyeSBoaWdobGlnaHQgbWFya2VycyAoc2VlIGJlbG93KS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMjAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTIwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkic3RhcnMuYWRkIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogc3RhcnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gYWRkIHN0YXIgdG8uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVfY29tbWVudCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbW1lbnQgdG8gYWRkIHN0YXIgdG8uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIGFkZCBzdGFyIHRvLCBvciBjaGFubmVsIHdoZXJlIHRoZSBtZXNzYWdlIHRvIGFkZCBzdGFyIHRvIHdhcyBwb3N0ZWQgKHVzZWQgd2l0aCB0aW1lc3RhbXApLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aW1lc3RhbXAiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1lc3NhZ2UgdG8gYWRkIHN0YXIgdG8uXG4iCgkJCX0KCQldLAoJCSJzdGFycy5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogc3RhcnM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkic3RhcnMucmVtb3ZlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogc3RhcnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gcmVtb3ZlIHN0YXIgZnJvbS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZV9jb21tZW50IiwKCQkJCSJleGFtcGxlIjogIkZjMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgY29tbWVudCB0byByZW1vdmUgc3RhciBmcm9tLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byByZW1vdmUgc3RhciBmcm9tLCBvciBjaGFubmVsIHdoZXJlIHRoZSBtZXNzYWdlIHRvIHJlbW92ZSBzdGFyIGZyb20gd2FzIHBvc3RlZCAodXNlZCB3aXRoIHRpbWVzdGFtcCkuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRpbWVzdGFtcCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbWVzc2FnZSB0byByZW1vdmUgc3RhciBmcm9tLlxuIgoJCQl9CgkJXSwKCQkidGVhbS5hY2Nlc3NMb2dzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogYWRtaW5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMjAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIGl0ZW1zIHRvIHJldHVybiBwZXIgcGFnZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicGFnZSIsCgkJCQkiZXhhbXBsZSI6ICIyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYWdlIG51bWJlciBvZiByZXN1bHRzIHRvIHJldHVybi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYmVmb3JlIiwKCQkJCSJleGFtcGxlIjogIjE0NTc5ODkxNjYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PW5vdyIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRW5kIG9mIHRpbWUgcmFuZ2Ugb2YgbG9ncyB0byBpbmNsdWRlIGluIHJlc3VsdHMgKGluY2x1c2l2ZSkuXG4iCgkJCX0KCQldLAoJCSJ0ZWFtLmJpbGxhYmxlSW5mbyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGFkbWluXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIHVzZXIgdG8gcmV0cmlldmUgdGhlIGJpbGxhYmxlIGluZm9ybWF0aW9uIGZvci4gRGVmYXVsdHMgdG8gYWxsIHVzZXJzLlxuIgoJCQl9CgkJXSwKCQkidGVhbS5pbmZvIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdGVhbTpyZWFkXG4iCgkJCX0KCQldLAoJCSJ0ZWFtLmludGVncmF0aW9uTG9ncyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGFkbWluXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInNlcnZpY2VfaWQiLAoJCQkJImV4YW1wbGUiOiAiwqAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgbG9ncyB0byB0aGlzIHNlcnZpY2UuIERlZmF1bHRzIHRvIGFsbCBsb2dzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJhcHBfaWQiLAoJCQkJImV4YW1wbGUiOiAiwqAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgbG9ncyB0byB0aGlzIFNsYWNrIGFwcC4gRGVmYXVsdHMgdG8gYWxsIGxvZ3MuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgbG9ncyBnZW5lcmF0ZWQgYnkgdGhpcyB1c2Vy4oCZcyBhY3Rpb25zLiBEZWZhdWx0cyB0byBhbGwgbG9ncy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbmdlX3R5cGUiLAoJCQkJImV4YW1wbGUiOiAiYWRkZWQiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgbG9ncyB3aXRoIHRoaXMgY2hhbmdlIHR5cGUuIERlZmF1bHRzIHRvIGFsbCBsb2dzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkidGVhbS5wcm9maWxlLmdldCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJzLnByb2ZpbGU6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ2aXNpYmlsaXR5IiwKCQkJCSJleGFtcGxlIjogImFsbCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbHRlciBieSB2aXNpYmlsaXR5LlxuIgoJCQl9CgkJXSwKCQkidXNlcmdyb3Vwcy5jcmVhdGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2VyZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm5hbWUiLAoJCQkJImV4YW1wbGUiOiAiTXkgVGVzdCBUZWFtIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSBuYW1lIGZvciB0aGUgVXNlciBHcm91cC4gTXVzdCBiZSB1bmlxdWUgYW1vbmcgVXNlciBHcm91cHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImhhbmRsZSIsCgkJCQkiZXhhbXBsZSI6ICJtYXJrZXRpbmciLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIG1lbnRpb24gaGFuZGxlLiBNdXN0IGJlIHVuaXF1ZSBhbW9uZyBjaGFubmVscywgdXNlcnMgYW5kIFVzZXIgR3JvdXBzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJkZXNjcmlwdGlvbiIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkEgc2hvcnQgZGVzY3JpcHRpb24gb2YgdGhlIFVzZXIgR3JvdXAuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWxzIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwLEMyMzQ1Njc4OTAxLEMzNDU2Nzg5MDEyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSBjb21tYSBzZXBhcmF0ZWQgc3RyaW5nIG9mIGVuY29kZWQgY2hhbm5lbCBJRHMgZm9yIHdoaWNoIHRoZSBVc2VyIEdyb3VwIHVzZXMgYXMgYSBkZWZhdWx0LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2NvdW50IiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHRoZSBudW1iZXIgb2YgdXNlcnMgaW4gZWFjaCBVc2VyIEdyb3VwLlxuIgoJCQl9CgkJXSwKCQkidXNlcmdyb3Vwcy5kaXNhYmxlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcmdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyZ3JvdXAiLAoJCQkJImV4YW1wbGUiOiAiUzA2MDRRU0pDIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIGVuY29kZWQgSUQgb2YgdGhlIFVzZXIgR3JvdXAgdG8gZGlzYWJsZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVkZV9jb3VudCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSB0aGUgbnVtYmVyIG9mIHVzZXJzIGluIHRoZSBVc2VyIEdyb3VwLlxuIgoJCQl9CgkJXSwKCQkidXNlcmdyb3Vwcy5lbmFibGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2VyZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXJncm91cCIsCgkJCQkiZXhhbXBsZSI6ICJTMDYwNFFTSkMiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgZW5jb2RlZCBJRCBvZiB0aGUgVXNlciBHcm91cCB0byBlbmFibGUuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImluY2x1ZGVfY291bnQiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgdGhlIG51bWJlciBvZiB1c2VycyBpbiB0aGUgVXNlciBHcm91cC5cbiIKCQkJfQoJCV0sCgkJInVzZXJncm91cHMubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJncm91cHM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2Rpc2FibGVkIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIGRpc2FibGVkIFVzZXIgR3JvdXBzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2NvdW50IiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHRoZSBudW1iZXIgb2YgdXNlcnMgaW4gZWFjaCBVc2VyIEdyb3VwLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX3VzZXJzIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHRoZSBsaXN0IG9mIHVzZXJzIGZvciBlYWNoIFVzZXIgR3JvdXAuXG4iCgkJCX0KCQldLAoJCSJ1c2VyZ3JvdXBzLnVwZGF0ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlcmdyb3VwIiwKCQkJCSJleGFtcGxlIjogIlMwNjA0UVNKQyIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRoZSBlbmNvZGVkIElEIG9mIHRoZSBVc2VyIEdyb3VwIHRvIHVwZGF0ZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJNeSBUZXN0IFRlYW0iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIG5hbWUgZm9yIHRoZSBVc2VyIEdyb3VwLiBNdXN0IGJlIHVuaXF1ZSBhbW9uZyBVc2VyIEdyb3Vwcy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaGFuZGxlIiwKCQkJCSJleGFtcGxlIjogIm1hcmtldGluZyIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkEgbWVudGlvbiBoYW5kbGUuIE11c3QgYmUgdW5pcXVlIGFtb25nIGNoYW5uZWxzLCB1c2VycyBhbmQgVXNlciBHcm91cHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImRlc2NyaXB0aW9uIiwKCQkJCSJleGFtcGxlIjogIsKgIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSBzaG9ydCBkZXNjcmlwdGlvbiBvZiB0aGUgVXNlciBHcm91cC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbHMiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAsQzIzNDU2Nzg5MDEsQzM0NTY3ODkwMTIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIGNvbW1hIHNlcGFyYXRlZCBzdHJpbmcgb2YgZW5jb2RlZCBjaGFubmVsIElEcyBmb3Igd2hpY2ggdGhlIFVzZXIgR3JvdXAgdXNlcyBhcyBhIGRlZmF1bHQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImluY2x1ZGVfY291bnQiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgdGhlIG51bWJlciBvZiB1c2VycyBpbiB0aGUgVXNlciBHcm91cC5cbiIKCQkJfQoJCV0sCgkJInVzZXJncm91cHMudXNlcnMubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJncm91cHM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyZ3JvdXAiLAoJCQkJImV4YW1wbGUiOiAiUzA2MDRRU0pDIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIGVuY29kZWQgSUQgb2YgdGhlIFVzZXIgR3JvdXAgdG8gdXBkYXRlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2Rpc2FibGVkIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBbGxvdyByZXN1bHRzIHRoYXQgaW52b2x2ZSBkaXNhYmxlZCBVc2VyIEdyb3Vwcy5cbiIKCQkJfQoJCV0sCgkJInVzZXJncm91cHMudXNlcnMudXBkYXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcmdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyZ3JvdXAiLAoJCQkJImV4YW1wbGUiOiAiUzA2MDRRU0pDIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIGVuY29kZWQgSUQgb2YgdGhlIFVzZXIgR3JvdXAgdG8gdXBkYXRlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VycyIsCgkJCQkiZXhhbXBsZSI6ICJVMDYwUjRCSjQsVTA2MFJOUkNaIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSBjb21tYSBzZXBhcmF0ZWQgc3RyaW5nIG9mIGVuY29kZWQgdXNlciBJRHMgdGhhdCByZXByZXNlbnQgdGhlIGVudGlyZSBsaXN0IG9mIHVzZXJzIGZvciB0aGUgVXNlciBHcm91cC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVkZV9jb3VudCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSB0aGUgbnVtYmVyIG9mIHVzZXJzIGluIHRoZSBVc2VyIEdyb3VwLlxuIgoJCQl9CgkJXSwKCQkidXNlcnMuZGVsZXRlUGhvdG8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2Vycy5wcm9maWxlOndyaXRlXG4iCgkJCX0KCQldLAoJCSJ1c2Vycy5nZXRQcmVzZW5jZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJzOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVzZXIgdG8gZ2V0IHByZXNlbmNlIGluZm8gb24uIERlZmF1bHRzIHRvIHRoZSBhdXRoZWQgdXNlci5cbiIKCQkJfQoJCV0sCgkJInVzZXJzLmlkZW50aXR5IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogaWRlbnRpdHkuYmFzaWNcbiIKCQkJfQoJCV0sCgkJInVzZXJzLmluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2VyczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIGdldCBpbmZvIG9uXG4iCgkJCX0KCQldLAoJCSJ1c2Vycy5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwcmVzZW5jZSIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiV2hldGhlciB0byBpbmNsdWRlIHByZXNlbmNlIGRhdGEgaW4gdGhlIG91dHB1dFxuIgoJCQl9CgkJXSwKCQkidXNlcnMuc2V0QWN0aXZlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnM6d3JpdGVcbiIKCQkJfQoJCV0sCgkJInVzZXJzLnNldFBob3RvIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnMucHJvZmlsZTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbWFnZSIsCgkJCQkiZXhhbXBsZSI6ICIuLi4iLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbnRlbnRzIHZpYSBtdWx0aXBhcnQvZm9ybS1kYXRhLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjcm9wX3giLAoJCQkJImV4YW1wbGUiOiAiMTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJYIGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQgY29ybmVyIG9mIGNyb3AgYm94XG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNyb3BfeSIsCgkJCQkiZXhhbXBsZSI6ICIxNSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlkgY29vcmRpbmF0ZSBvZiB0b3AtbGVmdCBjb3JuZXIgb2YgY3JvcCBib3hcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY3JvcF93IiwKCQkJCSJleGFtcGxlIjogIjEwMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIldpZHRoL2hlaWdodCBvZiBjcm9wIGJveCAoYWx3YXlzIHNxdWFyZSlcbiIKCQkJfQoJCV0sCgkJInVzZXJzLnNldFByZXNlbmNlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicHJlc2VuY2UiLAoJCQkJImV4YW1wbGUiOiAiYXdheSIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkVpdGhlciBhdXRvIG9yIGF3YXlcbiIKCQkJfQoJCV0sCgkJInVzZXJzLnByb2ZpbGUuZ2V0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnMucHJvZmlsZTpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIHJldHJpZXZlIHByb2ZpbGUgaW5mbyBmb3JcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVkZV9sYWJlbHMiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9ZmFsc2UiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgbGFiZWxzIGZvciBlYWNoIElEIGluIGN1c3RvbSBwcm9maWxlIGZpZWxkc1xuIgoJCQl9CgkJXSwKCQkidXNlcnMucHJvZmlsZS5zZXQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2Vycy5wcm9maWxlOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJRCBvZiB1c2VyIHRvIGNoYW5nZS4gVGhpcyBhcmd1bWVudCBtYXkgb25seSBiZSBzcGVjaWZpZWQgYnkgdGVhbSBhZG1pbnMgb24gcGFpZCB0ZWFtcy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicHJvZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJ7IGZpcnN0X25hbWU6IFwiSm9oblwiLCAuLi4gfSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNvbGxlY3Rpb24gb2Yga2V5OnZhbHVlIHBhaXJzIHByZXNlbnRlZCBhcyBhIFVSTC1lbmNvZGVkIEpTT04gaGFzaC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJmaXJzdF9uYW1lIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTmFtZSBvZiBhIHNpbmdsZSBrZXkgdG8gc2V0LiBVc2FibGUgb25seSBpZiBwcm9maWxlIGlzIG5vdCBwYXNzZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInZhbHVlIiwKCQkJCSJleGFtcGxlIjogIkpvaG4iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJWYWx1ZSB0byBzZXQgYSBzaW5nbGUga2V5IHRvLiBVc2FibGUgb25seSBpZiBwcm9maWxlIGlzIG5vdCBwYXNzZWQuXG4iCgkJCX0KCQldCgl9OwoKLyoqKi8gfSwKLyogNTIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gY2xpZW50OwoKCS8vIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtc3RhdGVmdWwtY2xpZW50CglmdW5jdGlvbiBjbGllbnQodG9rZW4pIHsKCSAgdmFyIGFwcGxpZWQgPSB7CgkgICAgYXV0aDogewoJICAgICAgdGVzdDoge30KCSAgICB9LAoJICAgIGJvdHM6IHsKCSAgICAgIGluZm86IHt9CgkgICAgfSwKCSAgICBjaGFubmVsczogewoJICAgICAgYXJjaGl2ZToge30sCgkgICAgICBjcmVhdGU6IHt9LAoJICAgICAgaGlzdG9yeToge30sCgkgICAgICBpbmZvOiB7fSwKCSAgICAgIGludml0ZToge30sCgkgICAgICBqb2luOiB7fSwKCSAgICAgIGtpY2s6IHt9LAoJICAgICAgbGVhdmU6IHt9LAoJICAgICAgbGlzdDoge30sCgkgICAgICBtYXJrOiB7fSwKCSAgICAgIHJlbmFtZToge30sCgkgICAgICByZXBsaWVzOiB7fSwKCSAgICAgIHNldFB1cnBvc2U6IHt9LAoJICAgICAgc2V0VG9waWM6IHt9LAoJICAgICAgdW5hcmNoaXZlOiB7fQoJICAgIH0sCgkgICAgY2hhdDogewoJICAgICAgZGVsZXRlOiB7fSwKCSAgICAgIG1lTWVzc2FnZToge30sCgkgICAgICBwb3N0TWVzc2FnZToge30sCgkgICAgICB1cGRhdGU6IHt9CgkgICAgfSwKCSAgICBkbmQ6IHsKCSAgICAgIGVuZERuZDoge30sCgkgICAgICBlbmRTbm9vemU6IHt9LAoJICAgICAgaW5mbzoge30sCgkgICAgICBzZXRTbm9vemU6IHt9LAoJICAgICAgdGVhbUluZm86IHt9CgkgICAgfSwKCSAgICBlbW9qaTogewoJICAgICAgbGlzdDoge30KCSAgICB9LAoJICAgIGZpbGVzOiB7CgkgICAgICBjb21tZW50czogewoJICAgICAgICBhZGQ6IHt9LAoJICAgICAgICBkZWxldGU6IHt9LAoJICAgICAgICBlZGl0OiB7fQoJICAgICAgfSwKCSAgICAgIGRlbGV0ZToge30sCgkgICAgICBpbmZvOiB7fSwKCSAgICAgIGxpc3Q6IHt9LAoJICAgICAgcmV2b2tlUHVibGljVVJMOiB7fSwKCSAgICAgIHNoYXJlZFB1YmxpY1VSTDoge30sCgkgICAgICB1cGxvYWQ6IHt9CgkgICAgfSwKCSAgICBncm91cHM6IHsKCSAgICAgIGFyY2hpdmU6IHt9LAoJICAgICAgY2xvc2U6IHt9LAoJICAgICAgY3JlYXRlOiB7fSwKCSAgICAgIGNyZWF0ZUNoaWxkOiB7fSwKCSAgICAgIGhpc3Rvcnk6IHt9LAoJICAgICAgaW5mbzoge30sCgkgICAgICBpbnZpdGU6IHt9LAoJICAgICAga2ljazoge30sCgkgICAgICBsZWF2ZToge30sCgkgICAgICBsaXN0OiB7fSwKCSAgICAgIG1hcms6IHt9LAoJICAgICAgb3Blbjoge30sCgkgICAgICByZW5hbWU6IHt9LAoJICAgICAgcmVwbGllczoge30sCgkgICAgICBzZXRQdXJwb3NlOiB7fSwKCSAgICAgIHNldFRvcGljOiB7fSwKCSAgICAgIHVuYXJjaGl2ZToge30KCSAgICB9LAoJICAgIGltOiB7CgkgICAgICBjbG9zZToge30sCgkgICAgICBoaXN0b3J5OiB7fSwKCSAgICAgIGxpc3Q6IHt9LAoJICAgICAgbWFyazoge30sCgkgICAgICBvcGVuOiB7fSwKCSAgICAgIHJlcGxpZXM6IHt9CgkgICAgfSwKCSAgICBtcGltOiB7CgkgICAgICBjbG9zZToge30sCgkgICAgICBoaXN0b3J5OiB7fSwKCSAgICAgIGxpc3Q6IHt9LAoJICAgICAgbWFyazoge30sCgkgICAgICBvcGVuOiB7fSwKCSAgICAgIHJlcGxpZXM6IHt9CgkgICAgfSwKCSAgICBwaW5zOiB7CgkgICAgICBhZGQ6IHt9LAoJICAgICAgbGlzdDoge30sCgkgICAgICByZW1vdmU6IHt9CgkgICAgfSwKCSAgICByZWFjdGlvbnM6IHsKCSAgICAgIGFkZDoge30sCgkgICAgICBnZXQ6IHt9LAoJICAgICAgbGlzdDoge30sCgkgICAgICByZW1vdmU6IHt9CgkgICAgfSwKCSAgICByZW1pbmRlcnM6IHsKCSAgICAgIGFkZDoge30sCgkgICAgICBjb21wbGV0ZToge30sCgkgICAgICBkZWxldGU6IHt9LAoJICAgICAgaW5mbzoge30sCgkgICAgICBsaXN0OiB7fQoJICAgIH0sCgkgICAgcnRtOiB7CgkgICAgICBzdGFydDoge30KCSAgICB9LAoJICAgIHNlYXJjaDogewoJICAgICAgYWxsOiB7fSwKCSAgICAgIGZpbGVzOiB7fSwKCSAgICAgIG1lc3NhZ2VzOiB7fQoJICAgIH0sCgkgICAgc3RhcnM6IHsKCSAgICAgIGFkZDoge30sCgkgICAgICBsaXN0OiB7fSwKCSAgICAgIHJlbW92ZToge30KCSAgICB9LAoJICAgIHRlYW06IHsKCSAgICAgIGFjY2Vzc0xvZ3M6IHt9LAoJICAgICAgYmlsbGFibGVJbmZvOiB7fSwKCSAgICAgIGluZm86IHt9LAoJICAgICAgaW50ZWdyYXRpb25Mb2dzOiB7fSwKCSAgICAgIHByb2ZpbGU6IHsKCSAgICAgICAgZ2V0OiB7fQoJICAgICAgfQoJICAgIH0sCgkgICAgdXNlcmdyb3VwczogewoJICAgICAgY3JlYXRlOiB7fSwKCSAgICAgIGRpc2FibGU6IHt9LAoJICAgICAgZW5hYmxlOiB7fSwKCSAgICAgIGxpc3Q6IHt9LAoJICAgICAgdXBkYXRlOiB7fSwKCSAgICAgIHVzZXJzOiB7CgkgICAgICAgIGxpc3Q6IHt9LAoJICAgICAgICB1cGRhdGU6IHt9CgkgICAgICB9CgkgICAgfSwKCSAgICB1c2VyczogewoJICAgICAgZGVsZXRlUGhvdG86IHt9LAoJICAgICAgZ2V0UHJlc2VuY2U6IHt9LAoJICAgICAgaWRlbnRpdHk6IHt9LAoJICAgICAgaW5mbzoge30sCgkgICAgICBsaXN0OiB7fSwKCSAgICAgIHByb2ZpbGU6IHsKCSAgICAgICAgZ2V0OiB7fSwKCSAgICAgICAgc2V0OiB7fQoJICAgICAgfSwKCSAgICAgIHNldEFjdGl2ZToge30sCgkgICAgICBzZXRQaG90bzoge30sCgkgICAgICBzZXRQcmVzZW5jZToge30KCSAgICB9CgkgIH07CgoJICBhcHBsaWVkLmF1dGgudGVzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg1MykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuYm90cy5pbmZvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5hcmNoaXZlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5jcmVhdGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNTYpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLmhpc3RvcnkgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNTcpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNTgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLmludml0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg1OSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhbm5lbHMuam9pbiA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg2MCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhbm5lbHMua2ljayA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg2MSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhbm5lbHMubGVhdmUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLmxpc3QgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLm1hcmsgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLnJlbmFtZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg2NSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhbm5lbHMucmVwbGllcyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg2NikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhbm5lbHMuc2V0UHVycG9zZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg2NykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhbm5lbHMuc2V0VG9waWMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLnVuYXJjaGl2ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg2OSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhdC5kZWxldGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNzApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYXQubWVNZXNzYWdlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGF0LnBvc3RNZXNzYWdlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDcyKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGF0LnVwZGF0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3MykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZG5kLmVuZERuZCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3NCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZG5kLmVuZFNub296ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3NSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZG5kLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNzYpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmRuZC5zZXRTbm9vemUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNzcpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmRuZC50ZWFtSW5mbyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3OCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZW1vamkubGlzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3OSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZmlsZXMuY29tbWVudHMuYWRkID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5maWxlcy5jb21tZW50cy5kZWxldGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oODEpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmZpbGVzLmNvbW1lbnRzLmVkaXQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oODIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmZpbGVzLmRlbGV0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg4MykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZmlsZXMuaW5mbyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg4NCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZmlsZXMubGlzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg4NSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZmlsZXMucmV2b2tlUHVibGljVVJMID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDg2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5maWxlcy5zaGFyZWRQdWJsaWNVUkwgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oODcpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmZpbGVzLnVwbG9hZCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg4OCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLmFyY2hpdmUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oODkpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5jbG9zZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5MCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLmNyZWF0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5MSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLmNyZWF0ZUNoaWxkID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDkyKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMuaGlzdG9yeSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5MykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oOTQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5pbnZpdGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oOTUpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5raWNrID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMubGVhdmUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oOTcpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDk4KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMubWFyayA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5OSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLm9wZW4gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTAwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMucmVuYW1lID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLnJlcGxpZXMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTAyKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMuc2V0UHVycG9zZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5zZXRUb3BpYyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy51bmFyY2hpdmUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTA1KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5pbS5jbG9zZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDYpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmltLmhpc3RvcnkgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTA3KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5pbS5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwOCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuaW0ubWFyayA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmltLm9wZW4gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTEwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5pbS5yZXBsaWVzID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDExMSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQubXBpbS5jbG9zZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0uaGlzdG9yeSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ubGlzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ubWFyayA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTUpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ub3BlbiA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTYpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ucmVwbGllcyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTcpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnBpbnMuYWRkID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucGlucy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucGlucy5yZW1vdmUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTIwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZWFjdGlvbnMuYWRkID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucmVhY3Rpb25zLmdldCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnJlYWN0aW9ucy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucmVhY3Rpb25zLnJlbW92ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMjQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnJlbWluZGVycy5hZGQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTI1KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZW1pbmRlcnMuY29tcGxldGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTI2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZW1pbmRlcnMuZGVsZXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyNykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucmVtaW5kZXJzLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTI4KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZW1pbmRlcnMubGlzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMjkpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnJ0bS5zdGFydCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMzApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnNlYXJjaC5hbGwgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTMxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zZWFyY2guZmlsZXMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTMyKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zZWFyY2gubWVzc2FnZXMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTMzKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zdGFycy5hZGQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTM0KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zdGFycy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuc3RhcnMucmVtb3ZlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudGVhbS5hY2Nlc3NMb2dzID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudGVhbS5iaWxsYWJsZUluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTM4KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC50ZWFtLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTM5KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC50ZWFtLmludGVncmF0aW9uTG9ncyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNDApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnRlYW0ucHJvZmlsZS5nZXQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTQxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2VyZ3JvdXBzLmNyZWF0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNDIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJncm91cHMuZGlzYWJsZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNDMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJncm91cHMuZW5hYmxlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0NCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcmdyb3Vwcy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0NSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcmdyb3Vwcy51cGRhdGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTQ2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2VyZ3JvdXBzLnVzZXJzLmxpc3QgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTQ3KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2VyZ3JvdXBzLnVzZXJzLnVwZGF0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNDgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLmRlbGV0ZVBob3RvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0OSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcnMuZ2V0UHJlc2VuY2UgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTUwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2Vycy5pZGVudGl0eSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNTEpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTUyKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2Vycy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1MykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcnMucHJvZmlsZS5nZXQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTU0KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2Vycy5wcm9maWxlLnNldCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNTUpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLnNldEFjdGl2ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNTYpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLnNldFBob3RvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1NykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcnMuc2V0UHJlc2VuY2UgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTU4KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCgkgIHJldHVybiBhcHBsaWVkOwoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBhdXRodGVzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gYXV0aHRlc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnYXV0aC50ZXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBib3RzaW5mbzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gYm90c2luZm8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnYm90cy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2FyY2hpdmU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzYXJjaGl2ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5hcmNoaXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2NyZWF0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHNjcmVhdGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMuY3JlYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2hpc3Rvcnk7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzaGlzdG9yeShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5oaXN0b3J5JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2luZm87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzaW5mbyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2ludml0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHNpbnZpdGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMuaW52aXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2pvaW47CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzam9pbihwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5qb2luJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2tpY2s7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxza2ljayhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5raWNrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2xlYXZlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGFubmVsc2xlYXZlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYW5uZWxzLmxlYXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc21hcms7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzbWFyayhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5tYXJrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3JlbmFtZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHNyZW5hbWUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMucmVuYW1lJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3JlcGxpZXM7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzcmVwbGllcyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5yZXBsaWVzJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3NldFB1cnBvc2U7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzc2V0UHVycG9zZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5zZXRQdXJwb3NlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3NldFRvcGljOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGFubmVsc3NldFRvcGljKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYW5uZWxzLnNldFRvcGljJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3VuYXJjaGl2ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHN1bmFyY2hpdmUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMudW5hcmNoaXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0ZGVsZXRlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGF0ZGVsZXRlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYXQuZGVsZXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0bWVNZXNzYWdlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGF0bWVNZXNzYWdlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYXQubWVNZXNzYWdlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0cG9zdE1lc3NhZ2U7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYXRwb3N0TWVzc2FnZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGF0LnBvc3RNZXNzYWdlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0dXBkYXRlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGF0dXBkYXRlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYXQudXBkYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRlbmREbmQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGRuZGVuZERuZChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdkbmQuZW5kRG5kJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRlbmRTbm9vemU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGRuZGVuZFNub296ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdkbmQuZW5kU25vb3plJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRpbmZvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBkbmRpbmZvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2RuZC5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRzZXRTbm9vemU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGRuZHNldFNub296ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdkbmQuc2V0U25vb3plJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmR0ZWFtSW5mbzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZG5kdGVhbUluZm8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZG5kLnRlYW1JbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBlbW9qaWxpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGVtb2ppbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdlbW9qaS5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2NvbW1lbnRzYWRkOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBmaWxlc2NvbW1lbnRzYWRkKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2ZpbGVzLmNvbW1lbnRzLmFkZCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogODEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gZmlsZXNjb21tZW50c2RlbGV0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNjb21tZW50c2RlbGV0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5jb21tZW50cy5kZWxldGUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDgyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGZpbGVzY29tbWVudHNlZGl0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBmaWxlc2NvbW1lbnRzZWRpdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5jb21tZW50cy5lZGl0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2RlbGV0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNkZWxldGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMuZGVsZXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2luZm87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGZpbGVzaW5mbyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGZpbGVzbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc3Jldm9rZVB1YmxpY1VSTDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNyZXZva2VQdWJsaWNVUkwocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMucmV2b2tlUHVibGljVVJMJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc3NoYXJlZFB1YmxpY1VSTDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNzaGFyZWRQdWJsaWNVUkwocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMuc2hhcmVkUHVibGljVVJMJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc3VwbG9hZDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXN1cGxvYWQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMudXBsb2FkJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNhcmNoaXZlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNhcmNoaXZlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5hcmNoaXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNjbG9zZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzY2xvc2UocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLmNsb3NlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNjcmVhdGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGdyb3Vwc2NyZWF0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMuY3JlYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNjcmVhdGVDaGlsZDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzY3JlYXRlQ2hpbGQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLmNyZWF0ZUNoaWxkJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNoaXN0b3J5OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNoaXN0b3J5KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5oaXN0b3J5JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNpbmZvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNpbmZvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNpbnZpdGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGdyb3Vwc2ludml0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMuaW52aXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNraWNrOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNraWNrKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5raWNrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNsZWF2ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzbGVhdmUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLmxlYXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNsaXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNsaXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNtYXJrOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNtYXJrKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5tYXJrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gZ3JvdXBzb3BlbjsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzb3BlbihwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMub3Blbic7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTAxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGdyb3Vwc3JlbmFtZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzcmVuYW1lKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5yZW5hbWUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEwMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNyZXBsaWVzOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNyZXBsaWVzKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5yZXBsaWVzJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gZ3JvdXBzc2V0UHVycG9zZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzc2V0UHVycG9zZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMuc2V0UHVycG9zZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTA0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGdyb3Vwc3NldFRvcGljOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNzZXRUb3BpYyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMuc2V0VG9waWMnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEwNSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHN1bmFyY2hpdmU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGdyb3Vwc3VuYXJjaGl2ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMudW5hcmNoaXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gaW1jbG9zZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gaW1jbG9zZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdpbS5jbG9zZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTA3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGltaGlzdG9yeTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gaW1oaXN0b3J5KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2ltLmhpc3RvcnknOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEwOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBpbWxpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGltbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdpbS5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gaW1tYXJrOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBpbW1hcmsocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnaW0ubWFyayc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTEwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGltb3BlbjsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gaW1vcGVuKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2ltLm9wZW4nOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDExMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBpbXJlcGxpZXM7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGltcmVwbGllcyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdpbS5yZXBsaWVzJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMTIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gbXBpbWNsb3NlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBtcGltY2xvc2UocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnbXBpbS5jbG9zZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTEzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IG1waW1oaXN0b3J5OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBtcGltaGlzdG9yeShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdtcGltLmhpc3RvcnknOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDExNCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBtcGltbGlzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gbXBpbWxpc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnbXBpbS5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMTUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gbXBpbW1hcms7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIG1waW1tYXJrKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ21waW0ubWFyayc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTE2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IG1waW1vcGVuOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBtcGltb3BlbihwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdtcGltLm9wZW4nOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDExNyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBtcGltcmVwbGllczsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gbXBpbXJlcGxpZXMocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnbXBpbS5yZXBsaWVzJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMTggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcGluc2FkZDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcGluc2FkZChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdwaW5zLmFkZCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTE5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHBpbnNsaXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBwaW5zbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdwaW5zLmxpc3QnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyMCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBwaW5zcmVtb3ZlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBwaW5zcmVtb3ZlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3BpbnMucmVtb3ZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMjEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcmVhY3Rpb25zYWRkOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiByZWFjdGlvbnNhZGQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncmVhY3Rpb25zLmFkZCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTIyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHJlYWN0aW9uc2dldDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcmVhY3Rpb25zZ2V0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3JlYWN0aW9ucy5nZXQnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyMyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSByZWFjdGlvbnNsaXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiByZWFjdGlvbnNsaXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3JlYWN0aW9ucy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMjQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcmVhY3Rpb25zcmVtb3ZlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiByZWFjdGlvbnNyZW1vdmUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncmVhY3Rpb25zLnJlbW92ZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTI1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHJlbWluZGVyc2FkZDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcmVtaW5kZXJzYWRkKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3JlbWluZGVycy5hZGQnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyNiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSByZW1pbmRlcnNjb21wbGV0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcmVtaW5kZXJzY29tcGxldGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncmVtaW5kZXJzLmNvbXBsZXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMjcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcmVtaW5kZXJzZGVsZXRlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiByZW1pbmRlcnNkZWxldGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncmVtaW5kZXJzLmRlbGV0ZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTI4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHJlbWluZGVyc2luZm87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHJlbWluZGVyc2luZm8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncmVtaW5kZXJzLmluZm8nOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyOSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSByZW1pbmRlcnNsaXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiByZW1pbmRlcnNsaXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3JlbWluZGVycy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcnRtc3RhcnQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHJ0bXN0YXJ0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3J0bS5zdGFydCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTMxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHNlYXJjaGFsbDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gc2VhcmNoYWxsKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3NlYXJjaC5hbGwnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEzMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBzZWFyY2hmaWxlczsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gc2VhcmNoZmlsZXMocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnc2VhcmNoLmZpbGVzJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gc2VhcmNobWVzc2FnZXM7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHNlYXJjaG1lc3NhZ2VzKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3NlYXJjaC5tZXNzYWdlcyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTM0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHN0YXJzYWRkOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBzdGFyc2FkZChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdzdGFycy5hZGQnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEzNSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBzdGFyc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHN0YXJzbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdzdGFycy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gc3RhcnNyZW1vdmU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHN0YXJzcmVtb3ZlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3N0YXJzLnJlbW92ZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTM3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHRlYW1hY2Nlc3NMb2dzOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB0ZWFtYWNjZXNzTG9ncyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd0ZWFtLmFjY2Vzc0xvZ3MnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEzOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB0ZWFtYmlsbGFibGVJbmZvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB0ZWFtYmlsbGFibGVJbmZvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3RlYW0uYmlsbGFibGVJbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdGVhbWluZm87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHRlYW1pbmZvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3RlYW0uaW5mbyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHRlYW1pbnRlZ3JhdGlvbkxvZ3M7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHRlYW1pbnRlZ3JhdGlvbkxvZ3MocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndGVhbS5pbnRlZ3JhdGlvbkxvZ3MnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE0MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB0ZWFtcHJvZmlsZWdldDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdGVhbXByb2ZpbGVnZXQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndGVhbS5wcm9maWxlLmdldCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJncm91cHNjcmVhdGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJncm91cHNjcmVhdGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcmdyb3Vwcy5jcmVhdGUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE0MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2VyZ3JvdXBzZGlzYWJsZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcmdyb3Vwc2Rpc2FibGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcmdyb3Vwcy5kaXNhYmxlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNDQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcmdyb3Vwc2VuYWJsZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcmdyb3Vwc2VuYWJsZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2VyZ3JvdXBzLmVuYWJsZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQ1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJncm91cHNsaXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2VyZ3JvdXBzbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2VyZ3JvdXBzLmxpc3QnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE0NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2VyZ3JvdXBzdXBkYXRlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2VyZ3JvdXBzdXBkYXRlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJncm91cHMudXBkYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNDcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcmdyb3Vwc3VzZXJzbGlzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcmdyb3Vwc3VzZXJzbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2VyZ3JvdXBzLnVzZXJzLmxpc3QnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE0OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2VyZ3JvdXBzdXNlcnN1cGRhdGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJncm91cHN1c2Vyc3VwZGF0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2VyZ3JvdXBzLnVzZXJzLnVwZGF0ZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQ5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJzZGVsZXRlUGhvdG87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJzZGVsZXRlUGhvdG8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcnMuZGVsZXRlUGhvdG8nOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE1MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2Vyc2dldFByZXNlbmNlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2Vyc2dldFByZXNlbmNlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJzLmdldFByZXNlbmNlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNTEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcnNpZGVudGl0eTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcnNpZGVudGl0eShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2Vycy5pZGVudGl0eSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTUyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJzaW5mbzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcnNpbmZvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJzLmluZm8nOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE1MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2Vyc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJzbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2Vycy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNTQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcnNwcm9maWxlZ2V0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2Vyc3Byb2ZpbGVnZXQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcnMucHJvZmlsZS5nZXQnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE1NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2Vyc3Byb2ZpbGVzZXQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJzcHJvZmlsZXNldChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2Vycy5wcm9maWxlLnNldCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTU2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJzc2V0QWN0aXZlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2Vyc3NldEFjdGl2ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2Vycy5zZXRBY3RpdmUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE1NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2Vyc3NldFBob3RvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2Vyc3NldFBob3RvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJzLnNldFBob3RvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNTggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcnNzZXRQcmVzZW5jZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcnNzZXRQcmVzZW5jZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2Vycy5zZXRQcmVzZW5jZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTU5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2JvdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KTsKCgl2YXIgX2JvdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYm90cyk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGluZm86IF9ib3RzMi5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfY2hhbm5lbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KTsKCgl2YXIgX2NoYW5uZWxzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzKTsKCgl2YXIgX2NoYW5uZWxzMyA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpOwoKCXZhciBfY2hhbm5lbHM0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMzKTsKCgl2YXIgX2NoYW5uZWxzNSA9IF9fd2VicGFja19yZXF1aXJlX18oNTcpOwoKCXZhciBfY2hhbm5lbHM2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHM1KTsKCgl2YXIgX2NoYW5uZWxzNyA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpOwoKCXZhciBfY2hhbm5lbHM4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHM3KTsKCgl2YXIgX2NoYW5uZWxzOSA9IF9fd2VicGFja19yZXF1aXJlX18oNTkpOwoKCXZhciBfY2hhbm5lbHMxMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzOSk7CgoJdmFyIF9jaGFubmVsczExID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MCk7CgoJdmFyIF9jaGFubmVsczEyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMxMSk7CgoJdmFyIF9jaGFubmVsczEzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MSk7CgoJdmFyIF9jaGFubmVsczE0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMxMyk7CgoJdmFyIF9jaGFubmVsczE1ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Mik7CgoJdmFyIF9jaGFubmVsczE2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMxNSk7CgoJdmFyIF9jaGFubmVsczE3ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Myk7CgoJdmFyIF9jaGFubmVsczE4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMxNyk7CgoJdmFyIF9jaGFubmVsczE5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2NCk7CgoJdmFyIF9jaGFubmVsczIwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMxOSk7CgoJdmFyIF9jaGFubmVsczIxID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2NSk7CgoJdmFyIF9jaGFubmVsczIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMyMSk7CgoJdmFyIF9jaGFubmVsczIzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Nyk7CgoJdmFyIF9jaGFubmVsczI0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMyMyk7CgoJdmFyIF9jaGFubmVsczI1ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OCk7CgoJdmFyIF9jaGFubmVsczI2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMyNSk7CgoJdmFyIF9jaGFubmVsczI3ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OSk7CgoJdmFyIF9jaGFubmVsczI4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMyNyk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGFyY2hpdmU6IF9jaGFubmVsczIuZGVmYXVsdCwKCSAgY3JlYXRlOiBfY2hhbm5lbHM0LmRlZmF1bHQsCgkgIGhpc3Rvcnk6IF9jaGFubmVsczYuZGVmYXVsdCwKCSAgaW5mbzogX2NoYW5uZWxzOC5kZWZhdWx0LAoJICBpbnZpdGU6IF9jaGFubmVsczEwLmRlZmF1bHQsCgkgIGpvaW46IF9jaGFubmVsczEyLmRlZmF1bHQsCgkgIGtpY2s6IF9jaGFubmVsczE0LmRlZmF1bHQsCgkgIGxlYXZlOiBfY2hhbm5lbHMxNi5kZWZhdWx0LAoJICBsaXN0OiBfY2hhbm5lbHMxOC5kZWZhdWx0LAoJICBtYXJrOiBfY2hhbm5lbHMyMC5kZWZhdWx0LAoJICByZW5hbWU6IF9jaGFubmVsczIyLmRlZmF1bHQsCgkgIHNldFB1cnBvc2U6IF9jaGFubmVsczI0LmRlZmF1bHQsCgkgIHNldFRvcGljOiBfY2hhbm5lbHMyNi5kZWZhdWx0LAoJICB1bmFyY2hpdmU6IF9jaGFubmVsczI4LmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE2MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9jaGF0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7CgoJdmFyIF9jaGF0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYXQpOwoKCXZhciBfY2hhdDMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcyKTsKCgl2YXIgX2NoYXQ0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhdDMpOwoKCXZhciBfY2hhdDUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDczKTsKCgl2YXIgX2NoYXQ2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhdDUpOwoKCXZhciBfY2hhdDcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCgl2YXIgX2NoYXQ4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhdDcpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBwb3N0TWVzc2FnZTogX2NoYXQ0LmRlZmF1bHQsIGRlbGV0ZTogX2NoYXQyLmRlZmF1bHQsIHVwZGF0ZTogX2NoYXQ2LmRlZmF1bHQsIG1lTWVzc2FnZTogX2NoYXQ4LmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE2MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9kbmQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc2KTsKCgl2YXIgX2RuZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kbmQpOwoKCXZhciBfZG5kMyA9IF9fd2VicGFja19yZXF1aXJlX18oNzQpOwoKCXZhciBfZG5kNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RuZDMpOwoKCXZhciBfZG5kNSA9IF9fd2VicGFja19yZXF1aXJlX18oNzUpOwoKCXZhciBfZG5kNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RuZDUpOwoKCXZhciBfZG5kNyA9IF9fd2VicGFja19yZXF1aXJlX18oNzcpOwoKCXZhciBfZG5kOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RuZDcpOwoKCXZhciBfZG5kOSA9IF9fd2VicGFja19yZXF1aXJlX18oNzgpOwoKCXZhciBfZG5kMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kbmQ5KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgaW5mbzogX2RuZDIuZGVmYXVsdCwgZW5kRG5kOiBfZG5kNC5kZWZhdWx0LCBlbmRTbm9vemU6IF9kbmQ2LmRlZmF1bHQsIHNldFNub296ZTogX2RuZDguZGVmYXVsdCwgdGVhbUluZm86IF9kbmQxMC5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfZmlsZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgzKTsKCgl2YXIgX2ZpbGVzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZpbGVzKTsKCgl2YXIgX2ZpbGVzMyA9IF9fd2VicGFja19yZXF1aXJlX18oODQpOwoKCXZhciBfZmlsZXM0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmlsZXMzKTsKCgl2YXIgX2ZpbGVzNSA9IF9fd2VicGFja19yZXF1aXJlX18oODUpOwoKCXZhciBfZmlsZXM2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmlsZXM1KTsKCgl2YXIgX2ZpbGVzNyA9IF9fd2VicGFja19yZXF1aXJlX18oODgpOwoKCXZhciBfZmlsZXM4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmlsZXM3KTsKCgl2YXIgX2ZpbGVzQ29tbWVudHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKTsKCgl2YXIgX2ZpbGVzQ29tbWVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmlsZXNDb21tZW50cyk7CgoJdmFyIF9maWxlc0NvbW1lbnRzMyA9IF9fd2VicGFja19yZXF1aXJlX18oODEpOwoKCXZhciBfZmlsZXNDb21tZW50czQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlc0NvbW1lbnRzMyk7CgoJdmFyIF9maWxlc0NvbW1lbnRzNSA9IF9fd2VicGFja19yZXF1aXJlX18oODIpOwoKCXZhciBfZmlsZXNDb21tZW50czYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlc0NvbW1lbnRzNSk7CgoJdmFyIF9maWxlczkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg2KTsKCgl2YXIgX2ZpbGVzMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlczkpOwoKCXZhciBfZmlsZXMxMSA9IF9fd2VicGFja19yZXF1aXJlX18oODcpOwoKCXZhciBfZmlsZXMxMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZpbGVzMTEpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBkZWxldGU6IF9maWxlczIuZGVmYXVsdCwKCSAgaW5mbzogX2ZpbGVzNC5kZWZhdWx0LAoJICBsaXN0OiBfZmlsZXM2LmRlZmF1bHQsCgkgIHVwbG9hZDogX2ZpbGVzOC5kZWZhdWx0LAoJICBjb21tZW50czogewoJICAgIGFkZDogX2ZpbGVzQ29tbWVudHMyLmRlZmF1bHQsCgkgICAgZGVsZXRlOiBfZmlsZXNDb21tZW50czQuZGVmYXVsdCwKCSAgICBlZGl0OiBfZmlsZXNDb21tZW50czYuZGVmYXVsdAoJICB9LAoJICByZXZva2VQdWJsaWNVUkw6IF9maWxlczEwLmRlZmF1bHQsCgkgIHNoYXJlZFB1YmxpY1VSTDogX2ZpbGVzMTIuZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTY0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2dyb3VwcyA9IF9fd2VicGFja19yZXF1aXJlX18oODkpOwoKCXZhciBfZ3JvdXBzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dyb3Vwcyk7CgoJdmFyIF9ncm91cHMzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MCk7CgoJdmFyIF9ncm91cHM0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMyk7CgoJdmFyIF9ncm91cHM1ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MSk7CgoJdmFyIF9ncm91cHM2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzNSk7CgoJdmFyIF9ncm91cHM3ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5Mik7CgoJdmFyIF9ncm91cHM4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzNyk7CgoJdmFyIF9ncm91cHM5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5Myk7CgoJdmFyIF9ncm91cHMxMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dyb3VwczkpOwoKCXZhciBfZ3JvdXBzMTEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk0KTsKCgl2YXIgX2dyb3VwczEyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMTEpOwoKCXZhciBfZ3JvdXBzMTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk1KTsKCgl2YXIgX2dyb3VwczE0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMTMpOwoKCXZhciBfZ3JvdXBzMTUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KTsKCgl2YXIgX2dyb3VwczE2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMTUpOwoKCXZhciBfZ3JvdXBzMTcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk3KTsKCgl2YXIgX2dyb3VwczE4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMTcpOwoKCXZhciBfZ3JvdXBzMTkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk4KTsKCgl2YXIgX2dyb3VwczIwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMTkpOwoKCXZhciBfZ3JvdXBzMjEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KTsKCgl2YXIgX2dyb3VwczIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMjEpOwoKCXZhciBfZ3JvdXBzMjMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMCk7CgoJdmFyIF9ncm91cHMyNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dyb3VwczIzKTsKCgl2YXIgX2dyb3VwczI1ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDEpOwoKCXZhciBfZ3JvdXBzMjYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMyNSk7CgoJdmFyIF9ncm91cHMyNyA9IF9fd2VicGFja19yZXF1aXJlX18oMTAzKTsKCgl2YXIgX2dyb3VwczI4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMjcpOwoKCXZhciBfZ3JvdXBzMjkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNCk7CgoJdmFyIF9ncm91cHMzMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dyb3VwczI5KTsKCgl2YXIgX2dyb3VwczMxID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDUpOwoKCXZhciBfZ3JvdXBzMzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMzMSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGFyY2hpdmU6IF9ncm91cHMyLmRlZmF1bHQsCgkgIGNsb3NlOiBfZ3JvdXBzNC5kZWZhdWx0LAoJICBjcmVhdGU6IF9ncm91cHM2LmRlZmF1bHQsCgkgIGNyZWF0ZUNoaWxkOiBfZ3JvdXBzOC5kZWZhdWx0LAoJICBoaXN0b3J5OiBfZ3JvdXBzMTAuZGVmYXVsdCwKCSAgaW5mbzogX2dyb3VwczEyLmRlZmF1bHQsCgkgIGludml0ZTogX2dyb3VwczE0LmRlZmF1bHQsCgkgIGtpY2s6IF9ncm91cHMxNi5kZWZhdWx0LAoJICBsZWF2ZTogX2dyb3VwczE4LmRlZmF1bHQsCgkgIGxpc3Q6IF9ncm91cHMyMC5kZWZhdWx0LAoJICBtYXJrOiBfZ3JvdXBzMjIuZGVmYXVsdCwKCSAgb3BlbjogX2dyb3VwczI0LmRlZmF1bHQsCgkgIHJlbmFtZTogX2dyb3VwczI2LmRlZmF1bHQsCgkgIHNldFB1cnBvc2U6IF9ncm91cHMyOC5kZWZhdWx0LAoJICBzZXRUb3BpYzogX2dyb3VwczMwLmRlZmF1bHQsCgkgIHVuYXJjaGl2ZTogX2dyb3VwczMyLmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE2NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9pbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTA2KTsKCgl2YXIgX2ltMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ltKTsKCgl2YXIgX2ltMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA3KTsKCgl2YXIgX2ltNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ltMyk7CgoJdmFyIF9pbTUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwOCk7CgoJdmFyIF9pbTYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbTUpOwoKCXZhciBfaW03ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpOwoKCXZhciBfaW04ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW03KTsKCgl2YXIgX2ltOSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEwKTsKCgl2YXIgX2ltMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbTkpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBjbG9zZTogX2ltMi5kZWZhdWx0LCBoaXN0b3J5OiBfaW00LmRlZmF1bHQsIGxpc3Q6IF9pbTYuZGVmYXVsdCwgbWFyazogX2ltOC5kZWZhdWx0LCBvcGVuOiBfaW0xMC5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfbXBpbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEyKTsKCgl2YXIgX21waW0yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXBpbSk7CgoJdmFyIF9tcGltMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTEzKTsKCgl2YXIgX21waW00ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXBpbTMpOwoKCXZhciBfbXBpbTUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExNCk7CgoJdmFyIF9tcGltNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21waW01KTsKCgl2YXIgX21waW03ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTUpOwoKCXZhciBfbXBpbTggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tcGltNyk7CgoJdmFyIF9tcGltOSA9IF9fd2VicGFja19yZXF1aXJlX18oMTE2KTsKCgl2YXIgX21waW0xMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21waW05KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgY2xvc2U6IF9tcGltMi5kZWZhdWx0LAoJICBoaXN0b3J5OiBfbXBpbTQuZGVmYXVsdCwKCSAgbGlzdDogX21waW02LmRlZmF1bHQsCgkgIG1hcms6IF9tcGltOC5kZWZhdWx0LAoJICBvcGVuOiBfbXBpbTEwLmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE2NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBvYXV0aGFjY2VzczsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gb2F1dGhhY2Nlc3MocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnb2F1dGguYWNjZXNzJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfcmVhY3Rpb25zID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjEpOwoKCXZhciBfcmVhY3Rpb25zMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0aW9ucyk7CgoJdmFyIF9yZWFjdGlvbnMzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKCXZhciBfcmVhY3Rpb25zNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0aW9uczMpOwoKCXZhciBfcmVhY3Rpb25zNSA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCgl2YXIgX3JlYWN0aW9uczYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdGlvbnM1KTsKCgl2YXIgX3JlYWN0aW9uczcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyNCk7CgoJdmFyIF9yZWFjdGlvbnM4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3Rpb25zNyk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGFkZDogX3JlYWN0aW9uczIuZGVmYXVsdCwgZ2V0OiBfcmVhY3Rpb25zNC5kZWZhdWx0LCBsaXN0OiBfcmVhY3Rpb25zNi5kZWZhdWx0LCByZW1vdmU6IF9yZWFjdGlvbnM4LmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE2OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9yZW1pbmRlcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyNSk7CgoJdmFyIF9yZW1pbmRlcnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVtaW5kZXJzKTsKCgl2YXIgX3JlbWluZGVyczMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyNik7CgoJdmFyIF9yZW1pbmRlcnM0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVtaW5kZXJzMyk7CgoJdmFyIF9yZW1pbmRlcnM1ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjcpOwoKCXZhciBfcmVtaW5kZXJzNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlbWluZGVyczUpOwoKCXZhciBfcmVtaW5kZXJzNyA9IF9fd2VicGFja19yZXF1aXJlX18oMTI4KTsKCgl2YXIgX3JlbWluZGVyczggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW1pbmRlcnM3KTsKCgl2YXIgX3JlbWluZGVyczkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyOSk7CgoJdmFyIF9yZW1pbmRlcnMxMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlbWluZGVyczkpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBhZGQ6IF9yZW1pbmRlcnMyLmRlZmF1bHQsIGNvbXBsZXRlOiBfcmVtaW5kZXJzNC5kZWZhdWx0LCBkZWxldGU6IF9yZW1pbmRlcnM2LmRlZmF1bHQsIGluZm86IF9yZW1pbmRlcnM4LmRlZmF1bHQsIGxpc3Q6IF9yZW1pbmRlcnMxMC5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNzAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfcGlucyA9IF9fd2VicGFja19yZXF1aXJlX18oMTE4KTsKCgl2YXIgX3BpbnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGlucyk7CgoJdmFyIF9waW5zMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTE5KTsKCgl2YXIgX3BpbnM0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGluczMpOwoKCXZhciBfcGluczUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCk7CgoJdmFyIF9waW5zNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BpbnM1KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgYWRkOiBfcGluczIuZGVmYXVsdCwgbGlzdDogX3BpbnM0LmRlZmF1bHQsIHJlbW92ZTogX3BpbnM2LmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE3MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjbGllbnQ7CgoJdmFyIF9ydG0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzMCk7CgoJdmFyIF9ydG0yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcnRtKTsKCgl2YXIgX3J0bTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3Mik7CgoJdmFyIF9ydG00ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcnRtMyk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyBzb2NrZXQgZmFjdG9yeQoJZnVuY3Rpb24gY2xpZW50KCkgewoKCSAgLy8gYnVpbGQgYSBuZXcgYm90IGV2ZXJ5IHRpbWUKCSAgdmFyIGJvdCA9IHsKCSAgICBoYW5kbGVyczogewoJICAgICAgc3RhcnRlZDogW10KCSAgICB9CgkgIH07CgoJICAvLyBhZGQgdW5kb2N1bWVudGVkIHBpbmcgZXZlbnQKCSAgX3J0bTQuZGVmYXVsdC5wdXNoKCdwb25nJyk7CgoJICAvLyBnZW5lcmF0ZSBldmVudCBoYW5kbGVyIHJlZ2lzdHJhdGlvbiBtZXRob2RzCgkgIF9ydG00LmRlZmF1bHQuZm9yRWFjaChmdW5jdGlvbiAoZSkgewoJICAgIGJvdC5oYW5kbGVyc1tlXSA9IFtdOwoJICAgIGJvdFtlXSA9IGZ1bmN0aW9uIChoYW5kbGVyKSB7CgkgICAgICBib3QuaGFuZGxlcnNbZV0ucHVzaChoYW5kbGVyKTsKCSAgICB9OwoJICB9KTsKCgkgIGJvdC5zdGFydGVkID0gZnVuY3Rpb24gKGhhbmRsZXIpIHsKCSAgICBib3QuaGFuZGxlcnNbJ3N0YXJ0ZWQnXS5wdXNoKGhhbmRsZXIpOwoJICB9OwoKCSAgLy8ga2lja3MgdXAgYSB3ZWIgc29ja2V0IGNvbm5lY3Rpb24KCSAgYm90Lmxpc3RlbiA9IGZ1bmN0aW9uIGJvdExpc3RlbihwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgKDAsIF9ydG0yLmRlZmF1bHQpKHBhcmFtcywgZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJICAgICAgaWYgKGVycikgewoJICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKGVycik7ZWxzZSB0aHJvdyBlcnI7CgkgICAgICB9IGVsc2UgewoJICAgICAgICAvLyBncmFiIGEgaGFuZGxlIG9uIHRoZSBzb2NrZXQKCSAgICAgICAgYm90LndzID0gbmV3IFdlYlNvY2tldChkYXRhLnVybCk7CgkgICAgICAgIC8vIGRlbGVnYXRlIGV2ZXJ5dGhpbmcKCSAgICAgICAgYm90LndzLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIG1lc3NhZ2UoZSkgewoJICAgICAgICAgIHZhciBqc29uID0gSlNPTi5wYXJzZShlLmRhdGEpOwoJICAgICAgICAgIC8vIENhbGwgYWxsIHJlZ2lzdGVyZWQgaGFuZGxlcnMgZm9yIHRoaXMgZXZlbnQsIGlmIGFueQoJICAgICAgICAgIGlmIChib3QuaGFuZGxlcnNbanNvbi50eXBlXSkgYm90LmhhbmRsZXJzW2pzb24udHlwZV0uZm9yRWFjaChmdW5jdGlvbiAobSkgewoJICAgICAgICAgICAgcmV0dXJuIG0uY2FsbCh7fSwganNvbik7CgkgICAgICAgICAgfSk7CgkgICAgICAgIH07CgkgICAgICAgIC8vIGNhbGwgc3RhcnRlZCBjYWxsYmFja3MKCSAgICAgICAgYm90LmhhbmRsZXJzWydzdGFydGVkJ10uZm9yRWFjaChmdW5jdGlvbiAobSkgewoJICAgICAgICAgIHJldHVybiBtLmNhbGwoe30sIGRhdGEpOwoJICAgICAgICB9KTsKCSAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjayhudWxsLCBkYXRhKTsKCSAgICAgIH0KCSAgICB9KTsKCSAgfTsKCgkgIC8vIGNsb3NlcyB0aGUgc29ja2V0CgkgIGJvdC5jbG9zZSA9IGZ1bmN0aW9uIGJvdENsb3NlKCkgewoJICAgIGJvdC53cy5jbG9zZSgpOwoJICB9OwoKCSAgLy8vLy8vLy8vLwoJICByZXR1cm4gYm90OwoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNzIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCS8vIGdlbmVyYXRlZCB1c2luZyAuL3NjcmlwdHMvZ2VuZXJhdGUtYWxsCgl2YXIgZXZlbnRzID0gWydhY2NvdW50c19jaGFuZ2VkJywgJ2JvdF9hZGRlZCcsICdib3RfY2hhbmdlZCcsICdjaGFubmVsX2FyY2hpdmUnLCAnY2hhbm5lbF9jcmVhdGVkJywgJ2NoYW5uZWxfZGVsZXRlZCcsICdjaGFubmVsX2hpc3RvcnlfY2hhbmdlZCcsICdjaGFubmVsX2pvaW5lZCcsICdjaGFubmVsX2xlZnQnLCAnY2hhbm5lbF9tYXJrZWQnLCAnY2hhbm5lbF9yZW5hbWUnLCAnY2hhbm5lbF91bmFyY2hpdmUnLCAnY29tbWFuZHNfY2hhbmdlZCcsICdkbmRfdXBkYXRlZCcsICdkbmRfdXBkYXRlZF91c2VyJywgJ2VtYWlsX2RvbWFpbl9jaGFuZ2VkJywgJ2Vtb2ppX2NoYW5nZWQnLCAnZmlsZV9jaGFuZ2UnLCAnZmlsZV9jb21tZW50X2FkZGVkJywgJ2ZpbGVfY29tbWVudF9kZWxldGVkJywgJ2ZpbGVfY29tbWVudF9lZGl0ZWQnLCAnZmlsZV9jcmVhdGVkJywgJ2ZpbGVfZGVsZXRlZCcsICdmaWxlX3B1YmxpYycsICdmaWxlX3NoYXJlZCcsICdmaWxlX3Vuc2hhcmVkJywgJ2dvb2RieWUnLCAnZ3JvdXBfYXJjaGl2ZScsICdncm91cF9jbG9zZScsICdncm91cF9oaXN0b3J5X2NoYW5nZWQnLCAnZ3JvdXBfam9pbmVkJywgJ2dyb3VwX2xlZnQnLCAnZ3JvdXBfbWFya2VkJywgJ2dyb3VwX29wZW4nLCAnZ3JvdXBfcmVuYW1lJywgJ2dyb3VwX3VuYXJjaGl2ZScsICdoZWxsbycsICdpbV9jbG9zZScsICdpbV9jcmVhdGVkJywgJ2ltX2hpc3RvcnlfY2hhbmdlZCcsICdpbV9tYXJrZWQnLCAnaW1fb3BlbicsICdtYW51YWxfcHJlc2VuY2VfY2hhbmdlJywgJ21lc3NhZ2UnLCAnbWVzc2FnZS5jaGFubmVscycsICdtZXNzYWdlLmdyb3VwcycsICdtZXNzYWdlLmltJywgJ21lc3NhZ2UubXBpbScsICdwaW5fYWRkZWQnLCAncGluX3JlbW92ZWQnLCAncG9uZycsICdwcmVmX2NoYW5nZScsICdwcmVzZW5jZV9jaGFuZ2UnLCAncmVhY3Rpb25fYWRkZWQnLCAncmVhY3Rpb25fcmVtb3ZlZCcsICdyZWNvbm5lY3RfdXJsJywgJ3N0YXJfYWRkZWQnLCAnc3Rhcl9yZW1vdmVkJywgJ3N1YnRlYW1fY3JlYXRlZCcsICdzdWJ0ZWFtX3NlbGZfYWRkZWQnLCAnc3VidGVhbV9zZWxmX3JlbW92ZWQnLCAnc3VidGVhbV91cGRhdGVkJywgJ3RlYW1fZG9tYWluX2NoYW5nZScsICd0ZWFtX2pvaW4nLCAndGVhbV9taWdyYXRpb25fc3RhcnRlZCcsICd0ZWFtX3BsYW5fY2hhbmdlJywgJ3RlYW1fcHJlZl9jaGFuZ2UnLCAndGVhbV9wcm9maWxlX2NoYW5nZScsICd0ZWFtX3Byb2ZpbGVfZGVsZXRlJywgJ3RlYW1fcHJvZmlsZV9yZW9yZGVyJywgJ3RlYW1fcmVuYW1lJywgJ3VybF92ZXJpZmljYXRpb24nLCAndXNlcl9jaGFuZ2UnLCAndXNlcl90eXBpbmcnXTsKCglleHBvcnRzLmRlZmF1bHQgPSBldmVudHM7Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE3MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9zZWFyY2ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzMSk7CgoJdmFyIF9zZWFyY2gyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2VhcmNoKTsKCgl2YXIgX3NlYXJjaDMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzMik7CgoJdmFyIF9zZWFyY2g0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2VhcmNoMyk7CgoJdmFyIF9zZWFyY2g1ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzMpOwoKCXZhciBfc2VhcmNoNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NlYXJjaDUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBhbGw6IF9zZWFyY2gyLmRlZmF1bHQsIGZpbGVzOiBfc2VhcmNoNC5kZWZhdWx0LCBtZXNzYWdlczogX3NlYXJjaDYuZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTc0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3N0YXJzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzQpOwoKCXZhciBfc3RhcnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3RhcnMpOwoKCXZhciBfc3RhcnMzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzUpOwoKCXZhciBfc3RhcnM0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3RhcnMzKTsKCgl2YXIgX3N0YXJzNSA9IF9fd2VicGFja19yZXF1aXJlX18oMTM2KTsKCgl2YXIgX3N0YXJzNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0YXJzNSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGFkZDogX3N0YXJzMi5kZWZhdWx0LCBsaXN0OiBfc3RhcnM0LmRlZmF1bHQsIHJlbW92ZTogX3N0YXJzNi5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNzUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfdGVhbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTM3KTsKCgl2YXIgX3RlYW0yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGVhbSk7CgoJdmFyIF90ZWFtMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTM4KTsKCgl2YXIgX3RlYW00ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGVhbTMpOwoKCXZhciBfdGVhbTUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzOSk7CgoJdmFyIF90ZWFtNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RlYW01KTsKCgl2YXIgX3RlYW03ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDApOwoKCXZhciBfdGVhbTggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZWFtNyk7CgoJdmFyIF90ZWFtUHJvZmlsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTQxKTsKCgl2YXIgX3RlYW1Qcm9maWxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RlYW1Qcm9maWxlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgYWNjZXNzTG9nczogX3RlYW0yLmRlZmF1bHQsCgkgIGJpbGxhYmxlSW5mbzogX3RlYW00LmRlZmF1bHQsCgkgIGluZm86IF90ZWFtNi5kZWZhdWx0LAoJICBpbnRlZ3JhdGlvbkxvZ3M6IF90ZWFtOC5kZWZhdWx0LAoJICBwcm9maWxlOiB7CgkgICAgZ2V0OiBfdGVhbVByb2ZpbGUyLmRlZmF1bHQKCSAgfQoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTc2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3VzZXJncm91cHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Mik7CgoJdmFyIF91c2VyZ3JvdXBzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJncm91cHMpOwoKCXZhciBfdXNlcmdyb3VwczMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Myk7CgoJdmFyIF91c2VyZ3JvdXBzNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJncm91cHMzKTsKCgl2YXIgX3VzZXJncm91cHM1ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDQpOwoKCXZhciBfdXNlcmdyb3VwczYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyZ3JvdXBzNSk7CgoJdmFyIF91c2VyZ3JvdXBzNyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQ1KTsKCgl2YXIgX3VzZXJncm91cHM4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcmdyb3VwczcpOwoKCXZhciBfdXNlcmdyb3VwczkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Nik7CgoJdmFyIF91c2VyZ3JvdXBzMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyZ3JvdXBzOSk7CgoJdmFyIF91c2VyZ3JvdXBzVXNlcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Nyk7CgoJdmFyIF91c2VyZ3JvdXBzVXNlcnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcmdyb3Vwc1VzZXJzKTsKCgl2YXIgX3VzZXJncm91cHNVc2VyczMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0OCk7CgoJdmFyIF91c2VyZ3JvdXBzVXNlcnM0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcmdyb3Vwc1VzZXJzMyk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGNyZWF0ZTogX3VzZXJncm91cHMyLmRlZmF1bHQsCgkgIGRpc2FibGU6IF91c2VyZ3JvdXBzNC5kZWZhdWx0LAoJICBlbmFibGU6IF91c2VyZ3JvdXBzNi5kZWZhdWx0LAoJICBsaXN0OiBfdXNlcmdyb3VwczguZGVmYXVsdCwKCSAgdXBkYXRlOiBfdXNlcmdyb3VwczEwLmRlZmF1bHQsCgkgIHVzZXJzOiB7CgkgICAgbGlzdDogX3VzZXJncm91cHNVc2VyczIuZGVmYXVsdCwKCSAgICB1cGRhdGU6IF91c2VyZ3JvdXBzVXNlcnM0LmRlZmF1bHQKCSAgfQoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTc3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3VzZXJzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTApOwoKCXZhciBfdXNlcnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcnMpOwoKCXZhciBfdXNlcnNQcm9maWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTQpOwoKCXZhciBfdXNlcnNQcm9maWxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJzUHJvZmlsZSk7CgoJdmFyIF91c2VyczMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1MSk7CgoJdmFyIF91c2VyczQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyczMpOwoKCXZhciBfdXNlcnM1ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTIpOwoKCXZhciBfdXNlcnM2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcnM1KTsKCgl2YXIgX3VzZXJzNyA9IF9fd2VicGFja19yZXF1aXJlX18oMTUzKTsKCgl2YXIgX3VzZXJzOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJzNyk7CgoJdmFyIF91c2VyczkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1Nik7CgoJdmFyIF91c2VyczEwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcnM5KTsKCgl2YXIgX3VzZXJzMTEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1OCk7CgoJdmFyIF91c2VyczEyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcnMxMSk7CgoJdmFyIF91c2Vyc1Byb2ZpbGUzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTUpOwoKCXZhciBfdXNlcnNQcm9maWxlNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJzUHJvZmlsZTMpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBnZXRQcmVzZW5jZTogX3VzZXJzMi5kZWZhdWx0LAoJICBpZGVudGl0eTogX3VzZXJzNC5kZWZhdWx0LAoJICBpbmZvOiBfdXNlcnM2LmRlZmF1bHQsCgkgIGxpc3Q6IF91c2VyczguZGVmYXVsdCwKCSAgcHJvZmlsZTogewoJICAgIGdldDogX3VzZXJzUHJvZmlsZTIuZGVmYXVsdCwKCSAgICBzZXQ6IF91c2Vyc1Byb2ZpbGU0LmRlZmF1bHQKCSAgfSwKCSAgc2V0QWN0aXZlOiBfdXNlcnMxMC5kZWZhdWx0LAoJICBzZXRQcmVzZW5jZTogX3VzZXJzMTIuZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTc4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIHZlcnNpb246IDAuNS4xCgkvLyBkYXRlOiBUdWUgTWFyIDA3IDIwMTcgMTM6MjE6NTEgR01UKzAwMDAgKFdFVCkKCS8vIGxpY2VuY2U6IAoJLyoqCgkqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoJKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoJKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKCSogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKCSogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCgkqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKCSogQ29weXJpZ2h0IDIwMTYgQXBpemVlCgkqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCgkqCgkqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJKgoJKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJKgoJKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJKiovCgoKCShmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7CgkJaWYodHJ1ZSkKCQkJbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7CgkJZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpCgkJCWRlZmluZSgiU3luY2hlciIsIFtdLCBmYWN0b3J5KTsKCQllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JykKCQkJZXhwb3J0c1siU3luY2hlciJdID0gZmFjdG9yeSgpOwoJCWVsc2UKCQkJcm9vdFsiIl0gPSByb290WyIiXSB8fCB7fSwgcm9vdFsiIl1bIlN5bmNoZXIiXSA9IGZhY3RvcnkoKTsKCX0pKHRoaXMsIGZ1bmN0aW9uKCkgewoJcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXAKCS8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCgkvKioqKioqLyAJdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb24KCS8qKioqKiovIAlmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7CgkvKioqKioqLwoJLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKCS8qKioqKiovIAkJaWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pCgkvKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKCS8qKioqKiovCgkvKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCgkvKioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKCS8qKioqKiovIAkJCWk6IG1vZHVsZUlkLAoJLyoqKioqKi8gCQkJbDogZmFsc2UsCgkvKioqKioqLyAJCQlleHBvcnRzOiB7fQoJLyoqKioqKi8gCQl9OwoJLyoqKioqKi8KCS8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCgkvKioqKioqLyAJCW1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pOwoJLyoqKioqKi8KCS8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAoJLyoqKioqKi8gCQltb2R1bGUubCA9IHRydWU7CgkvKioqKioqLwoJLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQoJLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7CgkvKioqKioqLyAJfQoJLyoqKioqKi8KCS8qKioqKiovCgkvKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXykKCS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZQoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIGlkZW50aXR5IGZ1bmN0aW9uIGZvciBjYWxsaW5nIGhhcm1vbnkgaW1wb3J0cyB3aXRoIHRoZSBjb3JyZWN0IGNvbnRleHQKCS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0cwoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikgewoJLyoqKioqKi8gCQlpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7CgkvKioqKioqLyAJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgewoJLyoqKioqKi8gCQkJCWNvbmZpZ3VyYWJsZTogZmFsc2UsCgkvKioqKioqLyAJCQkJZW51bWVyYWJsZTogdHJ1ZSwKCS8qKioqKiovIAkJCQlnZXQ6IGdldHRlcgoJLyoqKioqKi8gCQkJfSk7CgkvKioqKioqLyAJCX0KCS8qKioqKiovIAl9OwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlcwoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkgewoJLyoqKioqKi8gCQl2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID8KCS8qKioqKiovIAkJCWZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6CgkvKioqKioqLyAJCQlmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9OwoJLyoqKioqKi8gCQlfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7CgkvKioqKioqLyAJCXJldHVybiBnZXR0ZXI7CgkvKioqKioqLyAJfTsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9OwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfXwoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ucCA9ICIiOwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKCS8qKioqKiovIAlyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxNjYpOwoJLyoqKioqKi8gfSkKCS8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgkvKioqKioqLyAoWwoJLyogMCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCXZhciBjb3JlID0gbW9kdWxlLmV4cG9ydHMgPSB7dmVyc2lvbjogJzIuNC4wJ307CglpZih0eXBlb2YgX19lID09ICdudW1iZXInKV9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCgkvKioqLyB9KSwKCS8qIDEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOAoJdmFyIGdsb2JhbCA9IG1vZHVsZS5leHBvcnRzID0gdHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoCgkgID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsKCWlmKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmCgoJLyoqKi8gfSksCgkvKiAyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gVGhhbmsncyBJRTggZm9yIGhpcyBmdW5ueSBkZWZpbmVQcm9wZXJ0eQoJbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKCSAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ2EnLCB7Z2V0OiBmdW5jdGlvbigpeyByZXR1cm4gNzsgfX0pLmEgIT0gNzsKCX0pOwoKCS8qKiovIH0pLAoJLyogMyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBzdG9yZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ3drcycpCgkgICwgdWlkICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpCgkgICwgU3ltYm9sICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuU3ltYm9sCgkgICwgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJzsKCgl2YXIgJGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewoJICByZXR1cm4gc3RvcmVbbmFtZV0gfHwgKHN0b3JlW25hbWVdID0KCSAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IHVpZCkoJ1N5bWJvbC4nICsgbmFtZSkpOwoJfTsKCgkkZXhwb3J0cy5zdG9yZSA9IHN0b3JlOwoKCS8qKiovIH0pLAoJLyogNCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKCSAgLCBJRThfRE9NX0RFRklORSA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpCgkgICwgdG9QcmltaXRpdmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQoJICAsIGRQICAgICAgICAgICAgID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwoKCWV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMikgPyBPYmplY3QuZGVmaW5lUHJvcGVydHkgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKXsKCSAgYW5PYmplY3QoTyk7CgkgIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKCSAgYW5PYmplY3QoQXR0cmlidXRlcyk7CgkgIGlmKElFOF9ET01fREVGSU5FKXRyeSB7CgkgICAgcmV0dXJuIGRQKE8sIFAsIEF0dHJpYnV0ZXMpOwoJICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CgkgIGlmKCdnZXQnIGluIEF0dHJpYnV0ZXMgfHwgJ3NldCcgaW4gQXR0cmlidXRlcyl0aHJvdyBUeXBlRXJyb3IoJ0FjY2Vzc29ycyBub3Qgc3VwcG9ydGVkIScpOwoJICBpZigndmFsdWUnIGluIEF0dHJpYnV0ZXMpT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7CgkgIHJldHVybiBPOwoJfTsKCgkvKioqLyB9KSwKCS8qIDUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIGlmKCFpc09iamVjdChpdCkpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYW4gb2JqZWN0IScpOwoJICByZXR1cm4gaXQ7Cgl9OwoKCS8qKiovIH0pLAoJLyogNiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewoJICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nOwoJfTsKCgkvKioqLyB9KSwKCS8qIDcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgZFAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKCSAgLCBjcmVhdGVEZXNjID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7Cgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMikgPyBmdW5jdGlvbihvYmplY3QsIGtleSwgdmFsdWUpewoJICByZXR1cm4gZFAuZihvYmplY3QsIGtleSwgY3JlYXRlRGVzYygxLCB2YWx1ZSkpOwoJfSA6IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7CgkgIG9iamVjdFtrZXldID0gdmFsdWU7CgkgIHJldHVybiBvYmplY3Q7Cgl9OwoKCS8qKiovIH0pLAoJLyogOCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCglleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CgkgIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CgkgIH0KCX07CgoJLyoqKi8gfSksCgkvKiA5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKCSAgLCBjb3JlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCgkgICwgY3R4ICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKCSAgLCBoaWRlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCgkgICwgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7CgoJdmFyICRleHBvcnQgPSBmdW5jdGlvbih0eXBlLCBuYW1lLCBzb3VyY2UpewoJICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRgoJICAgICwgSVNfR0xPQkFMID0gdHlwZSAmICRleHBvcnQuRwoJICAgICwgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuUwoJICAgICwgSVNfUFJPVE8gID0gdHlwZSAmICRleHBvcnQuUAoJICAgICwgSVNfQklORCAgID0gdHlwZSAmICRleHBvcnQuQgoJICAgICwgSVNfV1JBUCAgID0gdHlwZSAmICRleHBvcnQuVwoJICAgICwgZXhwb3J0cyAgID0gSVNfR0xPQkFMID8gY29yZSA6IGNvcmVbbmFtZV0gfHwgKGNvcmVbbmFtZV0gPSB7fSkKCSAgICAsIGV4cFByb3RvICA9IGV4cG9ydHNbUFJPVE9UWVBFXQoJICAgICwgdGFyZ2V0ICAgID0gSVNfR0xPQkFMID8gZ2xvYmFsIDogSVNfU1RBVElDID8gZ2xvYmFsW25hbWVdIDogKGdsb2JhbFtuYW1lXSB8fCB7fSlbUFJPVE9UWVBFXQoJICAgICwga2V5LCBvd24sIG91dDsKCSAgaWYoSVNfR0xPQkFMKXNvdXJjZSA9IG5hbWU7CgkgIGZvcihrZXkgaW4gc291cmNlKXsKCSAgICAvLyBjb250YWlucyBpbiBuYXRpdmUKCSAgICBvd24gPSAhSVNfRk9SQ0VEICYmIHRhcmdldCAmJiB0YXJnZXRba2V5XSAhPT0gdW5kZWZpbmVkOwoJICAgIGlmKG93biAmJiBrZXkgaW4gZXhwb3J0cyljb250aW51ZTsKCSAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZAoJICAgIG91dCA9IG93biA/IHRhcmdldFtrZXldIDogc291cmNlW2tleV07CgkgICAgLy8gcHJldmVudCBnbG9iYWwgcG9sbHV0aW9uIGZvciBuYW1lc3BhY2VzCgkgICAgZXhwb3J0c1trZXldID0gSVNfR0xPQkFMICYmIHR5cGVvZiB0YXJnZXRba2V5XSAhPSAnZnVuY3Rpb24nID8gc291cmNlW2tleV0KCSAgICAvLyBiaW5kIHRpbWVycyB0byBnbG9iYWwgZm9yIGNhbGwgZnJvbSBleHBvcnQgY29udGV4dAoJICAgIDogSVNfQklORCAmJiBvd24gPyBjdHgob3V0LCBnbG9iYWwpCgkgICAgLy8gd3JhcCBnbG9iYWwgY29uc3RydWN0b3JzIGZvciBwcmV2ZW50IGNoYW5nZSB0aGVtIGluIGxpYnJhcnkKCSAgICA6IElTX1dSQVAgJiYgdGFyZ2V0W2tleV0gPT0gb3V0ID8gKGZ1bmN0aW9uKEMpewoJICAgICAgdmFyIEYgPSBmdW5jdGlvbihhLCBiLCBjKXsKCSAgICAgICAgaWYodGhpcyBpbnN0YW5jZW9mIEMpewoJICAgICAgICAgIHN3aXRjaChhcmd1bWVudHMubGVuZ3RoKXsKCSAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIG5ldyBDOwoJICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gbmV3IEMoYSk7CgkgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBuZXcgQyhhLCBiKTsKCSAgICAgICAgICB9IHJldHVybiBuZXcgQyhhLCBiLCBjKTsKCSAgICAgICAgfSByZXR1cm4gQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICAgICAgfTsKCSAgICAgIEZbUFJPVE9UWVBFXSA9IENbUFJPVE9UWVBFXTsKCSAgICAgIHJldHVybiBGOwoJICAgIC8vIG1ha2Ugc3RhdGljIHZlcnNpb25zIGZvciBwcm90b3R5cGUgbWV0aG9kcwoJICAgIH0pKG91dCkgOiBJU19QUk9UTyAmJiB0eXBlb2Ygb3V0ID09ICdmdW5jdGlvbicgPyBjdHgoRnVuY3Rpb24uY2FsbCwgb3V0KSA6IG91dDsKCSAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUubWV0aG9kcy4lTkFNRSUKCSAgICBpZihJU19QUk9UTyl7CgkgICAgICAoZXhwb3J0cy52aXJ0dWFsIHx8IChleHBvcnRzLnZpcnR1YWwgPSB7fSkpW2tleV0gPSBvdXQ7CgkgICAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUucHJvdG90eXBlLiVOQU1FJQoJICAgICAgaWYodHlwZSAmICRleHBvcnQuUiAmJiBleHBQcm90byAmJiAhZXhwUHJvdG9ba2V5XSloaWRlKGV4cFByb3RvLCBrZXksIG91dCk7CgkgICAgfQoJICB9Cgl9OwoJLy8gdHlwZSBiaXRtYXAKCSRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkCgkkZXhwb3J0LkcgPSAyOyAgIC8vIGdsb2JhbAoJJGV4cG9ydC5TID0gNDsgICAvLyBzdGF0aWMKCSRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG8KCSRleHBvcnQuQiA9IDE2OyAgLy8gYmluZAoJJGV4cG9ydC5XID0gMzI7ICAvLyB3cmFwCgkkZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmUKCSRleHBvcnQuUiA9IDEyODsgLy8gcmVhbCBwcm90byBtZXRob2QgZm9yIGBsaWJyYXJ5YCAKCW1vZHVsZS5leHBvcnRzID0gJGV4cG9ydDsKCgkvKioqLyB9KSwKCS8qIDEwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCXZhciBfZGVmaW5lUHJvcGVydHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTsKCgl2YXIgX2RlZmluZVByb3BlcnR5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlZmluZVByb3BlcnR5KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uICgpIHsKCSAgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewoJICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKCSAgICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKCSAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKCSAgICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwoJICAgICAgKDAsIF9kZWZpbmVQcm9wZXJ0eTIuZGVmYXVsdCkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CgkgICAgfQoJICB9CgoJICByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewoJICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CgkgICAgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CgkgICAgcmV0dXJuIENvbnN0cnVjdG9yOwoJICB9OwoJfSgpOwoKCS8qKiovIH0pLAoJLyogMTEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGV4ZWMpewoJICB0cnkgewoJICAgIHJldHVybiAhIWV4ZWMoKTsKCSAgfSBjYXRjaChlKXsKCSAgICByZXR1cm4gdHJ1ZTsKCSAgfQoJfTsKCgkvKioqLyB9KSwKCS8qIDEyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJdmFyIGhhc093blByb3BlcnR5ID0ge30uaGFzT3duUHJvcGVydHk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBrZXkpewoJICByZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChpdCwga2V5KTsKCX07CgoJLyoqKi8gfSksCgkvKiAxMyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIHRvIGluZGV4ZWQgb2JqZWN0LCB0b09iamVjdCB3aXRoIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgc3RyaW5ncwoJdmFyIElPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU2KQoJICAsIGRlZmluZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewoJICByZXR1cm4gSU9iamVjdChkZWZpbmVkKGl0KSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMTQgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBvcHRpb25hbCAvIHNpbXBsZSBjb250ZXh0IGJpbmRpbmcKCXZhciBhRnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIHRoYXQsIGxlbmd0aCl7CgkgIGFGdW5jdGlvbihmbik7CgkgIGlmKHRoYXQgPT09IHVuZGVmaW5lZClyZXR1cm4gZm47CgkgIHN3aXRjaChsZW5ndGgpewoJICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uKGEpewoJICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSk7CgkgICAgfTsKCSAgICBjYXNlIDI6IHJldHVybiBmdW5jdGlvbihhLCBiKXsKCSAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIpOwoJICAgIH07CgkgICAgY2FzZSAzOiByZXR1cm4gZnVuY3Rpb24oYSwgYiwgYyl7CgkgICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiLCBjKTsKCSAgICB9OwoJICB9CgkgIHJldHVybiBmdW5jdGlvbigvKiAuLi5hcmdzICovKXsKCSAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKCSAgfTsKCX07CgoJLyoqKi8gfSksCgkvKiAxNSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYml0bWFwLCB2YWx1ZSl7CgkgIHJldHVybiB7CgkgICAgZW51bWVyYWJsZSAgOiAhKGJpdG1hcCAmIDEpLAoJICAgIGNvbmZpZ3VyYWJsZTogIShiaXRtYXAgJiAyKSwKCSAgICB3cml0YWJsZSAgICA6ICEoYml0bWFwICYgNCksCgkgICAgdmFsdWUgICAgICAgOiB2YWx1ZQoJICB9OwoJfTsKCgkvKioqLyB9KSwKCS8qIDE2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7fTsKCgkvKioqLyB9KSwKCS8qIDE3ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQoJICAsIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5kb2N1bWVudAoJICAvLyBpbiBvbGQgSUUgdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgaXMgJ29iamVjdCcKCSAgLCBpcyA9IGlzT2JqZWN0KGRvY3VtZW50KSAmJiBpc09iamVjdChkb2N1bWVudC5jcmVhdGVFbGVtZW50KTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewoJICByZXR1cm4gaXMgPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGl0KSA6IHt9OwoJfTsKCgkvKioqLyB9KSwKCS8qIDE4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gMTkuMS4yLjE0IC8gMTUuMi4zLjE0IE9iamVjdC5rZXlzKE8pCgl2YXIgJGtleXMgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ0KQoJICAsIGVudW1CdWdLZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSk7CgoJbW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pewoJICByZXR1cm4gJGtleXMoTywgZW51bUJ1Z0tleXMpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDE5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIGlmKHR5cGVvZiBpdCAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGEgZnVuY3Rpb24hJyk7CgkgIHJldHVybiBpdDsKCX07CgoJLyoqKi8gfSksCgkvKiAyMCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCXZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nOwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewoJICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDIxICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gNy4xLjEgVG9QcmltaXRpdmUoaW5wdXQgWywgUHJlZmVycmVkVHlwZV0pCgl2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwoJLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2UKCS8vIGFuZCB0aGUgc2Vjb25kIGFyZ3VtZW50IC0gZmxhZyAtIHByZWZlcnJlZCB0eXBlIGlzIGEgc3RyaW5nCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBTKXsKCSAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gaXQ7CgkgIHZhciBmbiwgdmFsOwoJICBpZihTICYmIHR5cGVvZiAoZm4gPSBpdC50b1N0cmluZykgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKXJldHVybiB2YWw7CgkgIGlmKHR5cGVvZiAoZm4gPSBpdC52YWx1ZU9mKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKCSAgaWYoIVMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKCSAgdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWUiKTsKCX07CgoJLyoqKi8gfSksCgkvKiAyMiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBkZWYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmYKCSAgLCBoYXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQoJICAsIFRBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMykoJ3RvU3RyaW5nVGFnJyk7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgdGFnLCBzdGF0KXsKCSAgaWYoaXQgJiYgIWhhcyhpdCA9IHN0YXQgPyBpdCA6IGl0LnByb3RvdHlwZSwgVEFHKSlkZWYoaXQsIFRBRywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgdmFsdWU6IHRhZ30pOwoJfTsKCgkvKioqLyB9KSwKCS8qIDIzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJdmFyIGlkID0gMAoJICAsIHB4ID0gTWF0aC5yYW5kb20oKTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsKCSAgcmV0dXJuICdTeW1ib2woJy5jb25jYXQoa2V5ID09PSB1bmRlZmluZWQgPyAnJyA6IGtleSwgJylfJywgKCsraWQgKyBweCkudG9TdHJpbmcoMzYpKTsKCX07CgoJLyoqKi8gfSksCgkvKiAyNCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8vIDcuMi4xIFJlcXVpcmVPYmplY3RDb2VyY2libGUoYXJndW1lbnQpCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgaWYoaXQgPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gICIgKyBpdCk7CgkgIHJldHVybiBpdDsKCX07CgoJLyoqKi8gfSksCgkvKiAyNSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0gIV9fd2VicGFja19yZXF1aXJlX18oMikgJiYgIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoX193ZWJwYWNrX3JlcXVpcmVfXygxNykoJ2RpdicpLCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3OwoJfSk7CgoJLyoqKi8gfSksCgkvKiAyNiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gdHJ1ZTsKCgkvKioqLyB9KSwKCS8qIDI3ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIHNoYXJlZCA9IF9fd2VicGFja19yZXF1aXJlX18oMzApKCdrZXlzJykKCSAgLCB1aWQgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsKCSAgcmV0dXJuIHNoYXJlZFtrZXldIHx8IChzaGFyZWRba2V5XSA9IHVpZChrZXkpKTsKCX07CgoJLyoqKi8gfSksCgkvKiAyOCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8vIDcuMS40IFRvSW50ZWdlcgoJdmFyIGNlaWwgID0gTWF0aC5jZWlsCgkgICwgZmxvb3IgPSBNYXRoLmZsb29yOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiBpc05hTihpdCA9ICtpdCkgPyAwIDogKGl0ID4gMCA/IGZsb29yIDogY2VpbCkoaXQpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDI5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gSUUgOC0gZG9uJ3QgZW51bSBidWcga2V5cwoJbW9kdWxlLmV4cG9ydHMgPSAoCgkgICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnCgkpLnNwbGl0KCcsJyk7CgoJLyoqKi8gfSksCgkvKiAzMCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBnbG9iYWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCgkgICwgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXycKCSAgLCBzdG9yZSAgPSBnbG9iYWxbU0hBUkVEXSB8fCAoZ2xvYmFsW1NIQVJFRF0gPSB7fSk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7CgkgIHJldHVybiBzdG9yZVtrZXldIHx8IChzdG9yZVtrZXldID0ge30pOwoJfTsKCgkvKioqLyB9KSwKCS8qIDMxICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg3OSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCgkvKioqLyB9KSwKCS8qIDMyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KQoJdmFyIGRlZmluZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewoJICByZXR1cm4gT2JqZWN0KGRlZmluZWQoaXQpKTsKCX07CgoJLyoqKi8gfSksCgkvKiAzMyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oMzYpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiAzNCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgl2YXIgX3NldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3NSk7CgoJdmFyIF9zZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZXRQcm90b3R5cGVPZik7CgoJdmFyIF9jcmVhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc0KTsKCgl2YXIgX2NyZWF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGUpOwoKCXZhciBfdHlwZW9mMiA9IF9fd2VicGFja19yZXF1aXJlX18oNTkpOwoKCXZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7CgkgIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAiICsgKHR5cGVvZiBzdXBlckNsYXNzID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogKDAsIF90eXBlb2YzLmRlZmF1bHQpKHN1cGVyQ2xhc3MpKSk7CgkgIH0KCgkgIHN1YkNsYXNzLnByb3RvdHlwZSA9ICgwLCBfY3JlYXRlMi5kZWZhdWx0KShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CgkgICAgY29uc3RydWN0b3I6IHsKCSAgICAgIHZhbHVlOiBzdWJDbGFzcywKCSAgICAgIGVudW1lcmFibGU6IGZhbHNlLAoJICAgICAgd3JpdGFibGU6IHRydWUsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9CgkgIH0pOwoJICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mMi5kZWZhdWx0ID8gKDAsIF9zZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsKCX07CgoJLyoqKi8gfSksCgkvKiAzNSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgl2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCgl2YXIgX3R5cGVvZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90eXBlb2YyKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzZWxmLCBjYWxsKSB7CgkgIGlmICghc2VsZikgewoJICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7CgkgIH0KCgkgIHJldHVybiBjYWxsICYmICgodHlwZW9mIGNhbGwgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoY2FsbCkpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikgPyBjYWxsIDogc2VsZjsKCX07CgoJLyoqKi8gfSksCgkvKiAzNiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oMzgpOwoJdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyl7CgkgIHJldHVybiAkT2JqZWN0LmRlZmluZVByb3BlcnR5KGl0LCBrZXksIGRlc2MpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDM3ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCgl2YXIgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCgkgICwgZFBzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY0KQoJICAsIGVudW1CdWdLZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKCSAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpKCdJRV9QUk9UTycpCgkgICwgRW1wdHkgICAgICAgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9CgkgICwgUFJPVE9UWVBFICAgPSAncHJvdG90eXBlJzsKCgkvLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlCgl2YXIgY3JlYXRlRGljdCA9IGZ1bmN0aW9uKCl7CgkgIC8vIFRocmFzaCwgd2FzdGUgYW5kIHNvZG9teTogSUUgR0MgYnVnCgkgIHZhciBpZnJhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KSgnaWZyYW1lJykKCSAgICAsIGkgICAgICA9IGVudW1CdWdLZXlzLmxlbmd0aAoJICAgICwgbHQgICAgID0gJzwnCgkgICAgLCBndCAgICAgPSAnPicKCSAgICAsIGlmcmFtZURvY3VtZW50OwoJICBpZnJhbWUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKCSAgX193ZWJwYWNrX3JlcXVpcmVfXyg0MikuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKCSAgaWZyYW1lLnNyYyA9ICdqYXZhc2NyaXB0Oic7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2NyaXB0LXVybAoJICAvLyBjcmVhdGVEaWN0ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuT2JqZWN0OwoJICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7CgkgIGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7CgkgIGlmcmFtZURvY3VtZW50Lm9wZW4oKTsKCSAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpOwoJICBpZnJhbWVEb2N1bWVudC5jbG9zZSgpOwoJICBjcmVhdGVEaWN0ID0gaWZyYW1lRG9jdW1lbnQuRjsKCSAgd2hpbGUoaS0tKWRlbGV0ZSBjcmVhdGVEaWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbaV1dOwoJICByZXR1cm4gY3JlYXRlRGljdCgpOwoJfTsKCgltb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpewoJICB2YXIgcmVzdWx0OwoJICBpZihPICE9PSBudWxsKXsKCSAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7CgkgICAgcmVzdWx0ID0gbmV3IEVtcHR5OwoJICAgIEVtcHR5W1BST1RPVFlQRV0gPSBudWxsOwoJICAgIC8vIGFkZCAiX19wcm90b19fIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsCgkgICAgcmVzdWx0W0lFX1BST1RPXSA9IE87CgkgIH0gZWxzZSByZXN1bHQgPSBjcmVhdGVEaWN0KCk7CgkgIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkUHMocmVzdWx0LCBQcm9wZXJ0aWVzKTsKCX07CgoKCS8qKiovIH0pLAoJLyogMzggKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7CgkvLyAxOS4xLjIuNCAvIDE1LjIuMy42IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKQoJJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhX193ZWJwYWNrX3JlcXVpcmVfXygyKSwgJ09iamVjdCcsIHtkZWZpbmVQcm9wZXJ0eTogX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mfSk7CgoJLyoqKi8gfSksCgkvKiAzOSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgl2YXIgTElCUkFSWSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KQoJICAsICRleHBvcnQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KQoJICAsIHJlZGVmaW5lICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NikKCSAgLCBoaWRlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNykKCSAgLCBoYXMgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCgkgICwgSXRlcmF0b3JzICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQoJICAsICRpdGVyQ3JlYXRlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MikKCSAgLCBzZXRUb1N0cmluZ1RhZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjIpCgkgICwgZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQzKQoJICAsIElURVJBVE9SICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnaXRlcmF0b3InKQoJICAsIEJVR0dZICAgICAgICAgID0gIShbXS5rZXlzICYmICduZXh0JyBpbiBbXS5rZXlzKCkpIC8vIFNhZmFyaSBoYXMgYnVnZ3kgaXRlcmF0b3JzIHcvbyBgbmV4dGAKCSAgLCBGRl9JVEVSQVRPUiAgICA9ICdAQGl0ZXJhdG9yJwoJICAsIEtFWVMgICAgICAgICAgID0gJ2tleXMnCgkgICwgVkFMVUVTICAgICAgICAgPSAndmFsdWVzJzsKCgl2YXIgcmV0dXJuVGhpcyA9IGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9OwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKXsKCSAgJGl0ZXJDcmVhdGUoQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpOwoJICB2YXIgZ2V0TWV0aG9kID0gZnVuY3Rpb24oa2luZCl7CgkgICAgaWYoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pcmV0dXJuIHByb3RvW2tpbmRdOwoJICAgIHN3aXRjaChraW5kKXsKCSAgICAgIGNhc2UgS0VZUzogcmV0dXJuIGZ1bmN0aW9uIGtleXMoKXsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTsKCSAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CgkgICAgfSByZXR1cm4gZnVuY3Rpb24gZW50cmllcygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9OwoJICB9OwoJICB2YXIgVEFHICAgICAgICA9IE5BTUUgKyAnIEl0ZXJhdG9yJwoJICAgICwgREVGX1ZBTFVFUyA9IERFRkFVTFQgPT0gVkFMVUVTCgkgICAgLCBWQUxVRVNfQlVHID0gZmFsc2UKCSAgICAsIHByb3RvICAgICAgPSBCYXNlLnByb3RvdHlwZQoJICAgICwgJG5hdGl2ZSAgICA9IHByb3RvW0lURVJBVE9SXSB8fCBwcm90b1tGRl9JVEVSQVRPUl0gfHwgREVGQVVMVCAmJiBwcm90b1tERUZBVUxUXQoJICAgICwgJGRlZmF1bHQgICA9ICRuYXRpdmUgfHwgZ2V0TWV0aG9kKERFRkFVTFQpCgkgICAgLCAkZW50cmllcyAgID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZAoJICAgICwgJGFueU5hdGl2ZSA9IE5BTUUgPT0gJ0FycmF5JyA/IHByb3RvLmVudHJpZXMgfHwgJG5hdGl2ZSA6ICRuYXRpdmUKCSAgICAsIG1ldGhvZHMsIGtleSwgSXRlcmF0b3JQcm90b3R5cGU7CgkgIC8vIEZpeCBuYXRpdmUKCSAgaWYoJGFueU5hdGl2ZSl7CgkgICAgSXRlcmF0b3JQcm90b3R5cGUgPSBnZXRQcm90b3R5cGVPZigkYW55TmF0aXZlLmNhbGwobmV3IEJhc2UpKTsKCSAgICBpZihJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSl7CgkgICAgICAvLyBTZXQgQEB0b1N0cmluZ1RhZyB0byBuYXRpdmUgaXRlcmF0b3JzCgkgICAgICBzZXRUb1N0cmluZ1RhZyhJdGVyYXRvclByb3RvdHlwZSwgVEFHLCB0cnVlKTsKCSAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lcwoJICAgICAgaWYoIUxJQlJBUlkgJiYgIWhhcyhJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IpKWhpZGUoSXRlcmF0b3JQcm90b3R5cGUsIElURVJBVE9SLCByZXR1cm5UaGlzKTsKCSAgICB9CgkgIH0KCSAgLy8gZml4IEFycmF5I3t2YWx1ZXMsIEBAaXRlcmF0b3J9Lm5hbWUgaW4gVjggLyBGRgoJICBpZihERUZfVkFMVUVTICYmICRuYXRpdmUgJiYgJG5hdGl2ZS5uYW1lICE9PSBWQUxVRVMpewoJICAgIFZBTFVFU19CVUcgPSB0cnVlOwoJICAgICRkZWZhdWx0ID0gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiAkbmF0aXZlLmNhbGwodGhpcyk7IH07CgkgIH0KCSAgLy8gRGVmaW5lIGl0ZXJhdG9yCgkgIGlmKCghTElCUkFSWSB8fCBGT1JDRUQpICYmIChCVUdHWSB8fCBWQUxVRVNfQlVHIHx8ICFwcm90b1tJVEVSQVRPUl0pKXsKCSAgICBoaWRlKHByb3RvLCBJVEVSQVRPUiwgJGRlZmF1bHQpOwoJICB9CgkgIC8vIFBsdWcgZm9yIGxpYnJhcnkKCSAgSXRlcmF0b3JzW05BTUVdID0gJGRlZmF1bHQ7CgkgIEl0ZXJhdG9yc1tUQUddICA9IHJldHVyblRoaXM7CgkgIGlmKERFRkFVTFQpewoJICAgIG1ldGhvZHMgPSB7CgkgICAgICB2YWx1ZXM6ICBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSwKCSAgICAgIGtleXM6ICAgIElTX1NFVCAgICAgPyAkZGVmYXVsdCA6IGdldE1ldGhvZChLRVlTKSwKCSAgICAgIGVudHJpZXM6ICRlbnRyaWVzCgkgICAgfTsKCSAgICBpZihGT1JDRUQpZm9yKGtleSBpbiBtZXRob2RzKXsKCSAgICAgIGlmKCEoa2V5IGluIHByb3RvKSlyZWRlZmluZShwcm90bywga2V5LCBtZXRob2RzW2tleV0pOwoJICAgIH0gZWxzZSAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7CgkgIH0KCSAgcmV0dXJuIG1ldGhvZHM7Cgl9OwoKCS8qKiovIH0pLAoJLyogNDAgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDUzKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKCS8qKiovIH0pLAoJLyogNDEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCglleHBvcnRzLmYgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTsKCgkvKioqLyB9KSwKCS8qIDQyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLmRvY3VtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCgkvKioqLyB9KSwKCS8qIDQzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gMTkuMS4yLjkgLyAxNS4yLjMuMiBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTykKCXZhciBoYXMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCgkgICwgdG9PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQoJICAsIElFX1BST1RPICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykoJ0lFX1BST1RPJykKCSAgLCBPYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7CgoJbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24oTyl7CgkgIE8gPSB0b09iamVjdChPKTsKCSAgaWYoaGFzKE8sIElFX1BST1RPKSlyZXR1cm4gT1tJRV9QUk9UT107CgkgIGlmKHR5cGVvZiBPLmNvbnN0cnVjdG9yID09ICdmdW5jdGlvbicgJiYgTyBpbnN0YW5jZW9mIE8uY29uc3RydWN0b3IpewoJICAgIHJldHVybiBPLmNvbnN0cnVjdG9yLnByb3RvdHlwZTsKCSAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvIDogbnVsbDsKCX07CgoJLyoqKi8gfSksCgkvKiA0NCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBoYXMgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQoJICAsIHRvSU9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCgkgICwgYXJyYXlJbmRleE9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MSkoZmFsc2UpCgkgICwgSUVfUFJPVE8gICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykoJ0lFX1BST1RPJyk7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIG5hbWVzKXsKCSAgdmFyIE8gICAgICA9IHRvSU9iamVjdChvYmplY3QpCgkgICAgLCBpICAgICAgPSAwCgkgICAgLCByZXN1bHQgPSBbXQoJICAgICwga2V5OwoJICBmb3Ioa2V5IGluIE8paWYoa2V5ICE9IElFX1BST1RPKWhhcyhPLCBrZXkpICYmIHJlc3VsdC5wdXNoKGtleSk7CgkgIC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXMKCSAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSlpZihoYXMoTywga2V5ID0gbmFtZXNbaSsrXSkpewoJICAgIH5hcnJheUluZGV4T2YocmVzdWx0LCBrZXkpIHx8IHJlc3VsdC5wdXNoKGtleSk7CgkgIH0KCSAgcmV0dXJuIHJlc3VsdDsKCX07CgoJLyoqKi8gfSksCgkvKiA0NSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIG1vc3QgT2JqZWN0IG1ldGhvZHMgYnkgRVM2IHNob3VsZCBhY2NlcHQgcHJpbWl0aXZlcwoJdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpCgkgICwgY29yZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKCSAgLCBmYWlscyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEtFWSwgZXhlYyl7CgkgIHZhciBmbiAgPSAoY29yZS5PYmplY3QgfHwge30pW0tFWV0gfHwgT2JqZWN0W0tFWV0KCSAgICAsIGV4cCA9IHt9OwoJICBleHBbS0VZXSA9IGV4ZWMoZm4pOwoJICAkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIGZhaWxzKGZ1bmN0aW9uKCl7IGZuKDEpOyB9KSwgJ09iamVjdCcsIGV4cCk7Cgl9OwoKCS8qKiovIH0pLAoJLyogNDYgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7CgoJLyoqKi8gfSksCgkvKiA0NyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIDcuMS4xNSBUb0xlbmd0aAoJdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCgkgICwgbWluICAgICAgID0gTWF0aC5taW47Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgcmV0dXJuIGl0ID4gMCA/IG1pbih0b0ludGVnZXIoaXQpLCAweDFmZmZmZmZmZmZmZmZmKSA6IDA7IC8vIHBvdygyLCA1MykgLSAxID09IDkwMDcxOTkyNTQ3NDA5OTEKCX07CgoJLyoqKi8gfSksCgkvKiA0OCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBnbG9iYWwgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKCSAgLCBjb3JlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKCSAgLCBMSUJSQVJZICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpCgkgICwgd2tzRXh0ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KQoJICAsIGRlZmluZVByb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihuYW1lKXsKCSAgdmFyICRTeW1ib2wgPSBjb3JlLlN5bWJvbCB8fCAoY29yZS5TeW1ib2wgPSBMSUJSQVJZID8ge30gOiBnbG9iYWwuU3ltYm9sIHx8IHt9KTsKCSAgaWYobmFtZS5jaGFyQXQoMCkgIT0gJ18nICYmICEobmFtZSBpbiAkU3ltYm9sKSlkZWZpbmVQcm9wZXJ0eSgkU3ltYm9sLCBuYW1lLCB7dmFsdWU6IHdrc0V4dC5mKG5hbWUpfSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogNDkgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglleHBvcnRzLmYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCS8qKiovIH0pLAoJLyogNTAgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoJdmFyICRhdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY2KSh0cnVlKTsKCgkvLyAyMS4xLjMuMjcgU3RyaW5nLnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpCglfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KShTdHJpbmcsICdTdHJpbmcnLCBmdW5jdGlvbihpdGVyYXRlZCl7CgkgIHRoaXMuX3QgPSBTdHJpbmcoaXRlcmF0ZWQpOyAvLyB0YXJnZXQKCSAgdGhpcy5faSA9IDA7ICAgICAgICAgICAgICAgIC8vIG5leHQgaW5kZXgKCS8vIDIxLjEuNS4yLjEgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKCX0sIGZ1bmN0aW9uKCl7CgkgIHZhciBPICAgICA9IHRoaXMuX3QKCSAgICAsIGluZGV4ID0gdGhpcy5faQoJICAgICwgcG9pbnQ7CgkgIGlmKGluZGV4ID49IE8ubGVuZ3RoKXJldHVybiB7dmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZX07CgkgIHBvaW50ID0gJGF0KE8sIGluZGV4KTsKCSAgdGhpcy5faSArPSBwb2ludC5sZW5ndGg7CgkgIHJldHVybiB7dmFsdWU6IHBvaW50LCBkb25lOiBmYWxzZX07Cgl9KTsKCgkvKioqLyB9KSwKCS8qIDUxICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXyg2OSk7Cgl2YXIgZ2xvYmFsICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKCSAgLCBoaWRlICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KQoJICAsIEl0ZXJhdG9ycyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQoJICAsIFRPX1NUUklOR19UQUcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCd0b1N0cmluZ1RhZycpOwoKCWZvcih2YXIgY29sbGVjdGlvbnMgPSBbJ05vZGVMaXN0JywgJ0RPTVRva2VuTGlzdCcsICdNZWRpYUxpc3QnLCAnU3R5bGVTaGVldExpc3QnLCAnQ1NTUnVsZUxpc3QnXSwgaSA9IDA7IGkgPCA1OyBpKyspewoJICB2YXIgTkFNRSAgICAgICA9IGNvbGxlY3Rpb25zW2ldCgkgICAgLCBDb2xsZWN0aW9uID0gZ2xvYmFsW05BTUVdCgkgICAgLCBwcm90byAgICAgID0gQ29sbGVjdGlvbiAmJiBDb2xsZWN0aW9uLnByb3RvdHlwZTsKCSAgaWYocHJvdG8gJiYgIXByb3RvW1RPX1NUUklOR19UQUddKWhpZGUocHJvdG8sIFRPX1NUUklOR19UQUcsIE5BTUUpOwoJICBJdGVyYXRvcnNbTkFNRV0gPSBJdGVyYXRvcnMuQXJyYXk7Cgl9CgoJLyoqKi8gfSksCgkvKiA1MiAqLywKCS8qIDUzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGNvcmUgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQoJICAsICRKU09OID0gY29yZS5KU09OIHx8IChjb3JlLkpTT04gPSB7c3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeX0pOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzdHJpbmdpZnkoaXQpeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzCgkgIHJldHVybiAkSlNPTi5zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3VtZW50cyk7Cgl9OwoKCS8qKiovIH0pLAoJLyogNTQgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgoKCS8qKiovIH0pLAoJLyogNTUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBnZXR0aW5nIHRhZyBmcm9tIDE5LjEuMy42IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcoKQoJdmFyIGNvZiA9IF9fd2VicGFja19yZXF1aXJlX18oMjApCgkgICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgndG9TdHJpbmdUYWcnKQoJICAvLyBFUzMgd3JvbmcgaGVyZQoJICAsIEFSRyA9IGNvZihmdW5jdGlvbigpeyByZXR1cm4gYXJndW1lbnRzOyB9KCkpID09ICdBcmd1bWVudHMnOwoKCS8vIGZhbGxiYWNrIGZvciBJRTExIFNjcmlwdCBBY2Nlc3MgRGVuaWVkIGVycm9yCgl2YXIgdHJ5R2V0ID0gZnVuY3Rpb24oaXQsIGtleSl7CgkgIHRyeSB7CgkgICAgcmV0dXJuIGl0W2tleV07CgkgIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCX07CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHZhciBPLCBULCBCOwoJICByZXR1cm4gaXQgPT09IHVuZGVmaW5lZCA/ICdVbmRlZmluZWQnIDogaXQgPT09IG51bGwgPyAnTnVsbCcKCSAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2UKCSAgICA6IHR5cGVvZiAoVCA9IHRyeUdldChPID0gT2JqZWN0KGl0KSwgVEFHKSkgPT0gJ3N0cmluZycgPyBUCgkgICAgLy8gYnVpbHRpblRhZyBjYXNlCgkgICAgOiBBUkcgPyBjb2YoTykKCSAgICAvLyBFUzMgYXJndW1lbnRzIGZhbGxiYWNrCgkgICAgOiAoQiA9IGNvZihPKSkgPT0gJ09iamVjdCcgJiYgdHlwZW9mIE8uY2FsbGVlID09ICdmdW5jdGlvbicgPyAnQXJndW1lbnRzJyA6IEI7Cgl9OwoKCS8qKiovIH0pLAoJLyogNTYgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBmYWxsYmFjayBmb3Igbm9uLWFycmF5LWxpa2UgRVMzIGFuZCBub24tZW51bWVyYWJsZSBvbGQgVjggc3RyaW5ncwoJdmFyIGNvZiA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwoJbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uKGl0KXsKCSAgcmV0dXJuIGNvZihpdCkgPT0gJ1N0cmluZycgPyBpdC5zcGxpdCgnJykgOiBPYmplY3QoaXQpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDU3ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIHBJRSAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkKCSAgLCBjcmVhdGVEZXNjICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCgkgICwgdG9JT2JqZWN0ICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQoJICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKCSAgLCBoYXMgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCgkgICwgSUU4X0RPTV9ERUZJTkUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQoJICAsIGdPUEQgICAgICAgICAgID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKCglleHBvcnRzLmYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpID8gZ09QRCA6IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKXsKCSAgTyA9IHRvSU9iamVjdChPKTsKCSAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwoJICBpZihJRThfRE9NX0RFRklORSl0cnkgewoJICAgIHJldHVybiBnT1BEKE8sIFApOwoJICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CgkgIGlmKGhhcyhPLCBQKSlyZXR1cm4gY3JlYXRlRGVzYyghcElFLmYuY2FsbChPLCBQKSwgT1tQXSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogNTggKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCglleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKCS8qKiovIH0pLAoJLyogNTkgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJdmFyIF9pdGVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oNzcpOwoKCXZhciBfaXRlcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaXRlcmF0b3IpOwoKCXZhciBfc3ltYm9sID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3Nik7CgoJdmFyIF9zeW1ib2wyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3ltYm9sKTsKCgl2YXIgX3R5cGVvZiA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBfaXRlcmF0b3IyLmRlZmF1bHQgPT09ICJzeW1ib2wiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IF9zeW1ib2wyLmRlZmF1bHQgJiYgb2JqICE9PSBfc3ltYm9sMi5kZWZhdWx0LnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YoX2l0ZXJhdG9yMi5kZWZhdWx0KSA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7CgkgIHJldHVybiB0eXBlb2Ygb2JqID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihvYmopOwoJfSA6IGZ1bmN0aW9uIChvYmopIHsKCSAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IF9zeW1ib2wyLmRlZmF1bHQgJiYgb2JqICE9PSBfc3ltYm9sMi5kZWZhdWx0LnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iaiA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yob2JqKTsKCX07CgoJLyoqKi8gfSksCgkvKiA2MCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfTsKCgkvKioqLyB9KSwKCS8qIDYxICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gZmFsc2UgLT4gQXJyYXkjaW5kZXhPZgoJLy8gdHJ1ZSAgLT4gQXJyYXkjaW5jbHVkZXMKCXZhciB0b0lPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQoJICAsIHRvTGVuZ3RoICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCgkgICwgdG9JbmRleCAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OCk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKElTX0lOQ0xVREVTKXsKCSAgcmV0dXJuIGZ1bmN0aW9uKCR0aGlzLCBlbCwgZnJvbUluZGV4KXsKCSAgICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KCR0aGlzKQoJICAgICAgLCBsZW5ndGggPSB0b0xlbmd0aChPLmxlbmd0aCkKCSAgICAgICwgaW5kZXggID0gdG9JbmRleChmcm9tSW5kZXgsIGxlbmd0aCkKCSAgICAgICwgdmFsdWU7CgkgICAgLy8gQXJyYXkjaW5jbHVkZXMgdXNlcyBTYW1lVmFsdWVaZXJvIGVxdWFsaXR5IGFsZ29yaXRobQoJICAgIGlmKElTX0lOQ0xVREVTICYmIGVsICE9IGVsKXdoaWxlKGxlbmd0aCA+IGluZGV4KXsKCSAgICAgIHZhbHVlID0gT1tpbmRleCsrXTsKCSAgICAgIGlmKHZhbHVlICE9IHZhbHVlKXJldHVybiB0cnVlOwoJICAgIC8vIEFycmF5I3RvSW5kZXggaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3QKCSAgICB9IGVsc2UgZm9yKDtsZW5ndGggPiBpbmRleDsgaW5kZXgrKylpZihJU19JTkNMVURFUyB8fCBpbmRleCBpbiBPKXsKCSAgICAgIGlmKE9baW5kZXhdID09PSBlbClyZXR1cm4gSVNfSU5DTFVERVMgfHwgaW5kZXggfHwgMDsKCSAgICB9IHJldHVybiAhSVNfSU5DTFVERVMgJiYgLTE7CgkgIH07Cgl9OwoKCS8qKiovIH0pLAoJLyogNjIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoJdmFyIGNyZWF0ZSAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNykKCSAgLCBkZXNjcmlwdG9yICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCgkgICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKQoJICAsIEl0ZXJhdG9yUHJvdG90eXBlID0ge307CgoJLy8gMjUuMS4yLjEuMSAlSXRlcmF0b3JQcm90b3R5cGUlW0BAaXRlcmF0b3JdKCkKCV9fd2VicGFja19yZXF1aXJlX18oNykoSXRlcmF0b3JQcm90b3R5cGUsIF9fd2VicGFja19yZXF1aXJlX18oMykoJ2l0ZXJhdG9yJyksIGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9KTsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKENvbnN0cnVjdG9yLCBOQU1FLCBuZXh0KXsKCSAgQ29uc3RydWN0b3IucHJvdG90eXBlID0gY3JlYXRlKEl0ZXJhdG9yUHJvdG90eXBlLCB7bmV4dDogZGVzY3JpcHRvcigxLCBuZXh0KX0pOwoJICBzZXRUb1N0cmluZ1RhZyhDb25zdHJ1Y3RvciwgTkFNRSArICcgSXRlcmF0b3InKTsKCX07CgoJLyoqKi8gfSksCgkvKiA2MyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZG9uZSwgdmFsdWUpewoJICByZXR1cm4ge3ZhbHVlOiB2YWx1ZSwgZG9uZTogISFkb25lfTsKCX07CgoJLyoqKi8gfSksCgkvKiA2NCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBkUCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKCSAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKCSAgLCBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpOwoKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzIDogZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKXsKCSAgYW5PYmplY3QoTyk7CgkgIHZhciBrZXlzICAgPSBnZXRLZXlzKFByb3BlcnRpZXMpCgkgICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAoJICAgICwgaSA9IDAKCSAgICAsIFA7CgkgIHdoaWxlKGxlbmd0aCA+IGkpZFAuZihPLCBQID0ga2V5c1tpKytdLCBQcm9wZXJ0aWVzW1BdKTsKCSAgcmV0dXJuIE87Cgl9OwoKCS8qKiovIH0pLAoJLyogNjUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjIuNyAvIDE1LjIuMy40IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKE8pCgl2YXIgJGtleXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCgkgICwgaGlkZGVuS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpLmNvbmNhdCgnbGVuZ3RoJywgJ3Byb3RvdHlwZScpOwoKCWV4cG9ydHMuZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHx8IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoTyl7CgkgIHJldHVybiAka2V5cyhPLCBoaWRkZW5LZXlzKTsKCX07CgoJLyoqKi8gfSksCgkvKiA2NiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KQoJICAsIGRlZmluZWQgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwoJLy8gdHJ1ZSAgLT4gU3RyaW5nI2F0CgkvLyBmYWxzZSAtPiBTdHJpbmcjY29kZVBvaW50QXQKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oVE9fU1RSSU5HKXsKCSAgcmV0dXJuIGZ1bmN0aW9uKHRoYXQsIHBvcyl7CgkgICAgdmFyIHMgPSBTdHJpbmcoZGVmaW5lZCh0aGF0KSkKCSAgICAgICwgaSA9IHRvSW50ZWdlcihwb3MpCgkgICAgICAsIGwgPSBzLmxlbmd0aAoJICAgICAgLCBhLCBiOwoJICAgIGlmKGkgPCAwIHx8IGkgPj0gbClyZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7CgkgICAgYSA9IHMuY2hhckNvZGVBdChpKTsKCSAgICByZXR1cm4gYSA8IDB4ZDgwMCB8fCBhID4gMHhkYmZmIHx8IGkgKyAxID09PSBsIHx8IChiID0gcy5jaGFyQ29kZUF0KGkgKyAxKSkgPCAweGRjMDAgfHwgYiA+IDB4ZGZmZgoJICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGEKCSAgICAgIDogVE9fU1RSSU5HID8gcy5zbGljZShpLCBpICsgMikgOiAoYSAtIDB4ZDgwMCA8PCAxMCkgKyAoYiAtIDB4ZGMwMCkgKyAweDEwMDAwOwoJICB9OwoJfTsKCgkvKioqLyB9KSwKCS8qIDY3ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGN0eCAgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCgkgICwgaW52b2tlICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4OCkKCSAgLCBodG1sICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKQoJICAsIGNlbCAgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpCgkgICwgZ2xvYmFsICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQoJICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCgkgICwgc2V0VGFzayAgICAgICAgICAgID0gZ2xvYmFsLnNldEltbWVkaWF0ZQoJICAsIGNsZWFyVGFzayAgICAgICAgICA9IGdsb2JhbC5jbGVhckltbWVkaWF0ZQoJICAsIE1lc3NhZ2VDaGFubmVsICAgICA9IGdsb2JhbC5NZXNzYWdlQ2hhbm5lbAoJICAsIGNvdW50ZXIgICAgICAgICAgICA9IDAKCSAgLCBxdWV1ZSAgICAgICAgICAgICAgPSB7fQoJICAsIE9OUkVBRFlTVEFURUNIQU5HRSA9ICdvbnJlYWR5c3RhdGVjaGFuZ2UnCgkgICwgZGVmZXIsIGNoYW5uZWwsIHBvcnQ7Cgl2YXIgcnVuID0gZnVuY3Rpb24oKXsKCSAgdmFyIGlkID0gK3RoaXM7CgkgIGlmKHF1ZXVlLmhhc093blByb3BlcnR5KGlkKSl7CgkgICAgdmFyIGZuID0gcXVldWVbaWRdOwoJICAgIGRlbGV0ZSBxdWV1ZVtpZF07CgkgICAgZm4oKTsKCSAgfQoJfTsKCXZhciBsaXN0ZW5lciA9IGZ1bmN0aW9uKGV2ZW50KXsKCSAgcnVuLmNhbGwoZXZlbnQuZGF0YSk7Cgl9OwoJLy8gTm9kZS5qcyAwLjkrICYgSUUxMCsgaGFzIHNldEltbWVkaWF0ZSwgb3RoZXJ3aXNlOgoJaWYoIXNldFRhc2sgfHwgIWNsZWFyVGFzayl7CgkgIHNldFRhc2sgPSBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoZm4pewoJICAgIHZhciBhcmdzID0gW10sIGkgPSAxOwoJICAgIHdoaWxlKGFyZ3VtZW50cy5sZW5ndGggPiBpKWFyZ3MucHVzaChhcmd1bWVudHNbaSsrXSk7CgkgICAgcXVldWVbKytjb3VudGVyXSA9IGZ1bmN0aW9uKCl7CgkgICAgICBpbnZva2UodHlwZW9mIGZuID09ICdmdW5jdGlvbicgPyBmbiA6IEZ1bmN0aW9uKGZuKSwgYXJncyk7CgkgICAgfTsKCSAgICBkZWZlcihjb3VudGVyKTsKCSAgICByZXR1cm4gY291bnRlcjsKCSAgfTsKCSAgY2xlYXJUYXNrID0gZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaWQpewoJICAgIGRlbGV0ZSBxdWV1ZVtpZF07CgkgIH07CgkgIC8vIE5vZGUuanMgMC44LQoJICBpZihfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKShwcm9jZXNzKSA9PSAncHJvY2VzcycpewoJICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewoJICAgICAgcHJvY2Vzcy5uZXh0VGljayhjdHgocnVuLCBpZCwgMSkpOwoJICAgIH07CgkgIC8vIEJyb3dzZXJzIHdpdGggTWVzc2FnZUNoYW5uZWwsIGluY2x1ZGVzIFdlYldvcmtlcnMKCSAgfSBlbHNlIGlmKE1lc3NhZ2VDaGFubmVsKXsKCSAgICBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsOwoJICAgIHBvcnQgICAgPSBjaGFubmVsLnBvcnQyOwoJICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gbGlzdGVuZXI7CgkgICAgZGVmZXIgPSBjdHgocG9ydC5wb3N0TWVzc2FnZSwgcG9ydCwgMSk7CgkgIC8vIEJyb3dzZXJzIHdpdGggcG9zdE1lc3NhZ2UsIHNraXAgV2ViV29ya2VycwoJICAvLyBJRTggaGFzIHBvc3RNZXNzYWdlLCBidXQgaXQncyBzeW5jICYgdHlwZW9mIGl0cyBwb3N0TWVzc2FnZSBpcyAnb2JqZWN0JwoJICB9IGVsc2UgaWYoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIgJiYgdHlwZW9mIHBvc3RNZXNzYWdlID09ICdmdW5jdGlvbicgJiYgIWdsb2JhbC5pbXBvcnRTY3JpcHRzKXsKCSAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKCSAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShpZCArICcnLCAnKicpOwoJICAgIH07CgkgICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBsaXN0ZW5lciwgZmFsc2UpOwoJICAvLyBJRTgtCgkgIH0gZWxzZSBpZihPTlJFQURZU1RBVEVDSEFOR0UgaW4gY2VsKCdzY3JpcHQnKSl7CgkgICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CgkgICAgICBodG1sLmFwcGVuZENoaWxkKGNlbCgnc2NyaXB0JykpW09OUkVBRFlTVEFURUNIQU5HRV0gPSBmdW5jdGlvbigpewoJICAgICAgICBodG1sLnJlbW92ZUNoaWxkKHRoaXMpOwoJICAgICAgICBydW4uY2FsbChpZCk7CgkgICAgICB9OwoJICAgIH07CgkgIC8vIFJlc3Qgb2xkIGJyb3dzZXJzCgkgIH0gZWxzZSB7CgkgICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CgkgICAgICBzZXRUaW1lb3V0KGN0eChydW4sIGlkLCAxKSwgMCk7CgkgICAgfTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSB7CgkgIHNldDogICBzZXRUYXNrLAoJICBjbGVhcjogY2xlYXJUYXNrCgl9OwoKCS8qKiovIH0pLAoJLyogNjggKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkKCSAgLCBtYXggICAgICAgPSBNYXRoLm1heAoJICAsIG1pbiAgICAgICA9IE1hdGgubWluOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpbmRleCwgbGVuZ3RoKXsKCSAgaW5kZXggPSB0b0ludGVnZXIoaW5kZXgpOwoJICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbihpbmRleCwgbGVuZ3RoKTsKCX07CgoJLyoqKi8gfSksCgkvKiA2OSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgl2YXIgYWRkVG9VbnNjb3BhYmxlcyA9IF9fd2VicGFja19yZXF1aXJlX18oNjApCgkgICwgc3RlcCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjMpCgkgICwgSXRlcmF0b3JzICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCgkgICwgdG9JT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwoKCS8vIDIyLjEuMy40IEFycmF5LnByb3RvdHlwZS5lbnRyaWVzKCkKCS8vIDIyLjEuMy4xMyBBcnJheS5wcm90b3R5cGUua2V5cygpCgkvLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpCgkvLyAyMi4xLjMuMzAgQXJyYXkucHJvdG90eXBlW0BAaXRlcmF0b3JdKCkKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygzOSkoQXJyYXksICdBcnJheScsIGZ1bmN0aW9uKGl0ZXJhdGVkLCBraW5kKXsKCSAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldAoJICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleAoJICB0aGlzLl9rID0ga2luZDsgICAgICAgICAgICAgICAgLy8ga2luZAoJLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpCgl9LCBmdW5jdGlvbigpewoJICB2YXIgTyAgICAgPSB0aGlzLl90CgkgICAgLCBraW5kICA9IHRoaXMuX2sKCSAgICAsIGluZGV4ID0gdGhpcy5faSsrOwoJICBpZighTyB8fCBpbmRleCA+PSBPLmxlbmd0aCl7CgkgICAgdGhpcy5fdCA9IHVuZGVmaW5lZDsKCSAgICByZXR1cm4gc3RlcCgxKTsKCSAgfQoJICBpZihraW5kID09ICdrZXlzJyAgKXJldHVybiBzdGVwKDAsIGluZGV4KTsKCSAgaWYoa2luZCA9PSAndmFsdWVzJylyZXR1cm4gc3RlcCgwLCBPW2luZGV4XSk7CgkgIHJldHVybiBzdGVwKDAsIFtpbmRleCwgT1tpbmRleF1dKTsKCX0sICd2YWx1ZXMnKTsKCgkvLyBhcmd1bWVudHNMaXN0W0BAaXRlcmF0b3JdIGlzICVBcnJheVByb3RvX3ZhbHVlcyUgKDkuNC40LjYsIDkuNC40LjcpCglJdGVyYXRvcnMuQXJndW1lbnRzID0gSXRlcmF0b3JzLkFycmF5OwoKCWFkZFRvVW5zY29wYWJsZXMoJ2tleXMnKTsKCWFkZFRvVW5zY29wYWJsZXMoJ3ZhbHVlcycpOwoJYWRkVG9VbnNjb3BhYmxlcygnZW50cmllcycpOwoKCS8qKiovIH0pLAoJLyogNzAgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKCS8qKiovIH0pLAoJLyogNzEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgyKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKCS8qKiovIH0pLAoJLyogNzIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgTUVUQSAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKSgnbWV0YScpCgkgICwgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCgkgICwgaGFzICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQoJICAsIHNldERlc2MgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mCgkgICwgaWQgICAgICAgPSAwOwoJdmFyIGlzRXh0ZW5zaWJsZSA9IE9iamVjdC5pc0V4dGVuc2libGUgfHwgZnVuY3Rpb24oKXsKCSAgcmV0dXJuIHRydWU7Cgl9OwoJdmFyIEZSRUVaRSA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewoJICByZXR1cm4gaXNFeHRlbnNpYmxlKE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpOwoJfSk7Cgl2YXIgc2V0TWV0YSA9IGZ1bmN0aW9uKGl0KXsKCSAgc2V0RGVzYyhpdCwgTUVUQSwge3ZhbHVlOiB7CgkgICAgaTogJ08nICsgKytpZCwgLy8gb2JqZWN0IElECgkgICAgdzoge30gICAgICAgICAgLy8gd2VhayBjb2xsZWN0aW9ucyBJRHMKCSAgfX0pOwoJfTsKCXZhciBmYXN0S2V5ID0gZnVuY3Rpb24oaXQsIGNyZWF0ZSl7CgkgIC8vIHJldHVybiBwcmltaXRpdmUgd2l0aCBwcmVmaXgKCSAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnID8gaXQgOiAodHlwZW9mIGl0ID09ICdzdHJpbmcnID8gJ1MnIDogJ1AnKSArIGl0OwoJICBpZighaGFzKGl0LCBNRVRBKSl7CgkgICAgLy8gY2FuJ3Qgc2V0IG1ldGFkYXRhIHRvIHVuY2F1Z2h0IGZyb3plbiBvYmplY3QKCSAgICBpZighaXNFeHRlbnNpYmxlKGl0KSlyZXR1cm4gJ0YnOwoJICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhCgkgICAgaWYoIWNyZWF0ZSlyZXR1cm4gJ0UnOwoJICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhCgkgICAgc2V0TWV0YShpdCk7CgkgIC8vIHJldHVybiBvYmplY3QgSUQKCSAgfSByZXR1cm4gaXRbTUVUQV0uaTsKCX07Cgl2YXIgZ2V0V2VhayA9IGZ1bmN0aW9uKGl0LCBjcmVhdGUpewoJICBpZighaGFzKGl0LCBNRVRBKSl7CgkgICAgLy8gY2FuJ3Qgc2V0IG1ldGFkYXRhIHRvIHVuY2F1Z2h0IGZyb3plbiBvYmplY3QKCSAgICBpZighaXNFeHRlbnNpYmxlKGl0KSlyZXR1cm4gdHJ1ZTsKCSAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YQoJICAgIGlmKCFjcmVhdGUpcmV0dXJuIGZhbHNlOwoJICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhCgkgICAgc2V0TWV0YShpdCk7CgkgIC8vIHJldHVybiBoYXNoIHdlYWsgY29sbGVjdGlvbnMgSURzCgkgIH0gcmV0dXJuIGl0W01FVEFdLnc7Cgl9OwoJLy8gYWRkIG1ldGFkYXRhIG9uIGZyZWV6ZS1mYW1pbHkgbWV0aG9kcyBjYWxsaW5nCgl2YXIgb25GcmVlemUgPSBmdW5jdGlvbihpdCl7CgkgIGlmKEZSRUVaRSAmJiBtZXRhLk5FRUQgJiYgaXNFeHRlbnNpYmxlKGl0KSAmJiAhaGFzKGl0LCBNRVRBKSlzZXRNZXRhKGl0KTsKCSAgcmV0dXJuIGl0OwoJfTsKCXZhciBtZXRhID0gbW9kdWxlLmV4cG9ydHMgPSB7CgkgIEtFWTogICAgICBNRVRBLAoJICBORUVEOiAgICAgZmFsc2UsCgkgIGZhc3RLZXk6ICBmYXN0S2V5LAoJICBnZXRXZWFrOiAgZ2V0V2VhaywKCSAgb25GcmVlemU6IG9uRnJlZXplCgl9OwoKCS8qKiovIH0pLAoJLyogNzMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgY2xhc3NvZiAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NSkKCSAgLCBJVEVSQVRPUiAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdpdGVyYXRvcicpCgkgICwgSXRlcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNik7Cgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuZ2V0SXRlcmF0b3JNZXRob2QgPSBmdW5jdGlvbihpdCl7CgkgIGlmKGl0ICE9IHVuZGVmaW5lZClyZXR1cm4gaXRbSVRFUkFUT1JdCgkgICAgfHwgaXRbJ0BAaXRlcmF0b3InXQoJICAgIHx8IEl0ZXJhdG9yc1tjbGFzc29mKGl0KV07Cgl9OwoKCS8qKiovIH0pLAoJLyogNzQgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDc4KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKCS8qKiovIH0pLAoJLyogNzUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgxKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKCS8qKiovIH0pLAoJLyogNzYgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgzKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKCS8qKiovIH0pLAoJLyogNzcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDg0KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKCS8qKiovIH0pLAoJLyogNzggKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMCk7Cgl2YXIgJE9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0OwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGUoUCwgRCl7CgkgIHJldHVybiAkT2JqZWN0LmNyZWF0ZShQLCBEKTsKCX07CgoJLyoqKi8gfSksCgkvKiA3OSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oMTAxKTsKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3QuZ2V0UHJvdG90eXBlT2Y7CgoJLyoqKi8gfSksCgkvKiA4MCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oMTAyKTsKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Qua2V5czsKCgkvKioqLyB9KSwKCS8qIDgxICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygxMDMpOwoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5zZXRQcm90b3R5cGVPZjsKCgkvKioqLyB9KSwKCS8qIDgyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXyg1NCk7CglfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCV9fd2VicGFja19yZXF1aXJlX18oNTEpOwoJX193ZWJwYWNrX3JlcXVpcmVfXygxMDQpOwoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLlByb21pc2U7CgoJLyoqKi8gfSksCgkvKiA4MyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oMTA1KTsKCV9fd2VicGFja19yZXF1aXJlX18oNTQpOwoJX193ZWJwYWNrX3JlcXVpcmVfXygxMDYpOwoJX193ZWJwYWNrX3JlcXVpcmVfXygxMDcpOwoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLlN5bWJvbDsKCgkvKioqLyB9KSwKCS8qIDg0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CglfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkuZignaXRlcmF0b3InKTsKCgkvKioqLyB9KSwKCS8qIDg1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgQ29uc3RydWN0b3IsIG5hbWUsIGZvcmJpZGRlbkZpZWxkKXsKCSAgaWYoIShpdCBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSB8fCAoZm9yYmlkZGVuRmllbGQgIT09IHVuZGVmaW5lZCAmJiBmb3JiaWRkZW5GaWVsZCBpbiBpdCkpewoJICAgIHRocm93IFR5cGVFcnJvcihuYW1lICsgJzogaW5jb3JyZWN0IGludm9jYXRpb24hJyk7CgkgIH0gcmV0dXJuIGl0OwoJfTsKCgkvKioqLyB9KSwKCS8qIDg2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gYWxsIGVudW1lcmFibGUgb2JqZWN0IGtleXMsIGluY2x1ZGVzIHN5bWJvbHMKCXZhciBnZXRLZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkKCSAgLCBnT1BTICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OCkKCSAgLCBwSUUgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgdmFyIHJlc3VsdCAgICAgPSBnZXRLZXlzKGl0KQoJICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZjsKCSAgaWYoZ2V0U3ltYm9scyl7CgkgICAgdmFyIHN5bWJvbHMgPSBnZXRTeW1ib2xzKGl0KQoJICAgICAgLCBpc0VudW0gID0gcElFLmYKCSAgICAgICwgaSAgICAgICA9IDAKCSAgICAgICwga2V5OwoJICAgIHdoaWxlKHN5bWJvbHMubGVuZ3RoID4gaSlpZihpc0VudW0uY2FsbChpdCwga2V5ID0gc3ltYm9sc1tpKytdKSlyZXN1bHQucHVzaChrZXkpOwoJICB9IHJldHVybiByZXN1bHQ7Cgl9OwoKCS8qKiovIH0pLAoJLyogODcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgY3R4ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQoJICAsIGNhbGwgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MSkKCSAgLCBpc0FycmF5SXRlciA9IF9fd2VicGFja19yZXF1aXJlX18oODkpCgkgICwgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCgkgICwgdG9MZW5ndGggICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KQoJICAsIGdldEl0ZXJGbiAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MykKCSAgLCBCUkVBSyAgICAgICA9IHt9CgkgICwgUkVUVVJOICAgICAgPSB7fTsKCXZhciBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdGVyYWJsZSwgZW50cmllcywgZm4sIHRoYXQsIElURVJBVE9SKXsKCSAgdmFyIGl0ZXJGbiA9IElURVJBVE9SID8gZnVuY3Rpb24oKXsgcmV0dXJuIGl0ZXJhYmxlOyB9IDogZ2V0SXRlckZuKGl0ZXJhYmxlKQoJICAgICwgZiAgICAgID0gY3R4KGZuLCB0aGF0LCBlbnRyaWVzID8gMiA6IDEpCgkgICAgLCBpbmRleCAgPSAwCgkgICAgLCBsZW5ndGgsIHN0ZXAsIGl0ZXJhdG9yLCByZXN1bHQ7CgkgIGlmKHR5cGVvZiBpdGVyRm4gIT0gJ2Z1bmN0aW9uJyl0aHJvdyBUeXBlRXJyb3IoaXRlcmFibGUgKyAnIGlzIG5vdCBpdGVyYWJsZSEnKTsKCSAgLy8gZmFzdCBjYXNlIGZvciBhcnJheXMgd2l0aCBkZWZhdWx0IGl0ZXJhdG9yCgkgIGlmKGlzQXJyYXlJdGVyKGl0ZXJGbikpZm9yKGxlbmd0aCA9IHRvTGVuZ3RoKGl0ZXJhYmxlLmxlbmd0aCk7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKXsKCSAgICByZXN1bHQgPSBlbnRyaWVzID8gZihhbk9iamVjdChzdGVwID0gaXRlcmFibGVbaW5kZXhdKVswXSwgc3RlcFsxXSkgOiBmKGl0ZXJhYmxlW2luZGV4XSk7CgkgICAgaWYocmVzdWx0ID09PSBCUkVBSyB8fCByZXN1bHQgPT09IFJFVFVSTilyZXR1cm4gcmVzdWx0OwoJICB9IGVsc2UgZm9yKGl0ZXJhdG9yID0gaXRlckZuLmNhbGwoaXRlcmFibGUpOyAhKHN0ZXAgPSBpdGVyYXRvci5uZXh0KCkpLmRvbmU7ICl7CgkgICAgcmVzdWx0ID0gY2FsbChpdGVyYXRvciwgZiwgc3RlcC52YWx1ZSwgZW50cmllcyk7CgkgICAgaWYocmVzdWx0ID09PSBCUkVBSyB8fCByZXN1bHQgPT09IFJFVFVSTilyZXR1cm4gcmVzdWx0OwoJICB9Cgl9OwoJZXhwb3J0cy5CUkVBSyAgPSBCUkVBSzsKCWV4cG9ydHMuUkVUVVJOID0gUkVUVVJOOwoKCS8qKiovIH0pLAoJLyogODggKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvLyBmYXN0IGFwcGx5LCBodHRwOi8vanNwZXJmLmxua2l0LmNvbS9mYXN0LWFwcGx5LzUKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIGFyZ3MsIHRoYXQpewoJICB2YXIgdW4gPSB0aGF0ID09PSB1bmRlZmluZWQ7CgkgIHN3aXRjaChhcmdzLmxlbmd0aCl7CgkgICAgY2FzZSAwOiByZXR1cm4gdW4gPyBmbigpCgkgICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQpOwoJICAgIGNhc2UgMTogcmV0dXJuIHVuID8gZm4oYXJnc1swXSkKCSAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSk7CgkgICAgY2FzZSAyOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdKQoJICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdKTsKCSAgICBjYXNlIDM6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pCgkgICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pOwoJICAgIGNhc2UgNDogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSkKCSAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSk7CgkgIH0gcmV0dXJuICAgICAgICAgICAgICBmbi5hcHBseSh0aGF0LCBhcmdzKTsKCX07CgoJLyoqKi8gfSksCgkvKiA4OSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGNoZWNrIG9uIGRlZmF1bHQgQXJyYXkgaXRlcmF0b3IKCXZhciBJdGVyYXRvcnMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKCSAgLCBJVEVSQVRPUiAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnaXRlcmF0b3InKQoJICAsIEFycmF5UHJvdG8gPSBBcnJheS5wcm90b3R5cGU7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiBpdCAhPT0gdW5kZWZpbmVkICYmIChJdGVyYXRvcnMuQXJyYXkgPT09IGl0IHx8IEFycmF5UHJvdG9bSVRFUkFUT1JdID09PSBpdCk7Cgl9OwoKCS8qKiovIH0pLAoJLyogOTAgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyA3LjIuMiBJc0FycmF5KGFyZ3VtZW50KQoJdmFyIGNvZiA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwoJbW9kdWxlLmV4cG9ydHMgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIGlzQXJyYXkoYXJnKXsKCSAgcmV0dXJuIGNvZihhcmcpID09ICdBcnJheSc7Cgl9OwoKCS8qKiovIH0pLAoJLyogOTEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBjYWxsIHNvbWV0aGluZyBvbiBpdGVyYXRvciBzdGVwIHdpdGggc2FmZSBjbG9zaW5nIG9uIGVycm9yCgl2YXIgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdGVyYXRvciwgZm4sIHZhbHVlLCBlbnRyaWVzKXsKCSAgdHJ5IHsKCSAgICByZXR1cm4gZW50cmllcyA/IGZuKGFuT2JqZWN0KHZhbHVlKVswXSwgdmFsdWVbMV0pIDogZm4odmFsdWUpOwoJICAvLyA3LjQuNiBJdGVyYXRvckNsb3NlKGl0ZXJhdG9yLCBjb21wbGV0aW9uKQoJICB9IGNhdGNoKGUpewoJICAgIHZhciByZXQgPSBpdGVyYXRvclsncmV0dXJuJ107CgkgICAgaWYocmV0ICE9PSB1bmRlZmluZWQpYW5PYmplY3QocmV0LmNhbGwoaXRlcmF0b3IpKTsKCSAgICB0aHJvdyBlOwoJICB9Cgl9OwoKCS8qKiovIH0pLAoJLyogOTIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgSVRFUkFUT1IgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnaXRlcmF0b3InKQoJICAsIFNBRkVfQ0xPU0lORyA9IGZhbHNlOwoKCXRyeSB7CgkgIHZhciByaXRlciA9IFs3XVtJVEVSQVRPUl0oKTsKCSAgcml0ZXJbJ3JldHVybiddID0gZnVuY3Rpb24oKXsgU0FGRV9DTE9TSU5HID0gdHJ1ZTsgfTsKCSAgQXJyYXkuZnJvbShyaXRlciwgZnVuY3Rpb24oKXsgdGhyb3cgMjsgfSk7Cgl9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjLCBza2lwQ2xvc2luZyl7CgkgIGlmKCFza2lwQ2xvc2luZyAmJiAhU0FGRV9DTE9TSU5HKXJldHVybiBmYWxzZTsKCSAgdmFyIHNhZmUgPSBmYWxzZTsKCSAgdHJ5IHsKCSAgICB2YXIgYXJyICA9IFs3XQoJICAgICAgLCBpdGVyID0gYXJyW0lURVJBVE9SXSgpOwoJICAgIGl0ZXIubmV4dCA9IGZ1bmN0aW9uKCl7IHJldHVybiB7ZG9uZTogc2FmZSA9IHRydWV9OyB9OwoJICAgIGFycltJVEVSQVRPUl0gPSBmdW5jdGlvbigpeyByZXR1cm4gaXRlcjsgfTsKCSAgICBleGVjKGFycik7CgkgIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCSAgcmV0dXJuIHNhZmU7Cgl9OwoKCS8qKiovIH0pLAoJLyogOTMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgZ2V0S2V5cyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkKCSAgLCB0b0lPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqZWN0LCBlbCl7CgkgIHZhciBPICAgICAgPSB0b0lPYmplY3Qob2JqZWN0KQoJICAgICwga2V5cyAgID0gZ2V0S2V5cyhPKQoJICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgKCSAgICAsIGluZGV4ICA9IDAKCSAgICAsIGtleTsKCSAgd2hpbGUobGVuZ3RoID4gaW5kZXgpaWYoT1trZXkgPSBrZXlzW2luZGV4KytdXSA9PT0gZWwpcmV0dXJuIGtleTsKCX07CgoJLyoqKi8gfSksCgkvKiA5NCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBnbG9iYWwgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCgkgICwgbWFjcm90YXNrID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Nykuc2V0CgkgICwgT2JzZXJ2ZXIgID0gZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIKCSAgLCBwcm9jZXNzICAgPSBnbG9iYWwucHJvY2VzcwoJICAsIFByb21pc2UgICA9IGdsb2JhbC5Qcm9taXNlCgkgICwgaXNOb2RlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCkocHJvY2VzcykgPT0gJ3Byb2Nlc3MnOwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKXsKCSAgdmFyIGhlYWQsIGxhc3QsIG5vdGlmeTsKCgkgIHZhciBmbHVzaCA9IGZ1bmN0aW9uKCl7CgkgICAgdmFyIHBhcmVudCwgZm47CgkgICAgaWYoaXNOb2RlICYmIChwYXJlbnQgPSBwcm9jZXNzLmRvbWFpbikpcGFyZW50LmV4aXQoKTsKCSAgICB3aGlsZShoZWFkKXsKCSAgICAgIGZuICAgPSBoZWFkLmZuOwoJICAgICAgaGVhZCA9IGhlYWQubmV4dDsKCSAgICAgIHRyeSB7CgkgICAgICAgIGZuKCk7CgkgICAgICB9IGNhdGNoKGUpewoJICAgICAgICBpZihoZWFkKW5vdGlmeSgpOwoJICAgICAgICBlbHNlIGxhc3QgPSB1bmRlZmluZWQ7CgkgICAgICAgIHRocm93IGU7CgkgICAgICB9CgkgICAgfSBsYXN0ID0gdW5kZWZpbmVkOwoJICAgIGlmKHBhcmVudClwYXJlbnQuZW50ZXIoKTsKCSAgfTsKCgkgIC8vIE5vZGUuanMKCSAgaWYoaXNOb2RlKXsKCSAgICBub3RpZnkgPSBmdW5jdGlvbigpewoJICAgICAgcHJvY2Vzcy5uZXh0VGljayhmbHVzaCk7CgkgICAgfTsKCSAgLy8gYnJvd3NlcnMgd2l0aCBNdXRhdGlvbk9ic2VydmVyCgkgIH0gZWxzZSBpZihPYnNlcnZlcil7CgkgICAgdmFyIHRvZ2dsZSA9IHRydWUKCSAgICAgICwgbm9kZSAgID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpOwoJICAgIG5ldyBPYnNlcnZlcihmbHVzaCkub2JzZXJ2ZShub2RlLCB7Y2hhcmFjdGVyRGF0YTogdHJ1ZX0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldwoJICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CgkgICAgICBub2RlLmRhdGEgPSB0b2dnbGUgPSAhdG9nZ2xlOwoJICAgIH07CgkgIC8vIGVudmlyb25tZW50cyB3aXRoIG1heWJlIG5vbi1jb21wbGV0ZWx5IGNvcnJlY3QsIGJ1dCBleGlzdGVudCBQcm9taXNlCgkgIH0gZWxzZSBpZihQcm9taXNlICYmIFByb21pc2UucmVzb2x2ZSl7CgkgICAgdmFyIHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTsKCSAgICBub3RpZnkgPSBmdW5jdGlvbigpewoJICAgICAgcHJvbWlzZS50aGVuKGZsdXNoKTsKCSAgICB9OwoJICAvLyBmb3Igb3RoZXIgZW52aXJvbm1lbnRzIC0gbWFjcm90YXNrIGJhc2VkIG9uOgoJICAvLyAtIHNldEltbWVkaWF0ZQoJICAvLyAtIE1lc3NhZ2VDaGFubmVsCgkgIC8vIC0gd2luZG93LnBvc3RNZXNzYWcKCSAgLy8gLSBvbnJlYWR5c3RhdGVjaGFuZ2UKCSAgLy8gLSBzZXRUaW1lb3V0CgkgIH0gZWxzZSB7CgkgICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKCSAgICAgIC8vIHN0cmFuZ2UgSUUgKyB3ZWJwYWNrIGRldiBzZXJ2ZXIgYnVnIC0gdXNlIC5jYWxsKGdsb2JhbCkKCSAgICAgIG1hY3JvdGFzay5jYWxsKGdsb2JhbCwgZmx1c2gpOwoJICAgIH07CgkgIH0KCgkgIHJldHVybiBmdW5jdGlvbihmbil7CgkgICAgdmFyIHRhc2sgPSB7Zm46IGZuLCBuZXh0OiB1bmRlZmluZWR9OwoJICAgIGlmKGxhc3QpbGFzdC5uZXh0ID0gdGFzazsKCSAgICBpZighaGVhZCl7CgkgICAgICBoZWFkID0gdGFzazsKCSAgICAgIG5vdGlmeSgpOwoJICAgIH0gbGFzdCA9IHRhc2s7CgkgIH07Cgl9OwoKCS8qKiovIH0pLAoJLyogOTUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBmYWxsYmFjayBmb3IgSUUxMSBidWdneSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB3aXRoIGlmcmFtZSBhbmQgd2luZG93Cgl2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKCSAgLCBnT1BOICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY1KS5mCgkgICwgdG9TdHJpbmcgID0ge30udG9TdHJpbmc7CgoJdmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMKCSAgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW107CgoJdmFyIGdldFdpbmRvd05hbWVzID0gZnVuY3Rpb24oaXQpewoJICB0cnkgewoJICAgIHJldHVybiBnT1BOKGl0KTsKCSAgfSBjYXRjaChlKXsKCSAgICByZXR1cm4gd2luZG93TmFtZXMuc2xpY2UoKTsKCSAgfQoJfTsKCgltb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCl7CgkgIHJldHVybiB3aW5kb3dOYW1lcyAmJiB0b1N0cmluZy5jYWxsKGl0KSA9PSAnW29iamVjdCBXaW5kb3ddJyA/IGdldFdpbmRvd05hbWVzKGl0KSA6IGdPUE4odG9JT2JqZWN0KGl0KSk7Cgl9OwoKCgkvKioqLyB9KSwKCS8qIDk2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGhpZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih0YXJnZXQsIHNyYywgc2FmZSl7CgkgIGZvcih2YXIga2V5IGluIHNyYyl7CgkgICAgaWYoc2FmZSAmJiB0YXJnZXRba2V5XSl0YXJnZXRba2V5XSA9IHNyY1trZXldOwoJICAgIGVsc2UgaGlkZSh0YXJnZXQsIGtleSwgc3JjW2tleV0pOwoJICB9IHJldHVybiB0YXJnZXQ7Cgl9OwoKCS8qKiovIH0pLAoJLyogOTcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBXb3JrcyB3aXRoIF9fcHJvdG9fXyBvbmx5LiBPbGQgdjggY2FuJ3Qgd29yayB3aXRoIG51bGwgcHJvdG8gb2JqZWN0cy4KCS8qIGVzbGludC1kaXNhYmxlIG5vLXByb3RvICovCgl2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCgkgICwgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwoJdmFyIGNoZWNrID0gZnVuY3Rpb24oTywgcHJvdG8pewoJICBhbk9iamVjdChPKTsKCSAgaWYoIWlzT2JqZWN0KHByb3RvKSAmJiBwcm90byAhPT0gbnVsbCl0aHJvdyBUeXBlRXJyb3IocHJvdG8gKyAiOiBjYW4ndCBzZXQgYXMgcHJvdG90eXBlISIpOwoJfTsKCW1vZHVsZS5leHBvcnRzID0gewoJICBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoJ19fcHJvdG9fXycgaW4ge30gPyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCgkgICAgZnVuY3Rpb24odGVzdCwgYnVnZ3ksIHNldCl7CgkgICAgICB0cnkgewoJICAgICAgICBzZXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KShGdW5jdGlvbi5jYWxsLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KS5mKE9iamVjdC5wcm90b3R5cGUsICdfX3Byb3RvX18nKS5zZXQsIDIpOwoJICAgICAgICBzZXQodGVzdCwgW10pOwoJICAgICAgICBidWdneSA9ICEodGVzdCBpbnN0YW5jZW9mIEFycmF5KTsKCSAgICAgIH0gY2F0Y2goZSl7IGJ1Z2d5ID0gdHJ1ZTsgfQoJICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKE8sIHByb3RvKXsKCSAgICAgICAgY2hlY2soTywgcHJvdG8pOwoJICAgICAgICBpZihidWdneSlPLl9fcHJvdG9fXyA9IHByb3RvOwoJICAgICAgICBlbHNlIHNldChPLCBwcm90byk7CgkgICAgICAgIHJldHVybiBPOwoJICAgICAgfTsKCSAgICB9KHt9LCBmYWxzZSkgOiB1bmRlZmluZWQpLAoJICBjaGVjazogY2hlY2sKCX07CgoJLyoqKi8gfSksCgkvKiA5OCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgl2YXIgZ2xvYmFsICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCgkgICwgY29yZSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCgkgICwgZFAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCgkgICwgREVTQ1JJUFRPUlMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpCgkgICwgU1BFQ0lFUyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdzcGVjaWVzJyk7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihLRVkpewoJICB2YXIgQyA9IHR5cGVvZiBjb3JlW0tFWV0gPT0gJ2Z1bmN0aW9uJyA/IGNvcmVbS0VZXSA6IGdsb2JhbFtLRVldOwoJICBpZihERVNDUklQVE9SUyAmJiBDICYmICFDW1NQRUNJRVNdKWRQLmYoQywgU1BFQ0lFUywgewoJICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKCSAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9CgkgIH0pOwoJfTsKCgkvKioqLyB9KSwKCS8qIDk5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpCgl2YXIgYW5PYmplY3QgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQoJICAsIGFGdW5jdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpCgkgICwgU1BFQ0lFUyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnc3BlY2llcycpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihPLCBEKXsKCSAgdmFyIEMgPSBhbk9iamVjdChPKS5jb25zdHJ1Y3RvciwgUzsKCSAgcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBEIDogYUZ1bmN0aW9uKFMpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDEwMCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KQoJLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCgkkZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtjcmVhdGU6IF9fd2VicGFja19yZXF1aXJlX18oMzcpfSk7CgoJLyoqKi8gfSksCgkvKiAxMDEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjIuOSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTykKCXZhciB0b09iamVjdCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQoJICAsICRnZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oNDMpOwoKCV9fd2VicGFja19yZXF1aXJlX18oNDUpKCdnZXRQcm90b3R5cGVPZicsIGZ1bmN0aW9uKCl7CgkgIHJldHVybiBmdW5jdGlvbiBnZXRQcm90b3R5cGVPZihpdCl7CgkgICAgcmV0dXJuICRnZXRQcm90b3R5cGVPZih0b09iamVjdChpdCkpOwoJICB9OwoJfSk7CgoJLyoqKi8gfSksCgkvKiAxMDIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjIuMTQgT2JqZWN0LmtleXMoTykKCXZhciB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCgkgICwgJGtleXMgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KSgna2V5cycsIGZ1bmN0aW9uKCl7CgkgIHJldHVybiBmdW5jdGlvbiBrZXlzKGl0KXsKCSAgICByZXR1cm4gJGtleXModG9PYmplY3QoaXQpKTsKCSAgfTsKCX0pOwoKCS8qKiovIH0pLAoJLyogMTAzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gMTkuMS4zLjE5IE9iamVjdC5zZXRQcm90b3R5cGVPZihPLCBwcm90bykKCXZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCSRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0Jywge3NldFByb3RvdHlwZU9mOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDk3KS5zZXR9KTsKCgkvKioqLyB9KSwKCS8qIDEwNCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgl2YXIgTElCUkFSWSAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNikKCSAgLCBnbG9iYWwgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCgkgICwgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKCSAgLCBjbGFzc29mICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KQoJICAsICRleHBvcnQgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOSkKCSAgLCBpc09iamVjdCAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCgkgICwgYUZ1bmN0aW9uICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSkKCSAgLCBhbkluc3RhbmNlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg1KQoJICAsIGZvck9mICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODcpCgkgICwgc3BlY2llc0NvbnN0cnVjdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5OSkKCSAgLCB0YXNrICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KS5zZXQKCSAgLCBtaWNyb3Rhc2sgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk0KSgpCgkgICwgUFJPTUlTRSAgICAgICAgICAgID0gJ1Byb21pc2UnCgkgICwgVHlwZUVycm9yICAgICAgICAgID0gZ2xvYmFsLlR5cGVFcnJvcgoJICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCgkgICwgJFByb21pc2UgICAgICAgICAgID0gZ2xvYmFsW1BST01JU0VdCgkgICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MKCSAgLCBpc05vZGUgICAgICAgICAgICAgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJwoJICAsIGVtcHR5ICAgICAgICAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KCSAgLCBJbnRlcm5hbCwgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5LCBXcmFwcGVyOwoKCXZhciBVU0VfTkFUSVZFID0gISFmdW5jdGlvbigpewoJICB0cnkgewoJICAgIC8vIGNvcnJlY3Qgc3ViY2xhc3Npbmcgd2l0aCBAQHNwZWNpZXMgc3VwcG9ydAoJICAgIHZhciBwcm9taXNlICAgICA9ICRQcm9taXNlLnJlc29sdmUoMSkKCSAgICAgICwgRmFrZVByb21pc2UgPSAocHJvbWlzZS5jb25zdHJ1Y3RvciA9IHt9KVtfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdzcGVjaWVzJyldID0gZnVuY3Rpb24oZXhlYyl7IGV4ZWMoZW1wdHksIGVtcHR5KTsgfTsKCSAgICAvLyB1bmhhbmRsZWQgcmVqZWN0aW9ucyB0cmFja2luZyBzdXBwb3J0LCBOb2RlSlMgUHJvbWlzZSB3aXRob3V0IGl0IGZhaWxzIEBAc3BlY2llcyB0ZXN0CgkgICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKSAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2U7CgkgIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCX0oKTsKCgkvLyBoZWxwZXJzCgl2YXIgc2FtZUNvbnN0cnVjdG9yID0gZnVuY3Rpb24oYSwgYil7CgkgIC8vIHdpdGggbGlicmFyeSB3cmFwcGVyIHNwZWNpYWwgY2FzZQoJICByZXR1cm4gYSA9PT0gYiB8fCBhID09PSAkUHJvbWlzZSAmJiBiID09PSBXcmFwcGVyOwoJfTsKCXZhciBpc1RoZW5hYmxlID0gZnVuY3Rpb24oaXQpewoJICB2YXIgdGhlbjsKCSAgcmV0dXJuIGlzT2JqZWN0KGl0KSAmJiB0eXBlb2YgKHRoZW4gPSBpdC50aGVuKSA9PSAnZnVuY3Rpb24nID8gdGhlbiA6IGZhbHNlOwoJfTsKCXZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewoJICByZXR1cm4gc2FtZUNvbnN0cnVjdG9yKCRQcm9taXNlLCBDKQoJICAgID8gbmV3IFByb21pc2VDYXBhYmlsaXR5KEMpCgkgICAgOiBuZXcgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5KEMpOwoJfTsKCXZhciBQcm9taXNlQ2FwYWJpbGl0eSA9IEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewoJICB2YXIgcmVzb2x2ZSwgcmVqZWN0OwoJICB0aGlzLnByb21pc2UgPSBuZXcgQyhmdW5jdGlvbigkJHJlc29sdmUsICQkcmVqZWN0KXsKCSAgICBpZihyZXNvbHZlICE9PSB1bmRlZmluZWQgfHwgcmVqZWN0ICE9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCdCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvcicpOwoJICAgIHJlc29sdmUgPSAkJHJlc29sdmU7CgkgICAgcmVqZWN0ICA9ICQkcmVqZWN0OwoJICB9KTsKCSAgdGhpcy5yZXNvbHZlID0gYUZ1bmN0aW9uKHJlc29sdmUpOwoJICB0aGlzLnJlamVjdCAgPSBhRnVuY3Rpb24ocmVqZWN0KTsKCX07Cgl2YXIgcGVyZm9ybSA9IGZ1bmN0aW9uKGV4ZWMpewoJICB0cnkgewoJICAgIGV4ZWMoKTsKCSAgfSBjYXRjaChlKXsKCSAgICByZXR1cm4ge2Vycm9yOiBlfTsKCSAgfQoJfTsKCXZhciBub3RpZnkgPSBmdW5jdGlvbihwcm9taXNlLCBpc1JlamVjdCl7CgkgIGlmKHByb21pc2UuX24pcmV0dXJuOwoJICBwcm9taXNlLl9uID0gdHJ1ZTsKCSAgdmFyIGNoYWluID0gcHJvbWlzZS5fYzsKCSAgbWljcm90YXNrKGZ1bmN0aW9uKCl7CgkgICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgoJICAgICAgLCBvayAgICA9IHByb21pc2UuX3MgPT0gMQoJICAgICAgLCBpICAgICA9IDA7CgkgICAgdmFyIHJ1biA9IGZ1bmN0aW9uKHJlYWN0aW9uKXsKCSAgICAgIHZhciBoYW5kbGVyID0gb2sgPyByZWFjdGlvbi5vayA6IHJlYWN0aW9uLmZhaWwKCSAgICAgICAgLCByZXNvbHZlID0gcmVhY3Rpb24ucmVzb2x2ZQoJICAgICAgICAsIHJlamVjdCAgPSByZWFjdGlvbi5yZWplY3QKCSAgICAgICAgLCBkb21haW4gID0gcmVhY3Rpb24uZG9tYWluCgkgICAgICAgICwgcmVzdWx0LCB0aGVuOwoJICAgICAgdHJ5IHsKCSAgICAgICAgaWYoaGFuZGxlcil7CgkgICAgICAgICAgaWYoIW9rKXsKCSAgICAgICAgICAgIGlmKHByb21pc2UuX2ggPT0gMilvbkhhbmRsZVVuaGFuZGxlZChwcm9taXNlKTsKCSAgICAgICAgICAgIHByb21pc2UuX2ggPSAxOwoJICAgICAgICAgIH0KCSAgICAgICAgICBpZihoYW5kbGVyID09PSB0cnVlKXJlc3VsdCA9IHZhbHVlOwoJICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgaWYoZG9tYWluKWRvbWFpbi5lbnRlcigpOwoJICAgICAgICAgICAgcmVzdWx0ID0gaGFuZGxlcih2YWx1ZSk7CgkgICAgICAgICAgICBpZihkb21haW4pZG9tYWluLmV4aXQoKTsKCSAgICAgICAgICB9CgkgICAgICAgICAgaWYocmVzdWx0ID09PSByZWFjdGlvbi5wcm9taXNlKXsKCSAgICAgICAgICAgIHJlamVjdChUeXBlRXJyb3IoJ1Byb21pc2UtY2hhaW4gY3ljbGUnKSk7CgkgICAgICAgICAgfSBlbHNlIGlmKHRoZW4gPSBpc1RoZW5hYmxlKHJlc3VsdCkpewoJICAgICAgICAgICAgdGhlbi5jYWxsKHJlc3VsdCwgcmVzb2x2ZSwgcmVqZWN0KTsKCSAgICAgICAgICB9IGVsc2UgcmVzb2x2ZShyZXN1bHQpOwoJICAgICAgICB9IGVsc2UgcmVqZWN0KHZhbHVlKTsKCSAgICAgIH0gY2F0Y2goZSl7CgkgICAgICAgIHJlamVjdChlKTsKCSAgICAgIH0KCSAgICB9OwoJICAgIHdoaWxlKGNoYWluLmxlbmd0aCA+IGkpcnVuKGNoYWluW2krK10pOyAvLyB2YXJpYWJsZSBsZW5ndGggLSBjYW4ndCB1c2UgZm9yRWFjaAoJICAgIHByb21pc2UuX2MgPSBbXTsKCSAgICBwcm9taXNlLl9uID0gZmFsc2U7CgkgICAgaWYoaXNSZWplY3QgJiYgIXByb21pc2UuX2gpb25VbmhhbmRsZWQocHJvbWlzZSk7CgkgIH0pOwoJfTsKCXZhciBvblVuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2UpewoJICB0YXNrLmNhbGwoZ2xvYmFsLCBmdW5jdGlvbigpewoJICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YKCSAgICAgICwgYWJydXB0LCBoYW5kbGVyLCBjb25zb2xlOwoJICAgIGlmKGlzVW5oYW5kbGVkKHByb21pc2UpKXsKCSAgICAgIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKCSAgICAgICAgaWYoaXNOb2RlKXsKCSAgICAgICAgICBwcm9jZXNzLmVtaXQoJ3VuaGFuZGxlZFJlamVjdGlvbicsIHZhbHVlLCBwcm9taXNlKTsKCSAgICAgICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub251bmhhbmRsZWRyZWplY3Rpb24pewoJICAgICAgICAgIGhhbmRsZXIoe3Byb21pc2U6IHByb21pc2UsIHJlYXNvbjogdmFsdWV9KTsKCSAgICAgICAgfSBlbHNlIGlmKChjb25zb2xlID0gZ2xvYmFsLmNvbnNvbGUpICYmIGNvbnNvbGUuZXJyb3IpewoJICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbicsIHZhbHVlKTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgICAvLyBCcm93c2VycyBzaG91bGQgbm90IHRyaWdnZXIgYHJlamVjdGlvbkhhbmRsZWRgIGV2ZW50IGlmIGl0IHdhcyBoYW5kbGVkIGhlcmUsIE5vZGVKUyAtIHNob3VsZAoJICAgICAgcHJvbWlzZS5faCA9IGlzTm9kZSB8fCBpc1VuaGFuZGxlZChwcm9taXNlKSA/IDIgOiAxOwoJICAgIH0gcHJvbWlzZS5fYSA9IHVuZGVmaW5lZDsKCSAgICBpZihhYnJ1cHQpdGhyb3cgYWJydXB0LmVycm9yOwoJICB9KTsKCX07Cgl2YXIgaXNVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKCSAgaWYocHJvbWlzZS5faCA9PSAxKXJldHVybiBmYWxzZTsKCSAgdmFyIGNoYWluID0gcHJvbWlzZS5fYSB8fCBwcm9taXNlLl9jCgkgICAgLCBpICAgICA9IDAKCSAgICAsIHJlYWN0aW9uOwoJICB3aGlsZShjaGFpbi5sZW5ndGggPiBpKXsKCSAgICByZWFjdGlvbiA9IGNoYWluW2krK107CgkgICAgaWYocmVhY3Rpb24uZmFpbCB8fCAhaXNVbmhhbmRsZWQocmVhY3Rpb24ucHJvbWlzZSkpcmV0dXJuIGZhbHNlOwoJICB9IHJldHVybiB0cnVlOwoJfTsKCXZhciBvbkhhbmRsZVVuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2UpewoJICB0YXNrLmNhbGwoZ2xvYmFsLCBmdW5jdGlvbigpewoJICAgIHZhciBoYW5kbGVyOwoJICAgIGlmKGlzTm9kZSl7CgkgICAgICBwcm9jZXNzLmVtaXQoJ3JlamVjdGlvbkhhbmRsZWQnLCBwcm9taXNlKTsKCSAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnJlamVjdGlvbmhhbmRsZWQpewoJICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiBwcm9taXNlLl92fSk7CgkgICAgfQoJICB9KTsKCX07Cgl2YXIgJHJlamVjdCA9IGZ1bmN0aW9uKHZhbHVlKXsKCSAgdmFyIHByb21pc2UgPSB0aGlzOwoJICBpZihwcm9taXNlLl9kKXJldHVybjsKCSAgcHJvbWlzZS5fZCA9IHRydWU7CgkgIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAoJICBwcm9taXNlLl92ID0gdmFsdWU7CgkgIHByb21pc2UuX3MgPSAyOwoJICBpZighcHJvbWlzZS5fYSlwcm9taXNlLl9hID0gcHJvbWlzZS5fYy5zbGljZSgpOwoJICBub3RpZnkocHJvbWlzZSwgdHJ1ZSk7Cgl9OwoJdmFyICRyZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpewoJICB2YXIgcHJvbWlzZSA9IHRoaXMKCSAgICAsIHRoZW47CgkgIGlmKHByb21pc2UuX2QpcmV0dXJuOwoJICBwcm9taXNlLl9kID0gdHJ1ZTsKCSAgcHJvbWlzZSA9IHByb21pc2UuX3cgfHwgcHJvbWlzZTsgLy8gdW53cmFwCgkgIHRyeSB7CgkgICAgaWYocHJvbWlzZSA9PT0gdmFsdWUpdGhyb3cgVHlwZUVycm9yKCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZiIpOwoJICAgIGlmKHRoZW4gPSBpc1RoZW5hYmxlKHZhbHVlKSl7CgkgICAgICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKCSAgICAgICAgdmFyIHdyYXBwZXIgPSB7X3c6IHByb21pc2UsIF9kOiBmYWxzZX07IC8vIHdyYXAKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICB0aGVuLmNhbGwodmFsdWUsIGN0eCgkcmVzb2x2ZSwgd3JhcHBlciwgMSksIGN0eCgkcmVqZWN0LCB3cmFwcGVyLCAxKSk7CgkgICAgICAgIH0gY2F0Y2goZSl7CgkgICAgICAgICAgJHJlamVjdC5jYWxsKHdyYXBwZXIsIGUpOwoJICAgICAgICB9CgkgICAgICB9KTsKCSAgICB9IGVsc2UgewoJICAgICAgcHJvbWlzZS5fdiA9IHZhbHVlOwoJICAgICAgcHJvbWlzZS5fcyA9IDE7CgkgICAgICBub3RpZnkocHJvbWlzZSwgZmFsc2UpOwoJICAgIH0KCSAgfSBjYXRjaChlKXsKCSAgICAkcmVqZWN0LmNhbGwoe193OiBwcm9taXNlLCBfZDogZmFsc2V9LCBlKTsgLy8gd3JhcAoJICB9Cgl9OwoKCS8vIGNvbnN0cnVjdG9yIHBvbHlmaWxsCglpZighVVNFX05BVElWRSl7CgkgIC8vIDI1LjQuMy4xIFByb21pc2UoZXhlY3V0b3IpCgkgICRQcm9taXNlID0gZnVuY3Rpb24gUHJvbWlzZShleGVjdXRvcil7CgkgICAgYW5JbnN0YW5jZSh0aGlzLCAkUHJvbWlzZSwgUFJPTUlTRSwgJ19oJyk7CgkgICAgYUZ1bmN0aW9uKGV4ZWN1dG9yKTsKCSAgICBJbnRlcm5hbC5jYWxsKHRoaXMpOwoJICAgIHRyeSB7CgkgICAgICBleGVjdXRvcihjdHgoJHJlc29sdmUsIHRoaXMsIDEpLCBjdHgoJHJlamVjdCwgdGhpcywgMSkpOwoJICAgIH0gY2F0Y2goZXJyKXsKCSAgICAgICRyZWplY3QuY2FsbCh0aGlzLCBlcnIpOwoJICAgIH0KCSAgfTsKCSAgSW50ZXJuYWwgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKCSAgICB0aGlzLl9jID0gW107ICAgICAgICAgICAgIC8vIDwtIGF3YWl0aW5nIHJlYWN0aW9ucwoJICAgIHRoaXMuX2EgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gY2hlY2tlZCBpbiBpc1VuaGFuZGxlZCByZWFjdGlvbnMKCSAgICB0aGlzLl9zID0gMDsgICAgICAgICAgICAgIC8vIDwtIHN0YXRlCgkgICAgdGhpcy5fZCA9IGZhbHNlOyAgICAgICAgICAvLyA8LSBkb25lCgkgICAgdGhpcy5fdiA9IHVuZGVmaW5lZDsgICAgICAvLyA8LSB2YWx1ZQoJICAgIHRoaXMuX2ggPSAwOyAgICAgICAgICAgICAgLy8gPC0gcmVqZWN0aW9uIHN0YXRlLCAwIC0gZGVmYXVsdCwgMSAtIGhhbmRsZWQsIDIgLSB1bmhhbmRsZWQKCSAgICB0aGlzLl9uID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIG5vdGlmeQoJICB9OwoJICBJbnRlcm5hbC5wcm90b3R5cGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KSgkUHJvbWlzZS5wcm90b3R5cGUsIHsKCSAgICAvLyAyNS40LjUuMyBQcm9taXNlLnByb3RvdHlwZS50aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKQoJICAgIHRoZW46IGZ1bmN0aW9uIHRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpewoJICAgICAgdmFyIHJlYWN0aW9uICAgID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsICRQcm9taXNlKSk7CgkgICAgICByZWFjdGlvbi5vayAgICAgPSB0eXBlb2Ygb25GdWxmaWxsZWQgPT0gJ2Z1bmN0aW9uJyA/IG9uRnVsZmlsbGVkIDogdHJ1ZTsKCSAgICAgIHJlYWN0aW9uLmZhaWwgICA9IHR5cGVvZiBvblJlamVjdGVkID09ICdmdW5jdGlvbicgJiYgb25SZWplY3RlZDsKCSAgICAgIHJlYWN0aW9uLmRvbWFpbiA9IGlzTm9kZSA/IHByb2Nlc3MuZG9tYWluIDogdW5kZWZpbmVkOwoJICAgICAgdGhpcy5fYy5wdXNoKHJlYWN0aW9uKTsKCSAgICAgIGlmKHRoaXMuX2EpdGhpcy5fYS5wdXNoKHJlYWN0aW9uKTsKCSAgICAgIGlmKHRoaXMuX3Mpbm90aWZ5KHRoaXMsIGZhbHNlKTsKCSAgICAgIHJldHVybiByZWFjdGlvbi5wcm9taXNlOwoJICAgIH0sCgkgICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2gob25SZWplY3RlZCkKCSAgICAnY2F0Y2gnOiBmdW5jdGlvbihvblJlamVjdGVkKXsKCSAgICAgIHJldHVybiB0aGlzLnRoZW4odW5kZWZpbmVkLCBvblJlamVjdGVkKTsKCSAgICB9CgkgIH0pOwoJICBQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKCl7CgkgICAgdmFyIHByb21pc2UgID0gbmV3IEludGVybmFsOwoJICAgIHRoaXMucHJvbWlzZSA9IHByb21pc2U7CgkgICAgdGhpcy5yZXNvbHZlID0gY3R4KCRyZXNvbHZlLCBwcm9taXNlLCAxKTsKCSAgICB0aGlzLnJlamVjdCAgPSBjdHgoJHJlamVjdCwgcHJvbWlzZSwgMSk7CgkgIH07Cgl9CgoJJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1Byb21pc2U6ICRQcm9taXNlfSk7CglfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKSgkUHJvbWlzZSwgUFJPTUlTRSk7CglfX3dlYnBhY2tfcmVxdWlyZV9fKDk4KShQUk9NSVNFKTsKCVdyYXBwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApW1BST01JU0VdOwoKCS8vIHN0YXRpY3MKCSRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIFBST01JU0UsIHsKCSAgLy8gMjUuNC40LjUgUHJvbWlzZS5yZWplY3QocikKCSAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3Qocil7CgkgICAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eSh0aGlzKQoJICAgICAgLCAkJHJlamVjdCAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CgkgICAgJCRyZWplY3Qocik7CgkgICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKCSAgfQoJfSk7CgkkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIChMSUJSQVJZIHx8ICFVU0VfTkFUSVZFKSwgUFJPTUlTRSwgewoJICAvLyAyNS40LjQuNiBQcm9taXNlLnJlc29sdmUoeCkKCSAgcmVzb2x2ZTogZnVuY3Rpb24gcmVzb2x2ZSh4KXsKCSAgICAvLyBpbnN0YW5jZW9mIGluc3RlYWQgb2YgaW50ZXJuYWwgc2xvdCBjaGVjayBiZWNhdXNlIHdlIHNob3VsZCBmaXggaXQgd2l0aG91dCByZXBsYWNlbWVudCBuYXRpdmUgUHJvbWlzZSBjb3JlCgkgICAgaWYoeCBpbnN0YW5jZW9mICRQcm9taXNlICYmIHNhbWVDb25zdHJ1Y3Rvcih4LmNvbnN0cnVjdG9yLCB0aGlzKSlyZXR1cm4geDsKCSAgICB2YXIgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHRoaXMpCgkgICAgICAsICQkcmVzb2x2ZSAgPSBjYXBhYmlsaXR5LnJlc29sdmU7CgkgICAgJCRyZXNvbHZlKHgpOwoJICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CgkgIH0KCX0pOwoJJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhKFVTRV9OQVRJVkUgJiYgX193ZWJwYWNrX3JlcXVpcmVfXyg5MikoZnVuY3Rpb24oaXRlcil7CgkgICRQcm9taXNlLmFsbChpdGVyKVsnY2F0Y2gnXShlbXB0eSk7Cgl9KSksIFBST01JU0UsIHsKCSAgLy8gMjUuNC40LjEgUHJvbWlzZS5hbGwoaXRlcmFibGUpCgkgIGFsbDogZnVuY3Rpb24gYWxsKGl0ZXJhYmxlKXsKCSAgICB2YXIgQyAgICAgICAgICA9IHRoaXMKCSAgICAgICwgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KEMpCgkgICAgICAsIHJlc29sdmUgICAgPSBjYXBhYmlsaXR5LnJlc29sdmUKCSAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwoJICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CgkgICAgICB2YXIgdmFsdWVzICAgID0gW10KCSAgICAgICAgLCBpbmRleCAgICAgPSAwCgkgICAgICAgICwgcmVtYWluaW5nID0gMTsKCSAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CgkgICAgICAgIHZhciAkaW5kZXggICAgICAgID0gaW5kZXgrKwoJICAgICAgICAgICwgYWxyZWFkeUNhbGxlZCA9IGZhbHNlOwoJICAgICAgICB2YWx1ZXMucHVzaCh1bmRlZmluZWQpOwoJICAgICAgICByZW1haW5pbmcrKzsKCSAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oZnVuY3Rpb24odmFsdWUpewoJICAgICAgICAgIGlmKGFscmVhZHlDYWxsZWQpcmV0dXJuOwoJICAgICAgICAgIGFscmVhZHlDYWxsZWQgID0gdHJ1ZTsKCSAgICAgICAgICB2YWx1ZXNbJGluZGV4XSA9IHZhbHVlOwoJICAgICAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKCSAgICAgICAgfSwgcmVqZWN0KTsKCSAgICAgIH0pOwoJICAgICAgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpOwoJICAgIH0pOwoJICAgIGlmKGFicnVwdClyZWplY3QoYWJydXB0LmVycm9yKTsKCSAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwoJICB9LAoJICAvLyAyNS40LjQuNCBQcm9taXNlLnJhY2UoaXRlcmFibGUpCgkgIHJhY2U6IGZ1bmN0aW9uIHJhY2UoaXRlcmFibGUpewoJICAgIHZhciBDICAgICAgICAgID0gdGhpcwoJICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKCSAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwoJICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CgkgICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2UpewoJICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihjYXBhYmlsaXR5LnJlc29sdmUsIHJlamVjdCk7CgkgICAgICB9KTsKCSAgICB9KTsKCSAgICBpZihhYnJ1cHQpcmVqZWN0KGFicnVwdC5lcnJvcik7CgkgICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKCSAgfQoJfSk7CgoJLyoqKi8gfSksCgkvKiAxMDUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoJLy8gRUNNQVNjcmlwdCA2IHN5bWJvbHMgc2hpbQoJdmFyIGdsb2JhbCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQoJICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKCSAgLCBERVNDUklQVE9SUyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikKCSAgLCAkZXhwb3J0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOSkKCSAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCgkgICwgTUVUQSAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcyKS5LRVkKCSAgLCAkZmFpbHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpCgkgICwgc2hhcmVkICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKQoJICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKCSAgLCB1aWQgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpCgkgICwgd2tzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpCgkgICwgd2tzRXh0ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KQoJICAsIHdrc0RlZmluZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OCkKCSAgLCBrZXlPZiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTMpCgkgICwgZW51bUtleXMgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg2KQoJICAsIGlzQXJyYXkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MCkKCSAgLCBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKCSAgLCB0b0lPYmplY3QgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCgkgICwgdG9QcmltaXRpdmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQoJICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKCSAgLCBfY3JlYXRlICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzcpCgkgICwgZ09QTkV4dCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk1KQoJICAsICRHT1BEICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NykKCSAgLCAkRFAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKCSAgLCAka2V5cyAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpCgkgICwgZ09QRCAgICAgICAgICAgPSAkR09QRC5mCgkgICwgZFAgICAgICAgICAgICAgPSAkRFAuZgoJICAsIGdPUE4gICAgICAgICAgID0gZ09QTkV4dC5mCgkgICwgJFN5bWJvbCAgICAgICAgPSBnbG9iYWwuU3ltYm9sCgkgICwgJEpTT04gICAgICAgICAgPSBnbG9iYWwuSlNPTgoJICAsIF9zdHJpbmdpZnkgICAgID0gJEpTT04gJiYgJEpTT04uc3RyaW5naWZ5CgkgICwgUFJPVE9UWVBFICAgICAgPSAncHJvdG90eXBlJwoJICAsIEhJRERFTiAgICAgICAgID0gd2tzKCdfaGlkZGVuJykKCSAgLCBUT19QUklNSVRJVkUgICA9IHdrcygndG9QcmltaXRpdmUnKQoJICAsIGlzRW51bSAgICAgICAgID0ge30ucHJvcGVydHlJc0VudW1lcmFibGUKCSAgLCBTeW1ib2xSZWdpc3RyeSA9IHNoYXJlZCgnc3ltYm9sLXJlZ2lzdHJ5JykKCSAgLCBBbGxTeW1ib2xzICAgICA9IHNoYXJlZCgnc3ltYm9scycpCgkgICwgT1BTeW1ib2xzICAgICAgPSBzaGFyZWQoJ29wLXN5bWJvbHMnKQoJICAsIE9iamVjdFByb3RvICAgID0gT2JqZWN0W1BST1RPVFlQRV0KCSAgLCBVU0VfTkFUSVZFICAgICA9IHR5cGVvZiAkU3ltYm9sID09ICdmdW5jdGlvbicKCSAgLCBRT2JqZWN0ICAgICAgICA9IGdsb2JhbC5RT2JqZWN0OwoJLy8gRG9uJ3QgdXNlIHNldHRlcnMgaW4gUXQgU2NyaXB0LCBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvMTczCgl2YXIgc2V0dGVyID0gIVFPYmplY3QgfHwgIVFPYmplY3RbUFJPVE9UWVBFXSB8fCAhUU9iamVjdFtQUk9UT1RZUEVdLmZpbmRDaGlsZDsKCgkvLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODcKCXZhciBzZXRTeW1ib2xEZXNjID0gREVTQ1JJUFRPUlMgJiYgJGZhaWxzKGZ1bmN0aW9uKCl7CgkgIHJldHVybiBfY3JlYXRlKGRQKHt9LCAnYScsIHsKCSAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBkUCh0aGlzLCAnYScsIHt2YWx1ZTogN30pLmE7IH0KCSAgfSkpLmEgIT0gNzsKCX0pID8gZnVuY3Rpb24oaXQsIGtleSwgRCl7CgkgIHZhciBwcm90b0Rlc2MgPSBnT1BEKE9iamVjdFByb3RvLCBrZXkpOwoJICBpZihwcm90b0Rlc2MpZGVsZXRlIE9iamVjdFByb3RvW2tleV07CgkgIGRQKGl0LCBrZXksIEQpOwoJICBpZihwcm90b0Rlc2MgJiYgaXQgIT09IE9iamVjdFByb3RvKWRQKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7Cgl9IDogZFA7CgoJdmFyIHdyYXAgPSBmdW5jdGlvbih0YWcpewoJICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pOwoJICBzeW0uX2sgPSB0YWc7CgkgIHJldHVybiBzeW07Cgl9OwoKCXZhciBpc1N5bWJvbCA9IFVTRV9OQVRJVkUgJiYgdHlwZW9mICRTeW1ib2wuaXRlcmF0b3IgPT0gJ3N5bWJvbCcgPyBmdW5jdGlvbihpdCl7CgkgIHJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCc7Cgl9IDogZnVuY3Rpb24oaXQpewoJICByZXR1cm4gaXQgaW5zdGFuY2VvZiAkU3ltYm9sOwoJfTsKCgl2YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCl7CgkgIGlmKGl0ID09PSBPYmplY3RQcm90bykkZGVmaW5lUHJvcGVydHkoT1BTeW1ib2xzLCBrZXksIEQpOwoJICBhbk9iamVjdChpdCk7CgkgIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CgkgIGFuT2JqZWN0KEQpOwoJICBpZihoYXMoQWxsU3ltYm9scywga2V5KSl7CgkgICAgaWYoIUQuZW51bWVyYWJsZSl7CgkgICAgICBpZighaGFzKGl0LCBISURERU4pKWRQKGl0LCBISURERU4sIGNyZWF0ZURlc2MoMSwge30pKTsKCSAgICAgIGl0W0hJRERFTl1ba2V5XSA9IHRydWU7CgkgICAgfSBlbHNlIHsKCSAgICAgIGlmKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0paXRbSElEREVOXVtrZXldID0gZmFsc2U7CgkgICAgICBEID0gX2NyZWF0ZShELCB7ZW51bWVyYWJsZTogY3JlYXRlRGVzYygwLCBmYWxzZSl9KTsKCSAgICB9IHJldHVybiBzZXRTeW1ib2xEZXNjKGl0LCBrZXksIEQpOwoJICB9IHJldHVybiBkUChpdCwga2V5LCBEKTsKCX07Cgl2YXIgJGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKGl0LCBQKXsKCSAgYW5PYmplY3QoaXQpOwoJICB2YXIga2V5cyA9IGVudW1LZXlzKFAgPSB0b0lPYmplY3QoUCkpCgkgICAgLCBpICAgID0gMAoJICAgICwgbCA9IGtleXMubGVuZ3RoCgkgICAgLCBrZXk7CgkgIHdoaWxlKGwgPiBpKSRkZWZpbmVQcm9wZXJ0eShpdCwga2V5ID0ga2V5c1tpKytdLCBQW2tleV0pOwoJICByZXR1cm4gaXQ7Cgl9OwoJdmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaXQsIFApewoJICByZXR1cm4gUCA9PT0gdW5kZWZpbmVkID8gX2NyZWF0ZShpdCkgOiAkZGVmaW5lUHJvcGVydGllcyhfY3JlYXRlKGl0KSwgUCk7Cgl9OwoJdmFyICRwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IGZ1bmN0aW9uIHByb3BlcnR5SXNFbnVtZXJhYmxlKGtleSl7CgkgIHZhciBFID0gaXNFbnVtLmNhbGwodGhpcywga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKSk7CgkgIGlmKHRoaXMgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKXJldHVybiBmYWxzZTsKCSAgcmV0dXJuIEUgfHwgIWhhcyh0aGlzLCBrZXkpIHx8ICFoYXMoQWxsU3ltYm9scywga2V5KSB8fCBoYXModGhpcywgSElEREVOKSAmJiB0aGlzW0hJRERFTl1ba2V5XSA/IEUgOiB0cnVlOwoJfTsKCXZhciAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpewoJICBpdCAgPSB0b0lPYmplY3QoaXQpOwoJICBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpOwoJICBpZihpdCA9PT0gT2JqZWN0UHJvdG8gJiYgaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIWhhcyhPUFN5bWJvbHMsIGtleSkpcmV0dXJuOwoJICB2YXIgRCA9IGdPUEQoaXQsIGtleSk7CgkgIGlmKEQgJiYgaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIShoYXMoaXQsIEhJRERFTikgJiYgaXRbSElEREVOXVtrZXldKSlELmVudW1lcmFibGUgPSB0cnVlOwoJICByZXR1cm4gRDsKCX07Cgl2YXIgJGdldE93blByb3BlcnR5TmFtZXMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKGl0KXsKCSAgdmFyIG5hbWVzICA9IGdPUE4odG9JT2JqZWN0KGl0KSkKCSAgICAsIHJlc3VsdCA9IFtdCgkgICAgLCBpICAgICAgPSAwCgkgICAgLCBrZXk7CgkgIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewoJICAgIGlmKCFoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYga2V5ICE9IEhJRERFTiAmJiBrZXkgIT0gTUVUQSlyZXN1bHQucHVzaChrZXkpOwoJICB9IHJldHVybiByZXN1bHQ7Cgl9OwoJdmFyICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMoaXQpewoJICB2YXIgSVNfT1AgID0gaXQgPT09IE9iamVjdFByb3RvCgkgICAgLCBuYW1lcyAgPSBnT1BOKElTX09QID8gT1BTeW1ib2xzIDogdG9JT2JqZWN0KGl0KSkKCSAgICAsIHJlc3VsdCA9IFtdCgkgICAgLCBpICAgICAgPSAwCgkgICAgLCBrZXk7CgkgIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewoJICAgIGlmKGhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiAoSVNfT1AgPyBoYXMoT2JqZWN0UHJvdG8sIGtleSkgOiB0cnVlKSlyZXN1bHQucHVzaChBbGxTeW1ib2xzW2tleV0pOwoJICB9IHJldHVybiByZXN1bHQ7Cgl9OwoKCS8vIDE5LjQuMS4xIFN5bWJvbChbZGVzY3JpcHRpb25dKQoJaWYoIVVTRV9OQVRJVkUpewoJICAkU3ltYm9sID0gZnVuY3Rpb24gU3ltYm9sKCl7CgkgICAgaWYodGhpcyBpbnN0YW5jZW9mICRTeW1ib2wpdGhyb3cgVHlwZUVycm9yKCdTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3IhJyk7CgkgICAgdmFyIHRhZyA9IHVpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7CgkgICAgdmFyICRzZXQgPSBmdW5jdGlvbih2YWx1ZSl7CgkgICAgICBpZih0aGlzID09PSBPYmplY3RQcm90bykkc2V0LmNhbGwoT1BTeW1ib2xzLCB2YWx1ZSk7CgkgICAgICBpZihoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKXRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7CgkgICAgICBzZXRTeW1ib2xEZXNjKHRoaXMsIHRhZywgY3JlYXRlRGVzYygxLCB2YWx1ZSkpOwoJICAgIH07CgkgICAgaWYoREVTQ1JJUFRPUlMgJiYgc2V0dGVyKXNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0fSk7CgkgICAgcmV0dXJuIHdyYXAodGFnKTsKCSAgfTsKCSAgcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEVdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpewoJICAgIHJldHVybiB0aGlzLl9rOwoJICB9KTsKCgkgICRHT1BELmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwoJICAkRFAuZiAgID0gJGRlZmluZVByb3BlcnR5OwoJICBfX3dlYnBhY2tfcmVxdWlyZV9fKDY1KS5mID0gZ09QTkV4dC5mID0gJGdldE93blByb3BlcnR5TmFtZXM7CgkgIF9fd2VicGFja19yZXF1aXJlX18oNDEpLmYgID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlOwoJICBfX3dlYnBhY2tfcmVxdWlyZV9fKDU4KS5mID0gJGdldE93blByb3BlcnR5U3ltYm9sczsKCgkgIGlmKERFU0NSSVBUT1JTICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KSl7CgkgICAgcmVkZWZpbmUoT2JqZWN0UHJvdG8sICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsICRwcm9wZXJ0eUlzRW51bWVyYWJsZSwgdHJ1ZSk7CgkgIH0KCgkgIHdrc0V4dC5mID0gZnVuY3Rpb24obmFtZSl7CgkgICAgcmV0dXJuIHdyYXAod2tzKG5hbWUpKTsKCSAgfQoJfQoKCSRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtTeW1ib2w6ICRTeW1ib2x9KTsKCglmb3IodmFyIHN5bWJvbHMgPSAoCgkgIC8vIDE5LjQuMi4yLCAxOS40LjIuMywgMTkuNC4yLjQsIDE5LjQuMi42LCAxOS40LjIuOCwgMTkuNC4yLjksIDE5LjQuMi4xMCwgMTkuNC4yLjExLCAxOS40LjIuMTIsIDE5LjQuMi4xMywgMTkuNC4yLjE0CgkgICdoYXNJbnN0YW5jZSxpc0NvbmNhdFNwcmVhZGFibGUsaXRlcmF0b3IsbWF0Y2gscmVwbGFjZSxzZWFyY2gsc3BlY2llcyxzcGxpdCx0b1ByaW1pdGl2ZSx0b1N0cmluZ1RhZyx1bnNjb3BhYmxlcycKCSkuc3BsaXQoJywnKSwgaSA9IDA7IHN5bWJvbHMubGVuZ3RoID4gaTsgKXdrcyhzeW1ib2xzW2krK10pOwoKCWZvcih2YXIgc3ltYm9scyA9ICRrZXlzKHdrcy5zdG9yZSksIGkgPSAwOyBzeW1ib2xzLmxlbmd0aCA+IGk7ICl3a3NEZWZpbmUoc3ltYm9sc1tpKytdKTsKCgkkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywgewoJICAvLyAxOS40LjIuMSBTeW1ib2wuZm9yKGtleSkKCSAgJ2Zvcic6IGZ1bmN0aW9uKGtleSl7CgkgICAgcmV0dXJuIGhhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKQoJICAgICAgPyBTeW1ib2xSZWdpc3RyeVtrZXldCgkgICAgICA6IFN5bWJvbFJlZ2lzdHJ5W2tleV0gPSAkU3ltYm9sKGtleSk7CgkgIH0sCgkgIC8vIDE5LjQuMi41IFN5bWJvbC5rZXlGb3Ioc3ltKQoJICBrZXlGb3I6IGZ1bmN0aW9uIGtleUZvcihrZXkpewoJICAgIGlmKGlzU3ltYm9sKGtleSkpcmV0dXJuIGtleU9mKFN5bWJvbFJlZ2lzdHJ5LCBrZXkpOwoJICAgIHRocm93IFR5cGVFcnJvcihrZXkgKyAnIGlzIG5vdCBhIHN5bWJvbCEnKTsKCSAgfSwKCSAgdXNlU2V0dGVyOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSB0cnVlOyB9LAoJICB1c2VTaW1wbGU6IGZ1bmN0aW9uKCl7IHNldHRlciA9IGZhbHNlOyB9Cgl9KTsKCgkkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnT2JqZWN0JywgewoJICAvLyAxOS4xLjIuMiBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCgkgIGNyZWF0ZTogJGNyZWF0ZSwKCSAgLy8gMTkuMS4yLjQgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCgkgIGRlZmluZVByb3BlcnR5OiAkZGVmaW5lUHJvcGVydHksCgkgIC8vIDE5LjEuMi4zIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpCgkgIGRlZmluZVByb3BlcnRpZXM6ICRkZWZpbmVQcm9wZXJ0aWVzLAoJICAvLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApCgkgIGdldE93blByb3BlcnR5RGVzY3JpcHRvcjogJGdldE93blByb3BlcnR5RGVzY3JpcHRvciwKCSAgLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKCSAgZ2V0T3duUHJvcGVydHlOYW1lczogJGdldE93blByb3BlcnR5TmFtZXMsCgkgIC8vIDE5LjEuMi44IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoTykKCSAgZ2V0T3duUHJvcGVydHlTeW1ib2xzOiAkZ2V0T3duUHJvcGVydHlTeW1ib2xzCgl9KTsKCgkvLyAyNC4zLjIgSlNPTi5zdHJpbmdpZnkodmFsdWUgWywgcmVwbGFjZXIgWywgc3BhY2VdXSkKCSRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbigpewoJICB2YXIgUyA9ICRTeW1ib2woKTsKCSAgLy8gTVMgRWRnZSBjb252ZXJ0cyBzeW1ib2wgdmFsdWVzIHRvIEpTT04gYXMge30KCSAgLy8gV2ViS2l0IGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyBudWxsCgkgIC8vIFY4IHRocm93cyBvbiBib3hlZCBzeW1ib2xzCgkgIHJldHVybiBfc3RyaW5naWZ5KFtTXSkgIT0gJ1tudWxsXScgfHwgX3N0cmluZ2lmeSh7YTogU30pICE9ICd7fScgfHwgX3N0cmluZ2lmeShPYmplY3QoUykpICE9ICd7fSc7Cgl9KSksICdKU09OJywgewoJICBzdHJpbmdpZnk6IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7CgkgICAgaWYoaXQgPT09IHVuZGVmaW5lZCB8fCBpc1N5bWJvbChpdCkpcmV0dXJuOyAvLyBJRTggcmV0dXJucyBzdHJpbmcgb24gdW5kZWZpbmVkCgkgICAgdmFyIGFyZ3MgPSBbaXRdCgkgICAgICAsIGkgICAgPSAxCgkgICAgICAsIHJlcGxhY2VyLCAkcmVwbGFjZXI7CgkgICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKCSAgICByZXBsYWNlciA9IGFyZ3NbMV07CgkgICAgaWYodHlwZW9mIHJlcGxhY2VyID09ICdmdW5jdGlvbicpJHJlcGxhY2VyID0gcmVwbGFjZXI7CgkgICAgaWYoJHJlcGxhY2VyIHx8ICFpc0FycmF5KHJlcGxhY2VyKSlyZXBsYWNlciA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpewoJICAgICAgaWYoJHJlcGxhY2VyKXZhbHVlID0gJHJlcGxhY2VyLmNhbGwodGhpcywga2V5LCB2YWx1ZSk7CgkgICAgICBpZighaXNTeW1ib2wodmFsdWUpKXJldHVybiB2YWx1ZTsKCSAgICB9OwoJICAgIGFyZ3NbMV0gPSByZXBsYWNlcjsKCSAgICByZXR1cm4gX3N0cmluZ2lmeS5hcHBseSgkSlNPTiwgYXJncyk7CgkgIH0KCX0pOwoKCS8vIDE5LjQuMy40IFN5bWJvbC5wcm90b3R5cGVbQEB0b1ByaW1pdGl2ZV0oaGludCkKCSRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IF9fd2VicGFja19yZXF1aXJlX18oNykoJFN5bWJvbFtQUk9UT1RZUEVdLCBUT19QUklNSVRJVkUsICRTeW1ib2xbUFJPVE9UWVBFXS52YWx1ZU9mKTsKCS8vIDE5LjQuMy41IFN5bWJvbC5wcm90b3R5cGVbQEB0b1N0cmluZ1RhZ10KCXNldFRvU3RyaW5nVGFnKCRTeW1ib2wsICdTeW1ib2wnKTsKCS8vIDIwLjIuMS45IE1hdGhbQEB0b1N0cmluZ1RhZ10KCXNldFRvU3RyaW5nVGFnKE1hdGgsICdNYXRoJywgdHJ1ZSk7CgkvLyAyNC4zLjMgSlNPTltAQHRvU3RyaW5nVGFnXQoJc2V0VG9TdHJpbmdUYWcoZ2xvYmFsLkpTT04sICdKU09OJywgdHJ1ZSk7CgoJLyoqKi8gfSksCgkvKiAxMDYgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDQ4KSgnYXN5bmNJdGVyYXRvcicpOwoKCS8qKiovIH0pLAoJLyogMTA3ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXyg0OCkoJ29ic2VydmFibGUnKTsKCgkvKioqLyB9KSwKCS8qIDEwOCAqLywKCS8qIDEwOSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCgl2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKCXZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKCXZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCglleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKCWV4cG9ydHMuZGl2aWRlRW1haWwgPSBkaXZpZGVFbWFpbDsKCWV4cG9ydHMuZW1wdHlPYmplY3QgPSBlbXB0eU9iamVjdDsKCWV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwoJZXhwb3J0cy5nZXRVc2VyVVJMRnJvbUVtYWlsID0gZ2V0VXNlclVSTEZyb21FbWFpbDsKCWV4cG9ydHMuZ2V0VXNlckVtYWlsRnJvbVVSTCA9IGdldFVzZXJFbWFpbEZyb21VUkw7CglleHBvcnRzLmNvbnZlcnRUb1VzZXJVUkwgPSBjb252ZXJ0VG9Vc2VyVVJMOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLyoqCgkqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoJKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoJKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKCSogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKCSogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCgkqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKCSogQ29weXJpZ2h0IDIwMTYgQXBpemVlCgkqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCgkqCgkqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJKgoJKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJKgoJKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJKiovCgkvKioKCSAqIFN1cHBvcnQgbW9kdWxlIHdpdGggc29tZSBmdW5jdGlvbnMgd2lsbCBiZSB1c2VmdWwKCSAqIEBtb2R1bGUgdXRpbHMKCSAqLwoKCS8qKgoJICogQHR5cGVkZWYgZGl2aWRlVVJMCgkgKiBAdHlwZSBPYmplY3QKCSAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB0eXBlIFRoZSB0eXBlIG9mIFVSTAoJICogQHByb3BlcnR5IHtzdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG9mIFVSTAoJICogQHByb3BlcnR5IHtzdHJpbmd9IGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiBVUkwKCSAqLwoKCS8qKgoJICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5CgkgKiBAcGFyYW0gIHtVUkwuVVJMfSB1cmwgLSB1cmwgYWRkcmVzcwoJICogQHJldHVybiB7ZGl2aWRlVVJMfSB0aGUgcmVzdWx0IG9mIGRpdmlkZVVSTAoJICovCglmdW5jdGlvbiBkaXZpZGVVUkwodXJsKSB7CgoJICBpZiAoIXVybCkgdGhyb3cgRXJyb3IoJ1VSTCBpcyBuZWVkZWQgdG8gc3BsaXQnKTsKCgkgIGZ1bmN0aW9uIHJlY3Vyc2UodmFsdWUpIHsKCSAgICB2YXIgcmVnZXggPSAvKFthLXpBLVotXSopKDpcL1wvKD86XC4pP3w6KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fSkoWy1hLXpBLVowLTlAOiUuX1wrfiM9XC9dKikvZ2k7CgkgICAgdmFyIHN1YnN0ID0gJyQxLCQzLCQ0JzsKCSAgICB2YXIgcGFydHMgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBzdWJzdCkuc3BsaXQoJywnKTsKCSAgICByZXR1cm4gcGFydHM7CgkgIH0KCgkgIHZhciBwYXJ0cyA9IHJlY3Vyc2UodXJsKTsKCgkgIC8vIElmIHRoZSB1cmwgaGFzIG5vIHNjaGVtZQoJICBpZiAocGFydHNbMF0gPT09IHVybCAmJiAhcGFydHNbMF0uaW5jbHVkZXMoJ0AnKSkgewoKCSAgICB2YXIgX3Jlc3VsdCA9IHsKCSAgICAgIHR5cGU6ICIiLAoJICAgICAgZG9tYWluOiB1cmwsCgkgICAgICBpZGVudGl0eTogIiIKCSAgICB9OwoKCSAgICBjb25zb2xlLmVycm9yKCdbRGl2aWRlVVJMXSBEaXZpZGVVUkwgZG9uXCd0IHN1cHBvcnQgdXJsIHdpdGhvdXQgc2NoZW1lLiBQbGVhc2UgcmV2aWV3IHlvdXIgdXJsIGFkZHJlc3MnLCB1cmwpOwoKCSAgICByZXR1cm4gX3Jlc3VsdDsKCSAgfQoKCSAgLy8gY2hlY2sgaWYgdGhlIHVybCBoYXMgdGhlIHNjaGVtZSBhbmQgaW5jbHVkZXMgYW4gQAoJICBpZiAocGFydHNbMF0gPT09IHVybCAmJiBwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CgkgICAgdmFyIHNjaGVtZSA9IHBhcnRzWzBdID09PSB1cmwgPyAnc210cCcgOiBwYXJ0c1swXTsKCSAgICBwYXJ0cyA9IHJlY3Vyc2Uoc2NoZW1lICsgJzovLycgKyBwYXJ0c1swXSk7CgkgIH0KCgkgIC8vIGlmIHRoZSBkb21haW4gaW5jbHVkZXMgYW4gQCwgZGl2aWRlIGl0IHRvIGRvbWFpbiBhbmQgaWRlbnRpdHkgcmVzcGVjdGl2ZWx5CgkgIGlmIChwYXJ0c1sxXS5pbmNsdWRlcygnQCcpKSB7CgkgICAgcGFydHNbMl0gPSBwYXJ0c1swXSArICc6Ly8nICsgcGFydHNbMV07CgkgICAgcGFydHNbMV0gPSBwYXJ0c1sxXS5zdWJzdHIocGFydHNbMV0uaW5kZXhPZignQCcpICsgMSk7CgkgIH0gLyplbHNlIGlmIChwYXJ0c1syXS5pbmNsdWRlcygnLycpKSB7CgkgICAgcGFydHNbMl0gPSBwYXJ0c1syXS5zdWJzdHIocGFydHNbMl0ubGFzdEluZGV4T2YoJy8nKSsxKTsKCSAgICB9Ki8KCgkgIHZhciByZXN1bHQgPSB7CgkgICAgdHlwZTogcGFydHNbMF0sCgkgICAgZG9tYWluOiBwYXJ0c1sxXSwKCSAgICBpZGVudGl0eTogcGFydHNbMl0KCSAgfTsKCgkgIHJldHVybiByZXN1bHQ7Cgl9CgoJZnVuY3Rpb24gZGl2aWRlRW1haWwoZW1haWwpIHsKCSAgdmFyIGluZGV4T2ZBdCA9IGVtYWlsLmluZGV4T2YoJ0AnKTsKCgkgIHZhciByZXN1bHQgPSB7CgkgICAgdXNlcm5hbWU6IGVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpLAoJICAgIGRvbWFpbjogZW1haWwuc3Vic3RyaW5nKGluZGV4T2ZBdCArIDEsIGVtYWlsLmxlbmd0aCkKCSAgfTsKCgkgIHJldHVybiByZXN1bHQ7Cgl9CgoJLyoqCgkgKiBDaGVjayBpZiBhbiBPYmplY3QgaXMgZW1wdHkKCSAqIEBwYXJhbSAge09iamVjdH0gb2JqZWN0IE9iamVjdCB0byBiZSBjaGVja2VkCgkgKiBAcmV0dXJuIHtCb29sZWFufSAgICAgICBzdGF0dXMgb2YgT2JqZWN0LCBlbXB0eSBvciBub3QgKHRydWV8ZmFsc2UpOwoJICovCglmdW5jdGlvbiBlbXB0eU9iamVjdChvYmplY3QpIHsKCSAgcmV0dXJuICgwLCBfa2V5czIuZGVmYXVsdCkob2JqZWN0KS5sZW5ndGggPiAwID8gZmFsc2UgOiB0cnVlOwoJfQoKCS8qKgoJICogTWFrZSBhIENPUFkgb2YgdGhlIG9yaWdpbmFsIGRhdGEKCSAqIEBwYXJhbSAge09iamVjdH0gIG9iaiAtIG9iamVjdCB0byBiZSBjbG9uZWQKCSAqIEByZXR1cm4ge09iamVjdH0KCSAqLwoJZnVuY3Rpb24gZGVlcENsb25lKG9iaikgewoJICAvL1RPRE86IHNpbXBsZSBidXQgaW5lZmZpY2llbnQgSlNPTiBkZWVwIGNsb25lLi4uCgkgIGlmIChvYmopIHJldHVybiBKU09OLnBhcnNlKCgwLCBfc3RyaW5naWZ5Mi5kZWZhdWx0KShvYmopKTsKCX0KCgkvKioKCSAqIE9idGFpbnMgdGhlIHVzZXIgVVJMIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBlbWFpbAoJICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKCSAqIEByZXR1cm4ge1VSTC5VUkx9IHVzZXJVUkwgVGhlIHVzZXIgVVJMCgkgKi8KCWZ1bmN0aW9uIGdldFVzZXJVUkxGcm9tRW1haWwodXNlckVtYWlsKSB7CgkgIHZhciBpbmRleE9mQXQgPSB1c2VyRW1haWwuaW5kZXhPZignQCcpOwoJICByZXR1cm4gJ3VzZXI6Ly8nICsgdXNlckVtYWlsLnN1YnN0cmluZyhpbmRleE9mQXQgKyAxLCB1c2VyRW1haWwubGVuZ3RoKSArICcvJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoMCwgaW5kZXhPZkF0KTsKCX0KCgkvKioKCSAqIE9idGFpbnMgdGhlIHVzZXIgZW1haWwgdGhhdCBjb3JyZXNwb25kcyB0byBhIGdpdmVuIFVSTAoJICogQHBhcmFtICB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKCSAqIEByZXR1cm4ge3N0cmluZ30gdXNlckVtYWlsIFRoZSB1c2VyIGVtYWlsCgkgKi8KCWZ1bmN0aW9uIGdldFVzZXJFbWFpbEZyb21VUkwodXNlclVSTCkgewoJICB2YXIgdXJsID0gZGl2aWRlVVJMKHVzZXJVUkwpOwoJICByZXR1cm4gdXJsLmlkZW50aXR5LnJlcGxhY2UoJy8nLCAnJykgKyAnQCcgKyB1cmwuZG9tYWluOyAvLyBpZGVudGl0eSBmaWVsZCBoYXMgJy9leGFtcGxlSUQnIGluc3RlYWQgb2YgJ2V4YW1wbGVJRCcKCX0KCgkvKioKCSAqIENoZWNrIGlmIHRoZSB1c2VyIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgVVJMIGZvcm1hdCwgaWYgbm90LCBjb252ZXJ0IHRvIFVSTCBmb3JtYXQKCSAqIEBwYXJhbSAge3N0cmluZ30gICBpZGVudGlmaWVyICB1c2VyIGlkZW50aWZpZXIKCSAqIEByZXR1cm4ge3N0cmluZ30gICB1c2VyVVJMICAgIHRoZSB1c2VyIFVSTAoJICovCglmdW5jdGlvbiBjb252ZXJ0VG9Vc2VyVVJMKGlkZW50aWZpZXIpIHsKCgkgIC8vIGNoZWNrIGlmIHRoZSBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIHVybCBmb3JtYXQKCSAgaWYgKGlkZW50aWZpZXIuc3Vic3RyaW5nKDAsIDcpID09PSAndXNlcjovLycpIHsKCSAgICB2YXIgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChpZGVudGlmaWVyKTsKCgkgICAgLy9jaGVjayBpZiB0aGUgdXJsIGlzIHdlbGwgZm9ybWF0ZWQKCSAgICBpZiAoZGl2aWRlZFVSTC5kb21haW4gJiYgZGl2aWRlZFVSTC5pZGVudGl0eSkgewoJICAgICAgcmV0dXJuIGlkZW50aWZpZXI7CgkgICAgfSBlbHNlIHsKCSAgICAgIHRocm93ICd1c2VyVVJMIHdpdGggd3JvbmcgZm9ybWF0JzsKCSAgICB9CgoJICAgIC8vaWYgbm90LCBjb252ZXJ0IHRoZSB1c2VyIGVtYWlsIHRvIFVSTCBmb3JtYXQKCSAgfSBlbHNlIHsKCSAgICByZXR1cm4gZ2V0VXNlclVSTEZyb21FbWFpbChpZGVudGlmaWVyKTsKCSAgfQoJfQoKCS8qKiovIH0pLAoJLyogMTEwICovLAoJLyogMTExICovLAoJLyogMTEyICovLAoJLyogMTEzICovLAoJLyogMTE0ICovLAoJLyogMTE1ICovLAoJLyogMTE2ICovLAoJLyogMTE3ICovLAoJLyogMTE4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gICAgIHByb3h5LW9ic2VydmUgdjAuMC4xOA0KCS8vICAgICBDb3B5cmlnaHQgKGMpIDIwMTUsIDIwMTYgU2ltb24gWS4gQmxhY2t3ZWxsLCBBbnlXaGljaFdheQ0KCS8vICAgICBNSVQgTGljZW5zZSAtIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHANCgkoZnVuY3Rpb24oKSB7DQoJCSJ1c2Ugc3RyaWN0IjsNCgkJLy8gQ3JlYXRlcyBhbmQgcmV0dXJucyBhIFByb3h5IHdyYXBwaW5nIGEgdGFyZ2V0IHNvIHRoYXQgYWxsIGNoYW5nZXMgY2FuIGJlIHRyYXBwZWQgYW5kIGZvcndhcmRlZCB0bw0KCQkvLyBhIGNhbGxiYWNrLiBUaGUgY2FsbGJhY2sgdGFrZXMgYW4gYXJyYXkgb2YgY2hhbmdlcyBqdXN0IGxpa2UgdGhlIHRyYWRpdGlvbmFsIG9yaWdpbmFsIENocm9tZSBPYmplY3Qub2JzZXJ2ZQ0KCQkvLyB7b2JqZWN0OjxvYmplY3QgY2hhbmdlZD4sbmFtZTo8ZmllbGQgY2hhbmdlZD4sdHlwZTphZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUsb2xkVmFsdWU6PG9sZCB2YWx1ZSBpZiB1cGRhdGUgfCBkZWxldGU+fQ0KCQkvLyBUaGUgYWNjZXB0bGlzdCBjYW4gYmUgYWRkfHVwZGF0ZXxkZWxldGV8cmVjb25maWd1cmV8cHJldmVudEV4dGVuc2lvbnN8c2V0UHJvdG90eXBlLg0KCQkvLyB2IDAuMC4xMCB0byBzdXBwb3J0IHBhdXNpbmcgYW5kIHJlc3RhcnRpbmcgb2JzZXJ2YXRpb24gdHdvIGFkZGl0aW9uYWwgY29uc3RydWN0b3IgYXJndW1lbnRzIGFyZSBhdmFpbGFibGUgdG8gT2JqZWN0Lm9ic2VydmU6DQoJCS8vIHBhdXNhYmxlIC0gY3JlYXRlIHRoZSBPYnNlcnZlciBzbyBpdCBjYW4gYmUgcGF1c2VkDQoJCS8vIHBhdXNlIC0gY3JlYXRlIG9ic2VydmVyIGluIHBhdXNlZCBzdGF0ZQ0KCQkvLyBpZiBwYXVzYWJsZSBpcyB0cnVlIHRoZW4gYW4gYWRkaXRpb25hbCBtZXRob2QgZGVsaXZlcihpZ25vcmVQcmV2aW91cykgaXMgYXZhaWxhYmxlIHRvIHN0YXJ0IGRlbGl2ZXJ5DQoJCS8vIHRvIHBhdXNlIGRlbGl2ZXJ5IHNldCBhIHByb3BlcnR5IGNhbGxlZCBwYXVzZSBvbiB0aGUgZnVuY3Rpb24gZGVsaXZlciB0byB0cnVlDQoJCS8vIHBhdXNhYmxlIGlzIG9wdGlvbmFsIHRvIHJlZHVjZSB0aGUgY2hhbmNlIG9mIHNoYWRvd2luZyBhIHByb3BlcnR5IG9yIG1ldGhvZCBvbiBhbnkgZXhpc3RpbmcgY29kZSBjYWxsZWQgZGVsaXZlcg0KCQlpZighT2JqZWN0Lm9ic2VydmUgJiYgdHlwZW9mKFByb3h5KT09PSJmdW5jdGlvbiIpIHsNCgkJCWZ1bmN0aW9uIE9ic2VydmVyKHRhcmdldCxjYWxsYmFjayxhY2NlcHRsaXN0LHBhdXNhYmxlLHBhdXNlLGRlbGF5KSB7DQoJCSAgICAJdmFyIG1lID0gdGhpcywgcHJveHk7DQoJCSAgICAJZnVuY3Rpb24gZGVsaXZlcihpZ25vcmVQcmV2aW91cyxkZWxheSkgew0KCQkgICAgCQlkZWxpdmVyLmRlbGF5ID0gZGVsYXk7DQoJCSAgICAJCWlmKCFkZWxpdmVyLnBhdXNlKSB7DQoJCSAgICAgICAgCQlpZihtZS5jaGFuZ2VzZXQubGVuZ3RoPjApIHsNCgkJICAgICAgICAJCQlpZighaWdub3JlUHJldmlvdXMpIHsNCgkJCSAgICAJICAgIAkJdmFyIGNoYW5nZXMgPSBtZS5jaGFuZ2VzZXQuZmlsdGVyKGZ1bmN0aW9uKGNoYW5nZSkgeyByZXR1cm4gIWFjY2VwdGxpc3QgfHwgYWNjZXB0bGlzdC5pbmRleE9mKGNoYW5nZS50eXBlKT49MDsgfSk7DQoJCQkgICAgICAgIAkJCWlmKGNoYW5nZXMubGVuZ3RoPjApIHsNCgkJCSAgICAgICAgCQkJCWNhbGxiYWNrKGNoYW5nZXMpOw0KCQkJICAgICAgICAJCQl9DQoJCSAgICAgICAgCQkJfQ0KCQkgICAgICAgIAkJCW1lLmNoYW5nZXNldCA9IFtdOw0KCQkgICAgICAgIAkJfQ0KCQkgICAgCQl9DQoJCSAgICAJfQ0KCQkgICAgCWRlbGl2ZXIucGF1c2UgPSBwYXVzZTsNCgkJICAgIAlkZWxpdmVyLmRlbGF5ID0gZGVsYXk7DQoJCQkgICAgbWUuZ2V0ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSkgew0KCQkJICAgIAlpZihwcm9wZXJ0eT09PSJfX29ic2VydmVyX18iKSB7DQoJCQkgICAgCQlyZXR1cm4gbWU7DQoJCQkgICAgCX0NCgkJCSAgICAJaWYocHJvcGVydHk9PT0idW5vYnNlcnZlIikgew0KCQkJICAgIAkJcmV0dXJuIGZ1bmN0aW9uKCkgew0KCQkJICAgIAkJCU9iamVjdC51bm9ic2VydmUodGFyZ2V0KTsNCgkJCSAgICAJCQlyZXR1cm4gdGFyZ2V0Ow0KCQkJICAgIAkJfTsNCgkJCSAgICAJfQ0KCQkJICAgIAlpZihwcm9wZXJ0eT09PSJkZWxpdmVyIikgew0KCQkJICAgIAkJcmV0dXJuIGRlbGl2ZXI7DQoJCQkgICAgCX0NCgkJCSAgICAJcmV0dXJuIHRhcmdldFtwcm9wZXJ0eV07DQoJCQkgICAgfQ0KCQkgICAgCW1lLnRhcmdldCA9IHRhcmdldDsNCgkJICAgIAltZS5jaGFuZ2VzZXQgPSBbXTsNCgkJICAgIAlpZighbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXykgew0KCQkgICAgCQkvLyBfX29ic2VydmVyQ2FsbGJhY2tzX18gaXMgdXNlZCBhcyBhbiBpbmRleCB0byBnZXQgYXQgdGhlIHByb3h5IHdoaWNoIGlzIHRoZSBvYnNlcnZlciwgc28gd2UgY2FuIHVub2JzZXJ2ZQ0KCQkgICAgCQlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCJfX29ic2VydmVyQ2FsbGJhY2tzX18iLHtlbnVtZXJhYmxlOmZhbHNlLGNvbmZpZ3VyYWJsZTp0cnVlLHdyaXRhYmxlOmZhbHNlLHZhbHVlOltdfSk7DQoJCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJzX18iLHtlbnVtZXJhYmxlOmZhbHNlLGNvbmZpZ3VyYWJsZTp0cnVlLHdyaXRhYmxlOmZhbHNlLHZhbHVlOltdfSk7DQoJCSAgICAJfQ0KCQkgICAgCW1lLnRhcmdldC5fX29ic2VydmVyQ2FsbGJhY2tzX18ucHVzaChjYWxsYmFjayk7DQoJCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJzX18ucHVzaCh0aGlzKTsNCgkJICAgIAlwcm94eSA9IG5ldyBQcm94eSh0YXJnZXQsbWUpOw0KCQkgICAgCWRlbGl2ZXIoZmFsc2UsZGVsYXkpOw0KCQkgICAgCXJldHVybiBwcm94eTsNCgkJICAgIH0NCgkJCU9ic2VydmVyLnByb3RvdHlwZS5kZWxpdmVyID0gZnVuY3Rpb24oKSB7DQoJCQkJcmV0dXJuIHRoaXMuZ2V0KG51bGwsImRlbGl2ZXIiKTsNCgkJCX0NCgkJICAgIE9ic2VydmVyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih0YXJnZXQsIHByb3BlcnR5LCB2YWx1ZSkgeyAvLyAsIHJlY2VpdmVyDQoJCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsNCgkJICAgIAl2YXIgdHlwZSA9IChvbGR2YWx1ZT09PXVuZGVmaW5lZCA/ICJhZGQiIDogInVwZGF0ZSIpOw0KCQkgICAgCXRhcmdldFtwcm9wZXJ0eV0gPSB2YWx1ZTsNCgkJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICghdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKHR5cGUpPj0wKSkgew0KCQkgICAgICAgIAl2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsbmFtZTpwcm9wZXJ0eSx0eXBlOnR5cGV9LA0KCQkgICAgICAgIAkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsDQoJCSAgICAgICAgCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7DQoJCSAgICAgICAgCWlmKHR5cGU9PT0idXBkYXRlIikgew0KCQkgICAgICAgIAkJY2hhbmdlLm9sZFZhbHVlID0gb2xkdmFsdWU7DQoJCSAgICAgICAgCX0NCgkJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCQkgICAgICAgIAlpZihzdGFydCkgew0KCQkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkJICAgICAgICAJfQ0KCQkgICAgCX0NCgkJICAgIAlyZXR1cm4gdHJ1ZTsNCgkJICAgIH07DQoJCSAgICBPYnNlcnZlci5wcm90b3R5cGUuZGVsZXRlUHJvcGVydHkgPSBmdW5jdGlvbih0YXJnZXQsIHByb3BlcnR5KSB7DQoJCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsNCgkJICAgIAkvL2lmKHR5cGVvZihvbGR2YWx1ZSkhPT0idW5kZWZpbmVkIikgew0KCQkJICAgIAlkZWxldGUgdGFyZ2V0W3Byb3BlcnR5XTsNCgkJCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJkZWxldGUiKT49MCkgew0KCQkJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZToiZGVsZXRlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sDQoJCQkgICAgICAgIAkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsDQoJCQkgICAgICAgIAkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOw0KCQkJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCQkJICAgICAgICAJaWYoc3RhcnQpIHsNCgkJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOw0KCQkJICAgICAgICAJfQ0KCQkJICAgIAl9DQoJCSAgICAJLy99DQoJCSAgICAJcmV0dXJuIHRydWU7DQoJCSAgICB9Ow0KCQkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcikgew0KCQkgICAgCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5LCBkZXNjcmlwdG9yKTsNCgkJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInJlY29uZmlndXJlIik+PTApIHsNCgkJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZToicmVjb25maWd1cmUifSwNCgkgICAgICAgIAkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLA0KCSAgICAgICAgCQkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOw0KCQkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7DQoJCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOw0KCQkgICAgICAgIAl9DQoJCSAgICAJfQ0KCQkgICAgCXJldHVybiB0cnVlOw0KCQkgICAgfTsNCgkJICAgIE9ic2VydmVyLnByb3RvdHlwZS5zZXRQcm90b3R5cGVPZiA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvdG90eXBlKSB7DQoJCSAgICAJdmFyIG9sZHZhbHVlID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHRhcmdldCk7DQoJCSAgICAJT2JqZWN0LnNldFByb3RvdHlwZU9mKHRhcmdldCwgcHJvdG90eXBlKTsNCgkJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInNldFByb3RvdHlwZSIpPj0wKSB7DQoJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOiJfX3Byb3RvX18iLHR5cGU6InNldFByb3RvdHlwZSIsb2xkVmFsdWU6b2xkdmFsdWV9LA0KCSAgICAJCQkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsDQoJICAgIAkJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7DQoJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsNCgkJICAgICAgICAJaWYoc3RhcnQpIHsNCgkJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJCSAgICAgICAgCX0NCgkJICAgIAl9DQoJCSAgICAJcmV0dXJuIHRydWU7DQoJCSAgICB9Ow0KCQkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnByZXZlbnRFeHRlbnNpb25zID0gZnVuY3Rpb24odGFyZ2V0KSB7DQoJCSAgICAgICAgT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKHRhcmdldCk7DQoJCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJwcmV2ZW50RXh0ZW5zaW9ucyIpPj0wKSB7DQoJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCx0eXBlOiJwcmV2ZW50RXh0ZW5zaW9ucyJ9LA0KCQkJCQkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsDQoJCQkJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7DQoJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsNCgkJICAgICAgICAJaWYoc3RhcnQpIHsNCgkJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJCSAgICAgICAgCX0NCgkJICAgIAl9DQoJCSAgICAJcmV0dXJuIHRydWU7DQoJCSAgICB9Ow0KCQkgICAgT2JqZWN0Lm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgew0KCQkgICAgCXJldHVybiBuZXcgT2JzZXJ2ZXIob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpOw0KCQkgICAgfTsNCgkJICAgIE9iamVjdC51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsNCgkJICAgIAlpZihvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fKSB7DQoJCSAgICAJCWlmKCFjYWxsYmFjaykgew0KCQkgICAgCQkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5zcGxpY2UoMCxvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLmxlbmd0aCk7DQoJCSAgICAJCQlvYmplY3QuX19vYnNlcnZlcnNfXy5zcGxpY2UoMCxvYmplY3QuX19vYnNlcnZlcnNfXy5sZW5ndGgpOw0KCQkgICAgCQkJcmV0dXJuOw0KCQkgICAgCQl9DQoJCSAgICAJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uZm9yRWFjaChmdW5jdGlvbihvYnNlcnZlcmNhbGxiYWNrLGkpIHsNCgkJICAgIAkJCWlmKGNhbGxiYWNrPT09b2JzZXJ2ZXJjYWxsYmFjaykgew0KCQkgICAgCQkJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uc3BsaWNlKGksMSk7DQoJCSAgICAJCQkJZGVsZXRlIG9iamVjdC5fX29ic2VydmVyc19fW2ldLmNhbGxiYWNrOw0KCQkgICAgCQkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZShpLDEpOw0KCQkgICAgCQkJfQ0KCQkgICAgCQl9KTsNCgkJICAgIAl9DQoJCSAgICB9Ow0KCQkgICAgQXJyYXkub2JzZXJ2ZSA9IGZ1bmN0aW9uKG9iamVjdCxjYWxsYmFjayxhY2NlcHRsaXN0LHBhdXNhYmxlLHBhdXNlLGRlbGF5KSB7DQoJCSAgICAJaWYoIShvYmplY3QgaW5zdGFuY2VvZiBBcnJheSkgJiYgIUFycmF5LmlzQXJyYXkob2JqZWN0KSkgew0KCQkgICAgCQl0aHJvdyBuZXcgVHlwZUVycm9yKCJGaXJzdCBhcmd1bWVudCB0byBBcnJheS5vYnNlcnZlciBpcyBub3QgYW4gQXJyYXkiKTsNCgkJICAgIAl9DQoJICAgICAgICAgICAgCWFjY2VwdGxpc3QgPSBhY2NlcHRsaXN0IHx8IFsiYWRkIiwgInVwZGF0ZSIsICJkZWxldGUiLCAic3BsaWNlIl07DQoJCSAgICAJdmFyIGFycmF5cHJveHkgPSBuZXcgUHJveHkob2JqZWN0LHtnZXQ6IGZ1bmN0aW9uKHRhcmdldCxwcm9wZXJ0eSkgew0KCQkgICAgCQlpZihwcm9wZXJ0eT09PSJ1bm9ic2VydmUiKSB7DQoJCQkgICAgCQlyZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2spIHsNCgkJCSAgICAJCQlpZihjYWxsYmFjaykgew0KCQkJICAgIAkJCQlyZXR1cm4gT2JqZWN0LnVub2JzZXJ2ZSh0YXJnZXQsY2FsbGJhY2spOw0KCQkJICAgIAkJCX0NCgkJCSAgICAJCQlyZXR1cm4gdGFyZ2V0LnVub2JzZXJ2ZSgpOw0KCQkJICAgIAkJfTsNCgkJCSAgICAJfQ0KCQkgICAgCQlpZihwcm9wZXJ0eT09PSJzcGxpY2UiKSB7DQoJCSAgICAJCQlyZXR1cm4gZnVuY3Rpb24oc3RhcnQsZW5kKSB7DQoJCSAgICAJCQkJaWYodHlwZW9mKHN0YXJ0KSE9PSJudW1iZXIiIHx8IHR5cGVvZihlbmQpIT09Im51bWJlciIpIHsNCgkJICAgIAkJCQkJdGhyb3cgbmV3IFR5cGVFcnJvcigiRmlyc3QgdHdvIGFyZ3VtZW50cyB0byBBcnJheSBzcGxpY2UgYXJlIG5vdCBudW1iZXIsIG51bWJlciIpOw0KCQkgICAgCQkJCX0NCgkJICAgIAkgICAgCQl2YXIgcmVtb3ZlZCA9IHRoaXMuc2xpY2Uoc3RhcnQsc3RhcnQrZW5kKSwNCgkJICAgIAkgICAgCQkJYWRkZWRDb3VudCA9IChhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50cy5sZW5ndGgtMiA6IDApLA0KCQkgICAgCSAgICAJCQljaGFuZ2UgPSAge29iamVjdDpvYmplY3QsdHlwZToic3BsaWNlIixpbmRleDpzdGFydCxyZW1vdmVkOnJlbW92ZWQsYWRkZWRDb3VudDphZGRlZENvdW50fTsNCgkJICAgIAkgICAgCQl0YXJnZXQuc3BsaWNlLmFwcGx5KHRhcmdldCxhcmd1bWVudHMpOw0KCQkgICAgCSAgICAJCWlmKGFjY2VwdGxpc3QuaW5kZXhPZigic3BsaWNlIik+PTApIHsNCgkJICAgIAkgICAgCQkJdmFyIHN0YXJ0ID0gcHJveHkuX19vYnNlcnZlcl9fLmNoYW5nZXNldC5sZW5ndGggPT09IDAsDQoJCSAgICAJICAgICAgICAJCQlkZWxpdmVyID0gcHJveHkuX19vYnNlcnZlcl9fLmRlbGl2ZXIoKTsNCgkJICAgIAkgICAgCQkJcHJveHkuX19vYnNlcnZlcl9fLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7DQoJCSAgICAJICAgIAkJCWlmKHN0YXJ0KSB7DQoJCSAgICAJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOw0KCQkgICAgCQkgICAgICAgIAl9DQoJCSAgICAJICAgIAkJfQ0KCQkgICAgCSAgICAJfQ0KCQkgICAgCQl9DQoJCSAgICAJCWlmKHByb3BlcnR5PT09InB1c2giKSB7DQoJCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHsNCgkJICAgIAkJICAgIAlyZXR1cm4gdGhpcy5zcGxpY2UodGhpcy5sZW5ndGgsMCxpdGVtKTsNCgkJICAgIAkJICAgIH0NCgkJICAgIAkJfQ0KCQkgICAgCQlpZihwcm9wZXJ0eT09PSJwb3AiKSB7DQoJCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKCkgew0KCQkgICAgCQkgICAgCXJldHVybiB0aGlzLnNwbGljZSh0aGlzLmxlbmd0aC0xLDEpOw0KCQkgICAgCQkgICAgfQ0KCQkgICAgCQl9DQoJCSAgICAJCWlmKHByb3BlcnR5PT09InVuc2hpZnQiKSB7DQoJCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHsNCgkgICAgCQkgICAgCQlyZXR1cm4gdGhpcy5zcGxpY2UoMCwwLGl0ZW0pOw0KCSAgICAJCSAgICAJfQ0KCQkgICAgCQl9DQoJCSAgICAJCWlmKHByb3BlcnR5PT09InNoaWZ0Iikgew0KCQkgICAgCQkJcmV0dXJuIGZ1bmN0aW9uKCkgew0KCQkgICAgCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDEpOw0KCQkgICAgCSAgICAJfQ0KCQkgICAgCQl9DQoJCSAgICAJCXJldHVybiB0YXJnZXRbcHJvcGVydHldOw0KCQkgICAgCX19KTsNCgkJICAgIAl2YXIgcHJveHkgPSBPYmplY3Qub2JzZXJ2ZShhcnJheXByb3h5LGZ1bmN0aW9uKGNoYW5nZXNldCkgeyANCgkJICAgIAkJdmFyIGNoYW5nZXMgPSBjaGFuZ2VzZXQuZmlsdGVyKGZ1bmN0aW9uKGNoYW5nZSkgeyByZXR1cm4gY2hhbmdlLm5hbWUhPT0ibGVuZ3RoIiAmJiBjaGFuZ2UubmFtZSE9PSJhZGQiICYmICghYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wKTsgfSk7DQoJCSAgICAJCWlmKGNoYW5nZXMubGVuZ3RoPjApIHsNCgkJICAgIAkJCWNhbGxiYWNrKGNoYW5nZXMpOw0KCQkgICAgCQl9DQoJCSAgICAJfSxhY2NlcHRsaXN0LHBhdXNhYmxlLHBhdXNlLGRlbGF5KTsNCgkJICAgIAlyZXR1cm4gcHJveHk7DQoJCSAgICB9Ow0KCQkgICAgQXJyYXkudW5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrKSB7DQoJCQkgIHJldHVybiBvYmplY3QudW5vYnNlcnZlKGNhbGxiYWNrKTsNCgkJICAgIH0NCgkJfQ0KCQlPYmplY3QuZGVlcE9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2sscGFydHMpIHsNCg0KCQkJcGFydHMgPSAocGFydHMgPyBwYXJ0cyA6IFtdKTsNCg0KCQkJdmFyIHRvVHlwZU5hbWUgPSBmdW5jdGlvbihvYmopIHsNCgkJCQlyZXR1cm4gKHt9KS50b1N0cmluZy5jYWxsKG9iaikubWF0Y2goL1xzKFthLXpBLVpdKykvKVsxXS50b0xvd2VyQ2FzZSgpDQoJCQl9DQoNCgkJCWZ1bmN0aW9uIHJlb2JzZXJ2ZSh2YWx1ZSwgcGFydHMpIHsNCgkJCQl2YXIga2V5cyA9IE9iamVjdC5rZXlzKHZhbHVlKTsNCgkJCQlrZXlzLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7DQoJCQkJCWlmKCh0b1R5cGVOYW1lKHZhbHVlW2tleV0pID09PSAnb2JqZWN0JyB8fCB0b1R5cGVOYW1lKHZhbHVlW2tleV0pID09PSAnYXJyYXknKSAmJiAhdmFsdWVba2V5XS5oYXNPd25Qcm9wZXJ0eSgnX19vYnNlcnZlcnNfXycpKSB7DQoJCQkJCQl2YXIgbmV3cGFydHMgPSBwYXJ0cy5zbGljZSgwKTsNCgkJCQkJCW5ld3BhcnRzLnB1c2goa2V5KTsNCgkJCQkJCXZhbHVlW2tleV0gPSBPYmplY3QuZGVlcE9ic2VydmUodmFsdWVba2V5XSxjYWxsYmFjayxuZXdwYXJ0cyk7DQoJCQkJCX0NCgkJCQl9KTsNCgkJCX0NCg0KCQkJcmVvYnNlcnZlKG9iamVjdCwgcGFydHMpOw0KDQoJCQl2YXIgb2JzZXJ2ZWQgPSBPYmplY3Qub2JzZXJ2ZShvYmplY3QsZnVuY3Rpb24oY2hhbmdlc2V0KSB7DQoJCQkJdmFyIGNoYW5nZXMgPSBbXTsNCgkJCQlmdW5jdGlvbiByZWN1cnNlKG5hbWUscm9vdE9iamVjdCxvbGRPYmplY3QsbmV3T2JqZWN0LHBhdGgpIHsNCgkJCQkJaWYobmV3T2JqZWN0IGluc3RhbmNlb2YgT2JqZWN0KSB7DQoJCQkJCQl2YXIgbmV3a2V5cyA9IE9iamVjdC5rZXlzKG5ld09iamVjdCk7DQoJCQkJCQluZXdrZXlzLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7DQoJCQkJCQkJaWYoIW9sZE9iamVjdCB8fCAob2xkT2JqZWN0W2tleV0hPT1uZXdPYmplY3Rba2V5XSkpIHsNCgkJCQkJCQkJdmFyIG9sZHZhbHVlID0gKG9sZE9iamVjdCAmJiBvbGRPYmplY3Rba2V5XSE9PXVuZGVmaW5lZCA/IG9sZE9iamVjdFtrZXldIDogdW5kZWZpbmVkKSwNCgkJCQkJCQkJCWNoYW5nZSA9IChvbGR2YWx1ZT09PXVuZGVmaW5lZCA/ICJhZGQiIDogInVwZGF0ZSIpLA0KCQkJCQkJCQkJa2V5cGF0aCA9IHBhdGggKyAiLiIgKyBrZXk7DQoNCgkJCQkJCQkJY2hhbmdlcy5wdXNoKHtuYW1lOm5hbWUsb2JqZWN0OnJvb3RPYmplY3QsdHlwZTpjaGFuZ2Usb2xkVmFsdWU6b2xkdmFsdWUsbmV3VmFsdWU6bmV3T2JqZWN0W2tleV0sa2V5cGF0aDprZXlwYXRofSk7DQoJCQkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZHZhbHVlLG5ld09iamVjdFtrZXldLGtleXBhdGgpOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9IGVsc2UgaWYob2xkT2JqZWN0IGluc3RhbmNlb2YgT2JqZWN0KSB7DQoJCQkJCQl2YXIgb2xka2V5cyA9IE9iamVjdC5rZXlzKG9sZE9iamVjdCk7DQoJCQkJCQlvbGRrZXlzLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7DQoJCQkJCQkJdmFyIGNoYW5nZSA9IChuZXdPYmplY3Q9PT1udWxsID8gInVwZGF0ZSIgOiAiZGVsZXRlIiksDQoJCQkJCQkJCWtleXBhdGggPSBwYXRoICsgIi4iICsga2V5Ow0KCQkJCQkJCQkNCgkJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGRPYmplY3Rba2V5XSxuZXdWYWx1ZTpuZXdPYmplY3Qsa2V5cGF0aDprZXlwYXRofSk7DQoJCQkJCQkJcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0W2tleV0sdW5kZWZpbmVkLGtleXBhdGgpOw0KCQkJCQkJfSk7DQoJCQkJCX0NCgkJCQl9DQoJCQkJY2hhbmdlc2V0LmZvckVhY2goZnVuY3Rpb24oY2hhbmdlKSB7DQoJCQkJCXZhciBrZXlwYXRoID0gKHBhcnRzLmxlbmd0aD4wID8gcGFydHMuam9pbigiLiIpICsgIi4iIDogIiIpICsgY2hhbmdlLm5hbWU7DQoNCgkJCQkJaWYgKGNoYW5nZS50eXBlID09PSAidXBkYXRlIiB8fCBjaGFuZ2UudHlwZSA9PT0gImFkZCIpIHsgDQoJCQkJCQlyZW9ic2VydmUoY2hhbmdlLm9iamVjdCwgcGFydHMpOw0KCQkJCQl9DQoNCgkJCQkJY2hhbmdlcy5wdXNoKHtuYW1lOmNoYW5nZS5uYW1lLG9iamVjdDpjaGFuZ2Uub2JqZWN0LHR5cGU6Y2hhbmdlLnR5cGUsb2xkVmFsdWU6Y2hhbmdlLm9sZFZhbHVlLG5ld1ZhbHVlOmNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGg6a2V5cGF0aH0pOw0KCQkJCQlyZWN1cnNlKGNoYW5nZS5uYW1lLGNoYW5nZS5vYmplY3QsY2hhbmdlLm9sZFZhbHVlLGNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGgpOw0KCQkJCX0pOw0KCQkJCWNhbGxiYWNrKGNoYW5nZXMpOw0KCQkJfSk7DQoJCQlyZXR1cm4gb2JzZXJ2ZWQ7DQoJCX07DQoJfSkoKTsNCgoKCS8qKiovIH0pLAoJLyogMTE5ICovLAoJLyogMTIwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCgl2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgoJdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKCXZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7CgoJdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgoJdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpOwoKCXZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMik7CgoJdmFyIF9nZXQyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjUpOwoKCXZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKCXZhciBfaW5oZXJpdHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNCk7CgoJdmFyIF9pbmhlcml0czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbmhlcml0czIpOwoKCXZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMik7CgoJdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCgl2YXIgX0RhdGFPYmplY3RDaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCgl2YXIgX0RhdGFPYmplY3RDaGlsZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Q2hpbGQpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLyoqCgkqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoJKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoJKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKCSogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKCSogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCgkqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKCSogQ29weXJpZ2h0IDIwMTYgQXBpemVlCgkqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCgkqCgkqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJKgoJKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJKgoJKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJKiovCgoJdmFyIEZpbHRlclR5cGUgPSB7IEFOWTogJ2FueScsIFNUQVJUOiAnc3RhcnQnLCBFWEFDVDogJ2V4YWN0JyB9OwoKCS8qKgoJICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgc3Vic2NyaWJlIGNhbGwuCgkgKiBUbyBiZSB1c2VkIGFzIGFuIG9ic2VydmF0aW9uIHBvaW50IGZyb20gYSBEYXRhT2JqZWN0UmVwb3J0ZXIgY2hhbmdlLgoJICovCgoJdmFyIERhdGFPYmplY3RPYnNlcnZlciA9IGZ1bmN0aW9uIChfRGF0YU9iamVjdCkgewoJICAoMCwgX2luaGVyaXRzMy5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIsIF9EYXRhT2JqZWN0KTsKCgkgIC8qIHByaXZhdGUKCSAgX2NoYW5nZUxpc3RlbmVyOiBNc2dMaXN0ZW5lcgoJICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQoJICBfZmlsdGVyczogezxmaWx0ZXI+OiB7dHlwZTogPHN0YXJ0LCBleGFjdD4sIGNhbGxiYWNrOiA8ZnVuY3Rpb24+fSB9CgkgICovCgoJICAvKioKCSAgICogQGlnbm9yZQoJICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlci5zdWJzY3JpYmUgbWV0aG9kCgkgICAqLwoKCSAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQoJICBmdW5jdGlvbiBEYXRhT2JqZWN0T2JzZXJ2ZXIoc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlbnMsIGluaXRpYWxWZXJzaW9uLCBtdXR1YWwpIHsKCSAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBEYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKCSAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdE9ic2VydmVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YS5kYXRhLCBjaGlsZHJlbnMsIG11dHVhbCkpOwoKCSAgICB2YXIgX3RoaXMgPSBfdGhpczI7CgoJICAgIF90aGlzLl92ZXJzaW9uID0gaW5pdGlhbFZlcnNpb247CgkgICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCgkgICAgX3RoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKCSAgICAgIF90aGlzLl9vbkZpbHRlcihldmVudCk7CgkgICAgfSk7CgoJICAgIC8vc2V0dXAgY2hpbGRyZW5zIGRhdGEgZnJvbSBzdWJzY3JpcHRpb24KCSAgICAoMCwgX2tleXMyLmRlZmF1bHQpKGluaXRpYWxEYXRhLmNoaWxkcmVucykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRJZCkgewoJICAgICAgdmFyIGNoaWxkRGF0YSA9IGluaXRpYWxEYXRhLmNoaWxkcmVuc1tjaGlsZElkXTsKCSAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF0gPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpcywgY2hpbGRJZCwgY2hpbGREYXRhKTsKCSAgICB9KTsKCgkgICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CgkgICAgcmV0dXJuIF90aGlzMjsKCSAgfQoKCSAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBbewoJICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKCSAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCArICcvY2hhbmdlcycsIGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgICAgaWYgKG1zZy50eXBlID09PSAndXBkYXRlJykgewoJICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0T2JzZXJ2ZXItJyArIF90aGlzLl91cmwgKyAnLVJDVjogJywgbXNnKTsKCSAgICAgICAgICBfdGhpcy5fY2hhbmdlT2JqZWN0KF90aGlzLl9zeW5jT2JqLCBtc2cpOwoJICAgICAgICB9CgkgICAgICB9KTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewoJICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIucmVtb3ZlKCk7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdkZWxldGUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwoJICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICd1bnN1YnNjcmliZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIHVuc3Vic2NyaWJlKCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsVW5TdWJzY3JpYmUKCSAgICAgIHZhciB1blN1YnNjcmliZU1zZyA9IHsKCSAgICAgICAgdHlwZTogJ3Vuc3Vic2NyaWJlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCwKCSAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CgkgICAgICB9OwoKCSAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UodW5TdWJzY3JpYmVNc2csIGZ1bmN0aW9uIChyZXBseSkgewoJICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdE9ic2VydmVyLVVOU1VCU0NSSUJFOiAnLCByZXBseSk7CgkgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewoJICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgkgICAgICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogUmVnaXN0ZXIgdGhlIGNoYW5nZSBsaXN0ZW5lcnMgc2VudCBieSB0aGUgcmVwb3J0ZXIKCSAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsdGVyIC0gRmlsdGVyIHRoYXQgaWRlbnRpZmllcyB0aGUgZmllbGQgKHNlcGFyYXRlZCBkb3QgcGF0aCkuIEFjY2VwdHMgKiBhdCB0aGUgZW5kIGZvciBhIG1vcmUgdW5yZXN0cmljdGVkIGZpbHRlcmluZy4KCSAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25DaGFuZ2UnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZShmaWx0ZXIsIGNhbGxiYWNrKSB7CgkgICAgICB2YXIga2V5ID0gZmlsdGVyOwoJICAgICAgdmFyIGZpbHRlck9iaiA9IHsKCSAgICAgICAgdHlwZTogRmlsdGVyVHlwZS5FWEFDVCwKCSAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrCgkgICAgICB9OwoKCSAgICAgIHZhciBpZHggPSBmaWx0ZXIuaW5kZXhPZignKicpOwoJICAgICAgaWYgKGlkeCA9PT0gZmlsdGVyLmxlbmd0aCAtIDEpIHsKCSAgICAgICAgaWYgKGlkeCA9PT0gMCkgewoJICAgICAgICAgIGZpbHRlck9iai50eXBlID0gRmlsdGVyVHlwZS5BTlk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgZmlsdGVyT2JqLnR5cGUgPSBGaWx0ZXJUeXBlLlNUQVJUOwoJICAgICAgICAgIGtleSA9IGZpbHRlci5zdWJzdHIoMCwgZmlsdGVyLmxlbmd0aCAtIDEpOwoJICAgICAgICB9CgkgICAgICB9CgoJICAgICAgdGhpcy5fZmlsdGVyc1trZXldID0gZmlsdGVyT2JqOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19vbkZpbHRlcicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZpbHRlcihldmVudCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKF90aGlzLl9maWx0ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKCSAgICAgICAgdmFyIGZpbHRlciA9IF90aGlzLl9maWx0ZXJzW2tleV07CgkgICAgICAgIGlmIChmaWx0ZXIudHlwZSA9PT0gRmlsdGVyVHlwZS5BTlkpIHsKCSAgICAgICAgICAvL21hdGNoIGFueXRoaW5nCgkgICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKCSAgICAgICAgfSBlbHNlIGlmIChmaWx0ZXIudHlwZSA9PT0gRmlsdGVyVHlwZS5TVEFSVCkgewoJICAgICAgICAgIC8vaWYgc3RhcnRzIHdpdGggZmlsdGVyLi4uCgkgICAgICAgICAgaWYgKGV2ZW50LmZpZWxkLmluZGV4T2Yoa2V5KSA9PT0gMCkgewoJICAgICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKCSAgICAgICAgICB9CgkgICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuRVhBQ1QpIHsKCSAgICAgICAgICAvL2V4YWN0IG1hdGNoCgkgICAgICAgICAgaWYgKGV2ZW50LmZpZWxkID09PSBrZXkpIHsKCSAgICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CgkgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICB9KTsKCSAgICB9CgkgIH1dKTsKCSAgcmV0dXJuIERhdGFPYmplY3RPYnNlcnZlcjsKCX0oX0RhdGFPYmplY3QzLmRlZmF1bHQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovKTsKCglleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0T2JzZXJ2ZXI7Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9KSwKCS8qIDEyMSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7CgoJdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKCXZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCgl2YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFByb3RvdHlwZU9mKTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKCXZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7CgoJdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKCXZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KTsKCgl2YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4zID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIpOwoKCXZhciBfZ2V0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTI1KTsKCgl2YXIgX2dldDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXQyKTsKCgl2YXIgX2luaGVyaXRzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpOwoKCXZhciBfaW5oZXJpdHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5oZXJpdHMyKTsKCgl2YXIgX0RhdGFPYmplY3QyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKCXZhciBfRGF0YU9iamVjdDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Mik7CgoJdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA5KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8qKgoJICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgY3JlYXRlIGNhbGwuCgkgKiBUbyBiZSB1c2VkIGFzIGEgcmVwb3J0ZXIgcG9pbnQsIGNoYW5nZXMgd2lsbCBiZSBzdWJtaXRlZCB0byBEYXRhT2JqZWN0T2JzZXJ2ZXIgaW5zdGFuY2VzLgoJICovCgkvKioKCSogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCgkqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoJKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKCSogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSoKCSogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkqCgkqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkqCgkqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkqKi8KCgl2YXIgRGF0YU9iamVjdFJlcG9ydGVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CgkgICgwLCBfaW5oZXJpdHMzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlciwgX0RhdGFPYmplY3QpOwoKCSAgLyogcHJpdmF0ZQoJICBfc3Vic2NyaXB0aW9uczogPGh5cGVydHlVcmw6IHsgc3RhdHVzOiBzdHJpbmcgfSB9PgoJICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQoJICBfb25TdWJzY3JpcHRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKCSAgX29uUmVzcG9uc2VIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKCSAgX29uUmVhZEhhbmRsZXI6IChldmVudCkgPT4gdm9pZAoJICAqLwoKCSAgLyoqCgkgICAqIEBpZ25vcmUKCSAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuY3JlYXRlIG1ldGhvZAoJICAgKi8KCSAgZnVuY3Rpb24gRGF0YU9iamVjdFJlcG9ydGVyKHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSB7CgkgICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdFJlcG9ydGVyKTsKCgkgICAgdmFyIF90aGlzMiA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMuZGVmYXVsdCkodGhpcywgKERhdGFPYmplY3RSZXBvcnRlci5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyKSkuY2FsbCh0aGlzLCBzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykpOwoKCSAgICB2YXIgX3RoaXMgPSBfdGhpczI7CgoJICAgIF90aGlzLl9zdWJzY3JpcHRpb25zID0ge307CgoJICAgIF90aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CgkgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLScgKyB1cmwgKyAnLVNFTkQ6ICcsIGV2ZW50KTsKCSAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCk7CgkgICAgfSk7CgoJICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwoJICAgIHJldHVybiBfdGhpczI7CgkgIH0KCgkgICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlciwgW3sKCSAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CgkgICAgICAoMCwgX2dldDMuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZSksICdfYWxsb2NhdGVMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBfdGhpcy5fb2JqZWN0TGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3QtJyArIF90aGlzLl91cmwgKyAnLVJDVjogJywgbXNnKTsKCSAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewoJICAgICAgICAgIGNhc2UgJ3Jlc3BvbnNlJzoKCSAgICAgICAgICAgIF90aGlzLl9vblJlc3BvbnNlKG1zZyk7YnJlYWs7CgkgICAgICAgICAgY2FzZSAncmVhZCc6CgkgICAgICAgICAgICBfdGhpcy5fb25SZWFkKG1zZyk7YnJlYWs7CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CgkgICAgICAoMCwgX2dldDMuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZSksICdfcmVsZWFzZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9vYmplY3RMaXN0ZW5lci5yZW1vdmUoKTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFNlbmQgaW52aXRhdGlvbnMgKGNyZWF0ZSBtZXNzYWdlcykgdG8gaHlwZXJ0aWVzLCBvYnNlcnZlcnMgbGlzdC4KCSAgICAgKiBAcGFyYW0gIHtIeXBlcnR5VVJMW119IG9ic2VydmVycyBMaXN0IG9mIEh5cGVydHkgVVJMJ3MKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdpbnZpdGVPYnNlcnZlcnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBpbnZpdGVPYnNlcnZlcnMob2JzZXJ2ZXJzKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uQ3JlYXRlCgkgICAgICB2YXIgaW52aXRlTXNnID0gewoJICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMuX3N5bmNoZXIuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCwKCSAgICAgICAgYm9keTogeyByZXN1bWU6IGZhbHNlLCByZXNvdXJjZTogX3RoaXMuX3VybCwgc2NoZW1hOiBfdGhpcy5fc2NoZW1hLCB2YWx1ZTogX3RoaXMuX3N5bmNPYmouZGF0YSwgYXV0aG9yaXNlOiBvYnNlcnZlcnMgfQoJICAgICAgfTsKCgkgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGludml0ZU1zZyk7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdkZWxldGUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkRlbGV0ZQoJICAgICAgdmFyIGRlbGV0ZU1zZyA9IHsKCSAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCgkgICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IF90aGlzLl91cmwgfQoJICAgICAgfTsKCgkgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGRlbGV0ZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0UmVwb3J0ZXItREVMRVRFOiAnLCByZXBseSk7CgkgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewoJICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgkgICAgICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9yZXBvcnRlcnNbX3RoaXMuX3VybF07CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogU3Vic2NyaXB0aW9ucyByZXF1ZXN0ZWQgYW5kIGFjY2VwdGVkIHRvIHRoaXMgcmVwb3J0ZXIKCSAgICAgKiBAdHlwZSB7T2JqZWN0PEh5cGVydHlVUkwsIFN5bmNTdWJzY3JpcHRpb24+fQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ29uU3Vic2NyaXB0aW9uJywKCgoJICAgIC8qKgoJICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHN1YnNjcmliZSBhbmQgdW5zdWJzY3JpYmUgbm90aWZpY2F0aW9ucwoJICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sgZnVuY3Rpb24gdG8gcmVjZWl2ZSBldmVudHMKCSAgICAgKi8KCSAgICB2YWx1ZTogZnVuY3Rpb24gb25TdWJzY3JpcHRpb24oY2FsbGJhY2spIHsKCSAgICAgIHRoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlciA9IGNhbGxiYWNrOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgcmVzcG9uc2Ugbm90aWZpY2F0aW9ucyBvZiB0aGUgY3JlYXRlJ3MKCSAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrIGZ1bmN0aW9uIHRvIHJlY2VpdmUgZXZlbnRzCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25SZXNwb25zZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKCSAgICAgIHRoaXMuX29uUmVzcG9uc2VIYW5kbGVyID0gY2FsbGJhY2s7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZWFkIG5vdGlmaWNhdGlvbnMKCSAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25SZWFkJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gb25SZWFkKGNhbGxiYWNrKSB7CgkgICAgICB0aGlzLl9vblJlYWRIYW5kbGVyID0gY2FsbGJhY2s7CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBwYXJlbnQgU3luY2hlciAtPiBfb25Gb3J3YXJkCgoJICB9LCB7CgkgICAga2V5OiAnX29uRm9yd2FyZCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0UmVwb3J0ZXItUkNWOiAnLCBtc2cpOwoJICAgICAgc3dpdGNoIChtc2cuYm9keS50eXBlKSB7CgkgICAgICAgIGNhc2UgJ3N1YnNjcmliZSc6CgkgICAgICAgICAgX3RoaXMuX29uU3Vic2NyaWJlKG1zZyk7YnJlYWs7CgkgICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKCSAgICAgICAgICBfdGhpcy5fb25VblN1YnNjcmliZShtc2cpO2JyZWFrOwoJICAgICAgfQoJICAgIH0KCgkgICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gdGhpcyAtPiBfb25Gb3J3YXJkOiBlbWl0dGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gc3Vic2NyaWJlCgoJICB9LCB7CgkgICAga2V5OiAnX29uU3Vic2NyaWJlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uU3Vic2NyaWJlKG1zZykgewoJICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCSAgICAgIHZhciBoeXBlcnR5VXJsID0gbXNnLmJvZHkuZnJvbTsKCSAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdFJlcG9ydGVyLl9vblN1YnNjcmliZV0nLCBtc2cpOwoKCSAgICAgIHZhciBldmVudCA9IHsKCSAgICAgICAgdHlwZTogbXNnLmJvZHkudHlwZSwKCSAgICAgICAgdXJsOiBoeXBlcnR5VXJsLAoKCSAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKCSAgICAgICAgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQoKSB7CgkgICAgICAgICAgLy9jcmVhdGUgbmV3IHN1YnNjcmlwdGlvbgoJICAgICAgICAgIHZhciBzdWIgPSB7IHVybDogaHlwZXJ0eVVybCwgc3RhdHVzOiAnb24nIH07CgkgICAgICAgICAgX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF0gPSBzdWI7CgoJICAgICAgICAgIC8vcHJvY2VzcyBhbmQgc2VuZCBjaGlsZHJlbnMgZGF0YQoJICAgICAgICAgIHZhciBjaGlsZHJlblZhbHVlcyA9IHt9OwoJICAgICAgICAgICgwLCBfa2V5czIuZGVmYXVsdCkoX3RoaXMuX2NoaWxkcmVuT2JqZWN0cykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRJZCkgewoJICAgICAgICAgICAgdmFyIGNoaWxkRGF0YSA9IF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF0uZGF0YTsKCSAgICAgICAgICAgIGNoaWxkcmVuVmFsdWVzW2NoaWxkSWRdID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGNoaWxkRGF0YSk7CgkgICAgICAgICAgfSk7CgoJICAgICAgICAgIHZhciBzZW5kTXNnID0gewoJICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCgkgICAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgc2NoZW1hOiBfdGhpcy5fc2NoZW1hLCB2ZXJzaW9uOiBfdGhpcy5fdmVyc2lvbiwgdmFsdWU6IHsgZGF0YTogKDAsIF91dGlscy5kZWVwQ2xvbmUpKF90aGlzLmRhdGEpLCBjaGlsZHJlbnM6IGNoaWxkcmVuVmFsdWVzIH0gfQoJICAgICAgICAgIH07CgoJICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKCSAgICAgICAgICBpZiAobXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ211dHVhbEF1dGhlbnRpY2F0aW9uJykgJiYgIW1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uKSB7CgkgICAgICAgICAgICBzZW5kTXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpczMuX211dHVhbEF1dGhlbnRpY2F0aW9uOwoJICAgICAgICAgICAgX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uOwoJICAgICAgICAgIH0KCgkgICAgICAgICAgLy9zZW5kIG9rIHJlc3BvbnNlIG1lc3NhZ2UKCSAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHNlbmRNc2cpOwoKCSAgICAgICAgICByZXR1cm4gc3ViOwoJICAgICAgICB9LAoKCSAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7CgkgICAgICAgICAgLy9zZW5kIHJlamVjdCByZXNwb25zZSBtZXNzYWdlCgkgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CgkgICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKCSAgICAgICAgICAgIGJvZHk6IHsgY29kZTogNDAzLCBkZXNjOiByZWFzb24gfQoJICAgICAgICAgIH0pOwoJICAgICAgICB9CgkgICAgICB9OwoKCSAgICAgIGlmIChfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdTVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKCSAgICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7CgkgICAgICB9CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGlzIC0+IF9vbkZvcndhcmQ6IGVtaXR0ZWQgYnkgYSByZW1vdGUgRGF0YU9iamVjdE9ic2VydmVyIC0+IHVuc3Vic2NyaWJlCgoJICB9LCB7CgkgICAga2V5OiAnX29uVW5TdWJzY3JpYmUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25VblN1YnNjcmliZShtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICB2YXIgaHlwZXJ0eVVybCA9IG1zZy5ib2R5LmZyb207CgoJICAgICAgdmFyIHN1YiA9IF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVcmxdOwoJICAgICAgZGVsZXRlIF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVcmxdOwoKCSAgICAgIHZhciBldmVudCA9IHsKCSAgICAgICAgdHlwZTogbXNnLmJvZHkudHlwZSwKCSAgICAgICAgdXJsOiBoeXBlcnR5VXJsLAoJICAgICAgICBvYmplY3Q6IHN1YgoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikgewoJICAgICAgICBjb25zb2xlLmxvZygnVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAnLCBldmVudCk7CgkgICAgICAgIF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIoZXZlbnQpOwoJICAgICAgfQoJICAgIH0KCgkgICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gX29uUmVtb3RlQ3JlYXRlIC0+IGV2ZW50LmFjawoKCSAgfSwgewoJICAgIGtleTogJ19vblJlc3BvbnNlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVzcG9uc2UobXNnKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIHZhciBldmVudCA9IHsKCSAgICAgICAgdHlwZTogbXNnLnR5cGUsCgkgICAgICAgIHVybDogbXNnLmZyb20sCgkgICAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGUKCSAgICAgIH07CgoJICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewoJICAgICAgICBjb25zb2xlLmxvZygnUkVTUE9OU0UtRVZFTlQ6ICcsIGV2ZW50KTsKCSAgICAgICAgX3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyKGV2ZW50KTsKCSAgICAgIH0KCSAgICB9CgoJICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIFJlcG9ydGVyVVJMIGFkZHJlc3M6IGVtaXRlZCBieSBhIHJlbW90ZSBTeW5jaGVyIC0+IHJlYWQKCgkgIH0sIHsKCSAgICBrZXk6ICdfb25SZWFkJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVhZChtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgdmFyIGV2ZW50ID0gewoJICAgICAgICB0eXBlOiBtc2cudHlwZSwKCSAgICAgICAgdXJsOiBtc2cuZnJvbSwKCgkgICAgICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewoJICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewoJICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCgkgICAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgdmFsdWU6ICgwLCBfdXRpbHMuZGVlcENsb25lKShfdGhpcy5kYXRhKSB9CgkgICAgICAgICAgfSk7CgkgICAgICAgIH0sCgoJICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsKCSAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKCSAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAoJICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDEsIGRlc2M6IHJlYXNvbiB9CgkgICAgICAgICAgfSk7CgkgICAgICAgIH0KCSAgICAgIH07CgoJICAgICAgaWYgKF90aGlzLl9vblJlYWRIYW5kbGVyKSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdSRUFELUVWRU5UOiAnLCBldmVudCk7CgkgICAgICAgIF90aGlzLl9vblJlYWRIYW5kbGVyKGV2ZW50KTsKCSAgICAgIH0KCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdzdWJzY3JpcHRpb25zJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zOwoJICAgIH0KCSAgfV0pOwoJICByZXR1cm4gRGF0YU9iamVjdFJlcG9ydGVyOwoJfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3RSZXBvcnRlcjsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0pLAoJLyogMTIyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3Byb21pc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCgl2YXIgX3Byb21pc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvbWlzZSk7CgoJdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7CgoJdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7CgoJdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgoJdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTI0KTsKCgl2YXIgX1Byb3h5T2JqZWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1Byb3h5T2JqZWN0KTsKCgl2YXIgX0RhdGFPYmplY3RDaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCgl2YXIgX0RhdGFPYmplY3RDaGlsZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Q2hpbGQpOwoKCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwOSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvKioKCSAqIE1haW4gZXh0ZW5zaW9uIGNsYXNzIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycywgd2l0aCBjb21tb24gcHJvcGVydGllcyBhbmQgbWV0aG9kcy4KCSAqIENoaWxkcmVuIG1hbmFnZW1lbnQgaXMgY29tbW9uIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycy4KCSAqLwoJdmFyIERhdGFPYmplY3QgPSBmdW5jdGlvbiAoKSB7CgkgIC8qIHByaXZhdGUKCSAgX3ZlcnNpb246IG51bWJlcgoJICAgX293bmVyOiBIeXBlcnR5VVJMCgkgIF91cmw6IE9iamVjdFVSTAoJICBfc2NoZW1hOiBTY2hlbWEKCSAgX2J1czogTWluaUJ1cwoJICBfc3RhdHVzOiBvbiB8IHBhdXNlZAoJICBfc3luY09iajogU3luY0RhdGEKCSAgIF9jaGlsZHJlbjogeyBpZDogRGF0YU9iamVjdENoaWxkIH0KCSAgX2NoaWxkcmVuTGlzdGVuZXJzOiBbTXNnTGlzdGVuZXJdCgkgICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCgkgIF9vbkFkZENoaWxkSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCgkgICovCgoJICAvKioKCSAgICogQGlnbm9yZQoJICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlciBjcmVhdGUgb3Igc3Vic2NyaWJlIG1ldGhvZCdzCgkgICAqLwoJICBmdW5jdGlvbiBEYXRhT2JqZWN0KHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSB7CgkgICAgdmFyIG11dHVhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDogdHJ1ZTsKCSAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBEYXRhT2JqZWN0KTsKCgkgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgX3RoaXMuX3N5bmNoZXIgPSBzeW5jaGVyOwoJICAgIF90aGlzLl91cmwgPSB1cmw7CgkgICAgX3RoaXMuX3NjaGVtYSA9IHNjaGVtYTsKCSAgICBfdGhpcy5fc3RhdHVzID0gaW5pdGlhbFN0YXR1czsKCSAgICBfdGhpcy5fc3luY09iaiA9IG5ldyBfUHJveHlPYmplY3QyLmRlZmF1bHQoaW5pdGlhbERhdGEpOwoJICAgIF90aGlzLl9jaGlsZHJlbnMgPSBjaGlsZHJlbnM7CgoJICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKCSAgICBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb24gPSBtdXR1YWw7CgoJICAgIF90aGlzLl92ZXJzaW9uID0gMDsKCSAgICBfdGhpcy5fY2hpbGRJZCA9IDA7CgkgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0cyA9IHt9OwoJICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwoKCSAgICBfdGhpcy5fb3duZXIgPSBzeW5jaGVyLl9vd25lcjsKCSAgICBfdGhpcy5fYnVzID0gc3luY2hlci5fYnVzOwoJICB9CgoJICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0LCBbewoJICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKCSAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgdmFyIGNoaWxkQmFzZVVSTCA9IF90aGlzLl91cmwgKyAnL2NoaWxkcmVuLyc7CgkgICAgICBjb25zb2xlLmxvZygnW0RhdGEgT2JqZWN0IC0gQWxsb2NhdGVMaXN0ZW5lcnNdIC0gJywgX3RoaXMuX2NoaWxkcmVucyk7CgkgICAgICBpZiAoX3RoaXMuX2NoaWxkcmVucykgewoJICAgICAgICBfdGhpcy5fY2hpbGRyZW5zLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7CgkgICAgICAgICAgdmFyIGNoaWxkVVJMID0gY2hpbGRCYXNlVVJMICsgY2hpbGQ7CgkgICAgICAgICAgdmFyIGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgZnVuY3Rpb24gKG1zZykgewoJICAgICAgICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZgoJICAgICAgICAgICAgaWYgKG1zZy5mcm9tICE9PSBfdGhpczIuX293bmVyKSB7CgkgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0LUNoaWxkcmVuLVJDVjogJywgbXNnKTsKCSAgICAgICAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewoJICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6CgkgICAgICAgICAgICAgICAgICBfdGhpcy5fb25DaGlsZENyZWF0ZShtc2cpO2JyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CgkgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO2JyZWFrOwoJICAgICAgICAgICAgICAgIGRlZmF1bHQ6CgkgICAgICAgICAgICAgICAgICBfdGhpcy5fY2hhbmdlQ2hpbGRyZW4obXNnKTticmVhazsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0pOwoKCSAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CgkgICAgICAgIH0pOwoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikgewoJICAgICAgICBsaXN0ZW5lci5yZW1vdmUoKTsKCSAgICAgIH0pOwoKCSAgICAgICgwLCBfa2V5czIuZGVmYXVsdCkoX3RoaXMuX2NoaWxkcmVuT2JqZWN0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CgkgICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNba2V5XS5fcmVsZWFzZUxpc3RlbmVycygpOwoJICAgICAgfSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBPYmplY3QgVVJMIG9mIHJlcG9ydGVyIG9yIG9ic2VydmVyCgkgICAgICogQHR5cGUge09iamVjdFVSTH0KCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdwYXVzZScsCgoKCSAgICAvKioKCSAgICAgKiBAaWdub3JlCgkgICAgICovCgkgICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkgewoJICAgICAgLy9UT0RPOiB0aGlzIGZlYXR1cmUgbmVlZHMgbW9yZSBhbmFsaXNlCgkgICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIEBpZ25vcmUKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdyZXN1bWUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7CgkgICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKCSAgICAgIHRocm93ICdOb3QgaW1wbGVtZW50ZWQnOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogQGlnbm9yZQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3N0b3AnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkgewoJICAgICAgLy9UT0RPOiBzaG91bGQgcmVtb3ZlIHRoZSBzdWJzY3JpcHRpb24gYW5kIHNlbmQgbWVzc2FnZSB1bnN1YnNjcmliZT8KCSAgICAgIHRocm93ICdOb3QgaW1wbGVtZW50ZWQnOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGFuZCBhZGQgYSBEYXRhT2JqZWN0Q2hpbGQgdG8gYSBjaGlsZHJlbiBjb2xsZWN0aW9uLgoJICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGlsZHJlbiAtIENoaWxkcmVuIG5hbWUgd2hlcmUgdGhlIGNoaWxkIGlzIGFkZGVkLgoJICAgICAqIEBwYXJhbSB7SlNPTn0gaW5pdGlhbERhdGEgLSBJbml0aWFsIGRhdGEgb2YgdGhlIGNoaWxkCgkgICAgICogQHBhcmFtICB7TWVzc2FnZUJvZHlJZGVudGl0eX0gaWRlbnRpdHkgLSAob3B0aW9uYWwpIGlkZW50aXR5IGRhdGEgdG8gYmUgYWRkZWQgdG8gaWRlbnRpdHkgdGhlIHVzZXIgcmVwb3J0ZXIuIFRvIGJlIHVzZWQgZm9yIGxlZ2FjeSBpZGVudGl0aWVzLgoJICAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdENoaWxkPn0gLSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBEYXRhT2JqZWN0Q2hpbGQuCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnYWRkQ2hpbGQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRDaGlsZChjaGlsZHJlbiwgaW5pdGlhbERhdGEsIGlkZW50aXR5KSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIC8vY3JlYXRlIG5ldyBjaGlsZCB1bmlxdWUgSUQsIGJhc2VkIG9uIGh5cGVydHlVUkwKCSAgICAgIF90aGlzLl9jaGlsZElkKys7CgkgICAgICB2YXIgbXNnQ2hpbGRJZCA9IF90aGlzLl9vd25lciArICcjJyArIF90aGlzLl9jaGlsZElkOwoJICAgICAgdmFyIG1zZ0NoaWxkUGF0aCA9IF90aGlzLl91cmwgKyAnL2NoaWxkcmVuLycgKyBjaGlsZHJlbjsKCgkgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIGEgcmVzb3VyY2UgY2hpbGQgYWRkcmVzczogTWVzc2FnZUJ1cwoJICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CgkgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBtc2dDaGlsZFBhdGgsCgkgICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IG1zZ0NoaWxkSWQsIHZhbHVlOiBpbml0aWFsRGF0YSB9CgkgICAgICB9OwoKCSAgICAgIGlmIChpZGVudGl0eSkgewoJICAgICAgICByZXF1ZXN0TXNnLmJvZHkuaWRlbnRpdHkgPSBpZGVudGl0eTsKCSAgICAgIH0KCgkgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CgkgICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgcmVxdWVzdE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uOwoKCSAgICAgIC8vcmV0dXJucyBwcm9taXNlLCBpbiB0aGUgZnV0dXJlLCB0aGUgQVBJIG1heSBjaGFuZ2UgdG8gYXN5bmNocm9ub3VzIGNhbGwKCSAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUpIHsKCSAgICAgICAgdmFyIG1zZ0lkID0gX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXF1ZXN0TXNnKTsKCgkgICAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUtcmVwb3J0ZXItY2hpbGQoICcgKyBfdGhpcy5fb3duZXIgKyAnICk6ICcsIHJlcXVlc3RNc2cpOwoJICAgICAgICB2YXIgbmV3Q2hpbGQgPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpcywgbXNnQ2hpbGRJZCwgaW5pdGlhbERhdGEsIF90aGlzLl9vd25lciwgbXNnSWQpOwoJICAgICAgICBuZXdDaGlsZC5vbkNoYW5nZShmdW5jdGlvbiAoZXZlbnQpIHsKCSAgICAgICAgICBfdGhpcy5fb25DaGFuZ2UoZXZlbnQsIHsgcGF0aDogbXNnQ2hpbGRQYXRoLCBjaGlsZElkOiBtc2dDaGlsZElkIH0pOwoJICAgICAgICB9KTsKCgkgICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCgkgICAgICAgIHJlc29sdmUobmV3Q2hpbGQpOwoJICAgICAgfSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyBjcmVhdGUgYW5kIGRlbGV0ZSBvZiBjaGlsZHJlbnMuCgkgICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ29uQWRkQ2hpbGQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBvbkFkZENoaWxkKGNhbGxiYWNrKSB7CgkgICAgICB0aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlciA9IGNhbGxiYWNrOwoJICAgIH0KCgkgICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdCAtPiBhZGRDaGlsZAoKCSAgfSwgewoJICAgIGtleTogJ19vbkNoaWxkQ3JlYXRlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uQ2hpbGRDcmVhdGUobXNnKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoJICAgICAgdmFyIG1zZ0NoaWxkSWQgPSBtc2cuYm9keS5yZXNvdXJjZTsKCgkgICAgICBjb25zb2xlLmxvZygnY3JlYXRlLW9ic2VydmVyLWNoaWxkKCAnICsgX3RoaXMuX293bmVyICsgJyApOiAnLCBtc2cpOwoJICAgICAgdmFyIG5ld0NoaWxkID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIG1zZ0NoaWxkSWQsIG1zZy5ib2R5LnZhbHVlKTsKCSAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCgkgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKCSAgICAgICAgLy9GTE9XLU9VVDogd2lsbCBmbG93IHRvIERhdGFPYmplY3RDaGlsZCAtPiBfb25SZXNwb25zZQoJICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKCSAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKCSAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgc291cmNlOiBfdGhpcy5fb3duZXIgfQoJICAgICAgICB9KTsKCSAgICAgIH0pOwoKCSAgICAgIHZhciBldmVudCA9IHsKCSAgICAgICAgdHlwZTogbXNnLnR5cGUsCgkgICAgICAgIGZyb206IG1zZy5mcm9tLAoJICAgICAgICB1cmw6IG1zZy50bywKCSAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAoJICAgICAgICBjaGlsZElkOiBtc2dDaGlsZElkLAoJICAgICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHkKCSAgICAgIH07CgoJICAgICAgaWYgKF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcikgewoJICAgICAgICBjb25zb2xlLmxvZygnQURELUNISUxEUkVOLUVWRU5UOiAnLCBldmVudCk7CgkgICAgICAgIF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcihldmVudCk7CgkgICAgICB9CgkgICAgfQoKCSAgICAvL3NlbmQgZGVsdGEgbWVzc2FnZXMgdG8gc3Vic2NyaXB0aW9ucwoKCSAgfSwgewoJICAgIGtleTogJ19vbkNoYW5nZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoYW5nZShldmVudCwgY2hpbGRJbmZvKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl92ZXJzaW9uKys7CgoJICAgICAgaWYgKF90aGlzLl9zdGF0dXMgPT09ICdvbicpIHsKCSAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoYW5nZXMgYWRkcmVzczogTWVzc2FnZUJ1cwoJICAgICAgICB2YXIgY2hhbmdlTXNnID0gewoJICAgICAgICAgIHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogX3RoaXMuX3VybCArICcvY2hhbmdlcycsCgkgICAgICAgICAgYm9keTogeyB2ZXJzaW9uOiBfdGhpcy5fdmVyc2lvbiwgc291cmNlOiBfdGhpcy5fb3duZXIsIGF0dHJpYnV0ZTogZXZlbnQuZmllbGQgfQoJICAgICAgICB9OwoKCSAgICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0IC0gX29uQ2hhbmdlXSAtICcsIGV2ZW50LCBjaGlsZEluZm8sIGNoYW5nZU1zZyk7CgoJICAgICAgICBpZiAoZXZlbnQub1R5cGUgPT09IF9Qcm94eU9iamVjdC5PYmplY3RUeXBlLk9CSkVDVCkgewoJICAgICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CgkgICAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CgkgICAgICAgICAgfQoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPSBldmVudC5vVHlwZTsKCSAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CgkgICAgICAgICAgaWYgKGV2ZW50LmNUeXBlICE9PSBfUHJveHlPYmplY3QuQ2hhbmdlVHlwZS5VUERBVEUpIHsKCSAgICAgICAgICAgIGNoYW5nZU1zZy5ib2R5Lm9wZXJhdGlvbiA9IGV2ZW50LmNUeXBlOwoJICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgLy9jaGlsZEluZm8gbXVzdCBoYXZlIChwYXRoLCBjaGlsZElkKQoJICAgICAgICBpZiAoY2hpbGRJbmZvKSB7CgkgICAgICAgICAgY2hhbmdlTXNnLnRvID0gY2hpbGRJbmZvLnBhdGg7CgkgICAgICAgICAgY2hhbmdlTXNnLmJvZHkucmVzb3VyY2UgPSBjaGlsZEluZm8uY2hpbGRJZDsKCSAgICAgICAgfQoKCSAgICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQoJICAgICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgY2hhbmdlTXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb247CgoJICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGNoYW5nZU1zZyk7CgkgICAgICB9CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IGRlbHRhIG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgb3IgRGF0YU9iamVjdENoaWxkIHdoZW4gY2hhbmdpbmcgZGF0YQoKCSAgfSwgewoJICAgIGtleTogJ19jaGFuZ2VPYmplY3QnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hhbmdlT2JqZWN0KHN5bmNPYmosIG1zZykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICAvL1RPRE86IHVwZGF0ZSB2ZXJzaW9uID8KCSAgICAgIC8vaG93IHRvIGhhbmRsZSBhbiBpbmNvcnJlY3QgdmVyc2lvbiA/IEV4YW1wbGU6IHJlY2VpdmUgYSB2ZXJzaW9uIDMgd2hlbiB0aGUgb2JzZXJ2ZXIgaXMgaW4gdmVyc2lvbiAxLCB3aGVyZSBpcyB0aGUgdmVyc2lvbiAyID8KCSAgICAgIC8vd2lsbCB3ZSBuZWVkIHRvIGNvbmZpcm0gdGhlIHJlY2VwdGlvbiA/CgkgICAgICBpZiAoX3RoaXMuX3ZlcnNpb24gKyAxID09PSBtc2cuYm9keS52ZXJzaW9uKSB7CgkgICAgICAgIF90aGlzLl92ZXJzaW9uKys7CgkgICAgICAgIHZhciBwYXRoID0gbXNnLmJvZHkuYXR0cmlidXRlOwoJICAgICAgICB2YXIgdmFsdWUgPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkobXNnLmJvZHkudmFsdWUpOwoJICAgICAgICB2YXIgZmluZFJlc3VsdCA9IHN5bmNPYmouZmluZEJlZm9yZShwYXRoKTsKCgkgICAgICAgIGlmIChtc2cuYm9keS5hdHRyaWJ1dGVUeXBlID09PSBfUHJveHlPYmplY3QuT2JqZWN0VHlwZS5BUlJBWSkgewoJICAgICAgICAgIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLkFERCkgewoJICAgICAgICAgICAgdmFyIGFyciA9IGZpbmRSZXN1bHQub2JqOwoJICAgICAgICAgICAgdmFyIGluZGV4ID0gZmluZFJlc3VsdC5sYXN0OwoJICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShhcnIsIFtpbmRleCwgMF0uY29uY2F0KHZhbHVlKSk7CgkgICAgICAgICAgfSBlbHNlIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlJFTU9WRSkgewoJICAgICAgICAgICAgdmFyIF9hcnIgPSBmaW5kUmVzdWx0Lm9iajsKCSAgICAgICAgICAgIHZhciBfaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CgkgICAgICAgICAgICBfYXJyLnNwbGljZShfaW5kZXgsIHZhbHVlKTsKCSAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XSA9IHZhbHVlOyAvLyBVUERBVEUKCSAgICAgICAgICB9CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgaWYgKG1zZy5ib2R5LnZhbHVlKSB7CgkgICAgICAgICAgICBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdID0gdmFsdWU7IC8vIFVQREFURSBvciBBREQKCSAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgZGVsZXRlIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF07IC8vIFJFTU9WRQoJICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgLy9UT0RPOiBob3cgdG8gaGFuZGxlIHVuc3luY2hyb25pemVkIHZlcnNpb25zPwoJICAgICAgICBjb25zb2xlLmxvZygnVU5TWU5DSFJPTklaRUQgVkVSU0lPTjogKGRhdGEgPT4gJyArIF90aGlzLl92ZXJzaW9uICsgJywgbXNnID0+ICcgKyBtc2cuYm9keS52ZXJzaW9uICsgJyknKTsKCSAgICAgIH0KCSAgICB9CgoJICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RDaGlsZCB3aGVuIGNoYW5naW5nIGRhdGEKCgkgIH0sIHsKCSAgICBrZXk6ICdfY2hhbmdlQ2hpbGRyZW4nLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hhbmdlQ2hpbGRyZW4obXNnKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoJICAgICAgY29uc29sZS5sb2coJ0NoYW5nZSBjaGlsZHJlbjogJywgX3RoaXMuX293bmVyLCBtc2cpOwoKCSAgICAgIHZhciBjaGlsZElkID0gbXNnLmJvZHkucmVzb3VyY2U7CgkgICAgICB2YXIgY2hpbGRyZW4gPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdOwoKCSAgICAgIGlmIChjaGlsZHJlbikgewoJICAgICAgICBfdGhpcy5fY2hhbmdlT2JqZWN0KGNoaWxkcmVuLl9zeW5jT2JqLCBtc2cpOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgY29uc29sZS5sb2coJ05vIGNoaWxkcmVuIGZvdW5kIGZvcjogJywgY2hpbGRJZCk7CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAndXJsJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl91cmw7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBPYmplY3Qgc2NoZW1hIFVSTCAodGhpcyBmaWVsZCBpcyBub3QgeWV0IHN0YWJsZSwgYW5kIGlzIHN1YnNqZWN0IHRvIGNoYW5nZSkKCSAgICAgKiBAdHlwZSB7U2NoZW1hVVJMfQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3NjaGVtYScsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fc2NoZW1hOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogU3RhdHVzIG9mIHRoZSByZXBvcnRlciBvciBvYnNlcnZlciBjb25uZWN0aW9uICh0aGlzIGZpZWxkIGlzIG5vdCB5ZXQgc3RhYmxlLCBhbmQgaXMgc3Vic2plY3QgdG8gY2hhbmdlKQoJICAgICAqIEB0eXBlIHtTdGF0dXN9IC0gRW51bSBvZjogb24gfCBwYXVzZWQKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdzdGF0dXMnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1czsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIERhdGEgc3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC4KCSAgICAgKiBAdHlwZSB7SlNPTn0gLSBKU09OIHN0cnVjdHVyZSB0aGF0IHNob3VsZCBmb2xsb3cgdGhlIGRlZmluZWQgc2NoZW1hLCBpZiBhbnkuCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnZGF0YScsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogQWxsIGNyZWF0ZWQgY2hpbGRyZW4ncyBzaW5jZSB0aGUgc3Vic2NyaXB0aW9uLCBkb2Vzbid0IGNvbnRhaW4gYWxsIGNoaWxkcmVuJ3Mgc2luY2UgcmVwb3J0ZXIgY3JlYXRpb24uCgkgICAgICogQHR5cGUge09iamVjdDxDaGlsZElkLCBEYXRhT2JqZWN0Q2hpbGQ+fQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ2NoaWxkcmVucycsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW5PYmplY3RzOwoJICAgIH0KCSAgfV0pOwoJICByZXR1cm4gRGF0YU9iamVjdDsKCX0oKTsgLyoqCgkgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCgkgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoJICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoJICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoJICAgICAqCgkgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICAgICAqCgkgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAgICAgKgoJICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAgICAgKiovCgoJZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdDsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0pLAoJLyogMTIzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKCXZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7CgoJdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKCXZhciBfUHJveHlPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyNCk7CgoJdmFyIF9Qcm94eU9iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Qcm94eU9iamVjdCk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvKioKCSAqIFRoZSBjbGFzcyByZXR1cm5lZCBmcm9tIHRoZSBEYXRhT2JqZWN0IGFkZENoaWxkcmVuIGNhbGwgb3IgZnJvbSBvbkFkZENoaWxkcmVuIGlmIHJlbW90ZWx5IGNyZWF0ZWQuCgkgKiBDaGlsZHJlbiBvYmplY3Qgc3luY2hyb25pemF0aW9uIGlzIGEgYSBmYXN0IGZvcndhcmQgbWVjaGFuaXNtLCBubyBuZWVkIGZvciBkaXJlY3Qgc3Vic2NyaXB0aW9ucywgaXQgdXNlcyB0aGUgYWxyZWFkeSBhdXRob3JpemVkIHN1YnNjcmlwdGlvbiBmcm9tIHRoZSBwYXJlbnQgRGF0YU9iamVjdC4KCSAqLwoJdmFyIERhdGFPYmplY3RDaGlsZCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8gPSBmdW5jdGlvbiAoKSB7CgkgIC8qIHByaXZhdGUKCSAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KCSAgX29uUmVzcG9uc2VIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKCSAgKi8KCgkgIC8qKgoJICAgKiBAaWdub3JlCgkgICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBEYXRhT2JqZWN0LmFkZENoaWxkcmVuCgkgICAqLwoJICBmdW5jdGlvbiBEYXRhT2JqZWN0Q2hpbGQocGFyZW50LCBjaGlsZElkLCBpbml0aWFsRGF0YSwgb3duZXIsIG1zZ0lkKSB7CgkgICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdENoaWxkKTsKCgkgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgX3RoaXMuX3BhcmVudCA9IHBhcmVudDsKCSAgICBfdGhpcy5fY2hpbGRJZCA9IGNoaWxkSWQ7CgkgICAgX3RoaXMuX293bmVyID0gb3duZXI7CgkgICAgX3RoaXMuX21zZ0lkID0gbXNnSWQ7CgoJICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CgoJICAgIF90aGlzLl9idXMgPSBwYXJlbnQuX2J1czsKCSAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKCSAgfQoKCSAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdENoaWxkLCBbewoJICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgLy90aGlzIGlzIG9ubHkgbmVlZGVkIGZvciBjaGlsZHJlbiByZXBvcnRlcnMKCSAgICAgIGlmIChfdGhpcy5fb3duZXIpIHsKCSAgICAgICAgX3RoaXMuX2xpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fb3duZXIsIGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgICAgICBpZiAobXNnLnR5cGUgPT09ICdyZXNwb25zZScgJiYgbXNnLmlkID09PSBfdGhpcy5fbXNnSWQpIHsKCSAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZTonLCBtc2cpOwoJICAgICAgICAgICAgX3RoaXMuX29uUmVzcG9uc2UobXNnKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGlmIChfdGhpcy5fbGlzdGVuZXIpIHsKCSAgICAgICAgX3RoaXMuX2xpc3RlbmVyLnJlbW92ZSgpOwoJICAgICAgfQoJICAgIH0KCgkgICAgLyoqCgkgICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnZGVsZXRlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgZGVsZXRlIF90aGlzLl9wYXJlbnQuX2NoaWxkcmVuW190aGlzLl9jaGlsZElkXTsKCgkgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwoKCSAgICAgIC8vVE9ETzogc2VuZCBkZWxldGUgbWVzc2FnZSA/CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBDaGlsZHJlbiBJRCBnZW5lcmF0ZWQgb24gYWRkQ2hpbGRyZW4uIFVuaXF1ZSBpZGVudGlmaWVyCgkgICAgICogQHR5cGUge1VSTH0gLSBVUkwgb2YgdGhlIGZvcm1hdCA8SHlwZXJ0eVVSTD4jPG51bWVyaWMtc2VxdWVuY2U+CgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25DaGFuZ2UnLAoKCgkgICAgLyoqCgkgICAgICogUmVnaXN0ZXIgdGhlIGNoYW5nZSBsaXN0ZW5lcnMgc2VudCBieSB0aGUgcmVwb3J0ZXIgY2hpbGQKCSAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCgkgICAgICovCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlKGNhbGxiYWNrKSB7CgkgICAgICB0aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CgkgICAgICAgIGNhbGxiYWNrKGV2ZW50KTsKCSAgICAgIH0pOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgcmVzcG9uc2Ugbm90aWZpY2F0aW9ucyBvZiB0aGUgY3JlYXRlcwoJICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvblJlc3BvbnNlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gb25SZXNwb25zZShjYWxsYmFjaykgewoJICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKCSAgICB9CgoJICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3QgLT4gX29uQ2hpbGRDcmVhdGUKCgkgIH0sIHsKCSAgICBrZXk6ICdfb25SZXNwb25zZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlc3BvbnNlKG1zZykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICB2YXIgZXZlbnQgPSB7CgkgICAgICAgIHR5cGU6IG1zZy50eXBlLAoJICAgICAgICB1cmw6IG1zZy5ib2R5LnNvdXJjZSwKCSAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyKSB7CgkgICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnY2hpbGRJZCcsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIERhdGEgU3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC4KCSAgICAgKiBAdHlwZSB7SlNPTn0gLSBKU09OIHN0cnVjdHVyZSB0aGF0IHNob3VsZCBmb2xsb3cgdGhlIGRlZmluZWQgc2NoZW1hLCBpZiBhbnkuCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnZGF0YScsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwoJICAgIH0KCSAgfV0pOwoJICByZXR1cm4gRGF0YU9iamVjdENoaWxkOwoJfSgpOyAvKioKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoJICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCgkgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCgkgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQoJICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCgkgICAgICoKCSAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgICAgICoKCSAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICAgICAqCgkgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICAgICAqKi8KCglleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0Q2hpbGQ7Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9KSwKCS8qIDEyNCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLk9iamVjdFR5cGUgPSBleHBvcnRzLkNoYW5nZVR5cGUgPSB1bmRlZmluZWQ7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKCXZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgl2YXIgb2JqZWN0VHlwZSA9IHsgQVJSQVk6ICdbb2JqZWN0IEFycmF5XScsIE9CSkVDVDogJ1tvYmplY3QgT2JqZWN0XScgfTsKCgkvKioKCSAqIEBhY2Nlc3MgcHJpdmF0ZQoJICogTWFpbiBjbGFzcyB0aGF0IG1haW50YWlucyBhIEpTT04gb2JqZWN0LCBhbmQgb2JzZXJ2ZXMgY2hhbmdlcyBpbiB0aGlzIG9iamVjdCwgcmVjdXJzaXZlbHkuCgkgKiBJbnRlcm5hbCBvYmplY3RzIGFuZCBhcnJheXMgYXJlIGFsc28gb2JzZXJ2ZWQuCgkgKi8KCgl2YXIgU3luY09iamVjdCA9IGZ1bmN0aW9uICgpIHsKCSAgZnVuY3Rpb24gU3luY09iamVjdChpbml0aWFsRGF0YSkgewoJICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFN5bmNPYmplY3QpOwoKCSAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICBfdGhpcy5fb2JzZXJ2ZXJzID0gW107CgkgICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCgkgICAgdGhpcy5fZGF0YSA9IGluaXRpYWxEYXRhIHx8IHt9OwoKCSAgICB0aGlzLl9pbnRlcm5hbE9ic2VydmUodGhpcy5fZGF0YSk7CgkgIH0KCgkgICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKFN5bmNPYmplY3QsIFt7CgkgICAga2V5OiAnb2JzZXJ2ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoY2FsbGJhY2spIHsKCSAgICAgIHRoaXMuX29ic2VydmVycy5wdXNoKGNhbGxiYWNrKTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdmaW5kJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gZmluZChwYXRoKSB7CgkgICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCgkgICAgICByZXR1cm4gdGhpcy5fZmluZFdpdGhTcGxpdChsaXN0KTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdmaW5kQmVmb3JlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gZmluZEJlZm9yZShwYXRoKSB7CgkgICAgICB2YXIgcmVzdWx0ID0ge307CgkgICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCSAgICAgIHJlc3VsdC5sYXN0ID0gbGlzdC5wb3AoKTsKCSAgICAgIHJlc3VsdC5vYmogPSB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwoKCSAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2ZpbmRXaXRoU3BsaXQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfZmluZFdpdGhTcGxpdChsaXN0KSB7CgkgICAgICB2YXIgb2JqID0gdGhpcy5fZGF0YTsKCSAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHsKCSAgICAgICAgb2JqID0gb2JqW3ZhbHVlXTsKCSAgICAgIH0pOwoKCSAgICAgIHJldHVybiBvYmo7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2ludGVybmFsT2JzZXJ2ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbE9ic2VydmUob2JqZWN0KSB7CgkgICAgICB2YXIgX3RoaXMyID0gdGhpczsKCgkgICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoY2hhbmdlc2V0KSB7CgoJICAgICAgICBjaGFuZ2VzZXQuZXZlcnkoZnVuY3Rpb24gKGNoYW5nZSkgewoJICAgICAgICAgIF90aGlzMi5fb25DaGFuZ2VzKGNoYW5nZSk7CgkgICAgICAgIH0pOwoJICAgICAgfTsKCgkgICAgICB0aGlzLl9kYXRhID0gT2JqZWN0LmRlZXBPYnNlcnZlKG9iamVjdCwgaGFuZGxlcik7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2ZpcmVFdmVudCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9maXJlRXZlbnQoZXZlbnQpIHsKCSAgICAgIHRoaXMuX29ic2VydmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykgewoJICAgICAgICBjYWxsYmFjayhldmVudCk7CgkgICAgICB9KTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfb25DaGFuZ2VzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uQ2hhbmdlcyhjaGFuZ2UpIHsKCgkgICAgICB2YXIgb2JqID0gY2hhbmdlLm9iamVjdDsKCSAgICAgIHZhciBvYmpUeXBlID0gdm9pZCAwOwoKCSAgICAgIGlmIChvYmouY29uc3RydWN0b3IgPT09IE9iamVjdCkgewoJICAgICAgICBvYmpUeXBlID0gT2JqZWN0VHlwZS5PQkpFQ1Q7CgkgICAgICB9CgoJICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHsKCSAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuQVJSQVk7CgkgICAgICB9CgoJICAgICAgdmFyIGZpZWxkU3RyaW5nID0gY2hhbmdlLmtleXBhdGg7CgoJICAgICAgLy8gY29uc29sZS5sb2coJ0ZpZWxkOicsIGZpZWxkU3RyaW5nKTsKCSAgICAgIC8vIGNvbnNvbGUubG9nKCd0eXBlOicsIGNoYW5nZS50eXBlKTsKCgkgICAgICAvL2xldCBvbGRWYWx1ZSA9IGNoYW5nZS5vbGRWYWx1ZTsKCSAgICAgIHZhciBuZXdWYWx1ZSA9IG9ialtjaGFuZ2UubmFtZV07CgoJICAgICAgLy8gY29uc29sZS5pbmZvKGNoYW5nZS50eXBlICsgJyB8IEZpZWxkOiAnICsgZmllbGRTdHJpbmcgKyAnIHwgTmV3IFZhbHVlOicsIEpTT04uc3RyaW5naWZ5KG5ld1ZhbHVlKSwgZmllbGRTdHJpbmcuaW5jbHVkZXMoJ2xlbmd0aCcpKTsKCgkgICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICd1cGRhdGUnICYmICFmaWVsZFN0cmluZy5pbmNsdWRlcygnLmxlbmd0aCcpKSB7CgkgICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CgkgICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuVVBEQVRFLAoJICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAoJICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZywKCSAgICAgICAgICBkYXRhOiBuZXdWYWx1ZQoJICAgICAgICB9KTsKCSAgICAgIH0KCgkgICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdhZGQnKSB7CgkgICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CgkgICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuQURELAoJICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAoJICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZywKCSAgICAgICAgICBkYXRhOiBuZXdWYWx1ZQoJICAgICAgICB9KTsKCSAgICAgIH0KCgkgICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdkZWxldGUnKSB7CgkgICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CgkgICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuUkVNT1ZFLAoJICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAoJICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZwoJICAgICAgICB9KTsKCSAgICAgIH0KCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdkYXRhJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9kYXRhOwoJICAgIH0KCSAgfV0pOwoJICByZXR1cm4gU3luY09iamVjdDsKCX0oKTsKCgl2YXIgQ2hhbmdlVHlwZSA9IGV4cG9ydHMuQ2hhbmdlVHlwZSA9IHsgVVBEQVRFOiAndXBkYXRlJywgQUREOiAnYWRkJywgUkVNT1ZFOiAncmVtb3ZlJyB9OwoJdmFyIE9iamVjdFR5cGUgPSBleHBvcnRzLk9iamVjdFR5cGUgPSB7IE9CSkVDVDogJ29iamVjdCcsIEFSUkFZOiAnYXJyYXknIH07CglleHBvcnRzLmRlZmF1bHQgPSBTeW5jT2JqZWN0OwoKCS8qKiovIH0pLAoJLyogMTI1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCXZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCgl2YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFByb3RvdHlwZU9mKTsKCgl2YXIgX2dldE93blByb3BlcnR5RGVzY3JpcHRvciA9IF9fd2VicGFja19yZXF1aXJlX18oMTQyKTsKCgl2YXIgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7CgkgIGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsKCSAgdmFyIGRlc2MgPSAoMCwgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIuZGVmYXVsdCkob2JqZWN0LCBwcm9wZXJ0eSk7CgoJICBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7CgkgICAgdmFyIHBhcmVudCA9ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKG9iamVjdCk7CgoJICAgIGlmIChwYXJlbnQgPT09IG51bGwpIHsKCSAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgfSBlbHNlIHsKCSAgICAgIHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOwoJICAgIH0KCSAgfSBlbHNlIGlmICgidmFsdWUiIGluIGRlc2MpIHsKCSAgICByZXR1cm4gZGVzYy52YWx1ZTsKCSAgfSBlbHNlIHsKCSAgICB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7CgoJICAgIGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgewoJICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKCSAgICB9CgoJICAgIHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7CgkgIH0KCX07CgoJLyoqKi8gfSksCgkvKiAxMjYgKi8sCgkvKiAxMjcgKi8sCgkvKiAxMjggKi8sCgkvKiAxMjkgKi8sCgkvKiAxMzAgKi8sCgkvKiAxMzEgKi8sCgkvKiAxMzIgKi8sCgkvKiAxMzMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfcHJvbWlzZSA9IF9fd2VicGFja19yZXF1aXJlX18oNzEpOwoKCXZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCgl2YXIgX2Fzc2lnbiA9IF9fd2VicGFja19yZXF1aXJlX18oMTQwKTsKCgl2YXIgX2Fzc2lnbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hc3NpZ24pOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7CgoJdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgoJdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMSk7CgoJdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdFJlcG9ydGVyKTsKCgl2YXIgX0RhdGFPYmplY3RPYnNlcnZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTIwKTsKCgl2YXIgX0RhdGFPYmplY3RPYnNlcnZlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKCXZhciBfRGF0YVByb3Zpc2lvbmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzcpOwoKCXZhciBfRGF0YVByb3Zpc2lvbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFQcm92aXNpb25hbCk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvKioKCSogVGhlIG1haW4gY2xhc3MgZm9yIHRoZSBzeW5jaGVyIHBhY2thZ2UuCgkqIFRoZSBTeW5jaGVyIGlzIGEgc2luZ2xldG9uIGNsYXNzIHBlciBIeXBlcnR5L1VSTCBhbmQgaXQgaXMgdGhlIG93bmVyIG9mIGFsbCBjcmVhdGVkIERhdGEgU3luYyBPYmplY3RzIGFjY29yZGluZyB0byB0aGUgUmVwb3J0ZXIgLSBPYnNlcnZlciBwYXR0ZXJuLgoJKiBNYWluIGZ1bmN0aW9uYWxpdHkgaXMgdG8gY3JlYXRlIHJlcG9ydGVycyBhbmQgdG8gc3Vic2NyaWJlIHRvIGV4aXN0aW5nIG9uZXMuCgkqLwoJdmFyIFN5bmNoZXIgPSBmdW5jdGlvbiAoKSB7CgkgIC8qIHByaXZhdGUKCSAgX293bmVyOiBVUkwKCSAgX2J1czogTWluaUJ1cwoJICAgX3N1YlVSTDogVVJMCgkgICBfcmVwb3J0ZXJzOiA8dXJsOiBEYXRhT2JqZWN0UmVwb3J0ZXI+CgkgIF9vYnNlcnZlcnM6IDx1cmw6IERhdGFPYmplY3RPYnNlcnZlcj4KCSAgX3Byb3Zpc2lvbmFsczogPHVybDogRGF0YVByb3Zpc2lvbmFsPgoJICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQoJICBfb25Ob3RpZmljYXRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKCSAgX29uUmVzdW1lOiAoZXZlbnQpID0+IHZvaWQKCSAgKi8KCgkgIC8qKgoJICAqIENvbnN0cnVjdG9yIHRoYXQgc2hvdWxkIGJlIHVzZWQgYnkgdGhlIEh5cGVydHkgb3duZXIKCSAgKiBAcGFyYW0ge0h5cGVydHlVUkx9IG93bmVyIC0gSHlwZXJ0eSBVUkwgb3duZXIuIEFuIFVSTCBhbGxvY2F0ZWQgYnkgdGhlIHJ1bnRpbWUgdGhhdCB1bmlxdWVseSBpZGVudGlmaWVzIHRoZSBIeXBlcnR5LgoJICAqIEBwYXJhbSB7TWluaUJ1c30gYnVzIC0gQW4gaW5zdGFuY2Ugb2YgdGhlIE1pbmlCdXMgcHJvdmlkZWQgaW4gdGhlIHNhbmRib3guIFdoZW4gYW4gb2JqZWN0IChSZXBvcnRlciBvciBPYnNlcnZlZCkgaXMgY3JlYXRlZCwgdGhlIFN5bmNoZXJNYW5hZ2VyIHdpbGwgYWRkIGEgbGlzdGVuZXIgaW4gdGhlIE1pbmlCdXMgdG8gcmVjZWl2ZS9zZW5kIE1lc3NhZ2VzIG9mIHRoYXQgb2JqZWN0LgoJICAqIEBwYXJhbSB7SlNPTn0gY29uZmlnIC0gQ29uZmlndXJhdGlvbiBkYXRhLiBUaGUgb25seSByZXF1aXJlZCBmaWVsZCBmb3Igbm93IGlzIHRoZSBydW50aW1lVVJMLgoJICAqLwoJICBmdW5jdGlvbiBTeW5jaGVyKG93bmVyLCBidXMsIGNvbmZpZykgewoJICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFN5bmNoZXIpOwoKCSAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKCSAgICBfdGhpcy5fYnVzID0gYnVzOwoKCSAgICBfdGhpcy5fc3ViVVJMID0gY29uZmlnLnJ1bnRpbWVVUkwgKyAnL3NtJzsKCgkgICAgX3RoaXMuX3JlcG9ydGVycyA9IHt9OwoJICAgIF90aGlzLl9vYnNlcnZlcnMgPSB7fTsKCSAgICBfdGhpcy5fcHJvdmlzaW9uYWxzID0ge307CgoJICAgIGJ1cy5hZGRMaXN0ZW5lcihvd25lciwgZnVuY3Rpb24gKG1zZykgewoJICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZgoJICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikgewoJICAgICAgICBjb25zb2xlLmluZm8oJ1tTeW5jaGVyXSBTeW5jaGVyLVJDVjogJywgbXNnKTsKCSAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewoJICAgICAgICAgIGNhc2UgJ2ZvcndhcmQnOgoJICAgICAgICAgICAgX3RoaXMuX29uRm9yd2FyZChtc2cpO2JyZWFrOwoJICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6CgkgICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVDcmVhdGUobXNnKTticmVhazsKCSAgICAgICAgICBjYXNlICdkZWxldGUnOgoJICAgICAgICAgICAgX3RoaXMuX29uUmVtb3RlRGVsZXRlKG1zZyk7YnJlYWs7CgkgICAgICAgIH0KCSAgICAgIH0KCSAgICB9KTsKCSAgfQoKCSAgLyoqCgkgICogVGhlIG93bmVyIG9mIHRoZSBTeW5jaGVyIGFuZCBhbGwgY3JlYXRlZCByZXBvcnRlcnMuCgkgICogQHR5cGUge0h5cGVydHlVUkx9CgkgICovCgoKCSAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoU3luY2hlciwgW3sKCSAgICBrZXk6ICdjcmVhdGUnLAoKCgkgICAgLyoqCgkgICAgKiBSZXF1ZXN0IGEgRGF0YU9iamVjdFJlcG9ydGVyIGNyZWF0aW9uLiBUaGUgVVJMIHdpbGwgYmUgYmUgcmVxdWVzdGVkIGJ5IHRoZSBhbGxvY2F0aW9uIG1lY2hhbmlzbS4KCSAgICAqIEBwYXJhbSAge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hCgkgICAgKiBAcGFyYW0gIHtIeXBlcnR5VVJMW119IG9ic2VydmVycyAtIExpc3Qgb2YgaHlwZXJ0aWVzIHRoYXQgYXJlIHByZS1hdXRob3JpemVkIGZvciBzdWJzY3JpcHRpb24KCSAgICAqIEBwYXJhbSAge0pTT059IGluaXRpYWxEYXRhIC0gSW5pdGlhbCBkYXRhIG9mIHRoZSByZXBvcnRlcgoJICAgICogQHBhcmFtICB7Ym9vbGVhbn0gc3RvcmUgLSAoT3B0aW9uYWwpIGlmIHRydWUsIG9iamVjdCB3aWxsIGJlIHN0b3JlZCBieSB0aGUgcnVudGltZQoJICAgICogQHBhcmFtICB7Ym9vbGVhbn0gcDJwIC0gKE9wdGlvbmFsKSBpZiB0cnVlLCBkYXRhIHN5bmNocm9uaXNhdGlvbiBzdHJlYW0gd2lsbCB1c2UgcDJwIGNvbm5lY3Rpb24gYXMgbXVjaCBhcyBwb3NzaWJsZQoJICAgICogQHBhcmFtICB7TWVzc2FnZUJvZHlJZGVudGl0eX0gaWRlbnRpdHkgLSAob3B0aW9uYWwpIGlkZW50aXR5IGRhdGEgdG8gYmUgYWRkZWQgdG8gaWRlbnRpdHkgdGhlIHVzZXIgcmVwb3J0ZXIuIFRvIGJlIHVzZWQgZm9yIGxlZ2FjeSBpZGVudGl0aWVzLgoJICAgICogQHJldHVybiB7UHJvbWlzZTxEYXRhT2JqZWN0UmVwb3J0ZXI+fSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBSZXBvcnRlci4gVGhlIHJlcG9ydGVyIGNhbiBiZSBhY2NlcHRlZCBvciByZWplY3RlZCBieSB0aGUgUEVQCgkgICAgKi8KCSAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKHNjaGVtYSwgb2JzZXJ2ZXJzLCBpbml0aWFsRGF0YSkgewoJICAgICAgdmFyIHN0b3JlID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKCSAgICAgIHZhciBwMnAgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IGZhbHNlOwoJICAgICAgdmFyIGlkZW50aXR5ID0gYXJndW1lbnRzWzVdOwoKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICB2YXIgY3JpdGVyaWEgPSB7fTsKCgkgICAgICBjcml0ZXJpYS5wMnAgPSBwMnA7CgkgICAgICBjcml0ZXJpYS5zdG9yZSA9IHN0b3JlOwoJICAgICAgY3JpdGVyaWEuc2NoZW1hID0gc2NoZW1hOwoJICAgICAgY3JpdGVyaWEub2JzZXJ2ZXJzID0gb2JzZXJ2ZXJzOwoJICAgICAgY3JpdGVyaWEuaW5pdGlhbERhdGEgPSBpbml0aWFsRGF0YTsKCgkgICAgICBpZiAoaWRlbnRpdHkpIHsKCSAgICAgICAgY3JpdGVyaWEuaWRlbnRpdHkgPSBpZGVudGl0eTsKCSAgICAgIH0KCgkgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdIC0gY3JlYXRlIFJlcG9ydGVyIC0gY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCgkgICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiBmYWxzZSB9KTsKCgkgICAgICByZXR1cm4gX3RoaXMuX2NyZWF0ZShjcml0ZXJpYSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAncmVzdW1lUmVwb3J0ZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gcmVzdW1lUmVwb3J0ZXJzKGNyaXRlcmlhKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoJICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBSZXBvcnRlciAtIGNyaXRlcmlhOiAnLCBjcml0ZXJpYSk7CgoJICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogdHJ1ZSB9KTsKCgkgICAgICByZXR1cm4gX3RoaXMuX2NyZWF0ZShjcml0ZXJpYSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAqIFJlcXVlc3QgYSBzdWJzY3JpcHRpb24gdG8gYW4gZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0LgoJICAgICogQHBhcmFtIHtTY2hlbWFVUkx9IHNjaGVtYSAtIEh5cGVydHkgQ2F0YWxvZ3VlIFVSTCBhZGRyZXNzIHRoYXQgY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIEpTT04tU2NoZW1hIGRlc2NyaWJpbmcgdGhlIERhdGEgT2JqZWN0IHNjaGVtYQoJICAgICogQHBhcmFtIHtPYmplY3RVUkx9IG9ialVSTCAtIEFkZHJlc3Mgb2YgdGhlIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdCB0byBiZSBvYnNlcnZlZAoJICAgICogQHBhcmFtIHtCb29sZWFufSBbc3RvcmU9ZmFsc2VdIC0gU2F2ZSB0aGUgc3Vic2NyaXB0aW9uIG9uIHRoZSBTeW5jaGVyIE1hbmFnZXIgZm9yIGZ1cnRoZXIgcmVzdW1lIChEZWZhdWx0IGlzIGZhbHNlKQoJICAgICogQHBhcmFtIHtCb29sZWFufSBbcDJwPWZhbHNlXSAtIEluZm8gYWJvdXQgaWYgc2hvdWxkIHVzZSBwMnAgY29ubmVjdGlvbiAoRGVmYXVsdCBpcyBmYWxzZSkKCSAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW211dHVhbD10cnVlXSAtIEluZm8gYWJvdXQgaWYgbWVzc2FnZXMgb2YgdGhpcyBvYmplY3Qgc2hvdWxkIGJlIGVuY3J5cHRlZCAoRGVmYXVsdCBpcyB0cnVlKQoJICAgICogQHBhcmFtICB7TWVzc2FnZUJvZHlJZGVudGl0eX0gaWRlbnRpdHkgLSAob3B0aW9uYWwpIGlkZW50aXR5IGRhdGEgdG8gYmUgYWRkZWQgdG8gaWRlbnRpdHkgdGhlIHVzZXIgcmVwb3J0ZXIuIFRvIGJlIHVzZWQgZm9yIGxlZ2FjeSBpZGVudGl0aWVzLgoJICAgICogQHJldHVybiB7UHJvbWlzZTxEYXRhT2JqZWN0T2JzZXJ2ZXI+fSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBvYnNlcnZlci4gSXQncyBhc3NvY2lhdGVkIHdpdGggdGhlIHJlcG9ydGVyLgoJICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnc3Vic2NyaWJlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gc3Vic2NyaWJlKHNjaGVtYSwgb2JqVVJMKSB7CgkgICAgICB2YXIgc3RvcmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlOwoJICAgICAgdmFyIHAycCA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogZmFsc2U7CgkgICAgICB2YXIgbXV0dWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB0cnVlOwoJICAgICAgdmFyIGlkZW50aXR5ID0gYXJndW1lbnRzWzVdOwoKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICB2YXIgY3JpdGVyaWEgPSB7fTsKCgkgICAgICBjcml0ZXJpYS5wMnAgPSBwMnA7CgkgICAgICBjcml0ZXJpYS5zdG9yZSA9IHN0b3JlOwoJICAgICAgY3JpdGVyaWEuc2NoZW1hID0gc2NoZW1hOwoKCSAgICAgIGNyaXRlcmlhLnJlc291cmNlID0gb2JqVVJMOwoJICAgICAgaWYgKGlkZW50aXR5KSB7CgkgICAgICAgIGNyaXRlcmlhLmlkZW50aXR5ID0gaWRlbnRpdHk7CgkgICAgICB9CgoJICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQoJICAgICAgY3JpdGVyaWEubXV0dWFsID0gbXV0dWFsOwoKCSAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIHN1YnNjcmliZV0gLSBzdWJzY3JpYmUgY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCgkgICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiBmYWxzZSB9KTsKCgkgICAgICByZXR1cm4gX3RoaXMuX3N1YnNjcmliZShjcml0ZXJpYSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAqIFJlcXVlc3QgYSBzdWJzY3JpcHRpb24gdG8gYW4gZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0LgoJICAgICogQHBhcmFtIHtjcml0ZXJpYX0gY3JpdGVyaWEgLSBJbmZvcm1hdGlvbiB0byBkaXNjb3ZlcnkgdGhlIG9ic2VydmVyIG9iamVjdAoJICAgICogQHJldHVybiB7UHJvbWlzZTxEYXRhT2JqZWN0T2JzZXJ2ZXI+fSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBvYnNlcnZlci4gSXQncyBhc3NvY2lhdGVkIHdpdGggdGhlIHJlcG9ydGVyLgoJICAgICovCgoJICB9LCB7CgkgICAga2V5OiAncmVzdW1lT2JzZXJ2ZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gcmVzdW1lT2JzZXJ2ZXJzKGNyaXRlcmlhKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoJICAgICAgdmFyIF9jcml0ZXJpYSA9IGNyaXRlcmlhIHx8IHt9OwoKCSAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShfY3JpdGVyaWEsIHsgcmVzdW1lOiB0cnVlIH0pOwoKCSAgICAgIHJldHVybiBfdGhpcy5fc3Vic2NyaWJlKF9jcml0ZXJpYSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAqIFJlcXVlc3QgYSByZWFkIGFjdGlvbiBvbiB0aGUgcmVwb3J0ZXIgb2JqZWN0CgkgICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gVVJMIG9mIHRoZSByZXBvcnRlciBvYmplY3QgdG8gYmUgcmVhZAoJICAgICogQHJldHVybiB7UHJvbWlzZTxPYmplY3Q+fSBSZXR1cm4gUHJvbWlzZSB0byBsYXN0IGF2YWlsYWJsZSBkYXRhIG9mIHRoZSByZXBvcnRlcgoJICAgICovCgoJICB9LCB7CgkgICAga2V5OiAncmVhZCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWQob2JqVVJMKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgZGlyZWN0bHkgdG8gcmVwb3J0ZXIgb2JqZWN0IChtYXliZSB0aGVyZSBpcyBubyBsaXN0ZW5lciBhdmFpbGFibGUsIHNvIGl0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCBNZXNzYWdlQnVzIC0+IHJlc29sdmUpCgkgICAgICAvL3dpbGwgcmVhY2ggdGhlIHJlbW90ZSBvYmplY3QgaW4gRGF0YU9iamVjdFJlcG9ydGVyIC0+IF9vblJlYWQKCSAgICAgIHZhciByZWFkTXNnID0gewoJICAgICAgICB0eXBlOiAncmVhZCcsIGZyb206IF90aGlzLl9vd25lciwgdG86IG9ialVSTAoJICAgICAgfTsKCgkgICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCSAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZWFkTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKCSAgICAgICAgICBjb25zb2xlLmxvZygncmVhZC1yZXNwb25zZTogJywgcmVwbHkpOwoJICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewoJICAgICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LnZhbHVlKTsKCSAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgIH0pOwoJICAgIH0KCgkgICAgLyoqCgkgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyBjcmVhdGUgYW5kIGRlbGV0ZSBldmVudHMgb2YgcmVtb3ZlIFJlcG9ydGVyIG9iamVjdHMuCgkgICAgKiBUaGlzIGlzIHJlbGVhdGVkIHRvIHRoZSBtZXNzYWdlbnMgc2VudCBieSBjcmVhdGUgdG8gdGhlIG9ic2VydmVycyBIeXBlcnR5IGFycmF5LgoJICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawoJICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25Ob3RpZmljYXRpb24nLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBvbk5vdGlmaWNhdGlvbihjYWxsYmFjaykgewoJICAgICAgdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyID0gY2FsbGJhY2s7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2NyZWF0ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGUoY3JpdGVyaWEpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgkgICAgICAgIHZhciByZXN1bWUgPSBjcml0ZXJpYS5yZXN1bWU7CgkgICAgICAgIHZhciBpbml0aWFsRGF0YSA9IGNyaXRlcmlhLmluaXRpYWxEYXRhIHx8IHt9OwoJICAgICAgICB2YXIgc2NoZW1hID0gdm9pZCAwOwoKCSAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKCSAgICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CgkgICAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zdWJVUkwsCgkgICAgICAgICAgYm9keTogeyByZXN1bWU6IHJlc3VtZSB9CgkgICAgICAgIH07CgoJICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdOiAnLCBjcml0ZXJpYSwgcmVxdWVzdE1zZyk7CgoJICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUgPSBpbml0aWFsRGF0YTsKCSAgICAgICAgcmVxdWVzdE1zZy5ib2R5LnZhbHVlLnJlcG9ydGVyID0gX3RoaXMuX293bmVyOwoKCSAgICAgICAgaWYgKGNyaXRlcmlhLnNjaGVtYSkgewoJICAgICAgICAgIHNjaGVtYSA9IGNyaXRlcmlhLnNjaGVtYTsKCSAgICAgICAgICByZXF1ZXN0TXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwoJICAgICAgICB9CgoJICAgICAgICBpZiAoY3JpdGVyaWEucDJwKSByZXF1ZXN0TXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwoJICAgICAgICBpZiAoY3JpdGVyaWEuc3RvcmUpIHJlcXVlc3RNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlOwoJICAgICAgICBpZiAoY3JpdGVyaWEub2JzZXJ2ZXJzKSByZXF1ZXN0TXNnLmJvZHkuYXV0aG9yaXNlID0gY3JpdGVyaWEub2JzZXJ2ZXJzOwoJICAgICAgICBpZiAoY3JpdGVyaWEuaWRlbnRpdHkpIHJlcXVlc3RNc2cuYm9keS5pZGVudGl0eSA9IGNyaXRlcmlhLmlkZW50aXR5OwoKCSAgICAgICAgaWYgKHJlc3VtZSkgewoJICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSByZXN1bWUgbWVzc2FnZTogJywgcmVxdWVzdE1zZyk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKCSAgICAgICAgfQoKCSAgICAgICAgLy9yZXF1ZXN0IGNyZWF0ZSB0byB0aGUgYWxsb2NhdGlvbiBzeXN0ZW0uIENhbiBiZSByZWplY3RlZCBieSB0aGUgUG9saWN5RW5naW5lLgoJICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2csIGZ1bmN0aW9uIChyZXBseSkgewoJICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUtcmVzcG9uc2U6ICcsIHJlcGx5KTsKCSAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKCSAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gYWNjZXB0ZWQKCSAgICAgICAgICAgIHZhciBvYmpVUkwgPSByZXBseS5ib2R5LnJlc291cmNlOwoKCSAgICAgICAgICAgIGlmIChyZXN1bWUpIHsKCSAgICAgICAgICAgICAgc2NoZW1hID0gcmVwbHkuYm9keS5zY2hlbWE7CgkgICAgICAgICAgICAgIGluaXRpYWxEYXRhID0gcmVwbHkuYm9keS52YWx1ZTsKCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgc2NoZW1hLCAnb24nLCBpbml0aWFsRGF0YSwgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CgkgICAgICAgICAgICBfdGhpcy5fcmVwb3J0ZXJzW29ialVSTF0gPSBuZXdPYmo7CgoJICAgICAgICAgICAgcmVzb2x2ZShuZXdPYmopOwoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAvL3JlcG9ydGVyIGNyZWF0aW9uIHJlamVjdGVkCgkgICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3N1YnNjcmliZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9zdWJzY3JpYmUoY3JpdGVyaWEpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgoJICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsU3Vic2NyaWJlCgkgICAgICAgIHZhciBzdWJzY3JpYmVNc2cgPSB7CgkgICAgICAgICAgdHlwZTogJ3N1YnNjcmliZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zdWJVUkwsCgkgICAgICAgICAgYm9keToge30KCSAgICAgICAgfTsKCgkgICAgICAgIC8vIEh5cGVydHkgcmVxdWVzdCB0byBiZSBhbiBPYnNlcnZlcgoJICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNoeXBlcnR5LXJlcXVlc3QtdG8tYmUtYW4tb2JzZXJ2ZXIKCgkgICAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciB0aGUgc2FtZSBIeXBlcnR5IFVSTAoJICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNyZXN1bWUtc3Vic2NyaXB0aW9ucy1mb3ItdGhlLXNhbWUtaHlwZXJ0eS11cmwKCgkgICAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciBhIGNlcnRhaW4gdXNlciBhbmQgZGF0YSBzY2hlbWEgaW5kZXBlbmRlbnRseSBvZiB0aGUgSHlwZXJ0eSBVUkwuCgkgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3Qvc3BlY3MvYmxvYi9tYXN0ZXIvbWVzc2FnZXMvZGF0YS1zeW5jLW1lc3NhZ2VzLm1kI3Jlc3VtZS1zdWJzY3JpcHRpb25zLWZvci1hLWNlcnRhaW4tdXNlci1hbmQtZGF0YS1zY2hlbWEtaW5kZXBlbmRlbnRseS1vZi10aGUtaHlwZXJ0eS11cmwKCSAgICAgICAgaWYgKGNyaXRlcmlhKSB7CgkgICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdwMnAnKSkgc3Vic2NyaWJlTXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwoJICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgnc3RvcmUnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc3RvcmUgPSBjcml0ZXJpYS5zdG9yZTsKCSAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ3NjaGVtYScpKSBzdWJzY3JpYmVNc2cuYm9keS5zY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CgkgICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdpZGVudGl0eScpKSBzdWJzY3JpYmVNc2cuYm9keS5pZGVudGl0eSA9IGNyaXRlcmlhLmlkZW50aXR5OwoJICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgncmVzb3VyY2UnKSkgc3Vic2NyaWJlTXNnLmJvZHkucmVzb3VyY2UgPSBjcml0ZXJpYS5yZXNvdXJjZTsKCSAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ2lkZW50aXR5JykpIHN1YnNjcmliZU1zZy5ib2R5LmlkZW50aXR5ID0gY3JpdGVyaWEuaWRlbnRpdHk7CgkgICAgICAgIH0KCgkgICAgICAgIHN1YnNjcmliZU1zZy5ib2R5LnJlc3VtZSA9IGNyaXRlcmlhLnJlc3VtZTsKCgkgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKCSAgICAgICAgdmFyIG11dHVhbEF1dGhlbnRpY2F0aW9uID0gY3JpdGVyaWEubXV0dWFsOwoJICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ211dHVhbCcpKSBzdWJzY3JpYmVNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbEF1dGhlbnRpY2F0aW9uOwoKCSAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIHN1YnNjcmliZSBtZXNzYWdlOiAnLCBjcml0ZXJpYSwgc3Vic2NyaWJlTXNnKTsKCgkgICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KCSAgICAgICAgLy9Qcm92aXNpb25hbCBkYXRhIGlzIGFwcGxpZWQgdG8gdGhlIERhdGFPYmplY3RPYnNlcnZlciBhZnRlciBjb25maXJtYXRpb24uIE9yIGRpc2NhcmRlZCBpZiB0aGVyZSBpcyBubyBjb25maXJtYXRpb24uCgkgICAgICAgIC8vZm9yIG1vcmUgaW5mbyBzZWUgdGhlIERhdGFQcm92aXNpb25hbCBjbGFzcyBkb2N1bWVudGF0aW9uLgoJICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIHN1YnNjcmliZS1yZXNwb25zZTogJywgcmVwbHkpOwoKCSAgICAgICAgICB2YXIgc2NoZW1hID0gcmVwbHkuYm9keS5zY2hlbWE7CgkgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgoJICAgICAgICAgIHZhciBuZXdQcm92aXNpb25hbCA9IF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKCSAgICAgICAgICBkZWxldGUgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwoJICAgICAgICAgIGlmIChuZXdQcm92aXNpb25hbCkgbmV3UHJvdmlzaW9uYWwuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCgkgICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA8IDIwMCkgewoJICAgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIG5ldyBEYXRhUHJvdmlzaW9uYWw6ICcsIHJlcGx5LmJvZHkuY2hpbGRyZW5SZXNvdXJjZXMsIG9ialVSTCk7CgkgICAgICAgICAgICBuZXdQcm92aXNpb25hbCA9IG5ldyBfRGF0YVByb3Zpc2lvbmFsMi5kZWZhdWx0KF90aGlzLl9vd25lciwgb2JqVVJMLCBfdGhpcy5fYnVzLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKCSAgICAgICAgICAgIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXSA9IG5ld1Byb3Zpc2lvbmFsOwoJICAgICAgICAgIH0gZWxzZSBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKCSAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YSBPYmplY3QgT2JzZXJ2ZXI6ICcsIHJlcGx5LCBfdGhpcy5fcHJvdmlzaW9uYWxzKTsKCgkgICAgICAgICAgICB2YXIgaW5pdGlhbERhdGEgPSByZXBseS5ib2R5LnZhbHVlOwoJICAgICAgICAgICAgaWYgKCFpbml0aWFsRGF0YS5oYXNPd25Qcm9wZXJ0eSgnY2hpbGRyZW5zJykpIHsKCSAgICAgICAgICAgICAgaW5pdGlhbERhdGEuY2hpbGRyZW5zID0ge307CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoIWluaXRpYWxEYXRhLmhhc093blByb3BlcnR5KCdkYXRhJykpIHsKCSAgICAgICAgICAgICAgaW5pdGlhbERhdGEuZGF0YSA9IHt9OwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIC8vVE9ETzogbXV0dWFsQXV0aGVudGljYXRpb24gRm9yIEZ1cnRoZXIgU3R1ZHkKCSAgICAgICAgICAgIHZhciBuZXdPYmogPSBuZXcgX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdChfdGhpcywgb2JqVVJMLCBzY2hlbWEsICdvbicsIGluaXRpYWxEYXRhLCBuZXdQcm92aXNpb25hbC5jaGlsZHJlbiwgcmVwbHkuYm9keS52ZXJzaW9uLCBtdXR1YWxBdXRoZW50aWNhdGlvbik7CgkgICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF0gPSBuZXdPYmo7CgoJICAgICAgICAgICAgcmVzb2x2ZShuZXdPYmopOwoJICAgICAgICAgICAgbmV3UHJvdmlzaW9uYWwuYXBwbHkobmV3T2JqKTsKCSAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgIH0pOwoJICAgIH0KCgkgICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSBsb2NhbCBydW50aW1lIFJlcG9ydGVyT2JqZWN0IC0+IF9vblJlbW90ZVN1YnNjcmliZQoKCSAgfSwgewoJICAgIGtleTogJ19vbkZvcndhcmQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Gb3J3YXJkKG1zZykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICB2YXIgcmVwb3J0ZXIgPSBfdGhpcy5fcmVwb3J0ZXJzW21zZy5ib2R5LnRvXTsKCSAgICAgIHJlcG9ydGVyLl9vbkZvcndhcmQobXNnKTsKCSAgICB9CgoJICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIFN5bmNoZXIgLT4gY3JlYXRlICh0aGlzIGlzIGFjdHVhbGx5IGFuIGludml0YXRpb24gdG8gc3Vic2NyaWJlKQoKCSAgfSwgewoJICAgIGtleTogJ19vblJlbW90ZUNyZWF0ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlbW90ZUNyZWF0ZShtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgLy9yZW1vdmUgIi9zdWJzY3JpcHRpb24iIGZyb20gdGhlIFVSTAoJICAgICAgdmFyIHJlc291cmNlID0gbXNnLmZyb20uc2xpY2UoMCwgLTEzKTsKCgkgICAgICB2YXIgZXZlbnQgPSB7CgkgICAgICAgIHR5cGU6IG1zZy50eXBlLAoJICAgICAgICBmcm9tOiBtc2cuYm9keS5zb3VyY2UsCgkgICAgICAgIHVybDogcmVzb3VyY2UsCgkgICAgICAgIHNjaGVtYTogbXNnLmJvZHkuc2NoZW1hLAoJICAgICAgICB2YWx1ZTogbXNnLmJvZHkudmFsdWUsCgkgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCgkgICAgICAgIGFjazogZnVuY3Rpb24gYWNrKHR5cGUpIHsKCSAgICAgICAgICB2YXIgbFR5cGUgPSAyMDA7CgkgICAgICAgICAgaWYgKHR5cGUpIHsKCSAgICAgICAgICAgIGxUeXBlID0gdHlwZTsKCSAgICAgICAgICB9CgoJICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQoJICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewoJICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCgkgICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlIH0KCSAgICAgICAgICB9KTsKCSAgICAgICAgfQoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcikgewoJICAgICAgICBjb25zb2xlLmluZm8oJ1tTeW5jaGVyXSBOT1RJRklDQVRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKCSAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CgkgICAgICB9CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gZGVsZXRlCgoJICB9LCB7CgkgICAga2V5OiAnX29uUmVtb3RlRGVsZXRlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVtb3RlRGVsZXRlKG1zZykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCgkgICAgICB2YXIgcmVzb3VyY2UgPSBtc2cuYm9keS5yZXNvdXJjZTsKCgkgICAgICB2YXIgb2JqZWN0ID0gX3RoaXMuX29ic2VydmVyc1tyZXNvdXJjZV07CgkgICAgICBpZiAob2JqZWN0KSB7CgkgICAgICAgIHZhciBldmVudCA9IHsKCSAgICAgICAgICB0eXBlOiBtc2cudHlwZSwKCSAgICAgICAgICB1cmw6IHJlc291cmNlLAoJICAgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCgkgICAgICAgICAgYWNrOiBmdW5jdGlvbiBhY2sodHlwZSkgewoJICAgICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwoJICAgICAgICAgICAgaWYgKHR5cGUpIHsKCSAgICAgICAgICAgICAgbFR5cGUgPSB0eXBlOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIC8vVE9ETzogYW55IG90aGVyIGRpZmZlcmVudCBvcHRpb25zIGZvciB0aGUgcmVsZWFzZSBwcm9jZXNzLCBsaWtlIGFjY2VwdCBidXQgbm9yIHJlbGVhc2UgbG9jYWw/CgkgICAgICAgICAgICBpZiAobFR5cGUgPT09IDIwMCkgewoJICAgICAgICAgICAgICBvYmplY3QuZGVsZXRlKCk7CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgLy9zZW5kIGFjayByZXNwb25zZSBtZXNzYWdlCgkgICAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKCSAgICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCgkgICAgICAgICAgICAgIGJvZHk6IHsgY29kZTogbFR5cGUsIHNvdXJjZTogX3RoaXMuX293bmVyIH0KCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgIH0KCSAgICAgICAgfTsKCgkgICAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ05PVElGSUNBVElPTi1FVkVOVDogJywgZXZlbnQpOwoJICAgICAgICAgIF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIoZXZlbnQpOwoJICAgICAgICB9CgkgICAgICB9IGVsc2UgewoJICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKCSAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKCSAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwNCwgc291cmNlOiBfdGhpcy5fb3duZXIgfQoJICAgICAgICB9KTsKCSAgICAgIH0KCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdvd25lcicsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fb3duZXI7CgkgICAgfQoKCSAgICAvKioKCSAgICAqIEFsbCBvd25lZCByZXBvcnRlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgY3JlYXRlCgkgICAgKiBAdHlwZSB7T2JqZWN0PFVSTCwgRGF0YU9iamVjdFJlcG9ydGVyPn0KCSAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3JlcG9ydGVycycsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fcmVwb3J0ZXJzOwoJICAgIH0KCgkgICAgLyoqCgkgICAgKiBBbGwgb3duZWQgb2JzZXJ2ZXJzLCB0aGUgb25lcyB0aGF0IHdlcmUgY3JlYXRlZCBieSBhIGxvY2FsIHN1YnNjcmlwdGlvbgoJICAgICogQHR5cGUge09iamVjdDxVUkwsIERhdGFPYmplY3RPYnNlcnZlcj59CgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvYnNlcnZlcnMnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX29ic2VydmVyczsKCSAgICB9CgkgIH1dKTsKCSAgcmV0dXJuIFN5bmNoZXI7Cgl9KCk7IC8qKgoJICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoJICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkgICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCgkgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCgkgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCgkgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSAgICAgKgoJICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAgICAgKgoJICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgICAgICoKCSAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgICAgICoqLwoKCWV4cG9ydHMuZGVmYXVsdCA9IFN5bmNoZXI7Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9KSwKCS8qIDEzNCAqLywKCS8qIDEzNSAqLywKCS8qIDEzNiAqLywKCS8qIDEzNyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKCXZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8qKgoJKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKCSogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKCSogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCgkqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCgkqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoJKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCgkqIENvcHlyaWdodCAyMDE2IEFwaXplZQoJKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoJKgoJKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSoKCSogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSoKCSogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSoqLwoKCS8qKgoJICogQGFjY2VzcyBwcml2YXRlCgkgKiBUaGlzIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvciBjb2xsZWN0aW5nIGRlbHRhIGNoYW5nZXMgaW4gcmVtb3RlIG9iamVjdHMsIGJlZm9yZSB0aGUgcmVzcG9uc2Ugb2Ygc3Vic2NyaXB0aW9uIHJlYWNoIHRoZSBvYnNlcnZlci4KCSAqIEl0J3MgdXNlZCBpbiBTeW5jaGVyIC0+IHN1YnNjcmliZS4gVGhlIGZsb3cgaXMgZGVmaW5lZCBhczoKCSAqIDEuIChvYnNlcnZlcikgLS1zdWJzY3JpYmUtLT4gKHJlcG9ydGVyKQoJICogMi4gKG9ic2VydmVyKSA8LS1kZWx0YSB1cGRhdGVzLS0gKHJlcG9ydGVyKQoJICogMy4gKG9ic2VydmVyKSA8LS1zdWJzY3JpYmUgcmVzcG9uc2UtLSAocmVwb3J0ZXIpCgkgKiBUaGlzIG1lYW5zIHRoYXQgdGhlcmUgY291bGQgYmUgZGVsdGEgdXBkYXRlcyB0cmFuc2ZlcnJlZCBiZWZvcmUgdGhlIHN1YnNjcmlwdGlvbiBjb25maXJtYXRpb24uCgkgKiBTaW5jZSB0aGVyZSBpcyBubyBEYXRhT2JqZWN0T2JzZXJ2ZXIgYmVmb3JlIHRoZSB1YnNjcmlwdGlvbiBjb25maXJtYXRpb24sIHRoZXJlIHNob3VsZCBiZSBzb21lIG90aGVyIG9iamVjdCBjb2xsZWN0aW5nIHRoZSB1cGRhdGVzLgoJICogUHJvdmlzaW9uYWwgZGF0YSBpcyBhcHBsaWVkIHRvIHRoZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgYWZ0ZXIgY29uZmlybWF0aW9uLiBPciBkaXNjYXJkZWQgaWYgdGhlcmUgaXMgbm8gY29uZmlybWF0aW9uLgoJICovCgl2YXIgRGF0YVByb3Zpc2lvbmFsID0gZnVuY3Rpb24gKCkgewoJICAvKiBwcml2YXRlCgkgIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXQoJICBfbGlzdGVuZXI6IE1zZ0xpc3RlbmVyCgkgICBfY2hhbmdlczogW10KCSAgKi8KCgkgIGZ1bmN0aW9uIERhdGFQcm92aXNpb25hbChvd25lciwgdXJsLCBidXMsIGNoaWxkcmVuKSB7CgkgICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YVByb3Zpc2lvbmFsKTsKCgkgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgX3RoaXMuX293bmVyID0gb3duZXI7CgkgICAgX3RoaXMuX3VybCA9IHVybDsKCSAgICBfdGhpcy5fYnVzID0gYnVzOwoJICAgIF90aGlzLl9jaGlsZHJlbiA9IGNoaWxkcmVuOwoKCSAgICBfdGhpcy5fY2hhbmdlcyA9IFtdOwoJICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwoJICB9CgoJICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhUHJvdmlzaW9uYWwsIFt7CgkgICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgICAgY29uc29sZS5sb2coJ0RhdGFQcm92aXNpb25hbC0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwoJICAgICAgICBfdGhpcy5fY2hhbmdlcy5wdXNoKG1zZyk7CgkgICAgICB9KTsKCgkgICAgICAvKgoJICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzID0gW107CgkgICAgICBpZiAoX3RoaXMuX2NoaWxkcmVuKSB7CgkgICAgICAgIGxldCBjaGlsZEJhc2VVUkwgPSB1cmwgKyAnL2NoaWxkcmVuLyc7CgkgICAgICAgIF90aGlzLl9jaGlsZHJlbi5mb3JFYWNoKChjaGlsZCkgPT4gewoJICAgICAgICAgIGxldCBjaGlsZFVSTCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOwoJICAgICAgICAgIGxldCBsaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoY2hpbGRVUkwsIChtc2cpID0+IHsKCSAgICAgICAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKCSAgICAgICAgICAgIGlmIChtc2cuZnJvbSAhPT0gb3duZXIpIHsKCSAgICAgICAgICAgICAgY29uc29sZS5sb2cobXNnKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9KTsKCSAgICAgICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpOwoJICAgICAgICB9KTsKCSAgICAgIH0qLwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKCgkgICAgICAvKl90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5mb3JFYWNoKChsaXN0ZW5lcikgPT4gewoJICAgICAgICBsaXN0ZW5lci5yZW1vdmUoKTsKCSAgICAgIH0pOyovCgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnYXBwbHknLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBseShvYnNlcnZlcikgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCSAgICAgIF90aGlzLl9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZSkgewoJICAgICAgICBvYnNlcnZlci5fY2hhbmdlT2JqZWN0KG9ic2VydmVyLl9zeW5jT2JqLCBjaGFuZ2UpOwoJICAgICAgfSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnY2hpbGRyZW4nLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuOwoJICAgIH0KCSAgfV0pOwoJICByZXR1cm4gRGF0YVByb3Zpc2lvbmFsOwoJfSgpOwoKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFQcm92aXNpb25hbDsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0pLAoJLyogMTM4ICovLAoJLyogMTM5ICovLAoJLyogMTQwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygxNDcpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiAxNDEgKi8sCgkvKiAxNDIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0OSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCgkvKioqLyB9KSwKCS8qIDE0MyAqLywKCS8qIDE0NCAqLywKCS8qIDE0NSAqLywKCS8qIDE0NiAqLywKCS8qIDE0NyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oMTUzKTsKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3QuYXNzaWduOwoKCS8qKiovIH0pLAoJLyogMTQ4ICovLAoJLyogMTQ5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygxNTUpOwoJdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpewoJICByZXR1cm4gJE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMTUwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCS8vIDE5LjEuMi4xIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBzb3VyY2UsIC4uLikKCXZhciBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpCgkgICwgZ09QUyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU4KQoJICAsIHBJRSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkKCSAgLCB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCgkgICwgSU9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU2KQoJICAsICRhc3NpZ24gID0gT2JqZWN0LmFzc2lnbjsKCgkvLyBzaG91bGQgd29yayB3aXRoIHN5bWJvbHMgYW5kIHNob3VsZCBoYXZlIGRldGVybWluaXN0aWMgcHJvcGVydHkgb3JkZXIgKFY4IGJ1ZykKCW1vZHVsZS5leHBvcnRzID0gISRhc3NpZ24gfHwgX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKCSAgdmFyIEEgPSB7fQoJICAgICwgQiA9IHt9CgkgICAgLCBTID0gU3ltYm9sKCkKCSAgICAsIEsgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3QnOwoJICBBW1NdID0gNzsKCSAgSy5zcGxpdCgnJykuZm9yRWFjaChmdW5jdGlvbihrKXsgQltrXSA9IGs7IH0pOwoJICByZXR1cm4gJGFzc2lnbih7fSwgQSlbU10gIT0gNyB8fCBPYmplY3Qua2V5cygkYXNzaWduKHt9LCBCKSkuam9pbignJykgIT0gSzsKCX0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycwoJICB2YXIgVCAgICAgPSB0b09iamVjdCh0YXJnZXQpCgkgICAgLCBhTGVuICA9IGFyZ3VtZW50cy5sZW5ndGgKCSAgICAsIGluZGV4ID0gMQoJICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZgoJICAgICwgaXNFbnVtICAgICA9IHBJRS5mOwoJICB3aGlsZShhTGVuID4gaW5kZXgpewoJICAgIHZhciBTICAgICAgPSBJT2JqZWN0KGFyZ3VtZW50c1tpbmRleCsrXSkKCSAgICAgICwga2V5cyAgID0gZ2V0U3ltYm9scyA/IGdldEtleXMoUykuY29uY2F0KGdldFN5bWJvbHMoUykpIDogZ2V0S2V5cyhTKQoJICAgICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAoJICAgICAgLCBqICAgICAgPSAwCgkgICAgICAsIGtleTsKCSAgICB3aGlsZShsZW5ndGggPiBqKWlmKGlzRW51bS5jYWxsKFMsIGtleSA9IGtleXNbaisrXSkpVFtrZXldID0gU1trZXldOwoJICB9IHJldHVybiBUOwoJfSA6ICRhc3NpZ247CgoJLyoqKi8gfSksCgkvKiAxNTEgKi8sCgkvKiAxNTIgKi8sCgkvKiAxNTMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjMuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlKQoJdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKCSRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GLCAnT2JqZWN0Jywge2Fzc2lnbjogX193ZWJwYWNrX3JlcXVpcmVfXygxNTApfSk7CgoJLyoqKi8gfSksCgkvKiAxNTQgKi8sCgkvKiAxNTUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApCgl2YXIgdG9JT2JqZWN0ICAgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCgkgICwgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IF9fd2VicGFja19yZXF1aXJlX18oNTcpLmY7CgoJX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2dldE93blByb3BlcnR5RGVzY3JpcHRvcicsIGZ1bmN0aW9uKCl7CgkgIHJldHVybiBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7CgkgICAgcmV0dXJuICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodG9JT2JqZWN0KGl0KSwga2V5KTsKCSAgfTsKCX0pOwoKCS8qKiovIH0pLAoJLyogMTU2ICovLAoJLyogMTU3ICovLAoJLyogMTU4ICovLAoJLyogMTU5ICovLAoJLyogMTYwICovLAoJLyogMTYxICovLAoJLyogMTYyICovLAoJLyogMTYzICovLAoJLyogMTY0ICovLAoJLyogMTY1ICovLAoJLyogMTY2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gZXhwb3J0cy5EYXRhT2JqZWN0UmVwb3J0ZXIgPSBleHBvcnRzLlN5bmNoZXIgPSB1bmRlZmluZWQ7CgoJdmFyIF9TeW5jaGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzMpOwoKCXZhciBfU3luY2hlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9TeW5jaGVyKTsKCgl2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCgl2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKCXZhciBfRGF0YU9iamVjdE9ic2VydmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjApOwoKCXZhciBfRGF0YU9iamVjdE9ic2VydmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RPYnNlcnZlcik7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLlN5bmNoZXIgPSBfU3luY2hlcjIuZGVmYXVsdDsKCWV4cG9ydHMuRGF0YU9iamVjdFJlcG9ydGVyID0gX0RhdGFPYmplY3RSZXBvcnRlcjIuZGVmYXVsdDsKCWV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdDsKCgkvKioqLyB9KQoJLyoqKioqKi8gXSk7Cgl9KTsKCS8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKemIzVnlZMlZ6SWpwYkluZGxZbkJoWTJzNkx5OHZkMlZpY0dGamF5OTFibWwyWlhKellXeE5iMlIxYkdWRVpXWnBibWwwYVc5dVB6VmpZVFlpTENKM1pXSndZV05yT2k4dkwzZGxZbkJoWTJzdlltOXZkSE4wY21Gd0lEaG1ZMlF6Tm1JMU5HRTVZV1kxTlRZNU1qTXlQelJqT1RJaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWTI5eVpTNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOW5iRzlpWVd3dWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZlpHVnpZM0pwY0hSdmNuTXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZkMnR6TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDI5aWFtVmpkQzFrY0M1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5aGJpMXZZbXBsWTNRdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFYTXRiMkpxWldOMExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyaHBaR1V1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMmhsYkhCbGNuTXZZMnhoYzNORFlXeHNRMmhsWTJzdWFuTS9NakZoWmlJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlsZUhCdmNuUXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlpWVdKbGJDMXlkVzUwYVcxbEwyaGxiSEJsY25NdlkzSmxZWFJsUTJ4aGMzTXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZabUZwYkhNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFHRnpMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM1J2TFdsdlltcGxZM1F1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWTNSNExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzQnliM0JsY25SNUxXUmxjMk11YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYVhSbGNtRjBiM0p6TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJSdmJTMWpjbVZoZEdVdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmIySnFaV04wTFd0bGVYTXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZUzFtZFc1amRHbHZiaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlqYjJZdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmRHOHRjSEpwYldsMGFYWmxMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM05sZEMxMGJ5MXpkSEpwYm1jdGRHRm5MbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM1ZwWkM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5a1pXWnBibVZrTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJsbE9DMWtiMjB0WkdWbWFXNWxMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMnhwWW5KaGNua3Vhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZjMmhoY21Wa0xXdGxlUzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTkwYnkxcGJuUmxaMlZ5TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJWdWRXMHRZblZuTFd0bGVYTXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZjMmhoY21Wa0xtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZbUZpWld3dGNuVnVkR2x0WlM5amIzSmxMV3B6TDI5aWFtVmpkQzluWlhRdGNISnZkRzkwZVhCbExXOW1MbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM1J2TFc5aWFtVmpkQzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJKaFltVnNMWEoxYm5ScGJXVXZZMjl5WlMxcWN5OXZZbXBsWTNRdlpHVm1hVzVsTFhCeWIzQmxjblI1TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlvWld4d1pYSnpMMmx1YUdWeWFYUnpMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOW9aV3h3WlhKekwzQnZjM05wWW14bFEyOXVjM1J5ZFdOMGIzSlNaWFIxY200dWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdlptNHZiMkpxWldOMEwyUmxabWx1WlMxd2NtOXdaWEowZVM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5dlltcGxZM1F0WTNKbFlYUmxMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZaWE0yTG05aWFtVmpkQzVrWldacGJtVXRjSEp2Y0dWeWRIa3Vhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhWFJsY2kxa1pXWnBibVV1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMk52Y21VdGFuTXZhbk52Ymk5emRISnBibWRwWm5rdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmIySnFaV04wTFhCcFpTNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOW9kRzFzTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDI5aWFtVmpkQzFuY0c4dWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmIySnFaV04wTFd0bGVYTXRhVzUwWlhKdVlXd3Vhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZiMkpxWldOMExYTmhjQzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl5WldSbFptbHVaUzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTkwYnkxc1pXNW5kR2d1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmZDJ0ekxXUmxabWx1WlM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5M2EzTXRaWGgwTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNMkxuTjBjbWx1Wnk1cGRHVnlZWFJ2Y2k1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDNkbFlpNWtiMjB1YVhSbGNtRmliR1V1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmFuTnZiaTl6ZEhKcGJtZHBabmt1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWTJ4aGMzTnZaaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlwYjJKcVpXTjBMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMjlpYW1WamRDMW5iM0JrTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDI5aWFtVmpkQzFuYjNCekxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZbUZpWld3dGNuVnVkR2x0WlM5b1pXeHdaWEp6TDNSNWNHVnZaaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTloWkdRdGRHOHRkVzV6WTI5d1lXSnNaWE11YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWVhKeVlYa3RhVzVqYkhWa1pYTXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhWFJsY2kxamNtVmhkR1V1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYVhSbGNpMXpkR1Z3TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDI5aWFtVmpkQzFrY0hNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmIySnFaV04wTFdkdmNHNHVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZjM1J5YVc1bkxXRjBMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM1JoYzJzdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmRHOHRhVzVrWlhndWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5bGN6WXVZWEp5WVhrdWFYUmxjbUYwYjNJdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJOdmNtVXRhbk12YjJKcVpXTjBMMnRsZVhNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJOdmNtVXRhbk12Y0hKdmJXbHpaUzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl0WlhSaExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlkyOXlaUzVuWlhRdGFYUmxjbUYwYjNJdGJXVjBhRzlrTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlqYjNKbExXcHpMMjlpYW1WamRDOWpjbVZoZEdVdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJOdmNtVXRhbk12YjJKcVpXTjBMM05sZEMxd2NtOTBiM1I1Y0dVdGIyWXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlpWVdKbGJDMXlkVzUwYVcxbEwyTnZjbVV0YW5NdmMzbHRZbTlzTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlqYjNKbExXcHpMM041YldKdmJDOXBkR1Z5WVhSdmNpNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOW1iaTl2WW1wbFkzUXZZM0psWVhSbExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMjlpYW1WamRDOW5aWFF0Y0hKdmRHOTBlWEJsTFc5bUxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMjlpYW1WamRDOXJaWGx6TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwyOWlhbVZqZEM5elpYUXRjSEp2ZEc5MGVYQmxMVzltTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwzQnliMjFwYzJVdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdlptNHZjM2x0WW05c0wybHVaR1Y0TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwzTjViV0p2YkM5cGRHVnlZWFJ2Y2k1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5aGJpMXBibk4wWVc1alpTNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWxiblZ0TFd0bGVYTXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZabTl5TFc5bUxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgybHVkbTlyWlM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5cGN5MWhjbkpoZVMxcGRHVnlMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMmx6TFdGeWNtRjVMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMmwwWlhJdFkyRnNiQzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlwZEdWeUxXUmxkR1ZqZEM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5clpYbHZaaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl0YVdOeWIzUmhjMnN1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMV2R2Y0c0dFpYaDBMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM0psWkdWbWFXNWxMV0ZzYkM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5elpYUXRjSEp2ZEc4dWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmMyVjBMWE53WldOcFpYTXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZjM0JsWTJsbGN5MWpiMjV6ZEhKMVkzUnZjaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMlZ6Tmk1dlltcGxZM1F1WTNKbFlYUmxMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZaWE0yTG05aWFtVmpkQzVuWlhRdGNISnZkRzkwZVhCbExXOW1MbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZaWE0yTG05aWFtVmpkQzVyWlhsekxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNXpaWFF0Y0hKdmRHOTBlWEJsTFc5bUxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlpYTTJMbkJ5YjIxcGMyVXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWxjell1YzNsdFltOXNMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZaWE0zTG5ONWJXSnZiQzVoYzNsdVl5MXBkR1Z5WVhSdmNpNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwyVnpOeTV6ZVcxaWIyd3ViMkp6WlhKMllXSnNaUzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTl6Y21NdmRYUnBiSE12ZFhScGJITXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTl3Y205NGVTMXZZbk5sY25abEwybHVaR1Y0TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDNOeVl5OXplVzVqYUdWeUwwUmhkR0ZQWW1wbFkzUlBZbk5sY25abGNpNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOXpjbU12YzNsdVkyaGxjaTlFWVhSaFQySnFaV04wVW1Wd2IzSjBaWEl1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2YzNKakwzTjVibU5vWlhJdlJHRjBZVTlpYW1WamRDNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOXpjbU12YzNsdVkyaGxjaTlFWVhSaFQySnFaV04wUTJocGJHUXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZjM0pqTDNONWJtTm9aWEl2VUhKdmVIbFBZbXBsWTNRdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJobGJIQmxjbk12WjJWMExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzTnlZeTl6ZVc1amFHVnlMMU41Ym1Ob1pYSXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZjM0pqTDNONWJtTm9aWEl2UkdGMFlWQnliM1pwYzJsdmJtRnNMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOWpiM0psTFdwekwyOWlhbVZqZEM5aGMzTnBaMjR1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMk52Y21VdGFuTXZiMkpxWldOMEwyZGxkQzF2ZDI0dGNISnZjR1Z5ZEhrdFpHVnpZM0pwY0hSdmNpNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOW1iaTl2WW1wbFkzUXZZWE56YVdkdUxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMjlpYW1WamRDOW5aWFF0YjNkdUxYQnliM0JsY25SNUxXUmxjMk55YVhCMGIzSXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZiMkpxWldOMExXRnpjMmxuYmk1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDJWek5pNXZZbXBsWTNRdVlYTnphV2R1TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNMkxtOWlhbVZqZEM1blpYUXRiM2R1TFhCeWIzQmxjblI1TFdSbGMyTnlhWEIwYjNJdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmMzSmpMMU41Ym1Ob1pYSXVhbk1pWFN3aWJtRnRaWE1pT2xzaVpHbDJhV1JsVlZKTUlpd2laR2wyYVdSbFJXMWhhV3dpTENKbGJYQjBlVTlpYW1WamRDSXNJbVJsWlhCRGJHOXVaU0lzSW1kbGRGVnpaWEpWVWt4R2NtOXRSVzFoYVd3aUxDSm5aWFJWYzJWeVJXMWhhV3hHY205dFZWSk1JaXdpWTI5dWRtVnlkRlJ2VlhObGNsVlNUQ0lzSW5WeWJDSXNJa1Z5Y205eUlpd2ljbVZqZFhKelpTSXNJblpoYkhWbElpd2ljbVZuWlhnaUxDSnpkV0p6ZENJc0luQmhjblJ6SWl3aWNtVndiR0ZqWlNJc0luTndiR2wwSWl3aWFXNWpiSFZrWlhNaUxDSnlaWE4xYkhRaUxDSjBlWEJsSWl3aVpHOXRZV2x1SWl3aWFXUmxiblJwZEhraUxDSmpiMjV6YjJ4bElpd2laWEp5YjNJaUxDSnpZMmhsYldVaUxDSnpkV0p6ZEhJaUxDSnBibVJsZUU5bUlpd2laVzFoYVd3aUxDSnBibVJsZUU5bVFYUWlMQ0oxYzJWeWJtRnRaU0lzSW5OMVluTjBjbWx1WnlJc0lteGxibWQwYUNJc0ltOWlhbVZqZENJc0ltOWlhaUlzSWtwVFQwNGlMQ0p3WVhKelpTSXNJblZ6WlhKRmJXRnBiQ0lzSW5WelpYSlZVa3dpTENKcFpHVnVkR2xtYVdWeUlpd2laR2wyYVdSbFpGVlNUQ0lzSWtacGJIUmxjbFI1Y0dVaUxDSkJUbGtpTENKVFZFRlNWQ0lzSWtWWVFVTlVJaXdpUkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5SWl3aWMzbHVZMmhsY2lJc0luTmphR1Z0WVNJc0ltbHVhWFJwWVd4VGRHRjBkWE1pTENKcGJtbDBhV0ZzUkdGMFlTSXNJbU5vYVd4a2NtVnVjeUlzSW1sdWFYUnBZV3hXWlhKemFXOXVJaXdpYlhWMGRXRnNJaXdpWkdGMFlTSXNJbDkwYUdseklpd2lYM1psY25OcGIyNGlMQ0pmWm1sc2RHVnljeUlzSWw5emVXNWpUMkpxSWl3aWIySnpaWEoyWlNJc0ltVjJaVzUwSWl3aVgyOXVSbWxzZEdWeUlpd2labTl5UldGamFDSXNJbU5vYVd4a1NXUWlMQ0pqYUdsc1pFUmhkR0VpTENKZlkyaHBiR1J5Wlc1UFltcGxZM1J6SWl3aVgyRnNiRzlqWVhSbFRHbHpkR1Z1WlhKeklpd2lYMk5vWVc1blpVeHBjM1JsYm1WeUlpd2lYMkoxY3lJc0ltRmtaRXhwYzNSbGJtVnlJaXdpWDNWeWJDSXNJbTF6WnlJc0lteHZaeUlzSWw5amFHRnVaMlZQWW1wbFkzUWlMQ0p5WlcxdmRtVWlMQ0pmY21Wc1pXRnpaVXhwYzNSbGJtVnljeUlzSWw5emVXNWphR1Z5SWl3aVgyOWljMlZ5ZG1WeWN5SXNJblZ1VTNWaWMyTnlhV0psVFhObklpd2labkp2YlNJc0lsOXZkMjVsY2lJc0luUnZJaXdpWDNOMVlsVlNUQ0lzSW1KdlpIa2lMQ0p5WlhOdmRYSmpaU0lzSW5CdmMzUk5aWE56WVdkbElpd2ljbVZ3YkhraUxDSmpiMlJsSWl3aVptbHNkR1Z5SWl3aVkyRnNiR0poWTJzaUxDSnJaWGtpTENKbWFXeDBaWEpQWW1vaUxDSnBaSGdpTENKbWFXVnNaQ0lzSWtSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2lJc0lsOXpkV0p6WTNKcGNIUnBiMjV6SWl3aVgyOXVRMmhoYm1kbElpd2lYMjlpYW1WamRFeHBjM1JsYm1WeUlpd2lYMjl1VW1WemNHOXVjMlVpTENKZmIyNVNaV0ZrSWl3aWIySnpaWEoyWlhKeklpd2lhVzUyYVhSbFRYTm5JaXdpY21WemRXMWxJaXdpWDNOamFHVnRZU0lzSW1GMWRHaHZjbWx6WlNJc0ltUmxiR1YwWlUxelp5SXNJbDl5WlhCdmNuUmxjbk1pTENKZmIyNVRkV0p6WTNKcGNIUnBiMjVJWVc1a2JHVnlJaXdpWDI5dVVtVnpjRzl1YzJWSVlXNWtiR1Z5SWl3aVgyOXVVbVZoWkVoaGJtUnNaWElpTENKZmIyNVRkV0p6WTNKcFltVWlMQ0pmYjI1VmJsTjFZbk5qY21saVpTSXNJbWg1Y0dWeWRIbFZjbXdpTENKaFkyTmxjSFFpTENKemRXSWlMQ0p6ZEdGMGRYTWlMQ0pqYUdsc1pISmxibFpoYkhWbGN5SXNJbk5sYm1STmMyY2lMQ0pwWkNJc0luWmxjbk5wYjI0aUxDSm9ZWE5QZDI1UWNtOXdaWEowZVNJc0ltMTFkSFZoYkVGMWRHaGxiblJwWTJGMGFXOXVJaXdpWDIxMWRIVmhiRUYxZEdobGJuUnBZMkYwYVc5dUlpd2ljbVZxWldOMElpd2ljbVZoYzI5dUlpd2laR1Z6WXlJc0lrUmhkR0ZQWW1wbFkzUWlMQ0pmYzNSaGRIVnpJaXdpWDJOb2FXeGtjbVZ1Y3lJc0lsOWphR2xzWkVsa0lpd2lYMk5vYVd4a2NtVnVUR2x6ZEdWdVpYSnpJaXdpWTJocGJHUkNZWE5sVlZKTUlpd2lZMmhwYkdRaUxDSmphR2xzWkZWU1RDSXNJbXhwYzNSbGJtVnlJaXdpWDI5dVEyaHBiR1JEY21WaGRHVWlMQ0pmWTJoaGJtZGxRMmhwYkdSeVpXNGlMQ0p3ZFhOb0lpd2lZMmhwYkdSeVpXNGlMQ0p0YzJkRGFHbHNaRWxrSWl3aWJYTm5RMmhwYkdSUVlYUm9JaXdpY21WeGRXVnpkRTF6WnlJc0luSmxjMjlzZG1VaUxDSnRjMmRKWkNJc0ltNWxkME5vYVd4a0lpd2liMjVEYUdGdVoyVWlMQ0p3WVhSb0lpd2lYMjl1UVdSa1EyaHBiR1J5Wlc1SVlXNWtiR1Z5SWl3aWMyVjBWR2x0Wlc5MWRDSXNJbk52ZFhKalpTSXNJbU5vYVd4a1NXNW1ieUlzSW1Ob1lXNW5aVTF6WnlJc0ltRjBkSEpwWW5WMFpTSXNJbTlVZVhCbElpd2lUMEpLUlVOVUlpd2lZMVI1Y0dVaUxDSlNSVTFQVmtVaUxDSmhkSFJ5YVdKMWRHVlVlWEJsSWl3aVZWQkVRVlJGSWl3aWIzQmxjbUYwYVc5dUlpd2ljM2x1WTA5aWFpSXNJbVpwYm1SU1pYTjFiSFFpTENKbWFXNWtRbVZtYjNKbElpd2lRVkpTUVZraUxDSkJSRVFpTENKaGNuSWlMQ0pwYm1SbGVDSXNJbXhoYzNRaUxDSkJjbkpoZVNJc0luQnliM1J2ZEhsd1pTSXNJbk53YkdsalpTSXNJbUZ3Y0d4NUlpd2lZMjl1WTJGMElpd2lSR0YwWVU5aWFtVmpkRU5vYVd4a0lpd2ljR0Z5Wlc1MElpd2liM2R1WlhJaUxDSmZjR0Z5Wlc1MElpd2lYMjF6WjBsa0lpd2lYMnhwYzNSbGJtVnlJaXdpWDJOb2FXeGtjbVZ1SWl3aWIySnFaV04wVkhsd1pTSXNJbE41Ym1OUFltcGxZM1FpTENKZlpHRjBZU0lzSWw5cGJuUmxjbTVoYkU5aWMyVnlkbVVpTENKc2FYTjBJaXdpWDJacGJtUlhhWFJvVTNCc2FYUWlMQ0p3YjNBaUxDSm9ZVzVrYkdWeUlpd2lZMmhoYm1kbGMyVjBJaXdpWlhabGNua2lMQ0pqYUdGdVoyVWlMQ0pmYjI1RGFHRnVaMlZ6SWl3aVQySnFaV04wSWl3aVpHVmxjRTlpYzJWeWRtVWlMQ0p2WW1wVWVYQmxJaXdpWTI5dWMzUnlkV04wYjNJaUxDSlBZbXBsWTNSVWVYQmxJaXdpWm1sbGJHUlRkSEpwYm1jaUxDSnJaWGx3WVhSb0lpd2libVYzVm1Gc2RXVWlMQ0p1WVcxbElpd2lYMlpwY21WRmRtVnVkQ0lzSWtOb1lXNW5aVlI1Y0dVaUxDSlRlVzVqYUdWeUlpd2lZblZ6SWl3aVkyOXVabWxuSWl3aWNuVnVkR2x0WlZWU1RDSXNJbDl3Y205MmFYTnBiMjVoYkhNaUxDSnBibVp2SWl3aVgyOXVSbTl5ZDJGeVpDSXNJbDl2YmxKbGJXOTBaVU55WldGMFpTSXNJbDl2YmxKbGJXOTBaVVJsYkdWMFpTSXNJbk4wYjNKbElpd2ljREp3SWl3aVkzSnBkR1Z5YVdFaUxDSmZZM0psWVhSbElpd2liMkpxVlZKTUlpd2lYM04xWW5OamNtbGlaU0lzSWw5amNtbDBaWEpwWVNJc0luSmxZV1JOYzJjaUxDSmZiMjVPYjNScFptbGpZWFJwYjI1SVlXNWtiR1Z5SWl3aWNtVndiM0owWlhJaUxDSnVaWGRQWW1vaUxDSmphR2xzWkhKbGJsSmxjMjkxY21ObGN5SXNJbk4xWW5OamNtbGlaVTF6WnlJc0ltNWxkMUJ5YjNacGMybHZibUZzSWl3aWMyeHBZMlVpTENKaFkyc2lMQ0pzVkhsd1pTSXNJbVJsYkdWMFpTSXNJa1JoZEdGUWNtOTJhWE5wYjI1aGJDSXNJbDlqYUdGdVoyVnpJaXdpYjJKelpYSjJaWElpWFN3aWJXRndjR2x1WjNNaU9pSkJRVUZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTd3lRa0ZCTWtJN1FVRkRNMElzUTBGQlF6dEJRVU5FTEU4N1FVTldRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CT3pzN1FVRkhRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdPMEZCUlVFN1FVRkRRU3h0UkVGQk1rTXNZMEZCWXpzN1FVRkZla1E3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hoUVVGTE8wRkJRMHc3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3h0UTBGQk1rSXNNRUpCUVRCQ0xFVkJRVVU3UVVGRGRrUXNlVU5CUVdsRExHVkJRV1U3UVVGRGFFUTdRVUZEUVR0QlFVTkJPenRCUVVWQk8wRkJRMEVzT0VSQlFYTkVMQ3RFUVVFclJEczdRVUZGY2tnN1FVRkRRVHM3UVVGRlFUdEJRVU5CT3pzN096czdPMEZEYUVWQkxEWkNRVUUyUWp0QlFVTTNRaXh4UTBGQmNVTXNaME03T3pzN096dEJRMFJ5UXp0QlFVTkJPMEZCUTBFN1FVRkRRU3gxUTBGQmRVTXNaME03T3pzN096dEJRMGgyUXp0QlFVTkJPMEZCUTBFc2FVTkJRV2xETEZGQlFWRXNaMEpCUVdkQ0xGVkJRVlVzUjBGQlJ6dEJRVU4wUlN4RFFVRkRMRVU3T3pzN096dEJRMGhFTzBGQlEwRTdRVUZEUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3UVVGRFFUdEJRVU5CT3p0QlFVVkJMSFZDT3pzN096czdRVU5XUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSExGVkJRVlU3UVVGRFlqdEJRVU5CTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3UVVObVFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMHBCTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3UVVOR1FUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRU5CUVVNN1FVRkRSRHRCUVVOQk8wRkJRMEVzUlRzN096czdPenRCUTFCQk96dEJRVVZCT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEVWtFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEcxRlFVRnRSVHRCUVVOdVJUdEJRVU5CTEhGR1FVRnhSanRCUVVOeVJqdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNWMEZCVnp0QlFVTllMRk5CUVZNN1FVRkRWRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEV0QlFVczdRVUZEVER0QlFVTkJPMEZCUTBFc0swTkJRU3RETzBGQlF5OURPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEdOQlFXTTdRVUZEWkN4alFVRmpPMEZCUTJRc1kwRkJZenRCUVVOa0xHTkJRV003UVVGRFpDeGxRVUZsTzBGQlEyWXNaVUZCWlR0QlFVTm1MR1ZCUVdVN1FVRkRaaXhuUWtGQlowSTdRVUZEYUVJc2VVSTdPenM3T3pzN1FVTTFSRUU3TzBGQlJVRTdPMEZCUlVFN08wRkJSVUU3TzBGQlJVRXNjME5CUVhORExIVkRRVUYxUXl4blFrRkJaMEk3TzBGQlJUZEdPMEZCUTBFN1FVRkRRU3h0UWtGQmJVSXNhMEpCUVd0Q08wRkJRM0pETzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hEUVVGRExFYzdPenM3T3p0QlF6RkNSRHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMDVCTEhWQ1FVRjFRanRCUVVOMlFqdEJRVU5CTzBGQlEwRXNSVHM3T3pzN08wRkRTRUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMHhCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSVHM3T3pzN08wRkRia0pCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEVUVFc2IwSTdPenM3T3p0QlEwRkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTA1Qk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRFRrRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRFNFRXNhVUpCUVdsQ096dEJRVVZxUWp0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRFNrRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMWhCTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQkxHdEZRVUZyUlN3clFrRkJLMEk3UVVGRGFrY3NSVHM3T3pzN08wRkRUa0U3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3UVVOS1FUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMHBCTzBGQlEwRXNjVVZCUVhORkxHZENRVUZuUWl4VlFVRlZMRWRCUVVjN1FVRkRia2NzUTBGQlF5eEZPenM3T3pzN1FVTkdSQ3h6UWpzN096czdPMEZEUVVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEZPenM3T3pzN1FVTktRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSVHM3T3pzN08wRkRURUU3UVVGRFFUdEJRVU5CTzBGQlEwRXNZVHM3T3pzN08wRkRTRUU3UVVGRFFUdEJRVU5CTEcxRVFVRnRSRHRCUVVOdVJEdEJRVU5CTEhWRFFVRjFRenRCUVVOMlF5eEZPenM3T3pzN1FVTk1RU3hyUWtGQmEwSXNkMFE3T3pzN096dEJRMEZzUWp0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEwcEJMR3RDUVVGclFpeDNSRHM3T3pzN096dEJRMEZzUWpzN1FVRkZRVHM3UVVGRlFUczdRVUZGUVRzN1FVRkZRVHM3UVVGRlFUczdRVUZGUVRzN1FVRkZRVHM3UVVGRlFTeHpRMEZCYzBNc2RVTkJRWFZETEdkQ1FVRm5RanM3UVVGRk4wWTdRVUZEUVR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGc3UVVGRFFTeEZPenM3T3pzN08wRkRhRU5CT3p0QlFVVkJPenRCUVVWQk96dEJRVVZCT3p0QlFVVkJMSE5EUVVGelF5eDFRMEZCZFVNc1owSkJRV2RDT3p0QlFVVTNSanRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJMRVU3T3pzN096dEJRMmhDUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEwcEJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTdzJRa0ZCTmtJN1FVRkROMEk3TzBGQlJVRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN3MlFrRkJOa0k3UVVGRE4wSTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRWRCUVVjN1FVRkRTRHRCUVVOQk96czdPenM3TzBGRGVFTkJPMEZCUTBFN1FVRkRRU3h2UlVGQmRVVXNlVU5CUVRCRExFVTdPenM3T3pzN1FVTkdha2c3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPenRCUVVWQkxEUkNRVUUwUWl4aFFVRmhPenRCUVVWNlF6dEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc2QwTkJRWGRETEc5RFFVRnZRenRCUVVNMVJTdzBRMEZCTkVNc2IwTkJRVzlETzBGQlEyaEdMRXRCUVVzc01rSkJRVEpDTEc5RFFVRnZRenRCUVVOd1JUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNaMEpCUVdkQ0xHMUNRVUZ0UWp0QlFVTnVRenRCUVVOQk8wRkJRMEVzYVVOQlFXbERMREpDUVVFeVFqdEJRVU0xUkR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEV0QlFVczdRVUZEVER0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRGNrVkJMR3RDUVVGclFpeDNSRHM3T3pzN08wRkRRV3hDTEdOQlFXTXNjMEk3T3pzN096dEJRMEZrTERaRk96czdPenM3UVVOQlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnc1JUczdPenM3TzBGRFdrRTdRVUZEUVR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTJoQ1FUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc09FSkJRVGhDTzBGQlF6bENPMEZCUTBFN1FVRkRRU3h0UkVGQmJVUXNUMEZCVHl4RlFVRkZPMEZCUXpWRUxFVTdPenM3T3p0QlExUkJMSGRET3pzN096czdRVU5CUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxESkVRVUV5UkR0QlFVTXpSQ3hGT3pzN096czdRVU5NUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTd3dSRUZCTUVRc2MwSkJRWE5DTzBGQlEyaEdMR2RHUVVGblJpeHpRa0ZCYzBJN1FVRkRkRWNzUlRzN096czdPMEZEVWtFc2JVTTdPenM3T3pzN1FVTkJRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVN3MlFrRkJOa0k3UVVGRE4wSXNZMEZCWXp0QlFVTmtPMEZCUTBFc1EwRkJRenRCUVVORU8wRkJRMEU3UVVGRFFUdEJRVU5CTEN0Q1FVRXJRanRCUVVNdlFqdEJRVU5CTzBGQlEwRXNWVUZCVlR0QlFVTldMRU5CUVVNc1JUczdPenM3TzBGRGFFSkVPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3TzBGQlJVRXNkMGRCUVhkSExFOUJRVTg3UVVGREwwYzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFTTdPenM3T3pzN1FVTmFRVHRCUVVOQkxIVkRRVUYxUXl3d1FrRkJNRUk3UVVGRGFrVXNkME5CUVhkRE8wRkJRM2hETzBGQlEwRXNSVHM3T3pzN096czdPenM3TzBGRFNrRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3g1UWtGQmVVSXNhMEpCUVd0Q0xFVkJRVVU3TzBGQlJUZERPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ5eFZRVUZWTzBGQlEySTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRGRFSkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEU2tFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVkQlFVY3NWVUZCVlR0QlFVTmlPMEZCUTBFc1JUczdPenM3TzBGRFprRXNlVU03T3pzN096czdRVU5CUVRzN1FVRkZRVHM3UVVGRlFUczdRVUZGUVRzN1FVRkZRVHM3UVVGRlFUczdRVUZGUVN4cFNFRkJhVWdzYlVKQlFXMUNMRVZCUVVVc2JVSkJRVzFDTERSS1FVRTBTanM3UVVGRmNsUXNjME5CUVhORExIVkRRVUYxUXl4blFrRkJaMEk3TzBGQlJUZEdPMEZCUTBFN1FVRkRRU3hEUVVGRE8wRkJRMFE3UVVGRFFTeEZPenM3T3pzN1FVTndRa0VzTkVKQlFUUkNMR1U3T3pzN096dEJRMEUxUWp0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEV0QlFVc3NWMEZCVnl4bFFVRmxPMEZCUXk5Q08wRkJRMEVzUzBGQlN6dEJRVU5NTzBGQlEwRXNSVHM3T3pzN096dEJRM0JDUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRXNlVVpCUVdkR0xHRkJRV0VzUlVGQlJUczdRVUZGTDBZN1FVRkRRU3h4UkVGQmNVUXNNRUpCUVRCQ08wRkJReTlGTzBGQlEwRXNSVHM3T3pzN08wRkRXa0U3UVVGRFFTeFZRVUZWTzBGQlExWXNSVHM3T3pzN08wRkRSa0U3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3UVVOYVFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEwNUJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSVHM3T3pzN08wRkRhRUpCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGc3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGc3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlF6RkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3TzBGRFRrRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1owTkJRV2RETzBGQlEyaERMR05CUVdNN1FVRkRaQ3hwUWtGQmFVSTdRVUZEYWtJN1FVRkRRU3hEUVVGRE8wRkJRMFE3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeERRVUZET3p0QlFVVkVPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTERSQ096czdPenM3UVVOcVEwRXNhMEpCUVd0Q0xIZEVPenM3T3pzN1FVTkJiRUlzYTBKQlFXdENMSGRFT3pzN096czdRVU5CYkVJN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc2FVUkJRV2xFTzBGQlEycEVMRU5CUVVNN1FVRkRSRHRCUVVOQkxIRkNRVUZ4UWp0QlFVTnlRanRCUVVOQkxGTkJRVk03UVVGRFZDeEpRVUZKTzBGQlEwbzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRM0JFUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTFCQkxHdENRVUZyUWl4M1JEczdPenM3TzBGRFFXeENMR3RDUVVGclFpeDNSRHM3T3pzN08wRkRRV3hDTEd0Q1FVRnJRaXgzUkRzN096czdPMEZEUVd4Q0xHdENRVUZyUWl4M1JEczdPenM3TzBGRFFXeENPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEU2tFN1FVRkRRU3c0UkRzN096czdPMEZEUkVFN1FVRkRRU3h2UkRzN096czdPMEZEUkVFN1FVRkRRU3c0UkRzN096czdPMEZEUkVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeG5SRHM3T3pzN08wRkRTa0U3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN3clF6czdPenM3TzBGRFNrRTdRVUZEUVR0QlFVTkJMSFZFT3pzN096czdRVU5HUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGdzUlRzN096czdPMEZEU2tFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZ3NSVHM3T3pzN08wRkRaRUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzY1VOQlFYRkRMR2xDUVVGcFFpeEZRVUZGTzBGQlEzaEVPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeG5SVUZCWjBVc1owSkJRV2RDTzBGQlEyaEdPMEZCUTBFN1FVRkRRU3hIUVVGSExESkRRVUV5UXl4blEwRkJaME03UVVGRE9VVTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxIZENPenM3T3pzN1FVTjRRa0U3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRWRCUVVjN1FVRkRTQ3hGT3pzN096czdRVU5tUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRXNSVHM3T3pzN08wRkRVRUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3UVVOS1FUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGc3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3UVVOWVFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRU3dyUWtGQkswSXNjVUpCUVhGQ08wRkJRM0JFTEN0Q1FVRXJRaXhUUVVGVExFVkJRVVU3UVVGRE1VTXNRMEZCUXl4VlFVRlZPenRCUVVWWU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMREpDUVVFeVFpeFRRVUZUTEcxQ1FVRnRRanRCUVVOMlJDd3JRa0ZCSzBJc1lVRkJZVHRCUVVNMVF6dEJRVU5CTEVkQlFVY3NWVUZCVlR0QlFVTmlPMEZCUTBFc1JUczdPenM3TzBGRGNFSkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMVJCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4UFFVRlBPMEZCUTFBN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeExRVUZMTzBGQlEwdzdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnN1FVRkRRVHRCUVVOQkxIVkRRVUYxUXl4dlFrRkJiMElzUlVGQlJUdEJRVU0zUkR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFZEJRVWM3UVVGRFNEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVkQlFVYzdRVUZEU0R0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRXNaMEpCUVdkQ08wRkJRMmhDTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1MwRkJTenRCUVVOTU8wRkJRMEVzUlRzN096czdPMEZEYmtWQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEd0Q1FVRnJRanM3UVVGRmJFSTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3UVVGRFFUczdPenM3T3p0QlEyeENRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklMRVU3T3pzN096dEJRMDVCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEd0RVFVRnJSRHRCUVVOc1JEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1QwRkJUeXhWUVVGVkxHTkJRV003UVVGREwwSTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUzBGQlN5eEhRVUZITzBGQlExSTdRVUZEUVN4Rk96czdPenM3TzBGRGVFSkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxHOUNRVUZ2UWl4aFFVRmhPMEZCUTJwRExFZEJRVWM3UVVGRFNDeEZPenM3T3pzN1FVTmlRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMUJCTzBGQlEwRTdRVUZEUVN3NFFrRkJPRUlzWjBOQlFXOURMRVU3T3pzN096dEJRMFpzUlR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4RFFVRkRMRVU3T3pzN096dEJRMUpFTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVOQlFVTXNSVHM3T3pzN08wRkRVa1E3UVVGRFFUdEJRVU5CTERoQ1FVRTRRaXcwUTBGQk5FTXNSVHM3T3pzN096dEJRMFl4UlR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRzlEUVVGdlF6dEJRVU53UXpzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEN0RFFVRXJReXh6UkVGQmFVUXNiMEpCUVc5Q08wRkJRM0JJTzBGQlEwRTdRVUZEUVN4SFFVRkhMRlZCUVZVN1FVRkRZaXhEUVVGRE96dEJRVVZFTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklMRmxCUVZrN1FVRkRXanRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeFhRVUZYTzBGQlExZzdRVUZEUVN4WFFVRlhPMEZCUTFnc1UwRkJVenRCUVVOVUxFOUJRVTg3UVVGRFVEdEJRVU5CTzBGQlEwRTdRVUZEUVN3eVEwRkJNa003UVVGRE0wTTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxGTkJRVk03UVVGRFZDeHRRa0ZCYlVJc1owTkJRV2RETzBGQlEyNUVMRk5CUVZNN1FVRkRWRHRCUVVOQk8wRkJRMEVzVDBGQlR6dEJRVU5RTzBGQlEwRTdRVUZEUVN4TFFVRkxPMEZCUTB3N1FVRkRRU3hIUVVGSE8wRkJRMGc3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFdEJRVXM3UVVGRFRDeGxRVUZsTEhGRFFVRnhRenRCUVVOd1JEdEJRVU5CTEVkQlFVYzdRVUZEU0R0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzYTBOQlFXdERPMEZCUTJ4RE8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzYTBOQlFXdERPMEZCUTJ4RE8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNkVUpCUVhWQ0xIZENRVUYzUWp0QlFVTXZRenRCUVVOQk8wRkJRMEVzVTBGQlV6dEJRVU5VTzBGQlEwRTdRVUZEUVN4UFFVRlBPMEZCUTFBc1MwRkJTenRCUVVOTU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklMR3RDUVVGclFpeDFRa0ZCZFVJc1MwRkJTenRCUVVNNVF6dEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRXRCUVVzN1FVRkRURHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEdsQ1FVRnBRanRCUVVOcVFpeDNRa0ZCZDBJN1FVRkRlRUlzWjBKQlFXZENPMEZCUTJoQ0xHOUNRVUZ2UWp0QlFVTndRaXgzUWtGQmQwSTdRVUZEZUVJc1owSkJRV2RDTzBGQlEyaENMRzlDUVVGdlFqdEJRVU53UWp0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hMUVVGTE8wRkJRMHc3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFc01FUkJRVEJFTEd0Q1FVRnJRanRCUVVNMVJUdEJRVU5CTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1EwRkJRenRCUVVORU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUTBGQlF6dEJRVU5FTzBGQlEwRTdRVUZEUVN4RFFVRkRPMEZCUTBRN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxGTkJRVk03UVVGRFZDeFBRVUZQTzBGQlExQTdRVUZEUVN4TFFVRkxPMEZCUTB3N1FVRkRRVHRCUVVOQkxFZEJRVWM3UVVGRFNEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzVDBGQlR6dEJRVU5RTEV0QlFVczdRVUZEVER0QlFVTkJPMEZCUTBFN1FVRkRRU3hEUVVGRExFVTdPenM3T3pzN1FVTXhVMFE3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzZFVKQlFYVkNPMEZCUTNaQ08wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTEhOQ1FVRnpRanRCUVVOMFFpeHZRa0ZCYjBJc2RVSkJRWFZDTEZOQlFWTXNTVUZCU1R0QlFVTjRSQ3hIUVVGSE8wRkJRMGdzUTBGQlF6dEJRVU5FTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1EwRkJRenM3UVVGRlJEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3UVVGRFFTeERRVUZETzBGQlEwUTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMSGxFUVVGNVJEdEJRVU42UkR0QlFVTkJMRXRCUVVzN1FVRkRURHRCUVVOQkxITkNRVUZ6UWl4cFEwRkJhVU03UVVGRGRrUXNTMEZCU3p0QlFVTk1MRWRCUVVjN1FVRkRTRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSU96dEJRVVZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNPRVJCUVRoRUxEaENRVUU0UWp0QlFVTTFSanRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVkQlFVYzdPMEZCUlVnN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFc01FUkJRVEJFTEdkQ1FVRm5RanM3UVVGRk1VVTdRVUZEUVR0QlFVTkJPMEZCUTBFc2IwSkJRVzlDTEc5Q1FVRnZRanM3UVVGRmVFTXNNRU5CUVRCRExHOUNRVUZ2UWpzN1FVRkZPVVE3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklMSGRDUVVGM1FpeGxRVUZsTEVWQlFVVTdRVUZEZWtNc2QwSkJRWGRDTEdkQ1FVRm5RanRCUVVONFF5eERRVUZET3p0QlFVVkVPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUTBGQlF6czdRVUZGUkR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeHZSRUZCYjBRc1MwRkJTeXhSUVVGUkxHbERRVUZwUXp0QlFVTnNSeXhEUVVGRE8wRkJRMFE3UVVGRFFTd3JRMEZCSzBNN1FVRkRMME03UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4RFFVRkRPenRCUVVWRU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc01FTTdPenM3T3p0QlF6RlBRU3g1UXpzN096czdPMEZEUVVFc2MwTTdPenM3T3pzN096czdPenM3T3pzN096czdPenM3VVVOM1EyZENRU3hUTEVkQlFVRkJMRk03VVVGclJFRkRMRmNzUjBGQlFVRXNWenRSUVdkQ1FVTXNWeXhIUVVGQlFTeFhPMUZCVTBGRExGTXNSMEZCUVVFc1V6dFJRVlZCUXl4dFFpeEhRVUZCUVN4dFFqdFJRVlZCUXl4dFFpeEhRVUZCUVN4dFFqdFJRVmRCUXl4blFpeEhRVUZCUVN4blFqczdPenRCUVd4S2FFSTdPenM3T3pzN096czdPenM3T3pzN096czdPenM3UVVGelFrRTdPenM3TzBGQlMwRTdPenM3T3pzN08wRkJVVUU3T3pzN08wRkJTMDhzVTBGQlUwNHNVMEZCVkN4RFFVRnRRazhzUjBGQmJrSXNSVUZCZDBJN08wRkJSVGRDTEUxQlFVa3NRMEZCUTBFc1IwRkJUQ3hGUVVGVkxFMUJRVTFETEUxQlFVMHNkMEpCUVU0c1EwRkJUanM3UVVGRldDeFhRVUZUUXl4UFFVRlVMRU5CUVdsQ1F5eExRVUZxUWl4RlFVRjNRanRCUVVOMlFpeFJRVUZOUXl4UlFVRlJMREJHUVVGa08wRkJRMFVzVVVGQlRVTXNVVUZCVVN4VlFVRmtPMEZCUTBRc1VVRkJTVU1zVVVGQlVVZ3NUVUZCVFVrc1QwRkJUaXhEUVVGalNDeExRVUZrTEVWQlFYRkNReXhMUVVGeVFpeEZRVUUwUWtjc1MwRkJOVUlzUTBGQmEwTXNSMEZCYkVNc1EwRkJXanRCUVVORUxGZEJRVTlHTEV0QlFWQTdRVUZEUVRzN1FVRkZSQ3hOUVVGSlFTeFJRVUZSU2l4UlFVRlJSaXhIUVVGU0xFTkJRVm83TzBGQlJVTTdRVUZEUVN4TlFVRkpUU3hOUVVGTkxFTkJRVTRzVFVGQllVNHNSMEZCWWl4SlFVRnZRaXhEUVVGRFRTeE5RVUZOTEVOQlFVNHNSVUZCVTBjc1VVRkJWQ3hEUVVGclFpeEhRVUZzUWl4RFFVRjZRaXhGUVVGcFJEczdRVUZGTDBNc1VVRkJTVU1zVlVGQlV6dEJRVU5ZUXl4WlFVRk5MRVZCUkVzN1FVRkZXRU1zWTBGQlVWb3NSMEZHUnp0QlFVZFlZU3huUWtGQlZUdEJRVWhETEV0QlFXSTdPMEZCVFVGRExGbEJRVkZETEV0QlFWSXNRMEZCWXl4NVJrRkJaQ3hGUVVGNVIyWXNSMEZCZWtjN08wRkJSVUVzVjBGQlQxVXNUMEZCVUR0QlFVTkVPenRCUVVWR08wRkJRMEVzVFVGQlNVb3NUVUZCVFN4RFFVRk9MRTFCUVdGT0xFZEJRV0lzU1VGQmIwSk5MRTFCUVUwc1EwRkJUaXhGUVVGVFJ5eFJRVUZVTEVOQlFXdENMRWRCUVd4Q0xFTkJRWGhDTEVWQlFXZEVPMEZCUXk5RExGRkJRVWxQTEZOQlFWTldMRTFCUVUwc1EwRkJUaXhOUVVGaFRpeEhRVUZpTEVkQlFXMUNMRTFCUVc1Q0xFZEJRVFJDVFN4TlFVRk5MRU5CUVU0c1EwRkJla003UVVGRFFVRXNXVUZCVVVvc1VVRkJVV01zVTBGQlV5eExRVUZVTEVkQlFXbENWaXhOUVVGTkxFTkJRVTRzUTBGQmVrSXNRMEZCVWp0QlFVTkJPenRCUVVWRU8wRkJRMEVzVFVGQlNVRXNUVUZCVFN4RFFVRk9MRVZCUVZOSExGRkJRVlFzUTBGQmEwSXNSMEZCYkVJc1EwRkJTaXhGUVVFMFFqdEJRVU16UWtnc1ZVRkJUU3hEUVVGT0xFbEJRVmRCTEUxQlFVMHNRMEZCVGl4SlFVRlhMRXRCUVZnc1IwRkJiVUpCTEUxQlFVMHNRMEZCVGl4RFFVRTVRanRCUVVOQlFTeFZRVUZOTEVOQlFVNHNTVUZCVjBFc1RVRkJUU3hEUVVGT0xFVkJRVk5YTEUxQlFWUXNRMEZCWjBKWUxFMUJRVTBzUTBGQlRpeEZRVUZUV1N4UFFVRlVMRU5CUVdsQ0xFZEJRV3BDTEVsQlFYZENMRU5CUVhoRExFTkJRVmc3UVVGRFJ5eEhRWEpETUVJc1EwRnhRM2hDT3pzN08wRkJTVXdzVFVGQlNWSXNVMEZCVXp0QlFVTllReXhWUVVGTlRDeE5RVUZOTEVOQlFVNHNRMEZFU3p0QlFVVllUU3haUVVGUlRpeE5RVUZOTEVOQlFVNHNRMEZHUnp0QlFVZFlUeXhqUVVGVlVDeE5RVUZOTEVOQlFVNDdRVUZJUXl4SFFVRmlPenRCUVUxQkxGTkJRVTlKTEUxQlFWQTdRVUZEUkRzN1FVRkZUU3hUUVVGVGFFSXNWMEZCVkN4RFFVRnhRbmxDTEV0QlFYSkNMRVZCUVRSQ08wRkJRMnBETEUxQlFVbERMRmxCUVZsRUxFMUJRVTFFTEU5QlFVNHNRMEZCWXl4SFFVRmtMRU5CUVdoQ096dEJRVVZCTEUxQlFVbFNMRk5CUVZNN1FVRkRXRmNzWTBGQlZVWXNUVUZCVFVjc1UwRkJUaXhEUVVGblFpeERRVUZvUWl4RlFVRnRRa1lzVTBGQmJrSXNRMEZFUXp0QlFVVllVaXhaUVVGUlR5eE5RVUZOUnl4VFFVRk9MRU5CUVdkQ1JpeFpRVUZaTEVOQlFUVkNMRVZCUVN0Q1JDeE5RVUZOU1N4TlFVRnlRenRCUVVaSExFZEJRV0k3TzBGQlMwRXNVMEZCVDJJc1RVRkJVRHRCUVVORU96dEJRVVZFT3pzN096dEJRVXRQTEZOQlFWTm1MRmRCUVZRc1EwRkJjVUkyUWl4TlFVRnlRaXhGUVVFMlFqdEJRVU5zUXl4VFFVRlBMRzlDUVVGWlFTeE5RVUZhTEVWQlFXOUNSQ3hOUVVGd1FpeEhRVUUyUWl4RFFVRTNRaXhIUVVGcFF5eExRVUZxUXl4SFFVRjVReXhKUVVGb1JEdEJRVU5FT3p0QlFVVkVPenM3T3p0QlFVdFBMRk5CUVZNelFpeFRRVUZVTEVOQlFXMUNOa0lzUjBGQmJrSXNSVUZCZDBJN1FVRkROMEk3UVVGRFFTeE5RVUZKUVN4SFFVRktMRVZCUVZNc1QwRkJUME1zUzBGQlMwTXNTMEZCVEN4RFFVRlhMSGxDUVVGbFJpeEhRVUZtTEVOQlFWZ3NRMEZCVUR0QlFVTldPenRCUVVWRU96czdPenRCUVV0UExGTkJRVk0xUWl4dFFrRkJWQ3hEUVVFMlFpdENMRk5CUVRkQ0xFVkJRWGRETzBGQlF6ZERMRTFCUVVsU0xGbEJRVmxSTEZWQlFWVldMRTlCUVZZc1EwRkJhMElzUjBGQmJFSXNRMEZCYUVJN1FVRkRRU3hUUVVGUExGbEJRVmxWTEZWQlFWVk9MRk5CUVZZc1EwRkJiMEpHTEZsQlFWa3NRMEZCYUVNc1JVRkJiVU5STEZWQlFWVk1MRTFCUVRkRExFTkJRVm9zUjBGQmJVVXNSMEZCYmtVc1IwRkJlVVZMTEZWQlFWVk9MRk5CUVZZc1EwRkJiMElzUTBGQmNFSXNSVUZCZFVKR0xGTkJRWFpDTEVOQlFXaEdPMEZCUTBRN08wRkJSVVE3T3pzN08wRkJTMDhzVTBGQlUzUkNMRzFDUVVGVUxFTkJRVFpDSzBJc1QwRkJOMElzUlVGQmMwTTdRVUZETTBNc1RVRkJTVGRDTEUxQlFVMVFMRlZCUVZWdlF5eFBRVUZXTEVOQlFWWTdRVUZEUVN4VFFVRlBOMElzU1VGQlNXRXNVVUZCU2l4RFFVRmhUaXhQUVVGaUxFTkJRWEZDTEVkQlFYSkNMRVZCUVRCQ0xFVkJRVEZDTEVsQlFXZERMRWRCUVdoRExFZEJRWE5EVUN4SlFVRkpXU3hOUVVGcVJDeERRVVl5UXl4RFFVVmpPMEZCUXpGRU96dEJRVWRFT3pzN096dEJRVXRQTEZOQlFWTmlMR2RDUVVGVUxFTkJRVEJDSzBJc1ZVRkJNVUlzUlVGQmMwTTdPMEZCUlRORE8wRkJRMEVzVFVGQlNVRXNWMEZCVjFJc1UwRkJXQ3hEUVVGeFFpeERRVUZ5UWl4RlFVRjNRaXhEUVVGNFFpeE5RVUVyUWl4VFFVRnVReXhGUVVFNFF6dEJRVU0xUXl4UlFVRkpVeXhoUVVGaGRFTXNWVUZCVlhGRExGVkJRVllzUTBGQmFrSTdPMEZCUlVFN1FVRkRRU3hSUVVGSlF5eFhRVUZYYmtJc1RVRkJXQ3hKUVVGeFFtMUNMRmRCUVZkc1FpeFJRVUZ3UXl4RlFVRTRRenRCUVVNMVF5eGhRVUZQYVVJc1ZVRkJVRHRCUVVORUxFdEJSa1FzVFVGRlR6dEJRVU5NTEZsQlFVMHNNa0pCUVU0N1FVRkRSRHM3UVVGRlNEdEJRVU5ETEVkQldFUXNUVUZYVHp0QlFVTk1MRmRCUVU5cVF5eHZRa0ZCYjBKcFF5eFZRVUZ3UWl4RFFVRlFPMEZCUTBRN1FVRkRSaXhET3pzN096czdPenM3T3pzN096dEJRMjVMUkR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEV0QlFVczdRVUZEVER0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeHBSVUZCYVVVc01FUkJRVEJFTEVWQlFVVTdRVUZETjBnN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxEWkVRVUUyUkN3eVJFRkJNa1E3UVVGRGVFZ3NjVVJCUVhGRUxESkVRVUV5UkR0QlFVTm9TRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxHbEZRVUZwUlR0QlFVTnFSVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEhkQ1FVRjNRaXh6UTBGQmMwTTdRVUZET1VRN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMSGxDUVVGNVFpdzBSRUZCTkVRN1FVRkRja1k3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4M1FrRkJkMElzSzBOQlFTdERPMEZCUTNaRk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNkMEpCUVhkQ0xIRkZRVUZ4UlR0QlFVTTNSanRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeDNRa0ZCZDBJc2RVTkJRWFZETzBGQlF5OUVPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNVVUZCVVR0QlFVTlNPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNlVU5CUVhsRE8wRkJRM3BETzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxIZENRVUYzUWp0QlFVTjRRanRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNVVUZCVVR0QlFVTlNMR2xGTzBGQlEwRXNkMFJCUVhkRUxEWkhRVUUyUnl4RlFVRkZPMEZCUTNaTE8wRkJRMEU3UVVGRFFUdEJRVU5CTEU5QlFVODdRVUZEVUR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVRzN1FVRkZRVHRCUVVOQkxHRkJRV0U3UVVGRFlqczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNTVUZCU1R0QlFVTktPenRCUVVWQk96dEJRVVZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CT3p0QlFVVkJMSEZDUVVGeFFpeHJSMEZCYTBjN1FVRkRka2c3UVVGRFFUdEJRVU5CTEUxQlFVMDdRVUZEVGl4TFFVRkxPMEZCUTB3N1FVRkRRVHRCUVVOQk8wRkJRMEU3TzBGQlJVRXNiMEpCUVc5Q0xHMUhRVUZ0Unp0QlFVTjJTRHRCUVVOQkxFMUJRVTA3UVVGRFRqdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRU3cwUkR0QlFVTkJPMEZCUTBFN08wRkJSVUVzYTBKQlFXdENMRzlKUVVGdlNUdEJRVU4wU2p0QlFVTkJMRWxCUVVrN1FVRkRTanRCUVVOQkxFZEJRVWM3UVVGRFNEdEJRVU5CTzBGQlEwRXNRMEZCUXpzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenRCUTNaUlJEczdPenRCUVVOQk96czdPenM3UVVGNFFrRTdPenM3T3pzN096czdPenM3T3pzN096czdPenM3TzBGQk1FSkJMRWxCUVVsRkxHRkJRV0VzUlVGQlEwTXNTMEZCU3l4TFFVRk9MRVZCUVdGRExFOUJRVThzVDBGQmNFSXNSVUZCTmtKRExFOUJRVThzVDBGQmNFTXNSVUZCYWtJN08wRkJSVUU3T3pzN08wbEJTVTFETEd0Q096czdRVUZEU2pzN096czdPMEZCVDBFN096czdPMEZCUzBFN1FVRkRRU3c0UWtGQldVTXNUMEZCV2l4RlFVRnhRbkpETEVkQlFYSkNMRVZCUVRCQ2MwTXNUVUZCTVVJc1JVRkJhME5ETEdGQlFXeERMRVZCUVdsRVF5eFhRVUZxUkN4RlFVRTRSRU1zVTBGQk9VUXNSVUZCZVVWRExHTkJRWHBGTEVWQlFYbEdReXhOUVVGNlJpeEZRVUZwUnp0QlFVRkJPenRCUVVGQkxDdEtRVU42Ums0c1QwRkVlVVlzUlVGRGFFWnlReXhIUVVSblJpeEZRVU16UlhORExFMUJSREpGTEVWQlEyNUZReXhoUVVSdFJTeEZRVU53UkVNc1dVRkJXVWtzU1VGRWQwTXNSVUZEYkVOSUxGTkJSR3RETEVWQlEzWkNSU3hOUVVSMVFqczdRVUZGTDBZc1VVRkJTVVVzWTBGQlNqczdRVUZGUVVFc1ZVRkJUVU1zVVVGQlRpeEhRVUZwUWtvc1kwRkJha0k3UVVGRFFVY3NWVUZCVFVVc1VVRkJUaXhIUVVGcFFpeEZRVUZxUWpzN1FVRkZRVVlzVlVGQlRVY3NVVUZCVGl4RFFVRmxReXhQUVVGbUxFTkJRWFZDTEZWQlFVTkRMRXRCUVVRc1JVRkJWenRCUVVOb1Ewd3NXVUZCVFUwc1UwRkJUaXhEUVVGblFrUXNTMEZCYUVJN1FVRkRSQ3hMUVVaRU96dEJRVWxCTzBGQlEwRXNkMEpCUVZsV0xGbEJRVmxETEZOQlFYaENMRVZCUVcxRFZ5eFBRVUZ1UXl4RFFVRXlReXhWUVVGRFF5eFBRVUZFTEVWQlFXRTdRVUZEZEVRc1ZVRkJTVU1zV1VGQldXUXNXVUZCV1VNc1UwRkJXaXhEUVVGelFsa3NUMEZCZEVJc1EwRkJhRUk3UVVGRFFWSXNXVUZCVFZVc1owSkJRVTRzUTBGQmRVSkdMRTlCUVhaQ0xFbEJRV3RETERoQ1FVRnZRbElzUzBGQmNFSXNSVUZCTWtKUkxFOUJRVE5DTEVWQlFXOURReXhUUVVGd1F5eERRVUZzUXp0QlFVTkVMRXRCU0VRN08wRkJTMEZVTEZWQlFVMVhMR3RDUVVGT08wRkJha0lyUmp0QlFXdENhRWM3T3pzN2VVTkJSVzlDTzBGQlEyNUNPMEZCUTBFc1ZVRkJTVmdzVVVGQlVTeEpRVUZhT3p0QlFVVkJRU3haUVVGTldTeGxRVUZPTEVkQlFYZENXaXhOUVVGTllTeEpRVUZPTEVOQlFWZERMRmRCUVZnc1EwRkJkVUprTEUxQlFVMWxMRWxCUVU0c1IwRkJZU3hWUVVGd1F5eEZRVUZuUkN4VlFVRkRReXhIUVVGRUxFVkJRVk03UVVGREwwVXNXVUZCU1VFc1NVRkJTV3hFTEVsQlFVb3NTMEZCWVN4UlFVRnFRaXhGUVVFeVFqdEJRVU42UWtjc2EwSkJRVkZuUkN4SFFVRlNMRU5CUVZrc2QwSkJRWGRDYWtJc1RVRkJUV1VzU1VGQk9VSXNSMEZCY1VNc1VVRkJha1FzUlVGQk1rUkRMRWRCUVRORU8wRkJRMEZvUWl4blFrRkJUV3RDTEdGQlFVNHNRMEZCYjBKc1FpeE5RVUZOUnl4UlFVRXhRaXhGUVVGdlEyRXNSMEZCY0VNN1FVRkRSRHRCUVVOR0xFOUJUSFZDTEVOQlFYaENPMEZCVFVRN096dDNRMEZGYlVJN1FVRkRiRUk3UVVGRFFTeFZRVUZKYUVJc1VVRkJVU3hKUVVGYU96dEJRVVZCUVN4WlFVRk5XU3hsUVVGT0xFTkJRWE5DVHl4TlFVRjBRanRCUVVORU96dEJRVVZFT3pzN096czdPRUpCUjFNN1FVRkRVQ3hWUVVGSmJrSXNVVUZCVVN4SlFVRmFPenRCUVVWQlFTeFpRVUZOYjBJc2FVSkJRVTQ3UVVGRFFTeGhRVUZQY0VJc1RVRkJUWEZDTEZGQlFVNHNRMEZCWlVNc1ZVRkJaaXhEUVVFd1FuUkNMRTFCUVUxbExFbEJRV2hETEVOQlFWQTdRVUZEUkRzN1FVRkZSRHM3T3pzN08ydERRVWRqTzBGQlExb3NWVUZCU1dZc1VVRkJVU3hKUVVGYU96dEJRVVZCTzBGQlEwRXNWVUZCU1hWQ0xHbENRVUZwUWp0QlFVTnVRbnBFTEdOQlFVMHNZVUZFWVN4RlFVTkZNRVFzVFVGQlRYaENMRTFCUVUxNVFpeE5RVVJrTEVWQlEzTkNReXhKUVVGSk1VSXNUVUZCVFhGQ0xGRkJRVTRzUTBGQlpVMHNUMEZFZWtNN1FVRkZia0pETEdOQlFVMHNSVUZCUlVNc1ZVRkJWVGRDTEUxQlFVMWxMRWxCUVd4Q08wRkJSbUVzVDBGQmNrSTdPMEZCUzBGbUxGbEJRVTFoTEVsQlFVNHNRMEZCVjJsQ0xGZEJRVmdzUTBGQmRVSlFMR05CUVhaQ0xFVkJRWFZETEZWQlFVTlJMRXRCUVVRc1JVRkJWenRCUVVOb1JEbEVMR2RDUVVGUlowUXNSMEZCVWl4RFFVRlpMR3REUVVGYUxFVkJRV2RFWXl4TFFVRm9SRHRCUVVOQkxGbEJRVWxCTEUxQlFVMUlMRWxCUVU0c1EwRkJWMGtzU1VGQldDeExRVUZ2UWl4SFFVRjRRaXhGUVVFMlFqdEJRVU16UW1oRExHZENRVUZOYjBJc2FVSkJRVTQ3UVVGRFFTeHBRa0ZCVDNCQ0xFMUJRVTF4UWl4UlFVRk9MRU5CUVdWRExGVkJRV1lzUTBGQk1FSjBRaXhOUVVGTlpTeEpRVUZvUXl4RFFVRlFPMEZCUTBRN1FVRkRSaXhQUVU1RU8wRkJUMFE3TzBGQlJVUTdPenM3T3pzN096WkNRVXRUYTBJc1RTeEZRVUZSUXl4UkxFVkJRVlU3UVVGRGVrSXNWVUZCU1VNc1RVRkJUVVlzVFVGQlZqdEJRVU5CTEZWQlFVbEhMRmxCUVZrN1FVRkRaSFJGTEdOQlFVMXhRaXhYUVVGWFJ5eExRVVJJTzBGQlJXUTBReXhyUWtGQlZVRTdRVUZHU1N4UFFVRm9RanM3UVVGTFFTeFZRVUZKUnl4TlFVRk5TaXhQUVVGUE5VUXNUMEZCVUN4RFFVRmxMRWRCUVdZc1EwRkJWanRCUVVOQkxGVkJRVWxuUlN4UlFVRlJTaXhQUVVGUGRrUXNUVUZCVUN4SFFVRm5RaXhEUVVFMVFpeEZRVUVyUWp0QlFVTTNRaXhaUVVGSk1rUXNVVUZCVVN4RFFVRmFMRVZCUVdVN1FVRkRZa1FzYjBKQlFWVjBSU3hKUVVGV0xFZEJRV2xDY1VJc1YwRkJWME1zUjBGQk5VSTdRVUZEUkN4VFFVWkVMRTFCUlU4N1FVRkRUR2RFTEc5Q1FVRlZkRVVzU1VGQlZpeEhRVUZwUW5GQ0xGZEJRVmRGTEV0QlFUVkNPMEZCUTBFNFF5eG5Ra0ZCVFVZc1QwRkJUemRFTEUxQlFWQXNRMEZCWXl4RFFVRmtMRVZCUVdsQ05rUXNUMEZCVDNaRUxFMUJRVkFzUjBGQlowSXNRMEZCYWtNc1EwRkJUanRCUVVORU8wRkJRMFk3TzBGQlJVUXNWMEZCUzNkQ0xGRkJRVXdzUTBGQlkybERMRWRCUVdRc1NVRkJjVUpETEZOQlFYSkNPMEZCUTBRN096czRRa0ZGVXk5Q0xFc3NSVUZCVHp0QlFVTm1MRlZCUVVsTUxGRkJRVkVzU1VGQldqczdRVUZGUVN3d1FrRkJXVUVzVFVGQlRVVXNVVUZCYkVJc1JVRkJORUpMTEU5QlFUVkNMRU5CUVc5RExGVkJRVU0wUWl4SFFVRkVMRVZCUVZNN1FVRkRNME1zV1VGQlNVWXNVMEZCVTJwRExFMUJRVTFGTEZGQlFVNHNRMEZCWldsRExFZEJRV1lzUTBGQllqdEJRVU5CTEZsQlFVbEdMRTlCUVU5dVJTeEpRVUZRTEV0QlFXZENjVUlzVjBGQlYwTXNSMEZCTDBJc1JVRkJiME03UVVGRGJFTTdRVUZEUVRaRExHbENRVUZQUXl4UlFVRlFMRU5CUVdkQ04wSXNTMEZCYUVJN1FVRkRSQ3hUUVVoRUxFMUJSMDhzU1VGQlNUUkNMRTlCUVU5dVJTeEpRVUZRTEV0QlFXZENjVUlzVjBGQlYwVXNTMEZCTDBJc1JVRkJjME03UVVGRE0wTTdRVUZEUVN4alFVRkpaMElzVFVGQlRXbERMRXRCUVU0c1EwRkJXV3BGTEU5QlFWb3NRMEZCYjBJNFJDeEhRVUZ3UWl4TlFVRTJRaXhEUVVGcVF5eEZRVUZ2UXp0QlFVTnNRMFlzYlVKQlFVOURMRkZCUVZBc1EwRkJaMEkzUWl4TFFVRm9RanRCUVVORU8wRkJRMFlzVTBGTVRTeE5RVXRCTEVsQlFVazBRaXhQUVVGUGJrVXNTVUZCVUN4TFFVRm5RbkZDTEZkQlFWZEhMRXRCUVM5Q0xFVkJRWE5ETzBGQlF6TkRPMEZCUTBFc1kwRkJTV1VzVFVGQlRXbERMRXRCUVU0c1MwRkJaMEpJTEVkQlFYQkNMRVZCUVhsQ08wRkJRM1pDUml4dFFrRkJUME1zVVVGQlVDeERRVUZuUWpkQ0xFdEJRV2hDTzBGQlEwUTdRVUZEUmp0QlFVTkdMRTlCYUVKRU8wRkJhVUpFT3pzN2RVSkJha2w1UXl3eVFqczdhMEpCYjBrM1FtUXNhMEk3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096dEJRemRKWmpzN096dEJRVU5CT3pzN08wRkJSVUU3T3pzN1FVRXhRa0U3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN08wbEJPRUpOWjBRc2EwSTdPenRCUVVOS096czdPenM3T3p0QlFWTkJPenM3TzBGQlNVRXNPRUpCUVZrdlF5eFBRVUZhTEVWQlFYRkNja01zUjBGQmNrSXNSVUZCTUVKelF5eE5RVUV4UWl4RlFVRnJRME1zWVVGQmJFTXNSVUZCYVVSRExGZEJRV3BFTEVWQlFUaEVReXhUUVVFNVJDeEZRVUY1UlR0QlFVRkJPenRCUVVGQkxDdEtRVU5xUlVvc1QwRkVhVVVzUlVGRGVFUnlReXhIUVVSM1JDeEZRVU51UkhORExFMUJSRzFFTEVWQlF6TkRReXhoUVVReVF5eEZRVU0xUWtNc1YwRkVORUlzUlVGRFprTXNVMEZFWlRzN1FVRkZka1VzVVVGQlNVa3NZMEZCU2pzN1FVRkZRVUVzVlVGQlRYZERMR05CUVU0c1IwRkJkVUlzUlVGQmRrSTdPMEZCUlVGNFF5eFZRVUZOUnl4UlFVRk9MRU5CUVdWRExFOUJRV1lzUTBGQmRVSXNWVUZCUTBNc1MwRkJSQ3hGUVVGWE8wRkJRMmhEY0VNc1kwRkJVV2RFTEVkQlFWSXNRMEZCV1N4M1FrRkJkMEk1UkN4SFFVRjRRaXhIUVVFNFFpeFRRVUV4UXl4RlFVRnhSR3RFTEV0QlFYSkVPMEZCUTBGTUxGbEJRVTE1UXl4VFFVRk9MRU5CUVdkQ2NFTXNTMEZCYUVJN1FVRkRSQ3hMUVVoRU96dEJRVXRCVEN4VlFVRk5WeXhyUWtGQlRqdEJRVmgxUlR0QlFWbDRSVHM3T3p0NVEwRkZiMEk3UVVGRGJrSTdRVUZEUVN4VlFVRkpXQ3hSUVVGUkxFbEJRVm83TzBGQlJVRkJMRmxCUVUwd1F5eGxRVUZPTEVkQlFYZENNVU1zVFVGQlRXRXNTVUZCVGl4RFFVRlhReXhYUVVGWUxFTkJRWFZDWkN4TlFVRk5aU3hKUVVFM1FpeEZRVUZ0UXl4VlFVRkRReXhIUVVGRUxFVkJRVk03UVVGRGJFVXZReXhuUWtGQlVXZEVMRWRCUVZJc1EwRkJXU3huUWtGQlowSnFRaXhOUVVGTlpTeEpRVUYwUWl4SFFVRTJRaXhSUVVGNlF5eEZRVUZ0UkVNc1IwRkJia1E3UVVGRFFTeG5Ra0ZCVVVFc1NVRkJTV3hFTEVsQlFWbzdRVUZEUlN4bFFVRkxMRlZCUVV3N1FVRkJhVUpyUXl4clFrRkJUVEpETEZkQlFVNHNRMEZCYTBJelFpeEhRVUZzUWl4RlFVRjNRanRCUVVONlF5eGxRVUZMTEUxQlFVdzdRVUZCWVdoQ0xHdENRVUZOTkVNc1QwRkJUaXhEUVVGak5VSXNSMEZCWkN4RlFVRnZRanRCUVVadVF6dEJRVWxFTEU5QlRuVkNMRU5CUVhoQ08wRkJUMFE3T3p0M1EwRkZiVUk3UVVGRGJFSTdRVUZEUVN4VlFVRkphRUlzVVVGQlVTeEpRVUZhT3p0QlFVVkJRU3haUVVGTk1FTXNaVUZCVGl4RFFVRnpRblpDTEUxQlFYUkNPMEZCUTBRN08wRkJSVVE3T3pzN096czdiME5CU1dkQ01FSXNVeXhGUVVGWE8wRkJRM3BDTEZWQlFVazNReXhSUVVGUkxFbEJRVm83TzBGQlJVRTdRVUZEUVN4VlFVRkpPRU1zV1VGQldUdEJRVU5rYUVZc1kwRkJUU3hSUVVSUkxFVkJRMFV3UkN4TlFVRk5lRUlzVFVGQlRYRkNMRkZCUVU0c1EwRkJaVWtzVFVGRWRrSXNSVUZESzBKRExFbEJRVWt4UWl4TlFVRk5jVUlzVVVGQlRpeERRVUZsVFN4UFFVUnNSRHRCUVVWa1F5eGpRVUZOTEVWQlFVVnRRaXhSUVVGUkxFdEJRVllzUlVGQmFVSnNRaXhWUVVGVk4wSXNUVUZCVFdVc1NVRkJha01zUlVGQmRVTjBRaXhSUVVGUlR5eE5RVUZOWjBRc1QwRkJja1FzUlVGQk9FUXhSaXhQUVVGUE1FTXNUVUZCVFVjc1VVRkJUaXhEUVVGbFNpeEpRVUZ3Uml4RlFVRXdSbXRFTEZkQlFWZEtMRk5CUVhKSE8wRkJSbEVzVDBGQmFFSTdPMEZCUzBFM1F5eFpRVUZOWVN4SlFVRk9MRU5CUVZkcFFpeFhRVUZZTEVOQlFYVkNaMElzVTBGQmRrSTdRVUZEUkRzN1FVRkZSRHM3T3pzN096aENRVWRUTzBGQlExQXNWVUZCU1RsRExGRkJRVkVzU1VGQldqczdRVUZGUVR0QlFVTkJMRlZCUVVsclJDeFpRVUZaTzBGQlEyUndSaXhqUVVGTkxGRkJSRkVzUlVGRFJUQkVMRTFCUVUxNFFpeE5RVUZOZVVJc1RVRkVaQ3hGUVVOelFrTXNTVUZCU1RGQ0xFMUJRVTF4UWl4UlFVRk9MRU5CUVdWTkxFOUJSSHBETzBGQlJXUkRMR05CUVUwc1JVRkJSVU1zVlVGQlZUZENMRTFCUVUxbExFbEJRV3hDTzBGQlJsRXNUMEZCYUVJN08wRkJTMEZtTEZsQlFVMWhMRWxCUVU0c1EwRkJWMmxDTEZkQlFWZ3NRMEZCZFVKdlFpeFRRVUYyUWl4RlFVRnJReXhWUVVGRGJrSXNTMEZCUkN4RlFVRlhPMEZCUXpORE9VUXNaMEpCUVZGblJDeEhRVUZTTEVOQlFWa3NOa0pCUVZvc1JVRkJNa05qTEV0QlFUTkRPMEZCUTBFc1dVRkJTVUVzVFVGQlRVZ3NTVUZCVGl4RFFVRlhTU3hKUVVGWUxFdEJRVzlDTEVkQlFYaENMRVZCUVRaQ08wRkJRek5DYUVNc1owSkJRVTF2UWl4cFFrRkJUanRCUVVOQkxHbENRVUZQY0VJc1RVRkJUWEZDTEZGQlFVNHNRMEZCWlRoQ0xGVkJRV1lzUTBGQk1FSnVSQ3hOUVVGTlpTeEpRVUZvUXl4RFFVRlFPMEZCUTBRN1FVRkRSaXhQUVU1RU8wRkJUMFE3TzBGQlJVUTdPenM3T3pzN096dEJRVTFCT3pzN08yMURRVWxsYlVJc1VTeEZRVUZWTzBGQlEzWkNMRmRCUVV0clFpeHpRa0ZCVEN4SFFVRTRRbXhDTEZGQlFUbENPMEZCUTBRN08wRkJSVVE3T3pzN096czdLMEpCU1ZkQkxGRXNSVUZCVlR0QlFVTnVRaXhYUVVGTGJVSXNhMEpCUVV3c1IwRkJNRUp1UWl4UlFVRXhRanRCUVVORU96dEJRVVZFT3pzN096czdPekpDUVVsUFFTeFJMRVZCUVZVN1FVRkRaaXhYUVVGTGIwSXNZMEZCVEN4SFFVRnpRbkJDTEZGQlFYUkNPMEZCUTBRN08wRkJSVVE3T3pzN0swSkJRMWRzUWl4SExFVkJRVXM3UVVGRFpDeFZRVUZKYUVJc1VVRkJVU3hKUVVGYU96dEJRVVZCTDBJc1kwRkJVV2RFTEVkQlFWSXNRMEZCV1N3d1FrRkJXaXhGUVVGM1EwUXNSMEZCZUVNN1FVRkRRU3hqUVVGUlFTeEpRVUZKV1N4SlFVRktMRU5CUVZNNVJDeEpRVUZxUWp0QlFVTkZMR0ZCUVVzc1YwRkJURHRCUVVGclFtdERMR2RDUVVGTmRVUXNXVUZCVGl4RFFVRnRRblpETEVkQlFXNUNMRVZCUVhsQ08wRkJRek5ETEdGQlFVc3NZVUZCVER0QlFVRnZRbWhDTEdkQ1FVRk5kMFFzWTBGQlRpeERRVUZ4UW5oRExFZEJRWEpDTEVWQlFUSkNPMEZCUm1wRU8wRkJTVVE3TzBGQlJVUTdPenM3YVVOQlEyRkJMRWNzUlVGQlN6dEJRVUZCT3p0QlFVTm9RaXhWUVVGSmFFSXNVVUZCVVN4SlFVRmFPMEZCUTBFc1ZVRkJTWGxFTEdGQlFXRjZReXhKUVVGSldTeEpRVUZLTEVOQlFWTktMRWxCUVRGQ08wRkJRMEYyUkN4alFVRlJaMFFzUjBGQlVpeERRVUZaTEcxRFFVRmFMRVZCUVdsRVJDeEhRVUZxUkRzN1FVRkZRU3hWUVVGSldDeFJRVUZSTzBGQlExWjJReXhqUVVGTmEwUXNTVUZCU1Zrc1NVRkJTaXhEUVVGVE9VUXNTVUZFVER0QlFVVldXQ3hoUVVGTGMwY3NWVUZHU3pzN1FVRkpWbnBHTEd0Q1FVRlZaMFFzU1VGQlNWa3NTVUZCU2l4RFFVRlROVVFzVVVGS1ZEczdRVUZOVmpCR0xHZENRVUZSTEd0Q1FVRk5PMEZCUTFvN1FVRkRRU3hqUVVGSlF5eE5RVUZOTEVWQlFVVjRSeXhMUVVGTGMwY3NWVUZCVUN4RlFVRnRRa2NzVVVGQlVTeEpRVUV6UWl4RlFVRldPMEZCUTBFMVJDeG5Ra0ZCVFhkRExHTkJRVTRzUTBGQmNVSnBRaXhWUVVGeVFpeEpRVUZ0UTBVc1IwRkJia003TzBGQlJVRTdRVUZEUVN4alFVRkpSU3hwUWtGQmFVSXNSVUZCY2tJN1FVRkRRU3c0UWtGQldUZEVMRTFCUVUxVkxHZENRVUZzUWl4RlFVRnZRMGdzVDBGQmNFTXNRMEZCTkVNc1ZVRkJRME1zVDBGQlJDeEZRVUZoTzBGQlEzWkVMR2RDUVVGSlF5eFpRVUZaVkN4TlFVRk5WU3huUWtGQlRpeERRVUYxUWtZc1QwRkJka0lzUlVGQlowTlVMRWxCUVdoRU8wRkJRMEU0UkN3eVFrRkJaWEpFTEU5QlFXWXNTVUZCTUVJc2MwSkJRVlZETEZOQlFWWXNRMEZCTVVJN1FVRkRSQ3hYUVVoRU96dEJRVXRCTEdOQlFVbHhSQ3hWUVVGVk8wRkJRMXBETEdkQ1FVRkpMME1zU1VGQlNTdERMRVZCUkVrc1JVRkRRV3BITEUxQlFVMHNWVUZFVGl4RlFVTnJRakJFTEUxQlFVMVNMRWxCUVVsVkxFVkJSRFZDTEVWQlEyZERRU3hKUVVGSlZpeEpRVUZKVVN4SlFVUjRRenRCUVVWYVNTeHJRa0ZCVFN4RlFVRkZTU3hOUVVGTkxFZEJRVklzUlVGQllYWkRMRkZCUVZGUExFMUJRVTFuUkN4UFFVRXpRaXhGUVVGdlEyZENMRk5CUVZOb1JTeE5RVUZOUXl4UlFVRnVSQ3hGUVVFMlJETkRMRTlCUVU4c1JVRkJSWGxETEUxQlFVMHNjMEpCUVZWRExFMUJRVTFFTEVsQlFXaENMRU5CUVZJc1JVRkJLMEpJTEZkQlFWZHBSU3hqUVVFeFF5eEZRVUZ3UlR0QlFVWk5MRmRCUVdRN08wRkJTMEU3UVVGRFFTeGpRVUZKTjBNc1NVRkJTVmtzU1VGQlNpeERRVUZUY1VNc1kwRkJWQ3hEUVVGM1FpeHpRa0ZCZUVJc1MwRkJiVVFzUTBGQlEycEVMRWxCUVVsWkxFbEJRVW9zUTBGQlUzTkRMRzlDUVVGcVJTeEZRVUYxUmp0QlFVTnlSa29zYjBKQlFWRnNReXhKUVVGU0xFTkJRV0Z6UXl4dlFrRkJZaXhIUVVGdlF5eFBRVUZMUXl4eFFrRkJla003UVVGRFFTeHRRa0ZCUzBFc2NVSkJRVXdzUjBGQk5rSnVSQ3hKUVVGSldTeEpRVUZLTEVOQlFWTnpReXh2UWtGQmRFTTdRVUZEUkRzN1FVRkZSRHRCUVVOQmJFVXNaMEpCUVUxaExFbEJRVTRzUTBGQlYybENMRmRCUVZnc1EwRkJkVUpuUXl4UFFVRjJRanM3UVVGRlFTeHBRa0ZCVDBnc1IwRkJVRHRCUVVORUxGTkJha05UT3p0QlFXMURWbE1zWjBKQlFWRXNaMEpCUVVORExFMUJRVVFzUlVGQldUdEJRVU5zUWp0QlFVTkJja1VzWjBKQlFVMWhMRWxCUVU0c1EwRkJWMmxDTEZkQlFWZ3NRMEZCZFVJN1FVRkRja0pwUXl4blFrRkJTUzlETEVsQlFVa3JReXhGUVVSaExFVkJRMVJxUnl4TlFVRk5MRlZCUkVjc1JVRkRVekJFTEUxQlFVMVNMRWxCUVVsVkxFVkJSRzVDTEVWQlEzVkNRU3hKUVVGSlZpeEpRVUZKVVN4SlFVUXZRanRCUVVWeVFra3NhMEpCUVUwc1JVRkJSVWtzVFVGQlRTeEhRVUZTTEVWQlFXRnpReXhOUVVGTlJDeE5RVUZ1UWp0QlFVWmxMRmRCUVhaQ08wRkJTVVE3UVVGNlExTXNUMEZCV2pzN1FVRTBRMEVzVlVGQlNYSkZMRTFCUVUxdlJDeHpRa0ZCVml4RlFVRnJRenRCUVVOb1EyNUdMR2RDUVVGUlowUXNSMEZCVWl4RFFVRlpMSE5DUVVGYUxFVkJRVzlEV2l4TFFVRndRenRCUVVOQlRDeGpRVUZOYjBRc2MwSkJRVTRzUTBGQk5rSXZReXhMUVVFM1FqdEJRVU5FTzBGQlEwWTdPMEZCUlVRN096czdiVU5CUTJWWExFY3NSVUZCU3p0QlFVTnNRaXhWUVVGSmFFSXNVVUZCVVN4SlFVRmFPMEZCUTBFc1ZVRkJTWGxFTEdGQlFXRjZReXhKUVVGSldTeEpRVUZLTEVOQlFWTktMRWxCUVRGQ096dEJRVVZCTEZWQlFVbHRReXhOUVVGTk0wUXNUVUZCVFhkRExHTkJRVTRzUTBGQmNVSnBRaXhWUVVGeVFpeERRVUZXTzBGQlEwRXNZVUZCVDNwRUxFMUJRVTEzUXl4alFVRk9MRU5CUVhGQ2FVSXNWVUZCY2tJc1EwRkJVRHM3UVVGRlFTeFZRVUZKY0VRc1VVRkJVVHRCUVVOV2RrTXNZMEZCVFd0RUxFbEJRVWxaTEVsQlFVb3NRMEZCVXpsRUxFbEJSRXc3UVVGRlZsZ3NZVUZCUzNOSExGVkJSa3M3UVVGSFZqbEZMR2RDUVVGUlowWTdRVUZJUlN4UFFVRmFPenRCUVUxQkxGVkJRVWt6UkN4TlFVRk5iMFFzYzBKQlFWWXNSVUZCYTBNN1FVRkRhRU51Uml4blFrRkJVV2RFTEVkQlFWSXNRMEZCV1N4NVFrRkJXaXhGUVVGMVExb3NTMEZCZGtNN1FVRkRRVXdzWTBGQlRXOUVMSE5DUVVGT0xFTkJRVFpDTDBNc1MwRkJOMEk3UVVGRFJEdEJRVU5HT3p0QlFVVkVPenM3TzJkRFFVTlpWeXhITEVWQlFVczdRVUZEWml4VlFVRkphRUlzVVVGQlVTeEpRVUZhT3p0QlFVVkJMRlZCUVVsTExGRkJRVkU3UVVGRFZuWkRMR05CUVUxclJDeEpRVUZKYkVRc1NVRkVRVHRCUVVWV1dDeGhRVUZMTmtRc1NVRkJTVkVzU1VGR1F6dEJRVWRXVVN4alFVRk5hRUlzU1VGQlNWa3NTVUZCU2l4RFFVRlRTVHRCUVVoTUxFOUJRVm83TzBGQlRVRXNWVUZCU1doRExFMUJRVTF4UkN4clFrRkJWaXhGUVVFNFFqdEJRVU0xUW5CR0xHZENRVUZSWjBRc1IwRkJVaXhEUVVGWkxHdENRVUZhTEVWQlFXZERXaXhMUVVGb1F6dEJRVU5CVEN4alFVRk5jVVFzYTBKQlFVNHNRMEZCZVVKb1JDeExRVUY2UWp0QlFVTkVPMEZCUTBZN08wRkJSVVE3T3pzN05FSkJRMUZYTEVjc1JVRkJTenRCUVVOWUxGVkJRVWxvUWl4UlFVRlJMRWxCUVZvN08wRkJSVUVzVlVGQlNVc3NVVUZCVVR0QlFVTldka01zWTBGQlRXdEVMRWxCUVVsc1JDeEpRVVJCTzBGQlJWWllMR0ZCUVVzMlJDeEpRVUZKVVN4SlFVWkRPenRCUVVsV2EwTXNaMEpCUVZFc2EwSkJRVTA3UVVGRFdqRkVMR2RDUVVGTllTeEpRVUZPTEVOQlFWZHBRaXhYUVVGWUxFTkJRWFZDTzBGQlEzSkNhVU1zWjBKQlFVa3ZReXhKUVVGSkswTXNSVUZFWVN4RlFVTlVha2NzVFVGQlRTeFZRVVJITEVWQlExTXdSQ3hOUVVGTlVpeEpRVUZKVlN4RlFVUnVRaXhGUVVOMVFrRXNTVUZCU1ZZc1NVRkJTVkVzU1VGRUwwSTdRVUZGY2tKSkxHdENRVUZOTEVWQlFVVkpMRTFCUVUwc1IwRkJVaXhGUVVGaE1VVXNUMEZCVHl4elFrRkJWVEJETEUxQlFVMUVMRWxCUVdoQ0xFTkJRWEJDTzBGQlJtVXNWMEZCZGtJN1FVRkpSQ3hUUVZSVE96dEJRVmRXY1VVc1owSkJRVkVzWjBKQlFVTkRMRTFCUVVRc1JVRkJXVHRCUVVOc1FuSkZMR2RDUVVGTllTeEpRVUZPTEVOQlFWZHBRaXhYUVVGWUxFTkJRWFZDTzBGQlEzSkNhVU1zWjBKQlFVa3ZReXhKUVVGSkswTXNSVUZFWVN4RlFVTlVha2NzVFVGQlRTeFZRVVJITEVWQlExTXdSQ3hOUVVGTlVpeEpRVUZKVlN4RlFVUnVRaXhGUVVOMVFrRXNTVUZCU1ZZc1NVRkJTVkVzU1VGRUwwSTdRVUZGY2tKSkxHdENRVUZOTEVWQlFVVkpMRTFCUVUwc1IwRkJVaXhGUVVGaGMwTXNUVUZCVFVRc1RVRkJia0k3UVVGR1pTeFhRVUYyUWp0QlFVbEVPMEZCYUVKVExFOUJRVm83TzBGQmJVSkJMRlZCUVVseVJTeE5RVUZOYzBRc1kwRkJWaXhGUVVFd1FqdEJRVU40UW5KR0xHZENRVUZSWjBRc1IwRkJVaXhEUVVGWkxHTkJRVm9zUlVGQk5FSmFMRXRCUVRWQ08wRkJRMEZNTEdOQlFVMXpSQ3hqUVVGT0xFTkJRWEZDYWtRc1MwRkJja0k3UVVGRFJEdEJRVU5HT3pzN2QwSkJOVXB0UWp0QlFVRkZMR0ZCUVU4c1MwRkJTMjFETEdOQlFWbzdRVUZCTmtJN096dDFRa0Y2UmxRc01rSTdPMnRDUVhsUU4wSkVMR3RDT3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN1FVTm9VV1k3T3pzN1FVRkRRVHM3T3p0QlFVTkJPenM3TzBGQlJVRTdPenM3U1VGSlRXZERMRlU3UVVGRFNqczdPenM3T3pzN096czdPenM3UVVGcFFrRTdPenM3UVVGSlFTeHpRa0ZCV1M5RkxFOUJRVm9zUlVGQmNVSnlReXhIUVVGeVFpeEZRVUV3UW5ORExFMUJRVEZDTEVWQlFXdERReXhoUVVGc1F5eEZRVUZwUkVNc1YwRkJha1FzUlVGQk9FUkRMRk5CUVRsRUxFVkJRWGRHTzBGQlFVRXNVVUZCWmtVc1RVRkJaU3gxUlVGQlRpeEpRVUZOTzBGQlFVRTdPMEZCUTNSR0xGRkJRVWxGTEZGQlFWRXNTVUZCV2pzN1FVRkZRVUVzVlVGQlRYRkNMRkZCUVU0c1IwRkJhVUkzUWl4UFFVRnFRanRCUVVOQlVTeFZRVUZOWlN4SlFVRk9MRWRCUVdFMVJDeEhRVUZpTzBGQlEwRTJReXhWUVVGTlowUXNUMEZCVGl4SFFVRm5RblpFTEUxQlFXaENPMEZCUTBGUExGVkJRVTEzUlN4UFFVRk9MRWRCUVdkQ09VVXNZVUZCYUVJN1FVRkRRVTBzVlVGQlRVY3NVVUZCVGl4SFFVRnBRaXd3UWtGQlpWSXNWMEZCWml4RFFVRnFRanRCUVVOQlN5eFZRVUZOZVVVc1ZVRkJUaXhIUVVGdFFqZEZMRk5CUVc1Q096dEJRVVZCTzBGQlEwRkpMRlZCUVUxdFJTeHhRa0ZCVGl4SFFVRTRRbkpGTEUxQlFUbENPenRCUVVWQlJTeFZRVUZOUXl4UlFVRk9MRWRCUVdsQ0xFTkJRV3BDTzBGQlEwRkVMRlZCUVUwd1JTeFJRVUZPTEVkQlFXbENMRU5CUVdwQ08wRkJRMEV4UlN4VlFVRk5WU3huUWtGQlRpeEhRVUY1UWl4RlFVRjZRanRCUVVOQlZpeFZRVUZOTWtVc2EwSkJRVTRzUjBGQk1rSXNSVUZCTTBJN08wRkJSVUV6UlN4VlFVRk5lVUlzVFVGQlRpeEhRVUZsYWtNc1VVRkJVV2xETEUxQlFYWkNPMEZCUTBGNlFpeFZRVUZOWVN4SlFVRk9MRWRCUVdGeVFpeFJRVUZSY1VJc1NVRkJja0k3UVVGRFJEczdPenQ1UTBGRmIwSTdRVUZCUVRzN1FVRkRia0lzVlVGQlNXSXNVVUZCVVN4SlFVRmFPenRCUVVWQkxGVkJRVWswUlN4bFFVRmxOVVVzVFVGQlRXVXNTVUZCVGl4SFFVRmhMRmxCUVdoRE8wRkJRMEU1UXl4alFVRlJaMFFzUjBGQlVpeERRVUZaTEhORFFVRmFMRVZCUVc5RWFrSXNUVUZCVFhsRkxGVkJRVEZFTzBGQlEwRXNWVUZCU1hwRkxFMUJRVTE1UlN4VlFVRldMRVZCUVhOQ08wRkJRM0JDZWtVc1kwRkJUWGxGTEZWQlFVNHNRMEZCYVVKc1JTeFBRVUZxUWl4RFFVRjVRaXhWUVVGRGMwVXNTMEZCUkN4RlFVRlhPMEZCUTJ4RExHTkJRVWxETEZkQlFWZEdMR1ZCUVdWRExFdEJRVGxDTzBGQlEwRXNZMEZCU1VVc1YwRkJWeTlGTEUxQlFVMWhMRWxCUVU0c1EwRkJWME1zVjBGQldDeERRVUYxUW1kRkxGRkJRWFpDTEVWQlFXbERMRlZCUVVNNVJDeEhRVUZFTEVWQlFWTTdRVUZEZGtRN1FVRkRRU3huUWtGQlNVRXNTVUZCU1ZFc1NVRkJTaXhMUVVGaExFOUJRVXRETEUxQlFYUkNMRVZCUVRoQ08wRkJRelZDZUVRc2MwSkJRVkZuUkN4SFFVRlNMRU5CUVZrc01rSkJRVm9zUlVGQmVVTkVMRWRCUVhwRE8wRkJRMEVzYzBKQlFWRkJMRWxCUVVsc1JDeEpRVUZhTzBGQlEwVXNjVUpCUVVzc1VVRkJURHRCUVVGbGEwTXNkMEpCUVUxblJpeGpRVUZPTEVOQlFYRkNhRVVzUjBGQmNrSXNSVUZCTWtJN1FVRkRNVU1zY1VKQlFVc3NVVUZCVER0QlFVRmxMME1zTUVKQlFWRm5SQ3hIUVVGU0xFTkJRVmxFTEVkQlFWb3NSVUZCYTBJN1FVRkRha003UVVGQlUyaENMSGRDUVVGTmFVWXNaVUZCVGl4RFFVRnpRbXBGTEVkQlFYUkNMRVZCUVRSQ08wRkJTSFpETzBGQlMwUTdRVUZEUml4WFFWWmpMRU5CUVdZN08wRkJXVUZvUWl4blFrRkJUVEpGTEd0Q1FVRk9MRU5CUVhsQ1R5eEpRVUY2UWl4RFFVRTRRa2dzVVVGQk9VSTdRVUZEUkN4VFFXWkVPMEZCWjBKRU8wRkJRMFk3T3p0M1EwRkZiVUk3UVVGRGJFSXNWVUZCU1M5RkxGRkJRVkVzU1VGQldqczdRVUZGUVVFc1dVRkJUVEpGTEd0Q1FVRk9MRU5CUVhsQ2NFVXNUMEZCZWtJc1EwRkJhVU1zVlVGQlEzZEZMRkZCUVVRc1JVRkJZenRCUVVNM1EwRXNhVUpCUVZNMVJDeE5RVUZVTzBGQlEwUXNUMEZHUkRzN1FVRkpRU3d3UWtGQldXNUNMRTFCUVUxVkxHZENRVUZzUWl4RlFVRnZRMGdzVDBGQmNFTXNRMEZCTkVNc1ZVRkJRelJDTEVkQlFVUXNSVUZCVXp0QlFVTnVSRzVETEdOQlFVMVZMR2RDUVVGT0xFTkJRWFZDZVVJc1IwRkJka0lzUlVGQk5FSm1MR2xDUVVFMVFqdEJRVU5FTEU5QlJrUTdRVUZIUkRzN1FVRkZSRHM3T3pzN096czdPMEZCT0VKQk96czdORUpCUjFFN1FVRkRUanRCUVVOQkxGbEJRVTBzYVVKQlFVNDdRVUZEUkRzN1FVRkZSRHM3T3pzN096WkNRVWRUTzBGQlExQTdRVUZEUVN4WlFVRk5MR2xDUVVGT08wRkJRMFE3TzBGQlJVUTdPenM3T3pzeVFrRkhUenRCUVVOTU8wRkJRMEVzV1VGQlRTeHBRa0ZCVGp0QlFVTkVPenRCUVVWRU96czdPenM3T3pzN096WkNRVTlUSzBRc1VTeEZRVUZWZUVZc1Z5eEZRVUZoTTBJc1VTeEZRVUZWTzBGQlEzaERMRlZCUVVsblF5eFJRVUZSTEVsQlFWbzdPMEZCUlVFN1FVRkRRVUVzV1VGQlRUQkZMRkZCUVU0N1FVRkRRU3hWUVVGSlZTeGhRVUZoY0VZc1RVRkJUWGxDTEUxQlFVNHNSMEZCWlN4SFFVRm1MRWRCUVhGQ2VrSXNUVUZCVFRCRkxGRkJRVFZETzBGQlEwRXNWVUZCU1Zjc1pVRkJaWEpHTEUxQlFVMWxMRWxCUVU0c1IwRkJZU3haUVVGaUxFZEJRVFJDYjBVc1VVRkJMME03TzBGQlJVRTdRVUZEUVN4VlFVRkpSeXhoUVVGaE8wRkJRMlo0U0N4alFVRk5MRkZCUkZNc1JVRkRRekJFTEUxQlFVMTRRaXhOUVVGTmVVSXNUVUZFWWl4RlFVTnhRa01zU1VGQlNUSkVMRmxCUkhwQ08wRkJSV1o2UkN4alFVRk5MRVZCUVVWRExGVkJRVlYxUkN4VlFVRmFMRVZCUVhkQ09VZ3NUMEZCVDNGRExGZEJRUzlDTzBGQlJsTXNUMEZCYWtJN08wRkJTMEVzVlVGQlNUTkNMRkZCUVVvc1JVRkJiVUk3UVVGQlJYTklMRzFDUVVGWE1VUXNTVUZCV0N4RFFVRm5RalZFTEZGQlFXaENMRWRCUVRKQ1FTeFJRVUV6UWp0QlFVRnpRenM3UVVGRk0wUTdRVUZEUVN4VlFVRkpMRU5CUVVOblF5eE5RVUZOYlVVc2NVSkJRVmdzUlVGQmEwTnRRaXhYUVVGWE1VUXNTVUZCV0N4RFFVRm5Rbk5ETEc5Q1FVRm9RaXhIUVVGMVEyeEZMRTFCUVUxdFJTeHhRa0ZCTjBNN08wRkJSV3hETzBGQlEwRXNZVUZCVHl4elFrRkJXU3hWUVVGRGIwSXNUMEZCUkN4RlFVRmhPMEZCUXpsQ0xGbEJRVWxETEZGQlFWRjRSaXhOUVVGTllTeEpRVUZPTEVOQlFWZHBRaXhYUVVGWUxFTkJRWFZDZDBRc1ZVRkJka0lzUTBGQldqczdRVUZGUVhKSUxHZENRVUZSWjBRc1IwRkJVaXhEUVVGWkxEUkNRVUUwUW1wQ0xFMUJRVTE1UWl4TlFVRnNReXhIUVVFeVF5eE5RVUYyUkN4RlFVRXJSRFpFTEZWQlFTOUVPMEZCUTBFc1dVRkJTVWNzVjBGQlZ5dzRRa0ZCYjBKNlJpeExRVUZ3UWl4RlFVRXlRbTlHTEZWQlFUTkNMRVZCUVhWRGVrWXNWMEZCZGtNc1JVRkJiMFJMTEUxQlFVMTVRaXhOUVVFeFJDeEZRVUZyUlN0RUxFdEJRV3hGTEVOQlFXWTdRVUZEUVVNc2FVSkJRVk5ETEZGQlFWUXNRMEZCYTBJc1ZVRkJRM0pHTEV0QlFVUXNSVUZCVnp0QlFVTXpRa3dzWjBKQlFVMTVReXhUUVVGT0xFTkJRV2RDY0VNc1MwRkJhRUlzUlVGQmRVSXNSVUZCUlhOR0xFMUJRVTFPTEZsQlFWSXNSVUZCYzBJM1JTeFRRVUZUTkVVc1ZVRkJMMElzUlVGQmRrSTdRVUZEUkN4VFFVWkVPenRCUVVsQmNFWXNZMEZCVFZVc1owSkJRVTRzUTBGQmRVSXdSU3hWUVVGMlFpeEpRVUZ4UTBzc1VVRkJja003TzBGQlJVRkdMR2RDUVVGUlJTeFJRVUZTTzBGQlEwUXNUMEZhVFN4RFFVRlFPMEZCWVVRN08wRkJSVVE3T3pzN096czdLMEpCU1ZkMlJDeFJMRVZCUVZVN1FVRkRia0lzVjBGQlN6QkVMSEZDUVVGTUxFZEJRVFpDTVVRc1VVRkJOMEk3UVVGRFJEczdRVUZGUkRzN096dHRRMEZEWld4Q0xFY3NSVUZCU3p0QlFVTnNRaXhWUVVGSmFFSXNVVUZCVVN4SlFVRmFPMEZCUTBFc1ZVRkJTVzlHTEdGQlFXRndSU3hKUVVGSldTeEpRVUZLTEVOQlFWTkRMRkZCUVRGQ096dEJRVVZCTlVRc1kwRkJVV2RFTEVkQlFWSXNRMEZCV1N3MFFrRkJORUpxUWl4TlFVRk5lVUlzVFVGQmJFTXNSMEZCTWtNc1RVRkJka1FzUlVGQkswUlVMRWRCUVM5RU8wRkJRMEVzVlVGQlNYbEZMRmRCUVZjc09FSkJRVzlDZWtZc1MwRkJjRUlzUlVGQk1rSnZSaXhWUVVFelFpeEZRVUYxUTNCRkxFbEJRVWxaTEVsQlFVb3NRMEZCVTNSRkxFdEJRV2hFTEVOQlFXWTdRVUZEUVRCRExGbEJRVTFWTEdkQ1FVRk9MRU5CUVhWQ01FVXNWVUZCZGtJc1NVRkJjVU5MTEZGQlFYSkRPenRCUVVWQlNTeHBRa0ZCVnl4WlFVRk5PMEZCUTJZN1FVRkRRVGRHTEdOQlFVMWhMRWxCUVU0c1EwRkJWMmxDTEZkQlFWZ3NRMEZCZFVJN1FVRkRja0pwUXl4alFVRkpMME1zU1VGQlNTdERMRVZCUkdFc1JVRkRWR3BITEUxQlFVMHNWVUZFUnl4RlFVTlRNRVFzVFVGQlRWSXNTVUZCU1ZVc1JVRkVia0lzUlVGRGRVSkJMRWxCUVVsV0xFbEJRVWxSTEVsQlJDOUNPMEZCUlhKQ1NTeG5Ra0ZCVFN4RlFVRkZTU3hOUVVGTkxFZEJRVklzUlVGQllUaEVMRkZCUVZFNVJpeE5RVUZOZVVJc1RVRkJNMEk3UVVGR1pTeFRRVUYyUWp0QlFVbEVMRTlCVGtRN08wRkJVVUVzVlVGQlNYQkNMRkZCUVZFN1FVRkRWblpETEdOQlFVMXJSQ3hKUVVGSmJFUXNTVUZFUVR0QlFVVldNRVFzWTBGQlRWSXNTVUZCU1ZFc1NVRkdRVHRCUVVkV2NrVXNZVUZCU3paRUxFbEJRVWxWTEVWQlNFTTdRVUZKVm5CRkxHVkJRVTh3UkN4SlFVRkpXU3hKUVVGS0xFTkJRVk4wUlN4TFFVcE9PMEZCUzFaclJDeHBRa0ZCVXpSRkxGVkJURU03UVVGTlZuQklMR3RDUVVGVlowUXNTVUZCU1Zrc1NVRkJTaXhEUVVGVE5VUTdRVUZPVkN4UFFVRmFPenRCUVZOQkxGVkJRVWxuUXl4TlFVRk5ORVlzY1VKQlFWWXNSVUZCYVVNN1FVRkRMMEl6U0N4blFrRkJVV2RFTEVkQlFWSXNRMEZCV1N4elFrRkJXaXhGUVVGdlExb3NTMEZCY0VNN1FVRkRRVXdzWTBGQlRUUkdMSEZDUVVGT0xFTkJRVFJDZGtZc1MwRkJOVUk3UVVGRFJEdEJRVU5HT3p0QlFVVkVPenM3T3poQ1FVTlZRU3hMTEVWQlFVOHdSaXhUTEVWQlFWYzdRVUZETVVJc1ZVRkJTUzlHTEZGQlFWRXNTVUZCV2pzN1FVRkZRVUVzV1VGQlRVTXNVVUZCVGpzN1FVRkZRU3hWUVVGSlJDeE5RVUZOZDBVc1QwRkJUaXhMUVVGclFpeEpRVUYwUWl4RlFVRTBRanRCUVVNeFFqdEJRVU5CTEZsQlFVbDNRaXhaUVVGWk8wRkJRMlJzU1N4blFrRkJUU3hSUVVSUkxFVkJRMFV3UkN4TlFVRk5lRUlzVFVGQlRXVXNTVUZFWkN4RlFVTnZRbGNzU1VGQlNURkNMRTFCUVUxbExFbEJRVTRzUjBGQllTeFZRVVJ5UXp0QlFVVmtZU3huUWtGQlRTeEZRVUZGYjBNc1UwRkJVMmhGTEUxQlFVMURMRkZCUVdwQ0xFVkJRVEpDTmtZc1VVRkJVVGxHTEUxQlFVMTVRaXhOUVVGNlF5eEZRVUZwUkhkRkxGZEJRVmMxUml4TlFVRk5hVU1zUzBGQmJFVTdRVUZHVVN4VFFVRm9RanM3UVVGTFFYSkZMR2RDUVVGUlowUXNSMEZCVWl4RFFVRlpMRFpDUVVGYUxFVkJRVEpEV2l4TFFVRXpReXhGUVVGclJEQkdMRk5CUVd4RUxFVkJRVFpFUXl4VFFVRTNSRHM3UVVGRlFTeFpRVUZKTTBZc1RVRkJUVFpHTEV0QlFVNHNTMEZCWjBJc2QwSkJRVmRETEUxQlFTOUNMRVZCUVhWRE8wRkJRM0pETEdOQlFVazVSaXhOUVVGTkswWXNTMEZCVGl4TFFVRm5RaXgzUWtGQlYwTXNUVUZCTDBJc1JVRkJkVU03UVVGRGNrTk1MSE5DUVVGVmNFVXNTVUZCVml4RFFVRmxkRVVzUzBGQlppeEhRVUYxUWl0RExFMUJRVTFPTEVsQlFUZENPMEZCUTBRN1FVRkRSaXhUUVVwRUxFMUJTVTg3UVVGRFRHbEhMRzlDUVVGVmNFVXNTVUZCVml4RFFVRmxNRVVzWVVGQlppeEhRVUVyUW1wSExFMUJRVTAyUml4TFFVRnlRenRCUVVOQlJpeHZRa0ZCVlhCRkxFbEJRVllzUTBGQlpYUkZMRXRCUVdZc1IwRkJkVUlyUXl4TlFVRk5UaXhKUVVFM1FqdEJRVU5CTEdOQlFVbE5MRTFCUVUwclJpeExRVUZPTEV0QlFXZENMSGRDUVVGWFJ5eE5RVUV2UWl4RlFVRjFRenRCUVVOeVExQXNjMEpCUVZWd1JTeEpRVUZXTEVOQlFXVTBSU3hUUVVGbUxFZEJRVEpDYmtjc1RVRkJUU3RHTEV0QlFXcERPMEZCUTBRN1FVRkRSanM3UVVGRlJEdEJRVU5CTEZsQlFVbE1MRk5CUVVvc1JVRkJaVHRCUVVOaVF5eHZRa0ZCVlhSRkxFVkJRVllzUjBGQlpYRkZMRlZCUVZWS0xFbEJRWHBDTzBGQlEwRkxMRzlDUVVGVmNFVXNTVUZCVml4RFFVRmxReXhSUVVGbUxFZEJRVEJDYTBVc1ZVRkJWWFpHTEU5QlFYQkRPMEZCUTBRN08wRkJSVVE3UVVGRFFTeFpRVUZKTEVOQlFVTlNMRTFCUVUxdFJTeHhRa0ZCV0N4RlFVRnJRelpDTEZWQlFWVndSU3hKUVVGV0xFTkJRV1Z6UXl4dlFrRkJaaXhIUVVGelEyeEZMRTFCUVUxdFJTeHhRa0ZCTlVNN08wRkJSV3hEYmtVc1kwRkJUV0VzU1VGQlRpeERRVUZYYVVJc1YwRkJXQ3hEUVVGMVFtdEZMRk5CUVhaQ08wRkJRMFE3UVVGRFJqczdRVUZGUkRzN096dHJRMEZEWTFNc1R5eEZRVUZUZWtZc1J5eEZRVUZMTzBGQlF6RkNMRlZCUVVsb1FpeFJRVUZSTEVsQlFWbzdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEVzVlVGQlNVRXNUVUZCVFVNc1VVRkJUaXhIUVVGcFFpeERRVUZxUWl4TFFVRjFRbVVzU1VGQlNWa3NTVUZCU2l4RFFVRlRiME1zVDBGQmNFTXNSVUZCTmtNN1FVRkRNME5vUlN4alFVRk5ReXhSUVVGT08wRkJRMEVzV1VGQlNUQkdMRTlCUVU4elJTeEpRVUZKV1N4SlFVRktMRU5CUVZOeFJTeFRRVUZ3UWp0QlFVTkJMRmxCUVVrelNTeFJRVUZSTEhOQ1FVRlZNRVFzU1VGQlNWa3NTVUZCU2l4RFFVRlRkRVVzUzBGQmJrSXNRMEZCV2p0QlFVTkJMRmxCUVVsdlNpeGhRVUZoUkN4UlFVRlJSU3hWUVVGU0xFTkJRVzFDYUVJc1NVRkJia0lzUTBGQmFrSTdPMEZCUlVFc1dVRkJTVE5GTEVsQlFVbFpMRWxCUVVvc1EwRkJVekJGTEdGQlFWUXNTMEZCTWtJc2QwSkJRVmROTEV0QlFURkRMRVZCUVdsRU8wRkJReTlETEdOQlFVazFSaXhKUVVGSldTeEpRVUZLTEVOQlFWTTBSU3hUUVVGVUxFdEJRWFZDTEhkQ1FVRlhTeXhIUVVGMFF5eEZRVUV5UXp0QlFVTjZReXhuUWtGQlNVTXNUVUZCVFVvc1YwRkJWemxJTEVkQlFYSkNPMEZCUTBFc1owSkJRVWx0U1N4UlFVRlJUQ3hYUVVGWFRTeEpRVUYyUWp0QlFVTkJReXhyUWtGQlRVTXNVMEZCVGl4RFFVRm5Ra01zVFVGQmFFSXNRMEZCZFVKRExFdEJRWFpDTEVOQlFUWkNUaXhIUVVFM1FpeEZRVUZyUXl4RFFVRkRReXhMUVVGRUxFVkJRVkVzUTBGQlVpeEZRVUZYVFN4TlFVRllMRU5CUVd0Q0wwb3NTMEZCYkVJc1EwRkJiRU03UVVGRFJDeFhRVXBFTEUxQlNVOHNTVUZCU1RCRUxFbEJRVWxaTEVsQlFVb3NRMEZCVXpSRkxGTkJRVlFzUzBGQmRVSXNkMEpCUVZkSUxFMUJRWFJETEVWQlFUaERPMEZCUTI1RUxHZENRVUZKVXl4UFFVRk5TaXhYUVVGWE9VZ3NSMEZCY2tJN1FVRkRRU3huUWtGQlNXMUpMRk5CUVZGTUxGZEJRVmROTEVsQlFYWkNPMEZCUTBGR0xHbENRVUZKU3l4TlFVRktMRU5CUVZkS0xFMUJRVmdzUlVGQmEwSjZTaXhMUVVGc1FqdEJRVU5FTEZkQlNrMHNUVUZKUVR0QlFVTk1iMG9zZFVKQlFWYzVTQ3hIUVVGWUxFTkJRV1U0U0N4WFFVRlhUU3hKUVVFeFFpeEpRVUZyUXpGS0xFdEJRV3hETEVOQlJFc3NRMEZEYjBNN1FVRkRNVU03UVVGRFJpeFRRVnBFTEUxQldVODdRVUZEVEN4alFVRkpNRVFzU1VGQlNWa3NTVUZCU2l4RFFVRlRkRVVzUzBGQllpeEZRVUZ2UWp0QlFVTnNRbTlLTEhWQ1FVRlhPVWdzUjBGQldDeERRVUZsT0Vnc1YwRkJWMDBzU1VGQk1VSXNTVUZCYTBNeFNpeExRVUZzUXl4RFFVUnJRaXhEUVVOMVFqdEJRVU14UXl4WFFVWkVMRTFCUlU4N1FVRkRUQ3h0UWtGQlQyOUtMRmRCUVZjNVNDeEhRVUZZTEVOQlFXVTRTQ3hYUVVGWFRTeEpRVUV4UWl4RFFVRlFMRU5CUkVzc1EwRkRiVU03UVVGRGVrTTdRVUZEUmp0QlFVTkdMRTlCZWtKRUxFMUJlVUpQTzBGQlEwdzdRVUZEUVM5SkxHZENRVUZSWjBRc1IwRkJVaXhEUVVGWkxITkRRVUZ6UTJwQ0xFMUJRVTFETEZGQlFUVkRMRWRCUVhWRUxGZEJRWFpFTEVkQlFYRkZaU3hKUVVGSldTeEpRVUZLTEVOQlFWTnZReXhQUVVFNVJTeEhRVUYzUml4SFFVRndSenRCUVVORU8wRkJRMFk3TzBGQlJVUTdPenM3YjBOQlEyZENhRVFzUnl4RlFVRkxPMEZCUTI1Q0xGVkJRVWxvUWl4UlFVRlJMRWxCUVZvN1FVRkRRUzlDTEdOQlFWRm5SQ3hIUVVGU0xFTkJRVmtzYlVKQlFWb3NSVUZCYVVOcVFpeE5RVUZOZVVJc1RVRkJka01zUlVGQkswTlVMRWRCUVM5RE96dEJRVVZCTEZWQlFVbFNMRlZCUVZWUkxFbEJRVWxaTEVsQlFVb3NRMEZCVTBNc1VVRkJka0k3UVVGRFFTeFZRVUZKYzBRc1YwRkJWMjVHTEUxQlFVMVZMR2RDUVVGT0xFTkJRWFZDUml4UFFVRjJRaXhEUVVGbU96dEJRVVZCTEZWQlFVa3lSU3hSUVVGS0xFVkJRV003UVVGRFdtNUdMR05CUVUxclFpeGhRVUZPTEVOQlFXOUNhVVVzVTBGQlUyaEdMRkZCUVRkQ0xFVkJRWFZEWVN4SFFVRjJRenRCUVVORUxFOUJSa1FzVFVGRlR6dEJRVU5NTDBNc1owSkJRVkZuUkN4SFFVRlNMRU5CUVZrc2VVSkJRVm9zUlVGQmRVTlVMRTlCUVhaRE8wRkJRMFE3UVVGRFJqczdPM2RDUVM5T1V6dEJRVUZGTEdGQlFVOHNTMEZCUzA4c1NVRkJXanRCUVVGdFFqczdRVUZGTDBJN096czdPenM3ZDBKQlNXRTdRVUZCUlN4aFFVRlBMRXRCUVV0cFF5eFBRVUZhTzBGQlFYTkNPenRCUVVWeVF6czdPenM3T3p0M1FrRkpZVHRCUVVGRkxHRkJRVThzUzBGQlMzZENMRTlCUVZvN1FVRkJjMEk3TzBGQlJYSkRPenM3T3pzN08zZENRVWxYTzBGQlFVVXNZVUZCVHl4TFFVRkxja1VzVVVGQlRDeERRVUZqU2l4SlFVRnlRanRCUVVFMFFqczdRVUZGZWtNN096czdPenM3ZDBKQlNXZENPMEZCUVVVc1lVRkJUeXhMUVVGTFZ5eG5Ra0ZCV2p0QlFVRXJRanM3TzB0Qk5VbHVSRHM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN2EwSkJkVlpsTmtRc1ZUczdPenM3T3pzN096czdPenM3T3pzN096czdPenRCUTJoVlpqczdPenM3TzBGQlJVRTdPenM3U1VGSlRTdERMR1VzUTBGQlowSXNNa0k3UVVGRGNFSTdPenM3TzBGQlRVRTdPenM3UVVGSlFTd3lRa0ZCV1VNc1RVRkJXaXhGUVVGdlFpOUhMRTlCUVhCQ0xFVkJRVFpDWWl4WFFVRTNRaXhGUVVFd1F6WklMRXRCUVRGRExFVkJRV2xFYUVNc1MwRkJha1FzUlVGQmQwUTdRVUZCUVRzN1FVRkRkRVFzVVVGQlNYaEdMRkZCUVZFc1NVRkJXanM3UVVGRlFVRXNWVUZCVFhsSUxFOUJRVTRzUjBGQlowSkdMRTFCUVdoQ08wRkJRMEYyU0N4VlFVRk5NRVVzVVVGQlRpeEhRVUZwUW14RkxFOUJRV3BDTzBGQlEwRlNMRlZCUVUxNVFpeE5RVUZPTEVkQlFXVXJSaXhMUVVGbU8wRkJRMEY0U0N4VlFVRk5NRWdzVFVGQlRpeEhRVUZsYkVNc1MwRkJaanM3UVVGRlFYaEdMRlZCUVUxSExGRkJRVTRzUjBGQmFVSXNNRUpCUVdWU0xGZEJRV1lzUTBGQmFrSTdPMEZCUlVGTExGVkJRVTFoTEVsQlFVNHNSMEZCWVRCSExFOUJRVTh4Unl4SlFVRndRanRCUVVOQllpeFZRVUZOVnl4clFrRkJUanRCUVVORU96czdPM2xEUVVWdlFqdEJRVU51UWl4VlFVRkpXQ3hSUVVGUkxFbEJRVm83TzBGQlJVRTdRVUZEUVN4VlFVRkpRU3hOUVVGTmVVSXNUVUZCVml4RlFVRnJRanRCUVVOb1FucENMR05CUVUweVNDeFRRVUZPTEVkQlFXdENNMGdzVFVGQlRXRXNTVUZCVGl4RFFVRlhReXhYUVVGWUxFTkJRWFZDWkN4TlFVRk5lVUlzVFVGQk4wSXNSVUZCY1VNc1ZVRkJRMVFzUjBGQlJDeEZRVUZUTzBGQlF6bEVMR05CUVVsQkxFbEJRVWxzUkN4SlFVRktMRXRCUVdFc1ZVRkJZaXhKUVVFeVFtdEVMRWxCUVVrclF5eEZRVUZLTEV0QlFWY3ZSQ3hOUVVGTk1FZ3NUVUZCYUVRc1JVRkJkMFE3UVVGRGRFUjZTaXh2UWtGQlVXZEVMRWRCUVZJc1EwRkJXU3cyUWtGQldpeEZRVUV5UTBRc1IwRkJNME03UVVGRFFXaENMR3RDUVVGTk1rTXNWMEZCVGl4RFFVRnJRak5DTEVkQlFXeENPMEZCUTBRN1FVRkRSaXhUUVV4cFFpeERRVUZzUWp0QlFVMUVPMEZCUTBZN096dDNRMEZGYlVJN1FVRkRiRUlzVlVGQlNXaENMRkZCUVZFc1NVRkJXanM3UVVGRlFTeFZRVUZKUVN4TlFVRk5Na2dzVTBGQlZpeEZRVUZ4UWp0QlFVTnVRak5JTEdOQlFVMHlTQ3hUUVVGT0xFTkJRV2RDZUVjc1RVRkJhRUk3UVVGRFJEdEJRVU5HT3p0QlFVVkVPenM3T3pzN09FSkJSMU03UVVGRFVDeFZRVUZKYmtJc1VVRkJVU3hKUVVGYU96dEJRVVZCTEdGQlFVOUJMRTFCUVUxNVNDeFBRVUZPTEVOQlFXTkhMRk5CUVdRc1EwRkJkMEkxU0N4TlFVRk5NRVVzVVVGQk9VSXNRMEZCVURzN1FVRkZRVEZGTEZsQlFVMXZRaXhwUWtGQlRqczdRVUZGUVR0QlFVTkVPenRCUVVWRU96czdPenM3T3pzN1FVRlpRVHM3T3pzMlFrRkpVMk1zVVN4RlFVRlZPMEZCUTJwQ0xGZEJRVXN2UWl4UlFVRk1MRU5CUVdORExFOUJRV1FzUTBGQmMwSXNWVUZCUTBNc1MwRkJSQ3hGUVVGWE8wRkJReTlDTmtJc2FVSkJRVk0zUWl4TFFVRlVPMEZCUTBRc1QwRkdSRHRCUVVkRU96dEJRVVZFT3pzN096czdPeXRDUVVsWE5rSXNVU3hGUVVGVk8wRkJRMjVDTEZkQlFVdHRRaXhyUWtGQlRDeEhRVUV3UW01Q0xGRkJRVEZDTzBGQlEwUTdPMEZCUlVRN096czdaME5CUTFsc1FpeEhMRVZCUVVzN1FVRkRaaXhWUVVGSmFFSXNVVUZCVVN4SlFVRmFPenRCUVVWQkxGVkJRVWxMTEZGQlFWRTdRVUZEVm5aRExHTkJRVTFyUkN4SlFVRkpiRVFzU1VGRVFUdEJRVVZXV0N4aFFVRkxOa1FzU1VGQlNWa3NTVUZCU2l4RFFVRlRhMFVzVFVGR1NqdEJRVWRXT1VRc1kwRkJUV2hDTEVsQlFVbFpMRWxCUVVvc1EwRkJVMGs3UVVGSVRDeFBRVUZhT3p0QlFVMUJMRlZCUVVsb1F5eE5RVUZOY1VRc2EwSkJRVllzUlVGQk9FSTdRVUZETlVKeVJDeGpRVUZOY1VRc2EwSkJRVTRzUTBGQmVVSm9SQ3hMUVVGNlFqdEJRVU5FTzBGQlEwWTdPenQzUWtGMlEyRTdRVUZCUlN4aFFVRlBMRXRCUVV0eFJTeFJRVUZhTzBGQlFYVkNPenRCUVVWMlF6czdPenM3T3p0M1FrRkpWenRCUVVGRkxHRkJRVThzUzBGQlMzWkZMRkZCUVV3c1EwRkJZMG9zU1VGQmNrSTdRVUZCTkVJN096dExRVzVITTBNN096czdPenM3T3pzN096czdPenM3T3pzN096czdPMnRDUVhkSlpYVklMR1U3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN08wRkRlRWxtT3pzN08wRkJSVUVzU1VGQlRVOHNZVUZCWVN4RlFVRkRha0lzVDBGQlR5eG5Ra0ZCVWl4RlFVRXdRbFFzVVVGQlVTeHBRa0ZCYkVNc1JVRkJia0k3TzBGQlJVRTdPenM3T3p0SlFVdE5Na0lzVlR0QlFVVktMSE5DUVVGWmJra3NWMEZCV2l4RlFVRjVRanRCUVVGQk96dEJRVU4yUWl4UlFVRkpTeXhSUVVGUkxFbEJRVm83TzBGQlJVRkJMRlZCUVUxelFpeFZRVUZPTEVkQlFXMUNMRVZCUVc1Q08wRkJRMEYwUWl4VlFVRk5SU3hSUVVGT0xFZEJRV2xDTEVWQlFXcENPenRCUVVWQkxGTkJRVXMyU0N4TFFVRk1MRWRCUVdGd1NTeGxRVUZsTEVWQlFUVkNPenRCUVVWQkxGTkJRVXR4U1N4blFrRkJUQ3hEUVVGelFpeExRVUZMUkN4TFFVRXpRanRCUVVORU96czdPelJDUVVsUE4wWXNVU3hGUVVGVk8wRkJRMmhDTEZkQlFVdGFMRlZCUVV3c1EwRkJaMEkwUkN4SlFVRm9RaXhEUVVGeFFtaEVMRkZCUVhKQ08wRkJRMFE3T3p0NVFrRkZTWGxFTEVrc1JVRkJUVHRCUVVOVUxGVkJRVWx6UXl4UFFVRlBkRU1zUzBGQlMyaEpMRXRCUVV3c1EwRkJWeXhIUVVGWUxFTkJRVmc3TzBGQlJVRXNZVUZCVHl4TFFVRkxkVXNzWTBGQlRDeERRVUZ2UWtRc1NVRkJjRUlzUTBGQlVEdEJRVU5FT3pzN0swSkJSVlYwUXl4SkxFVkJRVTA3UVVGRFppeFZRVUZKT1Vnc1UwRkJVeXhGUVVGaU8wRkJRMEVzVlVGQlNXOUxMRTlCUVU5MFF5eExRVUZMYUVrc1MwRkJUQ3hEUVVGWExFZEJRVmdzUTBGQldEdEJRVU5CUlN4aFFVRlBiVW9zU1VGQlVDeEhRVUZqYVVJc1MwRkJTMFVzUjBGQlRDeEZRVUZrTzBGQlEwRjBTeXhoUVVGUFpTeEhRVUZRTEVkQlFXRXNTMEZCUzNOS0xHTkJRVXdzUTBGQmIwSkVMRWxCUVhCQ0xFTkJRV0k3TzBGQlJVRXNZVUZCVDNCTExFMUJRVkE3UVVGRFJEczdPMjFEUVVWamIwc3NTU3hGUVVGTk8wRkJRMjVDTEZWQlFVbHlTaXhOUVVGTkxFdEJRVXR0U2l4TFFVRm1PMEZCUTBGRkxGZEJRVXN4U0N4UFFVRk1MRU5CUVdFc1ZVRkJRMnBFTEV0QlFVUXNSVUZCVnp0QlFVTjBRbk5DTEdOQlFVMUJMRWxCUVVsMFFpeExRVUZLTEVOQlFVNDdRVUZEUkN4UFFVWkVPenRCUVVsQkxHRkJRVTl6UWl4SFFVRlFPMEZCUTBRN096dHhRMEZGWjBKRUxFMHNSVUZCVVR0QlFVRkJPenRCUVVWMlFpeFZRVUZKZVVvc1ZVRkJWU3hUUVVGV1FTeFBRVUZWTEVOQlFVTkRMRk5CUVVRc1JVRkJaVHM3UVVGRk0wSkJMR3RDUVVGVlF5eExRVUZXTEVOQlFXZENMRlZCUVVORExFMUJRVVFzUlVGQldUdEJRVU14UWl4cFFrRkJTME1zVlVGQlRDeERRVUZuUWtRc1RVRkJhRUk3UVVGRFJDeFRRVVpFTzBGQlNVUXNUMEZPUkRzN1FVRlJRU3hYUVVGTFVpeExRVUZNTEVkQlFXRlZMRTlCUVU5RExGZEJRVkFzUTBGQmJVSXZTaXhOUVVGdVFpeEZRVUV5UW5sS0xFOUJRVE5DTEVOQlFXSTdRVUZGUkRzN095dENRVVZWTDBnc1N5eEZRVUZQTzBGQlEyaENMRmRCUVV0cFFpeFZRVUZNTEVOQlFXZENaaXhQUVVGb1FpeERRVUYzUWl4VlFVRkRNa0lzVVVGQlJDeEZRVUZqTzBGQlEzQkRRU3hwUWtGQlV6ZENMRXRCUVZRN1FVRkRSQ3hQUVVaRU8wRkJSMFE3T3pzclFrRkZWV3RKTEUwc1JVRkJVVHM3UVVGRmFrSXNWVUZCU1ROS0xFMUJRVTB5U2l4UFFVRlBOVW9zVFVGQmFrSTdRVUZEUVN4VlFVRkpaMHNzWjBKQlFVbzdPMEZCUlVFc1ZVRkJTUzlLTEVsQlFVbG5TeXhYUVVGS0xFdEJRVzlDU0N4TlFVRjRRaXhGUVVGblF6dEJRVU01UWtVc2EwSkJRVlZGTEZkQlFWY3hReXhOUVVGeVFqdEJRVU5FT3p0QlFVVkVMRlZCUVVsMlNDeEpRVUZKWjBzc1YwRkJTaXhMUVVGdlFqTkNMRXRCUVhoQ0xFVkJRU3RDTzBGQlF6ZENNRUlzYTBKQlFWVkZMRmRCUVZkcVF5eExRVUZ5UWp0QlFVTkVPenRCUVVWRUxGVkJRVWxyUXl4alFVRmpVQ3hQUVVGUFVTeFBRVUY2UWpzN1FVRkZRVHRCUVVOQk96dEJRVVZCTzBGQlEwRXNWVUZCU1VNc1YwRkJWM0JMTEVsQlFVa3lTaXhQUVVGUFZTeEpRVUZZTEVOQlFXWTdPMEZCUlVFN08wRkJSVUVzVlVGQlNWWXNUMEZCVDNwTExFbEJRVkFzUzBGQlowSXNVVUZCYUVJc1NVRkJORUlzUTBGQlEyZE1MRmxCUVZsc1RDeFJRVUZhTEVOQlFYRkNMRk5CUVhKQ0xFTkJRV3BETEVWQlFXdEZPMEZCUTJoRkxHRkJRVXR6VEN4VlFVRk1MRU5CUVdkQ08wRkJRMlE1UXl4cFFrRkJUeXRETEZkQlFWYzFReXhOUVVSS08wRkJSV1JNTEdsQ1FVRlBlVU1zVDBGR1R6dEJRVWRrY2tjc2FVSkJRVTkzUnl4WFFVaFBPMEZCU1dRdlNTeG5Ra0ZCVFdsS08wRkJTbEVzVTBGQmFFSTdRVUZOUkRzN1FVRkZSQ3hWUVVGSlZDeFBRVUZQZWtzc1NVRkJVQ3hMUVVGblFpeExRVUZ3UWl4RlFVRXlRanRCUVVONlFpeGhRVUZMYjB3c1ZVRkJUQ3hEUVVGblFqdEJRVU5rT1VNc2FVSkJRVThyUXl4WFFVRlhkRU1zUjBGRVNqdEJRVVZrV0N4cFFrRkJUM2xETEU5QlJrODdRVUZIWkhKSExHbENRVUZQZDBjc1YwRklUenRCUVVsa0wwa3NaMEpCUVUxcFNqdEJRVXBSTEZOQlFXaENPMEZCVFVRN08wRkJSVVFzVlVGQlNWUXNUMEZCVDNwTExFbEJRVkFzUzBGQlowSXNVVUZCY0VJc1JVRkJPRUk3UVVGRE5VSXNZVUZCUzI5TUxGVkJRVXdzUTBGQlowSTdRVUZEWkRsRExHbENRVUZQSzBNc1YwRkJWemxETEUxQlJFbzdRVUZGWkVnc2FVSkJRVTk1UXl4UFFVWlBPMEZCUjJSeVJ5eHBRa0ZCVDNkSE8wRkJTRThzVTBGQmFFSTdRVUZMUkR0QlFVTkdPenM3ZDBKQmJFZFZPMEZCUVVVc1lVRkJUeXhMUVVGTFppeExRVUZhTzBGQlFXOUNPenM3T3p0QlFYTkhOVUlzU1VGQlNXOUNMR3REUVVGaExFVkJRVU0xUXl4UlFVRlJMRkZCUVZRc1JVRkJiVUpOTEV0QlFVc3NTMEZCZUVJc1JVRkJLMEpTTEZGQlFWRXNVVUZCZGtNc1JVRkJha0k3UVVGRFFTeEpRVUZKZDBNc2EwTkJRV0VzUlVGQlF6RkRMRkZCUVZFc1VVRkJWQ3hGUVVGdFFsTXNUMEZCVHl4UFFVRXhRaXhGUVVGcVFqdHJRa0ZEVVd0Q0xGVTdPenM3T3pzN1FVTTVTR1k3TzBGQlJVRTdPMEZCUlVFN08wRkJSVUU3TzBGQlJVRTdPMEZCUlVFN08wRkJSVUVzYzBOQlFYTkRMSFZEUVVGMVF5eG5Ra0ZCWjBJN08wRkJSVGRHTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVN4TFFVRkxPMEZCUTB3N1FVRkRRVHRCUVVOQkxFZEJRVWM3UVVGRFNEdEJRVU5CTEVkQlFVYzdRVUZEU0RzN1FVRkZRVHRCUVVOQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenRCUTJSQk96czdPMEZCUTBFN096czdRVUZEUVRzN096czdPMEZCUlVFN096czdPMGxCUzAxelFpeFBPMEZCUTBvN096czdPenM3T3pzN096dEJRV1ZCT3pzN096czdRVUZOUVN4dFFrRkJXVFZDTEV0QlFWb3NSVUZCYlVJMlFpeEhRVUZ1UWl4RlFVRjNRa01zVFVGQmVFSXNSVUZCWjBNN1FVRkJRVHM3UVVGRE9VSXNVVUZCU1hSS0xGRkJRVkVzU1VGQldqczdRVUZGUVVFc1ZVRkJUWGxDTEUxQlFVNHNSMEZCWlN0R0xFdEJRV1k3UVVGRFFYaElMRlZCUVUxaExFbEJRVTRzUjBGQllYZEpMRWRCUVdJN08wRkJSVUZ5U2l4VlFVRk5Na0lzVDBGQlRpeEhRVUZuUWpKSUxFOUJRVTlETEZWQlFWQXNSMEZCYjBJc1MwRkJjRU03TzBGQlJVRjJTaXhWUVVGTmJVUXNWVUZCVGl4SFFVRnRRaXhGUVVGdVFqdEJRVU5CYmtRc1ZVRkJUWE5DTEZWQlFVNHNSMEZCYlVJc1JVRkJia0k3UVVGRFFYUkNMRlZCUVUxM1NpeGhRVUZPTEVkQlFYTkNMRVZCUVhSQ096dEJRVVZCU0N4UlFVRkpka2tzVjBGQlNpeERRVUZuUWpCSExFdEJRV2hDTEVWQlFYVkNMRlZCUVVONFJ5eEhRVUZFTEVWQlFWTTdRVUZET1VJN1FVRkRRU3hWUVVGSlFTeEpRVUZKVVN4SlFVRktMRXRCUVdGblJ5eExRVUZxUWl4RlFVRjNRanRCUVVOMFFuWktMR2RDUVVGUmQwd3NTVUZCVWl4RFFVRmhMSGxDUVVGaUxFVkJRWGREZWtrc1IwRkJlRU03UVVGRFFTeG5Ra0ZCVVVFc1NVRkJTV3hFTEVsQlFWbzdRVUZEUlN4bFFVRkxMRk5CUVV3N1FVRkJaMEpyUXl4clFrRkJUVEJLTEZWQlFVNHNRMEZCYVVJeFNTeEhRVUZxUWl4RlFVRjFRanRCUVVOMlF5eGxRVUZMTEZGQlFVdzdRVUZCWldoQ0xHdENRVUZOTWtvc1pVRkJUaXhEUVVGelFqTkpMRWRCUVhSQ0xFVkJRVFJDTzBGQlF6TkRMR1ZCUVVzc1VVRkJURHRCUVVGbGFFSXNhMEpCUVUwMFNpeGxRVUZPTEVOQlFYTkNOVWtzUjBGQmRFSXNSVUZCTkVJN1FVRklOME03UVVGTFJEdEJRVU5HTEV0QlZrUTdRVUZYUkRzN1FVRkZSRHM3T3pzN096czdPenRCUVd0Q1FUczdPenM3T3pzN096c3lRa0ZWVDNaQ0xFMHNSVUZCVVc5RUxGTXNSVUZCVjJ4RUxGY3NSVUZCYlVRN1FVRkJRU3hWUVVGMFEydExMRXRCUVhORExIVkZRVUU1UWl4TFFVRTRRanRCUVVGQkxGVkJRWFpDUXl4SFFVRjFRaXgxUlVGQmFrSXNTMEZCYVVJN1FVRkJRU3hWUVVGV09Vd3NVVUZCVlRzN1FVRkRNMFVzVlVGQlNXZERMRkZCUVZFc1NVRkJXanRCUVVOQkxGVkJRVWtyU2l4WFFVRlhMRVZCUVdZN08wRkJSVUZCTEdWQlFWTkVMRWRCUVZRc1IwRkJaVUVzUjBGQlpqdEJRVU5CUXl4bFFVRlRSaXhMUVVGVUxFZEJRV2xDUVN4TFFVRnFRanRCUVVOQlJTeGxRVUZUZEVzc1RVRkJWQ3hIUVVGclFrRXNUVUZCYkVJN1FVRkRRWE5MTEdWQlFWTnNTQ3hUUVVGVUxFZEJRWEZDUVN4VFFVRnlRanRCUVVOQmEwZ3NaVUZCVTNCTExGZEJRVlFzUjBGQmRVSkJMRmRCUVhaQ096dEJRVVZCTEZWQlFVa3pRaXhSUVVGS0xFVkJRVzFDTzBGQlFVVXJUQ3hwUWtGQlV5OU1MRkZCUVZRc1IwRkJiMEpCTEZGQlFYQkNPMEZCUVN0Q096dEJRVVZ3UkVNc1kwRkJVV2RFTEVkQlFWSXNRMEZCV1N4dFJFRkJXaXhGUVVGcFJUaEpMRkZCUVdwRk96dEJRVVZCTERSQ1FVRmpRU3hSUVVGa0xFVkJRWGRDTEVWQlFVTm9TQ3hSUVVGUkxFdEJRVlFzUlVGQmVFSTdPMEZCUlVFc1lVRkJUeTlETEUxQlFVMW5TeXhQUVVGT0xFTkJRV05FTEZGQlFXUXNRMEZCVUR0QlFVTkVPenM3YjBOQlJXVkJMRkVzUlVGQlZUdEJRVU40UWl4VlFVRkpMMG9zVVVGQlVTeEpRVUZhTzBGQlEwRXZRaXhqUVVGUlowUXNSMEZCVWl4RFFVRlpMRzFFUVVGYUxFVkJRV2xGT0Vrc1VVRkJha1U3TzBGQlJVRXNORUpCUVdOQkxGRkJRV1FzUlVGQmQwSXNSVUZCUTJoSUxGRkJRVkVzU1VGQlZDeEZRVUY0UWpzN1FVRkZRU3hoUVVGUEwwTXNUVUZCVFdkTExFOUJRVTRzUTBGQlkwUXNVVUZCWkN4RFFVRlFPMEZCUTBRN08wRkJSVVE3T3pzN096czdPenM3T3pzN09FSkJWVlYwU3l4TkxFVkJRVkYzU3l4TkxFVkJRVFpFTzBGQlFVRXNWVUZCY2tSS0xFdEJRWEZFTEhWRlFVRTNReXhMUVVFMlF6dEJRVUZCTEZWQlFYUkRReXhIUVVGelF5eDFSVUZCYUVNc1MwRkJaME03UVVGQlFTeFZRVUY2UW1oTExFMUJRWGxDTEhWRlFVRm9RaXhKUVVGblFqdEJRVUZCTEZWQlFWWTVRaXhSUVVGVk96dEJRVU0zUlN4VlFVRkpaME1zVVVGQlVTeEpRVUZhTzBGQlEwRXNWVUZCU1N0S0xGZEJRVmNzUlVGQlpqczdRVUZGUVVFc1pVRkJVMFFzUjBGQlZDeEhRVUZsUVN4SFFVRm1PMEZCUTBGRExHVkJRVk5HTEV0QlFWUXNSMEZCYVVKQkxFdEJRV3BDTzBGQlEwRkZMR1ZCUVZOMFN5eE5RVUZVTEVkQlFXdENRU3hOUVVGc1FqczdRVUZGUVhOTExHVkJRVk5zU1N4UlFVRlVMRWRCUVc5Q2Iwa3NUVUZCY0VJN1FVRkRRU3hWUVVGSmFrMHNVVUZCU2l4RlFVRnRRanRCUVVGRkswd3NhVUpCUVZNdlRDeFJRVUZVTEVkQlFXOUNRU3hSUVVGd1FqdEJRVUVyUWpzN1FVRkZjRVE3UVVGRFFTdE1MR1ZCUVZOcVN5eE5RVUZVTEVkQlFXdENRU3hOUVVGc1FqczdRVUZGUVRkQ0xHTkJRVkZuUkN4SFFVRlNMRU5CUVZrc09FTkJRVm9zUlVGQk5FUTRTU3hSUVVFMVJEczdRVUZGUVN3MFFrRkJZMEVzVVVGQlpDeEZRVUYzUWl4RlFVRkRhRWdzVVVGQlVTeExRVUZVTEVWQlFYaENPenRCUVVWQkxHRkJRVTh2UXl4TlFVRk5hMHNzVlVGQlRpeERRVUZwUWtnc1VVRkJha0lzUTBGQlVEdEJRVU5FT3p0QlFVVkVPenM3T3pzN096dHZRMEZMWjBKQkxGRXNSVUZCVlR0QlFVTjRRaXhWUVVGSkwwb3NVVUZCVVN4SlFVRmFPMEZCUTBFc1ZVRkJTVzFMTEZsQlFWbEtMRmxCUVZrc1JVRkJOVUk3TzBGQlJVRXNORUpCUVdOSkxGTkJRV1FzUlVGQmVVSXNSVUZCUTNCSUxGRkJRVkVzU1VGQlZDeEZRVUY2UWpzN1FVRkZRU3hoUVVGUEwwTXNUVUZCVFd0TExGVkJRVTRzUTBGQmFVSkRMRk5CUVdwQ0xFTkJRVkE3UVVGRFJEczdRVUZGUkRzN096czdPenM3ZVVKQlMwdEdMRTBzUlVGQlVUdEJRVU5ZTEZWQlFVbHFTeXhSUVVGUkxFbEJRVm83TzBGQlJVRTdRVUZEUVR0QlFVTkJMRlZCUVVsdlN5eFZRVUZWTzBGQlExcDBUU3hqUVVGTkxFMUJSRTBzUlVGRFJUQkVMRTFCUVUxNFFpeE5RVUZOZVVJc1RVRkVaQ3hGUVVOelFrTXNTVUZCU1hWSk8wRkJSREZDTEU5QlFXUTdPMEZCU1VFc1lVRkJUeXh6UWtGQldTeFZRVUZETVVVc1QwRkJSQ3hGUVVGVmJrSXNUVUZCVml4RlFVRnhRanRCUVVOMFEzQkZMR05CUVUxaExFbEJRVTRzUTBGQlYybENMRmRCUVZnc1EwRkJkVUp6U1N4UFFVRjJRaXhGUVVGblF5eFZRVUZEY2trc1MwRkJSQ3hGUVVGWE8wRkJRM3BET1VRc2EwSkJRVkZuUkN4SFFVRlNMRU5CUVZrc2FVSkJRVm9zUlVGQkswSmpMRXRCUVM5Q08wRkJRMEVzWTBGQlNVRXNUVUZCVFVnc1NVRkJUaXhEUVVGWFNTeEpRVUZZTEV0QlFXOUNMRWRCUVhoQ0xFVkJRVFpDTzBGQlF6TkNkVVFzYjBKQlFWRjRSQ3hOUVVGTlNDeEpRVUZPTEVOQlFWZDBSU3hMUVVGdVFqdEJRVU5FTEZkQlJrUXNUVUZGVHp0QlFVTk1PRWNzYlVKQlFVOXlReXhOUVVGTlNDeEpRVUZPTEVOQlFWY3dReXhKUVVGc1FqdEJRVU5FTzBGQlEwWXNVMEZRUkR0QlFWRkVMRTlCVkUwc1EwRkJVRHRCUVZWRU96dEJRVVZFT3pzN096czdPenR0UTBGTFpYQkRMRkVzUlVGQlZUdEJRVU4yUWl4WFFVRkxiVWtzYzBKQlFVd3NSMEZCT0VKdVNTeFJRVUU1UWp0QlFVTkVPenM3TkVKQlJVODJTQ3hSTEVWQlFWVTdRVUZEYUVJc1ZVRkJTUzlLTEZGQlFWRXNTVUZCV2pzN1FVRkZRU3hoUVVGUExITkNRVUZaTEZWQlFVTjFSaXhQUVVGRUxFVkJRVlZ1UWl4TlFVRldMRVZCUVhGQ08wRkJRM1JETEZsQlFVbHlRaXhUUVVGVFowZ3NVMEZCVTJoSUxFMUJRWFJDTzBGQlEwRXNXVUZCU1hCRUxHTkJRV052U3l4VFFVRlRjRXNzVjBGQlZDeEpRVUYzUWl4RlFVRXhRenRCUVVOQkxGbEJRVWxHTEdWQlFVbzdPMEZCUlVFN1FVRkRRU3haUVVGSk5rWXNZVUZCWVR0QlFVTm1lRWdzWjBKQlFVMHNVVUZFVXl4RlFVTkRNRVFzVFVGQlRYaENMRTFCUVUxNVFpeE5RVVJpTEVWQlEzRkNReXhKUVVGSk1VSXNUVUZCVFRKQ0xFOUJSQzlDTzBGQlJXWkRMR2RDUVVGTkxFVkJRVVZ0UWl4UlFVRlJRU3hOUVVGV08wRkJSbE1zVTBGQmFrSTdPMEZCUzBFNVJTeG5Ra0ZCVVdkRUxFZEJRVklzUTBGQldTeHpRa0ZCV2l4RlFVRnZRemhKTEZGQlFYQkRMRVZCUVRoRGVrVXNWVUZCT1VNN08wRkJSVUZCTEcxQ1FVRlhNVVFzU1VGQldDeERRVUZuUW5SRkxFdEJRV2hDTEVkQlFYZENjVU1zVjBGQmVFSTdRVUZEUVRKR0xHMUNRVUZYTVVRc1NVRkJXQ3hEUVVGblFuUkZMRXRCUVdoQ0xFTkJRWE5DWjA0c1VVRkJkRUlzUjBGQmFVTjBTeXhOUVVGTmVVSXNUVUZCZGtNN08wRkJSVUVzV1VGQlNYTkpMRk5CUVZOMFN5eE5RVUZpTEVWQlFYRkNPMEZCUTI1Q1FTeHRRa0ZCVTNOTExGTkJRVk4wU3l4TlFVRnNRanRCUVVOQk5rWXNjVUpCUVZjeFJDeEpRVUZZTEVOQlFXZENia01zVFVGQmFFSXNSMEZCZVVKelN5eFRRVUZUZEVzc1RVRkJiRU03UVVGRFJEczdRVUZGUkN4WlFVRkpjMHNzVTBGQlUwUXNSMEZCWWl4RlFVRnJRbmhGTEZkQlFWY3hSQ3hKUVVGWUxFTkJRV2RDYTBrc1IwRkJhRUlzUjBGQmMwSkRMRk5CUVZORUxFZEJRUzlDTzBGQlEyeENMRmxCUVVsRExGTkJRVk5HTEV0QlFXSXNSVUZCYjBKMlJTeFhRVUZYTVVRc1NVRkJXQ3hEUVVGblFtbEpMRXRCUVdoQ0xFZEJRWGRDUlN4VFFVRlRSaXhMUVVGcVF6dEJRVU53UWl4WlFVRkpSU3hUUVVGVGJFZ3NVMEZCWWl4RlFVRjNRbmxETEZkQlFWY3hSQ3hKUVVGWUxFTkJRV2RDY1VJc1UwRkJhRUlzUjBGQk5FSTRSeXhUUVVGVGJFZ3NVMEZCY2tNN1FVRkRlRUlzV1VGQlNXdElMRk5CUVZNdlRDeFJRVUZpTEVWQlFYVkNjMGdzVjBGQlZ6RkVMRWxCUVZnc1EwRkJaMEkxUkN4UlFVRm9RaXhIUVVFeVFpdE1MRk5CUVZNdlRDeFJRVUZ3UXpzN1FVRkZka0lzV1VGQlNTdEZMRTFCUVVvc1JVRkJXVHRCUVVOV09VVXNhMEpCUVZGblJDeEhRVUZTTEVOQlFWa3NkVU5CUVZvc1JVRkJjVVJ4UlN4VlFVRnlSRHRCUVVORUxGTkJSa1FzVFVGRlR6dEJRVU5NY2tnc2EwSkJRVkZuUkN4SFFVRlNMRU5CUVZrc2RVTkJRVm9zUlVGQmNVUnhSU3hWUVVGeVJEdEJRVU5FT3p0QlFVVkVPMEZCUTBGMFJpeGpRVUZOWVN4SlFVRk9MRU5CUVZkcFFpeFhRVUZZTEVOQlFYVkNkMFFzVlVGQmRrSXNSVUZCYlVNc1ZVRkJRM1pFTEV0QlFVUXNSVUZCVnp0QlFVTTFRemxFTEd0Q1FVRlJaMFFzUjBGQlVpeERRVUZaTEhkRFFVRmFMRVZCUVhORVl5eExRVUYwUkR0QlFVTkJMR05CUVVsQkxFMUJRVTFJTEVsQlFVNHNRMEZCVjBrc1NVRkJXQ3hMUVVGdlFpeEhRVUY0UWl4RlFVRTJRanRCUVVNelFqdEJRVU5CTEdkQ1FVRkphVWtzVTBGQlUyeEpMRTFCUVUxSUxFbEJRVTRzUTBGQlYwTXNVVUZCZUVJN08wRkJSVUVzWjBKQlFVbHJRaXhOUVVGS0xFVkJRVms3UVVGRFZuUkVMSFZDUVVGVGMwTXNUVUZCVFVnc1NVRkJUaXhEUVVGWGJrTXNUVUZCY0VJN1FVRkRRVVVzTkVKQlFXTnZReXhOUVVGTlNDeEpRVUZPTEVOQlFWZDBSU3hMUVVGNlFqdEJRVU5FT3p0QlFVVkVMR2RDUVVGSmFVNHNVMEZCVXl4cFEwRkJkVUoyU3l4TFFVRjJRaXhGUVVFNFFtbExMRTFCUVRsQ0xFVkJRWE5EZUVzc1RVRkJkRU1zUlVGQk9FTXNTVUZCT1VNc1JVRkJiMFJGTEZkQlFYQkVMRVZCUVdsRmIwTXNUVUZCVFVnc1NVRkJUaXhEUVVGWE5Fa3NhVUpCUVRWRkxFTkJRV0k3UVVGRFFYaExMR3RDUVVGTmJVUXNWVUZCVGl4RFFVRnBRamhITEUxQlFXcENMRWxCUVRKQ1RTeE5RVUV6UWpzN1FVRkZRV2hHTEc5Q1FVRlJaMFlzVFVGQlVqdEJRVU5FTEZkQllrUXNUVUZoVHp0QlFVTk1PMEZCUTBGdVJ5eHRRa0ZCVDNKRExFMUJRVTFJTEVsQlFVNHNRMEZCVnpCRExFbEJRV3hDTzBGQlEwUTdRVUZEUml4VFFXNUNSRHRCUVc5Q1JDeFBRWEpFVFN4RFFVRlFPMEZCZFVSRU96czdLMEpCUlZWNVJpeFJMRVZCUVZVN1FVRkRia0lzVlVGQlNTOUtMRkZCUVZFc1NVRkJXanM3UVVGRlFTeGhRVUZQTEhOQ1FVRlpMRlZCUVVOMVJpeFBRVUZFTEVWQlFWVnVRaXhOUVVGV0xFVkJRWEZDT3p0QlFVVjBRenRCUVVOQkxGbEJRVWx4Unl4bFFVRmxPMEZCUTJwQ00wMHNaMEpCUVUwc1YwRkVWeXhGUVVORk1FUXNUVUZCVFhoQ0xFMUJRVTE1UWl4TlFVUmtMRVZCUTNOQ1F5eEpRVUZKTVVJc1RVRkJUVEpDTEU5QlJHaERPMEZCUldwQ1F5eG5Ra0ZCVFR0QlFVWlhMRk5CUVc1Q096dEJRVXRCTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRXNXVUZCU1cxSkxGRkJRVW9zUlVGQll6dEJRVU5hTEdOQlFVbEJMRk5CUVZNNVJpeGpRVUZVTEVOQlFYZENMRXRCUVhoQ0xFTkJRVW9zUlVGQmIwTjNSeXhoUVVGaE4wa3NTVUZCWWl4RFFVRnJRbXRKTEVkQlFXeENMRWRCUVhkQ1F5eFRRVUZUUkN4SFFVRnFRenRCUVVOd1F5eGpRVUZKUXl4VFFVRlRPVVlzWTBGQlZDeERRVUYzUWl4UFFVRjRRaXhEUVVGS0xFVkJRWE5EZDBjc1lVRkJZVGRKTEVsQlFXSXNRMEZCYTBKcFNTeExRVUZzUWl4SFFVRXdRa1VzVTBGQlUwWXNTMEZCYmtNN1FVRkRkRU1zWTBGQlNVVXNVMEZCVXpsR0xHTkJRVlFzUTBGQmQwSXNVVUZCZUVJc1EwRkJTaXhGUVVGMVEzZEhMR0ZCUVdFM1NTeEpRVUZpTEVOQlFXdENia01zVFVGQmJFSXNSMEZCTWtKelN5eFRRVUZUZEVzc1RVRkJjRU03UVVGRGRrTXNZMEZCU1hOTExGTkJRVk01Uml4alFVRlVMRU5CUVhkQ0xGVkJRWGhDTEVOQlFVb3NSVUZCZVVOM1J5eGhRVUZoTjBrc1NVRkJZaXhEUVVGclFqVkVMRkZCUVd4Q0xFZEJRVFpDSzB3c1UwRkJVeTlNTEZGQlFYUkRPMEZCUTNwRExHTkJRVWtyVEN4VFFVRlRPVVlzWTBGQlZDeERRVUYzUWl4VlFVRjRRaXhEUVVGS0xFVkJRWGxEZDBjc1lVRkJZVGRKTEVsQlFXSXNRMEZCYTBKRExGRkJRV3hDTEVkQlFUWkNhMGtzVTBGQlUyeEpMRkZCUVhSRE8wRkJRM3BETEdOQlFVbHJTU3hUUVVGVE9VWXNZMEZCVkN4RFFVRjNRaXhWUVVGNFFpeERRVUZLTEVWQlFYbERkMGNzWVVGQllUZEpMRWxCUVdJc1EwRkJhMEkxUkN4UlFVRnNRaXhIUVVFMlFpdE1MRk5CUVZNdlRDeFJRVUYwUXp0QlFVTXhRenM3UVVGRlJIbE5MSEZDUVVGaE4wa3NTVUZCWWl4RFFVRnJRbTFDTEUxQlFXeENMRWRCUVRKQ1owZ3NVMEZCVTJoSUxFMUJRWEJET3p0QlFVVkJPMEZCUTBFc1dVRkJTVzFDTEhWQ1FVRjFRalpHTEZOQlFWTnFTeXhOUVVGd1F6dEJRVU5CTEZsQlFVbHBTeXhUUVVGVE9VWXNZMEZCVkN4RFFVRjNRaXhSUVVGNFFpeERRVUZLTEVWQlFYVkRkMGNzWVVGQllUZEpMRWxCUVdJc1EwRkJhMEp6UXl4dlFrRkJiRUlzUjBGQmVVTkJMRzlDUVVGNlF6czdRVUZGZGtOcVJ5eG5Ra0ZCVVdkRUxFZEJRVklzUTBGQldTeHBRMEZCV2l4RlFVRXJRemhKTEZGQlFTOURMRVZCUVhsRVZTeFpRVUY2UkRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFYcExMR05CUVUxaExFbEJRVTRzUTBGQlYybENMRmRCUVZnc1EwRkJkVUl5U1N4WlFVRjJRaXhGUVVGeFF5eFZRVUZETVVrc1MwRkJSQ3hGUVVGWE8wRkJRemxET1VRc2EwSkJRVkZuUkN4SFFVRlNMRU5CUVZrc2EwTkJRVm9zUlVGQlowUmpMRXRCUVdoRU96dEJRVVZCTEdOQlFVbDBReXhUUVVGVGMwTXNUVUZCVFVnc1NVRkJUaXhEUVVGWGJrTXNUVUZCZUVJN1FVRkRRU3hqUVVGSmQwc3NVMEZCVTJ4SkxFMUJRVTFJTEVsQlFVNHNRMEZCVjBNc1VVRkJlRUk3TzBGQlJVRXNZMEZCU1RaSkxHbENRVUZwUWpGTExFMUJRVTEzU2l4aFFVRk9MRU5CUVc5Q1V5eE5RVUZ3UWl4RFFVRnlRanRCUVVOQkxHbENRVUZQYWtzc1RVRkJUWGRLTEdGQlFVNHNRMEZCYjBKVExFMUJRWEJDTEVOQlFWQTdRVUZEUVN4alFVRkpVeXhqUVVGS0xFVkJRVzlDUVN4bFFVRmxkRW9zYVVKQlFXWTdPMEZCUlhCQ0xHTkJRVWxYTEUxQlFVMUlMRWxCUVU0c1EwRkJWMGtzU1VGQldDeEhRVUZyUWl4SFFVRjBRaXhGUVVFeVFqdEJRVU42UWk5RUxHOUNRVUZSWjBRc1IwRkJVaXhEUVVGWkxHMURRVUZhTEVWQlFXbEVZeXhOUVVGTlNDeEpRVUZPTEVOQlFWYzBTU3hwUWtGQk5VUXNSVUZCSzBWUUxFMUJRUzlGTzBGQlEwRlRMRFpDUVVGcFFpdzRRa0ZCYjBJeFN5eE5RVUZOZVVJc1RVRkJNVUlzUlVGQmEwTjNTU3hOUVVGc1F5eEZRVUV3UTJwTExFMUJRVTFoTEVsQlFXaEVMRVZCUVhORWEwSXNUVUZCVFVnc1NVRkJUaXhEUVVGWE5Fa3NhVUpCUVdwRkxFTkJRV3BDTzBGQlEwRjRTeXhyUWtGQlRYZEtMR0ZCUVU0c1EwRkJiMEpUTEUxQlFYQkNMRWxCUVRoQ1V5eGpRVUU1UWp0QlFVTkVMRmRCU2tRc1RVRkpUeXhKUVVGSk0wa3NUVUZCVFVnc1NVRkJUaXhEUVVGWFNTeEpRVUZZTEV0QlFXOUNMRWRCUVhoQ0xFVkJRVFpDTzBGQlEyeERMMFFzYjBKQlFWRm5SQ3hIUVVGU0xFTkJRVmtzZDBOQlFWb3NSVUZCYzBSakxFdEJRWFJFTEVWQlFUWkVMMElzVFVGQlRYZEtMR0ZCUVc1Rk96dEJRVVZCTEdkQ1FVRkpOMG9zWTBGQlkyOURMRTFCUVUxSUxFbEJRVTRzUTBGQlYzUkZMRXRCUVRkQ08wRkJRMEVzWjBKQlFVa3NRMEZCUTNGRExGbEJRVmx6UlN4alFVRmFMRU5CUVRKQ0xGZEJRVE5DTEVOQlFVd3NSVUZCT0VNN1FVRkJSWFJGTERCQ1FVRlpReXhUUVVGYUxFZEJRWGRDTEVWQlFYaENPMEZCUVRaQ08wRkJRemRGTEdkQ1FVRkpMRU5CUVVORUxGbEJRVmx6UlN4alFVRmFMRU5CUVRKQ0xFMUJRVE5DTEVOQlFVd3NSVUZCZVVNN1FVRkJSWFJGTERCQ1FVRlpTU3hKUVVGYUxFZEJRVzFDTEVWQlFXNUNPMEZCUVhkQ096dEJRVVZ1UlR0QlFVTkJMR2RDUVVGSmQwc3NVMEZCVXl4cFEwRkJkVUoyU3l4TFFVRjJRaXhGUVVFNFFtbExMRTFCUVRsQ0xFVkJRWE5EZUVzc1RVRkJkRU1zUlVGQk9FTXNTVUZCT1VNc1JVRkJiMFJGTEZkQlFYQkVMRVZCUVdsRkswc3NaVUZCWlhaR0xGRkJRV2hHTEVWQlFUQkdjRVFzVFVGQlRVZ3NTVUZCVGl4RFFVRlhiME1zVDBGQmNrY3NSVUZCT0VkRkxHOUNRVUU1Unl4RFFVRmlPMEZCUTBGc1JTeHJRa0ZCVFhOQ0xGVkJRVTRzUTBGQmFVSXlTU3hOUVVGcVFpeEpRVUV5UWswc1RVRkJNMEk3TzBGQlJVRm9SaXh2UWtGQlVXZEdMRTFCUVZJN1FVRkRRVWNzTWtKQlFXVjBSQ3hMUVVGbUxFTkJRWEZDYlVRc1RVRkJja0k3UVVGRFJDeFhRV0pOTEUxQllVRTdRVUZEVEc1SExHMUNRVUZQY2tNc1RVRkJUVWdzU1VGQlRpeERRVUZYTUVNc1NVRkJiRUk3UVVGRFJEdEJRVU5HTEZOQk9VSkVPMEZCSzBKRUxFOUJia1ZOTEVOQlFWQTdRVUZ4UlVRN08wRkJSVVE3T3pzN0swSkJRMWQwUkN4SExFVkJRVXM3UVVGRFpDeFZRVUZKYUVJc1VVRkJVU3hKUVVGYU96dEJRVVZCTEZWQlFVbHpTeXhYUVVGWGRFc3NUVUZCVFcxRUxGVkJRVTRzUTBGQmFVSnVReXhKUVVGSldTeEpRVUZLTEVOQlFWTkdMRVZCUVRGQ0xFTkJRV1k3UVVGRFFUUkpMR1ZCUVZOYUxGVkJRVlFzUTBGQmIwSXhTU3hIUVVGd1FqdEJRVU5FT3p0QlFVVkVPenM3TzI5RFFVTm5Ra0VzUnl4RlFVRkxPMEZCUTI1Q0xGVkJRVWxvUWl4UlFVRlJMRWxCUVZvN08wRkJSVVE3UVVGRFF5eFZRVUZKTmtJc1YwRkJWMklzU1VGQlNWRXNTVUZCU2l4RFFVRlRiVW9zUzBGQlZDeERRVUZsTEVOQlFXWXNSVUZCYTBJc1EwRkJReXhGUVVGdVFpeERRVUZtT3p0QlFVVkJMRlZCUVVsMFN5eFJRVUZSTzBGQlExWjJReXhqUVVGTmEwUXNTVUZCU1d4RUxFbEJSRUU3UVVGRlZqQkVMR05CUVUxU0xFbEJRVWxaTEVsQlFVb3NRMEZCVTJ0RkxFMUJSa3c3UVVGSFZqTkpMR0ZCUVVzd1JTeFJRVWhMTzBGQlNWWndReXhuUWtGQlVYVkNMRWxCUVVsWkxFbEJRVW9zUTBGQlUyNURMRTFCU2xBN1FVRkxWbTVETEdWQlFVOHdSQ3hKUVVGSldTeEpRVUZLTEVOQlFWTjBSU3hMUVV4T08wRkJUVlpWTEd0Q1FVRlZaMFFzU1VGQlNWa3NTVUZCU2l4RFFVRlROVVFzVVVGT1ZEczdRVUZSVmpSTkxHRkJRVXNzWVVGQlF6bE5MRWxCUVVRc1JVRkJWVHRCUVVOaUxHTkJRVWtyVFN4UlFVRlJMRWRCUVZvN1FVRkRRU3hqUVVGSkwwMHNTVUZCU2l4RlFVRlZPMEZCUTFJclRTeHZRa0ZCVVM5TkxFbEJRVkk3UVVGRFJEczdRVUZGUmp0QlFVTkRhME1zWjBKQlFVMWhMRWxCUVU0c1EwRkJWMmxDTEZkQlFWZ3NRMEZCZFVJN1FVRkRja0pwUXl4blFrRkJTUzlETEVsQlFVa3JReXhGUVVSaExFVkJRMVJxUnl4TlFVRk5MRlZCUkVjc1JVRkRVekJFTEUxQlFVMVNMRWxCUVVsVkxFVkJSRzVDTEVWQlEzVkNRU3hKUVVGSlZpeEpRVUZKVVN4SlFVUXZRanRCUVVWeVFra3NhMEpCUVUwc1JVRkJSVWtzVFVGQlRUWkpMRXRCUVZJN1FVRkdaU3hYUVVGMlFqdEJRVWxFTzBGQmJrSlRMRTlCUVZvN08wRkJjMEpCTEZWQlFVazNTeXhOUVVGTmNVc3NjMEpCUVZZc1JVRkJhME03UVVGRGFFTndUU3huUWtGQlVYZE1MRWxCUVZJc1EwRkJZU3huUTBGQllpeEZRVUVyUTNCS0xFdEJRUzlETzBGQlEwRk1MR05CUVUxeFN5eHpRa0ZCVGl4RFFVRTJRbWhMTEV0QlFUZENPMEZCUTBRN1FVRkRSanM3UVVGRlJEczdPenR2UTBGRFowSlhMRWNzUlVGQlN6dEJRVU51UWl4VlFVRkphRUlzVVVGQlVTeEpRVUZhT3p0QlFVVkVPMEZCUTBNc1ZVRkJTVFpDTEZkQlFWZGlMRWxCUVVsWkxFbEJRVW9zUTBGQlUwTXNVVUZCZUVJN08wRkJSVUVzVlVGQlNXeEVMRk5CUVZOeFFpeE5RVUZOYzBJc1ZVRkJUaXhEUVVGcFFrOHNVVUZCYWtJc1EwRkJZanRCUVVOQkxGVkJRVWxzUkN4TlFVRktMRVZCUVZrN1FVRkRWaXhaUVVGSk1FSXNVVUZCVVR0QlFVTldka01zWjBKQlFVMXJSQ3hKUVVGSmJFUXNTVUZFUVR0QlFVVldXQ3hsUVVGTE1FVXNVVUZHU3p0QlFVZFdOMFFzYjBKQlFWVm5SQ3hKUVVGSldTeEpRVUZLTEVOQlFWTTFSQ3hSUVVoVU96dEJRVXRXTkUwc1pVRkJTeXhoUVVGRE9VMHNTVUZCUkN4RlFVRlZPMEZCUTJJc1owSkJRVWtyVFN4UlFVRlJMRWRCUVZvN1FVRkRRU3huUWtGQlNTOU5MRWxCUVVvc1JVRkJWVHRCUVVOU0swMHNjMEpCUVZFdlRTeEpRVUZTTzBGQlEwUTdPMEZCUlVZN1FVRkRReXhuUWtGQlNTdE5MRlZCUVZVc1IwRkJaQ3hGUVVGdFFqdEJRVU5xUW14TkxIRkNRVUZQYlUwc1RVRkJVRHRCUVVORU96dEJRVVZFTzBGQlEwRTVTeXhyUWtGQlRXRXNTVUZCVGl4RFFVRlhhVUlzVjBGQldDeERRVUYxUWp0QlFVTnlRbWxETEd0Q1FVRkpMME1zU1VGQlNTdERMRVZCUkdFc1JVRkRWR3BITEUxQlFVMHNWVUZFUnl4RlFVTlRNRVFzVFVGQlRWSXNTVUZCU1ZVc1JVRkVia0lzUlVGRGRVSkJMRWxCUVVsV0xFbEJRVWxSTEVsQlJDOUNPMEZCUlhKQ1NTeHZRa0ZCVFN4RlFVRkZTU3hOUVVGTk5ra3NTMEZCVWl4RlFVRmxMMFVzVVVGQlVUbEdMRTFCUVUxNVFpeE5RVUUzUWp0QlFVWmxMR0ZCUVhaQ08wRkJTVVE3UVVGeVFsTXNVMEZCV2pzN1FVRjNRa0VzV1VGQlNYcENMRTFCUVUxeFN5eHpRa0ZCVml4RlFVRnJRenRCUVVOb1EzQk5MR3RDUVVGUlowUXNSMEZCVWl4RFFVRlpMSE5DUVVGYUxFVkJRVzlEV2l4TFFVRndRenRCUVVOQlRDeG5Ra0ZCVFhGTExITkNRVUZPTEVOQlFUWkNhRXNzUzBGQk4wSTdRVUZEUkR0QlFVTkdMRTlCTjBKRUxFMUJOa0pQTzBGQlEweE1MR05CUVUxaExFbEJRVTRzUTBGQlYybENMRmRCUVZnc1EwRkJkVUk3UVVGRGNrSnBReXhqUVVGSkwwTXNTVUZCU1N0RExFVkJSR0VzUlVGRFZHcEhMRTFCUVUwc1ZVRkVSeXhGUVVOVE1FUXNUVUZCVFZJc1NVRkJTVlVzUlVGRWJrSXNSVUZEZFVKQkxFbEJRVWxXTEVsQlFVbFJMRWxCUkM5Q08wRkJSWEpDU1N4blFrRkJUU3hGUVVGRlNTeE5RVUZOTEVkQlFWSXNSVUZCWVRoRUxGRkJRVkU1Uml4TlFVRk5lVUlzVFVGQk0wSTdRVUZHWlN4VFFVRjJRanRCUVVsRU8wRkJRMFk3T3p0M1FrRm9WMWM3UVVGQlJTeGhRVUZQTEV0QlFVdEJMRTFCUVZvN1FVRkJjVUk3TzBGQlJXNURPenM3T3pzN08zZENRVWxuUWp0QlFVRkZMR0ZCUVU4c1MwRkJTekJDTEZWQlFWbzdRVUZCZVVJN08wRkJSVE5ET3pzN096czdPM2RDUVVsblFqdEJRVUZGTEdGQlFVOHNTMEZCU3pkQ0xGVkJRVm83UVVGQmVVSTdPenRMUVM5R04wTTdPenM3T3pzN096czdPenM3T3pzN096czdPenM3TzJ0Q1FYVmlaVGhJTEU4N096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3p0QlEzWmlaanM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN1FVRjFRa0U3T3pzN096czdPenM3TzBsQlYwMHlRaXhsTzBGQlEwbzdPenM3T3p0QlFVOUJMREpDUVVGWmRrUXNTMEZCV2l4RlFVRnRRbkpMTEVkQlFXNUNMRVZCUVhkQ2EwMHNSMEZCZUVJc1JVRkJOa0pzUlN4UlFVRTNRaXhGUVVGMVF6dEJRVUZCT3p0QlFVTnlReXhSUVVGSmJrWXNVVUZCVVN4SlFVRmFPenRCUVVWQlFTeFZRVUZOZVVJc1RVRkJUaXhIUVVGbEswWXNTMEZCWmp0QlFVTkJlRWdzVlVGQlRXVXNTVUZCVGl4SFFVRmhOVVFzUjBGQllqdEJRVU5CTmtNc1ZVRkJUV0VzU1VGQlRpeEhRVUZoZDBrc1IwRkJZanRCUVVOQmNrb3NWVUZCVFRSSUxGTkJRVTRzUjBGQmEwSjZReXhSUVVGc1FqczdRVUZGUVc1R0xGVkJRVTFuVEN4UlFVRk9MRWRCUVdsQ0xFVkJRV3BDTzBGQlEwRm9UQ3hWUVVGTlZ5eHJRa0ZCVGp0QlFVTkVPenM3TzNsRFFVVnZRanRCUVVOdVFpeFZRVUZKV0N4UlFVRlJMRWxCUVZvN08wRkJSVUZCTEZsQlFVMHlTQ3hUUVVGT0xFZEJRV3RDTTBnc1RVRkJUV0VzU1VGQlRpeERRVUZYUXl4WFFVRllMRU5CUVhWQ1pDeE5RVUZOWlN4SlFVRTNRaXhGUVVGdFF5eFZRVUZEUXl4SFFVRkVMRVZCUVZNN1FVRkROVVF2UXl4blFrRkJVV2RFTEVkQlFWSXNRMEZCV1N4eFFrRkJjVUpxUWl4TlFVRk5aU3hKUVVFelFpeEhRVUZyUXl4UlFVRTVReXhGUVVGM1JFTXNSMEZCZUVRN1FVRkRRV2hDTEdOQlFVMW5UQ3hSUVVGT0xFTkJRV1U1Uml4SlFVRm1MRU5CUVc5Q2JFVXNSMEZCY0VJN1FVRkRSQ3hQUVVocFFpeERRVUZzUWpzN1FVRkxRVHM3T3pzN096czdPenM3T3pzN08wRkJaMEpFT3pzN2QwTkJSVzFDTzBGQlEyeENMRlZCUVVsb1FpeFJRVUZSTEVsQlFWbzdPMEZCUlVGQkxGbEJRVTB5U0N4VFFVRk9MRU5CUVdkQ2VFY3NUVUZCYUVJN08wRkJSVUU3T3p0QlFVZEVPenM3TUVKQlNVczRTaXhSTEVWQlFWVTdRVUZEWkN4VlFVRkpha3dzVVVGQlVTeEpRVUZhTzBGQlEwRkJMRmxCUVUxblRDeFJRVUZPTEVOQlFXVjZTeXhQUVVGbUxFTkJRWFZDTEZWQlFVTm5TU3hOUVVGRUxFVkJRVms3UVVGRGFrTXdReXhwUWtGQlV5OUtMR0ZCUVZRc1EwRkJkVUlyU2l4VFFVRlRPVXNzVVVGQmFFTXNSVUZCTUVOdlNTeE5RVUV4UXp0QlFVTkVMRTlCUmtRN1FVRkhSRHM3TzNkQ1FWQmpPMEZCUVVVc1lVRkJUeXhMUVVGTFdDeFRRVUZhTzBGQlFYZENPenM3T3p0clFrRlZOVUp0UkN4bE96czdPenM3T3pzN1FVTndSMllzYTBKQlFXdENMSGxFT3pzN096czdPMEZEUVd4Q0xHdENRVUZyUWl4NVJEczdPenM3T3pzN096dEJRMEZzUWp0QlFVTkJMSE5FT3pzN096czdPMEZEUkVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEZPenM3T3pzN08wRkRTa0U3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxHdERRVUZyUXl4VlFVRlZMRVZCUVVVN1FVRkRPVU1zYlVKQlFXMUNMSE5EUVVGelF6dEJRVU42UkN4RFFVRkRMRzlEUVVGdlF6dEJRVU55UXp0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGdzUTBGQlF5eFhPenM3T3pzN096dEJRMmhEUkR0QlFVTkJPenRCUVVWQkxEQkRRVUV3UXl4cFEwRkJiME1zUlRzN096czdPenRCUTBnNVJUdEJRVU5CTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeERRVUZETEVVN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenRCUTFKRU96czdPMEZCUTBFN096czdRVUZEUVRzN096czdPMUZCUlZFelFpeFBPMUZCUVZNM1J5eHJRanRSUVVGdlFtaEVMR3RDSWl3aVptbHNaU0k2SWxONWJtTm9aWEl1YW5NaUxDSnpiM1Z5WTJWelEyOXVkR1Z1ZENJNld5SW9ablZ1WTNScGIyNGdkMlZpY0dGamExVnVhWFpsY25OaGJFMXZaSFZzWlVSbFptbHVhWFJwYjI0b2NtOXZkQ3dnWm1GamRHOXllU2tnZTF4dVhIUnBaaWgwZVhCbGIyWWdaWGh3YjNKMGN5QTlQVDBnSjI5aWFtVmpkQ2NnSmlZZ2RIbHdaVzltSUcxdlpIVnNaU0E5UFQwZ0oyOWlhbVZqZENjcFhHNWNkRngwYlc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtWVdOMGIzSjVLQ2s3WEc1Y2RHVnNjMlVnYVdZb2RIbHdaVzltSUdSbFptbHVaU0E5UFQwZ0oyWjFibU4wYVc5dUp5QW1KaUJrWldacGJtVXVZVzFrS1Z4dVhIUmNkR1JsWm1sdVpTaGNJbE41Ym1Ob1pYSmNJaXdnVzEwc0lHWmhZM1J2Y25rcE8xeHVYSFJsYkhObElHbG1LSFI1Y0dWdlppQmxlSEJ2Y25SeklEMDlQU0FuYjJKcVpXTjBKeWxjYmx4MFhIUmxlSEJ2Y25Selcxd2lVM2x1WTJobGNsd2lYU0E5SUdaaFkzUnZjbmtvS1R0Y2JseDBaV3h6WlZ4dVhIUmNkSEp2YjNSYlhDSmNJbDBnUFNCeWIyOTBXMXdpWENKZElIeDhJSHQ5TENCeWIyOTBXMXdpWENKZFcxd2lVM2x1WTJobGNsd2lYU0E5SUdaaFkzUnZjbmtvS1R0Y2JuMHBLSFJvYVhNc0lHWjFibU4wYVc5dUtDa2dlMXh1Y21WMGRYSnVJRnh1WEc1Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU0lDOHZYRzR2THlCM1pXSndZV05yTDNWdWFYWmxjbk5oYkUxdlpIVnNaVVJsWm1sdWFYUnBiMjRpTENJZ1hIUXZMeUJVYUdVZ2JXOWtkV3hsSUdOaFkyaGxYRzRnWEhSMllYSWdhVzV6ZEdGc2JHVmtUVzlrZFd4bGN5QTlJSHQ5TzF4dVhHNGdYSFF2THlCVWFHVWdjbVZ4ZFdseVpTQm1kVzVqZEdsdmJseHVJRngwWm5WdVkzUnBiMjRnWDE5M1pXSndZV05yWDNKbGNYVnBjbVZmWHlodGIyUjFiR1ZKWkNrZ2UxeHVYRzRnWEhSY2RDOHZJRU5vWldOcklHbG1JRzF2WkhWc1pTQnBjeUJwYmlCallXTm9aVnh1SUZ4MFhIUnBaaWhwYm5OMFlXeHNaV1JOYjJSMWJHVnpXMjF2WkhWc1pVbGtYU2xjYmlCY2RGeDBYSFJ5WlhSMWNtNGdhVzV6ZEdGc2JHVmtUVzlrZFd4bGMxdHRiMlIxYkdWSlpGMHVaWGh3YjNKMGN6dGNibHh1SUZ4MFhIUXZMeUJEY21WaGRHVWdZU0J1WlhjZ2JXOWtkV3hsSUNoaGJtUWdjSFYwSUdsMElHbHVkRzhnZEdobElHTmhZMmhsS1Z4dUlGeDBYSFIyWVhJZ2JXOWtkV3hsSUQwZ2FXNXpkR0ZzYkdWa1RXOWtkV3hsYzF0dGIyUjFiR1ZKWkYwZ1BTQjdYRzRnWEhSY2RGeDBhVG9nYlc5a2RXeGxTV1FzWEc0Z1hIUmNkRngwYkRvZ1ptRnNjMlVzWEc0Z1hIUmNkRngwWlhod2IzSjBjem9nZTMxY2JpQmNkRngwZlR0Y2JseHVJRngwWEhRdkx5QkZlR1ZqZFhSbElIUm9aU0J0YjJSMWJHVWdablZ1WTNScGIyNWNiaUJjZEZ4MGJXOWtkV3hsYzF0dGIyUjFiR1ZKWkYwdVkyRnNiQ2h0YjJSMWJHVXVaWGh3YjNKMGN5d2diVzlrZFd4bExDQnRiMlIxYkdVdVpYaHdiM0owY3l3Z1gxOTNaV0p3WVdOclgzSmxjWFZwY21WZlh5azdYRzVjYmlCY2RGeDBMeThnUm14aFp5QjBhR1VnYlc5a2RXeGxJR0Z6SUd4dllXUmxaRnh1SUZ4MFhIUnRiMlIxYkdVdWJDQTlJSFJ5ZFdVN1hHNWNiaUJjZEZ4MEx5OGdVbVYwZFhKdUlIUm9aU0JsZUhCdmNuUnpJRzltSUhSb1pTQnRiMlIxYkdWY2JpQmNkRngwY21WMGRYSnVJRzF2WkhWc1pTNWxlSEJ2Y25Sek8xeHVJRngwZlZ4dVhHNWNiaUJjZEM4dklHVjRjRzl6WlNCMGFHVWdiVzlrZFd4bGN5QnZZbXBsWTNRZ0tGOWZkMlZpY0dGamExOXRiMlIxYkdWelgxOHBYRzRnWEhSZlgzZGxZbkJoWTJ0ZmNtVnhkV2x5WlY5ZkxtMGdQU0J0YjJSMWJHVnpPMXh1WEc0Z1hIUXZMeUJsZUhCdmMyVWdkR2hsSUcxdlpIVnNaU0JqWVdOb1pWeHVJRngwWDE5M1pXSndZV05yWDNKbGNYVnBjbVZmWHk1aklEMGdhVzV6ZEdGc2JHVmtUVzlrZFd4bGN6dGNibHh1SUZ4MEx5OGdhV1JsYm5ScGRIa2dablZ1WTNScGIyNGdabTl5SUdOaGJHeHBibWNnYUdGeWJXOXVlU0JwYlhCdmNuUnpJSGRwZEdnZ2RHaGxJR052Y25KbFkzUWdZMjl1ZEdWNGRGeHVJRngwWDE5M1pXSndZV05yWDNKbGNYVnBjbVZmWHk1cElEMGdablZ1WTNScGIyNG9kbUZzZFdVcElIc2djbVYwZFhKdUlIWmhiSFZsT3lCOU8xeHVYRzRnWEhRdkx5QmtaV1pwYm1VZ1oyVjBkR1Z5SUdaMWJtTjBhVzl1SUdadmNpQm9ZWEp0YjI1NUlHVjRjRzl5ZEhOY2JpQmNkRjlmZDJWaWNHRmphMTl5WlhGMWFYSmxYMTh1WkNBOUlHWjFibU4wYVc5dUtHVjRjRzl5ZEhNc0lHNWhiV1VzSUdkbGRIUmxjaWtnZTF4dUlGeDBYSFJwWmlnaFgxOTNaV0p3WVdOclgzSmxjWFZwY21WZlh5NXZLR1Y0Y0c5eWRITXNJRzVoYldVcEtTQjdYRzRnWEhSY2RGeDBUMkpxWldOMExtUmxabWx1WlZCeWIzQmxjblI1S0dWNGNHOXlkSE1zSUc1aGJXVXNJSHRjYmlCY2RGeDBYSFJjZEdOdmJtWnBaM1Z5WVdKc1pUb2dabUZzYzJVc1hHNGdYSFJjZEZ4MFhIUmxiblZ0WlhKaFlteGxPaUIwY25WbExGeHVJRngwWEhSY2RGeDBaMlYwT2lCblpYUjBaWEpjYmlCY2RGeDBYSFI5S1R0Y2JpQmNkRngwZlZ4dUlGeDBmVHRjYmx4dUlGeDBMeThnWjJWMFJHVm1ZWFZzZEVWNGNHOXlkQ0JtZFc1amRHbHZiaUJtYjNJZ1kyOXRjR0YwYVdKcGJHbDBlU0IzYVhSb0lHNXZiaTFvWVhKdGIyNTVJRzF2WkhWc1pYTmNiaUJjZEY5ZmQyVmljR0ZqYTE5eVpYRjFhWEpsWDE4dWJpQTlJR1oxYm1OMGFXOXVLRzF2WkhWc1pTa2dlMXh1SUZ4MFhIUjJZWElnWjJWMGRHVnlJRDBnYlc5a2RXeGxJQ1ltSUcxdlpIVnNaUzVmWDJWelRXOWtkV3hsSUQ5Y2JpQmNkRngwWEhSbWRXNWpkR2x2YmlCblpYUkVaV1poZFd4MEtDa2dleUJ5WlhSMWNtNGdiVzlrZFd4bFd5ZGtaV1poZFd4MEoxMDdJSDBnT2x4dUlGeDBYSFJjZEdaMWJtTjBhVzl1SUdkbGRFMXZaSFZzWlVWNGNHOXlkSE1vS1NCN0lISmxkSFZ5YmlCdGIyUjFiR1U3SUgwN1hHNGdYSFJjZEY5ZmQyVmljR0ZqYTE5eVpYRjFhWEpsWDE4dVpDaG5aWFIwWlhJc0lDZGhKeXdnWjJWMGRHVnlLVHRjYmlCY2RGeDBjbVYwZFhKdUlHZGxkSFJsY2p0Y2JpQmNkSDA3WEc1Y2JpQmNkQzh2SUU5aWFtVmpkQzV3Y205MGIzUjVjR1V1YUdGelQzZHVVSEp2Y0dWeWRIa3VZMkZzYkZ4dUlGeDBYMTkzWldKd1lXTnJYM0psY1hWcGNtVmZYeTV2SUQwZ1puVnVZM1JwYjI0b2IySnFaV04wTENCd2NtOXdaWEowZVNrZ2V5QnlaWFIxY200Z1QySnFaV04wTG5CeWIzUnZkSGx3WlM1b1lYTlBkMjVRY205d1pYSjBlUzVqWVd4c0tHOWlhbVZqZEN3Z2NISnZjR1Z5ZEhrcE95QjlPMXh1WEc0Z1hIUXZMeUJmWDNkbFluQmhZMnRmY0hWaWJHbGpYM0JoZEdoZlgxeHVJRngwWDE5M1pXSndZV05yWDNKbGNYVnBjbVZmWHk1d0lEMGdYQ0pjSWp0Y2JseHVJRngwTHk4Z1RHOWhaQ0JsYm5SeWVTQnRiMlIxYkdVZ1lXNWtJSEpsZEhWeWJpQmxlSEJ2Y25SelhHNGdYSFJ5WlhSMWNtNGdYMTkzWldKd1lXTnJYM0psY1hWcGNtVmZYeWhmWDNkbFluQmhZMnRmY21WeGRXbHlaVjlmTG5NZ1BTQXhOallwTzF4dVhHNWNibHh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVklnTHk5Y2JpOHZJSGRsWW5CaFkyc3ZZbTl2ZEhOMGNtRndJRGhtWTJRek5tSTFOR0U1WVdZMU5UWTVNak15SWl3aWRtRnlJR052Y21VZ1BTQnRiMlIxYkdVdVpYaHdiM0owY3lBOUlIdDJaWEp6YVc5dU9pQW5NaTQwTGpBbmZUdGNibWxtS0hSNWNHVnZaaUJmWDJVZ1BUMGdKMjUxYldKbGNpY3BYMTlsSUQwZ1kyOXlaVHNnTHk4Z1pYTnNhVzUwTFdScGMyRmliR1V0YkdsdVpTQnVieTExYm1SbFpseHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWTI5eVpTNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNRnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlEWWdOeUE0SURraUxDSXZMeUJvZEhSd2N6b3ZMMmRwZEdoMVlpNWpiMjB2ZW14dmFYSnZZMnN2WTI5eVpTMXFjeTlwYzNOMVpYTXZPRFlqYVhOemRXVmpiMjF0Wlc1MExURXhOVGMxT1RBeU9GeHVkbUZ5SUdkc2IySmhiQ0E5SUcxdlpIVnNaUzVsZUhCdmNuUnpJRDBnZEhsd1pXOW1JSGRwYm1SdmR5QWhQU0FuZFc1a1pXWnBibVZrSnlBbUppQjNhVzVrYjNjdVRXRjBhQ0E5UFNCTllYUm9YRzRnSUQ4Z2QybHVaRzkzSURvZ2RIbHdaVzltSUhObGJHWWdJVDBnSjNWdVpHVm1hVzVsWkNjZ0ppWWdjMlZzWmk1TllYUm9JRDA5SUUxaGRHZ2dQeUJ6Wld4bUlEb2dSblZ1WTNScGIyNG9KM0psZEhWeWJpQjBhR2x6Snlrb0tUdGNibWxtS0hSNWNHVnZaaUJmWDJjZ1BUMGdKMjUxYldKbGNpY3BYMTluSUQwZ1oyeHZZbUZzT3lBdkx5QmxjMnhwYm5RdFpHbHpZV0pzWlMxc2FXNWxJRzV2TFhWdVpHVm1YRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5bmJHOWlZV3d1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURGY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0EySURjZ09DQTVJaXdpTHk4Z1ZHaGhibXNuY3lCSlJUZ2dabTl5SUdocGN5Qm1kVzV1ZVNCa1pXWnBibVZRY205d1pYSjBlVnh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0FoY21WeGRXbHlaU2duTGk5ZlptRnBiSE1uS1NobWRXNWpkR2x2YmlncGUxeHVJQ0J5WlhSMWNtNGdUMkpxWldOMExtUmxabWx1WlZCeWIzQmxjblI1S0h0OUxDQW5ZU2NzSUh0blpYUTZJR1oxYm1OMGFXOXVLQ2w3SUhKbGRIVnliaUEzT3lCOWZTa3VZU0FoUFNBM08xeHVmU2s3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWtaWE5qY21sd2RHOXljeTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTWx4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJRFlnTnlBNElEa2lMQ0oyWVhJZ2MzUnZjbVVnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDNOb1lYSmxaQ2NwS0NkM2EzTW5LVnh1SUNBc0lIVnBaQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5MWFXUW5LVnh1SUNBc0lGTjViV0p2YkNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5bmJHOWlZV3duS1M1VGVXMWliMnhjYmlBZ0xDQlZVMFZmVTFsTlFrOU1JRDBnZEhsd1pXOW1JRk41YldKdmJDQTlQU0FuWm5WdVkzUnBiMjRuTzF4dVhHNTJZWElnSkdWNGNHOXlkSE1nUFNCdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0c1aGJXVXBlMXh1SUNCeVpYUjFjbTRnYzNSdmNtVmJibUZ0WlYwZ2ZId2dLSE4wYjNKbFcyNWhiV1ZkSUQxY2JpQWdJQ0JWVTBWZlUxbE5RazlNSUNZbUlGTjViV0p2YkZ0dVlXMWxYU0I4ZkNBb1ZWTkZYMU5aVFVKUFRDQS9JRk41YldKdmJDQTZJSFZwWkNrb0oxTjViV0p2YkM0bklDc2dibUZ0WlNrcE8xeHVmVHRjYmx4dUpHVjRjRzl5ZEhNdWMzUnZjbVVnUFNCemRHOXlaVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzZHJjeTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTTF4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpZG1GeUlHRnVUMkpxWldOMElDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZZVzR0YjJKcVpXTjBKeWxjYmlBZ0xDQkpSVGhmUkU5TlgwUkZSa2xPUlNBOUlISmxjWFZwY21Vb0p5NHZYMmxsT0Mxa2IyMHRaR1ZtYVc1bEp5bGNiaUFnTENCMGIxQnlhVzFwZEdsMlpTQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzUnZMWEJ5YVcxcGRHbDJaU2NwWEc0Z0lDd2daRkFnSUNBZ0lDQWdJQ0FnSUNBZ1BTQlBZbXBsWTNRdVpHVm1hVzVsVUhKdmNHVnlkSGs3WEc1Y2JtVjRjRzl5ZEhNdVppQTlJSEpsY1hWcGNtVW9KeTR2WDJSbGMyTnlhWEIwYjNKekp5a2dQeUJQWW1wbFkzUXVaR1ZtYVc1bFVISnZjR1Z5ZEhrZ09pQm1kVzVqZEdsdmJpQmtaV1pwYm1WUWNtOXdaWEowZVNoUExDQlFMQ0JCZEhSeWFXSjFkR1Z6S1h0Y2JpQWdZVzVQWW1wbFkzUW9UeWs3WEc0Z0lGQWdQU0IwYjFCeWFXMXBkR2wyWlNoUUxDQjBjblZsS1R0Y2JpQWdZVzVQWW1wbFkzUW9RWFIwY21saWRYUmxjeWs3WEc0Z0lHbG1LRWxGT0Y5RVQwMWZSRVZHU1U1RktYUnllU0I3WEc0Z0lDQWdjbVYwZFhKdUlHUlFLRThzSUZBc0lFRjBkSEpwWW5WMFpYTXBPMXh1SUNCOUlHTmhkR05vS0dVcGV5QXZLaUJsYlhCMGVTQXFMeUI5WEc0Z0lHbG1LQ2RuWlhRbklHbHVJRUYwZEhKcFluVjBaWE1nZkh3Z0ozTmxkQ2NnYVc0Z1FYUjBjbWxpZFhSbGN5bDBhSEp2ZHlCVWVYQmxSWEp5YjNJb0owRmpZMlZ6YzI5eWN5QnViM1FnYzNWd2NHOXlkR1ZrSVNjcE8xeHVJQ0JwWmlnbmRtRnNkV1VuSUdsdUlFRjBkSEpwWW5WMFpYTXBUMXRRWFNBOUlFRjBkSEpwWW5WMFpYTXVkbUZzZFdVN1hHNGdJSEpsZEhWeWJpQlBPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMjlpYW1WamRDMWtjQzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTkZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJRFlnTnlBNElEa2lMQ0oyWVhJZ2FYTlBZbXBsWTNRZ1BTQnlaWEYxYVhKbEtDY3VMMTlwY3kxdlltcGxZM1FuS1R0Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b2FYUXBlMXh1SUNCcFppZ2hhWE5QWW1wbFkzUW9hWFFwS1hSb2NtOTNJRlI1Y0dWRmNuSnZjaWhwZENBcklDY2dhWE1nYm05MElHRnVJRzlpYW1WamRDRW5LVHRjYmlBZ2NtVjBkWEp1SUdsME8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyRnVMVzlpYW1WamRDNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdOVnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlEWWdOeUE0SURraUxDSnRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHbDBLWHRjYmlBZ2NtVjBkWEp1SUhSNWNHVnZaaUJwZENBOVBUMGdKMjlpYW1WamRDY2dQeUJwZENBaFBUMGdiblZzYkNBNklIUjVjR1Z2WmlCcGRDQTlQVDBnSjJaMWJtTjBhVzl1Snp0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5cGN5MXZZbXBsWTNRdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEWmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNBMklEY2dPQ0E1SWl3aWRtRnlJR1JRSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXZZbXBsWTNRdFpIQW5LVnh1SUNBc0lHTnlaV0YwWlVSbGMyTWdQU0J5WlhGMWFYSmxLQ2N1TDE5d2NtOXdaWEowZVMxa1pYTmpKeWs3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhKbGNYVnBjbVVvSnk0dlgyUmxjMk55YVhCMGIzSnpKeWtnUHlCbWRXNWpkR2x2YmlodlltcGxZM1FzSUd0bGVTd2dkbUZzZFdVcGUxeHVJQ0J5WlhSMWNtNGdaRkF1WmlodlltcGxZM1FzSUd0bGVTd2dZM0psWVhSbFJHVnpZeWd4TENCMllXeDFaU2twTzF4dWZTQTZJR1oxYm1OMGFXOXVLRzlpYW1WamRDd2dhMlY1TENCMllXeDFaU2w3WEc0Z0lHOWlhbVZqZEZ0clpYbGRJRDBnZG1Gc2RXVTdYRzRnSUhKbGRIVnliaUJ2WW1wbFkzUTdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhR2xrWlM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ04xeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSURZZ055QTRJRGtpTENKY0luVnpaU0J6ZEhKcFkzUmNJanRjYmx4dVpYaHdiM0owY3k1ZlgyVnpUVzlrZFd4bElEMGdkSEoxWlR0Y2JseHVaWGh3YjNKMGN5NWtaV1poZFd4MElEMGdablZ1WTNScGIyNGdLR2x1YzNSaGJtTmxMQ0JEYjI1emRISjFZM1J2Y2lrZ2UxeHVJQ0JwWmlBb0lTaHBibk4wWVc1alpTQnBibk4wWVc1alpXOW1JRU52Ym5OMGNuVmpkRzl5S1NrZ2UxeHVJQ0FnSUhSb2NtOTNJRzVsZHlCVWVYQmxSWEp5YjNJb1hDSkRZVzV1YjNRZ1kyRnNiQ0JoSUdOc1lYTnpJR0Z6SUdFZ1puVnVZM1JwYjI1Y0lpazdYRzRnSUgxY2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wySmhZbVZzTFhKMWJuUnBiV1V2YUdWc2NHVnljeTlqYkdGemMwTmhiR3hEYUdWamF5NXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdPRnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlEWWdOeUE0SURrZ01UQWlMQ0oyWVhJZ1oyeHZZbUZzSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmWjJ4dlltRnNKeWxjYmlBZ0xDQmpiM0psSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5amIzSmxKeWxjYmlBZ0xDQmpkSGdnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5amRIZ25LVnh1SUNBc0lHaHBaR1VnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJocFpHVW5LVnh1SUNBc0lGQlNUMVJQVkZsUVJTQTlJQ2R3Y205MGIzUjVjR1VuTzF4dVhHNTJZWElnSkdWNGNHOXlkQ0E5SUdaMWJtTjBhVzl1S0hSNWNHVXNJRzVoYldVc0lITnZkWEpqWlNsN1hHNGdJSFpoY2lCSlUxOUdUMUpEUlVRZ1BTQjBlWEJsSUNZZ0pHVjRjRzl5ZEM1R1hHNGdJQ0FnTENCSlUxOUhURTlDUVV3Z1BTQjBlWEJsSUNZZ0pHVjRjRzl5ZEM1SFhHNGdJQ0FnTENCSlUxOVRWRUZVU1VNZ1BTQjBlWEJsSUNZZ0pHVjRjRzl5ZEM1VFhHNGdJQ0FnTENCSlUxOVFVazlVVHlBZ1BTQjBlWEJsSUNZZ0pHVjRjRzl5ZEM1UVhHNGdJQ0FnTENCSlUxOUNTVTVFSUNBZ1BTQjBlWEJsSUNZZ0pHVjRjRzl5ZEM1Q1hHNGdJQ0FnTENCSlUxOVhVa0ZRSUNBZ1BTQjBlWEJsSUNZZ0pHVjRjRzl5ZEM1WFhHNGdJQ0FnTENCbGVIQnZjblJ6SUNBZ1BTQkpVMTlIVEU5Q1FVd2dQeUJqYjNKbElEb2dZMjl5WlZ0dVlXMWxYU0I4ZkNBb1kyOXlaVnR1WVcxbFhTQTlJSHQ5S1Z4dUlDQWdJQ3dnWlhod1VISnZkRzhnSUQwZ1pYaHdiM0owYzF0UVVrOVVUMVJaVUVWZFhHNGdJQ0FnTENCMFlYSm5aWFFnSUNBZ1BTQkpVMTlIVEU5Q1FVd2dQeUJuYkc5aVlXd2dPaUJKVTE5VFZFRlVTVU1nUHlCbmJHOWlZV3hiYm1GdFpWMGdPaUFvWjJ4dlltRnNXMjVoYldWZElIeDhJSHQ5S1Z0UVVrOVVUMVJaVUVWZFhHNGdJQ0FnTENCclpYa3NJRzkzYml3Z2IzVjBPMXh1SUNCcFppaEpVMTlIVEU5Q1FVd3BjMjkxY21ObElEMGdibUZ0WlR0Y2JpQWdabTl5S0d0bGVTQnBiaUJ6YjNWeVkyVXBlMXh1SUNBZ0lDOHZJR052Ym5SaGFXNXpJR2x1SUc1aGRHbDJaVnh1SUNBZ0lHOTNiaUE5SUNGSlUxOUdUMUpEUlVRZ0ppWWdkR0Z5WjJWMElDWW1JSFJoY21kbGRGdHJaWGxkSUNFOVBTQjFibVJsWm1sdVpXUTdYRzRnSUNBZ2FXWW9iM2R1SUNZbUlHdGxlU0JwYmlCbGVIQnZjblJ6S1dOdmJuUnBiblZsTzF4dUlDQWdJQzh2SUdWNGNHOXlkQ0J1WVhScGRtVWdiM0lnY0dGemMyVmtYRzRnSUNBZ2IzVjBJRDBnYjNkdUlEOGdkR0Z5WjJWMFcydGxlVjBnT2lCemIzVnlZMlZiYTJWNVhUdGNiaUFnSUNBdkx5QndjbVYyWlc1MElHZHNiMkpoYkNCd2IyeHNkWFJwYjI0Z1ptOXlJRzVoYldWemNHRmpaWE5jYmlBZ0lDQmxlSEJ2Y25SelcydGxlVjBnUFNCSlUxOUhURTlDUVV3Z0ppWWdkSGx3Wlc5bUlIUmhjbWRsZEZ0clpYbGRJQ0U5SUNkbWRXNWpkR2x2YmljZ1B5QnpiM1Z5WTJWYmEyVjVYVnh1SUNBZ0lDOHZJR0pwYm1RZ2RHbHRaWEp6SUhSdklHZHNiMkpoYkNCbWIzSWdZMkZzYkNCbWNtOXRJR1Y0Y0c5eWRDQmpiMjUwWlhoMFhHNGdJQ0FnT2lCSlUxOUNTVTVFSUNZbUlHOTNiaUEvSUdOMGVDaHZkWFFzSUdkc2IySmhiQ2xjYmlBZ0lDQXZMeUIzY21Gd0lHZHNiMkpoYkNCamIyNXpkSEoxWTNSdmNuTWdabTl5SUhCeVpYWmxiblFnWTJoaGJtZGxJSFJvWlcwZ2FXNGdiR2xpY21GeWVWeHVJQ0FnSURvZ1NWTmZWMUpCVUNBbUppQjBZWEpuWlhSYmEyVjVYU0E5UFNCdmRYUWdQeUFvWm5WdVkzUnBiMjRvUXlsN1hHNGdJQ0FnSUNCMllYSWdSaUE5SUdaMWJtTjBhVzl1S0dFc0lHSXNJR01wZTF4dUlDQWdJQ0FnSUNCcFppaDBhR2x6SUdsdWMzUmhibU5sYjJZZ1F5bDdYRzRnSUNBZ0lDQWdJQ0FnYzNkcGRHTm9LR0Z5WjNWdFpXNTBjeTVzWlc1bmRHZ3BlMXh1SUNBZ0lDQWdJQ0FnSUNBZ1kyRnpaU0F3T2lCeVpYUjFjbTRnYm1WM0lFTTdYRzRnSUNBZ0lDQWdJQ0FnSUNCallYTmxJREU2SUhKbGRIVnliaUJ1WlhjZ1F5aGhLVHRjYmlBZ0lDQWdJQ0FnSUNBZ0lHTmhjMlVnTWpvZ2NtVjBkWEp1SUc1bGR5QkRLR0VzSUdJcE8xeHVJQ0FnSUNBZ0lDQWdJSDBnY21WMGRYSnVJRzVsZHlCREtHRXNJR0lzSUdNcE8xeHVJQ0FnSUNBZ0lDQjlJSEpsZEhWeWJpQkRMbUZ3Y0d4NUtIUm9hWE1zSUdGeVozVnRaVzUwY3lrN1hHNGdJQ0FnSUNCOU8xeHVJQ0FnSUNBZ1JsdFFVazlVVDFSWlVFVmRJRDBnUTF0UVVrOVVUMVJaVUVWZE8xeHVJQ0FnSUNBZ2NtVjBkWEp1SUVZN1hHNGdJQ0FnTHk4Z2JXRnJaU0J6ZEdGMGFXTWdkbVZ5YzJsdmJuTWdabTl5SUhCeWIzUnZkSGx3WlNCdFpYUm9iMlJ6WEc0Z0lDQWdmU2tvYjNWMEtTQTZJRWxUWDFCU1QxUlBJQ1ltSUhSNWNHVnZaaUJ2ZFhRZ1BUMGdKMloxYm1OMGFXOXVKeUEvSUdOMGVDaEdkVzVqZEdsdmJpNWpZV3hzTENCdmRYUXBJRG9nYjNWME8xeHVJQ0FnSUM4dklHVjRjRzl5ZENCd2NtOTBieUJ0WlhSb2IyUnpJSFJ2SUdOdmNtVXVKVU5QVGxOVVVsVkRWRTlTSlM1dFpYUm9iMlJ6TGlWT1FVMUZKVnh1SUNBZ0lHbG1LRWxUWDFCU1QxUlBLWHRjYmlBZ0lDQWdJQ2hsZUhCdmNuUnpMblpwY25SMVlXd2dmSHdnS0dWNGNHOXlkSE11ZG1seWRIVmhiQ0E5SUh0OUtTbGJhMlY1WFNBOUlHOTFkRHRjYmlBZ0lDQWdJQzh2SUdWNGNHOXlkQ0J3Y205MGJ5QnRaWFJvYjJSeklIUnZJR052Y21VdUpVTlBUbE5VVWxWRFZFOVNKUzV3Y205MGIzUjVjR1V1SlU1QlRVVWxYRzRnSUNBZ0lDQnBaaWgwZVhCbElDWWdKR1Y0Y0c5eWRDNVNJQ1ltSUdWNGNGQnliM1J2SUNZbUlDRmxlSEJRY205MGIxdHJaWGxkS1docFpHVW9aWGh3VUhKdmRHOHNJR3RsZVN3Z2IzVjBLVHRjYmlBZ0lDQjlYRzRnSUgxY2JuMDdYRzR2THlCMGVYQmxJR0pwZEcxaGNGeHVKR1Y0Y0c5eWRDNUdJRDBnTVRzZ0lDQXZMeUJtYjNKalpXUmNiaVJsZUhCdmNuUXVSeUE5SURJN0lDQWdMeThnWjJ4dlltRnNYRzRrWlhod2IzSjBMbE1nUFNBME95QWdJQzh2SUhOMFlYUnBZMXh1SkdWNGNHOXlkQzVRSUQwZ09Ec2dJQ0F2THlCd2NtOTBiMXh1SkdWNGNHOXlkQzVDSUQwZ01UWTdJQ0F2THlCaWFXNWtYRzRrWlhod2IzSjBMbGNnUFNBek1qc2dJQzh2SUhkeVlYQmNiaVJsZUhCdmNuUXVWU0E5SURZME95QWdMeThnYzJGbVpWeHVKR1Y0Y0c5eWRDNVNJRDBnTVRJNE95QXZMeUJ5WldGc0lIQnliM1J2SUcxbGRHaHZaQ0JtYjNJZ1lHeHBZbkpoY25sZ0lGeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQWtaWGh3YjNKME8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWlhod2IzSjBMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0E1WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWdOaUEzSURnZ09TSXNJbHdpZFhObElITjBjbWxqZEZ3aU8xeHVYRzVsZUhCdmNuUnpMbDlmWlhOTmIyUjFiR1VnUFNCMGNuVmxPMXh1WEc1MllYSWdYMlJsWm1sdVpWQnliM0JsY25SNUlEMGdjbVZ4ZFdseVpTaGNJaTR1TDJOdmNtVXRhbk12YjJKcVpXTjBMMlJsWm1sdVpTMXdjbTl3WlhKMGVWd2lLVHRjYmx4dWRtRnlJRjlrWldacGJtVlFjbTl3WlhKMGVUSWdQU0JmYVc1MFpYSnZjRkpsY1hWcGNtVkVaV1poZFd4MEtGOWtaV1pwYm1WUWNtOXdaWEowZVNrN1hHNWNibVoxYm1OMGFXOXVJRjlwYm5SbGNtOXdVbVZ4ZFdseVpVUmxabUYxYkhRb2IySnFLU0I3SUhKbGRIVnliaUJ2WW1vZ0ppWWdiMkpxTGw5ZlpYTk5iMlIxYkdVZ1B5QnZZbW9nT2lCN0lHUmxabUYxYkhRNklHOWlhaUI5T3lCOVhHNWNibVY0Y0c5eWRITXVaR1ZtWVhWc2RDQTlJR1oxYm1OMGFXOXVJQ2dwSUh0Y2JpQWdablZ1WTNScGIyNGdaR1ZtYVc1bFVISnZjR1Z5ZEdsbGN5aDBZWEpuWlhRc0lIQnliM0J6S1NCN1hHNGdJQ0FnWm05eUlDaDJZWElnYVNBOUlEQTdJR2tnUENCd2NtOXdjeTVzWlc1bmRHZzdJR2tyS3lrZ2UxeHVJQ0FnSUNBZ2RtRnlJR1JsYzJOeWFYQjBiM0lnUFNCd2NtOXdjMXRwWFR0Y2JpQWdJQ0FnSUdSbGMyTnlhWEIwYjNJdVpXNTFiV1Z5WVdKc1pTQTlJR1JsYzJOeWFYQjBiM0l1Wlc1MWJXVnlZV0pzWlNCOGZDQm1ZV3h6WlR0Y2JpQWdJQ0FnSUdSbGMyTnlhWEIwYjNJdVkyOXVabWxuZFhKaFlteGxJRDBnZEhKMVpUdGNiaUFnSUNBZ0lHbG1JQ2hjSW5aaGJIVmxYQ0lnYVc0Z1pHVnpZM0pwY0hSdmNpa2daR1Z6WTNKcGNIUnZjaTUzY21sMFlXSnNaU0E5SUhSeWRXVTdYRzRnSUNBZ0lDQW9NQ3dnWDJSbFptbHVaVkJ5YjNCbGNuUjVNaTVrWldaaGRXeDBLU2gwWVhKblpYUXNJR1JsYzJOeWFYQjBiM0l1YTJWNUxDQmtaWE5qY21sd2RHOXlLVHRjYmlBZ0lDQjlYRzRnSUgxY2JseHVJQ0J5WlhSMWNtNGdablZ1WTNScGIyNGdLRU52Ym5OMGNuVmpkRzl5TENCd2NtOTBiMUJ5YjNCekxDQnpkR0YwYVdOUWNtOXdjeWtnZTF4dUlDQWdJR2xtSUNod2NtOTBiMUJ5YjNCektTQmtaV1pwYm1WUWNtOXdaWEowYVdWektFTnZibk4wY25WamRHOXlMbkJ5YjNSdmRIbHdaU3dnY0hKdmRHOVFjbTl3Y3lrN1hHNGdJQ0FnYVdZZ0tITjBZWFJwWTFCeWIzQnpLU0JrWldacGJtVlFjbTl3WlhKMGFXVnpLRU52Ym5OMGNuVmpkRzl5TENCemRHRjBhV05RY205d2N5azdYRzRnSUNBZ2NtVjBkWEp1SUVOdmJuTjBjblZqZEc5eU8xeHVJQ0I5TzF4dWZTZ3BPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJobGJIQmxjbk12WTNKbFlYUmxRMnhoYzNNdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlERXdYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVZ05pQTNJRGdnT1NJc0ltMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b1pYaGxZeWw3WEc0Z0lIUnllU0I3WEc0Z0lDQWdjbVYwZFhKdUlDRWhaWGhsWXlncE8xeHVJQ0I5SUdOaGRHTm9LR1VwZTF4dUlDQWdJSEpsZEhWeWJpQjBjblZsTzF4dUlDQjlYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZabUZwYkhNdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlERXhYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVZ05pQTNJRGdnT1NJc0luWmhjaUJvWVhOUGQyNVFjbTl3WlhKMGVTQTlJSHQ5TG1oaGMwOTNibEJ5YjNCbGNuUjVPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhwZEN3Z2EyVjVLWHRjYmlBZ2NtVjBkWEp1SUdoaGMwOTNibEJ5YjNCbGNuUjVMbU5oYkd3b2FYUXNJR3RsZVNrN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFHRnpMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F4TWx4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpTHk4Z2RHOGdhVzVrWlhobFpDQnZZbXBsWTNRc0lIUnZUMkpxWldOMElIZHBkR2dnWm1Gc2JHSmhZMnNnWm05eUlHNXZiaTFoY25KaGVTMXNhV3RsSUVWVE15QnpkSEpwYm1kelhHNTJZWElnU1U5aWFtVmpkQ0E5SUhKbGNYVnBjbVVvSnk0dlgybHZZbXBsWTNRbktWeHVJQ0FzSUdSbFptbHVaV1FnUFNCeVpYRjFhWEpsS0NjdUwxOWtaV1pwYm1Wa0p5azdYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLR2wwS1h0Y2JpQWdjbVYwZFhKdUlFbFBZbXBsWTNRb1pHVm1hVzVsWkNocGRDa3BPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM1J2TFdsdlltcGxZM1F1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURFelhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVpTENJdkx5QnZjSFJwYjI1aGJDQXZJSE5wYlhCc1pTQmpiMjUwWlhoMElHSnBibVJwYm1kY2JuWmhjaUJoUm5WdVkzUnBiMjRnUFNCeVpYRjFhWEpsS0NjdUwxOWhMV1oxYm1OMGFXOXVKeWs3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0dadUxDQjBhR0YwTENCc1pXNW5kR2dwZTF4dUlDQmhSblZ1WTNScGIyNG9abTRwTzF4dUlDQnBaaWgwYUdGMElEMDlQU0IxYm1SbFptbHVaV1FwY21WMGRYSnVJR1p1TzF4dUlDQnpkMmwwWTJnb2JHVnVaM1JvS1h0Y2JpQWdJQ0JqWVhObElERTZJSEpsZEhWeWJpQm1kVzVqZEdsdmJpaGhLWHRjYmlBZ0lDQWdJSEpsZEhWeWJpQm1iaTVqWVd4c0tIUm9ZWFFzSUdFcE8xeHVJQ0FnSUgwN1hHNGdJQ0FnWTJGelpTQXlPaUJ5WlhSMWNtNGdablZ1WTNScGIyNG9ZU3dnWWlsN1hHNGdJQ0FnSUNCeVpYUjFjbTRnWm00dVkyRnNiQ2gwYUdGMExDQmhMQ0JpS1R0Y2JpQWdJQ0I5TzF4dUlDQWdJR05oYzJVZ016b2djbVYwZFhKdUlHWjFibU4wYVc5dUtHRXNJR0lzSUdNcGUxeHVJQ0FnSUNBZ2NtVjBkWEp1SUdadUxtTmhiR3dvZEdoaGRDd2dZU3dnWWl3Z1l5azdYRzRnSUNBZ2ZUdGNiaUFnZlZ4dUlDQnlaWFIxY200Z1puVnVZM1JwYjI0b0x5b2dMaTR1WVhKbmN5QXFMeWw3WEc0Z0lDQWdjbVYwZFhKdUlHWnVMbUZ3Y0d4NUtIUm9ZWFFzSUdGeVozVnRaVzUwY3lrN1hHNGdJSDA3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWTNSNExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXhORnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlEWWdOeUE0SURraUxDSnRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHSnBkRzFoY0N3Z2RtRnNkV1VwZTF4dUlDQnlaWFIxY200Z2UxeHVJQ0FnSUdWdWRXMWxjbUZpYkdVZ0lEb2dJU2hpYVhSdFlYQWdKaUF4S1N4Y2JpQWdJQ0JqYjI1bWFXZDFjbUZpYkdVNklDRW9ZbWwwYldGd0lDWWdNaWtzWEc0Z0lDQWdkM0pwZEdGaWJHVWdJQ0FnT2lBaEtHSnBkRzFoY0NBbUlEUXBMRnh1SUNBZ0lIWmhiSFZsSUNBZ0lDQWdJRG9nZG1Gc2RXVmNiaUFnZlR0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5d2NtOXdaWEowZVMxa1pYTmpMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F4TlZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJRFlnTnlBNElEa2lMQ0p0YjJSMWJHVXVaWGh3YjNKMGN5QTlJSHQ5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhWFJsY21GMGIzSnpMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F4Tmx4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpZG1GeUlHbHpUMkpxWldOMElEMGdjbVZ4ZFdseVpTZ25MaTlmYVhNdGIySnFaV04wSnlsY2JpQWdMQ0JrYjJOMWJXVnVkQ0E5SUhKbGNYVnBjbVVvSnk0dlgyZHNiMkpoYkNjcExtUnZZM1Z0Wlc1MFhHNGdJQzh2SUdsdUlHOXNaQ0JKUlNCMGVYQmxiMllnWkc5amRXMWxiblF1WTNKbFlYUmxSV3hsYldWdWRDQnBjeUFuYjJKcVpXTjBKMXh1SUNBc0lHbHpJRDBnYVhOUFltcGxZM1FvWkc5amRXMWxiblFwSUNZbUlHbHpUMkpxWldOMEtHUnZZM1Z0Wlc1MExtTnlaV0YwWlVWc1pXMWxiblFwTzF4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCbWRXNWpkR2x2YmlocGRDbDdYRzRnSUhKbGRIVnliaUJwY3lBL0lHUnZZM1Z0Wlc1MExtTnlaV0YwWlVWc1pXMWxiblFvYVhRcElEb2dlMzA3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWkc5dExXTnlaV0YwWlM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01UZGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNBMklEY2dPQ0E1SWl3aUx5OGdNVGt1TVM0eUxqRTBJQzhnTVRVdU1pNHpMakUwSUU5aWFtVmpkQzVyWlhsektFOHBYRzUyWVhJZ0pHdGxlWE1nSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0YTJWNWN5MXBiblJsY201aGJDY3BYRzRnSUN3Z1pXNTFiVUoxWjB0bGVYTWdQU0J5WlhGMWFYSmxLQ2N1TDE5bGJuVnRMV0oxWnkxclpYbHpKeWs3WEc1Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1QySnFaV04wTG10bGVYTWdmSHdnWm5WdVkzUnBiMjRnYTJWNWN5aFBLWHRjYmlBZ2NtVjBkWEp1SUNSclpYbHpLRThzSUdWdWRXMUNkV2RMWlhsektUdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXZZbXBsWTNRdGEyVjVjeTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTVRoY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSW0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRvYVhRcGUxeHVJQ0JwWmloMGVYQmxiMllnYVhRZ0lUMGdKMloxYm1OMGFXOXVKeWwwYUhKdmR5QlVlWEJsUlhKeWIzSW9hWFFnS3lBbklHbHpJRzV2ZENCaElHWjFibU4wYVc5dUlTY3BPMXh1SUNCeVpYUjFjbTRnYVhRN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZllTMW1kVzVqZEdsdmJpNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVGxjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TQTJJRGNnT0NBNUlpd2lkbUZ5SUhSdlUzUnlhVzVuSUQwZ2UzMHVkRzlUZEhKcGJtYzdYRzVjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRvYVhRcGUxeHVJQ0J5WlhSMWNtNGdkRzlUZEhKcGJtY3VZMkZzYkNocGRDa3VjMnhwWTJVb09Dd2dMVEVwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJOdlppNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNakJjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TSXNJaTh2SURjdU1TNHhJRlJ2VUhKcGJXbDBhWFpsS0dsdWNIVjBJRnNzSUZCeVpXWmxjbkpsWkZSNWNHVmRLVnh1ZG1GeUlHbHpUMkpxWldOMElEMGdjbVZ4ZFdseVpTZ25MaTlmYVhNdGIySnFaV04wSnlrN1hHNHZMeUJwYm5OMFpXRmtJRzltSUhSb1pTQkZVellnYzNCbFl5QjJaWEp6YVc5dUxDQjNaU0JrYVdSdUozUWdhVzF3YkdWdFpXNTBJRUJBZEc5UWNtbHRhWFJwZG1VZ1kyRnpaVnh1THk4Z1lXNWtJSFJvWlNCelpXTnZibVFnWVhKbmRXMWxiblFnTFNCbWJHRm5JQzBnY0hKbFptVnljbVZrSUhSNWNHVWdhWE1nWVNCemRISnBibWRjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRvYVhRc0lGTXBlMXh1SUNCcFppZ2hhWE5QWW1wbFkzUW9hWFFwS1hKbGRIVnliaUJwZER0Y2JpQWdkbUZ5SUdadUxDQjJZV3c3WEc0Z0lHbG1LRk1nSmlZZ2RIbHdaVzltSUNobWJpQTlJR2wwTG5SdlUzUnlhVzVuS1NBOVBTQW5ablZ1WTNScGIyNG5JQ1ltSUNGcGMwOWlhbVZqZENoMllXd2dQU0JtYmk1allXeHNLR2wwS1NrcGNtVjBkWEp1SUhaaGJEdGNiaUFnYVdZb2RIbHdaVzltSUNobWJpQTlJR2wwTG5aaGJIVmxUMllwSUQwOUlDZG1kVzVqZEdsdmJpY2dKaVlnSVdselQySnFaV04wS0haaGJDQTlJR1p1TG1OaGJHd29hWFFwS1NseVpYUjFjbTRnZG1Gc08xeHVJQ0JwWmlnaFV5QW1KaUIwZVhCbGIyWWdLR1p1SUQwZ2FYUXVkRzlUZEhKcGJtY3BJRDA5SUNkbWRXNWpkR2x2YmljZ0ppWWdJV2x6VDJKcVpXTjBLSFpoYkNBOUlHWnVMbU5oYkd3b2FYUXBLU2x5WlhSMWNtNGdkbUZzTzF4dUlDQjBhSEp2ZHlCVWVYQmxSWEp5YjNJb1hDSkRZVzRuZENCamIyNTJaWEowSUc5aWFtVmpkQ0IwYnlCd2NtbHRhWFJwZG1VZ2RtRnNkV1ZjSWlrN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmRHOHRjSEpwYldsMGFYWmxMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F5TVZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJRFlnTnlBNElEa2lMQ0oyWVhJZ1pHVm1JRDBnY21WeGRXbHlaU2duTGk5ZmIySnFaV04wTFdSd0p5a3VabHh1SUNBc0lHaGhjeUE5SUhKbGNYVnBjbVVvSnk0dlgyaGhjeWNwWEc0Z0lDd2dWRUZISUQwZ2NtVnhkV2x5WlNnbkxpOWZkMnR6Snlrb0ozUnZVM1J5YVc1blZHRm5KeWs3WEc1Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b2FYUXNJSFJoWnl3Z2MzUmhkQ2w3WEc0Z0lHbG1LR2wwSUNZbUlDRm9ZWE1vYVhRZ1BTQnpkR0YwSUQ4Z2FYUWdPaUJwZEM1d2NtOTBiM1I1Y0dVc0lGUkJSeWtwWkdWbUtHbDBMQ0JVUVVjc0lIdGpiMjVtYVdkMWNtRmliR1U2SUhSeWRXVXNJSFpoYkhWbE9pQjBZV2Q5S1R0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5elpYUXRkRzh0YzNSeWFXNW5MWFJoWnk1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01qSmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0luWmhjaUJwWkNBOUlEQmNiaUFnTENCd2VDQTlJRTFoZEdndWNtRnVaRzl0S0NrN1hHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHdGxlU2w3WEc0Z0lISmxkSFZ5YmlBblUzbHRZbTlzS0NjdVkyOXVZMkYwS0d0bGVTQTlQVDBnZFc1a1pXWnBibVZrSUQ4Z0p5Y2dPaUJyWlhrc0lDY3BYeWNzSUNncksybGtJQ3NnY0hncExuUnZVM1J5YVc1bktETTJLU2s3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmZFdsa0xtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXlNMXh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlpd2lMeThnTnk0eUxqRWdVbVZ4ZFdseVpVOWlhbVZqZEVOdlpYSmphV0pzWlNoaGNtZDFiV1Z1ZENsY2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b2FYUXBlMXh1SUNCcFppaHBkQ0E5UFNCMWJtUmxabWx1WldRcGRHaHliM2NnVkhsd1pVVnljbTl5S0Z3aVEyRnVKM1FnWTJGc2JDQnRaWFJvYjJRZ2IyNGdJRndpSUNzZ2FYUXBPMXh1SUNCeVpYUjFjbTRnYVhRN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZlpHVm1hVzVsWkM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01qUmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0ltMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ0lYSmxjWFZwY21Vb0p5NHZYMlJsYzJOeWFYQjBiM0p6SnlrZ0ppWWdJWEpsY1hWcGNtVW9KeTR2WDJaaGFXeHpKeWtvWm5WdVkzUnBiMjRvS1h0Y2JpQWdjbVYwZFhKdUlFOWlhbVZqZEM1a1pXWnBibVZRY205d1pYSjBlU2h5WlhGMWFYSmxLQ2N1TDE5a2IyMHRZM0psWVhSbEp5a29KMlJwZGljcExDQW5ZU2NzSUh0blpYUTZJR1oxYm1OMGFXOXVLQ2w3SUhKbGRIVnliaUEzT3lCOWZTa3VZU0FoUFNBM08xeHVmU2s3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXBaVGd0Wkc5dExXUmxabWx1WlM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01qVmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNBMklEY2dPQ0E1SWl3aWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCMGNuVmxPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmJHbGljbUZ5ZVM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01qWmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0luWmhjaUJ6YUdGeVpXUWdQU0J5WlhGMWFYSmxLQ2N1TDE5emFHRnlaV1FuS1NnbmEyVjVjeWNwWEc0Z0lDd2dkV2xrSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZFdsa0p5azdYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLR3RsZVNsN1hHNGdJSEpsZEhWeWJpQnphR0Z5WldSYmEyVjVYU0I4ZkNBb2MyaGhjbVZrVzJ0bGVWMGdQU0IxYVdRb2EyVjVLU2s3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYzJoaGNtVmtMV3RsZVM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01qZGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0lpOHZJRGN1TVM0MElGUnZTVzUwWldkbGNseHVkbUZ5SUdObGFXd2dJRDBnVFdGMGFDNWpaV2xzWEc0Z0lDd2dabXh2YjNJZ1BTQk5ZWFJvTG1ac2IyOXlPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhwZENsN1hHNGdJSEpsZEhWeWJpQnBjMDVoVGlocGRDQTlJQ3RwZENrZ1B5QXdJRG9nS0dsMElENGdNQ0EvSUdac2IyOXlJRG9nWTJWcGJDa29hWFFwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDNSdkxXbHVkR1ZuWlhJdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlESTRYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSXZMeUJKUlNBNExTQmtiMjRuZENCbGJuVnRJR0oxWnlCclpYbHpYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJQ2hjYmlBZ0oyTnZibk4wY25WamRHOXlMR2hoYzA5M2JsQnliM0JsY25SNUxHbHpVSEp2ZEc5MGVYQmxUMllzY0hKdmNHVnlkSGxKYzBWdWRXMWxjbUZpYkdVc2RHOU1iMk5oYkdWVGRISnBibWNzZEc5VGRISnBibWNzZG1Gc2RXVlBaaWRjYmlrdWMzQnNhWFFvSnl3bktUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJWdWRXMHRZblZuTFd0bGVYTXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJREk1WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWlMQ0oyWVhJZ1oyeHZZbUZzSUQwZ2NtVnhkV2x5WlNnbkxpOWZaMnh2WW1Gc0p5bGNiaUFnTENCVFNFRlNSVVFnUFNBblgxOWpiM0psTFdwelgzTm9ZWEpsWkY5ZkoxeHVJQ0FzSUhOMGIzSmxJQ0E5SUdkc2IySmhiRnRUU0VGU1JVUmRJSHg4SUNobmJHOWlZV3hiVTBoQlVrVkVYU0E5SUh0OUtUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9hMlY1S1h0Y2JpQWdjbVYwZFhKdUlITjBiM0psVzJ0bGVWMGdmSHdnS0hOMGIzSmxXMnRsZVYwZ1BTQjdmU2s3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYzJoaGNtVmtMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F6TUZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpYlc5a2RXeGxMbVY0Y0c5eWRITWdQU0I3SUZ3aVpHVm1ZWFZzZEZ3aU9pQnlaWEYxYVhKbEtGd2lZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMjlpYW1WamRDOW5aWFF0Y0hKdmRHOTBlWEJsTFc5bVhDSXBMQ0JmWDJWelRXOWtkV3hsT2lCMGNuVmxJSDA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMkpoWW1Wc0xYSjFiblJwYldVdlkyOXlaUzFxY3k5dlltcGxZM1F2WjJWMExYQnliM1J2ZEhsd1pTMXZaaTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTXpGY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklpd2lMeThnTnk0eExqRXpJRlJ2VDJKcVpXTjBLR0Z5WjNWdFpXNTBLVnh1ZG1GeUlHUmxabWx1WldRZ1BTQnlaWEYxYVhKbEtDY3VMMTlrWldacGJtVmtKeWs3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0dsMEtYdGNiaUFnY21WMGRYSnVJRTlpYW1WamRDaGtaV1pwYm1Wa0tHbDBLU2s3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmZEc4dGIySnFaV04wTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBek1seHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSWl3aWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCN0lGd2laR1ZtWVhWc2RGd2lPaUJ5WlhGMWFYSmxLRndpWTI5eVpTMXFjeTlzYVdKeVlYSjVMMlp1TDI5aWFtVmpkQzlrWldacGJtVXRjSEp2Y0dWeWRIbGNJaWtzSUY5ZlpYTk5iMlIxYkdVNklIUnlkV1VnZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOWpiM0psTFdwekwyOWlhbVZqZEM5a1pXWnBibVV0Y0hKdmNHVnlkSGt1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURNelhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVnTmlBM0lEZ2dPU0lzSWx3aWRYTmxJSE4wY21samRGd2lPMXh1WEc1bGVIQnZjblJ6TGw5ZlpYTk5iMlIxYkdVZ1BTQjBjblZsTzF4dVhHNTJZWElnWDNObGRGQnliM1J2ZEhsd1pVOW1JRDBnY21WeGRXbHlaU2hjSWk0dUwyTnZjbVV0YW5NdmIySnFaV04wTDNObGRDMXdjbTkwYjNSNWNHVXRiMlpjSWlrN1hHNWNiblpoY2lCZmMyVjBVSEp2ZEc5MGVYQmxUMll5SUQwZ1gybHVkR1Z5YjNCU1pYRjFhWEpsUkdWbVlYVnNkQ2hmYzJWMFVISnZkRzkwZVhCbFQyWXBPMXh1WEc1MllYSWdYMk55WldGMFpTQTlJSEpsY1hWcGNtVW9YQ0l1TGk5amIzSmxMV3B6TDI5aWFtVmpkQzlqY21WaGRHVmNJaWs3WEc1Y2JuWmhjaUJmWTNKbFlYUmxNaUE5SUY5cGJuUmxjbTl3VW1WeGRXbHlaVVJsWm1GMWJIUW9YMk55WldGMFpTazdYRzVjYm5aaGNpQmZkSGx3Wlc5bU1pQTlJSEpsY1hWcGNtVW9YQ0l1TGk5b1pXeHdaWEp6TDNSNWNHVnZabHdpS1R0Y2JseHVkbUZ5SUY5MGVYQmxiMll6SUQwZ1gybHVkR1Z5YjNCU1pYRjFhWEpsUkdWbVlYVnNkQ2hmZEhsd1pXOW1NaWs3WEc1Y2JtWjFibU4wYVc5dUlGOXBiblJsY205d1VtVnhkV2x5WlVSbFptRjFiSFFvYjJKcUtTQjdJSEpsZEhWeWJpQnZZbW9nSmlZZ2IySnFMbDlmWlhOTmIyUjFiR1VnUHlCdlltb2dPaUI3SUdSbFptRjFiSFE2SUc5aWFpQjlPeUI5WEc1Y2JtVjRjRzl5ZEhNdVpHVm1ZWFZzZENBOUlHWjFibU4wYVc5dUlDaHpkV0pEYkdGemN5d2djM1Z3WlhKRGJHRnpjeWtnZTF4dUlDQnBaaUFvZEhsd1pXOW1JSE4xY0dWeVEyeGhjM01nSVQwOUlGd2lablZ1WTNScGIyNWNJaUFtSmlCemRYQmxja05zWVhOeklDRTlQU0J1ZFd4c0tTQjdYRzRnSUNBZ2RHaHliM2NnYm1WM0lGUjVjR1ZGY25KdmNpaGNJbE4xY0dWeUlHVjRjSEpsYzNOcGIyNGdiWFZ6ZENCbGFYUm9aWElnWW1VZ2JuVnNiQ0J2Y2lCaElHWjFibU4wYVc5dUxDQnViM1FnWENJZ0t5QW9kSGx3Wlc5bUlITjFjR1Z5UTJ4aGMzTWdQVDA5SUZ3aWRXNWtaV1pwYm1Wa1hDSWdQeUJjSW5WdVpHVm1hVzVsWkZ3aUlEb2dLREFzSUY5MGVYQmxiMll6TG1SbFptRjFiSFFwS0hOMWNHVnlRMnhoYzNNcEtTazdYRzRnSUgxY2JseHVJQ0J6ZFdKRGJHRnpjeTV3Y205MGIzUjVjR1VnUFNBb01Dd2dYMk55WldGMFpUSXVaR1ZtWVhWc2RDa29jM1Z3WlhKRGJHRnpjeUFtSmlCemRYQmxja05zWVhOekxuQnliM1J2ZEhsd1pTd2dlMXh1SUNBZ0lHTnZibk4wY25WamRHOXlPaUI3WEc0Z0lDQWdJQ0IyWVd4MVpUb2djM1ZpUTJ4aGMzTXNYRzRnSUNBZ0lDQmxiblZ0WlhKaFlteGxPaUJtWVd4elpTeGNiaUFnSUNBZ0lIZHlhWFJoWW14bE9pQjBjblZsTEZ4dUlDQWdJQ0FnWTI5dVptbG5kWEpoWW14bE9pQjBjblZsWEc0Z0lDQWdmVnh1SUNCOUtUdGNiaUFnYVdZZ0tITjFjR1Z5UTJ4aGMzTXBJRjl6WlhSUWNtOTBiM1I1Y0dWUFpqSXVaR1ZtWVhWc2RDQS9JQ2d3TENCZmMyVjBVSEp2ZEc5MGVYQmxUMll5TG1SbFptRjFiSFFwS0hOMVlrTnNZWE56TENCemRYQmxja05zWVhOektTQTZJSE4xWWtOc1lYTnpMbDlmY0hKdmRHOWZYeUE5SUhOMWNHVnlRMnhoYzNNN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJobGJIQmxjbk12YVc1b1pYSnBkSE11YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURNMFhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015SXNJbHdpZFhObElITjBjbWxqZEZ3aU8xeHVYRzVsZUhCdmNuUnpMbDlmWlhOTmIyUjFiR1VnUFNCMGNuVmxPMXh1WEc1MllYSWdYM1I1Y0dWdlpqSWdQU0J5WlhGMWFYSmxLRndpTGk0dmFHVnNjR1Z5Y3k5MGVYQmxiMlpjSWlrN1hHNWNiblpoY2lCZmRIbHdaVzltTXlBOUlGOXBiblJsY205d1VtVnhkV2x5WlVSbFptRjFiSFFvWDNSNWNHVnZaaklwTzF4dVhHNW1kVzVqZEdsdmJpQmZhVzUwWlhKdmNGSmxjWFZwY21WRVpXWmhkV3gwS0c5aWFpa2dleUJ5WlhSMWNtNGdiMkpxSUNZbUlHOWlhaTVmWDJWelRXOWtkV3hsSUQ4Z2IySnFJRG9nZXlCa1pXWmhkV3gwT2lCdlltb2dmVHNnZlZ4dVhHNWxlSEJ2Y25SekxtUmxabUYxYkhRZ1BTQm1kVzVqZEdsdmJpQW9jMlZzWml3Z1kyRnNiQ2tnZTF4dUlDQnBaaUFvSVhObGJHWXBJSHRjYmlBZ0lDQjBhSEp2ZHlCdVpYY2dVbVZtWlhKbGJtTmxSWEp5YjNJb1hDSjBhR2x6SUdoaGMyNG5kQ0JpWldWdUlHbHVhWFJwWVd4cGMyVmtJQzBnYzNWd1pYSW9LU0JvWVhOdUozUWdZbVZsYmlCallXeHNaV1JjSWlrN1hHNGdJSDFjYmx4dUlDQnlaWFIxY200Z1kyRnNiQ0FtSmlBb0tIUjVjR1Z2WmlCallXeHNJRDA5UFNCY0luVnVaR1ZtYVc1bFpGd2lJRDhnWENKMWJtUmxabWx1WldSY0lpQTZJQ2d3TENCZmRIbHdaVzltTXk1a1pXWmhkV3gwS1NoallXeHNLU2tnUFQwOUlGd2liMkpxWldOMFhDSWdmSHdnZEhsd1pXOW1JR05oYkd3Z1BUMDlJRndpWm5WdVkzUnBiMjVjSWlrZ1B5QmpZV3hzSURvZ2MyVnNaanRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJKaFltVnNMWEoxYm5ScGJXVXZhR1ZzY0dWeWN5OXdiM056YVdKc1pVTnZibk4wY25WamRHOXlVbVYwZFhKdUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXpOVnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENKeVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMlZ6Tmk1dlltcGxZM1F1WkdWbWFXNWxMWEJ5YjNCbGNuUjVKeWs3WEc1MllYSWdKRTlpYW1WamRDQTlJSEpsY1hWcGNtVW9KeTR1THk0dUwyMXZaSFZzWlhNdlgyTnZjbVVuS1M1UFltcGxZM1E3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1SUdSbFptbHVaVkJ5YjNCbGNuUjVLR2wwTENCclpYa3NJR1JsYzJNcGUxeHVJQ0J5WlhSMWNtNGdKRTlpYW1WamRDNWtaV1pwYm1WUWNtOXdaWEowZVNocGRDd2dhMlY1TENCa1pYTmpLVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzltYmk5dlltcGxZM1F2WkdWbWFXNWxMWEJ5YjNCbGNuUjVMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F6Tmx4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJRFlnTnlBNElEa2lMQ0l2THlBeE9TNHhMakl1TWlBdklERTFMakl1TXk0MUlFOWlhbVZqZEM1amNtVmhkR1VvVHlCYkxDQlFjbTl3WlhKMGFXVnpYU2xjYm5aaGNpQmhiazlpYW1WamRDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyRnVMVzlpYW1WamRDY3BYRzRnSUN3Z1pGQnpJQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0WkhCekp5bGNiaUFnTENCbGJuVnRRblZuUzJWNWN5QTlJSEpsY1hWcGNtVW9KeTR2WDJWdWRXMHRZblZuTFd0bGVYTW5LVnh1SUNBc0lFbEZYMUJTVDFSUElDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmMyaGhjbVZrTFd0bGVTY3BLQ2RKUlY5UVVrOVVUeWNwWEc0Z0lDd2dSVzF3ZEhrZ0lDQWdJQ0FnUFNCbWRXNWpkR2x2YmlncGV5QXZLaUJsYlhCMGVTQXFMeUI5WEc0Z0lDd2dVRkpQVkU5VVdWQkZJQ0FnUFNBbmNISnZkRzkwZVhCbEp6dGNibHh1THk4Z1EzSmxZWFJsSUc5aWFtVmpkQ0IzYVhSb0lHWmhhMlVnWUc1MWJHeGdJSEJ5YjNSdmRIbHdaVG9nZFhObElHbG1jbUZ0WlNCUFltcGxZM1FnZDJsMGFDQmpiR1ZoY21Wa0lIQnliM1J2ZEhsd1pWeHVkbUZ5SUdOeVpXRjBaVVJwWTNRZ1BTQm1kVzVqZEdsdmJpZ3BlMXh1SUNBdkx5QlVhSEpoYzJnc0lIZGhjM1JsSUdGdVpDQnpiMlJ2YlhrNklFbEZJRWRESUdKMVoxeHVJQ0IyWVhJZ2FXWnlZVzFsSUQwZ2NtVnhkV2x5WlNnbkxpOWZaRzl0TFdOeVpXRjBaU2NwS0NkcFpuSmhiV1VuS1Z4dUlDQWdJQ3dnYVNBZ0lDQWdJRDBnWlc1MWJVSjFaMHRsZVhNdWJHVnVaM1JvWEc0Z0lDQWdMQ0JzZENBZ0lDQWdQU0FuUENkY2JpQWdJQ0FzSUdkMElDQWdJQ0E5SUNjK0oxeHVJQ0FnSUN3Z2FXWnlZVzFsUkc5amRXMWxiblE3WEc0Z0lHbG1jbUZ0WlM1emRIbHNaUzVrYVhOd2JHRjVJRDBnSjI1dmJtVW5PMXh1SUNCeVpYRjFhWEpsS0NjdUwxOW9kRzFzSnlrdVlYQndaVzVrUTJocGJHUW9hV1p5WVcxbEtUdGNiaUFnYVdaeVlXMWxMbk55WXlBOUlDZHFZWFpoYzJOeWFYQjBPaWM3SUM4dklHVnpiR2x1ZEMxa2FYTmhZbXhsTFd4cGJtVWdibTh0YzJOeWFYQjBMWFZ5YkZ4dUlDQXZMeUJqY21WaGRHVkVhV04wSUQwZ2FXWnlZVzFsTG1OdmJuUmxiblJYYVc1a2IzY3VUMkpxWldOME8xeHVJQ0F2THlCb2RHMXNMbkpsYlc5MlpVTm9hV3hrS0dsbWNtRnRaU2s3WEc0Z0lHbG1jbUZ0WlVSdlkzVnRaVzUwSUQwZ2FXWnlZVzFsTG1OdmJuUmxiblJYYVc1a2IzY3VaRzlqZFcxbGJuUTdYRzRnSUdsbWNtRnRaVVJ2WTNWdFpXNTBMbTl3Wlc0b0tUdGNiaUFnYVdaeVlXMWxSRzlqZFcxbGJuUXVkM0pwZEdVb2JIUWdLeUFuYzJOeWFYQjBKeUFySUdkMElDc2dKMlJ2WTNWdFpXNTBMa1k5VDJKcVpXTjBKeUFySUd4MElDc2dKeTl6WTNKcGNIUW5JQ3NnWjNRcE8xeHVJQ0JwWm5KaGJXVkViMk4xYldWdWRDNWpiRzl6WlNncE8xeHVJQ0JqY21WaGRHVkVhV04wSUQwZ2FXWnlZVzFsUkc5amRXMWxiblF1Ump0Y2JpQWdkMmhwYkdVb2FTMHRLV1JsYkdWMFpTQmpjbVZoZEdWRWFXTjBXMUJTVDFSUFZGbFFSVjFiWlc1MWJVSjFaMHRsZVhOYmFWMWRPMXh1SUNCeVpYUjFjbTRnWTNKbFlYUmxSR2xqZENncE8xeHVmVHRjYmx4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCUFltcGxZM1F1WTNKbFlYUmxJSHg4SUdaMWJtTjBhVzl1SUdOeVpXRjBaU2hQTENCUWNtOXdaWEowYVdWektYdGNiaUFnZG1GeUlISmxjM1ZzZER0Y2JpQWdhV1lvVHlBaFBUMGdiblZzYkNsN1hHNGdJQ0FnUlcxd2RIbGJVRkpQVkU5VVdWQkZYU0E5SUdGdVQySnFaV04wS0U4cE8xeHVJQ0FnSUhKbGMzVnNkQ0E5SUc1bGR5QkZiWEIwZVR0Y2JpQWdJQ0JGYlhCMGVWdFFVazlVVDFSWlVFVmRJRDBnYm5Wc2JEdGNiaUFnSUNBdkx5QmhaR1FnWENKZlgzQnliM1J2WDE5Y0lpQm1iM0lnVDJKcVpXTjBMbWRsZEZCeWIzUnZkSGx3WlU5bUlIQnZiSGxtYVd4c1hHNGdJQ0FnY21WemRXeDBXMGxGWDFCU1QxUlBYU0E5SUU4N1hHNGdJSDBnWld4elpTQnlaWE4xYkhRZ1BTQmpjbVZoZEdWRWFXTjBLQ2s3WEc0Z0lISmxkSFZ5YmlCUWNtOXdaWEowYVdWeklEMDlQU0IxYm1SbFptbHVaV1FnUHlCeVpYTjFiSFFnT2lCa1VITW9jbVZ6ZFd4MExDQlFjbTl3WlhKMGFXVnpLVHRjYm4wN1hHNWNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDI5aWFtVmpkQzFqY21WaGRHVXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRE0zWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWlMQ0oyWVhJZ0pHVjRjRzl5ZENBOUlISmxjWFZwY21Vb0p5NHZYMlY0Y0c5eWRDY3BPMXh1THk4Z01Ua3VNUzR5TGpRZ0x5QXhOUzR5TGpNdU5pQlBZbXBsWTNRdVpHVm1hVzVsVUhKdmNHVnlkSGtvVHl3Z1VDd2dRWFIwY21saWRYUmxjeWxjYmlSbGVIQnZjblFvSkdWNGNHOXlkQzVUSUNzZ0pHVjRjRzl5ZEM1R0lDb2dJWEpsY1hWcGNtVW9KeTR2WDJSbGMyTnlhWEIwYjNKekp5a3NJQ2RQWW1wbFkzUW5MQ0I3WkdWbWFXNWxVSEp2Y0dWeWRIazZJSEpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzFrY0NjcExtWjlLVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNWtaV1pwYm1VdGNISnZjR1Z5ZEhrdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlETTRYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVZ05pQTNJRGdnT1NJc0lpZDFjMlVnYzNSeWFXTjBKenRjYm5aaGNpQk1TVUpTUVZKWklDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMnhwWW5KaGNua25LVnh1SUNBc0lDUmxlSEJ2Y25RZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZaWGh3YjNKMEp5bGNiaUFnTENCeVpXUmxabWx1WlNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzSmxaR1ZtYVc1bEp5bGNiaUFnTENCb2FXUmxJQ0FnSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyaHBaR1VuS1Z4dUlDQXNJR2hoY3lBZ0lDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYUdGekp5bGNiaUFnTENCSmRHVnlZWFJ2Y25NZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgybDBaWEpoZEc5eWN5Y3BYRzRnSUN3Z0pHbDBaWEpEY21WaGRHVWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXBkR1Z5TFdOeVpXRjBaU2NwWEc0Z0lDd2djMlYwVkc5VGRISnBibWRVWVdjZ1BTQnlaWEYxYVhKbEtDY3VMMTl6WlhRdGRHOHRjM1J5YVc1bkxYUmhaeWNwWEc0Z0lDd2daMlYwVUhKdmRHOTBlWEJsVDJZZ1BTQnlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRaM0J2SnlsY2JpQWdMQ0JKVkVWU1FWUlBVaUFnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDNkcmN5Y3BLQ2RwZEdWeVlYUnZjaWNwWEc0Z0lDd2dRbFZIUjFrZ0lDQWdJQ0FnSUNBZ1BTQWhLRnRkTG10bGVYTWdKaVlnSjI1bGVIUW5JR2x1SUZ0ZExtdGxlWE1vS1NrZ0x5OGdVMkZtWVhKcElHaGhjeUJpZFdkbmVTQnBkR1Z5WVhSdmNuTWdkeTl2SUdCdVpYaDBZRnh1SUNBc0lFWkdYMGxVUlZKQlZFOVNJQ0FnSUQwZ0owQkFhWFJsY21GMGIzSW5YRzRnSUN3Z1MwVlpVeUFnSUNBZ0lDQWdJQ0FnUFNBbmEyVjVjeWRjYmlBZ0xDQldRVXhWUlZNZ0lDQWdJQ0FnSUNBOUlDZDJZV3gxWlhNbk8xeHVYRzUyWVhJZ2NtVjBkWEp1VkdocGN5QTlJR1oxYm1OMGFXOXVLQ2w3SUhKbGRIVnliaUIwYUdsek95QjlPMXh1WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0VKaGMyVXNJRTVCVFVVc0lFTnZibk4wY25WamRHOXlMQ0J1WlhoMExDQkVSVVpCVlV4VUxDQkpVMTlUUlZRc0lFWlBVa05GUkNsN1hHNGdJQ1JwZEdWeVEzSmxZWFJsS0VOdmJuTjBjblZqZEc5eUxDQk9RVTFGTENCdVpYaDBLVHRjYmlBZ2RtRnlJR2RsZEUxbGRHaHZaQ0E5SUdaMWJtTjBhVzl1S0d0cGJtUXBlMXh1SUNBZ0lHbG1LQ0ZDVlVkSFdTQW1KaUJyYVc1a0lHbHVJSEJ5YjNSdktYSmxkSFZ5YmlCd2NtOTBiMXRyYVc1a1hUdGNiaUFnSUNCemQybDBZMmdvYTJsdVpDbDdYRzRnSUNBZ0lDQmpZWE5sSUV0RldWTTZJSEpsZEhWeWJpQm1kVzVqZEdsdmJpQnJaWGx6S0NsN0lISmxkSFZ5YmlCdVpYY2dRMjl1YzNSeWRXTjBiM0lvZEdocGN5d2dhMmx1WkNrN0lIMDdYRzRnSUNBZ0lDQmpZWE5sSUZaQlRGVkZVem9nY21WMGRYSnVJR1oxYm1OMGFXOXVJSFpoYkhWbGN5Z3BleUJ5WlhSMWNtNGdibVYzSUVOdmJuTjBjblZqZEc5eUtIUm9hWE1zSUd0cGJtUXBPeUI5TzF4dUlDQWdJSDBnY21WMGRYSnVJR1oxYm1OMGFXOXVJR1Z1ZEhKcFpYTW9LWHNnY21WMGRYSnVJRzVsZHlCRGIyNXpkSEoxWTNSdmNpaDBhR2x6TENCcmFXNWtLVHNnZlR0Y2JpQWdmVHRjYmlBZ2RtRnlJRlJCUnlBZ0lDQWdJQ0FnUFNCT1FVMUZJQ3NnSnlCSmRHVnlZWFJ2Y2lkY2JpQWdJQ0FzSUVSRlJsOVdRVXhWUlZNZ1BTQkVSVVpCVlV4VUlEMDlJRlpCVEZWRlUxeHVJQ0FnSUN3Z1ZrRk1WVVZUWDBKVlJ5QTlJR1poYkhObFhHNGdJQ0FnTENCd2NtOTBieUFnSUNBZ0lEMGdRbUZ6WlM1d2NtOTBiM1I1Y0dWY2JpQWdJQ0FzSUNSdVlYUnBkbVVnSUNBZ1BTQndjbTkwYjF0SlZFVlNRVlJQVWwwZ2ZId2djSEp2ZEc5YlJrWmZTVlJGVWtGVVQxSmRJSHg4SUVSRlJrRlZURlFnSmlZZ2NISnZkRzliUkVWR1FWVk1WRjFjYmlBZ0lDQXNJQ1JrWldaaGRXeDBJQ0FnUFNBa2JtRjBhWFpsSUh4OElHZGxkRTFsZEdodlpDaEVSVVpCVlV4VUtWeHVJQ0FnSUN3Z0pHVnVkSEpwWlhNZ0lDQTlJRVJGUmtGVlRGUWdQeUFoUkVWR1gxWkJURlZGVXlBL0lDUmtaV1poZFd4MElEb2daMlYwVFdWMGFHOWtLQ2RsYm5SeWFXVnpKeWtnT2lCMWJtUmxabWx1WldSY2JpQWdJQ0FzSUNSaGJubE9ZWFJwZG1VZ1BTQk9RVTFGSUQwOUlDZEJjbkpoZVNjZ1B5QndjbTkwYnk1bGJuUnlhV1Z6SUh4OElDUnVZWFJwZG1VZ09pQWtibUYwYVhabFhHNGdJQ0FnTENCdFpYUm9iMlJ6TENCclpYa3NJRWwwWlhKaGRHOXlVSEp2ZEc5MGVYQmxPMXh1SUNBdkx5QkdhWGdnYm1GMGFYWmxYRzRnSUdsbUtDUmhibmxPWVhScGRtVXBlMXh1SUNBZ0lFbDBaWEpoZEc5eVVISnZkRzkwZVhCbElEMGdaMlYwVUhKdmRHOTBlWEJsVDJZb0pHRnVlVTVoZEdsMlpTNWpZV3hzS0c1bGR5QkNZWE5sS1NrN1hHNGdJQ0FnYVdZb1NYUmxjbUYwYjNKUWNtOTBiM1I1Y0dVZ0lUMDlJRTlpYW1WamRDNXdjbTkwYjNSNWNHVXBlMXh1SUNBZ0lDQWdMeThnVTJWMElFQkFkRzlUZEhKcGJtZFVZV2NnZEc4Z2JtRjBhWFpsSUdsMFpYSmhkRzl5YzF4dUlDQWdJQ0FnYzJWMFZHOVRkSEpwYm1kVVlXY29TWFJsY21GMGIzSlFjbTkwYjNSNWNHVXNJRlJCUnl3Z2RISjFaU2s3WEc0Z0lDQWdJQ0F2THlCbWFYZ2dabTl5SUhOdmJXVWdiMnhrSUdWdVoybHVaWE5jYmlBZ0lDQWdJR2xtS0NGTVNVSlNRVkpaSUNZbUlDRm9ZWE1vU1hSbGNtRjBiM0pRY205MGIzUjVjR1VzSUVsVVJWSkJWRTlTS1Nsb2FXUmxLRWwwWlhKaGRHOXlVSEp2ZEc5MGVYQmxMQ0JKVkVWU1FWUlBVaXdnY21WMGRYSnVWR2hwY3lrN1hHNGdJQ0FnZlZ4dUlDQjlYRzRnSUM4dklHWnBlQ0JCY25KaGVTTjdkbUZzZFdWekxDQkFRR2wwWlhKaGRHOXlmUzV1WVcxbElHbHVJRlk0SUM4Z1JrWmNiaUFnYVdZb1JFVkdYMVpCVEZWRlV5QW1KaUFrYm1GMGFYWmxJQ1ltSUNSdVlYUnBkbVV1Ym1GdFpTQWhQVDBnVmtGTVZVVlRLWHRjYmlBZ0lDQldRVXhWUlZOZlFsVkhJRDBnZEhKMVpUdGNiaUFnSUNBa1pHVm1ZWFZzZENBOUlHWjFibU4wYVc5dUlIWmhiSFZsY3lncGV5QnlaWFIxY200Z0pHNWhkR2wyWlM1allXeHNLSFJvYVhNcE95QjlPMXh1SUNCOVhHNGdJQzh2SUVSbFptbHVaU0JwZEdWeVlYUnZjbHh1SUNCcFppZ29JVXhKUWxKQlVsa2dmSHdnUms5U1EwVkVLU0FtSmlBb1FsVkhSMWtnZkh3Z1ZrRk1WVVZUWDBKVlJ5QjhmQ0FoY0hKdmRHOWJTVlJGVWtGVVQxSmRLU2w3WEc0Z0lDQWdhR2xrWlNod2NtOTBieXdnU1ZSRlVrRlVUMUlzSUNSa1pXWmhkV3gwS1R0Y2JpQWdmVnh1SUNBdkx5QlFiSFZuSUdadmNpQnNhV0p5WVhKNVhHNGdJRWwwWlhKaGRHOXljMXRPUVUxRlhTQTlJQ1JrWldaaGRXeDBPMXh1SUNCSmRHVnlZWFJ2Y25OYlZFRkhYU0FnUFNCeVpYUjFjbTVVYUdsek8xeHVJQ0JwWmloRVJVWkJWVXhVS1h0Y2JpQWdJQ0J0WlhSb2IyUnpJRDBnZTF4dUlDQWdJQ0FnZG1Gc2RXVnpPaUFnUkVWR1gxWkJURlZGVXlBL0lDUmtaV1poZFd4MElEb2daMlYwVFdWMGFHOWtLRlpCVEZWRlV5a3NYRzRnSUNBZ0lDQnJaWGx6T2lBZ0lDQkpVMTlUUlZRZ0lDQWdJRDhnSkdSbFptRjFiSFFnT2lCblpYUk5aWFJvYjJRb1MwVlpVeWtzWEc0Z0lDQWdJQ0JsYm5SeWFXVnpPaUFrWlc1MGNtbGxjMXh1SUNBZ0lIMDdYRzRnSUNBZ2FXWW9SazlTUTBWRUtXWnZjaWhyWlhrZ2FXNGdiV1YwYUc5a2N5bDdYRzRnSUNBZ0lDQnBaaWdoS0d0bGVTQnBiaUJ3Y205MGJ5a3BjbVZrWldacGJtVW9jSEp2ZEc4c0lHdGxlU3dnYldWMGFHOWtjMXRyWlhsZEtUdGNiaUFnSUNCOUlHVnNjMlVnSkdWNGNHOXlkQ2drWlhod2IzSjBMbEFnS3lBa1pYaHdiM0owTGtZZ0tpQW9RbFZIUjFrZ2ZId2dWa0ZNVlVWVFgwSlZSeWtzSUU1QlRVVXNJRzFsZEdodlpITXBPMXh1SUNCOVhHNGdJSEpsZEhWeWJpQnRaWFJvYjJSek8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgybDBaWEl0WkdWbWFXNWxMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F6T1Z4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpYlc5a2RXeGxMbVY0Y0c5eWRITWdQU0I3SUZ3aVpHVm1ZWFZzZEZ3aU9pQnlaWEYxYVhKbEtGd2lZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMnB6YjI0dmMzUnlhVzVuYVdaNVhDSXBMQ0JmWDJWelRXOWtkV3hsT2lCMGNuVmxJSDA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMkpoWW1Wc0xYSjFiblJwYldVdlkyOXlaUzFxY3k5cWMyOXVMM04wY21sdVoybG1lUzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTkRCY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0EySWl3aVpYaHdiM0owY3k1bUlEMGdlMzB1Y0hKdmNHVnlkSGxKYzBWdWRXMWxjbUZpYkdVN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl2WW1wbFkzUXRjR2xsTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBME1WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWlMQ0p0YjJSMWJHVXVaWGh3YjNKMGN5QTlJSEpsY1hWcGNtVW9KeTR2WDJkc2IySmhiQ2NwTG1SdlkzVnRaVzUwSUNZbUlHUnZZM1Z0Wlc1MExtUnZZM1Z0Wlc1MFJXeGxiV1Z1ZER0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMmgwYld3dWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEUXlYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSXZMeUF4T1M0eExqSXVPU0F2SURFMUxqSXVNeTR5SUU5aWFtVmpkQzVuWlhSUWNtOTBiM1I1Y0dWUFppaFBLVnh1ZG1GeUlHaGhjeUFnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmFHRnpKeWxjYmlBZ0xDQjBiMDlpYW1WamRDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzUnZMVzlpYW1WamRDY3BYRzRnSUN3Z1NVVmZVRkpQVkU4Z0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5emFHRnlaV1F0YTJWNUp5a29KMGxGWDFCU1QxUlBKeWxjYmlBZ0xDQlBZbXBsWTNSUWNtOTBieUE5SUU5aWFtVmpkQzV3Y205MGIzUjVjR1U3WEc1Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1QySnFaV04wTG1kbGRGQnliM1J2ZEhsd1pVOW1JSHg4SUdaMWJtTjBhVzl1S0U4cGUxeHVJQ0JQSUQwZ2RHOVBZbXBsWTNRb1R5azdYRzRnSUdsbUtHaGhjeWhQTENCSlJWOVFVazlVVHlrcGNtVjBkWEp1SUU5YlNVVmZVRkpQVkU5ZE8xeHVJQ0JwWmloMGVYQmxiMllnVHk1amIyNXpkSEoxWTNSdmNpQTlQU0FuWm5WdVkzUnBiMjRuSUNZbUlFOGdhVzV6ZEdGdVkyVnZaaUJQTG1OdmJuTjBjblZqZEc5eUtYdGNiaUFnSUNCeVpYUjFjbTRnVHk1amIyNXpkSEoxWTNSdmNpNXdjbTkwYjNSNWNHVTdYRzRnSUgwZ2NtVjBkWEp1SUU4Z2FXNXpkR0Z1WTJWdlppQlBZbXBsWTNRZ1B5QlBZbXBsWTNSUWNtOTBieUE2SUc1MWJHdzdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZiMkpxWldOMExXZHdieTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTkROY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSW5aaGNpQm9ZWE1nSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOW9ZWE1uS1Z4dUlDQXNJSFJ2U1U5aWFtVmpkQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYM1J2TFdsdlltcGxZM1FuS1Z4dUlDQXNJR0Z5Y21GNVNXNWtaWGhQWmlBOUlISmxjWFZwY21Vb0p5NHZYMkZ5Y21GNUxXbHVZMngxWkdWekp5a29abUZzYzJVcFhHNGdJQ3dnU1VWZlVGSlBWRThnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYzJoaGNtVmtMV3RsZVNjcEtDZEpSVjlRVWs5VVR5Y3BPMXh1WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0c5aWFtVmpkQ3dnYm1GdFpYTXBlMXh1SUNCMllYSWdUeUFnSUNBZ0lEMGdkRzlKVDJKcVpXTjBLRzlpYW1WamRDbGNiaUFnSUNBc0lHa2dJQ0FnSUNBOUlEQmNiaUFnSUNBc0lISmxjM1ZzZENBOUlGdGRYRzRnSUNBZ0xDQnJaWGs3WEc0Z0lHWnZjaWhyWlhrZ2FXNGdUeWxwWmloclpYa2dJVDBnU1VWZlVGSlBWRThwYUdGektFOHNJR3RsZVNrZ0ppWWdjbVZ6ZFd4MExuQjFjMmdvYTJWNUtUdGNiaUFnTHk4Z1JHOXVKM1FnWlc1MWJTQmlkV2NnSmlCb2FXUmtaVzRnYTJWNWMxeHVJQ0IzYUdsc1pTaHVZVzFsY3k1c1pXNW5kR2dnUGlCcEtXbG1LR2hoY3loUExDQnJaWGtnUFNCdVlXMWxjMXRwS3l0ZEtTbDdYRzRnSUNBZ2ZtRnljbUY1U1c1a1pYaFBaaWh5WlhOMWJIUXNJR3RsZVNrZ2ZId2djbVZ6ZFd4MExuQjFjMmdvYTJWNUtUdGNiaUFnZlZ4dUlDQnlaWFIxY200Z2NtVnpkV3gwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDI5aWFtVmpkQzFyWlhsekxXbHVkR1Z5Ym1Gc0xtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTBORnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlpd2lMeThnYlc5emRDQlBZbXBsWTNRZ2JXVjBhRzlrY3lCaWVTQkZVellnYzJodmRXeGtJR0ZqWTJWd2RDQndjbWx0YVhScGRtVnpYRzUyWVhJZ0pHVjRjRzl5ZENBOUlISmxjWFZwY21Vb0p5NHZYMlY0Y0c5eWRDY3BYRzRnSUN3Z1kyOXlaU0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMk52Y21VbktWeHVJQ0FzSUdaaGFXeHpJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOW1ZV2xzY3ljcE8xeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpaExSVmtzSUdWNFpXTXBlMXh1SUNCMllYSWdabTRnSUQwZ0tHTnZjbVV1VDJKcVpXTjBJSHg4SUh0OUtWdExSVmxkSUh4OElFOWlhbVZqZEZ0TFJWbGRYRzRnSUNBZ0xDQmxlSEFnUFNCN2ZUdGNiaUFnWlhod1cwdEZXVjBnUFNCbGVHVmpLR1p1S1R0Y2JpQWdKR1Y0Y0c5eWRDZ2taWGh3YjNKMExsTWdLeUFrWlhod2IzSjBMa1lnS2lCbVlXbHNjeWhtZFc1amRHbHZiaWdwZXlCbWJpZ3hLVHNnZlNrc0lDZFBZbXBsWTNRbkxDQmxlSEFwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDI5aWFtVmpkQzF6WVhBdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEUTFYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSnRiMlIxYkdVdVpYaHdiM0owY3lBOUlISmxjWFZwY21Vb0p5NHZYMmhwWkdVbktUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDNKbFpHVm1hVzVsTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBME5seHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSWl3aUx5OGdOeTR4TGpFMUlGUnZUR1Z1WjNSb1hHNTJZWElnZEc5SmJuUmxaMlZ5SUQwZ2NtVnhkV2x5WlNnbkxpOWZkRzh0YVc1MFpXZGxjaWNwWEc0Z0lDd2diV2x1SUNBZ0lDQWdJRDBnVFdGMGFDNXRhVzQ3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0dsMEtYdGNiaUFnY21WMGRYSnVJR2wwSUQ0Z01DQS9JRzFwYmloMGIwbHVkR1ZuWlhJb2FYUXBMQ0F3ZURGbVptWm1abVptWm1abVptWm1LU0E2SURBN0lDOHZJSEJ2ZHlneUxDQTFNeWtnTFNBeElEMDlJRGt3TURjeE9Ua3lOVFEzTkRBNU9URmNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOTBieTFzWlc1bmRHZ3Vhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRFEzWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWlMQ0oyWVhJZ1oyeHZZbUZzSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOW5iRzlpWVd3bktWeHVJQ0FzSUdOdmNtVWdJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZlkyOXlaU2NwWEc0Z0lDd2dURWxDVWtGU1dTQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlzYVdKeVlYSjVKeWxjYmlBZ0xDQjNhM05GZUhRZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYM2RyY3kxbGVIUW5LVnh1SUNBc0lHUmxabWx1WlZCeWIzQmxjblI1SUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXUndKeWt1Wmp0Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b2JtRnRaU2w3WEc0Z0lIWmhjaUFrVTNsdFltOXNJRDBnWTI5eVpTNVRlVzFpYjJ3Z2ZId2dLR052Y21VdVUzbHRZbTlzSUQwZ1RFbENVa0ZTV1NBL0lIdDlJRG9nWjJ4dlltRnNMbE41YldKdmJDQjhmQ0I3ZlNrN1hHNGdJR2xtS0c1aGJXVXVZMmhoY2tGMEtEQXBJQ0U5SUNkZkp5QW1KaUFoS0c1aGJXVWdhVzRnSkZONWJXSnZiQ2twWkdWbWFXNWxVSEp2Y0dWeWRIa29KRk41YldKdmJDd2dibUZ0WlN3Z2UzWmhiSFZsT2lCM2EzTkZlSFF1WmlodVlXMWxLWDBwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDNkcmN5MWtaV1pwYm1VdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEUTRYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUlzSW1WNGNHOXlkSE11WmlBOUlISmxjWFZwY21Vb0p5NHZYM2RyY3ljcE8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmZDJ0ekxXVjRkQzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTkRsY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklpd2lKM1Z6WlNCemRISnBZM1FuTzF4dWRtRnlJQ1JoZENBZ1BTQnlaWEYxYVhKbEtDY3VMMTl6ZEhKcGJtY3RZWFFuS1NoMGNuVmxLVHRjYmx4dUx5OGdNakV1TVM0ekxqSTNJRk4wY21sdVp5NXdjbTkwYjNSNWNHVmJRRUJwZEdWeVlYUnZjbDBvS1Z4dWNtVnhkV2x5WlNnbkxpOWZhWFJsY2kxa1pXWnBibVVuS1NoVGRISnBibWNzSUNkVGRISnBibWNuTENCbWRXNWpkR2x2YmlocGRHVnlZWFJsWkNsN1hHNGdJSFJvYVhNdVgzUWdQU0JUZEhKcGJtY29hWFJsY21GMFpXUXBPeUF2THlCMFlYSm5aWFJjYmlBZ2RHaHBjeTVmYVNBOUlEQTdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDOHZJRzVsZUhRZ2FXNWtaWGhjYmk4dklESXhMakV1TlM0eUxqRWdKVk4wY21sdVowbDBaWEpoZEc5eVVISnZkRzkwZVhCbEpTNXVaWGgwS0NsY2JuMHNJR1oxYm1OMGFXOXVLQ2w3WEc0Z0lIWmhjaUJQSUNBZ0lDQTlJSFJvYVhNdVgzUmNiaUFnSUNBc0lHbHVaR1Y0SUQwZ2RHaHBjeTVmYVZ4dUlDQWdJQ3dnY0c5cGJuUTdYRzRnSUdsbUtHbHVaR1Y0SUQ0OUlFOHViR1Z1WjNSb0tYSmxkSFZ5YmlCN2RtRnNkV1U2SUhWdVpHVm1hVzVsWkN3Z1pHOXVaVG9nZEhKMVpYMDdYRzRnSUhCdmFXNTBJRDBnSkdGMEtFOHNJR2x1WkdWNEtUdGNiaUFnZEdocGN5NWZhU0FyUFNCd2IybHVkQzVzWlc1bmRHZzdYRzRnSUhKbGRIVnliaUI3ZG1Gc2RXVTZJSEJ2YVc1MExDQmtiMjVsT2lCbVlXeHpaWDA3WEc1OUtUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNMkxuTjBjbWx1Wnk1cGRHVnlZWFJ2Y2k1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ05UQmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0luSmxjWFZwY21Vb0p5NHZaWE0yTG1GeWNtRjVMbWwwWlhKaGRHOXlKeWs3WEc1MllYSWdaMnh2WW1Gc0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMmRzYjJKaGJDY3BYRzRnSUN3Z2FHbGtaU0FnSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyaHBaR1VuS1Z4dUlDQXNJRWwwWlhKaGRHOXljeUFnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlwZEdWeVlYUnZjbk1uS1Z4dUlDQXNJRlJQWDFOVVVrbE9SMTlVUVVjZ1BTQnlaWEYxYVhKbEtDY3VMMTkzYTNNbktTZ25kRzlUZEhKcGJtZFVZV2NuS1R0Y2JseHVabTl5S0haaGNpQmpiMnhzWldOMGFXOXVjeUE5SUZzblRtOWtaVXhwYzNRbkxDQW5SRTlOVkc5clpXNU1hWE4wSnl3Z0owMWxaR2xoVEdsemRDY3NJQ2RUZEhsc1pWTm9aV1YwVEdsemRDY3NJQ2REVTFOU2RXeGxUR2x6ZENkZExDQnBJRDBnTURzZ2FTQThJRFU3SUdrckt5bDdYRzRnSUhaaGNpQk9RVTFGSUNBZ0lDQWdJRDBnWTI5c2JHVmpkR2x2Ym5OYmFWMWNiaUFnSUNBc0lFTnZiR3hsWTNScGIyNGdQU0JuYkc5aVlXeGJUa0ZOUlYxY2JpQWdJQ0FzSUhCeWIzUnZJQ0FnSUNBZ1BTQkRiMnhzWldOMGFXOXVJQ1ltSUVOdmJHeGxZM1JwYjI0dWNISnZkRzkwZVhCbE8xeHVJQ0JwWmlod2NtOTBieUFtSmlBaGNISnZkRzliVkU5ZlUxUlNTVTVIWDFSQlIxMHBhR2xrWlNod2NtOTBieXdnVkU5ZlUxUlNTVTVIWDFSQlJ5d2dUa0ZOUlNrN1hHNGdJRWwwWlhKaGRHOXljMXRPUVUxRlhTQTlJRWwwWlhKaGRHOXljeTVCY25KaGVUdGNibjFjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdmQyVmlMbVJ2YlM1cGRHVnlZV0pzWlM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ05URmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0luWmhjaUJqYjNKbElDQTlJSEpsY1hWcGNtVW9KeTR1THk0dUwyMXZaSFZzWlhNdlgyTnZjbVVuS1Z4dUlDQXNJQ1JLVTA5T0lEMGdZMjl5WlM1S1UwOU9JSHg4SUNoamIzSmxMa3BUVDA0Z1BTQjdjM1J5YVc1bmFXWjVPaUJLVTA5T0xuTjBjbWx1WjJsbWVYMHBPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaUJ6ZEhKcGJtZHBabmtvYVhRcGV5QXZMeUJsYzJ4cGJuUXRaR2x6WVdKc1pTMXNhVzVsSUc1dkxYVnVkWE5sWkMxMllYSnpYRzRnSUhKbGRIVnliaUFrU2xOUFRpNXpkSEpwYm1kcFpua3VZWEJ3Ykhrb0pFcFRUMDRzSUdGeVozVnRaVzUwY3lrN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdlptNHZhbk52Ymk5emRISnBibWRwWm5rdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEVXpYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVZ05pSXNJaTh2SUdkbGRIUnBibWNnZEdGbklHWnliMjBnTVRrdU1TNHpMallnVDJKcVpXTjBMbkJ5YjNSdmRIbHdaUzUwYjFOMGNtbHVaeWdwWEc1MllYSWdZMjltSUQwZ2NtVnhkV2x5WlNnbkxpOWZZMjltSnlsY2JpQWdMQ0JVUVVjZ1BTQnlaWEYxYVhKbEtDY3VMMTkzYTNNbktTZ25kRzlUZEhKcGJtZFVZV2NuS1Z4dUlDQXZMeUJGVXpNZ2QzSnZibWNnYUdWeVpWeHVJQ0FzSUVGU1J5QTlJR052WmlobWRXNWpkR2x2YmlncGV5QnlaWFIxY200Z1lYSm5kVzFsYm5Sek95QjlLQ2twSUQwOUlDZEJjbWQxYldWdWRITW5PMXh1WEc0dkx5Qm1ZV3hzWW1GamF5Qm1iM0lnU1VVeE1TQlRZM0pwY0hRZ1FXTmpaWE56SUVSbGJtbGxaQ0JsY25KdmNseHVkbUZ5SUhSeWVVZGxkQ0E5SUdaMWJtTjBhVzl1S0dsMExDQnJaWGtwZTF4dUlDQjBjbmtnZTF4dUlDQWdJSEpsZEhWeWJpQnBkRnRyWlhsZE8xeHVJQ0I5SUdOaGRHTm9LR1VwZXlBdktpQmxiWEIwZVNBcUx5QjlYRzU5TzF4dVhHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHbDBLWHRjYmlBZ2RtRnlJRThzSUZRc0lFSTdYRzRnSUhKbGRIVnliaUJwZENBOVBUMGdkVzVrWldacGJtVmtJRDhnSjFWdVpHVm1hVzVsWkNjZ09pQnBkQ0E5UFQwZ2JuVnNiQ0EvSUNkT2RXeHNKMXh1SUNBZ0lDOHZJRUJBZEc5VGRISnBibWRVWVdjZ1kyRnpaVnh1SUNBZ0lEb2dkSGx3Wlc5bUlDaFVJRDBnZEhKNVIyVjBLRThnUFNCUFltcGxZM1FvYVhRcExDQlVRVWNwS1NBOVBTQW5jM1J5YVc1bkp5QS9JRlJjYmlBZ0lDQXZMeUJpZFdsc2RHbHVWR0ZuSUdOaGMyVmNiaUFnSUNBNklFRlNSeUEvSUdOdlppaFBLVnh1SUNBZ0lDOHZJRVZUTXlCaGNtZDFiV1Z1ZEhNZ1ptRnNiR0poWTJ0Y2JpQWdJQ0E2SUNoQ0lEMGdZMjltS0U4cEtTQTlQU0FuVDJKcVpXTjBKeUFtSmlCMGVYQmxiMllnVHk1allXeHNaV1VnUFQwZ0oyWjFibU4wYVc5dUp5QS9JQ2RCY21kMWJXVnVkSE1uSURvZ1FqdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWpiR0Z6YzI5bUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTFOVnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQTBJRFVpTENJdkx5Qm1ZV3hzWW1GamF5Qm1iM0lnYm05dUxXRnljbUY1TFd4cGEyVWdSVk16SUdGdVpDQnViMjR0Wlc1MWJXVnlZV0pzWlNCdmJHUWdWamdnYzNSeWFXNW5jMXh1ZG1GeUlHTnZaaUE5SUhKbGNYVnBjbVVvSnk0dlgyTnZaaWNwTzF4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCUFltcGxZM1FvSjNvbktTNXdjbTl3WlhKMGVVbHpSVzUxYldWeVlXSnNaU2d3S1NBL0lFOWlhbVZqZENBNklHWjFibU4wYVc5dUtHbDBLWHRjYmlBZ2NtVjBkWEp1SUdOdlppaHBkQ2tnUFQwZ0oxTjBjbWx1WnljZ1B5QnBkQzV6Y0d4cGRDZ25KeWtnT2lCUFltcGxZM1FvYVhRcE8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgybHZZbXBsWTNRdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEVTJYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSjJZWElnY0VsRklDQWdJQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0Y0dsbEp5bGNiaUFnTENCamNtVmhkR1ZFWlhOaklDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzQnliM0JsY25SNUxXUmxjMk1uS1Z4dUlDQXNJSFJ2U1U5aWFtVmpkQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZEc4dGFXOWlhbVZqZENjcFhHNGdJQ3dnZEc5UWNtbHRhWFJwZG1VZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXdjbWx0YVhScGRtVW5LVnh1SUNBc0lHaGhjeUFnSUNBZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZhR0Z6SnlsY2JpQWdMQ0JKUlRoZlJFOU5YMFJGUmtsT1JTQTlJSEpsY1hWcGNtVW9KeTR2WDJsbE9DMWtiMjB0WkdWbWFXNWxKeWxjYmlBZ0xDQm5UMUJFSUNBZ0lDQWdJQ0FnSUNBOUlFOWlhbVZqZEM1blpYUlBkMjVRY205d1pYSjBlVVJsYzJOeWFYQjBiM0k3WEc1Y2JtVjRjRzl5ZEhNdVppQTlJSEpsY1hWcGNtVW9KeTR2WDJSbGMyTnlhWEIwYjNKekp5a2dQeUJuVDFCRUlEb2dablZ1WTNScGIyNGdaMlYwVDNkdVVISnZjR1Z5ZEhsRVpYTmpjbWx3ZEc5eUtFOHNJRkFwZTF4dUlDQlBJRDBnZEc5SlQySnFaV04wS0U4cE8xeHVJQ0JRSUQwZ2RHOVFjbWx0YVhScGRtVW9VQ3dnZEhKMVpTazdYRzRnSUdsbUtFbEZPRjlFVDAxZlJFVkdTVTVGS1hSeWVTQjdYRzRnSUNBZ2NtVjBkWEp1SUdkUFVFUW9UeXdnVUNrN1hHNGdJSDBnWTJGMFkyZ29aU2w3SUM4cUlHVnRjSFI1SUNvdklIMWNiaUFnYVdZb2FHRnpLRThzSUZBcEtYSmxkSFZ5YmlCamNtVmhkR1ZFWlhOaktDRndTVVV1Wmk1allXeHNLRThzSUZBcExDQlBXMUJkS1R0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5dlltcGxZM1F0WjI5d1pDNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdOVGRjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SWl3aVpYaHdiM0owY3k1bUlEMGdUMkpxWldOMExtZGxkRTkzYmxCeWIzQmxjblI1VTNsdFltOXNjenRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyOWlhbVZqZEMxbmIzQnpMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0ExT0Z4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNaUxDSmNJblZ6WlNCemRISnBZM1JjSWp0Y2JseHVaWGh3YjNKMGN5NWZYMlZ6VFc5a2RXeGxJRDBnZEhKMVpUdGNibHh1ZG1GeUlGOXBkR1Z5WVhSdmNpQTlJSEpsY1hWcGNtVW9YQ0l1TGk5amIzSmxMV3B6TDNONWJXSnZiQzlwZEdWeVlYUnZjbHdpS1R0Y2JseHVkbUZ5SUY5cGRHVnlZWFJ2Y2pJZ1BTQmZhVzUwWlhKdmNGSmxjWFZwY21WRVpXWmhkV3gwS0Y5cGRHVnlZWFJ2Y2lrN1hHNWNiblpoY2lCZmMzbHRZbTlzSUQwZ2NtVnhkV2x5WlNoY0lpNHVMMk52Y21VdGFuTXZjM2x0WW05c1hDSXBPMXh1WEc1MllYSWdYM041YldKdmJESWdQU0JmYVc1MFpYSnZjRkpsY1hWcGNtVkVaV1poZFd4MEtGOXplVzFpYjJ3cE8xeHVYRzUyWVhJZ1gzUjVjR1Z2WmlBOUlIUjVjR1Z2WmlCZmMzbHRZbTlzTWk1a1pXWmhkV3gwSUQwOVBTQmNJbVoxYm1OMGFXOXVYQ0lnSmlZZ2RIbHdaVzltSUY5cGRHVnlZWFJ2Y2pJdVpHVm1ZWFZzZENBOVBUMGdYQ0p6ZVcxaWIyeGNJaUEvSUdaMWJtTjBhVzl1SUNodlltb3BJSHNnY21WMGRYSnVJSFI1Y0dWdlppQnZZbW83SUgwZ09pQm1kVzVqZEdsdmJpQW9iMkpxS1NCN0lISmxkSFZ5YmlCdlltb2dKaVlnZEhsd1pXOW1JRjl6ZVcxaWIyd3lMbVJsWm1GMWJIUWdQVDA5SUZ3aVpuVnVZM1JwYjI1Y0lpQW1KaUJ2WW1vdVkyOXVjM1J5ZFdOMGIzSWdQVDA5SUY5emVXMWliMnd5TG1SbFptRjFiSFFnSmlZZ2IySnFJQ0U5UFNCZmMzbHRZbTlzTWk1a1pXWmhkV3gwTG5CeWIzUnZkSGx3WlNBL0lGd2ljM2x0WW05c1hDSWdPaUIwZVhCbGIyWWdiMkpxT3lCOU8xeHVYRzVtZFc1amRHbHZiaUJmYVc1MFpYSnZjRkpsY1hWcGNtVkVaV1poZFd4MEtHOWlhaWtnZXlCeVpYUjFjbTRnYjJKcUlDWW1JRzlpYWk1ZlgyVnpUVzlrZFd4bElEOGdiMkpxSURvZ2V5QmtaV1poZFd4ME9pQnZZbW9nZlRzZ2ZWeHVYRzVsZUhCdmNuUnpMbVJsWm1GMWJIUWdQU0IwZVhCbGIyWWdYM041YldKdmJESXVaR1ZtWVhWc2RDQTlQVDBnWENKbWRXNWpkR2x2Ymx3aUlDWW1JRjkwZVhCbGIyWW9YMmwwWlhKaGRHOXlNaTVrWldaaGRXeDBLU0E5UFQwZ1hDSnplVzFpYjJ4Y0lpQS9JR1oxYm1OMGFXOXVJQ2h2WW1vcElIdGNiaUFnY21WMGRYSnVJSFI1Y0dWdlppQnZZbW9nUFQwOUlGd2lkVzVrWldacGJtVmtYQ0lnUHlCY0luVnVaR1ZtYVc1bFpGd2lJRG9nWDNSNWNHVnZaaWh2WW1vcE8xeHVmU0E2SUdaMWJtTjBhVzl1SUNodlltb3BJSHRjYmlBZ2NtVjBkWEp1SUc5aWFpQW1KaUIwZVhCbGIyWWdYM041YldKdmJESXVaR1ZtWVhWc2RDQTlQVDBnWENKbWRXNWpkR2x2Ymx3aUlDWW1JRzlpYWk1amIyNXpkSEoxWTNSdmNpQTlQVDBnWDNONWJXSnZiREl1WkdWbVlYVnNkQ0FtSmlCdlltb2dJVDA5SUY5emVXMWliMnd5TG1SbFptRjFiSFF1Y0hKdmRHOTBlWEJsSUQ4Z1hDSnplVzFpYjJ4Y0lpQTZJSFI1Y0dWdlppQnZZbW9nUFQwOUlGd2lkVzVrWldacGJtVmtYQ0lnUHlCY0luVnVaR1ZtYVc1bFpGd2lJRG9nWDNSNWNHVnZaaWh2WW1vcE8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZbUZpWld3dGNuVnVkR2x0WlM5b1pXeHdaWEp6TDNSNWNHVnZaaTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTlRsY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklpd2liVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpZ3BleUF2S2lCbGJYQjBlU0FxTHlCOU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWVdSa0xYUnZMWFZ1YzJOdmNHRmliR1Z6TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBMk1GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSWl3aUx5OGdabUZzYzJVZ0xUNGdRWEp5WVhramFXNWtaWGhQWmx4dUx5OGdkSEoxWlNBZ0xUNGdRWEp5WVhramFXNWpiSFZrWlhOY2JuWmhjaUIwYjBsUFltcGxZM1FnUFNCeVpYRjFhWEpsS0NjdUwxOTBieTFwYjJKcVpXTjBKeWxjYmlBZ0xDQjBiMHhsYm1kMGFDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXNaVzVuZEdnbktWeHVJQ0FzSUhSdlNXNWtaWGdnSUNBOUlISmxjWFZwY21Vb0p5NHZYM1J2TFdsdVpHVjRKeWs3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0VsVFgwbE9RMHhWUkVWVEtYdGNiaUFnY21WMGRYSnVJR1oxYm1OMGFXOXVLQ1IwYUdsekxDQmxiQ3dnWm5KdmJVbHVaR1Y0S1h0Y2JpQWdJQ0IyWVhJZ1R5QWdJQ0FnSUQwZ2RHOUpUMkpxWldOMEtDUjBhR2x6S1Z4dUlDQWdJQ0FnTENCc1pXNW5kR2dnUFNCMGIweGxibWQwYUNoUExteGxibWQwYUNsY2JpQWdJQ0FnSUN3Z2FXNWtaWGdnSUQwZ2RHOUpibVJsZUNobWNtOXRTVzVrWlhnc0lHeGxibWQwYUNsY2JpQWdJQ0FnSUN3Z2RtRnNkV1U3WEc0Z0lDQWdMeThnUVhKeVlYa2phVzVqYkhWa1pYTWdkWE5sY3lCVFlXMWxWbUZzZFdWYVpYSnZJR1Z4ZFdGc2FYUjVJR0ZzWjI5eWFYUm9iVnh1SUNBZ0lHbG1LRWxUWDBsT1EweFZSRVZUSUNZbUlHVnNJQ0U5SUdWc0tYZG9hV3hsS0d4bGJtZDBhQ0ErSUdsdVpHVjRLWHRjYmlBZ0lDQWdJSFpoYkhWbElEMGdUMXRwYm1SbGVDc3JYVHRjYmlBZ0lDQWdJR2xtS0haaGJIVmxJQ0U5SUhaaGJIVmxLWEpsZEhWeWJpQjBjblZsTzF4dUlDQWdJQzh2SUVGeWNtRjVJM1J2U1c1a1pYZ2dhV2R1YjNKbGN5Qm9iMnhsY3l3Z1FYSnlZWGtqYVc1amJIVmtaWE1nTFNCdWIzUmNiaUFnSUNCOUlHVnNjMlVnWm05eUtEdHNaVzVuZEdnZ1BpQnBibVJsZURzZ2FXNWtaWGdyS3lscFppaEpVMTlKVGtOTVZVUkZVeUI4ZkNCcGJtUmxlQ0JwYmlCUEtYdGNiaUFnSUNBZ0lHbG1LRTliYVc1a1pYaGRJRDA5UFNCbGJDbHlaWFIxY200Z1NWTmZTVTVEVEZWRVJWTWdmSHdnYVc1a1pYZ2dmSHdnTUR0Y2JpQWdJQ0I5SUhKbGRIVnliaUFoU1ZOZlNVNURURlZFUlZNZ0ppWWdMVEU3WEc0Z0lIMDdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZWEp5WVhrdGFXNWpiSFZrWlhNdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEWXhYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSW5kWE5sSUhOMGNtbGpkQ2M3WEc1MllYSWdZM0psWVhSbElDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRZM0psWVhSbEp5bGNiaUFnTENCa1pYTmpjbWx3ZEc5eUlDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzQnliM0JsY25SNUxXUmxjMk1uS1Z4dUlDQXNJSE5sZEZSdlUzUnlhVzVuVkdGbklEMGdjbVZ4ZFdseVpTZ25MaTlmYzJWMExYUnZMWE4wY21sdVp5MTBZV2NuS1Z4dUlDQXNJRWwwWlhKaGRHOXlVSEp2ZEc5MGVYQmxJRDBnZTMwN1hHNWNiaTh2SURJMUxqRXVNaTR4TGpFZ0pVbDBaWEpoZEc5eVVISnZkRzkwZVhCbEpWdEFRR2wwWlhKaGRHOXlYU2dwWEc1eVpYRjFhWEpsS0NjdUwxOW9hV1JsSnlrb1NYUmxjbUYwYjNKUWNtOTBiM1I1Y0dVc0lISmxjWFZwY21Vb0p5NHZYM2RyY3ljcEtDZHBkR1Z5WVhSdmNpY3BMQ0JtZFc1amRHbHZiaWdwZXlCeVpYUjFjbTRnZEdocGN6c2dmU2s3WEc1Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b1EyOXVjM1J5ZFdOMGIzSXNJRTVCVFVVc0lHNWxlSFFwZTF4dUlDQkRiMjV6ZEhKMVkzUnZjaTV3Y205MGIzUjVjR1VnUFNCamNtVmhkR1VvU1hSbGNtRjBiM0pRY205MGIzUjVjR1VzSUh0dVpYaDBPaUJrWlhOamNtbHdkRzl5S0RFc0lHNWxlSFFwZlNrN1hHNGdJSE5sZEZSdlUzUnlhVzVuVkdGbktFTnZibk4wY25WamRHOXlMQ0JPUVUxRklDc2dKeUJKZEdWeVlYUnZjaWNwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJsMFpYSXRZM0psWVhSbExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTJNbHh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlpd2liVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpaGtiMjVsTENCMllXeDFaU2w3WEc0Z0lISmxkSFZ5YmlCN2RtRnNkV1U2SUhaaGJIVmxMQ0JrYjI1bE9pQWhJV1J2Ym1WOU8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgybDBaWEl0YzNSbGNDNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdOak5jYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TSXNJblpoY2lCa1VDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMWtjQ2NwWEc0Z0lDd2dZVzVQWW1wbFkzUWdQU0J5WlhGMWFYSmxLQ2N1TDE5aGJpMXZZbXBsWTNRbktWeHVJQ0FzSUdkbGRFdGxlWE1nSUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXdGxlWE1uS1R0Y2JseHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQnlaWEYxYVhKbEtDY3VMMTlrWlhOamNtbHdkRzl5Y3ljcElEOGdUMkpxWldOMExtUmxabWx1WlZCeWIzQmxjblJwWlhNZ09pQm1kVzVqZEdsdmJpQmtaV1pwYm1WUWNtOXdaWEowYVdWektFOHNJRkJ5YjNCbGNuUnBaWE1wZTF4dUlDQmhiazlpYW1WamRDaFBLVHRjYmlBZ2RtRnlJR3RsZVhNZ0lDQTlJR2RsZEV0bGVYTW9VSEp2Y0dWeWRHbGxjeWxjYmlBZ0lDQXNJR3hsYm1kMGFDQTlJR3RsZVhNdWJHVnVaM1JvWEc0Z0lDQWdMQ0JwSUQwZ01GeHVJQ0FnSUN3Z1VEdGNiaUFnZDJocGJHVW9iR1Z1WjNSb0lENGdhU2xrVUM1bUtFOHNJRkFnUFNCclpYbHpXMmtySzEwc0lGQnliM0JsY25ScFpYTmJVRjBwTzF4dUlDQnlaWFIxY200Z1R6dGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXZZbXBsWTNRdFpIQnpMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0EyTkZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpTHk4Z01Ua3VNUzR5TGpjZ0x5QXhOUzR5TGpNdU5DQlBZbXBsWTNRdVoyVjBUM2R1VUhKdmNHVnlkSGxPWVcxbGN5aFBLVnh1ZG1GeUlDUnJaWGx6SUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0YTJWNWN5MXBiblJsY201aGJDY3BYRzRnSUN3Z2FHbGtaR1Z1UzJWNWN5QTlJSEpsY1hWcGNtVW9KeTR2WDJWdWRXMHRZblZuTFd0bGVYTW5LUzVqYjI1allYUW9KMnhsYm1kMGFDY3NJQ2R3Y205MGIzUjVjR1VuS1R0Y2JseHVaWGh3YjNKMGN5NW1JRDBnVDJKcVpXTjBMbWRsZEU5M2JsQnliM0JsY25SNVRtRnRaWE1nZkh3Z1puVnVZM1JwYjI0Z1oyVjBUM2R1VUhKdmNHVnlkSGxPWVcxbGN5aFBLWHRjYmlBZ2NtVjBkWEp1SUNSclpYbHpLRThzSUdocFpHUmxia3RsZVhNcE8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyOWlhbVZqZEMxbmIzQnVMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0EyTlZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNaUxDSjJZWElnZEc5SmJuUmxaMlZ5SUQwZ2NtVnhkV2x5WlNnbkxpOWZkRzh0YVc1MFpXZGxjaWNwWEc0Z0lDd2daR1ZtYVc1bFpDQWdJRDBnY21WeGRXbHlaU2duTGk5ZlpHVm1hVzVsWkNjcE8xeHVMeThnZEhKMVpTQWdMVDRnVTNSeWFXNW5JMkYwWEc0dkx5Qm1ZV3h6WlNBdFBpQlRkSEpwYm1jalkyOWtaVkJ2YVc1MFFYUmNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9WRTlmVTFSU1NVNUhLWHRjYmlBZ2NtVjBkWEp1SUdaMWJtTjBhVzl1S0hSb1lYUXNJSEJ2Y3lsN1hHNGdJQ0FnZG1GeUlITWdQU0JUZEhKcGJtY29aR1ZtYVc1bFpDaDBhR0YwS1NsY2JpQWdJQ0FnSUN3Z2FTQTlJSFJ2U1c1MFpXZGxjaWh3YjNNcFhHNGdJQ0FnSUNBc0lHd2dQU0J6TG14bGJtZDBhRnh1SUNBZ0lDQWdMQ0JoTENCaU8xeHVJQ0FnSUdsbUtHa2dQQ0F3SUh4OElHa2dQajBnYkNseVpYUjFjbTRnVkU5ZlUxUlNTVTVISUQ4Z0p5Y2dPaUIxYm1SbFptbHVaV1E3WEc0Z0lDQWdZU0E5SUhNdVkyaGhja052WkdWQmRDaHBLVHRjYmlBZ0lDQnlaWFIxY200Z1lTQThJREI0WkRnd01DQjhmQ0JoSUQ0Z01IaGtZbVptSUh4OElHa2dLeUF4SUQwOVBTQnNJSHg4SUNoaUlEMGdjeTVqYUdGeVEyOWtaVUYwS0drZ0t5QXhLU2tnUENBd2VHUmpNREFnZkh3Z1lpQStJREI0WkdabVpseHVJQ0FnSUNBZ1B5QlVUMTlUVkZKSlRrY2dQeUJ6TG1Ob1lYSkJkQ2hwS1NBNklHRmNiaUFnSUNBZ0lEb2dWRTlmVTFSU1NVNUhJRDhnY3k1emJHbGpaU2hwTENCcElDc2dNaWtnT2lBb1lTQXRJREI0WkRnd01DQThQQ0F4TUNrZ0t5QW9ZaUF0SURCNFpHTXdNQ2tnS3lBd2VERXdNREF3TzF4dUlDQjlPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM04wY21sdVp5MWhkQzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTmpaY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSW5aaGNpQmpkSGdnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5amRIZ25LVnh1SUNBc0lHbHVkbTlyWlNBZ0lDQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJsdWRtOXJaU2NwWEc0Z0lDd2dhSFJ0YkNBZ0lDQWdJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmFIUnRiQ2NwWEc0Z0lDd2dZMlZzSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZlpHOXRMV055WldGMFpTY3BYRzRnSUN3Z1oyeHZZbUZzSUNBZ0lDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmWjJ4dlltRnNKeWxjYmlBZ0xDQndjbTlqWlhOeklDQWdJQ0FnSUNBZ0lDQWdQU0JuYkc5aVlXd3VjSEp2WTJWemMxeHVJQ0FzSUhObGRGUmhjMnNnSUNBZ0lDQWdJQ0FnSUNBOUlHZHNiMkpoYkM1elpYUkpiVzFsWkdsaGRHVmNiaUFnTENCamJHVmhjbFJoYzJzZ0lDQWdJQ0FnSUNBZ1BTQm5iRzlpWVd3dVkyeGxZWEpKYlcxbFpHbGhkR1ZjYmlBZ0xDQk5aWE56WVdkbFEyaGhibTVsYkNBZ0lDQWdQU0JuYkc5aVlXd3VUV1Z6YzJGblpVTm9ZVzV1Wld4Y2JpQWdMQ0JqYjNWdWRHVnlJQ0FnSUNBZ0lDQWdJQ0FnUFNBd1hHNGdJQ3dnY1hWbGRXVWdJQ0FnSUNBZ0lDQWdJQ0FnSUQwZ2UzMWNiaUFnTENCUFRsSkZRVVJaVTFSQlZFVkRTRUZPUjBVZ1BTQW5iMjV5WldGa2VYTjBZWFJsWTJoaGJtZGxKMXh1SUNBc0lHUmxabVZ5TENCamFHRnVibVZzTENCd2IzSjBPMXh1ZG1GeUlISjFiaUE5SUdaMWJtTjBhVzl1S0NsN1hHNGdJSFpoY2lCcFpDQTlJQ3QwYUdsek8xeHVJQ0JwWmloeGRXVjFaUzVvWVhOUGQyNVFjbTl3WlhKMGVTaHBaQ2twZTF4dUlDQWdJSFpoY2lCbWJpQTlJSEYxWlhWbFcybGtYVHRjYmlBZ0lDQmtaV3hsZEdVZ2NYVmxkV1ZiYVdSZE8xeHVJQ0FnSUdadUtDazdYRzRnSUgxY2JuMDdYRzUyWVhJZ2JHbHpkR1Z1WlhJZ1BTQm1kVzVqZEdsdmJpaGxkbVZ1ZENsN1hHNGdJSEoxYmk1allXeHNLR1YyWlc1MExtUmhkR0VwTzF4dWZUdGNiaTh2SUU1dlpHVXVhbk1nTUM0NUt5QW1JRWxGTVRBcklHaGhjeUJ6WlhSSmJXMWxaR2xoZEdVc0lHOTBhR1Z5ZDJselpUcGNibWxtS0NGelpYUlVZWE5ySUh4OElDRmpiR1ZoY2xSaGMyc3BlMXh1SUNCelpYUlVZWE5ySUQwZ1puVnVZM1JwYjI0Z2MyVjBTVzF0WldScFlYUmxLR1p1S1h0Y2JpQWdJQ0IyWVhJZ1lYSm5jeUE5SUZ0ZExDQnBJRDBnTVR0Y2JpQWdJQ0IzYUdsc1pTaGhjbWQxYldWdWRITXViR1Z1WjNSb0lENGdhU2xoY21kekxuQjFjMmdvWVhKbmRXMWxiblJ6VzJrcksxMHBPMXh1SUNBZ0lIRjFaWFZsV3lzclkyOTFiblJsY2wwZ1BTQm1kVzVqZEdsdmJpZ3BlMXh1SUNBZ0lDQWdhVzUyYjJ0bEtIUjVjR1Z2WmlCbWJpQTlQU0FuWm5WdVkzUnBiMjRuSUQ4Z1ptNGdPaUJHZFc1amRHbHZiaWhtYmlrc0lHRnlaM01wTzF4dUlDQWdJSDA3WEc0Z0lDQWdaR1ZtWlhJb1kyOTFiblJsY2lrN1hHNGdJQ0FnY21WMGRYSnVJR052ZFc1MFpYSTdYRzRnSUgwN1hHNGdJR05zWldGeVZHRnpheUE5SUdaMWJtTjBhVzl1SUdOc1pXRnlTVzF0WldScFlYUmxLR2xrS1h0Y2JpQWdJQ0JrWld4bGRHVWdjWFZsZFdWYmFXUmRPMXh1SUNCOU8xeHVJQ0F2THlCT2IyUmxMbXB6SURBdU9DMWNiaUFnYVdZb2NtVnhkV2x5WlNnbkxpOWZZMjltSnlrb2NISnZZMlZ6Y3lrZ1BUMGdKM0J5YjJObGMzTW5LWHRjYmlBZ0lDQmtaV1psY2lBOUlHWjFibU4wYVc5dUtHbGtLWHRjYmlBZ0lDQWdJSEJ5YjJObGMzTXVibVY0ZEZScFkyc29ZM1I0S0hKMWJpd2dhV1FzSURFcEtUdGNiaUFnSUNCOU8xeHVJQ0F2THlCQ2NtOTNjMlZ5Y3lCM2FYUm9JRTFsYzNOaFoyVkRhR0Z1Ym1Wc0xDQnBibU5zZFdSbGN5QlhaV0pYYjNKclpYSnpYRzRnSUgwZ1pXeHpaU0JwWmloTlpYTnpZV2RsUTJoaGJtNWxiQ2w3WEc0Z0lDQWdZMmhoYm01bGJDQTlJRzVsZHlCTlpYTnpZV2RsUTJoaGJtNWxiRHRjYmlBZ0lDQndiM0owSUNBZ0lEMGdZMmhoYm01bGJDNXdiM0owTWp0Y2JpQWdJQ0JqYUdGdWJtVnNMbkJ2Y25ReExtOXViV1Z6YzJGblpTQTlJR3hwYzNSbGJtVnlPMXh1SUNBZ0lHUmxabVZ5SUQwZ1kzUjRLSEJ2Y25RdWNHOXpkRTFsYzNOaFoyVXNJSEJ2Y25Rc0lERXBPMXh1SUNBdkx5QkNjbTkzYzJWeWN5QjNhWFJvSUhCdmMzUk5aWE56WVdkbExDQnphMmx3SUZkbFlsZHZjbXRsY25OY2JpQWdMeThnU1VVNElHaGhjeUJ3YjNOMFRXVnpjMkZuWlN3Z1luVjBJR2wwSjNNZ2MzbHVZeUFtSUhSNWNHVnZaaUJwZEhNZ2NHOXpkRTFsYzNOaFoyVWdhWE1nSjI5aWFtVmpkQ2RjYmlBZ2ZTQmxiSE5sSUdsbUtHZHNiMkpoYkM1aFpHUkZkbVZ1ZEV4cGMzUmxibVZ5SUNZbUlIUjVjR1Z2WmlCd2IzTjBUV1Z6YzJGblpTQTlQU0FuWm5WdVkzUnBiMjRuSUNZbUlDRm5iRzlpWVd3dWFXMXdiM0owVTJOeWFYQjBjeWw3WEc0Z0lDQWdaR1ZtWlhJZ1BTQm1kVzVqZEdsdmJpaHBaQ2w3WEc0Z0lDQWdJQ0JuYkc5aVlXd3VjRzl6ZEUxbGMzTmhaMlVvYVdRZ0t5QW5KeXdnSnlvbktUdGNiaUFnSUNCOU8xeHVJQ0FnSUdkc2IySmhiQzVoWkdSRmRtVnVkRXhwYzNSbGJtVnlLQ2R0WlhOellXZGxKeXdnYkdsemRHVnVaWElzSUdaaGJITmxLVHRjYmlBZ0x5OGdTVVU0TFZ4dUlDQjlJR1ZzYzJVZ2FXWW9UMDVTUlVGRVdWTlVRVlJGUTBoQlRrZEZJR2x1SUdObGJDZ25jMk55YVhCMEp5a3BlMXh1SUNBZ0lHUmxabVZ5SUQwZ1puVnVZM1JwYjI0b2FXUXBlMXh1SUNBZ0lDQWdhSFJ0YkM1aGNIQmxibVJEYUdsc1pDaGpaV3dvSjNOamNtbHdkQ2NwS1Z0UFRsSkZRVVJaVTFSQlZFVkRTRUZPUjBWZElEMGdablZ1WTNScGIyNG9LWHRjYmlBZ0lDQWdJQ0FnYUhSdGJDNXlaVzF2ZG1WRGFHbHNaQ2gwYUdsektUdGNiaUFnSUNBZ0lDQWdjblZ1TG1OaGJHd29hV1FwTzF4dUlDQWdJQ0FnZlR0Y2JpQWdJQ0I5TzF4dUlDQXZMeUJTWlhOMElHOXNaQ0JpY205M2MyVnljMXh1SUNCOUlHVnNjMlVnZTF4dUlDQWdJR1JsWm1WeUlEMGdablZ1WTNScGIyNG9hV1FwZTF4dUlDQWdJQ0FnYzJWMFZHbHRaVzkxZENoamRIZ29jblZ1TENCcFpDd2dNU2tzSURBcE8xeHVJQ0FnSUgwN1hHNGdJSDFjYm4xY2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ2UxeHVJQ0J6WlhRNklDQWdjMlYwVkdGemF5eGNiaUFnWTJ4bFlYSTZJR05zWldGeVZHRnphMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM1JoYzJzdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEWTNYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElEUWdOU0lzSW5aaGNpQjBiMGx1ZEdWblpYSWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXBiblJsWjJWeUp5bGNiaUFnTENCdFlYZ2dJQ0FnSUNBZ1BTQk5ZWFJvTG0xaGVGeHVJQ0FzSUcxcGJpQWdJQ0FnSUNBOUlFMWhkR2d1YldsdU8xeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpaHBibVJsZUN3Z2JHVnVaM1JvS1h0Y2JpQWdhVzVrWlhnZ1BTQjBiMGx1ZEdWblpYSW9hVzVrWlhncE8xeHVJQ0J5WlhSMWNtNGdhVzVrWlhnZ1BDQXdJRDhnYldGNEtHbHVaR1Y0SUNzZ2JHVnVaM1JvTENBd0tTQTZJRzFwYmlocGJtUmxlQ3dnYkdWdVozUm9LVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTkwYnkxcGJtUmxlQzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTmpoY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSWlkMWMyVWdjM1J5YVdOMEp6dGNiblpoY2lCaFpHUlViMVZ1YzJOdmNHRmliR1Z6SUQwZ2NtVnhkV2x5WlNnbkxpOWZZV1JrTFhSdkxYVnVjMk52Y0dGaWJHVnpKeWxjYmlBZ0xDQnpkR1Z3SUNBZ0lDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYVhSbGNpMXpkR1Z3SnlsY2JpQWdMQ0JKZEdWeVlYUnZjbk1nSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmFYUmxjbUYwYjNKekp5bGNiaUFnTENCMGIwbFBZbXBsWTNRZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZkRzh0YVc5aWFtVmpkQ2NwTzF4dVhHNHZMeUF5TWk0eExqTXVOQ0JCY25KaGVTNXdjbTkwYjNSNWNHVXVaVzUwY21sbGN5Z3BYRzR2THlBeU1pNHhMak11TVRNZ1FYSnlZWGt1Y0hKdmRHOTBlWEJsTG10bGVYTW9LVnh1THk4Z01qSXVNUzR6TGpJNUlFRnljbUY1TG5CeWIzUnZkSGx3WlM1MllXeDFaWE1vS1Z4dUx5OGdNakl1TVM0ekxqTXdJRUZ5Y21GNUxuQnliM1J2ZEhsd1pWdEFRR2wwWlhKaGRHOXlYU2dwWEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhKbGNYVnBjbVVvSnk0dlgybDBaWEl0WkdWbWFXNWxKeWtvUVhKeVlYa3NJQ2RCY25KaGVTY3NJR1oxYm1OMGFXOXVLR2wwWlhKaGRHVmtMQ0JyYVc1a0tYdGNiaUFnZEdocGN5NWZkQ0E5SUhSdlNVOWlhbVZqZENocGRHVnlZWFJsWkNrN0lDOHZJSFJoY21kbGRGeHVJQ0IwYUdsekxsOXBJRDBnTURzZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0x5OGdibVY0ZENCcGJtUmxlRnh1SUNCMGFHbHpMbDlySUQwZ2EybHVaRHNnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdMeThnYTJsdVpGeHVMeThnTWpJdU1TNDFMakl1TVNBbFFYSnlZWGxKZEdWeVlYUnZjbEJ5YjNSdmRIbHdaU1V1Ym1WNGRDZ3BYRzU5TENCbWRXNWpkR2x2YmlncGUxeHVJQ0IyWVhJZ1R5QWdJQ0FnUFNCMGFHbHpMbDkwWEc0Z0lDQWdMQ0JyYVc1a0lDQTlJSFJvYVhNdVgydGNiaUFnSUNBc0lHbHVaR1Y0SUQwZ2RHaHBjeTVmYVNzck8xeHVJQ0JwWmlnaFR5QjhmQ0JwYm1SbGVDQStQU0JQTG14bGJtZDBhQ2w3WEc0Z0lDQWdkR2hwY3k1ZmRDQTlJSFZ1WkdWbWFXNWxaRHRjYmlBZ0lDQnlaWFIxY200Z2MzUmxjQ2d4S1R0Y2JpQWdmVnh1SUNCcFppaHJhVzVrSUQwOUlDZHJaWGx6SnlBZ0tYSmxkSFZ5YmlCemRHVndLREFzSUdsdVpHVjRLVHRjYmlBZ2FXWW9hMmx1WkNBOVBTQW5kbUZzZFdWekp5bHlaWFIxY200Z2MzUmxjQ2d3TENCUFcybHVaR1Y0WFNrN1hHNGdJSEpsZEhWeWJpQnpkR1Z3S0RBc0lGdHBibVJsZUN3Z1QxdHBibVJsZUYxZEtUdGNibjBzSUNkMllXeDFaWE1uS1R0Y2JseHVMeThnWVhKbmRXMWxiblJ6VEdsemRGdEFRR2wwWlhKaGRHOXlYU0JwY3lBbFFYSnlZWGxRY205MGIxOTJZV3gxWlhNbElDZzVMalF1TkM0MkxDQTVMalF1TkM0M0tWeHVTWFJsY21GMGIzSnpMa0Z5WjNWdFpXNTBjeUE5SUVsMFpYSmhkRzl5Y3k1QmNuSmhlVHRjYmx4dVlXUmtWRzlWYm5OamIzQmhZbXhsY3lnbmEyVjVjeWNwTzF4dVlXUmtWRzlWYm5OamIzQmhZbXhsY3lnbmRtRnNkV1Z6SnlrN1hHNWhaR1JVYjFWdWMyTnZjR0ZpYkdWektDZGxiblJ5YVdWekp5azdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDJWek5pNWhjbkpoZVM1cGRHVnlZWFJ2Y2k1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ05qbGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0ltMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ2V5QmNJbVJsWm1GMWJIUmNJam9nY21WeGRXbHlaU2hjSW1OdmNtVXRhbk12YkdsaWNtRnllUzltYmk5dlltcGxZM1F2YTJWNWMxd2lLU3dnWDE5bGMwMXZaSFZzWlRvZ2RISjFaU0I5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlpWVdKbGJDMXlkVzUwYVcxbEwyTnZjbVV0YW5NdmIySnFaV04wTDJ0bGVYTXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRGN3WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXlJRFFnTlNJc0ltMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ2V5QmNJbVJsWm1GMWJIUmNJam9nY21WeGRXbHlaU2hjSW1OdmNtVXRhbk12YkdsaWNtRnllUzltYmk5d2NtOXRhWE5sWENJcExDQmZYMlZ6VFc5a2RXeGxPaUIwY25WbElIMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wySmhZbVZzTFhKMWJuUnBiV1V2WTI5eVpTMXFjeTl3Y205dGFYTmxMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0EzTVZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0EwSURVaUxDSjJZWElnVFVWVVFTQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOTFhV1FuS1NnbmJXVjBZU2NwWEc0Z0lDd2dhWE5QWW1wbFkzUWdQU0J5WlhGMWFYSmxLQ2N1TDE5cGN5MXZZbXBsWTNRbktWeHVJQ0FzSUdoaGN5QWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZhR0Z6SnlsY2JpQWdMQ0J6WlhSRVpYTmpJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxa2NDY3BMbVpjYmlBZ0xDQnBaQ0FnSUNBZ0lDQTlJREE3WEc1MllYSWdhWE5GZUhSbGJuTnBZbXhsSUQwZ1QySnFaV04wTG1selJYaDBaVzV6YVdKc1pTQjhmQ0JtZFc1amRHbHZiaWdwZTF4dUlDQnlaWFIxY200Z2RISjFaVHRjYm4wN1hHNTJZWElnUmxKRlJWcEZJRDBnSVhKbGNYVnBjbVVvSnk0dlgyWmhhV3h6Snlrb1puVnVZM1JwYjI0b0tYdGNiaUFnY21WMGRYSnVJR2x6UlhoMFpXNXphV0pzWlNoUFltcGxZM1F1Y0hKbGRtVnVkRVY0ZEdWdWMybHZibk1vZTMwcEtUdGNibjBwTzF4dWRtRnlJSE5sZEUxbGRHRWdQU0JtZFc1amRHbHZiaWhwZENsN1hHNGdJSE5sZEVSbGMyTW9hWFFzSUUxRlZFRXNJSHQyWVd4MVpUb2dlMXh1SUNBZ0lHazZJQ2RQSnlBcklDc3JhV1FzSUM4dklHOWlhbVZqZENCSlJGeHVJQ0FnSUhjNklIdDlJQ0FnSUNBZ0lDQWdJQzh2SUhkbFlXc2dZMjlzYkdWamRHbHZibk1nU1VSelhHNGdJSDE5S1R0Y2JuMDdYRzUyWVhJZ1ptRnpkRXRsZVNBOUlHWjFibU4wYVc5dUtHbDBMQ0JqY21WaGRHVXBlMXh1SUNBdkx5QnlaWFIxY200Z2NISnBiV2wwYVhabElIZHBkR2dnY0hKbFptbDRYRzRnSUdsbUtDRnBjMDlpYW1WamRDaHBkQ2twY21WMGRYSnVJSFI1Y0dWdlppQnBkQ0E5UFNBbmMzbHRZbTlzSnlBL0lHbDBJRG9nS0hSNWNHVnZaaUJwZENBOVBTQW5jM1J5YVc1bkp5QS9JQ2RUSnlBNklDZFFKeWtnS3lCcGREdGNiaUFnYVdZb0lXaGhjeWhwZEN3Z1RVVlVRU2twZTF4dUlDQWdJQzh2SUdOaGJpZDBJSE5sZENCdFpYUmhaR0YwWVNCMGJ5QjFibU5oZFdkb2RDQm1jbTk2Wlc0Z2IySnFaV04wWEc0Z0lDQWdhV1lvSVdselJYaDBaVzV6YVdKc1pTaHBkQ2twY21WMGRYSnVJQ2RHSnp0Y2JpQWdJQ0F2THlCdWIzUWdibVZqWlhOellYSjVJSFJ2SUdGa1pDQnRaWFJoWkdGMFlWeHVJQ0FnSUdsbUtDRmpjbVZoZEdVcGNtVjBkWEp1SUNkRkp6dGNiaUFnSUNBdkx5QmhaR1FnYldsemMybHVaeUJ0WlhSaFpHRjBZVnh1SUNBZ0lITmxkRTFsZEdFb2FYUXBPMXh1SUNBdkx5QnlaWFIxY200Z2IySnFaV04wSUVsRVhHNGdJSDBnY21WMGRYSnVJR2wwVzAxRlZFRmRMbWs3WEc1OU8xeHVkbUZ5SUdkbGRGZGxZV3NnUFNCbWRXNWpkR2x2YmlocGRDd2dZM0psWVhSbEtYdGNiaUFnYVdZb0lXaGhjeWhwZEN3Z1RVVlVRU2twZTF4dUlDQWdJQzh2SUdOaGJpZDBJSE5sZENCdFpYUmhaR0YwWVNCMGJ5QjFibU5oZFdkb2RDQm1jbTk2Wlc0Z2IySnFaV04wWEc0Z0lDQWdhV1lvSVdselJYaDBaVzV6YVdKc1pTaHBkQ2twY21WMGRYSnVJSFJ5ZFdVN1hHNGdJQ0FnTHk4Z2JtOTBJRzVsWTJWemMyRnllU0IwYnlCaFpHUWdiV1YwWVdSaGRHRmNiaUFnSUNCcFppZ2hZM0psWVhSbEtYSmxkSFZ5YmlCbVlXeHpaVHRjYmlBZ0lDQXZMeUJoWkdRZ2JXbHpjMmx1WnlCdFpYUmhaR0YwWVZ4dUlDQWdJSE5sZEUxbGRHRW9hWFFwTzF4dUlDQXZMeUJ5WlhSMWNtNGdhR0Z6YUNCM1pXRnJJR052Ykd4bFkzUnBiMjV6SUVsRWMxeHVJQ0I5SUhKbGRIVnliaUJwZEZ0TlJWUkJYUzUzTzF4dWZUdGNiaTh2SUdGa1pDQnRaWFJoWkdGMFlTQnZiaUJtY21WbGVtVXRabUZ0YVd4NUlHMWxkR2h2WkhNZ1kyRnNiR2x1WjF4dWRtRnlJRzl1Um5KbFpYcGxJRDBnWm5WdVkzUnBiMjRvYVhRcGUxeHVJQ0JwWmloR1VrVkZXa1VnSmlZZ2JXVjBZUzVPUlVWRUlDWW1JR2x6UlhoMFpXNXphV0pzWlNocGRDa2dKaVlnSVdoaGN5aHBkQ3dnVFVWVVFTa3BjMlYwVFdWMFlTaHBkQ2s3WEc0Z0lISmxkSFZ5YmlCcGREdGNibjA3WEc1MllYSWdiV1YwWVNBOUlHMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ2UxeHVJQ0JMUlZrNklDQWdJQ0FnVFVWVVFTeGNiaUFnVGtWRlJEb2dJQ0FnSUdaaGJITmxMRnh1SUNCbVlYTjBTMlY1T2lBZ1ptRnpkRXRsZVN4Y2JpQWdaMlYwVjJWaGF6b2dJR2RsZEZkbFlXc3NYRzRnSUc5dVJuSmxaWHBsT2lCdmJrWnlaV1Y2WlZ4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDIxbGRHRXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRGN5WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlJc0luWmhjaUJqYkdGemMyOW1JQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOWpiR0Z6YzI5bUp5bGNiaUFnTENCSlZFVlNRVlJQVWlBZ1BTQnlaWEYxYVhKbEtDY3VMMTkzYTNNbktTZ25hWFJsY21GMGIzSW5LVnh1SUNBc0lFbDBaWEpoZEc5eWN5QTlJSEpsY1hWcGNtVW9KeTR2WDJsMFpYSmhkRzl5Y3ljcE8xeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQnlaWEYxYVhKbEtDY3VMMTlqYjNKbEp5a3VaMlYwU1hSbGNtRjBiM0pOWlhSb2IyUWdQU0JtZFc1amRHbHZiaWhwZENsN1hHNGdJR2xtS0dsMElDRTlJSFZ1WkdWbWFXNWxaQ2x5WlhSMWNtNGdhWFJiU1ZSRlVrRlVUMUpkWEc0Z0lDQWdmSHdnYVhSYkowQkFhWFJsY21GMGIzSW5YVnh1SUNBZ0lIeDhJRWwwWlhKaGRHOXljMXRqYkdGemMyOW1LR2wwS1YwN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5amIzSmxMbWRsZEMxcGRHVnlZWFJ2Y2kxdFpYUm9iMlF1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURjelhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURRZ05TSXNJbTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdleUJjSW1SbFptRjFiSFJjSWpvZ2NtVnhkV2x5WlNoY0ltTnZjbVV0YW5NdmJHbGljbUZ5ZVM5bWJpOXZZbXBsWTNRdlkzSmxZWFJsWENJcExDQmZYMlZ6VFc5a2RXeGxPaUIwY25WbElIMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wySmhZbVZzTFhKMWJuUnBiV1V2WTI5eVpTMXFjeTl2WW1wbFkzUXZZM0psWVhSbExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTNORnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENKdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhzZ1hDSmtaV1poZFd4MFhDSTZJSEpsY1hWcGNtVW9YQ0pqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2YjJKcVpXTjBMM05sZEMxd2NtOTBiM1I1Y0dVdGIyWmNJaWtzSUY5ZlpYTk5iMlIxYkdVNklIUnlkV1VnZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOWpiM0psTFdwekwyOWlhbVZqZEM5elpYUXRjSEp2ZEc5MGVYQmxMVzltTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBM05WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWlMQ0p0YjJSMWJHVXVaWGh3YjNKMGN5QTlJSHNnWENKa1pXWmhkV3gwWENJNklISmxjWFZwY21Vb1hDSmpiM0psTFdwekwyeHBZbkpoY25rdlptNHZjM2x0WW05c1hDSXBMQ0JmWDJWelRXOWtkV3hsT2lCMGNuVmxJSDA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMkpoWW1Wc0xYSjFiblJwYldVdlkyOXlaUzFxY3k5emVXMWliMnd1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURjMlhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015SXNJbTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdleUJjSW1SbFptRjFiSFJjSWpvZ2NtVnhkV2x5WlNoY0ltTnZjbVV0YW5NdmJHbGljbUZ5ZVM5bWJpOXplVzFpYjJ3dmFYUmxjbUYwYjNKY0lpa3NJRjlmWlhOTmIyUjFiR1U2SUhSeWRXVWdmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZbUZpWld3dGNuVnVkR2x0WlM5amIzSmxMV3B6TDNONWJXSnZiQzlwZEdWeVlYUnZjaTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTnpkY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklpd2ljbVZ4ZFdseVpTZ25MaTR2TGk0dmJXOWtkV3hsY3k5bGN6WXViMkpxWldOMExtTnlaV0YwWlNjcE8xeHVkbUZ5SUNSUFltcGxZM1FnUFNCeVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMTlqYjNKbEp5a3VUMkpxWldOME8xeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpQmpjbVZoZEdVb1VDd2dSQ2w3WEc0Z0lISmxkSFZ5YmlBa1QySnFaV04wTG1OeVpXRjBaU2hRTENCRUtUdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOW1iaTl2WW1wbFkzUXZZM0psWVhSbExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTNPRnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENKeVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMlZ6Tmk1dlltcGxZM1F1WjJWMExYQnliM1J2ZEhsd1pTMXZaaWNwTzF4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCeVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMTlqYjNKbEp5a3VUMkpxWldOMExtZGxkRkJ5YjNSdmRIbHdaVTltTzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2YjJKcVpXTjBMMmRsZEMxd2NtOTBiM1I1Y0dVdGIyWXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRGM1WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlJc0luSmxjWFZwY21Vb0p5NHVMeTR1TDIxdlpIVnNaWE12WlhNMkxtOWlhbVZqZEM1clpYbHpKeWs3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhKbGNYVnBjbVVvSnk0dUx5NHVMMjF2WkhWc1pYTXZYMk52Y21VbktTNVBZbXBsWTNRdWEyVjVjenRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMjlpYW1WamRDOXJaWGx6TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBNE1GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTWlBMElEVWlMQ0p5WlhGMWFYSmxLQ2N1TGk4dUxpOXRiMlIxYkdWekwyVnpOaTV2WW1wbFkzUXVjMlYwTFhCeWIzUnZkSGx3WlMxdlppY3BPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0J5WlhGMWFYSmxLQ2N1TGk4dUxpOXRiMlIxYkdWekwxOWpiM0psSnlrdVQySnFaV04wTG5ObGRGQnliM1J2ZEhsd1pVOW1PMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdlptNHZiMkpxWldOMEwzTmxkQzF3Y205MGIzUjVjR1V0YjJZdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEZ3hYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUlzSW5KbGNYVnBjbVVvSnk0dUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNTBieTF6ZEhKcGJtY25LVHRjYm5KbGNYVnBjbVVvSnk0dUwyMXZaSFZzWlhNdlpYTTJMbk4wY21sdVp5NXBkR1Z5WVhSdmNpY3BPMXh1Y21WeGRXbHlaU2duTGk0dmJXOWtkV3hsY3k5M1pXSXVaRzl0TG1sMFpYSmhZbXhsSnlrN1hHNXlaWEYxYVhKbEtDY3VMaTl0YjJSMWJHVnpMMlZ6Tmk1d2NtOXRhWE5sSnlrN1hHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlISmxjWFZwY21Vb0p5NHVMMjF2WkhWc1pYTXZYMk52Y21VbktTNVFjbTl0YVhObE8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmNISnZiV2x6WlM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ09ESmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ05DQTFJaXdpY21WeGRXbHlaU2duTGk0dkxpNHZiVzlrZFd4bGN5OWxjell1YzNsdFltOXNKeWs3WEc1eVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMlZ6Tmk1dlltcGxZM1F1ZEc4dGMzUnlhVzVuSnlrN1hHNXlaWEYxYVhKbEtDY3VMaTh1TGk5dGIyUjFiR1Z6TDJWek55NXplVzFpYjJ3dVlYTjVibU10YVhSbGNtRjBiM0luS1R0Y2JuSmxjWFZwY21Vb0p5NHVMeTR1TDIxdlpIVnNaWE12WlhNM0xuTjViV0p2YkM1dlluTmxjblpoWW14bEp5azdYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJSEpsY1hWcGNtVW9KeTR1THk0dUwyMXZaSFZzWlhNdlgyTnZjbVVuS1M1VGVXMWliMnc3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOW1iaTl6ZVcxaWIyd3ZhVzVrWlhndWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEZ3pYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUlzSW5KbGNYVnBjbVVvSnk0dUx5NHVMMjF2WkhWc1pYTXZaWE0yTG5OMGNtbHVaeTVwZEdWeVlYUnZjaWNwTzF4dWNtVnhkV2x5WlNnbkxpNHZMaTR2Ylc5a2RXeGxjeTkzWldJdVpHOXRMbWwwWlhKaFlteGxKeWs3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhKbGNYVnBjbVVvSnk0dUx5NHVMMjF2WkhWc1pYTXZYM2RyY3kxbGVIUW5LUzVtS0NkcGRHVnlZWFJ2Y2ljcE8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmMzbHRZbTlzTDJsMFpYSmhkRzl5TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBNE5GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWlMQ0p0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLR2wwTENCRGIyNXpkSEoxWTNSdmNpd2dibUZ0WlN3Z1ptOXlZbWxrWkdWdVJtbGxiR1FwZTF4dUlDQnBaaWdoS0dsMElHbHVjM1JoYm1ObGIyWWdRMjl1YzNSeWRXTjBiM0lwSUh4OElDaG1iM0ppYVdSa1pXNUdhV1ZzWkNBaFBUMGdkVzVrWldacGJtVmtJQ1ltSUdadmNtSnBaR1JsYmtacFpXeGtJR2x1SUdsMEtTbDdYRzRnSUNBZ2RHaHliM2NnVkhsd1pVVnljbTl5S0c1aGJXVWdLeUFuT2lCcGJtTnZjbkpsWTNRZ2FXNTJiMk5oZEdsdmJpRW5LVHRjYmlBZ2ZTQnlaWFIxY200Z2FYUTdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZVzR0YVc1emRHRnVZMlV1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURnMVhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURRZ05TSXNJaTh2SUdGc2JDQmxiblZ0WlhKaFlteGxJRzlpYW1WamRDQnJaWGx6TENCcGJtTnNkV1JsY3lCemVXMWliMnh6WEc1MllYSWdaMlYwUzJWNWN5QTlJSEpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzFyWlhsekp5bGNiaUFnTENCblQxQlRJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXZHZjSE1uS1Z4dUlDQXNJSEJKUlNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0Y0dsbEp5azdYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLR2wwS1h0Y2JpQWdkbUZ5SUhKbGMzVnNkQ0FnSUNBZ1BTQm5aWFJMWlhsektHbDBLVnh1SUNBZ0lDd2daMlYwVTNsdFltOXNjeUE5SUdkUFVGTXVaanRjYmlBZ2FXWW9aMlYwVTNsdFltOXNjeWw3WEc0Z0lDQWdkbUZ5SUhONWJXSnZiSE1nUFNCblpYUlRlVzFpYjJ4ektHbDBLVnh1SUNBZ0lDQWdMQ0JwYzBWdWRXMGdJRDBnY0VsRkxtWmNiaUFnSUNBZ0lDd2dhU0FnSUNBZ0lDQTlJREJjYmlBZ0lDQWdJQ3dnYTJWNU8xeHVJQ0FnSUhkb2FXeGxLSE41YldKdmJITXViR1Z1WjNSb0lENGdhU2xwWmlocGMwVnVkVzB1WTJGc2JDaHBkQ3dnYTJWNUlEMGdjM2x0WW05c2MxdHBLeXRkS1NseVpYTjFiSFF1Y0hWemFDaHJaWGtwTzF4dUlDQjlJSEpsZEhWeWJpQnlaWE4xYkhRN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZlpXNTFiUzFyWlhsekxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTRObHh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENKMllYSWdZM1I0SUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOWpkSGduS1Z4dUlDQXNJR05oYkd3Z0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZhWFJsY2kxallXeHNKeWxjYmlBZ0xDQnBjMEZ5Y21GNVNYUmxjaUE5SUhKbGNYVnBjbVVvSnk0dlgybHpMV0Z5Y21GNUxXbDBaWEluS1Z4dUlDQXNJR0Z1VDJKcVpXTjBJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZZVzR0YjJKcVpXTjBKeWxjYmlBZ0xDQjBiMHhsYm1kMGFDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzUnZMV3hsYm1kMGFDY3BYRzRnSUN3Z1oyVjBTWFJsY2tadUlDQWdQU0J5WlhGMWFYSmxLQ2N1TDJOdmNtVXVaMlYwTFdsMFpYSmhkRzl5TFcxbGRHaHZaQ2NwWEc0Z0lDd2dRbEpGUVVzZ0lDQWdJQ0FnUFNCN2ZWeHVJQ0FzSUZKRlZGVlNUaUFnSUNBZ0lEMGdlMzA3WEc1MllYSWdaWGh3YjNKMGN5QTlJRzF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9hWFJsY21GaWJHVXNJR1Z1ZEhKcFpYTXNJR1p1TENCMGFHRjBMQ0JKVkVWU1FWUlBVaWw3WEc0Z0lIWmhjaUJwZEdWeVJtNGdQU0JKVkVWU1FWUlBVaUEvSUdaMWJtTjBhVzl1S0NsN0lISmxkSFZ5YmlCcGRHVnlZV0pzWlRzZ2ZTQTZJR2RsZEVsMFpYSkdiaWhwZEdWeVlXSnNaU2xjYmlBZ0lDQXNJR1lnSUNBZ0lDQTlJR04wZUNobWJpd2dkR2hoZEN3Z1pXNTBjbWxsY3lBL0lESWdPaUF4S1Z4dUlDQWdJQ3dnYVc1a1pYZ2dJRDBnTUZ4dUlDQWdJQ3dnYkdWdVozUm9MQ0J6ZEdWd0xDQnBkR1Z5WVhSdmNpd2djbVZ6ZFd4ME8xeHVJQ0JwWmloMGVYQmxiMllnYVhSbGNrWnVJQ0U5SUNkbWRXNWpkR2x2YmljcGRHaHliM2NnVkhsd1pVVnljbTl5S0dsMFpYSmhZbXhsSUNzZ0p5QnBjeUJ1YjNRZ2FYUmxjbUZpYkdVaEp5azdYRzRnSUM4dklHWmhjM1FnWTJGelpTQm1iM0lnWVhKeVlYbHpJSGRwZEdnZ1pHVm1ZWFZzZENCcGRHVnlZWFJ2Y2x4dUlDQnBaaWhwYzBGeWNtRjVTWFJsY2locGRHVnlSbTRwS1dadmNpaHNaVzVuZEdnZ1BTQjBiMHhsYm1kMGFDaHBkR1Z5WVdKc1pTNXNaVzVuZEdncE95QnNaVzVuZEdnZ1BpQnBibVJsZURzZ2FXNWtaWGdyS3lsN1hHNGdJQ0FnY21WemRXeDBJRDBnWlc1MGNtbGxjeUEvSUdZb1lXNVBZbXBsWTNRb2MzUmxjQ0E5SUdsMFpYSmhZbXhsVzJsdVpHVjRYU2xiTUYwc0lITjBaWEJiTVYwcElEb2daaWhwZEdWeVlXSnNaVnRwYm1SbGVGMHBPMXh1SUNBZ0lHbG1LSEpsYzNWc2RDQTlQVDBnUWxKRlFVc2dmSHdnY21WemRXeDBJRDA5UFNCU1JWUlZVazRwY21WMGRYSnVJSEpsYzNWc2REdGNiaUFnZlNCbGJITmxJR1p2Y2locGRHVnlZWFJ2Y2lBOUlHbDBaWEpHYmk1allXeHNLR2wwWlhKaFlteGxLVHNnSVNoemRHVndJRDBnYVhSbGNtRjBiM0l1Ym1WNGRDZ3BLUzVrYjI1bE95QXBlMXh1SUNBZ0lISmxjM1ZzZENBOUlHTmhiR3dvYVhSbGNtRjBiM0lzSUdZc0lITjBaWEF1ZG1Gc2RXVXNJR1Z1ZEhKcFpYTXBPMXh1SUNBZ0lHbG1LSEpsYzNWc2RDQTlQVDBnUWxKRlFVc2dmSHdnY21WemRXeDBJRDA5UFNCU1JWUlZVazRwY21WMGRYSnVJSEpsYzNWc2REdGNiaUFnZlZ4dWZUdGNibVY0Y0c5eWRITXVRbEpGUVVzZ0lEMGdRbEpGUVVzN1hHNWxlSEJ2Y25SekxsSkZWRlZTVGlBOUlGSkZWRlZTVGp0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMlp2Y2kxdlppNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdPRGRjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdOQ0ExSWl3aUx5OGdabUZ6ZENCaGNIQnNlU3dnYUhSMGNEb3ZMMnB6Y0dWeVppNXNibXRwZEM1amIyMHZabUZ6ZEMxaGNIQnNlUzgxWEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0dadUxDQmhjbWR6TENCMGFHRjBLWHRjYmlBZ2RtRnlJSFZ1SUQwZ2RHaGhkQ0E5UFQwZ2RXNWtaV1pwYm1Wa08xeHVJQ0J6ZDJsMFkyZ29ZWEpuY3k1c1pXNW5kR2dwZTF4dUlDQWdJR05oYzJVZ01Eb2djbVYwZFhKdUlIVnVJRDhnWm00b0tWeHVJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSURvZ1ptNHVZMkZzYkNoMGFHRjBLVHRjYmlBZ0lDQmpZWE5sSURFNklISmxkSFZ5YmlCMWJpQS9JR1p1S0dGeVozTmJNRjBwWEc0Z0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdPaUJtYmk1allXeHNLSFJvWVhRc0lHRnlaM05iTUYwcE8xeHVJQ0FnSUdOaGMyVWdNam9nY21WMGRYSnVJSFZ1SUQ4Z1ptNG9ZWEpuYzFzd1hTd2dZWEpuYzFzeFhTbGNiaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBNklHWnVMbU5oYkd3b2RHaGhkQ3dnWVhKbmMxc3dYU3dnWVhKbmMxc3hYU2s3WEc0Z0lDQWdZMkZ6WlNBek9pQnlaWFIxY200Z2RXNGdQeUJtYmloaGNtZHpXekJkTENCaGNtZHpXekZkTENCaGNtZHpXekpkS1Z4dUlDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJRG9nWm00dVkyRnNiQ2gwYUdGMExDQmhjbWR6V3pCZExDQmhjbWR6V3pGZExDQmhjbWR6V3pKZEtUdGNiaUFnSUNCallYTmxJRFE2SUhKbGRIVnliaUIxYmlBL0lHWnVLR0Z5WjNOYk1GMHNJR0Z5WjNOYk1WMHNJR0Z5WjNOYk1sMHNJR0Z5WjNOYk0xMHBYRzRnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ09pQm1iaTVqWVd4c0tIUm9ZWFFzSUdGeVozTmJNRjBzSUdGeVozTmJNVjBzSUdGeVozTmJNbDBzSUdGeVozTmJNMTBwTzF4dUlDQjlJSEpsZEhWeWJpQWdJQ0FnSUNBZ0lDQWdJQ0FnWm00dVlYQndiSGtvZEdoaGRDd2dZWEpuY3lrN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFXNTJiMnRsTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBNE9GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBMElEVWlMQ0l2THlCamFHVmpheUJ2YmlCa1pXWmhkV3gwSUVGeWNtRjVJR2wwWlhKaGRHOXlYRzUyWVhJZ1NYUmxjbUYwYjNKeklDQTlJSEpsY1hWcGNtVW9KeTR2WDJsMFpYSmhkRzl5Y3ljcFhHNGdJQ3dnU1ZSRlVrRlVUMUlnSUNBOUlISmxjWFZwY21Vb0p5NHZYM2RyY3ljcEtDZHBkR1Z5WVhSdmNpY3BYRzRnSUN3Z1FYSnlZWGxRY205MGJ5QTlJRUZ5Y21GNUxuQnliM1J2ZEhsd1pUdGNibHh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhwZENsN1hHNGdJSEpsZEhWeWJpQnBkQ0FoUFQwZ2RXNWtaV1pwYm1Wa0lDWW1JQ2hKZEdWeVlYUnZjbk11UVhKeVlYa2dQVDA5SUdsMElIeDhJRUZ5Y21GNVVISnZkRzliU1ZSRlVrRlVUMUpkSUQwOVBTQnBkQ2s3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYVhNdFlYSnlZWGt0YVhSbGNpNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdPRGxjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdOQ0ExSWl3aUx5OGdOeTR5TGpJZ1NYTkJjbkpoZVNoaGNtZDFiV1Z1ZENsY2JuWmhjaUJqYjJZZ1BTQnlaWEYxYVhKbEtDY3VMMTlqYjJZbktUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdRWEp5WVhrdWFYTkJjbkpoZVNCOGZDQm1kVzVqZEdsdmJpQnBjMEZ5Y21GNUtHRnlaeWw3WEc0Z0lISmxkSFZ5YmlCamIyWW9ZWEpuS1NBOVBTQW5RWEp5WVhrbk8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgybHpMV0Z5Y21GNUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTVNRnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENJdkx5QmpZV3hzSUhOdmJXVjBhR2x1WnlCdmJpQnBkR1Z5WVhSdmNpQnpkR1Z3SUhkcGRHZ2djMkZtWlNCamJHOXphVzVuSUc5dUlHVnljbTl5WEc1MllYSWdZVzVQWW1wbFkzUWdQU0J5WlhGMWFYSmxLQ2N1TDE5aGJpMXZZbXBsWTNRbktUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9hWFJsY21GMGIzSXNJR1p1TENCMllXeDFaU3dnWlc1MGNtbGxjeWw3WEc0Z0lIUnllU0I3WEc0Z0lDQWdjbVYwZFhKdUlHVnVkSEpwWlhNZ1B5Qm1iaWhoYms5aWFtVmpkQ2gyWVd4MVpTbGJNRjBzSUhaaGJIVmxXekZkS1NBNklHWnVLSFpoYkhWbEtUdGNiaUFnTHk4Z055NDBMallnU1hSbGNtRjBiM0pEYkc5elpTaHBkR1Z5WVhSdmNpd2dZMjl0Y0d4bGRHbHZiaWxjYmlBZ2ZTQmpZWFJqYUNobEtYdGNiaUFnSUNCMllYSWdjbVYwSUQwZ2FYUmxjbUYwYjNKYkozSmxkSFZ5YmlkZE8xeHVJQ0FnSUdsbUtISmxkQ0FoUFQwZ2RXNWtaV1pwYm1Wa0tXRnVUMkpxWldOMEtISmxkQzVqWVd4c0tHbDBaWEpoZEc5eUtTazdYRzRnSUNBZ2RHaHliM2NnWlR0Y2JpQWdmVnh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMmwwWlhJdFkyRnNiQzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnT1RGY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTkNBMUlpd2lkbUZ5SUVsVVJWSkJWRTlTSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDNkcmN5Y3BLQ2RwZEdWeVlYUnZjaWNwWEc0Z0lDd2dVMEZHUlY5RFRFOVRTVTVISUQwZ1ptRnNjMlU3WEc1Y2JuUnllU0I3WEc0Z0lIWmhjaUJ5YVhSbGNpQTlJRnMzWFZ0SlZFVlNRVlJQVWwwb0tUdGNiaUFnY21sMFpYSmJKM0psZEhWeWJpZGRJRDBnWm5WdVkzUnBiMjRvS1hzZ1UwRkdSVjlEVEU5VFNVNUhJRDBnZEhKMVpUc2dmVHRjYmlBZ1FYSnlZWGt1Wm5KdmJTaHlhWFJsY2l3Z1puVnVZM1JwYjI0b0tYc2dkR2h5YjNjZ01qc2dmU2s3WEc1OUlHTmhkR05vS0dVcGV5QXZLaUJsYlhCMGVTQXFMeUI5WEc1Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b1pYaGxZeXdnYzJ0cGNFTnNiM05wYm1jcGUxeHVJQ0JwWmlnaGMydHBjRU5zYjNOcGJtY2dKaVlnSVZOQlJrVmZRMHhQVTBsT1J5bHlaWFIxY200Z1ptRnNjMlU3WEc0Z0lIWmhjaUJ6WVdabElEMGdabUZzYzJVN1hHNGdJSFJ5ZVNCN1hHNGdJQ0FnZG1GeUlHRnljaUFnUFNCYk4xMWNiaUFnSUNBZ0lDd2dhWFJsY2lBOUlHRnljbHRKVkVWU1FWUlBVbDBvS1R0Y2JpQWdJQ0JwZEdWeUxtNWxlSFFnUFNCbWRXNWpkR2x2YmlncGV5QnlaWFIxY200Z2UyUnZibVU2SUhOaFptVWdQU0IwY25WbGZUc2dmVHRjYmlBZ0lDQmhjbkpiU1ZSRlVrRlVUMUpkSUQwZ1puVnVZM1JwYjI0b0tYc2djbVYwZFhKdUlHbDBaWEk3SUgwN1hHNGdJQ0FnWlhobFl5aGhjbklwTzF4dUlDQjlJR05oZEdOb0tHVXBleUF2S2lCbGJYQjBlU0FxTHlCOVhHNGdJSEpsZEhWeWJpQnpZV1psTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJsMFpYSXRaR1YwWldOMExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTVNbHh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQTBJRFVpTENKMllYSWdaMlYwUzJWNWN5QWdJRDBnY21WeGRXbHlaU2duTGk5ZmIySnFaV04wTFd0bGVYTW5LVnh1SUNBc0lIUnZTVTlpYW1WamRDQTlJSEpsY1hWcGNtVW9KeTR2WDNSdkxXbHZZbXBsWTNRbktUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9iMkpxWldOMExDQmxiQ2w3WEc0Z0lIWmhjaUJQSUNBZ0lDQWdQU0IwYjBsUFltcGxZM1FvYjJKcVpXTjBLVnh1SUNBZ0lDd2dhMlY1Y3lBZ0lEMGdaMlYwUzJWNWN5aFBLVnh1SUNBZ0lDd2diR1Z1WjNSb0lEMGdhMlY1Y3k1c1pXNW5kR2hjYmlBZ0lDQXNJR2x1WkdWNElDQTlJREJjYmlBZ0lDQXNJR3RsZVR0Y2JpQWdkMmhwYkdVb2JHVnVaM1JvSUQ0Z2FXNWtaWGdwYVdZb1QxdHJaWGtnUFNCclpYbHpXMmx1WkdWNEt5dGRYU0E5UFQwZ1pXd3BjbVYwZFhKdUlHdGxlVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlyWlhsdlppNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdPVE5jYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SWl3aWRtRnlJR2RzYjJKaGJDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyZHNiMkpoYkNjcFhHNGdJQ3dnYldGamNtOTBZWE5ySUQwZ2NtVnhkV2x5WlNnbkxpOWZkR0Z6YXljcExuTmxkRnh1SUNBc0lFOWljMlZ5ZG1WeUlDQTlJR2RzYjJKaGJDNU5kWFJoZEdsdmJrOWljMlZ5ZG1WeUlIeDhJR2RzYjJKaGJDNVhaV0pMYVhSTmRYUmhkR2x2Yms5aWMyVnlkbVZ5WEc0Z0lDd2djSEp2WTJWemN5QWdJRDBnWjJ4dlltRnNMbkJ5YjJObGMzTmNiaUFnTENCUWNtOXRhWE5sSUNBZ1BTQm5iRzlpWVd3dVVISnZiV2x6WlZ4dUlDQXNJR2x6VG05a1pTQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyTnZaaWNwS0hCeWIyTmxjM01wSUQwOUlDZHdjbTlqWlhOekp6dGNibHh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWdwZTF4dUlDQjJZWElnYUdWaFpDd2diR0Z6ZEN3Z2JtOTBhV1o1TzF4dVhHNGdJSFpoY2lCbWJIVnphQ0E5SUdaMWJtTjBhVzl1S0NsN1hHNGdJQ0FnZG1GeUlIQmhjbVZ1ZEN3Z1ptNDdYRzRnSUNBZ2FXWW9hWE5PYjJSbElDWW1JQ2h3WVhKbGJuUWdQU0J3Y205alpYTnpMbVJ2YldGcGJpa3BjR0Z5Wlc1MExtVjRhWFFvS1R0Y2JpQWdJQ0IzYUdsc1pTaG9aV0ZrS1h0Y2JpQWdJQ0FnSUdadUlDQWdQU0JvWldGa0xtWnVPMXh1SUNBZ0lDQWdhR1ZoWkNBOUlHaGxZV1F1Ym1WNGREdGNiaUFnSUNBZ0lIUnllU0I3WEc0Z0lDQWdJQ0FnSUdadUtDazdYRzRnSUNBZ0lDQjlJR05oZEdOb0tHVXBlMXh1SUNBZ0lDQWdJQ0JwWmlob1pXRmtLVzV2ZEdsbWVTZ3BPMXh1SUNBZ0lDQWdJQ0JsYkhObElHeGhjM1FnUFNCMWJtUmxabWx1WldRN1hHNGdJQ0FnSUNBZ0lIUm9jbTkzSUdVN1hHNGdJQ0FnSUNCOVhHNGdJQ0FnZlNCc1lYTjBJRDBnZFc1a1pXWnBibVZrTzF4dUlDQWdJR2xtS0hCaGNtVnVkQ2x3WVhKbGJuUXVaVzUwWlhJb0tUdGNiaUFnZlR0Y2JseHVJQ0F2THlCT2IyUmxMbXB6WEc0Z0lHbG1LR2x6VG05a1pTbDdYRzRnSUNBZ2JtOTBhV1o1SUQwZ1puVnVZM1JwYjI0b0tYdGNiaUFnSUNBZ0lIQnliMk5sYzNNdWJtVjRkRlJwWTJzb1pteDFjMmdwTzF4dUlDQWdJSDA3WEc0Z0lDOHZJR0p5YjNkelpYSnpJSGRwZEdnZ1RYVjBZWFJwYjI1UFluTmxjblpsY2x4dUlDQjlJR1ZzYzJVZ2FXWW9UMkp6WlhKMlpYSXBlMXh1SUNBZ0lIWmhjaUIwYjJkbmJHVWdQU0IwY25WbFhHNGdJQ0FnSUNBc0lHNXZaR1VnSUNBOUlHUnZZM1Z0Wlc1MExtTnlaV0YwWlZSbGVIUk9iMlJsS0NjbktUdGNiaUFnSUNCdVpYY2dUMkp6WlhKMlpYSW9abXgxYzJncExtOWljMlZ5ZG1Vb2JtOWtaU3dnZTJOb1lYSmhZM1JsY2tSaGRHRTZJSFJ5ZFdWOUtUc2dMeThnWlhOc2FXNTBMV1JwYzJGaWJHVXRiR2x1WlNCdWJ5MXVaWGRjYmlBZ0lDQnViM1JwWm5rZ1BTQm1kVzVqZEdsdmJpZ3BlMXh1SUNBZ0lDQWdibTlrWlM1a1lYUmhJRDBnZEc5bloyeGxJRDBnSVhSdloyZHNaVHRjYmlBZ0lDQjlPMXh1SUNBdkx5QmxiblpwY205dWJXVnVkSE1nZDJsMGFDQnRZWGxpWlNCdWIyNHRZMjl0Y0d4bGRHVnNlU0JqYjNKeVpXTjBMQ0JpZFhRZ1pYaHBjM1JsYm5RZ1VISnZiV2x6WlZ4dUlDQjlJR1ZzYzJVZ2FXWW9VSEp2YldselpTQW1KaUJRY205dGFYTmxMbkpsYzI5c2RtVXBlMXh1SUNBZ0lIWmhjaUJ3Y205dGFYTmxJRDBnVUhKdmJXbHpaUzV5WlhOdmJIWmxLQ2s3WEc0Z0lDQWdibTkwYVdaNUlEMGdablZ1WTNScGIyNG9LWHRjYmlBZ0lDQWdJSEJ5YjIxcGMyVXVkR2hsYmlobWJIVnphQ2s3WEc0Z0lDQWdmVHRjYmlBZ0x5OGdabTl5SUc5MGFHVnlJR1Z1ZG1seWIyNXRaVzUwY3lBdElHMWhZM0p2ZEdGemF5QmlZWE5sWkNCdmJqcGNiaUFnTHk4Z0xTQnpaWFJKYlcxbFpHbGhkR1ZjYmlBZ0x5OGdMU0JOWlhOellXZGxRMmhoYm01bGJGeHVJQ0F2THlBdElIZHBibVJ2ZHk1d2IzTjBUV1Z6YzJGblhHNGdJQzh2SUMwZ2IyNXlaV0ZrZVhOMFlYUmxZMmhoYm1kbFhHNGdJQzh2SUMwZ2MyVjBWR2x0Wlc5MWRGeHVJQ0I5SUdWc2MyVWdlMXh1SUNBZ0lHNXZkR2xtZVNBOUlHWjFibU4wYVc5dUtDbDdYRzRnSUNBZ0lDQXZMeUJ6ZEhKaGJtZGxJRWxGSUNzZ2QyVmljR0ZqYXlCa1pYWWdjMlZ5ZG1WeUlHSjFaeUF0SUhWelpTQXVZMkZzYkNobmJHOWlZV3dwWEc0Z0lDQWdJQ0J0WVdOeWIzUmhjMnN1WTJGc2JDaG5iRzlpWVd3c0lHWnNkWE5vS1R0Y2JpQWdJQ0I5TzF4dUlDQjlYRzVjYmlBZ2NtVjBkWEp1SUdaMWJtTjBhVzl1S0dadUtYdGNiaUFnSUNCMllYSWdkR0Z6YXlBOUlIdG1iam9nWm00c0lHNWxlSFE2SUhWdVpHVm1hVzVsWkgwN1hHNGdJQ0FnYVdZb2JHRnpkQ2xzWVhOMExtNWxlSFFnUFNCMFlYTnJPMXh1SUNBZ0lHbG1LQ0ZvWldGa0tYdGNiaUFnSUNBZ0lHaGxZV1FnUFNCMFlYTnJPMXh1SUNBZ0lDQWdibTkwYVdaNUtDazdYRzRnSUNBZ2ZTQnNZWE4wSUQwZ2RHRnphenRjYmlBZ2ZUdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXRhV055YjNSaGMyc3Vhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRGswWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRFFnTlNJc0lpOHZJR1poYkd4aVlXTnJJR1p2Y2lCSlJURXhJR0oxWjJkNUlFOWlhbVZqZEM1blpYUlBkMjVRY205d1pYSjBlVTVoYldWeklIZHBkR2dnYVdaeVlXMWxJR0Z1WkNCM2FXNWtiM2RjYm5aaGNpQjBiMGxQWW1wbFkzUWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXBiMkpxWldOMEp5bGNiaUFnTENCblQxQk9JQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRaMjl3YmljcExtWmNiaUFnTENCMGIxTjBjbWx1WnlBZ1BTQjdmUzUwYjFOMGNtbHVaenRjYmx4dWRtRnlJSGRwYm1SdmQwNWhiV1Z6SUQwZ2RIbHdaVzltSUhkcGJtUnZkeUE5UFNBbmIySnFaV04wSnlBbUppQjNhVzVrYjNjZ0ppWWdUMkpxWldOMExtZGxkRTkzYmxCeWIzQmxjblI1VG1GdFpYTmNiaUFnUHlCUFltcGxZM1F1WjJWMFQzZHVVSEp2Y0dWeWRIbE9ZVzFsY3loM2FXNWtiM2NwSURvZ1cxMDdYRzVjYm5aaGNpQm5aWFJYYVc1a2IzZE9ZVzFsY3lBOUlHWjFibU4wYVc5dUtHbDBLWHRjYmlBZ2RISjVJSHRjYmlBZ0lDQnlaWFIxY200Z1owOVFUaWhwZENrN1hHNGdJSDBnWTJGMFkyZ29aU2w3WEc0Z0lDQWdjbVYwZFhKdUlIZHBibVJ2ZDA1aGJXVnpMbk5zYVdObEtDazdYRzRnSUgxY2JuMDdYRzVjYm0xdlpIVnNaUzVsZUhCdmNuUnpMbVlnUFNCbWRXNWpkR2x2YmlCblpYUlBkMjVRY205d1pYSjBlVTVoYldWektHbDBLWHRjYmlBZ2NtVjBkWEp1SUhkcGJtUnZkMDVoYldWeklDWW1JSFJ2VTNSeWFXNW5MbU5oYkd3b2FYUXBJRDA5SUNkYmIySnFaV04wSUZkcGJtUnZkMTBuSUQ4Z1oyVjBWMmx1Wkc5M1RtRnRaWE1vYVhRcElEb2daMDlRVGloMGIwbFBZbXBsWTNRb2FYUXBLVHRjYm4wN1hHNWNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDI5aWFtVmpkQzFuYjNCdUxXVjRkQzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnT1RWY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklpd2lkbUZ5SUdocFpHVWdQU0J5WlhGMWFYSmxLQ2N1TDE5b2FXUmxKeWs3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0hSaGNtZGxkQ3dnYzNKakxDQnpZV1psS1h0Y2JpQWdabTl5S0haaGNpQnJaWGtnYVc0Z2MzSmpLWHRjYmlBZ0lDQnBaaWh6WVdabElDWW1JSFJoY21kbGRGdHJaWGxkS1hSaGNtZGxkRnRyWlhsZElEMGdjM0pqVzJ0bGVWMDdYRzRnSUNBZ1pXeHpaU0JvYVdSbEtIUmhjbWRsZEN3Z2EyVjVMQ0J6Y21OYmEyVjVYU2s3WEc0Z0lIMGdjbVYwZFhKdUlIUmhjbWRsZER0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5eVpXUmxabWx1WlMxaGJHd3Vhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRGsyWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRFFnTlNJc0lpOHZJRmR2Y210eklIZHBkR2dnWDE5d2NtOTBiMTlmSUc5dWJIa3VJRTlzWkNCMk9DQmpZVzRuZENCM2IzSnJJSGRwZEdnZ2JuVnNiQ0J3Y205MGJ5QnZZbXBsWTNSekxseHVMeW9nWlhOc2FXNTBMV1JwYzJGaWJHVWdibTh0Y0hKdmRHOGdLaTljYm5aaGNpQnBjMDlpYW1WamRDQTlJSEpsY1hWcGNtVW9KeTR2WDJsekxXOWlhbVZqZENjcFhHNGdJQ3dnWVc1UFltcGxZM1FnUFNCeVpYRjFhWEpsS0NjdUwxOWhiaTF2WW1wbFkzUW5LVHRjYm5aaGNpQmphR1ZqYXlBOUlHWjFibU4wYVc5dUtFOHNJSEJ5YjNSdktYdGNiaUFnWVc1UFltcGxZM1FvVHlrN1hHNGdJR2xtS0NGcGMwOWlhbVZqZENod2NtOTBieWtnSmlZZ2NISnZkRzhnSVQwOUlHNTFiR3dwZEdoeWIzY2dWSGx3WlVWeWNtOXlLSEJ5YjNSdklDc2dYQ0k2SUdOaGJpZDBJSE5sZENCaGN5QndjbTkwYjNSNWNHVWhYQ0lwTzF4dWZUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdlMXh1SUNCelpYUTZJRTlpYW1WamRDNXpaWFJRY205MGIzUjVjR1ZQWmlCOGZDQW9KMTlmY0hKdmRHOWZYeWNnYVc0Z2UzMGdQeUF2THlCbGMyeHBiblF0WkdsellXSnNaUzFzYVc1bFhHNGdJQ0FnWm5WdVkzUnBiMjRvZEdWemRDd2dZblZuWjNrc0lITmxkQ2w3WEc0Z0lDQWdJQ0IwY25rZ2UxeHVJQ0FnSUNBZ0lDQnpaWFFnUFNCeVpYRjFhWEpsS0NjdUwxOWpkSGduS1NoR2RXNWpkR2x2Ymk1allXeHNMQ0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0WjI5d1pDY3BMbVlvVDJKcVpXTjBMbkJ5YjNSdmRIbHdaU3dnSjE5ZmNISnZkRzlmWHljcExuTmxkQ3dnTWlrN1hHNGdJQ0FnSUNBZ0lITmxkQ2gwWlhOMExDQmJYU2s3WEc0Z0lDQWdJQ0FnSUdKMVoyZDVJRDBnSVNoMFpYTjBJR2x1YzNSaGJtTmxiMllnUVhKeVlYa3BPMXh1SUNBZ0lDQWdmU0JqWVhSamFDaGxLWHNnWW5Wbloza2dQU0IwY25WbE95QjlYRzRnSUNBZ0lDQnlaWFIxY200Z1puVnVZM1JwYjI0Z2MyVjBVSEp2ZEc5MGVYQmxUMllvVHl3Z2NISnZkRzhwZTF4dUlDQWdJQ0FnSUNCamFHVmpheWhQTENCd2NtOTBieWs3WEc0Z0lDQWdJQ0FnSUdsbUtHSjFaMmQ1S1U4dVgxOXdjbTkwYjE5ZklEMGdjSEp2ZEc4N1hHNGdJQ0FnSUNBZ0lHVnNjMlVnYzJWMEtFOHNJSEJ5YjNSdktUdGNiaUFnSUNBZ0lDQWdjbVYwZFhKdUlFODdYRzRnSUNBZ0lDQjlPMXh1SUNBZ0lIMG9lMzBzSUdaaGJITmxLU0E2SUhWdVpHVm1hVzVsWkNrc1hHNGdJR05vWldOck9pQmphR1ZqYTF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDNObGRDMXdjbTkwYnk1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ09UZGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJaXdpSjNWelpTQnpkSEpwWTNRbk8xeHVkbUZ5SUdkc2IySmhiQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmWjJ4dlltRnNKeWxjYmlBZ0xDQmpiM0psSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyTnZjbVVuS1Z4dUlDQXNJR1JRSUNBZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXUndKeWxjYmlBZ0xDQkVSVk5EVWtsUVZFOVNVeUE5SUhKbGNYVnBjbVVvSnk0dlgyUmxjMk55YVhCMGIzSnpKeWxjYmlBZ0xDQlRVRVZEU1VWVElDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzZHJjeWNwS0NkemNHVmphV1Z6SnlrN1hHNWNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9TMFZaS1h0Y2JpQWdkbUZ5SUVNZ1BTQjBlWEJsYjJZZ1kyOXlaVnRMUlZsZElEMDlJQ2RtZFc1amRHbHZiaWNnUHlCamIzSmxXMHRGV1YwZ09pQm5iRzlpWVd4YlMwVlpYVHRjYmlBZ2FXWW9SRVZUUTFKSlVGUlBVbE1nSmlZZ1F5QW1KaUFoUTF0VFVFVkRTVVZUWFNsa1VDNW1LRU1zSUZOUVJVTkpSVk1zSUh0Y2JpQWdJQ0JqYjI1bWFXZDFjbUZpYkdVNklIUnlkV1VzWEc0Z0lDQWdaMlYwT2lCbWRXNWpkR2x2YmlncGV5QnlaWFIxY200Z2RHaHBjenNnZlZ4dUlDQjlLVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl6WlhRdGMzQmxZMmxsY3k1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ09UaGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ05DQTFJaXdpTHk4Z055NHpMakl3SUZOd1pXTnBaWE5EYjI1emRISjFZM1J2Y2loUExDQmtaV1poZFd4MFEyOXVjM1J5ZFdOMGIzSXBYRzUyWVhJZ1lXNVBZbXBsWTNRZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmWVc0dGIySnFaV04wSnlsY2JpQWdMQ0JoUm5WdVkzUnBiMjRnUFNCeVpYRjFhWEpsS0NjdUwxOWhMV1oxYm1OMGFXOXVKeWxjYmlBZ0xDQlRVRVZEU1VWVElDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5M2EzTW5LU2duYzNCbFkybGxjeWNwTzF4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCbWRXNWpkR2x2YmloUExDQkVLWHRjYmlBZ2RtRnlJRU1nUFNCaGJrOWlhbVZqZENoUEtTNWpiMjV6ZEhKMVkzUnZjaXdnVXp0Y2JpQWdjbVYwZFhKdUlFTWdQVDA5SUhWdVpHVm1hVzVsWkNCOGZDQW9VeUE5SUdGdVQySnFaV04wS0VNcFcxTlFSVU5KUlZOZEtTQTlQU0IxYm1SbFptbHVaV1FnUHlCRUlEb2dZVVoxYm1OMGFXOXVLRk1wTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDNOd1pXTnBaWE10WTI5dWMzUnlkV04wYjNJdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEazVYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElEUWdOU0lzSW5aaGNpQWtaWGh3YjNKMElEMGdjbVZ4ZFdseVpTZ25MaTlmWlhod2IzSjBKeWxjYmk4dklERTVMakV1TWk0eUlDOGdNVFV1TWk0ekxqVWdUMkpxWldOMExtTnlaV0YwWlNoUElGc3NJRkJ5YjNCbGNuUnBaWE5kS1Z4dUpHVjRjRzl5ZENna1pYaHdiM0owTGxNc0lDZFBZbXBsWTNRbkxDQjdZM0psWVhSbE9pQnlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRZM0psWVhSbEp5bDlLVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNWpjbVZoZEdVdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlERXdNRnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENJdkx5QXhPUzR4TGpJdU9TQlBZbXBsWTNRdVoyVjBVSEp2ZEc5MGVYQmxUMllvVHlsY2JuWmhjaUIwYjA5aWFtVmpkQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXZZbXBsWTNRbktWeHVJQ0FzSUNSblpYUlFjbTkwYjNSNWNHVlBaaUE5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxbmNHOG5LVHRjYmx4dWNtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExYTmhjQ2NwS0NkblpYUlFjbTkwYjNSNWNHVlBaaWNzSUdaMWJtTjBhVzl1S0NsN1hHNGdJSEpsZEhWeWJpQm1kVzVqZEdsdmJpQm5aWFJRY205MGIzUjVjR1ZQWmlocGRDbDdYRzRnSUNBZ2NtVjBkWEp1SUNSblpYUlFjbTkwYjNSNWNHVlBaaWgwYjA5aWFtVmpkQ2hwZENrcE8xeHVJQ0I5TzF4dWZTazdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDJWek5pNXZZbXBsWTNRdVoyVjBMWEJ5YjNSdmRIbHdaUzF2Wmk1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01UQXhYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUlzSWk4dklERTVMakV1TWk0eE5DQlBZbXBsWTNRdWEyVjVjeWhQS1Z4dWRtRnlJSFJ2VDJKcVpXTjBJRDBnY21WeGRXbHlaU2duTGk5ZmRHOHRiMkpxWldOMEp5bGNiaUFnTENBa2EyVjVjeUFnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMXJaWGx6SnlrN1hHNWNibkpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzF6WVhBbktTZ25hMlY1Y3ljc0lHWjFibU4wYVc5dUtDbDdYRzRnSUhKbGRIVnliaUJtZFc1amRHbHZiaUJyWlhsektHbDBLWHRjYmlBZ0lDQnlaWFIxY200Z0pHdGxlWE1vZEc5UFltcGxZM1FvYVhRcEtUdGNiaUFnZlR0Y2JuMHBPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5bGN6WXViMkpxWldOMExtdGxlWE11YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURFd01seHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTWlBMElEVWlMQ0l2THlBeE9TNHhMak11TVRrZ1QySnFaV04wTG5ObGRGQnliM1J2ZEhsd1pVOW1LRThzSUhCeWIzUnZLVnh1ZG1GeUlDUmxlSEJ2Y25RZ1BTQnlaWEYxYVhKbEtDY3VMMTlsZUhCdmNuUW5LVHRjYmlSbGVIQnZjblFvSkdWNGNHOXlkQzVUTENBblQySnFaV04wSnl3Z2UzTmxkRkJ5YjNSdmRIbHdaVTltT2lCeVpYRjFhWEpsS0NjdUwxOXpaWFF0Y0hKdmRHOG5LUzV6WlhSOUtUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNMkxtOWlhbVZqZEM1elpYUXRjSEp2ZEc5MGVYQmxMVzltTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeE1ETmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJaXdpSjNWelpTQnpkSEpwWTNRbk8xeHVkbUZ5SUV4SlFsSkJVbGtnSUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMnhwWW5KaGNua25LVnh1SUNBc0lHZHNiMkpoYkNBZ0lDQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJkc2IySmhiQ2NwWEc0Z0lDd2dZM1I0SUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZlkzUjRKeWxjYmlBZ0xDQmpiR0Z6YzI5bUlDQWdJQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5amJHRnpjMjltSnlsY2JpQWdMQ0FrWlhod2IzSjBJQ0FnSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOWxlSEJ2Y25RbktWeHVJQ0FzSUdselQySnFaV04wSUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMmx6TFc5aWFtVmpkQ2NwWEc0Z0lDd2dZVVoxYm1OMGFXOXVJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZllTMW1kVzVqZEdsdmJpY3BYRzRnSUN3Z1lXNUpibk4wWVc1alpTQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmWVc0dGFXNXpkR0Z1WTJVbktWeHVJQ0FzSUdadmNrOW1JQ0FnSUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMlp2Y2kxdlppY3BYRzRnSUN3Z2MzQmxZMmxsYzBOdmJuTjBjblZqZEc5eUlEMGdjbVZ4ZFdseVpTZ25MaTlmYzNCbFkybGxjeTFqYjI1emRISjFZM1J2Y2ljcFhHNGdJQ3dnZEdGemF5QWdJQ0FnSUNBZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZkR0Z6YXljcExuTmxkRnh1SUNBc0lHMXBZM0p2ZEdGemF5QWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDIxcFkzSnZkR0Z6YXljcEtDbGNiaUFnTENCUVVrOU5TVk5GSUNBZ0lDQWdJQ0FnSUNBZ1BTQW5VSEp2YldselpTZGNiaUFnTENCVWVYQmxSWEp5YjNJZ0lDQWdJQ0FnSUNBZ1BTQm5iRzlpWVd3dVZIbHdaVVZ5Y205eVhHNGdJQ3dnY0hKdlkyVnpjeUFnSUNBZ0lDQWdJQ0FnSUQwZ1oyeHZZbUZzTG5CeWIyTmxjM05jYmlBZ0xDQWtVSEp2YldselpTQWdJQ0FnSUNBZ0lDQWdQU0JuYkc5aVlXeGJVRkpQVFVsVFJWMWNiaUFnTENCd2NtOWpaWE56SUNBZ0lDQWdJQ0FnSUNBZ1BTQm5iRzlpWVd3dWNISnZZMlZ6YzF4dUlDQXNJR2x6VG05a1pTQWdJQ0FnSUNBZ0lDQWdJQ0E5SUdOc1lYTnpiMllvY0hKdlkyVnpjeWtnUFQwZ0ozQnliMk5sYzNNblhHNGdJQ3dnWlcxd2RIa2dJQ0FnSUNBZ0lDQWdJQ0FnSUQwZ1puVnVZM1JwYjI0b0tYc2dMeW9nWlcxd2RIa2dLaThnZlZ4dUlDQXNJRWx1ZEdWeWJtRnNMQ0JIWlc1bGNtbGpVSEp2YldselpVTmhjR0ZpYVd4cGRIa3NJRmR5WVhCd1pYSTdYRzVjYm5aaGNpQlZVMFZmVGtGVVNWWkZJRDBnSVNGbWRXNWpkR2x2YmlncGUxeHVJQ0IwY25rZ2UxeHVJQ0FnSUM4dklHTnZjbkpsWTNRZ2MzVmlZMnhoYzNOcGJtY2dkMmwwYUNCQVFITndaV05wWlhNZ2MzVndjRzl5ZEZ4dUlDQWdJSFpoY2lCd2NtOXRhWE5sSUNBZ0lDQTlJQ1JRY205dGFYTmxMbkpsYzI5c2RtVW9NU2xjYmlBZ0lDQWdJQ3dnUm1GclpWQnliMjFwYzJVZ1BTQW9jSEp2YldselpTNWpiMjV6ZEhKMVkzUnZjaUE5SUh0OUtWdHlaWEYxYVhKbEtDY3VMMTkzYTNNbktTZ25jM0JsWTJsbGN5Y3BYU0E5SUdaMWJtTjBhVzl1S0dWNFpXTXBleUJsZUdWaktHVnRjSFI1TENCbGJYQjBlU2s3SUgwN1hHNGdJQ0FnTHk4Z2RXNW9ZVzVrYkdWa0lISmxhbVZqZEdsdmJuTWdkSEpoWTJ0cGJtY2djM1Z3Y0c5eWRDd2dUbTlrWlVwVElGQnliMjFwYzJVZ2QybDBhRzkxZENCcGRDQm1ZV2xzY3lCQVFITndaV05wWlhNZ2RHVnpkRnh1SUNBZ0lISmxkSFZ5YmlBb2FYTk9iMlJsSUh4OElIUjVjR1Z2WmlCUWNtOXRhWE5sVW1WcVpXTjBhVzl1UlhabGJuUWdQVDBnSjJaMWJtTjBhVzl1SnlrZ0ppWWdjSEp2YldselpTNTBhR1Z1S0dWdGNIUjVLU0JwYm5OMFlXNWpaVzltSUVaaGEyVlFjbTl0YVhObE8xeHVJQ0I5SUdOaGRHTm9LR1VwZXlBdktpQmxiWEIwZVNBcUx5QjlYRzU5S0NrN1hHNWNiaTh2SUdobGJIQmxjbk5jYm5aaGNpQnpZVzFsUTI5dWMzUnlkV04wYjNJZ1BTQm1kVzVqZEdsdmJpaGhMQ0JpS1h0Y2JpQWdMeThnZDJsMGFDQnNhV0p5WVhKNUlIZHlZWEJ3WlhJZ2MzQmxZMmxoYkNCallYTmxYRzRnSUhKbGRIVnliaUJoSUQwOVBTQmlJSHg4SUdFZ1BUMDlJQ1JRY205dGFYTmxJQ1ltSUdJZ1BUMDlJRmR5WVhCd1pYSTdYRzU5TzF4dWRtRnlJR2x6VkdobGJtRmliR1VnUFNCbWRXNWpkR2x2YmlocGRDbDdYRzRnSUhaaGNpQjBhR1Z1TzF4dUlDQnlaWFIxY200Z2FYTlBZbXBsWTNRb2FYUXBJQ1ltSUhSNWNHVnZaaUFvZEdobGJpQTlJR2wwTG5Sb1pXNHBJRDA5SUNkbWRXNWpkR2x2YmljZ1B5QjBhR1Z1SURvZ1ptRnNjMlU3WEc1OU8xeHVkbUZ5SUc1bGQxQnliMjFwYzJWRFlYQmhZbWxzYVhSNUlEMGdablZ1WTNScGIyNG9ReWw3WEc0Z0lISmxkSFZ5YmlCellXMWxRMjl1YzNSeWRXTjBiM0lvSkZCeWIyMXBjMlVzSUVNcFhHNGdJQ0FnUHlCdVpYY2dVSEp2YldselpVTmhjR0ZpYVd4cGRIa29ReWxjYmlBZ0lDQTZJRzVsZHlCSFpXNWxjbWxqVUhKdmJXbHpaVU5oY0dGaWFXeHBkSGtvUXlrN1hHNTlPMXh1ZG1GeUlGQnliMjFwYzJWRFlYQmhZbWxzYVhSNUlEMGdSMlZ1WlhKcFkxQnliMjFwYzJWRFlYQmhZbWxzYVhSNUlEMGdablZ1WTNScGIyNG9ReWw3WEc0Z0lIWmhjaUJ5WlhOdmJIWmxMQ0J5WldwbFkzUTdYRzRnSUhSb2FYTXVjSEp2YldselpTQTlJRzVsZHlCREtHWjFibU4wYVc5dUtDUWtjbVZ6YjJ4MlpTd2dKQ1J5WldwbFkzUXBlMXh1SUNBZ0lHbG1LSEpsYzI5c2RtVWdJVDA5SUhWdVpHVm1hVzVsWkNCOGZDQnlaV3BsWTNRZ0lUMDlJSFZ1WkdWbWFXNWxaQ2wwYUhKdmR5QlVlWEJsUlhKeWIzSW9KMEpoWkNCUWNtOXRhWE5sSUdOdmJuTjBjblZqZEc5eUp5azdYRzRnSUNBZ2NtVnpiMngyWlNBOUlDUWtjbVZ6YjJ4MlpUdGNiaUFnSUNCeVpXcGxZM1FnSUQwZ0pDUnlaV3BsWTNRN1hHNGdJSDBwTzF4dUlDQjBhR2x6TG5KbGMyOXNkbVVnUFNCaFJuVnVZM1JwYjI0b2NtVnpiMngyWlNrN1hHNGdJSFJvYVhNdWNtVnFaV04wSUNBOUlHRkdkVzVqZEdsdmJpaHlaV3BsWTNRcE8xeHVmVHRjYm5aaGNpQndaWEptYjNKdElEMGdablZ1WTNScGIyNG9aWGhsWXlsN1hHNGdJSFJ5ZVNCN1hHNGdJQ0FnWlhobFl5Z3BPMXh1SUNCOUlHTmhkR05vS0dVcGUxeHVJQ0FnSUhKbGRIVnliaUI3WlhKeWIzSTZJR1Y5TzF4dUlDQjlYRzU5TzF4dWRtRnlJRzV2ZEdsbWVTQTlJR1oxYm1OMGFXOXVLSEJ5YjIxcGMyVXNJR2x6VW1WcVpXTjBLWHRjYmlBZ2FXWW9jSEp2YldselpTNWZiaWx5WlhSMWNtNDdYRzRnSUhCeWIyMXBjMlV1WDI0Z1BTQjBjblZsTzF4dUlDQjJZWElnWTJoaGFXNGdQU0J3Y205dGFYTmxMbDlqTzF4dUlDQnRhV055YjNSaGMyc29ablZ1WTNScGIyNG9LWHRjYmlBZ0lDQjJZWElnZG1Gc2RXVWdQU0J3Y205dGFYTmxMbDkyWEc0Z0lDQWdJQ0FzSUc5cklDQWdJRDBnY0hKdmJXbHpaUzVmY3lBOVBTQXhYRzRnSUNBZ0lDQXNJR2tnSUNBZ0lEMGdNRHRjYmlBZ0lDQjJZWElnY25WdUlEMGdablZ1WTNScGIyNG9jbVZoWTNScGIyNHBlMXh1SUNBZ0lDQWdkbUZ5SUdoaGJtUnNaWElnUFNCdmF5QS9JSEpsWVdOMGFXOXVMbTlySURvZ2NtVmhZM1JwYjI0dVptRnBiRnh1SUNBZ0lDQWdJQ0FzSUhKbGMyOXNkbVVnUFNCeVpXRmpkR2x2Ymk1eVpYTnZiSFpsWEc0Z0lDQWdJQ0FnSUN3Z2NtVnFaV04wSUNBOUlISmxZV04wYVc5dUxuSmxhbVZqZEZ4dUlDQWdJQ0FnSUNBc0lHUnZiV0ZwYmlBZ1BTQnlaV0ZqZEdsdmJpNWtiMjFoYVc1Y2JpQWdJQ0FnSUNBZ0xDQnlaWE4xYkhRc0lIUm9aVzQ3WEc0Z0lDQWdJQ0IwY25rZ2UxeHVJQ0FnSUNBZ0lDQnBaaWhvWVc1a2JHVnlLWHRjYmlBZ0lDQWdJQ0FnSUNCcFppZ2hiMnNwZTF4dUlDQWdJQ0FnSUNBZ0lDQWdhV1lvY0hKdmJXbHpaUzVmYUNBOVBTQXlLVzl1U0dGdVpHeGxWVzVvWVc1a2JHVmtLSEJ5YjIxcGMyVXBPMXh1SUNBZ0lDQWdJQ0FnSUNBZ2NISnZiV2x6WlM1ZmFDQTlJREU3WEc0Z0lDQWdJQ0FnSUNBZ2ZWeHVJQ0FnSUNBZ0lDQWdJR2xtS0doaGJtUnNaWElnUFQwOUlIUnlkV1VwY21WemRXeDBJRDBnZG1Gc2RXVTdYRzRnSUNBZ0lDQWdJQ0FnWld4elpTQjdYRzRnSUNBZ0lDQWdJQ0FnSUNCcFppaGtiMjFoYVc0cFpHOXRZV2x1TG1WdWRHVnlLQ2s3WEc0Z0lDQWdJQ0FnSUNBZ0lDQnlaWE4xYkhRZ1BTQm9ZVzVrYkdWeUtIWmhiSFZsS1R0Y2JpQWdJQ0FnSUNBZ0lDQWdJR2xtS0dSdmJXRnBiaWxrYjIxaGFXNHVaWGhwZENncE8xeHVJQ0FnSUNBZ0lDQWdJSDFjYmlBZ0lDQWdJQ0FnSUNCcFppaHlaWE4xYkhRZ1BUMDlJSEpsWVdOMGFXOXVMbkJ5YjIxcGMyVXBlMXh1SUNBZ0lDQWdJQ0FnSUNBZ2NtVnFaV04wS0ZSNWNHVkZjbkp2Y2lnblVISnZiV2x6WlMxamFHRnBiaUJqZVdOc1pTY3BLVHRjYmlBZ0lDQWdJQ0FnSUNCOUlHVnNjMlVnYVdZb2RHaGxiaUE5SUdselZHaGxibUZpYkdVb2NtVnpkV3gwS1NsN1hHNGdJQ0FnSUNBZ0lDQWdJQ0IwYUdWdUxtTmhiR3dvY21WemRXeDBMQ0J5WlhOdmJIWmxMQ0J5WldwbFkzUXBPMXh1SUNBZ0lDQWdJQ0FnSUgwZ1pXeHpaU0J5WlhOdmJIWmxLSEpsYzNWc2RDazdYRzRnSUNBZ0lDQWdJSDBnWld4elpTQnlaV3BsWTNRb2RtRnNkV1VwTzF4dUlDQWdJQ0FnZlNCallYUmphQ2hsS1h0Y2JpQWdJQ0FnSUNBZ2NtVnFaV04wS0dVcE8xeHVJQ0FnSUNBZ2ZWeHVJQ0FnSUgwN1hHNGdJQ0FnZDJocGJHVW9ZMmhoYVc0dWJHVnVaM1JvSUQ0Z2FTbHlkVzRvWTJoaGFXNWJhU3NyWFNrN0lDOHZJSFpoY21saFlteGxJR3hsYm1kMGFDQXRJR05oYmlkMElIVnpaU0JtYjNKRllXTm9YRzRnSUNBZ2NISnZiV2x6WlM1Zll5QTlJRnRkTzF4dUlDQWdJSEJ5YjIxcGMyVXVYMjRnUFNCbVlXeHpaVHRjYmlBZ0lDQnBaaWhwYzFKbGFtVmpkQ0FtSmlBaGNISnZiV2x6WlM1ZmFDbHZibFZ1YUdGdVpHeGxaQ2h3Y205dGFYTmxLVHRjYmlBZ2ZTazdYRzU5TzF4dWRtRnlJRzl1Vlc1b1lXNWtiR1ZrSUQwZ1puVnVZM1JwYjI0b2NISnZiV2x6WlNsN1hHNGdJSFJoYzJzdVkyRnNiQ2huYkc5aVlXd3NJR1oxYm1OMGFXOXVLQ2w3WEc0Z0lDQWdkbUZ5SUhaaGJIVmxJRDBnY0hKdmJXbHpaUzVmZGx4dUlDQWdJQ0FnTENCaFluSjFjSFFzSUdoaGJtUnNaWElzSUdOdmJuTnZiR1U3WEc0Z0lDQWdhV1lvYVhOVmJtaGhibVJzWldRb2NISnZiV2x6WlNrcGUxeHVJQ0FnSUNBZ1lXSnlkWEIwSUQwZ2NHVnlabTl5YlNobWRXNWpkR2x2YmlncGUxeHVJQ0FnSUNBZ0lDQnBaaWhwYzA1dlpHVXBlMXh1SUNBZ0lDQWdJQ0FnSUhCeWIyTmxjM011WlcxcGRDZ25kVzVvWVc1a2JHVmtVbVZxWldOMGFXOXVKeXdnZG1Gc2RXVXNJSEJ5YjIxcGMyVXBPMXh1SUNBZ0lDQWdJQ0I5SUdWc2MyVWdhV1lvYUdGdVpHeGxjaUE5SUdkc2IySmhiQzV2Ym5WdWFHRnVaR3hsWkhKbGFtVmpkR2x2YmlsN1hHNGdJQ0FnSUNBZ0lDQWdhR0Z1Wkd4bGNpaDdjSEp2YldselpUb2djSEp2YldselpTd2djbVZoYzI5dU9pQjJZV3gxWlgwcE8xeHVJQ0FnSUNBZ0lDQjlJR1ZzYzJVZ2FXWW9LR052Ym5OdmJHVWdQU0JuYkc5aVlXd3VZMjl1YzI5c1pTa2dKaVlnWTI5dWMyOXNaUzVsY25KdmNpbDdYRzRnSUNBZ0lDQWdJQ0FnWTI5dWMyOXNaUzVsY25KdmNpZ25WVzVvWVc1a2JHVmtJSEJ5YjIxcGMyVWdjbVZxWldOMGFXOXVKeXdnZG1Gc2RXVXBPMXh1SUNBZ0lDQWdJQ0I5WEc0Z0lDQWdJQ0I5S1R0Y2JpQWdJQ0FnSUM4dklFSnliM2R6WlhKeklITm9iM1ZzWkNCdWIzUWdkSEpwWjJkbGNpQmdjbVZxWldOMGFXOXVTR0Z1Wkd4bFpHQWdaWFpsYm5RZ2FXWWdhWFFnZDJGeklHaGhibVJzWldRZ2FHVnlaU3dnVG05a1pVcFRJQzBnYzJodmRXeGtYRzRnSUNBZ0lDQndjbTl0YVhObExsOW9JRDBnYVhOT2IyUmxJSHg4SUdselZXNW9ZVzVrYkdWa0tIQnliMjFwYzJVcElEOGdNaUE2SURFN1hHNGdJQ0FnZlNCd2NtOXRhWE5sTGw5aElEMGdkVzVrWldacGJtVmtPMXh1SUNBZ0lHbG1LR0ZpY25Wd2RDbDBhSEp2ZHlCaFluSjFjSFF1WlhKeWIzSTdYRzRnSUgwcE8xeHVmVHRjYm5aaGNpQnBjMVZ1YUdGdVpHeGxaQ0E5SUdaMWJtTjBhVzl1S0hCeWIyMXBjMlVwZTF4dUlDQnBaaWh3Y205dGFYTmxMbDlvSUQwOUlERXBjbVYwZFhKdUlHWmhiSE5sTzF4dUlDQjJZWElnWTJoaGFXNGdQU0J3Y205dGFYTmxMbDloSUh4OElIQnliMjFwYzJVdVgyTmNiaUFnSUNBc0lHa2dJQ0FnSUQwZ01GeHVJQ0FnSUN3Z2NtVmhZM1JwYjI0N1hHNGdJSGRvYVd4bEtHTm9ZV2x1TG14bGJtZDBhQ0ErSUdrcGUxeHVJQ0FnSUhKbFlXTjBhVzl1SUQwZ1kyaGhhVzViYVNzclhUdGNiaUFnSUNCcFppaHlaV0ZqZEdsdmJpNW1ZV2xzSUh4OElDRnBjMVZ1YUdGdVpHeGxaQ2h5WldGamRHbHZiaTV3Y205dGFYTmxLU2x5WlhSMWNtNGdabUZzYzJVN1hHNGdJSDBnY21WMGRYSnVJSFJ5ZFdVN1hHNTlPMXh1ZG1GeUlHOXVTR0Z1Wkd4bFZXNW9ZVzVrYkdWa0lEMGdablZ1WTNScGIyNG9jSEp2YldselpTbDdYRzRnSUhSaGMyc3VZMkZzYkNobmJHOWlZV3dzSUdaMWJtTjBhVzl1S0NsN1hHNGdJQ0FnZG1GeUlHaGhibVJzWlhJN1hHNGdJQ0FnYVdZb2FYTk9iMlJsS1h0Y2JpQWdJQ0FnSUhCeWIyTmxjM011WlcxcGRDZ25jbVZxWldOMGFXOXVTR0Z1Wkd4bFpDY3NJSEJ5YjIxcGMyVXBPMXh1SUNBZ0lIMGdaV3h6WlNCcFppaG9ZVzVrYkdWeUlEMGdaMnh2WW1Gc0xtOXVjbVZxWldOMGFXOXVhR0Z1Wkd4bFpDbDdYRzRnSUNBZ0lDQm9ZVzVrYkdWeUtIdHdjbTl0YVhObE9pQndjbTl0YVhObExDQnlaV0Z6YjI0NklIQnliMjFwYzJVdVgzWjlLVHRjYmlBZ0lDQjlYRzRnSUgwcE8xeHVmVHRjYm5aaGNpQWtjbVZxWldOMElEMGdablZ1WTNScGIyNG9kbUZzZFdVcGUxeHVJQ0IyWVhJZ2NISnZiV2x6WlNBOUlIUm9hWE03WEc0Z0lHbG1LSEJ5YjIxcGMyVXVYMlFwY21WMGRYSnVPMXh1SUNCd2NtOXRhWE5sTGw5a0lEMGdkSEoxWlR0Y2JpQWdjSEp2YldselpTQTlJSEJ5YjIxcGMyVXVYM2NnZkh3Z2NISnZiV2x6WlRzZ0x5OGdkVzUzY21Gd1hHNGdJSEJ5YjIxcGMyVXVYM1lnUFNCMllXeDFaVHRjYmlBZ2NISnZiV2x6WlM1ZmN5QTlJREk3WEc0Z0lHbG1LQ0Z3Y205dGFYTmxMbDloS1hCeWIyMXBjMlV1WDJFZ1BTQndjbTl0YVhObExsOWpMbk5zYVdObEtDazdYRzRnSUc1dmRHbG1lU2h3Y205dGFYTmxMQ0IwY25WbEtUdGNibjA3WEc1MllYSWdKSEpsYzI5c2RtVWdQU0JtZFc1amRHbHZiaWgyWVd4MVpTbDdYRzRnSUhaaGNpQndjbTl0YVhObElEMGdkR2hwYzF4dUlDQWdJQ3dnZEdobGJqdGNiaUFnYVdZb2NISnZiV2x6WlM1ZlpDbHlaWFIxY200N1hHNGdJSEJ5YjIxcGMyVXVYMlFnUFNCMGNuVmxPMXh1SUNCd2NtOXRhWE5sSUQwZ2NISnZiV2x6WlM1ZmR5QjhmQ0J3Y205dGFYTmxPeUF2THlCMWJuZHlZWEJjYmlBZ2RISjVJSHRjYmlBZ0lDQnBaaWh3Y205dGFYTmxJRDA5UFNCMllXeDFaU2wwYUhKdmR5QlVlWEJsUlhKeWIzSW9YQ0pRY205dGFYTmxJR05oYmlkMElHSmxJSEpsYzI5c2RtVmtJR2wwYzJWc1psd2lLVHRjYmlBZ0lDQnBaaWgwYUdWdUlEMGdhWE5VYUdWdVlXSnNaU2gyWVd4MVpTa3BlMXh1SUNBZ0lDQWdiV2xqY205MFlYTnJLR1oxYm1OMGFXOXVLQ2w3WEc0Z0lDQWdJQ0FnSUhaaGNpQjNjbUZ3Y0dWeUlEMGdlMTkzT2lCd2NtOXRhWE5sTENCZlpEb2dabUZzYzJWOU95QXZMeUIzY21Gd1hHNGdJQ0FnSUNBZ0lIUnllU0I3WEc0Z0lDQWdJQ0FnSUNBZ2RHaGxiaTVqWVd4c0tIWmhiSFZsTENCamRIZ29KSEpsYzI5c2RtVXNJSGR5WVhCd1pYSXNJREVwTENCamRIZ29KSEpsYW1WamRDd2dkM0poY0hCbGNpd2dNU2twTzF4dUlDQWdJQ0FnSUNCOUlHTmhkR05vS0dVcGUxeHVJQ0FnSUNBZ0lDQWdJQ1J5WldwbFkzUXVZMkZzYkNoM2NtRndjR1Z5TENCbEtUdGNiaUFnSUNBZ0lDQWdmVnh1SUNBZ0lDQWdmU2s3WEc0Z0lDQWdmU0JsYkhObElIdGNiaUFnSUNBZ0lIQnliMjFwYzJVdVgzWWdQU0IyWVd4MVpUdGNiaUFnSUNBZ0lIQnliMjFwYzJVdVgzTWdQU0F4TzF4dUlDQWdJQ0FnYm05MGFXWjVLSEJ5YjIxcGMyVXNJR1poYkhObEtUdGNiaUFnSUNCOVhHNGdJSDBnWTJGMFkyZ29aU2w3WEc0Z0lDQWdKSEpsYW1WamRDNWpZV3hzS0h0ZmR6b2djSEp2YldselpTd2dYMlE2SUdaaGJITmxmU3dnWlNrN0lDOHZJSGR5WVhCY2JpQWdmVnh1ZlR0Y2JseHVMeThnWTI5dWMzUnlkV04wYjNJZ2NHOXNlV1pwYkd4Y2JtbG1LQ0ZWVTBWZlRrRlVTVlpGS1h0Y2JpQWdMeThnTWpVdU5DNHpMakVnVUhKdmJXbHpaU2hsZUdWamRYUnZjaWxjYmlBZ0pGQnliMjFwYzJVZ1BTQm1kVzVqZEdsdmJpQlFjbTl0YVhObEtHVjRaV04xZEc5eUtYdGNiaUFnSUNCaGJrbHVjM1JoYm1ObEtIUm9hWE1zSUNSUWNtOXRhWE5sTENCUVVrOU5TVk5GTENBblgyZ25LVHRjYmlBZ0lDQmhSblZ1WTNScGIyNG9aWGhsWTNWMGIzSXBPMXh1SUNBZ0lFbHVkR1Z5Ym1Gc0xtTmhiR3dvZEdocGN5azdYRzRnSUNBZ2RISjVJSHRjYmlBZ0lDQWdJR1Y0WldOMWRHOXlLR04wZUNna2NtVnpiMngyWlN3Z2RHaHBjeXdnTVNrc0lHTjBlQ2drY21WcVpXTjBMQ0IwYUdsekxDQXhLU2s3WEc0Z0lDQWdmU0JqWVhSamFDaGxjbklwZTF4dUlDQWdJQ0FnSkhKbGFtVmpkQzVqWVd4c0tIUm9hWE1zSUdWeWNpazdYRzRnSUNBZ2ZWeHVJQ0I5TzF4dUlDQkpiblJsY201aGJDQTlJR1oxYm1OMGFXOXVJRkJ5YjIxcGMyVW9aWGhsWTNWMGIzSXBlMXh1SUNBZ0lIUm9hWE11WDJNZ1BTQmJYVHNnSUNBZ0lDQWdJQ0FnSUNBZ0x5OGdQQzBnWVhkaGFYUnBibWNnY21WaFkzUnBiMjV6WEc0Z0lDQWdkR2hwY3k1ZllTQTlJSFZ1WkdWbWFXNWxaRHNnSUNBZ0lDQXZMeUE4TFNCamFHVmphMlZrSUdsdUlHbHpWVzVvWVc1a2JHVmtJSEpsWVdOMGFXOXVjMXh1SUNBZ0lIUm9hWE11WDNNZ1BTQXdPeUFnSUNBZ0lDQWdJQ0FnSUNBZ0x5OGdQQzBnYzNSaGRHVmNiaUFnSUNCMGFHbHpMbDlrSUQwZ1ptRnNjMlU3SUNBZ0lDQWdJQ0FnSUM4dklEd3RJR1J2Ym1WY2JpQWdJQ0IwYUdsekxsOTJJRDBnZFc1a1pXWnBibVZrT3lBZ0lDQWdJQzh2SUR3dElIWmhiSFZsWEc0Z0lDQWdkR2hwY3k1ZmFDQTlJREE3SUNBZ0lDQWdJQ0FnSUNBZ0lDQXZMeUE4TFNCeVpXcGxZM1JwYjI0Z2MzUmhkR1VzSURBZ0xTQmtaV1poZFd4MExDQXhJQzBnYUdGdVpHeGxaQ3dnTWlBdElIVnVhR0Z1Wkd4bFpGeHVJQ0FnSUhSb2FYTXVYMjRnUFNCbVlXeHpaVHNnSUNBZ0lDQWdJQ0FnTHk4Z1BDMGdibTkwYVdaNVhHNGdJSDA3WEc0Z0lFbHVkR1Z5Ym1Gc0xuQnliM1J2ZEhsd1pTQTlJSEpsY1hWcGNtVW9KeTR2WDNKbFpHVm1hVzVsTFdGc2JDY3BLQ1JRY205dGFYTmxMbkJ5YjNSdmRIbHdaU3dnZTF4dUlDQWdJQzh2SURJMUxqUXVOUzR6SUZCeWIyMXBjMlV1Y0hKdmRHOTBlWEJsTG5Sb1pXNG9iMjVHZFd4bWFXeHNaV1FzSUc5dVVtVnFaV04wWldRcFhHNGdJQ0FnZEdobGJqb2dablZ1WTNScGIyNGdkR2hsYmlodmJrWjFiR1pwYkd4bFpDd2diMjVTWldwbFkzUmxaQ2w3WEc0Z0lDQWdJQ0IyWVhJZ2NtVmhZM1JwYjI0Z0lDQWdQU0J1WlhkUWNtOXRhWE5sUTJGd1lXSnBiR2wwZVNoemNHVmphV1Z6UTI5dWMzUnlkV04wYjNJb2RHaHBjeXdnSkZCeWIyMXBjMlVwS1R0Y2JpQWdJQ0FnSUhKbFlXTjBhVzl1TG05cklDQWdJQ0E5SUhSNWNHVnZaaUJ2YmtaMWJHWnBiR3hsWkNBOVBTQW5ablZ1WTNScGIyNG5JRDhnYjI1R2RXeG1hV3hzWldRZ09pQjBjblZsTzF4dUlDQWdJQ0FnY21WaFkzUnBiMjR1Wm1GcGJDQWdJRDBnZEhsd1pXOW1JRzl1VW1WcVpXTjBaV1FnUFQwZ0oyWjFibU4wYVc5dUp5QW1KaUJ2YmxKbGFtVmpkR1ZrTzF4dUlDQWdJQ0FnY21WaFkzUnBiMjR1Wkc5dFlXbHVJRDBnYVhOT2IyUmxJRDhnY0hKdlkyVnpjeTVrYjIxaGFXNGdPaUIxYm1SbFptbHVaV1E3WEc0Z0lDQWdJQ0IwYUdsekxsOWpMbkIxYzJnb2NtVmhZM1JwYjI0cE8xeHVJQ0FnSUNBZ2FXWW9kR2hwY3k1ZllTbDBhR2x6TGw5aExuQjFjMmdvY21WaFkzUnBiMjRwTzF4dUlDQWdJQ0FnYVdZb2RHaHBjeTVmY3lsdWIzUnBabmtvZEdocGN5d2dabUZzYzJVcE8xeHVJQ0FnSUNBZ2NtVjBkWEp1SUhKbFlXTjBhVzl1TG5CeWIyMXBjMlU3WEc0Z0lDQWdmU3hjYmlBZ0lDQXZMeUF5TlM0MExqVXVNU0JRY205dGFYTmxMbkJ5YjNSdmRIbHdaUzVqWVhSamFDaHZibEpsYW1WamRHVmtLVnh1SUNBZ0lDZGpZWFJqYUNjNklHWjFibU4wYVc5dUtHOXVVbVZxWldOMFpXUXBlMXh1SUNBZ0lDQWdjbVYwZFhKdUlIUm9hWE11ZEdobGJpaDFibVJsWm1sdVpXUXNJRzl1VW1WcVpXTjBaV1FwTzF4dUlDQWdJSDFjYmlBZ2ZTazdYRzRnSUZCeWIyMXBjMlZEWVhCaFltbHNhWFI1SUQwZ1puVnVZM1JwYjI0b0tYdGNiaUFnSUNCMllYSWdjSEp2YldselpTQWdQU0J1WlhjZ1NXNTBaWEp1WVd3N1hHNGdJQ0FnZEdocGN5NXdjbTl0YVhObElEMGdjSEp2YldselpUdGNiaUFnSUNCMGFHbHpMbkpsYzI5c2RtVWdQU0JqZEhnb0pISmxjMjlzZG1Vc0lIQnliMjFwYzJVc0lERXBPMXh1SUNBZ0lIUm9hWE11Y21WcVpXTjBJQ0E5SUdOMGVDZ2tjbVZxWldOMExDQndjbTl0YVhObExDQXhLVHRjYmlBZ2ZUdGNibjFjYmx4dUpHVjRjRzl5ZENna1pYaHdiM0owTGtjZ0t5QWtaWGh3YjNKMExsY2dLeUFrWlhod2IzSjBMa1lnS2lBaFZWTkZYMDVCVkVsV1JTd2dlMUJ5YjIxcGMyVTZJQ1JRY205dGFYTmxmU2s3WEc1eVpYRjFhWEpsS0NjdUwxOXpaWFF0ZEc4dGMzUnlhVzVuTFhSaFp5Y3BLQ1JRY205dGFYTmxMQ0JRVWs5TlNWTkZLVHRjYm5KbGNYVnBjbVVvSnk0dlgzTmxkQzF6Y0dWamFXVnpKeWtvVUZKUFRVbFRSU2s3WEc1WGNtRndjR1Z5SUQwZ2NtVnhkV2x5WlNnbkxpOWZZMjl5WlNjcFcxQlNUMDFKVTBWZE8xeHVYRzR2THlCemRHRjBhV056WEc0a1pYaHdiM0owS0NSbGVIQnZjblF1VXlBcklDUmxlSEJ2Y25RdVJpQXFJQ0ZWVTBWZlRrRlVTVlpGTENCUVVrOU5TVk5GTENCN1hHNGdJQzh2SURJMUxqUXVOQzQxSUZCeWIyMXBjMlV1Y21WcVpXTjBLSElwWEc0Z0lISmxhbVZqZERvZ1puVnVZM1JwYjI0Z2NtVnFaV04wS0hJcGUxeHVJQ0FnSUhaaGNpQmpZWEJoWW1sc2FYUjVJRDBnYm1WM1VISnZiV2x6WlVOaGNHRmlhV3hwZEhrb2RHaHBjeWxjYmlBZ0lDQWdJQ3dnSkNSeVpXcGxZM1FnSUNBOUlHTmhjR0ZpYVd4cGRIa3VjbVZxWldOME8xeHVJQ0FnSUNRa2NtVnFaV04wS0hJcE8xeHVJQ0FnSUhKbGRIVnliaUJqWVhCaFltbHNhWFI1TG5CeWIyMXBjMlU3WEc0Z0lIMWNibjBwTzF4dUpHVjRjRzl5ZENna1pYaHdiM0owTGxNZ0t5QWtaWGh3YjNKMExrWWdLaUFvVEVsQ1VrRlNXU0I4ZkNBaFZWTkZYMDVCVkVsV1JTa3NJRkJTVDAxSlUwVXNJSHRjYmlBZ0x5OGdNalV1TkM0MExqWWdVSEp2YldselpTNXlaWE52YkhabEtIZ3BYRzRnSUhKbGMyOXNkbVU2SUdaMWJtTjBhVzl1SUhKbGMyOXNkbVVvZUNsN1hHNGdJQ0FnTHk4Z2FXNXpkR0Z1WTJWdlppQnBibk4wWldGa0lHOW1JR2x1ZEdWeWJtRnNJSE5zYjNRZ1kyaGxZMnNnWW1WallYVnpaU0IzWlNCemFHOTFiR1FnWm1sNElHbDBJSGRwZEdodmRYUWdjbVZ3YkdGalpXMWxiblFnYm1GMGFYWmxJRkJ5YjIxcGMyVWdZMjl5WlZ4dUlDQWdJR2xtS0hnZ2FXNXpkR0Z1WTJWdlppQWtVSEp2YldselpTQW1KaUJ6WVcxbFEyOXVjM1J5ZFdOMGIzSW9lQzVqYjI1emRISjFZM1J2Y2l3Z2RHaHBjeWtwY21WMGRYSnVJSGc3WEc0Z0lDQWdkbUZ5SUdOaGNHRmlhV3hwZEhrZ1BTQnVaWGRRY205dGFYTmxRMkZ3WVdKcGJHbDBlU2gwYUdsektWeHVJQ0FnSUNBZ0xDQWtKSEpsYzI5c2RtVWdJRDBnWTJGd1lXSnBiR2wwZVM1eVpYTnZiSFpsTzF4dUlDQWdJQ1FrY21WemIyeDJaU2g0S1R0Y2JpQWdJQ0J5WlhSMWNtNGdZMkZ3WVdKcGJHbDBlUzV3Y205dGFYTmxPMXh1SUNCOVhHNTlLVHRjYmlSbGVIQnZjblFvSkdWNGNHOXlkQzVUSUNzZ0pHVjRjRzl5ZEM1R0lDb2dJU2hWVTBWZlRrRlVTVlpGSUNZbUlISmxjWFZwY21Vb0p5NHZYMmwwWlhJdFpHVjBaV04wSnlrb1puVnVZM1JwYjI0b2FYUmxjaWw3WEc0Z0lDUlFjbTl0YVhObExtRnNiQ2hwZEdWeUtWc25ZMkYwWTJnblhTaGxiWEIwZVNrN1hHNTlLU2tzSUZCU1QwMUpVMFVzSUh0Y2JpQWdMeThnTWpVdU5DNDBMakVnVUhKdmJXbHpaUzVoYkd3b2FYUmxjbUZpYkdVcFhHNGdJR0ZzYkRvZ1puVnVZM1JwYjI0Z1lXeHNLR2wwWlhKaFlteGxLWHRjYmlBZ0lDQjJZWElnUXlBZ0lDQWdJQ0FnSUNBOUlIUm9hWE5jYmlBZ0lDQWdJQ3dnWTJGd1lXSnBiR2wwZVNBOUlHNWxkMUJ5YjIxcGMyVkRZWEJoWW1sc2FYUjVLRU1wWEc0Z0lDQWdJQ0FzSUhKbGMyOXNkbVVnSUNBZ1BTQmpZWEJoWW1sc2FYUjVMbkpsYzI5c2RtVmNiaUFnSUNBZ0lDd2djbVZxWldOMElDQWdJQ0E5SUdOaGNHRmlhV3hwZEhrdWNtVnFaV04wTzF4dUlDQWdJSFpoY2lCaFluSjFjSFFnUFNCd1pYSm1iM0p0S0daMWJtTjBhVzl1S0NsN1hHNGdJQ0FnSUNCMllYSWdkbUZzZFdWeklDQWdJRDBnVzExY2JpQWdJQ0FnSUNBZ0xDQnBibVJsZUNBZ0lDQWdQU0F3WEc0Z0lDQWdJQ0FnSUN3Z2NtVnRZV2x1YVc1bklEMGdNVHRjYmlBZ0lDQWdJR1p2Y2s5bUtHbDBaWEpoWW14bExDQm1ZV3h6WlN3Z1puVnVZM1JwYjI0b2NISnZiV2x6WlNsN1hHNGdJQ0FnSUNBZ0lIWmhjaUFrYVc1a1pYZ2dJQ0FnSUNBZ0lEMGdhVzVrWlhncksxeHVJQ0FnSUNBZ0lDQWdJQ3dnWVd4eVpXRmtlVU5oYkd4bFpDQTlJR1poYkhObE8xeHVJQ0FnSUNBZ0lDQjJZV3gxWlhNdWNIVnphQ2gxYm1SbFptbHVaV1FwTzF4dUlDQWdJQ0FnSUNCeVpXMWhhVzVwYm1jckt6dGNiaUFnSUNBZ0lDQWdReTV5WlhOdmJIWmxLSEJ5YjIxcGMyVXBMblJvWlc0b1puVnVZM1JwYjI0b2RtRnNkV1VwZTF4dUlDQWdJQ0FnSUNBZ0lHbG1LR0ZzY21WaFpIbERZV3hzWldRcGNtVjBkWEp1TzF4dUlDQWdJQ0FnSUNBZ0lHRnNjbVZoWkhsRFlXeHNaV1FnSUQwZ2RISjFaVHRjYmlBZ0lDQWdJQ0FnSUNCMllXeDFaWE5iSkdsdVpHVjRYU0E5SUhaaGJIVmxPMXh1SUNBZ0lDQWdJQ0FnSUMwdGNtVnRZV2x1YVc1bklIeDhJSEpsYzI5c2RtVW9kbUZzZFdWektUdGNiaUFnSUNBZ0lDQWdmU3dnY21WcVpXTjBLVHRjYmlBZ0lDQWdJSDBwTzF4dUlDQWdJQ0FnTFMxeVpXMWhhVzVwYm1jZ2ZId2djbVZ6YjJ4MlpTaDJZV3gxWlhNcE8xeHVJQ0FnSUgwcE8xeHVJQ0FnSUdsbUtHRmljblZ3ZENseVpXcGxZM1FvWVdKeWRYQjBMbVZ5Y205eUtUdGNiaUFnSUNCeVpYUjFjbTRnWTJGd1lXSnBiR2wwZVM1d2NtOXRhWE5sTzF4dUlDQjlMRnh1SUNBdkx5QXlOUzQwTGpRdU5DQlFjbTl0YVhObExuSmhZMlVvYVhSbGNtRmliR1VwWEc0Z0lISmhZMlU2SUdaMWJtTjBhVzl1SUhKaFkyVW9hWFJsY21GaWJHVXBlMXh1SUNBZ0lIWmhjaUJESUNBZ0lDQWdJQ0FnSUQwZ2RHaHBjMXh1SUNBZ0lDQWdMQ0JqWVhCaFltbHNhWFI1SUQwZ2JtVjNVSEp2YldselpVTmhjR0ZpYVd4cGRIa29ReWxjYmlBZ0lDQWdJQ3dnY21WcVpXTjBJQ0FnSUNBOUlHTmhjR0ZpYVd4cGRIa3VjbVZxWldOME8xeHVJQ0FnSUhaaGNpQmhZbkoxY0hRZ1BTQndaWEptYjNKdEtHWjFibU4wYVc5dUtDbDdYRzRnSUNBZ0lDQm1iM0pQWmlocGRHVnlZV0pzWlN3Z1ptRnNjMlVzSUdaMWJtTjBhVzl1S0hCeWIyMXBjMlVwZTF4dUlDQWdJQ0FnSUNCRExuSmxjMjlzZG1Vb2NISnZiV2x6WlNrdWRHaGxiaWhqWVhCaFltbHNhWFI1TG5KbGMyOXNkbVVzSUhKbGFtVmpkQ2s3WEc0Z0lDQWdJQ0I5S1R0Y2JpQWdJQ0I5S1R0Y2JpQWdJQ0JwWmloaFluSjFjSFFwY21WcVpXTjBLR0ZpY25Wd2RDNWxjbkp2Y2lrN1hHNGdJQ0FnY21WMGRYSnVJR05oY0dGaWFXeHBkSGt1Y0hKdmJXbHpaVHRjYmlBZ2ZWeHVmU2s3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwyVnpOaTV3Y205dGFYTmxMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F4TURSY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTkNBMUlpd2lKM1Z6WlNCemRISnBZM1FuTzF4dUx5OGdSVU5OUVZOamNtbHdkQ0EySUhONWJXSnZiSE1nYzJocGJWeHVkbUZ5SUdkc2IySmhiQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZloyeHZZbUZzSnlsY2JpQWdMQ0JvWVhNZ0lDQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJoaGN5Y3BYRzRnSUN3Z1JFVlRRMUpKVUZSUFVsTWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOWtaWE5qY21sd2RHOXljeWNwWEc0Z0lDd2dKR1Y0Y0c5eWRDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlsZUhCdmNuUW5LVnh1SUNBc0lISmxaR1ZtYVc1bElDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZjbVZrWldacGJtVW5LVnh1SUNBc0lFMUZWRUVnSUNBZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZiV1YwWVNjcExrdEZXVnh1SUNBc0lDUm1ZV2xzY3lBZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZabUZwYkhNbktWeHVJQ0FzSUhOb1lYSmxaQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmMyaGhjbVZrSnlsY2JpQWdMQ0J6WlhSVWIxTjBjbWx1WjFSaFp5QTlJSEpsY1hWcGNtVW9KeTR2WDNObGRDMTBieTF6ZEhKcGJtY3RkR0ZuSnlsY2JpQWdMQ0IxYVdRZ0lDQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDNWcFpDY3BYRzRnSUN3Z2QydHpJQ0FnSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOTNhM01uS1Z4dUlDQXNJSGRyYzBWNGRDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZDJ0ekxXVjRkQ2NwWEc0Z0lDd2dkMnR6UkdWbWFXNWxJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTkzYTNNdFpHVm1hVzVsSnlsY2JpQWdMQ0JyWlhsUFppQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJ0bGVXOW1KeWxjYmlBZ0xDQmxiblZ0UzJWNWN5QWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMlZ1ZFcwdGEyVjVjeWNwWEc0Z0lDd2dhWE5CY25KaGVTQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlwY3kxaGNuSmhlU2NwWEc0Z0lDd2dZVzVQWW1wbFkzUWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTloYmkxdlltcGxZM1FuS1Z4dUlDQXNJSFJ2U1U5aWFtVmpkQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZEc4dGFXOWlhbVZqZENjcFhHNGdJQ3dnZEc5UWNtbHRhWFJwZG1VZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXdjbWx0YVhScGRtVW5LVnh1SUNBc0lHTnlaV0YwWlVSbGMyTWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZjSEp2Y0dWeWRIa3RaR1Z6WXljcFhHNGdJQ3dnWDJOeVpXRjBaU0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0WTNKbFlYUmxKeWxjYmlBZ0xDQm5UMUJPUlhoMElDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMW5iM0J1TFdWNGRDY3BYRzRnSUN3Z0pFZFBVRVFnSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXZZbXBsWTNRdFoyOXdaQ2NwWEc0Z0lDd2dKRVJRSUNBZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRaSEFuS1Z4dUlDQXNJQ1JyWlhseklDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMV3RsZVhNbktWeHVJQ0FzSUdkUFVFUWdJQ0FnSUNBZ0lDQWdJRDBnSkVkUFVFUXVabHh1SUNBc0lHUlFJQ0FnSUNBZ0lDQWdJQ0FnSUQwZ0pFUlFMbVpjYmlBZ0xDQm5UMUJPSUNBZ0lDQWdJQ0FnSUNBOUlHZFBVRTVGZUhRdVpseHVJQ0FzSUNSVGVXMWliMndnSUNBZ0lDQWdJRDBnWjJ4dlltRnNMbE41YldKdmJGeHVJQ0FzSUNSS1UwOU9JQ0FnSUNBZ0lDQWdJRDBnWjJ4dlltRnNMa3BUVDA1Y2JpQWdMQ0JmYzNSeWFXNW5hV1o1SUNBZ0lDQTlJQ1JLVTA5T0lDWW1JQ1JLVTA5T0xuTjBjbWx1WjJsbWVWeHVJQ0FzSUZCU1QxUlBWRmxRUlNBZ0lDQWdJRDBnSjNCeWIzUnZkSGx3WlNkY2JpQWdMQ0JJU1VSRVJVNGdJQ0FnSUNBZ0lDQTlJSGRyY3lnblgyaHBaR1JsYmljcFhHNGdJQ3dnVkU5ZlVGSkpUVWxVU1ZaRklDQWdQU0IzYTNNb0ozUnZVSEpwYldsMGFYWmxKeWxjYmlBZ0xDQnBjMFZ1ZFcwZ0lDQWdJQ0FnSUNBOUlIdDlMbkJ5YjNCbGNuUjVTWE5GYm5WdFpYSmhZbXhsWEc0Z0lDd2dVM2x0WW05c1VtVm5hWE4wY25rZ1BTQnphR0Z5WldRb0ozTjViV0p2YkMxeVpXZHBjM1J5ZVNjcFhHNGdJQ3dnUVd4c1UzbHRZbTlzY3lBZ0lDQWdQU0J6YUdGeVpXUW9KM041YldKdmJITW5LVnh1SUNBc0lFOVFVM2x0WW05c2N5QWdJQ0FnSUQwZ2MyaGhjbVZrS0NkdmNDMXplVzFpYjJ4ekp5bGNiaUFnTENCUFltcGxZM1JRY205MGJ5QWdJQ0E5SUU5aWFtVmpkRnRRVWs5VVQxUlpVRVZkWEc0Z0lDd2dWVk5GWDA1QlZFbFdSU0FnSUNBZ1BTQjBlWEJsYjJZZ0pGTjViV0p2YkNBOVBTQW5ablZ1WTNScGIyNG5YRzRnSUN3Z1VVOWlhbVZqZENBZ0lDQWdJQ0FnUFNCbmJHOWlZV3d1VVU5aWFtVmpkRHRjYmk4dklFUnZiaWQwSUhWelpTQnpaWFIwWlhKeklHbHVJRkYwSUZOamNtbHdkQ3dnYUhSMGNITTZMeTluYVhSb2RXSXVZMjl0TDNwc2IybHliMk5yTDJOdmNtVXRhbk12YVhOemRXVnpMekUzTTF4dWRtRnlJSE5sZEhSbGNpQTlJQ0ZSVDJKcVpXTjBJSHg4SUNGUlQySnFaV04wVzFCU1QxUlBWRmxRUlYwZ2ZId2dJVkZQWW1wbFkzUmJVRkpQVkU5VVdWQkZYUzVtYVc1a1EyaHBiR1E3WEc1Y2JpOHZJR1poYkd4aVlXTnJJR1p2Y2lCdmJHUWdRVzVrY205cFpDd2dhSFIwY0hNNkx5OWpiMlJsTG1kdmIyZHNaUzVqYjIwdmNDOTJPQzlwYzNOMVpYTXZaR1YwWVdsc1AybGtQVFk0TjF4dWRtRnlJSE5sZEZONWJXSnZiRVJsYzJNZ1BTQkVSVk5EVWtsUVZFOVNVeUFtSmlBa1ptRnBiSE1vWm5WdVkzUnBiMjRvS1h0Y2JpQWdjbVYwZFhKdUlGOWpjbVZoZEdVb1pGQW9lMzBzSUNkaEp5d2dlMXh1SUNBZ0lHZGxkRG9nWm5WdVkzUnBiMjRvS1hzZ2NtVjBkWEp1SUdSUUtIUm9hWE1zSUNkaEp5d2dlM1poYkhWbE9pQTNmU2t1WVRzZ2ZWeHVJQ0I5S1NrdVlTQWhQU0EzTzF4dWZTa2dQeUJtZFc1amRHbHZiaWhwZEN3Z2EyVjVMQ0JFS1h0Y2JpQWdkbUZ5SUhCeWIzUnZSR1Z6WXlBOUlHZFBVRVFvVDJKcVpXTjBVSEp2ZEc4c0lHdGxlU2s3WEc0Z0lHbG1LSEJ5YjNSdlJHVnpZeWxrWld4bGRHVWdUMkpxWldOMFVISnZkRzliYTJWNVhUdGNiaUFnWkZBb2FYUXNJR3RsZVN3Z1JDazdYRzRnSUdsbUtIQnliM1J2UkdWell5QW1KaUJwZENBaFBUMGdUMkpxWldOMFVISnZkRzhwWkZBb1QySnFaV04wVUhKdmRHOHNJR3RsZVN3Z2NISnZkRzlFWlhOaktUdGNibjBnT2lCa1VEdGNibHh1ZG1GeUlIZHlZWEFnUFNCbWRXNWpkR2x2YmloMFlXY3BlMXh1SUNCMllYSWdjM2x0SUQwZ1FXeHNVM2x0WW05c2MxdDBZV2RkSUQwZ1gyTnlaV0YwWlNna1UzbHRZbTlzVzFCU1QxUlBWRmxRUlYwcE8xeHVJQ0J6ZVcwdVgyc2dQU0IwWVdjN1hHNGdJSEpsZEhWeWJpQnplVzA3WEc1OU8xeHVYRzUyWVhJZ2FYTlRlVzFpYjJ3Z1BTQlZVMFZmVGtGVVNWWkZJQ1ltSUhSNWNHVnZaaUFrVTNsdFltOXNMbWwwWlhKaGRHOXlJRDA5SUNkemVXMWliMnduSUQ4Z1puVnVZM1JwYjI0b2FYUXBlMXh1SUNCeVpYUjFjbTRnZEhsd1pXOW1JR2wwSUQwOUlDZHplVzFpYjJ3bk8xeHVmU0E2SUdaMWJtTjBhVzl1S0dsMEtYdGNiaUFnY21WMGRYSnVJR2wwSUdsdWMzUmhibU5sYjJZZ0pGTjViV0p2YkR0Y2JuMDdYRzVjYm5aaGNpQWtaR1ZtYVc1bFVISnZjR1Z5ZEhrZ1BTQm1kVzVqZEdsdmJpQmtaV1pwYm1WUWNtOXdaWEowZVNocGRDd2dhMlY1TENCRUtYdGNiaUFnYVdZb2FYUWdQVDA5SUU5aWFtVmpkRkJ5YjNSdktTUmtaV1pwYm1WUWNtOXdaWEowZVNoUFVGTjViV0p2YkhNc0lHdGxlU3dnUkNrN1hHNGdJR0Z1VDJKcVpXTjBLR2wwS1R0Y2JpQWdhMlY1SUQwZ2RHOVFjbWx0YVhScGRtVW9hMlY1TENCMGNuVmxLVHRjYmlBZ1lXNVBZbXBsWTNRb1JDazdYRzRnSUdsbUtHaGhjeWhCYkd4VGVXMWliMnh6TENCclpYa3BLWHRjYmlBZ0lDQnBaaWdoUkM1bGJuVnRaWEpoWW14bEtYdGNiaUFnSUNBZ0lHbG1LQ0ZvWVhNb2FYUXNJRWhKUkVSRlRpa3BaRkFvYVhRc0lFaEpSRVJGVGl3Z1kzSmxZWFJsUkdWell5Z3hMQ0I3ZlNrcE8xeHVJQ0FnSUNBZ2FYUmJTRWxFUkVWT1hWdHJaWGxkSUQwZ2RISjFaVHRjYmlBZ0lDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ2FXWW9hR0Z6S0dsMExDQklTVVJFUlU0cElDWW1JR2wwVzBoSlJFUkZUbDFiYTJWNVhTbHBkRnRJU1VSRVJVNWRXMnRsZVYwZ1BTQm1ZV3h6WlR0Y2JpQWdJQ0FnSUVRZ1BTQmZZM0psWVhSbEtFUXNJSHRsYm5WdFpYSmhZbXhsT2lCamNtVmhkR1ZFWlhOaktEQXNJR1poYkhObEtYMHBPMXh1SUNBZ0lIMGdjbVYwZFhKdUlITmxkRk41YldKdmJFUmxjMk1vYVhRc0lHdGxlU3dnUkNrN1hHNGdJSDBnY21WMGRYSnVJR1JRS0dsMExDQnJaWGtzSUVRcE8xeHVmVHRjYm5aaGNpQWtaR1ZtYVc1bFVISnZjR1Z5ZEdsbGN5QTlJR1oxYm1OMGFXOXVJR1JsWm1sdVpWQnliM0JsY25ScFpYTW9hWFFzSUZBcGUxeHVJQ0JoYms5aWFtVmpkQ2hwZENrN1hHNGdJSFpoY2lCclpYbHpJRDBnWlc1MWJVdGxlWE1vVUNBOUlIUnZTVTlpYW1WamRDaFFLU2xjYmlBZ0lDQXNJR2tnSUNBZ1BTQXdYRzRnSUNBZ0xDQnNJRDBnYTJWNWN5NXNaVzVuZEdoY2JpQWdJQ0FzSUd0bGVUdGNiaUFnZDJocGJHVW9iQ0ErSUdrcEpHUmxabWx1WlZCeWIzQmxjblI1S0dsMExDQnJaWGtnUFNCclpYbHpXMmtySzEwc0lGQmJhMlY1WFNrN1hHNGdJSEpsZEhWeWJpQnBkRHRjYm4wN1hHNTJZWElnSkdOeVpXRjBaU0E5SUdaMWJtTjBhVzl1SUdOeVpXRjBaU2hwZEN3Z1VDbDdYRzRnSUhKbGRIVnliaUJRSUQwOVBTQjFibVJsWm1sdVpXUWdQeUJmWTNKbFlYUmxLR2wwS1NBNklDUmtaV1pwYm1WUWNtOXdaWEowYVdWektGOWpjbVZoZEdVb2FYUXBMQ0JRS1R0Y2JuMDdYRzUyWVhJZ0pIQnliM0JsY25SNVNYTkZiblZ0WlhKaFlteGxJRDBnWm5WdVkzUnBiMjRnY0hKdmNHVnlkSGxKYzBWdWRXMWxjbUZpYkdVb2EyVjVLWHRjYmlBZ2RtRnlJRVVnUFNCcGMwVnVkVzB1WTJGc2JDaDBhR2x6TENCclpYa2dQU0IwYjFCeWFXMXBkR2wyWlNoclpYa3NJSFJ5ZFdVcEtUdGNiaUFnYVdZb2RHaHBjeUE5UFQwZ1QySnFaV04wVUhKdmRHOGdKaVlnYUdGektFRnNiRk41YldKdmJITXNJR3RsZVNrZ0ppWWdJV2hoY3loUFVGTjViV0p2YkhNc0lHdGxlU2twY21WMGRYSnVJR1poYkhObE8xeHVJQ0J5WlhSMWNtNGdSU0I4ZkNBaGFHRnpLSFJvYVhNc0lHdGxlU2tnZkh3Z0lXaGhjeWhCYkd4VGVXMWliMnh6TENCclpYa3BJSHg4SUdoaGN5aDBhR2x6TENCSVNVUkVSVTRwSUNZbUlIUm9hWE5iU0VsRVJFVk9YVnRyWlhsZElEOGdSU0E2SUhSeWRXVTdYRzU5TzF4dWRtRnlJQ1JuWlhSUGQyNVFjbTl3WlhKMGVVUmxjMk55YVhCMGIzSWdQU0JtZFc1amRHbHZiaUJuWlhSUGQyNVFjbTl3WlhKMGVVUmxjMk55YVhCMGIzSW9hWFFzSUd0bGVTbDdYRzRnSUdsMElDQTlJSFJ2U1U5aWFtVmpkQ2hwZENrN1hHNGdJR3RsZVNBOUlIUnZVSEpwYldsMGFYWmxLR3RsZVN3Z2RISjFaU2s3WEc0Z0lHbG1LR2wwSUQwOVBTQlBZbXBsWTNSUWNtOTBieUFtSmlCb1lYTW9RV3hzVTNsdFltOXNjeXdnYTJWNUtTQW1KaUFoYUdGektFOVFVM2x0WW05c2N5d2dhMlY1S1NseVpYUjFjbTQ3WEc0Z0lIWmhjaUJFSUQwZ1owOVFSQ2hwZEN3Z2EyVjVLVHRjYmlBZ2FXWW9SQ0FtSmlCb1lYTW9RV3hzVTNsdFltOXNjeXdnYTJWNUtTQW1KaUFoS0doaGN5aHBkQ3dnU0VsRVJFVk9LU0FtSmlCcGRGdElTVVJFUlU1ZFcydGxlVjBwS1VRdVpXNTFiV1Z5WVdKc1pTQTlJSFJ5ZFdVN1hHNGdJSEpsZEhWeWJpQkVPMXh1ZlR0Y2JuWmhjaUFrWjJWMFQzZHVVSEp2Y0dWeWRIbE9ZVzFsY3lBOUlHWjFibU4wYVc5dUlHZGxkRTkzYmxCeWIzQmxjblI1VG1GdFpYTW9hWFFwZTF4dUlDQjJZWElnYm1GdFpYTWdJRDBnWjA5UVRpaDBiMGxQWW1wbFkzUW9hWFFwS1Z4dUlDQWdJQ3dnY21WemRXeDBJRDBnVzExY2JpQWdJQ0FzSUdrZ0lDQWdJQ0E5SURCY2JpQWdJQ0FzSUd0bGVUdGNiaUFnZDJocGJHVW9ibUZ0WlhNdWJHVnVaM1JvSUQ0Z2FTbDdYRzRnSUNBZ2FXWW9JV2hoY3loQmJHeFRlVzFpYjJ4ekxDQnJaWGtnUFNCdVlXMWxjMXRwS3l0ZEtTQW1KaUJyWlhrZ0lUMGdTRWxFUkVWT0lDWW1JR3RsZVNBaFBTQk5SVlJCS1hKbGMzVnNkQzV3ZFhOb0tHdGxlU2s3WEc0Z0lIMGdjbVYwZFhKdUlISmxjM1ZzZER0Y2JuMDdYRzUyWVhJZ0pHZGxkRTkzYmxCeWIzQmxjblI1VTNsdFltOXNjeUE5SUdaMWJtTjBhVzl1SUdkbGRFOTNibEJ5YjNCbGNuUjVVM2x0WW05c2N5aHBkQ2w3WEc0Z0lIWmhjaUJKVTE5UFVDQWdQU0JwZENBOVBUMGdUMkpxWldOMFVISnZkRzljYmlBZ0lDQXNJRzVoYldWeklDQTlJR2RQVUU0b1NWTmZUMUFnUHlCUFVGTjViV0p2YkhNZ09pQjBiMGxQWW1wbFkzUW9hWFFwS1Z4dUlDQWdJQ3dnY21WemRXeDBJRDBnVzExY2JpQWdJQ0FzSUdrZ0lDQWdJQ0E5SURCY2JpQWdJQ0FzSUd0bGVUdGNiaUFnZDJocGJHVW9ibUZ0WlhNdWJHVnVaM1JvSUQ0Z2FTbDdYRzRnSUNBZ2FXWW9hR0Z6S0VGc2JGTjViV0p2YkhNc0lHdGxlU0E5SUc1aGJXVnpXMmtySzEwcElDWW1JQ2hKVTE5UFVDQS9JR2hoY3loUFltcGxZM1JRY205MGJ5d2dhMlY1S1NBNklIUnlkV1VwS1hKbGMzVnNkQzV3ZFhOb0tFRnNiRk41YldKdmJITmJhMlY1WFNrN1hHNGdJSDBnY21WMGRYSnVJSEpsYzNWc2REdGNibjA3WEc1Y2JpOHZJREU1TGpRdU1TNHhJRk41YldKdmJDaGJaR1Z6WTNKcGNIUnBiMjVkS1Z4dWFXWW9JVlZUUlY5T1FWUkpWa1VwZTF4dUlDQWtVM2x0WW05c0lEMGdablZ1WTNScGIyNGdVM2x0WW05c0tDbDdYRzRnSUNBZ2FXWW9kR2hwY3lCcGJuTjBZVzVqWlc5bUlDUlRlVzFpYjJ3cGRHaHliM2NnVkhsd1pVVnljbTl5S0NkVGVXMWliMndnYVhNZ2JtOTBJR0VnWTI5dWMzUnlkV04wYjNJaEp5azdYRzRnSUNBZ2RtRnlJSFJoWnlBOUlIVnBaQ2hoY21kMWJXVnVkSE11YkdWdVozUm9JRDRnTUNBL0lHRnlaM1Z0Wlc1MGMxc3dYU0E2SUhWdVpHVm1hVzVsWkNrN1hHNGdJQ0FnZG1GeUlDUnpaWFFnUFNCbWRXNWpkR2x2YmloMllXeDFaU2w3WEc0Z0lDQWdJQ0JwWmloMGFHbHpJRDA5UFNCUFltcGxZM1JRY205MGJ5a2tjMlYwTG1OaGJHd29UMUJUZVcxaWIyeHpMQ0IyWVd4MVpTazdYRzRnSUNBZ0lDQnBaaWhvWVhNb2RHaHBjeXdnU0VsRVJFVk9LU0FtSmlCb1lYTW9kR2hwYzF0SVNVUkVSVTVkTENCMFlXY3BLWFJvYVhOYlNFbEVSRVZPWFZ0MFlXZGRJRDBnWm1Gc2MyVTdYRzRnSUNBZ0lDQnpaWFJUZVcxaWIyeEVaWE5qS0hSb2FYTXNJSFJoWnl3Z1kzSmxZWFJsUkdWell5Z3hMQ0IyWVd4MVpTa3BPMXh1SUNBZ0lIMDdYRzRnSUNBZ2FXWW9SRVZUUTFKSlVGUlBVbE1nSmlZZ2MyVjBkR1Z5S1hObGRGTjViV0p2YkVSbGMyTW9UMkpxWldOMFVISnZkRzhzSUhSaFp5d2dlMk52Ym1acFozVnlZV0pzWlRvZ2RISjFaU3dnYzJWME9pQWtjMlYwZlNrN1hHNGdJQ0FnY21WMGRYSnVJSGR5WVhBb2RHRm5LVHRjYmlBZ2ZUdGNiaUFnY21Wa1pXWnBibVVvSkZONWJXSnZiRnRRVWs5VVQxUlpVRVZkTENBbmRHOVRkSEpwYm1jbkxDQm1kVzVqZEdsdmJpQjBiMU4wY21sdVp5Z3BlMXh1SUNBZ0lISmxkSFZ5YmlCMGFHbHpMbDlyTzF4dUlDQjlLVHRjYmx4dUlDQWtSMDlRUkM1bUlEMGdKR2RsZEU5M2JsQnliM0JsY25SNVJHVnpZM0pwY0hSdmNqdGNiaUFnSkVSUUxtWWdJQ0E5SUNSa1pXWnBibVZRY205d1pYSjBlVHRjYmlBZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXZHZjRzRuS1M1bUlEMGdaMDlRVGtWNGRDNW1JRDBnSkdkbGRFOTNibEJ5YjNCbGNuUjVUbUZ0WlhNN1hHNGdJSEpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzF3YVdVbktTNW1JQ0E5SUNSd2NtOXdaWEowZVVselJXNTFiV1Z5WVdKc1pUdGNiaUFnY21WeGRXbHlaU2duTGk5ZmIySnFaV04wTFdkdmNITW5LUzVtSUQwZ0pHZGxkRTkzYmxCeWIzQmxjblI1VTNsdFltOXNjenRjYmx4dUlDQnBaaWhFUlZORFVrbFFWRTlTVXlBbUppQWhjbVZ4ZFdseVpTZ25MaTlmYkdsaWNtRnllU2NwS1h0Y2JpQWdJQ0J5WldSbFptbHVaU2hQWW1wbFkzUlFjbTkwYnl3Z0ozQnliM0JsY25SNVNYTkZiblZ0WlhKaFlteGxKeXdnSkhCeWIzQmxjblI1U1hORmJuVnRaWEpoWW14bExDQjBjblZsS1R0Y2JpQWdmVnh1WEc0Z0lIZHJjMFY0ZEM1bUlEMGdablZ1WTNScGIyNG9ibUZ0WlNsN1hHNGdJQ0FnY21WMGRYSnVJSGR5WVhBb2QydHpLRzVoYldVcEtUdGNiaUFnZlZ4dWZWeHVYRzRrWlhod2IzSjBLQ1JsZUhCdmNuUXVSeUFySUNSbGVIQnZjblF1VnlBcklDUmxlSEJ2Y25RdVJpQXFJQ0ZWVTBWZlRrRlVTVlpGTENCN1UzbHRZbTlzT2lBa1UzbHRZbTlzZlNrN1hHNWNibVp2Y2loMllYSWdjM2x0WW05c2N5QTlJQ2hjYmlBZ0x5OGdNVGt1TkM0eUxqSXNJREU1TGpRdU1pNHpMQ0F4T1M0MExqSXVOQ3dnTVRrdU5DNHlMallzSURFNUxqUXVNaTQ0TENBeE9TNDBMakl1T1N3Z01Ua3VOQzR5TGpFd0xDQXhPUzQwTGpJdU1URXNJREU1TGpRdU1pNHhNaXdnTVRrdU5DNHlMakV6TENBeE9TNDBMakl1TVRSY2JpQWdKMmhoYzBsdWMzUmhibU5sTEdselEyOXVZMkYwVTNCeVpXRmtZV0pzWlN4cGRHVnlZWFJ2Y2l4dFlYUmphQ3h5WlhCc1lXTmxMSE5sWVhKamFDeHpjR1ZqYVdWekxITndiR2wwTEhSdlVISnBiV2wwYVhabExIUnZVM1J5YVc1blZHRm5MSFZ1YzJOdmNHRmliR1Z6SjF4dUtTNXpjR3hwZENnbkxDY3BMQ0JwSUQwZ01Ec2djM2x0WW05c2N5NXNaVzVuZEdnZ1BpQnBPeUFwZDJ0ektITjViV0p2YkhOYmFTc3JYU2s3WEc1Y2JtWnZjaWgyWVhJZ2MzbHRZbTlzY3lBOUlDUnJaWGx6S0hkcmN5NXpkRzl5WlNrc0lHa2dQU0F3T3lCemVXMWliMnh6TG14bGJtZDBhQ0ErSUdrN0lDbDNhM05FWldacGJtVW9jM2x0WW05c2MxdHBLeXRkS1R0Y2JseHVKR1Y0Y0c5eWRDZ2taWGh3YjNKMExsTWdLeUFrWlhod2IzSjBMa1lnS2lBaFZWTkZYMDVCVkVsV1JTd2dKMU41YldKdmJDY3NJSHRjYmlBZ0x5OGdNVGt1TkM0eUxqRWdVM2x0WW05c0xtWnZjaWhyWlhrcFhHNGdJQ2RtYjNJbk9pQm1kVzVqZEdsdmJpaHJaWGtwZTF4dUlDQWdJSEpsZEhWeWJpQm9ZWE1vVTNsdFltOXNVbVZuYVhOMGNua3NJR3RsZVNBclBTQW5KeWxjYmlBZ0lDQWdJRDhnVTNsdFltOXNVbVZuYVhOMGNubGJhMlY1WFZ4dUlDQWdJQ0FnT2lCVGVXMWliMnhTWldkcGMzUnllVnRyWlhsZElEMGdKRk41YldKdmJDaHJaWGtwTzF4dUlDQjlMRnh1SUNBdkx5QXhPUzQwTGpJdU5TQlRlVzFpYjJ3dWEyVjVSbTl5S0hONWJTbGNiaUFnYTJWNVJtOXlPaUJtZFc1amRHbHZiaUJyWlhsR2IzSW9hMlY1S1h0Y2JpQWdJQ0JwWmlocGMxTjViV0p2YkNoclpYa3BLWEpsZEhWeWJpQnJaWGxQWmloVGVXMWliMnhTWldkcGMzUnllU3dnYTJWNUtUdGNiaUFnSUNCMGFISnZkeUJVZVhCbFJYSnliM0lvYTJWNUlDc2dKeUJwY3lCdWIzUWdZU0J6ZVcxaWIyd2hKeWs3WEc0Z0lIMHNYRzRnSUhWelpWTmxkSFJsY2pvZ1puVnVZM1JwYjI0b0tYc2djMlYwZEdWeUlEMGdkSEoxWlRzZ2ZTeGNiaUFnZFhObFUybHRjR3hsT2lCbWRXNWpkR2x2YmlncGV5QnpaWFIwWlhJZ1BTQm1ZV3h6WlRzZ2ZWeHVmU2s3WEc1Y2JpUmxlSEJ2Y25Rb0pHVjRjRzl5ZEM1VElDc2dKR1Y0Y0c5eWRDNUdJQ29nSVZWVFJWOU9RVlJKVmtVc0lDZFBZbXBsWTNRbkxDQjdYRzRnSUM4dklERTVMakV1TWk0eUlFOWlhbVZqZEM1amNtVmhkR1VvVHlCYkxDQlFjbTl3WlhKMGFXVnpYU2xjYmlBZ1kzSmxZWFJsT2lBa1kzSmxZWFJsTEZ4dUlDQXZMeUF4T1M0eExqSXVOQ0JQWW1wbFkzUXVaR1ZtYVc1bFVISnZjR1Z5ZEhrb1R5d2dVQ3dnUVhSMGNtbGlkWFJsY3lsY2JpQWdaR1ZtYVc1bFVISnZjR1Z5ZEhrNklDUmtaV1pwYm1WUWNtOXdaWEowZVN4Y2JpQWdMeThnTVRrdU1TNHlMak1nVDJKcVpXTjBMbVJsWm1sdVpWQnliM0JsY25ScFpYTW9UeXdnVUhKdmNHVnlkR2xsY3lsY2JpQWdaR1ZtYVc1bFVISnZjR1Z5ZEdsbGN6b2dKR1JsWm1sdVpWQnliM0JsY25ScFpYTXNYRzRnSUM4dklERTVMakV1TWk0MklFOWlhbVZqZEM1blpYUlBkMjVRY205d1pYSjBlVVJsYzJOeWFYQjBiM0lvVHl3Z1VDbGNiaUFnWjJWMFQzZHVVSEp2Y0dWeWRIbEVaWE5qY21sd2RHOXlPaUFrWjJWMFQzZHVVSEp2Y0dWeWRIbEVaWE5qY21sd2RHOXlMRnh1SUNBdkx5QXhPUzR4TGpJdU55QlBZbXBsWTNRdVoyVjBUM2R1VUhKdmNHVnlkSGxPWVcxbGN5aFBLVnh1SUNCblpYUlBkMjVRY205d1pYSjBlVTVoYldWek9pQWtaMlYwVDNkdVVISnZjR1Z5ZEhsT1lXMWxjeXhjYmlBZ0x5OGdNVGt1TVM0eUxqZ2dUMkpxWldOMExtZGxkRTkzYmxCeWIzQmxjblI1VTNsdFltOXNjeWhQS1Z4dUlDQm5aWFJQZDI1UWNtOXdaWEowZVZONWJXSnZiSE02SUNSblpYUlBkMjVRY205d1pYSjBlVk41YldKdmJITmNibjBwTzF4dVhHNHZMeUF5TkM0ekxqSWdTbE5QVGk1emRISnBibWRwWm5rb2RtRnNkV1VnV3l3Z2NtVndiR0ZqWlhJZ1d5d2djM0JoWTJWZFhTbGNiaVJLVTA5T0lDWW1JQ1JsZUhCdmNuUW9KR1Y0Y0c5eWRDNVRJQ3NnSkdWNGNHOXlkQzVHSUNvZ0tDRlZVMFZmVGtGVVNWWkZJSHg4SUNSbVlXbHNjeWhtZFc1amRHbHZiaWdwZTF4dUlDQjJZWElnVXlBOUlDUlRlVzFpYjJ3b0tUdGNiaUFnTHk4Z1RWTWdSV1JuWlNCamIyNTJaWEowY3lCemVXMWliMndnZG1Gc2RXVnpJSFJ2SUVwVFQwNGdZWE1nZTMxY2JpQWdMeThnVjJWaVMybDBJR052Ym5abGNuUnpJSE41YldKdmJDQjJZV3gxWlhNZ2RHOGdTbE5QVGlCaGN5QnVkV3hzWEc0Z0lDOHZJRlk0SUhSb2NtOTNjeUJ2YmlCaWIzaGxaQ0J6ZVcxaWIyeHpYRzRnSUhKbGRIVnliaUJmYzNSeWFXNW5hV1o1S0Z0VFhTa2dJVDBnSjF0dWRXeHNYU2NnZkh3Z1gzTjBjbWx1WjJsbWVTaDdZVG9nVTMwcElDRTlJQ2Q3ZlNjZ2ZId2dYM04wY21sdVoybG1lU2hQWW1wbFkzUW9VeWtwSUNFOUlDZDdmU2M3WEc1OUtTa3NJQ2RLVTA5T0p5d2dlMXh1SUNCemRISnBibWRwWm5rNklHWjFibU4wYVc5dUlITjBjbWx1WjJsbWVTaHBkQ2w3WEc0Z0lDQWdhV1lvYVhRZ1BUMDlJSFZ1WkdWbWFXNWxaQ0I4ZkNCcGMxTjViV0p2YkNocGRDa3BjbVYwZFhKdU95QXZMeUJKUlRnZ2NtVjBkWEp1Y3lCemRISnBibWNnYjI0Z2RXNWtaV1pwYm1Wa1hHNGdJQ0FnZG1GeUlHRnlaM01nUFNCYmFYUmRYRzRnSUNBZ0lDQXNJR2tnSUNBZ1BTQXhYRzRnSUNBZ0lDQXNJSEpsY0d4aFkyVnlMQ0FrY21Wd2JHRmpaWEk3WEc0Z0lDQWdkMmhwYkdVb1lYSm5kVzFsYm5SekxteGxibWQwYUNBK0lHa3BZWEpuY3k1d2RYTm9LR0Z5WjNWdFpXNTBjMXRwS3l0ZEtUdGNiaUFnSUNCeVpYQnNZV05sY2lBOUlHRnlaM05iTVYwN1hHNGdJQ0FnYVdZb2RIbHdaVzltSUhKbGNHeGhZMlZ5SUQwOUlDZG1kVzVqZEdsdmJpY3BKSEpsY0d4aFkyVnlJRDBnY21Wd2JHRmpaWEk3WEc0Z0lDQWdhV1lvSkhKbGNHeGhZMlZ5SUh4OElDRnBjMEZ5Y21GNUtISmxjR3hoWTJWeUtTbHlaWEJzWVdObGNpQTlJR1oxYm1OMGFXOXVLR3RsZVN3Z2RtRnNkV1VwZTF4dUlDQWdJQ0FnYVdZb0pISmxjR3hoWTJWeUtYWmhiSFZsSUQwZ0pISmxjR3hoWTJWeUxtTmhiR3dvZEdocGN5d2dhMlY1TENCMllXeDFaU2s3WEc0Z0lDQWdJQ0JwWmlnaGFYTlRlVzFpYjJ3b2RtRnNkV1VwS1hKbGRIVnliaUIyWVd4MVpUdGNiaUFnSUNCOU8xeHVJQ0FnSUdGeVozTmJNVjBnUFNCeVpYQnNZV05sY2p0Y2JpQWdJQ0J5WlhSMWNtNGdYM04wY21sdVoybG1lUzVoY0hCc2VTZ2tTbE5QVGl3Z1lYSm5jeWs3WEc0Z0lIMWNibjBwTzF4dVhHNHZMeUF4T1M0MExqTXVOQ0JUZVcxaWIyd3VjSEp2ZEc5MGVYQmxXMEJBZEc5UWNtbHRhWFJwZG1WZEtHaHBiblFwWEc0a1UzbHRZbTlzVzFCU1QxUlBWRmxRUlYxYlZFOWZVRkpKVFVsVVNWWkZYU0I4ZkNCeVpYRjFhWEpsS0NjdUwxOW9hV1JsSnlrb0pGTjViV0p2YkZ0UVVrOVVUMVJaVUVWZExDQlVUMTlRVWtsTlNWUkpWa1VzSUNSVGVXMWliMnhiVUZKUFZFOVVXVkJGWFM1MllXeDFaVTltS1R0Y2JpOHZJREU1TGpRdU15NDFJRk41YldKdmJDNXdjbTkwYjNSNWNHVmJRRUIwYjFOMGNtbHVaMVJoWjExY2JuTmxkRlJ2VTNSeWFXNW5WR0ZuS0NSVGVXMWliMndzSUNkVGVXMWliMnduS1R0Y2JpOHZJREl3TGpJdU1TNDVJRTFoZEdoYlFFQjBiMU4wY21sdVoxUmhaMTFjYm5ObGRGUnZVM1J5YVc1blZHRm5LRTFoZEdnc0lDZE5ZWFJvSnl3Z2RISjFaU2s3WEc0dkx5QXlOQzR6TGpNZ1NsTlBUbHRBUUhSdlUzUnlhVzVuVkdGblhWeHVjMlYwVkc5VGRISnBibWRVWVdjb1oyeHZZbUZzTGtwVFQwNHNJQ2RLVTA5T0p5d2dkSEoxWlNrN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMlZ6Tmk1emVXMWliMnd1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURFd05WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWlMQ0p5WlhGMWFYSmxLQ2N1TDE5M2EzTXRaR1ZtYVc1bEp5a29KMkZ6ZVc1alNYUmxjbUYwYjNJbktUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNM0xuTjViV0p2YkM1aGMzbHVZeTFwZEdWeVlYUnZjaTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTVRBMlhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015SXNJbkpsY1hWcGNtVW9KeTR2WDNkcmN5MWtaV1pwYm1VbktTZ25iMkp6WlhKMllXSnNaU2NwTzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWxjemN1YzNsdFltOXNMbTlpYzJWeWRtRmliR1V1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURFd04xeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWlMQ0l2S2lwY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1VGUWdTVzV2ZG1IRHA4T2pieUJsSUZOcGMzUmxiV0Z6SUZOQlhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklFbE9SVk5ETFVsRVhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklGRlZUMEpKVXlCT1JWUlhUMUpMVXlCVFRGeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQkdVa0ZWVGtoUFJrVlNMVWRGVTBWTVRGTkRTRUZHVkNCYVZWSWdSazlGVWtSRlVsVk9SeUJFUlZJZ1FVNUhSVmRCVGtSVVJVNGdSazlTVTBOSVZVNUhJRVV1Vmx4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCUFVrRk9SMFVnVTBGY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1JHVjFkSE5qYUdVZ1ZHVnNaV3R2YlNCQlIxeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQkJjR2w2WldWY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1ZFVkRTRTVKVTBOSVJTQlZUa2xXUlZKVFNWUkJWQ0JDUlZKTVNVNWNiaXBjYmlvZ1RHbGpaVzV6WldRZ2RXNWtaWElnZEdobElFRndZV05vWlNCTWFXTmxibk5sTENCV1pYSnphVzl1SURJdU1DQW9kR2hsSUZ3aVRHbGpaVzV6WlZ3aUtUdGNiaW9nZVc5MUlHMWhlU0J1YjNRZ2RYTmxJSFJvYVhNZ1ptbHNaU0JsZUdObGNIUWdhVzRnWTI5dGNHeHBZVzVqWlNCM2FYUm9JSFJvWlNCTWFXTmxibk5sTGx4dUtpQlpiM1VnYldGNUlHOWlkR0ZwYmlCaElHTnZjSGtnYjJZZ2RHaGxJRXhwWTJWdWMyVWdZWFJjYmlwY2Jpb2dJQ0JvZEhSd09pOHZkM2QzTG1Gd1lXTm9aUzV2Y21jdmJHbGpaVzV6WlhNdlRFbERSVTVUUlMweUxqQmNiaXBjYmlvZ1ZXNXNaWE56SUhKbGNYVnBjbVZrSUdKNUlHRndjR3hwWTJGaWJHVWdiR0YzSUc5eUlHRm5jbVZsWkNCMGJ5QnBiaUIzY21sMGFXNW5MQ0J6YjJaMGQyRnlaVnh1S2lCa2FYTjBjbWxpZFhSbFpDQjFibVJsY2lCMGFHVWdUR2xqWlc1elpTQnBjeUJrYVhOMGNtbGlkWFJsWkNCdmJpQmhiaUJjSWtGVElFbFRYQ0lnUWtGVFNWTXNYRzRxSUZkSlZFaFBWVlFnVjBGU1VrRk9WRWxGVXlCUFVpQkRUMDVFU1ZSSlQwNVRJRTlHSUVGT1dTQkxTVTVFTENCbGFYUm9aWElnWlhod2NtVnpjeUJ2Y2lCcGJYQnNhV1ZrTGx4dUtpQlRaV1VnZEdobElFeHBZMlZ1YzJVZ1ptOXlJSFJvWlNCemNHVmphV1pwWXlCc1lXNW5kV0ZuWlNCbmIzWmxjbTVwYm1jZ2NHVnliV2x6YzJsdmJuTWdZVzVrWEc0cUlHeHBiV2wwWVhScGIyNXpJSFZ1WkdWeUlIUm9aU0JNYVdObGJuTmxMbHh1S2lvdlhHNHZLaXBjYmlBcUlGTjFjSEJ2Y25RZ2JXOWtkV3hsSUhkcGRHZ2djMjl0WlNCbWRXNWpkR2x2Ym5NZ2QybHNiQ0JpWlNCMWMyVm1kV3hjYmlBcUlFQnRiMlIxYkdVZ2RYUnBiSE5jYmlBcUwxeHVYRzR2S2lwY2JpQXFJRUIwZVhCbFpHVm1JR1JwZG1sa1pWVlNURnh1SUNvZ1FIUjVjR1VnVDJKcVpXTjBYRzRnS2lCQWNISnZjR1Z5ZEhrZ2UzTjBjbWx1WjMwZ2RIbHdaU0JVYUdVZ2RIbHdaU0J2WmlCVlVreGNiaUFxSUVCd2NtOXdaWEowZVNCN2MzUnlhVzVuZlNCa2IyMWhhVzRnVkdobElHUnZiV0ZwYmlCdlppQlZVa3hjYmlBcUlFQndjbTl3WlhKMGVTQjdjM1J5YVc1bmZTQnBaR1Z1ZEdsMGVTQlVhR1VnYVdSbGJuUnBkSGtnYjJZZ1ZWSk1YRzRnS2k5Y2JseHVMeW9xWEc0Z0tpQkVhWFpwWkdVZ1lXNGdkWEpzSUdsdUlIUjVjR1VzSUdSdmJXRnBiaUJoYm1RZ2FXUmxiblJwZEhsY2JpQXFJRUJ3WVhKaGJTQWdlMVZTVEM1VlVreDlJSFZ5YkNBdElIVnliQ0JoWkdSeVpYTnpYRzRnS2lCQWNtVjBkWEp1SUh0a2FYWnBaR1ZWVWt4OUlIUm9aU0J5WlhOMWJIUWdiMllnWkdsMmFXUmxWVkpNWEc0Z0tpOWNibVY0Y0c5eWRDQm1kVzVqZEdsdmJpQmthWFpwWkdWVlVrd29kWEpzS1NCN1hHNWNiaUFnYVdZZ0tDRjFjbXdwSUhSb2NtOTNJRVZ5Y205eUtDZFZVa3dnYVhNZ2JtVmxaR1ZrSUhSdklITndiR2wwSnlrN1hHNWNibHgwWm5WdVkzUnBiMjRnY21WamRYSnpaU2gyWVd4MVpTa2dlMXh1WEhSY2RHTnZibk4wSUhKbFoyVjRJRDBnTHloYllTMTZRUzFhTFYwcUtTZzZYRnd2WEZ3dktEODZYRnd1S1Q5OE9pa29XeTFoTFhwQkxWb3dMVGxBT2lVdVgxeGNLMzRqUFYxN01pd3lOVFo5S1NoYkxXRXRla0V0V2pBdE9VQTZKUzVmWEZ3cmZpTTlYRnd2WFNvcEwyZHBPMXh1SUNBZ0lHTnZibk4wSUhOMVluTjBJRDBnSnlReExDUXpMQ1EwSnp0Y2JseDBJQ0JzWlhRZ2NHRnlkSE1nUFNCMllXeDFaUzV5WlhCc1lXTmxLSEpsWjJWNExDQnpkV0p6ZENrdWMzQnNhWFFvSnl3bktUdGNibHgwWEhSeVpYUjFjbTRnY0dGeWRITTdYRzVjZEgxY2JseHVYSFJzWlhRZ2NHRnlkSE1nUFNCeVpXTjFjbk5sS0hWeWJDazdYRzVjYmlBZ0x5OGdTV1lnZEdobElIVnliQ0JvWVhNZ2JtOGdjMk5vWlcxbFhHNGdJR2xtSUNod1lYSjBjMXN3WFNBOVBUMGdkWEpzSUNZbUlDRndZWEowYzFzd1hTNXBibU5zZFdSbGN5Z25RQ2NwS1NCN1hHNWNiaUFnSUNCc1pYUWdjbVZ6ZFd4MElEMGdlMXh1SUNBZ0lDQWdkSGx3WlRvZ1hDSmNJaXhjYmlBZ0lDQWdJR1J2YldGcGJqb2dkWEpzTEZ4dUlDQWdJQ0FnYVdSbGJuUnBkSGs2SUZ3aVhDSmNiaUFnSUNCOU8xeHVYRzRnSUNBZ1kyOXVjMjlzWlM1bGNuSnZjaWduVzBScGRtbGtaVlZTVEYwZ1JHbDJhV1JsVlZKTUlHUnZibHhjSjNRZ2MzVndjRzl5ZENCMWNtd2dkMmwwYUc5MWRDQnpZMmhsYldVdUlGQnNaV0Z6WlNCeVpYWnBaWGNnZVc5MWNpQjFjbXdnWVdSa2NtVnpjeWNzSUhWeWJDazdYRzVjYmlBZ0lDQnlaWFIxY200Z2NtVnpkV3gwTzF4dUlDQjlYRzVjYmx4MEx5OGdZMmhsWTJzZ2FXWWdkR2hsSUhWeWJDQm9ZWE1nZEdobElITmphR1Z0WlNCaGJtUWdhVzVqYkhWa1pYTWdZVzRnUUZ4dVhIUnBaaUFvY0dGeWRITmJNRjBnUFQwOUlIVnliQ0FtSmlCd1lYSjBjMXN3WFM1cGJtTnNkV1JsY3lnblFDY3BLU0I3WEc1Y2RGeDBiR1YwSUhOamFHVnRaU0E5SUhCaGNuUnpXekJkSUQwOVBTQjFjbXdnUHlBbmMyMTBjQ2NnT2lCd1lYSjBjMXN3WFR0Y2JseDBYSFJ3WVhKMGN5QTlJSEpsWTNWeWMyVW9jMk5vWlcxbElDc2dKem92THljZ0t5QndZWEowYzFzd1hTazdYRzVjZEgxY2JseHVYSFF2THlCcFppQjBhR1VnWkc5dFlXbHVJR2x1WTJ4MVpHVnpJR0Z1SUVBc0lHUnBkbWxrWlNCcGRDQjBieUJrYjIxaGFXNGdZVzVrSUdsa1pXNTBhWFI1SUhKbGMzQmxZM1JwZG1Wc2VWeHVYSFJwWmlBb2NHRnlkSE5iTVYwdWFXNWpiSFZrWlhNb0owQW5LU2tnZTF4dVhIUmNkSEJoY25Seld6SmRJRDBnY0dGeWRITmJNRjBnS3lBbk9pOHZKeUFySUhCaGNuUnpXekZkTzF4dVhIUmNkSEJoY25Seld6RmRJRDBnY0dGeWRITmJNVjB1YzNWaWMzUnlLSEJoY25Seld6RmRMbWx1WkdWNFQyWW9KMEFuS1NBcklERXBYRzRnSUNBZ2ZTQmNkQzhxWld4elpTQnBaaUFvY0dGeWRITmJNbDB1YVc1amJIVmtaWE1vSnk4bktTa2dlMXh1SUNBZ0lIQmhjblJ6V3pKZElEMGdjR0Z5ZEhOYk1sMHVjM1ZpYzNSeUtIQmhjblJ6V3pKZExteGhjM1JKYm1SbGVFOW1LQ2N2Snlrck1TazdYRzRnSUgwcUwxeHVYRzRnSUd4bGRDQnlaWE4xYkhRZ1BTQjdYRzRnSUNBZ2RIbHdaVG9nY0dGeWRITmJNRjBzWEc0Z0lDQWdaRzl0WVdsdU9pQndZWEowYzFzeFhTeGNiaUFnSUNCcFpHVnVkR2wwZVRvZ2NHRnlkSE5iTWwxY2JpQWdmVHRjYmx4dUlDQnlaWFIxY200Z2NtVnpkV3gwTzF4dWZWeHVYRzVsZUhCdmNuUWdablZ1WTNScGIyNGdaR2wyYVdSbFJXMWhhV3dvWlcxaGFXd3BJSHRjYmlBZ2JHVjBJR2x1WkdWNFQyWkJkQ0E5SUdWdFlXbHNMbWx1WkdWNFQyWW9KMEFuS1R0Y2JseHVJQ0JzWlhRZ2NtVnpkV3gwSUQwZ2UxeHVJQ0FnSUhWelpYSnVZVzFsT2lCbGJXRnBiQzV6ZFdKemRISnBibWNvTUN3Z2FXNWtaWGhQWmtGMEtTeGNiaUFnSUNCa2IyMWhhVzQ2SUdWdFlXbHNMbk4xWW5OMGNtbHVaeWhwYm1SbGVFOW1RWFFnS3lBeExDQmxiV0ZwYkM1c1pXNW5kR2dwWEc0Z0lIMDdYRzVjYmlBZ2NtVjBkWEp1SUhKbGMzVnNkRHRjYm4xY2JseHVMeW9xWEc0Z0tpQkRhR1ZqYXlCcFppQmhiaUJQWW1wbFkzUWdhWE1nWlcxd2RIbGNiaUFxSUVCd1lYSmhiU0FnZTA5aWFtVmpkSDBnYjJKcVpXTjBJRTlpYW1WamRDQjBieUJpWlNCamFHVmphMlZrWEc0Z0tpQkFjbVYwZFhKdUlIdENiMjlzWldGdWZTQWdJQ0FnSUNCemRHRjBkWE1nYjJZZ1QySnFaV04wTENCbGJYQjBlU0J2Y2lCdWIzUWdLSFJ5ZFdWOFptRnNjMlVwTzF4dUlDb3ZYRzVsZUhCdmNuUWdablZ1WTNScGIyNGdaVzF3ZEhsUFltcGxZM1FvYjJKcVpXTjBLU0I3WEc0Z0lISmxkSFZ5YmlCUFltcGxZM1F1YTJWNWN5aHZZbXBsWTNRcExteGxibWQwYUNBK0lEQWdQeUJtWVd4elpTQTZJSFJ5ZFdVN1hHNTlYRzVjYmk4cUtseHVJQ29nVFdGclpTQmhJRU5QVUZrZ2IyWWdkR2hsSUc5eWFXZHBibUZzSUdSaGRHRmNiaUFxSUVCd1lYSmhiU0FnZTA5aWFtVmpkSDBnSUc5aWFpQXRJRzlpYW1WamRDQjBieUJpWlNCamJHOXVaV1JjYmlBcUlFQnlaWFIxY200Z2UwOWlhbVZqZEgxY2JpQXFMMXh1Wlhod2IzSjBJR1oxYm1OMGFXOXVJR1JsWlhCRGJHOXVaU2h2WW1vcElIdGNiaUFnTHk5VVQwUlBPaUJ6YVcxd2JHVWdZblYwSUdsdVpXWm1hV05wWlc1MElFcFRUMDRnWkdWbGNDQmpiRzl1WlM0dUxseHVJQ0JwWmlBb2IySnFLU0J5WlhSMWNtNGdTbE5QVGk1d1lYSnpaU2hLVTA5T0xuTjBjbWx1WjJsbWVTaHZZbW9wS1R0Y2JuMWNibHh1THlvcVhHNGdLaUJQWW5SaGFXNXpJSFJvWlNCMWMyVnlJRlZTVENCMGFHRjBJR052Y25KbGMzQnZibVJ6SUhSdklHRWdaMmwyWlc0Z1pXMWhhV3hjYmlBcUlFQndZWEpoYlNBZ2UzTjBjbWx1WjMwZ2RYTmxja1Z0WVdsc0lGUm9aU0IxYzJWeUlHVnRZV2xzWEc0Z0tpQkFjbVYwZFhKdUlIdFZVa3d1VlZKTWZTQjFjMlZ5VlZKTUlGUm9aU0IxYzJWeUlGVlNURnh1SUNvdlhHNWxlSEJ2Y25RZ1puVnVZM1JwYjI0Z1oyVjBWWE5sY2xWU1RFWnliMjFGYldGcGJDaDFjMlZ5UlcxaGFXd3BJSHRjYmlBZ2JHVjBJR2x1WkdWNFQyWkJkQ0E5SUhWelpYSkZiV0ZwYkM1cGJtUmxlRTltS0NkQUp5azdYRzRnSUhKbGRIVnliaUFuZFhObGNqb3ZMeWNnS3lCMWMyVnlSVzFoYVd3dWMzVmljM1J5YVc1bktHbHVaR1Y0VDJaQmRDQXJJREVzSUhWelpYSkZiV0ZwYkM1c1pXNW5kR2dwSUNzZ0p5OG5JQ3NnZFhObGNrVnRZV2xzTG5OMVluTjBjbWx1Wnlnd0xDQnBibVJsZUU5bVFYUXBPMXh1ZlZ4dVhHNHZLaXBjYmlBcUlFOWlkR0ZwYm5NZ2RHaGxJSFZ6WlhJZ1pXMWhhV3dnZEdoaGRDQmpiM0p5WlhOd2IyNWtjeUIwYnlCaElHZHBkbVZ1SUZWU1RGeHVJQ29nUUhCaGNtRnRJQ0I3VlZKTUxsVlNUSDBnZFhObGNsVlNUQ0JVYUdVZ2RYTmxjaUJWVWt4Y2JpQXFJRUJ5WlhSMWNtNGdlM04wY21sdVozMGdkWE5sY2tWdFlXbHNJRlJvWlNCMWMyVnlJR1Z0WVdsc1hHNGdLaTljYm1WNGNHOXlkQ0JtZFc1amRHbHZiaUJuWlhSVmMyVnlSVzFoYVd4R2NtOXRWVkpNS0hWelpYSlZVa3dwSUh0Y2JpQWdiR1YwSUhWeWJDQTlJR1JwZG1sa1pWVlNUQ2gxYzJWeVZWSk1LVHRjYmlBZ2NtVjBkWEp1SUhWeWJDNXBaR1Z1ZEdsMGVTNXlaWEJzWVdObEtDY3ZKeXdnSnljcElDc2dKMEFuSUNzZ2RYSnNMbVJ2YldGcGJqc2dMeThnYVdSbGJuUnBkSGtnWm1sbGJHUWdhR0Z6SUNjdlpYaGhiWEJzWlVsRUp5QnBibk4wWldGa0lHOW1JQ2RsZUdGdGNHeGxTVVFuWEc1OVhHNWNibHh1THlvcVhHNGdLaUJEYUdWamF5QnBaaUIwYUdVZ2RYTmxjaUJwWkdWdWRHbG1hV1Z5SUdseklHRnNjbVZoWkhrZ2FXNGdkR2hsSUZWU1RDQm1iM0p0WVhRc0lHbG1JRzV2ZEN3Z1kyOXVkbVZ5ZENCMGJ5QlZVa3dnWm05eWJXRjBYRzRnS2lCQWNHRnlZVzBnSUh0emRISnBibWQ5SUNBZ2FXUmxiblJwWm1sbGNpQWdkWE5sY2lCcFpHVnVkR2xtYVdWeVhHNGdLaUJBY21WMGRYSnVJSHR6ZEhKcGJtZDlJQ0FnZFhObGNsVlNUQ0FnSUNCMGFHVWdkWE5sY2lCVlVreGNiaUFxTDF4dVpYaHdiM0owSUdaMWJtTjBhVzl1SUdOdmJuWmxjblJVYjFWelpYSlZVa3dvYVdSbGJuUnBabWxsY2lrZ2UxeHVYRzRnSUM4dklHTm9aV05ySUdsbUlIUm9aU0JwWkdWdWRHbG1hV1Z5SUdseklHRnNjbVZoWkhrZ2FXNGdkR2hsSUhWeWJDQm1iM0p0WVhSY2JpQWdhV1lnS0dsa1pXNTBhV1pwWlhJdWMzVmljM1J5YVc1bktEQXNJRGNwSUQwOVBTQW5kWE5sY2pvdkx5Y3BJSHRjYmlBZ0lDQnNaWFFnWkdsMmFXUmxaRlZTVENBOUlHUnBkbWxrWlZWU1RDaHBaR1Z1ZEdsbWFXVnlLVHRjYmx4dUlDQWdJQzh2WTJobFkyc2dhV1lnZEdobElIVnliQ0JwY3lCM1pXeHNJR1p2Y20xaGRHVmtYRzRnSUNBZ2FXWWdLR1JwZG1sa1pXUlZVa3d1Wkc5dFlXbHVJQ1ltSUdScGRtbGtaV1JWVWt3dWFXUmxiblJwZEhrcElIdGNiaUFnSUNBZ0lISmxkSFZ5YmlCcFpHVnVkR2xtYVdWeU8xeHVJQ0FnSUgwZ1pXeHpaU0I3WEc0Z0lDQWdJQ0IwYUhKdmR5QW5kWE5sY2xWU1RDQjNhWFJvSUhkeWIyNW5JR1p2Y20xaGRDYzdYRzRnSUNBZ2ZWeHVYRzRnSUM4dmFXWWdibTkwTENCamIyNTJaWEowSUhSb1pTQjFjMlZ5SUdWdFlXbHNJSFJ2SUZWU1RDQm1iM0p0WVhSY2JpQWdmU0JsYkhObElIdGNiaUFnSUNCeVpYUjFjbTRnWjJWMFZYTmxjbFZTVEVaeWIyMUZiV0ZwYkNocFpHVnVkR2xtYVdWeUtUdGNiaUFnZlZ4dWZWeHVYRzVjYmx4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZJZ0x5OWNiaTh2SUM0dmMzSmpMM1YwYVd4ekwzVjBhV3h6TG1weklpd2lMeThnSUNBZ0lIQnliM2g1TFc5aWMyVnlkbVVnZGpBdU1DNHhPRnh5WEc0dkx5QWdJQ0FnUTI5d2VYSnBaMmgwSUNoaktTQXlNREUxTENBeU1ERTJJRk5wYlc5dUlGa3VJRUpzWVdOcmQyVnNiQ3dnUVc1NVYyaHBZMmhYWVhsY2NseHVMeThnSUNBZ0lFMUpWQ0JNYVdObGJuTmxJQzBnYUhSMGNEb3ZMMjl3Wlc1emIzVnlZMlV1YjNKbkwyeHBZMlZ1YzJWekwyMXBkQzFzYVdObGJuTmxMbkJvY0Z4eVhHNG9ablZ1WTNScGIyNG9LU0I3WEhKY2JseDBYQ0oxYzJVZ2MzUnlhV04wWENJN1hISmNibHgwTHk4Z1EzSmxZWFJsY3lCaGJtUWdjbVYwZFhKdWN5QmhJRkJ5YjNoNUlIZHlZWEJ3YVc1bklHRWdkR0Z5WjJWMElITnZJSFJvWVhRZ1lXeHNJR05vWVc1blpYTWdZMkZ1SUdKbElIUnlZWEJ3WldRZ1lXNWtJR1p2Y25kaGNtUmxaQ0IwYjF4eVhHNWNkQzh2SUdFZ1kyRnNiR0poWTJzdUlGUm9aU0JqWVd4c1ltRmpheUIwWVd0bGN5QmhiaUJoY25KaGVTQnZaaUJqYUdGdVoyVnpJR3AxYzNRZ2JHbHJaU0IwYUdVZ2RISmhaR2wwYVc5dVlXd2diM0pwWjJsdVlXd2dRMmh5YjIxbElFOWlhbVZqZEM1dlluTmxjblpsWEhKY2JseDBMeThnZTI5aWFtVmpkRG84YjJKcVpXTjBJR05vWVc1blpXUStMRzVoYldVNlBHWnBaV3hrSUdOb1lXNW5aV1ErTEhSNWNHVTZZV1JrZkhWd1pHRjBaWHhrWld4bGRHVjhjbVZqYjI1bWFXZDFjbVY4Y0hKbGRtVnVkRVY0ZEdWdWMybHZibk44YzJWMFVISnZkRzkwZVhCbExHOXNaRlpoYkhWbE9qeHZiR1FnZG1Gc2RXVWdhV1lnZFhCa1lYUmxJSHdnWkdWc1pYUmxQbjFjY2x4dVhIUXZMeUJVYUdVZ1lXTmpaWEIwYkdsemRDQmpZVzRnWW1VZ1lXUmtmSFZ3WkdGMFpYeGtaV3hsZEdWOGNtVmpiMjVtYVdkMWNtVjhjSEpsZG1WdWRFVjRkR1Z1YzJsdmJuTjhjMlYwVUhKdmRHOTBlWEJsTGx4eVhHNWNkQzh2SUhZZ01DNHdMakV3SUhSdklITjFjSEJ2Y25RZ2NHRjFjMmx1WnlCaGJtUWdjbVZ6ZEdGeWRHbHVaeUJ2WW5ObGNuWmhkR2x2YmlCMGQyOGdZV1JrYVhScGIyNWhiQ0JqYjI1emRISjFZM1J2Y2lCaGNtZDFiV1Z1ZEhNZ1lYSmxJR0YyWVdsc1lXSnNaU0IwYnlCUFltcGxZM1F1YjJKelpYSjJaVHBjY2x4dVhIUXZMeUJ3WVhWellXSnNaU0F0SUdOeVpXRjBaU0IwYUdVZ1QySnpaWEoyWlhJZ2MyOGdhWFFnWTJGdUlHSmxJSEJoZFhObFpGeHlYRzVjZEM4dklIQmhkWE5sSUMwZ1kzSmxZWFJsSUc5aWMyVnlkbVZ5SUdsdUlIQmhkWE5sWkNCemRHRjBaVnh5WEc1Y2RDOHZJR2xtSUhCaGRYTmhZbXhsSUdseklIUnlkV1VnZEdobGJpQmhiaUJoWkdScGRHbHZibUZzSUcxbGRHaHZaQ0JrWld4cGRtVnlLR2xuYm05eVpWQnlaWFpwYjNWektTQnBjeUJoZG1GcGJHRmliR1VnZEc4Z2MzUmhjblFnWkdWc2FYWmxjbmxjY2x4dVhIUXZMeUIwYnlCd1lYVnpaU0JrWld4cGRtVnllU0J6WlhRZ1lTQndjbTl3WlhKMGVTQmpZV3hzWldRZ2NHRjFjMlVnYjI0Z2RHaGxJR1oxYm1OMGFXOXVJR1JsYkdsMlpYSWdkRzhnZEhKMVpWeHlYRzVjZEM4dklIQmhkWE5oWW14bElHbHpJRzl3ZEdsdmJtRnNJSFJ2SUhKbFpIVmpaU0IwYUdVZ1kyaGhibU5sSUc5bUlITm9ZV1J2ZDJsdVp5QmhJSEJ5YjNCbGNuUjVJRzl5SUcxbGRHaHZaQ0J2YmlCaGJua2daWGhwYzNScGJtY2dZMjlrWlNCallXeHNaV1FnWkdWc2FYWmxjbHh5WEc1Y2RHbG1LQ0ZQWW1wbFkzUXViMkp6WlhKMlpTQW1KaUIwZVhCbGIyWW9VSEp2ZUhrcFBUMDlYQ0ptZFc1amRHbHZibHdpS1NCN1hISmNibHgwWEhSbWRXNWpkR2x2YmlCUFluTmxjblpsY2loMFlYSm5aWFFzWTJGc2JHSmhZMnNzWVdOalpYQjBiR2x6ZEN4d1lYVnpZV0pzWlN4d1lYVnpaU3hrWld4aGVTa2dlMXh5WEc1Y2RDQWdJQ0JjZEhaaGNpQnRaU0E5SUhSb2FYTXNJSEJ5YjNoNU8xeHlYRzVjZENBZ0lDQmNkR1oxYm1OMGFXOXVJR1JsYkdsMlpYSW9hV2R1YjNKbFVISmxkbWx2ZFhNc1pHVnNZWGtwSUh0Y2NseHVYSFFnSUNBZ1hIUmNkR1JsYkdsMlpYSXVaR1ZzWVhrZ1BTQmtaV3hoZVR0Y2NseHVYSFFnSUNBZ1hIUmNkR2xtS0NGa1pXeHBkbVZ5TG5CaGRYTmxLU0I3WEhKY2JseDBJQ0FnSUNBZ0lDQmNkRngwYVdZb2JXVXVZMmhoYm1kbGMyVjBMbXhsYm1kMGFENHdLU0I3WEhKY2JseDBJQ0FnSUNBZ0lDQmNkRngwWEhScFppZ2hhV2R1YjNKbFVISmxkbWx2ZFhNcElIdGNjbHh1WEhSY2RDQWdJQ0JjZENBZ0lDQmNkRngwZG1GeUlHTm9ZVzVuWlhNZ1BTQnRaUzVqYUdGdVoyVnpaWFF1Wm1sc2RHVnlLR1oxYm1OMGFXOXVLR05vWVc1blpTa2dleUJ5WlhSMWNtNGdJV0ZqWTJWd2RHeHBjM1FnZkh3Z1lXTmpaWEIwYkdsemRDNXBibVJsZUU5bUtHTm9ZVzVuWlM1MGVYQmxLVDQ5TURzZ2ZTazdYSEpjYmx4MFhIUWdJQ0FnSUNBZ0lGeDBYSFJjZEdsbUtHTm9ZVzVuWlhNdWJHVnVaM1JvUGpBcElIdGNjbHh1WEhSY2RDQWdJQ0FnSUNBZ1hIUmNkRngwWEhSallXeHNZbUZqYXloamFHRnVaMlZ6S1R0Y2NseHVYSFJjZENBZ0lDQWdJQ0FnWEhSY2RGeDBmVnh5WEc1Y2RDQWdJQ0FnSUNBZ1hIUmNkRngwZlZ4eVhHNWNkQ0FnSUNBZ0lDQWdYSFJjZEZ4MGJXVXVZMmhoYm1kbGMyVjBJRDBnVzEwN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEZ4MGZWeHlYRzVjZENBZ0lDQmNkRngwZlZ4eVhHNWNkQ0FnSUNCY2RIMWNjbHh1WEhRZ0lDQWdYSFJrWld4cGRtVnlMbkJoZFhObElEMGdjR0YxYzJVN1hISmNibHgwSUNBZ0lGeDBaR1ZzYVhabGNpNWtaV3hoZVNBOUlHUmxiR0Y1TzF4eVhHNWNkRngwSUNBZ0lHMWxMbWRsZENBOUlHWjFibU4wYVc5dUtIUmhjbWRsZEN3Z2NISnZjR1Z5ZEhrcElIdGNjbHh1WEhSY2RDQWdJQ0JjZEdsbUtIQnliM0JsY25SNVBUMDlYQ0pmWDI5aWMyVnlkbVZ5WDE5Y0lpa2dlMXh5WEc1Y2RGeDBJQ0FnSUZ4MFhIUnlaWFIxY200Z2JXVTdYSEpjYmx4MFhIUWdJQ0FnWEhSOVhISmNibHgwWEhRZ0lDQWdYSFJwWmlod2NtOXdaWEowZVQwOVBWd2lkVzV2WW5ObGNuWmxYQ0lwSUh0Y2NseHVYSFJjZENBZ0lDQmNkRngwY21WMGRYSnVJR1oxYm1OMGFXOXVLQ2tnZTF4eVhHNWNkRngwSUNBZ0lGeDBYSFJjZEU5aWFtVmpkQzUxYm05aWMyVnlkbVVvZEdGeVoyVjBLVHRjY2x4dVhIUmNkQ0FnSUNCY2RGeDBYSFJ5WlhSMWNtNGdkR0Z5WjJWME8xeHlYRzVjZEZ4MElDQWdJRngwWEhSOU8xeHlYRzVjZEZ4MElDQWdJRngwZlZ4eVhHNWNkRngwSUNBZ0lGeDBhV1lvY0hKdmNHVnlkSGs5UFQxY0ltUmxiR2wyWlhKY0lpa2dlMXh5WEc1Y2RGeDBJQ0FnSUZ4MFhIUnlaWFIxY200Z1pHVnNhWFpsY2p0Y2NseHVYSFJjZENBZ0lDQmNkSDFjY2x4dVhIUmNkQ0FnSUNCY2RISmxkSFZ5YmlCMFlYSm5aWFJiY0hKdmNHVnlkSGxkTzF4eVhHNWNkRngwSUNBZ0lIMWNjbHh1WEhRZ0lDQWdYSFJ0WlM1MFlYSm5aWFFnUFNCMFlYSm5aWFE3WEhKY2JseDBJQ0FnSUZ4MGJXVXVZMmhoYm1kbGMyVjBJRDBnVzEwN1hISmNibHgwSUNBZ0lGeDBhV1lvSVcxbExuUmhjbWRsZEM1ZlgyOWljMlZ5ZG1WeVEyRnNiR0poWTJ0elgxOHBJSHRjY2x4dVhIUWdJQ0FnWEhSY2RDOHZJRjlmYjJKelpYSjJaWEpEWVd4c1ltRmphM05mWHlCcGN5QjFjMlZrSUdGeklHRnVJR2x1WkdWNElIUnZJR2RsZENCaGRDQjBhR1VnY0hKdmVIa2dkMmhwWTJnZ2FYTWdkR2hsSUc5aWMyVnlkbVZ5TENCemJ5QjNaU0JqWVc0Z2RXNXZZbk5sY25abFhISmNibHgwSUNBZ0lGeDBYSFJQWW1wbFkzUXVaR1ZtYVc1bFVISnZjR1Z5ZEhrb2RHRnlaMlYwTEZ3aVgxOXZZbk5sY25abGNrTmhiR3hpWVdOcmMxOWZYQ0lzZTJWdWRXMWxjbUZpYkdVNlptRnNjMlVzWTI5dVptbG5kWEpoWW14bE9uUnlkV1VzZDNKcGRHRmliR1U2Wm1Gc2MyVXNkbUZzZFdVNlcxMTlLVHRjY2x4dVhIUWdJQ0FnWEhSY2RFOWlhbVZqZEM1a1pXWnBibVZRY205d1pYSjBlU2gwWVhKblpYUXNYQ0pmWDI5aWMyVnlkbVZ5YzE5ZlhDSXNlMlZ1ZFcxbGNtRmliR1U2Wm1Gc2MyVXNZMjl1Wm1sbmRYSmhZbXhsT25SeWRXVXNkM0pwZEdGaWJHVTZabUZzYzJVc2RtRnNkV1U2VzExOUtUdGNjbHh1WEhRZ0lDQWdYSFI5WEhKY2JseDBJQ0FnSUZ4MGJXVXVkR0Z5WjJWMExsOWZiMkp6WlhKMlpYSkRZV3hzWW1GamEzTmZYeTV3ZFhOb0tHTmhiR3hpWVdOcktUdGNjbHh1WEhRZ0lDQWdYSFJ0WlM1MFlYSm5aWFF1WDE5dlluTmxjblpsY25OZlh5NXdkWE5vS0hSb2FYTXBPMXh5WEc1Y2RDQWdJQ0JjZEhCeWIzaDVJRDBnYm1WM0lGQnliM2g1S0hSaGNtZGxkQ3h0WlNrN1hISmNibHgwSUNBZ0lGeDBaR1ZzYVhabGNpaG1ZV3h6WlN4a1pXeGhlU2s3WEhKY2JseDBJQ0FnSUZ4MGNtVjBkWEp1SUhCeWIzaDVPMXh5WEc1Y2RDQWdJQ0I5WEhKY2JseDBYSFJQWW5ObGNuWmxjaTV3Y205MGIzUjVjR1V1WkdWc2FYWmxjaUE5SUdaMWJtTjBhVzl1S0NrZ2UxeHlYRzVjZEZ4MFhIUnlaWFIxY200Z2RHaHBjeTVuWlhRb2JuVnNiQ3hjSW1SbGJHbDJaWEpjSWlrN1hISmNibHgwWEhSOVhISmNibHgwSUNBZ0lFOWljMlZ5ZG1WeUxuQnliM1J2ZEhsd1pTNXpaWFFnUFNCbWRXNWpkR2x2YmloMFlYSm5aWFFzSUhCeWIzQmxjblI1TENCMllXeDFaU2tnZXlBdkx5QXNJSEpsWTJWcGRtVnlYSEpjYmx4MElDQWdJRngwZG1GeUlHOXNaSFpoYkhWbElEMGdkR0Z5WjJWMFczQnliM0JsY25SNVhUdGNjbHh1WEhRZ0lDQWdYSFIyWVhJZ2RIbHdaU0E5SUNodmJHUjJZV3gxWlQwOVBYVnVaR1ZtYVc1bFpDQS9JRndpWVdSa1hDSWdPaUJjSW5Wd1pHRjBaVndpS1R0Y2NseHVYSFFnSUNBZ1hIUjBZWEpuWlhSYmNISnZjR1Z5ZEhsZElEMGdkbUZzZFdVN1hISmNibHgwSUNBZ0lGeDBhV1lvZEdGeVoyVjBMbDlmYjJKelpYSjJaWEp6WDE4dWFXNWtaWGhQWmloMGFHbHpLVDQ5TUNBbUppQW9JWFJvYVhNdVlXTmpaWEIwYkdsemRDQjhmQ0IwYUdsekxtRmpZMlZ3ZEd4cGMzUXVhVzVrWlhoUFppaDBlWEJsS1Q0OU1Da3BJSHRjY2x4dVhIUWdJQ0FnSUNBZ0lGeDBkbUZ5SUdOb1lXNW5aU0E5SUh0dlltcGxZM1E2ZEdGeVoyVjBMRzVoYldVNmNISnZjR1Z5ZEhrc2RIbHdaVHAwZVhCbGZTeGNjbHh1WEhRZ0lDQWdJQ0FnSUZ4MFhIUnpkR0Z5ZENBOUlIUm9hWE11WTJoaGJtZGxjMlYwTG14bGJtZDBhQ0E5UFQwZ01DeGNjbHh1WEhRZ0lDQWdJQ0FnSUZ4MFhIUmtaV3hwZG1WeUlEMGdkR2hwY3k1a1pXeHBkbVZ5S0NrN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEdsbUtIUjVjR1U5UFQxY0luVndaR0YwWlZ3aUtTQjdYSEpjYmx4MElDQWdJQ0FnSUNCY2RGeDBZMmhoYm1kbExtOXNaRlpoYkhWbElEMGdiMnhrZG1Gc2RXVTdYSEpjYmx4MElDQWdJQ0FnSUNCY2RIMWNjbHh1WEhRZ0lDQWdJQ0FnSUZ4MGRHaHBjeTVqYUdGdVoyVnpaWFF1Y0hWemFDaGphR0Z1WjJVcE8xeHlYRzVjZENBZ0lDQWdJQ0FnWEhScFppaHpkR0Z5ZENrZ2UxeHlYRzVjZENBZ0lDQWdJQ0FnWEhSY2RHUmxiR2wyWlhJb1ptRnNjMlVzS0hSNWNHVnZaaWhrWld4cGRtVnlMbVJsYkdGNUtUMDlQVndpYm5WdFltVnlYQ0lnUHlCa1pXeHBkbVZ5TG1SbGJHRjVJRG9nTVRBcEtUdGNjbHh1WEhRZ0lDQWdJQ0FnSUZ4MGZWeHlYRzVjZENBZ0lDQmNkSDFjY2x4dVhIUWdJQ0FnWEhSeVpYUjFjbTRnZEhKMVpUdGNjbHh1WEhRZ0lDQWdmVHRjY2x4dVhIUWdJQ0FnVDJKelpYSjJaWEl1Y0hKdmRHOTBlWEJsTG1SbGJHVjBaVkJ5YjNCbGNuUjVJRDBnWm5WdVkzUnBiMjRvZEdGeVoyVjBMQ0J3Y205d1pYSjBlU2tnZTF4eVhHNWNkQ0FnSUNCY2RIWmhjaUJ2YkdSMllXeDFaU0E5SUhSaGNtZGxkRnR3Y205d1pYSjBlVjA3WEhKY2JseDBJQ0FnSUZ4MEx5OXBaaWgwZVhCbGIyWW9iMnhrZG1Gc2RXVXBJVDA5WENKMWJtUmxabWx1WldSY0lpa2dlMXh5WEc1Y2RGeDBJQ0FnSUZ4MFpHVnNaWFJsSUhSaGNtZGxkRnR3Y205d1pYSjBlVjA3WEhKY2JseDBYSFFnSUNBZ1hIUnBaaWgwWVhKblpYUXVYMTl2WW5ObGNuWmxjbk5mWHk1cGJtUmxlRTltS0hSb2FYTXBQajB3SUNZbUlDRjBhR2x6TG1GalkyVndkR3hwYzNRZ2ZId2dkR2hwY3k1aFkyTmxjSFJzYVhOMExtbHVaR1Y0VDJZb1hDSmtaV3hsZEdWY0lpaytQVEFwSUh0Y2NseHVYSFJjZENBZ0lDQWdJQ0FnWEhSMllYSWdZMmhoYm1kbElEMGdlMjlpYW1WamREcDBZWEpuWlhRc2JtRnRaVHB3Y205d1pYSjBlU3gwZVhCbE9sd2laR1ZzWlhSbFhDSXNiMnhrVm1Gc2RXVTZiMnhrZG1Gc2RXVjlMRnh5WEc1Y2RGeDBJQ0FnSUNBZ0lDQmNkRngwYzNSaGNuUWdQU0IwYUdsekxtTm9ZVzVuWlhObGRDNXNaVzVuZEdnZ1BUMDlJREFzWEhKY2JseDBYSFFnSUNBZ0lDQWdJRngwWEhSa1pXeHBkbVZ5SUQwZ2RHaHBjeTVrWld4cGRtVnlLQ2s3WEhKY2JseDBYSFFnSUNBZ0lDQWdJRngwZEdocGN5NWphR0Z1WjJWelpYUXVjSFZ6YUNoamFHRnVaMlVwTzF4eVhHNWNkRngwSUNBZ0lDQWdJQ0JjZEdsbUtITjBZWEowS1NCN1hISmNibHgwWEhRZ0lDQWdJQ0FnSUZ4MFhIUmtaV3hwZG1WeUtHWmhiSE5sTENoMGVYQmxiMllvWkdWc2FYWmxjaTVrWld4aGVTazlQVDFjSW01MWJXSmxjbHdpSUQ4Z1pHVnNhWFpsY2k1a1pXeGhlU0E2SURFd0tTazdYSEpjYmx4MFhIUWdJQ0FnSUNBZ0lGeDBmVnh5WEc1Y2RGeDBJQ0FnSUZ4MGZWeHlYRzVjZENBZ0lDQmNkQzh2ZlZ4eVhHNWNkQ0FnSUNCY2RISmxkSFZ5YmlCMGNuVmxPMXh5WEc1Y2RDQWdJQ0I5TzF4eVhHNWNkQ0FnSUNCUFluTmxjblpsY2k1d2NtOTBiM1I1Y0dVdVpHVm1hVzVsVUhKdmNHVnlkSGtnUFNCbWRXNWpkR2x2YmloMFlYSm5aWFFzSUhCeWIzQmxjblI1TENCa1pYTmpjbWx3ZEc5eUtTQjdYSEpjYmx4MElDQWdJRngwVDJKcVpXTjBMbVJsWm1sdVpWQnliM0JsY25SNUtIUmhjbWRsZEN3Z2NISnZjR1Z5ZEhrc0lHUmxjMk55YVhCMGIzSXBPMXh5WEc1Y2RDQWdJQ0JjZEdsbUtIUmhjbWRsZEM1ZlgyOWljMlZ5ZG1WeWMxOWZMbWx1WkdWNFQyWW9kR2hwY3lrK1BUQWdKaVlnSVhSb2FYTXVZV05qWlhCMGJHbHpkQ0I4ZkNCMGFHbHpMbUZqWTJWd2RHeHBjM1F1YVc1a1pYaFBaaWhjSW5KbFkyOXVabWxuZFhKbFhDSXBQajB3S1NCN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEhaaGNpQmphR0Z1WjJVZ1BTQjdiMkpxWldOME9uUmhjbWRsZEN4dVlXMWxPbkJ5YjNCbGNuUjVMSFI1Y0dVNlhDSnlaV052Ym1acFozVnlaVndpZlN4Y2NseHVJQ0FnSUNBZ0lDQmNkRngwWEhSemRHRnlkQ0E5SUhSb2FYTXVZMmhoYm1kbGMyVjBMbXhsYm1kMGFDQTlQVDBnTUN4Y2NseHVJQ0FnSUNBZ0lDQmNkRngwWEhSa1pXeHBkbVZ5SUQwZ2RHaHBjeTVrWld4cGRtVnlLQ2s3WEhKY2JseDBJQ0FnSUNBZ0lDQmNkSFJvYVhNdVkyaGhibWRsYzJWMExuQjFjMmdvWTJoaGJtZGxLVHRjY2x4dVhIUWdJQ0FnSUNBZ0lGeDBhV1lvYzNSaGNuUXBJSHRjY2x4dVhIUWdJQ0FnSUNBZ0lGeDBYSFJrWld4cGRtVnlLR1poYkhObExDaDBlWEJsYjJZb1pHVnNhWFpsY2k1a1pXeGhlU2s5UFQxY0ltNTFiV0psY2x3aUlEOGdaR1ZzYVhabGNpNWtaV3hoZVNBNklERXdLU2s3WEhKY2JseDBJQ0FnSUNBZ0lDQmNkSDFjY2x4dVhIUWdJQ0FnWEhSOVhISmNibHgwSUNBZ0lGeDBjbVYwZFhKdUlIUnlkV1U3WEhKY2JseDBJQ0FnSUgwN1hISmNibHgwSUNBZ0lFOWljMlZ5ZG1WeUxuQnliM1J2ZEhsd1pTNXpaWFJRY205MGIzUjVjR1ZQWmlBOUlHWjFibU4wYVc5dUtIUmhjbWRsZEN3Z2NISnZkRzkwZVhCbEtTQjdYSEpjYmx4MElDQWdJRngwZG1GeUlHOXNaSFpoYkhWbElEMGdUMkpxWldOMExtZGxkRkJ5YjNSdmRIbHdaVTltS0hSaGNtZGxkQ2s3WEhKY2JseDBJQ0FnSUZ4MFQySnFaV04wTG5ObGRGQnliM1J2ZEhsd1pVOW1LSFJoY21kbGRDd2djSEp2ZEc5MGVYQmxLVHRjY2x4dVhIUWdJQ0FnWEhScFppaDBZWEpuWlhRdVgxOXZZbk5sY25abGNuTmZYeTVwYm1SbGVFOW1LSFJvYVhNcFBqMHdJQ1ltSUNGMGFHbHpMbUZqWTJWd2RHeHBjM1FnZkh3Z2RHaHBjeTVoWTJObGNIUnNhWE4wTG1sdVpHVjRUMllvWENKelpYUlFjbTkwYjNSNWNHVmNJaWsrUFRBcElIdGNjbHh1WEhRZ0lDQWdJQ0FnSUZ4MGRtRnlJR05vWVc1blpTQTlJSHR2WW1wbFkzUTZkR0Z5WjJWMExHNWhiV1U2WENKZlgzQnliM1J2WDE5Y0lpeDBlWEJsT2x3aWMyVjBVSEp2ZEc5MGVYQmxYQ0lzYjJ4a1ZtRnNkV1U2YjJ4a2RtRnNkV1Y5TEZ4eVhHNGdJQ0FnWEhSY2RGeDBYSFJ6ZEdGeWRDQTlJSFJvYVhNdVkyaGhibWRsYzJWMExteGxibWQwYUNBOVBUMGdNQ3hjY2x4dUlDQWdJRngwWEhSY2RGeDBaR1ZzYVhabGNpQTlJSFJvYVhNdVpHVnNhWFpsY2lncE8xeHlYRzVjZENBZ0lDQWdJQ0FnWEhSMGFHbHpMbU5vWVc1blpYTmxkQzV3ZFhOb0tHTm9ZVzVuWlNrN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEdsbUtITjBZWEowS1NCN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEZ4MFpHVnNhWFpsY2lobVlXeHpaU3dvZEhsd1pXOW1LR1JsYkdsMlpYSXVaR1ZzWVhrcFBUMDlYQ0p1ZFcxaVpYSmNJaUEvSUdSbGJHbDJaWEl1WkdWc1lYa2dPaUF4TUNrcE8xeHlYRzVjZENBZ0lDQWdJQ0FnWEhSOVhISmNibHgwSUNBZ0lGeDBmVnh5WEc1Y2RDQWdJQ0JjZEhKbGRIVnliaUIwY25WbE8xeHlYRzVjZENBZ0lDQjlPMXh5WEc1Y2RDQWdJQ0JQWW5ObGNuWmxjaTV3Y205MGIzUjVjR1V1Y0hKbGRtVnVkRVY0ZEdWdWMybHZibk1nUFNCbWRXNWpkR2x2YmloMFlYSm5aWFFwSUh0Y2NseHVYSFFnSUNBZ0lDQWdJRTlpYW1WamRDNXdjbVYyWlc1MFJYaDBaVzV6YVc5dWN5aDBZWEpuWlhRcE8xeHlYRzVjZENBZ0lDQmNkR2xtS0hSaGNtZGxkQzVmWDI5aWMyVnlkbVZ5YzE5ZkxtbHVaR1Y0VDJZb2RHaHBjeWsrUFRBZ0ppWWdJWFJvYVhNdVlXTmpaWEIwYkdsemRDQjhmQ0IwYUdsekxtRmpZMlZ3ZEd4cGMzUXVhVzVrWlhoUFppaGNJbkJ5WlhabGJuUkZlSFJsYm5OcGIyNXpYQ0lwUGowd0tTQjdYSEpjYmx4MElDQWdJQ0FnSUNCY2RIWmhjaUJqYUdGdVoyVWdQU0I3YjJKcVpXTjBPblJoY21kbGRDeDBlWEJsT2x3aWNISmxkbVZ1ZEVWNGRHVnVjMmx2Ym5OY0luMHNYSEpjYmx4MFhIUmNkRngwWEhSemRHRnlkQ0E5SUhSb2FYTXVZMmhoYm1kbGMyVjBMbXhsYm1kMGFDQTlQVDBnTUN4Y2NseHVYSFJjZEZ4MFhIUmNkR1JsYkdsMlpYSWdQU0IwYUdsekxtUmxiR2wyWlhJb0tUdGNjbHh1WEhRZ0lDQWdJQ0FnSUZ4MGRHaHBjeTVqYUdGdVoyVnpaWFF1Y0hWemFDaGphR0Z1WjJVcE8xeHlYRzVjZENBZ0lDQWdJQ0FnWEhScFppaHpkR0Z5ZENrZ2UxeHlYRzVjZENBZ0lDQWdJQ0FnWEhSY2RHUmxiR2wyWlhJb1ptRnNjMlVzS0hSNWNHVnZaaWhrWld4cGRtVnlMbVJsYkdGNUtUMDlQVndpYm5WdFltVnlYQ0lnUHlCa1pXeHBkbVZ5TG1SbGJHRjVJRG9nTVRBcEtUdGNjbHh1WEhRZ0lDQWdJQ0FnSUZ4MGZWeHlYRzVjZENBZ0lDQmNkSDFjY2x4dVhIUWdJQ0FnWEhSeVpYUjFjbTRnZEhKMVpUdGNjbHh1WEhRZ0lDQWdmVHRjY2x4dVhIUWdJQ0FnVDJKcVpXTjBMbTlpYzJWeWRtVWdQU0JtZFc1amRHbHZiaWh2WW1wbFkzUXNZMkZzYkdKaFkyc3NZV05qWlhCMGJHbHpkQ3h3WVhWellXSnNaU3h3WVhWelpTeGtaV3hoZVNrZ2UxeHlYRzVjZENBZ0lDQmNkSEpsZEhWeWJpQnVaWGNnVDJKelpYSjJaWElvYjJKcVpXTjBMR05oYkd4aVlXTnJMR0ZqWTJWd2RHeHBjM1FzY0dGMWMyRmliR1VzY0dGMWMyVXNaR1ZzWVhrcE8xeHlYRzVjZENBZ0lDQjlPMXh5WEc1Y2RDQWdJQ0JQWW1wbFkzUXVkVzV2WW5ObGNuWmxJRDBnWm5WdVkzUnBiMjRvYjJKcVpXTjBMR05oYkd4aVlXTnJLU0I3WEhKY2JseDBJQ0FnSUZ4MGFXWW9iMkpxWldOMExsOWZiMkp6WlhKMlpYSkRZV3hzWW1GamEzTmZYeWtnZTF4eVhHNWNkQ0FnSUNCY2RGeDBhV1lvSVdOaGJHeGlZV05yS1NCN1hISmNibHgwSUNBZ0lGeDBYSFJjZEc5aWFtVmpkQzVmWDI5aWMyVnlkbVZ5UTJGc2JHSmhZMnR6WDE4dWMzQnNhV05sS0RBc2IySnFaV04wTGw5ZmIySnpaWEoyWlhKRFlXeHNZbUZqYTNOZlh5NXNaVzVuZEdncE8xeHlYRzVjZENBZ0lDQmNkRngwWEhSdlltcGxZM1F1WDE5dlluTmxjblpsY25OZlh5NXpjR3hwWTJVb01DeHZZbXBsWTNRdVgxOXZZbk5sY25abGNuTmZYeTVzWlc1bmRHZ3BPMXh5WEc1Y2RDQWdJQ0JjZEZ4MFhIUnlaWFIxY200N1hISmNibHgwSUNBZ0lGeDBYSFI5WEhKY2JseDBJQ0FnSUZ4MFhIUnZZbXBsWTNRdVgxOXZZbk5sY25abGNrTmhiR3hpWVdOcmMxOWZMbVp2Y2tWaFkyZ29ablZ1WTNScGIyNG9iMkp6WlhKMlpYSmpZV3hzWW1GamF5eHBLU0I3WEhKY2JseDBJQ0FnSUZ4MFhIUmNkR2xtS0dOaGJHeGlZV05yUFQwOWIySnpaWEoyWlhKallXeHNZbUZqYXlrZ2UxeHlYRzVjZENBZ0lDQmNkRngwWEhSY2RHOWlhbVZqZEM1ZlgyOWljMlZ5ZG1WeVEyRnNiR0poWTJ0elgxOHVjM0JzYVdObEtHa3NNU2s3WEhKY2JseDBJQ0FnSUZ4MFhIUmNkRngwWkdWc1pYUmxJRzlpYW1WamRDNWZYMjlpYzJWeWRtVnljMTlmVzJsZExtTmhiR3hpWVdOck8xeHlYRzVjZENBZ0lDQmNkRngwWEhSY2RHOWlhbVZqZEM1ZlgyOWljMlZ5ZG1WeWMxOWZMbk53YkdsalpTaHBMREVwTzF4eVhHNWNkQ0FnSUNCY2RGeDBYSFI5WEhKY2JseDBJQ0FnSUZ4MFhIUjlLVHRjY2x4dVhIUWdJQ0FnWEhSOVhISmNibHgwSUNBZ0lIMDdYSEpjYmx4MElDQWdJRUZ5Y21GNUxtOWljMlZ5ZG1VZ1BTQm1kVzVqZEdsdmJpaHZZbXBsWTNRc1kyRnNiR0poWTJzc1lXTmpaWEIwYkdsemRDeHdZWFZ6WVdKc1pTeHdZWFZ6WlN4a1pXeGhlU2tnZTF4eVhHNWNkQ0FnSUNCY2RHbG1LQ0VvYjJKcVpXTjBJR2x1YzNSaGJtTmxiMllnUVhKeVlYa3BJQ1ltSUNGQmNuSmhlUzVwYzBGeWNtRjVLRzlpYW1WamRDa3BJSHRjY2x4dVhIUWdJQ0FnWEhSY2RIUm9jbTkzSUc1bGR5QlVlWEJsUlhKeWIzSW9YQ0pHYVhKemRDQmhjbWQxYldWdWRDQjBieUJCY25KaGVTNXZZbk5sY25abGNpQnBjeUJ1YjNRZ1lXNGdRWEp5WVhsY0lpazdYSEpjYmx4MElDQWdJRngwZlZ4eVhHNGdJQ0FnSUNBZ0lDQWdJQ0JjZEdGalkyVndkR3hwYzNRZ1BTQmhZMk5sY0hSc2FYTjBJSHg4SUZ0Y0ltRmtaRndpTENCY0luVndaR0YwWlZ3aUxDQmNJbVJsYkdWMFpWd2lMQ0JjSW5Od2JHbGpaVndpWFR0Y2NseHVYSFFnSUNBZ1hIUjJZWElnWVhKeVlYbHdjbTk0ZVNBOUlHNWxkeUJRY205NGVTaHZZbXBsWTNRc2UyZGxkRG9nWm5WdVkzUnBiMjRvZEdGeVoyVjBMSEJ5YjNCbGNuUjVLU0I3WEhKY2JseDBJQ0FnSUZ4MFhIUnBaaWh3Y205d1pYSjBlVDA5UFZ3aWRXNXZZbk5sY25abFhDSXBJSHRjY2x4dVhIUmNkQ0FnSUNCY2RGeDBjbVYwZFhKdUlHWjFibU4wYVc5dUtHTmhiR3hpWVdOcktTQjdYSEpjYmx4MFhIUWdJQ0FnWEhSY2RGeDBhV1lvWTJGc2JHSmhZMnNwSUh0Y2NseHVYSFJjZENBZ0lDQmNkRngwWEhSY2RISmxkSFZ5YmlCUFltcGxZM1F1ZFc1dlluTmxjblpsS0hSaGNtZGxkQ3hqWVd4c1ltRmpheWs3WEhKY2JseDBYSFFnSUNBZ1hIUmNkRngwZlZ4eVhHNWNkRngwSUNBZ0lGeDBYSFJjZEhKbGRIVnliaUIwWVhKblpYUXVkVzV2WW5ObGNuWmxLQ2s3WEhKY2JseDBYSFFnSUNBZ1hIUmNkSDA3WEhKY2JseDBYSFFnSUNBZ1hIUjlYSEpjYmx4MElDQWdJRngwWEhScFppaHdjbTl3WlhKMGVUMDlQVndpYzNCc2FXTmxYQ0lwSUh0Y2NseHVYSFFnSUNBZ1hIUmNkRngwY21WMGRYSnVJR1oxYm1OMGFXOXVLSE4wWVhKMExHVnVaQ2tnZTF4eVhHNWNkQ0FnSUNCY2RGeDBYSFJjZEdsbUtIUjVjR1Z2WmloemRHRnlkQ2toUFQxY0ltNTFiV0psY2x3aUlIeDhJSFI1Y0dWdlppaGxibVFwSVQwOVhDSnVkVzFpWlhKY0lpa2dlMXh5WEc1Y2RDQWdJQ0JjZEZ4MFhIUmNkRngwZEdoeWIzY2dibVYzSUZSNWNHVkZjbkp2Y2loY0lrWnBjbk4wSUhSM2J5QmhjbWQxYldWdWRITWdkRzhnUVhKeVlYa2djM0JzYVdObElHRnlaU0J1YjNRZ2JuVnRZbVZ5TENCdWRXMWlaWEpjSWlrN1hISmNibHgwSUNBZ0lGeDBYSFJjZEZ4MGZWeHlYRzVjZENBZ0lDQmNkQ0FnSUNCY2RGeDBkbUZ5SUhKbGJXOTJaV1FnUFNCMGFHbHpMbk5zYVdObEtITjBZWEowTEhOMFlYSjBLMlZ1WkNrc1hISmNibHgwSUNBZ0lGeDBJQ0FnSUZ4MFhIUmNkR0ZrWkdWa1EyOTFiblFnUFNBb1lYSm5kVzFsYm5SekxteGxibWQwYUNBK0lERWdQeUJoY21kMWJXVnVkSE11YkdWdVozUm9MVElnT2lBd0tTeGNjbHh1WEhRZ0lDQWdYSFFnSUNBZ1hIUmNkRngwWTJoaGJtZGxJRDBnSUh0dlltcGxZM1E2YjJKcVpXTjBMSFI1Y0dVNlhDSnpjR3hwWTJWY0lpeHBibVJsZURwemRHRnlkQ3h5WlcxdmRtVmtPbkpsYlc5MlpXUXNZV1JrWldSRGIzVnVkRHBoWkdSbFpFTnZkVzUwZlR0Y2NseHVYSFFnSUNBZ1hIUWdJQ0FnWEhSY2RIUmhjbWRsZEM1emNHeHBZMlV1WVhCd2JIa29kR0Z5WjJWMExHRnlaM1Z0Wlc1MGN5azdYSEpjYmx4MElDQWdJRngwSUNBZ0lGeDBYSFJwWmloaFkyTmxjSFJzYVhOMExtbHVaR1Y0VDJZb1hDSnpjR3hwWTJWY0lpaytQVEFwSUh0Y2NseHVYSFFnSUNBZ1hIUWdJQ0FnWEhSY2RGeDBkbUZ5SUhOMFlYSjBJRDBnY0hKdmVIa3VYMTl2WW5ObGNuWmxjbDlmTG1Ob1lXNW5aWE5sZEM1c1pXNW5kR2dnUFQwOUlEQXNYSEpjYmx4MElDQWdJRngwSUNBZ0lDQWdJQ0JjZEZ4MFhIUmtaV3hwZG1WeUlEMGdjSEp2ZUhrdVgxOXZZbk5sY25abGNsOWZMbVJsYkdsMlpYSW9LVHRjY2x4dVhIUWdJQ0FnWEhRZ0lDQWdYSFJjZEZ4MGNISnZlSGt1WDE5dlluTmxjblpsY2w5ZkxtTm9ZVzVuWlhObGRDNXdkWE5vS0dOb1lXNW5aU2s3WEhKY2JseDBJQ0FnSUZ4MElDQWdJRngwWEhSY2RHbG1LSE4wWVhKMEtTQjdYSEpjYmx4MElDQWdJRngwWEhRZ0lDQWdJQ0FnSUZ4MFhIUmtaV3hwZG1WeUtHWmhiSE5sTENoMGVYQmxiMllvWkdWc2FYWmxjaTVrWld4aGVTazlQVDFjSW01MWJXSmxjbHdpSUQ4Z1pHVnNhWFpsY2k1a1pXeGhlU0E2SURFd0tTazdYSEpjYmx4MElDQWdJRngwWEhRZ0lDQWdJQ0FnSUZ4MGZWeHlYRzVjZENBZ0lDQmNkQ0FnSUNCY2RGeDBmVnh5WEc1Y2RDQWdJQ0JjZENBZ0lDQmNkSDFjY2x4dVhIUWdJQ0FnWEhSY2RIMWNjbHh1WEhRZ0lDQWdYSFJjZEdsbUtIQnliM0JsY25SNVBUMDlYQ0p3ZFhOb1hDSXBJSHRjY2x4dVhIUWdJQ0FnWEhSY2RGeDBJSEpsZEhWeWJpQm1kVzVqZEdsdmJpaHBkR1Z0S1NCN1hISmNibHgwSUNBZ0lGeDBYSFFnSUNBZ1hIUnlaWFIxY200Z2RHaHBjeTV6Y0d4cFkyVW9kR2hwY3k1c1pXNW5kR2dzTUN4cGRHVnRLVHRjY2x4dVhIUWdJQ0FnWEhSY2RDQWdJQ0I5WEhKY2JseDBJQ0FnSUZ4MFhIUjlYSEpjYmx4MElDQWdJRngwWEhScFppaHdjbTl3WlhKMGVUMDlQVndpY0c5d1hDSXBJSHRjY2x4dVhIUWdJQ0FnWEhSY2RGeDBJSEpsZEhWeWJpQm1kVzVqZEdsdmJpZ3BJSHRjY2x4dVhIUWdJQ0FnWEhSY2RDQWdJQ0JjZEhKbGRIVnliaUIwYUdsekxuTndiR2xqWlNoMGFHbHpMbXhsYm1kMGFDMHhMREVwTzF4eVhHNWNkQ0FnSUNCY2RGeDBJQ0FnSUgxY2NseHVYSFFnSUNBZ1hIUmNkSDFjY2x4dVhIUWdJQ0FnWEhSY2RHbG1LSEJ5YjNCbGNuUjVQVDA5WENKMWJuTm9hV1owWENJcElIdGNjbHh1WEhRZ0lDQWdYSFJjZEZ4MElISmxkSFZ5YmlCbWRXNWpkR2x2YmlocGRHVnRLU0I3WEhKY2JpQWdJQ0JjZEZ4MElDQWdJRngwWEhSeVpYUjFjbTRnZEdocGN5NXpjR3hwWTJVb01Dd3dMR2wwWlcwcE8xeHlYRzRnSUNBZ1hIUmNkQ0FnSUNCY2RIMWNjbHh1WEhRZ0lDQWdYSFJjZEgxY2NseHVYSFFnSUNBZ1hIUmNkR2xtS0hCeWIzQmxjblI1UFQwOVhDSnphR2xtZEZ3aUtTQjdYSEpjYmx4MElDQWdJRngwWEhSY2RISmxkSFZ5YmlCbWRXNWpkR2x2YmlncElIdGNjbHh1WEhRZ0lDQWdYSFFnSUNBZ1hIUmNkSEpsZEhWeWJpQjBhR2x6TG5Od2JHbGpaU2d3TERFcE8xeHlYRzVjZENBZ0lDQmNkQ0FnSUNCY2RIMWNjbHh1WEhRZ0lDQWdYSFJjZEgxY2NseHVYSFFnSUNBZ1hIUmNkSEpsZEhWeWJpQjBZWEpuWlhSYmNISnZjR1Z5ZEhsZE8xeHlYRzVjZENBZ0lDQmNkSDE5S1R0Y2NseHVYSFFnSUNBZ1hIUjJZWElnY0hKdmVIa2dQU0JQWW1wbFkzUXViMkp6WlhKMlpTaGhjbkpoZVhCeWIzaDVMR1oxYm1OMGFXOXVLR05vWVc1blpYTmxkQ2tnZXlCY2NseHVYSFFnSUNBZ1hIUmNkSFpoY2lCamFHRnVaMlZ6SUQwZ1kyaGhibWRsYzJWMExtWnBiSFJsY2lobWRXNWpkR2x2YmloamFHRnVaMlVwSUhzZ2NtVjBkWEp1SUdOb1lXNW5aUzV1WVcxbElUMDlYQ0pzWlc1bmRHaGNJaUFtSmlCamFHRnVaMlV1Ym1GdFpTRTlQVndpWVdSa1hDSWdKaVlnS0NGaFkyTmxjSFJzYVhOMElIeDhJR0ZqWTJWd2RHeHBjM1F1YVc1a1pYaFBaaWhqYUdGdVoyVXVkSGx3WlNrK1BUQXBPeUI5S1R0Y2NseHVYSFFnSUNBZ1hIUmNkR2xtS0dOb1lXNW5aWE11YkdWdVozUm9QakFwSUh0Y2NseHVYSFFnSUNBZ1hIUmNkRngwWTJGc2JHSmhZMnNvWTJoaGJtZGxjeWs3WEhKY2JseDBJQ0FnSUZ4MFhIUjlYSEpjYmx4MElDQWdJRngwZlN4aFkyTmxjSFJzYVhOMExIQmhkWE5oWW14bExIQmhkWE5sTEdSbGJHRjVLVHRjY2x4dVhIUWdJQ0FnWEhSeVpYUjFjbTRnY0hKdmVIazdYSEpjYmx4MElDQWdJSDA3WEhKY2JseDBJQ0FnSUVGeWNtRjVMblZ1YjJKelpYSjJaU0E5SUdaMWJtTjBhVzl1S0c5aWFtVmpkQ3hqWVd4c1ltRmpheWtnZTF4eVhHNWNkRngwSUNCeVpYUjFjbTRnYjJKcVpXTjBMblZ1YjJKelpYSjJaU2hqWVd4c1ltRmpheWs3WEhKY2JseDBJQ0FnSUgxY2NseHVYSFI5WEhKY2JseDBUMkpxWldOMExtUmxaWEJQWW5ObGNuWmxJRDBnWm5WdVkzUnBiMjRvYjJKcVpXTjBMR05oYkd4aVlXTnJMSEJoY25SektTQjdYSEpjYmx4eVhHNWNkRngwY0dGeWRITWdQU0FvY0dGeWRITWdQeUJ3WVhKMGN5QTZJRnRkS1R0Y2NseHVYSEpjYmx4MFhIUjJZWElnZEc5VWVYQmxUbUZ0WlNBOUlHWjFibU4wYVc5dUtHOWlhaWtnZTF4eVhHNWNkRngwWEhSeVpYUjFjbTRnS0h0OUtTNTBiMU4wY21sdVp5NWpZV3hzS0c5aWFpa3ViV0YwWTJnb0wxeGNjeWhiWVMxNlFTMWFYU3NwTHlsYk1WMHVkRzlNYjNkbGNrTmhjMlVvS1Z4eVhHNWNkRngwZlZ4eVhHNWNjbHh1WEhSY2RHWjFibU4wYVc5dUlISmxiMkp6WlhKMlpTaDJZV3gxWlN3Z2NHRnlkSE1wSUh0Y2NseHVYSFJjZEZ4MGRtRnlJR3RsZVhNZ1BTQlBZbXBsWTNRdWEyVjVjeWgyWVd4MVpTazdYSEpjYmx4MFhIUmNkR3RsZVhNdVptOXlSV0ZqYUNobWRXNWpkR2x2YmloclpYa3BJSHRjY2x4dVhIUmNkRngwWEhScFppZ29kRzlVZVhCbFRtRnRaU2gyWVd4MVpWdHJaWGxkS1NBOVBUMGdKMjlpYW1WamRDY2dmSHdnZEc5VWVYQmxUbUZ0WlNoMllXeDFaVnRyWlhsZEtTQTlQVDBnSjJGeWNtRjVKeWtnSmlZZ0lYWmhiSFZsVzJ0bGVWMHVhR0Z6VDNkdVVISnZjR1Z5ZEhrb0oxOWZiMkp6WlhKMlpYSnpYMThuS1NrZ2UxeHlYRzVjZEZ4MFhIUmNkRngwZG1GeUlHNWxkM0JoY25SeklEMGdjR0Z5ZEhNdWMyeHBZMlVvTUNrN1hISmNibHgwWEhSY2RGeDBYSFJ1Wlhkd1lYSjBjeTV3ZFhOb0tHdGxlU2s3WEhKY2JseDBYSFJjZEZ4MFhIUjJZV3gxWlZ0clpYbGRJRDBnVDJKcVpXTjBMbVJsWlhCUFluTmxjblpsS0haaGJIVmxXMnRsZVYwc1kyRnNiR0poWTJzc2JtVjNjR0Z5ZEhNcE8xeHlYRzVjZEZ4MFhIUmNkSDFjY2x4dVhIUmNkRngwZlNrN1hISmNibHgwWEhSOVhISmNibHh5WEc1Y2RGeDBjbVZ2WW5ObGNuWmxLRzlpYW1WamRDd2djR0Z5ZEhNcE8xeHlYRzVjY2x4dVhIUmNkSFpoY2lCdlluTmxjblpsWkNBOUlFOWlhbVZqZEM1dlluTmxjblpsS0c5aWFtVmpkQ3htZFc1amRHbHZiaWhqYUdGdVoyVnpaWFFwSUh0Y2NseHVYSFJjZEZ4MGRtRnlJR05vWVc1blpYTWdQU0JiWFR0Y2NseHVYSFJjZEZ4MFpuVnVZM1JwYjI0Z2NtVmpkWEp6WlNodVlXMWxMSEp2YjNSUFltcGxZM1FzYjJ4a1QySnFaV04wTEc1bGQwOWlhbVZqZEN4d1lYUm9LU0I3WEhKY2JseDBYSFJjZEZ4MGFXWW9ibVYzVDJKcVpXTjBJR2x1YzNSaGJtTmxiMllnVDJKcVpXTjBLU0I3WEhKY2JseDBYSFJjZEZ4MFhIUjJZWElnYm1WM2EyVjVjeUE5SUU5aWFtVmpkQzVyWlhsektHNWxkMDlpYW1WamRDazdYSEpjYmx4MFhIUmNkRngwWEhSdVpYZHJaWGx6TG1admNrVmhZMmdvWm5WdVkzUnBiMjRvYTJWNUtTQjdYSEpjYmx4MFhIUmNkRngwWEhSY2RHbG1LQ0Z2YkdSUFltcGxZM1FnZkh3Z0tHOXNaRTlpYW1WamRGdHJaWGxkSVQwOWJtVjNUMkpxWldOMFcydGxlVjBwS1NCN1hISmNibHgwWEhSY2RGeDBYSFJjZEZ4MGRtRnlJRzlzWkhaaGJIVmxJRDBnS0c5c1pFOWlhbVZqZENBbUppQnZiR1JQWW1wbFkzUmJhMlY1WFNFOVBYVnVaR1ZtYVc1bFpDQS9JRzlzWkU5aWFtVmpkRnRyWlhsZElEb2dkVzVrWldacGJtVmtLU3hjY2x4dVhIUmNkRngwWEhSY2RGeDBYSFJjZEdOb1lXNW5aU0E5SUNodmJHUjJZV3gxWlQwOVBYVnVaR1ZtYVc1bFpDQS9JRndpWVdSa1hDSWdPaUJjSW5Wd1pHRjBaVndpS1N4Y2NseHVYSFJjZEZ4MFhIUmNkRngwWEhSY2RHdGxlWEJoZEdnZ1BTQndZWFJvSUNzZ1hDSXVYQ0lnS3lCclpYazdYSEpjYmx4eVhHNWNkRngwWEhSY2RGeDBYSFJjZEdOb1lXNW5aWE11Y0hWemFDaDdibUZ0WlRwdVlXMWxMRzlpYW1WamREcHliMjkwVDJKcVpXTjBMSFI1Y0dVNlkyaGhibWRsTEc5c1pGWmhiSFZsT205c1pIWmhiSFZsTEc1bGQxWmhiSFZsT201bGQwOWlhbVZqZEZ0clpYbGRMR3RsZVhCaGRHZzZhMlY1Y0dGMGFIMHBPMXh5WEc1Y2RGeDBYSFJjZEZ4MFhIUmNkSEpsWTNWeWMyVW9ibUZ0WlN4eWIyOTBUMkpxWldOMExHOXNaSFpoYkhWbExHNWxkMDlpYW1WamRGdHJaWGxkTEd0bGVYQmhkR2dwTzF4eVhHNWNkRngwWEhSY2RGeDBYSFI5WEhKY2JseDBYSFJjZEZ4MFhIUjlLVHRjY2x4dVhIUmNkRngwWEhSOUlHVnNjMlVnYVdZb2IyeGtUMkpxWldOMElHbHVjM1JoYm1ObGIyWWdUMkpxWldOMEtTQjdYSEpjYmx4MFhIUmNkRngwWEhSMllYSWdiMnhrYTJWNWN5QTlJRTlpYW1WamRDNXJaWGx6S0c5c1pFOWlhbVZqZENrN1hISmNibHgwWEhSY2RGeDBYSFJ2YkdSclpYbHpMbVp2Y2tWaFkyZ29ablZ1WTNScGIyNG9hMlY1S1NCN1hISmNibHgwWEhSY2RGeDBYSFJjZEhaaGNpQmphR0Z1WjJVZ1BTQW9ibVYzVDJKcVpXTjBQVDA5Ym5Wc2JDQS9JRndpZFhCa1lYUmxYQ0lnT2lCY0ltUmxiR1YwWlZ3aUtTeGNjbHh1WEhSY2RGeDBYSFJjZEZ4MFhIUnJaWGx3WVhSb0lEMGdjR0YwYUNBcklGd2lMbHdpSUNzZ2EyVjVPMXh5WEc1Y2RGeDBYSFJjZEZ4MFhIUmNkRnh5WEc1Y2RGeDBYSFJjZEZ4MFhIUmphR0Z1WjJWekxuQjFjMmdvZTI1aGJXVTZibUZ0WlN4dlltcGxZM1E2Y205dmRFOWlhbVZqZEN4MGVYQmxPbU5vWVc1blpTeHZiR1JXWVd4MVpUcHZiR1JQWW1wbFkzUmJhMlY1WFN4dVpYZFdZV3gxWlRwdVpYZFBZbXBsWTNRc2EyVjVjR0YwYURwclpYbHdZWFJvZlNrN1hISmNibHgwWEhSY2RGeDBYSFJjZEhKbFkzVnljMlVvYm1GdFpTeHliMjkwVDJKcVpXTjBMRzlzWkU5aWFtVmpkRnRyWlhsZExIVnVaR1ZtYVc1bFpDeHJaWGx3WVhSb0tUdGNjbHh1WEhSY2RGeDBYSFJjZEgwcE8xeHlYRzVjZEZ4MFhIUmNkSDFjY2x4dVhIUmNkRngwZlZ4eVhHNWNkRngwWEhSamFHRnVaMlZ6WlhRdVptOXlSV0ZqYUNobWRXNWpkR2x2YmloamFHRnVaMlVwSUh0Y2NseHVYSFJjZEZ4MFhIUjJZWElnYTJWNWNHRjBhQ0E5SUNod1lYSjBjeTVzWlc1bmRHZytNQ0EvSUhCaGNuUnpMbXB2YVc0b1hDSXVYQ0lwSUNzZ1hDSXVYQ0lnT2lCY0lsd2lLU0FySUdOb1lXNW5aUzV1WVcxbE8xeHlYRzVjY2x4dVhIUmNkRngwWEhScFppQW9ZMmhoYm1kbExuUjVjR1VnUFQwOUlGd2lkWEJrWVhSbFhDSWdmSHdnWTJoaGJtZGxMblI1Y0dVZ1BUMDlJRndpWVdSa1hDSXBJSHNnWEhKY2JseDBYSFJjZEZ4MFhIUnlaVzlpYzJWeWRtVW9ZMmhoYm1kbExtOWlhbVZqZEN3Z2NHRnlkSE1wTzF4eVhHNWNkRngwWEhSY2RIMWNjbHh1WEhKY2JseDBYSFJjZEZ4MFkyaGhibWRsY3k1d2RYTm9LSHR1WVcxbE9tTm9ZVzVuWlM1dVlXMWxMRzlpYW1WamREcGphR0Z1WjJVdWIySnFaV04wTEhSNWNHVTZZMmhoYm1kbExuUjVjR1VzYjJ4a1ZtRnNkV1U2WTJoaGJtZGxMbTlzWkZaaGJIVmxMRzVsZDFaaGJIVmxPbU5vWVc1blpTNXZZbXBsWTNSYlkyaGhibWRsTG01aGJXVmRMR3RsZVhCaGRHZzZhMlY1Y0dGMGFIMHBPMXh5WEc1Y2RGeDBYSFJjZEhKbFkzVnljMlVvWTJoaGJtZGxMbTVoYldVc1kyaGhibWRsTG05aWFtVmpkQ3hqYUdGdVoyVXViMnhrVm1Gc2RXVXNZMmhoYm1kbExtOWlhbVZqZEZ0amFHRnVaMlV1Ym1GdFpWMHNhMlY1Y0dGMGFDazdYSEpjYmx4MFhIUmNkSDBwTzF4eVhHNWNkRngwWEhSallXeHNZbUZqYXloamFHRnVaMlZ6S1R0Y2NseHVYSFJjZEgwcE8xeHlYRzVjZEZ4MGNtVjBkWEp1SUc5aWMyVnlkbVZrTzF4eVhHNWNkSDA3WEhKY2JuMHBLQ2s3WEhKY2JseHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5d2NtOTRlUzF2WW5ObGNuWmxMMmx1WkdWNExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXhNVGhjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lEY2lMQ0l2S2lwY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1VGUWdTVzV2ZG1IRHA4T2pieUJsSUZOcGMzUmxiV0Z6SUZOQlhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklFbE9SVk5ETFVsRVhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklGRlZUMEpKVXlCT1JWUlhUMUpMVXlCVFRGeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQkdVa0ZWVGtoUFJrVlNMVWRGVTBWTVRGTkRTRUZHVkNCYVZWSWdSazlGVWtSRlVsVk9SeUJFUlZJZ1FVNUhSVmRCVGtSVVJVNGdSazlTVTBOSVZVNUhJRVV1Vmx4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCUFVrRk9SMFVnVTBGY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1JHVjFkSE5qYUdVZ1ZHVnNaV3R2YlNCQlIxeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQkJjR2w2WldWY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1ZFVkRTRTVKVTBOSVJTQlZUa2xXUlZKVFNWUkJWQ0JDUlZKTVNVNWNiaXBjYmlvZ1RHbGpaVzV6WldRZ2RXNWtaWElnZEdobElFRndZV05vWlNCTWFXTmxibk5sTENCV1pYSnphVzl1SURJdU1DQW9kR2hsSUZ3aVRHbGpaVzV6WlZ3aUtUdGNiaW9nZVc5MUlHMWhlU0J1YjNRZ2RYTmxJSFJvYVhNZ1ptbHNaU0JsZUdObGNIUWdhVzRnWTI5dGNHeHBZVzVqWlNCM2FYUm9JSFJvWlNCTWFXTmxibk5sTGx4dUtpQlpiM1VnYldGNUlHOWlkR0ZwYmlCaElHTnZjSGtnYjJZZ2RHaGxJRXhwWTJWdWMyVWdZWFJjYmlwY2Jpb2dJQ0JvZEhSd09pOHZkM2QzTG1Gd1lXTm9aUzV2Y21jdmJHbGpaVzV6WlhNdlRFbERSVTVUUlMweUxqQmNiaXBjYmlvZ1ZXNXNaWE56SUhKbGNYVnBjbVZrSUdKNUlHRndjR3hwWTJGaWJHVWdiR0YzSUc5eUlHRm5jbVZsWkNCMGJ5QnBiaUIzY21sMGFXNW5MQ0J6YjJaMGQyRnlaVnh1S2lCa2FYTjBjbWxpZFhSbFpDQjFibVJsY2lCMGFHVWdUR2xqWlc1elpTQnBjeUJrYVhOMGNtbGlkWFJsWkNCdmJpQmhiaUJjSWtGVElFbFRYQ0lnUWtGVFNWTXNYRzRxSUZkSlZFaFBWVlFnVjBGU1VrRk9WRWxGVXlCUFVpQkRUMDVFU1ZSSlQwNVRJRTlHSUVGT1dTQkxTVTVFTENCbGFYUm9aWElnWlhod2NtVnpjeUJ2Y2lCcGJYQnNhV1ZrTGx4dUtpQlRaV1VnZEdobElFeHBZMlZ1YzJVZ1ptOXlJSFJvWlNCemNHVmphV1pwWXlCc1lXNW5kV0ZuWlNCbmIzWmxjbTVwYm1jZ2NHVnliV2x6YzJsdmJuTWdZVzVrWEc0cUlHeHBiV2wwWVhScGIyNXpJSFZ1WkdWeUlIUm9aU0JNYVdObGJuTmxMbHh1S2lvdlhHNWNibWx0Y0c5eWRDQkVZWFJoVDJKcVpXTjBJR1p5YjIwZ0p5NHZSR0YwWVU5aWFtVmpkQ2M3WEc1cGJYQnZjblFnUkdGMFlVOWlhbVZqZEVOb2FXeGtJR1p5YjIwZ0p5NHZSR0YwWVU5aWFtVmpkRU5vYVd4a0p6dGNibHh1YkdWMElFWnBiSFJsY2xSNWNHVWdQU0I3UVU1Wk9pQW5ZVzU1Snl3Z1UxUkJVbFE2SUNkemRHRnlkQ2NzSUVWWVFVTlVPaUFuWlhoaFkzUW5mVHRjYmx4dUx5b3FYRzRnS2lCVWFHVWdZMnhoYzNNZ2NtVjBkWEp1WldRZ1puSnZiU0IwYUdVZ1UzbHVZMmhsY2lCemRXSnpZM0pwWW1VZ1kyRnNiQzVjYmlBcUlGUnZJR0psSUhWelpXUWdZWE1nWVc0Z2IySnpaWEoyWVhScGIyNGdjRzlwYm5RZ1puSnZiU0JoSUVSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2lCamFHRnVaMlV1WEc0Z0tpOWNibU5zWVhOeklFUmhkR0ZQWW1wbFkzUlBZbk5sY25abGNpQmxlSFJsYm1SeklFUmhkR0ZQWW1wbFkzUWdMeW9nYVcxd2JHVnRaVzUwY3lCVGVXNWpVM1JoZEhWeklDb3ZJSHRjYmlBZ0x5b2djSEpwZG1GMFpWeHVJQ0JmWTJoaGJtZGxUR2x6ZEdWdVpYSTZJRTF6WjB4cGMzUmxibVZ5WEc1Y2JpQWdMUzB0TFdWMlpXNTBJR2hoYm1Sc1pYSnpMUzB0TFZ4dUlDQmZabWxzZEdWeWN6b2dlenhtYVd4MFpYSStPaUI3ZEhsd1pUb2dQSE4wWVhKMExDQmxlR0ZqZEQ0c0lHTmhiR3hpWVdOck9pQThablZ1WTNScGIyNCtmU0I5WEc0Z0lDb3ZYRzVjYmlBZ0x5b3FYRzRnSUNBcUlFQnBaMjV2Y21WY2JpQWdJQ29nVTJodmRXeGtJRzV2ZENCaVpTQjFjMlZrSUdScGNtVmpkR3g1SUdKNUlFaDVjR1Z5ZEdsbGN5NGdTWFFuY3lCallXeHNaV1FnWW5rZ2RHaGxJRk41Ym1Ob1pYSXVjM1ZpYzJOeWFXSmxJRzFsZEdodlpGeHVJQ0FnS2k5Y2JseHVJQ0F2TDFSUFJFODZJRVp2Y2lCR2RYSjBhR1Z5SUZOMGRXUjVYRzRnSUdOdmJuTjBjblZqZEc5eUtITjVibU5vWlhJc0lIVnliQ3dnYzJOb1pXMWhMQ0JwYm1sMGFXRnNVM1JoZEhWekxDQnBibWwwYVdGc1JHRjBZU3dnWTJocGJHUnlaVzV6TENCcGJtbDBhV0ZzVm1WeWMybHZiaXdnYlhWMGRXRnNLU0I3WEc0Z0lDQWdjM1Z3WlhJb2MzbHVZMmhsY2l3Z2RYSnNMQ0J6WTJobGJXRXNJR2x1YVhScFlXeFRkR0YwZFhNc0lHbHVhWFJwWVd4RVlYUmhMbVJoZEdFc0lHTm9hV3hrY21WdWN5d2diWFYwZFdGc0tUdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWDNSb2FYTXVYM1psY25OcGIyNGdQU0JwYm1sMGFXRnNWbVZ5YzJsdmJqdGNiaUFnSUNCZmRHaHBjeTVmWm1sc2RHVnljeUE5SUh0OU8xeHVYRzRnSUNBZ1gzUm9hWE11WDNONWJtTlBZbW91YjJKelpYSjJaU2dvWlhabGJuUXBJRDArSUh0Y2JpQWdJQ0FnSUY5MGFHbHpMbDl2YmtacGJIUmxjaWhsZG1WdWRDazdYRzRnSUNBZ2ZTazdYRzVjYmlBZ0lDQXZMM05sZEhWd0lHTm9hV3hrY21WdWN5QmtZWFJoSUdaeWIyMGdjM1ZpYzJOeWFYQjBhVzl1WEc0Z0lDQWdUMkpxWldOMExtdGxlWE1vYVc1cGRHbGhiRVJoZEdFdVkyaHBiR1J5Wlc1ektTNW1iM0pGWVdOb0tDaGphR2xzWkVsa0tTQTlQaUI3WEc0Z0lDQWdJQ0JzWlhRZ1kyaHBiR1JFWVhSaElEMGdhVzVwZEdsaGJFUmhkR0V1WTJocGJHUnlaVzV6VzJOb2FXeGtTV1JkTzF4dUlDQWdJQ0FnWDNSb2FYTXVYMk5vYVd4a2NtVnVUMkpxWldOMGMxdGphR2xzWkVsa1hTQTlJRzVsZHlCRVlYUmhUMkpxWldOMFEyaHBiR1FvWDNSb2FYTXNJR05vYVd4a1NXUXNJR05vYVd4a1JHRjBZU2s3WEc0Z0lDQWdmU2s3WEc1Y2JpQWdJQ0JmZEdocGN5NWZZV3hzYjJOaGRHVk1hWE4wWlc1bGNuTW9LVHRjYmlBZ2ZWeHVYRzRnSUY5aGJHeHZZMkYwWlV4cGMzUmxibVZ5Y3lncElIdGNiaUFnSUNCemRYQmxjaTVmWVd4c2IyTmhkR1ZNYVhOMFpXNWxjbk1vS1R0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdYM1JvYVhNdVgyTm9ZVzVuWlV4cGMzUmxibVZ5SUQwZ1gzUm9hWE11WDJKMWN5NWhaR1JNYVhOMFpXNWxjaWhmZEdocGN5NWZkWEpzSUNzZ0p5OWphR0Z1WjJWekp5d2dLRzF6WnlrZ1BUNGdlMXh1SUNBZ0lDQWdhV1lnS0cxelp5NTBlWEJsSUQwOVBTQW5kWEJrWVhSbEp5a2dlMXh1SUNBZ0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblJHRjBZVTlpYW1WamRFOWljMlZ5ZG1WeUxTY2dLeUJmZEdocGN5NWZkWEpzSUNzZ0p5MVNRMVk2SUNjc0lHMXpaeWs3WEc0Z0lDQWdJQ0FnSUY5MGFHbHpMbDlqYUdGdVoyVlBZbXBsWTNRb1gzUm9hWE11WDNONWJtTlBZbW9zSUcxelp5azdYRzRnSUNBZ0lDQjlYRzRnSUNBZ2ZTazdYRzRnSUgxY2JseHVJQ0JmY21Wc1pXRnpaVXhwYzNSbGJtVnljeWdwSUh0Y2JpQWdJQ0J6ZFhCbGNpNWZjbVZzWldGelpVeHBjM1JsYm1WeWN5Z3BPMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNCZmRHaHBjeTVmWTJoaGJtZGxUR2x6ZEdWdVpYSXVjbVZ0YjNabEtDazdYRzRnSUgxY2JseHVJQ0F2S2lwY2JpQWdJQ29nVW1Wc1pXRnpaU0JoYm1RZ1pHVnNaWFJsSUc5aWFtVmpkQ0JrWVhSaFhHNGdJQ0FxTDF4dUlDQmtaV3hsZEdVb0tTQjdYRzRnSUNBZ2JHVjBJRjkwYUdseklEMGdkR2hwY3p0Y2JseHVJQ0FnSUY5MGFHbHpMbDl5Wld4bFlYTmxUR2x6ZEdWdVpYSnpLQ2s3WEc0Z0lDQWdaR1ZzWlhSbElGOTBhR2x6TGw5emVXNWphR1Z5TGw5dlluTmxjblpsY25OYlgzUm9hWE11WDNWeWJGMDdYRzRnSUgxY2JseHVJQ0F2S2lwY2JpQWdJQ29nVW1Wc1pXRnpaU0JoYm1RZ1pHVnNaWFJsSUc5aWFtVmpkQ0JrWVhSaFhHNGdJQ0FxTDF4dUlDQjFibk4xWW5OamNtbGlaU2dwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdMeTlHVEU5WExVOVZWRG9nZEdocGN5QnRaWE56WVdkbElIZHBiR3dnWW1VZ2MyVnVkQ0IwYnlCMGFHVWdjblZ1ZEdsdFpTQnBibk4wWVc1alpTQnZaaUJUZVc1amFHVnlUV0Z1WVdkbGNpQXRQaUJmYjI1TWIyTmhiRlZ1VTNWaWMyTnlhV0psWEc0Z0lDQWdiR1YwSUhWdVUzVmljMk55YVdKbFRYTm5JRDBnZTF4dUlDQWdJQ0FnZEhsd1pUb2dKM1Z1YzNWaWMyTnlhV0psSnl3Z1puSnZiVG9nWDNSb2FYTXVYMjkzYm1WeUxDQjBiem9nWDNSb2FYTXVYM041Ym1Ob1pYSXVYM04xWWxWU1RDeGNiaUFnSUNBZ0lHSnZaSGs2SUhzZ2NtVnpiM1Z5WTJVNklGOTBhR2x6TGw5MWNtd2dmVnh1SUNBZ0lIMDdYRzVjYmlBZ0lDQmZkR2hwY3k1ZlluVnpMbkJ2YzNSTlpYTnpZV2RsS0hWdVUzVmljMk55YVdKbFRYTm5MQ0FvY21Wd2JIa3BJRDArSUh0Y2JpQWdJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZEVZWFJoVDJKcVpXTjBUMkp6WlhKMlpYSXRWVTVUVlVKVFExSkpRa1U2SUNjc0lISmxjR3g1S1R0Y2JpQWdJQ0FnSUdsbUlDaHlaWEJzZVM1aWIyUjVMbU52WkdVZ1BUMDlJREl3TUNrZ2UxeHVJQ0FnSUNBZ0lDQmZkR2hwY3k1ZmNtVnNaV0Z6WlV4cGMzUmxibVZ5Y3lncE8xeHVJQ0FnSUNBZ0lDQmtaV3hsZEdVZ1gzUm9hWE11WDNONWJtTm9aWEl1WDI5aWMyVnlkbVZ5YzF0ZmRHaHBjeTVmZFhKc1hUdGNiaUFnSUNBZ0lIMWNiaUFnSUNCOUtUdGNiaUFnZlZ4dVhHNGdJQzhxS2x4dUlDQWdLaUJTWldkcGMzUmxjaUIwYUdVZ1kyaGhibWRsSUd4cGMzUmxibVZ5Y3lCelpXNTBJR0o1SUhSb1pTQnlaWEJ2Y25SbGNseHVJQ0FnS2lCQWNHRnlZVzBnZTNOMGNtbHVaMzBnWm1sc2RHVnlJQzBnUm1sc2RHVnlJSFJvWVhRZ2FXUmxiblJwWm1sbGN5QjBhR1VnWm1sbGJHUWdLSE5sY0dGeVlYUmxaQ0JrYjNRZ2NHRjBhQ2t1SUVGalkyVndkSE1nS2lCaGRDQjBhR1VnWlc1a0lHWnZjaUJoSUcxdmNtVWdkVzV5WlhOMGNtbGpkR1ZrSUdacGJIUmxjbWx1Wnk1Y2JpQWdJQ29nUUhCaGNtRnRJSHRtZFc1amRHbHZiaWhsZG1WdWREb2dUWE5uUlhabGJuUXBmU0JqWVd4c1ltRmphMXh1SUNBZ0tpOWNiaUFnYjI1RGFHRnVaMlVvWm1sc2RHVnlMQ0JqWVd4c1ltRmpheWtnZTF4dUlDQWdJR3hsZENCclpYa2dQU0JtYVd4MFpYSTdYRzRnSUNBZ2JHVjBJR1pwYkhSbGNrOWlhaUE5SUh0Y2JpQWdJQ0FnSUhSNWNHVTZJRVpwYkhSbGNsUjVjR1V1UlZoQlExUXNYRzRnSUNBZ0lDQmpZV3hzWW1GamF6b2dZMkZzYkdKaFkydGNiaUFnSUNCOU8xeHVYRzRnSUNBZ2JHVjBJR2xrZUNBOUlHWnBiSFJsY2k1cGJtUmxlRTltS0NjcUp5azdYRzRnSUNBZ2FXWWdLR2xrZUNBOVBUMGdabWxzZEdWeUxteGxibWQwYUNBdElERXBJSHRjYmlBZ0lDQWdJR2xtSUNocFpIZ2dQVDA5SURBcElIdGNiaUFnSUNBZ0lDQWdabWxzZEdWeVQySnFMblI1Y0dVZ1BTQkdhV3gwWlhKVWVYQmxMa0ZPV1R0Y2JpQWdJQ0FnSUgwZ1pXeHpaU0I3WEc0Z0lDQWdJQ0FnSUdacGJIUmxjazlpYWk1MGVYQmxJRDBnUm1sc2RHVnlWSGx3WlM1VFZFRlNWRHRjYmlBZ0lDQWdJQ0FnYTJWNUlEMGdabWxzZEdWeUxuTjFZbk4wY2lnd0xDQm1hV3gwWlhJdWJHVnVaM1JvSUMwZ01TazdYRzRnSUNBZ0lDQjlYRzRnSUNBZ2ZWeHVYRzRnSUNBZ2RHaHBjeTVmWm1sc2RHVnljMXRyWlhsZElEMGdabWxzZEdWeVQySnFPMXh1SUNCOVhHNWNiaUFnWDI5dVJtbHNkR1Z5S0dWMlpXNTBLU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lFOWlhbVZqZEM1clpYbHpLRjkwYUdsekxsOW1hV3gwWlhKektTNW1iM0pGWVdOb0tDaHJaWGtwSUQwK0lIdGNiaUFnSUNBZ0lHeGxkQ0JtYVd4MFpYSWdQU0JmZEdocGN5NWZabWxzZEdWeWMxdHJaWGxkTzF4dUlDQWdJQ0FnYVdZZ0tHWnBiSFJsY2k1MGVYQmxJRDA5UFNCR2FXeDBaWEpVZVhCbExrRk9XU2tnZTF4dUlDQWdJQ0FnSUNBdkwyMWhkR05vSUdGdWVYUm9hVzVuWEc0Z0lDQWdJQ0FnSUdacGJIUmxjaTVqWVd4c1ltRmpheWhsZG1WdWRDazdYRzRnSUNBZ0lDQjlJR1ZzYzJVZ2FXWWdLR1pwYkhSbGNpNTBlWEJsSUQwOVBTQkdhV3gwWlhKVWVYQmxMbE5VUVZKVUtTQjdYRzRnSUNBZ0lDQWdJQzh2YVdZZ2MzUmhjblJ6SUhkcGRHZ2dabWxzZEdWeUxpNHVYRzRnSUNBZ0lDQWdJR2xtSUNobGRtVnVkQzVtYVdWc1pDNXBibVJsZUU5bUtHdGxlU2tnUFQwOUlEQXBJSHRjYmlBZ0lDQWdJQ0FnSUNCbWFXeDBaWEl1WTJGc2JHSmhZMnNvWlhabGJuUXBPMXh1SUNBZ0lDQWdJQ0I5WEc0Z0lDQWdJQ0I5SUdWc2MyVWdhV1lnS0dacGJIUmxjaTUwZVhCbElEMDlQU0JHYVd4MFpYSlVlWEJsTGtWWVFVTlVLU0I3WEc0Z0lDQWdJQ0FnSUM4dlpYaGhZM1FnYldGMFkyaGNiaUFnSUNBZ0lDQWdhV1lnS0dWMlpXNTBMbVpwWld4a0lEMDlQU0JyWlhrcElIdGNiaUFnSUNBZ0lDQWdJQ0JtYVd4MFpYSXVZMkZzYkdKaFkyc29aWFpsYm5RcE8xeHVJQ0FnSUNBZ0lDQjlYRzRnSUNBZ0lDQjlYRzRnSUNBZ2ZTazdYRzRnSUgxY2JuMWNibHh1Wlhod2IzSjBJR1JsWm1GMWJIUWdSR0YwWVU5aWFtVmpkRTlpYzJWeWRtVnlPMXh1WEc1Y2JseHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSWdMeTljYmk4dklDNHZjM0pqTDNONWJtTm9aWEl2UkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5TG1weklpd2lMeW9xWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZCVUlFbHViM1podzZmRG8yOGdaU0JUYVhOMFpXMWhjeUJUUVZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCSlRrVlRReTFKUkZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCUlZVOUNTVk1nVGtWVVYwOVNTMU1nVTB4Y2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1JsSkJWVTVJVDBaRlVpMUhSVk5GVEV4VFEwaEJSbFFnV2xWU0lFWlBSVkpFUlZKVlRrY2dSRVZTSUVGT1IwVlhRVTVFVkVWT0lFWlBVbE5EU0ZWT1J5QkZMbFpjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVDFKQlRrZEZJRk5CWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVSbGRYUnpZMmhsSUZSbGJHVnJiMjBnUVVkY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1FYQnBlbVZsWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZSRlEwaE9TVk5EU0VVZ1ZVNUpWa1ZTVTBsVVFWUWdRa1ZTVEVsT1hHNHFYRzRxSUV4cFkyVnVjMlZrSUhWdVpHVnlJSFJvWlNCQmNHRmphR1VnVEdsalpXNXpaU3dnVm1WeWMybHZiaUF5TGpBZ0tIUm9aU0JjSWt4cFkyVnVjMlZjSWlrN1hHNHFJSGx2ZFNCdFlYa2dibTkwSUhWelpTQjBhR2x6SUdacGJHVWdaWGhqWlhCMElHbHVJR052YlhCc2FXRnVZMlVnZDJsMGFDQjBhR1VnVEdsalpXNXpaUzVjYmlvZ1dXOTFJRzFoZVNCdlluUmhhVzRnWVNCamIzQjVJRzltSUhSb1pTQk1hV05sYm5ObElHRjBYRzRxWEc0cUlDQWdhSFIwY0RvdkwzZDNkeTVoY0dGamFHVXViM0puTDJ4cFkyVnVjMlZ6TDB4SlEwVk9VMFV0TWk0d1hHNHFYRzRxSUZWdWJHVnpjeUJ5WlhGMWFYSmxaQ0JpZVNCaGNIQnNhV05oWW14bElHeGhkeUJ2Y2lCaFozSmxaV1FnZEc4Z2FXNGdkM0pwZEdsdVp5d2djMjltZEhkaGNtVmNiaW9nWkdsemRISnBZblYwWldRZ2RXNWtaWElnZEdobElFeHBZMlZ1YzJVZ2FYTWdaR2x6ZEhKcFluVjBaV1FnYjI0Z1lXNGdYQ0pCVXlCSlUxd2lJRUpCVTBsVExGeHVLaUJYU1ZSSVQxVlVJRmRCVWxKQlRsUkpSVk1nVDFJZ1EwOU9SRWxVU1U5T1V5QlBSaUJCVGxrZ1MwbE9SQ3dnWldsMGFHVnlJR1Y0Y0hKbGMzTWdiM0lnYVcxd2JHbGxaQzVjYmlvZ1UyVmxJSFJvWlNCTWFXTmxibk5sSUdadmNpQjBhR1VnYzNCbFkybG1hV01nYkdGdVozVmhaMlVnWjI5MlpYSnVhVzVuSUhCbGNtMXBjM05wYjI1eklHRnVaRnh1S2lCc2FXMXBkR0YwYVc5dWN5QjFibVJsY2lCMGFHVWdUR2xqWlc1elpTNWNiaW9xTDF4dVhHNXBiWEJ2Y25RZ1JHRjBZVTlpYW1WamRDQm1jbTl0SUNjdUwwUmhkR0ZQWW1wbFkzUW5PMXh1YVcxd2IzSjBJSHNnWkdWbGNFTnNiMjVsSUgwZ1puSnZiU0FuTGk0dmRYUnBiSE12ZFhScGJITXVhbk1uTzF4dVhHNHZLaXBjYmlBcUlGUm9aU0JqYkdGemN5QnlaWFIxY201bFpDQm1jbTl0SUhSb1pTQlRlVzVqYUdWeUlHTnlaV0YwWlNCallXeHNMbHh1SUNvZ1ZHOGdZbVVnZFhObFpDQmhjeUJoSUhKbGNHOXlkR1Z5SUhCdmFXNTBMQ0JqYUdGdVoyVnpJSGRwYkd3Z1ltVWdjM1ZpYldsMFpXUWdkRzhnUkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5SUdsdWMzUmhibU5sY3k1Y2JpQXFMMXh1WTJ4aGMzTWdSR0YwWVU5aWFtVmpkRkpsY0c5eWRHVnlJR1Y0ZEdWdVpITWdSR0YwWVU5aWFtVmpkQ0F2S2lCcGJYQnNaVzFsYm5SeklGTjVibU5UZEdGMGRYTWdLaThnZTF4dUlDQXZLaUJ3Y21sMllYUmxYRzRnSUY5emRXSnpZM0pwY0hScGIyNXpPaUE4YUhsd1pYSjBlVlZ5YkRvZ2V5QnpkR0YwZFhNNklITjBjbWx1WnlCOUlIMCtYRzVjYmlBZ0xTMHRMV1YyWlc1MElHaGhibVJzWlhKekxTMHRMVnh1SUNCZmIyNVRkV0p6WTNKcGNIUnBiMjVJWVc1a2JHVnlPaUFvWlhabGJuUXBJRDArSUhadmFXUmNiaUFnWDI5dVVtVnpjRzl1YzJWSVlXNWtiR1Z5T2lBb1pYWmxiblFwSUQwK0lIWnZhV1JjYmlBZ1gyOXVVbVZoWkVoaGJtUnNaWEk2SUNobGRtVnVkQ2tnUFQ0Z2RtOXBaRnh1SUNBcUwxeHVYRzRnSUM4cUtseHVJQ0FnS2lCQWFXZHViM0psWEc0Z0lDQXFJRk5vYjNWc1pDQnViM1FnWW1VZ2RYTmxaQ0JrYVhKbFkzUnNlU0JpZVNCSWVYQmxjblJwWlhNdUlFbDBKM01nWTJGc2JHVmtJR0o1SUhSb1pTQlRlVzVqYUdWeUxtTnlaV0YwWlNCdFpYUm9iMlJjYmlBZ0lDb3ZYRzRnSUdOdmJuTjBjblZqZEc5eUtITjVibU5vWlhJc0lIVnliQ3dnYzJOb1pXMWhMQ0JwYm1sMGFXRnNVM1JoZEhWekxDQnBibWwwYVdGc1JHRjBZU3dnWTJocGJHUnlaVzV6S1NCN1hHNGdJQ0FnYzNWd1pYSW9jM2x1WTJobGNpd2dkWEpzTENCelkyaGxiV0VzSUdsdWFYUnBZV3hUZEdGMGRYTXNJR2x1YVhScFlXeEVZWFJoTENCamFHbHNaSEpsYm5NcE8xeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQ0JmZEdocGN5NWZjM1ZpYzJOeWFYQjBhVzl1Y3lBOUlIdDlPMXh1WEc0Z0lDQWdYM1JvYVhNdVgzTjVibU5QWW1vdWIySnpaWEoyWlNnb1pYWmxiblFwSUQwK0lIdGNiaUFnSUNBZ0lHTnZibk52YkdVdWJHOW5LQ2RFWVhSaFQySnFaV04wVW1Wd2IzSjBaWEl0SnlBcklIVnliQ0FySUNjdFUwVk9SRG9nSnl3Z1pYWmxiblFwTzF4dUlDQWdJQ0FnWDNSb2FYTXVYMjl1UTJoaGJtZGxLR1YyWlc1MEtUdGNiaUFnSUNCOUtUdGNibHh1SUNBZ0lGOTBhR2x6TGw5aGJHeHZZMkYwWlV4cGMzUmxibVZ5Y3lncE8xeHVJQ0I5WEc1Y2JpQWdYMkZzYkc5allYUmxUR2x6ZEdWdVpYSnpLQ2tnZTF4dUlDQWdJSE4xY0dWeUxsOWhiR3h2WTJGMFpVeHBjM1JsYm1WeWN5Z3BPMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNCZmRHaHBjeTVmYjJKcVpXTjBUR2x6ZEdWdVpYSWdQU0JmZEdocGN5NWZZblZ6TG1Ga1pFeHBjM1JsYm1WeUtGOTBhR2x6TGw5MWNtd3NJQ2h0YzJjcElEMCtJSHRjYmlBZ0lDQWdJR052Ym5OdmJHVXViRzluS0NkRVlYUmhUMkpxWldOMExTY2dLeUJmZEdocGN5NWZkWEpzSUNzZ0p5MVNRMVk2SUNjc0lHMXpaeWs3WEc0Z0lDQWdJQ0J6ZDJsMFkyZ2dLRzF6Wnk1MGVYQmxLU0I3WEc0Z0lDQWdJQ0FnSUdOaGMyVWdKM0psYzNCdmJuTmxKem9nWDNSb2FYTXVYMjl1VW1WemNHOXVjMlVvYlhObktUc2dZbkpsWVdzN1hHNGdJQ0FnSUNBZ0lHTmhjMlVnSjNKbFlXUW5PaUJmZEdocGN5NWZiMjVTWldGa0tHMXpaeWs3SUdKeVpXRnJPMXh1SUNBZ0lDQWdmVnh1SUNBZ0lIMHBPMXh1SUNCOVhHNWNiaUFnWDNKbGJHVmhjMlZNYVhOMFpXNWxjbk1vS1NCN1hHNGdJQ0FnYzNWd1pYSXVYM0psYkdWaGMyVk1hWE4wWlc1bGNuTW9LVHRjYmlBZ0lDQnNaWFFnWDNSb2FYTWdQU0IwYUdsek8xeHVYRzRnSUNBZ1gzUm9hWE11WDI5aWFtVmpkRXhwYzNSbGJtVnlMbkpsYlc5MlpTZ3BPMXh1SUNCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUZObGJtUWdhVzUyYVhSaGRHbHZibk1nS0dOeVpXRjBaU0J0WlhOellXZGxjeWtnZEc4Z2FIbHdaWEowYVdWekxDQnZZbk5sY25abGNuTWdiR2x6ZEM1Y2JpQWdJQ29nUUhCaGNtRnRJQ0I3U0hsd1pYSjBlVlZTVEZ0ZGZTQnZZbk5sY25abGNuTWdUR2x6ZENCdlppQkllWEJsY25SNUlGVlNUQ2R6WEc0Z0lDQXFMMXh1SUNCcGJuWnBkR1ZQWW5ObGNuWmxjbk1vYjJKelpYSjJaWEp6S1NCN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmx4dUlDQWdJQzh2Umt4UFZ5MVBWVlE2SUhSb2FYTWdiV1Z6YzJGblpTQjNhV3hzSUdKbElITmxiblFnZEc4Z2RHaGxJSEoxYm5ScGJXVWdhVzV6ZEdGdVkyVWdiMllnVTNsdVkyaGxjazFoYm1GblpYSWdMVDRnWDI5dVEzSmxZWFJsWEc0Z0lDQWdiR1YwSUdsdWRtbDBaVTF6WnlBOUlIdGNiaUFnSUNBZ0lIUjVjR1U2SUNkamNtVmhkR1VuTENCbWNtOXRPaUJmZEdocGN5NWZjM2x1WTJobGNpNWZiM2R1WlhJc0lIUnZPaUJmZEdocGN5NWZjM2x1WTJobGNpNWZjM1ZpVlZKTUxGeHVJQ0FnSUNBZ1ltOWtlVG9nZXlCeVpYTjFiV1U2SUdaaGJITmxMQ0J5WlhOdmRYSmpaVG9nWDNSb2FYTXVYM1Z5YkN3Z2MyTm9aVzFoT2lCZmRHaHBjeTVmYzJOb1pXMWhMQ0IyWVd4MVpUb2dYM1JvYVhNdVgzTjVibU5QWW1vdVpHRjBZU3dnWVhWMGFHOXlhWE5sT2lCdlluTmxjblpsY25NZ2ZWeHVJQ0FnSUgwN1hHNWNiaUFnSUNCZmRHaHBjeTVmWW5WekxuQnZjM1JOWlhOellXZGxLR2x1ZG1sMFpVMXpaeWs3WEc0Z0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1VtVnNaV0Z6WlNCaGJtUWdaR1ZzWlhSbElHOWlhbVZqZENCa1lYUmhYRzRnSUNBcUwxeHVJQ0JrWld4bGRHVW9LU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lDOHZSa3hQVnkxUFZWUTZJSFJvYVhNZ2JXVnpjMkZuWlNCM2FXeHNJR0psSUhObGJuUWdkRzhnZEdobElISjFiblJwYldVZ2FXNXpkR0Z1WTJVZ2IyWWdVM2x1WTJobGNrMWhibUZuWlhJZ0xUNGdYMjl1UkdWc1pYUmxYRzRnSUNBZ2JHVjBJR1JsYkdWMFpVMXpaeUE5SUh0Y2JpQWdJQ0FnSUhSNWNHVTZJQ2RrWld4bGRHVW5MQ0JtY205dE9pQmZkR2hwY3k1ZmIzZHVaWElzSUhSdk9pQmZkR2hwY3k1ZmMzbHVZMmhsY2k1ZmMzVmlWVkpNTEZ4dUlDQWdJQ0FnWW05a2VUb2dleUJ5WlhOdmRYSmpaVG9nWDNSb2FYTXVYM1Z5YkNCOVhHNGdJQ0FnZlR0Y2JseHVJQ0FnSUY5MGFHbHpMbDlpZFhNdWNHOXpkRTFsYzNOaFoyVW9aR1ZzWlhSbFRYTm5MQ0FvY21Wd2JIa3BJRDArSUh0Y2JpQWdJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZEVZWFJoVDJKcVpXTjBVbVZ3YjNKMFpYSXRSRVZNUlZSRk9pQW5MQ0J5WlhCc2VTazdYRzRnSUNBZ0lDQnBaaUFvY21Wd2JIa3VZbTlrZVM1amIyUmxJRDA5UFNBeU1EQXBJSHRjYmlBZ0lDQWdJQ0FnWDNSb2FYTXVYM0psYkdWaGMyVk1hWE4wWlc1bGNuTW9LVHRjYmlBZ0lDQWdJQ0FnWkdWc1pYUmxJRjkwYUdsekxsOXplVzVqYUdWeUxsOXlaWEJ2Y25SbGNuTmJYM1JvYVhNdVgzVnliRjA3WEc0Z0lDQWdJQ0I5WEc0Z0lDQWdmU2s3WEc0Z0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1UzVmljMk55YVhCMGFXOXVjeUJ5WlhGMVpYTjBaV1FnWVc1a0lHRmpZMlZ3ZEdWa0lIUnZJSFJvYVhNZ2NtVndiM0owWlhKY2JpQWdJQ29nUUhSNWNHVWdlMDlpYW1WamREeEllWEJsY25SNVZWSk1MQ0JUZVc1alUzVmljMk55YVhCMGFXOXVQbjFjYmlBZ0lDb3ZYRzRnSUdkbGRDQnpkV0p6WTNKcGNIUnBiMjV6S0NrZ2V5QnlaWFIxY200Z2RHaHBjeTVmYzNWaWMyTnlhWEIwYVc5dWN6c2dmVnh1WEc0Z0lDOHFLbHh1SUNBZ0tpQlRaWFIxY0NCMGFHVWdZMkZzYkdKaFkyc2dkRzhnY0hKdlkyVnpjeUJ6ZFdKelkzSnBZbVVnWVc1a0lIVnVjM1ZpYzJOeWFXSmxJRzV2ZEdsbWFXTmhkR2x2Ym5OY2JpQWdJQ29nUUhCaGNtRnRJSHRtZFc1amRHbHZiaWhsZG1WdWREb2dUWE5uUlhabGJuUXBmU0JqWVd4c1ltRmpheUJtZFc1amRHbHZiaUIwYnlCeVpXTmxhWFpsSUdWMlpXNTBjMXh1SUNBZ0tpOWNiaUFnYjI1VGRXSnpZM0pwY0hScGIyNG9ZMkZzYkdKaFkyc3BJSHRjYmlBZ0lDQjBhR2x6TGw5dmJsTjFZbk5qY21sd2RHbHZia2hoYm1Sc1pYSWdQU0JqWVd4c1ltRmphenRjYmlBZ2ZWeHVYRzRnSUM4cUtseHVJQ0FnS2lCVFpYUjFjQ0IwYUdVZ1kyRnNiR0poWTJzZ2RHOGdjSEp2WTJWemN5QnlaWE53YjI1elpTQnViM1JwWm1sallYUnBiMjV6SUc5bUlIUm9aU0JqY21WaGRHVW5jMXh1SUNBZ0tpQkFjR0Z5WVcwZ2UyWjFibU4wYVc5dUtHVjJaVzUwT2lCTmMyZEZkbVZ1ZENsOUlHTmhiR3hpWVdOcklHWjFibU4wYVc5dUlIUnZJSEpsWTJWcGRtVWdaWFpsYm5SelhHNGdJQ0FxTDF4dUlDQnZibEpsYzNCdmJuTmxLR05oYkd4aVlXTnJLU0I3WEc0Z0lDQWdkR2hwY3k1ZmIyNVNaWE53YjI1elpVaGhibVJzWlhJZ1BTQmpZV3hzWW1GamF6dGNiaUFnZlZ4dVhHNGdJQzhxS2x4dUlDQWdLaUJUWlhSMWNDQjBhR1VnWTJGc2JHSmhZMnNnZEc4Z2NISnZZMlZ6Y3lCeVpXRmtJRzV2ZEdsbWFXTmhkR2x2Ym5OY2JpQWdJQ29nUUhCaGNtRnRJSHRtZFc1amRHbHZiaWhsZG1WdWREb2dUWE5uUlhabGJuUXBmU0JqWVd4c1ltRmphMXh1SUNBZ0tpOWNiaUFnYjI1U1pXRmtLR05oYkd4aVlXTnJLU0I3WEc0Z0lDQWdkR2hwY3k1ZmIyNVNaV0ZrU0dGdVpHeGxjaUE5SUdOaGJHeGlZV05yTzF4dUlDQjlYRzVjYmlBZ0x5OUdURTlYTFVsT09pQnRaWE56WVdkbElISmxZMlZwZG1Wa0lHWnliMjBnY0dGeVpXNTBJRk41Ym1Ob1pYSWdMVDRnWDI5dVJtOXlkMkZ5WkZ4dUlDQmZiMjVHYjNKM1lYSmtLRzF6WnlrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQ0JqYjI1emIyeGxMbXh2WnlnblJHRjBZVTlpYW1WamRGSmxjRzl5ZEdWeUxWSkRWam9nSnl3Z2JYTm5LVHRjYmlBZ0lDQnpkMmwwWTJnZ0tHMXpaeTVpYjJSNUxuUjVjR1VwSUh0Y2JpQWdJQ0FnSUdOaGMyVWdKM04xWW5OamNtbGlaU2M2SUY5MGFHbHpMbDl2YmxOMVluTmpjbWxpWlNodGMyY3BPeUJpY21WaGF6dGNiaUFnSUNBZ0lHTmhjMlVnSjNWdWMzVmljMk55YVdKbEp6b2dYM1JvYVhNdVgyOXVWVzVUZFdKelkzSnBZbVVvYlhObktUc2dZbkpsWVdzN1hHNGdJQ0FnZlZ4dUlDQjlYRzVjYmlBZ0x5OUdURTlYTFVsT09pQnRaWE56WVdkbElISmxZMlZwZG1Wa0lHWnliMjBnZEdocGN5QXRQaUJmYjI1R2IzSjNZWEprT2lCbGJXbDBkR1ZrSUdKNUlHRWdjbVZ0YjNSbElGTjVibU5vWlhJZ0xUNGdjM1ZpYzJOeWFXSmxYRzRnSUY5dmJsTjFZbk5qY21saVpTaHRjMmNwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1SUNBZ0lHeGxkQ0JvZVhCbGNuUjVWWEpzSUQwZ2JYTm5MbUp2WkhrdVpuSnZiVHRjYmlBZ0lDQmpiMjV6YjJ4bExteHZaeWduVzBSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2k1ZmIyNVRkV0p6WTNKcFltVmRKeXdnYlhObktUdGNibHh1SUNBZ0lHeGxkQ0JsZG1WdWRDQTlJSHRjYmlBZ0lDQWdJSFI1Y0dVNklHMXpaeTVpYjJSNUxuUjVjR1VzWEc0Z0lDQWdJQ0IxY213NklHaDVjR1Z5ZEhsVmNtd3NYRzVjYmlBZ0lDQWdJR2xrWlc1MGFYUjVPaUJ0YzJjdVltOWtlUzVwWkdWdWRHbDBlU3hjYmx4dUlDQWdJQ0FnWVdOalpYQjBPaUFvS1NBOVBpQjdYRzRnSUNBZ0lDQWdJQzh2WTNKbFlYUmxJRzVsZHlCemRXSnpZM0pwY0hScGIyNWNiaUFnSUNBZ0lDQWdiR1YwSUhOMVlpQTlJSHNnZFhKc09pQm9lWEJsY25SNVZYSnNMQ0J6ZEdGMGRYTTZJQ2R2YmljZ2ZUdGNiaUFnSUNBZ0lDQWdYM1JvYVhNdVgzTjFZbk5qY21sd2RHbHZibk5iYUhsd1pYSjBlVlZ5YkYwZ1BTQnpkV0k3WEc1Y2JpQWdJQ0FnSUNBZ0x5OXdjbTlqWlhOeklHRnVaQ0J6Wlc1a0lHTm9hV3hrY21WdWN5QmtZWFJoWEc0Z0lDQWdJQ0FnSUd4bGRDQmphR2xzWkhKbGJsWmhiSFZsY3lBOUlIdDlPMXh1SUNBZ0lDQWdJQ0JQWW1wbFkzUXVhMlY1Y3loZmRHaHBjeTVmWTJocGJHUnlaVzVQWW1wbFkzUnpLUzVtYjNKRllXTm9LQ2hqYUdsc1pFbGtLU0E5UGlCN1hHNGdJQ0FnSUNBZ0lDQWdiR1YwSUdOb2FXeGtSR0YwWVNBOUlGOTBhR2x6TGw5amFHbHNaSEpsYms5aWFtVmpkSE5iWTJocGJHUkpaRjB1WkdGMFlUdGNiaUFnSUNBZ0lDQWdJQ0JqYUdsc1pISmxibFpoYkhWbGMxdGphR2xzWkVsa1hTQTlJR1JsWlhCRGJHOXVaU2hqYUdsc1pFUmhkR0VwTzF4dUlDQWdJQ0FnSUNCOUtUdGNibHh1SUNBZ0lDQWdJQ0JzWlhRZ2MyVnVaRTF6WnlBOUlIdGNiaUFnSUNBZ0lDQWdJQ0JwWkRvZ2JYTm5MbWxrTENCMGVYQmxPaUFuY21WemNHOXVjMlVuTENCbWNtOXRPaUJ0YzJjdWRHOHNJSFJ2T2lCdGMyY3Vabkp2YlN4Y2JpQWdJQ0FnSUNBZ0lDQmliMlI1T2lCN0lHTnZaR1U2SURJd01Dd2djMk5vWlcxaE9pQmZkR2hwY3k1ZmMyTm9aVzFoTENCMlpYSnphVzl1T2lCZmRHaHBjeTVmZG1WeWMybHZiaXdnZG1Gc2RXVTZJSHNnWkdGMFlUb2daR1ZsY0VOc2IyNWxLRjkwYUdsekxtUmhkR0VwTENCamFHbHNaSEpsYm5NNklHTm9hV3hrY21WdVZtRnNkV1Z6SUgwZ2ZWeHVJQ0FnSUNBZ0lDQjlPMXh1WEc0Z0lDQWdJQ0FnSUM4dlZFOUVUem9nUm05eUlFWjFjblJvWlhJZ1UzUjFaSGxjYmlBZ0lDQWdJQ0FnYVdZZ0tHMXpaeTVpYjJSNUxtaGhjMDkzYmxCeWIzQmxjblI1S0NkdGRYUjFZV3hCZFhSb1pXNTBhV05oZEdsdmJpY3BJQ1ltSUNGdGMyY3VZbTlrZVM1dGRYUjFZV3hCZFhSb1pXNTBhV05oZEdsdmJpa2dlMXh1SUNBZ0lDQWdJQ0FnSUhObGJtUk5jMmN1WW05a2VTNXRkWFIxWVd4QmRYUm9aVzUwYVdOaGRHbHZiaUE5SUhSb2FYTXVYMjExZEhWaGJFRjFkR2hsYm5ScFkyRjBhVzl1TzF4dUlDQWdJQ0FnSUNBZ0lIUm9hWE11WDIxMWRIVmhiRUYxZEdobGJuUnBZMkYwYVc5dUlEMGdiWE5uTG1KdlpIa3ViWFYwZFdGc1FYVjBhR1Z1ZEdsallYUnBiMjQ3WEc0Z0lDQWdJQ0FnSUgxY2JseHVJQ0FnSUNBZ0lDQXZMM05sYm1RZ2Iyc2djbVZ6Y0c5dWMyVWdiV1Z6YzJGblpWeHVJQ0FnSUNBZ0lDQmZkR2hwY3k1ZlluVnpMbkJ2YzNSTlpYTnpZV2RsS0hObGJtUk5jMmNwTzF4dVhHNGdJQ0FnSUNBZ0lISmxkSFZ5YmlCemRXSTdYRzRnSUNBZ0lDQjlMRnh1WEc0Z0lDQWdJQ0J5WldwbFkzUTZJQ2h5WldGemIyNHBJRDArSUh0Y2JpQWdJQ0FnSUNBZ0x5OXpaVzVrSUhKbGFtVmpkQ0J5WlhOd2IyNXpaU0J0WlhOellXZGxYRzRnSUNBZ0lDQWdJRjkwYUdsekxsOWlkWE11Y0c5emRFMWxjM05oWjJVb2UxeHVJQ0FnSUNBZ0lDQWdJR2xrT2lCdGMyY3VhV1FzSUhSNWNHVTZJQ2R5WlhOd2IyNXpaU2NzSUdaeWIyMDZJRzF6Wnk1MGJ5d2dkRzg2SUcxelp5NW1jbTl0TEZ4dUlDQWdJQ0FnSUNBZ0lHSnZaSGs2SUhzZ1kyOWtaVG9nTkRBekxDQmtaWE5qT2lCeVpXRnpiMjRnZlZ4dUlDQWdJQ0FnSUNCOUtUdGNiaUFnSUNBZ0lIMWNiaUFnSUNCOU8xeHVYRzRnSUNBZ2FXWWdLRjkwYUdsekxsOXZibE4xWW5OamNtbHdkR2x2YmtoaGJtUnNaWElwSUh0Y2JpQWdJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZFRWVUpUUTFKSlVGUkpUMDR0UlZaRlRsUTZJQ2NzSUdWMlpXNTBLVHRjYmlBZ0lDQWdJRjkwYUdsekxsOXZibE4xWW5OamNtbHdkR2x2YmtoaGJtUnNaWElvWlhabGJuUXBPMXh1SUNBZ0lIMWNiaUFnZlZ4dVhHNGdJQzh2Umt4UFZ5MUpUam9nYldWemMyRm5aU0J5WldObGFYWmxaQ0JtY205dElIUm9hWE1nTFQ0Z1gyOXVSbTl5ZDJGeVpEb2daVzFwZEhSbFpDQmllU0JoSUhKbGJXOTBaU0JFWVhSaFQySnFaV04wVDJKelpYSjJaWElnTFQ0Z2RXNXpkV0p6WTNKcFltVmNiaUFnWDI5dVZXNVRkV0p6WTNKcFltVW9iWE5uS1NCN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmlBZ0lDQnNaWFFnYUhsd1pYSjBlVlZ5YkNBOUlHMXpaeTVpYjJSNUxtWnliMjA3WEc1Y2JpQWdJQ0JzWlhRZ2MzVmlJRDBnWDNSb2FYTXVYM04xWW5OamNtbHdkR2x2Ym5OYmFIbHdaWEowZVZWeWJGMDdYRzRnSUNBZ1pHVnNaWFJsSUY5MGFHbHpMbDl6ZFdKelkzSnBjSFJwYjI1elcyaDVjR1Z5ZEhsVmNteGRPMXh1WEc0Z0lDQWdiR1YwSUdWMlpXNTBJRDBnZTF4dUlDQWdJQ0FnZEhsd1pUb2diWE5uTG1KdlpIa3VkSGx3WlN4Y2JpQWdJQ0FnSUhWeWJEb2dhSGx3WlhKMGVWVnliQ3hjYmlBZ0lDQWdJRzlpYW1WamREb2djM1ZpWEc0Z0lDQWdmVHRjYmx4dUlDQWdJR2xtSUNoZmRHaHBjeTVmYjI1VGRXSnpZM0pwY0hScGIyNUlZVzVrYkdWeUtTQjdYRzRnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVlU0dFUxVkNVME5TU1ZCVVNVOU9MVVZXUlU1VU9pQW5MQ0JsZG1WdWRDazdYRzRnSUNBZ0lDQmZkR2hwY3k1ZmIyNVRkV0p6WTNKcGNIUnBiMjVJWVc1a2JHVnlLR1YyWlc1MEtUdGNiaUFnSUNCOVhHNGdJSDFjYmx4dUlDQXZMMFpNVDFjdFNVNDZJRzFsYzNOaFoyVWdjbVZqWldsMlpXUWdabkp2YlNCU1pYQnZjblJsY2xWU1RDQmhaR1J5WlhOek9pQmxiV2wwWldRZ1lua2dZU0J5WlcxdmRHVWdVM2x1WTJobGNpQXRQaUJmYjI1U1pXMXZkR1ZEY21WaGRHVWdMVDRnWlhabGJuUXVZV05yWEc0Z0lGOXZibEpsYzNCdmJuTmxLRzF6WnlrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQ0JzWlhRZ1pYWmxiblFnUFNCN1hHNGdJQ0FnSUNCMGVYQmxPaUJ0YzJjdWRIbHdaU3hjYmlBZ0lDQWdJSFZ5YkRvZ2JYTm5MbVp5YjIwc1hHNGdJQ0FnSUNCamIyUmxPaUJ0YzJjdVltOWtlUzVqYjJSbFhHNGdJQ0FnZlR0Y2JseHVJQ0FnSUdsbUlDaGZkR2hwY3k1ZmIyNVNaWE53YjI1elpVaGhibVJzWlhJcElIdGNiaUFnSUNBZ0lHTnZibk52YkdVdWJHOW5LQ2RTUlZOUVQwNVRSUzFGVmtWT1ZEb2dKeXdnWlhabGJuUXBPMXh1SUNBZ0lDQWdYM1JvYVhNdVgyOXVVbVZ6Y0c5dWMyVklZVzVrYkdWeUtHVjJaVzUwS1R0Y2JpQWdJQ0I5WEc0Z0lIMWNibHh1SUNBdkwwWk1UMWN0U1U0NklHMWxjM05oWjJVZ2NtVmpaV2wyWldRZ1puSnZiU0JTWlhCdmNuUmxjbFZTVENCaFpHUnlaWE56T2lCbGJXbDBaV1FnWW5rZ1lTQnlaVzF2ZEdVZ1UzbHVZMmhsY2lBdFBpQnlaV0ZrWEc0Z0lGOXZibEpsWVdRb2JYTm5LU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lHeGxkQ0JsZG1WdWRDQTlJSHRjYmlBZ0lDQWdJSFI1Y0dVNklHMXpaeTUwZVhCbExGeHVJQ0FnSUNBZ2RYSnNPaUJ0YzJjdVpuSnZiU3hjYmx4dUlDQWdJQ0FnWVdOalpYQjBPaUFvS1NBOVBpQjdYRzRnSUNBZ0lDQWdJRjkwYUdsekxsOWlkWE11Y0c5emRFMWxjM05oWjJVb2UxeHVJQ0FnSUNBZ0lDQWdJR2xrT2lCdGMyY3VhV1FzSUhSNWNHVTZJQ2R5WlhOd2IyNXpaU2NzSUdaeWIyMDZJRzF6Wnk1MGJ5d2dkRzg2SUcxelp5NW1jbTl0TEZ4dUlDQWdJQ0FnSUNBZ0lHSnZaSGs2SUhzZ1kyOWtaVG9nTWpBd0xDQjJZV3gxWlRvZ1pHVmxjRU5zYjI1bEtGOTBhR2x6TG1SaGRHRXBJSDFjYmlBZ0lDQWdJQ0FnZlNrN1hHNGdJQ0FnSUNCOUxGeHVYRzRnSUNBZ0lDQnlaV3BsWTNRNklDaHlaV0Z6YjI0cElEMCtJSHRjYmlBZ0lDQWdJQ0FnWDNSb2FYTXVYMkoxY3k1d2IzTjBUV1Z6YzJGblpTaDdYRzRnSUNBZ0lDQWdJQ0FnYVdRNklHMXpaeTVwWkN3Z2RIbHdaVG9nSjNKbGMzQnZibk5sSnl3Z1puSnZiVG9nYlhObkxuUnZMQ0IwYnpvZ2JYTm5MbVp5YjIwc1hHNGdJQ0FnSUNBZ0lDQWdZbTlrZVRvZ2V5QmpiMlJsT2lBME1ERXNJR1JsYzJNNklISmxZWE52YmlCOVhHNGdJQ0FnSUNBZ0lIMHBPMXh1SUNBZ0lDQWdmVnh1SUNBZ0lIMDdYRzVjYmlBZ0lDQnBaaUFvWDNSb2FYTXVYMjl1VW1WaFpFaGhibVJzWlhJcElIdGNiaUFnSUNBZ0lHTnZibk52YkdVdWJHOW5LQ2RTUlVGRUxVVldSVTVVT2lBbkxDQmxkbVZ1ZENrN1hHNGdJQ0FnSUNCZmRHaHBjeTVmYjI1U1pXRmtTR0Z1Wkd4bGNpaGxkbVZ1ZENrN1hHNGdJQ0FnZlZ4dUlDQjlYRzVjYm4xY2JseHVaWGh3YjNKMElHUmxabUYxYkhRZ1JHRjBZVTlpYW1WamRGSmxjRzl5ZEdWeU8xeHVYRzVjYmx4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZJZ0x5OWNiaTh2SUM0dmMzSmpMM041Ym1Ob1pYSXZSR0YwWVU5aWFtVmpkRkpsY0c5eWRHVnlMbXB6SWl3aUx5b3FYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRkJVSUVsdWIzWmh3NmZEbzI4Z1pTQlRhWE4wWlcxaGN5QlRRVnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJKVGtWVFF5MUpSRnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJSVlU5Q1NWTWdUa1ZVVjA5U1MxTWdVMHhjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnUmxKQlZVNUlUMFpGVWkxSFJWTkZURXhUUTBoQlJsUWdXbFZTSUVaUFJWSkVSVkpWVGtjZ1JFVlNJRUZPUjBWWFFVNUVWRVZPSUVaUFVsTkRTRlZPUnlCRkxsWmNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdUMUpCVGtkRklGTkJYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRVJsZFhSelkyaGxJRlJsYkdWcmIyMGdRVWRjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnUVhCcGVtVmxYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRlJGUTBoT1NWTkRTRVVnVlU1SlZrVlNVMGxVUVZRZ1FrVlNURWxPWEc0cVhHNHFJRXhwWTJWdWMyVmtJSFZ1WkdWeUlIUm9aU0JCY0dGamFHVWdUR2xqWlc1elpTd2dWbVZ5YzJsdmJpQXlMakFnS0hSb1pTQmNJa3hwWTJWdWMyVmNJaWs3WEc0cUlIbHZkU0J0WVhrZ2JtOTBJSFZ6WlNCMGFHbHpJR1pwYkdVZ1pYaGpaWEIwSUdsdUlHTnZiWEJzYVdGdVkyVWdkMmwwYUNCMGFHVWdUR2xqWlc1elpTNWNiaW9nV1c5MUlHMWhlU0J2WW5SaGFXNGdZU0JqYjNCNUlHOW1JSFJvWlNCTWFXTmxibk5sSUdGMFhHNHFYRzRxSUNBZ2FIUjBjRG92TDNkM2R5NWhjR0ZqYUdVdWIzSm5MMnhwWTJWdWMyVnpMMHhKUTBWT1UwVXRNaTR3WEc0cVhHNHFJRlZ1YkdWemN5QnlaWEYxYVhKbFpDQmllU0JoY0hCc2FXTmhZbXhsSUd4aGR5QnZjaUJoWjNKbFpXUWdkRzhnYVc0Z2QzSnBkR2x1Wnl3Z2MyOW1kSGRoY21WY2Jpb2daR2x6ZEhKcFluVjBaV1FnZFc1a1pYSWdkR2hsSUV4cFkyVnVjMlVnYVhNZ1pHbHpkSEpwWW5WMFpXUWdiMjRnWVc0Z1hDSkJVeUJKVTF3aUlFSkJVMGxUTEZ4dUtpQlhTVlJJVDFWVUlGZEJVbEpCVGxSSlJWTWdUMUlnUTA5T1JFbFVTVTlPVXlCUFJpQkJUbGtnUzBsT1JDd2daV2wwYUdWeUlHVjRjSEpsYzNNZ2IzSWdhVzF3YkdsbFpDNWNiaW9nVTJWbElIUm9aU0JNYVdObGJuTmxJR1p2Y2lCMGFHVWdjM0JsWTJsbWFXTWdiR0Z1WjNWaFoyVWdaMjkyWlhKdWFXNW5JSEJsY20xcGMzTnBiMjV6SUdGdVpGeHVLaUJzYVcxcGRHRjBhVzl1Y3lCMWJtUmxjaUIwYUdVZ1RHbGpaVzV6WlM1Y2Jpb3FMMXh1WEc1cGJYQnZjblFnVTNsdVkwOWlhbVZqZEN3Z2UwTm9ZVzVuWlZSNWNHVXNJRTlpYW1WamRGUjVjR1Y5SUdaeWIyMGdKeTR2VUhKdmVIbFBZbXBsWTNRbk8xeHVhVzF3YjNKMElFUmhkR0ZQWW1wbFkzUkRhR2xzWkNCbWNtOXRJQ2N1TDBSaGRHRlBZbXBsWTNSRGFHbHNaQ2M3WEc1cGJYQnZjblFnZTJSbFpYQkRiRzl1WlgwZ1puSnZiU0FuTGk0dmRYUnBiSE12ZFhScGJITXVhbk1uTzF4dVhHNHZLaXBjYmlBcUlFMWhhVzRnWlhoMFpXNXphVzl1SUdOc1lYTnpJR1p2Y2lCdlluTmxjblpsY25NZ1lXNWtJSEpsY0c5eWRHVnljeXdnZDJsMGFDQmpiMjF0YjI0Z2NISnZjR1Z5ZEdsbGN5QmhibVFnYldWMGFHOWtjeTVjYmlBcUlFTm9hV3hrY21WdUlHMWhibUZuWlcxbGJuUWdhWE1nWTI5dGJXOXVJR1p2Y2lCdlluTmxjblpsY25NZ1lXNWtJSEpsY0c5eWRHVnljeTVjYmlBcUwxeHVZMnhoYzNNZ1JHRjBZVTlpYW1WamRDQjdYRzRnSUM4cUlIQnlhWFpoZEdWY2JpQWdYM1psY25OcGIyNDZJRzUxYldKbGNseHVYRzRnSUY5dmQyNWxjam9nU0hsd1pYSjBlVlZTVEZ4dUlDQmZkWEpzT2lCUFltcGxZM1JWVWt4Y2JpQWdYM05qYUdWdFlUb2dVMk5vWlcxaFhHNGdJRjlpZFhNNklFMXBibWxDZFhOY2JpQWdYM04wWVhSMWN6b2diMjRnZkNCd1lYVnpaV1JjYmlBZ1gzTjVibU5QWW1vNklGTjVibU5FWVhSaFhHNWNiaUFnWDJOb2FXeGtjbVZ1T2lCN0lHbGtPaUJFWVhSaFQySnFaV04wUTJocGJHUWdmVnh1SUNCZlkyaHBiR1J5Wlc1TWFYTjBaVzVsY25NNklGdE5jMmRNYVhOMFpXNWxjbDFjYmx4dUlDQXRMUzB0WlhabGJuUWdhR0Z1Wkd4bGNuTXRMUzB0WEc0Z0lGOXZia0ZrWkVOb2FXeGtTR0Z1Wkd4bGNqb2dLR1YyWlc1MEtTQTlQaUIyYjJsa1hHNGdJQ292WEc1Y2JpQWdMeW9xWEc0Z0lDQXFJRUJwWjI1dmNtVmNiaUFnSUNvZ1UyaHZkV3hrSUc1dmRDQmlaU0IxYzJWa0lHUnBjbVZqZEd4NUlHSjVJRWg1Y0dWeWRHbGxjeTRnU1hRbmN5QmpZV3hzWldRZ1lua2dkR2hsSUZONWJtTm9aWElnWTNKbFlYUmxJRzl5SUhOMVluTmpjbWxpWlNCdFpYUm9iMlFuYzF4dUlDQWdLaTljYmlBZ1kyOXVjM1J5ZFdOMGIzSW9jM2x1WTJobGNpd2dkWEpzTENCelkyaGxiV0VzSUdsdWFYUnBZV3hUZEdGMGRYTXNJR2x1YVhScFlXeEVZWFJoTENCamFHbHNaSEpsYm5Nc0lHMTFkSFZoYkNBOUlIUnlkV1VwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdYM1JvYVhNdVgzTjVibU5vWlhJZ1BTQnplVzVqYUdWeU8xeHVJQ0FnSUY5MGFHbHpMbDkxY213Z1BTQjFjbXc3WEc0Z0lDQWdYM1JvYVhNdVgzTmphR1Z0WVNBOUlITmphR1Z0WVR0Y2JpQWdJQ0JmZEdocGN5NWZjM1JoZEhWeklEMGdhVzVwZEdsaGJGTjBZWFIxY3p0Y2JpQWdJQ0JmZEdocGN5NWZjM2x1WTA5aWFpQTlJRzVsZHlCVGVXNWpUMkpxWldOMEtHbHVhWFJwWVd4RVlYUmhLVHRjYmlBZ0lDQmZkR2hwY3k1ZlkyaHBiR1J5Wlc1eklEMGdZMmhwYkdSeVpXNXpPMXh1WEc0Z0lDQWdMeTlVVDBSUE9pQkdiM0lnUm5WeWRHaGxjaUJUZEhWa2VWeHVJQ0FnSUY5MGFHbHpMbDl0ZFhSMVlXeEJkWFJvWlc1MGFXTmhkR2x2YmlBOUlHMTFkSFZoYkR0Y2JseHVJQ0FnSUY5MGFHbHpMbDkyWlhKemFXOXVJRDBnTUR0Y2JpQWdJQ0JmZEdocGN5NWZZMmhwYkdSSlpDQTlJREE3WEc0Z0lDQWdYM1JvYVhNdVgyTm9hV3hrY21WdVQySnFaV04wY3lBOUlIdDlPMXh1SUNBZ0lGOTBhR2x6TGw5amFHbHNaSEpsYmt4cGMzUmxibVZ5Y3lBOUlGdGRPMXh1WEc0Z0lDQWdYM1JvYVhNdVgyOTNibVZ5SUQwZ2MzbHVZMmhsY2k1ZmIzZHVaWEk3WEc0Z0lDQWdYM1JvYVhNdVgySjFjeUE5SUhONWJtTm9aWEl1WDJKMWN6dGNiaUFnZlZ4dVhHNGdJRjloYkd4dlkyRjBaVXhwYzNSbGJtVnljeWdwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdiR1YwSUdOb2FXeGtRbUZ6WlZWU1RDQTlJRjkwYUdsekxsOTFjbXdnS3lBbkwyTm9hV3hrY21WdUx5YzdYRzRnSUNBZ1kyOXVjMjlzWlM1c2IyY29KMXRFWVhSaElFOWlhbVZqZENBdElFRnNiRzlqWVhSbFRHbHpkR1Z1WlhKelhTQXRJQ2NzSUY5MGFHbHpMbDlqYUdsc1pISmxibk1wTzF4dUlDQWdJR2xtSUNoZmRHaHBjeTVmWTJocGJHUnlaVzV6S1NCN1hHNGdJQ0FnSUNCZmRHaHBjeTVmWTJocGJHUnlaVzV6TG1admNrVmhZMmdvS0dOb2FXeGtLU0E5UGlCN1hHNGdJQ0FnSUNBZ0lHeGxkQ0JqYUdsc1pGVlNUQ0E5SUdOb2FXeGtRbUZ6WlZWU1RDQXJJR05vYVd4a08xeHVJQ0FnSUNBZ0lDQnNaWFFnYkdsemRHVnVaWElnUFNCZmRHaHBjeTVmWW5WekxtRmtaRXhwYzNSbGJtVnlLR05vYVd4a1ZWSk1MQ0FvYlhObktTQTlQaUI3WEc0Z0lDQWdJQ0FnSUNBZ0x5OXBaMjV2Y21VZ2JYTm5JSE5sYm5RZ1lua2dhR2x0YzJWc1pseHVJQ0FnSUNBZ0lDQWdJR2xtSUNodGMyY3Vabkp2YlNBaFBUMGdkR2hwY3k1ZmIzZHVaWElwSUh0Y2JpQWdJQ0FnSUNBZ0lDQWdJR052Ym5OdmJHVXViRzluS0NkRVlYUmhUMkpxWldOMExVTm9hV3hrY21WdUxWSkRWam9nSnl3Z2JYTm5LVHRjYmlBZ0lDQWdJQ0FnSUNBZ0lITjNhWFJqYUNBb2JYTm5MblI1Y0dVcElIdGNiaUFnSUNBZ0lDQWdJQ0FnSUNBZ1kyRnpaU0FuWTNKbFlYUmxKem9nWDNSb2FYTXVYMjl1UTJocGJHUkRjbVZoZEdVb2JYTm5LVHNnWW5KbFlXczdYRzRnSUNBZ0lDQWdJQ0FnSUNBZ0lHTmhjMlVnSjJSbGJHVjBaU2M2SUdOdmJuTnZiR1V1Ykc5bktHMXpaeWs3SUdKeVpXRnJPMXh1SUNBZ0lDQWdJQ0FnSUNBZ0lDQmtaV1poZFd4ME9pQmZkR2hwY3k1ZlkyaGhibWRsUTJocGJHUnlaVzRvYlhObktUc2dZbkpsWVdzN1hHNGdJQ0FnSUNBZ0lDQWdJQ0I5WEc0Z0lDQWdJQ0FnSUNBZ2ZWeHVJQ0FnSUNBZ0lDQjlLVHRjYmx4dUlDQWdJQ0FnSUNCZmRHaHBjeTVmWTJocGJHUnlaVzVNYVhOMFpXNWxjbk11Y0hWemFDaHNhWE4wWlc1bGNpazdYRzRnSUNBZ0lDQjlLVHRjYmlBZ0lDQjlYRzRnSUgxY2JseHVJQ0JmY21Wc1pXRnpaVXhwYzNSbGJtVnljeWdwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdYM1JvYVhNdVgyTm9hV3hrY21WdVRHbHpkR1Z1WlhKekxtWnZja1ZoWTJnb0tHeHBjM1JsYm1WeUtTQTlQaUI3WEc0Z0lDQWdJQ0JzYVhOMFpXNWxjaTV5WlcxdmRtVW9LVHRjYmlBZ0lDQjlLVHRjYmx4dUlDQWdJRTlpYW1WamRDNXJaWGx6S0Y5MGFHbHpMbDlqYUdsc1pISmxiazlpYW1WamRITXBMbVp2Y2tWaFkyZ29LR3RsZVNrZ1BUNGdlMXh1SUNBZ0lDQWdYM1JvYVhNdVgyTm9hV3hrY21WdVQySnFaV04wYzF0clpYbGRMbDl5Wld4bFlYTmxUR2x6ZEdWdVpYSnpLQ2s3WEc0Z0lDQWdmU2s3WEc0Z0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1QySnFaV04wSUZWU1RDQnZaaUJ5WlhCdmNuUmxjaUJ2Y2lCdlluTmxjblpsY2x4dUlDQWdLaUJBZEhsd1pTQjdUMkpxWldOMFZWSk1mVnh1SUNBZ0tpOWNiaUFnWjJWMElIVnliQ2dwSUhzZ2NtVjBkWEp1SUhSb2FYTXVYM1Z5YkRzZ2ZWeHVYRzRnSUM4cUtseHVJQ0FnS2lCUFltcGxZM1FnYzJOb1pXMWhJRlZTVENBb2RHaHBjeUJtYVdWc1pDQnBjeUJ1YjNRZ2VXVjBJSE4wWVdKc1pTd2dZVzVrSUdseklITjFZbk5xWldOMElIUnZJR05vWVc1blpTbGNiaUFnSUNvZ1FIUjVjR1VnZTFOamFHVnRZVlZTVEgxY2JpQWdJQ292WEc0Z0lHZGxkQ0J6WTJobGJXRW9LU0I3SUhKbGRIVnliaUIwYUdsekxsOXpZMmhsYldFN0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1UzUmhkSFZ6SUc5bUlIUm9aU0J5WlhCdmNuUmxjaUJ2Y2lCdlluTmxjblpsY2lCamIyNXVaV04wYVc5dUlDaDBhR2x6SUdacFpXeGtJR2x6SUc1dmRDQjVaWFFnYzNSaFlteGxMQ0JoYm1RZ2FYTWdjM1ZpYzJwbFkzUWdkRzhnWTJoaGJtZGxLVnh1SUNBZ0tpQkFkSGx3WlNCN1UzUmhkSFZ6ZlNBdElFVnVkVzBnYjJZNklHOXVJSHdnY0dGMWMyVmtYRzRnSUNBcUwxeHVJQ0JuWlhRZ2MzUmhkSFZ6S0NrZ2V5QnlaWFIxY200Z2RHaHBjeTVmYzNSaGRIVnpPeUI5WEc1Y2JpQWdMeW9xWEc0Z0lDQXFJRVJoZEdFZ2MzUnlkV04wZFhKbElIUnZJR0psSUhONWJtTm9jbTl1YVhwbFpDNWNiaUFnSUNvZ1FIUjVjR1VnZTBwVFQwNTlJQzBnU2xOUFRpQnpkSEoxWTNSMWNtVWdkR2hoZENCemFHOTFiR1FnWm05c2JHOTNJSFJvWlNCa1pXWnBibVZrSUhOamFHVnRZU3dnYVdZZ1lXNTVMbHh1SUNBZ0tpOWNiaUFnWjJWMElHUmhkR0VvS1NCN0lISmxkSFZ5YmlCMGFHbHpMbDl6ZVc1alQySnFMbVJoZEdFN0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1FXeHNJR055WldGMFpXUWdZMmhwYkdSeVpXNG5jeUJ6YVc1alpTQjBhR1VnYzNWaWMyTnlhWEIwYVc5dUxDQmtiMlZ6YmlkMElHTnZiblJoYVc0Z1lXeHNJR05vYVd4a2NtVnVKM01nYzJsdVkyVWdjbVZ3YjNKMFpYSWdZM0psWVhScGIyNHVYRzRnSUNBcUlFQjBlWEJsSUh0UFltcGxZM1E4UTJocGJHUkpaQ3dnUkdGMFlVOWlhbVZqZEVOb2FXeGtQbjFjYmlBZ0lDb3ZYRzRnSUdkbGRDQmphR2xzWkhKbGJuTW9LU0I3SUhKbGRIVnliaUIwYUdsekxsOWphR2xzWkhKbGJrOWlhbVZqZEhNN0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1FHbG5ibTl5WlZ4dUlDQWdLaTljYmlBZ2NHRjFjMlVvS1NCN1hHNGdJQ0FnTHk5VVQwUlBPaUIwYUdseklHWmxZWFIxY21VZ2JtVmxaSE1nYlc5eVpTQmhibUZzYVhObFhHNGdJQ0FnZEdoeWIzY2dKMDV2ZENCcGJYQnNaVzFsYm5SbFpDYzdYRzRnSUgxY2JseHVJQ0F2S2lwY2JpQWdJQ29nUUdsbmJtOXlaVnh1SUNBZ0tpOWNiaUFnY21WemRXMWxLQ2tnZTF4dUlDQWdJQzh2VkU5RVR6b2dkR2hwY3lCbVpXRjBkWEpsSUc1bFpXUnpJRzF2Y21VZ1lXNWhiR2x6WlZ4dUlDQWdJSFJvY205M0lDZE9iM1FnYVcxd2JHVnRaVzUwWldRbk8xeHVJQ0I5WEc1Y2JpQWdMeW9xWEc0Z0lDQXFJRUJwWjI1dmNtVmNiaUFnSUNvdlhHNGdJSE4wYjNBb0tTQjdYRzRnSUNBZ0x5OVVUMFJQT2lCemFHOTFiR1FnY21WdGIzWmxJSFJvWlNCemRXSnpZM0pwY0hScGIyNGdZVzVrSUhObGJtUWdiV1Z6YzJGblpTQjFibk4xWW5OamNtbGlaVDljYmlBZ0lDQjBhSEp2ZHlBblRtOTBJR2x0Y0d4bGJXVnVkR1ZrSnp0Y2JpQWdmVnh1WEc0Z0lDOHFLbHh1SUNBZ0tpQkRjbVZoZEdVZ1lXNWtJR0ZrWkNCaElFUmhkR0ZQWW1wbFkzUkRhR2xzWkNCMGJ5QmhJR05vYVd4a2NtVnVJR052Ykd4bFkzUnBiMjR1WEc0Z0lDQXFJRUJ3WVhKaGJTQjdVM1J5YVc1bmZTQmphR2xzWkhKbGJpQXRJRU5vYVd4a2NtVnVJRzVoYldVZ2QyaGxjbVVnZEdobElHTm9hV3hrSUdseklHRmtaR1ZrTGx4dUlDQWdLaUJBY0dGeVlXMGdlMHBUVDA1OUlHbHVhWFJwWVd4RVlYUmhJQzBnU1c1cGRHbGhiQ0JrWVhSaElHOW1JSFJvWlNCamFHbHNaRnh1SUNBZ0tpQkFjR0Z5WVcwZ0lIdE5aWE56WVdkbFFtOWtlVWxrWlc1MGFYUjVmU0JwWkdWdWRHbDBlU0F0SUNodmNIUnBiMjVoYkNrZ2FXUmxiblJwZEhrZ1pHRjBZU0IwYnlCaVpTQmhaR1JsWkNCMGJ5QnBaR1Z1ZEdsMGVTQjBhR1VnZFhObGNpQnlaWEJ2Y25SbGNpNGdWRzhnWW1VZ2RYTmxaQ0JtYjNJZ2JHVm5ZV041SUdsa1pXNTBhWFJwWlhNdVhHNGdJQ0FxSUVCeVpYUjFjbTRnZTFCeWIyMXBjMlU4UkdGMFlVOWlhbVZqZEVOb2FXeGtQbjBnTFNCU1pYUjFjbTRnVUhKdmJXbHpaU0IwYnlCaElHNWxkeUJFWVhSaFQySnFaV04wUTJocGJHUXVYRzRnSUNBcUwxeHVJQ0JoWkdSRGFHbHNaQ2hqYUdsc1pISmxiaXdnYVc1cGRHbGhiRVJoZEdFc0lHbGtaVzUwYVhSNUtTQjdYRzRnSUNBZ2JHVjBJRjkwYUdseklEMGdkR2hwY3p0Y2JseHVJQ0FnSUM4dlkzSmxZWFJsSUc1bGR5QmphR2xzWkNCMWJtbHhkV1VnU1VRc0lHSmhjMlZrSUc5dUlHaDVjR1Z5ZEhsVlVreGNiaUFnSUNCZmRHaHBjeTVmWTJocGJHUkpaQ3NyTzF4dUlDQWdJR3hsZENCdGMyZERhR2xzWkVsa0lEMGdYM1JvYVhNdVgyOTNibVZ5SUNzZ0p5TW5JQ3NnWDNSb2FYTXVYMk5vYVd4a1NXUTdYRzRnSUNBZ2JHVjBJRzF6WjBOb2FXeGtVR0YwYUNBOUlGOTBhR2x6TGw5MWNtd2dLeUFuTDJOb2FXeGtjbVZ1THljZ0t5QmphR2xzWkhKbGJqdGNibHh1SUNBZ0lDOHZSa3hQVnkxUFZWUTZJSFJvYVhNZ2JXVnpjMkZuWlNCM2FXeHNJR0psSUhObGJuUWdaR2x5WldOMGJIa2dkRzhnWVNCeVpYTnZkWEpqWlNCamFHbHNaQ0JoWkdSeVpYTnpPaUJOWlhOellXZGxRblZ6WEc0Z0lDQWdiR1YwSUhKbGNYVmxjM1JOYzJjZ1BTQjdYRzRnSUNBZ0lDQjBlWEJsT2lBblkzSmxZWFJsSnl3Z1puSnZiVG9nWDNSb2FYTXVYMjkzYm1WeUxDQjBiem9nYlhOblEyaHBiR1JRWVhSb0xGeHVJQ0FnSUNBZ1ltOWtlVG9nZXlCeVpYTnZkWEpqWlRvZ2JYTm5RMmhwYkdSSlpDd2dkbUZzZFdVNklHbHVhWFJwWVd4RVlYUmhJSDFjYmlBZ0lDQjlPMXh1WEc0Z0lDQWdhV1lnS0dsa1pXNTBhWFI1S1NBZ0lDQWdJSHNnY21WeGRXVnpkRTF6Wnk1aWIyUjVMbWxrWlc1MGFYUjVJRDBnYVdSbGJuUnBkSGs3SUgxY2JseHVJQ0FnSUM4dlZFOUVUem9nUm05eUlFWjFjblJvWlhJZ1UzUjFaSGxjYmlBZ0lDQnBaaUFvSVY5MGFHbHpMbDl0ZFhSMVlXeEJkWFJvWlc1MGFXTmhkR2x2YmlrZ2NtVnhkV1Z6ZEUxelp5NWliMlI1TG0xMWRIVmhiRUYxZEdobGJuUnBZMkYwYVc5dUlEMGdYM1JvYVhNdVgyMTFkSFZoYkVGMWRHaGxiblJwWTJGMGFXOXVPMXh1WEc0Z0lDQWdMeTl5WlhSMWNtNXpJSEJ5YjIxcGMyVXNJR2x1SUhSb1pTQm1kWFIxY21Vc0lIUm9aU0JCVUVrZ2JXRjVJR05vWVc1blpTQjBieUJoYzNsdVkyaHliMjV2ZFhNZ1kyRnNiRnh1SUNBZ0lISmxkSFZ5YmlCdVpYY2dVSEp2YldselpTZ29jbVZ6YjJ4MlpTa2dQVDRnZTF4dUlDQWdJQ0FnYkdWMElHMXpaMGxrSUQwZ1gzUm9hWE11WDJKMWN5NXdiM04wVFdWemMyRm5aU2h5WlhGMVpYTjBUWE5uS1R0Y2JseHVJQ0FnSUNBZ1kyOXVjMjlzWlM1c2IyY29KMk55WldGMFpTMXlaWEJ2Y25SbGNpMWphR2xzWkNnZ0p5QXJJRjkwYUdsekxsOXZkMjVsY2lBcklDY2dLVG9nSnl3Z2NtVnhkV1Z6ZEUxelp5azdYRzRnSUNBZ0lDQnNaWFFnYm1WM1EyaHBiR1FnUFNCdVpYY2dSR0YwWVU5aWFtVmpkRU5vYVd4a0tGOTBhR2x6TENCdGMyZERhR2xzWkVsa0xDQnBibWwwYVdGc1JHRjBZU3dnWDNSb2FYTXVYMjkzYm1WeUxDQnRjMmRKWkNrN1hHNGdJQ0FnSUNCdVpYZERhR2xzWkM1dmJrTm9ZVzVuWlNnb1pYWmxiblFwSUQwK0lIdGNiaUFnSUNBZ0lDQWdYM1JvYVhNdVgyOXVRMmhoYm1kbEtHVjJaVzUwTENCN0lIQmhkR2c2SUcxelowTm9hV3hrVUdGMGFDd2dZMmhwYkdSSlpEb2diWE5uUTJocGJHUkpaQ0I5S1R0Y2JpQWdJQ0FnSUgwcE8xeHVYRzRnSUNBZ0lDQmZkR2hwY3k1ZlkyaHBiR1J5Wlc1UFltcGxZM1J6VzIxelowTm9hV3hrU1dSZElEMGdibVYzUTJocGJHUTdYRzVjYmlBZ0lDQWdJSEpsYzI5c2RtVW9ibVYzUTJocGJHUXBPMXh1SUNBZ0lIMHBPMXh1SUNCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUZObGRIVndJSFJvWlNCallXeHNZbUZqYXlCMGJ5QndjbTlqWlhOeklHTnlaV0YwWlNCaGJtUWdaR1ZzWlhSbElHOW1JR05vYVd4a2NtVnVjeTVjYmlBZ0lDb2dRSEJoY21GdElIdG1kVzVqZEdsdmJpaGxkbVZ1ZERvZ1RYTm5SWFpsYm5RcGZTQmpZV3hzWW1GamExeHVJQ0FnS2k5Y2JpQWdiMjVCWkdSRGFHbHNaQ2hqWVd4c1ltRmpheWtnZTF4dUlDQWdJSFJvYVhNdVgyOXVRV1JrUTJocGJHUnlaVzVJWVc1a2JHVnlJRDBnWTJGc2JHSmhZMnM3WEc0Z0lIMWNibHh1SUNBdkwwWk1UMWN0U1U0NklHMWxjM05oWjJVZ2NtVmpaV2wyWldRZ1puSnZiU0JoSUhKbGJXOTBaU0JFWVhSaFQySnFaV04wSUMwK0lHRmtaRU5vYVd4a1hHNGdJRjl2YmtOb2FXeGtRM0psWVhSbEtHMXpaeWtnZTF4dUlDQWdJR3hsZENCZmRHaHBjeUE5SUhSb2FYTTdYRzRnSUNBZ2JHVjBJRzF6WjBOb2FXeGtTV1FnUFNCdGMyY3VZbTlrZVM1eVpYTnZkWEpqWlR0Y2JseHVJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZGpjbVZoZEdVdGIySnpaWEoyWlhJdFkyaHBiR1FvSUNjZ0t5QmZkR2hwY3k1ZmIzZHVaWElnS3lBbklDazZJQ2NzSUcxelp5azdYRzRnSUNBZ2JHVjBJRzVsZDBOb2FXeGtJRDBnYm1WM0lFUmhkR0ZQWW1wbFkzUkRhR2xzWkNoZmRHaHBjeXdnYlhOblEyaHBiR1JKWkN3Z2JYTm5MbUp2WkhrdWRtRnNkV1VwTzF4dUlDQWdJRjkwYUdsekxsOWphR2xzWkhKbGJrOWlhbVZqZEhOYmJYTm5RMmhwYkdSSlpGMGdQU0J1WlhkRGFHbHNaRHRjYmx4dUlDQWdJSE5sZEZScGJXVnZkWFFvS0NrZ1BUNGdlMXh1SUNBZ0lDQWdMeTlHVEU5WExVOVZWRG9nZDJsc2JDQm1iRzkzSUhSdklFUmhkR0ZQWW1wbFkzUkRhR2xzWkNBdFBpQmZiMjVTWlhOd2IyNXpaVnh1SUNBZ0lDQWdYM1JvYVhNdVgySjFjeTV3YjNOMFRXVnpjMkZuWlNoN1hHNGdJQ0FnSUNBZ0lHbGtPaUJ0YzJjdWFXUXNJSFI1Y0dVNklDZHlaWE53YjI1elpTY3NJR1p5YjIwNklHMXpaeTUwYnl3Z2RHODZJRzF6Wnk1bWNtOXRMRnh1SUNBZ0lDQWdJQ0JpYjJSNU9pQjdJR052WkdVNklESXdNQ3dnYzI5MWNtTmxPaUJmZEdocGN5NWZiM2R1WlhJZ2ZWeHVJQ0FnSUNBZ2ZTazdYRzRnSUNBZ2ZTazdYRzVjYmlBZ0lDQnNaWFFnWlhabGJuUWdQU0I3WEc0Z0lDQWdJQ0IwZVhCbE9pQnRjMmN1ZEhsd1pTeGNiaUFnSUNBZ0lHWnliMjA2SUcxelp5NW1jbTl0TEZ4dUlDQWdJQ0FnZFhKc09pQnRjMmN1ZEc4c1hHNGdJQ0FnSUNCMllXeDFaVG9nYlhObkxtSnZaSGt1ZG1Gc2RXVXNYRzRnSUNBZ0lDQmphR2xzWkVsa09pQnRjMmREYUdsc1pFbGtMRnh1SUNBZ0lDQWdhV1JsYm5ScGRIazZJRzF6Wnk1aWIyUjVMbWxrWlc1MGFYUjVYRzRnSUNBZ2ZUdGNibHh1SUNBZ0lHbG1JQ2hmZEdocGN5NWZiMjVCWkdSRGFHbHNaSEpsYmtoaGJtUnNaWElwSUh0Y2JpQWdJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZEJSRVF0UTBoSlRFUlNSVTR0UlZaRlRsUTZJQ2NzSUdWMlpXNTBLVHRjYmlBZ0lDQWdJRjkwYUdsekxsOXZia0ZrWkVOb2FXeGtjbVZ1U0dGdVpHeGxjaWhsZG1WdWRDazdYRzRnSUNBZ2ZWeHVJQ0I5WEc1Y2JpQWdMeTl6Wlc1a0lHUmxiSFJoSUcxbGMzTmhaMlZ6SUhSdklITjFZbk5qY21sd2RHbHZibk5jYmlBZ1gyOXVRMmhoYm1kbEtHVjJaVzUwTENCamFHbHNaRWx1Wm04cElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWDNSb2FYTXVYM1psY25OcGIyNHJLenRjYmx4dUlDQWdJR2xtSUNoZmRHaHBjeTVmYzNSaGRIVnpJRDA5UFNBbmIyNG5LU0I3WEc0Z0lDQWdJQ0F2TDBaTVQxY3RUMVZVT2lCMGFHbHpJRzFsYzNOaFoyVWdkMmxzYkNCaVpTQnpaVzUwSUdScGNtVmpkR3g1SUhSdklHRWdjbVZ6YjNWeVkyVWdZMmhoYm1kbGN5QmhaR1J5WlhOek9pQk5aWE56WVdkbFFuVnpYRzRnSUNBZ0lDQnNaWFFnWTJoaGJtZGxUWE5uSUQwZ2UxeHVJQ0FnSUNBZ0lDQjBlWEJsT2lBbmRYQmtZWFJsSnl3Z1puSnZiVG9nWDNSb2FYTXVYM1Z5YkN3Z2RHODZJRjkwYUdsekxsOTFjbXdnS3lBbkwyTm9ZVzVuWlhNbkxGeHVJQ0FnSUNBZ0lDQmliMlI1T2lCN0lIWmxjbk5wYjI0NklGOTBhR2x6TGw5MlpYSnphVzl1TENCemIzVnlZMlU2SUY5MGFHbHpMbDl2ZDI1bGNpd2dZWFIwY21saWRYUmxPaUJsZG1WdWRDNW1hV1ZzWkNCOVhHNGdJQ0FnSUNCOU8xeHVYRzRnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVzBSaGRHRlBZbXBsWTNRZ0xTQmZiMjVEYUdGdVoyVmRJQzBnSnl3Z1pYWmxiblFzSUdOb2FXeGtTVzVtYnl3Z1kyaGhibWRsVFhObktUdGNibHh1SUNBZ0lDQWdhV1lnS0dWMlpXNTBMbTlVZVhCbElEMDlQU0JQWW1wbFkzUlVlWEJsTGs5Q1NrVkRWQ2tnZTF4dUlDQWdJQ0FnSUNCcFppQW9aWFpsYm5RdVkxUjVjR1VnSVQwOUlFTm9ZVzVuWlZSNWNHVXVVa1ZOVDFaRktTQjdYRzRnSUNBZ0lDQWdJQ0FnWTJoaGJtZGxUWE5uTG1KdlpIa3VkbUZzZFdVZ1BTQmxkbVZ1ZEM1a1lYUmhPMXh1SUNBZ0lDQWdJQ0I5WEc0Z0lDQWdJQ0I5SUdWc2MyVWdlMXh1SUNBZ0lDQWdJQ0JqYUdGdVoyVk5jMmN1WW05a2VTNWhkSFJ5YVdKMWRHVlVlWEJsSUQwZ1pYWmxiblF1YjFSNWNHVTdYRzRnSUNBZ0lDQWdJR05vWVc1blpVMXpaeTVpYjJSNUxuWmhiSFZsSUQwZ1pYWmxiblF1WkdGMFlUdGNiaUFnSUNBZ0lDQWdhV1lnS0dWMlpXNTBMbU5VZVhCbElDRTlQU0JEYUdGdVoyVlVlWEJsTGxWUVJFRlVSU2tnZTF4dUlDQWdJQ0FnSUNBZ0lHTm9ZVzVuWlUxelp5NWliMlI1TG05d1pYSmhkR2x2YmlBOUlHVjJaVzUwTG1OVWVYQmxPMXh1SUNBZ0lDQWdJQ0I5WEc0Z0lDQWdJQ0I5WEc1Y2JpQWdJQ0FnSUM4dlkyaHBiR1JKYm1adklHMTFjM1FnYUdGMlpTQW9jR0YwYUN3Z1kyaHBiR1JKWkNsY2JpQWdJQ0FnSUdsbUlDaGphR2xzWkVsdVptOHBJSHRjYmlBZ0lDQWdJQ0FnWTJoaGJtZGxUWE5uTG5SdklEMGdZMmhwYkdSSmJtWnZMbkJoZEdnN1hHNGdJQ0FnSUNBZ0lHTm9ZVzVuWlUxelp5NWliMlI1TG5KbGMyOTFjbU5sSUQwZ1kyaHBiR1JKYm1adkxtTm9hV3hrU1dRN1hHNGdJQ0FnSUNCOVhHNWNiaUFnSUNBZ0lDOHZWRTlFVHpvZ1JtOXlJRVoxY25Sb1pYSWdVM1IxWkhsY2JpQWdJQ0FnSUdsbUlDZ2hYM1JvYVhNdVgyMTFkSFZoYkVGMWRHaGxiblJwWTJGMGFXOXVLU0JqYUdGdVoyVk5jMmN1WW05a2VTNXRkWFIxWVd4QmRYUm9aVzUwYVdOaGRHbHZiaUE5SUY5MGFHbHpMbDl0ZFhSMVlXeEJkWFJvWlc1MGFXTmhkR2x2Ymp0Y2JseHVJQ0FnSUNBZ1gzUm9hWE11WDJKMWN5NXdiM04wVFdWemMyRm5aU2hqYUdGdVoyVk5jMmNwTzF4dUlDQWdJSDFjYmlBZ2ZWeHVYRzRnSUM4dlJreFBWeTFKVGpvZ1pHVnNkR0VnYldWemMyRm5aU0J5WldObGFYWmxaQ0JtY205dElHRWdjbVZ0YjNSbElFUmhkR0ZQWW1wbFkzUlNaWEJ2Y25SbGNpQnZjaUJFWVhSaFQySnFaV04wUTJocGJHUWdkMmhsYmlCamFHRnVaMmx1WnlCa1lYUmhYRzRnSUY5amFHRnVaMlZQWW1wbFkzUW9jM2x1WTA5aWFpd2diWE5uS1NCN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmx4dUlDQWdJQzh2VkU5RVR6b2dkWEJrWVhSbElIWmxjbk5wYjI0Z1AxeHVJQ0FnSUM4dmFHOTNJSFJ2SUdoaGJtUnNaU0JoYmlCcGJtTnZjbkpsWTNRZ2RtVnljMmx2YmlBL0lFVjRZVzF3YkdVNklISmxZMlZwZG1VZ1lTQjJaWEp6YVc5dUlETWdkMmhsYmlCMGFHVWdiMkp6WlhKMlpYSWdhWE1nYVc0Z2RtVnljMmx2YmlBeExDQjNhR1Z5WlNCcGN5QjBhR1VnZG1WeWMybHZiaUF5SUQ5Y2JpQWdJQ0F2TDNkcGJHd2dkMlVnYm1WbFpDQjBieUJqYjI1bWFYSnRJSFJvWlNCeVpXTmxjSFJwYjI0Z1AxeHVJQ0FnSUdsbUlDaGZkR2hwY3k1ZmRtVnljMmx2YmlBcklERWdQVDA5SUcxelp5NWliMlI1TG5abGNuTnBiMjRwSUh0Y2JpQWdJQ0FnSUY5MGFHbHpMbDkyWlhKemFXOXVLeXM3WEc0Z0lDQWdJQ0JzWlhRZ2NHRjBhQ0E5SUcxelp5NWliMlI1TG1GMGRISnBZblYwWlR0Y2JpQWdJQ0FnSUd4bGRDQjJZV3gxWlNBOUlHUmxaWEJEYkc5dVpTaHRjMmN1WW05a2VTNTJZV3gxWlNrN1hHNGdJQ0FnSUNCc1pYUWdabWx1WkZKbGMzVnNkQ0E5SUhONWJtTlBZbW91Wm1sdVpFSmxabTl5WlNod1lYUm9LVHRjYmx4dUlDQWdJQ0FnYVdZZ0tHMXpaeTVpYjJSNUxtRjBkSEpwWW5WMFpWUjVjR1VnUFQwOUlFOWlhbVZqZEZSNWNHVXVRVkpTUVZrcElIdGNiaUFnSUNBZ0lDQWdhV1lnS0cxelp5NWliMlI1TG05d1pYSmhkR2x2YmlBOVBUMGdRMmhoYm1kbFZIbHdaUzVCUkVRcElIdGNiaUFnSUNBZ0lDQWdJQ0JzWlhRZ1lYSnlJRDBnWm1sdVpGSmxjM1ZzZEM1dlltbzdYRzRnSUNBZ0lDQWdJQ0FnYkdWMElHbHVaR1Y0SUQwZ1ptbHVaRkpsYzNWc2RDNXNZWE4wTzF4dUlDQWdJQ0FnSUNBZ0lFRnljbUY1TG5CeWIzUnZkSGx3WlM1emNHeHBZMlV1WVhCd2JIa29ZWEp5TENCYmFXNWtaWGdzSURCZExtTnZibU5oZENoMllXeDFaU2twTzF4dUlDQWdJQ0FnSUNCOUlHVnNjMlVnYVdZZ0tHMXpaeTVpYjJSNUxtOXdaWEpoZEdsdmJpQTlQVDBnUTJoaGJtZGxWSGx3WlM1U1JVMVBWa1VwSUh0Y2JpQWdJQ0FnSUNBZ0lDQnNaWFFnWVhKeUlEMGdabWx1WkZKbGMzVnNkQzV2WW1vN1hHNGdJQ0FnSUNBZ0lDQWdiR1YwSUdsdVpHVjRJRDBnWm1sdVpGSmxjM1ZzZEM1c1lYTjBPMXh1SUNBZ0lDQWdJQ0FnSUdGeWNpNXpjR3hwWTJVb2FXNWtaWGdzSUhaaGJIVmxLVHRjYmlBZ0lDQWdJQ0FnZlNCbGJITmxJSHRjYmlBZ0lDQWdJQ0FnSUNCbWFXNWtVbVZ6ZFd4MExtOWlhbHRtYVc1a1VtVnpkV3gwTG14aGMzUmRJRDBnZG1Gc2RXVTdJQzh2SUZWUVJFRlVSVnh1SUNBZ0lDQWdJQ0I5WEc0Z0lDQWdJQ0I5SUdWc2MyVWdlMXh1SUNBZ0lDQWdJQ0JwWmlBb2JYTm5MbUp2WkhrdWRtRnNkV1VwSUh0Y2JpQWdJQ0FnSUNBZ0lDQm1hVzVrVW1WemRXeDBMbTlpYWx0bWFXNWtVbVZ6ZFd4MExteGhjM1JkSUQwZ2RtRnNkV1U3SUM4dklGVlFSRUZVUlNCdmNpQkJSRVJjYmlBZ0lDQWdJQ0FnZlNCbGJITmxJSHRjYmlBZ0lDQWdJQ0FnSUNCa1pXeGxkR1VnWm1sdVpGSmxjM1ZzZEM1dlltcGJabWx1WkZKbGMzVnNkQzVzWVhOMFhUc2dMeThnVWtWTlQxWkZYRzRnSUNBZ0lDQWdJSDFjYmlBZ0lDQWdJSDFjYmlBZ0lDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ0x5OVVUMFJQT2lCb2IzY2dkRzhnYUdGdVpHeGxJSFZ1YzNsdVkyaHliMjVwZW1Wa0lIWmxjbk5wYjI1elAxeHVJQ0FnSUNBZ1kyOXVjMjlzWlM1c2IyY29KMVZPVTFsT1EwaFNUMDVKV2tWRUlGWkZVbE5KVDA0NklDaGtZWFJoSUQwK0lDY2dLeUJmZEdocGN5NWZkbVZ5YzJsdmJpQXJJQ2NzSUcxelp5QTlQaUFuSUNzZ2JYTm5MbUp2WkhrdWRtVnljMmx2YmlBcklDY3BKeWs3WEc0Z0lDQWdmVnh1SUNCOVhHNWNiaUFnTHk5R1RFOVhMVWxPT2lCdFpYTnpZV2RsSUhKbFkyVnBkbVZrSUdaeWIyMGdZU0J5WlcxdmRHVWdSR0YwWVU5aWFtVmpkRU5vYVd4a0lIZG9aVzRnWTJoaGJtZHBibWNnWkdGMFlWeHVJQ0JmWTJoaGJtZGxRMmhwYkdSeVpXNG9iWE5uS1NCN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmlBZ0lDQmpiMjV6YjJ4bExteHZaeWduUTJoaGJtZGxJR05vYVd4a2NtVnVPaUFuTENCZmRHaHBjeTVmYjNkdVpYSXNJRzF6WnlrN1hHNWNiaUFnSUNCc1pYUWdZMmhwYkdSSlpDQTlJRzF6Wnk1aWIyUjVMbkpsYzI5MWNtTmxPMXh1SUNBZ0lHeGxkQ0JqYUdsc1pISmxiaUE5SUY5MGFHbHpMbDlqYUdsc1pISmxiazlpYW1WamRITmJZMmhwYkdSSlpGMDdYRzVjYmlBZ0lDQnBaaUFvWTJocGJHUnlaVzRwSUh0Y2JpQWdJQ0FnSUY5MGFHbHpMbDlqYUdGdVoyVlBZbXBsWTNRb1kyaHBiR1J5Wlc0dVgzTjVibU5QWW1vc0lHMXpaeWs3WEc0Z0lDQWdmU0JsYkhObElIdGNiaUFnSUNBZ0lHTnZibk52YkdVdWJHOW5LQ2RPYnlCamFHbHNaSEpsYmlCbWIzVnVaQ0JtYjNJNklDY3NJR05vYVd4a1NXUXBPMXh1SUNBZ0lIMWNiaUFnZlZ4dVhHNTlYRzVjYm1WNGNHOXlkQ0JrWldaaGRXeDBJRVJoZEdGUFltcGxZM1E3WEc1Y2JseHVYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVaUF2TDF4dUx5OGdMaTl6Y21NdmMzbHVZMmhsY2k5RVlYUmhUMkpxWldOMExtcHpJaXdpTHlvcVhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklGQlVJRWx1YjNaaHc2ZkRvMjhnWlNCVGFYTjBaVzFoY3lCVFFWeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQkpUa1ZUUXkxSlJGeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQlJWVTlDU1ZNZ1RrVlVWMDlTUzFNZ1UweGNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdSbEpCVlU1SVQwWkZVaTFIUlZORlRFeFRRMGhCUmxRZ1dsVlNJRVpQUlZKRVJWSlZUa2NnUkVWU0lFRk9SMFZYUVU1RVZFVk9JRVpQVWxORFNGVk9SeUJGTGxaY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1QxSkJUa2RGSUZOQlhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklFUmxkWFJ6WTJobElGUmxiR1ZyYjIwZ1FVZGNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdRWEJwZW1WbFhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklGUkZRMGhPU1ZORFNFVWdWVTVKVmtWU1UwbFVRVlFnUWtWU1RFbE9YRzRxWEc0cUlFeHBZMlZ1YzJWa0lIVnVaR1Z5SUhSb1pTQkJjR0ZqYUdVZ1RHbGpaVzV6WlN3Z1ZtVnljMmx2YmlBeUxqQWdLSFJvWlNCY0lreHBZMlZ1YzJWY0lpazdYRzRxSUhsdmRTQnRZWGtnYm05MElIVnpaU0IwYUdseklHWnBiR1VnWlhoalpYQjBJR2x1SUdOdmJYQnNhV0Z1WTJVZ2QybDBhQ0IwYUdVZ1RHbGpaVzV6WlM1Y2Jpb2dXVzkxSUcxaGVTQnZZblJoYVc0Z1lTQmpiM0I1SUc5bUlIUm9aU0JNYVdObGJuTmxJR0YwWEc0cVhHNHFJQ0FnYUhSMGNEb3ZMM2QzZHk1aGNHRmphR1V1YjNKbkwyeHBZMlZ1YzJWekwweEpRMFZPVTBVdE1pNHdYRzRxWEc0cUlGVnViR1Z6Y3lCeVpYRjFhWEpsWkNCaWVTQmhjSEJzYVdOaFlteGxJR3hoZHlCdmNpQmhaM0psWldRZ2RHOGdhVzRnZDNKcGRHbHVaeXdnYzI5bWRIZGhjbVZjYmlvZ1pHbHpkSEpwWW5WMFpXUWdkVzVrWlhJZ2RHaGxJRXhwWTJWdWMyVWdhWE1nWkdsemRISnBZblYwWldRZ2IyNGdZVzRnWENKQlV5QkpVMXdpSUVKQlUwbFRMRnh1S2lCWFNWUklUMVZVSUZkQlVsSkJUbFJKUlZNZ1QxSWdRMDlPUkVsVVNVOU9VeUJQUmlCQlRsa2dTMGxPUkN3Z1pXbDBhR1Z5SUdWNGNISmxjM01nYjNJZ2FXMXdiR2xsWkM1Y2Jpb2dVMlZsSUhSb1pTQk1hV05sYm5ObElHWnZjaUIwYUdVZ2MzQmxZMmxtYVdNZ2JHRnVaM1ZoWjJVZ1oyOTJaWEp1YVc1bklIQmxjbTFwYzNOcGIyNXpJR0Z1WkZ4dUtpQnNhVzFwZEdGMGFXOXVjeUIxYm1SbGNpQjBhR1VnVEdsalpXNXpaUzVjYmlvcUwxeHVYRzVwYlhCdmNuUWdVM2x1WTA5aWFtVmpkQ0JtY205dElDY3VMMUJ5YjNoNVQySnFaV04wSnp0Y2JseHVMeW9xWEc0Z0tpQlVhR1VnWTJ4aGMzTWdjbVYwZFhKdVpXUWdabkp2YlNCMGFHVWdSR0YwWVU5aWFtVmpkQ0JoWkdSRGFHbHNaSEpsYmlCallXeHNJRzl5SUdaeWIyMGdiMjVCWkdSRGFHbHNaSEpsYmlCcFppQnlaVzF2ZEdWc2VTQmpjbVZoZEdWa0xseHVJQ29nUTJocGJHUnlaVzRnYjJKcVpXTjBJSE41Ym1Ob2NtOXVhWHBoZEdsdmJpQnBjeUJoSUdFZ1ptRnpkQ0JtYjNKM1lYSmtJRzFsWTJoaGJtbHpiU3dnYm04Z2JtVmxaQ0JtYjNJZ1pHbHlaV04wSUhOMVluTmpjbWx3ZEdsdmJuTXNJR2wwSUhWelpYTWdkR2hsSUdGc2NtVmhaSGtnWVhWMGFHOXlhWHBsWkNCemRXSnpZM0pwY0hScGIyNGdabkp2YlNCMGFHVWdjR0Z5Wlc1MElFUmhkR0ZQWW1wbFkzUXVYRzRnS2k5Y2JtTnNZWE56SUVSaGRHRlBZbXBsWTNSRGFHbHNaQ0F2S2lCcGJYQnNaVzFsYm5SeklGTjVibU5UZEdGMGRYTWdLaThnZTF4dUlDQXZLaUJ3Y21sMllYUmxYRzVjYmlBZ0xTMHRMV1YyWlc1MElHaGhibVJzWlhKekxTMHRMVnh1SUNCZmIyNVNaWE53YjI1elpVaGhibVJzWlhJNklDaGxkbVZ1ZENrZ1BUNGdkbTlwWkZ4dUlDQXFMMXh1WEc0Z0lDOHFLbHh1SUNBZ0tpQkFhV2R1YjNKbFhHNGdJQ0FxSUZOb2IzVnNaQ0J1YjNRZ1ltVWdkWE5sWkNCa2FYSmxZM1JzZVNCaWVTQkllWEJsY25ScFpYTXVJRWwwSjNNZ1kyRnNiR1ZrSUdKNUlIUm9aU0JFWVhSaFQySnFaV04wTG1Ga1pFTm9hV3hrY21WdVhHNGdJQ0FxTDF4dUlDQmpiMjV6ZEhKMVkzUnZjaWh3WVhKbGJuUXNJR05vYVd4a1NXUXNJR2x1YVhScFlXeEVZWFJoTENCdmQyNWxjaXdnYlhOblNXUXBJSHRjYmlBZ0lDQnNaWFFnWDNSb2FYTWdQU0IwYUdsek8xeHVYRzRnSUNBZ1gzUm9hWE11WDNCaGNtVnVkQ0E5SUhCaGNtVnVkRHRjYmlBZ0lDQmZkR2hwY3k1ZlkyaHBiR1JKWkNBOUlHTm9hV3hrU1dRN1hHNGdJQ0FnWDNSb2FYTXVYMjkzYm1WeUlEMGdiM2R1WlhJN1hHNGdJQ0FnWDNSb2FYTXVYMjF6WjBsa0lEMGdiWE5uU1dRN1hHNWNiaUFnSUNCZmRHaHBjeTVmYzNsdVkwOWlhaUE5SUc1bGR5QlRlVzVqVDJKcVpXTjBLR2x1YVhScFlXeEVZWFJoS1R0Y2JseHVJQ0FnSUY5MGFHbHpMbDlpZFhNZ1BTQndZWEpsYm5RdVgySjFjenRjYmlBZ0lDQmZkR2hwY3k1ZllXeHNiMk5oZEdWTWFYTjBaVzVsY25Nb0tUdGNiaUFnZlZ4dVhHNGdJRjloYkd4dlkyRjBaVXhwYzNSbGJtVnljeWdwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdMeTkwYUdseklHbHpJRzl1YkhrZ2JtVmxaR1ZrSUdadmNpQmphR2xzWkhKbGJpQnlaWEJ2Y25SbGNuTmNiaUFnSUNCcFppQW9YM1JvYVhNdVgyOTNibVZ5S1NCN1hHNGdJQ0FnSUNCZmRHaHBjeTVmYkdsemRHVnVaWElnUFNCZmRHaHBjeTVmWW5WekxtRmtaRXhwYzNSbGJtVnlLRjkwYUdsekxsOXZkMjVsY2l3Z0tHMXpaeWtnUFQ0Z2UxeHVJQ0FnSUNBZ0lDQnBaaUFvYlhObkxuUjVjR1VnUFQwOUlDZHlaWE53YjI1elpTY2dKaVlnYlhObkxtbGtJRDA5UFNCZmRHaHBjeTVmYlhOblNXUXBJSHRjYmlBZ0lDQWdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25SR0YwWVU5aWFtVmpkRU5vYVd4a0xtOXVVbVZ6Y0c5dWMyVTZKeXdnYlhObktUdGNiaUFnSUNBZ0lDQWdJQ0JmZEdocGN5NWZiMjVTWlhOd2IyNXpaU2h0YzJjcE8xeHVJQ0FnSUNBZ0lDQjlYRzRnSUNBZ0lDQjlLVHRjYmlBZ0lDQjlYRzRnSUgxY2JseHVJQ0JmY21Wc1pXRnpaVXhwYzNSbGJtVnljeWdwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdhV1lnS0Y5MGFHbHpMbDlzYVhOMFpXNWxjaWtnZTF4dUlDQWdJQ0FnWDNSb2FYTXVYMnhwYzNSbGJtVnlMbkpsYlc5MlpTZ3BPMXh1SUNBZ0lIMWNiaUFnZlZ4dVhHNGdJQzhxS2x4dUlDQWdLaUJTWld4bFlYTmxJR0Z1WkNCa1pXeGxkR1VnYjJKcVpXTjBJR1JoZEdGY2JpQWdJQ292WEc0Z0lHUmxiR1YwWlNncElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWkdWc1pYUmxJRjkwYUdsekxsOXdZWEpsYm5RdVgyTm9hV3hrY21WdVcxOTBhR2x6TGw5amFHbHNaRWxrWFR0Y2JseHVJQ0FnSUY5MGFHbHpMbDl5Wld4bFlYTmxUR2x6ZEdWdVpYSnpLQ2s3WEc1Y2JpQWdJQ0F2TDFSUFJFODZJSE5sYm1RZ1pHVnNaWFJsSUcxbGMzTmhaMlVnUDF4dUlDQjlYRzVjYmlBZ0x5b3FYRzRnSUNBcUlFTm9hV3hrY21WdUlFbEVJR2RsYm1WeVlYUmxaQ0J2YmlCaFpHUkRhR2xzWkhKbGJpNGdWVzVwY1hWbElHbGtaVzUwYVdacFpYSmNiaUFnSUNvZ1FIUjVjR1VnZTFWU1RIMGdMU0JWVWt3Z2IyWWdkR2hsSUdadmNtMWhkQ0E4U0hsd1pYSjBlVlZTVEQ0alBHNTFiV1Z5YVdNdGMyVnhkV1Z1WTJVK1hHNGdJQ0FxTDF4dUlDQm5aWFFnWTJocGJHUkpaQ2dwSUhzZ2NtVjBkWEp1SUhSb2FYTXVYMk5vYVd4a1NXUTdJSDFjYmx4dUlDQXZLaXBjYmlBZ0lDb2dSR0YwWVNCVGRISjFZM1IxY21VZ2RHOGdZbVVnYzNsdVkyaHliMjVwZW1Wa0xseHVJQ0FnS2lCQWRIbHdaU0I3U2xOUFRuMGdMU0JLVTA5T0lITjBjblZqZEhWeVpTQjBhR0YwSUhOb2IzVnNaQ0JtYjJ4c2IzY2dkR2hsSUdSbFptbHVaV1FnYzJOb1pXMWhMQ0JwWmlCaGJua3VYRzRnSUNBcUwxeHVJQ0JuWlhRZ1pHRjBZU2dwSUhzZ2NtVjBkWEp1SUhSb2FYTXVYM041Ym1OUFltb3VaR0YwWVRzZ2ZWeHVYRzRnSUM4cUtseHVJQ0FnS2lCU1pXZHBjM1JsY2lCMGFHVWdZMmhoYm1kbElHeHBjM1JsYm1WeWN5QnpaVzUwSUdKNUlIUm9aU0J5WlhCdmNuUmxjaUJqYUdsc1pGeHVJQ0FnS2lCQWNHRnlZVzBnZTJaMWJtTjBhVzl1S0dWMlpXNTBPaUJOYzJkRmRtVnVkQ2w5SUdOaGJHeGlZV05yWEc0Z0lDQXFMMXh1SUNCdmJrTm9ZVzVuWlNoallXeHNZbUZqYXlrZ2UxeHVJQ0FnSUhSb2FYTXVYM041Ym1OUFltb3ViMkp6WlhKMlpTZ29aWFpsYm5RcElEMCtJSHRjYmlBZ0lDQWdJR05oYkd4aVlXTnJLR1YyWlc1MEtUdGNiaUFnSUNCOUtUdGNiaUFnZlZ4dVhHNGdJQzhxS2x4dUlDQWdLaUJUWlhSMWNDQjBhR1VnWTJGc2JHSmhZMnNnZEc4Z2NISnZZMlZ6Y3lCeVpYTndiMjV6WlNCdWIzUnBabWxqWVhScGIyNXpJRzltSUhSb1pTQmpjbVZoZEdWelhHNGdJQ0FxSUVCd1lYSmhiU0I3Wm5WdVkzUnBiMjRvWlhabGJuUTZJRTF6WjBWMlpXNTBLWDBnWTJGc2JHSmhZMnRjYmlBZ0lDb3ZYRzRnSUc5dVVtVnpjRzl1YzJVb1kyRnNiR0poWTJzcElIdGNiaUFnSUNCMGFHbHpMbDl2YmxKbGMzQnZibk5sU0dGdVpHeGxjaUE5SUdOaGJHeGlZV05yTzF4dUlDQjlYRzVjYmlBZ0x5OUdURTlYTFVsT09pQnRaWE56WVdkbElISmxZMlZwZG1Wa0lHWnliMjBnWVNCeVpXMXZkR1VnUkdGMFlVOWlhbVZqZENBdFBpQmZiMjVEYUdsc1pFTnlaV0YwWlZ4dUlDQmZiMjVTWlhOd2IyNXpaU2h0YzJjcElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnYkdWMElHVjJaVzUwSUQwZ2UxeHVJQ0FnSUNBZ2RIbHdaVG9nYlhObkxuUjVjR1VzWEc0Z0lDQWdJQ0IxY213NklHMXpaeTVpYjJSNUxuTnZkWEpqWlN4Y2JpQWdJQ0FnSUdOdlpHVTZJRzF6Wnk1aWIyUjVMbU52WkdWY2JpQWdJQ0I5TzF4dVhHNGdJQ0FnYVdZZ0tGOTBhR2x6TGw5dmJsSmxjM0J2Ym5ObFNHRnVaR3hsY2lrZ2UxeHVJQ0FnSUNBZ1gzUm9hWE11WDI5dVVtVnpjRzl1YzJWSVlXNWtiR1Z5S0dWMlpXNTBLVHRjYmlBZ0lDQjlYRzRnSUgxY2JseHVmVnh1WEc1bGVIQnZjblFnWkdWbVlYVnNkQ0JFWVhSaFQySnFaV04wUTJocGJHUTdYRzVjYmx4dVhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVpQXZMMXh1THk4Z0xpOXpjbU12YzNsdVkyaGxjaTlFWVhSaFQySnFaV04wUTJocGJHUXVhbk1pTENKcGJYQnZjblFnSjNCeWIzaDVMVzlpYzJWeWRtVW5PMXh1WEc1amIyNXpkQ0J2WW1wbFkzUlVlWEJsSUQwZ2UwRlNVa0ZaT2lBblcyOWlhbVZqZENCQmNuSmhlVjBuTENCUFFrcEZRMVE2SUNkYmIySnFaV04wSUU5aWFtVmpkRjBuSUgwN1hHNWNiaThxS2x4dUlDb2dRR0ZqWTJWemN5QndjbWwyWVhSbFhHNGdLaUJOWVdsdUlHTnNZWE56SUhSb1lYUWdiV0ZwYm5SaGFXNXpJR0VnU2xOUFRpQnZZbXBsWTNRc0lHRnVaQ0J2WW5ObGNuWmxjeUJqYUdGdVoyVnpJR2x1SUhSb2FYTWdiMkpxWldOMExDQnlaV04xY25OcGRtVnNlUzVjYmlBcUlFbHVkR1Z5Ym1Gc0lHOWlhbVZqZEhNZ1lXNWtJR0Z5Y21GNWN5QmhjbVVnWVd4emJ5QnZZbk5sY25abFpDNWNiaUFxTDF4dVkyeGhjM01nVTNsdVkwOWlhbVZqZENCN1hHNWNiaUFnWTI5dWMzUnlkV04wYjNJb2FXNXBkR2xoYkVSaGRHRXBJSHRjYmlBZ0lDQnNaWFFnWDNSb2FYTWdQU0IwYUdsek8xeHVYRzRnSUNBZ1gzUm9hWE11WDI5aWMyVnlkbVZ5Y3lBOUlGdGRPMXh1SUNBZ0lGOTBhR2x6TGw5bWFXeDBaWEp6SUQwZ2UzMDdYRzVjYmlBZ0lDQjBhR2x6TGw5a1lYUmhJRDBnYVc1cGRHbGhiRVJoZEdFZ2ZId2dlMzA3WEc1Y2JpQWdJQ0IwYUdsekxsOXBiblJsY201aGJFOWljMlZ5ZG1Vb2RHaHBjeTVmWkdGMFlTazdYRzRnSUgxY2JseHVJQ0JuWlhRZ1pHRjBZU2dwSUhzZ2NtVjBkWEp1SUhSb2FYTXVYMlJoZEdFN0lIMWNibHh1SUNCdlluTmxjblpsS0dOaGJHeGlZV05yS1NCN1hHNGdJQ0FnZEdocGN5NWZiMkp6WlhKMlpYSnpMbkIxYzJnb1kyRnNiR0poWTJzcE8xeHVJQ0I5WEc1Y2JpQWdabWx1WkNod1lYUm9LU0I3WEc0Z0lDQWdiR1YwSUd4cGMzUWdQU0J3WVhSb0xuTndiR2wwS0NjdUp5azdYRzVjYmlBZ0lDQnlaWFIxY200Z2RHaHBjeTVmWm1sdVpGZHBkR2hUY0d4cGRDaHNhWE4wS1R0Y2JpQWdmVnh1WEc0Z0lHWnBibVJDWldadmNtVW9jR0YwYUNrZ2UxeHVJQ0FnSUd4bGRDQnlaWE4xYkhRZ1BTQjdmVHRjYmlBZ0lDQnNaWFFnYkdsemRDQTlJSEJoZEdndWMzQnNhWFFvSnk0bktUdGNiaUFnSUNCeVpYTjFiSFF1YkdGemRDQTlJR3hwYzNRdWNHOXdLQ2s3WEc0Z0lDQWdjbVZ6ZFd4MExtOWlhaUE5SUhSb2FYTXVYMlpwYm1SWGFYUm9VM0JzYVhRb2JHbHpkQ2s3WEc1Y2JpQWdJQ0J5WlhSMWNtNGdjbVZ6ZFd4ME8xeHVJQ0I5WEc1Y2JpQWdYMlpwYm1SWGFYUm9VM0JzYVhRb2JHbHpkQ2tnZTF4dUlDQWdJR3hsZENCdlltb2dQU0IwYUdsekxsOWtZWFJoTzF4dUlDQWdJR3hwYzNRdVptOXlSV0ZqYUNnb2RtRnNkV1VwSUQwK0lIdGNiaUFnSUNBZ0lHOWlhaUE5SUc5aWFsdDJZV3gxWlYwN1hHNGdJQ0FnZlNrN1hHNWNiaUFnSUNCeVpYUjFjbTRnYjJKcU8xeHVJQ0I5WEc1Y2JpQWdYMmx1ZEdWeWJtRnNUMkp6WlhKMlpTaHZZbXBsWTNRcElIdGNibHh1SUNBZ0lHeGxkQ0JvWVc1a2JHVnlJRDBnS0dOb1lXNW5aWE5sZENrZ1BUNGdlMXh1WEc0Z0lDQWdJQ0JqYUdGdVoyVnpaWFF1WlhabGNua29LR05vWVc1blpTa2dQVDRnZTF4dUlDQWdJQ0FnSUNCMGFHbHpMbDl2YmtOb1lXNW5aWE1vWTJoaGJtZGxLVHRjYmlBZ0lDQWdJSDBwTzF4dVhHNGdJQ0FnZlR0Y2JseHVJQ0FnSUhSb2FYTXVYMlJoZEdFZ1BTQlBZbXBsWTNRdVpHVmxjRTlpYzJWeWRtVW9iMkpxWldOMExDQm9ZVzVrYkdWeUtUdGNibHh1SUNCOVhHNWNiaUFnWDJacGNtVkZkbVZ1ZENobGRtVnVkQ2tnZTF4dUlDQWdJSFJvYVhNdVgyOWljMlZ5ZG1WeWN5NW1iM0pGWVdOb0tDaGpZV3hzWW1GamF5a2dQVDRnZTF4dUlDQWdJQ0FnWTJGc2JHSmhZMnNvWlhabGJuUXBPMXh1SUNBZ0lIMHBPMXh1SUNCOVhHNWNiaUFnWDI5dVEyaGhibWRsY3loamFHRnVaMlVwSUh0Y2JseHVJQ0FnSUd4bGRDQnZZbW9nUFNCamFHRnVaMlV1YjJKcVpXTjBPMXh1SUNBZ0lHeGxkQ0J2WW1wVWVYQmxPMXh1WEc0Z0lDQWdhV1lnS0c5aWFpNWpiMjV6ZEhKMVkzUnZjaUE5UFQwZ1QySnFaV04wS1NCN1hHNGdJQ0FnSUNCdlltcFVlWEJsSUQwZ1QySnFaV04wVkhsd1pTNVBRa3BGUTFRN1hHNGdJQ0FnZlZ4dVhHNGdJQ0FnYVdZZ0tHOWlhaTVqYjI1emRISjFZM1J2Y2lBOVBUMGdRWEp5WVhrcElIdGNiaUFnSUNBZ0lHOWlhbFI1Y0dVZ1BTQlBZbXBsWTNSVWVYQmxMa0ZTVWtGWk8xeHVJQ0FnSUgxY2JseHVJQ0FnSUd4bGRDQm1hV1ZzWkZOMGNtbHVaeUE5SUdOb1lXNW5aUzVyWlhsd1lYUm9PMXh1WEc0Z0lDQWdMeThnWTI5dWMyOXNaUzVzYjJjb0owWnBaV3hrT2ljc0lHWnBaV3hrVTNSeWFXNW5LVHRjYmlBZ0lDQXZMeUJqYjI1emIyeGxMbXh2WnlnbmRIbHdaVG9uTENCamFHRnVaMlV1ZEhsd1pTazdYRzVjYmlBZ0lDQXZMMnhsZENCdmJHUldZV3gxWlNBOUlHTm9ZVzVuWlM1dmJHUldZV3gxWlR0Y2JpQWdJQ0JzWlhRZ2JtVjNWbUZzZFdVZ1BTQnZZbXBiWTJoaGJtZGxMbTVoYldWZE8xeHVYRzRnSUNBZ0x5OGdZMjl1YzI5c1pTNXBibVp2S0dOb1lXNW5aUzUwZVhCbElDc2dKeUI4SUVacFpXeGtPaUFuSUNzZ1ptbGxiR1JUZEhKcGJtY2dLeUFuSUh3Z1RtVjNJRlpoYkhWbE9pY3NJRXBUVDA0dWMzUnlhVzVuYVdaNUtHNWxkMVpoYkhWbEtTd2dabWxsYkdSVGRISnBibWN1YVc1amJIVmtaWE1vSjJ4bGJtZDBhQ2NwS1R0Y2JseHVJQ0FnSUdsbUlDaGphR0Z1WjJVdWRIbHdaU0E5UFQwZ0ozVndaR0YwWlNjZ0ppWWdJV1pwWld4a1UzUnlhVzVuTG1sdVkyeDFaR1Z6S0NjdWJHVnVaM1JvSnlrcElIdGNiaUFnSUNBZ0lIUm9hWE11WDJacGNtVkZkbVZ1ZENoN1hHNGdJQ0FnSUNBZ0lHTlVlWEJsT2lCRGFHRnVaMlZVZVhCbExsVlFSRUZVUlN4Y2JpQWdJQ0FnSUNBZ2IxUjVjR1U2SUc5aWFsUjVjR1VzWEc0Z0lDQWdJQ0FnSUdacFpXeGtPaUJtYVdWc1pGTjBjbWx1Wnl4Y2JpQWdJQ0FnSUNBZ1pHRjBZVG9nYm1WM1ZtRnNkV1ZjYmlBZ0lDQWdJSDBwTzF4dUlDQWdJSDFjYmx4dUlDQWdJR2xtSUNoamFHRnVaMlV1ZEhsd1pTQTlQVDBnSjJGa1pDY3BJSHRjYmlBZ0lDQWdJSFJvYVhNdVgyWnBjbVZGZG1WdWRDaDdYRzRnSUNBZ0lDQWdJR05VZVhCbE9pQkRhR0Z1WjJWVWVYQmxMa0ZFUkN4Y2JpQWdJQ0FnSUNBZ2IxUjVjR1U2SUc5aWFsUjVjR1VzWEc0Z0lDQWdJQ0FnSUdacFpXeGtPaUJtYVdWc1pGTjBjbWx1Wnl4Y2JpQWdJQ0FnSUNBZ1pHRjBZVG9nYm1WM1ZtRnNkV1ZjYmlBZ0lDQWdJSDBwTzF4dUlDQWdJSDFjYmx4dUlDQWdJR2xtSUNoamFHRnVaMlV1ZEhsd1pTQTlQVDBnSjJSbGJHVjBaU2NwSUh0Y2JpQWdJQ0FnSUhSb2FYTXVYMlpwY21WRmRtVnVkQ2g3WEc0Z0lDQWdJQ0FnSUdOVWVYQmxPaUJEYUdGdVoyVlVlWEJsTGxKRlRVOVdSU3hjYmlBZ0lDQWdJQ0FnYjFSNWNHVTZJRzlpYWxSNWNHVXNYRzRnSUNBZ0lDQWdJR1pwWld4a09pQm1hV1ZzWkZOMGNtbHVaMXh1SUNBZ0lDQWdmU2s3WEc0Z0lDQWdmVnh1SUNCOVhHNWNibjFjYmx4dVpYaHdiM0owSUd4bGRDQkRhR0Z1WjJWVWVYQmxJRDBnZTFWUVJFRlVSVG9nSjNWd1pHRjBaU2NzSUVGRVJEb2dKMkZrWkNjc0lGSkZUVTlXUlRvZ0ozSmxiVzkyWlNkOU8xeHVaWGh3YjNKMElHeGxkQ0JQWW1wbFkzUlVlWEJsSUQwZ2UwOUNTa1ZEVkRvZ0oyOWlhbVZqZENjc0lFRlNVa0ZaT2lBbllYSnlZWGtuZlR0Y2JtVjRjRzl5ZENCa1pXWmhkV3gwSUZONWJtTlBZbXBsWTNRN1hHNWNibHh1WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWlBdkwxeHVMeThnTGk5emNtTXZjM2x1WTJobGNpOVFjbTk0ZVU5aWFtVmpkQzVxY3lJc0lsd2lkWE5sSUhOMGNtbGpkRndpTzF4dVhHNWxlSEJ2Y25SekxsOWZaWE5OYjJSMWJHVWdQU0IwY25WbE8xeHVYRzUyWVhJZ1gyZGxkRkJ5YjNSdmRIbHdaVTltSUQwZ2NtVnhkV2x5WlNoY0lpNHVMMk52Y21VdGFuTXZiMkpxWldOMEwyZGxkQzF3Y205MGIzUjVjR1V0YjJaY0lpazdYRzVjYm5aaGNpQmZaMlYwVUhKdmRHOTBlWEJsVDJZeUlEMGdYMmx1ZEdWeWIzQlNaWEYxYVhKbFJHVm1ZWFZzZENoZloyVjBVSEp2ZEc5MGVYQmxUMllwTzF4dVhHNTJZWElnWDJkbGRFOTNibEJ5YjNCbGNuUjVSR1Z6WTNKcGNIUnZjaUE5SUhKbGNYVnBjbVVvWENJdUxpOWpiM0psTFdwekwyOWlhbVZqZEM5blpYUXRiM2R1TFhCeWIzQmxjblI1TFdSbGMyTnlhWEIwYjNKY0lpazdYRzVjYm5aaGNpQmZaMlYwVDNkdVVISnZjR1Z5ZEhsRVpYTmpjbWx3ZEc5eU1pQTlJRjlwYm5SbGNtOXdVbVZ4ZFdseVpVUmxabUYxYkhRb1gyZGxkRTkzYmxCeWIzQmxjblI1UkdWelkzSnBjSFJ2Y2lrN1hHNWNibVoxYm1OMGFXOXVJRjlwYm5SbGNtOXdVbVZ4ZFdseVpVUmxabUYxYkhRb2IySnFLU0I3SUhKbGRIVnliaUJ2WW1vZ0ppWWdiMkpxTGw5ZlpYTk5iMlIxYkdVZ1B5QnZZbW9nT2lCN0lHUmxabUYxYkhRNklHOWlhaUI5T3lCOVhHNWNibVY0Y0c5eWRITXVaR1ZtWVhWc2RDQTlJR1oxYm1OMGFXOXVJR2RsZENodlltcGxZM1FzSUhCeWIzQmxjblI1TENCeVpXTmxhWFpsY2lrZ2UxeHVJQ0JwWmlBb2IySnFaV04wSUQwOVBTQnVkV3hzS1NCdlltcGxZM1FnUFNCR2RXNWpkR2x2Ymk1d2NtOTBiM1I1Y0dVN1hHNGdJSFpoY2lCa1pYTmpJRDBnS0RBc0lGOW5aWFJQZDI1UWNtOXdaWEowZVVSbGMyTnlhWEIwYjNJeUxtUmxabUYxYkhRcEtHOWlhbVZqZEN3Z2NISnZjR1Z5ZEhrcE8xeHVYRzRnSUdsbUlDaGtaWE5qSUQwOVBTQjFibVJsWm1sdVpXUXBJSHRjYmlBZ0lDQjJZWElnY0dGeVpXNTBJRDBnS0RBc0lGOW5aWFJRY205MGIzUjVjR1ZQWmpJdVpHVm1ZWFZzZENrb2IySnFaV04wS1R0Y2JseHVJQ0FnSUdsbUlDaHdZWEpsYm5RZ1BUMDlJRzUxYkd3cElIdGNiaUFnSUNBZ0lISmxkSFZ5YmlCMWJtUmxabWx1WldRN1hHNGdJQ0FnZlNCbGJITmxJSHRjYmlBZ0lDQWdJSEpsZEhWeWJpQm5aWFFvY0dGeVpXNTBMQ0J3Y205d1pYSjBlU3dnY21WalpXbDJaWElwTzF4dUlDQWdJSDFjYmlBZ2ZTQmxiSE5sSUdsbUlDaGNJblpoYkhWbFhDSWdhVzRnWkdWell5a2dlMXh1SUNBZ0lISmxkSFZ5YmlCa1pYTmpMblpoYkhWbE8xeHVJQ0I5SUdWc2MyVWdlMXh1SUNBZ0lIWmhjaUJuWlhSMFpYSWdQU0JrWlhOakxtZGxkRHRjYmx4dUlDQWdJR2xtSUNoblpYUjBaWElnUFQwOUlIVnVaR1ZtYVc1bFpDa2dlMXh1SUNBZ0lDQWdjbVYwZFhKdUlIVnVaR1ZtYVc1bFpEdGNiaUFnSUNCOVhHNWNiaUFnSUNCeVpYUjFjbTRnWjJWMGRHVnlMbU5oYkd3b2NtVmpaV2wyWlhJcE8xeHVJQ0I5WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMmhsYkhCbGNuTXZaMlYwTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeE1qVmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SWl3aUx5b3FYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRkJVSUVsdWIzWmh3NmZEbzI4Z1pTQlRhWE4wWlcxaGN5QlRRVnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJKVGtWVFF5MUpSRnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJSVlU5Q1NWTWdUa1ZVVjA5U1MxTWdVMHhjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnUmxKQlZVNUlUMFpGVWkxSFJWTkZURXhUUTBoQlJsUWdXbFZTSUVaUFJWSkVSVkpWVGtjZ1JFVlNJRUZPUjBWWFFVNUVWRVZPSUVaUFVsTkRTRlZPUnlCRkxsWmNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdUMUpCVGtkRklGTkJYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRVJsZFhSelkyaGxJRlJsYkdWcmIyMGdRVWRjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnUVhCcGVtVmxYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRlJGUTBoT1NWTkRTRVVnVlU1SlZrVlNVMGxVUVZRZ1FrVlNURWxPWEc0cVhHNHFJRXhwWTJWdWMyVmtJSFZ1WkdWeUlIUm9aU0JCY0dGamFHVWdUR2xqWlc1elpTd2dWbVZ5YzJsdmJpQXlMakFnS0hSb1pTQmNJa3hwWTJWdWMyVmNJaWs3WEc0cUlIbHZkU0J0WVhrZ2JtOTBJSFZ6WlNCMGFHbHpJR1pwYkdVZ1pYaGpaWEIwSUdsdUlHTnZiWEJzYVdGdVkyVWdkMmwwYUNCMGFHVWdUR2xqWlc1elpTNWNiaW9nV1c5MUlHMWhlU0J2WW5SaGFXNGdZU0JqYjNCNUlHOW1JSFJvWlNCTWFXTmxibk5sSUdGMFhHNHFYRzRxSUNBZ2FIUjBjRG92TDNkM2R5NWhjR0ZqYUdVdWIzSm5MMnhwWTJWdWMyVnpMMHhKUTBWT1UwVXRNaTR3WEc0cVhHNHFJRlZ1YkdWemN5QnlaWEYxYVhKbFpDQmllU0JoY0hCc2FXTmhZbXhsSUd4aGR5QnZjaUJoWjNKbFpXUWdkRzhnYVc0Z2QzSnBkR2x1Wnl3Z2MyOW1kSGRoY21WY2Jpb2daR2x6ZEhKcFluVjBaV1FnZFc1a1pYSWdkR2hsSUV4cFkyVnVjMlVnYVhNZ1pHbHpkSEpwWW5WMFpXUWdiMjRnWVc0Z1hDSkJVeUJKVTF3aUlFSkJVMGxUTEZ4dUtpQlhTVlJJVDFWVUlGZEJVbEpCVGxSSlJWTWdUMUlnUTA5T1JFbFVTVTlPVXlCUFJpQkJUbGtnUzBsT1JDd2daV2wwYUdWeUlHVjRjSEpsYzNNZ2IzSWdhVzF3YkdsbFpDNWNiaW9nVTJWbElIUm9aU0JNYVdObGJuTmxJR1p2Y2lCMGFHVWdjM0JsWTJsbWFXTWdiR0Z1WjNWaFoyVWdaMjkyWlhKdWFXNW5JSEJsY20xcGMzTnBiMjV6SUdGdVpGeHVLaUJzYVcxcGRHRjBhVzl1Y3lCMWJtUmxjaUIwYUdVZ1RHbGpaVzV6WlM1Y2Jpb3FMMXh1WEc1cGJYQnZjblFnUkdGMFlVOWlhbVZqZEZKbGNHOXlkR1Z5SUdaeWIyMGdKeTR2UkdGMFlVOWlhbVZqZEZKbGNHOXlkR1Z5Snp0Y2JtbHRjRzl5ZENCRVlYUmhUMkpxWldOMFQySnpaWEoyWlhJZ1puSnZiU0FuTGk5RVlYUmhUMkpxWldOMFQySnpaWEoyWlhJbk8xeHVhVzF3YjNKMElFUmhkR0ZRY205MmFYTnBiMjVoYkNCbWNtOXRJQ2N1TDBSaGRHRlFjbTkyYVhOcGIyNWhiQ2M3WEc1Y2JpOHFLbHh1S2lCVWFHVWdiV0ZwYmlCamJHRnpjeUJtYjNJZ2RHaGxJSE41Ym1Ob1pYSWdjR0ZqYTJGblpTNWNiaW9nVkdobElGTjVibU5vWlhJZ2FYTWdZU0J6YVc1bmJHVjBiMjRnWTJ4aGMzTWdjR1Z5SUVoNWNHVnlkSGt2VlZKTUlHRnVaQ0JwZENCcGN5QjBhR1VnYjNkdVpYSWdiMllnWVd4c0lHTnlaV0YwWldRZ1JHRjBZU0JUZVc1aklFOWlhbVZqZEhNZ1lXTmpiM0prYVc1bklIUnZJSFJvWlNCU1pYQnZjblJsY2lBdElFOWljMlZ5ZG1WeUlIQmhkSFJsY200dVhHNHFJRTFoYVc0Z1puVnVZM1JwYjI1aGJHbDBlU0JwY3lCMGJ5QmpjbVZoZEdVZ2NtVndiM0owWlhKeklHRnVaQ0IwYnlCemRXSnpZM0pwWW1VZ2RHOGdaWGhwYzNScGJtY2diMjVsY3k1Y2Jpb3ZYRzVqYkdGemN5QlRlVzVqYUdWeUlIdGNiaUFnTHlvZ2NISnBkbUYwWlZ4dUlDQmZiM2R1WlhJNklGVlNURnh1SUNCZlluVnpPaUJOYVc1cFFuVnpYRzVjYmlBZ1gzTjFZbFZTVERvZ1ZWSk1YRzVjYmlBZ1gzSmxjRzl5ZEdWeWN6b2dQSFZ5YkRvZ1JHRjBZVTlpYW1WamRGSmxjRzl5ZEdWeVBseHVJQ0JmYjJKelpYSjJaWEp6T2lBOGRYSnNPaUJFWVhSaFQySnFaV04wVDJKelpYSjJaWEkrWEc0Z0lGOXdjbTkyYVhOcGIyNWhiSE02SUR4MWNtdzZJRVJoZEdGUWNtOTJhWE5wYjI1aGJENWNibHh1SUNBdExTMHRaWFpsYm5RZ2FHRnVaR3hsY25NdExTMHRYRzRnSUY5dmJrNXZkR2xtYVdOaGRHbHZia2hoYm1Sc1pYSTZJQ2hsZG1WdWRDa2dQVDRnZG05cFpGeHVJQ0JmYjI1U1pYTjFiV1U2SUNobGRtVnVkQ2tnUFQ0Z2RtOXBaRnh1SUNBcUwxeHVYRzRnSUM4cUtseHVJQ0FxSUVOdmJuTjBjblZqZEc5eUlIUm9ZWFFnYzJodmRXeGtJR0psSUhWelpXUWdZbmtnZEdobElFaDVjR1Z5ZEhrZ2IzZHVaWEpjYmlBZ0tpQkFjR0Z5WVcwZ2UwaDVjR1Z5ZEhsVlVreDlJRzkzYm1WeUlDMGdTSGx3WlhKMGVTQlZVa3dnYjNkdVpYSXVJRUZ1SUZWU1RDQmhiR3h2WTJGMFpXUWdZbmtnZEdobElISjFiblJwYldVZ2RHaGhkQ0IxYm1seGRXVnNlU0JwWkdWdWRHbG1hV1Z6SUhSb1pTQkllWEJsY25SNUxseHVJQ0FxSUVCd1lYSmhiU0I3VFdsdWFVSjFjMzBnWW5WeklDMGdRVzRnYVc1emRHRnVZMlVnYjJZZ2RHaGxJRTFwYm1sQ2RYTWdjSEp2ZG1sa1pXUWdhVzRnZEdobElITmhibVJpYjNndUlGZG9aVzRnWVc0Z2IySnFaV04wSUNoU1pYQnZjblJsY2lCdmNpQlBZbk5sY25abFpDa2dhWE1nWTNKbFlYUmxaQ3dnZEdobElGTjVibU5vWlhKTllXNWhaMlZ5SUhkcGJHd2dZV1JrSUdFZ2JHbHpkR1Z1WlhJZ2FXNGdkR2hsSUUxcGJtbENkWE1nZEc4Z2NtVmpaV2wyWlM5elpXNWtJRTFsYzNOaFoyVnpJRzltSUhSb1lYUWdiMkpxWldOMExseHVJQ0FxSUVCd1lYSmhiU0I3U2xOUFRuMGdZMjl1Wm1sbklDMGdRMjl1Wm1sbmRYSmhkR2x2YmlCa1lYUmhMaUJVYUdVZ2IyNXNlU0J5WlhGMWFYSmxaQ0JtYVdWc1pDQm1iM0lnYm05M0lHbHpJSFJvWlNCeWRXNTBhVzFsVlZKTUxseHVJQ0FxTDF4dUlDQmpiMjV6ZEhKMVkzUnZjaWh2ZDI1bGNpd2dZblZ6TENCamIyNW1hV2NwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdYM1JvYVhNdVgyOTNibVZ5SUQwZ2IzZHVaWEk3WEc0Z0lDQWdYM1JvYVhNdVgySjFjeUE5SUdKMWN6dGNibHh1SUNBZ0lGOTBhR2x6TGw5emRXSlZVa3dnUFNCamIyNW1hV2N1Y25WdWRHbHRaVlZTVENBcklDY3ZjMjBuTzF4dVhHNGdJQ0FnWDNSb2FYTXVYM0psY0c5eWRHVnljeUE5SUh0OU8xeHVJQ0FnSUY5MGFHbHpMbDl2WW5ObGNuWmxjbk1nUFNCN2ZUdGNiaUFnSUNCZmRHaHBjeTVmY0hKdmRtbHphVzl1WVd4eklEMGdlMzA3WEc1Y2JpQWdJQ0JpZFhNdVlXUmtUR2x6ZEdWdVpYSW9iM2R1WlhJc0lDaHRjMmNwSUQwK0lIdGNiaUFnSUNBZ0lDOHZhV2R1YjNKbElHMXpaeUJ6Wlc1MElHSjVJR2hwYlhObGJHWmNiaUFnSUNBZ0lHbG1JQ2h0YzJjdVpuSnZiU0FoUFQwZ2IzZHVaWElwSUh0Y2JpQWdJQ0FnSUNBZ1kyOXVjMjlzWlM1cGJtWnZLQ2RiVTNsdVkyaGxjbDBnVTNsdVkyaGxjaTFTUTFZNklDY3NJRzF6WnlrN1hHNGdJQ0FnSUNBZ0lITjNhWFJqYUNBb2JYTm5MblI1Y0dVcElIdGNiaUFnSUNBZ0lDQWdJQ0JqWVhObElDZG1iM0ozWVhKa0p6b2dYM1JvYVhNdVgyOXVSbTl5ZDJGeVpDaHRjMmNwT3lCaWNtVmhhenRjYmlBZ0lDQWdJQ0FnSUNCallYTmxJQ2RqY21WaGRHVW5PaUJmZEdocGN5NWZiMjVTWlcxdmRHVkRjbVZoZEdVb2JYTm5LVHNnWW5KbFlXczdYRzRnSUNBZ0lDQWdJQ0FnWTJGelpTQW5aR1ZzWlhSbEp6b2dYM1JvYVhNdVgyOXVVbVZ0YjNSbFJHVnNaWFJsS0cxelp5azdJR0p5WldGck8xeHVJQ0FnSUNBZ0lDQjlYRzRnSUNBZ0lDQjlYRzRnSUNBZ2ZTazdYRzRnSUgxY2JseHVJQ0F2S2lwY2JpQWdLaUJVYUdVZ2IzZHVaWElnYjJZZ2RHaGxJRk41Ym1Ob1pYSWdZVzVrSUdGc2JDQmpjbVZoZEdWa0lISmxjRzl5ZEdWeWN5NWNiaUFnS2lCQWRIbHdaU0I3U0hsd1pYSjBlVlZTVEgxY2JpQWdLaTljYmlBZ1oyVjBJRzkzYm1WeUtDa2dleUJ5WlhSMWNtNGdkR2hwY3k1ZmIzZHVaWEk3SUgxY2JseHVJQ0F2S2lwY2JpQWdLaUJCYkd3Z2IzZHVaV1FnY21Wd2IzSjBaWEp6TENCMGFHVWdiMjVsY3lCMGFHRjBJSGRsY21VZ1kzSmxZWFJsWkNCaWVTQmhJR055WldGMFpWeHVJQ0FxSUVCMGVYQmxJSHRQWW1wbFkzUThWVkpNTENCRVlYUmhUMkpxWldOMFVtVndiM0owWlhJK2ZWeHVJQ0FxTDF4dUlDQm5aWFFnY21Wd2IzSjBaWEp6S0NrZ2V5QnlaWFIxY200Z2RHaHBjeTVmY21Wd2IzSjBaWEp6T3lCOVhHNWNiaUFnTHlvcVhHNGdJQ29nUVd4c0lHOTNibVZrSUc5aWMyVnlkbVZ5Y3l3Z2RHaGxJRzl1WlhNZ2RHaGhkQ0IzWlhKbElHTnlaV0YwWldRZ1lua2dZU0JzYjJOaGJDQnpkV0p6WTNKcGNIUnBiMjVjYmlBZ0tpQkFkSGx3WlNCN1QySnFaV04wUEZWU1RDd2dSR0YwWVU5aWFtVmpkRTlpYzJWeWRtVnlQbjFjYmlBZ0tpOWNiaUFnWjJWMElHOWljMlZ5ZG1WeWN5Z3BJSHNnY21WMGRYSnVJSFJvYVhNdVgyOWljMlZ5ZG1WeWN6c2dmVnh1WEc0Z0lDOHFLbHh1SUNBcUlGSmxjWFZsYzNRZ1lTQkVZWFJoVDJKcVpXTjBVbVZ3YjNKMFpYSWdZM0psWVhScGIyNHVJRlJvWlNCVlVrd2dkMmxzYkNCaVpTQmlaU0J5WlhGMVpYTjBaV1FnWW5rZ2RHaGxJR0ZzYkc5allYUnBiMjRnYldWamFHRnVhWE50TGx4dUlDQXFJRUJ3WVhKaGJTQWdlMU5qYUdWdFlWVlNUSDBnYzJOb1pXMWhJQzBnU0hsd1pYSjBlU0JEWVhSaGJHOW5kV1VnVlZKTUlHRmtaSEpsYzNNZ2RHaGhkQ0JqWVc0Z1ltVWdkWE5sWkNCMGJ5QnlaWFJ5YVdWMlpTQjBhR1VnU2xOUFRpMVRZMmhsYldFZ1pHVnpZM0pwWW1sdVp5QjBhR1VnUkdGMFlTQlBZbXBsWTNRZ2MyTm9aVzFoWEc0Z0lDb2dRSEJoY21GdElDQjdTSGx3WlhKMGVWVlNURnRkZlNCdlluTmxjblpsY25NZ0xTQk1hWE4wSUc5bUlHaDVjR1Z5ZEdsbGN5QjBhR0YwSUdGeVpTQndjbVV0WVhWMGFHOXlhWHBsWkNCbWIzSWdjM1ZpYzJOeWFYQjBhVzl1WEc0Z0lDb2dRSEJoY21GdElDQjdTbE5QVG4wZ2FXNXBkR2xoYkVSaGRHRWdMU0JKYm1sMGFXRnNJR1JoZEdFZ2IyWWdkR2hsSUhKbGNHOXlkR1Z5WEc0Z0lDb2dRSEJoY21GdElDQjdZbTl2YkdWaGJuMGdjM1J2Y21VZ0xTQW9UM0IwYVc5dVlXd3BJR2xtSUhSeWRXVXNJRzlpYW1WamRDQjNhV3hzSUdKbElITjBiM0psWkNCaWVTQjBhR1VnY25WdWRHbHRaVnh1SUNBcUlFQndZWEpoYlNBZ2UySnZiMnhsWVc1OUlIQXljQ0F0SUNoUGNIUnBiMjVoYkNrZ2FXWWdkSEoxWlN3Z1pHRjBZU0J6ZVc1amFISnZibWx6WVhScGIyNGdjM1J5WldGdElIZHBiR3dnZFhObElIQXljQ0JqYjI1dVpXTjBhVzl1SUdGeklHMTFZMmdnWVhNZ2NHOXpjMmxpYkdWY2JpQWdLaUJBY0dGeVlXMGdJSHROWlhOellXZGxRbTlrZVVsa1pXNTBhWFI1ZlNCcFpHVnVkR2wwZVNBdElDaHZjSFJwYjI1aGJDa2dhV1JsYm5ScGRIa2daR0YwWVNCMGJ5QmlaU0JoWkdSbFpDQjBieUJwWkdWdWRHbDBlU0IwYUdVZ2RYTmxjaUJ5WlhCdmNuUmxjaTRnVkc4Z1ltVWdkWE5sWkNCbWIzSWdiR1ZuWVdONUlHbGtaVzUwYVhScFpYTXVYRzRnSUNvZ1FISmxkSFZ5YmlCN1VISnZiV2x6WlR4RVlYUmhUMkpxWldOMFVtVndiM0owWlhJK2ZTQlNaWFIxY200Z1VISnZiV2x6WlNCMGJ5QmhJRzVsZHlCU1pYQnZjblJsY2k0Z1ZHaGxJSEpsY0c5eWRHVnlJR05oYmlCaVpTQmhZMk5sY0hSbFpDQnZjaUJ5WldwbFkzUmxaQ0JpZVNCMGFHVWdVRVZRWEc0Z0lDb3ZYRzRnSUdOeVpXRjBaU2h6WTJobGJXRXNJRzlpYzJWeWRtVnljeXdnYVc1cGRHbGhiRVJoZEdFc0lITjBiM0psSUQwZ1ptRnNjMlVzSUhBeWNDQTlJR1poYkhObExDQnBaR1Z1ZEdsMGVTa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNGdJQ0FnYkdWMElHTnlhWFJsY21saElEMGdlMzA3WEc1Y2JpQWdJQ0JqY21sMFpYSnBZUzV3TW5BZ1BTQndNbkE3WEc0Z0lDQWdZM0pwZEdWeWFXRXVjM1J2Y21VZ1BTQnpkRzl5WlR0Y2JpQWdJQ0JqY21sMFpYSnBZUzV6WTJobGJXRWdQU0J6WTJobGJXRTdYRzRnSUNBZ1kzSnBkR1Z5YVdFdWIySnpaWEoyWlhKeklEMGdiMkp6WlhKMlpYSnpPMXh1SUNBZ0lHTnlhWFJsY21saExtbHVhWFJwWVd4RVlYUmhJRDBnYVc1cGRHbGhiRVJoZEdFN1hHNWNiaUFnSUNCcFppQW9hV1JsYm5ScGRIa3BJQ0FnSUNBZ2V5QmpjbWwwWlhKcFlTNXBaR1Z1ZEdsMGVTQTlJR2xrWlc1MGFYUjVPeUI5WEc1Y2JpQWdJQ0JqYjI1emIyeGxMbXh2WnlnblczTjVibU5vWlhJZ0xTQmpjbVZoZEdWZElDMGdZM0psWVhSbElGSmxjRzl5ZEdWeUlDMGdZM0pwZEdWeWFXRTZJQ2NzSUdOeWFYUmxjbWxoS1R0Y2JseHVJQ0FnSUU5aWFtVmpkQzVoYzNOcFoyNG9ZM0pwZEdWeWFXRXNJSHR5WlhOMWJXVTZJR1poYkhObGZTazdYRzVjYmlBZ0lDQnlaWFIxY200Z1gzUm9hWE11WDJOeVpXRjBaU2hqY21sMFpYSnBZU2s3WEc0Z0lIMWNibHh1SUNCeVpYTjFiV1ZTWlhCdmNuUmxjbk1vWTNKcGRHVnlhV0VwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1SUNBZ0lHTnZibk52YkdVdWJHOW5LQ2RiYzNsdVkyaGxjaUF0SUdOeVpXRjBaVjBnTFNCeVpYTjFiV1VnVW1Wd2IzSjBaWElnTFNCamNtbDBaWEpwWVRvZ0p5d2dZM0pwZEdWeWFXRXBPMXh1WEc0Z0lDQWdUMkpxWldOMExtRnpjMmxuYmloamNtbDBaWEpwWVN3Z2UzSmxjM1Z0WlRvZ2RISjFaWDBwTzF4dVhHNGdJQ0FnY21WMGRYSnVJRjkwYUdsekxsOWpjbVZoZEdVb1kzSnBkR1Z5YVdFcE8xeHVJQ0I5WEc1Y2JpQWdMeW9xWEc0Z0lDb2dVbVZ4ZFdWemRDQmhJSE4xWW5OamNtbHdkR2x2YmlCMGJ5QmhiaUJsZUdsemRHVnVkQ0J5WlhCdmNuUmxjaUJ2WW1wbFkzUXVYRzRnSUNvZ1FIQmhjbUZ0SUh0VFkyaGxiV0ZWVWt4OUlITmphR1Z0WVNBdElFaDVjR1Z5ZEhrZ1EyRjBZV3h2WjNWbElGVlNUQ0JoWkdSeVpYTnpJSFJvWVhRZ1kyRnVJR0psSUhWelpXUWdkRzhnY21WMGNtbGxkbVVnZEdobElFcFRUMDR0VTJOb1pXMWhJR1JsYzJOeWFXSnBibWNnZEdobElFUmhkR0VnVDJKcVpXTjBJSE5qYUdWdFlWeHVJQ0FxSUVCd1lYSmhiU0I3VDJKcVpXTjBWVkpNZlNCdlltcFZVa3dnTFNCQlpHUnlaWE56SUc5bUlIUm9aU0JsZUdsemRHVnVkQ0J5WlhCdmNuUmxjaUJ2WW1wbFkzUWdkRzhnWW1VZ2IySnpaWEoyWldSY2JpQWdLaUJBY0dGeVlXMGdlMEp2YjJ4bFlXNTlJRnR6ZEc5eVpUMW1ZV3h6WlYwZ0xTQlRZWFpsSUhSb1pTQnpkV0p6WTNKcGNIUnBiMjRnYjI0Z2RHaGxJRk41Ym1Ob1pYSWdUV0Z1WVdkbGNpQm1iM0lnWm5WeWRHaGxjaUJ5WlhOMWJXVWdLRVJsWm1GMWJIUWdhWE1nWm1Gc2MyVXBYRzRnSUNvZ1FIQmhjbUZ0SUh0Q2IyOXNaV0Z1ZlNCYmNESndQV1poYkhObFhTQXRJRWx1Wm04Z1lXSnZkWFFnYVdZZ2MyaHZkV3hrSUhWelpTQndNbkFnWTI5dWJtVmpkR2x2YmlBb1JHVm1ZWFZzZENCcGN5Qm1ZV3h6WlNsY2JpQWdLaUJBY0dGeVlXMGdlMEp2YjJ4bFlXNTlJRnR0ZFhSMVlXdzlkSEoxWlYwZ0xTQkpibVp2SUdGaWIzVjBJR2xtSUcxbGMzTmhaMlZ6SUc5bUlIUm9hWE1nYjJKcVpXTjBJSE5vYjNWc1pDQmlaU0JsYm1OeWVYQjBaV1FnS0VSbFptRjFiSFFnYVhNZ2RISjFaU2xjYmlBZ0tpQkFjR0Z5WVcwZ0lIdE5aWE56WVdkbFFtOWtlVWxrWlc1MGFYUjVmU0JwWkdWdWRHbDBlU0F0SUNodmNIUnBiMjVoYkNrZ2FXUmxiblJwZEhrZ1pHRjBZU0IwYnlCaVpTQmhaR1JsWkNCMGJ5QnBaR1Z1ZEdsMGVTQjBhR1VnZFhObGNpQnlaWEJ2Y25SbGNpNGdWRzhnWW1VZ2RYTmxaQ0JtYjNJZ2JHVm5ZV041SUdsa1pXNTBhWFJwWlhNdVhHNGdJQ29nUUhKbGRIVnliaUI3VUhKdmJXbHpaVHhFWVhSaFQySnFaV04wVDJKelpYSjJaWEkrZlNCU1pYUjFjbTRnVUhKdmJXbHpaU0IwYnlCaElHNWxkeUJ2WW5ObGNuWmxjaTRnU1hRbmN5QmhjM052WTJsaGRHVmtJSGRwZEdnZ2RHaGxJSEpsY0c5eWRHVnlMbHh1SUNBcUwxeHVJQ0J6ZFdKelkzSnBZbVVvYzJOb1pXMWhMQ0J2WW1wVlVrd3NJSE4wYjNKbElEMGdabUZzYzJVc0lIQXljQ0E5SUdaaGJITmxMQ0J0ZFhSMVlXd2dQU0IwY25WbExDQnBaR1Z1ZEdsMGVTa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNGdJQ0FnYkdWMElHTnlhWFJsY21saElEMGdlMzA3WEc1Y2JpQWdJQ0JqY21sMFpYSnBZUzV3TW5BZ1BTQndNbkE3WEc0Z0lDQWdZM0pwZEdWeWFXRXVjM1J2Y21VZ1BTQnpkRzl5WlR0Y2JpQWdJQ0JqY21sMFpYSnBZUzV6WTJobGJXRWdQU0J6WTJobGJXRTdYRzVjYmlBZ0lDQmpjbWwwWlhKcFlTNXlaWE52ZFhKalpTQTlJRzlpYWxWU1REdGNiaUFnSUNCcFppQW9hV1JsYm5ScGRIa3BJQ0FnSUNBZ2V5QmpjbWwwWlhKcFlTNXBaR1Z1ZEdsMGVTQTlJR2xrWlc1MGFYUjVPeUI5WEc1Y2JpQWdJQ0F2TDFSUFJFODZJRVp2Y2lCR2RYSjBhR1Z5SUZOMGRXUjVYRzRnSUNBZ1kzSnBkR1Z5YVdFdWJYVjBkV0ZzSUQwZ2JYVjBkV0ZzTzF4dVhHNGdJQ0FnWTI5dWMyOXNaUzVzYjJjb0oxdHplVzVqYUdWeUlDMGdjM1ZpYzJOeWFXSmxYU0F0SUhOMVluTmpjbWxpWlNCamNtbDBaWEpwWVRvZ0p5d2dZM0pwZEdWeWFXRXBPMXh1WEc0Z0lDQWdUMkpxWldOMExtRnpjMmxuYmloamNtbDBaWEpwWVN3Z2UzSmxjM1Z0WlRvZ1ptRnNjMlY5S1R0Y2JseHVJQ0FnSUhKbGRIVnliaUJmZEdocGN5NWZjM1ZpYzJOeWFXSmxLR055YVhSbGNtbGhLVHRjYmlBZ2ZWeHVYRzRnSUM4cUtseHVJQ0FxSUZKbGNYVmxjM1FnWVNCemRXSnpZM0pwY0hScGIyNGdkRzhnWVc0Z1pYaHBjM1JsYm5RZ2NtVndiM0owWlhJZ2IySnFaV04wTGx4dUlDQXFJRUJ3WVhKaGJTQjdZM0pwZEdWeWFXRjlJR055YVhSbGNtbGhJQzBnU1c1bWIzSnRZWFJwYjI0Z2RHOGdaR2x6WTI5MlpYSjVJSFJvWlNCdlluTmxjblpsY2lCdlltcGxZM1JjYmlBZ0tpQkFjbVYwZFhKdUlIdFFjbTl0YVhObFBFUmhkR0ZQWW1wbFkzUlBZbk5sY25abGNqNTlJRkpsZEhWeWJpQlFjbTl0YVhObElIUnZJR0VnYm1WM0lHOWljMlZ5ZG1WeUxpQkpkQ2R6SUdGemMyOWphV0YwWldRZ2QybDBhQ0IwYUdVZ2NtVndiM0owWlhJdVhHNGdJQ292WEc0Z0lISmxjM1Z0WlU5aWMyVnlkbVZ5Y3loamNtbDBaWEpwWVNrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc0Z0lDQWdiR1YwSUY5amNtbDBaWEpwWVNBOUlHTnlhWFJsY21saElIeDhJSHQ5TzF4dVhHNGdJQ0FnVDJKcVpXTjBMbUZ6YzJsbmJpaGZZM0pwZEdWeWFXRXNJSHR5WlhOMWJXVTZJSFJ5ZFdWOUtUdGNibHh1SUNBZ0lISmxkSFZ5YmlCZmRHaHBjeTVmYzNWaWMyTnlhV0psS0Y5amNtbDBaWEpwWVNrN1hHNGdJSDFjYmx4dUlDQXZLaXBjYmlBZ0tpQlNaWEYxWlhOMElHRWdjbVZoWkNCaFkzUnBiMjRnYjI0Z2RHaGxJSEpsY0c5eWRHVnlJRzlpYW1WamRGeHVJQ0FxSUVCd1lYSmhiU0I3VDJKcVpXTjBWVkpNZlNCdlltcFZVa3dnTFNCVlVrd2diMllnZEdobElISmxjRzl5ZEdWeUlHOWlhbVZqZENCMGJ5QmlaU0J5WldGa1hHNGdJQ29nUUhKbGRIVnliaUI3VUhKdmJXbHpaVHhQWW1wbFkzUStmU0JTWlhSMWNtNGdVSEp2YldselpTQjBieUJzWVhOMElHRjJZV2xzWVdKc1pTQmtZWFJoSUc5bUlIUm9aU0J5WlhCdmNuUmxjbHh1SUNBcUwxeHVJQ0J5WldGa0tHOWlhbFZTVENrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQ0F2TDBaTVQxY3RUMVZVT2lCMGFHbHpJRzFsYzNOaFoyVWdkMmxzYkNCaVpTQnpaVzUwSUdScGNtVmpkR3g1SUhSdklISmxjRzl5ZEdWeUlHOWlhbVZqZENBb2JXRjVZbVVnZEdobGNtVWdhWE1nYm04Z2JHbHpkR1Z1WlhJZ1lYWmhhV3hoWW14bExDQnpieUJwZENCM2FXeHNJR0psSUhKbGMyOXNkbVZrSUhkcGRHZ2dUV1Z6YzJGblpVSjFjeUF0UGlCeVpYTnZiSFpsS1Z4dUlDQWdJQzh2ZDJsc2JDQnlaV0ZqYUNCMGFHVWdjbVZ0YjNSbElHOWlhbVZqZENCcGJpQkVZWFJoVDJKcVpXTjBVbVZ3YjNKMFpYSWdMVDRnWDI5dVVtVmhaRnh1SUNBZ0lHeGxkQ0J5WldGa1RYTm5JRDBnZTF4dUlDQWdJQ0FnZEhsd1pUb2dKM0psWVdRbkxDQm1jbTl0T2lCZmRHaHBjeTVmYjNkdVpYSXNJSFJ2T2lCdlltcFZVa3hjYmlBZ0lDQjlPMXh1WEc0Z0lDQWdjbVYwZFhKdUlHNWxkeUJRY205dGFYTmxLQ2h5WlhOdmJIWmxMQ0J5WldwbFkzUXBJRDArSUh0Y2JpQWdJQ0FnSUY5MGFHbHpMbDlpZFhNdWNHOXpkRTFsYzNOaFoyVW9jbVZoWkUxelp5d2dLSEpsY0d4NUtTQTlQaUI3WEc0Z0lDQWdJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZHlaV0ZrTFhKbGMzQnZibk5sT2lBbkxDQnlaWEJzZVNrN1hHNGdJQ0FnSUNBZ0lHbG1JQ2h5WlhCc2VTNWliMlI1TG1OdlpHVWdQVDA5SURJd01Da2dlMXh1SUNBZ0lDQWdJQ0FnSUhKbGMyOXNkbVVvY21Wd2JIa3VZbTlrZVM1MllXeDFaU2s3WEc0Z0lDQWdJQ0FnSUgwZ1pXeHpaU0I3WEc0Z0lDQWdJQ0FnSUNBZ2NtVnFaV04wS0hKbGNHeDVMbUp2WkhrdVpHVnpZeWs3WEc0Z0lDQWdJQ0FnSUgxY2JpQWdJQ0FnSUgwcE8xeHVJQ0FnSUgwcE8xeHVJQ0I5WEc1Y2JpQWdMeW9xWEc0Z0lDb2dVMlYwZFhBZ2RHaGxJR05oYkd4aVlXTnJJSFJ2SUhCeWIyTmxjM01nWTNKbFlYUmxJR0Z1WkNCa1pXeGxkR1VnWlhabGJuUnpJRzltSUhKbGJXOTJaU0JTWlhCdmNuUmxjaUJ2WW1wbFkzUnpMbHh1SUNBcUlGUm9hWE1nYVhNZ2NtVnNaV0YwWldRZ2RHOGdkR2hsSUcxbGMzTmhaMlZ1Y3lCelpXNTBJR0o1SUdOeVpXRjBaU0IwYnlCMGFHVWdiMkp6WlhKMlpYSnpJRWg1Y0dWeWRIa2dZWEp5WVhrdVhHNGdJQ29nUUhCaGNtRnRJSHRtZFc1amRHbHZiaWhsZG1WdWREb2dUWE5uUlhabGJuUXBmU0JqWVd4c1ltRmphMXh1SUNBcUwxeHVJQ0J2Yms1dmRHbG1hV05oZEdsdmJpaGpZV3hzWW1GamF5a2dlMXh1SUNBZ0lIUm9hWE11WDI5dVRtOTBhV1pwWTJGMGFXOXVTR0Z1Wkd4bGNpQTlJR05oYkd4aVlXTnJPMXh1SUNCOVhHNWNiaUFnWDJOeVpXRjBaU2hqY21sMFpYSnBZU2tnZTF4dUlDQWdJR3hsZENCZmRHaHBjeUE5SUhSb2FYTTdYRzVjYmlBZ0lDQnlaWFIxY200Z2JtVjNJRkJ5YjIxcGMyVW9LSEpsYzI5c2RtVXNJSEpsYW1WamRDa2dQVDRnZTF4dUlDQWdJQ0FnYkdWMElISmxjM1Z0WlNBOUlHTnlhWFJsY21saExuSmxjM1Z0WlR0Y2JpQWdJQ0FnSUd4bGRDQnBibWwwYVdGc1JHRjBZU0E5SUdOeWFYUmxjbWxoTG1sdWFYUnBZV3hFWVhSaElIeDhJSHQ5TzF4dUlDQWdJQ0FnYkdWMElITmphR1Z0WVR0Y2JseHVJQ0FnSUNBZ0x5OUdURTlYTFU5VlZEb2dkR2hwY3lCdFpYTnpZV2RsSUhkcGJHd2dZbVVnYzJWdWRDQjBieUIwYUdVZ2NuVnVkR2x0WlNCcGJuTjBZVzVqWlNCdlppQlRlVzVqYUdWeVRXRnVZV2RsY2lBdFBpQmZiMjVEY21WaGRHVmNiaUFnSUNBZ0lHeGxkQ0J5WlhGMVpYTjBUWE5uSUQwZ2UxeHVJQ0FnSUNBZ0lDQjBlWEJsT2lBblkzSmxZWFJsSnl3Z1puSnZiVG9nWDNSb2FYTXVYMjkzYm1WeUxDQjBiem9nWDNSb2FYTXVYM04xWWxWU1RDeGNiaUFnSUNBZ0lDQWdZbTlrZVRvZ2V5QnlaWE4xYldVNklISmxjM1Z0WlNCOVhHNGdJQ0FnSUNCOU8xeHVYRzRnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVzNONWJtTm9aWElnTFNCamNtVmhkR1ZkT2lBbkxDQmpjbWwwWlhKcFlTd2djbVZ4ZFdWemRFMXpaeWs3WEc1Y2JpQWdJQ0FnSUhKbGNYVmxjM1JOYzJjdVltOWtlUzUyWVd4MVpTQTlJR2x1YVhScFlXeEVZWFJoTzF4dUlDQWdJQ0FnY21WeGRXVnpkRTF6Wnk1aWIyUjVMblpoYkhWbExuSmxjRzl5ZEdWeUlEMGdYM1JvYVhNdVgyOTNibVZ5TzF4dVhHNGdJQ0FnSUNCcFppQW9ZM0pwZEdWeWFXRXVjMk5vWlcxaEtTQjdYRzRnSUNBZ0lDQWdJSE5qYUdWdFlTQTlJR055YVhSbGNtbGhMbk5qYUdWdFlUdGNiaUFnSUNBZ0lDQWdjbVZ4ZFdWemRFMXpaeTVpYjJSNUxuTmphR1Z0WVNBOUlHTnlhWFJsY21saExuTmphR1Z0WVR0Y2JpQWdJQ0FnSUgxY2JseHVJQ0FnSUNBZ2FXWWdLR055YVhSbGNtbGhMbkF5Y0NrZ2NtVnhkV1Z6ZEUxelp5NWliMlI1TG5BeWNDQTlJR055YVhSbGNtbGhMbkF5Y0R0Y2JpQWdJQ0FnSUdsbUlDaGpjbWwwWlhKcFlTNXpkRzl5WlNrZ2NtVnhkV1Z6ZEUxelp5NWliMlI1TG5OMGIzSmxJRDBnWTNKcGRHVnlhV0V1YzNSdmNtVTdYRzRnSUNBZ0lDQnBaaUFvWTNKcGRHVnlhV0V1YjJKelpYSjJaWEp6S1NCeVpYRjFaWE4wVFhObkxtSnZaSGt1WVhWMGFHOXlhWE5sSUQwZ1kzSnBkR1Z5YVdFdWIySnpaWEoyWlhKek8xeHVJQ0FnSUNBZ2FXWWdLR055YVhSbGNtbGhMbWxrWlc1MGFYUjVLU0J5WlhGMVpYTjBUWE5uTG1KdlpIa3VhV1JsYm5ScGRIa2dQU0JqY21sMFpYSnBZUzVwWkdWdWRHbDBlVHRjYmx4dUlDQWdJQ0FnYVdZZ0tISmxjM1Z0WlNrZ2UxeHVJQ0FnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVzNONWJtTm9aWElnTFNCamNtVmhkR1ZkSUMwZ2NtVnpkVzFsSUcxbGMzTmhaMlU2SUNjc0lISmxjWFZsYzNSTmMyY3BPMXh1SUNBZ0lDQWdmU0JsYkhObElIdGNiaUFnSUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvSjF0emVXNWphR1Z5SUMwZ1kzSmxZWFJsWFNBdElHTnlaV0YwWlNCdFpYTnpZV2RsT2lBbkxDQnlaWEYxWlhOMFRYTm5LVHRjYmlBZ0lDQWdJSDFjYmx4dUlDQWdJQ0FnTHk5eVpYRjFaWE4wSUdOeVpXRjBaU0IwYnlCMGFHVWdZV3hzYjJOaGRHbHZiaUJ6ZVhOMFpXMHVJRU5oYmlCaVpTQnlaV3BsWTNSbFpDQmllU0IwYUdVZ1VHOXNhV041Ulc1bmFXNWxMbHh1SUNBZ0lDQWdYM1JvYVhNdVgySjFjeTV3YjNOMFRXVnpjMkZuWlNoeVpYRjFaWE4wVFhObkxDQW9jbVZ3YkhrcElEMCtJSHRjYmlBZ0lDQWdJQ0FnWTI5dWMyOXNaUzVzYjJjb0oxdHplVzVqYUdWeUlDMGdZM0psWVhSbFhTQXRJR055WldGMFpTMXlaWE53YjI1elpUb2dKeXdnY21Wd2JIa3BPMXh1SUNBZ0lDQWdJQ0JwWmlBb2NtVndiSGt1WW05a2VTNWpiMlJsSUQwOVBTQXlNREFwSUh0Y2JpQWdJQ0FnSUNBZ0lDQXZMM0psY0c5eWRHVnlJR055WldGMGFXOXVJR0ZqWTJWd2RHVmtYRzRnSUNBZ0lDQWdJQ0FnYkdWMElHOWlhbFZTVENBOUlISmxjR3g1TG1KdlpIa3VjbVZ6YjNWeVkyVTdYRzVjYmlBZ0lDQWdJQ0FnSUNCcFppQW9jbVZ6ZFcxbEtTQjdYRzRnSUNBZ0lDQWdJQ0FnSUNCelkyaGxiV0VnUFNCeVpYQnNlUzVpYjJSNUxuTmphR1Z0WVR0Y2JpQWdJQ0FnSUNBZ0lDQWdJR2x1YVhScFlXeEVZWFJoSUQwZ2NtVndiSGt1WW05a2VTNTJZV3gxWlR0Y2JpQWdJQ0FnSUNBZ0lDQjlYRzVjYmlBZ0lDQWdJQ0FnSUNCc1pYUWdibVYzVDJKcUlEMGdibVYzSUVSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2loZmRHaHBjeXdnYjJKcVZWSk1MQ0J6WTJobGJXRXNJQ2R2Ymljc0lHbHVhWFJwWVd4RVlYUmhMQ0J5WlhCc2VTNWliMlI1TG1Ob2FXeGtjbVZ1VW1WemIzVnlZMlZ6S1R0Y2JpQWdJQ0FnSUNBZ0lDQmZkR2hwY3k1ZmNtVndiM0owWlhKelcyOWlhbFZTVEYwZ1BTQnVaWGRQWW1vN1hHNWNiaUFnSUNBZ0lDQWdJQ0J5WlhOdmJIWmxLRzVsZDA5aWFpazdYRzRnSUNBZ0lDQWdJSDBnWld4elpTQjdYRzRnSUNBZ0lDQWdJQ0FnTHk5eVpYQnZjblJsY2lCamNtVmhkR2x2YmlCeVpXcGxZM1JsWkZ4dUlDQWdJQ0FnSUNBZ0lISmxhbVZqZENoeVpYQnNlUzVpYjJSNUxtUmxjMk1wTzF4dUlDQWdJQ0FnSUNCOVhHNGdJQ0FnSUNCOUtUdGNiaUFnSUNCOUtUdGNibHh1SUNCOVhHNWNiaUFnWDNOMVluTmpjbWxpWlNoamNtbDBaWEpwWVNrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQ0J5WlhSMWNtNGdibVYzSUZCeWIyMXBjMlVvS0hKbGMyOXNkbVVzSUhKbGFtVmpkQ2tnUFQ0Z2UxeHVYRzRnSUNBZ0lDQXZMMFpNVDFjdFQxVlVPaUIwYUdseklHMWxjM05oWjJVZ2QybHNiQ0JpWlNCelpXNTBJSFJ2SUhSb1pTQnlkVzUwYVcxbElHbHVjM1JoYm1ObElHOW1JRk41Ym1Ob1pYSk5ZVzVoWjJWeUlDMCtJRjl2Ymt4dlkyRnNVM1ZpYzJOeWFXSmxYRzRnSUNBZ0lDQnNaWFFnYzNWaWMyTnlhV0psVFhObklEMGdlMXh1SUNBZ0lDQWdJQ0IwZVhCbE9pQW5jM1ZpYzJOeWFXSmxKeXdnWm5KdmJUb2dYM1JvYVhNdVgyOTNibVZ5TENCMGJ6b2dYM1JvYVhNdVgzTjFZbFZTVEN4Y2JpQWdJQ0FnSUNBZ1ltOWtlVG9nZTMxY2JpQWdJQ0FnSUgwN1hHNWNiaUFnSUNBZ0lDOHZJRWg1Y0dWeWRIa2djbVZ4ZFdWemRDQjBieUJpWlNCaGJpQlBZbk5sY25abGNseHVJQ0FnSUNBZ0x5OGdhSFIwY0hNNkx5OW5hWFJvZFdJdVkyOXRMM0psVkVoSlRrc3RjSEp2YW1WamRDOXpjR1ZqY3k5aWJHOWlMMjFoYzNSbGNpOXRaWE56WVdkbGN5OWtZWFJoTFhONWJtTXRiV1Z6YzJGblpYTXViV1FqYUhsd1pYSjBlUzF5WlhGMVpYTjBMWFJ2TFdKbExXRnVMVzlpYzJWeWRtVnlYRzVjYmlBZ0lDQWdJQzh2SUZKbGMzVnRaU0JUZFdKelkzSnBjSFJwYjI1eklHWnZjaUIwYUdVZ2MyRnRaU0JJZVhCbGNuUjVJRlZTVEZ4dUlDQWdJQ0FnTHk4Z2FIUjBjSE02THk5bmFYUm9kV0l1WTI5dEwzSmxWRWhKVGtzdGNISnZhbVZqZEM5emNHVmpjeTlpYkc5aUwyMWhjM1JsY2k5dFpYTnpZV2RsY3k5a1lYUmhMWE41Ym1NdGJXVnpjMkZuWlhNdWJXUWpjbVZ6ZFcxbExYTjFZbk5qY21sd2RHbHZibk10Wm05eUxYUm9aUzF6WVcxbExXaDVjR1Z5ZEhrdGRYSnNYRzVjYmlBZ0lDQWdJQzh2SUZKbGMzVnRaU0JUZFdKelkzSnBjSFJwYjI1eklHWnZjaUJoSUdObGNuUmhhVzRnZFhObGNpQmhibVFnWkdGMFlTQnpZMmhsYldFZ2FXNWtaWEJsYm1SbGJuUnNlU0J2WmlCMGFHVWdTSGx3WlhKMGVTQlZVa3d1WEc0Z0lDQWdJQ0F2THlCb2RIUndjem92TDJkcGRHaDFZaTVqYjIwdmNtVlVTRWxPU3kxd2NtOXFaV04wTDNOd1pXTnpMMkpzYjJJdmJXRnpkR1Z5TDIxbGMzTmhaMlZ6TDJSaGRHRXRjM2x1WXkxdFpYTnpZV2RsY3k1dFpDTnlaWE4xYldVdGMzVmljMk55YVhCMGFXOXVjeTFtYjNJdFlTMWpaWEowWVdsdUxYVnpaWEl0WVc1a0xXUmhkR0V0YzJOb1pXMWhMV2x1WkdWd1pXNWtaVzUwYkhrdGIyWXRkR2hsTFdoNWNHVnlkSGt0ZFhKc1hHNGdJQ0FnSUNCcFppQW9ZM0pwZEdWeWFXRXBJSHRjYmlBZ0lDQWdJQ0FnYVdZZ0tHTnlhWFJsY21saExtaGhjMDkzYmxCeWIzQmxjblI1S0Nkd01uQW5LU2tnYzNWaWMyTnlhV0psVFhObkxtSnZaSGt1Y0RKd0lEMGdZM0pwZEdWeWFXRXVjREp3TzF4dUlDQWdJQ0FnSUNCcFppQW9ZM0pwZEdWeWFXRXVhR0Z6VDNkdVVISnZjR1Z5ZEhrb0ozTjBiM0psSnlrcElITjFZbk5qY21saVpVMXpaeTVpYjJSNUxuTjBiM0psSUQwZ1kzSnBkR1Z5YVdFdWMzUnZjbVU3WEc0Z0lDQWdJQ0FnSUdsbUlDaGpjbWwwWlhKcFlTNW9ZWE5QZDI1UWNtOXdaWEowZVNnbmMyTm9aVzFoSnlrcElITjFZbk5qY21saVpVMXpaeTVpYjJSNUxuTmphR1Z0WVNBOUlHTnlhWFJsY21saExuTmphR1Z0WVR0Y2JpQWdJQ0FnSUNBZ2FXWWdLR055YVhSbGNtbGhMbWhoYzA5M2JsQnliM0JsY25SNUtDZHBaR1Z1ZEdsMGVTY3BLU0J6ZFdKelkzSnBZbVZOYzJjdVltOWtlUzVwWkdWdWRHbDBlU0E5SUdOeWFYUmxjbWxoTG1sa1pXNTBhWFI1TzF4dUlDQWdJQ0FnSUNCcFppQW9ZM0pwZEdWeWFXRXVhR0Z6VDNkdVVISnZjR1Z5ZEhrb0ozSmxjMjkxY21ObEp5a3BJSE4xWW5OamNtbGlaVTF6Wnk1aWIyUjVMbkpsYzI5MWNtTmxJRDBnWTNKcGRHVnlhV0V1Y21WemIzVnlZMlU3WEc0Z0lDQWdJQ0FnSUdsbUlDaGpjbWwwWlhKcFlTNW9ZWE5QZDI1UWNtOXdaWEowZVNnbmFXUmxiblJwZEhrbktTa2djM1ZpYzJOeWFXSmxUWE5uTG1KdlpIa3VhV1JsYm5ScGRIa2dQU0JqY21sMFpYSnBZUzVwWkdWdWRHbDBlVHRjYmlBZ0lDQWdJSDFjYmx4dUlDQWdJQ0FnYzNWaWMyTnlhV0psVFhObkxtSnZaSGt1Y21WemRXMWxJRDBnWTNKcGRHVnlhV0V1Y21WemRXMWxPMXh1WEc0Z0lDQWdJQ0F2TDFSUFJFODZJRVp2Y2lCR2RYSjBhR1Z5SUZOMGRXUjVYRzRnSUNBZ0lDQnNaWFFnYlhWMGRXRnNRWFYwYUdWdWRHbGpZWFJwYjI0Z1BTQmpjbWwwWlhKcFlTNXRkWFIxWVd3N1hHNGdJQ0FnSUNCcFppQW9ZM0pwZEdWeWFXRXVhR0Z6VDNkdVVISnZjR1Z5ZEhrb0oyMTFkSFZoYkNjcEtTQnpkV0p6WTNKcFltVk5jMmN1WW05a2VTNXRkWFIxWVd4QmRYUm9aVzUwYVdOaGRHbHZiaUE5SUcxMWRIVmhiRUYxZEdobGJuUnBZMkYwYVc5dU8xeHVYRzRnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVzNONWJtTm9aWEpkSUMwZ2MzVmljMk55YVdKbElHMWxjM05oWjJVNklDY3NJR055YVhSbGNtbGhMQ0J6ZFdKelkzSnBZbVZOYzJjcE8xeHVYRzRnSUNBZ0lDQXZMM0psY1hWbGMzUWdjM1ZpYzJOeWFYQjBhVzl1WEc0Z0lDQWdJQ0F2TDFCeWIzWnBjMmx2Ym1Gc0lHUmhkR0VnYVhNZ1lYQndiR2xsWkNCMGJ5QjBhR1VnUkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5SUdGbWRHVnlJR052Ym1acGNtMWhkR2x2Ymk0Z1QzSWdaR2x6WTJGeVpHVmtJR2xtSUhSb1pYSmxJR2x6SUc1dklHTnZibVpwY20xaGRHbHZiaTVjYmlBZ0lDQWdJQzh2Wm05eUlHMXZjbVVnYVc1bWJ5QnpaV1VnZEdobElFUmhkR0ZRY205MmFYTnBiMjVoYkNCamJHRnpjeUJrYjJOMWJXVnVkR0YwYVc5dUxseHVJQ0FnSUNBZ1gzUm9hWE11WDJKMWN5NXdiM04wVFdWemMyRm5aU2h6ZFdKelkzSnBZbVZOYzJjc0lDaHlaWEJzZVNrZ1BUNGdlMXh1SUNBZ0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblczTjVibU5vWlhKZElDMGdjM1ZpYzJOeWFXSmxMWEpsYzNCdmJuTmxPaUFuTENCeVpYQnNlU2s3WEc1Y2JpQWdJQ0FnSUNBZ2JHVjBJSE5qYUdWdFlTQTlJSEpsY0d4NUxtSnZaSGt1YzJOb1pXMWhPMXh1SUNBZ0lDQWdJQ0JzWlhRZ2IySnFWVkpNSUQwZ2NtVndiSGt1WW05a2VTNXlaWE52ZFhKalpUdGNibHh1SUNBZ0lDQWdJQ0JzWlhRZ2JtVjNVSEp2ZG1semFXOXVZV3dnUFNCZmRHaHBjeTVmY0hKdmRtbHphVzl1WVd4elcyOWlhbFZTVEYwN1hHNGdJQ0FnSUNBZ0lHUmxiR1YwWlNCZmRHaHBjeTVmY0hKdmRtbHphVzl1WVd4elcyOWlhbFZTVEYwN1hHNGdJQ0FnSUNBZ0lHbG1JQ2h1WlhkUWNtOTJhWE5wYjI1aGJDa2dibVYzVUhKdmRtbHphVzl1WVd3dVgzSmxiR1ZoYzJWTWFYTjBaVzVsY25Nb0tUdGNibHh1SUNBZ0lDQWdJQ0JwWmlBb2NtVndiSGt1WW05a2VTNWpiMlJsSUR3Z01qQXdLU0I3WEc0Z0lDQWdJQ0FnSUNBZ1kyOXVjMjlzWlM1c2IyY29KMXR6ZVc1amFHVnlYU0F0SUc1bGR5QkVZWFJoVUhKdmRtbHphVzl1WVd3NklDY3NJSEpsY0d4NUxtSnZaSGt1WTJocGJHUnlaVzVTWlhOdmRYSmpaWE1zSUc5aWFsVlNUQ2s3WEc0Z0lDQWdJQ0FnSUNBZ2JtVjNVSEp2ZG1semFXOXVZV3dnUFNCdVpYY2dSR0YwWVZCeWIzWnBjMmx2Ym1Gc0tGOTBhR2x6TGw5dmQyNWxjaXdnYjJKcVZWSk1MQ0JmZEdocGN5NWZZblZ6TENCeVpYQnNlUzVpYjJSNUxtTm9hV3hrY21WdVVtVnpiM1Z5WTJWektUdGNiaUFnSUNBZ0lDQWdJQ0JmZEdocGN5NWZjSEp2ZG1semFXOXVZV3h6VzI5aWFsVlNURjBnUFNCdVpYZFFjbTkyYVhOcGIyNWhiRHRjYmlBZ0lDQWdJQ0FnZlNCbGJITmxJR2xtSUNoeVpYQnNlUzVpYjJSNUxtTnZaR1VnUFQwOUlESXdNQ2tnZTF4dUlDQWdJQ0FnSUNBZ0lHTnZibk52YkdVdWJHOW5LQ2RiYzNsdVkyaGxjbDBnTFNCdVpYY2dSR0YwWVNCUFltcGxZM1FnVDJKelpYSjJaWEk2SUNjc0lISmxjR3g1TENCZmRHaHBjeTVmY0hKdmRtbHphVzl1WVd4ektUdGNibHh1SUNBZ0lDQWdJQ0FnSUd4bGRDQnBibWwwYVdGc1JHRjBZU0E5SUhKbGNHeDVMbUp2WkhrdWRtRnNkV1U3WEc0Z0lDQWdJQ0FnSUNBZ2FXWWdLQ0ZwYm1sMGFXRnNSR0YwWVM1b1lYTlBkMjVRY205d1pYSjBlU2duWTJocGJHUnlaVzV6SnlrcElIc2dhVzVwZEdsaGJFUmhkR0V1WTJocGJHUnlaVzV6SUQwZ2UzMDdJSDFjYmlBZ0lDQWdJQ0FnSUNCcFppQW9JV2x1YVhScFlXeEVZWFJoTG1oaGMwOTNibEJ5YjNCbGNuUjVLQ2RrWVhSaEp5a3BJSHNnYVc1cGRHbGhiRVJoZEdFdVpHRjBZU0E5SUh0OU95QjlYRzVjYmlBZ0lDQWdJQ0FnSUNBdkwxUlBSRTg2SUcxMWRIVmhiRUYxZEdobGJuUnBZMkYwYVc5dUlFWnZjaUJHZFhKMGFHVnlJRk4wZFdSNVhHNGdJQ0FnSUNBZ0lDQWdiR1YwSUc1bGQwOWlhaUE5SUc1bGR5QkVZWFJoVDJKcVpXTjBUMkp6WlhKMlpYSW9YM1JvYVhNc0lHOWlhbFZTVEN3Z2MyTm9aVzFoTENBbmIyNG5MQ0JwYm1sMGFXRnNSR0YwWVN3Z2JtVjNVSEp2ZG1semFXOXVZV3d1WTJocGJHUnlaVzRzSUhKbGNHeDVMbUp2WkhrdWRtVnljMmx2Yml3Z2JYVjBkV0ZzUVhWMGFHVnVkR2xqWVhScGIyNHBPMXh1SUNBZ0lDQWdJQ0FnSUY5MGFHbHpMbDl2WW5ObGNuWmxjbk5iYjJKcVZWSk1YU0E5SUc1bGQwOWlhanRjYmx4dUlDQWdJQ0FnSUNBZ0lISmxjMjlzZG1Vb2JtVjNUMkpxS1R0Y2JpQWdJQ0FnSUNBZ0lDQnVaWGRRY205MmFYTnBiMjVoYkM1aGNIQnNlU2h1WlhkUFltb3BPMXh1SUNBZ0lDQWdJQ0I5SUdWc2MyVWdlMXh1SUNBZ0lDQWdJQ0FnSUhKbGFtVmpkQ2h5WlhCc2VTNWliMlI1TG1SbGMyTXBPMXh1SUNBZ0lDQWdJQ0I5WEc0Z0lDQWdJQ0I5S1R0Y2JpQWdJQ0I5S1R0Y2JseHVJQ0I5WEc1Y2JpQWdMeTlHVEU5WExVbE9PaUJ0WlhOellXZGxJSEpsWTJWcGRtVmtJR1p5YjIwZ1lTQnNiMk5oYkNCeWRXNTBhVzFsSUZKbGNHOXlkR1Z5VDJKcVpXTjBJQzArSUY5dmJsSmxiVzkwWlZOMVluTmpjbWxpWlZ4dUlDQmZiMjVHYjNKM1lYSmtLRzF6WnlrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQ0JzWlhRZ2NtVndiM0owWlhJZ1BTQmZkR2hwY3k1ZmNtVndiM0owWlhKelcyMXpaeTVpYjJSNUxuUnZYVHRjYmlBZ0lDQnlaWEJ2Y25SbGNpNWZiMjVHYjNKM1lYSmtLRzF6WnlrN1hHNGdJSDFjYmx4dUlDQXZMMFpNVDFjdFNVNDZJRzFsYzNOaFoyVWdjbVZqWldsMlpXUWdabkp2YlNCaElISmxiVzkwWlNCVGVXNWphR1Z5SUMwK0lHTnlaV0YwWlNBb2RHaHBjeUJwY3lCaFkzUjFZV3hzZVNCaGJpQnBiblpwZEdGMGFXOXVJSFJ2SUhOMVluTmpjbWxpWlNsY2JpQWdYMjl1VW1WdGIzUmxRM0psWVhSbEtHMXpaeWtnZTF4dUlDQWdJR3hsZENCZmRHaHBjeUE5SUhSb2FYTTdYRzVjYmlBZ0lDOHZjbVZ0YjNabElGd2lMM04xWW5OamNtbHdkR2x2Ymx3aUlHWnliMjBnZEdobElGVlNURnh1SUNBZ0lHeGxkQ0J5WlhOdmRYSmpaU0E5SUcxelp5NW1jbTl0TG5Oc2FXTmxLREFzSUMweE15azdYRzVjYmlBZ0lDQnNaWFFnWlhabGJuUWdQU0I3WEc0Z0lDQWdJQ0IwZVhCbE9pQnRjMmN1ZEhsd1pTeGNiaUFnSUNBZ0lHWnliMjA2SUcxelp5NWliMlI1TG5OdmRYSmpaU3hjYmlBZ0lDQWdJSFZ5YkRvZ2NtVnpiM1Z5WTJVc1hHNGdJQ0FnSUNCelkyaGxiV0U2SUcxelp5NWliMlI1TG5OamFHVnRZU3hjYmlBZ0lDQWdJSFpoYkhWbE9pQnRjMmN1WW05a2VTNTJZV3gxWlN4Y2JpQWdJQ0FnSUdsa1pXNTBhWFI1T2lCdGMyY3VZbTlrZVM1cFpHVnVkR2wwZVN4Y2JseHVJQ0FnSUNBZ1lXTnJPaUFvZEhsd1pTa2dQVDRnZTF4dUlDQWdJQ0FnSUNCc1pYUWdiRlI1Y0dVZ1BTQXlNREE3WEc0Z0lDQWdJQ0FnSUdsbUlDaDBlWEJsS1NCN1hHNGdJQ0FnSUNBZ0lDQWdiRlI1Y0dVZ1BTQjBlWEJsTzF4dUlDQWdJQ0FnSUNCOVhHNWNiaUFnSUNBZ0lDQXZMM05sYm1RZ1lXTnJJSEpsYzNCdmJuTmxJRzFsYzNOaFoyVmNiaUFnSUNBZ0lDQWdYM1JvYVhNdVgySjFjeTV3YjNOMFRXVnpjMkZuWlNoN1hHNGdJQ0FnSUNBZ0lDQWdhV1E2SUcxelp5NXBaQ3dnZEhsd1pUb2dKM0psYzNCdmJuTmxKeXdnWm5KdmJUb2diWE5uTG5SdkxDQjBiem9nYlhObkxtWnliMjBzWEc0Z0lDQWdJQ0FnSUNBZ1ltOWtlVG9nZXlCamIyUmxPaUJzVkhsd1pTQjlYRzRnSUNBZ0lDQWdJSDBwTzF4dUlDQWdJQ0FnZlZ4dUlDQWdJSDA3WEc1Y2JpQWdJQ0JwWmlBb1gzUm9hWE11WDI5dVRtOTBhV1pwWTJGMGFXOXVTR0Z1Wkd4bGNpa2dlMXh1SUNBZ0lDQWdZMjl1YzI5c1pTNXBibVp2S0NkYlUzbHVZMmhsY2wwZ1RrOVVTVVpKUTBGVVNVOU9MVVZXUlU1VU9pQW5MQ0JsZG1WdWRDazdYRzRnSUNBZ0lDQmZkR2hwY3k1ZmIyNU9iM1JwWm1sallYUnBiMjVJWVc1a2JHVnlLR1YyWlc1MEtUdGNiaUFnSUNCOVhHNGdJSDFjYmx4dUlDQXZMMFpNVDFjdFNVNDZJRzFsYzNOaFoyVWdjbVZqWldsMlpXUWdabkp2YlNCaElISmxiVzkwWlNCRVlYUmhUMkpxWldOMFVtVndiM0owWlhJZ0xUNGdaR1ZzWlhSbFhHNGdJRjl2YmxKbGJXOTBaVVJsYkdWMFpTaHRjMmNwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQXZMM0psYlc5MlpTQmNJaTl6ZFdKelkzSnBjSFJwYjI1Y0lpQm1jbTl0SUhSb1pTQlZVa3hjYmlBZ0lDQnNaWFFnY21WemIzVnlZMlVnUFNCdGMyY3VZbTlrZVM1eVpYTnZkWEpqWlR0Y2JseHVJQ0FnSUd4bGRDQnZZbXBsWTNRZ1BTQmZkR2hwY3k1ZmIySnpaWEoyWlhKelczSmxjMjkxY21ObFhUdGNiaUFnSUNCcFppQW9iMkpxWldOMEtTQjdYRzRnSUNBZ0lDQnNaWFFnWlhabGJuUWdQU0I3WEc0Z0lDQWdJQ0FnSUhSNWNHVTZJRzF6Wnk1MGVYQmxMRnh1SUNBZ0lDQWdJQ0IxY213NklISmxjMjkxY21ObExGeHVJQ0FnSUNBZ0lDQnBaR1Z1ZEdsMGVUb2diWE5uTG1KdlpIa3VhV1JsYm5ScGRIa3NYRzVjYmlBZ0lDQWdJQ0FnWVdOck9pQW9kSGx3WlNrZ1BUNGdlMXh1SUNBZ0lDQWdJQ0FnSUd4bGRDQnNWSGx3WlNBOUlESXdNRHRjYmlBZ0lDQWdJQ0FnSUNCcFppQW9kSGx3WlNrZ2UxeHVJQ0FnSUNBZ0lDQWdJQ0FnYkZSNWNHVWdQU0IwZVhCbE8xeHVJQ0FnSUNBZ0lDQWdJSDFjYmx4dUlDQWdJQ0FnSUNBZ0x5OVVUMFJQT2lCaGJua2diM1JvWlhJZ1pHbG1abVZ5Wlc1MElHOXdkR2x2Ym5NZ1ptOXlJSFJvWlNCeVpXeGxZWE5sSUhCeWIyTmxjM01zSUd4cGEyVWdZV05qWlhCMElHSjFkQ0J1YjNJZ2NtVnNaV0Z6WlNCc2IyTmhiRDljYmlBZ0lDQWdJQ0FnSUNCcFppQW9iRlI1Y0dVZ1BUMDlJREl3TUNrZ2UxeHVJQ0FnSUNBZ0lDQWdJQ0FnYjJKcVpXTjBMbVJsYkdWMFpTZ3BPMXh1SUNBZ0lDQWdJQ0FnSUgxY2JseHVJQ0FnSUNBZ0lDQWdJQzh2YzJWdVpDQmhZMnNnY21WemNHOXVjMlVnYldWemMyRm5aVnh1SUNBZ0lDQWdJQ0FnSUY5MGFHbHpMbDlpZFhNdWNHOXpkRTFsYzNOaFoyVW9lMXh1SUNBZ0lDQWdJQ0FnSUNBZ2FXUTZJRzF6Wnk1cFpDd2dkSGx3WlRvZ0ozSmxjM0J2Ym5ObEp5d2dabkp2YlRvZ2JYTm5MblJ2TENCMGJ6b2diWE5uTG1aeWIyMHNYRzRnSUNBZ0lDQWdJQ0FnSUNCaWIyUjVPaUI3SUdOdlpHVTZJR3hVZVhCbExDQnpiM1Z5WTJVNklGOTBhR2x6TGw5dmQyNWxjaUI5WEc0Z0lDQWdJQ0FnSUNBZ2ZTazdYRzRnSUNBZ0lDQWdJSDFjYmlBZ0lDQWdJSDA3WEc1Y2JpQWdJQ0FnSUdsbUlDaGZkR2hwY3k1ZmIyNU9iM1JwWm1sallYUnBiMjVJWVc1a2JHVnlLU0I3WEc0Z0lDQWdJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZE9UMVJKUmtsRFFWUkpUMDR0UlZaRlRsUTZJQ2NzSUdWMlpXNTBLVHRjYmlBZ0lDQWdJQ0FnWDNSb2FYTXVYMjl1VG05MGFXWnBZMkYwYVc5dVNHRnVaR3hsY2lobGRtVnVkQ2s3WEc0Z0lDQWdJQ0I5WEc0Z0lDQWdmU0JsYkhObElIdGNiaUFnSUNBZ0lGOTBhR2x6TGw5aWRYTXVjRzl6ZEUxbGMzTmhaMlVvZTF4dUlDQWdJQ0FnSUNCcFpEb2diWE5uTG1sa0xDQjBlWEJsT2lBbmNtVnpjRzl1YzJVbkxDQm1jbTl0T2lCdGMyY3VkRzhzSUhSdk9pQnRjMmN1Wm5KdmJTeGNiaUFnSUNBZ0lDQWdZbTlrZVRvZ2V5QmpiMlJsT2lBME1EUXNJSE52ZFhKalpUb2dYM1JvYVhNdVgyOTNibVZ5SUgxY2JpQWdJQ0FnSUgwcE8xeHVJQ0FnSUgxY2JpQWdmVnh1WEc1OVhHNWNibVY0Y0c5eWRDQmtaV1poZFd4MElGTjVibU5vWlhJN1hHNWNibHh1WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWlBdkwxeHVMeThnTGk5emNtTXZjM2x1WTJobGNpOVRlVzVqYUdWeUxtcHpJaXdpTHlvcVhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklGQlVJRWx1YjNaaHc2ZkRvMjhnWlNCVGFYTjBaVzFoY3lCVFFWeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQkpUa1ZUUXkxSlJGeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQlJWVTlDU1ZNZ1RrVlVWMDlTUzFNZ1UweGNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdSbEpCVlU1SVQwWkZVaTFIUlZORlRFeFRRMGhCUmxRZ1dsVlNJRVpQUlZKRVJWSlZUa2NnUkVWU0lFRk9SMFZYUVU1RVZFVk9JRVpQVWxORFNGVk9SeUJGTGxaY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1QxSkJUa2RGSUZOQlhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklFUmxkWFJ6WTJobElGUmxiR1ZyYjIwZ1FVZGNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdRWEJwZW1WbFhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklGUkZRMGhPU1ZORFNFVWdWVTVKVmtWU1UwbFVRVlFnUWtWU1RFbE9YRzRxWEc0cUlFeHBZMlZ1YzJWa0lIVnVaR1Z5SUhSb1pTQkJjR0ZqYUdVZ1RHbGpaVzV6WlN3Z1ZtVnljMmx2YmlBeUxqQWdLSFJvWlNCY0lreHBZMlZ1YzJWY0lpazdYRzRxSUhsdmRTQnRZWGtnYm05MElIVnpaU0IwYUdseklHWnBiR1VnWlhoalpYQjBJR2x1SUdOdmJYQnNhV0Z1WTJVZ2QybDBhQ0IwYUdVZ1RHbGpaVzV6WlM1Y2Jpb2dXVzkxSUcxaGVTQnZZblJoYVc0Z1lTQmpiM0I1SUc5bUlIUm9aU0JNYVdObGJuTmxJR0YwWEc0cVhHNHFJQ0FnYUhSMGNEb3ZMM2QzZHk1aGNHRmphR1V1YjNKbkwyeHBZMlZ1YzJWekwweEpRMFZPVTBVdE1pNHdYRzRxWEc0cUlGVnViR1Z6Y3lCeVpYRjFhWEpsWkNCaWVTQmhjSEJzYVdOaFlteGxJR3hoZHlCdmNpQmhaM0psWldRZ2RHOGdhVzRnZDNKcGRHbHVaeXdnYzI5bWRIZGhjbVZjYmlvZ1pHbHpkSEpwWW5WMFpXUWdkVzVrWlhJZ2RHaGxJRXhwWTJWdWMyVWdhWE1nWkdsemRISnBZblYwWldRZ2IyNGdZVzRnWENKQlV5QkpVMXdpSUVKQlUwbFRMRnh1S2lCWFNWUklUMVZVSUZkQlVsSkJUbFJKUlZNZ1QxSWdRMDlPUkVsVVNVOU9VeUJQUmlCQlRsa2dTMGxPUkN3Z1pXbDBhR1Z5SUdWNGNISmxjM01nYjNJZ2FXMXdiR2xsWkM1Y2Jpb2dVMlZsSUhSb1pTQk1hV05sYm5ObElHWnZjaUIwYUdVZ2MzQmxZMmxtYVdNZ2JHRnVaM1ZoWjJVZ1oyOTJaWEp1YVc1bklIQmxjbTFwYzNOcGIyNXpJR0Z1WkZ4dUtpQnNhVzFwZEdGMGFXOXVjeUIxYm1SbGNpQjBhR1VnVEdsalpXNXpaUzVjYmlvcUwxeHVYRzR2S2lwY2JpQXFJRUJoWTJObGMzTWdjSEpwZG1GMFpWeHVJQ29nVkdocGN5QmpiR0Z6Y3lCcGN5QnlaWE53YjI1emFXSnNaU0JtYjNJZ1kyOXNiR1ZqZEdsdVp5QmtaV3gwWVNCamFHRnVaMlZ6SUdsdUlISmxiVzkwWlNCdlltcGxZM1J6TENCaVpXWnZjbVVnZEdobElISmxjM0J2Ym5ObElHOW1JSE4xWW5OamNtbHdkR2x2YmlCeVpXRmphQ0IwYUdVZ2IySnpaWEoyWlhJdVhHNGdLaUJKZENkeklIVnpaV1FnYVc0Z1UzbHVZMmhsY2lBdFBpQnpkV0p6WTNKcFltVXVJRlJvWlNCbWJHOTNJR2x6SUdSbFptbHVaV1FnWVhNNlhHNGdLaUF4TGlBb2IySnpaWEoyWlhJcElDMHRjM1ZpYzJOeWFXSmxMUzArSUNoeVpYQnZjblJsY2lsY2JpQXFJREl1SUNodlluTmxjblpsY2lrZ1BDMHRaR1ZzZEdFZ2RYQmtZWFJsY3kwdElDaHlaWEJ2Y25SbGNpbGNiaUFxSURNdUlDaHZZbk5sY25abGNpa2dQQzB0YzNWaWMyTnlhV0psSUhKbGMzQnZibk5sTFMwZ0tISmxjRzl5ZEdWeUtWeHVJQ29nVkdocGN5QnRaV0Z1Y3lCMGFHRjBJSFJvWlhKbElHTnZkV3hrSUdKbElHUmxiSFJoSUhWd1pHRjBaWE1nZEhKaGJuTm1aWEp5WldRZ1ltVm1iM0psSUhSb1pTQnpkV0p6WTNKcGNIUnBiMjRnWTI5dVptbHliV0YwYVc5dUxseHVJQ29nVTJsdVkyVWdkR2hsY21VZ2FYTWdibThnUkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5SUdKbFptOXlaU0IwYUdVZ2RXSnpZM0pwY0hScGIyNGdZMjl1Wm1seWJXRjBhVzl1TENCMGFHVnlaU0J6YUc5MWJHUWdZbVVnYzI5dFpTQnZkR2hsY2lCdlltcGxZM1FnWTI5c2JHVmpkR2x1WnlCMGFHVWdkWEJrWVhSbGN5NWNiaUFxSUZCeWIzWnBjMmx2Ym1Gc0lHUmhkR0VnYVhNZ1lYQndiR2xsWkNCMGJ5QjBhR1VnUkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5SUdGbWRHVnlJR052Ym1acGNtMWhkR2x2Ymk0Z1QzSWdaR2x6WTJGeVpHVmtJR2xtSUhSb1pYSmxJR2x6SUc1dklHTnZibVpwY20xaGRHbHZiaTVjYmlBcUwxeHVZMnhoYzNNZ1JHRjBZVkJ5YjNacGMybHZibUZzSUh0Y2JpQWdMeW9nY0hKcGRtRjBaVnh1SUNCZlkyaHBiR1J5Wlc1TWFYTjBaVzVsY25NNklGdE5jMmRNYVhOMFpXNWxjbDFjYmlBZ1gyeHBjM1JsYm1WeU9pQk5jMmRNYVhOMFpXNWxjbHh1WEc0Z0lGOWphR0Z1WjJWek9pQmJYVnh1SUNBcUwxeHVYRzRnSUdOdmJuTjBjblZqZEc5eUtHOTNibVZ5TENCMWNtd3NJR0oxY3l3Z1kyaHBiR1J5Wlc0cElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWDNSb2FYTXVYMjkzYm1WeUlEMGdiM2R1WlhJN1hHNGdJQ0FnWDNSb2FYTXVYM1Z5YkNBOUlIVnliRHRjYmlBZ0lDQmZkR2hwY3k1ZlluVnpJRDBnWW5Wek8xeHVJQ0FnSUY5MGFHbHpMbDlqYUdsc1pISmxiaUE5SUdOb2FXeGtjbVZ1TzF4dVhHNGdJQ0FnWDNSb2FYTXVYMk5vWVc1blpYTWdQU0JiWFR0Y2JpQWdJQ0JmZEdocGN5NWZZV3hzYjJOaGRHVk1hWE4wWlc1bGNuTW9LVHRjYmlBZ2ZWeHVYRzRnSUY5aGJHeHZZMkYwWlV4cGMzUmxibVZ5Y3lncElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWDNSb2FYTXVYMnhwYzNSbGJtVnlJRDBnWDNSb2FYTXVYMkoxY3k1aFpHUk1hWE4wWlc1bGNpaGZkR2hwY3k1ZmRYSnNMQ0FvYlhObktTQTlQaUI3WEc0Z0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblJHRjBZVkJ5YjNacGMybHZibUZzTFNjZ0t5QmZkR2hwY3k1ZmRYSnNJQ3NnSnkxU1ExWTZJQ2NzSUcxelp5azdYRzRnSUNBZ0lDQmZkR2hwY3k1ZlkyaGhibWRsY3k1d2RYTm9LRzF6WnlrN1hHNGdJQ0FnZlNrN1hHNWNiaUFnSUNBdktseHVJQ0FnSUY5MGFHbHpMbDlqYUdsc1pISmxia3hwYzNSbGJtVnljeUE5SUZ0ZE8xeHVJQ0FnSUdsbUlDaGZkR2hwY3k1ZlkyaHBiR1J5Wlc0cElIdGNiaUFnSUNBZ0lHeGxkQ0JqYUdsc1pFSmhjMlZWVWt3Z1BTQjFjbXdnS3lBbkwyTm9hV3hrY21WdUx5YzdYRzRnSUNBZ0lDQmZkR2hwY3k1ZlkyaHBiR1J5Wlc0dVptOXlSV0ZqYUNnb1kyaHBiR1FwSUQwK0lIdGNiaUFnSUNBZ0lDQWdiR1YwSUdOb2FXeGtWVkpNSUQwZ1kyaHBiR1JDWVhObFZWSk1JQ3NnWTJocGJHUTdYRzRnSUNBZ0lDQWdJR3hsZENCc2FYTjBaVzVsY2lBOUlGOTBhR2x6TGw5aWRYTXVZV1JrVEdsemRHVnVaWElvWTJocGJHUlZVa3dzSUNodGMyY3BJRDArSUh0Y2JpQWdJQ0FnSUNBZ0lDQXZMMmxuYm05eVpTQnRjMmNnYzJWdWRDQmllU0JvYVcxelpXeG1YRzRnSUNBZ0lDQWdJQ0FnYVdZZ0tHMXpaeTVtY205dElDRTlQU0J2ZDI1bGNpa2dlMXh1SUNBZ0lDQWdJQ0FnSUNBZ1kyOXVjMjlzWlM1c2IyY29iWE5uS1R0Y2JpQWdJQ0FnSUNBZ0lDQjlYRzRnSUNBZ0lDQWdJSDBwTzF4dVhHNGdJQ0FnSUNBZ0lGOTBhR2x6TGw5amFHbHNaSEpsYmt4cGMzUmxibVZ5Y3k1d2RYTm9LR3hwYzNSbGJtVnlLVHRjYmlBZ0lDQWdJSDBwTzF4dUlDQWdJSDBxTDF4dUlDQjlYRzVjYmlBZ1gzSmxiR1ZoYzJWTWFYTjBaVzVsY25Nb0tTQjdYRzRnSUNBZ2JHVjBJRjkwYUdseklEMGdkR2hwY3p0Y2JseHVJQ0FnSUY5MGFHbHpMbDlzYVhOMFpXNWxjaTV5WlcxdmRtVW9LVHRjYmx4dUlDQWdJQzhxWDNSb2FYTXVYMk5vYVd4a2NtVnVUR2x6ZEdWdVpYSnpMbVp2Y2tWaFkyZ29LR3hwYzNSbGJtVnlLU0E5UGlCN1hHNGdJQ0FnSUNCc2FYTjBaVzVsY2k1eVpXMXZkbVVvS1R0Y2JpQWdJQ0I5S1RzcUwxeHVJQ0I5WEc1Y2JpQWdaMlYwSUdOb2FXeGtjbVZ1S0NrZ2V5QnlaWFIxY200Z2RHaHBjeTVmWTJocGJHUnlaVzQ3SUgxY2JseHVJQ0JoY0hCc2VTaHZZbk5sY25abGNpa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNGdJQ0FnWDNSb2FYTXVYMk5vWVc1blpYTXVabTl5UldGamFDZ29ZMmhoYm1kbEtTQTlQaUI3WEc0Z0lDQWdJQ0J2WW5ObGNuWmxjaTVmWTJoaGJtZGxUMkpxWldOMEtHOWljMlZ5ZG1WeUxsOXplVzVqVDJKcUxDQmphR0Z1WjJVcE8xeHVJQ0FnSUgwcE8xeHVJQ0I5WEc1OVhHNWNibVY0Y0c5eWRDQmtaV1poZFd4MElFUmhkR0ZRY205MmFYTnBiMjVoYkR0Y2JseHVYRzVjYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTSUM4dlhHNHZMeUF1TDNOeVl5OXplVzVqYUdWeUwwUmhkR0ZRY205MmFYTnBiMjVoYkM1cWN5SXNJbTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdleUJjSW1SbFptRjFiSFJjSWpvZ2NtVnhkV2x5WlNoY0ltTnZjbVV0YW5NdmJHbGljbUZ5ZVM5bWJpOXZZbXBsWTNRdllYTnphV2R1WENJcExDQmZYMlZ6VFc5a2RXeGxPaUIwY25WbElIMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wySmhZbVZzTFhKMWJuUnBiV1V2WTI5eVpTMXFjeTl2WW1wbFkzUXZZWE56YVdkdUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXhOREJjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lpd2liVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQjdJRndpWkdWbVlYVnNkRndpT2lCeVpYRjFhWEpsS0Z3aVkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwyOWlhbVZqZEM5blpYUXRiM2R1TFhCeWIzQmxjblI1TFdSbGMyTnlhWEIwYjNKY0lpa3NJRjlmWlhOTmIyUjFiR1U2SUhSeWRXVWdmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZbUZpWld3dGNuVnVkR2x0WlM5amIzSmxMV3B6TDI5aWFtVmpkQzluWlhRdGIzZHVMWEJ5YjNCbGNuUjVMV1JsYzJOeWFYQjBiM0l1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURFME1seHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFpTENKeVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMlZ6Tmk1dlltcGxZM1F1WVhOemFXZHVKeWs3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhKbGNYVnBjbVVvSnk0dUx5NHVMMjF2WkhWc1pYTXZYMk52Y21VbktTNVBZbXBsWTNRdVlYTnphV2R1TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2YjJKcVpXTjBMMkZ6YzJsbmJpNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVFEzWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DSXNJbkpsY1hWcGNtVW9KeTR1THk0dUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNW5aWFF0YjNkdUxYQnliM0JsY25SNUxXUmxjMk55YVhCMGIzSW5LVHRjYm5aaGNpQWtUMkpxWldOMElEMGdjbVZ4ZFdseVpTZ25MaTR2TGk0dmJXOWtkV3hsY3k5ZlkyOXlaU2NwTGs5aWFtVmpkRHRjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRnWjJWMFQzZHVVSEp2Y0dWeWRIbEVaWE5qY21sd2RHOXlLR2wwTENCclpYa3BlMXh1SUNCeVpYUjFjbTRnSkU5aWFtVmpkQzVuWlhSUGQyNVFjbTl3WlhKMGVVUmxjMk55YVhCMGIzSW9hWFFzSUd0bGVTazdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2YjJKcVpXTjBMMmRsZEMxdmQyNHRjSEp2Y0dWeWRIa3RaR1Z6WTNKcGNIUnZjaTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTVRRNVhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0lzSWlkMWMyVWdjM1J5YVdOMEp6dGNiaTh2SURFNUxqRXVNaTR4SUU5aWFtVmpkQzVoYzNOcFoyNG9kR0Z5WjJWMExDQnpiM1Z5WTJVc0lDNHVMaWxjYm5aaGNpQm5aWFJMWlhseklDQTlJSEpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzFyWlhsekp5bGNiaUFnTENCblQxQlRJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMW5iM0J6SnlsY2JpQWdMQ0J3U1VVZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxd2FXVW5LVnh1SUNBc0lIUnZUMkpxWldOMElEMGdjbVZ4ZFdseVpTZ25MaTlmZEc4dGIySnFaV04wSnlsY2JpQWdMQ0JKVDJKcVpXTjBJQ0E5SUhKbGNYVnBjbVVvSnk0dlgybHZZbXBsWTNRbktWeHVJQ0FzSUNSaGMzTnBaMjRnSUQwZ1QySnFaV04wTG1GemMybG5ianRjYmx4dUx5OGdjMmh2ZFd4a0lIZHZjbXNnZDJsMGFDQnplVzFpYjJ4eklHRnVaQ0J6YUc5MWJHUWdhR0YyWlNCa1pYUmxjbTFwYm1semRHbGpJSEJ5YjNCbGNuUjVJRzl5WkdWeUlDaFdPQ0JpZFdjcFhHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlDRWtZWE56YVdkdUlIeDhJSEpsY1hWcGNtVW9KeTR2WDJaaGFXeHpKeWtvWm5WdVkzUnBiMjRvS1h0Y2JpQWdkbUZ5SUVFZ1BTQjdmVnh1SUNBZ0lDd2dRaUE5SUh0OVhHNGdJQ0FnTENCVElEMGdVM2x0WW05c0tDbGNiaUFnSUNBc0lFc2dQU0FuWVdKalpHVm1aMmhwYW10c2JXNXZjSEZ5YzNRbk8xeHVJQ0JCVzFOZElEMGdOenRjYmlBZ1N5NXpjR3hwZENnbkp5a3VabTl5UldGamFDaG1kVzVqZEdsdmJpaHJLWHNnUWx0clhTQTlJR3M3SUgwcE8xeHVJQ0J5WlhSMWNtNGdKR0Z6YzJsbmJpaDdmU3dnUVNsYlUxMGdJVDBnTnlCOGZDQlBZbXBsWTNRdWEyVjVjeWdrWVhOemFXZHVLSHQ5TENCQ0tTa3VhbTlwYmlnbkp5a2dJVDBnU3p0Y2JuMHBJRDhnWm5WdVkzUnBiMjRnWVhOemFXZHVLSFJoY21kbGRDd2djMjkxY21ObEtYc2dMeThnWlhOc2FXNTBMV1JwYzJGaWJHVXRiR2x1WlNCdWJ5MTFiblZ6WldRdGRtRnljMXh1SUNCMllYSWdWQ0FnSUNBZ1BTQjBiMDlpYW1WamRDaDBZWEpuWlhRcFhHNGdJQ0FnTENCaFRHVnVJQ0E5SUdGeVozVnRaVzUwY3k1c1pXNW5kR2hjYmlBZ0lDQXNJR2x1WkdWNElEMGdNVnh1SUNBZ0lDd2daMlYwVTNsdFltOXNjeUE5SUdkUFVGTXVabHh1SUNBZ0lDd2dhWE5GYm5WdElDQWdJQ0E5SUhCSlJTNW1PMXh1SUNCM2FHbHNaU2hoVEdWdUlENGdhVzVrWlhncGUxeHVJQ0FnSUhaaGNpQlRJQ0FnSUNBZ1BTQkpUMkpxWldOMEtHRnlaM1Z0Wlc1MGMxdHBibVJsZUNzclhTbGNiaUFnSUNBZ0lDd2dhMlY1Y3lBZ0lEMGdaMlYwVTNsdFltOXNjeUEvSUdkbGRFdGxlWE1vVXlrdVkyOXVZMkYwS0dkbGRGTjViV0p2YkhNb1V5a3BJRG9nWjJWMFMyVjVjeWhUS1Z4dUlDQWdJQ0FnTENCc1pXNW5kR2dnUFNCclpYbHpMbXhsYm1kMGFGeHVJQ0FnSUNBZ0xDQnFJQ0FnSUNBZ1BTQXdYRzRnSUNBZ0lDQXNJR3RsZVR0Y2JpQWdJQ0IzYUdsc1pTaHNaVzVuZEdnZ1BpQnFLV2xtS0dselJXNTFiUzVqWVd4c0tGTXNJR3RsZVNBOUlHdGxlWE5iYWlzclhTa3BWRnRyWlhsZElEMGdVMXRyWlhsZE8xeHVJQ0I5SUhKbGRIVnliaUJVTzF4dWZTQTZJQ1JoYzNOcFoyNDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5dlltcGxZM1F0WVhOemFXZHVMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F4TlRCY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJaXdpTHk4Z01Ua3VNUzR6TGpFZ1QySnFaV04wTG1GemMybG5iaWgwWVhKblpYUXNJSE52ZFhKalpTbGNiblpoY2lBa1pYaHdiM0owSUQwZ2NtVnhkV2x5WlNnbkxpOWZaWGh3YjNKMEp5azdYRzVjYmlSbGVIQnZjblFvSkdWNGNHOXlkQzVUSUNzZ0pHVjRjRzl5ZEM1R0xDQW5UMkpxWldOMEp5d2dlMkZ6YzJsbmJqb2djbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMV0Z6YzJsbmJpY3BmU2s3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwyVnpOaTV2WW1wbFkzUXVZWE56YVdkdUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXhOVE5jYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lpd2lMeThnTVRrdU1TNHlMallnVDJKcVpXTjBMbWRsZEU5M2JsQnliM0JsY25SNVJHVnpZM0pwY0hSdmNpaFBMQ0JRS1Z4dWRtRnlJSFJ2U1U5aWFtVmpkQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXBiMkpxWldOMEp5bGNiaUFnTENBa1oyVjBUM2R1VUhKdmNHVnlkSGxFWlhOamNtbHdkRzl5SUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXZHZjR1FuS1M1bU8xeHVYRzV5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0YzJGd0p5a29KMmRsZEU5M2JsQnliM0JsY25SNVJHVnpZM0pwY0hSdmNpY3NJR1oxYm1OMGFXOXVLQ2w3WEc0Z0lISmxkSFZ5YmlCbWRXNWpkR2x2YmlCblpYUlBkMjVRY205d1pYSjBlVVJsYzJOeWFYQjBiM0lvYVhRc0lHdGxlU2w3WEc0Z0lDQWdjbVYwZFhKdUlDUm5aWFJQZDI1UWNtOXdaWEowZVVSbGMyTnlhWEIwYjNJb2RHOUpUMkpxWldOMEtHbDBLU3dnYTJWNUtUdGNiaUFnZlR0Y2JuMHBPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5bGN6WXViMkpxWldOMExtZGxkQzF2ZDI0dGNISnZjR1Z5ZEhrdFpHVnpZM0pwY0hSdmNpNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVFUxWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DSXNJbWx0Y0c5eWRDQlRlVzVqYUdWeUlHWnliMjBnSnk0dmMzbHVZMmhsY2k5VGVXNWphR1Z5Snp0Y2JtbHRjRzl5ZENCRVlYUmhUMkpxWldOMFVtVndiM0owWlhJZ1puSnZiU0FuTGk5emVXNWphR1Z5TDBSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2ljN1hHNXBiWEJ2Y25RZ1JHRjBZVTlpYW1WamRFOWljMlZ5ZG1WeUlHWnliMjBnSnk0dmMzbHVZMmhsY2k5RVlYUmhUMkpxWldOMFQySnpaWEoyWlhJbk8xeHVYRzVsZUhCdmNuUWdlMU41Ym1Ob1pYSXNJRVJoZEdGUFltcGxZM1JTWlhCdmNuUmxjaXdnUkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5ZlR0Y2JseHVYRzVjYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTSUM4dlhHNHZMeUF1TDNOeVl5OVRlVzVqYUdWeUxtcHpJbDBzSW5OdmRYSmpaVkp2YjNRaU9pSWlmUT09CgovKioqLyB9LAovKiAxNzkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gdmVyc2lvbjogMC41LjEKCS8vIGRhdGU6IFR1ZSBNYXIgMDcgMjAxNyAxMzoyMTo1MSBHTVQrMDAwMCAoV0VUKQoJLy8gbGljZW5jZTogCgkvKioKCSogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCgkqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoJKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKCSogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSoKCSogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkqCgkqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkqCgkqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkqKi8KCgoJKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCQlpZih0cnVlKQoJCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCQllbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkKCQkJZGVmaW5lKCJJZGVudGl0eUZhY3RvcnkiLCBbXSwgZmFjdG9yeSk7CgkJZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpCgkJCWV4cG9ydHNbIklkZW50aXR5RmFjdG9yeSJdID0gZmFjdG9yeSgpOwoJCWVsc2UKCQkJcm9vdFsiIl0gPSByb290WyIiXSB8fCB7fSwgcm9vdFsiIl1bIklkZW50aXR5RmFjdG9yeSJdID0gZmFjdG9yeSgpOwoJfSkodGhpcywgZnVuY3Rpb24oKSB7CglyZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAoJLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKCS8qKioqKiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgoJLyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKCS8qKioqKiovCgkvKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQoJLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKCS8qKioqKiovIAkJCXJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzOwoJLyoqKioqKi8KCS8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKCS8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewoJLyoqKioqKi8gCQkJaTogbW9kdWxlSWQsCgkvKioqKioqLyAJCQlsOiBmYWxzZSwKCS8qKioqKiovIAkJCWV4cG9ydHM6IHt9CgkvKioqKioqLyAJCX07CgkvKioqKioqLwoJLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KCS8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7CgkvKioqKioqLwoJLyoqKioqKi8gCQkvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkCgkvKioqKioqLyAJCW1vZHVsZS5sID0gdHJ1ZTsKCS8qKioqKiovCgkvKioqKioqLyAJCS8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlCgkvKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKCS8qKioqKiovIAl9CgkvKioqKioqLwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKQoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlczsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gaWRlbnRpdHkgZnVuY3Rpb24gZm9yIGNhbGxpbmcgaGFybW9ueSBpbXBvcnRzIHdpdGggdGhlIGNvcnJlY3QgY29udGV4dAoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7CgkvKioqKioqLyAJCWlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKCS8qKioqKiovIAkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7CgkvKioqKioqLyAJCQkJY29uZmlndXJhYmxlOiBmYWxzZSwKCS8qKioqKiovIAkJCQllbnVtZXJhYmxlOiB0cnVlLAoJLyoqKioqKi8gCQkJCWdldDogZ2V0dGVyCgkvKioqKioqLyAJCQl9KTsKCS8qKioqKiovIAkJfQoJLyoqKioqKi8gCX07CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7CgkvKioqKioqLyAJCXZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgPwoJLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKCS8qKioqKiovIAkJCWZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07CgkvKioqKioqLyAJCV9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTsKCS8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKCS8qKioqKiovIAl9OwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKCS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gIiI7CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwoJLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDE2MSk7CgkvKioqKioqLyB9KQoJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCS8qKioqKiovICh7CgoJLyoqKi8gMTE5OgoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8qKgoJKiBUaGUgVXNlclByb2ZpbGUgYWNjb3JkaW5nIHRvIFVzZXIgSWRlbnRpdHkgRGF0YSBNb2RlbAoJKi8KCgl2YXIgVXNlclByb2ZpbGUgPSBmdW5jdGlvbiBVc2VyUHJvZmlsZSh1c2VybmFtZSwgdXNlclVSTCwgYXZhdGFyLCBjbiwgbG9jYWxlKSB7CgkgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFVzZXJQcm9maWxlKTsKCgoJICBpZiAodXNlcm5hbWUpIHsKCSAgICB0aGlzLnVzZXJuYW1lID0gdXNlcm5hbWU7CgkgIH0KCSAgaWYgKGF2YXRhcikgewoJICAgIHRoaXMuYXZhdGFyID0gYXZhdGFyOwoJICB9CgkgIGlmIChjbikgewoJICAgIHRoaXMuY24gPSBjbjsKCSAgfQoJICBpZiAobG9jYWxlKSB7CgkgICAgdGhpcy5sb2NhbGUgPSBsb2NhbGU7CgkgIH0KCSAgaWYgKHVzZXJVUkwpIHsKCSAgICB0aGlzLnVzZXJVUkwgPSB1c2VyVVJMOwoJICB9Cgl9OwoKCWV4cG9ydHMuZGVmYXVsdCA9IFVzZXJQcm9maWxlOwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWyJkZWZhdWx0Il07CgoJLyoqKi8gfSksCgoJLyoqKi8gMTI4OgoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCgl2YXIgX1VzZXJQcm9maWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTkpOwoKCXZhciBfVXNlclByb2ZpbGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfVXNlclByb2ZpbGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJdmFyIE1lc3NhZ2VCb2R5SWRlbnRpdHkgPSBmdW5jdGlvbiBNZXNzYWdlQm9keUlkZW50aXR5KHVzZXJuYW1lLCB1c2VyVVJMLCBhdmF0YXIsIGNuLCBsb2NhbGUsIGlkcCwgYXNzZXJ0aW9uKSB7CgkgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIE1lc3NhZ2VCb2R5SWRlbnRpdHkpOwoKCgkgIGlmICghaWRwKSB0aHJvdyBuZXcgRXJyb3IoJ0lEUCBzaG91bGQgYmUgYSBwYXJhbWV0ZXInKTsKCSAgaWYgKCF1c2VybmFtZSkgdGhyb3cgbmV3IEVycm9yKCd1c2VybmFtZSBzaG91bGQgYmUgYSBwYXJhbWV0ZXInKTsKCgkgIHRoaXMuaWRwID0gaWRwOwoKCSAgaWYgKGFzc2VydGlvbikgewoJICAgIHRoaXMuYXNzZXJ0aW9uID0gYXNzZXJ0aW9uOwoJICB9CgkgIHRoaXMudXNlclByb2ZpbGUgPSBuZXcgX1VzZXJQcm9maWxlMi5kZWZhdWx0KHVzZXJuYW1lLCB1c2VyVVJMLCBhdmF0YXIsIGNuLCBsb2NhbGUpOwoJfTsgLyoqCgkgICAqIFRoZSBJZGVudGl0eSBpbmZvIHRvIGJlIGFkZGVkIHRvIE1lc3NhZ2UuQm9keS5JZGVudGl0eQoJICAgKi8KCglleHBvcnRzLmRlZmF1bHQgPSBNZXNzYWdlQm9keUlkZW50aXR5OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSksCgoJLyoqKi8gMTYxOgoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLk1lc3NhZ2VCb2R5SWRlbnRpdHkgPSBleHBvcnRzLlVzZXJQcm9maWxlID0gdW5kZWZpbmVkOwoKCXZhciBfVXNlclByb2ZpbGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOSk7CgoJdmFyIF9Vc2VyUHJvZmlsZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Vc2VyUHJvZmlsZSk7CgoJdmFyIF9NZXNzYWdlQm9keUlkZW50aXR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjgpOwoKCXZhciBfTWVzc2FnZUJvZHlJZGVudGl0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9NZXNzYWdlQm9keUlkZW50aXR5KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuVXNlclByb2ZpbGUgPSBfVXNlclByb2ZpbGUyLmRlZmF1bHQ7CglleHBvcnRzLk1lc3NhZ2VCb2R5SWRlbnRpdHkgPSBfTWVzc2FnZUJvZHlJZGVudGl0eTIuZGVmYXVsdDsKCWV4cG9ydHMuZGVmYXVsdCA9IF9NZXNzYWdlQm9keUlkZW50aXR5Mi5kZWZhdWx0OwoKCS8qKiovIH0pLAoKCS8qKiovIDg6CgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCWV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKCSAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKCSAgfQoJfTsKCgkvKioqLyB9KQoKCS8qKioqKiovIH0pOwoJfSk7CgkvLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtODtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSnpiM1Z5WTJWeklqcGJJbmRsWW5CaFkyczZMeTh2ZDJWaWNHRmpheTkxYm1sMlpYSnpZV3hOYjJSMWJHVkVaV1pwYm1sMGFXOXVQelZqWVRZcUtpb3FLaW9xS2lvaUxDSjNaV0p3WVdOck9pOHZMM2RsWW5CaFkyc3ZZbTl2ZEhOMGNtRndJRGhtWTJRek5tSTFOR0U1WVdZMU5UWTVNak15UHpSak9USXFLaW9xS2lvcUtpb2lMQ0ozWldKd1lXTnJPaTh2THk0dmMzSmpMMmxrWlc1MGFYUjVMMVZ6WlhKUWNtOW1hV3hsTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDNOeVl5OXBaR1Z1ZEdsMGVTOU5aWE56WVdkbFFtOWtlVWxrWlc1MGFYUjVMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMM055WXk5SlpHVnVkR2wwZVVaaFkzUnZjbmt1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMmhsYkhCbGNuTXZZMnhoYzNORFlXeHNRMmhsWTJzdWFuTS9NakZoWmlvcUtpb3FLaW9xS2lKZExDSnVZVzFsY3lJNld5SlZjMlZ5VUhKdlptbHNaU0lzSW5WelpYSnVZVzFsSWl3aWRYTmxjbFZTVENJc0ltRjJZWFJoY2lJc0ltTnVJaXdpYkc5allXeGxJaXdpVFdWemMyRm5aVUp2WkhsSlpHVnVkR2wwZVNJc0ltbGtjQ0lzSW1GemMyVnlkR2x2YmlJc0lrVnljbTl5SWl3aWRYTmxjbEJ5YjJacGJHVWlYU3dpYldGd2NHbHVaM01pT2lKQlFVRkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN3eVFrRkJNa0k3UVVGRE0wSXNRMEZCUXp0QlFVTkVMRTg3UVVOV1FUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJPenM3UVVGSFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN08wRkJSVUU3UVVGRFFTeHRSRUZCTWtNc1kwRkJZenM3UVVGRmVrUTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeGhRVUZMTzBGQlEwdzdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeHRRMEZCTWtJc01FSkJRVEJDTEVWQlFVVTdRVUZEZGtRc2VVTkJRV2xETEdWQlFXVTdRVUZEYUVRN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRXNPRVJCUVhORUxDdEVRVUVyUkRzN1FVRkZja2c3UVVGRFFUczdRVUZGUVR0QlFVTkJPenM3T3pzN096czdPenM3T3pzN096czdPenM3UVVOb1JVRTdPenM3U1VGTFRVRXNWeXhIUVVWS0xIRkNRVUZaUXl4UlFVRmFMRVZCUVhOQ1F5eFBRVUYwUWl4RlFVRXJRa01zVFVGQkwwSXNSVUZCZFVORExFVkJRWFpETEVWQlFUSkRReXhOUVVFelF5eEZRVUZ0UkR0QlFVRkJPenM3UVVGRmFrUXNUVUZCU1Vvc1VVRkJTaXhGUVVGak8wRkJRVVVzVTBGQlMwRXNVVUZCVEN4SFFVRm5Ra0VzVVVGQmFFSTdRVUZCTWtJN1FVRkRNME1zVFVGQlNVVXNUVUZCU2l4RlFVRlpPMEZCUVVVc1UwRkJTMEVzVFVGQlRDeEhRVUZqUVN4TlFVRmtPMEZCUVhWQ08wRkJRM0pETEUxQlFVbERMRVZCUVVvc1JVRkJVVHRCUVVGRkxGTkJRVXRCTEVWQlFVd3NSMEZCVlVFc1JVRkJWanRCUVVGbE8wRkJRM3BDTEUxQlFVbERMRTFCUVVvc1JVRkJXVHRCUVVGRkxGTkJRVXRCTEUxQlFVd3NSMEZCWTBFc1RVRkJaRHRCUVVGMVFqdEJRVU55UXl4TlFVRkpTQ3hQUVVGS0xFVkJRV0U3UVVGQlJTeFRRVUZMUVN4UFFVRk1MRWRCUVdWQkxFOUJRV1k3UVVGQmVVSTdRVUZGZWtNc1F6czdhMEpCUjFsR0xGYzdPenM3T3pzN096czdPenM3T3pzN096czdRVU5rWmpzN096czdPMGxCUlUxTkxHMUNMRWRCUlVvc05rSkJRVmxNTEZGQlFWb3NSVUZCYzBKRExFOUJRWFJDTEVWQlFTdENReXhOUVVFdlFpeEZRVUYxUTBNc1JVRkJka01zUlVGQk1rTkRMRTFCUVRORExFVkJRVzFFUlN4SFFVRnVSQ3hGUVVGM1JFTXNVMEZCZUVRc1JVRkJiVVU3UVVGQlFUczdPMEZCUldwRkxFMUJRVWtzUTBGQlEwUXNSMEZCVEN4RlFVRlZMRTFCUVUwc1NVRkJTVVVzUzBGQlNpeERRVUZWTERKQ1FVRldMRU5CUVU0N1FVRkRWaXhOUVVGSkxFTkJRVU5TTEZGQlFVd3NSVUZCWlN4TlFVRk5MRWxCUVVsUkxFdEJRVW9zUTBGQlZTeG5RMEZCVml4RFFVRk9PenRCUVVWbUxFOUJRVXRHTEVkQlFVd3NSMEZCVjBFc1IwRkJXRHM3UVVGRlFTeE5RVUZKUXl4VFFVRktMRVZCUVc5Q08wRkJRVVVzVTBGQlMwRXNVMEZCVEN4SFFVRnBRa0VzVTBGQmFrSTdRVUZCTmtJN1FVRkRia1FzVDBGQlMwVXNWMEZCVEN4SFFVRnRRaXd3UWtGQlowSlVMRkZCUVdoQ0xFVkJRVEJDUXl4UFFVRXhRaXhGUVVGdFEwTXNUVUZCYmtNc1JVRkJNa05ETEVWQlFUTkRMRVZCUVN0RFF5eE5RVUV2UXl4RFFVRnVRanRCUVVWRUxFTXNSVUZzUWtnN096czdhMEpCZFVKbFF5eHRRanM3T3pzN096czdPenM3T3pzN096dEJRM1pDWmpzN096dEJRVU5CT3pzN096czdVVUZGVVU0c1Z6dFJRVUZoVFN4dFFqczdPenM3T3pzN08wRkRTSEpDT3p0QlFVVkJPenRCUVVWQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSU0lzSW1acGJHVWlPaUpKWkdWdWRHbDBlVVpoWTNSdmNua3Vhbk1pTENKemIzVnlZMlZ6UTI5dWRHVnVkQ0k2V3lJb1puVnVZM1JwYjI0Z2QyVmljR0ZqYTFWdWFYWmxjbk5oYkUxdlpIVnNaVVJsWm1sdWFYUnBiMjRvY205dmRDd2dabUZqZEc5eWVTa2dlMXh1WEhScFppaDBlWEJsYjJZZ1pYaHdiM0owY3lBOVBUMGdKMjlpYW1WamRDY2dKaVlnZEhsd1pXOW1JRzF2WkhWc1pTQTlQVDBnSjI5aWFtVmpkQ2NwWEc1Y2RGeDBiVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1ZV04wYjNKNUtDazdYRzVjZEdWc2MyVWdhV1lvZEhsd1pXOW1JR1JsWm1sdVpTQTlQVDBnSjJaMWJtTjBhVzl1SnlBbUppQmtaV1pwYm1VdVlXMWtLVnh1WEhSY2RHUmxabWx1WlNoY0lrbGtaVzUwYVhSNVJtRmpkRzl5ZVZ3aUxDQmJYU3dnWm1GamRHOXllU2s3WEc1Y2RHVnNjMlVnYVdZb2RIbHdaVzltSUdWNGNHOXlkSE1nUFQwOUlDZHZZbXBsWTNRbktWeHVYSFJjZEdWNGNHOXlkSE5iWENKSlpHVnVkR2wwZVVaaFkzUnZjbmxjSWwwZ1BTQm1ZV04wYjNKNUtDazdYRzVjZEdWc2MyVmNibHgwWEhSeWIyOTBXMXdpWENKZElEMGdjbTl2ZEZ0Y0lsd2lYU0I4ZkNCN2ZTd2djbTl2ZEZ0Y0lsd2lYVnRjSWtsa1pXNTBhWFI1Um1GamRHOXllVndpWFNBOUlHWmhZM1J2Y25rb0tUdGNibjBwS0hSb2FYTXNJR1oxYm1OMGFXOXVLQ2tnZTF4dWNtVjBkWEp1SUZ4dVhHNWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNJQzh2WEc0dkx5QjNaV0p3WVdOckwzVnVhWFpsY25OaGJFMXZaSFZzWlVSbFptbHVhWFJwYjI0aUxDSWdYSFF2THlCVWFHVWdiVzlrZFd4bElHTmhZMmhsWEc0Z1hIUjJZWElnYVc1emRHRnNiR1ZrVFc5a2RXeGxjeUE5SUh0OU8xeHVYRzRnWEhRdkx5QlVhR1VnY21WeGRXbHlaU0JtZFc1amRHbHZibHh1SUZ4MFpuVnVZM1JwYjI0Z1gxOTNaV0p3WVdOclgzSmxjWFZwY21WZlh5aHRiMlIxYkdWSlpDa2dlMXh1WEc0Z1hIUmNkQzh2SUVOb1pXTnJJR2xtSUcxdlpIVnNaU0JwY3lCcGJpQmpZV05vWlZ4dUlGeDBYSFJwWmlocGJuTjBZV3hzWldSTmIyUjFiR1Z6VzIxdlpIVnNaVWxrWFNsY2JpQmNkRngwWEhSeVpYUjFjbTRnYVc1emRHRnNiR1ZrVFc5a2RXeGxjMXR0YjJSMWJHVkpaRjB1Wlhod2IzSjBjenRjYmx4dUlGeDBYSFF2THlCRGNtVmhkR1VnWVNCdVpYY2diVzlrZFd4bElDaGhibVFnY0hWMElHbDBJR2x1ZEc4Z2RHaGxJR05oWTJobEtWeHVJRngwWEhSMllYSWdiVzlrZFd4bElEMGdhVzV6ZEdGc2JHVmtUVzlrZFd4bGMxdHRiMlIxYkdWSlpGMGdQU0I3WEc0Z1hIUmNkRngwYVRvZ2JXOWtkV3hsU1dRc1hHNGdYSFJjZEZ4MGJEb2dabUZzYzJVc1hHNGdYSFJjZEZ4MFpYaHdiM0owY3pvZ2UzMWNiaUJjZEZ4MGZUdGNibHh1SUZ4MFhIUXZMeUJGZUdWamRYUmxJSFJvWlNCdGIyUjFiR1VnWm5WdVkzUnBiMjVjYmlCY2RGeDBiVzlrZFd4bGMxdHRiMlIxYkdWSlpGMHVZMkZzYkNodGIyUjFiR1V1Wlhod2IzSjBjeXdnYlc5a2RXeGxMQ0J0YjJSMWJHVXVaWGh3YjNKMGN5d2dYMTkzWldKd1lXTnJYM0psY1hWcGNtVmZYeWs3WEc1Y2JpQmNkRngwTHk4Z1JteGhaeUIwYUdVZ2JXOWtkV3hsSUdGeklHeHZZV1JsWkZ4dUlGeDBYSFJ0YjJSMWJHVXViQ0E5SUhSeWRXVTdYRzVjYmlCY2RGeDBMeThnVW1WMGRYSnVJSFJvWlNCbGVIQnZjblJ6SUc5bUlIUm9aU0J0YjJSMWJHVmNiaUJjZEZ4MGNtVjBkWEp1SUcxdlpIVnNaUzVsZUhCdmNuUnpPMXh1SUZ4MGZWeHVYRzVjYmlCY2RDOHZJR1Y0Y0c5elpTQjBhR1VnYlc5a2RXeGxjeUJ2WW1wbFkzUWdLRjlmZDJWaWNHRmphMTl0YjJSMWJHVnpYMThwWEc0Z1hIUmZYM2RsWW5CaFkydGZjbVZ4ZFdseVpWOWZMbTBnUFNCdGIyUjFiR1Z6TzF4dVhHNGdYSFF2THlCbGVIQnZjMlVnZEdobElHMXZaSFZzWlNCallXTm9aVnh1SUZ4MFgxOTNaV0p3WVdOclgzSmxjWFZwY21WZlh5NWpJRDBnYVc1emRHRnNiR1ZrVFc5a2RXeGxjenRjYmx4dUlGeDBMeThnYVdSbGJuUnBkSGtnWm5WdVkzUnBiMjRnWm05eUlHTmhiR3hwYm1jZ2FHRnliVzl1ZVNCcGJYQnZjblJ6SUhkcGRHZ2dkR2hsSUdOdmNuSmxZM1FnWTI5dWRHVjRkRnh1SUZ4MFgxOTNaV0p3WVdOclgzSmxjWFZwY21WZlh5NXBJRDBnWm5WdVkzUnBiMjRvZG1Gc2RXVXBJSHNnY21WMGRYSnVJSFpoYkhWbE95QjlPMXh1WEc0Z1hIUXZMeUJrWldacGJtVWdaMlYwZEdWeUlHWjFibU4wYVc5dUlHWnZjaUJvWVhKdGIyNTVJR1Y0Y0c5eWRITmNiaUJjZEY5ZmQyVmljR0ZqYTE5eVpYRjFhWEpsWDE4dVpDQTlJR1oxYm1OMGFXOXVLR1Y0Y0c5eWRITXNJRzVoYldVc0lHZGxkSFJsY2lrZ2UxeHVJRngwWEhScFppZ2hYMTkzWldKd1lXTnJYM0psY1hWcGNtVmZYeTV2S0dWNGNHOXlkSE1zSUc1aGJXVXBLU0I3WEc0Z1hIUmNkRngwVDJKcVpXTjBMbVJsWm1sdVpWQnliM0JsY25SNUtHVjRjRzl5ZEhNc0lHNWhiV1VzSUh0Y2JpQmNkRngwWEhSY2RHTnZibVpwWjNWeVlXSnNaVG9nWm1Gc2MyVXNYRzRnWEhSY2RGeDBYSFJsYm5WdFpYSmhZbXhsT2lCMGNuVmxMRnh1SUZ4MFhIUmNkRngwWjJWME9pQm5aWFIwWlhKY2JpQmNkRngwWEhSOUtUdGNiaUJjZEZ4MGZWeHVJRngwZlR0Y2JseHVJRngwTHk4Z1oyVjBSR1ZtWVhWc2RFVjRjRzl5ZENCbWRXNWpkR2x2YmlCbWIzSWdZMjl0Y0dGMGFXSnBiR2wwZVNCM2FYUm9JRzV2Ymkxb1lYSnRiMjU1SUcxdlpIVnNaWE5jYmlCY2RGOWZkMlZpY0dGamExOXlaWEYxYVhKbFgxOHViaUE5SUdaMWJtTjBhVzl1S0cxdlpIVnNaU2tnZTF4dUlGeDBYSFIyWVhJZ1oyVjBkR1Z5SUQwZ2JXOWtkV3hsSUNZbUlHMXZaSFZzWlM1ZlgyVnpUVzlrZFd4bElEOWNiaUJjZEZ4MFhIUm1kVzVqZEdsdmJpQm5aWFJFWldaaGRXeDBLQ2tnZXlCeVpYUjFjbTRnYlc5a2RXeGxXeWRrWldaaGRXeDBKMTA3SUgwZ09seHVJRngwWEhSY2RHWjFibU4wYVc5dUlHZGxkRTF2WkhWc1pVVjRjRzl5ZEhNb0tTQjdJSEpsZEhWeWJpQnRiMlIxYkdVN0lIMDdYRzRnWEhSY2RGOWZkMlZpY0dGamExOXlaWEYxYVhKbFgxOHVaQ2huWlhSMFpYSXNJQ2RoSnl3Z1oyVjBkR1Z5S1R0Y2JpQmNkRngwY21WMGRYSnVJR2RsZEhSbGNqdGNiaUJjZEgwN1hHNWNiaUJjZEM4dklFOWlhbVZqZEM1d2NtOTBiM1I1Y0dVdWFHRnpUM2R1VUhKdmNHVnlkSGt1WTJGc2JGeHVJRngwWDE5M1pXSndZV05yWDNKbGNYVnBjbVZmWHk1dklEMGdablZ1WTNScGIyNG9iMkpxWldOMExDQndjbTl3WlhKMGVTa2dleUJ5WlhSMWNtNGdUMkpxWldOMExuQnliM1J2ZEhsd1pTNW9ZWE5QZDI1UWNtOXdaWEowZVM1allXeHNLRzlpYW1WamRDd2djSEp2Y0dWeWRIa3BPeUI5TzF4dVhHNGdYSFF2THlCZlgzZGxZbkJoWTJ0ZmNIVmliR2xqWDNCaGRHaGZYMXh1SUZ4MFgxOTNaV0p3WVdOclgzSmxjWFZwY21WZlh5NXdJRDBnWENKY0lqdGNibHh1SUZ4MEx5OGdURzloWkNCbGJuUnllU0J0YjJSMWJHVWdZVzVrSUhKbGRIVnliaUJsZUhCdmNuUnpYRzRnWEhSeVpYUjFjbTRnWDE5M1pXSndZV05yWDNKbGNYVnBjbVZmWHloZlgzZGxZbkJoWTJ0ZmNtVnhkV2x5WlY5ZkxuTWdQU0F4TmpFcE8xeHVYRzVjYmx4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZJZ0x5OWNiaTh2SUhkbFluQmhZMnN2WW05dmRITjBjbUZ3SURobVkyUXpObUkxTkdFNVlXWTFOVFk1TWpNeUlpd2lMeW9xWEc0cUlGUm9aU0JWYzJWeVVISnZabWxzWlNCaFkyTnZjbVJwYm1jZ2RHOGdWWE5sY2lCSlpHVnVkR2wwZVNCRVlYUmhJRTF2WkdWc1hHNHFMMXh1WEc1Y2JtTnNZWE56SUZWelpYSlFjbTltYVd4bElIdGNibHh1SUNCamIyNXpkSEoxWTNSdmNpaDFjMlZ5Ym1GdFpTd2dkWE5sY2xWU1RDd2dZWFpoZEdGeUxDQmpiaXdnYkc5allXeGxLU0I3WEc1Y2JpQWdJQ0JwWmlBb2RYTmxjbTVoYldVcElIc2dkR2hwY3k1MWMyVnlibUZ0WlNBOUlIVnpaWEp1WVcxbE95QjlYRzRnSUNBZ2FXWWdLR0YyWVhSaGNpa2dleUIwYUdsekxtRjJZWFJoY2lBOUlHRjJZWFJoY2pzZ2ZWeHVJQ0FnSUdsbUlDaGpiaWtnZXlCMGFHbHpMbU51SUQwZ1kyNDdJSDFjYmlBZ0lDQnBaaUFvYkc5allXeGxLU0I3SUhSb2FYTXViRzlqWVd4bElEMGdiRzlqWVd4bE95QjlYRzRnSUNBZ2FXWWdLSFZ6WlhKVlVrd3BJSHNnZEdocGN5NTFjMlZ5VlZKTUlEMGdkWE5sY2xWU1REc2dmVnh1WEc0Z0lIMWNibjFjYmx4dVpYaHdiM0owSUdSbFptRjFiSFFnVlhObGNsQnliMlpwYkdVN1hHNWNibHh1WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWlBdkwxeHVMeThnTGk5emNtTXZhV1JsYm5ScGRIa3ZWWE5sY2xCeWIyWnBiR1V1YW5NaUxDSXZLaXBjYmlvZ1ZHaGxJRWxrWlc1MGFYUjVJR2x1Wm04Z2RHOGdZbVVnWVdSa1pXUWdkRzhnVFdWemMyRm5aUzVDYjJSNUxrbGtaVzUwYVhSNVhHNHFMMXh1WEc1cGJYQnZjblFnVlhObGNsQnliMlpwYkdVZ1puSnZiU0FuTGk5VmMyVnlVSEp2Wm1sc1pTYzdYRzVjYm1Oc1lYTnpJRTFsYzNOaFoyVkNiMlI1U1dSbGJuUnBkSGtnZTF4dVhHNGdJR052Ym5OMGNuVmpkRzl5S0hWelpYSnVZVzFsTENCMWMyVnlWVkpNTENCaGRtRjBZWElzSUdOdUxDQnNiMk5oYkdVc0lHbGtjQ3dnWVhOelpYSjBhVzl1S1NCN1hHNWNiaUFnSUNCcFppQW9JV2xrY0NrZ2RHaHliM2NnYm1WM0lFVnljbTl5S0NkSlJGQWdjMmh2ZFd4a0lHSmxJR0VnY0dGeVlXMWxkR1Z5SnlrN1hHNGdJQ0FnYVdZZ0tDRjFjMlZ5Ym1GdFpTa2dkR2h5YjNjZ2JtVjNJRVZ5Y205eUtDZDFjMlZ5Ym1GdFpTQnphRzkxYkdRZ1ltVWdZU0J3WVhKaGJXVjBaWEluS1R0Y2JseHVJQ0FnSUhSb2FYTXVhV1J3SUQwZ2FXUndPMXh1WEc0Z0lDQWdhV1lnS0dGemMyVnlkR2x2YmlrZ0lDQWdJQ0I3SUhSb2FYTXVZWE56WlhKMGFXOXVJRDBnWVhOelpYSjBhVzl1T3lCOVhHNGdJQ0FnZEdocGN5NTFjMlZ5VUhKdlptbHNaU0E5SUc1bGR5QlZjMlZ5VUhKdlptbHNaU2gxYzJWeWJtRnRaU3dnZFhObGNsVlNUQ3dnWVhaaGRHRnlMQ0JqYml3Z2JHOWpZV3hsS1R0Y2JseHVJQ0I5WEc1Y2JuMWNibHh1WEc1bGVIQnZjblFnWkdWbVlYVnNkQ0JOWlhOellXZGxRbTlrZVVsa1pXNTBhWFI1TzF4dVhHNWNibHh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVklnTHk5Y2JpOHZJQzR2YzNKakwybGtaVzUwYVhSNUwwMWxjM05oWjJWQ2IyUjVTV1JsYm5ScGRIa3Vhbk1pTENKcGJYQnZjblFnVlhObGNsQnliMlpwYkdVZ1puSnZiU0FuTGk5cFpHVnVkR2wwZVM5VmMyVnlVSEp2Wm1sc1pTYzdYRzVwYlhCdmNuUWdUV1Z6YzJGblpVSnZaSGxKWkdWdWRHbDBlU0JtY205dElDY3VMMmxrWlc1MGFYUjVMMDFsYzNOaFoyVkNiMlI1U1dSbGJuUnBkSGtuTzF4dVhHNWxlSEJ2Y25RZ2UxVnpaWEpRY205bWFXeGxMQ0JOWlhOellXZGxRbTlrZVVsa1pXNTBhWFI1ZlR0Y2JtVjRjRzl5ZENCa1pXWmhkV3gwSUUxbGMzTmhaMlZDYjJSNVNXUmxiblJwZEhrN1hHNWNibHh1WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWlBdkwxeHVMeThnTGk5emNtTXZTV1JsYm5ScGRIbEdZV04wYjNKNUxtcHpJaXdpWENKMWMyVWdjM1J5YVdOMFhDSTdYRzVjYm1WNGNHOXlkSE11WDE5bGMwMXZaSFZzWlNBOUlIUnlkV1U3WEc1Y2JtVjRjRzl5ZEhNdVpHVm1ZWFZzZENBOUlHWjFibU4wYVc5dUlDaHBibk4wWVc1alpTd2dRMjl1YzNSeWRXTjBiM0lwSUh0Y2JpQWdhV1lnS0NFb2FXNXpkR0Z1WTJVZ2FXNXpkR0Z1WTJWdlppQkRiMjV6ZEhKMVkzUnZjaWtwSUh0Y2JpQWdJQ0IwYUhKdmR5QnVaWGNnVkhsd1pVVnljbTl5S0Z3aVEyRnVibTkwSUdOaGJHd2dZU0JqYkdGemN5QmhjeUJoSUdaMWJtTjBhVzl1WENJcE8xeHVJQ0I5WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMmhsYkhCbGNuTXZZMnhoYzNORFlXeHNRMmhsWTJzdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEaGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNBMklEY2dPQ0E1SURFd0lsMHNJbk52ZFhKalpWSnZiM1FpT2lJaWZRPT0KCi8qKiovIH0KLyoqKioqKi8gXSkKfSk7Cjs=",
      "sourceCodeClassname": "SlackProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-6f652c34-f0d9-fb93-9407-7f3e29ded6aa4",
    "version": 0.5,
    "description": "Description of SlackProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "slack.slack.com",
    "configuration": {},
    "messageSchemas": "",
    "dataObjects": [],
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": {
      "browser": true
    },
    "interworking": true
  },
  "IMSIWProtoStub": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuCi8vCi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwovLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQKLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCi8vIGZvbGxvd2luZyBjb25kaXRpb25zOgovLwovLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAovLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KLy8KLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgovLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOCi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAovLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRQovLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKZnVuY3Rpb24gRXZlbnRFbWl0dGVyKCkgewogIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fTsKICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkOwp9Cm1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyOwoKLy8gQmFja3dhcmRzLWNvbXBhdCB3aXRoIG5vZGUgMC4xMC54CkV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7CgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLl9ldmVudHMgPSB1bmRlZmluZWQ7CkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDsKCi8vIEJ5IGRlZmF1bHQgRXZlbnRFbWl0dGVycyB3aWxsIHByaW50IGEgd2FybmluZyBpZiBtb3JlIHRoYW4gMTAgbGlzdGVuZXJzIGFyZQovLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLgpFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycyA9IDEwOwoKLy8gT2J2aW91c2x5IG5vdCBhbGwgRW1pdHRlcnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gMTAuIFRoaXMgZnVuY3Rpb24gYWxsb3dzCi8vIHRoYXQgdG8gYmUgaW5jcmVhc2VkLiBTZXQgdG8gemVybyBmb3IgdW5saW1pdGVkLgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLnNldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uKG4pIHsKICBpZiAoIWlzTnVtYmVyKG4pIHx8IG4gPCAwIHx8IGlzTmFOKG4pKQogICAgdGhyb3cgVHlwZUVycm9yKCduIG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXInKTsKICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSBuOwogIHJldHVybiB0aGlzOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24odHlwZSkgewogIHZhciBlciwgaGFuZGxlciwgbGVuLCBhcmdzLCBpLCBsaXN0ZW5lcnM7CgogIGlmICghdGhpcy5fZXZlbnRzKQogICAgdGhpcy5fZXZlbnRzID0ge307CgogIC8vIElmIHRoZXJlIGlzIG5vICdlcnJvcicgZXZlbnQgbGlzdGVuZXIgdGhlbiB0aHJvdy4KICBpZiAodHlwZSA9PT0gJ2Vycm9yJykgewogICAgaWYgKCF0aGlzLl9ldmVudHMuZXJyb3IgfHwKICAgICAgICAoaXNPYmplY3QodGhpcy5fZXZlbnRzLmVycm9yKSAmJiAhdGhpcy5fZXZlbnRzLmVycm9yLmxlbmd0aCkpIHsKICAgICAgZXIgPSBhcmd1bWVudHNbMV07CiAgICAgIGlmIChlciBpbnN0YW5jZW9mIEVycm9yKSB7CiAgICAgICAgdGhyb3cgZXI7IC8vIFVuaGFuZGxlZCAnZXJyb3InIGV2ZW50CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gQXQgbGVhc3QgZ2l2ZSBzb21lIGtpbmQgb2YgY29udGV4dCB0byB0aGUgdXNlcgogICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoJ1VuY2F1Z2h0LCB1bnNwZWNpZmllZCAiZXJyb3IiIGV2ZW50LiAoJyArIGVyICsgJyknKTsKICAgICAgICBlcnIuY29udGV4dCA9IGVyOwogICAgICAgIHRocm93IGVycjsKICAgICAgfQogICAgfQogIH0KCiAgaGFuZGxlciA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCiAgaWYgKGlzVW5kZWZpbmVkKGhhbmRsZXIpKQogICAgcmV0dXJuIGZhbHNlOwoKICBpZiAoaXNGdW5jdGlvbihoYW5kbGVyKSkgewogICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7CiAgICAgIC8vIGZhc3QgY2FzZXMKICAgICAgY2FzZSAxOgogICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAyOgogICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIDM6CiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgLy8gc2xvd2VyCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CiAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKTsKICAgIH0KICB9IGVsc2UgaWYgKGlzT2JqZWN0KGhhbmRsZXIpKSB7CiAgICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKICAgIGxpc3RlbmVycyA9IGhhbmRsZXIuc2xpY2UoKTsKICAgIGxlbiA9IGxpc3RlbmVycy5sZW5ndGg7CiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspCiAgICAgIGxpc3RlbmVyc1tpXS5hcHBseSh0aGlzLCBhcmdzKTsKICB9CgogIHJldHVybiB0cnVlOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7CiAgdmFyIG07CgogIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpCiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpOwoKICBpZiAoIXRoaXMuX2V2ZW50cykKICAgIHRoaXMuX2V2ZW50cyA9IHt9OwoKICAvLyBUbyBhdm9pZCByZWN1cnNpb24gaW4gdGhlIGNhc2UgdGhhdCB0eXBlID09PSAibmV3TGlzdGVuZXIiISBCZWZvcmUKICAvLyBhZGRpbmcgaXQgdG8gdGhlIGxpc3RlbmVycywgZmlyc3QgZW1pdCAibmV3TGlzdGVuZXIiLgogIGlmICh0aGlzLl9ldmVudHMubmV3TGlzdGVuZXIpCiAgICB0aGlzLmVtaXQoJ25ld0xpc3RlbmVyJywgdHlwZSwKICAgICAgICAgICAgICBpc0Z1bmN0aW9uKGxpc3RlbmVyLmxpc3RlbmVyKSA/CiAgICAgICAgICAgICAgbGlzdGVuZXIubGlzdGVuZXIgOiBsaXN0ZW5lcik7CgogIGlmICghdGhpcy5fZXZlbnRzW3R5cGVdKQogICAgLy8gT3B0aW1pemUgdGhlIGNhc2Ugb2Ygb25lIGxpc3RlbmVyLiBEb24ndCBuZWVkIHRoZSBleHRyYSBhcnJheSBvYmplY3QuCiAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjsKICBlbHNlIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pKQogICAgLy8gSWYgd2UndmUgYWxyZWFkeSBnb3QgYW4gYXJyYXksIGp1c3QgYXBwZW5kLgogICAgdGhpcy5fZXZlbnRzW3R5cGVdLnB1c2gobGlzdGVuZXIpOwogIGVsc2UKICAgIC8vIEFkZGluZyB0aGUgc2Vjb25kIGVsZW1lbnQsIG5lZWQgdG8gY2hhbmdlIHRvIGFycmF5LgogICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gW3RoaXMuX2V2ZW50c1t0eXBlXSwgbGlzdGVuZXJdOwoKICAvLyBDaGVjayBmb3IgbGlzdGVuZXIgbGVhawogIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pICYmICF0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkKSB7CiAgICBpZiAoIWlzVW5kZWZpbmVkKHRoaXMuX21heExpc3RlbmVycykpIHsKICAgICAgbSA9IHRoaXMuX21heExpc3RlbmVyczsKICAgIH0gZWxzZSB7CiAgICAgIG0gPSBFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVyczsKICAgIH0KCiAgICBpZiAobSAmJiBtID4gMCAmJiB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoID4gbSkgewogICAgICB0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkID0gdHJ1ZTsKICAgICAgY29uc29sZS5lcnJvcignKG5vZGUpIHdhcm5pbmc6IHBvc3NpYmxlIEV2ZW50RW1pdHRlciBtZW1vcnkgJyArCiAgICAgICAgICAgICAgICAgICAgJ2xlYWsgZGV0ZWN0ZWQuICVkIGxpc3RlbmVycyBhZGRlZC4gJyArCiAgICAgICAgICAgICAgICAgICAgJ1VzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvIGluY3JlYXNlIGxpbWl0LicsCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLmxlbmd0aCk7CiAgICAgIGlmICh0eXBlb2YgY29uc29sZS50cmFjZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIC8vIG5vdCBzdXBwb3J0ZWQgaW4gSUUgMTAKICAgICAgICBjb25zb2xlLnRyYWNlKCk7CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiB0aGlzOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXI7CgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikgewogIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpCiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpOwoKICB2YXIgZmlyZWQgPSBmYWxzZTsKCiAgZnVuY3Rpb24gZygpIHsKICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgZyk7CgogICAgaWYgKCFmaXJlZCkgewogICAgICBmaXJlZCA9IHRydWU7CiAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CiAgfQoKICBnLmxpc3RlbmVyID0gbGlzdGVuZXI7CiAgdGhpcy5vbih0eXBlLCBnKTsKCiAgcmV0dXJuIHRoaXM7Cn07CgovLyBlbWl0cyBhICdyZW1vdmVMaXN0ZW5lcicgZXZlbnQgaWZmIHRoZSBsaXN0ZW5lciB3YXMgcmVtb3ZlZApFdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHsKICB2YXIgbGlzdCwgcG9zaXRpb24sIGxlbmd0aCwgaTsKCiAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSkKICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7CgogIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pCiAgICByZXR1cm4gdGhpczsKCiAgbGlzdCA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKICBsZW5ndGggPSBsaXN0Lmxlbmd0aDsKICBwb3NpdGlvbiA9IC0xOwoKICBpZiAobGlzdCA9PT0gbGlzdGVuZXIgfHwKICAgICAgKGlzRnVuY3Rpb24obGlzdC5saXN0ZW5lcikgJiYgbGlzdC5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7CiAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdOwogICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikKICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTsKCiAgfSBlbHNlIGlmIChpc09iamVjdChsaXN0KSkgewogICAgZm9yIChpID0gbGVuZ3RoOyBpLS0gPiAwOykgewogICAgICBpZiAobGlzdFtpXSA9PT0gbGlzdGVuZXIgfHwKICAgICAgICAgIChsaXN0W2ldLmxpc3RlbmVyICYmIGxpc3RbaV0ubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkgewogICAgICAgIHBvc2l0aW9uID0gaTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGlmIChwb3NpdGlvbiA8IDApCiAgICAgIHJldHVybiB0aGlzOwoKICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMSkgewogICAgICBsaXN0Lmxlbmd0aCA9IDA7CiAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07CiAgICB9IGVsc2UgewogICAgICBsaXN0LnNwbGljZShwb3NpdGlvbiwgMSk7CiAgICB9CgogICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikKICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTsKICB9CgogIHJldHVybiB0aGlzOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbih0eXBlKSB7CiAgdmFyIGtleSwgbGlzdGVuZXJzOwoKICBpZiAoIXRoaXMuX2V2ZW50cykKICAgIHJldHVybiB0aGlzOwoKICAvLyBub3QgbGlzdGVuaW5nIGZvciByZW1vdmVMaXN0ZW5lciwgbm8gbmVlZCB0byBlbWl0CiAgaWYgKCF0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpIHsKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKQogICAgICB0aGlzLl9ldmVudHMgPSB7fTsKICAgIGVsc2UgaWYgKHRoaXMuX2V2ZW50c1t0eXBlXSkKICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLy8gZW1pdCByZW1vdmVMaXN0ZW5lciBmb3IgYWxsIGxpc3RlbmVycyBvbiBhbGwgZXZlbnRzCiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsKICAgIGZvciAoa2V5IGluIHRoaXMuX2V2ZW50cykgewogICAgICBpZiAoa2V5ID09PSAncmVtb3ZlTGlzdGVuZXInKSBjb250aW51ZTsKICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoa2V5KTsKICAgIH0KICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCdyZW1vdmVMaXN0ZW5lcicpOwogICAgdGhpcy5fZXZlbnRzID0ge307CiAgICByZXR1cm4gdGhpczsKICB9CgogIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCiAgaWYgKGlzRnVuY3Rpb24obGlzdGVuZXJzKSkgewogICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpOwogIH0gZWxzZSBpZiAobGlzdGVuZXJzKSB7CiAgICAvLyBMSUZPIG9yZGVyCiAgICB3aGlsZSAobGlzdGVuZXJzLmxlbmd0aCkKICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnNbbGlzdGVuZXJzLmxlbmd0aCAtIDFdKTsKICB9CiAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTsKCiAgcmV0dXJuIHRoaXM7Cn07CgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uKHR5cGUpIHsKICB2YXIgcmV0OwogIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pCiAgICByZXQgPSBbXTsKICBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoaXMuX2V2ZW50c1t0eXBlXSkpCiAgICByZXQgPSBbdGhpcy5fZXZlbnRzW3R5cGVdXTsKICBlbHNlCiAgICByZXQgPSB0aGlzLl9ldmVudHNbdHlwZV0uc2xpY2UoKTsKICByZXR1cm4gcmV0Owp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24odHlwZSkgewogIGlmICh0aGlzLl9ldmVudHMpIHsKICAgIHZhciBldmxpc3RlbmVyID0gdGhpcy5fZXZlbnRzW3R5cGVdOwoKICAgIGlmIChpc0Z1bmN0aW9uKGV2bGlzdGVuZXIpKQogICAgICByZXR1cm4gMTsKICAgIGVsc2UgaWYgKGV2bGlzdGVuZXIpCiAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDsKICB9CiAgcmV0dXJuIDA7Cn07CgpFdmVudEVtaXR0ZXIubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKGVtaXR0ZXIsIHR5cGUpIHsKICByZXR1cm4gZW1pdHRlci5saXN0ZW5lckNvdW50KHR5cGUpOwp9OwoKZnVuY3Rpb24gaXNGdW5jdGlvbihhcmcpIHsKICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Z1bmN0aW9uJzsKfQoKZnVuY3Rpb24gaXNOdW1iZXIoYXJnKSB7CiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdudW1iZXInOwp9CgpmdW5jdGlvbiBpc09iamVjdChhcmcpIHsKICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsOwp9CgpmdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHsKICByZXR1cm4gYXJnID09PSB2b2lkIDA7Cn0KCn0se31dLDI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewp2YXIgZ3JhbW1hciA9IG1vZHVsZS5leHBvcnRzID0gewogIHY6IFt7CiAgICAgIG5hbWU6ICd2ZXJzaW9uJywKICAgICAgcmVnOiAvXihcZCopJC8KICB9XSwKICBvOiBbeyAvL289LSAyMDUxOCAwIElOIElQNCAyMDMuMC4xMTMuMQogICAgLy8gTkI6IHNlc3Npb25JZCB3aWxsIGJlIGEgU3RyaW5nIGluIG1vc3QgY2FzZXMgYmVjYXVzZSBpdCBpcyBodWdlCiAgICBuYW1lOiAnb3JpZ2luJywKICAgIHJlZzogL14oXFMqKSAoXGQqKSAoXGQqKSAoXFMqKSBJUChcZCkgKFxTKikvLAogICAgbmFtZXM6IFsndXNlcm5hbWUnLCAnc2Vzc2lvbklkJywgJ3Nlc3Npb25WZXJzaW9uJywgJ25ldFR5cGUnLCAnaXBWZXInLCAnYWRkcmVzcyddLAogICAgZm9ybWF0OiAiJXMgJXMgJWQgJXMgSVAlZCAlcyIKICB9XSwKICAvLyBkZWZhdWx0IHBhcnNpbmcgb2YgdGhlc2Ugb25seSAodGhvdWdoIHNvbWUgb2YgdGhlc2UgZmVlbCBvdXRkYXRlZCkKICBzOiBbeyBuYW1lOiAnbmFtZScgfV0sCiAgaTogW3sgbmFtZTogJ2Rlc2NyaXB0aW9uJyB9XSwKICB1OiBbeyBuYW1lOiAndXJpJyB9XSwKICBlOiBbeyBuYW1lOiAnZW1haWwnIH1dLAogIHA6IFt7IG5hbWU6ICdwaG9uZScgfV0sCiAgejogW3sgbmFtZTogJ3RpbWV6b25lcycgfV0sIC8vIFRPRE86IHRoaXMgb25lIGNhbiBhY3R1YWxseSBiZSBwYXJzZWQgcHJvcGVybHkuLgogIHI6IFt7IG5hbWU6ICdyZXBlYXRzJyB9XSwgICAvLyBUT0RPOiB0aGlzIG9uZSBjYW4gYWxzbyBiZSBwYXJzZWQgcHJvcGVybHkKICAvL2s6IFt7fV0sIC8vIG91dGRhdGVkIHRoaW5nIGlnbm9yZWQKICB0OiBbeyAvL3Q9MCAwCiAgICBuYW1lOiAndGltaW5nJywKICAgIHJlZzogL14oXGQqKSAoXGQqKS8sCiAgICBuYW1lczogWydzdGFydCcsICdzdG9wJ10sCiAgICBmb3JtYXQ6ICIlZCAlZCIKICB9XSwKICBjOiBbeyAvL2M9SU4gSVA0IDEwLjQ3LjE5Ny4yNgogICAgICBuYW1lOiAnY29ubmVjdGlvbicsCiAgICAgIHJlZzogL15JTiBJUChcZCkgKFxTKikvLAogICAgICBuYW1lczogWyd2ZXJzaW9uJywgJ2lwJ10sCiAgICAgIGZvcm1hdDogIklOIElQJWQgJXMiCiAgfV0sCiAgYjogW3sgLy9iPUFTOjQwMDAKICAgICAgcHVzaDogJ2JhbmR3aWR0aCcsCiAgICAgIHJlZzogL14oVElBU3xBU3xDVHxSUnxSUyk6KFxkKikvLAogICAgICBuYW1lczogWyd0eXBlJywgJ2xpbWl0J10sCiAgICAgIGZvcm1hdDogIiVzOiVzIgogIH1dLAogIG06IFt7IC8vbT12aWRlbyA1MTc0NCBSVFAvQVZQIDEyNiA5NyA5OCAzNCAzMQogICAgICAvLyBOQjogc3BlY2lhbCAtIHB1c2hlcyB0byBzZXNzaW9uCiAgICAgIC8vIFRPRE86IHJ0cC9mbXRwIHNob3VsZCBiZSBmaWx0ZXJlZCBieSB0aGUgcGF5bG9hZHMgZm91bmQgaGVyZT8KICAgICAgcmVnOiAvXihcdyopIChcZCopIChbXHdcL10qKSg/OiAoLiopKT8vLAogICAgICBuYW1lczogWyd0eXBlJywgJ3BvcnQnLCAncHJvdG9jb2wnLCAncGF5bG9hZHMnXSwKICAgICAgZm9ybWF0OiAiJXMgJWQgJXMgJXMiCiAgfV0sCiAgYTogWwogICAgeyAvL2E9cnRwbWFwOjExMCBvcHVzLzQ4MDAwLzIKICAgICAgcHVzaDogJ3J0cCcsCiAgICAgIHJlZzogL15ydHBtYXA6KFxkKikgKFtcd1wtXC5dKikoPzpccypcLyhcZCopKD86XHMqXC8oXFMqKSk/KT8vLAogICAgICBuYW1lczogWydwYXlsb2FkJywgJ2NvZGVjJywgJ3JhdGUnLCAnZW5jb2RpbmcnXSwKICAgICAgZm9ybWF0OiBmdW5jdGlvbiAobykgewogICAgICAgIHJldHVybiAoby5lbmNvZGluZykgPwogICAgICAgICAgInJ0cG1hcDolZCAlcy8lcy8lcyI6CiAgICAgICAgICBvLnJhdGUgPwogICAgICAgICAgInJ0cG1hcDolZCAlcy8lcyI6CiAgICAgICAgICAicnRwbWFwOiVkICVzIjsKICAgICAgfQogICAgfSwKICAgIHsKICAgICAgLy9hPWZtdHA6MTA4IHByb2ZpbGUtbGV2ZWwtaWQ9MjQ7b2JqZWN0PTIzO2JpdHJhdGU9NjQwMDAKICAgICAgLy9hPWZtdHA6MTExIG1pbnB0aW1lPTEwOyB1c2VpbmJhbmRmZWM9MQogICAgICBwdXNoOiAnZm10cCcsCiAgICAgIHJlZzogL15mbXRwOihcZCopIChbXFN8IF0qKS8sCiAgICAgIG5hbWVzOiBbJ3BheWxvYWQnLCAnY29uZmlnJ10sCiAgICAgIGZvcm1hdDogImZtdHA6JWQgJXMiCiAgICB9LAogICAgeyAvL2E9Y29udHJvbDpzdHJlYW1pZD0wCiAgICAgICAgbmFtZTogJ2NvbnRyb2wnLAogICAgICAgIHJlZzogL15jb250cm9sOiguKikvLAogICAgICAgIGZvcm1hdDogImNvbnRyb2w6JXMiCiAgICB9LAogICAgeyAvL2E9cnRjcDo2NTE3OSBJTiBJUDQgMTkzLjg0Ljc3LjE5NAogICAgICBuYW1lOiAncnRjcCcsCiAgICAgIHJlZzogL15ydGNwOihcZCopKD86IChcUyopIElQKFxkKSAoXFMqKSk/LywKICAgICAgbmFtZXM6IFsncG9ydCcsICduZXRUeXBlJywgJ2lwVmVyJywgJ2FkZHJlc3MnXSwKICAgICAgZm9ybWF0OiBmdW5jdGlvbiAobykgewogICAgICAgIHJldHVybiAoby5hZGRyZXNzICE9IG51bGwpID8KICAgICAgICAgICJydGNwOiVkICVzIElQJWQgJXMiOgogICAgICAgICAgInJ0Y3A6JWQiOwogICAgICB9CiAgICB9LAogICAgeyAvL2E9cnRjcC1mYjo5OCB0cnItaW50IDEwMAogICAgICBwdXNoOiAncnRjcEZiVHJySW50JywKICAgICAgcmVnOiAvXnJ0Y3AtZmI6KFwqfFxkKikgdHJyLWludCAoXGQqKS8sCiAgICAgIG5hbWVzOiBbJ3BheWxvYWQnLCAndmFsdWUnXSwKICAgICAgZm9ybWF0OiAicnRjcC1mYjolZCB0cnItaW50ICVkIgogICAgfSwKICAgIHsgLy9hPXJ0Y3AtZmI6OTggbmFjayBycHNpCiAgICAgIHB1c2g6ICdydGNwRmInLAogICAgICByZWc6IC9ecnRjcC1mYjooXCp8XGQqKSAoW1x3LV9dKikoPzogKFtcdy1fXSopKT8vLAogICAgICBuYW1lczogWydwYXlsb2FkJywgJ3R5cGUnLCAnc3VidHlwZSddLAogICAgICBmb3JtYXQ6IGZ1bmN0aW9uIChvKSB7CiAgICAgICAgcmV0dXJuIChvLnN1YnR5cGUgIT0gbnVsbCkgPwogICAgICAgICAgInJ0Y3AtZmI6JXMgJXMgJXMiOgogICAgICAgICAgInJ0Y3AtZmI6JXMgJXMiOwogICAgICB9CiAgICB9LAogICAgeyAvL2E9ZXh0bWFwOjIgdXJuOmlldGY6cGFyYW1zOnJ0cC1oZHJleHQ6dG9mZnNldAogICAgICAvL2E9ZXh0bWFwOjEvcmVjdm9ubHkgVVJJLWdwcy1zdHJpbmcKICAgICAgcHVzaDogJ2V4dCcsCiAgICAgIHJlZzogL15leHRtYXA6KFtcd19cL10qKSAoXFMqKSg/OiAoXFMqKSk/LywKICAgICAgbmFtZXM6IFsndmFsdWUnLCAndXJpJywgJ2NvbmZpZyddLCAvLyB2YWx1ZSBtYXkgaW5jbHVkZSAiL2RpcmVjdGlvbiIgc3VmZml4CiAgICAgIGZvcm1hdDogZnVuY3Rpb24gKG8pIHsKICAgICAgICByZXR1cm4gKG8uY29uZmlnICE9IG51bGwpID8KICAgICAgICAgICJleHRtYXA6JXMgJXMgJXMiOgogICAgICAgICAgImV4dG1hcDolcyAlcyI7CiAgICAgIH0KICAgIH0sCiAgICB7CiAgICAgIC8vYT1jcnlwdG86MSBBRVNfQ01fMTI4X0hNQUNfU0hBMV84MCBpbmxpbmU6UFMxdVFDVmVlQ0ZDYW5WbWNqa3BQeXdqTldoY1lEMG1YWHR4YVZCUnwyXjIwfDE6MzIKICAgICAgcHVzaDogJ2NyeXB0bycsCiAgICAgIHJlZzogL15jcnlwdG86KFxkKikgKFtcd19dKikgKFxTKikoPzogKFxTKikpPy8sCiAgICAgIG5hbWVzOiBbJ2lkJywgJ3N1aXRlJywgJ2NvbmZpZycsICdzZXNzaW9uQ29uZmlnJ10sCiAgICAgIGZvcm1hdDogZnVuY3Rpb24gKG8pIHsKICAgICAgICByZXR1cm4gKG8uc2Vzc2lvbkNvbmZpZyAhPSBudWxsKSA/CiAgICAgICAgICAiY3J5cHRvOiVkICVzICVzICVzIjoKICAgICAgICAgICJjcnlwdG86JWQgJXMgJXMiOwogICAgICB9CiAgICB9LAogICAgeyAvL2E9c2V0dXA6YWN0cGFzcwogICAgICBuYW1lOiAnc2V0dXAnLAogICAgICByZWc6IC9ec2V0dXA6KFx3KikvLAogICAgICBmb3JtYXQ6ICJzZXR1cDolcyIKICAgIH0sCiAgICB7IC8vYT1taWQ6MQogICAgICBuYW1lOiAnbWlkJywKICAgICAgcmVnOiAvXm1pZDooW15cc10qKS8sCiAgICAgIGZvcm1hdDogIm1pZDolcyIKICAgIH0sCiAgICB7IC8vYT1tc2lkOjBjOGIwNjRkLWQ4MDctNDNiNC1iNDM0LWY5MmE4ODlkODU4NyA5ODE3ODY4NS1kNDA5LTQ2ZTAtOGUxNi03ZWYwZGIwZGI2NGEKICAgICAgbmFtZTogJ21zaWQnLAogICAgICByZWc6IC9ebXNpZDooLiopLywKICAgICAgZm9ybWF0OiAibXNpZDolcyIKICAgIH0sCiAgICB7IC8vYT1wdGltZToyMAogICAgICBuYW1lOiAncHRpbWUnLAogICAgICByZWc6IC9ecHRpbWU6KFxkKikvLAogICAgICBmb3JtYXQ6ICJwdGltZTolZCIKICAgIH0sCiAgICB7IC8vYT1tYXhwdGltZTo2MAogICAgICBuYW1lOiAnbWF4cHRpbWUnLAogICAgICByZWc6IC9ebWF4cHRpbWU6KFxkKikvLAogICAgICBmb3JtYXQ6ICJtYXhwdGltZTolZCIKICAgIH0sCiAgICB7IC8vYT1zZW5kcmVjdgogICAgICBuYW1lOiAnZGlyZWN0aW9uJywKICAgICAgcmVnOiAvXihzZW5kcmVjdnxyZWN2b25seXxzZW5kb25seXxpbmFjdGl2ZSkvCiAgICB9LAogICAgeyAvL2E9aWNlLWxpdGUKICAgICAgbmFtZTogJ2ljZWxpdGUnLAogICAgICByZWc6IC9eKGljZS1saXRlKS8KICAgIH0sCiAgICB7IC8vYT1pY2UtdWZyYWc6RjdnSQogICAgICBuYW1lOiAnaWNlVWZyYWcnLAogICAgICByZWc6IC9eaWNlLXVmcmFnOihcUyopLywKICAgICAgZm9ybWF0OiAiaWNlLXVmcmFnOiVzIgogICAgfSwKICAgIHsgLy9hPWljZS1wd2Q6eDljbWwvWXppY2hWMitYbGhpTXU4ZwogICAgICBuYW1lOiAnaWNlUHdkJywKICAgICAgcmVnOiAvXmljZS1wd2Q6KFxTKikvLAogICAgICBmb3JtYXQ6ICJpY2UtcHdkOiVzIgogICAgfSwKICAgIHsgLy9hPWZpbmdlcnByaW50OlNIQS0xIDAwOjExOjIyOjMzOjQ0OjU1OjY2Ojc3Ojg4Ojk5OkFBOkJCOkNDOkREOkVFOkZGOjAwOjExOjIyOjMzCiAgICAgIG5hbWU6ICdmaW5nZXJwcmludCcsCiAgICAgIHJlZzogL15maW5nZXJwcmludDooXFMqKSAoXFMqKS8sCiAgICAgIG5hbWVzOiBbJ3R5cGUnLCAnaGFzaCddLAogICAgICBmb3JtYXQ6ICJmaW5nZXJwcmludDolcyAlcyIKICAgIH0sCiAgICB7CiAgICAgIC8vYT1jYW5kaWRhdGU6MCAxIFVEUCAyMTEzNjY3MzI3IDIwMy4wLjExMy4xIDU0NDAwIHR5cCBob3N0CiAgICAgIC8vYT1jYW5kaWRhdGU6MTE2Mjg3NTA4MSAxIHVkcCAyMTEzOTM3MTUxIDE5Mi4xNjguMzQuNzUgNjAwMTcgdHlwIGhvc3QgZ2VuZXJhdGlvbiAwIG5ldHdvcmstaWQgMyBuZXR3b3JrLWNvc3QgMTAKICAgICAgLy9hPWNhbmRpZGF0ZTozMjg5OTEyOTU3IDIgdWRwIDE4NDU1MDE2OTUgMTkzLjg0Ljc3LjE5NCA2MDAxNyB0eXAgc3JmbHggcmFkZHIgMTkyLjE2OC4zNC43NSBycG9ydCA2MDAxNyBnZW5lcmF0aW9uIDAgbmV0d29yay1pZCAzIG5ldHdvcmstY29zdCAxMAogICAgICAvL2E9Y2FuZGlkYXRlOjIyOTgxNTYyMCAxIHRjcCAxNTE4MjgwNDQ3IDE5Mi4xNjguMTUwLjE5IDYwMDE3IHR5cCBob3N0IHRjcHR5cGUgYWN0aXZlIGdlbmVyYXRpb24gMCBuZXR3b3JrLWlkIDMgbmV0d29yay1jb3N0IDEwCiAgICAgIC8vYT1jYW5kaWRhdGU6MzI4OTkxMjk1NyAyIHRjcCAxODQ1NTAxNjk1IDE5My44NC43Ny4xOTQgNjAwMTcgdHlwIHNyZmx4IHJhZGRyIDE5Mi4xNjguMzQuNzUgcnBvcnQgNjAwMTcgdGNwdHlwZSBwYXNzaXZlIGdlbmVyYXRpb24gMCBuZXR3b3JrLWlkIDMgbmV0d29yay1jb3N0IDEwCiAgICAgIHB1c2g6J2NhbmRpZGF0ZXMnLAogICAgICByZWc6IC9eY2FuZGlkYXRlOihcUyopIChcZCopIChcUyopIChcZCopIChcUyopIChcZCopIHR5cCAoXFMqKSg/OiByYWRkciAoXFMqKSBycG9ydCAoXGQqKSk/KD86IHRjcHR5cGUgKFxTKikpPyg/OiBnZW5lcmF0aW9uIChcZCopKT8oPzogbmV0d29yay1pZCAoXGQqKSk/KD86IG5ldHdvcmstY29zdCAoXGQqKSk/LywKICAgICAgbmFtZXM6IFsnZm91bmRhdGlvbicsICdjb21wb25lbnQnLCAndHJhbnNwb3J0JywgJ3ByaW9yaXR5JywgJ2lwJywgJ3BvcnQnLCAndHlwZScsICdyYWRkcicsICdycG9ydCcsICd0Y3B0eXBlJywgJ2dlbmVyYXRpb24nLCAnbmV0d29yay1pZCcsICduZXR3b3JrLWNvc3QnXSwKICAgICAgZm9ybWF0OiBmdW5jdGlvbiAobykgewogICAgICAgIHZhciBzdHIgPSAiY2FuZGlkYXRlOiVzICVkICVzICVkICVzICVkIHR5cCAlcyI7CgogICAgICAgIHN0ciArPSAoby5yYWRkciAhPSBudWxsKSA/ICIgcmFkZHIgJXMgcnBvcnQgJWQiIDogIiV2JXYiOwoKICAgICAgICAvLyBOQjogY2FuZGlkYXRlIGhhcyB0aHJlZSBvcHRpb25hbCBjaHVua3MsIHNvICV2b2lkIG1pZGRsZXMgb25lIGlmIGl0J3MgbWlzc2luZwogICAgICAgIHN0ciArPSAoby50Y3B0eXBlICE9IG51bGwpID8gIiB0Y3B0eXBlICVzIiA6ICIldiI7CgogICAgICAgIGlmIChvLmdlbmVyYXRpb24gIT0gbnVsbCkgewogICAgICAgICAgc3RyICs9ICIgZ2VuZXJhdGlvbiAlZCI7CiAgICAgICAgfQoKICAgICAgICBzdHIgKz0gKG9bJ25ldHdvcmstaWQnXSAhPSBudWxsKSA/ICIgbmV0d29yay1pZCAlZCIgOiAiJXYiOwogICAgICAgIHN0ciArPSAob1snbmV0d29yay1jb3N0J10gIT0gbnVsbCkgPyAiIG5ldHdvcmstY29zdCAlZCIgOiAiJXYiOwogICAgICAgIHJldHVybiBzdHI7CiAgICAgIH0KICAgIH0sCiAgICB7IC8vYT1lbmQtb2YtY2FuZGlkYXRlcyAoa2VlcCBhZnRlciB0aGUgY2FuZGlkYXRlcyBsaW5lIGZvciByZWFkYWJpbGl0eSkKICAgICAgbmFtZTogJ2VuZE9mQ2FuZGlkYXRlcycsCiAgICAgIHJlZzogL14oZW5kLW9mLWNhbmRpZGF0ZXMpLwogICAgfSwKICAgIHsgLy9hPXJlbW90ZS1jYW5kaWRhdGVzOjEgMjAzLjAuMTEzLjEgNTQ0MDAgMiAyMDMuMC4xMTMuMSA1NDQwMSAuLi4KICAgICAgbmFtZTogJ3JlbW90ZUNhbmRpZGF0ZXMnLAogICAgICByZWc6IC9ecmVtb3RlLWNhbmRpZGF0ZXM6KC4qKS8sCiAgICAgIGZvcm1hdDogInJlbW90ZS1jYW5kaWRhdGVzOiVzIgogICAgfSwKICAgIHsgLy9hPWljZS1vcHRpb25zOmdvb2dsZS1pY2UKICAgICAgbmFtZTogJ2ljZU9wdGlvbnMnLAogICAgICByZWc6IC9eaWNlLW9wdGlvbnM6KFxTKikvLAogICAgICBmb3JtYXQ6ICJpY2Utb3B0aW9uczolcyIKICAgIH0sCiAgICB7IC8vYT1zc3JjOjI1NjYxMDc1NjkgY25hbWU6dDlZVThNMVV4VEY4WTFBMQogICAgICBwdXNoOiAic3NyY3MiLAogICAgICByZWc6IC9ec3NyYzooXGQqKSAoW1x3X10qKSg/OjooLiopKT8vLAogICAgICBuYW1lczogWydpZCcsICdhdHRyaWJ1dGUnLCAndmFsdWUnXSwKICAgICAgZm9ybWF0OiBmdW5jdGlvbiAobykgewogICAgICAgIHZhciBzdHIgPSAic3NyYzolZCI7CiAgICAgICAgaWYgKG8uYXR0cmlidXRlICE9IG51bGwpIHsKICAgICAgICAgIHN0ciArPSAiICVzIjsKICAgICAgICAgIGlmIChvLnZhbHVlICE9IG51bGwpIHsKICAgICAgICAgICAgc3RyICs9ICI6JXMiOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gc3RyOwogICAgICB9CiAgICB9LAogICAgeyAvL2E9c3NyYy1ncm91cDpGRUMgMSAyCiAgICAgIHB1c2g6ICJzc3JjR3JvdXBzIiwKICAgICAgcmVnOiAvXnNzcmMtZ3JvdXA6KFx3KikgKC4qKS8sCiAgICAgIG5hbWVzOiBbJ3NlbWFudGljcycsICdzc3JjcyddLAogICAgICBmb3JtYXQ6ICJzc3JjLWdyb3VwOiVzICVzIgogICAgfSwKICAgIHsgLy9hPW1zaWQtc2VtYW50aWM6IFdNUyBKdmxhbTVYM1NYMU9QNnBuMjB6V29ndmFLSno1SGpmOU9ubFYKICAgICAgbmFtZTogIm1zaWRTZW1hbnRpYyIsCiAgICAgIHJlZzogL15tc2lkLXNlbWFudGljOlxzPyhcdyopIChcUyopLywKICAgICAgbmFtZXM6IFsnc2VtYW50aWMnLCAndG9rZW4nXSwKICAgICAgZm9ybWF0OiAibXNpZC1zZW1hbnRpYzogJXMgJXMiIC8vIHNwYWNlIGFmdGVyICI6IiBpcyBub3QgYWNjaWRlbnRhbAogICAgfSwKICAgIHsgLy9hPWdyb3VwOkJVTkRMRSBhdWRpbyB2aWRlbwogICAgICBwdXNoOiAnZ3JvdXBzJywKICAgICAgcmVnOiAvXmdyb3VwOihcdyopICguKikvLAogICAgICBuYW1lczogWyd0eXBlJywgJ21pZHMnXSwKICAgICAgZm9ybWF0OiAiZ3JvdXA6JXMgJXMiCiAgICB9LAogICAgeyAvL2E9cnRjcC1tdXgKICAgICAgbmFtZTogJ3J0Y3BNdXgnLAogICAgICByZWc6IC9eKHJ0Y3AtbXV4KS8KICAgIH0sCiAgICB7IC8vYT1ydGNwLXJzaXplCiAgICAgIG5hbWU6ICdydGNwUnNpemUnLAogICAgICByZWc6IC9eKHJ0Y3AtcnNpemUpLwogICAgfSwKICAgIHsgLy9hPXNjdHBtYXA6NTAwMCB3ZWJydGMtZGF0YWNoYW5uZWwgMTAyNAogICAgICBuYW1lOiAnc2N0cG1hcCcsCiAgICAgIHJlZzogL15zY3RwbWFwOihbXHdfXC9dKikgKFxTKikoPzogKFxTKikpPy8sCiAgICAgIG5hbWVzOiBbJ3NjdHBtYXBOdW1iZXInLCAnYXBwJywgJ21heE1lc3NhZ2VTaXplJ10sCiAgICAgIGZvcm1hdDogZnVuY3Rpb24gKG8pIHsKICAgICAgICByZXR1cm4gKG8ubWF4TWVzc2FnZVNpemUgIT0gbnVsbCkgPwogICAgICAgICAgInNjdHBtYXA6JXMgJXMgJXMiIDoKICAgICAgICAgICJzY3RwbWFwOiVzICVzIjsKICAgICAgfQogICAgfSwKICAgIHsgLy8gYW55IGE9IHRoYXQgd2UgZG9uJ3QgdW5kZXJzdGFuZCBpcyBrZXB0cyB2ZXJiYXRpbSBvbiBtZWRpYS5pbnZhbGlkCiAgICAgIHB1c2g6ICdpbnZhbGlkJywKICAgICAgbmFtZXM6IFsidmFsdWUiXQogICAgfQogIF0KfTsKCi8vIHNldCBzZW5zaWJsZSBkZWZhdWx0cyB0byBhdm9pZCBwb2xsdXRpbmcgdGhlIGdyYW1tYXIgd2l0aCBib3JpbmcgZGV0YWlscwpPYmplY3Qua2V5cyhncmFtbWFyKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICB2YXIgb2JqcyA9IGdyYW1tYXJba2V5XTsKICBvYmpzLmZvckVhY2goZnVuY3Rpb24gKG9iaikgewogICAgaWYgKCFvYmoucmVnKSB7CiAgICAgIG9iai5yZWcgPSAvKC4qKS87CiAgICB9CiAgICBpZiAoIW9iai5mb3JtYXQpIHsKICAgICAgb2JqLmZvcm1hdCA9ICIlcyI7CiAgICB9CiAgfSk7Cn0pOwoKfSx7fV0sMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CnZhciBwYXJzZXIgPSByZXF1aXJlKCcuL3BhcnNlcicpOwp2YXIgd3JpdGVyID0gcmVxdWlyZSgnLi93cml0ZXInKTsKCmV4cG9ydHMud3JpdGUgPSB3cml0ZXI7CmV4cG9ydHMucGFyc2UgPSBwYXJzZXIucGFyc2U7CmV4cG9ydHMucGFyc2VGbXRwQ29uZmlnID0gcGFyc2VyLnBhcnNlRm10cENvbmZpZzsKZXhwb3J0cy5wYXJzZVBheWxvYWRzID0gcGFyc2VyLnBhcnNlUGF5bG9hZHM7CmV4cG9ydHMucGFyc2VSZW1vdGVDYW5kaWRhdGVzID0gcGFyc2VyLnBhcnNlUmVtb3RlQ2FuZGlkYXRlczsKCn0seyIuL3BhcnNlciI6NCwiLi93cml0ZXIiOjV9XSw0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKdmFyIHRvSW50SWZJbnQgPSBmdW5jdGlvbiAodikgewogIHJldHVybiBTdHJpbmcoTnVtYmVyKHYpKSA9PT0gdiA/IE51bWJlcih2KSA6IHY7Cn07Cgp2YXIgYXR0YWNoUHJvcGVydGllcyA9IGZ1bmN0aW9uIChtYXRjaCwgbG9jYXRpb24sIG5hbWVzLCByYXdOYW1lKSB7CiAgaWYgKHJhd05hbWUgJiYgIW5hbWVzKSB7CiAgICBsb2NhdGlvbltyYXdOYW1lXSA9IHRvSW50SWZJbnQobWF0Y2hbMV0pOwogIH0KICBlbHNlIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbmFtZXMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgaWYgKG1hdGNoW2krMV0gIT0gbnVsbCkgewogICAgICAgIGxvY2F0aW9uW25hbWVzW2ldXSA9IHRvSW50SWZJbnQobWF0Y2hbaSsxXSk7CiAgICAgIH0KICAgIH0KICB9Cn07Cgp2YXIgcGFyc2VSZWcgPSBmdW5jdGlvbiAob2JqLCBsb2NhdGlvbiwgY29udGVudCkgewogIHZhciBuZWVkc0JsYW5rID0gb2JqLm5hbWUgJiYgb2JqLm5hbWVzOwogIGlmIChvYmoucHVzaCAmJiAhbG9jYXRpb25bb2JqLnB1c2hdKSB7CiAgICBsb2NhdGlvbltvYmoucHVzaF0gPSBbXTsKICB9CiAgZWxzZSBpZiAobmVlZHNCbGFuayAmJiAhbG9jYXRpb25bb2JqLm5hbWVdKSB7CiAgICBsb2NhdGlvbltvYmoubmFtZV0gPSB7fTsKICB9CiAgdmFyIGtleUxvY2F0aW9uID0gb2JqLnB1c2ggPwogICAge30gOiAgLy8gYmxhbmsgb2JqZWN0IHRoYXQgd2lsbCBiZSBwdXNoZWQKICAgIG5lZWRzQmxhbmsgPyBsb2NhdGlvbltvYmoubmFtZV0gOiBsb2NhdGlvbjsgLy8gb3RoZXJ3aXNlLCBuYW1lZCBsb2NhdGlvbiBvciByb290CgogIGF0dGFjaFByb3BlcnRpZXMoY29udGVudC5tYXRjaChvYmoucmVnKSwga2V5TG9jYXRpb24sIG9iai5uYW1lcywgb2JqLm5hbWUpOwoKICBpZiAob2JqLnB1c2gpIHsKICAgIGxvY2F0aW9uW29iai5wdXNoXS5wdXNoKGtleUxvY2F0aW9uKTsKICB9Cn07Cgp2YXIgZ3JhbW1hciA9IHJlcXVpcmUoJy4vZ3JhbW1hcicpOwp2YXIgdmFsaWRMaW5lID0gUmVnRXhwLnByb3RvdHlwZS50ZXN0LmJpbmQoL14oW2Etel0pPSguKikvKTsKCmV4cG9ydHMucGFyc2UgPSBmdW5jdGlvbiAoc2RwKSB7CiAgdmFyIHNlc3Npb24gPSB7fQogICAgLCBtZWRpYSA9IFtdCiAgICAsIGxvY2F0aW9uID0gc2Vzc2lvbjsgLy8gcG9pbnRzIGF0IHdoZXJlIHByb3BlcnRpZXMgZ28gdW5kZXIgKG9uZSBvZiB0aGUgYWJvdmUpCgogIC8vIHBhcnNlIGxpbmVzIHdlIHVuZGVyc3RhbmQKICBzZHAuc3BsaXQoLyhcclxufFxyfFxuKS8pLmZpbHRlcih2YWxpZExpbmUpLmZvckVhY2goZnVuY3Rpb24gKGwpIHsKICAgIHZhciB0eXBlID0gbFswXTsKICAgIHZhciBjb250ZW50ID0gbC5zbGljZSgyKTsKICAgIGlmICh0eXBlID09PSAnbScpIHsKICAgICAgbWVkaWEucHVzaCh7cnRwOiBbXSwgZm10cDogW119KTsKICAgICAgbG9jYXRpb24gPSBtZWRpYVttZWRpYS5sZW5ndGgtMV07IC8vIHBvaW50IGF0IGxhdGVzdCBtZWRpYSBsaW5lCiAgICB9CgogICAgZm9yICh2YXIgaiA9IDA7IGogPCAoZ3JhbW1hclt0eXBlXSB8fCBbXSkubGVuZ3RoOyBqICs9IDEpIHsKICAgICAgdmFyIG9iaiA9IGdyYW1tYXJbdHlwZV1bal07CiAgICAgIGlmIChvYmoucmVnLnRlc3QoY29udGVudCkpIHsKICAgICAgICByZXR1cm4gcGFyc2VSZWcob2JqLCBsb2NhdGlvbiwgY29udGVudCk7CiAgICAgIH0KICAgIH0KICB9KTsKCiAgc2Vzc2lvbi5tZWRpYSA9IG1lZGlhOyAvLyBsaW5rIGl0IHVwCiAgcmV0dXJuIHNlc3Npb247Cn07Cgp2YXIgZm10cFJlZHVjZXIgPSBmdW5jdGlvbiAoYWNjLCBleHByKSB7CiAgdmFyIHMgPSBleHByLnNwbGl0KC89KC4rKS8sIDIpOwogIGlmIChzLmxlbmd0aCA9PT0gMikgewogICAgYWNjW3NbMF1dID0gdG9JbnRJZkludChzWzFdKTsKICB9CiAgcmV0dXJuIGFjYzsKfTsKCmV4cG9ydHMucGFyc2VGbXRwQ29uZmlnID0gZnVuY3Rpb24gKHN0cikgewogIHJldHVybiBzdHIuc3BsaXQoL1w7XHM/LykucmVkdWNlKGZtdHBSZWR1Y2VyLCB7fSk7Cn07CgpleHBvcnRzLnBhcnNlUGF5bG9hZHMgPSBmdW5jdGlvbiAoc3RyKSB7CiAgcmV0dXJuIHN0ci5zcGxpdCgnICcpLm1hcChOdW1iZXIpOwp9OwoKZXhwb3J0cy5wYXJzZVJlbW90ZUNhbmRpZGF0ZXMgPSBmdW5jdGlvbiAoc3RyKSB7CiAgdmFyIGNhbmRpZGF0ZXMgPSBbXTsKICB2YXIgcGFydHMgPSBzdHIuc3BsaXQoJyAnKS5tYXAodG9JbnRJZkludCk7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGg7IGkgKz0gMykgewogICAgY2FuZGlkYXRlcy5wdXNoKHsKICAgICAgY29tcG9uZW50OiBwYXJ0c1tpXSwKICAgICAgaXA6IHBhcnRzW2kgKyAxXSwKICAgICAgcG9ydDogcGFydHNbaSArIDJdCiAgICB9KTsKICB9CiAgcmV0dXJuIGNhbmRpZGF0ZXM7Cn07Cgp9LHsiLi9ncmFtbWFyIjoyfV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CnZhciBncmFtbWFyID0gcmVxdWlyZSgnLi9ncmFtbWFyJyk7CgovLyBjdXN0b21pemVkIHV0aWwuZm9ybWF0IC0gZGlzY2FyZHMgZXhjZXNzIGFyZ3VtZW50cyBhbmQgY2FuIHZvaWQgbWlkZGxlIG9uZXMKdmFyIGZvcm1hdFJlZ0V4cCA9IC8lW3NkdiVdL2c7CnZhciBmb3JtYXQgPSBmdW5jdGlvbiAoZm9ybWF0U3RyKSB7CiAgdmFyIGkgPSAxOwogIHZhciBhcmdzID0gYXJndW1lbnRzOwogIHZhciBsZW4gPSBhcmdzLmxlbmd0aDsKICByZXR1cm4gZm9ybWF0U3RyLnJlcGxhY2UoZm9ybWF0UmVnRXhwLCBmdW5jdGlvbiAoeCkgewogICAgaWYgKGkgPj0gbGVuKSB7CiAgICAgIHJldHVybiB4OyAvLyBtaXNzaW5nIGFyZ3VtZW50CiAgICB9CiAgICB2YXIgYXJnID0gYXJnc1tpXTsKICAgIGkgKz0gMTsKICAgIHN3aXRjaCAoeCkgewogICAgICBjYXNlICclJSc6CiAgICAgICAgcmV0dXJuICclJzsKICAgICAgY2FzZSAnJXMnOgogICAgICAgIHJldHVybiBTdHJpbmcoYXJnKTsKICAgICAgY2FzZSAnJWQnOgogICAgICAgIHJldHVybiBOdW1iZXIoYXJnKTsKICAgICAgY2FzZSAnJXYnOgogICAgICAgIHJldHVybiAnJzsKICAgIH0KICB9KTsKICAvLyBOQjogd2UgZGlzY2FyZCBleGNlc3MgYXJndW1lbnRzIC0gdGhleSBhcmUgdHlwaWNhbGx5IHVuZGVmaW5lZCBmcm9tIG1ha2VMaW5lCn07Cgp2YXIgbWFrZUxpbmUgPSBmdW5jdGlvbiAodHlwZSwgb2JqLCBsb2NhdGlvbikgewogIHZhciBzdHIgPSBvYmouZm9ybWF0IGluc3RhbmNlb2YgRnVuY3Rpb24gPwogICAgKG9iai5mb3JtYXQob2JqLnB1c2ggPyBsb2NhdGlvbiA6IGxvY2F0aW9uW29iai5uYW1lXSkpIDoKICAgIG9iai5mb3JtYXQ7CgogIHZhciBhcmdzID0gW3R5cGUgKyAnPScgKyBzdHJdOwogIGlmIChvYmoubmFtZXMpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqLm5hbWVzLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgIHZhciBuID0gb2JqLm5hbWVzW2ldOwogICAgICBpZiAob2JqLm5hbWUpIHsKICAgICAgICBhcmdzLnB1c2gobG9jYXRpb25bb2JqLm5hbWVdW25dKTsKICAgICAgfQogICAgICBlbHNlIHsgLy8gZm9yIG1MaW5lIGFuZCBwdXNoIGF0dHJpYnV0ZXMKICAgICAgICBhcmdzLnB1c2gobG9jYXRpb25bb2JqLm5hbWVzW2ldXSk7CiAgICAgIH0KICAgIH0KICB9CiAgZWxzZSB7CiAgICBhcmdzLnB1c2gobG9jYXRpb25bb2JqLm5hbWVdKTsKICB9CiAgcmV0dXJuIGZvcm1hdC5hcHBseShudWxsLCBhcmdzKTsKfTsKCi8vIFJGQyBzcGVjaWZpZWQgb3JkZXIKLy8gVE9ETzogZXh0ZW5kIHRoaXMgd2l0aCBhbGwgdGhlIHJlc3QKdmFyIGRlZmF1bHRPdXRlck9yZGVyID0gWwogICd2JywgJ28nLCAncycsICdpJywKICAndScsICdlJywgJ3AnLCAnYycsCiAgJ2InLCAndCcsICdyJywgJ3onLCAnYScKXTsKdmFyIGRlZmF1bHRJbm5lck9yZGVyID0gWydpJywgJ2MnLCAnYicsICdhJ107CgoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoc2Vzc2lvbiwgb3B0cykgewogIG9wdHMgPSBvcHRzIHx8IHt9OwogIC8vIGVuc3VyZSBjZXJ0YWluIHByb3BlcnRpZXMgZXhpc3QKICBpZiAoc2Vzc2lvbi52ZXJzaW9uID09IG51bGwpIHsKICAgIHNlc3Npb24udmVyc2lvbiA9IDA7IC8vICJ2PTAiIG11c3QgYmUgdGhlcmUgKG9ubHkgZGVmaW5lZCB2ZXJzaW9uIGF0bSkKICB9CiAgaWYgKHNlc3Npb24ubmFtZSA9PSBudWxsKSB7CiAgICBzZXNzaW9uLm5hbWUgPSAiICI7IC8vICJzPSAiIG11c3QgYmUgdGhlcmUgaWYgbm8gbWVhbmluZ2Z1bCBuYW1lIHNldAogIH0KICBzZXNzaW9uLm1lZGlhLmZvckVhY2goZnVuY3Rpb24gKG1MaW5lKSB7CiAgICBpZiAobUxpbmUucGF5bG9hZHMgPT0gbnVsbCkgewogICAgICBtTGluZS5wYXlsb2FkcyA9ICIiOwogICAgfQogIH0pOwoKICB2YXIgb3V0ZXJPcmRlciA9IG9wdHMub3V0ZXJPcmRlciB8fCBkZWZhdWx0T3V0ZXJPcmRlcjsKICB2YXIgaW5uZXJPcmRlciA9IG9wdHMuaW5uZXJPcmRlciB8fCBkZWZhdWx0SW5uZXJPcmRlcjsKICB2YXIgc2RwID0gW107CgogIC8vIGxvb3AgdGhyb3VnaCBvdXRlck9yZGVyIGZvciBtYXRjaGluZyBwcm9wZXJ0aWVzIG9uIHNlc3Npb24KICBvdXRlck9yZGVyLmZvckVhY2goZnVuY3Rpb24gKHR5cGUpIHsKICAgIGdyYW1tYXJbdHlwZV0uZm9yRWFjaChmdW5jdGlvbiAob2JqKSB7CiAgICAgIGlmIChvYmoubmFtZSBpbiBzZXNzaW9uICYmIHNlc3Npb25bb2JqLm5hbWVdICE9IG51bGwpIHsKICAgICAgICBzZHAucHVzaChtYWtlTGluZSh0eXBlLCBvYmosIHNlc3Npb24pKTsKICAgICAgfQogICAgICBlbHNlIGlmIChvYmoucHVzaCBpbiBzZXNzaW9uICYmIHNlc3Npb25bb2JqLnB1c2hdICE9IG51bGwpIHsKICAgICAgICBzZXNzaW9uW29iai5wdXNoXS5mb3JFYWNoKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgc2RwLnB1c2gobWFrZUxpbmUodHlwZSwgb2JqLCBlbCkpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICB9KTsKCiAgLy8gdGhlbiBmb3IgZWFjaCBtZWRpYSBsaW5lLCBmb2xsb3cgdGhlIGlubmVyT3JkZXIKICBzZXNzaW9uLm1lZGlhLmZvckVhY2goZnVuY3Rpb24gKG1MaW5lKSB7CiAgICBzZHAucHVzaChtYWtlTGluZSgnbScsIGdyYW1tYXIubVswXSwgbUxpbmUpKTsKCiAgICBpbm5lck9yZGVyLmZvckVhY2goZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgZ3JhbW1hclt0eXBlXS5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICBpZiAob2JqLm5hbWUgaW4gbUxpbmUgJiYgbUxpbmVbb2JqLm5hbWVdICE9IG51bGwpIHsKICAgICAgICAgIHNkcC5wdXNoKG1ha2VMaW5lKHR5cGUsIG9iaiwgbUxpbmUpKTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAob2JqLnB1c2ggaW4gbUxpbmUgJiYgbUxpbmVbb2JqLnB1c2hdICE9IG51bGwpIHsKICAgICAgICAgIG1MaW5lW29iai5wdXNoXS5mb3JFYWNoKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICBzZHAucHVzaChtYWtlTGluZSh0eXBlLCBvYmosIGVsKSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgfSk7CgogIHJldHVybiBzZHAuam9pbignXHJcbicpICsgJ1xyXG4nOwp9OwoKfSx7Ii4vZ3JhbW1hciI6Mn1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovLyB2ZXJzaW9uOiAwLjUuMQovLyBkYXRlOiBUdWUgRmViIDA3IDIwMTcgMTY6MDA6MzkgR01UKzAwMDAgKFdFVCkKLy8gbGljZW5jZTogCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwoKCihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7CglpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpCgkJbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7CgllbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkKCQlkZWZpbmUoIkRpc2NvdmVyeSIsIFtdLCBmYWN0b3J5KTsKCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCWV4cG9ydHNbIkRpc2NvdmVyeSJdID0gZmFjdG9yeSgpOwoJZWxzZQoJCXJvb3RbIiJdID0gcm9vdFsiIl0gfHwge30sIHJvb3RbIiJdWyJEaXNjb3ZlcnkiXSA9IGZhY3RvcnkoKTsKfSkodGhpcywgZnVuY3Rpb24oKSB7CnJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwovKioqKioqLwovKioqKioqLyAJLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb24KLyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCWk6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsOiBmYWxzZSwKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLwovKioqKioqLyAJCS8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbgovKioqKioqLyAJCW1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pOwovKioqKioqLwovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubCA9IHRydWU7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9Ci8qKioqKiovCi8qKioqKiovCi8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKQovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlczsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gaWRlbnRpdHkgZnVuY3Rpb24gZm9yIGNhbGxpbmcgaGFybW9ueSBpbXBvcnRzIHdpdGggdGhlIGNvcnJlY3QgY29udGV4dAovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5pID0gZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9OwovKioqKioqLwovKioqKioqLyAJLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHsKLyoqKioqKi8gCQlpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7Ci8qKioqKiovIAkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7Ci8qKioqKiovIAkJCQljb25maWd1cmFibGU6IGZhbHNlLAovKioqKioqLyAJCQkJZW51bWVyYWJsZTogdHJ1ZSwKLyoqKioqKi8gCQkJCWdldDogZ2V0dGVyCi8qKioqKiovIAkJCX0pOwovKioqKioqLyAJCX0KLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlcwovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7Ci8qKioqKiovIAkJdmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/Ci8qKioqKiovIAkJCWZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6Ci8qKioqKiovIAkJCWZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07Ci8qKioqKiovIAkJX193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpOwovKioqKioqLyAJCXJldHVybiBnZXR0ZXI7Ci8qKioqKiovIAl9OwovKioqKioqLwovKioqKioqLyAJLy8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfXwovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gIiI7Ci8qKioqKiovCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDE1Nyk7Ci8qKioqKiovIH0pCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIChbCi8qIDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGNvcmUgPSBtb2R1bGUuZXhwb3J0cyA9IHt2ZXJzaW9uOiAnMi40LjAnfTsKaWYodHlwZW9mIF9fZSA9PSAnbnVtYmVyJylfX2UgPSBjb3JlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmCgovKioqLyB9KSwKLyogMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOAp2YXIgZ2xvYmFsID0gbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdy5NYXRoID09IE1hdGgKICA/IHdpbmRvdyA6IHR5cGVvZiBzZWxmICE9ICd1bmRlZmluZWQnICYmIHNlbGYuTWF0aCA9PSBNYXRoID8gc2VsZiA6IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7CmlmKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmCgovKioqLyB9KSwKLyogMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgc3RvcmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzApKCd3a3MnKQogICwgdWlkICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpCiAgLCBTeW1ib2wgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5TeW1ib2wKICAsIFVTRV9TWU1CT0wgPSB0eXBlb2YgU3ltYm9sID09ICdmdW5jdGlvbic7Cgp2YXIgJGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewogIHJldHVybiBzdG9yZVtuYW1lXSB8fCAoc3RvcmVbbmFtZV0gPQogICAgVVNFX1NZTUJPTCAmJiBTeW1ib2xbbmFtZV0gfHwgKFVTRV9TWU1CT0wgPyBTeW1ib2wgOiB1aWQpKCdTeW1ib2wuJyArIG5hbWUpKTsKfTsKCiRleHBvcnRzLnN0b3JlID0gc3RvcmU7CgovKioqLyB9KSwKLyogMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBUaGFuaydzIElFOCBmb3IgaGlzIGZ1bm55IGRlZmluZVByb3BlcnR5Cm1vZHVsZS5leHBvcnRzID0gIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ2EnLCB7Z2V0OiBmdW5jdGlvbigpeyByZXR1cm4gNzsgfX0pLmEgIT0gNzsKfSk7CgovKioqLyB9KSwKLyogNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgYW5PYmplY3QgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBJRThfRE9NX0RFRklORSA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpCiAgLCB0b1ByaW1pdGl2ZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjIpCiAgLCBkUCAgICAgICAgICAgICA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTsKCmV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBPYmplY3QuZGVmaW5lUHJvcGVydHkgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKXsKICBhbk9iamVjdChPKTsKICBQID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSk7CiAgYW5PYmplY3QoQXR0cmlidXRlcyk7CiAgaWYoSUU4X0RPTV9ERUZJTkUpdHJ5IHsKICAgIHJldHVybiBkUChPLCBQLCBBdHRyaWJ1dGVzKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgaWYoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKXRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhJyk7CiAgaWYoJ3ZhbHVlJyBpbiBBdHRyaWJ1dGVzKU9bUF0gPSBBdHRyaWJ1dGVzLnZhbHVlOwogIHJldHVybiBPOwp9OwoKLyoqKi8gfSksCi8qIDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYoIWlzT2JqZWN0KGl0KSl0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhbiBvYmplY3QhJyk7CiAgcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRQICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBjcmVhdGVEZXNjID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNik7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSA/IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7CiAgcmV0dXJuIGRQLmYob2JqZWN0LCBrZXksIGNyZWF0ZURlc2MoMSwgdmFsdWUpKTsKfSA6IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7CiAgb2JqZWN0W2tleV0gPSB2YWx1ZTsKICByZXR1cm4gb2JqZWN0Owp9OwoKLyoqKi8gfSksCi8qIDcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIHR5cGVvZiBpdCA9PT0gJ29iamVjdCcgPyBpdCAhPT0gbnVsbCA6IHR5cGVvZiBpdCA9PT0gJ2Z1bmN0aW9uJzsKfTsKCi8qKiovIH0pLAovKiA4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBjdHggICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgaGlkZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7Cgp2YXIgJGV4cG9ydCA9IGZ1bmN0aW9uKHR5cGUsIG5hbWUsIHNvdXJjZSl7CiAgdmFyIElTX0ZPUkNFRCA9IHR5cGUgJiAkZXhwb3J0LkYKICAgICwgSVNfR0xPQkFMID0gdHlwZSAmICRleHBvcnQuRwogICAgLCBJU19TVEFUSUMgPSB0eXBlICYgJGV4cG9ydC5TCiAgICAsIElTX1BST1RPICA9IHR5cGUgJiAkZXhwb3J0LlAKICAgICwgSVNfQklORCAgID0gdHlwZSAmICRleHBvcnQuQgogICAgLCBJU19XUkFQICAgPSB0eXBlICYgJGV4cG9ydC5XCiAgICAsIGV4cG9ydHMgICA9IElTX0dMT0JBTCA/IGNvcmUgOiBjb3JlW25hbWVdIHx8IChjb3JlW25hbWVdID0ge30pCiAgICAsIGV4cFByb3RvICA9IGV4cG9ydHNbUFJPVE9UWVBFXQogICAgLCB0YXJnZXQgICAgPSBJU19HTE9CQUwgPyBnbG9iYWwgOiBJU19TVEFUSUMgPyBnbG9iYWxbbmFtZV0gOiAoZ2xvYmFsW25hbWVdIHx8IHt9KVtQUk9UT1RZUEVdCiAgICAsIGtleSwgb3duLCBvdXQ7CiAgaWYoSVNfR0xPQkFMKXNvdXJjZSA9IG5hbWU7CiAgZm9yKGtleSBpbiBzb3VyY2UpewogICAgLy8gY29udGFpbnMgaW4gbmF0aXZlCiAgICBvd24gPSAhSVNfRk9SQ0VEICYmIHRhcmdldCAmJiB0YXJnZXRba2V5XSAhPT0gdW5kZWZpbmVkOwogICAgaWYob3duICYmIGtleSBpbiBleHBvcnRzKWNvbnRpbnVlOwogICAgLy8gZXhwb3J0IG5hdGl2ZSBvciBwYXNzZWQKICAgIG91dCA9IG93biA/IHRhcmdldFtrZXldIDogc291cmNlW2tleV07CiAgICAvLyBwcmV2ZW50IGdsb2JhbCBwb2xsdXRpb24gZm9yIG5hbWVzcGFjZXMKICAgIGV4cG9ydHNba2V5XSA9IElTX0dMT0JBTCAmJiB0eXBlb2YgdGFyZ2V0W2tleV0gIT0gJ2Z1bmN0aW9uJyA/IHNvdXJjZVtrZXldCiAgICAvLyBiaW5kIHRpbWVycyB0byBnbG9iYWwgZm9yIGNhbGwgZnJvbSBleHBvcnQgY29udGV4dAogICAgOiBJU19CSU5EICYmIG93biA/IGN0eChvdXQsIGdsb2JhbCkKICAgIC8vIHdyYXAgZ2xvYmFsIGNvbnN0cnVjdG9ycyBmb3IgcHJldmVudCBjaGFuZ2UgdGhlbSBpbiBsaWJyYXJ5CiAgICA6IElTX1dSQVAgJiYgdGFyZ2V0W2tleV0gPT0gb3V0ID8gKGZ1bmN0aW9uKEMpewogICAgICB2YXIgRiA9IGZ1bmN0aW9uKGEsIGIsIGMpewogICAgICAgIGlmKHRoaXMgaW5zdGFuY2VvZiBDKXsKICAgICAgICAgIHN3aXRjaChhcmd1bWVudHMubGVuZ3RoKXsKICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gbmV3IEM7CiAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIG5ldyBDKGEpOwogICAgICAgICAgICBjYXNlIDI6IHJldHVybiBuZXcgQyhhLCBiKTsKICAgICAgICAgIH0gcmV0dXJuIG5ldyBDKGEsIGIsIGMpOwogICAgICAgIH0gcmV0dXJuIEMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgICAgRltQUk9UT1RZUEVdID0gQ1tQUk9UT1RZUEVdOwogICAgICByZXR1cm4gRjsKICAgIC8vIG1ha2Ugc3RhdGljIHZlcnNpb25zIGZvciBwcm90b3R5cGUgbWV0aG9kcwogICAgfSkob3V0KSA6IElTX1BST1RPICYmIHR5cGVvZiBvdXQgPT0gJ2Z1bmN0aW9uJyA/IGN0eChGdW5jdGlvbi5jYWxsLCBvdXQpIDogb3V0OwogICAgLy8gZXhwb3J0IHByb3RvIG1ldGhvZHMgdG8gY29yZS4lQ09OU1RSVUNUT1IlLm1ldGhvZHMuJU5BTUUlCiAgICBpZihJU19QUk9UTyl7CiAgICAgIChleHBvcnRzLnZpcnR1YWwgfHwgKGV4cG9ydHMudmlydHVhbCA9IHt9KSlba2V5XSA9IG91dDsKICAgICAgLy8gZXhwb3J0IHByb3RvIG1ldGhvZHMgdG8gY29yZS4lQ09OU1RSVUNUT1IlLnByb3RvdHlwZS4lTkFNRSUKICAgICAgaWYodHlwZSAmICRleHBvcnQuUiAmJiBleHBQcm90byAmJiAhZXhwUHJvdG9ba2V5XSloaWRlKGV4cFByb3RvLCBrZXksIG91dCk7CiAgICB9CiAgfQp9OwovLyB0eXBlIGJpdG1hcAokZXhwb3J0LkYgPSAxOyAgIC8vIGZvcmNlZAokZXhwb3J0LkcgPSAyOyAgIC8vIGdsb2JhbAokZXhwb3J0LlMgPSA0OyAgIC8vIHN0YXRpYwokZXhwb3J0LlAgPSA4OyAgIC8vIHByb3RvCiRleHBvcnQuQiA9IDE2OyAgLy8gYmluZAokZXhwb3J0LlcgPSAzMjsgIC8vIHdyYXAKJGV4cG9ydC5VID0gNjQ7ICAvLyBzYWZlCiRleHBvcnQuUiA9IDEyODsgLy8gcmVhbCBwcm90byBtZXRob2QgZm9yIGBsaWJyYXJ5YCAKbW9kdWxlLmV4cG9ydHMgPSAkZXhwb3J0OwoKLyoqKi8gfSksCi8qIDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfTsKCi8qKiovIH0pLAovKiAxMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfZGVmaW5lUHJvcGVydHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM2KTsKCnZhciBfZGVmaW5lUHJvcGVydHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVmaW5lUHJvcGVydHkpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgICAoMCwgX2RlZmluZVByb3BlcnR5Mi5kZWZhdWx0KSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICAgIH0KICB9CgogIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgICBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogICAgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgICByZXR1cm4gQ29uc3RydWN0b3I7CiAgfTsKfSgpOwoKLyoqKi8gfSksCi8qIDExICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYyl7CiAgdHJ5IHsKICAgIHJldHVybiAhIWV4ZWMoKTsKICB9IGNhdGNoKGUpewogICAgcmV0dXJuIHRydWU7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDEyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciBoYXNPd25Qcm9wZXJ0eSA9IHt9Lmhhc093blByb3BlcnR5Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBrZXkpewogIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGl0LCBrZXkpOwp9OwoKLyoqKi8gfSksCi8qIDEzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIHRvIGluZGV4ZWQgb2JqZWN0LCB0b09iamVjdCB3aXRoIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgc3RyaW5ncwp2YXIgSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpCiAgLCBkZWZpbmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBJT2JqZWN0KGRlZmluZWQoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAxNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBvcHRpb25hbCAvIHNpbXBsZSBjb250ZXh0IGJpbmRpbmcKdmFyIGFGdW5jdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCB0aGF0LCBsZW5ndGgpewogIGFGdW5jdGlvbihmbik7CiAgaWYodGhhdCA9PT0gdW5kZWZpbmVkKXJldHVybiBmbjsKICBzd2l0Y2gobGVuZ3RoKXsKICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uKGEpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhKTsKICAgIH07CiAgICBjYXNlIDI6IHJldHVybiBmdW5jdGlvbihhLCBiKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYik7CiAgICB9OwogICAgY2FzZSAzOiByZXR1cm4gZnVuY3Rpb24oYSwgYiwgYyl7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIsIGMpOwogICAgfTsKICB9CiAgcmV0dXJuIGZ1bmN0aW9uKC8qIC4uLmFyZ3MgKi8pewogICAgcmV0dXJuIGZuLmFwcGx5KHRoYXQsIGFyZ3VtZW50cyk7CiAgfTsKfTsKCi8qKiovIH0pLAovKiAxNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHt9OwoKLyoqKi8gfSksCi8qIDE2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYml0bWFwLCB2YWx1ZSl7CiAgcmV0dXJuIHsKICAgIGVudW1lcmFibGUgIDogIShiaXRtYXAgJiAxKSwKICAgIGNvbmZpZ3VyYWJsZTogIShiaXRtYXAgJiAyKSwKICAgIHdyaXRhYmxlICAgIDogIShiaXRtYXAgJiA0KSwKICAgIHZhbHVlICAgICAgIDogdmFsdWUKICB9Owp9OwoKLyoqKi8gfSksCi8qIDE3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4xNCAvIDE1LjIuMy4xNCBPYmplY3Qua2V5cyhPKQp2YXIgJGtleXMgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ0KQogICwgZW51bUJ1Z0tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KTsKCm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24ga2V5cyhPKXsKICByZXR1cm4gJGtleXMoTywgZW51bUJ1Z0tleXMpOwp9OwoKLyoqKi8gfSksCi8qIDE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwoaXQpLnNsaWNlKDgsIC0xKTsKfTsKCi8qKiovIH0pLAovKiAxOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBkb2N1bWVudCA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZG9jdW1lbnQKICAvLyBpbiBvbGQgSUUgdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgaXMgJ29iamVjdCcKICAsIGlzID0gaXNPYmplY3QoZG9jdW1lbnQpICYmIGlzT2JqZWN0KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXMgPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGl0KSA6IHt9Owp9OwoKLyoqKi8gfSksCi8qIDIwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIGlmKHR5cGVvZiBpdCAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGEgZnVuY3Rpb24hJyk7CiAgcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDIxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBkZWYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmYKICAsIGhhcyA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBUQUcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCd0b1N0cmluZ1RhZycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgdGFnLCBzdGF0KXsKICBpZihpdCAmJiAhaGFzKGl0ID0gc3RhdCA/IGl0IDogaXQucHJvdG90eXBlLCBUQUcpKWRlZihpdCwgVEFHLCB7Y29uZmlndXJhYmxlOiB0cnVlLCB2YWx1ZTogdGFnfSk7Cn07CgovKioqLyB9KSwKLyogMjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjEgVG9QcmltaXRpdmUoaW5wdXQgWywgUHJlZmVycmVkVHlwZV0pCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7Ci8vIGluc3RlYWQgb2YgdGhlIEVTNiBzcGVjIHZlcnNpb24sIHdlIGRpZG4ndCBpbXBsZW1lbnQgQEB0b1ByaW1pdGl2ZSBjYXNlCi8vIGFuZCB0aGUgc2Vjb25kIGFyZ3VtZW50IC0gZmxhZyAtIHByZWZlcnJlZCB0eXBlIGlzIGEgc3RyaW5nCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIFMpewogIGlmKCFpc09iamVjdChpdCkpcmV0dXJuIGl0OwogIHZhciBmbiwgdmFsOwogIGlmKFMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICBpZih0eXBlb2YgKGZuID0gaXQudmFsdWVPZikgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKXJldHVybiB2YWw7CiAgaWYoIVMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpOwp9OwoKLyoqKi8gfSksCi8qIDIzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciBpZCA9IDAKICAsIHB4ID0gTWF0aC5yYW5kb20oKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiAnU3ltYm9sKCcuY29uY2F0KGtleSA9PT0gdW5kZWZpbmVkID8gJycgOiBrZXksICcpXycsICgrK2lkICsgcHgpLnRvU3RyaW5nKDM2KSk7Cn07CgovKioqLyB9KSwKLyogMjQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudCkKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYoaXQgPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gICIgKyBpdCk7CiAgcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDI1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gdHJ1ZTsKCi8qKiovIH0pLAovKiAyNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgc2hhcmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ2tleXMnKQogICwgdWlkICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsKICByZXR1cm4gc2hhcmVkW2tleV0gfHwgKHNoYXJlZFtrZXldID0gdWlkKGtleSkpOwp9OwoKLyoqKi8gfSksCi8qIDI3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIDcuMS40IFRvSW50ZWdlcgp2YXIgY2VpbCAgPSBNYXRoLmNlaWwKICAsIGZsb29yID0gTWF0aC5mbG9vcjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGlzTmFOKGl0ID0gK2l0KSA/IDAgOiAoaXQgPiAwID8gZmxvb3IgOiBjZWlsKShpdCk7Cn07CgovKioqLyB9KSwKLyogMjggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gSUUgOC0gZG9uJ3QgZW51bSBidWcga2V5cwptb2R1bGUuZXhwb3J0cyA9ICgKICAnY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mJwopLnNwbGl0KCcsJyk7CgovKioqLyB9KSwKLyogMjkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygzKSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KF9fd2VicGFja19yZXF1aXJlX18oMTkpKCdkaXYnKSwgJ2EnLCB7Z2V0OiBmdW5jdGlvbigpeyByZXR1cm4gNzsgfX0pLmEgIT0gNzsKfSk7CgovKioqLyB9KSwKLyogMzAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIFNIQVJFRCA9ICdfX2NvcmUtanNfc2hhcmVkX18nCiAgLCBzdG9yZSAgPSBnbG9iYWxbU0hBUkVEXSB8fCAoZ2xvYmFsW1NIQVJFRF0gPSB7fSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsKICByZXR1cm4gc3RvcmVba2V5XSB8fCAoc3RvcmVba2V5XSA9IHt9KTsKfTsKCi8qKiovIH0pLAovKiAzMSAqLywKLyogMzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KQp2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gT2JqZWN0KGRlZmluZWQoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAzMyAqLywKLyogMzQgKi8sCi8qIDM1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQp2YXIgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBkUHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBFbXB0eSAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KICAsIFBST1RPVFlQRSAgID0gJ3Byb3RvdHlwZSc7CgovLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlCnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24oKXsKICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1ZwogIHZhciBpZnJhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KSgnaWZyYW1lJykKICAgICwgaSAgICAgID0gZW51bUJ1Z0tleXMubGVuZ3RoCiAgICAsIGx0ICAgICA9ICc8JwogICAgLCBndCAgICAgPSAnPicKICAgICwgaWZyYW1lRG9jdW1lbnQ7CiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg0MikuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsCiAgLy8gY3JlYXRlRGljdCA9IGlmcmFtZS5jb250ZW50V2luZG93Lk9iamVjdDsKICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7CiAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKICBpZnJhbWVEb2N1bWVudC5vcGVuKCk7CiAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpOwogIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7CiAgY3JlYXRlRGljdCA9IGlmcmFtZURvY3VtZW50LkY7CiAgd2hpbGUoaS0tKWRlbGV0ZSBjcmVhdGVEaWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbaV1dOwogIHJldHVybiBjcmVhdGVEaWN0KCk7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpewogIHZhciByZXN1bHQ7CiAgaWYoTyAhPT0gbnVsbCl7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7CiAgICByZXN1bHQgPSBuZXcgRW1wdHk7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gbnVsbDsKICAgIC8vIGFkZCAiX19wcm90b19fIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsCiAgICByZXN1bHRbSUVfUFJPVE9dID0gTzsKICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpOwogIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkUHMocmVzdWx0LCBQcm9wZXJ0aWVzKTsKfTsKCgovKioqLyB9KSwKLyogMzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygzNyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAzNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKXsKICByZXR1cm4gJE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKTsKfTsKCi8qKiovIH0pLAovKiAzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgTElCUkFSWSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBoaWRlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIEl0ZXJhdG9ycyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsICRpdGVyQ3JlYXRlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MikKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MykKICAsIElURVJBVE9SICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgQlVHR1kgICAgICAgICAgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSkgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YAogICwgRkZfSVRFUkFUT1IgICAgPSAnQEBpdGVyYXRvcicKICAsIEtFWVMgICAgICAgICAgID0gJ2tleXMnCiAgLCBWQUxVRVMgICAgICAgICA9ICd2YWx1ZXMnOwoKdmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKXsKICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7CiAgdmFyIGdldE1ldGhvZCA9IGZ1bmN0aW9uKGtpbmQpewogICAgaWYoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pcmV0dXJuIHByb3RvW2tpbmRdOwogICAgc3dpdGNoKGtpbmQpewogICAgICBjYXNlIEtFWVM6IHJldHVybiBmdW5jdGlvbiBrZXlzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgfTsKICB2YXIgVEFHICAgICAgICA9IE5BTUUgKyAnIEl0ZXJhdG9yJwogICAgLCBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVMKICAgICwgVkFMVUVTX0JVRyA9IGZhbHNlCiAgICAsIHByb3RvICAgICAgPSBCYXNlLnByb3RvdHlwZQogICAgLCAkbmF0aXZlICAgID0gcHJvdG9bSVRFUkFUT1JdIHx8IHByb3RvW0ZGX0lURVJBVE9SXSB8fCBERUZBVUxUICYmIHByb3RvW0RFRkFVTFRdCiAgICAsICRkZWZhdWx0ICAgPSAkbmF0aXZlIHx8IGdldE1ldGhvZChERUZBVUxUKQogICAgLCAkZW50cmllcyAgID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZAogICAgLCAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZQogICAgLCBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlOwogIC8vIEZpeCBuYXRpdmUKICBpZigkYW55TmF0aXZlKXsKICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoJGFueU5hdGl2ZS5jYWxsKG5ldyBCYXNlKSk7CiAgICBpZihJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSl7CiAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnMKICAgICAgc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JQcm90b3R5cGUsIFRBRywgdHJ1ZSk7CiAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lcwogICAgICBpZighTElCUkFSWSAmJiAhaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikpaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwogICAgfQogIH0KICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGCiAgaWYoREVGX1ZBTFVFUyAmJiAkbmF0aXZlICYmICRuYXRpdmUubmFtZSAhPT0gVkFMVUVTKXsKICAgIFZBTFVFU19CVUcgPSB0cnVlOwogICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTsKICB9CiAgLy8gRGVmaW5lIGl0ZXJhdG9yCiAgaWYoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpewogICAgaGlkZShwcm90bywgSVRFUkFUT1IsICRkZWZhdWx0KTsKICB9CiAgLy8gUGx1ZyBmb3IgbGlicmFyeQogIEl0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0OwogIEl0ZXJhdG9yc1tUQUddICA9IHJldHVyblRoaXM7CiAgaWYoREVGQVVMVCl7CiAgICBtZXRob2RzID0gewogICAgICB2YWx1ZXM6ICBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSwKICAgICAga2V5czogICAgSVNfU0VUICAgICA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLAogICAgICBlbnRyaWVzOiAkZW50cmllcwogICAgfTsKICAgIGlmKEZPUkNFRClmb3Ioa2V5IGluIG1ldGhvZHMpewogICAgICBpZighKGtleSBpbiBwcm90bykpcmVkZWZpbmUocHJvdG8sIGtleSwgbWV0aG9kc1trZXldKTsKICAgIH0gZWxzZSAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7CiAgfQogIHJldHVybiBtZXRob2RzOwp9OwoKLyoqKi8gfSksCi8qIDM5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKLy8gMTkuMS4yLjQgLyAxNS4yLjMuNiBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhX193ZWJwYWNrX3JlcXVpcmVfXygzKSwgJ09iamVjdCcsIHtkZWZpbmVQcm9wZXJ0eTogX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mfSk7CgovKioqLyB9KSwKLyogNDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg1MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA0MSAqLywKLyogNDIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLmRvY3VtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCi8qKiovIH0pLAovKiA0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuOSAvIDE1LjIuMy4yIE9iamVjdC5nZXRQcm90b3R5cGVPZihPKQp2YXIgaGFzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQogICwgdG9PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgSUVfUFJPVE8gICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KSgnSUVfUFJPVE8nKQogICwgT2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlOwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24oTyl7CiAgTyA9IHRvT2JqZWN0KE8pOwogIGlmKGhhcyhPLCBJRV9QUk9UTykpcmV0dXJuIE9bSUVfUFJPVE9dOwogIGlmKHR5cGVvZiBPLmNvbnN0cnVjdG9yID09ICdmdW5jdGlvbicgJiYgTyBpbnN0YW5jZW9mIE8uY29uc3RydWN0b3IpewogICAgcmV0dXJuIE8uY29uc3RydWN0b3IucHJvdG90eXBlOwogIH0gcmV0dXJuIE8gaW5zdGFuY2VvZiBPYmplY3QgPyBPYmplY3RQcm90byA6IG51bGw7Cn07CgovKioqLyB9KSwKLyogNDQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGhhcyAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCB0b0lPYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQogICwgYXJyYXlJbmRleE9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MSkoZmFsc2UpCiAgLCBJRV9QUk9UTyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KSgnSUVfUFJPVE8nKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqZWN0LCBuYW1lcyl7CiAgdmFyIE8gICAgICA9IHRvSU9iamVjdChvYmplY3QpCiAgICAsIGkgICAgICA9IDAKICAgICwgcmVzdWx0ID0gW10KICAgICwga2V5OwogIGZvcihrZXkgaW4gTylpZihrZXkgIT0gSUVfUFJPVE8paGFzKE8sIGtleSkgJiYgcmVzdWx0LnB1c2goa2V5KTsKICAvLyBEb24ndCBlbnVtIGJ1ZyAmIGhpZGRlbiBrZXlzCiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSlpZihoYXMoTywga2V5ID0gbmFtZXNbaSsrXSkpewogICAgfmFycmF5SW5kZXhPZihyZXN1bHQsIGtleSkgfHwgcmVzdWx0LnB1c2goa2V5KTsKICB9CiAgcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiA0NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBtb3N0IE9iamVjdCBtZXRob2RzIGJ5IEVTNiBzaG91bGQgYWNjZXB0IHByaW1pdGl2ZXMKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCBjb3JlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQogICwgZmFpbHMgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEtFWSwgZXhlYyl7CiAgdmFyIGZuICA9IChjb3JlLk9iamVjdCB8fCB7fSlbS0VZXSB8fCBPYmplY3RbS0VZXQogICAgLCBleHAgPSB7fTsKICBleHBbS0VZXSA9IGV4ZWMoZm4pOwogICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogZmFpbHMoZnVuY3Rpb24oKXsgZm4oMSk7IH0pLCAnT2JqZWN0JywgZXhwKTsKfTsKCi8qKiovIH0pLAovKiA0NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CgovKioqLyB9KSwKLyogNDcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjE1IFRvTGVuZ3RoCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KQogICwgbWluICAgICAgID0gTWF0aC5taW47Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCA+IDAgPyBtaW4odG9JbnRlZ2VyKGl0KSwgMHgxZmZmZmZmZmZmZmZmZikgOiAwOyAvLyBwb3coMiwgNTMpIC0gMSA9PSA5MDA3MTk5MjU0NzQwOTkxCn07CgovKioqLyB9KSwKLyogNDggKi8sCi8qIDQ5ICovLAovKiA1MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgJGF0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNjYpKHRydWUpOwoKLy8gMjEuMS4zLjI3IFN0cmluZy5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQpfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KShTdHJpbmcsICdTdHJpbmcnLCBmdW5jdGlvbihpdGVyYXRlZCl7CiAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4Ci8vIDIxLjEuNS4yLjEgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKfSwgZnVuY3Rpb24oKXsKICB2YXIgTyAgICAgPSB0aGlzLl90CiAgICAsIGluZGV4ID0gdGhpcy5faQogICAgLCBwb2ludDsKICBpZihpbmRleCA+PSBPLmxlbmd0aClyZXR1cm4ge3ZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWV9OwogIHBvaW50ID0gJGF0KE8sIGluZGV4KTsKICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDsKICByZXR1cm4ge3ZhbHVlOiBwb2ludCwgZG9uZTogZmFsc2V9Owp9KTsKCi8qKiovIH0pLAovKiA1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDY5KTsKdmFyIGdsb2JhbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBoaWRlICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgSXRlcmF0b3JzICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCBUT19TVFJJTkdfVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKTsKCmZvcih2YXIgY29sbGVjdGlvbnMgPSBbJ05vZGVMaXN0JywgJ0RPTVRva2VuTGlzdCcsICdNZWRpYUxpc3QnLCAnU3R5bGVTaGVldExpc3QnLCAnQ1NTUnVsZUxpc3QnXSwgaSA9IDA7IGkgPCA1OyBpKyspewogIHZhciBOQU1FICAgICAgID0gY29sbGVjdGlvbnNbaV0KICAgICwgQ29sbGVjdGlvbiA9IGdsb2JhbFtOQU1FXQogICAgLCBwcm90byAgICAgID0gQ29sbGVjdGlvbiAmJiBDb2xsZWN0aW9uLnByb3RvdHlwZTsKICBpZihwcm90byAmJiAhcHJvdG9bVE9fU1RSSU5HX1RBR10paGlkZShwcm90bywgVE9fU1RSSU5HX1RBRywgTkFNRSk7CiAgSXRlcmF0b3JzW05BTUVdID0gSXRlcmF0b3JzLkFycmF5Owp9CgovKioqLyB9KSwKLyogNTIgKi8sCi8qIDUzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjb3JlICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsICRKU09OID0gY29yZS5KU09OIHx8IChjb3JlLkpTT04gPSB7c3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeX0pOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICByZXR1cm4gJEpTT04uc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmd1bWVudHMpOwp9OwoKLyoqKi8gfSksCi8qIDU0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgoKLyoqKi8gfSksCi8qIDU1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGdldHRpbmcgdGFnIGZyb20gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KQogICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKQogIC8vIEVTMyB3cm9uZyBoZXJlCiAgLCBBUkcgPSBjb2YoZnVuY3Rpb24oKXsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJzsKCi8vIGZhbGxiYWNrIGZvciBJRTExIFNjcmlwdCBBY2Nlc3MgRGVuaWVkIGVycm9yCnZhciB0cnlHZXQgPSBmdW5jdGlvbihpdCwga2V5KXsKICB0cnkgewogICAgcmV0dXJuIGl0W2tleV07CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgdmFyIE8sIFQsIEI7CiAgcmV0dXJuIGl0ID09PSB1bmRlZmluZWQgPyAnVW5kZWZpbmVkJyA6IGl0ID09PSBudWxsID8gJ051bGwnCiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2UKICAgIDogdHlwZW9mIChUID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUQUcpKSA9PSAnc3RyaW5nJyA/IFQKICAgIC8vIGJ1aWx0aW5UYWcgY2FzZQogICAgOiBBUkcgPyBjb2YoTykKICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2sKICAgIDogKEIgPSBjb2YoTykpID09ICdPYmplY3QnICYmIHR5cGVvZiBPLmNhbGxlZSA9PSAnZnVuY3Rpb24nID8gJ0FyZ3VtZW50cycgOiBCOwp9OwoKLyoqKi8gfSksCi8qIDU2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gY29mKGl0KSA9PSAnU3RyaW5nJyA/IGl0LnNwbGl0KCcnKSA6IE9iamVjdChpdCk7Cn07CgovKioqLyB9KSwKLyogNTcgKi8sCi8qIDU4ICovLAovKiA1OSAqLywKLyogNjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9OwoKLyoqKi8gfSksCi8qIDYxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbHNlIC0+IEFycmF5I2luZGV4T2YKLy8gdHJ1ZSAgLT4gQXJyYXkjaW5jbHVkZXMKdmFyIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCB0b0xlbmd0aCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KQogICwgdG9JbmRleCAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oSVNfSU5DTFVERVMpewogIHJldHVybiBmdW5jdGlvbigkdGhpcywgZWwsIGZyb21JbmRleCl7CiAgICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KCR0aGlzKQogICAgICAsIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKQogICAgICAsIGluZGV4ICA9IHRvSW5kZXgoZnJvbUluZGV4LCBsZW5ndGgpCiAgICAgICwgdmFsdWU7CiAgICAvLyBBcnJheSNpbmNsdWRlcyB1c2VzIFNhbWVWYWx1ZVplcm8gZXF1YWxpdHkgYWxnb3JpdGhtCiAgICBpZihJU19JTkNMVURFUyAmJiBlbCAhPSBlbCl3aGlsZShsZW5ndGggPiBpbmRleCl7CiAgICAgIHZhbHVlID0gT1tpbmRleCsrXTsKICAgICAgaWYodmFsdWUgIT0gdmFsdWUpcmV0dXJuIHRydWU7CiAgICAvLyBBcnJheSN0b0luZGV4IGlnbm9yZXMgaG9sZXMsIEFycmF5I2luY2x1ZGVzIC0gbm90CiAgICB9IGVsc2UgZm9yKDtsZW5ndGggPiBpbmRleDsgaW5kZXgrKylpZihJU19JTkNMVURFUyB8fCBpbmRleCBpbiBPKXsKICAgICAgaWYoT1tpbmRleF0gPT09IGVsKXJldHVybiBJU19JTkNMVURFUyB8fCBpbmRleCB8fCAwOwogICAgfSByZXR1cm4gIUlTX0lOQ0xVREVTICYmIC0xOwogIH07Cn07CgovKioqLyB9KSwKLyogNjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIGNyZWF0ZSAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSkKICAsIGRlc2NyaXB0b3IgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIEl0ZXJhdG9yUHJvdG90eXBlID0ge307CgovLyAyNS4xLjIuMS4xICVJdGVyYXRvclByb3RvdHlwZSVbQEBpdGVyYXRvcl0oKQpfX3dlYnBhY2tfcmVxdWlyZV9fKDYpKEl0ZXJhdG9yUHJvdG90eXBlLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpLCBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfSk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKENvbnN0cnVjdG9yLCBOQU1FLCBuZXh0KXsKICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSBjcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUsIHtuZXh0OiBkZXNjcmlwdG9yKDEsIG5leHQpfSk7CiAgc2V0VG9TdHJpbmdUYWcoQ29uc3RydWN0b3IsIE5BTUUgKyAnIEl0ZXJhdG9yJyk7Cn07CgovKioqLyB9KSwKLyogNjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihkb25lLCB2YWx1ZSl7CiAgcmV0dXJuIHt2YWx1ZTogdmFsdWUsIGRvbmU6ICEhZG9uZX07Cn07CgovKioqLyB9KSwKLyogNjQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRQICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpOwoKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpewogIGFuT2JqZWN0KE8pOwogIHZhciBrZXlzICAgPSBnZXRLZXlzKFByb3BlcnRpZXMpCiAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCiAgICAsIGkgPSAwCiAgICAsIFA7CiAgd2hpbGUobGVuZ3RoID4gaSlkUC5mKE8sIFAgPSBrZXlzW2krK10sIFByb3BlcnRpZXNbUF0pOwogIHJldHVybiBPOwp9OwoKLyoqKi8gfSksCi8qIDY1ICovLAovKiA2NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykKICAsIGRlZmluZWQgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwovLyB0cnVlICAtPiBTdHJpbmcjYXQKLy8gZmFsc2UgLT4gU3RyaW5nI2NvZGVQb2ludEF0Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oVE9fU1RSSU5HKXsKICByZXR1cm4gZnVuY3Rpb24odGhhdCwgcG9zKXsKICAgIHZhciBzID0gU3RyaW5nKGRlZmluZWQodGhhdCkpCiAgICAgICwgaSA9IHRvSW50ZWdlcihwb3MpCiAgICAgICwgbCA9IHMubGVuZ3RoCiAgICAgICwgYSwgYjsKICAgIGlmKGkgPCAwIHx8IGkgPj0gbClyZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7CiAgICBhID0gcy5jaGFyQ29kZUF0KGkpOwogICAgcmV0dXJuIGEgPCAweGQ4MDAgfHwgYSA+IDB4ZGJmZiB8fCBpICsgMSA9PT0gbCB8fCAoYiA9IHMuY2hhckNvZGVBdChpICsgMSkpIDwgMHhkYzAwIHx8IGIgPiAweGRmZmYKICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGEKICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGludm9rZSAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODgpCiAgLCBodG1sICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKQogICwgY2VsICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSkKICAsIGdsb2JhbCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBzZXRUYXNrICAgICAgICAgICAgPSBnbG9iYWwuc2V0SW1tZWRpYXRlCiAgLCBjbGVhclRhc2sgICAgICAgICAgPSBnbG9iYWwuY2xlYXJJbW1lZGlhdGUKICAsIE1lc3NhZ2VDaGFubmVsICAgICA9IGdsb2JhbC5NZXNzYWdlQ2hhbm5lbAogICwgY291bnRlciAgICAgICAgICAgID0gMAogICwgcXVldWUgICAgICAgICAgICAgID0ge30KICAsIE9OUkVBRFlTVEFURUNIQU5HRSA9ICdvbnJlYWR5c3RhdGVjaGFuZ2UnCiAgLCBkZWZlciwgY2hhbm5lbCwgcG9ydDsKdmFyIHJ1biA9IGZ1bmN0aW9uKCl7CiAgdmFyIGlkID0gK3RoaXM7CiAgaWYocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKXsKICAgIHZhciBmbiA9IHF1ZXVlW2lkXTsKICAgIGRlbGV0ZSBxdWV1ZVtpZF07CiAgICBmbigpOwogIH0KfTsKdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpewogIHJ1bi5jYWxsKGV2ZW50LmRhdGEpOwp9OwovLyBOb2RlLmpzIDAuOSsgJiBJRTEwKyBoYXMgc2V0SW1tZWRpYXRlLCBvdGhlcndpc2U6CmlmKCFzZXRUYXNrIHx8ICFjbGVhclRhc2spewogIHNldFRhc2sgPSBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoZm4pewogICAgdmFyIGFyZ3MgPSBbXSwgaSA9IDE7CiAgICB3aGlsZShhcmd1bWVudHMubGVuZ3RoID4gaSlhcmdzLnB1c2goYXJndW1lbnRzW2krK10pOwogICAgcXVldWVbKytjb3VudGVyXSA9IGZ1bmN0aW9uKCl7CiAgICAgIGludm9rZSh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pLCBhcmdzKTsKICAgIH07CiAgICBkZWZlcihjb3VudGVyKTsKICAgIHJldHVybiBjb3VudGVyOwogIH07CiAgY2xlYXJUYXNrID0gZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaWQpewogICAgZGVsZXRlIHF1ZXVlW2lkXTsKICB9OwogIC8vIE5vZGUuanMgMC44LQogIGlmKF9fd2VicGFja19yZXF1aXJlX18oMTgpKHByb2Nlc3MpID09ICdwcm9jZXNzJyl7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgcHJvY2Vzcy5uZXh0VGljayhjdHgocnVuLCBpZCwgMSkpOwogICAgfTsKICAvLyBCcm93c2VycyB3aXRoIE1lc3NhZ2VDaGFubmVsLCBpbmNsdWRlcyBXZWJXb3JrZXJzCiAgfSBlbHNlIGlmKE1lc3NhZ2VDaGFubmVsKXsKICAgIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWw7CiAgICBwb3J0ICAgID0gY2hhbm5lbC5wb3J0MjsKICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gbGlzdGVuZXI7CiAgICBkZWZlciA9IGN0eChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTsKICAvLyBCcm93c2VycyB3aXRoIHBvc3RNZXNzYWdlLCBza2lwIFdlYldvcmtlcnMKICAvLyBJRTggaGFzIHBvc3RNZXNzYWdlLCBidXQgaXQncyBzeW5jICYgdHlwZW9mIGl0cyBwb3N0TWVzc2FnZSBpcyAnb2JqZWN0JwogIH0gZWxzZSBpZihnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lciAmJiB0eXBlb2YgcG9zdE1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJyAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShpZCArICcnLCAnKicpOwogICAgfTsKICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbGlzdGVuZXIsIGZhbHNlKTsKICAvLyBJRTgtCiAgfSBlbHNlIGlmKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKXsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBodG1sLmFwcGVuZENoaWxkKGNlbCgnc2NyaXB0JykpW09OUkVBRFlTVEFURUNIQU5HRV0gPSBmdW5jdGlvbigpewogICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7CiAgICAgICAgcnVuLmNhbGwoaWQpOwogICAgICB9OwogICAgfTsKICAvLyBSZXN0IG9sZCBicm93c2VycwogIH0gZWxzZSB7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgc2V0VGltZW91dChjdHgocnVuLCBpZCwgMSksIDApOwogICAgfTsKICB9Cn0KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2V0OiAgIHNldFRhc2ssCiAgY2xlYXI6IGNsZWFyVGFzawp9OwoKLyoqKi8gfSksCi8qIDY4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KQogICwgbWF4ICAgICAgID0gTWF0aC5tYXgKICAsIG1pbiAgICAgICA9IE1hdGgubWluOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGluZGV4LCBsZW5ndGgpewogIGluZGV4ID0gdG9JbnRlZ2VyKGluZGV4KTsKICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbihpbmRleCwgbGVuZ3RoKTsKfTsKCi8qKiovIH0pLAovKiA2OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgYWRkVG9VbnNjb3BhYmxlcyA9IF9fd2VicGFja19yZXF1aXJlX18oNjApCiAgLCBzdGVwICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MykKICAsIEl0ZXJhdG9ycyAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQogICwgdG9JT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwoKLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKQovLyAyMi4xLjMuMTMgQXJyYXkucHJvdG90eXBlLmtleXMoKQovLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpCi8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzgpKEFycmF5LCAnQXJyYXknLCBmdW5jdGlvbihpdGVyYXRlZCwga2luZCl7CiAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4CiAgdGhpcy5fayA9IGtpbmQ7ICAgICAgICAgICAgICAgIC8vIGtpbmQKLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpCn0sIGZ1bmN0aW9uKCl7CiAgdmFyIE8gICAgID0gdGhpcy5fdAogICAgLCBraW5kICA9IHRoaXMuX2sKICAgICwgaW5kZXggPSB0aGlzLl9pKys7CiAgaWYoIU8gfHwgaW5kZXggPj0gTy5sZW5ndGgpewogICAgdGhpcy5fdCA9IHVuZGVmaW5lZDsKICAgIHJldHVybiBzdGVwKDEpOwogIH0KICBpZihraW5kID09ICdrZXlzJyAgKXJldHVybiBzdGVwKDAsIGluZGV4KTsKICBpZihraW5kID09ICd2YWx1ZXMnKXJldHVybiBzdGVwKDAsIE9baW5kZXhdKTsKICByZXR1cm4gc3RlcCgwLCBbaW5kZXgsIE9baW5kZXhdXSk7Cn0sICd2YWx1ZXMnKTsKCi8vIGFyZ3VtZW50c0xpc3RbQEBpdGVyYXRvcl0gaXMgJUFycmF5UHJvdG9fdmFsdWVzJSAoOS40LjQuNiwgOS40LjQuNykKSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTsKCmFkZFRvVW5zY29wYWJsZXMoJ2tleXMnKTsKYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7CmFkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTsKCi8qKiovIH0pLAovKiA3MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDcxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODIpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzIgKi8sCi8qIDczICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjbGFzc29mICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KQogICwgSVRFUkFUT1IgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgSXRlcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCAhPSB1bmRlZmluZWQpcmV0dXJuIGl0W0lURVJBVE9SXQogICAgfHwgaXRbJ0BAaXRlcmF0b3InXQogICAgfHwgSXRlcmF0b3JzW2NsYXNzb2YoaXQpXTsKfTsKCi8qKiovIH0pLAovKiA3NCAqLywKLyogNzUgKi8sCi8qIDc2ICovLAovKiA3NyAqLywKLyogNzggKi8sCi8qIDc5ICovLAovKiA4MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMik7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Qua2V5czsKCi8qKiovIH0pLAovKiA4MSAqLywKLyogODIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg1NCk7Cl9fd2VicGFja19yZXF1aXJlX18oNTApOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKX193ZWJwYWNrX3JlcXVpcmVfXygxMDQpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuUHJvbWlzZTsKCi8qKiovIH0pLAovKiA4MyAqLywKLyogODQgKi8sCi8qIDg1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIENvbnN0cnVjdG9yLCBuYW1lLCBmb3JiaWRkZW5GaWVsZCl7CiAgaWYoIShpdCBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSB8fCAoZm9yYmlkZGVuRmllbGQgIT09IHVuZGVmaW5lZCAmJiBmb3JiaWRkZW5GaWVsZCBpbiBpdCkpewogICAgdGhyb3cgVHlwZUVycm9yKG5hbWUgKyAnOiBpbmNvcnJlY3QgaW52b2NhdGlvbiEnKTsKICB9IHJldHVybiBpdDsKfTsKCi8qKiovIH0pLAovKiA4NiAqLywKLyogODcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGN0eCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGNhbGwgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MSkKICAsIGlzQXJyYXlJdGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4OSkKICAsIGFuT2JqZWN0ICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQogICwgdG9MZW5ndGggICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KQogICwgZ2V0SXRlckZuICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDczKQogICwgQlJFQUsgICAgICAgPSB7fQogICwgUkVUVVJOICAgICAgPSB7fTsKdmFyIGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhYmxlLCBlbnRyaWVzLCBmbiwgdGhhdCwgSVRFUkFUT1IpewogIHZhciBpdGVyRm4gPSBJVEVSQVRPUiA/IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyYWJsZTsgfSA6IGdldEl0ZXJGbihpdGVyYWJsZSkKICAgICwgZiAgICAgID0gY3R4KGZuLCB0aGF0LCBlbnRyaWVzID8gMiA6IDEpCiAgICAsIGluZGV4ICA9IDAKICAgICwgbGVuZ3RoLCBzdGVwLCBpdGVyYXRvciwgcmVzdWx0OwogIGlmKHR5cGVvZiBpdGVyRm4gIT0gJ2Z1bmN0aW9uJyl0aHJvdyBUeXBlRXJyb3IoaXRlcmFibGUgKyAnIGlzIG5vdCBpdGVyYWJsZSEnKTsKICAvLyBmYXN0IGNhc2UgZm9yIGFycmF5cyB3aXRoIGRlZmF1bHQgaXRlcmF0b3IKICBpZihpc0FycmF5SXRlcihpdGVyRm4pKWZvcihsZW5ndGggPSB0b0xlbmd0aChpdGVyYWJsZS5sZW5ndGgpOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKyl7CiAgICByZXN1bHQgPSBlbnRyaWVzID8gZihhbk9iamVjdChzdGVwID0gaXRlcmFibGVbaW5kZXhdKVswXSwgc3RlcFsxXSkgOiBmKGl0ZXJhYmxlW2luZGV4XSk7CiAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7CiAgfSBlbHNlIGZvcihpdGVyYXRvciA9IGl0ZXJGbi5jYWxsKGl0ZXJhYmxlKTsgIShzdGVwID0gaXRlcmF0b3IubmV4dCgpKS5kb25lOyApewogICAgcmVzdWx0ID0gY2FsbChpdGVyYXRvciwgZiwgc3RlcC52YWx1ZSwgZW50cmllcyk7CiAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7CiAgfQp9OwpleHBvcnRzLkJSRUFLICA9IEJSRUFLOwpleHBvcnRzLlJFVFVSTiA9IFJFVFVSTjsKCi8qKiovIH0pLAovKiA4OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBmYXN0IGFwcGx5LCBodHRwOi8vanNwZXJmLmxua2l0LmNvbS9mYXN0LWFwcGx5LzUKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmbiwgYXJncywgdGhhdCl7CiAgdmFyIHVuID0gdGhhdCA9PT0gdW5kZWZpbmVkOwogIHN3aXRjaChhcmdzLmxlbmd0aCl7CiAgICBjYXNlIDA6IHJldHVybiB1biA/IGZuKCkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0KTsKICAgIGNhc2UgMTogcmV0dXJuIHVuID8gZm4oYXJnc1swXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdKTsKICAgIGNhc2UgMjogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdKTsKICAgIGNhc2UgMzogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTsKICAgIGNhc2UgNDogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKTsKICB9IHJldHVybiAgICAgICAgICAgICAgZm4uYXBwbHkodGhhdCwgYXJncyk7Cn07CgovKioqLyB9KSwKLyogODkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gY2hlY2sgb24gZGVmYXVsdCBBcnJheSBpdGVyYXRvcgp2YXIgSXRlcmF0b3JzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCBJVEVSQVRPUiAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCAhPT0gdW5kZWZpbmVkICYmIChJdGVyYXRvcnMuQXJyYXkgPT09IGl0IHx8IEFycmF5UHJvdG9bSVRFUkFUT1JdID09PSBpdCk7Cn07CgovKioqLyB9KSwKLyogOTAgKi8sCi8qIDkxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGNhbGwgc29tZXRoaW5nIG9uIGl0ZXJhdG9yIHN0ZXAgd2l0aCBzYWZlIGNsb3Npbmcgb24gZXJyb3IKdmFyIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdGVyYXRvciwgZm4sIHZhbHVlLCBlbnRyaWVzKXsKICB0cnkgewogICAgcmV0dXJuIGVudHJpZXMgPyBmbihhbk9iamVjdCh2YWx1ZSlbMF0sIHZhbHVlWzFdKSA6IGZuKHZhbHVlKTsKICAvLyA3LjQuNiBJdGVyYXRvckNsb3NlKGl0ZXJhdG9yLCBjb21wbGV0aW9uKQogIH0gY2F0Y2goZSl7CiAgICB2YXIgcmV0ID0gaXRlcmF0b3JbJ3JldHVybiddOwogICAgaWYocmV0ICE9PSB1bmRlZmluZWQpYW5PYmplY3QocmV0LmNhbGwoaXRlcmF0b3IpKTsKICAgIHRocm93IGU7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDkyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBJVEVSQVRPUiAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpCiAgLCBTQUZFX0NMT1NJTkcgPSBmYWxzZTsKCnRyeSB7CiAgdmFyIHJpdGVyID0gWzddW0lURVJBVE9SXSgpOwogIHJpdGVyWydyZXR1cm4nXSA9IGZ1bmN0aW9uKCl7IFNBRkVfQ0xPU0lORyA9IHRydWU7IH07CiAgQXJyYXkuZnJvbShyaXRlciwgZnVuY3Rpb24oKXsgdGhyb3cgMjsgfSk7Cn0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYywgc2tpcENsb3NpbmcpewogIGlmKCFza2lwQ2xvc2luZyAmJiAhU0FGRV9DTE9TSU5HKXJldHVybiBmYWxzZTsKICB2YXIgc2FmZSA9IGZhbHNlOwogIHRyeSB7CiAgICB2YXIgYXJyICA9IFs3XQogICAgICAsIGl0ZXIgPSBhcnJbSVRFUkFUT1JdKCk7CiAgICBpdGVyLm5leHQgPSBmdW5jdGlvbigpeyByZXR1cm4ge2RvbmU6IHNhZmUgPSB0cnVlfTsgfTsKICAgIGFycltJVEVSQVRPUl0gPSBmdW5jdGlvbigpeyByZXR1cm4gaXRlcjsgfTsKICAgIGV4ZWMoYXJyKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgcmV0dXJuIHNhZmU7Cn07CgovKioqLyB9KSwKLyogOTMgKi8sCi8qIDk0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBtYWNyb3Rhc2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KS5zZXQKICAsIE9ic2VydmVyICA9IGdsb2JhbC5NdXRhdGlvbk9ic2VydmVyIHx8IGdsb2JhbC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyCiAgLCBwcm9jZXNzICAgPSBnbG9iYWwucHJvY2VzcwogICwgUHJvbWlzZSAgID0gZ2xvYmFsLlByb21pc2UKICAsIGlzTm9kZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpKHByb2Nlc3MpID09ICdwcm9jZXNzJzsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKXsKICB2YXIgaGVhZCwgbGFzdCwgbm90aWZ5OwoKICB2YXIgZmx1c2ggPSBmdW5jdGlvbigpewogICAgdmFyIHBhcmVudCwgZm47CiAgICBpZihpc05vZGUgJiYgKHBhcmVudCA9IHByb2Nlc3MuZG9tYWluKSlwYXJlbnQuZXhpdCgpOwogICAgd2hpbGUoaGVhZCl7CiAgICAgIGZuICAgPSBoZWFkLmZuOwogICAgICBoZWFkID0gaGVhZC5uZXh0OwogICAgICB0cnkgewogICAgICAgIGZuKCk7CiAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgaWYoaGVhZClub3RpZnkoKTsKICAgICAgICBlbHNlIGxhc3QgPSB1bmRlZmluZWQ7CiAgICAgICAgdGhyb3cgZTsKICAgICAgfQogICAgfSBsYXN0ID0gdW5kZWZpbmVkOwogICAgaWYocGFyZW50KXBhcmVudC5lbnRlcigpOwogIH07CgogIC8vIE5vZGUuanMKICBpZihpc05vZGUpewogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgcHJvY2Vzcy5uZXh0VGljayhmbHVzaCk7CiAgICB9OwogIC8vIGJyb3dzZXJzIHdpdGggTXV0YXRpb25PYnNlcnZlcgogIH0gZWxzZSBpZihPYnNlcnZlcil7CiAgICB2YXIgdG9nZ2xlID0gdHJ1ZQogICAgICAsIG5vZGUgICA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTsKICAgIG5ldyBPYnNlcnZlcihmbHVzaCkub2JzZXJ2ZShub2RlLCB7Y2hhcmFjdGVyRGF0YTogdHJ1ZX0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldwogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgbm9kZS5kYXRhID0gdG9nZ2xlID0gIXRvZ2dsZTsKICAgIH07CiAgLy8gZW52aXJvbm1lbnRzIHdpdGggbWF5YmUgbm9uLWNvbXBsZXRlbHkgY29ycmVjdCwgYnV0IGV4aXN0ZW50IFByb21pc2UKICB9IGVsc2UgaWYoUHJvbWlzZSAmJiBQcm9taXNlLnJlc29sdmUpewogICAgdmFyIHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CiAgICAgIHByb21pc2UudGhlbihmbHVzaCk7CiAgICB9OwogIC8vIGZvciBvdGhlciBlbnZpcm9ubWVudHMgLSBtYWNyb3Rhc2sgYmFzZWQgb246CiAgLy8gLSBzZXRJbW1lZGlhdGUKICAvLyAtIE1lc3NhZ2VDaGFubmVsCiAgLy8gLSB3aW5kb3cucG9zdE1lc3NhZwogIC8vIC0gb25yZWFkeXN0YXRlY2hhbmdlCiAgLy8gLSBzZXRUaW1lb3V0CiAgfSBlbHNlIHsKICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CiAgICAgIC8vIHN0cmFuZ2UgSUUgKyB3ZWJwYWNrIGRldiBzZXJ2ZXIgYnVnIC0gdXNlIC5jYWxsKGdsb2JhbCkKICAgICAgbWFjcm90YXNrLmNhbGwoZ2xvYmFsLCBmbHVzaCk7CiAgICB9OwogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uKGZuKXsKICAgIHZhciB0YXNrID0ge2ZuOiBmbiwgbmV4dDogdW5kZWZpbmVkfTsKICAgIGlmKGxhc3QpbGFzdC5uZXh0ID0gdGFzazsKICAgIGlmKCFoZWFkKXsKICAgICAgaGVhZCA9IHRhc2s7CiAgICAgIG5vdGlmeSgpOwogICAgfSBsYXN0ID0gdGFzazsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDk1ICovLAovKiA5NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaGlkZSA9IF9fd2VicGFja19yZXF1aXJlX18oNik7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odGFyZ2V0LCBzcmMsIHNhZmUpewogIGZvcih2YXIga2V5IGluIHNyYyl7CiAgICBpZihzYWZlICYmIHRhcmdldFtrZXldKXRhcmdldFtrZXldID0gc3JjW2tleV07CiAgICBlbHNlIGhpZGUodGFyZ2V0LCBrZXksIHNyY1trZXldKTsKICB9IHJldHVybiB0YXJnZXQ7Cn07CgovKioqLyB9KSwKLyogOTcgKi8sCi8qIDk4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBnbG9iYWwgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGNvcmUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQogICwgZFAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBERVNDUklQVE9SUyA9IF9fd2VicGFja19yZXF1aXJlX18oMykKICAsIFNQRUNJRVMgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnc3BlY2llcycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihLRVkpewogIHZhciBDID0gdHlwZW9mIGNvcmVbS0VZXSA9PSAnZnVuY3Rpb24nID8gY29yZVtLRVldIDogZ2xvYmFsW0tFWV07CiAgaWYoREVTQ1JJUFRPUlMgJiYgQyAmJiAhQ1tTUEVDSUVTXSlkUC5mKEMsIFNQRUNJRVMsIHsKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgIGdldDogZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH0KICB9KTsKfTsKCi8qKiovIH0pLAovKiA5OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjMuMjAgU3BlY2llc0NvbnN0cnVjdG9yKE8sIGRlZmF1bHRDb25zdHJ1Y3RvcikKdmFyIGFuT2JqZWN0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIGFGdW5jdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMjApCiAgLCBTUEVDSUVTICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdzcGVjaWVzJyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oTywgRCl7CiAgdmFyIEMgPSBhbk9iamVjdChPKS5jb25zdHJ1Y3RvciwgUzsKICByZXR1cm4gQyA9PT0gdW5kZWZpbmVkIHx8IChTID0gYW5PYmplY3QoQylbU1BFQ0lFU10pID09IHVuZGVmaW5lZCA/IEQgOiBhRnVuY3Rpb24oUyk7Cn07CgovKioqLyB9KSwKLyogMTAwICovLAovKiAxMDEgKi8sCi8qIDEwMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuMTQgT2JqZWN0LmtleXMoTykKdmFyIHRvT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMikKICAsICRrZXlzICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KSgna2V5cycsIGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGZ1bmN0aW9uIGtleXMoaXQpewogICAgcmV0dXJuICRrZXlzKHRvT2JqZWN0KGl0KSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTAzICovLAovKiAxMDQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIExJQlJBUlkgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpCiAgLCBnbG9iYWwgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjdHggICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgY2xhc3NvZiAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NSkKICAsICRleHBvcnQgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKICAsIGlzT2JqZWN0ICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIGFGdW5jdGlvbiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjApCiAgLCBhbkluc3RhbmNlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg1KQogICwgZm9yT2YgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NykKICAsIHNwZWNpZXNDb25zdHJ1Y3RvciA9IF9fd2VicGFja19yZXF1aXJlX18oOTkpCiAgLCB0YXNrICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KS5zZXQKICAsIG1pY3JvdGFzayAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTQpKCkKICAsIFBST01JU0UgICAgICAgICAgICA9ICdQcm9taXNlJwogICwgVHlwZUVycm9yICAgICAgICAgID0gZ2xvYmFsLlR5cGVFcnJvcgogICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MKICAsICRQcm9taXNlICAgICAgICAgICA9IGdsb2JhbFtQUk9NSVNFXQogICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MKICAsIGlzTm9kZSAgICAgICAgICAgICA9IGNsYXNzb2YocHJvY2VzcykgPT0gJ3Byb2Nlc3MnCiAgLCBlbXB0eSAgICAgICAgICAgICAgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9CiAgLCBJbnRlcm5hbCwgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5LCBXcmFwcGVyOwoKdmFyIFVTRV9OQVRJVkUgPSAhIWZ1bmN0aW9uKCl7CiAgdHJ5IHsKICAgIC8vIGNvcnJlY3Qgc3ViY2xhc3Npbmcgd2l0aCBAQHNwZWNpZXMgc3VwcG9ydAogICAgdmFyIHByb21pc2UgICAgID0gJFByb21pc2UucmVzb2x2ZSgxKQogICAgICAsIEZha2VQcm9taXNlID0gKHByb21pc2UuY29uc3RydWN0b3IgPSB7fSlbX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnc3BlY2llcycpXSA9IGZ1bmN0aW9uKGV4ZWMpeyBleGVjKGVtcHR5LCBlbXB0eSk7IH07CiAgICAvLyB1bmhhbmRsZWQgcmVqZWN0aW9ucyB0cmFja2luZyBzdXBwb3J0LCBOb2RlSlMgUHJvbWlzZSB3aXRob3V0IGl0IGZhaWxzIEBAc3BlY2llcyB0ZXN0CiAgICByZXR1cm4gKGlzTm9kZSB8fCB0eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50ID09ICdmdW5jdGlvbicpICYmIHByb21pc2UudGhlbihlbXB0eSkgaW5zdGFuY2VvZiBGYWtlUHJvbWlzZTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9Cn0oKTsKCi8vIGhlbHBlcnMKdmFyIHNhbWVDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKGEsIGIpewogIC8vIHdpdGggbGlicmFyeSB3cmFwcGVyIHNwZWNpYWwgY2FzZQogIHJldHVybiBhID09PSBiIHx8IGEgPT09ICRQcm9taXNlICYmIGIgPT09IFdyYXBwZXI7Cn07CnZhciBpc1RoZW5hYmxlID0gZnVuY3Rpb24oaXQpewogIHZhciB0aGVuOwogIHJldHVybiBpc09iamVjdChpdCkgJiYgdHlwZW9mICh0aGVuID0gaXQudGhlbikgPT0gJ2Z1bmN0aW9uJyA/IHRoZW4gOiBmYWxzZTsKfTsKdmFyIG5ld1Byb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24oQyl7CiAgcmV0dXJuIHNhbWVDb25zdHJ1Y3RvcigkUHJvbWlzZSwgQykKICAgID8gbmV3IFByb21pc2VDYXBhYmlsaXR5KEMpCiAgICA6IG5ldyBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkoQyk7Cn07CnZhciBQcm9taXNlQ2FwYWJpbGl0eSA9IEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewogIHZhciByZXNvbHZlLCByZWplY3Q7CiAgdGhpcy5wcm9taXNlID0gbmV3IEMoZnVuY3Rpb24oJCRyZXNvbHZlLCAkJHJlamVjdCl7CiAgICBpZihyZXNvbHZlICE9PSB1bmRlZmluZWQgfHwgcmVqZWN0ICE9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCdCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvcicpOwogICAgcmVzb2x2ZSA9ICQkcmVzb2x2ZTsKICAgIHJlamVjdCAgPSAkJHJlamVjdDsKICB9KTsKICB0aGlzLnJlc29sdmUgPSBhRnVuY3Rpb24ocmVzb2x2ZSk7CiAgdGhpcy5yZWplY3QgID0gYUZ1bmN0aW9uKHJlamVjdCk7Cn07CnZhciBwZXJmb3JtID0gZnVuY3Rpb24oZXhlYyl7CiAgdHJ5IHsKICAgIGV4ZWMoKTsKICB9IGNhdGNoKGUpewogICAgcmV0dXJuIHtlcnJvcjogZX07CiAgfQp9Owp2YXIgbm90aWZ5ID0gZnVuY3Rpb24ocHJvbWlzZSwgaXNSZWplY3QpewogIGlmKHByb21pc2UuX24pcmV0dXJuOwogIHByb21pc2UuX24gPSB0cnVlOwogIHZhciBjaGFpbiA9IHByb21pc2UuX2M7CiAgbWljcm90YXNrKGZ1bmN0aW9uKCl7CiAgICB2YXIgdmFsdWUgPSBwcm9taXNlLl92CiAgICAgICwgb2sgICAgPSBwcm9taXNlLl9zID09IDEKICAgICAgLCBpICAgICA9IDA7CiAgICB2YXIgcnVuID0gZnVuY3Rpb24ocmVhY3Rpb24pewogICAgICB2YXIgaGFuZGxlciA9IG9rID8gcmVhY3Rpb24ub2sgOiByZWFjdGlvbi5mYWlsCiAgICAgICAgLCByZXNvbHZlID0gcmVhY3Rpb24ucmVzb2x2ZQogICAgICAgICwgcmVqZWN0ICA9IHJlYWN0aW9uLnJlamVjdAogICAgICAgICwgZG9tYWluICA9IHJlYWN0aW9uLmRvbWFpbgogICAgICAgICwgcmVzdWx0LCB0aGVuOwogICAgICB0cnkgewogICAgICAgIGlmKGhhbmRsZXIpewogICAgICAgICAgaWYoIW9rKXsKICAgICAgICAgICAgaWYocHJvbWlzZS5faCA9PSAyKW9uSGFuZGxlVW5oYW5kbGVkKHByb21pc2UpOwogICAgICAgICAgICBwcm9taXNlLl9oID0gMTsKICAgICAgICAgIH0KICAgICAgICAgIGlmKGhhbmRsZXIgPT09IHRydWUpcmVzdWx0ID0gdmFsdWU7CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYoZG9tYWluKWRvbWFpbi5lbnRlcigpOwogICAgICAgICAgICByZXN1bHQgPSBoYW5kbGVyKHZhbHVlKTsKICAgICAgICAgICAgaWYoZG9tYWluKWRvbWFpbi5leGl0KCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZihyZXN1bHQgPT09IHJlYWN0aW9uLnByb21pc2UpewogICAgICAgICAgICByZWplY3QoVHlwZUVycm9yKCdQcm9taXNlLWNoYWluIGN5Y2xlJykpOwogICAgICAgICAgfSBlbHNlIGlmKHRoZW4gPSBpc1RoZW5hYmxlKHJlc3VsdCkpewogICAgICAgICAgICB0aGVuLmNhbGwocmVzdWx0LCByZXNvbHZlLCByZWplY3QpOwogICAgICAgICAgfSBlbHNlIHJlc29sdmUocmVzdWx0KTsKICAgICAgICB9IGVsc2UgcmVqZWN0KHZhbHVlKTsKICAgICAgfSBjYXRjaChlKXsKICAgICAgICByZWplY3QoZSk7CiAgICAgIH0KICAgIH07CiAgICB3aGlsZShjaGFpbi5sZW5ndGggPiBpKXJ1bihjaGFpbltpKytdKTsgLy8gdmFyaWFibGUgbGVuZ3RoIC0gY2FuJ3QgdXNlIGZvckVhY2gKICAgIHByb21pc2UuX2MgPSBbXTsKICAgIHByb21pc2UuX24gPSBmYWxzZTsKICAgIGlmKGlzUmVqZWN0ICYmICFwcm9taXNlLl9oKW9uVW5oYW5kbGVkKHByb21pc2UpOwogIH0pOwp9Owp2YXIgb25VbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKICB0YXNrLmNhbGwoZ2xvYmFsLCBmdW5jdGlvbigpewogICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgogICAgICAsIGFicnVwdCwgaGFuZGxlciwgY29uc29sZTsKICAgIGlmKGlzVW5oYW5kbGVkKHByb21pc2UpKXsKICAgICAgYWJydXB0ID0gcGVyZm9ybShmdW5jdGlvbigpewogICAgICAgIGlmKGlzTm9kZSl7CiAgICAgICAgICBwcm9jZXNzLmVtaXQoJ3VuaGFuZGxlZFJlamVjdGlvbicsIHZhbHVlLCBwcm9taXNlKTsKICAgICAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnVuaGFuZGxlZHJlamVjdGlvbil7CiAgICAgICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHZhbHVlfSk7CiAgICAgICAgfSBlbHNlIGlmKChjb25zb2xlID0gZ2xvYmFsLmNvbnNvbGUpICYmIGNvbnNvbGUuZXJyb3IpewogICAgICAgICAgY29uc29sZS5lcnJvcignVW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uJywgdmFsdWUpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIC8vIEJyb3dzZXJzIHNob3VsZCBub3QgdHJpZ2dlciBgcmVqZWN0aW9uSGFuZGxlZGAgZXZlbnQgaWYgaXQgd2FzIGhhbmRsZWQgaGVyZSwgTm9kZUpTIC0gc2hvdWxkCiAgICAgIHByb21pc2UuX2ggPSBpc05vZGUgfHwgaXNVbmhhbmRsZWQocHJvbWlzZSkgPyAyIDogMTsKICAgIH0gcHJvbWlzZS5fYSA9IHVuZGVmaW5lZDsKICAgIGlmKGFicnVwdCl0aHJvdyBhYnJ1cHQuZXJyb3I7CiAgfSk7Cn07CnZhciBpc1VuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2UpewogIGlmKHByb21pc2UuX2ggPT0gMSlyZXR1cm4gZmFsc2U7CiAgdmFyIGNoYWluID0gcHJvbWlzZS5fYSB8fCBwcm9taXNlLl9jCiAgICAsIGkgICAgID0gMAogICAgLCByZWFjdGlvbjsKICB3aGlsZShjaGFpbi5sZW5ndGggPiBpKXsKICAgIHJlYWN0aW9uID0gY2hhaW5baSsrXTsKICAgIGlmKHJlYWN0aW9uLmZhaWwgfHwgIWlzVW5oYW5kbGVkKHJlYWN0aW9uLnByb21pc2UpKXJldHVybiBmYWxzZTsKICB9IHJldHVybiB0cnVlOwp9Owp2YXIgb25IYW5kbGVVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKICB0YXNrLmNhbGwoZ2xvYmFsLCBmdW5jdGlvbigpewogICAgdmFyIGhhbmRsZXI7CiAgICBpZihpc05vZGUpewogICAgICBwcm9jZXNzLmVtaXQoJ3JlamVjdGlvbkhhbmRsZWQnLCBwcm9taXNlKTsKICAgIH0gZWxzZSBpZihoYW5kbGVyID0gZ2xvYmFsLm9ucmVqZWN0aW9uaGFuZGxlZCl7CiAgICAgIGhhbmRsZXIoe3Byb21pc2U6IHByb21pc2UsIHJlYXNvbjogcHJvbWlzZS5fdn0pOwogICAgfQogIH0pOwp9Owp2YXIgJHJlamVjdCA9IGZ1bmN0aW9uKHZhbHVlKXsKICB2YXIgcHJvbWlzZSA9IHRoaXM7CiAgaWYocHJvbWlzZS5fZClyZXR1cm47CiAgcHJvbWlzZS5fZCA9IHRydWU7CiAgcHJvbWlzZSA9IHByb21pc2UuX3cgfHwgcHJvbWlzZTsgLy8gdW53cmFwCiAgcHJvbWlzZS5fdiA9IHZhbHVlOwogIHByb21pc2UuX3MgPSAyOwogIGlmKCFwcm9taXNlLl9hKXByb21pc2UuX2EgPSBwcm9taXNlLl9jLnNsaWNlKCk7CiAgbm90aWZ5KHByb21pc2UsIHRydWUpOwp9Owp2YXIgJHJlc29sdmUgPSBmdW5jdGlvbih2YWx1ZSl7CiAgdmFyIHByb21pc2UgPSB0aGlzCiAgICAsIHRoZW47CiAgaWYocHJvbWlzZS5fZClyZXR1cm47CiAgcHJvbWlzZS5fZCA9IHRydWU7CiAgcHJvbWlzZSA9IHByb21pc2UuX3cgfHwgcHJvbWlzZTsgLy8gdW53cmFwCiAgdHJ5IHsKICAgIGlmKHByb21pc2UgPT09IHZhbHVlKXRocm93IFR5cGVFcnJvcigiUHJvbWlzZSBjYW4ndCBiZSByZXNvbHZlZCBpdHNlbGYiKTsKICAgIGlmKHRoZW4gPSBpc1RoZW5hYmxlKHZhbHVlKSl7CiAgICAgIG1pY3JvdGFzayhmdW5jdGlvbigpewogICAgICAgIHZhciB3cmFwcGVyID0ge193OiBwcm9taXNlLCBfZDogZmFsc2V9OyAvLyB3cmFwCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHRoZW4uY2FsbCh2YWx1ZSwgY3R4KCRyZXNvbHZlLCB3cmFwcGVyLCAxKSwgY3R4KCRyZWplY3QsIHdyYXBwZXIsIDEpKTsKICAgICAgICB9IGNhdGNoKGUpewogICAgICAgICAgJHJlamVjdC5jYWxsKHdyYXBwZXIsIGUpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBwcm9taXNlLl92ID0gdmFsdWU7CiAgICAgIHByb21pc2UuX3MgPSAxOwogICAgICBub3RpZnkocHJvbWlzZSwgZmFsc2UpOwogICAgfQogIH0gY2F0Y2goZSl7CiAgICAkcmVqZWN0LmNhbGwoe193OiBwcm9taXNlLCBfZDogZmFsc2V9LCBlKTsgLy8gd3JhcAogIH0KfTsKCi8vIGNvbnN0cnVjdG9yIHBvbHlmaWxsCmlmKCFVU0VfTkFUSVZFKXsKICAvLyAyNS40LjMuMSBQcm9taXNlKGV4ZWN1dG9yKQogICRQcm9taXNlID0gZnVuY3Rpb24gUHJvbWlzZShleGVjdXRvcil7CiAgICBhbkluc3RhbmNlKHRoaXMsICRQcm9taXNlLCBQUk9NSVNFLCAnX2gnKTsKICAgIGFGdW5jdGlvbihleGVjdXRvcik7CiAgICBJbnRlcm5hbC5jYWxsKHRoaXMpOwogICAgdHJ5IHsKICAgICAgZXhlY3V0b3IoY3R4KCRyZXNvbHZlLCB0aGlzLCAxKSwgY3R4KCRyZWplY3QsIHRoaXMsIDEpKTsKICAgIH0gY2F0Y2goZXJyKXsKICAgICAgJHJlamVjdC5jYWxsKHRoaXMsIGVycik7CiAgICB9CiAgfTsKICBJbnRlcm5hbCA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpewogICAgdGhpcy5fYyA9IFtdOyAgICAgICAgICAgICAvLyA8LSBhd2FpdGluZyByZWFjdGlvbnMKICAgIHRoaXMuX2EgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gY2hlY2tlZCBpbiBpc1VuaGFuZGxlZCByZWFjdGlvbnMKICAgIHRoaXMuX3MgPSAwOyAgICAgICAgICAgICAgLy8gPC0gc3RhdGUKICAgIHRoaXMuX2QgPSBmYWxzZTsgICAgICAgICAgLy8gPC0gZG9uZQogICAgdGhpcy5fdiA9IHVuZGVmaW5lZDsgICAgICAvLyA8LSB2YWx1ZQogICAgdGhpcy5faCA9IDA7ICAgICAgICAgICAgICAvLyA8LSByZWplY3Rpb24gc3RhdGUsIDAgLSBkZWZhdWx0LCAxIC0gaGFuZGxlZCwgMiAtIHVuaGFuZGxlZAogICAgdGhpcy5fbiA9IGZhbHNlOyAgICAgICAgICAvLyA8LSBub3RpZnkKICB9OwogIEludGVybmFsLnByb3RvdHlwZSA9IF9fd2VicGFja19yZXF1aXJlX18oOTYpKCRQcm9taXNlLnByb3RvdHlwZSwgewogICAgLy8gMjUuNC41LjMgUHJvbWlzZS5wcm90b3R5cGUudGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCkKICAgIHRoZW46IGZ1bmN0aW9uIHRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpewogICAgICB2YXIgcmVhY3Rpb24gICAgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShzcGVjaWVzQ29uc3RydWN0b3IodGhpcywgJFByb21pc2UpKTsKICAgICAgcmVhY3Rpb24ub2sgICAgID0gdHlwZW9mIG9uRnVsZmlsbGVkID09ICdmdW5jdGlvbicgPyBvbkZ1bGZpbGxlZCA6IHRydWU7CiAgICAgIHJlYWN0aW9uLmZhaWwgICA9IHR5cGVvZiBvblJlamVjdGVkID09ICdmdW5jdGlvbicgJiYgb25SZWplY3RlZDsKICAgICAgcmVhY3Rpb24uZG9tYWluID0gaXNOb2RlID8gcHJvY2Vzcy5kb21haW4gOiB1bmRlZmluZWQ7CiAgICAgIHRoaXMuX2MucHVzaChyZWFjdGlvbik7CiAgICAgIGlmKHRoaXMuX2EpdGhpcy5fYS5wdXNoKHJlYWN0aW9uKTsKICAgICAgaWYodGhpcy5fcylub3RpZnkodGhpcywgZmFsc2UpOwogICAgICByZXR1cm4gcmVhY3Rpb24ucHJvbWlzZTsKICAgIH0sCiAgICAvLyAyNS40LjUuMSBQcm9taXNlLnByb3RvdHlwZS5jYXRjaChvblJlamVjdGVkKQogICAgJ2NhdGNoJzogZnVuY3Rpb24ob25SZWplY3RlZCl7CiAgICAgIHJldHVybiB0aGlzLnRoZW4odW5kZWZpbmVkLCBvblJlamVjdGVkKTsKICAgIH0KICB9KTsKICBQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKCl7CiAgICB2YXIgcHJvbWlzZSAgPSBuZXcgSW50ZXJuYWw7CiAgICB0aGlzLnByb21pc2UgPSBwcm9taXNlOwogICAgdGhpcy5yZXNvbHZlID0gY3R4KCRyZXNvbHZlLCBwcm9taXNlLCAxKTsKICAgIHRoaXMucmVqZWN0ICA9IGN0eCgkcmVqZWN0LCBwcm9taXNlLCAxKTsKICB9Owp9CgokZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuVyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCB7UHJvbWlzZTogJFByb21pc2V9KTsKX193ZWJwYWNrX3JlcXVpcmVfXygyMSkoJFByb21pc2UsIFBST01JU0UpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDk4KShQUk9NSVNFKTsKV3JhcHBlciA9IF9fd2VicGFja19yZXF1aXJlX18oMClbUFJPTUlTRV07CgovLyBzdGF0aWNzCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIFBST01JU0UsIHsKICAvLyAyNS40LjQuNSBQcm9taXNlLnJlamVjdChyKQogIHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KHIpewogICAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eSh0aGlzKQogICAgICAsICQkcmVqZWN0ICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKICAgICQkcmVqZWN0KHIpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIChMSUJSQVJZIHx8ICFVU0VfTkFUSVZFKSwgUFJPTUlTRSwgewogIC8vIDI1LjQuNC42IFByb21pc2UucmVzb2x2ZSh4KQogIHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmUoeCl7CiAgICAvLyBpbnN0YW5jZW9mIGluc3RlYWQgb2YgaW50ZXJuYWwgc2xvdCBjaGVjayBiZWNhdXNlIHdlIHNob3VsZCBmaXggaXQgd2l0aG91dCByZXBsYWNlbWVudCBuYXRpdmUgUHJvbWlzZSBjb3JlCiAgICBpZih4IGluc3RhbmNlb2YgJFByb21pc2UgJiYgc2FtZUNvbnN0cnVjdG9yKHguY29uc3RydWN0b3IsIHRoaXMpKXJldHVybiB4OwogICAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eSh0aGlzKQogICAgICAsICQkcmVzb2x2ZSAgPSBjYXBhYmlsaXR5LnJlc29sdmU7CiAgICAkJHJlc29sdmUoeCk7CiAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwogIH0KfSk7CiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIShVU0VfTkFUSVZFICYmIF9fd2VicGFja19yZXF1aXJlX18oOTIpKGZ1bmN0aW9uKGl0ZXIpewogICRQcm9taXNlLmFsbChpdGVyKVsnY2F0Y2gnXShlbXB0eSk7Cn0pKSwgUFJPTUlTRSwgewogIC8vIDI1LjQuNC4xIFByb21pc2UuYWxsKGl0ZXJhYmxlKQogIGFsbDogZnVuY3Rpb24gYWxsKGl0ZXJhYmxlKXsKICAgIHZhciBDICAgICAgICAgID0gdGhpcwogICAgICAsIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgICAsIHJlc29sdmUgICAgPSBjYXBhYmlsaXR5LnJlc29sdmUKICAgICAgLCByZWplY3QgICAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgICB2YXIgYWJydXB0ID0gcGVyZm9ybShmdW5jdGlvbigpewogICAgICB2YXIgdmFsdWVzICAgID0gW10KICAgICAgICAsIGluZGV4ICAgICA9IDAKICAgICAgICAsIHJlbWFpbmluZyA9IDE7CiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CiAgICAgICAgdmFyICRpbmRleCAgICAgICAgPSBpbmRleCsrCiAgICAgICAgICAsIGFscmVhZHlDYWxsZWQgPSBmYWxzZTsKICAgICAgICB2YWx1ZXMucHVzaCh1bmRlZmluZWQpOwogICAgICAgIHJlbWFpbmluZysrOwogICAgICAgIEMucmVzb2x2ZShwcm9taXNlKS50aGVuKGZ1bmN0aW9uKHZhbHVlKXsKICAgICAgICAgIGlmKGFscmVhZHlDYWxsZWQpcmV0dXJuOwogICAgICAgICAgYWxyZWFkeUNhbGxlZCAgPSB0cnVlOwogICAgICAgICAgdmFsdWVzWyRpbmRleF0gPSB2YWx1ZTsKICAgICAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKICAgICAgICB9LCByZWplY3QpOwogICAgICB9KTsKICAgICAgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpOwogICAgfSk7CiAgICBpZihhYnJ1cHQpcmVqZWN0KGFicnVwdC5lcnJvcik7CiAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwogIH0sCiAgLy8gMjUuNC40LjQgUHJvbWlzZS5yYWNlKGl0ZXJhYmxlKQogIHJhY2U6IGZ1bmN0aW9uIHJhY2UoaXRlcmFibGUpewogICAgdmFyIEMgICAgICAgICAgPSB0aGlzCiAgICAgICwgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KEMpCiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwogICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgZm9yT2YoaXRlcmFibGUsIGZhbHNlLCBmdW5jdGlvbihwcm9taXNlKXsKICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihjYXBhYmlsaXR5LnJlc29sdmUsIHJlamVjdCk7CiAgICAgIH0pOwogICAgfSk7CiAgICBpZihhYnJ1cHQpcmVqZWN0KGFicnVwdC5lcnJvcik7CiAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwogIH0KfSk7CgovKioqLyB9KSwKLyogMTA1ICovLAovKiAxMDYgKi8sCi8qIDEwNyAqLywKLyogMTA4ICovLAovKiAxMDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfc3RyaW5naWZ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7Cgp2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKZXhwb3J0cy5kaXZpZGVFbWFpbCA9IGRpdmlkZUVtYWlsOwpleHBvcnRzLmVtcHR5T2JqZWN0ID0gZW1wdHlPYmplY3Q7CmV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwpleHBvcnRzLmdldFVzZXJVUkxGcm9tRW1haWwgPSBnZXRVc2VyVVJMRnJvbUVtYWlsOwpleHBvcnRzLmdldFVzZXJFbWFpbEZyb21VUkwgPSBnZXRVc2VyRW1haWxGcm9tVVJMOwpleHBvcnRzLmNvbnZlcnRUb1VzZXJVUkwgPSBjb252ZXJ0VG9Vc2VyVVJMOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwovKioKICogU3VwcG9ydCBtb2R1bGUgd2l0aCBzb21lIGZ1bmN0aW9ucyB3aWxsIGJlIHVzZWZ1bAogKiBAbW9kdWxlIHV0aWxzCiAqLwoKLyoqCiAqIEB0eXBlZGVmIGRpdmlkZVVSTAogKiBAdHlwZSBPYmplY3QKICogQHByb3BlcnR5IHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgVVJMCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkb21haW4gVGhlIGRvbWFpbiBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiBVUkwKICovCgovKioKICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5CiAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAqIEByZXR1cm4ge2RpdmlkZVVSTH0gdGhlIHJlc3VsdCBvZiBkaXZpZGVVUkwKICovCmZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHsKCiAgaWYgKCF1cmwpIHRocm93IEVycm9yKCdVUkwgaXMgbmVlZGVkIHRvIHNwbGl0Jyk7CgogIGZ1bmN0aW9uIHJlY3Vyc2UodmFsdWUpIHsKICAgIHZhciByZWdleCA9IC8oW2EtekEtWi1dKikoOlwvXC8oPzpcLik/fDopKFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTsKICAgIHZhciBzdWJzdCA9ICckMSwkMywkNCc7CiAgICB2YXIgcGFydHMgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBzdWJzdCkuc3BsaXQoJywnKTsKICAgIHJldHVybiBwYXJ0czsKICB9CgogIHZhciBwYXJ0cyA9IHJlY3Vyc2UodXJsKTsKCiAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lCiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgIXBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKCiAgICB2YXIgX3Jlc3VsdCA9IHsKICAgICAgdHlwZTogIiIsCiAgICAgIGRvbWFpbjogdXJsLAogICAgICBpZGVudGl0eTogIiIKICAgIH07CgogICAgY29uc29sZS5lcnJvcignW0RpdmlkZVVSTF0gRGl2aWRlVVJMIGRvblwndCBzdXBwb3J0IHVybCB3aXRob3V0IHNjaGVtZS4gUGxlYXNlIHJldmlldyB5b3VyIHVybCBhZGRyZXNzJywgdXJsKTsKCiAgICByZXR1cm4gX3Jlc3VsdDsKICB9CgogIC8vIGNoZWNrIGlmIHRoZSB1cmwgaGFzIHRoZSBzY2hlbWUgYW5kIGluY2x1ZGVzIGFuIEAKICBpZiAocGFydHNbMF0gPT09IHVybCAmJiBwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CiAgICB2YXIgc2NoZW1lID0gcGFydHNbMF0gPT09IHVybCA/ICdzbXRwJyA6IHBhcnRzWzBdOwogICAgcGFydHMgPSByZWN1cnNlKHNjaGVtZSArICc6Ly8nICsgcGFydHNbMF0pOwogIH0KCiAgLy8gaWYgdGhlIGRvbWFpbiBpbmNsdWRlcyBhbiBALCBkaXZpZGUgaXQgdG8gZG9tYWluIGFuZCBpZGVudGl0eSByZXNwZWN0aXZlbHkKICBpZiAocGFydHNbMV0uaW5jbHVkZXMoJ0AnKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1swXSArICc6Ly8nICsgcGFydHNbMV07CiAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdLnN1YnN0cihwYXJ0c1sxXS5pbmRleE9mKCdAJykgKyAxKTsKICB9IC8qZWxzZSBpZiAocGFydHNbMl0uaW5jbHVkZXMoJy8nKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1syXS5zdWJzdHIocGFydHNbMl0ubGFzdEluZGV4T2YoJy8nKSsxKTsKICAgIH0qLwoKICB2YXIgcmVzdWx0ID0gewogICAgdHlwZTogcGFydHNbMF0sCiAgICBkb21haW46IHBhcnRzWzFdLAogICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgfTsKCiAgcmV0dXJuIHJlc3VsdDsKfQoKZnVuY3Rpb24gZGl2aWRlRW1haWwoZW1haWwpIHsKICB2YXIgaW5kZXhPZkF0ID0gZW1haWwuaW5kZXhPZignQCcpOwoKICB2YXIgcmVzdWx0ID0gewogICAgdXNlcm5hbWU6IGVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpLAogICAgZG9tYWluOiBlbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgZW1haWwubGVuZ3RoKQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBDaGVjayBpZiBhbiBPYmplY3QgaXMgZW1wdHkKICogQHBhcmFtICB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IHRvIGJlIGNoZWNrZWQKICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgc3RhdHVzIG9mIE9iamVjdCwgZW1wdHkgb3Igbm90ICh0cnVlfGZhbHNlKTsKICovCmZ1bmN0aW9uIGVtcHR5T2JqZWN0KG9iamVjdCkgewogIHJldHVybiAoMCwgX2tleXMyLmRlZmF1bHQpKG9iamVjdCkubGVuZ3RoID4gMCA/IGZhbHNlIDogdHJ1ZTsKfQoKLyoqCiAqIE1ha2UgYSBDT1BZIG9mIHRoZSBvcmlnaW5hbCBkYXRhCiAqIEBwYXJhbSAge09iamVjdH0gIG9iaiAtIG9iamVjdCB0byBiZSBjbG9uZWQKICogQHJldHVybiB7T2JqZWN0fQogKi8KZnVuY3Rpb24gZGVlcENsb25lKG9iaikgewogIC8vVE9ETzogc2ltcGxlIGJ1dCBpbmVmZmljaWVudCBKU09OIGRlZXAgY2xvbmUuLi4KICBpZiAob2JqKSByZXR1cm4gSlNPTi5wYXJzZSgoMCwgX3N0cmluZ2lmeTIuZGVmYXVsdCkob2JqKSk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIFVSTCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gZW1haWwKICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICogQHJldHVybiB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICovCmZ1bmN0aW9uIGdldFVzZXJVUkxGcm9tRW1haWwodXNlckVtYWlsKSB7CiAgdmFyIGluZGV4T2ZBdCA9IHVzZXJFbWFpbC5pbmRleE9mKCdAJyk7CiAgcmV0dXJuICd1c2VyOi8vJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgdXNlckVtYWlsLmxlbmd0aCkgKyAnLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIGVtYWlsIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBVUkwKICogQHBhcmFtICB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICogQHJldHVybiB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICovCmZ1bmN0aW9uIGdldFVzZXJFbWFpbEZyb21VUkwodXNlclVSTCkgewogIHZhciB1cmwgPSBkaXZpZGVVUkwodXNlclVSTCk7CiAgcmV0dXJuIHVybC5pZGVudGl0eS5yZXBsYWNlKCcvJywgJycpICsgJ0AnICsgdXJsLmRvbWFpbjsgLy8gaWRlbnRpdHkgZmllbGQgaGFzICcvZXhhbXBsZUlEJyBpbnN0ZWFkIG9mICdleGFtcGxlSUQnCn0KCi8qKgogKiBDaGVjayBpZiB0aGUgdXNlciBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIFVSTCBmb3JtYXQsIGlmIG5vdCwgY29udmVydCB0byBVUkwgZm9ybWF0CiAqIEBwYXJhbSAge3N0cmluZ30gICBpZGVudGlmaWVyICB1c2VyIGlkZW50aWZpZXIKICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMCiAqLwpmdW5jdGlvbiBjb252ZXJ0VG9Vc2VyVVJMKGlkZW50aWZpZXIpIHsKCiAgLy8gY2hlY2sgaWYgdGhlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgdXJsIGZvcm1hdAogIGlmIChpZGVudGlmaWVyLnN1YnN0cmluZygwLCA3KSA9PT0gJ3VzZXI6Ly8nKSB7CiAgICB2YXIgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChpZGVudGlmaWVyKTsKCiAgICAvL2NoZWNrIGlmIHRoZSB1cmwgaXMgd2VsbCBmb3JtYXRlZAogICAgaWYgKGRpdmlkZWRVUkwuZG9tYWluICYmIGRpdmlkZWRVUkwuaWRlbnRpdHkpIHsKICAgICAgcmV0dXJuIGlkZW50aWZpZXI7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyAndXNlclVSTCB3aXRoIHdyb25nIGZvcm1hdCc7CiAgICB9CgogICAgLy9pZiBub3QsIGNvbnZlcnQgdGhlIHVzZXIgZW1haWwgdG8gVVJMIGZvcm1hdAogIH0gZWxzZSB7CiAgICByZXR1cm4gZ2V0VXNlclVSTEZyb21FbWFpbChpZGVudGlmaWVyKTsKICB9Cn0KCi8qKiovIH0pLAovKiAxMTAgKi8sCi8qIDExMSAqLywKLyogMTEyICovLAovKiAxMTMgKi8sCi8qIDExNCAqLywKLyogMTE1ICovLAovKiAxMTYgKi8sCi8qIDExNyAqLywKLyogMTE4ICovLAovKiAxMTkgKi8sCi8qIDEyMCAqLywKLyogMTIxICovLAovKiAxMjIgKi8sCi8qIDEyMyAqLywKLyogMTI0ICovLAovKiAxMjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfcHJvbWlzZSA9IF9fd2VicGFja19yZXF1aXJlX18oNzEpOwoKdmFyIF9wcm9taXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Byb21pc2UpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwOSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogQ29yZSBEaXNjb3ZlcnkgaW50ZXJmYWNlCiogQ2xhc3MgdG8gYWxsb3cgYXBwbGljYXRpb25zIHRvIHNlYXJjaCBmb3IgaHlwZXJ0aWVzIGFuZCBEYXRhT2JqZWN0cyB1c2luZyB0aGUgbWVzc2FnZSBidXMKKi8KdmFyIERpc2NvdmVyeSA9IGZ1bmN0aW9uICgpIHsKCiAgLyoqCiAgKiBUbyBpbml0aWFsaXNlIHRoZSBIeXBlcnR5RGlzY292ZXIsIHdoaWNoIHdpbGwgcHJvdmlkZSB0aGUgc3VwcG9ydCBmb3IgaHlwZXJ0aWVzIHRvCiAgKiBxdWVyeSB1c2VycyByZWdpc3RlcmVkIGluIG91dHNpZGUgdGhlIGludGVybmFsIGNvcmUuCiAgKiBAcGFyYW0gIHtNZXNzYWdlQnVzfSAgICAgICAgICBtc2didXMgICAgICAgICAgICAgICAgbXNnYnVzCiAgKiBAcGFyYW0gIHtSdW50aW1lVVJMfSAgICAgICAgICBydW50aW1lVVJMICAgICAgICAgICAgcnVudGltZVVSTAogICovCiAgZnVuY3Rpb24gRGlzY292ZXJ5KGh5cGVydHlVUkwsIG1zZ0J1cykgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGlzY292ZXJ5KTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgX3RoaXMubWVzc2FnZUJ1cyA9IG1zZ0J1czsKCiAgICBfdGhpcy5kb21haW4gPSAoMCwgX3V0aWxzLmRpdmlkZVVSTCkoaHlwZXJ0eVVSTCkuZG9tYWluOwogICAgX3RoaXMuZGlzY292ZXJ5VVJMID0gaHlwZXJ0eVVSTDsKICB9CgogIC8qKgogICogZnVuY3Rpb24gdG8gcmVxdWVzdCBhYm91dCBhbiBkYXRhT2JqZWN0IHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5IHdpdGggYSBnaXZlbiBuYW1lLCBhbmQKICAqIHJldHVybiB0aGUgZGF0YU9iamVjdCBpbmZvcm1hdGlvbiwgaWYgZm91bmQuCiAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgICBuYW1lICBkYXRhT2JqZWN0IFVSTAogICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpCiAgKiBAcmV0dXJuIHtQcm9taXNlfSAgICAgICAgICBQcm9taXNlCiAgKi8KCgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERpc2NvdmVyeSwgW3sKICAgIGtleTogJ2Rpc2NvdmVyRGF0YU9iamVjdFBlck5hbWUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2NvdmVyRGF0YU9iamVjdFBlck5hbWUobmFtZSwgZG9tYWluKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBhY3RpdmVEb21haW4gPSB2b2lkIDA7CgogICAgICBhY3RpdmVEb21haW4gPSAhZG9tYWluID8gX3RoaXMuZG9tYWluIDogZG9tYWluOwoKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICB0eXBlOiAncmVhZCcsIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCwgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluICsgJy8nLCBib2R5OiB7IHJlc291cmNlOiBuYW1lIH0KICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgogICAgICAgICAgdmFyIGRhdGFPYmplY3QgPSByZXBseS5ib2R5LnZhbHVlOwoKICAgICAgICAgIGlmIChkYXRhT2JqZWN0KSB7CiAgICAgICAgICAgIHJlc29sdmUoZGF0YU9iamVjdCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QoJ0RhdGFPYmplY3Qgbm90IGZvdW5kJyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IGRhdGFPYmplY3QgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnksIGFuZAogICAgKiByZXR1cm4gdGhlIGRhdGFPYmplY3QgaW5mb3JtYXRpb24sIGlmIGZvdW5kLgogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgICB1cmwgIGRhdGFPYmplY3QgVVJMCiAgICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKQogICAgKiBAcmV0dXJuIHtQcm9taXNlfSAgICAgICAgICBQcm9taXNlCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkaXNjb3ZlckRhdGFPYmplY3RQZXJVUkwnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2NvdmVyRGF0YU9iamVjdFBlclVSTCh1cmwsIGRvbWFpbikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgYWN0aXZlRG9tYWluID0gdm9pZCAwOwoKICAgICAgaWYgKCFkb21haW4pIHsKICAgICAgICBhY3RpdmVEb21haW4gPSBfdGhpcy5kb21haW47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWN0aXZlRG9tYWluID0gZG9tYWluOwogICAgICB9CgogICAgICB2YXIgbXNnID0gewogICAgICAgIHR5cGU6ICdyZWFkJywgZnJvbTogX3RoaXMuZGlzY292ZXJ5VVJMLCB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBhY3RpdmVEb21haW4gKyAnLycsIGJvZHk6IHsgcmVzb3VyY2U6IHVybCB9CiAgICAgIH07CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2csIGZ1bmN0aW9uIChyZXBseSkgewoKICAgICAgICAgIHZhciBkYXRhT2JqZWN0ID0gcmVwbHkuYm9keS52YWx1ZTsKCiAgICAgICAgICBpZiAoZGF0YU9iamVjdCkgewogICAgICAgICAgICByZXNvbHZlKGRhdGFPYmplY3QpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVqZWN0KCdEYXRhT2JqZWN0IG5vdCBmb3VuZCcpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICogIGZ1bmN0aW9uIHRvIGRlbGV0ZSBhbiBEYXRhIE9iamVjdCByZWdpc3RlcmVkIGluIHRoZSBEb21haW4gUmVnaXN0cnkKICAgICogIEBwYXJhbSAgIHtTdHJpbmd9ICAgICAgICAgICB1cmwgICAgICAgICAgICAgIGRhdGFPYmplY3QgdXJsCiAgICAqICBAcGFyYW0gICB7ZG9tYWlufSAgICAgICAgICAgZG9tYWluICAgICAgICAgKE9wdGlvbmFsKQogICAgKiAgQHJldHVybiAge1Byb21pc2V9ICAgICAgICAgIFByb21pc2UgICAgICAgICAgcmVzdWx0CiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkZWxldGVEYXRhT2JqZWN0JywKICAgIHZhbHVlOiBmdW5jdGlvbiBkZWxldGVEYXRhT2JqZWN0KHVybCwgZG9tYWluKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBhY3RpdmVEb21haW4gPSB2b2lkIDA7CgogICAgICBpZiAoIWRvbWFpbikgewogICAgICAgIGFjdGl2ZURvbWFpbiA9IF90aGlzLmRvbWFpbjsKICAgICAgfSBlbHNlIHsKICAgICAgICBhY3RpdmVEb21haW4gPSBkb21haW47CiAgICAgIH0KCiAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCwgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluICsgJy8nLCBib2R5OiB7IHZhbHVlOiB7IG5hbWU6IHVybCB9IH0gfTsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgogICAgICAgICAgdmFyIHJlc3BvbnNlID0gcmVwbHkuYm9keS5jb2RlOwoKICAgICAgICAgIGlmIChyZXNwb25zZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVqZWN0KCdFcnJvciBvbiBkZWxldGluZyBkYXRhT2JqZWN0Jyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IHNwZWNpZmljIHJlcG9ydGVyIGRhdGFPYmplY3QgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnksIGFuZAogICAgKiByZXR1cm4gdGhlIGRhdGFPYmplY3RzIGZyb20gdGhhdCByZXBvcnRlci4KICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgcmVwb3J0ZXIgICAgIGRhdGFPYmplY3QgcmVwb3J0ZXIKICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgZG9tYWluICAgICAgIChPcHRpb25hbCkKICAgICogQHJldHVybiB7QXJyYXl9ICAgICAgICAgICBQcm9taXNlICAgICAgIERhdGFPYmplY3RzCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkaXNjb3ZlckRhdGFPYmplY3RQZXJSZXBvcnRlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY292ZXJEYXRhT2JqZWN0UGVyUmVwb3J0ZXIocmVwb3J0ZXIsIGRvbWFpbikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgYWN0aXZlRG9tYWluID0gdm9pZCAwOwoKICAgICAgaWYgKCFkb21haW4pIHsKICAgICAgICBhY3RpdmVEb21haW4gPSBfdGhpcy5kb21haW47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWN0aXZlRG9tYWluID0gZG9tYWluOwogICAgICB9CgogICAgICB2YXIgbXNnID0gewogICAgICAgIHR5cGU6ICdyZWFkJywgZnJvbTogX3RoaXMuZGlzY292ZXJ5VVJMLCB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBhY3RpdmVEb21haW4gKyAnLycsIGJvZHk6IHsgcmVzb3VyY2U6IHJlcG9ydGVyIH0KICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgogICAgICAgICAgdmFyIGRhdGFPYmplY3RzID0gcmVwbHkuYm9keS52YWx1ZTsKCiAgICAgICAgICBpZiAoZGF0YU9iamVjdHMpIHsKICAgICAgICAgICAgcmVzb2x2ZShkYXRhT2JqZWN0cyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QoJ05vIGRhdGFPYmplY3Qgd2FzIGZvdW5kJyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKiBBZHZhbmNlZCBTZWFyY2ggZm9yIGRhdGFPYmplY3RzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5CiAgICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIHVzZXIgICAgICAgICAgICAgICAgICB1c2VyIGlkZW50aWZpZXIsIGVpdGhlciBpbiB1cmwgb3IgZW1haWwgZm9ybWF0CiAgICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHNjaGVtYSAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBkYXRhT2JqZWN0IHNjaGVtYXMKICAgICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGRhdGFPYmplY3QgcmVzb3VyY2VzCiAgICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpICAgICBkb21haW4gb2YgdGhlIHJlZ2lzdHJ5IHRvIHNlYXJjaAogICAgKi8KCiAgfSwgewogICAga2V5OiAnZGlzY292ZXJEYXRhT2JqZWN0JywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb3ZlckRhdGFPYmplY3QobmFtZSwgc2NoZW1hLCByZXNvdXJjZXMsIGRvbWFpbikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgYWN0aXZlRG9tYWluID0gdm9pZCAwOwogICAgICAvL2xldCB1c2VySWRlbnRpZmllciA9IGNvbnZlcnRUb1VzZXJVUkwodXNlcik7CgogICAgICBhY3RpdmVEb21haW4gPSAhZG9tYWluID8gX3RoaXMuZG9tYWluIDogZG9tYWluOwoKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICB0eXBlOiAncmVhZCcsIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCwgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluICsgJy8nLCBib2R5OiB7IHJlc291cmNlOiBuYW1lLAogICAgICAgICAgY3JpdGVyaWE6IHsgcmVzb3VyY2VzOiByZXNvdXJjZXMsIGRhdGFTY2hlbWVzOiBzY2hlbWEgfQogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgogICAgICAgICAgdmFyIGh5cGVydGllcyA9IHJlcGx5LmJvZHkudmFsdWU7CgogICAgICAgICAgaWYgKGh5cGVydGllcykgewogICAgICAgICAgICByZXNvbHZlKGh5cGVydGllcyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QoJ05vIERhdGFPYmplY3Qgd2FzIGZvdW5kJyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKiBBZHZhbmNlZCBTZWFyY2ggZm9yIEh5cGVydGllcyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeQogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICB1c2VyICAgICAgICAgICAgICAgICAgdXNlciBpZGVudGlmaWVyLCBlaXRoZXIgaW4gdXJsIG9yIGVtYWlsIGZvcm1hdAogICAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICBzY2hlbWEgKE9wdGlvbmFsKSAgICAgdHlwZXMgb2YgaHlwZXJ0aWVzIHNjaGVtYXMKICAgICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGh5cGVydGllcyByZXNvdXJjZXMKICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgZG9tYWluIChPcHRpb25hbCkgICAgIGRvbWFpbiBvZiB0aGUgcmVnaXN0cnkgdG8gc2VhcmNoCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkaXNjb3Zlckh5cGVydHknLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2NvdmVySHlwZXJ0eSh1c2VyLCBzY2hlbWEsIHJlc291cmNlcywgZG9tYWluKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBhY3RpdmVEb21haW4gPSB2b2lkIDA7CiAgICAgIHZhciB1c2VySWRlbnRpZmllciA9ICgwLCBfdXRpbHMuY29udmVydFRvVXNlclVSTCkodXNlcik7CgogICAgICBpZiAoIWRvbWFpbikgewogICAgICAgIGFjdGl2ZURvbWFpbiA9IF90aGlzLmRvbWFpbjsKICAgICAgfSBlbHNlIHsKICAgICAgICBhY3RpdmVEb21haW4gPSBkb21haW47CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBjb25zb2xlLmxvZygnW0Rpc2NvdmVyeS5kaXNjb3Zlckh5cGVydHldIEFDVElWRSBET01BSU4gLT4gJywgYWN0aXZlRG9tYWluLCAndXNlci0+JywgdXNlciwgJ3NjaGVtYS0+Jywgc2NoZW1hLCAncmVzb3VyY2VzLT4nLCByZXNvdXJjZXMsICdkb21haW4tPicsIGRvbWFpbik7CiAgICAgICAgaWYgKHVzZXIuaW5jbHVkZXMoJzonKSAmJiAhdXNlci5pbmNsdWRlcygndXNlcjovLycpKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW0Rpc2NvdmVyeS5kaXNjb3Zlckh5cGVydHldICcgKyB1c2VyICsgJyBpcyBsZWdhY3kgZG9tYWluJyk7CiAgICAgICAgICB2YXIgbGVnYWN5VXNlciA9IHsgdXNlcklEOiB1c2VyLCBoeXBlcnR5SUQ6IHVzZXIsIHNjaGVtYTogc2NoZW1hLCByZXNvdXJjZXM6IHJlc291cmNlcyB9OwogICAgICAgICAgcmV0dXJuIHJlc29sdmUobGVnYWN5VXNlcik7CiAgICAgICAgfQogICAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgICB0eXBlOiAncmVhZCcsIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCwgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluICsgJy8nLCBib2R5OiB7IHJlc291cmNlOiB1c2VySWRlbnRpZmllciwKICAgICAgICAgICAgY3JpdGVyaWE6IHsgcmVzb3VyY2VzOiByZXNvdXJjZXMsIGRhdGFTY2hlbWVzOiBzY2hlbWEgfQogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGNvbnNvbGUuaW5mbygnW0Rpc2NvdmVyeV0gbXNnIHRvIHNlbmQtPicsIG1zZyk7CgogICAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKCiAgICAgICAgICBjb25zb2xlLmluZm8oJ1tEaXNjb3ZlcnldIE9OIGRpc2NvdmVySHlwZXJ0eS0+JywgcmVwbHkpOwogICAgICAgICAgdmFyIGh5cGVydGllcyA9IHJlcGx5LmJvZHkudmFsdWU7CgogICAgICAgICAgaWYgKGh5cGVydGllcykgewogICAgICAgICAgICByZXNvbHZlKGh5cGVydGllcyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QoJ05vIEh5cGVydHkgd2FzIGZvdW5kJyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IHVzZXJzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5LCBhbmQKICAgICogcmV0dXJuIHRoZSBsYXN0IGh5cGVydHkgaW5zdGFuY2UgcmVnaXN0ZXJlZCBieSB0aGUgdXNlci4KICAgICogQHBhcmFtICB7ZW1haWx9ICAgICAgICAgICAgICBlbWFpbAogICAgKiBAcGFyYW0gIHtkb21haW59ICAgICAgICAgICAgZG9tYWluIChPcHRpb25hbCkKICAgICogQHJldHVybiB7UHJvbWlzZX0gICAgICAgICAgUHJvbWlzZQogICAgKi8KCiAgfSwgewogICAga2V5OiAnZGlzY292ZXJIeXBlcnR5UGVyVXNlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY292ZXJIeXBlcnR5UGVyVXNlcihlbWFpbCwgZG9tYWluKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBhY3RpdmVEb21haW4gPSB2b2lkIDA7CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgLy8gSGFjayBmb3IgbGVnYWN5IHVzZXJzCiAgICAgICAgaWYgKGVtYWlsLmluY2x1ZGVzKCc6JykgJiYgIWVtYWlsLmluY2x1ZGVzKCd1c2VyOi8vJykpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbRGlzY292ZXJ5LmRpc2NvdmVySHlwZXJ0eV0gJyArIGVtYWlsICsgJ2lzIGxlZ2FjeSBkb21haW4nKTsKICAgICAgICAgIHZhciBsZWdhY3lVc2VyID0geyBpZDogZW1haWwsIGh5cGVydHlVUkw6IGVtYWlsLCBkZXNjcmlwdG9yOiAndW5rbm93bicgfTsKICAgICAgICAgIHJldHVybiByZXNvbHZlKGxlZ2FjeVVzZXIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFkb21haW4pIHsKICAgICAgICAgIGFjdGl2ZURvbWFpbiA9IF90aGlzLmRvbWFpbjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWN0aXZlRG9tYWluID0gZG9tYWluOwogICAgICAgIH0KCiAgICAgICAgdmFyIGlkZW50aXR5VVJMID0gJ3VzZXI6Ly8nICsgZW1haWwuc3Vic3RyaW5nKGVtYWlsLmluZGV4T2YoJ0AnKSArIDEsIGVtYWlsLmxlbmd0aCkgKyAnLycgKyBlbWFpbC5zdWJzdHJpbmcoMCwgZW1haWwuaW5kZXhPZignQCcpKTsKCiAgICAgICAgLy8gbWVzc2FnZSB0byBxdWVyeSBkb21haW4gcmVnaXN0cnksIGFza2luZyBmb3IgYSB1c2VyIGh5cGVydHkuCiAgICAgICAgdmFyIG1lc3NhZ2UgPSB7CiAgICAgICAgICB0eXBlOiAncmVhZCcsIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCwgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluICsgJy8nLCBib2R5OiB7IHJlc291cmNlOiBpZGVudGl0eVVSTCB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5pbmZvKCdbRGlzY292ZXJ5XSBNZXNzYWdlOiAnLCBtZXNzYWdlLCBhY3RpdmVEb21haW4sIGlkZW50aXR5VVJMKTsKCiAgICAgICAgLy9jb25zb2xlLmluZm8oJ1tEaXNjb3ZlcnldIG1lc3NhZ2UgUkVBRCcsIG1lc3NhZ2UpOwoKICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5pbmZvKCdbRGlzY292ZXJ5XSBtZXNzYWdlIHJlcGx5JywgcmVwbHkpOwoKICAgICAgICAgIHZhciBoeXBlcnR5ID0gdm9pZCAwOwogICAgICAgICAgdmFyIG1vc3RSZWNlbnQgPSB2b2lkIDA7CiAgICAgICAgICB2YXIgbGFzdEh5cGVydHkgPSB2b2lkIDA7CiAgICAgICAgICB2YXIgdmFsdWUgPSByZXBseS5ib2R5LnZhbHVlOwoKICAgICAgICAgIGZvciAoaHlwZXJ0eSBpbiB2YWx1ZSkgewogICAgICAgICAgICBpZiAodmFsdWVbaHlwZXJ0eV0ubGFzdE1vZGlmaWVkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICBpZiAobW9zdFJlY2VudCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICBtb3N0UmVjZW50ID0gbmV3IERhdGUodmFsdWVbaHlwZXJ0eV0ubGFzdE1vZGlmaWVkKTsKICAgICAgICAgICAgICAgIGxhc3RIeXBlcnR5ID0gaHlwZXJ0eTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdmFyIGh5cGVydHlEYXRlID0gbmV3IERhdGUodmFsdWVbaHlwZXJ0eV0ubGFzdE1vZGlmaWVkKTsKICAgICAgICAgICAgICAgIGlmIChtb3N0UmVjZW50LmdldFRpbWUoKSA8IGh5cGVydHlEYXRlLmdldFRpbWUoKSkgewogICAgICAgICAgICAgICAgICBtb3N0UmVjZW50ID0gaHlwZXJ0eURhdGU7CiAgICAgICAgICAgICAgICAgIGxhc3RIeXBlcnR5ID0gaHlwZXJ0eTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBjb25zb2xlLmluZm8oJ1tEaXNjb3ZlcnldIExhc3QgSHlwZXJ0eTogJywgbGFzdEh5cGVydHksIG1vc3RSZWNlbnQpOwoKICAgICAgICAgIHZhciBoeXBlcnR5VVJMID0gbGFzdEh5cGVydHk7CgogICAgICAgICAgaWYgKGh5cGVydHlVUkwgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICByZXR1cm4gcmVqZWN0KCdVc2VyIEh5cGVydHkgbm90IGZvdW5kJyk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGlkUGFja2FnZSA9IHsKICAgICAgICAgICAgaWQ6IGVtYWlsLAogICAgICAgICAgICBkZXNjcmlwdG9yOiB2YWx1ZVtoeXBlcnR5VVJMXS5kZXNjcmlwdG9yLAogICAgICAgICAgICBoeXBlcnR5VVJMOiBoeXBlcnR5VVJMCiAgICAgICAgICB9OwoKICAgICAgICAgIGNvbnNvbGUuaW5mbygnW0Rpc2NvdmVyeV0gPT09PiBoeXBlcnR5RGlzY292ZXJ5IG1lc3NhZ2VCdW5kbGU6ICcsIGlkUGFja2FnZSk7CiAgICAgICAgICByZXNvbHZlKGlkUGFja2FnZSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IHVzZXJzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5LCBhbmQKICAgICogcmV0dXJuIHRoZSBhbGwgdGhlIGh5cGVydGllcyByZWdpc3RlcmVkIGJ5IHRoZSB1c2VyCiAgICAqIEBwYXJhbSAge2VtYWlsfSAgICAgICAgICAgICAgZW1haWwKICAgICogQHBhcmFtICB7ZG9tYWlufSAgICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpCiAgICAqIEByZXR1cm4ge1Byb21pc2V9ICAgICAgICAgIFByb21pc2UKICAgICovCgogIH0sIHsKICAgIGtleTogJ2Rpc2NvdmVySHlwZXJ0aWVzUGVyVXNlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY292ZXJIeXBlcnRpZXNQZXJVc2VyKGVtYWlsLCBkb21haW4pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGFjdGl2ZURvbWFpbiA9IHZvaWQgMDsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBpZiAoZW1haWwuaW5jbHVkZXMoJzonKSAmJiAhZW1haWwuaW5jbHVkZXMoJ3VzZXI6Ly8nKSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tEaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnR5XSBpcyBsZWdhY3kgZG9tYWluJyk7CiAgICAgICAgICB2YXIgbGVnYWN5VXNlciA9IHsgdXNlcklEOiBlbWFpbCwgaHlwZXJ0eUlEOiBlbWFpbCwgc2NoZW1hOiBzY2hlbWEsIHJlc291cmNlczogcmVzb3VyY2VzIH07CiAgICAgICAgICByZXR1cm4gcmVzb2x2ZShsZWdhY3lVc2VyKTsKICAgICAgICB9CgogICAgICAgIGlmICghZG9tYWluKSB7CiAgICAgICAgICBhY3RpdmVEb21haW4gPSBfdGhpcy5kb21haW47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFjdGl2ZURvbWFpbiA9IGRvbWFpbjsKICAgICAgICB9CgogICAgICAgIHZhciBpZGVudGl0eVVSTCA9ICd1c2VyOi8vJyArIGVtYWlsLnN1YnN0cmluZyhlbWFpbC5pbmRleE9mKCdAJykgKyAxLCBlbWFpbC5sZW5ndGgpICsgJy8nICsgZW1haWwuc3Vic3RyaW5nKDAsIGVtYWlsLmluZGV4T2YoJ0AnKSk7CgogICAgICAgIC8vIG1lc3NhZ2UgdG8gcXVlcnkgZG9tYWluIHJlZ2lzdHJ5LCBhc2tpbmcgZm9yIGEgdXNlciBoeXBlcnR5LgogICAgICAgIHZhciBtZXNzYWdlID0gewogICAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsIHRvOiAnZG9tYWluOi8vcmVnaXN0cnkuJyArIGFjdGl2ZURvbWFpbiArICcvJywgYm9keTogeyByZXNvdXJjZTogaWRlbnRpdHlVUkwgfQogICAgICAgIH07CgogICAgICAgIGNvbnNvbGUuaW5mbygnW0Rpc2NvdmVyeV0gTWVzc2FnZSBkaXNjb3Zlckh5cGVydGllc1BlclVzZXI6ICcsIG1lc3NhZ2UsIGFjdGl2ZURvbWFpbiwgaWRlbnRpdHlVUkwpOwoKICAgICAgICAvL2NvbnNvbGUuaW5mbygnW0Rpc2NvdmVyeV0gbWVzc2FnZSBSRUFEJywgbWVzc2FnZSk7CgogICAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmluZm8oJ1tEaXNjb3ZlcnldIGRpc2NvdmVySHlwZXJ0aWVzUGVyVXNlciByZXBseScsIHJlcGx5KTsKCiAgICAgICAgICB2YXIgdmFsdWUgPSByZXBseS5ib2R5LnZhbHVlOwoKICAgICAgICAgIGlmICghdmFsdWUpIHsKICAgICAgICAgICAgcmV0dXJuIHJlamVjdCgnVXNlciBIeXBlcnR5IG5vdCBmb3VuZCcpOwogICAgICAgICAgfQoKICAgICAgICAgIHJlc29sdmUodmFsdWUpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICogIGZ1bmN0aW9uIHRvIGRlbGV0ZSBhbiBoeXBlcnR5SW5zdGFuY2UgaW4gdGhlIERvbWFpbiBSZWdpc3RyeQogICAgKiAgQHBhcmFtICAge1N0cmluZ30gICAgICAgICAgIHVzZXIgICAgICAgICAgICAgIHVzZXIgdXJsCiAgICAqICBAcGFyYW0gICB7U3RyaW5nfSAgICAgICAgICAgaHlwZXJ0eUluc3RhbmNlICAgSHlwZXJ0eUluc250YW5jZSB1cmwKICAgICogIEBwYXJhbSAgIHtkb21haW59ICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKQogICAgKiAgQHJldHVybiAge1Byb21pc2V9ICAgICAgICAgIFByb21pc2UgICAgICAgICAgcmVzdWx0CiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkZWxldGVIeXBlcnR5JywKICAgIHZhbHVlOiBmdW5jdGlvbiBkZWxldGVIeXBlcnR5KHVzZXIsIGh5cGVydHlJbnN0YW5jZSwgZG9tYWluKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBhY3RpdmVEb21haW4gPSB2b2lkIDA7CgogICAgICBpZiAoIWRvbWFpbikgewogICAgICAgIGFjdGl2ZURvbWFpbiA9IF90aGlzLmRvbWFpbjsKICAgICAgfSBlbHNlIHsKICAgICAgICBhY3RpdmVEb21haW4gPSBkb21haW47CiAgICAgIH0KCiAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCwgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluICsgJy8nLCBib2R5OiB7IHZhbHVlOiB7IHVzZXI6IHVzZXIsIHVybDogaHlwZXJ0eUluc3RhbmNlIH0gfSB9OwoKICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKCiAgICAgICAgICB2YXIgcmVzcG9uc2UgPSByZXBseS5ib2R5LmNvZGU7CgogICAgICAgICAgaWYgKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIHJlc29sdmUoJ0h5cGVydHkgc3VjY2Vzc2Z1bGx5IGRlbGV0ZWQnKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlamVjdCgnRXJyb3Igb24gZGVsZXRpbmcgaHlwZXJ0eScpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERpc2NvdmVyeTsKfSgpOyAvKioKICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICoKICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgKgogICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAqCiAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IERpc2NvdmVyeTsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTI2ICovLAovKiAxMjcgKi8sCi8qIDEyOCAqLywKLyogMTI5ICovLAovKiAxMzAgKi8sCi8qIDEzMSAqLywKLyogMTMyICovLAovKiAxMzMgKi8sCi8qIDEzNCAqLywKLyogMTM1ICovLAovKiAxMzYgKi8sCi8qIDEzNyAqLywKLyogMTM4ICovLAovKiAxMzkgKi8sCi8qIDE0MCAqLywKLyogMTQxICovLAovKiAxNDIgKi8sCi8qIDE0MyAqLywKLyogMTQ0ICovLAovKiAxNDUgKi8sCi8qIDE0NiAqLywKLyogMTQ3ICovLAovKiAxNDggKi8sCi8qIDE0OSAqLywKLyogMTUwICovLAovKiAxNTEgKi8sCi8qIDE1MiAqLywKLyogMTUzICovLAovKiAxNTQgKi8sCi8qIDE1NSAqLywKLyogMTU2ICovLAovKiAxNTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfRGlzY292ZXJ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjUpOwoKdmFyIF9EaXNjb3ZlcnkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGlzY292ZXJ5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLmRlZmF1bHQgPSBfRGlzY292ZXJ5Mi5kZWZhdWx0Owptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pCi8qKioqKiovIF0pOwp9KTsKCn0se31dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovLyB2ZXJzaW9uOiAwLjUuMQovLyBkYXRlOiBUdWUgRmViIDA3IDIwMTcgMTY6MDA6MzkgR01UKzAwMDAgKFdFVCkKLy8gbGljZW5jZTogCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwoKCihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7CglpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpCgkJbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7CgllbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkKCQlkZWZpbmUoIlN5bmNoZXIiLCBbXSwgZmFjdG9yeSk7CgllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JykKCQlleHBvcnRzWyJTeW5jaGVyIl0gPSBmYWN0b3J5KCk7CgllbHNlCgkJcm9vdFsiIl0gPSByb290WyIiXSB8fCB7fSwgcm9vdFsiIl1bIlN5bmNoZXIiXSA9IGZhY3RvcnkoKTsKfSkodGhpcywgZnVuY3Rpb24oKSB7CnJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwovKioqKioqLwovKioqKioqLyAJLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb24KLyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCWk6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsOiBmYWxzZSwKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLwovKioqKioqLyAJCS8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbgovKioqKioqLyAJCW1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pOwovKioqKioqLwovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubCA9IHRydWU7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9Ci8qKioqKiovCi8qKioqKiovCi8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKQovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlczsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gaWRlbnRpdHkgZnVuY3Rpb24gZm9yIGNhbGxpbmcgaGFybW9ueSBpbXBvcnRzIHdpdGggdGhlIGNvcnJlY3QgY29udGV4dAovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5pID0gZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9OwovKioqKioqLwovKioqKioqLyAJLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHsKLyoqKioqKi8gCQlpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7Ci8qKioqKiovIAkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7Ci8qKioqKiovIAkJCQljb25maWd1cmFibGU6IGZhbHNlLAovKioqKioqLyAJCQkJZW51bWVyYWJsZTogdHJ1ZSwKLyoqKioqKi8gCQkJCWdldDogZ2V0dGVyCi8qKioqKiovIAkJCX0pOwovKioqKioqLyAJCX0KLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlcwovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7Ci8qKioqKiovIAkJdmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/Ci8qKioqKiovIAkJCWZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6Ci8qKioqKiovIAkJCWZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07Ci8qKioqKiovIAkJX193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpOwovKioqKioqLyAJCXJldHVybiBnZXR0ZXI7Ci8qKioqKiovIAl9OwovKioqKioqLwovKioqKioqLyAJLy8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfXwovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gIiI7Ci8qKioqKiovCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDE2Mik7Ci8qKioqKiovIH0pCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIChbCi8qIDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGNvcmUgPSBtb2R1bGUuZXhwb3J0cyA9IHt2ZXJzaW9uOiAnMi40LjAnfTsKaWYodHlwZW9mIF9fZSA9PSAnbnVtYmVyJylfX2UgPSBjb3JlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmCgovKioqLyB9KSwKLyogMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOAp2YXIgZ2xvYmFsID0gbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdy5NYXRoID09IE1hdGgKICA/IHdpbmRvdyA6IHR5cGVvZiBzZWxmICE9ICd1bmRlZmluZWQnICYmIHNlbGYuTWF0aCA9PSBNYXRoID8gc2VsZiA6IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7CmlmKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmCgovKioqLyB9KSwKLyogMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgc3RvcmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzApKCd3a3MnKQogICwgdWlkICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpCiAgLCBTeW1ib2wgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5TeW1ib2wKICAsIFVTRV9TWU1CT0wgPSB0eXBlb2YgU3ltYm9sID09ICdmdW5jdGlvbic7Cgp2YXIgJGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewogIHJldHVybiBzdG9yZVtuYW1lXSB8fCAoc3RvcmVbbmFtZV0gPQogICAgVVNFX1NZTUJPTCAmJiBTeW1ib2xbbmFtZV0gfHwgKFVTRV9TWU1CT0wgPyBTeW1ib2wgOiB1aWQpKCdTeW1ib2wuJyArIG5hbWUpKTsKfTsKCiRleHBvcnRzLnN0b3JlID0gc3RvcmU7CgovKioqLyB9KSwKLyogMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBUaGFuaydzIElFOCBmb3IgaGlzIGZ1bm55IGRlZmluZVByb3BlcnR5Cm1vZHVsZS5leHBvcnRzID0gIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ2EnLCB7Z2V0OiBmdW5jdGlvbigpeyByZXR1cm4gNzsgfX0pLmEgIT0gNzsKfSk7CgovKioqLyB9KSwKLyogNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgYW5PYmplY3QgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBJRThfRE9NX0RFRklORSA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpCiAgLCB0b1ByaW1pdGl2ZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjIpCiAgLCBkUCAgICAgICAgICAgICA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTsKCmV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBPYmplY3QuZGVmaW5lUHJvcGVydHkgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKXsKICBhbk9iamVjdChPKTsKICBQID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSk7CiAgYW5PYmplY3QoQXR0cmlidXRlcyk7CiAgaWYoSUU4X0RPTV9ERUZJTkUpdHJ5IHsKICAgIHJldHVybiBkUChPLCBQLCBBdHRyaWJ1dGVzKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgaWYoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKXRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhJyk7CiAgaWYoJ3ZhbHVlJyBpbiBBdHRyaWJ1dGVzKU9bUF0gPSBBdHRyaWJ1dGVzLnZhbHVlOwogIHJldHVybiBPOwp9OwoKLyoqKi8gfSksCi8qIDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYoIWlzT2JqZWN0KGl0KSl0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhbiBvYmplY3QhJyk7CiAgcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRQICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBjcmVhdGVEZXNjID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNik7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSA/IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7CiAgcmV0dXJuIGRQLmYob2JqZWN0LCBrZXksIGNyZWF0ZURlc2MoMSwgdmFsdWUpKTsKfSA6IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7CiAgb2JqZWN0W2tleV0gPSB2YWx1ZTsKICByZXR1cm4gb2JqZWN0Owp9OwoKLyoqKi8gfSksCi8qIDcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIHR5cGVvZiBpdCA9PT0gJ29iamVjdCcgPyBpdCAhPT0gbnVsbCA6IHR5cGVvZiBpdCA9PT0gJ2Z1bmN0aW9uJzsKfTsKCi8qKiovIH0pLAovKiA4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBjdHggICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgaGlkZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7Cgp2YXIgJGV4cG9ydCA9IGZ1bmN0aW9uKHR5cGUsIG5hbWUsIHNvdXJjZSl7CiAgdmFyIElTX0ZPUkNFRCA9IHR5cGUgJiAkZXhwb3J0LkYKICAgICwgSVNfR0xPQkFMID0gdHlwZSAmICRleHBvcnQuRwogICAgLCBJU19TVEFUSUMgPSB0eXBlICYgJGV4cG9ydC5TCiAgICAsIElTX1BST1RPICA9IHR5cGUgJiAkZXhwb3J0LlAKICAgICwgSVNfQklORCAgID0gdHlwZSAmICRleHBvcnQuQgogICAgLCBJU19XUkFQICAgPSB0eXBlICYgJGV4cG9ydC5XCiAgICAsIGV4cG9ydHMgICA9IElTX0dMT0JBTCA/IGNvcmUgOiBjb3JlW25hbWVdIHx8IChjb3JlW25hbWVdID0ge30pCiAgICAsIGV4cFByb3RvICA9IGV4cG9ydHNbUFJPVE9UWVBFXQogICAgLCB0YXJnZXQgICAgPSBJU19HTE9CQUwgPyBnbG9iYWwgOiBJU19TVEFUSUMgPyBnbG9iYWxbbmFtZV0gOiAoZ2xvYmFsW25hbWVdIHx8IHt9KVtQUk9UT1RZUEVdCiAgICAsIGtleSwgb3duLCBvdXQ7CiAgaWYoSVNfR0xPQkFMKXNvdXJjZSA9IG5hbWU7CiAgZm9yKGtleSBpbiBzb3VyY2UpewogICAgLy8gY29udGFpbnMgaW4gbmF0aXZlCiAgICBvd24gPSAhSVNfRk9SQ0VEICYmIHRhcmdldCAmJiB0YXJnZXRba2V5XSAhPT0gdW5kZWZpbmVkOwogICAgaWYob3duICYmIGtleSBpbiBleHBvcnRzKWNvbnRpbnVlOwogICAgLy8gZXhwb3J0IG5hdGl2ZSBvciBwYXNzZWQKICAgIG91dCA9IG93biA/IHRhcmdldFtrZXldIDogc291cmNlW2tleV07CiAgICAvLyBwcmV2ZW50IGdsb2JhbCBwb2xsdXRpb24gZm9yIG5hbWVzcGFjZXMKICAgIGV4cG9ydHNba2V5XSA9IElTX0dMT0JBTCAmJiB0eXBlb2YgdGFyZ2V0W2tleV0gIT0gJ2Z1bmN0aW9uJyA/IHNvdXJjZVtrZXldCiAgICAvLyBiaW5kIHRpbWVycyB0byBnbG9iYWwgZm9yIGNhbGwgZnJvbSBleHBvcnQgY29udGV4dAogICAgOiBJU19CSU5EICYmIG93biA/IGN0eChvdXQsIGdsb2JhbCkKICAgIC8vIHdyYXAgZ2xvYmFsIGNvbnN0cnVjdG9ycyBmb3IgcHJldmVudCBjaGFuZ2UgdGhlbSBpbiBsaWJyYXJ5CiAgICA6IElTX1dSQVAgJiYgdGFyZ2V0W2tleV0gPT0gb3V0ID8gKGZ1bmN0aW9uKEMpewogICAgICB2YXIgRiA9IGZ1bmN0aW9uKGEsIGIsIGMpewogICAgICAgIGlmKHRoaXMgaW5zdGFuY2VvZiBDKXsKICAgICAgICAgIHN3aXRjaChhcmd1bWVudHMubGVuZ3RoKXsKICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gbmV3IEM7CiAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIG5ldyBDKGEpOwogICAgICAgICAgICBjYXNlIDI6IHJldHVybiBuZXcgQyhhLCBiKTsKICAgICAgICAgIH0gcmV0dXJuIG5ldyBDKGEsIGIsIGMpOwogICAgICAgIH0gcmV0dXJuIEMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgICAgRltQUk9UT1RZUEVdID0gQ1tQUk9UT1RZUEVdOwogICAgICByZXR1cm4gRjsKICAgIC8vIG1ha2Ugc3RhdGljIHZlcnNpb25zIGZvciBwcm90b3R5cGUgbWV0aG9kcwogICAgfSkob3V0KSA6IElTX1BST1RPICYmIHR5cGVvZiBvdXQgPT0gJ2Z1bmN0aW9uJyA/IGN0eChGdW5jdGlvbi5jYWxsLCBvdXQpIDogb3V0OwogICAgLy8gZXhwb3J0IHByb3RvIG1ldGhvZHMgdG8gY29yZS4lQ09OU1RSVUNUT1IlLm1ldGhvZHMuJU5BTUUlCiAgICBpZihJU19QUk9UTyl7CiAgICAgIChleHBvcnRzLnZpcnR1YWwgfHwgKGV4cG9ydHMudmlydHVhbCA9IHt9KSlba2V5XSA9IG91dDsKICAgICAgLy8gZXhwb3J0IHByb3RvIG1ldGhvZHMgdG8gY29yZS4lQ09OU1RSVUNUT1IlLnByb3RvdHlwZS4lTkFNRSUKICAgICAgaWYodHlwZSAmICRleHBvcnQuUiAmJiBleHBQcm90byAmJiAhZXhwUHJvdG9ba2V5XSloaWRlKGV4cFByb3RvLCBrZXksIG91dCk7CiAgICB9CiAgfQp9OwovLyB0eXBlIGJpdG1hcAokZXhwb3J0LkYgPSAxOyAgIC8vIGZvcmNlZAokZXhwb3J0LkcgPSAyOyAgIC8vIGdsb2JhbAokZXhwb3J0LlMgPSA0OyAgIC8vIHN0YXRpYwokZXhwb3J0LlAgPSA4OyAgIC8vIHByb3RvCiRleHBvcnQuQiA9IDE2OyAgLy8gYmluZAokZXhwb3J0LlcgPSAzMjsgIC8vIHdyYXAKJGV4cG9ydC5VID0gNjQ7ICAvLyBzYWZlCiRleHBvcnQuUiA9IDEyODsgLy8gcmVhbCBwcm90byBtZXRob2QgZm9yIGBsaWJyYXJ5YCAKbW9kdWxlLmV4cG9ydHMgPSAkZXhwb3J0OwoKLyoqKi8gfSksCi8qIDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfTsKCi8qKiovIH0pLAovKiAxMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfZGVmaW5lUHJvcGVydHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM2KTsKCnZhciBfZGVmaW5lUHJvcGVydHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVmaW5lUHJvcGVydHkpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgICAoMCwgX2RlZmluZVByb3BlcnR5Mi5kZWZhdWx0KSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICAgIH0KICB9CgogIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgICBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogICAgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgICByZXR1cm4gQ29uc3RydWN0b3I7CiAgfTsKfSgpOwoKLyoqKi8gfSksCi8qIDExICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYyl7CiAgdHJ5IHsKICAgIHJldHVybiAhIWV4ZWMoKTsKICB9IGNhdGNoKGUpewogICAgcmV0dXJuIHRydWU7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDEyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciBoYXNPd25Qcm9wZXJ0eSA9IHt9Lmhhc093blByb3BlcnR5Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBrZXkpewogIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGl0LCBrZXkpOwp9OwoKLyoqKi8gfSksCi8qIDEzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIHRvIGluZGV4ZWQgb2JqZWN0LCB0b09iamVjdCB3aXRoIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgc3RyaW5ncwp2YXIgSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpCiAgLCBkZWZpbmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBJT2JqZWN0KGRlZmluZWQoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAxNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBvcHRpb25hbCAvIHNpbXBsZSBjb250ZXh0IGJpbmRpbmcKdmFyIGFGdW5jdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCB0aGF0LCBsZW5ndGgpewogIGFGdW5jdGlvbihmbik7CiAgaWYodGhhdCA9PT0gdW5kZWZpbmVkKXJldHVybiBmbjsKICBzd2l0Y2gobGVuZ3RoKXsKICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uKGEpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhKTsKICAgIH07CiAgICBjYXNlIDI6IHJldHVybiBmdW5jdGlvbihhLCBiKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYik7CiAgICB9OwogICAgY2FzZSAzOiByZXR1cm4gZnVuY3Rpb24oYSwgYiwgYyl7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIsIGMpOwogICAgfTsKICB9CiAgcmV0dXJuIGZ1bmN0aW9uKC8qIC4uLmFyZ3MgKi8pewogICAgcmV0dXJuIGZuLmFwcGx5KHRoYXQsIGFyZ3VtZW50cyk7CiAgfTsKfTsKCi8qKiovIH0pLAovKiAxNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHt9OwoKLyoqKi8gfSksCi8qIDE2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYml0bWFwLCB2YWx1ZSl7CiAgcmV0dXJuIHsKICAgIGVudW1lcmFibGUgIDogIShiaXRtYXAgJiAxKSwKICAgIGNvbmZpZ3VyYWJsZTogIShiaXRtYXAgJiAyKSwKICAgIHdyaXRhYmxlICAgIDogIShiaXRtYXAgJiA0KSwKICAgIHZhbHVlICAgICAgIDogdmFsdWUKICB9Owp9OwoKLyoqKi8gfSksCi8qIDE3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4xNCAvIDE1LjIuMy4xNCBPYmplY3Qua2V5cyhPKQp2YXIgJGtleXMgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ0KQogICwgZW51bUJ1Z0tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KTsKCm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24ga2V5cyhPKXsKICByZXR1cm4gJGtleXMoTywgZW51bUJ1Z0tleXMpOwp9OwoKLyoqKi8gfSksCi8qIDE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwoaXQpLnNsaWNlKDgsIC0xKTsKfTsKCi8qKiovIH0pLAovKiAxOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBkb2N1bWVudCA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZG9jdW1lbnQKICAvLyBpbiBvbGQgSUUgdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgaXMgJ29iamVjdCcKICAsIGlzID0gaXNPYmplY3QoZG9jdW1lbnQpICYmIGlzT2JqZWN0KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXMgPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGl0KSA6IHt9Owp9OwoKLyoqKi8gfSksCi8qIDIwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIGlmKHR5cGVvZiBpdCAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGEgZnVuY3Rpb24hJyk7CiAgcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDIxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBkZWYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmYKICAsIGhhcyA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBUQUcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCd0b1N0cmluZ1RhZycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgdGFnLCBzdGF0KXsKICBpZihpdCAmJiAhaGFzKGl0ID0gc3RhdCA/IGl0IDogaXQucHJvdG90eXBlLCBUQUcpKWRlZihpdCwgVEFHLCB7Y29uZmlndXJhYmxlOiB0cnVlLCB2YWx1ZTogdGFnfSk7Cn07CgovKioqLyB9KSwKLyogMjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjEgVG9QcmltaXRpdmUoaW5wdXQgWywgUHJlZmVycmVkVHlwZV0pCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7Ci8vIGluc3RlYWQgb2YgdGhlIEVTNiBzcGVjIHZlcnNpb24sIHdlIGRpZG4ndCBpbXBsZW1lbnQgQEB0b1ByaW1pdGl2ZSBjYXNlCi8vIGFuZCB0aGUgc2Vjb25kIGFyZ3VtZW50IC0gZmxhZyAtIHByZWZlcnJlZCB0eXBlIGlzIGEgc3RyaW5nCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIFMpewogIGlmKCFpc09iamVjdChpdCkpcmV0dXJuIGl0OwogIHZhciBmbiwgdmFsOwogIGlmKFMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICBpZih0eXBlb2YgKGZuID0gaXQudmFsdWVPZikgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKXJldHVybiB2YWw7CiAgaWYoIVMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpOwp9OwoKLyoqKi8gfSksCi8qIDIzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciBpZCA9IDAKICAsIHB4ID0gTWF0aC5yYW5kb20oKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiAnU3ltYm9sKCcuY29uY2F0KGtleSA9PT0gdW5kZWZpbmVkID8gJycgOiBrZXksICcpXycsICgrK2lkICsgcHgpLnRvU3RyaW5nKDM2KSk7Cn07CgovKioqLyB9KSwKLyogMjQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudCkKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYoaXQgPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gICIgKyBpdCk7CiAgcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDI1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gdHJ1ZTsKCi8qKiovIH0pLAovKiAyNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgc2hhcmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ2tleXMnKQogICwgdWlkICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsKICByZXR1cm4gc2hhcmVkW2tleV0gfHwgKHNoYXJlZFtrZXldID0gdWlkKGtleSkpOwp9OwoKLyoqKi8gfSksCi8qIDI3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIDcuMS40IFRvSW50ZWdlcgp2YXIgY2VpbCAgPSBNYXRoLmNlaWwKICAsIGZsb29yID0gTWF0aC5mbG9vcjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGlzTmFOKGl0ID0gK2l0KSA/IDAgOiAoaXQgPiAwID8gZmxvb3IgOiBjZWlsKShpdCk7Cn07CgovKioqLyB9KSwKLyogMjggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gSUUgOC0gZG9uJ3QgZW51bSBidWcga2V5cwptb2R1bGUuZXhwb3J0cyA9ICgKICAnY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mJwopLnNwbGl0KCcsJyk7CgovKioqLyB9KSwKLyogMjkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygzKSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KF9fd2VicGFja19yZXF1aXJlX18oMTkpKCdkaXYnKSwgJ2EnLCB7Z2V0OiBmdW5jdGlvbigpeyByZXR1cm4gNzsgfX0pLmEgIT0gNzsKfSk7CgovKioqLyB9KSwKLyogMzAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIFNIQVJFRCA9ICdfX2NvcmUtanNfc2hhcmVkX18nCiAgLCBzdG9yZSAgPSBnbG9iYWxbU0hBUkVEXSB8fCAoZ2xvYmFsW1NIQVJFRF0gPSB7fSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsKICByZXR1cm4gc3RvcmVba2V5XSB8fCAoc3RvcmVba2V5XSA9IHt9KTsKfTsKCi8qKiovIH0pLAovKiAzMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDc5KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDMyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDcuMS4xMyBUb09iamVjdChhcmd1bWVudCkKdmFyIGRlZmluZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIE9iamVjdChkZWZpbmVkKGl0KSk7Cn07CgovKioqLyB9KSwKLyogMzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX3NldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3NSk7Cgp2YXIgX3NldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NldFByb3RvdHlwZU9mKTsKCnZhciBfY3JlYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3NCk7Cgp2YXIgX2NyZWF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGUpOwoKdmFyIF90eXBlb2YyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OSk7Cgp2YXIgX3R5cGVvZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90eXBlb2YyKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAiICsgKHR5cGVvZiBzdXBlckNsYXNzID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogKDAsIF90eXBlb2YzLmRlZmF1bHQpKHN1cGVyQ2xhc3MpKSk7CiAgfQoKICBzdWJDbGFzcy5wcm90b3R5cGUgPSAoMCwgX2NyZWF0ZTIuZGVmYXVsdCkoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgewogICAgY29uc3RydWN0b3I6IHsKICAgICAgdmFsdWU6IHN1YkNsYXNzLAogICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgfQogIH0pOwogIGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2YyLmRlZmF1bHQgPyAoMCwgX3NldFByb3RvdHlwZU9mMi5kZWZhdWx0KShzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOwp9OwoKLyoqKi8gfSksCi8qIDM0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF90eXBlb2YyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OSk7Cgp2YXIgX3R5cGVvZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90eXBlb2YyKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoc2VsZiwgY2FsbCkgewogIGlmICghc2VsZikgewogICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKICB9CgogIHJldHVybiBjYWxsICYmICgodHlwZW9mIGNhbGwgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoY2FsbCkpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikgPyBjYWxsIDogc2VsZjsKfTsKCi8qKiovIH0pLAovKiAzNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKdmFyIGFuT2JqZWN0ICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQogICwgZFBzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY0KQogICwgZW51bUJ1Z0tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KQogICwgSUVfUFJPVE8gICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KSgnSUVfUFJPVE8nKQogICwgRW1wdHkgICAgICAgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9CiAgLCBQUk9UT1RZUEUgICA9ICdwcm90b3R5cGUnOwoKLy8gQ3JlYXRlIG9iamVjdCB3aXRoIGZha2UgYG51bGxgIHByb3RvdHlwZTogdXNlIGlmcmFtZSBPYmplY3Qgd2l0aCBjbGVhcmVkIHByb3RvdHlwZQp2YXIgY3JlYXRlRGljdCA9IGZ1bmN0aW9uKCl7CiAgLy8gVGhyYXNoLCB3YXN0ZSBhbmQgc29kb215OiBJRSBHQyBidWcKICB2YXIgaWZyYW1lID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSkoJ2lmcmFtZScpCiAgICAsIGkgICAgICA9IGVudW1CdWdLZXlzLmxlbmd0aAogICAgLCBsdCAgICAgPSAnPCcKICAgICwgZ3QgICAgID0gJz4nCiAgICAsIGlmcmFtZURvY3VtZW50OwogIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogIF9fd2VicGFja19yZXF1aXJlX18oNDIpLmFwcGVuZENoaWxkKGlmcmFtZSk7CiAgaWZyYW1lLnNyYyA9ICdqYXZhc2NyaXB0Oic7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2NyaXB0LXVybAogIC8vIGNyZWF0ZURpY3QgPSBpZnJhbWUuY29udGVudFdpbmRvdy5PYmplY3Q7CiAgLy8gaHRtbC5yZW1vdmVDaGlsZChpZnJhbWUpOwogIGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7CiAgaWZyYW1lRG9jdW1lbnQub3BlbigpOwogIGlmcmFtZURvY3VtZW50LndyaXRlKGx0ICsgJ3NjcmlwdCcgKyBndCArICdkb2N1bWVudC5GPU9iamVjdCcgKyBsdCArICcvc2NyaXB0JyArIGd0KTsKICBpZnJhbWVEb2N1bWVudC5jbG9zZSgpOwogIGNyZWF0ZURpY3QgPSBpZnJhbWVEb2N1bWVudC5GOwogIHdoaWxlKGktLSlkZWxldGUgY3JlYXRlRGljdFtQUk9UT1RZUEVdW2VudW1CdWdLZXlzW2ldXTsKICByZXR1cm4gY3JlYXRlRGljdCgpOwp9OwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuY3JlYXRlIHx8IGZ1bmN0aW9uIGNyZWF0ZShPLCBQcm9wZXJ0aWVzKXsKICB2YXIgcmVzdWx0OwogIGlmKE8gIT09IG51bGwpewogICAgRW1wdHlbUFJPVE9UWVBFXSA9IGFuT2JqZWN0KE8pOwogICAgcmVzdWx0ID0gbmV3IEVtcHR5OwogICAgRW1wdHlbUFJPVE9UWVBFXSA9IG51bGw7CiAgICAvLyBhZGQgIl9fcHJvdG9fXyIgZm9yIE9iamVjdC5nZXRQcm90b3R5cGVPZiBwb2x5ZmlsbAogICAgcmVzdWx0W0lFX1BST1RPXSA9IE87CiAgfSBlbHNlIHJlc3VsdCA9IGNyZWF0ZURpY3QoKTsKICByZXR1cm4gUHJvcGVydGllcyA9PT0gdW5kZWZpbmVkID8gcmVzdWx0IDogZFBzKHJlc3VsdCwgUHJvcGVydGllcyk7Cn07CgoKLyoqKi8gfSksCi8qIDM2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oMzcpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogMzcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygzOSk7CnZhciAkT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Q7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyl7CiAgcmV0dXJuICRPYmplY3QuZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyk7Cn07CgovKioqLyB9KSwKLyogMzggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIExJQlJBUlkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKICAsICRleHBvcnQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KQogICwgcmVkZWZpbmUgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ2KQogICwgaGlkZSAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCiAgLCBoYXMgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBJdGVyYXRvcnMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCAkaXRlckNyZWF0ZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjIpCiAgLCBzZXRUb1N0cmluZ1RhZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpCiAgLCBnZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oNDMpCiAgLCBJVEVSQVRPUiAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJykKICAsIEJVR0dZICAgICAgICAgID0gIShbXS5rZXlzICYmICduZXh0JyBpbiBbXS5rZXlzKCkpIC8vIFNhZmFyaSBoYXMgYnVnZ3kgaXRlcmF0b3JzIHcvbyBgbmV4dGAKICAsIEZGX0lURVJBVE9SICAgID0gJ0BAaXRlcmF0b3InCiAgLCBLRVlTICAgICAgICAgICA9ICdrZXlzJwogICwgVkFMVUVTICAgICAgICAgPSAndmFsdWVzJzsKCnZhciByZXR1cm5UaGlzID0gZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH07Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEJhc2UsIE5BTUUsIENvbnN0cnVjdG9yLCBuZXh0LCBERUZBVUxULCBJU19TRVQsIEZPUkNFRCl7CiAgJGl0ZXJDcmVhdGUoQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpOwogIHZhciBnZXRNZXRob2QgPSBmdW5jdGlvbihraW5kKXsKICAgIGlmKCFCVUdHWSAmJiBraW5kIGluIHByb3RvKXJldHVybiBwcm90b1traW5kXTsKICAgIHN3aXRjaChraW5kKXsKICAgICAgY2FzZSBLRVlTOiByZXR1cm4gZnVuY3Rpb24ga2V5cygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9OwogICAgICBjYXNlIFZBTFVFUzogcmV0dXJuIGZ1bmN0aW9uIHZhbHVlcygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9OwogICAgfSByZXR1cm4gZnVuY3Rpb24gZW50cmllcygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9OwogIH07CiAgdmFyIFRBRyAgICAgICAgPSBOQU1FICsgJyBJdGVyYXRvcicKICAgICwgREVGX1ZBTFVFUyA9IERFRkFVTFQgPT0gVkFMVUVTCiAgICAsIFZBTFVFU19CVUcgPSBmYWxzZQogICAgLCBwcm90byAgICAgID0gQmFzZS5wcm90b3R5cGUKICAgICwgJG5hdGl2ZSAgICA9IHByb3RvW0lURVJBVE9SXSB8fCBwcm90b1tGRl9JVEVSQVRPUl0gfHwgREVGQVVMVCAmJiBwcm90b1tERUZBVUxUXQogICAgLCAkZGVmYXVsdCAgID0gJG5hdGl2ZSB8fCBnZXRNZXRob2QoREVGQVVMVCkKICAgICwgJGVudHJpZXMgICA9IERFRkFVTFQgPyAhREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKCdlbnRyaWVzJykgOiB1bmRlZmluZWQKICAgICwgJGFueU5hdGl2ZSA9IE5BTUUgPT0gJ0FycmF5JyA/IHByb3RvLmVudHJpZXMgfHwgJG5hdGl2ZSA6ICRuYXRpdmUKICAgICwgbWV0aG9kcywga2V5LCBJdGVyYXRvclByb3RvdHlwZTsKICAvLyBGaXggbmF0aXZlCiAgaWYoJGFueU5hdGl2ZSl7CiAgICBJdGVyYXRvclByb3RvdHlwZSA9IGdldFByb3RvdHlwZU9mKCRhbnlOYXRpdmUuY2FsbChuZXcgQmFzZSkpOwogICAgaWYoSXRlcmF0b3JQcm90b3R5cGUgIT09IE9iamVjdC5wcm90b3R5cGUpewogICAgICAvLyBTZXQgQEB0b1N0cmluZ1RhZyB0byBuYXRpdmUgaXRlcmF0b3JzCiAgICAgIHNldFRvU3RyaW5nVGFnKEl0ZXJhdG9yUHJvdG90eXBlLCBUQUcsIHRydWUpOwogICAgICAvLyBmaXggZm9yIHNvbWUgb2xkIGVuZ2luZXMKICAgICAgaWYoIUxJQlJBUlkgJiYgIWhhcyhJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IpKWhpZGUoSXRlcmF0b3JQcm90b3R5cGUsIElURVJBVE9SLCByZXR1cm5UaGlzKTsKICAgIH0KICB9CiAgLy8gZml4IEFycmF5I3t2YWx1ZXMsIEBAaXRlcmF0b3J9Lm5hbWUgaW4gVjggLyBGRgogIGlmKERFRl9WQUxVRVMgJiYgJG5hdGl2ZSAmJiAkbmF0aXZlLm5hbWUgIT09IFZBTFVFUyl7CiAgICBWQUxVRVNfQlVHID0gdHJ1ZTsKICAgICRkZWZhdWx0ID0gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiAkbmF0aXZlLmNhbGwodGhpcyk7IH07CiAgfQogIC8vIERlZmluZSBpdGVyYXRvcgogIGlmKCghTElCUkFSWSB8fCBGT1JDRUQpICYmIChCVUdHWSB8fCBWQUxVRVNfQlVHIHx8ICFwcm90b1tJVEVSQVRPUl0pKXsKICAgIGhpZGUocHJvdG8sIElURVJBVE9SLCAkZGVmYXVsdCk7CiAgfQogIC8vIFBsdWcgZm9yIGxpYnJhcnkKICBJdGVyYXRvcnNbTkFNRV0gPSAkZGVmYXVsdDsKICBJdGVyYXRvcnNbVEFHXSAgPSByZXR1cm5UaGlzOwogIGlmKERFRkFVTFQpewogICAgbWV0aG9kcyA9IHsKICAgICAgdmFsdWVzOiAgREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKFZBTFVFUyksCiAgICAgIGtleXM6ICAgIElTX1NFVCAgICAgPyAkZGVmYXVsdCA6IGdldE1ldGhvZChLRVlTKSwKICAgICAgZW50cmllczogJGVudHJpZXMKICAgIH07CiAgICBpZihGT1JDRUQpZm9yKGtleSBpbiBtZXRob2RzKXsKICAgICAgaWYoIShrZXkgaW4gcHJvdG8pKXJlZGVmaW5lKHByb3RvLCBrZXksIG1ldGhvZHNba2V5XSk7CiAgICB9IGVsc2UgJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAoQlVHR1kgfHwgVkFMVUVTX0JVRyksIE5BTUUsIG1ldGhvZHMpOwogIH0KICByZXR1cm4gbWV0aG9kczsKfTsKCi8qKiovIH0pLAovKiAzOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7Ci8vIDE5LjEuMi40IC8gMTUuMi4zLjYgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIV9fd2VicGFja19yZXF1aXJlX18oMyksICdPYmplY3QnLCB7ZGVmaW5lUHJvcGVydHk6IF9fd2VicGFja19yZXF1aXJlX18oNCkuZn0pOwoKLyoqKi8gfSksCi8qIDQwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNTMpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNDEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKZXhwb3J0cy5mID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7CgovKioqLyB9KSwKLyogNDIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLmRvY3VtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCi8qKiovIH0pLAovKiA0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuOSAvIDE1LjIuMy4yIE9iamVjdC5nZXRQcm90b3R5cGVPZihPKQp2YXIgaGFzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQogICwgdG9PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgSUVfUFJPVE8gICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KSgnSUVfUFJPVE8nKQogICwgT2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlOwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24oTyl7CiAgTyA9IHRvT2JqZWN0KE8pOwogIGlmKGhhcyhPLCBJRV9QUk9UTykpcmV0dXJuIE9bSUVfUFJPVE9dOwogIGlmKHR5cGVvZiBPLmNvbnN0cnVjdG9yID09ICdmdW5jdGlvbicgJiYgTyBpbnN0YW5jZW9mIE8uY29uc3RydWN0b3IpewogICAgcmV0dXJuIE8uY29uc3RydWN0b3IucHJvdG90eXBlOwogIH0gcmV0dXJuIE8gaW5zdGFuY2VvZiBPYmplY3QgPyBPYmplY3RQcm90byA6IG51bGw7Cn07CgovKioqLyB9KSwKLyogNDQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGhhcyAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCB0b0lPYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQogICwgYXJyYXlJbmRleE9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MSkoZmFsc2UpCiAgLCBJRV9QUk9UTyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KSgnSUVfUFJPVE8nKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqZWN0LCBuYW1lcyl7CiAgdmFyIE8gICAgICA9IHRvSU9iamVjdChvYmplY3QpCiAgICAsIGkgICAgICA9IDAKICAgICwgcmVzdWx0ID0gW10KICAgICwga2V5OwogIGZvcihrZXkgaW4gTylpZihrZXkgIT0gSUVfUFJPVE8paGFzKE8sIGtleSkgJiYgcmVzdWx0LnB1c2goa2V5KTsKICAvLyBEb24ndCBlbnVtIGJ1ZyAmIGhpZGRlbiBrZXlzCiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSlpZihoYXMoTywga2V5ID0gbmFtZXNbaSsrXSkpewogICAgfmFycmF5SW5kZXhPZihyZXN1bHQsIGtleSkgfHwgcmVzdWx0LnB1c2goa2V5KTsKICB9CiAgcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiA0NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBtb3N0IE9iamVjdCBtZXRob2RzIGJ5IEVTNiBzaG91bGQgYWNjZXB0IHByaW1pdGl2ZXMKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCBjb3JlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQogICwgZmFpbHMgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEtFWSwgZXhlYyl7CiAgdmFyIGZuICA9IChjb3JlLk9iamVjdCB8fCB7fSlbS0VZXSB8fCBPYmplY3RbS0VZXQogICAgLCBleHAgPSB7fTsKICBleHBbS0VZXSA9IGV4ZWMoZm4pOwogICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogZmFpbHMoZnVuY3Rpb24oKXsgZm4oMSk7IH0pLCAnT2JqZWN0JywgZXhwKTsKfTsKCi8qKiovIH0pLAovKiA0NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CgovKioqLyB9KSwKLyogNDcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjE1IFRvTGVuZ3RoCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KQogICwgbWluICAgICAgID0gTWF0aC5taW47Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCA+IDAgPyBtaW4odG9JbnRlZ2VyKGl0KSwgMHgxZmZmZmZmZmZmZmZmZikgOiAwOyAvLyBwb3coMiwgNTMpIC0gMSA9PSA5MDA3MTk5MjU0NzQwOTkxCn07CgovKioqLyB9KSwKLyogNDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY29yZSAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBMSUJSQVJZICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpCiAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCiAgLCBkZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihuYW1lKXsKICB2YXIgJFN5bWJvbCA9IGNvcmUuU3ltYm9sIHx8IChjb3JlLlN5bWJvbCA9IExJQlJBUlkgPyB7fSA6IGdsb2JhbC5TeW1ib2wgfHwge30pOwogIGlmKG5hbWUuY2hhckF0KDApICE9ICdfJyAmJiAhKG5hbWUgaW4gJFN5bWJvbCkpZGVmaW5lUHJvcGVydHkoJFN5bWJvbCwgbmFtZSwge3ZhbHVlOiB3a3NFeHQuZihuYW1lKX0pOwp9OwoKLyoqKi8gfSksCi8qIDQ5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMik7CgovKioqLyB9KSwKLyogNTAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyICRhdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY2KSh0cnVlKTsKCi8vIDIxLjEuMy4yNyBTdHJpbmcucHJvdG90eXBlW0BAaXRlcmF0b3JdKCkKX193ZWJwYWNrX3JlcXVpcmVfXygzOCkoU3RyaW5nLCAnU3RyaW5nJywgZnVuY3Rpb24oaXRlcmF0ZWQpewogIHRoaXMuX3QgPSBTdHJpbmcoaXRlcmF0ZWQpOyAvLyB0YXJnZXQKICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleAovLyAyMS4xLjUuMi4xICVTdHJpbmdJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpCn0sIGZ1bmN0aW9uKCl7CiAgdmFyIE8gICAgID0gdGhpcy5fdAogICAgLCBpbmRleCA9IHRoaXMuX2kKICAgICwgcG9pbnQ7CiAgaWYoaW5kZXggPj0gTy5sZW5ndGgpcmV0dXJuIHt2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlfTsKICBwb2ludCA9ICRhdChPLCBpbmRleCk7CiAgdGhpcy5faSArPSBwb2ludC5sZW5ndGg7CiAgcmV0dXJuIHt2YWx1ZTogcG9pbnQsIGRvbmU6IGZhbHNlfTsKfSk7CgovKioqLyB9KSwKLyogNTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg2OSk7CnZhciBnbG9iYWwgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgaGlkZSAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKICAsIEl0ZXJhdG9ycyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQogICwgVE9fU1RSSU5HX1RBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3RvU3RyaW5nVGFnJyk7Cgpmb3IodmFyIGNvbGxlY3Rpb25zID0gWydOb2RlTGlzdCcsICdET01Ub2tlbkxpc3QnLCAnTWVkaWFMaXN0JywgJ1N0eWxlU2hlZXRMaXN0JywgJ0NTU1J1bGVMaXN0J10sIGkgPSAwOyBpIDwgNTsgaSsrKXsKICB2YXIgTkFNRSAgICAgICA9IGNvbGxlY3Rpb25zW2ldCiAgICAsIENvbGxlY3Rpb24gPSBnbG9iYWxbTkFNRV0KICAgICwgcHJvdG8gICAgICA9IENvbGxlY3Rpb24gJiYgQ29sbGVjdGlvbi5wcm90b3R5cGU7CiAgaWYocHJvdG8gJiYgIXByb3RvW1RPX1NUUklOR19UQUddKWhpZGUocHJvdG8sIFRPX1NUUklOR19UQUcsIE5BTUUpOwogIEl0ZXJhdG9yc1tOQU1FXSA9IEl0ZXJhdG9ycy5BcnJheTsKfQoKLyoqKi8gfSksCi8qIDUyICovLAovKiA1MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY29yZSAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCAkSlNPTiA9IGNvcmUuSlNPTiB8fCAoY29yZS5KU09OID0ge3N0cmluZ2lmeTogSlNPTi5zdHJpbmdpZnl9KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzdHJpbmdpZnkoaXQpeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzCiAgcmV0dXJuICRKU09OLnN0cmluZ2lmeS5hcHBseSgkSlNPTiwgYXJndW1lbnRzKTsKfTsKCi8qKiovIH0pLAovKiA1NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoKCi8qKiovIH0pLAovKiA1NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBnZXR0aW5nIHRhZyBmcm9tIDE5LjEuMy42IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcoKQp2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkKICAsIFRBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3RvU3RyaW5nVGFnJykKICAvLyBFUzMgd3JvbmcgaGVyZQogICwgQVJHID0gY29mKGZ1bmN0aW9uKCl7IHJldHVybiBhcmd1bWVudHM7IH0oKSkgPT0gJ0FyZ3VtZW50cyc7CgovLyBmYWxsYmFjayBmb3IgSUUxMSBTY3JpcHQgQWNjZXNzIERlbmllZCBlcnJvcgp2YXIgdHJ5R2V0ID0gZnVuY3Rpb24oaXQsIGtleSl7CiAgdHJ5IHsKICAgIHJldHVybiBpdFtrZXldOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KfTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHZhciBPLCBULCBCOwogIHJldHVybiBpdCA9PT0gdW5kZWZpbmVkID8gJ1VuZGVmaW5lZCcgOiBpdCA9PT0gbnVsbCA/ICdOdWxsJwogICAgLy8gQEB0b1N0cmluZ1RhZyBjYXNlCiAgICA6IHR5cGVvZiAoVCA9IHRyeUdldChPID0gT2JqZWN0KGl0KSwgVEFHKSkgPT0gJ3N0cmluZycgPyBUCiAgICAvLyBidWlsdGluVGFnIGNhc2UKICAgIDogQVJHID8gY29mKE8pCiAgICAvLyBFUzMgYXJndW1lbnRzIGZhbGxiYWNrCiAgICA6IChCID0gY29mKE8pKSA9PSAnT2JqZWN0JyAmJiB0eXBlb2YgTy5jYWxsZWUgPT0gJ2Z1bmN0aW9uJyA/ICdBcmd1bWVudHMnIDogQjsKfTsKCi8qKiovIH0pLAovKiA1NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBmYWxsYmFjayBmb3Igbm9uLWFycmF5LWxpa2UgRVMzIGFuZCBub24tZW51bWVyYWJsZSBvbGQgVjggc3RyaW5ncwp2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7Cm1vZHVsZS5leHBvcnRzID0gT2JqZWN0KCd6JykucHJvcGVydHlJc0VudW1lcmFibGUoMCkgPyBPYmplY3QgOiBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGNvZihpdCkgPT0gJ1N0cmluZycgPyBpdC5zcGxpdCgnJykgOiBPYmplY3QoaXQpOwp9OwoKLyoqKi8gfSksCi8qIDU3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBwSUUgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCiAgLCBjcmVhdGVEZXNjICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCiAgLCB0b0lPYmplY3QgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCB0b1ByaW1pdGl2ZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjIpCiAgLCBoYXMgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBJRThfRE9NX0RFRklORSA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpCiAgLCBnT1BEICAgICAgICAgICA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CgpleHBvcnRzLmYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpID8gZ09QRCA6IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKXsKICBPID0gdG9JT2JqZWN0KE8pOwogIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKICBpZihJRThfRE9NX0RFRklORSl0cnkgewogICAgcmV0dXJuIGdPUEQoTywgUCk7CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQogIGlmKGhhcyhPLCBQKSlyZXR1cm4gY3JlYXRlRGVzYyghcElFLmYuY2FsbChPLCBQKSwgT1tQXSk7Cn07CgovKioqLyB9KSwKLyogNTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKZXhwb3J0cy5mID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczsKCi8qKiovIH0pLAovKiA1OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfaXRlcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc3KTsKCnZhciBfaXRlcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaXRlcmF0b3IpOwoKdmFyIF9zeW1ib2wgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc2KTsKCnZhciBfc3ltYm9sMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N5bWJvbCk7Cgp2YXIgX3R5cGVvZiA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBfaXRlcmF0b3IyLmRlZmF1bHQgPT09ICJzeW1ib2wiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IF9zeW1ib2wyLmRlZmF1bHQgJiYgb2JqICE9PSBfc3ltYm9sMi5kZWZhdWx0LnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLmRlZmF1bHQgPSB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBfdHlwZW9mKF9pdGVyYXRvcjIuZGVmYXVsdCkgPT09ICJzeW1ib2wiID8gZnVuY3Rpb24gKG9iaikgewogIHJldHVybiB0eXBlb2Ygb2JqID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihvYmopOwp9IDogZnVuY3Rpb24gKG9iaikgewogIHJldHVybiBvYmogJiYgdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBfc3ltYm9sMi5kZWZhdWx0ICYmIG9iaiAhPT0gX3N5bWJvbDIuZGVmYXVsdC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmogPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG9iaik7Cn07CgovKioqLyB9KSwKLyogNjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9OwoKLyoqKi8gfSksCi8qIDYxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbHNlIC0+IEFycmF5I2luZGV4T2YKLy8gdHJ1ZSAgLT4gQXJyYXkjaW5jbHVkZXMKdmFyIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCB0b0xlbmd0aCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KQogICwgdG9JbmRleCAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oSVNfSU5DTFVERVMpewogIHJldHVybiBmdW5jdGlvbigkdGhpcywgZWwsIGZyb21JbmRleCl7CiAgICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KCR0aGlzKQogICAgICAsIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKQogICAgICAsIGluZGV4ICA9IHRvSW5kZXgoZnJvbUluZGV4LCBsZW5ndGgpCiAgICAgICwgdmFsdWU7CiAgICAvLyBBcnJheSNpbmNsdWRlcyB1c2VzIFNhbWVWYWx1ZVplcm8gZXF1YWxpdHkgYWxnb3JpdGhtCiAgICBpZihJU19JTkNMVURFUyAmJiBlbCAhPSBlbCl3aGlsZShsZW5ndGggPiBpbmRleCl7CiAgICAgIHZhbHVlID0gT1tpbmRleCsrXTsKICAgICAgaWYodmFsdWUgIT0gdmFsdWUpcmV0dXJuIHRydWU7CiAgICAvLyBBcnJheSN0b0luZGV4IGlnbm9yZXMgaG9sZXMsIEFycmF5I2luY2x1ZGVzIC0gbm90CiAgICB9IGVsc2UgZm9yKDtsZW5ndGggPiBpbmRleDsgaW5kZXgrKylpZihJU19JTkNMVURFUyB8fCBpbmRleCBpbiBPKXsKICAgICAgaWYoT1tpbmRleF0gPT09IGVsKXJldHVybiBJU19JTkNMVURFUyB8fCBpbmRleCB8fCAwOwogICAgfSByZXR1cm4gIUlTX0lOQ0xVREVTICYmIC0xOwogIH07Cn07CgovKioqLyB9KSwKLyogNjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIGNyZWF0ZSAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSkKICAsIGRlc2NyaXB0b3IgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIEl0ZXJhdG9yUHJvdG90eXBlID0ge307CgovLyAyNS4xLjIuMS4xICVJdGVyYXRvclByb3RvdHlwZSVbQEBpdGVyYXRvcl0oKQpfX3dlYnBhY2tfcmVxdWlyZV9fKDYpKEl0ZXJhdG9yUHJvdG90eXBlLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpLCBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfSk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKENvbnN0cnVjdG9yLCBOQU1FLCBuZXh0KXsKICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSBjcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUsIHtuZXh0OiBkZXNjcmlwdG9yKDEsIG5leHQpfSk7CiAgc2V0VG9TdHJpbmdUYWcoQ29uc3RydWN0b3IsIE5BTUUgKyAnIEl0ZXJhdG9yJyk7Cn07CgovKioqLyB9KSwKLyogNjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihkb25lLCB2YWx1ZSl7CiAgcmV0dXJuIHt2YWx1ZTogdmFsdWUsIGRvbmU6ICEhZG9uZX07Cn07CgovKioqLyB9KSwKLyogNjQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRQICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpOwoKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpewogIGFuT2JqZWN0KE8pOwogIHZhciBrZXlzICAgPSBnZXRLZXlzKFByb3BlcnRpZXMpCiAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCiAgICAsIGkgPSAwCiAgICAsIFA7CiAgd2hpbGUobGVuZ3RoID4gaSlkUC5mKE8sIFAgPSBrZXlzW2krK10sIFByb3BlcnRpZXNbUF0pOwogIHJldHVybiBPOwp9OwoKLyoqKi8gfSksCi8qIDY1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi43IC8gMTUuMi4zLjQgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKdmFyICRrZXlzICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ0KQogICwgaGlkZGVuS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpLmNvbmNhdCgnbGVuZ3RoJywgJ3Byb3RvdHlwZScpOwoKZXhwb3J0cy5mID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgfHwgZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhPKXsKICByZXR1cm4gJGtleXMoTywgaGlkZGVuS2V5cyk7Cn07CgovKioqLyB9KSwKLyogNjYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpCiAgLCBkZWZpbmVkICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKLy8gdHJ1ZSAgLT4gU3RyaW5nI2F0Ci8vIGZhbHNlIC0+IFN0cmluZyNjb2RlUG9pbnRBdAptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFRPX1NUUklORyl7CiAgcmV0dXJuIGZ1bmN0aW9uKHRoYXQsIHBvcyl7CiAgICB2YXIgcyA9IFN0cmluZyhkZWZpbmVkKHRoYXQpKQogICAgICAsIGkgPSB0b0ludGVnZXIocG9zKQogICAgICAsIGwgPSBzLmxlbmd0aAogICAgICAsIGEsIGI7CiAgICBpZihpIDwgMCB8fCBpID49IGwpcmV0dXJuIFRPX1NUUklORyA/ICcnIDogdW5kZWZpbmVkOwogICAgYSA9IHMuY2hhckNvZGVBdChpKTsKICAgIHJldHVybiBhIDwgMHhkODAwIHx8IGEgPiAweGRiZmYgfHwgaSArIDEgPT09IGwgfHwgKGIgPSBzLmNoYXJDb2RlQXQoaSArIDEpKSA8IDB4ZGMwMCB8fCBiID4gMHhkZmZmCiAgICAgID8gVE9fU1RSSU5HID8gcy5jaGFyQXQoaSkgOiBhCiAgICAgIDogVE9fU1RSSU5HID8gcy5zbGljZShpLCBpICsgMikgOiAoYSAtIDB4ZDgwMCA8PCAxMCkgKyAoYiAtIDB4ZGMwMCkgKyAweDEwMDAwOwogIH07Cn07CgovKioqLyB9KSwKLyogNjcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGN0eCAgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCiAgLCBpbnZva2UgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg4KQogICwgaHRtbCAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MikKICAsIGNlbCAgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpCiAgLCBnbG9iYWwgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBwcm9jZXNzICAgICAgICAgICAgPSBnbG9iYWwucHJvY2VzcwogICwgc2V0VGFzayAgICAgICAgICAgID0gZ2xvYmFsLnNldEltbWVkaWF0ZQogICwgY2xlYXJUYXNrICAgICAgICAgID0gZ2xvYmFsLmNsZWFySW1tZWRpYXRlCiAgLCBNZXNzYWdlQ2hhbm5lbCAgICAgPSBnbG9iYWwuTWVzc2FnZUNoYW5uZWwKICAsIGNvdW50ZXIgICAgICAgICAgICA9IDAKICAsIHF1ZXVlICAgICAgICAgICAgICA9IHt9CiAgLCBPTlJFQURZU1RBVEVDSEFOR0UgPSAnb25yZWFkeXN0YXRlY2hhbmdlJwogICwgZGVmZXIsIGNoYW5uZWwsIHBvcnQ7CnZhciBydW4gPSBmdW5jdGlvbigpewogIHZhciBpZCA9ICt0aGlzOwogIGlmKHF1ZXVlLmhhc093blByb3BlcnR5KGlkKSl7CiAgICB2YXIgZm4gPSBxdWV1ZVtpZF07CiAgICBkZWxldGUgcXVldWVbaWRdOwogICAgZm4oKTsKICB9Cn07CnZhciBsaXN0ZW5lciA9IGZ1bmN0aW9uKGV2ZW50KXsKICBydW4uY2FsbChldmVudC5kYXRhKTsKfTsKLy8gTm9kZS5qcyAwLjkrICYgSUUxMCsgaGFzIHNldEltbWVkaWF0ZSwgb3RoZXJ3aXNlOgppZighc2V0VGFzayB8fCAhY2xlYXJUYXNrKXsKICBzZXRUYXNrID0gZnVuY3Rpb24gc2V0SW1tZWRpYXRlKGZuKXsKICAgIHZhciBhcmdzID0gW10sIGkgPSAxOwogICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKICAgIHF1ZXVlWysrY291bnRlcl0gPSBmdW5jdGlvbigpewogICAgICBpbnZva2UodHlwZW9mIGZuID09ICdmdW5jdGlvbicgPyBmbiA6IEZ1bmN0aW9uKGZuKSwgYXJncyk7CiAgICB9OwogICAgZGVmZXIoY291bnRlcik7CiAgICByZXR1cm4gY291bnRlcjsKICB9OwogIGNsZWFyVGFzayA9IGZ1bmN0aW9uIGNsZWFySW1tZWRpYXRlKGlkKXsKICAgIGRlbGV0ZSBxdWV1ZVtpZF07CiAgfTsKICAvLyBOb2RlLmpzIDAuOC0KICBpZihfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KShwcm9jZXNzKSA9PSAncHJvY2VzcycpewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIHByb2Nlc3MubmV4dFRpY2soY3R4KHJ1biwgaWQsIDEpKTsKICAgIH07CiAgLy8gQnJvd3NlcnMgd2l0aCBNZXNzYWdlQ2hhbm5lbCwgaW5jbHVkZXMgV2ViV29ya2VycwogIH0gZWxzZSBpZihNZXNzYWdlQ2hhbm5lbCl7CiAgICBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsOwogICAgcG9ydCAgICA9IGNoYW5uZWwucG9ydDI7CiAgICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGxpc3RlbmVyOwogICAgZGVmZXIgPSBjdHgocG9ydC5wb3N0TWVzc2FnZSwgcG9ydCwgMSk7CiAgLy8gQnJvd3NlcnMgd2l0aCBwb3N0TWVzc2FnZSwgc2tpcCBXZWJXb3JrZXJzCiAgLy8gSUU4IGhhcyBwb3N0TWVzc2FnZSwgYnV0IGl0J3Mgc3luYyAmIHR5cGVvZiBpdHMgcG9zdE1lc3NhZ2UgaXMgJ29iamVjdCcKICB9IGVsc2UgaWYoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIgJiYgdHlwZW9mIHBvc3RNZXNzYWdlID09ICdmdW5jdGlvbicgJiYgIWdsb2JhbC5pbXBvcnRTY3JpcHRzKXsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBnbG9iYWwucG9zdE1lc3NhZ2UoaWQgKyAnJywgJyonKTsKICAgIH07CiAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGxpc3RlbmVyLCBmYWxzZSk7CiAgLy8gSUU4LQogIH0gZWxzZSBpZihPTlJFQURZU1RBVEVDSEFOR0UgaW4gY2VsKCdzY3JpcHQnKSl7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgaHRtbC5hcHBlbmRDaGlsZChjZWwoJ3NjcmlwdCcpKVtPTlJFQURZU1RBVEVDSEFOR0VdID0gZnVuY3Rpb24oKXsKICAgICAgICBodG1sLnJlbW92ZUNoaWxkKHRoaXMpOwogICAgICAgIHJ1bi5jYWxsKGlkKTsKICAgICAgfTsKICAgIH07CiAgLy8gUmVzdCBvbGQgYnJvd3NlcnMKICB9IGVsc2UgewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIHNldFRpbWVvdXQoY3R4KHJ1biwgaWQsIDEpLCAwKTsKICAgIH07CiAgfQp9Cm1vZHVsZS5leHBvcnRzID0gewogIHNldDogICBzZXRUYXNrLAogIGNsZWFyOiBjbGVhclRhc2sKfTsKCi8qKiovIH0pLAovKiA2OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykKICAsIG1heCAgICAgICA9IE1hdGgubWF4CiAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpbmRleCwgbGVuZ3RoKXsKICBpbmRleCA9IHRvSW50ZWdlcihpbmRleCk7CiAgcmV0dXJuIGluZGV4IDwgMCA/IG1heChpbmRleCArIGxlbmd0aCwgMCkgOiBtaW4oaW5kZXgsIGxlbmd0aCk7Cn07CgovKioqLyB9KSwKLyogNjkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIGFkZFRvVW5zY29wYWJsZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYwKQogICwgc3RlcCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjMpCiAgLCBJdGVyYXRvcnMgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsIHRvSU9iamVjdCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTsKCi8vIDIyLjEuMy40IEFycmF5LnByb3RvdHlwZS5lbnRyaWVzKCkKLy8gMjIuMS4zLjEzIEFycmF5LnByb3RvdHlwZS5rZXlzKCkKLy8gMjIuMS4zLjI5IEFycmF5LnByb3RvdHlwZS52YWx1ZXMoKQovLyAyMi4xLjMuMzAgQXJyYXkucHJvdG90eXBlW0BAaXRlcmF0b3JdKCkKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KShBcnJheSwgJ0FycmF5JywgZnVuY3Rpb24oaXRlcmF0ZWQsIGtpbmQpewogIHRoaXMuX3QgPSB0b0lPYmplY3QoaXRlcmF0ZWQpOyAvLyB0YXJnZXQKICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleAogIHRoaXMuX2sgPSBraW5kOyAgICAgICAgICAgICAgICAvLyBraW5kCi8vIDIyLjEuNS4yLjEgJUFycmF5SXRlcmF0b3JQcm90b3R5cGUlLm5leHQoKQp9LCBmdW5jdGlvbigpewogIHZhciBPICAgICA9IHRoaXMuX3QKICAgICwga2luZCAgPSB0aGlzLl9rCiAgICAsIGluZGV4ID0gdGhpcy5faSsrOwogIGlmKCFPIHx8IGluZGV4ID49IE8ubGVuZ3RoKXsKICAgIHRoaXMuX3QgPSB1bmRlZmluZWQ7CiAgICByZXR1cm4gc3RlcCgxKTsKICB9CiAgaWYoa2luZCA9PSAna2V5cycgIClyZXR1cm4gc3RlcCgwLCBpbmRleCk7CiAgaWYoa2luZCA9PSAndmFsdWVzJylyZXR1cm4gc3RlcCgwLCBPW2luZGV4XSk7CiAgcmV0dXJuIHN0ZXAoMCwgW2luZGV4LCBPW2luZGV4XV0pOwp9LCAndmFsdWVzJyk7CgovLyBhcmd1bWVudHNMaXN0W0BAaXRlcmF0b3JdIGlzICVBcnJheVByb3RvX3ZhbHVlcyUgKDkuNC40LjYsIDkuNC40LjcpCkl0ZXJhdG9ycy5Bcmd1bWVudHMgPSBJdGVyYXRvcnMuQXJyYXk7CgphZGRUb1Vuc2NvcGFibGVzKCdrZXlzJyk7CmFkZFRvVW5zY29wYWJsZXMoJ3ZhbHVlcycpOwphZGRUb1Vuc2NvcGFibGVzKCdlbnRyaWVzJyk7CgovKioqLyB9KSwKLyogNzAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MCksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgyKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDcyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBNRVRBICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpKCdtZXRhJykKICAsIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KQogICwgaGFzICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQogICwgc2V0RGVzYyAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmYKICAsIGlkICAgICAgID0gMDsKdmFyIGlzRXh0ZW5zaWJsZSA9IE9iamVjdC5pc0V4dGVuc2libGUgfHwgZnVuY3Rpb24oKXsKICByZXR1cm4gdHJ1ZTsKfTsKdmFyIEZSRUVaRSA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHJldHVybiBpc0V4dGVuc2libGUoT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKHt9KSk7Cn0pOwp2YXIgc2V0TWV0YSA9IGZ1bmN0aW9uKGl0KXsKICBzZXREZXNjKGl0LCBNRVRBLCB7dmFsdWU6IHsKICAgIGk6ICdPJyArICsraWQsIC8vIG9iamVjdCBJRAogICAgdzoge30gICAgICAgICAgLy8gd2VhayBjb2xsZWN0aW9ucyBJRHMKICB9fSk7Cn07CnZhciBmYXN0S2V5ID0gZnVuY3Rpb24oaXQsIGNyZWF0ZSl7CiAgLy8gcmV0dXJuIHByaW1pdGl2ZSB3aXRoIHByZWZpeAogIGlmKCFpc09iamVjdChpdCkpcmV0dXJuIHR5cGVvZiBpdCA9PSAnc3ltYm9sJyA/IGl0IDogKHR5cGVvZiBpdCA9PSAnc3RyaW5nJyA/ICdTJyA6ICdQJykgKyBpdDsKICBpZighaGFzKGl0LCBNRVRBKSl7CiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdAogICAgaWYoIWlzRXh0ZW5zaWJsZShpdCkpcmV0dXJuICdGJzsKICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhCiAgICBpZighY3JlYXRlKXJldHVybiAnRSc7CiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YQogICAgc2V0TWV0YShpdCk7CiAgLy8gcmV0dXJuIG9iamVjdCBJRAogIH0gcmV0dXJuIGl0W01FVEFdLmk7Cn07CnZhciBnZXRXZWFrID0gZnVuY3Rpb24oaXQsIGNyZWF0ZSl7CiAgaWYoIWhhcyhpdCwgTUVUQSkpewogICAgLy8gY2FuJ3Qgc2V0IG1ldGFkYXRhIHRvIHVuY2F1Z2h0IGZyb3plbiBvYmplY3QKICAgIGlmKCFpc0V4dGVuc2libGUoaXQpKXJldHVybiB0cnVlOwogICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGEKICAgIGlmKCFjcmVhdGUpcmV0dXJuIGZhbHNlOwogICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGEKICAgIHNldE1ldGEoaXQpOwogIC8vIHJldHVybiBoYXNoIHdlYWsgY29sbGVjdGlvbnMgSURzCiAgfSByZXR1cm4gaXRbTUVUQV0udzsKfTsKLy8gYWRkIG1ldGFkYXRhIG9uIGZyZWV6ZS1mYW1pbHkgbWV0aG9kcyBjYWxsaW5nCnZhciBvbkZyZWV6ZSA9IGZ1bmN0aW9uKGl0KXsKICBpZihGUkVFWkUgJiYgbWV0YS5ORUVEICYmIGlzRXh0ZW5zaWJsZShpdCkgJiYgIWhhcyhpdCwgTUVUQSkpc2V0TWV0YShpdCk7CiAgcmV0dXJuIGl0Owp9Owp2YXIgbWV0YSA9IG1vZHVsZS5leHBvcnRzID0gewogIEtFWTogICAgICBNRVRBLAogIE5FRUQ6ICAgICBmYWxzZSwKICBmYXN0S2V5OiAgZmFzdEtleSwKICBnZXRXZWFrOiAgZ2V0V2VhaywKICBvbkZyZWV6ZTogb25GcmVlemUKfTsKCi8qKiovIH0pLAovKiA3MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY2xhc3NvZiAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NSkKICAsIElURVJBVE9SICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJykKICAsIEl0ZXJhdG9ycyA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuZ2V0SXRlcmF0b3JNZXRob2QgPSBmdW5jdGlvbihpdCl7CiAgaWYoaXQgIT0gdW5kZWZpbmVkKXJldHVybiBpdFtJVEVSQVRPUl0KICAgIHx8IGl0WydAQGl0ZXJhdG9yJ10KICAgIHx8IEl0ZXJhdG9yc1tjbGFzc29mKGl0KV07Cn07CgovKioqLyB9KSwKLyogNzQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg3OCksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgxKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODMpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4NCksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMCk7CnZhciAkT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Q7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY3JlYXRlKFAsIEQpewogIHJldHVybiAkT2JqZWN0LmNyZWF0ZShQLCBEKTsKfTsKCi8qKiovIH0pLAovKiA3OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3QuZ2V0UHJvdG90eXBlT2Y7CgovKioqLyB9KSwKLyogODAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygxMDIpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0LmtleXM7CgovKioqLyB9KSwKLyogODEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygxMDMpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0LnNldFByb3RvdHlwZU9mOwoKLyoqKi8gfSksCi8qIDgyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNTQpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7Cl9fd2VicGFja19yZXF1aXJlX18oMTA0KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLlByb21pc2U7CgovKioqLyB9KSwKLyogODMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygxMDUpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KTsKX193ZWJwYWNrX3JlcXVpcmVfXygxMDYpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNyk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5TeW1ib2w7CgovKioqLyB9KSwKLyogODQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7Cl9fd2VicGFja19yZXF1aXJlX18oNTEpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpLmYoJ2l0ZXJhdG9yJyk7CgovKioqLyB9KSwKLyogODUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgQ29uc3RydWN0b3IsIG5hbWUsIGZvcmJpZGRlbkZpZWxkKXsKICBpZighKGl0IGluc3RhbmNlb2YgQ29uc3RydWN0b3IpIHx8IChmb3JiaWRkZW5GaWVsZCAhPT0gdW5kZWZpbmVkICYmIGZvcmJpZGRlbkZpZWxkIGluIGl0KSl7CiAgICB0aHJvdyBUeXBlRXJyb3IobmFtZSArICc6IGluY29ycmVjdCBpbnZvY2F0aW9uIScpOwogIH0gcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDg2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGFsbCBlbnVtZXJhYmxlIG9iamVjdCBrZXlzLCBpbmNsdWRlcyBzeW1ib2xzCnZhciBnZXRLZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykKICAsIGdPUFMgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU4KQogICwgcElFICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICB2YXIgcmVzdWx0ICAgICA9IGdldEtleXMoaXQpCiAgICAsIGdldFN5bWJvbHMgPSBnT1BTLmY7CiAgaWYoZ2V0U3ltYm9scyl7CiAgICB2YXIgc3ltYm9scyA9IGdldFN5bWJvbHMoaXQpCiAgICAgICwgaXNFbnVtICA9IHBJRS5mCiAgICAgICwgaSAgICAgICA9IDAKICAgICAgLCBrZXk7CiAgICB3aGlsZShzeW1ib2xzLmxlbmd0aCA+IGkpaWYoaXNFbnVtLmNhbGwoaXQsIGtleSA9IHN5bWJvbHNbaSsrXSkpcmVzdWx0LnB1c2goa2V5KTsKICB9IHJldHVybiByZXN1bHQ7Cn07CgovKioqLyB9KSwKLyogODcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGN0eCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGNhbGwgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MSkKICAsIGlzQXJyYXlJdGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4OSkKICAsIGFuT2JqZWN0ICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQogICwgdG9MZW5ndGggICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KQogICwgZ2V0SXRlckZuICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDczKQogICwgQlJFQUsgICAgICAgPSB7fQogICwgUkVUVVJOICAgICAgPSB7fTsKdmFyIGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhYmxlLCBlbnRyaWVzLCBmbiwgdGhhdCwgSVRFUkFUT1IpewogIHZhciBpdGVyRm4gPSBJVEVSQVRPUiA/IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyYWJsZTsgfSA6IGdldEl0ZXJGbihpdGVyYWJsZSkKICAgICwgZiAgICAgID0gY3R4KGZuLCB0aGF0LCBlbnRyaWVzID8gMiA6IDEpCiAgICAsIGluZGV4ICA9IDAKICAgICwgbGVuZ3RoLCBzdGVwLCBpdGVyYXRvciwgcmVzdWx0OwogIGlmKHR5cGVvZiBpdGVyRm4gIT0gJ2Z1bmN0aW9uJyl0aHJvdyBUeXBlRXJyb3IoaXRlcmFibGUgKyAnIGlzIG5vdCBpdGVyYWJsZSEnKTsKICAvLyBmYXN0IGNhc2UgZm9yIGFycmF5cyB3aXRoIGRlZmF1bHQgaXRlcmF0b3IKICBpZihpc0FycmF5SXRlcihpdGVyRm4pKWZvcihsZW5ndGggPSB0b0xlbmd0aChpdGVyYWJsZS5sZW5ndGgpOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKyl7CiAgICByZXN1bHQgPSBlbnRyaWVzID8gZihhbk9iamVjdChzdGVwID0gaXRlcmFibGVbaW5kZXhdKVswXSwgc3RlcFsxXSkgOiBmKGl0ZXJhYmxlW2luZGV4XSk7CiAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7CiAgfSBlbHNlIGZvcihpdGVyYXRvciA9IGl0ZXJGbi5jYWxsKGl0ZXJhYmxlKTsgIShzdGVwID0gaXRlcmF0b3IubmV4dCgpKS5kb25lOyApewogICAgcmVzdWx0ID0gY2FsbChpdGVyYXRvciwgZiwgc3RlcC52YWx1ZSwgZW50cmllcyk7CiAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7CiAgfQp9OwpleHBvcnRzLkJSRUFLICA9IEJSRUFLOwpleHBvcnRzLlJFVFVSTiA9IFJFVFVSTjsKCi8qKiovIH0pLAovKiA4OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBmYXN0IGFwcGx5LCBodHRwOi8vanNwZXJmLmxua2l0LmNvbS9mYXN0LWFwcGx5LzUKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmbiwgYXJncywgdGhhdCl7CiAgdmFyIHVuID0gdGhhdCA9PT0gdW5kZWZpbmVkOwogIHN3aXRjaChhcmdzLmxlbmd0aCl7CiAgICBjYXNlIDA6IHJldHVybiB1biA/IGZuKCkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0KTsKICAgIGNhc2UgMTogcmV0dXJuIHVuID8gZm4oYXJnc1swXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdKTsKICAgIGNhc2UgMjogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdKTsKICAgIGNhc2UgMzogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTsKICAgIGNhc2UgNDogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKTsKICB9IHJldHVybiAgICAgICAgICAgICAgZm4uYXBwbHkodGhhdCwgYXJncyk7Cn07CgovKioqLyB9KSwKLyogODkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gY2hlY2sgb24gZGVmYXVsdCBBcnJheSBpdGVyYXRvcgp2YXIgSXRlcmF0b3JzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCBJVEVSQVRPUiAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCAhPT0gdW5kZWZpbmVkICYmIChJdGVyYXRvcnMuQXJyYXkgPT09IGl0IHx8IEFycmF5UHJvdG9bSVRFUkFUT1JdID09PSBpdCk7Cn07CgovKioqLyB9KSwKLyogOTAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4yLjIgSXNBcnJheShhcmd1bWVudCkKdmFyIGNvZiA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpOwptb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gaXNBcnJheShhcmcpewogIHJldHVybiBjb2YoYXJnKSA9PSAnQXJyYXknOwp9OwoKLyoqKi8gfSksCi8qIDkxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGNhbGwgc29tZXRoaW5nIG9uIGl0ZXJhdG9yIHN0ZXAgd2l0aCBzYWZlIGNsb3Npbmcgb24gZXJyb3IKdmFyIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdGVyYXRvciwgZm4sIHZhbHVlLCBlbnRyaWVzKXsKICB0cnkgewogICAgcmV0dXJuIGVudHJpZXMgPyBmbihhbk9iamVjdCh2YWx1ZSlbMF0sIHZhbHVlWzFdKSA6IGZuKHZhbHVlKTsKICAvLyA3LjQuNiBJdGVyYXRvckNsb3NlKGl0ZXJhdG9yLCBjb21wbGV0aW9uKQogIH0gY2F0Y2goZSl7CiAgICB2YXIgcmV0ID0gaXRlcmF0b3JbJ3JldHVybiddOwogICAgaWYocmV0ICE9PSB1bmRlZmluZWQpYW5PYmplY3QocmV0LmNhbGwoaXRlcmF0b3IpKTsKICAgIHRocm93IGU7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDkyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBJVEVSQVRPUiAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpCiAgLCBTQUZFX0NMT1NJTkcgPSBmYWxzZTsKCnRyeSB7CiAgdmFyIHJpdGVyID0gWzddW0lURVJBVE9SXSgpOwogIHJpdGVyWydyZXR1cm4nXSA9IGZ1bmN0aW9uKCl7IFNBRkVfQ0xPU0lORyA9IHRydWU7IH07CiAgQXJyYXkuZnJvbShyaXRlciwgZnVuY3Rpb24oKXsgdGhyb3cgMjsgfSk7Cn0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYywgc2tpcENsb3NpbmcpewogIGlmKCFza2lwQ2xvc2luZyAmJiAhU0FGRV9DTE9TSU5HKXJldHVybiBmYWxzZTsKICB2YXIgc2FmZSA9IGZhbHNlOwogIHRyeSB7CiAgICB2YXIgYXJyICA9IFs3XQogICAgICAsIGl0ZXIgPSBhcnJbSVRFUkFUT1JdKCk7CiAgICBpdGVyLm5leHQgPSBmdW5jdGlvbigpeyByZXR1cm4ge2RvbmU6IHNhZmUgPSB0cnVlfTsgfTsKICAgIGFycltJVEVSQVRPUl0gPSBmdW5jdGlvbigpeyByZXR1cm4gaXRlcjsgfTsKICAgIGV4ZWMoYXJyKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgcmV0dXJuIHNhZmU7Cn07CgovKioqLyB9KSwKLyogOTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdldEtleXMgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpCiAgLCB0b0lPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIGVsKXsKICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKICAgICwga2V5cyAgID0gZ2V0S2V5cyhPKQogICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAogICAgLCBpbmRleCAgPSAwCiAgICAsIGtleTsKICB3aGlsZShsZW5ndGggPiBpbmRleClpZihPW2tleSA9IGtleXNbaW5kZXgrK11dID09PSBlbClyZXR1cm4ga2V5Owp9OwoKLyoqKi8gfSksCi8qIDk0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBtYWNyb3Rhc2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KS5zZXQKICAsIE9ic2VydmVyICA9IGdsb2JhbC5NdXRhdGlvbk9ic2VydmVyIHx8IGdsb2JhbC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyCiAgLCBwcm9jZXNzICAgPSBnbG9iYWwucHJvY2VzcwogICwgUHJvbWlzZSAgID0gZ2xvYmFsLlByb21pc2UKICAsIGlzTm9kZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpKHByb2Nlc3MpID09ICdwcm9jZXNzJzsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKXsKICB2YXIgaGVhZCwgbGFzdCwgbm90aWZ5OwoKICB2YXIgZmx1c2ggPSBmdW5jdGlvbigpewogICAgdmFyIHBhcmVudCwgZm47CiAgICBpZihpc05vZGUgJiYgKHBhcmVudCA9IHByb2Nlc3MuZG9tYWluKSlwYXJlbnQuZXhpdCgpOwogICAgd2hpbGUoaGVhZCl7CiAgICAgIGZuICAgPSBoZWFkLmZuOwogICAgICBoZWFkID0gaGVhZC5uZXh0OwogICAgICB0cnkgewogICAgICAgIGZuKCk7CiAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgaWYoaGVhZClub3RpZnkoKTsKICAgICAgICBlbHNlIGxhc3QgPSB1bmRlZmluZWQ7CiAgICAgICAgdGhyb3cgZTsKICAgICAgfQogICAgfSBsYXN0ID0gdW5kZWZpbmVkOwogICAgaWYocGFyZW50KXBhcmVudC5lbnRlcigpOwogIH07CgogIC8vIE5vZGUuanMKICBpZihpc05vZGUpewogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgcHJvY2Vzcy5uZXh0VGljayhmbHVzaCk7CiAgICB9OwogIC8vIGJyb3dzZXJzIHdpdGggTXV0YXRpb25PYnNlcnZlcgogIH0gZWxzZSBpZihPYnNlcnZlcil7CiAgICB2YXIgdG9nZ2xlID0gdHJ1ZQogICAgICAsIG5vZGUgICA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTsKICAgIG5ldyBPYnNlcnZlcihmbHVzaCkub2JzZXJ2ZShub2RlLCB7Y2hhcmFjdGVyRGF0YTogdHJ1ZX0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldwogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgbm9kZS5kYXRhID0gdG9nZ2xlID0gIXRvZ2dsZTsKICAgIH07CiAgLy8gZW52aXJvbm1lbnRzIHdpdGggbWF5YmUgbm9uLWNvbXBsZXRlbHkgY29ycmVjdCwgYnV0IGV4aXN0ZW50IFByb21pc2UKICB9IGVsc2UgaWYoUHJvbWlzZSAmJiBQcm9taXNlLnJlc29sdmUpewogICAgdmFyIHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CiAgICAgIHByb21pc2UudGhlbihmbHVzaCk7CiAgICB9OwogIC8vIGZvciBvdGhlciBlbnZpcm9ubWVudHMgLSBtYWNyb3Rhc2sgYmFzZWQgb246CiAgLy8gLSBzZXRJbW1lZGlhdGUKICAvLyAtIE1lc3NhZ2VDaGFubmVsCiAgLy8gLSB3aW5kb3cucG9zdE1lc3NhZwogIC8vIC0gb25yZWFkeXN0YXRlY2hhbmdlCiAgLy8gLSBzZXRUaW1lb3V0CiAgfSBlbHNlIHsKICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CiAgICAgIC8vIHN0cmFuZ2UgSUUgKyB3ZWJwYWNrIGRldiBzZXJ2ZXIgYnVnIC0gdXNlIC5jYWxsKGdsb2JhbCkKICAgICAgbWFjcm90YXNrLmNhbGwoZ2xvYmFsLCBmbHVzaCk7CiAgICB9OwogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uKGZuKXsKICAgIHZhciB0YXNrID0ge2ZuOiBmbiwgbmV4dDogdW5kZWZpbmVkfTsKICAgIGlmKGxhc3QpbGFzdC5uZXh0ID0gdGFzazsKICAgIGlmKCFoZWFkKXsKICAgICAgaGVhZCA9IHRhc2s7CiAgICAgIG5vdGlmeSgpOwogICAgfSBsYXN0ID0gdGFzazsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDk1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbGxiYWNrIGZvciBJRTExIGJ1Z2d5IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHdpdGggaWZyYW1lIGFuZCB3aW5kb3cKdmFyIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCBnT1BOICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY1KS5mCiAgLCB0b1N0cmluZyAgPSB7fS50b1N0cmluZzsKCnZhciB3aW5kb3dOYW1lcyA9IHR5cGVvZiB3aW5kb3cgPT0gJ29iamVjdCcgJiYgd2luZG93ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzCiAgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW107Cgp2YXIgZ2V0V2luZG93TmFtZXMgPSBmdW5jdGlvbihpdCl7CiAgdHJ5IHsKICAgIHJldHVybiBnT1BOKGl0KTsKICB9IGNhdGNoKGUpewogICAgcmV0dXJuIHdpbmRvd05hbWVzLnNsaWNlKCk7CiAgfQp9OwoKbW9kdWxlLmV4cG9ydHMuZiA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpewogIHJldHVybiB3aW5kb3dOYW1lcyAmJiB0b1N0cmluZy5jYWxsKGl0KSA9PSAnW29iamVjdCBXaW5kb3ddJyA/IGdldFdpbmRvd05hbWVzKGl0KSA6IGdPUE4odG9JT2JqZWN0KGl0KSk7Cn07CgoKLyoqKi8gfSksCi8qIDk2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBoaWRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih0YXJnZXQsIHNyYywgc2FmZSl7CiAgZm9yKHZhciBrZXkgaW4gc3JjKXsKICAgIGlmKHNhZmUgJiYgdGFyZ2V0W2tleV0pdGFyZ2V0W2tleV0gPSBzcmNba2V5XTsKICAgIGVsc2UgaGlkZSh0YXJnZXQsIGtleSwgc3JjW2tleV0pOwogIH0gcmV0dXJuIHRhcmdldDsKfTsKCi8qKiovIH0pLAovKiA5NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBXb3JrcyB3aXRoIF9fcHJvdG9fXyBvbmx5LiBPbGQgdjggY2FuJ3Qgd29yayB3aXRoIG51bGwgcHJvdG8gb2JqZWN0cy4KLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi8KdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KQogICwgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwp2YXIgY2hlY2sgPSBmdW5jdGlvbihPLCBwcm90byl7CiAgYW5PYmplY3QoTyk7CiAgaWYoIWlzT2JqZWN0KHByb3RvKSAmJiBwcm90byAhPT0gbnVsbCl0aHJvdyBUeXBlRXJyb3IocHJvdG8gKyAiOiBjYW4ndCBzZXQgYXMgcHJvdG90eXBlISIpOwp9Owptb2R1bGUuZXhwb3J0cyA9IHsKICBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoJ19fcHJvdG9fXycgaW4ge30gPyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCiAgICBmdW5jdGlvbih0ZXN0LCBidWdneSwgc2V0KXsKICAgICAgdHJ5IHsKICAgICAgICBzZXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KShGdW5jdGlvbi5jYWxsLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KS5mKE9iamVjdC5wcm90b3R5cGUsICdfX3Byb3RvX18nKS5zZXQsIDIpOwogICAgICAgIHNldCh0ZXN0LCBbXSk7CiAgICAgICAgYnVnZ3kgPSAhKHRlc3QgaW5zdGFuY2VvZiBBcnJheSk7CiAgICAgIH0gY2F0Y2goZSl7IGJ1Z2d5ID0gdHJ1ZTsgfQogICAgICByZXR1cm4gZnVuY3Rpb24gc2V0UHJvdG90eXBlT2YoTywgcHJvdG8pewogICAgICAgIGNoZWNrKE8sIHByb3RvKTsKICAgICAgICBpZihidWdneSlPLl9fcHJvdG9fXyA9IHByb3RvOwogICAgICAgIGVsc2Ugc2V0KE8sIHByb3RvKTsKICAgICAgICByZXR1cm4gTzsKICAgICAgfTsKICAgIH0oe30sIGZhbHNlKSA6IHVuZGVmaW5lZCksCiAgY2hlY2s6IGNoZWNrCn07CgovKioqLyB9KSwKLyogOTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIGdsb2JhbCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY29yZSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBkUCAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKICAsIERFU0NSSVBUT1JTID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKQogICwgU1BFQ0lFUyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdzcGVjaWVzJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEtFWSl7CiAgdmFyIEMgPSB0eXBlb2YgY29yZVtLRVldID09ICdmdW5jdGlvbicgPyBjb3JlW0tFWV0gOiBnbG9iYWxbS0VZXTsKICBpZihERVNDUklQVE9SUyAmJiBDICYmICFDW1NQRUNJRVNdKWRQLmYoQywgU1BFQ0lFUywgewogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfQogIH0pOwp9OwoKLyoqKi8gfSksCi8qIDk5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDcuMy4yMCBTcGVjaWVzQ29uc3RydWN0b3IoTywgZGVmYXVsdENvbnN0cnVjdG9yKQp2YXIgYW5PYmplY3QgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQogICwgYUZ1bmN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCkKICAsIFNQRUNJRVMgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihPLCBEKXsKICB2YXIgQyA9IGFuT2JqZWN0KE8pLmNvbnN0cnVjdG9yLCBTOwogIHJldHVybiBDID09PSB1bmRlZmluZWQgfHwgKFMgPSBhbk9iamVjdChDKVtTUEVDSUVTXSkgPT0gdW5kZWZpbmVkID8gRCA6IGFGdW5jdGlvbihTKTsKfTsKCi8qKiovIH0pLAovKiAxMDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQokZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtjcmVhdGU6IF9fd2VicGFja19yZXF1aXJlX18oMzUpfSk7CgovKioqLyB9KSwKLyogMTAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi45IE9iamVjdC5nZXRQcm90b3R5cGVPZihPKQp2YXIgdG9PYmplY3QgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMikKICAsICRnZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oNDMpOwoKX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2dldFByb3RvdHlwZU9mJywgZnVuY3Rpb24oKXsKICByZXR1cm4gZnVuY3Rpb24gZ2V0UHJvdG90eXBlT2YoaXQpewogICAgcmV0dXJuICRnZXRQcm90b3R5cGVPZih0b09iamVjdChpdCkpOwogIH07Cn0pOwoKLyoqKi8gfSksCi8qIDEwMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuMTQgT2JqZWN0LmtleXMoTykKdmFyIHRvT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMikKICAsICRrZXlzICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KSgna2V5cycsIGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGZ1bmN0aW9uIGtleXMoaXQpewogICAgcmV0dXJuICRrZXlzKHRvT2JqZWN0KGl0KSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMy4xOSBPYmplY3Quc2V0UHJvdG90eXBlT2YoTywgcHJvdG8pCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKJGV4cG9ydCgkZXhwb3J0LlMsICdPYmplY3QnLCB7c2V0UHJvdG90eXBlT2Y6IF9fd2VicGFja19yZXF1aXJlX18oOTcpLnNldH0pOwoKLyoqKi8gfSksCi8qIDEwNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgTElCUkFSWSAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKICAsIGdsb2JhbCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGN0eCAgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCiAgLCBjbGFzc29mICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KQogICwgJGV4cG9ydCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KQogICwgaXNPYmplY3QgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KQogICwgYUZ1bmN0aW9uICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCkKICAsIGFuSW5zdGFuY2UgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODUpCiAgLCBmb3JPZiAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg3KQogICwgc3BlY2llc0NvbnN0cnVjdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5OSkKICAsIHRhc2sgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjcpLnNldAogICwgbWljcm90YXNrICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NCkoKQogICwgUFJPTUlTRSAgICAgICAgICAgID0gJ1Byb21pc2UnCiAgLCBUeXBlRXJyb3IgICAgICAgICAgPSBnbG9iYWwuVHlwZUVycm9yCiAgLCBwcm9jZXNzICAgICAgICAgICAgPSBnbG9iYWwucHJvY2VzcwogICwgJFByb21pc2UgICAgICAgICAgID0gZ2xvYmFsW1BST01JU0VdCiAgLCBwcm9jZXNzICAgICAgICAgICAgPSBnbG9iYWwucHJvY2VzcwogICwgaXNOb2RlICAgICAgICAgICAgID0gY2xhc3NvZihwcm9jZXNzKSA9PSAncHJvY2VzcycKICAsIGVtcHR5ICAgICAgICAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KICAsIEludGVybmFsLCBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHksIFdyYXBwZXI7Cgp2YXIgVVNFX05BVElWRSA9ICEhZnVuY3Rpb24oKXsKICB0cnkgewogICAgLy8gY29ycmVjdCBzdWJjbGFzc2luZyB3aXRoIEBAc3BlY2llcyBzdXBwb3J0CiAgICB2YXIgcHJvbWlzZSAgICAgPSAkUHJvbWlzZS5yZXNvbHZlKDEpCiAgICAgICwgRmFrZVByb21pc2UgPSAocHJvbWlzZS5jb25zdHJ1Y3RvciA9IHt9KVtfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdzcGVjaWVzJyldID0gZnVuY3Rpb24oZXhlYyl7IGV4ZWMoZW1wdHksIGVtcHR5KTsgfTsKICAgIC8vIHVuaGFuZGxlZCByZWplY3Rpb25zIHRyYWNraW5nIHN1cHBvcnQsIE5vZGVKUyBQcm9taXNlIHdpdGhvdXQgaXQgZmFpbHMgQEBzcGVjaWVzIHRlc3QKICAgIHJldHVybiAoaXNOb2RlIHx8IHR5cGVvZiBQcm9taXNlUmVqZWN0aW9uRXZlbnQgPT0gJ2Z1bmN0aW9uJykgJiYgcHJvbWlzZS50aGVuKGVtcHR5KSBpbnN0YW5jZW9mIEZha2VQcm9taXNlOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KfSgpOwoKLy8gaGVscGVycwp2YXIgc2FtZUNvbnN0cnVjdG9yID0gZnVuY3Rpb24oYSwgYil7CiAgLy8gd2l0aCBsaWJyYXJ5IHdyYXBwZXIgc3BlY2lhbCBjYXNlCiAgcmV0dXJuIGEgPT09IGIgfHwgYSA9PT0gJFByb21pc2UgJiYgYiA9PT0gV3JhcHBlcjsKfTsKdmFyIGlzVGhlbmFibGUgPSBmdW5jdGlvbihpdCl7CiAgdmFyIHRoZW47CiAgcmV0dXJuIGlzT2JqZWN0KGl0KSAmJiB0eXBlb2YgKHRoZW4gPSBpdC50aGVuKSA9PSAnZnVuY3Rpb24nID8gdGhlbiA6IGZhbHNlOwp9Owp2YXIgbmV3UHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbihDKXsKICByZXR1cm4gc2FtZUNvbnN0cnVjdG9yKCRQcm9taXNlLCBDKQogICAgPyBuZXcgUHJvbWlzZUNhcGFiaWxpdHkoQykKICAgIDogbmV3IEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eShDKTsKfTsKdmFyIFByb21pc2VDYXBhYmlsaXR5ID0gR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24oQyl7CiAgdmFyIHJlc29sdmUsIHJlamVjdDsKICB0aGlzLnByb21pc2UgPSBuZXcgQyhmdW5jdGlvbigkJHJlc29sdmUsICQkcmVqZWN0KXsKICAgIGlmKHJlc29sdmUgIT09IHVuZGVmaW5lZCB8fCByZWplY3QgIT09IHVuZGVmaW5lZCl0aHJvdyBUeXBlRXJyb3IoJ0JhZCBQcm9taXNlIGNvbnN0cnVjdG9yJyk7CiAgICByZXNvbHZlID0gJCRyZXNvbHZlOwogICAgcmVqZWN0ICA9ICQkcmVqZWN0OwogIH0pOwogIHRoaXMucmVzb2x2ZSA9IGFGdW5jdGlvbihyZXNvbHZlKTsKICB0aGlzLnJlamVjdCAgPSBhRnVuY3Rpb24ocmVqZWN0KTsKfTsKdmFyIHBlcmZvcm0gPSBmdW5jdGlvbihleGVjKXsKICB0cnkgewogICAgZXhlYygpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4ge2Vycm9yOiBlfTsKICB9Cn07CnZhciBub3RpZnkgPSBmdW5jdGlvbihwcm9taXNlLCBpc1JlamVjdCl7CiAgaWYocHJvbWlzZS5fbilyZXR1cm47CiAgcHJvbWlzZS5fbiA9IHRydWU7CiAgdmFyIGNoYWluID0gcHJvbWlzZS5fYzsKICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YKICAgICAgLCBvayAgICA9IHByb21pc2UuX3MgPT0gMQogICAgICAsIGkgICAgID0gMDsKICAgIHZhciBydW4gPSBmdW5jdGlvbihyZWFjdGlvbil7CiAgICAgIHZhciBoYW5kbGVyID0gb2sgPyByZWFjdGlvbi5vayA6IHJlYWN0aW9uLmZhaWwKICAgICAgICAsIHJlc29sdmUgPSByZWFjdGlvbi5yZXNvbHZlCiAgICAgICAgLCByZWplY3QgID0gcmVhY3Rpb24ucmVqZWN0CiAgICAgICAgLCBkb21haW4gID0gcmVhY3Rpb24uZG9tYWluCiAgICAgICAgLCByZXN1bHQsIHRoZW47CiAgICAgIHRyeSB7CiAgICAgICAgaWYoaGFuZGxlcil7CiAgICAgICAgICBpZighb2spewogICAgICAgICAgICBpZihwcm9taXNlLl9oID09IDIpb25IYW5kbGVVbmhhbmRsZWQocHJvbWlzZSk7CiAgICAgICAgICAgIHByb21pc2UuX2ggPSAxOwogICAgICAgICAgfQogICAgICAgICAgaWYoaGFuZGxlciA9PT0gdHJ1ZSlyZXN1bHQgPSB2YWx1ZTsKICAgICAgICAgIGVsc2UgewogICAgICAgICAgICBpZihkb21haW4pZG9tYWluLmVudGVyKCk7CiAgICAgICAgICAgIHJlc3VsdCA9IGhhbmRsZXIodmFsdWUpOwogICAgICAgICAgICBpZihkb21haW4pZG9tYWluLmV4aXQoKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmKHJlc3VsdCA9PT0gcmVhY3Rpb24ucHJvbWlzZSl7CiAgICAgICAgICAgIHJlamVjdChUeXBlRXJyb3IoJ1Byb21pc2UtY2hhaW4gY3ljbGUnKSk7CiAgICAgICAgICB9IGVsc2UgaWYodGhlbiA9IGlzVGhlbmFibGUocmVzdWx0KSl7CiAgICAgICAgICAgIHRoZW4uY2FsbChyZXN1bHQsIHJlc29sdmUsIHJlamVjdCk7CiAgICAgICAgICB9IGVsc2UgcmVzb2x2ZShyZXN1bHQpOwogICAgICAgIH0gZWxzZSByZWplY3QodmFsdWUpOwogICAgICB9IGNhdGNoKGUpewogICAgICAgIHJlamVjdChlKTsKICAgICAgfQogICAgfTsKICAgIHdoaWxlKGNoYWluLmxlbmd0aCA+IGkpcnVuKGNoYWluW2krK10pOyAvLyB2YXJpYWJsZSBsZW5ndGggLSBjYW4ndCB1c2UgZm9yRWFjaAogICAgcHJvbWlzZS5fYyA9IFtdOwogICAgcHJvbWlzZS5fbiA9IGZhbHNlOwogICAgaWYoaXNSZWplY3QgJiYgIXByb21pc2UuX2gpb25VbmhhbmRsZWQocHJvbWlzZSk7CiAgfSk7Cn07CnZhciBvblVuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2UpewogIHRhc2suY2FsbChnbG9iYWwsIGZ1bmN0aW9uKCl7CiAgICB2YXIgdmFsdWUgPSBwcm9taXNlLl92CiAgICAgICwgYWJydXB0LCBoYW5kbGVyLCBjb25zb2xlOwogICAgaWYoaXNVbmhhbmRsZWQocHJvbWlzZSkpewogICAgICBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CiAgICAgICAgaWYoaXNOb2RlKXsKICAgICAgICAgIHByb2Nlc3MuZW1pdCgndW5oYW5kbGVkUmVqZWN0aW9uJywgdmFsdWUsIHByb21pc2UpOwogICAgICAgIH0gZWxzZSBpZihoYW5kbGVyID0gZ2xvYmFsLm9udW5oYW5kbGVkcmVqZWN0aW9uKXsKICAgICAgICAgIGhhbmRsZXIoe3Byb21pc2U6IHByb21pc2UsIHJlYXNvbjogdmFsdWV9KTsKICAgICAgICB9IGVsc2UgaWYoKGNvbnNvbGUgPSBnbG9iYWwuY29uc29sZSkgJiYgY29uc29sZS5lcnJvcil7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb24nLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgLy8gQnJvd3NlcnMgc2hvdWxkIG5vdCB0cmlnZ2VyIGByZWplY3Rpb25IYW5kbGVkYCBldmVudCBpZiBpdCB3YXMgaGFuZGxlZCBoZXJlLCBOb2RlSlMgLSBzaG91bGQKICAgICAgcHJvbWlzZS5faCA9IGlzTm9kZSB8fCBpc1VuaGFuZGxlZChwcm9taXNlKSA/IDIgOiAxOwogICAgfSBwcm9taXNlLl9hID0gdW5kZWZpbmVkOwogICAgaWYoYWJydXB0KXRocm93IGFicnVwdC5lcnJvcjsKICB9KTsKfTsKdmFyIGlzVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgaWYocHJvbWlzZS5faCA9PSAxKXJldHVybiBmYWxzZTsKICB2YXIgY2hhaW4gPSBwcm9taXNlLl9hIHx8IHByb21pc2UuX2MKICAgICwgaSAgICAgPSAwCiAgICAsIHJlYWN0aW9uOwogIHdoaWxlKGNoYWluLmxlbmd0aCA+IGkpewogICAgcmVhY3Rpb24gPSBjaGFpbltpKytdOwogICAgaWYocmVhY3Rpb24uZmFpbCB8fCAhaXNVbmhhbmRsZWQocmVhY3Rpb24ucHJvbWlzZSkpcmV0dXJuIGZhbHNlOwogIH0gcmV0dXJuIHRydWU7Cn07CnZhciBvbkhhbmRsZVVuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2UpewogIHRhc2suY2FsbChnbG9iYWwsIGZ1bmN0aW9uKCl7CiAgICB2YXIgaGFuZGxlcjsKICAgIGlmKGlzTm9kZSl7CiAgICAgIHByb2Nlc3MuZW1pdCgncmVqZWN0aW9uSGFuZGxlZCcsIHByb21pc2UpOwogICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub25yZWplY3Rpb25oYW5kbGVkKXsKICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiBwcm9taXNlLl92fSk7CiAgICB9CiAgfSk7Cn07CnZhciAkcmVqZWN0ID0gZnVuY3Rpb24odmFsdWUpewogIHZhciBwcm9taXNlID0gdGhpczsKICBpZihwcm9taXNlLl9kKXJldHVybjsKICBwcm9taXNlLl9kID0gdHJ1ZTsKICBwcm9taXNlID0gcHJvbWlzZS5fdyB8fCBwcm9taXNlOyAvLyB1bndyYXAKICBwcm9taXNlLl92ID0gdmFsdWU7CiAgcHJvbWlzZS5fcyA9IDI7CiAgaWYoIXByb21pc2UuX2EpcHJvbWlzZS5fYSA9IHByb21pc2UuX2Muc2xpY2UoKTsKICBub3RpZnkocHJvbWlzZSwgdHJ1ZSk7Cn07CnZhciAkcmVzb2x2ZSA9IGZ1bmN0aW9uKHZhbHVlKXsKICB2YXIgcHJvbWlzZSA9IHRoaXMKICAgICwgdGhlbjsKICBpZihwcm9taXNlLl9kKXJldHVybjsKICBwcm9taXNlLl9kID0gdHJ1ZTsKICBwcm9taXNlID0gcHJvbWlzZS5fdyB8fCBwcm9taXNlOyAvLyB1bndyYXAKICB0cnkgewogICAgaWYocHJvbWlzZSA9PT0gdmFsdWUpdGhyb3cgVHlwZUVycm9yKCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZiIpOwogICAgaWYodGhlbiA9IGlzVGhlbmFibGUodmFsdWUpKXsKICAgICAgbWljcm90YXNrKGZ1bmN0aW9uKCl7CiAgICAgICAgdmFyIHdyYXBwZXIgPSB7X3c6IHByb21pc2UsIF9kOiBmYWxzZX07IC8vIHdyYXAKICAgICAgICB0cnkgewogICAgICAgICAgdGhlbi5jYWxsKHZhbHVlLCBjdHgoJHJlc29sdmUsIHdyYXBwZXIsIDEpLCBjdHgoJHJlamVjdCwgd3JhcHBlciwgMSkpOwogICAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgICAkcmVqZWN0LmNhbGwod3JhcHBlciwgZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHByb21pc2UuX3YgPSB2YWx1ZTsKICAgICAgcHJvbWlzZS5fcyA9IDE7CiAgICAgIG5vdGlmeShwcm9taXNlLCBmYWxzZSk7CiAgICB9CiAgfSBjYXRjaChlKXsKICAgICRyZWplY3QuY2FsbCh7X3c6IHByb21pc2UsIF9kOiBmYWxzZX0sIGUpOyAvLyB3cmFwCiAgfQp9OwoKLy8gY29uc3RydWN0b3IgcG9seWZpbGwKaWYoIVVTRV9OQVRJVkUpewogIC8vIDI1LjQuMy4xIFByb21pc2UoZXhlY3V0b3IpCiAgJFByb21pc2UgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKICAgIGFuSW5zdGFuY2UodGhpcywgJFByb21pc2UsIFBST01JU0UsICdfaCcpOwogICAgYUZ1bmN0aW9uKGV4ZWN1dG9yKTsKICAgIEludGVybmFsLmNhbGwodGhpcyk7CiAgICB0cnkgewogICAgICBleGVjdXRvcihjdHgoJHJlc29sdmUsIHRoaXMsIDEpLCBjdHgoJHJlamVjdCwgdGhpcywgMSkpOwogICAgfSBjYXRjaChlcnIpewogICAgICAkcmVqZWN0LmNhbGwodGhpcywgZXJyKTsKICAgIH0KICB9OwogIEludGVybmFsID0gZnVuY3Rpb24gUHJvbWlzZShleGVjdXRvcil7CiAgICB0aGlzLl9jID0gW107ICAgICAgICAgICAgIC8vIDwtIGF3YWl0aW5nIHJlYWN0aW9ucwogICAgdGhpcy5fYSA9IHVuZGVmaW5lZDsgICAgICAvLyA8LSBjaGVja2VkIGluIGlzVW5oYW5kbGVkIHJlYWN0aW9ucwogICAgdGhpcy5fcyA9IDA7ICAgICAgICAgICAgICAvLyA8LSBzdGF0ZQogICAgdGhpcy5fZCA9IGZhbHNlOyAgICAgICAgICAvLyA8LSBkb25lCiAgICB0aGlzLl92ID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIHZhbHVlCiAgICB0aGlzLl9oID0gMDsgICAgICAgICAgICAgIC8vIDwtIHJlamVjdGlvbiBzdGF0ZSwgMCAtIGRlZmF1bHQsIDEgLSBoYW5kbGVkLCAyIC0gdW5oYW5kbGVkCiAgICB0aGlzLl9uID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIG5vdGlmeQogIH07CiAgSW50ZXJuYWwucHJvdG90eXBlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NikoJFByb21pc2UucHJvdG90eXBlLCB7CiAgICAvLyAyNS40LjUuMyBQcm9taXNlLnByb3RvdHlwZS50aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKQogICAgdGhlbjogZnVuY3Rpb24gdGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCl7CiAgICAgIHZhciByZWFjdGlvbiAgICA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHNwZWNpZXNDb25zdHJ1Y3Rvcih0aGlzLCAkUHJvbWlzZSkpOwogICAgICByZWFjdGlvbi5vayAgICAgPSB0eXBlb2Ygb25GdWxmaWxsZWQgPT0gJ2Z1bmN0aW9uJyA/IG9uRnVsZmlsbGVkIDogdHJ1ZTsKICAgICAgcmVhY3Rpb24uZmFpbCAgID0gdHlwZW9mIG9uUmVqZWN0ZWQgPT0gJ2Z1bmN0aW9uJyAmJiBvblJlamVjdGVkOwogICAgICByZWFjdGlvbi5kb21haW4gPSBpc05vZGUgPyBwcm9jZXNzLmRvbWFpbiA6IHVuZGVmaW5lZDsKICAgICAgdGhpcy5fYy5wdXNoKHJlYWN0aW9uKTsKICAgICAgaWYodGhpcy5fYSl0aGlzLl9hLnB1c2gocmVhY3Rpb24pOwogICAgICBpZih0aGlzLl9zKW5vdGlmeSh0aGlzLCBmYWxzZSk7CiAgICAgIHJldHVybiByZWFjdGlvbi5wcm9taXNlOwogICAgfSwKICAgIC8vIDI1LjQuNS4xIFByb21pc2UucHJvdG90eXBlLmNhdGNoKG9uUmVqZWN0ZWQpCiAgICAnY2F0Y2gnOiBmdW5jdGlvbihvblJlamVjdGVkKXsKICAgICAgcmV0dXJuIHRoaXMudGhlbih1bmRlZmluZWQsIG9uUmVqZWN0ZWQpOwogICAgfQogIH0pOwogIFByb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24oKXsKICAgIHZhciBwcm9taXNlICA9IG5ldyBJbnRlcm5hbDsKICAgIHRoaXMucHJvbWlzZSA9IHByb21pc2U7CiAgICB0aGlzLnJlc29sdmUgPSBjdHgoJHJlc29sdmUsIHByb21pc2UsIDEpOwogICAgdGhpcy5yZWplY3QgID0gY3R4KCRyZWplY3QsIHByb21pc2UsIDEpOwogIH07Cn0KCiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtQcm9taXNlOiAkUHJvbWlzZX0pOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKSgkUHJvbWlzZSwgUFJPTUlTRSk7Cl9fd2VicGFja19yZXF1aXJlX18oOTgpKFBST01JU0UpOwpXcmFwcGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKVtQUk9NSVNFXTsKCi8vIHN0YXRpY3MKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgUFJPTUlTRSwgewogIC8vIDI1LjQuNC41IFByb21pc2UucmVqZWN0KHIpCiAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3Qocil7CiAgICB2YXIgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHRoaXMpCiAgICAgICwgJCRyZWplY3QgICA9IGNhcGFiaWxpdHkucmVqZWN0OwogICAgJCRyZWplY3Qocik7CiAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwogIH0KfSk7CiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKExJQlJBUlkgfHwgIVVTRV9OQVRJVkUpLCBQUk9NSVNFLCB7CiAgLy8gMjUuNC40LjYgUHJvbWlzZS5yZXNvbHZlKHgpCiAgcmVzb2x2ZTogZnVuY3Rpb24gcmVzb2x2ZSh4KXsKICAgIC8vIGluc3RhbmNlb2YgaW5zdGVhZCBvZiBpbnRlcm5hbCBzbG90IGNoZWNrIGJlY2F1c2Ugd2Ugc2hvdWxkIGZpeCBpdCB3aXRob3V0IHJlcGxhY2VtZW50IG5hdGl2ZSBQcm9taXNlIGNvcmUKICAgIGlmKHggaW5zdGFuY2VvZiAkUHJvbWlzZSAmJiBzYW1lQ29uc3RydWN0b3IoeC5jb25zdHJ1Y3RvciwgdGhpcykpcmV0dXJuIHg7CiAgICB2YXIgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHRoaXMpCiAgICAgICwgJCRyZXNvbHZlICA9IGNhcGFiaWxpdHkucmVzb2x2ZTsKICAgICQkcmVzb2x2ZSh4KTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQp9KTsKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhKFVTRV9OQVRJVkUgJiYgX193ZWJwYWNrX3JlcXVpcmVfXyg5MikoZnVuY3Rpb24oaXRlcil7CiAgJFByb21pc2UuYWxsKGl0ZXIpWydjYXRjaCddKGVtcHR5KTsKfSkpLCBQUk9NSVNFLCB7CiAgLy8gMjUuNC40LjEgUHJvbWlzZS5hbGwoaXRlcmFibGUpCiAgYWxsOiBmdW5jdGlvbiBhbGwoaXRlcmFibGUpewogICAgdmFyIEMgICAgICAgICAgPSB0aGlzCiAgICAgICwgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KEMpCiAgICAgICwgcmVzb2x2ZSAgICA9IGNhcGFiaWxpdHkucmVzb2x2ZQogICAgICAsIHJlamVjdCAgICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CiAgICAgIHZhciB2YWx1ZXMgICAgPSBbXQogICAgICAgICwgaW5kZXggICAgID0gMAogICAgICAgICwgcmVtYWluaW5nID0gMTsKICAgICAgZm9yT2YoaXRlcmFibGUsIGZhbHNlLCBmdW5jdGlvbihwcm9taXNlKXsKICAgICAgICB2YXIgJGluZGV4ICAgICAgICA9IGluZGV4KysKICAgICAgICAgICwgYWxyZWFkeUNhbGxlZCA9IGZhbHNlOwogICAgICAgIHZhbHVlcy5wdXNoKHVuZGVmaW5lZCk7CiAgICAgICAgcmVtYWluaW5nKys7CiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oZnVuY3Rpb24odmFsdWUpewogICAgICAgICAgaWYoYWxyZWFkeUNhbGxlZClyZXR1cm47CiAgICAgICAgICBhbHJlYWR5Q2FsbGVkICA9IHRydWU7CiAgICAgICAgICB2YWx1ZXNbJGluZGV4XSA9IHZhbHVlOwogICAgICAgICAgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpOwogICAgICAgIH0sIHJlamVjdCk7CiAgICAgIH0pOwogICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICB9KTsKICAgIGlmKGFicnVwdClyZWplY3QoYWJydXB0LmVycm9yKTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfSwKICAvLyAyNS40LjQuNCBQcm9taXNlLnJhY2UoaXRlcmFibGUpCiAgcmFjZTogZnVuY3Rpb24gcmFjZShpdGVyYWJsZSl7CiAgICB2YXIgQyAgICAgICAgICA9IHRoaXMKICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKICAgICAgLCByZWplY3QgICAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgICB2YXIgYWJydXB0ID0gcGVyZm9ybShmdW5jdGlvbigpewogICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2UpewogICAgICAgIEMucmVzb2x2ZShwcm9taXNlKS50aGVuKGNhcGFiaWxpdHkucmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgfSk7CiAgICB9KTsKICAgIGlmKGFicnVwdClyZWplY3QoYWJydXB0LmVycm9yKTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQp9KTsKCi8qKiovIH0pLAovKiAxMDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKLy8gRUNNQVNjcmlwdCA2IHN5bWJvbHMgc2hpbQp2YXIgZ2xvYmFsICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBoYXMgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBERVNDUklQVE9SUyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMykKICAsICRleHBvcnQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KQogICwgcmVkZWZpbmUgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ2KQogICwgTUVUQSAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcyKS5LRVkKICAsICRmYWlscyAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSkKICAsIHNoYXJlZCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIHVpZCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykKICAsIHdrcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKQogICwgd2tzRXh0ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KQogICwgd2tzRGVmaW5lICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ4KQogICwga2V5T2YgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkzKQogICwgZW51bUtleXMgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg2KQogICwgaXNBcnJheSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkwKQogICwgYW5PYmplY3QgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCB0b0lPYmplY3QgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCB0b1ByaW1pdGl2ZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjIpCiAgLCBjcmVhdGVEZXNjICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCiAgLCBfY3JlYXRlICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpCiAgLCBnT1BORXh0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTUpCiAgLCAkR09QRCAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTcpCiAgLCAkRFAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKICAsICRrZXlzICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykKICAsIGdPUEQgICAgICAgICAgID0gJEdPUEQuZgogICwgZFAgICAgICAgICAgICAgPSAkRFAuZgogICwgZ09QTiAgICAgICAgICAgPSBnT1BORXh0LmYKICAsICRTeW1ib2wgICAgICAgID0gZ2xvYmFsLlN5bWJvbAogICwgJEpTT04gICAgICAgICAgPSBnbG9iYWwuSlNPTgogICwgX3N0cmluZ2lmeSAgICAgPSAkSlNPTiAmJiAkSlNPTi5zdHJpbmdpZnkKICAsIFBST1RPVFlQRSAgICAgID0gJ3Byb3RvdHlwZScKICAsIEhJRERFTiAgICAgICAgID0gd2tzKCdfaGlkZGVuJykKICAsIFRPX1BSSU1JVElWRSAgID0gd2tzKCd0b1ByaW1pdGl2ZScpCiAgLCBpc0VudW0gICAgICAgICA9IHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlCiAgLCBTeW1ib2xSZWdpc3RyeSA9IHNoYXJlZCgnc3ltYm9sLXJlZ2lzdHJ5JykKICAsIEFsbFN5bWJvbHMgICAgID0gc2hhcmVkKCdzeW1ib2xzJykKICAsIE9QU3ltYm9scyAgICAgID0gc2hhcmVkKCdvcC1zeW1ib2xzJykKICAsIE9iamVjdFByb3RvICAgID0gT2JqZWN0W1BST1RPVFlQRV0KICAsIFVTRV9OQVRJVkUgICAgID0gdHlwZW9mICRTeW1ib2wgPT0gJ2Z1bmN0aW9uJwogICwgUU9iamVjdCAgICAgICAgPSBnbG9iYWwuUU9iamVjdDsKLy8gRG9uJ3QgdXNlIHNldHRlcnMgaW4gUXQgU2NyaXB0LCBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvMTczCnZhciBzZXR0ZXIgPSAhUU9iamVjdCB8fCAhUU9iamVjdFtQUk9UT1RZUEVdIHx8ICFRT2JqZWN0W1BST1RPVFlQRV0uZmluZENoaWxkOwoKLy8gZmFsbGJhY2sgZm9yIG9sZCBBbmRyb2lkLCBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9Njg3CnZhciBzZXRTeW1ib2xEZXNjID0gREVTQ1JJUFRPUlMgJiYgJGZhaWxzKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIF9jcmVhdGUoZFAoe30sICdhJywgewogICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gZFAodGhpcywgJ2EnLCB7dmFsdWU6IDd9KS5hOyB9CiAgfSkpLmEgIT0gNzsKfSkgPyBmdW5jdGlvbihpdCwga2V5LCBEKXsKICB2YXIgcHJvdG9EZXNjID0gZ09QRChPYmplY3RQcm90bywga2V5KTsKICBpZihwcm90b0Rlc2MpZGVsZXRlIE9iamVjdFByb3RvW2tleV07CiAgZFAoaXQsIGtleSwgRCk7CiAgaWYocHJvdG9EZXNjICYmIGl0ICE9PSBPYmplY3RQcm90bylkUChPYmplY3RQcm90bywga2V5LCBwcm90b0Rlc2MpOwp9IDogZFA7Cgp2YXIgd3JhcCA9IGZ1bmN0aW9uKHRhZyl7CiAgdmFyIHN5bSA9IEFsbFN5bWJvbHNbdGFnXSA9IF9jcmVhdGUoJFN5bWJvbFtQUk9UT1RZUEVdKTsKICBzeW0uX2sgPSB0YWc7CiAgcmV0dXJuIHN5bTsKfTsKCnZhciBpc1N5bWJvbCA9IFVTRV9OQVRJVkUgJiYgdHlwZW9mICRTeW1ib2wuaXRlcmF0b3IgPT0gJ3N5bWJvbCcgPyBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIHR5cGVvZiBpdCA9PSAnc3ltYm9sJzsKfSA6IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXQgaW5zdGFuY2VvZiAkU3ltYm9sOwp9OwoKdmFyICRkZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KGl0LCBrZXksIEQpewogIGlmKGl0ID09PSBPYmplY3RQcm90bykkZGVmaW5lUHJvcGVydHkoT1BTeW1ib2xzLCBrZXksIEQpOwogIGFuT2JqZWN0KGl0KTsKICBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpOwogIGFuT2JqZWN0KEQpOwogIGlmKGhhcyhBbGxTeW1ib2xzLCBrZXkpKXsKICAgIGlmKCFELmVudW1lcmFibGUpewogICAgICBpZighaGFzKGl0LCBISURERU4pKWRQKGl0LCBISURERU4sIGNyZWF0ZURlc2MoMSwge30pKTsKICAgICAgaXRbSElEREVOXVtrZXldID0gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIGlmKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0paXRbSElEREVOXVtrZXldID0gZmFsc2U7CiAgICAgIEQgPSBfY3JlYXRlKEQsIHtlbnVtZXJhYmxlOiBjcmVhdGVEZXNjKDAsIGZhbHNlKX0pOwogICAgfSByZXR1cm4gc2V0U3ltYm9sRGVzYyhpdCwga2V5LCBEKTsKICB9IHJldHVybiBkUChpdCwga2V5LCBEKTsKfTsKdmFyICRkZWZpbmVQcm9wZXJ0aWVzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyhpdCwgUCl7CiAgYW5PYmplY3QoaXQpOwogIHZhciBrZXlzID0gZW51bUtleXMoUCA9IHRvSU9iamVjdChQKSkKICAgICwgaSAgICA9IDAKICAgICwgbCA9IGtleXMubGVuZ3RoCiAgICAsIGtleTsKICB3aGlsZShsID4gaSkkZGVmaW5lUHJvcGVydHkoaXQsIGtleSA9IGtleXNbaSsrXSwgUFtrZXldKTsKICByZXR1cm4gaXQ7Cn07CnZhciAkY3JlYXRlID0gZnVuY3Rpb24gY3JlYXRlKGl0LCBQKXsKICByZXR1cm4gUCA9PT0gdW5kZWZpbmVkID8gX2NyZWF0ZShpdCkgOiAkZGVmaW5lUHJvcGVydGllcyhfY3JlYXRlKGl0KSwgUCk7Cn07CnZhciAkcHJvcGVydHlJc0VudW1lcmFibGUgPSBmdW5jdGlvbiBwcm9wZXJ0eUlzRW51bWVyYWJsZShrZXkpewogIHZhciBFID0gaXNFbnVtLmNhbGwodGhpcywga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKSk7CiAgaWYodGhpcyA9PT0gT2JqZWN0UHJvdG8gJiYgaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIWhhcyhPUFN5bWJvbHMsIGtleSkpcmV0dXJuIGZhbHNlOwogIHJldHVybiBFIHx8ICFoYXModGhpcywga2V5KSB8fCAhaGFzKEFsbFN5bWJvbHMsIGtleSkgfHwgaGFzKHRoaXMsIEhJRERFTikgJiYgdGhpc1tISURERU5dW2tleV0gPyBFIDogdHJ1ZTsKfTsKdmFyICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7CiAgaXQgID0gdG9JT2JqZWN0KGl0KTsKICBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpOwogIGlmKGl0ID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSlyZXR1cm47CiAgdmFyIEQgPSBnT1BEKGl0LCBrZXkpOwogIGlmKEQgJiYgaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIShoYXMoaXQsIEhJRERFTikgJiYgaXRbSElEREVOXVtrZXldKSlELmVudW1lcmFibGUgPSB0cnVlOwogIHJldHVybiBEOwp9Owp2YXIgJGdldE93blByb3BlcnR5TmFtZXMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKGl0KXsKICB2YXIgbmFtZXMgID0gZ09QTih0b0lPYmplY3QoaXQpKQogICAgLCByZXN1bHQgPSBbXQogICAgLCBpICAgICAgPSAwCiAgICAsIGtleTsKICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKXsKICAgIGlmKCFoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYga2V5ICE9IEhJRERFTiAmJiBrZXkgIT0gTUVUQSlyZXN1bHQucHVzaChrZXkpOwogIH0gcmV0dXJuIHJlc3VsdDsKfTsKdmFyICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMoaXQpewogIHZhciBJU19PUCAgPSBpdCA9PT0gT2JqZWN0UHJvdG8KICAgICwgbmFtZXMgID0gZ09QTihJU19PUCA/IE9QU3ltYm9scyA6IHRvSU9iamVjdChpdCkpCiAgICAsIHJlc3VsdCA9IFtdCiAgICAsIGkgICAgICA9IDAKICAgICwga2V5OwogIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewogICAgaWYoaGFzKEFsbFN5bWJvbHMsIGtleSA9IG5hbWVzW2krK10pICYmIChJU19PUCA/IGhhcyhPYmplY3RQcm90bywga2V5KSA6IHRydWUpKXJlc3VsdC5wdXNoKEFsbFN5bWJvbHNba2V5XSk7CiAgfSByZXR1cm4gcmVzdWx0Owp9OwoKLy8gMTkuNC4xLjEgU3ltYm9sKFtkZXNjcmlwdGlvbl0pCmlmKCFVU0VfTkFUSVZFKXsKICAkU3ltYm9sID0gZnVuY3Rpb24gU3ltYm9sKCl7CiAgICBpZih0aGlzIGluc3RhbmNlb2YgJFN5bWJvbCl0aHJvdyBUeXBlRXJyb3IoJ1N5bWJvbCBpcyBub3QgYSBjb25zdHJ1Y3RvciEnKTsKICAgIHZhciB0YWcgPSB1aWQoYXJndW1lbnRzLmxlbmd0aCA+IDAgPyBhcmd1bWVudHNbMF0gOiB1bmRlZmluZWQpOwogICAgdmFyICRzZXQgPSBmdW5jdGlvbih2YWx1ZSl7CiAgICAgIGlmKHRoaXMgPT09IE9iamVjdFByb3RvKSRzZXQuY2FsbChPUFN5bWJvbHMsIHZhbHVlKTsKICAgICAgaWYoaGFzKHRoaXMsIEhJRERFTikgJiYgaGFzKHRoaXNbSElEREVOXSwgdGFnKSl0aGlzW0hJRERFTl1bdGFnXSA9IGZhbHNlOwogICAgICBzZXRTeW1ib2xEZXNjKHRoaXMsIHRhZywgY3JlYXRlRGVzYygxLCB2YWx1ZSkpOwogICAgfTsKICAgIGlmKERFU0NSSVBUT1JTICYmIHNldHRlcilzZXRTeW1ib2xEZXNjKE9iamVjdFByb3RvLCB0YWcsIHtjb25maWd1cmFibGU6IHRydWUsIHNldDogJHNldH0pOwogICAgcmV0dXJuIHdyYXAodGFnKTsKICB9OwogIHJlZGVmaW5lKCRTeW1ib2xbUFJPVE9UWVBFXSwgJ3RvU3RyaW5nJywgZnVuY3Rpb24gdG9TdHJpbmcoKXsKICAgIHJldHVybiB0aGlzLl9rOwogIH0pOwoKICAkR09QRC5mID0gJGdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKICAkRFAuZiAgID0gJGRlZmluZVByb3BlcnR5OwogIF9fd2VicGFja19yZXF1aXJlX18oNjUpLmYgPSBnT1BORXh0LmYgPSAkZ2V0T3duUHJvcGVydHlOYW1lczsKICBfX3dlYnBhY2tfcmVxdWlyZV9fKDQxKS5mICA9ICRwcm9wZXJ0eUlzRW51bWVyYWJsZTsKICBfX3dlYnBhY2tfcmVxdWlyZV9fKDU4KS5mID0gJGdldE93blByb3BlcnR5U3ltYm9sczsKCiAgaWYoREVTQ1JJUFRPUlMgJiYgIV9fd2VicGFja19yZXF1aXJlX18oMjUpKXsKICAgIHJlZGVmaW5lKE9iamVjdFByb3RvLCAncHJvcGVydHlJc0VudW1lcmFibGUnLCAkcHJvcGVydHlJc0VudW1lcmFibGUsIHRydWUpOwogIH0KCiAgd2tzRXh0LmYgPSBmdW5jdGlvbihuYW1lKXsKICAgIHJldHVybiB3cmFwKHdrcyhuYW1lKSk7CiAgfQp9CgokZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuVyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCB7U3ltYm9sOiAkU3ltYm9sfSk7Cgpmb3IodmFyIHN5bWJvbHMgPSAoCiAgLy8gMTkuNC4yLjIsIDE5LjQuMi4zLCAxOS40LjIuNCwgMTkuNC4yLjYsIDE5LjQuMi44LCAxOS40LjIuOSwgMTkuNC4yLjEwLCAxOS40LjIuMTEsIDE5LjQuMi4xMiwgMTkuNC4yLjEzLCAxOS40LjIuMTQKICAnaGFzSW5zdGFuY2UsaXNDb25jYXRTcHJlYWRhYmxlLGl0ZXJhdG9yLG1hdGNoLHJlcGxhY2Usc2VhcmNoLHNwZWNpZXMsc3BsaXQsdG9QcmltaXRpdmUsdG9TdHJpbmdUYWcsdW5zY29wYWJsZXMnCikuc3BsaXQoJywnKSwgaSA9IDA7IHN5bWJvbHMubGVuZ3RoID4gaTsgKXdrcyhzeW1ib2xzW2krK10pOwoKZm9yKHZhciBzeW1ib2xzID0gJGtleXMod2tzLnN0b3JlKSwgaSA9IDA7IHN5bWJvbHMubGVuZ3RoID4gaTsgKXdrc0RlZmluZShzeW1ib2xzW2krK10pOwoKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgJ1N5bWJvbCcsIHsKICAvLyAxOS40LjIuMSBTeW1ib2wuZm9yKGtleSkKICAnZm9yJzogZnVuY3Rpb24oa2V5KXsKICAgIHJldHVybiBoYXMoU3ltYm9sUmVnaXN0cnksIGtleSArPSAnJykKICAgICAgPyBTeW1ib2xSZWdpc3RyeVtrZXldCiAgICAgIDogU3ltYm9sUmVnaXN0cnlba2V5XSA9ICRTeW1ib2woa2V5KTsKICB9LAogIC8vIDE5LjQuMi41IFN5bWJvbC5rZXlGb3Ioc3ltKQogIGtleUZvcjogZnVuY3Rpb24ga2V5Rm9yKGtleSl7CiAgICBpZihpc1N5bWJvbChrZXkpKXJldHVybiBrZXlPZihTeW1ib2xSZWdpc3RyeSwga2V5KTsKICAgIHRocm93IFR5cGVFcnJvcihrZXkgKyAnIGlzIG5vdCBhIHN5bWJvbCEnKTsKICB9LAogIHVzZVNldHRlcjogZnVuY3Rpb24oKXsgc2V0dGVyID0gdHJ1ZTsgfSwKICB1c2VTaW1wbGU6IGZ1bmN0aW9uKCl7IHNldHRlciA9IGZhbHNlOyB9Cn0pOwoKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgJ09iamVjdCcsIHsKICAvLyAxOS4xLjIuMiBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCiAgY3JlYXRlOiAkY3JlYXRlLAogIC8vIDE5LjEuMi40IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKQogIGRlZmluZVByb3BlcnR5OiAkZGVmaW5lUHJvcGVydHksCiAgLy8gMTkuMS4yLjMgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcykKICBkZWZpbmVQcm9wZXJ0aWVzOiAkZGVmaW5lUHJvcGVydGllcywKICAvLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApCiAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLAogIC8vIDE5LjEuMi43IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKE8pCiAgZ2V0T3duUHJvcGVydHlOYW1lczogJGdldE93blByb3BlcnR5TmFtZXMsCiAgLy8gMTkuMS4yLjggT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhPKQogIGdldE93blByb3BlcnR5U3ltYm9sczogJGdldE93blByb3BlcnR5U3ltYm9scwp9KTsKCi8vIDI0LjMuMiBKU09OLnN0cmluZ2lmeSh2YWx1ZSBbLCByZXBsYWNlciBbLCBzcGFjZV1dKQokSlNPTiAmJiAkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICghVVNFX05BVElWRSB8fCAkZmFpbHMoZnVuY3Rpb24oKXsKICB2YXIgUyA9ICRTeW1ib2woKTsKICAvLyBNUyBFZGdlIGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyB7fQogIC8vIFdlYktpdCBjb252ZXJ0cyBzeW1ib2wgdmFsdWVzIHRvIEpTT04gYXMgbnVsbAogIC8vIFY4IHRocm93cyBvbiBib3hlZCBzeW1ib2xzCiAgcmV0dXJuIF9zdHJpbmdpZnkoW1NdKSAhPSAnW251bGxdJyB8fCBfc3RyaW5naWZ5KHthOiBTfSkgIT0gJ3t9JyB8fCBfc3RyaW5naWZ5KE9iamVjdChTKSkgIT0gJ3t9JzsKfSkpLCAnSlNPTicsIHsKICBzdHJpbmdpZnk6IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7CiAgICBpZihpdCA9PT0gdW5kZWZpbmVkIHx8IGlzU3ltYm9sKGl0KSlyZXR1cm47IC8vIElFOCByZXR1cm5zIHN0cmluZyBvbiB1bmRlZmluZWQKICAgIHZhciBhcmdzID0gW2l0XQogICAgICAsIGkgICAgPSAxCiAgICAgICwgcmVwbGFjZXIsICRyZXBsYWNlcjsKICAgIHdoaWxlKGFyZ3VtZW50cy5sZW5ndGggPiBpKWFyZ3MucHVzaChhcmd1bWVudHNbaSsrXSk7CiAgICByZXBsYWNlciA9IGFyZ3NbMV07CiAgICBpZih0eXBlb2YgcmVwbGFjZXIgPT0gJ2Z1bmN0aW9uJykkcmVwbGFjZXIgPSByZXBsYWNlcjsKICAgIGlmKCRyZXBsYWNlciB8fCAhaXNBcnJheShyZXBsYWNlcikpcmVwbGFjZXIgPSBmdW5jdGlvbihrZXksIHZhbHVlKXsKICAgICAgaWYoJHJlcGxhY2VyKXZhbHVlID0gJHJlcGxhY2VyLmNhbGwodGhpcywga2V5LCB2YWx1ZSk7CiAgICAgIGlmKCFpc1N5bWJvbCh2YWx1ZSkpcmV0dXJuIHZhbHVlOwogICAgfTsKICAgIGFyZ3NbMV0gPSByZXBsYWNlcjsKICAgIHJldHVybiBfc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmdzKTsKICB9Cn0pOwoKLy8gMTkuNC4zLjQgU3ltYm9sLnByb3RvdHlwZVtAQHRvUHJpbWl0aXZlXShoaW50KQokU3ltYm9sW1BST1RPVFlQRV1bVE9fUFJJTUlUSVZFXSB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpKCRTeW1ib2xbUFJPVE9UWVBFXSwgVE9fUFJJTUlUSVZFLCAkU3ltYm9sW1BST1RPVFlQRV0udmFsdWVPZik7Ci8vIDE5LjQuMy41IFN5bWJvbC5wcm90b3R5cGVbQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoJFN5bWJvbCwgJ1N5bWJvbCcpOwovLyAyMC4yLjEuOSBNYXRoW0BAdG9TdHJpbmdUYWddCnNldFRvU3RyaW5nVGFnKE1hdGgsICdNYXRoJywgdHJ1ZSk7Ci8vIDI0LjMuMyBKU09OW0BAdG9TdHJpbmdUYWddCnNldFRvU3RyaW5nVGFnKGdsb2JhbC5KU09OLCAnSlNPTicsIHRydWUpOwoKLyoqKi8gfSksCi8qIDEwNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ4KSgnYXN5bmNJdGVyYXRvcicpOwoKLyoqKi8gfSksCi8qIDEwNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ4KSgnb2JzZXJ2YWJsZScpOwoKLyoqKi8gfSksCi8qIDEwOCAqLywKLyogMTA5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX3N0cmluZ2lmeSA9IF9fd2VicGFja19yZXF1aXJlX18oNDApOwoKdmFyIF9zdHJpbmdpZnkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3RyaW5naWZ5KTsKCnZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKZXhwb3J0cy5kaXZpZGVVUkwgPSBkaXZpZGVVUkw7CmV4cG9ydHMuZGl2aWRlRW1haWwgPSBkaXZpZGVFbWFpbDsKZXhwb3J0cy5lbXB0eU9iamVjdCA9IGVtcHR5T2JqZWN0OwpleHBvcnRzLmRlZXBDbG9uZSA9IGRlZXBDbG9uZTsKZXhwb3J0cy5nZXRVc2VyVVJMRnJvbUVtYWlsID0gZ2V0VXNlclVSTEZyb21FbWFpbDsKZXhwb3J0cy5nZXRVc2VyRW1haWxGcm9tVVJMID0gZ2V0VXNlckVtYWlsRnJvbVVSTDsKZXhwb3J0cy5jb252ZXJ0VG9Vc2VyVVJMID0gY29udmVydFRvVXNlclVSTDsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KLyoqCiAqIFN1cHBvcnQgbW9kdWxlIHdpdGggc29tZSBmdW5jdGlvbnMgd2lsbCBiZSB1c2VmdWwKICogQG1vZHVsZSB1dGlscwogKi8KCi8qKgogKiBAdHlwZWRlZiBkaXZpZGVVUkwKICogQHR5cGUgT2JqZWN0CiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB0eXBlIFRoZSB0eXBlIG9mIFVSTAogKiBAcHJvcGVydHkge3N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gb2YgVVJMCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZGVudGl0eSBUaGUgaWRlbnRpdHkgb2YgVVJMCiAqLwoKLyoqCiAqIERpdmlkZSBhbiB1cmwgaW4gdHlwZSwgZG9tYWluIGFuZCBpZGVudGl0eQogKiBAcGFyYW0gIHtVUkwuVVJMfSB1cmwgLSB1cmwgYWRkcmVzcwogKiBAcmV0dXJuIHtkaXZpZGVVUkx9IHRoZSByZXN1bHQgb2YgZGl2aWRlVVJMCiAqLwpmdW5jdGlvbiBkaXZpZGVVUkwodXJsKSB7CgogIGlmICghdXJsKSB0aHJvdyBFcnJvcignVVJMIGlzIG5lZWRlZCB0byBzcGxpdCcpOwoKICBmdW5jdGlvbiByZWN1cnNlKHZhbHVlKSB7CiAgICB2YXIgcmVnZXggPSAvKFthLXpBLVotXSopKDpcL1wvKD86XC4pP3w6KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fSkoWy1hLXpBLVowLTlAOiUuX1wrfiM9XC9dKikvZ2k7CiAgICB2YXIgc3Vic3QgPSAnJDEsJDMsJDQnOwogICAgdmFyIHBhcnRzID0gdmFsdWUucmVwbGFjZShyZWdleCwgc3Vic3QpLnNwbGl0KCcsJyk7CiAgICByZXR1cm4gcGFydHM7CiAgfQoKICB2YXIgcGFydHMgPSByZWN1cnNlKHVybCk7CgogIC8vIElmIHRoZSB1cmwgaGFzIG5vIHNjaGVtZQogIGlmIChwYXJ0c1swXSA9PT0gdXJsICYmICFwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CgogICAgdmFyIF9yZXN1bHQgPSB7CiAgICAgIHR5cGU6ICIiLAogICAgICBkb21haW46IHVybCwKICAgICAgaWRlbnRpdHk6ICIiCiAgICB9OwoKICAgIGNvbnNvbGUuZXJyb3IoJ1tEaXZpZGVVUkxdIERpdmlkZVVSTCBkb25cJ3Qgc3VwcG9ydCB1cmwgd2l0aG91dCBzY2hlbWUuIFBsZWFzZSByZXZpZXcgeW91ciB1cmwgYWRkcmVzcycsIHVybCk7CgogICAgcmV0dXJuIF9yZXN1bHQ7CiAgfQoKICAvLyBjaGVjayBpZiB0aGUgdXJsIGhhcyB0aGUgc2NoZW1lIGFuZCBpbmNsdWRlcyBhbiBACiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgcGFydHNbMF0uaW5jbHVkZXMoJ0AnKSkgewogICAgdmFyIHNjaGVtZSA9IHBhcnRzWzBdID09PSB1cmwgPyAnc210cCcgOiBwYXJ0c1swXTsKICAgIHBhcnRzID0gcmVjdXJzZShzY2hlbWUgKyAnOi8vJyArIHBhcnRzWzBdKTsKICB9CgogIC8vIGlmIHRoZSBkb21haW4gaW5jbHVkZXMgYW4gQCwgZGl2aWRlIGl0IHRvIGRvbWFpbiBhbmQgaWRlbnRpdHkgcmVzcGVjdGl2ZWx5CiAgaWYgKHBhcnRzWzFdLmluY2x1ZGVzKCdAJykpIHsKICAgIHBhcnRzWzJdID0gcGFydHNbMF0gKyAnOi8vJyArIHBhcnRzWzFdOwogICAgcGFydHNbMV0gPSBwYXJ0c1sxXS5zdWJzdHIocGFydHNbMV0uaW5kZXhPZignQCcpICsgMSk7CiAgfSAvKmVsc2UgaWYgKHBhcnRzWzJdLmluY2x1ZGVzKCcvJykpIHsKICAgIHBhcnRzWzJdID0gcGFydHNbMl0uc3Vic3RyKHBhcnRzWzJdLmxhc3RJbmRleE9mKCcvJykrMSk7CiAgICB9Ki8KCiAgdmFyIHJlc3VsdCA9IHsKICAgIHR5cGU6IHBhcnRzWzBdLAogICAgZG9tYWluOiBwYXJ0c1sxXSwKICAgIGlkZW50aXR5OiBwYXJ0c1syXQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCmZ1bmN0aW9uIGRpdmlkZUVtYWlsKGVtYWlsKSB7CiAgdmFyIGluZGV4T2ZBdCA9IGVtYWlsLmluZGV4T2YoJ0AnKTsKCiAgdmFyIHJlc3VsdCA9IHsKICAgIHVzZXJuYW1lOiBlbWFpbC5zdWJzdHJpbmcoMCwgaW5kZXhPZkF0KSwKICAgIGRvbWFpbjogZW1haWwuc3Vic3RyaW5nKGluZGV4T2ZBdCArIDEsIGVtYWlsLmxlbmd0aCkKICB9OwoKICByZXR1cm4gcmVzdWx0Owp9CgovKioKICogQ2hlY2sgaWYgYW4gT2JqZWN0IGlzIGVtcHR5CiAqIEBwYXJhbSAge09iamVjdH0gb2JqZWN0IE9iamVjdCB0byBiZSBjaGVja2VkCiAqIEByZXR1cm4ge0Jvb2xlYW59ICAgICAgIHN0YXR1cyBvZiBPYmplY3QsIGVtcHR5IG9yIG5vdCAodHJ1ZXxmYWxzZSk7CiAqLwpmdW5jdGlvbiBlbXB0eU9iamVjdChvYmplY3QpIHsKICByZXR1cm4gKDAsIF9rZXlzMi5kZWZhdWx0KShvYmplY3QpLmxlbmd0aCA+IDAgPyBmYWxzZSA6IHRydWU7Cn0KCi8qKgogKiBNYWtlIGEgQ09QWSBvZiB0aGUgb3JpZ2luYWwgZGF0YQogKiBAcGFyYW0gIHtPYmplY3R9ICBvYmogLSBvYmplY3QgdG8gYmUgY2xvbmVkCiAqIEByZXR1cm4ge09iamVjdH0KICovCmZ1bmN0aW9uIGRlZXBDbG9uZShvYmopIHsKICAvL1RPRE86IHNpbXBsZSBidXQgaW5lZmZpY2llbnQgSlNPTiBkZWVwIGNsb25lLi4uCiAgaWYgKG9iaikgcmV0dXJuIEpTT04ucGFyc2UoKDAsIF9zdHJpbmdpZnkyLmRlZmF1bHQpKG9iaikpOwp9CgovKioKICogT2J0YWlucyB0aGUgdXNlciBVUkwgdGhhdCBjb3JyZXNwb25kcyB0byBhIGdpdmVuIGVtYWlsCiAqIEBwYXJhbSAge3N0cmluZ30gdXNlckVtYWlsIFRoZSB1c2VyIGVtYWlsCiAqIEByZXR1cm4ge1VSTC5VUkx9IHVzZXJVUkwgVGhlIHVzZXIgVVJMCiAqLwpmdW5jdGlvbiBnZXRVc2VyVVJMRnJvbUVtYWlsKHVzZXJFbWFpbCkgewogIHZhciBpbmRleE9mQXQgPSB1c2VyRW1haWwuaW5kZXhPZignQCcpOwogIHJldHVybiAndXNlcjovLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKGluZGV4T2ZBdCArIDEsIHVzZXJFbWFpbC5sZW5ndGgpICsgJy8nICsgdXNlckVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpOwp9CgovKioKICogT2J0YWlucyB0aGUgdXNlciBlbWFpbCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gVVJMCiAqIEBwYXJhbSAge1VSTC5VUkx9IHVzZXJVUkwgVGhlIHVzZXIgVVJMCiAqIEByZXR1cm4ge3N0cmluZ30gdXNlckVtYWlsIFRoZSB1c2VyIGVtYWlsCiAqLwpmdW5jdGlvbiBnZXRVc2VyRW1haWxGcm9tVVJMKHVzZXJVUkwpIHsKICB2YXIgdXJsID0gZGl2aWRlVVJMKHVzZXJVUkwpOwogIHJldHVybiB1cmwuaWRlbnRpdHkucmVwbGFjZSgnLycsICcnKSArICdAJyArIHVybC5kb21haW47IC8vIGlkZW50aXR5IGZpZWxkIGhhcyAnL2V4YW1wbGVJRCcgaW5zdGVhZCBvZiAnZXhhbXBsZUlEJwp9CgovKioKICogQ2hlY2sgaWYgdGhlIHVzZXIgaWRlbnRpZmllciBpcyBhbHJlYWR5IGluIHRoZSBVUkwgZm9ybWF0LCBpZiBub3QsIGNvbnZlcnQgdG8gVVJMIGZvcm1hdAogKiBAcGFyYW0gIHtzdHJpbmd9ICAgaWRlbnRpZmllciAgdXNlciBpZGVudGlmaWVyCiAqIEByZXR1cm4ge3N0cmluZ30gICB1c2VyVVJMICAgIHRoZSB1c2VyIFVSTAogKi8KZnVuY3Rpb24gY29udmVydFRvVXNlclVSTChpZGVudGlmaWVyKSB7CgogIC8vIGNoZWNrIGlmIHRoZSBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIHVybCBmb3JtYXQKICBpZiAoaWRlbnRpZmllci5zdWJzdHJpbmcoMCwgNykgPT09ICd1c2VyOi8vJykgewogICAgdmFyIGRpdmlkZWRVUkwgPSBkaXZpZGVVUkwoaWRlbnRpZmllcik7CgogICAgLy9jaGVjayBpZiB0aGUgdXJsIGlzIHdlbGwgZm9ybWF0ZWQKICAgIGlmIChkaXZpZGVkVVJMLmRvbWFpbiAmJiBkaXZpZGVkVVJMLmlkZW50aXR5KSB7CiAgICAgIHJldHVybiBpZGVudGlmaWVyOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgJ3VzZXJVUkwgd2l0aCB3cm9uZyBmb3JtYXQnOwogICAgfQoKICAgIC8vaWYgbm90LCBjb252ZXJ0IHRoZSB1c2VyIGVtYWlsIHRvIFVSTCBmb3JtYXQKICB9IGVsc2UgewogICAgcmV0dXJuIGdldFVzZXJVUkxGcm9tRW1haWwoaWRlbnRpZmllcik7CiAgfQp9CgovKioqLyB9KSwKLyogMTEwICovLAovKiAxMTEgKi8sCi8qIDExMiAqLywKLyogMTEzICovLAovKiAxMTQgKi8sCi8qIDExNSAqLywKLyogMTE2ICovLAovKiAxMTcgKi8sCi8qIDExOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7Cgp2YXIgX2dldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMSk7Cgp2YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFByb3RvdHlwZU9mKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNCk7Cgp2YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4zID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIpOwoKdmFyIF9nZXQyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjMpOwoKdmFyIF9nZXQzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0Mik7Cgp2YXIgX2luaGVyaXRzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzMpOwoKdmFyIF9pbmhlcml0czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbmhlcml0czIpOwoKdmFyIF9EYXRhT2JqZWN0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTIwKTsKCnZhciBfRGF0YU9iamVjdDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Mik7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCnZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgp2YXIgRmlsdGVyVHlwZSA9IHsgQU5ZOiAnYW55JywgU1RBUlQ6ICdzdGFydCcsIEVYQUNUOiAnZXhhY3QnIH07CgovKioKICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgc3Vic2NyaWJlIGNhbGwuCiAqIFRvIGJlIHVzZWQgYXMgYW4gb2JzZXJ2YXRpb24gcG9pbnQgZnJvbSBhIERhdGFPYmplY3RSZXBvcnRlciBjaGFuZ2UuCiAqLwoKdmFyIERhdGFPYmplY3RPYnNlcnZlciA9IGZ1bmN0aW9uIChfRGF0YU9iamVjdCkgewogICgwLCBfaW5oZXJpdHMzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlciwgX0RhdGFPYmplY3QpOwoKICAvKiBwcml2YXRlCiAgX2NoYW5nZUxpc3RlbmVyOiBNc2dMaXN0ZW5lcgogICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCiAgX2ZpbHRlcnM6IHs8ZmlsdGVyPjoge3R5cGU6IDxzdGFydCwgZXhhY3Q+LCBjYWxsYmFjazogPGZ1bmN0aW9uPn0gfQogICovCgogIC8qKgogICAqIEBpZ25vcmUKICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlci5zdWJzY3JpYmUgbWV0aG9kCiAgICovCgogIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICBmdW5jdGlvbiBEYXRhT2JqZWN0T2JzZXJ2ZXIoc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlbnMsIGluaXRpYWxWZXJzaW9uLCBtdXR1YWwpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3RPYnNlcnZlcik7CgogICAgdmFyIF90aGlzMiA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMuZGVmYXVsdCkodGhpcywgKERhdGFPYmplY3RPYnNlcnZlci5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyKSkuY2FsbCh0aGlzLCBzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEuZGF0YSwgY2hpbGRyZW5zLCBtdXR1YWwpKTsKCiAgICB2YXIgX3RoaXMgPSBfdGhpczI7CgogICAgX3RoaXMuX3ZlcnNpb24gPSBpbml0aWFsVmVyc2lvbjsKICAgIF90aGlzLl9maWx0ZXJzID0ge307CgogICAgX3RoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgX3RoaXMuX29uRmlsdGVyKGV2ZW50KTsKICAgIH0pOwoKICAgIC8vc2V0dXAgY2hpbGRyZW5zIGRhdGEgZnJvbSBzdWJzY3JpcHRpb24KICAgICgwLCBfa2V5czIuZGVmYXVsdCkoaW5pdGlhbERhdGEuY2hpbGRyZW5zKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CiAgICAgIHZhciBjaGlsZERhdGEgPSBpbml0aWFsRGF0YS5jaGlsZHJlbnNbY2hpbGRJZF07CiAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF0gPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpcywgY2hpbGRJZCwgY2hpbGREYXRhKTsKICAgIH0pOwoKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogICAgcmV0dXJuIF90aGlzMjsKICB9CgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlciwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICAoMCwgX2dldDMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZSksICdfYWxsb2NhdGVMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsICsgJy9jaGFuZ2VzJywgZnVuY3Rpb24gKG1zZykgewogICAgICAgIGlmIChtc2cudHlwZSA9PT0gJ3VwZGF0ZScpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0T2JzZXJ2ZXItJyArIF90aGlzLl91cmwgKyAnLVJDVjogJywgbXNnKTsKICAgICAgICAgIF90aGlzLl9jaGFuZ2VPYmplY3QoX3RoaXMuX3N5bmNPYmosIG1zZyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlKSwgJ19yZWxlYXNlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lci5yZW1vdmUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgIGRlbGV0ZSBfdGhpcy5fc3luY2hlci5fb2JzZXJ2ZXJzW190aGlzLl91cmxdOwogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAndW5zdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVuc3Vic2NyaWJlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25Mb2NhbFVuU3Vic2NyaWJlCiAgICAgIHZhciB1blN1YnNjcmliZU1zZyA9IHsKICAgICAgICB0eXBlOiAndW5zdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAogICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IF90aGlzLl91cmwgfQogICAgICB9OwoKICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh1blN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci1VTlNVQlNDUklCRTogJywgcmVwbHkpOwogICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fc3luY2hlci5fb2JzZXJ2ZXJzW190aGlzLl91cmxdOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWdpc3RlciB0aGUgY2hhbmdlIGxpc3RlbmVycyBzZW50IGJ5IHRoZSByZXBvcnRlcgogICAgICogQHBhcmFtIHtzdHJpbmd9IGZpbHRlciAtIEZpbHRlciB0aGF0IGlkZW50aWZpZXMgdGhlIGZpZWxkIChzZXBhcmF0ZWQgZG90IHBhdGgpLiBBY2NlcHRzICogYXQgdGhlIGVuZCBmb3IgYSBtb3JlIHVucmVzdHJpY3RlZCBmaWx0ZXJpbmcuCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25DaGFuZ2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlKGZpbHRlciwgY2FsbGJhY2spIHsKICAgICAgdmFyIGtleSA9IGZpbHRlcjsKICAgICAgdmFyIGZpbHRlck9iaiA9IHsKICAgICAgICB0eXBlOiBGaWx0ZXJUeXBlLkVYQUNULAogICAgICAgIGNhbGxiYWNrOiBjYWxsYmFjawogICAgICB9OwoKICAgICAgdmFyIGlkeCA9IGZpbHRlci5pbmRleE9mKCcqJyk7CiAgICAgIGlmIChpZHggPT09IGZpbHRlci5sZW5ndGggLSAxKSB7CiAgICAgICAgaWYgKGlkeCA9PT0gMCkgewogICAgICAgICAgZmlsdGVyT2JqLnR5cGUgPSBGaWx0ZXJUeXBlLkFOWTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZmlsdGVyT2JqLnR5cGUgPSBGaWx0ZXJUeXBlLlNUQVJUOwogICAgICAgICAga2V5ID0gZmlsdGVyLnN1YnN0cigwLCBmaWx0ZXIubGVuZ3RoIC0gMSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLl9maWx0ZXJzW2tleV0gPSBmaWx0ZXJPYmo7CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uRmlsdGVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25GaWx0ZXIoZXZlbnQpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgICgwLCBfa2V5czIuZGVmYXVsdCkoX3RoaXMuX2ZpbHRlcnMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIHZhciBmaWx0ZXIgPSBfdGhpcy5fZmlsdGVyc1trZXldOwogICAgICAgIGlmIChmaWx0ZXIudHlwZSA9PT0gRmlsdGVyVHlwZS5BTlkpIHsKICAgICAgICAgIC8vbWF0Y2ggYW55dGhpbmcKICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CiAgICAgICAgfSBlbHNlIGlmIChmaWx0ZXIudHlwZSA9PT0gRmlsdGVyVHlwZS5TVEFSVCkgewogICAgICAgICAgLy9pZiBzdGFydHMgd2l0aCBmaWx0ZXIuLi4KICAgICAgICAgIGlmIChldmVudC5maWVsZC5pbmRleE9mKGtleSkgPT09IDApIHsKICAgICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLkVYQUNUKSB7CiAgICAgICAgICAvL2V4YWN0IG1hdGNoCiAgICAgICAgICBpZiAoZXZlbnQuZmllbGQgPT09IGtleSkgewogICAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhT2JqZWN0T2JzZXJ2ZXI7Cn0oX0RhdGFPYmplY3QzLmRlZmF1bHQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovKTsKCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3RPYnNlcnZlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTE5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMik7Cgp2YXIgX2dldDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMyk7Cgp2YXIgX2dldDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXQyKTsKCnZhciBfaW5oZXJpdHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMyk7Cgp2YXIgX2luaGVyaXRzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2luaGVyaXRzMik7Cgp2YXIgX0RhdGFPYmplY3QyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjApOwoKdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCnZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwOSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiAqIFRoZSBjbGFzcyByZXR1cm5lZCBmcm9tIHRoZSBTeW5jaGVyIGNyZWF0ZSBjYWxsLgogKiBUbyBiZSB1c2VkIGFzIGEgcmVwb3J0ZXIgcG9pbnQsIGNoYW5nZXMgd2lsbCBiZSBzdWJtaXRlZCB0byBEYXRhT2JqZWN0T2JzZXJ2ZXIgaW5zdGFuY2VzLgogKi8KLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgp2YXIgRGF0YU9iamVjdFJlcG9ydGVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CiAgKDAsIF9pbmhlcml0czMuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLCBfRGF0YU9iamVjdCk7CgogIC8qIHByaXZhdGUKICBfc3Vic2NyaXB0aW9uczogPGh5cGVydHlVcmw6IHsgc3RhdHVzOiBzdHJpbmcgfSB9PgogICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCiAgX29uU3Vic2NyaXB0aW9uSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgX29uUmVzcG9uc2VIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICBfb25SZWFkSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyLmNyZWF0ZSBtZXRob2QKICAgKi8KICBmdW5jdGlvbiBEYXRhT2JqZWN0UmVwb3J0ZXIoc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlbnMpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3RSZXBvcnRlcik7CgogICAgdmFyIF90aGlzMiA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMuZGVmYXVsdCkodGhpcywgKERhdGFPYmplY3RSZXBvcnRlci5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyKSkuY2FsbCh0aGlzLCBzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykpOwoKICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCiAgICBfdGhpcy5fc3Vic2NyaXB0aW9ucyA9IHt9OwoKICAgIF90aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0UmVwb3J0ZXItJyArIHVybCArICctU0VORDogJywgZXZlbnQpOwogICAgICBfdGhpcy5fb25DaGFuZ2UoZXZlbnQpOwogICAgfSk7CgogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fb2JqZWN0TGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdC0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwogICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgIGNhc2UgJ3Jlc3BvbnNlJzoKICAgICAgICAgICAgX3RoaXMuX29uUmVzcG9uc2UobXNnKTticmVhazsKICAgICAgICAgIGNhc2UgJ3JlYWQnOgogICAgICAgICAgICBfdGhpcy5fb25SZWFkKG1zZyk7YnJlYWs7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlKSwgJ19yZWxlYXNlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9vYmplY3RMaXN0ZW5lci5yZW1vdmUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNlbmQgaW52aXRhdGlvbnMgKGNyZWF0ZSBtZXNzYWdlcykgdG8gaHlwZXJ0aWVzLCBvYnNlcnZlcnMgbGlzdC4KICAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIExpc3Qgb2YgSHlwZXJ0eSBVUkwncwogICAgICovCgogIH0sIHsKICAgIGtleTogJ2ludml0ZU9ic2VydmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW52aXRlT2JzZXJ2ZXJzKG9ic2VydmVycykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKICAgICAgdmFyIGludml0ZU1zZyA9IHsKICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMuX3N5bmNoZXIuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCwKICAgICAgICBib2R5OiB7IHJlc3VtZTogZmFsc2UsIHJlc291cmNlOiBfdGhpcy5fdXJsLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZhbHVlOiBfdGhpcy5fc3luY09iai5kYXRhLCBhdXRob3Jpc2U6IG9ic2VydmVycyB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGludml0ZU1zZyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkZWxldGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkRlbGV0ZQogICAgICB2YXIgZGVsZXRlTXNnID0gewogICAgICAgIHR5cGU6ICdkZWxldGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAogICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IF90aGlzLl91cmwgfQogICAgICB9OwoKICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShkZWxldGVNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0UmVwb3J0ZXItREVMRVRFOiAnLCByZXBseSk7CiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9yZXBvcnRlcnNbX3RoaXMuX3VybF07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFN1YnNjcmlwdGlvbnMgcmVxdWVzdGVkIGFuZCBhY2NlcHRlZCB0byB0aGlzIHJlcG9ydGVyCiAgICAgKiBAdHlwZSB7T2JqZWN0PEh5cGVydHlVUkwsIFN5bmNTdWJzY3JpcHRpb24+fQogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uU3Vic2NyaXB0aW9uJywKCgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyBzdWJzY3JpYmUgYW5kIHVuc3Vic2NyaWJlIG5vdGlmaWNhdGlvbnMKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sgZnVuY3Rpb24gdG8gcmVjZWl2ZSBldmVudHMKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIG9uU3Vic2NyaXB0aW9uKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgcmVzcG9uc2Ugbm90aWZpY2F0aW9ucyBvZiB0aGUgY3JlYXRlJ3MKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sgZnVuY3Rpb24gdG8gcmVjZWl2ZSBldmVudHMKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlc3BvbnNlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVzcG9uc2VIYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZWFkIG5vdGlmaWNhdGlvbnMKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblJlYWQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVhZChjYWxsYmFjaykgewogICAgICB0aGlzLl9vblJlYWRIYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gcGFyZW50IFN5bmNoZXIgLT4gX29uRm9yd2FyZAoKICB9LCB7CiAgICBrZXk6ICdfb25Gb3J3YXJkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Gb3J3YXJkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1SQ1Y6ICcsIG1zZyk7CiAgICAgIHN3aXRjaCAobXNnLmJvZHkudHlwZSkgewogICAgICAgIGNhc2UgJ3N1YnNjcmliZSc6CiAgICAgICAgICBfdGhpcy5fb25TdWJzY3JpYmUobXNnKTticmVhazsKICAgICAgICBjYXNlICd1bnN1YnNjcmliZSc6CiAgICAgICAgICBfdGhpcy5fb25VblN1YnNjcmliZShtc2cpO2JyZWFrOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gdGhpcyAtPiBfb25Gb3J3YXJkOiBlbWl0dGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gc3Vic2NyaWJlCgogIH0sIHsKICAgIGtleTogJ19vblN1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uU3Vic2NyaWJlKG1zZykgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBoeXBlcnR5VXJsID0gbXNnLmJvZHkuZnJvbTsKICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0UmVwb3J0ZXIuX29uU3Vic2NyaWJlXScsIG1zZyk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLmJvZHkudHlwZSwKICAgICAgICB1cmw6IGh5cGVydHlVcmwsCgogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQoKSB7CiAgICAgICAgICAvL2NyZWF0ZSBuZXcgc3Vic2NyaXB0aW9uCiAgICAgICAgICB2YXIgc3ViID0geyB1cmw6IGh5cGVydHlVcmwsIHN0YXR1czogJ29uJyB9OwogICAgICAgICAgX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF0gPSBzdWI7CgogICAgICAgICAgLy9wcm9jZXNzIGFuZCBzZW5kIGNoaWxkcmVucyBkYXRhCiAgICAgICAgICB2YXIgY2hpbGRyZW5WYWx1ZXMgPSB7fTsKICAgICAgICAgICgwLCBfa2V5czIuZGVmYXVsdCkoX3RoaXMuX2NoaWxkcmVuT2JqZWN0cykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRJZCkgewogICAgICAgICAgICB2YXIgY2hpbGREYXRhID0gX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXS5kYXRhOwogICAgICAgICAgICBjaGlsZHJlblZhbHVlc1tjaGlsZElkXSA9ICgwLCBfdXRpbHMuZGVlcENsb25lKShjaGlsZERhdGEpOwogICAgICAgICAgfSk7CgogICAgICAgICAgdmFyIHNlbmRNc2cgPSB7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgc2NoZW1hOiBfdGhpcy5fc2NoZW1hLCB2ZXJzaW9uOiBfdGhpcy5fdmVyc2lvbiwgdmFsdWU6IHsgZGF0YTogKDAsIF91dGlscy5kZWVwQ2xvbmUpKF90aGlzLmRhdGEpLCBjaGlsZHJlbnM6IGNoaWxkcmVuVmFsdWVzIH0gfQogICAgICAgICAgfTsKCiAgICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgICBpZiAobXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ211dHVhbEF1dGhlbnRpY2F0aW9uJykgJiYgIW1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uKSB7CiAgICAgICAgICAgIHNlbmRNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IF90aGlzMy5fbXV0dWFsQXV0aGVudGljYXRpb247CiAgICAgICAgICAgIF90aGlzMy5fbXV0dWFsQXV0aGVudGljYXRpb24gPSBtc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbjsKICAgICAgICAgIH0KCiAgICAgICAgICAvL3NlbmQgb2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShzZW5kTXNnKTsKCiAgICAgICAgICByZXR1cm4gc3ViOwogICAgICAgIH0sCgogICAgICAgIHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KHJlYXNvbikgewogICAgICAgICAgLy9zZW5kIHJlamVjdCByZXNwb25zZSBtZXNzYWdlCiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogNDAzLCBkZXNjOiByZWFzb24gfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnU1VCU0NSSVBUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGlzIC0+IF9vbkZvcndhcmQ6IGVtaXR0ZWQgYnkgYSByZW1vdGUgRGF0YU9iamVjdE9ic2VydmVyIC0+IHVuc3Vic2NyaWJlCgogIH0sIHsKICAgIGtleTogJ19vblVuU3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25VblN1YnNjcmliZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwoKICAgICAgdmFyIHN1YiA9IF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVcmxdOwogICAgICBkZWxldGUgX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLmJvZHkudHlwZSwKICAgICAgICB1cmw6IGh5cGVydHlVcmwsCiAgICAgICAgb2JqZWN0OiBzdWIKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1VOLVNVQlNDUklQVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gX29uUmVtb3RlQ3JlYXRlIC0+IGV2ZW50LmFjawoKICB9LCB7CiAgICBrZXk6ICdfb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVzcG9uc2UobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgdXJsOiBtc2cuZnJvbSwKICAgICAgICBjb2RlOiBtc2cuYm9keS5jb2RlCiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1JFU1BPTlNFLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIFJlcG9ydGVyVVJMIGFkZHJlc3M6IGVtaXRlZCBieSBhIHJlbW90ZSBTeW5jaGVyIC0+IHJlYWQKCiAgfSwgewogICAga2V5OiAnX29uUmVhZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVhZChtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICB1cmw6IG1zZy5mcm9tLAoKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHZhbHVlOiAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoX3RoaXMuZGF0YSkgfQogICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7CiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogNDAxLCBkZXNjOiByZWFzb24gfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlYWRIYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1JFQUQtRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25SZWFkSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdzdWJzY3JpcHRpb25zJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaXB0aW9uczsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFPYmplY3RSZXBvcnRlcjsKfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdFJlcG9ydGVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfcHJvbWlzZSA9IF9fd2VicGFja19yZXF1aXJlX18oNzEpOwoKdmFyIF9wcm9taXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Byb21pc2UpOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIyKTsKCnZhciBfUHJveHlPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUHJveHlPYmplY3QpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMSk7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Q2hpbGQpOwoKdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKICogTWFpbiBleHRlbnNpb24gY2xhc3MgZm9yIG9ic2VydmVycyBhbmQgcmVwb3J0ZXJzLCB3aXRoIGNvbW1vbiBwcm9wZXJ0aWVzIGFuZCBtZXRob2RzLgogKiBDaGlsZHJlbiBtYW5hZ2VtZW50IGlzIGNvbW1vbiBmb3Igb2JzZXJ2ZXJzIGFuZCByZXBvcnRlcnMuCiAqLwp2YXIgRGF0YU9iamVjdCA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgX3ZlcnNpb246IG51bWJlcgogICBfb3duZXI6IEh5cGVydHlVUkwKICBfdXJsOiBPYmplY3RVUkwKICBfc2NoZW1hOiBTY2hlbWEKICBfYnVzOiBNaW5pQnVzCiAgX3N0YXR1czogb24gfCBwYXVzZWQKICBfc3luY09iajogU3luY0RhdGEKICAgX2NoaWxkcmVuOiB7IGlkOiBEYXRhT2JqZWN0Q2hpbGQgfQogIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXQogICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCiAgX29uQWRkQ2hpbGRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIgY3JlYXRlIG9yIHN1YnNjcmliZSBtZXRob2QncwogICAqLwogIGZ1bmN0aW9uIERhdGFPYmplY3Qoc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlbnMpIHsKICAgIHZhciBtdXR1YWwgPSBhcmd1bWVudHMubGVuZ3RoID4gNiAmJiBhcmd1bWVudHNbNl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s2XSA6IHRydWU7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBEYXRhT2JqZWN0KTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9zeW5jaGVyID0gc3luY2hlcjsKICAgIF90aGlzLl91cmwgPSB1cmw7CiAgICBfdGhpcy5fc2NoZW1hID0gc2NoZW1hOwogICAgX3RoaXMuX3N0YXR1cyA9IGluaXRpYWxTdGF0dXM7CiAgICBfdGhpcy5fc3luY09iaiA9IG5ldyBfUHJveHlPYmplY3QyLmRlZmF1bHQoaW5pdGlhbERhdGEpOwogICAgX3RoaXMuX2NoaWxkcmVucyA9IGNoaWxkcmVuczsKCiAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb24gPSBtdXR1YWw7CgogICAgX3RoaXMuX3ZlcnNpb24gPSAwOwogICAgX3RoaXMuX2NoaWxkSWQgPSAwOwogICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0cyA9IHt9OwogICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzID0gW107CgogICAgX3RoaXMuX293bmVyID0gc3luY2hlci5fb3duZXI7CiAgICBfdGhpcy5fYnVzID0gc3luY2hlci5fYnVzOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdCwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgY2hpbGRCYXNlVVJMID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJzsKICAgICAgY29uc29sZS5sb2coJ1tEYXRhIE9iamVjdCAtIEFsbG9jYXRlTGlzdGVuZXJzXSAtICcsIF90aGlzLl9jaGlsZHJlbnMpOwogICAgICBpZiAoX3RoaXMuX2NoaWxkcmVucykgewogICAgICAgIF90aGlzLl9jaGlsZHJlbnMuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHsKICAgICAgICAgIHZhciBjaGlsZFVSTCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOwogICAgICAgICAgdmFyIGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgZnVuY3Rpb24gKG1zZykgewogICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCiAgICAgICAgICAgIGlmIChtc2cuZnJvbSAhPT0gX3RoaXMyLl9vd25lcikgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0LUNoaWxkcmVuLVJDVjogJywgbXNnKTsKICAgICAgICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CiAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGUnOgogICAgICAgICAgICAgICAgICBfdGhpcy5fb25DaGlsZENyZWF0ZShtc2cpO2JyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzoKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobXNnKTticmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgIF90aGlzLl9jaGFuZ2VDaGlsZHJlbihtc2cpO2JyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CgogICAgICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKGxpc3RlbmVyKSB7CiAgICAgICAgbGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgIH0pOwoKICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2tleV0uX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBPYmplY3QgVVJMIG9mIHJlcG9ydGVyIG9yIG9ic2VydmVyCiAgICAgKiBAdHlwZSB7T2JqZWN0VVJMfQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3BhdXNlJywKCgogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHsKICAgICAgLy9UT0RPOiB0aGlzIGZlYXR1cmUgbmVlZHMgbW9yZSBhbmFsaXNlCiAgICAgIHRocm93ICdOb3QgaW1wbGVtZW50ZWQnOwogICAgfQoKICAgIC8qKgogICAgICogQGlnbm9yZQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3Jlc3VtZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzdW1lKCkgewogICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CiAgICB9CgogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnc3RvcCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcCgpIHsKICAgICAgLy9UT0RPOiBzaG91bGQgcmVtb3ZlIHRoZSBzdWJzY3JpcHRpb24gYW5kIHNlbmQgbWVzc2FnZSB1bnN1YnNjcmliZT8KICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYW5kIGFkZCBhIERhdGFPYmplY3RDaGlsZCB0byBhIGNoaWxkcmVuIGNvbGxlY3Rpb24uCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY2hpbGRyZW4gLSBDaGlsZHJlbiBuYW1lIHdoZXJlIHRoZSBjaGlsZCBpcyBhZGRlZC4KICAgICAqIEBwYXJhbSB7SlNPTn0gaW5pdGlhbERhdGEgLSBJbml0aWFsIGRhdGEgb2YgdGhlIGNoaWxkCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RDaGlsZD59IC0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgRGF0YU9iamVjdENoaWxkLgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2FkZENoaWxkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRDaGlsZChjaGlsZHJlbiwgaW5pdGlhbERhdGEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vY3JlYXRlIG5ldyBjaGlsZCB1bmlxdWUgSUQsIGJhc2VkIG9uIGh5cGVydHlVUkwKICAgICAgX3RoaXMuX2NoaWxkSWQrKzsKICAgICAgdmFyIG1zZ0NoaWxkSWQgPSBfdGhpcy5fb3duZXIgKyAnIycgKyBfdGhpcy5fY2hpbGRJZDsKICAgICAgdmFyIG1zZ0NoaWxkUGF0aCA9IF90aGlzLl91cmwgKyAnL2NoaWxkcmVuLycgKyBjaGlsZHJlbjsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgZGlyZWN0bHkgdG8gYSByZXNvdXJjZSBjaGlsZCBhZGRyZXNzOiBNZXNzYWdlQnVzCiAgICAgIHZhciByZXF1ZXN0TXNnID0gewogICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBtc2dDaGlsZFBhdGgsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogbXNnQ2hpbGRJZCwgdmFsdWU6IGluaXRpYWxEYXRhIH0KICAgICAgfTsKCiAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgaWYgKCFfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb24pIHJlcXVlc3RNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbjsKCiAgICAgIC8vcmV0dXJucyBwcm9taXNlLCBpbiB0aGUgZnV0dXJlLCB0aGUgQVBJIG1heSBjaGFuZ2UgdG8gYXN5bmNocm9ub3VzIGNhbGwKICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIHZhciBtc2dJZCA9IF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVxdWVzdE1zZyk7CgogICAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUtcmVwb3J0ZXItY2hpbGQoICcgKyBfdGhpcy5fb3duZXIgKyAnICk6ICcsIHJlcXVlc3RNc2cpOwogICAgICAgIHZhciBuZXdDaGlsZCA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBtc2dDaGlsZElkLCBpbml0aWFsRGF0YSwgX3RoaXMuX293bmVyLCBtc2dJZCk7CiAgICAgICAgbmV3Q2hpbGQub25DaGFuZ2UoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICBfdGhpcy5fb25DaGFuZ2UoZXZlbnQsIHsgcGF0aDogbXNnQ2hpbGRQYXRoLCBjaGlsZElkOiBtc2dDaGlsZElkIH0pOwogICAgICAgIH0pOwoKICAgICAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW21zZ0NoaWxkSWRdID0gbmV3Q2hpbGQ7CgogICAgICAgIHJlc29sdmUobmV3Q2hpbGQpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIG9mIGNoaWxkcmVucy4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkFkZENoaWxkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkFkZENoaWxkKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdCAtPiBhZGRDaGlsZAoKICB9LCB7CiAgICBrZXk6ICdfb25DaGlsZENyZWF0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uQ2hpbGRDcmVhdGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBtc2dDaGlsZElkID0gbXNnLmJvZHkucmVzb3VyY2U7CgogICAgICBjb25zb2xlLmxvZygnY3JlYXRlLW9ic2VydmVyLWNoaWxkKCAnICsgX3RoaXMuX293bmVyICsgJyApOiAnLCBtc2cpOwogICAgICB2YXIgbmV3Q2hpbGQgPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpcywgbXNnQ2hpbGRJZCwgbXNnLmJvZHkudmFsdWUpOwogICAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW21zZ0NoaWxkSWRdID0gbmV3Q2hpbGQ7CgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAvL0ZMT1ctT1VUOiB3aWxsIGZsb3cgdG8gRGF0YU9iamVjdENoaWxkIC0+IF9vblJlc3BvbnNlCiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgfSk7CiAgICAgIH0pOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIGZyb206IG1zZy5mcm9tLAogICAgICAgIHVybDogbXNnLnRvLAogICAgICAgIHZhbHVlOiBtc2cuYm9keS52YWx1ZSwKICAgICAgICBjaGlsZElkOiBtc2dDaGlsZElkLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdBREQtQ0hJTERSRU4tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9zZW5kIGRlbHRhIG1lc3NhZ2VzIHRvIHN1YnNjcmlwdGlvbnMKCiAgfSwgewogICAga2V5OiAnX29uQ2hhbmdlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2UoZXZlbnQsIGNoaWxkSW5mbykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKCiAgICAgIGlmIChfdGhpcy5fc3RhdHVzID09PSAnb24nKSB7CiAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoYW5nZXMgYWRkcmVzczogTWVzc2FnZUJ1cwogICAgICAgIHZhciBjaGFuZ2VNc2cgPSB7CiAgICAgICAgICB0eXBlOiAndXBkYXRlJywgZnJvbTogX3RoaXMuX3VybCwgdG86IF90aGlzLl91cmwgKyAnL2NoYW5nZXMnLAogICAgICAgICAgYm9keTogeyB2ZXJzaW9uOiBfdGhpcy5fdmVyc2lvbiwgc291cmNlOiBfdGhpcy5fb3duZXIsIGF0dHJpYnV0ZTogZXZlbnQuZmllbGQgfQogICAgICAgIH07CgogICAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdCAtIF9vbkNoYW5nZV0gLSAnLCBldmVudCwgY2hpbGRJbmZvLCBjaGFuZ2VNc2cpOwoKICAgICAgICBpZiAoZXZlbnQub1R5cGUgPT09IF9Qcm94eU9iamVjdC5PYmplY3RUeXBlLk9CSkVDVCkgewogICAgICAgICAgaWYgKGV2ZW50LmNUeXBlICE9PSBfUHJveHlPYmplY3QuQ2hhbmdlVHlwZS5SRU1PVkUpIHsKICAgICAgICAgICAgY2hhbmdlTXNnLmJvZHkudmFsdWUgPSBldmVudC5kYXRhOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjaGFuZ2VNc2cuYm9keS5hdHRyaWJ1dGVUeXBlID0gZXZlbnQub1R5cGU7CiAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CiAgICAgICAgICBpZiAoZXZlbnQuY1R5cGUgIT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlVQREFURSkgewogICAgICAgICAgICBjaGFuZ2VNc2cuYm9keS5vcGVyYXRpb24gPSBldmVudC5jVHlwZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vY2hpbGRJbmZvIG11c3QgaGF2ZSAocGF0aCwgY2hpbGRJZCkKICAgICAgICBpZiAoY2hpbGRJbmZvKSB7CiAgICAgICAgICBjaGFuZ2VNc2cudG8gPSBjaGlsZEluZm8ucGF0aDsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnJlc291cmNlID0gY2hpbGRJbmZvLmNoaWxkSWQ7CiAgICAgICAgfQoKICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgaWYgKCFfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb24pIGNoYW5nZU1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uOwoKICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGNoYW5nZU1zZyk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IGRlbHRhIG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgb3IgRGF0YU9iamVjdENoaWxkIHdoZW4gY2hhbmdpbmcgZGF0YQoKICB9LCB7CiAgICBrZXk6ICdfY2hhbmdlT2JqZWN0JywKICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hhbmdlT2JqZWN0KHN5bmNPYmosIG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9UT0RPOiB1cGRhdGUgdmVyc2lvbiA/CiAgICAgIC8vaG93IHRvIGhhbmRsZSBhbiBpbmNvcnJlY3QgdmVyc2lvbiA/IEV4YW1wbGU6IHJlY2VpdmUgYSB2ZXJzaW9uIDMgd2hlbiB0aGUgb2JzZXJ2ZXIgaXMgaW4gdmVyc2lvbiAxLCB3aGVyZSBpcyB0aGUgdmVyc2lvbiAyID8KICAgICAgLy93aWxsIHdlIG5lZWQgdG8gY29uZmlybSB0aGUgcmVjZXB0aW9uID8KICAgICAgaWYgKF90aGlzLl92ZXJzaW9uICsgMSA9PT0gbXNnLmJvZHkudmVyc2lvbikgewogICAgICAgIF90aGlzLl92ZXJzaW9uKys7CiAgICAgICAgdmFyIHBhdGggPSBtc2cuYm9keS5hdHRyaWJ1dGU7CiAgICAgICAgdmFyIHZhbHVlID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKG1zZy5ib2R5LnZhbHVlKTsKICAgICAgICB2YXIgZmluZFJlc3VsdCA9IHN5bmNPYmouZmluZEJlZm9yZShwYXRoKTsKCiAgICAgICAgaWYgKG1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPT09IF9Qcm94eU9iamVjdC5PYmplY3RUeXBlLkFSUkFZKSB7CiAgICAgICAgICBpZiAobXNnLmJvZHkub3BlcmF0aW9uID09PSBfUHJveHlPYmplY3QuQ2hhbmdlVHlwZS5BREQpIHsKICAgICAgICAgICAgdmFyIGFyciA9IGZpbmRSZXN1bHQub2JqOwogICAgICAgICAgICB2YXIgaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5zcGxpY2UuYXBwbHkoYXJyLCBbaW5kZXgsIDBdLmNvbmNhdCh2YWx1ZSkpOwogICAgICAgICAgfSBlbHNlIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICB2YXIgX2FyciA9IGZpbmRSZXN1bHQub2JqOwogICAgICAgICAgICB2YXIgX2luZGV4ID0gZmluZFJlc3VsdC5sYXN0OwogICAgICAgICAgICBfYXJyLnNwbGljZShfaW5kZXgsIHZhbHVlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF0gPSB2YWx1ZTsgLy8gVVBEQVRFCiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChtc2cuYm9keS52YWx1ZSkgewogICAgICAgICAgICBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdID0gdmFsdWU7IC8vIFVQREFURSBvciBBREQKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGRlbGV0ZSBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdOyAvLyBSRU1PVkUKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy9UT0RPOiBob3cgdG8gaGFuZGxlIHVuc3luY2hyb25pemVkIHZlcnNpb25zPwogICAgICAgIGNvbnNvbGUubG9nKCdVTlNZTkNIUk9OSVpFRCBWRVJTSU9OOiAoZGF0YSA9PiAnICsgX3RoaXMuX3ZlcnNpb24gKyAnLCBtc2cgPT4gJyArIG1zZy5ib2R5LnZlcnNpb24gKyAnKScpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdENoaWxkIHdoZW4gY2hhbmdpbmcgZGF0YQoKICB9LCB7CiAgICBrZXk6ICdfY2hhbmdlQ2hpbGRyZW4nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VDaGlsZHJlbihtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgY29uc29sZS5sb2coJ0NoYW5nZSBjaGlsZHJlbjogJywgX3RoaXMuX293bmVyLCBtc2cpOwoKICAgICAgdmFyIGNoaWxkSWQgPSBtc2cuYm9keS5yZXNvdXJjZTsKICAgICAgdmFyIGNoaWxkcmVuID0gX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXTsKCiAgICAgIGlmIChjaGlsZHJlbikgewogICAgICAgIF90aGlzLl9jaGFuZ2VPYmplY3QoY2hpbGRyZW4uX3N5bmNPYmosIG1zZyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coJ05vIGNoaWxkcmVuIGZvdW5kIGZvcjogJywgY2hpbGRJZCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICd1cmwnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl91cmw7CiAgICB9CgogICAgLyoqCiAgICAgKiBPYmplY3Qgc2NoZW1hIFVSTCAodGhpcyBmaWVsZCBpcyBub3QgeWV0IHN0YWJsZSwgYW5kIGlzIHN1YnNqZWN0IHRvIGNoYW5nZSkKICAgICAqIEB0eXBlIHtTY2hlbWFVUkx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnc2NoZW1hJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc2NoZW1hOwogICAgfQoKICAgIC8qKgogICAgICogU3RhdHVzIG9mIHRoZSByZXBvcnRlciBvciBvYnNlcnZlciBjb25uZWN0aW9uICh0aGlzIGZpZWxkIGlzIG5vdCB5ZXQgc3RhYmxlLCBhbmQgaXMgc3Vic2plY3QgdG8gY2hhbmdlKQogICAgICogQHR5cGUge1N0YXR1c30gLSBFbnVtIG9mOiBvbiB8IHBhdXNlZAogICAgICovCgogIH0sIHsKICAgIGtleTogJ3N0YXR1cycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1czsKICAgIH0KCiAgICAvKioKICAgICAqIERhdGEgc3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC4KICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwogICAgfQoKICAgIC8qKgogICAgICogQWxsIGNyZWF0ZWQgY2hpbGRyZW4ncyBzaW5jZSB0aGUgc3Vic2NyaXB0aW9uLCBkb2Vzbid0IGNvbnRhaW4gYWxsIGNoaWxkcmVuJ3Mgc2luY2UgcmVwb3J0ZXIgY3JlYXRpb24uCiAgICAgKiBAdHlwZSB7T2JqZWN0PENoaWxkSWQsIERhdGFPYmplY3RDaGlsZD59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnY2hpbGRyZW5zJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW5PYmplY3RzOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdDsKfSgpOyAvKioKICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICoKICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgKgogICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAqCiAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3Q7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEyMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfUHJveHlPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMik7Cgp2YXIgX1Byb3h5T2JqZWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1Byb3h5T2JqZWN0KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIERhdGFPYmplY3QgYWRkQ2hpbGRyZW4gY2FsbCBvciBmcm9tIG9uQWRkQ2hpbGRyZW4gaWYgcmVtb3RlbHkgY3JlYXRlZC4KICogQ2hpbGRyZW4gb2JqZWN0IHN5bmNocm9uaXphdGlvbiBpcyBhIGEgZmFzdCBmb3J3YXJkIG1lY2hhbmlzbSwgbm8gbmVlZCBmb3IgZGlyZWN0IHN1YnNjcmlwdGlvbnMsIGl0IHVzZXMgdGhlIGFscmVhZHkgYXV0aG9yaXplZCBzdWJzY3JpcHRpb24gZnJvbSB0aGUgcGFyZW50IERhdGFPYmplY3QuCiAqLwp2YXIgRGF0YU9iamVjdENoaWxkIC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25SZXNwb25zZUhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogICovCgogIC8qKgogICAqIEBpZ25vcmUKICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgRGF0YU9iamVjdC5hZGRDaGlsZHJlbgogICAqLwogIGZ1bmN0aW9uIERhdGFPYmplY3RDaGlsZChwYXJlbnQsIGNoaWxkSWQsIGluaXRpYWxEYXRhLCBvd25lciwgbXNnSWQpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3RDaGlsZCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fcGFyZW50ID0gcGFyZW50OwogICAgX3RoaXMuX2NoaWxkSWQgPSBjaGlsZElkOwogICAgX3RoaXMuX293bmVyID0gb3duZXI7CiAgICBfdGhpcy5fbXNnSWQgPSBtc2dJZDsKCiAgICBfdGhpcy5fc3luY09iaiA9IG5ldyBfUHJveHlPYmplY3QyLmRlZmF1bHQoaW5pdGlhbERhdGEpOwoKICAgIF90aGlzLl9idXMgPSBwYXJlbnQuX2J1czsKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdENoaWxkLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3RoaXMgaXMgb25seSBuZWVkZWQgZm9yIGNoaWxkcmVuIHJlcG9ydGVycwogICAgICBpZiAoX3RoaXMuX293bmVyKSB7CiAgICAgICAgX3RoaXMuX2xpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fb3duZXIsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICAgIGlmIChtc2cudHlwZSA9PT0gJ3Jlc3BvbnNlJyAmJiBtc2cuaWQgPT09IF90aGlzLl9tc2dJZCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdENoaWxkLm9uUmVzcG9uc2U6JywgbXNnKTsKICAgICAgICAgICAgX3RoaXMuX29uUmVzcG9uc2UobXNnKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGlmIChfdGhpcy5fbGlzdGVuZXIpIHsKICAgICAgICBfdGhpcy5fbGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGRlbGV0ZSBfdGhpcy5fcGFyZW50Ll9jaGlsZHJlbltfdGhpcy5fY2hpbGRJZF07CgogICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwoKICAgICAgLy9UT0RPOiBzZW5kIGRlbGV0ZSBtZXNzYWdlID8KICAgIH0KCiAgICAvKioKICAgICAqIENoaWxkcmVuIElEIGdlbmVyYXRlZCBvbiBhZGRDaGlsZHJlbi4gVW5pcXVlIGlkZW50aWZpZXIKICAgICAqIEB0eXBlIHtVUkx9IC0gVVJMIG9mIHRoZSBmb3JtYXQgPEh5cGVydHlVUkw+IzxudW1lcmljLXNlcXVlbmNlPgogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uQ2hhbmdlJywKCgogICAgLyoqCiAgICAgKiBSZWdpc3RlciB0aGUgY2hhbmdlIGxpc3RlbmVycyBzZW50IGJ5IHRoZSByZXBvcnRlciBjaGlsZAogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIGNhbGxiYWNrKGV2ZW50KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZXNwb25zZSBub3RpZmljYXRpb25zIG9mIHRoZSBjcmVhdGVzCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZXNwb25zZShjYWxsYmFjaykgewogICAgICB0aGlzLl9vblJlc3BvbnNlSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3QgLT4gX29uQ2hpbGRDcmVhdGUKCiAgfSwgewogICAga2V5OiAnX29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlc3BvbnNlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmJvZHkuc291cmNlLAogICAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGUKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIpIHsKICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnY2hpbGRJZCcsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkSWQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBEYXRhIFN0cnVjdHVyZSB0byBiZSBzeW5jaHJvbml6ZWQuCiAgICAgKiBAdHlwZSB7SlNPTn0gLSBKU09OIHN0cnVjdHVyZSB0aGF0IHNob3VsZCBmb2xsb3cgdGhlIGRlZmluZWQgc2NoZW1hLCBpZiBhbnkuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGF0YScsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N5bmNPYmouZGF0YTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFPYmplY3RDaGlsZDsKfSgpOyAvKioKICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICoKICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgKgogICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAqCiAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3RDaGlsZDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTIyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuT2JqZWN0VHlwZSA9IGV4cG9ydHMuQ2hhbmdlVHlwZSA9IHVuZGVmaW5lZDsKCnZhciBfc3RyaW5naWZ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7Cgp2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCl9fd2VicGFja19yZXF1aXJlX18oMTUzKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9Cgp2YXIgb2JqZWN0VHlwZSA9IHsgQVJSQVk6ICdbb2JqZWN0IEFycmF5XScsIE9CSkVDVDogJ1tvYmplY3QgT2JqZWN0XScgfTsKCi8qKgogKiBAYWNjZXNzIHByaXZhdGUKICogTWFpbiBjbGFzcyB0aGF0IG1haW50YWlucyBhIEpTT04gb2JqZWN0LCBhbmQgb2JzZXJ2ZXMgY2hhbmdlcyBpbiB0aGlzIG9iamVjdCwgcmVjdXJzaXZlbHkuCiAqIEludGVybmFsIG9iamVjdHMgYW5kIGFycmF5cyBhcmUgYWxzbyBvYnNlcnZlZC4KICovCgp2YXIgU3luY09iamVjdCA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBTeW5jT2JqZWN0KGluaXRpYWxEYXRhKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBTeW5jT2JqZWN0KTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vYnNlcnZlcnMgPSBbXTsKICAgIF90aGlzLl9maWx0ZXJzID0ge307CgogICAgdGhpcy5fZGF0YSA9IGluaXRpYWxEYXRhIHx8IHt9OwoKICAgIHRoaXMuX2ludGVybmFsT2JzZXJ2ZSh0aGlzLl9kYXRhKTsKICB9CgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKFN5bmNPYmplY3QsIFt7CiAgICBrZXk6ICdvYnNlcnZlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvYnNlcnZlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29ic2VydmVycy5wdXNoKGNhbGxiYWNrKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdmaW5kJywKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kKHBhdGgpIHsKICAgICAgdmFyIGxpc3QgPSBwYXRoLnNwbGl0KCcuJyk7CgogICAgICByZXR1cm4gdGhpcy5fZmluZFdpdGhTcGxpdChsaXN0KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdmaW5kQmVmb3JlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kQmVmb3JlKHBhdGgpIHsKICAgICAgdmFyIHJlc3VsdCA9IHt9OwogICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKICAgICAgcmVzdWx0Lmxhc3QgPSBsaXN0LnBvcCgpOwogICAgICByZXN1bHQub2JqID0gdGhpcy5fZmluZFdpdGhTcGxpdChsaXN0KTsKCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2ZpbmRXaXRoU3BsaXQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maW5kV2l0aFNwbGl0KGxpc3QpIHsKICAgICAgdmFyIG9iaiA9IHRoaXMuX2RhdGE7CiAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICBvYmogPSBvYmpbdmFsdWVdOwogICAgICB9KTsKCiAgICAgIHJldHVybiBvYmo7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2lzT2JzZXJ2YWJsZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2lzT2JzZXJ2YWJsZShvYmopIHsKICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0IHx8IG9iai5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0sIHsKICAgIGtleTogJ19pbnRlcm5hbE9ic2VydmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbE9ic2VydmUob2JqZWN0KSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiBoYW5kbGVyKGNoYW5nZXNldCkgewoKICAgICAgICBjaGFuZ2VzZXQuZXZlcnkoZnVuY3Rpb24gKGNoYW5nZSkgewogICAgICAgICAgX3RoaXMyLl9vbkNoYW5nZXMoY2hhbmdlKTsKICAgICAgICB9KTsKICAgICAgfTsKCiAgICAgIHRoaXMuX2RhdGEgPSBPYmplY3QuZGVlcE9ic2VydmUob2JqZWN0LCBoYW5kbGVyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmlyZUV2ZW50JywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlyZUV2ZW50KGV2ZW50KSB7CiAgICAgIHRoaXMuX29ic2VydmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgICAgIGNhbGxiYWNrKGV2ZW50KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX29uQ2hhbmdlcycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uQ2hhbmdlcyhjaGFuZ2UpIHsKCiAgICAgIHZhciBvYmogPSBjaGFuZ2Uub2JqZWN0OwogICAgICB2YXIgb2JqVHlwZSA9IHZvaWQgMDsKCiAgICAgIGlmIChvYmouY29uc3RydWN0b3IgPT09IE9iamVjdCkgewogICAgICAgIG9ialR5cGUgPSBPYmplY3RUeXBlLk9CSkVDVDsKICAgICAgfQoKICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHsKICAgICAgICBvYmpUeXBlID0gT2JqZWN0VHlwZS5BUlJBWTsKICAgICAgfQoKICAgICAgdmFyIGZpZWxkU3RyaW5nID0gY2hhbmdlLmtleXBhdGg7CgogICAgICAvLyBjb25zb2xlLmxvZygnRmllbGQ6JywgZmllbGRTdHJpbmcpOwogICAgICAvLyBjb25zb2xlLmxvZygndHlwZTonLCBjaGFuZ2UudHlwZSk7CgogICAgICAvL2xldCBvbGRWYWx1ZSA9IGNoYW5nZS5vbGRWYWx1ZTsKICAgICAgdmFyIG5ld1ZhbHVlID0gb2JqW2NoYW5nZS5uYW1lXTsKCiAgICAgIGNvbnNvbGUuaW5mbyhjaGFuZ2UudHlwZSArICcgfCBGaWVsZDogJyArIGZpZWxkU3RyaW5nICsgJyB8IE5ldyBWYWx1ZTonLCAoMCwgX3N0cmluZ2lmeTIuZGVmYXVsdCkobmV3VmFsdWUpKTsKCiAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ3VwZGF0ZScpIHsKICAgICAgICB0aGlzLl9maXJlRXZlbnQoewogICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuVVBEQVRFLAogICAgICAgICAgb1R5cGU6IG9ialR5cGUsCiAgICAgICAgICBmaWVsZDogZmllbGRTdHJpbmcsCiAgICAgICAgICBkYXRhOiBuZXdWYWx1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdhZGQnKSB7CiAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLkFERCwKICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nLAogICAgICAgICAgZGF0YTogbmV3VmFsdWUKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAnZGVsZXRlJykgewogICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5SRU1PVkUsCiAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnZGF0YScsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7CiAgICB9CiAgfV0pOwogIHJldHVybiBTeW5jT2JqZWN0Owp9KCk7Cgp2YXIgQ2hhbmdlVHlwZSA9IGV4cG9ydHMuQ2hhbmdlVHlwZSA9IHsgVVBEQVRFOiAndXBkYXRlJywgQUREOiAnYWRkJywgUkVNT1ZFOiAncmVtb3ZlJyB9Owp2YXIgT2JqZWN0VHlwZSA9IGV4cG9ydHMuT2JqZWN0VHlwZSA9IHsgT0JKRUNUOiAnb2JqZWN0JywgQVJSQVk6ICdhcnJheScgfTsKZXhwb3J0cy5kZWZhdWx0ID0gU3luY09iamVjdDsKCi8qKiovIH0pLAovKiAxMjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX2dldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMSk7Cgp2YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFByb3RvdHlwZU9mKTsKCnZhciBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzgpOwoKdmFyIF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsKICBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7CiAgdmFyIGRlc2MgPSAoMCwgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIuZGVmYXVsdCkob2JqZWN0LCBwcm9wZXJ0eSk7CgogIGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsKICAgIHZhciBwYXJlbnQgPSAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShvYmplY3QpOwoKICAgIGlmIChwYXJlbnQgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOwogICAgfQogIH0gZWxzZSBpZiAoInZhbHVlIiBpbiBkZXNjKSB7CiAgICByZXR1cm4gZGVzYy52YWx1ZTsKICB9IGVsc2UgewogICAgdmFyIGdldHRlciA9IGRlc2MuZ2V0OwoKICAgIGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQoKICAgIHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDEyNCAqLywKLyogMTI1ICovLAovKiAxMjYgKi8sCi8qIDEyNyAqLywKLyogMTI4ICovLAovKiAxMjkgKi8sCi8qIDEzMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9wcm9taXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7Cgp2YXIgX3Byb21pc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvbWlzZSk7Cgp2YXIgX2Fzc2lnbiA9IF9fd2VicGFja19yZXF1aXJlX18oMTM2KTsKCnZhciBfYXNzaWduMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Fzc2lnbik7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOSk7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKdmFyIF9EYXRhUHJvdmlzaW9uYWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzMyk7Cgp2YXIgX0RhdGFQcm92aXNpb25hbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhUHJvdmlzaW9uYWwpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgoqIFRoZSBtYWluIGNsYXNzIGZvciB0aGUgc3luY2hlciBwYWNrYWdlLgoqIFRoZSBTeW5jaGVyIGlzIGEgc2luZ2xldG9uIGNsYXNzIHBlciBIeXBlcnR5L1VSTCBhbmQgaXQgaXMgdGhlIG93bmVyIG9mIGFsbCBjcmVhdGVkIERhdGEgU3luYyBPYmplY3RzIGFjY29yZGluZyB0byB0aGUgUmVwb3J0ZXIgLSBPYnNlcnZlciBwYXR0ZXJuLgoqIE1haW4gZnVuY3Rpb25hbGl0eSBpcyB0byBjcmVhdGUgcmVwb3J0ZXJzIGFuZCB0byBzdWJzY3JpYmUgdG8gZXhpc3Rpbmcgb25lcy4KKi8KdmFyIFN5bmNoZXIgPSBmdW5jdGlvbiAoKSB7CiAgLyogcHJpdmF0ZQogIF9vd25lcjogVVJMCiAgX2J1czogTWluaUJ1cwogICBfc3ViVVJMOiBVUkwKICAgX3JlcG9ydGVyczogPHVybDogRGF0YU9iamVjdFJlcG9ydGVyPgogIF9vYnNlcnZlcnM6IDx1cmw6IERhdGFPYmplY3RPYnNlcnZlcj4KICBfcHJvdmlzaW9uYWxzOiA8dXJsOiBEYXRhUHJvdmlzaW9uYWw+CiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25Ob3RpZmljYXRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICBfb25SZXN1bWU6IChldmVudCkgPT4gdm9pZAogICovCgogIC8qKgogICogQ29uc3RydWN0b3IgdGhhdCBzaG91bGQgYmUgdXNlZCBieSB0aGUgSHlwZXJ0eSBvd25lcgogICogQHBhcmFtIHtIeXBlcnR5VVJMfSBvd25lciAtIEh5cGVydHkgVVJMIG93bmVyLiBBbiBVUkwgYWxsb2NhdGVkIGJ5IHRoZSBydW50aW1lIHRoYXQgdW5pcXVlbHkgaWRlbnRpZmllcyB0aGUgSHlwZXJ0eS4KICAqIEBwYXJhbSB7TWluaUJ1c30gYnVzIC0gQW4gaW5zdGFuY2Ugb2YgdGhlIE1pbmlCdXMgcHJvdmlkZWQgaW4gdGhlIHNhbmRib3guIFdoZW4gYW4gb2JqZWN0IChSZXBvcnRlciBvciBPYnNlcnZlZCkgaXMgY3JlYXRlZCwgdGhlIFN5bmNoZXJNYW5hZ2VyIHdpbGwgYWRkIGEgbGlzdGVuZXIgaW4gdGhlIE1pbmlCdXMgdG8gcmVjZWl2ZS9zZW5kIE1lc3NhZ2VzIG9mIHRoYXQgb2JqZWN0LgogICogQHBhcmFtIHtKU09OfSBjb25maWcgLSBDb25maWd1cmF0aW9uIGRhdGEuIFRoZSBvbmx5IHJlcXVpcmVkIGZpZWxkIGZvciBub3cgaXMgdGhlIHJ1bnRpbWVVUkwuCiAgKi8KICBmdW5jdGlvbiBTeW5jaGVyKG93bmVyLCBidXMsIGNvbmZpZykgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgU3luY2hlcik7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl9idXMgPSBidXM7CgogICAgX3RoaXMuX3N1YlVSTCA9IGNvbmZpZy5ydW50aW1lVVJMICsgJy9zbSc7CgogICAgX3RoaXMuX3JlcG9ydGVycyA9IHt9OwogICAgX3RoaXMuX29ic2VydmVycyA9IHt9OwogICAgX3RoaXMuX3Byb3Zpc2lvbmFscyA9IHt9OwoKICAgIGJ1cy5hZGRMaXN0ZW5lcihvd25lciwgZnVuY3Rpb24gKG1zZykgewogICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCiAgICAgIGlmIChtc2cuZnJvbSAhPT0gb3duZXIpIHsKICAgICAgICBjb25zb2xlLmluZm8oJ1tTeW5jaGVyXSBTeW5jaGVyLVJDVjogJywgbXNnKTsKICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CiAgICAgICAgICBjYXNlICdmb3J3YXJkJzoKICAgICAgICAgICAgX3RoaXMuX29uRm9yd2FyZChtc2cpO2JyZWFrOwogICAgICAgICAgY2FzZSAnY3JlYXRlJzoKICAgICAgICAgICAgX3RoaXMuX29uUmVtb3RlQ3JlYXRlKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdkZWxldGUnOgogICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVEZWxldGUobXNnKTticmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH0KCiAgLyoqCiAgKiBUaGUgb3duZXIgb2YgdGhlIFN5bmNoZXIgYW5kIGFsbCBjcmVhdGVkIHJlcG9ydGVycy4KICAqIEB0eXBlIHtIeXBlcnR5VVJMfQogICovCgoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShTeW5jaGVyLCBbewogICAga2V5OiAnY3JlYXRlJywKCgogICAgLyoqCiAgICAqIFJlcXVlc3QgYSBEYXRhT2JqZWN0UmVwb3J0ZXIgY3JlYXRpb24uIFRoZSBVUkwgd2lsbCBiZSBiZSByZXF1ZXN0ZWQgYnkgdGhlIGFsbG9jYXRpb24gbWVjaGFuaXNtLgogICAgKiBAcGFyYW0gIHtTY2hlbWFVUkx9IHNjaGVtYSAtIEh5cGVydHkgQ2F0YWxvZ3VlIFVSTCBhZGRyZXNzIHRoYXQgY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIEpTT04tU2NoZW1hIGRlc2NyaWJpbmcgdGhlIERhdGEgT2JqZWN0IHNjaGVtYQogICAgKiBAcGFyYW0gIHtIeXBlcnR5VVJMW119IG9ic2VydmVycyAtIExpc3Qgb2YgaHlwZXJ0aWVzIHRoYXQgYXJlIHByZS1hdXRob3JpemVkIGZvciBzdWJzY3JpcHRpb24KICAgICogQHBhcmFtICB7SlNPTn0gaW5pdGlhbERhdGEgLSBJbml0aWFsIGRhdGEgb2YgdGhlIHJlcG9ydGVyCiAgICAqIEBwYXJhbSAge3N0cmluZ30gb2JqZWN0VVJMIC0gcmV1c2FibGUgZGF0YU9iamVjdCBVUkwKICAgICogQHJldHVybiB7UHJvbWlzZTxEYXRhT2JqZWN0UmVwb3J0ZXI+fSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBSZXBvcnRlci4gVGhlIHJlcG9ydGVyIGNhbiBiZSBhY2NlcHRlZCBvciByZWplY3RlZCBieSB0aGUgUEVQCiAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZShzY2hlbWEsIG9ic2VydmVycywgaW5pdGlhbERhdGEpIHsKICAgICAgdmFyIHN0b3JlID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKICAgICAgdmFyIHAycCA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogZmFsc2U7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgY3JpdGVyaWEgPSB7fTsKCiAgICAgIGNyaXRlcmlhLnAycCA9IHAycDsKICAgICAgY3JpdGVyaWEuc3RvcmUgPSBzdG9yZTsKICAgICAgY3JpdGVyaWEuc2NoZW1hID0gc2NoZW1hOwogICAgICBjcml0ZXJpYS5vYnNlcnZlcnMgPSBvYnNlcnZlcnM7CiAgICAgIGNyaXRlcmlhLmluaXRpYWxEYXRhID0gaW5pdGlhbERhdGE7CgogICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdIC0gY3JlYXRlIFJlcG9ydGVyIC0gY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCiAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShjcml0ZXJpYSwgeyByZXN1bWU6IGZhbHNlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9jcmVhdGUoY3JpdGVyaWEpOwogICAgfQogIH0sIHsKICAgIGtleTogJ3Jlc3VtZVJlcG9ydGVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzdW1lUmVwb3J0ZXJzKGNyaXRlcmlhKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSByZXN1bWUgUmVwb3J0ZXIgLSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogdHJ1ZSB9KTsKCiAgICAgIHJldHVybiBfdGhpcy5fY3JlYXRlKGNyaXRlcmlhKTsKICAgIH0KCiAgICAvKioKICAgICogUmVxdWVzdCBhIHN1YnNjcmlwdGlvbiB0byBhbiBleGlzdGVudCByZXBvcnRlciBvYmplY3QuCiAgICAqIEBwYXJhbSB7U2NoZW1hVVJMfSBzY2hlbWEgLSBIeXBlcnR5IENhdGFsb2d1ZSBVUkwgYWRkcmVzcyB0aGF0IGNhbiBiZSB1c2VkIHRvIHJldHJpZXZlIHRoZSBKU09OLVNjaGVtYSBkZXNjcmliaW5nIHRoZSBEYXRhIE9iamVjdCBzY2hlbWEKICAgICogQHBhcmFtIHtPYmplY3RVUkx9IG9ialVSTCAtIEFkZHJlc3Mgb2YgdGhlIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdCB0byBiZSBvYnNlcnZlZAogICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtzdG9yZT1mYWxzZV0gLSBTYXZlIHRoZSBzdWJzY3JpcHRpb24gb24gdGhlIFN5bmNoZXIgTWFuYWdlciBmb3IgZnVydGhlciByZXN1bWUgKERlZmF1bHQgaXMgZmFsc2UpCiAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3AycD1mYWxzZV0gLSBJbmZvIGFib3V0IGlmIHNob3VsZCB1c2UgcDJwIGNvbm5lY3Rpb24gKERlZmF1bHQgaXMgZmFsc2UpCiAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW211dHVhbD10cnVlXSAtIEluZm8gYWJvdXQgaWYgbWVzc2FnZXMgb2YgdGhpcyBvYmplY3Qgc2hvdWxkIGJlIGVuY3J5cHRlZCAoRGVmYXVsdCBpcyB0cnVlKQogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN1YnNjcmliZShzY2hlbWEsIG9ialVSTCkgewogICAgICB2YXIgc3RvcmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlOwogICAgICB2YXIgcDJwID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKICAgICAgdmFyIG11dHVhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogdHJ1ZTsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBjcml0ZXJpYSA9IHt9OwoKICAgICAgY3JpdGVyaWEucDJwID0gcDJwOwogICAgICBjcml0ZXJpYS5zdG9yZSA9IHN0b3JlOwogICAgICBjcml0ZXJpYS5zY2hlbWEgPSBzY2hlbWE7CiAgICAgIGNyaXRlcmlhLnJlc291cmNlID0gb2JqVVJMOwoKICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgICBjcml0ZXJpYS5tdXR1YWwgPSBtdXR1YWw7CgogICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBzdWJzY3JpYmVdIC0gc3Vic2NyaWJlIGNyaXRlcmlhOiAnLCBjcml0ZXJpYSk7CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiBmYWxzZSB9KTsKCiAgICAgIHJldHVybiBfdGhpcy5fc3Vic2NyaWJlKGNyaXRlcmlhKTsKICAgIH0KCiAgICAvKioKICAgICogUmVxdWVzdCBhIHN1YnNjcmlwdGlvbiB0byBhbiBleGlzdGVudCByZXBvcnRlciBvYmplY3QuCiAgICAqIEBwYXJhbSB7Y3JpdGVyaWF9IGNyaXRlcmlhIC0gSW5mb3JtYXRpb24gdG8gZGlzY292ZXJ5IHRoZSBvYnNlcnZlciBvYmplY3QKICAgICogQHJldHVybiB7UHJvbWlzZTxEYXRhT2JqZWN0T2JzZXJ2ZXI+fSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBvYnNlcnZlci4gSXQncyBhc3NvY2lhdGVkIHdpdGggdGhlIHJlcG9ydGVyLgogICAgKi8KCiAgfSwgewogICAga2V5OiAncmVzdW1lT2JzZXJ2ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVPYnNlcnZlcnMoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIF9jcml0ZXJpYSA9IGNyaXRlcmlhIHx8IHt9OwoKICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKF9jcml0ZXJpYSwgeyByZXN1bWU6IHRydWUgfSk7CgogICAgICByZXR1cm4gX3RoaXMuX3N1YnNjcmliZShfY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgcmVhZCBhY3Rpb24gb24gdGhlIHJlcG9ydGVyIG9iamVjdAogICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gVVJMIG9mIHRoZSByZXBvcnRlciBvYmplY3QgdG8gYmUgcmVhZAogICAgKiBAcmV0dXJuIHtQcm9taXNlPE9iamVjdD59IFJldHVybiBQcm9taXNlIHRvIGxhc3QgYXZhaWxhYmxlIGRhdGEgb2YgdGhlIHJlcG9ydGVyCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZWFkJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZWFkKG9ialVSTCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byByZXBvcnRlciBvYmplY3QgKG1heWJlIHRoZXJlIGlzIG5vIGxpc3RlbmVyIGF2YWlsYWJsZSwgc28gaXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIE1lc3NhZ2VCdXMgLT4gcmVzb2x2ZSkKICAgICAgLy93aWxsIHJlYWNoIHRoZSByZW1vdGUgb2JqZWN0IGluIERhdGFPYmplY3RSZXBvcnRlciAtPiBfb25SZWFkCiAgICAgIHZhciByZWFkTXNnID0gewogICAgICAgIHR5cGU6ICdyZWFkJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogb2JqVVJMCiAgICAgIH07CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlYWRNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5sb2coJ3JlYWQtcmVzcG9uc2U6ICcsIHJlcGx5KTsKICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICByZXNvbHZlKHJlcGx5LmJvZHkudmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyBjcmVhdGUgYW5kIGRlbGV0ZSBldmVudHMgb2YgcmVtb3ZlIFJlcG9ydGVyIG9iamVjdHMuCiAgICAqIFRoaXMgaXMgcmVsZWF0ZWQgdG8gdGhlIG1lc3NhZ2VucyBzZW50IGJ5IGNyZWF0ZSB0byB0aGUgb2JzZXJ2ZXJzIEh5cGVydHkgYXJyYXkuCiAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICovCgogIH0sIHsKICAgIGtleTogJ29uTm90aWZpY2F0aW9uJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvbk5vdGlmaWNhdGlvbihjYWxsYmFjaykgewogICAgICB0aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfY3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfY3JlYXRlKGNyaXRlcmlhKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB2YXIgcmVzdW1lID0gY3JpdGVyaWEucmVzdW1lOwogICAgICAgIHZhciBpbml0aWFsRGF0YSA9IGNyaXRlcmlhLmluaXRpYWxEYXRhIHx8IHt9OwogICAgICAgIHZhciBzY2hlbWEgPSB2b2lkIDA7CgogICAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uQ3JlYXRlCiAgICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CiAgICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N1YlVSTCwKICAgICAgICAgIGJvZHk6IHsgcmVzdW1lOiByZXN1bWUgfQogICAgICAgIH07CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV06ICcsIGNyaXRlcmlhLCByZXF1ZXN0TXNnKTsKCiAgICAgICAgcmVxdWVzdE1zZy5ib2R5LnZhbHVlID0gaW5pdGlhbERhdGE7CiAgICAgICAgcmVxdWVzdE1zZy5ib2R5LnZhbHVlLnJlcG9ydGVyID0gX3RoaXMuX293bmVyOwoKICAgICAgICBpZiAoY3JpdGVyaWEuc2NoZW1hKSB7CiAgICAgICAgICBzY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CiAgICAgICAgICByZXF1ZXN0TXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNyaXRlcmlhLnAycCkgcmVxdWVzdE1zZy5ib2R5LnAycCA9IGNyaXRlcmlhLnAycDsKICAgICAgICBpZiAoY3JpdGVyaWEuc3RvcmUpIHJlcXVlc3RNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlOwogICAgICAgIGlmIChjcml0ZXJpYS5vYnNlcnZlcnMpIHJlcXVlc3RNc2cuYm9keS5hdXRob3Jpc2UgPSBjcml0ZXJpYS5vYnNlcnZlcnM7CgogICAgICAgIGlmIChyZXN1bWUpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSByZXN1bWUgbWVzc2FnZTogJywgcmVxdWVzdE1zZyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUgbWVzc2FnZTogJywgcmVxdWVzdE1zZyk7CiAgICAgICAgfQoKICAgICAgICAvL3JlcXVlc3QgY3JlYXRlIHRvIHRoZSBhbGxvY2F0aW9uIHN5c3RlbS4gQ2FuIGJlIHJlamVjdGVkIGJ5IHRoZSBQb2xpY3lFbmdpbmUuCiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXF1ZXN0TXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUtcmVzcG9uc2U6ICcsIHJlcGx5KTsKICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICAvL3JlcG9ydGVyIGNyZWF0aW9uIGFjY2VwdGVkCiAgICAgICAgICAgIHZhciBvYmpVUkwgPSByZXBseS5ib2R5LnJlc291cmNlOwoKICAgICAgICAgICAgaWYgKHJlc3VtZSkgewogICAgICAgICAgICAgIHNjaGVtYSA9IHJlcGx5LmJvZHkuc2NoZW1hOwogICAgICAgICAgICAgIGluaXRpYWxEYXRhID0gcmVwbHkuYm9keS52YWx1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIG5ld09iaiA9IG5ldyBfRGF0YU9iamVjdFJlcG9ydGVyMi5kZWZhdWx0KF90aGlzLCBvYmpVUkwsIHNjaGVtYSwgJ29uJywgaW5pdGlhbERhdGEsIHJlcGx5LmJvZHkuY2hpbGRyZW5SZXNvdXJjZXMpOwogICAgICAgICAgICBfdGhpcy5fcmVwb3J0ZXJzW29ialVSTF0gPSBuZXdPYmo7CgogICAgICAgICAgICByZXNvbHZlKG5ld09iaik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvL3JlcG9ydGVyIGNyZWF0aW9uIHJlamVjdGVkCiAgICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfc3Vic2NyaWJlKGNyaXRlcmlhKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25Mb2NhbFN1YnNjcmliZQogICAgICAgIHZhciBzdWJzY3JpYmVNc2cgPSB7CiAgICAgICAgICB0eXBlOiAnc3Vic2NyaWJlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N1YlVSTCwKICAgICAgICAgIGJvZHk6IHt9CiAgICAgICAgfTsKCiAgICAgICAgLy8gSHlwZXJ0eSByZXF1ZXN0IHRvIGJlIGFuIE9ic2VydmVyCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjaHlwZXJ0eS1yZXF1ZXN0LXRvLWJlLWFuLW9ic2VydmVyCgogICAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciB0aGUgc2FtZSBIeXBlcnR5IFVSTAogICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3Qvc3BlY3MvYmxvYi9tYXN0ZXIvbWVzc2FnZXMvZGF0YS1zeW5jLW1lc3NhZ2VzLm1kI3Jlc3VtZS1zdWJzY3JpcHRpb25zLWZvci10aGUtc2FtZS1oeXBlcnR5LXVybAoKICAgICAgICAvLyBSZXN1bWUgU3Vic2NyaXB0aW9ucyBmb3IgYSBjZXJ0YWluIHVzZXIgYW5kIGRhdGEgc2NoZW1hIGluZGVwZW5kZW50bHkgb2YgdGhlIEh5cGVydHkgVVJMLgogICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3Qvc3BlY3MvYmxvYi9tYXN0ZXIvbWVzc2FnZXMvZGF0YS1zeW5jLW1lc3NhZ2VzLm1kI3Jlc3VtZS1zdWJzY3JpcHRpb25zLWZvci1hLWNlcnRhaW4tdXNlci1hbmQtZGF0YS1zY2hlbWEtaW5kZXBlbmRlbnRseS1vZi10aGUtaHlwZXJ0eS11cmwKICAgICAgICBpZiAoY3JpdGVyaWEpIHsKICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgncDJwJykpIHN1YnNjcmliZU1zZy5ib2R5LnAycCA9IGNyaXRlcmlhLnAycDsKICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgnc3RvcmUnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc3RvcmUgPSBjcml0ZXJpYS5zdG9yZTsKICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgnc2NoZW1hJykpIHN1YnNjcmliZU1zZy5ib2R5LnNjaGVtYSA9IGNyaXRlcmlhLnNjaGVtYTsKICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgnaWRlbnRpdHknKSkgc3Vic2NyaWJlTXNnLmJvZHkuaWRlbnRpdHkgPSBjcml0ZXJpYS5pZGVudGl0eTsKICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgncmVzb3VyY2UnKSkgc3Vic2NyaWJlTXNnLmJvZHkucmVzb3VyY2UgPSBjcml0ZXJpYS5yZXNvdXJjZTsKICAgICAgICB9CgogICAgICAgIHN1YnNjcmliZU1zZy5ib2R5LnJlc3VtZSA9IGNyaXRlcmlhLnJlc3VtZTsKCiAgICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgICAgIHZhciBtdXR1YWxBdXRoZW50aWNhdGlvbiA9IGNyaXRlcmlhLm11dHVhbDsKICAgICAgICBpZiAoIW11dHVhbEF1dGhlbnRpY2F0aW9uKSBzdWJzY3JpYmVNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbEF1dGhlbnRpY2F0aW9uOwoKICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gc3Vic2NyaWJlIG1lc3NhZ2U6ICcsIGNyaXRlcmlhLCBzdWJzY3JpYmVNc2cpOwoKICAgICAgICAvL3JlcXVlc3Qgc3Vic2NyaXB0aW9uCiAgICAgICAgLy9Qcm92aXNpb25hbCBkYXRhIGlzIGFwcGxpZWQgdG8gdGhlIERhdGFPYmplY3RPYnNlcnZlciBhZnRlciBjb25maXJtYXRpb24uIE9yIGRpc2NhcmRlZCBpZiB0aGVyZSBpcyBubyBjb25maXJtYXRpb24uCiAgICAgICAgLy9mb3IgbW9yZSBpbmZvIHNlZSB0aGUgRGF0YVByb3Zpc2lvbmFsIGNsYXNzIGRvY3VtZW50YXRpb24uCiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShzdWJzY3JpYmVNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIHN1YnNjcmliZS1yZXNwb25zZTogJywgcmVwbHkpOwoKICAgICAgICAgIHZhciBzY2hlbWEgPSByZXBseS5ib2R5LnNjaGVtYTsKICAgICAgICAgIHZhciBvYmpVUkwgPSByZXBseS5ib2R5LnJlc291cmNlOwoKICAgICAgICAgIHZhciBuZXdQcm92aXNpb25hbCA9IF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF07CiAgICAgICAgICBpZiAobmV3UHJvdmlzaW9uYWwpIG5ld1Byb3Zpc2lvbmFsLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA8IDIwMCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gbmV3IERhdGFQcm92aXNpb25hbDogJywgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcywgb2JqVVJMKTsKICAgICAgICAgICAgbmV3UHJvdmlzaW9uYWwgPSBuZXcgX0RhdGFQcm92aXNpb25hbDIuZGVmYXVsdChfdGhpcy5fb3duZXIsIG9ialVSTCwgX3RoaXMuX2J1cywgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CiAgICAgICAgICAgIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXSA9IG5ld1Byb3Zpc2lvbmFsOwogICAgICAgICAgfSBlbHNlIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gbmV3IERhdGEgT2JqZWN0IE9ic2VydmVyOiAnLCByZXBseSwgX3RoaXMuX3Byb3Zpc2lvbmFscyk7CgogICAgICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgICAgIHZhciBuZXdPYmogPSBuZXcgX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdChfdGhpcywgb2JqVVJMLCBzY2hlbWEsICdvbicsIHJlcGx5LmJvZHkudmFsdWUsIG5ld1Byb3Zpc2lvbmFsLmNoaWxkcmVuLCByZXBseS5ib2R5LnZlcnNpb24sIG11dHVhbEF1dGhlbnRpY2F0aW9uKTsKICAgICAgICAgICAgX3RoaXMuX29ic2VydmVyc1tvYmpVUkxdID0gbmV3T2JqOwoKICAgICAgICAgICAgcmVzb2x2ZShuZXdPYmopOwogICAgICAgICAgICBuZXdQcm92aXNpb25hbC5hcHBseShuZXdPYmopOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgbG9jYWwgcnVudGltZSBSZXBvcnRlck9iamVjdCAtPiBfb25SZW1vdGVTdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uRm9yd2FyZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRm9yd2FyZChtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciByZXBvcnRlciA9IF90aGlzLl9yZXBvcnRlcnNbbXNnLmJvZHkudG9dOwogICAgICByZXBvcnRlci5fb25Gb3J3YXJkKG1zZyk7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgU3luY2hlciAtPiBjcmVhdGUgKHRoaXMgaXMgYWN0dWFsbHkgYW4gaW52aXRhdGlvbiB0byBzdWJzY3JpYmUpCgogIH0sIHsKICAgIGtleTogJ19vblJlbW90ZUNyZWF0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVtb3RlQ3JlYXRlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9yZW1vdmUgIi9zdWJzY3JpcHRpb24iIGZyb20gdGhlIFVSTAogICAgICB2YXIgcmVzb3VyY2UgPSBtc2cuZnJvbS5zbGljZSgwLCAtMTMpOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIGZyb206IG1zZy5ib2R5LnNvdXJjZSwKICAgICAgICB1cmw6IHJlc291cmNlLAogICAgICAgIHNjaGVtYTogbXNnLmJvZHkuc2NoZW1hLAogICAgICAgIHZhbHVlOiBtc2cuYm9keS52YWx1ZSwKICAgICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHksCgogICAgICAgIGFjazogZnVuY3Rpb24gYWNrKHR5cGUpIHsKICAgICAgICAgIHZhciBsVHlwZSA9IDIwMDsKICAgICAgICAgIGlmICh0eXBlKSB7CiAgICAgICAgICAgIGxUeXBlID0gdHlwZTsKICAgICAgICAgIH0KCiAgICAgICAgICAvL3NlbmQgYWNrIHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiBsVHlwZSB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUuaW5mbygnW1N5bmNoZXJdIE5PVElGSUNBVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdFJlcG9ydGVyIC0+IGRlbGV0ZQoKICB9LCB7CiAgICBrZXk6ICdfb25SZW1vdGVEZWxldGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlbW90ZURlbGV0ZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vcmVtb3ZlICIvc3Vic2NyaXB0aW9uIiBmcm9tIHRoZSBVUkwKICAgICAgdmFyIHJlc291cmNlID0gbXNnLmJvZHkucmVzb3VyY2U7CgogICAgICB2YXIgb2JqZWN0ID0gX3RoaXMuX29ic2VydmVyc1tyZXNvdXJjZV07CiAgICAgIGlmIChvYmplY3QpIHsKICAgICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICAgIHVybDogcmVzb3VyY2UsCiAgICAgICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHksCgogICAgICAgICAgYWNrOiBmdW5jdGlvbiBhY2sodHlwZSkgewogICAgICAgICAgICB2YXIgbFR5cGUgPSAyMDA7CiAgICAgICAgICAgIGlmICh0eXBlKSB7CiAgICAgICAgICAgICAgbFR5cGUgPSB0eXBlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL1RPRE86IGFueSBvdGhlciBkaWZmZXJlbnQgb3B0aW9ucyBmb3IgdGhlIHJlbGVhc2UgcHJvY2VzcywgbGlrZSBhY2NlcHQgYnV0IG5vciByZWxlYXNlIGxvY2FsPwogICAgICAgICAgICBpZiAobFR5cGUgPT09IDIwMCkgewogICAgICAgICAgICAgIG9iamVjdC5kZWxldGUoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9zZW5kIGFjayByZXNwb25zZSBtZXNzYWdlCiAgICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICAgIGJvZHk6IHsgY29kZTogbFR5cGUsIHNvdXJjZTogX3RoaXMuX293bmVyIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgaWYgKF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdOT1RJRklDQVRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICAgIF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIoZXZlbnQpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgYm9keTogeyBjb2RlOiA0MDQsIHNvdXJjZTogX3RoaXMuX293bmVyIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ293bmVyJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fb3duZXI7CiAgICB9CgogICAgLyoqCiAgICAqIEFsbCBvd25lZCByZXBvcnRlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgY3JlYXRlCiAgICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0UmVwb3J0ZXI+fQogICAgKi8KCiAgfSwgewogICAga2V5OiAncmVwb3J0ZXJzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fcmVwb3J0ZXJzOwogICAgfQoKICAgIC8qKgogICAgKiBBbGwgb3duZWQgb2JzZXJ2ZXJzLCB0aGUgb25lcyB0aGF0IHdlcmUgY3JlYXRlZCBieSBhIGxvY2FsIHN1YnNjcmlwdGlvbgogICAgKiBAdHlwZSB7T2JqZWN0PFVSTCwgRGF0YU9iamVjdE9ic2VydmVyPn0KICAgICovCgogIH0sIHsKICAgIGtleTogJ29ic2VydmVycycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX29ic2VydmVyczsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFN5bmNoZXI7Cn0oKTsgLyoqCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQogICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KICAgICAqCiAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICoKICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAgICAgKgogICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAgICAgKiovCgpleHBvcnRzLmRlZmF1bHQgPSBTeW5jaGVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMzEgKi8sCi8qIDEzMiAqLywKLyogMTMzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwoKLyoqCiAqIEBhY2Nlc3MgcHJpdmF0ZQogKiBUaGlzIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvciBjb2xsZWN0aW5nIGRlbHRhIGNoYW5nZXMgaW4gcmVtb3RlIG9iamVjdHMsIGJlZm9yZSB0aGUgcmVzcG9uc2Ugb2Ygc3Vic2NyaXB0aW9uIHJlYWNoIHRoZSBvYnNlcnZlci4KICogSXQncyB1c2VkIGluIFN5bmNoZXIgLT4gc3Vic2NyaWJlLiBUaGUgZmxvdyBpcyBkZWZpbmVkIGFzOgogKiAxLiAob2JzZXJ2ZXIpIC0tc3Vic2NyaWJlLS0+IChyZXBvcnRlcikKICogMi4gKG9ic2VydmVyKSA8LS1kZWx0YSB1cGRhdGVzLS0gKHJlcG9ydGVyKQogKiAzLiAob2JzZXJ2ZXIpIDwtLXN1YnNjcmliZSByZXNwb25zZS0tIChyZXBvcnRlcikKICogVGhpcyBtZWFucyB0aGF0IHRoZXJlIGNvdWxkIGJlIGRlbHRhIHVwZGF0ZXMgdHJhbnNmZXJyZWQgYmVmb3JlIHRoZSBzdWJzY3JpcHRpb24gY29uZmlybWF0aW9uLgogKiBTaW5jZSB0aGVyZSBpcyBubyBEYXRhT2JqZWN0T2JzZXJ2ZXIgYmVmb3JlIHRoZSB1YnNjcmlwdGlvbiBjb25maXJtYXRpb24sIHRoZXJlIHNob3VsZCBiZSBzb21lIG90aGVyIG9iamVjdCBjb2xsZWN0aW5nIHRoZSB1cGRhdGVzLgogKiBQcm92aXNpb25hbCBkYXRhIGlzIGFwcGxpZWQgdG8gdGhlIERhdGFPYmplY3RPYnNlcnZlciBhZnRlciBjb25maXJtYXRpb24uIE9yIGRpc2NhcmRlZCBpZiB0aGVyZSBpcyBubyBjb25maXJtYXRpb24uCiAqLwp2YXIgRGF0YVByb3Zpc2lvbmFsID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICBfY2hpbGRyZW5MaXN0ZW5lcnM6IFtNc2dMaXN0ZW5lcl0KICBfbGlzdGVuZXI6IE1zZ0xpc3RlbmVyCiAgIF9jaGFuZ2VzOiBbXQogICovCgogIGZ1bmN0aW9uIERhdGFQcm92aXNpb25hbChvd25lciwgdXJsLCBidXMsIGNoaWxkcmVuKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBEYXRhUHJvdmlzaW9uYWwpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX293bmVyID0gb3duZXI7CiAgICBfdGhpcy5fdXJsID0gdXJsOwogICAgX3RoaXMuX2J1cyA9IGJ1czsKICAgIF90aGlzLl9jaGlsZHJlbiA9IGNoaWxkcmVuOwoKICAgIF90aGlzLl9jaGFuZ2VzID0gW107CiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICB9CgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERhdGFQcm92aXNpb25hbCwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2xpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFQcm92aXNpb25hbC0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwogICAgICAgIF90aGlzLl9jaGFuZ2VzLnB1c2gobXNnKTsKICAgICAgfSk7CgogICAgICAvKgogICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTsKICAgICAgaWYgKF90aGlzLl9jaGlsZHJlbikgewogICAgICAgIGxldCBjaGlsZEJhc2VVUkwgPSB1cmwgKyAnL2NoaWxkcmVuLyc7CiAgICAgICAgX3RoaXMuX2NoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7CiAgICAgICAgICBsZXQgY2hpbGRVUkwgPSBjaGlsZEJhc2VVUkwgKyBjaGlsZDsKICAgICAgICAgIGxldCBsaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoY2hpbGRVUkwsIChtc2cpID0+IHsKICAgICAgICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZgogICAgICAgICAgICBpZiAobXNnLmZyb20gIT09IG93bmVyKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2cobXNnKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpOwogICAgICAgIH0pOwogICAgICB9Ki8KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fbGlzdGVuZXIucmVtb3ZlKCk7CgogICAgICAvKl90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5mb3JFYWNoKChsaXN0ZW5lcikgPT4gewogICAgICAgIGxpc3RlbmVyLnJlbW92ZSgpOwogICAgICB9KTsqLwogICAgfQogIH0sIHsKICAgIGtleTogJ2FwcGx5JywKICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBseShvYnNlcnZlcikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBfdGhpcy5fY2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uIChjaGFuZ2UpIHsKICAgICAgICBvYnNlcnZlci5fY2hhbmdlT2JqZWN0KG9ic2VydmVyLl9zeW5jT2JqLCBjaGFuZ2UpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdjaGlsZHJlbicsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YVByb3Zpc2lvbmFsOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhUHJvdmlzaW9uYWw7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEzNCAqLywKLyogMTM1ICovLAovKiAxMzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygxNDMpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogMTM3ICovLAovKiAxMzggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygxNDUpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogMTM5ICovLAovKiAxNDAgKi8sCi8qIDE0MSAqLywKLyogMTQyICovLAovKiAxNDMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygxNDkpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0LmFzc2lnbjsKCi8qKiovIH0pLAovKiAxNDQgKi8sCi8qIDE0NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDE1MSk7CnZhciAkT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Q7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpewogIHJldHVybiAkT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KTsKfTsKCi8qKiovIH0pLAovKiAxNDYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKLy8gMTkuMS4yLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSwgLi4uKQp2YXIgZ2V0S2V5cyAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QUyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU4KQogICwgcElFICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQxKQogICwgdG9PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgSU9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU2KQogICwgJGFzc2lnbiAgPSBPYmplY3QuYXNzaWduOwoKLy8gc2hvdWxkIHdvcmsgd2l0aCBzeW1ib2xzIGFuZCBzaG91bGQgaGF2ZSBkZXRlcm1pbmlzdGljIHByb3BlcnR5IG9yZGVyIChWOCBidWcpCm1vZHVsZS5leHBvcnRzID0gISRhc3NpZ24gfHwgX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICB2YXIgQSA9IHt9CiAgICAsIEIgPSB7fQogICAgLCBTID0gU3ltYm9sKCkKICAgICwgSyA9ICdhYmNkZWZnaGlqa2xtbm9wcXJzdCc7CiAgQVtTXSA9IDc7CiAgSy5zcGxpdCgnJykuZm9yRWFjaChmdW5jdGlvbihrKXsgQltrXSA9IGs7IH0pOwogIHJldHVybiAkYXNzaWduKHt9LCBBKVtTXSAhPSA3IHx8IE9iamVjdC5rZXlzKCRhc3NpZ24oe30sIEIpKS5qb2luKCcnKSAhPSBLOwp9KSA/IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQsIHNvdXJjZSl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICB2YXIgVCAgICAgPSB0b09iamVjdCh0YXJnZXQpCiAgICAsIGFMZW4gID0gYXJndW1lbnRzLmxlbmd0aAogICAgLCBpbmRleCA9IDEKICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZgogICAgLCBpc0VudW0gICAgID0gcElFLmY7CiAgd2hpbGUoYUxlbiA+IGluZGV4KXsKICAgIHZhciBTICAgICAgPSBJT2JqZWN0KGFyZ3VtZW50c1tpbmRleCsrXSkKICAgICAgLCBrZXlzICAgPSBnZXRTeW1ib2xzID8gZ2V0S2V5cyhTKS5jb25jYXQoZ2V0U3ltYm9scyhTKSkgOiBnZXRLZXlzKFMpCiAgICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgKICAgICAgLCBqICAgICAgPSAwCiAgICAgICwga2V5OwogICAgd2hpbGUobGVuZ3RoID4gailpZihpc0VudW0uY2FsbChTLCBrZXkgPSBrZXlzW2orK10pKVRba2V5XSA9IFNba2V5XTsKICB9IHJldHVybiBUOwp9IDogJGFzc2lnbjsKCi8qKiovIH0pLAovKiAxNDcgKi8sCi8qIDE0OCAqLywKLyogMTQ5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMy4xIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBzb3VyY2UpCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GLCAnT2JqZWN0Jywge2Fzc2lnbjogX193ZWJwYWNrX3JlcXVpcmVfXygxNDYpfSk7CgovKioqLyB9KSwKLyogMTUwICovLAovKiAxNTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKQp2YXIgdG9JT2JqZWN0ICAgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NykuZjsKCl9fd2VicGFja19yZXF1aXJlX18oNDUpKCdnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3InLCBmdW5jdGlvbigpewogIHJldHVybiBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7CiAgICByZXR1cm4gJGdldE93blByb3BlcnR5RGVzY3JpcHRvcih0b0lPYmplY3QoaXQpLCBrZXkpOwogIH07Cn0pOwoKLyoqKi8gfSksCi8qIDE1MiAqLywKLyogMTUzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vICAgICBwcm94eS1vYnNlcnZlIHYwLjAuMTgNCi8vICAgICBDb3B5cmlnaHQgKGMpIDIwMTUsIDIwMTYgU2ltb24gWS4gQmxhY2t3ZWxsLCBBbnlXaGljaFdheQ0KLy8gICAgIE1JVCBMaWNlbnNlIC0gaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocA0KKGZ1bmN0aW9uKCkgew0KCSJ1c2Ugc3RyaWN0IjsNCgkvLyBDcmVhdGVzIGFuZCByZXR1cm5zIGEgUHJveHkgd3JhcHBpbmcgYSB0YXJnZXQgc28gdGhhdCBhbGwgY2hhbmdlcyBjYW4gYmUgdHJhcHBlZCBhbmQgZm9yd2FyZGVkIHRvDQoJLy8gYSBjYWxsYmFjay4gVGhlIGNhbGxiYWNrIHRha2VzIGFuIGFycmF5IG9mIGNoYW5nZXMganVzdCBsaWtlIHRoZSB0cmFkaXRpb25hbCBvcmlnaW5hbCBDaHJvbWUgT2JqZWN0Lm9ic2VydmUNCgkvLyB7b2JqZWN0OjxvYmplY3QgY2hhbmdlZD4sbmFtZTo8ZmllbGQgY2hhbmdlZD4sdHlwZTphZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUsb2xkVmFsdWU6PG9sZCB2YWx1ZSBpZiB1cGRhdGUgfCBkZWxldGU+fQ0KCS8vIFRoZSBhY2NlcHRsaXN0IGNhbiBiZSBhZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUuDQoJLy8gdiAwLjAuMTAgdG8gc3VwcG9ydCBwYXVzaW5nIGFuZCByZXN0YXJ0aW5nIG9ic2VydmF0aW9uIHR3byBhZGRpdGlvbmFsIGNvbnN0cnVjdG9yIGFyZ3VtZW50cyBhcmUgYXZhaWxhYmxlIHRvIE9iamVjdC5vYnNlcnZlOg0KCS8vIHBhdXNhYmxlIC0gY3JlYXRlIHRoZSBPYnNlcnZlciBzbyBpdCBjYW4gYmUgcGF1c2VkDQoJLy8gcGF1c2UgLSBjcmVhdGUgb2JzZXJ2ZXIgaW4gcGF1c2VkIHN0YXRlDQoJLy8gaWYgcGF1c2FibGUgaXMgdHJ1ZSB0aGVuIGFuIGFkZGl0aW9uYWwgbWV0aG9kIGRlbGl2ZXIoaWdub3JlUHJldmlvdXMpIGlzIGF2YWlsYWJsZSB0byBzdGFydCBkZWxpdmVyeQ0KCS8vIHRvIHBhdXNlIGRlbGl2ZXJ5IHNldCBhIHByb3BlcnR5IGNhbGxlZCBwYXVzZSBvbiB0aGUgZnVuY3Rpb24gZGVsaXZlciB0byB0cnVlDQoJLy8gcGF1c2FibGUgaXMgb3B0aW9uYWwgdG8gcmVkdWNlIHRoZSBjaGFuY2Ugb2Ygc2hhZG93aW5nIGEgcHJvcGVydHkgb3IgbWV0aG9kIG9uIGFueSBleGlzdGluZyBjb2RlIGNhbGxlZCBkZWxpdmVyDQoJaWYoIU9iamVjdC5vYnNlcnZlICYmIHR5cGVvZihQcm94eSk9PT0iZnVuY3Rpb24iKSB7DQoJCWZ1bmN0aW9uIE9ic2VydmVyKHRhcmdldCxjYWxsYmFjayxhY2NlcHRsaXN0LHBhdXNhYmxlLHBhdXNlLGRlbGF5KSB7DQoJICAgIAl2YXIgbWUgPSB0aGlzLCBwcm94eTsNCgkgICAgCWZ1bmN0aW9uIGRlbGl2ZXIoaWdub3JlUHJldmlvdXMsZGVsYXkpIHsNCgkgICAgCQlkZWxpdmVyLmRlbGF5ID0gZGVsYXk7DQoJICAgIAkJaWYoIWRlbGl2ZXIucGF1c2UpIHsNCgkgICAgICAgIAkJaWYobWUuY2hhbmdlc2V0Lmxlbmd0aD4wKSB7DQoJICAgICAgICAJCQlpZighaWdub3JlUHJldmlvdXMpIHsNCgkJICAgIAkgICAgCQl2YXIgY2hhbmdlcyA9IG1lLmNoYW5nZXNldC5maWx0ZXIoZnVuY3Rpb24oY2hhbmdlKSB7IHJldHVybiAhYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wOyB9KTsNCgkJICAgICAgICAJCQlpZihjaGFuZ2VzLmxlbmd0aD4wKSB7DQoJCSAgICAgICAgCQkJCWNhbGxiYWNrKGNoYW5nZXMpOw0KCQkgICAgICAgIAkJCX0NCgkgICAgICAgIAkJCX0NCgkgICAgICAgIAkJCW1lLmNoYW5nZXNldCA9IFtdOw0KCSAgICAgICAgCQl9DQoJICAgIAkJfQ0KCSAgICAJfQ0KCSAgICAJZGVsaXZlci5wYXVzZSA9IHBhdXNlOw0KCSAgICAJZGVsaXZlci5kZWxheSA9IGRlbGF5Ow0KCQkgICAgbWUuZ2V0ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSkgew0KCQkgICAgCWlmKHByb3BlcnR5PT09Il9fb2JzZXJ2ZXJfXyIpIHsNCgkJICAgIAkJcmV0dXJuIG1lOw0KCQkgICAgCX0NCgkJICAgIAlpZihwcm9wZXJ0eT09PSJ1bm9ic2VydmUiKSB7DQoJCSAgICAJCXJldHVybiBmdW5jdGlvbigpIHsNCgkJICAgIAkJCU9iamVjdC51bm9ic2VydmUodGFyZ2V0KTsNCgkJICAgIAkJCXJldHVybiB0YXJnZXQ7DQoJCSAgICAJCX07DQoJCSAgICAJfQ0KCQkgICAgCWlmKHByb3BlcnR5PT09ImRlbGl2ZXIiKSB7DQoJCSAgICAJCXJldHVybiBkZWxpdmVyOw0KCQkgICAgCX0NCgkJICAgIAlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsNCgkJICAgIH0NCgkgICAgCW1lLnRhcmdldCA9IHRhcmdldDsNCgkgICAgCW1lLmNoYW5nZXNldCA9IFtdOw0KCSAgICAJaWYoIW1lLnRhcmdldC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsNCgkgICAgCQkvLyBfX29ic2VydmVyQ2FsbGJhY2tzX18gaXMgdXNlZCBhcyBhbiBpbmRleCB0byBnZXQgYXQgdGhlIHByb3h5IHdoaWNoIGlzIHRoZSBvYnNlcnZlciwgc28gd2UgY2FuIHVub2JzZXJ2ZQ0KCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJDYWxsYmFja3NfXyIse2VudW1lcmFibGU6ZmFsc2UsY29uZmlndXJhYmxlOnRydWUsd3JpdGFibGU6ZmFsc2UsdmFsdWU6W119KTsNCgkgICAgCQlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCJfX29ic2VydmVyc19fIix7ZW51bWVyYWJsZTpmYWxzZSxjb25maWd1cmFibGU6dHJ1ZSx3cml0YWJsZTpmYWxzZSx2YWx1ZTpbXX0pOw0KCSAgICAJfQ0KCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5wdXNoKGNhbGxiYWNrKTsNCgkgICAgCW1lLnRhcmdldC5fX29ic2VydmVyc19fLnB1c2godGhpcyk7DQoJICAgIAlwcm94eSA9IG5ldyBQcm94eSh0YXJnZXQsbWUpOw0KCSAgICAJZGVsaXZlcihmYWxzZSxkZWxheSk7DQoJICAgIAlyZXR1cm4gcHJveHk7DQoJICAgIH0NCgkJT2JzZXJ2ZXIucHJvdG90eXBlLmRlbGl2ZXIgPSBmdW5jdGlvbigpIHsNCgkJCXJldHVybiB0aGlzLmdldChudWxsLCJkZWxpdmVyIik7DQoJCX0NCgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIHZhbHVlKSB7IC8vICwgcmVjZWl2ZXINCgkgICAgCXZhciBvbGR2YWx1ZSA9IHRhcmdldFtwcm9wZXJ0eV07DQoJICAgIAl2YXIgdHlwZSA9IChvbGR2YWx1ZT09PXVuZGVmaW5lZCA/ICJhZGQiIDogInVwZGF0ZSIpOw0KCSAgICAJdGFyZ2V0W3Byb3BlcnR5XSA9IHZhbHVlOw0KCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAoIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZih0eXBlKT49MCkpIHsNCgkgICAgICAgIAl2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsbmFtZTpwcm9wZXJ0eSx0eXBlOnR5cGV9LA0KCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkgICAgICAgIAkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOw0KCSAgICAgICAgCWlmKHR5cGU9PT0idXBkYXRlIikgew0KCSAgICAgICAgCQljaGFuZ2Uub2xkVmFsdWUgPSBvbGR2YWx1ZTsNCgkgICAgICAgIAl9DQoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJICAgICAgICAJfQ0KCSAgICAJfQ0KCSAgICAJcmV0dXJuIHRydWU7DQoJICAgIH07DQoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWxldGVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsNCgkgICAgCXZhciBvbGR2YWx1ZSA9IHRhcmdldFtwcm9wZXJ0eV07DQoJICAgIAkvL2lmKHR5cGVvZihvbGR2YWx1ZSkhPT0idW5kZWZpbmVkIikgew0KCQkgICAgCWRlbGV0ZSB0YXJnZXRbcHJvcGVydHldOw0KCQkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigiZGVsZXRlIik+PTApIHsNCgkJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZToiZGVsZXRlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sDQoJCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkJICAgICAgICAJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsNCgkJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCQkgICAgICAgIAlpZihzdGFydCkgew0KCQkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkJICAgICAgICAJfQ0KCQkgICAgCX0NCgkgICAgCS8vfQ0KCSAgICAJcmV0dXJuIHRydWU7DQoJICAgIH07DQoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIGRlc2NyaXB0b3IpIHsNCgkgICAgCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5LCBkZXNjcmlwdG9yKTsNCgkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigicmVjb25maWd1cmUiKT49MCkgew0KCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6InJlY29uZmlndXJlIn0sDQogICAgICAgIAkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLA0KICAgICAgICAJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7DQoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJICAgICAgICAJfQ0KCSAgICAJfQ0KCSAgICAJcmV0dXJuIHRydWU7DQoJICAgIH07DQoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5zZXRQcm90b3R5cGVPZiA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvdG90eXBlKSB7DQoJICAgIAl2YXIgb2xkdmFsdWUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KTsNCgkgICAgCU9iamVjdC5zZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSk7DQoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInNldFByb3RvdHlwZSIpPj0wKSB7DQoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6Il9fcHJvdG9fXyIsdHlwZToic2V0UHJvdG90eXBlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sDQogICAgCQkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLA0KICAgIAkJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7DQoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJICAgICAgICAJfQ0KCSAgICAJfQ0KCSAgICAJcmV0dXJuIHRydWU7DQoJICAgIH07DQoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5wcmV2ZW50RXh0ZW5zaW9ucyA9IGZ1bmN0aW9uKHRhcmdldCkgew0KCSAgICAgICAgT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKHRhcmdldCk7DQoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInByZXZlbnRFeHRlbnNpb25zIik+PTApIHsNCgkgICAgICAgIAl2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsdHlwZToicHJldmVudEV4dGVuc2lvbnMifSwNCgkJCQkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsDQoJCQkJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsNCgkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7DQoJICAgICAgICAJaWYoc3RhcnQpIHsNCgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkgICAgICAgIAl9DQoJICAgIAl9DQoJICAgIAlyZXR1cm4gdHJ1ZTsNCgkgICAgfTsNCgkgICAgT2JqZWN0Lm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgew0KCSAgICAJcmV0dXJuIG5ldyBPYnNlcnZlcihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSk7DQoJICAgIH07DQoJICAgIE9iamVjdC51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsNCgkgICAgCWlmKG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsNCgkgICAgCQlpZighY2FsbGJhY2spIHsNCgkgICAgCQkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5zcGxpY2UoMCxvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLmxlbmd0aCk7DQoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZSgwLG9iamVjdC5fX29ic2VydmVyc19fLmxlbmd0aCk7DQoJICAgIAkJCXJldHVybjsNCgkgICAgCQl9DQoJICAgIAkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5mb3JFYWNoKGZ1bmN0aW9uKG9ic2VydmVyY2FsbGJhY2ssaSkgew0KCSAgICAJCQlpZihjYWxsYmFjaz09PW9ic2VydmVyY2FsbGJhY2spIHsNCgkgICAgCQkJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uc3BsaWNlKGksMSk7DQoJICAgIAkJCQlkZWxldGUgb2JqZWN0Ll9fb2JzZXJ2ZXJzX19baV0uY2FsbGJhY2s7DQoJICAgIAkJCQlvYmplY3QuX19vYnNlcnZlcnNfXy5zcGxpY2UoaSwxKTsNCgkgICAgCQkJfQ0KCSAgICAJCX0pOw0KCSAgICAJfQ0KCSAgICB9Ow0KCSAgICBBcnJheS5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsNCgkgICAgCWlmKCEob2JqZWN0IGluc3RhbmNlb2YgQXJyYXkpICYmICFBcnJheS5pc0FycmF5KG9iamVjdCkpIHsNCgkgICAgCQl0aHJvdyBuZXcgVHlwZUVycm9yKCJGaXJzdCBhcmd1bWVudCB0byBBcnJheS5vYnNlcnZlciBpcyBub3QgYW4gQXJyYXkiKTsNCgkgICAgCX0NCiAgICAgICAgICAgIAlhY2NlcHRsaXN0ID0gYWNjZXB0bGlzdCB8fCBbImFkZCIsICJ1cGRhdGUiLCAiZGVsZXRlIiwgInNwbGljZSJdOw0KCSAgICAJdmFyIGFycmF5cHJveHkgPSBuZXcgUHJveHkob2JqZWN0LHtnZXQ6IGZ1bmN0aW9uKHRhcmdldCxwcm9wZXJ0eSkgew0KCSAgICAJCWlmKHByb3BlcnR5PT09InVub2JzZXJ2ZSIpIHsNCgkJICAgIAkJcmV0dXJuIGZ1bmN0aW9uKGNhbGxiYWNrKSB7DQoJCSAgICAJCQlpZihjYWxsYmFjaykgew0KCQkgICAgCQkJCXJldHVybiBPYmplY3QudW5vYnNlcnZlKHRhcmdldCxjYWxsYmFjayk7DQoJCSAgICAJCQl9DQoJCSAgICAJCQlyZXR1cm4gdGFyZ2V0LnVub2JzZXJ2ZSgpOw0KCQkgICAgCQl9Ow0KCQkgICAgCX0NCgkgICAgCQlpZihwcm9wZXJ0eT09PSJzcGxpY2UiKSB7DQoJICAgIAkJCXJldHVybiBmdW5jdGlvbihzdGFydCxlbmQpIHsNCgkgICAgCQkJCWlmKHR5cGVvZihzdGFydCkhPT0ibnVtYmVyIiB8fCB0eXBlb2YoZW5kKSE9PSJudW1iZXIiKSB7DQoJICAgIAkJCQkJdGhyb3cgbmV3IFR5cGVFcnJvcigiRmlyc3QgdHdvIGFyZ3VtZW50cyB0byBBcnJheSBzcGxpY2UgYXJlIG5vdCBudW1iZXIsIG51bWJlciIpOw0KCSAgICAJCQkJfQ0KCSAgICAJICAgIAkJdmFyIHJlbW92ZWQgPSB0aGlzLnNsaWNlKHN0YXJ0LHN0YXJ0K2VuZCksDQoJICAgIAkgICAgCQkJYWRkZWRDb3VudCA9IChhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50cy5sZW5ndGgtMiA6IDApLA0KCSAgICAJICAgIAkJCWNoYW5nZSA9ICB7b2JqZWN0Om9iamVjdCx0eXBlOiJzcGxpY2UiLGluZGV4OnN0YXJ0LHJlbW92ZWQ6cmVtb3ZlZCxhZGRlZENvdW50OmFkZGVkQ291bnR9Ow0KCSAgICAJICAgIAkJdGFyZ2V0LnNwbGljZS5hcHBseSh0YXJnZXQsYXJndW1lbnRzKTsNCgkgICAgCSAgICAJCWlmKGFjY2VwdGxpc3QuaW5kZXhPZigic3BsaWNlIik+PTApIHsNCgkgICAgCSAgICAJCQl2YXIgc3RhcnQgPSBwcm94eS5fX29ic2VydmVyX18uY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkgICAgCSAgICAgICAgCQkJZGVsaXZlciA9IHByb3h5Ll9fb2JzZXJ2ZXJfXy5kZWxpdmVyKCk7DQoJICAgIAkgICAgCQkJcHJveHkuX19vYnNlcnZlcl9fLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7DQoJICAgIAkgICAgCQkJaWYoc3RhcnQpIHsNCgkgICAgCQkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkgICAgCQkgICAgICAgIAl9DQoJICAgIAkgICAgCQl9DQoJICAgIAkgICAgCX0NCgkgICAgCQl9DQoJICAgIAkJaWYocHJvcGVydHk9PT0icHVzaCIpIHsNCgkgICAgCQkJIHJldHVybiBmdW5jdGlvbihpdGVtKSB7DQoJICAgIAkJICAgIAlyZXR1cm4gdGhpcy5zcGxpY2UodGhpcy5sZW5ndGgsMCxpdGVtKTsNCgkgICAgCQkgICAgfQ0KCSAgICAJCX0NCgkgICAgCQlpZihwcm9wZXJ0eT09PSJwb3AiKSB7DQoJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oKSB7DQoJICAgIAkJICAgIAlyZXR1cm4gdGhpcy5zcGxpY2UodGhpcy5sZW5ndGgtMSwxKTsNCgkgICAgCQkgICAgfQ0KCSAgICAJCX0NCgkgICAgCQlpZihwcm9wZXJ0eT09PSJ1bnNoaWZ0Iikgew0KCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHsNCiAgICAJCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDAsaXRlbSk7DQogICAgCQkgICAgCX0NCgkgICAgCQl9DQoJICAgIAkJaWYocHJvcGVydHk9PT0ic2hpZnQiKSB7DQoJICAgIAkJCXJldHVybiBmdW5jdGlvbigpIHsNCgkgICAgCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDEpOw0KCSAgICAJICAgIAl9DQoJICAgIAkJfQ0KCSAgICAJCXJldHVybiB0YXJnZXRbcHJvcGVydHldOw0KCSAgICAJfX0pOw0KCSAgICAJdmFyIHByb3h5ID0gT2JqZWN0Lm9ic2VydmUoYXJyYXlwcm94eSxmdW5jdGlvbihjaGFuZ2VzZXQpIHsgDQoJICAgIAkJdmFyIGNoYW5nZXMgPSBjaGFuZ2VzZXQuZmlsdGVyKGZ1bmN0aW9uKGNoYW5nZSkgeyByZXR1cm4gY2hhbmdlLm5hbWUhPT0ibGVuZ3RoIiAmJiBjaGFuZ2UubmFtZSE9PSJhZGQiICYmICghYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wKTsgfSk7DQoJICAgIAkJaWYoY2hhbmdlcy5sZW5ndGg+MCkgew0KCSAgICAJCQljYWxsYmFjayhjaGFuZ2VzKTsNCgkgICAgCQl9DQoJICAgIAl9LGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpOw0KCSAgICAJcmV0dXJuIHByb3h5Ow0KCSAgICB9Ow0KCSAgICBBcnJheS51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsNCgkJICByZXR1cm4gb2JqZWN0LnVub2JzZXJ2ZShjYWxsYmFjayk7DQoJICAgIH0NCgl9DQoJT2JqZWN0LmRlZXBPYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLHBhcnRzKSB7DQoNCgkJcGFydHMgPSAocGFydHMgPyBwYXJ0cyA6IFtdKTsNCg0KCQl2YXIgdG9UeXBlTmFtZSA9IGZ1bmN0aW9uKG9iaikgew0KCQkJcmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvYmopLm1hdGNoKC9ccyhbYS16QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKQ0KCQl9DQoNCgkJZnVuY3Rpb24gcmVvYnNlcnZlKHZhbHVlLCBwYXJ0cykgew0KCQkJdmFyIGtleXMgPSBPYmplY3Qua2V5cyh2YWx1ZSk7DQoJCQlrZXlzLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7DQoJCQkJaWYoKHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdvYmplY3QnIHx8IHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdhcnJheScpICYmICF2YWx1ZVtrZXldLmhhc093blByb3BlcnR5KCdfX29ic2VydmVyc19fJykpIHsNCgkJCQkJdmFyIG5ld3BhcnRzID0gcGFydHMuc2xpY2UoMCk7DQoJCQkJCW5ld3BhcnRzLnB1c2goa2V5KTsNCgkJCQkJdmFsdWVba2V5XSA9IE9iamVjdC5kZWVwT2JzZXJ2ZSh2YWx1ZVtrZXldLGNhbGxiYWNrLG5ld3BhcnRzKTsNCgkJCQl9DQoJCQl9KTsNCgkJfQ0KDQoJCXJlb2JzZXJ2ZShvYmplY3QsIHBhcnRzKTsNCg0KCQl2YXIgb2JzZXJ2ZWQgPSBPYmplY3Qub2JzZXJ2ZShvYmplY3QsZnVuY3Rpb24oY2hhbmdlc2V0KSB7DQoJCQl2YXIgY2hhbmdlcyA9IFtdOw0KCQkJZnVuY3Rpb24gcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0LG5ld09iamVjdCxwYXRoKSB7DQoJCQkJaWYobmV3T2JqZWN0IGluc3RhbmNlb2YgT2JqZWN0KSB7DQoJCQkJCXZhciBuZXdrZXlzID0gT2JqZWN0LmtleXMobmV3T2JqZWN0KTsNCgkJCQkJbmV3a2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgew0KCQkJCQkJaWYoIW9sZE9iamVjdCB8fCAob2xkT2JqZWN0W2tleV0hPT1uZXdPYmplY3Rba2V5XSkpIHsNCgkJCQkJCQl2YXIgb2xkdmFsdWUgPSAob2xkT2JqZWN0ICYmIG9sZE9iamVjdFtrZXldIT09dW5kZWZpbmVkID8gb2xkT2JqZWN0W2tleV0gOiB1bmRlZmluZWQpLA0KCQkJCQkJCQljaGFuZ2UgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKSwNCgkJCQkJCQkJa2V5cGF0aCA9IHBhdGggKyAiLiIgKyBrZXk7DQoNCgkJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGR2YWx1ZSxuZXdWYWx1ZTpuZXdPYmplY3Rba2V5XSxrZXlwYXRoOmtleXBhdGh9KTsNCgkJCQkJCQlyZWN1cnNlKG5hbWUscm9vdE9iamVjdCxvbGR2YWx1ZSxuZXdPYmplY3Rba2V5XSxrZXlwYXRoKTsNCgkJCQkJCX0NCgkJCQkJfSk7DQoJCQkJfSBlbHNlIGlmKG9sZE9iamVjdCBpbnN0YW5jZW9mIE9iamVjdCkgew0KCQkJCQl2YXIgb2xka2V5cyA9IE9iamVjdC5rZXlzKG9sZE9iamVjdCk7DQoJCQkJCW9sZGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsNCgkJCQkJCXZhciBjaGFuZ2UgPSAobmV3T2JqZWN0PT09bnVsbCA/ICJ1cGRhdGUiIDogImRlbGV0ZSIpLA0KCQkJCQkJCWtleXBhdGggPSBwYXRoICsgIi4iICsga2V5Ow0KCQkJCQkJCQ0KCQkJCQkJY2hhbmdlcy5wdXNoKHtuYW1lOm5hbWUsb2JqZWN0OnJvb3RPYmplY3QsdHlwZTpjaGFuZ2Usb2xkVmFsdWU6b2xkT2JqZWN0W2tleV0sbmV3VmFsdWU6bmV3T2JqZWN0LGtleXBhdGg6a2V5cGF0aH0pOw0KCQkJCQkJcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0W2tleV0sdW5kZWZpbmVkLGtleXBhdGgpOw0KCQkJCQl9KTsNCgkJCQl9DQoJCQl9DQoJCQljaGFuZ2VzZXQuZm9yRWFjaChmdW5jdGlvbihjaGFuZ2UpIHsNCgkJCQl2YXIga2V5cGF0aCA9IChwYXJ0cy5sZW5ndGg+MCA/IHBhcnRzLmpvaW4oIi4iKSArICIuIiA6ICIiKSArIGNoYW5nZS5uYW1lOw0KDQoJCQkJaWYgKGNoYW5nZS50eXBlID09PSAidXBkYXRlIiB8fCBjaGFuZ2UudHlwZSA9PT0gImFkZCIpIHsgDQoJCQkJCXJlb2JzZXJ2ZShjaGFuZ2Uub2JqZWN0LCBwYXJ0cyk7DQoJCQkJfQ0KDQoJCQkJY2hhbmdlcy5wdXNoKHtuYW1lOmNoYW5nZS5uYW1lLG9iamVjdDpjaGFuZ2Uub2JqZWN0LHR5cGU6Y2hhbmdlLnR5cGUsb2xkVmFsdWU6Y2hhbmdlLm9sZFZhbHVlLG5ld1ZhbHVlOmNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGg6a2V5cGF0aH0pOw0KCQkJCXJlY3Vyc2UoY2hhbmdlLm5hbWUsY2hhbmdlLm9iamVjdCxjaGFuZ2Uub2xkVmFsdWUsY2hhbmdlLm9iamVjdFtjaGFuZ2UubmFtZV0sa2V5cGF0aCk7DQoJCQl9KTsNCgkJCWNhbGxiYWNrKGNoYW5nZXMpOw0KCQl9KTsNCgkJcmV0dXJuIG9ic2VydmVkOw0KCX07DQp9KSgpOw0KCgovKioqLyB9KSwKLyogMTU0ICovLAovKiAxNTUgKi8sCi8qIDE1NiAqLywKLyogMTU3ICovLAovKiAxNTggKi8sCi8qIDE1OSAqLywKLyogMTYwICovLAovKiAxNjEgKi8sCi8qIDE2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkRhdGFPYmplY3RPYnNlcnZlciA9IGV4cG9ydHMuRGF0YU9iamVjdFJlcG9ydGVyID0gZXhwb3J0cy5TeW5jaGVyID0gdW5kZWZpbmVkOwoKdmFyIF9TeW5jaGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzApOwoKdmFyIF9TeW5jaGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1N5bmNoZXIpOwoKdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOSk7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuU3luY2hlciA9IF9TeW5jaGVyMi5kZWZhdWx0OwpleHBvcnRzLkRhdGFPYmplY3RSZXBvcnRlciA9IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQ7CmV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdDsKCi8qKiovIH0pCi8qKioqKiovIF0pOwp9KTsKCn0se31dLDg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewptb2R1bGUuZXhwb3J0cz17CiAgIl9hcmdzIjogWwogICAgWwogICAgICB7CiAgICAgICAgInJhdyI6ICJzaXAuanMiLAogICAgICAgICJzY29wZSI6IG51bGwsCiAgICAgICAgImVzY2FwZWROYW1lIjogInNpcC5qcyIsCiAgICAgICAgIm5hbWUiOiAic2lwLmpzIiwKICAgICAgICAicmF3U3BlYyI6ICIiLAogICAgICAgICJzcGVjIjogImxhdGVzdCIsCiAgICAgICAgInR5cGUiOiAidGFnIgogICAgICB9LAogICAgICAiL1VzZXJzL2R2aWxjaGV6L3dvcmtzcGFjZS9yZXRoaW5rL2Rldi1wcm90b3N0dWJzL3NyYy9wcm90b3N0dWIvaW1zX2l3IgogICAgXQogIF0sCiAgIl9mcm9tIjogInNpcC5qc0BsYXRlc3QiLAogICJfaWQiOiAic2lwLmpzQDAuNy41IiwKICAiX2luQ2FjaGUiOiB0cnVlLAogICJfaW5zdGFsbGFibGUiOiB0cnVlLAogICJfbG9jYXRpb24iOiAiL3NpcC5qcyIsCiAgIl9ub2RlVmVyc2lvbiI6ICI0LjQuMyIsCiAgIl9ucG1PcGVyYXRpb25hbEludGVybmFsIjogewogICAgImhvc3QiOiAicGFja2FnZXMtMTItd2VzdC5pbnRlcm5hbC5ucG1qcy5jb20iLAogICAgInRtcCI6ICJ0bXAvc2lwLmpzLTAuNy41LnRnel8xNDYxNTk0NDE4NjkwXzAuNTgzOTkzMzEyNDM3MDg3MyIKICB9LAogICJfbnBtVXNlciI6IHsKICAgICJuYW1lIjogImpvc2VwaGZyYXppZXIiLAogICAgImVtYWlsIjogIjEyMTJqdHJhY2V1ckBnbWFpbC5jb20iCiAgfSwKICAiX25wbVZlcnNpb24iOiAiMi4xNS4xIiwKICAiX3BoYW50b21DaGlsZHJlbiI6IHsKICAgICJvcHRpb25zIjogIjAuMC42IiwKICAgICJ1bHRyb24iOiAiMS4wLjIiCiAgfSwKICAiX3JlcXVlc3RlZCI6IHsKICAgICJyYXciOiAic2lwLmpzIiwKICAgICJzY29wZSI6IG51bGwsCiAgICAiZXNjYXBlZE5hbWUiOiAic2lwLmpzIiwKICAgICJuYW1lIjogInNpcC5qcyIsCiAgICAicmF3U3BlYyI6ICIiLAogICAgInNwZWMiOiAibGF0ZXN0IiwKICAgICJ0eXBlIjogInRhZyIKICB9LAogICJfcmVxdWlyZWRCeSI6IFsKICAgICIjVVNFUiIsCiAgICAiLyIKICBdLAogICJfcmVzb2x2ZWQiOiAiaHR0cHM6Ly9yZWdpc3RyeS5ucG1qcy5vcmcvc2lwLmpzLy0vc2lwLmpzLTAuNy41LnRneiIsCiAgIl9zaGFzdW0iOiAiODZhY2U3MDUxNTk0ZjkxYjQ1NTFiZGI4MTIwYTE2YzQ0OTYyZDNhMiIsCiAgIl9zaHJpbmt3cmFwIjogbnVsbCwKICAiX3NwZWMiOiAic2lwLmpzIiwKICAiX3doZXJlIjogIi9Vc2Vycy9kdmlsY2hlei93b3Jrc3BhY2UvcmV0aGluay9kZXYtcHJvdG9zdHVicy9zcmMvcHJvdG9zdHViL2ltc19pdyIsCiAgImF1dGhvciI6IHsKICAgICJuYW1lIjogIk9uU0lQIiwKICAgICJlbWFpbCI6ICJkZXZlbG9wZXJAb25zaXAuY29tIiwKICAgICJ1cmwiOiAiaHR0cDovL3NpcGpzLmNvbS9hdXRob3JzLyIKICB9LAogICJicm93c2VyIjogewogICAgIi4vc3JjL2Vudmlyb25tZW50LmpzIjogIi4vc3JjL2Vudmlyb25tZW50X2Jyb3dzZXIuanMiCiAgfSwKICAiYnVncyI6IHsKICAgICJ1cmwiOiAiaHR0cHM6Ly9naXRodWIuY29tL29uc2lwL1NJUC5qcy9pc3N1ZXMiCiAgfSwKICAiY29udHJpYnV0b3JzIjogWwogICAgewogICAgICAidXJsIjogImh0dHBzOi8vZ2l0aHViLmNvbS9vbnNpcC9TSVAuanMvYmxvYi9tYXN0ZXIvVEhBTktTLm1kIgogICAgfQogIF0sCiAgImRlcGVuZGVuY2llcyI6IHsKICAgICJwcm9taXNjdW91cyI6ICJeMC42LjAiLAogICAgIndzIjogIl4wLjYuNCIKICB9LAogICJkZXNjcmlwdGlvbiI6ICJBIHNpbXBsZSwgaW50dWl0aXZlLCBhbmQgcG93ZXJmdWwgSmF2YVNjcmlwdCBzaWduYWxpbmcgbGlicmFyeSIsCiAgImRldkRlcGVuZGVuY2llcyI6IHsKICAgICJiZWVmeSI6ICJeMi4xLjUiLAogICAgImJyb3dzZXJpZnkiOiAiXjQuMS44IiwKICAgICJncnVudCI6ICJ+MC40LjAiLAogICAgImdydW50LWJyb3dzZXJpZnkiOiAiXjQuMC4xIiwKICAgICJncnVudC1jbGkiOiAifjAuMS42IiwKICAgICJncnVudC1jb250cmliLWNvcHkiOiAiXjAuNS4wIiwKICAgICJncnVudC1jb250cmliLWphc21pbmUiOiAiXjAuOS4yIiwKICAgICJncnVudC1jb250cmliLWpzaGludCI6ICI+MC41LjAiLAogICAgImdydW50LWNvbnRyaWItdWdsaWZ5IjogIn4wLjIuMCIsCiAgICAiZ3J1bnQtcGVnIjogIn4xLjMuMSIsCiAgICAiZ3J1bnQtdHJpbXRyYWlsaW5nc3BhY2VzIjogIl4wLjQuMCIsCiAgICAicGVnanMiOiAiXjAuOC4wIgogIH0sCiAgImRpcmVjdG9yaWVzIjoge30sCiAgImRpc3QiOiB7CiAgICAic2hhc3VtIjogIjg2YWNlNzA1MTU5NGY5MWI0NTUxYmRiODEyMGExNmM0NDk2MmQzYTIiLAogICAgInRhcmJhbGwiOiAiaHR0cHM6Ly9yZWdpc3RyeS5ucG1qcy5vcmcvc2lwLmpzLy0vc2lwLmpzLTAuNy41LnRneiIKICB9LAogICJlbmdpbmVzIjogewogICAgIm5vZGUiOiAiPj0wLjgiCiAgfSwKICAiZ2l0SGVhZCI6ICJiYWU0NGJkMDM1OWY0ZDcwZGVkMzA5YTMyMzYxZjA0YTA0ZTc4ZDZlIiwKICAiaG9tZXBhZ2UiOiAiaHR0cDovL3NpcGpzLmNvbSIsCiAgImtleXdvcmRzIjogWwogICAgInNpcCIsCiAgICAid2Vic29ja2V0IiwKICAgICJ3ZWJydGMiLAogICAgImxpYnJhcnkiLAogICAgImphdmFzY3JpcHQiCiAgXSwKICAibGljZW5zZSI6ICJNSVQiLAogICJtYWluIjogInNyYy9pbmRleC5qcyIsCiAgIm1haW50YWluZXJzIjogWwogICAgewogICAgICAibmFtZSI6ICJlZ3JlZW5fb25zaXAiLAogICAgICAiZW1haWwiOiAiZXJpYy5ncmVlbkBvbnNpcC5jb20iCiAgICB9LAogICAgewogICAgICAibmFtZSI6ICJqYW1lcy1jcmlzY3VvbG8iLAogICAgICAiZW1haWwiOiAiamFtZXNAb25zaXAuY29tIgogICAgfSwKICAgIHsKICAgICAgIm5hbWUiOiAiam9zZXBoZnJhemllciIsCiAgICAgICJlbWFpbCI6ICIxMjEyanRyYWNldXJAZ21haWwuY29tIgogICAgfQogIF0sCiAgIm5hbWUiOiAic2lwLmpzIiwKICAib3B0aW9uYWxEZXBlbmRlbmNpZXMiOiB7CiAgICAicHJvbWlzY3VvdXMiOiAiXjAuNi4wIgogIH0sCiAgInJlYWRtZSI6ICJFUlJPUjogTm8gUkVBRE1FIGRhdGEgZm91bmQhIiwKICAicmVwb3NpdG9yeSI6IHsKICAgICJ0eXBlIjogImdpdCIsCiAgICAidXJsIjogImdpdCtodHRwczovL2dpdGh1Yi5jb20vb25zaXAvU0lQLmpzLmdpdCIKICB9LAogICJzY3JpcHRzIjogewogICAgImJ1aWxkIjogImdydW50IGJ1aWxkIiwKICAgICJwcmVwdWJsaXNoIjogImNkIHNyYy9HcmFtbWFyICYmIG1rZGlyIC1wIGRpc3QgJiYgcGVnanMgLS1leHRyYS1vcHRpb25zLWZpbGUgcGVnLmpzb24gc3JjL0dyYW1tYXIucGVnanMgZGlzdC9HcmFtbWFyLmpzIiwKICAgICJyZXBsIjogImJlZWZ5IHRlc3QvcmVwbC5qcyAtLW9wZW4iLAogICAgInRlc3QiOiAiZ3J1bnQgdHJhdmlzIC0tdmVyYm9zZSIKICB9LAogICJ0aXRsZSI6ICJTSVAuanMiLAogICJ2ZXJzaW9uIjogIjAuNy41Igp9Cgp9LHt9XSw5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyIENsaWVudENvbnRleHQ7CgpDbGllbnRDb250ZXh0ID0gZnVuY3Rpb24gKHVhLCBtZXRob2QsIHRhcmdldCwgb3B0aW9ucykgewogIHZhciBvcmlnaW5hbFRhcmdldCA9IHRhcmdldDsKCiAgLy8gVmFsaWRhdGUgYXJndW1lbnRzCiAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdOb3QgZW5vdWdoIGFyZ3VtZW50cycpOwogIH0KCiAgdGhpcy51YSA9IHVhOwogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAuY2xpZW50Y29udGV4dCcpOwogIHRoaXMubWV0aG9kID0gbWV0aG9kOwogIHRhcmdldCA9IHVhLm5vcm1hbGl6ZVRhcmdldCh0YXJnZXQpOwogIGlmICghdGFyZ2V0KSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRhcmdldDogJyArIG9yaWdpbmFsVGFyZ2V0KTsKICB9CgogIC8qIE9wdGlvbnMKICAgKiAtIGV4dHJhSGVhZGVycwogICAqIC0gcGFyYW1zCiAgICogLSBjb250ZW50VHlwZQogICAqIC0gYm9keQogICAqLwogIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKG9wdGlvbnMgfHwgT2JqZWN0LnByb3RvdHlwZSk7CiAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCk7CgogIGlmIChvcHRpb25zLmNvbnRlbnRUeXBlKSB7CiAgICB0aGlzLmNvbnRlbnRUeXBlID0gb3B0aW9ucy5jb250ZW50VHlwZTsKICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRlbnQtVHlwZTogJyArIHRoaXMuY29udGVudFR5cGUpOwogIH0KCiAgLy8gQnVpbGQgdGhlIHJlcXVlc3QKICB0aGlzLnJlcXVlc3QgPSBuZXcgU0lQLk91dGdvaW5nUmVxdWVzdCh0aGlzLm1ldGhvZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51YSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnBhcmFtcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmV4dHJhSGVhZGVycyk7CiAgaWYgKG9wdGlvbnMuYm9keSkgewogICAgdGhpcy5ib2R5ID0gb3B0aW9ucy5ib2R5OwogICAgdGhpcy5yZXF1ZXN0LmJvZHkgPSB0aGlzLmJvZHk7CiAgfQoKICAvKiBTZXQgb3RoZXIgcHJvcGVydGllcyBmcm9tIHRoZSByZXF1ZXN0ICovCiAgdGhpcy5sb2NhbElkZW50aXR5ID0gdGhpcy5yZXF1ZXN0LmZyb207CiAgdGhpcy5yZW1vdGVJZGVudGl0eSA9IHRoaXMucmVxdWVzdC50bzsKCiAgdGhpcy5kYXRhID0ge307Cn07CkNsaWVudENvbnRleHQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdHlwZSk7CgpDbGllbnRDb250ZXh0LnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKCkgewogIChuZXcgU0lQLlJlcXVlc3RTZW5kZXIodGhpcywgdGhpcy51YSkpLnNlbmQoKTsKICByZXR1cm4gdGhpczsKfTsKCkNsaWVudENvbnRleHQucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgogIHZhciBjYW5jZWxfcmVhc29uID0gU0lQLlV0aWxzLmdldENhbmNlbFJlYXNvbihvcHRpb25zLnN0YXR1c19jb2RlLCBvcHRpb25zLnJlYXNvbl9waHJhc2UpOwogIHRoaXMucmVxdWVzdC5jYW5jZWwoY2FuY2VsX3JlYXNvbik7CgogIHRoaXMuZW1pdCgnY2FuY2VsJyk7Cn07CgpDbGllbnRDb250ZXh0LnByb3RvdHlwZS5yZWNlaXZlUmVzcG9uc2UgPSBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICB2YXIgY2F1c2UgPSBTSVAuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKHJlc3BvbnNlLnN0YXR1c19jb2RlKTsKCiAgc3dpdGNoKHRydWUpIHsKICAgIGNhc2UgL14xWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgdGhpcy5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgL14yWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgaWYodGhpcy51YS5hcHBsaWNhbnRzW3RoaXNdKSB7CiAgICAgICAgZGVsZXRlIHRoaXMudWEuYXBwbGljYW50c1t0aGlzXTsKICAgICAgfQogICAgICB0aGlzLmVtaXQoJ2FjY2VwdGVkJywgcmVzcG9uc2UsIGNhdXNlKTsKICAgICAgYnJlYWs7CgogICAgZGVmYXVsdDoKICAgICAgaWYodGhpcy51YS5hcHBsaWNhbnRzW3RoaXNdKSB7CiAgICAgICAgZGVsZXRlIHRoaXMudWEuYXBwbGljYW50c1t0aGlzXTsKICAgICAgfQogICAgICB0aGlzLmVtaXQoJ3JlamVjdGVkJywgcmVzcG9uc2UsIGNhdXNlKTsKICAgICAgdGhpcy5lbWl0KCdmYWlsZWQnLCByZXNwb25zZSwgY2F1c2UpOwogICAgICBicmVhazsKICB9Cgp9OwoKQ2xpZW50Q29udGV4dC5wcm90b3R5cGUub25SZXF1ZXN0VGltZW91dCA9IGZ1bmN0aW9uICgpIHsKICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwp9OwoKQ2xpZW50Q29udGV4dC5wcm90b3R5cGUub25UcmFuc3BvcnRFcnJvciA9IGZ1bmN0aW9uICgpIHsKICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKfTsKClNJUC5DbGllbnRDb250ZXh0ID0gQ2xpZW50Q29udGV4dDsKfTsKCn0se31dLDEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBTSVAgQ29uc3RhbnRzCiAqLwoKLyoqCiAqIFNJUCBDb25zdGFudHMuCiAqIEBhdWdtZW50cyBTSVAKICovCgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChuYW1lLCB2ZXJzaW9uKSB7CnJldHVybiB7CiAgVVNFUl9BR0VOVDogbmFtZSArJy8nKyB2ZXJzaW9uLAoKICAvLyBTSVAgc2NoZW1lCiAgU0lQOiAgJ3NpcCcsCiAgU0lQUzogJ3NpcHMnLAoKICAvLyBFbmQgYW5kIEZhaWx1cmUgY2F1c2VzCiAgY2F1c2VzOiB7CiAgICAvLyBHZW5lcmljIGVycm9yIGNhdXNlcwogICAgQ09OTkVDVElPTl9FUlJPUjogICAgICAgICAnQ29ubmVjdGlvbiBFcnJvcicsCiAgICBSRVFVRVNUX1RJTUVPVVQ6ICAgICAgICAgICdSZXF1ZXN0IFRpbWVvdXQnLAogICAgU0lQX0ZBSUxVUkVfQ09ERTogICAgICAgICAnU0lQIEZhaWx1cmUgQ29kZScsCiAgICBJTlRFUk5BTF9FUlJPUjogICAgICAgICAgICdJbnRlcm5hbCBFcnJvcicsCgogICAgLy8gU0lQIGVycm9yIGNhdXNlcwogICAgQlVTWTogICAgICAgICAgICAgICAgICAgICAnQnVzeScsCiAgICBSRUpFQ1RFRDogICAgICAgICAgICAgICAgICdSZWplY3RlZCcsCiAgICBSRURJUkVDVEVEOiAgICAgICAgICAgICAgICdSZWRpcmVjdGVkJywKICAgIFVOQVZBSUxBQkxFOiAgICAgICAgICAgICAgJ1VuYXZhaWxhYmxlJywKICAgIE5PVF9GT1VORDogICAgICAgICAgICAgICAgJ05vdCBGb3VuZCcsCiAgICBBRERSRVNTX0lOQ09NUExFVEU6ICAgICAgICdBZGRyZXNzIEluY29tcGxldGUnLAogICAgSU5DT01QQVRJQkxFX1NEUDogICAgICAgICAnSW5jb21wYXRpYmxlIFNEUCcsCiAgICBBVVRIRU5USUNBVElPTl9FUlJPUjogICAgICdBdXRoZW50aWNhdGlvbiBFcnJvcicsCiAgICBESUFMT0dfRVJST1I6ICAgICAgICAgICAgICdEaWFsb2cgRXJyb3InLAoKICAgIC8vIFNlc3Npb24gZXJyb3IgY2F1c2VzCiAgICBXRUJSVENfTk9UX1NVUFBPUlRFRDogICAgICdXZWJSVEMgTm90IFN1cHBvcnRlZCcsCiAgICBXRUJSVENfRVJST1I6ICAgICAgICAgICAgICdXZWJSVEMgRXJyb3InLAogICAgQ0FOQ0VMRUQ6ICAgICAgICAgICAgICAgICAnQ2FuY2VsZWQnLAogICAgTk9fQU5TV0VSOiAgICAgICAgICAgICAgICAnTm8gQW5zd2VyJywKICAgIEVYUElSRVM6ICAgICAgICAgICAgICAgICAgJ0V4cGlyZXMnLAogICAgTk9fQUNLOiAgICAgICAgICAgICAgICAgICAnTm8gQUNLJywKICAgIE5PX1BSQUNLOiAgICAgICAgICAgICAgICAgJ05vIFBSQUNLJywKICAgIFVTRVJfREVOSUVEX01FRElBX0FDQ0VTUzogJ1VzZXIgRGVuaWVkIE1lZGlhIEFjY2VzcycsCiAgICBCQURfTUVESUFfREVTQ1JJUFRJT046ICAgICdCYWQgTWVkaWEgRGVzY3JpcHRpb24nLAogICAgUlRQX1RJTUVPVVQ6ICAgICAgICAgICAgICAnUlRQIFRpbWVvdXQnCiAgfSwKCiAgc3VwcG9ydGVkOiB7CiAgICBVTlNVUFBPUlRFRDogICAgICAgICdub25lJywKICAgIFNVUFBPUlRFRDogICAgICAgICAgJ3N1cHBvcnRlZCcsCiAgICBSRVFVSVJFRDogICAgICAgICAgICdyZXF1aXJlZCcKICB9LAoKICBTSVBfRVJST1JfQ0FVU0VTOiB7CiAgICBSRURJUkVDVEVEOiBbMzAwLDMwMSwzMDIsMzA1LDM4MF0sCiAgICBCVVNZOiBbNDg2LDYwMF0sCiAgICBSRUpFQ1RFRDogWzQwMyw2MDNdLAogICAgTk9UX0ZPVU5EOiBbNDA0LDYwNF0sCiAgICBVTkFWQUlMQUJMRTogWzQ4MCw0MTAsNDA4LDQzMF0sCiAgICBBRERSRVNTX0lOQ09NUExFVEU6IFs0ODRdLAogICAgSU5DT01QQVRJQkxFX1NEUDogWzQ4OCw2MDZdLAogICAgQVVUSEVOVElDQVRJT05fRVJST1I6WzQwMSw0MDddCiAgfSwKCiAgLy8gU0lQIE1ldGhvZHMKICBBQ0s6ICAgICAgICAnQUNLJywKICBCWUU6ICAgICAgICAnQllFJywKICBDQU5DRUw6ICAgICAnQ0FOQ0VMJywKICBJTkZPOiAgICAgICAnSU5GTycsCiAgSU5WSVRFOiAgICAgJ0lOVklURScsCiAgTUVTU0FHRTogICAgJ01FU1NBR0UnLAogIE5PVElGWTogICAgICdOT1RJRlknLAogIE9QVElPTlM6ICAgICdPUFRJT05TJywKICBSRUdJU1RFUjogICAnUkVHSVNURVInLAogIFVQREFURTogICAgICdVUERBVEUnLAogIFNVQlNDUklCRTogICdTVUJTQ1JJQkUnLAogIFJFRkVSOiAgICAgICdSRUZFUicsCiAgUFJBQ0s6ICAgICAgJ1BSQUNLJywKCiAgLyogU0lQIFJlc3BvbnNlIFJlYXNvbnMKICAgKiBET0M6IGh0dHA6Ly93d3cuaWFuYS5vcmcvYXNzaWdubWVudHMvc2lwLXBhcmFtZXRlcnMKICAgKiBDb3BpZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vdmVyc2F0aWNhL092ZXJTSVAvYmxvYi9tYXN0ZXIvbGliL292ZXJzaXAvc2lwL2NvbnN0YW50cy5yYiNMNwogICAqLwogIFJFQVNPTl9QSFJBU0U6IHsKICAgIDEwMDogJ1RyeWluZycsCiAgICAxODA6ICdSaW5naW5nJywKICAgIDE4MTogJ0NhbGwgSXMgQmVpbmcgRm9yd2FyZGVkJywKICAgIDE4MjogJ1F1ZXVlZCcsCiAgICAxODM6ICdTZXNzaW9uIFByb2dyZXNzJywKICAgIDE5OTogJ0Vhcmx5IERpYWxvZyBUZXJtaW5hdGVkJywgIC8vIGRyYWZ0LWlldGYtc2lwY29yZS0xOTkKICAgIDIwMDogJ09LJywKICAgIDIwMjogJ0FjY2VwdGVkJywgIC8vIFJGQyAzMjY1CiAgICAyMDQ6ICdObyBOb3RpZmljYXRpb24nLCAgLy9SRkMgNTgzOQogICAgMzAwOiAnTXVsdGlwbGUgQ2hvaWNlcycsCiAgICAzMDE6ICdNb3ZlZCBQZXJtYW5lbnRseScsCiAgICAzMDI6ICdNb3ZlZCBUZW1wb3JhcmlseScsCiAgICAzMDU6ICdVc2UgUHJveHknLAogICAgMzgwOiAnQWx0ZXJuYXRpdmUgU2VydmljZScsCiAgICA0MDA6ICdCYWQgUmVxdWVzdCcsCiAgICA0MDE6ICdVbmF1dGhvcml6ZWQnLAogICAgNDAyOiAnUGF5bWVudCBSZXF1aXJlZCcsCiAgICA0MDM6ICdGb3JiaWRkZW4nLAogICAgNDA0OiAnTm90IEZvdW5kJywKICAgIDQwNTogJ01ldGhvZCBOb3QgQWxsb3dlZCcsCiAgICA0MDY6ICdOb3QgQWNjZXB0YWJsZScsCiAgICA0MDc6ICdQcm94eSBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCcsCiAgICA0MDg6ICdSZXF1ZXN0IFRpbWVvdXQnLAogICAgNDEwOiAnR29uZScsCiAgICA0MTI6ICdDb25kaXRpb25hbCBSZXF1ZXN0IEZhaWxlZCcsICAvLyBSRkMgMzkwMwogICAgNDEzOiAnUmVxdWVzdCBFbnRpdHkgVG9vIExhcmdlJywKICAgIDQxNDogJ1JlcXVlc3QtVVJJIFRvbyBMb25nJywKICAgIDQxNTogJ1Vuc3VwcG9ydGVkIE1lZGlhIFR5cGUnLAogICAgNDE2OiAnVW5zdXBwb3J0ZWQgVVJJIFNjaGVtZScsCiAgICA0MTc6ICdVbmtub3duIFJlc291cmNlLVByaW9yaXR5JywgIC8vIFJGQyA0NDEyCiAgICA0MjA6ICdCYWQgRXh0ZW5zaW9uJywKICAgIDQyMTogJ0V4dGVuc2lvbiBSZXF1aXJlZCcsCiAgICA0MjI6ICdTZXNzaW9uIEludGVydmFsIFRvbyBTbWFsbCcsICAvLyBSRkMgNDAyOAogICAgNDIzOiAnSW50ZXJ2YWwgVG9vIEJyaWVmJywKICAgIDQyODogJ1VzZSBJZGVudGl0eSBIZWFkZXInLCAgLy8gUkZDIDQ0NzQKICAgIDQyOTogJ1Byb3ZpZGUgUmVmZXJyZXIgSWRlbnRpdHknLCAgLy8gUkZDIDM4OTIKICAgIDQzMDogJ0Zsb3cgRmFpbGVkJywgIC8vIFJGQyA1NjI2CiAgICA0MzM6ICdBbm9ueW1pdHkgRGlzYWxsb3dlZCcsICAvLyBSRkMgNTA3OQogICAgNDM2OiAnQmFkIElkZW50aXR5LUluZm8nLCAgLy8gUkZDIDQ0NzQKICAgIDQzNzogJ1Vuc3VwcG9ydGVkIENlcnRpZmljYXRlJywgIC8vIFJGQyA0NzQ0CiAgICA0Mzg6ICdJbnZhbGlkIElkZW50aXR5IEhlYWRlcicsICAvLyBSRkMgNDc0NAogICAgNDM5OiAnRmlyc3QgSG9wIExhY2tzIE91dGJvdW5kIFN1cHBvcnQnLCAgLy8gUkZDIDU2MjYKICAgIDQ0MDogJ01heC1CcmVhZHRoIEV4Y2VlZGVkJywgIC8vIFJGQyA1MzkzCiAgICA0Njk6ICdCYWQgSW5mbyBQYWNrYWdlJywgIC8vIGRyYWZ0LWlldGYtc2lwY29yZS1pbmZvLWV2ZW50cwogICAgNDcwOiAnQ29uc2VudCBOZWVkZWQnLCAgLy8gUkZDIDUzNjAKICAgIDQ3ODogJ1VucmVzb2x2YWJsZSBEZXN0aW5hdGlvbicsICAvLyBDdXN0b20gY29kZSBjb3BpZWQgZnJvbSBLYW1haWxpby4KICAgIDQ4MDogJ1RlbXBvcmFyaWx5IFVuYXZhaWxhYmxlJywKICAgIDQ4MTogJ0NhbGwvVHJhbnNhY3Rpb24gRG9lcyBOb3QgRXhpc3QnLAogICAgNDgyOiAnTG9vcCBEZXRlY3RlZCcsCiAgICA0ODM6ICdUb28gTWFueSBIb3BzJywKICAgIDQ4NDogJ0FkZHJlc3MgSW5jb21wbGV0ZScsCiAgICA0ODU6ICdBbWJpZ3VvdXMnLAogICAgNDg2OiAnQnVzeSBIZXJlJywKICAgIDQ4NzogJ1JlcXVlc3QgVGVybWluYXRlZCcsCiAgICA0ODg6ICdOb3QgQWNjZXB0YWJsZSBIZXJlJywKICAgIDQ4OTogJ0JhZCBFdmVudCcsICAvLyBSRkMgMzI2NQogICAgNDkxOiAnUmVxdWVzdCBQZW5kaW5nJywKICAgIDQ5MzogJ1VuZGVjaXBoZXJhYmxlJywKICAgIDQ5NDogJ1NlY3VyaXR5IEFncmVlbWVudCBSZXF1aXJlZCcsICAvLyBSRkMgMzMyOQogICAgNTAwOiAnSW50ZXJuYWwgU2VydmVyIEVycm9yJywKICAgIDUwMTogJ05vdCBJbXBsZW1lbnRlZCcsCiAgICA1MDI6ICdCYWQgR2F0ZXdheScsCiAgICA1MDM6ICdTZXJ2aWNlIFVuYXZhaWxhYmxlJywKICAgIDUwNDogJ1NlcnZlciBUaW1lLW91dCcsCiAgICA1MDU6ICdWZXJzaW9uIE5vdCBTdXBwb3J0ZWQnLAogICAgNTEzOiAnTWVzc2FnZSBUb28gTGFyZ2UnLAogICAgNTgwOiAnUHJlY29uZGl0aW9uIEZhaWx1cmUnLCAgLy8gUkZDIDMzMTIKICAgIDYwMDogJ0J1c3kgRXZlcnl3aGVyZScsCiAgICA2MDM6ICdEZWNsaW5lJywKICAgIDYwNDogJ0RvZXMgTm90IEV4aXN0IEFueXdoZXJlJywKICAgIDYwNjogJ05vdCBBY2NlcHRhYmxlJwogIH0sCgogIC8qIFNJUCBPcHRpb24gVGFncwogICAqIERPQzogaHR0cDovL3d3dy5pYW5hLm9yZy9hc3NpZ25tZW50cy9zaXAtcGFyYW1ldGVycy9zaXAtcGFyYW1ldGVycy54aHRtbCNzaXAtcGFyYW1ldGVycy00CiAgICovCiAgT1BUSU9OX1RBR1M6IHsKICAgICcxMDByZWwnOiAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDMyNjIKICAgIDE5OTogICAgICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDYyMjgKICAgIGFuc3dlcm1vZGU6ICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDUzNzMKICAgICdlYXJseS1zZXNzaW9uJzogICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDM5NTkKICAgIGV2ZW50bGlzdDogICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDQ2NjIKICAgIGV4cGxpY2l0c3ViOiAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDLWlldGYtc2lwY29yZS1yZWZlci1leHBsaWNpdC1zdWJzY3JpcHRpb24tMDMKICAgICdmcm9tLWNoYW5nZSc6ICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDQ5MTYKICAgICdnZW9sb2NhdGlvbi1odHRwJzogICAgICAgICB0cnVlLCAgLy8gUkZDIDY0NDIKICAgICdnZW9sb2NhdGlvbi1zaXAnOiAgICAgICAgICB0cnVlLCAgLy8gUkZDIDY0NDIKICAgIGdpbjogICAgICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDYxNDAKICAgIGdydXU6ICAgICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDU2MjcKICAgIGhpc3RpbmZvOiAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDcwNDQKICAgIGljZTogICAgICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDU3NjgKICAgIGpvaW46ICAgICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDM5MTEKICAgICdtdWx0aXBsZS1yZWZlcic6ICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDUzNjgKICAgIG5vcmVmZXJzdWI6ICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDQ0ODgKICAgIG5vc3ViOiAgICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDLWlldGYtc2lwY29yZS1yZWZlci1leHBsaWNpdC1zdWJzY3JpcHRpb24tMDMKICAgIG91dGJvdW5kOiAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDU2MjYKICAgIHBhdGg6ICAgICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDMzMjcKICAgIHBvbGljeTogICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDY3OTQKICAgIHByZWNvbmRpdGlvbjogICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDMzMTIKICAgIHByZWY6ICAgICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDM4NDAKICAgIHByaXZhY3k6ICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDMzMjMKICAgICdyZWNpcGllbnQtbGlzdC1pbnZpdGUnOiAgICB0cnVlLCAgLy8gUkZDIDUzNjYKICAgICdyZWNpcGllbnQtbGlzdC1tZXNzYWdlJzogICB0cnVlLCAgLy8gUkZDIDUzNjUKICAgICdyZWNpcGllbnQtbGlzdC1zdWJzY3JpYmUnOiB0cnVlLCAgLy8gUkZDIDUzNjcKICAgIHJlcGxhY2VzOiAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDM4OTEKICAgICdyZXNvdXJjZS1wcmlvcml0eSc6ICAgICAgICB0cnVlLCAgLy8gUkZDIDQ0MTIKICAgICdzZHAtYW5hdCc6ICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDQwOTIKICAgICdzZWMtYWdyZWUnOiAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDMzMjkKICAgIHRkaWFsb2c6ICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDQ1MzgKICAgIHRpbWVyOiAgICAgICAgICAgICAgICAgICAgICB0cnVlLCAgLy8gUkZDIDQwMjgKICAgIHV1aTogICAgICAgICAgICAgICAgICAgICAgICB0cnVlICAgLy8gUkZDIDc0MzMKICB9Cn07Cn07Cgp9LHt9XSwxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCi8qKgogKiBAZmlsZW92ZXJ2aWV3IEluLURpYWxvZyBSZXF1ZXN0IFNlbmRlcgogKi8KCi8qKgogKiBAYXVnbWVudHMgU0lQLkRpYWxvZwogKiBAY2xhc3MgQ2xhc3MgY3JlYXRpbmcgYW4gSW4tZGlhbG9nIHJlcXVlc3Qgc2VuZGVyLgogKiBAcGFyYW0ge1NJUC5EaWFsb2d9IGRpYWxvZwogKiBAcGFyYW0ge09iamVjdH0gYXBwbGljYW50CiAqIEBwYXJhbSB7U0lQLk91dGdvaW5nUmVxdWVzdH0gcmVxdWVzdAogKi8KLyoqCiAqIEBmaWxlb3ZlcnZpZXcgaW4tRGlhbG9nIFJlcXVlc3QgU2VuZGVyCiAqLwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CnZhciBSZXF1ZXN0U2VuZGVyOwoKUmVxdWVzdFNlbmRlciA9IGZ1bmN0aW9uKGRpYWxvZywgYXBwbGljYW50LCByZXF1ZXN0KSB7CgogIHRoaXMuZGlhbG9nID0gZGlhbG9nOwogIHRoaXMuYXBwbGljYW50ID0gYXBwbGljYW50OwogIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7CgogIC8vIFJGQzMyNjEgMTQuMSBNb2RpZnlpbmcgYW4gRXhpc3RpbmcgU2Vzc2lvbi4gVUFDIEJlaGF2aW9yLgogIHRoaXMucmVhdHRlbXB0ID0gZmFsc2U7CiAgdGhpcy5yZWF0dGVtcHRUaW1lciA9IG51bGw7Cn07CgpSZXF1ZXN0U2VuZGVyLnByb3RvdHlwZSA9IHsKICBzZW5kOiBmdW5jdGlvbigpIHsKICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgcmVxdWVzdF9zZW5kZXIgPSBuZXcgU0lQLlJlcXVlc3RTZW5kZXIodGhpcywgdGhpcy5kaWFsb2cub3duZXIudWEpOwoKICAgICAgcmVxdWVzdF9zZW5kZXIuc2VuZCgpOwoKICAgIC8vIFJGQzMyNjEgMTQuMiBNb2RpZnlpbmcgYW4gRXhpc3RpbmcgU2Vzc2lvbiAtVUFDIEJFSEFWSU9SLQogICAgaWYgKHRoaXMucmVxdWVzdC5tZXRob2QgPT09IFNJUC5DLklOVklURSAmJiByZXF1ZXN0X3NlbmRlci5jbGllbnRUcmFuc2FjdGlvbi5zdGF0ZSAhPT0gU0lQLlRyYW5zYWN0aW9ucy5DLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZGlhbG9nLnVhY19wZW5kaW5nX3JlcGx5ID0gdHJ1ZTsKICAgICAgcmVxdWVzdF9zZW5kZXIuY2xpZW50VHJhbnNhY3Rpb24ub24oJ3N0YXRlQ2hhbmdlZCcsIGZ1bmN0aW9uIHN0YXRlQ2hhbmdlZCgpewogICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX0FDQ0VQVEVEIHx8CiAgICAgICAgICAgIHRoaXMuc3RhdGUgPT09IFNJUC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfQ09NUExFVEVEIHx8CiAgICAgICAgICAgIHRoaXMuc3RhdGUgPT09IFNJUC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfVEVSTUlOQVRFRCkgewoKICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIoJ3N0YXRlQ2hhbmdlZCcsIHN0YXRlQ2hhbmdlZCk7CiAgICAgICAgICBzZWxmLmRpYWxvZy51YWNfcGVuZGluZ19yZXBseSA9IGZhbHNlOwoKICAgICAgICAgIGlmIChzZWxmLmRpYWxvZy51YXNfcGVuZGluZ19yZXBseSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgc2VsZi5kaWFsb2cub3duZXIub25SZWFkeVRvUmVpbnZpdGUoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sCgogIG9uUmVxdWVzdFRpbWVvdXQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5hcHBsaWNhbnQub25SZXF1ZXN0VGltZW91dCgpOwogIH0sCgogIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5hcHBsaWNhbnQub25UcmFuc3BvcnRFcnJvcigpOwogIH0sCgogIHJlY2VpdmVSZXNwb25zZTogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAvLyBSRkMzMjYxIDEyLjIuMS4yIDQwOCBvciA0ODEgaXMgcmVjZWl2ZWQgZm9yIGEgcmVxdWVzdCB3aXRoaW4gYSBkaWFsb2cuCiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT09IDQwOCB8fCByZXNwb25zZS5zdGF0dXNfY29kZSA9PT0gNDgxKSB7CiAgICAgIHRoaXMuYXBwbGljYW50Lm9uRGlhbG9nRXJyb3IocmVzcG9uc2UpOwogICAgfSBlbHNlIGlmIChyZXNwb25zZS5tZXRob2QgPT09IFNJUC5DLklOVklURSAmJiByZXNwb25zZS5zdGF0dXNfY29kZSA9PT0gNDkxKSB7CiAgICAgIGlmICh0aGlzLnJlYXR0ZW1wdCkgewogICAgICAgIHRoaXMuYXBwbGljYW50LnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5yZXF1ZXN0LmNzZXEudmFsdWUgPSB0aGlzLmRpYWxvZy5sb2NhbF9zZXFudW0gKz0gMTsKICAgICAgICB0aGlzLnJlYXR0ZW1wdFRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGlmIChzZWxmLmFwcGxpY2FudC5vd25lci5zdGF0dXMgIT09IFNJUC5TZXNzaW9uLkMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgICAgICBzZWxmLnJlYXR0ZW1wdCA9IHRydWU7CiAgICAgICAgICAgICAgc2VsZi5yZXF1ZXN0X3NlbmRlci5zZW5kKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB0aGlzLmdldFJlYXR0ZW1wdFRpbWVvdXQoKQogICAgICAgICk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuYXBwbGljYW50LnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICB9CiAgfQp9OwoKcmV0dXJuIFJlcXVlc3RTZW5kZXI7Cn07Cgp9LHt9XSwxMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgU0lQIERpYWxvZwogKi8KCi8qKgogKiBAYXVnbWVudHMgU0lQCiAqIEBjbGFzcyBDbGFzcyBjcmVhdGluZyBhIFNJUCBkaWFsb2cuCiAqIEBwYXJhbSB7U0lQLlJUQ1Nlc3Npb259IG93bmVyCiAqIEBwYXJhbSB7U0lQLkluY29taW5nUmVxdWVzdHxTSVAuSW5jb21pbmdSZXNwb25zZX0gbWVzc2FnZQogKiBAcGFyYW0ge0VudW19IHR5cGUgVUFDIC8gVUFTCiAqIEBwYXJhbSB7RW51bX0gc3RhdGUgU0lQLkRpYWxvZy5DLlNUQVRVU19FQVJMWSAvIFNJUC5EaWFsb2cuQy5TVEFUVVNfQ09ORklSTUVECiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKCnZhciBSZXF1ZXN0U2VuZGVyID0gcmVxdWlyZSgnLi9EaWFsb2cvUmVxdWVzdFNlbmRlcicpKFNJUCk7Cgp2YXIgRGlhbG9nLAogIEMgPSB7CiAgICAvLyBEaWFsb2cgc3RhdGVzCiAgICBTVEFUVVNfRUFSTFk6ICAgICAgIDEsCiAgICBTVEFUVVNfQ09ORklSTUVEOiAgIDIKICB9OwoKLy8gUkZDIDMyNjEgMTIuMQpEaWFsb2cgPSBmdW5jdGlvbihvd25lciwgbWVzc2FnZSwgdHlwZSwgc3RhdGUpIHsKICB2YXIgY29udGFjdDsKCiAgdGhpcy51YWNfcGVuZGluZ19yZXBseSA9IGZhbHNlOwogIHRoaXMudWFzX3BlbmRpbmdfcmVwbHkgPSBmYWxzZTsKCiAgaWYoIW1lc3NhZ2UuaGFzSGVhZGVyKCdjb250YWN0JykpIHsKICAgIHJldHVybiB7CiAgICAgIGVycm9yOiAndW5hYmxlIHRvIGNyZWF0ZSBhIERpYWxvZyB3aXRob3V0IENvbnRhY3QgaGVhZGVyIGZpZWxkJwogICAgfTsKICB9CgogIGlmKG1lc3NhZ2UgaW5zdGFuY2VvZiBTSVAuSW5jb21pbmdSZXNwb25zZSkgewogICAgc3RhdGUgPSAobWVzc2FnZS5zdGF0dXNfY29kZSA8IDIwMCkgPyBDLlNUQVRVU19FQVJMWSA6IEMuU1RBVFVTX0NPTkZJUk1FRDsKICB9IGVsc2UgewogICAgLy8gQ3JlYXRlIGNvbmZpcm1lZCBkaWFsb2cgaWYgc3RhdGUgaXMgbm90IGRlZmluZWQKICAgIHN0YXRlID0gc3RhdGUgfHwgQy5TVEFUVVNfQ09ORklSTUVEOwogIH0KCiAgY29udGFjdCA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ2NvbnRhY3QnKTsKCiAgLy8gUkZDIDMyNjEgMTIuMS4xCiAgaWYodHlwZSA9PT0gJ1VBUycpIHsKICAgIHRoaXMuaWQgPSB7CiAgICAgIGNhbGxfaWQ6IG1lc3NhZ2UuY2FsbF9pZCwKICAgICAgbG9jYWxfdGFnOiBtZXNzYWdlLnRvX3RhZywKICAgICAgcmVtb3RlX3RhZzogbWVzc2FnZS5mcm9tX3RhZywKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLmNhbGxfaWQgKyB0aGlzLmxvY2FsX3RhZyArIHRoaXMucmVtb3RlX3RhZzsKICAgICAgfQogICAgfTsKICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTsKICAgIHRoaXMucmVtb3RlX3NlcW51bSA9IG1lc3NhZ2UuY3NlcTsKICAgIHRoaXMubG9jYWxfdXJpID0gbWVzc2FnZS5wYXJzZUhlYWRlcigndG8nKS51cmk7CiAgICB0aGlzLnJlbW90ZV91cmkgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCdmcm9tJykudXJpOwogICAgdGhpcy5yZW1vdGVfdGFyZ2V0ID0gY29udGFjdC51cmk7CiAgICB0aGlzLnJvdXRlX3NldCA9IG1lc3NhZ2UuZ2V0SGVhZGVycygncmVjb3JkLXJvdXRlJyk7CiAgICB0aGlzLmludml0ZV9zZXFudW0gPSBtZXNzYWdlLmNzZXE7CiAgICB0aGlzLmxvY2FsX3NlcW51bSA9IG1lc3NhZ2UuY3NlcTsKICB9CiAgLy8gUkZDIDMyNjEgMTIuMS4yCiAgZWxzZSBpZih0eXBlID09PSAnVUFDJykgewogICAgdGhpcy5pZCA9IHsKICAgICAgY2FsbF9pZDogbWVzc2FnZS5jYWxsX2lkLAogICAgICBsb2NhbF90YWc6IG1lc3NhZ2UuZnJvbV90YWcsCiAgICAgIHJlbW90ZV90YWc6IG1lc3NhZ2UudG9fdGFnLAogICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY2FsbF9pZCArIHRoaXMubG9jYWxfdGFnICsgdGhpcy5yZW1vdGVfdGFnOwogICAgICB9CiAgICB9OwogICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgdGhpcy5pbnZpdGVfc2VxbnVtID0gbWVzc2FnZS5jc2VxOwogICAgdGhpcy5sb2NhbF9zZXFudW0gPSBtZXNzYWdlLmNzZXE7CiAgICB0aGlzLmxvY2FsX3VyaSA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ2Zyb20nKS51cmk7CiAgICB0aGlzLnByYWNrZWQgPSBbXTsKICAgIHRoaXMucmVtb3RlX3VyaSA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ3RvJykudXJpOwogICAgdGhpcy5yZW1vdGVfdGFyZ2V0ID0gY29udGFjdC51cmk7CiAgICB0aGlzLnJvdXRlX3NldCA9IG1lc3NhZ2UuZ2V0SGVhZGVycygncmVjb3JkLXJvdXRlJykucmV2ZXJzZSgpOwoKICAgIC8vUkVOREVSQk9EWQogICAgaWYgKHRoaXMuc3RhdGUgPT09IEMuU1RBVFVTX0VBUkxZICYmICghb3duZXIuaGFzT2ZmZXIpKSB7CiAgICAgIHRoaXMubWVkaWFIYW5kbGVyID0gb3duZXIubWVkaWFIYW5kbGVyRmFjdG9yeShvd25lcik7CiAgICB9CiAgfQoKICB0aGlzLmxvZ2dlciA9IG93bmVyLnVhLmdldExvZ2dlcignc2lwLmRpYWxvZycsIHRoaXMuaWQudG9TdHJpbmcoKSk7CiAgdGhpcy5vd25lciA9IG93bmVyOwogIG93bmVyLnVhLmRpYWxvZ3NbdGhpcy5pZC50b1N0cmluZygpXSA9IHRoaXM7CiAgdGhpcy5sb2dnZXIubG9nKCduZXcgJyArIHR5cGUgKyAnIGRpYWxvZyBjcmVhdGVkIHdpdGggc3RhdHVzICcgKyAodGhpcy5zdGF0ZSA9PT0gQy5TVEFUVVNfRUFSTFkgPyAnRUFSTFknOiAnQ09ORklSTUVEJykpOwogIG93bmVyLmVtaXQoJ2RpYWxvZycsIHRoaXMpOwp9OwoKRGlhbG9nLnByb3RvdHlwZSA9IHsKICAvKioKICAgKiBAcGFyYW0ge1NJUC5JbmNvbWluZ01lc3NhZ2V9IG1lc3NhZ2UKICAgKiBAcGFyYW0ge0VudW19IFVBQy9VQVMKICAgKi8KICB1cGRhdGU6IGZ1bmN0aW9uKG1lc3NhZ2UsIHR5cGUpIHsKICAgIHRoaXMuc3RhdGUgPSBDLlNUQVRVU19DT05GSVJNRUQ7CgogICAgdGhpcy5sb2dnZXIubG9nKCdkaWFsb2cgJysgdGhpcy5pZC50b1N0cmluZygpICsnICBjaGFuZ2VkIHRvIENPTkZJUk1FRCBzdGF0ZScpOwoKICAgIGlmKHR5cGUgPT09ICdVQUMnKSB7CiAgICAgIC8vIFJGQyAzMjYxIDEzLjIuMi40CiAgICAgIHRoaXMucm91dGVfc2V0ID0gbWVzc2FnZS5nZXRIZWFkZXJzKCdyZWNvcmQtcm91dGUnKS5yZXZlcnNlKCk7CiAgICB9CiAgfSwKCiAgdGVybWluYXRlOiBmdW5jdGlvbigpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygnZGlhbG9nICcgKyB0aGlzLmlkLnRvU3RyaW5nKCkgKyAnIGRlbGV0ZWQnKTsKICAgIGlmICh0aGlzLm1lZGlhSGFuZGxlciAmJiB0aGlzLnN0YXRlICE9PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy5tZWRpYUhhbmRsZXIucGVlckNvbm5lY3Rpb24uY2xvc2UoKTsKICAgIH0KICAgIGRlbGV0ZSB0aGlzLm93bmVyLnVhLmRpYWxvZ3NbdGhpcy5pZC50b1N0cmluZygpXTsKICB9LAoKICAvKioKICAqIEBwYXJhbSB7U3RyaW5nfSBtZXRob2QgcmVxdWVzdCBtZXRob2QKICAqIEBwYXJhbSB7T2JqZWN0fSBleHRyYUhlYWRlcnMgZXh0cmEgaGVhZGVycwogICogQHJldHVybnMge1NJUC5PdXRnb2luZ1JlcXVlc3R9CiAgKi8KCiAgLy8gUkZDIDMyNjEgMTIuMi4xLjEKICBjcmVhdGVSZXF1ZXN0OiBmdW5jdGlvbihtZXRob2QsIGV4dHJhSGVhZGVycywgYm9keSkgewogICAgdmFyIGNzZXEsIHJlcXVlc3Q7CiAgICBleHRyYUhlYWRlcnMgPSAoZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpOwoKICAgIGlmKCF0aGlzLmxvY2FsX3NlcW51bSkgeyB0aGlzLmxvY2FsX3NlcW51bSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKTsgfQoKICAgIGNzZXEgPSAobWV0aG9kID09PSBTSVAuQy5DQU5DRUwgfHwgbWV0aG9kID09PSBTSVAuQy5BQ0spID8gdGhpcy5pbnZpdGVfc2VxbnVtIDogdGhpcy5sb2NhbF9zZXFudW0gKz0gMTsKCiAgICByZXF1ZXN0ID0gbmV3IFNJUC5PdXRnb2luZ1JlcXVlc3QoCiAgICAgIG1ldGhvZCwKICAgICAgdGhpcy5yZW1vdGVfdGFyZ2V0LAogICAgICB0aGlzLm93bmVyLnVhLCB7CiAgICAgICAgJ2NzZXEnOiBjc2VxLAogICAgICAgICdjYWxsX2lkJzogdGhpcy5pZC5jYWxsX2lkLAogICAgICAgICdmcm9tX3VyaSc6IHRoaXMubG9jYWxfdXJpLAogICAgICAgICdmcm9tX3RhZyc6IHRoaXMuaWQubG9jYWxfdGFnLAogICAgICAgICd0b191cmknOiB0aGlzLnJlbW90ZV91cmksCiAgICAgICAgJ3RvX3RhZyc6IHRoaXMuaWQucmVtb3RlX3RhZywKICAgICAgICAncm91dGVfc2V0JzogdGhpcy5yb3V0ZV9zZXQKICAgICAgfSwgZXh0cmFIZWFkZXJzLCBib2R5KTsKCiAgICByZXF1ZXN0LmRpYWxvZyA9IHRoaXM7CgogICAgcmV0dXJuIHJlcXVlc3Q7CiAgfSwKCiAgLyoqCiAgKiBAcGFyYW0ge1NJUC5JbmNvbWluZ1JlcXVlc3R9IHJlcXVlc3QKICAqIEByZXR1cm5zIHtCb29sZWFufQogICovCgogIC8vIFJGQyAzMjYxIDEyLjIuMgogIGNoZWNrSW5EaWFsb2dSZXF1ZXN0OiBmdW5jdGlvbihyZXF1ZXN0KSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgaWYoIXRoaXMucmVtb3RlX3NlcW51bSkgewogICAgICB0aGlzLnJlbW90ZV9zZXFudW0gPSByZXF1ZXN0LmNzZXE7CiAgICB9IGVsc2UgaWYocmVxdWVzdC5jc2VxIDwgdGhpcy5yZW1vdGVfc2VxbnVtKSB7CiAgICAgICAgLy9EbyBub3QgdHJ5IHRvIHJlcGx5IHRvIGFuIEFDSyByZXF1ZXN0LgogICAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCAhPT0gU0lQLkMuQUNLKSB7CiAgICAgICAgICByZXF1ZXN0LnJlcGx5KDUwMCk7CiAgICAgICAgfQogICAgICAgIGlmIChyZXF1ZXN0LmNzZXEgPT09IHRoaXMuaW52aXRlX3NlcW51bSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gZWxzZSBpZihyZXF1ZXN0LmNzZXEgPiB0aGlzLnJlbW90ZV9zZXFudW0pIHsKICAgICAgdGhpcy5yZW1vdGVfc2VxbnVtID0gcmVxdWVzdC5jc2VxOwogICAgfQoKICAgIHN3aXRjaChyZXF1ZXN0Lm1ldGhvZCkgewogICAgICAvLyBSRkMzMjYxIDE0LjIgTW9kaWZ5aW5nIGFuIEV4aXN0aW5nIFNlc3Npb24gLVVBUyBCRUhBVklPUi0KICAgICAgY2FzZSBTSVAuQy5JTlZJVEU6CiAgICAgICAgaWYgKHRoaXMudWFjX3BlbmRpbmdfcmVwbHkgPT09IHRydWUpIHsKICAgICAgICAgIHJlcXVlc3QucmVwbHkoNDkxKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMudWFzX3BlbmRpbmdfcmVwbHkgPT09IHRydWUpIHsKICAgICAgICAgIHZhciByZXRyeUFmdGVyID0gKE1hdGgucmFuZG9tKCkgKiAxMCB8IDApICsgMTsKICAgICAgICAgIHJlcXVlc3QucmVwbHkoNTAwLCBudWxsLCBbJ1JldHJ5LUFmdGVyOicgKyByZXRyeUFmdGVyXSk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudWFzX3BlbmRpbmdfcmVwbHkgPSB0cnVlOwogICAgICAgICAgcmVxdWVzdC5zZXJ2ZXJfdHJhbnNhY3Rpb24ub24oJ3N0YXRlQ2hhbmdlZCcsIGZ1bmN0aW9uIHN0YXRlQ2hhbmdlZCgpewogICAgICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gU0lQLlRyYW5zYWN0aW9ucy5DLlNUQVRVU19BQ0NFUFRFRCB8fAogICAgICAgICAgICAgICAgdGhpcy5zdGF0ZSA9PT0gU0lQLlRyYW5zYWN0aW9ucy5DLlNUQVRVU19DT01QTEVURUQgfHwKICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUgPT09IFNJUC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfVEVSTUlOQVRFRCkgewoKICAgICAgICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKCdzdGF0ZUNoYW5nZWQnLCBzdGF0ZUNoYW5nZWQpOwogICAgICAgICAgICAgIHNlbGYudWFzX3BlbmRpbmdfcmVwbHkgPSBmYWxzZTsKCiAgICAgICAgICAgICAgaWYgKHNlbGYudWFjX3BlbmRpbmdfcmVwbHkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBzZWxmLm93bmVyLm9uUmVhZHlUb1JlaW52aXRlKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIC8vIFJGQzMyNjEgMTIuMi4yIFJlcGxhY2UgdGhlIGRpYWxvZ2BzIHJlbW90ZSB0YXJnZXQgVVJJIGlmIHRoZSByZXF1ZXN0IGlzIGFjY2VwdGVkCiAgICAgICAgaWYocmVxdWVzdC5oYXNIZWFkZXIoJ2NvbnRhY3QnKSkgewogICAgICAgICAgcmVxdWVzdC5zZXJ2ZXJfdHJhbnNhY3Rpb24ub24oJ3N0YXRlQ2hhbmdlZCcsIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX0FDQ0VQVEVEKSB7CiAgICAgICAgICAgICAgc2VsZi5yZW1vdGVfdGFyZ2V0ID0gcmVxdWVzdC5wYXJzZUhlYWRlcignY29udGFjdCcpLnVyaTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIFNJUC5DLk5PVElGWToKICAgICAgICAvLyBSRkM2NjY1IDMuMiBSZXBsYWNlIHRoZSBkaWFsb2dgcyByZW1vdGUgdGFyZ2V0IFVSSSBpZiB0aGUgcmVxdWVzdCBpcyBhY2NlcHRlZAogICAgICAgIGlmKHJlcXVlc3QuaGFzSGVhZGVyKCdjb250YWN0JykpIHsKICAgICAgICAgIHJlcXVlc3Quc2VydmVyX3RyYW5zYWN0aW9uLm9uKCdzdGF0ZUNoYW5nZWQnLCBmdW5jdGlvbigpewogICAgICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gU0lQLlRyYW5zYWN0aW9ucy5DLlNUQVRVU19DT01QTEVURUQpIHsKICAgICAgICAgICAgICBzZWxmLnJlbW90ZV90YXJnZXQgPSByZXF1ZXN0LnBhcnNlSGVhZGVyKCdjb250YWN0JykudXJpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfSwKCiAgc2VuZFJlcXVlc3Q6IGZ1bmN0aW9uKGFwcGxpY2FudCwgbWV0aG9kLCBvcHRpb25zKSB7CiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgICB2YXIKICAgICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgICBib2R5ID0gb3B0aW9ucy5ib2R5IHx8IG51bGwsCiAgICAgIHJlcXVlc3QgPSB0aGlzLmNyZWF0ZVJlcXVlc3QobWV0aG9kLCBleHRyYUhlYWRlcnMsIGJvZHkpLAogICAgICByZXF1ZXN0X3NlbmRlciA9IG5ldyBSZXF1ZXN0U2VuZGVyKHRoaXMsIGFwcGxpY2FudCwgcmVxdWVzdCk7CgogICAgcmVxdWVzdF9zZW5kZXIuc2VuZCgpOwoKICAgIHJldHVybiByZXF1ZXN0OwogIH0sCgogIC8qKgogICogQHBhcmFtIHtTSVAuSW5jb21pbmdSZXF1ZXN0fSByZXF1ZXN0CiAgKi8KICByZWNlaXZlUmVxdWVzdDogZnVuY3Rpb24ocmVxdWVzdCkgewogICAgLy9DaGVjayBpbi1kaWFsb2cgcmVxdWVzdAogICAgaWYoIXRoaXMuY2hlY2tJbkRpYWxvZ1JlcXVlc3QocmVxdWVzdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMub3duZXIucmVjZWl2ZVJlcXVlc3QocmVxdWVzdCk7CiAgfQp9OwoKRGlhbG9nLkMgPSBDOwpTSVAuRGlhbG9nID0gRGlhbG9nOwp9OwoKfSx7Ii4vRGlhbG9nL1JlcXVlc3RTZW5kZXIiOjExfV0sMTM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgovKioKICogQGZpbGVvdmVydmlldyBTSVAgRGlnZXN0IEF1dGhlbnRpY2F0aW9uCiAqLwoKLyoqCiAqIFNJUCBEaWdlc3QgQXV0aGVudGljYXRpb24uCiAqIEBhdWdtZW50cyBTSVAuCiAqIEBmdW5jdGlvbiBEaWdlc3QgQXV0aGVudGljYXRpb24KICogQHBhcmFtIHtTSVAuVUF9IHVhCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChVdGlscykgewp2YXIgRGlnZXN0QXV0aGVudGljYXRpb247CgpEaWdlc3RBdXRoZW50aWNhdGlvbiA9IGZ1bmN0aW9uKHVhKSB7CiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcGpzLmRpZ2VzdGF1dGhlbnRpY2F0aW9uJyk7CiAgdGhpcy51c2VybmFtZSA9IHVhLmNvbmZpZ3VyYXRpb24uYXV0aG9yaXphdGlvblVzZXI7CiAgdGhpcy5wYXNzd29yZCA9IHVhLmNvbmZpZ3VyYXRpb24ucGFzc3dvcmQ7CiAgdGhpcy5jbm9uY2UgPSBudWxsOwogIHRoaXMubmMgPSAwOwogIHRoaXMubmNIZXggPSAnMDAwMDAwMDAnOwogIHRoaXMucmVzcG9uc2UgPSBudWxsOwp9OwoKCi8qKgoqIFBlcmZvcm1zIERpZ2VzdCBhdXRoZW50aWNhdGlvbiBnaXZlbiBhIFNJUCByZXF1ZXN0IGFuZCB0aGUgY2hhbGxlbmdlCiogcmVjZWl2ZWQgaW4gYSByZXNwb25zZSB0byB0aGF0IHJlcXVlc3QuCiogUmV0dXJucyB0cnVlIGlmIGNyZWRlbnRpYWxzIHdlcmUgc3VjY2Vzc2Z1bGx5IGdlbmVyYXRlZCwgZmFsc2Ugb3RoZXJ3aXNlLgoqCiogQHBhcmFtIHtTSVAuT3V0Z29pbmdSZXF1ZXN0fSByZXF1ZXN0CiogQHBhcmFtIHtPYmplY3R9IGNoYWxsZW5nZQoqLwpEaWdlc3RBdXRoZW50aWNhdGlvbi5wcm90b3R5cGUuYXV0aGVudGljYXRlID0gZnVuY3Rpb24ocmVxdWVzdCwgY2hhbGxlbmdlKSB7CiAgLy8gSW5zcGVjdCBhbmQgdmFsaWRhdGUgdGhlIGNoYWxsZW5nZS4KCiAgdGhpcy5hbGdvcml0aG0gPSBjaGFsbGVuZ2UuYWxnb3JpdGhtOwogIHRoaXMucmVhbG0gPSBjaGFsbGVuZ2UucmVhbG07CiAgdGhpcy5ub25jZSA9IGNoYWxsZW5nZS5ub25jZTsKICB0aGlzLm9wYXF1ZSA9IGNoYWxsZW5nZS5vcGFxdWU7CiAgdGhpcy5zdGFsZSA9IGNoYWxsZW5nZS5zdGFsZTsKCiAgaWYgKHRoaXMuYWxnb3JpdGhtKSB7CiAgICBpZiAodGhpcy5hbGdvcml0aG0gIT09ICdNRDUnKSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ2NoYWxsZW5nZSB3aXRoIERpZ2VzdCBhbGdvcml0aG0gZGlmZmVyZW50IHRoYW4gIk1ENSIsIGF1dGhlbnRpY2F0aW9uIGFib3J0ZWQnKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0gZWxzZSB7CiAgICB0aGlzLmFsZ29yaXRobSA9ICdNRDUnOwogIH0KCiAgaWYgKCEgdGhpcy5yZWFsbSkgewogICAgdGhpcy5sb2dnZXIud2FybignY2hhbGxlbmdlIHdpdGhvdXQgRGlnZXN0IHJlYWxtLCBhdXRoZW50aWNhdGlvbiBhYm9ydGVkJyk7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBpZiAoISB0aGlzLm5vbmNlKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCdjaGFsbGVuZ2Ugd2l0aG91dCBEaWdlc3Qgbm9uY2UsIGF1dGhlbnRpY2F0aW9uIGFib3J0ZWQnKTsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIC8vICdxb3AnIGNhbiBjb250YWluIGEgbGlzdCBvZiB2YWx1ZXMgKEFycmF5KS4gTGV0J3MgY2hvb3NlIGp1c3Qgb25lLgogIGlmIChjaGFsbGVuZ2UucW9wKSB7CiAgICBpZiAoY2hhbGxlbmdlLnFvcC5pbmRleE9mKCdhdXRoJykgPiAtMSkgewogICAgICB0aGlzLnFvcCA9ICdhdXRoJzsKICAgIH0gZWxzZSBpZiAoY2hhbGxlbmdlLnFvcC5pbmRleE9mKCdhdXRoLWludCcpID4gLTEpIHsKICAgICAgdGhpcy5xb3AgPSAnYXV0aC1pbnQnOwogICAgfSBlbHNlIHsKICAgICAgLy8gT3RoZXJ3aXNlICdxb3AnIGlzIHByZXNlbnQgYnV0IGRvZXMgbm90IGNvbnRhaW4gJ2F1dGgnIG9yICdhdXRoLWludCcsIHNvIGFib3J0IGhlcmUuCiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ2NoYWxsZW5nZSB3aXRob3V0IERpZ2VzdCBxb3AgZGlmZmVyZW50IHRoYW4gImF1dGgiIG9yICJhdXRoLWludCIsIGF1dGhlbnRpY2F0aW9uIGFib3J0ZWQnKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0gZWxzZSB7CiAgICB0aGlzLnFvcCA9IG51bGw7CiAgfQoKICAvLyBGaWxsIG90aGVyIGF0dHJpYnV0ZXMuCgogIHRoaXMubWV0aG9kID0gcmVxdWVzdC5tZXRob2Q7CiAgdGhpcy51cmkgPSByZXF1ZXN0LnJ1cmk7CiAgdGhpcy5jbm9uY2UgPSBVdGlscy5jcmVhdGVSYW5kb21Ub2tlbigxMik7CiAgdGhpcy5uYyArPSAxOwogIHRoaXMudXBkYXRlTmNIZXgoKTsKCiAgLy8gbmMtdmFsdWUgPSA4TEhFWC4gTWF4IHZhbHVlID0gJ0ZGRkZGRkZGJy4KICBpZiAodGhpcy5uYyA9PT0gNDI5NDk2NzI5NikgewogICAgdGhpcy5uYyA9IDE7CiAgICB0aGlzLm5jSGV4ID0gJzAwMDAwMDAxJzsKICB9CgogIC8vIENhbGN1bGF0ZSB0aGUgRGlnZXN0ICJyZXNwb25zZSIgdmFsdWUuCiAgdGhpcy5jYWxjdWxhdGVSZXNwb25zZSgpOwoKICByZXR1cm4gdHJ1ZTsKfTsKCgovKioKKiBHZW5lcmF0ZSBEaWdlc3QgJ3Jlc3BvbnNlJyB2YWx1ZS4KKiBAcHJpdmF0ZQoqLwpEaWdlc3RBdXRoZW50aWNhdGlvbi5wcm90b3R5cGUuY2FsY3VsYXRlUmVzcG9uc2UgPSBmdW5jdGlvbigpIHsKICB2YXIgaGExLCBoYTI7CgogIC8vIEhBMSA9IE1ENShBMSkgPSBNRDUodXNlcm5hbWU6cmVhbG06cGFzc3dvcmQpCiAgaGExID0gVXRpbHMuY2FsY3VsYXRlTUQ1KHRoaXMudXNlcm5hbWUgKyAiOiIgKyB0aGlzLnJlYWxtICsgIjoiICsgdGhpcy5wYXNzd29yZCk7CgogIGlmICh0aGlzLnFvcCA9PT0gJ2F1dGgnKSB7CiAgICAvLyBIQTIgPSBNRDUoQTIpID0gTUQ1KG1ldGhvZDpkaWdlc3RVUkkpCiAgICBoYTIgPSBVdGlscy5jYWxjdWxhdGVNRDUodGhpcy5tZXRob2QgKyAiOiIgKyB0aGlzLnVyaSk7CiAgICAvLyByZXNwb25zZSA9IE1ENShIQTE6bm9uY2U6bm9uY2VDb3VudDpjcmVkZW50aWFsc05vbmNlOnFvcDpIQTIpCiAgICB0aGlzLnJlc3BvbnNlID0gVXRpbHMuY2FsY3VsYXRlTUQ1KGhhMSArICI6IiArIHRoaXMubm9uY2UgKyAiOiIgKyB0aGlzLm5jSGV4ICsgIjoiICsgdGhpcy5jbm9uY2UgKyAiOmF1dGg6IiArIGhhMik7CgogIH0gZWxzZSBpZiAodGhpcy5xb3AgPT09ICdhdXRoLWludCcpIHsKICAgIC8vIEhBMiA9IE1ENShBMikgPSBNRDUobWV0aG9kOmRpZ2VzdFVSSTpNRDUoZW50aXR5Qm9keSkpCiAgICBoYTIgPSBVdGlscy5jYWxjdWxhdGVNRDUodGhpcy5tZXRob2QgKyAiOiIgKyB0aGlzLnVyaSArICI6IiArIFV0aWxzLmNhbGN1bGF0ZU1ENSh0aGlzLmJvZHkgPyB0aGlzLmJvZHkgOiAiIikpOwogICAgLy8gcmVzcG9uc2UgPSBNRDUoSEExOm5vbmNlOm5vbmNlQ291bnQ6Y3JlZGVudGlhbHNOb25jZTpxb3A6SEEyKQogICAgdGhpcy5yZXNwb25zZSA9IFV0aWxzLmNhbGN1bGF0ZU1ENShoYTEgKyAiOiIgKyB0aGlzLm5vbmNlICsgIjoiICsgdGhpcy5uY0hleCArICI6IiArIHRoaXMuY25vbmNlICsgIjphdXRoLWludDoiICsgaGEyKTsKCiAgfSBlbHNlIGlmICh0aGlzLnFvcCA9PT0gbnVsbCkgewogICAgLy8gSEEyID0gTUQ1KEEyKSA9IE1ENShtZXRob2Q6ZGlnZXN0VVJJKQogICAgaGEyID0gVXRpbHMuY2FsY3VsYXRlTUQ1KHRoaXMubWV0aG9kICsgIjoiICsgdGhpcy51cmkpOwogICAgLy8gcmVzcG9uc2UgPSBNRDUoSEExOm5vbmNlOkhBMikKICAgIHRoaXMucmVzcG9uc2UgPSBVdGlscy5jYWxjdWxhdGVNRDUoaGExICsgIjoiICsgdGhpcy5ub25jZSArICI6IiArIGhhMik7CiAgfQp9OwoKCi8qKgoqIFJldHVybiB0aGUgUHJveHktQXV0aG9yaXphdGlvbiBvciBXV1ctQXV0aG9yaXphdGlvbiBoZWFkZXIgdmFsdWUuCiovCkRpZ2VzdEF1dGhlbnRpY2F0aW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkgewogIHZhciBhdXRoX3BhcmFtcyA9IFtdOwoKICBpZiAoISB0aGlzLnJlc3BvbnNlKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Jlc3BvbnNlIGZpZWxkIGRvZXMgbm90IGV4aXN0LCBjYW5ub3QgZ2VuZXJhdGUgQXV0aG9yaXphdGlvbiBoZWFkZXInKTsKICB9CgogIGF1dGhfcGFyYW1zLnB1c2goJ2FsZ29yaXRobT0nICsgdGhpcy5hbGdvcml0aG0pOwogIGF1dGhfcGFyYW1zLnB1c2goJ3VzZXJuYW1lPSInICsgdGhpcy51c2VybmFtZSArICciJyk7CiAgYXV0aF9wYXJhbXMucHVzaCgncmVhbG09IicgKyB0aGlzLnJlYWxtICsgJyInKTsKICBhdXRoX3BhcmFtcy5wdXNoKCdub25jZT0iJyArIHRoaXMubm9uY2UgKyAnIicpOwogIGF1dGhfcGFyYW1zLnB1c2goJ3VyaT0iJyArIHRoaXMudXJpICsgJyInKTsKICBhdXRoX3BhcmFtcy5wdXNoKCdyZXNwb25zZT0iJyArIHRoaXMucmVzcG9uc2UgKyAnIicpOwogIGlmICh0aGlzLm9wYXF1ZSkgewogICAgYXV0aF9wYXJhbXMucHVzaCgnb3BhcXVlPSInICsgdGhpcy5vcGFxdWUgKyAnIicpOwogIH0KICBpZiAodGhpcy5xb3ApIHsKICAgIGF1dGhfcGFyYW1zLnB1c2goJ3FvcD0nICsgdGhpcy5xb3ApOwogICAgYXV0aF9wYXJhbXMucHVzaCgnY25vbmNlPSInICsgdGhpcy5jbm9uY2UgKyAnIicpOwogICAgYXV0aF9wYXJhbXMucHVzaCgnbmM9JyArIHRoaXMubmNIZXgpOwogIH0KCiAgcmV0dXJuICdEaWdlc3QgJyArIGF1dGhfcGFyYW1zLmpvaW4oJywgJyk7Cn07CgoKLyoqCiogR2VuZXJhdGUgdGhlICduYycgdmFsdWUgYXMgcmVxdWlyZWQgYnkgRGlnZXN0IGluIHRoaXMubmNIZXggYnkgcmVhZGluZyB0aGlzLm5jLgoqIEBwcml2YXRlCiovCkRpZ2VzdEF1dGhlbnRpY2F0aW9uLnByb3RvdHlwZS51cGRhdGVOY0hleCA9IGZ1bmN0aW9uKCkgewogIHZhciBoZXggPSBOdW1iZXIodGhpcy5uYykudG9TdHJpbmcoMTYpOwogIHRoaXMubmNIZXggPSAnMDAwMDAwMDAnLnN1YnN0cigwLCA4LWhleC5sZW5ndGgpICsgaGV4Owp9OwoKcmV0dXJuIERpZ2VzdEF1dGhlbnRpY2F0aW9uOwp9OwoKfSx7fV0sMTQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CnZhciBOb2RlRXZlbnRFbWl0dGVyID0gcmVxdWlyZSgnZXZlbnRzJykuRXZlbnRFbWl0dGVyOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoY29uc29sZSkgewoKLy8gRG9uJ3QgdXNlIGBuZXcgU0lQLkV2ZW50RW1pdHRlcigpYCBmb3IgaW5oZXJpdGluZy4KLy8gVXNlIE9iamVjdC5jcmVhdGUoU0lQLkV2ZW50RW1pdHRlci5wcm90b3RveXBlKTsKZnVuY3Rpb24gRXZlbnRFbWl0dGVyICgpIHsKICBOb2RlRXZlbnRFbWl0dGVyLmNhbGwodGhpcyk7Cn0KCkV2ZW50RW1pdHRlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKE5vZGVFdmVudEVtaXR0ZXIucHJvdG90eXBlLCB7CiAgY29uc3RydWN0b3I6IHsKICAgIHZhbHVlOiBFdmVudEVtaXR0ZXIsCiAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgIHdyaXRhYmxlOiB0cnVlLAogICAgY29uZmlndXJhYmxlOiB0cnVlCiAgfQp9KTsKCkV2ZW50RW1pdHRlci5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gb2ZmIChldmVudE5hbWUsIGxpc3RlbmVyKSB7CiAgdmFyIHdhcm5pbmcgPSAnJzsKICB3YXJuaW5nICs9ICdTSVAuRXZlbnRFbWl0dGVyI29mZiBpcyBkZXByZWNhdGVkIGFuZCBtYXkgYmUgcmVtb3ZlZCBpbiBmdXR1cmUgU0lQLmpzIHZlcnNpb25zLlxuJzsKICB3YXJuaW5nICs9ICdQbGVhc2UgdXNlIHJlbW92ZUxpc3RlbmVyIG9yIHJlbW92ZUFsbExpc3RlbmVycyBpbnN0ZWFkLlxuJzsKICB3YXJuaW5nICs9ICdTZWUgaGVyZSBmb3IgbW9yZSBkZXRhaWxzOlxuJzsKICB3YXJuaW5nICs9ICdodHRwOi8vbm9kZWpzLm9yZy9hcGkvZXZlbnRzLmh0bWwjZXZlbnRzX2VtaXR0ZXJfcmVtb3ZlbGlzdGVuZXJfZXZlbnRfbGlzdGVuZXInOwogIGNvbnNvbGUud2Fybih3YXJuaW5nKTsKCiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSB7CiAgICByZXR1cm4gdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9IGVsc2UgewogICAgcmV0dXJuIHRoaXMucmVtb3ZlTGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcik7CiAgfQp9OwoKcmV0dXJuIEV2ZW50RW1pdHRlcjsKCn07Cgp9LHsiZXZlbnRzIjoxfV0sMTU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IEV4Y2VwdGlvbnMKICovCgovKioKICogU0lQIEV4Y2VwdGlvbnMuCiAqIEBhdWdtZW50cyBTSVAKICovCm1vZHVsZS5leHBvcnRzID0gewogIENvbmZpZ3VyYXRpb25FcnJvcjogKGZ1bmN0aW9uKCl7CiAgICB2YXIgZXhjZXB0aW9uID0gZnVuY3Rpb24ocGFyYW1ldGVyLCB2YWx1ZSkgewogICAgICB0aGlzLmNvZGUgPSAxOwogICAgICB0aGlzLm5hbWUgPSAnQ09ORklHVVJBVElPTl9FUlJPUic7CiAgICAgIHRoaXMucGFyYW1ldGVyID0gcGFyYW1ldGVyOwogICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CiAgICAgIHRoaXMubWVzc2FnZSA9ICghdGhpcy52YWx1ZSk/ICdNaXNzaW5nIHBhcmFtZXRlcjogJysgdGhpcy5wYXJhbWV0ZXIgOiAnSW52YWxpZCB2YWx1ZSAnKyBKU09OLnN0cmluZ2lmeSh0aGlzLnZhbHVlKSArJyBmb3IgcGFyYW1ldGVyICInKyB0aGlzLnBhcmFtZXRlciArJyInOwogICAgfTsKICAgIGV4Y2VwdGlvbi5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTsKICAgIHJldHVybiBleGNlcHRpb247CiAgfSgpKSwKCiAgSW52YWxpZFN0YXRlRXJyb3I6IChmdW5jdGlvbigpewogICAgdmFyIGV4Y2VwdGlvbiA9IGZ1bmN0aW9uKHN0YXR1cykgewogICAgICB0aGlzLmNvZGUgPSAyOwogICAgICB0aGlzLm5hbWUgPSAnSU5WQUxJRF9TVEFURV9FUlJPUic7CiAgICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzOwogICAgICB0aGlzLm1lc3NhZ2UgPSAnSW52YWxpZCBzdGF0dXM6ICcgKyBzdGF0dXM7CiAgICB9OwogICAgZXhjZXB0aW9uLnByb3RvdHlwZSA9IG5ldyBFcnJvcigpOwogICAgcmV0dXJuIGV4Y2VwdGlvbjsKICB9KCkpLAoKICBOb3RTdXBwb3J0ZWRFcnJvcjogKGZ1bmN0aW9uKCl7CiAgICB2YXIgZXhjZXB0aW9uID0gZnVuY3Rpb24obWVzc2FnZSkgewogICAgICB0aGlzLmNvZGUgPSAzOwogICAgICB0aGlzLm5hbWUgPSAnTk9UX1NVUFBPUlRFRF9FUlJPUic7CiAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7CiAgICB9OwogICAgZXhjZXB0aW9uLnByb3RvdHlwZSA9IG5ldyBFcnJvcigpOwogICAgcmV0dXJuIGV4Y2VwdGlvbjsKICB9KCkpLAoKICBHZXREZXNjcmlwdGlvbkVycm9yOiAoZnVuY3Rpb24oKXsKICAgIHZhciBleGNlcHRpb24gPSBmdW5jdGlvbihtZXNzYWdlKSB7CiAgICAgIHRoaXMuY29kZSA9IDQ7CiAgICAgIHRoaXMubmFtZSA9ICdHRVRfREVTQ1JJUFRJT05fRVJST1InOwogICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlOwogICAgfTsKICAgIGV4Y2VwdGlvbi5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTsKICAgIHJldHVybiBleGNlcHRpb247CiAgfSgpKQp9OwoKfSx7fV0sMTY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CnZhciBHcmFtbWFyID0gcmVxdWlyZSgnLi9HcmFtbWFyL2Rpc3QvR3JhbW1hcicpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CgpyZXR1cm4gewogIHBhcnNlOiBmdW5jdGlvbiBwYXJzZUN1c3RvbSAoaW5wdXQsIHN0YXJ0UnVsZSkgewogICAgdmFyIG9wdGlvbnMgPSB7c3RhcnRSdWxlOiBzdGFydFJ1bGUsIFNJUDogU0lQfTsKICAgIHRyeSB7CiAgICAgIEdyYW1tYXIucGFyc2UoaW5wdXQsIG9wdGlvbnMpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBvcHRpb25zLmRhdGEgPSAtMTsKICAgIH0KICAgIHJldHVybiBvcHRpb25zLmRhdGE7CiAgfQp9OwoKfTsKCn0seyIuL0dyYW1tYXIvZGlzdC9HcmFtbWFyIjoxN31dLDE3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKbW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7CiAgLyoKICAgKiBHZW5lcmF0ZWQgYnkgUEVHLmpzIDAuOC4wLgogICAqCiAgICogaHR0cDovL3BlZ2pzLm1hamRhLmN6LwogICAqLwoKICBmdW5jdGlvbiBwZWckc3ViY2xhc3MoY2hpbGQsIHBhcmVudCkgewogICAgZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9CiAgICBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7CiAgICBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOwogIH0KCiAgZnVuY3Rpb24gU3ludGF4RXJyb3IobWVzc2FnZSwgZXhwZWN0ZWQsIGZvdW5kLCBvZmZzZXQsIGxpbmUsIGNvbHVtbikgewogICAgdGhpcy5tZXNzYWdlICA9IG1lc3NhZ2U7CiAgICB0aGlzLmV4cGVjdGVkID0gZXhwZWN0ZWQ7CiAgICB0aGlzLmZvdW5kICAgID0gZm91bmQ7CiAgICB0aGlzLm9mZnNldCAgID0gb2Zmc2V0OwogICAgdGhpcy5saW5lICAgICA9IGxpbmU7CiAgICB0aGlzLmNvbHVtbiAgID0gY29sdW1uOwoKICAgIHRoaXMubmFtZSAgICAgPSAiU3ludGF4RXJyb3IiOwogIH0KCiAgcGVnJHN1YmNsYXNzKFN5bnRheEVycm9yLCBFcnJvcik7CgogIGZ1bmN0aW9uIHBhcnNlKGlucHV0KSB7CiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDoge30sCgogICAgICAgIHBlZyRGQUlMRUQgPSB7fSwKCiAgICAgICAgcGVnJHN0YXJ0UnVsZUluZGljZXMgPSB7IENvbnRhY3Q6IDExOCwgTmFtZV9BZGRyX0hlYWRlcjogMTU1LCBSZWNvcmRfUm91dGU6IDE3NSwgUmVxdWVzdF9SZXNwb25zZTogODEsIFNJUF9VUkk6IDQ1LCBTdWJzY3JpcHRpb25fU3RhdGU6IDE4NSwgU3VwcG9ydGVkOiAxOTAsIFJlcXVpcmU6IDE4MSwgVmlhOiAxOTMsIGFic29sdXRlVVJJOiA4NCwgQ2FsbF9JRDogMTE3LCBDb250ZW50X0Rpc3Bvc2l0aW9uOiAxMjksIENvbnRlbnRfTGVuZ3RoOiAxMzQsIENvbnRlbnRfVHlwZTogMTM1LCBDU2VxOiAxNDUsIGRpc3BsYXlOYW1lOiAxMjEsIEV2ZW50OiAxNDgsIEZyb206IDE1MCwgaG9zdDogNTIsIE1heF9Gb3J3YXJkczogMTUzLCBNaW5fU0U6IDIxMiwgUHJveHlfQXV0aGVudGljYXRlOiAxNTYsIHF1b3RlZF9zdHJpbmc6IDQwLCBSZWZlcl9UbzogMTc3LCBSZXBsYWNlczogMTc4LCBTZXNzaW9uX0V4cGlyZXM6IDIwOSwgc3R1bl9VUkk6IDIxNiwgVG86IDE5MSwgdHVybl9VUkk6IDIyMywgdXVpZDogMjI2LCBXV1dfQXV0aGVudGljYXRlOiAyMDgsIGNoYWxsZW5nZTogMTU3IH0sCiAgICAgICAgcGVnJHN0YXJ0UnVsZUluZGV4ICAgPSAxMTgsCgogICAgICAgIHBlZyRjb25zdHMgPSBbCiAgICAgICAgICAiXHJcbiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJcclxuIiwgZGVzY3JpcHRpb246ICJcIlxcclxcblwiIiB9LAogICAgICAgICAgL15bMC05XS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiWzAtOV0iLCBkZXNjcmlwdGlvbjogIlswLTldIiB9LAogICAgICAgICAgL15bYS16QS1aXS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW2EtekEtWl0iLCBkZXNjcmlwdGlvbjogIlthLXpBLVpdIiB9LAogICAgICAgICAgL15bMC05YS1mQS1GXS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiWzAtOWEtZkEtRl0iLCBkZXNjcmlwdGlvbjogIlswLTlhLWZBLUZdIiB9LAogICAgICAgICAgL15bXDAtXHhGRl0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcXDAtXFx4RkZdIiwgZGVzY3JpcHRpb246ICJbXFwwLVxceEZGXSIgfSwKICAgICAgICAgIC9eWyJdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbXCJdIiwgZGVzY3JpcHRpb246ICJbXCJdIiB9LAogICAgICAgICAgIiAiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiICIsIGRlc2NyaXB0aW9uOiAiXCIgXCIiIH0sCiAgICAgICAgICAiXHQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiXHQiLCBkZXNjcmlwdGlvbjogIlwiXFx0XCIiIH0sCiAgICAgICAgICAvXlthLXpBLVowLTldLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbYS16QS1aMC05XSIsIGRlc2NyaXB0aW9uOiAiW2EtekEtWjAtOV0iIH0sCiAgICAgICAgICAiOyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICI7IiwgZGVzY3JpcHRpb246ICJcIjtcIiIgfSwKICAgICAgICAgICIvIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIi8iLCBkZXNjcmlwdGlvbjogIlwiL1wiIiB9LAogICAgICAgICAgIj8iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiPyIsIGRlc2NyaXB0aW9uOiAiXCI/XCIiIH0sCiAgICAgICAgICAiOiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICI6IiwgZGVzY3JpcHRpb246ICJcIjpcIiIgfSwKICAgICAgICAgICJAIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIkAiLCBkZXNjcmlwdGlvbjogIlwiQFwiIiB9LAogICAgICAgICAgIiYiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiJiIsIGRlc2NyaXB0aW9uOiAiXCImXCIiIH0sCiAgICAgICAgICAiPSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICI9IiwgZGVzY3JpcHRpb246ICJcIj1cIiIgfSwKICAgICAgICAgICIrIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIisiLCBkZXNjcmlwdGlvbjogIlwiK1wiIiB9LAogICAgICAgICAgIiQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiJCIsIGRlc2NyaXB0aW9uOiAiXCIkXCIiIH0sCiAgICAgICAgICAiLCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIsIiwgZGVzY3JpcHRpb246ICJcIixcIiIgfSwKICAgICAgICAgICItIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIi0iLCBkZXNjcmlwdGlvbjogIlwiLVwiIiB9LAogICAgICAgICAgIl8iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiXyIsIGRlc2NyaXB0aW9uOiAiXCJfXCIiIH0sCiAgICAgICAgICAiLiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIuIiwgZGVzY3JpcHRpb246ICJcIi5cIiIgfSwKICAgICAgICAgICIhIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIiEiLCBkZXNjcmlwdGlvbjogIlwiIVwiIiB9LAogICAgICAgICAgIn4iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAifiIsIGRlc2NyaXB0aW9uOiAiXCJ+XCIiIH0sCiAgICAgICAgICAiKiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIqIiwgZGVzY3JpcHRpb246ICJcIipcIiIgfSwKICAgICAgICAgICInIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIiciLCBkZXNjcmlwdGlvbjogIlwiJ1wiIiB9LAogICAgICAgICAgIigiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiKCIsIGRlc2NyaXB0aW9uOiAiXCIoXCIiIH0sCiAgICAgICAgICAiKSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIpIiwgZGVzY3JpcHRpb246ICJcIilcIiIgfSwKICAgICAgICAgIHBlZyRGQUlMRUQsCiAgICAgICAgICAiJSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIlIiwgZGVzY3JpcHRpb246ICJcIiVcIiIgfSwKICAgICAgICAgIG51bGwsCiAgICAgICAgICBbXSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiICI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gJzonOyB9LAogICAgICAgICAgL15bIS1+XS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiWyEtfl0iLCBkZXNjcmlwdGlvbjogIlshLX5dIiB9LAogICAgICAgICAgL15bXHg4MC1cdUZGRkZdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbXFx4ODAtXFx1RkZGRl0iLCBkZXNjcmlwdGlvbjogIltcXHg4MC1cXHVGRkZGXSIgfSwKICAgICAgICAgIC9eW1x4ODAtXHhCRl0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcXHg4MC1cXHhCRl0iLCBkZXNjcmlwdGlvbjogIltcXHg4MC1cXHhCRl0iIH0sCiAgICAgICAgICAvXlthLWZdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbYS1mXSIsIGRlc2NyaXB0aW9uOiAiW2EtZl0iIH0sCiAgICAgICAgICAiYCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJgIiwgZGVzY3JpcHRpb246ICJcImBcIiIgfSwKICAgICAgICAgICI8IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIjwiLCBkZXNjcmlwdGlvbjogIlwiPFwiIiB9LAogICAgICAgICAgIj4iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiPiIsIGRlc2NyaXB0aW9uOiAiXCI+XCIiIH0sCiAgICAgICAgICAiXFwiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiXFwiLCBkZXNjcmlwdGlvbjogIlwiXFxcXFwiIiB9LAogICAgICAgICAgIlsiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiWyIsIGRlc2NyaXB0aW9uOiAiXCJbXCIiIH0sCiAgICAgICAgICAiXSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJdIiwgZGVzY3JpcHRpb246ICJcIl1cIiIgfSwKICAgICAgICAgICJ7IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInsiLCBkZXNjcmlwdGlvbjogIlwie1wiIiB9LAogICAgICAgICAgIn0iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAifSIsIGRlc2NyaXB0aW9uOiAiXCJ9XCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIioiOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICIvIjsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiPSI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIigiOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICIpIjsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiPiI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIjwiOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICIsIjsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiOyI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIjoiOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICJcIiI7IH0sCiAgICAgICAgICAvXlshLSddLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbIS0nXSIsIGRlc2NyaXB0aW9uOiAiWyEtJ10iIH0sCiAgICAgICAgICAvXlsqLVtdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbKi1bXSIsIGRlc2NyaXB0aW9uOiAiWyotW10iIH0sCiAgICAgICAgICAvXltcXS1+XS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW1xcXS1+XSIsIGRlc2NyaXB0aW9uOiAiW1xcXS1+XSIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGNvbnRlbnRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGVudHM7IH0sCiAgICAgICAgICAvXlsjLVtdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbIy1bXSIsIGRlc2NyaXB0aW9uOiAiWyMtW10iIH0sCiAgICAgICAgICAvXltcMC1cdF0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcXDAtXFx0XSIsIGRlc2NyaXB0aW9uOiAiW1xcMC1cXHRdIiB9LAogICAgICAgICAgL15bXHgwQi1cZl0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcXHgwQi1cXGZdIiwgZGVzY3JpcHRpb246ICJbXFx4MEItXFxmXSIgfSwKICAgICAgICAgIC9eW1x4MEUtf10vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcXHgwRS1/XSIsIGRlc2NyaXB0aW9uOiAiW1xceDBFLX9dIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpID0gbmV3IG9wdGlvbnMuU0lQLlVSSShvcHRpb25zLmRhdGEuc2NoZW1lLCBvcHRpb25zLmRhdGEudXNlciwgb3B0aW9ucy5kYXRhLmhvc3QsIG9wdGlvbnMuZGF0YS5wb3J0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEuc2NoZW1lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS51c2VyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5ob3N0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5ob3N0X3R5cGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnBvcnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaSA9IG5ldyBvcHRpb25zLlNJUC5VUkkob3B0aW9ucy5kYXRhLnNjaGVtZSwgb3B0aW9ucy5kYXRhLnVzZXIsIG9wdGlvbnMuZGF0YS5ob3N0LCBvcHRpb25zLmRhdGEucG9ydCwgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXMsIG9wdGlvbnMuZGF0YS51cmlfaGVhZGVycyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnNjaGVtZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEudXNlcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEuaG9zdDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEuaG9zdF90eXBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5wb3J0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS51cmlfcGFyYW1zOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXJ0UnVsZSA9PT0gJ1NJUF9VUkknKSB7IG9wdGlvbnMuZGF0YSA9IG9wdGlvbnMuZGF0YS51cmk7fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAic2lwcyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJzaXBzIiwgZGVzY3JpcHRpb246ICJcInNpcHNcIiIgfSwKICAgICAgICAgICJzaXAiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAic2lwIiwgZGVzY3JpcHRpb246ICJcInNpcFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24odXJpX3NjaGVtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuc2NoZW1lID0gdXJpX3NjaGVtZTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXNlciA9IGRlY29kZVVSSUNvbXBvbmVudCh0ZXh0KCkuc2xpY2UoMCwgLTEpKTt9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5wYXNzd29yZCA9IHRleHQoKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuaG9zdCA9IHRleHQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnMuZGF0YS5ob3N0OyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuaG9zdF90eXBlID0gJ2RvbWFpbic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dCgpOyB9LAogICAgICAgICAgL15bYS16QS1aMC05X1wtXS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW2EtekEtWjAtOV9cXC1dIiwgZGVzY3JpcHRpb246ICJbYS16QS1aMC05X1xcLV0iIH0sCiAgICAgICAgICAvXlthLXpBLVowLTlcLV0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIlthLXpBLVowLTlcXC1dIiwgZGVzY3JpcHRpb246ICJbYS16QS1aMC05XFwtXSIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuaG9zdF90eXBlID0gJ0lQdjYnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dCgpOyB9LAogICAgICAgICAgIjo6IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIjo6IiwgZGVzY3JpcHRpb246ICJcIjo6XCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5ob3N0X3R5cGUgPSAnSVB2Nic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dCgpOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5ob3N0X3R5cGUgPSAnSVB2NCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0KCk7IH0sCiAgICAgICAgICAiMjUiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiMjUiLCBkZXNjcmlwdGlvbjogIlwiMjVcIiIgfSwKICAgICAgICAgIC9eWzAtNV0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIlswLTVdIiwgZGVzY3JpcHRpb246ICJbMC01XSIgfSwKICAgICAgICAgICIyIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIjIiLCBkZXNjcmlwdGlvbjogIlwiMlwiIiB9LAogICAgICAgICAgL15bMC00XS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiWzAtNF0iLCBkZXNjcmlwdGlvbjogIlswLTRdIiB9LAogICAgICAgICAgIjEiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiMSIsIGRlc2NyaXB0aW9uOiAiXCIxXCIiIH0sCiAgICAgICAgICAvXlsxLTldLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbMS05XSIsIGRlc2NyaXB0aW9uOiAiWzEtOV0iIH0sCiAgICAgICAgICBmdW5jdGlvbihwb3J0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcnQgPSBwYXJzZUludChwb3J0LmpvaW4oJycpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnBvcnQgPSBwb3J0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9ydDsgfSwKICAgICAgICAgICJ0cmFuc3BvcnQ9IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInRyYW5zcG9ydD0iLCBkZXNjcmlwdGlvbjogIlwidHJhbnNwb3J0PVwiIiB9LAogICAgICAgICAgInVkcCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ1ZHAiLCBkZXNjcmlwdGlvbjogIlwidWRwXCIiIH0sCiAgICAgICAgICAidGNwIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInRjcCIsIGRlc2NyaXB0aW9uOiAiXCJ0Y3BcIiIgfSwKICAgICAgICAgICJzY3RwIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInNjdHAiLCBkZXNjcmlwdGlvbjogIlwic2N0cFwiIiB9LAogICAgICAgICAgInRscyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ0bHMiLCBkZXNjcmlwdGlvbjogIlwidGxzXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbih0cmFuc3BvcnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXMpIG9wdGlvbnMuZGF0YS51cmlfcGFyYW1zPXt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS51cmlfcGFyYW1zWyd0cmFuc3BvcnQnXSA9IHRyYW5zcG9ydC50b0xvd2VyQ2FzZSgpOyB9LAogICAgICAgICAgInVzZXI9IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInVzZXI9IiwgZGVzY3JpcHRpb246ICJcInVzZXI9XCIiIH0sCiAgICAgICAgICAicGhvbmUiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicGhvbmUiLCBkZXNjcmlwdGlvbjogIlwicGhvbmVcIiIgfSwKICAgICAgICAgICJpcCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJpcCIsIGRlc2NyaXB0aW9uOiAiXCJpcFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24odXNlcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEudXJpX3BhcmFtcykgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXM9e307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXNbJ3VzZXInXSA9IHVzZXIudG9Mb3dlckNhc2UoKTsgfSwKICAgICAgICAgICJtZXRob2Q9IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm1ldGhvZD0iLCBkZXNjcmlwdGlvbjogIlwibWV0aG9kPVwiIiB9LAogICAgICAgICAgZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS51cmlfcGFyYW1zKSBvcHRpb25zLmRhdGEudXJpX3BhcmFtcz17fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpX3BhcmFtc1snbWV0aG9kJ10gPSBtZXRob2Q7IH0sCiAgICAgICAgICAidHRsPSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ0dGw9IiwgZGVzY3JpcHRpb246ICJcInR0bD1cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHR0bCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEucGFyYW1zKSBvcHRpb25zLmRhdGEucGFyYW1zPXt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5wYXJhbXNbJ3R0bCddID0gdHRsOyB9LAogICAgICAgICAgIm1hZGRyPSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJtYWRkcj0iLCBkZXNjcmlwdGlvbjogIlwibWFkZHI9XCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihtYWRkcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEudXJpX3BhcmFtcykgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXM9e307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXNbJ21hZGRyJ10gPSBtYWRkcjsgfSwKICAgICAgICAgICJsciIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJsciIsIGRlc2NyaXB0aW9uOiAiXCJsclwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS51cmlfcGFyYW1zKSBvcHRpb25zLmRhdGEudXJpX3BhcmFtcz17fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpX3BhcmFtc1snbHInXSA9IHVuZGVmaW5lZDsgfSwKICAgICAgICAgIGZ1bmN0aW9uKHBhcmFtLCB2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEudXJpX3BhcmFtcykgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXMgPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZVsxXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXNbcGFyYW0udG9Mb3dlckNhc2UoKV0gPSB2YWx1ZSAmJiB2YWx1ZS50b0xvd2VyQ2FzZSgpO30sCiAgICAgICAgICBmdW5jdGlvbihobmFtZSwgaHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG5hbWUgPSBobmFtZS5qb2luKCcnKS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh2YWx1ZSA9IGh2YWx1ZS5qb2luKCcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighb3B0aW9ucy5kYXRhLnVyaV9oZWFkZXJzKSBvcHRpb25zLmRhdGEudXJpX2hlYWRlcnMgPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMuZGF0YS51cmlfaGVhZGVyc1tobmFtZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS51cmlfaGVhZGVyc1tobmFtZV0gPSBbaHZhbHVlXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaV9oZWFkZXJzW2huYW1lXS5wdXNoKGh2YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsb3RzIG9mIHRlc3RzIGZhaWwgaWYgdGhpcyBpc24ndCBndWFyZGVkLi4uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3RhcnRSdWxlID09PSAnUmVmZXJfVG8nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpID0gbmV3IG9wdGlvbnMuU0lQLlVSSShvcHRpb25zLmRhdGEuc2NoZW1lLCBvcHRpb25zLmRhdGEudXNlciwgb3B0aW9ucy5kYXRhLmhvc3QsIG9wdGlvbnMuZGF0YS5wb3J0LCBvcHRpb25zLmRhdGEudXJpX3BhcmFtcywgb3B0aW9ucy5kYXRhLnVyaV9oZWFkZXJzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEuc2NoZW1lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS51c2VyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5ob3N0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5ob3N0X3R5cGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnBvcnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgIi8vIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIi8vIiwgZGVzY3JpcHRpb246ICJcIi8vXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnNjaGVtZT0gdGV4dCgpOyB9LAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiU0lQIiwgZGVzY3JpcHRpb246ICJcIlNJUFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5zaXBfdmVyc2lvbiA9IHRleHQoKTsgfSwKICAgICAgICAgICJJTlZJVEUiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiSU5WSVRFIiwgZGVzY3JpcHRpb246ICJcIklOVklURVwiIiB9LAogICAgICAgICAgIkFDSyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJBQ0siLCBkZXNjcmlwdGlvbjogIlwiQUNLXCIiIH0sCiAgICAgICAgICAiVlhBQ0giLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiVlhBQ0giLCBkZXNjcmlwdGlvbjogIlwiVlhBQ0hcIiIgfSwKICAgICAgICAgICJPUFRJT05TIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIk9QVElPTlMiLCBkZXNjcmlwdGlvbjogIlwiT1BUSU9OU1wiIiB9LAogICAgICAgICAgIkJZRSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJCWUUiLCBkZXNjcmlwdGlvbjogIlwiQllFXCIiIH0sCiAgICAgICAgICAiQ0FOQ0VMIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIkNBTkNFTCIsIGRlc2NyaXB0aW9uOiAiXCJDQU5DRUxcIiIgfSwKICAgICAgICAgICJSRUdJU1RFUiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJSRUdJU1RFUiIsIGRlc2NyaXB0aW9uOiAiXCJSRUdJU1RFUlwiIiB9LAogICAgICAgICAgIlNVQlNDUklCRSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJTVUJTQ1JJQkUiLCBkZXNjcmlwdGlvbjogIlwiU1VCU0NSSUJFXCIiIH0sCiAgICAgICAgICAiTk9USUZZIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIk5PVElGWSIsIGRlc2NyaXB0aW9uOiAiXCJOT1RJRllcIiIgfSwKICAgICAgICAgICJSRUZFUiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJSRUZFUiIsIGRlc2NyaXB0aW9uOiAiXCJSRUZFUlwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEubWV0aG9kID0gdGV4dCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9ucy5kYXRhLm1ldGhvZDsgfSwKICAgICAgICAgIGZ1bmN0aW9uKHN0YXR1c19jb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuc3RhdHVzX2NvZGUgPSBwYXJzZUludChzdGF0dXNfY29kZS5qb2luKCcnKSk7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5yZWFzb25fcGhyYXNlID0gdGV4dCgpOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IHRleHQoKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCwgbGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoID0gb3B0aW9ucy5kYXRhLm11bHRpX2hlYWRlci5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXJbaWR4XS5wYXJzZWQgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5kYXRhICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSAtMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGVhZGVyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXIpIG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXIgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IG5ldyBvcHRpb25zLlNJUC5OYW1lQWRkckhlYWRlcihvcHRpb25zLmRhdGEudXJpLCBvcHRpb25zLmRhdGEuZGlzcGxheU5hbWUsIG9wdGlvbnMuZGF0YS5wYXJhbXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnVyaTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5kaXNwbGF5TmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5wYXJhbXM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXIucHVzaCggeyAncG9zaXRpb24nOiBwZWckY3VyclBvcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCc6IG9mZnNldCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncGFyc2VkJzogaGVhZGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTt9LAogICAgICAgICAgZnVuY3Rpb24oZGlzcGxheU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lID0gdGV4dCgpLnRyaW0oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXNwbGF5TmFtZVswXSA9PT0gJ1wiJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZSA9IGRpc3BsYXlOYW1lLnN1YnN0cmluZygxLCBkaXNwbGF5TmFtZS5sZW5ndGgtMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuZGlzcGxheU5hbWUgPSBkaXNwbGF5TmFtZTsgfSwKICAgICAgICAgICJxIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInEiLCBkZXNjcmlwdGlvbjogIlwicVwiIiB9LAogICAgICAgICAgZnVuY3Rpb24ocSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS5wYXJhbXMpIG9wdGlvbnMuZGF0YS5wYXJhbXMgPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5wYXJhbXNbJ3EnXSA9IHE7IH0sCiAgICAgICAgICAiZXhwaXJlcyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJleHBpcmVzIiwgZGVzY3JpcHRpb246ICJcImV4cGlyZXNcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGV4cGlyZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEucGFyYW1zKSBvcHRpb25zLmRhdGEucGFyYW1zID0ge307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEucGFyYW1zWydleHBpcmVzJ10gPSBleHBpcmVzOyB9LAogICAgICAgICAgZnVuY3Rpb24oZGVsdGFfc2Vjb25kcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KGRlbHRhX3NlY29uZHMuam9pbignJykpOyB9LAogICAgICAgICAgIjAiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiMCIsIGRlc2NyaXB0aW9uOiAiXCIwXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHRleHQoKSk7IH0sCiAgICAgICAgICBmdW5jdGlvbihwYXJhbSwgdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEucGFyYW1zKSBvcHRpb25zLmRhdGEucGFyYW1zID0ge307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlWzFdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnBhcmFtc1twYXJhbS50b0xvd2VyQ2FzZSgpXSA9IHZhbHVlO30sCiAgICAgICAgICAicmVuZGVyIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJlbmRlciIsIGRlc2NyaXB0aW9uOiAiXCJyZW5kZXJcIiIgfSwKICAgICAgICAgICJzZXNzaW9uIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInNlc3Npb24iLCBkZXNjcmlwdGlvbjogIlwic2Vzc2lvblwiIiB9LAogICAgICAgICAgImljb24iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiaWNvbiIsIGRlc2NyaXB0aW9uOiAiXCJpY29uXCIiIH0sCiAgICAgICAgICAiYWxlcnQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiYWxlcnQiLCBkZXNjcmlwdGlvbjogIlwiYWxlcnRcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXJ0UnVsZSA9PT0gJ0NvbnRlbnRfRGlzcG9zaXRpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudHlwZSA9IHRleHQoKS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICJoYW5kbGluZyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJoYW5kbGluZyIsIGRlc2NyaXB0aW9uOiAiXCJoYW5kbGluZ1wiIiB9LAogICAgICAgICAgIm9wdGlvbmFsIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm9wdGlvbmFsIiwgZGVzY3JpcHRpb246ICJcIm9wdGlvbmFsXCIiIH0sCiAgICAgICAgICAicmVxdWlyZWQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicmVxdWlyZWQiLCBkZXNjcmlwdGlvbjogIlwicmVxdWlyZWRcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gcGFyc2VJbnQobGVuZ3RoLmpvaW4oJycpKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gdGV4dCgpOyB9LAogICAgICAgICAgInRleHQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidGV4dCIsIGRlc2NyaXB0aW9uOiAiXCJ0ZXh0XCIiIH0sCiAgICAgICAgICAiaW1hZ2UiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiaW1hZ2UiLCBkZXNjcmlwdGlvbjogIlwiaW1hZ2VcIiIgfSwKICAgICAgICAgICJhdWRpbyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJhdWRpbyIsIGRlc2NyaXB0aW9uOiAiXCJhdWRpb1wiIiB9LAogICAgICAgICAgInZpZGVvIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInZpZGVvIiwgZGVzY3JpcHRpb246ICJcInZpZGVvXCIiIH0sCiAgICAgICAgICAiYXBwbGljYXRpb24iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiYXBwbGljYXRpb24iLCBkZXNjcmlwdGlvbjogIlwiYXBwbGljYXRpb25cIiIgfSwKICAgICAgICAgICJtZXNzYWdlIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm1lc3NhZ2UiLCBkZXNjcmlwdGlvbjogIlwibWVzc2FnZVwiIiB9LAogICAgICAgICAgIm11bHRpcGFydCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJtdWx0aXBhcnQiLCBkZXNjcmlwdGlvbjogIlwibXVsdGlwYXJ0XCIiIH0sCiAgICAgICAgICAieC0iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAieC0iLCBkZXNjcmlwdGlvbjogIlwieC1cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGNzZXFfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS52YWx1ZT1wYXJzZUludChjc2VxX3ZhbHVlLmpvaW4oJycpKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKGV4cGlyZXMpIHtvcHRpb25zLmRhdGEgPSBleHBpcmVzOyB9LAogICAgICAgICAgZnVuY3Rpb24oZXZlbnRfdHlwZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuZXZlbnQgPSBldmVudF90eXBlLnRvTG93ZXJDYXNlKCk7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFnID0gb3B0aW9ucy5kYXRhLnRhZzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IG5ldyBvcHRpb25zLlNJUC5OYW1lQWRkckhlYWRlcihvcHRpb25zLmRhdGEudXJpLCBvcHRpb25zLmRhdGEuZGlzcGxheU5hbWUsIG9wdGlvbnMuZGF0YS5wYXJhbXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhZykge29wdGlvbnMuZGF0YS5zZXRQYXJhbSgndGFnJyx0YWcpfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAidGFnIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInRhZyIsIGRlc2NyaXB0aW9uOiAiXCJ0YWdcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHRhZykge29wdGlvbnMuZGF0YS50YWcgPSB0YWc7IH0sCiAgICAgICAgICBmdW5jdGlvbihmb3J3YXJkcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gcGFyc2VJbnQoZm9yd2FyZHMuam9pbignJykpOyB9LAogICAgICAgICAgZnVuY3Rpb24obWluX2V4cGlyZXMpIHtvcHRpb25zLmRhdGEgPSBtaW5fZXhwaXJlczsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gbmV3IG9wdGlvbnMuU0lQLk5hbWVBZGRySGVhZGVyKG9wdGlvbnMuZGF0YS51cmksIG9wdGlvbnMuZGF0YS5kaXNwbGF5TmFtZSwgb3B0aW9ucy5kYXRhLnBhcmFtcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICJkaWdlc3QiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiRGlnZXN0IiwgZGVzY3JpcHRpb246ICJcIkRpZ2VzdFwiIiB9LAogICAgICAgICAgInJlYWxtIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJlYWxtIiwgZGVzY3JpcHRpb246ICJcInJlYWxtXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihyZWFsbSkgeyBvcHRpb25zLmRhdGEucmVhbG0gPSByZWFsbTsgfSwKICAgICAgICAgICJkb21haW4iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiZG9tYWluIiwgZGVzY3JpcHRpb246ICJcImRvbWFpblwiIiB9LAogICAgICAgICAgIm5vbmNlIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm5vbmNlIiwgZGVzY3JpcHRpb246ICJcIm5vbmNlXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihub25jZSkgeyBvcHRpb25zLmRhdGEubm9uY2U9bm9uY2U7IH0sCiAgICAgICAgICAib3BhcXVlIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm9wYXF1ZSIsIGRlc2NyaXB0aW9uOiAiXCJvcGFxdWVcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKG9wYXF1ZSkgeyBvcHRpb25zLmRhdGEub3BhcXVlPW9wYXF1ZTsgfSwKICAgICAgICAgICJzdGFsZSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJzdGFsZSIsIGRlc2NyaXB0aW9uOiAiXCJzdGFsZVwiIiB9LAogICAgICAgICAgInRydWUiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidHJ1ZSIsIGRlc2NyaXB0aW9uOiAiXCJ0cnVlXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsgb3B0aW9ucy5kYXRhLnN0YWxlPXRydWU7IH0sCiAgICAgICAgICAiZmFsc2UiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiZmFsc2UiLCBkZXNjcmlwdGlvbjogIlwiZmFsc2VcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgeyBvcHRpb25zLmRhdGEuc3RhbGU9ZmFsc2U7IH0sCiAgICAgICAgICAiYWxnb3JpdGhtIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImFsZ29yaXRobSIsIGRlc2NyaXB0aW9uOiAiXCJhbGdvcml0aG1cIiIgfSwKICAgICAgICAgICJtZDUiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiTUQ1IiwgZGVzY3JpcHRpb246ICJcIk1ENVwiIiB9LAogICAgICAgICAgIm1kNS1zZXNzIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIk1ENS1zZXNzIiwgZGVzY3JpcHRpb246ICJcIk1ENS1zZXNzXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihhbGdvcml0aG0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuYWxnb3JpdGhtPWFsZ29yaXRobS50b1VwcGVyQ2FzZSgpOyB9LAogICAgICAgICAgInFvcCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJxb3AiLCBkZXNjcmlwdGlvbjogIlwicW9wXCIiIH0sCiAgICAgICAgICAiYXV0aC1pbnQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiYXV0aC1pbnQiLCBkZXNjcmlwdGlvbjogIlwiYXV0aC1pbnRcIiIgfSwKICAgICAgICAgICJhdXRoIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImF1dGgiLCBkZXNjcmlwdGlvbjogIlwiYXV0aFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24ocW9wX3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEucW9wIHx8IChvcHRpb25zLmRhdGEucW9wPVtdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5xb3AucHVzaChxb3BfdmFsdWUudG9Mb3dlckNhc2UoKSk7IH0sCiAgICAgICAgICBmdW5jdGlvbihyYWNrX3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudmFsdWU9cGFyc2VJbnQocmFja192YWx1ZS5qb2luKCcnKSk7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHgsIGxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aCA9IG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXIubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmRhdGEubXVsdGlfaGVhZGVyW2lkeF0ucGFyc2VkID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGF0YSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBvcHRpb25zLmRhdGEubXVsdGlfaGVhZGVyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gLTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEubXVsdGlfaGVhZGVyKSBvcHRpb25zLmRhdGEubXVsdGlfaGVhZGVyID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXIgPSBuZXcgb3B0aW9ucy5TSVAuTmFtZUFkZHJIZWFkZXIob3B0aW9ucy5kYXRhLnVyaSwgb3B0aW9ucy5kYXRhLmRpc3BsYXlOYW1lLCBvcHRpb25zLmRhdGEucGFyYW1zKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS51cmk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEuZGlzcGxheU5hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEucGFyYW1zOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEubXVsdGlfaGVhZGVyLnB1c2goIHsgJ3Bvc2l0aW9uJzogcGVnJGN1cnJQb3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvZmZzZXQnOiBvZmZzZXQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3BhcnNlZCc6IGhlYWRlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7fSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBuZXcgb3B0aW9ucy5TSVAuTmFtZUFkZHJIZWFkZXIob3B0aW9ucy5kYXRhLnVyaSwgb3B0aW9ucy5kYXRhLmRpc3BsYXlOYW1lLCBvcHRpb25zLmRhdGEucGFyYW1zKTsKICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShvcHRpb25zLmRhdGEucmVwbGFjZXNfZnJvbV90YWcgJiYgb3B0aW9ucy5kYXRhLnJlcGxhY2VzX3RvX3RhZykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IC0xOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxfaWQ6IG9wdGlvbnMuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAiZnJvbS10YWciLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiZnJvbS10YWciLCBkZXNjcmlwdGlvbjogIlwiZnJvbS10YWdcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGZyb21fdGFnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnJlcGxhY2VzX2Zyb21fdGFnID0gZnJvbV90YWc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAidG8tdGFnIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInRvLXRhZyIsIGRlc2NyaXB0aW9uOiAiXCJ0by10YWdcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHRvX3RhZykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5yZXBsYWNlc190b190YWcgPSB0b190YWc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAiZWFybHktb25seSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJlYXJseS1vbmx5IiwgZGVzY3JpcHRpb246ICJcImVhcmx5LW9ubHlcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5lYXJseV9vbmx5ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKHIpIHtyZXR1cm4gcjt9LAogICAgICAgICAgZnVuY3Rpb24oZmlyc3QsIHJlc3QpIHsgcmV0dXJuIGxpc3QoZmlyc3QsIHJlc3QpOyB9LAogICAgICAgICAgZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5zdGFydFJ1bGUgPT09ICdSZXF1aXJlJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gdmFsdWUgfHwgW107CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgZnVuY3Rpb24ocnNlcV92YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnZhbHVlPXBhcnNlSW50KHJzZXFfdmFsdWUuam9pbignJykpOyB9LAogICAgICAgICAgImFjdGl2ZSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJhY3RpdmUiLCBkZXNjcmlwdGlvbjogIlwiYWN0aXZlXCIiIH0sCiAgICAgICAgICAicGVuZGluZyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJwZW5kaW5nIiwgZGVzY3JpcHRpb246ICJcInBlbmRpbmdcIiIgfSwKICAgICAgICAgICJ0ZXJtaW5hdGVkIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInRlcm1pbmF0ZWQiLCBkZXNjcmlwdGlvbjogIlwidGVybWluYXRlZFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuc3RhdGUgPSB0ZXh0KCk7IH0sCiAgICAgICAgICAicmVhc29uIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJlYXNvbiIsIGRlc2NyaXB0aW9uOiAiXCJyZWFzb25cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHJlYXNvbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZWFzb24gIT09ICd1bmRlZmluZWQnKSBvcHRpb25zLmRhdGEucmVhc29uID0gcmVhc29uOyB9LAogICAgICAgICAgZnVuY3Rpb24oZXhwaXJlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBleHBpcmVzICE9PSAndW5kZWZpbmVkJykgb3B0aW9ucy5kYXRhLmV4cGlyZXMgPSBleHBpcmVzOyB9LAogICAgICAgICAgInJldHJ5X2FmdGVyIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJldHJ5X2FmdGVyIiwgZGVzY3JpcHRpb246ICJcInJldHJ5X2FmdGVyXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihyZXRyeV9hZnRlcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZXRyeV9hZnRlciAhPT0gJ3VuZGVmaW5lZCcpIG9wdGlvbnMuZGF0YS5yZXRyeV9hZnRlciA9IHJldHJ5X2FmdGVyOyB9LAogICAgICAgICAgImRlYWN0aXZhdGVkIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImRlYWN0aXZhdGVkIiwgZGVzY3JpcHRpb246ICJcImRlYWN0aXZhdGVkXCIiIH0sCiAgICAgICAgICAicHJvYmF0aW9uIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInByb2JhdGlvbiIsIGRlc2NyaXB0aW9uOiAiXCJwcm9iYXRpb25cIiIgfSwKICAgICAgICAgICJyZWplY3RlZCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJyZWplY3RlZCIsIGRlc2NyaXB0aW9uOiAiXCJyZWplY3RlZFwiIiB9LAogICAgICAgICAgInRpbWVvdXQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidGltZW91dCIsIGRlc2NyaXB0aW9uOiAiXCJ0aW1lb3V0XCIiIH0sCiAgICAgICAgICAiZ2l2ZXVwIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImdpdmV1cCIsIGRlc2NyaXB0aW9uOiAiXCJnaXZldXBcIiIgfSwKICAgICAgICAgICJub3Jlc291cmNlIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm5vcmVzb3VyY2UiLCBkZXNjcmlwdGlvbjogIlwibm9yZXNvdXJjZVwiIiB9LAogICAgICAgICAgImludmFyaWFudCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJpbnZhcmlhbnQiLCBkZXNjcmlwdGlvbjogIlwiaW52YXJpYW50XCIiIH0sCiAgICAgICAgICBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXJ0UnVsZSA9PT0gJ1N1cHBvcnRlZCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IHZhbHVlIHx8IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFnID0gb3B0aW9ucy5kYXRhLnRhZzsKICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBuZXcgb3B0aW9ucy5TSVAuTmFtZUFkZHJIZWFkZXIob3B0aW9ucy5kYXRhLnVyaSwgb3B0aW9ucy5kYXRhLmRpc3BsYXlOYW1lLCBvcHRpb25zLmRhdGEucGFyYW1zKTsKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFnKSB7b3B0aW9ucy5kYXRhLnNldFBhcmFtKCd0YWcnLHRhZyl9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAidHRsIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInR0bCIsIGRlc2NyaXB0aW9uOiAiXCJ0dGxcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHZpYV90dGxfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudHRsID0gdmlhX3R0bF92YWx1ZTsgfSwKICAgICAgICAgICJtYWRkciIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJtYWRkciIsIGRlc2NyaXB0aW9uOiAiXCJtYWRkclwiIiB9LAogICAgICAgICAgZnVuY3Rpb24odmlhX21hZGRyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLm1hZGRyID0gdmlhX21hZGRyOyB9LAogICAgICAgICAgInJlY2VpdmVkIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJlY2VpdmVkIiwgZGVzY3JpcHRpb246ICJcInJlY2VpdmVkXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbih2aWFfcmVjZWl2ZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEucmVjZWl2ZWQgPSB2aWFfcmVjZWl2ZWQ7IH0sCiAgICAgICAgICAiYnJhbmNoIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImJyYW5jaCIsIGRlc2NyaXB0aW9uOiAiXCJicmFuY2hcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHZpYV9icmFuY2gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuYnJhbmNoID0gdmlhX2JyYW5jaDsgfSwKICAgICAgICAgICJycG9ydCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJycG9ydCIsIGRlc2NyaXB0aW9uOiAiXCJycG9ydFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIHJlc3BvbnNlX3BvcnQgIT09ICd1bmRlZmluZWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnJwb3J0ID0gcmVzcG9uc2VfcG9ydC5qb2luKCcnKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKHZpYV9wcm90b2NvbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5wcm90b2NvbCA9IHZpYV9wcm90b2NvbDsgfSwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlVEUCIsIGRlc2NyaXB0aW9uOiAiXCJVRFBcIiIgfSwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlRDUCIsIGRlc2NyaXB0aW9uOiAiXCJUQ1BcIiIgfSwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlRMUyIsIGRlc2NyaXB0aW9uOiAiXCJUTFNcIiIgfSwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlNDVFAiLCBkZXNjcmlwdGlvbjogIlwiU0NUUFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24odmlhX3RyYW5zcG9ydCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS50cmFuc3BvcnQgPSB2aWFfdHJhbnNwb3J0OyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLmhvc3QgPSB0ZXh0KCk7IH0sCiAgICAgICAgICBmdW5jdGlvbih2aWFfc2VudF9ieV9wb3J0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnBvcnQgPSBwYXJzZUludCh2aWFfc2VudF9ieV9wb3J0LmpvaW4oJycpKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKHR0bCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh0dGwuam9pbignJykpOyB9LAogICAgICAgICAgZnVuY3Rpb24oZGVsdGFTZWNvbmRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3RhcnRSdWxlID09PSAnU2Vzc2lvbl9FeHBpcmVzJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLmRlbHRhU2Vjb25kcyA9IGRlbHRhU2Vjb25kczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAicmVmcmVzaGVyIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJlZnJlc2hlciIsIGRlc2NyaXB0aW9uOiAiXCJyZWZyZXNoZXJcIiIgfSwKICAgICAgICAgICJ1YXMiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidWFzIiwgZGVzY3JpcHRpb246ICJcInVhc1wiIiB9LAogICAgICAgICAgInVhYyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ1YWMiLCBkZXNjcmlwdGlvbjogIlwidWFjXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihlbmRwb2ludCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXJ0UnVsZSA9PT0gJ1Nlc3Npb25fRXhwaXJlcycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5yZWZyZXNoZXIgPSBlbmRwb2ludDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICBmdW5jdGlvbihkZWx0YVNlY29uZHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5zdGFydFJ1bGUgPT09ICdNaW5fU0UnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBkZWx0YVNlY29uZHM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgInN0dW5zIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInN0dW5zIiwgZGVzY3JpcHRpb246ICJcInN0dW5zXCIiIH0sCiAgICAgICAgICAic3R1biIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJzdHVuIiwgZGVzY3JpcHRpb246ICJcInN0dW5cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHNjaGVtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5zY2hlbWUgPSBzY2hlbWU7IH0sCiAgICAgICAgICBmdW5jdGlvbihob3N0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLmhvc3QgPSBob3N0OyB9LAogICAgICAgICAgIj90cmFuc3BvcnQ9IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIj90cmFuc3BvcnQ9IiwgZGVzY3JpcHRpb246ICJcIj90cmFuc3BvcnQ9XCIiIH0sCiAgICAgICAgICAidHVybnMiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidHVybnMiLCBkZXNjcmlwdGlvbjogIlwidHVybnNcIiIgfSwKICAgICAgICAgICJ0dXJuIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInR1cm4iLCBkZXNjcmlwdGlvbjogIlwidHVyblwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnRyYW5zcG9ydCA9IHRyYW5zcG9ydDsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gdGV4dCgpOyB9CiAgICAgICAgXSwKCiAgICAgICAgcGVnJGJ5dGVjb2RlID0gWwogICAgICAgICAgcGVnJGRlY29kZSgiLiBcIlwiMiAzISIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMFwiXCJcIjEhMyMiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjAkXCJcIjEhMyUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjAmXCJcIjEhMyciKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjcnKiMgXCI3KCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMChcIlwiMSEzKSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMCpcIlwiMSEzKyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLixcIlwiMiwzLSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLi5cIlwiMi4zLyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMDBcIlwiMSEzMSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLjJcIlwiMjIzMypceDg5IFwiLjRcIlwiMjQzNSp9IFwiLjZcIlwiMjYzNypxIFwiLjhcIlwiMjgzOSplIFwiLjpcIlwiMjozOypZIFwiLjxcIlwiMjwzPSpNIFwiLj5cIlwiMj4zPypBIFwiLkBcIlwiMkAzQSo1IFwiLkJcIlwiMkIzQyopIFwiLkRcIlwiMkQzRSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiNykqIyBcIjcsIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIuRlwiXCIyRjNHKn0gXCIuSFwiXCIySDNJKnEgXCIuSlwiXCIySjNLKmUgXCIuTFwiXCIyTDNNKlkgXCIuTlwiXCIyTjNPKk0gXCIuUFwiXCIyUDNRKkEgXCIuUlwiXCIyUjNTKjUgXCIuVFwiXCIyVDNVKikgXCIuVlwiXCIyVjNXIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIS5ZXCJcIjJZM1orNyQ3IystJTcjKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCshICglIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhISBcXDckLCMmNyRcIistJDcgKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytAJCBcXDckKyYkLCMmNyRcIlwiXCIgWCsnJTRcIjZdXCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3LiojIFwiIFsiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3JyojIFwiNygsKSY3JyojIFwiNyhcIitBJC44XCJcIjI4MzkrMSU3LysnJTQjNl4jICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhISBcXDcyKyYkLCMmNzJcIlwiXCIgWCtvJCBcXCEgXFw3LiwjJjcuXCIrLSQ3MisjJSdcIiUkXCIjIFhcIiMgWCxAJiEgXFw3LiwjJjcuXCIrLSQ3MisjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJ1wiJSRcIiMgWFwiIyBYKyEgKCUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjBfXCJcIjEhM2AqIyBcIjczIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIwYVwiXCIxITNiIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIwY1wiXCIxITNkIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3ISopIFwiMGVcIlwiMSEzZiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDcpKlx4OTUgXCIuRlwiXCIyRjNHKlx4ODkgXCIuSlwiXCIySjNLKn0gXCIuTFwiXCIyTDNNKnEgXCIuWVwiXCIyWTNaKmUgXCIuUFwiXCIyUDNRKlkgXCIuSFwiXCIySDNJKk0gXCIuQFwiXCIyQDNBKkEgXCIuZ1wiXCIyZzNoKjUgXCIuUlwiXCIyUjNTKikgXCIuTlwiXCIyTjNPK1x4OUUkLFx4OUImNykqXHg5NSBcIi5GXCJcIjJGM0cqXHg4OSBcIi5KXCJcIjJKM0sqfSBcIi5MXCJcIjJMM00qcSBcIi5ZXCJcIjJZM1oqZSBcIi5QXCJcIjJQM1EqWSBcIi5IXCJcIjJIM0kqTSBcIi5AXCJcIjJAM0EqQSBcIi5nXCJcIjJnM2gqNSBcIi5SXCJcIjJSM1MqKSBcIi5OXCJcIjJOM09cIlwiXCIgWCshICglIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNykqXHg4OSBcIi5GXCJcIjJGM0cqfSBcIi5MXCJcIjJMM00qcSBcIi5ZXCJcIjJZM1oqZSBcIi5QXCJcIjJQM1EqWSBcIi5IXCJcIjJIM0kqTSBcIi5AXCJcIjJAM0EqQSBcIi5nXCJcIjJnM2gqNSBcIi5SXCJcIjJSM1MqKSBcIi5OXCJcIjJOM08rXHg5MiQsXHg4RiY3KSpceDg5IFwiLkZcIlwiMkYzRyp9IFwiLkxcIlwiMkwzTSpxIFwiLllcIlwiMlkzWiplIFwiLlBcIlwiMlAzUSpZIFwiLkhcIlwiMkgzSSpNIFwiLkBcIlwiMkAzQSpBIFwiLmdcIlwiMmczaCo1IFwiLlJcIlwiMlIzUyopIFwiLk5cIlwiMk4zT1wiXCJcIiBYKyEgKCUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5UXCJcIjJUM1UqXHhFMyBcIi5WXCJcIjJWM1cqXHhENyBcIi5pXCJcIjJpM2oqXHhDQiBcIi5rXCJcIjJrM2wqXHhCRiBcIi46XCJcIjI6MzsqXHhCMyBcIi5EXCJcIjJEM0UqXHhBNyBcIi4yXCJcIjIyMzMqXHg5QiBcIi44XCJcIjI4MzkqXHg4RiBcIi5tXCJcIjJtM24qXHg4MyBcIjcmKn0gXCIuNFwiXCIyNDM1KnEgXCIub1wiXCIybzNwKmUgXCIucVwiXCIycTNyKlkgXCIuNlwiXCIyNjM3Kk0gXCIuPlwiXCIyPjM/KkEgXCIuc1wiXCIyczN0KjUgXCIudVwiXCIydTN2KikgXCI3JyojIFwiNygiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3KSpcdTAxMkIgXCIuRlwiXCIyRjNHKlx1MDExRiBcIi5KXCJcIjJKM0sqXHUwMTEzIFwiLkxcIlwiMkwzTSpcdTAxMDcgXCIuWVwiXCIyWTNaKlx4RkIgXCIuUFwiXCIyUDNRKlx4RUYgXCIuSFwiXCIySDNJKlx4RTMgXCIuQFwiXCIyQDNBKlx4RDcgXCIuZ1wiXCIyZzNoKlx4Q0IgXCIuUlwiXCIyUjNTKlx4QkYgXCIuTlwiXCIyTjNPKlx4QjMgXCIuVFwiXCIyVDNVKlx4QTcgXCIuVlwiXCIyVjNXKlx4OUIgXCIuaVwiXCIyaTNqKlx4OEYgXCIua1wiXCIyazNsKlx4ODMgXCIuOFwiXCIyODM5KncgXCIubVwiXCIybTNuKmsgXCI3JiplIFwiLjRcIlwiMjQzNSpZIFwiLm9cIlwiMm8zcCpNIFwiLnFcIlwiMnEzcipBIFwiLjZcIlwiMjYzNyo1IFwiLnNcIlwiMnMzdCopIFwiLnVcIlwiMnUzditcdTAxMzQkLFx1MDEzMSY3KSpcdTAxMkIgXCIuRlwiXCIyRjNHKlx1MDExRiBcIi5KXCJcIjJKM0sqXHUwMTEzIFwiLkxcIlwiMkwzTSpcdTAxMDcgXCIuWVwiXCIyWTNaKlx4RkIgXCIuUFwiXCIyUDNRKlx4RUYgXCIuSFwiXCIySDNJKlx4RTMgXCIuQFwiXCIyQDNBKlx4RDcgXCIuZ1wiXCIyZzNoKlx4Q0IgXCIuUlwiXCIyUjNTKlx4QkYgXCIuTlwiXCIyTjNPKlx4QjMgXCIuVFwiXCIyVDNVKlx4QTcgXCIuVlwiXCIyVjNXKlx4OUIgXCIuaVwiXCIyaTNqKlx4OEYgXCIua1wiXCIyazNsKlx4ODMgXCIuOFwiXCIyODM5KncgXCIubVwiXCIybTNuKmsgXCI3JiplIFwiLjRcIlwiMjQzNSpZIFwiLm9cIlwiMm8zcCpNIFwiLnFcIlwiMnEzcipBIFwiLjZcIlwiMjYzNyo1IFwiLnNcIlwiMnMzdCopIFwiLnVcIlwiMnUzdlwiXCJcIiBYKyEgKCUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LytBJC5QXCJcIjJQM1ErMSU3LysnJTQjNncjICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rQSQuNFwiXCIyNDM1KzElNy8rJyU0IzZ4IyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITcvK0EkLj5cIlwiMj4zPysxJTcvKyclNCM2eSMgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LytBJC5UXCJcIjJUM1UrMSU3LysnJTQjNnojICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rQSQuVlwiXCIyVjNXKzElNy8rJyU0IzZ7IyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS5rXCJcIjJrM2wrMSQ3LysnJTRcIjZ8XCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rNyQuaVwiXCIyaTNqKyclNFwiNn1cIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LytBJC5EXCJcIjJEM0UrMSU3LysnJTQjNn4jICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rQSQuMlwiXCIyMjMzKzElNy8rJyU0IzZ/IyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITcvK0EkLjhcIlwiMjgzOSsxJTcvKyclNCM2XHg4MCMgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LysxJDcmKyclNFwiNlx4ODFcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3JisxJDcvKyclNFwiNlx4ODFcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3PStXJCBcXDdHKikgXCI3SyojIFwiN0YsLyY3RyopIFwiN0sqIyBcIjdGXCIrLSU3PisjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjBceDgyXCJcIjEhM1x4ODMqQSBcIjBceDg0XCJcIjEhM1x4ODUqNSBcIjBceDg2XCJcIjEhM1x4ODcqKSBcIjczKiMgXCI3LiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3LytVJDcmK0slIFxcN0oqIyBcIjdLLCkmN0oqIyBcIjdLXCIrLSU3JisjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCshICglIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rYCQ3JitWJSEgXFw3SiojIFwiN0ssKSY3SiojIFwiN0tcIishICglKzIlNyYrKCU0JDZceDg4JCEhJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiNy4qRyBcIi5MXCJcIjJMM00qOyBcIjBceDg5XCJcIjEhM1x4OEEqLyBcIjBceDg2XCJcIjEhM1x4ODcqIyBcIjczIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhLm1cIlwiMm0zbitLJDBceDhCXCJcIjEhM1x4OEMqNSBcIjBceDhEXCJcIjEhM1x4OEUqKSBcIjBceDhGXCJcIjEhM1x4OTArIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3TitRJC44XCJcIjI4MzkrQSU3TyojIFwiIFsrMSU3UysnJTQkNlx4OTEkICUkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3TitrJC44XCJcIjI4MzkrWyU3TyojIFwiIFsrSyU3UytBJTdfKzclN2wqIyBcIiBbKyclNCY2XHg5MiYgJSQmIyBYJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHg5M1wiXCIxJDNceDk0KikgXCIvXHg5NVwiXCIxIzNceDk2KycgNCE2XHg5NyEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3UCtiJCEuOFwiXCIyODM5Ky0kN1IrIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKzclLjpcIlwiMjozOysnJTQjNlx4OTgjICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3KyopIFwiNy0qIyBcIjdRKzIkLC8mNysqKSBcIjctKiMgXCI3UVwiXCJcIiBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIuPFwiXCIyPDM9KnEgXCIuPlwiXCIyPjM/KmUgXCIuQFwiXCIyQDNBKlkgXCIuQlwiXCIyQjNDKk0gXCIuRFwiXCIyRDNFKkEgXCIuMlwiXCIyMjMzKjUgXCIuNlwiXCIyNjM3KikgXCIuNFwiXCIyNDM1IiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNysqXyBcIjctKlkgXCIuPFwiXCIyPDM9Kk0gXCIuPlwiXCIyPjM/KkEgXCIuQFwiXCIyQDNBKjUgXCIuQlwiXCIyQjNDKikgXCIuRFwiXCIyRDNFLGUmNysqXyBcIjctKlkgXCIuPFwiXCIyPDM9Kk0gXCIuPlwiXCIyPjM/KkEgXCIuQFwiXCIyQDNBKjUgXCIuQlwiXCIyQjNDKikgXCIuRFwiXCIyRDNFXCIrJiA0ITZceDk5ISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1QrTiQhLjhcIlwiMjgzOSstJDdeKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWysjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdVKikgXCI3XFwqIyBcIjdYKyYgNCE2XHg5QSEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXCE3ViszJC5KXCJcIjJKM0srIyUnXCIlJFwiIyBYXCIjIFgsPiYhN1YrMyQuSlwiXCIySjNLKyMlJ1wiJSRcIiMgWFwiIyBYXCIrRyQ3Vys9JS5KXCJcIjJKM0sqIyBcIiBbKyclNCM2XHg5QiMgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiBcXDBceDlDXCJcIjEhM1x4OUQrLCQsKSYwXHg5Q1wiXCIxITNceDlEXCJcIlwiIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEwJFwiXCIxITMlK0EkIFxcMFx4OUVcIlwiMSEzXHg5RiwpJjBceDlFXCJcIjEhM1x4OUZcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS5vXCJcIjJvM3ArQSQ3WSs3JS5xXCJcIjJxM3IrJyU0IzZceEEwIyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3WitceEJGJC44XCJcIjI4MzkrXHhBRiU3WitceEE1JS44XCJcIjI4MzkrXHg5NSU3WitceDhCJS44XCJcIjI4MzkreyU3WitxJS44XCJcIjI4MzkrYSU3WitXJS44XCJcIjI4MzkrRyU3Wis9JS44XCJcIjI4MzkrLSU3WysjJSctJSQtIyBYJCwjIFgkKyMgWCQqIyBYJCkjIFgkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA4MzggXCIhLlx4QTFcIlwiMlx4QTEzXHhBMitceEFGJDdaK1x4QTUlLjhcIlwiMjgzOStceDk1JTdaK1x4OEIlLjhcIlwiMjgzOSt7JTdaK3ElLjhcIlwiMjgzOSthJTdaK1clLjhcIlwiMjgzOStHJTdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJywlJCwjIFgkKyMgWCQqIyBYJCkjIFgkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA3OTUgXCIhLlx4QTFcIlwiMlx4QTEzXHhBMitceDk1JDdaK1x4OEIlLjhcIlwiMjgzOSt7JTdaK3ElLjhcIlwiMjgzOSthJTdaK1clLjhcIlwiMjgzOStHJTdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJyolJCojIFgkKSMgWCQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDcwQyBcIiEuXHhBMVwiXCIyXHhBMTNceEEyK3skN1orcSUuOFwiXCIyODM5K2ElN1orVyUuOFwiXCIyODM5K0clN1orPSUuOFwiXCIyODM5Ky0lN1srIyUnKCUkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA2OUQgXCIhLlx4QTFcIlwiMlx4QTEzXHhBMithJDdaK1clLjhcIlwiMjgzOStHJTdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJyYlJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA2NDggXCIhLlx4QTFcIlwiMlx4QTEzXHhBMitHJDdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJyQlJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDYwRCBcIiEuXHhBMVwiXCIyXHhBMTNceEEyKy0kN1srIyUnXCIlJFwiIyBYXCIjIFgqXHUwNUVDIFwiIS5ceEExXCJcIjJceEExM1x4QTIrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCpcdTA1Q0IgXCIhN1orXHhBNSQuXHhBMVwiXCIyXHhBMTNceEEyK1x4OTUlN1orXHg4QiUuOFwiXCIyODM5K3slN1orcSUuOFwiXCIyODM5K2ElN1orVyUuOFwiXCIyODM5K0clN1orPSUuOFwiXCIyODM5Ky0lN1srIyUnKyUkKyMgWCQqIyBYJCkjIFgkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA1MzggXCIhN1orXHhCNiQhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceDhCJS5ceEExXCJcIjJceEExM1x4QTIreyU3WitxJS44XCJcIjI4MzkrYSU3WitXJS44XCJcIjI4MzkrRyU3Wis9JS44XCJcIjI4MzkrLSU3WysjJScqJSQqIyBYJCkjIFgkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA0OTQgXCIhN1orXHhDNyQhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceDlDJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK3ElLlx4QTFcIlwiMlx4QTEzXHhBMithJTdaK1clLjhcIlwiMjgzOStHJTdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJyklJCkjIFgkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTAzREYgXCIhN1orXHhEOCQhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceEFEJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4ODIlIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrVyUuXHhBMVwiXCIyXHhBMTNceEEyK0clN1orPSUuOFwiXCIyODM5Ky0lN1srIyUnKCUkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTAzMTkgXCIhN1orXHhFOSQhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceEJFJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4OTMlIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsraCUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWys9JS5ceEExXCJcIjJceEExM1x4QTIrLSU3WysjJScnJSQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTAyNDIgXCIhN1orXHUwMTE0JCEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4RTklIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrXHhCRSUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceDkzJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK2glIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrPSUuXHhBMVwiXCIyXHhBMTNceEEyKy0lN1orIyUnKCUkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTAxNDAgXCIhN1orXHUwMTM1JCEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x1MDEwQSUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceERGJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4QjQlIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrXHg4OSUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWyteJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKzMlLlx4QTFcIlwiMlx4QTEzXHhBMisjJScoJSQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKyYgNCE2XHhBMyEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITcjK1MkNyMqIyBcIiBbK0MlNyMqIyBcIiBbKzMlNyMqIyBcIiBbKyMlJyQlJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1orPSQuOFwiXCIyODM5Ky0lN1orIyUnIyUkIyMgWCRcIiMgWFwiIyBYKiMgXCI3XFwiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XSt1JC5KXCJcIjJKM0srZSU3XStbJS5KXCJcIjJKM0srSyU3XStBJS5KXCJcIjJKM0srMSU3XSsnJTQnNlx4QTQnICUkJyMgWCQmIyBYJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEuXHhBNVwiXCIyXHhBNTNceEE2KzMkMFx4QTdcIlwiMSEzXHhBOCsjJSdcIiUkXCIjIFhcIiMgWCpceEEwIFwiIS5ceEE5XCJcIjJceEE5M1x4QUErPSQwXHhBQlwiXCIxITNceEFDKy0lNyErIyUnIyUkIyMgWCRcIiMgWFwiIyBYKm8gXCIhLlx4QURcIlwiMlx4QUQzXHhBRSs3JDchKy0lNyErIyUnIyUkIyMgWCRcIiMgWFwiIyBYKkQgXCIhMFx4QUZcIlwiMSEzXHhCMCstJDchKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCI3ISIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3ISojIFwiIFsrYyQ3ISojIFwiIFsrUyU3ISojIFwiIFsrQyU3ISojIFwiIFsrMyU3ISojIFwiIFsrIyUnJSUkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCsnIDQhNlx4QjEhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFwhLjJcIlwiMjIzMystJDdgKyMlJ1wiJSRcIiMgWFwiIyBYLD4mIS4yXCJcIjIyMzMrLSQ3YCsjJSdcIiUkXCIjIFhcIiMgWFwiIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3YSpBIFwiN2IqOyBcIjdjKjUgXCI3ZCovIFwiN2UqKSBcIjdmKiMgXCI3ZyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceEIyXCJcIjEqM1x4QjMrYiQvXHhCNFwiXCIxIzNceEI1KkcgXCIvXHhCNlwiXCIxIzNceEI3KjsgXCIvXHhCOFwiXCIxJDNceEI5Ki8gXCIvXHhCQVwiXCIxIzNceEJCKiMgXCI3NisoJTRcIjZceEJDXCIhICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceEJEXCJcIjElM1x4QkUrSiQvXHhCRlwiXCIxJTNceEMwKi8gXCIvXHhDMVwiXCIxXCIzXHhDMiojIFwiNzYrKCU0XCI2XHhDM1wiISAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhDNFwiXCIxJzNceEM1KzIkN1x4OEYrKCU0XCI2XHhDNlwiISAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhDN1wiXCIxJDNceEM4KzIkN1x4RUYrKCU0XCI2XHhDOVwiISAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhDQVwiXCIxJjNceENCKzIkN1QrKCU0XCI2XHhDQ1wiISAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhDRFwiXCIxXCIzXHhDRStSJCEuPlwiXCIyPjM/Ky0kNzYrIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKyclNFwiNlx4Q0ZcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3aCtUJCEuPlwiXCIyPjM/Ky0kN2krIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKyklNFwiNlx4RDBcIlwiISAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3aismJCwjJjdqXCJcIlwiIFgrISAoJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDdqKyYkLCMmN2pcIlwiXCIgWCshICglIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3ayopIFwiNysqIyBcIjctIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIub1wiXCIybzNwKmUgXCIucVwiXCIycTNyKlkgXCIuNFwiXCIyNDM1Kk0gXCIuOFwiXCIyODM5KkEgXCIuPFwiXCIyPDM9KjUgXCIuQFwiXCIyQDNBKikgXCIuQlwiXCIyQjNDIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhLjZcIlwiMjYzNyt1JDdtK2slIFxcIS48XCJcIjI8Mz0rLSQ3bSsjJSdcIiUkXCIjIFhcIiMgWCw+JiEuPFwiXCIyPDM9Ky0kN20rIyUnXCIlJFwiIyBYXCIjIFhcIisjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3bitDJC4+XCJcIjI+Mz8rMyU3byspJTQjNlx4RDEjXCJcIiAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIFxcN3AqKSBcIjcrKiMgXCI3LSsyJCwvJjdwKikgXCI3KyojIFwiNy1cIlwiXCIgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIFxcN3AqKSBcIjcrKiMgXCI3LSwvJjdwKikgXCI3KyojIFwiNy1cIiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLm9cIlwiMm8zcCplIFwiLnFcIlwiMnEzcipZIFwiLjRcIlwiMjQzNSpNIFwiLjZcIlwiMjYzNypBIFwiLjhcIlwiMjgzOSo1IFwiLkBcIlwiMkAzQSopIFwiLkJcIlwiMkIzQyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4OTAqIyBcIjdyIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4OEYrSyQ3JytBJTdzKzclNycrLSU3XHg4NCsjJSclJSQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3TSojIFwiN3QiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3fytHJC44XCJcIjI4MzkrNyU3dSojIFwiN3grJyU0IzZceEQyIyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITd2KiMgXCI3dytOJCEuNlwiXCIyNjM3Ky0kN1x4ODMrIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhLlx4RDNcIlwiMlx4RDMzXHhENCs9JDdceDgwKzMlN3cqIyBcIiBbKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS40XCJcIjI0MzUrLSQ3eysjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITd6KzUkIFxcN3ksIyY3eVwiKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3KiopIFwiNysqIyBcIjctIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3KypceDhGIFwiNy0qXHg4OSBcIi4yXCJcIjIyMzMqfSBcIi42XCJcIjI2MzcqcSBcIi44XCJcIjI4MzkqZSBcIi46XCJcIjI6MzsqWSBcIi48XCJcIjI8Mz0qTSBcIi4+XCJcIjI+Mz8qQSBcIi5AXCJcIjJAM0EqNSBcIi5CXCJcIjJCM0MqKSBcIi5EXCJcIjJEM0UiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3fCtrJCBcXCEuNFwiXCIyNDM1Ky0kN3wrIyUnXCIlJFwiIyBYXCIjIFgsPiYhLjRcIlwiMjQzNSstJDd8KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3fiwjJjd+XCIrayQgXFwhLjJcIlwiMjIzMystJDd9KyMlJ1wiJSRcIiMgWFwiIyBYLD4mIS4yXCJcIjIyMzMrLSQ3fSsjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3fiwjJjd+XCIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjcrKncgXCI3LSpxIFwiLjhcIlwiMjgzOSplIFwiLjpcIlwiMjozOypZIFwiLjxcIlwiMjwzPSpNIFwiLj5cIlwiMj4zPypBIFwiLkBcIlwiMkAzQSo1IFwiLkJcIlwiMkIzQyopIFwiLkRcIlwiMkQzRSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdcIitceDhEJCBcXDdcIipHIFwiNyEqQSBcIi5AXCJcIjJAM0EqNSBcIi5GXCJcIjJGM0cqKSBcIi5KXCJcIjJKM0ssTSY3XCIqRyBcIjchKkEgXCIuQFwiXCIyQDNBKjUgXCIuRlwiXCIyRjNHKikgXCIuSlwiXCIySjNLXCIrJyU0XCI2XHhENVwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4ODEqIyBcIjdceDgyIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhITdPKzMkLjpcIlwiMjozOysjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrLSQ3UysjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiBcXDcrKlx4ODMgXCI3LSp9IFwiLkJcIlwiMkIzQypxIFwiLkRcIlwiMkQzRSplIFwiLjJcIlwiMjIzMypZIFwiLjhcIlwiMjgzOSpNIFwiLjpcIlwiMjozOypBIFwiLjxcIlwiMjwzPSo1IFwiLj5cIlwiMj4zPyopIFwiLkBcIlwiMkAzQStceDhDJCxceDg5JjcrKlx4ODMgXCI3LSp9IFwiLkJcIlwiMkIzQypxIFwiLkRcIlwiMkQzRSplIFwiLjJcIlwiMjIzMypZIFwiLjhcIlwiMjgzOSpNIFwiLjpcIlwiMjozOypBIFwiLjxcIlwiMjwzPSo1IFwiLj5cIlwiMj4zPyopIFwiLkBcIlwiMkAzQVwiXCJcIiBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3eSwjJjd5XCIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHg5NVwiXCIxIzNceEQ2K3kkLjRcIlwiMjQzNStpJSBcXDchKyYkLCMmNyFcIlwiXCIgWCtQJS5KXCJcIjJKM0srQCUgXFw3ISsmJCwjJjchXCJcIlwiIFgrJyU0JTZceEQ3JSAlJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEQ4XCJcIjJceEQ4M1x4RDkiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceERBXCJcIjJceERBM1x4REIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceERDXCJcIjJceERDM1x4REQiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceERFXCJcIjJceERFM1x4REYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEUwXCJcIjJceEUwM1x4RTEiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEUyXCJcIjJceEUyM1x4RTMiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEU0XCJcIjJceEU0M1x4RTUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEU2XCJcIjJceEU2M1x4RTciKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEU4XCJcIjJceEU4M1x4RTkiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEVBXCJcIjJceEVBM1x4RUIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg4NSpTIFwiN1x4ODYqTSBcIjdceDg4KkcgXCI3XHg4OSpBIFwiN1x4OEEqOyBcIjdceDhCKjUgXCI3XHg4QyovIFwiN1x4OEQqKSBcIjdceDhFKiMgXCI3NismIDQhNlx4RUMhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg4NCtLJDcnK0ElN1x4OTErNyU3JystJTdceDkzKyMlJyUlJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg5MisnIDQhNlx4RUQhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNyErNyQ3ISstJTchKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDcqKkEgXCI3Kyo7IFwiNy0qNSBcIjczKi8gXCI3NCopIFwiNycqIyBcIjcoLEcmNyoqQSBcIjcrKjsgXCI3LSo1IFwiNzMqLyBcIjc0KikgXCI3JyojIFwiNyhcIismIDQhNlx4RUUhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhCNStfJCBcXCE3QSstJDdceEI1KyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdBKy0kN1x4QjUrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc5K1IkIS46XCJcIjI6MzsrLSQ3OSsjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrJyU0XCI2XHhFRlwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc6KmogXCIhN1x4OTcrXyQgXFwhN0ErLSQ3XHg5NysjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QSstJDdceDk3KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgrJiA0ITZceEYwISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN0wqIyBcIjdceDk4K2MkIFxcITdCKy0kN1x4OUErIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHg5QSsjJSdcIiUkXCIjIFhcIiMgWFwiKyclNFwiNlx4RjFcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg5OSojIFwiIFsrQSQ3QCs3JTdNKy0lNz8rIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEhNzYrXyQgXFwhNy4rLSQ3NisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3ListJDc2KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgqIyBcIjdIKycgNCE2XHhGMiEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceDlCKikgXCI3XHg5QyojIFwiN1x4OUYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhGM1wiXCIxITNceEY0KzwkNzwrMiU3XHg5RSsoJTQjNlx4RjUjISAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceEY2XCJcIjEnM1x4RjcrPCQ3PCsyJTdceDlEKyglNCM2XHhGOCMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNyErJiQsIyY3IVwiXCJcIiBYKycgNCE2XHhGOSEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEuXHhGQVwiXCIyXHhGQTNceEZCK3gkIS5KXCJcIjJKM0srUyQ3ISojIFwiIFsrQyU3ISojIFwiIFsrMyU3ISojIFwiIFsrIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgqIyBcIiBbKyclNFwiNlx4RkNcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3NitOJCE3PCstJDdceEEwKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWyspJTRcIjZceEZEXCJcIiEgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3NiopIFwiN1QqIyBcIjdIIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4QTIrXyQgXFwhN0IrLSQ3XHhBMysjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceEEzKyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhGRVwiXCIxJjNceEZGKkcgXCIvXHUwMTAwXCJcIjEnM1x1MDEwMSo7IFwiL1x1MDEwMlwiXCIxJDNcdTAxMDMqLyBcIi9cdTAxMDRcIlwiMSUzXHUwMTA1KiMgXCI3NismIDQhNlx1MDEwNiEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4QTQqIyBcIjdceDlGIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDEwN1wiXCIxKDNcdTAxMDgrTyQ3PCtFJS9cdTAxMDlcIlwiMSgzXHUwMTBBKi8gXCIvXHUwMTBCXCJcIjEoM1x1MDEwQyojIFwiNzYrIyUnIyUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNzYrXyQgXFwhN0ErLSQ3NisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QSstJDc2KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3ISsmJCwjJjchXCJcIlwiIFgrJyA0ITZcdTAxMEQhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4QTgrJiA0ITZcdTAxMEUhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhBOStzJDc7K2klN1x4QUUrXyUgXFwhN0IrLSQ3XHhBRisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceEFGKyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceEFBKiMgXCI3XHhBQiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiL1x1MDEwRlwiXCIxJDNcdTAxMTAqUyBcIi9cdTAxMTFcIlwiMSUzXHUwMTEyKkcgXCIvXHUwMTEzXCJcIjElM1x1MDExNCo7IFwiL1x1MDExNVwiXCIxJTNcdTAxMTYqLyBcIi9cdTAxMTdcIlwiMSszXHUwMTE4KiMgXCI3XHhBQyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiL1x1MDExOVwiXCIxJzNcdTAxMUEqLyBcIi9cdTAxMUJcIlwiMSkzXHUwMTFDKiMgXCI3XHhBQyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiNzYqIyBcIjdceEFEIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDExRFwiXCIxXCIzXHUwMTFFKy0kNzYrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceEFDKiMgXCI3NiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc2KzckNzwrLSU3XHhCMCsjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjc2KiMgXCI3SCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEIyKzckNy4rLSU3XHg4RisjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3ISsmJCwjJjchXCJcIlwiIFgrJyA0ITZcdTAxMUYhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4OUQrJyA0ITZcdTAxMjAhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4QjUrZCQgXFwhN0IrLSQ3XHg5RisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceDlGKyMlJ1wiJSRcIiMgWFwiIyBYXCIrKCU0XCI2XHUwMTIxXCIhISUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3NytrJCBcXCEuSlwiXCIySjNLKy0kNzcrIyUnXCIlJFwiIyBYXCIjIFgsPiYhLkpcIlwiMkozSystJDc3KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgrISAoJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdMKiMgXCI3XHg5OCtjJCBcXCE3QistJDdceEI3KyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4QjcrIyUnXCIlJFwiIyBYXCIjIFhcIisnJTRcIjZcdTAxMjJcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceEI4KiMgXCI3XHg5RiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxMjNcIlwiMSMzXHUwMTI0KzwkNzwrMiU3NisoJTQjNlx1MDEyNSMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNyErJiQsIyY3IVwiXCJcIiBYKycgNCE2XHUwMTI2ISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDlEKycgNCE2XHUwMTI3ISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDdceDk5LCMmN1x4OTlcIitceDgxJDdAK3clN00rbSU3PytjJSBcXCE3QistJDdceDlGKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFhcIisnJTQlNlx1MDEyOCUgJSQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XHhCRCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxMjlcIlwiMSYzXHUwMTJBK3MkNy4raSU3XHhDMCtfJSBcXCE3QSstJDdceEMwKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdBKy0kN1x4QzArIyUnXCIlJFwiIyBYXCIjIFhcIisjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCojIFwiN1x4QkUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3NitzJDcuK2klN1x4QkYrXyUgXFwhN0ErLSQ3XHhCRisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QSstJDdceEJGKyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3Nis9JDc8KzMlNzYqIyBcIjdIKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4QzEqRyBcIjdceEMzKkEgXCI3XHhDNSo7IFwiN1x4QzcqNSBcIjdceEM4Ki8gXCI3XHhDOSopIFwiN1x4Q0EqIyBcIjdceEJGIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDEyQlwiXCIxJTNcdTAxMkMrNyQ3PCstJTdceEMyKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdJKycgNCE2XHUwMTJEISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxMkVcIlwiMSYzXHUwMTJGK1x4QTUkNzwrXHg5QiU3RCtceDkxJTdceEM0K1x4ODclIFxcISBcXDcnKyYkLCMmNydcIlwiXCIgWCstJDdceEM0KyMlJ1wiJSRcIiMgWFwiIyBYLEcmISBcXDcnKyYkLCMmNydcIlwiXCIgWCstJDdceEM0KyMlJ1wiJSRcIiMgWFwiIyBYXCIrLSU3RSsjJScmJSQmIyBYJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjd0KiMgXCI3dyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxMzBcIlwiMSUzXHUwMTMxKzckNzwrLSU3XHhDNisjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3SSsnIDQhNlx1MDEzMiEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTMzXCJcIjEmM1x1MDEzNCs8JDc8KzIlN0krKCU0IzZcdTAxMzUjISAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxMzZcIlwiMSUzXHUwMTM3K18kNzwrVSUhL1x1MDEzOFwiXCIxJDNcdTAxMzkrJiA0ITZcdTAxM0EhICUqNCBcIiEvXHUwMTNCXCJcIjElM1x1MDEzQysmIDQhNlx1MDEzRCEgJSsjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTNFXCJcIjEpM1x1MDEzRitUJDc8K0olL1x1MDE0MFwiXCIxIzNcdTAxNDEqLyBcIi9cdTAxNDJcIlwiMSgzXHUwMTQzKiMgXCI3NisoJTQjNlx1MDE0NCMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDE0NVwiXCIxIzNcdTAxNDYrXHg5RSQ3PCtceDk0JTdEK1x4OEElITdceENCK2skIFxcIS5EXCJcIjJEM0UrLSQ3XHhDQisjJSdcIiUkXCIjIFhcIiMgWCw+JiEuRFwiXCIyRDNFKy0kN1x4Q0IrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCstJTdFKyMlJyUlJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTQ3XCJcIjEoM1x1MDE0OCovIFwiL1x1MDE0OVwiXCIxJDNcdTAxNEEqIyBcIjc2KycgNCE2XHUwMTRCISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc2K18kIFxcITdBKy0kNzYrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0ErLSQ3NisjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4Q0UrSyQ3LitBJTdceENFKzclNy4rLSU3XHg4RisjJSclJSQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNyErJiQsIyY3IVwiXCJcIiBYKycgNCE2XHUwMTRDISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEQwK2MkIFxcITdBKy0kN1x4RDArIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0ErLSQ3XHhEMCsjJSdcIiUkXCIjIFhcIiMgWFwiKyclNFwiNlx1MDE0RFwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDk4K2MkIFxcITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHg5RisjJSdcIiUkXCIjIFhcIiMgWFwiKyclNFwiNlx1MDE0RVwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdMKlQgXCI3XHg5OCpOIFwiITdAKiMgXCIgWys9JDd0KzMlNz8qIyBcIiBbKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCtjJCBcXCE3QistJDdceDlGKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFhcIisnJTRcIjZcdTAxNEZcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhEMytjJCBcXCE3QistJDdceEQ0KyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4RDQrIyUnXCIlJFwiIyBYXCIjIFhcIisnJTRcIjZcdTAxNTBcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg5NSsmIDQhNlx1MDE1MSEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxNTJcIlwiMSgzXHUwMTUzKzwkNzwrMiU3NisoJTQjNlx1MDE1NCMhICUkIyMgWCRcIiMgWFwiIyBYKmogXCIhL1x1MDE1NVwiXCIxJjNcdTAxNTYrPCQ3PCsyJTc2KyglNCM2XHUwMTU3IyEgJSQjIyBYJFwiIyBYXCIjIFgqOiBcIiEvXHUwMTU4XCJcIjEqM1x1MDE1OSsmIDQhNlx1MDE1QSEgJSojIFwiN1x4OUYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEhNzYrbyQgXFwhN0ErMiQ3NisoJTRcIjZcdTAxNUJcIiEgJSRcIiMgWFwiIyBYLD0mITdBKzIkNzYrKCU0XCI2XHUwMTVCXCIhICUkXCIjIFhcIiMgWFwiKyklNFwiNlx1MDE1Q1wiXCIhICUkXCIjIFhcIiMgWCojIFwiIFsrJyA0ITZcdTAxNUQhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4RDcrXyQgXFwhN0ErLSQ3XHhENysjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QSstJDdceEQ3KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg5OCtfJCBcXCE3QistJDdceDlGKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDchKyYkLCMmNyFcIlwiXCIgWCsnIDQhNlx1MDE1RSEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhEQStfJCBcXCE3QistJDdceERCKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4REIrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxNUZcIlwiMSYzXHUwMTYwKjsgXCIvXHUwMTYxXCJcIjEnM1x1MDE2MiovIFwiL1x1MDE2M1wiXCIxKjNcdTAxNjQqIyBcIjc2KyYgNCE2XHUwMTY1ISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDE2NlwiXCIxJjNcdTAxNjcrPCQ3PCsyJTdceERDKyglNCM2XHUwMTY4IyEgJSQjIyBYJFwiIyBYXCIjIFgqXHg4MyBcIiEvXHhGNlwiXCIxJzNceEY3KzwkNzwrMiU3XHg5RCsoJTQjNlx1MDE2OSMhICUkIyMgWCRcIiMgWFwiIyBYKlMgXCIhL1x1MDE2QVwiXCIxKzNcdTAxNkIrPCQ3PCsyJTdceDlEKyglNCM2XHUwMTZDIyEgJSQjIyBYJFwiIyBYXCIjIFgqIyBcIjdceDlGIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIvXHUwMTZEXCJcIjErM1x1MDE2RSprIFwiL1x1MDE2RlwiXCIxKTNcdTAxNzAqXyBcIi9cdTAxNzFcIlwiMSgzXHUwMTcyKlMgXCIvXHUwMTczXCJcIjEnM1x1MDE3NCpHIFwiL1x1MDE3NVwiXCIxJjNcdTAxNzYqOyBcIi9cdTAxNzdcIlwiMSozXHUwMTc4Ki8gXCIvXHUwMTc5XCJcIjEpM1x1MDE3QSojIFwiNzYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjcxKiMgXCIgWyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3NitvJCBcXCE3QSsyJDc2KyglNFwiNlx1MDE1QlwiISAlJFwiIyBYXCIjIFgsPSYhN0ErMiQ3NisoJTRcIjZcdTAxNUJcIiEgJSRcIiMgWFwiIyBYXCIrKSU0XCI2XHUwMTVDXCJcIiEgJSRcIiMgWFwiIyBYKiMgXCIgWysnIDQhNlx1MDE3QiEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3TCojIFwiN1x4OTgrYyQgXFwhN0IrLSQ3XHhFMCsjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceEUwKyMlJ1wiJSRcIiMgWFwiIyBYXCIrJyU0XCI2XHUwMTdDXCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XHhCOCojIFwiN1x4OUYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhFMitfJCBcXCE3QSstJDdceEUyKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdBKy0kN1x4RTIrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEU5K3MkNy4raSU3XHhFQytfJSBcXCE3QistJDdceEUzKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4RTMrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4RTQqOyBcIjdceEU1KjUgXCI3XHhFNiovIFwiN1x4RTcqKSBcIjdceEU4KiMgXCI3XHg5RiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxN0RcIlwiMSMzXHUwMTdFKzwkNzwrMiU3XHhFRisoJTQjNlx1MDE3RiMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDE4MFwiXCIxJTNcdTAxODErPCQ3PCsyJTdUKyglNCM2XHUwMTgyIyEgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTgzXCJcIjEoM1x1MDE4NCtCJDc8KzglN1xcKiMgXCI3WSsoJTQjNlx1MDE4NSMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDE4NlwiXCIxJjNcdTAxODcrPCQ3PCsyJTc2KyglNCM2XHUwMTg4IyEgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTg5XCJcIjElM1x1MDE4QStUJCE3PCs1JCBcXDchLCMmNyFcIisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrJyU0XCI2XHUwMThCXCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4RUErSyQ3OytBJTc2KzclNzsrLSU3XHhFQisjJSclJSQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x4OTVcIlwiMSMzXHhENiojIFwiNzYrJyA0ITZcdTAxOEMhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x4QjRcIlwiMSMzXHUwMThEKkcgXCIvXHhCNlwiXCIxIzNcdTAxOEUqOyBcIi9ceEJBXCJcIjEjM1x1MDE4RiovIFwiL1x4QjhcIlwiMSQzXHUwMTkwKiMgXCI3NisnIDQhNlx1MDE5MSEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhFRCtIJCE3QystJDdceEVFKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWysjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdVKikgXCI3XFwqIyBcIjdYKyYgNCE2XHUwMTkyISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhITchKiMgXCIgWytjJDchKiMgXCIgWytTJTchKiMgXCIgWytDJTchKiMgXCIgWyszJTchKiMgXCIgWysjJSclJSQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKycgNCE2XHUwMTkzISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3IStDJDchKiMgXCIgWyszJTchKiMgXCIgWysjJScjJSQjIyBYJFwiIyBYXCIjIFgrJyA0ITZcdTAxOTQhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XHhCRCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDlEK2QkIFxcITdCKy0kN1x4RjIrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHhGMisjJSdcIiUkXCIjIFhcIiMgWFwiKyglNFwiNlx1MDE5NVwiISElJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceEYzKiMgXCI3XHg5RiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS5cdTAxOTZcIlwiMlx1MDE5NjNcdTAxOTcrTiQ3PCtEJS5cdTAxOThcIlwiMlx1MDE5ODNcdTAxOTkqKSBcIi5cdTAxOUFcIlwiMlx1MDE5QTNcdTAxOUIrKCU0IzZcdTAxOUMjISAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDlEK2QkIFxcITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHg5RisjJSdcIiUkXCIjIFhcIiMgWFwiKyglNFwiNlx1MDE5RFwiISElJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3Nis3JDcwKy0lN1x4RjYrIyUnIyUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3MiopIFwiNzQqIyBcIjcuLC8mNzIqKSBcIjc0KiMgXCI3LlwiIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3JSwjJjclXCIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhGOSs9JC44XCJcIjI4MzkrLSU3XHhGQSsjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTlFXCJcIjElM1x1MDE5RiopIFwiL1x1MDFBMFwiXCIxJDNcdTAxQTErJyA0ITZcdTAxQTIhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4RkIrTiQhLjhcIlwiMjgzOSstJDdeKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWysjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdcXCopIFwiN1gqIyBcIjdceDgyKycgNCE2XHUwMUEzISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDdceEZEKikgXCI3LSojIFwiN1x4RkUsLyY3XHhGRCopIFwiNy0qIyBcIjdceEZFXCIrISAoJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1wiKlMgXCI3ISpNIFwiLkZcIlwiMkYzRypBIFwiLkpcIlwiMkozSyo1IFwiLkhcIlwiMkgzSSopIFwiLk5cIlwiMk4zTyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLkxcIlwiMkwzTSpceDk1IFwiLkJcIlwiMkIzQypceDg5IFwiLjxcIlwiMjwzPSp9IFwiLlJcIlwiMlIzUypxIFwiLlRcIlwiMlQzVSplIFwiLlZcIlwiMlYzVypZIFwiLlBcIlwiMlAzUSpNIFwiLkBcIlwiMkAzQSpBIFwiLkRcIlwiMkQzRSo1IFwiLjJcIlwiMjIzMyopIFwiLj5cIlwiMj4zPyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdcdTAxMDAraCQuOFwiXCIyODM5K1glN1x4RkErTiUhLlx1MDFBNFwiXCIyXHUwMUE0M1x1MDFBNSstJDdceEVCKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWysjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxQTZcIlwiMSUzXHUwMUE3KikgXCIvXHUwMUE4XCJcIjEkM1x1MDFBOSsnIDQhNlx1MDFBMiEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhFQitRJC9ceEI0XCJcIjEjM1x4QjUqNyBcIi9ceEI2XCJcIjEjM1x4QjcqKyBcIiBcXDcrLCMmNytcIisnJTRcIjZcdTAxQUFcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHUwMTA0K1x4OEYkLkZcIlwiMkYzRyt/JTdcdTAxMDMrdSUuRlwiXCIyRjNHK2UlN1x1MDEwMytbJS5GXCJcIjJGM0crSyU3XHUwMTAzK0ElLkZcIlwiMkYzRysxJTdcdTAxMDUrJyU0KTZcdTAxQUIpICUkKSMgWCQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNyMrQSQ3Iys3JTcjKy0lNyMrIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHUwMTAzKy0kN1x1MDEwMysjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdcdTAxMDMrNyQ3XHUwMTAzKy0lN1x1MDEwMysjJScjJSQjIyBYJFwiIyBYXCIjIFgiKQogICAgICAgIF0sCgogICAgICAgIHBlZyRjdXJyUG9zICAgICAgICAgID0gMCwKICAgICAgICBwZWckcmVwb3J0ZWRQb3MgICAgICA9IDAsCiAgICAgICAgcGVnJGNhY2hlZFBvcyAgICAgICAgPSAwLAogICAgICAgIHBlZyRjYWNoZWRQb3NEZXRhaWxzID0geyBsaW5lOiAxLCBjb2x1bW46IDEsIHNlZW5DUjogZmFsc2UgfSwKICAgICAgICBwZWckbWF4RmFpbFBvcyAgICAgICA9IDAsCiAgICAgICAgcGVnJG1heEZhaWxFeHBlY3RlZCAgPSBbXSwKICAgICAgICBwZWckc2lsZW50RmFpbHMgICAgICA9IDAsCgogICAgICAgIHBlZyRyZXN1bHQ7CgogICAgaWYgKCJzdGFydFJ1bGUiIGluIG9wdGlvbnMpIHsKICAgICAgaWYgKCEob3B0aW9ucy5zdGFydFJ1bGUgaW4gcGVnJHN0YXJ0UnVsZUluZGljZXMpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDYW4ndCBzdGFydCBwYXJzaW5nIGZyb20gcnVsZSBcIiIgKyBvcHRpb25zLnN0YXJ0UnVsZSArICJcIi4iKTsKICAgICAgfQoKICAgICAgcGVnJHN0YXJ0UnVsZUluZGV4ID0gcGVnJHN0YXJ0UnVsZUluZGljZXNbb3B0aW9ucy5zdGFydFJ1bGVdOwogICAgfQoKICAgIGZ1bmN0aW9uIHRleHQoKSB7CiAgICAgIHJldHVybiBpbnB1dC5zdWJzdHJpbmcocGVnJHJlcG9ydGVkUG9zLCBwZWckY3VyclBvcyk7CiAgICB9CgogICAgZnVuY3Rpb24gb2Zmc2V0KCkgewogICAgICByZXR1cm4gcGVnJHJlcG9ydGVkUG9zOwogICAgfQoKICAgIGZ1bmN0aW9uIGxpbmUoKSB7CiAgICAgIHJldHVybiBwZWckY29tcHV0ZVBvc0RldGFpbHMocGVnJHJlcG9ydGVkUG9zKS5saW5lOwogICAgfQoKICAgIGZ1bmN0aW9uIGNvbHVtbigpIHsKICAgICAgcmV0dXJuIHBlZyRjb21wdXRlUG9zRGV0YWlscyhwZWckcmVwb3J0ZWRQb3MpLmNvbHVtbjsKICAgIH0KCiAgICBmdW5jdGlvbiBleHBlY3RlZChkZXNjcmlwdGlvbikgewogICAgICB0aHJvdyBwZWckYnVpbGRFeGNlcHRpb24oCiAgICAgICAgbnVsbCwKICAgICAgICBbeyB0eXBlOiAib3RoZXIiLCBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfV0sCiAgICAgICAgcGVnJHJlcG9ydGVkUG9zCiAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkgewogICAgICB0aHJvdyBwZWckYnVpbGRFeGNlcHRpb24obWVzc2FnZSwgbnVsbCwgcGVnJHJlcG9ydGVkUG9zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwZWckY29tcHV0ZVBvc0RldGFpbHMocG9zKSB7CiAgICAgIGZ1bmN0aW9uIGFkdmFuY2UoZGV0YWlscywgc3RhcnRQb3MsIGVuZFBvcykgewogICAgICAgIHZhciBwLCBjaDsKCiAgICAgICAgZm9yIChwID0gc3RhcnRQb3M7IHAgPCBlbmRQb3M7IHArKykgewogICAgICAgICAgY2ggPSBpbnB1dC5jaGFyQXQocCk7CiAgICAgICAgICBpZiAoY2ggPT09ICJcbiIpIHsKICAgICAgICAgICAgaWYgKCFkZXRhaWxzLnNlZW5DUikgeyBkZXRhaWxzLmxpbmUrKzsgfQogICAgICAgICAgICBkZXRhaWxzLmNvbHVtbiA9IDE7CiAgICAgICAgICAgIGRldGFpbHMuc2VlbkNSID0gZmFsc2U7CiAgICAgICAgICB9IGVsc2UgaWYgKGNoID09PSAiXHIiIHx8IGNoID09PSAiXHUyMDI4IiB8fCBjaCA9PT0gIlx1MjAyOSIpIHsKICAgICAgICAgICAgZGV0YWlscy5saW5lKys7CiAgICAgICAgICAgIGRldGFpbHMuY29sdW1uID0gMTsKICAgICAgICAgICAgZGV0YWlscy5zZWVuQ1IgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGV0YWlscy5jb2x1bW4rKzsKICAgICAgICAgICAgZGV0YWlscy5zZWVuQ1IgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChwZWckY2FjaGVkUG9zICE9PSBwb3MpIHsKICAgICAgICBpZiAocGVnJGNhY2hlZFBvcyA+IHBvcykgewogICAgICAgICAgcGVnJGNhY2hlZFBvcyA9IDA7CiAgICAgICAgICBwZWckY2FjaGVkUG9zRGV0YWlscyA9IHsgbGluZTogMSwgY29sdW1uOiAxLCBzZWVuQ1I6IGZhbHNlIH07CiAgICAgICAgfQogICAgICAgIGFkdmFuY2UocGVnJGNhY2hlZFBvc0RldGFpbHMsIHBlZyRjYWNoZWRQb3MsIHBvcyk7CiAgICAgICAgcGVnJGNhY2hlZFBvcyA9IHBvczsKICAgICAgfQoKICAgICAgcmV0dXJuIHBlZyRjYWNoZWRQb3NEZXRhaWxzOwogICAgfQoKICAgIGZ1bmN0aW9uIHBlZyRmYWlsKGV4cGVjdGVkKSB7CiAgICAgIGlmIChwZWckY3VyclBvcyA8IHBlZyRtYXhGYWlsUG9zKSB7IHJldHVybjsgfQoKICAgICAgaWYgKHBlZyRjdXJyUG9zID4gcGVnJG1heEZhaWxQb3MpIHsKICAgICAgICBwZWckbWF4RmFpbFBvcyA9IHBlZyRjdXJyUG9zOwogICAgICAgIHBlZyRtYXhGYWlsRXhwZWN0ZWQgPSBbXTsKICAgICAgfQoKICAgICAgcGVnJG1heEZhaWxFeHBlY3RlZC5wdXNoKGV4cGVjdGVkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwZWckYnVpbGRFeGNlcHRpb24obWVzc2FnZSwgZXhwZWN0ZWQsIHBvcykgewogICAgICBmdW5jdGlvbiBjbGVhbnVwRXhwZWN0ZWQoZXhwZWN0ZWQpIHsKICAgICAgICB2YXIgaSA9IDE7CgogICAgICAgIGV4cGVjdGVkLnNvcnQoZnVuY3Rpb24oYSwgYikgewogICAgICAgICAgaWYgKGEuZGVzY3JpcHRpb24gPCBiLmRlc2NyaXB0aW9uKSB7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgIH0gZWxzZSBpZiAoYS5kZXNjcmlwdGlvbiA+IGIuZGVzY3JpcHRpb24pIHsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgd2hpbGUgKGkgPCBleHBlY3RlZC5sZW5ndGgpIHsKICAgICAgICAgIGlmIChleHBlY3RlZFtpIC0gMV0gPT09IGV4cGVjdGVkW2ldKSB7CiAgICAgICAgICAgIGV4cGVjdGVkLnNwbGljZShpLCAxKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGkrKzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGJ1aWxkTWVzc2FnZShleHBlY3RlZCwgZm91bmQpIHsKICAgICAgICBmdW5jdGlvbiBzdHJpbmdFc2NhcGUocykgewogICAgICAgICAgZnVuY3Rpb24gaGV4KGNoKSB7IHJldHVybiBjaC5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpOyB9CgogICAgICAgICAgcmV0dXJuIHMKICAgICAgICAgICAgLnJlcGxhY2UoL1xcL2csICAgJ1xcXFwnKQogICAgICAgICAgICAucmVwbGFjZSgvIi9nLCAgICAnXFwiJykKICAgICAgICAgICAgLnJlcGxhY2UoL1x4MDgvZywgJ1xcYicpCiAgICAgICAgICAgIC5yZXBsYWNlKC9cdC9nLCAgICdcXHQnKQogICAgICAgICAgICAucmVwbGFjZSgvXG4vZywgICAnXFxuJykKICAgICAgICAgICAgLnJlcGxhY2UoL1xmL2csICAgJ1xcZicpCiAgICAgICAgICAgIC5yZXBsYWNlKC9cci9nLCAgICdcXHInKQogICAgICAgICAgICAucmVwbGFjZSgvW1x4MDAtXHgwN1x4MEJceDBFXHgwRl0vZywgZnVuY3Rpb24oY2gpIHsgcmV0dXJuICdcXHgwJyArIGhleChjaCk7IH0pCiAgICAgICAgICAgIC5yZXBsYWNlKC9bXHgxMC1ceDFGXHg4MC1ceEZGXS9nLCAgICBmdW5jdGlvbihjaCkgeyByZXR1cm4gJ1xceCcgICsgaGV4KGNoKTsgfSkKICAgICAgICAgICAgLnJlcGxhY2UoL1tcdTAxODAtXHUwRkZGXS9nLCAgICAgICAgIGZ1bmN0aW9uKGNoKSB7IHJldHVybiAnXFx1MCcgKyBoZXgoY2gpOyB9KQogICAgICAgICAgICAucmVwbGFjZSgvW1x1MTA4MC1cdUZGRkZdL2csICAgICAgICAgZnVuY3Rpb24oY2gpIHsgcmV0dXJuICdcXHUnICArIGhleChjaCk7IH0pOwogICAgICAgIH0KCiAgICAgICAgdmFyIGV4cGVjdGVkRGVzY3MgPSBuZXcgQXJyYXkoZXhwZWN0ZWQubGVuZ3RoKSwKICAgICAgICAgICAgZXhwZWN0ZWREZXNjLCBmb3VuZERlc2MsIGk7CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBleHBlY3RlZC5sZW5ndGg7IGkrKykgewogICAgICAgICAgZXhwZWN0ZWREZXNjc1tpXSA9IGV4cGVjdGVkW2ldLmRlc2NyaXB0aW9uOwogICAgICAgIH0KCiAgICAgICAgZXhwZWN0ZWREZXNjID0gZXhwZWN0ZWQubGVuZ3RoID4gMQogICAgICAgICAgPyBleHBlY3RlZERlc2NzLnNsaWNlKDAsIC0xKS5qb2luKCIsICIpCiAgICAgICAgICAgICAgKyAiIG9yICIKICAgICAgICAgICAgICArIGV4cGVjdGVkRGVzY3NbZXhwZWN0ZWQubGVuZ3RoIC0gMV0KICAgICAgICAgIDogZXhwZWN0ZWREZXNjc1swXTsKCiAgICAgICAgZm91bmREZXNjID0gZm91bmQgPyAiXCIiICsgc3RyaW5nRXNjYXBlKGZvdW5kKSArICJcIiIgOiAiZW5kIG9mIGlucHV0IjsKCiAgICAgICAgcmV0dXJuICJFeHBlY3RlZCAiICsgZXhwZWN0ZWREZXNjICsgIiBidXQgIiArIGZvdW5kRGVzYyArICIgZm91bmQuIjsKICAgICAgfQoKICAgICAgdmFyIHBvc0RldGFpbHMgPSBwZWckY29tcHV0ZVBvc0RldGFpbHMocG9zKSwKICAgICAgICAgIGZvdW5kICAgICAgPSBwb3MgPCBpbnB1dC5sZW5ndGggPyBpbnB1dC5jaGFyQXQocG9zKSA6IG51bGw7CgogICAgICBpZiAoZXhwZWN0ZWQgIT09IG51bGwpIHsKICAgICAgICBjbGVhbnVwRXhwZWN0ZWQoZXhwZWN0ZWQpOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IFN5bnRheEVycm9yKAogICAgICAgIG1lc3NhZ2UgIT09IG51bGwgPyBtZXNzYWdlIDogYnVpbGRNZXNzYWdlKGV4cGVjdGVkLCBmb3VuZCksCiAgICAgICAgZXhwZWN0ZWQsCiAgICAgICAgZm91bmQsCiAgICAgICAgcG9zLAogICAgICAgIHBvc0RldGFpbHMubGluZSwKICAgICAgICBwb3NEZXRhaWxzLmNvbHVtbgogICAgICApOwogICAgfQoKICAgIGZ1bmN0aW9uIHBlZyRkZWNvZGUocykgewogICAgICB2YXIgYmMgPSBuZXcgQXJyYXkocy5sZW5ndGgpLCBpOwoKICAgICAgZm9yIChpID0gMDsgaSA8IHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBiY1tpXSA9IHMuY2hhckNvZGVBdChpKSAtIDMyOwogICAgICB9CgogICAgICByZXR1cm4gYmM7CiAgICB9CgogICAgZnVuY3Rpb24gcGVnJHBhcnNlUnVsZShpbmRleCkgewogICAgICB2YXIgYmMgICAgPSBwZWckYnl0ZWNvZGVbaW5kZXhdLAogICAgICAgICAgaXAgICAgPSAwLAogICAgICAgICAgaXBzICAgPSBbXSwKICAgICAgICAgIGVuZCAgID0gYmMubGVuZ3RoLAogICAgICAgICAgZW5kcyAgPSBbXSwKICAgICAgICAgIHN0YWNrID0gW10sCiAgICAgICAgICBwYXJhbXMsIGk7CgogICAgICBmdW5jdGlvbiBwcm90ZWN0KG9iamVjdCkgewogICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KG9iamVjdCkgPT09ICJbb2JqZWN0IEFycmF5XSIgPyBbXSA6IG9iamVjdDsKICAgICAgfQoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICB3aGlsZSAoaXAgPCBlbmQpIHsKICAgICAgICAgIHN3aXRjaCAoYmNbaXBdKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBzdGFjay5wdXNoKHByb3RlY3QocGVnJGNvbnN0c1tiY1tpcCArIDFdXSkpOwogICAgICAgICAgICAgIGlwICs9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgc3RhY2sucHVzaChwZWckY3VyclBvcyk7CiAgICAgICAgICAgICAgaXArKzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIHBlZyRjdXJyUG9zID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgICAgaXArKzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBzdGFjay5sZW5ndGggLT0gYmNbaXAgKyAxXTsKICAgICAgICAgICAgICBpcCArPSAyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIHN0YWNrLnNwbGljZSgtMiwgMSk7CiAgICAgICAgICAgICAgaXArKzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBzdGFja1tzdGFjay5sZW5ndGggLSAyXS5wdXNoKHN0YWNrLnBvcCgpKTsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIHN0YWNrLnB1c2goc3RhY2suc3BsaWNlKHN0YWNrLmxlbmd0aCAtIGJjW2lwICsgMV0sIGJjW2lwICsgMV0pKTsKICAgICAgICAgICAgICBpcCArPSAyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIHN0YWNrLnBvcCgpOwogICAgICAgICAgICAgIHN0YWNrLnB1c2goaW5wdXQuc3Vic3RyaW5nKHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdLCBwZWckY3VyclBvcykpOwogICAgICAgICAgICAgIGlwKys7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgZW5kcy5wdXNoKGVuZCk7CiAgICAgICAgICAgICAgaXBzLnB1c2goaXAgKyAzICsgYmNbaXAgKyAxXSArIGJjW2lwICsgMl0pOwoKICAgICAgICAgICAgICBpZiAoc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0pIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgMyArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgICBpcCArPSAzOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDMgKyBiY1tpcCArIDFdICsgYmNbaXAgKyAyXTsKICAgICAgICAgICAgICAgIGlwICs9IDMgKyBiY1tpcCArIDFdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGVuZHMucHVzaChlbmQpOwogICAgICAgICAgICAgIGlwcy5wdXNoKGlwICsgMyArIGJjW2lwICsgMV0gKyBiY1tpcCArIDJdKTsKCiAgICAgICAgICAgICAgaWYgKHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdID09PSBwZWckRkFJTEVEKSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDMgKyBiY1tpcCArIDFdOwogICAgICAgICAgICAgICAgaXAgKz0gMzsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyAzICsgYmNbaXAgKyAxXSArIGJjW2lwICsgMl07CiAgICAgICAgICAgICAgICBpcCArPSAzICsgYmNbaXAgKyAxXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBlbmRzLnB1c2goZW5kKTsKICAgICAgICAgICAgICBpcHMucHVzaChpcCArIDMgKyBiY1tpcCArIDFdICsgYmNbaXAgKyAyXSk7CgogICAgICAgICAgICAgIGlmIChzdGFja1tzdGFjay5sZW5ndGggLSAxXSAhPT0gcGVnJEZBSUxFRCkgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyAzICsgYmNbaXAgKyAxXTsKICAgICAgICAgICAgICAgIGlwICs9IDM7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgMyArIGJjW2lwICsgMV0gKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgICAgaXAgKz0gMyArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgaWYgKHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdICE9PSBwZWckRkFJTEVEKSB7CiAgICAgICAgICAgICAgICBlbmRzLnB1c2goZW5kKTsKICAgICAgICAgICAgICAgIGlwcy5wdXNoKGlwKTsKCiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDIgKyBiY1tpcCArIDFdOwogICAgICAgICAgICAgICAgaXAgKz0gMjsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaXAgKz0gMiArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgZW5kcy5wdXNoKGVuZCk7CiAgICAgICAgICAgICAgaXBzLnB1c2goaXAgKyAzICsgYmNbaXAgKyAxXSArIGJjW2lwICsgMl0pOwoKICAgICAgICAgICAgICBpZiAoaW5wdXQubGVuZ3RoID4gcGVnJGN1cnJQb3MpIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgMyArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgICBpcCArPSAzOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDMgKyBiY1tpcCArIDFdICsgYmNbaXAgKyAyXTsKICAgICAgICAgICAgICAgIGlwICs9IDMgKyBiY1tpcCArIDFdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIGVuZHMucHVzaChlbmQpOwogICAgICAgICAgICAgIGlwcy5wdXNoKGlwICsgNCArIGJjW2lwICsgMl0gKyBiY1tpcCArIDNdKTsKCiAgICAgICAgICAgICAgaWYgKGlucHV0LnN1YnN0cihwZWckY3VyclBvcywgcGVnJGNvbnN0c1tiY1tpcCArIDFdXS5sZW5ndGgpID09PSBwZWckY29uc3RzW2JjW2lwICsgMV1dKSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDQgKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgICAgaXAgKz0gNDsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyA0ICsgYmNbaXAgKyAyXSArIGJjW2lwICsgM107CiAgICAgICAgICAgICAgICBpcCArPSA0ICsgYmNbaXAgKyAyXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICBlbmRzLnB1c2goZW5kKTsKICAgICAgICAgICAgICBpcHMucHVzaChpcCArIDQgKyBiY1tpcCArIDJdICsgYmNbaXAgKyAzXSk7CgogICAgICAgICAgICAgIGlmIChpbnB1dC5zdWJzdHIocGVnJGN1cnJQb3MsIHBlZyRjb25zdHNbYmNbaXAgKyAxXV0ubGVuZ3RoKS50b0xvd2VyQ2FzZSgpID09PSBwZWckY29uc3RzW2JjW2lwICsgMV1dKSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDQgKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgICAgaXAgKz0gNDsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyA0ICsgYmNbaXAgKyAyXSArIGJjW2lwICsgM107CiAgICAgICAgICAgICAgICBpcCArPSA0ICsgYmNbaXAgKyAyXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICBlbmRzLnB1c2goZW5kKTsKICAgICAgICAgICAgICBpcHMucHVzaChpcCArIDQgKyBiY1tpcCArIDJdICsgYmNbaXAgKyAzXSk7CgogICAgICAgICAgICAgIGlmIChwZWckY29uc3RzW2JjW2lwICsgMV1dLnRlc3QoaW5wdXQuY2hhckF0KHBlZyRjdXJyUG9zKSkpIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgNCArIGJjW2lwICsgMl07CiAgICAgICAgICAgICAgICBpcCArPSA0OwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDQgKyBiY1tpcCArIDJdICsgYmNbaXAgKyAzXTsKICAgICAgICAgICAgICAgIGlwICs9IDQgKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgIHN0YWNrLnB1c2goaW5wdXQuc3Vic3RyKHBlZyRjdXJyUG9zLCBiY1tpcCArIDFdKSk7CiAgICAgICAgICAgICAgcGVnJGN1cnJQb3MgKz0gYmNbaXAgKyAxXTsKICAgICAgICAgICAgICBpcCArPSAyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICBzdGFjay5wdXNoKHBlZyRjb25zdHNbYmNbaXAgKyAxXV0pOwogICAgICAgICAgICAgIHBlZyRjdXJyUG9zICs9IHBlZyRjb25zdHNbYmNbaXAgKyAxXV0ubGVuZ3RoOwogICAgICAgICAgICAgIGlwICs9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgIHN0YWNrLnB1c2gocGVnJEZBSUxFRCk7CiAgICAgICAgICAgICAgaWYgKHBlZyRzaWxlbnRGYWlscyA9PT0gMCkgewogICAgICAgICAgICAgICAgcGVnJGZhaWwocGVnJGNvbnN0c1tiY1tpcCArIDFdXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlwICs9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgIHBlZyRyZXBvcnRlZFBvcyA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDEgLSBiY1tpcCArIDFdXTsKICAgICAgICAgICAgICBpcCArPSAyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICBwZWckcmVwb3J0ZWRQb3MgPSBwZWckY3VyclBvczsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICBwYXJhbXMgPSBiYy5zbGljZShpcCArIDQsIGlwICsgNCArIGJjW2lwICsgM10pOwogICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBiY1tpcCArIDNdOyBpKyspIHsKICAgICAgICAgICAgICAgIHBhcmFtc1tpXSA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDEgLSBwYXJhbXNbaV1dOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc3RhY2suc3BsaWNlKAogICAgICAgICAgICAgICAgc3RhY2subGVuZ3RoIC0gYmNbaXAgKyAyXSwKICAgICAgICAgICAgICAgIGJjW2lwICsgMl0sCiAgICAgICAgICAgICAgICBwZWckY29uc3RzW2JjW2lwICsgMV1dLmFwcGx5KG51bGwsIHBhcmFtcykKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICBpcCArPSA0ICsgYmNbaXAgKyAzXTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgc3RhY2sucHVzaChwZWckcGFyc2VSdWxlKGJjW2lwICsgMV0pKTsKICAgICAgICAgICAgICBpcCArPSAyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICBwZWckc2lsZW50RmFpbHMrKzsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyNToKICAgICAgICAgICAgICBwZWckc2lsZW50RmFpbHMtLTsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgb3Bjb2RlOiAiICsgYmNbaXBdICsgIi4iKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChlbmRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGVuZCA9IGVuZHMucG9wKCk7CiAgICAgICAgICBpcCA9IGlwcy5wb3AoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gc3RhY2tbMF07CiAgICB9CgoKICAgICAgb3B0aW9ucy5kYXRhID0ge307IC8vIE9iamVjdCB0byB3aGljaCBoZWFkZXIgYXR0cmlidXRlcyB3aWxsIGJlIGFzc2lnbmVkIGR1cmluZyBwYXJzaW5nCgogICAgICBmdW5jdGlvbiBsaXN0IChmaXJzdCwgcmVzdCkgewogICAgICAgIHJldHVybiBbZmlyc3RdLmNvbmNhdChyZXN0KTsKICAgICAgfQoKCiAgICBwZWckcmVzdWx0ID0gcGVnJHBhcnNlUnVsZShwZWckc3RhcnRSdWxlSW5kZXgpOwoKICAgIGlmIChwZWckcmVzdWx0ICE9PSBwZWckRkFJTEVEICYmIHBlZyRjdXJyUG9zID09PSBpbnB1dC5sZW5ndGgpIHsKICAgICAgcmV0dXJuIHBlZyRyZXN1bHQ7CiAgICB9IGVsc2UgewogICAgICBpZiAocGVnJHJlc3VsdCAhPT0gcGVnJEZBSUxFRCAmJiBwZWckY3VyclBvcyA8IGlucHV0Lmxlbmd0aCkgewogICAgICAgIHBlZyRmYWlsKHsgdHlwZTogImVuZCIsIGRlc2NyaXB0aW9uOiAiZW5kIG9mIGlucHV0IiB9KTsKICAgICAgfQoKICAgICAgdGhyb3cgcGVnJGJ1aWxkRXhjZXB0aW9uKG51bGwsIHBlZyRtYXhGYWlsRXhwZWN0ZWQsIHBlZyRtYXhGYWlsUG9zKTsKICAgIH0KICB9CgogIHJldHVybiB7CiAgICBTeW50YXhFcnJvcjogU3ludGF4RXJyb3IsCiAgICBwYXJzZTogICAgICAgcGFyc2UKICB9Owp9KSgpOwoKfSx7fV0sMTg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IEhhY2tzIC0gVGhpcyBmaWxlIGNvbnRhaW5zIGFsbCBvZiB0aGUgdGhpbmdzIHdlCiAqIHdpc2ggd2UgZGlkbid0IGhhdmUgdG8gZG8sIGp1c3QgZm9yIGludGVyb3AuICBJdCBpcyBzaW1pbGFyIHRvCiAqIFV0aWxzLCB3aGljaCBwcm92aWRlcyBhY3R1YWxseSB1c2VmdWwgYW5kIHJlbGV2YW50IGZ1bmN0aW9ucyBmb3IKICogYSBTSVAgbGlicmFyeS4gTWV0aG9kcyBpbiB0aGlzIGZpbGUgYXJlIGdyb3VwZWQgYnkgdmVuZG9yLCBzbwogKiBhcyB0byBtb3N0IGVhc2lseSB0cmFjayB3aGVuIHBhcnRpY3VsYXIgaGFja3MgbWF5IG5vdCBiZSBuZWNlc3NhcnkgYW55bW9yZS4KICovCgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKCi8va2VlcCB0byBxdWlldCBqc2hpbnQsIGFuZCByZW1haW4gY29uc2lzdGVudCB3aXRoIG90aGVyIGZpbGVzClNJUCA9IFNJUDsKCnZhciBIYWNrcyA9IHsKICBBbGxCcm93c2VyczogewogICAgbWFza0R0bHM6IGZ1bmN0aW9uIChtZXNzYWdlKSB7CiAgICAgIGlmIChtZXNzYWdlLmJvZHkpIHsKICAgICAgICBtZXNzYWdlLmJvZHkgPSBtZXNzYWdlLmJvZHkucmVwbGFjZSgvIFVEUFwvVExTXC9SVFBcL1NBVlAvZ21pLCAiIFJUUC9TQVZQIik7CiAgICAgIH0KICAgIH0sCiAgICB1bm1hc2tEdGxzOiBmdW5jdGlvbiAoc2RwKSB7CiAgICAgIC8qKgogICAgICAgKiBDaHJvbWUgZG9lcyBub3QgaGFuZGxlIERUTFMgY29ycmVjdGx5IChDYW5hcmF5IGRvZXMsIGJ1dCBub3QgcHJvZHVjdGlvbikKICAgICAgICoga2VlcGluZyBDaHJvbWUgYXMgU0RFUyB1bnRpbCBEVExTIGlzIGZpeGVkIChjb21tZW50IG91dCAnaXNfb3BlcmEnIGNvbmRpdGlvbikKICAgICAgICoKICAgICAgICogVVBEQVRFOiBNYXkgMjEsIDIwMTQKICAgICAgICogQ2hyb21lIDM1IG5vdyBwcm9wZXJseSBkZWZhdWx0cyB0byBEVExTLiAgT25seSBPcGVyYSByZW1haW5zIHVzaW5nIFNERVMKICAgICAgICoKICAgICAgICogVVBEQVRFOiAyMDE0LTA5LTI0CiAgICAgICAqIE9wZXJhIG5vdyBzdXBwb3J0cyBEVExTIGJ5IGRlZmF1bHQgYXMgd2VsbC4KICAgICAgICoKICAgICAgICoqLwogICAgICByZXR1cm4gc2RwLnJlcGxhY2UoLyBSVFBcL1NBVlAvZ21pLCAiIFVEUC9UTFMvUlRQL1NBVlAiKTsKICAgIH0KICB9LAogIEZpcmVmb3g6IHsKICAgIC8qIENvbmRpdGlvbiB0byBkZXRlY3QgaWYgaGFja3MgYXJlIGFwcGxpY2FibGUgKi8KICAgIGlzRmlyZWZveDogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdHlwZW9mIG1velJUQ1BlZXJDb25uZWN0aW9uICE9PSAndW5kZWZpbmVkJzsKICAgIH0sCgogICAgY2Fubm90SGFuZGxlRXh0cmFXaGl0ZXNwYWNlOiBmdW5jdGlvbiAobWVzc2FnZSkgewogICAgICBpZiAodGhpcy5pc0ZpcmVmb3goKSAmJiBtZXNzYWdlLmJvZHkpIHsKICAgICAgICBtZXNzYWdlLmJvZHkgPSBtZXNzYWdlLmJvZHkucmVwbGFjZSgvIFxyXG4vZywgIlxyXG4iKTsKICAgICAgfQogICAgfSwKCiAgICBoYXNNaXNzaW5nQ0xpbmVJblNEUDogZnVuY3Rpb24gKHNkcCkgewogICAgICAvKgogICAgICAgKiBUaGlzIGlzIGEgRmlyZWZveCBoYWNrIHRvIGluc2VydCB2YWxpZCBzZHAgd2hlbiBnZXREZXNjcmlwdGlvbiBpcwogICAgICAgKiBjYWxsZWQgd2l0aCB0aGUgY29uc3RyYWludCBvZmZlclRvUmVjZWl2ZVZpZGVvID0gZmFsc2UuCiAgICAgICAqIFdlIHNlYXJjaCBmb3IgZWl0aGVyIGEgYy1saW5lIGF0IHRoZSB0b3Agb2YgdGhlIHNkcCBhYm92ZSBhbGwKICAgICAgICogbS1saW5lcy4gSWYgdGhhdCBkb2VzIG5vdCBleGlzdCB0aGVuIHdlIHNlYXJjaCBmb3IgYSBjLWxpbmUKICAgICAgICogYmVuZWF0aCBlYWNoIG0tbGluZS4gSWYgaXQgaXMgbWlzc2luZyBhIGMtbGluZSwgd2UgaW5zZXJ0CiAgICAgICAqIGEgZmFrZSBjLWxpbmUgd2l0aCB0aGUgaXAgYWRkcmVzcyAwLjAuMC4wLiBUaGlzIGlzIHRoZW4gdmFsaWQKICAgICAgICogc2RwIGFuZCBubyBtZWRpYSB3aWxsIGJlIHNlbnQgZm9yIHRoYXQgbS1saW5lLgogICAgICAgKgogICAgICAgKiBWYWxpZCBTRFAgaXM6CiAgICAgICAqIG09CiAgICAgICAqIGk9CiAgICAgICAqIGM9CiAgICAgICAqLwogICAgICB2YXIgaW5zZXJ0QXQsIG1saW5lczsKICAgICAgaWYgKHNkcC5pbmRleE9mKCdjPScpID4gc2RwLmluZGV4T2YoJ209JykpIHsKCiAgICAgICAgLy8gRmluZCBhbGwgbT0gbGluZXMKICAgICAgICBtbGluZXMgPSBzZHAubWF0Y2goL209LipcclxuLiovZyk7CiAgICAgICAgZm9yICh2YXIgaT0wOyBpPG1saW5lcy5sZW5ndGg7IGkrKykgewoKICAgICAgICAgIC8vIElmIGl0IGhhcyBhbiBpPSBsaW5lLCBjaGVjayBpZiB0aGUgbmV4dCBsaW5lIGlzIHRoZSBjPSBsaW5lCiAgICAgICAgICBpZiAobWxpbmVzW2ldLnRvU3RyaW5nKCkuc2VhcmNoKC9pPS4qLykgPj0gMCkgewogICAgICAgICAgICBpbnNlcnRBdCA9IHNkcC5pbmRleE9mKG1saW5lc1tpXS50b1N0cmluZygpKSttbGluZXNbaV0udG9TdHJpbmcoKS5sZW5ndGg7CiAgICAgICAgICAgIGlmIChzZHAuc3Vic3RyKGluc2VydEF0LDIpIT09J2M9JykgewogICAgICAgICAgICAgIHNkcCA9IHNkcC5zdWJzdHIoMCxpbnNlcnRBdCkgKyAnXHJcbmM9SU4gSVA0IDAuMC4wLjAnICsgc2RwLnN1YnN0cihpbnNlcnRBdCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAvLyBlbHNlIGFkZCB0aGUgQyBsaW5lIGlmIGl0J3MgbWlzc2luZwogICAgICAgICAgfSBlbHNlIGlmIChtbGluZXNbaV0udG9TdHJpbmcoKS5zZWFyY2goL2M9LiovKSA8IDApIHsKICAgICAgICAgICAgaW5zZXJ0QXQgPSBzZHAuaW5kZXhPZihtbGluZXNbaV0udG9TdHJpbmcoKS5tYXRjaCgvLiovKSkrbWxpbmVzW2ldLnRvU3RyaW5nKCkubWF0Y2goLy4qLykudG9TdHJpbmcoKS5sZW5ndGg7CiAgICAgICAgICAgIHNkcCA9IHNkcC5zdWJzdHIoMCxpbnNlcnRBdCkgKyAnXHJcbmM9SU4gSVA0IDAuMC4wLjAnICsgc2RwLnN1YnN0cihpbnNlcnRBdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBzZHA7CiAgICB9LAogIH0sCgogIENocm9tZTogewogICAgbmVlZHNFeHBsaWNpdGx5SW5hY3RpdmVTRFA6IGZ1bmN0aW9uIChzZHApIHsKICAgICAgdmFyIHN1YiwgaW5kZXg7CgogICAgICBpZiAoSGFja3MuRmlyZWZveC5pc0ZpcmVmb3goKSkgeyAvLyBGaXggdGhpcyBpbiBGaXJlZm94IGJlZm9yZSBzZW5kaW5nCiAgICAgICAgaW5kZXggPSBzZHAuaW5kZXhPZignbT12aWRlbyAwJyk7CiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgICAgc3ViID0gc2RwLnN1YnN0cihpbmRleCk7CiAgICAgICAgICBzdWIgPSBzdWIucmVwbGFjZSgvXHJcbmM9SU4gSVA0LipcclxuJC8sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXHJcbmM9SU4gSVA0IDAuMC4wLjBcclxuYT1pbmFjdGl2ZVxyXG4nKTsKICAgICAgICAgIHJldHVybiBzZHAuc3Vic3RyKDAsIGluZGV4KSArIHN1YjsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHNkcDsKICAgIH0sCgogICAgZ2V0c0NvbmZ1c2VkQWJvdXRHVU06IGZ1bmN0aW9uIChzZXNzaW9uKSB7CiAgICAgIGlmIChzZXNzaW9uLm1lZGlhSGFuZGxlcikgewogICAgICAgIHNlc3Npb24ubWVkaWFIYW5kbGVyLmNsb3NlKCk7CiAgICAgIH0KICAgIH0KICB9Cn07CnJldHVybiBIYWNrczsKfTsKfSx7fV0sMTk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CnZhciBsZXZlbHMgPSB7CiAgJ2Vycm9yJzogMCwKICAnd2Fybic6IDEsCiAgJ2xvZyc6IDIsCiAgJ2RlYnVnJzogMwp9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoY29uc29sZSkgewoKdmFyIExvZ2dlckZhY3RvcnkgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIGxvZ2dlciwKICAgIGxldmVsID0gMiwKICAgIGJ1aWx0aW5FbmFibGVkID0gdHJ1ZSwKICAgIGNvbm5lY3RvciA9IG51bGw7CgogICAgdGhpcy5sb2dnZXJzID0ge307CgogICAgbG9nZ2VyID0gdGhpcy5nZXRMb2dnZXIoJ3NpcC5sb2dnZXJmYWN0b3J5Jyk7CgoKICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB7CiAgICBidWlsdGluRW5hYmxlZDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBidWlsdGluRW5hYmxlZDsgfSwKICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgICBidWlsdGluRW5hYmxlZCA9IHZhbHVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBsb2dnZXIuZXJyb3IoJ2ludmFsaWQgImJ1aWx0aW5FbmFibGVkIiBwYXJhbWV0ZXIgdmFsdWU6ICcrIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIGxldmVsOiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7cmV0dXJuIGxldmVsOyB9LAogICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgaWYgKHZhbHVlID49IDAgJiYgdmFsdWUgPD0zKSB7CiAgICAgICAgICBsZXZlbCA9IHZhbHVlOwogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPiAzKSB7CiAgICAgICAgICBsZXZlbCA9IDM7CiAgICAgICAgfSBlbHNlIGlmIChsZXZlbHMuaGFzT3duUHJvcGVydHkodmFsdWUpKSB7CiAgICAgICAgICBsZXZlbCA9IGxldmVsc1t2YWx1ZV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGxvZ2dlci5lcnJvcignaW52YWxpZCAibGV2ZWwiIHBhcmFtZXRlciB2YWx1ZTogJysgSlNPTi5zdHJpbmdpZnkodmFsdWUpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgY29ubmVjdG9yOiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7cmV0dXJuIGNvbm5lY3RvcjsgfSwKICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgaWYodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09ICIiIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGNvbm5lY3RvciA9IG51bGw7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGNvbm5lY3RvciA9IHZhbHVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBsb2dnZXIuZXJyb3IoJ2ludmFsaWQgImNvbm5lY3RvciIgcGFyYW1ldGVyIHZhbHVlOiAnKyBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0pOwp9OwoKTG9nZ2VyRmFjdG9yeS5wcm90b3R5cGUucHJpbnQgPSBmdW5jdGlvbih0YXJnZXQsIGNhdGVnb3J5LCBsYWJlbCwgY29udGVudCkgewogIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHsKICAgIHZhciBwcmVmaXggPSBbbmV3IERhdGUoKSwgY2F0ZWdvcnldOwogICAgaWYgKGxhYmVsKSB7CiAgICAgIHByZWZpeC5wdXNoKGxhYmVsKTsKICAgIH0KICAgIGNvbnRlbnQgPSBwcmVmaXguY29uY2F0KGNvbnRlbnQpLmpvaW4oJyB8ICcpOwogIH0KICB0YXJnZXQuY2FsbChjb25zb2xlLCBjb250ZW50KTsKfTsKCmZ1bmN0aW9uIExvZ2dlciAobG9nZ2VyLCBjYXRlZ29yeSwgbGFiZWwpIHsKICB0aGlzLmxvZ2dlciA9IGxvZ2dlcjsKICB0aGlzLmNhdGVnb3J5ID0gY2F0ZWdvcnk7CiAgdGhpcy5sYWJlbCA9IGxhYmVsOwp9CgpPYmplY3Qua2V5cyhsZXZlbHMpLmZvckVhY2goZnVuY3Rpb24gKHRhcmdldE5hbWUpIHsKICBMb2dnZXIucHJvdG90eXBlW3RhcmdldE5hbWVdID0gZnVuY3Rpb24gKGNvbnRlbnQpIHsKICAgIHRoaXMubG9nZ2VyW3RhcmdldE5hbWVdKHRoaXMuY2F0ZWdvcnksIHRoaXMubGFiZWwsIGNvbnRlbnQpOwogIH07CgogIExvZ2dlckZhY3RvcnkucHJvdG90eXBlW3RhcmdldE5hbWVdID0gZnVuY3Rpb24gKGNhdGVnb3J5LCBsYWJlbCwgY29udGVudCkgewogICAgaWYgKHRoaXMubGV2ZWwgPj0gbGV2ZWxzW3RhcmdldE5hbWVdKSB7CiAgICAgIGlmICh0aGlzLmJ1aWx0aW5FbmFibGVkKSB7CiAgICAgICAgdGhpcy5wcmludChjb25zb2xlW3RhcmdldE5hbWVdLCBjYXRlZ29yeSwgbGFiZWwsIGNvbnRlbnQpOwogICAgICB9CgogICAgICBpZiAodGhpcy5jb25uZWN0b3IpIHsKICAgICAgICB0aGlzLmNvbm5lY3Rvcih0YXJnZXROYW1lLCBjYXRlZ29yeSwgbGFiZWwsIGNvbnRlbnQpOwogICAgICB9CiAgICB9CiAgfTsKfSk7CgpMb2dnZXJGYWN0b3J5LnByb3RvdHlwZS5nZXRMb2dnZXIgPSBmdW5jdGlvbihjYXRlZ29yeSwgbGFiZWwpIHsKICB2YXIgbG9nZ2VyOwoKICBpZiAobGFiZWwgJiYgdGhpcy5sZXZlbCA9PT0gMykgewogICAgcmV0dXJuIG5ldyBMb2dnZXIodGhpcywgY2F0ZWdvcnksIGxhYmVsKTsKICB9IGVsc2UgaWYgKHRoaXMubG9nZ2Vyc1tjYXRlZ29yeV0pIHsKICAgIHJldHVybiB0aGlzLmxvZ2dlcnNbY2F0ZWdvcnldOwogIH0gZWxzZSB7CiAgICBsb2dnZXIgPSBuZXcgTG9nZ2VyKHRoaXMsIGNhdGVnb3J5KTsKICAgIHRoaXMubG9nZ2Vyc1tjYXRlZ29yeV0gPSBsb2dnZXI7CiAgICByZXR1cm4gbG9nZ2VyOwogIH0KfTsKCnJldHVybiBMb2dnZXJGYWN0b3J5Owp9OwoKfSx7fV0sMjA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IE1lZGlhSGFuZGxlcgogKi8KCi8qIE1lZGlhSGFuZGxlcgogKiBAY2xhc3MgUGVlckNvbm5lY3Rpb24gaGVscGVyIENsYXNzLgogKiBAcGFyYW0ge1NJUC5TZXNzaW9ufSBzZXNzaW9uCiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10KICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEV2ZW50RW1pdHRlcikgewp2YXIgTWVkaWFIYW5kbGVyID0gZnVuY3Rpb24oc2Vzc2lvbiwgb3B0aW9ucykgewogIC8vIGtlZXAganNoaW50IGhhcHB5CiAgc2Vzc2lvbiA9IHNlc3Npb247CiAgb3B0aW9ucyA9IG9wdGlvbnM7Cn07CgpNZWRpYUhhbmRsZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFdmVudEVtaXR0ZXIucHJvdG90eXBlLCB7CiAgaXNSZWFkeToge3ZhbHVlOiBmdW5jdGlvbiBpc1JlYWR5ICgpIHt9fSwKCiAgY2xvc2U6IHt2YWx1ZTogZnVuY3Rpb24gY2xvc2UgKCkge319LAoKICAvKioKICAgKiBAcGFyYW0ge09iamVjdH0gW21lZGlhSGludF0gQSBjdXN0b20gb2JqZWN0IGRlc2NyaWJpbmcgdGhlIG1lZGlhIHRvIGJlIHVzZWQgZHVyaW5nIHRoaXMgc2Vzc2lvbi4KICAgKi8KICBnZXREZXNjcmlwdGlvbjoge3ZhbHVlOiBmdW5jdGlvbiBnZXREZXNjcmlwdGlvbiAobWVkaWFIaW50KSB7CiAgICAvLyBrZWVwIGpzaGludCBoYXBweQogICAgbWVkaWFIaW50ID0gbWVkaWFIaW50OwogIH19LAoKICAvKioKICAqIE1lc3NhZ2UgcmVjZXB0aW9uLgogICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKICAqIEBwYXJhbSB7U3RyaW5nfSBkZXNjcmlwdGlvbgogICovCiAgc2V0RGVzY3JpcHRpb246IHt2YWx1ZTogZnVuY3Rpb24gc2V0RGVzY3JpcHRpb24gKGRlc2NyaXB0aW9uKSB7CiAgICAvLyBrZWVwIGpzaGludCBoYXBweQogICAgZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjsKICB9fQp9KTsKCnJldHVybiBNZWRpYUhhbmRsZXI7Cn07Cgp9LHt9XSwyMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgU0lQIE5hbWVBZGRySGVhZGVyCiAqLwoKLyoqCiAqIEBhdWdtZW50cyBTSVAKICogQGNsYXNzIENsYXNzIGNyZWF0aW5nIGEgTmFtZSBBZGRyZXNzIFNJUCBoZWFkZXIuCiAqCiAqIEBwYXJhbSB7U0lQLlVSSX0gdXJpCiAqIEBwYXJhbSB7U3RyaW5nfSBbZGlzcGxheU5hbWVdCiAqIEBwYXJhbSB7T2JqZWN0fSBbcGFyYW1ldGVyc10KICoKICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewp2YXIgTmFtZUFkZHJIZWFkZXI7CgpOYW1lQWRkckhlYWRlciA9IGZ1bmN0aW9uKHVyaSwgZGlzcGxheU5hbWUsIHBhcmFtZXRlcnMpIHsKICB2YXIgcGFyYW07CgogIC8vIENoZWNrcwogIGlmKCF1cmkgfHwgISh1cmkgaW5zdGFuY2VvZiBTSVAuVVJJKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignbWlzc2luZyBvciBpbnZhbGlkICJ1cmkiIHBhcmFtZXRlcicpOwogIH0KCiAgLy8gSW5pdGlhbGl6ZSBwYXJhbWV0ZXJzCiAgdGhpcy51cmkgPSB1cmk7CiAgdGhpcy5wYXJhbWV0ZXJzID0ge307CgogIGZvciAocGFyYW0gaW4gcGFyYW1ldGVycykgewogICAgdGhpcy5zZXRQYXJhbShwYXJhbSwgcGFyYW1ldGVyc1twYXJhbV0pOwogIH0KCiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywgewogICAgZnJpZW5kbHlOYW1lOiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLmRpc3BsYXlOYW1lIHx8IHVyaS5hb3I7IH0KICAgIH0sCgogICAgZGlzcGxheU5hbWU6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIGRpc3BsYXlOYW1lOyB9LAogICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgZGlzcGxheU5hbWUgPSAodmFsdWUgPT09IDApID8gJzAnIDogdmFsdWU7CiAgICAgIH0KICAgIH0KICB9KTsKfTsKTmFtZUFkZHJIZWFkZXIucHJvdG90eXBlID0gewogIHNldFBhcmFtOiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgaWYoa2V5KSB7CiAgICAgIHRoaXMucGFyYW1ldGVyc1trZXkudG9Mb3dlckNhc2UoKV0gPSAodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyB8fCB2YWx1ZSA9PT0gbnVsbCkgPyBudWxsIDogdmFsdWUudG9TdHJpbmcoKTsKICAgIH0KICB9LAogIGdldFBhcmFtOiBTSVAuVVJJLnByb3RvdHlwZS5nZXRQYXJhbSwKICBoYXNQYXJhbTogU0lQLlVSSS5wcm90b3R5cGUuaGFzUGFyYW0sCiAgZGVsZXRlUGFyYW06IFNJUC5VUkkucHJvdG90eXBlLmRlbGV0ZVBhcmFtLAogIGNsZWFyUGFyYW1zOiBTSVAuVVJJLnByb3RvdHlwZS5jbGVhclBhcmFtcywKCiAgY2xvbmU6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIG5ldyBOYW1lQWRkckhlYWRlcigKICAgICAgdGhpcy51cmkuY2xvbmUoKSwKICAgICAgdGhpcy5kaXNwbGF5TmFtZSwKICAgICAgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnBhcmFtZXRlcnMpKSk7CiAgfSwKCiAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgdmFyIGJvZHksIHBhcmFtZXRlcjsKCiAgICBib2R5ICA9ICh0aGlzLmRpc3BsYXlOYW1lIHx8IHRoaXMuZGlzcGxheU5hbWUgPT09IDApID8gJyInICsgdGhpcy5kaXNwbGF5TmFtZSArICciICcgOiAnJzsKICAgIGJvZHkgKz0gJzwnICsgdGhpcy51cmkudG9TdHJpbmcoKSArICc+JzsKCiAgICBmb3IgKHBhcmFtZXRlciBpbiB0aGlzLnBhcmFtZXRlcnMpIHsKICAgICAgYm9keSArPSAnOycgKyBwYXJhbWV0ZXI7CgogICAgICBpZiAodGhpcy5wYXJhbWV0ZXJzW3BhcmFtZXRlcl0gIT09IG51bGwpIHsKICAgICAgICBib2R5ICs9ICc9JysgdGhpcy5wYXJhbWV0ZXJzW3BhcmFtZXRlcl07CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gYm9keTsKICB9Cn07CgoKLyoqCiAgKiBQYXJzZSB0aGUgZ2l2ZW4gc3RyaW5nIGFuZCByZXR1cm5zIGEgU0lQLk5hbWVBZGRySGVhZGVyIGluc3RhbmNlIG9yIHVuZGVmaW5lZCBpZgogICogaXQgaXMgYW4gaW52YWxpZCBOYW1lQWRkckhlYWRlci4KICAqIEBwdWJsaWMKICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lX2FkZHJfaGVhZGVyCiAgKi8KTmFtZUFkZHJIZWFkZXIucGFyc2UgPSBmdW5jdGlvbihuYW1lX2FkZHJfaGVhZGVyKSB7CiAgbmFtZV9hZGRyX2hlYWRlciA9IFNJUC5HcmFtbWFyLnBhcnNlKG5hbWVfYWRkcl9oZWFkZXIsJ05hbWVfQWRkcl9IZWFkZXInKTsKCiAgaWYgKG5hbWVfYWRkcl9oZWFkZXIgIT09IC0xKSB7CiAgICByZXR1cm4gbmFtZV9hZGRyX2hlYWRlcjsKICB9IGVsc2UgewogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9Cn07CgpTSVAuTmFtZUFkZHJIZWFkZXIgPSBOYW1lQWRkckhlYWRlcjsKfTsKCn0se31dLDIyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBTSVAgTWVzc2FnZSBQYXJzZXIKICovCgovKioKICogRXh0cmFjdCBhbmQgcGFyc2UgZXZlcnkgaGVhZGVyIG9mIGEgU0lQIG1lc3NhZ2UuCiAqIEBhdWdtZW50cyBTSVAKICogQG5hbWVzcGFjZQogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CnZhciBQYXJzZXI7CgpmdW5jdGlvbiBnZXRIZWFkZXIoZGF0YSwgaGVhZGVyU3RhcnQpIHsKICB2YXIKICAgIC8vICdzdGFydCcgcG9zaXRpb24gb2YgdGhlIGhlYWRlci4KICAgIHN0YXJ0ID0gaGVhZGVyU3RhcnQsCiAgICAvLyAnZW5kJyBwb3NpdGlvbiBvZiB0aGUgaGVhZGVyLgogICAgZW5kID0gMCwKICAgIC8vICdwYXJ0aWFsIGVuZCcgcG9zaXRpb24gb2YgdGhlIGhlYWRlci4KICAgIHBhcnRpYWxFbmQgPSAwOwoKICAvL0VuZCBvZiBtZXNzYWdlLgogIGlmIChkYXRhLnN1YnN0cmluZyhzdGFydCwgc3RhcnQgKyAyKS5tYXRjaCgvKF5cclxuKS8pKSB7CiAgICByZXR1cm4gLTI7CiAgfQoKICB3aGlsZShlbmQgPT09IDApIHsKICAgIC8vIFBhcnRpYWwgRW5kIG9mIEhlYWRlci4KICAgIHBhcnRpYWxFbmQgPSBkYXRhLmluZGV4T2YoJ1xyXG4nLCBzdGFydCk7CgogICAgLy8gJ2luZGV4T2YnIHJldHVybnMgLTEgaWYgdGhlIHZhbHVlIHRvIGJlIGZvdW5kIG5ldmVyIG9jY3Vycy4KICAgIGlmIChwYXJ0aWFsRW5kID09PSAtMSkgewogICAgICByZXR1cm4gcGFydGlhbEVuZDsKICAgIH0KCiAgICBpZighZGF0YS5zdWJzdHJpbmcocGFydGlhbEVuZCArIDIsIHBhcnRpYWxFbmQgKyA0KS5tYXRjaCgvKF5cclxuKS8pICYmIGRhdGEuY2hhckF0KHBhcnRpYWxFbmQgKyAyKS5tYXRjaCgvKF5ccyspLykpIHsKICAgICAgLy8gTm90IHRoZSBlbmQgb2YgdGhlIG1lc3NhZ2UuIENvbnRpbnVlIGZyb20gdGhlIG5leHQgcG9zaXRpb24uCiAgICAgIHN0YXJ0ID0gcGFydGlhbEVuZCArIDI7CiAgICB9IGVsc2UgewogICAgICBlbmQgPSBwYXJ0aWFsRW5kOwogICAgfQogIH0KCiAgcmV0dXJuIGVuZDsKfQoKZnVuY3Rpb24gcGFyc2VIZWFkZXIobWVzc2FnZSwgZGF0YSwgaGVhZGVyU3RhcnQsIGhlYWRlckVuZCkgewogIHZhciBoZWFkZXIsIGlkeCwgbGVuZ3RoLCBwYXJzZWQsCiAgICBoY29sb25JbmRleCA9IGRhdGEuaW5kZXhPZignOicsIGhlYWRlclN0YXJ0KSwKICAgIGhlYWRlck5hbWUgPSBkYXRhLnN1YnN0cmluZyhoZWFkZXJTdGFydCwgaGNvbG9uSW5kZXgpLnRyaW0oKSwKICAgIGhlYWRlclZhbHVlID0gZGF0YS5zdWJzdHJpbmcoaGNvbG9uSW5kZXggKyAxLCBoZWFkZXJFbmQpLnRyaW0oKTsKCiAgLy8gSWYgaGVhZGVyLWZpZWxkIGlzIHdlbGwta25vd24sIHBhcnNlIGl0LgogIHN3aXRjaChoZWFkZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHsKICAgIGNhc2UgJ3ZpYSc6CiAgICBjYXNlICd2JzoKICAgICAgbWVzc2FnZS5hZGRIZWFkZXIoJ3ZpYScsIGhlYWRlclZhbHVlKTsKICAgICAgaWYobWVzc2FnZS5nZXRIZWFkZXJzKCd2aWEnKS5sZW5ndGggPT09IDEpIHsKICAgICAgICBwYXJzZWQgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCdWaWEnKTsKICAgICAgICBpZihwYXJzZWQpIHsKICAgICAgICAgIG1lc3NhZ2UudmlhID0gcGFyc2VkOwogICAgICAgICAgbWVzc2FnZS52aWFfYnJhbmNoID0gcGFyc2VkLmJyYW5jaDsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcGFyc2VkID0gMDsKICAgICAgfQogICAgICBicmVhazsKICAgIGNhc2UgJ2Zyb20nOgogICAgY2FzZSAnZic6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCdmcm9tJywgaGVhZGVyVmFsdWUpOwogICAgICBwYXJzZWQgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCdmcm9tJyk7CiAgICAgIGlmKHBhcnNlZCkgewogICAgICAgIG1lc3NhZ2UuZnJvbSA9IHBhcnNlZDsKICAgICAgICBtZXNzYWdlLmZyb21fdGFnID0gcGFyc2VkLmdldFBhcmFtKCd0YWcnKTsKICAgICAgfQogICAgICBicmVhazsKICAgIGNhc2UgJ3RvJzoKICAgIGNhc2UgJ3QnOgogICAgICBtZXNzYWdlLnNldEhlYWRlcigndG8nLCBoZWFkZXJWYWx1ZSk7CiAgICAgIHBhcnNlZCA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ3RvJyk7CiAgICAgIGlmKHBhcnNlZCkgewogICAgICAgIG1lc3NhZ2UudG8gPSBwYXJzZWQ7CiAgICAgICAgbWVzc2FnZS50b190YWcgPSBwYXJzZWQuZ2V0UGFyYW0oJ3RhZycpOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSAncmVjb3JkLXJvdXRlJzoKICAgICAgcGFyc2VkID0gU0lQLkdyYW1tYXIucGFyc2UoaGVhZGVyVmFsdWUsICdSZWNvcmRfUm91dGUnKTsKCiAgICAgIGlmIChwYXJzZWQgPT09IC0xKSB7CiAgICAgICAgcGFyc2VkID0gdW5kZWZpbmVkOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBsZW5ndGggPSBwYXJzZWQubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBoZWFkZXIgPSBwYXJzZWRbaWR4XTsKICAgICAgICBtZXNzYWdlLmFkZEhlYWRlcigncmVjb3JkLXJvdXRlJywgaGVhZGVyVmFsdWUuc3Vic3RyaW5nKGhlYWRlci5wb3NpdGlvbiwgaGVhZGVyLm9mZnNldCkpOwogICAgICAgIG1lc3NhZ2UuaGVhZGVyc1snUmVjb3JkLVJvdXRlJ11bbWVzc2FnZS5nZXRIZWFkZXJzKCdyZWNvcmQtcm91dGUnKS5sZW5ndGggLSAxXS5wYXJzZWQgPSBoZWFkZXIucGFyc2VkOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSAnY2FsbC1pZCc6CiAgICBjYXNlICdpJzoKICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoJ2NhbGwtaWQnLCBoZWFkZXJWYWx1ZSk7CiAgICAgIHBhcnNlZCA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ2NhbGwtaWQnKTsKICAgICAgaWYocGFyc2VkKSB7CiAgICAgICAgbWVzc2FnZS5jYWxsX2lkID0gaGVhZGVyVmFsdWU7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlICdjb250YWN0JzoKICAgIGNhc2UgJ20nOgogICAgICBwYXJzZWQgPSBTSVAuR3JhbW1hci5wYXJzZShoZWFkZXJWYWx1ZSwgJ0NvbnRhY3QnKTsKCiAgICAgIGlmIChwYXJzZWQgPT09IC0xKSB7CiAgICAgICAgcGFyc2VkID0gdW5kZWZpbmVkOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBsZW5ndGggPSBwYXJzZWQubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBoZWFkZXIgPSBwYXJzZWRbaWR4XTsKICAgICAgICBtZXNzYWdlLmFkZEhlYWRlcignY29udGFjdCcsIGhlYWRlclZhbHVlLnN1YnN0cmluZyhoZWFkZXIucG9zaXRpb24sIGhlYWRlci5vZmZzZXQpKTsKICAgICAgICBtZXNzYWdlLmhlYWRlcnNbJ0NvbnRhY3QnXVttZXNzYWdlLmdldEhlYWRlcnMoJ2NvbnRhY3QnKS5sZW5ndGggLSAxXS5wYXJzZWQgPSBoZWFkZXIucGFyc2VkOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSAnY29udGVudC1sZW5ndGgnOgogICAgY2FzZSAnbCc6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCdjb250ZW50LWxlbmd0aCcsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcignY29udGVudC1sZW5ndGgnKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdjb250ZW50LXR5cGUnOgogICAgY2FzZSAnYyc6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCdjb250ZW50LXR5cGUnLCBoZWFkZXJWYWx1ZSk7CiAgICAgIHBhcnNlZCA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ2NvbnRlbnQtdHlwZScpOwogICAgICBicmVhazsKICAgIGNhc2UgJ2NzZXEnOgogICAgICBtZXNzYWdlLnNldEhlYWRlcignY3NlcScsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcignY3NlcScpOwogICAgICBpZihwYXJzZWQpIHsKICAgICAgICBtZXNzYWdlLmNzZXEgPSBwYXJzZWQudmFsdWU7CiAgICAgIH0KICAgICAgaWYobWVzc2FnZSBpbnN0YW5jZW9mIFNJUC5JbmNvbWluZ1Jlc3BvbnNlKSB7CiAgICAgICAgbWVzc2FnZS5tZXRob2QgPSBwYXJzZWQubWV0aG9kOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSAnbWF4LWZvcndhcmRzJzoKICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoJ21heC1mb3J3YXJkcycsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcignbWF4LWZvcndhcmRzJyk7CiAgICAgIGJyZWFrOwogICAgY2FzZSAnd3d3LWF1dGhlbnRpY2F0ZSc6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCd3d3ctYXV0aGVudGljYXRlJywgaGVhZGVyVmFsdWUpOwogICAgICBwYXJzZWQgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCd3d3ctYXV0aGVudGljYXRlJyk7CiAgICAgIGJyZWFrOwogICAgY2FzZSAncHJveHktYXV0aGVudGljYXRlJzoKICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoJ3Byb3h5LWF1dGhlbnRpY2F0ZScsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcigncHJveHktYXV0aGVudGljYXRlJyk7CiAgICAgIGJyZWFrOwogICAgY2FzZSAncmVmZXItdG8nOgogICAgY2FzZSAncic6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCdyZWZlci10bycsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcigncmVmZXItdG8nKTsKICAgICAgaWYgKHBhcnNlZCkgewogICAgICAgIG1lc3NhZ2UucmVmZXJfdG8gPSBwYXJzZWQ7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgogICAgICAvLyBEbyBub3QgcGFyc2UgdGhpcyBoZWFkZXIuCiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKGhlYWRlck5hbWUsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gMDsKICB9CgogIGlmIChwYXJzZWQgPT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuIHsKICAgICAgZXJyb3I6ICdlcnJvciBwYXJzaW5nIGhlYWRlciAiJysgaGVhZGVyTmFtZSArJyInCiAgICB9OwogIH0gZWxzZSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCi8qKiBQYXJzZSBTSVAgTWVzc2FnZQogKiBAZnVuY3Rpb24KICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2UgU0lQIG1lc3NhZ2UuCiAqIEBwYXJhbSB7T2JqZWN0fSBsb2dnZXIgb2JqZWN0LgogKiBAcmV0dXJucyB7U0lQLkluY29taW5nUmVxdWVzdHxTSVAuSW5jb21pbmdSZXNwb25zZXx1bmRlZmluZWR9CiAqLwpQYXJzZXIgPSB7fTsKUGFyc2VyLnBhcnNlTWVzc2FnZSA9IGZ1bmN0aW9uKGRhdGEsIHVhKSB7CiAgdmFyIG1lc3NhZ2UsIGZpcnN0TGluZSwgY29udGVudExlbmd0aCwgYm9keVN0YXJ0LCBwYXJzZWQsCiAgICBoZWFkZXJTdGFydCA9IDAsCiAgICBoZWFkZXJFbmQgPSBkYXRhLmluZGV4T2YoJ1xyXG4nKSwKICAgIGxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnBhcnNlcicpOwoKICBpZihoZWFkZXJFbmQgPT09IC0xKSB7CiAgICBsb2dnZXIud2Fybignbm8gQ1JMRiBmb3VuZCwgbm90IGEgU0lQIG1lc3NhZ2UsIGRpc2NhcmRlZCcpOwogICAgcmV0dXJuOwogIH0KCiAgLy8gUGFyc2UgZmlyc3QgbGluZS4gQ2hlY2sgaWYgaXQgaXMgYSBSZXF1ZXN0IG9yIGEgUmVwbHkuCiAgZmlyc3RMaW5lID0gZGF0YS5zdWJzdHJpbmcoMCwgaGVhZGVyRW5kKTsKICBwYXJzZWQgPSBTSVAuR3JhbW1hci5wYXJzZShmaXJzdExpbmUsICdSZXF1ZXN0X1Jlc3BvbnNlJyk7CgogIGlmKHBhcnNlZCA9PT0gLTEpIHsKICAgIGxvZ2dlci53YXJuKCdlcnJvciBwYXJzaW5nIGZpcnN0IGxpbmUgb2YgU0lQIG1lc3NhZ2U6ICInICsgZmlyc3RMaW5lICsgJyInKTsKICAgIHJldHVybjsKICB9IGVsc2UgaWYoIXBhcnNlZC5zdGF0dXNfY29kZSkgewogICAgbWVzc2FnZSA9IG5ldyBTSVAuSW5jb21pbmdSZXF1ZXN0KHVhKTsKICAgIG1lc3NhZ2UubWV0aG9kID0gcGFyc2VkLm1ldGhvZDsKICAgIG1lc3NhZ2UucnVyaSA9IHBhcnNlZC51cmk7CiAgfSBlbHNlIHsKICAgIG1lc3NhZ2UgPSBuZXcgU0lQLkluY29taW5nUmVzcG9uc2UodWEpOwogICAgbWVzc2FnZS5zdGF0dXNfY29kZSA9IHBhcnNlZC5zdGF0dXNfY29kZTsKICAgIG1lc3NhZ2UucmVhc29uX3BocmFzZSA9IHBhcnNlZC5yZWFzb25fcGhyYXNlOwogIH0KCiAgbWVzc2FnZS5kYXRhID0gZGF0YTsKICBoZWFkZXJTdGFydCA9IGhlYWRlckVuZCArIDI7CgogIC8qIExvb3Agb3ZlciBldmVyeSBsaW5lIGluIGRhdGEuIERldGVjdCB0aGUgZW5kIG9mIGVhY2ggaGVhZGVyIGFuZCBwYXJzZQogICogaXQgb3Igc2ltcGx5IGFkZCB0byB0aGUgaGVhZGVycyBjb2xsZWN0aW9uLgogICovCiAgd2hpbGUodHJ1ZSkgewogICAgaGVhZGVyRW5kID0gZ2V0SGVhZGVyKGRhdGEsIGhlYWRlclN0YXJ0KTsKCiAgICAvLyBUaGUgU0lQIG1lc3NhZ2UgaGFzIG5vcm1hbGx5IGZpbmlzaGVkLgogICAgaWYoaGVhZGVyRW5kID09PSAtMikgewogICAgICBib2R5U3RhcnQgPSBoZWFkZXJTdGFydCArIDI7CiAgICAgIGJyZWFrOwogICAgfQogICAgLy8gZGF0YS5pbmRleE9mIHJldHVybmVkIC0xIGR1ZSB0byBhIG1hbGZvcm1lZCBtZXNzYWdlLgogICAgZWxzZSBpZihoZWFkZXJFbmQgPT09IC0xKSB7CiAgICAgIGxvZ2dlci5lcnJvcignbWFsZm9ybWVkIG1lc3NhZ2UnKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHBhcnNlZCA9IHBhcnNlSGVhZGVyKG1lc3NhZ2UsIGRhdGEsIGhlYWRlclN0YXJ0LCBoZWFkZXJFbmQpOwoKICAgIGlmKHBhcnNlZCAhPT0gdHJ1ZSkgewogICAgICBsb2dnZXIuZXJyb3IocGFyc2VkLmVycm9yKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGhlYWRlclN0YXJ0ID0gaGVhZGVyRW5kICsgMjsKICB9CgogIC8qIFJGQzMyNjEgMTguMy4KICAgKiBJZiB0aGVyZSBhcmUgYWRkaXRpb25hbCBieXRlcyBpbiB0aGUgdHJhbnNwb3J0IHBhY2tldAogICAqIGJleW9uZCB0aGUgZW5kIG9mIHRoZSBib2R5LCB0aGV5IE1VU1QgYmUgZGlzY2FyZGVkLgogICAqLwogIGlmKG1lc3NhZ2UuaGFzSGVhZGVyKCdjb250ZW50LWxlbmd0aCcpKSB7CiAgICBjb250ZW50TGVuZ3RoID0gbWVzc2FnZS5nZXRIZWFkZXIoJ2NvbnRlbnQtbGVuZ3RoJyk7CiAgICBtZXNzYWdlLmJvZHkgPSBkYXRhLnN1YnN0cihib2R5U3RhcnQsIGNvbnRlbnRMZW5ndGgpOwogIH0gZWxzZSB7CiAgICBtZXNzYWdlLmJvZHkgPSBkYXRhLnN1YnN0cmluZyhib2R5U3RhcnQpOwogIH0KCiAgcmV0dXJuIG1lc3NhZ2U7Cn07CgpTSVAuUGFyc2VyID0gUGFyc2VyOwp9OwoKfSx7fV0sMjM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewoKdmFyIFJlZ2lzdGVyQ29udGV4dDsKClJlZ2lzdGVyQ29udGV4dCA9IGZ1bmN0aW9uICh1YSkgewogIHZhciBwYXJhbXMgPSB7fSwKICAgICAgcmVnSWQgPSAxOwoKICB0aGlzLnJlZ2lzdHJhciA9IHVhLmNvbmZpZ3VyYXRpb24ucmVnaXN0cmFyU2VydmVyOwogIHRoaXMuZXhwaXJlcyA9IHVhLmNvbmZpZ3VyYXRpb24ucmVnaXN0ZXJFeHBpcmVzOwoKCiAgLy8gQ29udGFjdCBoZWFkZXIKICB0aGlzLmNvbnRhY3QgPSB1YS5jb250YWN0LnRvU3RyaW5nKCk7CgogIGlmKHJlZ0lkKSB7CiAgICB0aGlzLmNvbnRhY3QgKz0gJztyZWctaWQ9JysgcmVnSWQ7CiAgICB0aGlzLmNvbnRhY3QgKz0gJzsrc2lwLmluc3RhbmNlPSI8dXJuOnV1aWQ6JysgdWEuY29uZmlndXJhdGlvbi5pbnN0YW5jZUlkKyc+Iic7CiAgfQoKICAvLyBDYWxsLUlEIGFuZCBDU2VxIHZhbHVlcyBSRkMzMjYxIDEwLjIKICB0aGlzLmNhbGxfaWQgPSBTSVAuVXRpbHMuY3JlYXRlUmFuZG9tVG9rZW4oMjIpOwogIHRoaXMuY3NlcSA9IDgwOwoKICB0aGlzLnRvX3VyaSA9IHVhLmNvbmZpZ3VyYXRpb24udXJpOwoKICBwYXJhbXMudG9fdXJpID0gdGhpcy50b191cmk7CiAgcGFyYW1zLnRvX2Rpc3BsYXlOYW1lID0gdWEuY29uZmlndXJhdGlvbi5kaXNwbGF5TmFtZTsKICBwYXJhbXMuY2FsbF9pZCA9IHRoaXMuY2FsbF9pZDsKICBwYXJhbXMuY3NlcSA9IHRoaXMuY3NlcTsKCiAgLy8gRXh0ZW5kcyBDbGllbnRDb250ZXh0CiAgU0lQLlV0aWxzLmF1Z21lbnQodGhpcywgU0lQLkNsaWVudENvbnRleHQsIFt1YSwgJ1JFR0lTVEVSJywgdGhpcy5yZWdpc3RyYXIsIHtwYXJhbXM6IHBhcmFtc31dKTsKCiAgdGhpcy5yZWdpc3RyYXRpb25UaW1lciA9IG51bGw7CiAgdGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIgPSBudWxsOwoKICAvLyBTZXQgc3RhdHVzCiAgdGhpcy5yZWdpc3RlcmVkID0gZmFsc2U7CgogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAucmVnaXN0ZXJjb250ZXh0Jyk7Cn07CgpSZWdpc3RlckNvbnRleHQucHJvdG90eXBlID0gewogIHJlZ2lzdGVyOiBmdW5jdGlvbiAob3B0aW9ucykgewogICAgdmFyIHNlbGYgPSB0aGlzLCBleHRyYUhlYWRlcnM7CgogICAgLy8gSGFuZGxlIE9wdGlvbnMKICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgICBleHRyYUhlYWRlcnMgPSAodGhpcy5vcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250YWN0OiAnICsgdGhpcy5jb250YWN0ICsgJztleHBpcmVzPScgKyB0aGlzLmV4cGlyZXMpOwogICAgZXh0cmFIZWFkZXJzLnB1c2goJ0FsbG93OiAnICsgU0lQLlVBLkMuQUxMT1dFRF9NRVRIT0RTLnRvU3RyaW5nKCkpOwoKICAgIC8vIFNhdmUgb3JpZ2luYWwgZXh0cmFIZWFkZXJzIHRvIGJlIHVzZWQgaW4gLmNsb3NlCiAgICB0aGlzLmNsb3NlSGVhZGVycyA9IHRoaXMub3B0aW9ucy5jbG9zZVdpdGhIZWFkZXJzID8KICAgICAgKHRoaXMub3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCkgOiBbXTsKCiAgICB0aGlzLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgIHZhciBjb250YWN0LCBleHBpcmVzLAogICAgICAgIGNvbnRhY3RzID0gcmVzcG9uc2UuZ2V0SGVhZGVycygnY29udGFjdCcpLmxlbmd0aCwKICAgICAgICBjYXVzZTsKCiAgICAgIC8vIERpc2NhcmQgcmVzcG9uc2VzIHRvIG9sZGVyIFJFR0lTVEVSL3VuLVJFR0lTVEVSIHJlcXVlc3RzLgogICAgICBpZihyZXNwb25zZS5jc2VxICE9PSB0aGlzLmNzZXEpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIENsZWFyIHJlZ2lzdHJhdGlvbiB0aW1lcgogICAgICBpZiAodGhpcy5yZWdpc3RyYXRpb25UaW1lciAhPT0gbnVsbCkgewogICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVnaXN0cmF0aW9uVGltZXIpOwogICAgICAgIHRoaXMucmVnaXN0cmF0aW9uVGltZXIgPSBudWxsOwogICAgICB9CgogICAgICBzd2l0Y2godHJ1ZSkgewogICAgICAgIGNhc2UgL14xWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIC9eMlswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgICB0aGlzLmVtaXQoJ2FjY2VwdGVkJywgcmVzcG9uc2UpOwoKICAgICAgICAgIGlmKHJlc3BvbnNlLmhhc0hlYWRlcignZXhwaXJlcycpKSB7CiAgICAgICAgICAgIGV4cGlyZXMgPSByZXNwb25zZS5nZXRIZWFkZXIoJ2V4cGlyZXMnKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIgIT09IG51bGwpIHsKICAgICAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIpOwogICAgICAgICAgICB0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lciA9IG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gU2VhcmNoIHRoZSBDb250YWN0IHBvaW50aW5nIHRvIHVzIGFuZCB1cGRhdGUgdGhlIGV4cGlyZXMgdmFsdWUgYWNjb3JkaW5nbHkuCiAgICAgICAgICBpZiAoIWNvbnRhY3RzKSB7CiAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ25vIENvbnRhY3QgaGVhZGVyIGluIHJlc3BvbnNlIHRvIFJFR0lTVEVSLCByZXNwb25zZSBpZ25vcmVkJyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIHdoaWxlKGNvbnRhY3RzLS0pIHsKICAgICAgICAgICAgY29udGFjdCA9IHJlc3BvbnNlLnBhcnNlSGVhZGVyKCdjb250YWN0JywgY29udGFjdHMpOwogICAgICAgICAgICBpZihjb250YWN0LnVyaS51c2VyID09PSB0aGlzLnVhLmNvbnRhY3QudXJpLnVzZXIpIHsKICAgICAgICAgICAgICBleHBpcmVzID0gY29udGFjdC5nZXRQYXJhbSgnZXhwaXJlcycpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnRhY3QgPSBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFjb250YWN0KSB7CiAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ25vIENvbnRhY3QgaGVhZGVyIHBvaW50aW5nIHRvIHVzLCByZXNwb25zZSBpZ25vcmVkJyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmKCFleHBpcmVzKSB7CiAgICAgICAgICAgIGV4cGlyZXMgPSB0aGlzLmV4cGlyZXM7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gUmUtUmVnaXN0ZXIgYmVmb3JlIHRoZSBleHBpcmF0aW9uIGludGVydmFsIGhhcyBlbGFwc2VkLgogICAgICAgICAgLy8gRm9yIHRoYXQsIGRlY3JlYXNlIHRoZSBleHBpcmVzIHZhbHVlLiBpZTogMyBzZWNvbmRzCiAgICAgICAgICB0aGlzLnJlZ2lzdHJhdGlvblRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICBzZWxmLnJlZ2lzdHJhdGlvblRpbWVyID0gbnVsbDsKICAgICAgICAgICAgc2VsZi5yZWdpc3RlcihzZWxmLm9wdGlvbnMpOwogICAgICAgICAgfSwgKGV4cGlyZXMgKiAxMDAwKSAtIDMwMDApOwogICAgICAgICAgdGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzZWxmLmxvZ2dlci53YXJuKCdyZWdpc3RyYXRpb24gZXhwaXJlZCcpOwogICAgICAgICAgICBpZiAoc2VsZi5yZWdpc3RlcmVkKSB7CiAgICAgICAgICAgICAgc2VsZi51bnJlZ2lzdGVyZWQobnVsbCwgU0lQLkMuY2F1c2VzLkVYUElSRVMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LCBleHBpcmVzICogMTAwMCk7CgogICAgICAgICAgLy9TYXZlIGdydXUgdmFsdWVzCiAgICAgICAgICBpZiAoY29udGFjdC5oYXNQYXJhbSgndGVtcC1ncnV1JykpIHsKICAgICAgICAgICAgdGhpcy51YS5jb250YWN0LnRlbXBfZ3J1dSA9IFNJUC5VUkkucGFyc2UoY29udGFjdC5nZXRQYXJhbSgndGVtcC1ncnV1JykucmVwbGFjZSgvIi9nLCcnKSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoY29udGFjdC5oYXNQYXJhbSgncHViLWdydXUnKSkgewogICAgICAgICAgICB0aGlzLnVhLmNvbnRhY3QucHViX2dydXUgPSBTSVAuVVJJLnBhcnNlKGNvbnRhY3QuZ2V0UGFyYW0oJ3B1Yi1ncnV1JykucmVwbGFjZSgvIi9nLCcnKSk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5yZWdpc3RlcmVkID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuZW1pdCgncmVnaXN0ZXJlZCcsIHJlc3BvbnNlIHx8IG51bGwpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgLy8gSW50ZXJ2YWwgdG9vIGJyaWVmIFJGQzMyNjEgMTAuMi44CiAgICAgICAgY2FzZSAvXjQyMyQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgICAgaWYocmVzcG9uc2UuaGFzSGVhZGVyKCdtaW4tZXhwaXJlcycpKSB7CiAgICAgICAgICAgIC8vIEluY3JlYXNlIG91ciByZWdpc3RyYXRpb24gaW50ZXJ2YWwgdG8gdGhlIHN1Z2dlc3RlZCBtaW5pbXVtCiAgICAgICAgICAgIHRoaXMuZXhwaXJlcyA9IHJlc3BvbnNlLmdldEhlYWRlcignbWluLWV4cGlyZXMnKTsKICAgICAgICAgICAgLy8gQXR0ZW1wdCB0aGUgcmVnaXN0cmF0aW9uIGFnYWluIGltbWVkaWF0ZWx5CiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXIodGhpcy5vcHRpb25zKTsKICAgICAgICAgIH0gZWxzZSB7IC8vVGhpcyByZXNwb25zZSBNVVNUIGNvbnRhaW4gYSBNaW4tRXhwaXJlcyBoZWFkZXIgZmllbGQKICAgICAgICAgICAgdGhpcy5sb2dnZXIud2FybignNDIzIHJlc3BvbnNlIHJlY2VpdmVkIGZvciBSRUdJU1RFUiB3aXRob3V0IE1pbi1FeHBpcmVzJyk7CiAgICAgICAgICAgIHRoaXMucmVnaXN0cmF0aW9uRmFpbHVyZShyZXNwb25zZSwgU0lQLkMuY2F1c2VzLlNJUF9GQUlMVVJFX0NPREUpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGNhdXNlID0gU0lQLlV0aWxzLnNpcEVycm9yQ2F1c2UocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOwogICAgICAgICAgdGhpcy5yZWdpc3RyYXRpb25GYWlsdXJlKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgIH0KICAgIH07CgogICAgdGhpcy5vblJlcXVlc3RUaW1lb3V0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMucmVnaXN0cmF0aW9uRmFpbHVyZShudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH07CgogICAgdGhpcy5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMucmVnaXN0cmF0aW9uRmFpbHVyZShudWxsLCBTSVAuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICB9OwoKICAgIHRoaXMuY3NlcSsrOwogICAgdGhpcy5yZXF1ZXN0LmNzZXEgPSB0aGlzLmNzZXE7CiAgICB0aGlzLnJlcXVlc3Quc2V0SGVhZGVyKCdjc2VxJywgdGhpcy5jc2VxICsgJyBSRUdJU1RFUicpOwogICAgdGhpcy5yZXF1ZXN0LmV4dHJhSGVhZGVycyA9IGV4dHJhSGVhZGVyczsKICAgIHRoaXMuc2VuZCgpOwogIH0sCgogIHJlZ2lzdHJhdGlvbkZhaWx1cmU6IGZ1bmN0aW9uIChyZXNwb25zZSwgY2F1c2UpIHsKICAgIHRoaXMuZW1pdCgnZmFpbGVkJywgcmVzcG9uc2UgfHwgbnVsbCwgY2F1c2UgfHwgbnVsbCk7CiAgfSwKCiAgb25UcmFuc3BvcnRDbG9zZWQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5yZWdpc3RlcmVkX2JlZm9yZSA9IHRoaXMucmVnaXN0ZXJlZDsKICAgIGlmICh0aGlzLnJlZ2lzdHJhdGlvblRpbWVyICE9PSBudWxsKSB7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVnaXN0cmF0aW9uVGltZXIpOwogICAgICB0aGlzLnJlZ2lzdHJhdGlvblRpbWVyID0gbnVsbDsKICAgIH0KCiAgICBpZiAodGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIgIT09IG51bGwpIHsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIpOwogICAgICB0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lciA9IG51bGw7CiAgICB9CgogICAgaWYodGhpcy5yZWdpc3RlcmVkKSB7CiAgICAgIHRoaXMudW5yZWdpc3RlcmVkKG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgIH0KICB9LAoKICBvblRyYW5zcG9ydENvbm5lY3RlZDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLnJlZ2lzdGVyKHRoaXMub3B0aW9ucyk7CiAgfSwKCiAgY2xvc2U6IGZ1bmN0aW9uKCkgewogICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgIGFsbDogZmFsc2UsCiAgICAgIGV4dHJhSGVhZGVyczogdGhpcy5jbG9zZUhlYWRlcnMKICAgIH07CgogICAgdGhpcy5yZWdpc3RlcmVkX2JlZm9yZSA9IHRoaXMucmVnaXN0ZXJlZDsKICAgIHRoaXMudW5yZWdpc3RlcihvcHRpb25zKTsKICB9LAoKICB1bnJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICB2YXIgZXh0cmFIZWFkZXJzOwoKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIGlmKCF0aGlzLnJlZ2lzdGVyZWQgJiYgIW9wdGlvbnMuYWxsKSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ2FscmVhZHkgdW5yZWdpc3RlcmVkJyk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBleHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCk7CgogICAgdGhpcy5yZWdpc3RlcmVkID0gZmFsc2U7CgogICAgLy8gQ2xlYXIgdGhlIHJlZ2lzdHJhdGlvbiB0aW1lci4KICAgIGlmICh0aGlzLnJlZ2lzdHJhdGlvblRpbWVyICE9PSBudWxsKSB7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVnaXN0cmF0aW9uVGltZXIpOwogICAgICB0aGlzLnJlZ2lzdHJhdGlvblRpbWVyID0gbnVsbDsKICAgIH0KCiAgICBpZihvcHRpb25zLmFsbCkgewogICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogKicpOwogICAgICBleHRyYUhlYWRlcnMucHVzaCgnRXhwaXJlczogMCcpOwogICAgfSBlbHNlIHsKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcrIHRoaXMuY29udGFjdCArICc7ZXhwaXJlcz0wJyk7CiAgICB9CgoKICAgIHRoaXMucmVjZWl2ZVJlc3BvbnNlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgdmFyIGNhdXNlOwoKICAgICAgc3dpdGNoKHRydWUpIHsKICAgICAgICBjYXNlIC9eMVswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAvXjJbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgICAgdGhpcy5lbWl0KCdhY2NlcHRlZCcsIHJlc3BvbnNlKTsKICAgICAgICAgIGlmICh0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lciAhPT0gbnVsbCkgewogICAgICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lcik7CiAgICAgICAgICAgIHRoaXMucmVnaXN0cmF0aW9uRXhwaXJlZFRpbWVyID0gbnVsbDsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMudW5yZWdpc3RlcmVkKHJlc3BvbnNlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBjYXVzZSA9IFNJUC5VdGlscy5zaXBFcnJvckNhdXNlKHJlc3BvbnNlLnN0YXR1c19jb2RlKTsKICAgICAgICAgIHRoaXMudW5yZWdpc3RlcmVkKHJlc3BvbnNlLGNhdXNlKTsKICAgICAgfQogICAgfTsKCiAgICB0aGlzLm9uUmVxdWVzdFRpbWVvdXQgPSBmdW5jdGlvbigpIHsKICAgICAgLy8gTm90IGFjdHVhbGx5IHVucmVnaXN0ZXJlZC4uLgogICAgICAvL3RoaXMudW5yZWdpc3RlcmVkKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfTsKCiAgICB0aGlzLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICAgICAgLy8gTm90IGFjdHVhbGx5IHVucmVnaXN0ZXJlZC4uLgogICAgICAvL3RoaXMudW5yZWdpc3RlcmVkKG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgIH07CgogICAgdGhpcy5jc2VxKys7CiAgICB0aGlzLnJlcXVlc3QuY3NlcSA9IHRoaXMuY3NlcTsKICAgIHRoaXMucmVxdWVzdC5zZXRIZWFkZXIoJ2NzZXEnLCB0aGlzLmNzZXEgKyAnIFJFR0lTVEVSJyk7CiAgICB0aGlzLnJlcXVlc3QuZXh0cmFIZWFkZXJzID0gZXh0cmFIZWFkZXJzOwoKICAgIHRoaXMuc2VuZCgpOwogIH0sCgogIHVucmVnaXN0ZXJlZDogZnVuY3Rpb24ocmVzcG9uc2UsIGNhdXNlKSB7CiAgICB0aGlzLnJlZ2lzdGVyZWQgPSBmYWxzZTsKICAgIHRoaXMuZW1pdCgndW5yZWdpc3RlcmVkJywgcmVzcG9uc2UgfHwgbnVsbCwgY2F1c2UgfHwgbnVsbCk7CiAgfQoKfTsKCgpTSVAuUmVnaXN0ZXJDb250ZXh0ID0gUmVnaXN0ZXJDb250ZXh0Owp9OwoKfSx7fV0sMjQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgovKioKICogQGZpbGVvdmVydmlldyBSZXF1ZXN0IFNlbmRlcgogKi8KCi8qKgogKiBAYXVnbWVudHMgU0lQCiAqIEBjbGFzcyBDbGFzcyBjcmVhdGluZyBhIHJlcXVlc3Qgc2VuZGVyLgogKiBAcGFyYW0ge09iamVjdH0gYXBwbGljYW50CiAqIEBwYXJhbSB7U0lQLlVBfSB1YQogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CnZhciBSZXF1ZXN0U2VuZGVyOwoKUmVxdWVzdFNlbmRlciA9IGZ1bmN0aW9uKGFwcGxpY2FudCwgdWEpIHsKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnJlcXVlc3RzZW5kZXInKTsKICB0aGlzLnVhID0gdWE7CiAgdGhpcy5hcHBsaWNhbnQgPSBhcHBsaWNhbnQ7CiAgdGhpcy5tZXRob2QgPSBhcHBsaWNhbnQucmVxdWVzdC5tZXRob2Q7CiAgdGhpcy5yZXF1ZXN0ID0gYXBwbGljYW50LnJlcXVlc3Q7CiAgdGhpcy5jcmVkZW50aWFscyA9IG51bGw7CiAgdGhpcy5jaGFsbGVuZ2VkID0gZmFsc2U7CiAgdGhpcy5zdGFsZWQgPSBmYWxzZTsKCiAgLy8gSWYgdWEgaXMgaW4gY2xvc2luZyBwcm9jZXNzIG9yIGV2ZW4gY2xvc2VkIGp1c3QgYWxsb3cgc2VuZGluZyBCeWUgYW5kIEFDSwogIGlmICh1YS5zdGF0dXMgPT09IFNJUC5VQS5DLlNUQVRVU19VU0VSX0NMT1NFRCAmJiAodGhpcy5tZXRob2QgIT09IFNJUC5DLkJZRSB8fCB0aGlzLm1ldGhvZCAhPT0gU0lQLkMuQUNLKSkgewogICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgfQp9OwoKLyoqCiogQ3JlYXRlIHRoZSBjbGllbnQgdHJhbnNhY3Rpb24gYW5kIHNlbmQgdGhlIG1lc3NhZ2UuCiovClJlcXVlc3RTZW5kZXIucHJvdG90eXBlID0gewogIHNlbmQ6IGZ1bmN0aW9uKCkgewogICAgc3dpdGNoKHRoaXMubWV0aG9kKSB7CiAgICAgIGNhc2UgIklOVklURSI6CiAgICAgICAgdGhpcy5jbGllbnRUcmFuc2FjdGlvbiA9IG5ldyBTSVAuVHJhbnNhY3Rpb25zLkludml0ZUNsaWVudFRyYW5zYWN0aW9uKHRoaXMsIHRoaXMucmVxdWVzdCwgdGhpcy51YS50cmFuc3BvcnQpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJBQ0siOgogICAgICAgIHRoaXMuY2xpZW50VHJhbnNhY3Rpb24gPSBuZXcgU0lQLlRyYW5zYWN0aW9ucy5BY2tDbGllbnRUcmFuc2FjdGlvbih0aGlzLCB0aGlzLnJlcXVlc3QsIHRoaXMudWEudHJhbnNwb3J0KTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICB0aGlzLmNsaWVudFRyYW5zYWN0aW9uID0gbmV3IFNJUC5UcmFuc2FjdGlvbnMuTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24odGhpcywgdGhpcy5yZXF1ZXN0LCB0aGlzLnVhLnRyYW5zcG9ydCk7CiAgICB9CiAgICB0aGlzLmNsaWVudFRyYW5zYWN0aW9uLnNlbmQoKTsKCiAgICByZXR1cm4gdGhpcy5jbGllbnRUcmFuc2FjdGlvbjsKICB9LAoKICAvKioKICAqIENhbGxiYWNrIGZpcmVkIHdoZW4gcmVjZWl2aW5nIGEgcmVxdWVzdCB0aW1lb3V0IGVycm9yIGZyb20gdGhlIGNsaWVudCB0cmFuc2FjdGlvbi4KICAqIFRvIGJlIHJlLWRlZmluZWQgYnkgdGhlIGFwcGxpY2FudC4KICAqIEBldmVudAogICovCiAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmFwcGxpY2FudC5vblJlcXVlc3RUaW1lb3V0KCk7CiAgfSwKCiAgLyoqCiAgKiBDYWxsYmFjayBmaXJlZCB3aGVuIHJlY2VpdmluZyBhIHRyYW5zcG9ydCBlcnJvciBmcm9tIHRoZSBjbGllbnQgdHJhbnNhY3Rpb24uCiAgKiBUbyBiZSByZS1kZWZpbmVkIGJ5IHRoZSBhcHBsaWNhbnQuCiAgKiBAZXZlbnQKICAqLwogIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5hcHBsaWNhbnQub25UcmFuc3BvcnRFcnJvcigpOwogIH0sCgogIC8qKgogICogQ2FsbGVkIGZyb20gY2xpZW50IHRyYW5zYWN0aW9uIHdoZW4gcmVjZWl2aW5nIGEgY29ycmVjdCByZXNwb25zZSB0byB0aGUgcmVxdWVzdC4KICAqIEF1dGhlbnRpY2F0ZSByZXF1ZXN0IGlmIG5lZWRlZCBvciBwYXNzIHRoZSByZXNwb25zZSBiYWNrIHRvIHRoZSBhcHBsaWNhbnQuCiAgKiBAcGFyYW0ge1NJUC5JbmNvbWluZ1Jlc3BvbnNlfSByZXNwb25zZQogICovCiAgcmVjZWl2ZVJlc3BvbnNlOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgdmFyIGNzZXEsIGNoYWxsZW5nZSwgYXV0aG9yaXphdGlvbl9oZWFkZXJfbmFtZSwKICAgICAgc3RhdHVzX2NvZGUgPSByZXNwb25zZS5zdGF0dXNfY29kZTsKCiAgICAvKgogICAgKiBBdXRoZW50aWNhdGlvbgogICAgKiBBdXRoZW50aWNhdGUgb25jZS4gX2NoYWxsZW5nZWRfIGZsYWcgdXNlZCB0byBhdm9pZCBpbmZpbml0ZSBhdXRoZW50aWNhdGlvbnMuCiAgICAqLwogICAgaWYgKHN0YXR1c19jb2RlID09PSA0MDEgfHwgc3RhdHVzX2NvZGUgPT09IDQwNykgewoKICAgICAgLy8gR2V0IGFuZCBwYXJzZSB0aGUgYXBwcm9wcmlhdGUgV1dXLUF1dGhlbnRpY2F0ZSBvciBQcm94eS1BdXRoZW50aWNhdGUgaGVhZGVyLgogICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT09IDQwMSkgewogICAgICAgIGNoYWxsZW5nZSA9IHJlc3BvbnNlLnBhcnNlSGVhZGVyKCd3d3ctYXV0aGVudGljYXRlJyk7CiAgICAgICAgYXV0aG9yaXphdGlvbl9oZWFkZXJfbmFtZSA9ICdhdXRob3JpemF0aW9uJzsKICAgICAgfSBlbHNlIHsKICAgICAgICBjaGFsbGVuZ2UgPSByZXNwb25zZS5wYXJzZUhlYWRlcigncHJveHktYXV0aGVudGljYXRlJyk7CiAgICAgICAgYXV0aG9yaXphdGlvbl9oZWFkZXJfbmFtZSA9ICdwcm94eS1hdXRob3JpemF0aW9uJzsKICAgICAgfQoKICAgICAgLy8gVmVyaWZ5IGl0IHNlZW1zIGEgdmFsaWQgY2hhbGxlbmdlLgogICAgICBpZiAoISBjaGFsbGVuZ2UpIHsKICAgICAgICB0aGlzLmxvZ2dlci53YXJuKHJlc3BvbnNlLnN0YXR1c19jb2RlICsgJyB3aXRoIHdyb25nIG9yIG1pc3NpbmcgY2hhbGxlbmdlLCBjYW5ub3QgYXV0aGVudGljYXRlJyk7CiAgICAgICAgdGhpcy5hcHBsaWNhbnQucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5jaGFsbGVuZ2VkIHx8ICghdGhpcy5zdGFsZWQgJiYgY2hhbGxlbmdlLnN0YWxlID09PSB0cnVlKSkgewogICAgICAgIGlmICghdGhpcy5jcmVkZW50aWFscykgewogICAgICAgICAgdGhpcy5jcmVkZW50aWFscyA9IHRoaXMudWEuY29uZmlndXJhdGlvbi5hdXRoZW50aWNhdGlvbkZhY3RvcnkodGhpcy51YSk7CiAgICAgICAgfQoKICAgICAgICAvLyBWZXJpZnkgdGhhdCB0aGUgY2hhbGxlbmdlIGlzIHJlYWxseSB2YWxpZC4KICAgICAgICBpZiAoIXRoaXMuY3JlZGVudGlhbHMuYXV0aGVudGljYXRlKHRoaXMucmVxdWVzdCwgY2hhbGxlbmdlKSkgewogICAgICAgICAgdGhpcy5hcHBsaWNhbnQucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5jaGFsbGVuZ2VkID0gdHJ1ZTsKCiAgICAgICAgaWYgKGNoYWxsZW5nZS5zdGFsZSkgewogICAgICAgICAgdGhpcy5zdGFsZWQgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHJlc3BvbnNlLm1ldGhvZCA9PT0gU0lQLkMuUkVHSVNURVIpIHsKICAgICAgICAgIGNzZXEgPSB0aGlzLmFwcGxpY2FudC5jc2VxICs9IDE7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJlcXVlc3QuZGlhbG9nKXsKICAgICAgICAgIGNzZXEgPSB0aGlzLnJlcXVlc3QuZGlhbG9nLmxvY2FsX3NlcW51bSArPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjc2VxID0gdGhpcy5yZXF1ZXN0LmNzZXEgKyAxOwogICAgICAgICAgdGhpcy5yZXF1ZXN0LmNzZXEgPSBjc2VxOwogICAgICAgIH0KICAgICAgICB0aGlzLnJlcXVlc3Quc2V0SGVhZGVyKCdjc2VxJywgY3NlcSArJyAnKyB0aGlzLm1ldGhvZCk7CgogICAgICAgIHRoaXMucmVxdWVzdC5zZXRIZWFkZXIoYXV0aG9yaXphdGlvbl9oZWFkZXJfbmFtZSwgdGhpcy5jcmVkZW50aWFscy50b1N0cmluZygpKTsKICAgICAgICB0aGlzLnNlbmQoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmFwcGxpY2FudC5yZWNlaXZlUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLmFwcGxpY2FudC5yZWNlaXZlUmVzcG9uc2UocmVzcG9uc2UpOwogICAgfQogIH0KfTsKClNJUC5SZXF1ZXN0U2VuZGVyID0gUmVxdWVzdFNlbmRlcjsKfTsKCn0se31dLDI1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBuYW1lIFNJUAogKiBAbmFtZXNwYWNlCiAqLwoidXNlIHN0cmljdCI7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChlbnZpcm9ubWVudCkgewoKdmFyIHBrZyA9IHJlcXVpcmUoJy4uL3BhY2thZ2UuanNvbicpOwoKdmFyIFNJUCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHt9LCB7CiAgdmVyc2lvbjogewogICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gcGtnLnZlcnNpb247IH0KICB9LAogIG5hbWU6IHsKICAgIGdldDogZnVuY3Rpb24oKXsgcmV0dXJuIHBrZy50aXRsZTsgfQogIH0KfSk7CgpyZXF1aXJlKCcuL1V0aWxzJykoU0lQLCBlbnZpcm9ubWVudCk7ClNJUC5Mb2dnZXJGYWN0b3J5ID0gcmVxdWlyZSgnLi9Mb2dnZXJGYWN0b3J5JykoZW52aXJvbm1lbnQuY29uc29sZSk7ClNJUC5FdmVudEVtaXR0ZXIgPSByZXF1aXJlKCcuL0V2ZW50RW1pdHRlcicpKGVudmlyb25tZW50LmNvbnNvbGUpOwpTSVAuQyA9IHJlcXVpcmUoJy4vQ29uc3RhbnRzJykoU0lQLm5hbWUsIFNJUC52ZXJzaW9uKTsKU0lQLkV4Y2VwdGlvbnMgPSByZXF1aXJlKCcuL0V4Y2VwdGlvbnMnKTsKU0lQLlRpbWVycyA9IHJlcXVpcmUoJy4vVGltZXJzJykoZW52aXJvbm1lbnQudGltZXJzKTsKU0lQLlRyYW5zcG9ydCA9IGVudmlyb25tZW50LlRyYW5zcG9ydChTSVAsIGVudmlyb25tZW50LldlYlNvY2tldCk7CnJlcXVpcmUoJy4vUGFyc2VyJykoU0lQKTsKcmVxdWlyZSgnLi9TSVBNZXNzYWdlJykoU0lQKTsKcmVxdWlyZSgnLi9VUkknKShTSVApOwpyZXF1aXJlKCcuL05hbWVBZGRySGVhZGVyJykoU0lQKTsKcmVxdWlyZSgnLi9UcmFuc2FjdGlvbnMnKShTSVApOwpyZXF1aXJlKCcuL0RpYWxvZ3MnKShTSVApOwpyZXF1aXJlKCcuL1JlcXVlc3RTZW5kZXInKShTSVApOwpyZXF1aXJlKCcuL1JlZ2lzdGVyQ29udGV4dCcpKFNJUCk7ClNJUC5NZWRpYUhhbmRsZXIgPSByZXF1aXJlKCcuL01lZGlhSGFuZGxlcicpKFNJUC5FdmVudEVtaXR0ZXIpOwpyZXF1aXJlKCcuL0NsaWVudENvbnRleHQnKShTSVApOwpyZXF1aXJlKCcuL1NlcnZlckNvbnRleHQnKShTSVApOwpyZXF1aXJlKCcuL1Nlc3Npb24nKShTSVAsIGVudmlyb25tZW50KTsKcmVxdWlyZSgnLi9TdWJzY3JpcHRpb24nKShTSVApOwpTSVAuV2ViUlRDID0gcmVxdWlyZSgnLi9XZWJSVEMnKShTSVAsIGVudmlyb25tZW50KTsKcmVxdWlyZSgnLi9VQScpKFNJUCwgZW52aXJvbm1lbnQpOwpTSVAuSGFja3MgPSByZXF1aXJlKCcuL0hhY2tzJykoU0lQKTsKcmVxdWlyZSgnLi9TYW5pdHlDaGVjaycpKFNJUCk7ClNJUC5EaWdlc3RBdXRoZW50aWNhdGlvbiA9IHJlcXVpcmUoJy4vRGlnZXN0QXV0aGVudGljYXRpb24nKShTSVAuVXRpbHMpOwpTSVAuR3JhbW1hciA9IHJlcXVpcmUoJy4vR3JhbW1hcicpKFNJUCk7CgpyZXR1cm4gU0lQOwp9OwoKfSx7Ii4uL3BhY2thZ2UuanNvbiI6OCwiLi9DbGllbnRDb250ZXh0Ijo5LCIuL0NvbnN0YW50cyI6MTAsIi4vRGlhbG9ncyI6MTIsIi4vRGlnZXN0QXV0aGVudGljYXRpb24iOjEzLCIuL0V2ZW50RW1pdHRlciI6MTQsIi4vRXhjZXB0aW9ucyI6MTUsIi4vR3JhbW1hciI6MTYsIi4vSGFja3MiOjE4LCIuL0xvZ2dlckZhY3RvcnkiOjE5LCIuL01lZGlhSGFuZGxlciI6MjAsIi4vTmFtZUFkZHJIZWFkZXIiOjIxLCIuL1BhcnNlciI6MjIsIi4vUmVnaXN0ZXJDb250ZXh0IjoyMywiLi9SZXF1ZXN0U2VuZGVyIjoyNCwiLi9TSVBNZXNzYWdlIjoyNiwiLi9TYW5pdHlDaGVjayI6MjcsIi4vU2VydmVyQ29udGV4dCI6MjgsIi4vU2Vzc2lvbiI6MjksIi4vU3Vic2NyaXB0aW9uIjozMSwiLi9UaW1lcnMiOjMyLCIuL1RyYW5zYWN0aW9ucyI6MzMsIi4vVUEiOjM1LCIuL1VSSSI6MzYsIi4vVXRpbHMiOjM3LCIuL1dlYlJUQyI6Mzh9XSwyNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgU0lQIE1lc3NhZ2UKICovCgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyCiAgT3V0Z29pbmdSZXF1ZXN0LAogIEluY29taW5nTWVzc2FnZSwKICBJbmNvbWluZ1JlcXVlc3QsCiAgSW5jb21pbmdSZXNwb25zZTsKCmZ1bmN0aW9uIGdldFN1cHBvcnRlZEhlYWRlciAocmVxdWVzdCkgewogIHZhciBhbGxvd1VucmVnaXN0ZXJlZCA9IHJlcXVlc3QudWEuY29uZmlndXJhdGlvbi5oYWNrQWxsb3dVbnJlZ2lzdGVyZWRPcHRpb25UYWdzOwogIHZhciBvcHRpb25UYWdzID0gW107CiAgdmFyIG9wdGlvblRhZ1NldCA9IHt9OwoKICBpZiAocmVxdWVzdC5tZXRob2QgPT09IFNJUC5DLlJFR0lTVEVSKSB7CiAgICBvcHRpb25UYWdzLnB1c2goJ3BhdGgnLCAnZ3J1dScpOwogIH0gZWxzZSBpZiAocmVxdWVzdC5tZXRob2QgPT09IFNJUC5DLklOVklURSAmJgogICAgICAgICAgICAgKHJlcXVlc3QudWEuY29udGFjdC5wdWJfZ3J1dSB8fCByZXF1ZXN0LnVhLmNvbnRhY3QudGVtcF9ncnV1KSkgewogICAgb3B0aW9uVGFncy5wdXNoKCdncnV1Jyk7CiAgfQoKICBpZiAocmVxdWVzdC51YS5jb25maWd1cmF0aW9uLnJlbDEwMCA9PT0gU0lQLkMuc3VwcG9ydGVkLlNVUFBPUlRFRCkgewogICAgb3B0aW9uVGFncy5wdXNoKCcxMDByZWwnKTsKICB9CiAgaWYgKHJlcXVlc3QudWEuY29uZmlndXJhdGlvbi5yZXBsYWNlcyA9PT0gU0lQLkMuc3VwcG9ydGVkLlNVUFBPUlRFRCkgewogICAgb3B0aW9uVGFncy5wdXNoKCdyZXBsYWNlcycpOwogIH0KCiAgb3B0aW9uVGFncy5wdXNoKCdvdXRib3VuZCcpOwoKICBvcHRpb25UYWdzID0gb3B0aW9uVGFncy5jb25jYXQocmVxdWVzdC51YS5jb25maWd1cmF0aW9uLmV4dHJhU3VwcG9ydGVkKTsKCiAgb3B0aW9uVGFncyA9IG9wdGlvblRhZ3MuZmlsdGVyKGZ1bmN0aW9uKG9wdGlvblRhZykgewogICAgdmFyIHJlZ2lzdGVyZWQgPSBTSVAuQy5PUFRJT05fVEFHU1tvcHRpb25UYWddOwogICAgdmFyIHVuaXF1ZSA9ICFvcHRpb25UYWdTZXRbb3B0aW9uVGFnXTsKICAgIG9wdGlvblRhZ1NldFtvcHRpb25UYWddID0gdHJ1ZTsKICAgIHJldHVybiAocmVnaXN0ZXJlZCB8fCBhbGxvd1VucmVnaXN0ZXJlZCkgJiYgdW5pcXVlOwogIH0pOwoKICByZXR1cm4gJ1N1cHBvcnRlZDogJyArIG9wdGlvblRhZ3Muam9pbignLCAnKSArICdcclxuJzsKfQoKLyoqCiAqIEBhdWdtZW50cyBTSVAKICogQGNsYXNzIENsYXNzIGZvciBvdXRnb2luZyBTSVAgcmVxdWVzdC4KICogQHBhcmFtIHtTdHJpbmd9IG1ldGhvZCByZXF1ZXN0IG1ldGhvZAogKiBAcGFyYW0ge1N0cmluZ30gcnVyaSByZXF1ZXN0IHVyaQogKiBAcGFyYW0ge1NJUC5VQX0gdWEKICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyBwYXJhbWV0ZXJzIHRoYXQgd2lsbCBoYXZlIHByaW9yaXR5IG92ZXIgdWEuY29uZmlndXJhdGlvbiBwYXJhbWV0ZXJzOgogKiA8YnI+CiAqICAtIGNzZXEsIGNhbGxfaWQsIGZyb21fdGFnLCBmcm9tX3VyaSwgZnJvbV9kaXNwbGF5TmFtZSwgdG9fdXJpLCB0b190YWcsIHJvdXRlX3NldAogKiBAcGFyYW0ge09iamVjdH0gW2hlYWRlcnNdIGV4dHJhIGhlYWRlcnMKICogQHBhcmFtIHtTdHJpbmd9IFtib2R5XQogKi8KT3V0Z29pbmdSZXF1ZXN0ID0gZnVuY3Rpb24obWV0aG9kLCBydXJpLCB1YSwgcGFyYW1zLCBleHRyYUhlYWRlcnMsIGJvZHkpIHsKICB2YXIKICAgIHRvLAogICAgZnJvbSwKICAgIGNhbGxfaWQsCiAgICBjc2VxLAogICAgdG9fdXJpLAogICAgZnJvbV91cmk7CgogIHBhcmFtcyA9IHBhcmFtcyB8fCB7fTsKCiAgLy8gTWFuZGF0b3J5IHBhcmFtZXRlcnMgY2hlY2sKICBpZighbWV0aG9kIHx8ICFydXJpIHx8ICF1YSkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnNpcG1lc3NhZ2UnKTsKICB0aGlzLnVhID0gdWE7CiAgdGhpcy5oZWFkZXJzID0ge307CiAgdGhpcy5tZXRob2QgPSBtZXRob2Q7CiAgdGhpcy5ydXJpID0gcnVyaTsKICB0aGlzLmJvZHkgPSBib2R5OwogIHRoaXMuZXh0cmFIZWFkZXJzID0gKGV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKICB0aGlzLnN0YXR1c0NvZGUgPSBwYXJhbXMuc3RhdHVzX2NvZGU7CiAgdGhpcy5yZWFzb25QaHJhc2UgPSBwYXJhbXMucmVhc29uX3BocmFzZTsKCiAgLy8gRmlsbCB0aGUgQ29tbW9uIFNJUCBSZXF1ZXN0IEhlYWRlcnMKCiAgLy8gUm91dGUKICBpZiAocGFyYW1zLnJvdXRlX3NldCkgewogICAgdGhpcy5zZXRIZWFkZXIoJ3JvdXRlJywgcGFyYW1zLnJvdXRlX3NldCk7CiAgfSBlbHNlIGlmICh1YS5jb25maWd1cmF0aW9uLnVzZVByZWxvYWRlZFJvdXRlKXsKICAgIHRoaXMuc2V0SGVhZGVyKCdyb3V0ZScsIHVhLnRyYW5zcG9ydC5zZXJ2ZXIuc2lwX3VyaSk7CiAgfQoKICAvLyBWaWEKICAvLyBFbXB0eSBWaWEgaGVhZGVyLiBXaWxsIGJlIGZpbGxlZCBieSB0aGUgY2xpZW50IHRyYW5zYWN0aW9uLgogIHRoaXMuc2V0SGVhZGVyKCd2aWEnLCAnJyk7CgogIC8vIE1heC1Gb3J3YXJkcwogIHRoaXMuc2V0SGVhZGVyKCdtYXgtZm9yd2FyZHMnLCBTSVAuVUEuQy5NQVhfRk9SV0FSRFMpOwoKICAvLyBUbwogIHRvX3VyaSA9IHBhcmFtcy50b191cmkgfHwgcnVyaTsKICB0byA9IChwYXJhbXMudG9fZGlzcGxheU5hbWUgfHwgcGFyYW1zLnRvX2Rpc3BsYXlOYW1lID09PSAwKSA/ICciJyArIHBhcmFtcy50b19kaXNwbGF5TmFtZSArICciICcgOiAnJzsKICB0byArPSAnPCcgKyAodG9fdXJpICYmIHRvX3VyaS50b1JhdyA/IHRvX3VyaS50b1JhdygpIDogdG9fdXJpKSArICc+JzsKICB0byArPSBwYXJhbXMudG9fdGFnID8gJzt0YWc9JyArIHBhcmFtcy50b190YWcgOiAnJzsKICB0aGlzLnRvID0gbmV3IFNJUC5OYW1lQWRkckhlYWRlci5wYXJzZSh0byk7CiAgdGhpcy5zZXRIZWFkZXIoJ3RvJywgdG8pOwoKICAvLyBGcm9tCiAgZnJvbV91cmkgPSBwYXJhbXMuZnJvbV91cmkgfHwgdWEuY29uZmlndXJhdGlvbi51cmk7CiAgaWYgKHBhcmFtcy5mcm9tX2Rpc3BsYXlOYW1lIHx8IHBhcmFtcy5mcm9tX2Rpc3BsYXlOYW1lID09PSAwKSB7CiAgICBmcm9tID0gJyInICsgcGFyYW1zLmZyb21fZGlzcGxheU5hbWUgKyAnIiAnOwogIH0gZWxzZSBpZiAodWEuY29uZmlndXJhdGlvbi5kaXNwbGF5TmFtZSkgewogICAgZnJvbSA9ICciJyArIHVhLmNvbmZpZ3VyYXRpb24uZGlzcGxheU5hbWUgKyAnIiAnOwogIH0gZWxzZSB7CiAgICBmcm9tID0gJyc7CiAgfQogIGZyb20gKz0gJzwnICsgKGZyb21fdXJpICYmIGZyb21fdXJpLnRvUmF3ID8gZnJvbV91cmkudG9SYXcoKSA6IGZyb21fdXJpKSArICc+O3RhZz0nOwogIGZyb20gKz0gcGFyYW1zLmZyb21fdGFnIHx8IFNJUC5VdGlscy5uZXdUYWcoKTsKICB0aGlzLmZyb20gPSBuZXcgU0lQLk5hbWVBZGRySGVhZGVyLnBhcnNlKGZyb20pOwogIHRoaXMuc2V0SGVhZGVyKCdmcm9tJywgZnJvbSk7CgogIC8vIENhbGwtSUQKICBjYWxsX2lkID0gcGFyYW1zLmNhbGxfaWQgfHwgKHVhLmNvbmZpZ3VyYXRpb24uc2lwanNJZCArIFNJUC5VdGlscy5jcmVhdGVSYW5kb21Ub2tlbigxNSkpOwogIHRoaXMuY2FsbF9pZCA9IGNhbGxfaWQ7CiAgdGhpcy5zZXRIZWFkZXIoJ2NhbGwtaWQnLCBjYWxsX2lkKTsKCiAgLy8gQ1NlcQogIGNzZXEgPSBwYXJhbXMuY3NlcSB8fCBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCk7CiAgdGhpcy5jc2VxID0gY3NlcTsKICB0aGlzLnNldEhlYWRlcignY3NlcScsIGNzZXEgKyAnICcgKyBtZXRob2QpOwp9OwoKT3V0Z29pbmdSZXF1ZXN0LnByb3RvdHlwZSA9IHsKICAvKioKICAgKiBSZXBsYWNlIHRoZSB0aGUgZ2l2ZW4gaGVhZGVyIGJ5IHRoZSBnaXZlbiB2YWx1ZS4KICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICAqIEBwYXJhbSB7U3RyaW5nIHwgQXJyYXl9IHZhbHVlIGhlYWRlciB2YWx1ZQogICAqLwogIHNldEhlYWRlcjogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHsKICAgIHRoaXMuaGVhZGVyc1tTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpXSA9ICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSA/IHZhbHVlIDogW3ZhbHVlXTsKICB9LAoKICAvKioKICAgKiBHZXQgdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBoZWFkZXIgbmFtZSBhdCB0aGUgZ2l2ZW4gcG9zaXRpb24uCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgaGVhZGVyIG5hbWUKICAgKiBAcmV0dXJucyB7U3RyaW5nfHVuZGVmaW5lZH0gUmV0dXJucyB0aGUgc3BlY2lmaWVkIGhlYWRlciwgdW5kZWZpbmVkIGlmIGhlYWRlciBkb2Vzbid0IGV4aXN0LgogICAqLwogIGdldEhlYWRlcjogZnVuY3Rpb24obmFtZSkgewogICAgdmFyIHJlZ2V4cCwgaWR4LAogICAgICBsZW5ndGggPSB0aGlzLmV4dHJhSGVhZGVycy5sZW5ndGgsCiAgICAgIGhlYWRlciA9IHRoaXMuaGVhZGVyc1tTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpXTsKCiAgICBpZihoZWFkZXIpIHsKICAgICAgaWYoaGVhZGVyWzBdKSB7CiAgICAgICAgcmV0dXJuIGhlYWRlclswXTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cCgnXlxccyonICsgbmFtZSArICdcXHMqOicsJ2knKTsKICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgaGVhZGVyID0gdGhpcy5leHRyYUhlYWRlcnNbaWR4XTsKICAgICAgICBpZiAocmVnZXhwLnRlc3QoaGVhZGVyKSkgewogICAgICAgICAgcmV0dXJuIGhlYWRlci5zdWJzdHJpbmcoaGVhZGVyLmluZGV4T2YoJzonKSsxKS50cmltKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuOwogIH0sCgogIC8qKgogICAqIEdldCB0aGUgaGVhZGVyL3Mgb2YgdGhlIGdpdmVuIG5hbWUuCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgaGVhZGVyIG5hbWUKICAgKiBAcmV0dXJucyB7QXJyYXl9IEFycmF5IHdpdGggYWxsIHRoZSBoZWFkZXJzIG9mIHRoZSBzcGVjaWZpZWQgbmFtZS4KICAgKi8KICBnZXRIZWFkZXJzOiBmdW5jdGlvbihuYW1lKSB7CiAgICB2YXIgaWR4LCBsZW5ndGgsIHJlZ2V4cCwKICAgICAgaGVhZGVyID0gdGhpcy5oZWFkZXJzW1NJUC5VdGlscy5oZWFkZXJpemUobmFtZSldLAogICAgICByZXN1bHQgPSBbXTsKCiAgICBpZihoZWFkZXIpIHsKICAgICAgbGVuZ3RoID0gaGVhZGVyLmxlbmd0aDsKICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgcmVzdWx0LnB1c2goaGVhZGVyW2lkeF0pOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9IGVsc2UgewogICAgICBsZW5ndGggPSB0aGlzLmV4dHJhSGVhZGVycy5sZW5ndGg7CiAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoJ15cXHMqJyArIG5hbWUgKyAnXFxzKjonLCdpJyk7CiAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICAgIGhlYWRlciA9IHRoaXMuZXh0cmFIZWFkZXJzW2lkeF07CiAgICAgICAgaWYgKHJlZ2V4cC50ZXN0KGhlYWRlcikpIHsKICAgICAgICAgIHJlc3VsdC5wdXNoKGhlYWRlci5zdWJzdHJpbmcoaGVhZGVyLmluZGV4T2YoJzonKSsxKS50cmltKCkpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0sCgogIC8qKgogICAqIFZlcmlmeSB0aGUgZXhpc3RlbmNlIG9mIHRoZSBnaXZlbiBoZWFkZXIuCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgaGVhZGVyIG5hbWUKICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpZiBoZWFkZXIgd2l0aCBnaXZlbiBuYW1lIGV4aXN0cywgZmFsc2Ugb3RoZXJ3aXNlCiAgICovCiAgaGFzSGVhZGVyOiBmdW5jdGlvbihuYW1lKSB7CiAgICB2YXIgcmVnZXhwLCBpZHgsCiAgICAgIGxlbmd0aCA9IHRoaXMuZXh0cmFIZWFkZXJzLmxlbmd0aDsKCiAgICBpZiAodGhpcy5oZWFkZXJzW1NJUC5VdGlscy5oZWFkZXJpemUobmFtZSldKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cCgnXlxccyonICsgbmFtZSArICdcXHMqOicsJ2knKTsKICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgaWYgKHJlZ2V4cC50ZXN0KHRoaXMuZXh0cmFIZWFkZXJzW2lkeF0pKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfSwKCiAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgdmFyIG1zZyA9ICcnLCBoZWFkZXIsIGxlbmd0aCwgaWR4OwoKICAgIG1zZyArPSB0aGlzLm1ldGhvZCArICcgJyArICh0aGlzLnJ1cmkudG9SYXcgPyB0aGlzLnJ1cmkudG9SYXcoKSA6IHRoaXMucnVyaSkgKyAnIFNJUC8yLjBcclxuJzsKCiAgICBmb3IgKGhlYWRlciBpbiB0aGlzLmhlYWRlcnMpIHsKICAgICAgbGVuZ3RoID0gdGhpcy5oZWFkZXJzW2hlYWRlcl0ubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBtc2cgKz0gaGVhZGVyICsgJzogJyArIHRoaXMuaGVhZGVyc1toZWFkZXJdW2lkeF0gKyAnXHJcbic7CiAgICAgIH0KICAgIH0KCiAgICBsZW5ndGggPSB0aGlzLmV4dHJhSGVhZGVycy5sZW5ndGg7CiAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgbXNnICs9IHRoaXMuZXh0cmFIZWFkZXJzW2lkeF0udHJpbSgpICsnXHJcbic7CiAgICB9CgogICAgbXNnICs9IGdldFN1cHBvcnRlZEhlYWRlcih0aGlzKTsKICAgIG1zZyArPSAnVXNlci1BZ2VudDogJyArIHRoaXMudWEuY29uZmlndXJhdGlvbi51c2VyQWdlbnRTdHJpbmcgKydcclxuJzsKCiAgICBpZih0aGlzLmJvZHkpIHsKICAgICAgbGVuZ3RoID0gU0lQLlV0aWxzLnN0cl91dGY4X2xlbmd0aCh0aGlzLmJvZHkpOwogICAgICBtc2cgKz0gJ0NvbnRlbnQtTGVuZ3RoOiAnICsgbGVuZ3RoICsgJ1xyXG5cclxuJzsKICAgICAgbXNnICs9IHRoaXMuYm9keTsKICAgIH0gZWxzZSB7CiAgICAgIG1zZyArPSAnQ29udGVudC1MZW5ndGg6IDBcclxuXHJcbic7CiAgICB9CgogICAgcmV0dXJuIG1zZzsKICB9Cn07CgovKioKICogQGF1Z21lbnRzIFNJUAogKiBAY2xhc3MgQ2xhc3MgZm9yIGluY29taW5nIFNJUCBtZXNzYWdlLgogKi8KSW5jb21pbmdNZXNzYWdlID0gZnVuY3Rpb24oKXsKICB0aGlzLmRhdGEgPSBudWxsOwogIHRoaXMuaGVhZGVycyA9IG51bGw7CiAgdGhpcy5tZXRob2QgPSAgbnVsbDsKICB0aGlzLnZpYSA9IG51bGw7CiAgdGhpcy52aWFfYnJhbmNoID0gbnVsbDsKICB0aGlzLmNhbGxfaWQgPSBudWxsOwogIHRoaXMuY3NlcSA9IG51bGw7CiAgdGhpcy5mcm9tID0gbnVsbDsKICB0aGlzLmZyb21fdGFnID0gbnVsbDsKICB0aGlzLnRvID0gbnVsbDsKICB0aGlzLnRvX3RhZyA9IG51bGw7CiAgdGhpcy5ib2R5ID0gbnVsbDsKfTsKCkluY29taW5nTWVzc2FnZS5wcm90b3R5cGUgPSB7CiAgLyoqCiAgKiBJbnNlcnQgYSBoZWFkZXIgb2YgdGhlIGdpdmVuIG5hbWUgYW5kIHZhbHVlIGludG8gdGhlIGxhc3QgcG9zaXRpb24gb2YgdGhlCiAgKiBoZWFkZXIgYXJyYXkuCiAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlIGhlYWRlciB2YWx1ZQogICovCiAgYWRkSGVhZGVyOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgdmFyIGhlYWRlciA9IHsgcmF3OiB2YWx1ZSB9OwoKICAgIG5hbWUgPSBTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpOwoKICAgIGlmKHRoaXMuaGVhZGVyc1tuYW1lXSkgewogICAgICB0aGlzLmhlYWRlcnNbbmFtZV0ucHVzaChoZWFkZXIpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5oZWFkZXJzW25hbWVdID0gW2hlYWRlcl07CiAgICB9CiAgfSwKCiAgLyoqCiAgICogR2V0IHRoZSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gaGVhZGVyIG5hbWUgYXQgdGhlIGdpdmVuIHBvc2l0aW9uLgogICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIGhlYWRlciBuYW1lCiAgICogQHJldHVybnMge1N0cmluZ3x1bmRlZmluZWR9IFJldHVybnMgdGhlIHNwZWNpZmllZCBoZWFkZXIsIG51bGwgaWYgaGVhZGVyIGRvZXNuJ3QgZXhpc3QuCiAgICovCiAgZ2V0SGVhZGVyOiBmdW5jdGlvbihuYW1lKSB7CiAgICB2YXIgaGVhZGVyID0gdGhpcy5oZWFkZXJzW1NJUC5VdGlscy5oZWFkZXJpemUobmFtZSldOwoKICAgIGlmKGhlYWRlcikgewogICAgICBpZihoZWFkZXJbMF0pIHsKICAgICAgICByZXR1cm4gaGVhZGVyWzBdLnJhdzsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuOwogICAgfQogIH0sCgogIC8qKgogICAqIEdldCB0aGUgaGVhZGVyL3Mgb2YgdGhlIGdpdmVuIG5hbWUuCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgaGVhZGVyIG5hbWUKICAgKiBAcmV0dXJucyB7QXJyYXl9IEFycmF5IHdpdGggYWxsIHRoZSBoZWFkZXJzIG9mIHRoZSBzcGVjaWZpZWQgbmFtZS4KICAgKi8KICBnZXRIZWFkZXJzOiBmdW5jdGlvbihuYW1lKSB7CiAgICB2YXIgaWR4LCBsZW5ndGgsCiAgICAgIGhlYWRlciA9IHRoaXMuaGVhZGVyc1tTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpXSwKICAgICAgcmVzdWx0ID0gW107CgogICAgaWYoIWhlYWRlcikgewogICAgICByZXR1cm4gW107CiAgICB9CgogICAgbGVuZ3RoID0gaGVhZGVyLmxlbmd0aDsKICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICByZXN1bHQucHVzaChoZWFkZXJbaWR4XS5yYXcpOwogICAgfQoKICAgIHJldHVybiByZXN1bHQ7CiAgfSwKCiAgLyoqCiAgICogVmVyaWZ5IHRoZSBleGlzdGVuY2Ugb2YgdGhlIGdpdmVuIGhlYWRlci4KICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlmIGhlYWRlciB3aXRoIGdpdmVuIG5hbWUgZXhpc3RzLCBmYWxzZSBvdGhlcndpc2UKICAgKi8KICBoYXNIZWFkZXI6IGZ1bmN0aW9uKG5hbWUpIHsKICAgIHJldHVybih0aGlzLmhlYWRlcnNbU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKV0pID8gdHJ1ZSA6IGZhbHNlOwogIH0sCgogIC8qKgogICogUGFyc2UgdGhlIGdpdmVuIGhlYWRlciBvbiB0aGUgZ2l2ZW4gaW5kZXguCiAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICogQHBhcmFtIHtOdW1iZXJ9IFtpZHg9MF0gaGVhZGVyIGluZGV4CiAgKiBAcmV0dXJucyB7T2JqZWN0fHVuZGVmaW5lZH0gUGFyc2VkIGhlYWRlciBvYmplY3QsIHVuZGVmaW5lZCBpZiB0aGUgaGVhZGVyIGlzIG5vdCBwcmVzZW50IG9yIGluIGNhc2Ugb2YgYSBwYXJzaW5nIGVycm9yLgogICovCiAgcGFyc2VIZWFkZXI6IGZ1bmN0aW9uKG5hbWUsIGlkeCkgewogICAgdmFyIGhlYWRlciwgdmFsdWUsIHBhcnNlZDsKCiAgICBuYW1lID0gU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKTsKCiAgICBpZHggPSBpZHggfHwgMDsKCiAgICBpZighdGhpcy5oZWFkZXJzW25hbWVdKSB7CiAgICAgIHRoaXMubG9nZ2VyLmxvZygnaGVhZGVyICInICsgbmFtZSArICciIG5vdCBwcmVzZW50Jyk7CiAgICAgIHJldHVybjsKICAgIH0gZWxzZSBpZihpZHggPj0gdGhpcy5oZWFkZXJzW25hbWVdLmxlbmd0aCkgewogICAgICB0aGlzLmxvZ2dlci5sb2coJ25vdCBzbyBtYW55ICInICsgbmFtZSArICciIGhlYWRlcnMgcHJlc2VudCcpOwogICAgICByZXR1cm47CiAgICB9CgogICAgaGVhZGVyID0gdGhpcy5oZWFkZXJzW25hbWVdW2lkeF07CiAgICB2YWx1ZSA9IGhlYWRlci5yYXc7CgogICAgaWYoaGVhZGVyLnBhcnNlZCkgewogICAgICByZXR1cm4gaGVhZGVyLnBhcnNlZDsKICAgIH0KCiAgICAvL3N1YnN0aXR1dGUgJy0nIGJ5ICdfJyBmb3IgZ3JhbW1hciBydWxlIG1hdGNoaW5nLgogICAgcGFyc2VkID0gU0lQLkdyYW1tYXIucGFyc2UodmFsdWUsIG5hbWUucmVwbGFjZSgvLS9nLCAnXycpKTsKCiAgICBpZihwYXJzZWQgPT09IC0xKSB7CiAgICAgIHRoaXMuaGVhZGVyc1tuYW1lXS5zcGxpY2UoaWR4LCAxKTsgLy9kZWxldGUgZnJvbSBoZWFkZXJzCiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ2Vycm9yIHBhcnNpbmcgIicgKyBuYW1lICsgJyIgaGVhZGVyIGZpZWxkIHdpdGggdmFsdWUgIicgKyB2YWx1ZSArICciJyk7CiAgICAgIHJldHVybjsKICAgIH0gZWxzZSB7CiAgICAgIGhlYWRlci5wYXJzZWQgPSBwYXJzZWQ7CiAgICAgIHJldHVybiBwYXJzZWQ7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogTWVzc2FnZSBIZWFkZXIgYXR0cmlidXRlIHNlbGVjdG9yLiBBbGlhcyBvZiBwYXJzZUhlYWRlci4KICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICAqIEBwYXJhbSB7TnVtYmVyfSBbaWR4PTBdIGhlYWRlciBpbmRleAogICAqIEByZXR1cm5zIHtPYmplY3R8dW5kZWZpbmVkfSBQYXJzZWQgaGVhZGVyIG9iamVjdCwgdW5kZWZpbmVkIGlmIHRoZSBoZWFkZXIgaXMgbm90IHByZXNlbnQgb3IgaW4gY2FzZSBvZiBhIHBhcnNpbmcgZXJyb3IuCiAgICoKICAgKiBAZXhhbXBsZQogICAqIG1lc3NhZ2UucygndmlhJywzKS5wb3J0CiAgICovCiAgczogZnVuY3Rpb24obmFtZSwgaWR4KSB7CiAgICByZXR1cm4gdGhpcy5wYXJzZUhlYWRlcihuYW1lLCBpZHgpOwogIH0sCgogIC8qKgogICogUmVwbGFjZSB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGhlYWRlciBieSB0aGUgdmFsdWUuCiAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlIGhlYWRlciB2YWx1ZQogICovCiAgc2V0SGVhZGVyOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgdmFyIGhlYWRlciA9IHsgcmF3OiB2YWx1ZSB9OwogICAgdGhpcy5oZWFkZXJzW1NJUC5VdGlscy5oZWFkZXJpemUobmFtZSldID0gW2hlYWRlcl07CiAgfSwKCiAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMuZGF0YTsKICB9Cn07CgovKioKICogQGF1Z21lbnRzIEluY29taW5nTWVzc2FnZQogKiBAY2xhc3MgQ2xhc3MgZm9yIGluY29taW5nIFNJUCByZXF1ZXN0LgogKi8KSW5jb21pbmdSZXF1ZXN0ID0gZnVuY3Rpb24odWEpIHsKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnNpcG1lc3NhZ2UnKTsKICB0aGlzLnVhID0gdWE7CiAgdGhpcy5oZWFkZXJzID0ge307CiAgdGhpcy5ydXJpID0gbnVsbDsKICB0aGlzLnRyYW5zcG9ydCA9IG51bGw7CiAgdGhpcy5zZXJ2ZXJfdHJhbnNhY3Rpb24gPSBudWxsOwp9OwpJbmNvbWluZ1JlcXVlc3QucHJvdG90eXBlID0gbmV3IEluY29taW5nTWVzc2FnZSgpOwoKLyoqCiogU3RhdGVmdWwgcmVwbHkuCiogQHBhcmFtIHtOdW1iZXJ9IGNvZGUgc3RhdHVzIGNvZGUKKiBAcGFyYW0ge1N0cmluZ30gcmVhc29uIHJlYXNvbiBwaHJhc2UKKiBAcGFyYW0ge09iamVjdH0gaGVhZGVycyBleHRyYSBoZWFkZXJzCiogQHBhcmFtIHtTdHJpbmd9IGJvZHkgYm9keQoqIEBwYXJhbSB7RnVuY3Rpb259IFtvblN1Y2Nlc3NdIG9uU3VjY2VzcyBjYWxsYmFjawoqIEBwYXJhbSB7RnVuY3Rpb259IFtvbkZhaWx1cmVdIG9uRmFpbHVyZSBjYWxsYmFjawoqLwpJbmNvbWluZ1JlcXVlc3QucHJvdG90eXBlLnJlcGx5ID0gZnVuY3Rpb24oY29kZSwgcmVhc29uLCBleHRyYUhlYWRlcnMsIGJvZHksIG9uU3VjY2Vzcywgb25GYWlsdXJlKSB7CiAgdmFyIHJyLCB2aWFzLCBsZW5ndGgsIGlkeCwgcmVzcG9uc2UsCiAgICB0byA9IHRoaXMuZ2V0SGVhZGVyKCdUbycpLAogICAgciA9IDAsCiAgICB2ID0gMDsKCiAgcmVzcG9uc2UgPSBTSVAuVXRpbHMuYnVpbGRTdGF0dXNMaW5lKGNvZGUsIHJlYXNvbik7CiAgZXh0cmFIZWFkZXJzID0gKGV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKCiAgaWYodGhpcy5tZXRob2QgPT09IFNJUC5DLklOVklURSAmJiBjb2RlID4gMTAwICYmIGNvZGUgPD0gMjAwKSB7CiAgICByciA9IHRoaXMuZ2V0SGVhZGVycygncmVjb3JkLXJvdXRlJyk7CiAgICBsZW5ndGggPSByci5sZW5ndGg7CgogICAgZm9yKHI7IHIgPCBsZW5ndGg7IHIrKykgewogICAgICByZXNwb25zZSArPSAnUmVjb3JkLVJvdXRlOiAnICsgcnJbcl0gKyAnXHJcbic7CiAgICB9CiAgfQoKICB2aWFzID0gdGhpcy5nZXRIZWFkZXJzKCd2aWEnKTsKICBsZW5ndGggPSB2aWFzLmxlbmd0aDsKCiAgZm9yKHY7IHYgPCBsZW5ndGg7IHYrKykgewogICAgcmVzcG9uc2UgKz0gJ1ZpYTogJyArIHZpYXNbdl0gKyAnXHJcbic7CiAgfQoKICBpZighdGhpcy50b190YWcgJiYgY29kZSA+IDEwMCkgewogICAgdG8gKz0gJzt0YWc9JyArIFNJUC5VdGlscy5uZXdUYWcoKTsKICB9IGVsc2UgaWYodGhpcy50b190YWcgJiYgIXRoaXMucygndG8nKS5oYXNQYXJhbSgndGFnJykpIHsKICAgIHRvICs9ICc7dGFnPScgKyB0aGlzLnRvX3RhZzsKICB9CgogIHJlc3BvbnNlICs9ICdUbzogJyArIHRvICsgJ1xyXG4nOwogIHJlc3BvbnNlICs9ICdGcm9tOiAnICsgdGhpcy5nZXRIZWFkZXIoJ0Zyb20nKSArICdcclxuJzsKICByZXNwb25zZSArPSAnQ2FsbC1JRDogJyArIHRoaXMuY2FsbF9pZCArICdcclxuJzsKICByZXNwb25zZSArPSAnQ1NlcTogJyArIHRoaXMuY3NlcSArICcgJyArIHRoaXMubWV0aG9kICsgJ1xyXG4nOwoKICBsZW5ndGggPSBleHRyYUhlYWRlcnMubGVuZ3RoOwogIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgcmVzcG9uc2UgKz0gZXh0cmFIZWFkZXJzW2lkeF0udHJpbSgpICsnXHJcbic7CiAgfQoKICByZXNwb25zZSArPSBnZXRTdXBwb3J0ZWRIZWFkZXIodGhpcyk7CiAgcmVzcG9uc2UgKz0gJ1VzZXItQWdlbnQ6ICcgKyB0aGlzLnVhLmNvbmZpZ3VyYXRpb24udXNlckFnZW50U3RyaW5nICsnXHJcbic7CgogIGlmKGJvZHkpIHsKICAgIGxlbmd0aCA9IFNJUC5VdGlscy5zdHJfdXRmOF9sZW5ndGgoYm9keSk7CiAgICByZXNwb25zZSArPSAnQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9zZHBcclxuJzsKICAgIHJlc3BvbnNlICs9ICdDb250ZW50LUxlbmd0aDogJyArIGxlbmd0aCArICdcclxuXHJcbic7CiAgICByZXNwb25zZSArPSBib2R5OwogIH0gZWxzZSB7CiAgICByZXNwb25zZSArPSAnQ29udGVudC1MZW5ndGg6ICcgKyAwICsgJ1xyXG5cclxuJzsKICB9CgogIHRoaXMuc2VydmVyX3RyYW5zYWN0aW9uLnJlY2VpdmVSZXNwb25zZShjb2RlLCByZXNwb25zZSkudGhlbihvblN1Y2Nlc3MsIG9uRmFpbHVyZSk7CgogIHJldHVybiByZXNwb25zZTsKfTsKCi8qKgoqIFN0YXRlbGVzcyByZXBseS4KKiBAcGFyYW0ge051bWJlcn0gY29kZSBzdGF0dXMgY29kZQoqIEBwYXJhbSB7U3RyaW5nfSByZWFzb24gcmVhc29uIHBocmFzZQoqLwpJbmNvbWluZ1JlcXVlc3QucHJvdG90eXBlLnJlcGx5X3NsID0gZnVuY3Rpb24oY29kZSwgcmVhc29uKSB7CiAgdmFyIHRvLCByZXNwb25zZSwKICAgIHYgPSAwLAogICAgdmlhcyA9IHRoaXMuZ2V0SGVhZGVycygndmlhJyksCiAgICBsZW5ndGggPSB2aWFzLmxlbmd0aDsKCiAgcmVzcG9uc2UgPSBTSVAuVXRpbHMuYnVpbGRTdGF0dXNMaW5lKGNvZGUsIHJlYXNvbik7CgogIGZvcih2OyB2IDwgbGVuZ3RoOyB2KyspIHsKICAgIHJlc3BvbnNlICs9ICdWaWE6ICcgKyB2aWFzW3ZdICsgJ1xyXG4nOwogIH0KCiAgdG8gPSB0aGlzLmdldEhlYWRlcignVG8nKTsKCiAgaWYoIXRoaXMudG9fdGFnICYmIGNvZGUgPiAxMDApIHsKICAgIHRvICs9ICc7dGFnPScgKyBTSVAuVXRpbHMubmV3VGFnKCk7CiAgfSBlbHNlIGlmKHRoaXMudG9fdGFnICYmICF0aGlzLnMoJ3RvJykuaGFzUGFyYW0oJ3RhZycpKSB7CiAgICB0byArPSAnO3RhZz0nICsgdGhpcy50b190YWc7CiAgfQoKICByZXNwb25zZSArPSAnVG86ICcgKyB0byArICdcclxuJzsKICByZXNwb25zZSArPSAnRnJvbTogJyArIHRoaXMuZ2V0SGVhZGVyKCdGcm9tJykgKyAnXHJcbic7CiAgcmVzcG9uc2UgKz0gJ0NhbGwtSUQ6ICcgKyB0aGlzLmNhbGxfaWQgKyAnXHJcbic7CiAgcmVzcG9uc2UgKz0gJ0NTZXE6ICcgKyB0aGlzLmNzZXEgKyAnICcgKyB0aGlzLm1ldGhvZCArICdcclxuJzsKICByZXNwb25zZSArPSAnVXNlci1BZ2VudDogJyArIHRoaXMudWEuY29uZmlndXJhdGlvbi51c2VyQWdlbnRTdHJpbmcgKydcclxuJzsKICByZXNwb25zZSArPSAnQ29udGVudC1MZW5ndGg6ICcgKyAwICsgJ1xyXG5cclxuJzsKCiAgdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSk7Cn07CgoKLyoqCiAqIEBhdWdtZW50cyBJbmNvbWluZ01lc3NhZ2UKICogQGNsYXNzIENsYXNzIGZvciBpbmNvbWluZyBTSVAgcmVzcG9uc2UuCiAqLwpJbmNvbWluZ1Jlc3BvbnNlID0gZnVuY3Rpb24odWEpIHsKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnNpcG1lc3NhZ2UnKTsKICB0aGlzLmhlYWRlcnMgPSB7fTsKICB0aGlzLnN0YXR1c19jb2RlID0gbnVsbDsKICB0aGlzLnJlYXNvbl9waHJhc2UgPSBudWxsOwp9OwpJbmNvbWluZ1Jlc3BvbnNlLnByb3RvdHlwZSA9IG5ldyBJbmNvbWluZ01lc3NhZ2UoKTsKClNJUC5PdXRnb2luZ1JlcXVlc3QgPSBPdXRnb2luZ1JlcXVlc3Q7ClNJUC5JbmNvbWluZ1JlcXVlc3QgPSBJbmNvbWluZ1JlcXVlc3Q7ClNJUC5JbmNvbWluZ1Jlc3BvbnNlID0gSW5jb21pbmdSZXNwb25zZTsKfTsKCn0se31dLDI3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBJbmNvbWluZyBTSVAgTWVzc2FnZSBTYW5pdHkgQ2hlY2sKICovCgovKioKICogU0lQIG1lc3NhZ2Ugc2FuaXR5IGNoZWNrLgogKiBAYXVnbWVudHMgU0lQCiAqIEBmdW5jdGlvbgogKiBAcGFyYW0ge1NJUC5JbmNvbWluZ01lc3NhZ2V9IG1lc3NhZ2UKICogQHBhcmFtIHtTSVAuVUF9IHVhCiAqIEBwYXJhbSB7U0lQLlRyYW5zcG9ydH0gdHJhbnNwb3J0CiAqIEByZXR1cm5zIHtCb29sZWFufQogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CnZhciBzYW5pdHlDaGVjaywKIGxvZ2dlciwKIG1lc3NhZ2UsIHVhLCB0cmFuc3BvcnQsCiByZXF1ZXN0cyA9IFtdLAogcmVzcG9uc2VzID0gW10sCiBhbGwgPSBbXTsKCi8vIFJlcGx5CmZ1bmN0aW9uIHJlcGx5KHN0YXR1c19jb2RlKSB7CiAgdmFyIHRvLAogICAgcmVzcG9uc2UgPSBTSVAuVXRpbHMuYnVpbGRTdGF0dXNMaW5lKHN0YXR1c19jb2RlKSwKICAgIHZpYXMgPSBtZXNzYWdlLmdldEhlYWRlcnMoJ3ZpYScpLAogICAgbGVuZ3RoID0gdmlhcy5sZW5ndGgsCiAgICBpZHggPSAwOwoKICBmb3IoaWR4OyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICByZXNwb25zZSArPSAiVmlhOiAiICsgdmlhc1tpZHhdICsgIlxyXG4iOwogIH0KCiAgdG8gPSBtZXNzYWdlLmdldEhlYWRlcignVG8nKTsKCiAgaWYoIW1lc3NhZ2UudG9fdGFnKSB7CiAgICB0byArPSAnO3RhZz0nICsgU0lQLlV0aWxzLm5ld1RhZygpOwogIH0KCiAgcmVzcG9uc2UgKz0gIlRvOiAiICsgdG8gKyAiXHJcbiI7CiAgcmVzcG9uc2UgKz0gIkZyb206ICIgKyBtZXNzYWdlLmdldEhlYWRlcignRnJvbScpICsgIlxyXG4iOwogIHJlc3BvbnNlICs9ICJDYWxsLUlEOiAiICsgbWVzc2FnZS5jYWxsX2lkICsgIlxyXG4iOwogIHJlc3BvbnNlICs9ICJDU2VxOiAiICsgbWVzc2FnZS5jc2VxICsgIiAiICsgbWVzc2FnZS5tZXRob2QgKyAiXHJcbiI7CiAgcmVzcG9uc2UgKz0gIlxyXG4iOwoKICB0cmFuc3BvcnQuc2VuZChyZXNwb25zZSk7Cn0KCi8qCiAqIFNhbml0eSBDaGVjayBmb3IgaW5jb21pbmcgTWVzc2FnZXMKICoKICogUmVxdWVzdHM6CiAqICAtIF9yZmMzMjYxXzhfMl8yXzFfIFJlY2VpdmUgYSBSZXF1ZXN0IHdpdGggYSBub24gc3VwcG9ydGVkIFVSSSBzY2hlbWUKICogIC0gX3JmYzMyNjFfMTZfM180XyBSZWNlaXZlIGEgUmVxdWVzdCBhbHJlYWR5IHNlbnQgYnkgdXMKICogICBEb2VzIG5vdCBsb29rIGF0IHZpYSBzZW50LWJ5IGJ1dCBhdCBzaXBqc0lkLCB3aGljaCBpcyBpbnNlcnRlZCBhcwogKiAgIGEgcHJlZml4IGluIGFsbCBpbml0aWFsIHJlcXVlc3RzIGdlbmVyYXRlZCBieSB0aGUgdWEKICogIC0gX3JmYzMyNjFfMThfM19yZXF1ZXN0XyBCb2R5IENvbnRlbnQtTGVuZ3RoCiAqICAtIF9yZmMzMjYxXzhfMl8yXzJfIE1lcmdlZCBSZXF1ZXN0cwogKgogKiBSZXNwb25zZXM6CiAqICAtIF9yZmMzMjYxXzhfMV8zXzNfIE11bHRpcGxlIFZpYSBoZWFkZXJzCiAqICAtIF9yZmMzMjYxXzE4XzFfMl8gc2VudC1ieSBtaXNtYXRjaAogKiAgLSBfcmZjMzI2MV8xOF8zX3Jlc3BvbnNlXyBCb2R5IENvbnRlbnQtTGVuZ3RoCiAqCiAqIEFsbDoKICogIC0gTWluaW11bSBoZWFkZXJzIGluIGEgU0lQIG1lc3NhZ2UKICovCgovLyBTYW5pdHkgQ2hlY2sgZnVuY3Rpb25zIGZvciByZXF1ZXN0cwpmdW5jdGlvbiByZmMzMjYxXzhfMl8yXzEoKSB7CiAgaWYoIW1lc3NhZ2UucnVyaSB8fCBtZXNzYWdlLnJ1cmkuc2NoZW1lICE9PSAnc2lwJykgewogICAgcmVwbHkoNDE2KTsKICAgIHJldHVybiBmYWxzZTsKICB9Cn0KCmZ1bmN0aW9uIHJmYzMyNjFfMTZfM180KCkgewogIGlmKCFtZXNzYWdlLnRvX3RhZykgewogICAgaWYobWVzc2FnZS5jYWxsX2lkLnN1YnN0cigwLCA1KSA9PT0gdWEuY29uZmlndXJhdGlvbi5zaXBqc0lkKSB7CiAgICAgIHJlcGx5KDQ4Mik7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIHJmYzMyNjFfMThfM19yZXF1ZXN0KCkgewogIHZhciBsZW4gPSBTSVAuVXRpbHMuc3RyX3V0ZjhfbGVuZ3RoKG1lc3NhZ2UuYm9keSksCiAgY29udGVudExlbmd0aCA9IG1lc3NhZ2UuZ2V0SGVhZGVyKCdjb250ZW50LWxlbmd0aCcpOwoKICBpZihsZW4gPCBjb250ZW50TGVuZ3RoKSB7CiAgICByZXBseSg0MDApOwogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gcmZjMzI2MV84XzJfMl8yKCkgewogIHZhciB0ciwgaWR4LAogICAgZnJvbVRhZyA9IG1lc3NhZ2UuZnJvbV90YWcsCiAgICBjYWxsX2lkID0gbWVzc2FnZS5jYWxsX2lkLAogICAgY3NlcSA9IG1lc3NhZ2UuY3NlcTsKCiAgaWYoIW1lc3NhZ2UudG9fdGFnKSB7CiAgICBpZihtZXNzYWdlLm1ldGhvZCA9PT0gU0lQLkMuSU5WSVRFKSB7CiAgICAgIHRyID0gdWEudHJhbnNhY3Rpb25zLmlzdFttZXNzYWdlLnZpYV9icmFuY2hdOwogICAgICBpZih0cikgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IoaWR4IGluIHVhLnRyYW5zYWN0aW9ucy5pc3QpIHsKICAgICAgICAgIHRyID0gdWEudHJhbnNhY3Rpb25zLmlzdFtpZHhdOwogICAgICAgICAgaWYodHIucmVxdWVzdC5mcm9tX3RhZyA9PT0gZnJvbVRhZyAmJiB0ci5yZXF1ZXN0LmNhbGxfaWQgPT09IGNhbGxfaWQgJiYgdHIucmVxdWVzdC5jc2VxID09PSBjc2VxKSB7CiAgICAgICAgICAgIHJlcGx5KDQ4Mik7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRyID0gdWEudHJhbnNhY3Rpb25zLm5pc3RbbWVzc2FnZS52aWFfYnJhbmNoXTsKICAgICAgaWYodHIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yKGlkeCBpbiB1YS50cmFuc2FjdGlvbnMubmlzdCkgewogICAgICAgICAgdHIgPSB1YS50cmFuc2FjdGlvbnMubmlzdFtpZHhdOwogICAgICAgICAgaWYodHIucmVxdWVzdC5mcm9tX3RhZyA9PT0gZnJvbVRhZyAmJiB0ci5yZXF1ZXN0LmNhbGxfaWQgPT09IGNhbGxfaWQgJiYgdHIucmVxdWVzdC5jc2VxID09PSBjc2VxKSB7CiAgICAgICAgICAgIHJlcGx5KDQ4Mik7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0KCi8vIFNhbml0eSBDaGVjayBmdW5jdGlvbnMgZm9yIHJlc3BvbnNlcwpmdW5jdGlvbiByZmMzMjYxXzhfMV8zXzMoKSB7CiAgaWYobWVzc2FnZS5nZXRIZWFkZXJzKCd2aWEnKS5sZW5ndGggPiAxKSB7CiAgICBsb2dnZXIud2FybignTW9yZSB0aGFuIG9uZSBWaWEgaGVhZGVyIGZpZWxkIHByZXNlbnQgaW4gdGhlIHJlc3BvbnNlLiBEcm9wcGluZyB0aGUgcmVzcG9uc2UnKTsKICAgIHJldHVybiBmYWxzZTsKICB9Cn0KCmZ1bmN0aW9uIHJmYzMyNjFfMThfMV8yKCkgewogIHZhciB2aWFIb3N0ID0gdWEuY29uZmlndXJhdGlvbi52aWFIb3N0OwogIGlmKG1lc3NhZ2UudmlhLmhvc3QgIT09IHZpYUhvc3QgfHwgbWVzc2FnZS52aWEucG9ydCAhPT0gdW5kZWZpbmVkKSB7CiAgICBsb2dnZXIud2FybignVmlhIHNlbnQtYnkgaW4gdGhlIHJlc3BvbnNlIGRvZXMgbm90IG1hdGNoIFVBIFZpYSBob3N0IHZhbHVlLiBEcm9wcGluZyB0aGUgcmVzcG9uc2UnKTsKICAgIHJldHVybiBmYWxzZTsKICB9Cn0KCmZ1bmN0aW9uIHJmYzMyNjFfMThfM19yZXNwb25zZSgpIHsKICB2YXIKICAgIGxlbiA9IFNJUC5VdGlscy5zdHJfdXRmOF9sZW5ndGgobWVzc2FnZS5ib2R5KSwKICAgIGNvbnRlbnRMZW5ndGggPSBtZXNzYWdlLmdldEhlYWRlcignY29udGVudC1sZW5ndGgnKTsKCiAgICBpZihsZW4gPCBjb250ZW50TGVuZ3RoKSB7CiAgICAgIGxvZ2dlci53YXJuKCdNZXNzYWdlIGJvZHkgbGVuZ3RoIGlzIGxvd2VyIHRoYW4gdGhlIHZhbHVlIGluIENvbnRlbnQtTGVuZ3RoIGhlYWRlciBmaWVsZC4gRHJvcHBpbmcgdGhlIHJlc3BvbnNlJyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfQoKLy8gU2FuaXR5IENoZWNrIGZ1bmN0aW9ucyBmb3IgcmVxdWVzdHMgYW5kIHJlc3BvbnNlcwpmdW5jdGlvbiBtaW5pbXVtSGVhZGVycygpIHsKICB2YXIKICAgIG1hbmRhdG9yeUhlYWRlcnMgPSBbJ2Zyb20nLCAndG8nLCAnY2FsbF9pZCcsICdjc2VxJywgJ3ZpYSddLAogICAgaWR4ID0gbWFuZGF0b3J5SGVhZGVycy5sZW5ndGg7CgogIHdoaWxlKGlkeC0tKSB7CiAgICBpZighbWVzc2FnZS5oYXNIZWFkZXIobWFuZGF0b3J5SGVhZGVyc1tpZHhdKSkgewogICAgICBsb2dnZXIud2FybignTWlzc2luZyBtYW5kYXRvcnkgaGVhZGVyIGZpZWxkIDogJysgbWFuZGF0b3J5SGVhZGVyc1tpZHhdICsnLiBEcm9wcGluZyB0aGUgcmVzcG9uc2UnKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KfQoKcmVxdWVzdHMucHVzaChyZmMzMjYxXzhfMl8yXzEpOwpyZXF1ZXN0cy5wdXNoKHJmYzMyNjFfMTZfM180KTsKcmVxdWVzdHMucHVzaChyZmMzMjYxXzE4XzNfcmVxdWVzdCk7CnJlcXVlc3RzLnB1c2gocmZjMzI2MV84XzJfMl8yKTsKCnJlc3BvbnNlcy5wdXNoKHJmYzMyNjFfOF8xXzNfMyk7CnJlc3BvbnNlcy5wdXNoKHJmYzMyNjFfMThfMV8yKTsKcmVzcG9uc2VzLnB1c2gocmZjMzI2MV8xOF8zX3Jlc3BvbnNlKTsKCmFsbC5wdXNoKG1pbmltdW1IZWFkZXJzKTsKCnNhbml0eUNoZWNrID0gZnVuY3Rpb24obSwgdSwgdCkgewogIHZhciBsZW4sIHBhc3M7CgogIG1lc3NhZ2UgPSBtOwogIHVhID0gdTsKICB0cmFuc3BvcnQgPSB0OwoKICBsb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC5zYW5pdHljaGVjaycpOwoKICBsZW4gPSBhbGwubGVuZ3RoOwogIHdoaWxlKGxlbi0tKSB7CiAgICBwYXNzID0gYWxsW2xlbl0obWVzc2FnZSk7CiAgICBpZihwYXNzID09PSBmYWxzZSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICBpZihtZXNzYWdlIGluc3RhbmNlb2YgU0lQLkluY29taW5nUmVxdWVzdCkgewogICAgbGVuID0gcmVxdWVzdHMubGVuZ3RoOwogICAgd2hpbGUobGVuLS0pIHsKICAgICAgcGFzcyA9IHJlcXVlc3RzW2xlbl0obWVzc2FnZSk7CiAgICAgIGlmKHBhc3MgPT09IGZhbHNlKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfQoKICBlbHNlIGlmKG1lc3NhZ2UgaW5zdGFuY2VvZiBTSVAuSW5jb21pbmdSZXNwb25zZSkgewogICAgbGVuID0gcmVzcG9uc2VzLmxlbmd0aDsKICAgIHdoaWxlKGxlbi0tKSB7CiAgICAgIHBhc3MgPSByZXNwb25zZXNbbGVuXShtZXNzYWdlKTsKICAgICAgaWYocGFzcyA9PT0gZmFsc2UpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9CgogIC8vRXZlcnl0aGluZyBpcyBPSwogIHJldHVybiB0cnVlOwp9OwoKU0lQLnNhbml0eUNoZWNrID0gc2FuaXR5Q2hlY2s7Cn07Cgp9LHt9XSwyODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CnZhciBTZXJ2ZXJDb250ZXh0OwoKU2VydmVyQ29udGV4dCA9IGZ1bmN0aW9uICh1YSwgcmVxdWVzdCkgewogIHRoaXMudWEgPSB1YTsKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnNlcnZlcmNvbnRleHQnKTsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwogIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gU0lQLkMuSU5WSVRFKSB7CiAgICB0aGlzLnRyYW5zYWN0aW9uID0gbmV3IFNJUC5UcmFuc2FjdGlvbnMuSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ocmVxdWVzdCwgdWEpOwogIH0gZWxzZSB7CiAgICB0aGlzLnRyYW5zYWN0aW9uID0gbmV3IFNJUC5UcmFuc2FjdGlvbnMuTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ocmVxdWVzdCwgdWEpOwogIH0KCiAgaWYgKHJlcXVlc3QuYm9keSkgewogICAgdGhpcy5ib2R5ID0gcmVxdWVzdC5ib2R5OwogIH0KICBpZiAocmVxdWVzdC5oYXNIZWFkZXIoJ0NvbnRlbnQtVHlwZScpKSB7CiAgICB0aGlzLmNvbnRlbnRUeXBlID0gcmVxdWVzdC5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpOwogIH0KICB0aGlzLm1ldGhvZCA9IHJlcXVlc3QubWV0aG9kOwoKICB0aGlzLmRhdGEgPSB7fTsKCiAgdGhpcy5sb2NhbElkZW50aXR5ID0gcmVxdWVzdC50bzsKICB0aGlzLnJlbW90ZUlkZW50aXR5ID0gcmVxdWVzdC5mcm9tOwp9OwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKClNlcnZlckNvbnRleHQucHJvdG90eXBlLnByb2dyZXNzID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zIHx8IE9iamVjdC5wcm90b3R5cGUpOwogIG9wdGlvbnMuc3RhdHVzQ29kZSB8fCAob3B0aW9ucy5zdGF0dXNDb2RlID0gMTgwKTsKICBvcHRpb25zLm1pbkNvZGUgPSAxMDA7CiAgb3B0aW9ucy5tYXhDb2RlID0gMTk5OwogIG9wdGlvbnMuZXZlbnRzID0gWydwcm9ncmVzcyddOwogIHJldHVybiB0aGlzLnJlcGx5KG9wdGlvbnMpOwp9OwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zIHx8IE9iamVjdC5wcm90b3R5cGUpOwogIG9wdGlvbnMuc3RhdHVzQ29kZSB8fCAob3B0aW9ucy5zdGF0dXNDb2RlID0gMjAwKTsKICBvcHRpb25zLm1pbkNvZGUgPSAyMDA7CiAgb3B0aW9ucy5tYXhDb2RlID0gMjk5OwogIG9wdGlvbnMuZXZlbnRzID0gWydhY2NlcHRlZCddOwogIHJldHVybiB0aGlzLnJlcGx5KG9wdGlvbnMpOwp9OwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUucmVqZWN0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zIHx8IE9iamVjdC5wcm90b3R5cGUpOwogIG9wdGlvbnMuc3RhdHVzQ29kZSB8fCAob3B0aW9ucy5zdGF0dXNDb2RlID0gNDgwKTsKICBvcHRpb25zLm1pbkNvZGUgPSAzMDA7CiAgb3B0aW9ucy5tYXhDb2RlID0gNjk5OwogIG9wdGlvbnMuZXZlbnRzID0gWydyZWplY3RlZCcsICdmYWlsZWQnXTsKICByZXR1cm4gdGhpcy5yZXBseShvcHRpb25zKTsKfTsKClNlcnZlckNvbnRleHQucHJvdG90eXBlLnJlcGx5ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsgLy8gVGhpcyBpcyBva2F5LCBzbyBsb25nIGFzIHdlIHRyZWF0IG9wdGlvbnMgYXMgcmVhZC1vbmx5IGluIHRoaXMgbWV0aG9kCiAgdmFyCiAgICBzdGF0dXNDb2RlID0gb3B0aW9ucy5zdGF0dXNDb2RlIHx8IDEwMCwKICAgIG1pbkNvZGUgPSBvcHRpb25zLm1pbkNvZGUgfHwgMTAwLAogICAgbWF4Q29kZSA9IG9wdGlvbnMubWF4Q29kZSB8fCA2OTksCiAgICByZWFzb25QaHJhc2UgPSBTSVAuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKHN0YXR1c0NvZGUsIG9wdGlvbnMucmVhc29uUGhyYXNlKSwKICAgIGV4dHJhSGVhZGVycyA9IG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdLAogICAgYm9keSA9IG9wdGlvbnMuYm9keSwKICAgIGV2ZW50cyA9IG9wdGlvbnMuZXZlbnRzIHx8IFtdLAogICAgcmVzcG9uc2U7CgogIGlmIChzdGF0dXNDb2RlIDwgbWluQ29kZSB8fCBzdGF0dXNDb2RlID4gbWF4Q29kZSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdGF0dXNDb2RlOiAnICsgc3RhdHVzQ29kZSk7CiAgfQogIHJlc3BvbnNlID0gdGhpcy5yZXF1ZXN0LnJlcGx5KHN0YXR1c0NvZGUsIHJlYXNvblBocmFzZSwgZXh0cmFIZWFkZXJzLCBib2R5KTsKICBldmVudHMuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHsKICAgIHRoaXMuZW1pdChldmVudCwgcmVzcG9uc2UsIHJlYXNvblBocmFzZSk7CiAgfSwgdGhpcyk7CgogIHJldHVybiB0aGlzOwp9OwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUub25SZXF1ZXN0VGltZW91dCA9IGZ1bmN0aW9uICgpIHsKICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwp9OwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUub25UcmFuc3BvcnRFcnJvciA9IGZ1bmN0aW9uICgpIHsKICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKfTsKClNJUC5TZXJ2ZXJDb250ZXh0ID0gU2VydmVyQ29udGV4dDsKfTsKCn0se31dLDI5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVAsIGVudmlyb25tZW50KSB7Cgp2YXIgRFRNRiA9IHJlcXVpcmUoJy4vU2Vzc2lvbi9EVE1GJykoU0lQKTsKCnZhciBTZXNzaW9uLCBJbnZpdGVTZXJ2ZXJDb250ZXh0LCBJbnZpdGVDbGllbnRDb250ZXh0LAogQyA9IHsKICAgIC8vU2Vzc2lvbiBzdGF0ZXMKICAgIFNUQVRVU19OVUxMOiAgICAgICAgICAgICAgICAgICAgICAgIDAsCiAgICBTVEFUVVNfSU5WSVRFX1NFTlQ6ICAgICAgICAgICAgICAgICAxLAogICAgU1RBVFVTXzFYWF9SRUNFSVZFRDogICAgICAgICAgICAgICAgMiwKICAgIFNUQVRVU19JTlZJVEVfUkVDRUlWRUQ6ICAgICAgICAgICAgIDMsCiAgICBTVEFUVVNfV0FJVElOR19GT1JfQU5TV0VSOiAgICAgICAgICA0LAogICAgU1RBVFVTX0FOU1dFUkVEOiAgICAgICAgICAgICAgICAgICAgNSwKICAgIFNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSzogICAgICAgICAgIDYsCiAgICBTVEFUVVNfV0FJVElOR19GT1JfQUNLOiAgICAgICAgICAgICA3LAogICAgU1RBVFVTX0NBTkNFTEVEOiAgICAgICAgICAgICAgICAgICAgOCwKICAgIFNUQVRVU19URVJNSU5BVEVEOiAgICAgICAgICAgICAgICAgIDksCiAgICBTVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0s6IDEwLAogICAgU1RBVFVTX0VBUkxZX01FRElBOiAgICAgICAgICAgICAgICAxMSwKICAgIFNUQVRVU19DT05GSVJNRUQ6ICAgICAgICAgICAgICAgICAgMTIKICB9OwoKLyoKICogQHBhcmFtIHtmdW5jdGlvbiByZXR1cm5pbmcgU0lQLk1lZGlhSGFuZGxlcn0gW21lZGlhSGFuZGxlckZhY3RvcnldCiAqICAgICAgICAoU2VlIHRoZSBkb2N1bWVudGF0aW9uIGZvciB0aGUgbWVkaWFIYW5kbGVyRmFjdG9yeSBhcmd1bWVudCBvZiB0aGUgVUEgY29uc3RydWN0b3IuKQogKi8KU2Vzc2lvbiA9IGZ1bmN0aW9uIChtZWRpYUhhbmRsZXJGYWN0b3J5KSB7CiAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19OVUxMOwogIHRoaXMuZGlhbG9nID0gbnVsbDsKICB0aGlzLmVhcmx5RGlhbG9ncyA9IHt9OwogIHRoaXMubWVkaWFIYW5kbGVyRmFjdG9yeSA9IG1lZGlhSGFuZGxlckZhY3RvcnkgfHwgU0lQLldlYlJUQy5NZWRpYUhhbmRsZXIuZGVmYXVsdEZhY3Rvcnk7CiAgLy8gdGhpcy5tZWRpYUhhbmRsZXIgZ2V0cyBzZXQgYnkgSUNDL0lTQyBjb25zdHJ1Y3RvcnMKICB0aGlzLmhhc09mZmVyID0gZmFsc2U7CiAgdGhpcy5oYXNBbnN3ZXIgPSBmYWxzZTsKCiAgLy8gU2Vzc2lvbiBUaW1lcnMKICB0aGlzLnRpbWVycyA9IHsKICAgIGFja1RpbWVyOiBudWxsLAogICAgZXhwaXJlc1RpbWVyOiBudWxsLAogICAgaW52aXRlMnh4VGltZXI6IG51bGwsCiAgICB1c2VyTm9BbnN3ZXJUaW1lcjogbnVsbCwKICAgIHJlbDF4eFRpbWVyOiBudWxsLAogICAgcHJhY2tUaW1lcjogbnVsbAogIH07CgogIC8vIFNlc3Npb24gaW5mbwogIHRoaXMuc3RhcnRUaW1lID0gbnVsbDsKICB0aGlzLmVuZFRpbWUgPSBudWxsOwogIHRoaXMudG9uZXMgPSBudWxsOwoKICAvLyBNdXRlL0hvbGQgc3RhdGUKICB0aGlzLmxvY2FsX2hvbGQgPSBmYWxzZTsKICB0aGlzLnJlbW90ZV9ob2xkID0gZmFsc2U7CgogIHRoaXMucGVuZGluZ19hY3Rpb25zID0gewogICAgYWN0aW9uczogW10sCgogICAgbGVuZ3RoOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuYWN0aW9ucy5sZW5ndGg7CiAgICB9LAoKICAgIGlzUGVuZGluZzogZnVuY3Rpb24obmFtZSl7CiAgICAgIHZhcgogICAgICBpZHggPSAwLAogICAgICBsZW5ndGggPSB0aGlzLmFjdGlvbnMubGVuZ3RoOwoKICAgICAgZm9yIChpZHg7IGlkeDxsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgaWYgKHRoaXMuYWN0aW9uc1tpZHhdLm5hbWUgPT09IG5hbWUpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAoKICAgIHNoaWZ0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuYWN0aW9ucy5zaGlmdCgpOwogICAgfSwKCiAgICBwdXNoOiBmdW5jdGlvbihuYW1lKSB7CiAgICAgIHRoaXMuYWN0aW9ucy5wdXNoKHsKICAgICAgICBuYW1lOiBuYW1lCiAgICAgIH0pOwogICAgfSwKCiAgICBwb3A6IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgdmFyCiAgICAgIGlkeCA9IDAsCiAgICAgIGxlbmd0aCA9IHRoaXMuYWN0aW9ucy5sZW5ndGg7CgogICAgICBmb3IgKGlkeDsgaWR4PGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBpZiAodGhpcy5hY3Rpb25zW2lkeF0ubmFtZSA9PT0gbmFtZSkgewogICAgICAgICAgdGhpcy5hY3Rpb25zLnNwbGljZShpZHgsMSk7CiAgICAgICAgICBsZW5ndGggLS07CiAgICAgICAgICBpZHgtLTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgfTsKCiAgdGhpcy5lYXJseV9zZHAgPSBudWxsOwogIHRoaXMucmVsMTAwID0gU0lQLkMuc3VwcG9ydGVkLlVOU1VQUE9SVEVEOwp9OwoKU2Vzc2lvbi5wcm90b3R5cGUgPSB7CiAgZHRtZjogZnVuY3Rpb24odG9uZXMsIG9wdGlvbnMpIHsKICAgIHZhciB0b25lLCBkdG1mcyA9IFtdLAogICAgICAgIHNlbGYgPSB0aGlzOwoKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIGlmICh0b25lcyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ05vdCBlbm91Z2ggYXJndW1lbnRzJyk7CiAgICB9CgogICAgLy8gQ2hlY2sgU2Vzc2lvbiBTdGF0dXMKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQ09ORklSTUVEICYmIHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0spIHsKICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICAvLyBDaGVjayB0b25lcwogICAgaWYgKCh0eXBlb2YgdG9uZXMgIT09ICdzdHJpbmcnICYmIHR5cGVvZiB0b25lcyAhPT0gJ251bWJlcicpIHx8ICF0b25lcy50b1N0cmluZygpLm1hdGNoKC9eWzAtOUEtRCMqLF0rJC9pKSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRvbmVzOiAnKyB0b25lcyk7CiAgICB9CgogICAgdG9uZXMgPSB0b25lcy50b1N0cmluZygpLnNwbGl0KCcnKTsKCiAgICB3aGlsZSAodG9uZXMubGVuZ3RoID4gMCkgeyBkdG1mcy5wdXNoKG5ldyBEVE1GKHRoaXMsIHRvbmVzLnNoaWZ0KCksIG9wdGlvbnMpKTsgfQoKICAgIGlmICh0aGlzLnRvbmVzKSB7CiAgICAgIC8vIFRvbmVzIGFyZSBhbHJlYWR5IHF1ZXVlZCwganVzdCBhZGQgdG8gdGhlIHF1ZXVlCiAgICAgIHRoaXMudG9uZXMgPSAgdGhpcy50b25lcy5jb25jYXQoZHRtZnMpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICB2YXIgc2VuZERUTUYgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBkdG1mLCB0aW1lb3V0OwoKICAgICAgaWYgKHNlbGYuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEIHx8ICFzZWxmLnRvbmVzIHx8IHNlbGYudG9uZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgLy8gU3RvcCBzZW5kaW5nIERUTUYKICAgICAgICBzZWxmLnRvbmVzID0gbnVsbDsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQoKICAgICAgZHRtZiA9IHNlbGYudG9uZXMuc2hpZnQoKTsKCiAgICAgIGlmICh0b25lID09PSAnLCcpIHsKICAgICAgICB0aW1lb3V0ID0gMjAwMDsKICAgICAgfSBlbHNlIHsKICAgICAgICBkdG1mLm9uKCdmYWlsZWQnLCBmdW5jdGlvbigpe3NlbGYudG9uZXMgPSBudWxsO30pOwogICAgICAgIGR0bWYuc2VuZChvcHRpb25zKTsKICAgICAgICB0aW1lb3V0ID0gZHRtZi5kdXJhdGlvbiArIGR0bWYuaW50ZXJUb25lR2FwOwogICAgICB9CgogICAgICAvLyBTZXQgdGltZW91dCBmb3IgdGhlIG5leHQgdG9uZQogICAgICBTSVAuVGltZXJzLnNldFRpbWVvdXQoc2VuZERUTUYsIHRpbWVvdXQpOwogICAgfTsKCiAgICB0aGlzLnRvbmVzID0gZHRtZnM7CiAgICBzZW5kRFRNRigpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgYnllOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zIHx8IE9iamVjdC5wcm90b3R5cGUpOwogICAgdmFyIHN0YXR1c0NvZGUgPSBvcHRpb25zLnN0YXR1c0NvZGU7CgogICAgLy8gQ2hlY2sgU2Vzc2lvbiBTdGF0dXMKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICB0aGlzLmxvZ2dlci5lcnJvcignRXJyb3I6IEF0dGVtcHRlZCB0byBzZW5kIEJZRSBpbiBhIHRlcm1pbmF0ZWQgc2Vzc2lvbi4nKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgdGhpcy5sb2dnZXIubG9nKCd0ZXJtaW5hdGluZyBTZXNzaW9uJyk7CgogICAgaWYgKHN0YXR1c0NvZGUgJiYgKHN0YXR1c0NvZGUgPCAyMDAgfHwgc3RhdHVzQ29kZSA+PSA3MDApKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgc3RhdHVzQ29kZTogJysgc3RhdHVzQ29kZSk7CiAgICB9CgogICAgb3B0aW9ucy5yZWNlaXZlUmVzcG9uc2UgPSBmdW5jdGlvbiAoKSB7fTsKCiAgICByZXR1cm4gdGhpcy4KICAgICAgc2VuZFJlcXVlc3QoU0lQLkMuQllFLCBvcHRpb25zKS4KICAgICAgdGVybWluYXRlZCgpOwogIH0sCgogIHJlZmVyOiBmdW5jdGlvbih0YXJnZXQsIG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogICAgdmFyIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKSwKICAgICAgICB3aXRoUmVwbGFjZXMgPQogICAgICAgICAgdGFyZ2V0IGluc3RhbmNlb2YgU0lQLkludml0ZVNlcnZlckNvbnRleHQgfHwKICAgICAgICAgIHRhcmdldCBpbnN0YW5jZW9mIFNJUC5JbnZpdGVDbGllbnRDb250ZXh0LAogICAgICAgIG9yaWdpbmFsVGFyZ2V0ID0gdGFyZ2V0OwoKICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdOb3QgZW5vdWdoIGFyZ3VtZW50cycpOwogICAgfQoKICAgIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgICBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogICAgfQoKICAgIC8vIHRyYW5zZm9ybSBgdGFyZ2V0YCBzbyB0aGF0IGl0IGNhbiBiZSBhIFJlZmVyLVRvIGhlYWRlciB2YWx1ZQogICAgaWYgKHdpdGhSZXBsYWNlcykgewogICAgICAvL0F0dGVuZGVkIFRyYW5zZmVyCiAgICAgIC8vIEIudHJhbnNmZXIoQykKICAgICAgdGFyZ2V0ID0gJyInICsgdGFyZ2V0LnJlbW90ZUlkZW50aXR5LmZyaWVuZGx5TmFtZSArICciICcgKwogICAgICAgICc8JyArIHRhcmdldC5kaWFsb2cucmVtb3RlX3RhcmdldC50b1N0cmluZygpICsKICAgICAgICAnP1JlcGxhY2VzPScgKyB0YXJnZXQuZGlhbG9nLmlkLmNhbGxfaWQgKwogICAgICAgICclM0J0by10YWclM0QnICsgdGFyZ2V0LmRpYWxvZy5pZC5yZW1vdGVfdGFnICsKICAgICAgICAnJTNCZnJvbS10YWclM0QnICsgdGFyZ2V0LmRpYWxvZy5pZC5sb2NhbF90YWcgKyAnPic7CiAgICB9IGVsc2UgewogICAgICAvL0JsaW5kIFRyYW5zZmVyCiAgICAgIC8vIG5vcm1hbGl6ZVRhcmdldCBhbGxvd3MgaW5zdGFuY2VzIG9mIFNJUC5VUkkgdG8gcGFzcyB0aHJvdWdoIHVuYWx0ZXJlZCwKICAgICAgLy8gc28gdHJ5IHRvIG1ha2Ugb25lIGFoZWFkIG9mIHRpbWUKICAgICAgdHJ5IHsKICAgICAgICB0YXJnZXQgPSBTSVAuR3JhbW1hci5wYXJzZSh0YXJnZXQsICdSZWZlcl9UbycpLnVyaSB8fCB0YXJnZXQ7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB0aGlzLmxvZ2dlci5kZWJ1ZygiLnJlZmVyKCkgY2Fubm90IHBhcnNlIFJlZmVyX1RvIGZyb20iLCB0YXJnZXQpOwogICAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKCIuLi5mYWxsaW5nIHRocm91Z2ggdG8gbm9ybWFsaXplVGFyZ2V0KCkiKTsKICAgICAgfQoKICAgICAgLy8gQ2hlY2sgdGFyZ2V0IHZhbGlkaXR5CiAgICAgIHRhcmdldCA9IHRoaXMudWEubm9ybWFsaXplVGFyZ2V0KHRhcmdldCk7CiAgICAgIGlmICghdGFyZ2V0KSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB0YXJnZXQ6ICcgKyBvcmlnaW5hbFRhcmdldCk7CiAgICAgIH0KICAgIH0KCiAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJysgdGhpcy5jb250YWN0KTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdBbGxvdzogJysgU0lQLlVBLkMuQUxMT1dFRF9NRVRIT0RTLnRvU3RyaW5nKCkpOwogICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JlZmVyLVRvOiAnKyB0YXJnZXQpOwoKICAgIC8vIFNlbmQgdGhlIHJlcXVlc3QKICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuUkVGRVIsIHsKICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICAgIGJvZHk6IG9wdGlvbnMuYm9keSwKICAgICAgcmVjZWl2ZVJlc3BvbnNlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAoICEgL14yWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKSApIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gaGFuZyB1cCBvbmx5IGlmIHdlIHRyYW5zZmVycmVkIHRvIGEgU0lQIGFkZHJlc3MKICAgICAgICBpZiAod2l0aFJlcGxhY2VzIHx8ICh0YXJnZXQuc2NoZW1lICYmIHRhcmdldC5zY2hlbWUubWF0Y2goIl5zaXBzPyQiKSkpIHsKICAgICAgICAgIHRoaXMudGVybWluYXRlKCk7CiAgICAgICAgfQogICAgICB9LmJpbmQodGhpcykKICAgIH0pOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgZm9sbG93UmVmZXI6IGZ1bmN0aW9uIGZvbGxvd1JlZmVyIChjYWxsYmFjaykgewogICAgcmV0dXJuIGZ1bmN0aW9uIHJlZmVyTGlzdGVuZXIgKGNhbGxiYWNrLCByZXF1ZXN0KSB7CiAgICAgIC8vIG9wZW4gbm9uLVNJUCBVUklzIGlmIHBvc3NpYmxlIGFuZCBrZWVwIHNlc3Npb24gb3BlbgogICAgICB2YXIgcmVmZXJUbyA9IHJlcXVlc3QucGFyc2VIZWFkZXIoJ3JlZmVyLXRvJyk7CiAgICAgIHZhciB0YXJnZXQgPSByZWZlclRvLnVyaTsKICAgICAgaWYgKCF0YXJnZXQuc2NoZW1lLm1hdGNoKCJec2lwcz8kIikpIHsKICAgICAgICB2YXIgdGFyZ2V0U3RyaW5nID0gdGFyZ2V0LnRvU3RyaW5nKCk7CiAgICAgICAgaWYgKHR5cGVvZiBlbnZpcm9ubWVudC5vcGVuID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICBlbnZpcm9ubWVudC5vcGVuKHRhcmdldFN0cmluZyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oInJlZmVycmVkIHRvIG5vbi1TSVAgVVJJIGJ1dCBgb3BlbmAgaXNuJ3QgaW4gdGhlIGVudmlyb25tZW50OiAiICsgdGFyZ2V0U3RyaW5nKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgZXh0cmFIZWFkZXJzID0gW107CgogICAgICAvKiBDb3B5IHRoZSBSZXBsYWNlcyBxdWVyeSBpbnRvIGEgUmVwbGFjZXMgaGVhZGVyICovCiAgICAgIC8qIFRPRE8gLSBtYWtlIHN1cmUgd2UgZG9uJ3QgY29weSBhIHBvb3JseSBmb3JtYXR0ZWQgaGVhZGVyPyAqLwogICAgICB2YXIgcmVwbGFjZXMgPSB0YXJnZXQuZ2V0SGVhZGVyKCdSZXBsYWNlcycpOwogICAgICBpZiAocmVwbGFjZXMgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZXBsYWNlczogJyArIGRlY29kZVVSSUNvbXBvbmVudChyZXBsYWNlcykpOwogICAgICB9CgogICAgICAvLyBkb24ndCBlbWJlZCBoZWFkZXJzIGludG8gUmVxdWVzdC1VUkkgb2YgSU5WSVRFCiAgICAgIHRhcmdldC5jbGVhckhlYWRlcnMoKTsKCiAgICAgIC8qCiAgICAgICAgSGFybWxlc3MgcmFjZSBjb25kaXRpb24uICBCb3RoIHNpZGVzIG9mIFJFRkVSCiAgICAgICAgbWF5IHNlbmQgYSBCWUUsIGJ1dCBpbiB0aGUgZW5kIHRoZSBkaWFsb2dzIGFyZSBkZXN0cm95ZWQuCiAgICAgICovCiAgICAgIHZhciBnZXRSZWZlck1lZGlhID0gdGhpcy5tZWRpYUhhbmRsZXIuZ2V0UmVmZXJNZWRpYTsKICAgICAgdmFyIG1lZGlhSGludCA9IGdldFJlZmVyTWVkaWEgPyBnZXRSZWZlck1lZGlhLmNhbGwodGhpcy5tZWRpYUhhbmRsZXIpIDogdGhpcy5tZWRpYUhpbnQ7CgogICAgICBTSVAuSGFja3MuQ2hyb21lLmdldHNDb25mdXNlZEFib3V0R1VNKHRoaXMpOwoKICAgICAgdmFyIHJlZmVyU2Vzc2lvbiA9IHRoaXMudWEuaW52aXRlKHRhcmdldCwgewogICAgICAgIG1lZGlhOiBtZWRpYUhpbnQsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICB0b19kaXNwbGF5TmFtZTogcmVmZXJUby5mcmllbmRseU5hbWUKICAgICAgICB9LAogICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzCiAgICAgIH0pOwoKICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLCByZXF1ZXN0LCByZWZlclNlc3Npb24pOwoKICAgICAgdGhpcy50ZXJtaW5hdGUoKTsKICAgIH0uYmluZCh0aGlzLCBjYWxsYmFjayk7CiAgfSwKCiAgc2VuZFJlcXVlc3Q6IGZ1bmN0aW9uKG1ldGhvZCxvcHRpb25zKSB7CiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBTSVAuT3V0Z29pbmdSZXF1ZXN0KAogICAgICBtZXRob2QsCiAgICAgIHRoaXMuZGlhbG9nLnJlbW90ZV90YXJnZXQsCiAgICAgIHRoaXMudWEsCiAgICAgIHsKICAgICAgICBjc2VxOiBvcHRpb25zLmNzZXEgfHwgKHRoaXMuZGlhbG9nLmxvY2FsX3NlcW51bSArPSAxKSwKICAgICAgICBjYWxsX2lkOiB0aGlzLmRpYWxvZy5pZC5jYWxsX2lkLAogICAgICAgIGZyb21fdXJpOiB0aGlzLmRpYWxvZy5sb2NhbF91cmksCiAgICAgICAgZnJvbV90YWc6IHRoaXMuZGlhbG9nLmlkLmxvY2FsX3RhZywKICAgICAgICB0b191cmk6IHRoaXMuZGlhbG9nLnJlbW90ZV91cmksCiAgICAgICAgdG9fdGFnOiB0aGlzLmRpYWxvZy5pZC5yZW1vdGVfdGFnLAogICAgICAgIHJvdXRlX3NldDogdGhpcy5kaWFsb2cucm91dGVfc2V0LAogICAgICAgIHN0YXR1c0NvZGU6IG9wdGlvbnMuc3RhdHVzQ29kZSwKICAgICAgICByZWFzb25QaHJhc2U6IG9wdGlvbnMucmVhc29uUGhyYXNlCiAgICAgIH0sCiAgICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdLAogICAgICBvcHRpb25zLmJvZHkKICAgICk7CgogICAgbmV3IFNJUC5SZXF1ZXN0U2VuZGVyKHsKICAgICAgcmVxdWVzdDogcmVxdWVzdCwKICAgICAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24oKSB7CiAgICAgICAgc2VsZi5vblJlcXVlc3RUaW1lb3V0KCk7CiAgICAgIH0sCiAgICAgIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uKCkgewogICAgICAgIHNlbGYub25UcmFuc3BvcnRFcnJvcigpOwogICAgICB9LAogICAgICByZWNlaXZlUmVzcG9uc2U6IG9wdGlvbnMucmVjZWl2ZVJlc3BvbnNlIHx8IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgc2VsZi5yZWNlaXZlTm9uSW52aXRlUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICB9CiAgICB9LCB0aGlzLnVhKS5zZW5kKCk7CgogICAgLy8gRW1pdCB0aGUgcmVxdWVzdCBldmVudAogICAgdGhpcy5lbWl0KG1ldGhvZC50b0xvd2VyQ2FzZSgpLCByZXF1ZXN0KTsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICBjbG9zZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgaWR4OwoKICAgIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHRoaXMubG9nZ2VyLmxvZygnY2xvc2luZyBJTlZJVEUgc2Vzc2lvbiAnICsgdGhpcy5pZCk7CgogICAgLy8gMXN0IFN0ZXAuIFRlcm1pbmF0ZSBtZWRpYS4KICAgIGlmICh0aGlzLm1lZGlhSGFuZGxlcil7CiAgICAgIHRoaXMubWVkaWFIYW5kbGVyLmNsb3NlKCk7CiAgICB9CgogICAgLy8gMm5kIFN0ZXAuIFRlcm1pbmF0ZSBzaWduYWxpbmcuCgogICAgLy8gQ2xlYXIgc2Vzc2lvbiB0aW1lcnMKICAgIGZvcihpZHggaW4gdGhpcy50aW1lcnMpIHsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnNbaWR4XSk7CiAgICB9CgogICAgLy8gVGVybWluYXRlIGRpYWxvZ3MKCiAgICAvLyBUZXJtaW5hdGUgY29uZmlybWVkIGRpYWxvZwogICAgaWYodGhpcy5kaWFsb2cpIHsKICAgICAgdGhpcy5kaWFsb2cudGVybWluYXRlKCk7CiAgICAgIGRlbGV0ZSB0aGlzLmRpYWxvZzsKICAgIH0KCiAgICAvLyBUZXJtaW5hdGUgZWFybHkgZGlhbG9ncwogICAgZm9yKGlkeCBpbiB0aGlzLmVhcmx5RGlhbG9ncykgewogICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZHhdLnRlcm1pbmF0ZSgpOwogICAgICBkZWxldGUgdGhpcy5lYXJseURpYWxvZ3NbaWR4XTsKICAgIH0KCiAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX1RFUk1JTkFURUQ7CgogICAgZGVsZXRlIHRoaXMudWEuc2Vzc2lvbnNbdGhpcy5pZF07CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBjcmVhdGVEaWFsb2c6IGZ1bmN0aW9uKG1lc3NhZ2UsIHR5cGUsIGVhcmx5KSB7CiAgICB2YXIgZGlhbG9nLCBlYXJseV9kaWFsb2csCiAgICAgIGxvY2FsX3RhZyA9IG1lc3NhZ2VbKHR5cGUgPT09ICdVQVMnKSA/ICd0b190YWcnIDogJ2Zyb21fdGFnJ10sCiAgICAgIHJlbW90ZV90YWcgPSBtZXNzYWdlWyh0eXBlID09PSAnVUFTJykgPyAnZnJvbV90YWcnIDogJ3RvX3RhZyddLAogICAgICBpZCA9IG1lc3NhZ2UuY2FsbF9pZCArIGxvY2FsX3RhZyArIHJlbW90ZV90YWc7CgogICAgZWFybHlfZGlhbG9nID0gdGhpcy5lYXJseURpYWxvZ3NbaWRdOwoKICAgIC8vIEVhcmx5IERpYWxvZwogICAgaWYgKGVhcmx5KSB7CiAgICAgIGlmIChlYXJseV9kaWFsb2cpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBlYXJseV9kaWFsb2cgPSBuZXcgU0lQLkRpYWxvZyh0aGlzLCBtZXNzYWdlLCB0eXBlLCBTSVAuRGlhbG9nLkMuU1RBVFVTX0VBUkxZKTsKCiAgICAgICAgLy8gRGlhbG9nIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBjcmVhdGVkLgogICAgICAgIGlmKGVhcmx5X2RpYWxvZy5lcnJvcikgewogICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoZWFybHlfZGlhbG9nLmVycm9yKTsKICAgICAgICAgIHRoaXMuZmFpbGVkKG1lc3NhZ2UsIFNJUC5DLmNhdXNlcy5JTlRFUk5BTF9FUlJPUik7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXSA9IGVhcmx5X2RpYWxvZzsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLy8gQ29uZmlybWVkIERpYWxvZwogICAgZWxzZSB7CiAgICAgIC8vIEluIGNhc2UgdGhlIGRpYWxvZyBpcyBpbiBfZWFybHlfIHN0YXRlLCB1cGRhdGUgaXQKICAgICAgaWYgKGVhcmx5X2RpYWxvZykgewogICAgICAgIGVhcmx5X2RpYWxvZy51cGRhdGUobWVzc2FnZSwgdHlwZSk7CiAgICAgICAgdGhpcy5kaWFsb2cgPSBlYXJseV9kaWFsb2c7CiAgICAgICAgZGVsZXRlIHRoaXMuZWFybHlEaWFsb2dzW2lkXTsKICAgICAgICBmb3IgKHZhciBkaWEgaW4gdGhpcy5lYXJseURpYWxvZ3MpIHsKICAgICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2RpYV0udGVybWluYXRlKCk7CiAgICAgICAgICBkZWxldGUgdGhpcy5lYXJseURpYWxvZ3NbZGlhXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIC8vIE90aGVyd2lzZSwgY3JlYXRlIGEgX2NvbmZpcm1lZF8gZGlhbG9nCiAgICAgIGRpYWxvZyA9IG5ldyBTSVAuRGlhbG9nKHRoaXMsIG1lc3NhZ2UsIHR5cGUpOwoKICAgICAgaWYoZGlhbG9nLmVycm9yKSB7CiAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoZGlhbG9nLmVycm9yKTsKICAgICAgICB0aGlzLmZhaWxlZChtZXNzYWdlLCBTSVAuQy5jYXVzZXMuSU5URVJOQUxfRVJST1IpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRvX3RhZyA9IG1lc3NhZ2UudG9fdGFnOwogICAgICAgIHRoaXMuZGlhbG9nID0gZGlhbG9nOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9CiAgfSwKCiAgLyoqCiAgKiBDaGVjayBpZiBTZXNzaW9uIGlzIHJlYWR5IGZvciBhIHJlLUlOVklURQogICoKICAqIEByZXR1cm5zIHtCb29sZWFufQogICovCiAgaXNSZWFkeVRvUmVpbnZpdGU6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMubWVkaWFIYW5kbGVyLmlzUmVhZHkoKSAmJgogICAgICAhdGhpcy5kaWFsb2cudWFjX3BlbmRpbmdfcmVwbHkgJiYKICAgICAgIXRoaXMuZGlhbG9nLnVhc19wZW5kaW5nX3JlcGx5OwogIH0sCgogIC8qKgogICAqIE11dGUKICAgKi8KICBtdXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICB2YXIgcmV0ID0gdGhpcy5tZWRpYUhhbmRsZXIubXV0ZShvcHRpb25zKTsKICAgIGlmIChyZXQpIHsKICAgICAgdGhpcy5vbm11dGUocmV0KTsKICAgIH0KICB9LAoKICAvKioKICAgKiBVbm11dGUKICAgKi8KICB1bm11dGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIHZhciByZXQgPSB0aGlzLm1lZGlhSGFuZGxlci51bm11dGUob3B0aW9ucyk7CiAgICBpZiAocmV0KSB7CiAgICAgIHRoaXMub251bm11dGUocmV0KTsKICAgIH0KICB9LAoKICAvKioKICAgKiBIb2xkCiAgICovCiAgaG9sZDogZnVuY3Rpb24ob3B0aW9ucykgewoKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLICYmIHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICB0aGlzLm1lZGlhSGFuZGxlci5ob2xkKCk7CgogICAgLy8gQ2hlY2sgaWYgUlRDU2Vzc2lvbiBpcyByZWFkeSB0byBzZW5kIGEgcmVJTlZJVEUKICAgIGlmICghdGhpcy5pc1JlYWR5VG9SZWludml0ZSgpKSB7CiAgICAgIC8qIElmIHRoZXJlIGlzIGEgcGVuZGluZyAndW5ob2xkJyBhY3Rpb24sIGNhbmNlbCBpdCBhbmQgZG9uJ3QgcXVldWUgdGhpcyBvbmUKICAgICAgICogRWxzZSwgaWYgdGhlcmUgaXNuJ3QgYW55ICdob2xkJyBhY3Rpb24sIGFkZCB0aGlzIG9uZSB0byB0aGUgcXVldWUKICAgICAgICogRWxzZSwgaWYgdGhlcmUgaXMgYWxyZWFkeSBhICdob2xkJyBhY3Rpb24sIHNraXAKICAgICAgICovCiAgICAgIGlmICh0aGlzLnBlbmRpbmdfYWN0aW9ucy5pc1BlbmRpbmcoJ3VuaG9sZCcpKSB7CiAgICAgICAgdGhpcy5wZW5kaW5nX2FjdGlvbnMucG9wKCd1bmhvbGQnKTsKICAgICAgfSBlbHNlIGlmICghdGhpcy5wZW5kaW5nX2FjdGlvbnMuaXNQZW5kaW5nKCdob2xkJykpIHsKICAgICAgICB0aGlzLnBlbmRpbmdfYWN0aW9ucy5wdXNoKCdob2xkJyk7CiAgICAgIH0KICAgICAgcmV0dXJuOwogICAgfSBlbHNlIGlmICh0aGlzLmxvY2FsX2hvbGQgPT09IHRydWUpIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5vbmhvbGQoJ2xvY2FsJyk7CgogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgICBvcHRpb25zLm1hbmdsZSA9IGZ1bmN0aW9uKGJvZHkpewoKICAgICAgLy8gRG9uJ3QgcmVjZWl2ZSBtZWRpYQogICAgICAvLyBUT0RPIC0gVGhpcyB3aWxsIGJyZWFrIGZvciBtZWRpYSBzdHJlYW1zIHdpdGggZGlmZmVyZW50IGRpcmVjdGlvbnMuCiAgICAgIGlmICghKC9hPShzZW5kcmVjdnxzZW5kb25seXxyZWN2b25seXxpbmFjdGl2ZSkvKS50ZXN0KGJvZHkpKSB7CiAgICAgICAgYm9keSA9IGJvZHkucmVwbGFjZSgvKG09W15ccl0qXHJcbikvZywgJyQxYT1zZW5kb25seVxyXG4nKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBib2R5ID0gYm9keS5yZXBsYWNlKC9hPXNlbmRyZWN2XHJcbi9nLCAnYT1zZW5kb25seVxyXG4nKTsKICAgICAgICBib2R5ID0gYm9keS5yZXBsYWNlKC9hPXJlY3Zvbmx5XHJcbi9nLCAnYT1pbmFjdGl2ZVxyXG4nKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGJvZHk7CiAgICB9OwoKICAgIHRoaXMuc2VuZFJlaW52aXRlKG9wdGlvbnMpOwogIH0sCgogIC8qKgogICAqIFVuaG9sZAogICAqLwogIHVuaG9sZDogZnVuY3Rpb24ob3B0aW9ucykgewoKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLICYmIHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICB0aGlzLm1lZGlhSGFuZGxlci51bmhvbGQoKTsKCiAgICBpZiAoIXRoaXMuaXNSZWFkeVRvUmVpbnZpdGUoKSkgewogICAgICAvKiBJZiB0aGVyZSBpcyBhIHBlbmRpbmcgJ2hvbGQnIGFjdGlvbiwgY2FuY2VsIGl0IGFuZCBkb24ndCBxdWV1ZSB0aGlzIG9uZQogICAgICAgKiBFbHNlLCBpZiB0aGVyZSBpc24ndCBhbnkgJ3VuaG9sZCcgYWN0aW9uLCBhZGQgdGhpcyBvbmUgdG8gdGhlIHF1ZXVlCiAgICAgICAqIEVsc2UsIGlmIHRoZXJlIGlzIGFscmVhZHkgYSAndW5ob2xkJyBhY3Rpb24sIHNraXAKICAgICAgICovCiAgICAgIGlmICh0aGlzLnBlbmRpbmdfYWN0aW9ucy5pc1BlbmRpbmcoJ2hvbGQnKSkgewogICAgICAgIHRoaXMucGVuZGluZ19hY3Rpb25zLnBvcCgnaG9sZCcpOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnBlbmRpbmdfYWN0aW9ucy5pc1BlbmRpbmcoJ3VuaG9sZCcpKSB7CiAgICAgICAgdGhpcy5wZW5kaW5nX2FjdGlvbnMucHVzaCgndW5ob2xkJyk7CiAgICAgIH0KICAgICAgcmV0dXJuOwogICAgfSBlbHNlIGlmICh0aGlzLmxvY2FsX2hvbGQgPT09IGZhbHNlKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLm9udW5ob2xkKCdsb2NhbCcpOwoKICAgIHRoaXMuc2VuZFJlaW52aXRlKG9wdGlvbnMpOwogIH0sCgogIC8qKgogICAqIGlzT25Ib2xkCiAgICovCiAgaXNPbkhvbGQ6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9jYWw6IHRoaXMubG9jYWxfaG9sZCwKICAgICAgcmVtb3RlOiB0aGlzLnJlbW90ZV9ob2xkCiAgICB9OwogIH0sCgogIC8qKgogICAqIEluIGRpYWxvZyBJTlZJVEUgUmVjZXB0aW9uCiAgICogQHByaXZhdGUKICAgKi8KICByZWNlaXZlUmVpbnZpdGU6IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICBpZiAoIXJlcXVlc3QuYm9keSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHJlcXVlc3QuZ2V0SGVhZGVyKCdDb250ZW50LVR5cGUnKSAhPT0gJ2FwcGxpY2F0aW9uL3NkcCcpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybignaW52YWxpZCBDb250ZW50LVR5cGUnKTsKICAgICAgcmVxdWVzdC5yZXBseSg0MTUpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5tZWRpYUhhbmRsZXIuc2V0RGVzY3JpcHRpb24ocmVxdWVzdC5ib2R5KQogICAgLnRoZW4odGhpcy5tZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24uYmluZCh0aGlzLm1lZGlhSGFuZGxlciwgdGhpcy5tZWRpYUhpbnQpKQogICAgLnRoZW4oZnVuY3Rpb24oYm9keSkgewogICAgICByZXF1ZXN0LnJlcGx5KDIwMCwgbnVsbCwgWydDb250YWN0OiAnICsgc2VsZi5jb250YWN0XSwgYm9keSwKICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgIHNlbGYuc3RhdHVzID0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLOwogICAgICAgICAgc2VsZi5zZXRJbnZpdGUyeHhUaW1lcihyZXF1ZXN0LCBib2R5KTsKICAgICAgICAgIHNlbGYuc2V0QUNLVGltZXIoKTsKCiAgICAgICAgICAvLyBBcmUgd2UgaG9sZGluZz8KICAgICAgICAgIHZhciBob2xkID0gKC9hPShzZW5kb25seXxpbmFjdGl2ZSkvKS50ZXN0KHJlcXVlc3QuYm9keSk7CgogICAgICAgICAgaWYgKHNlbGYucmVtb3RlX2hvbGQgJiYgIWhvbGQpIHsKICAgICAgICAgICAgc2VsZi5vbnVuaG9sZCgncmVtb3RlJyk7CiAgICAgICAgICB9IGVsc2UgaWYgKCFzZWxmLnJlbW90ZV9ob2xkICYmIGhvbGQpIHsKICAgICAgICAgICAgc2VsZi5vbmhvbGQoJ3JlbW90ZScpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSkKICAgIC5jYXRjaChmdW5jdGlvbiBvbkZhaWx1cmUgKGUpIHsKICAgICAgdmFyIHN0YXR1c0NvZGU7CiAgICAgIGlmIChlIGluc3RhbmNlb2YgU0lQLkV4Y2VwdGlvbnMuR2V0RGVzY3JpcHRpb25FcnJvcikgewogICAgICAgIHN0YXR1c0NvZGUgPSA1MDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2VsZi5sb2dnZXIuZXJyb3IoZSk7CiAgICAgICAgc3RhdHVzQ29kZSA9IDQ4ODsKICAgICAgfQogICAgICByZXF1ZXN0LnJlcGx5KHN0YXR1c0NvZGUpOwogICAgfSk7CiAgfSwKCiAgc2VuZFJlaW52aXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgICB2YXIKICAgICAgc2VsZiA9IHRoaXMsCiAgICAgIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKSwKICAgICAgZXZlbnRIYW5kbGVycyA9IG9wdGlvbnMuZXZlbnRIYW5kbGVycyB8fCB7fSwKICAgICAgbWFuZ2xlID0gb3B0aW9ucy5tYW5nbGUgfHwgbnVsbCwKICAgICAgc3VjY2VlZGVkOwoKICAgIGlmIChldmVudEhhbmRsZXJzLnN1Y2NlZWRlZCkgewogICAgICBzdWNjZWVkZWQgPSBldmVudEhhbmRsZXJzLnN1Y2NlZWRlZDsKICAgIH0KICAgIHRoaXMucmVpbnZpdGVTdWNjZWVkZWQgPSBmdW5jdGlvbigpewogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dChzZWxmLnRpbWVycy5hY2tUaW1lcik7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHNlbGYudGltZXJzLmludml0ZTJ4eFRpbWVyKTsKICAgICAgc2VsZi5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgIHN1Y2NlZWRlZCAmJiBzdWNjZWVkZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgICBpZiAoZXZlbnRIYW5kbGVycy5mYWlsZWQpIHsKICAgICAgdGhpcy5yZWludml0ZUZhaWxlZCA9IGV2ZW50SGFuZGxlcnMuZmFpbGVkOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5yZWludml0ZUZhaWxlZCA9IGZ1bmN0aW9uKCl7fTsKICAgIH0KCiAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJyArIHRoaXMuY29udGFjdCk7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnQWxsb3c6ICcrIFNJUC5VQS5DLkFMTE9XRURfTUVUSE9EUy50b1N0cmluZygpKTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3NkcCcpOwoKICAgIHRoaXMucmVjZWl2ZVJlc3BvbnNlID0gdGhpcy5yZWNlaXZlUmVpbnZpdGVSZXNwb25zZTsKICAgIC8vUkVWSVNJVAogICAgdGhpcy5tZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24oc2VsZi5tZWRpYUhpbnQpCiAgICAudGhlbihtYW5nbGUpCiAgICAudGhlbigKICAgICAgZnVuY3Rpb24oYm9keSl7CiAgICAgICAgc2VsZi5kaWFsb2cuc2VuZFJlcXVlc3Qoc2VsZiwgU0lQLkMuSU5WSVRFLCB7CiAgICAgICAgICBleHRyYUhlYWRlcnM6IGV4dHJhSGVhZGVycywKICAgICAgICAgIGJvZHk6IGJvZHkKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKHNlbGYuaXNSZWFkeVRvUmVpbnZpdGUoKSkgewogICAgICAgICAgc2VsZi5vblJlYWR5VG9SZWludml0ZSgpOwogICAgICAgIH0KICAgICAgICBzZWxmLnJlaW52aXRlRmFpbGVkKCk7CiAgICAgIH0KICAgICk7CiAgfSwKCiAgcmVjZWl2ZVJlcXVlc3Q6IGZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgICBzd2l0Y2ggKHJlcXVlc3QubWV0aG9kKSB7CiAgICAgIGNhc2UgU0lQLkMuQllFOgogICAgICAgIHJlcXVlc3QucmVwbHkoMjAwKTsKICAgICAgICBpZih0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgICAgICB0aGlzLmVtaXQoJ2J5ZScsIHJlcXVlc3QpOwogICAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5CWUUpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBTSVAuQy5JTlZJVEU6CiAgICAgICAgaWYodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICAgICAgdGhpcy5sb2dnZXIubG9nKCdyZS1JTlZJVEUgcmVjZWl2ZWQnKTsKICAgICAgICAgIHRoaXMucmVjZWl2ZVJlaW52aXRlKHJlcXVlc3QpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBTSVAuQy5JTkZPOgogICAgICAgIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSykgewogICAgICAgICAgdmFyIGJvZHksIHRvbmUsIGR1cmF0aW9uLAogICAgICAgICAgICAgIGNvbnRlbnRUeXBlID0gcmVxdWVzdC5nZXRIZWFkZXIoJ2NvbnRlbnQtdHlwZScpLAogICAgICAgICAgICAgIHJlZ190b25lID0gL14oU2lnbmFsXHMqPz1ccyo/KShbMC05QS1EIypdezF9KShccyk/LiovLAogICAgICAgICAgICAgIHJlZ19kdXJhdGlvbiA9IC9eKER1cmF0aW9uXHM/PVxzPykoWzAtOV17MSw0fSkoXHMpPy4qLzsKCiAgICAgICAgICBpZiAoY29udGVudFR5cGUpIHsKICAgICAgICAgICAgaWYgKGNvbnRlbnRUeXBlLm1hdGNoKC9eYXBwbGljYXRpb25cL2R0bWYtcmVsYXkvaSkpIHsKICAgICAgICAgICAgICBpZiAocmVxdWVzdC5ib2R5KSB7CiAgICAgICAgICAgICAgICBib2R5ID0gcmVxdWVzdC5ib2R5LnNwbGl0KCdcclxuJywgMik7CiAgICAgICAgICAgICAgICBpZiAoYm9keS5sZW5ndGggPT09IDIpIHsKICAgICAgICAgICAgICAgICAgaWYgKHJlZ190b25lLnRlc3QoYm9keVswXSkpIHsKICAgICAgICAgICAgICAgICAgICB0b25lID0gYm9keVswXS5yZXBsYWNlKHJlZ190b25lLCIkMiIpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmIChyZWdfZHVyYXRpb24udGVzdChib2R5WzFdKSkgewogICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gcGFyc2VJbnQoYm9keVsxXS5yZXBsYWNlKHJlZ19kdXJhdGlvbiwiJDIiKSwgMTApOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBuZXcgRFRNRih0aGlzLCB0b25lLCB7ZHVyYXRpb246IGR1cmF0aW9ufSkuaW5pdF9pbmNvbWluZyhyZXF1ZXN0KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXF1ZXN0LnJlcGx5KDQxNSwgbnVsbCwgWyJBY2NlcHQ6IGFwcGxpY2F0aW9uL2R0bWYtcmVsYXkiXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgU0lQLkMuUkVGRVI6CiAgICAgICAgaWYodGhpcy5zdGF0dXMgPT09ICBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLmxvZygnUkVGRVIgcmVjZWl2ZWQnKTsKICAgICAgICAgIHZhciBoYXNSZWZlckxpc3RlbmVyID0gdGhpcy5saXN0ZW5lcnMoJ3JlZmVyJykubGVuZ3RoLAogICAgICAgICAgICAgIG5vdGlmeUJvZHk7CgogICAgICAgICAgaWYgKGhhc1JlZmVyTGlzdGVuZXIpIHsKICAgICAgICAgICAgcmVxdWVzdC5yZXBseSgyMDIsICdBY2NlcHRlZCcpOwogICAgICAgICAgICBub3RpZnlCb2R5ID0gJ1NJUC8yLjAgMTAwIFRyeWluZyc7CgogICAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLk5PVElGWSwgewogICAgICAgICAgICAgIGV4dHJhSGVhZGVyczpbCiAgICAgICAgICAgICAgICAnRXZlbnQ6IHJlZmVyJywKICAgICAgICAgICAgICAgICdTdWJzY3JpcHRpb24tU3RhdGU6IHRlcm1pbmF0ZWQnLAogICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZTogbWVzc2FnZS9zaXBmcmFnJwogICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgYm9keTogbm90aWZ5Qm9keSwKICAgICAgICAgICAgICByZWNlaXZlUmVzcG9uc2U6IGZ1bmN0aW9uKCkge30KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICB0aGlzLmVtaXQoJ3JlZmVyJywgcmVxdWVzdCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBSRkMgMzUxNS4yLjQuMjogJ3RoZSBVQSBNQVkgZGVjbGluZSB0aGUgcmVxdWVzdC4nCiAgICAgICAgICAgIHJlcXVlc3QucmVwbHkoNjAzLCAnRGVjbGluZWQnKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgU0lQLkMuTk9USUZZOgogICAgICAgIHJlcXVlc3QucmVwbHkoMjAwLCAnT0snKTsKICAgICAgICB0aGlzLmVtaXQoJ25vdGlmeScsIHJlcXVlc3QpOwogICAgICAgIGJyZWFrOwogICAgfQogIH0sCgogIC8qKgogICAqIFJlY2VwdGlvbiBvZiBSZXNwb25zZSBmb3IgaW4tZGlhbG9nIElOVklURQogICAqIEBwcml2YXRlCiAgICovCiAgcmVjZWl2ZVJlaW52aXRlUmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgY29udGVudFR5cGUgPSByZXNwb25zZS5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpOwoKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgc3dpdGNoKHRydWUpIHsKICAgICAgY2FzZSAvXjFbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgIGJyZWFrOwogICAgICBjYXNlIC9eMlswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CgogICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuQUNLLHtjc2VxOnJlc3BvbnNlLmNzZXF9KTsKCiAgICAgICAgaWYoIXJlc3BvbnNlLmJvZHkpIHsKICAgICAgICAgIHRoaXMucmVpbnZpdGVGYWlsZWQoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0gZWxzZSBpZiAoY29udGVudFR5cGUgIT09ICdhcHBsaWNhdGlvbi9zZHAnKSB7CiAgICAgICAgICB0aGlzLnJlaW52aXRlRmFpbGVkKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIC8vUkVWSVNJVAogICAgICAgIHRoaXMubWVkaWFIYW5kbGVyLnNldERlc2NyaXB0aW9uKHJlc3BvbnNlLmJvZHkpCiAgICAgICAgLnRoZW4oCiAgICAgICAgICBmdW5jdGlvbiBvblN1Y2Nlc3MgKCkgewogICAgICAgICAgICBzZWxmLnJlaW52aXRlU3VjY2VlZGVkKCk7CiAgICAgICAgICB9LAogICAgICAgICAgZnVuY3Rpb24gb25GYWlsdXJlICgpIHsKICAgICAgICAgICAgc2VsZi5yZWludml0ZUZhaWxlZCgpOwogICAgICAgICAgfQogICAgICAgICk7CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhpcy5yZWludml0ZUZhaWxlZCgpOwogICAgfQogIH0sCgogIGFjY2VwdEFuZFRlcm1pbmF0ZTogZnVuY3Rpb24ocmVzcG9uc2UsIHN0YXR1c19jb2RlLCByZWFzb25fcGhyYXNlKSB7CiAgICB2YXIgZXh0cmFIZWFkZXJzID0gW107CgogICAgaWYgKHN0YXR1c19jb2RlKSB7CiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZWFzb246ICcgKyBTSVAuVXRpbHMuZ2V0UmVhc29uSGVhZGVyVmFsdWUoc3RhdHVzX2NvZGUsIHJlYXNvbl9waHJhc2UpKTsKICAgIH0KCiAgICAvLyBBbiBlcnJvciBvbiBkaWFsb2cgY3JlYXRpb24gd2lsbCBmaXJlICdmYWlsZWQnIGV2ZW50CiAgICBpZiAodGhpcy5kaWFsb2cgfHwgdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnKSkgewogICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLkFDSyx7Y3NlcTogcmVzcG9uc2UuY3NlcX0pOwogICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLkJZRSwgewogICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzCiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAqIFJGQzMyNjEgMTMuMy4xLjQKICAgKiBSZXNwb25zZSByZXRyYW5zbWlzc2lvbnMgY2Fubm90IGJlIGFjY29tcGxpc2hlZCBieSB0cmFuc2FjdGlvbiBsYXllcgogICAqICBzaW5jZSBpdCBpcyBkZXN0cm95ZWQgd2hlbiByZWNlaXZpbmcgdGhlIGZpcnN0IDJ4eCBhbnN3ZXIKICAgKi8KICBzZXRJbnZpdGUyeHhUaW1lcjogZnVuY3Rpb24ocmVxdWVzdCwgYm9keSkgewogICAgdmFyIHNlbGYgPSB0aGlzLAogICAgICAgIHRpbWVvdXQgPSBTSVAuVGltZXJzLlQxOwoKICAgIHRoaXMudGltZXJzLmludml0ZTJ4eFRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uIGludml0ZTJ4eFJldHJhbnNtaXNzaW9uKCkgewogICAgICBpZiAoc2VsZi5zdGF0dXMgIT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgc2VsZi5sb2dnZXIubG9nKCdubyBBQ0sgcmVjZWl2ZWQsIGF0dGVtcHRpbmcgdG8gcmV0cmFuc21pdCBPSycpOwoKICAgICAgcmVxdWVzdC5yZXBseSgyMDAsIG51bGwsIFsnQ29udGFjdDogJyArIHNlbGYuY29udGFjdF0sIGJvZHkpOwoKICAgICAgdGltZW91dCA9IE1hdGgubWluKHRpbWVvdXQgKiAyLCBTSVAuVGltZXJzLlQyKTsKCiAgICAgIHNlbGYudGltZXJzLmludml0ZTJ4eFRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGludml0ZTJ4eFJldHJhbnNtaXNzaW9uLCB0aW1lb3V0KTsKICAgIH0sIHRpbWVvdXQpOwogIH0sCgogIC8qKgogICAqIFJGQzMyNjEgMTQuMgogICAqIElmIGEgVUFTIGdlbmVyYXRlcyBhIDJ4eCByZXNwb25zZSBhbmQgbmV2ZXIgcmVjZWl2ZXMgYW4gQUNLLAogICAqICBpdCBTSE9VTEQgZ2VuZXJhdGUgYSBCWUUgdG8gdGVybWluYXRlIHRoZSBkaWFsb2cuCiAgICovCiAgc2V0QUNLVGltZXI6IGZ1bmN0aW9uKCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgIHRoaXMudGltZXJzLmFja1RpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICBpZihzZWxmLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLKSB7CiAgICAgICAgc2VsZi5sb2dnZXIubG9nKCdubyBBQ0sgcmVjZWl2ZWQgZm9yIGFuIGV4dGVuZGVkIHBlcmlvZCBvZiB0aW1lLCB0ZXJtaW5hdGluZyB0aGUgY2FsbCcpOwogICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHNlbGYudGltZXJzLmludml0ZTJ4eFRpbWVyKTsKICAgICAgICBzZWxmLnNlbmRSZXF1ZXN0KFNJUC5DLkJZRSk7CiAgICAgICAgc2VsZi50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5OT19BQ0spOwogICAgICB9CiAgICB9LCBTSVAuVGltZXJzLlRJTUVSX0gpOwogIH0sCgogIC8qCiAgICogQHByaXZhdGUKICAgKi8KICBvblJlYWR5VG9SZWludml0ZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgYWN0aW9uID0gdGhpcy5wZW5kaW5nX2FjdGlvbnMuc2hpZnQoKTsKCiAgICBpZiAoIWFjdGlvbiB8fCAhdGhpc1thY3Rpb24ubmFtZV0pIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXNbYWN0aW9uLm5hbWVdKCk7CiAgfSwKCiAgb25UcmFuc3BvcnRFcnJvcjogZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX0NPTkZJUk1FRCAmJiB0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICB0aGlzLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICB9CiAgfSwKCiAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICB9CiAgfSwKCiAgb25EaWFsb2dFcnJvcjogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRoaXMudGVybWluYXRlZChyZXNwb25zZSwgU0lQLkMuY2F1c2VzLkRJQUxPR19FUlJPUik7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuRElBTE9HX0VSUk9SKTsKICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuRElBTE9HX0VSUk9SKTsKICAgIH0KICB9LAoKICAvKioKICAgKiBAcHJpdmF0ZQogICAqLwogIG9uaG9sZDogZnVuY3Rpb24ob3JpZ2luYXRvcikgewogICAgdGhpc1tvcmlnaW5hdG9yID09PSAnbG9jYWwnID8gJ2xvY2FsX2hvbGQnIDogJ3JlbW90ZV9ob2xkJ10gPSB0cnVlOwogICAgdGhpcy5lbWl0KCdob2xkJywgeyBvcmlnaW5hdG9yOiBvcmlnaW5hdG9yIH0pOwogIH0sCgogIC8qKgogICAqIEBwcml2YXRlCiAgICovCiAgb251bmhvbGQ6IGZ1bmN0aW9uKG9yaWdpbmF0b3IpIHsKICAgIHRoaXNbb3JpZ2luYXRvciA9PT0gJ2xvY2FsJyA/ICdsb2NhbF9ob2xkJyA6ICdyZW1vdGVfaG9sZCddID0gZmFsc2U7CiAgICB0aGlzLmVtaXQoJ3VuaG9sZCcsIHsgb3JpZ2luYXRvcjogb3JpZ2luYXRvciB9KTsKICB9LAoKICAvKgogICAqIEBwcml2YXRlCiAgICovCiAgb25tdXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICB0aGlzLmVtaXQoJ211dGVkJywgewogICAgICBhdWRpbzogb3B0aW9ucy5hdWRpbywKICAgICAgdmlkZW86IG9wdGlvbnMudmlkZW8KICAgIH0pOwogIH0sCgogIC8qCiAgICogQHByaXZhdGUKICAgKi8KICBvbnVubXV0ZTogZnVuY3Rpb24ob3B0aW9ucykgewogICAgdGhpcy5lbWl0KCd1bm11dGVkJywgewogICAgICBhdWRpbzogb3B0aW9ucy5hdWRpbywKICAgICAgdmlkZW86IG9wdGlvbnMudmlkZW8KICAgIH0pOwogIH0sCgogIGZhaWxlZDogZnVuY3Rpb24ocmVzcG9uc2UsIGNhdXNlKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIHJlc3BvbnNlIHx8IG51bGwsIGNhdXNlIHx8IG51bGwpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgcmVqZWN0ZWQ6IGZ1bmN0aW9uKHJlc3BvbnNlLCBjYXVzZSkgewogICAgdGhpcy5lbWl0KCdyZWplY3RlZCcsCiAgICAgIHJlc3BvbnNlIHx8IG51bGwsCiAgICAgIGNhdXNlIHx8IG51bGwKICAgICk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBjYW5jZWxlZDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmVtaXQoJ2NhbmNlbCcpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgYWNjZXB0ZWQ6IGZ1bmN0aW9uKHJlc3BvbnNlLCBjYXVzZSkgewogICAgY2F1c2UgPSBTSVAuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlLCBjYXVzZSk7CgogICAgdGhpcy5zdGFydFRpbWUgPSBuZXcgRGF0ZSgpOwoKICAgIGlmICh0aGlzLnJlcGxhY2VlKSB7CiAgICAgIHRoaXMucmVwbGFjZWUuZW1pdCgncmVwbGFjZWQnLCB0aGlzKTsKICAgICAgdGhpcy5yZXBsYWNlZS50ZXJtaW5hdGUoKTsKICAgIH0KICAgIHRoaXMuZW1pdCgnYWNjZXB0ZWQnLCByZXNwb25zZSwgY2F1c2UpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgdGVybWluYXRlZDogZnVuY3Rpb24obWVzc2FnZSwgY2F1c2UpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICB0aGlzLmVuZFRpbWUgPSBuZXcgRGF0ZSgpOwoKICAgIHRoaXMuY2xvc2UoKTsKICAgIHRoaXMuZW1pdCgndGVybWluYXRlZCcsCiAgICAgIG1lc3NhZ2UgfHwgbnVsbCwKICAgICAgY2F1c2UgfHwgbnVsbAogICAgKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIGNvbm5lY3Rpbmc6IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICAgIHRoaXMuZW1pdCgnY29ubmVjdGluZycsIHsgcmVxdWVzdDogcmVxdWVzdCB9KTsKICAgIHJldHVybiB0aGlzOwogIH0KfTsKClNlc3Npb24uZGVzdWdhciA9IGZ1bmN0aW9uIGRlc3VnYXIob3B0aW9ucykgewogIGlmIChlbnZpcm9ubWVudC5IVE1MTWVkaWFFbGVtZW50ICYmIG9wdGlvbnMgaW5zdGFuY2VvZiBlbnZpcm9ubWVudC5IVE1MTWVkaWFFbGVtZW50KSB7CiAgICBvcHRpb25zID0gewogICAgICBtZWRpYTogewogICAgICAgIGNvbnN0cmFpbnRzOiB7CiAgICAgICAgICBhdWRpbzogdHJ1ZSwKICAgICAgICAgIHZpZGVvOiBvcHRpb25zLnRhZ05hbWUgPT09ICdWSURFTycKICAgICAgICB9LAogICAgICAgIHJlbmRlcjogewogICAgICAgICAgcmVtb3RlOiBvcHRpb25zCiAgICAgICAgfQogICAgICB9CiAgICB9OwogIH0KICByZXR1cm4gb3B0aW9ucyB8fCB7fTsKfTsKCgpTZXNzaW9uLkMgPSBDOwpTSVAuU2Vzc2lvbiA9IFNlc3Npb247CgoKSW52aXRlU2VydmVyQ29udGV4dCA9IGZ1bmN0aW9uKHVhLCByZXF1ZXN0KSB7CiAgdmFyIGV4cGlyZXMsCiAgICBzZWxmID0gdGhpcywKICAgIGNvbnRlbnRUeXBlID0gcmVxdWVzdC5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpLAogICAgY29udGVudERpc3AgPSByZXF1ZXN0LnBhcnNlSGVhZGVyKCdDb250ZW50LURpc3Bvc2l0aW9uJyk7CgogIC8vIENoZWNrIGJvZHkgYW5kIGNvbnRlbnQgdHlwZQogIGlmICgoIWNvbnRlbnREaXNwICYmIGNvbnRlbnRUeXBlICE9PSAnYXBwbGljYXRpb24vc2RwJykgfHwgKGNvbnRlbnREaXNwICYmIGNvbnRlbnREaXNwLnR5cGUgPT09ICdyZW5kZXInKSkgewogICAgdGhpcy5yZW5kZXJib2R5ID0gcmVxdWVzdC5ib2R5OwogICAgdGhpcy5yZW5kZXJ0eXBlID0gY29udGVudFR5cGU7CiAgfSBlbHNlIGlmIChjb250ZW50VHlwZSAhPT0gJ2FwcGxpY2F0aW9uL3NkcCcgJiYgKGNvbnRlbnREaXNwICYmIGNvbnRlbnREaXNwLnR5cGUgPT09ICdzZXNzaW9uJykpIHsKICAgIHJlcXVlc3QucmVwbHkoNDE1KTsKICAgIC8vVE9ETzogaW5zdGVhZCBvZiA0MTUsIHBhc3Mgb2ZmIHRvIHRoZSBtZWRpYSBoYW5kbGVyLCB3aG8gY2FuIHRoZW4gZGVjaWRlIGlmIHdlIGNhbiB1c2UgaXQKICAgIHJldHVybjsKICB9CgogIC8vVE9ETzogbW92ZSB0aGlzIGludG8gbWVkaWEgaGFuZGxlcgogIFNJUC5IYWNrcy5GaXJlZm94LmNhbm5vdEhhbmRsZUV4dHJhV2hpdGVzcGFjZShyZXF1ZXN0KTsKICBTSVAuSGFja3MuQWxsQnJvd3NlcnMubWFza0R0bHMocmVxdWVzdCk7CgogIFNJUC5VdGlscy5hdWdtZW50KHRoaXMsIFNJUC5TZXJ2ZXJDb250ZXh0LCBbdWEsIHJlcXVlc3RdKTsKICBTSVAuVXRpbHMuYXVnbWVudCh0aGlzLCBTSVAuU2Vzc2lvbiwgW3VhLmNvbmZpZ3VyYXRpb24ubWVkaWFIYW5kbGVyRmFjdG9yeV0pOwoKICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0lOVklURV9SRUNFSVZFRDsKICB0aGlzLmZyb21fdGFnID0gcmVxdWVzdC5mcm9tX3RhZzsKICB0aGlzLmlkID0gcmVxdWVzdC5jYWxsX2lkICsgdGhpcy5mcm9tX3RhZzsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwogIHRoaXMuY29udGFjdCA9IHRoaXMudWEuY29udGFjdC50b1N0cmluZygpOwoKICB0aGlzLnJlY2VpdmVOb25JbnZpdGVSZXNwb25zZSA9IGZ1bmN0aW9uICgpIHt9OyAvLyBpbnRlbnRpb25hbCBuby1vcAoKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLmludml0ZXNlcnZlcmNvbnRleHQnLCB0aGlzLmlkKTsKCiAgLy9TYXZlIHRoZSBzZXNzaW9uIGludG8gdGhlIHVhIHNlc3Npb25zIGNvbGxlY3Rpb24uCiAgdGhpcy51YS5zZXNzaW9uc1t0aGlzLmlkXSA9IHRoaXM7CgogIC8vR2V0IHRoZSBFeHBpcmVzIGhlYWRlciB2YWx1ZSBpZiBleGlzdHMKICBpZihyZXF1ZXN0Lmhhc0hlYWRlcignZXhwaXJlcycpKSB7CiAgICBleHBpcmVzID0gcmVxdWVzdC5nZXRIZWFkZXIoJ2V4cGlyZXMnKSAqIDEwMDA7CiAgfQoKICAvL1NldCAxMDByZWwgaWYgbmVjZXNzYXJ5CiAgZnVuY3Rpb24gc2V0MTAwcmVsKGgsYykgewogICAgaWYgKHJlcXVlc3QuaGFzSGVhZGVyKGgpICYmIHJlcXVlc3QuZ2V0SGVhZGVyKGgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZignMTAwcmVsJykgPj0gMCkgewogICAgICBzZWxmLnJlbDEwMCA9IGM7CiAgICB9CiAgfQogIHNldDEwMHJlbCgncmVxdWlyZScsIFNJUC5DLnN1cHBvcnRlZC5SRVFVSVJFRCk7CiAgc2V0MTAwcmVsKCdzdXBwb3J0ZWQnLCBTSVAuQy5zdXBwb3J0ZWQuU1VQUE9SVEVEKTsKCiAgLyogU2V0IHRoZSB0b190YWcgYmVmb3JlCiAgICogcmVwbHlpbmcgYSByZXNwb25zZSBjb2RlIHRoYXQgd2lsbCBjcmVhdGUgYSBkaWFsb2cuCiAgICovCiAgcmVxdWVzdC50b190YWcgPSBTSVAuVXRpbHMubmV3VGFnKCk7CgogIC8vIEFuIGVycm9yIG9uIGRpYWxvZyBjcmVhdGlvbiB3aWxsIGZpcmUgJ2ZhaWxlZCcgZXZlbnQKICBpZighdGhpcy5jcmVhdGVEaWFsb2cocmVxdWVzdCwgJ1VBUycsIHRydWUpKSB7CiAgICByZXF1ZXN0LnJlcGx5KDUwMCwgJ01pc3NpbmcgQ29udGFjdCBoZWFkZXIgZmllbGQnKTsKICAgIHJldHVybjsKICB9CgogIC8vSW5pdGlhbGl6ZSBNZWRpYSBTZXNzaW9uCiAgdGhpcy5tZWRpYUhhbmRsZXIgPSB0aGlzLm1lZGlhSGFuZGxlckZhY3RvcnkodGhpcywgewogICAgUlRDQ29uc3RyYWludHM6IHsib3B0aW9uYWwiOiBbeydEdGxzU3J0cEtleUFncmVlbWVudCc6ICd0cnVlJ31dfQogIH0pOwoKICBpZiAodGhpcy5tZWRpYUhhbmRsZXIgJiYgdGhpcy5tZWRpYUhhbmRsZXIuZ2V0UmVtb3RlU3RyZWFtcykgewogICAgdGhpcy5nZXRSZW1vdGVTdHJlYW1zID0gdGhpcy5tZWRpYUhhbmRsZXIuZ2V0UmVtb3RlU3RyZWFtcy5iaW5kKHRoaXMubWVkaWFIYW5kbGVyKTsKICAgIHRoaXMuZ2V0TG9jYWxTdHJlYW1zID0gdGhpcy5tZWRpYUhhbmRsZXIuZ2V0TG9jYWxTdHJlYW1zLmJpbmQodGhpcy5tZWRpYUhhbmRsZXIpOwogIH0KCiAgZnVuY3Rpb24gZmlyZU5ld1Nlc3Npb24oKSB7CiAgICB2YXIgb3B0aW9ucyA9IHtleHRyYUhlYWRlcnM6IFsnQ29udGFjdDogJyArIHNlbGYuY29udGFjdF19OwoKICAgIGlmIChzZWxmLnJlbDEwMCAhPT0gU0lQLkMuc3VwcG9ydGVkLlJFUVVJUkVEKSB7CiAgICAgIHNlbGYucHJvZ3Jlc3Mob3B0aW9ucyk7CiAgICB9CiAgICBzZWxmLnN0YXR1cyA9IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUjsKCiAgICAvLyBTZXQgdXNlck5vQW5zd2VyVGltZXIKICAgIHNlbGYudGltZXJzLnVzZXJOb0Fuc3dlclRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICByZXF1ZXN0LnJlcGx5KDQwOCk7CiAgICAgIHNlbGYuZmFpbGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5OT19BTlNXRVIpOwogICAgICBzZWxmLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLk5PX0FOU1dFUik7CiAgICB9LCBzZWxmLnVhLmNvbmZpZ3VyYXRpb24ubm9BbnN3ZXJUaW1lb3V0KTsKCiAgICAvKiBTZXQgZXhwaXJlc1RpbWVyCiAgICAgKiBSRkMzMjYxIDEzLjMuMQogICAgICovCiAgICBpZiAoZXhwaXJlcykgewogICAgICBzZWxmLnRpbWVycy5leHBpcmVzVGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgaWYoc2VsZi5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUikgewogICAgICAgICAgcmVxdWVzdC5yZXBseSg0ODcpOwogICAgICAgICAgc2VsZi5mYWlsZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkVYUElSRVMpOwogICAgICAgICAgc2VsZi50ZXJtaW5hdGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5FWFBJUkVTKTsKICAgICAgICB9CiAgICAgIH0sIGV4cGlyZXMpOwogICAgfQoKICAgIHNlbGYuZW1pdCgnaW52aXRlJyxyZXF1ZXN0KTsKICB9CgogIGlmICghcmVxdWVzdC5ib2R5IHx8IHRoaXMucmVuZGVyYm9keSkgewogICAgU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZpcmVOZXdTZXNzaW9uLCAwKTsKICB9IGVsc2UgewogICAgdGhpcy5oYXNPZmZlciA9IHRydWU7CiAgICB0aGlzLm1lZGlhSGFuZGxlci5zZXREZXNjcmlwdGlvbihyZXF1ZXN0LmJvZHkpCiAgICAudGhlbigKICAgICAgZmlyZU5ld1Nlc3Npb24sCiAgICAgIGZ1bmN0aW9uIG9uRmFpbHVyZSAoZSkgewogICAgICAgIHNlbGYubG9nZ2VyLndhcm4oJ2ludmFsaWQgU0RQJyk7CiAgICAgICAgc2VsZi5sb2dnZXIud2FybihlKTsKICAgICAgICByZXF1ZXN0LnJlcGx5KDQ4OCk7CiAgICAgIH0KICAgICk7CiAgfQp9OwoKSW52aXRlU2VydmVyQ29udGV4dC5wcm90b3R5cGUgPSB7CiAgcmVqZWN0OiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5JbnZhbGlkU3RhdGVFcnJvcih0aGlzLnN0YXR1cyk7CiAgICB9CgogICAgdGhpcy5sb2dnZXIubG9nKCdyZWplY3RpbmcgUlRDU2Vzc2lvbicpOwoKICAgIFNJUC5TZXJ2ZXJDb250ZXh0LnByb3RvdHlwZS5yZWplY3QuY2FsbCh0aGlzLCBvcHRpb25zKTsKICAgIHJldHVybiB0aGlzLnRlcm1pbmF0ZWQoKTsKICB9LAoKICB0ZXJtaW5hdGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIHZhcgogICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgYm9keSA9IG9wdGlvbnMuYm9keSwKICAgIGRpYWxvZywKICAgIHNlbGYgPSB0aGlzOwoKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLICYmCiAgICAgICB0aGlzLnJlcXVlc3Quc2VydmVyX3RyYW5zYWN0aW9uLnN0YXRlICE9PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgZGlhbG9nID0gdGhpcy5kaWFsb2c7CgogICAgICB0aGlzLnJlY2VpdmVSZXF1ZXN0ID0gZnVuY3Rpb24ocmVxdWVzdCkgewogICAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gU0lQLkMuQUNLKSB7CiAgICAgICAgICB0aGlzLnJlcXVlc3QoU0lQLkMuQllFLCB7CiAgICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzLAogICAgICAgICAgICBib2R5OiBib2R5CiAgICAgICAgICB9KTsKICAgICAgICAgIGRpYWxvZy50ZXJtaW5hdGUoKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICB0aGlzLnJlcXVlc3Quc2VydmVyX3RyYW5zYWN0aW9uLm9uKCdzdGF0ZUNoYW5nZWQnLCBmdW5jdGlvbigpewogICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgIHRoaXMucmVxdWVzdCA9IG5ldyBTSVAuT3V0Z29pbmdSZXF1ZXN0KAogICAgICAgICAgICBTSVAuQy5CWUUsCiAgICAgICAgICAgIHRoaXMuZGlhbG9nLnJlbW90ZV90YXJnZXQsCiAgICAgICAgICAgIHRoaXMudWEsCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAnY3NlcSc6IHRoaXMuZGlhbG9nLmxvY2FsX3NlcW51bSs9MSwKICAgICAgICAgICAgICAnY2FsbF9pZCc6IHRoaXMuZGlhbG9nLmlkLmNhbGxfaWQsCiAgICAgICAgICAgICAgJ2Zyb21fdXJpJzogdGhpcy5kaWFsb2cubG9jYWxfdXJpLAogICAgICAgICAgICAgICdmcm9tX3RhZyc6IHRoaXMuZGlhbG9nLmlkLmxvY2FsX3RhZywKICAgICAgICAgICAgICAndG9fdXJpJzogdGhpcy5kaWFsb2cucmVtb3RlX3VyaSwKICAgICAgICAgICAgICAndG9fdGFnJzogdGhpcy5kaWFsb2cuaWQucmVtb3RlX3RhZywKICAgICAgICAgICAgICAncm91dGVfc2V0JzogdGhpcy5kaWFsb2cucm91dGVfc2V0CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGV4dHJhSGVhZGVycywKICAgICAgICAgICAgYm9keQogICAgICAgICAgKTsKCiAgICAgICAgICBuZXcgU0lQLlJlcXVlc3RTZW5kZXIoCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICByZXF1ZXN0OiB0aGlzLnJlcXVlc3QsCiAgICAgICAgICAgICAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICBzZWxmLm9uUmVxdWVzdFRpbWVvdXQoKTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgc2VsZi5vblRyYW5zcG9ydEVycm9yKCk7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICByZWNlaXZlUmVzcG9uc2U6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgdGhpcy51YQogICAgICAgICAgKS5zZW5kKCk7CiAgICAgICAgICBkaWFsb2cudGVybWluYXRlKCk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIHRoaXMuZW1pdCgnYnllJywgdGhpcy5yZXF1ZXN0KTsKICAgICAgdGhpcy50ZXJtaW5hdGVkKCk7CgogICAgICAvLyBSZXN0b3JlIHRoZSBkaWFsb2cgaW50byAndGhpcycgaW4gb3JkZXIgdG8gYmUgYWJsZSB0byBzZW5kIHRoZSBpbi1kaWFsb2cgQllFIDotKQogICAgICB0aGlzLmRpYWxvZyA9IGRpYWxvZzsKCiAgICAgIC8vIFJlc3RvcmUgdGhlIGRpYWxvZyBpbnRvICd1YScgc28gdGhlIEFDSyBjYW4gcmVhY2ggJ3RoaXMnIHNlc3Npb24KICAgICAgdGhpcy51YS5kaWFsb2dzW2RpYWxvZy5pZC50b1N0cmluZygpXSA9IGRpYWxvZzsKCiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy5ieWUob3B0aW9ucyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnJlamVjdChvcHRpb25zKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKgogICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5tZWRpYV0gZ2V0cyBwYXNzZWQgdG8gU0lQLk1lZGlhSGFuZGxlci5nZXREZXNjcmlwdGlvbiBhcyBtZWRpYUhpbnQKICAgKi8KICBwcm9ncmVzczogZnVuY3Rpb24gKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogICAgdmFyCiAgICAgIHN0YXR1c0NvZGUgPSBvcHRpb25zLnN0YXR1c0NvZGUgfHwgMTgwLAogICAgICByZWFzb25QaHJhc2UgPSBvcHRpb25zLnJlYXNvblBocmFzZSwKICAgICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgICBpY2VTZXJ2ZXJzLAogICAgICBzdHVuU2VydmVycyA9IG9wdGlvbnMuc3R1blNlcnZlcnMgfHwgbnVsbCwKICAgICAgdHVyblNlcnZlcnMgPSBvcHRpb25zLnR1cm5TZXJ2ZXJzIHx8IG51bGwsCiAgICAgIGJvZHkgPSBvcHRpb25zLmJvZHksCiAgICAgIHJlc3BvbnNlOwoKICAgIGlmIChzdGF0dXNDb2RlIDwgMTAwIHx8IHN0YXR1c0NvZGUgPiAxOTkpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdGF0dXNDb2RlOiAnICsgc3RhdHVzQ29kZSk7CiAgICB9CgogICAgaWYgKHRoaXMuaXNDYW5jZWxlZCB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBpZiAoc3R1blNlcnZlcnMgfHwgdHVyblNlcnZlcnMpIHsKICAgICAgaWYgKHN0dW5TZXJ2ZXJzKSB7CiAgICAgICAgaWNlU2VydmVycyA9IFNJUC5VQS5jb25maWd1cmF0aW9uX2NoZWNrLm9wdGlvbmFsWydzdHVuU2VydmVycyddKHN0dW5TZXJ2ZXJzKTsKICAgICAgICBpZiAoIWljZVNlcnZlcnMpIHsKICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgc3R1blNlcnZlcnM6ICcrIHN0dW5TZXJ2ZXJzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5zdHVuU2VydmVycyA9IGljZVNlcnZlcnM7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodHVyblNlcnZlcnMpIHsKICAgICAgICBpY2VTZXJ2ZXJzID0gU0lQLlVBLmNvbmZpZ3VyYXRpb25fY2hlY2sub3B0aW9uYWxbJ3R1cm5TZXJ2ZXJzJ10odHVyblNlcnZlcnMpOwogICAgICAgIGlmICghaWNlU2VydmVycykgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB0dXJuU2VydmVyczogJysgdHVyblNlcnZlcnMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnR1cm5TZXJ2ZXJzID0gaWNlU2VydmVyczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWVkaWFIYW5kbGVyLnVwZGF0ZUljZVNlcnZlcnMoewogICAgICAgIHN0dW5TZXJ2ZXJzOiB0aGlzLnN0dW5TZXJ2ZXJzLAogICAgICAgIHR1cm5TZXJ2ZXJzOiB0aGlzLnR1cm5TZXJ2ZXJzCiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGRvMTAwcmVsKCkgewogICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovCiAgICAgIHN0YXR1c0NvZGUgPSBvcHRpb25zLnN0YXR1c0NvZGUgfHwgMTgzOwoKICAgICAgLy8gU2V0IHN0YXR1cyBhbmQgYWRkIGV4dHJhIGhlYWRlcnMKICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSzsKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcrIHRoaXMuY29udGFjdCk7CiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZXF1aXJlOiAxMDByZWwnKTsKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JTZXE6ICcgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCkpOwoKICAgICAgLy8gU2F2ZSBtZWRpYSBoaW50IGZvciBsYXRlciAocmVmZXJyZWQgc2Vzc2lvbnMpCiAgICAgIHRoaXMubWVkaWFIaW50ID0gb3B0aW9ucy5tZWRpYTsKCiAgICAgIC8vIEdldCB0aGUgc2Vzc2lvbiBkZXNjcmlwdGlvbiB0byBhZGQgdG8gcHJlYWNjZXB0IHdpdGgKICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24ob3B0aW9ucy5tZWRpYSkKICAgICAgLnRoZW4oCiAgICAgICAgZnVuY3Rpb24gb25TdWNjZXNzIChib2R5KSB7CiAgICAgICAgICBpZiAodGhpcy5pc0NhbmNlbGVkIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmVhcmx5X3NkcCA9IGJvZHk7CiAgICAgICAgICB0aGlzW3RoaXMuaGFzT2ZmZXIgPyAnaGFzQW5zd2VyJyA6ICdoYXNPZmZlciddID0gdHJ1ZTsKCiAgICAgICAgICAvLyBSZXRyYW5zbWl0IHVudGlsIHdlIGdldCBhIHJlc3BvbnNlIG9yIHdlIHRpbWUgb3V0IChzZWUgcHJhY2tUaW1lciBiZWxvdykKICAgICAgICAgIHZhciB0aW1lb3V0ID0gU0lQLlRpbWVycy5UMTsKICAgICAgICAgIHRoaXMudGltZXJzLnJlbDF4eFRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uIHJlbDF4eFJldHJhbnNtaXNzaW9uKCkgewogICAgICAgICAgICB0aGlzLnJlcXVlc3QucmVwbHkoc3RhdHVzQ29kZSwgbnVsbCwgZXh0cmFIZWFkZXJzLCBib2R5KTsKICAgICAgICAgICAgdGltZW91dCAqPSAyOwogICAgICAgICAgICB0aGlzLnRpbWVycy5yZWwxeHhUaW1lciA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChyZWwxeHhSZXRyYW5zbWlzc2lvbi5iaW5kKHRoaXMpLCB0aW1lb3V0KTsKICAgICAgICAgIH0uYmluZCh0aGlzKSwgdGltZW91dCk7CgogICAgICAgICAgLy8gVGltZW91dCBhbmQgcmVqZWN0IElOVklURSBpZiBubyByZXNwb25zZQogICAgICAgICAgdGhpcy50aW1lcnMucHJhY2tUaW1lciA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfV0FJVElOR19GT1JfUFJBQ0spIHsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmxvZygnbm8gUFJBQ0sgcmVjZWl2ZWQsIHJlamVjdGluZyB0aGUgY2FsbCcpOwogICAgICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5yZWwxeHhUaW1lcik7CiAgICAgICAgICAgIHRoaXMucmVxdWVzdC5yZXBseSg1MDQpOwogICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgU0lQLkMuY2F1c2VzLk5PX1BSQUNLKTsKICAgICAgICAgIH0uYmluZCh0aGlzKSwgU0lQLlRpbWVycy5UMSAqIDY0KTsKCiAgICAgICAgICAvLyBTZW5kIHRoZSBpbml0aWFsIHJlc3BvbnNlCiAgICAgICAgICByZXNwb25zZSA9IHRoaXMucmVxdWVzdC5yZXBseShzdGF0dXNDb2RlLCByZWFzb25QaHJhc2UsIGV4dHJhSGVhZGVycywgYm9keSk7CiAgICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UsIHJlYXNvblBocmFzZSk7CiAgICAgICAgfS5iaW5kKHRoaXMpLAoKICAgICAgICBmdW5jdGlvbiBvbkZhaWx1cmUgKCkgewogICAgICAgICAgdGhpcy5yZXF1ZXN0LnJlcGx5KDQ4MCk7CiAgICAgICAgICB0aGlzLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICB9LmJpbmQodGhpcykKICAgICAgKTsKICAgIH0gLy8gZW5kIGRvMTAwcmVsCgogICAgZnVuY3Rpb24gbm9ybWFsUmVwbHkoKSB7CiAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqLwogICAgICByZXNwb25zZSA9IHRoaXMucmVxdWVzdC5yZXBseShzdGF0dXNDb2RlLCByZWFzb25QaHJhc2UsIGV4dHJhSGVhZGVycywgYm9keSk7CiAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSwgcmVhc29uUGhyYXNlKTsKICAgIH0KCiAgICBpZiAob3B0aW9ucy5zdGF0dXNDb2RlICE9PSAxMDAgJiYKICAgICAgICAodGhpcy5yZWwxMDAgPT09IFNJUC5DLnN1cHBvcnRlZC5SRVFVSVJFRCB8fAogICAgICAgICAodGhpcy5yZWwxMDAgPT09IFNJUC5DLnN1cHBvcnRlZC5TVVBQT1JURUQgJiYgb3B0aW9ucy5yZWwxMDApIHx8CiAgICAgICAgICh0aGlzLnJlbDEwMCA9PT0gU0lQLkMuc3VwcG9ydGVkLlNVUFBPUlRFRCAmJiAodGhpcy51YS5jb25maWd1cmF0aW9uLnJlbDEwMCA9PT0gU0lQLkMuc3VwcG9ydGVkLlJFUVVJUkVEKSkpKSB7CiAgICAgIGRvMTAwcmVsLmFwcGx5KHRoaXMpOwogICAgfSBlbHNlIHsKICAgICAgbm9ybWFsUmVwbHkuYXBwbHkodGhpcyk7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKgogICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5tZWRpYV0gZ2V0cyBwYXNzZWQgdG8gU0lQLk1lZGlhSGFuZGxlci5nZXREZXNjcmlwdGlvbiBhcyBtZWRpYUhpbnQKICAgKi8KICBhY2NlcHQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKFNlc3Npb24uZGVzdWdhcihvcHRpb25zKSk7CiAgICBTSVAuVXRpbHMub3B0aW9uc092ZXJyaWRlKG9wdGlvbnMsICdtZWRpYScsICdtZWRpYUNvbnN0cmFpbnRzJywgdHJ1ZSwgdGhpcy5sb2dnZXIsIHRoaXMudWEuY29uZmlndXJhdGlvbi5tZWRpYSk7CiAgICB0aGlzLm1lZGlhSGludCA9IG9wdGlvbnMubWVkaWE7CgogICAgLy8gY29tbWVudGVkIG91dCBub3ctdW51c2VkIGhvbGQtcmVsYXRlZCB2YXJpYWJsZXMgZm9yIGpzaGludC4gU2VlIGJlbG93LiBKTUYgMjAxNC0xLTIxCiAgICB2YXIKICAgICAgLy9pZHgsIGxlbmd0aCwgaGFzQXVkaW8sIGhhc1ZpZGVvLAogICAgICBzZWxmID0gdGhpcywKICAgICAgcmVxdWVzdCA9IHRoaXMucmVxdWVzdCwKICAgICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgLy9tZWRpYVN0cmVhbSA9IG9wdGlvbnMubWVkaWFTdHJlYW0gfHwgbnVsbCwKICAgICAgaWNlU2VydmVycywKICAgICAgc3R1blNlcnZlcnMgPSBvcHRpb25zLnN0dW5TZXJ2ZXJzIHx8IG51bGwsCiAgICAgIHR1cm5TZXJ2ZXJzID0gb3B0aW9ucy50dXJuU2VydmVycyB8fCBudWxsLAogICAgICBzZHBDcmVhdGlvblN1Y2NlZWRlZCA9IGZ1bmN0aW9uKGJvZHkpIHsKICAgICAgICB2YXIKICAgICAgICAgIHJlc3BvbnNlLAogICAgICAgICAgLy8gcnVuIGZvciByZXBseSBzdWNjZXNzIGNhbGxiYWNrCiAgICAgICAgICByZXBseVN1Y2NlZWRlZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBzZWxmLnN0YXR1cyA9IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSzsKCiAgICAgICAgICAgIHNlbGYuc2V0SW52aXRlMnh4VGltZXIocmVxdWVzdCwgYm9keSk7CiAgICAgICAgICAgIHNlbGYuc2V0QUNLVGltZXIoKTsKICAgICAgICAgIH0sCgogICAgICAgICAgLy8gcnVuIGZvciByZXBseSBmYWlsdXJlIGNhbGxiYWNrCiAgICAgICAgICByZXBseUZhaWxlZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBzZWxmLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICAgICAgICAgIHNlbGYudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICAgICAgICB9OwoKICAgICAgICAvLyBDaHJvbWUgbWlnaHQgY2FsbCBvbmFkZHN0cmVhbSBiZWZvcmUgYWNjZXB0KCkgaXMgY2FsbGVkLCB3aGljaCBtZWFucwogICAgICAgIC8vIG1lZGlhSGFuZGxlci5yZW5kZXIoKSB3YXMgY2FsbGVkIHdpdGhvdXQgYSByZW5kZXJIaW50LCBzbyB3ZSBuZWVkIHRvCiAgICAgICAgLy8gcmUtcmVuZGVyIG5vdyB0aGF0IG1lZGlhSGludC5yZW5kZXIgaGFzIGJlZW4gc2V0LgogICAgICAgIC8vCiAgICAgICAgLy8gQ2hyb21lIHNlZW1zIHRvIGJlIGluIHRoZSByaWdodCByZWdhcmRpbmcgdGhpcywgc2VlCiAgICAgICAgLy8gaHR0cDovL2Rldi53My5vcmcvMjAxMS93ZWJydGMvZWRpdG9yL3dlYnJ0Yy5odG1sI3dpZGwtUlRDUGVlckNvbm5lY3Rpb24tb25hZGRzdHJlYW0KICAgICAgICBzZWxmLm1lZGlhSGFuZGxlci5yZW5kZXIoKTsKCiAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcgKyBzZWxmLmNvbnRhY3QpOwogICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdBbGxvdzogJyArIFNJUC5VQS5DLkFMTE9XRURfTUVUSE9EUy50b1N0cmluZygpKTsKCiAgICAgICAgaWYoIXNlbGYuaGFzT2ZmZXIpIHsKICAgICAgICAgIHNlbGYuaGFzT2ZmZXIgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWxmLmhhc0Fuc3dlciA9IHRydWU7CiAgICAgICAgfQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdC5yZXBseSgyMDAsIG51bGwsIGV4dHJhSGVhZGVycywKICAgICAgICAgICAgICAgICAgICAgIGJvZHksCiAgICAgICAgICAgICAgICAgICAgICByZXBseVN1Y2NlZWRlZCwKICAgICAgICAgICAgICAgICAgICAgIHJlcGx5RmFpbGVkCiAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgaWYgKHNlbGYuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7IC8vIERpZG4ndCBmYWlsCiAgICAgICAgICBzZWxmLmFjY2VwdGVkKHJlc3BvbnNlLCBTSVAuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKDIwMCkpOwogICAgICAgIH0KICAgICAgfSwKCiAgICAgIHNkcENyZWF0aW9uRmFpbGVkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKHNlbGYuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIC8vIFRPRE8gLSBmYWlsIG91dCBvbiBlcnJvcgogICAgICAgIHNlbGYucmVxdWVzdC5yZXBseSg0ODApOwogICAgICAgIC8vc2VsZi5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5VU0VSX0RFTklFRF9NRURJQV9BQ0NFU1MpOwogICAgICAgIHNlbGYuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5XRUJSVENfRVJST1IpOwogICAgICAgIHNlbGYudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgfTsKCiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0FOU1dFUkVEX1dBSVRJTkdfRk9SX1BSQUNLOwogICAgICByZXR1cm4gdGhpczsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUikgewogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0FOU1dFUkVEOwogICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfRUFSTFlfTUVESUEpIHsKICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICBpZiAoKHN0dW5TZXJ2ZXJzIHx8IHR1cm5TZXJ2ZXJzKSAmJgogICAgICAgICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfRUFSTFlfTUVESUEgJiYgdGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX0FOU1dFUkVEX1dBSVRJTkdfRk9SX1BSQUNLKSkgewogICAgICBpZiAoc3R1blNlcnZlcnMpIHsKICAgICAgICBpY2VTZXJ2ZXJzID0gU0lQLlVBLmNvbmZpZ3VyYXRpb25fY2hlY2sub3B0aW9uYWxbJ3N0dW5TZXJ2ZXJzJ10oc3R1blNlcnZlcnMpOwogICAgICAgIGlmICghaWNlU2VydmVycykgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdHVuU2VydmVyczogJysgc3R1blNlcnZlcnMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnN0dW5TZXJ2ZXJzID0gaWNlU2VydmVyczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0dXJuU2VydmVycykgewogICAgICAgIGljZVNlcnZlcnMgPSBTSVAuVUEuY29uZmlndXJhdGlvbl9jaGVjay5vcHRpb25hbFsndHVyblNlcnZlcnMnXSh0dXJuU2VydmVycyk7CiAgICAgICAgaWYgKCFpY2VTZXJ2ZXJzKSB7CiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHR1cm5TZXJ2ZXJzOiAnKyB0dXJuU2VydmVycyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudHVyblNlcnZlcnMgPSBpY2VTZXJ2ZXJzOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5tZWRpYUhhbmRsZXIudXBkYXRlSWNlU2VydmVycyh7CiAgICAgICAgc3R1blNlcnZlcnM6IHRoaXMuc3R1blNlcnZlcnMsCiAgICAgICAgdHVyblNlcnZlcnM6IHRoaXMudHVyblNlcnZlcnMKICAgICAgfSk7CiAgICB9CgogICAgLy8gQW4gZXJyb3Igb24gZGlhbG9nIGNyZWF0aW9uIHdpbGwgZmlyZSAnZmFpbGVkJyBldmVudAogICAgaWYoIXRoaXMuY3JlYXRlRGlhbG9nKHJlcXVlc3QsICdVQVMnKSkgewogICAgICByZXF1ZXN0LnJlcGx5KDUwMCwgJ01pc3NpbmcgQ29udGFjdCBoZWFkZXIgZmllbGQnKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMudXNlck5vQW5zd2VyVGltZXIpOwoKICAgIC8vIHRoaXMgaG9sZC1yZWxhdGVkIGNvZGUgYnJlYWtzIEZGIGFjY2VwdGluZyBuZXcgY2FsbHMgLSBKTUYgMjAxNC0xLTIxCiAgICAvKgogICAgbGVuZ3RoID0gdGhpcy5nZXRSZW1vdGVTdHJlYW1zKCkubGVuZ3RoOwoKICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICBpZiAodGhpcy5tZWRpYUhhbmRsZXIuZ2V0UmVtb3RlU3RyZWFtcygpW2lkeF0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGggPiAwKSB7CiAgICAgICAgaGFzVmlkZW8gPSB0cnVlOwogICAgICB9CiAgICAgIGlmICh0aGlzLm1lZGlhSGFuZGxlci5nZXRSZW1vdGVTdHJlYW1zKClbaWR4XS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICBoYXNBdWRpbyA9IHRydWU7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIWhhc0F1ZGlvICYmIHRoaXMubWVkaWFDb25zdHJhaW50cy5hdWRpbyA9PT0gdHJ1ZSkgewogICAgICB0aGlzLm1lZGlhQ29uc3RyYWludHMuYXVkaW8gPSBmYWxzZTsKICAgICAgaWYgKG1lZGlhU3RyZWFtKSB7CiAgICAgICAgbGVuZ3RoID0gbWVkaWFTdHJlYW0uZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGg7CiAgICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgICBtZWRpYVN0cmVhbS5yZW1vdmVUcmFjayhtZWRpYVN0cmVhbS5nZXRBdWRpb1RyYWNrcygpW2lkeF0pOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmICghaGFzVmlkZW8gJiYgdGhpcy5tZWRpYUNvbnN0cmFpbnRzLnZpZGVvID09PSB0cnVlKSB7CiAgICAgIHRoaXMubWVkaWFDb25zdHJhaW50cy52aWRlbyA9IGZhbHNlOwogICAgICBpZiAobWVkaWFTdHJlYW0pIHsKICAgICAgICBsZW5ndGggPSBtZWRpYVN0cmVhbS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aDsKICAgICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICAgIG1lZGlhU3RyZWFtLnJlbW92ZVRyYWNrKG1lZGlhU3RyZWFtLmdldFZpZGVvVHJhY2tzKClbaWR4XSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAqLwoKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfRUFSTFlfTUVESUEpIHsKICAgICAgc2RwQ3JlYXRpb25TdWNjZWVkZWQoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMubWVkaWFIYW5kbGVyLmdldERlc2NyaXB0aW9uKHNlbGYubWVkaWFIaW50KQogICAgICAudGhlbigKICAgICAgICBzZHBDcmVhdGlvblN1Y2NlZWRlZCwKICAgICAgICBzZHBDcmVhdGlvbkZhaWxlZAogICAgICApOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIHJlY2VpdmVSZXF1ZXN0OiBmdW5jdGlvbihyZXF1ZXN0KSB7CgogICAgLy8gSVNDIFJFQ0VJVkUgUkVRVUVTVAoKICAgIGZ1bmN0aW9uIGNvbmZpcm1TZXNzaW9uKCkgewogICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi8KICAgICAgdmFyIGNvbnRlbnRUeXBlOwoKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuYWNrVGltZXIpOwogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5pbnZpdGUyeHhUaW1lcik7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICB0aGlzLnVubXV0ZSgpOwoKICAgICAgLy8gVE9ETyAtIHRoaXMgbG9naWMgYXNzdW1lcyBDb250ZW50LURpc3Bvc2l0aW9uIGRlZmF1bHRzCiAgICAgIGNvbnRlbnRUeXBlID0gcmVxdWVzdC5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpOwogICAgICBpZiAoY29udGVudFR5cGUgIT09ICdhcHBsaWNhdGlvbi9zZHAnKSB7CiAgICAgICAgdGhpcy5yZW5kZXJib2R5ID0gcmVxdWVzdC5ib2R5OwogICAgICAgIHRoaXMucmVuZGVydHlwZSA9IGNvbnRlbnRUeXBlOwogICAgICB9CiAgICB9CgogICAgc3dpdGNoKHJlcXVlc3QubWV0aG9kKSB7CiAgICBjYXNlIFNJUC5DLkNBTkNFTDoKICAgICAgLyogUkZDMzI2MSAxNSBTdGF0ZXMgdGhhdCBhIFVBUyBtYXkgaGF2ZSBhY2NlcHRlZCBhbiBpbnZpdGF0aW9uIHdoaWxlIGEgQ0FOQ0VMCiAgICAgICAqIHdhcyBpbiBwcm9ncmVzcyBhbmQgdGhhdCB0aGUgVUFDIE1BWSBjb250aW51ZSB3aXRoIHRoZSBzZXNzaW9uIGVzdGFibGlzaGVkIGJ5CiAgICAgICAqIGFueSAyeHggcmVzcG9uc2UsIG9yIE1BWSB0ZXJtaW5hdGUgd2l0aCBCWUUuIFNJUCBkb2VzIGNvbnRpbnVlIHdpdGggdGhlCiAgICAgICAqIGVzdGFibGlzaGVkIHNlc3Npb24uIFNvIHRoZSBDQU5DRUwgaXMgcHJvY2Vzc2VkIG9ubHkgaWYgdGhlIHNlc3Npb24gaXMgbm90IHlldAogICAgICAgKiBlc3RhYmxpc2hlZC4KICAgICAgICovCgogICAgICAvKgogICAgICAgKiBUZXJtaW5hdGUgdGhlIHdob2xlIHNlc3Npb24gaW4gY2FzZSB0aGUgdXNlciBkaWRuJ3QgYWNjZXB0IChvciB5ZXQgdG8gc2VuZCB0aGUgYW5zd2VyKSBub3IgcmVqZWN0IHRoZQogICAgICAgKnJlcXVlc3Qgb3BlbmluZyB0aGUgc2Vzc2lvbi4KICAgICAgICovCiAgICAgIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BTlNXRVIgfHwKICAgICAgICAgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLIHx8CiAgICAgICAgIHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSyB8fAogICAgICAgICB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfRUFSTFlfTUVESUEgfHwKICAgICAgICAgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0FOU1dFUkVEKSB7CgogICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ0FOQ0VMRUQ7CiAgICAgICAgdGhpcy5yZXF1ZXN0LnJlcGx5KDQ4Nyk7CiAgICAgICAgdGhpcy5jYW5jZWxlZChyZXF1ZXN0KTsKICAgICAgICB0aGlzLnJlamVjdGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5DQU5DRUxFRCk7CiAgICAgICAgdGhpcy5mYWlsZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkNBTkNFTEVEKTsKICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkNBTkNFTEVEKTsKICAgICAgfQogICAgICBicmVhazsKICAgIGNhc2UgU0lQLkMuQUNLOgogICAgICBpZih0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLKSB7CiAgICAgICAgaWYgKCF0aGlzLmhhc0Fuc3dlcikgewogICAgICAgICAgaWYocmVxdWVzdC5ib2R5ICYmIHJlcXVlc3QuZ2V0SGVhZGVyKCdjb250ZW50LXR5cGUnKSA9PT0gJ2FwcGxpY2F0aW9uL3NkcCcpIHsKICAgICAgICAgICAgLy8gQUNLIGNvbnRhaW5zIGFuc3dlciB0byBhbiBJTlZJVEUgdy9vIFNEUCBuZWdvdGlhdGlvbgogICAgICAgICAgICBTSVAuSGFja3MuRmlyZWZveC5jYW5ub3RIYW5kbGVFeHRyYVdoaXRlc3BhY2UocmVxdWVzdCk7CiAgICAgICAgICAgIFNJUC5IYWNrcy5BbGxCcm93c2Vycy5tYXNrRHRscyhyZXF1ZXN0KTsKCiAgICAgICAgICAgIHRoaXMuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuc2V0RGVzY3JpcHRpb24ocmVxdWVzdC5ib2R5KQogICAgICAgICAgICAudGhlbigKICAgICAgICAgICAgICBjb25maXJtU2Vzc2lvbi5iaW5kKHRoaXMpLAogICAgICAgICAgICAgIGZ1bmN0aW9uIG9uRmFpbHVyZSAoZSkgewogICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIud2FybihlKTsKICAgICAgICAgICAgICAgIHRoaXMudGVybWluYXRlKHsKICAgICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogJzQ4OCcsCiAgICAgICAgICAgICAgICAgIHJlYXNvblBocmFzZTogJ0JhZCBNZWRpYSBEZXNjcmlwdGlvbicKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGhpcy5mYWlsZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpCiAgICAgICAgICAgICk7CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZWFybHlfc2RwKSB7CiAgICAgICAgICAgIGNvbmZpcm1TZXNzaW9uLmFwcGx5KHRoaXMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy9UT0RPOiBQYXNzIHRvIG1lZGlhaGFuZGxlcgogICAgICAgICAgICB0aGlzLmZhaWxlZChyZXF1ZXN0LCBTSVAuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25maXJtU2Vzc2lvbi5hcHBseSh0aGlzKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlIFNJUC5DLlBSQUNLOgogICAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICAgIC8vbG9jYWxNZWRpYSA9IHNlc3Npb24ubWVkaWFIYW5kbGVyLmxvY2FsTWVkaWE7CiAgICAgICAgaWYoIXRoaXMuaGFzQW5zd2VyKSB7CiAgICAgICAgICBpZihyZXF1ZXN0LmJvZHkgJiYgcmVxdWVzdC5nZXRIZWFkZXIoJ2NvbnRlbnQtdHlwZScpID09PSAnYXBwbGljYXRpb24vc2RwJykgewogICAgICAgICAgICB0aGlzLmhhc0Fuc3dlciA9IHRydWU7CiAgICAgICAgICAgIHRoaXMubWVkaWFIYW5kbGVyLnNldERlc2NyaXB0aW9uKHJlcXVlc3QuYm9keSkKICAgICAgICAgICAgLnRoZW4oCiAgICAgICAgICAgICAgZnVuY3Rpb24gb25TdWNjZXNzICgpIHsKICAgICAgICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnJlbDF4eFRpbWVyKTsKICAgICAgICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnByYWNrVGltZXIpOwogICAgICAgICAgICAgICAgcmVxdWVzdC5yZXBseSgyMDApOwogICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0VBUkxZX01FRElBOwogICAgICAgICAgICAgICAgICB0aGlzLmFjY2VwdCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgICAgICAgIC8vUkVWSVNJVAogICAgICAgICAgICAgICAgdGhpcy5tdXRlKCk7CiAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLAogICAgICAgICAgICAgIGZ1bmN0aW9uIG9uRmFpbHVyZSAoZSkgewogICAgICAgICAgICAgICAgLy9UT0RPOiBTZW5kIHRvIG1lZGlhIGhhbmRsZXIKICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oZSk7CiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZSh7CiAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6ICc0ODgnLAogICAgICAgICAgICAgICAgICByZWFzb25QaHJhc2U6ICdCYWQgTWVkaWEgRGVzY3JpcHRpb24nCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRoaXMuZmFpbGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICAgIH0uYmluZCh0aGlzKQogICAgICAgICAgICApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGUoewogICAgICAgICAgICAgIHN0YXR1c0NvZGU6ICc0ODgnLAogICAgICAgICAgICAgIHJlYXNvblBocmFzZTogJ0JhZCBNZWRpYSBEZXNjcmlwdGlvbicKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuZmFpbGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnJlbDF4eFRpbWVyKTsKICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnByYWNrVGltZXIpOwogICAgICAgICAgcmVxdWVzdC5yZXBseSgyMDApOwoKICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0spIHsKICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgICAgdGhpcy5hY2NlcHQoKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfRUFSTFlfTUVESUE7CiAgICAgICAgICAvL1JFVklTSVQKICAgICAgICAgIHRoaXMubXV0ZSgpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19FQVJMWV9NRURJQSkgewogICAgICAgIHJlcXVlc3QucmVwbHkoMjAwKTsKICAgICAgfQogICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgIFNlc3Npb24ucHJvdG90eXBlLnJlY2VpdmVSZXF1ZXN0LmFwcGx5KHRoaXMsIFtyZXF1ZXN0XSk7CiAgICAgIGJyZWFrOwogICAgfQogIH0sCgogIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQgJiYgdGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5mYWlsZWQobnVsbCwgU0lQLkMuY2F1c2VzLkNPTk5FQ1RJT05fRVJST1IpOwogICAgfQogIH0sCgogIG9uUmVxdWVzdFRpbWVvdXQ6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICB0aGlzLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgICAgdGhpcy50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfQogIH0KCn07CgpTSVAuSW52aXRlU2VydmVyQ29udGV4dCA9IEludml0ZVNlcnZlckNvbnRleHQ7CgpJbnZpdGVDbGllbnRDb250ZXh0ID0gZnVuY3Rpb24odWEsIHRhcmdldCwgb3B0aW9ucykgewogIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKFNlc3Npb24uZGVzdWdhcihvcHRpb25zKSk7CiAgb3B0aW9ucy5wYXJhbXMgPSBPYmplY3QuY3JlYXRlKG9wdGlvbnMucGFyYW1zIHx8IE9iamVjdC5wcm90b3R5cGUpOwoKICB2YXIgaWNlU2VydmVycywKICAgIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKSwKICAgIHN0dW5TZXJ2ZXJzID0gb3B0aW9ucy5zdHVuU2VydmVycyB8fCBudWxsLAogICAgdHVyblNlcnZlcnMgPSBvcHRpb25zLnR1cm5TZXJ2ZXJzIHx8IG51bGwsCiAgICBtZWRpYUhhbmRsZXJGYWN0b3J5ID0gb3B0aW9ucy5tZWRpYUhhbmRsZXJGYWN0b3J5IHx8IHVhLmNvbmZpZ3VyYXRpb24ubWVkaWFIYW5kbGVyRmFjdG9yeSwKICAgIGlzTWVkaWFTdXBwb3J0ZWQgPSBtZWRpYUhhbmRsZXJGYWN0b3J5LmlzU3VwcG9ydGVkOwoKICAvLyBDaGVjayBXZWJSVEMgc3VwcG9ydAogIGlmIChpc01lZGlhU3VwcG9ydGVkICYmICFpc01lZGlhU3VwcG9ydGVkKCkpIHsKICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5Ob3RTdXBwb3J0ZWRFcnJvcignTWVkaWEgbm90IHN1cHBvcnRlZCcpOwogIH0KCiAgdGhpcy5SVENDb25zdHJhaW50cyA9IG9wdGlvbnMuUlRDQ29uc3RyYWludHMgfHwge307CiAgdGhpcy5pbnZpdGVXaXRob3V0U2RwID0gb3B0aW9ucy5pbnZpdGVXaXRob3V0U2RwIHx8IGZhbHNlOwoKICAvLyBTZXQgYW5vbnltb3VzIHByb3BlcnR5CiAgdGhpcy5hbm9ueW1vdXMgPSBvcHRpb25zLmFub255bW91cyB8fCBmYWxzZTsKCiAgLy8gQ3VzdG9tIGRhdGEgdG8gYmUgc2VudCBlaXRoZXIgaW4gSU5WSVRFIG9yIGluIEFDSwogIHRoaXMucmVuZGVyYm9keSA9IG9wdGlvbnMucmVuZGVyYm9keSB8fCBudWxsOwogIHRoaXMucmVuZGVydHlwZSA9IG9wdGlvbnMucmVuZGVydHlwZSB8fCAndGV4dC9wbGFpbic7CgogIG9wdGlvbnMucGFyYW1zLmZyb21fdGFnID0gdGhpcy5mcm9tX3RhZzsKCiAgLyogRG8gbm90IGFkZCA7b2IgaW4gaW5pdGlhbCBmb3JtaW5nIGRpYWxvZyByZXF1ZXN0cyBpZiB0aGUgcmVnaXN0cmF0aW9uIG92ZXIKICAgKiAgdGhlIGN1cnJlbnQgY29ubmVjdGlvbiBnb3QgYSBHUlVVIFVSSS4KICAgKi8KICB0aGlzLmNvbnRhY3QgPSB1YS5jb250YWN0LnRvU3RyaW5nKHsKICAgIGFub255bW91czogdGhpcy5hbm9ueW1vdXMsCiAgICBvdXRib3VuZDogdGhpcy5hbm9ueW1vdXMgPyAhdWEuY29udGFjdC50ZW1wX2dydXUgOiAhdWEuY29udGFjdC5wdWJfZ3J1dQogIH0pOwoKICBpZiAodGhpcy5hbm9ueW1vdXMpIHsKICAgIG9wdGlvbnMucGFyYW1zLmZyb21fZGlzcGxheU5hbWUgPSAnQW5vbnltb3VzJzsKICAgIG9wdGlvbnMucGFyYW1zLmZyb21fdXJpID0gJ3NpcDphbm9ueW1vdXNAYW5vbnltb3VzLmludmFsaWQnOwoKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdQLVByZWZlcnJlZC1JZGVudGl0eTogJysgdWEuY29uZmlndXJhdGlvbi51cmkudG9TdHJpbmcoKSk7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnUHJpdmFjeTogaWQnKTsKICB9CiAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcrIHRoaXMuY29udGFjdCk7CiAgZXh0cmFIZWFkZXJzLnB1c2goJ0FsbG93OiAnKyBTSVAuVUEuQy5BTExPV0VEX01FVEhPRFMudG9TdHJpbmcoKSk7CiAgaWYgKCF0aGlzLmludml0ZVdpdGhvdXRTZHApIHsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3NkcCcpOwogIH0gZWxzZSBpZiAodGhpcy5yZW5kZXJib2R5KSB7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgdGhpcy5yZW5kZXJ0eXBlKTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LURpc3Bvc2l0aW9uOiByZW5kZXI7aGFuZGxpbmc9b3B0aW9uYWwnKTsKICB9CgogIGlmICh1YS5jb25maWd1cmF0aW9uLnJlbDEwMCA9PT0gU0lQLkMuc3VwcG9ydGVkLlJFUVVJUkVEKSB7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnUmVxdWlyZTogMTAwcmVsJyk7CiAgfQogIGlmICh1YS5jb25maWd1cmF0aW9uLnJlcGxhY2VzID09PSBTSVAuQy5zdXBwb3J0ZWQuUkVRVUlSRUQpIHsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZXF1aXJlOiByZXBsYWNlcycpOwogIH0KCiAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSBleHRyYUhlYWRlcnM7CgogIFNJUC5VdGlscy5hdWdtZW50KHRoaXMsIFNJUC5DbGllbnRDb250ZXh0LCBbdWEsIFNJUC5DLklOVklURSwgdGFyZ2V0LCBvcHRpb25zXSk7CiAgU0lQLlV0aWxzLmF1Z21lbnQodGhpcywgU0lQLlNlc3Npb24sIFttZWRpYUhhbmRsZXJGYWN0b3J5XSk7CgogIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19OVUxMKSB7CiAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogIH0KCiAgLy8gU2Vzc2lvbiBwYXJhbWV0ZXIgaW5pdGlhbGl6YXRpb24KICB0aGlzLmZyb21fdGFnID0gU0lQLlV0aWxzLm5ld1RhZygpOwoKICAvLyBPdXRnb2luZ1Nlc3Npb24gc3BlY2lmaWMgcGFyYW1ldGVycwogIHRoaXMuaXNDYW5jZWxlZCA9IGZhbHNlOwogIHRoaXMucmVjZWl2ZWRfMTAwID0gZmFsc2U7CgogIHRoaXMubWV0aG9kID0gU0lQLkMuSU5WSVRFOwoKICB0aGlzLnJlY2VpdmVOb25JbnZpdGVSZXNwb25zZSA9IHRoaXMucmVjZWl2ZVJlc3BvbnNlOwogIHRoaXMucmVjZWl2ZVJlc3BvbnNlID0gdGhpcy5yZWNlaXZlSW52aXRlUmVzcG9uc2U7CgogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAuaW52aXRlY2xpZW50Y29udGV4dCcpOwoKICBpZiAoc3R1blNlcnZlcnMpIHsKICAgIGljZVNlcnZlcnMgPSBTSVAuVUEuY29uZmlndXJhdGlvbl9jaGVjay5vcHRpb25hbFsnc3R1blNlcnZlcnMnXShzdHVuU2VydmVycyk7CiAgICBpZiAoIWljZVNlcnZlcnMpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdHVuU2VydmVyczogJysgc3R1blNlcnZlcnMpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zdHVuU2VydmVycyA9IGljZVNlcnZlcnM7CiAgICB9CiAgfQoKICBpZiAodHVyblNlcnZlcnMpIHsKICAgIGljZVNlcnZlcnMgPSBTSVAuVUEuY29uZmlndXJhdGlvbl9jaGVjay5vcHRpb25hbFsndHVyblNlcnZlcnMnXSh0dXJuU2VydmVycyk7CiAgICBpZiAoIWljZVNlcnZlcnMpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB0dXJuU2VydmVyczogJysgdHVyblNlcnZlcnMpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy50dXJuU2VydmVycyA9IGljZVNlcnZlcnM7CiAgICB9CiAgfQoKICB1YS5hcHBsaWNhbnRzW3RoaXNdID0gdGhpczsKCiAgdGhpcy5pZCA9IHRoaXMucmVxdWVzdC5jYWxsX2lkICsgdGhpcy5mcm9tX3RhZzsKCiAgLy9Jbml0aWFsaXplIE1lZGlhIFNlc3Npb24KICB0aGlzLm1lZGlhSGFuZGxlciA9IHRoaXMubWVkaWFIYW5kbGVyRmFjdG9yeSh0aGlzLCB7CiAgICBSVENDb25zdHJhaW50czogdGhpcy5SVENDb25zdHJhaW50cywKICAgIHN0dW5TZXJ2ZXJzOiB0aGlzLnN0dW5TZXJ2ZXJzLAogICAgdHVyblNlcnZlcnM6IHRoaXMudHVyblNlcnZlcnMKICB9KTsKCiAgaWYgKHRoaXMubWVkaWFIYW5kbGVyICYmIHRoaXMubWVkaWFIYW5kbGVyLmdldFJlbW90ZVN0cmVhbXMpIHsKICAgIHRoaXMuZ2V0UmVtb3RlU3RyZWFtcyA9IHRoaXMubWVkaWFIYW5kbGVyLmdldFJlbW90ZVN0cmVhbXMuYmluZCh0aGlzLm1lZGlhSGFuZGxlcik7CiAgICB0aGlzLmdldExvY2FsU3RyZWFtcyA9IHRoaXMubWVkaWFIYW5kbGVyLmdldExvY2FsU3RyZWFtcy5iaW5kKHRoaXMubWVkaWFIYW5kbGVyKTsKICB9CgogIFNJUC5VdGlscy5vcHRpb25zT3ZlcnJpZGUob3B0aW9ucywgJ21lZGlhJywgJ21lZGlhQ29uc3RyYWludHMnLCB0cnVlLCB0aGlzLmxvZ2dlciwgdGhpcy51YS5jb25maWd1cmF0aW9uLm1lZGlhKTsKICB0aGlzLm1lZGlhSGludCA9IG9wdGlvbnMubWVkaWE7Cn07CgpJbnZpdGVDbGllbnRDb250ZXh0LnByb3RvdHlwZSA9IHsKICBpbnZpdGU6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAvL1NhdmUgdGhlIHNlc3Npb24gaW50byB0aGUgdWEgc2Vzc2lvbnMgY29sbGVjdGlvbi4KICAgIC8vTm90ZTogcGxhY2luZyBpbiBjb25zdHJ1Y3RvciBicmVha3MgY2FsbCB0byByZXF1ZXN0LmNhbmNlbCBvbiBjbG9zZS4uLiBVc2VyIGRvZXMgbm90IG5lZWQgdGhpcyBhbnl3YXkKICAgIHRoaXMudWEuc2Vzc2lvbnNbdGhpcy5pZF0gPSB0aGlzOwoKICAgIC8vTm90ZTogZHVlIHRvIHRoZSB3YXkgRmlyZWZveCBoYW5kbGVzIGdVTSBjYWxscywgaXQgaXMgcmVjb21tZW5kZWQgdG8gbWFrZSB0aGUgZ1VNIGNhbGwgYXQgdGhlIGFwcCBsZXZlbAogICAgLy8gYW5kIGhhbmQgc2lwLmpzIGEgc3RyZWFtIGFzIHRoZSBtZWRpYUhpbnQKICAgIGlmICh0aGlzLmludml0ZVdpdGhvdXRTZHApIHsKICAgICAgLy9qdXN0IHNlbmQgYW4gaW52aXRlIHdpdGggbm8gc2RwLi4uCiAgICAgIHRoaXMucmVxdWVzdC5ib2R5ID0gc2VsZi5yZW5kZXJib2R5OwogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0lOVklURV9TRU5UOwogICAgICB0aGlzLnNlbmQoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMubWVkaWFIYW5kbGVyLmdldERlc2NyaXB0aW9uKHNlbGYubWVkaWFIaW50KQogICAgICAudGhlbigKICAgICAgICBmdW5jdGlvbiBvblN1Y2Nlc3Mob2ZmZXIpIHsKICAgICAgICAgIGlmIChzZWxmLmlzQ2FuY2VsZWQgfHwgc2VsZi5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgc2VsZi5oYXNPZmZlciA9IHRydWU7CiAgICAgICAgICBzZWxmLnJlcXVlc3QuYm9keSA9IG9mZmVyOwogICAgICAgICAgc2VsZi5zdGF0dXMgPSBDLlNUQVRVU19JTlZJVEVfU0VOVDsKICAgICAgICAgIHNlbGYuc2VuZCgpOwogICAgICAgIH0sCiAgICAgICAgZnVuY3Rpb24gb25GYWlsdXJlKCkgewogICAgICAgICAgaWYgKHNlbGYuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIC8vIFRPRE8uLi5mYWlsIG91dAogICAgICAgICAgLy9zZWxmLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuVVNFUl9ERU5JRURfTUVESUFfQUNDRVNTKTsKICAgICAgICAgIC8vc2VsZi5mYWlsZWQobnVsbCwgU0lQLkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgICBzZWxmLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICAgIHNlbGYudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICB9CiAgICAgICk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgcmVjZWl2ZUludml0ZVJlc3BvbnNlOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgdmFyIGNhdXNlLCAvL2xvY2FsTWVkaWEsCiAgICAgIHNlc3Npb24gPSB0aGlzLAogICAgICBpZCA9IHJlc3BvbnNlLmNhbGxfaWQgKyByZXNwb25zZS5mcm9tX3RhZyArIHJlc3BvbnNlLnRvX3RhZywKICAgICAgZXh0cmFIZWFkZXJzID0gW10sCiAgICAgIG9wdGlvbnMgPSB7fTsKCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQgfHwgcmVzcG9uc2UubWV0aG9kICE9PSBTSVAuQy5JTlZJVEUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0aGlzLmRpYWxvZyAmJiAocmVzcG9uc2Uuc3RhdHVzX2NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlIDw9IDI5OSkpIHsKICAgICAgaWYgKGlkICE9PSB0aGlzLmRpYWxvZy5pZC50b1N0cmluZygpICkgewogICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnLCB0cnVlKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0uc2VuZFJlcXVlc3QodGhpcywgU0lQLkMuQUNLLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keTogU0lQLlV0aWxzLmdlbmVyYXRlRmFrZVNEUChyZXNwb25zZS5ib2R5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0uc2VuZFJlcXVlc3QodGhpcywgU0lQLkMuQllFKTsKCiAgICAgICAgLyogTk9URTogVGhpcyBmYWlscyBiZWNhdXNlIHRoZSBmb3JraW5nIHByb3h5IGRvZXMgbm90IHJlY29nbml6ZSB0aGF0IGFuIHVuYW5zd2VyYWJsZQogICAgICAgICAqIGxlZyAoZHVlIHRvIHBlZXJDb25uZWN0aW9uIGxpbWl0YXRpb25zKSBoYXMgYmVlbiBhbnN3ZXJlZCBmaXJzdC4gSWYgeW91ciBmb3JraW5nCiAgICAgICAgICogcHJveHkgZG9lcyBub3QgaGFuZyB1cCBhbGwgdW5hbnN3ZXJlZCBicmFuY2hlcyBvbiB0aGUgZmlyc3QgYnJhbmNoIGFuc3dlcmVkLCByZW1vdmUgdGhpcy4KICAgICAgICAgKi8KICAgICAgICBpZih0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgICAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgU0lQLkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5XRUJSVENfRVJST1IpOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuQUNLLHtjc2VxOiByZXNwb25zZS5jc2VxfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLmhhc0Fuc3dlcikgewogICAgICAgIC8vIGludml0ZSB3L28gc2RwIGlzIHdhaXRpbmcgZm9yIGNhbGxiYWNrCiAgICAgICAgLy9hbiBpbnZpdGUgd2l0aCBzZHAgbXVzdCBnbyBvbiwgYW5kIGhhc0Fuc3dlciBpcyB0cnVlCiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXMuZGlhbG9nICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlIDwgMjAwKSB7CiAgICAgIC8qCiAgICAgICAgRWFybHkgbWVkaWEgaGFzIGJlZW4gc2V0IHVwIHdpdGggYXQgbGVhc3Qgb25lIG90aGVyIGRpZmZlcmVudCBicmFuY2gsCiAgICAgICAgYnV0IGEgZmluYWwgMnh4IHJlc3BvbnNlIGhhc24ndCBiZWVuIHJlY2VpdmVkCiAgICAgICovCiAgICAgIGlmICh0aGlzLmRpYWxvZy5wcmFja2VkLmluZGV4T2YocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpICE9PSAtMSB8fAogICAgICAgICAgKHRoaXMuZGlhbG9nLnByYWNrZWRbdGhpcy5kaWFsb2cucHJhY2tlZC5sZW5ndGgtMV0gPj0gcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgJiYgdGhpcy5kaWFsb2cucHJhY2tlZC5sZW5ndGggPiAwKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmVhcmx5RGlhbG9nc1tpZF0gJiYgIXRoaXMuY3JlYXRlRGlhbG9nKHJlc3BvbnNlLCAnVUFDJywgdHJ1ZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5pbmRleE9mKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKSAhPT0gLTEgfHwKICAgICAgICAgICh0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZFt0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5sZW5ndGgtMV0gPj0gcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgJiYgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQubGVuZ3RoID4gMCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSQWNrOiAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgKyAnICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ2NzZXEnKSk7CiAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLnB1c2gocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpOwoKICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnNlbmRSZXF1ZXN0KHRoaXMsIFNJUC5DLlBSQUNLLCB7CiAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICAgICAgYm9keTogU0lQLlV0aWxzLmdlbmVyYXRlRmFrZVNEUChyZXNwb25zZS5ib2R5KQogICAgICB9KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIFByb2NlZWQgdG8gY2FuY2VsbGF0aW9uIGlmIHRoZSB1c2VyIHJlcXVlc3RlZC4KICAgIGlmKHRoaXMuaXNDYW5jZWxlZCkgewogICAgICBpZihyZXNwb25zZS5zdGF0dXNfY29kZSA+PSAxMDAgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPCAyMDApIHsKICAgICAgICB0aGlzLnJlcXVlc3QuY2FuY2VsKHRoaXMuY2FuY2VsUmVhc29uKTsKICAgICAgICB0aGlzLmNhbmNlbGVkKG51bGwpOwogICAgICB9IGVsc2UgaWYocmVzcG9uc2Uuc3RhdHVzX2NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlIDwgMjk5KSB7CiAgICAgICAgdGhpcy5hY2NlcHRBbmRUZXJtaW5hdGUocmVzcG9uc2UpOwogICAgICAgIHRoaXMuZW1pdCgnYnllJywgdGhpcy5yZXF1ZXN0KTsKICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXNfY29kZSA+PSAzMDApIHsKICAgICAgICBjYXVzZSA9IFNJUC5DLlJFQVNPTl9QSFJBU0VbcmVzcG9uc2Uuc3RhdHVzX2NvZGVdIHx8IFNJUC5DLmNhdXNlcy5DQU5DRUxFRDsKICAgICAgICB0aGlzLnJlamVjdGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgc3dpdGNoKHRydWUpIHsKICAgICAgY2FzZSAvXjEwMCQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgIHRoaXMucmVjZWl2ZWRfMTAwID0gdHJ1ZTsKICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICgvXjFbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpKToKICAgICAgICAvLyBEbyBub3RoaW5nIHdpdGggMXh4IHJlc3BvbnNlcyB3aXRob3V0IFRvIHRhZy4KICAgICAgICBpZighcmVzcG9uc2UudG9fdGFnKSB7CiAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCcxeHggcmVzcG9uc2UgcmVjZWl2ZWQgd2l0aG91dCB0byB0YWcnKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgLy8gQ3JlYXRlIEVhcmx5IERpYWxvZyBpZiAxWFggY29tZXMgd2l0aCBjb250YWN0CiAgICAgICAgaWYocmVzcG9uc2UuaGFzSGVhZGVyKCdjb250YWN0JykpIHsKICAgICAgICAgIC8vIEFuIGVycm9yIG9uIGRpYWxvZyBjcmVhdGlvbiB3aWxsIGZpcmUgJ2ZhaWxlZCcgZXZlbnQKICAgICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnLCB0cnVlKSkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfMVhYX1JFQ0VJVkVEOwoKICAgICAgICBpZihyZXNwb25zZS5oYXNIZWFkZXIoJ3JlcXVpcmUnKSAmJgogICAgICAgICAgIHJlc3BvbnNlLmdldEhlYWRlcigncmVxdWlyZScpLmluZGV4T2YoJzEwMHJlbCcpICE9PSAtMSkgewoKICAgICAgICAgIC8vIERvIG5vdGhpbmcgaWYgdGhpcy5kaWFsb2cgaXMgYWxyZWFkeSBjb25maXJtZWQKICAgICAgICAgIGlmICh0aGlzLmRpYWxvZyB8fCAhdGhpcy5lYXJseURpYWxvZ3NbaWRdKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5pbmRleE9mKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKSAhPT0gLTEgfHwKICAgICAgICAgICAgICAodGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWRbdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQubGVuZ3RoLTFdID49IHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpICYmIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLmxlbmd0aCA+IDApKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBTSVAuSGFja3MuRmlyZWZveC5jYW5ub3RIYW5kbGVFeHRyYVdoaXRlc3BhY2UocmVzcG9uc2UpOwogICAgICAgICAgU0lQLkhhY2tzLkFsbEJyb3dzZXJzLm1hc2tEdGxzKHJlc3BvbnNlKTsKCiAgICAgICAgICBpZiAoIXJlc3BvbnNlLmJvZHkpIHsKICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JBY2s6ICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSArICcgJyArIHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKTsKICAgICAgICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQucHVzaChyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSk7CiAgICAgICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5zZW5kUmVxdWVzdCh0aGlzLCBTSVAuQy5QUkFDSywgewogICAgICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwoKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5oYXNPZmZlcikgewogICAgICAgICAgICBpZiAoIXRoaXMuY3JlYXRlRGlhbG9nKHJlc3BvbnNlLCAnVUFDJykpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmhhc0Fuc3dlciA9IHRydWU7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nLnByYWNrZWQucHVzaChyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSk7CgogICAgICAgICAgICB0aGlzLm1lZGlhSGFuZGxlci5zZXREZXNjcmlwdGlvbihyZXNwb25zZS5ib2R5KQogICAgICAgICAgICAudGhlbigKICAgICAgICAgICAgICBmdW5jdGlvbiBvblN1Y2Nlc3MgKCkgewogICAgICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JBY2s6ICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSArICcgJyArIHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKTsKCiAgICAgICAgICAgICAgICBzZXNzaW9uLnNlbmRSZXF1ZXN0KFNJUC5DLlBSQUNLLCB7CiAgICAgICAgICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzLAogICAgICAgICAgICAgICAgICByZWNlaXZlUmVzcG9uc2U6IGZ1bmN0aW9uKCkge30KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgICAgICAgIHNlc3Npb24ubXV0ZSgpOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICBpZiAoc2Vzc2lvbi5zdGF0dXMgPT09IEMuU1RBVFVTX0VBUkxZX01FRElBKSB7CiAgICAgICAgICAgICAgICAgIGxvY2FsTWVkaWEgPSBzZXNzaW9uLm1lZGlhSGFuZGxlci5sb2NhbE1lZGlhOwogICAgICAgICAgICAgICAgICBpZiAobG9jYWxNZWRpYS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICBsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKClbMF0uZW5hYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKVswXS5lbmFibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0qLwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZnVuY3Rpb24gb25GYWlsdXJlIChlKSB7CiAgICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2dlci53YXJuKGUpOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5hY2NlcHRBbmRUZXJtaW5hdGUocmVzcG9uc2UsIDQ4OCwgJ05vdCBBY2NlcHRhYmxlIEhlcmUnKTsKICAgICAgICAgICAgICAgIHNlc3Npb24uZmFpbGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgZWFybHlEaWFsb2cgPSB0aGlzLmVhcmx5RGlhbG9nc1tpZF07CiAgICAgICAgICAgIHZhciBlYXJseU1lZGlhID0gZWFybHlEaWFsb2cubWVkaWFIYW5kbGVyOwoKICAgICAgICAgICAgZWFybHlEaWFsb2cucHJhY2tlZC5wdXNoKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKTsKCiAgICAgICAgICAgIGVhcmx5TWVkaWEuc2V0RGVzY3JpcHRpb24ocmVzcG9uc2UuYm9keSkKICAgICAgICAgICAgLnRoZW4oZWFybHlNZWRpYS5nZXREZXNjcmlwdGlvbi5iaW5kKGVhcmx5TWVkaWEsIHNlc3Npb24ubWVkaWFIaW50KSkKICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gb25TdWNjZXNzKHNkcCkgewogICAgICAgICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3NkcCcpOwogICAgICAgICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSQWNrOiAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgKyAnICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ2NzZXEnKSk7CiAgICAgICAgICAgICAgZWFybHlEaWFsb2cuc2VuZFJlcXVlc3Qoc2Vzc2lvbiwgU0lQLkMuUFJBQ0ssIHsKICAgICAgICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzLAogICAgICAgICAgICAgICAgYm9keTogc2RwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgc2Vzc2lvbi5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgICAgICBzZXNzaW9uLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gb25GYWlsdXJlKGUpIHsKICAgICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFNJUC5FeGNlcHRpb25zLkdldERlc2NyaXB0aW9uRXJyb3IpIHsKICAgICAgICAgICAgICAgIGVhcmx5RGlhbG9nLnByYWNrZWQucHVzaChyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSk7CiAgICAgICAgICAgICAgICBpZiAoc2Vzc2lvbi5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gVE9ETyAtIGZhaWwgb3V0IG9uIGVycm9yCiAgICAgICAgICAgICAgICAvLyBzZXNzaW9uLmZhaWxlZChndW0gZXJyb3IpOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5mYWlsZWQobnVsbCwgU0lQLkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgICAgICAgICBzZXNzaW9uLnRlcm1pbmF0ZWQobnVsbCwgU0lQLkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVhcmx5RGlhbG9nLnByYWNrZWQuc3BsaWNlKGVhcmx5RGlhbG9nLnByYWNrZWQuaW5kZXhPZihyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSksIDEpOwogICAgICAgICAgICAgICAgLy8gQ291bGQgbm90IHNldCByZW1vdGUgZGVzY3JpcHRpb24KICAgICAgICAgICAgICAgIHNlc3Npb24ubG9nZ2VyLndhcm4oJ2ludmFsaWQgU0RQJyk7CiAgICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2dlci53YXJuKGUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIC9eMlswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgdmFyIGNzZXEgPSB0aGlzLnJlcXVlc3QuY3NlcSArICcgJyArIHRoaXMucmVxdWVzdC5tZXRob2Q7CiAgICAgICAgaWYgKGNzZXEgIT09IHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfRUFSTFlfTUVESUEgJiYgdGhpcy5kaWFsb2cpIHsKICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICAgICAgdGhpcy51bm11dGUoKTsKICAgICAgICAgIC8qbG9jYWxNZWRpYSA9IHRoaXMubWVkaWFIYW5kbGVyLmxvY2FsTWVkaWE7CiAgICAgICAgICBpZiAobG9jYWxNZWRpYS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgbG9jYWxNZWRpYS5nZXRBdWRpb1RyYWNrcygpWzBdLmVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKVswXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgICAgIH0qLwogICAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICAgICAgaWYgKHRoaXMucmVuZGVyYm9keSkgewogICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgdGhpcy5yZW5kZXJ0eXBlKTsKICAgICAgICAgICAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSBleHRyYUhlYWRlcnM7CiAgICAgICAgICAgIG9wdGlvbnMuYm9keSA9IHRoaXMucmVuZGVyYm9keTsKICAgICAgICAgIH0KICAgICAgICAgIG9wdGlvbnMuY3NlcSA9IHJlc3BvbnNlLmNzZXE7CiAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLkFDSywgb3B0aW9ucyk7CiAgICAgICAgICB0aGlzLmFjY2VwdGVkKHJlc3BvbnNlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICAvLyBEbyBub3RoaW5nIGlmIHRoaXMuZGlhbG9nIGlzIGFscmVhZHkgY29uZmlybWVkCiAgICAgICAgaWYgKHRoaXMuZGlhbG9nKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIFNJUC5IYWNrcy5GaXJlZm94LmNhbm5vdEhhbmRsZUV4dHJhV2hpdGVzcGFjZShyZXNwb25zZSk7CiAgICAgICAgU0lQLkhhY2tzLkFsbEJyb3dzZXJzLm1hc2tEdGxzKHJlc3BvbnNlKTsKCiAgICAgICAgLy8gVGhpcyBpcyBhbiBpbnZpdGUgd2l0aG91dCBzZHAKICAgICAgICBpZiAoIXRoaXMuaGFzT2ZmZXIpIHsKICAgICAgICAgIGlmICh0aGlzLmVhcmx5RGlhbG9nc1tpZF0gJiYgdGhpcy5lYXJseURpYWxvZ3NbaWRdLm1lZGlhSGFuZGxlci5sb2NhbE1lZGlhKSB7CiAgICAgICAgICAgIC8vUkVWSVNJVAogICAgICAgICAgICB0aGlzLmhhc09mZmVyID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5oYXNBbnN3ZXIgPSB0cnVlOwogICAgICAgICAgICB0aGlzLm1lZGlhSGFuZGxlciA9IHRoaXMuZWFybHlEaWFsb2dzW2lkXS5tZWRpYUhhbmRsZXI7CiAgICAgICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnKSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLkFDSywge2NzZXE6cmVzcG9uc2UuY3NlcX0pOwoKICAgICAgICAgICAgdGhpcy51bm11dGUoKTsKICAgICAgICAgICAgLyoKICAgICAgICAgICAgbG9jYWxNZWRpYSA9IHNlc3Npb24ubWVkaWFIYW5kbGVyLmxvY2FsTWVkaWE7CiAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0QXVkaW9UcmFja3MoKVswXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobG9jYWxNZWRpYS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICBsb2NhbE1lZGlhLmdldFZpZGVvVHJhY2tzKClbMF0uZW5hYmxlZCA9IHRydWU7CiAgICAgICAgICAgIH0qLwogICAgICAgICAgICB0aGlzLmFjY2VwdGVkKHJlc3BvbnNlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmKCFyZXNwb25zZS5ib2R5KSB7CiAgICAgICAgICAgICAgdGhpcy5hY2NlcHRBbmRUZXJtaW5hdGUocmVzcG9uc2UsIDQwMCwgJ01pc3Npbmcgc2Vzc2lvbiBkZXNjcmlwdGlvbicpOwogICAgICAgICAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXRoaXMuY3JlYXRlRGlhbG9nKHJlc3BvbnNlLCAnVUFDJykpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmhhc09mZmVyID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuc2V0RGVzY3JpcHRpb24ocmVzcG9uc2UuYm9keSkKICAgICAgICAgICAgLnRoZW4odGhpcy5tZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24uYmluZCh0aGlzLm1lZGlhSGFuZGxlciwgdGhpcy5tZWRpYUhpbnQpKQogICAgICAgICAgICAudGhlbihmdW5jdGlvbiBvblN1Y2Nlc3Moc2RwKSB7CiAgICAgICAgICAgICAgLy92YXIgbG9jYWxNZWRpYTsKICAgICAgICAgICAgICBpZihzZXNzaW9uLmlzQ2FuY2VsZWQgfHwgc2Vzc2lvbi5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNkcCA9IFNJUC5IYWNrcy5GaXJlZm94Lmhhc01pc3NpbmdDTGluZUluU0RQKHNkcCk7CgogICAgICAgICAgICAgIHNlc3Npb24uc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICAgICAgICAgIHNlc3Npb24uaGFzQW5zd2VyID0gdHJ1ZTsKCiAgICAgICAgICAgICAgc2Vzc2lvbi51bm11dGUoKTsKICAgICAgICAgICAgICAvKmxvY2FsTWVkaWEgPSBzZXNzaW9uLm1lZGlhSGFuZGxlci5sb2NhbE1lZGlhOwogICAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgbG9jYWxNZWRpYS5nZXRBdWRpb1RyYWNrcygpWzBdLmVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAobG9jYWxNZWRpYS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKVswXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICB9Ki8KICAgICAgICAgICAgICBzZXNzaW9uLnNlbmRSZXF1ZXN0KFNJUC5DLkFDSyx7CiAgICAgICAgICAgICAgICBib2R5OiBzZHAsCiAgICAgICAgICAgICAgICBleHRyYUhlYWRlcnM6WydDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3NkcCddLAogICAgICAgICAgICAgICAgY3NlcTpyZXNwb25zZS5jc2VxCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgc2Vzc2lvbi5hY2NlcHRlZChyZXNwb25zZSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiBvbkZhaWx1cmUoZSkgewogICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgU0lQLkV4Y2VwdGlvbnMuR2V0RGVzY3JpcHRpb25FcnJvcikgewogICAgICAgICAgICAgICAgLy8gVE9ETyBkbyBzb21ldGhpbmcgaGVyZQogICAgICAgICAgICAgICAgc2Vzc2lvbi5sb2dnZXIud2FybigidGhlcmUgd2FzIGEgcHJvYmxlbSIpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2dlci53YXJuKCdpbnZhbGlkIFNEUCcpOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5sb2dnZXIud2FybihlKTsKICAgICAgICAgICAgICAgIHJlc3BvbnNlLnJlcGx5KDQ4OCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaGFzQW5zd2VyKXsKICAgICAgICAgIGlmICh0aGlzLnJlbmRlcmJvZHkpIHsKICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRlbnQtVHlwZTogJyArIHNlc3Npb24ucmVuZGVydHlwZSk7CiAgICAgICAgICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzID0gZXh0cmFIZWFkZXJzOwogICAgICAgICAgICBvcHRpb25zLmJvZHkgPSB0aGlzLnJlbmRlcmJvZHk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLkFDSywgb3B0aW9ucyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmKCFyZXNwb25zZS5ib2R5KSB7CiAgICAgICAgICAgIHRoaXMuYWNjZXB0QW5kVGVybWluYXRlKHJlc3BvbnNlLCA0MDAsICdNaXNzaW5nIHNlc3Npb24gZGVzY3JpcHRpb24nKTsKICAgICAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnKSkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgICAgIHRoaXMubWVkaWFIYW5kbGVyLnNldERlc2NyaXB0aW9uKHJlc3BvbnNlLmJvZHkpCiAgICAgICAgICAudGhlbigKICAgICAgICAgICAgZnVuY3Rpb24gb25TdWNjZXNzICgpIHsKICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHt9Oy8vLGxvY2FsTWVkaWE7CiAgICAgICAgICAgICAgc2Vzc2lvbi5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgICAgICAgICAgc2Vzc2lvbi51bm11dGUoKTsKICAgICAgICAgICAgICAvKmxvY2FsTWVkaWEgPSBzZXNzaW9uLm1lZGlhSGFuZGxlci5sb2NhbE1lZGlhOwogICAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgbG9jYWxNZWRpYS5nZXRBdWRpb1RyYWNrcygpWzBdLmVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAobG9jYWxNZWRpYS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKVswXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICB9Ki8KICAgICAgICAgICAgICBpZiAoc2Vzc2lvbi5yZW5kZXJib2R5KSB7CiAgICAgICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgc2Vzc2lvbi5yZW5kZXJ0eXBlKTsKICAgICAgICAgICAgICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzID0gZXh0cmFIZWFkZXJzOwogICAgICAgICAgICAgICAgb3B0aW9ucy5ib2R5ID0gc2Vzc2lvbi5yZW5kZXJib2R5OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBvcHRpb25zLmNzZXEgPSByZXNwb25zZS5jc2VxOwogICAgICAgICAgICAgIHNlc3Npb24uc2VuZFJlcXVlc3QoU0lQLkMuQUNLLCBvcHRpb25zKTsKICAgICAgICAgICAgICBzZXNzaW9uLmFjY2VwdGVkKHJlc3BvbnNlKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZnVuY3Rpb24gb25GYWlsdXJlIChlKSB7CiAgICAgICAgICAgICAgc2Vzc2lvbi5sb2dnZXIud2FybihlKTsKICAgICAgICAgICAgICBzZXNzaW9uLmFjY2VwdEFuZFRlcm1pbmF0ZShyZXNwb25zZSwgNDg4LCAnTm90IEFjY2VwdGFibGUgSGVyZScpOwogICAgICAgICAgICAgIHNlc3Npb24uZmFpbGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgfQogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgY2F1c2UgPSBTSVAuVXRpbHMuc2lwRXJyb3JDYXVzZShyZXNwb25zZS5zdGF0dXNfY29kZSk7CiAgICAgICAgdGhpcy5yZWplY3RlZChyZXNwb25zZSwgY2F1c2UpOwogICAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICB9CiAgfSwKCiAgY2FuY2VsOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICB0aGlzLmxvZ2dlci5sb2coJ2NhbmNlbGluZyBSVENTZXNzaW9uJyk7CgogICAgdmFyIGNhbmNlbF9yZWFzb24gPSBTSVAuVXRpbHMuZ2V0Q2FuY2VsUmVhc29uKG9wdGlvbnMuc3RhdHVzX2NvZGUsIG9wdGlvbnMucmVhc29uX3BocmFzZSk7CgogICAgLy8gQ2hlY2sgU2Vzc2lvbiBTdGF0dXMKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfTlVMTCB8fAogICAgICAgICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfSU5WSVRFX1NFTlQgJiYgIXRoaXMucmVjZWl2ZWRfMTAwKSkgewogICAgICB0aGlzLmlzQ2FuY2VsZWQgPSB0cnVlOwogICAgICB0aGlzLmNhbmNlbFJlYXNvbiA9IGNhbmNlbF9yZWFzb247CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19JTlZJVEVfU0VOVCB8fAogICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfMVhYX1JFQ0VJVkVEIHx8CiAgICAgICAgICAgICAgIHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19FQVJMWV9NRURJQSkgewogICAgICB0aGlzLnJlcXVlc3QuY2FuY2VsKGNhbmNlbF9yZWFzb24pOwogICAgfQoKICAgIHJldHVybiB0aGlzLmNhbmNlbGVkKCk7CiAgfSwKCiAgdGVybWluYXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0sgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aGlzLmJ5ZShvcHRpb25zKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuY2FuY2VsKG9wdGlvbnMpOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIHJlY2VpdmVSZXF1ZXN0OiBmdW5jdGlvbihyZXF1ZXN0KSB7CiAgICAvLyBJQ0MgUkVDRUlWRSBSRVFVRVNUCgogICAgLy8gUmVqZWN0IENBTkNFTHMKICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gU0lQLkMuQ0FOQ0VMKSB7CiAgICAgIC8vIFRPRE87IG1ha2UgdGhpcyBhIHN3aXRjaCB3aGVuIGl0IGdldHMgYWRkZWQKICAgIH0KCiAgICBpZiAocmVxdWVzdC5tZXRob2QgPT09IFNJUC5DLkFDSyAmJiB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLKSB7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmFja1RpbWVyKTsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuaW52aXRlMnh4VGltZXIpOwogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0NPTkZJUk1FRDsKICAgICAgdGhpcy51bm11dGUoKTsKCiAgICAgIHRoaXMuYWNjZXB0ZWQoKTsKICAgIH0KCiAgICByZXR1cm4gU2Vzc2lvbi5wcm90b3R5cGUucmVjZWl2ZVJlcXVlc3QuYXBwbHkodGhpcywgW3JlcXVlc3RdKTsKICB9LAoKICBvblRyYW5zcG9ydEVycm9yOiBmdW5jdGlvbigpIHsKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQ09ORklSTUVEICYmIHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgIH0KICB9LAoKICBvblJlcXVlc3RUaW1lb3V0OiBmdW5jdGlvbigpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5mYWlsZWQobnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH0KICB9Cgp9OwoKU0lQLkludml0ZUNsaWVudENvbnRleHQgPSBJbnZpdGVDbGllbnRDb250ZXh0OwoKfTsKCn0seyIuL1Nlc3Npb24vRFRNRiI6MzB9XSwzMDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgRFRNRgogKi8KCi8qKgogKiBAY2xhc3MgRFRNRgogKiBAcGFyYW0ge1NJUC5TZXNzaW9ufSBzZXNzaW9uCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKCnZhciBEVE1GLAogIEMgPSB7CiAgICBNSU5fRFVSQVRJT046ICAgICAgICAgICAgNzAsCiAgICBNQVhfRFVSQVRJT046ICAgICAgICAgICAgNjAwMCwKICAgIERFRkFVTFRfRFVSQVRJT046ICAgICAgICAxMDAsCiAgICBNSU5fSU5URVJfVE9ORV9HQVA6ICAgICAgNTAsCiAgICBERUZBVUxUX0lOVEVSX1RPTkVfR0FQOiAgNTAwCiAgfTsKCkRUTUYgPSBmdW5jdGlvbihzZXNzaW9uLCB0b25lLCBvcHRpb25zKSB7CiAgdmFyIGR1cmF0aW9uLCBpbnRlclRvbmVHYXA7CgogIGlmICh0b25lID09PSB1bmRlZmluZWQpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ05vdCBlbm91Z2ggYXJndW1lbnRzJyk7CiAgfQoKICB0aGlzLmxvZ2dlciA9IHNlc3Npb24udWEuZ2V0TG9nZ2VyKCdzaXAuaW52aXRlY29udGV4dC5kdG1mJywgc2Vzc2lvbi5pZCk7CiAgdGhpcy5vd25lciA9IHNlc3Npb247CiAgdGhpcy5kaXJlY3Rpb24gPSBudWxsOwoKICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICBkdXJhdGlvbiA9IG9wdGlvbnMuZHVyYXRpb24gfHwgbnVsbDsKICBpbnRlclRvbmVHYXAgPSBvcHRpb25zLmludGVyVG9uZUdhcCB8fCBudWxsOwoKICAvLyBDaGVjayB0b25lIHR5cGUKICBpZiAodHlwZW9mIHRvbmUgPT09ICdzdHJpbmcnICkgewogICAgdG9uZSA9IHRvbmUudG9VcHBlckNhc2UoKTsKICB9IGVsc2UgaWYgKHR5cGVvZiB0b25lID09PSAnbnVtYmVyJykgewogICAgdG9uZSA9IHRvbmUudG9TdHJpbmcoKTsKICB9IGVsc2UgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB0b25lOiAnKyB0b25lKTsKICB9CgogIC8vIENoZWNrIHRvbmUgdmFsdWUKICBpZiAoIXRvbmUubWF0Y2goL15bMC05QS1EIypdJC8pKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRvbmU6ICcrIHRvbmUpOwogIH0gZWxzZSB7CiAgICB0aGlzLnRvbmUgPSB0b25lOwogIH0KCiAgLy8gQ2hlY2sgZHVyYXRpb24KICBpZiAoZHVyYXRpb24gJiYgIVNJUC5VdGlscy5pc0RlY2ltYWwoZHVyYXRpb24pKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRvbmUgZHVyYXRpb246ICcrIGR1cmF0aW9uKTsKICB9IGVsc2UgaWYgKCFkdXJhdGlvbikgewogICAgZHVyYXRpb24gPSBEVE1GLkMuREVGQVVMVF9EVVJBVElPTjsKICB9IGVsc2UgaWYgKGR1cmF0aW9uIDwgRFRNRi5DLk1JTl9EVVJBVElPTikgewogICAgdGhpcy5sb2dnZXIud2FybignImR1cmF0aW9uIiB2YWx1ZSBpcyBsb3dlciB0aGFuIHRoZSBtaW5pbXVtIGFsbG93ZWQsIHNldHRpbmcgaXQgdG8gJysgRFRNRi5DLk1JTl9EVVJBVElPTisgJyBtaWxsaXNlY29uZHMnKTsKICAgIGR1cmF0aW9uID0gRFRNRi5DLk1JTl9EVVJBVElPTjsKICB9IGVsc2UgaWYgKGR1cmF0aW9uID4gRFRNRi5DLk1BWF9EVVJBVElPTikgewogICAgdGhpcy5sb2dnZXIud2FybignImR1cmF0aW9uIiB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gdGhlIG1heGltdW0gYWxsb3dlZCwgc2V0dGluZyBpdCB0byAnKyBEVE1GLkMuTUFYX0RVUkFUSU9OICsnIG1pbGxpc2Vjb25kcycpOwogICAgZHVyYXRpb24gPSBEVE1GLkMuTUFYX0RVUkFUSU9OOwogIH0gZWxzZSB7CiAgICBkdXJhdGlvbiA9IE1hdGguYWJzKGR1cmF0aW9uKTsKICB9CiAgdGhpcy5kdXJhdGlvbiA9IGR1cmF0aW9uOwoKICAvLyBDaGVjayBpbnRlclRvbmVHYXAKICBpZiAoaW50ZXJUb25lR2FwICYmICFTSVAuVXRpbHMuaXNEZWNpbWFsKGludGVyVG9uZUdhcCkpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgaW50ZXJUb25lR2FwOiAnKyBpbnRlclRvbmVHYXApOwogIH0gZWxzZSBpZiAoIWludGVyVG9uZUdhcCkgewogICAgaW50ZXJUb25lR2FwID0gRFRNRi5DLkRFRkFVTFRfSU5URVJfVE9ORV9HQVA7CiAgfSBlbHNlIGlmIChpbnRlclRvbmVHYXAgPCBEVE1GLkMuTUlOX0lOVEVSX1RPTkVfR0FQKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCciaW50ZXJUb25lR2FwIiB2YWx1ZSBpcyBsb3dlciB0aGFuIHRoZSBtaW5pbXVtIGFsbG93ZWQsIHNldHRpbmcgaXQgdG8gJysgRFRNRi5DLk1JTl9JTlRFUl9UT05FX0dBUCArJyBtaWxsaXNlY29uZHMnKTsKICAgIGludGVyVG9uZUdhcCA9IERUTUYuQy5NSU5fSU5URVJfVE9ORV9HQVA7CiAgfSBlbHNlIHsKICAgIGludGVyVG9uZUdhcCA9IE1hdGguYWJzKGludGVyVG9uZUdhcCk7CiAgfQogIHRoaXMuaW50ZXJUb25lR2FwID0gaW50ZXJUb25lR2FwOwp9OwpEVE1GLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU0lQLkV2ZW50RW1pdHRlci5wcm90b3R5cGUpOwoKCkRUTUYucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbihvcHRpb25zKSB7CiAgdmFyIGV4dHJhSGVhZGVycywgYm9keTsKCiAgdGhpcy5kaXJlY3Rpb24gPSAnb3V0Z29pbmcnOwoKICAvLyBDaGVjayBSVENTZXNzaW9uIFN0YXR1cwogIGlmICh0aGlzLm93bmVyLnN0YXR1cyAhPT0gU0lQLlNlc3Npb24uQy5TVEFUVVNfQ09ORklSTUVEICYmCiAgICB0aGlzLm93bmVyLnN0YXR1cyAhPT0gU0lQLlNlc3Npb24uQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLKSB7CiAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5vd25lci5zdGF0dXMpOwogIH0KCiAgLy8gR2V0IERUTUYgb3B0aW9ucwogIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogIGV4dHJhSGVhZGVycyA9IG9wdGlvbnMuZXh0cmFIZWFkZXJzID8gb3B0aW9ucy5leHRyYUhlYWRlcnMuc2xpY2UoKSA6IFtdOwoKICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9kdG1mLXJlbGF5Jyk7CgogIGJvZHkgPSAiU2lnbmFsPSAiICsgdGhpcy50b25lICsgIlxyXG4iOwogIGJvZHkgKz0gIkR1cmF0aW9uPSAiICsgdGhpcy5kdXJhdGlvbjsKCiAgdGhpcy5yZXF1ZXN0ID0gdGhpcy5vd25lci5kaWFsb2cuc2VuZFJlcXVlc3QodGhpcywgU0lQLkMuSU5GTywgewogICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICBib2R5OiBib2R5CiAgfSk7CgogIHRoaXMub3duZXIuZW1pdCgnZHRtZicsIHRoaXMucmVxdWVzdCwgdGhpcyk7Cn07CgovKioKICogQHByaXZhdGUKICovCkRUTUYucHJvdG90eXBlLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgdmFyIGNhdXNlOwoKICBzd2l0Y2godHJ1ZSkgewogICAgY2FzZSAvXjFbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAvLyBJZ25vcmUgcHJvdmlzaW9uYWwgcmVzcG9uc2VzLgogICAgICBicmVhazsKCiAgICBjYXNlIC9eMlswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgIHRoaXMuZW1pdCgnc3VjY2VlZGVkJywgewogICAgICAgIG9yaWdpbmF0b3I6ICdyZW1vdGUnLAogICAgICAgIHJlc3BvbnNlOiByZXNwb25zZQogICAgICB9KTsKICAgICAgYnJlYWs7CgogICAgZGVmYXVsdDoKICAgICAgY2F1c2UgPSBTSVAuVXRpbHMuc2lwRXJyb3JDYXVzZShyZXNwb25zZS5zdGF0dXNfY29kZSk7CiAgICAgIHRoaXMuZW1pdCgnZmFpbGVkJywgcmVzcG9uc2UsIGNhdXNlKTsKICAgICAgYnJlYWs7CiAgfQp9OwoKLyoqCiAqIEBwcml2YXRlCiAqLwpEVE1GLnByb3RvdHlwZS5vblJlcXVlc3RUaW1lb3V0ID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5lbWl0KCdmYWlsZWQnLCBudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICB0aGlzLm93bmVyLm9uUmVxdWVzdFRpbWVvdXQoKTsKfTsKCi8qKgogKiBAcHJpdmF0ZQogKi8KRFRNRi5wcm90b3R5cGUub25UcmFuc3BvcnRFcnJvciA9IGZ1bmN0aW9uKCkgewogIHRoaXMuZW1pdCgnZmFpbGVkJywgbnVsbCwgU0lQLkMuY2F1c2VzLkNPTk5FQ1RJT05fRVJST1IpOwogIHRoaXMub3duZXIub25UcmFuc3BvcnRFcnJvcigpOwp9OwoKLyoqCiAqIEBwcml2YXRlCiAqLwpEVE1GLnByb3RvdHlwZS5vbkRpYWxvZ0Vycm9yID0gZnVuY3Rpb24ocmVzcG9uc2UpIHsKICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuRElBTE9HX0VSUk9SKTsKICB0aGlzLm93bmVyLm9uRGlhbG9nRXJyb3IocmVzcG9uc2UpOwp9OwoKLyoqCiAqIEBwcml2YXRlCiAqLwpEVE1GLnByb3RvdHlwZS5pbml0X2luY29taW5nID0gZnVuY3Rpb24ocmVxdWVzdCkgewogIHRoaXMuZGlyZWN0aW9uID0gJ2luY29taW5nJzsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwoKICByZXF1ZXN0LnJlcGx5KDIwMCk7CgogIGlmICghdGhpcy50b25lIHx8ICF0aGlzLmR1cmF0aW9uKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCdpbnZhbGlkIElORk8gRFRNRiByZWNlaXZlZCwgZGlzY2FyZGVkJyk7CiAgfSBlbHNlIHsKICAgIHRoaXMub3duZXIuZW1pdCgnZHRtZicsIHJlcXVlc3QsIHRoaXMpOwogIH0KfTsKCkRUTUYuQyA9IEM7CnJldHVybiBEVE1GOwp9OwoKfSx7fV0sMzE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgovKioKICogQGZpbGVvdmVydmlldyBTSVAgU3Vic2NyaWJlciAoU0lQLVNwZWNpZmljIEV2ZW50IE5vdGlmaWNhdGlvbnMgUkZDNjY2NSkKICovCgovKioKICogQGF1Z21lbnRzIFNJUAogKiBAY2xhc3MgQ2xhc3MgY3JlYXRpbmcgYSBTSVAgU3Vic2NyaXB0aW9uLgogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7ClNJUC5TdWJzY3JpcHRpb24gPSBmdW5jdGlvbiAodWEsIHRhcmdldCwgZXZlbnQsIG9wdGlvbnMpIHsKICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zIHx8IE9iamVjdC5wcm90b3R5cGUpOwogIHRoaXMuZXh0cmFIZWFkZXJzID0gb3B0aW9ucy5leHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCk7CgogIHRoaXMuaWQgPSBudWxsOwogIHRoaXMuc3RhdGUgPSAnaW5pdCc7CgogIGlmICghZXZlbnQpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V2ZW50IG5lY2Vzc2FyeSB0byBjcmVhdGUgYSBzdWJzY3JpcHRpb24uJyk7CiAgfSBlbHNlIHsKICAgIC8vVE9ETzogY2hlY2sgZm9yIHZhbGlkIGV2ZW50cyBoZXJlIHByb2JhYmx5IG1ha2UgYSBsaXN0IGluIFNJUC5DOyBvciBsZWF2ZSBpdCB1cCB0byBhcHAgdG8gY2hlY2s/CiAgICAvL1RoZSBjaGVjayBtYXkgbmVlZCB0by9zaG91bGQgcHJvYmFibHkgb2NjdXIgb24gdGhlIG90aGVyIHNpZGUsCiAgICB0aGlzLmV2ZW50ID0gZXZlbnQ7CiAgfQoKICBpZih0eXBlb2Ygb3B0aW9ucy5leHBpcmVzICE9PSAnbnVtYmVyJyl7CiAgICB1YS5sb2dnZXIud2FybignZXhwaXJlcyBtdXN0IGJlIGEgbnVtYmVyLiBVc2luZyBkZWZhdWx0IG9mIDM2MDAuJyk7CiAgICB0aGlzLmV4cGlyZXMgPSAzNjAwOwogIH0gZWxzZSB7CiAgICB0aGlzLmV4cGlyZXMgPSBvcHRpb25zLmV4cGlyZXM7CiAgfQoKICBvcHRpb25zLmV4dHJhSGVhZGVycy5wdXNoKCdFdmVudDogJyArIHRoaXMuZXZlbnQpOwogIG9wdGlvbnMuZXh0cmFIZWFkZXJzLnB1c2goJ0V4cGlyZXM6ICcgKyB0aGlzLmV4cGlyZXMpOwoKICBpZiAob3B0aW9ucy5ib2R5KSB7CiAgICB0aGlzLmJvZHkgPSBvcHRpb25zLmJvZHk7CiAgfQoKICB0aGlzLmNvbnRhY3QgPSB1YS5jb250YWN0LnRvU3RyaW5nKCk7CgogIG9wdGlvbnMuZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcrIHRoaXMuY29udGFjdCk7CiAgb3B0aW9ucy5leHRyYUhlYWRlcnMucHVzaCgnQWxsb3c6ICcrIFNJUC5VQS5DLkFMTE9XRURfTUVUSE9EUy50b1N0cmluZygpKTsKCiAgU0lQLlV0aWxzLmF1Z21lbnQodGhpcywgU0lQLkNsaWVudENvbnRleHQsIFt1YSwgU0lQLkMuU1VCU0NSSUJFLCB0YXJnZXQsIG9wdGlvbnNdKTsKCiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC5zdWJzY3JpcHRpb24nKTsKCiAgdGhpcy5kaWFsb2cgPSBudWxsOwogIHRoaXMudGltZXJzID0ge046IG51bGwsIHN1Yl9kdXJhdGlvbjogbnVsbH07CiAgdGhpcy5lcnJvckNvZGVzICA9IFs0MDQsNDA1LDQxMCw0MTYsNDgwLDQ4MSw0ODIsNDgzLDQ4NCw0ODUsNDg5LDUwMSw2MDRdOwp9OwoKU0lQLlN1YnNjcmlwdGlvbi5wcm90b3R5cGUgPSB7CiAgc3Vic2NyaWJlOiBmdW5jdGlvbigpIHsKICAgIHZhciBzdWIgPSB0aGlzOwoKICAgICAvL3RoZXNlIHN0YXRlcyBwb2ludCB0byBhbiBleGlzdGluZyBzdWJzY3JpcHRpb24sIG5vIHN1YnNjcmliZSBpcyBuZWNlc3NhcnkKICAgIGlmICh0aGlzLnN0YXRlID09PSAnYWN0aXZlJykgewogICAgICB0aGlzLnJlZnJlc2goKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdGUgPT09ICdub3RpZnlfd2FpdCcpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuc3ViX2R1cmF0aW9uKTsKICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLk4pOwogICAgdGhpcy50aW1lcnMuTiA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChzdWIudGltZXJfZmlyZS5iaW5kKHN1YiksIFNJUC5UaW1lcnMuVElNRVJfTik7CgogICAgdGhpcy5zZW5kKCk7CgogICAgdGhpcy5zdGF0ZSA9ICdub3RpZnlfd2FpdCc7CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgcmVmcmVzaDogZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMuc3RhdGUgPT09ICd0ZXJtaW5hdGVkJyB8fCB0aGlzLnN0YXRlID09PSAncGVuZGluZycgfHwgdGhpcy5zdGF0ZSA9PT0gJ25vdGlmeV93YWl0JykgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5kaWFsb2cuc2VuZFJlcXVlc3QodGhpcywgU0lQLkMuU1VCU0NSSUJFLCB7CiAgICAgIGV4dHJhSGVhZGVyczogdGhpcy5leHRyYUhlYWRlcnMsCiAgICAgIGJvZHk6IHRoaXMuYm9keQogICAgfSk7CiAgfSwKCiAgcmVjZWl2ZVJlc3BvbnNlOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgdmFyIGV4cGlyZXMsIHN1YiA9IHRoaXMsCiAgICAgICAgY2F1c2UgPSBTSVAuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKHJlc3BvbnNlLnN0YXR1c19jb2RlKTsKCiAgICBpZiAoKHRoaXMuc3RhdGUgPT09ICdub3RpZnlfd2FpdCcgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPj0gMzAwKSB8fAogICAgICAgICh0aGlzLnN0YXRlICE9PSAnbm90aWZ5X3dhaXQnICYmIHRoaXMuZXJyb3JDb2Rlcy5pbmRleE9mKHJlc3BvbnNlLnN0YXR1c19jb2RlKSAhPT0gLTEpKSB7CiAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBudWxsKTsKICAgIH0gZWxzZSBpZiAoL14yWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKSl7CiAgICAgIGV4cGlyZXMgPSByZXNwb25zZS5nZXRIZWFkZXIoJ0V4cGlyZXMnKTsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuTik7CgogICAgICBpZiAodGhpcy5jcmVhdGVDb25maXJtZWREaWFsb2cocmVzcG9uc2UsJ1VBQycpKSB7CiAgICAgICAgdGhpcy5pZCA9IHRoaXMuZGlhbG9nLmlkLnRvU3RyaW5nKCk7CiAgICAgICAgdGhpcy51YS5zdWJzY3JpcHRpb25zW3RoaXMuaWRdID0gdGhpczsKICAgICAgICB0aGlzLmVtaXQoJ2FjY2VwdGVkJywgcmVzcG9uc2UsIGNhdXNlKTsKICAgICAgICAvLyBVUERBVEUgUk9VVEUgU0VUIFRPIEJFIEJBQ0tXQVJEUyBDT01QQVRJQkxFPwogICAgICB9CgogICAgICBpZiAoZXhwaXJlcyAmJiBleHBpcmVzIDw9IHRoaXMuZXhwaXJlcykgewogICAgICAgIC8vIFByZXNlcnZlIG5ldyBleHBpcmVzIHZhbHVlIGZvciBzdWJzZXF1ZW50IHJlcXVlc3RzCiAgICAgICAgdGhpcy5leHBpcmVzID0gZXhwaXJlczsKICAgICAgICB0aGlzLnRpbWVycy5zdWJfZHVyYXRpb24gPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoc3ViLnJlZnJlc2guYmluZChzdWIpLCBleHBpcmVzICogOTAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoIWV4cGlyZXMpIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ0V4cGlyZXMgaGVhZGVyIG1pc3NpbmcgaW4gYSAyMDAtY2xhc3MgcmVzcG9uc2UgdG8gU1VCU0NSSUJFJyk7CiAgICAgICAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgU0lQLkMuRVhQSVJFU19IRUFERVJfTUlTU0lORyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ0V4cGlyZXMgaGVhZGVyIGluIGEgMjAwLWNsYXNzIHJlc3BvbnNlIHRvIFNVQlNDUklCRSB3aXRoIGEgaGlnaGVyIHZhbHVlIHRoYW4gdGhlIG9uZSBpbiB0aGUgcmVxdWVzdCcpOwogICAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLklOVkFMSURfRVhQSVJFU19IRUFERVIpOwogICAgICAgIH0KICAgICAgfQogICAgfSAvL1VzZWQgdG8ganVzdCBpZ25vcmUgcHJvdmlzaW9uYWwgcmVzcG9uc2VzOyBub3cgaWdub3JlcyBldmVyeXRoaW5nIGV4Y2VwdCBlcnJvckNvZGVzIGFuZCAyeHgKICB9LAoKICB1bnN1YnNjcmliZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgZXh0cmFIZWFkZXJzID0gW10sIHN1YiA9IHRoaXM7CgogICAgdGhpcy5zdGF0ZSA9ICd0ZXJtaW5hdGVkJzsKCiAgICBleHRyYUhlYWRlcnMucHVzaCgnRXZlbnQ6ICcgKyB0aGlzLmV2ZW50KTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdFeHBpcmVzOiAwJyk7CgogICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcrIHRoaXMuY29udGFjdCk7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnQWxsb3c6ICcrIFNJUC5VQS5DLkFMTE9XRURfTUVUSE9EUy50b1N0cmluZygpKTsKCiAgICAvL21ha2VzIHN1cmUgZXhwaXJlcyBpc24ndCBzZXQsIGFuZCBvdGhlciB0eXBpY2FsIHJlc3Vic2NyaWJlIGJlaGF2aW9yCiAgICB0aGlzLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKCl7fTsKCiAgICB0aGlzLmRpYWxvZy5zZW5kUmVxdWVzdCh0aGlzLCB0aGlzLm1ldGhvZCwgewogICAgICBleHRyYUhlYWRlcnM6IGV4dHJhSGVhZGVycywKICAgICAgYm9keTogdGhpcy5ib2R5CiAgICB9KTsKCiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5zdWJfZHVyYXRpb24pOwogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuTik7CiAgICB0aGlzLnRpbWVycy5OID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KHN1Yi50aW1lcl9maXJlLmJpbmQoc3ViKSwgU0lQLlRpbWVycy5USU1FUl9OKTsKICB9LAoKICAvKioKICAqIEBwcml2YXRlCiAgKi8KICB0aW1lcl9maXJlOiBmdW5jdGlvbigpewogICAgaWYgKHRoaXMuc3RhdGUgPT09ICd0ZXJtaW5hdGVkJykgewogICAgICB0aGlzLnRlcm1pbmF0ZURpYWxvZygpOwogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5OKTsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuc3ViX2R1cmF0aW9uKTsKCiAgICAgIGRlbGV0ZSB0aGlzLnVhLnN1YnNjcmlwdGlvbnNbdGhpcy5pZF07CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdGUgPT09ICdwZW5kaW5nJyB8fCB0aGlzLnN0YXRlID09PSAnbm90aWZ5X3dhaXQnKSB7CiAgICAgIHRoaXMuY2xvc2UoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgfQogIH0sCgogIC8qKgogICogQHByaXZhdGUKICAqLwogIGNsb3NlOiBmdW5jdGlvbigpIHsKICAgIGlmKHRoaXMuc3RhdGUgIT09ICdub3RpZnlfd2FpdCcgJiYgdGhpcy5zdGF0ZSAhPT0gJ3Rlcm1pbmF0ZWQnKSB7CiAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTsKICAgIH0KICB9LAoKICAvKioKICAqIEBwcml2YXRlCiAgKi8KICBjcmVhdGVDb25maXJtZWREaWFsb2c6IGZ1bmN0aW9uKG1lc3NhZ2UsIHR5cGUpIHsKICAgIHZhciBkaWFsb2c7CgogICAgdGhpcy50ZXJtaW5hdGVEaWFsb2coKTsKICAgIGRpYWxvZyA9IG5ldyBTSVAuRGlhbG9nKHRoaXMsIG1lc3NhZ2UsIHR5cGUpOwoKICAgIGlmKCFkaWFsb2cuZXJyb3IpIHsKICAgICAgdGhpcy5kaWFsb2cgPSBkaWFsb2c7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLy8gRGlhbG9nIG5vdCBjcmVhdGVkIGR1ZSB0byBhbiBlcnJvcgogICAgZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LAoKICAvKioKICAqIEBwcml2YXRlCiAgKi8KICB0ZXJtaW5hdGVEaWFsb2c6IGZ1bmN0aW9uKCkgewogICAgaWYodGhpcy5kaWFsb2cpIHsKICAgICAgZGVsZXRlIHRoaXMudWEuc3Vic2NyaXB0aW9uc1t0aGlzLmlkXTsKICAgICAgdGhpcy5kaWFsb2cudGVybWluYXRlKCk7CiAgICAgIGRlbGV0ZSB0aGlzLmRpYWxvZzsKICAgIH0KICB9LAoKICAvKioKICAqIEBwcml2YXRlCiAgKi8KICByZWNlaXZlUmVxdWVzdDogZnVuY3Rpb24ocmVxdWVzdCkgewogICAgdmFyIHN1Yl9zdGF0ZSwgc3ViID0gdGhpczsKCiAgICBmdW5jdGlvbiBzZXRFeHBpcmVzVGltZW91dCgpIHsKICAgICAgaWYgKHN1Yl9zdGF0ZS5leHBpcmVzKSB7CiAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQoc3ViLnRpbWVycy5zdWJfZHVyYXRpb24pOwogICAgICAgIHN1Yl9zdGF0ZS5leHBpcmVzID0gTWF0aC5taW4oc3ViLmV4cGlyZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1heChzdWJfc3RhdGUuZXhwaXJlcywgMCkpOwogICAgICAgIHN1Yi50aW1lcnMuc3ViX2R1cmF0aW9uID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KHN1Yi5yZWZyZXNoLmJpbmQoc3ViKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Yl9zdGF0ZS5leHBpcmVzICogOTAwKTsKICAgICAgfQogICAgfQoKICAgIGlmICghdGhpcy5tYXRjaEV2ZW50KHJlcXVlc3QpKSB7IC8vY2hlY2tzIGV2ZW50IGFuZCBzdWJzY3JpcHRpb25fc3RhdGUgaGVhZGVycwogICAgICByZXF1ZXN0LnJlcGx5KDQ4OSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzdWJfc3RhdGUgPSByZXF1ZXN0LnBhcnNlSGVhZGVyKCdTdWJzY3JpcHRpb24tU3RhdGUnKTsKCiAgICByZXF1ZXN0LnJlcGx5KDIwMCwgU0lQLkMuUkVBU09OXzIwMCk7CgogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuTik7CgogICAgdGhpcy5lbWl0KCdub3RpZnknLCB7cmVxdWVzdDogcmVxdWVzdH0pOwoKICAgIC8vIGlmIHdlJ3ZlIHNldCBzdGF0ZSB0byB0ZXJtaW5hdGVkLCBubyBmdXJ0aGVyIHByb2Nlc3Npbmcgc2hvdWxkIHRha2UgcGxhY2UKICAgIC8vIGFuZCB3ZSBhcmUgb25seSBpbnRlcmVzdGVkIGluIGNsZWFuaW5nIHVwIGFmdGVyIHRoZSBhcHByb3ByaWF0ZSBOT1RJRlkKICAgIGlmICh0aGlzLnN0YXRlID09PSAndGVybWluYXRlZCcpIHsKICAgICAgaWYgKHN1Yl9zdGF0ZS5zdGF0ZSA9PT0gJ3Rlcm1pbmF0ZWQnKSB7CiAgICAgICAgdGhpcy50ZXJtaW5hdGVEaWFsb2coKTsKICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5OKTsKICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5zdWJfZHVyYXRpb24pOwoKICAgICAgICBkZWxldGUgdGhpcy51YS5zdWJzY3JpcHRpb25zW3RoaXMuaWRdOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzd2l0Y2ggKHN1Yl9zdGF0ZS5zdGF0ZSkgewogICAgICBjYXNlICdhY3RpdmUnOgogICAgICAgIHRoaXMuc3RhdGUgPSAnYWN0aXZlJzsKICAgICAgICBzZXRFeHBpcmVzVGltZW91dCgpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdwZW5kaW5nJzoKICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gJ25vdGlmeV93YWl0JykgewogICAgICAgICAgc2V0RXhwaXJlc1RpbWVvdXQoKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5zdGF0ZSA9ICdwZW5kaW5nJzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAndGVybWluYXRlZCc6CiAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuc3ViX2R1cmF0aW9uKTsKICAgICAgICBpZiAoc3ViX3N0YXRlLnJlYXNvbikgewogICAgICAgICAgdGhpcy5sb2dnZXIubG9nKCd0ZXJtaW5hdGluZyBzdWJzY3JpcHRpb24gd2l0aCByZWFzb24gJysgc3ViX3N0YXRlLnJlYXNvbik7CiAgICAgICAgICBzd2l0Y2ggKHN1Yl9zdGF0ZS5yZWFzb24pIHsKICAgICAgICAgICAgY2FzZSAnZGVhY3RpdmF0ZWQnOgogICAgICAgICAgICBjYXNlICd0aW1lb3V0JzoKICAgICAgICAgICAgICB0aGlzLnN1YnNjcmliZSgpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgY2FzZSAncHJvYmF0aW9uJzoKICAgICAgICAgICAgY2FzZSAnZ2l2ZXVwJzoKICAgICAgICAgICAgICBpZihzdWJfc3RhdGUucGFyYW1zICYmIHN1Yl9zdGF0ZS5wYXJhbXNbJ3JldHJ5LWFmdGVyJ10pIHsKICAgICAgICAgICAgICAgIHRoaXMudGltZXJzLnN1Yl9kdXJhdGlvbiA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChzdWIuc3Vic2NyaWJlLmJpbmQoc3ViKSwgc3ViX3N0YXRlLnBhcmFtc1sncmV0cnktYWZ0ZXInXSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgY2FzZSAncmVqZWN0ZWQnOgogICAgICAgICAgICBjYXNlICdub3Jlc291cmNlJzoKICAgICAgICAgICAgY2FzZSAnaW52YXJpYW50JzoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5jbG9zZSgpOwogICAgICAgIGJyZWFrOwogICAgfQogIH0sCgogIGZhaWxlZDogZnVuY3Rpb24ocmVzcG9uc2UsIGNhdXNlKSB7CiAgICB0aGlzLmNsb3NlKCk7CiAgICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIHJlc3BvbnNlLCBjYXVzZSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBvbkRpYWxvZ0Vycm9yOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5ESUFMT0dfRVJST1IpOwogIH0sCgogIC8qKgogICogQHByaXZhdGUKICAqLwogIG1hdGNoRXZlbnQ6IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICAgIHZhciBldmVudDsKCiAgICAvLyBDaGVjayBtYW5kYXRvcnkgaGVhZGVyIEV2ZW50CiAgICBpZiAoIXJlcXVlc3QuaGFzSGVhZGVyKCdFdmVudCcpKSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ21pc3NpbmcgRXZlbnQgaGVhZGVyJyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIC8vIENoZWNrIG1hbmRhdG9yeSBoZWFkZXIgU3Vic2NyaXB0aW9uLVN0YXRlCiAgICBpZiAoIXJlcXVlc3QuaGFzSGVhZGVyKCdTdWJzY3JpcHRpb24tU3RhdGUnKSkgewogICAgICB0aGlzLmxvZ2dlci53YXJuKCdtaXNzaW5nIFN1YnNjcmlwdGlvbi1TdGF0ZSBoZWFkZXInKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vIENoZWNrIHdoZXRoZXIgdGhlIGV2ZW50IGluIE5PVElGWSBtYXRjaGVzIHRoZSBldmVudCBpbiBTVUJTQ1JJQkUKICAgIGV2ZW50ID0gcmVxdWVzdC5wYXJzZUhlYWRlcignZXZlbnQnKS5ldmVudDsKCiAgICBpZiAodGhpcy5ldmVudCAhPT0gZXZlbnQpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybignZXZlbnQgbWF0Y2ggZmFpbGVkJyk7CiAgICAgIHJlcXVlc3QucmVwbHkoNDgxLCAnRXZlbnQgTWF0Y2ggRmFpbGVkJyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0KfTsKfTsKCn0se31dLDMyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBTSVAgVElNRVJTCiAqLwoKLyoqCiAqIEBhdWdtZW50cyBTSVAKICovCnZhcgogIFQxID0gNTAwLAogIFQyID0gNDAwMCwKICBUNCA9IDUwMDA7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHRpbWVycykgewogIHZhciBUaW1lcnMgPSB7CiAgICBUMTogVDEsCiAgICBUMjogVDIsCiAgICBUNDogVDQsCiAgICBUSU1FUl9COiA2NCAqIFQxLAogICAgVElNRVJfRDogMCAgKiBUMSwKICAgIFRJTUVSX0Y6IDY0ICogVDEsCiAgICBUSU1FUl9IOiA2NCAqIFQxLAogICAgVElNRVJfSTogMCAgKiBUMSwKICAgIFRJTUVSX0o6IDAgICogVDEsCiAgICBUSU1FUl9LOiAwICAqIFQ0LAogICAgVElNRVJfTDogNjQgKiBUMSwKICAgIFRJTUVSX006IDY0ICogVDEsCiAgICBUSU1FUl9OOiA2NCAqIFQxLAogICAgUFJPVklTSU9OQUxfUkVTUE9OU0VfSU5URVJWQUw6IDYwMDAwICAvLyBTZWUgUkZDIDMyNjEgU2VjdGlvbiAxMy4zLjEuMQogIH07CgogIFsnc2V0VGltZW91dCcsICdjbGVhclRpbWVvdXQnLCAnc2V0SW50ZXJ2YWwnLCAnY2xlYXJJbnRlcnZhbCddCiAgLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKICAgIC8vIGNhbid0IGp1c3QgdXNlIHRpbWVyc1tuYW1lXS5iaW5kKHRpbWVycykgc2luY2UgaXQgYnlwYXNzZXMgamFzbWluZSdzCiAgICAvLyBjbG9jay1tb2NraW5nCiAgICBUaW1lcnNbbmFtZV0gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aW1lcnNbbmFtZV0uYXBwbHkodGltZXJzLCBhcmd1bWVudHMpOwogICAgfTsKICB9KTsKCiAgcmV0dXJuIFRpbWVyczsKfTsKCn0se31dLDMzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBTSVAgVHJhbnNhY3Rpb25zCiAqLwoKLyoqCiAqIFNJUCBUcmFuc2FjdGlvbnMgbW9kdWxlLgogKiBAYXVnbWVudHMgU0lQCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyCiAgQyA9IHsKICAgIC8vIFRyYW5zYWN0aW9uIHN0YXRlcwogICAgU1RBVFVTX1RSWUlORzogICAgIDEsCiAgICBTVEFUVVNfUFJPQ0VFRElORzogMiwKICAgIFNUQVRVU19DQUxMSU5HOiAgICAzLAogICAgU1RBVFVTX0FDQ0VQVEVEOiAgIDQsCiAgICBTVEFUVVNfQ09NUExFVEVEOiAgNSwKICAgIFNUQVRVU19URVJNSU5BVEVEOiA2LAogICAgU1RBVFVTX0NPTkZJUk1FRDogIDcsCgogICAgLy8gVHJhbnNhY3Rpb24gdHlwZXMKICAgIE5PTl9JTlZJVEVfQ0xJRU5UOiAnbmljdCcsCiAgICBOT05fSU5WSVRFX1NFUlZFUjogJ25pc3QnLAogICAgSU5WSVRFX0NMSUVOVDogJ2ljdCcsCiAgICBJTlZJVEVfU0VSVkVSOiAnaXN0JwogIH07CgpmdW5jdGlvbiBidWlsZFZpYUhlYWRlciAocmVxdWVzdF9zZW5kZXIsIHRyYW5zcG9ydCwgaWQpIHsKICB2YXIgdmlhOwogIHZpYSA9ICdTSVAvMi4wLycgKyAocmVxdWVzdF9zZW5kZXIudWEuY29uZmlndXJhdGlvbi5oYWNrVmlhVGNwID8gJ1RDUCcgOiB0cmFuc3BvcnQuc2VydmVyLnNjaGVtZSk7CiAgdmlhICs9ICcgJyArIHJlcXVlc3Rfc2VuZGVyLnVhLmNvbmZpZ3VyYXRpb24udmlhSG9zdCArICc7YnJhbmNoPScgKyBpZDsKICBpZiAocmVxdWVzdF9zZW5kZXIudWEuY29uZmlndXJhdGlvbi5mb3JjZVJwb3J0KSB7CiAgICB2aWEgKz0gJztycG9ydCc7CiAgfQogIHJldHVybiB2aWE7Cn0KCi8qKgoqIEBhdWdtZW50cyBTSVAuVHJhbnNhY3Rpb25zCiogQGNsYXNzIE5vbiBJbnZpdGUgQ2xpZW50IFRyYW5zYWN0aW9uCiogQHBhcmFtIHtTSVAuUmVxdWVzdFNlbmRlcn0gcmVxdWVzdF9zZW5kZXIKKiBAcGFyYW0ge1NJUC5PdXRnb2luZ1JlcXVlc3R9IHJlcXVlc3QKKiBAcGFyYW0ge1NJUC5UcmFuc3BvcnR9IHRyYW5zcG9ydAoqLwp2YXIgTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24gPSBmdW5jdGlvbihyZXF1ZXN0X3NlbmRlciwgcmVxdWVzdCwgdHJhbnNwb3J0KSB7CiAgdmFyIHZpYTsKCiAgdGhpcy50eXBlID0gQy5OT05fSU5WSVRFX0NMSUVOVDsKICB0aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydDsKICB0aGlzLmlkID0gJ3o5aEc0YksnICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDAwMDApOwogIHRoaXMucmVxdWVzdF9zZW5kZXIgPSByZXF1ZXN0X3NlbmRlcjsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwoKICB0aGlzLmxvZ2dlciA9IHJlcXVlc3Rfc2VuZGVyLnVhLmdldExvZ2dlcignc2lwLnRyYW5zYWN0aW9uLm5pY3QnLCB0aGlzLmlkKTsKCiAgdmlhID0gYnVpbGRWaWFIZWFkZXIocmVxdWVzdF9zZW5kZXIsIHRyYW5zcG9ydCwgdGhpcy5pZCk7CiAgdGhpcy5yZXF1ZXN0LnNldEhlYWRlcigndmlhJywgdmlhKTsKCiAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5uZXdUcmFuc2FjdGlvbih0aGlzKTsKfTsKTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdHlwZSk7CgpOb25JbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUuc3RhdGVDaGFuZ2VkID0gZnVuY3Rpb24oc3RhdGUpIHsKICB0aGlzLnN0YXRlID0gc3RhdGU7CiAgdGhpcy5lbWl0KCdzdGF0ZUNoYW5nZWQnKTsKfTsKCk5vbkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24oKSB7CiAgdmFyIHRyID0gdGhpczsKCiAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVFJZSU5HKTsKICB0aGlzLkYgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQodHIudGltZXJfRi5iaW5kKHRyKSwgU0lQLlRpbWVycy5USU1FUl9GKTsKCiAgaWYoIXRoaXMudHJhbnNwb3J0LnNlbmQodGhpcy5yZXF1ZXN0KSkgewogICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgfQp9OwoKTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ3RyYW5zcG9ydCBlcnJvciBvY2N1cnJlZCwgZGVsZXRpbmcgbm9uLUlOVklURSBjbGllbnQgdHJhbnNhY3Rpb24gJyArIHRoaXMuaWQpOwogIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMuRik7CiAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5LKTsKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLm9uVHJhbnNwb3J0RXJyb3IoKTsKfTsKCk5vbkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS50aW1lcl9GID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5sb2dnZXIubG9nKCdUaW1lciBGIGV4cGlyZWQgZm9yIG5vbi1JTlZJVEUgY2xpZW50IHRyYW5zYWN0aW9uICcgKyB0aGlzLmlkKTsKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLm9uUmVxdWVzdFRpbWVvdXQoKTsKfTsKCk5vbkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS50aW1lcl9LID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7Cn07CgpOb25JbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUucmVjZWl2ZVJlc3BvbnNlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHsKICB2YXIKICAgIHRyID0gdGhpcywKICAgIHN0YXR1c19jb2RlID0gcmVzcG9uc2Uuc3RhdHVzX2NvZGU7CgogIGlmKHN0YXR1c19jb2RlIDwgMjAwKSB7CiAgICBzd2l0Y2godGhpcy5zdGF0ZSkgewogICAgICBjYXNlIEMuU1RBVFVTX1RSWUlORzoKICAgICAgY2FzZSBDLlNUQVRVU19QUk9DRUVESU5HOgogICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1BST0NFRURJTkcpOwogICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICBicmVhazsKICAgIH0KICB9IGVsc2UgewogICAgc3dpdGNoKHRoaXMuc3RhdGUpIHsKICAgICAgY2FzZSBDLlNUQVRVU19UUllJTkc6CiAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19DT01QTEVURUQpOwogICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMuRik7CgogICAgICAgIGlmKHN0YXR1c19jb2RlID09PSA0MDgpIHsKICAgICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIub25SZXF1ZXN0VGltZW91dCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLksgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQodHIudGltZXJfSy5iaW5kKHRyKSwgU0lQLlRpbWVycy5USU1FUl9LKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBDLlNUQVRVU19DT01QTEVURUQ6CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfQp9OwoKCgovKioKKiBAYXVnbWVudHMgU0lQLlRyYW5zYWN0aW9ucwoqIEBjbGFzcyBJbnZpdGUgQ2xpZW50IFRyYW5zYWN0aW9uCiogQHBhcmFtIHtTSVAuUmVxdWVzdFNlbmRlcn0gcmVxdWVzdF9zZW5kZXIKKiBAcGFyYW0ge1NJUC5PdXRnb2luZ1JlcXVlc3R9IHJlcXVlc3QKKiBAcGFyYW0ge1NJUC5UcmFuc3BvcnR9IHRyYW5zcG9ydAoqLwp2YXIgSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24gPSBmdW5jdGlvbihyZXF1ZXN0X3NlbmRlciwgcmVxdWVzdCwgdHJhbnNwb3J0KSB7CiAgdmFyIHZpYSwKICAgIHRyID0gdGhpczsKCiAgdGhpcy50eXBlID0gQy5JTlZJVEVfQ0xJRU5UOwogIHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0OwogIHRoaXMuaWQgPSAnejloRzRiSycgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMCk7CiAgdGhpcy5yZXF1ZXN0X3NlbmRlciA9IHJlcXVlc3Rfc2VuZGVyOwogIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7CgogIHRoaXMubG9nZ2VyID0gcmVxdWVzdF9zZW5kZXIudWEuZ2V0TG9nZ2VyKCdzaXAudHJhbnNhY3Rpb24uaWN0JywgdGhpcy5pZCk7CgogIHZpYSA9IGJ1aWxkVmlhSGVhZGVyKHJlcXVlc3Rfc2VuZGVyLCB0cmFuc3BvcnQsIHRoaXMuaWQpOwogIHRoaXMucmVxdWVzdC5zZXRIZWFkZXIoJ3ZpYScsIHZpYSk7CgogIHRoaXMucmVxdWVzdF9zZW5kZXIudWEubmV3VHJhbnNhY3Rpb24odGhpcyk7CgogIC8vIEFkZCB0aGUgY2FuY2VsIHByb3BlcnR5IHRvIHRoZSByZXF1ZXN0LgogIC8vV2lsbCBiZSBjYWxsZWQgZnJvbSB0aGUgcmVxdWVzdCBpbnN0YW5jZSwgbm90IHRoZSB0cmFuc2FjdGlvbiBpdHNlbGYuCiAgdGhpcy5yZXF1ZXN0LmNhbmNlbCA9IGZ1bmN0aW9uKHJlYXNvbikgewogICAgdHIuY2FuY2VsX3JlcXVlc3QodHIsIHJlYXNvbik7CiAgfTsKfTsKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdHlwZSk7CgpJbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUuc3RhdGVDaGFuZ2VkID0gZnVuY3Rpb24oc3RhdGUpIHsKICB0aGlzLnN0YXRlID0gc3RhdGU7CiAgdGhpcy5lbWl0KCdzdGF0ZUNoYW5nZWQnKTsKfTsKCkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24oKSB7CiAgdmFyIHRyID0gdGhpczsKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19DQUxMSU5HKTsKICB0aGlzLkIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQodHIudGltZXJfQi5iaW5kKHRyKSwgU0lQLlRpbWVycy5USU1FUl9CKTsKCiAgaWYoIXRoaXMudHJhbnNwb3J0LnNlbmQodGhpcy5yZXF1ZXN0KSkgewogICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgfQp9OwoKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ3RyYW5zcG9ydCBlcnJvciBvY2N1cnJlZCwgZGVsZXRpbmcgSU5WSVRFIGNsaWVudCB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CiAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5CKTsKICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLkQpOwogIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMuTSk7CiAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7CgogIGlmICh0aGlzLnN0YXRlICE9PSBDLlNUQVRVU19BQ0NFUFRFRCkgewogICAgdGhpcy5yZXF1ZXN0X3NlbmRlci5vblRyYW5zcG9ydEVycm9yKCk7CiAgfQp9OwoKLy8gUkZDIDYwMjYgNy4yCkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS50aW1lcl9NID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5sb2dnZXIubG9nKCdUaW1lciBNIGV4cGlyZWQgZm9yIElOVklURSBjbGllbnQgdHJhbnNhY3Rpb24gJyArIHRoaXMuaWQpOwoKICBpZih0aGlzLnN0YXRlID09PSBDLlNUQVRVU19BQ0NFUFRFRCkgewogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5CKTsKICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogICAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7CiAgfQp9OwoKLy8gUkZDIDMyNjEgMTcuMS4xCkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS50aW1lcl9CID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5sb2dnZXIubG9nKCdUaW1lciBCIGV4cGlyZWQgZm9yIElOVklURSBjbGllbnQgdHJhbnNhY3Rpb24gJyArIHRoaXMuaWQpOwogIGlmKHRoaXMuc3RhdGUgPT09IEMuU1RBVFVTX0NBTExJTkcpIHsKICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogICAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7CiAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLm9uUmVxdWVzdFRpbWVvdXQoKTsKICB9Cn07CgpJbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUudGltZXJfRCA9IGZ1bmN0aW9uKCkgewogIHRoaXMubG9nZ2VyLmxvZygnVGltZXIgRCBleHBpcmVkIGZvciBJTlZJVEUgY2xpZW50IHRyYW5zYWN0aW9uICcgKyB0aGlzLmlkKTsKICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLkIpOwogIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogIHRoaXMucmVxdWVzdF9zZW5kZXIudWEuZGVzdHJveVRyYW5zYWN0aW9uKHRoaXMpOwp9OwoKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLnNlbmRBQ0sgPSBmdW5jdGlvbihyZXNwb25zZSkgewogIHZhciB0ciA9IHRoaXM7CgogIHRoaXMuYWNrID0gJ0FDSyAnICsgdGhpcy5yZXF1ZXN0LnJ1cmkgKyAnIFNJUC8yLjBcclxuJzsKICB0aGlzLmFjayArPSAnVmlhOiAnICsgdGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ1ZpYSddLnRvU3RyaW5nKCkgKyAnXHJcbic7CgogIGlmKHRoaXMucmVxdWVzdC5oZWFkZXJzWydSb3V0ZSddKSB7CiAgICB0aGlzLmFjayArPSAnUm91dGU6ICcgKyB0aGlzLnJlcXVlc3QuaGVhZGVyc1snUm91dGUnXS50b1N0cmluZygpICsgJ1xyXG4nOwogIH0KCiAgdGhpcy5hY2sgKz0gJ1RvOiAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCd0bycpICsgJ1xyXG4nOwogIHRoaXMuYWNrICs9ICdGcm9tOiAnICsgdGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ0Zyb20nXS50b1N0cmluZygpICsgJ1xyXG4nOwogIHRoaXMuYWNrICs9ICdDYWxsLUlEOiAnICsgdGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ0NhbGwtSUQnXS50b1N0cmluZygpICsgJ1xyXG4nOwogIHRoaXMuYWNrICs9ICdDb250ZW50LUxlbmd0aDogMFxyXG4nOwogIHRoaXMuYWNrICs9ICdDU2VxOiAnICsgdGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ0NTZXEnXS50b1N0cmluZygpLnNwbGl0KCcgJylbMF07CiAgdGhpcy5hY2sgKz0gJyBBQ0tcclxuXHJcbic7CgogIHRoaXMuRCA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9ELmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX0QpOwoKICB0aGlzLnRyYW5zcG9ydC5zZW5kKHRoaXMuYWNrKTsKfTsKCkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5jYW5jZWxfcmVxdWVzdCA9IGZ1bmN0aW9uKHRyLCByZWFzb24pIHsKICB2YXIgcmVxdWVzdCA9IHRyLnJlcXVlc3Q7CgogIHRoaXMuY2FuY2VsID0gU0lQLkMuQ0FOQ0VMICsgJyAnICsgcmVxdWVzdC5ydXJpICsgJyBTSVAvMi4wXHJcbic7CiAgdGhpcy5jYW5jZWwgKz0gJ1ZpYTogJyArIHJlcXVlc3QuaGVhZGVyc1snVmlhJ10udG9TdHJpbmcoKSArICdcclxuJzsKCiAgaWYodGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ1JvdXRlJ10pIHsKICAgIHRoaXMuY2FuY2VsICs9ICdSb3V0ZTogJyArIHJlcXVlc3QuaGVhZGVyc1snUm91dGUnXS50b1N0cmluZygpICsgJ1xyXG4nOwogIH0KCiAgdGhpcy5jYW5jZWwgKz0gJ1RvOiAnICsgcmVxdWVzdC5oZWFkZXJzWydUbyddLnRvU3RyaW5nKCkgKyAnXHJcbic7CiAgdGhpcy5jYW5jZWwgKz0gJ0Zyb206ICcgKyByZXF1ZXN0LmhlYWRlcnNbJ0Zyb20nXS50b1N0cmluZygpICsgJ1xyXG4nOwogIHRoaXMuY2FuY2VsICs9ICdDYWxsLUlEOiAnICsgcmVxdWVzdC5oZWFkZXJzWydDYWxsLUlEJ10udG9TdHJpbmcoKSArICdcclxuJzsKICB0aGlzLmNhbmNlbCArPSAnQ1NlcTogJyArIHJlcXVlc3QuaGVhZGVyc1snQ1NlcSddLnRvU3RyaW5nKCkuc3BsaXQoJyAnKVswXSArCiAgJyBDQU5DRUxcclxuJzsKCiAgaWYocmVhc29uKSB7CiAgICB0aGlzLmNhbmNlbCArPSAnUmVhc29uOiAnICsgcmVhc29uICsgJ1xyXG4nOwogIH0KCiAgdGhpcy5jYW5jZWwgKz0gJ0NvbnRlbnQtTGVuZ3RoOiAwXHJcblxyXG4nOwoKICAvLyBTZW5kIG9ubHkgaWYgYSBwcm92aXNpb25hbCByZXNwb25zZSAoPjEwMCkgaGFzIGJlZW4gcmVjZWl2ZWQuCiAgaWYodGhpcy5zdGF0ZSA9PT0gQy5TVEFUVVNfUFJPQ0VFRElORykgewogICAgdGhpcy50cmFuc3BvcnQuc2VuZCh0aGlzLmNhbmNlbCk7CiAgfQp9OwoKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgdmFyCiAgdHIgPSB0aGlzLAogIHN0YXR1c19jb2RlID0gcmVzcG9uc2Uuc3RhdHVzX2NvZGU7CgogIGlmKHN0YXR1c19jb2RlID49IDEwMCAmJiBzdGF0dXNfY29kZSA8PSAxOTkpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfQ0FMTElORzoKICAgICAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19QUk9DRUVESU5HKTsKICAgICAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgICAgaWYodGhpcy5jYW5jZWwpIHsKICAgICAgICAgIHRoaXMudHJhbnNwb3J0LnNlbmQodGhpcy5jYW5jZWwpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBDLlNUQVRVU19QUk9DRUVESU5HOgogICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICBicmVhazsKICAgIH0KICB9IGVsc2UgaWYoc3RhdHVzX2NvZGUgPj0gMjAwICYmIHN0YXR1c19jb2RlIDw9IDI5OSkgewogICAgc3dpdGNoKHRoaXMuc3RhdGUpIHsKICAgICAgY2FzZSBDLlNUQVRVU19DQUxMSU5HOgogICAgICBjYXNlIEMuU1RBVFVTX1BST0NFRURJTkc6CiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfQUNDRVBURUQpOwogICAgICAgIHRoaXMuTSA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9NLmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX00pOwogICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBDLlNUQVRVU19BQ0NFUFRFRDoKICAgICAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfSBlbHNlIGlmKHN0YXR1c19jb2RlID49IDMwMCAmJiBzdGF0dXNfY29kZSA8PSA2OTkpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfQ0FMTElORzoKICAgICAgY2FzZSBDLlNUQVRVU19QUk9DRUVESU5HOgogICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX0NPTVBMRVRFRCk7CiAgICAgICAgdGhpcy5zZW5kQUNLKHJlc3BvbnNlKTsKICAgICAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgQy5TVEFUVVNfQ09NUExFVEVEOgogICAgICAgIHRoaXMuc2VuZEFDSyhyZXNwb25zZSk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfQp9OwoKCi8qKgogKiBAYXVnbWVudHMgU0lQLlRyYW5zYWN0aW9ucwogKiBAY2xhc3MgQUNLIENsaWVudCBUcmFuc2FjdGlvbgogKiBAcGFyYW0ge1NJUC5SZXF1ZXN0U2VuZGVyfSByZXF1ZXN0X3NlbmRlcgogKiBAcGFyYW0ge1NJUC5PdXRnb2luZ1JlcXVlc3R9IHJlcXVlc3QKICogQHBhcmFtIHtTSVAuVHJhbnNwb3J0fSB0cmFuc3BvcnQKICovCnZhciBBY2tDbGllbnRUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uKHJlcXVlc3Rfc2VuZGVyLCByZXF1ZXN0LCB0cmFuc3BvcnQpIHsKICB2YXIgdmlhOwoKICB0aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydDsKICB0aGlzLmlkID0gJ3o5aEc0YksnICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDAwMDApOwogIHRoaXMucmVxdWVzdF9zZW5kZXIgPSByZXF1ZXN0X3NlbmRlcjsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwoKICB0aGlzLmxvZ2dlciA9IHJlcXVlc3Rfc2VuZGVyLnVhLmdldExvZ2dlcignc2lwLnRyYW5zYWN0aW9uLm5pY3QnLCB0aGlzLmlkKTsKCiAgdmlhID0gYnVpbGRWaWFIZWFkZXIocmVxdWVzdF9zZW5kZXIsIHRyYW5zcG9ydCwgdGhpcy5pZCk7CiAgdGhpcy5yZXF1ZXN0LnNldEhlYWRlcigndmlhJywgdmlhKTsKfTsKQWNrQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdHlwZSk7CgpBY2tDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKCkgewogIGlmKCF0aGlzLnRyYW5zcG9ydC5zZW5kKHRoaXMucmVxdWVzdCkpIHsKICAgIHRoaXMub25UcmFuc3BvcnRFcnJvcigpOwogIH0KfTsKCkFja0NsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5sb2dnZXIubG9nKCd0cmFuc3BvcnQgZXJyb3Igb2NjdXJyZWQsIGZvciBhbiBBQ0sgY2xpZW50IHRyYW5zYWN0aW9uICcgKyB0aGlzLmlkKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLm9uVHJhbnNwb3J0RXJyb3IoKTsKfTsKCgovKioKKiBAYXVnbWVudHMgU0lQLlRyYW5zYWN0aW9ucwoqIEBjbGFzcyBOb24gSW52aXRlIFNlcnZlciBUcmFuc2FjdGlvbgoqIEBwYXJhbSB7U0lQLkluY29taW5nUmVxdWVzdH0gcmVxdWVzdAoqIEBwYXJhbSB7U0lQLlVBfSB1YQoqLwp2YXIgTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb24gPSBmdW5jdGlvbihyZXF1ZXN0LCB1YSkgewogIHRoaXMudHlwZSA9IEMuTk9OX0lOVklURV9TRVJWRVI7CiAgdGhpcy5pZCA9IHJlcXVlc3QudmlhX2JyYW5jaDsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwogIHRoaXMudHJhbnNwb3J0ID0gcmVxdWVzdC50cmFuc3BvcnQ7CiAgdGhpcy51YSA9IHVhOwogIHRoaXMubGFzdF9yZXNwb25zZSA9ICcnOwogIHJlcXVlc3Quc2VydmVyX3RyYW5zYWN0aW9uID0gdGhpczsKCiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC50cmFuc2FjdGlvbi5uaXN0JywgdGhpcy5pZCk7CgogIHRoaXMuc3RhdGUgPSBDLlNUQVRVU19UUllJTkc7CgogIHVhLm5ld1RyYW5zYWN0aW9uKHRoaXMpOwp9OwpOb25JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKCk5vbkludml0ZVNlcnZlclRyYW5zYWN0aW9uLnByb3RvdHlwZS5zdGF0ZUNoYW5nZWQgPSBmdW5jdGlvbihzdGF0ZSkgewogIHRoaXMuc3RhdGUgPSBzdGF0ZTsKICB0aGlzLmVtaXQoJ3N0YXRlQ2hhbmdlZCcpOwp9OwoKTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnRpbWVyX0ogPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ1RpbWVyIEogZXhwaXJlZCBmb3Igbm9uLUlOVklURSBzZXJ2ZXIgdHJhbnNhY3Rpb24gJyArIHRoaXMuaWQpOwogIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogIHRoaXMudWEuZGVzdHJveVRyYW5zYWN0aW9uKHRoaXMpOwp9OwoKTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICBpZiAoIXRoaXMudHJhbnNwb3J0RXJyb3IpIHsKICAgIHRoaXMudHJhbnNwb3J0RXJyb3IgPSB0cnVlOwoKICAgIHRoaXMubG9nZ2VyLmxvZygndHJhbnNwb3J0IGVycm9yIG9jY3VycmVkLCBkZWxldGluZyBub24tSU5WSVRFIHNlcnZlciB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CgogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5KKTsKICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogICAgdGhpcy51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7CiAgfQp9OwoKTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKHN0YXR1c19jb2RlLCByZXNwb25zZSkgewogIHZhciB0ciA9IHRoaXM7CiAgdmFyIGRlZmVycmVkID0gU0lQLlV0aWxzLmRlZmVyKCk7CgogIGlmKHN0YXR1c19jb2RlID09PSAxMDApIHsKICAgIC8qIFJGQyA0MzIwIDQuMQogICAgICogJ0EgU0lQIGVsZW1lbnQgTVVTVCBOT1QKICAgICAqIHNlbmQgYW55IHByb3Zpc2lvbmFsIHJlc3BvbnNlIHdpdGggYQogICAgICogU3RhdHVzLUNvZGUgb3RoZXIgdGhhbiAxMDAgdG8gYSBub24tSU5WSVRFIHJlcXVlc3QuJwogICAgICovCiAgICBzd2l0Y2godGhpcy5zdGF0ZSkgewogICAgICBjYXNlIEMuU1RBVFVTX1RSWUlORzoKICAgICAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19QUk9DRUVESU5HKTsKICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpICB7CiAgICAgICAgICB0aGlzLm9uVHJhbnNwb3J0RXJyb3IoKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICB0aGlzLmxhc3RfcmVzcG9uc2UgPSByZXNwb25zZTsKICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpIHsKICAgICAgICAgIHRoaXMub25UcmFuc3BvcnRFcnJvcigpOwogICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfSBlbHNlIGlmKHN0YXR1c19jb2RlID49IDIwMCAmJiBzdGF0dXNfY29kZSA8PSA2OTkpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfVFJZSU5HOgogICAgICBjYXNlIEMuU1RBVFVTX1BST0NFRURJTkc6CiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfQ09NUExFVEVEKTsKICAgICAgICB0aGlzLmxhc3RfcmVzcG9uc2UgPSByZXNwb25zZTsKICAgICAgICB0aGlzLkogPSBTSVAuVGltZXJzLnNldFRpbWVvdXQodHIudGltZXJfSi5iaW5kKHRyKSwgU0lQLlRpbWVycy5USU1FUl9KKTsKICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpIHsKICAgICAgICAgIHRoaXMub25UcmFuc3BvcnRFcnJvcigpOwogICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgQy5TVEFUVVNfQ09NUExFVEVEOgogICAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7Cn07CgovKioKKiBAYXVnbWVudHMgU0lQLlRyYW5zYWN0aW9ucwoqIEBjbGFzcyBJbnZpdGUgU2VydmVyIFRyYW5zYWN0aW9uCiogQHBhcmFtIHtTSVAuSW5jb21pbmdSZXF1ZXN0fSByZXF1ZXN0CiogQHBhcmFtIHtTSVAuVUF9IHVhCiovCnZhciBJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uKHJlcXVlc3QsIHVhKSB7CiAgdGhpcy50eXBlID0gQy5JTlZJVEVfU0VSVkVSOwogIHRoaXMuaWQgPSByZXF1ZXN0LnZpYV9icmFuY2g7CiAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDsKICB0aGlzLnRyYW5zcG9ydCA9IHJlcXVlc3QudHJhbnNwb3J0OwogIHRoaXMudWEgPSB1YTsKICB0aGlzLmxhc3RfcmVzcG9uc2UgPSAnJzsKICByZXF1ZXN0LnNlcnZlcl90cmFuc2FjdGlvbiA9IHRoaXM7CgogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAudHJhbnNhY3Rpb24uaXN0JywgdGhpcy5pZCk7CgogIHRoaXMuc3RhdGUgPSBDLlNUQVRVU19QUk9DRUVESU5HOwoKICB1YS5uZXdUcmFuc2FjdGlvbih0aGlzKTsKCiAgdGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyID0gbnVsbDsKCiAgcmVxdWVzdC5yZXBseSgxMDApOwp9OwpJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKCkludml0ZVNlcnZlclRyYW5zYWN0aW9uLnByb3RvdHlwZS5zdGF0ZUNoYW5nZWQgPSBmdW5jdGlvbihzdGF0ZSkgewogIHRoaXMuc3RhdGUgPSBzdGF0ZTsKICB0aGlzLmVtaXQoJ3N0YXRlQ2hhbmdlZCcpOwp9OwoKSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnRpbWVyX0ggPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ1RpbWVyIEggZXhwaXJlZCBmb3IgSU5WSVRFIHNlcnZlciB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CgogIGlmKHRoaXMuc3RhdGUgPT09IEMuU1RBVFVTX0NPTVBMRVRFRCkgewogICAgdGhpcy5sb2dnZXIud2FybigndHJhbnNhY3Rpb25zJywgJ0FDSyBmb3IgSU5WSVRFIHNlcnZlciB0cmFuc2FjdGlvbiB3YXMgbmV2ZXIgcmVjZWl2ZWQsIGNhbGwgd2lsbCBiZSB0ZXJtaW5hdGVkJyk7CiAgfQoKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICB0aGlzLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKfTsKCkludml0ZVNlcnZlclRyYW5zYWN0aW9uLnByb3RvdHlwZS50aW1lcl9JID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgdGhpcy51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7Cn07CgovLyBSRkMgNjAyNiA3LjEKSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnRpbWVyX0wgPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ1RpbWVyIEwgZXhwaXJlZCBmb3IgSU5WSVRFIHNlcnZlciB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CgogIGlmKHRoaXMuc3RhdGUgPT09IEMuU1RBVFVTX0FDQ0VQVEVEKSB7CiAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICAgIHRoaXMudWEuZGVzdHJveVRyYW5zYWN0aW9uKHRoaXMpOwogIH0KfTsKCkludml0ZVNlcnZlclRyYW5zYWN0aW9uLnByb3RvdHlwZS5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24oKSB7CiAgaWYgKCF0aGlzLnRyYW5zcG9ydEVycm9yKSB7CiAgICB0aGlzLnRyYW5zcG9ydEVycm9yID0gdHJ1ZTsKCiAgICB0aGlzLmxvZ2dlci5sb2coJ3RyYW5zcG9ydCBlcnJvciBvY2N1cnJlZCwgZGVsZXRpbmcgSU5WSVRFIHNlcnZlciB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CgogICAgaWYgKHRoaXMucmVzZW5kUHJvdmlzaW9uYWxUaW1lciAhPT0gbnVsbCkgewogICAgICBTSVAuVGltZXJzLmNsZWFySW50ZXJ2YWwodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyKTsKICAgICAgdGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyID0gbnVsbDsKICAgIH0KCiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLkwpOwogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5IKTsKICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMuSSk7CgogICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgICB0aGlzLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKICB9Cn07CgpJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUucmVzZW5kX3Byb3Zpc2lvbmFsID0gZnVuY3Rpb24oKSB7CiAgaWYoIXRoaXMudHJhbnNwb3J0LnNlbmQodGhpcy5sYXN0X3Jlc3BvbnNlKSkgewogICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgfQp9OwoKLy8gSU5WSVRFIFNlcnZlciBUcmFuc2FjdGlvbiBSRkMgMzI2MSAxNy4yLjEKSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKHN0YXR1c19jb2RlLCByZXNwb25zZSkgewogIHZhciB0ciA9IHRoaXM7CiAgdmFyIGRlZmVycmVkID0gU0lQLlV0aWxzLmRlZmVyKCk7CgogIGlmKHN0YXR1c19jb2RlID49IDEwMCAmJiBzdGF0dXNfY29kZSA8PSAxOTkpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpIHsKICAgICAgICAgIHRoaXMub25UcmFuc3BvcnRFcnJvcigpOwogICAgICAgIH0KICAgICAgICB0aGlzLmxhc3RfcmVzcG9uc2UgPSByZXNwb25zZTsKICAgICAgICBicmVhazsKICAgIH0KICB9CgogIGlmKHN0YXR1c19jb2RlID4gMTAwICYmIHN0YXR1c19jb2RlIDw9IDE5OSAmJiB0aGlzLnN0YXRlID09PSBDLlNUQVRVU19QUk9DRUVESU5HKSB7CiAgICAvLyBUcmlnZ2VyIHRoZSByZXNlbmRQcm92aXNpb25hbFRpbWVyIG9ubHkgZm9yIHRoZSBmaXJzdCBub24gMTAwIHByb3Zpc2lvbmFsIHJlc3BvbnNlLgogICAgaWYodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyID09PSBudWxsKSB7CiAgICAgIHRoaXMucmVzZW5kUHJvdmlzaW9uYWxUaW1lciA9IFNJUC5UaW1lcnMuc2V0SW50ZXJ2YWwodHIucmVzZW5kX3Byb3Zpc2lvbmFsLmJpbmQodHIpLAogICAgICAgIFNJUC5UaW1lcnMuUFJPVklTSU9OQUxfUkVTUE9OU0VfSU5URVJWQUwpOwogICAgfQogIH0gZWxzZSBpZihzdGF0dXNfY29kZSA+PSAyMDAgJiYgc3RhdHVzX2NvZGUgPD0gMjk5KSB7CiAgICBzd2l0Y2godGhpcy5zdGF0ZSkgewogICAgICBjYXNlIEMuU1RBVFVTX1BST0NFRURJTkc6CiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfQUNDRVBURUQpOwogICAgICAgIHRoaXMubGFzdF9yZXNwb25zZSA9IHJlc3BvbnNlOwogICAgICAgIHRoaXMuTCA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9MLmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX0wpOwoKICAgICAgICBpZiAodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyICE9PSBudWxsKSB7CiAgICAgICAgICBTSVAuVGltZXJzLmNsZWFySW50ZXJ2YWwodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyKTsKICAgICAgICAgIHRoaXMucmVzZW5kUHJvdmlzaW9uYWxUaW1lciA9IG51bGw7CiAgICAgICAgfQogICAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi8KICAgICAgICBjYXNlIEMuU1RBVFVTX0FDQ0VQVEVEOgogICAgICAgICAgLy8gTm90ZSB0aGF0IHRoaXMgcG9pbnQgd2lsbCBiZSByZWFjaGVkIGZvciBwcm9jZWVkaW5nIHRyLnN0YXRlIGFsc28uCiAgICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpIHsKICAgICAgICAgICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICB9CiAgfSBlbHNlIGlmKHN0YXR1c19jb2RlID49IDMwMCAmJiBzdGF0dXNfY29kZSA8PSA2OTkpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICBpZiAodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyICE9PSBudWxsKSB7CiAgICAgICAgICBTSVAuVGltZXJzLmNsZWFySW50ZXJ2YWwodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyKTsKICAgICAgICAgIHRoaXMucmVzZW5kUHJvdmlzaW9uYWxUaW1lciA9IG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpIHsKICAgICAgICAgIHRoaXMub25UcmFuc3BvcnRFcnJvcigpOwogICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX0NPTVBMRVRFRCk7CiAgICAgICAgICB0aGlzLkggPSBTSVAuVGltZXJzLnNldFRpbWVvdXQodHIudGltZXJfSC5iaW5kKHRyKSwgU0lQLlRpbWVycy5USU1FUl9IKTsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfQoKICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTsKfTsKCi8qKgogKiBAZnVuY3Rpb24KICogQHBhcmFtIHtTSVAuVUF9IHVhCiAqIEBwYXJhbSB7U0lQLkluY29taW5nUmVxdWVzdH0gcmVxdWVzdAogKgogKiBAcmV0dXJuIHtib29sZWFufQogKiBJTlZJVEU6CiAqICBfdHJ1ZV8gaWYgcmV0cmFuc21pc3Npb24KICogIF9mYWxzZV8gbmV3IHJlcXVlc3QKICoKICogQUNLOgogKiAgX3RydWVfICBBQ0sgdG8gbm9uMnh4IHJlc3BvbnNlCiAqICBfZmFsc2VfIEFDSyBtdXN0IGJlIHBhc3NlZCB0byBUVSAoYWNjZXB0ZWQgc3RhdGUpCiAqICAgICAgICAgIEFDSyB0byAyeHggcmVzcG9uc2UKICoKICogQ0FOQ0VMOgogKiAgX3RydWVfICBubyBtYXRjaGluZyBpbnZpdGUgdHJhbnNhY3Rpb24KICogIF9mYWxzZV8gbWF0Y2hpbmcgaW52aXRlIHRyYW5zYWN0aW9uIGFuZCBubyBmaW5hbCByZXNwb25zZSBzZW50CiAqCiAqIE9USEVSOgogKiAgX3RydWVfICByZXRyYW5zbWlzc2lvbgogKiAgX2ZhbHNlXyBuZXcgcmVxdWVzdAogKi8KdmFyIGNoZWNrVHJhbnNhY3Rpb24gPSBmdW5jdGlvbih1YSwgcmVxdWVzdCkgewogIHZhciB0cjsKCiAgc3dpdGNoKHJlcXVlc3QubWV0aG9kKSB7CiAgICBjYXNlIFNJUC5DLklOVklURToKICAgICAgdHIgPSB1YS50cmFuc2FjdGlvbnMuaXN0W3JlcXVlc3QudmlhX2JyYW5jaF07CiAgICAgIGlmKHRyKSB7CiAgICAgICAgc3dpdGNoKHRyLnN0YXRlKSB7CiAgICAgICAgICBjYXNlIEMuU1RBVFVTX1BST0NFRURJTkc6CiAgICAgICAgICAgIHRyLnRyYW5zcG9ydC5zZW5kKHRyLmxhc3RfcmVzcG9uc2UpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIC8vIFJGQyA2MDI2IDcuMSBJbnZpdGUgcmV0cmFuc21pc3Npb24KICAgICAgICAgICAgLy9yZWNlaXZlZCB3aGlsZSBpbiBDLlNUQVRVU19BQ0NFUFRFRCBzdGF0ZS4gQWJzb3JiIGl0LgogICAgICAgICAgY2FzZSBDLlNUQVRVU19BQ0NFUFRFRDoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSBTSVAuQy5BQ0s6CiAgICAgIHRyID0gdWEudHJhbnNhY3Rpb25zLmlzdFtyZXF1ZXN0LnZpYV9icmFuY2hdOwoKICAgICAgLy8gUkZDIDYwMjYgNy4xCiAgICAgIGlmKHRyKSB7CiAgICAgICAgaWYodHIuc3RhdGUgPT09IEMuU1RBVFVTX0FDQ0VQVEVEKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmKHRyLnN0YXRlID09PSBDLlNUQVRVU19DT01QTEVURUQpIHsKICAgICAgICAgIHRyLnN0YXRlID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICAgICAgdHIuSSA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9JLmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX0kpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBBQ0sgdG8gMlhYIFJlc3BvbnNlLgogICAgICBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlIFNJUC5DLkNBTkNFTDoKICAgICAgdHIgPSB1YS50cmFuc2FjdGlvbnMuaXN0W3JlcXVlc3QudmlhX2JyYW5jaF07CiAgICAgIGlmKHRyKSB7CiAgICAgICAgcmVxdWVzdC5yZXBseV9zbCgyMDApOwogICAgICAgIGlmKHRyLnN0YXRlID09PSBDLlNUQVRVU19QUk9DRUVESU5HKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXF1ZXN0LnJlcGx5X3NsKDQ4MSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgoKICAgICAgLy8gTm9uLUlOVklURSBTZXJ2ZXIgVHJhbnNhY3Rpb24gUkZDIDMyNjEgMTcuMi4yCiAgICAgIHRyID0gdWEudHJhbnNhY3Rpb25zLm5pc3RbcmVxdWVzdC52aWFfYnJhbmNoXTsKICAgICAgaWYodHIpIHsKICAgICAgICBzd2l0Y2godHIuc3RhdGUpIHsKICAgICAgICAgIGNhc2UgQy5TVEFUVVNfVFJZSU5HOgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICAgIGNhc2UgQy5TVEFUVVNfQ09NUExFVEVEOgogICAgICAgICAgICB0ci50cmFuc3BvcnQuc2VuZCh0ci5sYXN0X3Jlc3BvbnNlKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIGJyZWFrOwogIH0KfTsKClNJUC5UcmFuc2FjdGlvbnMgPSB7CiAgQzogQywKICBjaGVja1RyYW5zYWN0aW9uOiBjaGVja1RyYW5zYWN0aW9uLAogIE5vbkludml0ZUNsaWVudFRyYW5zYWN0aW9uOiBOb25JbnZpdGVDbGllbnRUcmFuc2FjdGlvbiwKICBJbnZpdGVDbGllbnRUcmFuc2FjdGlvbjogSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24sCiAgQWNrQ2xpZW50VHJhbnNhY3Rpb246IEFja0NsaWVudFRyYW5zYWN0aW9uLAogIE5vbkludml0ZVNlcnZlclRyYW5zYWN0aW9uOiBOb25JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbiwKICBJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbjogSW52aXRlU2VydmVyVHJhbnNhY3Rpb24KfTsKCn07Cgp9LHt9XSwzNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgVHJhbnNwb3J0CiAqLwoKLyoqCiAqIEBhdWdtZW50cyBTSVAKICogQGNsYXNzIFRyYW5zcG9ydAogKiBAcGFyYW0ge1NJUC5VQX0gdWEKICogQHBhcmFtIHtPYmplY3R9IHNlcnZlciB3c19zZXJ2ZXIgT2JqZWN0CiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVAsIFdlYlNvY2tldCkgewp2YXIgVHJhbnNwb3J0LAogIEMgPSB7CiAgICAvLyBUcmFuc3BvcnQgc3RhdHVzIGNvZGVzCiAgICBTVEFUVVNfUkVBRFk6ICAgICAgICAwLAogICAgU1RBVFVTX0RJU0NPTk5FQ1RFRDogMSwKICAgIFNUQVRVU19FUlJPUjogICAgICAgIDIKICB9OwoKLyoqCiAqIENvbXB1dGUgYW4gYW1vdW50IG9mIHRpbWUgaW4gc2Vjb25kcyB0byB3YWl0IGJlZm9yZSBzZW5kaW5nIGFub3RoZXIKICoga2VlcC1hbGl2ZS4KICogQHJldHVybnMge051bWJlcn0KICovCmZ1bmN0aW9uIGNvbXB1dGVLZWVwQWxpdmVUaW1lb3V0KHVwcGVyQm91bmQpIHsKICB2YXIgbG93ZXJCb3VuZCA9IHVwcGVyQm91bmQgKiAwLjg7CiAgcmV0dXJuIDEwMDAgKiAoTWF0aC5yYW5kb20oKSAqICh1cHBlckJvdW5kIC0gbG93ZXJCb3VuZCkgKyBsb3dlckJvdW5kKTsKfQoKVHJhbnNwb3J0ID0gZnVuY3Rpb24odWEsIHNlcnZlcikgewoKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnRyYW5zcG9ydCcpOwogIHRoaXMudWEgPSB1YTsKICB0aGlzLndzID0gbnVsbDsKICB0aGlzLnNlcnZlciA9IHNlcnZlcjsKICB0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyA9IDA7CiAgdGhpcy5jbG9zZWQgPSBmYWxzZTsKICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlOwogIHRoaXMucmVjb25uZWN0VGltZXIgPSBudWxsOwogIHRoaXMubGFzdFRyYW5zcG9ydEVycm9yID0ge307CgogIHRoaXMua2VlcEFsaXZlSW50ZXJ2YWwgPSB1YS5jb25maWd1cmF0aW9uLmtlZXBBbGl2ZUludGVydmFsOwogIHRoaXMua2VlcEFsaXZlVGltZW91dCA9IG51bGw7CiAgdGhpcy5rZWVwQWxpdmVUaW1lciA9IG51bGw7CgogIHRoaXMudWEudHJhbnNwb3J0ID0gdGhpczsKCiAgLy8gQ29ubmVjdAogIHRoaXMuY29ubmVjdCgpOwp9OwoKVHJhbnNwb3J0LnByb3RvdHlwZSA9IHsKICAvKioKICAgKiBTZW5kIGEgbWVzc2FnZS4KICAgKiBAcGFyYW0ge1NJUC5PdXRnb2luZ1JlcXVlc3R8U3RyaW5nfSBtc2cKICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0KICAgKi8KICBzZW5kOiBmdW5jdGlvbihtc2cpIHsKICAgIHZhciBtZXNzYWdlID0gbXNnLnRvU3RyaW5nKCk7CgogICAgaWYodGhpcy53cyAmJiB0aGlzLndzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7CiAgICAgIGlmICh0aGlzLnVhLmNvbmZpZ3VyYXRpb24udHJhY2VTaXAgPT09IHRydWUpIHsKICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ3NlbmRpbmcgV2ViU29ja2V0IG1lc3NhZ2U6XG5cbicgKyBtZXNzYWdlICsgJ1xuJyk7CiAgICAgIH0KICAgICAgdGhpcy53cy5zZW5kKG1lc3NhZ2UpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ3VuYWJsZSB0byBzZW5kIG1lc3NhZ2UsIFdlYlNvY2tldCBpcyBub3Qgb3BlbicpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogU2VuZCBhIGtlZXAtYWxpdmUgKGEgZG91YmxlLUNSTEYgc2VxdWVuY2UpLgogICAqIEBwcml2YXRlCiAgICogQHJldHVybnMge0Jvb2xlYW59CiAgICovCiAgc2VuZEtlZXBBbGl2ZTogZnVuY3Rpb24oKSB7CiAgICBpZih0aGlzLmtlZXBBbGl2ZVRpbWVvdXQpIHsgcmV0dXJuOyB9CgogICAgdGhpcy5rZWVwQWxpdmVUaW1lb3V0ID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnVhLmVtaXQoJ2tlZXBBbGl2ZVRpbWVvdXQnKTsKICAgIH0uYmluZCh0aGlzKSwgMTAwMDApOwoKICAgIHJldHVybiB0aGlzLnNlbmQoJ1xyXG5cclxuJyk7CiAgfSwKCiAgLyoqCiAgICogU3RhcnQgc2VuZGluZyBrZWVwLWFsaXZlcy4KICAgKiBAcHJpdmF0ZQogICAqLwogIHN0YXJ0U2VuZGluZ0tlZXBBbGl2ZXM6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMua2VlcEFsaXZlSW50ZXJ2YWwgJiYgIXRoaXMua2VlcEFsaXZlVGltZXIpIHsKICAgICAgdGhpcy5rZWVwQWxpdmVUaW1lciA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICB0aGlzLnNlbmRLZWVwQWxpdmUoKTsKICAgICAgICB0aGlzLmtlZXBBbGl2ZVRpbWVyID0gbnVsbDsKICAgICAgICB0aGlzLnN0YXJ0U2VuZGluZ0tlZXBBbGl2ZXMoKTsKICAgICAgfS5iaW5kKHRoaXMpLCBjb21wdXRlS2VlcEFsaXZlVGltZW91dCh0aGlzLmtlZXBBbGl2ZUludGVydmFsKSk7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogU3RvcCBzZW5kaW5nIGtlZXAtYWxpdmVzLgogICAqIEBwcml2YXRlCiAgICovCiAgc3RvcFNlbmRpbmdLZWVwQWxpdmVzOiBmdW5jdGlvbigpIHsKICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMua2VlcEFsaXZlVGltZXIpOwogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5rZWVwQWxpdmVUaW1lb3V0KTsKICAgIHRoaXMua2VlcEFsaXZlVGltZXIgPSBudWxsOwogICAgdGhpcy5rZWVwQWxpdmVUaW1lb3V0ID0gbnVsbDsKICB9LAoKICAvKioKICAqIERpc2Nvbm5lY3Qgc29ja2V0LgogICovCiAgZGlzY29ubmVjdDogZnVuY3Rpb24oKSB7CiAgICBpZih0aGlzLndzKSB7CiAgICAgIC8vIENsZWFyIHJlY29ubmVjdFRpbWVyCiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVjb25uZWN0VGltZXIpOwoKICAgICAgdGhpcy5zdG9wU2VuZGluZ0tlZXBBbGl2ZXMoKTsKCiAgICAgIHRoaXMuY2xvc2VkID0gdHJ1ZTsKICAgICAgdGhpcy5sb2dnZXIubG9nKCdjbG9zaW5nIFdlYlNvY2tldCAnICsgdGhpcy5zZXJ2ZXIud3NfdXJpKTsKICAgICAgdGhpcy53cy5jbG9zZSgpOwogICAgfQoKICAgIGlmICh0aGlzLnJlY29ubmVjdFRpbWVyICE9PSBudWxsKSB7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVjb25uZWN0VGltZXIpOwogICAgICB0aGlzLnJlY29ubmVjdFRpbWVyID0gbnVsbDsKICAgICAgdGhpcy51YS5lbWl0KCdkaXNjb25uZWN0ZWQnLCB7CiAgICAgICAgdHJhbnNwb3J0OiB0aGlzLAogICAgICAgIGNvZGU6IHRoaXMubGFzdFRyYW5zcG9ydEVycm9yLmNvZGUsCiAgICAgICAgcmVhc29uOiB0aGlzLmxhc3RUcmFuc3BvcnRFcnJvci5yZWFzb24KICAgICAgfSk7CiAgICB9CiAgfSwKCiAgLyoqCiAgKiBDb25uZWN0IHNvY2tldC4KICAqLwogIGNvbm5lY3Q6IGZ1bmN0aW9uKCkgewogICAgdmFyIHRyYW5zcG9ydCA9IHRoaXM7CgogICAgaWYodGhpcy53cyAmJiAodGhpcy53cy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTiB8fCB0aGlzLndzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5DT05ORUNUSU5HKSkgewogICAgICB0aGlzLmxvZ2dlci5sb2coJ1dlYlNvY2tldCAnICsgdGhpcy5zZXJ2ZXIud3NfdXJpICsgJyBpcyBhbHJlYWR5IGNvbm5lY3RlZCcpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYodGhpcy53cykgewogICAgICB0aGlzLndzLmNsb3NlKCk7CiAgICB9CgogICAgdGhpcy5sb2dnZXIubG9nKCdjb25uZWN0aW5nIHRvIFdlYlNvY2tldCAnICsgdGhpcy5zZXJ2ZXIud3NfdXJpKTsKICAgIHRoaXMudWEub25UcmFuc3BvcnRDb25uZWN0aW5nKHRoaXMsCiAgICAgICh0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyA9PT0gMCk/MTp0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyk7CgogICAgdHJ5IHsKICAgICAgdGhpcy53cyA9IG5ldyBXZWJTb2NrZXQodGhpcy5zZXJ2ZXIud3NfdXJpLCAnc2lwJyk7CiAgICB9IGNhdGNoKGUpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybignZXJyb3IgY29ubmVjdGluZyB0byBXZWJTb2NrZXQgJyArIHRoaXMuc2VydmVyLndzX3VyaSArICc6ICcgKyBlKTsKICAgIH0KCiAgICB0aGlzLndzLmJpbmFyeVR5cGUgPSAnYXJyYXlidWZmZXInOwoKICAgIHRoaXMud3Mub25vcGVuID0gZnVuY3Rpb24oKSB7CiAgICAgIHRyYW5zcG9ydC5vbk9wZW4oKTsKICAgIH07CgogICAgdGhpcy53cy5vbmNsb3NlID0gZnVuY3Rpb24oZSkgewogICAgICB0cmFuc3BvcnQub25DbG9zZShlKTsKICAgIH07CgogICAgdGhpcy53cy5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlKSB7CiAgICAgIHRyYW5zcG9ydC5vbk1lc3NhZ2UoZSk7CiAgICB9OwoKICAgIHRoaXMud3Mub25lcnJvciA9IGZ1bmN0aW9uKGUpIHsKICAgICAgdHJhbnNwb3J0Lm9uRXJyb3IoZSk7CiAgICB9OwogIH0sCgogIC8vIFRyYW5zcG9ydCBFdmVudCBIYW5kbGVycwoKICAvKioKICAqIEBldmVudAogICogQHBhcmFtIHtldmVudH0gZQogICovCiAgb25PcGVuOiBmdW5jdGlvbigpIHsKICAgIHRoaXMuY29ubmVjdGVkID0gdHJ1ZTsKCiAgICB0aGlzLmxvZ2dlci5sb2coJ1dlYlNvY2tldCAnICsgdGhpcy5zZXJ2ZXIud3NfdXJpICsgJyBjb25uZWN0ZWQnKTsKICAgIC8vIENsZWFyIHJlY29ubmVjdFRpbWVyIHNpbmNlIHdlIGFyZSBub3QgZGlzY29ubmVjdGVkCiAgICBpZiAodGhpcy5yZWNvbm5lY3RUaW1lciAhPT0gbnVsbCkgewogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnJlY29ubmVjdFRpbWVyKTsKICAgICAgdGhpcy5yZWNvbm5lY3RUaW1lciA9IG51bGw7CiAgICB9CiAgICAvLyBSZXNldCByZWNvbm5lY3Rpb25fYXR0ZW1wdHMKICAgIHRoaXMucmVjb25uZWN0aW9uX2F0dGVtcHRzID0gMDsKICAgIC8vIERpc2FibGUgY2xvc2VkCiAgICB0aGlzLmNsb3NlZCA9IGZhbHNlOwogICAgLy8gVHJpZ2dlciBvblRyYW5zcG9ydENvbm5lY3RlZCBjYWxsYmFjawogICAgdGhpcy51YS5vblRyYW5zcG9ydENvbm5lY3RlZCh0aGlzKTsKICAgIC8vIFN0YXJ0IHNlbmRpbmcga2VlcC1hbGl2ZXMKICAgIHRoaXMuc3RhcnRTZW5kaW5nS2VlcEFsaXZlcygpOwogIH0sCgogIC8qKgogICogQGV2ZW50CiAgKiBAcGFyYW0ge2V2ZW50fSBlCiAgKi8KICBvbkNsb3NlOiBmdW5jdGlvbihlKSB7CiAgICB2YXIgY29ubmVjdGVkX2JlZm9yZSA9IHRoaXMuY29ubmVjdGVkOwoKICAgIHRoaXMubGFzdFRyYW5zcG9ydEVycm9yLmNvZGUgPSBlLmNvZGU7CiAgICB0aGlzLmxhc3RUcmFuc3BvcnRFcnJvci5yZWFzb24gPSBlLnJlYXNvbjsKCiAgICB0aGlzLnN0b3BTZW5kaW5nS2VlcEFsaXZlcygpOwoKICAgIGlmICh0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyA+IDApIHsKICAgICAgdGhpcy5sb2dnZXIubG9nKCdSZWNvbm5lY3Rpb24gYXR0ZW1wdCAnICsgdGhpcy5yZWNvbm5lY3Rpb25fYXR0ZW1wdHMgKyAnIGZhaWxlZCAoY29kZTogJyArIGUuY29kZSArIChlLnJlYXNvbj8gJ3wgcmVhc29uOiAnICsgZS5yZWFzb24gOiAnJykgKycpJyk7CiAgICAgIHRoaXMucmVjb25uZWN0KCk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlOwogICAgICB0aGlzLmxvZ2dlci5sb2coJ1dlYlNvY2tldCBkaXNjb25uZWN0ZWQgKGNvZGU6ICcgKyBlLmNvZGUgKyAoZS5yZWFzb24/ICd8IHJlYXNvbjogJyArIGUucmVhc29uIDogJycpICsnKScpOwoKICAgICAgaWYoZS53YXNDbGVhbiA9PT0gZmFsc2UpIHsKICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCdXZWJTb2NrZXQgYWJydXB0IGRpc2Nvbm5lY3Rpb24nKTsKICAgICAgfQogICAgICAvLyBUcmFuc3BvcnQgd2FzIGNvbm5lY3RlZAogICAgICBpZihjb25uZWN0ZWRfYmVmb3JlID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy51YS5vblRyYW5zcG9ydENsb3NlZCh0aGlzKTsKICAgICAgICAvLyBDaGVjayB3aGV0aGVyIHRoZSB1c2VyIHJlcXVlc3RlZCB0byBjbG9zZS4KICAgICAgICBpZighdGhpcy5jbG9zZWQpIHsKICAgICAgICAgIHRoaXMucmVjb25uZWN0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudWEuZW1pdCgnZGlzY29ubmVjdGVkJywgewogICAgICAgICAgICB0cmFuc3BvcnQ6IHRoaXMsCiAgICAgICAgICAgIGNvZGU6IHRoaXMubGFzdFRyYW5zcG9ydEVycm9yLmNvZGUsCiAgICAgICAgICAgIHJlYXNvbjogdGhpcy5sYXN0VHJhbnNwb3J0RXJyb3IucmVhc29uCiAgICAgICAgICB9KTsKCiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IGNvbm5lY3Rpb24gYXR0ZW1wdAogICAgICAgIC8vTmV0d29yayBlcnJvcgogICAgICAgIHRoaXMudWEub25UcmFuc3BvcnRFcnJvcih0aGlzKTsKICAgICAgfQogICAgfQogIH0sCgogIC8qKgogICogQGV2ZW50CiAgKiBAcGFyYW0ge2V2ZW50fSBlCiAgKi8KICBvbk1lc3NhZ2U6IGZ1bmN0aW9uKGUpIHsKICAgIHZhciBtZXNzYWdlLCB0cmFuc2FjdGlvbiwKICAgICAgZGF0YSA9IGUuZGF0YTsKCiAgICAvLyBDUkxGIEtlZXAgQWxpdmUgcmVzcG9uc2UgZnJvbSBzZXJ2ZXIuIElnbm9yZSBpdC4KICAgIGlmKGRhdGEgPT09ICdcclxuJykgewogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLmtlZXBBbGl2ZVRpbWVvdXQpOwogICAgICB0aGlzLmtlZXBBbGl2ZVRpbWVvdXQgPSBudWxsOwoKICAgICAgaWYgKHRoaXMudWEuY29uZmlndXJhdGlvbi50cmFjZVNpcCA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMubG9nZ2VyLmxvZygncmVjZWl2ZWQgV2ViU29ja2V0IG1lc3NhZ2Ugd2l0aCBDUkxGIEtlZXAgQWxpdmUgcmVzcG9uc2UnKTsKICAgICAgfQoKICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIFdlYlNvY2tldCBiaW5hcnkgbWVzc2FnZS4KICAgIGVsc2UgaWYgKHR5cGVvZiBkYXRhICE9PSAnc3RyaW5nJykgewogICAgICB0cnkgewogICAgICAgIGRhdGEgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIG5ldyBVaW50OEFycmF5KGRhdGEpKTsKICAgICAgfSBjYXRjaChldnQpIHsKICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCdyZWNlaXZlZCBXZWJTb2NrZXQgYmluYXJ5IG1lc3NhZ2UgZmFpbGVkIHRvIGJlIGNvbnZlcnRlZCBpbnRvIHN0cmluZywgbWVzc2FnZSBkaXNjYXJkZWQnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnVhLmNvbmZpZ3VyYXRpb24udHJhY2VTaXAgPT09IHRydWUpIHsKICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ3JlY2VpdmVkIFdlYlNvY2tldCBiaW5hcnkgbWVzc2FnZTpcblxuJyArIGRhdGEgKyAnXG4nKTsKICAgICAgfQogICAgfQoKICAgIC8vIFdlYlNvY2tldCB0ZXh0IG1lc3NhZ2UuCiAgICBlbHNlIHsKICAgICAgaWYgKHRoaXMudWEuY29uZmlndXJhdGlvbi50cmFjZVNpcCA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMubG9nZ2VyLmxvZygncmVjZWl2ZWQgV2ViU29ja2V0IHRleHQgbWVzc2FnZTpcblxuJyArIGRhdGEgKyAnXG4nKTsKICAgICAgfQogICAgfQoKICAgIG1lc3NhZ2UgPSBTSVAuUGFyc2VyLnBhcnNlTWVzc2FnZShkYXRhLCB0aGlzLnVhKTsKCiAgICBpZiAoIW1lc3NhZ2UpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmKHRoaXMudWEuc3RhdHVzID09PSBTSVAuVUEuQy5TVEFUVVNfVVNFUl9DTE9TRUQgJiYgbWVzc2FnZSBpbnN0YW5jZW9mIFNJUC5JbmNvbWluZ1JlcXVlc3QpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIERvIHNvbWUgc2FuaXR5IGNoZWNrCiAgICBpZihTSVAuc2FuaXR5Q2hlY2sobWVzc2FnZSwgdGhpcy51YSwgdGhpcykpIHsKICAgICAgaWYobWVzc2FnZSBpbnN0YW5jZW9mIFNJUC5JbmNvbWluZ1JlcXVlc3QpIHsKICAgICAgICBtZXNzYWdlLnRyYW5zcG9ydCA9IHRoaXM7CiAgICAgICAgdGhpcy51YS5yZWNlaXZlUmVxdWVzdChtZXNzYWdlKTsKICAgICAgfSBlbHNlIGlmKG1lc3NhZ2UgaW5zdGFuY2VvZiBTSVAuSW5jb21pbmdSZXNwb25zZSkgewogICAgICAgIC8qIFVuaWtlIHN0YXRlZCBpbiAxOC4xLjIsIGlmIGEgcmVzcG9uc2UgZG9lcyBub3QgbWF0Y2gKICAgICAgICAqIGFueSB0cmFuc2FjdGlvbiwgaXQgaXMgZGlzY2FyZGVkIGhlcmUgYW5kIG5vIHBhc3NlZCB0byB0aGUgY29yZQogICAgICAgICogaW4gb3JkZXIgdG8gYmUgZGlzY2FyZGVkIHRoZXJlLgogICAgICAgICovCiAgICAgICAgc3dpdGNoKG1lc3NhZ2UubWV0aG9kKSB7CiAgICAgICAgICBjYXNlIFNJUC5DLklOVklURToKICAgICAgICAgICAgdHJhbnNhY3Rpb24gPSB0aGlzLnVhLnRyYW5zYWN0aW9ucy5pY3RbbWVzc2FnZS52aWFfYnJhbmNoXTsKICAgICAgICAgICAgaWYodHJhbnNhY3Rpb24pIHsKICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5yZWNlaXZlUmVzcG9uc2UobWVzc2FnZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIFNJUC5DLkFDSzoKICAgICAgICAgICAgLy8gSnVzdCBpbiBjYXNlIDstKQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIHRyYW5zYWN0aW9uID0gdGhpcy51YS50cmFuc2FjdGlvbnMubmljdFttZXNzYWdlLnZpYV9icmFuY2hdOwogICAgICAgICAgICBpZih0cmFuc2FjdGlvbikgewogICAgICAgICAgICAgIHRyYW5zYWN0aW9uLnJlY2VpdmVSZXNwb25zZShtZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAoKICAvKioKICAqIEBldmVudAogICogQHBhcmFtIHtldmVudH0gZQogICovCiAgb25FcnJvcjogZnVuY3Rpb24oZSkgewogICAgdGhpcy5sb2dnZXIud2FybignV2ViU29ja2V0IGNvbm5lY3Rpb24gZXJyb3I6ICcgKyBKU09OLnN0cmluZ2lmeShlKSk7CiAgfSwKCiAgLyoqCiAgKiBSZWNvbm5lY3Rpb24gYXR0ZW1wdCBsb2dpYy4KICAqIEBwcml2YXRlCiAgKi8KICByZWNvbm5lY3Q6IGZ1bmN0aW9uKCkgewogICAgdmFyIHRyYW5zcG9ydCA9IHRoaXM7CgogICAgdGhpcy5yZWNvbm5lY3Rpb25fYXR0ZW1wdHMgKz0gMTsKCiAgICBpZih0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyA+IHRoaXMudWEuY29uZmlndXJhdGlvbi53c1NlcnZlck1heFJlY29ubmVjdGlvbikgewogICAgICB0aGlzLmxvZ2dlci53YXJuKCdtYXhpbXVtIHJlY29ubmVjdGlvbiBhdHRlbXB0cyBmb3IgV2ViU29ja2V0ICcgKyB0aGlzLnNlcnZlci53c191cmkpOwogICAgICB0aGlzLnVhLm9uVHJhbnNwb3J0RXJyb3IodGhpcyk7CiAgICB9IGVsc2UgaWYgKHRoaXMucmVjb25uZWN0aW9uX2F0dGVtcHRzID09PSAxKSB7CiAgICAgIHRoaXMubG9nZ2VyLmxvZygnQ29ubmVjdGlvbiB0byBXZWJTb2NrZXQgJyArIHRoaXMuc2VydmVyLndzX3VyaSArICcgc2V2ZXJlZCwgYXR0ZW1wdGluZyBmaXJzdCByZWNvbm5lY3QnKTsKICAgICAgdHJhbnNwb3J0LmNvbm5lY3QoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMubG9nZ2VyLmxvZygndHJ5aW5nIHRvIHJlY29ubmVjdCB0byBXZWJTb2NrZXQgJyArIHRoaXMuc2VydmVyLndzX3VyaSArICcgKHJlY29ubmVjdGlvbiBhdHRlbXB0ICcgKyB0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyArICcpJyk7CgogICAgICB0aGlzLnJlY29ubmVjdFRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgIHRyYW5zcG9ydC5jb25uZWN0KCk7CiAgICAgICAgdHJhbnNwb3J0LnJlY29ubmVjdFRpbWVyID0gbnVsbDsKICAgICAgfSwgdGhpcy51YS5jb25maWd1cmF0aW9uLndzU2VydmVyUmVjb25uZWN0aW9uVGltZW91dCAqIDEwMDApOwogICAgfQogIH0KfTsKClRyYW5zcG9ydC5DID0gQzsKcmV0dXJuIFRyYW5zcG9ydDsKfTsKCn0se31dLDM1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKKGZ1bmN0aW9uIChnbG9iYWwpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAYXVnbWVudHMgU0lQCiAqIEBjbGFzcyBDbGFzcyBjcmVhdGluZyBhIFNJUCBVc2VyIEFnZW50LgogKiBAcGFyYW0ge2Z1bmN0aW9uIHJldHVybmluZyBTSVAuTWVkaWFIYW5kbGVyfSBbY29uZmlndXJhdGlvbi5tZWRpYUhhbmRsZXJGYWN0b3J5XQogKiAgICAgICAgQSBmdW5jdGlvbiB3aWxsIGJlIGludm9rZWQgYnkgZWFjaCBvZiB0aGUgVUEncyBTZXNzaW9ucyB0byBidWlsZCB0aGUgTWVkaWFIYW5kbGVyIGZvciB0aGF0IFNlc3Npb24uCiAqICAgICAgICBJZiBubyAob3IgYSBmYWxzeSkgdmFsdWUgaXMgcHJvdmlkZWQsIGVhY2ggU2Vzc2lvbiB3aWxsIHVzZSBhIGRlZmF1bHQgKFdlYlJUQykgTWVkaWFIYW5kbGVyLgogKgogKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZ3VyYXRpb24ubWVkaWFdIGdldHMgcGFzc2VkIHRvIFNJUC5NZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24gYXMgbWVkaWFIaW50CiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVAsIGVudmlyb25tZW50KSB7CnZhciBVQSwKICBDID0gewogICAgLy8gVUEgc3RhdHVzIGNvZGVzCiAgICBTVEFUVVNfSU5JVDogICAgICAgICAgICAgICAgMCwKICAgIFNUQVRVU19TVEFSVElORzogICAgICAgICAgICAxLAogICAgU1RBVFVTX1JFQURZOiAgICAgICAgICAgICAgIDIsCiAgICBTVEFUVVNfVVNFUl9DTE9TRUQ6ICAgICAgICAgMywKICAgIFNUQVRVU19OT1RfUkVBRFk6ICAgICAgICAgICA0LAoKICAgIC8vIFVBIGVycm9yIGNvZGVzCiAgICBDT05GSUdVUkFUSU9OX0VSUk9SOiAgMSwKICAgIE5FVFdPUktfRVJST1I6ICAgICAgICAyLAoKICAgIEFMTE9XRURfTUVUSE9EUzogWwogICAgICAnQUNLJywKICAgICAgJ0NBTkNFTCcsCiAgICAgICdJTlZJVEUnLAogICAgICAnTUVTU0FHRScsCiAgICAgICdCWUUnLAogICAgICAnT1BUSU9OUycsCiAgICAgICdJTkZPJywKICAgICAgJ05PVElGWScsCiAgICAgICdSRUZFUicKICAgIF0sCgogICAgQUNDRVBURURfQk9EWV9UWVBFUzogWwogICAgICAnYXBwbGljYXRpb24vc2RwJywKICAgICAgJ2FwcGxpY2F0aW9uL2R0bWYtcmVsYXknCiAgICBdLAoKICAgIE1BWF9GT1JXQVJEUzogNzAsCiAgICBUQUdfTEVOR1RIOiAxMAogIH07CgpVQSA9IGZ1bmN0aW9uKGNvbmZpZ3VyYXRpb24pIHsKICB2YXIgc2VsZiA9IHRoaXM7CgogIC8vIEhlbHBlciBmdW5jdGlvbiBmb3IgZm9yd2FyZGluZyBldmVudHMKICBmdW5jdGlvbiBzZWxmRW1pdCh0eXBlKSB7CiAgICAvL3JlZ2lzdHJhdGlvbkZhaWxlZCBoYW5kbGVyIGlzIGludm9rZWQgd2l0aCB0d28gYXJndW1lbnRzLiBBbGxvdyBldmVudCBoYW5kbGVycyB0byBiZSBpbnZva2VkIHdpdGggYSB2YXJpYWJsZSBuby4gb2YgYXJndW1lbnRzCiAgICByZXR1cm4gc2VsZi5lbWl0LmJpbmQoc2VsZiwgdHlwZSk7CiAgfQoKICAvLyBTZXQgQWNjZXB0ZWQgQm9keSBUeXBlcwogIEMuQUNDRVBURURfQk9EWV9UWVBFUyA9IEMuQUNDRVBURURfQk9EWV9UWVBFUy50b1N0cmluZygpOwoKICB0aGlzLmxvZyA9IG5ldyBTSVAuTG9nZ2VyRmFjdG9yeSgpOwogIHRoaXMubG9nZ2VyID0gdGhpcy5nZXRMb2dnZXIoJ3NpcC51YScpOwoKICB0aGlzLmNhY2hlID0gewogICAgY3JlZGVudGlhbHM6IHt9CiAgfTsKCiAgdGhpcy5jb25maWd1cmF0aW9uID0ge307CiAgdGhpcy5kaWFsb2dzID0ge307CgogIC8vVXNlciBhY3Rpb25zIG91dHNpZGUgYW55IHNlc3Npb24vZGlhbG9nIChNRVNTQUdFKQogIHRoaXMuYXBwbGljYW50cyA9IHt9OwoKICB0aGlzLmRhdGEgPSB7fTsKICB0aGlzLnNlc3Npb25zID0ge307CiAgdGhpcy5zdWJzY3JpcHRpb25zID0ge307CiAgdGhpcy50cmFuc3BvcnQgPSBudWxsOwogIHRoaXMuY29udGFjdCA9IG51bGw7CiAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19JTklUOwogIHRoaXMuZXJyb3IgPSBudWxsOwogIHRoaXMudHJhbnNhY3Rpb25zID0gewogICAgbmlzdDoge30sCiAgICBuaWN0OiB7fSwKICAgIGlzdDoge30sCiAgICBpY3Q6IHt9CiAgfTsKCiAgdGhpcy50cmFuc3BvcnRSZWNvdmVyQXR0ZW1wdHMgPSAwOwogIHRoaXMudHJhbnNwb3J0UmVjb3ZlcnlUaW1lciA9IG51bGw7CgogIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIHsKICAgIHRyYW5zYWN0aW9uc0NvdW50OiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHR5cGUsCiAgICAgICAgICB0cmFuc2FjdGlvbnMgPSBbJ25pc3QnLCduaWN0JywnaXN0JywnaWN0J10sCiAgICAgICAgICBjb3VudCA9IDA7CgogICAgICAgIGZvciAodHlwZSBpbiB0cmFuc2FjdGlvbnMpIHsKICAgICAgICAgIGNvdW50ICs9IE9iamVjdC5rZXlzKHRoaXMudHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uc1t0eXBlXV0pLmxlbmd0aDsKICAgICAgICB9CgogICAgICAgIHJldHVybiBjb3VudDsKICAgICAgfQogICAgfSwKCiAgICBuaWN0VHJhbnNhY3Rpb25zQ291bnQ6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy50cmFuc2FjdGlvbnNbJ25pY3QnXSkubGVuZ3RoOwogICAgICB9CiAgICB9LAoKICAgIG5pc3RUcmFuc2FjdGlvbnNDb3VudDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnRyYW5zYWN0aW9uc1snbmlzdCddKS5sZW5ndGg7CiAgICAgIH0KICAgIH0sCgogICAgaWN0VHJhbnNhY3Rpb25zQ291bnQ6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy50cmFuc2FjdGlvbnNbJ2ljdCddKS5sZW5ndGg7CiAgICAgIH0KICAgIH0sCgogICAgaXN0VHJhbnNhY3Rpb25zQ291bnQ6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy50cmFuc2FjdGlvbnNbJ2lzdCddKS5sZW5ndGg7CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLyoqCiAgICogTG9hZCBjb25maWd1cmF0aW9uCiAgICoKICAgKiBAdGhyb3dzIHtTSVAuRXhjZXB0aW9ucy5Db25maWd1cmF0aW9uRXJyb3J9CiAgICogQHRocm93cyB7VHlwZUVycm9yfQogICAqLwoKICBpZihjb25maWd1cmF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgIGNvbmZpZ3VyYXRpb24gPSB7fTsKICB9IGVsc2UgaWYgKHR5cGVvZiBjb25maWd1cmF0aW9uID09PSAnc3RyaW5nJyB8fCBjb25maWd1cmF0aW9uIGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICBjb25maWd1cmF0aW9uID0gewogICAgICB1cmk6IGNvbmZpZ3VyYXRpb24KICAgIH07CiAgfQoKICAvLyBBcHBseSBsb2cgY29uZmlndXJhdGlvbiBpZiBwcmVzZW50CiAgaWYgKGNvbmZpZ3VyYXRpb24ubG9nKSB7CiAgICBpZiAoY29uZmlndXJhdGlvbi5sb2cuaGFzT3duUHJvcGVydHkoJ2J1aWx0aW5FbmFibGVkJykpIHsKICAgICAgdGhpcy5sb2cuYnVpbHRpbkVuYWJsZWQgPSBjb25maWd1cmF0aW9uLmxvZy5idWlsdGluRW5hYmxlZDsKICAgIH0KCiAgICBpZiAoY29uZmlndXJhdGlvbi5sb2cuaGFzT3duUHJvcGVydHkoJ2xldmVsJykpIHsKICAgICAgdGhpcy5sb2cubGV2ZWwgPSBjb25maWd1cmF0aW9uLmxvZy5sZXZlbDsKICAgIH0KCiAgICBpZiAoY29uZmlndXJhdGlvbi5sb2cuaGFzT3duUHJvcGVydHkoJ2Nvbm5lY3RvcicpKSB7CiAgICAgIHRoaXMubG9nLmNvbm5lY3RvciA9IGNvbmZpZ3VyYXRpb24ubG9nLmNvbm5lY3RvcjsKICAgIH0KICB9CgogIHRyeSB7CiAgICB0aGlzLmxvYWRDb25maWcoY29uZmlndXJhdGlvbik7CiAgfSBjYXRjaChlKSB7CiAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX05PVF9SRUFEWTsKICAgIHRoaXMuZXJyb3IgPSBDLkNPTkZJR1VSQVRJT05fRVJST1I7CiAgICB0aHJvdyBlOwogIH0KCiAgLy8gSW5pdGlhbGl6ZSByZWdpc3RlckNvbnRleHQKICB0aGlzLnJlZ2lzdGVyQ29udGV4dCA9IG5ldyBTSVAuUmVnaXN0ZXJDb250ZXh0KHRoaXMpOwogIHRoaXMucmVnaXN0ZXJDb250ZXh0Lm9uKCdmYWlsZWQnLCBzZWxmRW1pdCgncmVnaXN0cmF0aW9uRmFpbGVkJykpOwogIHRoaXMucmVnaXN0ZXJDb250ZXh0Lm9uKCdyZWdpc3RlcmVkJywgc2VsZkVtaXQoJ3JlZ2lzdGVyZWQnKSk7CiAgdGhpcy5yZWdpc3RlckNvbnRleHQub24oJ3VucmVnaXN0ZXJlZCcsIHNlbGZFbWl0KCd1bnJlZ2lzdGVyZWQnKSk7CgogIGlmKHRoaXMuY29uZmlndXJhdGlvbi5hdXRvc3RhcnQpIHsKICAgIHRoaXMuc3RhcnQoKTsKICB9CgogIGlmICh0eXBlb2YgZW52aXJvbm1lbnQuYWRkRXZlbnRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykgewogICAgLy8gR29vZ2xlIENocm9tZSBQYWNrYWdlZCBBcHBzIGRvbid0IGFsbG93ICd1bmxvYWQnIGxpc3RlbmVyczoKICAgIC8vIHVubG9hZCBpcyBub3QgYXZhaWxhYmxlIGluIHBhY2thZ2VkIGFwcHMKICAgIGlmICghKGdsb2JhbC5jaHJvbWUgJiYgZ2xvYmFsLmNocm9tZS5hcHAgJiYgZ2xvYmFsLmNocm9tZS5hcHAucnVudGltZSkpIHsKICAgICAgZW52aXJvbm1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndW5sb2FkJywgdGhpcy5zdG9wLmJpbmQodGhpcykpOwogICAgfQogIH0KfTsKVUEucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdHlwZSk7CgovLz09PT09PT09PT09PT09PT09Ci8vICBIaWdoIExldmVsIEFQSQovLz09PT09PT09PT09PT09PT09CgpVQS5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbihvcHRpb25zKSB7CiAgdGhpcy5jb25maWd1cmF0aW9uLnJlZ2lzdGVyID0gdHJ1ZTsKICB0aGlzLnJlZ2lzdGVyQ29udGV4dC5yZWdpc3RlcihvcHRpb25zKTsKCiAgcmV0dXJuIHRoaXM7Cn07CgovKioKICogVW5yZWdpc3Rlci4KICoKICogQHBhcmFtIHtCb29sZWFufSBbYWxsXSB1bnJlZ2lzdGVyIGFsbCB1c2VyIGJpbmRpbmdzLgogKgogKi8KVUEucHJvdG90eXBlLnVucmVnaXN0ZXIgPSBmdW5jdGlvbihvcHRpb25zKSB7CiAgdGhpcy5jb25maWd1cmF0aW9uLnJlZ2lzdGVyID0gZmFsc2U7CgogIHZhciBjb250ZXh0ID0gdGhpcy5yZWdpc3RlckNvbnRleHQ7CiAgdGhpcy5hZnRlckNvbm5lY3RlZChjb250ZXh0LnVucmVnaXN0ZXIuYmluZChjb250ZXh0LCBvcHRpb25zKSk7CgogIHJldHVybiB0aGlzOwp9OwoKVUEucHJvdG90eXBlLmlzUmVnaXN0ZXJlZCA9IGZ1bmN0aW9uKCkgewogIHJldHVybiB0aGlzLnJlZ2lzdGVyQ29udGV4dC5yZWdpc3RlcmVkOwp9OwoKLyoqCiAqIENvbm5lY3Rpb24gc3RhdGUuCiAqIEBwYXJhbSB7Qm9vbGVhbn0KICovClVBLnByb3RvdHlwZS5pc0Nvbm5lY3RlZCA9IGZ1bmN0aW9uKCkgewogIHJldHVybiB0aGlzLnRyYW5zcG9ydCA/IHRoaXMudHJhbnNwb3J0LmNvbm5lY3RlZCA6IGZhbHNlOwp9OwoKVUEucHJvdG90eXBlLmFmdGVyQ29ubmVjdGVkID0gZnVuY3Rpb24gYWZ0ZXJDb25uZWN0ZWQgKGNhbGxiYWNrKSB7CiAgaWYgKHRoaXMuaXNDb25uZWN0ZWQoKSkgewogICAgY2FsbGJhY2soKTsKICB9IGVsc2UgewogICAgdGhpcy5vbmNlKCdjb25uZWN0ZWQnLCBjYWxsYmFjayk7CiAgfQp9OwoKLyoqCiAqIE1ha2UgYW4gb3V0Z29pbmcgY2FsbC4KICoKICogQHBhcmFtIHtTdHJpbmd9IHRhcmdldAogKiBAcGFyYW0ge09iamVjdH0gdmlld3MKICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLm1lZGlhXSBnZXRzIHBhc3NlZCB0byBTSVAuTWVkaWFIYW5kbGVyLmdldERlc2NyaXB0aW9uIGFzIG1lZGlhSGludAogKgogKiBAdGhyb3dzIHtUeXBlRXJyb3J9CiAqCiAqLwpVQS5wcm90b3R5cGUuaW52aXRlID0gZnVuY3Rpb24odGFyZ2V0LCBvcHRpb25zKSB7CiAgdmFyIGNvbnRleHQgPSBuZXcgU0lQLkludml0ZUNsaWVudENvbnRleHQodGhpcywgdGFyZ2V0LCBvcHRpb25zKTsKCiAgdGhpcy5hZnRlckNvbm5lY3RlZChjb250ZXh0Lmludml0ZS5iaW5kKGNvbnRleHQpKTsKICByZXR1cm4gY29udGV4dDsKfTsKClVBLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbih0YXJnZXQsIGV2ZW50LCBvcHRpb25zKSB7CiAgdmFyIHN1YiA9IG5ldyBTSVAuU3Vic2NyaXB0aW9uKHRoaXMsIHRhcmdldCwgZXZlbnQsIG9wdGlvbnMpOwoKICB0aGlzLmFmdGVyQ29ubmVjdGVkKHN1Yi5zdWJzY3JpYmUuYmluZChzdWIpKTsKICByZXR1cm4gc3ViOwp9OwoKLyoqCiAqIFNlbmQgYSBtZXNzYWdlLgogKgogKiBAcGFyYW0ge1N0cmluZ30gdGFyZ2V0CiAqIEBwYXJhbSB7U3RyaW5nfSBib2R5CiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10KICoKICogQHRocm93cyB7VHlwZUVycm9yfQogKgogKi8KVUEucHJvdG90eXBlLm1lc3NhZ2UgPSBmdW5jdGlvbih0YXJnZXQsIGJvZHksIG9wdGlvbnMpIHsKICBpZiAoYm9keSA9PT0gdW5kZWZpbmVkKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdOb3QgZW5vdWdoIGFyZ3VtZW50cycpOwogIH0KCiAgLy8gVGhlcmUgaXMgbm8gTWVzc2FnZSBtb2R1bGUsIHNvIGl0IGlzIG9rYXkgdGhhdCB0aGUgVUEgaGFuZGxlcyBkZWZhdWx0cyBoZXJlLgogIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKG9wdGlvbnMgfHwgT2JqZWN0LnByb3RvdHlwZSk7CiAgb3B0aW9ucy5jb250ZW50VHlwZSB8fCAob3B0aW9ucy5jb250ZW50VHlwZSA9ICd0ZXh0L3BsYWluJyk7CiAgb3B0aW9ucy5ib2R5ID0gYm9keTsKCiAgcmV0dXJuIHRoaXMucmVxdWVzdChTSVAuQy5NRVNTQUdFLCB0YXJnZXQsIG9wdGlvbnMpOwp9OwoKVUEucHJvdG90eXBlLnJlcXVlc3QgPSBmdW5jdGlvbiAobWV0aG9kLCB0YXJnZXQsIG9wdGlvbnMpIHsKICB2YXIgcmVxID0gbmV3IFNJUC5DbGllbnRDb250ZXh0KHRoaXMsIG1ldGhvZCwgdGFyZ2V0LCBvcHRpb25zKTsKCiAgdGhpcy5hZnRlckNvbm5lY3RlZChyZXEuc2VuZC5iaW5kKHJlcSkpOwogIHJldHVybiByZXE7Cn07CgovKioKICogR3JhY2VmdWxseSBjbG9zZS4KICoKICovClVBLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNlc3Npb24sIHN1YnNjcmlwdGlvbiwgYXBwbGljYW50LAogICAgdWEgPSB0aGlzOwoKICBmdW5jdGlvbiB0cmFuc2FjdGlvbnNMaXN0ZW5lcigpIHsKICAgIGlmICh1YS5uaXN0VHJhbnNhY3Rpb25zQ291bnQgPT09IDAgJiYgdWEubmljdFRyYW5zYWN0aW9uc0NvdW50ID09PSAwKSB7CiAgICAgICAgdWEucmVtb3ZlTGlzdGVuZXIoJ3RyYW5zYWN0aW9uRGVzdHJveWVkJywgdHJhbnNhY3Rpb25zTGlzdGVuZXIpOwogICAgICAgIHVhLnRyYW5zcG9ydC5kaXNjb25uZWN0KCk7CiAgICB9CiAgfQoKICB0aGlzLmxvZ2dlci5sb2coJ3VzZXIgcmVxdWVzdGVkIGNsb3N1cmUuLi4nKTsKCiAgaWYodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1VTRVJfQ0xPU0VEKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCdVQSBhbHJlYWR5IGNsb3NlZCcpOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvLyBDbGVhciB0cmFuc3BvcnRSZWNvdmVyeVRpbWVyCiAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50cmFuc3BvcnRSZWNvdmVyeVRpbWVyKTsKCiAgLy8gQ2xvc2UgcmVnaXN0ZXJDb250ZXh0CiAgdGhpcy5sb2dnZXIubG9nKCdjbG9zaW5nIHJlZ2lzdGVyQ29udGV4dCcpOwogIHRoaXMucmVnaXN0ZXJDb250ZXh0LmNsb3NlKCk7CgogIC8vIFJ1biAgX3Rlcm1pbmF0ZV8gb24gZXZlcnkgU2Vzc2lvbgogIGZvcihzZXNzaW9uIGluIHRoaXMuc2Vzc2lvbnMpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygnY2xvc2luZyBzZXNzaW9uICcgKyBzZXNzaW9uKTsKICAgIHRoaXMuc2Vzc2lvbnNbc2Vzc2lvbl0udGVybWluYXRlKCk7CiAgfQoKICAvL1J1biBfY2xvc2VfIG9uIGV2ZXJ5IFN1YnNjcmlwdGlvbgogIGZvcihzdWJzY3JpcHRpb24gaW4gdGhpcy5zdWJzY3JpcHRpb25zKSB7CiAgICB0aGlzLmxvZ2dlci5sb2coJ3Vuc3Vic2NyaWJpbmcgZnJvbSBzdWJzY3JpcHRpb24gJyArIHN1YnNjcmlwdGlvbik7CiAgICB0aGlzLnN1YnNjcmlwdGlvbnNbc3Vic2NyaXB0aW9uXS5jbG9zZSgpOwogIH0KCiAgLy8gUnVuICBfY2xvc2VfIG9uIGV2ZXJ5IGFwcGxpY2FudAogIGZvcihhcHBsaWNhbnQgaW4gdGhpcy5hcHBsaWNhbnRzKSB7CiAgICB0aGlzLmFwcGxpY2FudHNbYXBwbGljYW50XS5jbG9zZSgpOwogIH0KCiAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19VU0VSX0NMT1NFRDsKCiAgLyoKICAgKiBJZiB0aGUgcmVtYWluaW5nIHRyYW5zYWN0aW9ucyBhcmUgYWxsIElOVklURSB0cmFuc2FjdGlvbnMsIHRoZXJlIGlzIG5vIG5lZWQgdG8KICAgKiB3YWl0IGFueW1vcmUgYmVjYXVzZSBldmVyeSBzZXNzaW9uIGhhcyBhbHJlYWR5IGJlZW4gY2xvc2VkIGJ5IHRoaXMgbWV0aG9kLgogICAqIC0gbG9jYWxseSBvcmlnaW5hdGVkIHNlc3Npb25zIHdoZXJlIHRlcm1pbmF0ZWQgKENBTkNFTCBvciBCWUUpCiAgICogLSByZW1vdGVseSBvcmlnaW5hdGVkIHNlc3Npb25zIHdoZXJlIHJlamVjdGVkICg0WFgpIG9yIHRlcm1pbmF0ZWQgKEJZRSkKICAgKiBSZW1haW5pbmcgSU5WSVRFIHRyYW5zYWN0aW9ucyBiZWxvbmcgdGhvIHNlc3Npb25zIHRoYXQgd2hlcmUgYW5zd2VyZWQuIFRoaXMgYXJlIGluCiAgICogJ2FjY2VwdGVkJyBzdGF0ZSBkdWUgdG8gdGltZXJzICdMJyBhbmQgJ00nIGRlZmluZWQgaW4gW1JGQyA2MDI2XQogICAqLwogIGlmICh0aGlzLm5pc3RUcmFuc2FjdGlvbnNDb3VudCA9PT0gMCAmJiB0aGlzLm5pY3RUcmFuc2FjdGlvbnNDb3VudCA9PT0gMCkgewogICAgdGhpcy50cmFuc3BvcnQuZGlzY29ubmVjdCgpOwogIH0gZWxzZSB7CiAgICB0aGlzLm9uKCd0cmFuc2FjdGlvbkRlc3Ryb3llZCcsIHRyYW5zYWN0aW9uc0xpc3RlbmVyKTsKICB9CgogIHJldHVybiB0aGlzOwp9OwoKLyoqCiAqIENvbm5lY3QgdG8gdGhlIFdTIHNlcnZlciBpZiBzdGF0dXMgPSBTVEFUVVNfSU5JVC4KICogUmVzdW1lIFVBIGFmdGVyIGJlaW5nIGNsb3NlZC4KICoKICovClVBLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKCkgewogIHZhciBzZXJ2ZXI7CgogIHRoaXMubG9nZ2VyLmxvZygndXNlciByZXF1ZXN0ZWQgc3RhcnR1cC4uLicpOwogIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfSU5JVCkgewogICAgc2VydmVyID0gdGhpcy5nZXROZXh0V3NTZXJ2ZXIoKTsKICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfU1RBUlRJTkc7CiAgICBuZXcgU0lQLlRyYW5zcG9ydCh0aGlzLCBzZXJ2ZXIpOwogIH0gZWxzZSBpZih0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVVNFUl9DTE9TRUQpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygncmVzdW1pbmcnKTsKICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfUkVBRFk7CiAgICB0aGlzLnRyYW5zcG9ydC5jb25uZWN0KCk7CiAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfU1RBUlRJTkcpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygnVUEgaXMgaW4gU1RBUlRJTkcgc3RhdHVzLCBub3Qgb3BlbmluZyBuZXcgY29ubmVjdGlvbicpOwogIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1JFQURZKSB7CiAgICB0aGlzLmxvZ2dlci5sb2coJ1VBIGlzIGluIFJFQURZIHN0YXR1cywgbm90IHJlc3VtaW5nJyk7CiAgfSBlbHNlIHsKICAgIHRoaXMubG9nZ2VyLmVycm9yKCdDb25uZWN0aW9uIGlzIGRvd24uIEF1dG8tUmVjb3Zlcnkgc3lzdGVtIGlzIHRyeWluZyB0byBjb25uZWN0Jyk7CiAgfQoKICByZXR1cm4gdGhpczsKfTsKCi8qKgogKiBOb3JtYWxpemUgYSBzdHJpbmcgaW50byBhIHZhbGlkIFNJUCByZXF1ZXN0IFVSSQogKgogKiBAcGFyYW0ge1N0cmluZ30gdGFyZ2V0CiAqCiAqIEByZXR1cm5zIHtTSVAuVVJJfHVuZGVmaW5lZH0KICovClVBLnByb3RvdHlwZS5ub3JtYWxpemVUYXJnZXQgPSBmdW5jdGlvbih0YXJnZXQpIHsKICByZXR1cm4gU0lQLlV0aWxzLm5vcm1hbGl6ZVRhcmdldCh0YXJnZXQsIHRoaXMuY29uZmlndXJhdGlvbi5ob3N0cG9ydFBhcmFtcyk7Cn07CgoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vICBQcml2YXRlIChGb3IgaW50ZXJuYWwgdXNlKQovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KClVBLnByb3RvdHlwZS5zYXZlQ3JlZGVudGlhbHMgPSBmdW5jdGlvbihjcmVkZW50aWFscykgewogIHRoaXMuY2FjaGUuY3JlZGVudGlhbHNbY3JlZGVudGlhbHMucmVhbG1dID0gdGhpcy5jYWNoZS5jcmVkZW50aWFsc1tjcmVkZW50aWFscy5yZWFsbV0gfHwge307CiAgdGhpcy5jYWNoZS5jcmVkZW50aWFsc1tjcmVkZW50aWFscy5yZWFsbV1bY3JlZGVudGlhbHMudXJpXSA9IGNyZWRlbnRpYWxzOwoKICByZXR1cm4gdGhpczsKfTsKClVBLnByb3RvdHlwZS5nZXRDcmVkZW50aWFscyA9IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICB2YXIgcmVhbG0sIGNyZWRlbnRpYWxzOwoKICByZWFsbSA9IHJlcXVlc3QucnVyaS5ob3N0OwoKICBpZiAodGhpcy5jYWNoZS5jcmVkZW50aWFsc1tyZWFsbV0gJiYgdGhpcy5jYWNoZS5jcmVkZW50aWFsc1tyZWFsbV1bcmVxdWVzdC5ydXJpXSkgewogICAgY3JlZGVudGlhbHMgPSB0aGlzLmNhY2hlLmNyZWRlbnRpYWxzW3JlYWxtXVtyZXF1ZXN0LnJ1cmldOwogICAgY3JlZGVudGlhbHMubWV0aG9kID0gcmVxdWVzdC5tZXRob2Q7CiAgfQoKICByZXR1cm4gY3JlZGVudGlhbHM7Cn07CgpVQS5wcm90b3R5cGUuZ2V0TG9nZ2VyID0gZnVuY3Rpb24oY2F0ZWdvcnksIGxhYmVsKSB7CiAgcmV0dXJuIHRoaXMubG9nLmdldExvZ2dlcihjYXRlZ29yeSwgbGFiZWwpOwp9OwoKCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIEV2ZW50IEhhbmRsZXJzCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgovKioKICogVHJhbnNwb3J0IENsb3NlIGV2ZW50CiAqIEBwcml2YXRlCiAqIEBldmVudAogKiBAcGFyYW0ge1NJUC5UcmFuc3BvcnR9IHRyYW5zcG9ydC4KICovClVBLnByb3RvdHlwZS5vblRyYW5zcG9ydENsb3NlZCA9IGZ1bmN0aW9uKHRyYW5zcG9ydCkgewogIC8vIFJ1biBfb25UcmFuc3BvcnRFcnJvcl8gY2FsbGJhY2sgb24gZXZlcnkgY2xpZW50IHRyYW5zYWN0aW9uIHVzaW5nIF90cmFuc3BvcnRfCiAgdmFyIHR5cGUsIGlkeCwgbGVuZ3RoLAogICAgY2xpZW50X3RyYW5zYWN0aW9ucyA9IFsnbmljdCcsICdpY3QnLCAnbmlzdCcsICdpc3QnXTsKCiAgdHJhbnNwb3J0LnNlcnZlci5zdGF0dXMgPSBTSVAuVHJhbnNwb3J0LkMuU1RBVFVTX0RJU0NPTk5FQ1RFRDsKICB0aGlzLmxvZ2dlci5sb2coJ2Nvbm5lY3Rpb24gc3RhdGUgc2V0IHRvICcrIFNJUC5UcmFuc3BvcnQuQy5TVEFUVVNfRElTQ09OTkVDVEVEKTsKCiAgbGVuZ3RoID0gY2xpZW50X3RyYW5zYWN0aW9ucy5sZW5ndGg7CiAgZm9yICh0eXBlID0gMDsgdHlwZSA8IGxlbmd0aDsgdHlwZSsrKSB7CiAgICBmb3IoaWR4IGluIHRoaXMudHJhbnNhY3Rpb25zW2NsaWVudF90cmFuc2FjdGlvbnNbdHlwZV1dKSB7CiAgICAgIHRoaXMudHJhbnNhY3Rpb25zW2NsaWVudF90cmFuc2FjdGlvbnNbdHlwZV1dW2lkeF0ub25UcmFuc3BvcnRFcnJvcigpOwogICAgfQogIH0KCiAgLy8gQ2xvc2Ugc2Vzc2lvbnMgaWYgR1JVVSBpcyBub3QgYmVpbmcgdXNlZAogIGlmICghdGhpcy5jb250YWN0LnB1Yl9ncnV1KSB7CiAgICB0aGlzLmNsb3NlU2Vzc2lvbnNPblRyYW5zcG9ydEVycm9yKCk7CiAgfQoKfTsKCi8qKgogKiBVbnJlY292ZXJhYmxlIHRyYW5zcG9ydCBldmVudC4KICogQ29ubmVjdGlvbiByZWF0dGVtcHQgbG9naWMgaGFzIGJlZW4gZG9uZSBhbmQgZGlkbid0IHN1Y2Nlc3MuCiAqIEBwcml2YXRlCiAqIEBldmVudAogKiBAcGFyYW0ge1NJUC5UcmFuc3BvcnR9IHRyYW5zcG9ydC4KICovClVBLnByb3RvdHlwZS5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24odHJhbnNwb3J0KSB7CiAgdmFyIHNlcnZlcjsKCiAgdGhpcy5sb2dnZXIubG9nKCd0cmFuc3BvcnQgJyArIHRyYW5zcG9ydC5zZXJ2ZXIud3NfdXJpICsgJyBmYWlsZWQgfCBjb25uZWN0aW9uIHN0YXRlIHNldCB0byAnKyBTSVAuVHJhbnNwb3J0LkMuU1RBVFVTX0VSUk9SKTsKCiAgLy8gQ2xvc2Ugc2Vzc2lvbnMuCiAgLy9NYXJrIHRoaXMgdHJhbnNwb3J0IGFzICdkb3duJwogIHRyYW5zcG9ydC5zZXJ2ZXIuc3RhdHVzID0gU0lQLlRyYW5zcG9ydC5DLlNUQVRVU19FUlJPUjsKCiAgdGhpcy5lbWl0KCdkaXNjb25uZWN0ZWQnLCB7CiAgICB0cmFuc3BvcnQ6IHRyYW5zcG9ydAogIH0pOwoKICAvLyB0cnkgdGhlIG5leHQgdHJhbnNwb3J0IGlmIHRoZSBVQSBpc24ndCBjbG9zZWQKICBpZih0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVVNFUl9DTE9TRUQpIHsKICAgIHJldHVybjsKICB9CgogIHNlcnZlciA9IHRoaXMuZ2V0TmV4dFdzU2VydmVyKCk7CgogIGlmKHNlcnZlcikgewogICAgbmV3IFNJUC5UcmFuc3BvcnQodGhpcywgc2VydmVyKTsKICB9ZWxzZSB7CiAgICB0aGlzLmNsb3NlU2Vzc2lvbnNPblRyYW5zcG9ydEVycm9yKCk7CiAgICBpZiAoIXRoaXMuZXJyb3IgfHwgdGhpcy5lcnJvciAhPT0gQy5ORVRXT1JLX0VSUk9SKSB7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfTk9UX1JFQURZOwogICAgICB0aGlzLmVycm9yID0gQy5ORVRXT1JLX0VSUk9SOwogICAgfQogICAgLy8gVHJhbnNwb3J0IFJlY292ZXJ5IHByb2Nlc3MKICAgIHRoaXMucmVjb3ZlclRyYW5zcG9ydCgpOwogIH0KfTsKCi8qKgogKiBUcmFuc3BvcnQgY29ubmVjdGlvbiBldmVudC4KICogQHByaXZhdGUKICogQGV2ZW50CiAqIEBwYXJhbSB7U0lQLlRyYW5zcG9ydH0gdHJhbnNwb3J0LgogKi8KVUEucHJvdG90eXBlLm9uVHJhbnNwb3J0Q29ubmVjdGVkID0gZnVuY3Rpb24odHJhbnNwb3J0KSB7CiAgdGhpcy50cmFuc3BvcnQgPSB0cmFuc3BvcnQ7CgogIC8vIFJlc2V0IHRyYW5zcG9ydCByZWNvdmVyeSBjb3VudGVyCiAgdGhpcy50cmFuc3BvcnRSZWNvdmVyQXR0ZW1wdHMgPSAwOwoKICB0cmFuc3BvcnQuc2VydmVyLnN0YXR1cyA9IFNJUC5UcmFuc3BvcnQuQy5TVEFUVVNfUkVBRFk7CiAgdGhpcy5sb2dnZXIubG9nKCdjb25uZWN0aW9uIHN0YXRlIHNldCB0byAnKyBTSVAuVHJhbnNwb3J0LkMuU1RBVFVTX1JFQURZKTsKCiAgaWYodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1VTRVJfQ0xPU0VEKSB7CiAgICByZXR1cm47CiAgfQoKICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX1JFQURZOwogIHRoaXMuZXJyb3IgPSBudWxsOwoKICBpZih0aGlzLmNvbmZpZ3VyYXRpb24ucmVnaXN0ZXIpIHsKICAgIHRoaXMuY29uZmlndXJhdGlvbi5hdXRoZW50aWNhdGlvbkZhY3RvcnkuaW5pdGlhbGl6ZSgpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnJlZ2lzdGVyQ29udGV4dC5vblRyYW5zcG9ydENvbm5lY3RlZCgpOwogICAgfS5iaW5kKHRoaXMpKTsKICB9CgogIHRoaXMuZW1pdCgnY29ubmVjdGVkJywgewogICAgdHJhbnNwb3J0OiB0cmFuc3BvcnQKICB9KTsKfTsKCgovKioKICogVHJhbnNwb3J0IGNvbm5lY3RpbmcgZXZlbnQKICogQHByaXZhdGUKICogQHBhcmFtIHtTSVAuVHJhbnNwb3J0fSB0cmFuc3BvcnQuCiAqICNwYXJhbSB7SW50ZWdlcn0gYXR0ZW1wdHMuCiAqLwogIFVBLnByb3RvdHlwZS5vblRyYW5zcG9ydENvbm5lY3RpbmcgPSBmdW5jdGlvbih0cmFuc3BvcnQsIGF0dGVtcHRzKSB7CiAgICB0aGlzLmVtaXQoJ2Nvbm5lY3RpbmcnLCB7CiAgICAgIHRyYW5zcG9ydDogdHJhbnNwb3J0LAogICAgICBhdHRlbXB0czogYXR0ZW1wdHMKICAgIH0pOwogIH07CgoKLyoqCiAqIG5ldyBUcmFuc2FjdGlvbgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge1NJUC5UcmFuc2FjdGlvbn0gdHJhbnNhY3Rpb24uCiAqLwpVQS5wcm90b3R5cGUubmV3VHJhbnNhY3Rpb24gPSBmdW5jdGlvbih0cmFuc2FjdGlvbikgewogIHRoaXMudHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uLnR5cGVdW3RyYW5zYWN0aW9uLmlkXSA9IHRyYW5zYWN0aW9uOwogIHRoaXMuZW1pdCgnbmV3VHJhbnNhY3Rpb24nLCB7dHJhbnNhY3Rpb246IHRyYW5zYWN0aW9ufSk7Cn07CgoKLyoqCiAqIGRlc3Ryb3kgVHJhbnNhY3Rpb24KICogQHByaXZhdGUKICogQHBhcmFtIHtTSVAuVHJhbnNhY3Rpb259IHRyYW5zYWN0aW9uLgogKi8KVUEucHJvdG90eXBlLmRlc3Ryb3lUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uKHRyYW5zYWN0aW9uKSB7CiAgZGVsZXRlIHRoaXMudHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uLnR5cGVdW3RyYW5zYWN0aW9uLmlkXTsKICB0aGlzLmVtaXQoJ3RyYW5zYWN0aW9uRGVzdHJveWVkJywgewogICAgdHJhbnNhY3Rpb246IHRyYW5zYWN0aW9uCiAgfSk7Cn07CgoKLy89PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIHJlY2VpdmVSZXF1ZXN0Ci8vPT09PT09PT09PT09PT09PT09PT09PT09PQoKLyoqCiAqIFJlcXVlc3QgcmVjZXB0aW9uCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7U0lQLkluY29taW5nUmVxdWVzdH0gcmVxdWVzdC4KICovClVBLnByb3RvdHlwZS5yZWNlaXZlUmVxdWVzdCA9IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICB2YXIgZGlhbG9nLCBzZXNzaW9uLCBtZXNzYWdlLAogICAgbWV0aG9kID0gcmVxdWVzdC5tZXRob2QsCiAgICB0cmFuc2FjdGlvbiwKICAgIHJlcGxhY2VzLAogICAgcmVwbGFjZWREaWFsb2csCiAgICBzZWxmID0gdGhpczsKCiAgZnVuY3Rpb24gcnVyaU1hdGNoZXMgKHVyaSkgewogICAgcmV0dXJuIHVyaSAmJiB1cmkudXNlciA9PT0gcmVxdWVzdC5ydXJpLnVzZXI7CiAgfQoKICAvLyBDaGVjayB0aGF0IHJlcXVlc3QgVVJJIHBvaW50cyB0byB1cwogIGlmKCEocnVyaU1hdGNoZXModGhpcy5jb25maWd1cmF0aW9uLnVyaSkgfHwKICAgICAgIHJ1cmlNYXRjaGVzKHRoaXMuY29udGFjdC51cmkpIHx8CiAgICAgICBydXJpTWF0Y2hlcyh0aGlzLmNvbnRhY3QucHViX2dydXUpIHx8CiAgICAgICBydXJpTWF0Y2hlcyh0aGlzLmNvbnRhY3QudGVtcF9ncnV1KSkpIHsKICAgIHRoaXMubG9nZ2VyLndhcm4oJ1JlcXVlc3QtVVJJIGRvZXMgbm90IHBvaW50IHRvIHVzJyk7CiAgICBpZiAocmVxdWVzdC5tZXRob2QgIT09IFNJUC5DLkFDSykgewogICAgICByZXF1ZXN0LnJlcGx5X3NsKDQwNCk7CiAgICB9CiAgICByZXR1cm47CiAgfQoKICAvLyBDaGVjayByZXF1ZXN0IFVSSSBzY2hlbWUKICBpZihyZXF1ZXN0LnJ1cmkuc2NoZW1lID09PSBTSVAuQy5TSVBTKSB7CiAgICByZXF1ZXN0LnJlcGx5X3NsKDQxNik7CiAgICByZXR1cm47CiAgfQoKICAvLyBDaGVjayB0cmFuc2FjdGlvbgogIGlmKFNJUC5UcmFuc2FjdGlvbnMuY2hlY2tUcmFuc2FjdGlvbih0aGlzLCByZXF1ZXN0KSkgewogICAgcmV0dXJuOwogIH0KCiAgLyogUkZDMzI2MSAxMi4yLjIKICAgKiBSZXF1ZXN0cyB0aGF0IGRvIG5vdCBjaGFuZ2UgaW4gYW55IHdheSB0aGUgc3RhdGUgb2YgYSBkaWFsb2cgbWF5IGJlCiAgICogcmVjZWl2ZWQgd2l0aGluIGEgZGlhbG9nIChmb3IgZXhhbXBsZSwgYW4gT1BUSU9OUyByZXF1ZXN0KS4KICAgKiBUaGV5IGFyZSBwcm9jZXNzZWQgYXMgaWYgdGhleSBoYWQgYmVlbiByZWNlaXZlZCBvdXRzaWRlIHRoZSBkaWFsb2cuCiAgICovCiAgaWYobWV0aG9kID09PSBTSVAuQy5PUFRJT05TKSB7CiAgICBuZXcgU0lQLlRyYW5zYWN0aW9ucy5Ob25JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbihyZXF1ZXN0LCB0aGlzKTsKICAgIHJlcXVlc3QucmVwbHkoMjAwLCBudWxsLCBbCiAgICAgICdBbGxvdzogJysgU0lQLlVBLkMuQUxMT1dFRF9NRVRIT0RTLnRvU3RyaW5nKCksCiAgICAgICdBY2NlcHQ6ICcrIEMuQUNDRVBURURfQk9EWV9UWVBFUwogICAgXSk7CiAgfSBlbHNlIGlmIChtZXRob2QgPT09IFNJUC5DLk1FU1NBR0UpIHsKICAgIG1lc3NhZ2UgPSBuZXcgU0lQLlNlcnZlckNvbnRleHQodGhpcywgcmVxdWVzdCk7CiAgICBtZXNzYWdlLmJvZHkgPSByZXF1ZXN0LmJvZHk7CiAgICBtZXNzYWdlLmNvbnRlbnRfdHlwZSA9IHJlcXVlc3QuZ2V0SGVhZGVyKCdDb250ZW50LVR5cGUnKSB8fCAndGV4dC9wbGFpbic7CgogICAgcmVxdWVzdC5yZXBseSgyMDAsIG51bGwpOwogICAgdGhpcy5lbWl0KCdtZXNzYWdlJywgbWVzc2FnZSk7CiAgfSBlbHNlIGlmIChtZXRob2QgIT09IFNJUC5DLklOVklURSAmJgogICAgICAgICAgICAgbWV0aG9kICE9PSBTSVAuQy5BQ0spIHsKICAgIC8vIExldCB0aG9zZSBtZXRob2RzIHBhc3MgdGhyb3VnaCB0byBub3JtYWwgcHJvY2Vzc2luZyBmb3Igbm93LgogICAgdHJhbnNhY3Rpb24gPSBuZXcgU0lQLlNlcnZlckNvbnRleHQodGhpcywgcmVxdWVzdCk7CiAgfQoKICAvLyBJbml0aWFsIFJlcXVlc3QKICBpZighcmVxdWVzdC50b190YWcpIHsKICAgIHN3aXRjaChtZXRob2QpIHsKICAgICAgY2FzZSBTSVAuQy5JTlZJVEU6CiAgICAgICAgcmVwbGFjZXMgPQogICAgICAgICAgdGhpcy5jb25maWd1cmF0aW9uLnJlcGxhY2VzICE9PSBTSVAuQy5zdXBwb3J0ZWQuVU5TVVBQT1JURUQgJiYKICAgICAgICAgIHJlcXVlc3QucGFyc2VIZWFkZXIoJ3JlcGxhY2VzJyk7CgogICAgICAgIGlmIChyZXBsYWNlcykgewogICAgICAgICAgcmVwbGFjZWREaWFsb2cgPSB0aGlzLmRpYWxvZ3NbcmVwbGFjZXMuY2FsbF9pZCArIHJlcGxhY2VzLnJlcGxhY2VzX3RvX3RhZyArIHJlcGxhY2VzLnJlcGxhY2VzX2Zyb21fdGFnXTsKCiAgICAgICAgICBpZiAoIXJlcGxhY2VkRGlhbG9nKSB7CiAgICAgICAgICAgIC8vUmVwbGFjZWQgaGVhZGVyIHdpdGhvdXQgYSBtYXRjaGluZyBkaWFsb2csIHJlamVjdAogICAgICAgICAgICByZXF1ZXN0LnJlcGx5X3NsKDQ4MSwgbnVsbCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gZWxzZSBpZiAocmVwbGFjZWREaWFsb2cub3duZXIuc3RhdHVzID09PSBTSVAuU2Vzc2lvbi5DLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgICAgICAgIHJlcXVlc3QucmVwbHlfc2woNjAzLCBudWxsKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSBlbHNlIGlmIChyZXBsYWNlZERpYWxvZy5zdGF0ZSA9PT0gU0lQLkRpYWxvZy5DLlNUQVRVU19DT05GSVJNRUQgJiYgcmVwbGFjZXMuZWFybHlfb25seSkgewogICAgICAgICAgICByZXF1ZXN0LnJlcGx5X3NsKDQ4NiwgbnVsbCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZhciBpc01lZGlhU3VwcG9ydGVkID0gdGhpcy5jb25maWd1cmF0aW9uLm1lZGlhSGFuZGxlckZhY3RvcnkuaXNTdXBwb3J0ZWQ7CiAgICAgICAgaWYoIWlzTWVkaWFTdXBwb3J0ZWQgfHwgaXNNZWRpYVN1cHBvcnRlZCgpKSB7CiAgICAgICAgICBzZXNzaW9uID0gbmV3IFNJUC5JbnZpdGVTZXJ2ZXJDb250ZXh0KHRoaXMsIHJlcXVlc3QpOwogICAgICAgICAgc2Vzc2lvbi5yZXBsYWNlZSA9IHJlcGxhY2VkRGlhbG9nICYmIHJlcGxhY2VkRGlhbG9nLm93bmVyOwogICAgICAgICAgc2Vzc2lvbi5vbignaW52aXRlJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHNlbGYuZW1pdCgnaW52aXRlJywgdGhpcyk7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5sb2dnZXIud2FybignSU5WSVRFIHJlY2VpdmVkIGJ1dCBXZWJSVEMgaXMgbm90IHN1cHBvcnRlZCcpOwogICAgICAgICAgcmVxdWVzdC5yZXBseSg0ODgpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBTSVAuQy5CWUU6CiAgICAgICAgLy8gT3V0IG9mIGRpYWxvZyBCWUUgcmVjZWl2ZWQKICAgICAgICByZXF1ZXN0LnJlcGx5KDQ4MSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgU0lQLkMuQ0FOQ0VMOgogICAgICAgIHNlc3Npb24gPSB0aGlzLmZpbmRTZXNzaW9uKHJlcXVlc3QpOwogICAgICAgIGlmKHNlc3Npb24pIHsKICAgICAgICAgIHNlc3Npb24ucmVjZWl2ZVJlcXVlc3QocmVxdWVzdCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ3JlY2VpdmVkIENBTkNFTCByZXF1ZXN0IGZvciBhIG5vbiBleGlzdGVudCBzZXNzaW9uJyk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIFNJUC5DLkFDSzoKICAgICAgICAvKiBBYnNvcmIgaXQuCiAgICAgICAgICogQUNLIHJlcXVlc3Qgd2l0aG91dCBhIGNvcnJlc3BvbmRpbmcgSW52aXRlIFRyYW5zYWN0aW9uCiAgICAgICAgICogYW5kIHdpdGhvdXQgVG8gdGFnLgogICAgICAgICAqLwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIHJlcXVlc3QucmVwbHkoNDA1KTsKICAgICAgICBicmVhazsKICAgIH0KICB9CiAgLy8gSW4tZGlhbG9nIHJlcXVlc3QKICBlbHNlIHsKICAgIGRpYWxvZyA9IHRoaXMuZmluZERpYWxvZyhyZXF1ZXN0KTsKCiAgICBpZihkaWFsb2cpIHsKICAgICAgaWYgKG1ldGhvZCA9PT0gU0lQLkMuSU5WSVRFKSB7CiAgICAgICAgbmV3IFNJUC5UcmFuc2FjdGlvbnMuSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ocmVxdWVzdCwgdGhpcyk7CiAgICAgIH0KICAgICAgZGlhbG9nLnJlY2VpdmVSZXF1ZXN0KHJlcXVlc3QpOwogICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFNJUC5DLk5PVElGWSkgewogICAgICBzZXNzaW9uID0gdGhpcy5maW5kU2Vzc2lvbihyZXF1ZXN0KTsKICAgICAgaWYoc2Vzc2lvbikgewogICAgICAgIHNlc3Npb24ucmVjZWl2ZVJlcXVlc3QocmVxdWVzdCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5sb2dnZXIud2FybigncmVjZWl2ZWQgTk9USUZZIHJlcXVlc3QgZm9yIGEgbm9uIGV4aXN0ZW50IHNlc3Npb24nKTsKICAgICAgICByZXF1ZXN0LnJlcGx5KDQ4MSwgJ1N1YnNjcmlwdGlvbiBkb2VzIG5vdCBleGlzdCcpOwogICAgICB9CiAgICB9CiAgICAvKiBSRkMzMjYxIDEyLjIuMgogICAgICogUmVxdWVzdCB3aXRoIHRvIHRhZywgYnV0IG5vIG1hdGNoaW5nIGRpYWxvZyBmb3VuZC4KICAgICAqIEV4Y2VwdGlvbjogQUNLIGZvciBhbiBJbnZpdGUgcmVxdWVzdCBmb3Igd2hpY2ggYSBkaWFsb2cgaGFzIG5vdAogICAgICogYmVlbiBjcmVhdGVkLgogICAgICovCiAgICBlbHNlIHsKICAgICAgaWYobWV0aG9kICE9PSBTSVAuQy5BQ0spIHsKICAgICAgICByZXF1ZXN0LnJlcGx5KDQ4MSk7CiAgICAgIH0KICAgIH0KICB9Cn07CgovLz09PT09PT09PT09PT09PT09Ci8vIFV0aWxzCi8vPT09PT09PT09PT09PT09PT0KCi8qKgogKiBHZXQgdGhlIHNlc3Npb24gdG8gd2hpY2ggdGhlIHJlcXVlc3QgYmVsb25ncyB0bywgaWYgYW55LgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge1NJUC5JbmNvbWluZ1JlcXVlc3R9IHJlcXVlc3QuCiAqIEByZXR1cm5zIHtTSVAuT3V0Z29pbmdTZXNzaW9ufFNJUC5JbmNvbWluZ1Nlc3Npb258bnVsbH0KICovClVBLnByb3RvdHlwZS5maW5kU2Vzc2lvbiA9IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICByZXR1cm4gdGhpcy5zZXNzaW9uc1tyZXF1ZXN0LmNhbGxfaWQgKyByZXF1ZXN0LmZyb21fdGFnXSB8fAogICAgICAgICAgdGhpcy5zZXNzaW9uc1tyZXF1ZXN0LmNhbGxfaWQgKyByZXF1ZXN0LnRvX3RhZ10gfHwKICAgICAgICAgIG51bGw7Cn07CgovKioKICogR2V0IHRoZSBkaWFsb2cgdG8gd2hpY2ggdGhlIHJlcXVlc3QgYmVsb25ncyB0bywgaWYgYW55LgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge1NJUC5JbmNvbWluZ1JlcXVlc3R9CiAqIEByZXR1cm5zIHtTSVAuRGlhbG9nfG51bGx9CiAqLwpVQS5wcm90b3R5cGUuZmluZERpYWxvZyA9IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICByZXR1cm4gdGhpcy5kaWFsb2dzW3JlcXVlc3QuY2FsbF9pZCArIHJlcXVlc3QuZnJvbV90YWcgKyByZXF1ZXN0LnRvX3RhZ10gfHwKICAgICAgICAgIHRoaXMuZGlhbG9nc1tyZXF1ZXN0LmNhbGxfaWQgKyByZXF1ZXN0LnRvX3RhZyArIHJlcXVlc3QuZnJvbV90YWddIHx8CiAgICAgICAgICBudWxsOwp9OwoKLyoqCiAqIFJldHJpZXZlIHRoZSBuZXh0IHNlcnZlciB0byB3aGljaCBjb25uZWN0LgogKiBAcHJpdmF0ZQogKiBAcmV0dXJucyB7T2JqZWN0fSB3c19zZXJ2ZXIKICovClVBLnByb3RvdHlwZS5nZXROZXh0V3NTZXJ2ZXIgPSBmdW5jdGlvbigpIHsKICAvLyBPcmRlciBzZXJ2ZXJzIGJ5IHdlaWdodAogIHZhciBpZHgsIGxlbmd0aCwgd3Nfc2VydmVyLAogICAgY2FuZGlkYXRlcyA9IFtdOwoKICBsZW5ndGggPSB0aGlzLmNvbmZpZ3VyYXRpb24ud3NTZXJ2ZXJzLmxlbmd0aDsKICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgIHdzX3NlcnZlciA9IHRoaXMuY29uZmlndXJhdGlvbi53c1NlcnZlcnNbaWR4XTsKCiAgICBpZiAod3Nfc2VydmVyLnN0YXR1cyA9PT0gU0lQLlRyYW5zcG9ydC5DLlNUQVRVU19FUlJPUikgewogICAgICBjb250aW51ZTsKICAgIH0gZWxzZSBpZiAoY2FuZGlkYXRlcy5sZW5ndGggPT09IDApIHsKICAgICAgY2FuZGlkYXRlcy5wdXNoKHdzX3NlcnZlcik7CiAgICB9IGVsc2UgaWYgKHdzX3NlcnZlci53ZWlnaHQgPiBjYW5kaWRhdGVzWzBdLndlaWdodCkgewogICAgICBjYW5kaWRhdGVzID0gW3dzX3NlcnZlcl07CiAgICB9IGVsc2UgaWYgKHdzX3NlcnZlci53ZWlnaHQgPT09IGNhbmRpZGF0ZXNbMF0ud2VpZ2h0KSB7CiAgICAgIGNhbmRpZGF0ZXMucHVzaCh3c19zZXJ2ZXIpOwogICAgfQogIH0KCiAgaWR4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2FuZGlkYXRlcy5sZW5ndGgpOwoKICByZXR1cm4gY2FuZGlkYXRlc1tpZHhdOwp9OwoKLyoqCiAqIENsb3NlIGFsbCBzZXNzaW9ucyBvbiB0cmFuc3BvcnQgZXJyb3IuCiAqIEBwcml2YXRlCiAqLwpVQS5wcm90b3R5cGUuY2xvc2VTZXNzaW9uc09uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICB2YXIgaWR4OwoKICAvLyBSdW4gX3RyYW5zcG9ydEVycm9yXyBmb3IgZXZlcnkgU2Vzc2lvbgogIGZvcihpZHggaW4gdGhpcy5zZXNzaW9ucykgewogICAgdGhpcy5zZXNzaW9uc1tpZHhdLm9uVHJhbnNwb3J0RXJyb3IoKTsKICB9CiAgLy8gQ2FsbCByZWdpc3RlckNvbnRleHQgX29uVHJhbnNwb3J0Q2xvc2VkXwogIHRoaXMucmVnaXN0ZXJDb250ZXh0Lm9uVHJhbnNwb3J0Q2xvc2VkKCk7Cn07CgpVQS5wcm90b3R5cGUucmVjb3ZlclRyYW5zcG9ydCA9IGZ1bmN0aW9uKHVhKSB7CiAgdmFyIGlkeCwgbGVuZ3RoLCBrLCBuZXh0UmV0cnksIGNvdW50LCBzZXJ2ZXI7CgogIHVhID0gdWEgfHwgdGhpczsKICBjb3VudCA9IHVhLnRyYW5zcG9ydFJlY292ZXJBdHRlbXB0czsKCiAgbGVuZ3RoID0gdWEuY29uZmlndXJhdGlvbi53c1NlcnZlcnMubGVuZ3RoOwogIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgdWEuY29uZmlndXJhdGlvbi53c1NlcnZlcnNbaWR4XS5zdGF0dXMgPSAwOwogIH0KCiAgc2VydmVyID0gdWEuZ2V0TmV4dFdzU2VydmVyKCk7CgogIGsgPSBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpICogTWF0aC5wb3coMixjb3VudCkpICsxKTsKICBuZXh0UmV0cnkgPSBrICogdWEuY29uZmlndXJhdGlvbi5jb25uZWN0aW9uUmVjb3ZlcnlNaW5JbnRlcnZhbDsKCiAgaWYgKG5leHRSZXRyeSA+IHVhLmNvbmZpZ3VyYXRpb24uY29ubmVjdGlvblJlY292ZXJ5TWF4SW50ZXJ2YWwpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygndGltZSBmb3IgbmV4dCBjb25uZWN0aW9uIGF0dGVtcHQgZXhjZWVkcyBjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbCwgcmVzZXR0aW5nIGNvdW50ZXInKTsKICAgIG5leHRSZXRyeSA9IHVhLmNvbmZpZ3VyYXRpb24uY29ubmVjdGlvblJlY292ZXJ5TWluSW50ZXJ2YWw7CiAgICBjb3VudCA9IDA7CiAgfQoKICB0aGlzLmxvZ2dlci5sb2coJ25leHQgY29ubmVjdGlvbiBhdHRlbXB0IGluICcrIG5leHRSZXRyeSArJyBzZWNvbmRzJyk7CgogIHRoaXMudHJhbnNwb3J0UmVjb3ZlcnlUaW1lciA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCgKICAgIGZ1bmN0aW9uKCl7CiAgICAgIHVhLnRyYW5zcG9ydFJlY292ZXJBdHRlbXB0cyA9IGNvdW50ICsgMTsKICAgICAgbmV3IFNJUC5UcmFuc3BvcnQodWEsIHNlcnZlcik7CiAgICB9LCBuZXh0UmV0cnkgKiAxMDAwKTsKfTsKCmZ1bmN0aW9uIGNoZWNrQXV0aGVudGljYXRpb25GYWN0b3J5IChhdXRoZW50aWNhdGlvbkZhY3RvcnkpIHsKICBpZiAoIShhdXRoZW50aWNhdGlvbkZhY3RvcnkgaW5zdGFuY2VvZiBGdW5jdGlvbikpIHsKICAgIHJldHVybjsKICB9CiAgaWYgKCFhdXRoZW50aWNhdGlvbkZhY3RvcnkuaW5pdGlhbGl6ZSkgewogICAgYXV0aGVudGljYXRpb25GYWN0b3J5LmluaXRpYWxpemUgPSBmdW5jdGlvbiBpbml0aWFsaXplICgpIHsKICAgICAgcmV0dXJuIFNJUC5VdGlscy5Qcm9taXNlLnJlc29sdmUoKTsKICAgIH07CiAgfQogIHJldHVybiBhdXRoZW50aWNhdGlvbkZhY3Rvcnk7Cn0KCi8qKgogKiBDb25maWd1cmF0aW9uIGxvYWQuCiAqIEBwcml2YXRlCiAqIHJldHVybnMge0Jvb2xlYW59CiAqLwpVQS5wcm90b3R5cGUubG9hZENvbmZpZyA9IGZ1bmN0aW9uKGNvbmZpZ3VyYXRpb24pIHsKICAvLyBTZXR0aW5ncyBhbmQgZGVmYXVsdCB2YWx1ZXMKICB2YXIgcGFyYW1ldGVyLCB2YWx1ZSwgY2hlY2tlZF92YWx1ZSwgaG9zdHBvcnRQYXJhbXMsIHJlZ2lzdHJhclNlcnZlciwKICAgIHNldHRpbmdzID0gewogICAgICAvKiBIb3N0IGFkZHJlc3MKICAgICAgKiBWYWx1ZSB0byBiZSBzZXQgaW4gVmlhIHNlbnRfYnkgYW5kIGhvc3QgcGFydCBvZiBDb250YWN0IEZRRE4KICAgICAgKi8KICAgICAgdmlhSG9zdDogU0lQLlV0aWxzLmNyZWF0ZVJhbmRvbVRva2VuKDEyKSArICcuaW52YWxpZCcsCgogICAgICB1cmk6IG5ldyBTSVAuVVJJKCdzaXAnLCAnYW5vbnltb3VzLicgKyBTSVAuVXRpbHMuY3JlYXRlUmFuZG9tVG9rZW4oNiksICdhbm9ueW1vdXMuaW52YWxpZCcsIG51bGwsIG51bGwpLAogICAgICB3c1NlcnZlcnM6IFt7CiAgICAgICAgc2NoZW1lOiAnV1NTJywKICAgICAgICBzaXBfdXJpOiAnPHNpcDplZGdlLnNpcC5vbnNpcC5jb207dHJhbnNwb3J0PXdzO2xyPicsCiAgICAgICAgc3RhdHVzOiAwLAogICAgICAgIHdlaWdodDogMCwKICAgICAgICB3c191cmk6ICd3c3M6Ly9lZGdlLnNpcC5vbnNpcC5jb20nCiAgICAgIH1dLAoKICAgICAgLy8gUGFzc3dvcmQKICAgICAgcGFzc3dvcmQ6IG51bGwsCgogICAgICAvLyBSZWdpc3RyYXRpb24gcGFyYW1ldGVycwogICAgICByZWdpc3RlckV4cGlyZXM6IDYwMCwKICAgICAgcmVnaXN0ZXI6IHRydWUsCiAgICAgIHJlZ2lzdHJhclNlcnZlcjogbnVsbCwKCiAgICAgIC8vIFRyYW5zcG9ydCByZWxhdGVkIHBhcmFtZXRlcnMKICAgICAgd3NTZXJ2ZXJNYXhSZWNvbm5lY3Rpb246IDMsCiAgICAgIHdzU2VydmVyUmVjb25uZWN0aW9uVGltZW91dDogNCwKCiAgICAgIGNvbm5lY3Rpb25SZWNvdmVyeU1pbkludGVydmFsOiAyLAogICAgICBjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbDogMzAsCgogICAgICBrZWVwQWxpdmVJbnRlcnZhbDogMCwKCiAgICAgIGV4dHJhU3VwcG9ydGVkOiBbXSwKCiAgICAgIHVzZVByZWxvYWRlZFJvdXRlOiBmYWxzZSwKCiAgICAgIC8vc3RyaW5nIHRvIGJlIGluc2VydGVkIGludG8gVXNlci1BZ2VudCByZXF1ZXN0IGhlYWRlcgogICAgICB1c2VyQWdlbnRTdHJpbmc6IFNJUC5DLlVTRVJfQUdFTlQsCgogICAgICAvLyBTZXNzaW9uIHBhcmFtZXRlcnMKICAgICAgaWNlQ2hlY2tpbmdUaW1lb3V0OiA1MDAwLAogICAgICBub0Fuc3dlclRpbWVvdXQ6IDYwLAogICAgICBzdHVuU2VydmVyczogWydzdHVuOnN0dW4ubC5nb29nbGUuY29tOjE5MzAyJ10sCiAgICAgIHR1cm5TZXJ2ZXJzOiBbXSwKCiAgICAgIC8vIExvZ2dpbmcgcGFyYW1ldGVycwogICAgICB0cmFjZVNpcDogZmFsc2UsCgogICAgICAvLyBIYWNrcwogICAgICBoYWNrVmlhVGNwOiBmYWxzZSwKICAgICAgaGFja0lwSW5Db250YWN0OiBmYWxzZSwKICAgICAgaGFja1dzc0luVHJhbnNwb3J0OiBmYWxzZSwKICAgICAgaGFja0FsbG93VW5yZWdpc3RlcmVkT3B0aW9uVGFnczogZmFsc2UsCgogICAgICBjb250YWN0VHJhbnNwb3J0OiAnd3MnLAogICAgICBmb3JjZVJwb3J0OiBmYWxzZSwKCiAgICAgIC8vYXV0b3N0YXJ0aW5nCiAgICAgIGF1dG9zdGFydDogdHJ1ZSwKCiAgICAgIC8vUmVsaWFibGUgUHJvdmlzaW9uYWwgUmVzcG9uc2VzCiAgICAgIHJlbDEwMDogU0lQLkMuc3VwcG9ydGVkLlVOU1VQUE9SVEVELAoKICAgICAgLy8gUmVwbGFjZXMgaGVhZGVyIChSRkMgMzg5MSkKICAgICAgLy8gaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzg5MQogICAgICByZXBsYWNlczogU0lQLkMuc3VwcG9ydGVkLlVOU1VQUE9SVEVELAoKICAgICAgbWVkaWFIYW5kbGVyRmFjdG9yeTogU0lQLldlYlJUQy5NZWRpYUhhbmRsZXIuZGVmYXVsdEZhY3RvcnksCgogICAgICBhdXRoZW50aWNhdGlvbkZhY3Rvcnk6IGNoZWNrQXV0aGVudGljYXRpb25GYWN0b3J5KGZ1bmN0aW9uIGF1dGhlbnRpY2F0aW9uRmFjdG9yeSAodWEpIHsKICAgICAgICByZXR1cm4gbmV3IFNJUC5EaWdlc3RBdXRoZW50aWNhdGlvbih1YSk7CiAgICAgIH0pCiAgICB9OwoKICAvLyBQcmUtQ29uZmlndXJhdGlvbgogIGZ1bmN0aW9uIGFsaWFzVW5kZXJzY29yZWQgKHBhcmFtZXRlciwgbG9nZ2VyKSB7CiAgICB2YXIgdW5kZXJzY29yZWQgPSBwYXJhbWV0ZXIucmVwbGFjZSgvKFthLXpdW0EtWl0pL2csIGZ1bmN0aW9uIChtKSB7CiAgICAgIHJldHVybiBtWzBdICsgJ18nICsgbVsxXS50b0xvd2VyQ2FzZSgpOwogICAgfSk7CgogICAgaWYgKHBhcmFtZXRlciA9PT0gdW5kZXJzY29yZWQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBoYXNQYXJhbWV0ZXIgPSBjb25maWd1cmF0aW9uLmhhc093blByb3BlcnR5KHBhcmFtZXRlcik7CiAgICBpZiAoY29uZmlndXJhdGlvbi5oYXNPd25Qcm9wZXJ0eSh1bmRlcnNjb3JlZCkpIHsKICAgICAgbG9nZ2VyLndhcm4odW5kZXJzY29yZWQgKyAnIGlzIGRlcHJlY2F0ZWQsIHBsZWFzZSB1c2UgJyArIHBhcmFtZXRlcik7CiAgICAgIGlmIChoYXNQYXJhbWV0ZXIpIHsKICAgICAgICBsb2dnZXIud2FybihwYXJhbWV0ZXIgKyAnIG92ZXJyaWRpbmcgJyArIHVuZGVyc2NvcmVkKTsKICAgICAgfQogICAgfQoKICAgIGNvbmZpZ3VyYXRpb25bcGFyYW1ldGVyXSA9IGhhc1BhcmFtZXRlciA/IGNvbmZpZ3VyYXRpb25bcGFyYW1ldGVyXSA6IGNvbmZpZ3VyYXRpb25bdW5kZXJzY29yZWRdOwogIH0KCiAgLy8gQ2hlY2sgTWFuZGF0b3J5IHBhcmFtZXRlcnMKICBmb3IocGFyYW1ldGVyIGluIFVBLmNvbmZpZ3VyYXRpb25fY2hlY2subWFuZGF0b3J5KSB7CiAgICBhbGlhc1VuZGVyc2NvcmVkKHBhcmFtZXRlciwgdGhpcy5sb2dnZXIpOwogICAgaWYoIWNvbmZpZ3VyYXRpb24uaGFzT3duUHJvcGVydHkocGFyYW1ldGVyKSkgewogICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuQ29uZmlndXJhdGlvbkVycm9yKHBhcmFtZXRlcik7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZSA9IGNvbmZpZ3VyYXRpb25bcGFyYW1ldGVyXTsKICAgICAgY2hlY2tlZF92YWx1ZSA9IFVBLmNvbmZpZ3VyYXRpb25fY2hlY2subWFuZGF0b3J5W3BhcmFtZXRlcl0odmFsdWUpOwogICAgICBpZiAoY2hlY2tlZF92YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgc2V0dGluZ3NbcGFyYW1ldGVyXSA9IGNoZWNrZWRfdmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkNvbmZpZ3VyYXRpb25FcnJvcihwYXJhbWV0ZXIsIHZhbHVlKTsKICAgICAgfQogICAgfQogIH0KCiAgU0lQLlV0aWxzLm9wdGlvbnNPdmVycmlkZShjb25maWd1cmF0aW9uLCAncmVsMTAwJywgJ3JlbGlhYmxlJywgdHJ1ZSwgdGhpcy5sb2dnZXIsIFNJUC5DLnN1cHBvcnRlZC5VTlNVUFBPUlRFRCk7CgogIHZhciBlbXB0eUFycmF5c0FsbG93ZWQgPSBbJ3N0dW5TZXJ2ZXJzJywgJ3R1cm5TZXJ2ZXJzJ107CgogIC8vIENoZWNrIE9wdGlvbmFsIHBhcmFtZXRlcnMKICBmb3IocGFyYW1ldGVyIGluIFVBLmNvbmZpZ3VyYXRpb25fY2hlY2sub3B0aW9uYWwpIHsKICAgIGFsaWFzVW5kZXJzY29yZWQocGFyYW1ldGVyLCB0aGlzLmxvZ2dlcik7CiAgICBpZihjb25maWd1cmF0aW9uLmhhc093blByb3BlcnR5KHBhcmFtZXRlcikpIHsKICAgICAgdmFsdWUgPSBjb25maWd1cmF0aW9uW3BhcmFtZXRlcl07CgogICAgICAvLyBJZiB0aGUgcGFyYW1ldGVyIHZhbHVlIGlzIGFuIGVtcHR5IGFycmF5LCBidXQgc2hvdWxkbid0IGJlLCBhcHBseSBpdHMgZGVmYXVsdCB2YWx1ZS4KICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkgJiYgdmFsdWUubGVuZ3RoID09PSAwICYmIGVtcHR5QXJyYXlzQWxsb3dlZC5pbmRleE9mKHBhcmFtZXRlcikgPCAwKSB7IGNvbnRpbnVlOyB9CgogICAgICAvLyBJZiB0aGUgcGFyYW1ldGVyIHZhbHVlIGlzIG51bGwsIGVtcHR5IHN0cmluZywgb3IgdW5kZWZpbmVkIHRoZW4gYXBwbHkgaXRzIGRlZmF1bHQgdmFsdWUuCiAgICAgIGlmKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSAiIiB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7IGNvbnRpbnVlOyB9CiAgICAgIC8vIElmIGl0J3MgYSBudW1iZXIgd2l0aCBOYU4gdmFsdWUgdGhlbiBhbHNvIGFwcGx5IGl0cyBkZWZhdWx0IHZhbHVlLgogICAgICAvLyBOT1RFOiBKUyBkb2VzIG5vdCBhbGxvdyAidmFsdWUgPT09IE5hTiIsIHRoZSBmb2xsb3dpbmcgZG9lcyB0aGUgd29yazoKICAgICAgZWxzZSBpZih0eXBlb2YodmFsdWUpID09PSAnbnVtYmVyJyAmJiBpc05hTih2YWx1ZSkpIHsgY29udGludWU7IH0KCiAgICAgIGNoZWNrZWRfdmFsdWUgPSBVQS5jb25maWd1cmF0aW9uX2NoZWNrLm9wdGlvbmFsW3BhcmFtZXRlcl0odmFsdWUpOwogICAgICBpZiAoY2hlY2tlZF92YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgc2V0dGluZ3NbcGFyYW1ldGVyXSA9IGNoZWNrZWRfdmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkNvbmZpZ3VyYXRpb25FcnJvcihwYXJhbWV0ZXIsIHZhbHVlKTsKICAgICAgfQogICAgfQogIH0KCiAgLy8gU2FuaXR5IENoZWNrcwoKICAvLyBDb25uZWN0aW9uIHJlY292ZXJ5IGludGVydmFscwogIGlmKHNldHRpbmdzLmNvbm5lY3Rpb25SZWNvdmVyeU1heEludGVydmFsIDwgc2V0dGluZ3MuY29ubmVjdGlvblJlY292ZXJ5TWluSW50ZXJ2YWwpIHsKICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5Db25maWd1cmF0aW9uRXJyb3IoJ2Nvbm5lY3Rpb25SZWNvdmVyeU1heEludGVydmFsJywgc2V0dGluZ3MuY29ubmVjdGlvblJlY292ZXJ5TWF4SW50ZXJ2YWwpOwogIH0KCiAgLy8gUG9zdCBDb25maWd1cmF0aW9uIFByb2Nlc3MKCiAgLy8gQWxsb3cgcGFzc2luZyAwIG51bWJlciBhcyBkaXNwbGF5TmFtZS4KICBpZiAoc2V0dGluZ3MuZGlzcGxheU5hbWUgPT09IDApIHsKICAgIHNldHRpbmdzLmRpc3BsYXlOYW1lID0gJzAnOwogIH0KCiAgLy8gSW5zdGFuY2UtaWQgZm9yIEdSVVUKICBpZiAoIXNldHRpbmdzLmluc3RhbmNlSWQpIHsKICAgIHNldHRpbmdzLmluc3RhbmNlSWQgPSBTSVAuVXRpbHMubmV3VVVJRCgpOwogIH0KCiAgLy8gc2lwanNJZCBpbnN0YW5jZSBwYXJhbWV0ZXIuIFN0YXRpYyByYW5kb20gdGFnIG9mIGxlbmd0aCA1CiAgc2V0dGluZ3Muc2lwanNJZCA9IFNJUC5VdGlscy5jcmVhdGVSYW5kb21Ub2tlbig1KTsKCiAgLy8gU3RyaW5nIGNvbnRhaW5pbmcgc2V0dGluZ3MudXJpIHdpdGhvdXQgc2NoZW1lIGFuZCB1c2VyLgogIGhvc3Rwb3J0UGFyYW1zID0gc2V0dGluZ3MudXJpLmNsb25lKCk7CiAgaG9zdHBvcnRQYXJhbXMudXNlciA9IG51bGw7CiAgc2V0dGluZ3MuaG9zdHBvcnRQYXJhbXMgPSBob3N0cG9ydFBhcmFtcy50b1JhdygpLnJlcGxhY2UoL15zaXA6L2ksICcnKTsKCiAgLyogQ2hlY2sgd2hldGhlciBhdXRob3JpemF0aW9uVXNlciBpcyBleHBsaWNpdGx5IGRlZmluZWQuCiAgICogVGFrZSAnc2V0dGluZ3MudXJpLnVzZXInIHZhbHVlIGlmIG5vdC4KICAgKi8KICBpZiAoIXNldHRpbmdzLmF1dGhvcml6YXRpb25Vc2VyKSB7CiAgICBzZXR0aW5ncy5hdXRob3JpemF0aW9uVXNlciA9IHNldHRpbmdzLnVyaS51c2VyOwogIH0KCiAgLyogSWYgbm8gJ3JlZ2lzdHJhclNlcnZlcicgaXMgc2V0IHVzZSB0aGUgJ3VyaScgdmFsdWUgd2l0aG91dCB1c2VyIHBvcnRpb24uICovCiAgaWYgKCFzZXR0aW5ncy5yZWdpc3RyYXJTZXJ2ZXIpIHsKICAgIHJlZ2lzdHJhclNlcnZlciA9IHNldHRpbmdzLnVyaS5jbG9uZSgpOwogICAgcmVnaXN0cmFyU2VydmVyLnVzZXIgPSBudWxsOwogICAgc2V0dGluZ3MucmVnaXN0cmFyU2VydmVyID0gcmVnaXN0cmFyU2VydmVyOwogIH0KCiAgLy8gVXNlciBub0Fuc3dlclRpbWVvdXQKICBzZXR0aW5ncy5ub0Fuc3dlclRpbWVvdXQgPSBzZXR0aW5ncy5ub0Fuc3dlclRpbWVvdXQgKiAxMDAwOwoKICAvLyBWaWEgSG9zdAogIGlmIChzZXR0aW5ncy5oYWNrSXBJbkNvbnRhY3QpIHsKICAgIGlmICh0eXBlb2Ygc2V0dGluZ3MuaGFja0lwSW5Db250YWN0ID09PSAnYm9vbGVhbicpIHsKICAgICAgc2V0dGluZ3MudmlhSG9zdCA9IFNJUC5VdGlscy5nZXRSYW5kb21UZXN0TmV0SVAoKTsKICAgIH0KICAgIGVsc2UgaWYgKHR5cGVvZiBzZXR0aW5ncy5oYWNrSXBJbkNvbnRhY3QgPT09ICdzdHJpbmcnKSB7CiAgICAgIHNldHRpbmdzLnZpYUhvc3QgPSBzZXR0aW5ncy5oYWNrSXBJbkNvbnRhY3Q7CiAgICB9CiAgfQoKICAvLyBDb250YWN0IHRyYW5zcG9ydCBwYXJhbWV0ZXIKICBpZiAoc2V0dGluZ3MuaGFja1dzc0luVHJhbnNwb3J0KSB7CiAgICBzZXR0aW5ncy5jb250YWN0VHJhbnNwb3J0ID0gJ3dzcyc7CiAgfQoKICB0aGlzLmNvbnRhY3QgPSB7CiAgICBwdWJfZ3J1dTogbnVsbCwKICAgIHRlbXBfZ3J1dTogbnVsbCwKICAgIHVyaTogbmV3IFNJUC5VUkkoJ3NpcCcsIFNJUC5VdGlscy5jcmVhdGVSYW5kb21Ub2tlbig4KSwgc2V0dGluZ3MudmlhSG9zdCwgbnVsbCwge3RyYW5zcG9ydDogc2V0dGluZ3MuY29udGFjdFRyYW5zcG9ydH0pLAogICAgdG9TdHJpbmc6IGZ1bmN0aW9uKG9wdGlvbnMpewogICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgICAgIHZhcgogICAgICAgIGFub255bW91cyA9IG9wdGlvbnMuYW5vbnltb3VzIHx8IG51bGwsCiAgICAgICAgb3V0Ym91bmQgPSBvcHRpb25zLm91dGJvdW5kIHx8IG51bGwsCiAgICAgICAgY29udGFjdCA9ICc8JzsKCiAgICAgIGlmIChhbm9ueW1vdXMpIHsKICAgICAgICBjb250YWN0ICs9ICh0aGlzLnRlbXBfZ3J1dSB8fCAoJ3NpcDphbm9ueW1vdXNAYW5vbnltb3VzLmludmFsaWQ7dHJhbnNwb3J0PScrc2V0dGluZ3MuY29udGFjdFRyYW5zcG9ydCkpLnRvU3RyaW5nKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGFjdCArPSAodGhpcy5wdWJfZ3J1dSB8fCB0aGlzLnVyaSkudG9TdHJpbmcoKTsKICAgICAgfQoKICAgICAgaWYgKG91dGJvdW5kKSB7CiAgICAgICAgY29udGFjdCArPSAnO29iJzsKICAgICAgfQoKICAgICAgY29udGFjdCArPSAnPic7CgogICAgICByZXR1cm4gY29udGFjdDsKICAgIH0KICB9OwoKICAvLyBtZWRpYSBvdmVycmlkZXMgbWVkaWFDb25zdHJhaW50cwogIFNJUC5VdGlscy5vcHRpb25zT3ZlcnJpZGUoc2V0dGluZ3MsICdtZWRpYScsICdtZWRpYUNvbnN0cmFpbnRzJywgdHJ1ZSwgdGhpcy5sb2dnZXIpOwoKICAvLyBGaWxsIHRoZSB2YWx1ZSBvZiB0aGUgY29uZmlndXJhdGlvbl9za2VsZXRvbgogIGZvcihwYXJhbWV0ZXIgaW4gc2V0dGluZ3MpIHsKICAgIFVBLmNvbmZpZ3VyYXRpb25fc2tlbGV0b25bcGFyYW1ldGVyXS52YWx1ZSA9IHNldHRpbmdzW3BhcmFtZXRlcl07CiAgfQoKICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLmNvbmZpZ3VyYXRpb24sIFVBLmNvbmZpZ3VyYXRpb25fc2tlbGV0b24pOwoKICAvLyBDbGVhbiBVQS5jb25maWd1cmF0aW9uX3NrZWxldG9uCiAgZm9yKHBhcmFtZXRlciBpbiBzZXR0aW5ncykgewogICAgVUEuY29uZmlndXJhdGlvbl9za2VsZXRvbltwYXJhbWV0ZXJdLnZhbHVlID0gJyc7CiAgfQoKICB0aGlzLmxvZ2dlci5sb2coJ2NvbmZpZ3VyYXRpb24gcGFyYW1ldGVycyBhZnRlciB2YWxpZGF0aW9uOicpOwogIGZvcihwYXJhbWV0ZXIgaW4gc2V0dGluZ3MpIHsKICAgIHN3aXRjaChwYXJhbWV0ZXIpIHsKICAgICAgY2FzZSAndXJpJzoKICAgICAgY2FzZSAncmVnaXN0cmFyU2VydmVyJzoKICAgICAgY2FzZSAnbWVkaWFIYW5kbGVyRmFjdG9yeSc6CiAgICAgICAgdGhpcy5sb2dnZXIubG9nKCfCtyAnICsgcGFyYW1ldGVyICsgJzogJyArIHNldHRpbmdzW3BhcmFtZXRlcl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdwYXNzd29yZCc6CiAgICAgICAgdGhpcy5sb2dnZXIubG9nKCfCtyAnICsgcGFyYW1ldGVyICsgJzogJyArICdOT1QgU0hPV04nKTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ8K3ICcgKyBwYXJhbWV0ZXIgKyAnOiAnICsgSlNPTi5zdHJpbmdpZnkoc2V0dGluZ3NbcGFyYW1ldGVyXSkpOwogICAgfQogIH0KCiAgcmV0dXJuOwp9OwoKLyoqCiAqIENvbmZpZ3VyYXRpb24gT2JqZWN0IHNrZWxldG9uLgogKiBAcHJpdmF0ZQogKi8KVUEuY29uZmlndXJhdGlvbl9za2VsZXRvbiA9IChmdW5jdGlvbigpIHsKICB2YXIgaWR4LCAgcGFyYW1ldGVyLAogICAgc2tlbGV0b24gPSB7fSwKICAgIHBhcmFtZXRlcnMgPSBbCiAgICAgIC8vIEludGVybmFsIHBhcmFtZXRlcnMKICAgICAgInNpcGpzSWQiLAogICAgICAiaG9zdHBvcnRQYXJhbXMiLAoKICAgICAgLy8gT3B0aW9uYWwgdXNlciBjb25maWd1cmFibGUgcGFyYW1ldGVycwogICAgICAidXJpIiwKICAgICAgIndzU2VydmVycyIsCiAgICAgICJhdXRob3JpemF0aW9uVXNlciIsCiAgICAgICJjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbCIsCiAgICAgICJjb25uZWN0aW9uUmVjb3ZlcnlNaW5JbnRlcnZhbCIsCiAgICAgICJrZWVwQWxpdmVJbnRlcnZhbCIsCiAgICAgICJleHRyYVN1cHBvcnRlZCIsCiAgICAgICJkaXNwbGF5TmFtZSIsCiAgICAgICJoYWNrVmlhVGNwIiwgLy8gZmFsc2UuCiAgICAgICJoYWNrSXBJbkNvbnRhY3QiLCAvL2ZhbHNlCiAgICAgICJoYWNrV3NzSW5UcmFuc3BvcnQiLCAvL2ZhbHNlCiAgICAgICJoYWNrQWxsb3dVbnJlZ2lzdGVyZWRPcHRpb25UYWdzIiwgLy9mYWxzZQogICAgICAiY29udGFjdFRyYW5zcG9ydCIsIC8vICd3cycKICAgICAgImZvcmNlUnBvcnQiLCAvLyBmYWxzZQogICAgICAiaWNlQ2hlY2tpbmdUaW1lb3V0IiwKICAgICAgImluc3RhbmNlSWQiLAogICAgICAibm9BbnN3ZXJUaW1lb3V0IiwgLy8gMzAgc2Vjb25kcy4KICAgICAgInBhc3N3b3JkIiwKICAgICAgInJlZ2lzdGVyRXhwaXJlcyIsIC8vIDYwMCBzZWNvbmRzLgogICAgICAicmVnaXN0cmFyU2VydmVyIiwKICAgICAgInJlbGlhYmxlIiwKICAgICAgInJlbDEwMCIsCiAgICAgICJyZXBsYWNlcyIsCiAgICAgICJ1c2VyQWdlbnRTdHJpbmciLCAvL1NJUC5DLlVTRVJfQUdFTlQKICAgICAgImF1dG9zdGFydCIsCiAgICAgICJzdHVuU2VydmVycyIsCiAgICAgICJ0cmFjZVNpcCIsCiAgICAgICJ0dXJuU2VydmVycyIsCiAgICAgICJ1c2VQcmVsb2FkZWRSb3V0ZSIsCiAgICAgICJ3c1NlcnZlck1heFJlY29ubmVjdGlvbiIsCiAgICAgICJ3c1NlcnZlclJlY29ubmVjdGlvblRpbWVvdXQiLAogICAgICAibWVkaWFIYW5kbGVyRmFjdG9yeSIsCiAgICAgICJtZWRpYSIsCiAgICAgICJtZWRpYUNvbnN0cmFpbnRzIiwKICAgICAgImF1dGhlbnRpY2F0aW9uRmFjdG9yeSIsCgogICAgICAvLyBQb3N0LWNvbmZpZ3VyYXRpb24gZ2VuZXJhdGVkIHBhcmFtZXRlcnMKICAgICAgInZpYV9jb3JlX3ZhbHVlIiwKICAgICAgInZpYUhvc3QiCiAgICBdOwoKICBmb3IoaWR4IGluIHBhcmFtZXRlcnMpIHsKICAgIHBhcmFtZXRlciA9IHBhcmFtZXRlcnNbaWR4XTsKICAgIHNrZWxldG9uW3BhcmFtZXRlcl0gPSB7CiAgICAgIHZhbHVlOiAnJywKICAgICAgd3JpdGFibGU6IGZhbHNlLAogICAgICBjb25maWd1cmFibGU6IGZhbHNlCiAgICB9OwogIH0KCiAgc2tlbGV0b25bJ3JlZ2lzdGVyJ10gPSB7CiAgICB2YWx1ZTogJycsCiAgICB3cml0YWJsZTogdHJ1ZSwKICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UKICB9OwoKICByZXR1cm4gc2tlbGV0b247Cn0oKSk7CgovKioKICogQ29uZmlndXJhdGlvbiBjaGVja2VyLgogKiBAcHJpdmF0ZQogKiBAcmV0dXJuIHtCb29sZWFufQogKi8KVUEuY29uZmlndXJhdGlvbl9jaGVjayA9IHsKICBtYW5kYXRvcnk6IHsKICB9LAoKICBvcHRpb25hbDogewoKICAgIHVyaTogZnVuY3Rpb24odXJpKSB7CiAgICAgIHZhciBwYXJzZWQ7CgogICAgICBpZiAoISgvXnNpcDovaSkudGVzdCh1cmkpKSB7CiAgICAgICAgdXJpID0gU0lQLkMuU0lQICsgJzonICsgdXJpOwogICAgICB9CiAgICAgIHBhcnNlZCA9IFNJUC5VUkkucGFyc2UodXJpKTsKCiAgICAgIGlmKCFwYXJzZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZighcGFyc2VkLnVzZXIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHBhcnNlZDsKICAgICAgfQogICAgfSwKCiAgICAvL05vdGU6IHRoaXMgZnVuY3Rpb24gdXNlZCB0byBjYWxsICd0aGlzLmxvZ2dlci5lcnJvcicgYnV0IGNhbGxpbmcgJ3RoaXMnIHdpdGggYW55dGhpbmcgaGVyZSBpcyBpbnZhbGlkCiAgICB3c1NlcnZlcnM6IGZ1bmN0aW9uKHdzU2VydmVycykgewogICAgICB2YXIgaWR4LCBsZW5ndGgsIHVybDsKCiAgICAgIC8qIEFsbG93IGRlZmluaW5nIHdzU2VydmVycyBwYXJhbWV0ZXIgYXM6CiAgICAgICAqICBTdHJpbmc6ICJob3N0IgogICAgICAgKiAgQXJyYXkgb2YgU3RyaW5nczogWyJob3N0MSIsICJob3N0MiJdCiAgICAgICAqICBBcnJheSBvZiBPYmplY3RzOiBbe3dzX3VyaToiaG9zdDEiLCB3ZWlnaHQ6MX0sIHt3c191cmk6Imhvc3QyIiwgd2VpZ2h0OjB9XQogICAgICAgKiAgQXJyYXkgb2YgT2JqZWN0cyBhbmQgU3RyaW5nczogW3t3c191cmk6Imhvc3QxIn0sICJob3N0MiJdCiAgICAgICAqLwogICAgICBpZiAodHlwZW9mIHdzU2VydmVycyA9PT0gJ3N0cmluZycpIHsKICAgICAgICB3c1NlcnZlcnMgPSBbe3dzX3VyaTogd3NTZXJ2ZXJzfV07CiAgICAgIH0gZWxzZSBpZiAod3NTZXJ2ZXJzIGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgICBsZW5ndGggPSB3c1NlcnZlcnMubGVuZ3RoOwogICAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICAgICAgaWYgKHR5cGVvZiB3c1NlcnZlcnNbaWR4XSA9PT0gJ3N0cmluZycpewogICAgICAgICAgICB3c1NlcnZlcnNbaWR4XSA9IHt3c191cmk6IHdzU2VydmVyc1tpZHhdfTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAod3NTZXJ2ZXJzLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgbGVuZ3RoID0gd3NTZXJ2ZXJzLmxlbmd0aDsKICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgaWYgKCF3c1NlcnZlcnNbaWR4XS53c191cmkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKHdzU2VydmVyc1tpZHhdLndlaWdodCAmJiAhTnVtYmVyKHdzU2VydmVyc1tpZHhdLndlaWdodCkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHVybCA9IFNJUC5HcmFtbWFyLnBhcnNlKHdzU2VydmVyc1tpZHhdLndzX3VyaSwgJ2Fic29sdXRlVVJJJyk7CgogICAgICAgIGlmKHVybCA9PT0gLTEpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgaWYoWyd3c3MnLCAnd3MnLCAndWRwJ10uaW5kZXhPZih1cmwuc2NoZW1lKSA8IDApIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgd3NTZXJ2ZXJzW2lkeF0uc2lwX3VyaSA9ICc8c2lwOicgKyB1cmwuaG9zdCArICh1cmwucG9ydCA/ICc6JyArIHVybC5wb3J0IDogJycpICsgJzt0cmFuc3BvcnQ9JyArIHVybC5zY2hlbWUucmVwbGFjZSgvXndzcyQvaSwgJ3dzJykgKyAnO2xyPic7CgogICAgICAgICAgaWYgKCF3c1NlcnZlcnNbaWR4XS53ZWlnaHQpIHsKICAgICAgICAgICAgd3NTZXJ2ZXJzW2lkeF0ud2VpZ2h0ID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICB3c1NlcnZlcnNbaWR4XS5zdGF0dXMgPSAwOwogICAgICAgICAgd3NTZXJ2ZXJzW2lkeF0uc2NoZW1lID0gdXJsLnNjaGVtZS50b1VwcGVyQ2FzZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gd3NTZXJ2ZXJzOwogICAgfSwKCiAgICBhdXRob3JpemF0aW9uVXNlcjogZnVuY3Rpb24oYXV0aG9yaXphdGlvblVzZXIpIHsKICAgICAgaWYoU0lQLkdyYW1tYXIucGFyc2UoJyInKyBhdXRob3JpemF0aW9uVXNlciArJyInLCAncXVvdGVkX3N0cmluZycpID09PSAtMSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYXV0aG9yaXphdGlvblVzZXI7CiAgICAgIH0KICAgIH0sCgogICAgY29ubmVjdGlvblJlY292ZXJ5TWF4SW50ZXJ2YWw6IGZ1bmN0aW9uKGNvbm5lY3Rpb25SZWNvdmVyeU1heEludGVydmFsKSB7CiAgICAgIHZhciB2YWx1ZTsKICAgICAgaWYoU0lQLlV0aWxzLmlzRGVjaW1hbChjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbCkpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcihjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbCk7CiAgICAgICAgaWYodmFsdWUgPiAwKSB7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIGNvbm5lY3Rpb25SZWNvdmVyeU1pbkludGVydmFsOiBmdW5jdGlvbihjb25uZWN0aW9uUmVjb3ZlcnlNaW5JbnRlcnZhbCkgewogICAgICB2YXIgdmFsdWU7CiAgICAgIGlmKFNJUC5VdGlscy5pc0RlY2ltYWwoY29ubmVjdGlvblJlY292ZXJ5TWluSW50ZXJ2YWwpKSB7CiAgICAgICAgdmFsdWUgPSBOdW1iZXIoY29ubmVjdGlvblJlY292ZXJ5TWluSW50ZXJ2YWwpOwogICAgICAgIGlmKHZhbHVlID4gMCkgewogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBkaXNwbGF5TmFtZTogZnVuY3Rpb24oZGlzcGxheU5hbWUpIHsKICAgICAgaWYoU0lQLkdyYW1tYXIucGFyc2UoJyInICsgZGlzcGxheU5hbWUgKyAnIicsICdkaXNwbGF5TmFtZScpID09PSAtMSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZGlzcGxheU5hbWU7CiAgICAgIH0KICAgIH0sCgogICAgaGFja1ZpYVRjcDogZnVuY3Rpb24oaGFja1ZpYVRjcCkgewogICAgICBpZiAodHlwZW9mIGhhY2tWaWFUY3AgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiBoYWNrVmlhVGNwOwogICAgICB9CiAgICB9LAoKICAgIGhhY2tJcEluQ29udGFjdDogZnVuY3Rpb24oaGFja0lwSW5Db250YWN0KSB7CiAgICAgIGlmICh0eXBlb2YgaGFja0lwSW5Db250YWN0ID09PSAnYm9vbGVhbicpIHsKICAgICAgICByZXR1cm4gaGFja0lwSW5Db250YWN0OwogICAgICB9CiAgICAgIGVsc2UgaWYgKHR5cGVvZiBoYWNrSXBJbkNvbnRhY3QgPT09ICdzdHJpbmcnICYmIFNJUC5HcmFtbWFyLnBhcnNlKGhhY2tJcEluQ29udGFjdCwgJ2hvc3QnKSAhPT0gLTEpIHsKICAgICAgICByZXR1cm4gaGFja0lwSW5Db250YWN0OwogICAgICB9CiAgICB9LAoKICAgIGljZUNoZWNraW5nVGltZW91dDogZnVuY3Rpb24oaWNlQ2hlY2tpbmdUaW1lb3V0KSB7CiAgICAgIGlmKFNJUC5VdGlscy5pc0RlY2ltYWwoaWNlQ2hlY2tpbmdUaW1lb3V0KSkgewogICAgICAgIHJldHVybiBNYXRoLm1heCg1MDAsIGljZUNoZWNraW5nVGltZW91dCk7CiAgICAgIH0KICAgIH0sCgogICAgaGFja1dzc0luVHJhbnNwb3J0OiBmdW5jdGlvbihoYWNrV3NzSW5UcmFuc3BvcnQpIHsKICAgICAgaWYgKHR5cGVvZiBoYWNrV3NzSW5UcmFuc3BvcnQgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiBoYWNrV3NzSW5UcmFuc3BvcnQ7CiAgICAgIH0KICAgIH0sCgogICAgaGFja0FsbG93VW5yZWdpc3RlcmVkT3B0aW9uVGFnczogZnVuY3Rpb24oaGFja0FsbG93VW5yZWdpc3RlcmVkT3B0aW9uVGFncykgewogICAgICBpZiAodHlwZW9mIGhhY2tBbGxvd1VucmVnaXN0ZXJlZE9wdGlvblRhZ3MgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiBoYWNrQWxsb3dVbnJlZ2lzdGVyZWRPcHRpb25UYWdzOwogICAgICB9CiAgICB9LAoKICAgIGNvbnRhY3RUcmFuc3BvcnQ6IGZ1bmN0aW9uKGNvbnRhY3RUcmFuc3BvcnQpIHsKICAgICAgaWYgKHR5cGVvZiBjb250YWN0VHJhbnNwb3J0ID09PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybiBjb250YWN0VHJhbnNwb3J0OwogICAgICB9CiAgICB9LAoKICAgIGZvcmNlUnBvcnQ6IGZ1bmN0aW9uKGZvcmNlUnBvcnQpIHsKICAgICAgaWYgKHR5cGVvZiBmb3JjZVJwb3J0ID09PSAnYm9vbGVhbicpIHsKICAgICAgICByZXR1cm4gZm9yY2VScG9ydDsKICAgICAgfQogICAgfSwKCiAgICBpbnN0YW5jZUlkOiBmdW5jdGlvbihpbnN0YW5jZUlkKSB7CiAgICAgIGlmKHR5cGVvZiBpbnN0YW5jZUlkICE9PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCgvXnV1aWQ6L2kudGVzdChpbnN0YW5jZUlkKSkpIHsKICAgICAgICBpbnN0YW5jZUlkID0gaW5zdGFuY2VJZC5zdWJzdHIoNSk7CiAgICAgIH0KCiAgICAgIGlmKFNJUC5HcmFtbWFyLnBhcnNlKGluc3RhbmNlSWQsICd1dWlkJykgPT09IC0xKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBpbnN0YW5jZUlkOwogICAgICB9CiAgICB9LAoKICAgIGtlZXBBbGl2ZUludGVydmFsOiBmdW5jdGlvbihrZWVwQWxpdmVJbnRlcnZhbCkgewogICAgICB2YXIgdmFsdWU7CiAgICAgIGlmIChTSVAuVXRpbHMuaXNEZWNpbWFsKGtlZXBBbGl2ZUludGVydmFsKSkgewogICAgICAgIHZhbHVlID0gTnVtYmVyKGtlZXBBbGl2ZUludGVydmFsKTsKICAgICAgICBpZiAodmFsdWUgPiAwKSB7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIGV4dHJhU3VwcG9ydGVkOiBmdW5jdGlvbihvcHRpb25UYWdzKSB7CiAgICAgIHZhciBpZHgsIGxlbmd0aDsKCiAgICAgIGlmICghKG9wdGlvblRhZ3MgaW5zdGFuY2VvZiBBcnJheSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGxlbmd0aCA9IG9wdGlvblRhZ3MubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBpZiAodHlwZW9mIG9wdGlvblRhZ3NbaWR4XSAhPT0gJ3N0cmluZycpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBvcHRpb25UYWdzOwogICAgfSwKCiAgICBub0Fuc3dlclRpbWVvdXQ6IGZ1bmN0aW9uKG5vQW5zd2VyVGltZW91dCkgewogICAgICB2YXIgdmFsdWU7CiAgICAgIGlmIChTSVAuVXRpbHMuaXNEZWNpbWFsKG5vQW5zd2VyVGltZW91dCkpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcihub0Fuc3dlclRpbWVvdXQpOwogICAgICAgIGlmICh2YWx1ZSA+IDApIHsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgcGFzc3dvcmQ6IGZ1bmN0aW9uKHBhc3N3b3JkKSB7CiAgICAgIHJldHVybiBTdHJpbmcocGFzc3dvcmQpOwogICAgfSwKCiAgICByZWwxMDA6IGZ1bmN0aW9uKHJlbDEwMCkgewogICAgICBpZihyZWwxMDAgPT09IFNJUC5DLnN1cHBvcnRlZC5SRVFVSVJFRCkgewogICAgICAgIHJldHVybiBTSVAuQy5zdXBwb3J0ZWQuUkVRVUlSRUQ7CiAgICAgIH0gZWxzZSBpZiAocmVsMTAwID09PSBTSVAuQy5zdXBwb3J0ZWQuU1VQUE9SVEVEKSB7CiAgICAgICAgcmV0dXJuIFNJUC5DLnN1cHBvcnRlZC5TVVBQT1JURUQ7CiAgICAgIH0gZWxzZSAgewogICAgICAgIHJldHVybiBTSVAuQy5zdXBwb3J0ZWQuVU5TVVBQT1JURUQ7CiAgICAgIH0KICAgIH0sCgogICAgcmVwbGFjZXM6IGZ1bmN0aW9uKHJlcGxhY2VzKSB7CiAgICAgIGlmKHJlcGxhY2VzID09PSBTSVAuQy5zdXBwb3J0ZWQuUkVRVUlSRUQpIHsKICAgICAgICByZXR1cm4gU0lQLkMuc3VwcG9ydGVkLlJFUVVJUkVEOwogICAgICB9IGVsc2UgaWYgKHJlcGxhY2VzID09PSBTSVAuQy5zdXBwb3J0ZWQuU1VQUE9SVEVEKSB7CiAgICAgICAgcmV0dXJuIFNJUC5DLnN1cHBvcnRlZC5TVVBQT1JURUQ7CiAgICAgIH0gZWxzZSAgewogICAgICAgIHJldHVybiBTSVAuQy5zdXBwb3J0ZWQuVU5TVVBQT1JURUQ7CiAgICAgIH0KICAgIH0sCgogICAgcmVnaXN0ZXI6IGZ1bmN0aW9uKHJlZ2lzdGVyKSB7CiAgICAgIGlmICh0eXBlb2YgcmVnaXN0ZXIgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiByZWdpc3RlcjsKICAgICAgfQogICAgfSwKCiAgICByZWdpc3RlckV4cGlyZXM6IGZ1bmN0aW9uKHJlZ2lzdGVyRXhwaXJlcykgewogICAgICB2YXIgdmFsdWU7CiAgICAgIGlmIChTSVAuVXRpbHMuaXNEZWNpbWFsKHJlZ2lzdGVyRXhwaXJlcykpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcihyZWdpc3RlckV4cGlyZXMpOwogICAgICAgIGlmICh2YWx1ZSA+IDApIHsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgcmVnaXN0cmFyU2VydmVyOiBmdW5jdGlvbihyZWdpc3RyYXJTZXJ2ZXIpIHsKICAgICAgdmFyIHBhcnNlZDsKCiAgICAgIGlmKHR5cGVvZiByZWdpc3RyYXJTZXJ2ZXIgIT09ICdzdHJpbmcnKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIS9ec2lwOi9pLnRlc3QocmVnaXN0cmFyU2VydmVyKSkgewogICAgICAgIHJlZ2lzdHJhclNlcnZlciA9IFNJUC5DLlNJUCArICc6JyArIHJlZ2lzdHJhclNlcnZlcjsKICAgICAgfQogICAgICBwYXJzZWQgPSBTSVAuVVJJLnBhcnNlKHJlZ2lzdHJhclNlcnZlcik7CgogICAgICBpZighcGFyc2VkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYocGFyc2VkLnVzZXIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHBhcnNlZDsKICAgICAgfQogICAgfSwKCiAgICBzdHVuU2VydmVyczogZnVuY3Rpb24oc3R1blNlcnZlcnMpIHsKICAgICAgdmFyIGlkeCwgbGVuZ3RoLCBzdHVuX3NlcnZlcjsKCiAgICAgIGlmICh0eXBlb2Ygc3R1blNlcnZlcnMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgc3R1blNlcnZlcnMgPSBbc3R1blNlcnZlcnNdOwogICAgICB9IGVsc2UgaWYgKCEoc3R1blNlcnZlcnMgaW5zdGFuY2VvZiBBcnJheSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGxlbmd0aCA9IHN0dW5TZXJ2ZXJzLmxlbmd0aDsKICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgc3R1bl9zZXJ2ZXIgPSBzdHVuU2VydmVyc1tpZHhdOwogICAgICAgIGlmICghKC9ec3R1bnM/Oi8udGVzdChzdHVuX3NlcnZlcikpKSB7CiAgICAgICAgICBzdHVuX3NlcnZlciA9ICdzdHVuOicgKyBzdHVuX3NlcnZlcjsKICAgICAgICB9CgogICAgICAgIGlmKFNJUC5HcmFtbWFyLnBhcnNlKHN0dW5fc2VydmVyLCAnc3R1bl9VUkknKSA9PT0gLTEpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3R1blNlcnZlcnNbaWR4XSA9IHN0dW5fc2VydmVyOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gc3R1blNlcnZlcnM7CiAgICB9LAoKICAgIHRyYWNlU2lwOiBmdW5jdGlvbih0cmFjZVNpcCkgewogICAgICBpZiAodHlwZW9mIHRyYWNlU2lwID09PSAnYm9vbGVhbicpIHsKICAgICAgICByZXR1cm4gdHJhY2VTaXA7CiAgICAgIH0KICAgIH0sCgogICAgdHVyblNlcnZlcnM6IGZ1bmN0aW9uKHR1cm5TZXJ2ZXJzKSB7CiAgICAgIHZhciBpZHgsIGpkeCwgbGVuZ3RoLCB0dXJuX3NlcnZlciwgbnVtX3R1cm5fc2VydmVyX3VybHMsIHVybDsKCiAgICAgIGlmICh0dXJuU2VydmVycyBpbnN0YW5jZW9mIEFycmF5KSB7CiAgICAgICAgLy8gRG8gbm90aGluZwogICAgICB9IGVsc2UgewogICAgICAgIHR1cm5TZXJ2ZXJzID0gW3R1cm5TZXJ2ZXJzXTsKICAgICAgfQoKICAgICAgbGVuZ3RoID0gdHVyblNlcnZlcnMubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICB0dXJuX3NlcnZlciA9IHR1cm5TZXJ2ZXJzW2lkeF07CiAgICAgICAgLy9CYWNrd2FyZHMgY29tcGF0aWJpbGl0eTogQWxsb3cgZGVmaW5pbmcgdGhlIHR1cm5fc2VydmVyIHVybCB3aXRoIHRoZSAnc2VydmVyJyBwcm9wZXJ0eS4KICAgICAgICBpZiAodHVybl9zZXJ2ZXIuc2VydmVyKSB7CiAgICAgICAgICB0dXJuX3NlcnZlci51cmxzID0gW3R1cm5fc2VydmVyLnNlcnZlcl07CiAgICAgICAgfQoKICAgICAgICBpZiAoIXR1cm5fc2VydmVyLnVybHMgfHwgIXR1cm5fc2VydmVyLnVzZXJuYW1lIHx8ICF0dXJuX3NlcnZlci5wYXNzd29yZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKHR1cm5fc2VydmVyLnVybHMgaW5zdGFuY2VvZiBBcnJheSkgewogICAgICAgICAgbnVtX3R1cm5fc2VydmVyX3VybHMgPSB0dXJuX3NlcnZlci51cmxzLmxlbmd0aDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdHVybl9zZXJ2ZXIudXJscyA9IFt0dXJuX3NlcnZlci51cmxzXTsKICAgICAgICAgIG51bV90dXJuX3NlcnZlcl91cmxzID0gMTsKICAgICAgICB9CgogICAgICAgIGZvciAoamR4ID0gMDsgamR4IDwgbnVtX3R1cm5fc2VydmVyX3VybHM7IGpkeCsrKSB7CiAgICAgICAgICB1cmwgPSB0dXJuX3NlcnZlci51cmxzW2pkeF07CgogICAgICAgICAgaWYgKCEoL150dXJucz86Ly50ZXN0KHVybCkpKSB7CiAgICAgICAgICAgIHVybCA9ICd0dXJuOicgKyB1cmw7CiAgICAgICAgICB9CgogICAgICAgICAgaWYoU0lQLkdyYW1tYXIucGFyc2UodXJsLCAndHVybl9VUkknKSA9PT0gLTEpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdHVyblNlcnZlcnM7CiAgICB9LAoKICAgIHVzZXJBZ2VudFN0cmluZzogZnVuY3Rpb24odXNlckFnZW50U3RyaW5nKSB7CiAgICAgIGlmICh0eXBlb2YgdXNlckFnZW50U3RyaW5nID09PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybiB1c2VyQWdlbnRTdHJpbmc7CiAgICAgIH0KICAgIH0sCgogICAgdXNlUHJlbG9hZGVkUm91dGU6IGZ1bmN0aW9uKHVzZVByZWxvYWRlZFJvdXRlKSB7CiAgICAgIGlmICh0eXBlb2YgdXNlUHJlbG9hZGVkUm91dGUgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiB1c2VQcmVsb2FkZWRSb3V0ZTsKICAgICAgfQogICAgfSwKCiAgICB3c1NlcnZlck1heFJlY29ubmVjdGlvbjogZnVuY3Rpb24od3NTZXJ2ZXJNYXhSZWNvbm5lY3Rpb24pIHsKICAgICAgdmFyIHZhbHVlOwogICAgICBpZiAoU0lQLlV0aWxzLmlzRGVjaW1hbCh3c1NlcnZlck1heFJlY29ubmVjdGlvbikpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcih3c1NlcnZlck1heFJlY29ubmVjdGlvbik7CiAgICAgICAgaWYgKHZhbHVlID4gMCkgewogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICB3c1NlcnZlclJlY29ubmVjdGlvblRpbWVvdXQ6IGZ1bmN0aW9uKHdzU2VydmVyUmVjb25uZWN0aW9uVGltZW91dCkgewogICAgICB2YXIgdmFsdWU7CiAgICAgIGlmIChTSVAuVXRpbHMuaXNEZWNpbWFsKHdzU2VydmVyUmVjb25uZWN0aW9uVGltZW91dCkpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcih3c1NlcnZlclJlY29ubmVjdGlvblRpbWVvdXQpOwogICAgICAgIGlmICh2YWx1ZSA+IDApIHsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgYXV0b3N0YXJ0OiBmdW5jdGlvbihhdXRvc3RhcnQpIHsKICAgICAgaWYgKHR5cGVvZiBhdXRvc3RhcnQgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiBhdXRvc3RhcnQ7CiAgICAgIH0KICAgIH0sCgogICAgbWVkaWFIYW5kbGVyRmFjdG9yeTogZnVuY3Rpb24obWVkaWFIYW5kbGVyRmFjdG9yeSkgewogICAgICBpZiAobWVkaWFIYW5kbGVyRmFjdG9yeSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgICAgdmFyIHByb21pc2lmaWVkRmFjdG9yeSA9IGZ1bmN0aW9uIHByb21pc2lmaWVkRmFjdG9yeSAoKSB7CiAgICAgICAgICB2YXIgbWVkaWFIYW5kbGVyID0gbWVkaWFIYW5kbGVyRmFjdG9yeS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoKICAgICAgICAgIGZ1bmN0aW9uIHBhdGNoTWV0aG9kIChtZXRob2ROYW1lKSB7CiAgICAgICAgICAgIHZhciBtZXRob2QgPSBtZWRpYUhhbmRsZXJbbWV0aG9kTmFtZV07CiAgICAgICAgICAgIGlmIChtZXRob2QubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgIHZhciBjYWxsYmFja3NGaXJzdCA9IG1ldGhvZE5hbWUgPT09ICdnZXREZXNjcmlwdGlvbic7CiAgICAgICAgICAgICAgbWVkaWFIYW5kbGVyW21ldGhvZE5hbWVdID0gU0lQLlV0aWxzLnByb21pc2lmeShtZWRpYUhhbmRsZXIsIG1ldGhvZE5hbWUsIGNhbGxiYWNrc0ZpcnN0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHBhdGNoTWV0aG9kKCdnZXREZXNjcmlwdGlvbicpOwogICAgICAgICAgcGF0Y2hNZXRob2QoJ3NldERlc2NyaXB0aW9uJyk7CgogICAgICAgICAgcmV0dXJuIG1lZGlhSGFuZGxlcjsKICAgICAgICB9OwoKICAgICAgICBwcm9taXNpZmllZEZhY3RvcnkuaXNTdXBwb3J0ZWQgPSBtZWRpYUhhbmRsZXJGYWN0b3J5LmlzU3VwcG9ydGVkOwogICAgICAgIHJldHVybiBwcm9taXNpZmllZEZhY3Rvcnk7CiAgICAgIH0KICAgIH0sCgogICAgYXV0aGVudGljYXRpb25GYWN0b3J5OiBjaGVja0F1dGhlbnRpY2F0aW9uRmFjdG9yeQogIH0KfTsKClVBLkMgPSBDOwpTSVAuVUEgPSBVQTsKfTsKCn0pLmNhbGwodGhpcyx0eXBlb2YgZ2xvYmFsICE9PSAidW5kZWZpbmVkIiA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSAidW5kZWZpbmVkIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSAidW5kZWZpbmVkIiA/IHdpbmRvdyA6IHt9KQp9LHt9XSwzNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgU0lQIFVSSQogKi8KCi8qKgogKiBAYXVnbWVudHMgU0lQCiAqIEBjbGFzcyBDbGFzcyBjcmVhdGluZyBhIFNJUCBVUkkuCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSBbc2NoZW1lXQogKiBAcGFyYW0ge1N0cmluZ30gW3VzZXJdCiAqIEBwYXJhbSB7U3RyaW5nfSBob3N0CiAqIEBwYXJhbSB7U3RyaW5nfSBbcG9ydF0KICogQHBhcmFtIHtPYmplY3R9IFtwYXJhbWV0ZXJzXQogKiBAcGFyYW0ge09iamVjdH0gW2hlYWRlcnNdCiAqCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyIFVSSTsKClVSSSA9IGZ1bmN0aW9uKHNjaGVtZSwgdXNlciwgaG9zdCwgcG9ydCwgcGFyYW1ldGVycywgaGVhZGVycykgewogIHZhciBwYXJhbSwgaGVhZGVyLCByYXcsIG5vcm1hbDsKCiAgLy8gQ2hlY2tzCiAgaWYoIWhvc3QpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ21pc3Npbmcgb3IgaW52YWxpZCAiaG9zdCIgcGFyYW1ldGVyJyk7CiAgfQoKICAvLyBJbml0aWFsaXplIHBhcmFtZXRlcnMKICBzY2hlbWUgPSBzY2hlbWUgfHwgU0lQLkMuU0lQOwogIHRoaXMucGFyYW1ldGVycyA9IHt9OwogIHRoaXMuaGVhZGVycyA9IHt9OwoKICBmb3IgKHBhcmFtIGluIHBhcmFtZXRlcnMpIHsKICAgIHRoaXMuc2V0UGFyYW0ocGFyYW0sIHBhcmFtZXRlcnNbcGFyYW1dKTsKICB9CgogIGZvciAoaGVhZGVyIGluIGhlYWRlcnMpIHsKICAgIHRoaXMuc2V0SGVhZGVyKGhlYWRlciwgaGVhZGVyc1toZWFkZXJdKTsKICB9CgogIC8vIFJhdyBVUkkKICByYXcgPSB7CiAgICBzY2hlbWU6IHNjaGVtZSwKICAgIHVzZXI6IHVzZXIsCiAgICBob3N0OiBob3N0LAogICAgcG9ydDogcG9ydAogIH07CgogIC8vIE5vcm1hbGl6ZWQgVVJJCiAgbm9ybWFsID0gewogICAgc2NoZW1lOiBzY2hlbWUudG9Mb3dlckNhc2UoKSwKICAgIHVzZXI6IHVzZXIsCiAgICBob3N0OiBob3N0LnRvTG93ZXJDYXNlKCksCiAgICBwb3J0OiBwb3J0CiAgfTsKCiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywgewogICAgX25vcm1hbDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbm9ybWFsOyB9CiAgICB9LAoKICAgIF9yYXc6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIHJhdzsgfQogICAgfSwKCiAgICBzY2hlbWU6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG5vcm1hbC5zY2hlbWU7IH0sCiAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICByYXcuc2NoZW1lID0gdmFsdWU7CiAgICAgICAgbm9ybWFsLnNjaGVtZSA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7CiAgICAgIH0KICAgIH0sCgogICAgdXNlcjogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbm9ybWFsLnVzZXI7IH0sCiAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICBub3JtYWwudXNlciA9IHJhdy51c2VyID0gdmFsdWU7CiAgICAgIH0KICAgIH0sCgogICAgaG9zdDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbm9ybWFsLmhvc3Q7IH0sCiAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICByYXcuaG9zdCA9IHZhbHVlOwogICAgICAgIG5vcm1hbC5ob3N0ID0gdmFsdWUudG9Mb3dlckNhc2UoKTsKICAgICAgfQogICAgfSwKCiAgICBhb3I6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG5vcm1hbC51c2VyICsgJ0AnICsgbm9ybWFsLmhvc3Q7IH0KICAgIH0sCgogICAgcG9ydDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbm9ybWFsLnBvcnQ7IH0sCiAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICBub3JtYWwucG9ydCA9IHJhdy5wb3J0ID0gdmFsdWUgPT09IDAgPyB2YWx1ZSA6IChwYXJzZUludCh2YWx1ZSwxMCkgfHwgbnVsbCk7CiAgICAgIH0KICAgIH0KICB9KTsKfTsKClVSSS5wcm90b3R5cGUgPSB7CiAgc2V0UGFyYW06IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgIGlmKGtleSkgewogICAgICB0aGlzLnBhcmFtZXRlcnNba2V5LnRvTG93ZXJDYXNlKCldID0gKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgfHwgdmFsdWUgPT09IG51bGwpID8gbnVsbCA6IHZhbHVlLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKTsKICAgIH0KICB9LAoKICBnZXRQYXJhbTogZnVuY3Rpb24oa2V5KSB7CiAgICBpZihrZXkpIHsKICAgICAgcmV0dXJuIHRoaXMucGFyYW1ldGVyc1trZXkudG9Mb3dlckNhc2UoKV07CiAgICB9CiAgfSwKCiAgaGFzUGFyYW06IGZ1bmN0aW9uKGtleSkgewogICAgaWYoa2V5KSB7CiAgICAgIHJldHVybiAodGhpcy5wYXJhbWV0ZXJzLmhhc093blByb3BlcnR5KGtleS50b0xvd2VyQ2FzZSgpKSAmJiB0cnVlKSB8fCBmYWxzZTsKICAgIH0KICB9LAoKICBkZWxldGVQYXJhbTogZnVuY3Rpb24ocGFyYW1ldGVyKSB7CiAgICB2YXIgdmFsdWU7CiAgICBwYXJhbWV0ZXIgPSBwYXJhbWV0ZXIudG9Mb3dlckNhc2UoKTsKICAgIGlmICh0aGlzLnBhcmFtZXRlcnMuaGFzT3duUHJvcGVydHkocGFyYW1ldGVyKSkgewogICAgICB2YWx1ZSA9IHRoaXMucGFyYW1ldGVyc1twYXJhbWV0ZXJdOwogICAgICBkZWxldGUgdGhpcy5wYXJhbWV0ZXJzW3BhcmFtZXRlcl07CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICB9LAoKICBjbGVhclBhcmFtczogZnVuY3Rpb24oKSB7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7fTsKICB9LAoKICBzZXRIZWFkZXI6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7CiAgICB0aGlzLmhlYWRlcnNbU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKV0gPSAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkgPyB2YWx1ZSA6IFt2YWx1ZV07CiAgfSwKCiAgZ2V0SGVhZGVyOiBmdW5jdGlvbihuYW1lKSB7CiAgICBpZihuYW1lKSB7CiAgICAgIHJldHVybiB0aGlzLmhlYWRlcnNbU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKV07CiAgICB9CiAgfSwKCiAgaGFzSGVhZGVyOiBmdW5jdGlvbihuYW1lKSB7CiAgICBpZihuYW1lKSB7CiAgICAgIHJldHVybiAodGhpcy5oZWFkZXJzLmhhc093blByb3BlcnR5KFNJUC5VdGlscy5oZWFkZXJpemUobmFtZSkpICYmIHRydWUpIHx8IGZhbHNlOwogICAgfQogIH0sCgogIGRlbGV0ZUhlYWRlcjogZnVuY3Rpb24oaGVhZGVyKSB7CiAgICB2YXIgdmFsdWU7CiAgICBoZWFkZXIgPSBTSVAuVXRpbHMuaGVhZGVyaXplKGhlYWRlcik7CiAgICBpZih0aGlzLmhlYWRlcnMuaGFzT3duUHJvcGVydHkoaGVhZGVyKSkgewogICAgICB2YWx1ZSA9IHRoaXMuaGVhZGVyc1toZWFkZXJdOwogICAgICBkZWxldGUgdGhpcy5oZWFkZXJzW2hlYWRlcl07CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICB9LAoKICBjbGVhckhlYWRlcnM6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5oZWFkZXJzID0ge307CiAgfSwKCiAgY2xvbmU6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIG5ldyBVUkkoCiAgICAgIHRoaXMuX3Jhdy5zY2hlbWUsCiAgICAgIHRoaXMuX3Jhdy51c2VyLAogICAgICB0aGlzLl9yYXcuaG9zdCwKICAgICAgdGhpcy5fcmF3LnBvcnQsCiAgICAgIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5wYXJhbWV0ZXJzKSksCiAgICAgIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5oZWFkZXJzKSkpOwogIH0sCgogIHRvUmF3OiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0aGlzLl90b1N0cmluZyh0aGlzLl9yYXcpOwogIH0sCgogIHRvU3RyaW5nOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0aGlzLl90b1N0cmluZyh0aGlzLl9ub3JtYWwpOwogIH0sCgogIF90b1N0cmluZzogZnVuY3Rpb24odXJpKSB7CiAgICB2YXIgaGVhZGVyLCBwYXJhbWV0ZXIsIGlkeCwgdXJpU3RyaW5nLCBoZWFkZXJzID0gW107CgogICAgdXJpU3RyaW5nICA9IHVyaS5zY2hlbWUgKyAnOic7CiAgICAvLyBhZGQgc2xhc2hlcyBpZiBpdCdzIG5vdCBhIHNpcChzKSBVUkkKICAgIGlmICghdXJpLnNjaGVtZS50b0xvd2VyQ2FzZSgpLm1hdGNoKCJec2lwcz8kIikpIHsKICAgICAgdXJpU3RyaW5nICs9ICIvLyI7CiAgICB9CiAgICBpZiAodXJpLnVzZXIpIHsKICAgICAgdXJpU3RyaW5nICs9IFNJUC5VdGlscy5lc2NhcGVVc2VyKHVyaS51c2VyKSArICdAJzsKICAgIH0KICAgIHVyaVN0cmluZyArPSB1cmkuaG9zdDsKICAgIGlmICh1cmkucG9ydCB8fCB1cmkucG9ydCA9PT0gMCkgewogICAgICB1cmlTdHJpbmcgKz0gJzonICsgdXJpLnBvcnQ7CiAgICB9CgogICAgZm9yIChwYXJhbWV0ZXIgaW4gdGhpcy5wYXJhbWV0ZXJzKSB7CiAgICAgIHVyaVN0cmluZyArPSAnOycgKyBwYXJhbWV0ZXI7CgogICAgICBpZiAodGhpcy5wYXJhbWV0ZXJzW3BhcmFtZXRlcl0gIT09IG51bGwpIHsKICAgICAgICB1cmlTdHJpbmcgKz0gJz0nKyB0aGlzLnBhcmFtZXRlcnNbcGFyYW1ldGVyXTsKICAgICAgfQogICAgfQoKICAgIGZvcihoZWFkZXIgaW4gdGhpcy5oZWFkZXJzKSB7CiAgICAgIGZvcihpZHggaW4gdGhpcy5oZWFkZXJzW2hlYWRlcl0pIHsKICAgICAgICBoZWFkZXJzLnB1c2goaGVhZGVyICsgJz0nICsgdGhpcy5oZWFkZXJzW2hlYWRlcl1baWR4XSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoaGVhZGVycy5sZW5ndGggPiAwKSB7CiAgICAgIHVyaVN0cmluZyArPSAnPycgKyBoZWFkZXJzLmpvaW4oJyYnKTsKICAgIH0KCiAgICByZXR1cm4gdXJpU3RyaW5nOwogIH0KfTsKCgovKioKICAqIFBhcnNlIHRoZSBnaXZlbiBzdHJpbmcgYW5kIHJldHVybnMgYSBTSVAuVVJJIGluc3RhbmNlIG9yIHVuZGVmaW5lZCBpZgogICogaXQgaXMgYW4gaW52YWxpZCBVUkkuCiAgKiBAcHVibGljCiAgKiBAcGFyYW0ge1N0cmluZ30gdXJpCiAgKi8KVVJJLnBhcnNlID0gZnVuY3Rpb24odXJpKSB7CiAgdXJpID0gU0lQLkdyYW1tYXIucGFyc2UodXJpLCdTSVBfVVJJJyk7CgogIGlmICh1cmkgIT09IC0xKSB7CiAgICByZXR1cm4gdXJpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KfTsKClNJUC5VUkkgPSBVUkk7Cn07Cgp9LHt9XSwzNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgVXRpbHMKICovCgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVAsIGVudmlyb25tZW50KSB7CnZhciBVdGlsczsKClV0aWxzPSB7CgogIFByb21pc2U6IGVudmlyb25tZW50LlByb21pc2UsCgogIGRlZmVyOiBmdW5jdGlvbiBkZWZlciAoKSB7CiAgICB2YXIgZGVmZXJyZWQgPSB7fTsKICAgIGRlZmVycmVkLnByb21pc2UgPSBuZXcgVXRpbHMuUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGRlZmVycmVkLnJlc29sdmUgPSByZXNvbHZlOwogICAgICBkZWZlcnJlZC5yZWplY3QgPSByZWplY3Q7CiAgICB9KTsKICAgIHJldHVybiBkZWZlcnJlZDsKICB9LAoKICBwcm9taXNpZnk6IGZ1bmN0aW9uIHByb21pc2lmeSAob2JqZWN0LCBtZXRob2ROYW1lLCBjYWxsYmFja3NGaXJzdCkgewogICAgdmFyIG9sZE1ldGhvZCA9IG9iamVjdFttZXRob2ROYW1lXTsKICAgIHJldHVybiBmdW5jdGlvbiBwcm9taXNpZmllZE1ldGhvZCAoYXJnLCBvblN1Y2Nlc3MsIG9uRmFpbHVyZSkgewogICAgICByZXR1cm4gbmV3IFV0aWxzLlByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciBvbGRBcmdzID0gW2FyZywgcmVzb2x2ZSwgcmVqZWN0XTsKICAgICAgICBpZiAoY2FsbGJhY2tzRmlyc3QpIHsKICAgICAgICAgIG9sZEFyZ3MgPSBbcmVzb2x2ZSwgcmVqZWN0LCBhcmddOwogICAgICAgIH0KICAgICAgICBvbGRNZXRob2QuYXBwbHkob2JqZWN0LCBvbGRBcmdzKTsKICAgICAgfSkudGhlbihvblN1Y2Nlc3MsIG9uRmFpbHVyZSk7CiAgICB9OwogIH0sCgogIGF1Z21lbnQ6IGZ1bmN0aW9uIChvYmplY3QsIGNvbnN0cnVjdG9yLCBhcmdzLCBvdmVycmlkZSkgewogICAgdmFyIGlkeCwgcHJvdG87CgogICAgLy8gQWRkIHB1YmxpYyBwcm9wZXJ0aWVzIGZyb20gY29uc3RydWN0b3IncyBwcm90b3R5cGUgb250byBvYmplY3QKICAgIHByb3RvID0gY29uc3RydWN0b3IucHJvdG90eXBlOwogICAgZm9yIChpZHggaW4gcHJvdG8pIHsKICAgICAgaWYgKG92ZXJyaWRlIHx8IG9iamVjdFtpZHhdID09PSB1bmRlZmluZWQpIHsKICAgICAgICBvYmplY3RbaWR4XSA9IHByb3RvW2lkeF07CiAgICAgIH0KICAgIH0KCiAgICAvLyBDb25zdHJ1Y3QgdGhlIG9iamVjdCBhcyB0aG91Z2ggaXQgd2VyZSBqdXN0IGNyZWF0ZWQgYnkgY29uc3RydWN0b3IKICAgIGNvbnN0cnVjdG9yLmFwcGx5KG9iamVjdCwgYXJncyk7CiAgfSwKCiAgb3B0aW9uc092ZXJyaWRlOiBmdW5jdGlvbiAob3B0aW9ucywgd2lubmVyLCBsb3NlciwgaXNEZXByZWNhdGVkLCBsb2dnZXIsIGRlZmF1bHRWYWx1ZSkgewogICAgaWYgKGlzRGVwcmVjYXRlZCAmJiBvcHRpb25zW2xvc2VyXSkgewogICAgICBsb2dnZXIud2Fybihsb3NlciArICcgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHVzZSAnICsgd2lubmVyICsgJyBpbnN0ZWFkJyk7CiAgICB9CgogICAgaWYgKG9wdGlvbnNbd2lubmVyXSAmJiBvcHRpb25zW2xvc2VyXSkgewogICAgICBsb2dnZXIud2Fybih3aW5uZXIgKyAnIG92ZXJyaWRpbmcgJyArIGxvc2VyKTsKICAgIH0KCiAgICBvcHRpb25zW3dpbm5lcl0gPSBvcHRpb25zW3dpbm5lcl0gfHwgb3B0aW9uc1tsb3Nlcl0gfHwgZGVmYXVsdFZhbHVlOwogIH0sCgogIHN0cl91dGY4X2xlbmd0aDogZnVuY3Rpb24oc3RyaW5nKSB7CiAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZykucmVwbGFjZSgvJVtBLUZcZF17Mn0vZywgJ1UnKS5sZW5ndGg7CiAgfSwKCiAgZ2VuZXJhdGVGYWtlU0RQOiBmdW5jdGlvbihib2R5KSB7CiAgICBpZiAoIWJvZHkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBzdGFydCA9IGJvZHkuaW5kZXhPZignbz0nKTsKICAgIHZhciBlbmQgPSBib2R5LmluZGV4T2YoJ1xyXG4nLCBzdGFydCk7CgogICAgcmV0dXJuICd2PTBcclxuJyArIGJvZHkuc2xpY2Uoc3RhcnQsIGVuZCkgKyAnXHJcbnM9LVxyXG50PTAgMFxyXG5jPUlOIElQNCAwLjAuMC4wJzsKICB9LAoKICBpc0Z1bmN0aW9uOiBmdW5jdGlvbihmbikgewogICAgaWYgKGZuICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChmbikgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwKCiAgaXNEZWNpbWFsOiBmdW5jdGlvbiAobnVtKSB7CiAgICByZXR1cm4gIWlzTmFOKG51bSkgJiYgKHBhcnNlRmxvYXQobnVtKSA9PT0gcGFyc2VJbnQobnVtLDEwKSk7CiAgfSwKCiAgY3JlYXRlUmFuZG9tVG9rZW46IGZ1bmN0aW9uKHNpemUsIGJhc2UpIHsKICAgIHZhciBpLCByLAogICAgICB0b2tlbiA9ICcnOwoKICAgIGJhc2UgPSBiYXNlIHx8IDMyOwoKICAgIGZvciggaT0wOyBpIDwgc2l6ZTsgaSsrICkgewogICAgICByID0gTWF0aC5yYW5kb20oKSAqIGJhc2V8MDsKICAgICAgdG9rZW4gKz0gci50b1N0cmluZyhiYXNlKTsKICAgIH0KCiAgICByZXR1cm4gdG9rZW47CiAgfSwKCiAgbmV3VGFnOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiBTSVAuVXRpbHMuY3JlYXRlUmFuZG9tVG9rZW4oU0lQLlVBLkMuVEFHX0xFTkdUSCk7CiAgfSwKCiAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3VzZXJzLzEwOTUzOC9icm9vZmEKICBuZXdVVUlEOiBmdW5jdGlvbigpIHsKICAgIHZhciBVVUlEID0gICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24oYykgewogICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkqMTZ8MCwgdiA9IGMgPT09ICd4JyA/IHIgOiAociYweDN8MHg4KTsKICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpOwogICAgfSk7CgogICAgcmV0dXJuIFVVSUQ7CiAgfSwKCiAgaG9zdFR5cGU6IGZ1bmN0aW9uKGhvc3QpIHsKICAgIGlmICghaG9zdCkgewogICAgICByZXR1cm47CiAgICB9IGVsc2UgewogICAgICBob3N0ID0gU0lQLkdyYW1tYXIucGFyc2UoaG9zdCwnaG9zdCcpOwogICAgICBpZiAoaG9zdCAhPT0gLTEpIHsKICAgICAgICByZXR1cm4gaG9zdC5ob3N0X3R5cGU7CiAgICAgIH0KICAgIH0KICB9LAoKICAvKioKICAqIE5vcm1hbGl6ZSBTSVAgVVJJLgogICogTk9URTogSXQgZG9lcyBub3QgYWxsb3cgYSBTSVAgVVJJIHdpdGhvdXQgdXNlcm5hbWUuCiAgKiBBY2NlcHRzICdzaXAnLCAnc2lwcycgYW5kICd0ZWwnIFVSSXMgYW5kIGNvbnZlcnQgdGhlbSBpbnRvICdzaXAnLgogICogRGV0ZWN0cyB0aGUgZG9tYWluIHBhcnQgKGlmIGdpdmVuKSBhbmQgcHJvcGVybHkgaGV4LWVzY2FwZXMgdGhlIHVzZXIgcG9ydGlvbi4KICAqIElmIHRoZSB1c2VyIHBvcnRpb24gaGFzIG9ubHkgJ3RlbCcgbnVtYmVyIHN5bWJvbHMgdGhlIHVzZXIgcG9ydGlvbiBpcyBjbGVhbiBvZiAndGVsJyB2aXN1YWwgc2VwYXJhdG9ycy4KICAqIEBwcml2YXRlCiAgKiBAcGFyYW0ge1N0cmluZ30gdGFyZ2V0CiAgKiBAcGFyYW0ge1N0cmluZ30gW2RvbWFpbl0KICAqLwogIG5vcm1hbGl6ZVRhcmdldDogZnVuY3Rpb24odGFyZ2V0LCBkb21haW4pIHsKICAgIHZhciB1cmksIHRhcmdldF9hcnJheSwgdGFyZ2V0X3VzZXIsIHRhcmdldF9kb21haW47CgogICAgLy8gSWYgbm8gdGFyZ2V0IGlzIGdpdmVuIHRoZW4gcmFpc2UgYW4gZXJyb3IuCiAgICBpZiAoIXRhcmdldCkgewogICAgICByZXR1cm47CiAgICAvLyBJZiBhIFNJUC5VUkkgaW5zdGFuY2UgaXMgZ2l2ZW4gdGhlbiByZXR1cm4gaXQuCiAgICB9IGVsc2UgaWYgKHRhcmdldCBpbnN0YW5jZW9mIFNJUC5VUkkpIHsKICAgICAgcmV0dXJuIHRhcmdldDsKCiAgICAvLyBJZiBhIHN0cmluZyBpcyBnaXZlbiBzcGxpdCBpdCBieSAnQCc6CiAgICAvLyAtIExhc3QgZnJhZ21lbnQgaXMgdGhlIGRlc2lyZWQgZG9tYWluLgogICAgLy8gLSBPdGhlcndpc2UgYXBwZW5kIHRoZSBnaXZlbiBkb21haW4gYXJndW1lbnQuCiAgICB9IGVsc2UgaWYgKHR5cGVvZiB0YXJnZXQgPT09ICdzdHJpbmcnKSB7CiAgICAgIHRhcmdldF9hcnJheSA9IHRhcmdldC5zcGxpdCgnQCcpOwoKICAgICAgc3dpdGNoKHRhcmdldF9hcnJheS5sZW5ndGgpIHsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBpZiAoIWRvbWFpbikgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICB0YXJnZXRfdXNlciA9IHRhcmdldDsKICAgICAgICAgIHRhcmdldF9kb21haW4gPSBkb21haW47CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICB0YXJnZXRfdXNlciA9IHRhcmdldF9hcnJheVswXTsKICAgICAgICAgIHRhcmdldF9kb21haW4gPSB0YXJnZXRfYXJyYXlbMV07CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGFyZ2V0X3VzZXIgPSB0YXJnZXRfYXJyYXkuc2xpY2UoMCwgdGFyZ2V0X2FycmF5Lmxlbmd0aC0xKS5qb2luKCdAJyk7CiAgICAgICAgICB0YXJnZXRfZG9tYWluID0gdGFyZ2V0X2FycmF5W3RhcmdldF9hcnJheS5sZW5ndGgtMV07CiAgICAgIH0KCiAgICAgIC8vIFJlbW92ZSB0aGUgVVJJIHNjaGVtZSAoaWYgcHJlc2VudCkuCiAgICAgIHRhcmdldF91c2VyID0gdGFyZ2V0X3VzZXIucmVwbGFjZSgvXihzaXBzP3x0ZWwpOi9pLCAnJyk7CgogICAgICAvLyBSZW1vdmUgJ3RlbCcgdmlzdWFsIHNlcGFyYXRvcnMgaWYgdGhlIHVzZXIgcG9ydGlvbiBqdXN0IGNvbnRhaW5zICd0ZWwnIG51bWJlciBzeW1ib2xzLgogICAgICBpZiAoL15bXC1cLlwoXCldKlwrP1swLTlcLVwuXChcKV0rJC8udGVzdCh0YXJnZXRfdXNlcikpIHsKICAgICAgICB0YXJnZXRfdXNlciA9IHRhcmdldF91c2VyLnJlcGxhY2UoL1tcLVwuXChcKV0vZywgJycpOwogICAgICB9CgogICAgICAvLyBCdWlsZCB0aGUgY29tcGxldGUgU0lQIFVSSS4KICAgICAgdGFyZ2V0ID0gU0lQLkMuU0lQICsgJzonICsgU0lQLlV0aWxzLmVzY2FwZVVzZXIodGFyZ2V0X3VzZXIpICsgJ0AnICsgdGFyZ2V0X2RvbWFpbjsKCiAgICAgIC8vIEZpbmFsbHkgcGFyc2UgdGhlIHJlc3VsdGluZyBVUkkuCiAgICAgIGlmICh1cmkgPSBTSVAuVVJJLnBhcnNlKHRhcmdldCkpIHsKICAgICAgICByZXR1cm4gdXJpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuOwogICAgfQogIH0sCgogIC8qKgogICogSGV4LWVzY2FwZSBhIFNJUCBVUkkgdXNlci4KICAqIEBwcml2YXRlCiAgKiBAcGFyYW0ge1N0cmluZ30gdXNlcgogICovCiAgZXNjYXBlVXNlcjogZnVuY3Rpb24odXNlcikgewogICAgLy8gRG9uJ3QgaGV4LWVzY2FwZSAnOicgKCUzQSksICcrJyAoJTJCKSwgJz8nICglM0YiKSwgJy8nICglMkYpLgogICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChkZWNvZGVVUklDb21wb25lbnQodXNlcikpLnJlcGxhY2UoLyUzQS9pZywgJzonKS5yZXBsYWNlKC8lMkIvaWcsICcrJykucmVwbGFjZSgvJTNGL2lnLCAnPycpLnJlcGxhY2UoLyUyRi9pZywgJy8nKTsKICB9LAoKICBoZWFkZXJpemU6IGZ1bmN0aW9uKHN0cmluZykgewogICAgdmFyIGV4Y2VwdGlvbnMgPSB7CiAgICAgICdDYWxsLUlkJzogJ0NhbGwtSUQnLAogICAgICAnQ3NlcSc6ICdDU2VxJywKICAgICAgJ01pbi1TZSc6ICdNaW4tU0UnLAogICAgICAnUmFjayc6ICdSQWNrJywKICAgICAgJ1JzZXEnOiAnUlNlcScsCiAgICAgICdXd3ctQXV0aGVudGljYXRlJzogJ1dXVy1BdXRoZW50aWNhdGUnCiAgICAgIH0sCiAgICAgIG5hbWUgPSBzdHJpbmcudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9fL2csJy0nKS5zcGxpdCgnLScpLAogICAgICBobmFtZSA9ICcnLAogICAgICBwYXJ0cyA9IG5hbWUubGVuZ3RoLCBwYXJ0OwoKICAgIGZvciAocGFydCA9IDA7IHBhcnQgPCBwYXJ0czsgcGFydCsrKSB7CiAgICAgIGlmIChwYXJ0ICE9PSAwKSB7CiAgICAgICAgaG5hbWUgKz0nLSc7CiAgICAgIH0KICAgICAgaG5hbWUgKz0gbmFtZVtwYXJ0XS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStuYW1lW3BhcnRdLnN1YnN0cmluZygxKTsKICAgIH0KICAgIGlmIChleGNlcHRpb25zW2huYW1lXSkgewogICAgICBobmFtZSA9IGV4Y2VwdGlvbnNbaG5hbWVdOwogICAgfQogICAgcmV0dXJuIGhuYW1lOwogIH0sCgogIHNpcEVycm9yQ2F1c2U6IGZ1bmN0aW9uKHN0YXR1c19jb2RlKSB7CiAgICB2YXIgY2F1c2U7CgogICAgZm9yIChjYXVzZSBpbiBTSVAuQy5TSVBfRVJST1JfQ0FVU0VTKSB7CiAgICAgIGlmIChTSVAuQy5TSVBfRVJST1JfQ0FVU0VTW2NhdXNlXS5pbmRleE9mKHN0YXR1c19jb2RlKSAhPT0gLTEpIHsKICAgICAgICByZXR1cm4gU0lQLkMuY2F1c2VzW2NhdXNlXTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBTSVAuQy5jYXVzZXMuU0lQX0ZBSUxVUkVfQ09ERTsKICB9LAoKICBnZXRSZWFzb25QaHJhc2U6IGZ1bmN0aW9uIGdldFJlYXNvblBocmFzZSAoY29kZSwgc3BlY2lmaWMpIHsKICAgIHJldHVybiBzcGVjaWZpYyB8fCBTSVAuQy5SRUFTT05fUEhSQVNFW2NvZGVdIHx8ICcnOwogIH0sCgogIGdldFJlYXNvbkhlYWRlclZhbHVlOiBmdW5jdGlvbiBnZXRSZWFzb25IZWFkZXJWYWx1ZSAoY29kZSwgcmVhc29uKSB7CiAgICByZWFzb24gPSBTSVAuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKGNvZGUsIHJlYXNvbik7CiAgICByZXR1cm4gJ1NJUCA7Y2F1c2U9JyArIGNvZGUgKyAnIDt0ZXh0PSInICsgcmVhc29uICsgJyInOwogIH0sCgogIGdldENhbmNlbFJlYXNvbjogZnVuY3Rpb24gZ2V0Q2FuY2VsUmVhc29uIChjb2RlLCByZWFzb24pIHsKICAgIGlmIChjb2RlICYmIGNvZGUgPCAyMDAgfHwgY29kZSA+IDY5OSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHN0YXR1c19jb2RlOiAnICsgY29kZSk7CiAgICB9IGVsc2UgaWYgKGNvZGUpIHsKICAgICAgcmV0dXJuIFNJUC5VdGlscy5nZXRSZWFzb25IZWFkZXJWYWx1ZShjb2RlLCByZWFzb24pOwogICAgfQogIH0sCgogIGJ1aWxkU3RhdHVzTGluZTogZnVuY3Rpb24gYnVpbGRTdGF0dXNMaW5lIChjb2RlLCByZWFzb24pIHsKICAgIGNvZGUgPSBjb2RlIHx8IG51bGw7CiAgICByZWFzb24gPSByZWFzb24gfHwgbnVsbDsKCiAgICAvLyBWYWxpZGF0ZSBjb2RlIGFuZCByZWFzb24gdmFsdWVzCiAgICBpZiAoIWNvZGUgfHwgKGNvZGUgPCAxMDAgfHwgY29kZSA+IDY5OSkpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdGF0dXNfY29kZTogJysgY29kZSk7CiAgICB9IGVsc2UgaWYgKHJlYXNvbiAmJiB0eXBlb2YgcmVhc29uICE9PSAnc3RyaW5nJyAmJiAhKHJlYXNvbiBpbnN0YW5jZW9mIFN0cmluZykpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCByZWFzb25fcGhyYXNlOiAnKyByZWFzb24pOwogICAgfQoKICAgIHJlYXNvbiA9IFV0aWxzLmdldFJlYXNvblBocmFzZShjb2RlLCByZWFzb24pOwoKICAgIHJldHVybiAnU0lQLzIuMCAnICsgY29kZSArICcgJyArIHJlYXNvbiArICdcclxuJzsKICB9LAoKICAvKioKICAqIEdlbmVyYXRlIGEgcmFuZG9tIFRlc3QtTmV0IElQIChodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM1NzM1KQogICogQHByaXZhdGUKICAqLwogIGdldFJhbmRvbVRlc3ROZXRJUDogZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBnZXRPY3RldChmcm9tLHRvKSB7CiAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKHRvLWZyb20rMSkrZnJvbSk7CiAgICB9CiAgICByZXR1cm4gJzE5Mi4wLjIuJyArIGdldE9jdGV0KDEsIDI1NCk7CiAgfSwKCiAgLy8gTUQ1IChNZXNzYWdlLURpZ2VzdCBBbGdvcml0aG0pIGh0dHA6Ly93d3cud2VidG9vbGtpdC5pbmZvCiAgY2FsY3VsYXRlTUQ1OiBmdW5jdGlvbihzdHJpbmcpIHsKICAgIGZ1bmN0aW9uIFJvdGF0ZUxlZnQobFZhbHVlLCBpU2hpZnRCaXRzKSB7CiAgICAgIHJldHVybiAobFZhbHVlPDxpU2hpZnRCaXRzKSB8IChsVmFsdWU+Pj4oMzItaVNoaWZ0Qml0cykpOwogICAgfQoKICAgIGZ1bmN0aW9uIEFkZFVuc2lnbmVkKGxYLGxZKSB7CiAgICAgIHZhciBsWDQsbFk0LGxYOCxsWTgsbFJlc3VsdDsKICAgICAgbFg4ID0gKGxYICYgMHg4MDAwMDAwMCk7CiAgICAgIGxZOCA9IChsWSAmIDB4ODAwMDAwMDApOwogICAgICBsWDQgPSAobFggJiAweDQwMDAwMDAwKTsKICAgICAgbFk0ID0gKGxZICYgMHg0MDAwMDAwMCk7CiAgICAgIGxSZXN1bHQgPSAobFggJiAweDNGRkZGRkZGKSsobFkgJiAweDNGRkZGRkZGKTsKICAgICAgaWYgKGxYNCAmIGxZNCkgewogICAgICAgIHJldHVybiAobFJlc3VsdCBeIDB4ODAwMDAwMDAgXiBsWDggXiBsWTgpOwogICAgICB9CiAgICAgIGlmIChsWDQgfCBsWTQpIHsKICAgICAgICBpZiAobFJlc3VsdCAmIDB4NDAwMDAwMDApIHsKICAgICAgICAgIHJldHVybiAobFJlc3VsdCBeIDB4QzAwMDAwMDAgXiBsWDggXiBsWTgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gKGxSZXN1bHQgXiAweDQwMDAwMDAwIF4gbFg4IF4gbFk4KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIChsUmVzdWx0IF4gbFg4IF4gbFk4KTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIEYoeCx5LHopIHsKICAgICAgcmV0dXJuICh4ICYgeSkgfCAoKH54KSAmIHopOwogICAgfQoKICAgIGZ1bmN0aW9uIEcoeCx5LHopIHsKICAgICAgcmV0dXJuICh4ICYgeikgfCAoeSAmICh+eikpOwogICAgfQoKICAgIGZ1bmN0aW9uIEgoeCx5LHopIHsKICAgICAgcmV0dXJuICh4IF4geSBeIHopOwogICAgfQoKICAgIGZ1bmN0aW9uIEkoeCx5LHopIHsKICAgICAgcmV0dXJuICh5IF4gKHggfCAofnopKSk7CiAgICB9CgogICAgZnVuY3Rpb24gRkYoYSxiLGMsZCx4LHMsYWMpIHsKICAgICAgYSA9IEFkZFVuc2lnbmVkKGEsIEFkZFVuc2lnbmVkKEFkZFVuc2lnbmVkKEYoYiwgYywgZCksIHgpLCBhYykpOwogICAgICByZXR1cm4gQWRkVW5zaWduZWQoUm90YXRlTGVmdChhLCBzKSwgYik7CiAgICB9CgogICAgZnVuY3Rpb24gR0coYSxiLGMsZCx4LHMsYWMpIHsKICAgICAgYSA9IEFkZFVuc2lnbmVkKGEsIEFkZFVuc2lnbmVkKEFkZFVuc2lnbmVkKEcoYiwgYywgZCksIHgpLCBhYykpOwogICAgICByZXR1cm4gQWRkVW5zaWduZWQoUm90YXRlTGVmdChhLCBzKSwgYik7CiAgICB9CgogICAgZnVuY3Rpb24gSEgoYSxiLGMsZCx4LHMsYWMpIHsKICAgICAgYSA9IEFkZFVuc2lnbmVkKGEsIEFkZFVuc2lnbmVkKEFkZFVuc2lnbmVkKEgoYiwgYywgZCksIHgpLCBhYykpOwogICAgICByZXR1cm4gQWRkVW5zaWduZWQoUm90YXRlTGVmdChhLCBzKSwgYik7CiAgICB9CgogICAgZnVuY3Rpb24gSUkoYSxiLGMsZCx4LHMsYWMpIHsKICAgICAgYSA9IEFkZFVuc2lnbmVkKGEsIEFkZFVuc2lnbmVkKEFkZFVuc2lnbmVkKEkoYiwgYywgZCksIHgpLCBhYykpOwogICAgICByZXR1cm4gQWRkVW5zaWduZWQoUm90YXRlTGVmdChhLCBzKSwgYik7CiAgICB9CgogICAgZnVuY3Rpb24gQ29udmVydFRvV29yZEFycmF5KHN0cmluZykgewogICAgICB2YXIgbFdvcmRDb3VudDsKICAgICAgdmFyIGxNZXNzYWdlTGVuZ3RoID0gc3RyaW5nLmxlbmd0aDsKICAgICAgdmFyIGxOdW1iZXJPZldvcmRzX3RlbXAxPWxNZXNzYWdlTGVuZ3RoICsgODsKICAgICAgdmFyIGxOdW1iZXJPZldvcmRzX3RlbXAyPShsTnVtYmVyT2ZXb3Jkc190ZW1wMS0obE51bWJlck9mV29yZHNfdGVtcDEgJSA2NCkpLzY0OwogICAgICB2YXIgbE51bWJlck9mV29yZHMgPSAobE51bWJlck9mV29yZHNfdGVtcDIrMSkqMTY7CiAgICAgIHZhciBsV29yZEFycmF5PUFycmF5KGxOdW1iZXJPZldvcmRzLTEpOwogICAgICB2YXIgbEJ5dGVQb3NpdGlvbiA9IDA7CiAgICAgIHZhciBsQnl0ZUNvdW50ID0gMDsKICAgICAgd2hpbGUgKCBsQnl0ZUNvdW50IDwgbE1lc3NhZ2VMZW5ndGggKSB7CiAgICAgICAgbFdvcmRDb3VudCA9IChsQnl0ZUNvdW50LShsQnl0ZUNvdW50ICUgNCkpLzQ7CiAgICAgICAgbEJ5dGVQb3NpdGlvbiA9IChsQnl0ZUNvdW50ICUgNCkqODsKICAgICAgICBsV29yZEFycmF5W2xXb3JkQ291bnRdID0gKGxXb3JkQXJyYXlbbFdvcmRDb3VudF0gfCAoc3RyaW5nLmNoYXJDb2RlQXQobEJ5dGVDb3VudCk8PGxCeXRlUG9zaXRpb24pKTsKICAgICAgICBsQnl0ZUNvdW50Kys7CiAgICAgIH0KICAgICAgbFdvcmRDb3VudCA9IChsQnl0ZUNvdW50LShsQnl0ZUNvdW50ICUgNCkpLzQ7CiAgICAgIGxCeXRlUG9zaXRpb24gPSAobEJ5dGVDb3VudCAlIDQpKjg7CiAgICAgIGxXb3JkQXJyYXlbbFdvcmRDb3VudF0gPSBsV29yZEFycmF5W2xXb3JkQ291bnRdIHwgKDB4ODA8PGxCeXRlUG9zaXRpb24pOwogICAgICBsV29yZEFycmF5W2xOdW1iZXJPZldvcmRzLTJdID0gbE1lc3NhZ2VMZW5ndGg8PDM7CiAgICAgIGxXb3JkQXJyYXlbbE51bWJlck9mV29yZHMtMV0gPSBsTWVzc2FnZUxlbmd0aD4+PjI5OwogICAgICByZXR1cm4gbFdvcmRBcnJheTsKICAgIH0KCiAgICBmdW5jdGlvbiBXb3JkVG9IZXgobFZhbHVlKSB7CiAgICAgIHZhciBXb3JkVG9IZXhWYWx1ZT0iIixXb3JkVG9IZXhWYWx1ZV90ZW1wPSIiLGxCeXRlLGxDb3VudDsKICAgICAgZm9yIChsQ291bnQgPSAwO2xDb3VudDw9MztsQ291bnQrKykgewogICAgICAgIGxCeXRlID0gKGxWYWx1ZT4+PihsQ291bnQqOCkpICYgMjU1OwogICAgICAgIFdvcmRUb0hleFZhbHVlX3RlbXAgPSAiMCIgKyBsQnl0ZS50b1N0cmluZygxNik7CiAgICAgICAgV29yZFRvSGV4VmFsdWUgPSBXb3JkVG9IZXhWYWx1ZSArIFdvcmRUb0hleFZhbHVlX3RlbXAuc3Vic3RyKFdvcmRUb0hleFZhbHVlX3RlbXAubGVuZ3RoLTIsMik7CiAgICAgIH0KICAgICAgcmV0dXJuIFdvcmRUb0hleFZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIFV0ZjhFbmNvZGUoc3RyaW5nKSB7CiAgICAgIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9cclxuL2csIlxuIik7CiAgICAgIHZhciB1dGZ0ZXh0ID0gIiI7CgogICAgICBmb3IgKHZhciBuID0gMDsgbiA8IHN0cmluZy5sZW5ndGg7IG4rKykgewogICAgICAgIHZhciBjID0gc3RyaW5nLmNoYXJDb2RlQXQobik7CgogICAgICAgIGlmIChjIDwgMTI4KSB7CiAgICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYyk7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYoKGMgPiAxMjcpICYmIChjIDwgMjA0OCkpIHsKICAgICAgICAgIHV0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYyA+PiA2KSB8IDE5Mik7CiAgICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgIHV0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYyA+PiAxMikgfCAyMjQpOwogICAgICAgICAgdXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYyA+PiA2KSAmIDYzKSB8IDEyOCk7CiAgICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdXRmdGV4dDsKICAgIH0KCiAgICB2YXIgeD1bXTsKICAgIHZhciBrLEFBLEJCLENDLERELGEsYixjLGQ7CiAgICB2YXIgUzExPTcsIFMxMj0xMiwgUzEzPTE3LCBTMTQ9MjI7CiAgICB2YXIgUzIxPTUsIFMyMj05ICwgUzIzPTE0LCBTMjQ9MjA7CiAgICB2YXIgUzMxPTQsIFMzMj0xMSwgUzMzPTE2LCBTMzQ9MjM7CiAgICB2YXIgUzQxPTYsIFM0Mj0xMCwgUzQzPTE1LCBTNDQ9MjE7CgogICAgc3RyaW5nID0gVXRmOEVuY29kZShzdHJpbmcpOwoKICAgIHggPSBDb252ZXJ0VG9Xb3JkQXJyYXkoc3RyaW5nKTsKCiAgICBhID0gMHg2NzQ1MjMwMTsgYiA9IDB4RUZDREFCODk7IGMgPSAweDk4QkFEQ0ZFOyBkID0gMHgxMDMyNTQ3NjsKCiAgICBmb3IgKGs9MDtrPHgubGVuZ3RoO2srPTE2KSB7CiAgICAgIEFBPWE7IEJCPWI7IENDPWM7IEREPWQ7CiAgICAgIGE9RkYoYSxiLGMsZCx4W2srMF0sIFMxMSwweEQ3NkFBNDc4KTsKICAgICAgZD1GRihkLGEsYixjLHhbaysxXSwgUzEyLDB4RThDN0I3NTYpOwogICAgICBjPUZGKGMsZCxhLGIseFtrKzJdLCBTMTMsMHgyNDIwNzBEQik7CiAgICAgIGI9RkYoYixjLGQsYSx4W2srM10sIFMxNCwweEMxQkRDRUVFKTsKICAgICAgYT1GRihhLGIsYyxkLHhbays0XSwgUzExLDB4RjU3QzBGQUYpOwogICAgICBkPUZGKGQsYSxiLGMseFtrKzVdLCBTMTIsMHg0Nzg3QzYyQSk7CiAgICAgIGM9RkYoYyxkLGEsYix4W2srNl0sIFMxMywweEE4MzA0NjEzKTsKICAgICAgYj1GRihiLGMsZCxhLHhbays3XSwgUzE0LDB4RkQ0Njk1MDEpOwogICAgICBhPUZGKGEsYixjLGQseFtrKzhdLCBTMTEsMHg2OTgwOThEOCk7CiAgICAgIGQ9RkYoZCxhLGIsYyx4W2srOV0sIFMxMiwweDhCNDRGN0FGKTsKICAgICAgYz1GRihjLGQsYSxiLHhbaysxMF0sUzEzLDB4RkZGRjVCQjEpOwogICAgICBiPUZGKGIsYyxkLGEseFtrKzExXSxTMTQsMHg4OTVDRDdCRSk7CiAgICAgIGE9RkYoYSxiLGMsZCx4W2srMTJdLFMxMSwweDZCOTAxMTIyKTsKICAgICAgZD1GRihkLGEsYixjLHhbaysxM10sUzEyLDB4RkQ5ODcxOTMpOwogICAgICBjPUZGKGMsZCxhLGIseFtrKzE0XSxTMTMsMHhBNjc5NDM4RSk7CiAgICAgIGI9RkYoYixjLGQsYSx4W2srMTVdLFMxNCwweDQ5QjQwODIxKTsKICAgICAgYT1HRyhhLGIsYyxkLHhbaysxXSwgUzIxLDB4RjYxRTI1NjIpOwogICAgICBkPUdHKGQsYSxiLGMseFtrKzZdLCBTMjIsMHhDMDQwQjM0MCk7CiAgICAgIGM9R0coYyxkLGEsYix4W2srMTFdLFMyMywweDI2NUU1QTUxKTsKICAgICAgYj1HRyhiLGMsZCxhLHhbayswXSwgUzI0LDB4RTlCNkM3QUEpOwogICAgICBhPUdHKGEsYixjLGQseFtrKzVdLCBTMjEsMHhENjJGMTA1RCk7CiAgICAgIGQ9R0coZCxhLGIsYyx4W2srMTBdLFMyMiwweDI0NDE0NTMpOwogICAgICBjPUdHKGMsZCxhLGIseFtrKzE1XSxTMjMsMHhEOEExRTY4MSk7CiAgICAgIGI9R0coYixjLGQsYSx4W2srNF0sIFMyNCwweEU3RDNGQkM4KTsKICAgICAgYT1HRyhhLGIsYyxkLHhbays5XSwgUzIxLDB4MjFFMUNERTYpOwogICAgICBkPUdHKGQsYSxiLGMseFtrKzE0XSxTMjIsMHhDMzM3MDdENik7CiAgICAgIGM9R0coYyxkLGEsYix4W2srM10sIFMyMywweEY0RDUwRDg3KTsKICAgICAgYj1HRyhiLGMsZCxhLHhbays4XSwgUzI0LDB4NDU1QTE0RUQpOwogICAgICBhPUdHKGEsYixjLGQseFtrKzEzXSxTMjEsMHhBOUUzRTkwNSk7CiAgICAgIGQ9R0coZCxhLGIsYyx4W2srMl0sIFMyMiwweEZDRUZBM0Y4KTsKICAgICAgYz1HRyhjLGQsYSxiLHhbays3XSwgUzIzLDB4Njc2RjAyRDkpOwogICAgICBiPUdHKGIsYyxkLGEseFtrKzEyXSxTMjQsMHg4RDJBNEM4QSk7CiAgICAgIGE9SEgoYSxiLGMsZCx4W2srNV0sIFMzMSwweEZGRkEzOTQyKTsKICAgICAgZD1ISChkLGEsYixjLHhbays4XSwgUzMyLDB4ODc3MUY2ODEpOwogICAgICBjPUhIKGMsZCxhLGIseFtrKzExXSxTMzMsMHg2RDlENjEyMik7CiAgICAgIGI9SEgoYixjLGQsYSx4W2srMTRdLFMzNCwweEZERTUzODBDKTsKICAgICAgYT1ISChhLGIsYyxkLHhbaysxXSwgUzMxLDB4QTRCRUVBNDQpOwogICAgICBkPUhIKGQsYSxiLGMseFtrKzRdLCBTMzIsMHg0QkRFQ0ZBOSk7CiAgICAgIGM9SEgoYyxkLGEsYix4W2srN10sIFMzMywweEY2QkI0QjYwKTsKICAgICAgYj1ISChiLGMsZCxhLHhbaysxMF0sUzM0LDB4QkVCRkJDNzApOwogICAgICBhPUhIKGEsYixjLGQseFtrKzEzXSxTMzEsMHgyODlCN0VDNik7CiAgICAgIGQ9SEgoZCxhLGIsYyx4W2srMF0sIFMzMiwweEVBQTEyN0ZBKTsKICAgICAgYz1ISChjLGQsYSxiLHhbayszXSwgUzMzLDB4RDRFRjMwODUpOwogICAgICBiPUhIKGIsYyxkLGEseFtrKzZdLCBTMzQsMHg0ODgxRDA1KTsKICAgICAgYT1ISChhLGIsYyxkLHhbays5XSwgUzMxLDB4RDlENEQwMzkpOwogICAgICBkPUhIKGQsYSxiLGMseFtrKzEyXSxTMzIsMHhFNkRCOTlFNSk7CiAgICAgIGM9SEgoYyxkLGEsYix4W2srMTVdLFMzMywweDFGQTI3Q0Y4KTsKICAgICAgYj1ISChiLGMsZCxhLHhbaysyXSwgUzM0LDB4QzRBQzU2NjUpOwogICAgICBhPUlJKGEsYixjLGQseFtrKzBdLCBTNDEsMHhGNDI5MjI0NCk7CiAgICAgIGQ9SUkoZCxhLGIsYyx4W2srN10sIFM0MiwweDQzMkFGRjk3KTsKICAgICAgYz1JSShjLGQsYSxiLHhbaysxNF0sUzQzLDB4QUI5NDIzQTcpOwogICAgICBiPUlJKGIsYyxkLGEseFtrKzVdLCBTNDQsMHhGQzkzQTAzOSk7CiAgICAgIGE9SUkoYSxiLGMsZCx4W2srMTJdLFM0MSwweDY1NUI1OUMzKTsKICAgICAgZD1JSShkLGEsYixjLHhbayszXSwgUzQyLDB4OEYwQ0NDOTIpOwogICAgICBjPUlJKGMsZCxhLGIseFtrKzEwXSxTNDMsMHhGRkVGRjQ3RCk7CiAgICAgIGI9SUkoYixjLGQsYSx4W2srMV0sIFM0NCwweDg1ODQ1REQxKTsKICAgICAgYT1JSShhLGIsYyxkLHhbays4XSwgUzQxLDB4NkZBODdFNEYpOwogICAgICBkPUlJKGQsYSxiLGMseFtrKzE1XSxTNDIsMHhGRTJDRTZFMCk7CiAgICAgIGM9SUkoYyxkLGEsYix4W2srNl0sIFM0MywweEEzMDE0MzE0KTsKICAgICAgYj1JSShiLGMsZCxhLHhbaysxM10sUzQ0LDB4NEUwODExQTEpOwogICAgICBhPUlJKGEsYixjLGQseFtrKzRdLCBTNDEsMHhGNzUzN0U4Mik7CiAgICAgIGQ9SUkoZCxhLGIsYyx4W2srMTFdLFM0MiwweEJEM0FGMjM1KTsKICAgICAgYz1JSShjLGQsYSxiLHhbaysyXSwgUzQzLDB4MkFEN0QyQkIpOwogICAgICBiPUlJKGIsYyxkLGEseFtrKzldLCBTNDQsMHhFQjg2RDM5MSk7CiAgICAgIGE9QWRkVW5zaWduZWQoYSxBQSk7CiAgICAgIGI9QWRkVW5zaWduZWQoYixCQik7CiAgICAgIGM9QWRkVW5zaWduZWQoYyxDQyk7CiAgICAgIGQ9QWRkVW5zaWduZWQoZCxERCk7CiAgICB9CgogICAgdmFyIHRlbXAgPSBXb3JkVG9IZXgoYSkrV29yZFRvSGV4KGIpK1dvcmRUb0hleChjKStXb3JkVG9IZXgoZCk7CgogICAgcmV0dXJuIHRlbXAudG9Mb3dlckNhc2UoKTsKICB9Cn07CgpTSVAuVXRpbHMgPSBVdGlsczsKfTsKCn0se31dLDM4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBXZWJSVEMKICovCgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVAsIGVudmlyb25tZW50KSB7CnZhciBXZWJSVEM7CgpXZWJSVEMgPSB7fTsKCldlYlJUQy5NZWRpYUhhbmRsZXIgPSByZXF1aXJlKCcuL1dlYlJUQy9NZWRpYUhhbmRsZXInKShTSVApOwpXZWJSVEMuTWVkaWFTdHJlYW1NYW5hZ2VyID0gcmVxdWlyZSgnLi9XZWJSVEMvTWVkaWFTdHJlYW1NYW5hZ2VyJykoU0lQLCBlbnZpcm9ubWVudCk7Cgp2YXIgX2lzU3VwcG9ydGVkOwoKV2ViUlRDLmlzU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewogIGlmIChfaXNTdXBwb3J0ZWQgIT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuIF9pc1N1cHBvcnRlZDsKICB9CgogIFdlYlJUQy5NZWRpYVN0cmVhbSA9IGVudmlyb25tZW50Lk1lZGlhU3RyZWFtOwogIFdlYlJUQy5nZXRVc2VyTWVkaWEgPSBlbnZpcm9ubWVudC5nZXRVc2VyTWVkaWE7CiAgV2ViUlRDLlJUQ1BlZXJDb25uZWN0aW9uID0gZW52aXJvbm1lbnQuUlRDUGVlckNvbm5lY3Rpb247CiAgV2ViUlRDLlJUQ1Nlc3Npb25EZXNjcmlwdGlvbiA9IGVudmlyb25tZW50LlJUQ1Nlc3Npb25EZXNjcmlwdGlvbjsKCiAgaWYgKFdlYlJUQy5SVENQZWVyQ29ubmVjdGlvbiAmJiBXZWJSVEMuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKSB7CiAgICBpZiAoV2ViUlRDLmdldFVzZXJNZWRpYSkgewogICAgICBXZWJSVEMuZ2V0VXNlck1lZGlhID0gU0lQLlV0aWxzLnByb21pc2lmeShlbnZpcm9ubWVudCwgJ2dldFVzZXJNZWRpYScpOwogICAgfQogICAgX2lzU3VwcG9ydGVkID0gdHJ1ZTsKICB9CiAgZWxzZSB7CiAgICBfaXNTdXBwb3J0ZWQgPSBmYWxzZTsKICB9CiAgcmV0dXJuIF9pc1N1cHBvcnRlZDsKfTsKCnJldHVybiBXZWJSVEM7Cn07Cgp9LHsiLi9XZWJSVEMvTWVkaWFIYW5kbGVyIjozOSwiLi9XZWJSVEMvTWVkaWFTdHJlYW1NYW5hZ2VyIjo0MH1dLDM5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBNZWRpYUhhbmRsZXIKICovCgovKiBNZWRpYUhhbmRsZXIKICogQGNsYXNzIFBlZXJDb25uZWN0aW9uIGhlbHBlciBDbGFzcy4KICogQHBhcmFtIHtTSVAuU2Vzc2lvbn0gc2Vzc2lvbgogKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdCiAqIEBwYXJhbSB7U0lQLldlYlJUQy5NZWRpYVN0cmVhbU1hbmFnZXJ9IFtvcHRpb25zLm1lZGlhU3RyZWFtTWFuYWdlcl0KICogICAgICAgIFRoZSBNZWRpYVN0cmVhbU1hbmFnZXIgdG8gYWNxdWlyZS9yZWxlYXNlIHN0cmVhbXMgZnJvbS90by4KICogICAgICAgIElmIG5vdCBwcm92aWRlZCwgYSBkZWZhdWx0IE1lZGlhU3RyZWFtTWFuYWdlciB3aWxsIGJlIHVzZWQuCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKCnZhciBNZWRpYUhhbmRsZXIgPSBmdW5jdGlvbihzZXNzaW9uLCBvcHRpb25zKSB7CiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgogIHRoaXMubG9nZ2VyID0gc2Vzc2lvbi51YS5nZXRMb2dnZXIoJ3NpcC5pbnZpdGVjb250ZXh0Lm1lZGlhaGFuZGxlcicsIHNlc3Npb24uaWQpOwogIHRoaXMuc2Vzc2lvbiA9IHNlc3Npb247CiAgdGhpcy5sb2NhbE1lZGlhID0gbnVsbDsKICB0aGlzLnJlYWR5ID0gdHJ1ZTsKICB0aGlzLm1lZGlhU3RyZWFtTWFuYWdlciA9IG9wdGlvbnMubWVkaWFTdHJlYW1NYW5hZ2VyIHx8IG5ldyBTSVAuV2ViUlRDLk1lZGlhU3RyZWFtTWFuYWdlcih0aGlzLmxvZ2dlcik7CiAgdGhpcy5hdWRpb011dGVkID0gZmFsc2U7CiAgdGhpcy52aWRlb011dGVkID0gZmFsc2U7CgogIC8vIG9sZCBpbml0KCkgZnJvbSBoZXJlIG9uCiAgdmFyIHNlcnZlcnMgPSB0aGlzLnByZXBhcmVJY2VTZXJ2ZXJzKG9wdGlvbnMuc3R1blNlcnZlcnMsIG9wdGlvbnMudHVyblNlcnZlcnMpOwogIHRoaXMuUlRDQ29uc3RyYWludHMgPSBvcHRpb25zLlJUQ0NvbnN0cmFpbnRzIHx8IHt9OwoKICB0aGlzLmluaXRQZWVyQ29ubmVjdGlvbihzZXJ2ZXJzLCB0aGlzLlJUQ0NvbnN0cmFpbnRzKTsKCiAgZnVuY3Rpb24gc2VsZkVtaXQobWgsIGV2ZW50KSB7CiAgICBpZiAobWgubWVkaWFTdHJlYW1NYW5hZ2VyLm9uKSB7CiAgICAgIG1oLm1lZGlhU3RyZWFtTWFuYWdlci5vbihldmVudCwgZnVuY3Rpb24gKCkgewogICAgICAgIG1oLmVtaXQuYXBwbHkobWgsIFtldmVudF0uY29uY2F0KEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICBzZWxmRW1pdCh0aGlzLCAndXNlck1lZGlhUmVxdWVzdCcpOwogIHNlbGZFbWl0KHRoaXMsICd1c2VyTWVkaWEnKTsKICBzZWxmRW1pdCh0aGlzLCAndXNlck1lZGlhRmFpbGVkJyk7Cn07CgpNZWRpYUhhbmRsZXIuZGVmYXVsdEZhY3RvcnkgPSBmdW5jdGlvbiBkZWZhdWx0RmFjdG9yeSAoc2Vzc2lvbiwgb3B0aW9ucykgewogIHJldHVybiBuZXcgTWVkaWFIYW5kbGVyKHNlc3Npb24sIG9wdGlvbnMpOwp9OwpNZWRpYUhhbmRsZXIuZGVmYXVsdEZhY3RvcnkuaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIFNJUC5XZWJSVEMuaXNTdXBwb3J0ZWQoKTsKfTsKCk1lZGlhSGFuZGxlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5NZWRpYUhhbmRsZXIucHJvdG90eXBlLCB7Ci8vIEZ1bmN0aW9ucyB0aGUgc2Vzc2lvbiBjYW4gdXNlCiAgaXNSZWFkeToge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gaXNSZWFkeSAoKSB7CiAgICByZXR1cm4gdGhpcy5yZWFkeTsKICB9fSwKCiAgY2xvc2U6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGNsb3NlICgpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygnY2xvc2luZyBQZWVyQ29ubmVjdGlvbicpOwogICAgdGhpcy5fcmVtb3RlU3RyZWFtcyA9IFtdOwogICAgLy8gaGF2ZSB0byBjaGVjayBzaWduYWxpbmdTdGF0ZSBzaW5jZSB0aGlzLmNsb3NlKCkgZ2V0cyBjYWxsZWQgbXVsdGlwbGUgdGltZXMKICAgIC8vIFRPRE8gZmlndXJlIG91dCB3aHkgdGhhdCBoYXBwZW5zCiAgICBpZih0aGlzLnBlZXJDb25uZWN0aW9uICYmIHRoaXMucGVlckNvbm5lY3Rpb24uc2lnbmFsaW5nU3RhdGUgIT09ICdjbG9zZWQnKSB7CiAgICAgIHRoaXMucGVlckNvbm5lY3Rpb24uY2xvc2UoKTsKCiAgICAgIGlmKHRoaXMubG9jYWxNZWRpYSkgewogICAgICAgIHRoaXMubWVkaWFTdHJlYW1NYW5hZ2VyLnJlbGVhc2UodGhpcy5sb2NhbE1lZGlhKTsKICAgICAgfQogICAgfQogIH19LAoKICAvKioKICAgKiBAcGFyYW0ge1NJUC5XZWJSVEMuTWVkaWFTdHJlYW0gfCAoZ2V0VXNlck1lZGlhIGNvbnN0cmFpbnRzKX0gW21lZGlhSGludF0KICAgKiAgICAgICAgdGhlIE1lZGlhU3RyZWFtIChvciB0aGUgY29uc3RyYWludHMgZGVzY3JpYmluZyBpdCkgdG8gYmUgdXNlZCBmb3IgdGhlIHNlc3Npb24KICAgKi8KICBnZXREZXNjcmlwdGlvbjoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gZ2V0RGVzY3JpcHRpb24gKG1lZGlhSGludCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgdmFyIGFjcXVpcmUgPSBzZWxmLm1lZGlhU3RyZWFtTWFuYWdlci5hY3F1aXJlOwogICAgaWYgKGFjcXVpcmUubGVuZ3RoID4gMSkgewogICAgICBhY3F1aXJlID0gU0lQLlV0aWxzLnByb21pc2lmeSh0aGlzLm1lZGlhU3RyZWFtTWFuYWdlciwgJ2FjcXVpcmUnLCB0cnVlKTsKICAgIH0KICAgIG1lZGlhSGludCA9IG1lZGlhSGludCB8fCB7fTsKICAgIGlmIChtZWRpYUhpbnQuZGF0YUNoYW5uZWwgPT09IHRydWUpIHsKICAgICAgbWVkaWFIaW50LmRhdGFDaGFubmVsID0ge307CiAgICB9CiAgICB0aGlzLm1lZGlhSGludCA9IG1lZGlhSGludDsKCiAgICAvKgogICAgICogMS4gYWNxdWlyZSBzdHJlYW1zIChza2lwIGlmIE1lZGlhU3RyZWFtcyBwYXNzZWQgaW4pCiAgICAgKiAyLiBhZGRTdHJlYW1zCiAgICAgKiAzLiBjcmVhdGVPZmZlci9jcmVhdGVBbnN3ZXIKICAgICAqLwoKICAgIHZhciBzdHJlYW1Qcm9taXNlOwogICAgaWYgKHNlbGYubG9jYWxNZWRpYSkgewogICAgICBzZWxmLmxvZ2dlci5sb2coJ2FscmVhZHkgaGF2ZSBsb2NhbCBtZWRpYScpOwogICAgICBzdHJlYW1Qcm9taXNlID0gU0lQLlV0aWxzLlByb21pc2UucmVzb2x2ZShzZWxmLmxvY2FsTWVkaWEpOwogICAgfQogICAgZWxzZSB7CiAgICAgIHNlbGYubG9nZ2VyLmxvZygnYWNxdWlyaW5nIGxvY2FsIG1lZGlhJyk7CiAgICAgIHN0cmVhbVByb21pc2UgPSBhY3F1aXJlLmNhbGwoc2VsZi5tZWRpYVN0cmVhbU1hbmFnZXIsIG1lZGlhSGludCkKICAgICAgICAudGhlbihmdW5jdGlvbiBhY3F1aXJlU3VjY2VlZGVkKHN0cmVhbXMpIHsKICAgICAgICAgIHNlbGYubG9nZ2VyLmxvZygnYWNxdWlyZWQgbG9jYWwgbWVkaWEgc3RyZWFtcycpOwogICAgICAgICAgc2VsZi5sb2NhbE1lZGlhID0gc3RyZWFtczsKICAgICAgICAgIHNlbGYuc2Vzc2lvbi5jb25uZWN0aW5nKCk7CiAgICAgICAgICByZXR1cm4gc3RyZWFtczsKICAgICAgICB9LCBmdW5jdGlvbiBhY3F1aXJlRmFpbGVkKGVycikgewogICAgICAgICAgc2VsZi5sb2dnZXIuZXJyb3IoJ3VuYWJsZSB0byBhY3F1aXJlIHN0cmVhbXMnKTsKICAgICAgICAgIHNlbGYubG9nZ2VyLmVycm9yKGVycik7CiAgICAgICAgICBzZWxmLnNlc3Npb24uY29ubmVjdGluZygpOwogICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgIH0pCiAgICAgICAgLnRoZW4odGhpcy5hZGRTdHJlYW1zLmJpbmQodGhpcykpCiAgICAgIDsKICAgIH0KCiAgICByZXR1cm4gc3RyZWFtUHJvbWlzZQogICAgICAudGhlbihmdW5jdGlvbiBzdHJlYW1BZGRpdGlvblN1Y2NlZWRlZCgpIHsKICAgICAgICBpZiAoc2VsZi5oYXNPZmZlcigncmVtb3RlJykpIHsKICAgICAgICAgIHNlbGYucGVlckNvbm5lY3Rpb24ub25kYXRhY2hhbm5lbCA9IGZ1bmN0aW9uIChldnQpIHsKICAgICAgICAgICAgc2VsZi5kYXRhQ2hhbm5lbCA9IGV2dC5jaGFubmVsOwogICAgICAgICAgICBzZWxmLmVtaXQoJ2RhdGFDaGFubmVsJywgc2VsZi5kYXRhQ2hhbm5lbCk7CiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSBpZiAobWVkaWFIaW50LmRhdGFDaGFubmVsICYmCiAgICAgICAgICAgICAgICAgICBzZWxmLnBlZXJDb25uZWN0aW9uLmNyZWF0ZURhdGFDaGFubmVsKSB7CiAgICAgICAgICBzZWxmLmRhdGFDaGFubmVsID0gc2VsZi5wZWVyQ29ubmVjdGlvbi5jcmVhdGVEYXRhQ2hhbm5lbCgKICAgICAgICAgICAgJ3NpcGpzJywKICAgICAgICAgICAgbWVkaWFIaW50LmRhdGFDaGFubmVsCiAgICAgICAgICApOwogICAgICAgICAgc2VsZi5lbWl0KCdkYXRhQ2hhbm5lbCcsIHNlbGYuZGF0YUNoYW5uZWwpOwogICAgICAgIH0KCiAgICAgICAgc2VsZi5yZW5kZXIoKTsKICAgICAgICByZXR1cm4gc2VsZi5jcmVhdGVPZmZlck9yQW5zd2VyKHNlbGYuUlRDQ29uc3RyYWludHMpOwogICAgICB9KQogICAgOwogIH19LAoKICAvKioKICAqIE1lc3NhZ2UgcmVjZXB0aW9uLgogICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKICAqIEBwYXJhbSB7U3RyaW5nfSBzZHAKICAqLwogIHNldERlc2NyaXB0aW9uOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBzZXREZXNjcmlwdGlvbiAoc2RwKSB7CiAgICB2YXIgcmF3RGVzY3JpcHRpb24gPSB7CiAgICAgIHR5cGU6IHRoaXMuaGFzT2ZmZXIoJ2xvY2FsJykgPyAnYW5zd2VyJyA6ICdvZmZlcicsCiAgICAgIHNkcDogc2RwCiAgICB9OwoKICAgIHRoaXMuZW1pdCgnc2V0RGVzY3JpcHRpb24nLCByYXdEZXNjcmlwdGlvbik7CgogICAgdmFyIGRlc2NyaXB0aW9uID0gbmV3IFNJUC5XZWJSVEMuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHJhd0Rlc2NyaXB0aW9uKTsKICAgIHJldHVybiBTSVAuVXRpbHMucHJvbWlzaWZ5KHRoaXMucGVlckNvbm5lY3Rpb24sICdzZXRSZW1vdGVEZXNjcmlwdGlvbicpKGRlc2NyaXB0aW9uKTsKICB9fSwKCiAgLyoqCiAgICogSWYgdGhlIFNlc3Npb24gYXNzb2NpYXRlZCB3aXRoIHRoaXMgTWVkaWFIYW5kbGVyIHdlcmUgdG8gYmUgcmVmZXJyZWQsCiAgICogd2hhdCBtZWRpYUhpbnQgc2hvdWxkIGJlIHByb3ZpZGVkIHRvIHRoZSBVQSdzIGludml0ZSBtZXRob2Q/CiAgICovCiAgZ2V0UmVmZXJNZWRpYToge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVmZXJNZWRpYSAoKSB7CiAgICBmdW5jdGlvbiBoYXNUcmFja3MgKHRyYWNrR2V0dGVyLCBzdHJlYW0pIHsKICAgICAgcmV0dXJuIHN0cmVhbVt0cmFja0dldHRlcl0oKS5sZW5ndGggPiAwOwogICAgfQoKICAgIGZ1bmN0aW9uIGJvdGhIYXZlVHJhY2tzICh0cmFja0dldHRlcikgewogICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi8KICAgICAgcmV0dXJuIHRoaXMuZ2V0TG9jYWxTdHJlYW1zKCkuc29tZShoYXNUcmFja3MuYmluZChudWxsLCB0cmFja0dldHRlcikpICYmCiAgICAgICAgICAgICB0aGlzLmdldFJlbW90ZVN0cmVhbXMoKS5zb21lKGhhc1RyYWNrcy5iaW5kKG51bGwsIHRyYWNrR2V0dGVyKSk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgY29uc3RyYWludHM6IHsKICAgICAgICBhdWRpbzogYm90aEhhdmVUcmFja3MuY2FsbCh0aGlzLCAnZ2V0QXVkaW9UcmFja3MnKSwKICAgICAgICB2aWRlbzogYm90aEhhdmVUcmFja3MuY2FsbCh0aGlzLCAnZ2V0VmlkZW9UcmFja3MnKQogICAgICB9CiAgICB9OwogIH19LAoKICB1cGRhdGVJY2VTZXJ2ZXJzOiB7d3JpdGVhYmxlOnRydWUsIHZhbHVlOiBmdW5jdGlvbiAob3B0aW9ucykgewogICAgdmFyIHNlcnZlcnMgPSB0aGlzLnByZXBhcmVJY2VTZXJ2ZXJzKG9wdGlvbnMuc3R1blNlcnZlcnMsIG9wdGlvbnMudHVyblNlcnZlcnMpOwogICAgdGhpcy5SVENDb25zdHJhaW50cyA9IG9wdGlvbnMuUlRDQ29uc3RyYWludHMgfHwgdGhpcy5SVENDb25zdHJhaW50czsKCiAgICB0aGlzLmluaXRQZWVyQ29ubmVjdGlvbihzZXJ2ZXJzLCB0aGlzLlJUQ0NvbnN0cmFpbnRzKTsKCiAgICAvKiBvbmNlIHVwZGF0ZUljZSBpcyBpbXBsZW1lbnRlZCBjb3JyZWN0bHksIHRoaXMgaXMgYmV0dGVyIHRoYW4gYWJvdmUKICAgIC8vbm8gb3AgaWYgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IHRoaXMKICAgIGlmICghdGhpcy5wZWVyQ29ubmVjdGlvbi51cGRhdGVJY2UpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMucGVlckNvbm5lY3Rpb24udXBkYXRlSWNlKHsnaWNlU2VydmVycyc6IHNlcnZlcnN9LCB0aGlzLlJUQ0NvbnN0cmFpbnRzKTsKICAgICovCiAgfX0sCgovLyBGdW5jdGlvbnMgdGhlIHNlc3Npb24gY2FuIHVzZSwgYnV0IG9ubHkgYmVjYXVzZSBpdCdzIGNvbnZlbmllbnQgZm9yIHRoZSBhcHBsaWNhdGlvbgogIGlzTXV0ZWQ6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGlzTXV0ZWQgKCkgewogICAgcmV0dXJuIHsKICAgICAgYXVkaW86IHRoaXMuYXVkaW9NdXRlZCwKICAgICAgdmlkZW86IHRoaXMudmlkZW9NdXRlZAogICAgfTsKICB9fSwKCiAgbXV0ZToge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gbXV0ZSAob3B0aW9ucykgewogICAgaWYgKHRoaXMuZ2V0TG9jYWxTdHJlYW1zKCkubGVuZ3RoID09PSAwKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7CiAgICAgIGF1ZGlvOiB0aGlzLmdldExvY2FsU3RyZWFtcygpWzBdLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCwKICAgICAgdmlkZW86IHRoaXMuZ2V0TG9jYWxTdHJlYW1zKClbMF0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGggPiAwCiAgICB9OwoKICAgIHZhciBhdWRpb011dGVkID0gZmFsc2UsCiAgICAgICAgdmlkZW9NdXRlZCA9IGZhbHNlOwoKICAgIGlmIChvcHRpb25zLmF1ZGlvICYmICF0aGlzLmF1ZGlvTXV0ZWQpIHsKICAgICAgYXVkaW9NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMuYXVkaW9NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMudG9nZ2xlTXV0ZUF1ZGlvKHRydWUpOwogICAgfQoKICAgIGlmIChvcHRpb25zLnZpZGVvICYmICF0aGlzLnZpZGVvTXV0ZWQpIHsKICAgICAgdmlkZW9NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMudmlkZW9NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMudG9nZ2xlTXV0ZVZpZGVvKHRydWUpOwogICAgfQoKICAgIC8vUkVWSVNJVAogICAgaWYgKGF1ZGlvTXV0ZWQgfHwgdmlkZW9NdXRlZCkgewogICAgICByZXR1cm4gewogICAgICAgIGF1ZGlvOiBhdWRpb011dGVkLAogICAgICAgIHZpZGVvOiB2aWRlb011dGVkCiAgICAgIH07CiAgICAgIC8qdGhpcy5zZXNzaW9uLm9ubXV0ZSh7CiAgICAgICAgYXVkaW86IGF1ZGlvTXV0ZWQsCiAgICAgICAgdmlkZW86IHZpZGVvTXV0ZWQKICAgICAgfSk7Ki8KICAgIH0KICB9fSwKCiAgdW5tdXRlOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiB1bm11dGUgKG9wdGlvbnMpIHsKICAgIGlmICh0aGlzLmdldExvY2FsU3RyZWFtcygpLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwgewogICAgICBhdWRpbzogdGhpcy5nZXRMb2NhbFN0cmVhbXMoKVswXS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCA+IDAsCiAgICAgIHZpZGVvOiB0aGlzLmdldExvY2FsU3RyZWFtcygpWzBdLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoID4gMAogICAgfTsKCiAgICB2YXIgYXVkaW9Vbk11dGVkID0gZmFsc2UsCiAgICAgICAgdmlkZW9Vbk11dGVkID0gZmFsc2U7CgogICAgaWYgKG9wdGlvbnMuYXVkaW8gJiYgdGhpcy5hdWRpb011dGVkKSB7CiAgICAgIGF1ZGlvVW5NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMuYXVkaW9NdXRlZCA9IGZhbHNlOwogICAgICB0aGlzLnRvZ2dsZU11dGVBdWRpbyhmYWxzZSk7CiAgICB9CgogICAgaWYgKG9wdGlvbnMudmlkZW8gJiYgdGhpcy52aWRlb011dGVkKSB7CiAgICAgIHZpZGVvVW5NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMudmlkZW9NdXRlZCA9IGZhbHNlOwogICAgICB0aGlzLnRvZ2dsZU11dGVWaWRlbyhmYWxzZSk7CiAgICB9CgogICAgLy9SRVZJU0lUCiAgICBpZiAoYXVkaW9Vbk11dGVkIHx8IHZpZGVvVW5NdXRlZCkgewogICAgICByZXR1cm4gewogICAgICAgIGF1ZGlvOiBhdWRpb1VuTXV0ZWQsCiAgICAgICAgdmlkZW86IHZpZGVvVW5NdXRlZAogICAgICB9OwogICAgICAvKnRoaXMuc2Vzc2lvbi5vbnVubXV0ZSh7CiAgICAgICAgYXVkaW86IGF1ZGlvVW5NdXRlZCwKICAgICAgICB2aWRlbzogdmlkZW9Vbk11dGVkCiAgICAgIH0pOyovCiAgICB9CiAgfX0sCgogIGhvbGQ6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGhvbGQgKCkgewogICAgdGhpcy50b2dnbGVNdXRlQXVkaW8odHJ1ZSk7CiAgICB0aGlzLnRvZ2dsZU11dGVWaWRlbyh0cnVlKTsKICB9fSwKCiAgdW5ob2xkOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiB1bmhvbGQgKCkgewogICAgaWYgKCF0aGlzLmF1ZGlvTXV0ZWQpIHsKICAgICAgdGhpcy50b2dnbGVNdXRlQXVkaW8oZmFsc2UpOwogICAgfQoKICAgIGlmICghdGhpcy52aWRlb011dGVkKSB7CiAgICAgIHRoaXMudG9nZ2xlTXV0ZVZpZGVvKGZhbHNlKTsKICAgIH0KICB9fSwKCi8vIEZ1bmN0aW9ucyB0aGUgYXBwbGljYXRpb24gY2FuIHVzZSwgYnV0IG5vdCB0aGUgc2Vzc2lvbgogIGdldExvY2FsU3RyZWFtczoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gZ2V0TG9jYWxTdHJlYW1zICgpIHsKICAgIHZhciBwYyA9IHRoaXMucGVlckNvbm5lY3Rpb247CiAgICBpZiAocGMgJiYgcGMuc2lnbmFsaW5nU3RhdGUgPT09ICdjbG9zZWQnKSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ3BlZXJDb25uZWN0aW9uIGlzIGNsb3NlZCwgZ2V0TG9jYWxTdHJlYW1zIHJldHVybmluZyBbXScpOwogICAgICByZXR1cm4gW107CiAgICB9CiAgICByZXR1cm4gKHBjLmdldExvY2FsU3RyZWFtcyAmJiBwYy5nZXRMb2NhbFN0cmVhbXMoKSkgfHwKICAgICAgcGMubG9jYWxTdHJlYW1zIHx8IFtdOwogIH19LAoKICBnZXRSZW1vdGVTdHJlYW1zOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBnZXRSZW1vdGVTdHJlYW1zICgpIHsKICAgIHZhciBwYyA9IHRoaXMucGVlckNvbm5lY3Rpb247CiAgICBpZiAocGMgJiYgcGMuc2lnbmFsaW5nU3RhdGUgPT09ICdjbG9zZWQnKSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ3BlZXJDb25uZWN0aW9uIGlzIGNsb3NlZCwgZ2V0UmVtb3RlU3RyZWFtcyByZXR1cm5pbmcgdGhpcy5fcmVtb3RlU3RyZWFtcycpOwogICAgICByZXR1cm4gdGhpcy5fcmVtb3RlU3RyZWFtczsKICAgIH0KICAgIHJldHVybihwYy5nZXRSZW1vdGVTdHJlYW1zICYmIHBjLmdldFJlbW90ZVN0cmVhbXMoKSkgfHwKICAgICAgcGMucmVtb3RlU3RyZWFtcyB8fCBbXTsKICB9fSwKCiAgcmVuZGVyOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIgKHJlbmRlckhpbnQpIHsKICAgIHJlbmRlckhpbnQgPSByZW5kZXJIaW50IHx8ICh0aGlzLm1lZGlhSGludCAmJiB0aGlzLm1lZGlhSGludC5yZW5kZXIpOwogICAgaWYgKCFyZW5kZXJIaW50KSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHZhciBzdHJlYW1HZXR0ZXJzID0gewogICAgICBsb2NhbDogJ2dldExvY2FsU3RyZWFtcycsCiAgICAgIHJlbW90ZTogJ2dldFJlbW90ZVN0cmVhbXMnCiAgICB9OwogICAgT2JqZWN0LmtleXMoc3RyZWFtR2V0dGVycykuZm9yRWFjaChmdW5jdGlvbiAobG9jKSB7CiAgICAgIHZhciBzdHJlYW1HZXR0ZXIgPSBzdHJlYW1HZXR0ZXJzW2xvY107CiAgICAgIHZhciBzdHJlYW1zID0gdGhpc1tzdHJlYW1HZXR0ZXJdKCk7CiAgICAgIFNJUC5XZWJSVEMuTWVkaWFTdHJlYW1NYW5hZ2VyLnJlbmRlcihzdHJlYW1zLCByZW5kZXJIaW50W2xvY10pOwogICAgfS5iaW5kKHRoaXMpKTsKICB9fSwKCi8vIEludGVybmFsIGZ1bmN0aW9ucwogIGhhc09mZmVyOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBoYXNPZmZlciAod2hlcmUpIHsKICAgIHZhciBvZmZlclN0YXRlID0gJ2hhdmUtJyArIHdoZXJlICsgJy1vZmZlcic7CiAgICByZXR1cm4gdGhpcy5wZWVyQ29ubmVjdGlvbi5zaWduYWxpbmdTdGF0ZSA9PT0gb2ZmZXJTdGF0ZTsKICAgIC8vIFRPRE8gY29uc2lkZXIgc2lnbmFsaW5nU3RhdGVzIHdpdGggJ3ByYW5zd2VyJz8KICB9fSwKCiAgcHJlcGFyZUljZVNlcnZlcnM6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIHByZXBhcmVJY2VTZXJ2ZXJzIChzdHVuU2VydmVycywgdHVyblNlcnZlcnMpIHsKICAgIHZhciBzZXJ2ZXJzID0gW10sCiAgICAgIGNvbmZpZyA9IHRoaXMuc2Vzc2lvbi51YS5jb25maWd1cmF0aW9uOwoKICAgIHN0dW5TZXJ2ZXJzID0gc3R1blNlcnZlcnMgfHwgY29uZmlnLnN0dW5TZXJ2ZXJzOwogICAgdHVyblNlcnZlcnMgPSB0dXJuU2VydmVycyB8fCBjb25maWcudHVyblNlcnZlcnM7CgogICAgW10uY29uY2F0KHN0dW5TZXJ2ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChzZXJ2ZXIpIHsKICAgICAgc2VydmVycy5wdXNoKHsndXJscyc6IHNlcnZlcn0pOwogICAgfSk7CgogICAgW10uY29uY2F0KHR1cm5TZXJ2ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChzZXJ2ZXIpIHsKICAgICAgc2VydmVycy5wdXNoKHsKICAgICAgICAndXJscyc6IHNlcnZlci51cmxzLAogICAgICAgICd1c2VybmFtZSc6IHNlcnZlci51c2VybmFtZSwKICAgICAgICAnY3JlZGVudGlhbCc6IHNlcnZlci5wYXNzd29yZAogICAgICB9KTsKICAgIH0pOwoKICAgIHJldHVybiBzZXJ2ZXJzOwogIH19LAoKICBpbml0UGVlckNvbm5lY3Rpb246IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGluaXRQZWVyQ29ubmVjdGlvbihzZXJ2ZXJzLCBSVENDb25zdHJhaW50cykgewogICAgdmFyIHNlbGYgPSB0aGlzLAogICAgICBjb25maWcgPSB0aGlzLnNlc3Npb24udWEuY29uZmlndXJhdGlvbjsKCiAgICB0aGlzLm9uSWNlQ29tcGxldGVkID0gU0lQLlV0aWxzLmRlZmVyKCk7CiAgICB0aGlzLm9uSWNlQ29tcGxldGVkLnByb21pc2UudGhlbihmdW5jdGlvbihwYykgewogICAgICBzZWxmLmVtaXQoJ2ljZUdhdGhlcmluZ0NvbXBsZXRlJywgcGMpOwogICAgICBpZiAoc2VsZi5pY2VDaGVja2luZ1RpbWVyKSB7CiAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQoc2VsZi5pY2VDaGVja2luZ1RpbWVyKTsKICAgICAgICBzZWxmLmljZUNoZWNraW5nVGltZXIgPSBudWxsOwogICAgICB9CiAgICB9KTsKCiAgICBpZiAodGhpcy5wZWVyQ29ubmVjdGlvbikgewogICAgICB0aGlzLnBlZXJDb25uZWN0aW9uLmNsb3NlKCk7CiAgICB9CgogICAgdGhpcy5wZWVyQ29ubmVjdGlvbiA9IG5ldyBTSVAuV2ViUlRDLlJUQ1BlZXJDb25uZWN0aW9uKHsnaWNlU2VydmVycyc6IHNlcnZlcnN9LCBSVENDb25zdHJhaW50cyk7CgogICAgLy8gRmlyZWZveCAoMzUuMC4xKSBzb21ldGltZXMgdGhyb3dzIG9uIGNhbGxzIHRvIHBlZXJDb25uZWN0aW9uLmdldFJlbW90ZVN0cmVhbXMKICAgIC8vIGV2ZW4gaWYgcGVlckNvbm5lY3Rpb24ub25hZGRzdHJlYW0gd2FzIGp1c3QgY2FsbGVkLiBJbiBvcmRlciB0byBtYWtlCiAgICAvLyBNZWRpYUhhbmRsZXIucHJvdG90eXBlLmdldFJlbW90ZVN0cmVhbXMgd29yaywga2VlcCB0cmFjayBvZiB0aGVtIG1hbnVhbGx5CiAgICB0aGlzLl9yZW1vdGVTdHJlYW1zID0gW107CgogICAgdGhpcy5wZWVyQ29ubmVjdGlvbi5vbmFkZHN0cmVhbSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgc2VsZi5sb2dnZXIubG9nKCdzdHJlYW0gYWRkZWQ6ICcrIGUuc3RyZWFtLmlkKTsKICAgICAgc2VsZi5fcmVtb3RlU3RyZWFtcy5wdXNoKGUuc3RyZWFtKTsKICAgICAgc2VsZi5yZW5kZXIoKTsKICAgICAgc2VsZi5lbWl0KCdhZGRTdHJlYW0nLCBlKTsKICAgIH07CgogICAgdGhpcy5wZWVyQ29ubmVjdGlvbi5vbnJlbW92ZXN0cmVhbSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgc2VsZi5sb2dnZXIubG9nKCdzdHJlYW0gcmVtb3ZlZDogJysgZS5zdHJlYW0uaWQpOwogICAgfTsKCiAgICB0aGlzLnN0YXJ0SWNlQ2hlY2tpbmdUaW1lciA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFzZWxmLmljZUNoZWNraW5nVGltZXIpIHsKICAgICAgICBzZWxmLmljZUNoZWNraW5nVGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICBzZWxmLmxvZ2dlci5sb2coJ1JUQ0ljZUNoZWNraW5nIFRpbWVvdXQgVHJpZ2dlcmVkIGFmdGVyICcrY29uZmlnLmljZUNoZWNraW5nVGltZW91dCsnIG1pbGxpc2Vjb25kcycpOwogICAgICAgICAgc2VsZi5vbkljZUNvbXBsZXRlZC5yZXNvbHZlKHRoaXMpOwogICAgICAgIH0uYmluZCh0aGlzLnBlZXJDb25uZWN0aW9uKSwgY29uZmlnLmljZUNoZWNraW5nVGltZW91dCk7CiAgICAgIH0KICAgIH07CgogICAgdGhpcy5wZWVyQ29ubmVjdGlvbi5vbmljZWNhbmRpZGF0ZSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgc2VsZi5lbWl0KCdpY2VDYW5kaWRhdGUnLCBlKTsKICAgICAgaWYgKGUuY2FuZGlkYXRlKSB7CiAgICAgICAgc2VsZi5sb2dnZXIubG9nKCdJQ0UgY2FuZGlkYXRlIHJlY2VpdmVkOiAnKyAoZS5jYW5kaWRhdGUuY2FuZGlkYXRlID09PSBudWxsID8gbnVsbCA6IGUuY2FuZGlkYXRlLmNhbmRpZGF0ZS50cmltKCkpKTsKICAgICAgICBzZWxmLnN0YXJ0SWNlQ2hlY2tpbmdUaW1lcigpOwogICAgICB9IGVsc2UgewogICAgICAgIHNlbGYub25JY2VDb21wbGV0ZWQucmVzb2x2ZSh0aGlzKTsKICAgICAgfQogICAgfTsKCiAgICB0aGlzLnBlZXJDb25uZWN0aW9uLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHNlbGYubG9nZ2VyLmxvZygnUlRDSWNlR2F0aGVyaW5nU3RhdGUgY2hhbmdlZDogJyArIHRoaXMuaWNlR2F0aGVyaW5nU3RhdGUpOwogICAgICBpZiAodGhpcy5pY2VHYXRoZXJpbmdTdGF0ZSA9PT0gJ2dhdGhlcmluZycpIHsKICAgICAgICBzZWxmLmVtaXQoJ2ljZUdhdGhlcmluZycsIHRoaXMpOwogICAgICB9CiAgICAgIGlmICh0aGlzLmljZUdhdGhlcmluZ1N0YXRlID09PSAnY29tcGxldGUnKSB7CiAgICAgICAgc2VsZi5vbkljZUNvbXBsZXRlZC5yZXNvbHZlKHRoaXMpOwogICAgICB9CiAgICB9OwoKICAgIHRoaXMucGVlckNvbm5lY3Rpb24ub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsgIC8vbmVlZCBlIGZvciBjb21tZW50ZWQgb3V0IGNhc2UKICAgICAgdmFyIHN0YXRlRXZlbnQ7CgogICAgICBpZiAodGhpcy5pY2VDb25uZWN0aW9uU3RhdGUgPT09ICdjaGVja2luZycpIHsKICAgICAgICBzZWxmLnN0YXJ0SWNlQ2hlY2tpbmdUaW1lcigpOwogICAgICB9CgogICAgICBzd2l0Y2ggKHRoaXMuaWNlQ29ubmVjdGlvblN0YXRlKSB7CiAgICAgIGNhc2UgJ25ldyc6CiAgICAgICAgc3RhdGVFdmVudCA9ICdpY2VDb25uZWN0aW9uJzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnY2hlY2tpbmcnOgogICAgICAgIHN0YXRlRXZlbnQgPSAnaWNlQ29ubmVjdGlvbkNoZWNraW5nJzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnY29ubmVjdGVkJzoKICAgICAgICBzdGF0ZUV2ZW50ID0gJ2ljZUNvbm5lY3Rpb25Db25uZWN0ZWQnOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdjb21wbGV0ZWQnOgogICAgICAgIHN0YXRlRXZlbnQgPSAnaWNlQ29ubmVjdGlvbkNvbXBsZXRlZCc7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2ZhaWxlZCc6CiAgICAgICAgc3RhdGVFdmVudCA9ICdpY2VDb25uZWN0aW9uRmFpbGVkJzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZGlzY29ubmVjdGVkJzoKICAgICAgICBzdGF0ZUV2ZW50ID0gJ2ljZUNvbm5lY3Rpb25EaXNjb25uZWN0ZWQnOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdjbG9zZWQnOgogICAgICAgIHN0YXRlRXZlbnQgPSAnaWNlQ29ubmVjdGlvbkNsb3NlZCc7CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgc2VsZi5sb2dnZXIud2FybignVW5rbm93biBpY2VDb25uZWN0aW9uIHN0YXRlOicsIHRoaXMuaWNlQ29ubmVjdGlvblN0YXRlKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgc2VsZi5lbWl0KHN0YXRlRXZlbnQsIHRoaXMpOwoKICAgICAgLy9CcmlhIHN0YXRlIGNoYW5nZXMgYXJlIGFsd2F5cyBjb25uZWN0ZWQgLT4gZGlzY29ubmVjdGVkIC0+IGNvbm5lY3RlZCBvbiBhY2NlcHQsIHNvIHNlc3Npb24gZ2V0cyB0ZXJtaW5hdGVkCiAgICAgIC8vbm9ybWFsIGNhbGxzIHN3aXRjaCBmcm9tIGZhaWxlZCB0byBjb25uZWN0ZWQgaW4gc29tZSBjYXNlcywgc28gY2hlY2tpbmcgZm9yIGZhaWxlZCBhbmQgdGVybWluYXRlZAogICAgICAvKmlmICh0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSA9PT0gJ2ZhaWxlZCcpIHsKICAgICAgICBzZWxmLnNlc3Npb24udGVybWluYXRlKHsKICAgICAgICBjYXVzZTogU0lQLkMuY2F1c2VzLlJUUF9USU1FT1VULAogICAgICAgIHN0YXR1c19jb2RlOiAyMDAsCiAgICAgICAgcmVhc29uX3BocmFzZTogU0lQLkMuY2F1c2VzLlJUUF9USU1FT1VUCiAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGUuY3VycmVudFRhcmdldC5pY2VHYXRoZXJpbmdTdGF0ZSA9PT0gJ2NvbXBsZXRlJyAmJiB0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSAhPT0gJ2Nsb3NlZCcpIHsKICAgICAgc2VsZi5vbkljZUNvbXBsZXRlZCh0aGlzKTsKICAgICAgfSovCiAgICB9OwoKICAgIHRoaXMucGVlckNvbm5lY3Rpb24ub25zdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICBzZWxmLmxvZ2dlci5sb2coJ1BlZXJDb25uZWN0aW9uIHN0YXRlIGNoYW5nZWQgdG8gIicrIHRoaXMucmVhZHlTdGF0ZSArJyInKTsKICAgIH07CiAgfX0sCgogIGNyZWF0ZU9mZmVyT3JBbnN3ZXI6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZU9mZmVyT3JBbnN3ZXIgKGNvbnN0cmFpbnRzKSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICB2YXIgbWV0aG9kTmFtZTsKICAgIHZhciBwYyA9IHNlbGYucGVlckNvbm5lY3Rpb247CgogICAgc2VsZi5yZWFkeSA9IGZhbHNlOwogICAgbWV0aG9kTmFtZSA9IHNlbGYuaGFzT2ZmZXIoJ3JlbW90ZScpID8gJ2NyZWF0ZUFuc3dlcicgOiAnY3JlYXRlT2ZmZXInOwoKICAgIHJldHVybiBTSVAuVXRpbHMucHJvbWlzaWZ5KHBjLCBtZXRob2ROYW1lLCB0cnVlKShjb25zdHJhaW50cykKICAgICAgLnRoZW4oU0lQLlV0aWxzLnByb21pc2lmeShwYywgJ3NldExvY2FsRGVzY3JpcHRpb24nKSkKICAgICAgLnRoZW4oZnVuY3Rpb24gb25TZXRMb2NhbERlc2NyaXB0aW9uU3VjY2VzcygpIHsKICAgICAgICB2YXIgZGVmZXJyZWQgPSBTSVAuVXRpbHMuZGVmZXIoKTsKICAgICAgICBpZiAocGMuaWNlR2F0aGVyaW5nU3RhdGUgPT09ICdjb21wbGV0ZScgJiYgKHBjLmljZUNvbm5lY3Rpb25TdGF0ZSA9PT0gJ2Nvbm5lY3RlZCcgfHwgcGMuaWNlQ29ubmVjdGlvblN0YXRlID09PSAnY29tcGxldGVkJykpIHsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2VsZi5vbkljZUNvbXBsZXRlZC5wcm9taXNlLnRoZW4oZGVmZXJyZWQucmVzb2x2ZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlOwogICAgICB9KQogICAgICAudGhlbihmdW5jdGlvbiByZWFkeVN1Y2Nlc3MgKCkgewogICAgICAgIHZhciBzZHAgPSBwYy5sb2NhbERlc2NyaXB0aW9uLnNkcDsKCiAgICAgICAgc2RwID0gU0lQLkhhY2tzLkNocm9tZS5uZWVkc0V4cGxpY2l0bHlJbmFjdGl2ZVNEUChzZHApOwogICAgICAgIHNkcCA9IFNJUC5IYWNrcy5BbGxCcm93c2Vycy51bm1hc2tEdGxzKHNkcCk7CgogICAgICAgIHZhciBzZHBXcmFwcGVyID0gewogICAgICAgICAgdHlwZTogbWV0aG9kTmFtZSA9PT0gJ2NyZWF0ZU9mZmVyJyA/ICdvZmZlcicgOiAnYW5zd2VyJywKICAgICAgICAgIHNkcDogc2RwCiAgICAgICAgfTsKCiAgICAgICAgc2VsZi5lbWl0KCdnZXREZXNjcmlwdGlvbicsIHNkcFdyYXBwZXIpOwoKICAgICAgICBzZWxmLnJlYWR5ID0gdHJ1ZTsKICAgICAgICByZXR1cm4gc2RwV3JhcHBlci5zZHA7CiAgICAgIH0pCiAgICAgIC5jYXRjaChmdW5jdGlvbiBtZXRob2RGYWlsZWQgKGUpIHsKICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcihlKTsKICAgICAgICBzZWxmLnJlYWR5ID0gdHJ1ZTsKICAgICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuR2V0RGVzY3JpcHRpb25FcnJvcihlKTsKICAgICAgfSkKICAgIDsKICB9fSwKCiAgYWRkU3RyZWFtczoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gYWRkU3RyZWFtcyAoc3RyZWFtcykgewogICAgdHJ5IHsKICAgICAgc3RyZWFtcyA9IFtdLmNvbmNhdChzdHJlYW1zKTsKICAgICAgc3RyZWFtcy5mb3JFYWNoKGZ1bmN0aW9uIChzdHJlYW0pIHsKICAgICAgICB0aGlzLnBlZXJDb25uZWN0aW9uLmFkZFN0cmVhbShzdHJlYW0pOwogICAgICB9LCB0aGlzKTsKICAgIH0gY2F0Y2goZSkgewogICAgICB0aGlzLmxvZ2dlci5lcnJvcignZXJyb3IgYWRkaW5nIHN0cmVhbScpOwogICAgICB0aGlzLmxvZ2dlci5lcnJvcihlKTsKICAgICAgcmV0dXJuIFNJUC5VdGlscy5Qcm9taXNlLnJlamVjdChlKTsKICAgIH0KCiAgICByZXR1cm4gU0lQLlV0aWxzLlByb21pc2UucmVzb2x2ZSgpOwogIH19LAoKICB0b2dnbGVNdXRlSGVscGVyOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiB0b2dnbGVNdXRlSGVscGVyICh0cmFja0dldHRlciwgbXV0ZSkgewogICAgdGhpcy5nZXRMb2NhbFN0cmVhbXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChzdHJlYW0pIHsKICAgICAgc3RyZWFtW3RyYWNrR2V0dGVyXSgpLmZvckVhY2goZnVuY3Rpb24gKHRyYWNrKSB7CiAgICAgICAgdHJhY2suZW5hYmxlZCA9ICFtdXRlOwogICAgICB9KTsKICAgIH0pOwogIH19LAoKICB0b2dnbGVNdXRlQXVkaW86IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIHRvZ2dsZU11dGVBdWRpbyAobXV0ZSkgewogICAgdGhpcy50b2dnbGVNdXRlSGVscGVyKCdnZXRBdWRpb1RyYWNrcycsIG11dGUpOwogIH19LAoKICB0b2dnbGVNdXRlVmlkZW86IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIHRvZ2dsZU11dGVWaWRlbyAobXV0ZSkgewogICAgdGhpcy50b2dnbGVNdXRlSGVscGVyKCdnZXRWaWRlb1RyYWNrcycsIG11dGUpOwogIH19Cn0pOwoKLy8gUmV0dXJuIHNpbmNlIGl0IHdpbGwgYmUgYXNzaWduZWQgdG8gYSB2YXJpYWJsZS4KcmV0dXJuIE1lZGlhSGFuZGxlcjsKfTsKCn0se31dLDQwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBNZWRpYVN0cmVhbU1hbmFnZXIKICovCgovKiBNZWRpYVN0cmVhbU1hbmFnZXIKICogQGNsYXNzIE1hbmFnZXMgdGhlIGFjcXVpc2l0aW9uIGFuZCByZWxlYXNlIG9mIE1lZGlhU3RyZWFtcy4KICogQHBhcmFtIHttZWRpYUhpbnR9IFtkZWZhdWx0TWVkaWFIaW50XSBUaGUgbWVkaWFIaW50IHRvIHVzZSBpZiBub25lIGlzIHByb3ZpZGVkIHRvIGFjcXVpcmUoKQogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQLCBlbnZpcm9ubWVudCkgewoKLy8gRGVmYXVsdCBNZWRpYVN0cmVhbU1hbmFnZXIgcHJvdmlkZXMgc2luZ2xlLXVzZSBzdHJlYW1zIGNyZWF0ZWQgd2l0aCBnZXRVc2VyTWVkaWEKdmFyIE1lZGlhU3RyZWFtTWFuYWdlciA9IGZ1bmN0aW9uIE1lZGlhU3RyZWFtTWFuYWdlciAobG9nZ2VyLCBkZWZhdWx0TWVkaWFIaW50KSB7CiAgaWYgKCFTSVAuV2ViUlRDLmlzU3VwcG9ydGVkKCkpIHsKICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5Ob3RTdXBwb3J0ZWRFcnJvcignTWVkaWEgbm90IHN1cHBvcnRlZCcpOwogIH0KCiAgdGhpcy5tZWRpYUhpbnQgPSBkZWZhdWx0TWVkaWFIaW50IHx8IHsKICAgIGNvbnN0cmFpbnRzOiB7YXVkaW86IHRydWUsIHZpZGVvOiB0cnVlfQogIH07CgogIC8vIG1hcCBvZiBzdHJlYW1zIHRvIGFjcXVpc2l0aW9uIG1hbm5lcjoKICAvLyB0cnVlIC0+IHBhc3NlZCBpbiBhcyBtZWRpYUhpbnQuc3RyZWFtCiAgLy8gZmFsc2UgLT4gZ2V0VXNlck1lZGlhCiAgdGhpcy5hY3F1aXNpdGlvbnMgPSB7fTsKfTsKTWVkaWFTdHJlYW1NYW5hZ2VyLnN0cmVhbUlkID0gZnVuY3Rpb24gKHN0cmVhbSkgewogIHJldHVybiBzdHJlYW0uZ2V0QXVkaW9UcmFja3MoKS5jb25jYXQoc3RyZWFtLmdldFZpZGVvVHJhY2tzKCkpCiAgICAubWFwKGZ1bmN0aW9uIHRyYWNrSWQgKHRyYWNrKSB7CiAgICAgIHJldHVybiB0cmFjay5pZDsKICAgIH0pCiAgICAuam9pbignJyk7Cn07CgovKioKICogQHBhcmFtIHsoQXJyYXkgb2YpIE1lZGlhU3RyZWFtfSBzdHJlYW1zIC0gVGhlIHN0cmVhbXMgdG8gcmVuZGVyCiAqCiAqIEBwYXJhbSB7KEFycmF5IG9mKSBIVE1MTWVkaWFFbGVtZW50fSBlbGVtZW50cwogKiAgICAgICAgLSBUaGUgPGF1ZGlvPi88dmlkZW8+IGVsZW1lbnQocykgdGhhdCBzaG91bGQgcmVuZGVyIHRoZSBzdHJlYW1zCiAqCiAqIEVhY2ggc3RyZWFtIGluIHN0cmVhbXMgcmVuZGVycyB0byB0aGUgY29ycmVzcG9uZGluZyBlbGVtZW50IGluIGVsZW1lbnRzLAogKiB3cmFwcGluZyBhcm91bmQgZWxlbWVudHMgaWYgbmVlZGVkLgogKi8KTWVkaWFTdHJlYW1NYW5hZ2VyLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlciAoc3RyZWFtcywgZWxlbWVudHMpIHsKICBpZiAoIWVsZW1lbnRzKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIGlmIChBcnJheS5pc0FycmF5KGVsZW1lbnRzKSAmJiAhZWxlbWVudHMubGVuZ3RoKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdlbGVtZW50cyBtdXN0IG5vdCBiZSBlbXB0eScpOwogIH0KCiAgZnVuY3Rpb24gYXR0YWNoTWVkaWFTdHJlYW0oZWxlbWVudCwgc3RyZWFtKSB7CiAgICBpZiAodHlwZW9mIGVsZW1lbnQuc3JjICE9PSAndW5kZWZpbmVkJykgewogICAgICBlbnZpcm9ubWVudC5yZXZva2VPYmplY3RVUkwoZWxlbWVudC5zcmMpOwogICAgICBlbGVtZW50LnNyYyA9IGVudmlyb25tZW50LmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pOwogICAgfSBlbHNlIGlmICh0eXBlb2YgKGVsZW1lbnQuc3JjT2JqZWN0IHx8IGVsZW1lbnQubW96U3JjT2JqZWN0KSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgZWxlbWVudC5zcmNPYmplY3QgPSBlbGVtZW50Lm1velNyY09iamVjdCA9IHN0cmVhbTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGVuc3VyZU1lZGlhUGxheWluZyAobWVkaWFFbGVtZW50KSB7CiAgICB2YXIgaW50ZXJ2YWwgPSAxMDA7CiAgICBtZWRpYUVsZW1lbnQuZW5zdXJlUGxheWluZ0ludGVydmFsSWQgPSBTSVAuVGltZXJzLnNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKG1lZGlhRWxlbWVudC5wYXVzZWQpIHsKICAgICAgICBtZWRpYUVsZW1lbnQucGxheSgpOwogICAgICB9CiAgICAgIGVsc2UgewogICAgICAgIFNJUC5UaW1lcnMuY2xlYXJJbnRlcnZhbChtZWRpYUVsZW1lbnQuZW5zdXJlUGxheWluZ0ludGVydmFsSWQpOwogICAgICB9CiAgICB9LCBpbnRlcnZhbCk7CiAgfQoKICBmdW5jdGlvbiBhdHRhY2hBbmRQbGF5IChlbGVtZW50cywgc3RyZWFtLCBpbmRleCkgewogICAgaWYgKHR5cGVvZiBlbGVtZW50cyA9PT0gJ2Z1bmN0aW9uJykgewogICAgICBlbGVtZW50cyA9IGVsZW1lbnRzKCk7CiAgICB9CiAgICB2YXIgZWxlbWVudCA9IGVsZW1lbnRzW2luZGV4ICUgZWxlbWVudHMubGVuZ3RoXTsKICAgIChlbnZpcm9ubWVudC5hdHRhY2hNZWRpYVN0cmVhbSB8fCBhdHRhY2hNZWRpYVN0cmVhbSkoZWxlbWVudCwgc3RyZWFtKTsKICAgIGVuc3VyZU1lZGlhUGxheWluZyhlbGVtZW50KTsKICB9CgogIC8vIFtdLmNvbmNhdCAiY2FzdHMiIGBlbGVtZW50c2AgaW50byBhbiBhcnJheQogIC8vIHNvIGZvckVhY2ggd29ya3MgZXZlbiBpZiBgZWxlbWVudHNgIHdhcyBhIHNpbmdsZSBlbGVtZW50CiAgZWxlbWVudHMgPSBbXS5jb25jYXQoZWxlbWVudHMpOwogIFtdLmNvbmNhdChzdHJlYW1zKS5mb3JFYWNoKGF0dGFjaEFuZFBsYXkuYmluZChudWxsLCBlbGVtZW50cykpOwp9OwoKTWVkaWFTdHJlYW1NYW5hZ2VyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU0lQLkV2ZW50RW1pdHRlci5wcm90b3R5cGUsIHsKICAnYWNxdWlyZSc6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGFjcXVpcmUgKG1lZGlhSGludCkgewogICAgbWVkaWFIaW50ID0gT2JqZWN0LmtleXMobWVkaWFIaW50IHx8IHt9KS5sZW5ndGggPyBtZWRpYUhpbnQgOiB0aGlzLm1lZGlhSGludDsKCiAgICB2YXIgc2F2ZVN1Y2Nlc3MgPSBmdW5jdGlvbiAoaXNIaW50U3RyZWFtLCBzdHJlYW1zKSB7CiAgICAgIHN0cmVhbXMgPSBbXS5jb25jYXQoc3RyZWFtcyk7CiAgICAgIHN0cmVhbXMuZm9yRWFjaChmdW5jdGlvbiAoc3RyZWFtKSB7CiAgICAgICAgdmFyIHN0cmVhbUlkID0gTWVkaWFTdHJlYW1NYW5hZ2VyLnN0cmVhbUlkKHN0cmVhbSk7CiAgICAgICAgdGhpcy5hY3F1aXNpdGlvbnNbc3RyZWFtSWRdID0gISFpc0hpbnRTdHJlYW07CiAgICAgIH0sIHRoaXMpOwogICAgICByZXR1cm4gU0lQLlV0aWxzLlByb21pc2UucmVzb2x2ZShzdHJlYW1zKTsKICAgIH0uYmluZCh0aGlzKTsKCiAgICBpZiAobWVkaWFIaW50LnN0cmVhbSkgewogICAgICByZXR1cm4gc2F2ZVN1Y2Nlc3ModHJ1ZSwgbWVkaWFIaW50LnN0cmVhbSk7CiAgICB9IGVsc2UgewogICAgICAvLyBGYWxsYmFjayB0byBhdWRpby92aWRlbyBlbmFibGVkIGlmIG5vIG1lZGlhSGludCBjYW4gYmUgZm91bmQuCiAgICAgIHZhciBjb25zdHJhaW50cyA9IG1lZGlhSGludC5jb25zdHJhaW50cyB8fAogICAgICAgICh0aGlzLm1lZGlhSGludCAmJiB0aGlzLm1lZGlhSGludC5jb25zdHJhaW50cykgfHwKICAgICAgICB7YXVkaW86IHRydWUsIHZpZGVvOiB0cnVlfTsKCiAgICAgIHZhciBkZWZlcnJlZCA9IFNJUC5VdGlscy5kZWZlcigpOwoKICAgICAgLyoKICAgICAgICogTWFrZSB0aGUgY2FsbCBhc3luY2hyb25vdXMsIHNvIHRoYXQgSUNDcyBoYXZlIGEgY2hhbmNlCiAgICAgICAqIHRvIGRlZmluZSBjYWxsYmFja3MgdG8gYHVzZXJNZWRpYVJlcXVlc3RgCiAgICAgICAqLwogICAgICBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMuZW1pdCgndXNlck1lZGlhUmVxdWVzdCcsIGNvbnN0cmFpbnRzKTsKCiAgICAgICAgdmFyIGVtaXRUaGVuQ2FsbCA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGNhbGxiYWNrKSB7CiAgICAgICAgICB2YXIgY2FsbGJhY2tBcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKICAgICAgICAgIC8vIEVtaXQgd2l0aCBhbGwgb2YgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSByZWFsIGNhbGxiYWNrLgogICAgICAgICAgdmFyIG5ld0FyZ3MgPSBbZXZlbnROYW1lXS5jb25jYXQoY2FsbGJhY2tBcmdzKTsKCiAgICAgICAgICB0aGlzLmVtaXQuYXBwbHkodGhpcywgbmV3QXJncyk7CgogICAgICAgICAgcmV0dXJuIGNhbGxiYWNrLmFwcGx5KG51bGwsIGNhbGxiYWNrQXJncyk7CiAgICAgICAgfS5iaW5kKHRoaXMpOwoKICAgICAgICBpZiAoY29uc3RyYWludHMuYXVkaW8gfHwgY29uc3RyYWludHMudmlkZW8pIHsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoCiAgICAgICAgICAgIFNJUC5XZWJSVEMuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKQogICAgICAgICAgICAudGhlbigKICAgICAgICAgICAgICBlbWl0VGhlbkNhbGwuYmluZCh0aGlzLCAndXNlck1lZGlhJywgc2F2ZVN1Y2Nlc3MuYmluZChudWxsLCBmYWxzZSkpLAogICAgICAgICAgICAgIGVtaXRUaGVuQ2FsbC5iaW5kKHRoaXMsICd1c2VyTWVkaWFGYWlsZWQnLCBmdW5jdGlvbihlKXt0aHJvdyBlO30pCiAgICAgICAgICAgICkKICAgICAgICAgICk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIExvY2FsIHN0cmVhbXMgd2VyZSBleHBsaWNpdGx5IGV4Y2x1ZGVkLgogICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShbXSk7CiAgICAgICAgfQogICAgICB9LmJpbmQodGhpcyksIDApOwoKICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7CiAgICB9CiAgfX0sCgogICdyZWxlYXNlJzoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gcmVsZWFzZSAoc3RyZWFtcykgewogICAgc3RyZWFtcyA9IFtdLmNvbmNhdChzdHJlYW1zKTsKICAgIHN0cmVhbXMuZm9yRWFjaChmdW5jdGlvbiAoc3RyZWFtKSB7CiAgICAgIHZhciBzdHJlYW1JZCA9IE1lZGlhU3RyZWFtTWFuYWdlci5zdHJlYW1JZChzdHJlYW0pOwogICAgICBpZiAodGhpcy5hY3F1aXNpdGlvbnNbc3RyZWFtSWRdID09PSBmYWxzZSkgewogICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uICh0cmFjaykgewogICAgICAgICAgdHJhY2suc3RvcCgpOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIGRlbGV0ZSB0aGlzLmFjcXVpc2l0aW9uc1tzdHJlYW1JZF07CiAgICB9LCB0aGlzKTsKICB9fSwKfSk7CgovLyBSZXR1cm4gc2luY2UgaXQgd2lsbCBiZSBhc3NpZ25lZCB0byBhIHZhcmlhYmxlLgpyZXR1cm4gTWVkaWFTdHJlYW1NYW5hZ2VyOwp9OwoKfSx7fV0sNDE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewooZnVuY3Rpb24gKGdsb2JhbCl7CiJ1c2Ugc3RyaWN0IjsKCnZhciB0b3BsZXZlbCA9IGdsb2JhbC53aW5kb3cgfHwgZ2xvYmFsOwoKZnVuY3Rpb24gZ2V0UHJlZml4ZWRQcm9wZXJ0eSAob2JqZWN0LCBuYW1lKSB7CiAgaWYgKG9iamVjdCA9PSBudWxsKSB7CiAgICByZXR1cm47CiAgfQogIHZhciBjYXBpdGFsaXplZE5hbWUgPSBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTsKICB2YXIgcHJlZml4ZWROYW1lcyA9IFtuYW1lLCAnd2Via2l0JyArIGNhcGl0YWxpemVkTmFtZSwgJ21veicgKyBjYXBpdGFsaXplZE5hbWVdOwogIGZvciAodmFyIGkgaW4gcHJlZml4ZWROYW1lcykgewogICAgdmFyIHByb3BlcnR5ID0gb2JqZWN0W3ByZWZpeGVkTmFtZXNbaV1dOwogICAgaWYgKHByb3BlcnR5KSB7CiAgICAgIHJldHVybiBwcm9wZXJ0eS5iaW5kKG9iamVjdCk7CiAgICB9CiAgfQp9Cgptb2R1bGUuZXhwb3J0cyA9IHsKICBXZWJTb2NrZXQ6IHRvcGxldmVsLldlYlNvY2tldCwKICBUcmFuc3BvcnQ6IHJlcXVpcmUoJy4vVHJhbnNwb3J0JyksCiAgb3BlbjogdG9wbGV2ZWwub3BlbiwKICBQcm9taXNlOiB0b3BsZXZlbC5Qcm9taXNlLAogIHRpbWVyczogdG9wbGV2ZWwsCgogIC8vIENvbnNvbGUgaXMgbm90IGRlZmluZWQgaW4gRUNNQVNjcmlwdCwgc28ganVzdCBpbiBjYXNlLi4uCiAgY29uc29sZTogdG9wbGV2ZWwuY29uc29sZSB8fCB7CiAgICBkZWJ1ZzogZnVuY3Rpb24gKCkge30sCiAgICBsb2c6IGZ1bmN0aW9uICgpIHt9LAogICAgd2FybjogZnVuY3Rpb24gKCkge30sCiAgICBlcnJvcjogZnVuY3Rpb24gKCkge30KICB9LAoKICBNZWRpYVN0cmVhbTogZ2V0UHJlZml4ZWRQcm9wZXJ0eSh0b3BsZXZlbCwgJ01lZGlhU3RyZWFtJyksCiAgZ2V0VXNlck1lZGlhOiBnZXRQcmVmaXhlZFByb3BlcnR5KHRvcGxldmVsLm5hdmlnYXRvciwgJ2dldFVzZXJNZWRpYScpLAogIFJUQ1BlZXJDb25uZWN0aW9uOiBnZXRQcmVmaXhlZFByb3BlcnR5KHRvcGxldmVsLCAnUlRDUGVlckNvbm5lY3Rpb24nKSwKICBSVENTZXNzaW9uRGVzY3JpcHRpb246IGdldFByZWZpeGVkUHJvcGVydHkodG9wbGV2ZWwsICdSVENTZXNzaW9uRGVzY3JpcHRpb24nKSwKCiAgYWRkRXZlbnRMaXN0ZW5lcjogZ2V0UHJlZml4ZWRQcm9wZXJ0eSh0b3BsZXZlbCwgJ2FkZEV2ZW50TGlzdGVuZXInKSwKICBIVE1MTWVkaWFFbGVtZW50OiB0b3BsZXZlbC5IVE1MTWVkaWFFbGVtZW50LAoKICBhdHRhY2hNZWRpYVN0cmVhbTogdG9wbGV2ZWwuYXR0YWNoTWVkaWFTdHJlYW0sCiAgY3JlYXRlT2JqZWN0VVJMOiB0b3BsZXZlbC5VUkwgJiYgdG9wbGV2ZWwuVVJMLmNyZWF0ZU9iamVjdFVSTCwKICByZXZva2VPYmplY3RVUkw6IHRvcGxldmVsLlVSTCAmJiB0b3BsZXZlbC5VUkwucmV2b2tlT2JqZWN0VVJMCn07Cgp9KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gInVuZGVmaW5lZCIgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gInVuZGVmaW5lZCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB7fSkKfSx7Ii4vVHJhbnNwb3J0IjozNH1dLDQyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwptb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vU0lQJykocmVxdWlyZSgnLi9lbnZpcm9ubWVudCcpKTsKCn0seyIuL1NJUCI6MjUsIi4vZW52aXJvbm1lbnQiOjQxfV0sNDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7Cgl2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCgp2YXIgX3NpcCA9IHJlcXVpcmUoJ3NpcC5qcycpOwoKdmFyIF9zaXAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2lwKTsKCnZhciBfSW52aXRlQ2xpZW50Q29udGV4dCA9IHJlcXVpcmUoJy4vSW52aXRlQ2xpZW50Q29udGV4dCcpOwoKdmFyIF9JbnZpdGVDbGllbnRDb250ZXh0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0ludml0ZUNsaWVudENvbnRleHQpOwoKdmFyIF9JbnZpdGVTZXJ2ZXJDb250ZXh0ID0gcmVxdWlyZSgnLi9JbnZpdGVTZXJ2ZXJDb250ZXh0Jyk7Cgp2YXIgX0ludml0ZVNlcnZlckNvbnRleHQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfSW52aXRlU2VydmVyQ29udGV4dCk7Cgp2YXIgX1NJUFV0aWxzID0gcmVxdWlyZSgnLi9TSVBVdGlscycpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKdmFyIENvbm5lY3Rpb25Db250cm9sbGVyID0gZnVuY3Rpb24gKCkgewoJZnVuY3Rpb24gQ29ubmVjdGlvbkNvbnRyb2xsZXIoY29uZmlndXJhdGlvbiwgb25DYWxsLCBvbkRpc2Nvbm5lY3QpIHsKCQlfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29ubmVjdGlvbkNvbnRyb2xsZXIpOwoKCQlpZiAoIWNvbmZpZ3VyYXRpb24pIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZ3VyYXRpb24gaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CgoJCV9zaXAyLmRlZmF1bHQuSW52aXRlU2VydmVyQ29udGV4dCA9IF9JbnZpdGVTZXJ2ZXJDb250ZXh0Mi5kZWZhdWx0OwoJCXRoaXMuY29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247CgkJdGhpcy5vbkRpc2Nvbm5lY3QgPSBvbkRpc2Nvbm5lY3Q7CgkJdGhpcy5vbkNhbGwgPSBvbkNhbGw7Cgl9CgoJX2NyZWF0ZUNsYXNzKENvbm5lY3Rpb25Db250cm9sbGVyLCBbewoJCWtleTogJ2Nvbm5lY3QnLAoJCXZhbHVlOiBmdW5jdGlvbiBjb25uZWN0KGFjY2Vzc1Rva2VuKSB7CgkJCXZhciBfdGhpcyA9IHRoaXM7CgoJCQlyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoJCQkJaWYgKF90aGlzLnVzZXJBZ2VudCkgcmV0dXJuIHJlc29sdmUoKTsKCgkJCQlmZXRjaChfdGhpcy5jb25maWd1cmF0aW9uLmNyZWRlbnRpYWxfc2VydmVyLCB7IG1ldGhvZDogJ0dFVCcsIGhlYWRlcnM6IHsgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyOiAnICsgYWNjZXNzVG9rZW4gfSB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKCQkJCQlyZXMuanNvbigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHsKCQkJCQkJX3RoaXMudXNlckFnZW50ID0gbmV3IF9zaXAyLmRlZmF1bHQuVUEoewoJCQkJCQkJdXJpOiB1c2VyLnVzZXJuYW1lLAoJCQkJCQkJd3NTZXJ2ZXJzOiB1c2VyLnVyaXMsCgkJCQkJCQlwYXNzd29yZDogdXNlci5wYXNzd29yZAoJCQkJCQl9KTsKCQkJCQkJX3RoaXMudXNlckFnZW50Lm9uKCdpbnZpdGUnLCBmdW5jdGlvbiAoY29udGV4dCkgewoJCQkJCQkJaWYgKF90aGlzLmNvbnRleHQpIHJldHVybjsKCgkJCQkJCQljb250ZXh0Lm9uKCdieWUnLCBmdW5jdGlvbiAoKSB7CgkJCQkJCQkJZGVsZXRlIF90aGlzLmNvbnRleHQ7CgkJCQkJCQkJX3RoaXMub25EaXNjb25uZWN0KCk7CgkJCQkJCQl9KTsKCQkJCQkJCWNvbnRleHQub24oJ2ZhaWxlZCcsIGNvbnNvbGUubG9nKTsKCQkJCQkJCWNvbnRleHQub24oJ3JlamVjdGVkJywgY29uc29sZS5sb2cpOwoJCQkJCQkJX3RoaXMuY29udGV4dCA9IGNvbnRleHQ7CgkJCQkJCQlfdGhpcy5vbkNhbGwoY29udGV4dC5yZXF1ZXN0LnRvLmZyaWVuZGx5TmFtZSwgY29udGV4dC5ib2R5KTsKCQkJCQkJfSk7CgkJCQkJCXJlc29sdmUoKTsKCQkJCQl9KTsKCQkJCX0pLmNhdGNoKHJlamVjdCk7CgkJCX0pOwoJCX0KCX0sIHsKCQlrZXk6ICdhY2NlcHQnLAoJCXZhbHVlOiBmdW5jdGlvbiBhY2NlcHQoZGF0YU9iamVjdE9ic2VydmVyKSB7CgkJCXRoaXMuY29udGV4dC5hY2NlcHQoewoJCQkJc2RwOiAoMCwgX1NJUFV0aWxzLmFkZENhbmRpZGF0ZXNUb1NEUCkoZGF0YU9iamVjdE9ic2VydmVyLmRhdGEuY29ubmVjdGlvbkRlc2NyaXB0aW9uLnNkcCwgZGF0YU9iamVjdE9ic2VydmVyLmRhdGEuaWNlQ2FuZGlkYXRlcykKCQkJfSk7CgkJfQoJfSwgewoJCWtleTogJ2ludml0ZScsCgkJdmFsdWU6IGZ1bmN0aW9uIGludml0ZSh0bywgZGF0YU9iamVjdE9ic2VydmVyKSB7CgkJCXZhciBfdGhpczIgPSB0aGlzOwoKCQkJdmFyIG9wdGlvbnMgPSB7CgkJCQlzZHA6ICgwLCBfU0lQVXRpbHMuYWRkQ2FuZGlkYXRlc1RvU0RQKShkYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YS5jb25uZWN0aW9uRGVzY3JpcHRpb24uc2RwLCBkYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YS5pY2VDYW5kaWRhdGVzKQoJCQl9OwoKCQkJcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCQkJCWlmIChfdGhpczIuY29udGV4dCkgcmVqZWN0KG5ldyBFcnJvcignUHJldmlvdXMgY29udGV4dCcsIF90aGlzMi5jb250ZXh0KSk7CgoJCQkJdmFyIGNvbnRleHQgPSBuZXcgX0ludml0ZUNsaWVudENvbnRleHQyLmRlZmF1bHQoX3RoaXMyLnVzZXJBZ2VudCwgdG8ucmVwbGFjZSgnLy8nLCAnJyksIG9wdGlvbnMpOwoJCQkJX3RoaXMyLnVzZXJBZ2VudC5hZnRlckNvbm5lY3RlZChjb250ZXh0Lmludml0ZS5iaW5kKGNvbnRleHQpKTsKCQkJCWNvbnRleHQub24oJ2J5ZScsIGZ1bmN0aW9uICgpIHsKCQkJCQlkZWxldGUgX3RoaXMyLmNvbnRleHQ7CgkJCQkJX3RoaXMyLm9uRGlzY29ubmVjdCgpOwoJCQkJfSk7CgkJCQljb250ZXh0Lm9uKCdhY2NlcHRlZCcsIHJlc29sdmUpOwoJCQkJY29udGV4dC5vbignZmFpbGVkJywgcmVqZWN0KTsKCQkJCWNvbnRleHQub24oJ3JlamVjdGVkJywgcmVqZWN0KTsKCgkJCQlfdGhpczIuY29udGV4dCA9IGNvbnRleHQ7CgkJCX0pOwoJCX0KCX0sIHsKCQlrZXk6ICdkaXNjb25uZWN0JywKCQl2YWx1ZTogZnVuY3Rpb24gZGlzY29ubmVjdCgpIHsKCQkJY29uc29sZS5sb2coJ2Rpc2Nvbm5lY3RpbmcgZnJvbSBpbXMnKTsKCQkJaWYgKHRoaXMuY29udGV4dCAmJiAhdGhpcy5jb250ZXh0LmVuZFRpbWUpIHsKCQkJCXRoaXMuY29udGV4dC5ieWUoKTsKCQkJCWRlbGV0ZSB0aGlzLmNvbnRleHQ7CgkJCX0KCQl9Cgl9XSk7CgoJcmV0dXJuIENvbm5lY3Rpb25Db250cm9sbGVyOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBDb25uZWN0aW9uQ29udHJvbGxlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi9JbnZpdGVDbGllbnRDb250ZXh0Ijo0NSwiLi9JbnZpdGVTZXJ2ZXJDb250ZXh0Ijo0NiwiLi9TSVBVdGlscyI6NDcsInNpcC5qcyI6NDJ9XSw0NDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCXZhbHVlOiB0cnVlCn0pOwoKdmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBhY3RpdmF0ZTsKCnZhciBfU3luY2hlciA9IHJlcXVpcmUoJ3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlcicpOwoKdmFyIF9EaXNjb3ZlcnkgPSByZXF1aXJlKCdzZXJ2aWNlLWZyYW1ld29yay9kaXN0L0Rpc2NvdmVyeScpOwoKdmFyIF9EaXNjb3ZlcnkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGlzY292ZXJ5KTsKCnZhciBfQ29ubmVjdGlvbkNvbnRyb2xsZXIgPSByZXF1aXJlKCcuL0Nvbm5lY3Rpb25Db250cm9sbGVyJyk7Cgp2YXIgX0Nvbm5lY3Rpb25Db250cm9sbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0Nvbm5lY3Rpb25Db250cm9sbGVyKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0gLyoqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCnZhciBDb25uZWN0aW9uID0gZnVuY3Rpb24gQ29ubmVjdGlvbihkYXRhT2JqZWN0VXJsKSB7CglfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29ubmVjdGlvbik7CgoJdGhpcy5uYW1lID0gJ0Nvbm5lY3Rpb24nOwoJdGhpcy5zdGF0dXMgPSAnJzsKCXRoaXMub3duZXIgPSBkYXRhT2JqZWN0VXJsOwoJdGhpcy5jb25uZWN0aW9uRGVzY3JpcHRpb24gPSB7fTsKCXRoaXMuaWNlQ2FuZGlkYXRlcyA9IFtdOwp9OwoKLyoqCiAqIFByb3RvU3R1YiBJbnRlcmZhY2UKICovCgoKdmFyIElNU0lXUHJvdG9TdHViID0gZnVuY3Rpb24gKCkgewoKCS8qKgogICogSW5pdGlhbGlzZSB0aGUgcHJvdG9jb2wgc3R1YiBpbmNsdWRpbmcgYXMgaW5wdXQgcGFyYW1ldGVycyBpdHMgYWxsb2NhdGVkCiAgKiBjb21wb25lbnQgcnVudGltZSB1cmwsIHRoZSBydW50aW1lIEJVUyBwb3N0TWVzc2FnZSBmdW5jdGlvbiB0byBiZSBpbnZva2VkCiAgKiBvbiBtZXNzYWdlcyByZWNlaXZlZCBieSB0aGUgcHJvdG9jb2wgc3R1YiBhbmQgcmVxdWlyZWQgY29uZmlndXJhdGlvbiByZXRyaWV2ZWQgZnJvbSBwcm90b2NvbFN0dWIgZGVzY3JpcHRvci4KICAqIEBwYXJhbSAge1VSTC5ydW50aW1lUHJvdG9TdHViVVJMfSAgICAgICAgICAgICAgICAgICBydW50aW1lUHJvdG9TdHViVVJMIHJ1bnRpbWVQcm90b1N1YlVSTAogICogQHBhcmFtICB7TWVzc2FnZS5NZXNzYWdlfSAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1c1Bvc3RNZXNzYWdlICAgICBjb25maWd1cmF0aW9uCiAgKiBAcGFyYW0gIHtQcm90b1N0dWJEZXNjcmlwdG9yLkNvbmZpZ3VyYXRpb25EYXRhTGlzdH0gY29uZmlndXJhdGlvbiAgICAgIGNvbmZpZ3VyYXRpb24KICAqLwoJZnVuY3Rpb24gSU1TSVdQcm90b1N0dWIocnVudGltZVByb3RvU3R1YlVSTCwgbWluaUJ1cywgY29uZmlndXJhdGlvbikgewoJCXZhciBfdGhpcyA9IHRoaXM7CgoJCV9jbGFzc0NhbGxDaGVjayh0aGlzLCBJTVNJV1Byb3RvU3R1Yik7CgoJCWlmICghcnVudGltZVByb3RvU3R1YlVSTCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgcnVudGltZVByb3RvU3R1YlVSTCBpcyBhIHJlcXVpcmVkIHBhcmFtZXRlcicpOwoJCWlmICghbWluaUJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyJyk7CgkJaWYgKCFjb25maWd1cmF0aW9uKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWd1cmF0aW9uIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyJyk7CgoJCXRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgPSBydW50aW1lUHJvdG9TdHViVVJMOwoJCXRoaXMuX2Rpc2NvdmVyeSA9IG5ldyBfRGlzY292ZXJ5Mi5kZWZhdWx0KHJ1bnRpbWVQcm90b1N0dWJVUkwsIG1pbmlCdXMpOwoJCXRoaXMuX2Nvbm5lY3Rpb24gPSBuZXcgX0Nvbm5lY3Rpb25Db250cm9sbGVyMi5kZWZhdWx0KGNvbmZpZ3VyYXRpb24sIGZ1bmN0aW9uICh0bywgb2ZmZXIpIHsKCQkJX3RoaXMuX3JldHVyblNEUChvZmZlciwgX3RoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwsIF90aGlzLnNjaGVtYSwgX3RoaXMuc291cmNlLCAnb2ZmZXInKTsKCQl9LCBmdW5jdGlvbiAoKSB7CgkJCV90aGlzLmRhdGFPYmplY3RPYnNlcnZlci5kZWxldGUoKTsKCQkJX3RoaXMuZGF0YU9iamVjdFJlcG9ydGVyLmRlbGV0ZSgpOwoJCX0pOwoJCXRoaXMuX2J1cyA9IG1pbmlCdXM7CgkJdGhpcy5fc3luY2hlciA9IG5ldyBfU3luY2hlci5TeW5jaGVyKHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwsIG1pbmlCdXMsIGNvbmZpZ3VyYXRpb24pOwoKCQltaW5pQnVzLmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24gKG1zZykgewoJCQljb25zb2xlLmxvZygnTkVXIE1TRyAtPicsIG1zZyk7CgkJCXN3aXRjaCAobXNnLnR5cGUpIHsKCQkJCWNhc2UgJ2NyZWF0ZSc6CgkJCQkJaWYgKF90aGlzLl9maWx0ZXIobXNnKSAmJiBtc2cuYm9keS5zY2hlbWEpIHsKCQkJCQkJX3RoaXMuX3N1YnNjcmliZShtc2cpOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgJ2luaXQnOgoJCQkJCV90aGlzLl9jb25uZWN0aW9uLmNvbm5lY3QobXNnLmJvZHkuaWRlbnRpdHkuYWNjZXNzX3Rva2VuKTsKCQkJCQlfdGhpcy5zb3VyY2UgPSBtc2cuYm9keS5zb3VyY2U7CgkJCQkJX3RoaXMuc2NoZW1hID0gbXNnLmJvZHkuc2NoZW1hOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAnZGVsZXRlJzoKCQkJCQlfdGhpcy5fY29ubmVjdGlvbi5kaXNjb25uZWN0KCk7CgkJCQkJYnJlYWs7CgkJCX0KCQl9KTsKCX0KCglfY3JlYXRlQ2xhc3MoSU1TSVdQcm90b1N0dWIsIFt7CgkJa2V5OiAnX3N1YnNjcmliZScsCgkJdmFsdWU6IGZ1bmN0aW9uIF9zdWJzY3JpYmUobXNnKSB7CgkJCXZhciBfdGhpczIgPSB0aGlzOwoKCQkJdmFyIGRhdGFPYmplY3RVcmwgPSBtc2cuZnJvbS5zdWJzdHJpbmcoMCwgbXNnLmZyb20ubGFzdEluZGV4T2YoJy8nKSk7CgoJCQl0aGlzLl9zeW5jaGVyLnN1YnNjcmliZSh0aGlzLnNjaGVtYSwgZGF0YU9iamVjdFVybCkudGhlbihmdW5jdGlvbiAoZGF0YU9iamVjdE9ic2VydmVyKSB7CgkJCQlfdGhpczIuZGF0YU9iamVjdE9ic2VydmVyID0gZGF0YU9iamVjdE9ic2VydmVyOwoJCQkJZGF0YU9iamVjdE9ic2VydmVyLm9uQ2hhbmdlKCcqJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJCQkJcmV0dXJuIF90aGlzMi5fb25DYWxsKGRhdGFPYmplY3RPYnNlcnZlciwgZGF0YU9iamVjdFVybCwgX3RoaXMyLnNjaGVtYSwgbXNnKTsKCQkJCX0pOwoJCQkJcmV0dXJuIGRhdGFPYmplY3RPYnNlcnZlcjsKCQkJfSkudGhlbihmdW5jdGlvbiAoZGF0YU9iamVjdE9ic2VydmVyKSB7CgkJCQlyZXR1cm4gX3RoaXMyLl9vbkNhbGwoZGF0YU9iamVjdE9ic2VydmVyLCBkYXRhT2JqZWN0VXJsLCBfdGhpczIuc2NoZW1hLCBtc2cpOwoJCQl9KTsKCQl9Cgl9LCB7CgkJa2V5OiAnX29uQ2FsbCcsCgkJdmFsdWU6IGZ1bmN0aW9uIF9vbkNhbGwoZGF0YU9iamVjdE9ic2VydmVyLCBkYXRhT2JqZWN0VXJsLCBzY2hlbWEsIG1zZykgewoJCQl2YXIgX3RoaXMzID0gdGhpczsKCgkJCWNvbnNvbGUubG9nKCdfb25DYWxsJywgZGF0YU9iamVjdE9ic2VydmVyKTsKCQkJaWYgKGRhdGFPYmplY3RPYnNlcnZlci5kYXRhLmNvbm5lY3Rpb25EZXNjcmlwdGlvbikgewoJCQkJaWYgKGRhdGFPYmplY3RPYnNlcnZlci5kYXRhLmNvbm5lY3Rpb25EZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInKSB7CgkJCQkJY29uc29sZS5sb2coJ19vbkNhbGxVcGRhdGUgb2ZmZXInKTsKCQkJCQl0aGlzLl9jb25uZWN0aW9uLmNvbm5lY3QobXNnLmJvZHkuaWRlbnRpdHkuYWNjZXNzX3Rva2VuKS50aGVuKGZ1bmN0aW9uICgpIHsKCQkJCQkJX3RoaXMzLl9jb25uZWN0aW9uLmludml0ZShtc2cudG8sIGRhdGFPYmplY3RPYnNlcnZlcikudGhlbihmdW5jdGlvbiAoZSkgewoJCQkJCQkJcmV0dXJuIF90aGlzMy5fcmV0dXJuU0RQKGUuYm9keSwgZGF0YU9iamVjdFVybCwgc2NoZW1hLCBtc2cuYm9keS5zb3VyY2UsICdhbnN3ZXInKTsKCQkJCQkJfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKCQkJCQkJCWNvbnNvbGUubG9nKCdmYWlsJywgZSk7X3RoaXMzLmRhdGFPYmplY3RPYnNlcnZlci5kZWxldGUoKTsKCQkJCQkJfSk7CgkJCQkJfSk7CgkJCQl9IGVsc2UgaWYgKGRhdGFPYmplY3RPYnNlcnZlci5kYXRhLmNvbm5lY3Rpb25EZXNjcmlwdGlvbi50eXBlID09PSAnYW5zd2VyJykgewoJCQkJCWNvbnNvbGUubG9nKCdfb25DYWxsVXBkYXRlIG9mZmVyJyk7CgkJCQkJdGhpcy5fY29ubmVjdGlvbi5hY2NlcHQoZGF0YU9iamVjdE9ic2VydmVyKTsKCQkJCX0KCQkJfQoJCX0KCX0sIHsKCQlrZXk6ICdfcmV0dXJuU0RQJywKCQl2YWx1ZTogZnVuY3Rpb24gX3JldHVyblNEUChvZmZlciwgZGF0YU9iamVjdFVybCwgc2NoZW1hLCBzb3VyY2UsIHR5cGUpIHsKCQkJdmFyIF90aGlzNCA9IHRoaXM7CgoJCQl2YXIgZGF0YU9iamVjdCA9IG5ldyBDb25uZWN0aW9uKGRhdGFPYmplY3RVcmwpOwoKCQkJdGhpcy5fc3luY2hlci5jcmVhdGUoc2NoZW1hLCBbc291cmNlXSwgZGF0YU9iamVjdCkudGhlbihmdW5jdGlvbiAob2JqUmVwb3J0ZXIpIHsKCQkJCV90aGlzNC5kYXRhT2JqZWN0UmVwb3J0ZXIgPSBvYmpSZXBvcnRlcjsKCQkJCW9ialJlcG9ydGVyLm9uU3Vic2NyaXB0aW9uKGZ1bmN0aW9uIChldmVudCkgewoJCQkJCWNvbnNvbGUuaW5mbygnLS0tLS0tLS0gUmVjZWl2ZXIgcmVjZWl2ZWQgc3Vic2NyaXB0aW9uIHJlcXVlc3QgLS0tLS0tLS0tIFxuJyk7CgkJCQkJZXZlbnQuYWNjZXB0KCk7CgkJCQl9KTsKCQkJCW9ialJlcG9ydGVyLmRhdGEuY29ubmVjdGlvbkRlc2NyaXB0aW9uID0geyB0eXBlOiB0eXBlLCBzZHA6IG9mZmVyIH07CgkJCX0pOwoJCX0KCX0sIHsKCQlrZXk6ICdfZmlsdGVyJywKCQl2YWx1ZTogZnVuY3Rpb24gX2ZpbHRlcihtc2cpIHsKCQkJaWYgKG1zZy5ib2R5ICYmIG1zZy5ib2R5LnZpYSA9PT0gdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCkgcmV0dXJuIGZhbHNlOwoJCQlyZXR1cm4gdHJ1ZTsKCQl9Cgl9XSk7CgoJcmV0dXJuIElNU0lXUHJvdG9TdHViOwp9KCk7CgpmdW5jdGlvbiBhY3RpdmF0ZSh1cmwsIGJ1cywgY29uZmlnKSB7CglyZXR1cm4gewoJCW5hbWU6ICdJTVNJV1Byb3RvU3R1YicsCgkJaW5zdGFuY2U6IG5ldyBJTVNJV1Byb3RvU3R1Yih1cmwsIGJ1cywgY29uZmlnKQoJfTsKfQptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuL0Nvbm5lY3Rpb25Db250cm9sbGVyIjo0Mywic2VydmljZS1mcmFtZXdvcmsvZGlzdC9EaXNjb3ZlcnkiOjYsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlciI6N31dLDQ1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9zaXAgPSByZXF1aXJlKCdzaXAuanMnKTsKCnZhciBfc2lwMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NpcCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKdmFyIFNlc3Npb24gPSBfc2lwMi5kZWZhdWx0LlNlc3Npb247CnZhciBDID0gewogIFNUQVRVU19OVUxMOiAwLAogIFNUQVRVU19JTlZJVEVfU0VOVDogMSwKICBTVEFUVVNfMVhYX1JFQ0VJVkVEOiAyLAogIFNUQVRVU19JTlZJVEVfUkVDRUlWRUQ6IDMsCiAgU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUjogNCwKICBTVEFUVVNfQU5TV0VSRUQ6IDUsCiAgU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLOiA2LAogIFNUQVRVU19XQUlUSU5HX0ZPUl9BQ0s6IDcsCiAgU1RBVFVTX0NBTkNFTEVEOiA4LAogIFNUQVRVU19URVJNSU5BVEVEOiA5LAogIFNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSzogMTAsCiAgU1RBVFVTX0VBUkxZX01FRElBOiAxMSwKICBTVEFUVVNfQ09ORklSTUVEOiAxMgp9OwoKdmFyIEludml0ZUNsaWVudENvbnRleHQgPSBmdW5jdGlvbiBJbnZpdGVDbGllbnRDb250ZXh0KHVhLCB0YXJnZXQsIG9wdGlvbnMpIHsKICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShTZXNzaW9uLmRlc3VnYXIob3B0aW9ucykpOwogIG9wdGlvbnMucGFyYW1zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zLnBhcmFtcyB8fCBPYmplY3QucHJvdG90eXBlKTsKCiAgdmFyIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKCiAgLy8gQ3VzdG9tIGRhdGEgdG8gYmUgc2VudCBlaXRoZXIgaW4gSU5WSVRFIG9yIGluIEFDSwogIHRoaXMucmVuZGVyYm9keSA9IG9wdGlvbnMucmVuZGVyYm9keSB8fCBudWxsOwogIHRoaXMucmVuZGVydHlwZSA9IG9wdGlvbnMucmVuZGVydHlwZSB8fCAndGV4dC9wbGFpbic7CgogIHRoaXMuc2RwID0gb3B0aW9ucy5zZHA7CiAgb3B0aW9ucy5wYXJhbXMuZnJvbV90YWcgPSB0aGlzLmZyb21fdGFnOwoKICAvKiBEbyBub3QgYWRkIDtvYiBpbiBpbml0aWFsIGZvcm1pbmcgZGlhbG9nIHJlcXVlc3RzIGlmIHRoZSByZWdpc3RyYXRpb24gb3ZlcgogICAqICB0aGUgY3VycmVudCBjb25uZWN0aW9uIGdvdCBhIEdSVVUgVVJJLgogICAqLwogIHRoaXMuY29udGFjdCA9IHVhLmNvbnRhY3QudG9TdHJpbmcoewogICAgYW5vbnltb3VzOiB0aGlzLmFub255bW91cywKICAgIG91dGJvdW5kOiB0aGlzLmFub255bW91cyA/ICF1YS5jb250YWN0LnRlbXBfZ3J1dSA6ICF1YS5jb250YWN0LnB1Yl9ncnV1CiAgfSk7CgogIGV4dHJhSGVhZGVycy5wdXNoKCdDb250YWN0OiAnICsgdGhpcy5jb250YWN0KTsKICBleHRyYUhlYWRlcnMucHVzaCgnQWxsb3c6ICcgKyBfc2lwMi5kZWZhdWx0LlVBLkMuQUxMT1dFRF9NRVRIT0RTLnRvU3RyaW5nKCkpOwoKICBpZiAodWEuY29uZmlndXJhdGlvbi5yZWwxMDAgPT09IF9zaXAyLmRlZmF1bHQuQy5zdXBwb3J0ZWQuUkVRVUlSRUQpIHsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZXF1aXJlOiAxMDByZWwnKTsKICB9CiAgaWYgKHVhLmNvbmZpZ3VyYXRpb24ucmVwbGFjZXMgPT09IF9zaXAyLmRlZmF1bHQuQy5zdXBwb3J0ZWQuUkVRVUlSRUQpIHsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZXF1aXJlOiByZXBsYWNlcycpOwogIH0KICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9zZHAnKTsKICBvcHRpb25zLmV4dHJhSGVhZGVycyA9IGV4dHJhSGVhZGVyczsKCiAgX3NpcDIuZGVmYXVsdC5VdGlscy5hdWdtZW50KHRoaXMsIF9zaXAyLmRlZmF1bHQuQ2xpZW50Q29udGV4dCwgW3VhLCBfc2lwMi5kZWZhdWx0LkMuSU5WSVRFLCB0YXJnZXQsIG9wdGlvbnNdKTsKICBfc2lwMi5kZWZhdWx0LlV0aWxzLmF1Z21lbnQodGhpcywgX3NpcDIuZGVmYXVsdC5TZXNzaW9uLCBbXSk7CgogIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19OVUxMKSB7CiAgICB0aHJvdyBuZXcgX3NpcDIuZGVmYXVsdC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICB9CgogIC8vIFNlc3Npb24gcGFyYW1ldGVyIGluaXRpYWxpemF0aW9uCiAgdGhpcy5mcm9tX3RhZyA9IF9zaXAyLmRlZmF1bHQuVXRpbHMubmV3VGFnKCk7CgogIC8vIE91dGdvaW5nU2Vzc2lvbiBzcGVjaWZpYyBwYXJhbWV0ZXJzCiAgdGhpcy5pc0NhbmNlbGVkID0gZmFsc2U7CiAgdGhpcy5yZWNlaXZlZF8xMDAgPSBmYWxzZTsKCiAgdGhpcy5tZXRob2QgPSBfc2lwMi5kZWZhdWx0LkMuSU5WSVRFOwoKICB0aGlzLnJlY2VpdmVOb25JbnZpdGVSZXNwb25zZSA9IHRoaXMucmVjZWl2ZVJlc3BvbnNlOwogIHRoaXMucmVjZWl2ZVJlc3BvbnNlID0gdGhpcy5yZWNlaXZlSW52aXRlUmVzcG9uc2U7CgogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAuaW52aXRlY2xpZW50Y29udGV4dCcpOwoKICB0aGlzLm9uSW5mbyA9IG9wdGlvbnMub25JbmZvOwp9OwoKSW52aXRlQ2xpZW50Q29udGV4dC5wcm90b3R5cGUgPSB7CiAgaW52aXRlOiBmdW5jdGlvbiBpbnZpdGUoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgLy9TYXZlIHRoZSBzZXNzaW9uIGludG8gdGhlIHVhIHNlc3Npb25zIGNvbGxlY3Rpb24uCiAgICAvL05vdGU6IHBsYWNpbmcgaW4gY29uc3RydWN0b3IgYnJlYWtzIGNhbGwgdG8gcmVxdWVzdC5jYW5jZWwgb24gY2xvc2UuLi4gVXNlciBkb2VzIG5vdCBuZWVkIHRoaXMgYW55d2F5CiAgICB0aGlzLnVhLnNlc3Npb25zW3RoaXMuaWRdID0gdGhpczsKCiAgICAvL05vdGU6IGR1ZSB0byB0aGUgd2F5IEZpcmVmb3ggaGFuZGxlcyBnVU0gY2FsbHMsIGl0IGlzIHJlY29tbWVuZGVkIHRvIG1ha2UgdGhlIGdVTSBjYWxsIGF0IHRoZSBhcHAgbGV2ZWwKICAgIC8vIGFuZCBoYW5kIHNpcC5qcyBhIHN0cmVhbSBhcyB0aGUgbWVkaWFIaW50CiAgICBpZiAoc2VsZi5pc0NhbmNlbGVkIHx8IHNlbGYuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHNlbGYuaGFzT2ZmZXIgPSB0cnVlOwogICAgc2VsZi5yZXF1ZXN0LmJvZHkgPSB0aGlzLnNkcDsKICAgIHNlbGYuc3RhdHVzID0gQy5TVEFUVVNfSU5WSVRFX1NFTlQ7CiAgICBzZWxmLnNlbmQoKTsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICBoYXNEZXNjcmlwdGlvbjogZnVuY3Rpb24gaGFzRGVzY3JpcHRpb24obWVzc2FnZSkgewogICAgcmV0dXJuIG1lc3NhZ2UuZ2V0SGVhZGVyKCdDb250ZW50LVR5cGUnKSA9PT0gJ2FwcGxpY2F0aW9uL3NkcCcgJiYgISFtZXNzYWdlLmJvZHk7CiAgfSwKCiAgcmVjZWl2ZUludml0ZVJlc3BvbnNlOiBmdW5jdGlvbiByZWNlaXZlSW52aXRlUmVzcG9uc2UocmVzcG9uc2UpIHsKICAgIHZhciBjYXVzZSwKICAgICAgICAvL2xvY2FsTWVkaWEsCiAgICBzZXNzaW9uID0gdGhpcywKICAgICAgICBpZCA9IHJlc3BvbnNlLmNhbGxfaWQgKyByZXNwb25zZS5mcm9tX3RhZyArIHJlc3BvbnNlLnRvX3RhZywKICAgICAgICBleHRyYUhlYWRlcnMgPSBbXSwKICAgICAgICBvcHRpb25zID0ge307CgogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEIHx8IHJlc3BvbnNlLm1ldGhvZCAhPT0gX3NpcDIuZGVmYXVsdC5DLklOVklURSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHRoaXMuZGlhbG9nICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNfY29kZSA8PSAyOTkpIHsKICAgICAgaWYgKGlkICE9PSB0aGlzLmRpYWxvZy5pZC50b1N0cmluZygpKSB7CiAgICAgICAgaWYgKCF0aGlzLmNyZWF0ZURpYWxvZyhyZXNwb25zZSwgJ1VBQycsIHRydWUpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5zZW5kUmVxdWVzdCh0aGlzLCBfc2lwMi5kZWZhdWx0LkMuQUNLLCB7CiAgICAgICAgICBib2R5OiBfc2lwMi5kZWZhdWx0LlV0aWxzLmdlbmVyYXRlRmFrZVNEUChyZXNwb25zZS5ib2R5KQogICAgICAgIH0pOwogICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5zZW5kUmVxdWVzdCh0aGlzLCBfc2lwMi5kZWZhdWx0LkMuQllFKTsKCiAgICAgICAgLyogTk9URTogVGhpcyBmYWlscyBiZWNhdXNlIHRoZSBmb3JraW5nIHByb3h5IGRvZXMgbm90IHJlY29nbml6ZSB0aGF0IGFuIHVuYW5zd2VyYWJsZQogICAgICAgICAqIGxlZyAoZHVlIHRvIHBlZXJDb25uZWN0aW9uIGxpbWl0YXRpb25zKSBoYXMgYmVlbiBhbnN3ZXJlZCBmaXJzdC4gSWYgeW91ciBmb3JraW5nCiAgICAgICAgICogcHJveHkgZG9lcyBub3QgaGFuZyB1cCBhbGwgdW5hbnN3ZXJlZCBicmFuY2hlcyBvbiB0aGUgZmlyc3QgYnJhbmNoIGFuc3dlcmVkLCByZW1vdmUgdGhpcy4KICAgICAgICAgKi8KICAgICAgICBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICAgIHRoaXMudGVybWluYXRlZChyZXNwb25zZSwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5XRUJSVENfRVJST1IpOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoX3NpcDIuZGVmYXVsdC5DLkFDSywgeyBjc2VxOiByZXNwb25zZS5jc2VxIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy5oYXNBbnN3ZXIpIHsKICAgICAgICAvLyBpbnZpdGUgdy9vIHNkcCBpcyB3YWl0aW5nIGZvciBjYWxsYmFjawogICAgICAgIC8vYW4gaW52aXRlIHdpdGggc2RwIG11c3QgZ28gb24sIGFuZCBoYXNBbnN3ZXIgaXMgdHJ1ZQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQoKICAgIGlmICh0aGlzLmRpYWxvZyAmJiByZXNwb25zZS5zdGF0dXNfY29kZSA8IDIwMCkgewogICAgICAvKgogICAgICAgIEVhcmx5IG1lZGlhIGhhcyBiZWVuIHNldCB1cCB3aXRoIGF0IGxlYXN0IG9uZSBvdGhlciBkaWZmZXJlbnQgYnJhbmNoLAogICAgICAgIGJ1dCBhIGZpbmFsIDJ4eCByZXNwb25zZSBoYXNuJ3QgYmVlbiByZWNlaXZlZAogICAgICAqLwogICAgICBpZiAodGhpcy5kaWFsb2cucHJhY2tlZC5pbmRleE9mKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKSAhPT0gLTEgfHwgdGhpcy5kaWFsb2cucHJhY2tlZFt0aGlzLmRpYWxvZy5wcmFja2VkLmxlbmd0aCAtIDFdID49IHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpICYmIHRoaXMuZGlhbG9nLnByYWNrZWQubGVuZ3RoID4gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmVhcmx5RGlhbG9nc1tpZF0gJiYgIXRoaXMuY3JlYXRlRGlhbG9nKHJlc3BvbnNlLCAnVUFDJywgdHJ1ZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5pbmRleE9mKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKSAhPT0gLTEgfHwgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWRbdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQubGVuZ3RoIC0gMV0gPj0gcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgJiYgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQubGVuZ3RoID4gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JBY2s6ICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSArICcgJyArIHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKTsKICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQucHVzaChyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSk7CgogICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0uc2VuZFJlcXVlc3QodGhpcywgX3NpcDIuZGVmYXVsdC5DLlBSQUNLLCB7CiAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICAgICAgYm9keTogX3NpcDIuZGVmYXVsdC5VdGlscy5nZW5lcmF0ZUZha2VTRFAocmVzcG9uc2UuYm9keSkKICAgICAgfSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICAvLyBQcm9jZWVkIHRvIGNhbmNlbGxhdGlvbiBpZiB0aGUgdXNlciByZXF1ZXN0ZWQuCiAgICBpZiAodGhpcy5pc0NhbmNlbGVkKSB7CiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNfY29kZSA+PSAxMDAgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPCAyMDApIHsKICAgICAgICB0aGlzLnJlcXVlc3QuY2FuY2VsKHRoaXMuY2FuY2VsUmVhc29uLCBleHRyYUhlYWRlcnMpOwogICAgICAgIHRoaXMuY2FuY2VsZWQobnVsbCk7CiAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzX2NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlIDwgMjk5KSB7CiAgICAgICAgdGhpcy5hY2NlcHRBbmRUZXJtaW5hdGUocmVzcG9uc2UpOwogICAgICAgIHRoaXMuZW1pdCgnYnllJywgdGhpcy5yZXF1ZXN0KTsKICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXNfY29kZSA+PSAzMDApIHsKICAgICAgICBjYXVzZSA9IF9zaXAyLmRlZmF1bHQuQy5SRUFTT05fUEhSQVNFW3Jlc3BvbnNlLnN0YXR1c19jb2RlXSB8fCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkNBTkNFTEVEOwogICAgICAgIHRoaXMucmVqZWN0ZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgY2F1c2UpOwogICAgICAgIHRoaXMudGVybWluYXRlZChyZXNwb25zZSwgY2F1c2UpOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzd2l0Y2ggKHRydWUpIHsKICAgICAgY2FzZSAvXjEwMCQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgIHRoaXMucmVjZWl2ZWRfMTAwID0gdHJ1ZTsKICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIC9eMVswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgLy8gRG8gbm90aGluZyB3aXRoIDF4eCByZXNwb25zZXMgd2l0aG91dCBUbyB0YWcuCiAgICAgICAgaWYgKCFyZXNwb25zZS50b190YWcpIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJzF4eCByZXNwb25zZSByZWNlaXZlZCB3aXRob3V0IHRvIHRhZycpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICAvLyBDcmVhdGUgRWFybHkgRGlhbG9nIGlmIDFYWCBjb21lcyB3aXRoIGNvbnRhY3QKICAgICAgICBpZiAocmVzcG9uc2UuaGFzSGVhZGVyKCdjb250YWN0JykpIHsKICAgICAgICAgIC8vIEFuIGVycm9yIG9uIGRpYWxvZyBjcmVhdGlvbiB3aWxsIGZpcmUgJ2ZhaWxlZCcgZXZlbnQKICAgICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnLCB0cnVlKSkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfMVhYX1JFQ0VJVkVEOwoKICAgICAgICBpZiAocmVzcG9uc2UuaGFzSGVhZGVyKCdyZXF1aXJlJykgJiYgcmVzcG9uc2UuZ2V0SGVhZGVyKCdyZXF1aXJlJykuaW5kZXhPZignMTAwcmVsJykgIT09IC0xKSB7CgogICAgICAgICAgLy8gRG8gbm90aGluZyBpZiB0aGlzLmRpYWxvZyBpcyBhbHJlYWR5IGNvbmZpcm1lZAogICAgICAgICAgaWYgKHRoaXMuZGlhbG9nIHx8ICF0aGlzLmVhcmx5RGlhbG9nc1tpZF0pIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLmluZGV4T2YocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpICE9PSAtMSB8fCB0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZFt0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5sZW5ndGggLSAxXSA+PSByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSAmJiB0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIXRoaXMuaGFzRGVzY3JpcHRpb24ocmVzcG9uc2UpKSB7CiAgICAgICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSQWNrOiAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgKyAnICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ2NzZXEnKSk7CiAgICAgICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLnB1c2gocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpOwogICAgICAgICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0uc2VuZFJlcXVlc3QodGhpcywgX3NpcDIuZGVmYXVsdC5DLlBSQUNLLCB7CiAgICAgICAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaGFzT2ZmZXIpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLmNyZWF0ZURpYWxvZyhyZXNwb25zZSwgJ1VBQycpKSB7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5oYXNBbnN3ZXIgPSB0cnVlOwogICAgICAgICAgICB0aGlzLmRpYWxvZy5wcmFja2VkLnB1c2gocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpOwoKICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JBY2s6ICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSArICcgJyArIHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKTsKCiAgICAgICAgICAgIHNlc3Npb24uc2VuZFJlcXVlc3QoX3NpcDIuZGVmYXVsdC5DLlBSQUNLLCB7CiAgICAgICAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICAgICAgICAgICAgcmVjZWl2ZVJlc3BvbnNlOiBmdW5jdGlvbiByZWNlaXZlUmVzcG9uc2UoKSB7fQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc2Vzc2lvbi5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgICAgc2Vzc2lvbi5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgL14yWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgICB2YXIgY3NlcSA9IHRoaXMucmVxdWVzdC5jc2VxICsgJyAnICsgdGhpcy5yZXF1ZXN0Lm1ldGhvZDsKICAgICAgICBpZiAoY3NlcSAhPT0gcmVzcG9uc2UuZ2V0SGVhZGVyKCdjc2VxJykpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19FQVJMWV9NRURJQSAmJiB0aGlzLmRpYWxvZykgewogICAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgICAgICBvcHRpb25zID0ge307CiAgICAgICAgICBpZiAodGhpcy5yZW5kZXJib2R5KSB7CiAgICAgICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6ICcgKyB0aGlzLnJlbmRlcnR5cGUpOwogICAgICAgICAgICBvcHRpb25zLmV4dHJhSGVhZGVycyA9IGV4dHJhSGVhZGVyczsKICAgICAgICAgICAgb3B0aW9ucy5ib2R5ID0gdGhpcy5yZW5kZXJib2R5OwogICAgICAgICAgfQogICAgICAgICAgb3B0aW9ucy5jc2VxID0gcmVzcG9uc2UuY3NlcTsKICAgICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoX3NpcDIuZGVmYXVsdC5DLkFDSywgb3B0aW9ucyk7CiAgICAgICAgICB0aGlzLmFjY2VwdGVkKHJlc3BvbnNlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICAvLyBEbyBub3RoaW5nIGlmIHRoaXMuZGlhbG9nIGlzIGFscmVhZHkgY29uZmlybWVkCiAgICAgICAgaWYgKHRoaXMuZGlhbG9nKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmhhc0Fuc3dlcikgewogICAgICAgICAgaWYgKHRoaXMucmVuZGVyYm9keSkgewogICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgc2Vzc2lvbi5yZW5kZXJ0eXBlKTsKICAgICAgICAgICAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSBleHRyYUhlYWRlcnM7CiAgICAgICAgICAgIG9wdGlvbnMuYm9keSA9IHRoaXMucmVuZGVyYm9keTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoX3NpcDIuZGVmYXVsdC5DLkFDSywgb3B0aW9ucyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICghdGhpcy5oYXNEZXNjcmlwdGlvbihyZXNwb25zZSkpIHsKICAgICAgICAgICAgdGhpcy5hY2NlcHRBbmRUZXJtaW5hdGUocmVzcG9uc2UsIDQwMCwgJ01pc3Npbmcgc2Vzc2lvbiBkZXNjcmlwdGlvbicpOwogICAgICAgICAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnKSkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgICAgIHZhciBvcHRpb25zID0ge307IC8vLGxvY2FsTWVkaWE7CiAgICAgICAgICBzZXNzaW9uLnN0YXR1cyA9IEMuU1RBVFVTX0NPTkZJUk1FRDsKICAgICAgICAgIGlmIChzZXNzaW9uLnJlbmRlcmJvZHkpIHsKICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRlbnQtVHlwZTogJyArIHNlc3Npb24ucmVuZGVydHlwZSk7CiAgICAgICAgICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzID0gZXh0cmFIZWFkZXJzOwogICAgICAgICAgICBvcHRpb25zLmJvZHkgPSBzZXNzaW9uLnJlbmRlcmJvZHk7CiAgICAgICAgICB9CiAgICAgICAgICBvcHRpb25zLmNzZXEgPSByZXNwb25zZS5jc2VxOwogICAgICAgICAgc2Vzc2lvbi5zZW5kUmVxdWVzdChfc2lwMi5kZWZhdWx0LkMuQUNLLCBvcHRpb25zKTsKICAgICAgICAgIHNlc3Npb24uYWNjZXB0ZWQocmVzcG9uc2UpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICBjYXVzZSA9IF9zaXAyLmRlZmF1bHQuVXRpbHMuc2lwRXJyb3JDYXVzZShyZXNwb25zZS5zdGF0dXNfY29kZSk7CiAgICAgICAgdGhpcy5yZWplY3RlZChyZXNwb25zZSwgY2F1c2UpOwogICAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICB9CiAgfSwKCiAgY2FuY2VsOiBmdW5jdGlvbiBjYW5jZWwob3B0aW9ucykgewogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgogICAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCk7CgogICAgLy8gQ2hlY2sgU2Vzc2lvbiBTdGF0dXMKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRocm93IG5ldyBfc2lwMi5kZWZhdWx0LkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogICAgfQoKICAgIHRoaXMubG9nZ2VyLmxvZygnY2FuY2VsaW5nIFJUQ1Nlc3Npb24nKTsKCiAgICB2YXIgY2FuY2VsX3JlYXNvbiA9IF9zaXAyLmRlZmF1bHQuVXRpbHMuZ2V0Q2FuY2VsUmVhc29uKG9wdGlvbnMuc3RhdHVzX2NvZGUsIG9wdGlvbnMucmVhc29uX3BocmFzZSk7CgogICAgLy8gQ2hlY2sgU2Vzc2lvbiBTdGF0dXMKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfTlVMTCB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfSU5WSVRFX1NFTlQgJiYgIXRoaXMucmVjZWl2ZWRfMTAwKSB7CiAgICAgIHRoaXMuaXNDYW5jZWxlZCA9IHRydWU7CiAgICAgIHRoaXMuY2FuY2VsUmVhc29uID0gY2FuY2VsX3JlYXNvbjsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0lOVklURV9TRU5UIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU18xWFhfUkVDRUlWRUQgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0VBUkxZX01FRElBKSB7CiAgICAgIHRoaXMucmVxdWVzdC5jYW5jZWwoY2FuY2VsX3JlYXNvbiwgb3B0aW9ucy5leHRyYUhlYWRlcnMpOwogICAgfQoKICAgIHJldHVybiB0aGlzLmNhbmNlbGVkKCk7CiAgfSwKCiAgdGVybWluYXRlOiBmdW5jdGlvbiB0ZXJtaW5hdGUob3B0aW9ucykgewogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy5ieWUob3B0aW9ucyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmNhbmNlbChvcHRpb25zKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9LAoKICByZWNlaXZlUmVxdWVzdDogZnVuY3Rpb24gcmVjZWl2ZVJlcXVlc3QocmVxdWVzdCkgewogICAgLy8gSUNDIFJFQ0VJVkUgUkVRVUVTVAoKICAgIC8vIFJlamVjdCBDQU5DRUxzCiAgICBpZiAocmVxdWVzdC5tZXRob2QgPT09IF9zaXAyLmRlZmF1bHQuQy5DQU5DRUwpIHsKICAgICAgLy8gVE9ETzsgbWFrZSB0aGlzIGEgc3dpdGNoIHdoZW4gaXQgZ2V0cyBhZGRlZAogICAgfQoKICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gX3NpcDIuZGVmYXVsdC5DLkFDSyAmJiB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLKSB7CiAgICAgIF9zaXAyLmRlZmF1bHQuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5hY2tUaW1lcik7CiAgICAgIF9zaXAyLmRlZmF1bHQuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5pbnZpdGUyeHhUaW1lcik7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwoKICAgICAgdGhpcy5hY2NlcHRlZCgpOwogICAgfQoKICAgIHJldHVybiBTZXNzaW9uLnByb3RvdHlwZS5yZWNlaXZlUmVxdWVzdC5hcHBseSh0aGlzLCBbcmVxdWVzdF0pOwogIH0sCgogIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uIG9uVHJhbnNwb3J0RXJyb3IoKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX0NPTkZJUk1FRCAmJiB0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICB0aGlzLmZhaWxlZChudWxsLCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkNPTk5FQ1RJT05fRVJST1IpOwogICAgfQogIH0sCgogIG9uUmVxdWVzdFRpbWVvdXQ6IGZ1bmN0aW9uIG9uUmVxdWVzdFRpbWVvdXQoKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICB0aGlzLmZhaWxlZChudWxsLCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICB9CiAgfQoKfTsKCmV4cG9ydHMuZGVmYXVsdCA9IEludml0ZUNsaWVudENvbnRleHQ7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7InNpcC5qcyI6NDJ9XSw0NjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfc2lwID0gcmVxdWlyZSgnc2lwLmpzJyk7Cgp2YXIgX3NpcDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zaXApOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBTZXNzaW9uID0gX3NpcDIuZGVmYXVsdC5TZXNzaW9uOwp2YXIgQyA9IHsKICBTVEFUVVNfTlVMTDogMCwKICBTVEFUVVNfSU5WSVRFX1NFTlQ6IDEsCiAgU1RBVFVTXzFYWF9SRUNFSVZFRDogMiwKICBTVEFUVVNfSU5WSVRFX1JFQ0VJVkVEOiAzLAogIFNUQVRVU19XQUlUSU5HX0ZPUl9BTlNXRVI6IDQsCiAgU1RBVFVTX0FOU1dFUkVEOiA1LAogIFNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSzogNiwKICBTVEFUVVNfV0FJVElOR19GT1JfQUNLOiA3LAogIFNUQVRVU19DQU5DRUxFRDogOCwKICBTVEFUVVNfVEVSTUlOQVRFRDogOSwKICBTVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0s6IDEwLAogIFNUQVRVU19FQVJMWV9NRURJQTogMTEsCiAgU1RBVFVTX0NPTkZJUk1FRDogMTIKfTsKCnZhciBoYXNEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uIGhhc0Rlc2NyaXB0aW9uKG1lc3NhZ2UpIHsKICByZXR1cm4gbWVzc2FnZS5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpID09PSAnYXBwbGljYXRpb24vc2RwJyAmJiAhIW1lc3NhZ2UuYm9keTsKfTsKCnZhciBJbnZpdGVTZXJ2ZXJDb250ZXh0ID0gZnVuY3Rpb24gSW52aXRlU2VydmVyQ29udGV4dCh1YSwgcmVxdWVzdCkgewogIHZhciBleHBpcmVzLAogICAgICBzZWxmID0gdGhpcywKICAgICAgY29udGVudFR5cGUgPSByZXF1ZXN0LmdldEhlYWRlcignQ29udGVudC1UeXBlJyksCiAgICAgIGNvbnRlbnREaXNwID0gcmVxdWVzdC5wYXJzZUhlYWRlcignQ29udGVudC1EaXNwb3NpdGlvbicpOwoKICBfc2lwMi5kZWZhdWx0LlV0aWxzLmF1Z21lbnQodGhpcywgX3NpcDIuZGVmYXVsdC5TZXJ2ZXJDb250ZXh0LCBbdWEsIHJlcXVlc3RdKTsKICBfc2lwMi5kZWZhdWx0LlV0aWxzLmF1Z21lbnQodGhpcywgX3NpcDIuZGVmYXVsdC5TZXNzaW9uLCBbdWEuY29uZmlndXJhdGlvbi5tZWRpYUhhbmRsZXJGYWN0b3J5XSk7CgogIC8vSW5pdGlhbGl6ZSBNZWRpYSBTZXNzaW9uCiAgdGhpcy5tZWRpYUhhbmRsZXIgPSB0aGlzLm1lZGlhSGFuZGxlckZhY3RvcnkodGhpcywgewogICAgUlRDQ29uc3RyYWludHM6IHsgIm9wdGlvbmFsIjogW3sgJ0R0bHNTcnRwS2V5QWdyZWVtZW50JzogJ3RydWUnIH1dIH0KICB9KTsKCiAgLy8gQ2hlY2sgYm9keSBhbmQgY29udGVudCB0eXBlCiAgaWYgKCFjb250ZW50RGlzcCAmJiAhaGFzRGVzY3JpcHRpb24ocmVxdWVzdCkgfHwgY29udGVudERpc3AgJiYgY29udGVudERpc3AudHlwZSA9PT0gJ3JlbmRlcicpIHsKICAgIHRoaXMucmVuZGVyYm9keSA9IHJlcXVlc3QuYm9keTsKICAgIHRoaXMucmVuZGVydHlwZSA9IGNvbnRlbnRUeXBlOwogIH0gZWxzZSBpZiAoIWhhc0Rlc2NyaXB0aW9uKHJlcXVlc3QpICYmIGNvbnRlbnREaXNwICYmIGNvbnRlbnREaXNwLnR5cGUgPT09ICdzZXNzaW9uJykgewogICAgcmVxdWVzdC5yZXBseSg0MTUpOwogICAgLy9UT0RPOiBpbnN0ZWFkIG9mIDQxNSwgcGFzcyBvZmYgdG8gdGhlIG1lZGlhIGhhbmRsZXIsIHdobyBjYW4gdGhlbiBkZWNpZGUgaWYgd2UgY2FuIHVzZSBpdAogICAgcmV0dXJuOwogIH0KCiAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19JTlZJVEVfUkVDRUlWRUQ7CiAgdGhpcy5mcm9tX3RhZyA9IHJlcXVlc3QuZnJvbV90YWc7CiAgdGhpcy5pZCA9IHJlcXVlc3QuY2FsbF9pZCArIHRoaXMuZnJvbV90YWc7CiAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDsKICB0aGlzLmNvbnRhY3QgPSB0aGlzLnVhLmNvbnRhY3QudG9TdHJpbmcoKTsKCiAgdGhpcy5yZWNlaXZlTm9uSW52aXRlUmVzcG9uc2UgPSBmdW5jdGlvbiAoKSB7fTsgLy8gaW50ZW50aW9uYWwgbm8tb3AKCiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC5pbnZpdGVzZXJ2ZXJjb250ZXh0JywgdGhpcy5pZCk7CgogIC8vU2F2ZSB0aGUgc2Vzc2lvbiBpbnRvIHRoZSB1YSBzZXNzaW9ucyBjb2xsZWN0aW9uLgogIHRoaXMudWEuc2Vzc2lvbnNbdGhpcy5pZF0gPSB0aGlzOwoKICAvL0dldCB0aGUgRXhwaXJlcyBoZWFkZXIgdmFsdWUgaWYgZXhpc3RzCiAgaWYgKHJlcXVlc3QuaGFzSGVhZGVyKCdleHBpcmVzJykpIHsKICAgIGV4cGlyZXMgPSByZXF1ZXN0LmdldEhlYWRlcignZXhwaXJlcycpICogMTAwMDsKICB9CgogIC8vU2V0IDEwMHJlbCBpZiBuZWNlc3NhcnkKICBmdW5jdGlvbiBzZXQxMDByZWwoaCwgYykgewogICAgaWYgKHJlcXVlc3QuaGFzSGVhZGVyKGgpICYmIHJlcXVlc3QuZ2V0SGVhZGVyKGgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZignMTAwcmVsJykgPj0gMCkgewogICAgICBzZWxmLnJlbDEwMCA9IGM7CiAgICB9CiAgfQogIHNldDEwMHJlbCgncmVxdWlyZScsIF9zaXAyLmRlZmF1bHQuQy5zdXBwb3J0ZWQuUkVRVUlSRUQpOwogIHNldDEwMHJlbCgnc3VwcG9ydGVkJywgX3NpcDIuZGVmYXVsdC5DLnN1cHBvcnRlZC5TVVBQT1JURUQpOwoKICAvKiBTZXQgdGhlIHRvX3RhZyBiZWZvcmUKICAgKiByZXBseWluZyBhIHJlc3BvbnNlIGNvZGUgdGhhdCB3aWxsIGNyZWF0ZSBhIGRpYWxvZy4KICAgKi8KICByZXF1ZXN0LnRvX3RhZyA9IF9zaXAyLmRlZmF1bHQuVXRpbHMubmV3VGFnKCk7CgogIC8vIEFuIGVycm9yIG9uIGRpYWxvZyBjcmVhdGlvbiB3aWxsIGZpcmUgJ2ZhaWxlZCcgZXZlbnQKICBpZiAoIXRoaXMuY3JlYXRlRGlhbG9nKHJlcXVlc3QsICdVQVMnLCB0cnVlKSkgewogICAgcmVxdWVzdC5yZXBseSg1MDAsICdNaXNzaW5nIENvbnRhY3QgaGVhZGVyIGZpZWxkJyk7CiAgICByZXR1cm47CiAgfQoKICBmdW5jdGlvbiBmaXJlTmV3U2Vzc2lvbigpIHsKICAgIHZhciBvcHRpb25zID0geyBleHRyYUhlYWRlcnM6IFsnQ29udGFjdDogJyArIHNlbGYuY29udGFjdF0gfTsKCiAgICBpZiAoc2VsZi5yZWwxMDAgIT09IF9zaXAyLmRlZmF1bHQuQy5zdXBwb3J0ZWQuUkVRVUlSRUQpIHsKICAgICAgc2VsZi5wcm9ncmVzcyhvcHRpb25zKTsKICAgIH0KICAgIHNlbGYuc3RhdHVzID0gQy5TVEFUVVNfV0FJVElOR19GT1JfQU5TV0VSOwoKICAgIC8vIFNldCB1c2VyTm9BbnN3ZXJUaW1lcgogICAgc2VsZi50aW1lcnMudXNlck5vQW5zd2VyVGltZXIgPSBfc2lwMi5kZWZhdWx0LlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgcmVxdWVzdC5yZXBseSg0MDgpOwogICAgICBzZWxmLmZhaWxlZChyZXF1ZXN0LCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLk5PX0FOU1dFUik7CiAgICAgIHNlbGYudGVybWluYXRlZChyZXF1ZXN0LCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLk5PX0FOU1dFUik7CiAgICB9LCBzZWxmLnVhLmNvbmZpZ3VyYXRpb24ubm9BbnN3ZXJUaW1lb3V0KTsKCiAgICAvKiBTZXQgZXhwaXJlc1RpbWVyCiAgICAgKiBSRkMzMjYxIDEzLjMuMQogICAgICovCiAgICBpZiAoZXhwaXJlcykgewogICAgICBzZWxmLnRpbWVycy5leHBpcmVzVGltZXIgPSBfc2lwMi5kZWZhdWx0LlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoc2VsZi5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUikgewogICAgICAgICAgcmVxdWVzdC5yZXBseSg0ODcpOwogICAgICAgICAgc2VsZi5mYWlsZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5FWFBJUkVTKTsKICAgICAgICAgIHNlbGYudGVybWluYXRlZChyZXF1ZXN0LCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkVYUElSRVMpOwogICAgICAgIH0KICAgICAgfSwgZXhwaXJlcyk7CiAgICB9CgogICAgc2VsZi5lbWl0KCdpbnZpdGUnLCByZXF1ZXN0KTsKICB9CgogIGlmICghaGFzRGVzY3JpcHRpb24ocmVxdWVzdCkgfHwgdGhpcy5yZW5kZXJib2R5KSB7CiAgICBfc2lwMi5kZWZhdWx0LlRpbWVycy5zZXRUaW1lb3V0KGZpcmVOZXdTZXNzaW9uLCAwKTsKICB9IGVsc2UgewogICAgdGhpcy5oYXNPZmZlciA9IHRydWU7CiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgZmlyZU5ld1Nlc3Npb24oKTsKICAgIH0sIDUwMCk7CiAgfQp9OwoKSW52aXRlU2VydmVyQ29udGV4dC5wcm90b3R5cGUgPSB7CgogIHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KG9wdGlvbnMpIHsKICAgIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhyb3cgbmV3IF9zaXAyLmRlZmF1bHQuRXhjZXB0aW9ucy5JbnZhbGlkU3RhdGVFcnJvcih0aGlzLnN0YXR1cyk7CiAgICB9CgogICAgdGhpcy5sb2dnZXIubG9nKCdyZWplY3RpbmcgUlRDU2Vzc2lvbicpOwoKICAgIF9zaXAyLmRlZmF1bHQuU2VydmVyQ29udGV4dC5wcm90b3R5cGUucmVqZWN0LmNhbGwodGhpcywgb3B0aW9ucyk7CiAgICByZXR1cm4gdGhpcy50ZXJtaW5hdGVkKCk7CiAgfSwKCiAgdGVybWluYXRlOiBmdW5jdGlvbiB0ZXJtaW5hdGUob3B0aW9ucykgewogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgogICAgdmFyIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKSwKICAgICAgICBib2R5ID0gb3B0aW9ucy5ib2R5LAogICAgICAgIGRpYWxvZywKICAgICAgICBzZWxmID0gdGhpczsKCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSyAmJiB0aGlzLnJlcXVlc3Quc2VydmVyX3RyYW5zYWN0aW9uLnN0YXRlICE9PSBfc2lwMi5kZWZhdWx0LlRyYW5zYWN0aW9ucy5DLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIGRpYWxvZyA9IHRoaXMuZGlhbG9nOwoKICAgICAgdGhpcy5yZWNlaXZlUmVxdWVzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgICAgICAgaWYgKHJlcXVlc3QubWV0aG9kID09PSBfc2lwMi5kZWZhdWx0LkMuQUNLKSB7CiAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KF9zaXAyLmRlZmF1bHQuQy5CWUUsIHsKICAgICAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICAgICAgICAgIGJvZHk6IGJvZHkKICAgICAgICAgIH0pOwogICAgICAgICAgZGlhbG9nLnRlcm1pbmF0ZSgpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHRoaXMucmVxdWVzdC5zZXJ2ZXJfdHJhbnNhY3Rpb24ub24oJ3N0YXRlQ2hhbmdlZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gX3NpcDIuZGVmYXVsdC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfVEVSTUlOQVRFRCAmJiB0aGlzLmRpYWxvZykgewogICAgICAgICAgdGhpcy5yZXF1ZXN0ID0gbmV3IF9zaXAyLmRlZmF1bHQuT3V0Z29pbmdSZXF1ZXN0KF9zaXAyLmRlZmF1bHQuQy5CWUUsIHRoaXMuZGlhbG9nLnJlbW90ZV90YXJnZXQsIHRoaXMudWEsIHsKICAgICAgICAgICAgJ2NzZXEnOiB0aGlzLmRpYWxvZy5sb2NhbF9zZXFudW0gKz0gMSwKICAgICAgICAgICAgJ2NhbGxfaWQnOiB0aGlzLmRpYWxvZy5pZC5jYWxsX2lkLAogICAgICAgICAgICAnZnJvbV91cmknOiB0aGlzLmRpYWxvZy5sb2NhbF91cmksCiAgICAgICAgICAgICdmcm9tX3RhZyc6IHRoaXMuZGlhbG9nLmlkLmxvY2FsX3RhZywKICAgICAgICAgICAgJ3RvX3VyaSc6IHRoaXMuZGlhbG9nLnJlbW90ZV91cmksCiAgICAgICAgICAgICd0b190YWcnOiB0aGlzLmRpYWxvZy5pZC5yZW1vdGVfdGFnLAogICAgICAgICAgICAncm91dGVfc2V0JzogdGhpcy5kaWFsb2cucm91dGVfc2V0CiAgICAgICAgICB9LCBleHRyYUhlYWRlcnMsIGJvZHkpOwoKICAgICAgICAgIG5ldyBfc2lwMi5kZWZhdWx0LlJlcXVlc3RTZW5kZXIoewogICAgICAgICAgICByZXF1ZXN0OiB0aGlzLnJlcXVlc3QsCiAgICAgICAgICAgIG9uUmVxdWVzdFRpbWVvdXQ6IGZ1bmN0aW9uIG9uUmVxdWVzdFRpbWVvdXQoKSB7CiAgICAgICAgICAgICAgc2VsZi5vblJlcXVlc3RUaW1lb3V0KCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uIG9uVHJhbnNwb3J0RXJyb3IoKSB7CiAgICAgICAgICAgICAgc2VsZi5vblRyYW5zcG9ydEVycm9yKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHJlY2VpdmVSZXNwb25zZTogZnVuY3Rpb24gcmVjZWl2ZVJlc3BvbnNlKCkgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgdGhpcy51YSkuc2VuZCgpOwogICAgICAgICAgZGlhbG9nLnRlcm1pbmF0ZSgpOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICB0aGlzLmVtaXQoJ2J5ZScsIHRoaXMucmVxdWVzdCk7CiAgICAgIHRoaXMudGVybWluYXRlZCgpOwoKICAgICAgLy8gUmVzdG9yZSB0aGUgZGlhbG9nIGludG8gJ3RoaXMnIGluIG9yZGVyIHRvIGJlIGFibGUgdG8gc2VuZCB0aGUgaW4tZGlhbG9nIEJZRSA6LSkKICAgICAgdGhpcy5kaWFsb2cgPSBkaWFsb2c7CgogICAgICAvLyBSZXN0b3JlIHRoZSBkaWFsb2cgaW50byAndWEnIHNvIHRoZSBBQ0sgY2FuIHJlYWNoICd0aGlzJyBzZXNzaW9uCiAgICAgIHRoaXMudWEuZGlhbG9nc1tkaWFsb2cuaWQudG9TdHJpbmcoKV0gPSBkaWFsb2c7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy5ieWUob3B0aW9ucyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnJlamVjdChvcHRpb25zKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKgogICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5tZWRpYV0gZ2V0cyBwYXNzZWQgdG8gU0lQLk1lZGlhSGFuZGxlci5nZXREZXNjcmlwdGlvbiBhcyBtZWRpYUhpbnQKICAgKi8KICBwcm9ncmVzczogZnVuY3Rpb24gcHJvZ3Jlc3Mob3B0aW9ucykgewogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgICB2YXIgc3RhdHVzQ29kZSA9IG9wdGlvbnMuc3RhdHVzQ29kZSB8fCAxODAsCiAgICAgICAgcmVhc29uUGhyYXNlID0gb3B0aW9ucy5yZWFzb25QaHJhc2UsCiAgICAgICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgICAgIGljZVNlcnZlcnMsCiAgICAgICAgc3R1blNlcnZlcnMgPSBvcHRpb25zLnN0dW5TZXJ2ZXJzIHx8IG51bGwsCiAgICAgICAgdHVyblNlcnZlcnMgPSBvcHRpb25zLnR1cm5TZXJ2ZXJzIHx8IG51bGwsCiAgICAgICAgYm9keSA9IG9wdGlvbnMuYm9keSwKICAgICAgICByZXNwb25zZTsKCiAgICBpZiAoc3RhdHVzQ29kZSA8IDEwMCB8fCBzdGF0dXNDb2RlID4gMTk5KSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgc3RhdHVzQ29kZTogJyArIHN0YXR1c0NvZGUpOwogICAgfQoKICAgIGlmICh0aGlzLmlzQ2FuY2VsZWQgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgZnVuY3Rpb24gZG8xMDByZWwoKSB7CiAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi8KICAgICAgc3RhdHVzQ29kZSA9IG9wdGlvbnMuc3RhdHVzQ29kZSB8fCAxODM7CgogICAgICAvLyBTZXQgc3RhdHVzIGFuZCBhZGQgZXh0cmEgaGVhZGVycwogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLOwogICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJyArIHRoaXMuY29udGFjdCk7CiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZXF1aXJlOiAxMDByZWwnKTsKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JTZXE6ICcgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCkpOwoKICAgICAgLy8gR2V0IHRoZSBzZXNzaW9uIGRlc2NyaXB0aW9uIHRvIGFkZCB0byBwcmVhY2NlcHQgd2l0aAogICAgICBpZiAodGhpcy5pc0NhbmNlbGVkIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzW3RoaXMuaGFzT2ZmZXIgPyAnaGFzQW5zd2VyJyA6ICdoYXNPZmZlciddID0gdHJ1ZTsKCiAgICAgIC8vIFJldHJhbnNtaXQgdW50aWwgd2UgZ2V0IGEgcmVzcG9uc2Ugb3Igd2UgdGltZSBvdXQgKHNlZSBwcmFja1RpbWVyIGJlbG93KQogICAgICB2YXIgdGltZW91dCA9IF9zaXAyLmRlZmF1bHQuVGltZXJzLlQxOwogICAgICB0aGlzLnRpbWVycy5yZWwxeHhUaW1lciA9IF9zaXAyLmRlZmF1bHQuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24gcmVsMXh4UmV0cmFuc21pc3Npb24oKSB7CiAgICAgICAgdGhpcy5yZXF1ZXN0LnJlcGx5KHN0YXR1c0NvZGUsIG51bGwsIGV4dHJhSGVhZGVycywgZGVzY3JpcHRpb24pOwogICAgICAgIHRpbWVvdXQgKj0gMjsKICAgICAgICB0aGlzLnRpbWVycy5yZWwxeHhUaW1lciA9IF9zaXAyLmRlZmF1bHQuVGltZXJzLnNldFRpbWVvdXQocmVsMXh4UmV0cmFuc21pc3Npb24uYmluZCh0aGlzKSwgdGltZW91dCk7CiAgICAgIH0uYmluZCh0aGlzKSwgdGltZW91dCk7CgogICAgICAvLyBUaW1lb3V0IGFuZCByZWplY3QgSU5WSVRFIGlmIG5vIHJlc3BvbnNlCiAgICAgIHRoaXMudGltZXJzLnByYWNrVGltZXIgPSBfc2lwMi5kZWZhdWx0LlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ25vIFBSQUNLIHJlY2VpdmVkLCByZWplY3RpbmcgdGhlIGNhbGwnKTsKICAgICAgICBfc2lwMi5kZWZhdWx0LlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMucmVsMXh4VGltZXIpOwogICAgICAgIHRoaXMucmVxdWVzdC5yZXBseSg1MDQpOwogICAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLk5PX1BSQUNLKTsKICAgICAgfS5iaW5kKHRoaXMpLCBfc2lwMi5kZWZhdWx0LlRpbWVycy5UMSAqIDY0KTsKCiAgICAgIC8vIFNlbmQgdGhlIGluaXRpYWwgcmVzcG9uc2UKICAgICAgcmVzcG9uc2UgPSB0aGlzLnJlcXVlc3QucmVwbHkoc3RhdHVzQ29kZSwgcmVhc29uUGhyYXNlLCBleHRyYUhlYWRlcnMsIGRlc2NyaXB0aW9uKTsKICAgICAgdGhpcy5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlLCByZWFzb25QaHJhc2UpOwogICAgfSAvLyBlbmQgZG8xMDByZWwKCiAgICBmdW5jdGlvbiBub3JtYWxSZXBseSgpIHsKICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovCiAgICAgIHJlc3BvbnNlID0gdGhpcy5yZXF1ZXN0LnJlcGx5KHN0YXR1c0NvZGUsIHJlYXNvblBocmFzZSwgZXh0cmFIZWFkZXJzLCBib2R5KTsKICAgICAgdGhpcy5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlLCByZWFzb25QaHJhc2UpOwogICAgfQoKICAgIGlmIChvcHRpb25zLnN0YXR1c0NvZGUgIT09IDEwMCAmJiAodGhpcy5yZWwxMDAgPT09IF9zaXAyLmRlZmF1bHQuQy5zdXBwb3J0ZWQuUkVRVUlSRUQgfHwgdGhpcy5yZWwxMDAgPT09IF9zaXAyLmRlZmF1bHQuQy5zdXBwb3J0ZWQuU1VQUE9SVEVEICYmIG9wdGlvbnMucmVsMTAwIHx8IHRoaXMucmVsMTAwID09PSBfc2lwMi5kZWZhdWx0LkMuc3VwcG9ydGVkLlNVUFBPUlRFRCAmJiB0aGlzLnVhLmNvbmZpZ3VyYXRpb24ucmVsMTAwID09PSBfc2lwMi5kZWZhdWx0LkMuc3VwcG9ydGVkLlJFUVVJUkVEKSkgewogICAgICBkbzEwMHJlbC5hcHBseSh0aGlzKTsKICAgIH0gZWxzZSB7CiAgICAgIG5vcm1hbFJlcGx5LmFwcGx5KHRoaXMpOwogICAgfQogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoKICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMubWVkaWFdIGdldHMgcGFzc2VkIHRvIFNJUC5NZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24gYXMgbWVkaWFIaW50CiAgICovCiAgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQob3B0aW9ucykgewogICAgb3B0aW9ucyA9IE9iamVjdC5jcmVhdGUoU2Vzc2lvbi5kZXN1Z2FyKG9wdGlvbnMpKTsKICAgIHRoaXMub25JbmZvID0gb3B0aW9ucy5vbkluZm87CgogICAgLy8gY29tbWVudGVkIG91dCBub3ctdW51c2VkIGhvbGQtcmVsYXRlZCB2YXJpYWJsZXMgZm9yIGpzaGludC4gU2VlIGJlbG93LiBKTUYgMjAxNC0xLTIxCiAgICB2YXIKICAgIC8vaWR4LCBsZW5ndGgsIGhhc0F1ZGlvLCBoYXNWaWRlbywKICAgIHNlbGYgPSB0aGlzLAogICAgICAgIHJlcXVlc3QgPSB0aGlzLnJlcXVlc3QsCiAgICAgICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgICAgIGRlc2NyaXB0aW9uQ3JlYXRpb25TdWNjZWVkZWQgPSBmdW5jdGlvbiBkZXNjcmlwdGlvbkNyZWF0aW9uU3VjY2VlZGVkKGRlc2NyaXB0aW9uKSB7CiAgICAgIHZhciByZXNwb25zZSwKCiAgICAgIC8vIHJ1biBmb3IgcmVwbHkgc3VjY2VzcyBjYWxsYmFjawogICAgICByZXBseVN1Y2NlZWRlZCA9IGZ1bmN0aW9uIHJlcGx5U3VjY2VlZGVkKCkgewogICAgICAgIHNlbGYuc3RhdHVzID0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLOwoKICAgICAgICBzZWxmLnNldEludml0ZTJ4eFRpbWVyKHJlcXVlc3QsIGRlc2NyaXB0aW9uKTsKICAgICAgICBzZWxmLnNldEFDS1RpbWVyKCk7CiAgICAgIH0sCgoKICAgICAgLy8gcnVuIGZvciByZXBseSBmYWlsdXJlIGNhbGxiYWNrCiAgICAgIHJlcGx5RmFpbGVkID0gZnVuY3Rpb24gcmVwbHlGYWlsZWQoKSB7CiAgICAgICAgc2VsZi5mYWlsZWQobnVsbCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgICAgICBzZWxmLnRlcm1pbmF0ZWQobnVsbCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgICAgfTsKCiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250YWN0OiAnICsgc2VsZi5jb250YWN0KTsKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0FsbG93OiAnICsgX3NpcDIuZGVmYXVsdC5VQS5DLkFMTE9XRURfTUVUSE9EUy50b1N0cmluZygpKTsKCiAgICAgIGlmICghc2VsZi5oYXNPZmZlcikgewogICAgICAgIHNlbGYuaGFzT2ZmZXIgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHNlbGYuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgfQogICAgICByZXNwb25zZSA9IHJlcXVlc3QucmVwbHkoMjAwLCBudWxsLCBleHRyYUhlYWRlcnMsIGRlc2NyaXB0aW9uLCByZXBseVN1Y2NlZWRlZCwgcmVwbHlGYWlsZWQpOwogICAgICBpZiAoc2VsZi5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAvLyBEaWRuJ3QgZmFpbAogICAgICAgIHNlbGYuYWNjZXB0ZWQocmVzcG9uc2UsIF9zaXAyLmRlZmF1bHQuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKDIwMCkpOwogICAgICB9CiAgICB9OwoKICAgIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLKSB7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0s7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQU5TV0VSKSB7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQU5TV0VSRUQ7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19FQVJMWV9NRURJQSkgewogICAgICB0aHJvdyBuZXcgX3NpcDIuZGVmYXVsdC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICAvLyBBbiBlcnJvciBvbiBkaWFsb2cgY3JlYXRpb24gd2lsbCBmaXJlICdmYWlsZWQnIGV2ZW50CiAgICBpZiAoIXRoaXMuY3JlYXRlRGlhbG9nKHJlcXVlc3QsICdVQVMnKSkgewogICAgICByZXF1ZXN0LnJlcGx5KDUwMCwgJ01pc3NpbmcgQ29udGFjdCBoZWFkZXIgZmllbGQnKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICBjb25zb2xlLmxvZygncmVxdWVzdCcsIHJlcXVlc3QpOwogICAgX3NpcDIuZGVmYXVsdC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnVzZXJOb0Fuc3dlclRpbWVyKTsKCiAgICBkZXNjcmlwdGlvbkNyZWF0aW9uU3VjY2VlZGVkKG9wdGlvbnMuc2RwKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIHJlY2VpdmVSZXF1ZXN0OiBmdW5jdGlvbiByZWNlaXZlUmVxdWVzdChyZXF1ZXN0KSB7CgogICAgLy8gSVNDIFJFQ0VJVkUgUkVRVUVTVAoKICAgIGZ1bmN0aW9uIGNvbmZpcm1TZXNzaW9uKCkgewogICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi8KICAgICAgdmFyIGNvbnRlbnRUeXBlOwoKICAgICAgX3NpcDIuZGVmYXVsdC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmFja1RpbWVyKTsKICAgICAgX3NpcDIuZGVmYXVsdC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmludml0ZTJ4eFRpbWVyKTsKICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgIHRoaXMudW5tdXRlKCk7CgogICAgICAvLyBUT0RPIC0gdGhpcyBsb2dpYyBhc3N1bWVzIENvbnRlbnQtRGlzcG9zaXRpb24gZGVmYXVsdHMKICAgICAgY29udGVudFR5cGUgPSByZXF1ZXN0LmdldEhlYWRlcignQ29udGVudC1UeXBlJyk7CiAgICAgIGlmICghaGFzRGVzY3JpcHRpb24ocmVxdWVzdCkpIHsKICAgICAgICB0aGlzLnJlbmRlcmJvZHkgPSByZXF1ZXN0LmJvZHk7CiAgICAgICAgdGhpcy5yZW5kZXJ0eXBlID0gY29udGVudFR5cGU7CiAgICAgIH0KCiAgICAgIHRoaXMuZW1pdCgnY29uZmlybWVkJywgcmVxdWVzdCk7CiAgICB9CgogICAgc3dpdGNoIChyZXF1ZXN0Lm1ldGhvZCkgewogICAgICBjYXNlIF9zaXAyLmRlZmF1bHQuQy5DQU5DRUw6CiAgICAgICAgLyogUkZDMzI2MSAxNSBTdGF0ZXMgdGhhdCBhIFVBUyBtYXkgaGF2ZSBhY2NlcHRlZCBhbiBpbnZpdGF0aW9uIHdoaWxlIGEgQ0FOQ0VMCiAgICAgICAgICogd2FzIGluIHByb2dyZXNzIGFuZCB0aGF0IHRoZSBVQUMgTUFZIGNvbnRpbnVlIHdpdGggdGhlIHNlc3Npb24gZXN0YWJsaXNoZWQgYnkKICAgICAgICAgKiBhbnkgMnh4IHJlc3BvbnNlLCBvciBNQVkgdGVybWluYXRlIHdpdGggQllFLiBTSVAgZG9lcyBjb250aW51ZSB3aXRoIHRoZQogICAgICAgICAqIGVzdGFibGlzaGVkIHNlc3Npb24uIFNvIHRoZSBDQU5DRUwgaXMgcHJvY2Vzc2VkIG9ubHkgaWYgdGhlIHNlc3Npb24gaXMgbm90IHlldAogICAgICAgICAqIGVzdGFibGlzaGVkLgogICAgICAgICAqLwoKICAgICAgICAvKgogICAgICAgICAqIFRlcm1pbmF0ZSB0aGUgd2hvbGUgc2Vzc2lvbiBpbiBjYXNlIHRoZSB1c2VyIGRpZG4ndCBhY2NlcHQgKG9yIHlldCB0byBzZW5kIHRoZSBhbnN3ZXIpIG5vciByZWplY3QgdGhlCiAgICAgICAgICpyZXF1ZXN0IG9wZW5pbmcgdGhlIHNlc3Npb24uCiAgICAgICAgICovCiAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BTlNXRVIgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSyB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfRUFSTFlfTUVESUEgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0FOU1dFUkVEKSB7CgogICAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19DQU5DRUxFRDsKICAgICAgICAgIHRoaXMucmVxdWVzdC5yZXBseSg0ODcpOwogICAgICAgICAgdGhpcy5jYW5jZWxlZChyZXF1ZXN0KTsKICAgICAgICAgIHRoaXMucmVqZWN0ZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5DQU5DRUxFRCk7CiAgICAgICAgICB0aGlzLmZhaWxlZChyZXF1ZXN0LCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkNBTkNFTEVEKTsKICAgICAgICAgIHRoaXMudGVybWluYXRlZChyZXF1ZXN0LCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkNBTkNFTEVEKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgX3NpcDIuZGVmYXVsdC5DLkFDSzoKICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSykgewogICAgICAgICAgaWYgKCF0aGlzLmhhc0Fuc3dlcikgewogICAgICAgICAgICBpZiAoaGFzRGVzY3JpcHRpb24ocmVxdWVzdCkpIHsKICAgICAgICAgICAgICAvLyBBQ0sgY29udGFpbnMgYW5zd2VyIHRvIGFuIElOVklURSB3L28gU0RQIG5lZ290aWF0aW9uCiAgICAgICAgICAgICAgdGhpcy5oYXNBbnN3ZXIgPSB0cnVlOwogICAgICAgICAgICAgIHRoaXMubWVkaWFIYW5kbGVyLnNldERlc2NyaXB0aW9uKHJlcXVlc3QpLnRoZW4oY29uZmlybVNlc3Npb24uYmluZCh0aGlzKSwgZnVuY3Rpb24gb25GYWlsdXJlKGUpIHsKICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oZSk7CiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZSh7CiAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6ICc0ODgnLAogICAgICAgICAgICAgICAgICByZWFzb25QaHJhc2U6ICdCYWQgTWVkaWEgRGVzY3JpcHRpb24nCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRoaXMuZmFpbGVkKHJlcXVlc3QsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgICAgIHRoaXMudGVybWluYXRlZChyZXF1ZXN0LCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmVhcmx5X3NkcCkgewogICAgICAgICAgICAgIGNvbmZpcm1TZXNzaW9uLmFwcGx5KHRoaXMpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vVE9ETzogUGFzcyB0byBtZWRpYWhhbmRsZXIKICAgICAgICAgICAgICB0aGlzLmZhaWxlZChyZXF1ZXN0LCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlcXVlc3QsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uZmlybVNlc3Npb24uYXBwbHkodGhpcyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIF9zaXAyLmRlZmF1bHQuQy5QUkFDSzoKICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICAgICAgLy9sb2NhbE1lZGlhID0gc2Vzc2lvbi5tZWRpYUhhbmRsZXIubG9jYWxNZWRpYTsKICAgICAgICAgIGlmICghdGhpcy5oYXNBbnN3ZXIpIHsKICAgICAgICAgICAgaWYgKGhhc0Rlc2NyaXB0aW9uKHJlcXVlc3QpKSB7CiAgICAgICAgICAgICAgdGhpcy5oYXNBbnN3ZXIgPSB0cnVlOwogICAgICAgICAgICAgIHRoaXMubWVkaWFIYW5kbGVyLnNldERlc2NyaXB0aW9uKHJlcXVlc3QpLnRoZW4oZnVuY3Rpb24gb25TdWNjZXNzKCkgewogICAgICAgICAgICAgICAgX3NpcDIuZGVmYXVsdC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnJlbDF4eFRpbWVyKTsKICAgICAgICAgICAgICAgIF9zaXAyLmRlZmF1bHQuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5wcmFja1RpbWVyKTsKICAgICAgICAgICAgICAgIHJlcXVlc3QucmVwbHkoMjAwKTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0spIHsKICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgICAgICAgICAgdGhpcy5hY2NlcHQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfRUFSTFlfTUVESUE7CiAgICAgICAgICAgICAgICAvL1JFVklTSVQKICAgICAgICAgICAgICAgIHRoaXMubXV0ZSgpOwogICAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgZnVuY3Rpb24gb25GYWlsdXJlKGUpIHsKICAgICAgICAgICAgICAgIC8vVE9ETzogU2VuZCB0byBtZWRpYSBoYW5kbGVyCiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKGUpOwogICAgICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGUoewogICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiAnNDg4JywKICAgICAgICAgICAgICAgICAgcmVhc29uUGhyYXNlOiAnQmFkIE1lZGlhIERlc2NyaXB0aW9uJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB0aGlzLmZhaWxlZChyZXF1ZXN0LCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGUoewogICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogJzQ4OCcsCiAgICAgICAgICAgICAgICByZWFzb25QaHJhc2U6ICdCYWQgTWVkaWEgRGVzY3JpcHRpb24nCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdGhpcy5mYWlsZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICAgIHRoaXMudGVybWluYXRlZChyZXF1ZXN0LCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF9zaXAyLmRlZmF1bHQuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5yZWwxeHhUaW1lcik7CiAgICAgICAgICAgIF9zaXAyLmRlZmF1bHQuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5wcmFja1RpbWVyKTsKICAgICAgICAgICAgcmVxdWVzdC5yZXBseSgyMDApOwoKICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfRUFSTFlfTUVESUE7CiAgICAgICAgICAgICAgdGhpcy5hY2NlcHQoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0VBUkxZX01FRElBOwogICAgICAgICAgICAvL1JFVklTSVQKICAgICAgICAgICAgdGhpcy5tdXRlKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfRUFSTFlfTUVESUEpIHsKICAgICAgICAgIHJlcXVlc3QucmVwbHkoMjAwKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgU2Vzc2lvbi5wcm90b3R5cGUucmVjZWl2ZVJlcXVlc3QuYXBwbHkodGhpcywgW3JlcXVlc3RdKTsKICAgICAgICBicmVhazsKICAgIH0KICB9LAoKICBvblRyYW5zcG9ydEVycm9yOiBmdW5jdGlvbiBvblRyYW5zcG9ydEVycm9yKCkgewogICAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQgJiYgdGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5mYWlsZWQobnVsbCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgIH0KICB9LAoKICBvblJlcXVlc3RUaW1lb3V0OiBmdW5jdGlvbiBvblJlcXVlc3RUaW1lb3V0KCkgewogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy50ZXJtaW5hdGVkKG51bGwsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5mYWlsZWQobnVsbCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfQogIH0KCn07CgpleHBvcnRzLmRlZmF1bHQgPSBJbnZpdGVTZXJ2ZXJDb250ZXh0Owptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyJzaXAuanMiOjQyfV0sNDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7Cgl2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5hZGRDYW5kaWRhdGVzVG9TRFAgPSBhZGRDYW5kaWRhdGVzVG9TRFA7Cgp2YXIgX3NkcFRyYW5zZm9ybSA9IHJlcXVpcmUoJ3NkcC10cmFuc2Zvcm0nKTsKCnZhciBfc2RwVHJhbnNmb3JtMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NkcFRyYW5zZm9ybSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gYWRkQ2FuZGlkYXRlc1RvU0RQKHR4dFNkcCwgY2FuZGlkYXRlcykgewoJdmFyIHNkcCA9IF9zZHBUcmFuc2Zvcm0yLmRlZmF1bHQucGFyc2UodHh0U2RwKTsKCXNkcC5tZWRpYVswXS5jYW5kaWRhdGVzID0gW107CglpZiAoc2RwLm1lZGlhLmxlbmd0aCA+IDEpIHNkcC5tZWRpYVsxXS5jYW5kaWRhdGVzID0gW107CgljYW5kaWRhdGVzLmZvckVhY2goZnVuY3Rpb24gKGNhbmRpZGF0ZSkgewoJCXZhciBwYXJ0cyA9IGNhbmRpZGF0ZS5jYW5kaWRhdGUuc3Vic3RyaW5nKDEwKS5zcGxpdCgnICcpOwoJCXZhciBjID0gewoJCQlmb3VuZGF0aW9uOiBwYXJ0c1swXSwKCQkJY29tcG9uZW50OiBwYXJ0c1sxXSwKCQkJdHJhbnNwb3J0OiBwYXJ0c1syXS50b0xvd2VyQ2FzZSgpLAoJCQlwcmlvcml0eTogcGFydHNbM10sCgkJCWlwOiBwYXJ0c1s0XSwKCQkJcG9ydDogcGFydHNbNV0sCgkJCXR5cGU6IHBhcnRzWzddLAoJCQlnZW5lcmF0aW9uOiAnMCcKCQl9OwoJCWZvciAodmFyIGkgPSA4OyBpIDwgcGFydHMubGVuZ3RoOyBpICs9IDIpIHsKCQkJaWYgKHBhcnRzW2ldID09PSAncmFkZHInKSB7CgkJCQljLnJhZGRyID0gcGFydHNbaSArIDFdOwoJCQl9IGVsc2UgaWYgKHBhcnRzW2ldID09PSAncnBvcnQnKSB7CgkJCQljLnJwb3J0ID0gcGFydHNbaSArIDFdOwoJCQl9IGVsc2UgaWYgKHBhcnRzW2ldID09PSAnZ2VuZXJhdGlvbicpIHsKCQkJCWMuZ2VuZXJhdGlvbiA9IHBhcnRzW2kgKyAxXTsKCQkJfSBlbHNlIGlmIChwYXJ0c1tpXSA9PT0gJ3RjcHR5cGUnKSB7CgkJCQljLnRjcHR5cGUgPSBwYXJ0c1tpICsgMV07CgkJCX0gZWxzZSBpZiAocGFydHNbaV0gPT09ICduZXR3b3JrLWlkJykgewoJCQkJY1snbmV0d29yay1pZCddID0gcGFydHNbaSArIDFdOwoJCQl9IGVsc2UgaWYgKHBhcnRzW2ldID09PSAnbmV0d29yay1jb3N0JykgewoJCQkJY1snbmV0d29yay1jb3N0J10gPSBwYXJ0c1tpICsgMV07CgkJCX0KCQl9CgkJc2RwLm1lZGlhLmZpbHRlcihmdW5jdGlvbiAobSkgewoJCQlyZXR1cm4gbS50eXBlID09PSBjYW5kaWRhdGUuc2RwTWlkOwoJCX0pWzBdLmNhbmRpZGF0ZXMucHVzaChjKTsKCX0pOwoKCXJldHVybiBfc2RwVHJhbnNmb3JtMi5kZWZhdWx0LndyaXRlKHNkcCk7Cn0KCn0seyJzZHAtdHJhbnNmb3JtIjozfV19LHt9LFs0NF0pKDQ0KQp9KTs=",
      "sourceCodeClassname": "IMSIWProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-6f652c34-f0d9-fb93-9407-7f3e29ded6aa5",
    "version": 1.5000000000000002,
    "description": "Description of IMSIWProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "sip.rethink-project.eu",
    "configuration": {
      "credential_server": "https://ims.rethink-project.eu/credential"
    },
    "messageSchemas": "",
    "dataObjects": [],
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": {"browser": true},
    "interworking": true
  }
}
