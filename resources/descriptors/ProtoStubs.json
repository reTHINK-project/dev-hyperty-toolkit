{
  "VertxProtoStub": {
    "cguid": "4-38b3da70-28d4-8082-38f1-b1709f6ee7690",
    "type": "ProtoStubs",
    "version": 1.4,
    "sourcePackageURL": "/sourcePackage",
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiYWN0aXZhdGUiLCBbXSwgZmFjdG9yeSk7CgllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JykKCQlleHBvcnRzWyJhY3RpdmF0ZSJdID0gZmFjdG9yeSgpOwoJZWxzZQoJCXJvb3RbImFjdGl2YXRlIl0gPSBmYWN0b3J5KCk7Cn0pKHRoaXMsIGZ1bmN0aW9uKCkgewpyZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsKCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewoKLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7CgovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewovKioqKioqLyAJCQlleHBvcnRzOiB7fSwKLyoqKioqKi8gCQkJaWQ6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsb2FkZWQ6IGZhbHNlCi8qKioqKiovIAkJfTsKCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7CgovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubG9hZGVkID0gdHJ1ZTsKCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9CgoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwoKLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwovKioqKioqLyB9KQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAoWwovKiAwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsKCglleHBvcnRzLmRlZmF1bHQgPSBhY3RpdmF0ZTsKCglmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCgkvKioNCgkqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQ0KCSogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQNCgkqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTA0KCSogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCgkqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQ0KCSogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRw0KCSogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQoJKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTg0KCSoNCgkqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KCSogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLg0KCSogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQoJKg0KCSogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCgkqDQoJKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQoJKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLA0KCSogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQoJKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQoJKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4NCgkqKi8KCgl2YXIgVmVydHhQcm90b1N0dWIgPSBmdW5jdGlvbiAoKSB7CgkgIC8qIHByaXZhdGUNCgkgICAgX2NvbnRpbnVvdXNPcGVuOiBib29sZWFuDQoJICAgICAgX3J1bnRpbWVQcm90b1N0dWJVUkw6IHN0cmluZw0KCSAgICBfYnVzOiBNaW5pQnVzDQoJICAgIF9tc2dDYWxsYmFjazogKE1lc3NhZ2UpID0+IHZvaWQNCgkgICAgX2NvbmZpZzogeyB1cmwsIHJ1bnRpbWVVUkwgfQ0KCSAgICAgIF9zb2NrOiAoV2ViU29ja2V0IHwgU29ja0pTKQ0KCSAgICBfcmVPcGVuOiBib29sZWFuDQoJICAqLwoKCSAgLyoqDQoJICAgKiBWZXJ0eCBQcm90b1N0dWIgY3JlYXRpb24NCgkgICAqIEBwYXJhbSAge3N0cmluZ30gcnVudGltZVByb3RvU3R1YlVSTCAtIFVSTCB1c2VkIGludGVybmFsbHkgZm9yIG1lc3NhZ2UgZGVsaXZlcnkgcG9pbnQuIE5vdCB1c2VkIGZvciBNZXNzYWdlTm9kZSBkZWxpdmVyLg0KCSAgICogQHBhcmFtICB7TWluaUJ1c30gYnVzIC0gTWluaUJ1cyB1c2VkIHRvIHNlbmQvcmVjZWl2ZSBtZXNzYWdlcy4gTm9ybWFsbHkgY29ubmVjdGVkIHRvIHRoZSBNZXNzYWdlQnVzLg0KCSAgICogQHBhcmFtICB7T2JqZWN0fSBjb25maWcgLSBNYW5kYXRvcnkgZmllbGRzIGFyZTogInVybCIgb2YgdGhlIE1lc3NhZ2VOb2RlIGFkZHJlc3MgYW5kICJydW50aW1lVVJMIi4NCgkgICAqIEByZXR1cm4ge1ZlcnR4UHJvdG9TdHVifQ0KCSAgICovCgkgIGZ1bmN0aW9uIFZlcnR4UHJvdG9TdHViKHJ1bnRpbWVQcm90b1N0dWJVUkwsIGJ1cywgY29uZmlnKSB7CgkgICAgdmFyIF90aGlzMiA9IHRoaXM7CgoJICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWZXJ0eFByb3RvU3R1Yik7CgoJICAgIGlmICghcnVudGltZVByb3RvU3R1YlVSTCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgcnVudGltZVByb3RvU3R1YlVSTCBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCSAgICBpZiAoIWJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoJICAgIGlmICghY29uZmlnKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWcgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CgoJICAgIGlmICghY29uZmlnLnVybCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgY29uZmlnLnVybCBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCSAgICBpZiAoIWNvbmZpZy5ydW50aW1lVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWcucnVudGltZVVSTCBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCgkgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgdGhpcy5faWQgPSAwOwoJICAgIHRoaXMuX2NvbnRpbnVvdXNPcGVuID0gdHJ1ZTsKCgkgICAgdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCA9IHJ1bnRpbWVQcm90b1N0dWJVUkw7CgkgICAgdGhpcy5fYnVzID0gYnVzOwoJICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZzsKCgkgICAgdGhpcy5fcnVudGltZVNlc3Npb25VUkwgPSBjb25maWcucnVudGltZVVSTDsKCSAgICB0aGlzLl9yZU9wZW4gPSBmYWxzZTsKCgkgICAgYnVzLmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24gKG1zZykgewoJICAgICAgY29uc29sZS5sb2coJ1tWZXJ0eFByb3RvU3R1Yl0gb3V0Z29pbmcgbWVzc2FnZTogJywgbXNnKTsKCSAgICAgIF90aGlzLl9vcGVuKGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKF90aGlzLl9maWx0ZXIobXNnKSkgewoJICAgICAgICAgIG1zZy5ib2R5LnZpYSA9IF90aGlzMi5fcnVudGltZVByb3RvU3R1YlVSTDsKCSAgICAgICAgICBjb25zb2xlLmxvZygnW1ZlcnR4UHJvdG9TdHViOiBQcm90b1N0dWIgLT4gTU5dJywgbXNnKTsKCSAgICAgICAgICBfdGhpcy5fc29jay5zZW5kKEpTT04uc3RyaW5naWZ5KG1zZykpOwoJICAgICAgICB9CgkgICAgICB9KTsKCSAgICB9KTsKCgkgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2NyZWF0ZWQnKTsKCSAgfQoKCSAgLyoqDQoJICAgKiBHZXQgdGhlIGNvbmZpZ3VyYXRpb24gZm9yIHRoaXMgUHJvdG9TdHViDQoJICAgKiBAcmV0dXJuIHtPYmplY3R9IC0gTWFuZGF0b3J5IGZpZWxkcyBhcmU6ICJ1cmwiIG9mIHRoZSBNZXNzYWdlTm9kZSBhZGRyZXNzIGFuZCAicnVudGltZVVSTCIuDQoJICAgKi8KCgoJICBfY3JlYXRlQ2xhc3MoVmVydHhQcm90b1N0dWIsIFt7CgkgICAga2V5OiAnY29ubmVjdCcsCgoKCSAgICAvKioNCgkgICAgICogVHJ5IHRvIG9wZW4gdGhlIGNvbm5lY3Rpb24gdG8gdGhlIE1lc3NhZ2VOb2RlLiBDb25uZWN0aW9uIGlzIGF1dG8gbWFuYWdlZCwgdGhlcmUgaXMgbm8gbmVlZCB0byBjYWxsIHRoaXMgZXhwbGljaXRseS4NCgkgICAgICogSG93ZXZlciwgaWYgImRpc2Nvbm5lY3QoKSIgaXMgY2FsbGVkLCBpdCdzIG5lY2Vzc2FyeSB0byBjYWxsIHRoaXMgdG8gZW5hYmxlIGNvbm5lY3Rpb25zIGFnYWluLg0KCSAgICAgKiBBIHN0YXR1cyBtZXNzYWdlIGlzIHNlbnQgdG8gInJ1bnRpbWVQcm90b1N0dWJVUkwvc3RhdHVzIiwgY29udGFpbmluZyB0aGUgdmFsdWUgImNvbm5lY3RlZCIgaWYgc3VjY2Vzc2Z1bCwgb3IgImRpc2Nvbm5lY3RlZCIgaWYgc29tZSBlcnJvciBvY2N1cnMuDQoJICAgICAqLwoJICAgIHZhbHVlOiBmdW5jdGlvbiBjb25uZWN0KCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBfdGhpcy5fY29udGludW91c09wZW4gPSB0cnVlOwoJICAgICAgX3RoaXMuX29wZW4oZnVuY3Rpb24gKCkge30pOwoJICAgIH0KCgkgICAgLyoqDQoJICAgICAqIEl0IHdpbGwgZGlzY29ubmVjdCBhbmQgb3JkZXIgdG8gc3RheSBkaXNjb25uZWN0ZWQuIFJlY29ubmVjdGlvbiB0cmllcywgd2lsbCBub3QgYmUgYXR0ZW1wdGVkLCB1bmxlc3MgImNvbm5lY3QoKSIgaXMgY2FsbGVkLg0KCSAgICAgKiBBIHN0YXR1cyBtZXNzYWdlIGlzIHNlbnQgdG8gInJ1bnRpbWVQcm90b1N0dWJVUkwvc3RhdHVzIiB3aXRoIHZhbHVlICJkaXNjb25uZWN0ZWQiLg0KCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdkaXNjb25uZWN0JywKCSAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY29ubmVjdCgpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2Rpc2Nvbm5lY3RlZCcpOwoKCSAgICAgIF90aGlzLl9jb250aW51b3VzT3BlbiA9IGZhbHNlOwoJICAgICAgaWYgKF90aGlzLl9zb2NrKSB7CgkgICAgICAgIF90aGlzLl9zZW5kQ2xvc2UoKTsKCSAgICAgIH0KCSAgICB9CgoJICAgIC8vdG9kbzogYWRkIGRvY3VtZW50YXRpb24KCgkgIH0sIHsKCSAgICBrZXk6ICdfc2VuZE9wZW4nLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VuZE9wZW4oY2FsbGJhY2spIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgdGhpcy5fc2VuZFN0YXR1cygnaW4tcHJvZ3Jlc3MnKTsKCgkgICAgICBfdGhpcy5faWQrKzsKCSAgICAgIHZhciBtc2cgPSB7CgkgICAgICAgIGlkOiBfdGhpcy5faWQsIHR5cGU6ICdvcGVuJywgZnJvbTogX3RoaXMuX3J1bnRpbWVTZXNzaW9uVVJMLCB0bzogJ21uOi9zZXNzaW9uJwoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX3JlT3BlbikgewoJICAgICAgICBtc2cudHlwZSA9ICdyZS1vcGVuJzsKCSAgICAgIH0KCgkgICAgICAvL3JlZ2lzdGVyIGFuZCB3YWl0IGZvciBvcGVuIHJlcGx5Li4uCgkgICAgICB2YXIgaGFzUmVzcG9uc2UgPSBmYWxzZTsKCSAgICAgIF90aGlzLl9zZXNzaW9uQ2FsbGJhY2sgPSBmdW5jdGlvbiAocmVwbHkpIHsKCSAgICAgICAgaWYgKHJlcGx5LnR5cGUgPT09ICdyZXNwb25zZScgJiByZXBseS5pZCA9PT0gbXNnLmlkKSB7CgkgICAgICAgICAgaGFzUmVzcG9uc2UgPSB0cnVlOwoJICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewoJICAgICAgICAgICAgaWYgKHJlcGx5LmJvZHkucnVudGltZVRva2VuKSB7CgkgICAgICAgICAgICAgIC8vc2V0dXAgcnVudGltZVNlc3Npb24KCSAgICAgICAgICAgICAgX3RoaXMuX3JlT3BlbiA9IHRydWU7CgkgICAgICAgICAgICAgIF90aGlzLl9ydW50aW1lU2Vzc2lvblVSTCA9IF90aGlzLl9jb25maWcucnVudGltZVVSTCArICcvJyArIHJlcGx5LmJvZHkucnVudGltZVRva2VuOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIF90aGlzLl9zZW5kU3RhdHVzKCdsaXZlJyk7CgkgICAgICAgICAgICBjYWxsYmFjaygpOwoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygnZmFpbGVkJywgcmVwbHkuYm9keS5kZXNjKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgIH07CgoJICAgICAgX3RoaXMuX3NvY2suc2VuZChKU09OLnN0cmluZ2lmeShtc2cpKTsKCSAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewoJICAgICAgICBpZiAoIWhhc1Jlc3BvbnNlKSB7CgkgICAgICAgICAgLy9ubyByZXNwb25zZSBhZnRlciB4IHNlY29uZHMuLi4KCSAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygnZGlzY29ubmVjdGVkJywgJ1RpbWVvdXQgZnJvbSBtbjovc2Vzc2lvbicpOwoJICAgICAgICB9CgkgICAgICB9LCAzMDAwKTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfc2VuZENsb3NlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRDbG9zZSgpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX2lkKys7CgkgICAgICB2YXIgbXNnID0gewoJICAgICAgICBpZDogX3RoaXMuX2lkLCB0eXBlOiAnY2xvc2UnLCBmcm9tOiBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwsIHRvOiAnbW46L3Nlc3Npb24nCgkgICAgICB9OwoKCSAgICAgIC8vaW52YWxpZGF0ZSBydW50aW1lU2Vzc2lvbgoJICAgICAgX3RoaXMuX3JlT3BlbiA9IGZhbHNlOwoJICAgICAgX3RoaXMuX3J1bnRpbWVTZXNzaW9uVVJMID0gX3RoaXMuX2NvbmZpZy5fcnVudGltZVVSTDsKCgkgICAgICBfdGhpcy5fc29jay5zZW5kKEpTT04uc3RyaW5naWZ5KG1zZykpOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19zZW5kU3RhdHVzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRTdGF0dXModmFsdWUsIHJlYXNvbikgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBjb25zb2xlLmxvZygnW1ZlcnR4UHJvdG9zdHViIHN0YXR1cyBjaGFuZ2VkXSB0byAnLCB2YWx1ZSk7CgoJICAgICAgX3RoaXMuX3N0YXRlID0gdmFsdWU7CgoJICAgICAgdmFyIG1zZyA9IHsKCSAgICAgICAgdHlwZTogJ3VwZGF0ZScsCgkgICAgICAgIGZyb206IF90aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMLAoJICAgICAgICB0bzogX3RoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgKyAnL3N0YXR1cycsCgkgICAgICAgIGJvZHk6IHsKCSAgICAgICAgICB2YWx1ZTogdmFsdWUKCSAgICAgICAgfQoJICAgICAgfTsKCgkgICAgICBpZiAocmVhc29uKSB7CgkgICAgICAgIG1zZy5ib2R5LmRlc2MgPSByZWFzb247CgkgICAgICB9CgoJICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShtc2cpOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ193YWl0UmVhZHknLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfd2FpdFJlYWR5KGNhbGxiYWNrKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGlmIChfdGhpcy5fc29jay5yZWFkeVN0YXRlID09PSAxKSB7CgkgICAgICAgIGNhbGxiYWNrKCk7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICBfdGhpcy5fd2FpdFJlYWR5KGNhbGxiYWNrKTsKCSAgICAgICAgfSk7CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2ZpbHRlcicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9maWx0ZXIobXNnKSB7CgkgICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkudmlhID09PSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMKSByZXR1cm4gZmFsc2U7CgkgICAgICByZXR1cm4gdHJ1ZTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfZGVsaXZlcicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxpdmVyKG1zZykgewoJICAgICAgaWYgKCFtc2cuYm9keSkgbXNnLmJvZHkgPSB7fTsKCgkgICAgICBtc2cuYm9keS52aWEgPSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMOwoJICAgICAgY29uc29sZS5sb2coJ1tWZXJ0eFByb3RvU3R1YjogTU4gLT4gUHJvdG9TdHViXScsIG1zZyk7CgkgICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnKTsKCSAgICB9CgoJICAgIC8vIGFkZCBkb2N1bWVudGF0aW9uCgoJICB9LCB7CgkgICAga2V5OiAnX29wZW4nLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb3BlbihjYWxsYmFjaykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBpZiAoIXRoaXMuX2NvbnRpbnVvdXNPcGVuKSB7CgkgICAgICAgIC8vVE9ETzogc2VuZCBzdGF0dXMgKHNlbnQgbWVzc2FnZSBlcnJvciAtIGRpc2Nvbm5lY3RlZCkKCSAgICAgICAgcmV0dXJuOwoJICAgICAgfQoKCSAgICAgIGlmICghX3RoaXMuX3NvY2spIHsKCSAgICAgICAgaWYgKF90aGlzLl9jb25maWcudXJsLnN1YnN0cmluZygwLCAyKSA9PT0gJ3dzJykgewoJICAgICAgICAgIF90aGlzLl9zb2NrID0gbmV3IFdlYlNvY2tldChfdGhpcy5fY29uZmlnLnVybCk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgX3RoaXMuX3NvY2sgPSBuZXcgU29ja0pTKF90aGlzLl9jb25maWcudXJsKTsKCSAgICAgICAgfQoKCSAgICAgICAgX3RoaXMuX3NvY2sub25vcGVuID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAgIF90aGlzLl9zZW5kT3BlbihmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBjYWxsYmFjaygpOwoJICAgICAgICAgIH0pOwoJICAgICAgICB9OwoKCSAgICAgICAgX3RoaXMuX3NvY2sub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICB2YXIgbXNnID0gSlNPTi5wYXJzZShlLmRhdGEpOwoJICAgICAgICAgIGNvbnNvbGUubG9nKCdbVmVydHhQcm90b1N0dWI6IE1OIC0+IFNPQ0tFVCBPTiBNRVNTQUdFXScsIG1zZyk7CgkgICAgICAgICAgaWYgKG1zZy5mcm9tID09PSAnbW46L3Nlc3Npb24nKSB7CgkgICAgICAgICAgICBpZiAoX3RoaXMuX3Nlc3Npb25DYWxsYmFjaykgewoJICAgICAgICAgICAgICBfdGhpcy5fc2Vzc2lvbkNhbGxiYWNrKG1zZyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIGlmIChfdGhpcy5fZmlsdGVyKG1zZykpIHsKCSAgICAgICAgICAgICAgX3RoaXMuX2RlbGl2ZXIobXNnKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgIH07CgoJICAgICAgICBfdGhpcy5fc29jay5vbmNsb3NlID0gZnVuY3Rpb24gKGV2ZW50KSB7CgkgICAgICAgICAgdmFyIHJlYXNvbiA9IHZvaWQgMDsKCgkgICAgICAgICAgLy9TZWUgaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzY0NTUjc2VjdGlvbi03LjQKCSAgICAgICAgICBpZiAoZXZlbnQuY29kZSA9PT0gMTAwMCkgewoJICAgICAgICAgICAgcmVhc29uID0gJ05vcm1hbCBjbG9zdXJlLCBtZWFuaW5nIHRoYXQgdGhlIHB1cnBvc2UgZm9yIHdoaWNoIHRoZSBjb25uZWN0aW9uIHdhcyBlc3RhYmxpc2hlZCBoYXMgYmVlbiBmdWxmaWxsZWQuJzsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDEpIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyBcJ2dvaW5nIGF3YXlcJywgc3VjaCBhcyBhIHNlcnZlciBnb2luZyBkb3duIG9yIGEgYnJvd3NlciBoYXZpbmcgbmF2aWdhdGVkIGF3YXkgZnJvbSBhIHBhZ2UuJzsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDIpIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBkdWUgdG8gYSBwcm90b2NvbCBlcnJvcic7CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDAzKSB7CgkgICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBoYXMgcmVjZWl2ZWQgYSB0eXBlIG9mIGRhdGEgaXQgY2Fubm90IGFjY2VwdCAoZS5nLiwgYW4gZW5kcG9pbnQgdGhhdCB1bmRlcnN0YW5kcyBvbmx5IHRleHQgZGF0YSBNQVkgc2VuZCB0aGlzIGlmIGl0IHJlY2VpdmVzIGEgYmluYXJ5IG1lc3NhZ2UpLic7CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA0KSB7CgkgICAgICAgICAgICByZWFzb24gPSAnUmVzZXJ2ZWQuIFRoZSBzcGVjaWZpYyBtZWFuaW5nIG1pZ2h0IGJlIGRlZmluZWQgaW4gdGhlIGZ1dHVyZS4nOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwNSkgewoJICAgICAgICAgICAgcmVhc29uID0gJ05vIHN0YXR1cyBjb2RlIHdhcyBhY3R1YWxseSBwcmVzZW50Lic7CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA2KSB7CgkgICAgICAgICAgICByZWFzb24gPSAnVGhlIGNvbm5lY3Rpb24gd2FzIGNsb3NlZCBhYm5vcm1hbGx5LCBlLmcuLCB3aXRob3V0IHNlbmRpbmcgb3IgcmVjZWl2aW5nIGEgQ2xvc2UgY29udHJvbCBmcmFtZSc7CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA3KSB7CgkgICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBoYXMgcmVjZWl2ZWQgZGF0YSB3aXRoaW4gYSBtZXNzYWdlIHRoYXQgd2FzIG5vdCBjb25zaXN0ZW50IHdpdGggdGhlIHR5cGUgb2YgdGhlIG1lc3NhZ2UgKGUuZy4sIG5vbi1VVEYtOCBbaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzYyOV0gZGF0YSB3aXRoaW4gYSB0ZXh0IG1lc3NhZ2UpLic7CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA4KSB7CgkgICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBoYXMgcmVjZWl2ZWQgYSBtZXNzYWdlIHRoYXQgInZpb2xhdGVzIGl0cyBwb2xpY3kiLiBUaGlzIHJlYXNvbiBpcyBnaXZlbiBlaXRoZXIgaWYgdGhlcmUgaXMgbm8gb3RoZXIgc3V0aWJsZSByZWFzb24sIG9yIGlmIHRoZXJlIGlzIGEgbmVlZCB0byBoaWRlIHNwZWNpZmljIGRldGFpbHMgYWJvdXQgdGhlIHBvbGljeS4nOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwOSkgewoJICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgaGFzIHJlY2VpdmVkIGEgbWVzc2FnZSB0aGF0IGlzIHRvbyBiaWcgZm9yIGl0IHRvIHByb2Nlc3MuJzsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMTApIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCAoY2xpZW50KSBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGhhcyBleHBlY3RlZCB0aGUgc2VydmVyIHRvIG5lZ290aWF0ZSBvbmUgb3IgbW9yZSBleHRlbnNpb24sIGJ1dCB0aGUgc2VydmVyIGRpZG5cJ3QgcmV0dXJuIHRoZW0gaW4gdGhlIHJlc3BvbnNlIG1lc3NhZ2Ugb2YgdGhlIFdlYlNvY2tldCBoYW5kc2hha2UuIDxiciAvPiBTcGVjaWZpY2FsbHksIHRoZSBleHRlbnNpb25zIHRoYXQgYXJlIG5lZWRlZCBhcmU6ICcgKyBldmVudC5yZWFzb247CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDExKSB7CgkgICAgICAgICAgICByZWFzb24gPSAnQSBzZXJ2ZXIgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBlbmNvdW50ZXJlZCBhbiB1bmV4cGVjdGVkIGNvbmRpdGlvbiB0aGF0IHByZXZlbnRlZCBpdCBmcm9tIGZ1bGZpbGxpbmcgdGhlIHJlcXVlc3QuJzsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMTUpIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdUaGUgY29ubmVjdGlvbiB3YXMgY2xvc2VkIGR1ZSB0byBhIGZhaWx1cmUgdG8gcGVyZm9ybSBhIFRMUyBoYW5kc2hha2UgKGUuZy4sIHRoZSBzZXJ2ZXIgY2VydGlmaWNhdGUgY2FuXCd0IGJlIHZlcmlmaWVkKS4nOwoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICByZWFzb24gPSAnVW5rbm93biByZWFzb24nOwoJICAgICAgICAgIH0KCgkgICAgICAgICAgZGVsZXRlIF90aGlzLl9zb2NrOwoJICAgICAgICAgIF90aGlzLl9zZW5kU3RhdHVzKCdkaXNjb25uZWN0ZWQnLCByZWFzb24pOwoJICAgICAgICB9OwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgX3RoaXMuX3dhaXRSZWFkeShjYWxsYmFjayk7CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnY29uZmlnJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9jb25maWc7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAncnVudGltZVNlc3Npb24nLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX3J1bnRpbWVTZXNzaW9uVVJMOwoJICAgIH0KCSAgfV0pOwoKCSAgcmV0dXJuIFZlcnR4UHJvdG9TdHViOwoJfSgpOwoKCWZ1bmN0aW9uIGFjdGl2YXRlKHVybCwgYnVzLCBjb25maWcpIHsKCSAgcmV0dXJuIHsKCSAgICBuYW1lOiAnVmVydHhQcm90b1N0dWInLAoJICAgIGluc3RhbmNlOiBuZXcgVmVydHhQcm90b1N0dWIodXJsLCBidXMsIGNvbmZpZykKCSAgfTsKCX0KCgkvKioNCgkqIENhbGxiYWNrIHVzZWQgdG8gc2VuZCBtZXNzYWdlcw0KCSogQGNhbGxiYWNrIFBvc3RNZXNzYWdlDQoJKiBAcGFyYW0ge01lc3NhZ2V9IG1zZyAtIE1lc3NhZ2UgdG8gc2VuZA0KCSovCgoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9Ci8qKioqKiovIF0pCn0pOwo7",
      "sourceCodeClassname": "VertxProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "language": "javascript",
    "signature": "",
    "messageSchemas": "",
    "configuration": {
      "url": "wss://localhost:9090/ws"
    },
    "constraints": {
      "browser": true
    },
    "policies": "",
    "dataObjects": [],
    "interworking": false,
    "description": "Description of VertxProtoStub",
    "objectName": "default",
    "accessControlPolicy": "somePolicy"
  },
  "VertxProtoStubNode": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgiY3J5cHRvIiksIHJlcXVpcmUoImV2ZW50cyIpLCByZXF1aXJlKCJodHRwIiksIHJlcXVpcmUoInVybCIpLCByZXF1aXJlKCJidWZmZXIiKSwgcmVxdWlyZSgiZnMiKSwgcmVxdWlyZSgiaHR0cHMiKSwgcmVxdWlyZSgicGF0aCIpLCByZXF1aXJlKCJ6bGliIikpOwoJZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpCgkJZGVmaW5lKCJWZXJ0eFByb3RvU3R1Yk5vZGUiLCBbImNyeXB0byIsICJldmVudHMiLCAiaHR0cCIsICJ1cmwiLCAiYnVmZmVyIiwgImZzIiwgImh0dHBzIiwgInBhdGgiLCAiemxpYiJdLCBmYWN0b3J5KTsKCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCWV4cG9ydHNbIlZlcnR4UHJvdG9TdHViTm9kZSJdID0gZmFjdG9yeShyZXF1aXJlKCJjcnlwdG8iKSwgcmVxdWlyZSgiZXZlbnRzIiksIHJlcXVpcmUoImh0dHAiKSwgcmVxdWlyZSgidXJsIiksIHJlcXVpcmUoImJ1ZmZlciIpLCByZXF1aXJlKCJmcyIpLCByZXF1aXJlKCJodHRwcyIpLCByZXF1aXJlKCJwYXRoIiksIHJlcXVpcmUoInpsaWIiKSk7CgllbHNlCgkJcm9vdFsiVmVydHhQcm90b1N0dWJOb2RlIl0gPSBmYWN0b3J5KHJvb3RbImNyeXB0byJdLCByb290WyJldmVudHMiXSwgcm9vdFsiaHR0cCJdLCByb290WyJ1cmwiXSwgcm9vdFsiYnVmZmVyIl0sIHJvb3RbImZzIl0sIHJvb3RbImh0dHBzIl0sIHJvb3RbInBhdGgiXSwgcm9vdFsiemxpYiJdKTsKfSkodGhpcywgZnVuY3Rpb24oX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV83X18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMTlfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8yMF9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzIxX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfNDdfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV80OF9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzQ5X18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfNTBfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV81MV9fKSB7CnJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwovKioqKioqLwovKioqKioqLyAJLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb24KLyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCWk6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsOiBmYWxzZSwKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLwovKioqKioqLyAJCS8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbgovKioqKioqLyAJCW1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pOwovKioqKioqLwovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubCA9IHRydWU7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9Ci8qKioqKiovCi8qKioqKiovCi8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKQovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlczsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gaWRlbnRpdHkgZnVuY3Rpb24gZm9yIGNhbGxpbmcgaGFybW9ueSBpbXBvcnRzIHdpdGggdGhlIGNvcnJlY3QgY29udGV4dAovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5pID0gZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9OwovKioqKioqLwovKioqKioqLyAJLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHsKLyoqKioqKi8gCQlpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7Ci8qKioqKiovIAkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7Ci8qKioqKiovIAkJCQljb25maWd1cmFibGU6IGZhbHNlLAovKioqKioqLyAJCQkJZW51bWVyYWJsZTogdHJ1ZSwKLyoqKioqKi8gCQkJCWdldDogZ2V0dGVyCi8qKioqKiovIAkJCX0pOwovKioqKioqLyAJCX0KLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlcwovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7Ci8qKioqKiovIAkJdmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/Ci8qKioqKiovIAkJCWZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6Ci8qKioqKiovIAkJCWZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07Ci8qKioqKiovIAkJX193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpOwovKioqKioqLyAJCXJldHVybiBnZXR0ZXI7Ci8qKioqKiovIAl9OwovKioqKioqLwovKioqKioqLyAJLy8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfXwovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gIiI7Ci8qKioqKiovCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDI2KTsKLyoqKioqKi8gfSkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gKFsKLyogMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgYnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NykKCmlmIChCdWZmZXIuZnJvbSAmJiBCdWZmZXIuYWxsb2MgJiYgQnVmZmVyLmFsbG9jVW5zYWZlICYmIEJ1ZmZlci5hbGxvY1Vuc2FmZVNsb3cpIHsKICBtb2R1bGUuZXhwb3J0cyA9IGJ1ZmZlcgp9IGVsc2UgewogIC8vIENvcHkgcHJvcGVydGllcyBmcm9tIHJlcXVpcmUoJ2J1ZmZlcicpCiAgT2JqZWN0LmtleXMoYnVmZmVyKS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wKSB7CiAgICBleHBvcnRzW3Byb3BdID0gYnVmZmVyW3Byb3BdCiAgfSkKICBleHBvcnRzLkJ1ZmZlciA9IFNhZmVCdWZmZXIKfQoKZnVuY3Rpb24gU2FmZUJ1ZmZlciAoYXJnLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHsKICByZXR1cm4gQnVmZmVyKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKQp9CgovLyBDb3B5IHN0YXRpYyBtZXRob2RzIGZyb20gQnVmZmVyCk9iamVjdC5rZXlzKEJ1ZmZlcikuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkgewogIFNhZmVCdWZmZXJbcHJvcF0gPSBCdWZmZXJbcHJvcF0KfSkKClNhZmVCdWZmZXIuZnJvbSA9IGZ1bmN0aW9uIChhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkgewogIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBub3QgYmUgYSBudW1iZXInKQogIH0KICByZXR1cm4gQnVmZmVyKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKQp9CgpTYWZlQnVmZmVyLmFsbG9jID0gZnVuY3Rpb24gKHNpemUsIGZpbGwsIGVuY29kaW5nKSB7CiAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIG51bWJlcicpCiAgfQogIHZhciBidWYgPSBCdWZmZXIoc2l6ZSkKICBpZiAoZmlsbCAhPT0gdW5kZWZpbmVkKSB7CiAgICBpZiAodHlwZW9mIGVuY29kaW5nID09PSAnc3RyaW5nJykgewogICAgICBidWYuZmlsbChmaWxsLCBlbmNvZGluZykKICAgIH0gZWxzZSB7CiAgICAgIGJ1Zi5maWxsKGZpbGwpCiAgICB9CiAgfSBlbHNlIHsKICAgIGJ1Zi5maWxsKDApCiAgfQogIHJldHVybiBidWYKfQoKU2FmZUJ1ZmZlci5hbGxvY1Vuc2FmZSA9IGZ1bmN0aW9uIChzaXplKSB7CiAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIG51bWJlcicpCiAgfQogIHJldHVybiBCdWZmZXIoc2l6ZSkKfQoKU2FmZUJ1ZmZlci5hbGxvY1Vuc2FmZVNsb3cgPSBmdW5jdGlvbiAoc2l6ZSkgewogIGlmICh0eXBlb2Ygc2l6ZSAhPT0gJ251bWJlcicpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBudW1iZXInKQogIH0KICByZXR1cm4gYnVmZmVyLlNsb3dCdWZmZXIoc2l6ZSkKfQoKCi8qKiovIH0pLAovKiAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHkKbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygxMCkoZnVuY3Rpb24oKXsKICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpjb25zdCBzYWZlQnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKY29uc3QgemxpYiA9IF9fd2VicGFja19yZXF1aXJlX18oNTEpOwoKY29uc3QgYnVmZmVyVXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7Cgpjb25zdCBCdWZmZXIgPSBzYWZlQnVmZmVyLkJ1ZmZlcjsKCmNvbnN0IEFWQUlMQUJMRV9XSU5ET1dfQklUUyA9IFs4LCA5LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1XTsKY29uc3QgVFJBSUxFUiA9IEJ1ZmZlci5mcm9tKFsweDAwLCAweDAwLCAweGZmLCAweGZmXSk7CmNvbnN0IEVNUFRZX0JMT0NLID0gQnVmZmVyLmZyb20oWzB4MDBdKTsKY29uc3QgREVGQVVMVF9XSU5ET1dfQklUUyA9IDE1Owpjb25zdCBERUZBVUxUX01FTV9MRVZFTCA9IDg7CgovKioKICogUGVyLW1lc3NhZ2UgRGVmbGF0ZSBpbXBsZW1lbnRhdGlvbi4KICovCmNsYXNzIFBlck1lc3NhZ2VEZWZsYXRlIHsKICBjb25zdHJ1Y3RvciAob3B0aW9ucywgaXNTZXJ2ZXIsIG1heFBheWxvYWQpIHsKICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogICAgdGhpcy5faXNTZXJ2ZXIgPSAhIWlzU2VydmVyOwogICAgdGhpcy5faW5mbGF0ZSA9IG51bGw7CiAgICB0aGlzLl9kZWZsYXRlID0gbnVsbDsKICAgIHRoaXMucGFyYW1zID0gbnVsbDsKICAgIHRoaXMuX21heFBheWxvYWQgPSBtYXhQYXlsb2FkIHx8IDA7CiAgICB0aGlzLnRocmVzaG9sZCA9IHRoaXMuX29wdGlvbnMudGhyZXNob2xkID09PSB1bmRlZmluZWQgPyAxMDI0IDogdGhpcy5fb3B0aW9ucy50aHJlc2hvbGQ7CiAgfQoKICBzdGF0aWMgZ2V0IGV4dGVuc2lvbk5hbWUgKCkgewogICAgcmV0dXJuICdwZXJtZXNzYWdlLWRlZmxhdGUnOwogIH0KCiAgLyoqCiAgICogQ3JlYXRlIGV4dGVuc2lvbiBwYXJhbWV0ZXJzIG9mZmVyLgogICAqCiAgICogQHJldHVybiB7T2JqZWN0fSBFeHRlbnNpb24gcGFyYW1ldGVycwogICAqIEBwdWJsaWMKICAgKi8KICBvZmZlciAoKSB7CiAgICBjb25zdCBwYXJhbXMgPSB7fTsKCiAgICBpZiAodGhpcy5fb3B0aW9ucy5zZXJ2ZXJOb0NvbnRleHRUYWtlb3ZlcikgewogICAgICBwYXJhbXMuc2VydmVyX25vX2NvbnRleHRfdGFrZW92ZXIgPSB0cnVlOwogICAgfQogICAgaWYgKHRoaXMuX29wdGlvbnMuY2xpZW50Tm9Db250ZXh0VGFrZW92ZXIpIHsKICAgICAgcGFyYW1zLmNsaWVudF9ub19jb250ZXh0X3Rha2VvdmVyID0gdHJ1ZTsKICAgIH0KICAgIGlmICh0aGlzLl9vcHRpb25zLnNlcnZlck1heFdpbmRvd0JpdHMpIHsKICAgICAgcGFyYW1zLnNlcnZlcl9tYXhfd2luZG93X2JpdHMgPSB0aGlzLl9vcHRpb25zLnNlcnZlck1heFdpbmRvd0JpdHM7CiAgICB9CiAgICBpZiAodGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzKSB7CiAgICAgIHBhcmFtcy5jbGllbnRfbWF4X3dpbmRvd19iaXRzID0gdGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzOwogICAgfSBlbHNlIGlmICh0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHMgPT0gbnVsbCkgewogICAgICBwYXJhbXMuY2xpZW50X21heF93aW5kb3dfYml0cyA9IHRydWU7CiAgICB9CgogICAgcmV0dXJuIHBhcmFtczsKICB9CgogIC8qKgogICAqIEFjY2VwdCBleHRlbnNpb24gb2ZmZXIuCiAgICoKICAgKiBAcGFyYW0ge0FycmF5fSBwYXJhbXNMaXN0IEV4dGVuc2lvbiBwYXJhbWV0ZXJzCiAgICogQHJldHVybiB7T2JqZWN0fSBBY2NlcHRlZCBjb25maWd1cmF0aW9uCiAgICogQHB1YmxpYwogICAqLwogIGFjY2VwdCAocGFyYW1zTGlzdCkgewogICAgcGFyYW1zTGlzdCA9IHRoaXMubm9ybWFsaXplUGFyYW1zKHBhcmFtc0xpc3QpOwoKICAgIHZhciBwYXJhbXM7CiAgICBpZiAodGhpcy5faXNTZXJ2ZXIpIHsKICAgICAgcGFyYW1zID0gdGhpcy5hY2NlcHRBc1NlcnZlcihwYXJhbXNMaXN0KTsKICAgIH0gZWxzZSB7CiAgICAgIHBhcmFtcyA9IHRoaXMuYWNjZXB0QXNDbGllbnQocGFyYW1zTGlzdCk7CiAgICB9CgogICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7CiAgICByZXR1cm4gcGFyYW1zOwogIH0KCiAgLyoqCiAgICogUmVsZWFzZXMgYWxsIHJlc291cmNlcyB1c2VkIGJ5IHRoZSBleHRlbnNpb24uCiAgICoKICAgKiBAcHVibGljCiAgICovCiAgY2xlYW51cCAoKSB7CiAgICBpZiAodGhpcy5faW5mbGF0ZSkgewogICAgICBpZiAodGhpcy5faW5mbGF0ZS53cml0ZUluUHJvZ3Jlc3MpIHsKICAgICAgICB0aGlzLl9pbmZsYXRlLnBlbmRpbmdDbG9zZSA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5faW5mbGF0ZS5jbG9zZSgpOwogICAgICAgIHRoaXMuX2luZmxhdGUgPSBudWxsOwogICAgICB9CiAgICB9CiAgICBpZiAodGhpcy5fZGVmbGF0ZSkgewogICAgICBpZiAodGhpcy5fZGVmbGF0ZS53cml0ZUluUHJvZ3Jlc3MpIHsKICAgICAgICB0aGlzLl9kZWZsYXRlLnBlbmRpbmdDbG9zZSA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5fZGVmbGF0ZS5jbG9zZSgpOwogICAgICAgIHRoaXMuX2RlZmxhdGUgPSBudWxsOwogICAgICB9CiAgICB9CiAgfQoKICAvKioKICAgKiBBY2NlcHQgZXh0ZW5zaW9uIG9mZmVyIGZyb20gY2xpZW50LgogICAqCiAgICogQHBhcmFtIHtBcnJheX0gcGFyYW1zTGlzdCBFeHRlbnNpb24gcGFyYW1ldGVycwogICAqIEByZXR1cm4ge09iamVjdH0gQWNjZXB0ZWQgY29uZmlndXJhdGlvbgogICAqIEBwcml2YXRlCiAgICovCiAgYWNjZXB0QXNTZXJ2ZXIgKHBhcmFtc0xpc3QpIHsKICAgIGNvbnN0IGFjY2VwdGVkID0ge307CiAgICBjb25zdCByZXN1bHQgPSBwYXJhbXNMaXN0LnNvbWUoKHBhcmFtcykgPT4gewogICAgICBpZiAoKAogICAgICAgIHRoaXMuX29wdGlvbnMuc2VydmVyTm9Db250ZXh0VGFrZW92ZXIgPT09IGZhbHNlICYmCiAgICAgICAgcGFyYW1zLnNlcnZlcl9ub19jb250ZXh0X3Rha2VvdmVyCiAgICAgICkgfHwgKAogICAgICAgIHRoaXMuX29wdGlvbnMuc2VydmVyTWF4V2luZG93Qml0cyA9PT0gZmFsc2UgJiYKICAgICAgICBwYXJhbXMuc2VydmVyX21heF93aW5kb3dfYml0cwogICAgICApIHx8ICgKICAgICAgICB0eXBlb2YgdGhpcy5fb3B0aW9ucy5zZXJ2ZXJNYXhXaW5kb3dCaXRzID09PSAnbnVtYmVyJyAmJgogICAgICAgIHR5cGVvZiBwYXJhbXMuc2VydmVyX21heF93aW5kb3dfYml0cyA9PT0gJ251bWJlcicgJiYKICAgICAgICB0aGlzLl9vcHRpb25zLnNlcnZlck1heFdpbmRvd0JpdHMgPiBwYXJhbXMuc2VydmVyX21heF93aW5kb3dfYml0cwogICAgICApIHx8ICgKICAgICAgICB0eXBlb2YgdGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzID09PSAnbnVtYmVyJyAmJgogICAgICAgICFwYXJhbXMuY2xpZW50X21heF93aW5kb3dfYml0cwogICAgICApKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoCiAgICAgICAgdGhpcy5fb3B0aW9ucy5zZXJ2ZXJOb0NvbnRleHRUYWtlb3ZlciB8fAogICAgICAgIHBhcmFtcy5zZXJ2ZXJfbm9fY29udGV4dF90YWtlb3ZlcgogICAgICApIHsKICAgICAgICBhY2NlcHRlZC5zZXJ2ZXJfbm9fY29udGV4dF90YWtlb3ZlciA9IHRydWU7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuX29wdGlvbnMuY2xpZW50Tm9Db250ZXh0VGFrZW92ZXIpIHsKICAgICAgICBhY2NlcHRlZC5jbGllbnRfbm9fY29udGV4dF90YWtlb3ZlciA9IHRydWU7CiAgICAgIH0KICAgICAgaWYgKAogICAgICAgIHRoaXMuX29wdGlvbnMuY2xpZW50Tm9Db250ZXh0VGFrZW92ZXIgIT09IGZhbHNlICYmCiAgICAgICAgcGFyYW1zLmNsaWVudF9ub19jb250ZXh0X3Rha2VvdmVyCiAgICAgICkgewogICAgICAgIGFjY2VwdGVkLmNsaWVudF9ub19jb250ZXh0X3Rha2VvdmVyID0gdHJ1ZTsKICAgICAgfQogICAgICBpZiAodHlwZW9mIHRoaXMuX29wdGlvbnMuc2VydmVyTWF4V2luZG93Qml0cyA9PT0gJ251bWJlcicpIHsKICAgICAgICBhY2NlcHRlZC5zZXJ2ZXJfbWF4X3dpbmRvd19iaXRzID0gdGhpcy5fb3B0aW9ucy5zZXJ2ZXJNYXhXaW5kb3dCaXRzOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBwYXJhbXMuc2VydmVyX21heF93aW5kb3dfYml0cyA9PT0gJ251bWJlcicpIHsKICAgICAgICBhY2NlcHRlZC5zZXJ2ZXJfbWF4X3dpbmRvd19iaXRzID0gcGFyYW1zLnNlcnZlcl9tYXhfd2luZG93X2JpdHM7CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiB0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHMgPT09ICdudW1iZXInKSB7CiAgICAgICAgYWNjZXB0ZWQuY2xpZW50X21heF93aW5kb3dfYml0cyA9IHRoaXMuX29wdGlvbnMuY2xpZW50TWF4V2luZG93Qml0czsKICAgICAgfSBlbHNlIGlmICgKICAgICAgICB0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHMgIT09IGZhbHNlICYmCiAgICAgICAgdHlwZW9mIHBhcmFtcy5jbGllbnRfbWF4X3dpbmRvd19iaXRzID09PSAnbnVtYmVyJwogICAgICApIHsKICAgICAgICBhY2NlcHRlZC5jbGllbnRfbWF4X3dpbmRvd19iaXRzID0gcGFyYW1zLmNsaWVudF9tYXhfd2luZG93X2JpdHM7CiAgICAgIH0KICAgICAgcmV0dXJuIHRydWU7CiAgICB9KTsKCiAgICBpZiAoIXJlc3VsdCkgdGhyb3cgbmV3IEVycm9yKGBEb2Vzbid0IHN1cHBvcnQgdGhlIG9mZmVyZWQgY29uZmlndXJhdGlvbmApOwoKICAgIHJldHVybiBhY2NlcHRlZDsKICB9CgogIC8qKgogICAqIEFjY2VwdCBleHRlbnNpb24gcmVzcG9uc2UgZnJvbSBzZXJ2ZXIuCiAgICoKICAgKiBAcGFyYW0ge0FycmF5fSBwYXJhbXNMaXN0IEV4dGVuc2lvbiBwYXJhbWV0ZXJzCiAgICogQHJldHVybiB7T2JqZWN0fSBBY2NlcHRlZCBjb25maWd1cmF0aW9uCiAgICogQHByaXZhdGUKICAgKi8KICBhY2NlcHRBc0NsaWVudCAocGFyYW1zTGlzdCkgewogICAgY29uc3QgcGFyYW1zID0gcGFyYW1zTGlzdFswXTsKCiAgICBpZiAodGhpcy5fb3B0aW9ucy5jbGllbnROb0NvbnRleHRUYWtlb3ZlciAhPSBudWxsKSB7CiAgICAgIGlmICgKICAgICAgICB0aGlzLl9vcHRpb25zLmNsaWVudE5vQ29udGV4dFRha2VvdmVyID09PSBmYWxzZSAmJgogICAgICAgIHBhcmFtcy5jbGllbnRfbm9fY29udGV4dF90YWtlb3ZlcgogICAgICApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdmFsdWUgZm9yICJjbGllbnRfbm9fY29udGV4dF90YWtlb3ZlciInKTsKICAgICAgfQogICAgfQogICAgaWYgKHRoaXMuX29wdGlvbnMuY2xpZW50TWF4V2luZG93Qml0cyAhPSBudWxsKSB7CiAgICAgIGlmICgKICAgICAgICB0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHMgPT09IGZhbHNlICYmCiAgICAgICAgcGFyYW1zLmNsaWVudF9tYXhfd2luZG93X2JpdHMKICAgICAgKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHZhbHVlIGZvciAiY2xpZW50X21heF93aW5kb3dfYml0cyInKTsKICAgICAgfQogICAgICBpZiAoCiAgICAgICAgdHlwZW9mIHRoaXMuX29wdGlvbnMuY2xpZW50TWF4V2luZG93Qml0cyA9PT0gJ251bWJlcicgJiYgKAogICAgICAgICFwYXJhbXMuY2xpZW50X21heF93aW5kb3dfYml0cyB8fAogICAgICAgIHBhcmFtcy5jbGllbnRfbWF4X3dpbmRvd19iaXRzID4gdGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzCiAgICAgICkpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdmFsdWUgZm9yICJjbGllbnRfbWF4X3dpbmRvd19iaXRzIicpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHBhcmFtczsKICB9CgogIC8qKgogICAqIE5vcm1hbGl6ZSBleHRlbnNpb25zIHBhcmFtZXRlcnMuCiAgICoKICAgKiBAcGFyYW0ge0FycmF5fSBwYXJhbXNMaXN0IEV4dGVuc2lvbiBwYXJhbWV0ZXJzCiAgICogQHJldHVybiB7QXJyYXl9IE5vcm1hbGl6ZWQgZXh0ZW5zaW9ucyBwYXJhbWV0ZXJzCiAgICogQHByaXZhdGUKICAgKi8KICBub3JtYWxpemVQYXJhbXMgKHBhcmFtc0xpc3QpIHsKICAgIHJldHVybiBwYXJhbXNMaXN0Lm1hcCgocGFyYW1zKSA9PiB7CiAgICAgIE9iamVjdC5rZXlzKHBhcmFtcykuZm9yRWFjaCgoa2V5KSA9PiB7CiAgICAgICAgdmFyIHZhbHVlID0gcGFyYW1zW2tleV07CiAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDEpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTXVsdGlwbGUgZXh0ZW5zaW9uIHBhcmFtZXRlcnMgZm9yICR7a2V5fWApOwogICAgICAgIH0KCiAgICAgICAgdmFsdWUgPSB2YWx1ZVswXTsKCiAgICAgICAgc3dpdGNoIChrZXkpIHsKICAgICAgICAgIGNhc2UgJ3NlcnZlcl9ub19jb250ZXh0X3Rha2VvdmVyJzoKICAgICAgICAgIGNhc2UgJ2NsaWVudF9ub19jb250ZXh0X3Rha2VvdmVyJzoKICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB0cnVlKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIGV4dGVuc2lvbiBwYXJhbWV0ZXIgdmFsdWUgZm9yICR7a2V5fSAoJHt2YWx1ZX0pYCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcGFyYW1zW2tleV0gPSB0cnVlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgJ3NlcnZlcl9tYXhfd2luZG93X2JpdHMnOgogICAgICAgICAgY2FzZSAnY2xpZW50X21heF93aW5kb3dfYml0cyc6CiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgdmFsdWUgPSBwYXJzZUludCh2YWx1ZSwgMTApOwogICAgICAgICAgICAgIGlmICghfkFWQUlMQUJMRV9XSU5ET1dfQklUUy5pbmRleE9mKHZhbHVlKSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIGV4dGVuc2lvbiBwYXJhbWV0ZXIgdmFsdWUgZm9yICR7a2V5fSAoJHt2YWx1ZX0pYCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghdGhpcy5faXNTZXJ2ZXIgJiYgdmFsdWUgPT09IHRydWUpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgZXh0ZW5zaW9uIHBhcmFtZXRlciB2YWx1ZSBmb3IgJHtrZXl9YCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcGFyYW1zW2tleV0gPSB2YWx1ZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vdCBkZWZpbmVkIGV4dGVuc2lvbiBwYXJhbWV0ZXIgKCR7a2V5fSlgKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gcGFyYW1zOwogICAgfSk7CiAgfQoKICAvKioKICAgKiBEZWNvbXByZXNzIGRhdGEuCiAgICoKICAgKiBAcGFyYW0ge0J1ZmZlcn0gZGF0YSBDb21wcmVzc2VkIGRhdGEKICAgKiBAcGFyYW0ge0Jvb2xlYW59IGZpbiBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdGhpcyBpcyB0aGUgbGFzdCBmcmFnbWVudAogICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIENhbGxiYWNrCiAgICogQHB1YmxpYwogICAqLwogIGRlY29tcHJlc3MgKGRhdGEsIGZpbiwgY2FsbGJhY2spIHsKICAgIGNvbnN0IGVuZHBvaW50ID0gdGhpcy5faXNTZXJ2ZXIgPyAnY2xpZW50JyA6ICdzZXJ2ZXInOwoKICAgIGlmICghdGhpcy5faW5mbGF0ZSkgewogICAgICBjb25zdCBtYXhXaW5kb3dCaXRzID0gdGhpcy5wYXJhbXNbYCR7ZW5kcG9pbnR9X21heF93aW5kb3dfYml0c2BdOwogICAgICB0aGlzLl9pbmZsYXRlID0gemxpYi5jcmVhdGVJbmZsYXRlUmF3KHsKICAgICAgICB3aW5kb3dCaXRzOiB0eXBlb2YgbWF4V2luZG93Qml0cyA9PT0gJ251bWJlcicgPyBtYXhXaW5kb3dCaXRzIDogREVGQVVMVF9XSU5ET1dfQklUUwogICAgICB9KTsKICAgIH0KICAgIHRoaXMuX2luZmxhdGUud3JpdGVJblByb2dyZXNzID0gdHJ1ZTsKCiAgICB2YXIgdG90YWxMZW5ndGggPSAwOwogICAgY29uc3QgYnVmZmVycyA9IFtdOwogICAgdmFyIGVycjsKCiAgICBjb25zdCBvbkRhdGEgPSAoZGF0YSkgPT4gewogICAgICB0b3RhbExlbmd0aCArPSBkYXRhLmxlbmd0aDsKICAgICAgaWYgKHRoaXMuX21heFBheWxvYWQgPCAxIHx8IHRvdGFsTGVuZ3RoIDw9IHRoaXMuX21heFBheWxvYWQpIHsKICAgICAgICByZXR1cm4gYnVmZmVycy5wdXNoKGRhdGEpOwogICAgICB9CgogICAgICBlcnIgPSBuZXcgRXJyb3IoJ21heCBwYXlsb2FkIHNpemUgZXhjZWVkZWQnKTsKICAgICAgZXJyLmNsb3NlQ29kZSA9IDEwMDk7CiAgICAgIHRoaXMuX2luZmxhdGUucmVzZXQoKTsKICAgIH07CgogICAgY29uc3Qgb25FcnJvciA9IChlcnIpID0+IHsKICAgICAgY2xlYW51cCgpOwogICAgICBjYWxsYmFjayhlcnIpOwogICAgfTsKCiAgICBjb25zdCBjbGVhbnVwID0gKCkgPT4gewogICAgICBpZiAoIXRoaXMuX2luZmxhdGUpIHJldHVybjsKCiAgICAgIHRoaXMuX2luZmxhdGUucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25FcnJvcik7CiAgICAgIHRoaXMuX2luZmxhdGUucmVtb3ZlTGlzdGVuZXIoJ2RhdGEnLCBvbkRhdGEpOwogICAgICB0aGlzLl9pbmZsYXRlLndyaXRlSW5Qcm9ncmVzcyA9IGZhbHNlOwoKICAgICAgaWYgKAogICAgICAgIChmaW4gJiYgdGhpcy5wYXJhbXNbYCR7ZW5kcG9pbnR9X25vX2NvbnRleHRfdGFrZW92ZXJgXSkgfHwKICAgICAgICB0aGlzLl9pbmZsYXRlLnBlbmRpbmdDbG9zZQogICAgICApIHsKICAgICAgICB0aGlzLl9pbmZsYXRlLmNsb3NlKCk7CiAgICAgICAgdGhpcy5faW5mbGF0ZSA9IG51bGw7CiAgICAgIH0KICAgIH07CgogICAgdGhpcy5faW5mbGF0ZS5vbignZXJyb3InLCBvbkVycm9yKS5vbignZGF0YScsIG9uRGF0YSk7CiAgICB0aGlzLl9pbmZsYXRlLndyaXRlKGRhdGEpOwogICAgaWYgKGZpbikgdGhpcy5faW5mbGF0ZS53cml0ZShUUkFJTEVSKTsKCiAgICB0aGlzLl9pbmZsYXRlLmZsdXNoKCgpID0+IHsKICAgICAgY2xlYW51cCgpOwogICAgICBpZiAoZXJyKSBjYWxsYmFjayhlcnIpOwogICAgICBlbHNlIGNhbGxiYWNrKG51bGwsIGJ1ZmZlclV0aWwuY29uY2F0KGJ1ZmZlcnMsIHRvdGFsTGVuZ3RoKSk7CiAgICB9KTsKICB9CgogIC8qKgogICAqIENvbXByZXNzIGRhdGEuCiAgICoKICAgKiBAcGFyYW0ge0J1ZmZlcn0gZGF0YSBEYXRhIHRvIGNvbXByZXNzCiAgICogQHBhcmFtIHtCb29sZWFufSBmaW4gU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRoaXMgaXMgdGhlIGxhc3QgZnJhZ21lbnQKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBDYWxsYmFjawogICAqIEBwdWJsaWMKICAgKi8KICBjb21wcmVzcyAoZGF0YSwgZmluLCBjYWxsYmFjaykgewogICAgaWYgKCFkYXRhIHx8IGRhdGEubGVuZ3RoID09PSAwKSB7CiAgICAgIHByb2Nlc3MubmV4dFRpY2soY2FsbGJhY2ssIG51bGwsIEVNUFRZX0JMT0NLKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGVuZHBvaW50ID0gdGhpcy5faXNTZXJ2ZXIgPyAnc2VydmVyJyA6ICdjbGllbnQnOwoKICAgIGlmICghdGhpcy5fZGVmbGF0ZSkgewogICAgICBjb25zdCBtYXhXaW5kb3dCaXRzID0gdGhpcy5wYXJhbXNbYCR7ZW5kcG9pbnR9X21heF93aW5kb3dfYml0c2BdOwogICAgICB0aGlzLl9kZWZsYXRlID0gemxpYi5jcmVhdGVEZWZsYXRlUmF3KHsKICAgICAgICBmbHVzaDogemxpYi5aX1NZTkNfRkxVU0gsCiAgICAgICAgd2luZG93Qml0czogdHlwZW9mIG1heFdpbmRvd0JpdHMgPT09ICdudW1iZXInID8gbWF4V2luZG93Qml0cyA6IERFRkFVTFRfV0lORE9XX0JJVFMsCiAgICAgICAgbWVtTGV2ZWw6IHRoaXMuX29wdGlvbnMubWVtTGV2ZWwgfHwgREVGQVVMVF9NRU1fTEVWRUwKICAgICAgfSk7CiAgICB9CiAgICB0aGlzLl9kZWZsYXRlLndyaXRlSW5Qcm9ncmVzcyA9IHRydWU7CgogICAgdmFyIHRvdGFsTGVuZ3RoID0gMDsKICAgIGNvbnN0IGJ1ZmZlcnMgPSBbXTsKCiAgICBjb25zdCBvbkRhdGEgPSAoZGF0YSkgPT4gewogICAgICB0b3RhbExlbmd0aCArPSBkYXRhLmxlbmd0aDsKICAgICAgYnVmZmVycy5wdXNoKGRhdGEpOwogICAgfTsKCiAgICBjb25zdCBvbkVycm9yID0gKGVycikgPT4gewogICAgICBjbGVhbnVwKCk7CiAgICAgIGNhbGxiYWNrKGVycik7CiAgICB9OwoKICAgIGNvbnN0IGNsZWFudXAgPSAoKSA9PiB7CiAgICAgIGlmICghdGhpcy5fZGVmbGF0ZSkgcmV0dXJuOwoKICAgICAgdGhpcy5fZGVmbGF0ZS5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBvbkVycm9yKTsKICAgICAgdGhpcy5fZGVmbGF0ZS5yZW1vdmVMaXN0ZW5lcignZGF0YScsIG9uRGF0YSk7CiAgICAgIHRoaXMuX2RlZmxhdGUud3JpdGVJblByb2dyZXNzID0gZmFsc2U7CgogICAgICBpZiAoCiAgICAgICAgKGZpbiAmJiB0aGlzLnBhcmFtc1tgJHtlbmRwb2ludH1fbm9fY29udGV4dF90YWtlb3ZlcmBdKSB8fAogICAgICAgIHRoaXMuX2RlZmxhdGUucGVuZGluZ0Nsb3NlCiAgICAgICkgewogICAgICAgIHRoaXMuX2RlZmxhdGUuY2xvc2UoKTsKICAgICAgICB0aGlzLl9kZWZsYXRlID0gbnVsbDsKICAgICAgfQogICAgfTsKCiAgICB0aGlzLl9kZWZsYXRlLm9uKCdlcnJvcicsIG9uRXJyb3IpLm9uKCdkYXRhJywgb25EYXRhKTsKICAgIHRoaXMuX2RlZmxhdGUud3JpdGUoZGF0YSk7CiAgICB0aGlzLl9kZWZsYXRlLmZsdXNoKHpsaWIuWl9TWU5DX0ZMVVNILCAoKSA9PiB7CiAgICAgIGNsZWFudXAoKTsKICAgICAgdmFyIGRhdGEgPSBidWZmZXJVdGlsLmNvbmNhdChidWZmZXJzLCB0b3RhbExlbmd0aCk7CiAgICAgIGlmIChmaW4pIGRhdGEgPSBkYXRhLnNsaWNlKDAsIGRhdGEubGVuZ3RoIC0gNCk7CiAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpOwogICAgfSk7CiAgfQp9Cgptb2R1bGUuZXhwb3J0cyA9IFBlck1lc3NhZ2VEZWZsYXRlOwoKCi8qKiovIH0pLAovKiAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciBjb3JlID0gbW9kdWxlLmV4cG9ydHMgPSB7dmVyc2lvbjogJzIuNC4wJ307CmlmKHR5cGVvZiBfX2UgPT0gJ251bWJlcicpX19lID0gY29yZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZgoKLyoqKi8gfSksCi8qIDQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIHR5cGVvZiBpdCA9PT0gJ29iamVjdCcgPyBpdCAhPT0gbnVsbCA6IHR5cGVvZiBpdCA9PT0gJ2Z1bmN0aW9uJzsKfTsKCi8qKiovIH0pLAovKiA1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKLyohCiAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudAogKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT4KICogTUlUIExpY2Vuc2VkCiAqLwoKCgpjb25zdCBzYWZlQnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKCmNvbnN0IEJ1ZmZlciA9IHNhZmVCdWZmZXIuQnVmZmVyOwoKLyoqCiAqIE1lcmdlcyBhbiBhcnJheSBvZiBidWZmZXJzIGludG8gYSBuZXcgYnVmZmVyLgogKgogKiBAcGFyYW0ge0J1ZmZlcltdfSBsaXN0IFRoZSBhcnJheSBvZiBidWZmZXJzIHRvIGNvbmNhdAogKiBAcGFyYW0ge051bWJlcn0gdG90YWxMZW5ndGggVGhlIHRvdGFsIGxlbmd0aCBvZiBidWZmZXJzIGluIHRoZSBsaXN0CiAqIEByZXR1cm4ge0J1ZmZlcn0gVGhlIHJlc3VsdGluZyBidWZmZXIKICogQHB1YmxpYwogKi8KY29uc3QgY29uY2F0ID0gKGxpc3QsIHRvdGFsTGVuZ3RoKSA9PiB7CiAgY29uc3QgdGFyZ2V0ID0gQnVmZmVyLmFsbG9jVW5zYWZlKHRvdGFsTGVuZ3RoKTsKICB2YXIgb2Zmc2V0ID0gMDsKCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBidWYgPSBsaXN0W2ldOwogICAgYnVmLmNvcHkodGFyZ2V0LCBvZmZzZXQpOwogICAgb2Zmc2V0ICs9IGJ1Zi5sZW5ndGg7CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9OwoKdHJ5IHsKICBjb25zdCBidWZmZXJVdGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSk7CgogIG1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmFzc2lnbih7IGNvbmNhdCB9LCBidWZmZXJVdGlsLkJ1ZmZlclV0aWwgfHwgYnVmZmVyVXRpbCk7Cn0gY2F0Y2ggKGUpIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovIHsKICAvKioKICAgKiBNYXNrcyBhIGJ1ZmZlciB1c2luZyB0aGUgZ2l2ZW4gbWFzay4KICAgKgogICAqIEBwYXJhbSB7QnVmZmVyfSBzb3VyY2UgVGhlIGJ1ZmZlciB0byBtYXNrCiAgICogQHBhcmFtIHtCdWZmZXJ9IG1hc2sgVGhlIG1hc2sgdG8gdXNlCiAgICogQHBhcmFtIHtCdWZmZXJ9IG91dHB1dCBUaGUgYnVmZmVyIHdoZXJlIHRvIHN0b3JlIHRoZSByZXN1bHQKICAgKiBAcGFyYW0ge051bWJlcn0gb2Zmc2V0IFRoZSBvZmZzZXQgYXQgd2hpY2ggdG8gc3RhcnQgd3JpdGluZwogICAqIEBwYXJhbSB7TnVtYmVyfSBsZW5ndGggVGhlIG51bWJlciBvZiBieXRlcyB0byBtYXNrLgogICAqIEBwdWJsaWMKICAgKi8KICBjb25zdCBtYXNrID0gKHNvdXJjZSwgbWFzaywgb3V0cHV0LCBvZmZzZXQsIGxlbmd0aCkgPT4gewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICBvdXRwdXRbb2Zmc2V0ICsgaV0gPSBzb3VyY2VbaV0gXiBtYXNrW2kgJiAzXTsKICAgIH0KICB9OwoKICAvKioKICAgKiBVbm1hc2tzIGEgYnVmZmVyIHVzaW5nIHRoZSBnaXZlbiBtYXNrLgogICAqCiAgICogQHBhcmFtIHtCdWZmZXJ9IGJ1ZmZlciBUaGUgYnVmZmVyIHRvIHVubWFzawogICAqIEBwYXJhbSB7QnVmZmVyfSBtYXNrIFRoZSBtYXNrIHRvIHVzZQogICAqIEBwdWJsaWMKICAgKi8KICBjb25zdCB1bm1hc2sgPSAoYnVmZmVyLCBtYXNrKSA9PiB7CiAgICAvLyBSZXF1aXJlZCB1bnRpbCBodHRwczovL2dpdGh1Yi5jb20vbm9kZWpzL25vZGUvaXNzdWVzLzkwMDYgaXMgcmVzb2x2ZWQuCiAgICBjb25zdCBsZW5ndGggPSBidWZmZXIubGVuZ3RoOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICBidWZmZXJbaV0gXj0gbWFza1tpICYgM107CiAgICB9CiAgfTsKCiAgbW9kdWxlLmV4cG9ydHMgPSB7IGNvbmNhdCwgbWFzaywgdW5tYXNrIH07Cn0KCgovKioqLyB9KSwKLyogNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKY29uc3Qgc2FmZUJ1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7Cgpjb25zdCBCdWZmZXIgPSBzYWZlQnVmZmVyLkJ1ZmZlcjsKCmV4cG9ydHMuQklOQVJZX1RZUEVTID0gWydub2RlYnVmZmVyJywgJ2FycmF5YnVmZmVyJywgJ2ZyYWdtZW50cyddOwpleHBvcnRzLkdVSUQgPSAnMjU4RUFGQTUtRTkxNC00N0RBLTk1Q0EtQzVBQjBEQzg1QjExJzsKZXhwb3J0cy5FTVBUWV9CVUZGRVIgPSBCdWZmZXIuYWxsb2MoMCk7CmV4cG9ydHMuTk9PUCA9ICgpID0+IHt9OwoKCi8qKiovIH0pLAovKiA3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgiY3J5cHRvIik7CgovKioqLyB9KSwKLyogOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpmdW5jdGlvbiB3ZWJwYWNrRW1wdHlDb250ZXh0KHJlcSkgewoJdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIgKyByZXEgKyAiJy4iKTsKfQp3ZWJwYWNrRW1wdHlDb250ZXh0LmtleXMgPSBmdW5jdGlvbigpIHsgcmV0dXJuIFtdOyB9Owp3ZWJwYWNrRW1wdHlDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrRW1wdHlDb250ZXh0Owptb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tFbXB0eUNvbnRleHQ7CndlYnBhY2tFbXB0eUNvbnRleHQuaWQgPSA4OwoKLyoqKi8gfSksCi8qIDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKF9fZmlsZW5hbWUpIHsKLyoqCiAqIE1vZHVsZSBkZXBlbmRlbmNpZXMuCiAqLwoKdmFyIGZzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OCkKICAsIHBhdGggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKQogICwgam9pbiA9IHBhdGguam9pbgogICwgZGlybmFtZSA9IHBhdGguZGlybmFtZQogICwgZXhpc3RzID0gZnMuZXhpc3RzU3luYyB8fCBwYXRoLmV4aXN0c1N5bmMKICAsIGRlZmF1bHRzID0gewogICAgICAgIGFycm93OiBwcm9jZXNzLmVudi5OT0RFX0JJTkRJTkdTX0FSUk9XIHx8ICcg4oaSICcKICAgICAgLCBjb21waWxlZDogcHJvY2Vzcy5lbnYuTk9ERV9CSU5ESU5HU19DT01QSUxFRF9ESVIgfHwgJ2NvbXBpbGVkJwogICAgICAsIHBsYXRmb3JtOiBwcm9jZXNzLnBsYXRmb3JtCiAgICAgICwgYXJjaDogcHJvY2Vzcy5hcmNoCiAgICAgICwgdmVyc2lvbjogcHJvY2Vzcy52ZXJzaW9ucy5ub2RlCiAgICAgICwgYmluZGluZ3M6ICdiaW5kaW5ncy5ub2RlJwogICAgICAsIHRyeTogWwogICAgICAgICAgLy8gbm9kZS1neXAncyBsaW5rZWQgdmVyc2lvbiBpbiB0aGUgImJ1aWxkIiBkaXIKICAgICAgICAgIFsgJ21vZHVsZV9yb290JywgJ2J1aWxkJywgJ2JpbmRpbmdzJyBdCiAgICAgICAgICAvLyBub2RlLXdhZiBhbmQgZ3lwX2FkZG9uIChhLmsuYSBub2RlLWd5cCkKICAgICAgICAsIFsgJ21vZHVsZV9yb290JywgJ2J1aWxkJywgJ0RlYnVnJywgJ2JpbmRpbmdzJyBdCiAgICAgICAgLCBbICdtb2R1bGVfcm9vdCcsICdidWlsZCcsICdSZWxlYXNlJywgJ2JpbmRpbmdzJyBdCiAgICAgICAgICAvLyBEZWJ1ZyBmaWxlcywgZm9yIGRldmVsb3BtZW50IChsZWdhY3kgYmVoYXZpb3IsIHJlbW92ZSBmb3Igbm9kZSB2MC45KQogICAgICAgICwgWyAnbW9kdWxlX3Jvb3QnLCAnb3V0JywgJ0RlYnVnJywgJ2JpbmRpbmdzJyBdCiAgICAgICAgLCBbICdtb2R1bGVfcm9vdCcsICdEZWJ1ZycsICdiaW5kaW5ncycgXQogICAgICAgICAgLy8gUmVsZWFzZSBmaWxlcywgYnV0IG1hbnVhbGx5IGNvbXBpbGVkIChsZWdhY3kgYmVoYXZpb3IsIHJlbW92ZSBmb3Igbm9kZSB2MC45KQogICAgICAgICwgWyAnbW9kdWxlX3Jvb3QnLCAnb3V0JywgJ1JlbGVhc2UnLCAnYmluZGluZ3MnIF0KICAgICAgICAsIFsgJ21vZHVsZV9yb290JywgJ1JlbGVhc2UnLCAnYmluZGluZ3MnIF0KICAgICAgICAgIC8vIExlZ2FjeSBmcm9tIG5vZGUtd2FmLCBub2RlIDw9IDAuNC54CiAgICAgICAgLCBbICdtb2R1bGVfcm9vdCcsICdidWlsZCcsICdkZWZhdWx0JywgJ2JpbmRpbmdzJyBdCiAgICAgICAgICAvLyBQcm9kdWN0aW9uICJSZWxlYXNlIiBidWlsZHR5cGUgYmluYXJ5IChtZWguLi4pCiAgICAgICAgLCBbICdtb2R1bGVfcm9vdCcsICdjb21waWxlZCcsICd2ZXJzaW9uJywgJ3BsYXRmb3JtJywgJ2FyY2gnLCAnYmluZGluZ3MnIF0KICAgICAgICBdCiAgICB9CgovKioKICogVGhlIG1haW4gYGJpbmRpbmdzKClgIGZ1bmN0aW9uIGxvYWRzIHRoZSBjb21waWxlZCBiaW5kaW5ncyBmb3IgYSBnaXZlbiBtb2R1bGUuCiAqIEl0IHVzZXMgVjgncyBFcnJvciBBUEkgdG8gZGV0ZXJtaW5lIHRoZSBwYXJlbnQgZmlsZW5hbWUgdGhhdCB0aGlzIGZ1bmN0aW9uIGlzCiAqIGJlaW5nIGludm9rZWQgZnJvbSwgd2hpY2ggaXMgdGhlbiB1c2VkIHRvIGZpbmQgdGhlIHJvb3QgZGlyZWN0b3J5LgogKi8KCmZ1bmN0aW9uIGJpbmRpbmdzIChvcHRzKSB7CgogIC8vIEFyZ3VtZW50IHN1cmdlcnkKICBpZiAodHlwZW9mIG9wdHMgPT0gJ3N0cmluZycpIHsKICAgIG9wdHMgPSB7IGJpbmRpbmdzOiBvcHRzIH0KICB9IGVsc2UgaWYgKCFvcHRzKSB7CiAgICBvcHRzID0ge30KICB9CiAgb3B0cy5fX3Byb3RvX18gPSBkZWZhdWx0cwoKICAvLyBHZXQgdGhlIG1vZHVsZSByb290CiAgaWYgKCFvcHRzLm1vZHVsZV9yb290KSB7CiAgICBvcHRzLm1vZHVsZV9yb290ID0gZXhwb3J0cy5nZXRSb290KGV4cG9ydHMuZ2V0RmlsZU5hbWUoKSkKICB9CgogIC8vIEVuc3VyZSB0aGUgZ2l2ZW4gYmluZGluZ3MgbmFtZSBlbmRzIHdpdGggLm5vZGUKICBpZiAocGF0aC5leHRuYW1lKG9wdHMuYmluZGluZ3MpICE9ICcubm9kZScpIHsKICAgIG9wdHMuYmluZGluZ3MgKz0gJy5ub2RlJwogIH0KCiAgdmFyIHRyaWVzID0gW10KICAgICwgaSA9IDAKICAgICwgbCA9IG9wdHMudHJ5Lmxlbmd0aAogICAgLCBuCiAgICAsIGIKICAgICwgZXJyCgogIGZvciAoOyBpPGw7IGkrKykgewogICAgbiA9IGpvaW4uYXBwbHkobnVsbCwgb3B0cy50cnlbaV0ubWFwKGZ1bmN0aW9uIChwKSB7CiAgICAgIHJldHVybiBvcHRzW3BdIHx8IHAKICAgIH0pKQogICAgdHJpZXMucHVzaChuKQogICAgdHJ5IHsKICAgICAgYiA9IG9wdHMucGF0aCA/IC8qcmVxdWlyZS5yZXNvbHZlKi8oIShmdW5jdGlvbiB3ZWJwYWNrTWlzc2luZ01vZHVsZSgpIHsgdmFyIGUgPSBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSBcIi5cIiIpOyBlLmNvZGUgPSAnTU9EVUxFX05PVF9GT1VORCc7IHRocm93IGU7IH0oKSkpIDogIShmdW5jdGlvbiB3ZWJwYWNrTWlzc2luZ01vZHVsZSgpIHsgdmFyIGUgPSBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSBcIi5cIiIpOyBlLmNvZGUgPSAnTU9EVUxFX05PVF9GT1VORCc7IHRocm93IGU7IH0oKSkKICAgICAgaWYgKCFvcHRzLnBhdGgpIHsKICAgICAgICBiLnBhdGggPSBuCiAgICAgIH0KICAgICAgcmV0dXJuIGIKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgaWYgKCEvbm90IGZpbmQvaS50ZXN0KGUubWVzc2FnZSkpIHsKICAgICAgICB0aHJvdyBlCiAgICAgIH0KICAgIH0KICB9CgogIGVyciA9IG5ldyBFcnJvcignQ291bGQgbm90IGxvY2F0ZSB0aGUgYmluZGluZ3MgZmlsZS4gVHJpZWQ6XG4nCiAgICArIHRyaWVzLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gb3B0cy5hcnJvdyArIGEgfSkuam9pbignXG4nKSkKICBlcnIudHJpZXMgPSB0cmllcwogIHRocm93IGVycgp9Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cyA9IGJpbmRpbmdzCgoKLyoqCiAqIEdldHMgdGhlIGZpbGVuYW1lIG9mIHRoZSBKYXZhU2NyaXB0IGZpbGUgdGhhdCBpbnZva2VzIHRoaXMgZnVuY3Rpb24uCiAqIFVzZWQgdG8gaGVscCBmaW5kIHRoZSByb290IGRpcmVjdG9yeSBvZiBhIG1vZHVsZS4KICogT3B0aW9uYWxseSBhY2NlcHRzIGFuIGZpbGVuYW1lIGFyZ3VtZW50IHRvIHNraXAgd2hlbiBzZWFyY2hpbmcgZm9yIHRoZSBpbnZva2luZyBmaWxlbmFtZQogKi8KCmV4cG9ydHMuZ2V0RmlsZU5hbWUgPSBmdW5jdGlvbiBnZXRGaWxlTmFtZSAoY2FsbGluZ19maWxlKSB7CiAgdmFyIG9yaWdQU1QgPSBFcnJvci5wcmVwYXJlU3RhY2tUcmFjZQogICAgLCBvcmlnU1RMID0gRXJyb3Iuc3RhY2tUcmFjZUxpbWl0CiAgICAsIGR1bW15ID0ge30KICAgICwgZmlsZU5hbWUKCiAgRXJyb3Iuc3RhY2tUcmFjZUxpbWl0ID0gMTAKCiAgRXJyb3IucHJlcGFyZVN0YWNrVHJhY2UgPSBmdW5jdGlvbiAoZSwgc3QpIHsKICAgIGZvciAodmFyIGk9MCwgbD1zdC5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgIGZpbGVOYW1lID0gc3RbaV0uZ2V0RmlsZU5hbWUoKQogICAgICBpZiAoZmlsZU5hbWUgIT09IF9fZmlsZW5hbWUpIHsKICAgICAgICBpZiAoY2FsbGluZ19maWxlKSB7CiAgICAgICAgICAgIGlmIChmaWxlTmFtZSAhPT0gY2FsbGluZ19maWxlKSB7CiAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuCiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICAvLyBydW4gdGhlICdwcmVwYXJlU3RhY2tUcmFjZScgZnVuY3Rpb24gYWJvdmUKICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZShkdW1teSkKICBkdW1teS5zdGFjawoKICAvLyBjbGVhbnVwCiAgRXJyb3IucHJlcGFyZVN0YWNrVHJhY2UgPSBvcmlnUFNUCiAgRXJyb3Iuc3RhY2tUcmFjZUxpbWl0ID0gb3JpZ1NUTAoKICByZXR1cm4gZmlsZU5hbWUKfQoKLyoqCiAqIEdldHMgdGhlIHJvb3QgZGlyZWN0b3J5IG9mIGEgbW9kdWxlLCBnaXZlbiBhbiBhcmJpdHJhcnkgZmlsZW5hbWUKICogc29tZXdoZXJlIGluIHRoZSBtb2R1bGUgdHJlZS4gVGhlICJyb290IGRpcmVjdG9yeSIgaXMgdGhlIGRpcmVjdG9yeQogKiBjb250YWluaW5nIHRoZSBgcGFja2FnZS5qc29uYCBmaWxlLgogKgogKiAgIEluOiAgL2hvbWUvbmF0ZS9ub2RlLW5hdGl2ZS1tb2R1bGUvbGliL2luZGV4LmpzCiAqICAgT3V0OiAvaG9tZS9uYXRlL25vZGUtbmF0aXZlLW1vZHVsZQogKi8KCmV4cG9ydHMuZ2V0Um9vdCA9IGZ1bmN0aW9uIGdldFJvb3QgKGZpbGUpIHsKICB2YXIgZGlyID0gZGlybmFtZShmaWxlKQogICAgLCBwcmV2CiAgd2hpbGUgKHRydWUpIHsKICAgIGlmIChkaXIgPT09ICcuJykgewogICAgICAvLyBBdm9pZHMgYW4gaW5maW5pdGUgbG9vcCBpbiByYXJlIGNhc2VzLCBsaWtlIHRoZSBSRVBMCiAgICAgIGRpciA9IHByb2Nlc3MuY3dkKCkKICAgIH0KICAgIGlmIChleGlzdHMoam9pbihkaXIsICdwYWNrYWdlLmpzb24nKSkgfHwgZXhpc3RzKGpvaW4oZGlyLCAnbm9kZV9tb2R1bGVzJykpKSB7CiAgICAgIC8vIEZvdW5kIHRoZSAncGFja2FnZS5qc29uJyBmaWxlIG9yICdub2RlX21vZHVsZXMnIGRpcjsgd2UncmUgZG9uZQogICAgICByZXR1cm4gZGlyCiAgICB9CiAgICBpZiAocHJldiA9PT0gZGlyKSB7CiAgICAgIC8vIEdvdCB0byB0aGUgdG9wCiAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgbW9kdWxlIHJvb3QgZ2l2ZW4gZmlsZTogIicgKyBmaWxlCiAgICAgICAgICAgICAgICAgICAgKyAnIi4gRG8geW91IGhhdmUgYSBgcGFja2FnZS5qc29uYCBmaWxlPyAnKQogICAgfQogICAgLy8gVHJ5IHRoZSBwYXJlbnQgZGlyIG5leHQKICAgIHByZXYgPSBkaXIKICAgIGRpciA9IGpvaW4oZGlyLCAnLi4nKQogIH0KfQoKLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsICIvaW5kZXguanMiKSkKCi8qKiovIH0pLAovKiAxMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGV4ZWMpewogIHRyeSB7CiAgICByZXR1cm4gISFleGVjKCk7CiAgfSBjYXRjaChlKXsKICAgIHJldHVybiB0cnVlOwogIH0KfTsKCi8qKiovIH0pLAovKiAxMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOAp2YXIgZ2xvYmFsID0gbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdy5NYXRoID09IE1hdGgKICA/IHdpbmRvdyA6IHR5cGVvZiBzZWxmICE9ICd1bmRlZmluZWQnICYmIHNlbGYuTWF0aCA9PSBNYXRoID8gc2VsZiA6IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7CmlmKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmCgovKioqLyB9KSwKLyogMTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGFuT2JqZWN0ICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMykKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygzOCkKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCkKICAsIGRQICAgICAgICAgICAgID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpewogIGFuT2JqZWN0KE8pOwogIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKICBhbk9iamVjdChBdHRyaWJ1dGVzKTsKICBpZihJRThfRE9NX0RFRklORSl0cnkgewogICAgcmV0dXJuIGRQKE8sIFAsIEF0dHJpYnV0ZXMpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICBpZignZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpdGhyb3cgVHlwZUVycm9yKCdBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEnKTsKICBpZigndmFsdWUnIGluIEF0dHJpYnV0ZXMpT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogMTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCnZhciBoYXMgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5OwoKLyoqCiAqIEFuIGF1dG8gaW5jcmVtZW50aW5nIGlkIHdoaWNoIHdlIGNhbiB1c2UgdG8gY3JlYXRlICJ1bmlxdWUiIFVsdHJvbiBpbnN0YW5jZXMKICogc28gd2UgY2FuIHRyYWNrIHRoZSBldmVudCBlbWl0dGVycyB0aGF0IGFyZSBhZGRlZCB0aHJvdWdoIHRoZSBVbHRyb24KICogaW50ZXJmYWNlLgogKgogKiBAdHlwZSB7TnVtYmVyfQogKiBAcHJpdmF0ZQogKi8KdmFyIGlkID0gMDsKCi8qKgogKiBVbHRyb24gaXMgaGlnaC1pbnRlbGxpZ2VuY2Ugcm9ib3QuIEl0IGdhdGhlcnMgaW50ZWxsaWdlbmNlIHNvIGl0IGNhbiBzdGFydCBpbXByb3ZpbmcKICogdXBvbiBoaXMgcnVkaW1lbnRhcnkgZGVzaWduLiBJdCB3aWxsIGxlYXJuIGZyb20geW91ciBFdmVudEVtaXR0aW5nIHBhdHRlcm5zCiAqIGFuZCBleHRlcm1pbmF0ZSB0aGVtLgogKgogKiBAY29uc3RydWN0b3IKICogQHBhcmFtIHtFdmVudEVtaXR0ZXJ9IGVlIEV2ZW50RW1pdHRlciBpbnN0YW5jZSB3ZSBuZWVkIHRvIHdyYXAuCiAqIEBhcGkgcHVibGljCiAqLwpmdW5jdGlvbiBVbHRyb24oZWUpIHsKICBpZiAoISh0aGlzIGluc3RhbmNlb2YgVWx0cm9uKSkgcmV0dXJuIG5ldyBVbHRyb24oZWUpOwoKICB0aGlzLmlkID0gaWQrKzsKICB0aGlzLmVlID0gZWU7Cn0KCi8qKgogKiBSZWdpc3RlciBhIG5ldyBFdmVudExpc3RlbmVyIGZvciB0aGUgZ2l2ZW4gZXZlbnQuCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSBldmVudCBOYW1lIG9mIHRoZSBldmVudC4KICogQHBhcmFtIHtGdW5jdG9ufSBmbiBDYWxsYmFjayBmdW5jdGlvbi4KICogQHBhcmFtIHtNaXhlZH0gY29udGV4dCBUaGUgY29udGV4dCBvZiB0aGUgZnVuY3Rpb24uCiAqIEByZXR1cm5zIHtVbHRyb259CiAqIEBhcGkgcHVibGljCiAqLwpVbHRyb24ucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gb24oZXZlbnQsIGZuLCBjb250ZXh0KSB7CiAgZm4uX191bHRyb24gPSB0aGlzLmlkOwogIHRoaXMuZWUub24oZXZlbnQsIGZuLCBjb250ZXh0KTsKCiAgcmV0dXJuIHRoaXM7Cn07Ci8qKgogKiBBZGQgYW4gRXZlbnRMaXN0ZW5lciB0aGF0J3Mgb25seSBjYWxsZWQgb25jZS4KICoKICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50IE5hbWUgb2YgdGhlIGV2ZW50LgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBDYWxsYmFjayBmdW5jdGlvbi4KICogQHBhcmFtIHtNaXhlZH0gY29udGV4dCBUaGUgY29udGV4dCBvZiB0aGUgZnVuY3Rpb24uCiAqIEByZXR1cm5zIHtVbHRyb259CiAqIEBhcGkgcHVibGljCiAqLwpVbHRyb24ucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiBvbmNlKGV2ZW50LCBmbiwgY29udGV4dCkgewogIGZuLl9fdWx0cm9uID0gdGhpcy5pZDsKICB0aGlzLmVlLm9uY2UoZXZlbnQsIGZuLCBjb250ZXh0KTsKCiAgcmV0dXJuIHRoaXM7Cn07CgovKioKICogUmVtb3ZlIHRoZSBsaXN0ZW5lcnMgd2UgYXNzaWduZWQgZm9yIHRoZSBnaXZlbiBldmVudC4KICoKICogQHJldHVybnMge1VsdHJvbn0KICogQGFwaSBwdWJsaWMKICovClVsdHJvbi5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKCkgewogIHZhciBhcmdzID0gYXJndW1lbnRzCiAgICAsIGVlID0gdGhpcy5lZQogICAgLCBldmVudDsKCiAgLy8KICAvLyBXaGVuIG5vIGV2ZW50IG5hbWVzIGFyZSBwcm92aWRlZCB3ZSBhc3N1bWUgdGhhdCB3ZSBuZWVkIHRvIGNsZWFyIGFsbCB0aGUKICAvLyBldmVudHMgdGhhdCB3ZXJlIGFzc2lnbmVkIHRocm91Z2ggdXMuCiAgLy8KICBpZiAoYXJncy5sZW5ndGggPT09IDEgJiYgJ3N0cmluZycgPT09IHR5cGVvZiBhcmdzWzBdKSB7CiAgICBhcmdzID0gYXJnc1swXS5zcGxpdCgvWywgXSsvKTsKICB9IGVsc2UgaWYgKCFhcmdzLmxlbmd0aCkgewogICAgaWYgKGVlLmV2ZW50TmFtZXMpIHsKICAgICAgYXJncyA9IGVlLmV2ZW50TmFtZXMoKTsKICAgIH0gZWxzZSBpZiAoZWUuX2V2ZW50cykgewogICAgICBhcmdzID0gW107CgogICAgICBmb3IgKGV2ZW50IGluIGVlLl9ldmVudHMpIHsKICAgICAgICBpZiAoaGFzLmNhbGwoZWUuX2V2ZW50cywgZXZlbnQpKSBhcmdzLnB1c2goZXZlbnQpOwogICAgICB9CgogICAgICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgICAgIGFyZ3MgPSBhcmdzLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGVlLl9ldmVudHMpKTsKICAgICAgfQogICAgfQogIH0KCiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgbGlzdGVuZXJzID0gZWUubGlzdGVuZXJzKGFyZ3NbaV0pOwoKICAgIGZvciAodmFyIGogPSAwOyBqIDwgbGlzdGVuZXJzLmxlbmd0aDsgaisrKSB7CiAgICAgIGV2ZW50ID0gbGlzdGVuZXJzW2pdOwoKICAgICAgLy8KICAgICAgLy8gT25jZSBsaXN0ZW5lcnMgaGF2ZSBhIGBsaXN0ZW5lcmAgcHJvcGVydHkgdGhhdCBzdG9yZXMgdGhlIHJlYWwgbGlzdGVuZXIKICAgICAgLy8gaW4gdGhlIEV2ZW50RW1pdHRlciB0aGF0IHNoaXBzIHdpdGggTm9kZS5qcy4KICAgICAgLy8KICAgICAgaWYgKGV2ZW50Lmxpc3RlbmVyKSB7CiAgICAgICAgaWYgKGV2ZW50Lmxpc3RlbmVyLl9fdWx0cm9uICE9PSB0aGlzLmlkKSBjb250aW51ZTsKICAgICAgICBkZWxldGUgZXZlbnQubGlzdGVuZXIuX191bHRyb247CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGV2ZW50Ll9fdWx0cm9uICE9PSB0aGlzLmlkKSBjb250aW51ZTsKICAgICAgICBkZWxldGUgZXZlbnQuX191bHRyb247CiAgICAgIH0KCiAgICAgIGVlLnJlbW92ZUxpc3RlbmVyKGFyZ3NbaV0sIGV2ZW50KTsKICAgIH0KICB9CgogIHJldHVybiB0aGlzOwp9OwoKLyoqCiAqIERlc3Ryb3kgdGhlIFVsdHJvbiBpbnN0YW5jZSwgcmVtb3ZlIGFsbCBsaXN0ZW5lcnMgYW5kIHJlbGVhc2UgYWxsIHJlZmVyZW5jZXMuCiAqCiAqIEByZXR1cm5zIHtCb29sZWFufQogKiBAYXBpIHB1YmxpYwogKi8KVWx0cm9uLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gZGVzdHJveSgpIHsKICBpZiAoIXRoaXMuZWUpIHJldHVybiBmYWxzZTsKCiAgdGhpcy5yZW1vdmUoKTsKICB0aGlzLmVlID0gbnVsbDsKCiAgcmV0dXJuIHRydWU7Cn07CgovLwovLyBFeHBvc2UgdGhlIG1vZHVsZS4KLy8KbW9kdWxlLmV4cG9ydHMgPSBVbHRyb247CgoKLyoqKi8gfSksCi8qIDE0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKLyohCiAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudAogKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT4KICogTUlUIExpY2Vuc2VkCiAqLwoKCgptb2R1bGUuZXhwb3J0cyA9IHsKICBpc1ZhbGlkRXJyb3JDb2RlOiBmdW5jdGlvbiAoY29kZSkgewogICAgcmV0dXJuIChjb2RlID49IDEwMDAgJiYgY29kZSA8PSAxMDEzICYmIGNvZGUgIT09IDEwMDQgJiYgY29kZSAhPT0gMTAwNSAmJiBjb2RlICE9PSAxMDA2KSB8fAogICAgICAoY29kZSA+PSAzMDAwICYmIGNvZGUgPD0gNDk5OSk7CiAgfSwKICAxMDAwOiAnbm9ybWFsJywKICAxMDAxOiAnZ29pbmcgYXdheScsCiAgMTAwMjogJ3Byb3RvY29sIGVycm9yJywKICAxMDAzOiAndW5zdXBwb3J0ZWQgZGF0YScsCiAgMTAwNDogJ3Jlc2VydmVkJywKICAxMDA1OiAncmVzZXJ2ZWQgZm9yIGV4dGVuc2lvbnMnLAogIDEwMDY6ICdyZXNlcnZlZCBmb3IgZXh0ZW5zaW9ucycsCiAgMTAwNzogJ2luY29uc2lzdGVudCBvciBpbnZhbGlkIGRhdGEnLAogIDEwMDg6ICdwb2xpY3kgdmlvbGF0aW9uJywKICAxMDA5OiAnbWVzc2FnZSB0b28gYmlnJywKICAxMDEwOiAnZXh0ZW5zaW9uIGhhbmRzaGFrZSBtaXNzaW5nJywKICAxMDExOiAnYW4gdW5leHBlY3RlZCBjb25kaXRpb24gcHJldmVudGVkIHRoZSByZXF1ZXN0IGZyb20gYmVpbmcgZnVsZmlsbGVkJywKICAxMDEyOiAnc2VydmljZSByZXN0YXJ0JywKICAxMDEzOiAndHJ5IGFnYWluIGxhdGVyJwp9OwoKCi8qKiovIH0pLAovKiAxNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKLyoqCiAqIFBhcnNlIHRoZSBgU2VjLVdlYlNvY2tldC1FeHRlbnNpb25zYCBoZWFkZXIgaW50byBhbiBvYmplY3QuCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZSBmaWVsZCB2YWx1ZSBvZiB0aGUgaGVhZGVyCiAqIEByZXR1cm4ge09iamVjdH0gVGhlIHBhcnNlZCBvYmplY3QKICogQHB1YmxpYwogKi8KY29uc3QgcGFyc2UgPSAodmFsdWUpID0+IHsKICB2YWx1ZSA9IHZhbHVlIHx8ICcnOwoKICBjb25zdCBleHRlbnNpb25zID0ge307CgogIHZhbHVlLnNwbGl0KCcsJykuZm9yRWFjaCgodikgPT4gewogICAgY29uc3QgcGFyYW1zID0gdi5zcGxpdCgnOycpOwogICAgY29uc3QgdG9rZW4gPSBwYXJhbXMuc2hpZnQoKS50cmltKCk7CiAgICBjb25zdCBwYXJhbXNMaXN0ID0gZXh0ZW5zaW9uc1t0b2tlbl0gPSBleHRlbnNpb25zW3Rva2VuXSB8fCBbXTsKICAgIGNvbnN0IHBhcnNlZFBhcmFtcyA9IHt9OwoKICAgIHBhcmFtcy5mb3JFYWNoKChwYXJhbSkgPT4gewogICAgICBjb25zdCBwYXJ0cyA9IHBhcmFtLnRyaW0oKS5zcGxpdCgnPScpOwogICAgICBjb25zdCBrZXkgPSBwYXJ0c1swXTsKICAgICAgdmFyIHZhbHVlID0gcGFydHNbMV07CgogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHZhbHVlID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyB1bnF1b3RlIHZhbHVlCiAgICAgICAgaWYgKHZhbHVlWzBdID09PSAnIicpIHsKICAgICAgICAgIHZhbHVlID0gdmFsdWUuc2xpY2UoMSk7CiAgICAgICAgfQogICAgICAgIGlmICh2YWx1ZVt2YWx1ZS5sZW5ndGggLSAxXSA9PT0gJyInKSB7CiAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDAsIHZhbHVlLmxlbmd0aCAtIDEpOwogICAgICAgIH0KICAgICAgfQogICAgICAocGFyc2VkUGFyYW1zW2tleV0gPSBwYXJzZWRQYXJhbXNba2V5XSB8fCBbXSkucHVzaCh2YWx1ZSk7CiAgICB9KTsKCiAgICBwYXJhbXNMaXN0LnB1c2gocGFyc2VkUGFyYW1zKTsKICB9KTsKCiAgcmV0dXJuIGV4dGVuc2lvbnM7Cn07CgovKioKICogU2VyaWFsaXplIGEgcGFyc2VkIGBTZWMtV2ViU29ja2V0LUV4dGVuc2lvbnNgIGhlYWRlciB0byBhIHN0cmluZy4KICoKICogQHBhcmFtIHtPYmplY3R9IHZhbHVlIFRoZSBvYmplY3QgdG8gZm9ybWF0CiAqIEByZXR1cm4ge1N0cmluZ30gQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBnaXZlbiB2YWx1ZQogKiBAcHVibGljCiAqLwpjb25zdCBmb3JtYXQgPSAodmFsdWUpID0+IHsKICByZXR1cm4gT2JqZWN0LmtleXModmFsdWUpLm1hcCgodG9rZW4pID0+IHsKICAgIHZhciBwYXJhbXNMaXN0ID0gdmFsdWVbdG9rZW5dOwogICAgaWYgKCFBcnJheS5pc0FycmF5KHBhcmFtc0xpc3QpKSBwYXJhbXNMaXN0ID0gW3BhcmFtc0xpc3RdOwogICAgcmV0dXJuIHBhcmFtc0xpc3QubWFwKChwYXJhbXMpID0+IHsKICAgICAgcmV0dXJuIFt0b2tlbl0uY29uY2F0KE9iamVjdC5rZXlzKHBhcmFtcykubWFwKChrKSA9PiB7CiAgICAgICAgdmFyIHAgPSBwYXJhbXNba107CiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHApKSBwID0gW3BdOwogICAgICAgIHJldHVybiBwLm1hcCgodikgPT4gdiA9PT0gdHJ1ZSA/IGsgOiBgJHtrfT0ke3Z9YCkuam9pbignOyAnKTsKICAgICAgfSkpLmpvaW4oJzsgJyk7CiAgICB9KS5qb2luKCcsICcpOwogIH0pLmpvaW4oJywgJyk7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IHsgZm9ybWF0LCBwYXJzZSB9OwoKCi8qKiovIH0pLAovKiAxNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Ci8qIQogKiB3czogYSBub2RlLmpzIHdlYnNvY2tldCBjbGllbnQKICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+CiAqIE1JVCBMaWNlbnNlZAogKi8KCgoKY29uc3Qgc2FmZUJ1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7Cgpjb25zdCBQZXJNZXNzYWdlRGVmbGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7CmNvbnN0IGlzVmFsaWRVVEY4ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NSk7CmNvbnN0IGJ1ZmZlclV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwpjb25zdCBFcnJvckNvZGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CmNvbnN0IGNvbnN0YW50cyA9IF9fd2VicGFja19yZXF1aXJlX18oNik7Cgpjb25zdCBCdWZmZXIgPSBzYWZlQnVmZmVyLkJ1ZmZlcjsKCmNvbnN0IEdFVF9JTkZPID0gMDsKY29uc3QgR0VUX1BBWUxPQURfTEVOR1RIXzE2ID0gMTsKY29uc3QgR0VUX1BBWUxPQURfTEVOR1RIXzY0ID0gMjsKY29uc3QgR0VUX01BU0sgPSAzOwpjb25zdCBHRVRfREFUQSA9IDQ7CmNvbnN0IElORkxBVElORyA9IDU7CgovKioKICogSHlCaSBSZWNlaXZlciBpbXBsZW1lbnRhdGlvbi4KICovCmNsYXNzIFJlY2VpdmVyIHsKICAvKioKICAgKiBDcmVhdGVzIGEgUmVjZWl2ZXIgaW5zdGFuY2UuCiAgICoKICAgKiBAcGFyYW0ge09iamVjdH0gZXh0ZW5zaW9ucyBBbiBvYmplY3QgY29udGFpbmluZyB0aGUgbmVnb3RpYXRlZCBleHRlbnNpb25zCiAgICogQHBhcmFtIHtOdW1iZXJ9IG1heFBheWxvYWQgVGhlIG1heGltdW0gYWxsb3dlZCBtZXNzYWdlIGxlbmd0aAogICAqIEBwYXJhbSB7U3RyaW5nfSBiaW5hcnlUeXBlIFRoZSB0eXBlIGZvciBiaW5hcnkgZGF0YQogICAqLwogIGNvbnN0cnVjdG9yIChleHRlbnNpb25zLCBtYXhQYXlsb2FkLCBiaW5hcnlUeXBlKSB7CiAgICB0aGlzLmJpbmFyeVR5cGUgPSBiaW5hcnlUeXBlIHx8IGNvbnN0YW50cy5CSU5BUllfVFlQRVNbMF07CiAgICB0aGlzLmV4dGVuc2lvbnMgPSBleHRlbnNpb25zIHx8IHt9OwogICAgdGhpcy5tYXhQYXlsb2FkID0gbWF4UGF5bG9hZCB8IDA7CgogICAgdGhpcy5idWZmZXJlZEJ5dGVzID0gMDsKICAgIHRoaXMuYnVmZmVycyA9IFtdOwoKICAgIHRoaXMuY29tcHJlc3NlZCA9IGZhbHNlOwogICAgdGhpcy5wYXlsb2FkTGVuZ3RoID0gMDsKICAgIHRoaXMuZnJhZ21lbnRlZCA9IDA7CiAgICB0aGlzLm1hc2tlZCA9IGZhbHNlOwogICAgdGhpcy5maW4gPSBmYWxzZTsKICAgIHRoaXMubWFzayA9IG51bGw7CiAgICB0aGlzLm9wY29kZSA9IDA7CgogICAgdGhpcy50b3RhbFBheWxvYWRMZW5ndGggPSAwOwogICAgdGhpcy5tZXNzYWdlTGVuZ3RoID0gMDsKICAgIHRoaXMuZnJhZ21lbnRzID0gW107CgogICAgdGhpcy5jbGVhbnVwQ2FsbGJhY2sgPSBudWxsOwogICAgdGhpcy5oYWRFcnJvciA9IGZhbHNlOwogICAgdGhpcy5kZWFkID0gZmFsc2U7CiAgICB0aGlzLmxvb3AgPSBmYWxzZTsKCiAgICB0aGlzLm9ubWVzc2FnZSA9IG51bGw7CiAgICB0aGlzLm9uY2xvc2UgPSBudWxsOwogICAgdGhpcy5vbmVycm9yID0gbnVsbDsKICAgIHRoaXMub25waW5nID0gbnVsbDsKICAgIHRoaXMub25wb25nID0gbnVsbDsKCiAgICB0aGlzLnN0YXRlID0gR0VUX0lORk87CiAgfQoKICAvKioKICAgKiBDb25zdW1lcyBieXRlcyBmcm9tIHRoZSBhdmFpbGFibGUgYnVmZmVyZWQgZGF0YS4KICAgKgogICAqIEBwYXJhbSB7TnVtYmVyfSBieXRlcyBUaGUgbnVtYmVyIG9mIGJ5dGVzIHRvIGNvbnN1bWUKICAgKiBAcmV0dXJuIHtCdWZmZXJ9IENvbnN1bWVkIGJ5dGVzCiAgICogQHByaXZhdGUKICAgKi8KICByZWFkQnVmZmVyIChieXRlcykgewogICAgdmFyIG9mZnNldCA9IDA7CiAgICB2YXIgZHN0OwogICAgdmFyIGw7CgogICAgdGhpcy5idWZmZXJlZEJ5dGVzIC09IGJ5dGVzOwoKICAgIGlmIChieXRlcyA9PT0gdGhpcy5idWZmZXJzWzBdLmxlbmd0aCkgcmV0dXJuIHRoaXMuYnVmZmVycy5zaGlmdCgpOwoKICAgIGlmIChieXRlcyA8IHRoaXMuYnVmZmVyc1swXS5sZW5ndGgpIHsKICAgICAgZHN0ID0gdGhpcy5idWZmZXJzWzBdLnNsaWNlKDAsIGJ5dGVzKTsKICAgICAgdGhpcy5idWZmZXJzWzBdID0gdGhpcy5idWZmZXJzWzBdLnNsaWNlKGJ5dGVzKTsKICAgICAgcmV0dXJuIGRzdDsKICAgIH0KCiAgICBkc3QgPSBCdWZmZXIuYWxsb2NVbnNhZmUoYnl0ZXMpOwoKICAgIHdoaWxlIChieXRlcyA+IDApIHsKICAgICAgbCA9IHRoaXMuYnVmZmVyc1swXS5sZW5ndGg7CgogICAgICBpZiAoYnl0ZXMgPj0gbCkgewogICAgICAgIHRoaXMuYnVmZmVyc1swXS5jb3B5KGRzdCwgb2Zmc2V0KTsKICAgICAgICBvZmZzZXQgKz0gbDsKICAgICAgICB0aGlzLmJ1ZmZlcnMuc2hpZnQoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmJ1ZmZlcnNbMF0uY29weShkc3QsIG9mZnNldCwgMCwgYnl0ZXMpOwogICAgICAgIHRoaXMuYnVmZmVyc1swXSA9IHRoaXMuYnVmZmVyc1swXS5zbGljZShieXRlcyk7CiAgICAgIH0KCiAgICAgIGJ5dGVzIC09IGw7CiAgICB9CgogICAgcmV0dXJuIGRzdDsKICB9CgogIC8qKgogICAqIENoZWNrcyBpZiB0aGUgbnVtYmVyIG9mIGJ1ZmZlcmVkIGJ5dGVzIGlzIGJpZ2dlciBvciBlcXVhbCB0aGFuIGBuYCBhbmQKICAgKiBjYWxscyBgY2xlYW51cGAgaWYgbmVjZXNzYXJ5LgogICAqCiAgICogQHBhcmFtIHtOdW1iZXJ9IG4gVGhlIG51bWJlciBvZiBieXRlcyB0byBjaGVjayBhZ2FpbnN0CiAgICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIGBidWZmZXJlZEJ5dGVzID49IG5gLCBlbHNlIGBmYWxzZWAKICAgKiBAcHJpdmF0ZQogICAqLwogIGhhc0J1ZmZlcmVkQnl0ZXMgKG4pIHsKICAgIGlmICh0aGlzLmJ1ZmZlcmVkQnl0ZXMgPj0gbikgcmV0dXJuIHRydWU7CgogICAgdGhpcy5sb29wID0gZmFsc2U7CiAgICBpZiAodGhpcy5kZWFkKSB0aGlzLmNsZWFudXAodGhpcy5jbGVhbnVwQ2FsbGJhY2spOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgLyoqCiAgICogQWRkcyBuZXcgZGF0YSB0byB0aGUgcGFyc2VyLgogICAqCiAgICogQHB1YmxpYwogICAqLwogIGFkZCAoZGF0YSkgewogICAgaWYgKHRoaXMuZGVhZCkgcmV0dXJuOwoKICAgIHRoaXMuYnVmZmVyZWRCeXRlcyArPSBkYXRhLmxlbmd0aDsKICAgIHRoaXMuYnVmZmVycy5wdXNoKGRhdGEpOwogICAgdGhpcy5zdGFydExvb3AoKTsKICB9CgogIC8qKgogICAqIFN0YXJ0cyB0aGUgcGFyc2luZyBsb29wLgogICAqCiAgICogQHByaXZhdGUKICAgKi8KICBzdGFydExvb3AgKCkgewogICAgdGhpcy5sb29wID0gdHJ1ZTsKCiAgICB3aGlsZSAodGhpcy5sb29wKSB7CiAgICAgIHN3aXRjaCAodGhpcy5zdGF0ZSkgewogICAgICAgIGNhc2UgR0VUX0lORk86CiAgICAgICAgICB0aGlzLmdldEluZm8oKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgR0VUX1BBWUxPQURfTEVOR1RIXzE2OgogICAgICAgICAgdGhpcy5nZXRQYXlsb2FkTGVuZ3RoMTYoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgR0VUX1BBWUxPQURfTEVOR1RIXzY0OgogICAgICAgICAgdGhpcy5nZXRQYXlsb2FkTGVuZ3RoNjQoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgR0VUX01BU0s6CiAgICAgICAgICB0aGlzLmdldE1hc2soKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgR0VUX0RBVEE6CiAgICAgICAgICB0aGlzLmdldERhdGEoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IC8vIGBJTkZMQVRJTkdgCiAgICAgICAgICB0aGlzLmxvb3AgPSBmYWxzZTsKICAgICAgfQogICAgfQogIH0KCiAgLyoqCiAgICogUmVhZHMgdGhlIGZpcnN0IHR3byBieXRlcyBvZiBhIGZyYW1lLgogICAqCiAgICogQHByaXZhdGUKICAgKi8KICBnZXRJbmZvICgpIHsKICAgIGlmICghdGhpcy5oYXNCdWZmZXJlZEJ5dGVzKDIpKSByZXR1cm47CgogICAgY29uc3QgYnVmID0gdGhpcy5yZWFkQnVmZmVyKDIpOwoKICAgIGlmICgoYnVmWzBdICYgMHgzMCkgIT09IDB4MDApIHsKICAgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoJ1JTVjIgYW5kIFJTVjMgbXVzdCBiZSBjbGVhcicpLCAxMDAyKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGNvbXByZXNzZWQgPSAoYnVmWzBdICYgMHg0MCkgPT09IDB4NDA7CgogICAgaWYgKGNvbXByZXNzZWQgJiYgIXRoaXMuZXh0ZW5zaW9uc1tQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXSkgewogICAgICB0aGlzLmVycm9yKG5ldyBFcnJvcignUlNWMSBtdXN0IGJlIGNsZWFyJyksIDEwMDIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5maW4gPSAoYnVmWzBdICYgMHg4MCkgPT09IDB4ODA7CiAgICB0aGlzLm9wY29kZSA9IGJ1ZlswXSAmIDB4MGY7CiAgICB0aGlzLnBheWxvYWRMZW5ndGggPSBidWZbMV0gJiAweDdmOwoKICAgIGlmICh0aGlzLm9wY29kZSA9PT0gMHgwMCkgewogICAgICBpZiAoY29tcHJlc3NlZCkgewogICAgICAgIHRoaXMuZXJyb3IobmV3IEVycm9yKCdSU1YxIG11c3QgYmUgY2xlYXInKSwgMTAwMik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuZnJhZ21lbnRlZCkgewogICAgICAgIHRoaXMuZXJyb3IobmV3IEVycm9yKGBpbnZhbGlkIG9wY29kZTogJHt0aGlzLm9wY29kZX1gKSwgMTAwMik7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMub3Bjb2RlID0gdGhpcy5mcmFnbWVudGVkOwogICAgICB9CiAgICB9IGVsc2UgaWYgKHRoaXMub3Bjb2RlID09PSAweDAxIHx8IHRoaXMub3Bjb2RlID09PSAweDAyKSB7CiAgICAgIGlmICh0aGlzLmZyYWdtZW50ZWQpIHsKICAgICAgICB0aGlzLmVycm9yKG5ldyBFcnJvcihgaW52YWxpZCBvcGNvZGU6ICR7dGhpcy5vcGNvZGV9YCksIDEwMDIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5jb21wcmVzc2VkID0gY29tcHJlc3NlZDsKICAgIH0gZWxzZSBpZiAodGhpcy5vcGNvZGUgPiAweDA3ICYmIHRoaXMub3Bjb2RlIDwgMHgwYikgewogICAgICBpZiAoIXRoaXMuZmluKSB7CiAgICAgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoJ0ZJTiBtdXN0IGJlIHNldCcpLCAxMDAyKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChjb21wcmVzc2VkKSB7CiAgICAgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoJ1JTVjEgbXVzdCBiZSBjbGVhcicpLCAxMDAyKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnBheWxvYWRMZW5ndGggPiAweDdkKSB7CiAgICAgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoJ2ludmFsaWQgcGF5bG9hZCBsZW5ndGgnKSwgMTAwMik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLmVycm9yKG5ldyBFcnJvcihgaW52YWxpZCBvcGNvZGU6ICR7dGhpcy5vcGNvZGV9YCksIDEwMDIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKCF0aGlzLmZpbiAmJiAhdGhpcy5mcmFnbWVudGVkKSB0aGlzLmZyYWdtZW50ZWQgPSB0aGlzLm9wY29kZTsKCiAgICB0aGlzLm1hc2tlZCA9IChidWZbMV0gJiAweDgwKSA9PT0gMHg4MDsKCiAgICBpZiAodGhpcy5wYXlsb2FkTGVuZ3RoID09PSAxMjYpIHRoaXMuc3RhdGUgPSBHRVRfUEFZTE9BRF9MRU5HVEhfMTY7CiAgICBlbHNlIGlmICh0aGlzLnBheWxvYWRMZW5ndGggPT09IDEyNykgdGhpcy5zdGF0ZSA9IEdFVF9QQVlMT0FEX0xFTkdUSF82NDsKICAgIGVsc2UgdGhpcy5oYXZlTGVuZ3RoKCk7CiAgfQoKICAvKioKICAgKiBHZXRzIGV4dGVuZGVkIHBheWxvYWQgbGVuZ3RoICg3KzE2KS4KICAgKgogICAqIEBwcml2YXRlCiAgICovCiAgZ2V0UGF5bG9hZExlbmd0aDE2ICgpIHsKICAgIGlmICghdGhpcy5oYXNCdWZmZXJlZEJ5dGVzKDIpKSByZXR1cm47CgogICAgdGhpcy5wYXlsb2FkTGVuZ3RoID0gdGhpcy5yZWFkQnVmZmVyKDIpLnJlYWRVSW50MTZCRSgwLCB0cnVlKTsKICAgIHRoaXMuaGF2ZUxlbmd0aCgpOwogIH0KCiAgLyoqCiAgICogR2V0cyBleHRlbmRlZCBwYXlsb2FkIGxlbmd0aCAoNys2NCkuCiAgICoKICAgKiBAcHJpdmF0ZQogICAqLwogIGdldFBheWxvYWRMZW5ndGg2NCAoKSB7CiAgICBpZiAoIXRoaXMuaGFzQnVmZmVyZWRCeXRlcyg4KSkgcmV0dXJuOwoKICAgIGNvbnN0IGJ1ZiA9IHRoaXMucmVhZEJ1ZmZlcig4KTsKICAgIGNvbnN0IG51bSA9IGJ1Zi5yZWFkVUludDMyQkUoMCwgdHJ1ZSk7CgogICAgLy8KICAgIC8vIFRoZSBtYXhpbXVtIHNhZmUgaW50ZWdlciBpbiBKYXZhU2NyaXB0IGlzIDJeNTMgLSAxLiBBbiBlcnJvciBpcyByZXR1cm5lZAogICAgLy8gaWYgcGF5bG9hZCBsZW5ndGggaXMgZ3JlYXRlciB0aGFuIHRoaXMgbnVtYmVyLgogICAgLy8KICAgIGlmIChudW0gPiBNYXRoLnBvdygyLCA1MyAtIDMyKSAtIDEpIHsKICAgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoJ21heCBwYXlsb2FkIHNpemUgZXhjZWVkZWQnKSwgMTAwOSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnBheWxvYWRMZW5ndGggPSAobnVtICogTWF0aC5wb3coMiwgMzIpKSArIGJ1Zi5yZWFkVUludDMyQkUoNCwgdHJ1ZSk7CiAgICB0aGlzLmhhdmVMZW5ndGgoKTsKICB9CgogIC8qKgogICAqIFBheWxvYWQgbGVuZ3RoIGhhcyBiZWVuIHJlYWQuCiAgICoKICAgKiBAcHJpdmF0ZQogICAqLwogIGhhdmVMZW5ndGggKCkgewogICAgaWYgKHRoaXMub3Bjb2RlIDwgMHgwOCAmJiB0aGlzLm1heFBheWxvYWRFeGNlZWRlZCh0aGlzLnBheWxvYWRMZW5ndGgpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy5tYXNrZWQpIHRoaXMuc3RhdGUgPSBHRVRfTUFTSzsKICAgIGVsc2UgdGhpcy5zdGF0ZSA9IEdFVF9EQVRBOwogIH0KCiAgLyoqCiAgICogUmVhZHMgbWFzayBieXRlcy4KICAgKgogICAqIEBwcml2YXRlCiAgICovCiAgZ2V0TWFzayAoKSB7CiAgICBpZiAoIXRoaXMuaGFzQnVmZmVyZWRCeXRlcyg0KSkgcmV0dXJuOwoKICAgIHRoaXMubWFzayA9IHRoaXMucmVhZEJ1ZmZlcig0KTsKICAgIHRoaXMuc3RhdGUgPSBHRVRfREFUQTsKICB9CgogIC8qKgogICAqIFJlYWRzIGRhdGEgYnl0ZXMuCiAgICoKICAgKiBAcHJpdmF0ZQogICAqLwogIGdldERhdGEgKCkgewogICAgdmFyIGRhdGEgPSBjb25zdGFudHMuRU1QVFlfQlVGRkVSOwoKICAgIGlmICh0aGlzLnBheWxvYWRMZW5ndGgpIHsKICAgICAgaWYgKCF0aGlzLmhhc0J1ZmZlcmVkQnl0ZXModGhpcy5wYXlsb2FkTGVuZ3RoKSkgcmV0dXJuOwoKICAgICAgZGF0YSA9IHRoaXMucmVhZEJ1ZmZlcih0aGlzLnBheWxvYWRMZW5ndGgpOwogICAgICBpZiAodGhpcy5tYXNrZWQpIGJ1ZmZlclV0aWwudW5tYXNrKGRhdGEsIHRoaXMubWFzayk7CiAgICB9CgogICAgaWYgKHRoaXMub3Bjb2RlID4gMHgwNykgewogICAgICB0aGlzLmNvbnRyb2xNZXNzYWdlKGRhdGEpOwogICAgfSBlbHNlIGlmICh0aGlzLmNvbXByZXNzZWQpIHsKICAgICAgdGhpcy5zdGF0ZSA9IElORkxBVElORzsKICAgICAgdGhpcy5kZWNvbXByZXNzKGRhdGEpOwogICAgfSBlbHNlIGlmICh0aGlzLnB1c2hGcmFnbWVudChkYXRhKSkgewogICAgICB0aGlzLmRhdGFNZXNzYWdlKCk7CiAgICB9CiAgfQoKICAvKioKICAgKiBEZWNvbXByZXNzZXMgZGF0YS4KICAgKgogICAqIEBwYXJhbSB7QnVmZmVyfSBkYXRhIENvbXByZXNzZWQgZGF0YQogICAqIEBwcml2YXRlCiAgICovCiAgZGVjb21wcmVzcyAoZGF0YSkgewogICAgY29uc3QgZXh0ZW5zaW9uID0gdGhpcy5leHRlbnNpb25zW1Blck1lc3NhZ2VEZWZsYXRlLmV4dGVuc2lvbk5hbWVdOwoKICAgIGV4dGVuc2lvbi5kZWNvbXByZXNzKGRhdGEsIHRoaXMuZmluLCAoZXJyLCBidWYpID0+IHsKICAgICAgaWYgKGVycikgewogICAgICAgIHRoaXMuZXJyb3IoZXJyLCBlcnIuY2xvc2VDb2RlID09PSAxMDA5ID8gMTAwOSA6IDEwMDcpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMucHVzaEZyYWdtZW50KGJ1ZikpIHRoaXMuZGF0YU1lc3NhZ2UoKTsKICAgICAgdGhpcy5zdGFydExvb3AoKTsKICAgIH0pOwogIH0KCiAgLyoqCiAgICogSGFuZGxlcyBhIGRhdGEgbWVzc2FnZS4KICAgKgogICAqIEBwcml2YXRlCiAgICovCiAgZGF0YU1lc3NhZ2UgKCkgewogICAgaWYgKHRoaXMuZmluKSB7CiAgICAgIGNvbnN0IG1lc3NhZ2VMZW5ndGggPSB0aGlzLm1lc3NhZ2VMZW5ndGg7CiAgICAgIGNvbnN0IGZyYWdtZW50cyA9IHRoaXMuZnJhZ21lbnRzOwoKICAgICAgdGhpcy50b3RhbFBheWxvYWRMZW5ndGggPSAwOwogICAgICB0aGlzLm1lc3NhZ2VMZW5ndGggPSAwOwogICAgICB0aGlzLmZyYWdtZW50ZWQgPSAwOwogICAgICB0aGlzLmZyYWdtZW50cyA9IFtdOwoKICAgICAgaWYgKHRoaXMub3Bjb2RlID09PSAyKSB7CiAgICAgICAgdmFyIGRhdGE7CgogICAgICAgIGlmICh0aGlzLmJpbmFyeVR5cGUgPT09ICdub2RlYnVmZmVyJykgewogICAgICAgICAgZGF0YSA9IHRvQnVmZmVyKGZyYWdtZW50cywgbWVzc2FnZUxlbmd0aCk7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmJpbmFyeVR5cGUgPT09ICdhcnJheWJ1ZmZlcicpIHsKICAgICAgICAgIGRhdGEgPSB0b0FycmF5QnVmZmVyKHRvQnVmZmVyKGZyYWdtZW50cywgbWVzc2FnZUxlbmd0aCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkYXRhID0gZnJhZ21lbnRzOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5vbm1lc3NhZ2UoZGF0YSwgeyBtYXNrZWQ6IHRoaXMubWFza2VkLCBiaW5hcnk6IHRydWUgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgYnVmID0gdG9CdWZmZXIoZnJhZ21lbnRzLCBtZXNzYWdlTGVuZ3RoKTsKCiAgICAgICAgaWYgKCFpc1ZhbGlkVVRGOChidWYpKSB7CiAgICAgICAgICB0aGlzLmVycm9yKG5ldyBFcnJvcignaW52YWxpZCB1dGY4IHNlcXVlbmNlJyksIDEwMDcpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5vbm1lc3NhZ2UoYnVmLnRvU3RyaW5nKCksIHsgbWFza2VkOiB0aGlzLm1hc2tlZCB9KTsKICAgICAgfQogICAgfQoKICAgIHRoaXMuc3RhdGUgPSBHRVRfSU5GTzsKICB9CgogIC8qKgogICAqIEhhbmRsZXMgYSBjb250cm9sIG1lc3NhZ2UuCiAgICoKICAgKiBAcGFyYW0ge0J1ZmZlcn0gZGF0YSBEYXRhIHRvIGhhbmRsZQogICAqIEBwcml2YXRlCiAgICovCiAgY29udHJvbE1lc3NhZ2UgKGRhdGEpIHsKICAgIGlmICh0aGlzLm9wY29kZSA9PT0gMHgwOCkgewogICAgICBpZiAoZGF0YS5sZW5ndGggPT09IDApIHsKICAgICAgICB0aGlzLm9uY2xvc2UoMTAwMCwgJycsIHsgbWFza2VkOiB0aGlzLm1hc2tlZCB9KTsKICAgICAgICB0aGlzLmxvb3AgPSBmYWxzZTsKICAgICAgICB0aGlzLmNsZWFudXAodGhpcy5jbGVhbnVwQ2FsbGJhY2spOwogICAgICB9IGVsc2UgaWYgKGRhdGEubGVuZ3RoID09PSAxKSB7CiAgICAgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoJ2ludmFsaWQgcGF5bG9hZCBsZW5ndGgnKSwgMTAwMik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgY29kZSA9IGRhdGEucmVhZFVJbnQxNkJFKDAsIHRydWUpOwoKICAgICAgICBpZiAoIUVycm9yQ29kZXMuaXNWYWxpZEVycm9yQ29kZShjb2RlKSkgewogICAgICAgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoYGludmFsaWQgc3RhdHVzIGNvZGU6ICR7Y29kZX1gKSwgMTAwMik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCBidWYgPSBkYXRhLnNsaWNlKDIpOwoKICAgICAgICBpZiAoIWlzVmFsaWRVVEY4KGJ1ZikpIHsKICAgICAgICAgIHRoaXMuZXJyb3IobmV3IEVycm9yKCdpbnZhbGlkIHV0Zjggc2VxdWVuY2UnKSwgMTAwNyk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB0aGlzLm9uY2xvc2UoY29kZSwgYnVmLnRvU3RyaW5nKCksIHsgbWFza2VkOiB0aGlzLm1hc2tlZCB9KTsKICAgICAgICB0aGlzLmxvb3AgPSBmYWxzZTsKICAgICAgICB0aGlzLmNsZWFudXAodGhpcy5jbGVhbnVwQ2FsbGJhY2spOwogICAgICB9CgogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgZmxhZ3MgPSB7IG1hc2tlZDogdGhpcy5tYXNrZWQsIGJpbmFyeTogdHJ1ZSB9OwoKICAgIGlmICh0aGlzLm9wY29kZSA9PT0gMHgwOSkgdGhpcy5vbnBpbmcoZGF0YSwgZmxhZ3MpOwogICAgZWxzZSB0aGlzLm9ucG9uZyhkYXRhLCBmbGFncyk7CgogICAgdGhpcy5zdGF0ZSA9IEdFVF9JTkZPOwogIH0KCiAgLyoqCiAgICogSGFuZGxlcyBhbiBlcnJvci4KICAgKgogICAqIEBwYXJhbSB7RXJyb3J9IGVyciBUaGUgZXJyb3IKICAgKiBAcGFyYW0ge051bWJlcn0gY29kZSBDbG9zZSBjb2RlCiAgICogQHByaXZhdGUKICAgKi8KICBlcnJvciAoZXJyLCBjb2RlKSB7CiAgICB0aGlzLm9uZXJyb3IoZXJyLCBjb2RlKTsKICAgIHRoaXMuaGFkRXJyb3IgPSB0cnVlOwogICAgdGhpcy5sb29wID0gZmFsc2U7CiAgICB0aGlzLmNsZWFudXAodGhpcy5jbGVhbnVwQ2FsbGJhY2spOwogIH0KCiAgLyoqCiAgICogQ2hlY2tzIHBheWxvYWQgc2l6ZSwgZGlzY29ubmVjdHMgc29ja2V0IHdoZW4gaXQgZXhjZWVkcyBgbWF4UGF5bG9hZGAuCiAgICoKICAgKiBAcGFyYW0ge051bWJlcn0gbGVuZ3RoIFBheWxvYWQgbGVuZ3RoCiAgICogQHByaXZhdGUKICAgKi8KICBtYXhQYXlsb2FkRXhjZWVkZWQgKGxlbmd0aCkgewogICAgaWYgKGxlbmd0aCA9PT0gMCB8fCB0aGlzLm1heFBheWxvYWQgPCAxKSByZXR1cm4gZmFsc2U7CgogICAgY29uc3QgZnVsbExlbmd0aCA9IHRoaXMudG90YWxQYXlsb2FkTGVuZ3RoICsgbGVuZ3RoOwoKICAgIGlmIChmdWxsTGVuZ3RoIDw9IHRoaXMubWF4UGF5bG9hZCkgewogICAgICB0aGlzLnRvdGFsUGF5bG9hZExlbmd0aCA9IGZ1bGxMZW5ndGg7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICB0aGlzLmVycm9yKG5ldyBFcnJvcignbWF4IHBheWxvYWQgc2l6ZSBleGNlZWRlZCcpLCAxMDA5KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgLyoqCiAgICogQXBwZW5kcyBhIGZyYWdtZW50IGluIHRoZSBmcmFnbWVudHMgYXJyYXkgYWZ0ZXIgY2hlY2tpbmcgdGhhdCB0aGUgc3VtIG9mCiAgICogZnJhZ21lbnQgbGVuZ3RocyBkb2VzIG5vdCBleGNlZWQgYG1heFBheWxvYWRgLgogICAqCiAgICogQHBhcmFtIHtCdWZmZXJ9IGZyYWdtZW50IFRoZSBmcmFnbWVudCB0byBhZGQKICAgKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgYG1heFBheWxvYWRgIGlzIG5vdCBleGNlZWRlZCwgZWxzZSBgZmFsc2VgCiAgICogQHByaXZhdGUKICAgKi8KICBwdXNoRnJhZ21lbnQgKGZyYWdtZW50KSB7CiAgICBpZiAoZnJhZ21lbnQubGVuZ3RoID09PSAwKSByZXR1cm4gdHJ1ZTsKCiAgICBjb25zdCB0b3RhbExlbmd0aCA9IHRoaXMubWVzc2FnZUxlbmd0aCArIGZyYWdtZW50Lmxlbmd0aDsKCiAgICBpZiAodGhpcy5tYXhQYXlsb2FkIDwgMSB8fCB0b3RhbExlbmd0aCA8PSB0aGlzLm1heFBheWxvYWQpIHsKICAgICAgdGhpcy5tZXNzYWdlTGVuZ3RoID0gdG90YWxMZW5ndGg7CiAgICAgIHRoaXMuZnJhZ21lbnRzLnB1c2goZnJhZ21lbnQpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICB0aGlzLmVycm9yKG5ldyBFcnJvcignbWF4IHBheWxvYWQgc2l6ZSBleGNlZWRlZCcpLCAxMDA5KTsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIC8qKgogICAqIFJlbGVhc2VzIHJlc291cmNlcyB1c2VkIGJ5IHRoZSByZWNlaXZlci4KICAgKgogICAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIENhbGxiYWNrCiAgICogQHB1YmxpYwogICAqLwogIGNsZWFudXAgKGNiKSB7CiAgICB0aGlzLmRlYWQgPSB0cnVlOwoKICAgIGlmICghdGhpcy5oYWRFcnJvciAmJiAodGhpcy5sb29wIHx8IHRoaXMuc3RhdGUgPT09IElORkxBVElORykpIHsKICAgICAgdGhpcy5jbGVhbnVwQ2FsbGJhY2sgPSBjYjsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IG51bGw7CiAgICAgIHRoaXMuZnJhZ21lbnRzID0gbnVsbDsKICAgICAgdGhpcy5idWZmZXJzID0gbnVsbDsKICAgICAgdGhpcy5tYXNrID0gbnVsbDsKCiAgICAgIHRoaXMuY2xlYW51cENhbGxiYWNrID0gbnVsbDsKICAgICAgdGhpcy5vbm1lc3NhZ2UgPSBudWxsOwogICAgICB0aGlzLm9uY2xvc2UgPSBudWxsOwogICAgICB0aGlzLm9uZXJyb3IgPSBudWxsOwogICAgICB0aGlzLm9ucGluZyA9IG51bGw7CiAgICAgIHRoaXMub25wb25nID0gbnVsbDsKCiAgICAgIGlmIChjYikgY2IoKTsKICAgIH0KICB9Cn0KCm1vZHVsZS5leHBvcnRzID0gUmVjZWl2ZXI7CgovKioKICogTWFrZXMgYSBidWZmZXIgZnJvbSBhIGxpc3Qgb2YgZnJhZ21lbnRzLgogKgogKiBAcGFyYW0ge0J1ZmZlcltdfSBmcmFnbWVudHMgVGhlIGxpc3Qgb2YgZnJhZ21lbnRzIGNvbXBvc2luZyB0aGUgbWVzc2FnZQogKiBAcGFyYW0ge051bWJlcn0gbWVzc2FnZUxlbmd0aCBUaGUgbGVuZ3RoIG9mIHRoZSBtZXNzYWdlCiAqIEByZXR1cm4ge0J1ZmZlcn0KICogQHByaXZhdGUKICovCmZ1bmN0aW9uIHRvQnVmZmVyIChmcmFnbWVudHMsIG1lc3NhZ2VMZW5ndGgpIHsKICBpZiAoZnJhZ21lbnRzLmxlbmd0aCA9PT0gMSkgcmV0dXJuIGZyYWdtZW50c1swXTsKICBpZiAoZnJhZ21lbnRzLmxlbmd0aCA+IDEpIHJldHVybiBidWZmZXJVdGlsLmNvbmNhdChmcmFnbWVudHMsIG1lc3NhZ2VMZW5ndGgpOwogIHJldHVybiBjb25zdGFudHMuRU1QVFlfQlVGRkVSOwp9CgovKioKICogQ29udmVydHMgYSBidWZmZXIgdG8gYW4gYEFycmF5QnVmZmVyYC4KICoKICogQHBhcmFtIHtCdWZmZXJ9IFRoZSBidWZmZXIgdG8gY29udmVydAogKiBAcmV0dXJuIHtBcnJheUJ1ZmZlcn0gQ29udmVydGVkIGJ1ZmZlcgogKi8KZnVuY3Rpb24gdG9BcnJheUJ1ZmZlciAoYnVmKSB7CiAgaWYgKGJ1Zi5ieXRlT2Zmc2V0ID09PSAwICYmIGJ1Zi5ieXRlTGVuZ3RoID09PSBidWYuYnVmZmVyLmJ5dGVMZW5ndGgpIHsKICAgIHJldHVybiBidWYuYnVmZmVyOwogIH0KCiAgcmV0dXJuIGJ1Zi5idWZmZXIuc2xpY2UoYnVmLmJ5dGVPZmZzZXQsIGJ1Zi5ieXRlT2Zmc2V0ICsgYnVmLmJ5dGVMZW5ndGgpOwp9CgoKLyoqKi8gfSksCi8qIDE3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKLyohCiAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudAogKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT4KICogTUlUIExpY2Vuc2VkCiAqLwoKCgpjb25zdCBzYWZlQnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKY29uc3QgY3J5cHRvID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKCmNvbnN0IFBlck1lc3NhZ2VEZWZsYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTsKY29uc3QgYnVmZmVyVXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CmNvbnN0IEVycm9yQ29kZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KTsKCmNvbnN0IEJ1ZmZlciA9IHNhZmVCdWZmZXIuQnVmZmVyOwoKLyoqCiAqIEh5QmkgU2VuZGVyIGltcGxlbWVudGF0aW9uLgogKi8KY2xhc3MgU2VuZGVyIHsKICAvKioKICAgKiBDcmVhdGVzIGEgU2VuZGVyIGluc3RhbmNlLgogICAqCiAgICogQHBhcmFtIHtuZXQuU29ja2V0fSBzb2NrZXQgVGhlIGNvbm5lY3Rpb24gc29ja2V0CiAgICogQHBhcmFtIHtPYmplY3R9IGV4dGVuc2lvbnMgQW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIG5lZ290aWF0ZWQgZXh0ZW5zaW9ucwogICAqLwogIGNvbnN0cnVjdG9yIChzb2NrZXQsIGV4dGVuc2lvbnMpIHsKICAgIHRoaXMucGVyTWVzc2FnZURlZmxhdGUgPSAoZXh0ZW5zaW9ucyB8fCB7fSlbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV07CiAgICB0aGlzLl9zb2NrZXQgPSBzb2NrZXQ7CgogICAgdGhpcy5maXJzdEZyYWdtZW50ID0gdHJ1ZTsKICAgIHRoaXMuY29tcHJlc3MgPSBmYWxzZTsKCiAgICB0aGlzLmJ1ZmZlcmVkQnl0ZXMgPSAwOwogICAgdGhpcy5kZWZsYXRpbmcgPSBmYWxzZTsKICAgIHRoaXMucXVldWUgPSBbXTsKCiAgICB0aGlzLm9uZXJyb3IgPSBudWxsOwogIH0KCiAgLyoqCiAgICogRnJhbWVzIGEgcGllY2Ugb2YgZGF0YSBhY2NvcmRpbmcgdG8gdGhlIEh5QmkgV2ViU29ja2V0IHByb3RvY29sLgogICAqCiAgICogQHBhcmFtIHtCdWZmZXJ9IGRhdGEgVGhlIGRhdGEgdG8gZnJhbWUKICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBPcHRpb25zIG9iamVjdAogICAqIEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLm9wY29kZSBUaGUgb3Bjb2RlCiAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLnJlYWRPbmx5IFNwZWNpZmllcyB3aGV0aGVyIGBkYXRhYCBjYW4gYmUgbW9kaWZpZWQKICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMuZmluIFNwZWNpZmllcyB3aGV0aGVyIG9yIG5vdCB0byBzZXQgdGhlIEZJTiBiaXQKICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMubWFzayBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gbWFzayBgZGF0YWAKICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMucnN2MSBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gc2V0IHRoZSBSU1YxIGJpdAogICAqIEByZXR1cm4ge0J1ZmZlcltdfSBUaGUgZnJhbWVkIGRhdGEgYXMgYSBsaXN0IG9mIGBCdWZmZXJgIGluc3RhbmNlcwogICAqIEBwdWJsaWMKICAgKi8KICBzdGF0aWMgZnJhbWUgKGRhdGEsIG9wdGlvbnMpIHsKICAgIGNvbnN0IG1lcmdlID0gZGF0YS5sZW5ndGggPCAxMDI0IHx8IChvcHRpb25zLm1hc2sgJiYgb3B0aW9ucy5yZWFkT25seSk7CiAgICB2YXIgb2Zmc2V0ID0gb3B0aW9ucy5tYXNrID8gNiA6IDI7CiAgICB2YXIgcGF5bG9hZExlbmd0aCA9IGRhdGEubGVuZ3RoOwoKICAgIGlmIChkYXRhLmxlbmd0aCA+PSA2NTUzNikgewogICAgICBvZmZzZXQgKz0gODsKICAgICAgcGF5bG9hZExlbmd0aCA9IDEyNzsKICAgIH0gZWxzZSBpZiAoZGF0YS5sZW5ndGggPiAxMjUpIHsKICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgIHBheWxvYWRMZW5ndGggPSAxMjY7CiAgICB9CgogICAgY29uc3QgdGFyZ2V0ID0gQnVmZmVyLmFsbG9jVW5zYWZlKG1lcmdlID8gZGF0YS5sZW5ndGggKyBvZmZzZXQgOiBvZmZzZXQpOwoKICAgIHRhcmdldFswXSA9IG9wdGlvbnMuZmluID8gb3B0aW9ucy5vcGNvZGUgfCAweDgwIDogb3B0aW9ucy5vcGNvZGU7CiAgICBpZiAob3B0aW9ucy5yc3YxKSB0YXJnZXRbMF0gfD0gMHg0MDsKCiAgICBpZiAocGF5bG9hZExlbmd0aCA9PT0gMTI2KSB7CiAgICAgIHRhcmdldC53cml0ZVVJbnQxNkJFKGRhdGEubGVuZ3RoLCAyLCB0cnVlKTsKICAgIH0gZWxzZSBpZiAocGF5bG9hZExlbmd0aCA9PT0gMTI3KSB7CiAgICAgIHRhcmdldC53cml0ZVVJbnQzMkJFKDAsIDIsIHRydWUpOwogICAgICB0YXJnZXQud3JpdGVVSW50MzJCRShkYXRhLmxlbmd0aCwgNiwgdHJ1ZSk7CiAgICB9CgogICAgaWYgKCFvcHRpb25zLm1hc2spIHsKICAgICAgdGFyZ2V0WzFdID0gcGF5bG9hZExlbmd0aDsKICAgICAgaWYgKG1lcmdlKSB7CiAgICAgICAgZGF0YS5jb3B5KHRhcmdldCwgb2Zmc2V0KTsKICAgICAgICByZXR1cm4gW3RhcmdldF07CiAgICAgIH0KCiAgICAgIHJldHVybiBbdGFyZ2V0LCBkYXRhXTsKICAgIH0KCiAgICBjb25zdCBtYXNrID0gY3J5cHRvLnJhbmRvbUJ5dGVzKDQpOwoKICAgIHRhcmdldFsxXSA9IHBheWxvYWRMZW5ndGggfCAweDgwOwogICAgdGFyZ2V0W29mZnNldCAtIDRdID0gbWFza1swXTsKICAgIHRhcmdldFtvZmZzZXQgLSAzXSA9IG1hc2tbMV07CiAgICB0YXJnZXRbb2Zmc2V0IC0gMl0gPSBtYXNrWzJdOwogICAgdGFyZ2V0W29mZnNldCAtIDFdID0gbWFza1szXTsKCiAgICBpZiAobWVyZ2UpIHsKICAgICAgYnVmZmVyVXRpbC5tYXNrKGRhdGEsIG1hc2ssIHRhcmdldCwgb2Zmc2V0LCBkYXRhLmxlbmd0aCk7CiAgICAgIHJldHVybiBbdGFyZ2V0XTsKICAgIH0KCiAgICBidWZmZXJVdGlsLm1hc2soZGF0YSwgbWFzaywgZGF0YSwgMCwgZGF0YS5sZW5ndGgpOwogICAgcmV0dXJuIFt0YXJnZXQsIGRhdGFdOwogIH0KCiAgLyoqCiAgICogU2VuZHMgYSBjbG9zZSBtZXNzYWdlIHRvIHRoZSBvdGhlciBwZWVyLgogICAqCiAgICogQHBhcmFtIHsoTnVtYmVyfHVuZGVmaW5lZCl9IGNvZGUgVGhlIHN0YXR1cyBjb2RlIGNvbXBvbmVudCBvZiB0aGUgYm9keQogICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhIFRoZSBtZXNzYWdlIGNvbXBvbmVudCBvZiB0aGUgYm9keQogICAqIEBwYXJhbSB7Qm9vbGVhbn0gbWFzayBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gbWFzayB0aGUgbWVzc2FnZQogICAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIENhbGxiYWNrCiAgICogQHB1YmxpYwogICAqLwogIGNsb3NlIChjb2RlLCBkYXRhLCBtYXNrLCBjYikgewogICAgaWYgKGNvZGUgIT09IHVuZGVmaW5lZCAmJiAodHlwZW9mIGNvZGUgIT09ICdudW1iZXInIHx8ICFFcnJvckNvZGVzLmlzVmFsaWRFcnJvckNvZGUoY29kZSkpKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHZhbGlkIGVycm9yIGNvZGUgbnVtYmVyJyk7CiAgICB9CgogICAgY29uc3QgYnVmID0gQnVmZmVyLmFsbG9jVW5zYWZlKDIgKyAoZGF0YSA/IEJ1ZmZlci5ieXRlTGVuZ3RoKGRhdGEpIDogMCkpOwoKICAgIGJ1Zi53cml0ZVVJbnQxNkJFKGNvZGUgfHwgMTAwMCwgMCwgdHJ1ZSk7CiAgICBpZiAoYnVmLmxlbmd0aCA+IDIpIGJ1Zi53cml0ZShkYXRhLCAyKTsKCiAgICBpZiAodGhpcy5kZWZsYXRpbmcpIHsKICAgICAgdGhpcy5lbnF1ZXVlKFt0aGlzLmRvQ2xvc2UsIGJ1ZiwgbWFzaywgY2JdKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZG9DbG9zZShidWYsIG1hc2ssIGNiKTsKICAgIH0KICB9CgogIC8qKgogICAqIEZyYW1lcyBhbmQgc2VuZHMgYSBjbG9zZSBtZXNzYWdlLgogICAqCiAgICogQHBhcmFtIHtCdWZmZXJ9IGRhdGEgVGhlIG1lc3NhZ2UgdG8gc2VuZAogICAqIEBwYXJhbSB7Qm9vbGVhbn0gbWFzayBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gbWFzayBgZGF0YWAKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYiBDYWxsYmFjawogICAqIEBwcml2YXRlCiAgICovCiAgZG9DbG9zZSAoZGF0YSwgbWFzaywgY2IpIHsKICAgIHRoaXMuc2VuZEZyYW1lKFNlbmRlci5mcmFtZShkYXRhLCB7CiAgICAgIHJlYWRPbmx5OiBmYWxzZSwKICAgICAgb3Bjb2RlOiAweDA4LAogICAgICByc3YxOiBmYWxzZSwKICAgICAgZmluOiB0cnVlLAogICAgICBtYXNrCiAgICB9KSwgY2IpOwogIH0KCiAgLyoqCiAgICogU2VuZHMgYSBwaW5nIG1lc3NhZ2UgdG8gdGhlIG90aGVyIHBlZXIuCiAgICoKICAgKiBAcGFyYW0geyp9IGRhdGEgVGhlIG1lc3NhZ2UgdG8gc2VuZAogICAqIEBwYXJhbSB7Qm9vbGVhbn0gbWFzayBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gbWFzayBgZGF0YWAKICAgKiBAcHVibGljCiAgICovCiAgcGluZyAoZGF0YSwgbWFzaykgewogICAgdmFyIHJlYWRPbmx5ID0gdHJ1ZTsKCiAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihkYXRhKSkgewogICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7CiAgICAgICAgZGF0YSA9IEJ1ZmZlci5mcm9tKGRhdGEpOwogICAgICB9IGVsc2UgaWYgKEFycmF5QnVmZmVyLmlzVmlldyhkYXRhKSkgewogICAgICAgIGRhdGEgPSB2aWV3VG9CdWZmZXIoZGF0YSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGF0YSA9IEJ1ZmZlci5mcm9tKGRhdGEpOwogICAgICAgIHJlYWRPbmx5ID0gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5kZWZsYXRpbmcpIHsKICAgICAgdGhpcy5lbnF1ZXVlKFt0aGlzLmRvUGluZywgZGF0YSwgbWFzaywgcmVhZE9ubHldKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZG9QaW5nKGRhdGEsIG1hc2ssIHJlYWRPbmx5KTsKICAgIH0KICB9CgogIC8qKgogICAqIEZyYW1lcyBhbmQgc2VuZHMgYSBwaW5nIG1lc3NhZ2UuCiAgICoKICAgKiBAcGFyYW0geyp9IGRhdGEgVGhlIG1lc3NhZ2UgdG8gc2VuZAogICAqIEBwYXJhbSB7Qm9vbGVhbn0gbWFzayBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gbWFzayBgZGF0YWAKICAgKiBAcGFyYW0ge0Jvb2xlYW59IHJlYWRPbmx5IFNwZWNpZmllcyB3aGV0aGVyIGBkYXRhYCBjYW4gYmUgbW9kaWZpZWQKICAgKiBAcHJpdmF0ZQogICAqLwogIGRvUGluZyAoZGF0YSwgbWFzaywgcmVhZE9ubHkpIHsKICAgIHRoaXMuc2VuZEZyYW1lKFNlbmRlci5mcmFtZShkYXRhLCB7CiAgICAgIG9wY29kZTogMHgwOSwKICAgICAgcnN2MTogZmFsc2UsCiAgICAgIGZpbjogdHJ1ZSwKICAgICAgcmVhZE9ubHksCiAgICAgIG1hc2sKICAgIH0pKTsKICB9CgogIC8qKgogICAqIFNlbmRzIGEgcG9uZyBtZXNzYWdlIHRvIHRoZSBvdGhlciBwZWVyLgogICAqCiAgICogQHBhcmFtIHsqfSBkYXRhIFRoZSBtZXNzYWdlIHRvIHNlbmQKICAgKiBAcGFyYW0ge0Jvb2xlYW59IG1hc2sgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIG1hc2sgYGRhdGFgCiAgICogQHB1YmxpYwogICAqLwogIHBvbmcgKGRhdGEsIG1hc2spIHsKICAgIHZhciByZWFkT25seSA9IHRydWU7CgogICAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoZGF0YSkpIHsKICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgewogICAgICAgIGRhdGEgPSBCdWZmZXIuZnJvbShkYXRhKTsKICAgICAgfSBlbHNlIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcoZGF0YSkpIHsKICAgICAgICBkYXRhID0gdmlld1RvQnVmZmVyKGRhdGEpOwogICAgICB9IGVsc2UgewogICAgICAgIGRhdGEgPSBCdWZmZXIuZnJvbShkYXRhKTsKICAgICAgICByZWFkT25seSA9IGZhbHNlOwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXMuZGVmbGF0aW5nKSB7CiAgICAgIHRoaXMuZW5xdWV1ZShbdGhpcy5kb1BvbmcsIGRhdGEsIG1hc2ssIHJlYWRPbmx5XSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRvUG9uZyhkYXRhLCBtYXNrLCByZWFkT25seSk7CiAgICB9CiAgfQoKICAvKioKICAgKiBGcmFtZXMgYW5kIHNlbmRzIGEgcG9uZyBtZXNzYWdlLgogICAqCiAgICogQHBhcmFtIHsqfSBkYXRhIFRoZSBtZXNzYWdlIHRvIHNlbmQKICAgKiBAcGFyYW0ge0Jvb2xlYW59IG1hc2sgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIG1hc2sgYGRhdGFgCiAgICogQHBhcmFtIHtCb29sZWFufSByZWFkT25seSBTcGVjaWZpZXMgd2hldGhlciBgZGF0YWAgY2FuIGJlIG1vZGlmaWVkCiAgICogQHByaXZhdGUKICAgKi8KICBkb1BvbmcgKGRhdGEsIG1hc2ssIHJlYWRPbmx5KSB7CiAgICB0aGlzLnNlbmRGcmFtZShTZW5kZXIuZnJhbWUoZGF0YSwgewogICAgICBvcGNvZGU6IDB4MGEsCiAgICAgIHJzdjE6IGZhbHNlLAogICAgICBmaW46IHRydWUsCiAgICAgIHJlYWRPbmx5LAogICAgICBtYXNrCiAgICB9KSk7CiAgfQoKICAvKioKICAgKiBTZW5kcyBhIGRhdGEgbWVzc2FnZSB0byB0aGUgb3RoZXIgcGVlci4KICAgKgogICAqIEBwYXJhbSB7Kn0gZGF0YSBUaGUgbWVzc2FnZSB0byBzZW5kCiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgT3B0aW9ucyBvYmplY3QKICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMuY29tcHJlc3MgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIGNvbXByZXNzIGBkYXRhYAogICAqIEBwYXJhbSB7Qm9vbGVhbn0gb3B0aW9ucy5iaW5hcnkgU3BlY2lmaWVzIHdoZXRoZXIgYGRhdGFgIGlzIGJpbmFyeSBvciB0ZXh0CiAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLmZpbiBTcGVjaWZpZXMgd2hldGhlciB0aGUgZnJhZ21lbnQgaXMgdGhlIGxhc3Qgb25lCiAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLm1hc2sgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIG1hc2sgYGRhdGFgCiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2IgQ2FsbGJhY2sKICAgKiBAcHVibGljCiAgICovCiAgc2VuZCAoZGF0YSwgb3B0aW9ucywgY2IpIHsKICAgIHZhciBvcGNvZGUgPSBvcHRpb25zLmJpbmFyeSA/IDIgOiAxOwogICAgdmFyIHJzdjEgPSBvcHRpb25zLmNvbXByZXNzOwogICAgdmFyIHJlYWRPbmx5ID0gdHJ1ZTsKCiAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihkYXRhKSkgewogICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7CiAgICAgICAgZGF0YSA9IEJ1ZmZlci5mcm9tKGRhdGEpOwogICAgICB9IGVsc2UgaWYgKEFycmF5QnVmZmVyLmlzVmlldyhkYXRhKSkgewogICAgICAgIGRhdGEgPSB2aWV3VG9CdWZmZXIoZGF0YSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGF0YSA9IEJ1ZmZlci5mcm9tKGRhdGEpOwogICAgICAgIHJlYWRPbmx5ID0gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5maXJzdEZyYWdtZW50KSB7CiAgICAgIHRoaXMuZmlyc3RGcmFnbWVudCA9IGZhbHNlOwogICAgICBpZiAocnN2MSAmJiB0aGlzLnBlck1lc3NhZ2VEZWZsYXRlKSB7CiAgICAgICAgcnN2MSA9IGRhdGEubGVuZ3RoID49IHRoaXMucGVyTWVzc2FnZURlZmxhdGUudGhyZXNob2xkOwogICAgICB9CiAgICAgIHRoaXMuY29tcHJlc3MgPSByc3YxOwogICAgfSBlbHNlIHsKICAgICAgcnN2MSA9IGZhbHNlOwogICAgICBvcGNvZGUgPSAwOwogICAgfQoKICAgIGlmIChvcHRpb25zLmZpbikgdGhpcy5maXJzdEZyYWdtZW50ID0gdHJ1ZTsKCiAgICBpZiAodGhpcy5wZXJNZXNzYWdlRGVmbGF0ZSkgewogICAgICBjb25zdCBvcHRzID0gewogICAgICAgIGNvbXByZXNzOiB0aGlzLmNvbXByZXNzLAogICAgICAgIG1hc2s6IG9wdGlvbnMubWFzaywKICAgICAgICBmaW46IG9wdGlvbnMuZmluLAogICAgICAgIHJlYWRPbmx5LAogICAgICAgIG9wY29kZSwKICAgICAgICByc3YxCiAgICAgIH07CgogICAgICBpZiAodGhpcy5kZWZsYXRpbmcpIHsKICAgICAgICB0aGlzLmVucXVldWUoW3RoaXMuZGlzcGF0Y2gsIGRhdGEsIG9wdHMsIGNiXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5kaXNwYXRjaChkYXRhLCBvcHRzLCBjYik7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuc2VuZEZyYW1lKFNlbmRlci5mcmFtZShkYXRhLCB7CiAgICAgICAgbWFzazogb3B0aW9ucy5tYXNrLAogICAgICAgIGZpbjogb3B0aW9ucy5maW4sCiAgICAgICAgcnN2MTogZmFsc2UsCiAgICAgICAgcmVhZE9ubHksCiAgICAgICAgb3Bjb2RlCiAgICAgIH0pLCBjYik7CiAgICB9CiAgfQoKICAvKioKICAgKiBEaXNwYXRjaGVzIGEgZGF0YSBtZXNzYWdlLgogICAqCiAgICogQHBhcmFtIHtCdWZmZXJ9IGRhdGEgVGhlIG1lc3NhZ2UgdG8gc2VuZAogICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIE9wdGlvbnMgb2JqZWN0CiAgICogQHBhcmFtIHtOdW1iZXJ9IG9wdGlvbnMub3Bjb2RlIFRoZSBvcGNvZGUKICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMucmVhZE9ubHkgU3BlY2lmaWVzIHdoZXRoZXIgYGRhdGFgIGNhbiBiZSBtb2RpZmllZAogICAqIEBwYXJhbSB7Qm9vbGVhbn0gb3B0aW9ucy5maW4gU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIHNldCB0aGUgRklOIGJpdAogICAqIEBwYXJhbSB7Qm9vbGVhbn0gb3B0aW9ucy5jb21wcmVzcyBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gY29tcHJlc3MgYGRhdGFgCiAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLm1hc2sgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIG1hc2sgYGRhdGFgCiAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLnJzdjEgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIHNldCB0aGUgUlNWMSBiaXQKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYiBDYWxsYmFjawogICAqIEBwcml2YXRlCiAgICovCiAgZGlzcGF0Y2ggKGRhdGEsIG9wdGlvbnMsIGNiKSB7CiAgICBpZiAoIW9wdGlvbnMuY29tcHJlc3MpIHsKICAgICAgdGhpcy5zZW5kRnJhbWUoU2VuZGVyLmZyYW1lKGRhdGEsIG9wdGlvbnMpLCBjYik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLmRlZmxhdGluZyA9IHRydWU7CiAgICB0aGlzLnBlck1lc3NhZ2VEZWZsYXRlLmNvbXByZXNzKGRhdGEsIG9wdGlvbnMuZmluLCAoZXJyLCBidWYpID0+IHsKICAgICAgaWYgKGVycikgewogICAgICAgIGlmIChjYikgY2IoZXJyKTsKICAgICAgICBlbHNlIHRoaXMub25lcnJvcihlcnIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgb3B0aW9ucy5yZWFkT25seSA9IGZhbHNlOwogICAgICB0aGlzLnNlbmRGcmFtZShTZW5kZXIuZnJhbWUoYnVmLCBvcHRpb25zKSwgY2IpOwogICAgICB0aGlzLmRlZmxhdGluZyA9IGZhbHNlOwogICAgICB0aGlzLmRlcXVldWUoKTsKICAgIH0pOwogIH0KCiAgLyoqCiAgICogRXhlY3V0ZXMgcXVldWVkIHNlbmQgb3BlcmF0aW9ucy4KICAgKgogICAqIEBwcml2YXRlCiAgICovCiAgZGVxdWV1ZSAoKSB7CiAgICB3aGlsZSAoIXRoaXMuZGVmbGF0aW5nICYmIHRoaXMucXVldWUubGVuZ3RoKSB7CiAgICAgIGNvbnN0IHBhcmFtcyA9IHRoaXMucXVldWUuc2hpZnQoKTsKCiAgICAgIHRoaXMuYnVmZmVyZWRCeXRlcyAtPSBwYXJhbXNbMV0ubGVuZ3RoOwogICAgICBwYXJhbXNbMF0uYXBwbHkodGhpcywgcGFyYW1zLnNsaWNlKDEpKTsKICAgIH0KICB9CgogIC8qKgogICAqIEVucXVldWVzIGEgc2VuZCBvcGVyYXRpb24uCiAgICoKICAgKiBAcGFyYW0ge0FycmF5fSBwYXJhbXMgU2VuZCBvcGVyYXRpb24gcGFyYW1ldGVycy4KICAgKiBAcHJpdmF0ZQogICAqLwogIGVucXVldWUgKHBhcmFtcykgewogICAgdGhpcy5idWZmZXJlZEJ5dGVzICs9IHBhcmFtc1sxXS5sZW5ndGg7CiAgICB0aGlzLnF1ZXVlLnB1c2gocGFyYW1zKTsKICB9CgogIC8qKgogICAqIFNlbmRzIGEgZnJhbWUuCiAgICoKICAgKiBAcGFyYW0ge0J1ZmZlcltdfSBsaXN0IFRoZSBmcmFtZSB0byBzZW5kCiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2IgQ2FsbGJhY2sKICAgKiBAcHJpdmF0ZQogICAqLwogIHNlbmRGcmFtZSAobGlzdCwgY2IpIHsKICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMikgewogICAgICB0aGlzLl9zb2NrZXQud3JpdGUobGlzdFswXSk7CiAgICAgIHRoaXMuX3NvY2tldC53cml0ZShsaXN0WzFdLCBjYik7CiAgICB9IGVsc2UgewogICAgICB0aGlzLl9zb2NrZXQud3JpdGUobGlzdFswXSwgY2IpOwogICAgfQogIH0KfQoKbW9kdWxlLmV4cG9ydHMgPSBTZW5kZXI7CgovKioKICogQ29udmVydHMgYW4gYEFycmF5QnVmZmVyYCB2aWV3IGludG8gYSBidWZmZXIuCiAqCiAqIEBwYXJhbSB7KERhdGFWaWV3fFR5cGVkQXJyYXkpfSB2aWV3IFRoZSB2aWV3IHRvIGNvbnZlcnQKICogQHJldHVybiB7QnVmZmVyfSBDb252ZXJ0ZWQgdmlldwogKiBAcHJpdmF0ZQogKi8KZnVuY3Rpb24gdmlld1RvQnVmZmVyICh2aWV3KSB7CiAgY29uc3QgYnVmID0gQnVmZmVyLmZyb20odmlldy5idWZmZXIpOwoKICBpZiAodmlldy5ieXRlTGVuZ3RoICE9PSB2aWV3LmJ1ZmZlci5ieXRlTGVuZ3RoKSB7CiAgICByZXR1cm4gYnVmLnNsaWNlKHZpZXcuYnl0ZU9mZnNldCwgdmlldy5ieXRlT2Zmc2V0ICsgdmlldy5ieXRlTGVuZ3RoKTsKICB9CgogIHJldHVybiBidWY7Cn0KCgovKioqLyB9KSwKLyogMTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwovKiEKICogd3M6IGEgbm9kZS5qcyB3ZWJzb2NrZXQgY2xpZW50CiAqIENvcHlyaWdodChjKSAyMDExIEVpbmFyIE90dG8gU3Rhbmd2aWsgPGVpbmFyb3NAZ21haWwuY29tPgogKiBNSVQgTGljZW5zZWQKICovCgoKCmNvbnN0IEV2ZW50RW1pdHRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpOwpjb25zdCBjcnlwdG8gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwpjb25zdCBVbHRyb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTsKY29uc3QgaHR0cHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKY29uc3QgaHR0cCA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwpjb25zdCB1cmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKTsKCmNvbnN0IFBlck1lc3NhZ2VEZWZsYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTsKY29uc3QgRXZlbnRUYXJnZXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ0KTsKY29uc3QgRXh0ZW5zaW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpOwpjb25zdCBjb25zdGFudHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwpjb25zdCBSZWNlaXZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpOwpjb25zdCBTZW5kZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCmNvbnN0IHByb3RvY29sVmVyc2lvbnMgPSBbOCwgMTNdOwpjb25zdCBjbG9zZVRpbWVvdXQgPSAzMCAqIDEwMDA7IC8vIEFsbG93IDMwIHNlY29uZHMgdG8gdGVybWluYXRlIHRoZSBjb25uZWN0aW9uIGNsZWFubHkuCgovKioKICogQ2xhc3MgcmVwcmVzZW50aW5nIGEgV2ViU29ja2V0LgogKgogKiBAZXh0ZW5kcyBFdmVudEVtaXR0ZXIKICovCmNsYXNzIFdlYlNvY2tldCBleHRlbmRzIEV2ZW50RW1pdHRlciB7CiAgLyoqCiAgICogQ3JlYXRlIGEgbmV3IGBXZWJTb2NrZXRgLgogICAqCiAgICogQHBhcmFtIHtTdHJpbmd9IGFkZHJlc3MgVGhlIFVSTCB0byB3aGljaCB0byBjb25uZWN0CiAgICogQHBhcmFtIHsoU3RyaW5nfFN0cmluZ1tdKX0gcHJvdG9jb2xzIFRoZSBzdWJwcm90b2NvbHMKICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBDb25uZWN0aW9uIG9wdGlvbnMKICAgKi8KICBjb25zdHJ1Y3RvciAoYWRkcmVzcywgcHJvdG9jb2xzLCBvcHRpb25zKSB7CiAgICBzdXBlcigpOwoKICAgIGlmICghcHJvdG9jb2xzKSB7CiAgICAgIHByb3RvY29scyA9IFtdOwogICAgfSBlbHNlIGlmICh0eXBlb2YgcHJvdG9jb2xzID09PSAnc3RyaW5nJykgewogICAgICBwcm90b2NvbHMgPSBbcHJvdG9jb2xzXTsKICAgIH0gZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkocHJvdG9jb2xzKSkgewogICAgICBvcHRpb25zID0gcHJvdG9jb2xzOwogICAgICBwcm90b2NvbHMgPSBbXTsKICAgIH0KCiAgICB0aGlzLnJlYWR5U3RhdGUgPSBXZWJTb2NrZXQuQ09OTkVDVElORzsKICAgIHRoaXMuYnl0ZXNSZWNlaXZlZCA9IDA7CiAgICB0aGlzLmV4dGVuc2lvbnMgPSB7fTsKICAgIHRoaXMucHJvdG9jb2wgPSAnJzsKCiAgICB0aGlzLl9iaW5hcnlUeXBlID0gY29uc3RhbnRzLkJJTkFSWV9UWVBFU1swXTsKICAgIHRoaXMuX2ZpbmFsaXplID0gdGhpcy5maW5hbGl6ZS5iaW5kKHRoaXMpOwogICAgdGhpcy5fZmluYWxpemVDYWxsZWQgPSBmYWxzZTsKICAgIHRoaXMuX2Nsb3NlTWVzc2FnZSA9IG51bGw7CiAgICB0aGlzLl9jbG9zZVRpbWVyID0gbnVsbDsKICAgIHRoaXMuX2Nsb3NlQ29kZSA9IG51bGw7CiAgICB0aGlzLl9yZWNlaXZlciA9IG51bGw7CiAgICB0aGlzLl9zZW5kZXIgPSBudWxsOwogICAgdGhpcy5fc29ja2V0ID0gbnVsbDsKICAgIHRoaXMuX3VsdHJvbiA9IG51bGw7CgogICAgaWYgKEFycmF5LmlzQXJyYXkoYWRkcmVzcykpIHsKICAgICAgaW5pdEFzU2VydmVyQ2xpZW50LmNhbGwodGhpcywgYWRkcmVzc1swXSwgYWRkcmVzc1sxXSwgYWRkcmVzc1syXSwgb3B0aW9ucyk7CiAgICB9IGVsc2UgewogICAgICBpbml0QXNDbGllbnQuY2FsbCh0aGlzLCBhZGRyZXNzLCBwcm90b2NvbHMsIG9wdGlvbnMpOwogICAgfQogIH0KCiAgZ2V0IENPTk5FQ1RJTkcgKCkgeyByZXR1cm4gV2ViU29ja2V0LkNPTk5FQ1RJTkc7IH0KICBnZXQgQ0xPU0lORyAoKSB7IHJldHVybiBXZWJTb2NrZXQuQ0xPU0lORzsgfQogIGdldCBDTE9TRUQgKCkgeyByZXR1cm4gV2ViU29ja2V0LkNMT1NFRDsgfQogIGdldCBPUEVOICgpIHsgcmV0dXJuIFdlYlNvY2tldC5PUEVOOyB9CgogIC8qKgogICAqIEB0eXBlIHtOdW1iZXJ9CiAgICovCiAgZ2V0IGJ1ZmZlcmVkQW1vdW50ICgpIHsKICAgIHZhciBhbW91bnQgPSAwOwoKICAgIGlmICh0aGlzLl9zb2NrZXQpIHsKICAgICAgYW1vdW50ID0gdGhpcy5fc29ja2V0LmJ1ZmZlclNpemUgKyB0aGlzLl9zZW5kZXIuYnVmZmVyZWRCeXRlczsKICAgIH0KICAgIHJldHVybiBhbW91bnQ7CiAgfQoKICAvKioKICAgKiBUaGlzIGRldmlhdGVzIGZyb20gdGhlIFdIQVRXRyBpbnRlcmZhY2Ugc2luY2Ugd3MgZG9lc24ndCBzdXBwb3J0IHRoZSByZXF1aXJlZAogICAqIGRlZmF1bHQgImJsb2IiIHR5cGUgKGluc3RlYWQgd2UgZGVmaW5lIGEgY3VzdG9tICJub2RlYnVmZmVyIiB0eXBlKS4KICAgKgogICAqIEB0eXBlIHtTdHJpbmd9CiAgICovCiAgZ2V0IGJpbmFyeVR5cGUgKCkgewogICAgcmV0dXJuIHRoaXMuX2JpbmFyeVR5cGU7CiAgfQoKICBzZXQgYmluYXJ5VHlwZSAodHlwZSkgewogICAgaWYgKGNvbnN0YW50cy5CSU5BUllfVFlQRVMuaW5kZXhPZih0eXBlKSA8IDApIHJldHVybjsKCiAgICB0aGlzLl9iaW5hcnlUeXBlID0gdHlwZTsKCiAgICAvLwogICAgLy8gQWxsb3cgdG8gY2hhbmdlIGBiaW5hcnlUeXBlYCBvbiB0aGUgZmx5LgogICAgLy8KICAgIGlmICh0aGlzLl9yZWNlaXZlcikgdGhpcy5fcmVjZWl2ZXIuYmluYXJ5VHlwZSA9IHR5cGU7CiAgfQoKICAvKioKICAgKiBTZXQgdXAgdGhlIHNvY2tldCBhbmQgdGhlIGludGVybmFsIHJlc291cmNlcy4KICAgKgogICAqIEBwYXJhbSB7bmV0LlNvY2tldH0gc29ja2V0IFRoZSBuZXR3b3JrIHNvY2tldCBiZXR3ZWVuIHRoZSBzZXJ2ZXIgYW5kIGNsaWVudAogICAqIEBwYXJhbSB7QnVmZmVyfSBoZWFkIFRoZSBmaXJzdCBwYWNrZXQgb2YgdGhlIHVwZ3JhZGVkIHN0cmVhbQogICAqIEBwcml2YXRlCiAgICovCiAgc2V0U29ja2V0IChzb2NrZXQsIGhlYWQpIHsKICAgIHNvY2tldC5zZXRUaW1lb3V0KDApOwogICAgc29ja2V0LnNldE5vRGVsYXkoKTsKCiAgICB0aGlzLl9yZWNlaXZlciA9IG5ldyBSZWNlaXZlcih0aGlzLmV4dGVuc2lvbnMsIHRoaXMubWF4UGF5bG9hZCwgdGhpcy5iaW5hcnlUeXBlKTsKICAgIHRoaXMuX3NlbmRlciA9IG5ldyBTZW5kZXIoc29ja2V0LCB0aGlzLmV4dGVuc2lvbnMpOwogICAgdGhpcy5fdWx0cm9uID0gbmV3IFVsdHJvbihzb2NrZXQpOwogICAgdGhpcy5fc29ja2V0ID0gc29ja2V0OwoKICAgIC8vIHNvY2tldCBjbGVhbnVwIGhhbmRsZXJzCiAgICB0aGlzLl91bHRyb24ub24oJ2Nsb3NlJywgdGhpcy5fZmluYWxpemUpOwogICAgdGhpcy5fdWx0cm9uLm9uKCdlcnJvcicsIHRoaXMuX2ZpbmFsaXplKTsKICAgIHRoaXMuX3VsdHJvbi5vbignZW5kJywgdGhpcy5fZmluYWxpemUpOwoKICAgIC8vIGVuc3VyZSB0aGF0IHRoZSBoZWFkIGlzIGFkZGVkIHRvIHRoZSByZWNlaXZlcgogICAgaWYgKGhlYWQgJiYgaGVhZC5sZW5ndGggPiAwKSB7CiAgICAgIHNvY2tldC51bnNoaWZ0KGhlYWQpOwogICAgICBoZWFkID0gbnVsbDsKICAgIH0KCiAgICAvLyBzdWJzZXF1ZW50IHBhY2tldHMgYXJlIHB1c2hlZCB0byB0aGUgcmVjZWl2ZXIKICAgIHRoaXMuX3VsdHJvbi5vbignZGF0YScsIChkYXRhKSA9PiB7CiAgICAgIHRoaXMuYnl0ZXNSZWNlaXZlZCArPSBkYXRhLmxlbmd0aDsKICAgICAgdGhpcy5fcmVjZWl2ZXIuYWRkKGRhdGEpOwogICAgfSk7CgogICAgLy8gcmVjZWl2ZXIgZXZlbnQgaGFuZGxlcnMKICAgIHRoaXMuX3JlY2VpdmVyLm9ubWVzc2FnZSA9IChkYXRhLCBmbGFncykgPT4gdGhpcy5lbWl0KCdtZXNzYWdlJywgZGF0YSwgZmxhZ3MpOwogICAgdGhpcy5fcmVjZWl2ZXIub25waW5nID0gKGRhdGEsIGZsYWdzKSA9PiB7CiAgICAgIHRoaXMucG9uZyhkYXRhLCAhdGhpcy5faXNTZXJ2ZXIsIHRydWUpOwogICAgICB0aGlzLmVtaXQoJ3BpbmcnLCBkYXRhLCBmbGFncyk7CiAgICB9OwogICAgdGhpcy5fcmVjZWl2ZXIub25wb25nID0gKGRhdGEsIGZsYWdzKSA9PiB0aGlzLmVtaXQoJ3BvbmcnLCBkYXRhLCBmbGFncyk7CiAgICB0aGlzLl9yZWNlaXZlci5vbmNsb3NlID0gKGNvZGUsIHJlYXNvbikgPT4gewogICAgICB0aGlzLl9jbG9zZU1lc3NhZ2UgPSByZWFzb247CiAgICAgIHRoaXMuX2Nsb3NlQ29kZSA9IGNvZGU7CiAgICAgIHRoaXMuY2xvc2UoY29kZSwgcmVhc29uKTsKICAgIH07CiAgICB0aGlzLl9yZWNlaXZlci5vbmVycm9yID0gKGVycm9yLCBjb2RlKSA9PiB7CiAgICAgIC8vIGNsb3NlIHRoZSBjb25uZWN0aW9uIHdoZW4gdGhlIHJlY2VpdmVyIHJlcG9ydHMgYSBIeUJpIGVycm9yIGNvZGUKICAgICAgdGhpcy5jbG9zZShjb2RlLCAnJyk7CiAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBlcnJvcik7CiAgICB9OwoKICAgIC8vIHNlbmRlciBldmVudCBoYW5kbGVycwogICAgdGhpcy5fc2VuZGVyLm9uZXJyb3IgPSAoZXJyb3IpID0+IHsKICAgICAgdGhpcy5jbG9zZSgxMDAyLCAnJyk7CiAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBlcnJvcik7CiAgICB9OwoKICAgIHRoaXMucmVhZHlTdGF0ZSA9IFdlYlNvY2tldC5PUEVOOwogICAgdGhpcy5lbWl0KCdvcGVuJyk7CiAgfQoKICAvKioKICAgKiBDbGVhbiB1cCBhbmQgcmVsZWFzZSBpbnRlcm5hbCByZXNvdXJjZXMuCiAgICoKICAgKiBAcGFyYW0geyhCb29sZWFufEVycm9yKX0gSW5kaWNhdGVzIHdoZXRoZXIgb3Igbm90IGFuIGVycm9yIG9jY3VycmVkCiAgICogQHByaXZhdGUKICAgKi8KICBmaW5hbGl6ZSAoZXJyb3IpIHsKICAgIGlmICh0aGlzLl9maW5hbGl6ZUNhbGxlZCkgcmV0dXJuOwoKICAgIHRoaXMucmVhZHlTdGF0ZSA9IFdlYlNvY2tldC5DTE9TSU5HOwogICAgdGhpcy5fZmluYWxpemVDYWxsZWQgPSB0cnVlOwoKICAgIGNsZWFyVGltZW91dCh0aGlzLl9jbG9zZVRpbWVyKTsKICAgIHRoaXMuX2Nsb3NlVGltZXIgPSBudWxsOwoKICAgIC8vCiAgICAvLyBJZiB0aGUgY29ubmVjdGlvbiB3YXMgY2xvc2VkIGFibm9ybWFsbHkgKHdpdGggYW4gZXJyb3IpLCBvciBpZiB0aGUgY2xvc2UKICAgIC8vIGNvbnRyb2wgZnJhbWUgd2FzIG1hbGZvcm1lZCBvciBub3QgcmVjZWl2ZWQgdGhlbiB0aGUgY2xvc2UgY29kZSBtdXN0IGJlCiAgICAvLyAxMDA2LgogICAgLy8KICAgIGlmIChlcnJvcikgdGhpcy5fY2xvc2VDb2RlID0gMTAwNjsKCiAgICBpZiAodGhpcy5fc29ja2V0KSB7CiAgICAgIHRoaXMuX3VsdHJvbi5kZXN0cm95KCk7CiAgICAgIHRoaXMuX3NvY2tldC5vbignZXJyb3InLCBmdW5jdGlvbiBvbmVycm9yICgpIHsKICAgICAgICB0aGlzLmRlc3Ryb3koKTsKICAgICAgfSk7CgogICAgICBpZiAoIWVycm9yKSB0aGlzLl9zb2NrZXQuZW5kKCk7CiAgICAgIGVsc2UgdGhpcy5fc29ja2V0LmRlc3Ryb3koKTsKCiAgICAgIHRoaXMuX3NvY2tldCA9IG51bGw7CiAgICAgIHRoaXMuX3VsdHJvbiA9IG51bGw7CiAgICB9CgogICAgaWYgKHRoaXMuX3NlbmRlcikgewogICAgICB0aGlzLl9zZW5kZXIgPSB0aGlzLl9zZW5kZXIub25lcnJvciA9IG51bGw7CiAgICB9CgogICAgaWYgKHRoaXMuX3JlY2VpdmVyKSB7CiAgICAgIHRoaXMuX3JlY2VpdmVyLmNsZWFudXAoKCkgPT4gdGhpcy5lbWl0Q2xvc2UoKSk7CiAgICAgIHRoaXMuX3JlY2VpdmVyID0gbnVsbDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZW1pdENsb3NlKCk7CiAgICB9CiAgfQoKICAvKioKICAgKiBFbWl0IHRoZSBgY2xvc2VgIGV2ZW50LgogICAqCiAgICogQHByaXZhdGUKICAgKi8KICBlbWl0Q2xvc2UgKCkgewogICAgdGhpcy5yZWFkeVN0YXRlID0gV2ViU29ja2V0LkNMT1NFRDsKICAgIHRoaXMuZW1pdCgnY2xvc2UnLCB0aGlzLl9jbG9zZUNvZGUgfHwgMTAwNiwgdGhpcy5fY2xvc2VNZXNzYWdlIHx8ICcnKTsKCiAgICBpZiAodGhpcy5leHRlbnNpb25zW1Blck1lc3NhZ2VEZWZsYXRlLmV4dGVuc2lvbk5hbWVdKSB7CiAgICAgIHRoaXMuZXh0ZW5zaW9uc1tQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXS5jbGVhbnVwKCk7CiAgICB9CgogICAgdGhpcy5leHRlbnNpb25zID0gbnVsbDsKCiAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycygpOwogICAgdGhpcy5vbignZXJyb3InLCBjb25zdGFudHMuTk9PUCk7IC8vIENhdGNoIGFsbCBlcnJvcnMgYWZ0ZXIgdGhpcy4KICB9CgogIC8qKgogICAqIFBhdXNlIHRoZSBzb2NrZXQgc3RyZWFtLgogICAqCiAgICogQHB1YmxpYwogICAqLwogIHBhdXNlICgpIHsKICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgIT09IFdlYlNvY2tldC5PUEVOKSB0aHJvdyBuZXcgRXJyb3IoJ25vdCBvcGVuZWQnKTsKCiAgICB0aGlzLl9zb2NrZXQucGF1c2UoKTsKICB9CgogIC8qKgogICAqIFJlc3VtZSB0aGUgc29ja2V0IHN0cmVhbQogICAqCiAgICogQHB1YmxpYwogICAqLwogIHJlc3VtZSAoKSB7CiAgICBpZiAodGhpcy5yZWFkeVN0YXRlICE9PSBXZWJTb2NrZXQuT1BFTikgdGhyb3cgbmV3IEVycm9yKCdub3Qgb3BlbmVkJyk7CgogICAgdGhpcy5fc29ja2V0LnJlc3VtZSgpOwogIH0KCiAgLyoqCiAgICogU3RhcnQgYSBjbG9zaW5nIGhhbmRzaGFrZS4KICAgKgogICAqIEBwYXJhbSB7TnVtYmVyfSBjb2RlIFN0YXR1cyBjb2RlIGV4cGxhaW5pbmcgd2h5IHRoZSBjb25uZWN0aW9uIGlzIGNsb3NpbmcKICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YSBBIHN0cmluZyBleHBsYWluaW5nIHdoeSB0aGUgY29ubmVjdGlvbiBpcyBjbG9zaW5nCiAgICogQHB1YmxpYwogICAqLwogIGNsb3NlIChjb2RlLCBkYXRhKSB7CiAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuQ0xPU0VEKSByZXR1cm47CiAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuQ09OTkVDVElORykgewogICAgICBpZiAodGhpcy5fcmVxICYmICF0aGlzLl9yZXEuYWJvcnRlZCkgewogICAgICAgIHRoaXMuX3JlcS5hYm9ydCgpOwogICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ2Nsb3NlZCBiZWZvcmUgdGhlIGNvbm5lY3Rpb24gaXMgZXN0YWJsaXNoZWQnKSk7CiAgICAgICAgdGhpcy5maW5hbGl6ZSh0cnVlKTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0LkNMT1NJTkcpIHsKICAgICAgaWYgKHRoaXMuX2Nsb3NlQ29kZSAmJiB0aGlzLl9zb2NrZXQpIHRoaXMuX3NvY2tldC5lbmQoKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMucmVhZHlTdGF0ZSA9IFdlYlNvY2tldC5DTE9TSU5HOwogICAgdGhpcy5fc2VuZGVyLmNsb3NlKGNvZGUsIGRhdGEsICF0aGlzLl9pc1NlcnZlciwgKGVycikgPT4gewogICAgICBpZiAoZXJyKSB0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTsKCiAgICAgIGlmICh0aGlzLl9zb2NrZXQpIHsKICAgICAgICBpZiAodGhpcy5fY2xvc2VDb2RlKSB0aGlzLl9zb2NrZXQuZW5kKCk7CiAgICAgICAgLy8KICAgICAgICAvLyBFbnN1cmUgdGhhdCB0aGUgY29ubmVjdGlvbiBpcyBjbGVhbmVkIHVwIGV2ZW4gd2hlbiB0aGUgY2xvc2luZwogICAgICAgIC8vIGhhbmRzaGFrZSBmYWlscy4KICAgICAgICAvLwogICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9jbG9zZVRpbWVyKTsKICAgICAgICB0aGlzLl9jbG9zZVRpbWVyID0gc2V0VGltZW91dCh0aGlzLl9maW5hbGl6ZSwgY2xvc2VUaW1lb3V0LCB0cnVlKTsKICAgICAgfQogICAgfSk7CiAgfQoKICAvKioKICAgKiBTZW5kIGEgcGluZyBtZXNzYWdlLgogICAqCiAgICogQHBhcmFtIHsqfSBkYXRhIFRoZSBtZXNzYWdlIHRvIHNlbmQKICAgKiBAcGFyYW0ge0Jvb2xlYW59IG1hc2sgSW5kaWNhdGVzIHdoZXRoZXIgb3Igbm90IHRvIG1hc2sgYGRhdGFgCiAgICogQHBhcmFtIHtCb29sZWFufSBmYWlsU2lsZW50bHkgSW5kaWNhdGVzIHdoZXRoZXIgb3Igbm90IHRvIHRocm93IGlmIGByZWFkeVN0YXRlYCBpc24ndCBgT1BFTmAKICAgKiBAcHVibGljCiAgICovCiAgcGluZyAoZGF0YSwgbWFzaywgZmFpbFNpbGVudGx5KSB7CiAgICBpZiAodGhpcy5yZWFkeVN0YXRlICE9PSBXZWJTb2NrZXQuT1BFTikgewogICAgICBpZiAoZmFpbFNpbGVudGx5KSByZXR1cm47CiAgICAgIHRocm93IG5ldyBFcnJvcignbm90IG9wZW5lZCcpOwogICAgfQoKICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ251bWJlcicpIGRhdGEgPSBkYXRhLnRvU3RyaW5nKCk7CiAgICBpZiAobWFzayA9PT0gdW5kZWZpbmVkKSBtYXNrID0gIXRoaXMuX2lzU2VydmVyOwogICAgdGhpcy5fc2VuZGVyLnBpbmcoZGF0YSB8fCBjb25zdGFudHMuRU1QVFlfQlVGRkVSLCBtYXNrKTsKICB9CgogIC8qKgogICAqIFNlbmQgYSBwb25nIG1lc3NhZ2UuCiAgICoKICAgKiBAcGFyYW0geyp9IGRhdGEgVGhlIG1lc3NhZ2UgdG8gc2VuZAogICAqIEBwYXJhbSB7Qm9vbGVhbn0gbWFzayBJbmRpY2F0ZXMgd2hldGhlciBvciBub3QgdG8gbWFzayBgZGF0YWAKICAgKiBAcGFyYW0ge0Jvb2xlYW59IGZhaWxTaWxlbnRseSBJbmRpY2F0ZXMgd2hldGhlciBvciBub3QgdG8gdGhyb3cgaWYgYHJlYWR5U3RhdGVgIGlzbid0IGBPUEVOYAogICAqIEBwdWJsaWMKICAgKi8KICBwb25nIChkYXRhLCBtYXNrLCBmYWlsU2lsZW50bHkpIHsKICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgIT09IFdlYlNvY2tldC5PUEVOKSB7CiAgICAgIGlmIChmYWlsU2lsZW50bHkpIHJldHVybjsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdub3Qgb3BlbmVkJyk7CiAgICB9CgogICAgaWYgKHR5cGVvZiBkYXRhID09PSAnbnVtYmVyJykgZGF0YSA9IGRhdGEudG9TdHJpbmcoKTsKICAgIGlmIChtYXNrID09PSB1bmRlZmluZWQpIG1hc2sgPSAhdGhpcy5faXNTZXJ2ZXI7CiAgICB0aGlzLl9zZW5kZXIucG9uZyhkYXRhIHx8IGNvbnN0YW50cy5FTVBUWV9CVUZGRVIsIG1hc2spOwogIH0KCiAgLyoqCiAgICogU2VuZCBhIGRhdGEgbWVzc2FnZS4KICAgKgogICAqIEBwYXJhbSB7Kn0gZGF0YSBUaGUgbWVzc2FnZSB0byBzZW5kCiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgT3B0aW9ucyBvYmplY3QKICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMuY29tcHJlc3MgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIGNvbXByZXNzIGBkYXRhYAogICAqIEBwYXJhbSB7Qm9vbGVhbn0gb3B0aW9ucy5iaW5hcnkgU3BlY2lmaWVzIHdoZXRoZXIgYGRhdGFgIGlzIGJpbmFyeSBvciB0ZXh0CiAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLmZpbiBTcGVjaWZpZXMgd2hldGhlciB0aGUgZnJhZ21lbnQgaXMgdGhlIGxhc3Qgb25lCiAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLm1hc2sgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIG1hc2sgYGRhdGFgCiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2IgQ2FsbGJhY2sgd2hpY2ggaXMgZXhlY3V0ZWQgd2hlbiBkYXRhIGlzIHdyaXR0ZW4gb3V0CiAgICogQHB1YmxpYwogICAqLwogIHNlbmQgKGRhdGEsIG9wdGlvbnMsIGNiKSB7CiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdmdW5jdGlvbicpIHsKICAgICAgY2IgPSBvcHRpb25zOwogICAgICBvcHRpb25zID0ge307CiAgICB9CgogICAgaWYgKHRoaXMucmVhZHlTdGF0ZSAhPT0gV2ViU29ja2V0Lk9QRU4pIHsKICAgICAgaWYgKGNiKSBjYihuZXcgRXJyb3IoJ25vdCBvcGVuZWQnKSk7CiAgICAgIGVsc2UgdGhyb3cgbmV3IEVycm9yKCdub3Qgb3BlbmVkJyk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdudW1iZXInKSBkYXRhID0gZGF0YS50b1N0cmluZygpOwoKICAgIGNvbnN0IG9wdHMgPSBPYmplY3QuYXNzaWduKHsKICAgICAgYmluYXJ5OiB0eXBlb2YgZGF0YSAhPT0gJ3N0cmluZycsCiAgICAgIG1hc2s6ICF0aGlzLl9pc1NlcnZlciwKICAgICAgY29tcHJlc3M6IHRydWUsCiAgICAgIGZpbjogdHJ1ZQogICAgfSwgb3B0aW9ucyk7CgogICAgaWYgKCF0aGlzLmV4dGVuc2lvbnNbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0pIHsKICAgICAgb3B0cy5jb21wcmVzcyA9IGZhbHNlOwogICAgfQoKICAgIHRoaXMuX3NlbmRlci5zZW5kKGRhdGEgfHwgY29uc3RhbnRzLkVNUFRZX0JVRkZFUiwgb3B0cywgY2IpOwogIH0KCiAgLyoqCiAgICogRm9yY2libHkgY2xvc2UgdGhlIGNvbm5lY3Rpb24uCiAgICoKICAgKiBAcHVibGljCiAgICovCiAgdGVybWluYXRlICgpIHsKICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5DTE9TRUQpIHJldHVybjsKICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5DT05ORUNUSU5HKSB7CiAgICAgIGlmICh0aGlzLl9yZXEgJiYgIXRoaXMuX3JlcS5hYm9ydGVkKSB7CiAgICAgICAgdGhpcy5fcmVxLmFib3J0KCk7CiAgICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignY2xvc2VkIGJlZm9yZSB0aGUgY29ubmVjdGlvbiBpcyBlc3RhYmxpc2hlZCcpKTsKICAgICAgICB0aGlzLmZpbmFsaXplKHRydWUpOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLmZpbmFsaXplKHRydWUpOwogIH0KfQoKV2ViU29ja2V0LkNPTk5FQ1RJTkcgPSAwOwpXZWJTb2NrZXQuT1BFTiA9IDE7CldlYlNvY2tldC5DTE9TSU5HID0gMjsKV2ViU29ja2V0LkNMT1NFRCA9IDM7CgovLwovLyBBZGQgdGhlIGBvbm9wZW5gLCBgb25lcnJvcmAsIGBvbmNsb3NlYCwgYW5kIGBvbm1lc3NhZ2VgIGF0dHJpYnV0ZXMuCi8vIFNlZSBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9jb21tcy5odG1sI3RoZS13ZWJzb2NrZXQtaW50ZXJmYWNlCi8vClsnb3BlbicsICdlcnJvcicsICdjbG9zZScsICdtZXNzYWdlJ10uZm9yRWFjaCgobWV0aG9kKSA9PiB7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFdlYlNvY2tldC5wcm90b3R5cGUsIGBvbiR7bWV0aG9kfWAsIHsKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBsaXN0ZW5lciBvZiB0aGUgZXZlbnQuCiAgICAgKgogICAgICogQHJldHVybiB7KEZ1bmN0aW9ufHVuZGVmaW5lZCl9IFRoZSBldmVudCBsaXN0ZW5lciBvciBgdW5kZWZpbmVkYAogICAgICogQHB1YmxpYwogICAgICovCiAgICBnZXQgKCkgewogICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVycyhtZXRob2QpOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChsaXN0ZW5lcnNbaV0uX2xpc3RlbmVyKSByZXR1cm4gbGlzdGVuZXJzW2ldLl9saXN0ZW5lcjsKICAgICAgfQogICAgfSwKICAgIC8qKgogICAgICogQWRkIGEgbGlzdGVuZXIgZm9yIHRoZSBldmVudC4KICAgICAqCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciBUaGUgbGlzdGVuZXIgdG8gYWRkCiAgICAgKiBAcHVibGljCiAgICAgKi8KICAgIHNldCAobGlzdGVuZXIpIHsKICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5saXN0ZW5lcnMobWV0aG9kKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0ZW5lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLwogICAgICAgIC8vIFJlbW92ZSBvbmx5IHRoZSBsaXN0ZW5lcnMgYWRkZWQgdmlhIGBhZGRFdmVudExpc3RlbmVyYC4KICAgICAgICAvLwogICAgICAgIGlmIChsaXN0ZW5lcnNbaV0uX2xpc3RlbmVyKSB0aGlzLnJlbW92ZUxpc3RlbmVyKG1ldGhvZCwgbGlzdGVuZXJzW2ldKTsKICAgICAgfQogICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIobWV0aG9kLCBsaXN0ZW5lcik7CiAgICB9CiAgfSk7Cn0pOwoKV2ViU29ja2V0LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gRXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcjsKV2ViU29ja2V0LnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gRXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcjsKCm1vZHVsZS5leHBvcnRzID0gV2ViU29ja2V0OwoKLyoqCiAqIEluaXRpYWxpemUgYSBXZWJTb2NrZXQgc2VydmVyIGNsaWVudC4KICoKICogQHBhcmFtIHtodHRwLkluY29taW5nTWVzc2FnZX0gcmVxIFRoZSByZXF1ZXN0IG9iamVjdAogKiBAcGFyYW0ge25ldC5Tb2NrZXR9IHNvY2tldCBUaGUgbmV0d29yayBzb2NrZXQgYmV0d2VlbiB0aGUgc2VydmVyIGFuZCBjbGllbnQKICogQHBhcmFtIHtCdWZmZXJ9IGhlYWQgVGhlIGZpcnN0IHBhY2tldCBvZiB0aGUgdXBncmFkZWQgc3RyZWFtCiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIFdlYlNvY2tldCBhdHRyaWJ1dGVzCiAqIEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLnByb3RvY29sVmVyc2lvbiBUaGUgV2ViU29ja2V0IHByb3RvY29sIHZlcnNpb24KICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMuZXh0ZW5zaW9ucyBUaGUgbmVnb3RpYXRlZCBleHRlbnNpb25zCiAqIEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLm1heFBheWxvYWQgVGhlIG1heGltdW0gYWxsb3dlZCBtZXNzYWdlIHNpemUKICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMucHJvdG9jb2wgVGhlIGNob3NlbiBzdWJwcm90b2NvbAogKiBAcHJpdmF0ZQogKi8KZnVuY3Rpb24gaW5pdEFzU2VydmVyQ2xpZW50IChyZXEsIHNvY2tldCwgaGVhZCwgb3B0aW9ucykgewogIHRoaXMucHJvdG9jb2xWZXJzaW9uID0gb3B0aW9ucy5wcm90b2NvbFZlcnNpb247CiAgdGhpcy5leHRlbnNpb25zID0gb3B0aW9ucy5leHRlbnNpb25zOwogIHRoaXMubWF4UGF5bG9hZCA9IG9wdGlvbnMubWF4UGF5bG9hZDsKICB0aGlzLnByb3RvY29sID0gb3B0aW9ucy5wcm90b2NvbDsKCiAgdGhpcy51cGdyYWRlUmVxID0gcmVxOwogIHRoaXMuX2lzU2VydmVyID0gdHJ1ZTsKCiAgdGhpcy5zZXRTb2NrZXQoc29ja2V0LCBoZWFkKTsKfQoKLyoqCiAqIEluaXRpYWxpemUgYSBXZWJTb2NrZXQgY2xpZW50LgogKgogKiBAcGFyYW0ge1N0cmluZ30gYWRkcmVzcyBUaGUgVVJMIHRvIHdoaWNoIHRvIGNvbm5lY3QKICogQHBhcmFtIHtTdHJpbmdbXX0gcHJvdG9jb2xzIFRoZSBsaXN0IG9mIHN1YnByb3RvY29scwogKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBDb25uZWN0aW9uIG9wdGlvbnMKICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMucHJvdG9jb2wgVmFsdWUgb2YgdGhlIGBTZWMtV2ViU29ja2V0LVByb3RvY29sYCBoZWFkZXIKICogQHBhcmFtIHsoQm9vbGVhbnxPYmplY3QpfSBvcHRpb25zLnBlck1lc3NhZ2VEZWZsYXRlIEVuYWJsZS9kaXNhYmxlIHBlcm1lc3NhZ2UtZGVmbGF0ZQogKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy5sb2NhbEFkZHJlc3MgTG9jYWwgaW50ZXJmYWNlIHRvIGJpbmQgZm9yIG5ldHdvcmsgY29ubmVjdGlvbnMKICogQHBhcmFtIHtOdW1iZXJ9IG9wdGlvbnMucHJvdG9jb2xWZXJzaW9uIFZhbHVlIG9mIHRoZSBgU2VjLVdlYlNvY2tldC1WZXJzaW9uYCBoZWFkZXIKICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMuaGVhZGVycyBBbiBvYmplY3QgY29udGFpbmluZyByZXF1ZXN0IGhlYWRlcnMKICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMub3JpZ2luIFZhbHVlIG9mIHRoZSBgT3JpZ2luYCBvciBgU2VjLVdlYlNvY2tldC1PcmlnaW5gIGhlYWRlcgogKiBAcGFyYW0ge2h0dHAuQWdlbnR9IG9wdGlvbnMuYWdlbnQgVXNlIHRoZSBzcGVjaWZpZWQgQWdlbnQKICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMuaG9zdCBWYWx1ZSBvZiB0aGUgYEhvc3RgIGhlYWRlcgogKiBAcGFyYW0ge051bWJlcn0gb3B0aW9ucy5mYW1pbHkgSVAgYWRkcmVzcyBmYW1pbHkgdG8gdXNlIGR1cmluZyBob3N0bmFtZSBsb29rdXAgKDQgb3IgNikuCiAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMuY2hlY2tTZXJ2ZXJJZGVudGl0eSBBIGZ1bmN0aW9uIHRvIHZhbGlkYXRlIHRoZSBzZXJ2ZXIgaG9zdG5hbWUKICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLnJlamVjdFVuYXV0aG9yaXplZCBWZXJpZnkgb3Igbm90IHRoZSBzZXJ2ZXIgY2VydGlmaWNhdGUKICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMucGFzc3BocmFzZSBUaGUgcGFzc3BocmFzZSBmb3IgdGhlIHByaXZhdGUga2V5IG9yIHBmeAogKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy5jaXBoZXJzIFRoZSBjaXBoZXJzIHRvIHVzZSBvciBleGNsdWRlCiAqIEBwYXJhbSB7KFN0cmluZ3xTdHJpbmdbXXxCdWZmZXJ8QnVmZmVyW10pfSBvcHRpb25zLmNlcnQgVGhlIGNlcnRpZmljYXRlIGtleQogKiBAcGFyYW0geyhTdHJpbmd8U3RyaW5nW118QnVmZmVyfEJ1ZmZlcltdKX0gb3B0aW9ucy5rZXkgVGhlIHByaXZhdGUga2V5CiAqIEBwYXJhbSB7KFN0cmluZ3xCdWZmZXIpfSBvcHRpb25zLnBmeCBUaGUgcHJpdmF0ZSBrZXksIGNlcnRpZmljYXRlLCBhbmQgQ0EgY2VydHMKICogQHBhcmFtIHsoU3RyaW5nfFN0cmluZ1tdfEJ1ZmZlcnxCdWZmZXJbXSl9IG9wdGlvbnMuY2EgVHJ1c3RlZCBjZXJ0aWZpY2F0ZXMKICogQHByaXZhdGUKICovCmZ1bmN0aW9uIGluaXRBc0NsaWVudCAoYWRkcmVzcywgcHJvdG9jb2xzLCBvcHRpb25zKSB7CiAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oewogICAgcHJvdG9jb2xWZXJzaW9uOiBwcm90b2NvbFZlcnNpb25zWzFdLAogICAgcHJvdG9jb2w6IHByb3RvY29scy5qb2luKCcsJyksCiAgICBwZXJNZXNzYWdlRGVmbGF0ZTogdHJ1ZSwKICAgIGxvY2FsQWRkcmVzczogbnVsbCwKICAgIGhlYWRlcnM6IG51bGwsCiAgICBmYW1pbHk6IG51bGwsCiAgICBvcmlnaW46IG51bGwsCiAgICBhZ2VudDogbnVsbCwKICAgIGhvc3Q6IG51bGwsCgogICAgLy8KICAgIC8vIFNTTCBvcHRpb25zLgogICAgLy8KICAgIGNoZWNrU2VydmVySWRlbnRpdHk6IG51bGwsCiAgICByZWplY3RVbmF1dGhvcml6ZWQ6IG51bGwsCiAgICBwYXNzcGhyYXNlOiBudWxsLAogICAgY2lwaGVyczogbnVsbCwKICAgIGNlcnQ6IG51bGwsCiAgICBrZXk6IG51bGwsCiAgICBwZng6IG51bGwsCiAgICBjYTogbnVsbAogIH0sIG9wdGlvbnMpOwoKICBpZiAocHJvdG9jb2xWZXJzaW9ucy5pbmRleE9mKG9wdGlvbnMucHJvdG9jb2xWZXJzaW9uKSA9PT0gLTEpIHsKICAgIHRocm93IG5ldyBFcnJvcigKICAgICAgYHVuc3VwcG9ydGVkIHByb3RvY29sIHZlcnNpb246ICR7b3B0aW9ucy5wcm90b2NvbFZlcnNpb259IGAgKwogICAgICBgKHN1cHBvcnRlZCB2ZXJzaW9uczogJHtwcm90b2NvbFZlcnNpb25zLmpvaW4oJywgJyl9KWAKICAgICk7CiAgfQoKICB0aGlzLnByb3RvY29sVmVyc2lvbiA9IG9wdGlvbnMucHJvdG9jb2xWZXJzaW9uOwogIHRoaXMuX2lzU2VydmVyID0gZmFsc2U7CiAgdGhpcy51cmwgPSBhZGRyZXNzOwoKICBjb25zdCBzZXJ2ZXJVcmwgPSB1cmwucGFyc2UoYWRkcmVzcyk7CiAgY29uc3QgaXNVbml4U29ja2V0ID0gc2VydmVyVXJsLnByb3RvY29sID09PSAnd3MrdW5peDonOwoKICBpZiAoIXNlcnZlclVybC5ob3N0ICYmICghaXNVbml4U29ja2V0IHx8ICFzZXJ2ZXJVcmwucGF0aCkpIHsKICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCB1cmwnKTsKICB9CgogIGNvbnN0IGlzU2VjdXJlID0gc2VydmVyVXJsLnByb3RvY29sID09PSAnd3NzOicgfHwgc2VydmVyVXJsLnByb3RvY29sID09PSAnaHR0cHM6JzsKICBjb25zdCBrZXkgPSBjcnlwdG8ucmFuZG9tQnl0ZXMoMTYpLnRvU3RyaW5nKCdiYXNlNjQnKTsKICBjb25zdCBodHRwT2JqID0gaXNTZWN1cmUgPyBodHRwcyA6IGh0dHA7CgogIC8vCiAgLy8gUHJlcGFyZSBleHRlbnNpb25zLgogIC8vCiAgY29uc3QgZXh0ZW5zaW9uc09mZmVyID0ge307CiAgdmFyIHBlck1lc3NhZ2VEZWZsYXRlOwoKICBpZiAob3B0aW9ucy5wZXJNZXNzYWdlRGVmbGF0ZSkgewogICAgcGVyTWVzc2FnZURlZmxhdGUgPSBuZXcgUGVyTWVzc2FnZURlZmxhdGUoCiAgICAgIG9wdGlvbnMucGVyTWVzc2FnZURlZmxhdGUgIT09IHRydWUgPyBvcHRpb25zLnBlck1lc3NhZ2VEZWZsYXRlIDoge30sCiAgICAgIGZhbHNlCiAgICApOwogICAgZXh0ZW5zaW9uc09mZmVyW1Blck1lc3NhZ2VEZWZsYXRlLmV4dGVuc2lvbk5hbWVdID0gcGVyTWVzc2FnZURlZmxhdGUub2ZmZXIoKTsKICB9CgogIGNvbnN0IHJlcXVlc3RPcHRpb25zID0gewogICAgcG9ydDogc2VydmVyVXJsLnBvcnQgfHwgKGlzU2VjdXJlID8gNDQzIDogODApLAogICAgaG9zdDogc2VydmVyVXJsLmhvc3RuYW1lLAogICAgcGF0aDogJy8nLAogICAgaGVhZGVyczogewogICAgICAnU2VjLVdlYlNvY2tldC1WZXJzaW9uJzogb3B0aW9ucy5wcm90b2NvbFZlcnNpb24sCiAgICAgICdTZWMtV2ViU29ja2V0LUtleSc6IGtleSwKICAgICAgJ0Nvbm5lY3Rpb24nOiAnVXBncmFkZScsCiAgICAgICdVcGdyYWRlJzogJ3dlYnNvY2tldCcKICAgIH0KICB9OwoKICBpZiAob3B0aW9ucy5oZWFkZXJzKSBPYmplY3QuYXNzaWduKHJlcXVlc3RPcHRpb25zLmhlYWRlcnMsIG9wdGlvbnMuaGVhZGVycyk7CiAgaWYgKE9iamVjdC5rZXlzKGV4dGVuc2lvbnNPZmZlcikubGVuZ3RoKSB7CiAgICByZXF1ZXN0T3B0aW9ucy5oZWFkZXJzWydTZWMtV2ViU29ja2V0LUV4dGVuc2lvbnMnXSA9IEV4dGVuc2lvbnMuZm9ybWF0KGV4dGVuc2lvbnNPZmZlcik7CiAgfQogIGlmIChvcHRpb25zLnByb3RvY29sKSB7CiAgICByZXF1ZXN0T3B0aW9ucy5oZWFkZXJzWydTZWMtV2ViU29ja2V0LVByb3RvY29sJ10gPSBvcHRpb25zLnByb3RvY29sOwogIH0KICBpZiAob3B0aW9ucy5vcmlnaW4pIHsKICAgIGlmIChvcHRpb25zLnByb3RvY29sVmVyc2lvbiA8IDEzKSB7CiAgICAgIHJlcXVlc3RPcHRpb25zLmhlYWRlcnNbJ1NlYy1XZWJTb2NrZXQtT3JpZ2luJ10gPSBvcHRpb25zLm9yaWdpbjsKICAgIH0gZWxzZSB7CiAgICAgIHJlcXVlc3RPcHRpb25zLmhlYWRlcnMuT3JpZ2luID0gb3B0aW9ucy5vcmlnaW47CiAgICB9CiAgfQogIGlmIChvcHRpb25zLmhvc3QpIHJlcXVlc3RPcHRpb25zLmhlYWRlcnMuSG9zdCA9IG9wdGlvbnMuaG9zdDsKICBpZiAoc2VydmVyVXJsLmF1dGgpIHJlcXVlc3RPcHRpb25zLmF1dGggPSBzZXJ2ZXJVcmwuYXV0aDsKCiAgaWYgKG9wdGlvbnMubG9jYWxBZGRyZXNzKSByZXF1ZXN0T3B0aW9ucy5sb2NhbEFkZHJlc3MgPSBvcHRpb25zLmxvY2FsQWRkcmVzczsKICBpZiAob3B0aW9ucy5mYW1pbHkpIHJlcXVlc3RPcHRpb25zLmZhbWlseSA9IG9wdGlvbnMuZmFtaWx5OwoKICBpZiAoaXNVbml4U29ja2V0KSB7CiAgICBjb25zdCBwYXJ0cyA9IHNlcnZlclVybC5wYXRoLnNwbGl0KCc6Jyk7CgogICAgcmVxdWVzdE9wdGlvbnMuc29ja2V0UGF0aCA9IHBhcnRzWzBdOwogICAgcmVxdWVzdE9wdGlvbnMucGF0aCA9IHBhcnRzWzFdOwogIH0gZWxzZSBpZiAoc2VydmVyVXJsLnBhdGgpIHsKICAgIC8vCiAgICAvLyBNYWtlIHN1cmUgdGhhdCBwYXRoIHN0YXJ0cyB3aXRoIGAvYC4KICAgIC8vCiAgICBpZiAoc2VydmVyVXJsLnBhdGguY2hhckF0KDApICE9PSAnLycpIHsKICAgICAgcmVxdWVzdE9wdGlvbnMucGF0aCA9IGAvJHtzZXJ2ZXJVcmwucGF0aH1gOwogICAgfSBlbHNlIHsKICAgICAgcmVxdWVzdE9wdGlvbnMucGF0aCA9IHNlcnZlclVybC5wYXRoOwogICAgfQogIH0KCiAgdmFyIGFnZW50ID0gb3B0aW9ucy5hZ2VudDsKCiAgLy8KICAvLyBBIGN1c3RvbSBhZ2VudCBpcyByZXF1aXJlZCBmb3IgdGhlc2Ugb3B0aW9ucy4KICAvLwogIGlmICgKICAgIG9wdGlvbnMucmVqZWN0VW5hdXRob3JpemVkICE9IG51bGwgfHwKICAgIG9wdGlvbnMuY2hlY2tTZXJ2ZXJJZGVudGl0eSB8fAogICAgb3B0aW9ucy5wYXNzcGhyYXNlIHx8CiAgICBvcHRpb25zLmNpcGhlcnMgfHwKICAgIG9wdGlvbnMuY2VydCB8fAogICAgb3B0aW9ucy5rZXkgfHwKICAgIG9wdGlvbnMucGZ4IHx8CiAgICBvcHRpb25zLmNhCiAgKSB7CiAgICBpZiAob3B0aW9ucy5wYXNzcGhyYXNlKSByZXF1ZXN0T3B0aW9ucy5wYXNzcGhyYXNlID0gb3B0aW9ucy5wYXNzcGhyYXNlOwogICAgaWYgKG9wdGlvbnMuY2lwaGVycykgcmVxdWVzdE9wdGlvbnMuY2lwaGVycyA9IG9wdGlvbnMuY2lwaGVyczsKICAgIGlmIChvcHRpb25zLmNlcnQpIHJlcXVlc3RPcHRpb25zLmNlcnQgPSBvcHRpb25zLmNlcnQ7CiAgICBpZiAob3B0aW9ucy5rZXkpIHJlcXVlc3RPcHRpb25zLmtleSA9IG9wdGlvbnMua2V5OwogICAgaWYgKG9wdGlvbnMucGZ4KSByZXF1ZXN0T3B0aW9ucy5wZnggPSBvcHRpb25zLnBmeDsKICAgIGlmIChvcHRpb25zLmNhKSByZXF1ZXN0T3B0aW9ucy5jYSA9IG9wdGlvbnMuY2E7CiAgICBpZiAob3B0aW9ucy5jaGVja1NlcnZlcklkZW50aXR5KSB7CiAgICAgIHJlcXVlc3RPcHRpb25zLmNoZWNrU2VydmVySWRlbnRpdHkgPSBvcHRpb25zLmNoZWNrU2VydmVySWRlbnRpdHk7CiAgICB9CiAgICBpZiAob3B0aW9ucy5yZWplY3RVbmF1dGhvcml6ZWQgIT0gbnVsbCkgewogICAgICByZXF1ZXN0T3B0aW9ucy5yZWplY3RVbmF1dGhvcml6ZWQgPSBvcHRpb25zLnJlamVjdFVuYXV0aG9yaXplZDsKICAgIH0KCiAgICBpZiAoIWFnZW50KSBhZ2VudCA9IG5ldyBodHRwT2JqLkFnZW50KHJlcXVlc3RPcHRpb25zKTsKICB9CgogIGlmIChhZ2VudCkgcmVxdWVzdE9wdGlvbnMuYWdlbnQgPSBhZ2VudDsKCiAgdGhpcy5fcmVxID0gaHR0cE9iai5nZXQocmVxdWVzdE9wdGlvbnMpOwoKICB0aGlzLl9yZXEub24oJ2Vycm9yJywgKGVycm9yKSA9PiB7CiAgICBpZiAodGhpcy5fcmVxLmFib3J0ZWQpIHJldHVybjsKCiAgICB0aGlzLl9yZXEgPSBudWxsOwogICAgdGhpcy5lbWl0KCdlcnJvcicsIGVycm9yKTsKICAgIHRoaXMuZmluYWxpemUodHJ1ZSk7CiAgfSk7CgogIHRoaXMuX3JlcS5vbigncmVzcG9uc2UnLCAocmVzKSA9PiB7CiAgICBpZiAoIXRoaXMuZW1pdCgndW5leHBlY3RlZC1yZXNwb25zZScsIHRoaXMuX3JlcSwgcmVzKSkgewogICAgICB0aGlzLl9yZXEuYWJvcnQoKTsKICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcihgdW5leHBlY3RlZCBzZXJ2ZXIgcmVzcG9uc2UgKCR7cmVzLnN0YXR1c0NvZGV9KWApKTsKICAgICAgdGhpcy5maW5hbGl6ZSh0cnVlKTsKICAgIH0KICB9KTsKCiAgdGhpcy5fcmVxLm9uKCd1cGdyYWRlJywgKHJlcywgc29ja2V0LCBoZWFkKSA9PiB7CiAgICB0aGlzLl9yZXEgPSBudWxsOwoKICAgIGNvbnN0IGRpZ2VzdCA9IGNyeXB0by5jcmVhdGVIYXNoKCdzaGExJykKICAgICAgLnVwZGF0ZShrZXkgKyBjb25zdGFudHMuR1VJRCwgJ2JpbmFyeScpCiAgICAgIC5kaWdlc3QoJ2Jhc2U2NCcpOwoKICAgIGlmIChyZXMuaGVhZGVyc1snc2VjLXdlYnNvY2tldC1hY2NlcHQnXSAhPT0gZGlnZXN0KSB7CiAgICAgIHNvY2tldC5kZXN0cm95KCk7CiAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ2ludmFsaWQgc2VydmVyIGtleScpKTsKICAgICAgcmV0dXJuIHRoaXMuZmluYWxpemUodHJ1ZSk7CiAgICB9CgogICAgY29uc3Qgc2VydmVyUHJvdCA9IHJlcy5oZWFkZXJzWydzZWMtd2Vic29ja2V0LXByb3RvY29sJ107CiAgICBjb25zdCBwcm90TGlzdCA9IChvcHRpb25zLnByb3RvY29sIHx8ICcnKS5zcGxpdCgvLCAqLyk7CiAgICB2YXIgcHJvdEVycm9yOwoKICAgIGlmICghb3B0aW9ucy5wcm90b2NvbCAmJiBzZXJ2ZXJQcm90KSB7CiAgICAgIHByb3RFcnJvciA9ICdzZXJ2ZXIgc2VudCBhIHN1YnByb3RvY29sIGV2ZW4gdGhvdWdoIG5vbmUgcmVxdWVzdGVkJzsKICAgIH0gZWxzZSBpZiAob3B0aW9ucy5wcm90b2NvbCAmJiAhc2VydmVyUHJvdCkgewogICAgICBwcm90RXJyb3IgPSAnc2VydmVyIHNlbnQgbm8gc3VicHJvdG9jb2wgZXZlbiB0aG91Z2ggcmVxdWVzdGVkJzsKICAgIH0gZWxzZSBpZiAoc2VydmVyUHJvdCAmJiBwcm90TGlzdC5pbmRleE9mKHNlcnZlclByb3QpID09PSAtMSkgewogICAgICBwcm90RXJyb3IgPSAnc2VydmVyIHJlc3BvbmRlZCB3aXRoIGFuIGludmFsaWQgcHJvdG9jb2wnOwogICAgfQoKICAgIGlmIChwcm90RXJyb3IpIHsKICAgICAgc29ja2V0LmRlc3Ryb3koKTsKICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcihwcm90RXJyb3IpKTsKICAgICAgcmV0dXJuIHRoaXMuZmluYWxpemUodHJ1ZSk7CiAgICB9CgogICAgaWYgKHNlcnZlclByb3QpIHRoaXMucHJvdG9jb2wgPSBzZXJ2ZXJQcm90OwoKICAgIGNvbnN0IHNlcnZlckV4dGVuc2lvbnMgPSBFeHRlbnNpb25zLnBhcnNlKHJlcy5oZWFkZXJzWydzZWMtd2Vic29ja2V0LWV4dGVuc2lvbnMnXSk7CgogICAgaWYgKHBlck1lc3NhZ2VEZWZsYXRlICYmIHNlcnZlckV4dGVuc2lvbnNbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0pIHsKICAgICAgdHJ5IHsKICAgICAgICBwZXJNZXNzYWdlRGVmbGF0ZS5hY2NlcHQoc2VydmVyRXh0ZW5zaW9uc1tQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXSk7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHNvY2tldC5kZXN0cm95KCk7CiAgICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignaW52YWxpZCBleHRlbnNpb24gcGFyYW1ldGVyJykpOwogICAgICAgIHJldHVybiB0aGlzLmZpbmFsaXplKHRydWUpOwogICAgICB9CgogICAgICB0aGlzLmV4dGVuc2lvbnNbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0gPSBwZXJNZXNzYWdlRGVmbGF0ZTsKICAgIH0KCiAgICB0aGlzLnNldFNvY2tldChzb2NrZXQsIGhlYWQpOwogIH0pOwp9CgoKLyoqKi8gfSksCi8qIDE5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgiZXZlbnRzIik7CgovKioqLyB9KSwKLyogMjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCJodHRwIik7CgovKioqLyB9KSwKLyogMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCJ1cmwiKTsKCi8qKiovIH0pLAovKiAyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDIzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn07CgovKioqLyB9KSwKLyogMjQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX2RlZmluZVByb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNyk7Cgp2YXIgX2RlZmluZVByb3BlcnR5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlZmluZVByb3BlcnR5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgICBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsKICAgICAgKDAsIF9kZWZpbmVQcm9wZXJ0eTIuZGVmYXVsdCkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgICB9CiAgfQoKICByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKICAgIGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogICAgcmV0dXJuIENvbnN0cnVjdG9yOwogIH07Cn0oKTsKCi8qKiovIH0pLAovKiAyNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Ci8qIQogKiB3czogYSBub2RlLmpzIHdlYnNvY2tldCBjbGllbnQKICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+CiAqIE1JVCBMaWNlbnNlZAogKi8KCgoKY29uc3QgV2ViU29ja2V0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7CgpXZWJTb2NrZXQuU2VydmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nik7CldlYlNvY2tldC5SZWNlaXZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpOwpXZWJTb2NrZXQuU2VuZGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7Cgptb2R1bGUuZXhwb3J0cyA9IFdlYlNvY2tldDsKCgovKioqLyB9KSwKLyogMjYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfc3RyaW5naWZ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMik7Cgp2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgpleHBvcnRzLmRlZmF1bHQgPSBhY3RpdmF0ZTsKCnZhciBfd3MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KTsKCnZhciBfd3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfd3MpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBWZXJ0eFByb3RvU3R1YiA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgICBfY29udGludW91c09wZW46IGJvb2xlYW4KICAgICBfcnVudGltZVByb3RvU3R1YlVSTDogc3RyaW5nCiAgICBfYnVzOiBNaW5pQnVzCiAgICBfbXNnQ2FsbGJhY2s6IChNZXNzYWdlKSA9PiB2b2lkCiAgICBfY29uZmlnOiB7IHVybCwgcnVudGltZVVSTCB9CiAgICAgX3NvY2s6IChXZWJTb2NrZXQgfCBTb2NrSlMpCiAgICBfcmVPcGVuOiBib29sZWFuCiAgKi8KCiAgLyoqCiAgICogVmVydHggUHJvdG9TdHViIGNyZWF0aW9uCiAgICogQHBhcmFtICB7c3RyaW5nfSBydW50aW1lUHJvdG9TdHViVVJMIC0gVVJMIHVzZWQgaW50ZXJuYWxseSBmb3IgbWVzc2FnZSBkZWxpdmVyeSBwb2ludC4gTm90IHVzZWQgZm9yIE1lc3NhZ2VOb2RlIGRlbGl2ZXIuCiAgICogQHBhcmFtICB7TWluaUJ1c30gYnVzIC0gTWluaUJ1cyB1c2VkIHRvIHNlbmQvcmVjZWl2ZSBtZXNzYWdlcy4gTm9ybWFsbHkgY29ubmVjdGVkIHRvIHRoZSBNZXNzYWdlQnVzLgogICAqIEBwYXJhbSAge09iamVjdH0gY29uZmlnIC0gTWFuZGF0b3J5IGZpZWxkcyBhcmU6ICJ1cmwiIG9mIHRoZSBNZXNzYWdlTm9kZSBhZGRyZXNzIGFuZCAicnVudGltZVVSTCIuCiAgICogQHJldHVybiB7VmVydHhQcm90b1N0dWJ9CiAgICovCiAgZnVuY3Rpb24gVmVydHhQcm90b1N0dWIocnVudGltZVByb3RvU3R1YlVSTCwgYnVzLCBjb25maWcpIHsKICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFZlcnR4UHJvdG9TdHViKTsKCiAgICBpZiAoIXJ1bnRpbWVQcm90b1N0dWJVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIHJ1bnRpbWVQcm90b1N0dWJVUkwgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFjb25maWcpIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZyBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCiAgICBpZiAoIWNvbmZpZy51cmwpIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZy51cmwgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWNvbmZpZy5ydW50aW1lVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWcucnVudGltZVVSTCBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHRoaXMuX2lkID0gMDsKICAgIHRoaXMuX2NvbnRpbnVvdXNPcGVuID0gdHJ1ZTsKCiAgICB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMID0gcnVudGltZVByb3RvU3R1YlVSTDsKICAgIHRoaXMuX2J1cyA9IGJ1czsKICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZzsKCiAgICB0aGlzLl9ydW50aW1lU2Vzc2lvblVSTCA9IGNvbmZpZy5ydW50aW1lVVJMOwogICAgdGhpcy5fcmVPcGVuID0gZmFsc2U7CgogICAgYnVzLmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24gKG1zZykgewogICAgICBjb25zb2xlLmxvZygnW1ZlcnR4UHJvdG9TdHViXSBvdXRnb2luZyBtZXNzYWdlOiAnLCBtc2cpOwogICAgICBfdGhpcy5fb3BlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKF90aGlzLl9maWx0ZXIobXNnKSkgewogICAgICAgICAgbXNnLmJvZHkudmlhID0gX3RoaXMyLl9ydW50aW1lUHJvdG9TdHViVVJMOwogICAgICAgICAgY29uc29sZS5sb2coJ1tWZXJ0eFByb3RvU3R1YjogUHJvdG9TdHViIC0+IE1OXScsIG1zZyk7CiAgICAgICAgICBfdGhpcy5fc29jay5zZW5kKCgwLCBfc3RyaW5naWZ5Mi5kZWZhdWx0KShtc2cpKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CgogICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2NyZWF0ZWQnKTsKICB9CgogIC8qKgogICAqIEdldCB0aGUgY29uZmlndXJhdGlvbiBmb3IgdGhpcyBQcm90b1N0dWIKICAgKiBAcmV0dXJuIHtPYmplY3R9IC0gTWFuZGF0b3J5IGZpZWxkcyBhcmU6ICJ1cmwiIG9mIHRoZSBNZXNzYWdlTm9kZSBhZGRyZXNzIGFuZCAicnVudGltZVVSTCIuCiAgICovCgoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShWZXJ0eFByb3RvU3R1YiwgW3sKICAgIGtleTogJ2Nvbm5lY3QnLAoKCiAgICAvKioKICAgICAqIFRyeSB0byBvcGVuIHRoZSBjb25uZWN0aW9uIHRvIHRoZSBNZXNzYWdlTm9kZS4gQ29ubmVjdGlvbiBpcyBhdXRvIG1hbmFnZWQsIHRoZXJlIGlzIG5vIG5lZWQgdG8gY2FsbCB0aGlzIGV4cGxpY2l0bHkuCiAgICAgKiBIb3dldmVyLCBpZiAiZGlzY29ubmVjdCgpIiBpcyBjYWxsZWQsIGl0J3MgbmVjZXNzYXJ5IHRvIGNhbGwgdGhpcyB0byBlbmFibGUgY29ubmVjdGlvbnMgYWdhaW4uCiAgICAgKiBBIHN0YXR1cyBtZXNzYWdlIGlzIHNlbnQgdG8gInJ1bnRpbWVQcm90b1N0dWJVUkwvc3RhdHVzIiwgY29udGFpbmluZyB0aGUgdmFsdWUgImNvbm5lY3RlZCIgaWYgc3VjY2Vzc2Z1bCwgb3IgImRpc2Nvbm5lY3RlZCIgaWYgc29tZSBlcnJvciBvY2N1cnMuCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBjb25uZWN0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2NvbnRpbnVvdXNPcGVuID0gdHJ1ZTsKICAgICAgX3RoaXMuX29wZW4oZnVuY3Rpb24gKCkge30pOwogICAgfQoKICAgIC8qKgogICAgICogSXQgd2lsbCBkaXNjb25uZWN0IGFuZCBvcmRlciB0byBzdGF5IGRpc2Nvbm5lY3RlZC4gUmVjb25uZWN0aW9uIHRyaWVzLCB3aWxsIG5vdCBiZSBhdHRlbXB0ZWQsIHVubGVzcyAiY29ubmVjdCgpIiBpcyBjYWxsZWQuCiAgICAgKiBBIHN0YXR1cyBtZXNzYWdlIGlzIHNlbnQgdG8gInJ1bnRpbWVQcm90b1N0dWJVUkwvc3RhdHVzIiB3aXRoIHZhbHVlICJkaXNjb25uZWN0ZWQiLgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2Rpc2Nvbm5lY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2Nvbm5lY3QoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fc2VuZFN0YXR1cygnZGlzY29ubmVjdGVkJyk7CgogICAgICBfdGhpcy5fY29udGludW91c09wZW4gPSBmYWxzZTsKICAgICAgaWYgKF90aGlzLl9zb2NrKSB7CiAgICAgICAgX3RoaXMuX3NlbmRDbG9zZSgpOwogICAgICB9CiAgICB9CgogICAgLy90b2RvOiBhZGQgZG9jdW1lbnRhdGlvbgoKICB9LCB7CiAgICBrZXk6ICdfc2VuZE9wZW4nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kT3BlbihjYWxsYmFjaykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdGhpcy5fc2VuZFN0YXR1cygnaW4tcHJvZ3Jlc3MnKTsKCiAgICAgIF90aGlzLl9pZCsrOwogICAgICB2YXIgbXNnID0gewogICAgICAgIGlkOiBfdGhpcy5faWQsIHR5cGU6ICdvcGVuJywgZnJvbTogX3RoaXMuX3J1bnRpbWVTZXNzaW9uVVJMLCB0bzogJ21uOi9zZXNzaW9uJwogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9yZU9wZW4pIHsKICAgICAgICBtc2cudHlwZSA9ICdyZS1vcGVuJzsKICAgICAgfQoKICAgICAgLy9yZWdpc3RlciBhbmQgd2FpdCBmb3Igb3BlbiByZXBseS4uLgogICAgICB2YXIgaGFzUmVzcG9uc2UgPSBmYWxzZTsKICAgICAgX3RoaXMuX3Nlc3Npb25DYWxsYmFjayA9IGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgIGlmIChyZXBseS50eXBlID09PSAncmVzcG9uc2UnICYgcmVwbHkuaWQgPT09IG1zZy5pZCkgewogICAgICAgICAgaGFzUmVzcG9uc2UgPSB0cnVlOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIGlmIChyZXBseS5ib2R5LnJ1bnRpbWVUb2tlbikgewogICAgICAgICAgICAgIC8vc2V0dXAgcnVudGltZVNlc3Npb24KICAgICAgICAgICAgICBfdGhpcy5fcmVPcGVuID0gdHJ1ZTsKICAgICAgICAgICAgICBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwgPSBfdGhpcy5fY29uZmlnLnJ1bnRpbWVVUkwgKyAnLycgKyByZXBseS5ib2R5LnJ1bnRpbWVUb2tlbjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2xpdmUnKTsKICAgICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzLl9zZW5kU3RhdHVzKCdmYWlsZWQnLCByZXBseS5ib2R5LmRlc2MpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9zb2NrLnNlbmQoKDAsIF9zdHJpbmdpZnkyLmRlZmF1bHQpKG1zZykpOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWhhc1Jlc3BvbnNlKSB7CiAgICAgICAgICAvL25vIHJlc3BvbnNlIGFmdGVyIHggc2Vjb25kcy4uLgogICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2Rpc2Nvbm5lY3RlZCcsICdUaW1lb3V0IGZyb20gbW46L3Nlc3Npb24nKTsKICAgICAgICB9CiAgICAgIH0sIDMwMDApOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZW5kQ2xvc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kQ2xvc2UoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5faWQrKzsKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICBpZDogX3RoaXMuX2lkLCB0eXBlOiAnY2xvc2UnLCBmcm9tOiBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwsIHRvOiAnbW46L3Nlc3Npb24nCiAgICAgIH07CgogICAgICAvL2ludmFsaWRhdGUgcnVudGltZVNlc3Npb24KICAgICAgX3RoaXMuX3JlT3BlbiA9IGZhbHNlOwogICAgICBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwgPSBfdGhpcy5fY29uZmlnLl9ydW50aW1lVVJMOwoKICAgICAgX3RoaXMuX3NvY2suc2VuZCgoMCwgX3N0cmluZ2lmeTIuZGVmYXVsdCkobXNnKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX3NlbmRTdGF0dXMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kU3RhdHVzKHZhbHVlLCByZWFzb24pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGNvbnNvbGUubG9nKCdbVmVydHhQcm90b3N0dWIgc3RhdHVzIGNoYW5nZWRdIHRvICcsIHZhbHVlKTsKCiAgICAgIF90aGlzLl9zdGF0ZSA9IHZhbHVlOwoKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICB0eXBlOiAndXBkYXRlJywKICAgICAgICBmcm9tOiBfdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCwKICAgICAgICB0bzogX3RoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgKyAnL3N0YXR1cycsCiAgICAgICAgYm9keTogewogICAgICAgICAgdmFsdWU6IHZhbHVlCiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKHJlYXNvbikgewogICAgICAgIG1zZy5ib2R5LmRlc2MgPSByZWFzb247CiAgICAgIH0KCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfd2FpdFJlYWR5JywKICAgIHZhbHVlOiBmdW5jdGlvbiBfd2FpdFJlYWR5KGNhbGxiYWNrKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoX3RoaXMuX3NvY2sucmVhZHlTdGF0ZSA9PT0gMSkgewogICAgICAgIGNhbGxiYWNrKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5fd2FpdFJlYWR5KGNhbGxiYWNrKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19maWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maWx0ZXIobXNnKSB7CiAgICAgIGlmIChtc2cuYm9keSAmJiBtc2cuYm9keS52aWEgPT09IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwpIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2RlbGl2ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxpdmVyKG1zZykgewogICAgICBpZiAoIW1zZy5ib2R5KSBtc2cuYm9keSA9IHt9OwoKICAgICAgbXNnLmJvZHkudmlhID0gdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTDsKICAgICAgY29uc29sZS5sb2coJ1tWZXJ0eFByb3RvU3R1YjogTU4gLT4gUHJvdG9TdHViXScsIG1zZyk7CiAgICAgIHRoaXMuX2J1cy5wb3N0TWVzc2FnZShtc2cpOwogICAgfQoKICAgIC8vIGFkZCBkb2N1bWVudGF0aW9uCgogIH0sIHsKICAgIGtleTogJ19vcGVuJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb3BlbihjYWxsYmFjaykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLl9jb250aW51b3VzT3BlbikgewogICAgICAgIC8vVE9ETzogc2VuZCBzdGF0dXMgKHNlbnQgbWVzc2FnZSBlcnJvciAtIGRpc2Nvbm5lY3RlZCkKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghX3RoaXMuX3NvY2spIHsKICAgICAgICBpZiAoX3RoaXMuX2NvbmZpZy51cmwuc3Vic3RyaW5nKDAsIDIpID09PSAnd3MnKSB7CiAgICAgICAgICBfdGhpcy5fc29jayA9IG5ldyBfd3MyLmRlZmF1bHQoX3RoaXMuX2NvbmZpZy51cmwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpcy5fc29jayA9IG5ldyBTb2NrSlMoX3RoaXMuX2NvbmZpZy51cmwpOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMuX3NvY2sub25vcGVuID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMuX3NlbmRPcGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICAgIH0pOwogICAgICAgIH07CgogICAgICAgIF90aGlzLl9zb2NrLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICB2YXIgbXNnID0gSlNPTi5wYXJzZShlLmRhdGEpOwogICAgICAgICAgY29uc29sZS5sb2coJ1tWZXJ0eFByb3RvU3R1YjogTU4gLT4gU09DS0VUIE9OIE1FU1NBR0VdJywgbXNnKTsKICAgICAgICAgIGlmIChtc2cuZnJvbSA9PT0gJ21uOi9zZXNzaW9uJykgewogICAgICAgICAgICBpZiAoX3RoaXMuX3Nlc3Npb25DYWxsYmFjaykgewogICAgICAgICAgICAgIF90aGlzLl9zZXNzaW9uQ2FsbGJhY2sobXNnKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKF90aGlzLl9maWx0ZXIobXNnKSkgewogICAgICAgICAgICAgIF90aGlzLl9kZWxpdmVyKG1zZyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBfdGhpcy5fc29jay5vbmNsb3NlID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICB2YXIgcmVhc29uID0gdm9pZCAwOwoKICAgICAgICAgIC8vU2VlIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM2NDU1I3NlY3Rpb24tNy40CiAgICAgICAgICBpZiAoZXZlbnQuY29kZSA9PT0gMTAwMCkgewogICAgICAgICAgICByZWFzb24gPSAnTm9ybWFsIGNsb3N1cmUsIG1lYW5pbmcgdGhhdCB0aGUgcHVycG9zZSBmb3Igd2hpY2ggdGhlIGNvbm5lY3Rpb24gd2FzIGVzdGFibGlzaGVkIGhhcyBiZWVuIGZ1bGZpbGxlZC4nOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDAxKSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyBcJ2dvaW5nIGF3YXlcJywgc3VjaCBhcyBhIHNlcnZlciBnb2luZyBkb3duIG9yIGEgYnJvd3NlciBoYXZpbmcgbmF2aWdhdGVkIGF3YXkgZnJvbSBhIHBhZ2UuJzsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwMikgewogICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gZHVlIHRvIGEgcHJvdG9jb2wgZXJyb3InOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDAzKSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGhhcyByZWNlaXZlZCBhIHR5cGUgb2YgZGF0YSBpdCBjYW5ub3QgYWNjZXB0IChlLmcuLCBhbiBlbmRwb2ludCB0aGF0IHVuZGVyc3RhbmRzIG9ubHkgdGV4dCBkYXRhIE1BWSBzZW5kIHRoaXMgaWYgaXQgcmVjZWl2ZXMgYSBiaW5hcnkgbWVzc2FnZSkuJzsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwNCkgewogICAgICAgICAgICByZWFzb24gPSAnUmVzZXJ2ZWQuIFRoZSBzcGVjaWZpYyBtZWFuaW5nIG1pZ2h0IGJlIGRlZmluZWQgaW4gdGhlIGZ1dHVyZS4nOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA1KSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdObyBzdGF0dXMgY29kZSB3YXMgYWN0dWFsbHkgcHJlc2VudC4nOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA2KSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdUaGUgY29ubmVjdGlvbiB3YXMgY2xvc2VkIGFibm9ybWFsbHksIGUuZy4sIHdpdGhvdXQgc2VuZGluZyBvciByZWNlaXZpbmcgYSBDbG9zZSBjb250cm9sIGZyYW1lJzsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwNykgewogICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBoYXMgcmVjZWl2ZWQgZGF0YSB3aXRoaW4gYSBtZXNzYWdlIHRoYXQgd2FzIG5vdCBjb25zaXN0ZW50IHdpdGggdGhlIHR5cGUgb2YgdGhlIG1lc3NhZ2UgKGUuZy4sIG5vbi1VVEYtOCBbaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzYyOV0gZGF0YSB3aXRoaW4gYSB0ZXh0IG1lc3NhZ2UpLic7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDgpIHsKICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgaGFzIHJlY2VpdmVkIGEgbWVzc2FnZSB0aGF0ICJ2aW9sYXRlcyBpdHMgcG9saWN5Ii4gVGhpcyByZWFzb24gaXMgZ2l2ZW4gZWl0aGVyIGlmIHRoZXJlIGlzIG5vIG90aGVyIHN1dGlibGUgcmVhc29uLCBvciBpZiB0aGVyZSBpcyBhIG5lZWQgdG8gaGlkZSBzcGVjaWZpYyBkZXRhaWxzIGFib3V0IHRoZSBwb2xpY3kuJzsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwOSkgewogICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBoYXMgcmVjZWl2ZWQgYSBtZXNzYWdlIHRoYXQgaXMgdG9vIGJpZyBmb3IgaXQgdG8gcHJvY2Vzcy4nOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDEwKSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCAoY2xpZW50KSBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGhhcyBleHBlY3RlZCB0aGUgc2VydmVyIHRvIG5lZ290aWF0ZSBvbmUgb3IgbW9yZSBleHRlbnNpb24sIGJ1dCB0aGUgc2VydmVyIGRpZG5cJ3QgcmV0dXJuIHRoZW0gaW4gdGhlIHJlc3BvbnNlIG1lc3NhZ2Ugb2YgdGhlIFdlYlNvY2tldCBoYW5kc2hha2UuIDxiciAvPiBTcGVjaWZpY2FsbHksIHRoZSBleHRlbnNpb25zIHRoYXQgYXJlIG5lZWRlZCBhcmU6ICcgKyBldmVudC5yZWFzb247CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMTEpIHsKICAgICAgICAgICAgcmVhc29uID0gJ0Egc2VydmVyIGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgZW5jb3VudGVyZWQgYW4gdW5leHBlY3RlZCBjb25kaXRpb24gdGhhdCBwcmV2ZW50ZWQgaXQgZnJvbSBmdWxmaWxsaW5nIHRoZSByZXF1ZXN0Lic7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMTUpIHsKICAgICAgICAgICAgcmVhc29uID0gJ1RoZSBjb25uZWN0aW9uIHdhcyBjbG9zZWQgZHVlIHRvIGEgZmFpbHVyZSB0byBwZXJmb3JtIGEgVExTIGhhbmRzaGFrZSAoZS5nLiwgdGhlIHNlcnZlciBjZXJ0aWZpY2F0ZSBjYW5cJ3QgYmUgdmVyaWZpZWQpLic7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWFzb24gPSAnVW5rbm93biByZWFzb24nOwogICAgICAgICAgfQoKICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fc29jazsKICAgICAgICAgIF90aGlzLl9zZW5kU3RhdHVzKCdkaXNjb25uZWN0ZWQnLCByZWFzb24pOwogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMuX3dhaXRSZWFkeShjYWxsYmFjayk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdjb25maWcnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jb25maWc7CiAgICB9CiAgfSwgewogICAga2V5OiAncnVudGltZVNlc3Npb24nLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9ydW50aW1lU2Vzc2lvblVSTDsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFZlcnR4UHJvdG9TdHViOwp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZnVuY3Rpb24gYWN0aXZhdGUodXJsLCBidXMsIGNvbmZpZykgewogIHJldHVybiB7CiAgICBuYW1lOiAnVmVydHhQcm90b1N0dWInLAogICAgaW5zdGFuY2U6IG5ldyBWZXJ0eFByb3RvU3R1Yih1cmwsIGJ1cywgY29uZmlnKQogIH07Cn0KCi8qKgoqIENhbGxiYWNrIHVzZWQgdG8gc2VuZCBtZXNzYWdlcwoqIEBjYWxsYmFjayBQb3N0TWVzc2FnZQoqIEBwYXJhbSB7TWVzc2FnZX0gbXNnIC0gTWVzc2FnZSB0byBzZW5kCiovCgptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAyNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDI4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKLyohCiAqIGJ1ZmZlcnV0aWw6IFdlYlNvY2tldCBidWZmZXIgdXRpbHMKICogQ29weXJpZ2h0KGMpIDIwMTUgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+CiAqIE1JVCBMaWNlbnNlZAogKi8KCgoKLyoqCiAqIE1hc2tzIGEgYnVmZmVyIHVzaW5nIHRoZSBnaXZlbiBtYXNrLgogKgogKiBAcGFyYW0ge0J1ZmZlcn0gc291cmNlIFRoZSBidWZmZXIgdG8gbWFzawogKiBAcGFyYW0ge0J1ZmZlcn0gbWFzayBUaGUgbWFzayB0byB1c2UKICogQHBhcmFtIHtCdWZmZXJ9IG91dHB1dCBUaGUgYnVmZmVyIHdoZXJlIHRvIHN0b3JlIHRoZSByZXN1bHQKICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldCBUaGUgb2Zmc2V0IGF0IHdoaWNoIHRvIHN0YXJ0IHdyaXRpbmcKICogQHBhcmFtIHtOdW1iZXJ9IGxlbmd0aCBUaGUgbnVtYmVyIG9mIGJ5dGVzIHRvIG1hc2suCiAqIEBwdWJsaWMKICovCmNvbnN0IG1hc2sgPSAoc291cmNlLCBtYXNrLCBvdXRwdXQsIG9mZnNldCwgbGVuZ3RoKSA9PiB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgb3V0cHV0W29mZnNldCArIGldID0gc291cmNlW2ldIF4gbWFza1tpICYgM107CiAgfQp9OwoKLyoqCiAqIFVubWFza3MgYSBidWZmZXIgdXNpbmcgdGhlIGdpdmVuIG1hc2suCiAqCiAqIEBwYXJhbSB7QnVmZmVyfSBidWZmZXIgVGhlIGJ1ZmZlciB0byB1bm1hc2sKICogQHBhcmFtIHtCdWZmZXJ9IG1hc2sgVGhlIG1hc2sgdG8gdXNlCiAqIEBwdWJsaWMKICovCmNvbnN0IHVubWFzayA9IChidWZmZXIsIG1hc2spID0+IHsKICAvLyBSZXF1aXJlZCB1bnRpbCBodHRwczovL2dpdGh1Yi5jb20vbm9kZWpzL25vZGUvaXNzdWVzLzkwMDYgaXMgcmVzb2x2ZWQuCiAgY29uc3QgbGVuZ3RoID0gYnVmZmVyLmxlbmd0aDsKICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICBidWZmZXJbaV0gXj0gbWFza1tpICYgM107CiAgfQp9OwoKbW9kdWxlLmV4cG9ydHMgPSB7IG1hc2ssIHVubWFzayB9OwoKCi8qKiovIH0pLAovKiAyOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKdHJ5IHsKICBtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oOSkoJ2J1ZmZlcnV0aWwnKTsKfSBjYXRjaCAoZSkgewogIG1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCk7Cn0KCgovKioqLyB9KSwKLyogMzAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGNvcmUgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKQogICwgJEpTT04gPSBjb3JlLkpTT04gfHwgKGNvcmUuSlNPTiA9IHtzdHJpbmdpZnk6IEpTT04uc3RyaW5naWZ5fSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycwogIHJldHVybiAkSlNPTi5zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3VtZW50cyk7Cn07CgovKioqLyB9KSwKLyogMzEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg0MSk7CnZhciAkT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKS5PYmplY3Q7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyl7CiAgcmV0dXJuICRPYmplY3QuZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyk7Cn07CgovKioqLyB9KSwKLyogMzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYoIWlzT2JqZWN0KGl0KSl0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhbiBvYmplY3QhJyk7CiAgcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDM0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZwp2YXIgYUZ1bmN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMik7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIHRoYXQsIGxlbmd0aCl7CiAgYUZ1bmN0aW9uKGZuKTsKICBpZih0aGF0ID09PSB1bmRlZmluZWQpcmV0dXJuIGZuOwogIHN3aXRjaChsZW5ndGgpewogICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpOwogICAgfTsKICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTsKICAgIH07CiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7CiAgICB9OwogIH0KICByZXR1cm4gZnVuY3Rpb24oLyogLi4uYXJncyAqLyl7CiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDM1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKICAsIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSkuZG9jdW1lbnQKICAvLyBpbiBvbGQgSUUgdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgaXMgJ29iamVjdCcKICAsIGlzID0gaXNPYmplY3QoZG9jdW1lbnQpICYmIGlzT2JqZWN0KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXMgPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGl0KSA6IHt9Owp9OwoKLyoqKi8gfSksCi8qIDM2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKQogICwgY29yZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKQogICwgY3R4ICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNCkKICAsIGhpZGUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzcpCiAgLCBQUk9UT1RZUEUgPSAncHJvdG90eXBlJzsKCnZhciAkZXhwb3J0ID0gZnVuY3Rpb24odHlwZSwgbmFtZSwgc291cmNlKXsKICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRgogICAgLCBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HCiAgICAsIElTX1NUQVRJQyA9IHR5cGUgJiAkZXhwb3J0LlMKICAgICwgSVNfUFJPVE8gID0gdHlwZSAmICRleHBvcnQuUAogICAgLCBJU19CSU5EICAgPSB0eXBlICYgJGV4cG9ydC5CCiAgICAsIElTX1dSQVAgICA9IHR5cGUgJiAkZXhwb3J0LlcKICAgICwgZXhwb3J0cyAgID0gSVNfR0xPQkFMID8gY29yZSA6IGNvcmVbbmFtZV0gfHwgKGNvcmVbbmFtZV0gPSB7fSkKICAgICwgZXhwUHJvdG8gID0gZXhwb3J0c1tQUk9UT1RZUEVdCiAgICAsIHRhcmdldCAgICA9IElTX0dMT0JBTCA/IGdsb2JhbCA6IElTX1NUQVRJQyA/IGdsb2JhbFtuYW1lXSA6IChnbG9iYWxbbmFtZV0gfHwge30pW1BST1RPVFlQRV0KICAgICwga2V5LCBvd24sIG91dDsKICBpZihJU19HTE9CQUwpc291cmNlID0gbmFtZTsKICBmb3Ioa2V5IGluIHNvdXJjZSl7CiAgICAvLyBjb250YWlucyBpbiBuYXRpdmUKICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIHRhcmdldFtrZXldICE9PSB1bmRlZmluZWQ7CiAgICBpZihvd24gJiYga2V5IGluIGV4cG9ydHMpY29udGludWU7CiAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZAogICAgb3V0ID0gb3duID8gdGFyZ2V0W2tleV0gOiBzb3VyY2Vba2V5XTsKICAgIC8vIHByZXZlbnQgZ2xvYmFsIHBvbGx1dGlvbiBmb3IgbmFtZXNwYWNlcwogICAgZXhwb3J0c1trZXldID0gSVNfR0xPQkFMICYmIHR5cGVvZiB0YXJnZXRba2V5XSAhPSAnZnVuY3Rpb24nID8gc291cmNlW2tleV0KICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0CiAgICA6IElTX0JJTkQgJiYgb3duID8gY3R4KG91dCwgZ2xvYmFsKQogICAgLy8gd3JhcCBnbG9iYWwgY29uc3RydWN0b3JzIGZvciBwcmV2ZW50IGNoYW5nZSB0aGVtIGluIGxpYnJhcnkKICAgIDogSVNfV1JBUCAmJiB0YXJnZXRba2V5XSA9PSBvdXQgPyAoZnVuY3Rpb24oQyl7CiAgICAgIHZhciBGID0gZnVuY3Rpb24oYSwgYiwgYyl7CiAgICAgICAgaWYodGhpcyBpbnN0YW5jZW9mIEMpewogICAgICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpewogICAgICAgICAgICBjYXNlIDA6IHJldHVybiBuZXcgQzsKICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gbmV3IEMoYSk7CiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBDKGEsIGIpOwogICAgICAgICAgfSByZXR1cm4gbmV3IEMoYSwgYiwgYyk7CiAgICAgICAgfSByZXR1cm4gQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgICBGW1BST1RPVFlQRV0gPSBDW1BST1RPVFlQRV07CiAgICAgIHJldHVybiBGOwogICAgLy8gbWFrZSBzdGF0aWMgdmVyc2lvbnMgZm9yIHByb3RvdHlwZSBtZXRob2RzCiAgICB9KShvdXQpIDogSVNfUFJPVE8gJiYgdHlwZW9mIG91dCA9PSAnZnVuY3Rpb24nID8gY3R4KEZ1bmN0aW9uLmNhbGwsIG91dCkgOiBvdXQ7CiAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUubWV0aG9kcy4lTkFNRSUKICAgIGlmKElTX1BST1RPKXsKICAgICAgKGV4cG9ydHMudmlydHVhbCB8fCAoZXhwb3J0cy52aXJ0dWFsID0ge30pKVtrZXldID0gb3V0OwogICAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUucHJvdG90eXBlLiVOQU1FJQogICAgICBpZih0eXBlICYgJGV4cG9ydC5SICYmIGV4cFByb3RvICYmICFleHBQcm90b1trZXldKWhpZGUoZXhwUHJvdG8sIGtleSwgb3V0KTsKICAgIH0KICB9Cn07Ci8vIHR5cGUgYml0bWFwCiRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkCiRleHBvcnQuRyA9IDI7ICAgLy8gZ2xvYmFsCiRleHBvcnQuUyA9IDQ7ICAgLy8gc3RhdGljCiRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG8KJGV4cG9ydC5CID0gMTY7ICAvLyBiaW5kCiRleHBvcnQuVyA9IDMyOyAgLy8gd3JhcAokZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmUKJGV4cG9ydC5SID0gMTI4OyAvLyByZWFsIHByb3RvIG1ldGhvZCBmb3IgYGxpYnJhcnlgCm1vZHVsZS5leHBvcnRzID0gJGV4cG9ydDsKCi8qKiovIH0pLAovKiAzNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBjcmVhdGVEZXNjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzOSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKSA/IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7CiAgcmV0dXJuIGRQLmYob2JqZWN0LCBrZXksIGNyZWF0ZURlc2MoMSwgdmFsdWUpKTsKfSA6IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7CiAgb2JqZWN0W2tleV0gPSB2YWx1ZTsKICByZXR1cm4gb2JqZWN0Owp9OwoKLyoqKi8gfSksCi8qIDM4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0gIV9fd2VicGFja19yZXF1aXJlX18oMSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18oMTApKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KSgnZGl2JyksICdhJywge2dldDogZnVuY3Rpb24oKXsgcmV0dXJuIDc7IH19KS5hICE9IDc7Cn0pOwoKLyoqKi8gfSksCi8qIDM5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYml0bWFwLCB2YWx1ZSl7CiAgcmV0dXJuIHsKICAgIGVudW1lcmFibGUgIDogIShiaXRtYXAgJiAxKSwKICAgIGNvbmZpZ3VyYWJsZTogIShiaXRtYXAgJiAyKSwKICAgIHdyaXRhYmxlICAgIDogIShiaXRtYXAgJiA0KSwKICAgIHZhbHVlICAgICAgIDogdmFsdWUKICB9Owp9OwoKLyoqKi8gfSksCi8qIDQwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDcuMS4xIFRvUHJpbWl0aXZlKGlucHV0IFssIFByZWZlcnJlZFR5cGVdKQp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpOwovLyBpbnN0ZWFkIG9mIHRoZSBFUzYgc3BlYyB2ZXJzaW9uLCB3ZSBkaWRuJ3QgaW1wbGVtZW50IEBAdG9QcmltaXRpdmUgY2FzZQovLyBhbmQgdGhlIHNlY29uZCBhcmd1bWVudCAtIGZsYWcgLSBwcmVmZXJyZWQgdHlwZSBpcyBhIHN0cmluZwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBTKXsKICBpZighaXNPYmplY3QoaXQpKXJldHVybiBpdDsKICB2YXIgZm4sIHZhbDsKICBpZihTICYmIHR5cGVvZiAoZm4gPSBpdC50b1N0cmluZykgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKXJldHVybiB2YWw7CiAgaWYodHlwZW9mIChmbiA9IGl0LnZhbHVlT2YpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIGlmKCFTICYmIHR5cGVvZiAoZm4gPSBpdC50b1N0cmluZykgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKXJldHVybiB2YWw7CiAgdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWUiKTsKfTsKCi8qKiovIH0pLAovKiA0MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oMzYpOwovLyAxOS4xLjIuNCAvIDE1LjIuMy42IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLCAnT2JqZWN0Jywge2RlZmluZVByb3BlcnR5OiBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKS5mfSk7CgovKioqLyB9KSwKLyogNDIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwovKiEKICogVVRGLTggdmFsaWRhdGU6IFVURi04IHZhbGlkYXRpb24gZm9yIFdlYlNvY2tldHMuCiAqIENvcHlyaWdodChjKSAyMDE1IEVpbmFyIE90dG8gU3Rhbmd2aWsgPGVpbmFyb3NAZ21haWwuY29tPgogKiBNSVQgTGljZW5zZWQKICovCgoKCi8qKgogKiBDaGVja3MgaWYgYSBnaXZlbiBidWZmZXIgY29udGFpbnMgb25seSBjb3JyZWN0IFVURi04LgogKiBQb3J0ZWQgZnJvbSBodHRwczovL3d3dy5jbC5jYW0uYWMudWsvJTdFbWdrMjUvdWNzL3V0ZjhfY2hlY2suYyBieQogKiBNYXJrdXMgS3Vobi4KICoKICogQHBhcmFtIHtCdWZmZXJ9IGJ1ZiBUaGUgYnVmZmVyIHRvIGNoZWNrCiAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiBgYnVmYCBjb250YWlucyBvbmx5IGNvcnJlY3QgVVRGLTgsIGVsc2UgYGZhbHNlYAogKiBAcHVibGljCiAqLwpjb25zdCBpc1ZhbGlkVVRGOCA9IChidWYpID0+IHsKICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdGaXJzdCBhcmd1bWVudCBuZWVkcyB0byBiZSBhIGJ1ZmZlcicpOwogIH0KCiAgdmFyIGxlbiA9IGJ1Zi5sZW5ndGg7CiAgdmFyIGkgPSAwOwoKICB3aGlsZSAoaSA8IGxlbikgewogICAgaWYgKGJ1ZltpXSA8IDB4ODApIHsgIC8vIDB4eHh4eHh4CiAgICAgIGkrKzsKICAgIH0gZWxzZSBpZiAoKGJ1ZltpXSAmIDB4ZTApID09PSAweGMwKSB7ICAvLyAxMTB4eHh4eCAxMHh4eHh4eAogICAgICBpZiAoCiAgICAgICAgaSArIDEgPT09IGxlbiB8fAogICAgICAgIChidWZbaSArIDFdICYgMHhjMCkgIT09IDB4ODAgfHwKICAgICAgICAoYnVmW2ldICYgMHhmZSkgPT09IDB4YzAgIC8vIG92ZXJsb25nCiAgICAgICkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpICs9IDI7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoKGJ1ZltpXSAmIDB4ZjApID09PSAweGUwKSB7ICAvLyAxMTEweHh4eCAxMHh4eHh4eCAxMHh4eHh4eAogICAgICBpZiAoCiAgICAgICAgaSArIDIgPj0gbGVuIHx8CiAgICAgICAgKGJ1ZltpICsgMV0gJiAweGMwKSAhPT0gMHg4MCB8fAogICAgICAgIChidWZbaSArIDJdICYgMHhjMCkgIT09IDB4ODAgfHwKICAgICAgICBidWZbaV0gPT09IDB4ZTAgJiYgKGJ1ZltpICsgMV0gJiAweGUwKSA9PT0gMHg4MCB8fCAgLy8gb3ZlcmxvbmcKICAgICAgICBidWZbaV0gPT09IDB4ZWQgJiYgKGJ1ZltpICsgMV0gJiAweGUwKSA9PT0gMHhhMCAgICAgLy8gc3Vycm9nYXRlIChVK0Q4MDAgLSBVK0RGRkYpCiAgICAgICkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpICs9IDM7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoKGJ1ZltpXSAmIDB4ZjgpID09PSAweGYwKSB7ICAvLyAxMTExMHh4eCAxMHh4eHh4eCAxMHh4eHh4eCAxMHh4eHh4eAogICAgICBpZiAoCiAgICAgICAgaSArIDMgPj0gbGVuIHx8CiAgICAgICAgKGJ1ZltpICsgMV0gJiAweGMwKSAhPT0gMHg4MCB8fAogICAgICAgIChidWZbaSArIDJdICYgMHhjMCkgIT09IDB4ODAgfHwKICAgICAgICAoYnVmW2kgKyAzXSAmIDB4YzApICE9PSAweDgwIHx8CiAgICAgICAgYnVmW2ldID09PSAweGYwICYmIChidWZbaSArIDFdICYgMHhmMCkgPT09IDB4ODAgfHwgIC8vIG92ZXJsb25nCiAgICAgICAgYnVmW2ldID09PSAweGY0ICYmIGJ1ZltpICsgMV0gPiAweDhmIHx8IGJ1ZltpXSA+IDB4ZjQgIC8vID4gVSsxMEZGRkYKICAgICAgKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIGkgKz0gNDsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KCiAgcmV0dXJuIHRydWU7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IGlzVmFsaWRVVEY4OwoKCi8qKiovIH0pLAovKiA0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKdHJ5IHsKICBtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oOSkoJ3ZhbGlkYXRpb24nKTsKfSBjYXRjaCAoZSkgewogIG1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Mik7Cn0KCgovKioqLyB9KSwKLyogNDQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCi8qKgogKiBDbGFzcyByZXByZXNlbnRpbmcgYW4gZXZlbnQuCiAqCiAqIEBwcml2YXRlCiAqLwpjbGFzcyBFdmVudCB7CiAgLyoqCiAgICogQ3JlYXRlIGEgbmV3IGBFdmVudGAuCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZSBUaGUgbmFtZSBvZiB0aGUgZXZlbnQKICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0IEEgcmVmZXJlbmNlIHRvIHRoZSB0YXJnZXQgdG8gd2hpY2ggdGhlIGV2ZW50IHdhcyBkaXNwYXRjaGVkCiAgICovCiAgY29uc3RydWN0b3IgKHR5cGUsIHRhcmdldCkgewogICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7CiAgICB0aGlzLnR5cGUgPSB0eXBlOwogIH0KfQoKLyoqCiAqIENsYXNzIHJlcHJlc2VudGluZyBhIG1lc3NhZ2UgZXZlbnQuCiAqCiAqIEBleHRlbmRzIEV2ZW50CiAqIEBwcml2YXRlCiAqLwpjbGFzcyBNZXNzYWdlRXZlbnQgZXh0ZW5kcyBFdmVudCB7CiAgLyoqCiAgICogQ3JlYXRlIGEgbmV3IGBNZXNzYWdlRXZlbnRgLgogICAqCiAgICogQHBhcmFtIHsoU3RyaW5nfEJ1ZmZlcnxBcnJheUJ1ZmZlcnxCdWZmZXJbXSl9IGRhdGEgVGhlIHJlY2VpdmVkIGRhdGEKICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlzQmluYXJ5IFNwZWNpZmllcyBpZiBgZGF0YWAgaXMgYmluYXJ5CiAgICogQHBhcmFtIHtXZWJTb2NrZXR9IHRhcmdldCBBIHJlZmVyZW5jZSB0byB0aGUgdGFyZ2V0IHRvIHdoaWNoIHRoZSBldmVudCB3YXMgZGlzcGF0Y2hlZAogICAqLwogIGNvbnN0cnVjdG9yIChkYXRhLCBpc0JpbmFyeSwgdGFyZ2V0KSB7CiAgICBzdXBlcignbWVzc2FnZScsIHRhcmdldCk7CgogICAgdGhpcy5iaW5hcnkgPSBpc0JpbmFyeTsgLy8gbm9uLXN0YW5kYXJkLgogICAgdGhpcy5kYXRhID0gZGF0YTsKICB9Cn0KCi8qKgogKiBDbGFzcyByZXByZXNlbnRpbmcgYSBjbG9zZSBldmVudC4KICoKICogQGV4dGVuZHMgRXZlbnQKICogQHByaXZhdGUKICovCmNsYXNzIENsb3NlRXZlbnQgZXh0ZW5kcyBFdmVudCB7CiAgLyoqCiAgICogQ3JlYXRlIGEgbmV3IGBDbG9zZUV2ZW50YC4KICAgKgogICAqIEBwYXJhbSB7TnVtYmVyfSBjb2RlIFRoZSBzdGF0dXMgY29kZSBleHBsYWluaW5nIHdoeSB0aGUgY29ubmVjdGlvbiBpcyBiZWluZyBjbG9zZWQKICAgKiBAcGFyYW0ge1N0cmluZ30gcmVhc29uIEEgaHVtYW4tcmVhZGFibGUgc3RyaW5nIGV4cGxhaW5pbmcgd2h5IHRoZSBjb25uZWN0aW9uIGlzIGNsb3NpbmcKICAgKiBAcGFyYW0ge1dlYlNvY2tldH0gdGFyZ2V0IEEgcmVmZXJlbmNlIHRvIHRoZSB0YXJnZXQgdG8gd2hpY2ggdGhlIGV2ZW50IHdhcyBkaXNwYXRjaGVkCiAgICovCiAgY29uc3RydWN0b3IgKGNvZGUsIHJlYXNvbiwgdGFyZ2V0KSB7CiAgICBzdXBlcignY2xvc2UnLCB0YXJnZXQpOwoKICAgIHRoaXMud2FzQ2xlYW4gPSBjb2RlID09PSB1bmRlZmluZWQgfHwgY29kZSA9PT0gMTAwMDsKICAgIHRoaXMucmVhc29uID0gcmVhc29uOwogICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7CiAgICB0aGlzLnR5cGUgPSAnY2xvc2UnOwogICAgdGhpcy5jb2RlID0gY29kZTsKICB9Cn0KCi8qKgogKiBDbGFzcyByZXByZXNlbnRpbmcgYW4gb3BlbiBldmVudC4KICoKICogQGV4dGVuZHMgRXZlbnQKICogQHByaXZhdGUKICovCmNsYXNzIE9wZW5FdmVudCBleHRlbmRzIEV2ZW50IHsKICAvKioKICAgKiBDcmVhdGUgYSBuZXcgYE9wZW5FdmVudGAuCiAgICoKICAgKiBAcGFyYW0ge1dlYlNvY2tldH0gdGFyZ2V0IEEgcmVmZXJlbmNlIHRvIHRoZSB0YXJnZXQgdG8gd2hpY2ggdGhlIGV2ZW50IHdhcyBkaXNwYXRjaGVkCiAgICovCiAgY29uc3RydWN0b3IgKHRhcmdldCkgewogICAgc3VwZXIoJ29wZW4nLCB0YXJnZXQpOwogIH0KfQoKLyoqCiAqIFRoaXMgcHJvdmlkZXMgbWV0aG9kcyBmb3IgZW11bGF0aW5nIHRoZSBgRXZlbnRUYXJnZXRgIGludGVyZmFjZS4gSXQncyBub3QKICogbWVhbnQgdG8gYmUgdXNlZCBkaXJlY3RseS4KICoKICogQG1peGluCiAqLwpjb25zdCBFdmVudFRhcmdldCA9IHsKICAvKioKICAgKiBSZWdpc3RlciBhbiBldmVudCBsaXN0ZW5lci4KICAgKgogICAqIEBwYXJhbSB7U3RyaW5nfSBtZXRob2QgQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBldmVudCB0eXBlIHRvIGxpc3RlbiBmb3IKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciBUaGUgbGlzdGVuZXIgdG8gYWRkCiAgICogQHB1YmxpYwogICAqLwogIGFkZEV2ZW50TGlzdGVuZXIgKG1ldGhvZCwgbGlzdGVuZXIpIHsKICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09ICdmdW5jdGlvbicpIHJldHVybjsKCiAgICBmdW5jdGlvbiBvbk1lc3NhZ2UgKGRhdGEsIGZsYWdzKSB7CiAgICAgIGxpc3RlbmVyLmNhbGwodGhpcywgbmV3IE1lc3NhZ2VFdmVudChkYXRhLCAhIWZsYWdzLmJpbmFyeSwgdGhpcykpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9uQ2xvc2UgKGNvZGUsIG1lc3NhZ2UpIHsKICAgICAgbGlzdGVuZXIuY2FsbCh0aGlzLCBuZXcgQ2xvc2VFdmVudChjb2RlLCBtZXNzYWdlLCB0aGlzKSk7CiAgICB9CgogICAgZnVuY3Rpb24gb25FcnJvciAoZXZlbnQpIHsKICAgICAgZXZlbnQudHlwZSA9ICdlcnJvcic7CiAgICAgIGV2ZW50LnRhcmdldCA9IHRoaXM7CiAgICAgIGxpc3RlbmVyLmNhbGwodGhpcywgZXZlbnQpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9uT3BlbiAoKSB7CiAgICAgIGxpc3RlbmVyLmNhbGwodGhpcywgbmV3IE9wZW5FdmVudCh0aGlzKSk7CiAgICB9CgogICAgaWYgKG1ldGhvZCA9PT0gJ21lc3NhZ2UnKSB7CiAgICAgIG9uTWVzc2FnZS5fbGlzdGVuZXIgPSBsaXN0ZW5lcjsKICAgICAgdGhpcy5vbihtZXRob2QsIG9uTWVzc2FnZSk7CiAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gJ2Nsb3NlJykgewogICAgICBvbkNsb3NlLl9saXN0ZW5lciA9IGxpc3RlbmVyOwogICAgICB0aGlzLm9uKG1ldGhvZCwgb25DbG9zZSk7CiAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gJ2Vycm9yJykgewogICAgICBvbkVycm9yLl9saXN0ZW5lciA9IGxpc3RlbmVyOwogICAgICB0aGlzLm9uKG1ldGhvZCwgb25FcnJvcik7CiAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gJ29wZW4nKSB7CiAgICAgIG9uT3Blbi5fbGlzdGVuZXIgPSBsaXN0ZW5lcjsKICAgICAgdGhpcy5vbihtZXRob2QsIG9uT3Blbik7CiAgICB9IGVsc2UgewogICAgICB0aGlzLm9uKG1ldGhvZCwgbGlzdGVuZXIpOwogICAgfQogIH0sCgogIC8qKgogICAqIFJlbW92ZSBhbiBldmVudCBsaXN0ZW5lci4KICAgKgogICAqIEBwYXJhbSB7U3RyaW5nfSBtZXRob2QgQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBldmVudCB0eXBlIHRvIHJlbW92ZQogICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIFRoZSBsaXN0ZW5lciB0byByZW1vdmUKICAgKiBAcHVibGljCiAgICovCiAgcmVtb3ZlRXZlbnRMaXN0ZW5lciAobWV0aG9kLCBsaXN0ZW5lcikgewogICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5saXN0ZW5lcnMobWV0aG9kKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykgewogICAgICBpZiAobGlzdGVuZXJzW2ldID09PSBsaXN0ZW5lciB8fCBsaXN0ZW5lcnNbaV0uX2xpc3RlbmVyID09PSBsaXN0ZW5lcikgewogICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIobWV0aG9kLCBsaXN0ZW5lcnNbaV0pOwogICAgICB9CiAgICB9CiAgfQp9OwoKbW9kdWxlLmV4cG9ydHMgPSBFdmVudFRhcmdldDsKCgovKioqLyB9KSwKLyogNDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwovKiEKICogd3M6IGEgbm9kZS5qcyB3ZWJzb2NrZXQgY2xpZW50CiAqIENvcHlyaWdodChjKSAyMDExIEVpbmFyIE90dG8gU3Rhbmd2aWsgPGVpbmFyb3NAZ21haWwuY29tPgogKiBNSVQgTGljZW5zZWQKICovCgoKCnRyeSB7CiAgY29uc3QgaXNWYWxpZFVURjggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQzKTsKCiAgbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2YgaXNWYWxpZFVURjggPT09ICdvYmplY3QnCiAgICA/IGlzVmFsaWRVVEY4LlZhbGlkYXRpb24uaXNWYWxpZFVURjggIC8vIHV0Zi04LXZhbGlkYXRlQDwzLjAuMAogICAgOiBpc1ZhbGlkVVRGODsKfSBjYXRjaCAoZSkgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8gewogIG1vZHVsZS5leHBvcnRzID0gKCkgPT4gdHJ1ZTsKfQoKCi8qKiovIH0pLAovKiA0NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Ci8qIQogKiB3czogYSBub2RlLmpzIHdlYnNvY2tldCBjbGllbnQKICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+CiAqIE1JVCBMaWNlbnNlZAogKi8KCgoKY29uc3Qgc2FmZUJ1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7CmNvbnN0IEV2ZW50RW1pdHRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpOwpjb25zdCBjcnlwdG8gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwpjb25zdCBVbHRyb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTsKY29uc3QgaHR0cCA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwpjb25zdCB1cmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKTsKCmNvbnN0IFBlck1lc3NhZ2VEZWZsYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTsKY29uc3QgRXh0ZW5zaW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpOwpjb25zdCBjb25zdGFudHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwpjb25zdCBXZWJTb2NrZXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKCmNvbnN0IEJ1ZmZlciA9IHNhZmVCdWZmZXIuQnVmZmVyOwoKLyoqCiAqIENsYXNzIHJlcHJlc2VudGluZyBhIFdlYlNvY2tldCBzZXJ2ZXIuCiAqCiAqIEBleHRlbmRzIEV2ZW50RW1pdHRlcgogKi8KY2xhc3MgV2ViU29ja2V0U2VydmVyIGV4dGVuZHMgRXZlbnRFbWl0dGVyIHsKICAvKioKICAgKiBDcmVhdGUgYSBgV2ViU29ja2V0U2VydmVyYCBpbnN0YW5jZS4KICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIENvbmZpZ3VyYXRpb24gb3B0aW9ucwogICAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLmhvc3QgVGhlIGhvc3RuYW1lIHdoZXJlIHRvIGJpbmQgdGhlIHNlcnZlcgogICAqIEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLnBvcnQgVGhlIHBvcnQgd2hlcmUgdG8gYmluZCB0aGUgc2VydmVyCiAgICogQHBhcmFtIHtodHRwLlNlcnZlcn0gb3B0aW9ucy5zZXJ2ZXIgQSBwcmUtY3JlYXRlZCBIVFRQL1Mgc2VydmVyIHRvIHVzZQogICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMudmVyaWZ5Q2xpZW50IEFuIGhvb2sgdG8gcmVqZWN0IGNvbm5lY3Rpb25zCiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5oYW5kbGVQcm90b2NvbHMgQW4gaG9vayB0byBoYW5kbGUgcHJvdG9jb2xzCiAgICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMucGF0aCBBY2NlcHQgb25seSBjb25uZWN0aW9ucyBtYXRjaGluZyB0aGlzIHBhdGgKICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMubm9TZXJ2ZXIgRW5hYmxlIG5vIHNlcnZlciBtb2RlCiAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLmNsaWVudFRyYWNraW5nIFNwZWNpZmllcyB3aGV0aGVyIG9yIG5vdCB0byB0cmFjayBjbGllbnRzCiAgICogQHBhcmFtIHsoQm9vbGVhbnxPYmplY3QpfSBvcHRpb25zLnBlck1lc3NhZ2VEZWZsYXRlIEVuYWJsZS9kaXNhYmxlIHBlcm1lc3NhZ2UtZGVmbGF0ZQogICAqIEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLm1heFBheWxvYWQgVGhlIG1heGltdW0gYWxsb3dlZCBtZXNzYWdlIHNpemUKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBBIGxpc3RlbmVyIGZvciB0aGUgYGxpc3RlbmluZ2AgZXZlbnQKICAgKi8KICBjb25zdHJ1Y3RvciAob3B0aW9ucywgY2FsbGJhY2spIHsKICAgIHN1cGVyKCk7CgogICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oewogICAgICBtYXhQYXlsb2FkOiAxMDAgKiAxMDI0ICogMTAyNCwKICAgICAgcGVyTWVzc2FnZURlZmxhdGU6IHRydWUsCiAgICAgIGhhbmRsZVByb3RvY29sczogbnVsbCwKICAgICAgY2xpZW50VHJhY2tpbmc6IHRydWUsCiAgICAgIHZlcmlmeUNsaWVudDogbnVsbCwKICAgICAgbm9TZXJ2ZXI6IGZhbHNlLAogICAgICBiYWNrbG9nOiBudWxsLCAvLyB1c2UgZGVmYXVsdCAoNTExIGFzIGltcGxlbWVudGVkIGluIG5ldC5qcykKICAgICAgc2VydmVyOiBudWxsLAogICAgICBob3N0OiBudWxsLAogICAgICBwYXRoOiBudWxsLAogICAgICBwb3J0OiBudWxsCiAgICB9LCBvcHRpb25zKTsKCiAgICBpZiAob3B0aW9ucy5wb3J0ID09IG51bGwgJiYgIW9wdGlvbnMuc2VydmVyICYmICFvcHRpb25zLm5vU2VydmVyKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ21pc3Npbmcgb3IgaW52YWxpZCBvcHRpb25zJyk7CiAgICB9CgogICAgaWYgKG9wdGlvbnMucG9ydCAhPSBudWxsKSB7CiAgICAgIHRoaXMuX3NlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKChyZXEsIHJlcykgPT4gewogICAgICAgIGNvbnN0IGJvZHkgPSBodHRwLlNUQVRVU19DT0RFU1s0MjZdOwoKICAgICAgICByZXMud3JpdGVIZWFkKDQyNiwgewogICAgICAgICAgJ0NvbnRlbnQtTGVuZ3RoJzogYm9keS5sZW5ndGgsCiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nCiAgICAgICAgfSk7CiAgICAgICAgcmVzLmVuZChib2R5KTsKICAgICAgfSk7CiAgICAgIHRoaXMuX3NlcnZlci5hbGxvd0hhbGZPcGVuID0gZmFsc2U7CiAgICAgIHRoaXMuX3NlcnZlci5saXN0ZW4ob3B0aW9ucy5wb3J0LCBvcHRpb25zLmhvc3QsIG9wdGlvbnMuYmFja2xvZywgY2FsbGJhY2spOwogICAgfSBlbHNlIGlmIChvcHRpb25zLnNlcnZlcikgewogICAgICB0aGlzLl9zZXJ2ZXIgPSBvcHRpb25zLnNlcnZlcjsKICAgIH0KCiAgICBpZiAodGhpcy5fc2VydmVyKSB7CiAgICAgIHRoaXMuX3VsdHJvbiA9IG5ldyBVbHRyb24odGhpcy5fc2VydmVyKTsKICAgICAgdGhpcy5fdWx0cm9uLm9uKCdsaXN0ZW5pbmcnLCAoKSA9PiB0aGlzLmVtaXQoJ2xpc3RlbmluZycpKTsKICAgICAgdGhpcy5fdWx0cm9uLm9uKCdlcnJvcicsIChlcnIpID0+IHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpKTsKICAgICAgdGhpcy5fdWx0cm9uLm9uKCd1cGdyYWRlJywgKHJlcSwgc29ja2V0LCBoZWFkKSA9PiB7CiAgICAgICAgdGhpcy5oYW5kbGVVcGdyYWRlKHJlcSwgc29ja2V0LCBoZWFkLCAoY2xpZW50KSA9PiB7CiAgICAgICAgICB0aGlzLmVtaXQoYGNvbm5lY3Rpb24ke3JlcS51cmx9YCwgY2xpZW50KTsKICAgICAgICAgIHRoaXMuZW1pdCgnY29ubmVjdGlvbicsIGNsaWVudCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIGlmIChvcHRpb25zLmNsaWVudFRyYWNraW5nKSB0aGlzLmNsaWVudHMgPSBuZXcgU2V0KCk7CiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOwogICAgdGhpcy5wYXRoID0gb3B0aW9ucy5wYXRoOwogIH0KCiAgLyoqCiAgICogQ2xvc2UgdGhlIHNlcnZlci4KICAgKgogICAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIENhbGxiYWNrCiAgICogQHB1YmxpYwogICAqLwogIGNsb3NlIChjYikgewogICAgLy8KICAgIC8vIFRlcm1pbmF0ZSBhbGwgYXNzb2NpYXRlZCBjbGllbnRzLgogICAgLy8KICAgIGlmICh0aGlzLmNsaWVudHMpIHsKICAgICAgZm9yIChjb25zdCBjbGllbnQgb2YgdGhpcy5jbGllbnRzKSBjbGllbnQudGVybWluYXRlKCk7CiAgICB9CgogICAgY29uc3Qgc2VydmVyID0gdGhpcy5fc2VydmVyOwoKICAgIGlmIChzZXJ2ZXIpIHsKICAgICAgdGhpcy5fdWx0cm9uLmRlc3Ryb3koKTsKICAgICAgdGhpcy5fdWx0cm9uID0gdGhpcy5fc2VydmVyID0gbnVsbDsKCiAgICAgIC8vCiAgICAgIC8vIENsb3NlIHRoZSBodHRwIHNlcnZlciBpZiBpdCB3YXMgaW50ZXJuYWxseSBjcmVhdGVkLgogICAgICAvLwogICAgICBpZiAodGhpcy5vcHRpb25zLnBvcnQgIT0gbnVsbCkgcmV0dXJuIHNlcnZlci5jbG9zZShjYik7CiAgICB9CgogICAgaWYgKGNiKSBjYigpOwogIH0KCiAgLyoqCiAgICogU2VlIGlmIGEgZ2l2ZW4gcmVxdWVzdCBzaG91bGQgYmUgaGFuZGxlZCBieSB0aGlzIHNlcnZlciBpbnN0YW5jZS4KICAgKgogICAqIEBwYXJhbSB7aHR0cC5JbmNvbWluZ01lc3NhZ2V9IHJlcSBSZXF1ZXN0IG9iamVjdCB0byBpbnNwZWN0CiAgICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSByZXF1ZXN0IGlzIHZhbGlkLCBlbHNlIGBmYWxzZWAKICAgKiBAcHVibGljCiAgICovCiAgc2hvdWxkSGFuZGxlIChyZXEpIHsKICAgIGlmICh0aGlzLm9wdGlvbnMucGF0aCAmJiB1cmwucGFyc2UocmVxLnVybCkucGF0aG5hbWUgIT09IHRoaXMub3B0aW9ucy5wYXRoKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIC8qKgogICAqIEhhbmRsZSBhIEhUVFAgVXBncmFkZSByZXF1ZXN0LgogICAqCiAgICogQHBhcmFtIHtodHRwLkluY29taW5nTWVzc2FnZX0gcmVxIFRoZSByZXF1ZXN0IG9iamVjdAogICAqIEBwYXJhbSB7bmV0LlNvY2tldH0gc29ja2V0IFRoZSBuZXR3b3JrIHNvY2tldCBiZXR3ZWVuIHRoZSBzZXJ2ZXIgYW5kIGNsaWVudAogICAqIEBwYXJhbSB7QnVmZmVyfSBoZWFkIFRoZSBmaXJzdCBwYWNrZXQgb2YgdGhlIHVwZ3JhZGVkIHN0cmVhbQogICAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIENhbGxiYWNrCiAgICogQHB1YmxpYwogICAqLwogIGhhbmRsZVVwZ3JhZGUgKHJlcSwgc29ja2V0LCBoZWFkLCBjYikgewogICAgc29ja2V0Lm9uKCdlcnJvcicsIHNvY2tldEVycm9yKTsKCiAgICBjb25zdCB2ZXJzaW9uID0gK3JlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LXZlcnNpb24nXTsKCiAgICBpZiAoCiAgICAgIHJlcS5tZXRob2QgIT09ICdHRVQnIHx8IHJlcS5oZWFkZXJzLnVwZ3JhZGUudG9Mb3dlckNhc2UoKSAhPT0gJ3dlYnNvY2tldCcgfHwKICAgICAgIXJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LWtleSddIHx8ICh2ZXJzaW9uICE9PSA4ICYmIHZlcnNpb24gIT09IDEzKSB8fAogICAgICAhdGhpcy5zaG91bGRIYW5kbGUocmVxKQogICAgKSB7CiAgICAgIHJldHVybiBhYm9ydENvbm5lY3Rpb24oc29ja2V0LCA0MDApOwogICAgfQoKICAgIHZhciBwcm90b2NvbCA9IChyZXEuaGVhZGVyc1snc2VjLXdlYnNvY2tldC1wcm90b2NvbCddIHx8ICcnKS5zcGxpdCgvLCAqLyk7CgogICAgLy8KICAgIC8vIE9wdGlvbmFsbHkgY2FsbCBleHRlcm5hbCBwcm90b2NvbCBzZWxlY3Rpb24gaGFuZGxlci4KICAgIC8vCiAgICBpZiAodGhpcy5vcHRpb25zLmhhbmRsZVByb3RvY29scykgewogICAgICBwcm90b2NvbCA9IHRoaXMub3B0aW9ucy5oYW5kbGVQcm90b2NvbHMocHJvdG9jb2wpOwogICAgICBpZiAocHJvdG9jb2wgPT09IGZhbHNlKSByZXR1cm4gYWJvcnRDb25uZWN0aW9uKHNvY2tldCwgNDAxKTsKICAgIH0gZWxzZSB7CiAgICAgIHByb3RvY29sID0gcHJvdG9jb2xbMF07CiAgICB9CgogICAgLy8KICAgIC8vIE9wdGlvbmFsbHkgY2FsbCBleHRlcm5hbCBjbGllbnQgdmVyaWZpY2F0aW9uIGhhbmRsZXIuCiAgICAvLwogICAgaWYgKHRoaXMub3B0aW9ucy52ZXJpZnlDbGllbnQpIHsKICAgICAgY29uc3QgaW5mbyA9IHsKICAgICAgICBvcmlnaW46IHJlcS5oZWFkZXJzW2Ake3ZlcnNpb24gPT09IDggPyAnc2VjLXdlYnNvY2tldC1vcmlnaW4nIDogJ29yaWdpbid9YF0sCiAgICAgICAgc2VjdXJlOiAhIShyZXEuY29ubmVjdGlvbi5hdXRob3JpemVkIHx8IHJlcS5jb25uZWN0aW9uLmVuY3J5cHRlZCksCiAgICAgICAgcmVxCiAgICAgIH07CgogICAgICBpZiAodGhpcy5vcHRpb25zLnZlcmlmeUNsaWVudC5sZW5ndGggPT09IDIpIHsKICAgICAgICB0aGlzLm9wdGlvbnMudmVyaWZ5Q2xpZW50KGluZm8sICh2ZXJpZmllZCwgY29kZSwgbWVzc2FnZSkgPT4gewogICAgICAgICAgaWYgKCF2ZXJpZmllZCkgcmV0dXJuIGFib3J0Q29ubmVjdGlvbihzb2NrZXQsIGNvZGUgfHwgNDAxLCBtZXNzYWdlKTsKCiAgICAgICAgICB0aGlzLmNvbXBsZXRlVXBncmFkZShwcm90b2NvbCwgdmVyc2lvbiwgcmVxLCBzb2NrZXQsIGhlYWQsIGNiKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMub3B0aW9ucy52ZXJpZnlDbGllbnQoaW5mbykpIHsKICAgICAgICByZXR1cm4gYWJvcnRDb25uZWN0aW9uKHNvY2tldCwgNDAxKTsKICAgICAgfQogICAgfQoKICAgIHRoaXMuY29tcGxldGVVcGdyYWRlKHByb3RvY29sLCB2ZXJzaW9uLCByZXEsIHNvY2tldCwgaGVhZCwgY2IpOwogIH0KCiAgLyoqCiAgICogVXBncmFkZSB0aGUgY29ubmVjdGlvbiB0byBXZWJTb2NrZXQuCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvdG9jb2wgVGhlIGNob3NlbiBzdWJwcm90b2NvbAogICAqIEBwYXJhbSB7TnVtYmVyfSB2ZXJzaW9uIFRoZSBXZWJTb2NrZXQgcHJvdG9jb2wgdmVyc2lvbgogICAqIEBwYXJhbSB7aHR0cC5JbmNvbWluZ01lc3NhZ2V9IHJlcSBUaGUgcmVxdWVzdCBvYmplY3QKICAgKiBAcGFyYW0ge25ldC5Tb2NrZXR9IHNvY2tldCBUaGUgbmV0d29yayBzb2NrZXQgYmV0d2VlbiB0aGUgc2VydmVyIGFuZCBjbGllbnQKICAgKiBAcGFyYW0ge0J1ZmZlcn0gaGVhZCBUaGUgZmlyc3QgcGFja2V0IG9mIHRoZSB1cGdyYWRlZCBzdHJlYW0KICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYiBDYWxsYmFjawogICAqIEBwcml2YXRlCiAgICovCiAgY29tcGxldGVVcGdyYWRlIChwcm90b2NvbCwgdmVyc2lvbiwgcmVxLCBzb2NrZXQsIGhlYWQsIGNiKSB7CiAgICAvLwogICAgLy8gRGVzdHJveSB0aGUgc29ja2V0IGlmIHRoZSBjbGllbnQgaGFzIGFscmVhZHkgc2VudCBhIEZJTiBwYWNrZXQuCiAgICAvLwogICAgaWYgKCFzb2NrZXQucmVhZGFibGUgfHwgIXNvY2tldC53cml0YWJsZSkgcmV0dXJuIHNvY2tldC5kZXN0cm95KCk7CgogICAgY29uc3Qga2V5ID0gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTEnKQogICAgICAudXBkYXRlKHJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LWtleSddICsgY29uc3RhbnRzLkdVSUQsICdiaW5hcnknKQogICAgICAuZGlnZXN0KCdiYXNlNjQnKTsKCiAgICBjb25zdCBoZWFkZXJzID0gWwogICAgICAnSFRUUC8xLjEgMTAxIFN3aXRjaGluZyBQcm90b2NvbHMnLAogICAgICAnVXBncmFkZTogd2Vic29ja2V0JywKICAgICAgJ0Nvbm5lY3Rpb246IFVwZ3JhZGUnLAogICAgICBgU2VjLVdlYlNvY2tldC1BY2NlcHQ6ICR7a2V5fWAKICAgIF07CgogICAgaWYgKHByb3RvY29sKSBoZWFkZXJzLnB1c2goYFNlYy1XZWJTb2NrZXQtUHJvdG9jb2w6ICR7cHJvdG9jb2x9YCk7CgogICAgY29uc3Qgb2ZmZXIgPSBFeHRlbnNpb25zLnBhcnNlKHJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LWV4dGVuc2lvbnMnXSk7CiAgICB2YXIgZXh0ZW5zaW9uczsKCiAgICB0cnkgewogICAgICBleHRlbnNpb25zID0gYWNjZXB0RXh0ZW5zaW9ucyh0aGlzLm9wdGlvbnMsIG9mZmVyKTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICByZXR1cm4gYWJvcnRDb25uZWN0aW9uKHNvY2tldCwgNDAwKTsKICAgIH0KCiAgICBjb25zdCBwcm9wcyA9IE9iamVjdC5rZXlzKGV4dGVuc2lvbnMpOwoKICAgIGlmIChwcm9wcy5sZW5ndGgpIHsKICAgICAgY29uc3Qgc2VydmVyRXh0ZW5zaW9ucyA9IHByb3BzLnJlZHVjZSgob2JqLCBrZXkpID0+IHsKICAgICAgICBvYmpba2V5XSA9IFtleHRlbnNpb25zW2tleV0ucGFyYW1zXTsKICAgICAgICByZXR1cm4gb2JqOwogICAgICB9LCB7fSk7CgogICAgICBoZWFkZXJzLnB1c2goYFNlYy1XZWJTb2NrZXQtRXh0ZW5zaW9uczogJHtFeHRlbnNpb25zLmZvcm1hdChzZXJ2ZXJFeHRlbnNpb25zKX1gKTsKICAgIH0KCiAgICAvLwogICAgLy8gQWxsb3cgZXh0ZXJuYWwgbW9kaWZpY2F0aW9uL2luc3BlY3Rpb24gb2YgaGFuZHNoYWtlIGhlYWRlcnMuCiAgICAvLwogICAgdGhpcy5lbWl0KCdoZWFkZXJzJywgaGVhZGVycyk7CgogICAgc29ja2V0LndyaXRlKGhlYWRlcnMuY29uY2F0KCcnLCAnJykuam9pbignXHJcbicpKTsKCiAgICBjb25zdCBjbGllbnQgPSBuZXcgV2ViU29ja2V0KFtyZXEsIHNvY2tldCwgaGVhZF0sIHsKICAgICAgbWF4UGF5bG9hZDogdGhpcy5vcHRpb25zLm1heFBheWxvYWQsCiAgICAgIHByb3RvY29sVmVyc2lvbjogdmVyc2lvbiwKICAgICAgZXh0ZW5zaW9ucywKICAgICAgcHJvdG9jb2wKICAgIH0pOwoKICAgIGlmICh0aGlzLmNsaWVudHMpIHsKICAgICAgdGhpcy5jbGllbnRzLmFkZChjbGllbnQpOwogICAgICBjbGllbnQub24oJ2Nsb3NlJywgKCkgPT4gdGhpcy5jbGllbnRzLmRlbGV0ZShjbGllbnQpKTsKICAgIH0KCiAgICBzb2NrZXQucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgc29ja2V0RXJyb3IpOwogICAgY2IoY2xpZW50KTsKICB9Cn0KCm1vZHVsZS5leHBvcnRzID0gV2ViU29ja2V0U2VydmVyOwoKLyoqCiAqIEhhbmRsZSBwcmVtYXR1cmUgc29ja2V0IGVycm9ycy4KICoKICogQHByaXZhdGUKICovCmZ1bmN0aW9uIHNvY2tldEVycm9yICgpIHsKICB0aGlzLmRlc3Ryb3koKTsKfQoKLyoqCiAqIEFjY2VwdCBXZWJTb2NrZXQgZXh0ZW5zaW9ucy4KICoKICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgVGhlIGBXZWJTb2NrZXRTZXJ2ZXJgIGNvbmZpZ3VyYXRpb24gb3B0aW9ucwogKiBAcGFyYW0ge09iamVjdH0gb2ZmZXIgVGhlIHBhcnNlZCB2YWx1ZSBvZiB0aGUgYHNlYy13ZWJzb2NrZXQtZXh0ZW5zaW9uc2AgaGVhZGVyCiAqIEByZXR1cm4ge09iamVjdH0gQWNjZXB0ZWQgZXh0ZW5zaW9ucwogKiBAcHJpdmF0ZQogKi8KZnVuY3Rpb24gYWNjZXB0RXh0ZW5zaW9ucyAob3B0aW9ucywgb2ZmZXIpIHsKICBjb25zdCBwbWQgPSBvcHRpb25zLnBlck1lc3NhZ2VEZWZsYXRlOwogIGNvbnN0IGV4dGVuc2lvbnMgPSB7fTsKCiAgaWYgKHBtZCAmJiBvZmZlcltQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXSkgewogICAgY29uc3QgcGVyTWVzc2FnZURlZmxhdGUgPSBuZXcgUGVyTWVzc2FnZURlZmxhdGUoCiAgICAgIHBtZCAhPT0gdHJ1ZSA/IHBtZCA6IHt9LAogICAgICB0cnVlLAogICAgICBvcHRpb25zLm1heFBheWxvYWQKICAgICk7CgogICAgcGVyTWVzc2FnZURlZmxhdGUuYWNjZXB0KG9mZmVyW1Blck1lc3NhZ2VEZWZsYXRlLmV4dGVuc2lvbk5hbWVdKTsKICAgIGV4dGVuc2lvbnNbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0gPSBwZXJNZXNzYWdlRGVmbGF0ZTsKICB9CgogIHJldHVybiBleHRlbnNpb25zOwp9CgovKioKICogQ2xvc2UgdGhlIGNvbm5lY3Rpb24gd2hlbiBwcmVjb25kaXRpb25zIGFyZSBub3QgZnVsZmlsbGVkLgogKgogKiBAcGFyYW0ge25ldC5Tb2NrZXR9IHNvY2tldCBUaGUgc29ja2V0IG9mIHRoZSB1cGdyYWRlIHJlcXVlc3QKICogQHBhcmFtIHtOdW1iZXJ9IGNvZGUgVGhlIEhUVFAgcmVzcG9uc2Ugc3RhdHVzIGNvZGUKICogQHBhcmFtIHtTdHJpbmd9IFttZXNzYWdlXSBUaGUgSFRUUCByZXNwb25zZSBib2R5CiAqIEBwcml2YXRlCiAqLwpmdW5jdGlvbiBhYm9ydENvbm5lY3Rpb24gKHNvY2tldCwgY29kZSwgbWVzc2FnZSkgewogIGlmIChzb2NrZXQud3JpdGFibGUpIHsKICAgIG1lc3NhZ2UgPSBtZXNzYWdlIHx8IGh0dHAuU1RBVFVTX0NPREVTW2NvZGVdOwogICAgc29ja2V0LndyaXRlKAogICAgICBgSFRUUC8xLjEgJHtjb2RlfSAke2h0dHAuU1RBVFVTX0NPREVTW2NvZGVdfVxyXG5gICsKICAgICAgJ0Nvbm5lY3Rpb246IGNsb3NlXHJcbicgKwogICAgICAnQ29udGVudC10eXBlOiB0ZXh0L2h0bWxcclxuJyArCiAgICAgIGBDb250ZW50LUxlbmd0aDogJHtCdWZmZXIuYnl0ZUxlbmd0aChtZXNzYWdlKX1cclxuYCArCiAgICAgICdcclxuJyArCiAgICAgIG1lc3NhZ2UKICAgICk7CiAgfQoKICBzb2NrZXQucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgc29ja2V0RXJyb3IpOwogIHNvY2tldC5kZXN0cm95KCk7Cn0KCgovKioqLyB9KSwKLyogNDcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCJidWZmZXIiKTsKCi8qKiovIH0pLAovKiA0OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoImZzIik7CgovKioqLyB9KSwKLyogNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCJodHRwcyIpOwoKLyoqKi8gfSksCi8qIDUwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgicGF0aCIpOwoKLyoqKi8gfSksCi8qIDUxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgiemxpYiIpOwoKLyoqKi8gfSkKLyoqKioqKi8gXSk7Cn0pOwo=",
      "sourceCodeClassname": "VertxProtoStubNode",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-38b3da70-28d4-8082-38f1-b1709f6ee7691",
    "version": 1.9000000000000006,
    "description": "Description of VertxProtoStubNode",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "default",
    "configuration": {
      "url": "wss://msg-node.hysmart.rethink.ptinovacao.pt/localhost/ws"
    },
    "messageSchemas": "",
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": {
      "node": true
    },
    "dataObjects": [],
    "interworking": false
  },
  "P2PHandlerProtoStub": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBTRFAgaGVscGVycy4KdmFyIFNEUFV0aWxzID0ge307CgovLyBHZW5lcmF0ZSBhbiBhbHBoYW51bWVyaWMgaWRlbnRpZmllciBmb3IgY25hbWUgb3IgbWlkcy4KLy8gVE9ETzogdXNlIFVVSURzIGluc3RlYWQ/IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2plZC85ODI4ODMKU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCAxMCk7Cn07CgovLyBUaGUgUlRDUCBDTkFNRSB1c2VkIGJ5IGFsbCBwZWVyY29ubmVjdGlvbnMgZnJvbSB0aGUgc2FtZSBKUy4KU0RQVXRpbHMubG9jYWxDTmFtZSA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwoKLy8gU3BsaXRzIFNEUCBpbnRvIGxpbmVzLCBkZWFsaW5nIHdpdGggYm90aCBDUkxGIGFuZCBMRi4KU0RQVXRpbHMuc3BsaXRMaW5lcyA9IGZ1bmN0aW9uKGJsb2IpIHsKICByZXR1cm4gYmxvYi50cmltKCkuc3BsaXQoJ1xuJykubWFwKGZ1bmN0aW9uKGxpbmUpIHsKICAgIHJldHVybiBsaW5lLnRyaW0oKTsKICB9KTsKfTsKLy8gU3BsaXRzIFNEUCBpbnRvIHNlc3Npb25wYXJ0IGFuZCBtZWRpYXNlY3Rpb25zLiBFbnN1cmVzIENSTEYuClNEUFV0aWxzLnNwbGl0U2VjdGlvbnMgPSBmdW5jdGlvbihibG9iKSB7CiAgdmFyIHBhcnRzID0gYmxvYi5zcGxpdCgnXG5tPScpOwogIHJldHVybiBwYXJ0cy5tYXAoZnVuY3Rpb24ocGFydCwgaW5kZXgpIHsKICAgIHJldHVybiAoaW5kZXggPiAwID8gJ209JyArIHBhcnQgOiBwYXJ0KS50cmltKCkgKyAnXHJcbic7CiAgfSk7Cn07CgovLyBSZXR1cm5zIGxpbmVzIHRoYXQgc3RhcnQgd2l0aCBhIGNlcnRhaW4gcHJlZml4LgpTRFBVdGlscy5tYXRjaFByZWZpeCA9IGZ1bmN0aW9uKGJsb2IsIHByZWZpeCkgewogIHJldHVybiBTRFBVdGlscy5zcGxpdExpbmVzKGJsb2IpLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gbGluZS5pbmRleE9mKHByZWZpeCkgPT09IDA7CiAgfSk7Cn07CgovLyBQYXJzZXMgYW4gSUNFIGNhbmRpZGF0ZSBsaW5lLiBTYW1wbGUgaW5wdXQ6Ci8vIGNhbmRpZGF0ZTo3MDI3ODYzNTAgMiB1ZHAgNDE4MTk5MDIgOC44LjguOCA2MDc2OSB0eXAgcmVsYXkgcmFkZHIgOC44LjguOAovLyBycG9ydCA1NTk5NiIKU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzOwogIC8vIFBhcnNlIGJvdGggdmFyaWFudHMuCiAgaWYgKGxpbmUuaW5kZXhPZignYT1jYW5kaWRhdGU6JykgPT09IDApIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTIpLnNwbGl0KCcgJyk7CiAgfSBlbHNlIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTApLnNwbGl0KCcgJyk7CiAgfQoKICB2YXIgY2FuZGlkYXRlID0gewogICAgZm91bmRhdGlvbjogcGFydHNbMF0sCiAgICBjb21wb25lbnQ6IHBhcnRzWzFdLAogICAgcHJvdG9jb2w6IHBhcnRzWzJdLnRvTG93ZXJDYXNlKCksCiAgICBwcmlvcml0eTogcGFyc2VJbnQocGFydHNbM10sIDEwKSwKICAgIGlwOiBwYXJ0c1s0XSwKICAgIHBvcnQ6IHBhcnNlSW50KHBhcnRzWzVdLCAxMCksCiAgICAvLyBza2lwIHBhcnRzWzZdID09ICd0eXAnCiAgICB0eXBlOiBwYXJ0c1s3XQogIH07CgogIGZvciAodmFyIGkgPSA4OyBpIDwgcGFydHMubGVuZ3RoOyBpICs9IDIpIHsKICAgIHN3aXRjaCAocGFydHNbaV0pIHsKICAgICAgY2FzZSAncmFkZHInOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAncnBvcnQnOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCA9IHBhcnNlSW50KHBhcnRzW2kgKyAxXSwgMTApOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICd0Y3B0eXBlJzoKICAgICAgICBjYW5kaWRhdGUudGNwVHlwZSA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDogLy8gVW5rbm93biBleHRlbnNpb25zIGFyZSBzaWxlbnRseSBpZ25vcmVkLgogICAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gY2FuZGlkYXRlOwp9OwoKLy8gVHJhbnNsYXRlcyBhIGNhbmRpZGF0ZSBvYmplY3QgaW50byBTRFAgY2FuZGlkYXRlIGF0dHJpYnV0ZS4KU0RQVXRpbHMud3JpdGVDYW5kaWRhdGUgPSBmdW5jdGlvbihjYW5kaWRhdGUpIHsKICB2YXIgc2RwID0gW107CiAgc2RwLnB1c2goY2FuZGlkYXRlLmZvdW5kYXRpb24pOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5jb21wb25lbnQpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5wcm90b2NvbC50b1VwcGVyQ2FzZSgpKTsKICBzZHAucHVzaChjYW5kaWRhdGUucHJpb3JpdHkpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5pcCk7CiAgc2RwLnB1c2goY2FuZGlkYXRlLnBvcnQpOwoKICB2YXIgdHlwZSA9IGNhbmRpZGF0ZS50eXBlOwogIHNkcC5wdXNoKCd0eXAnKTsKICBzZHAucHVzaCh0eXBlKTsKICBpZiAodHlwZSAhPT0gJ2hvc3QnICYmIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyAmJgogICAgICBjYW5kaWRhdGUucmVsYXRlZFBvcnQpIHsKICAgIHNkcC5wdXNoKCdyYWRkcicpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnJlbGF0ZWRBZGRyZXNzKTsgLy8gd2FzOiByZWxBZGRyCiAgICBzZHAucHVzaCgncnBvcnQnKTsKICAgIHNkcC5wdXNoKGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCk7IC8vIHdhczogcmVsUG9ydAogIH0KICBpZiAoY2FuZGlkYXRlLnRjcFR5cGUgJiYgY2FuZGlkYXRlLnByb3RvY29sLnRvTG93ZXJDYXNlKCkgPT09ICd0Y3AnKSB7CiAgICBzZHAucHVzaCgndGNwdHlwZScpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnRjcFR5cGUpOwogIH0KICByZXR1cm4gJ2NhbmRpZGF0ZTonICsgc2RwLmpvaW4oJyAnKTsKfTsKCi8vIFBhcnNlcyBhbiBydHBtYXAgbGluZSwgcmV0dXJucyBSVENSdHBDb2RkZWNQYXJhbWV0ZXJzLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9cnRwbWFwOjExMSBvcHVzLzQ4MDAwLzIKU0RQVXRpbHMucGFyc2VSdHBNYXAgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIoOSkuc3BsaXQoJyAnKTsKICB2YXIgcGFyc2VkID0gewogICAgcGF5bG9hZFR5cGU6IHBhcnNlSW50KHBhcnRzLnNoaWZ0KCksIDEwKSAvLyB3YXM6IGlkCiAgfTsKCiAgcGFydHMgPSBwYXJ0c1swXS5zcGxpdCgnLycpOwoKICBwYXJzZWQubmFtZSA9IHBhcnRzWzBdOwogIHBhcnNlZC5jbG9ja1JhdGUgPSBwYXJzZUludChwYXJ0c1sxXSwgMTApOyAvLyB3YXM6IGNsb2NrcmF0ZQogIC8vIHdhczogY2hhbm5lbHMKICBwYXJzZWQubnVtQ2hhbm5lbHMgPSBwYXJ0cy5sZW5ndGggPT09IDMgPyBwYXJzZUludChwYXJ0c1syXSwgMTApIDogMTsKICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGUgYW4gYT1ydHBtYXAgbGluZSBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvcgovLyBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRwTWFwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgcmV0dXJuICdhPXJ0cG1hcDonICsgcHQgKyAnICcgKyBjb2RlYy5uYW1lICsgJy8nICsgY29kZWMuY2xvY2tSYXRlICsKICAgICAgKGNvZGVjLm51bUNoYW5uZWxzICE9PSAxID8gJy8nICsgY29kZWMubnVtQ2hhbm5lbHMgOiAnJykgKyAnXHJcbic7Cn07CgovLyBQYXJzZXMgYW4gYT1leHRtYXAgbGluZSAoaGVhZGVyZXh0ZW5zaW9uIGZyb20gUkZDIDUyODUpLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9ZXh0bWFwOjIgdXJuOmlldGY6cGFyYW1zOnJ0cC1oZHJleHQ6dG9mZnNldApTRFBVdGlscy5wYXJzZUV4dG1hcCA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cig5KS5zcGxpdCgnICcpOwogIHJldHVybiB7CiAgICBpZDogcGFyc2VJbnQocGFydHNbMF0sIDEwKSwKICAgIHVyaTogcGFydHNbMV0KICB9Owp9OwoKLy8gR2VuZXJhdGVzIGE9ZXh0bWFwIGxpbmUgZnJvbSBSVENSdHBIZWFkZXJFeHRlbnNpb25QYXJhbWV0ZXJzIG9yCi8vIFJUQ1J0cEhlYWRlckV4dGVuc2lvbi4KU0RQVXRpbHMud3JpdGVFeHRtYXAgPSBmdW5jdGlvbihoZWFkZXJFeHRlbnNpb24pIHsKICByZXR1cm4gJ2E9ZXh0bWFwOicgKyAoaGVhZGVyRXh0ZW5zaW9uLmlkIHx8IGhlYWRlckV4dGVuc2lvbi5wcmVmZXJyZWRJZCkgKwogICAgICAgJyAnICsgaGVhZGVyRXh0ZW5zaW9uLnVyaSArICdcclxuJzsKfTsKCi8vIFBhcnNlcyBhbiBmdG1wIGxpbmUsIHJldHVybnMgZGljdGlvbmFyeS4gU2FtcGxlIGlucHV0OgovLyBhPWZtdHA6OTYgdmJyPW9uO2NuZz1vbgovLyBBbHNvIGRlYWxzIHdpdGggdmJyPW9uOyBjbmc9b24KU0RQVXRpbHMucGFyc2VGbXRwID0gZnVuY3Rpb24obGluZSkgewogIHZhciBwYXJzZWQgPSB7fTsKICB2YXIga3Y7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIobGluZS5pbmRleE9mKCcgJykgKyAxKS5zcGxpdCgnOycpOwogIGZvciAodmFyIGogPSAwOyBqIDwgcGFydHMubGVuZ3RoOyBqKyspIHsKICAgIGt2ID0gcGFydHNbal0udHJpbSgpLnNwbGl0KCc9Jyk7CiAgICBwYXJzZWRba3ZbMF0udHJpbSgpXSA9IGt2WzFdOwogIH0KICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGVzIGFuIGE9ZnRtcCBsaW5lIGZyb20gUlRDUnRwQ29kZWNDYXBhYmlsaXR5IG9yIFJUQ1J0cENvZGVjUGFyYW1ldGVycy4KU0RQVXRpbHMud3JpdGVGbXRwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZSA9ICcnOwogIHZhciBwdCA9IGNvZGVjLnBheWxvYWRUeXBlOwogIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICBwdCA9IGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlOwogIH0KICBpZiAoY29kZWMucGFyYW1ldGVycyAmJiBPYmplY3Qua2V5cyhjb2RlYy5wYXJhbWV0ZXJzKS5sZW5ndGgpIHsKICAgIHZhciBwYXJhbXMgPSBbXTsKICAgIE9iamVjdC5rZXlzKGNvZGVjLnBhcmFtZXRlcnMpLmZvckVhY2goZnVuY3Rpb24ocGFyYW0pIHsKICAgICAgcGFyYW1zLnB1c2gocGFyYW0gKyAnPScgKyBjb2RlYy5wYXJhbWV0ZXJzW3BhcmFtXSk7CiAgICB9KTsKICAgIGxpbmUgKz0gJ2E9Zm10cDonICsgcHQgKyAnICcgKyBwYXJhbXMuam9pbignOycpICsgJ1xyXG4nOwogIH0KICByZXR1cm4gbGluZTsKfTsKCi8vIFBhcnNlcyBhbiBydGNwLWZiIGxpbmUsIHJldHVybnMgUlRDUFJ0Y3BGZWVkYmFjayBvYmplY3QuIFNhbXBsZSBpbnB1dDoKLy8gYT1ydGNwLWZiOjk4IG5hY2sgcnBzaQpTRFBVdGlscy5wYXJzZVJ0Y3BGYiA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cihsaW5lLmluZGV4T2YoJyAnKSArIDEpLnNwbGl0KCcgJyk7CiAgcmV0dXJuIHsKICAgIHR5cGU6IHBhcnRzLnNoaWZ0KCksCiAgICBwYXJhbWV0ZXI6IHBhcnRzLmpvaW4oJyAnKQogIH07Cn07Ci8vIEdlbmVyYXRlIGE9cnRjcC1mYiBsaW5lcyBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvciBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRjcEZiID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZXMgPSAnJzsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgaWYgKGNvZGVjLnJ0Y3BGZWVkYmFjayAmJiBjb2RlYy5ydGNwRmVlZGJhY2subGVuZ3RoKSB7CiAgICAvLyBGSVhNRTogc3BlY2lhbCBoYW5kbGluZyBmb3IgdHJyLWludD8KICAgIGNvZGVjLnJ0Y3BGZWVkYmFjay5mb3JFYWNoKGZ1bmN0aW9uKGZiKSB7CiAgICAgIGxpbmVzICs9ICdhPXJ0Y3AtZmI6JyArIHB0ICsgJyAnICsgZmIudHlwZSArCiAgICAgIChmYi5wYXJhbWV0ZXIgJiYgZmIucGFyYW1ldGVyLmxlbmd0aCA/ICcgJyArIGZiLnBhcmFtZXRlciA6ICcnKSArCiAgICAgICAgICAnXHJcbic7CiAgICB9KTsKICB9CiAgcmV0dXJuIGxpbmVzOwp9OwoKLy8gUGFyc2VzIGFuIFJGQyA1NTc2IHNzcmMgbWVkaWEgYXR0cmlidXRlLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9c3NyYzozNzM1OTI4NTU5IGNuYW1lOnNvbWV0aGluZwpTRFBVdGlscy5wYXJzZVNzcmNNZWRpYSA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgc3AgPSBsaW5lLmluZGV4T2YoJyAnKTsKICB2YXIgcGFydHMgPSB7CiAgICBzc3JjOiBwYXJzZUludChsaW5lLnN1YnN0cig3LCBzcCAtIDcpLCAxMCkKICB9OwogIHZhciBjb2xvbiA9IGxpbmUuaW5kZXhPZignOicsIHNwKTsKICBpZiAoY29sb24gPiAtMSkgewogICAgcGFydHMuYXR0cmlidXRlID0gbGluZS5zdWJzdHIoc3AgKyAxLCBjb2xvbiAtIHNwIC0gMSk7CiAgICBwYXJ0cy52YWx1ZSA9IGxpbmUuc3Vic3RyKGNvbG9uICsgMSk7CiAgfSBlbHNlIHsKICAgIHBhcnRzLmF0dHJpYnV0ZSA9IGxpbmUuc3Vic3RyKHNwICsgMSk7CiAgfQogIHJldHVybiBwYXJ0czsKfTsKCi8vIEV4dHJhY3RzIERUTFMgcGFyYW1ldGVycyBmcm9tIFNEUCBtZWRpYSBzZWN0aW9uIG9yIHNlc3Npb25wYXJ0LgovLyBGSVhNRTogZm9yIGNvbnNpc3RlbmN5IHdpdGggb3RoZXIgZnVuY3Rpb25zIHRoaXMgc2hvdWxkIG9ubHkKLy8gICBnZXQgdGhlIGZpbmdlcnByaW50IGxpbmUgYXMgaW5wdXQuIFNlZSBhbHNvIGdldEljZVBhcmFtZXRlcnMuClNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBmcExpbmUgPSBsaW5lcy5maWx0ZXIoZnVuY3Rpb24obGluZSkgewogICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1maW5nZXJwcmludDonKSA9PT0gMDsKICB9KVswXS5zdWJzdHIoMTQpOwogIC8vIE5vdGU6IGE9c2V0dXAgbGluZSBpcyBpZ25vcmVkIHNpbmNlIHdlIHVzZSB0aGUgJ2F1dG8nIHJvbGUuCiAgdmFyIGR0bHNQYXJhbWV0ZXJzID0gewogICAgcm9sZTogJ2F1dG8nLAogICAgZmluZ2VycHJpbnRzOiBbewogICAgICBhbGdvcml0aG06IGZwTGluZS5zcGxpdCgnICcpWzBdLAogICAgICB2YWx1ZTogZnBMaW5lLnNwbGl0KCcgJylbMV0KICAgIH1dCiAgfTsKICByZXR1cm4gZHRsc1BhcmFtZXRlcnM7Cn07CgovLyBTZXJpYWxpemVzIERUTFMgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMgPSBmdW5jdGlvbihwYXJhbXMsIHNldHVwVHlwZSkgewogIHZhciBzZHAgPSAnYT1zZXR1cDonICsgc2V0dXBUeXBlICsgJ1xyXG4nOwogIHBhcmFtcy5maW5nZXJwcmludHMuZm9yRWFjaChmdW5jdGlvbihmcCkgewogICAgc2RwICs9ICdhPWZpbmdlcnByaW50OicgKyBmcC5hbGdvcml0aG0gKyAnICcgKyBmcC52YWx1ZSArICdcclxuJzsKICB9KTsKICByZXR1cm4gc2RwOwp9OwovLyBQYXJzZXMgSUNFIGluZm9ybWF0aW9uIGZyb20gU0RQIG1lZGlhIHNlY3Rpb24gb3Igc2Vzc2lvbnBhcnQuCi8vIEZJWE1FOiBmb3IgY29uc2lzdGVuY3kgd2l0aCBvdGhlciBmdW5jdGlvbnMgdGhpcyBzaG91bGQgb25seQovLyAgIGdldCB0aGUgaWNlLXVmcmFnIGFuZCBpY2UtcHdkIGxpbmVzIGFzIGlucHV0LgpTRFBVdGlscy5nZXRJY2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBpY2VQYXJhbWV0ZXJzID0gewogICAgdXNlcm5hbWVGcmFnbWVudDogbGluZXMuZmlsdGVyKGZ1bmN0aW9uKGxpbmUpIHsKICAgICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1pY2UtdWZyYWc6JykgPT09IDA7CiAgICB9KVswXS5zdWJzdHIoMTIpLAogICAgcGFzc3dvcmQ6IGxpbmVzLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICAgIHJldHVybiBsaW5lLmluZGV4T2YoJ2E9aWNlLXB3ZDonKSA9PT0gMDsKICAgIH0pWzBdLnN1YnN0cigxMCkKICB9OwogIHJldHVybiBpY2VQYXJhbWV0ZXJzOwp9OwoKLy8gU2VyaWFsaXplcyBJQ0UgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlSWNlUGFyYW1ldGVycyA9IGZ1bmN0aW9uKHBhcmFtcykgewogIHJldHVybiAnYT1pY2UtdWZyYWc6JyArIHBhcmFtcy51c2VybmFtZUZyYWdtZW50ICsgJ1xyXG4nICsKICAgICAgJ2E9aWNlLXB3ZDonICsgcGFyYW1zLnBhc3N3b3JkICsgJ1xyXG4nOwp9OwoKLy8gUGFyc2VzIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBhbmQgcmV0dXJucyBSVENSdHBQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHsKICB2YXIgZGVzY3JpcHRpb24gPSB7CiAgICBjb2RlY3M6IFtdLAogICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICBmZWNNZWNoYW5pc21zOiBbXSwKICAgIHJ0Y3A6IFtdCiAgfTsKICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7CiAgdmFyIG1saW5lID0gbGluZXNbMF0uc3BsaXQoJyAnKTsKICBmb3IgKHZhciBpID0gMzsgaSA8IG1saW5lLmxlbmd0aDsgaSsrKSB7IC8vIGZpbmQgYWxsIGNvZGVjcyBmcm9tIG1saW5lWzMuLl0KICAgIHZhciBwdCA9IG1saW5lW2ldOwogICAgdmFyIHJ0cG1hcGxpbmUgPSBTRFBVdGlscy5tYXRjaFByZWZpeCgKICAgICAgICBtZWRpYVNlY3Rpb24sICdhPXJ0cG1hcDonICsgcHQgKyAnICcpWzBdOwogICAgaWYgKHJ0cG1hcGxpbmUpIHsKICAgICAgdmFyIGNvZGVjID0gU0RQVXRpbHMucGFyc2VSdHBNYXAocnRwbWFwbGluZSk7CiAgICAgIHZhciBmbXRwcyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1mbXRwOicgKyBwdCArICcgJyk7CiAgICAgIC8vIE9ubHkgdGhlIGZpcnN0IGE9Zm10cDo8cHQ+IGlzIGNvbnNpZGVyZWQuCiAgICAgIGNvZGVjLnBhcmFtZXRlcnMgPSBmbXRwcy5sZW5ndGggPyBTRFBVdGlscy5wYXJzZUZtdHAoZm10cHNbMF0pIDoge307CiAgICAgIGNvZGVjLnJ0Y3BGZWVkYmFjayA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1ydGNwLWZiOicgKyBwdCArICcgJykKICAgICAgICAubWFwKFNEUFV0aWxzLnBhcnNlUnRjcEZiKTsKICAgICAgZGVzY3JpcHRpb24uY29kZWNzLnB1c2goY29kZWMpOwogICAgICAvLyBwYXJzZSBGRUMgbWVjaGFuaXNtcyBmcm9tIHJ0cG1hcCBsaW5lcy4KICAgICAgc3dpdGNoIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkpIHsKICAgICAgICBjYXNlICdSRUQnOgogICAgICAgIGNhc2UgJ1VMUEZFQyc6CiAgICAgICAgICBkZXNjcmlwdGlvbi5mZWNNZWNoYW5pc21zLnB1c2goY29kZWMubmFtZS50b1VwcGVyQ2FzZSgpKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IC8vIG9ubHkgUkVEIGFuZCBVTFBGRUMgYXJlIHJlY29nbml6ZWQgYXMgRkVDIG1lY2hhbmlzbXMuCiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0KICBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPWV4dG1hcDonKS5mb3JFYWNoKGZ1bmN0aW9uKGxpbmUpIHsKICAgIGRlc2NyaXB0aW9uLmhlYWRlckV4dGVuc2lvbnMucHVzaChTRFBVdGlscy5wYXJzZUV4dG1hcChsaW5lKSk7CiAgfSk7CiAgLy8gRklYTUU6IHBhcnNlIHJ0Y3AuCiAgcmV0dXJuIGRlc2NyaXB0aW9uOwp9OwoKLy8gR2VuZXJhdGVzIHBhcnRzIG9mIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBkZXNjcmliaW5nIHRoZSBjYXBhYmlsaXRpZXMgLwovLyBwYXJhbWV0ZXJzLgpTRFBVdGlscy53cml0ZVJ0cERlc2NyaXB0aW9uID0gZnVuY3Rpb24oa2luZCwgY2FwcykgewogIHZhciBzZHAgPSAnJzsKCiAgLy8gQnVpbGQgdGhlIG1saW5lLgogIHNkcCArPSAnbT0nICsga2luZCArICcgJzsKICBzZHAgKz0gY2Fwcy5jb2RlY3MubGVuZ3RoID4gMCA/ICc5JyA6ICcwJzsgLy8gcmVqZWN0IGlmIG5vIGNvZGVjcy4KICBzZHAgKz0gJyBVRFAvVExTL1JUUC9TQVZQRiAnOwogIHNkcCArPSBjYXBzLmNvZGVjcy5tYXAoZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICAgIH0KICAgIHJldHVybiBjb2RlYy5wYXlsb2FkVHlwZTsKICB9KS5qb2luKCcgJykgKyAnXHJcbic7CgogIHNkcCArPSAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nOwogIHNkcCArPSAnYT1ydGNwOjkgSU4gSVA0IDAuMC4wLjBcclxuJzsKCiAgLy8gQWRkIGE9cnRwbWFwIGxpbmVzIGZvciBlYWNoIGNvZGVjLiBBbHNvIGZtdHAgYW5kIHJ0Y3AtZmIuCiAgY2Fwcy5jb2RlY3MuZm9yRWFjaChmdW5jdGlvbihjb2RlYykgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRwTWFwKGNvZGVjKTsKICAgIHNkcCArPSBTRFBVdGlscy53cml0ZUZtdHAoY29kZWMpOwogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRjcEZiKGNvZGVjKTsKICB9KTsKICB2YXIgbWF4cHRpbWUgPSAwOwogIGNhcHMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5tYXhwdGltZSA+IG1heHB0aW1lKSB7CiAgICAgIG1heHB0aW1lID0gY29kZWMubWF4cHRpbWU7CiAgICB9CiAgfSk7CiAgaWYgKG1heHB0aW1lID4gMCkgewogICAgc2RwICs9ICdhPW1heHB0aW1lOicgKyBtYXhwdGltZSArICdcclxuJzsKICB9CiAgc2RwICs9ICdhPXJ0Y3AtbXV4XHJcbic7CgogIGNhcHMuaGVhZGVyRXh0ZW5zaW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGV4dGVuc2lvbikgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlRXh0bWFwKGV4dGVuc2lvbik7CiAgfSk7CiAgLy8gRklYTUU6IHdyaXRlIGZlY01lY2hhbmlzbXMuCiAgcmV0dXJuIHNkcDsKfTsKCi8vIFBhcnNlcyB0aGUgU0RQIG1lZGlhIHNlY3Rpb24gYW5kIHJldHVybnMgYW4gYXJyYXkgb2YKLy8gUlRDUnRwRW5jb2RpbmdQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cEVuY29kaW5nUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikgewogIHZhciBlbmNvZGluZ1BhcmFtZXRlcnMgPSBbXTsKICB2YXIgZGVzY3JpcHRpb24gPSBTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMobWVkaWFTZWN0aW9uKTsKICB2YXIgaGFzUmVkID0gZGVzY3JpcHRpb24uZmVjTWVjaGFuaXNtcy5pbmRleE9mKCdSRUQnKSAhPT0gLTE7CiAgdmFyIGhhc1VscGZlYyA9IGRlc2NyaXB0aW9uLmZlY01lY2hhbmlzbXMuaW5kZXhPZignVUxQRkVDJykgIT09IC0xOwoKICAvLyBmaWx0ZXIgYT1zc3JjOi4uLiBjbmFtZTosIGlnbm9yZSBQbGFuQi1tc2lkCiAgdmFyIHNzcmNzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjOicpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgfSkKICAuZmlsdGVyKGZ1bmN0aW9uKHBhcnRzKSB7CiAgICByZXR1cm4gcGFydHMuYXR0cmlidXRlID09PSAnY25hbWUnOwogIH0pOwogIHZhciBwcmltYXJ5U3NyYyA9IHNzcmNzLmxlbmd0aCA+IDAgJiYgc3NyY3NbMF0uc3NyYzsKICB2YXIgc2Vjb25kYXJ5U3NyYzsKCiAgdmFyIGZsb3dzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjLWdyb3VwOkZJRCcpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICB2YXIgcGFydHMgPSBsaW5lLnNwbGl0KCcgJyk7CiAgICBwYXJ0cy5zaGlmdCgpOwogICAgcmV0dXJuIHBhcnRzLm1hcChmdW5jdGlvbihwYXJ0KSB7CiAgICAgIHJldHVybiBwYXJzZUludChwYXJ0LCAxMCk7CiAgICB9KTsKICB9KTsKICBpZiAoZmxvd3MubGVuZ3RoID4gMCAmJiBmbG93c1swXS5sZW5ndGggPiAxICYmIGZsb3dzWzBdWzBdID09PSBwcmltYXJ5U3NyYykgewogICAgc2Vjb25kYXJ5U3NyYyA9IGZsb3dzWzBdWzFdOwogIH0KCiAgZGVzY3JpcHRpb24uY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkgPT09ICdSVFgnICYmIGNvZGVjLnBhcmFtZXRlcnMuYXB0KSB7CiAgICAgIHZhciBlbmNQYXJhbSA9IHsKICAgICAgICBzc3JjOiBwcmltYXJ5U3NyYywKICAgICAgICBjb2RlY1BheWxvYWRUeXBlOiBwYXJzZUludChjb2RlYy5wYXJhbWV0ZXJzLmFwdCwgMTApLAogICAgICAgIHJ0eDogewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYwogICAgICAgIH0KICAgICAgfTsKICAgICAgZW5jb2RpbmdQYXJhbWV0ZXJzLnB1c2goZW5jUGFyYW0pOwogICAgICBpZiAoaGFzUmVkKSB7CiAgICAgICAgZW5jUGFyYW0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVuY1BhcmFtKSk7CiAgICAgICAgZW5jUGFyYW0uZmVjID0gewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYywKICAgICAgICAgIG1lY2hhbmlzbTogaGFzVWxwZmVjID8gJ3JlZCt1bHBmZWMnIDogJ3JlZCcKICAgICAgICB9OwogICAgICAgIGVuY29kaW5nUGFyYW1ldGVycy5wdXNoKGVuY1BhcmFtKTsKICAgICAgfQogICAgfQogIH0pOwogIGlmIChlbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoID09PSAwICYmIHByaW1hcnlTc3JjKSB7CiAgICBlbmNvZGluZ1BhcmFtZXRlcnMucHVzaCh7CiAgICAgIHNzcmM6IHByaW1hcnlTc3JjCiAgICB9KTsKICB9CgogIC8vIHdlIHN1cHBvcnQgYm90aCBiPUFTIGFuZCBiPVRJQVMgYnV0IGludGVycHJldCBBUyBhcyBUSUFTLgogIHZhciBiYW5kd2lkdGggPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdiPScpOwogIGlmIChiYW5kd2lkdGgubGVuZ3RoKSB7CiAgICBpZiAoYmFuZHdpZHRoWzBdLmluZGV4T2YoJ2I9VElBUzonKSA9PT0gMCkgewogICAgICBiYW5kd2lkdGggPSBwYXJzZUludChiYW5kd2lkdGhbMF0uc3Vic3RyKDcpLCAxMCk7CiAgICB9IGVsc2UgaWYgKGJhbmR3aWR0aFswXS5pbmRleE9mKCdiPUFTOicpID09PSAwKSB7CiAgICAgIGJhbmR3aWR0aCA9IHBhcnNlSW50KGJhbmR3aWR0aFswXS5zdWJzdHIoNSksIDEwKTsKICAgIH0KICAgIGVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtcykgewogICAgICBwYXJhbXMubWF4Qml0cmF0ZSA9IGJhbmR3aWR0aDsKICAgIH0pOwogIH0KICByZXR1cm4gZW5jb2RpbmdQYXJhbWV0ZXJzOwp9OwoKU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUgPSBmdW5jdGlvbigpIHsKICAvLyBGSVhNRTogc2Vzcy1pZCBzaG91bGQgYmUgYW4gTlRQIHRpbWVzdGFtcC4KICByZXR1cm4gJ3Y9MFxyXG4nICsKICAgICAgJ289dGhpc2lzYWRhcHRlcm9ydGMgODE2OTYzOTkxNTY0Njk0MzEzNyAyIElOIElQNCAxMjcuMC4wLjFcclxuJyArCiAgICAgICdzPS1cclxuJyArCiAgICAgICd0PTAgMFxyXG4nOwp9OwoKU0RQVXRpbHMud3JpdGVNZWRpYVNlY3Rpb24gPSBmdW5jdGlvbih0cmFuc2NlaXZlciwgY2FwcywgdHlwZSwgc3RyZWFtKSB7CiAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlUnRwRGVzY3JpcHRpb24odHJhbnNjZWl2ZXIua2luZCwgY2Fwcyk7CgogIC8vIE1hcCBJQ0UgcGFyYW1ldGVycyAodWZyYWcsIHB3ZCkgdG8gU0RQLgogIHNkcCArPSBTRFBVdGlscy53cml0ZUljZVBhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmdldExvY2FsUGFyYW1ldGVycygpKTsKCiAgLy8gTWFwIERUTFMgcGFyYW1ldGVycyB0byBTRFAuCiAgc2RwICs9IFNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuZ2V0TG9jYWxQYXJhbWV0ZXJzKCksCiAgICAgIHR5cGUgPT09ICdvZmZlcicgPyAnYWN0cGFzcycgOiAnYWN0aXZlJyk7CgogIHNkcCArPSAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlciAmJiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcikgewogICAgc2RwICs9ICdhPXNlbmRyZWN2XHJcbic7CiAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHsKICAgIHNkcCArPSAnYT1zZW5kb25seVxyXG4nOwogIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgIHNkcCArPSAnYT1yZWN2b25seVxyXG4nOwogIH0gZWxzZSB7CiAgICBzZHAgKz0gJ2E9aW5hY3RpdmVcclxuJzsKICB9CgogIC8vIEZJWE1FOiBmb3IgUlRYIHRoZXJlIG1pZ2h0IGJlIG11bHRpcGxlIFNTUkNzLiBOb3QgaW1wbGVtZW50ZWQgaW4gRWRnZSB5ZXQuCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlcikgewogICAgdmFyIG1zaWQgPSAnbXNpZDonICsgc3RyZWFtLmlkICsgJyAnICsKICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIudHJhY2suaWQgKyAnXHJcbic7CiAgICBzZHAgKz0gJ2E9JyArIG1zaWQ7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgICAnICcgKyBtc2lkOwogICAgaWYgKHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICAgIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICcgJyArIG1zaWQ7CiAgICAgIHNkcCArPSAnYT1zc3JjLWdyb3VwOkZJRCAnICsKICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYyArICcgJyArCiAgICAgICAgICB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICdcclxuJzsKICAgIH0KICB9CiAgLy8gRklYTUU6IHRoaXMgc2hvdWxkIGJlIHdyaXR0ZW4gYnkgd3JpdGVSdHBEZXNjcmlwdGlvbi4KICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHguc3NyYyArCiAgICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICB9CiAgcmV0dXJuIHNkcDsKfTsKCi8vIEdldHMgdGhlIGRpcmVjdGlvbiBmcm9tIHRoZSBtZWRpYVNlY3Rpb24gb3IgdGhlIHNlc3Npb25wYXJ0LgpTRFBVdGlscy5nZXREaXJlY3Rpb24gPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KSB7CiAgLy8gTG9vayBmb3Igc2VuZHJlY3YsIHNlbmRvbmx5LCByZWN2b25seSwgaW5hY3RpdmUsIGRlZmF1bHQgdG8gc2VuZHJlY3YuCiAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHsKICAgIHN3aXRjaCAobGluZXNbaV0pIHsKICAgICAgY2FzZSAnYT1zZW5kcmVjdic6CiAgICAgIGNhc2UgJ2E9c2VuZG9ubHknOgogICAgICBjYXNlICdhPXJlY3Zvbmx5JzoKICAgICAgY2FzZSAnYT1pbmFjdGl2ZSc6CiAgICAgICAgcmV0dXJuIGxpbmVzW2ldLnN1YnN0cigyKTsKICAgICAgZGVmYXVsdDoKICAgICAgICAvLyBGSVhNRTogV2hhdCBzaG91bGQgaGFwcGVuIGhlcmU/CiAgICB9CiAgfQogIGlmIChzZXNzaW9ucGFydCkgewogICAgcmV0dXJuIFNEUFV0aWxzLmdldERpcmVjdGlvbihzZXNzaW9ucGFydCk7CiAgfQogIHJldHVybiAnc2VuZHJlY3YnOwp9OwoKLy8gRXhwb3NlIHB1YmxpYyBtZXRob2RzLgptb2R1bGUuZXhwb3J0cyA9IFNEUFV0aWxzOwoKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8vIHZlcnNpb246IDAuNS4xCi8vIGRhdGU6IFR1ZSBGZWIgMDcgMjAxNyAxNjowMDozOSBHTVQrMDAwMCAoV0VUKQovLyBsaWNlbmNlOiAKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgoKKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiU3luY2hlciIsIFtdLCBmYWN0b3J5KTsKCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCWV4cG9ydHNbIlN5bmNoZXIiXSA9IGZhY3RvcnkoKTsKCWVsc2UKCQlyb290WyIiXSA9IHJvb3RbIiJdIHx8IHt9LCByb290WyIiXVsiU3luY2hlciJdID0gZmFjdG9yeSgpOwp9KSh0aGlzLCBmdW5jdGlvbigpIHsKcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXAKLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCXZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307Ci8qKioqKiovCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLwovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQovKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJaTogbW9kdWxlSWQsCi8qKioqKiovIAkJCWw6IGZhbHNlLAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAovKioqKioqLyAJCW1vZHVsZS5sID0gdHJ1ZTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8KLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7Ci8qKioqKiovCi8qKioqKiovIAkvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0Ci8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHMKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikgewovKioqKioqLyAJCWlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKLyoqKioqKi8gCQkJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsKLyoqKioqKi8gCQkJCWNvbmZpZ3VyYWJsZTogZmFsc2UsCi8qKioqKiovIAkJCQllbnVtZXJhYmxlOiB0cnVlLAovKioqKioqLyAJCQkJZ2V0OiBnZXR0ZXIKLyoqKioqKi8gCQkJfSk7Ci8qKioqKiovIAkJfQovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHsKLyoqKioqKi8gCQl2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID8KLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTsKLyoqKioqKi8gCQlfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7Ci8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKLyoqKioqKi8KLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMTYyKTsKLyoqKioqKi8gfSkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gKFsKLyogMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0ge3ZlcnNpb246ICcyLjQuMCd9OwppZih0eXBlb2YgX19lID09ICdudW1iZXInKV9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy84NiNpc3N1ZWNvbW1lbnQtMTE1NzU5MDI4CnZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aAogID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsKaWYodHlwZW9mIF9fZyA9PSAnbnVtYmVyJylfX2cgPSBnbG9iYWw7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzdG9yZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ3drcycpCiAgLCB1aWQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykKICAsIFN5bWJvbCAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLlN5bWJvbAogICwgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJzsKCnZhciAkZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obmFtZSl7CiAgcmV0dXJuIHN0b3JlW25hbWVdIHx8IChzdG9yZVtuYW1lXSA9CiAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IHVpZCkoJ1N5bWJvbC4nICsgbmFtZSkpOwp9OwoKJGV4cG9ydHMuc3RvcmUgPSBzdG9yZTsKCi8qKiovIH0pLAovKiAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHkKbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGRQICAgICAgICAgICAgID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpewogIGFuT2JqZWN0KE8pOwogIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKICBhbk9iamVjdChBdHRyaWJ1dGVzKTsKICBpZihJRThfRE9NX0RFRklORSl0cnkgewogICAgcmV0dXJuIGRQKE8sIFAsIEF0dHJpYnV0ZXMpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICBpZignZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpdGhyb3cgVHlwZUVycm9yKCdBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEnKTsKICBpZigndmFsdWUnIGluIEF0dHJpYnV0ZXMpT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZighaXNPYmplY3QoaXQpKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKICAsIGNyZWF0ZURlc2MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpID8gZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICByZXR1cm4gZFAuZihvYmplY3QsIGtleSwgY3JlYXRlRGVzYygxLCB2YWx1ZSkpOwp9IDogZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICBvYmplY3Rba2V5XSA9IHZhbHVlOwogIHJldHVybiBvYmplY3Q7Cn07CgovKioqLyB9KSwKLyogNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nOwp9OwoKLyoqKi8gfSksCi8qIDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGNvcmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGN0eCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCiAgLCBoaWRlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCiAgLCBQUk9UT1RZUEUgPSAncHJvdG90eXBlJzsKCnZhciAkZXhwb3J0ID0gZnVuY3Rpb24odHlwZSwgbmFtZSwgc291cmNlKXsKICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRgogICAgLCBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HCiAgICAsIElTX1NUQVRJQyA9IHR5cGUgJiAkZXhwb3J0LlMKICAgICwgSVNfUFJPVE8gID0gdHlwZSAmICRleHBvcnQuUAogICAgLCBJU19CSU5EICAgPSB0eXBlICYgJGV4cG9ydC5CCiAgICAsIElTX1dSQVAgICA9IHR5cGUgJiAkZXhwb3J0LlcKICAgICwgZXhwb3J0cyAgID0gSVNfR0xPQkFMID8gY29yZSA6IGNvcmVbbmFtZV0gfHwgKGNvcmVbbmFtZV0gPSB7fSkKICAgICwgZXhwUHJvdG8gID0gZXhwb3J0c1tQUk9UT1RZUEVdCiAgICAsIHRhcmdldCAgICA9IElTX0dMT0JBTCA/IGdsb2JhbCA6IElTX1NUQVRJQyA/IGdsb2JhbFtuYW1lXSA6IChnbG9iYWxbbmFtZV0gfHwge30pW1BST1RPVFlQRV0KICAgICwga2V5LCBvd24sIG91dDsKICBpZihJU19HTE9CQUwpc291cmNlID0gbmFtZTsKICBmb3Ioa2V5IGluIHNvdXJjZSl7CiAgICAvLyBjb250YWlucyBpbiBuYXRpdmUKICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIHRhcmdldFtrZXldICE9PSB1bmRlZmluZWQ7CiAgICBpZihvd24gJiYga2V5IGluIGV4cG9ydHMpY29udGludWU7CiAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZAogICAgb3V0ID0gb3duID8gdGFyZ2V0W2tleV0gOiBzb3VyY2Vba2V5XTsKICAgIC8vIHByZXZlbnQgZ2xvYmFsIHBvbGx1dGlvbiBmb3IgbmFtZXNwYWNlcwogICAgZXhwb3J0c1trZXldID0gSVNfR0xPQkFMICYmIHR5cGVvZiB0YXJnZXRba2V5XSAhPSAnZnVuY3Rpb24nID8gc291cmNlW2tleV0KICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0CiAgICA6IElTX0JJTkQgJiYgb3duID8gY3R4KG91dCwgZ2xvYmFsKQogICAgLy8gd3JhcCBnbG9iYWwgY29uc3RydWN0b3JzIGZvciBwcmV2ZW50IGNoYW5nZSB0aGVtIGluIGxpYnJhcnkKICAgIDogSVNfV1JBUCAmJiB0YXJnZXRba2V5XSA9PSBvdXQgPyAoZnVuY3Rpb24oQyl7CiAgICAgIHZhciBGID0gZnVuY3Rpb24oYSwgYiwgYyl7CiAgICAgICAgaWYodGhpcyBpbnN0YW5jZW9mIEMpewogICAgICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpewogICAgICAgICAgICBjYXNlIDA6IHJldHVybiBuZXcgQzsKICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gbmV3IEMoYSk7CiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBDKGEsIGIpOwogICAgICAgICAgfSByZXR1cm4gbmV3IEMoYSwgYiwgYyk7CiAgICAgICAgfSByZXR1cm4gQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgICBGW1BST1RPVFlQRV0gPSBDW1BST1RPVFlQRV07CiAgICAgIHJldHVybiBGOwogICAgLy8gbWFrZSBzdGF0aWMgdmVyc2lvbnMgZm9yIHByb3RvdHlwZSBtZXRob2RzCiAgICB9KShvdXQpIDogSVNfUFJPVE8gJiYgdHlwZW9mIG91dCA9PSAnZnVuY3Rpb24nID8gY3R4KEZ1bmN0aW9uLmNhbGwsIG91dCkgOiBvdXQ7CiAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUubWV0aG9kcy4lTkFNRSUKICAgIGlmKElTX1BST1RPKXsKICAgICAgKGV4cG9ydHMudmlydHVhbCB8fCAoZXhwb3J0cy52aXJ0dWFsID0ge30pKVtrZXldID0gb3V0OwogICAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUucHJvdG90eXBlLiVOQU1FJQogICAgICBpZih0eXBlICYgJGV4cG9ydC5SICYmIGV4cFByb3RvICYmICFleHBQcm90b1trZXldKWhpZGUoZXhwUHJvdG8sIGtleSwgb3V0KTsKICAgIH0KICB9Cn07Ci8vIHR5cGUgYml0bWFwCiRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkCiRleHBvcnQuRyA9IDI7ICAgLy8gZ2xvYmFsCiRleHBvcnQuUyA9IDQ7ICAgLy8gc3RhdGljCiRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG8KJGV4cG9ydC5CID0gMTY7ICAvLyBiaW5kCiRleHBvcnQuVyA9IDMyOyAgLy8gd3JhcAokZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmUKJGV4cG9ydC5SID0gMTI4OyAvLyByZWFsIHByb3RvIG1ldGhvZCBmb3IgYGxpYnJhcnlgIAptb2R1bGUuZXhwb3J0cyA9ICRleHBvcnQ7CgovKioqLyB9KSwKLyogOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDEwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMzYpOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZWZpbmVQcm9wZXJ0eSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICAgICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogICAgfQogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICAgIHJldHVybiBDb25zdHJ1Y3RvcjsKICB9Owp9KCk7CgovKioqLyB9KSwKLyogMTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjKXsKICB0cnkgewogICAgcmV0dXJuICEhZXhlYygpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn07CgovKioqLyB9KSwKLyogMTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGhhc093blByb3BlcnR5ID0ge30uaGFzT3duUHJvcGVydHk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIGtleSl7CiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoaXQsIGtleSk7Cn07CgovKioqLyB9KSwKLyogMTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzCnZhciBJT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NikKICAsIGRlZmluZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpOwp9OwoKLyoqKi8gfSksCi8qIDE0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZwp2YXIgYUZ1bmN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIHRoYXQsIGxlbmd0aCl7CiAgYUZ1bmN0aW9uKGZuKTsKICBpZih0aGF0ID09PSB1bmRlZmluZWQpcmV0dXJuIGZuOwogIHN3aXRjaChsZW5ndGgpewogICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpOwogICAgfTsKICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTsKICAgIH07CiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7CiAgICB9OwogIH0KICByZXR1cm4gZnVuY3Rpb24oLyogLi4uYXJncyAqLyl7CiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDE1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0ge307CgovKioqLyB9KSwKLyogMTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiaXRtYXAsIHZhbHVlKXsKICByZXR1cm4gewogICAgZW51bWVyYWJsZSAgOiAhKGJpdG1hcCAmIDEpLAogICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLAogICAgd3JpdGFibGUgICAgOiAhKGJpdG1hcCAmIDQpLAogICAgdmFsdWUgICAgICAgOiB2YWx1ZQogIH07Cn07CgovKioqLyB9KSwKLyogMTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjE0IC8gMTUuMi4zLjE0IE9iamVjdC5rZXlzKE8pCnZhciAka2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpOwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pewogIHJldHVybiAka2V5cyhPLCBlbnVtQnVnS2V5cyk7Cn07CgovKioqLyB9KSwKLyogMTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpOwp9OwoKLyoqKi8gfSksCi8qIDE5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5kb2N1bWVudAogIC8vIGluIG9sZCBJRSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JwogICwgaXMgPSBpc09iamVjdChkb2N1bWVudCkgJiYgaXNPYmplY3QoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307Cn07CgovKioqLyB9KSwKLyogMjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRlZiA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaGFzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIFRBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3RvU3RyaW5nVGFnJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCB0YWcsIHN0YXQpewogIGlmKGl0ICYmICFoYXMoaXQgPSBzdGF0ID8gaXQgOiBpdC5wcm90b3R5cGUsIFRBRykpZGVmKGl0LCBUQUcsIHtjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiB0YWd9KTsKfTsKCi8qKiovIH0pLAovKiAyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSkKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2UKLy8gYW5kIHRoZSBzZWNvbmQgYXJndW1lbnQgLSBmbGFnIC0gcHJlZmVycmVkIHR5cGUgaXMgYSBzdHJpbmcKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgUyl7CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gaXQ7CiAgdmFyIGZuLCB2YWw7CiAgaWYoUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIGlmKHR5cGVvZiAoZm4gPSBpdC52YWx1ZU9mKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICBpZighUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIHRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlIik7Cn07CgovKioqLyB9KSwKLyogMjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGlkID0gMAogICwgcHggPSBNYXRoLnJhbmRvbSgpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7CiAgcmV0dXJuICdTeW1ib2woJy5jb25jYXQoa2V5ID09PSB1bmRlZmluZWQgPyAnJyA6IGtleSwgJylfJywgKCsraWQgKyBweCkudG9TdHJpbmcoMzYpKTsKfTsKCi8qKiovIH0pLAovKiAyNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyA3LjIuMSBSZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGFyZ3VtZW50KQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIiArIGl0KTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSB0cnVlOwoKLyoqKi8gfSksCi8qIDI2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzaGFyZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKSgna2V5cycpCiAgLCB1aWQgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzaGFyZWRba2V5XSB8fCAoc2hhcmVkW2tleV0gPSB1aWQoa2V5KSk7Cn07CgovKioqLyB9KSwKLyogMjcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gNy4xLjQgVG9JbnRlZ2VyCnZhciBjZWlsICA9IE1hdGguY2VpbAogICwgZmxvb3IgPSBNYXRoLmZsb29yOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXNOYU4oaXQgPSAraXQpID8gMCA6IChpdCA+IDAgPyBmbG9vciA6IGNlaWwpKGl0KTsKfTsKCi8qKiovIH0pLAovKiAyOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzCm1vZHVsZS5leHBvcnRzID0gKAogICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnCikuc3BsaXQoJywnKTsKCi8qKiovIH0pLAovKiAyOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDMpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoX193ZWJwYWNrX3JlcXVpcmVfXygxOSkoJ2RpdicpLCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiAzMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXycKICAsIHN0b3JlICA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzdG9yZVtrZXldIHx8IChzdG9yZVtrZXldID0ge30pOwp9OwoKLyoqKi8gfSksCi8qIDMxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNzkpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogMzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KQp2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gT2JqZWN0KGRlZmluZWQoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAzMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfc2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc1KTsKCnZhciBfc2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jcmVhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc0KTsKCnZhciBfY3JlYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZSk7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHN1cGVyQ2xhc3MgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoc3VwZXJDbGFzcykpKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9ICgwLCBfY3JlYXRlMi5kZWZhdWx0KShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZjIuZGVmYXVsdCA/ICgwLCBfc2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7Cn07CgovKioqLyB9KSwKLyogMzQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzZWxmLCBjYWxsKSB7CiAgaWYgKCFzZWxmKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIGNhbGwgJiYgKCh0eXBlb2YgY2FsbCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6ICgwLCBfdHlwZW9mMy5kZWZhdWx0KShjYWxsKSkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOwp9OwoKLyoqKi8gfSksCi8qIDM1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQp2YXIgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBkUHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBFbXB0eSAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KICAsIFBST1RPVFlQRSAgID0gJ3Byb3RvdHlwZSc7CgovLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlCnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24oKXsKICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1ZwogIHZhciBpZnJhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KSgnaWZyYW1lJykKICAgICwgaSAgICAgID0gZW51bUJ1Z0tleXMubGVuZ3RoCiAgICAsIGx0ICAgICA9ICc8JwogICAgLCBndCAgICAgPSAnPicKICAgICwgaWZyYW1lRG9jdW1lbnQ7CiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg0MikuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsCiAgLy8gY3JlYXRlRGljdCA9IGlmcmFtZS5jb250ZW50V2luZG93Lk9iamVjdDsKICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7CiAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKICBpZnJhbWVEb2N1bWVudC5vcGVuKCk7CiAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpOwogIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7CiAgY3JlYXRlRGljdCA9IGlmcmFtZURvY3VtZW50LkY7CiAgd2hpbGUoaS0tKWRlbGV0ZSBjcmVhdGVEaWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbaV1dOwogIHJldHVybiBjcmVhdGVEaWN0KCk7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpewogIHZhciByZXN1bHQ7CiAgaWYoTyAhPT0gbnVsbCl7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7CiAgICByZXN1bHQgPSBuZXcgRW1wdHk7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gbnVsbDsKICAgIC8vIGFkZCAiX19wcm90b19fIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsCiAgICByZXN1bHRbSUVfUFJPVE9dID0gTzsKICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpOwogIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkUHMocmVzdWx0LCBQcm9wZXJ0aWVzKTsKfTsKCgovKioqLyB9KSwKLyogMzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygzNyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAzNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKXsKICByZXR1cm4gJE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKTsKfTsKCi8qKiovIH0pLAovKiAzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgTElCUkFSWSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBoaWRlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIEl0ZXJhdG9ycyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsICRpdGVyQ3JlYXRlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MikKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MykKICAsIElURVJBVE9SICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgQlVHR1kgICAgICAgICAgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSkgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YAogICwgRkZfSVRFUkFUT1IgICAgPSAnQEBpdGVyYXRvcicKICAsIEtFWVMgICAgICAgICAgID0gJ2tleXMnCiAgLCBWQUxVRVMgICAgICAgICA9ICd2YWx1ZXMnOwoKdmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKXsKICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7CiAgdmFyIGdldE1ldGhvZCA9IGZ1bmN0aW9uKGtpbmQpewogICAgaWYoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pcmV0dXJuIHByb3RvW2tpbmRdOwogICAgc3dpdGNoKGtpbmQpewogICAgICBjYXNlIEtFWVM6IHJldHVybiBmdW5jdGlvbiBrZXlzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgfTsKICB2YXIgVEFHICAgICAgICA9IE5BTUUgKyAnIEl0ZXJhdG9yJwogICAgLCBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVMKICAgICwgVkFMVUVTX0JVRyA9IGZhbHNlCiAgICAsIHByb3RvICAgICAgPSBCYXNlLnByb3RvdHlwZQogICAgLCAkbmF0aXZlICAgID0gcHJvdG9bSVRFUkFUT1JdIHx8IHByb3RvW0ZGX0lURVJBVE9SXSB8fCBERUZBVUxUICYmIHByb3RvW0RFRkFVTFRdCiAgICAsICRkZWZhdWx0ICAgPSAkbmF0aXZlIHx8IGdldE1ldGhvZChERUZBVUxUKQogICAgLCAkZW50cmllcyAgID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZAogICAgLCAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZQogICAgLCBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlOwogIC8vIEZpeCBuYXRpdmUKICBpZigkYW55TmF0aXZlKXsKICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoJGFueU5hdGl2ZS5jYWxsKG5ldyBCYXNlKSk7CiAgICBpZihJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSl7CiAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnMKICAgICAgc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JQcm90b3R5cGUsIFRBRywgdHJ1ZSk7CiAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lcwogICAgICBpZighTElCUkFSWSAmJiAhaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikpaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwogICAgfQogIH0KICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGCiAgaWYoREVGX1ZBTFVFUyAmJiAkbmF0aXZlICYmICRuYXRpdmUubmFtZSAhPT0gVkFMVUVTKXsKICAgIFZBTFVFU19CVUcgPSB0cnVlOwogICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTsKICB9CiAgLy8gRGVmaW5lIGl0ZXJhdG9yCiAgaWYoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpewogICAgaGlkZShwcm90bywgSVRFUkFUT1IsICRkZWZhdWx0KTsKICB9CiAgLy8gUGx1ZyBmb3IgbGlicmFyeQogIEl0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0OwogIEl0ZXJhdG9yc1tUQUddICA9IHJldHVyblRoaXM7CiAgaWYoREVGQVVMVCl7CiAgICBtZXRob2RzID0gewogICAgICB2YWx1ZXM6ICBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSwKICAgICAga2V5czogICAgSVNfU0VUICAgICA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLAogICAgICBlbnRyaWVzOiAkZW50cmllcwogICAgfTsKICAgIGlmKEZPUkNFRClmb3Ioa2V5IGluIG1ldGhvZHMpewogICAgICBpZighKGtleSBpbiBwcm90bykpcmVkZWZpbmUocHJvdG8sIGtleSwgbWV0aG9kc1trZXldKTsKICAgIH0gZWxzZSAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7CiAgfQogIHJldHVybiBtZXRob2RzOwp9OwoKLyoqKi8gfSksCi8qIDM5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKLy8gMTkuMS4yLjQgLyAxNS4yLjMuNiBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhX193ZWJwYWNrX3JlcXVpcmVfXygzKSwgJ09iamVjdCcsIHtkZWZpbmVQcm9wZXJ0eTogX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mfSk7CgovKioqLyB9KSwKLyogNDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg1MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA0MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTsKCi8qKiovIH0pLAovKiA0MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZG9jdW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKLyoqKi8gfSksCi8qIDQzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi45IC8gMTUuMi4zLjIgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciBoYXMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCB0b09iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBPYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihPKXsKICBPID0gdG9PYmplY3QoTyk7CiAgaWYoaGFzKE8sIElFX1BST1RPKSlyZXR1cm4gT1tJRV9QUk9UT107CiAgaWYodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcil7CiAgICByZXR1cm4gTy5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7CiAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvIDogbnVsbDsKfTsKCi8qKiovIH0pLAovKiA0NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaGFzICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIHRvSU9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCBhcnJheUluZGV4T2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKShmYWxzZSkKICAsIElFX1BST1RPICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIG5hbWVzKXsKICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKICAgICwgaSAgICAgID0gMAogICAgLCByZXN1bHQgPSBbXQogICAgLCBrZXk7CiAgZm9yKGtleSBpbiBPKWlmKGtleSAhPSBJRV9QUk9UTyloYXMoTywga2V5KSAmJiByZXN1bHQucHVzaChrZXkpOwogIC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXMKICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKWlmKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSl7CiAgICB+YXJyYXlJbmRleE9mKHJlc3VsdCwga2V5KSB8fCByZXN1bHQucHVzaChrZXkpOwogIH0KICByZXR1cm4gcmVzdWx0Owp9OwoKLyoqKi8gfSksCi8qIDQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG1vc3QgT2JqZWN0IG1ldGhvZHMgYnkgRVM2IHNob3VsZCBhY2NlcHQgcHJpbWl0aXZlcwp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKICAsIGNvcmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBmYWlscyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBleGVjKXsKICB2YXIgZm4gID0gKGNvcmUuT2JqZWN0IHx8IHt9KVtLRVldIHx8IE9iamVjdFtLRVldCiAgICAsIGV4cCA9IHt9OwogIGV4cFtLRVldID0gZXhlYyhmbik7CiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbigpeyBmbigxKTsgfSksICdPYmplY3QnLCBleHApOwp9OwoKLyoqKi8gfSksCi8qIDQ2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCi8qKiovIH0pLAovKiA0NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMTUgVG9MZW5ndGgKdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpCiAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ID4gMCA/IG1pbih0b0ludGVnZXIoaXQpLCAweDFmZmZmZmZmZmZmZmZmKSA6IDA7IC8vIHBvdygyLCA1MykgLSAxID09IDkwMDcxOTkyNTQ3NDA5OTEKfTsKCi8qKiovIH0pLAovKiA0OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIExJQlJBUlkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKICAsIHdrc0V4dCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkKICAsIGRlZmluZVByb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewogIHZhciAkU3ltYm9sID0gY29yZS5TeW1ib2wgfHwgKGNvcmUuU3ltYm9sID0gTElCUkFSWSA/IHt9IDogZ2xvYmFsLlN5bWJvbCB8fCB7fSk7CiAgaWYobmFtZS5jaGFyQXQoMCkgIT0gJ18nICYmICEobmFtZSBpbiAkU3ltYm9sKSlkZWZpbmVQcm9wZXJ0eSgkU3ltYm9sLCBuYW1lLCB7dmFsdWU6IHdrc0V4dC5mKG5hbWUpfSk7Cn07CgovKioqLyB9KSwKLyogNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTsKCi8qKiovIH0pLAovKiA1MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgJGF0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNjYpKHRydWUpOwoKLy8gMjEuMS4zLjI3IFN0cmluZy5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQpfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KShTdHJpbmcsICdTdHJpbmcnLCBmdW5jdGlvbihpdGVyYXRlZCl7CiAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4Ci8vIDIxLjEuNS4yLjEgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKfSwgZnVuY3Rpb24oKXsKICB2YXIgTyAgICAgPSB0aGlzLl90CiAgICAsIGluZGV4ID0gdGhpcy5faQogICAgLCBwb2ludDsKICBpZihpbmRleCA+PSBPLmxlbmd0aClyZXR1cm4ge3ZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWV9OwogIHBvaW50ID0gJGF0KE8sIGluZGV4KTsKICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDsKICByZXR1cm4ge3ZhbHVlOiBwb2ludCwgZG9uZTogZmFsc2V9Owp9KTsKCi8qKiovIH0pLAovKiA1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDY5KTsKdmFyIGdsb2JhbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBoaWRlICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgSXRlcmF0b3JzICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCBUT19TVFJJTkdfVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKTsKCmZvcih2YXIgY29sbGVjdGlvbnMgPSBbJ05vZGVMaXN0JywgJ0RPTVRva2VuTGlzdCcsICdNZWRpYUxpc3QnLCAnU3R5bGVTaGVldExpc3QnLCAnQ1NTUnVsZUxpc3QnXSwgaSA9IDA7IGkgPCA1OyBpKyspewogIHZhciBOQU1FICAgICAgID0gY29sbGVjdGlvbnNbaV0KICAgICwgQ29sbGVjdGlvbiA9IGdsb2JhbFtOQU1FXQogICAgLCBwcm90byAgICAgID0gQ29sbGVjdGlvbiAmJiBDb2xsZWN0aW9uLnByb3RvdHlwZTsKICBpZihwcm90byAmJiAhcHJvdG9bVE9fU1RSSU5HX1RBR10paGlkZShwcm90bywgVE9fU1RSSU5HX1RBRywgTkFNRSk7CiAgSXRlcmF0b3JzW05BTUVdID0gSXRlcmF0b3JzLkFycmF5Owp9CgovKioqLyB9KSwKLyogNTIgKi8sCi8qIDUzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjb3JlICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsICRKU09OID0gY29yZS5KU09OIHx8IChjb3JlLkpTT04gPSB7c3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeX0pOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICByZXR1cm4gJEpTT04uc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmd1bWVudHMpOwp9OwoKLyoqKi8gfSksCi8qIDU0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgoKLyoqKi8gfSksCi8qIDU1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGdldHRpbmcgdGFnIGZyb20gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KQogICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKQogIC8vIEVTMyB3cm9uZyBoZXJlCiAgLCBBUkcgPSBjb2YoZnVuY3Rpb24oKXsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJzsKCi8vIGZhbGxiYWNrIGZvciBJRTExIFNjcmlwdCBBY2Nlc3MgRGVuaWVkIGVycm9yCnZhciB0cnlHZXQgPSBmdW5jdGlvbihpdCwga2V5KXsKICB0cnkgewogICAgcmV0dXJuIGl0W2tleV07CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgdmFyIE8sIFQsIEI7CiAgcmV0dXJuIGl0ID09PSB1bmRlZmluZWQgPyAnVW5kZWZpbmVkJyA6IGl0ID09PSBudWxsID8gJ051bGwnCiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2UKICAgIDogdHlwZW9mIChUID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUQUcpKSA9PSAnc3RyaW5nJyA/IFQKICAgIC8vIGJ1aWx0aW5UYWcgY2FzZQogICAgOiBBUkcgPyBjb2YoTykKICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2sKICAgIDogKEIgPSBjb2YoTykpID09ICdPYmplY3QnICYmIHR5cGVvZiBPLmNhbGxlZSA9PSAnZnVuY3Rpb24nID8gJ0FyZ3VtZW50cycgOiBCOwp9OwoKLyoqKi8gfSksCi8qIDU2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gY29mKGl0KSA9PSAnU3RyaW5nJyA/IGl0LnNwbGl0KCcnKSA6IE9iamVjdChpdCk7Cn07CgovKioqLyB9KSwKLyogNTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHBJRSAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIGdPUEQgICAgICAgICAgID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKCmV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBnT1BEIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApewogIE8gPSB0b0lPYmplY3QoTyk7CiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwogIGlmKElFOF9ET01fREVGSU5FKXRyeSB7CiAgICByZXR1cm4gZ09QRChPLCBQKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgaWYoaGFzKE8sIFApKXJldHVybiBjcmVhdGVEZXNjKCFwSUUuZi5jYWxsKE8sIFApLCBPW1BdKTsKfTsKCi8qKiovIH0pLAovKiA1OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKLyoqKi8gfSksCi8qIDU5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9pdGVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oNzcpOwoKdmFyIF9pdGVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pdGVyYXRvcik7Cgp2YXIgX3N5bWJvbCA9IF9fd2VicGFja19yZXF1aXJlX18oNzYpOwoKdmFyIF9zeW1ib2wyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3ltYm9sKTsKCnZhciBfdHlwZW9mID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIF9pdGVyYXRvcjIuZGVmYXVsdCA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YoX2l0ZXJhdG9yMi5kZWZhdWx0KSA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG9iaik7Cn0gOiBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IF9zeW1ib2wyLmRlZmF1bHQgJiYgb2JqICE9PSBfc3ltYm9sMi5kZWZhdWx0LnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iaiA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yob2JqKTsKfTsKCi8qKiovIH0pLAovKiA2MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH07CgovKioqLyB9KSwKLyogNjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsc2UgLT4gQXJyYXkjaW5kZXhPZgovLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlcwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvTGVuZ3RoICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCB0b0luZGV4ICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY4KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihJU19JTkNMVURFUyl7CiAgcmV0dXJuIGZ1bmN0aW9uKCR0aGlzLCBlbCwgZnJvbUluZGV4KXsKICAgIHZhciBPICAgICAgPSB0b0lPYmplY3QoJHRoaXMpCiAgICAgICwgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpCiAgICAgICwgaW5kZXggID0gdG9JbmRleChmcm9tSW5kZXgsIGxlbmd0aCkKICAgICAgLCB2YWx1ZTsKICAgIC8vIEFycmF5I2luY2x1ZGVzIHVzZXMgU2FtZVZhbHVlWmVybyBlcXVhbGl0eSBhbGdvcml0aG0KICAgIGlmKElTX0lOQ0xVREVTICYmIGVsICE9IGVsKXdoaWxlKGxlbmd0aCA+IGluZGV4KXsKICAgICAgdmFsdWUgPSBPW2luZGV4KytdOwogICAgICBpZih2YWx1ZSAhPSB2YWx1ZSlyZXR1cm4gdHJ1ZTsKICAgIC8vIEFycmF5I3RvSW5kZXggaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3QKICAgIH0gZWxzZSBmb3IoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKWlmKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pewogICAgICBpZihPW2luZGV4XSA9PT0gZWwpcmV0dXJuIElTX0lOQ0xVREVTIHx8IGluZGV4IHx8IDA7CiAgICB9IHJldHVybiAhSVNfSU5DTFVERVMgJiYgLTE7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgY3JlYXRlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KQogICwgZGVzY3JpcHRvciAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTsKCi8vIDI1LjEuMi4xLjEgJUl0ZXJhdG9yUHJvdG90eXBlJVtAQGl0ZXJhdG9yXSgpCl9fd2VicGFja19yZXF1aXJlX18oNikoSXRlcmF0b3JQcm90b3R5cGUsIF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJyksIGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9KTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpewogIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwge25leHQ6IGRlc2NyaXB0b3IoMSwgbmV4dCl9KTsKICBzZXRUb1N0cmluZ1RhZyhDb25zdHJ1Y3RvciwgTkFNRSArICcgSXRlcmF0b3InKTsKfTsKCi8qKiovIH0pLAovKiA2MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGRvbmUsIHZhbHVlKXsKICByZXR1cm4ge3ZhbHVlOiB2YWx1ZSwgZG9uZTogISFkb25lfTsKfTsKCi8qKiovIH0pLAovKiA2NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIGdldEtleXMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcyl7CiAgYW5PYmplY3QoTyk7CiAgdmFyIGtleXMgICA9IGdldEtleXMoUHJvcGVydGllcykKICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgKICAgICwgaSA9IDAKICAgICwgUDsKICB3aGlsZShsZW5ndGggPiBpKWRQLmYoTywgUCA9IGtleXNbaSsrXSwgUHJvcGVydGllc1tQXSk7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjcgLyAxNS4yLjMuNCBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKQp2YXIgJGtleXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBoaWRkZW5LZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKE8pewogIHJldHVybiAka2V5cyhPLCBoaWRkZW5LZXlzKTsKfTsKCi8qKiovIH0pLAovKiA2NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykKICAsIGRlZmluZWQgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwovLyB0cnVlICAtPiBTdHJpbmcjYXQKLy8gZmFsc2UgLT4gU3RyaW5nI2NvZGVQb2ludEF0Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oVE9fU1RSSU5HKXsKICByZXR1cm4gZnVuY3Rpb24odGhhdCwgcG9zKXsKICAgIHZhciBzID0gU3RyaW5nKGRlZmluZWQodGhhdCkpCiAgICAgICwgaSA9IHRvSW50ZWdlcihwb3MpCiAgICAgICwgbCA9IHMubGVuZ3RoCiAgICAgICwgYSwgYjsKICAgIGlmKGkgPCAwIHx8IGkgPj0gbClyZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7CiAgICBhID0gcy5jaGFyQ29kZUF0KGkpOwogICAgcmV0dXJuIGEgPCAweGQ4MDAgfHwgYSA+IDB4ZGJmZiB8fCBpICsgMSA9PT0gbCB8fCAoYiA9IHMuY2hhckNvZGVBdChpICsgMSkpIDwgMHhkYzAwIHx8IGIgPiAweGRmZmYKICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGEKICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGludm9rZSAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODgpCiAgLCBodG1sICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKQogICwgY2VsICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSkKICAsIGdsb2JhbCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBzZXRUYXNrICAgICAgICAgICAgPSBnbG9iYWwuc2V0SW1tZWRpYXRlCiAgLCBjbGVhclRhc2sgICAgICAgICAgPSBnbG9iYWwuY2xlYXJJbW1lZGlhdGUKICAsIE1lc3NhZ2VDaGFubmVsICAgICA9IGdsb2JhbC5NZXNzYWdlQ2hhbm5lbAogICwgY291bnRlciAgICAgICAgICAgID0gMAogICwgcXVldWUgICAgICAgICAgICAgID0ge30KICAsIE9OUkVBRFlTVEFURUNIQU5HRSA9ICdvbnJlYWR5c3RhdGVjaGFuZ2UnCiAgLCBkZWZlciwgY2hhbm5lbCwgcG9ydDsKdmFyIHJ1biA9IGZ1bmN0aW9uKCl7CiAgdmFyIGlkID0gK3RoaXM7CiAgaWYocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKXsKICAgIHZhciBmbiA9IHF1ZXVlW2lkXTsKICAgIGRlbGV0ZSBxdWV1ZVtpZF07CiAgICBmbigpOwogIH0KfTsKdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpewogIHJ1bi5jYWxsKGV2ZW50LmRhdGEpOwp9OwovLyBOb2RlLmpzIDAuOSsgJiBJRTEwKyBoYXMgc2V0SW1tZWRpYXRlLCBvdGhlcndpc2U6CmlmKCFzZXRUYXNrIHx8ICFjbGVhclRhc2spewogIHNldFRhc2sgPSBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoZm4pewogICAgdmFyIGFyZ3MgPSBbXSwgaSA9IDE7CiAgICB3aGlsZShhcmd1bWVudHMubGVuZ3RoID4gaSlhcmdzLnB1c2goYXJndW1lbnRzW2krK10pOwogICAgcXVldWVbKytjb3VudGVyXSA9IGZ1bmN0aW9uKCl7CiAgICAgIGludm9rZSh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pLCBhcmdzKTsKICAgIH07CiAgICBkZWZlcihjb3VudGVyKTsKICAgIHJldHVybiBjb3VudGVyOwogIH07CiAgY2xlYXJUYXNrID0gZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaWQpewogICAgZGVsZXRlIHF1ZXVlW2lkXTsKICB9OwogIC8vIE5vZGUuanMgMC44LQogIGlmKF9fd2VicGFja19yZXF1aXJlX18oMTgpKHByb2Nlc3MpID09ICdwcm9jZXNzJyl7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgcHJvY2Vzcy5uZXh0VGljayhjdHgocnVuLCBpZCwgMSkpOwogICAgfTsKICAvLyBCcm93c2VycyB3aXRoIE1lc3NhZ2VDaGFubmVsLCBpbmNsdWRlcyBXZWJXb3JrZXJzCiAgfSBlbHNlIGlmKE1lc3NhZ2VDaGFubmVsKXsKICAgIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWw7CiAgICBwb3J0ICAgID0gY2hhbm5lbC5wb3J0MjsKICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gbGlzdGVuZXI7CiAgICBkZWZlciA9IGN0eChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTsKICAvLyBCcm93c2VycyB3aXRoIHBvc3RNZXNzYWdlLCBza2lwIFdlYldvcmtlcnMKICAvLyBJRTggaGFzIHBvc3RNZXNzYWdlLCBidXQgaXQncyBzeW5jICYgdHlwZW9mIGl0cyBwb3N0TWVzc2FnZSBpcyAnb2JqZWN0JwogIH0gZWxzZSBpZihnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lciAmJiB0eXBlb2YgcG9zdE1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJyAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShpZCArICcnLCAnKicpOwogICAgfTsKICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbGlzdGVuZXIsIGZhbHNlKTsKICAvLyBJRTgtCiAgfSBlbHNlIGlmKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKXsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBodG1sLmFwcGVuZENoaWxkKGNlbCgnc2NyaXB0JykpW09OUkVBRFlTVEFURUNIQU5HRV0gPSBmdW5jdGlvbigpewogICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7CiAgICAgICAgcnVuLmNhbGwoaWQpOwogICAgICB9OwogICAgfTsKICAvLyBSZXN0IG9sZCBicm93c2VycwogIH0gZWxzZSB7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgc2V0VGltZW91dChjdHgocnVuLCBpZCwgMSksIDApOwogICAgfTsKICB9Cn0KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2V0OiAgIHNldFRhc2ssCiAgY2xlYXI6IGNsZWFyVGFzawp9OwoKLyoqKi8gfSksCi8qIDY4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KQogICwgbWF4ICAgICAgID0gTWF0aC5tYXgKICAsIG1pbiAgICAgICA9IE1hdGgubWluOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGluZGV4LCBsZW5ndGgpewogIGluZGV4ID0gdG9JbnRlZ2VyKGluZGV4KTsKICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbihpbmRleCwgbGVuZ3RoKTsKfTsKCi8qKiovIH0pLAovKiA2OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgYWRkVG9VbnNjb3BhYmxlcyA9IF9fd2VicGFja19yZXF1aXJlX18oNjApCiAgLCBzdGVwICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MykKICAsIEl0ZXJhdG9ycyAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQogICwgdG9JT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwoKLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKQovLyAyMi4xLjMuMTMgQXJyYXkucHJvdG90eXBlLmtleXMoKQovLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpCi8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzgpKEFycmF5LCAnQXJyYXknLCBmdW5jdGlvbihpdGVyYXRlZCwga2luZCl7CiAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4CiAgdGhpcy5fayA9IGtpbmQ7ICAgICAgICAgICAgICAgIC8vIGtpbmQKLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpCn0sIGZ1bmN0aW9uKCl7CiAgdmFyIE8gICAgID0gdGhpcy5fdAogICAgLCBraW5kICA9IHRoaXMuX2sKICAgICwgaW5kZXggPSB0aGlzLl9pKys7CiAgaWYoIU8gfHwgaW5kZXggPj0gTy5sZW5ndGgpewogICAgdGhpcy5fdCA9IHVuZGVmaW5lZDsKICAgIHJldHVybiBzdGVwKDEpOwogIH0KICBpZihraW5kID09ICdrZXlzJyAgKXJldHVybiBzdGVwKDAsIGluZGV4KTsKICBpZihraW5kID09ICd2YWx1ZXMnKXJldHVybiBzdGVwKDAsIE9baW5kZXhdKTsKICByZXR1cm4gc3RlcCgwLCBbaW5kZXgsIE9baW5kZXhdXSk7Cn0sICd2YWx1ZXMnKTsKCi8vIGFyZ3VtZW50c0xpc3RbQEBpdGVyYXRvcl0gaXMgJUFycmF5UHJvdG9fdmFsdWVzJSAoOS40LjQuNiwgOS40LjQuNykKSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTsKCmFkZFRvVW5zY29wYWJsZXMoJ2tleXMnKTsKYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7CmFkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTsKCi8qKiovIH0pLAovKiA3MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDcxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODIpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIE1FVEEgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykoJ21ldGEnKQogICwgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBoYXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBzZXREZXNjICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaWQgICAgICAgPSAwOwp2YXIgaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZSB8fCBmdW5jdGlvbigpewogIHJldHVybiB0cnVlOwp9Owp2YXIgRlJFRVpFID0gIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGlzRXh0ZW5zaWJsZShPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe30pKTsKfSk7CnZhciBzZXRNZXRhID0gZnVuY3Rpb24oaXQpewogIHNldERlc2MoaXQsIE1FVEEsIHt2YWx1ZTogewogICAgaTogJ08nICsgKytpZCwgLy8gb2JqZWN0IElECiAgICB3OiB7fSAgICAgICAgICAvLyB3ZWFrIGNvbGxlY3Rpb25zIElEcwogIH19KTsKfTsKdmFyIGZhc3RLZXkgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICAvLyByZXR1cm4gcHJpbWl0aXZlIHdpdGggcHJlZml4CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnID8gaXQgOiAodHlwZW9mIGl0ID09ICdzdHJpbmcnID8gJ1MnIDogJ1AnKSArIGl0OwogIGlmKCFoYXMoaXQsIE1FVEEpKXsKICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0CiAgICBpZighaXNFeHRlbnNpYmxlKGl0KSlyZXR1cm4gJ0YnOwogICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGEKICAgIGlmKCFjcmVhdGUpcmV0dXJuICdFJzsKICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhCiAgICBzZXRNZXRhKGl0KTsKICAvLyByZXR1cm4gb2JqZWN0IElECiAgfSByZXR1cm4gaXRbTUVUQV0uaTsKfTsKdmFyIGdldFdlYWsgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICBpZighaGFzKGl0LCBNRVRBKSl7CiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdAogICAgaWYoIWlzRXh0ZW5zaWJsZShpdCkpcmV0dXJuIHRydWU7CiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YQogICAgaWYoIWNyZWF0ZSlyZXR1cm4gZmFsc2U7CiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YQogICAgc2V0TWV0YShpdCk7CiAgLy8gcmV0dXJuIGhhc2ggd2VhayBjb2xsZWN0aW9ucyBJRHMKICB9IHJldHVybiBpdFtNRVRBXS53Owp9OwovLyBhZGQgbWV0YWRhdGEgb24gZnJlZXplLWZhbWlseSBtZXRob2RzIGNhbGxpbmcKdmFyIG9uRnJlZXplID0gZnVuY3Rpb24oaXQpewogIGlmKEZSRUVaRSAmJiBtZXRhLk5FRUQgJiYgaXNFeHRlbnNpYmxlKGl0KSAmJiAhaGFzKGl0LCBNRVRBKSlzZXRNZXRhKGl0KTsKICByZXR1cm4gaXQ7Cn07CnZhciBtZXRhID0gbW9kdWxlLmV4cG9ydHMgPSB7CiAgS0VZOiAgICAgIE1FVEEsCiAgTkVFRDogICAgIGZhbHNlLAogIGZhc3RLZXk6ICBmYXN0S2V5LAogIGdldFdlYWs6ICBnZXRXZWFrLAogIG9uRnJlZXplOiBvbkZyZWV6ZQp9OwoKLyoqKi8gfSksCi8qIDczICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjbGFzc29mICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KQogICwgSVRFUkFUT1IgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgSXRlcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCAhPSB1bmRlZmluZWQpcmV0dXJuIGl0W0lURVJBVE9SXQogICAgfHwgaXRbJ0BAaXRlcmF0b3InXQogICAgfHwgSXRlcmF0b3JzW2NsYXNzb2YoaXQpXTsKfTsKCi8qKiovIH0pLAovKiA3NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDc4KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODEpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDg0KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAwKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGUoUCwgRCl7CiAgcmV0dXJuICRPYmplY3QuY3JlYXRlKFAsIEQpOwp9OwoKLyoqKi8gfSksCi8qIDc5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAxKTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5nZXRQcm90b3R5cGVPZjsKCi8qKiovIH0pLAovKiA4MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMik7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Qua2V5czsKCi8qKiovIH0pLAovKiA4MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMyk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Quc2V0UHJvdG90eXBlT2Y7CgovKioqLyB9KSwKLyogODIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg1NCk7Cl9fd2VicGFja19yZXF1aXJlX18oNTApOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKX193ZWJwYWNrX3JlcXVpcmVfXygxMDQpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuUHJvbWlzZTsKCi8qKiovIH0pLAovKiA4MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNSk7Cl9fd2VicGFja19yZXF1aXJlX18oNTQpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNik7Cl9fd2VicGFja19yZXF1aXJlX18oMTA3KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLlN5bWJvbDsKCi8qKiovIH0pLAovKiA4NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkuZignaXRlcmF0b3InKTsKCi8qKiovIH0pLAovKiA4NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSwgZm9yYmlkZGVuRmllbGQpewogIGlmKCEoaXQgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikgfHwgKGZvcmJpZGRlbkZpZWxkICE9PSB1bmRlZmluZWQgJiYgZm9yYmlkZGVuRmllbGQgaW4gaXQpKXsKICAgIHRocm93IFR5cGVFcnJvcihuYW1lICsgJzogaW5jb3JyZWN0IGludm9jYXRpb24hJyk7CiAgfSByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogODYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gYWxsIGVudW1lcmFibGUgb2JqZWN0IGtleXMsIGluY2x1ZGVzIHN5bWJvbHMKdmFyIGdldEtleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QUyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHZhciByZXN1bHQgICAgID0gZ2V0S2V5cyhpdCkKICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZjsKICBpZihnZXRTeW1ib2xzKXsKICAgIHZhciBzeW1ib2xzID0gZ2V0U3ltYm9scyhpdCkKICAgICAgLCBpc0VudW0gID0gcElFLmYKICAgICAgLCBpICAgICAgID0gMAogICAgICAsIGtleTsKICAgIHdoaWxlKHN5bWJvbHMubGVuZ3RoID4gaSlpZihpc0VudW0uY2FsbChpdCwga2V5ID0gc3ltYm9sc1tpKytdKSlyZXN1bHQucHVzaChrZXkpOwogIH0gcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiA4NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgY2FsbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkxKQogICwgaXNBcnJheUl0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg5KQogICwgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCB0b0xlbmd0aCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCBnZXRJdGVyRm4gICA9IF9fd2VicGFja19yZXF1aXJlX18oNzMpCiAgLCBCUkVBSyAgICAgICA9IHt9CiAgLCBSRVRVUk4gICAgICA9IHt9Owp2YXIgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXRlcmFibGUsIGVudHJpZXMsIGZuLCB0aGF0LCBJVEVSQVRPUil7CiAgdmFyIGl0ZXJGbiA9IElURVJBVE9SID8gZnVuY3Rpb24oKXsgcmV0dXJuIGl0ZXJhYmxlOyB9IDogZ2V0SXRlckZuKGl0ZXJhYmxlKQogICAgLCBmICAgICAgPSBjdHgoZm4sIHRoYXQsIGVudHJpZXMgPyAyIDogMSkKICAgICwgaW5kZXggID0gMAogICAgLCBsZW5ndGgsIHN0ZXAsIGl0ZXJhdG9yLCByZXN1bHQ7CiAgaWYodHlwZW9mIGl0ZXJGbiAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdGVyYWJsZSArICcgaXMgbm90IGl0ZXJhYmxlIScpOwogIC8vIGZhc3QgY2FzZSBmb3IgYXJyYXlzIHdpdGggZGVmYXVsdCBpdGVyYXRvcgogIGlmKGlzQXJyYXlJdGVyKGl0ZXJGbikpZm9yKGxlbmd0aCA9IHRvTGVuZ3RoKGl0ZXJhYmxlLmxlbmd0aCk7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKXsKICAgIHJlc3VsdCA9IGVudHJpZXMgPyBmKGFuT2JqZWN0KHN0ZXAgPSBpdGVyYWJsZVtpbmRleF0pWzBdLCBzdGVwWzFdKSA6IGYoaXRlcmFibGVbaW5kZXhdKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9IGVsc2UgZm9yKGl0ZXJhdG9yID0gaXRlckZuLmNhbGwoaXRlcmFibGUpOyAhKHN0ZXAgPSBpdGVyYXRvci5uZXh0KCkpLmRvbmU7ICl7CiAgICByZXN1bHQgPSBjYWxsKGl0ZXJhdG9yLCBmLCBzdGVwLnZhbHVlLCBlbnRyaWVzKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9Cn07CmV4cG9ydHMuQlJFQUsgID0gQlJFQUs7CmV4cG9ydHMuUkVUVVJOID0gUkVUVVJOOwoKLyoqKi8gfSksCi8qIDg4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGZhc3QgYXBwbHksIGh0dHA6Ly9qc3BlcmYubG5raXQuY29tL2Zhc3QtYXBwbHkvNQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCBhcmdzLCB0aGF0KXsKICB2YXIgdW4gPSB0aGF0ID09PSB1bmRlZmluZWQ7CiAgc3dpdGNoKGFyZ3MubGVuZ3RoKXsKICAgIGNhc2UgMDogcmV0dXJuIHVuID8gZm4oKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQpOwogICAgY2FzZSAxOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0pOwogICAgY2FzZSAyOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0pOwogICAgY2FzZSAzOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pOwogICAgY2FzZSA0OiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pOwogIH0gcmV0dXJuICAgICAgICAgICAgICBmbi5hcHBseSh0aGF0LCBhcmdzKTsKfTsKCi8qKiovIH0pLAovKiA4OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBjaGVjayBvbiBkZWZhdWx0IEFycmF5IGl0ZXJhdG9yCnZhciBJdGVyYXRvcnMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsIElURVJBVE9SICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpCiAgLCBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b1tJVEVSQVRPUl0gPT09IGl0KTsKfTsKCi8qKiovIH0pLAovKiA5MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjIuMiBJc0FycmF5KGFyZ3VtZW50KQp2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7Cm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5KGFyZyl7CiAgcmV0dXJuIGNvZihhcmcpID09ICdBcnJheSc7Cn07CgovKioqLyB9KSwKLyogOTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gY2FsbCBzb21ldGhpbmcgb24gaXRlcmF0b3Igc3RlcCB3aXRoIHNhZmUgY2xvc2luZyBvbiBlcnJvcgp2YXIgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhdG9yLCBmbiwgdmFsdWUsIGVudHJpZXMpewogIHRyeSB7CiAgICByZXR1cm4gZW50cmllcyA/IGZuKGFuT2JqZWN0KHZhbHVlKVswXSwgdmFsdWVbMV0pIDogZm4odmFsdWUpOwogIC8vIDcuNC42IEl0ZXJhdG9yQ2xvc2UoaXRlcmF0b3IsIGNvbXBsZXRpb24pCiAgfSBjYXRjaChlKXsKICAgIHZhciByZXQgPSBpdGVyYXRvclsncmV0dXJuJ107CiAgICBpZihyZXQgIT09IHVuZGVmaW5lZClhbk9iamVjdChyZXQuY2FsbChpdGVyYXRvcikpOwogICAgdGhyb3cgZTsKICB9Cn07CgovKioqLyB9KSwKLyogOTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIElURVJBVE9SICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJykKICAsIFNBRkVfQ0xPU0lORyA9IGZhbHNlOwoKdHJ5IHsKICB2YXIgcml0ZXIgPSBbN11bSVRFUkFUT1JdKCk7CiAgcml0ZXJbJ3JldHVybiddID0gZnVuY3Rpb24oKXsgU0FGRV9DTE9TSU5HID0gdHJ1ZTsgfTsKICBBcnJheS5mcm9tKHJpdGVyLCBmdW5jdGlvbigpeyB0aHJvdyAyOyB9KTsKfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjLCBza2lwQ2xvc2luZyl7CiAgaWYoIXNraXBDbG9zaW5nICYmICFTQUZFX0NMT1NJTkcpcmV0dXJuIGZhbHNlOwogIHZhciBzYWZlID0gZmFsc2U7CiAgdHJ5IHsKICAgIHZhciBhcnIgID0gWzddCiAgICAgICwgaXRlciA9IGFycltJVEVSQVRPUl0oKTsKICAgIGl0ZXIubmV4dCA9IGZ1bmN0aW9uKCl7IHJldHVybiB7ZG9uZTogc2FmZSA9IHRydWV9OyB9OwogICAgYXJyW0lURVJBVE9SXSA9IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyOyB9OwogICAgZXhlYyhhcnIpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICByZXR1cm4gc2FmZTsKfTsKCi8qKiovIH0pLAovKiA5MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2V0S2V5cyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykKICAsIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgZWwpewogIHZhciBPICAgICAgPSB0b0lPYmplY3Qob2JqZWN0KQogICAgLCBrZXlzICAgPSBnZXRLZXlzKE8pCiAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCiAgICAsIGluZGV4ICA9IDAKICAgICwga2V5OwogIHdoaWxlKGxlbmd0aCA+IGluZGV4KWlmKE9ba2V5ID0ga2V5c1tpbmRleCsrXV0gPT09IGVsKXJldHVybiBrZXk7Cn07CgovKioqLyB9KSwKLyogOTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIG1hY3JvdGFzayA9IF9fd2VicGFja19yZXF1aXJlX18oNjcpLnNldAogICwgT2JzZXJ2ZXIgID0gZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIKICAsIHByb2Nlc3MgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBQcm9taXNlICAgPSBnbG9iYWwuUHJvbWlzZQogICwgaXNOb2RlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkocHJvY2VzcykgPT0gJ3Byb2Nlc3MnOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpewogIHZhciBoZWFkLCBsYXN0LCBub3RpZnk7CgogIHZhciBmbHVzaCA9IGZ1bmN0aW9uKCl7CiAgICB2YXIgcGFyZW50LCBmbjsKICAgIGlmKGlzTm9kZSAmJiAocGFyZW50ID0gcHJvY2Vzcy5kb21haW4pKXBhcmVudC5leGl0KCk7CiAgICB3aGlsZShoZWFkKXsKICAgICAgZm4gICA9IGhlYWQuZm47CiAgICAgIGhlYWQgPSBoZWFkLm5leHQ7CiAgICAgIHRyeSB7CiAgICAgICAgZm4oKTsKICAgICAgfSBjYXRjaChlKXsKICAgICAgICBpZihoZWFkKW5vdGlmeSgpOwogICAgICAgIGVsc2UgbGFzdCA9IHVuZGVmaW5lZDsKICAgICAgICB0aHJvdyBlOwogICAgICB9CiAgICB9IGxhc3QgPSB1bmRlZmluZWQ7CiAgICBpZihwYXJlbnQpcGFyZW50LmVudGVyKCk7CiAgfTsKCiAgLy8gTm9kZS5qcwogIGlmKGlzTm9kZSl7CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBwcm9jZXNzLm5leHRUaWNrKGZsdXNoKTsKICAgIH07CiAgLy8gYnJvd3NlcnMgd2l0aCBNdXRhdGlvbk9ic2VydmVyCiAgfSBlbHNlIGlmKE9ic2VydmVyKXsKICAgIHZhciB0b2dnbGUgPSB0cnVlCiAgICAgICwgbm9kZSAgID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpOwogICAgbmV3IE9ic2VydmVyKGZsdXNoKS5vYnNlcnZlKG5vZGUsIHtjaGFyYWN0ZXJEYXRhOiB0cnVlfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBub2RlLmRhdGEgPSB0b2dnbGUgPSAhdG9nZ2xlOwogICAgfTsKICAvLyBlbnZpcm9ubWVudHMgd2l0aCBtYXliZSBub24tY29tcGxldGVseSBjb3JyZWN0LCBidXQgZXhpc3RlbnQgUHJvbWlzZQogIH0gZWxzZSBpZihQcm9taXNlICYmIFByb21pc2UucmVzb2x2ZSl7CiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpOwogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgcHJvbWlzZS50aGVuKGZsdXNoKTsKICAgIH07CiAgLy8gZm9yIG90aGVyIGVudmlyb25tZW50cyAtIG1hY3JvdGFzayBiYXNlZCBvbjoKICAvLyAtIHNldEltbWVkaWF0ZQogIC8vIC0gTWVzc2FnZUNoYW5uZWwKICAvLyAtIHdpbmRvdy5wb3N0TWVzc2FnCiAgLy8gLSBvbnJlYWR5c3RhdGVjaGFuZ2UKICAvLyAtIHNldFRpbWVvdXQKICB9IGVsc2UgewogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgLy8gc3RyYW5nZSBJRSArIHdlYnBhY2sgZGV2IHNlcnZlciBidWcgLSB1c2UgLmNhbGwoZ2xvYmFsKQogICAgICBtYWNyb3Rhc2suY2FsbChnbG9iYWwsIGZsdXNoKTsKICAgIH07CiAgfQoKICByZXR1cm4gZnVuY3Rpb24oZm4pewogICAgdmFyIHRhc2sgPSB7Zm46IGZuLCBuZXh0OiB1bmRlZmluZWR9OwogICAgaWYobGFzdClsYXN0Lm5leHQgPSB0YXNrOwogICAgaWYoIWhlYWQpewogICAgICBoZWFkID0gdGFzazsKICAgICAgbm90aWZ5KCk7CiAgICB9IGxhc3QgPSB0YXNrOwogIH07Cn07CgovKioqLyB9KSwKLyogOTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsbGJhY2sgZm9yIElFMTEgYnVnZ3kgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgd2l0aCBpZnJhbWUgYW5kIHdpbmRvdwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIGdPUE4gICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjUpLmYKICAsIHRvU3RyaW5nICA9IHt9LnRvU3RyaW5nOwoKdmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMKICA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdykgOiBbXTsKCnZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uKGl0KXsKICB0cnkgewogICAgcmV0dXJuIGdPUE4oaXQpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gd2luZG93TmFtZXMuc2xpY2UoKTsKICB9Cn07Cgptb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCl7CiAgcmV0dXJuIHdpbmRvd05hbWVzICYmIHRvU3RyaW5nLmNhbGwoaXQpID09ICdbb2JqZWN0IFdpbmRvd10nID8gZ2V0V2luZG93TmFtZXMoaXQpIDogZ09QTih0b0lPYmplY3QoaXQpKTsKfTsKCgovKioqLyB9KSwKLyogOTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGhpZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHRhcmdldCwgc3JjLCBzYWZlKXsKICBmb3IodmFyIGtleSBpbiBzcmMpewogICAgaWYoc2FmZSAmJiB0YXJnZXRba2V5XSl0YXJnZXRba2V5XSA9IHNyY1trZXldOwogICAgZWxzZSBoaWRlKHRhcmdldCwga2V5LCBzcmNba2V5XSk7CiAgfSByZXR1cm4gdGFyZ2V0Owp9OwoKLyoqKi8gfSksCi8qIDk3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFdvcmtzIHdpdGggX19wcm90b19fIG9ubHkuIE9sZCB2OCBjYW4ndCB3b3JrIHdpdGggbnVsbCBwcm90byBvYmplY3RzLgovKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqLwp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CnZhciBjaGVjayA9IGZ1bmN0aW9uKE8sIHByb3RvKXsKICBhbk9iamVjdChPKTsKICBpZighaXNPYmplY3QocHJvdG8pICYmIHByb3RvICE9PSBudWxsKXRocm93IFR5cGVFcnJvcihwcm90byArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7Cn07Cm1vZHVsZS5leHBvcnRzID0gewogIHNldDogT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8ICgnX19wcm90b19fJyBpbiB7fSA/IC8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAgIGZ1bmN0aW9uKHRlc3QsIGJ1Z2d5LCBzZXQpewogICAgICB0cnkgewogICAgICAgIHNldCA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpKEZ1bmN0aW9uLmNhbGwsIF9fd2VicGFja19yZXF1aXJlX18oNTcpLmYoT2JqZWN0LnByb3RvdHlwZSwgJ19fcHJvdG9fXycpLnNldCwgMik7CiAgICAgICAgc2V0KHRlc3QsIFtdKTsKICAgICAgICBidWdneSA9ICEodGVzdCBpbnN0YW5jZW9mIEFycmF5KTsKICAgICAgfSBjYXRjaChlKXsgYnVnZ3kgPSB0cnVlOyB9CiAgICAgIHJldHVybiBmdW5jdGlvbiBzZXRQcm90b3R5cGVPZihPLCBwcm90byl7CiAgICAgICAgY2hlY2soTywgcHJvdG8pOwogICAgICAgIGlmKGJ1Z2d5KU8uX19wcm90b19fID0gcHJvdG87CiAgICAgICAgZWxzZSBzZXQoTywgcHJvdG8pOwogICAgICAgIHJldHVybiBPOwogICAgICB9OwogICAgfSh7fSwgZmFsc2UpIDogdW5kZWZpbmVkKSwKICBjaGVjazogY2hlY2sKfTsKCi8qKiovIH0pLAovKiA5OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZ2xvYmFsICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGRQICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgREVTQ1JJUFRPUlMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpCiAgLCBTUEVDSUVTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZKXsKICB2YXIgQyA9IHR5cGVvZiBjb3JlW0tFWV0gPT0gJ2Z1bmN0aW9uJyA/IGNvcmVbS0VZXSA6IGdsb2JhbFtLRVldOwogIGlmKERFU0NSSVBUT1JTICYmIEMgJiYgIUNbU1BFQ0lFU10pZFAuZihDLCBTUEVDSUVTLCB7CiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9CiAgfSk7Cn07CgovKioqLyB9KSwKLyogOTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpCnZhciBhbk9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBhRnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgU1BFQ0lFUyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnc3BlY2llcycpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE8sIEQpewogIHZhciBDID0gYW5PYmplY3QoTykuY29uc3RydWN0b3IsIFM7CiAgcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBEIDogYUZ1bmN0aW9uKFMpOwp9OwoKLyoqKi8gfSksCi8qIDEwMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0Jywge2NyZWF0ZTogX193ZWJwYWNrX3JlcXVpcmVfXygzNSl9KTsKCi8qKiovIH0pLAovKiAxMDEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjkgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciB0b09iamVjdCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Myk7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KSgnZ2V0UHJvdG90eXBlT2YnLCBmdW5jdGlvbigpewogIHJldHVybiBmdW5jdGlvbiBnZXRQcm90b3R5cGVPZihpdCl7CiAgICByZXR1cm4gJGdldFByb3RvdHlwZU9mKHRvT2JqZWN0KGl0KSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4xNCBPYmplY3Qua2V5cyhPKQp2YXIgdG9PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGtleXMgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCl9fd2VicGFja19yZXF1aXJlX18oNDUpKCdrZXlzJywgZnVuY3Rpb24oKXsKICByZXR1cm4gZnVuY3Rpb24ga2V5cyhpdCl7CiAgICByZXR1cm4gJGtleXModG9PYmplY3QoaXQpKTsKICB9Owp9KTsKCi8qKiovIH0pLAovKiAxMDMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjE5IE9iamVjdC5zZXRQcm90b3R5cGVPZihPLCBwcm90bykKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwokZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtzZXRQcm90b3R5cGVPZjogX193ZWJwYWNrX3JlcXVpcmVfXyg5Nykuc2V0fSk7CgovKioqLyB9KSwKLyogMTA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBMSUJSQVJZICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgZ2xvYmFsICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGNsYXNzb2YgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTUpCiAgLCAkZXhwb3J0ICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCBpc09iamVjdCAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhRnVuY3Rpb24gICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgYW5JbnN0YW5jZSAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NSkKICAsIGZvck9mICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODcpCiAgLCBzcGVjaWVzQ29uc3RydWN0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KQogICwgdGFzayAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Nykuc2V0CiAgLCBtaWNyb3Rhc2sgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk0KSgpCiAgLCBQUk9NSVNFICAgICAgICAgICAgPSAnUHJvbWlzZScKICAsIFR5cGVFcnJvciAgICAgICAgICA9IGdsb2JhbC5UeXBlRXJyb3IKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCAkUHJvbWlzZSAgICAgICAgICAgPSBnbG9iYWxbUFJPTUlTRV0KICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBpc05vZGUgICAgICAgICAgICAgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJwogICwgZW1wdHkgICAgICAgICAgICAgID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfQogICwgSW50ZXJuYWwsIEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSwgV3JhcHBlcjsKCnZhciBVU0VfTkFUSVZFID0gISFmdW5jdGlvbigpewogIHRyeSB7CiAgICAvLyBjb3JyZWN0IHN1YmNsYXNzaW5nIHdpdGggQEBzcGVjaWVzIHN1cHBvcnQKICAgIHZhciBwcm9taXNlICAgICA9ICRQcm9taXNlLnJlc29sdmUoMSkKICAgICAgLCBGYWtlUHJvbWlzZSA9IChwcm9taXNlLmNvbnN0cnVjdG9yID0ge30pW19fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKV0gPSBmdW5jdGlvbihleGVjKXsgZXhlYyhlbXB0eSwgZW1wdHkpOyB9OwogICAgLy8gdW5oYW5kbGVkIHJlamVjdGlvbnMgdHJhY2tpbmcgc3VwcG9ydCwgTm9kZUpTIFByb21pc2Ugd2l0aG91dCBpdCBmYWlscyBAQHNwZWNpZXMgdGVzdAogICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKSAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2U7CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9KCk7CgovLyBoZWxwZXJzCnZhciBzYW1lQ29uc3RydWN0b3IgPSBmdW5jdGlvbihhLCBiKXsKICAvLyB3aXRoIGxpYnJhcnkgd3JhcHBlciBzcGVjaWFsIGNhc2UKICByZXR1cm4gYSA9PT0gYiB8fCBhID09PSAkUHJvbWlzZSAmJiBiID09PSBXcmFwcGVyOwp9Owp2YXIgaXNUaGVuYWJsZSA9IGZ1bmN0aW9uKGl0KXsKICB2YXIgdGhlbjsKICByZXR1cm4gaXNPYmplY3QoaXQpICYmIHR5cGVvZiAodGhlbiA9IGl0LnRoZW4pID09ICdmdW5jdGlvbicgPyB0aGVuIDogZmFsc2U7Cn07CnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewogIHJldHVybiBzYW1lQ29uc3RydWN0b3IoJFByb21pc2UsIEMpCiAgICA/IG5ldyBQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgOiBuZXcgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5KEMpOwp9Owp2YXIgUHJvbWlzZUNhcGFiaWxpdHkgPSBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbihDKXsKICB2YXIgcmVzb2x2ZSwgcmVqZWN0OwogIHRoaXMucHJvbWlzZSA9IG5ldyBDKGZ1bmN0aW9uKCQkcmVzb2x2ZSwgJCRyZWplY3QpewogICAgaWYocmVzb2x2ZSAhPT0gdW5kZWZpbmVkIHx8IHJlamVjdCAhPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcignQmFkIFByb21pc2UgY29uc3RydWN0b3InKTsKICAgIHJlc29sdmUgPSAkJHJlc29sdmU7CiAgICByZWplY3QgID0gJCRyZWplY3Q7CiAgfSk7CiAgdGhpcy5yZXNvbHZlID0gYUZ1bmN0aW9uKHJlc29sdmUpOwogIHRoaXMucmVqZWN0ICA9IGFGdW5jdGlvbihyZWplY3QpOwp9Owp2YXIgcGVyZm9ybSA9IGZ1bmN0aW9uKGV4ZWMpewogIHRyeSB7CiAgICBleGVjKCk7CiAgfSBjYXRjaChlKXsKICAgIHJldHVybiB7ZXJyb3I6IGV9OwogIH0KfTsKdmFyIG5vdGlmeSA9IGZ1bmN0aW9uKHByb21pc2UsIGlzUmVqZWN0KXsKICBpZihwcm9taXNlLl9uKXJldHVybjsKICBwcm9taXNlLl9uID0gdHJ1ZTsKICB2YXIgY2hhaW4gPSBwcm9taXNlLl9jOwogIG1pY3JvdGFzayhmdW5jdGlvbigpewogICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgogICAgICAsIG9rICAgID0gcHJvbWlzZS5fcyA9PSAxCiAgICAgICwgaSAgICAgPSAwOwogICAgdmFyIHJ1biA9IGZ1bmN0aW9uKHJlYWN0aW9uKXsKICAgICAgdmFyIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbAogICAgICAgICwgcmVzb2x2ZSA9IHJlYWN0aW9uLnJlc29sdmUKICAgICAgICAsIHJlamVjdCAgPSByZWFjdGlvbi5yZWplY3QKICAgICAgICAsIGRvbWFpbiAgPSByZWFjdGlvbi5kb21haW4KICAgICAgICAsIHJlc3VsdCwgdGhlbjsKICAgICAgdHJ5IHsKICAgICAgICBpZihoYW5kbGVyKXsKICAgICAgICAgIGlmKCFvayl7CiAgICAgICAgICAgIGlmKHByb21pc2UuX2ggPT0gMilvbkhhbmRsZVVuaGFuZGxlZChwcm9taXNlKTsKICAgICAgICAgICAgcHJvbWlzZS5faCA9IDE7CiAgICAgICAgICB9CiAgICAgICAgICBpZihoYW5kbGVyID09PSB0cnVlKXJlc3VsdCA9IHZhbHVlOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZW50ZXIoKTsKICAgICAgICAgICAgcmVzdWx0ID0gaGFuZGxlcih2YWx1ZSk7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZXhpdCgpOwogICAgICAgICAgfQogICAgICAgICAgaWYocmVzdWx0ID09PSByZWFjdGlvbi5wcm9taXNlKXsKICAgICAgICAgICAgcmVqZWN0KFR5cGVFcnJvcignUHJvbWlzZS1jaGFpbiBjeWNsZScpKTsKICAgICAgICAgIH0gZWxzZSBpZih0aGVuID0gaXNUaGVuYWJsZShyZXN1bHQpKXsKICAgICAgICAgICAgdGhlbi5jYWxsKHJlc3VsdCwgcmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgICAgIH0gZWxzZSByZXNvbHZlKHJlc3VsdCk7CiAgICAgICAgfSBlbHNlIHJlamVjdCh2YWx1ZSk7CiAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgcmVqZWN0KGUpOwogICAgICB9CiAgICB9OwogICAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSlydW4oY2hhaW5baSsrXSk7IC8vIHZhcmlhYmxlIGxlbmd0aCAtIGNhbid0IHVzZSBmb3JFYWNoCiAgICBwcm9taXNlLl9jID0gW107CiAgICBwcm9taXNlLl9uID0gZmFsc2U7CiAgICBpZihpc1JlamVjdCAmJiAhcHJvbWlzZS5faClvblVuaGFuZGxlZChwcm9taXNlKTsKICB9KTsKfTsKdmFyIG9uVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YKICAgICAgLCBhYnJ1cHQsIGhhbmRsZXIsIGNvbnNvbGU7CiAgICBpZihpc1VuaGFuZGxlZChwcm9taXNlKSl7CiAgICAgIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgICBpZihpc05vZGUpewogICAgICAgICAgcHJvY2Vzcy5lbWl0KCd1bmhhbmRsZWRSZWplY3Rpb24nLCB2YWx1ZSwgcHJvbWlzZSk7CiAgICAgICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub251bmhhbmRsZWRyZWplY3Rpb24pewogICAgICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiB2YWx1ZX0pOwogICAgICAgIH0gZWxzZSBpZigoY29uc29sZSA9IGdsb2JhbC5jb25zb2xlKSAmJiBjb25zb2xlLmVycm9yKXsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbicsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBCcm93c2VycyBzaG91bGQgbm90IHRyaWdnZXIgYHJlamVjdGlvbkhhbmRsZWRgIGV2ZW50IGlmIGl0IHdhcyBoYW5kbGVkIGhlcmUsIE5vZGVKUyAtIHNob3VsZAogICAgICBwcm9taXNlLl9oID0gaXNOb2RlIHx8IGlzVW5oYW5kbGVkKHByb21pc2UpID8gMiA6IDE7CiAgICB9IHByb21pc2UuX2EgPSB1bmRlZmluZWQ7CiAgICBpZihhYnJ1cHQpdGhyb3cgYWJydXB0LmVycm9yOwogIH0pOwp9Owp2YXIgaXNVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKICBpZihwcm9taXNlLl9oID09IDEpcmV0dXJuIGZhbHNlOwogIHZhciBjaGFpbiA9IHByb21pc2UuX2EgfHwgcHJvbWlzZS5fYwogICAgLCBpICAgICA9IDAKICAgICwgcmVhY3Rpb247CiAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSl7CiAgICByZWFjdGlvbiA9IGNoYWluW2krK107CiAgICBpZihyZWFjdGlvbi5mYWlsIHx8ICFpc1VuaGFuZGxlZChyZWFjdGlvbi5wcm9taXNlKSlyZXR1cm4gZmFsc2U7CiAgfSByZXR1cm4gdHJ1ZTsKfTsKdmFyIG9uSGFuZGxlVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciBoYW5kbGVyOwogICAgaWYoaXNOb2RlKXsKICAgICAgcHJvY2Vzcy5lbWl0KCdyZWplY3Rpb25IYW5kbGVkJywgcHJvbWlzZSk7CiAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnJlamVjdGlvbmhhbmRsZWQpewogICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHByb21pc2UuX3Z9KTsKICAgIH0KICB9KTsKfTsKdmFyICRyZWplY3QgPSBmdW5jdGlvbih2YWx1ZSl7CiAgdmFyIHByb21pc2UgPSB0aGlzOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHByb21pc2UuX3YgPSB2YWx1ZTsKICBwcm9taXNlLl9zID0gMjsKICBpZighcHJvbWlzZS5fYSlwcm9taXNlLl9hID0gcHJvbWlzZS5fYy5zbGljZSgpOwogIG5vdGlmeShwcm9taXNlLCB0cnVlKTsKfTsKdmFyICRyZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpewogIHZhciBwcm9taXNlID0gdGhpcwogICAgLCB0aGVuOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHRyeSB7CiAgICBpZihwcm9taXNlID09PSB2YWx1ZSl0aHJvdyBUeXBlRXJyb3IoIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmIik7CiAgICBpZih0aGVuID0gaXNUaGVuYWJsZSh2YWx1ZSkpewogICAgICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKICAgICAgICB2YXIgd3JhcHBlciA9IHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfTsgLy8gd3JhcAogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGVuLmNhbGwodmFsdWUsIGN0eCgkcmVzb2x2ZSwgd3JhcHBlciwgMSksIGN0eCgkcmVqZWN0LCB3cmFwcGVyLCAxKSk7CiAgICAgICAgfSBjYXRjaChlKXsKICAgICAgICAgICRyZWplY3QuY2FsbCh3cmFwcGVyLCBlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgcHJvbWlzZS5fdiA9IHZhbHVlOwogICAgICBwcm9taXNlLl9zID0gMTsKICAgICAgbm90aWZ5KHByb21pc2UsIGZhbHNlKTsKICAgIH0KICB9IGNhdGNoKGUpewogICAgJHJlamVjdC5jYWxsKHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfSwgZSk7IC8vIHdyYXAKICB9Cn07CgovLyBjb25zdHJ1Y3RvciBwb2x5ZmlsbAppZighVVNFX05BVElWRSl7CiAgLy8gMjUuNC4zLjEgUHJvbWlzZShleGVjdXRvcikKICAkUHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpewogICAgYW5JbnN0YW5jZSh0aGlzLCAkUHJvbWlzZSwgUFJPTUlTRSwgJ19oJyk7CiAgICBhRnVuY3Rpb24oZXhlY3V0b3IpOwogICAgSW50ZXJuYWwuY2FsbCh0aGlzKTsKICAgIHRyeSB7CiAgICAgIGV4ZWN1dG9yKGN0eCgkcmVzb2x2ZSwgdGhpcywgMSksIGN0eCgkcmVqZWN0LCB0aGlzLCAxKSk7CiAgICB9IGNhdGNoKGVycil7CiAgICAgICRyZWplY3QuY2FsbCh0aGlzLCBlcnIpOwogICAgfQogIH07CiAgSW50ZXJuYWwgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKICAgIHRoaXMuX2MgPSBbXTsgICAgICAgICAgICAgLy8gPC0gYXdhaXRpbmcgcmVhY3Rpb25zCiAgICB0aGlzLl9hID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIGNoZWNrZWQgaW4gaXNVbmhhbmRsZWQgcmVhY3Rpb25zCiAgICB0aGlzLl9zID0gMDsgICAgICAgICAgICAgIC8vIDwtIHN0YXRlCiAgICB0aGlzLl9kID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIGRvbmUKICAgIHRoaXMuX3YgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gdmFsdWUKICAgIHRoaXMuX2ggPSAwOyAgICAgICAgICAgICAgLy8gPC0gcmVqZWN0aW9uIHN0YXRlLCAwIC0gZGVmYXVsdCwgMSAtIGhhbmRsZWQsIDIgLSB1bmhhbmRsZWQKICAgIHRoaXMuX24gPSBmYWxzZTsgICAgICAgICAgLy8gPC0gbm90aWZ5CiAgfTsKICBJbnRlcm5hbC5wcm90b3R5cGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KSgkUHJvbWlzZS5wcm90b3R5cGUsIHsKICAgIC8vIDI1LjQuNS4zIFByb21pc2UucHJvdG90eXBlLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpCiAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKXsKICAgICAgdmFyIHJlYWN0aW9uICAgID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsICRQcm9taXNlKSk7CiAgICAgIHJlYWN0aW9uLm9rICAgICA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PSAnZnVuY3Rpb24nID8gb25GdWxmaWxsZWQgOiB0cnVlOwogICAgICByZWFjdGlvbi5mYWlsICAgPSB0eXBlb2Ygb25SZWplY3RlZCA9PSAnZnVuY3Rpb24nICYmIG9uUmVqZWN0ZWQ7CiAgICAgIHJlYWN0aW9uLmRvbWFpbiA9IGlzTm9kZSA/IHByb2Nlc3MuZG9tYWluIDogdW5kZWZpbmVkOwogICAgICB0aGlzLl9jLnB1c2gocmVhY3Rpb24pOwogICAgICBpZih0aGlzLl9hKXRoaXMuX2EucHVzaChyZWFjdGlvbik7CiAgICAgIGlmKHRoaXMuX3Mpbm90aWZ5KHRoaXMsIGZhbHNlKTsKICAgICAgcmV0dXJuIHJlYWN0aW9uLnByb21pc2U7CiAgICB9LAogICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2gob25SZWplY3RlZCkKICAgICdjYXRjaCc6IGZ1bmN0aW9uKG9uUmVqZWN0ZWQpewogICAgICByZXR1cm4gdGhpcy50aGVuKHVuZGVmaW5lZCwgb25SZWplY3RlZCk7CiAgICB9CiAgfSk7CiAgUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbigpewogICAgdmFyIHByb21pc2UgID0gbmV3IEludGVybmFsOwogICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTsKICAgIHRoaXMucmVzb2x2ZSA9IGN0eCgkcmVzb2x2ZSwgcHJvbWlzZSwgMSk7CiAgICB0aGlzLnJlamVjdCAgPSBjdHgoJHJlamVjdCwgcHJvbWlzZSwgMSk7CiAgfTsKfQoKJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1Byb21pc2U6ICRQcm9taXNlfSk7Cl9fd2VicGFja19yZXF1aXJlX18oMjEpKCRQcm9taXNlLCBQUk9NSVNFKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg5OCkoUFJPTUlTRSk7CldyYXBwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApW1BST01JU0VdOwoKLy8gc3RhdGljcwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCBQUk9NSVNFLCB7CiAgLy8gMjUuNC40LjUgUHJvbWlzZS5yZWplY3QocikKICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyKXsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlamVjdCAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgICAkJHJlamVjdChyKTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQp9KTsKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoTElCUkFSWSB8fCAhVVNFX05BVElWRSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuNiBQcm9taXNlLnJlc29sdmUoeCkKICByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKHgpewogICAgLy8gaW5zdGFuY2VvZiBpbnN0ZWFkIG9mIGludGVybmFsIHNsb3QgY2hlY2sgYmVjYXVzZSB3ZSBzaG91bGQgZml4IGl0IHdpdGhvdXQgcmVwbGFjZW1lbnQgbmF0aXZlIFByb21pc2UgY29yZQogICAgaWYoeCBpbnN0YW5jZW9mICRQcm9taXNlICYmIHNhbWVDb25zdHJ1Y3Rvcih4LmNvbnN0cnVjdG9yLCB0aGlzKSlyZXR1cm4geDsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlc29sdmUgID0gY2FwYWJpbGl0eS5yZXNvbHZlOwogICAgJCRyZXNvbHZlKHgpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoVVNFX05BVElWRSAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fKDkyKShmdW5jdGlvbihpdGVyKXsKICAkUHJvbWlzZS5hbGwoaXRlcilbJ2NhdGNoJ10oZW1wdHkpOwp9KSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuMSBQcm9taXNlLmFsbChpdGVyYWJsZSkKICBhbGw6IGZ1bmN0aW9uIGFsbChpdGVyYWJsZSl7CiAgICB2YXIgQyAgICAgICAgICA9IHRoaXMKICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKICAgICAgLCByZXNvbHZlICAgID0gY2FwYWJpbGl0eS5yZXNvbHZlCiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwogICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgdmFyIHZhbHVlcyAgICA9IFtdCiAgICAgICAgLCBpbmRleCAgICAgPSAwCiAgICAgICAgLCByZW1haW5pbmcgPSAxOwogICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2UpewogICAgICAgIHZhciAkaW5kZXggICAgICAgID0gaW5kZXgrKwogICAgICAgICAgLCBhbHJlYWR5Q2FsbGVkID0gZmFsc2U7CiAgICAgICAgdmFsdWVzLnB1c2godW5kZWZpbmVkKTsKICAgICAgICByZW1haW5pbmcrKzsKICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgICBpZihhbHJlYWR5Q2FsbGVkKXJldHVybjsKICAgICAgICAgIGFscmVhZHlDYWxsZWQgID0gdHJ1ZTsKICAgICAgICAgIHZhbHVlc1skaW5kZXhdID0gdmFsdWU7CiAgICAgICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgfSk7CiAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9LAogIC8vIDI1LjQuNC40IFByb21pc2UucmFjZShpdGVyYWJsZSkKICByYWNlOiBmdW5jdGlvbiByYWNlKGl0ZXJhYmxlKXsKICAgIHZhciBDICAgICAgICAgID0gdGhpcwogICAgICAsIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgICAsIHJlamVjdCAgICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oY2FwYWJpbGl0eS5yZXNvbHZlLCByZWplY3QpOwogICAgICB9KTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwoKLyoqKi8gfSksCi8qIDEwNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyBFQ01BU2NyaXB0IDYgc3ltYm9scyBzaGltCnZhciBnbG9iYWwgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIERFU0NSSVBUT1JTICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBNRVRBICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpLktFWQogICwgJGZhaWxzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKQogICwgc2hhcmVkICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgdWlkICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKQogICwgd2tzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpCiAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCiAgLCB3a3NEZWZpbmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDgpCiAgLCBrZXlPZiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTMpCiAgLCBlbnVtS2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODYpCiAgLCBpc0FycmF5ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTApCiAgLCBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIF9jcmVhdGUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSkKICAsIGdPUE5FeHQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NSkKICAsICRHT1BEICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NykKICAsICREUCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgJGtleXMgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QRCAgICAgICAgICAgPSAkR09QRC5mCiAgLCBkUCAgICAgICAgICAgICA9ICREUC5mCiAgLCBnT1BOICAgICAgICAgICA9IGdPUE5FeHQuZgogICwgJFN5bWJvbCAgICAgICAgPSBnbG9iYWwuU3ltYm9sCiAgLCAkSlNPTiAgICAgICAgICA9IGdsb2JhbC5KU09OCiAgLCBfc3RyaW5naWZ5ICAgICA9ICRKU09OICYmICRKU09OLnN0cmluZ2lmeQogICwgUFJPVE9UWVBFICAgICAgPSAncHJvdG90eXBlJwogICwgSElEREVOICAgICAgICAgPSB3a3MoJ19oaWRkZW4nKQogICwgVE9fUFJJTUlUSVZFICAgPSB3a3MoJ3RvUHJpbWl0aXZlJykKICAsIGlzRW51bSAgICAgICAgID0ge30ucHJvcGVydHlJc0VudW1lcmFibGUKICAsIFN5bWJvbFJlZ2lzdHJ5ID0gc2hhcmVkKCdzeW1ib2wtcmVnaXN0cnknKQogICwgQWxsU3ltYm9scyAgICAgPSBzaGFyZWQoJ3N5bWJvbHMnKQogICwgT1BTeW1ib2xzICAgICAgPSBzaGFyZWQoJ29wLXN5bWJvbHMnKQogICwgT2JqZWN0UHJvdG8gICAgPSBPYmplY3RbUFJPVE9UWVBFXQogICwgVVNFX05BVElWRSAgICAgPSB0eXBlb2YgJFN5bWJvbCA9PSAnZnVuY3Rpb24nCiAgLCBRT2JqZWN0ICAgICAgICA9IGdsb2JhbC5RT2JqZWN0OwovLyBEb24ndCB1c2Ugc2V0dGVycyBpbiBRdCBTY3JpcHQsIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8xNzMKdmFyIHNldHRlciA9ICFRT2JqZWN0IHx8ICFRT2JqZWN0W1BST1RPVFlQRV0gfHwgIVFPYmplY3RbUFJPVE9UWVBFXS5maW5kQ2hpbGQ7CgovLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODcKdmFyIHNldFN5bWJvbERlc2MgPSBERVNDUklQVE9SUyAmJiAkZmFpbHMoZnVuY3Rpb24oKXsKICByZXR1cm4gX2NyZWF0ZShkUCh7fSwgJ2EnLCB7CiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBkUCh0aGlzLCAnYScsIHt2YWx1ZTogN30pLmE7IH0KICB9KSkuYSAhPSA3Owp9KSA/IGZ1bmN0aW9uKGl0LCBrZXksIEQpewogIHZhciBwcm90b0Rlc2MgPSBnT1BEKE9iamVjdFByb3RvLCBrZXkpOwogIGlmKHByb3RvRGVzYylkZWxldGUgT2JqZWN0UHJvdG9ba2V5XTsKICBkUChpdCwga2V5LCBEKTsKICBpZihwcm90b0Rlc2MgJiYgaXQgIT09IE9iamVjdFByb3RvKWRQKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7Cn0gOiBkUDsKCnZhciB3cmFwID0gZnVuY3Rpb24odGFnKXsKICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pOwogIHN5bS5fayA9IHRhZzsKICByZXR1cm4gc3ltOwp9OwoKdmFyIGlzU3ltYm9sID0gVVNFX05BVElWRSAmJiB0eXBlb2YgJFN5bWJvbC5pdGVyYXRvciA9PSAnc3ltYm9sJyA/IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnOwp9IDogZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCBpbnN0YW5jZW9mICRTeW1ib2w7Cn07Cgp2YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCl7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvKSRkZWZpbmVQcm9wZXJ0eShPUFN5bWJvbHMsIGtleSwgRCk7CiAgYW5PYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgYW5PYmplY3QoRCk7CiAgaWYoaGFzKEFsbFN5bWJvbHMsIGtleSkpewogICAgaWYoIUQuZW51bWVyYWJsZSl7CiAgICAgIGlmKCFoYXMoaXQsIEhJRERFTikpZFAoaXQsIEhJRERFTiwgY3JlYXRlRGVzYygxLCB7fSkpOwogICAgICBpdFtISURERU5dW2tleV0gPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgaWYoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSlpdFtISURERU5dW2tleV0gPSBmYWxzZTsKICAgICAgRCA9IF9jcmVhdGUoRCwge2VudW1lcmFibGU6IGNyZWF0ZURlc2MoMCwgZmFsc2UpfSk7CiAgICB9IHJldHVybiBzZXRTeW1ib2xEZXNjKGl0LCBrZXksIEQpOwogIH0gcmV0dXJuIGRQKGl0LCBrZXksIEQpOwp9Owp2YXIgJGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKGl0LCBQKXsKICBhbk9iamVjdChpdCk7CiAgdmFyIGtleXMgPSBlbnVtS2V5cyhQID0gdG9JT2JqZWN0KFApKQogICAgLCBpICAgID0gMAogICAgLCBsID0ga2V5cy5sZW5ndGgKICAgICwga2V5OwogIHdoaWxlKGwgPiBpKSRkZWZpbmVQcm9wZXJ0eShpdCwga2V5ID0ga2V5c1tpKytdLCBQW2tleV0pOwogIHJldHVybiBpdDsKfTsKdmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaXQsIFApewogIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfY3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9jcmVhdGUoaXQpLCBQKTsKfTsKdmFyICRwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IGZ1bmN0aW9uIHByb3BlcnR5SXNFbnVtZXJhYmxlKGtleSl7CiAgdmFyIEUgPSBpc0VudW0uY2FsbCh0aGlzLCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKTsKICBpZih0aGlzID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSlyZXR1cm4gZmFsc2U7CiAgcmV0dXJuIEUgfHwgIWhhcyh0aGlzLCBrZXkpIHx8ICFoYXMoQWxsU3ltYm9scywga2V5KSB8fCBoYXModGhpcywgSElEREVOKSAmJiB0aGlzW0hJRERFTl1ba2V5XSA/IEUgOiB0cnVlOwp9Owp2YXIgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICBpdCAgPSB0b0lPYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKXJldHVybjsKICB2YXIgRCA9IGdPUEQoaXQsIGtleSk7CiAgaWYoRCAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKUQuZW51bWVyYWJsZSA9IHRydWU7CiAgcmV0dXJuIEQ7Cn07CnZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpewogIHZhciBuYW1lcyAgPSBnT1BOKHRvSU9iamVjdChpdCkpCiAgICAsIHJlc3VsdCA9IFtdCiAgICAsIGkgICAgICA9IDAKICAgICwga2V5OwogIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewogICAgaWYoIWhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiBrZXkgIT0gSElEREVOICYmIGtleSAhPSBNRVRBKXJlc3VsdC5wdXNoKGtleSk7CiAgfSByZXR1cm4gcmVzdWx0Owp9Owp2YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCl7CiAgdmFyIElTX09QICA9IGl0ID09PSBPYmplY3RQcm90bwogICAgLCBuYW1lcyAgPSBnT1BOKElTX09QID8gT1BTeW1ib2xzIDogdG9JT2JqZWN0KGl0KSkKICAgICwgcmVzdWx0ID0gW10KICAgICwgaSAgICAgID0gMAogICAgLCBrZXk7CiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7CiAgICBpZihoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYgKElTX09QID8gaGFzKE9iamVjdFByb3RvLCBrZXkpIDogdHJ1ZSkpcmVzdWx0LnB1c2goQWxsU3ltYm9sc1trZXldKTsKICB9IHJldHVybiByZXN1bHQ7Cn07CgovLyAxOS40LjEuMSBTeW1ib2woW2Rlc2NyaXB0aW9uXSkKaWYoIVVTRV9OQVRJVkUpewogICRTeW1ib2wgPSBmdW5jdGlvbiBTeW1ib2woKXsKICAgIGlmKHRoaXMgaW5zdGFuY2VvZiAkU3ltYm9sKXRocm93IFR5cGVFcnJvcignU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIScpOwogICAgdmFyIHRhZyA9IHVpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7CiAgICB2YXIgJHNldCA9IGZ1bmN0aW9uKHZhbHVlKXsKICAgICAgaWYodGhpcyA9PT0gT2JqZWN0UHJvdG8pJHNldC5jYWxsKE9QU3ltYm9scywgdmFsdWUpOwogICAgICBpZihoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKXRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7CiAgICAgIHNldFN5bWJvbERlc2ModGhpcywgdGFnLCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7CiAgICB9OwogICAgaWYoREVTQ1JJUFRPUlMgJiYgc2V0dGVyKXNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0fSk7CiAgICByZXR1cm4gd3JhcCh0YWcpOwogIH07CiAgcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEVdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpewogICAgcmV0dXJuIHRoaXMuX2s7CiAgfSk7CgogICRHT1BELmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwogICREUC5mICAgPSAkZGVmaW5lUHJvcGVydHk7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg2NSkuZiA9IGdPUE5FeHQuZiA9ICRnZXRPd25Qcm9wZXJ0eU5hbWVzOwogIF9fd2VicGFja19yZXF1aXJlX18oNDEpLmYgID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlOwogIF9fd2VicGFja19yZXF1aXJlX18oNTgpLmYgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKICBpZihERVNDUklQVE9SUyAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygyNSkpewogICAgcmVkZWZpbmUoT2JqZWN0UHJvdG8sICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsICRwcm9wZXJ0eUlzRW51bWVyYWJsZSwgdHJ1ZSk7CiAgfQoKICB3a3NFeHQuZiA9IGZ1bmN0aW9uKG5hbWUpewogICAgcmV0dXJuIHdyYXAod2tzKG5hbWUpKTsKICB9Cn0KCiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtTeW1ib2w6ICRTeW1ib2x9KTsKCmZvcih2YXIgc3ltYm9scyA9ICgKICAvLyAxOS40LjIuMiwgMTkuNC4yLjMsIDE5LjQuMi40LCAxOS40LjIuNiwgMTkuNC4yLjgsIDE5LjQuMi45LCAxOS40LjIuMTAsIDE5LjQuMi4xMSwgMTkuNC4yLjEyLCAxOS40LjIuMTMsIDE5LjQuMi4xNAogICdoYXNJbnN0YW5jZSxpc0NvbmNhdFNwcmVhZGFibGUsaXRlcmF0b3IsbWF0Y2gscmVwbGFjZSxzZWFyY2gsc3BlY2llcyxzcGxpdCx0b1ByaW1pdGl2ZSx0b1N0cmluZ1RhZyx1bnNjb3BhYmxlcycKKS5zcGxpdCgnLCcpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzKHN5bWJvbHNbaSsrXSk7Cgpmb3IodmFyIHN5bWJvbHMgPSAka2V5cyh3a3Muc3RvcmUpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzRGVmaW5lKHN5bWJvbHNbaSsrXSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywgewogIC8vIDE5LjQuMi4xIFN5bWJvbC5mb3Ioa2V5KQogICdmb3InOiBmdW5jdGlvbihrZXkpewogICAgcmV0dXJuIGhhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKQogICAgICA/IFN5bWJvbFJlZ2lzdHJ5W2tleV0KICAgICAgOiBTeW1ib2xSZWdpc3RyeVtrZXldID0gJFN5bWJvbChrZXkpOwogIH0sCiAgLy8gMTkuNC4yLjUgU3ltYm9sLmtleUZvcihzeW0pCiAga2V5Rm9yOiBmdW5jdGlvbiBrZXlGb3Ioa2V5KXsKICAgIGlmKGlzU3ltYm9sKGtleSkpcmV0dXJuIGtleU9mKFN5bWJvbFJlZ2lzdHJ5LCBrZXkpOwogICAgdGhyb3cgVHlwZUVycm9yKGtleSArICcgaXMgbm90IGEgc3ltYm9sIScpOwogIH0sCiAgdXNlU2V0dGVyOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSB0cnVlOyB9LAogIHVzZVNpbXBsZTogZnVuY3Rpb24oKXsgc2V0dGVyID0gZmFsc2U7IH0KfSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnT2JqZWN0JywgewogIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKICBjcmVhdGU6ICRjcmVhdGUsCiAgLy8gMTkuMS4yLjQgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCiAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSwKICAvLyAxOS4xLjIuMyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKQogIGRlZmluZVByb3BlcnRpZXM6ICRkZWZpbmVQcm9wZXJ0aWVzLAogIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkKICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsCiAgLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcywKICAvLyAxOS4xLjIuOCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKE8pCiAgZ2V0T3duUHJvcGVydHlTeW1ib2xzOiAkZ2V0T3duUHJvcGVydHlTeW1ib2xzCn0pOwoKLy8gMjQuMy4yIEpTT04uc3RyaW5naWZ5KHZhbHVlIFssIHJlcGxhY2VyIFssIHNwYWNlXV0pCiRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbigpewogIHZhciBTID0gJFN5bWJvbCgpOwogIC8vIE1TIEVkZ2UgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIHt9CiAgLy8gV2ViS2l0IGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyBudWxsCiAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHMKICByZXR1cm4gX3N0cmluZ2lmeShbU10pICE9ICdbbnVsbF0nIHx8IF9zdHJpbmdpZnkoe2E6IFN9KSAhPSAne30nIHx8IF9zdHJpbmdpZnkoT2JqZWN0KFMpKSAhPSAne30nOwp9KSksICdKU09OJywgewogIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXsKICAgIGlmKGl0ID09PSB1bmRlZmluZWQgfHwgaXNTeW1ib2woaXQpKXJldHVybjsgLy8gSUU4IHJldHVybnMgc3RyaW5nIG9uIHVuZGVmaW5lZAogICAgdmFyIGFyZ3MgPSBbaXRdCiAgICAgICwgaSAgICA9IDEKICAgICAgLCByZXBsYWNlciwgJHJlcGxhY2VyOwogICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKICAgIHJlcGxhY2VyID0gYXJnc1sxXTsKICAgIGlmKHR5cGVvZiByZXBsYWNlciA9PSAnZnVuY3Rpb24nKSRyZXBsYWNlciA9IHJlcGxhY2VyOwogICAgaWYoJHJlcGxhY2VyIHx8ICFpc0FycmF5KHJlcGxhY2VyKSlyZXBsYWNlciA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpewogICAgICBpZigkcmVwbGFjZXIpdmFsdWUgPSAkcmVwbGFjZXIuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTsKICAgICAgaWYoIWlzU3ltYm9sKHZhbHVlKSlyZXR1cm4gdmFsdWU7CiAgICB9OwogICAgYXJnc1sxXSA9IHJlcGxhY2VyOwogICAgcmV0dXJuIF9zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3MpOwogIH0KfSk7CgovLyAxOS40LjMuNCBTeW1ib2wucHJvdG90eXBlW0BAdG9QcmltaXRpdmVdKGhpbnQpCiRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IF9fd2VicGFja19yZXF1aXJlX18oNikoJFN5bWJvbFtQUk9UT1RZUEVdLCBUT19QUklNSVRJVkUsICRTeW1ib2xbUFJPVE9UWVBFXS52YWx1ZU9mKTsKLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXQpzZXRUb1N0cmluZ1RhZygkU3ltYm9sLCAnU3ltYm9sJyk7Ci8vIDIwLjIuMS45IE1hdGhbQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTsKLy8gMjQuMy4zIEpTT05bQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoZ2xvYmFsLkpTT04sICdKU09OJywgdHJ1ZSk7CgovKioqLyB9KSwKLyogMTA2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdhc3luY0l0ZXJhdG9yJyk7CgovKioqLyB9KSwKLyogMTA3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdvYnNlcnZhYmxlJyk7CgovKioqLyB9KSwKLyogMTA4ICovLAovKiAxMDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfc3RyaW5naWZ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7Cgp2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKZXhwb3J0cy5kaXZpZGVFbWFpbCA9IGRpdmlkZUVtYWlsOwpleHBvcnRzLmVtcHR5T2JqZWN0ID0gZW1wdHlPYmplY3Q7CmV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwpleHBvcnRzLmdldFVzZXJVUkxGcm9tRW1haWwgPSBnZXRVc2VyVVJMRnJvbUVtYWlsOwpleHBvcnRzLmdldFVzZXJFbWFpbEZyb21VUkwgPSBnZXRVc2VyRW1haWxGcm9tVVJMOwpleHBvcnRzLmNvbnZlcnRUb1VzZXJVUkwgPSBjb252ZXJ0VG9Vc2VyVVJMOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwovKioKICogU3VwcG9ydCBtb2R1bGUgd2l0aCBzb21lIGZ1bmN0aW9ucyB3aWxsIGJlIHVzZWZ1bAogKiBAbW9kdWxlIHV0aWxzCiAqLwoKLyoqCiAqIEB0eXBlZGVmIGRpdmlkZVVSTAogKiBAdHlwZSBPYmplY3QKICogQHByb3BlcnR5IHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgVVJMCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkb21haW4gVGhlIGRvbWFpbiBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiBVUkwKICovCgovKioKICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5CiAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAqIEByZXR1cm4ge2RpdmlkZVVSTH0gdGhlIHJlc3VsdCBvZiBkaXZpZGVVUkwKICovCmZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHsKCiAgaWYgKCF1cmwpIHRocm93IEVycm9yKCdVUkwgaXMgbmVlZGVkIHRvIHNwbGl0Jyk7CgogIGZ1bmN0aW9uIHJlY3Vyc2UodmFsdWUpIHsKICAgIHZhciByZWdleCA9IC8oW2EtekEtWi1dKikoOlwvXC8oPzpcLik/fDopKFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTsKICAgIHZhciBzdWJzdCA9ICckMSwkMywkNCc7CiAgICB2YXIgcGFydHMgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBzdWJzdCkuc3BsaXQoJywnKTsKICAgIHJldHVybiBwYXJ0czsKICB9CgogIHZhciBwYXJ0cyA9IHJlY3Vyc2UodXJsKTsKCiAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lCiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgIXBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKCiAgICB2YXIgX3Jlc3VsdCA9IHsKICAgICAgdHlwZTogIiIsCiAgICAgIGRvbWFpbjogdXJsLAogICAgICBpZGVudGl0eTogIiIKICAgIH07CgogICAgY29uc29sZS5lcnJvcignW0RpdmlkZVVSTF0gRGl2aWRlVVJMIGRvblwndCBzdXBwb3J0IHVybCB3aXRob3V0IHNjaGVtZS4gUGxlYXNlIHJldmlldyB5b3VyIHVybCBhZGRyZXNzJywgdXJsKTsKCiAgICByZXR1cm4gX3Jlc3VsdDsKICB9CgogIC8vIGNoZWNrIGlmIHRoZSB1cmwgaGFzIHRoZSBzY2hlbWUgYW5kIGluY2x1ZGVzIGFuIEAKICBpZiAocGFydHNbMF0gPT09IHVybCAmJiBwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CiAgICB2YXIgc2NoZW1lID0gcGFydHNbMF0gPT09IHVybCA/ICdzbXRwJyA6IHBhcnRzWzBdOwogICAgcGFydHMgPSByZWN1cnNlKHNjaGVtZSArICc6Ly8nICsgcGFydHNbMF0pOwogIH0KCiAgLy8gaWYgdGhlIGRvbWFpbiBpbmNsdWRlcyBhbiBALCBkaXZpZGUgaXQgdG8gZG9tYWluIGFuZCBpZGVudGl0eSByZXNwZWN0aXZlbHkKICBpZiAocGFydHNbMV0uaW5jbHVkZXMoJ0AnKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1swXSArICc6Ly8nICsgcGFydHNbMV07CiAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdLnN1YnN0cihwYXJ0c1sxXS5pbmRleE9mKCdAJykgKyAxKTsKICB9IC8qZWxzZSBpZiAocGFydHNbMl0uaW5jbHVkZXMoJy8nKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1syXS5zdWJzdHIocGFydHNbMl0ubGFzdEluZGV4T2YoJy8nKSsxKTsKICAgIH0qLwoKICB2YXIgcmVzdWx0ID0gewogICAgdHlwZTogcGFydHNbMF0sCiAgICBkb21haW46IHBhcnRzWzFdLAogICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgfTsKCiAgcmV0dXJuIHJlc3VsdDsKfQoKZnVuY3Rpb24gZGl2aWRlRW1haWwoZW1haWwpIHsKICB2YXIgaW5kZXhPZkF0ID0gZW1haWwuaW5kZXhPZignQCcpOwoKICB2YXIgcmVzdWx0ID0gewogICAgdXNlcm5hbWU6IGVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpLAogICAgZG9tYWluOiBlbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgZW1haWwubGVuZ3RoKQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBDaGVjayBpZiBhbiBPYmplY3QgaXMgZW1wdHkKICogQHBhcmFtICB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IHRvIGJlIGNoZWNrZWQKICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgc3RhdHVzIG9mIE9iamVjdCwgZW1wdHkgb3Igbm90ICh0cnVlfGZhbHNlKTsKICovCmZ1bmN0aW9uIGVtcHR5T2JqZWN0KG9iamVjdCkgewogIHJldHVybiAoMCwgX2tleXMyLmRlZmF1bHQpKG9iamVjdCkubGVuZ3RoID4gMCA/IGZhbHNlIDogdHJ1ZTsKfQoKLyoqCiAqIE1ha2UgYSBDT1BZIG9mIHRoZSBvcmlnaW5hbCBkYXRhCiAqIEBwYXJhbSAge09iamVjdH0gIG9iaiAtIG9iamVjdCB0byBiZSBjbG9uZWQKICogQHJldHVybiB7T2JqZWN0fQogKi8KZnVuY3Rpb24gZGVlcENsb25lKG9iaikgewogIC8vVE9ETzogc2ltcGxlIGJ1dCBpbmVmZmljaWVudCBKU09OIGRlZXAgY2xvbmUuLi4KICBpZiAob2JqKSByZXR1cm4gSlNPTi5wYXJzZSgoMCwgX3N0cmluZ2lmeTIuZGVmYXVsdCkob2JqKSk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIFVSTCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gZW1haWwKICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICogQHJldHVybiB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICovCmZ1bmN0aW9uIGdldFVzZXJVUkxGcm9tRW1haWwodXNlckVtYWlsKSB7CiAgdmFyIGluZGV4T2ZBdCA9IHVzZXJFbWFpbC5pbmRleE9mKCdAJyk7CiAgcmV0dXJuICd1c2VyOi8vJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgdXNlckVtYWlsLmxlbmd0aCkgKyAnLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIGVtYWlsIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBVUkwKICogQHBhcmFtICB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICogQHJldHVybiB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICovCmZ1bmN0aW9uIGdldFVzZXJFbWFpbEZyb21VUkwodXNlclVSTCkgewogIHZhciB1cmwgPSBkaXZpZGVVUkwodXNlclVSTCk7CiAgcmV0dXJuIHVybC5pZGVudGl0eS5yZXBsYWNlKCcvJywgJycpICsgJ0AnICsgdXJsLmRvbWFpbjsgLy8gaWRlbnRpdHkgZmllbGQgaGFzICcvZXhhbXBsZUlEJyBpbnN0ZWFkIG9mICdleGFtcGxlSUQnCn0KCi8qKgogKiBDaGVjayBpZiB0aGUgdXNlciBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIFVSTCBmb3JtYXQsIGlmIG5vdCwgY29udmVydCB0byBVUkwgZm9ybWF0CiAqIEBwYXJhbSAge3N0cmluZ30gICBpZGVudGlmaWVyICB1c2VyIGlkZW50aWZpZXIKICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMCiAqLwpmdW5jdGlvbiBjb252ZXJ0VG9Vc2VyVVJMKGlkZW50aWZpZXIpIHsKCiAgLy8gY2hlY2sgaWYgdGhlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgdXJsIGZvcm1hdAogIGlmIChpZGVudGlmaWVyLnN1YnN0cmluZygwLCA3KSA9PT0gJ3VzZXI6Ly8nKSB7CiAgICB2YXIgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChpZGVudGlmaWVyKTsKCiAgICAvL2NoZWNrIGlmIHRoZSB1cmwgaXMgd2VsbCBmb3JtYXRlZAogICAgaWYgKGRpdmlkZWRVUkwuZG9tYWluICYmIGRpdmlkZWRVUkwuaWRlbnRpdHkpIHsKICAgICAgcmV0dXJuIGlkZW50aWZpZXI7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyAndXNlclVSTCB3aXRoIHdyb25nIGZvcm1hdCc7CiAgICB9CgogICAgLy9pZiBub3QsIGNvbnZlcnQgdGhlIHVzZXIgZW1haWwgdG8gVVJMIGZvcm1hdAogIH0gZWxzZSB7CiAgICByZXR1cm4gZ2V0VXNlclVSTEZyb21FbWFpbChpZGVudGlmaWVyKTsKICB9Cn0KCi8qKiovIH0pLAovKiAxMTAgKi8sCi8qIDExMSAqLywKLyogMTEyICovLAovKiAxMTMgKi8sCi8qIDExNCAqLywKLyogMTE1ICovLAovKiAxMTYgKi8sCi8qIDExNyAqLywKLyogMTE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMik7Cgp2YXIgX2dldDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMyk7Cgp2YXIgX2dldDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXQyKTsKCnZhciBfaW5oZXJpdHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMyk7Cgp2YXIgX2luaGVyaXRzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2luaGVyaXRzMik7Cgp2YXIgX0RhdGFPYmplY3QyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjApOwoKdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCnZhciBfRGF0YU9iamVjdENoaWxkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjEpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdENoaWxkKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBGaWx0ZXJUeXBlID0geyBBTlk6ICdhbnknLCBTVEFSVDogJ3N0YXJ0JywgRVhBQ1Q6ICdleGFjdCcgfTsKCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBzdWJzY3JpYmUgY2FsbC4KICogVG8gYmUgdXNlZCBhcyBhbiBvYnNlcnZhdGlvbiBwb2ludCBmcm9tIGEgRGF0YU9iamVjdFJlcG9ydGVyIGNoYW5nZS4KICovCgp2YXIgRGF0YU9iamVjdE9ic2VydmVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CiAgKDAsIF9pbmhlcml0czMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBfRGF0YU9iamVjdCk7CgogIC8qIHByaXZhdGUKICBfY2hhbmdlTGlzdGVuZXI6IE1zZ0xpc3RlbmVyCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfZmlsdGVyczogezxmaWx0ZXI+OiB7dHlwZTogPHN0YXJ0LCBleGFjdD4sIGNhbGxiYWNrOiA8ZnVuY3Rpb24+fSB9CiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyLnN1YnNjcmliZSBtZXRob2QKICAgKi8KCiAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogIGZ1bmN0aW9uIERhdGFPYmplY3RPYnNlcnZlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucywgaW5pdGlhbFZlcnNpb24sIG11dHVhbCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdE9ic2VydmVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdE9ic2VydmVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YS5kYXRhLCBjaGlsZHJlbnMsIG11dHVhbCkpOwoKICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IGluaXRpYWxWZXJzaW9uOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewogICAgICBfdGhpcy5fb25GaWx0ZXIoZXZlbnQpOwogICAgfSk7CgogICAgLy9zZXR1cCBjaGlsZHJlbnMgZGF0YSBmcm9tIHN1YnNjcmlwdGlvbgogICAgKDAsIF9rZXlzMi5kZWZhdWx0KShpbml0aWFsRGF0YS5jaGlsZHJlbnMpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkSWQpIHsKICAgICAgdmFyIGNoaWxkRGF0YSA9IGluaXRpYWxEYXRhLmNoaWxkcmVuc1tjaGlsZElkXTsKICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBjaGlsZElkLCBjaGlsZERhdGEpOwogICAgfSk7CgogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwgKyAnL2NoYW5nZXMnLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgaWYgKG1zZy50eXBlID09PSAndXBkYXRlJykgewogICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwogICAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChfdGhpcy5fc3luY09iaiwgbXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICd1bnN1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsVW5TdWJzY3JpYmUKICAgICAgdmFyIHVuU3Vic2NyaWJlTXNnID0gewogICAgICAgIHR5cGU6ICd1bnN1YnNjcmliZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHVuU3Vic2NyaWJlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdE9ic2VydmVyLVVOU1VCU0NSSUJFOiAnLCByZXBseSk7CiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsdGVyIC0gRmlsdGVyIHRoYXQgaWRlbnRpZmllcyB0aGUgZmllbGQgKHNlcGFyYXRlZCBkb3QgcGF0aCkuIEFjY2VwdHMgKiBhdCB0aGUgZW5kIGZvciBhIG1vcmUgdW5yZXN0cmljdGVkIGZpbHRlcmluZy4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkNoYW5nZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2UoZmlsdGVyLCBjYWxsYmFjaykgewogICAgICB2YXIga2V5ID0gZmlsdGVyOwogICAgICB2YXIgZmlsdGVyT2JqID0gewogICAgICAgIHR5cGU6IEZpbHRlclR5cGUuRVhBQ1QsCiAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrCiAgICAgIH07CgogICAgICB2YXIgaWR4ID0gZmlsdGVyLmluZGV4T2YoJyonKTsKICAgICAgaWYgKGlkeCA9PT0gZmlsdGVyLmxlbmd0aCAtIDEpIHsKICAgICAgICBpZiAoaWR4ID09PSAwKSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuQU5ZOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuU1RBUlQ7CiAgICAgICAgICBrZXkgPSBmaWx0ZXIuc3Vic3RyKDAsIGZpbHRlci5sZW5ndGggLSAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuX2ZpbHRlcnNba2V5XSA9IGZpbHRlck9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25GaWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZpbHRlcihldmVudCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fZmlsdGVycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdmFyIGZpbHRlciA9IF90aGlzLl9maWx0ZXJzW2tleV07CiAgICAgICAgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLkFOWSkgewogICAgICAgICAgLy9tYXRjaCBhbnl0aGluZwogICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKICAgICAgICB9IGVsc2UgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLlNUQVJUKSB7CiAgICAgICAgICAvL2lmIHN0YXJ0cyB3aXRoIGZpbHRlci4uLgogICAgICAgICAgaWYgKGV2ZW50LmZpZWxkLmluZGV4T2Yoa2V5KSA9PT0gMCkgewogICAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuRVhBQ1QpIHsKICAgICAgICAgIC8vZXhhY3QgbWF0Y2gKICAgICAgICAgIGlmIChldmVudC5maWVsZCA9PT0ga2V5KSB7CiAgICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFPYmplY3RPYnNlcnZlcjsKfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdE9ic2VydmVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKdmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yKTsKCnZhciBfZ2V0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCnZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKdmFyIF9pbmhlcml0czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTsKCnZhciBfaW5oZXJpdHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5oZXJpdHMyKTsKCnZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCk7Cgp2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgY3JlYXRlIGNhbGwuCiAqIFRvIGJlIHVzZWQgYXMgYSByZXBvcnRlciBwb2ludCwgY2hhbmdlcyB3aWxsIGJlIHN1Ym1pdGVkIHRvIERhdGFPYmplY3RPYnNlcnZlciBpbnN0YW5jZXMuCiAqLwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBEYXRhT2JqZWN0UmVwb3J0ZXIgPSBmdW5jdGlvbiAoX0RhdGFPYmplY3QpIHsKICAoMCwgX2luaGVyaXRzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIF9EYXRhT2JqZWN0KTsKCiAgLyogcHJpdmF0ZQogIF9zdWJzY3JpcHRpb25zOiA8aHlwZXJ0eVVybDogeyBzdGF0dXM6IHN0cmluZyB9IH0+CiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25TdWJzY3JpcHRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICBfb25SZXNwb25zZUhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlYWRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuY3JlYXRlIG1ldGhvZAogICAqLwogIGZ1bmN0aW9uIERhdGFPYmplY3RSZXBvcnRlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdFJlcG9ydGVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdFJlcG9ydGVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSk7CgogICAgdmFyIF90aGlzID0gX3RoaXMyOwoKICAgIF90aGlzLl9zdWJzY3JpcHRpb25zID0ge307CgogICAgX3RoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci0nICsgdXJsICsgJy1TRU5EOiAnLCBldmVudCk7CiAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCk7CiAgICB9KTsKCiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgIHJldHVybiBfdGhpczI7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX2FsbG9jYXRlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9vYmplY3RMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgewogICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0LScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewogICAgICAgICAgY2FzZSAncmVzcG9uc2UnOgogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpO2JyZWFrOwogICAgICAgICAgY2FzZSAncmVhZCc6CiAgICAgICAgICAgIF90aGlzLl9vblJlYWQobXNnKTticmVhazsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX29iamVjdExpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogU2VuZCBpbnZpdGF0aW9ucyAoY3JlYXRlIG1lc3NhZ2VzKSB0byBoeXBlcnRpZXMsIG9ic2VydmVycyBsaXN0LgogICAgICogQHBhcmFtICB7SHlwZXJ0eVVSTFtdfSBvYnNlcnZlcnMgTGlzdCBvZiBIeXBlcnR5IFVSTCdzCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnaW52aXRlT2JzZXJ2ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnZpdGVPYnNlcnZlcnMob2JzZXJ2ZXJzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkNyZWF0ZQogICAgICB2YXIgaW52aXRlTXNnID0gewogICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fc3luY2hlci5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAogICAgICAgIGJvZHk6IHsgcmVzdW1lOiBmYWxzZSwgcmVzb3VyY2U6IF90aGlzLl91cmwsIHNjaGVtYTogX3RoaXMuX3NjaGVtYSwgdmFsdWU6IF90aGlzLl9zeW5jT2JqLmRhdGEsIGF1dGhvcmlzZTogb2JzZXJ2ZXJzIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoaW52aXRlTXNnKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uRGVsZXRlCiAgICAgIHZhciBkZWxldGVNc2cgPSB7CiAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGRlbGV0ZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1ERUxFVEU6ICcsIHJlcGx5KTsKICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX3JlcG9ydGVyc1tfdGhpcy5fdXJsXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU3Vic2NyaXB0aW9ucyByZXF1ZXN0ZWQgYW5kIGFjY2VwdGVkIHRvIHRoaXMgcmVwb3J0ZXIKICAgICAqIEB0eXBlIHtPYmplY3Q8SHlwZXJ0eVVSTCwgU3luY1N1YnNjcmlwdGlvbj59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25TdWJzY3JpcHRpb24nLAoKCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHN1YnNjcmliZSBhbmQgdW5zdWJzY3JpYmUgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TdWJzY3JpcHRpb24oY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZXNwb25zZSBub3RpZmljYXRpb25zIG9mIHRoZSBjcmVhdGUncwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlYWQgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVhZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZWFkKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVhZEhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBwYXJlbnQgU3luY2hlciAtPiBfb25Gb3J3YXJkCgogIH0sIHsKICAgIGtleTogJ19vbkZvcndhcmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLVJDVjogJywgbXNnKTsKICAgICAgc3dpdGNoIChtc2cuYm9keS50eXBlKSB7CiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblN1YnNjcmliZShtc2cpO2JyZWFrOwogICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGlzIC0+IF9vbkZvcndhcmQ6IGVtaXR0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBzdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uU3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdWJzY3JpYmUobXNnKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwogICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RSZXBvcnRlci5fb25TdWJzY3JpYmVdJywgbXNnKTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIC8vY3JlYXRlIG5ldyBzdWJzY3JpcHRpb24KICAgICAgICAgIHZhciBzdWIgPSB7IHVybDogaHlwZXJ0eVVybCwgc3RhdHVzOiAnb24nIH07CiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjsKCiAgICAgICAgICAvL3Byb2Nlc3MgYW5kIHNlbmQgY2hpbGRyZW5zIGRhdGEKICAgICAgICAgIHZhciBjaGlsZHJlblZhbHVlcyA9IHt9OwogICAgICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CiAgICAgICAgICAgIHZhciBjaGlsZERhdGEgPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLmRhdGE7CiAgICAgICAgICAgIGNoaWxkcmVuVmFsdWVzW2NoaWxkSWRdID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGNoaWxkRGF0YSk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgc2VuZE1zZyA9IHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoX3RoaXMuZGF0YSksIGNoaWxkcmVuczogY2hpbGRyZW5WYWx1ZXMgfSB9CiAgICAgICAgICB9OwoKICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsQXV0aGVudGljYXRpb24nKSAmJiAhbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24pIHsKICAgICAgICAgICAgc2VuZE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbjsKICAgICAgICAgICAgX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBvayByZXNwb25zZSBtZXNzYWdlCiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHNlbmRNc2cpOwoKICAgICAgICAgIHJldHVybiBzdWI7CiAgICAgICAgfSwKCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7CiAgICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdTVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoaXMgLT4gX29uRm9yd2FyZDogZW1pdHRlZCBieSBhIHJlbW90ZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgLT4gdW5zdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uVW5TdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblVuU3Vic2NyaWJlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgaHlwZXJ0eVVybCA9IG1zZy5ib2R5LmZyb207CgogICAgICB2YXIgc3ViID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CiAgICAgIGRlbGV0ZSBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKICAgICAgICBvYmplY3Q6IHN1YgogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBSZXBvcnRlclVSTCBhZGRyZXNzOiBlbWl0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBfb25SZW1vdGVDcmVhdGUgLT4gZXZlbnQuYWNrCgogIH0sIHsKICAgIGtleTogJ19vblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZXNwb25zZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICB1cmw6IG1zZy5mcm9tLAogICAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGUKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVTUE9OU0UtRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gcmVhZAoKICB9LCB7CiAgICBrZXk6ICdfb25SZWFkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWFkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmZyb20sCgogICAgICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgdmFsdWU6ICgwLCBfdXRpbHMuZGVlcENsb25lKShfdGhpcy5kYXRhKSB9CiAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDEsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uUmVhZEhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVBRC1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblJlYWRIYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3N1YnNjcmlwdGlvbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdFJlcG9ydGVyOwp9KF9EYXRhT2JqZWN0My5kZWZhdWx0IC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0UmVwb3J0ZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEyMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9wcm9taXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7Cgp2YXIgX3Byb21pc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvbWlzZSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX1Byb3h5T2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKdmFyIF9Qcm94eU9iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Qcm94eU9iamVjdCk7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCnZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7Cgp2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBNYWluIGV4dGVuc2lvbiBjbGFzcyBmb3Igb2JzZXJ2ZXJzIGFuZCByZXBvcnRlcnMsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIG1ldGhvZHMuCiAqIENoaWxkcmVuIG1hbmFnZW1lbnQgaXMgY29tbW9uIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycy4KICovCnZhciBEYXRhT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICBfdmVyc2lvbjogbnVtYmVyCiAgIF9vd25lcjogSHlwZXJ0eVVSTAogIF91cmw6IE9iamVjdFVSTAogIF9zY2hlbWE6IFNjaGVtYQogIF9idXM6IE1pbmlCdXMKICBfc3RhdHVzOiBvbiB8IHBhdXNlZAogIF9zeW5jT2JqOiBTeW5jRGF0YQogICBfY2hpbGRyZW46IHsgaWQ6IERhdGFPYmplY3RDaGlsZCB9CiAgX2NoaWxkcmVuTGlzdGVuZXJzOiBbTXNnTGlzdGVuZXJdCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25BZGRDaGlsZEhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogICovCgogIC8qKgogICAqIEBpZ25vcmUKICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlciBjcmVhdGUgb3Igc3Vic2NyaWJlIG1ldGhvZCdzCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdChzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgdmFyIG11dHVhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDogdHJ1ZTsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX3N5bmNoZXIgPSBzeW5jaGVyOwogICAgX3RoaXMuX3VybCA9IHVybDsKICAgIF90aGlzLl9zY2hlbWEgPSBzY2hlbWE7CiAgICBfdGhpcy5fc3RhdHVzID0gaW5pdGlhbFN0YXR1czsKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CiAgICBfdGhpcy5fY2hpbGRyZW5zID0gY2hpbGRyZW5zOwoKICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgIF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbDsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IDA7CiAgICBfdGhpcy5fY2hpbGRJZCA9IDA7CiAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzID0ge307CiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTsKCiAgICBfdGhpcy5fb3duZXIgPSBzeW5jaGVyLl9vd25lcjsKICAgIF90aGlzLl9idXMgPSBzeW5jaGVyLl9idXM7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0LCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBjaGlsZEJhc2VVUkwgPSBfdGhpcy5fdXJsICsgJy9jaGlsZHJlbi8nOwogICAgICBjb25zb2xlLmxvZygnW0RhdGEgT2JqZWN0IC0gQWxsb2NhdGVMaXN0ZW5lcnNdIC0gJywgX3RoaXMuX2NoaWxkcmVucyk7CiAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW5zKSB7CiAgICAgICAgX3RoaXMuX2NoaWxkcmVucy5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkgewogICAgICAgICAgdmFyIGNoaWxkVVJMID0gY2hpbGRCYXNlVVJMICsgY2hpbGQ7CiAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgICAgICAgaWYgKG1zZy5mcm9tICE9PSBfdGhpczIuX293bmVyKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3QtQ2hpbGRyZW4tUkNWOiAnLCBtc2cpOwogICAgICAgICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6CiAgICAgICAgICAgICAgICAgIF90aGlzLl9vbkNoaWxkQ3JlYXRlKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOgogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO2JyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgX3RoaXMuX2NoYW5nZUNoaWxkcmVuKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHsKICAgICAgICBsaXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfSk7CgogICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNba2V5XS5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBVUkwgb2YgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIKICAgICAqIEB0eXBlIHtPYmplY3RVUkx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncGF1c2UnLAoKCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkgewogICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CiAgICB9CgogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncmVzdW1lJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7CiAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdG9wJywKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICAvL1RPRE86IHNob3VsZCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBhbmQgc2VuZCBtZXNzYWdlIHVuc3Vic2NyaWJlPwogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgYWRkIGEgRGF0YU9iamVjdENoaWxkIHRvIGEgY2hpbGRyZW4gY29sbGVjdGlvbi4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGlsZHJlbiAtIENoaWxkcmVuIG5hbWUgd2hlcmUgdGhlIGNoaWxkIGlzIGFkZGVkLgogICAgICogQHBhcmFtIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgY2hpbGQKICAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdENoaWxkPn0gLSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBEYXRhT2JqZWN0Q2hpbGQuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnYWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENoaWxkKGNoaWxkcmVuLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9jcmVhdGUgbmV3IGNoaWxkIHVuaXF1ZSBJRCwgYmFzZWQgb24gaHlwZXJ0eVVSTAogICAgICBfdGhpcy5fY2hpbGRJZCsrOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IF90aGlzLl9vd25lciArICcjJyArIF90aGlzLl9jaGlsZElkOwogICAgICB2YXIgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJyArIGNoaWxkcmVuOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoaWxkIGFkZHJlc3M6IE1lc3NhZ2VCdXMKICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IG1zZ0NoaWxkUGF0aCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBtc2dDaGlsZElkLCB2YWx1ZTogaW5pdGlhbERhdGEgfQogICAgICB9OwoKICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgcmVxdWVzdE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uOwoKICAgICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbAogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgdmFyIG1zZ0lkID0gX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXF1ZXN0TXNnKTsKCiAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZS1yZXBvcnRlci1jaGlsZCggJyArIF90aGlzLl9vd25lciArICcgKTogJywgcmVxdWVzdE1zZyk7CiAgICAgICAgdmFyIG5ld0NoaWxkID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIG1zZ0NoaWxkSWQsIGluaXRpYWxEYXRhLCBfdGhpcy5fb3duZXIsIG1zZ0lkKTsKICAgICAgICBuZXdDaGlsZC5vbkNoYW5nZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCwgeyBwYXRoOiBtc2dDaGlsZFBhdGgsIGNoaWxkSWQ6IG1zZ0NoaWxkSWQgfSk7CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgICAgcmVzb2x2ZShuZXdDaGlsZCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgY3JlYXRlIGFuZCBkZWxldGUgb2YgY2hpbGRyZW5zLgogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uQWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQWRkQ2hpbGQoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IGFkZENoaWxkCgogIH0sIHsKICAgIGtleTogJ19vbkNoaWxkQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGlsZENyZWF0ZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIG1zZ0NoaWxkSWQgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUtb2JzZXJ2ZXItY2hpbGQoICcgKyBfdGhpcy5fb3duZXIgKyAnICk6ICcsIG1zZyk7CiAgICAgIHZhciBuZXdDaGlsZCA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBtc2dDaGlsZElkLCBtc2cuYm9keS52YWx1ZSk7CiAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIC8vRkxPVy1PVVQ6IHdpbGwgZmxvdyB0byBEYXRhT2JqZWN0Q2hpbGQgLT4gX29uUmVzcG9uc2UKICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHNvdXJjZTogX3RoaXMuX293bmVyIH0KICAgICAgICB9KTsKICAgICAgfSk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmZyb20sCiAgICAgICAgdXJsOiBtc2cudG8sCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGNoaWxkSWQ6IG1zZ0NoaWxkSWQsCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ0FERC1DSElMRFJFTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL3NlbmQgZGVsdGEgbWVzc2FnZXMgdG8gc3Vic2NyaXB0aW9ucwoKICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoYW5nZShldmVudCwgY2hpbGRJbmZvKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fdmVyc2lvbisrOwoKICAgICAgaWYgKF90aGlzLl9zdGF0dXMgPT09ICdvbicpIHsKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIGEgcmVzb3VyY2UgY2hhbmdlcyBhZGRyZXNzOiBNZXNzYWdlQnVzCiAgICAgICAgdmFyIGNoYW5nZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogX3RoaXMuX3VybCArICcvY2hhbmdlcycsCiAgICAgICAgICBib2R5OiB7IHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCBzb3VyY2U6IF90aGlzLl9vd25lciwgYXR0cmlidXRlOiBldmVudC5maWVsZCB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0IC0gX29uQ2hhbmdlXSAtICcsIGV2ZW50LCBjaGlsZEluZm8sIGNoYW5nZU1zZyk7CgogICAgICAgIGlmIChldmVudC5vVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuT0JKRUNUKSB7CiAgICAgICAgICBpZiAoZXZlbnQuY1R5cGUgIT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPSBldmVudC5vVHlwZTsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKICAgICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuVVBEQVRFKSB7CiAgICAgICAgICAgIGNoYW5nZU1zZy5ib2R5Lm9wZXJhdGlvbiA9IGV2ZW50LmNUeXBlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy9jaGlsZEluZm8gbXVzdCBoYXZlIChwYXRoLCBjaGlsZElkKQogICAgICAgIGlmIChjaGlsZEluZm8pIHsKICAgICAgICAgIGNoYW5nZU1zZy50byA9IGNoaWxkSW5mby5wYXRoOwogICAgICAgICAgY2hhbmdlTXNnLmJvZHkucmVzb3VyY2UgPSBjaGlsZEluZm8uY2hpbGRJZDsKICAgICAgICB9CgogICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgY2hhbmdlTXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoY2hhbmdlTXNnKTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogZGVsdGEgbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RSZXBvcnRlciBvciBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VPYmplY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VPYmplY3Qoc3luY09iaiwgbXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL1RPRE86IHVwZGF0ZSB2ZXJzaW9uID8KICAgICAgLy9ob3cgdG8gaGFuZGxlIGFuIGluY29ycmVjdCB2ZXJzaW9uID8gRXhhbXBsZTogcmVjZWl2ZSBhIHZlcnNpb24gMyB3aGVuIHRoZSBvYnNlcnZlciBpcyBpbiB2ZXJzaW9uIDEsIHdoZXJlIGlzIHRoZSB2ZXJzaW9uIDIgPwogICAgICAvL3dpbGwgd2UgbmVlZCB0byBjb25maXJtIHRoZSByZWNlcHRpb24gPwogICAgICBpZiAoX3RoaXMuX3ZlcnNpb24gKyAxID09PSBtc2cuYm9keS52ZXJzaW9uKSB7CiAgICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKICAgICAgICB2YXIgcGF0aCA9IG1zZy5ib2R5LmF0dHJpYnV0ZTsKICAgICAgICB2YXIgdmFsdWUgPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkobXNnLmJvZHkudmFsdWUpOwogICAgICAgIHZhciBmaW5kUmVzdWx0ID0gc3luY09iai5maW5kQmVmb3JlKHBhdGgpOwoKICAgICAgICBpZiAobXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuQVJSQVkpIHsKICAgICAgICAgIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLkFERCkgewogICAgICAgICAgICB2YXIgYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBpbmRleCA9IGZpbmRSZXN1bHQubGFzdDsKICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShhcnIsIFtpbmRleCwgMF0uY29uY2F0KHZhbHVlKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CiAgICAgICAgICAgIHZhciBfYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBfaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIF9hcnIuc3BsaWNlKF9pbmRleCwgdmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XSA9IHZhbHVlOyAvLyBVUERBVEUKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKG1zZy5ib2R5LnZhbHVlKSB7CiAgICAgICAgICAgIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF0gPSB2YWx1ZTsgLy8gVVBEQVRFIG9yIEFERAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVsZXRlIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF07IC8vIFJFTU9WRQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvL1RPRE86IGhvdyB0byBoYW5kbGUgdW5zeW5jaHJvbml6ZWQgdmVyc2lvbnM/CiAgICAgICAgY29uc29sZS5sb2coJ1VOU1lOQ0hST05JWkVEIFZFUlNJT046IChkYXRhID0+ICcgKyBfdGhpcy5fdmVyc2lvbiArICcsIG1zZyA9PiAnICsgbXNnLmJvZHkudmVyc2lvbiArICcpJyk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VDaGlsZHJlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NoYW5nZUNoaWxkcmVuKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBjb25zb2xlLmxvZygnQ2hhbmdlIGNoaWxkcmVuOiAnLCBfdGhpcy5fb3duZXIsIG1zZyk7CgogICAgICB2YXIgY2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlOwogICAgICB2YXIgY2hpbGRyZW4gPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdOwoKICAgICAgaWYgKGNoaWxkcmVuKSB7CiAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChjaGlsZHJlbi5fc3luY09iaiwgbXNnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygnTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAnLCBjaGlsZElkKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3VybCcsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3VybDsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBzY2hlbWEgVVJMICh0aGlzIGZpZWxkIGlzIG5vdCB5ZXQgc3RhYmxlLCBhbmQgaXMgc3Vic2plY3QgdG8gY2hhbmdlKQogICAgICogQHR5cGUge1NjaGVtYVVSTH0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzY2hlbWEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zY2hlbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdGF0dXMgb2YgdGhlIHJlcG9ydGVyIG9yIG9ic2VydmVyIGNvbm5lY3Rpb24gKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpCiAgICAgKiBAdHlwZSB7U3RhdHVzfSAtIEVudW0gb2Y6IG9uIHwgcGF1c2VkCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnc3RhdHVzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3RhdHVzOwogICAgfQoKICAgIC8qKgogICAgICogRGF0YSBzdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLgogICAgICogQHR5cGUge0pTT059IC0gSlNPTiBzdHJ1Y3R1cmUgdGhhdCBzaG91bGQgZm9sbG93IHRoZSBkZWZpbmVkIHNjaGVtYSwgaWYgYW55LgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RhdGEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGwgY3JlYXRlZCBjaGlsZHJlbidzIHNpbmNlIHRoZSBzdWJzY3JpcHRpb24sIGRvZXNuJ3QgY29udGFpbiBhbGwgY2hpbGRyZW4ncyBzaW5jZSByZXBvcnRlciBjcmVhdGlvbi4KICAgICAqIEB0eXBlIHtPYmplY3Q8Q2hpbGRJZCwgRGF0YU9iamVjdENoaWxkPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdjaGlsZHJlbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhT2JqZWN0Owp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTIxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIyKTsKCnZhciBfUHJveHlPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUHJveHlPYmplY3QpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgRGF0YU9iamVjdCBhZGRDaGlsZHJlbiBjYWxsIG9yIGZyb20gb25BZGRDaGlsZHJlbiBpZiByZW1vdGVseSBjcmVhdGVkLgogKiBDaGlsZHJlbiBvYmplY3Qgc3luY2hyb25pemF0aW9uIGlzIGEgYSBmYXN0IGZvcndhcmQgbWVjaGFuaXNtLCBubyBuZWVkIGZvciBkaXJlY3Qgc3Vic2NyaXB0aW9ucywgaXQgdXNlcyB0aGUgYWxyZWFkeSBhdXRob3JpemVkIHN1YnNjcmlwdGlvbiBmcm9tIHRoZSBwYXJlbnQgRGF0YU9iamVjdC4KICovCnZhciBEYXRhT2JqZWN0Q2hpbGQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBEYXRhT2JqZWN0LmFkZENoaWxkcmVuCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdENoaWxkKHBhcmVudCwgY2hpbGRJZCwgaW5pdGlhbERhdGEsIG93bmVyLCBtc2dJZCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdENoaWxkKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9wYXJlbnQgPSBwYXJlbnQ7CiAgICBfdGhpcy5fY2hpbGRJZCA9IGNoaWxkSWQ7CiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl9tc2dJZCA9IG1zZ0lkOwoKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CgogICAgX3RoaXMuX2J1cyA9IHBhcmVudC5fYnVzOwogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0Q2hpbGQsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vdGhpcyBpcyBvbmx5IG5lZWRlZCBmb3IgY2hpbGRyZW4gcmVwb3J0ZXJzCiAgICAgIGlmIChfdGhpcy5fb3duZXIpIHsKICAgICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl9vd25lciwgZnVuY3Rpb24gKG1zZykgewogICAgICAgICAgaWYgKG1zZy50eXBlID09PSAncmVzcG9uc2UnICYmIG1zZy5pZCA9PT0gX3RoaXMuX21zZ0lkKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZTonLCBtc2cpOwogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKF90aGlzLl9saXN0ZW5lcikgewogICAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgZGVsZXRlIF90aGlzLl9wYXJlbnQuX2NoaWxkcmVuW190aGlzLl9jaGlsZElkXTsKCiAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgogICAgICAvL1RPRE86IHNlbmQgZGVsZXRlIG1lc3NhZ2UgPwogICAgfQoKICAgIC8qKgogICAgICogQ2hpbGRyZW4gSUQgZ2VuZXJhdGVkIG9uIGFkZENoaWxkcmVuLiBVbmlxdWUgaWRlbnRpZmllcgogICAgICogQHR5cGUge1VSTH0gLSBVUkwgb2YgdGhlIGZvcm1hdCA8SHlwZXJ0eVVSTD4jPG51bWVyaWMtc2VxdWVuY2U+CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25DaGFuZ2UnLAoKCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyIGNoaWxkCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZShjYWxsYmFjaykgewogICAgICB0aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlc3BvbnNlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIGNyZWF0ZXMKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlc3BvbnNlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVzcG9uc2VIYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdCAtPiBfb25DaGlsZENyZWF0ZQoKICB9LCB7CiAgICBrZXk6ICdfb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVzcG9uc2UobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgdXJsOiBtc2cuYm9keS5zb3VyY2UsCiAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdjaGlsZElkJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKICAgIH0KCiAgICAvKioKICAgICAqIERhdGEgU3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC4KICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdENoaWxkOwp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdENoaWxkOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5PYmplY3RUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0gdW5kZWZpbmVkOwoKdmFyIF9zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCnZhciBfc3RyaW5naWZ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmeSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKX193ZWJwYWNrX3JlcXVpcmVfXygxNTMpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBvYmplY3RUeXBlID0geyBBUlJBWTogJ1tvYmplY3QgQXJyYXldJywgT0JKRUNUOiAnW29iamVjdCBPYmplY3RdJyB9OwoKLyoqCiAqIEBhY2Nlc3MgcHJpdmF0ZQogKiBNYWluIGNsYXNzIHRoYXQgbWFpbnRhaW5zIGEgSlNPTiBvYmplY3QsIGFuZCBvYnNlcnZlcyBjaGFuZ2VzIGluIHRoaXMgb2JqZWN0LCByZWN1cnNpdmVseS4KICogSW50ZXJuYWwgb2JqZWN0cyBhbmQgYXJyYXlzIGFyZSBhbHNvIG9ic2VydmVkLgogKi8KCnZhciBTeW5jT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFN5bmNPYmplY3QoaW5pdGlhbERhdGEpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFN5bmNPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX29ic2VydmVycyA9IFtdOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICB0aGlzLl9kYXRhID0gaW5pdGlhbERhdGEgfHwge307CgogICAgdGhpcy5faW50ZXJuYWxPYnNlcnZlKHRoaXMuX2RhdGEpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoU3luY09iamVjdCwgW3sKICAgIGtleTogJ29ic2VydmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnB1c2goY2FsbGJhY2spOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmQocGF0aCkgewogICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCiAgICAgIHJldHVybiB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmRCZWZvcmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRCZWZvcmUocGF0aCkgewogICAgICB2YXIgcmVzdWx0ID0ge307CiAgICAgIHZhciBsaXN0ID0gcGF0aC5zcGxpdCgnLicpOwogICAgICByZXN1bHQubGFzdCA9IGxpc3QucG9wKCk7CiAgICAgIHJlc3VsdC5vYmogPSB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmluZFdpdGhTcGxpdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbmRXaXRoU3BsaXQobGlzdCkgewogICAgICB2YXIgb2JqID0gdGhpcy5fZGF0YTsKICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIG9iaiA9IG9ialt2YWx1ZV07CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIG9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfaXNPYnNlcnZhYmxlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNPYnNlcnZhYmxlKG9iaikgewogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBPYmplY3QgfHwgb2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2ludGVybmFsT2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsT2JzZXJ2ZShvYmplY3QpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoY2hhbmdlc2V0KSB7CgogICAgICAgIGNoYW5nZXNldC5ldmVyeShmdW5jdGlvbiAoY2hhbmdlKSB7CiAgICAgICAgICBfdGhpczIuX29uQ2hhbmdlcyhjaGFuZ2UpOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgdGhpcy5fZGF0YSA9IE9iamVjdC5kZWVwT2JzZXJ2ZShvYmplY3QsIGhhbmRsZXIpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19maXJlRXZlbnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maXJlRXZlbnQoZXZlbnQpIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2VzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2VzKGNoYW5nZSkgewoKICAgICAgdmFyIG9iaiA9IGNoYW5nZS5vYmplY3Q7CiAgICAgIHZhciBvYmpUeXBlID0gdm9pZCAwOwoKICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuT0JKRUNUOwogICAgICB9CgogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIG9ialR5cGUgPSBPYmplY3RUeXBlLkFSUkFZOwogICAgICB9CgogICAgICB2YXIgZmllbGRTdHJpbmcgPSBjaGFuZ2Uua2V5cGF0aDsKCiAgICAgIC8vIGNvbnNvbGUubG9nKCdGaWVsZDonLCBmaWVsZFN0cmluZyk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCd0eXBlOicsIGNoYW5nZS50eXBlKTsKCiAgICAgIC8vbGV0IG9sZFZhbHVlID0gY2hhbmdlLm9sZFZhbHVlOwogICAgICB2YXIgbmV3VmFsdWUgPSBvYmpbY2hhbmdlLm5hbWVdOwoKICAgICAgY29uc29sZS5pbmZvKGNoYW5nZS50eXBlICsgJyB8IEZpZWxkOiAnICsgZmllbGRTdHJpbmcgKyAnIHwgTmV3IFZhbHVlOicsICgwLCBfc3RyaW5naWZ5Mi5kZWZhdWx0KShuZXdWYWx1ZSkpOwoKICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAndXBkYXRlJykgewogICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5VUERBVEUsCiAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZywKICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2FkZCcpIHsKICAgICAgICB0aGlzLl9maXJlRXZlbnQoewogICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuQURELAogICAgICAgICAgb1R5cGU6IG9ialR5cGUsCiAgICAgICAgICBmaWVsZDogZmllbGRTdHJpbmcsCiAgICAgICAgICBkYXRhOiBuZXdWYWx1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdkZWxldGUnKSB7CiAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLlJFTU9WRSwKICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fZGF0YTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFN5bmNPYmplY3Q7Cn0oKTsKCnZhciBDaGFuZ2VUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0geyBVUERBVEU6ICd1cGRhdGUnLCBBREQ6ICdhZGQnLCBSRU1PVkU6ICdyZW1vdmUnIH07CnZhciBPYmplY3RUeXBlID0gZXhwb3J0cy5PYmplY3RUeXBlID0geyBPQkpFQ1Q6ICdvYmplY3QnLCBBUlJBWTogJ2FycmF5JyB9OwpleHBvcnRzLmRlZmF1bHQgPSBTeW5jT2JqZWN0OwoKLyoqKi8gfSksCi8qIDEyMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzOCk7Cgp2YXIgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgewogIGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsKICB2YXIgZGVzYyA9ICgwLCBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMi5kZWZhdWx0KShvYmplY3QsIHByb3BlcnR5KTsKCiAgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgewogICAgdmFyIHBhcmVudCA9ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKG9iamVjdCk7CgogICAgaWYgKHBhcmVudCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7CiAgICB9CiAgfSBlbHNlIGlmICgidmFsdWUiIGluIGRlc2MpIHsKICAgIHJldHVybiBkZXNjLnZhbHVlOwogIH0gZWxzZSB7CiAgICB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7CgogICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsKICB9Cn07CgovKioqLyB9KSwKLyogMTI0ICovLAovKiAxMjUgKi8sCi8qIDEyNiAqLywKLyogMTI3ICovLAovKiAxMjggKi8sCi8qIDEyOSAqLywKLyogMTMwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX3Byb21pc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCnZhciBfYXNzaWduID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzYpOwoKdmFyIF9hc3NpZ24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXNzaWduKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE5KTsKCnZhciBfRGF0YU9iamVjdFJlcG9ydGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RSZXBvcnRlcik7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE4KTsKCnZhciBfRGF0YU9iamVjdE9ic2VydmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RPYnNlcnZlcik7Cgp2YXIgX0RhdGFQcm92aXNpb25hbCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMzKTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFQcm92aXNpb25hbCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogVGhlIG1haW4gY2xhc3MgZm9yIHRoZSBzeW5jaGVyIHBhY2thZ2UuCiogVGhlIFN5bmNoZXIgaXMgYSBzaW5nbGV0b24gY2xhc3MgcGVyIEh5cGVydHkvVVJMIGFuZCBpdCBpcyB0aGUgb3duZXIgb2YgYWxsIGNyZWF0ZWQgRGF0YSBTeW5jIE9iamVjdHMgYWNjb3JkaW5nIHRvIHRoZSBSZXBvcnRlciAtIE9ic2VydmVyIHBhdHRlcm4uCiogTWFpbiBmdW5jdGlvbmFsaXR5IGlzIHRvIGNyZWF0ZSByZXBvcnRlcnMgYW5kIHRvIHN1YnNjcmliZSB0byBleGlzdGluZyBvbmVzLgoqLwp2YXIgU3luY2hlciA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgX293bmVyOiBVUkwKICBfYnVzOiBNaW5pQnVzCiAgIF9zdWJVUkw6IFVSTAogICBfcmVwb3J0ZXJzOiA8dXJsOiBEYXRhT2JqZWN0UmVwb3J0ZXI+CiAgX29ic2VydmVyczogPHVybDogRGF0YU9iamVjdE9ic2VydmVyPgogIF9wcm92aXNpb25hbHM6IDx1cmw6IERhdGFQcm92aXNpb25hbD4KICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vbk5vdGlmaWNhdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlc3VtZTogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgKiBDb25zdHJ1Y3RvciB0aGF0IHNob3VsZCBiZSB1c2VkIGJ5IHRoZSBIeXBlcnR5IG93bmVyCiAgKiBAcGFyYW0ge0h5cGVydHlVUkx9IG93bmVyIC0gSHlwZXJ0eSBVUkwgb3duZXIuIEFuIFVSTCBhbGxvY2F0ZWQgYnkgdGhlIHJ1bnRpbWUgdGhhdCB1bmlxdWVseSBpZGVudGlmaWVzIHRoZSBIeXBlcnR5LgogICogQHBhcmFtIHtNaW5pQnVzfSBidXMgLSBBbiBpbnN0YW5jZSBvZiB0aGUgTWluaUJ1cyBwcm92aWRlZCBpbiB0aGUgc2FuZGJveC4gV2hlbiBhbiBvYmplY3QgKFJlcG9ydGVyIG9yIE9ic2VydmVkKSBpcyBjcmVhdGVkLCB0aGUgU3luY2hlck1hbmFnZXIgd2lsbCBhZGQgYSBsaXN0ZW5lciBpbiB0aGUgTWluaUJ1cyB0byByZWNlaXZlL3NlbmQgTWVzc2FnZXMgb2YgdGhhdCBvYmplY3QuCiAgKiBAcGFyYW0ge0pTT059IGNvbmZpZyAtIENvbmZpZ3VyYXRpb24gZGF0YS4gVGhlIG9ubHkgcmVxdWlyZWQgZmllbGQgZm9yIG5vdyBpcyB0aGUgcnVudGltZVVSTC4KICAqLwogIGZ1bmN0aW9uIFN5bmNoZXIob3duZXIsIGJ1cywgY29uZmlnKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBTeW5jaGVyKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX2J1cyA9IGJ1czsKCiAgICBfdGhpcy5fc3ViVVJMID0gY29uZmlnLnJ1bnRpbWVVUkwgKyAnL3NtJzsKCiAgICBfdGhpcy5fcmVwb3J0ZXJzID0ge307CiAgICBfdGhpcy5fb2JzZXJ2ZXJzID0ge307CiAgICBfdGhpcy5fcHJvdmlzaW9uYWxzID0ge307CgogICAgYnVzLmFkZExpc3RlbmVyKG93bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikgewogICAgICAgIGNvbnNvbGUuaW5mbygnW1N5bmNoZXJdIFN5bmNoZXItUkNWOiAnLCBtc2cpOwogICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgIGNhc2UgJ2ZvcndhcmQnOgogICAgICAgICAgICBfdGhpcy5fb25Gb3J3YXJkKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdjcmVhdGUnOgogICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVDcmVhdGUobXNnKTticmVhazsKICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAgIF90aGlzLl9vblJlbW90ZURlbGV0ZShtc2cpO2JyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQoKICAvKioKICAqIFRoZSBvd25lciBvZiB0aGUgU3luY2hlciBhbmQgYWxsIGNyZWF0ZWQgcmVwb3J0ZXJzLgogICogQHR5cGUge0h5cGVydHlVUkx9CiAgKi8KCgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKFN5bmNoZXIsIFt7CiAgICBrZXk6ICdjcmVhdGUnLAoKCiAgICAvKioKICAgICogUmVxdWVzdCBhIERhdGFPYmplY3RSZXBvcnRlciBjcmVhdGlvbi4gVGhlIFVSTCB3aWxsIGJlIGJlIHJlcXVlc3RlZCBieSB0aGUgYWxsb2NhdGlvbiBtZWNoYW5pc20uCiAgICAqIEBwYXJhbSAge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hCiAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIC0gTGlzdCBvZiBoeXBlcnRpZXMgdGhhdCBhcmUgcHJlLWF1dGhvcml6ZWQgZm9yIHN1YnNjcmlwdGlvbgogICAgKiBAcGFyYW0gIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICogQHBhcmFtICB7c3RyaW5nfSBvYmplY3RVUkwgLSByZXVzYWJsZSBkYXRhT2JqZWN0IFVSTAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IFJlcG9ydGVyLiBUaGUgcmVwb3J0ZXIgY2FuIGJlIGFjY2VwdGVkIG9yIHJlamVjdGVkIGJ5IHRoZSBQRVAKICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKHNjaGVtYSwgb2JzZXJ2ZXJzLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgc3RvcmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgcDJwID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiBmYWxzZTsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBjcml0ZXJpYSA9IHt9OwoKICAgICAgY3JpdGVyaWEucDJwID0gcDJwOwogICAgICBjcml0ZXJpYS5zdG9yZSA9IHN0b3JlOwogICAgICBjcml0ZXJpYS5zY2hlbWEgPSBzY2hlbWE7CiAgICAgIGNyaXRlcmlhLm9ic2VydmVycyA9IG9ic2VydmVyczsKICAgICAgY3JpdGVyaWEuaW5pdGlhbERhdGEgPSBpbml0aWFsRGF0YTsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUgUmVwb3J0ZXIgLSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogZmFsc2UgfSk7CgogICAgICByZXR1cm4gX3RoaXMuX2NyZWF0ZShjcml0ZXJpYSk7CiAgICB9CiAgfSwgewogICAga2V5OiAncmVzdW1lUmVwb3J0ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVSZXBvcnRlcnMoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBSZXBvcnRlciAtIGNyaXRlcmlhOiAnLCBjcml0ZXJpYSk7CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiB0cnVlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9jcmVhdGUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtTY2hlbWFVUkx9IHNjaGVtYSAtIEh5cGVydHkgQ2F0YWxvZ3VlIFVSTCBhZGRyZXNzIHRoYXQgY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIEpTT04tU2NoZW1hIGRlc2NyaWJpbmcgdGhlIERhdGEgT2JqZWN0IHNjaGVtYQogICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gQWRkcmVzcyBvZiB0aGUgZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIG9ic2VydmVkCiAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3N0b3JlPWZhbHNlXSAtIFNhdmUgdGhlIHN1YnNjcmlwdGlvbiBvbiB0aGUgU3luY2hlciBNYW5hZ2VyIGZvciBmdXJ0aGVyIHJlc3VtZSAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbcDJwPWZhbHNlXSAtIEluZm8gYWJvdXQgaWYgc2hvdWxkIHVzZSBwMnAgY29ubmVjdGlvbiAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbbXV0dWFsPXRydWVdIC0gSW5mbyBhYm91dCBpZiBtZXNzYWdlcyBvZiB0aGlzIG9iamVjdCBzaG91bGQgYmUgZW5jcnlwdGVkIChEZWZhdWx0IGlzIHRydWUpCiAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdE9ic2VydmVyPn0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgb2JzZXJ2ZXIuIEl0J3MgYXNzb2NpYXRlZCB3aXRoIHRoZSByZXBvcnRlci4KICAgICovCgogIH0sIHsKICAgIGtleTogJ3N1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3Vic2NyaWJlKHNjaGVtYSwgb2JqVVJMKSB7CiAgICAgIHZhciBzdG9yZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgIHZhciBwMnAgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgbXV0dWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB0cnVlOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGNyaXRlcmlhID0ge307CgogICAgICBjcml0ZXJpYS5wMnAgPSBwMnA7CiAgICAgIGNyaXRlcmlhLnN0b3JlID0gc3RvcmU7CiAgICAgIGNyaXRlcmlhLnNjaGVtYSA9IHNjaGVtYTsKICAgICAgY3JpdGVyaWEucmVzb3VyY2UgPSBvYmpVUkw7CgogICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgIGNyaXRlcmlhLm11dHVhbCA9IG11dHVhbDsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIHN1YnNjcmliZV0gLSBzdWJzY3JpYmUgY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCiAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShjcml0ZXJpYSwgeyByZXN1bWU6IGZhbHNlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9zdWJzY3JpYmUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtjcml0ZXJpYX0gY3JpdGVyaWEgLSBJbmZvcm1hdGlvbiB0byBkaXNjb3ZlcnkgdGhlIG9ic2VydmVyIG9iamVjdAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXN1bWVPYnNlcnZlcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZU9ic2VydmVycyhjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgX2NyaXRlcmlhID0gY3JpdGVyaWEgfHwge307CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoX2NyaXRlcmlhLCB7IHJlc3VtZTogdHJ1ZSB9KTsKCiAgICAgIHJldHVybiBfdGhpcy5fc3Vic2NyaWJlKF9jcml0ZXJpYSk7CiAgICB9CgogICAgLyoqCiAgICAqIFJlcXVlc3QgYSByZWFkIGFjdGlvbiBvbiB0aGUgcmVwb3J0ZXIgb2JqZWN0CiAgICAqIEBwYXJhbSB7T2JqZWN0VVJMfSBvYmpVUkwgLSBVUkwgb2YgdGhlIHJlcG9ydGVyIG9iamVjdCB0byBiZSByZWFkCiAgICAqIEByZXR1cm4ge1Byb21pc2U8T2JqZWN0Pn0gUmV0dXJuIFByb21pc2UgdG8gbGFzdCBhdmFpbGFibGUgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICovCgogIH0sIHsKICAgIGtleTogJ3JlYWQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWQob2JqVVJMKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIHJlcG9ydGVyIG9iamVjdCAobWF5YmUgdGhlcmUgaXMgbm8gbGlzdGVuZXIgYXZhaWxhYmxlLCBzbyBpdCB3aWxsIGJlIHJlc29sdmVkIHdpdGggTWVzc2FnZUJ1cyAtPiByZXNvbHZlKQogICAgICAvL3dpbGwgcmVhY2ggdGhlIHJlbW90ZSBvYmplY3QgaW4gRGF0YU9iamVjdFJlcG9ydGVyIC0+IF9vblJlYWQKICAgICAgdmFyIHJlYWRNc2cgPSB7CiAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBvYmpVUkwKICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVhZE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygncmVhZC1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIGV2ZW50cyBvZiByZW1vdmUgUmVwb3J0ZXIgb2JqZWN0cy4KICAgICogVGhpcyBpcyByZWxlYXRlZCB0byB0aGUgbWVzc2FnZW5zIHNlbnQgYnkgY3JlYXRlIHRvIHRoZSBvYnNlcnZlcnMgSHlwZXJ0eSBhcnJheS4KICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgKi8KCiAgfSwgewogICAga2V5OiAnb25Ob3RpZmljYXRpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uTm90aWZpY2F0aW9uKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ19jcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciByZXN1bWUgPSBjcml0ZXJpYS5yZXN1bWU7CiAgICAgICAgdmFyIGluaXRpYWxEYXRhID0gY3JpdGVyaWEuaW5pdGlhbERhdGEgfHwge307CiAgICAgICAgdmFyIHNjaGVtYSA9IHZvaWQgMDsKCiAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKICAgICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keTogeyByZXN1bWU6IHJlc3VtZSB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXTogJywgY3JpdGVyaWEsIHJlcXVlc3RNc2cpOwoKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUgPSBpbml0aWFsRGF0YTsKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUucmVwb3J0ZXIgPSBfdGhpcy5fb3duZXI7CgogICAgICAgIGlmIChjcml0ZXJpYS5zY2hlbWEpIHsKICAgICAgICAgIHNjaGVtYSA9IGNyaXRlcmlhLnNjaGVtYTsKICAgICAgICAgIHJlcXVlc3RNc2cuYm9keS5zY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CiAgICAgICAgfQoKICAgICAgICBpZiAoY3JpdGVyaWEucDJwKSByZXF1ZXN0TXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgIGlmIChjcml0ZXJpYS5zdG9yZSkgcmVxdWVzdE1zZy5ib2R5LnN0b3JlID0gY3JpdGVyaWEuc3RvcmU7CiAgICAgICAgaWYgKGNyaXRlcmlhLm9ic2VydmVycykgcmVxdWVzdE1zZy5ib2R5LmF1dGhvcmlzZSA9IGNyaXRlcmlhLm9ic2VydmVyczsKCiAgICAgICAgaWYgKHJlc3VtZSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9CgogICAgICAgIC8vcmVxdWVzdCBjcmVhdGUgdG8gdGhlIGFsbG9jYXRpb24gc3lzdGVtLiBDYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIFBvbGljeUVuZ2luZS4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gYWNjZXB0ZWQKICAgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgICBpZiAocmVzdW1lKSB7CiAgICAgICAgICAgICAgc2NoZW1hID0gcmVwbHkuYm9keS5zY2hlbWE7CiAgICAgICAgICAgICAgaW5pdGlhbERhdGEgPSByZXBseS5ib2R5LnZhbHVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgc2NoZW1hLCAnb24nLCBpbml0aWFsRGF0YSwgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CiAgICAgICAgICAgIF90aGlzLl9yZXBvcnRlcnNbb2JqVVJMXSA9IG5ld09iajsKCiAgICAgICAgICAgIHJlc29sdmUobmV3T2JqKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gcmVqZWN0ZWQKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zdWJzY3JpYmUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsU3Vic2NyaWJlCiAgICAgICAgdmFyIHN1YnNjcmliZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keToge30KICAgICAgICB9OwoKICAgICAgICAvLyBIeXBlcnR5IHJlcXVlc3QgdG8gYmUgYW4gT2JzZXJ2ZXIKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNoeXBlcnR5LXJlcXVlc3QtdG8tYmUtYW4tb2JzZXJ2ZXIKCiAgICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIHRoZSBzYW1lIEh5cGVydHkgVVJMCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLXRoZS1zYW1lLWh5cGVydHktdXJsCgogICAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciBhIGNlcnRhaW4gdXNlciBhbmQgZGF0YSBzY2hlbWEgaW5kZXBlbmRlbnRseSBvZiB0aGUgSHlwZXJ0eSBVUkwuCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLWEtY2VydGFpbi11c2VyLWFuZC1kYXRhLXNjaGVtYS1pbmRlcGVuZGVudGx5LW9mLXRoZS1oeXBlcnR5LXVybAogICAgICAgIGlmIChjcml0ZXJpYSkgewogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdwMnAnKSkgc3Vic2NyaWJlTXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzdG9yZScpKSBzdWJzY3JpYmVNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzY2hlbWEnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdpZGVudGl0eScpKSBzdWJzY3JpYmVNc2cuYm9keS5pZGVudGl0eSA9IGNyaXRlcmlhLmlkZW50aXR5OwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZScpKSBzdWJzY3JpYmVNc2cuYm9keS5yZXNvdXJjZSA9IGNyaXRlcmlhLnJlc291cmNlOwogICAgICAgIH0KCiAgICAgICAgc3Vic2NyaWJlTXNnLmJvZHkucmVzdW1lID0gY3JpdGVyaWEucmVzdW1lOwoKICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgdmFyIG11dHVhbEF1dGhlbnRpY2F0aW9uID0gY3JpdGVyaWEubXV0dWFsOwogICAgICAgIGlmICghbXV0dWFsQXV0aGVudGljYXRpb24pIHN1YnNjcmliZU1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUgbWVzc2FnZTogJywgY3JpdGVyaWEsIHN1YnNjcmliZU1zZyk7CgogICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KICAgICAgICAvL1Byb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICAgICAgICAvL2ZvciBtb3JlIGluZm8gc2VlIHRoZSBEYXRhUHJvdmlzaW9uYWwgY2xhc3MgZG9jdW1lbnRhdGlvbi4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gc3Vic2NyaWJlLXJlc3BvbnNlOiAnLCByZXBseSk7CgogICAgICAgICAgdmFyIHNjaGVtYSA9IHJlcGx5LmJvZHkuc2NoZW1hOwogICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgdmFyIG5ld1Byb3Zpc2lvbmFsID0gX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKICAgICAgICAgIGlmIChuZXdQcm92aXNpb25hbCkgbmV3UHJvdmlzaW9uYWwuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlIDwgMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YVByb3Zpc2lvbmFsOiAnLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzLCBvYmpVUkwpOwogICAgICAgICAgICBuZXdQcm92aXNpb25hbCA9IG5ldyBfRGF0YVByb3Zpc2lvbmFsMi5kZWZhdWx0KF90aGlzLl9vd25lciwgb2JqVVJMLCBfdGhpcy5fYnVzLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKICAgICAgICAgICAgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdID0gbmV3UHJvdmlzaW9uYWw7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YSBPYmplY3QgT2JzZXJ2ZXI6ICcsIHJlcGx5LCBfdGhpcy5fcHJvdmlzaW9uYWxzKTsKCiAgICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgICAgdmFyIG5ld09iaiA9IG5ldyBfRGF0YU9iamVjdE9ic2VydmVyMi5kZWZhdWx0KF90aGlzLCBvYmpVUkwsIHNjaGVtYSwgJ29uJywgcmVwbHkuYm9keS52YWx1ZSwgbmV3UHJvdmlzaW9uYWwuY2hpbGRyZW4sIHJlcGx5LmJvZHkudmVyc2lvbiwgbXV0dWFsQXV0aGVudGljYXRpb24pOwogICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF0gPSBuZXdPYmo7CgogICAgICAgICAgICByZXNvbHZlKG5ld09iaik7CiAgICAgICAgICAgIG5ld1Byb3Zpc2lvbmFsLmFwcGx5KG5ld09iaik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSBsb2NhbCBydW50aW1lIFJlcG9ydGVyT2JqZWN0IC0+IF9vblJlbW90ZVN1YnNjcmliZQoKICB9LCB7CiAgICBrZXk6ICdfb25Gb3J3YXJkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Gb3J3YXJkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHJlcG9ydGVyID0gX3RoaXMuX3JlcG9ydGVyc1ttc2cuYm9keS50b107CiAgICAgIHJlcG9ydGVyLl9vbkZvcndhcmQobXNnKTsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBTeW5jaGVyIC0+IGNyZWF0ZSAodGhpcyBpcyBhY3R1YWxseSBhbiBpbnZpdGF0aW9uIHRvIHN1YnNjcmliZSkKCiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVDcmVhdGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5mcm9tLnNsaWNlKDAsIC0xMyk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmJvZHkuc291cmNlLAogICAgICAgIHVybDogcmVzb3VyY2UsCiAgICAgICAgc2NoZW1hOiBtc2cuYm9keS5zY2hlbWEsCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgYWNrOiBmdW5jdGlvbiBhY2sodHlwZSkgewogICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgbFR5cGUgPSB0eXBlOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbU3luY2hlcl0gTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gZGVsZXRlCgogIH0sIHsKICAgIGtleTogJ19vblJlbW90ZURlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVtb3RlRGVsZXRlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9yZW1vdmUgIi9zdWJzY3JpcHRpb24iIGZyb20gdGhlIFVSTAogICAgICB2YXIgcmVzb3VyY2UgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIHZhciBvYmplY3QgPSBfdGhpcy5fb2JzZXJ2ZXJzW3Jlc291cmNlXTsKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIHZhciBldmVudCA9IHsKICAgICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgICAgdXJsOiByZXNvdXJjZSwKICAgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgICBhY2s6IGZ1bmN0aW9uIGFjayh0eXBlKSB7CiAgICAgICAgICAgIHZhciBsVHlwZSA9IDIwMDsKICAgICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgICBsVHlwZSA9IHR5cGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vVE9ETzogYW55IG90aGVyIGRpZmZlcmVudCBvcHRpb25zIGZvciB0aGUgcmVsZWFzZSBwcm9jZXNzLCBsaWtlIGFjY2VwdCBidXQgbm9yIHJlbGVhc2UgbG9jYWw/CiAgICAgICAgICAgIGlmIChsVHlwZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgb2JqZWN0LmRlbGV0ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL3NlbmQgYWNrIHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgICAgYm9keTogeyBjb2RlOiBsVHlwZSwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBpZiAoX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcikgewogICAgICAgICAgY29uc29sZS5sb2coJ05PVElGSUNBVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwNCwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnb3duZXInLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9vd25lcjsKICAgIH0KCiAgICAvKioKICAgICogQWxsIG93bmVkIHJlcG9ydGVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBjcmVhdGUKICAgICogQHR5cGUge09iamVjdDxVUkwsIERhdGFPYmplY3RSZXBvcnRlcj59CiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnRlcnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9yZXBvcnRlcnM7CiAgICB9CgogICAgLyoqCiAgICAqIEFsbCBvd25lZCBvYnNlcnZlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgbG9jYWwgc3Vic2NyaXB0aW9uCiAgICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0T2JzZXJ2ZXI+fQogICAgKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZXJzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fb2JzZXJ2ZXJzOwogICAgfQogIH1dKTsKICByZXR1cm4gU3luY2hlcjsKfSgpOyAvKioKICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICoKICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgKgogICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAqCiAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IFN5bmNoZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEzMSAqLywKLyogMTMyICovLAovKiAxMzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovKioKICogQGFjY2VzcyBwcml2YXRlCiAqIFRoaXMgY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIGNvbGxlY3RpbmcgZGVsdGEgY2hhbmdlcyBpbiByZW1vdGUgb2JqZWN0cywgYmVmb3JlIHRoZSByZXNwb25zZSBvZiBzdWJzY3JpcHRpb24gcmVhY2ggdGhlIG9ic2VydmVyLgogKiBJdCdzIHVzZWQgaW4gU3luY2hlciAtPiBzdWJzY3JpYmUuIFRoZSBmbG93IGlzIGRlZmluZWQgYXM6CiAqIDEuIChvYnNlcnZlcikgLS1zdWJzY3JpYmUtLT4gKHJlcG9ydGVyKQogKiAyLiAob2JzZXJ2ZXIpIDwtLWRlbHRhIHVwZGF0ZXMtLSAocmVwb3J0ZXIpCiAqIDMuIChvYnNlcnZlcikgPC0tc3Vic2NyaWJlIHJlc3BvbnNlLS0gKHJlcG9ydGVyKQogKiBUaGlzIG1lYW5zIHRoYXQgdGhlcmUgY291bGQgYmUgZGVsdGEgdXBkYXRlcyB0cmFuc2ZlcnJlZCBiZWZvcmUgdGhlIHN1YnNjcmlwdGlvbiBjb25maXJtYXRpb24uCiAqIFNpbmNlIHRoZXJlIGlzIG5vIERhdGFPYmplY3RPYnNlcnZlciBiZWZvcmUgdGhlIHVic2NyaXB0aW9uIGNvbmZpcm1hdGlvbiwgdGhlcmUgc2hvdWxkIGJlIHNvbWUgb3RoZXIgb2JqZWN0IGNvbGxlY3RpbmcgdGhlIHVwZGF0ZXMuCiAqIFByb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICovCnZhciBEYXRhUHJvdmlzaW9uYWwgPSBmdW5jdGlvbiAoKSB7CiAgLyogcHJpdmF0ZQogIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXQogIF9saXN0ZW5lcjogTXNnTGlzdGVuZXIKICAgX2NoYW5nZXM6IFtdCiAgKi8KCiAgZnVuY3Rpb24gRGF0YVByb3Zpc2lvbmFsKG93bmVyLCB1cmwsIGJ1cywgY2hpbGRyZW4pIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFQcm92aXNpb25hbCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl91cmwgPSB1cmw7CiAgICBfdGhpcy5fYnVzID0gYnVzOwogICAgX3RoaXMuX2NoaWxkcmVuID0gY2hpbGRyZW47CgogICAgX3RoaXMuX2NoYW5nZXMgPSBbXTsKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YVByb3Zpc2lvbmFsLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YVByb3Zpc2lvbmFsLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgX3RoaXMuX2NoYW5nZXMucHVzaChtc2cpOwogICAgICB9KTsKCiAgICAgIC8qCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwogICAgICBpZiAoX3RoaXMuX2NoaWxkcmVuKSB7CiAgICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IHVybCArICcvY2hpbGRyZW4vJzsKICAgICAgICBfdGhpcy5fY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHsKICAgICAgICAgIGxldCBjaGlsZFVSTCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOwogICAgICAgICAgbGV0IGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgKG1zZykgPT4gewogICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCiAgICAgICAgICAgIGlmIChtc2cuZnJvbSAhPT0gb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0qLwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKCiAgICAgIC8qX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7CiAgICAgICAgbGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgIH0pOyovCiAgICB9CiAgfSwgewogICAga2V5OiAnYXBwbHknLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5KG9ic2VydmVyKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIF90aGlzLl9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZSkgewogICAgICAgIG9ic2VydmVyLl9jaGFuZ2VPYmplY3Qob2JzZXJ2ZXIuX3N5bmNPYmosIGNoYW5nZSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ2NoaWxkcmVuJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW47CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhUHJvdmlzaW9uYWw7Cn0oKTsKCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFQcm92aXNpb25hbDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTM0ICovLAovKiAxMzUgKi8sCi8qIDEzNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzcgKi8sCi8qIDEzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0NSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzkgKi8sCi8qIDE0MCAqLywKLyogMTQxICovLAovKiAxNDIgKi8sCi8qIDE0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDE0OSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3QuYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NCAqLywKLyogMTQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTUxKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7CiAgcmV0dXJuICRPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpOwp9OwoKLyoqKi8gfSksCi8qIDE0NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyAxOS4xLjIuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlLCAuLi4pCnZhciBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpCiAgLCBnT1BTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCiAgLCB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJT2JqZWN0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpCiAgLCAkYXNzaWduICA9IE9iamVjdC5hc3NpZ247CgovLyBzaG91bGQgd29yayB3aXRoIHN5bWJvbHMgYW5kIHNob3VsZCBoYXZlIGRldGVybWluaXN0aWMgcHJvcGVydHkgb3JkZXIgKFY4IGJ1ZykKbW9kdWxlLmV4cG9ydHMgPSAhJGFzc2lnbiB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHZhciBBID0ge30KICAgICwgQiA9IHt9CiAgICAsIFMgPSBTeW1ib2woKQogICAgLCBLID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0JzsKICBBW1NdID0gNzsKICBLLnNwbGl0KCcnKS5mb3JFYWNoKGZ1bmN0aW9uKGspeyBCW2tdID0gazsgfSk7CiAgcmV0dXJuICRhc3NpZ24oe30sIEEpW1NdICE9IDcgfHwgT2JqZWN0LmtleXMoJGFzc2lnbih7fSwgQikpLmpvaW4oJycpICE9IEs7Cn0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycwogIHZhciBUICAgICA9IHRvT2JqZWN0KHRhcmdldCkKICAgICwgYUxlbiAgPSBhcmd1bWVudHMubGVuZ3RoCiAgICAsIGluZGV4ID0gMQogICAgLCBnZXRTeW1ib2xzID0gZ09QUy5mCiAgICAsIGlzRW51bSAgICAgPSBwSUUuZjsKICB3aGlsZShhTGVuID4gaW5kZXgpewogICAgdmFyIFMgICAgICA9IElPYmplY3QoYXJndW1lbnRzW2luZGV4KytdKQogICAgICAsIGtleXMgICA9IGdldFN5bWJvbHMgPyBnZXRLZXlzKFMpLmNvbmNhdChnZXRTeW1ib2xzKFMpKSA6IGdldEtleXMoUykKICAgICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAogICAgICAsIGogICAgICA9IDAKICAgICAgLCBrZXk7CiAgICB3aGlsZShsZW5ndGggPiBqKWlmKGlzRW51bS5jYWxsKFMsIGtleSA9IGtleXNbaisrXSkpVFtrZXldID0gU1trZXldOwogIH0gcmV0dXJuIFQ7Cn0gOiAkYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NyAqLywKLyogMTQ4ICovLAovKiAxNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSkKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYsICdPYmplY3QnLCB7YXNzaWduOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Nil9KTsKCi8qKiovIH0pLAovKiAxNTAgKi8sCi8qIDE1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApCnZhciB0b0lPYmplY3QgICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KS5mOwoKX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2dldE93blByb3BlcnR5RGVzY3JpcHRvcicsIGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICAgIHJldHVybiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRvSU9iamVjdChpdCksIGtleSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTUyICovLAovKiAxNTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gICAgIHByb3h5LW9ic2VydmUgdjAuMC4xOAovLyAgICAgQ29weXJpZ2h0IChjKSAyMDE1LCAyMDE2IFNpbW9uIFkuIEJsYWNrd2VsbCwgQW55V2hpY2hXYXkKLy8gICAgIE1JVCBMaWNlbnNlIC0gaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocAooZnVuY3Rpb24oKSB7CgkidXNlIHN0cmljdCI7CgkvLyBDcmVhdGVzIGFuZCByZXR1cm5zIGEgUHJveHkgd3JhcHBpbmcgYSB0YXJnZXQgc28gdGhhdCBhbGwgY2hhbmdlcyBjYW4gYmUgdHJhcHBlZCBhbmQgZm9yd2FyZGVkIHRvCgkvLyBhIGNhbGxiYWNrLiBUaGUgY2FsbGJhY2sgdGFrZXMgYW4gYXJyYXkgb2YgY2hhbmdlcyBqdXN0IGxpa2UgdGhlIHRyYWRpdGlvbmFsIG9yaWdpbmFsIENocm9tZSBPYmplY3Qub2JzZXJ2ZQoJLy8ge29iamVjdDo8b2JqZWN0IGNoYW5nZWQ+LG5hbWU6PGZpZWxkIGNoYW5nZWQ+LHR5cGU6YWRkfHVwZGF0ZXxkZWxldGV8cmVjb25maWd1cmV8cHJldmVudEV4dGVuc2lvbnN8c2V0UHJvdG90eXBlLG9sZFZhbHVlOjxvbGQgdmFsdWUgaWYgdXBkYXRlIHwgZGVsZXRlPn0KCS8vIFRoZSBhY2NlcHRsaXN0IGNhbiBiZSBhZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUuCgkvLyB2IDAuMC4xMCB0byBzdXBwb3J0IHBhdXNpbmcgYW5kIHJlc3RhcnRpbmcgb2JzZXJ2YXRpb24gdHdvIGFkZGl0aW9uYWwgY29uc3RydWN0b3IgYXJndW1lbnRzIGFyZSBhdmFpbGFibGUgdG8gT2JqZWN0Lm9ic2VydmU6CgkvLyBwYXVzYWJsZSAtIGNyZWF0ZSB0aGUgT2JzZXJ2ZXIgc28gaXQgY2FuIGJlIHBhdXNlZAoJLy8gcGF1c2UgLSBjcmVhdGUgb2JzZXJ2ZXIgaW4gcGF1c2VkIHN0YXRlCgkvLyBpZiBwYXVzYWJsZSBpcyB0cnVlIHRoZW4gYW4gYWRkaXRpb25hbCBtZXRob2QgZGVsaXZlcihpZ25vcmVQcmV2aW91cykgaXMgYXZhaWxhYmxlIHRvIHN0YXJ0IGRlbGl2ZXJ5CgkvLyB0byBwYXVzZSBkZWxpdmVyeSBzZXQgYSBwcm9wZXJ0eSBjYWxsZWQgcGF1c2Ugb24gdGhlIGZ1bmN0aW9uIGRlbGl2ZXIgdG8gdHJ1ZQoJLy8gcGF1c2FibGUgaXMgb3B0aW9uYWwgdG8gcmVkdWNlIHRoZSBjaGFuY2Ugb2Ygc2hhZG93aW5nIGEgcHJvcGVydHkgb3IgbWV0aG9kIG9uIGFueSBleGlzdGluZyBjb2RlIGNhbGxlZCBkZWxpdmVyCglpZighT2JqZWN0Lm9ic2VydmUgJiYgdHlwZW9mKFByb3h5KT09PSJmdW5jdGlvbiIpIHsKCQlmdW5jdGlvbiBPYnNlcnZlcih0YXJnZXQsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgewoJICAgIAl2YXIgbWUgPSB0aGlzLCBwcm94eTsKCSAgICAJZnVuY3Rpb24gZGVsaXZlcihpZ25vcmVQcmV2aW91cyxkZWxheSkgewoJICAgIAkJZGVsaXZlci5kZWxheSA9IGRlbGF5OwoJICAgIAkJaWYoIWRlbGl2ZXIucGF1c2UpIHsKCSAgICAgICAgCQlpZihtZS5jaGFuZ2VzZXQubGVuZ3RoPjApIHsKCSAgICAgICAgCQkJaWYoIWlnbm9yZVByZXZpb3VzKSB7CgkJICAgIAkgICAgCQl2YXIgY2hhbmdlcyA9IG1lLmNoYW5nZXNldC5maWx0ZXIoZnVuY3Rpb24oY2hhbmdlKSB7IHJldHVybiAhYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wOyB9KTsKCQkgICAgICAgIAkJCWlmKGNoYW5nZXMubGVuZ3RoPjApIHsKCQkgICAgICAgIAkJCQljYWxsYmFjayhjaGFuZ2VzKTsKCQkgICAgICAgIAkJCX0KCSAgICAgICAgCQkJfQoJICAgICAgICAJCQltZS5jaGFuZ2VzZXQgPSBbXTsKCSAgICAgICAgCQl9CgkgICAgCQl9CgkgICAgCX0KCSAgICAJZGVsaXZlci5wYXVzZSA9IHBhdXNlOwoJICAgIAlkZWxpdmVyLmRlbGF5ID0gZGVsYXk7CgkJICAgIG1lLmdldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCQkgICAgCWlmKHByb3BlcnR5PT09Il9fb2JzZXJ2ZXJfXyIpIHsKCQkgICAgCQlyZXR1cm4gbWU7CgkJICAgIAl9CgkJICAgIAlpZihwcm9wZXJ0eT09PSJ1bm9ic2VydmUiKSB7CgkJICAgIAkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCSAgICAJCQlPYmplY3QudW5vYnNlcnZlKHRhcmdldCk7CgkJICAgIAkJCXJldHVybiB0YXJnZXQ7CgkJICAgIAkJfTsKCQkgICAgCX0KCQkgICAgCWlmKHByb3BlcnR5PT09ImRlbGl2ZXIiKSB7CgkJICAgIAkJcmV0dXJuIGRlbGl2ZXI7CgkJICAgIAl9CgkJICAgIAlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCQkgICAgfQoJICAgIAltZS50YXJnZXQgPSB0YXJnZXQ7CgkgICAgCW1lLmNoYW5nZXNldCA9IFtdOwoJICAgIAlpZighbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXykgewoJICAgIAkJLy8gX19vYnNlcnZlckNhbGxiYWNrc19fIGlzIHVzZWQgYXMgYW4gaW5kZXggdG8gZ2V0IGF0IHRoZSBwcm94eSB3aGljaCBpcyB0aGUgb2JzZXJ2ZXIsIHNvIHdlIGNhbiB1bm9ic2VydmUKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJDYWxsYmFja3NfXyIse2VudW1lcmFibGU6ZmFsc2UsY29uZmlndXJhYmxlOnRydWUsd3JpdGFibGU6ZmFsc2UsdmFsdWU6W119KTsKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJzX18iLHtlbnVtZXJhYmxlOmZhbHNlLGNvbmZpZ3VyYWJsZTp0cnVlLHdyaXRhYmxlOmZhbHNlLHZhbHVlOltdfSk7CgkgICAgCX0KCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5wdXNoKGNhbGxiYWNrKTsKCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJzX18ucHVzaCh0aGlzKTsKCSAgICAJcHJveHkgPSBuZXcgUHJveHkodGFyZ2V0LG1lKTsKCSAgICAJZGVsaXZlcihmYWxzZSxkZWxheSk7CgkgICAgCXJldHVybiBwcm94eTsKCSAgICB9CgkJT2JzZXJ2ZXIucHJvdG90eXBlLmRlbGl2ZXIgPSBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMuZ2V0KG51bGwsImRlbGl2ZXIiKTsKCQl9CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIHZhbHVlKSB7IC8vICwgcmVjZWl2ZXIKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJdmFyIHR5cGUgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKTsKCSAgICAJdGFyZ2V0W3Byb3BlcnR5XSA9IHZhbHVlOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICghdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKHR5cGUpPj0wKSkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZTp0eXBlfSwKCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAgICAgCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAlpZih0eXBlPT09InVwZGF0ZSIpIHsKCSAgICAgICAgCQljaGFuZ2Uub2xkVmFsdWUgPSBvbGR2YWx1ZTsKCSAgICAgICAgCX0KCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWxldGVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJLy9pZih0eXBlb2Yob2xkdmFsdWUpIT09InVuZGVmaW5lZCIpIHsKCQkgICAgCWRlbGV0ZSB0YXJnZXRbcHJvcGVydHldOwoJCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJkZWxldGUiKT49MCkgewoJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6ImRlbGV0ZSIsb2xkVmFsdWU6b2xkdmFsdWV9LAoJCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCQkgICAgICAgIAkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCQkgICAgICAgIAlpZihzdGFydCkgewoJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJCSAgICAgICAgCX0KCQkgICAgCX0KCSAgICAJLy99CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcikgewoJICAgIAlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcik7CgkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigicmVjb25maWd1cmUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZToicmVjb25maWd1cmUifSwKICAgICAgICAJCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKICAgICAgICAJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7CgkgICAgICAgIAlpZihzdGFydCkgewoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7CgkgICAgICAgIAl9CgkgICAgCX0KCSAgICAJcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBPYnNlcnZlci5wcm90b3R5cGUuc2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbih0YXJnZXQsIHByb3RvdHlwZSkgewoJICAgIAl2YXIgb2xkdmFsdWUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KTsKCSAgICAJT2JqZWN0LnNldFByb3RvdHlwZU9mKHRhcmdldCwgcHJvdG90eXBlKTsKCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJzZXRQcm90b3R5cGUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6Il9fcHJvdG9fXyIsdHlwZToic2V0UHJvdG90eXBlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sCiAgICAJCQkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsCiAgICAJCQkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgICAgICAJaWYoc3RhcnQpIHsKCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgICAgICAJfQoJICAgIAl9CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnByZXZlbnRFeHRlbnNpb25zID0gZnVuY3Rpb24odGFyZ2V0KSB7CgkgICAgICAgIE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh0YXJnZXQpOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInByZXZlbnRFeHRlbnNpb25zIik+PTApIHsKCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCx0eXBlOiJwcmV2ZW50RXh0ZW5zaW9ucyJ9LAoJCQkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLAoJCQkJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsKCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9iamVjdC5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJcmV0dXJuIG5ldyBPYnNlcnZlcihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSk7CgkgICAgfTsKCSAgICBPYmplY3QudW5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrKSB7CgkgICAgCWlmKG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsKCSAgICAJCWlmKCFjYWxsYmFjaykgewoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uc3BsaWNlKDAsb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5sZW5ndGgpOwoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZSgwLG9iamVjdC5fX29ic2VydmVyc19fLmxlbmd0aCk7CgkgICAgCQkJcmV0dXJuOwoJICAgIAkJfQoJICAgIAkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5mb3JFYWNoKGZ1bmN0aW9uKG9ic2VydmVyY2FsbGJhY2ssaSkgewoJICAgIAkJCWlmKGNhbGxiYWNrPT09b2JzZXJ2ZXJjYWxsYmFjaykgewoJICAgIAkJCQlvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLnNwbGljZShpLDEpOwoJICAgIAkJCQlkZWxldGUgb2JqZWN0Ll9fb2JzZXJ2ZXJzX19baV0uY2FsbGJhY2s7CgkgICAgCQkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZShpLDEpOwoJICAgIAkJCX0KCSAgICAJCX0pOwoJICAgIAl9CgkgICAgfTsKCSAgICBBcnJheS5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJaWYoIShvYmplY3QgaW5zdGFuY2VvZiBBcnJheSkgJiYgIUFycmF5LmlzQXJyYXkob2JqZWN0KSkgewoJICAgIAkJdGhyb3cgbmV3IFR5cGVFcnJvcigiRmlyc3QgYXJndW1lbnQgdG8gQXJyYXkub2JzZXJ2ZXIgaXMgbm90IGFuIEFycmF5Iik7CgkgICAgCX0KICAgICAgICAgICAgCWFjY2VwdGxpc3QgPSBhY2NlcHRsaXN0IHx8IFsiYWRkIiwgInVwZGF0ZSIsICJkZWxldGUiLCAic3BsaWNlIl07CgkgICAgCXZhciBhcnJheXByb3h5ID0gbmV3IFByb3h5KG9iamVjdCx7Z2V0OiBmdW5jdGlvbih0YXJnZXQscHJvcGVydHkpIHsKCSAgICAJCWlmKHByb3BlcnR5PT09InVub2JzZXJ2ZSIpIHsKCQkgICAgCQlyZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2spIHsKCQkgICAgCQkJaWYoY2FsbGJhY2spIHsKCQkgICAgCQkJCXJldHVybiBPYmplY3QudW5vYnNlcnZlKHRhcmdldCxjYWxsYmFjayk7CgkJICAgIAkJCX0KCQkgICAgCQkJcmV0dXJuIHRhcmdldC51bm9ic2VydmUoKTsKCQkgICAgCQl9OwoJCSAgICAJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic3BsaWNlIikgewoJICAgIAkJCXJldHVybiBmdW5jdGlvbihzdGFydCxlbmQpIHsKCSAgICAJCQkJaWYodHlwZW9mKHN0YXJ0KSE9PSJudW1iZXIiIHx8IHR5cGVvZihlbmQpIT09Im51bWJlciIpIHsKCSAgICAJCQkJCXRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IHR3byBhcmd1bWVudHMgdG8gQXJyYXkgc3BsaWNlIGFyZSBub3QgbnVtYmVyLCBudW1iZXIiKTsKCSAgICAJCQkJfQoJICAgIAkgICAgCQl2YXIgcmVtb3ZlZCA9IHRoaXMuc2xpY2Uoc3RhcnQsc3RhcnQrZW5kKSwKCSAgICAJICAgIAkJCWFkZGVkQ291bnQgPSAoYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHMubGVuZ3RoLTIgOiAwKSwKCSAgICAJICAgIAkJCWNoYW5nZSA9ICB7b2JqZWN0Om9iamVjdCx0eXBlOiJzcGxpY2UiLGluZGV4OnN0YXJ0LHJlbW92ZWQ6cmVtb3ZlZCxhZGRlZENvdW50OmFkZGVkQ291bnR9OwoJICAgIAkgICAgCQl0YXJnZXQuc3BsaWNlLmFwcGx5KHRhcmdldCxhcmd1bWVudHMpOwoJICAgIAkgICAgCQlpZihhY2NlcHRsaXN0LmluZGV4T2YoInNwbGljZSIpPj0wKSB7CgkgICAgCSAgICAJCQl2YXIgc3RhcnQgPSBwcm94eS5fX29ic2VydmVyX18uY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAJICAgICAgICAJCQlkZWxpdmVyID0gcHJveHkuX19vYnNlcnZlcl9fLmRlbGl2ZXIoKTsKCSAgICAJICAgIAkJCXByb3h5Ll9fb2JzZXJ2ZXJfXy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgIAkgICAgCQkJaWYoc3RhcnQpIHsKCSAgICAJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgIAkJICAgICAgICAJfQoJICAgIAkgICAgCQl9CgkgICAgCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icHVzaCIpIHsKCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHsKCSAgICAJCSAgICAJcmV0dXJuIHRoaXMuc3BsaWNlKHRoaXMubGVuZ3RoLDAsaXRlbSk7CgkgICAgCQkgICAgfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icG9wIikgewoJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oKSB7CgkgICAgCQkgICAgCXJldHVybiB0aGlzLnNwbGljZSh0aGlzLmxlbmd0aC0xLDEpOwoJICAgIAkJICAgIH0KCSAgICAJCX0KCSAgICAJCWlmKHByb3BlcnR5PT09InVuc2hpZnQiKSB7CgkgICAgCQkJIHJldHVybiBmdW5jdGlvbihpdGVtKSB7CiAgICAJCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDAsaXRlbSk7CiAgICAJCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic2hpZnQiKSB7CgkgICAgCQkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJICAgIAkgICAgCQlyZXR1cm4gdGhpcy5zcGxpY2UoMCwxKTsKCSAgICAJICAgIAl9CgkgICAgCQl9CgkgICAgCQlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJfX0pOwoJICAgIAl2YXIgcHJveHkgPSBPYmplY3Qub2JzZXJ2ZShhcnJheXByb3h5LGZ1bmN0aW9uKGNoYW5nZXNldCkgeyAKCSAgICAJCXZhciBjaGFuZ2VzID0gY2hhbmdlc2V0LmZpbHRlcihmdW5jdGlvbihjaGFuZ2UpIHsgcmV0dXJuIGNoYW5nZS5uYW1lIT09Imxlbmd0aCIgJiYgY2hhbmdlLm5hbWUhPT0iYWRkIiAmJiAoIWFjY2VwdGxpc3QgfHwgYWNjZXB0bGlzdC5pbmRleE9mKGNoYW5nZS50eXBlKT49MCk7IH0pOwoJICAgIAkJaWYoY2hhbmdlcy5sZW5ndGg+MCkgewoJICAgIAkJCWNhbGxiYWNrKGNoYW5nZXMpOwoJICAgIAkJfQoJICAgIAl9LGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpOwoJICAgIAlyZXR1cm4gcHJveHk7CgkgICAgfTsKCSAgICBBcnJheS51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsKCQkgIHJldHVybiBvYmplY3QudW5vYnNlcnZlKGNhbGxiYWNrKTsKCSAgICB9Cgl9CglPYmplY3QuZGVlcE9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2sscGFydHMpIHsKCgkJcGFydHMgPSAocGFydHMgPyBwYXJ0cyA6IFtdKTsKCgkJdmFyIHRvVHlwZU5hbWUgPSBmdW5jdGlvbihvYmopIHsKCQkJcmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvYmopLm1hdGNoKC9ccyhbYS16QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKQoJCX0KCgkJZnVuY3Rpb24gcmVvYnNlcnZlKHZhbHVlLCBwYXJ0cykgewoJCQl2YXIga2V5cyA9IE9iamVjdC5rZXlzKHZhbHVlKTsKCQkJa2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJaWYoKHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdvYmplY3QnIHx8IHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdhcnJheScpICYmICF2YWx1ZVtrZXldLmhhc093blByb3BlcnR5KCdfX29ic2VydmVyc19fJykpIHsKCQkJCQl2YXIgbmV3cGFydHMgPSBwYXJ0cy5zbGljZSgwKTsKCQkJCQluZXdwYXJ0cy5wdXNoKGtleSk7CgkJCQkJdmFsdWVba2V5XSA9IE9iamVjdC5kZWVwT2JzZXJ2ZSh2YWx1ZVtrZXldLGNhbGxiYWNrLG5ld3BhcnRzKTsKCQkJCX0KCQkJfSk7CgkJfQoKCQlyZW9ic2VydmUob2JqZWN0LCBwYXJ0cyk7CgoJCXZhciBvYnNlcnZlZCA9IE9iamVjdC5vYnNlcnZlKG9iamVjdCxmdW5jdGlvbihjaGFuZ2VzZXQpIHsKCQkJdmFyIGNoYW5nZXMgPSBbXTsKCQkJZnVuY3Rpb24gcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0LG5ld09iamVjdCxwYXRoKSB7CgkJCQlpZihuZXdPYmplY3QgaW5zdGFuY2VvZiBPYmplY3QpIHsKCQkJCQl2YXIgbmV3a2V5cyA9IE9iamVjdC5rZXlzKG5ld09iamVjdCk7CgkJCQkJbmV3a2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJCQlpZighb2xkT2JqZWN0IHx8IChvbGRPYmplY3Rba2V5XSE9PW5ld09iamVjdFtrZXldKSkgewoJCQkJCQkJdmFyIG9sZHZhbHVlID0gKG9sZE9iamVjdCAmJiBvbGRPYmplY3Rba2V5XSE9PXVuZGVmaW5lZCA/IG9sZE9iamVjdFtrZXldIDogdW5kZWZpbmVkKSwKCQkJCQkJCQljaGFuZ2UgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKSwKCQkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCgkJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGR2YWx1ZSxuZXdWYWx1ZTpuZXdPYmplY3Rba2V5XSxrZXlwYXRoOmtleXBhdGh9KTsKCQkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZHZhbHVlLG5ld09iamVjdFtrZXldLGtleXBhdGgpOwoJCQkJCQl9CgkJCQkJfSk7CgkJCQl9IGVsc2UgaWYob2xkT2JqZWN0IGluc3RhbmNlb2YgT2JqZWN0KSB7CgkJCQkJdmFyIG9sZGtleXMgPSBPYmplY3Qua2V5cyhvbGRPYmplY3QpOwoJCQkJCW9sZGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsKCQkJCQkJdmFyIGNoYW5nZSA9IChuZXdPYmplY3Q9PT1udWxsID8gInVwZGF0ZSIgOiAiZGVsZXRlIiksCgkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCQkJCQkJCQoJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGRPYmplY3Rba2V5XSxuZXdWYWx1ZTpuZXdPYmplY3Qsa2V5cGF0aDprZXlwYXRofSk7CgkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZE9iamVjdFtrZXldLHVuZGVmaW5lZCxrZXlwYXRoKTsKCQkJCQl9KTsKCQkJCX0KCQkJfQoJCQljaGFuZ2VzZXQuZm9yRWFjaChmdW5jdGlvbihjaGFuZ2UpIHsKCQkJCXZhciBrZXlwYXRoID0gKHBhcnRzLmxlbmd0aD4wID8gcGFydHMuam9pbigiLiIpICsgIi4iIDogIiIpICsgY2hhbmdlLm5hbWU7CgoJCQkJaWYgKGNoYW5nZS50eXBlID09PSAidXBkYXRlIiB8fCBjaGFuZ2UudHlwZSA9PT0gImFkZCIpIHsgCgkJCQkJcmVvYnNlcnZlKGNoYW5nZS5vYmplY3QsIHBhcnRzKTsKCQkJCX0KCgkJCQljaGFuZ2VzLnB1c2goe25hbWU6Y2hhbmdlLm5hbWUsb2JqZWN0OmNoYW5nZS5vYmplY3QsdHlwZTpjaGFuZ2UudHlwZSxvbGRWYWx1ZTpjaGFuZ2Uub2xkVmFsdWUsbmV3VmFsdWU6Y2hhbmdlLm9iamVjdFtjaGFuZ2UubmFtZV0sa2V5cGF0aDprZXlwYXRofSk7CgkJCQlyZWN1cnNlKGNoYW5nZS5uYW1lLGNoYW5nZS5vYmplY3QsY2hhbmdlLm9sZFZhbHVlLGNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGgpOwoJCQl9KTsKCQkJY2FsbGJhY2soY2hhbmdlcyk7CgkJfSk7CgkJcmV0dXJuIG9ic2VydmVkOwoJfTsKfSkoKTsKCgovKioqLyB9KSwKLyogMTU0ICovLAovKiAxNTUgKi8sCi8qIDE1NiAqLywKLyogMTU3ICovLAovKiAxNTggKi8sCi8qIDE1OSAqLywKLyogMTYwICovLAovKiAxNjEgKi8sCi8qIDE2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkRhdGFPYmplY3RPYnNlcnZlciA9IGV4cG9ydHMuRGF0YU9iamVjdFJlcG9ydGVyID0gZXhwb3J0cy5TeW5jaGVyID0gdW5kZWZpbmVkOwoKdmFyIF9TeW5jaGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzApOwoKdmFyIF9TeW5jaGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1N5bmNoZXIpOwoKdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOSk7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuU3luY2hlciA9IF9TeW5jaGVyMi5kZWZhdWx0OwpleHBvcnRzLkRhdGFPYmplY3RSZXBvcnRlciA9IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQ7CmV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdDsKCi8qKiovIH0pCi8qKioqKiovIF0pOwp9KTsKCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwoKJ3VzZSBzdHJpY3QnOwoKLy8gU2hpbW1pbmcgc3RhcnRzIGhlcmUuCihmdW5jdGlvbigpIHsKICAvLyBVdGlscy4KICB2YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7CiAgdmFyIGxvZ2dpbmcgPSB1dGlscy5sb2c7CiAgdmFyIGJyb3dzZXJEZXRhaWxzID0gdXRpbHMuYnJvd3NlckRldGFpbHM7CiAgLy8gRXhwb3J0IHRvIHRoZSBhZGFwdGVyIGdsb2JhbCBvYmplY3QgdmlzaWJsZSBpbiB0aGUgYnJvd3Nlci4KICBtb2R1bGUuZXhwb3J0cy5icm93c2VyRGV0YWlscyA9IGJyb3dzZXJEZXRhaWxzOwogIG1vZHVsZS5leHBvcnRzLmV4dHJhY3RWZXJzaW9uID0gdXRpbHMuZXh0cmFjdFZlcnNpb247CiAgbW9kdWxlLmV4cG9ydHMuZGlzYWJsZUxvZyA9IHV0aWxzLmRpc2FibGVMb2c7CgogIC8vIFVuY29tbWVudCB0aGUgbGluZSBiZWxvdyBpZiB5b3Ugd2FudCBsb2dnaW5nIHRvIG9jY3VyLCBpbmNsdWRpbmcgbG9nZ2luZwogIC8vIGZvciB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdy4gQ2FuIGFsc28gYmUgdHVybmVkIG9uIGluIHRoZSBicm93c2VyIHZpYQogIC8vIGFkYXB0ZXIuZGlzYWJsZUxvZyhmYWxzZSksIGJ1dCB0aGVuIGxvZ2dpbmcgZnJvbSB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdwogIC8vIHdpbGwgbm90IGFwcGVhci4KICAvLyByZXF1aXJlKCcuL3V0aWxzJykuZGlzYWJsZUxvZyhmYWxzZSk7CgogIC8vIEJyb3dzZXIgc2hpbXMuCiAgdmFyIGNocm9tZVNoaW0gPSByZXF1aXJlKCcuL2Nocm9tZS9jaHJvbWVfc2hpbScpIHx8IG51bGw7CiAgdmFyIGVkZ2VTaGltID0gcmVxdWlyZSgnLi9lZGdlL2VkZ2Vfc2hpbScpIHx8IG51bGw7CiAgdmFyIGZpcmVmb3hTaGltID0gcmVxdWlyZSgnLi9maXJlZm94L2ZpcmVmb3hfc2hpbScpIHx8IG51bGw7CiAgdmFyIHNhZmFyaVNoaW0gPSByZXF1aXJlKCcuL3NhZmFyaS9zYWZhcmlfc2hpbScpIHx8IG51bGw7CgogIC8vIFNoaW0gYnJvd3NlciBpZiBmb3VuZC4KICBzd2l0Y2ggKGJyb3dzZXJEZXRhaWxzLmJyb3dzZXIpIHsKICAgIGNhc2UgJ2Nocm9tZSc6CiAgICAgIGlmICghY2hyb21lU2hpbSB8fCAhY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdDaHJvbWUgc2hpbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhpcyBhZGFwdGVyIHJlbGVhc2UuJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGxvZ2dpbmcoJ2FkYXB0ZXIuanMgc2hpbW1pbmcgY2hyb21lLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGNocm9tZVNoaW07CgogICAgICBjaHJvbWVTaGltLnNoaW1HZXRVc2VyTWVkaWEoKTsKICAgICAgY2hyb21lU2hpbS5zaGltTWVkaWFTdHJlYW0oKTsKICAgICAgdXRpbHMuc2hpbUNyZWF0ZU9iamVjdFVSTCgpOwogICAgICBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QoKTsKICAgICAgY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgY2hyb21lU2hpbS5zaGltT25UcmFjaygpOwogICAgICBicmVhazsKICAgIGNhc2UgJ2ZpcmVmb3gnOgogICAgICBpZiAoIWZpcmVmb3hTaGltIHx8ICFmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdGaXJlZm94IHNoaW0gaXMgbm90IGluY2x1ZGVkIGluIHRoaXMgYWRhcHRlciByZWxlYXNlLicpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBsb2dnaW5nKCdhZGFwdGVyLmpzIHNoaW1taW5nIGZpcmVmb3guJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gZmlyZWZveFNoaW07CgogICAgICBmaXJlZm94U2hpbS5zaGltR2V0VXNlck1lZGlhKCk7CiAgICAgIHV0aWxzLnNoaW1DcmVhdGVPYmplY3RVUkwoKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbVNvdXJjZU9iamVjdCgpOwogICAgICBmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbU9uVHJhY2soKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdlZGdlJzoKICAgICAgaWYgKCFlZGdlU2hpbSB8fCAhZWRnZVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uKSB7CiAgICAgICAgbG9nZ2luZygnTVMgZWRnZSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBlZGdlLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGVkZ2VTaGltOwoKICAgICAgZWRnZVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMKCk7CiAgICAgIGVkZ2VTaGltLnNoaW1QZWVyQ29ubmVjdGlvbigpOwogICAgICBicmVhazsKICAgIGNhc2UgJ3NhZmFyaSc6CiAgICAgIGlmICghc2FmYXJpU2hpbSkgewogICAgICAgIGxvZ2dpbmcoJ1NhZmFyaSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBzYWZhcmkuJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gc2FmYXJpU2hpbTsKCiAgICAgIHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgIGxvZ2dpbmcoJ1Vuc3VwcG9ydGVkIGJyb3dzZXIhJyk7CiAgfQp9KSgpOwoKfSx7Ii4vY2hyb21lL2Nocm9tZV9zaGltIjo0LCIuL2VkZ2UvZWRnZV9zaGltIjo2LCIuL2ZpcmVmb3gvZmlyZWZveF9zaGltIjo4LCIuL3NhZmFyaS9zYWZhcmlfc2hpbSI6MTAsIi4vdXRpbHMiOjExfV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CgovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzLmpzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgY2hyb21lU2hpbSA9IHsKICBzaGltTWVkaWFTdHJlYW06IGZ1bmN0aW9uKCkgewogICAgd2luZG93Lk1lZGlhU3RyZWFtID0gd2luZG93Lk1lZGlhU3RyZWFtIHx8IHdpbmRvdy53ZWJraXRNZWRpYVN0cmVhbTsKICB9LAoKICBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmICEoJ29udHJhY2snIGluCiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUsICdvbnRyYWNrJywgewogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5fb250cmFjazsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24oZikgewogICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgaWYgKHRoaXMuX29udHJhY2spIHsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFjaycsIHRoaXMuX29udHJhY2spOwogICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5KTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrID0gZik7CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5ID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAvLyBvbmFkZHN0cmVhbSBkb2VzIG5vdCBmaXJlIHdoZW4gYSB0cmFjayBpcyBhZGRlZCB0byBhbiBleGlzdGluZwogICAgICAgICAgICAvLyBzdHJlYW0uIEJ1dCBzdHJlYW0ub25hZGR0cmFjayBpcyBpbXBsZW1lbnRlZCBzbyB3ZSB1c2UgdGhhdC4KICAgICAgICAgICAgZS5zdHJlYW0uYWRkRXZlbnRMaXN0ZW5lcignYWRkdHJhY2snLCBmdW5jdGlvbih0ZSkgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRlLnRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0ZS50cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGUuc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHsKICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ3RyYWNrJyk7CiAgICAgICAgICAgICAgZXZlbnQudHJhY2sgPSB0cmFjazsKICAgICAgICAgICAgICBldmVudC5yZWNlaXZlciA9IHt0cmFjazogdHJhY2t9OwogICAgICAgICAgICAgIGV2ZW50LnN0cmVhbXMgPSBbZS5zdHJlYW1dOwogICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgICB9LmJpbmQodGhpcykpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKCiAgc2hpbVNvdXJjZU9iamVjdDogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHsKICAgICAgaWYgKHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50ICYmCiAgICAgICAgISgnc3JjT2JqZWN0JyBpbiB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUpKSB7CiAgICAgICAgLy8gU2hpbSB0aGUgc3JjT2JqZWN0IHByb3BlcnR5LCBvbmNlLCB3aGVuIEhUTUxNZWRpYUVsZW1lbnQgaXMgZm91bmQuCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyY09iamVjdCcsIHsKICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zcmNPYmplY3Q7CiAgICAgICAgICB9LAogICAgICAgICAgc2V0OiBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgICAvLyBVc2UgX3NyY09iamVjdCBhcyBhIHByaXZhdGUgcHJvcGVydHkgZm9yIHRoaXMgc2hpbQogICAgICAgICAgICB0aGlzLl9zcmNPYmplY3QgPSBzdHJlYW07CiAgICAgICAgICAgIGlmICh0aGlzLnNyYykgewogICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5zcmMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIXN0cmVhbSkgewogICAgICAgICAgICAgIHRoaXMuc3JjID0gJyc7CiAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTsKICAgICAgICAgICAgLy8gV2UgbmVlZCB0byByZWNyZWF0ZSB0aGUgYmxvYiB1cmwgd2hlbiBhIHRyYWNrIGlzIGFkZGVkIG9yCiAgICAgICAgICAgIC8vIHJlbW92ZWQuIERvaW5nIGl0IG1hbnVhbGx5IHNpbmNlIHdlIHdhbnQgdG8gYXZvaWQgYSByZWN1cnNpb24uCiAgICAgICAgICAgIHN0cmVhbS5hZGRFdmVudExpc3RlbmVyKCdhZGR0cmFjaycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIGlmIChzZWxmLnNyYykgewogICAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChzZWxmLnNyYyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHNlbGYuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc3RyZWFtLmFkZEV2ZW50TGlzdGVuZXIoJ3JlbW92ZXRyYWNrJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgaWYgKHNlbGYuc3JjKSB7CiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHNlbGYuc3JjKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgc2VsZi5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIC8vIFRoZSBSVENQZWVyQ29ubmVjdGlvbiBvYmplY3QuCiAgICBpZiAoIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikgewogICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gPSBmdW5jdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cykgewogICAgICAgIC8vIFRyYW5zbGF0ZSBpY2VUcmFuc3BvcnRQb2xpY3kgdG8gaWNlVHJhbnNwb3J0cywKICAgICAgICAvLyBzZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD00ODY5CiAgICAgICAgLy8gdGhpcyB3YXMgZml4ZWQgaW4gTTU2IGFsb25nIHdpdGggdW5wcmVmaXhpbmcgUlRDUGVlckNvbm5lY3Rpb24uCiAgICAgICAgbG9nZ2luZygnUGVlckNvbm5lY3Rpb24nKTsKICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5KSB7CiAgICAgICAgICBwY0NvbmZpZy5pY2VUcmFuc3BvcnRzID0gcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CiAgICAgIC8vIHdyYXAgc3RhdGljIG1ldGhvZHMuIEN1cnJlbnRseSBqdXN0IGdlbmVyYXRlQ2VydGlmaWNhdGUuCiAgICAgIGlmICh3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5nZW5lcmF0ZUNlcnRpZmljYXRlKSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiwgJ2dlbmVyYXRlQ2VydGlmaWNhdGUnLCB7CiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gd2Via2l0UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIHZhciBvcmlnR2V0U3RhdHMgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHM7CiAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbihzZWxlY3RvciwKICAgICAgICBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgYXJncyA9IGFyZ3VtZW50czsKCiAgICAgIC8vIElmIHNlbGVjdG9yIGlzIGEgZnVuY3Rpb24gdGhlbiB3ZSBhcmUgaW4gdGhlIG9sZCBzdHlsZSBzdGF0cyBzbyBqdXN0CiAgICAgIC8vIHBhc3MgYmFjayB0aGUgb3JpZ2luYWwgZ2V0U3RhdHMgZm9ybWF0IHRvIGF2b2lkIGJyZWFraW5nIG9sZCB1c2Vycy4KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHJldHVybiBvcmlnR2V0U3RhdHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgLy8gV2hlbiBzcGVjLXN0eWxlIGdldFN0YXRzIGlzIHN1cHBvcnRlZCwgcmV0dXJuIHRob3NlIHdoZW4gY2FsbGVkIHdpdGgKICAgICAgLy8gZWl0aGVyIG5vIGFyZ3VtZW50cyBvciB0aGUgc2VsZWN0b3IgYXJndW1lbnQgaXMgbnVsbC4KICAgICAgaWYgKG9yaWdHZXRTdGF0cy5sZW5ndGggPT09IDAgJiYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHwKICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpKSB7CiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbXSk7CiAgICAgIH0KCiAgICAgIHZhciBmaXhDaHJvbWVTdGF0c18gPSBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgIHZhciBzdGFuZGFyZFJlcG9ydCA9IHt9OwogICAgICAgIHZhciByZXBvcnRzID0gcmVzcG9uc2UucmVzdWx0KCk7CiAgICAgICAgcmVwb3J0cy5mb3JFYWNoKGZ1bmN0aW9uKHJlcG9ydCkgewogICAgICAgICAgdmFyIHN0YW5kYXJkU3RhdHMgPSB7CiAgICAgICAgICAgIGlkOiByZXBvcnQuaWQsCiAgICAgICAgICAgIHRpbWVzdGFtcDogcmVwb3J0LnRpbWVzdGFtcCwKICAgICAgICAgICAgdHlwZTogewogICAgICAgICAgICAgIGxvY2FsY2FuZGlkYXRlOiAnbG9jYWwtY2FuZGlkYXRlJywKICAgICAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgICAgICB9W3JlcG9ydC50eXBlXSB8fCByZXBvcnQudHlwZQogICAgICAgICAgfTsKICAgICAgICAgIHJlcG9ydC5uYW1lcygpLmZvckVhY2goZnVuY3Rpb24obmFtZSkgewogICAgICAgICAgICBzdGFuZGFyZFN0YXRzW25hbWVdID0gcmVwb3J0LnN0YXQobmFtZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHN0YW5kYXJkUmVwb3J0W3N0YW5kYXJkU3RhdHMuaWRdID0gc3RhbmRhcmRTdGF0czsKICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIHN0YW5kYXJkUmVwb3J0OwogICAgICB9OwoKICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICB2YXIgbWFrZU1hcFN0YXRzID0gZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICByZXR1cm4gbmV3IE1hcChPYmplY3Qua2V5cyhzdGF0cykubWFwKGZ1bmN0aW9uKGtleSkgewogICAgICAgICAgcmV0dXJuW2tleSwgc3RhdHNba2V5XV07CiAgICAgICAgfSkpOwogICAgICB9OwoKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMikgewogICAgICAgIHZhciBzdWNjZXNzQ2FsbGJhY2tXcmFwcGVyXyA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICBhcmdzWzFdKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgfTsKCiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbc3VjY2Vzc0NhbGxiYWNrV3JhcHBlcl8sCiAgICAgICAgICAgIGFyZ3VtZW50c1swXV0pOwogICAgICB9CgogICAgICAvLyBwcm9taXNlLXN1cHBvcnQKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIG9yaWdHZXRTdGF0cy5hcHBseShzZWxmLCBbCiAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICByZXNvbHZlKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgICB9LCByZWplY3RdKTsKICAgICAgfSkudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spOwogICAgfTsKCiAgICAvLyBhZGQgcHJvbWlzZSBzdXBwb3J0IC0tIG5hdGl2ZWx5IGF2YWlsYWJsZSBpbiBDaHJvbWUgNTEKICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNTEpIHsKICAgICAgWydzZXRMb2NhbERlc2NyaXB0aW9uJywgJ3NldFJlbW90ZURlc2NyaXB0aW9uJywgJ2FkZEljZUNhbmRpZGF0ZSddCiAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzOwogICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFthcmdzWzBdLCByZXNvbHZlLCByZWplY3RdKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGFyZ3NbMV0uYXBwbHkobnVsbCwgW10pOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZnVuY3Rpb24oZXJyKSB7CiAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPj0gMykgewogICAgICAgICAgICAgICAgICBhcmdzWzJdLmFwcGx5KG51bGwsIFtlcnJdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgfQoKICAgIC8vIHByb21pc2Ugc3VwcG9ydCBmb3IgY3JlYXRlT2ZmZXIgYW5kIGNyZWF0ZUFuc3dlci4gQXZhaWxhYmxlICh3aXRob3V0CiAgICAvLyBidWdzKSBzaW5jZSBNNTI6IGNyYnVnLzYxOTI4OQogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MikgewogICAgICBbJ2NyZWF0ZU9mZmVyJywgJ2NyZWF0ZUFuc3dlciddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDEgfHwgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYKICAgICAgICAgICAgICB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnb2JqZWN0JykpIHsKICAgICAgICAgICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkOwogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFtyZXNvbHZlLCByZWplY3QsIG9wdHNdKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CgogICAgLy8gc2hpbSBpbXBsaWNpdCBjcmVhdGlvbiBvZiBSVENTZXNzaW9uRGVzY3JpcHRpb24vUlRDSWNlQ2FuZGlkYXRlCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfQp9OwoKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbU1lZGlhU3RyZWFtOiBjaHJvbWVTaGltLnNoaW1NZWRpYVN0cmVhbSwKICBzaGltT25UcmFjazogY2hyb21lU2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QsCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBjaHJvbWVTaGltLnNoaW1QZWVyQ29ubmVjdGlvbiwKICBzaGltR2V0VXNlck1lZGlhOiByZXF1aXJlKCcuL2dldHVzZXJtZWRpYScpCn07Cgp9LHsiLi4vdXRpbHMuanMiOjExLCIuL2dldHVzZXJtZWRpYSI6NX1dLDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIGNvbnN0cmFpbnRzVG9DaHJvbWVfID0gZnVuY3Rpb24oYykgewogICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLm1hbmRhdG9yeSB8fCBjLm9wdGlvbmFsKSB7CiAgICAgIHJldHVybiBjOwogICAgfQogICAgdmFyIGNjID0ge307CiAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICBpZiAoa2V5ID09PSAncmVxdWlyZScgfHwga2V5ID09PSAnYWR2YW5jZWQnIHx8IGtleSA9PT0gJ21lZGlhU291cmNlJykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgciA9ICh0eXBlb2YgY1trZXldID09PSAnb2JqZWN0JykgPyBjW2tleV0gOiB7aWRlYWw6IGNba2V5XX07CiAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHIuZXhhY3QgPT09ICdudW1iZXInKSB7CiAgICAgICAgci5taW4gPSByLm1heCA9IHIuZXhhY3Q7CiAgICAgIH0KICAgICAgdmFyIG9sZG5hbWVfID0gZnVuY3Rpb24ocHJlZml4LCBuYW1lKSB7CiAgICAgICAgaWYgKHByZWZpeCkgewogICAgICAgICAgcmV0dXJuIHByZWZpeCArIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gKG5hbWUgPT09ICdkZXZpY2VJZCcpID8gJ3NvdXJjZUlkJyA6IG5hbWU7CiAgICAgIH07CiAgICAgIGlmIChyLmlkZWFsICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjYy5vcHRpb25hbCA9IGNjLm9wdGlvbmFsIHx8IFtdOwogICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgIGlmICh0eXBlb2Ygci5pZGVhbCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCdtaW4nLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICAgIG9jID0ge307CiAgICAgICAgICBvY1tvbGRuYW1lXygnbWF4Jywga2V5KV0gPSByLmlkZWFsOwogICAgICAgICAgY2Mub3B0aW9uYWwucHVzaChvYyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHIuZXhhY3QgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygci5leGFjdCAhPT0gJ251bWJlcicpIHsKICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgY2MubWFuZGF0b3J5W29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuZXhhY3Q7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgWydtaW4nLCAnbWF4J10uZm9yRWFjaChmdW5jdGlvbihtaXgpIHsKICAgICAgICAgIGlmIChyW21peF0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgICAgIGNjLm1hbmRhdG9yeVtvbGRuYW1lXyhtaXgsIGtleSldID0gclttaXhdOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICAgIGlmIChjLmFkdmFuY2VkKSB7CiAgICAgIGNjLm9wdGlvbmFsID0gKGNjLm9wdGlvbmFsIHx8IFtdKS5jb25jYXQoYy5hZHZhbmNlZCk7CiAgICB9CiAgICByZXR1cm4gY2M7CiAgfTsKCiAgdmFyIHNoaW1Db25zdHJhaW50c18gPSBmdW5jdGlvbihjb25zdHJhaW50cywgZnVuYykgewogICAgY29uc3RyYWludHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7CiAgICBpZiAoY29uc3RyYWludHMgJiYgY29uc3RyYWludHMuYXVkaW8pIHsKICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy5hdWRpbyk7CiAgICB9CiAgICBpZiAoY29uc3RyYWludHMgJiYgdHlwZW9mIGNvbnN0cmFpbnRzLnZpZGVvID09PSAnb2JqZWN0JykgewogICAgICAvLyBTaGltIGZhY2luZ01vZGUgZm9yIG1vYmlsZSwgd2hlcmUgaXQgZGVmYXVsdHMgdG8gInVzZXIiLgogICAgICB2YXIgZmFjZSA9IGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgIGZhY2UgPSBmYWNlICYmICgodHlwZW9mIGZhY2UgPT09ICdvYmplY3QnKSA/IGZhY2UgOiB7aWRlYWw6IGZhY2V9KTsKCiAgICAgIGlmICgoZmFjZSAmJiAoZmFjZS5leGFjdCA9PT0gJ3VzZXInIHx8IGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwKICAgICAgICAgICAgICAgICAgICBmYWNlLmlkZWFsID09PSAndXNlcicgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykpICYmCiAgICAgICAgICAhKG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0U3VwcG9ydGVkQ29uc3RyYWludHMgJiYKICAgICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRTdXBwb3J0ZWRDb25zdHJhaW50cygpLmZhY2luZ01vZGUpKSB7CiAgICAgICAgZGVsZXRlIGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgICAgaWYgKGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykgewogICAgICAgICAgLy8gTG9vayBmb3IgImJhY2siIGluIGxhYmVsLCBvciB1c2UgbGFzdCBjYW0gKHR5cGljYWxseSBiYWNrIGNhbSkuCiAgICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzKCkKICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgZGV2aWNlcyA9IGRldmljZXMuZmlsdGVyKGZ1bmN0aW9uKGQpIHsKICAgICAgICAgICAgICByZXR1cm4gZC5raW5kID09PSAndmlkZW9pbnB1dCc7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgYmFjayA9IGRldmljZXMuZmluZChmdW5jdGlvbihkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGQubGFiZWwudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdiYWNrJykgIT09IC0xOwogICAgICAgICAgICB9KSB8fCAoZGV2aWNlcy5sZW5ndGggJiYgZGV2aWNlc1tkZXZpY2VzLmxlbmd0aCAtIDFdKTsKICAgICAgICAgICAgaWYgKGJhY2spIHsKICAgICAgICAgICAgICBjb25zdHJhaW50cy52aWRlby5kZXZpY2VJZCA9IGZhY2UuZXhhY3QgPyB7ZXhhY3Q6IGJhY2suZGV2aWNlSWR9IDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aWRlYWw6IGJhY2suZGV2aWNlSWR9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0Nocm9tZV8oY29uc3RyYWludHMudmlkZW8pOwogICAgICAgICAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgICAgICAgICByZXR1cm4gZnVuYyhjb25zdHJhaW50cyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3RyYWludHMudmlkZW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy52aWRlbyk7CiAgICB9CiAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgcmV0dXJuIGZ1bmMoY29uc3RyYWludHMpOwogIH07CgogIHZhciBzaGltRXJyb3JfID0gZnVuY3Rpb24oZSkgewogICAgcmV0dXJuIHsKICAgICAgbmFtZTogewogICAgICAgIFBlcm1pc3Npb25EZW5pZWRFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgQ29uc3RyYWludE5vdFNhdGlzZmllZEVycm9yOiAnT3ZlcmNvbnN0cmFpbmVkRXJyb3InCiAgICAgIH1bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50TmFtZSwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgc2hpbUNvbnN0cmFpbnRzXyhjb25zdHJhaW50cywgZnVuY3Rpb24oYykgewogICAgICBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKGMsIG9uU3VjY2VzcywgZnVuY3Rpb24oZSkgewogICAgICAgIG9uRXJyb3Ioc2hpbUVycm9yXyhlKSk7CiAgICAgIH0pOwogICAgfSk7CiAgfTsKCiAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IGdldFVzZXJNZWRpYV87CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICBpZiAoIW5hdmlnYXRvci5tZWRpYURldmljZXMpIHsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMgPSB7CiAgICAgIGdldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGVudW1lcmF0ZURldmljZXM6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIga2luZHMgPSB7YXVkaW86ICdhdWRpb2lucHV0JywgdmlkZW86ICd2aWRlb2lucHV0J307CiAgICAgICAgICByZXR1cm4gTWVkaWFTdHJlYW1UcmFjay5nZXRTb3VyY2VzKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgcmVzb2x2ZShkZXZpY2VzLm1hcChmdW5jdGlvbihkZXZpY2UpIHsKICAgICAgICAgICAgICByZXR1cm4ge2xhYmVsOiBkZXZpY2UubGFiZWwsCiAgICAgICAgICAgICAgICAgICAgICBraW5kOiBraW5kc1tkZXZpY2Uua2luZF0sCiAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZDogZGV2aWNlLmlkLAogICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogJyd9OwogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfTsKICB9CgogIC8vIEEgc2hpbSBmb3IgZ2V0VXNlck1lZGlhIG1ldGhvZCBvbiB0aGUgbWVkaWFEZXZpY2VzIG9iamVjdC4KICAvLyBUT0RPKEthcHRlbkphbnNzb24pIHJlbW92ZSBvbmNlIGltcGxlbWVudGVkIGluIENocm9tZSBzdGFibGUuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSkgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cykgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhUHJvbWlzZV8oY29uc3RyYWludHMpOwogICAgfTsKICB9IGVsc2UgewogICAgLy8gRXZlbiB0aG91Z2ggQ2hyb21lIDQ1IGhhcyBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzIGFuZCBhIGdldFVzZXJNZWRpYQogICAgLy8gZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhIFByb21pc2UsIGl0IGRvZXMgbm90IGFjY2VwdCBzcGVjLXN0eWxlCiAgICAvLyBjb25zdHJhaW50cy4KICAgIHZhciBvcmlnR2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEuCiAgICAgICAgYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY3MpIHsKICAgICAgcmV0dXJuIHNoaW1Db25zdHJhaW50c18oY3MsIGZ1bmN0aW9uKGMpIHsKICAgICAgICByZXR1cm4gb3JpZ0dldFVzZXJNZWRpYShjKS50aGVuKGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICAgIGMudmlkZW8gJiYgIXN0cmVhbS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCkgewogICAgICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJycsICdOb3RGb3VuZEVycm9yJyk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gc3RyZWFtOwogICAgICAgIH0sIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KCiAgLy8gRHVtbXkgZGV2aWNlY2hhbmdlIGV2ZW50IG1ldGhvZHMuCiAgLy8gVE9ETyhLYXB0ZW5KYW5zc29uKSByZW1vdmUgb25jZSBpbXBsZW1lbnRlZCBpbiBDaHJvbWUgc3RhYmxlLgogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQp9OwoKfSx7Ii4uL3V0aWxzLmpzIjoxMX1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7Cgp2YXIgU0RQVXRpbHMgPSByZXF1aXJlKCdzZHAnKTsKdmFyIGJyb3dzZXJEZXRhaWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5icm93c2VyRGV0YWlsczsKCnZhciBlZGdlU2hpbSA9IHsKICBzaGltUGVlckNvbm5lY3Rpb246IGZ1bmN0aW9uKCkgewogICAgaWYgKHdpbmRvdy5SVENJY2VHYXRoZXJlcikgewogICAgICAvLyBPUlRDIGRlZmluZXMgYW4gUlRDSWNlQ2FuZGlkYXRlIG9iamVjdCBidXQgbm8gY29uc3RydWN0b3IuCiAgICAgIC8vIE5vdCBpbXBsZW1lbnRlZCBpbiBFZGdlLgogICAgICBpZiAoIXdpbmRvdy5SVENJY2VDYW5kaWRhdGUpIHsKICAgICAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oYXJncykgewogICAgICAgICAgcmV0dXJuIGFyZ3M7CiAgICAgICAgfTsKICAgICAgfQogICAgICAvLyBPUlRDIGRvZXMgbm90IGhhdmUgYSBzZXNzaW9uIGRlc2NyaXB0aW9uIG9iamVjdCBidXQKICAgICAgLy8gb3RoZXIgYnJvd3NlcnMgKGkuZS4gQ2hyb21lKSB0aGF0IHdpbGwgc3VwcG9ydCBib3RoIFBDIGFuZCBPUlRDCiAgICAgIC8vIGluIHRoZSBmdXR1cmUgbWlnaHQgaGF2ZSB0aGlzIGRlZmluZWQgYWxyZWFkeS4KICAgICAgaWYgKCF3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKSB7CiAgICAgICAgd2luZG93LlJUQ1Nlc3Npb25EZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGFyZ3MpIHsKICAgICAgICAgIHJldHVybiBhcmdzOwogICAgICAgIH07CiAgICAgIH0KICAgICAgLy8gdGhpcyBhZGRzIGFuIGFkZGl0aW9uYWwgZXZlbnQgbGlzdGVuZXIgdG8gTWVkaWFTdHJhY2tUcmFjayB0aGF0IHNpZ25hbHMKICAgICAgLy8gd2hlbiBhIHRyYWNrcyBlbmFibGVkIHByb3BlcnR5IHdhcyBjaGFuZ2VkLiBXb3JrYXJvdW5kIGZvciBhIGJ1ZyBpbgogICAgICAvLyBhZGRTdHJlYW0sIHNlZSBiZWxvdy4gTm8gbG9uZ2VyIHJlcXVpcmVkIGluIDE1MDI1KwogICAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDE1MDI1KSB7CiAgICAgICAgdmFyIG9yaWdNU1RFbmFibGVkID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcigKICAgICAgICAgICAgTWVkaWFTdHJlYW1UcmFjay5wcm90b3R5cGUsICdlbmFibGVkJyk7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLCAnZW5hYmxlZCcsIHsKICAgICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgb3JpZ01TVEVuYWJsZWQuc2V0LmNhbGwodGhpcywgdmFsdWUpOwogICAgICAgICAgICB2YXIgZXYgPSBuZXcgRXZlbnQoJ2VuYWJsZWQnKTsKICAgICAgICAgICAgZXYuZW5hYmxlZCA9IHZhbHVlOwogICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24oY29uZmlnKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgIHZhciBfZXZlbnRUYXJnZXQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CiAgICAgIFsnYWRkRXZlbnRMaXN0ZW5lcicsICdyZW1vdmVFdmVudExpc3RlbmVyJywgJ2Rpc3BhdGNoRXZlbnQnXQogICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgICAgIHNlbGZbbWV0aG9kXSA9IF9ldmVudFRhcmdldFttZXRob2RdLmJpbmQoX2V2ZW50VGFyZ2V0KTsKICAgICAgICAgIH0pOwoKICAgICAgdGhpcy5vbmljZWNhbmRpZGF0ZSA9IG51bGw7CiAgICAgIHRoaXMub25hZGRzdHJlYW0gPSBudWxsOwogICAgICB0aGlzLm9udHJhY2sgPSBudWxsOwogICAgICB0aGlzLm9ucmVtb3Zlc3RyZWFtID0gbnVsbDsKICAgICAgdGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlID0gbnVsbDsKICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCA9IG51bGw7CiAgICAgIHRoaXMub25kYXRhY2hhbm5lbCA9IG51bGw7CgogICAgICB0aGlzLmxvY2FsU3RyZWFtcyA9IFtdOwogICAgICB0aGlzLnJlbW90ZVN0cmVhbXMgPSBbXTsKICAgICAgdGhpcy5nZXRMb2NhbFN0cmVhbXMgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gc2VsZi5sb2NhbFN0cmVhbXM7CiAgICAgIH07CiAgICAgIHRoaXMuZ2V0UmVtb3RlU3RyZWFtcyA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBzZWxmLnJlbW90ZVN0cmVhbXM7CiAgICAgIH07CgogICAgICB0aGlzLmxvY2FsRGVzY3JpcHRpb24gPSBuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHsKICAgICAgICB0eXBlOiAnJywKICAgICAgICBzZHA6ICcnCiAgICAgIH0pOwogICAgICB0aGlzLnJlbW90ZURlc2NyaXB0aW9uID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJycsCiAgICAgICAgc2RwOiAnJwogICAgICB9KTsKICAgICAgdGhpcy5zaWduYWxpbmdTdGF0ZSA9ICdzdGFibGUnOwogICAgICB0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSA9ICduZXcnOwogICAgICB0aGlzLmljZUdhdGhlcmluZ1N0YXRlID0gJ25ldyc7CgogICAgICB0aGlzLmljZU9wdGlvbnMgPSB7CiAgICAgICAgZ2F0aGVyUG9saWN5OiAnYWxsJywKICAgICAgICBpY2VTZXJ2ZXJzOiBbXQogICAgICB9OwogICAgICBpZiAoY29uZmlnICYmIGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICBzd2l0Y2ggKGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICAgIGNhc2UgJ2FsbCc6CiAgICAgICAgICBjYXNlICdyZWxheSc6CiAgICAgICAgICAgIHRoaXMuaWNlT3B0aW9ucy5nYXRoZXJQb2xpY3kgPSBjb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgJ25vbmUnOgogICAgICAgICAgICAvLyBGSVhNRTogcmVtb3ZlIG9uY2UgaW1wbGVtZW50YXRpb24gYW5kIHNwZWMgaGF2ZSBhZGRlZCB0aGlzLgogICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpY2VUcmFuc3BvcnRQb2xpY3kgIm5vbmUiIG5vdCBzdXBwb3J0ZWQnKTsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIC8vIGRvbid0IHNldCBpY2VUcmFuc3BvcnRQb2xpY3kuCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnVzaW5nQnVuZGxlID0gY29uZmlnICYmIGNvbmZpZy5idW5kbGVQb2xpY3kgPT09ICdtYXgtYnVuZGxlJzsKCiAgICAgIGlmIChjb25maWcgJiYgY29uZmlnLmljZVNlcnZlcnMpIHsKICAgICAgICAvLyBFZGdlIGRvZXMgbm90IGxpa2UKICAgICAgICAvLyAxKSBzdHVuOgogICAgICAgIC8vIDIpIHR1cm46IHRoYXQgZG9lcyBub3QgaGF2ZSBhbGwgb2YgdHVybjpob3N0OnBvcnQ/dHJhbnNwb3J0PXVkcAogICAgICAgIC8vIDMpIHR1cm46IHdpdGggaXB2NiBhZGRyZXNzZXMKICAgICAgICB2YXIgaWNlU2VydmVycyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29uZmlnLmljZVNlcnZlcnMpKTsKICAgICAgICB0aGlzLmljZU9wdGlvbnMuaWNlU2VydmVycyA9IGljZVNlcnZlcnMuZmlsdGVyKGZ1bmN0aW9uKHNlcnZlcikgewogICAgICAgICAgaWYgKHNlcnZlciAmJiBzZXJ2ZXIudXJscykgewogICAgICAgICAgICB2YXIgdXJscyA9IHNlcnZlci51cmxzOwogICAgICAgICAgICBpZiAodHlwZW9mIHVybHMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgdXJscyA9IFt1cmxzXTsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cmxzID0gdXJscy5maWx0ZXIoZnVuY3Rpb24odXJsKSB7CiAgICAgICAgICAgICAgcmV0dXJuICh1cmwuaW5kZXhPZigndHVybjonKSA9PT0gMCAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHJhbnNwb3J0PXVkcCcpICE9PSAtMSAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHVybjpbJykgPT09IC0xKSB8fAogICAgICAgICAgICAgICAgICAodXJsLmluZGV4T2YoJ3N0dW46JykgPT09IDAgJiYKICAgICAgICAgICAgICAgICAgICBicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE0MzkzKTsKICAgICAgICAgICAgfSlbMF07CiAgICAgICAgICAgIHJldHVybiAhIXVybHM7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnOwoKICAgICAgLy8gcGVyLXRyYWNrIGljZUdhdGhlcnMsIGljZVRyYW5zcG9ydHMsIGR0bHNUcmFuc3BvcnRzLCBydHBTZW5kZXJzLCAuLi4KICAgICAgLy8gZXZlcnl0aGluZyB0aGF0IGlzIG5lZWRlZCB0byBkZXNjcmliZSBhIFNEUCBtLWxpbmUuCiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzID0gW107CgogICAgICAvLyBzaW5jZSB0aGUgaWNlR2F0aGVyZXIgaXMgY3VycmVudGx5IGNyZWF0ZWQgaW4gY3JlYXRlT2ZmZXIgYnV0IHdlCiAgICAgIC8vIG11c3Qgbm90IGVtaXQgY2FuZGlkYXRlcyB1bnRpbCBhZnRlciBzZXRMb2NhbERlc2NyaXB0aW9uIHdlIGJ1ZmZlcgogICAgICAvLyB0aGVtIGluIHRoaXMgYXJyYXkuCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlciA9IFtdOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZScpOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICBpZiAodGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgdGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlKGV2ZW50KTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLmxvY2FsRGVzY3JpcHRpb24uc2RwKTsKICAgICAgLy8gRklYTUU6IG5lZWQgdG8gYXBwbHkgaWNlIGNhbmRpZGF0ZXMgaW4gYSB3YXkgd2hpY2ggaXMgYXN5bmMgYnV0CiAgICAgIC8vIGluLW9yZGVyCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlci5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgdmFyIGVuZCA9ICFldmVudC5jYW5kaWRhdGUgfHwgT2JqZWN0LmtleXMoZXZlbnQuY2FuZGlkYXRlKS5sZW5ndGggPT09IDA7CiAgICAgICAgaWYgKGVuZCkgewogICAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBzZWN0aW9ucy5sZW5ndGg7IGorKykgewogICAgICAgICAgICBpZiAoc2VjdGlvbnNbal0uaW5kZXhPZignXHJcbmE9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJykgPT09IC0xKSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbal0gKz0gJ2E9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWN0aW9uc1tldmVudC5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleCArIDFdICs9CiAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgfQogICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICBzZWxmLm9uaWNlY2FuZGlkYXRlKGV2ZW50KTsKICAgICAgICB9CiAgICAgICAgaWYgKCFldmVudC5jYW5kaWRhdGUgJiYgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSAhPT0gJ2NvbXBsZXRlJykgewogICAgICAgICAgdmFyIGNvbXBsZXRlID0gc2VsZi50cmFuc2NlaXZlcnMuZXZlcnkoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICB0cmFuc2NlaXZlci5pY2VHYXRoZXJlci5zdGF0ZSA9PT0gJ2NvbXBsZXRlZCc7CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChjb21wbGV0ZSAmJiBzZWxmLmljZUdhdGhlcmluZ1N0YXRlQ2hhbmdlICE9PSAnY29tcGxldGUnKSB7CiAgICAgICAgICAgIHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUgPSAnY29tcGxldGUnOwogICAgICAgICAgICBzZWxmLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIgPSBbXTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRDb25maWd1cmF0aW9uID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLl9jb25maWc7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkU3RyZWFtID0gZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE1MDI1KSB7CiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXMucHVzaChzdHJlYW0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIENsb25lIGlzIG5lY2Vzc2FyeSBmb3IgbG9jYWwgZGVtb3MgbW9zdGx5LCBhdHRhY2hpbmcgZGlyZWN0bHkKICAgICAgICAvLyB0byB0d28gZGlmZmVyZW50IHNlbmRlcnMgZG9lcyBub3Qgd29yayAoYnVpbGQgMTA1NDcpLgogICAgICAgIC8vIEZpeGVkIGluIDE1MDI1IChvciBlYXJsaWVyKQogICAgICAgIHZhciBjbG9uZWRTdHJlYW0gPSBzdHJlYW0uY2xvbmUoKTsKICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaywgaWR4KSB7CiAgICAgICAgICB2YXIgY2xvbmVkVHJhY2sgPSBjbG9uZWRTdHJlYW0uZ2V0VHJhY2tzKClbaWR4XTsKICAgICAgICAgIHRyYWNrLmFkZEV2ZW50TGlzdGVuZXIoJ2VuYWJsZWQnLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBjbG9uZWRUcmFjay5lbmFibGVkID0gZXZlbnQuZW5hYmxlZDsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHRoaXMubG9jYWxTdHJlYW1zLnB1c2goY2xvbmVkU3RyZWFtKTsKICAgICAgfQogICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICB2YXIgaWR4ID0gdGhpcy5sb2NhbFN0cmVhbXMuaW5kZXhPZihzdHJlYW0pOwogICAgICBpZiAoaWR4ID4gLTEpIHsKICAgICAgICB0aGlzLmxvY2FsU3RyZWFtcy5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy50cmFuc2NlaXZlcnMuZmlsdGVyKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuICEhdHJhbnNjZWl2ZXIucnRwU2VuZGVyOwogICAgICB9KQogICAgICAubWFwKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLnJ0cFNlbmRlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVjZWl2ZXJzID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLnRyYW5zY2VpdmVycy5maWx0ZXIoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICByZXR1cm4gISF0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSkKICAgICAgLm1hcChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIHJldHVybiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIC8vIERldGVybWluZXMgdGhlIGludGVyc2VjdGlvbiBvZiBsb2NhbCBhbmQgcmVtb3RlIGNhcGFiaWxpdGllcy4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2dldENvbW1vbkNhcGFiaWxpdGllcyA9CiAgICAgICAgZnVuY3Rpb24obG9jYWxDYXBhYmlsaXRpZXMsIHJlbW90ZUNhcGFiaWxpdGllcykgewogICAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHsKICAgICAgICAgICAgY29kZWNzOiBbXSwKICAgICAgICAgICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICAgICAgICAgIGZlY01lY2hhbmlzbXM6IFtdCiAgICAgICAgICB9OwogICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24obENvZGVjKSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3RlQ2FwYWJpbGl0aWVzLmNvZGVjcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIHZhciByQ29kZWMgPSByZW1vdGVDYXBhYmlsaXRpZXMuY29kZWNzW2ldOwogICAgICAgICAgICAgIGlmIChsQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpID09PSByQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpICYmCiAgICAgICAgICAgICAgICAgIGxDb2RlYy5jbG9ja1JhdGUgPT09IHJDb2RlYy5jbG9ja1JhdGUpIHsKICAgICAgICAgICAgICAgIC8vIG51bWJlciBvZiBjaGFubmVscyBpcyB0aGUgaGlnaGVzdCBjb21tb24gbnVtYmVyIG9mIGNoYW5uZWxzCiAgICAgICAgICAgICAgICByQ29kZWMubnVtQ2hhbm5lbHMgPSBNYXRoLm1pbihsQ29kZWMubnVtQ2hhbm5lbHMsCiAgICAgICAgICAgICAgICAgICAgckNvZGVjLm51bUNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIC8vIHB1c2ggckNvZGVjIHNvIHdlIHJlcGx5IHdpdGggb2ZmZXJlciBwYXlsb2FkIHR5cGUKICAgICAgICAgICAgICAgIGNvbW1vbkNhcGFiaWxpdGllcy5jb2RlY3MucHVzaChyQ29kZWMpOwoKICAgICAgICAgICAgICAgIC8vIGRldGVybWluZSBjb21tb24gZmVlZGJhY2sgbWVjaGFuaXNtcwogICAgICAgICAgICAgICAgckNvZGVjLnJ0Y3BGZWVkYmFjayA9IHJDb2RlYy5ydGNwRmVlZGJhY2suZmlsdGVyKGZ1bmN0aW9uKGZiKSB7CiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbENvZGVjLnJ0Y3BGZWVkYmFjay5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGlmIChsQ29kZWMucnRjcEZlZWRiYWNrW2pdLnR5cGUgPT09IGZiLnR5cGUgJiYKICAgICAgICAgICAgICAgICAgICAgICAgbENvZGVjLnJ0Y3BGZWVkYmFja1tqXS5wYXJhbWV0ZXIgPT09IGZiLnBhcmFtZXRlcikgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFsc28gbmVlZCB0byBkZXRlcm1pbmUgLnBhcmFtZXRlcnMKICAgICAgICAgICAgICAgIC8vICBzZWUgaHR0cHM6Ly9naXRodWIuY29tL29wZW5wZWVyL29ydGMvaXNzdWVzLzU2OQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zCiAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obEhlYWRlckV4dGVuc2lvbikgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZW1vdGVDYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9ucy5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgIGkrKykgewogICAgICAgICAgICAgICAgICB2YXIgckhlYWRlckV4dGVuc2lvbiA9IHJlbW90ZUNhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zW2ldOwogICAgICAgICAgICAgICAgICBpZiAobEhlYWRlckV4dGVuc2lvbi51cmkgPT09IHJIZWFkZXJFeHRlbnNpb24udXJpKSB7CiAgICAgICAgICAgICAgICAgICAgY29tbW9uQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMucHVzaChySGVhZGVyRXh0ZW5zaW9uKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgIC8vIEZJWE1FOiBmZWNNZWNoYW5pc21zCiAgICAgICAgICByZXR1cm4gY29tbW9uQ2FwYWJpbGl0aWVzOwogICAgICAgIH07CgogICAgLy8gQ3JlYXRlIElDRSBnYXRoZXJlciwgSUNFIHRyYW5zcG9ydCBhbmQgRFRMUyB0cmFuc3BvcnQuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyA9CiAgICAgICAgZnVuY3Rpb24obWlkLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgaWNlR2F0aGVyZXIgPSBuZXcgUlRDSWNlR2F0aGVyZXIoc2VsZi5pY2VPcHRpb25zKTsKICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSBuZXcgUlRDSWNlVHJhbnNwb3J0KGljZUdhdGhlcmVyKTsKICAgICAgICAgIGljZUdhdGhlcmVyLm9ubG9jYWxjYW5kaWRhdGUgPSBmdW5jdGlvbihldnQpIHsKICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKTsKICAgICAgICAgICAgZXZlbnQuY2FuZGlkYXRlID0ge3NkcE1pZDogbWlkLCBzZHBNTGluZUluZGV4OiBzZHBNTGluZUluZGV4fTsKCiAgICAgICAgICAgIHZhciBjYW5kID0gZXZ0LmNhbmRpZGF0ZTsKICAgICAgICAgICAgdmFyIGVuZCA9ICFjYW5kIHx8IE9iamVjdC5rZXlzKGNhbmQpLmxlbmd0aCA9PT0gMDsKICAgICAgICAgICAgLy8gRWRnZSBlbWl0cyBhbiBlbXB0eSBvYmplY3QgZm9yIFJUQ0ljZUNhbmRpZGF0ZUNvbXBsZXRl4oClCiAgICAgICAgICAgIGlmIChlbmQpIHsKICAgICAgICAgICAgICAvLyBwb2x5ZmlsbCBzaW5jZSBSVENJY2VHYXRoZXJlci5zdGF0ZSBpcyBub3QgaW1wbGVtZW50ZWQgaW4KICAgICAgICAgICAgICAvLyBFZGdlIDEwNTQ3IHlldC4KICAgICAgICAgICAgICBpZiAoaWNlR2F0aGVyZXIuc3RhdGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgaWNlR2F0aGVyZXIuc3RhdGUgPSAnY29tcGxldGVkJzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gUlRDSWNlQ2FuZGlkYXRlIGRvZXNuJ3QgaGF2ZSBhIGNvbXBvbmVudCwgbmVlZHMgdG8gYmUgYWRkZWQKICAgICAgICAgICAgICBjYW5kLmNvbXBvbmVudCA9IGljZVRyYW5zcG9ydC5jb21wb25lbnQgPT09ICdSVENQJyA/IDIgOiAxOwogICAgICAgICAgICAgIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgPSBTRFBVdGlscy53cml0ZUNhbmRpZGF0ZShjYW5kKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdXBkYXRlIGxvY2FsIGRlc2NyaXB0aW9uLgogICAgICAgICAgICB2YXIgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHApOwogICAgICAgICAgICBpZiAoIWVuZCkgewogICAgICAgICAgICAgIHNlY3Rpb25zW2V2ZW50LmNhbmRpZGF0ZS5zZHBNTGluZUluZGV4ICsgMV0gKz0KICAgICAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbZXZlbnQuY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXggKyAxXSArPQogICAgICAgICAgICAgICAgICAnYT1lbmQtb2YtY2FuZGlkYXRlc1xyXG4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IHNlbGYuX3BlbmRpbmdPZmZlciA/IHNlbGYuX3BlbmRpbmdPZmZlciA6CiAgICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyczsKICAgICAgICAgICAgdmFyIGNvbXBsZXRlID0gdHJhbnNjZWl2ZXJzLmV2ZXJ5KGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLnN0YXRlID09PSAnY29tcGxldGVkJzsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBFbWl0IGNhbmRpZGF0ZSBpZiBsb2NhbERlc2NyaXB0aW9uIGlzIHNldC4KICAgICAgICAgICAgLy8gQWxzbyBlbWl0cyBudWxsIGNhbmRpZGF0ZSB3aGVuIGFsbCBnYXRoZXJlcnMgYXJlIGNvbXBsZXRlLgogICAgICAgICAgICBzd2l0Y2ggKHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUpIHsKICAgICAgICAgICAgICBjYXNlICduZXcnOgogICAgICAgICAgICAgICAgaWYgKCFlbmQpIHsKICAgICAgICAgICAgICAgICAgc2VsZi5fbG9jYWxJY2VDYW5kaWRhdGVzQnVmZmVyLnB1c2goZXZlbnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGVuZCAmJiBjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIucHVzaCgKICAgICAgICAgICAgICAgICAgICAgIG5ldyBFdmVudCgnaWNlY2FuZGlkYXRlJykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAnZ2F0aGVyaW5nJzoKICAgICAgICAgICAgICAgIHNlbGYuX2VtaXRCdWZmZXJlZENhbmRpZGF0ZXMoKTsKICAgICAgICAgICAgICAgIGlmICghZW5kKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShldmVudCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKSk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShuZXcgRXZlbnQoJ2ljZWNhbmRpZGF0ZScpKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBzZWxmLmljZUdhdGhlcmluZ1N0YXRlID0gJ2NvbXBsZXRlJzsKICAgICAgICAgICAgICAgICAgc2VsZi5fZW1pdEdhdGhlcmluZ1N0YXRlQ2hhbmdlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlICdjb21wbGV0ZSc6CiAgICAgICAgICAgICAgICAvLyBzaG91bGQgbm90IGhhcHBlbi4uLiBjdXJyZW50bHkhCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBkZWZhdWx0OiAvLyBuby1vcC4KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgaWNlVHJhbnNwb3J0Lm9uaWNlc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHZhciBkdGxzVHJhbnNwb3J0ID0gbmV3IFJUQ0R0bHNUcmFuc3BvcnQoaWNlVHJhbnNwb3J0KTsKICAgICAgICAgIGR0bHNUcmFuc3BvcnQub25kdGxzc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwogICAgICAgICAgZHRsc1RyYW5zcG9ydC5vbmVycm9yID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIC8vIG9uZXJyb3IgZG9lcyBub3Qgc2V0IHN0YXRlIHRvIGZhaWxlZCBieSBpdHNlbGYuCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQuc3RhdGUgPSAnZmFpbGVkJzsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGljZUdhdGhlcmVyOiBpY2VHYXRoZXJlciwKICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiBpY2VUcmFuc3BvcnQsCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IGR0bHNUcmFuc3BvcnQKICAgICAgICAgIH07CiAgICAgICAgfTsKCiAgICAvLyBTdGFydCB0aGUgUlRQIFNlbmRlciBhbmQgUmVjZWl2ZXIgZm9yIGEgdHJhbnNjZWl2ZXIuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl90cmFuc2NlaXZlID0gZnVuY3Rpb24odHJhbnNjZWl2ZXIsCiAgICAgICAgc2VuZCwgcmVjdikgewogICAgICB2YXIgcGFyYW1zID0gdGhpcy5fZ2V0Q29tbW9uQ2FwYWJpbGl0aWVzKHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLAogICAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzKTsKICAgICAgaWYgKHNlbmQgJiYgdHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgcGFyYW1zLmVuY29kaW5ncyA9IHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgcGFyYW1zLnJ0Y3AgPSB7CiAgICAgICAgICBjbmFtZTogU0RQVXRpbHMubG9jYWxDTmFtZQogICAgICAgIH07CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLnJlY3ZFbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoKSB7CiAgICAgICAgICBwYXJhbXMucnRjcC5zc3JjID0gdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjOwogICAgICAgIH0KICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc2VuZChwYXJhbXMpOwogICAgICB9CiAgICAgIGlmIChyZWN2ICYmIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyKSB7CiAgICAgICAgLy8gcmVtb3ZlIFJUWCBmaWVsZCBpbiBFZGdlIDE0OTQyCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmtpbmQgPT09ICd2aWRlbycKICAgICAgICAgICAgJiYgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycykgewogICAgICAgICAgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHApIHsKICAgICAgICAgICAgZGVsZXRlIHAucnR4OwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHBhcmFtcy5lbmNvZGluZ3MgPSB0cmFuc2NlaXZlci5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgIHBhcmFtcy5ydGNwID0gewogICAgICAgICAgY25hbWU6IHRyYW5zY2VpdmVyLmNuYW1lCiAgICAgICAgfTsKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycy5sZW5ndGgpIHsKICAgICAgICAgIHBhcmFtcy5ydGNwLnNzcmMgPSB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmM7CiAgICAgICAgfQogICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnJlY2VpdmUocGFyYW1zKTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb24gPQogICAgICAgIGZ1bmN0aW9uKGRlc2NyaXB0aW9uKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgc2VjdGlvbnM7CiAgICAgICAgICB2YXIgc2Vzc2lvbnBhcnQ7CiAgICAgICAgICBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ29mZmVyJykgewogICAgICAgICAgICAvLyBGSVhNRTogV2hhdCB3YXMgdGhlIHB1cnBvc2Ugb2YgdGhpcyBlbXB0eSBpZiBzdGF0ZW1lbnQ/CiAgICAgICAgICAgIC8vIGlmICghdGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgICAgIC8vIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nT2ZmZXIpIHsKICAgICAgICAgICAgICAvLyBWRVJZIGxpbWl0ZWQgc3VwcG9ydCBmb3IgU0RQIG11bmdpbmcuIExpbWl0ZWQgdG86CiAgICAgICAgICAgICAgLy8gKiBjaGFuZ2luZyB0aGUgb3JkZXIgb2YgY29kZWNzCiAgICAgICAgICAgICAgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKGRlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQgPSBzZWN0aW9ucy5zaGlmdCgpOwogICAgICAgICAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICAgICAgICB2YXIgY2FwcyA9IFNEUFV0aWxzLnBhcnNlUnRwUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICAgICAgc2VsZi5fcGVuZGluZ09mZmVyW3NkcE1MaW5lSW5kZXhdLmxvY2FsQ2FwYWJpbGl0aWVzID0gY2FwczsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0aGlzLnRyYW5zY2VpdmVycyA9IHRoaXMuX3BlbmRpbmdPZmZlcjsKICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcGVuZGluZ09mZmVyOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgICAgIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgIHNlc3Npb25wYXJ0ID0gc2VjdGlvbnMuc2hpZnQoKTsKICAgICAgICAgICAgdmFyIGlzSWNlTGl0ZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgICBzZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKG1lZGlhU2VjdGlvbiwgc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQ7CiAgICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0OwogICAgICAgICAgICAgIHZhciBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwogICAgICAgICAgICAgIHZhciByZW1vdGVDYXBhYmlsaXRpZXMgPSB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IG1lZGlhU2VjdGlvbi5zcGxpdCgnXG4nLCAxKVswXQogICAgICAgICAgICAgICAgICAuc3BsaXQoJyAnLCAyKVsxXSA9PT0gJzAnOwoKICAgICAgICAgICAgICBpZiAoIXJlamVjdGVkICYmICF0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSWNlUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldEljZVBhcmFtZXRlcnMoCiAgICAgICAgICAgICAgICAgICAgbWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCk7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnMgPSBTRFBVdGlscy5nZXREdGxzUGFyYW1ldGVycygKICAgICAgICAgICAgICAgICAgICBtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICAgIGlmIChpc0ljZUxpdGUpIHsKICAgICAgICAgICAgICAgICAgcmVtb3RlRHRsc1BhcmFtZXRlcnMucm9sZSA9ICdzZXJ2ZXInOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydC5zdGFydChpY2VHYXRoZXJlciwgcmVtb3RlSWNlUGFyYW1ldGVycywKICAgICAgICAgICAgICAgICAgICAgIGlzSWNlTGl0ZSA/ICdjb250cm9sbGluZycgOiAnY29udHJvbGxlZCcpOwogICAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgaW50ZXJzZWN0aW9uIG9mIGNhcGFiaWxpdGllcy4KICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSBzZWxmLl9nZXRDb21tb25DYXBhYmlsaXRpZXMobG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgICAgICAgICAgcmVtb3RlQ2FwYWJpbGl0aWVzKTsKCiAgICAgICAgICAgICAgICAvLyBTdGFydCB0aGUgUlRDUnRwU2VuZGVyLiBUaGUgUlRDUnRwUmVjZWl2ZXIgZm9yIHRoaXMKICAgICAgICAgICAgICAgIC8vIHRyYW5zY2VpdmVyIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBpbiBzZXRSZW1vdGVEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmNvZGVjcy5sZW5ndGggPiAwLAogICAgICAgICAgICAgICAgICAgIGZhbHNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMubG9jYWxEZXNjcmlwdGlvbiA9IHsKICAgICAgICAgICAgdHlwZTogZGVzY3JpcHRpb24udHlwZSwKICAgICAgICAgICAgc2RwOiBkZXNjcmlwdGlvbi5zZHAKICAgICAgICAgIH07CiAgICAgICAgICBzd2l0Y2ggKGRlc2NyaXB0aW9uLnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAnb2ZmZXInOgogICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdoYXZlLWxvY2FsLW9mZmVyJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2Fuc3dlcic6CiAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ3N0YWJsZScpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3Vuc3VwcG9ydGVkIHR5cGUgIicgKyBkZXNjcmlwdGlvbi50eXBlICsKICAgICAgICAgICAgICAgICAgJyInKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBJZiBhIHN1Y2Nlc3MgY2FsbGJhY2sgd2FzIHByb3ZpZGVkLCBlbWl0IElDRSBjYW5kaWRhdGVzIGFmdGVyIGl0CiAgICAgICAgICAvLyBoYXMgYmVlbiBleGVjdXRlZC4gT3RoZXJ3aXNlLCBlbWl0IGNhbGxiYWNrIGFmdGVyIHRoZSBQcm9taXNlIGlzCiAgICAgICAgICAvLyByZXNvbHZlZC4KICAgICAgICAgIHZhciBoYXNDYWxsYmFjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmCiAgICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbic7CiAgICAgICAgICBpZiAoaGFzQ2FsbGJhY2spIHsKICAgICAgICAgICAgdmFyIGNiID0gYXJndW1lbnRzWzFdOwogICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICBjYigpOwogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBzZWxmLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzKCk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHAgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICAgIHAudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgaWYgKCFoYXNDYWxsYmFjaykgewogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBVc3VhbGx5IGNhbmRpZGF0ZXMgd2lsbCBiZSBlbWl0dGVkIGVhcmxpZXIuCiAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoc2VsZi5fZW1pdEJ1ZmZlcmVkQ2FuZGlkYXRlcy5iaW5kKHNlbGYpLCA1MDApOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBwOwogICAgICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbiA9CiAgICAgICAgZnVuY3Rpb24oZGVzY3JpcHRpb24pIHsKICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgIHZhciBzdHJlYW0gPSBuZXcgTWVkaWFTdHJlYW0oKTsKICAgICAgICAgIHZhciByZWNlaXZlckxpc3QgPSBbXTsKICAgICAgICAgIHZhciBzZWN0aW9ucyA9IFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMoZGVzY3JpcHRpb24uc2RwKTsKICAgICAgICAgIHZhciBzZXNzaW9ucGFydCA9IHNlY3Rpb25zLnNoaWZ0KCk7CiAgICAgICAgICB2YXIgaXNJY2VMaXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoc2Vzc2lvbnBhcnQsCiAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgdGhpcy51c2luZ0J1bmRsZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICdhPWdyb3VwOkJVTkRMRSAnKS5sZW5ndGggPiAwOwogICAgICAgICAgc2VjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNkcE1MaW5lSW5kZXgpIHsKICAgICAgICAgICAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICB2YXIgbWxpbmUgPSBsaW5lc1swXS5zdWJzdHIoMikuc3BsaXQoJyAnKTsKICAgICAgICAgICAgdmFyIGtpbmQgPSBtbGluZVswXTsKICAgICAgICAgICAgdmFyIHJlamVjdGVkID0gbWxpbmVbMV0gPT09ICcwJzsKICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IFNEUFV0aWxzLmdldERpcmVjdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKCiAgICAgICAgICAgIHZhciBtaWQgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPW1pZDonKTsKICAgICAgICAgICAgaWYgKG1pZC5sZW5ndGgpIHsKICAgICAgICAgICAgICBtaWQgPSBtaWRbMF0uc3Vic3RyKDYpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG1pZCA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBSZWplY3QgZGF0YWNoYW5uZWxzIHdoaWNoIGFyZSBub3QgaW1wbGVtZW50ZWQgeWV0LgogICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2FwcGxpY2F0aW9uJyAmJiBtbGluZVsyXSA9PT0gJ0RUTFMvU0NUUCcpIHsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIG1pZDogbWlkLAogICAgICAgICAgICAgICAgaXNEYXRhY2hhbm5lbDogdHJ1ZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgdHJhbnNjZWl2ZXI7CiAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlcjsKICAgICAgICAgICAgdmFyIGljZVRyYW5zcG9ydDsKICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQ7CiAgICAgICAgICAgIHZhciBydHBTZW5kZXI7CiAgICAgICAgICAgIHZhciBydHBSZWNlaXZlcjsKICAgICAgICAgICAgdmFyIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgICAgIHZhciByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICB2YXIgdHJhY2s7CiAgICAgICAgICAgIC8vIEZJWE1FOiBlbnN1cmUgdGhlIG1lZGlhU2VjdGlvbiBoYXMgcnRjcC1tdXggc2V0LgogICAgICAgICAgICB2YXIgcmVtb3RlQ2FwYWJpbGl0aWVzID0gU0RQVXRpbHMucGFyc2VSdHBQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CiAgICAgICAgICAgIHZhciByZW1vdGVJY2VQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnM7CiAgICAgICAgICAgIGlmICghcmVqZWN0ZWQpIHsKICAgICAgICAgICAgICByZW1vdGVJY2VQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0SWNlUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24sCiAgICAgICAgICAgICAgICAgIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICByZW1vdGVEdGxzUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbiwKICAgICAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQpOwogICAgICAgICAgICAgIHJlbW90ZUR0bHNQYXJhbWV0ZXJzLnJvbGUgPSAnY2xpZW50JzsKICAgICAgICAgICAgfQogICAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgIFNEUFV0aWxzLnBhcnNlUnRwRW5jb2RpbmdQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CgogICAgICAgICAgICB2YXIgY25hbWU7CiAgICAgICAgICAgIC8vIEdldHMgdGhlIGZpcnN0IFNTUkMuIE5vdGUgdGhhdCB3aXRoIFJUWCB0aGVyZSBtaWdodCBiZSBtdWx0aXBsZQogICAgICAgICAgICAvLyBTU1JDcy4KICAgICAgICAgICAgdmFyIHJlbW90ZVNzcmMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNzcmM6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24obGluZSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihvYmopIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iai5hdHRyaWJ1dGUgPT09ICdjbmFtZSc7CiAgICAgICAgICAgICAgICB9KVswXTsKICAgICAgICAgICAgaWYgKHJlbW90ZVNzcmMpIHsKICAgICAgICAgICAgICBjbmFtZSA9IHJlbW90ZVNzcmMudmFsdWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBpc0NvbXBsZXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLAogICAgICAgICAgICAgICAgJ2E9ZW5kLW9mLWNhbmRpZGF0ZXMnLCBzZXNzaW9ucGFydCkubGVuZ3RoID4gMDsKICAgICAgICAgICAgdmFyIGNhbmRzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1jYW5kaWRhdGU6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24oY2FuZCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUoY2FuZCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihjYW5kKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBjYW5kLmNvbXBvbmVudCA9PT0gJzEnOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInICYmICFyZWplY3RlZCkgewogICAgICAgICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiBzZWxmLnRyYW5zY2VpdmVyc1swXS5pY2VHYXRoZXJlciwKICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uaWNlVHJhbnNwb3J0LAogICAgICAgICAgICAgICAgZHRsc1RyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICAgICAgICBpZiAoaXNDb21wbGV0ZSAmJiAoIXNlbGYudXNpbmdCdW5kbGUgfHwgc2RwTUxpbmVJbmRleCA9PT0gMCkpIHsKICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuaWNlVHJhbnNwb3J0LnNldFJlbW90ZUNhbmRpZGF0ZXMoY2FuZHMpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBSZWNlaXZlci5nZXRDYXBhYmlsaXRpZXMoa2luZCk7CgogICAgICAgICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMgPSBbewogICAgICAgICAgICAgICAgc3NyYzogKDIgKiBzZHBNTGluZUluZGV4ICsgMikgKiAxMDAxCiAgICAgICAgICAgICAgfV07CgogICAgICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CgogICAgICAgICAgICAgIHRyYWNrID0gcnRwUmVjZWl2ZXIudHJhY2s7CiAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgIC8vIEZJWE1FOiBub3QgY29ycmVjdCB3aGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBzdHJlYW1zIGJ1dCB0aGF0IGlzCiAgICAgICAgICAgICAgLy8gbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgaW4gdGhpcyBzaGltLgogICAgICAgICAgICAgIHN0cmVhbS5hZGRUcmFjayh0cmFjayk7CgogICAgICAgICAgICAgIC8vIEZJWE1FOiBsb29rIGF0IGRpcmVjdGlvbi4KICAgICAgICAgICAgICBpZiAoc2VsZi5sb2NhbFN0cmVhbXMubGVuZ3RoID4gMCAmJgogICAgICAgICAgICAgICAgICBzZWxmLmxvY2FsU3RyZWFtc1swXS5nZXRUcmFja3MoKS5sZW5ndGggPj0gc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgICAgdmFyIGxvY2FsVHJhY2s7CiAgICAgICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0QXVkaW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2luZCA9PT0gJ3ZpZGVvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0VmlkZW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChsb2NhbFRyYWNrKSB7CiAgICAgICAgICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIobG9jYWxUcmFjaywKICAgICAgICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc3BvcnRzLmljZUdhdGhlcmVyLAogICAgICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmljZVRyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzOiBsb2NhbENhcGFiaWxpdGllcywKICAgICAgICAgICAgICAgIHJlbW90ZUNhcGFiaWxpdGllczogcmVtb3RlQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAgICAgcnRwU2VuZGVyOiBydHBTZW5kZXIsCiAgICAgICAgICAgICAgICBydHBSZWNlaXZlcjogcnRwUmVjZWl2ZXIsCiAgICAgICAgICAgICAgICBraW5kOiBraW5kLAogICAgICAgICAgICAgICAgbWlkOiBtaWQsCiAgICAgICAgICAgICAgICBjbmFtZTogY25hbWUsCiAgICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzOiBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzLAogICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczogcmVjdkVuY29kaW5nUGFyYW1ldGVycwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgLy8gU3RhcnQgdGhlIFJUQ1J0cFJlY2VpdmVyIG5vdy4gVGhlIFJUUFNlbmRlciBpcyBzdGFydGVkIGluCiAgICAgICAgICAgICAgLy8gc2V0TG9jYWxEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICBzZWxmLl90cmFuc2NlaXZlKHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLAogICAgICAgICAgICAgICAgICBmYWxzZSwKICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uID09PSAnc2VuZHJlY3YnIHx8IGRpcmVjdGlvbiA9PT0gJ3NlbmRvbmx5Jyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ2Fuc3dlcicgJiYgIXJlamVjdGVkKSB7CiAgICAgICAgICAgICAgdHJhbnNjZWl2ZXIgPSBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XTsKICAgICAgICAgICAgICBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIGljZVRyYW5zcG9ydCA9IHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydDsKICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0ID0gdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydDsKICAgICAgICAgICAgICBydHBTZW5kZXIgPSB0cmFuc2NlaXZlci5ydHBTZW5kZXI7CiAgICAgICAgICAgICAgcnRwUmVjZWl2ZXIgPSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzID0gdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZW1vdGVDYXBhYmlsaXRpZXMgPQogICAgICAgICAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM7CiAgICAgICAgICAgICAgc2VsZi50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uY25hbWUgPSBjbmFtZTsKCiAgICAgICAgICAgICAgaWYgKChpc0ljZUxpdGUgfHwgaXNDb21wbGV0ZSkgJiYgY2FuZHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc2V0UmVtb3RlQ2FuZGlkYXRlcyhjYW5kcyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc3RhcnQoaWNlR2F0aGVyZXIsIHJlbW90ZUljZVBhcmFtZXRlcnMsCiAgICAgICAgICAgICAgICAgICAgJ2NvbnRyb2xsaW5nJyk7CiAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdyZWN2b25seScsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpOwoKICAgICAgICAgICAgICBpZiAocnRwUmVjZWl2ZXIgJiYKICAgICAgICAgICAgICAgICAgKGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpKSB7CiAgICAgICAgICAgICAgICB0cmFjayA9IHJ0cFJlY2VpdmVyLnRyYWNrOwogICAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgICAgc3RyZWFtLmFkZFRyYWNrKHRyYWNrKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFjdHVhbGx5IHRoZSByZWNlaXZlciBzaG91bGQgYmUgY3JlYXRlZCBsYXRlci4KICAgICAgICAgICAgICAgIGRlbGV0ZSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIHRoaXMucmVtb3RlRGVzY3JpcHRpb24gPSB7CiAgICAgICAgICAgIHR5cGU6IGRlc2NyaXB0aW9uLnR5cGUsCiAgICAgICAgICAgIHNkcDogZGVzY3JpcHRpb24uc2RwCiAgICAgICAgICB9OwogICAgICAgICAgc3dpdGNoIChkZXNjcmlwdGlvbi50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgJ29mZmVyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnaGF2ZS1yZW1vdGUtb2ZmZXInKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnYW5zd2VyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnc3RhYmxlJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigndW5zdXBwb3J0ZWQgdHlwZSAiJyArIGRlc2NyaXB0aW9uLnR5cGUgKwogICAgICAgICAgICAgICAgICAnIicpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHN0cmVhbS5nZXRUcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgICAgc2VsZi5yZW1vdGVTdHJlYW1zLnB1c2goc3RyZWFtKTsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdhZGRzdHJlYW0nKTsKICAgICAgICAgICAgICBldmVudC5zdHJlYW0gPSBzdHJlYW07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgICBpZiAoc2VsZi5vbmFkZHN0cmVhbSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYub25hZGRzdHJlYW0oZXZlbnQpOwogICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZWNlaXZlckxpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CiAgICAgICAgICAgICAgICB2YXIgdHJhY2sgPSBpdGVtWzBdOwogICAgICAgICAgICAgICAgdmFyIHJlY2VpdmVyID0gaXRlbVsxXTsKICAgICAgICAgICAgICAgIHZhciB0cmFja0V2ZW50ID0gbmV3IEV2ZW50KCd0cmFjaycpOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5yZWNlaXZlciA9IHJlY2VpdmVyOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5zdHJlYW1zID0gW3N0cmVhbV07CiAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQodHJhY2tFdmVudCk7CiAgICAgICAgICAgICAgICBpZiAoc2VsZi5vbnRyYWNrICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHNlbGYub250cmFjayh0cmFja0V2ZW50KTsKICAgICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoYXJndW1lbnRzWzFdLCAwKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIC8qIG5vdCB5ZXQKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgICovCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCkgewogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0b3AoKTsKICAgICAgICB9CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBGSVhNRTogY2xlYW4gdXAgdHJhY2tzLCBsb2NhbCBzdHJlYW1zLCByZW1vdGUgc3RyZWFtcywgZXRjCiAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdjbG9zZWQnKTsKICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBzaWduYWxpbmcgc3RhdGUuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl91cGRhdGVTaWduYWxpbmdTdGF0ZSA9CiAgICAgICAgZnVuY3Rpb24obmV3U3RhdGUpIHsKICAgICAgICAgIHRoaXMuc2lnbmFsaW5nU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnc2lnbmFsaW5nc3RhdGVjaGFuZ2UnKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICBpZiAodGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHRoaXMub25zaWduYWxpbmdzdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAvLyBEZXRlcm1pbmUgd2hldGhlciB0byBmaXJlIHRoZSBuZWdvdGlhdGlvbm5lZWRlZCBldmVudC4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX21heWJlRmlyZU5lZ290aWF0aW9uTmVlZGVkID0KICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgIC8vIEZpcmUgYXdheSAoZm9yIG5vdykuCiAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ25lZ290aWF0aW9ubmVlZGVkJyk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgICAgaWYgKHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCAhPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLm9ubmVnb3RpYXRpb25uZWVkZWQoZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBjb25uZWN0aW9uIHN0YXRlLgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fdXBkYXRlQ29ubmVjdGlvblN0YXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIG5ld1N0YXRlOwogICAgICB2YXIgc3RhdGVzID0gewogICAgICAgICduZXcnOiAwLAogICAgICAgIGNsb3NlZDogMCwKICAgICAgICBjb25uZWN0aW5nOiAwLAogICAgICAgIGNoZWNraW5nOiAwLAogICAgICAgIGNvbm5lY3RlZDogMCwKICAgICAgICBjb21wbGV0ZWQ6IDAsCiAgICAgICAgZmFpbGVkOiAwCiAgICAgIH07CiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICBzdGF0ZXNbdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICAgIHN0YXRlc1t0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICB9KTsKICAgICAgLy8gSUNFVHJhbnNwb3J0LmNvbXBsZXRlZCBhbmQgY29ubmVjdGVkIGFyZSB0aGUgc2FtZSBmb3IgdGhpcyBwdXJwb3NlLgogICAgICBzdGF0ZXMuY29ubmVjdGVkICs9IHN0YXRlcy5jb21wbGV0ZWQ7CgogICAgICBuZXdTdGF0ZSA9ICduZXcnOwogICAgICBpZiAoc3RhdGVzLmZhaWxlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdmYWlsZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5jb25uZWN0aW5nID4gMCB8fCBzdGF0ZXMuY2hlY2tpbmcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnY29ubmVjdGluZyc7CiAgICAgIH0gZWxzZSBpZiAoc3RhdGVzLmRpc2Nvbm5lY3RlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdkaXNjb25uZWN0ZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5uZXcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnbmV3JzsKICAgICAgfSBlbHNlIGlmIChzdGF0ZXMuY29ubmVjdGVkID4gMCB8fCBzdGF0ZXMuY29tcGxldGVkID4gMCkgewogICAgICAgIG5ld1N0YXRlID0gJ2Nvbm5lY3RlZCc7CiAgICAgIH0KCiAgICAgIGlmIChuZXdTdGF0ZSAhPT0gc2VsZi5pY2VDb25uZWN0aW9uU3RhdGUpIHsKICAgICAgICBzZWxmLmljZUNvbm5lY3Rpb25TdGF0ZSA9IG5ld1N0YXRlOwogICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlJyk7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICBpZiAodGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSAhPT0gbnVsbCkgewogICAgICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY3JlYXRlT2ZmZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAodGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjcmVhdGVPZmZlciBjYWxsZWQgd2hpbGUgdGhlcmUgaXMgYSBwZW5kaW5nIG9mZmVyLicpOwogICAgICB9CiAgICAgIHZhciBvZmZlck9wdGlvbnM7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpIHsKICAgICAgICBvZmZlck9wdGlvbnMgPSBhcmd1bWVudHNbMF07CiAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykgewogICAgICAgIG9mZmVyT3B0aW9ucyA9IGFyZ3VtZW50c1syXTsKICAgICAgfQoKICAgICAgdmFyIHRyYWNrcyA9IFtdOwogICAgICB2YXIgbnVtQXVkaW9UcmFja3MgPSAwOwogICAgICB2YXIgbnVtVmlkZW9UcmFja3MgPSAwOwogICAgICAvLyBEZWZhdWx0IHRvIHNlbmRyZWN2LgogICAgICBpZiAodGhpcy5sb2NhbFN0cmVhbXMubGVuZ3RoKSB7CiAgICAgICAgbnVtQXVkaW9UcmFja3MgPSB0aGlzLmxvY2FsU3RyZWFtc1swXS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aDsKICAgICAgICBudW1WaWRlb1RyYWNrcyA9IHRoaXMubG9jYWxTdHJlYW1zWzBdLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoOwogICAgICB9CiAgICAgIC8vIERldGVybWluZSBudW1iZXIgb2YgYXVkaW8gYW5kIHZpZGVvIHRyYWNrcyB3ZSBuZWVkIHRvIHNlbmQvcmVjdi4KICAgICAgaWYgKG9mZmVyT3B0aW9ucykgewogICAgICAgIC8vIFJlamVjdCBDaHJvbWUgbGVnYWN5IGNvbnN0cmFpbnRzLgogICAgICAgIGlmIChvZmZlck9wdGlvbnMubWFuZGF0b3J5IHx8IG9mZmVyT3B0aW9ucy5vcHRpb25hbCkgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigKICAgICAgICAgICAgICAnTGVnYWN5IG1hbmRhdG9yeS9vcHRpb25hbCBjb25zdHJhaW50cyBub3Qgc3VwcG9ydGVkLicpOwogICAgICAgIH0KICAgICAgICBpZiAob2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgbnVtQXVkaW9UcmFja3MgPSBvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbzsKICAgICAgICB9CiAgICAgICAgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzID0gb2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlVmlkZW87CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmxvY2FsU3RyZWFtcy5sZW5ndGgpIHsKICAgICAgICAvLyBQdXNoIGxvY2FsIHN0cmVhbXMuCiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXNbMF0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiB0cmFjay5raW5kLAogICAgICAgICAgICB0cmFjazogdHJhY2ssCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cmFjay5raW5kID09PSAnYXVkaW8nID8KICAgICAgICAgICAgICAgIG51bUF1ZGlvVHJhY2tzID4gMCA6IG51bVZpZGVvVHJhY2tzID4gMAogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAodHJhY2sua2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgICAgfSBlbHNlIGlmICh0cmFjay5raW5kID09PSAndmlkZW8nKSB7CiAgICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgLy8gQ3JlYXRlIE0tbGluZXMgZm9yIHJlY3Zvbmx5IHN0cmVhbXMuCiAgICAgIHdoaWxlIChudW1BdWRpb1RyYWNrcyA+IDAgfHwgbnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgaWYgKG51bUF1ZGlvVHJhY2tzID4gMCkgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiAnYXVkaW8nLAogICAgICAgICAgICB3YW50UmVjZWl2ZTogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgIH0KICAgICAgICBpZiAobnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgICB0cmFja3MucHVzaCh7CiAgICAgICAgICAgIGtpbmQ6ICd2aWRlbycsCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUoKTsKICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IFtdOwogICAgICB0cmFja3MuZm9yRWFjaChmdW5jdGlvbihtbGluZSwgc2RwTUxpbmVJbmRleCkgewogICAgICAgIC8vIEZvciBlYWNoIHRyYWNrLCBjcmVhdGUgYW4gaWNlIGdhdGhlcmVyLCBpY2UgdHJhbnNwb3J0LAogICAgICAgIC8vIGR0bHMgdHJhbnNwb3J0LCBwb3RlbnRpYWxseSBydHBzZW5kZXIgYW5kIHJ0cHJlY2VpdmVyLgogICAgICAgIHZhciB0cmFjayA9IG1saW5lLnRyYWNrOwogICAgICAgIHZhciBraW5kID0gbWxpbmUua2luZDsKICAgICAgICB2YXIgbWlkID0gU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyKCk7CgogICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc2NlaXZlcnNbMF0uaWNlR2F0aGVyZXIsCiAgICAgICAgICBpY2VUcmFuc3BvcnQ6IHRyYW5zY2VpdmVyc1swXS5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBTZW5kZXIuZ2V0Q2FwYWJpbGl0aWVzKGtpbmQpOwogICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgfSk7CiAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgICAgICAgIC8vIHdvcmsgYXJvdW5kIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD02NTUyCiAgICAgICAgICAvLyBieSBhZGRpbmcgbGV2ZWwtYXN5bW1ldHJ5LWFsbG93ZWQ9MQogICAgICAgICAgaWYgKGNvZGVjLm5hbWUgPT09ICdIMjY0JyAmJgogICAgICAgICAgICAgIGNvZGVjLnBhcmFtZXRlcnNbJ2xldmVsLWFzeW1tZXRyeS1hbGxvd2VkJ10gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb2RlYy5wYXJhbWV0ZXJzWydsZXZlbC1hc3ltbWV0cnktYWxsb3dlZCddID0gJzEnOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICB2YXIgcnRwU2VuZGVyOwogICAgICAgIHZhciBydHBSZWNlaXZlcjsKCiAgICAgICAgLy8gZ2VuZXJhdGUgYW4gc3NyYyBub3csIHRvIGJlIHVzZWQgbGF0ZXIgaW4gcnRwU2VuZGVyLnNlbmQKICAgICAgICB2YXIgc2VuZEVuY29kaW5nUGFyYW1ldGVycyA9IFt7CiAgICAgICAgICBzc3JjOiAoMiAqIHNkcE1MaW5lSW5kZXggKyAxKSAqIDEwMDEKICAgICAgICB9XTsKICAgICAgICBpZiAodHJhY2spIHsKICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIodHJhY2ssIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgfQoKICAgICAgICBpZiAobWxpbmUud2FudFJlY2VpdmUpIHsKICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CiAgICAgICAgfQoKICAgICAgICB0cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0gPSB7CiAgICAgICAgICBpY2VHYXRoZXJlcjogdHJhbnNwb3J0cy5pY2VHYXRoZXJlciwKICAgICAgICAgIGljZVRyYW5zcG9ydDogdHJhbnNwb3J0cy5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmR0bHNUcmFuc3BvcnQsCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllczogbG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM6IG51bGwsCiAgICAgICAgICBydHBTZW5kZXI6IHJ0cFNlbmRlciwKICAgICAgICAgIHJ0cFJlY2VpdmVyOiBydHBSZWNlaXZlciwKICAgICAgICAgIGtpbmQ6IGtpbmQsCiAgICAgICAgICBtaWQ6IG1pZCwKICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM6IHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMsCiAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOiBudWxsCiAgICAgICAgfTsKICAgICAgfSk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdHJhbnNjZWl2ZXJzLm1hcChmdW5jdGlvbih0KSB7CiAgICAgICAgICByZXR1cm4gdC5taWQ7CiAgICAgICAgfSkuam9pbignICcpICsgJ1xyXG4nOwogICAgICB9CiAgICAgIHRyYWNrcy5mb3JFYWNoKGZ1bmN0aW9uKG1saW5lLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgdmFyIHRyYW5zY2VpdmVyID0gdHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsICdvZmZlcicsIHNlbGYubG9jYWxTdHJlYW1zWzBdKTsKICAgICAgfSk7CgogICAgICB0aGlzLl9wZW5kaW5nT2ZmZXIgPSB0cmFuc2NlaXZlcnM7CiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ29mZmVyJywKICAgICAgICBzZHA6IHNkcAogICAgICB9KTsKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGFyZ3VtZW50c1swXSwgMCwgZGVzYyk7CiAgICAgIH0KICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZXNjKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVBbnN3ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlU2Vzc2lvbkJvaWxlcnBsYXRlKCk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdGhpcy50cmFuc2NlaXZlcnMubWFwKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgIHJldHVybiB0Lm1pZDsKICAgICAgICB9KS5qb2luKCcgJykgKyAnXHJcbic7CiAgICAgIH0KICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIGlmICh0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICBzZHAgKz0gJ209YXBwbGljYXRpb24gMCBEVExTL1NDVFAgNTAwMFxyXG4nICsKICAgICAgICAgICAgICAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nICsKICAgICAgICAgICAgICAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gQ2FsY3VsYXRlIGludGVyc2VjdGlvbiBvZiBjYXBhYmlsaXRpZXMuCiAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHNlbGYuX2dldENvbW1vbkNhcGFiaWxpdGllcygKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgIHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcyk7CgogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwgY29tbW9uQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAnYW5zd2VyJywgc2VsZi5sb2NhbFN0cmVhbXNbMF0pOwogICAgICB9KTsKCiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ2Fuc3dlcicsCiAgICAgICAgc2RwOiBzZHAKICAgICAgfSk7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMF0sIDAsIGRlc2MpOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGVzYyk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oY2FuZGlkYXRlKSB7CiAgICAgIGlmICghY2FuZGlkYXRlKSB7CiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnRyYW5zY2VpdmVycy5sZW5ndGg7IGorKykgewogICAgICAgICAgdGhpcy50cmFuc2NlaXZlcnNbal0uaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZSh7fSk7CiAgICAgICAgICBpZiAodGhpcy51c2luZ0J1bmRsZSkgewogICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBtTGluZUluZGV4ID0gY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXg7CiAgICAgICAgaWYgKGNhbmRpZGF0ZS5zZHBNaWQpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFuc2NlaXZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNjZWl2ZXJzW2ldLm1pZCA9PT0gY2FuZGlkYXRlLnNkcE1pZCkgewogICAgICAgICAgICAgIG1MaW5lSW5kZXggPSBpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHRoaXMudHJhbnNjZWl2ZXJzW21MaW5lSW5kZXhdOwogICAgICAgIGlmICh0cmFuc2NlaXZlcikgewogICAgICAgICAgdmFyIGNhbmQgPSBPYmplY3Qua2V5cyhjYW5kaWRhdGUuY2FuZGlkYXRlKS5sZW5ndGggPiAwID8KICAgICAgICAgICAgICBTRFBVdGlscy5wYXJzZUNhbmRpZGF0ZShjYW5kaWRhdGUuY2FuZGlkYXRlKSA6IHt9OwogICAgICAgICAgLy8gSWdub3JlIENocm9tZSdzIGludmFsaWQgY2FuZGlkYXRlcyBzaW5jZSBFZGdlIGRvZXMgbm90IGxpa2UgdGhlbS4KICAgICAgICAgIGlmIChjYW5kLnByb3RvY29sID09PSAndGNwJyAmJiAoY2FuZC5wb3J0ID09PSAwIHx8IGNhbmQucG9ydCA9PT0gOSkpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgLy8gSWdub3JlIFJUQ1AgY2FuZGlkYXRlcywgd2UgYXNzdW1lIFJUQ1AtTVVYLgogICAgICAgICAgaWYgKGNhbmQuY29tcG9uZW50ICE9PSAnMScpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZShjYW5kKTsKCiAgICAgICAgICAvLyB1cGRhdGUgdGhlIHJlbW90ZURlc2NyaXB0aW9uLgogICAgICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyh0aGlzLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICBzZWN0aW9uc1ttTGluZUluZGV4ICsgMV0gKz0gKGNhbmQudHlwZSA/IGNhbmRpZGF0ZS5jYW5kaWRhdGUudHJpbSgpCiAgICAgICAgICAgICAgOiAnYT1lbmQtb2YtY2FuZGlkYXRlcycpICsgJ1xyXG4nOwogICAgICAgICAgdGhpcy5yZW1vdGVEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMV0sIDApOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcHJvbWlzZXMgPSBbXTsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIFsncnRwU2VuZGVyJywgJ3J0cFJlY2VpdmVyJywgJ2ljZUdhdGhlcmVyJywgJ2ljZVRyYW5zcG9ydCcsCiAgICAgICAgICAgICdkdGxzVHJhbnNwb3J0J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgICBpZiAodHJhbnNjZWl2ZXJbbWV0aG9kXSkgewogICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0cmFuc2NlaXZlclttZXRob2RdLmdldFN0YXRzKCkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB2YXIgY2IgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnZnVuY3Rpb24nICYmCiAgICAgICAgICBhcmd1bWVudHNbMV07CiAgICAgIHZhciBmaXhTdGF0c1R5cGUgPSBmdW5jdGlvbihzdGF0KSB7CiAgICAgICAgc3RhdC50eXBlID0gewogICAgICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgICAgIG91dGJvdW5kcnRwOiAnb3V0Ym91bmQtcnRwJywKICAgICAgICAgIGNhbmRpZGF0ZXBhaXI6ICdjYW5kaWRhdGUtcGFpcicsCiAgICAgICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgIH1bc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgcmV0dXJuIHN0YXQ7CiAgICAgIH07CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICAgIHZhciByZXN1bHRzID0gbmV3IE1hcCgpOwogICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKHJlcykgewogICAgICAgICAgcmVzLmZvckVhY2goZnVuY3Rpb24ocmVzdWx0KSB7CiAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlc3VsdCkuZm9yRWFjaChmdW5jdGlvbihpZCkgewogICAgICAgICAgICAgIHJlc3VsdFtpZF0udHlwZSA9IGZpeFN0YXRzVHlwZShyZXN1bHRbaWRdKTsKICAgICAgICAgICAgICByZXN1bHRzLnNldChpZCwgcmVzdWx0W2lkXSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoY2IpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoY2IsIDAsIHJlc3VsdHMpOwogICAgICAgICAgfQogICAgICAgICAgcmVzb2x2ZShyZXN1bHRzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KfTsKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbVBlZXJDb25uZWN0aW9uOiBlZGdlU2hpbS5zaGltUGVlckNvbm5lY3Rpb24sCiAgc2hpbUdldFVzZXJNZWRpYTogcmVxdWlyZSgnLi9nZXR1c2VybWVkaWEnKQp9OwoKfSx7Ii4uL3V0aWxzIjoxMSwiLi9nZXR1c2VybWVkaWEiOjcsInNkcCI6MX1dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7UGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJ31bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50LAogICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTsKICAgICAgfQogICAgfTsKICB9OwoKICAvLyBnZXRVc2VyTWVkaWEgZXJyb3Igc2hpbS4KICB2YXIgb3JpZ0dldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhLgogICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oYykgewogICAgcmV0dXJuIG9yaWdHZXRVc2VyTWVkaWEoYykuY2F0Y2goZnVuY3Rpb24oZSkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3Qoc2hpbUVycm9yXyhlKSk7CiAgICB9KTsKICB9Owp9OwoKfSx7fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgZmlyZWZveFNoaW0gPSB7CiAgc2hpbU9uVHJhY2s6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnICYmIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiAmJiAhKCdvbnRyYWNrJyBpbgogICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnb250cmFjaycsIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX29udHJhY2s7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKGYpIHsKICAgICAgICAgIGlmICh0aGlzLl9vbnRyYWNrKSB7CiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrKTsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgdGhpcy5fb250cmFjayA9IGYpOwogICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgZS5zdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTsKICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAoKICBzaGltU291cmNlT2JqZWN0OiBmdW5jdGlvbigpIHsKICAgIC8vIEZpcmVmb3ggaGFzIHN1cHBvcnRlZCBtb3pTcmNPYmplY3Qgc2luY2UgRkYyMiwgdW5wcmVmaXhlZCBpbiA0Mi4KICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgewogICAgICBpZiAod2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAhKCdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgICAvLyBTaGltIHRoZSBzcmNPYmplY3QgcHJvcGVydHksIG9uY2UsIHdoZW4gSFRNTE1lZGlhRWxlbWVudCBpcyBmb3VuZC4KICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLCAnc3JjT2JqZWN0JywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMubW96U3JjT2JqZWN0OwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgICAgIHRoaXMubW96U3JjT2JqZWN0ID0gc3RyZWFtOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAnb2JqZWN0JyB8fCAhKHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiB8fAogICAgICAgIHdpbmRvdy5tb3pSVENQZWVyQ29ubmVjdGlvbikpIHsKICAgICAgcmV0dXJuOyAvLyBwcm9iYWJseSBtZWRpYS5wZWVyY29ubmVjdGlvbi5lbmFibGVkPWZhbHNlIGluIGFib3V0OmNvbmZpZwogICAgfQogICAgLy8gVGhlIFJUQ1BlZXJDb25uZWN0aW9uIG9iamVjdC4KICAgIGlmICghd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uKSB7CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiA9IGZ1bmN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKSB7CiAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICAgICAgLy8gLnVybHMgaXMgbm90IHN1cHBvcnRlZCBpbiBGRiA8IDM4LgogICAgICAgICAgLy8gY3JlYXRlIFJUQ0ljZVNlcnZlcnMgd2l0aCBhIHNpbmdsZSB1cmwuCiAgICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlU2VydmVycykgewogICAgICAgICAgICB2YXIgbmV3SWNlU2VydmVycyA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBjQ29uZmlnLmljZVNlcnZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICB2YXIgc2VydmVyID0gcGNDb25maWcuaWNlU2VydmVyc1tpXTsKICAgICAgICAgICAgICBpZiAoc2VydmVyLmhhc093blByb3BlcnR5KCd1cmxzJykpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VydmVyLnVybHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgdmFyIG5ld1NlcnZlciA9IHsKICAgICAgICAgICAgICAgICAgICB1cmw6IHNlcnZlci51cmxzW2pdCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIGlmIChzZXJ2ZXIudXJsc1tqXS5pbmRleE9mKCd0dXJuJykgPT09IDApIHsKICAgICAgICAgICAgICAgICAgICBuZXdTZXJ2ZXIudXNlcm5hbWUgPSBzZXJ2ZXIudXNlcm5hbWU7CiAgICAgICAgICAgICAgICAgICAgbmV3U2VydmVyLmNyZWRlbnRpYWwgPSBzZXJ2ZXIuY3JlZGVudGlhbDsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBuZXdJY2VTZXJ2ZXJzLnB1c2gobmV3U2VydmVyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV3SWNlU2VydmVycy5wdXNoKHBjQ29uZmlnLmljZVNlcnZlcnNbaV0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBwY0NvbmZpZy5pY2VTZXJ2ZXJzID0gbmV3SWNlU2VydmVyczsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBtb3pSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSBtb3pSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CgogICAgICAvLyB3cmFwIHN0YXRpYyBtZXRob2RzLiBDdXJyZW50bHkganVzdCBnZW5lcmF0ZUNlcnRpZmljYXRlLgogICAgICBpZiAobW96UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24sICdnZW5lcmF0ZUNlcnRpZmljYXRlJywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIG1velJUQ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24gPSBtb3pSVENTZXNzaW9uRGVzY3JpcHRpb247CiAgICAgIHdpbmRvdy5SVENJY2VDYW5kaWRhdGUgPSBtb3pSVENJY2VDYW5kaWRhdGU7CiAgICB9CgogICAgLy8gc2hpbSBhd2F5IG5lZWQgZm9yIG9ic29sZXRlIFJUQ0ljZUNhbmRpZGF0ZS9SVENTZXNzaW9uRGVzY3JpcHRpb24uCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgdmFyIG1ha2VNYXBTdGF0cyA9IGZ1bmN0aW9uKHN0YXRzKSB7CiAgICAgIHZhciBtYXAgPSBuZXcgTWFwKCk7CiAgICAgIE9iamVjdC5rZXlzKHN0YXRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIG1hcC5zZXQoa2V5LCBzdGF0c1trZXldKTsKICAgICAgICBtYXBba2V5XSA9IHN0YXRzW2tleV07CiAgICAgIH0pOwogICAgICByZXR1cm4gbWFwOwogICAgfTsKCiAgICB2YXIgbW9kZXJuU3RhdHNUeXBlcyA9IHsKICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgb3V0Ym91bmRydHA6ICdvdXRib3VuZC1ydHAnLAogICAgICBjYW5kaWRhdGVwYWlyOiAnY2FuZGlkYXRlLXBhaXInLAogICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgIHJlbW90ZWNhbmRpZGF0ZTogJ3JlbW90ZS1jYW5kaWRhdGUnCiAgICB9OwoKICAgIHZhciBuYXRpdmVHZXRTdGF0cyA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0czsKICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBvblN1Y2MsIG9uRXJyKSB7CiAgICAgIHJldHVybiBuYXRpdmVHZXRTdGF0cy5hcHBseSh0aGlzLCBbc2VsZWN0b3IgfHwgbnVsbF0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNDgpIHsKICAgICAgICAgICAgc3RhdHMgPSBtYWtlTWFwU3RhdHMoc3RhdHMpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MyAmJiAhb25TdWNjKSB7CiAgICAgICAgICAgIC8vIFNoaW0gb25seSBwcm9taXNlIGdldFN0YXRzIHdpdGggc3BlYy1oeXBoZW5zIGluIHR5cGUgbmFtZXMKICAgICAgICAgICAgLy8gTGVhdmUgY2FsbGJhY2sgdmVyc2lvbiBhbG9uZTsgbWlzYyBvbGQgdXNlcyBvZiBmb3JFYWNoIGJlZm9yZSBNYXAKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBzdGF0cy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXQpIHsKICAgICAgICAgICAgICAgIHN0YXQudHlwZSA9IG1vZGVyblN0YXRzVHlwZXNbc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICBpZiAoZS5uYW1lICE9PSAnVHlwZUVycm9yJykgewogICAgICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gQXZvaWQgVHlwZUVycm9yOiAidHlwZSIgaXMgcmVhZC1vbmx5LCBpbiBvbGQgdmVyc2lvbnMuIDM0LTQzaXNoCiAgICAgICAgICAgICAgc3RhdHMuZm9yRWFjaChmdW5jdGlvbihzdGF0LCBpKSB7CiAgICAgICAgICAgICAgICBzdGF0cy5zZXQoaSwgT2JqZWN0LmFzc2lnbih7fSwgc3RhdCwgewogICAgICAgICAgICAgICAgICB0eXBlOiBtb2Rlcm5TdGF0c1R5cGVzW3N0YXQudHlwZV0gfHwgc3RhdC50eXBlCiAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBzdGF0czsKICAgICAgICB9KQogICAgICAgIC50aGVuKG9uU3VjYywgb25FcnIpOwogICAgfTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1PblRyYWNrOiBmaXJlZm94U2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBmaXJlZm94U2hpbS5zaGltU291cmNlT2JqZWN0LAogIHNoaW1QZWVyQ29ubmVjdGlvbjogZmlyZWZveFNoaW0uc2hpbVBlZXJDb25uZWN0aW9uLAogIHNoaW1HZXRVc2VyTWVkaWE6IHJlcXVpcmUoJy4vZ2V0dXNlcm1lZGlhJykKfTsKCn0seyIuLi91dGlscyI6MTEsIi4vZ2V0dXNlcm1lZGlhIjo5fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7CiAgICAgICAgU2VjdXJpdHlFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgUGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJwogICAgICB9W2UubmFtZV0gfHwgZS5uYW1lLAogICAgICBtZXNzYWdlOiB7CiAgICAgICAgJ1RoZSBvcGVyYXRpb24gaXMgaW5zZWN1cmUuJzogJ1RoZSByZXF1ZXN0IGlzIG5vdCBhbGxvd2VkIGJ5IHRoZSAnICsKICAgICAgICAndXNlciBhZ2VudCBvciB0aGUgcGxhdGZvcm0gaW4gdGhlIGN1cnJlbnQgY29udGV4dC4nCiAgICAgIH1bZS5tZXNzYWdlXSB8fCBlLm1lc3NhZ2UsCiAgICAgIGNvbnN0cmFpbnQ6IGUuY29uc3RyYWludCwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIC8vIGdldFVzZXJNZWRpYSBjb25zdHJhaW50cyBzaGltLgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgdmFyIGNvbnN0cmFpbnRzVG9GRjM3XyA9IGZ1bmN0aW9uKGMpIHsKICAgICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLnJlcXVpcmUpIHsKICAgICAgICByZXR1cm4gYzsKICAgICAgfQogICAgICB2YXIgcmVxdWlyZSA9IFtdOwogICAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIGlmIChrZXkgPT09ICdyZXF1aXJlJyB8fCBrZXkgPT09ICdhZHZhbmNlZCcgfHwga2V5ID09PSAnbWVkaWFTb3VyY2UnKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciByID0gY1trZXldID0gKHR5cGVvZiBjW2tleV0gPT09ICdvYmplY3QnKSA/CiAgICAgICAgICAgIGNba2V5XSA6IHtpZGVhbDogY1trZXldfTsKICAgICAgICBpZiAoci5taW4gIT09IHVuZGVmaW5lZCB8fAogICAgICAgICAgICByLm1heCAhPT0gdW5kZWZpbmVkIHx8IHIuZXhhY3QgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmVxdWlyZS5wdXNoKGtleSk7CiAgICAgICAgfQogICAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmICh0eXBlb2Ygci5leGFjdCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgci4gbWluID0gci5tYXggPSByLmV4YWN0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY1trZXldID0gci5leGFjdDsKICAgICAgICAgIH0KICAgICAgICAgIGRlbGV0ZSByLmV4YWN0OwogICAgICAgIH0KICAgICAgICBpZiAoci5pZGVhbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBjLmFkdmFuY2VkID0gYy5hZHZhbmNlZCB8fCBbXTsKICAgICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgICAgaWYgKHR5cGVvZiByLmlkZWFsID09PSAnbnVtYmVyJykgewogICAgICAgICAgICBvY1trZXldID0ge21pbjogci5pZGVhbCwgbWF4OiByLmlkZWFsfTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9jW2tleV0gPSByLmlkZWFsOwogICAgICAgICAgfQogICAgICAgICAgYy5hZHZhbmNlZC5wdXNoKG9jKTsKICAgICAgICAgIGRlbGV0ZSByLmlkZWFsOwogICAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhyKS5sZW5ndGgpIHsKICAgICAgICAgICAgZGVsZXRlIGNba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAocmVxdWlyZS5sZW5ndGgpIHsKICAgICAgICBjLnJlcXVpcmUgPSByZXF1aXJlOwogICAgICB9CiAgICAgIHJldHVybiBjOwogICAgfTsKICAgIGNvbnN0cmFpbnRzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICBsb2dnaW5nKCdzcGVjOiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgICAgaWYgKGNvbnN0cmFpbnRzLmF1ZGlvKSB7CiAgICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvRkYzN18oY29uc3RyYWludHMuYXVkaW8pOwogICAgICB9CiAgICAgIGlmIChjb25zdHJhaW50cy52aWRlbykgewogICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0ZGMzdfKGNvbnN0cmFpbnRzLnZpZGVvKTsKICAgICAgfQogICAgICBsb2dnaW5nKCdmZjM3OiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgIH0KICAgIHJldHVybiBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzLCBvblN1Y2Nlc3MsIGZ1bmN0aW9uKGUpIHsKICAgICAgb25FcnJvcihzaGltRXJyb3JfKGUpKTsKICAgIH0pOwogIH07CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGdldFVzZXJNZWRpYV8oY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICAvLyBTaGltIGZvciBtZWRpYURldmljZXMgb24gb2xkZXIgdmVyc2lvbnMuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKSB7CiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzID0ge2dldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKCkgeyB9LAogICAgICByZW1vdmVFdmVudExpc3RlbmVyOiBmdW5jdGlvbigpIHsgfQogICAgfTsKICB9CiAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzID0KICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzIHx8IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIgaW5mb3MgPSBbCiAgICAgICAgICAgIHtraW5kOiAnYXVkaW9pbnB1dCcsIGRldmljZUlkOiAnZGVmYXVsdCcsIGxhYmVsOiAnJywgZ3JvdXBJZDogJyd9LAogICAgICAgICAgICB7a2luZDogJ3ZpZGVvaW5wdXQnLCBkZXZpY2VJZDogJ2RlZmF1bHQnLCBsYWJlbDogJycsIGdyb3VwSWQ6ICcnfQogICAgICAgICAgXTsKICAgICAgICAgIHJlc29sdmUoaW5mb3MpOwogICAgICAgIH0pOwogICAgICB9OwoKICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDQxKSB7CiAgICAvLyBXb3JrIGFyb3VuZCBodHRwOi8vYnVnemlsLmxhLzExNjk2NjUKICAgIHZhciBvcmdFbnVtZXJhdGVEZXZpY2VzID0KICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMuYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gb3JnRW51bWVyYXRlRGV2aWNlcygpLnRoZW4odW5kZWZpbmVkLCBmdW5jdGlvbihlKSB7CiAgICAgICAgaWYgKGUubmFtZSA9PT0gJ05vdEZvdW5kRXJyb3InKSB7CiAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgfQogICAgICAgIHRocm93IGU7CiAgICAgIH0pOwogICAgfTsKICB9CiAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0OSkgewogICAgdmFyIG9yaWdHZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYS4KICAgICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjKSB7CiAgICAgIHJldHVybiBvcmlnR2V0VXNlck1lZGlhKGMpLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgLy8gV29yayBhcm91bmQgaHR0cHM6Ly9idWd6aWwubGEvODAyMzI2CiAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICBjLnZpZGVvICYmICFzdHJlYW0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7CiAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgIH0pOwogICAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignVGhlIG9iamVjdCBjYW4gbm90IGJlIGZvdW5kIGhlcmUuJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ05vdEZvdW5kRXJyb3InKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cmVhbTsKICAgICAgfSwgZnVuY3Rpb24oZSkgewogICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgfSk7CiAgICB9OwogIH0KICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0NCkgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhXyhjb25zdHJhaW50cywgb25TdWNjZXNzLCBvbkVycm9yKTsKICAgIH0KICAgIC8vIFJlcGxhY2UgRmlyZWZveCA0NCsncyBkZXByZWNhdGlvbiB3YXJuaW5nIHdpdGggdW5wcmVmaXhlZCB2ZXJzaW9uLgogICAgY29uc29sZS53YXJuKCduYXZpZ2F0b3IuZ2V0VXNlck1lZGlhIGhhcyBiZWVuIHJlcGxhY2VkIGJ5ICcgKwogICAgICAgICAgICAgICAgICduYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYScpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTsKICB9Owp9OwoKfSx7Ii4uL3V0aWxzIjoxMX1dLDEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLyoKICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICoKICogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlIGxpY2Vuc2UKICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZQogKiAgdHJlZS4KICovCid1c2Ugc3RyaWN0JzsKdmFyIHNhZmFyaVNoaW0gPSB7CiAgLy8gVE9ETzogRHJBbGV4LCBzaG91bGQgYmUgaGVyZSwgZG91YmxlIGNoZWNrIGFnYWluc3QgTGF5b3V0VGVzdHMKICAvLyBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7IH0sCgogIC8vIFRPRE86IG9uY2UgdGhlIGJhY2stZW5kIGZvciB0aGUgbWFjIHBvcnQgaXMgZG9uZSwgYWRkLgogIC8vIFRPRE86IGNoZWNrIGZvciB3ZWJraXRHVEsrCiAgLy8gc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsgfSwKCiAgc2hpbUdldFVzZXJNZWRpYTogZnVuY3Rpb24oKSB7CiAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1HZXRVc2VyTWVkaWE6IHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYQogIC8vIFRPRE8KICAvLyBzaGltT25UcmFjazogc2FmYXJpU2hpbS5zaGltT25UcmFjaywKICAvLyBzaGltUGVlckNvbm5lY3Rpb246IHNhZmFyaVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uCn07Cgp9LHt9XSwxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dEaXNhYmxlZF8gPSB0cnVlOwoKLy8gVXRpbGl0eSBtZXRob2RzLgp2YXIgdXRpbHMgPSB7CiAgZGlzYWJsZUxvZzogZnVuY3Rpb24oYm9vbCkgewogICAgaWYgKHR5cGVvZiBib29sICE9PSAnYm9vbGVhbicpIHsKICAgICAgcmV0dXJuIG5ldyBFcnJvcignQXJndW1lbnQgdHlwZTogJyArIHR5cGVvZiBib29sICsKICAgICAgICAgICcuIFBsZWFzZSB1c2UgYSBib29sZWFuLicpOwogICAgfQogICAgbG9nRGlzYWJsZWRfID0gYm9vbDsKICAgIHJldHVybiAoYm9vbCkgPyAnYWRhcHRlci5qcyBsb2dnaW5nIGRpc2FibGVkJyA6CiAgICAgICAgJ2FkYXB0ZXIuanMgbG9nZ2luZyBlbmFibGVkJzsKICB9LAoKICBsb2c6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSB7CiAgICAgIGlmIChsb2dEaXNhYmxlZF8pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5sb2cgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLyoqCiAgICogRXh0cmFjdCBicm93c2VyIHZlcnNpb24gb3V0IG9mIHRoZSBwcm92aWRlZCB1c2VyIGFnZW50IHN0cmluZy4KICAgKgogICAqIEBwYXJhbSB7IXN0cmluZ30gdWFzdHJpbmcgdXNlckFnZW50IHN0cmluZy4KICAgKiBAcGFyYW0geyFzdHJpbmd9IGV4cHIgUmVndWxhciBleHByZXNzaW9uIHVzZWQgYXMgbWF0Y2ggY3JpdGVyaWEuCiAgICogQHBhcmFtIHshbnVtYmVyfSBwb3MgcG9zaXRpb24gaW4gdGhlIHZlcnNpb24gc3RyaW5nIHRvIGJlIHJldHVybmVkLgogICAqIEByZXR1cm4geyFudW1iZXJ9IGJyb3dzZXIgdmVyc2lvbi4KICAgKi8KICBleHRyYWN0VmVyc2lvbjogZnVuY3Rpb24odWFzdHJpbmcsIGV4cHIsIHBvcykgewogICAgdmFyIG1hdGNoID0gdWFzdHJpbmcubWF0Y2goZXhwcik7CiAgICByZXR1cm4gbWF0Y2ggJiYgbWF0Y2gubGVuZ3RoID49IHBvcyAmJiBwYXJzZUludChtYXRjaFtwb3NdLCAxMCk7CiAgfSwKCiAgLyoqCiAgICogQnJvd3NlciBkZXRlY3Rvci4KICAgKgogICAqIEByZXR1cm4ge29iamVjdH0gcmVzdWx0IGNvbnRhaW5pbmcgYnJvd3NlciBhbmQgdmVyc2lvbgogICAqICAgICBwcm9wZXJ0aWVzLgogICAqLwogIGRldGVjdEJyb3dzZXI6IGZ1bmN0aW9uKCkgewogICAgLy8gUmV0dXJuZWQgcmVzdWx0IG9iamVjdC4KICAgIHZhciByZXN1bHQgPSB7fTsKICAgIHJlc3VsdC5icm93c2VyID0gbnVsbDsKICAgIHJlc3VsdC52ZXJzaW9uID0gbnVsbDsKCiAgICAvLyBGYWlsIGVhcmx5IGlmIGl0J3Mgbm90IGEgYnJvd3NlcgogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8ICF3aW5kb3cubmF2aWdhdG9yKSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIGJyb3dzZXIuJzsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvLyBGaXJlZm94LgogICAgaWYgKG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEpIHsKICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnZmlyZWZveCc7CiAgICAgIHJlc3VsdC52ZXJzaW9uID0gdGhpcy5leHRyYWN0VmVyc2lvbihuYXZpZ2F0b3IudXNlckFnZW50LAogICAgICAgICAgL0ZpcmVmb3hcLyhbMC05XSspXC4vLCAxKTsKCiAgICAvLyBhbGwgd2Via2l0LWJhc2VkIGJyb3dzZXJzCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEpIHsKICAgICAgLy8gQ2hyb21lLCBDaHJvbWl1bSwgV2VidmlldywgT3BlcmEsIGFsbCB1c2UgdGhlIGNocm9tZSBzaGltIGZvciBub3cKICAgICAgaWYgKHdpbmRvdy53ZWJraXRSVENQZWVyQ29ubmVjdGlvbikgewogICAgICAgIHJlc3VsdC5icm93c2VyID0gJ2Nocm9tZSc7CiAgICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvQ2hyb20oZXxpdW0pXC8oWzAtOV0rKVwuLywgMik7CgogICAgICAvLyBTYWZhcmkgb3IgdW5rbm93biB3ZWJraXQtYmFzZWQKICAgICAgLy8gZm9yIHRoZSB0aW1lIGJlaW5nIFNhZmFyaSBoYXMgc3VwcG9ydCBmb3IgTWVkaWFTdHJlYW1zIGJ1dCBub3Qgd2ViUlRDCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gU2FmYXJpIFVBIHN1YnN0cmluZ3Mgb2YgaW50ZXJlc3QgZm9yIHJlZmVyZW5jZToKICAgICAgICAvLyAtIHdlYmtpdCB2ZXJzaW9uOiAgICAgICAgICAgQXBwbGVXZWJLaXQvNjAyLjEuMjUgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLyAtIHNhZmFyaSBVSSB2ZXJzaW9uOiAgICAgICAgVmVyc2lvbi85LjAuMyAodW5pcXVlIHRvIFNhZmFyaSkKICAgICAgICAvLyAtIHNhZmFyaSBVSSB3ZWJraXQgdmVyc2lvbjogU2FmYXJpLzYwMS40LjQgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLwogICAgICAgIC8vIGlmIHRoZSB3ZWJraXQgdmVyc2lvbiBhbmQgc2FmYXJpIFVJIHdlYmtpdCB2ZXJzaW9ucyBhcmUgZXF1YWxzLAogICAgICAgIC8vIC4uLiB0aGlzIGlzIGEgc3RhYmxlIHZlcnNpb24uCiAgICAgICAgLy8KICAgICAgICAvLyBvbmx5IHRoZSBpbnRlcm5hbCB3ZWJraXQgdmVyc2lvbiBpcyBpbXBvcnRhbnQgdG9kYXkgdG8ga25vdyBpZgogICAgICAgIC8vIG1lZGlhIHN0cmVhbXMgYXJlIHN1cHBvcnRlZAogICAgICAgIC8vCiAgICAgICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1ZlcnNpb25cLyhcZCspLihcZCspLykpIHsKICAgICAgICAgIHJlc3VsdC5icm93c2VyID0gJ3NhZmFyaSc7CiAgICAgICAgICByZXN1bHQudmVyc2lvbiA9IHRoaXMuZXh0cmFjdFZlcnNpb24obmF2aWdhdG9yLnVzZXJBZ2VudCwKICAgICAgICAgICAgL0FwcGxlV2ViS2l0XC8oWzAtOV0rKVwuLywgMSk7CgogICAgICAgIC8vIHVua25vd24gd2Via2l0LWJhc2VkIGJyb3dzZXIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnVW5zdXBwb3J0ZWQgd2Via2l0LWJhc2VkIGJyb3dzZXIgJyArCiAgICAgICAgICAgICAgJ3dpdGggR1VNIHN1cHBvcnQgYnV0IG5vIFdlYlJUQyBzdXBwb3J0Lic7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgICAgfQoKICAgIC8vIEVkZ2UuCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMgJiYKICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9FZGdlXC8oXGQrKS4oXGQrKSQvKSkgewogICAgICByZXN1bHQuYnJvd3NlciA9ICdlZGdlJzsKICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvRWRnZVwvKFxkKykuKFxkKykkLywgMik7CgogICAgLy8gRGVmYXVsdCBmYWxsdGhyb3VnaDogbm90IHN1cHBvcnRlZC4KICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIHN1cHBvcnRlZCBicm93c2VyLic7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9LAoKICAvLyBzaGltQ3JlYXRlT2JqZWN0VVJMIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBzaGltU291cmNlT2JqZWN0IHRvIGF2b2lkIGxvb3AuCgogIHNoaW1DcmVhdGVPYmplY3RVUkw6IGZ1bmN0aW9uKCkgewogICAgaWYgKCEodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAgICdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgLy8gT25seSBzaGltIENyZWF0ZU9iamVjdFVSTCB1c2luZyBzcmNPYmplY3QgaWYgc3JjT2JqZWN0IGV4aXN0cy4KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICB2YXIgbmF0aXZlQ3JlYXRlT2JqZWN0VVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgbmF0aXZlUmV2b2tlT2JqZWN0VVJMID0gVVJMLnJldm9rZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgc3RyZWFtcyA9IG5ldyBNYXAoKSwgbmV3SWQgPSAwOwoKICAgIFVSTC5jcmVhdGVPYmplY3RVUkwgPSBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgaWYgKCdnZXRUcmFja3MnIGluIHN0cmVhbSkgewogICAgICAgIHZhciB1cmwgPSAncG9seWJsb2I6JyArICgrK25ld0lkKTsKICAgICAgICBzdHJlYW1zLnNldCh1cmwsIHN0cmVhbSk7CiAgICAgICAgY29uc29sZS5sb2coJ1VSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKSBpcyBkZXByZWNhdGVkISAnICsKICAgICAgICAgICAgICAgICAgICAnVXNlIGVsZW0uc3JjT2JqZWN0ID0gc3RyZWFtIGluc3RlYWQhJyk7CiAgICAgICAgcmV0dXJuIHVybDsKICAgICAgfQogICAgICByZXR1cm4gbmF0aXZlQ3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICB9OwogICAgVVJMLnJldm9rZU9iamVjdFVSTCA9IGZ1bmN0aW9uKHVybCkgewogICAgICBuYXRpdmVSZXZva2VPYmplY3RVUkwodXJsKTsKICAgICAgc3RyZWFtcy5kZWxldGUodXJsKTsKICAgIH07CgogICAgdmFyIGRzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NyYycpOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyYycsIHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gZHNjLmdldC5hcHBseSh0aGlzKTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbih1cmwpIHsKICAgICAgICB0aGlzLnNyY09iamVjdCA9IHN0cmVhbXMuZ2V0KHVybCkgfHwgbnVsbDsKICAgICAgICByZXR1cm4gZHNjLnNldC5hcHBseSh0aGlzLCBbdXJsXSk7CiAgICAgIH0KICAgIH0pOwogIH0KfTsKCi8vIEV4cG9ydC4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgbG9nOiB1dGlscy5sb2csCiAgZGlzYWJsZUxvZzogdXRpbHMuZGlzYWJsZUxvZywKICBicm93c2VyRGV0YWlsczogdXRpbHMuZGV0ZWN0QnJvd3NlcigpLAogIGV4dHJhY3RWZXJzaW9uOiB1dGlscy5leHRyYWN0VmVyc2lvbiwKICBzaGltQ3JlYXRlT2JqZWN0VVJMOiB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMCn07Cgp9LHt9XSwxMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCnJlcXVpcmUoJ3dlYnJ0Yy1hZGFwdGVyJyk7CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCi8qKgogIFRoZSBDb25uZWN0aW9uQ29udHJvbGxlciBoYXMgYSBnZW5lcmljIGRlc2lnbiBzbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGluIGJvdGggc3R1YnMuCiAgSXQgbWFuYWdlcyBhIHNpbmdsZSBEYXRhQ2hhbm5lbCwgaXQgaXMgbm90IHJlcXVlc3RpbmcgYWNjZXNzIHRvIG1lZGlhIGlucHV0LCBpLmUuCiAgZG9lcyBub3QgaGF2ZSBhdWRpby92aWRlbyBzdHJlYW1zLgoqKi8KdmFyIENvbm5lY3Rpb25Db250cm9sbGVyID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENvbm5lY3Rpb25Db250cm9sbGVyKG15VXJsLCBzeW5jaGVyLCBjb25maWd1cmF0aW9uLCBjYWxsZXIpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb25uZWN0aW9uQ29udHJvbGxlcik7CgogICAgaWYgKCFteVVybCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgb3duIHVybCAobXlVcmwpIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFzeW5jaGVyKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzeW5jaGVyIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFjb25maWd1cmF0aW9uKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWd1cmF0aW9uIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoKICAgIHRoaXMuX2RvbWFpbiA9IHRoaXMuX2RpdmlkZVVSTChteVVybClbImRvbWFpbiJdOwogICAgdGhpcy5fb2JqZWN0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovL2NhdGFsb2d1ZS4nICsgdGhpcy5fZG9tYWluICsgJy8ud2VsbC1rbm93bi9kYXRhc2NoZW1hL0Nvbm5lY3Rpb24nOwoKICAgIHRoaXMuX215VXJsID0gbXlVcmw7CiAgICB0aGlzLl9zeW5jaGVyID0gc3luY2hlcjsKICAgIHRoaXMuX2NvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uOwogICAgdGhpcy5fY2FsbGVyID0gY2FsbGVyOwogICAgdGhpcy5fZGF0YU9iamVjdE9ic2VydmVyOwogICAgdGhpcy5fZGF0YU9iamVjdFJlcG9ydGVyOwogICAgdGhpcy5fcGVlclVybDsKICAgIHRoaXMuX2RhdGFDaGFubmVsOwogICAgdGhpcy5fb25TdGF0dXNVcGRhdGU7CiAgICB0aGlzLl9yZW1vdGVSdW50aW1lVVJMOwoKICAgIHRoaXMuX3BlZXJDb25uZWN0aW9uID0gdGhpcy5fY3JlYXRlUGVlckNvbm5lY3Rpb24oKTsKICB9CgogIC8vY3JlYXRlIGEgcGVlciBjb25uZWN0aW9uIHdpdGggaXRzIGV2ZW50IGhhbmRsZXJzCgoKICBfY3JlYXRlQ2xhc3MoQ29ubmVjdGlvbkNvbnRyb2xsZXIsIFt7CiAgICBrZXk6ICdfY3JlYXRlUGVlckNvbm5lY3Rpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVQZWVyQ29ubmVjdGlvbigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBwYyA9IHRoaXMuX3BlZXJDb25uZWN0aW9uOwogICAgICBpZiAoIXBjKSB7CiAgICAgICAgcGMgPSBuZXcgUlRDUGVlckNvbm5lY3Rpb24odGhpcy5fY29uZmlndXJhdGlvbik7CiAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiBjcmVhdGVkIFBlZXJDb25uZWN0aW9uIik7CgogICAgICAgIC8vIGFkZCBoYW5kbGVyIGZvciBkYXRhY2hhbm5lbCBjcmVhdGlvbiBmcm9tIHBlZXIgc2lkZQogICAgICAgIHBjLm9uZGF0YWNoYW5uZWwgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogb25kYXRhY2hhbm5lbCAtPiByZW1vdGUgc2lkZSBoYXMgY3JlYXRlZCBhIGRhdGFjaGFubmVsIik7CiAgICAgICAgICBfdGhpcy5fZGF0YUNoYW5uZWwgPSBldmVudC5jaGFubmVsOwogICAgICAgICAgX3RoaXMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfTsKCiAgICAgICAgLy8gZXZlbnQgaGFuZGxlciBmb3IgbG9jYWwgaWNlIGNhbmRpZGF0ZXMKICAgICAgICBwYy5vbmljZWNhbmRpZGF0ZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IGljZWNhbmRpZGF0ZWV2ZW50IG9jY3VyZWQ6ICIsIGUpOwogICAgICAgICAgaWYgKCFlLmNhbmRpZGF0ZSkgcmV0dXJuOwogICAgICAgICAgdmFyIGljZWNhbmRpZGF0ZSA9IHsKICAgICAgICAgICAgdHlwZTogJ2NhbmRpZGF0ZScsCiAgICAgICAgICAgIGNhbmRpZGF0ZTogZS5jYW5kaWRhdGUuY2FuZGlkYXRlLAogICAgICAgICAgICBzZHBNaWQ6IGUuY2FuZGlkYXRlLnNkcE1pZCwKICAgICAgICAgICAgc2RwTUxpbmVJbmRleDogZS5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleAogICAgICAgICAgfTsKICAgICAgICAgIC8vIHNlbmQgY2FuZGlkYXRlIHRvIHJlbW90ZSBwZWVyIGJ5IHB1c2hpbmcgaXQgdG8gdGhlIHJlcG9ydGVyIG9iamVjdAogICAgICAgICAgX3RoaXMuX2RhdGFPYmplY3RSZXBvcnRlci5kYXRhLmljZUNhbmRpZGF0ZXMucHVzaChpY2VjYW5kaWRhdGUpOwogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIHBjOwogICAgfQoKICAgIC8qKgogICAgUmVhY3QgdG8gdGhlIGdpdmVuIGludml0YXRpb24gZXZlbnQgYnkgc3Vic2NyaWJpbmcgdG8gdGhlIHByb3ZpZGVkIGludml0YXRpb25FdmVudC51cmwuCiAgICAqKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb2JzZXJ2ZShpbnZpdGF0aW9uRXZlbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLl9wZWVyVXJsID0gaW52aXRhdGlvbkV2ZW50LmZyb207CiAgICAgIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwgPSBpbnZpdGF0aW9uRXZlbnQudmFsdWUucnVudGltZVVSTDsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIF90aGlzMi5fc3luY2hlci5zdWJzY3JpYmUoX3RoaXMyLl9vYmplY3REZXNjVVJMLCBpbnZpdGF0aW9uRXZlbnQudXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgICAgIGNvbnNvbGUuaW5mbygnK1tQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIGdvdCBEYXRhIE9iamVjdCBPYnNlcnZlcicsIGRhdGFPYmplY3RPYnNlcnZlcik7CiAgICAgICAgICBfdGhpczIuX3NldHVwT2JzZXJ2ZXIoZGF0YU9iamVjdE9ic2VydmVyKTsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICByZWplY3QoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICBDcmVhdGVzIGEgc3luY2hlciBvYmplY3QgYW5kIGludml0ZSB0aGUgZ2l2ZW4gcGVlclVybCB0byBzdWJzY3JpYmUgZm9yIGl0LgogICAgQWxzbyBjcmVhdGVzIHRoZSBsb2NhbCBvZmZlciwgcGVyZm9ybXMgc2V0TG9jYWxEZXNjcmlwdGlvbiBhbmQgcHVibGlzaGVzIHRoZSBvZmZlciB2aWEgdGhlIHJlcG9ydGVyIG9iamVjdC4KICAgICoqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcG9ydChwZWVyVXJsLCBvd25SdW50aW1lVXJsKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLl9wZWVyVXJsKSB0aGlzLl9wZWVyVXJsID0gcGVlclVybDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgLy8gIGlmIHdlIGFyZSB0aGUgY2FsbGVyIChpLmUuIG5vIHJlcG9ydGVyIG9iamVjdCBwcmVzZW50IHlldCwgaW5pdGFsaXplIHRoZSBjcmVhdGlvbiBvZiB0aGUgRGF0YUNoYW5uZWwpCiAgICAgICAgaWYgKF90aGlzMy5fY2FsbGVyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHdlIGFyZSBpbiBjYWxsZXIgcm9sZSAtLT4gY3JlYXRlRGF0YUNoYW5uZWwgLi4uIik7CiAgICAgICAgICBfdGhpczMuX2RhdGFDaGFubmVsID0gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVEYXRhQ2hhbm5lbCgiUDJQQ2hhbm5lbCIsIHsgcmVsaWFibGU6IGZhbHNlIH0pOwogICAgICAgICAgY29uc29sZS5sb2coIlAyUDogZGF0YWNoYW5uZWwgb2JqZWN0IiwgX3RoaXMzLl9kYXRhQ2hhbm5lbCk7CiAgICAgICAgICBfdGhpczMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBpbml0aWFsIGRhdGEgZm9yIHJlcG9ydGVyIHN5bmMgb2JqZWN0CiAgICAgICAgdmFyIGRhdGFPYmplY3QgPSB7CiAgICAgICAgICBuYW1lOiAiUDJQQ29ubmVjdGlvbiIsCiAgICAgICAgICBzdGF0dXM6ICIiLAogICAgICAgICAgb3duZXI6IF90aGlzMy5fbXlVcmwsCiAgICAgICAgICBydW50aW1lVVJMOiBvd25SdW50aW1lVXJsLCAvLyBwdXQgdGhlIG93biBydW50aW1lVVJMIHRvIHRoZSBkYXRhT2JqZWN0IChhcyBkaXNjdXNzZWQgd2l0aCBQYXVsbykKICAgICAgICAgIGNvbm5lY3Rpb25EZXNjcmlwdGlvbjoge30sCiAgICAgICAgICBpY2VDYW5kaWRhdGVzOiBbXQogICAgICAgIH07CiAgICAgICAgLy8gZW5zdXJlIHRoaXMgdGhlIG9ialJlcG9ydGVyIG9iamVjdCBpcyBjcmVhdGVkIGJlZm9yZSB3ZSBjcmVhdGUgdGhlIG9mZmVyCiAgICAgICAgX3RoaXMzLl9zeW5jaGVyLmNyZWF0ZShfdGhpczMuX29iamVjdERlc2NVUkwsIFtfdGhpczMuX3BlZXJVcmxdLCBkYXRhT2JqZWN0KS50aGVuKGZ1bmN0aW9uIChvYmpSZXBvcnRlcikgewogICAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBDcmVhdGVkIFdlYlJUQyBPYmplY3QgUmVwb3J0ZXInLCBvYmpSZXBvcnRlcik7CgogICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIgPSBvYmpSZXBvcnRlcjsKICAgICAgICAgIF90aGlzMy5fZGF0YU9iamVjdFJlcG9ydGVyLm9uU3Vic2NyaXB0aW9uKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICBldmVudC5hY2NlcHQoKTsgLy8gYWxsIHN1YnNjcmlwdGlvbiByZXF1ZXN0ZWQgYXJlIGFjY2VwdGVkCiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgY29uc3RyYWludHMgPSB7CiAgICAgICAgICAgIG9mZmVyVG9SZWNlaXZlQXVkaW86IGZhbHNlLAogICAgICAgICAgICBvZmZlclRvUmVjZWl2ZVZpZGVvOiBmYWxzZQogICAgICAgICAgfTsKICAgICAgICAgIC8vIGVpdGhlciBpbnZva2UgY3JlYXRlT2ZmZXIgb3IgY3JlYXRlQW5zd2VyLCBkZXBlbmRpbmcgb24gdGhlIHJvbGVzCiAgICAgICAgICB2YXIgc2RwUHJvbWlzZSA9IF90aGlzMy5fY2FsbGVyID8gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVPZmZlcihjb25zdHJhaW50cykgOiBfdGhpczMuX3BlZXJDb25uZWN0aW9uLmNyZWF0ZUFuc3dlcigpOwogICAgICAgICAgc2RwUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChzZHApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIFNEUCBjcmVhdGVkIiwgc2RwKTsKICAgICAgICAgICAgX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5zZXRMb2NhbERlc2NyaXB0aW9uKG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oc2RwKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gbG9jYWxEZXNjcmlwdGlvbiBzZXQgc3VjY2Vzc2Z1bGx5Jyk7CiAgICAgICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIuZGF0YS5jb25uZWN0aW9uRGVzY3JpcHRpb24gPSBzZHA7CiAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHJlamVjdCgic2V0dGluZyBvZiBsb2NhbERlc2NyaXB0aW9uIGZhaWxlZDogIiwgZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICAgIHJlamVjdChyZWFzb24pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25NZXNzYWdlKGNhbGxiYWNrKSB7CiAgICAgIC8vIGFkZCB0aGUgbWVzc2FnZSBjYWxsYmFjawogICAgICB0aGlzLl9vbkRhdGFDaGFubmVsTWVzc2FnZSA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uU3RhdHVzVXBkYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblN0YXR1c1VwZGF0ZShjYWxsYmFjaykgewogICAgICAvLyBhZGQgYSBjb25uZWN0aW9uIHN0YXR1cyB1cGRhdGUgY2FsbGJhY2sKICAgICAgdGhpcy5fb25TdGF0dXNVcGRhdGUgPSBjYWxsYmFjazsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdzZW5kTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZE1lc3NhZ2UobSkgewogICAgICAvLyB0b2RvOiBvbmx5IHNlbmQgaWYgZGF0YSBjaGFubmVsIGlzIGNvbm5lY3RlZAogICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gLS0+IG91dGdvaW5nIG1zZzogIiwgbSk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLnNlbmQobSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnY2xlYW51cCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYW51cCgpIHsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RPYnNlcnZlcjsKICAgICAgaWYgKHRoaXMuX2RhdGFDaGFubmVsKSB0aGlzLl9kYXRhQ2hhbm5lbC5jbG9zZSgpOwogICAgICBpZiAodGhpcy5fcGVlckNvbm5lY3Rpb24pIHRoaXMuX3BlZXJDb25uZWN0aW9uLmNsb3NlKCk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsID0gbnVsbDsKICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24gPSBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogJ19hZGREYXRhQ2hhbm5lbExpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxPcGVuKCk7CiAgICAgIH07CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzNC5fb25EYXRhQ2hhbm5lbEVycm9yKGUpOwogICAgICB9OwogICAgICB0aGlzLl9kYXRhQ2hhbm5lbC5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAobSkgewogICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSA8LS0gaW5jb21pbmcgbXNnOiAiLCBtKTsKICAgICAgICBpZiAoX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZSkgX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZShtKTsKICAgICAgfTsKICAgICAgdGhpcy5fZGF0YUNoYW5uZWwub25jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxDbG9zZSgpOwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZXR1cE9ic2VydmVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0dXBPYnNlcnZlcihkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIgPSBkYXRhT2JqZWN0T2JzZXJ2ZXI7CgogICAgICB2YXIgcGVlckRhdGEgPSB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YTsKICAgICAgY29uc29sZS5pbmZvKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogX3NldHVwT2JzZXJ2ZXIgUGVlciBEYXRhOiIsIHBlZXJEYXRhKTsKCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnY29ubmVjdGlvbkRlc2NyaXB0aW9uJykpIHsKICAgICAgICB0aGlzLl9wcm9jZXNzUGVlckluZm9ybWF0aW9uKHBlZXJEYXRhLmNvbm5lY3Rpb25EZXNjcmlwdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnaWNlQ2FuZGlkYXRlcycpKSB7CiAgICAgICAgcGVlckRhdGEuaWNlQ2FuZGlkYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChpY2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogaGFuZGxlT2JzZXJ2ZXJPYmplY3QgZm9yIGljZSIsIGljZSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oaWNlKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgLy8gc2V0dXAgbGlzdGVuZXIgZm9yIGZ1dHVyZSBjaGFuZ2VzIG9uIHRoZSBvYnNlcnZlZCBkYXRhIG9iamVjdAogICAgICBkYXRhT2JqZWN0T2JzZXJ2ZXIub25DaGFuZ2UoJyonLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBjb25zb2xlLmRlYnVnKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogT2JzZXJ2ZXIgb24gY2hhbmdlIG1lc3NhZ2U6ICcsIGV2ZW50KTsKICAgICAgICAvLyB3ZSBuZWVkIHRvIHByb2Nlc3MgdGhlIGFuc3dlciBmcm9tIGV2ZW50LmRhdGEgYW5kIHRoZSBjYW5kaWRhdGVzIHdoaWNoIG1pZ2h0IHRyaWNrbGUKICAgICAgICAvLyBmcm9tIGV2ZW50LmRhdGFbMF0KICAgICAgICBpZiAoZXZlbnQuZGF0YVswXSkgewogICAgICAgICAgLy8gWzBdIHRoaXMgZG9lcyB0aGUgdHJpY2sgd2hlbiBpY2UgY2FuZGlkYXRlcyBhcmUgdHJpY2tsaW5nIDspCiAgICAgICAgICBjb25zb2xlLmxvZygnPj5ldmVudC5kYXRhWzBdJywgZXZlbnQuZGF0YVswXSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oZXZlbnQuZGF0YVswXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogPj5ldmVudCcsIGV2ZW50KTsKICAgICAgICAgIF90aGlzNS5fcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihldmVudC5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19wcm9jZXNzUGVlckluZm9ybWF0aW9uJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihkYXRhKSB7CiAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246ICIsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgaWYgKCF0aGlzLl9wZWVyQ29ubmVjdGlvbikgewogICAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246IG5vIFBlZXJDb25uZWN0aW9uIGV4aXN0aW5nIC0tPiBtYXliZSBpbiBkaXNjb25uZWN0aW5nIHByb2Nlc3MuIC0tPiBpZ25vcmluZyB0aGlzIHVwZGF0ZSIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGRhdGEudHlwZSA9PT0gJ29mZmVyJyB8fCBkYXRhLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogUHJvY2VzcyBDb25uZWN0aW9uIERlc2NyaXB0aW9uOiAnLCBkYXRhKTsKICAgICAgICB0aGlzLl9wZWVyQ29ubmVjdGlvbi5zZXRSZW1vdGVEZXNjcmlwdGlvbihuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKGRhdGEpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogcmVtb3RlIHN1Y2Nlc3MiKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiByZW1vdGUgZXJyb3I6ICIsIGUpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoZGF0YS5jYW5kaWRhdGUpIHsKICAgICAgICBjb25zb2xlLmluZm8oJ1Byb2Nlc3MgSWNlIENhbmRpZGF0ZTogJywgZGF0YSk7CiAgICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24uYWRkSWNlQ2FuZGlkYXRlKG5ldyBSVENJY2VDYW5kaWRhdGUoewogICAgICAgICAgY2FuZGlkYXRlOiBkYXRhLmNhbmRpZGF0ZQogICAgICAgIH0pKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsT3BlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRGF0YUNoYW5uZWxPcGVuKCkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgb3BlbmVkJyk7CiAgICAgIGlmICh0aGlzLl9vblN0YXR1c1VwZGF0ZSkgdGhpcy5fb25TdGF0dXNVcGRhdGUoImxpdmUiLCB1bmRlZmluZWQsIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsRXJyb3InLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsRXJyb3IoZSkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgZXJyb3I6ICcsIGUpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiIiArIGUpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsQ2xvc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsQ2xvc2UoKSB7CiAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBEYXRhQ2hhbm5lbCBjbG9zZWQ6ICcpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiY2xvc2VkIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICAgICAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAgICAgKiBAcmV0dXJuIHtkaXZpZGVVUkx9IHRoZSByZXN1bHQgb2YgZGl2aWRlVVJMCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnX2RpdmlkZVVSTCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RpdmlkZVVSTCh1cmwpIHsKCiAgICAgIC8vIGxldCByZSA9IC8oW2EtekEtWi1dKik/OlwvXC8oPzpcLik/KFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIpKihcL1tcL1xkXHdcLi1dKikqKD86W1w/XSkqKC4rKSovZ2k7CiAgICAgIHZhciByZSA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogICAgICB2YXIgc3Vic3QgPSAnJDEsJDIsJDMnOwogICAgICB2YXIgcGFydHMgPSB1cmwucmVwbGFjZShyZSwgc3Vic3QpLnNwbGl0KCcsJyk7CgogICAgICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzCiAgICAgIGlmIChwYXJ0c1swXSA9PT0gdXJsKSB7CiAgICAgICAgcGFydHNbMF0gPSAnaHR0cHMnOwogICAgICAgIHBhcnRzWzFdID0gdXJsOwogICAgICB9CgogICAgICB2YXIgcmVzdWx0ID0gewogICAgICAgIHR5cGU6IHBhcnRzWzBdLAogICAgICAgIGRvbWFpbjogcGFydHNbMV0sCiAgICAgICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgICAgIH07CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIENvbm5lY3Rpb25Db250cm9sbGVyOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBDb25uZWN0aW9uQ29udHJvbGxlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsid2VicnRjLWFkYXB0ZXIiOjN9XSwxMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCi8vIFRPRE86IGludGVncmF0ZSB0aGUgc3RhdHVzIGV2ZW50aW5nCgpleHBvcnRzLmRlZmF1bHQgPSBhY3RpdmF0ZTsKCnZhciBfU3luY2hlciA9IHJlcXVpcmUoJ3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlcicpOwoKdmFyIF9Db25uZWN0aW9uQ29udHJvbGxlciA9IHJlcXVpcmUoJy4vQ29ubmVjdGlvbkNvbnRyb2xsZXInKTsKCnZhciBfQ29ubmVjdGlvbkNvbnRyb2xsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQ29ubmVjdGlvbkNvbnRyb2xsZXIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKLyoqCiAqIFByb3RvU3R1YiBJbnRlcmZhY2UKICovCnZhciBQMlBIYW5kbGVyU3R1YiA9IGZ1bmN0aW9uICgpIHsKCiAgLyoqCiAgICogSW5pdGlhbGlzZSB0aGUgcHJvdG9jb2wgc3R1YiBpbmNsdWRpbmcgYXMgaW5wdXQgcGFyYW1ldGVycyBpdHMgYWxsb2NhdGVkCiAgICogY29tcG9uZW50IHJ1bnRpbWUgdXJsLCB0aGUgcnVudGltZSBCVVMgcG9zdE1lc3NhZ2UgZnVuY3Rpb24gdG8gYmUgaW52b2tlZAogICAqIG9uIG1lc3NhZ2VzIHJlY2VpdmVkIGJ5IHRoZSBwcm90b2NvbCBzdHViIGFuZCByZXF1aXJlZCBjb25maWd1cmF0aW9uIHJldHJpZXZlZCBmcm9tIHByb3RvY29sU3R1YiBkZXNjcmlwdG9yLgogICAqIEBwYXJhbSAge1VSTC5ydW50aW1lUHJvdG9TdHViVVJMfSAgICAgICAgICAgICAgICAgICBydW50aW1lUHJvdG9TdHViVVJMIHJ1bnRpbWVQcm90b1N1YlVSTAogICAqIEBwYXJhbSAge01lc3NhZ2UuTWVzc2FnZX0gICAgICAgICAgICAgICAgICAgICAgICAgICBidXNQb3N0TWVzc2FnZSAgICAgY29uZmlndXJhdGlvbgogICAqIEBwYXJhbSAge1Byb3RvU3R1YkRlc2NyaXB0b3IuQ29uZmlndXJhdGlvbkRhdGFMaXN0fSBjb25maWd1cmF0aW9uICAgICAgY29uZmlndXJhdGlvbgogICAqLwogIGZ1bmN0aW9uIFAyUEhhbmRsZXJTdHViKHJ1bnRpbWVQcm90b1N0dWJVUkwsIG1pbmlCdXMsIGNvbmZpZ3VyYXRpb24pIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFAyUEhhbmRsZXJTdHViKTsKCiAgICBpZiAoIXJ1bnRpbWVQcm90b1N0dWJVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIHJ1bnRpbWVQcm90b1N0dWJVUkwgaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKICAgIGlmICghbWluaUJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWNvbmZpZ3VyYXRpb24pIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZ3VyYXRpb24gaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKCiAgICBjb25zb2xlLmxvZygnK1tQMlBIYW5kbGVyU3R1Yi5jb25zdHJ1Y3Rvcl0gY29uZmlnIGlzOiAnLCBjb25maWd1cmF0aW9uKTsKCiAgICB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMID0gcnVudGltZVByb3RvU3R1YlVSTDsKICAgIHRoaXMuX3J1bnRpbWVVUkwgPSBjb25maWd1cmF0aW9uLnJ1bnRpbWVVUkw7CiAgICB0aGlzLl9jb25maWd1cmF0aW9uID0gY29uZmlndXJhdGlvbjsKICAgIHRoaXMuX2J1cyA9IG1pbmlCdXM7CiAgICB0aGlzLl9idXMuYWRkTGlzdGVuZXIoJyonLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgIF90aGlzLl9zZW5kQ2hhbm5lbE1zZyhtc2cpOwogICAgfSk7CgogICAgdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXJzID0ge307CgogICAgdGhpcy5fc3luY2hlciA9IG5ldyBfU3luY2hlci5TeW5jaGVyKHJ1bnRpbWVQcm90b1N0dWJVUkwsIG1pbmlCdXMsIGNvbmZpZ3VyYXRpb24pOwogICAgdGhpcy5fc3luY2hlci5vbk5vdGlmaWNhdGlvbihmdW5jdGlvbiAoZXZlbnQpIHsKCiAgICAgIGNvbnNvbGUubG9nKCcrW1AyUEhhbmRsZXJTdHViXSBPbiBTeW5jaGVyIE5vdGlmaWNhdGlvbjogJywgZXZlbnQpOwogICAgICBldmVudC5hY2soMjAwKTsKCiAgICAgIHN3aXRjaCAoZXZlbnQudHlwZSkgewoKICAgICAgICBjYXNlICdjcmVhdGUnOgoKICAgICAgICAgIC8vIGFzIGRpc2N1c3NlZCB3aXRoIFBhdWxvLCB3ZSBleHBlY3QgdGhlICJyZW1vdGVSdW50aW1lVVJMIiBhcyBmaWVsZCAicnVudGltZVVSTCIgaW4gdGhlIGluaXRpYWwgZGF0YU9iamVjdAogICAgICAgICAgLy8gZW1pdCB0aGUgImNyZWF0ZSIgZXZlbnQgYXMgcmVxdWVzdGVkIGluIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2Rldi1wcm90b3N0dWJzL2lzc3Vlcy81CiAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygiY3JlYXRlIiwgdW5kZWZpbmVkLCBldmVudC52YWx1ZS5ydW50aW1lVVJMKTsKCiAgICAgICAgICBfdGhpcy5fY3JlYXRlQ29ubmVjdGlvbkNvbnRyb2xsZXIoZXZlbnQpLnRoZW4oZnVuY3Rpb24gKGNvbm5lY3Rpb25Db250cm9sbGVyKSB7CiAgICAgICAgICAgIF90aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcnNbZXZlbnQuZnJvbV0gPSBjb25uZWN0aW9uQ29udHJvbGxlcjsKICAgICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIub25TdGF0dXNVcGRhdGUoZnVuY3Rpb24gKHN0YXR1cywgcmVhc29uLCByZW1vdGVSdW50aW1lVVJMKSB7CiAgICAgICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoc3RhdHVzLCByZWFzb24sIHJlbW90ZVJ1bnRpbWVVUkwpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIub25NZXNzYWdlKGZ1bmN0aW9uIChtKSB7CiAgICAgICAgICAgICAgX3RoaXMuX2RlbGl2ZXIobSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnZGVsZXRlJzoKICAgICAgICAgIC8vIFRPRE86IHF1ZXN0aW9uIGNvZGUgaW4gQ29ubmVjdG9yIC0tPiB0aGVyZSBpdCBkZWxldGVzIGFsbCBjb250cm9sbGVycyAtLT4gd2h5PwogICAgICAgICAgY29uc29sZS5sb2coIitbUDJQSGFuZGxlclN0dWJdIGRlbGV0aW5nIGNvbm5lY3Rpb24gaGFuZGxlciBmb3IgIiArIGV2ZW50LmZyb20pOwogICAgICAgICAgdmFyIGNvbm5lY3Rpb25Db250cm9sbGVyID0gX3RoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyc1tldmVudC5mcm9tXTsKCiAgICAgICAgICBpZiAoY29ubmVjdGlvbkNvbnRyb2xsZXIpIHsKICAgICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIuY2xlYW51cCgpOwogICAgICAgICAgICBkZWxldGUgX3RoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyc1tldmVudC5mcm9tXTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICB9CiAgICB9KTsKICB9CgogIC8qKgogICAqIFRvIGRpc2Nvbm5lY3QgdGhlIHByb3RvY29sIHN0dWIuCiAgICovCgoKICBfY3JlYXRlQ2xhc3MoUDJQSGFuZGxlclN0dWIsIFt7CiAgICBrZXk6ICdkaXNjb25uZWN0JywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb25uZWN0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIC8vIGNsZWFudXAgQUxMIGNvbm5lY3Rpb25Db250cm9sbGVycwogICAgICBPYmplY3Qua2V5cyh0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcnMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF90aGlzMi5fY29udHJvbGxlcnNba2V5XS5jbGVhbnVwKCk7OwogICAgICAgIGRlbGV0ZSBfdGhpczIuX2NvbnRyb2xsZXJzW2tleV07CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19jcmVhdGVDb25uZWN0aW9uQ29udHJvbGxlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZUNvbm5lY3Rpb25Db250cm9sbGVyKGludml0YXRpb25FdmVudCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIGNvbm5lY3Rpb25Db250cm9sbGVyID0gbmV3IF9Db25uZWN0aW9uQ29udHJvbGxlcjIuZGVmYXVsdChfdGhpczMuX3J1bnRpbWVQcm90b1N0dWJVUkwsIF90aGlzMy5fc3luY2hlciwgX3RoaXMzLl9jb25maWd1cmF0aW9uLCBmYWxzZSk7CiAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIub2JzZXJ2ZShpbnZpdGF0aW9uRXZlbnQpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgY29uc29sZS5sb2coIitbUDJQSGFuZGxlclN0dWJdIG9ic2VydmVyIHNldHVwIHN1Y2Nlc3NmdWwiKTsKICAgICAgICAgIC8vIGNyZWF0ZSB0aGUgcmVwb3J0ZXIgYXV0b21hdGljYWxseQogICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIucmVwb3J0KGludml0YXRpb25FdmVudC5mcm9tLCBfdGhpczMuX3J1bnRpbWVVUkwpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiK1tQMlBIYW5kbGVyU3R1Yl0gcmVwb3J0ZXIgc2V0dXAgc3VjY2Vzc2Z1bCIpOwogICAgICAgICAgICBfdGhpczMuX3NlbmRTdGF0dXMoImluLXByb2dyZXNzIiwgdW5kZWZpbmVkLCBpbnZpdGF0aW9uRXZlbnQudmFsdWUucnVudGltZVVSTCk7CiAgICAgICAgICAgIHJlc29sdmUoY29ubmVjdGlvbkNvbnRyb2xsZXIpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZW5kQ2hhbm5lbE1zZycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRDaGFubmVsTXNnKG1zZykgewogICAgICBpZiAodGhpcy5fZmlsdGVyKG1zZykpIHsKICAgICAgICAvLyBUT0RPOiB2ZXJpZnk6IGlzIHRoaXMgc2VsZWN0aW9uIGNvcnJlY3Q/CiAgICAgICAgdmFyIGNvbm5lY3Rpb25Db250cm9sbGVyID0gdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXJzW21zZy50b107CiAgICAgICAgaWYgKGNvbm5lY3Rpb25Db250cm9sbGVyKSBjb25uZWN0aW9uQ29udHJvbGxlci5zZW5kTWVzc2FnZShKU09OLnN0cmluZ2lmeShtc2cpKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19zZW5kU3RhdHVzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VuZFN0YXR1cyh2YWx1ZSwgcmVhc29uLCByZW1vdGVSdW50aW1lVVJMKSB7CiAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgdHlwZTogJ3VwZGF0ZScsCiAgICAgICAgZnJvbTogdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCwKICAgICAgICB0bzogdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCArICcvc3RhdHVzJywKICAgICAgICBib2R5OiB7CiAgICAgICAgICB2YWx1ZTogdmFsdWUKICAgICAgICB9CiAgICAgIH07CiAgICAgIGlmIChyZW1vdGVSdW50aW1lVVJMKSBtc2cuYm9keS5yZXNvdXJjZSA9IHJlbW90ZVJ1bnRpbWVVUkw7CgogICAgICBpZiAocmVhc29uKSB7CiAgICAgICAgbXNnLmJvZHkuZGVzYyA9IHJlYXNvbjsKICAgICAgfQogICAgICBjb25zb2xlLmxvZygiK1tQMlBIYW5kbGVyU3R1Yl0gc2VuZGluZyBzdGF0dXMgdXBkYXRlOiAiLCBtc2cpOwogICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnKTsKICAgIH0KCiAgICAvKioKICAgICAqIEZpbHRlciBtZXRob2QgdGhhdCBzaG91bGQgYmUgdXNlZCBmb3IgZXZlcnkgbWVzc2FnZXMgaW4gZGlyZWN0aW9uOiBQcm90b3N0dWIgLT4gTWVzc2FnZU5vZGUKICAgICAqIEBwYXJhbSAge01lc3NhZ2V9IG1zZyBPcmlnaW5hbCBtZXNzYWdlIGZyb20gdGhlIE1lc3NhZ2VCdXMKICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IHRydWUgaWYgaXQncyB0byBiZSBkZWxpdmVyIGluIHRoZSBNZXNzYWdlTm9kZQogICAgICovCgogIH0sIHsKICAgIGtleTogJ19maWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maWx0ZXIobXNnKSB7CiAgICAgIC8vIHRvZG86IG9ubHkgdHJ5IHRvIHNlbmQgd2hlbiBjb25uZWN0ZWQgKGxpdmUgc3RhdHVzKQogICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkudmlhID09PSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMKSByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogTWV0aG9kIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gZGVsaXZlciB0aGUgbWVzc2FnZSBpbiBkaXJlY3Rpb246IFByb3Rvc3R1YiAtPiBNZXNzYWdlQnVzIChjb3JlKQogICAgICogQHBhcmFtICB7TWVzc2FnZX0gbXNnIE9yaWdpbmFsIG1lc3NhZ2UgZnJvbSB0aGUgTWVzc2FnZU5vZGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdfZGVsaXZlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGl2ZXIobXNnKSB7CgogICAgICBjb25zb2xlLmxvZygiK1tQMlBIYW5kbGVyU3R1Yl0gcG9zdGluZyBtZXNzYWdlIHRvIG1zZyBidXM6ICIsIG1zZyk7CiAgICAgIHZhciBtZXNzYWdlID0gSlNPTi5wYXJzZShtc2cuZGF0YSk7CgogICAgICBpZiAoIW1lc3NhZ2UuYm9keSkgbXNnLmJvZHkgPSB7fTsKCiAgICAgIG1lc3NhZ2UuYm9keS52aWEgPSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMOwogICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UobWVzc2FnZSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUDJQSGFuZGxlclN0dWI7Cn0oKTsKCmZ1bmN0aW9uIGFjdGl2YXRlKHVybCwgYnVzLCBjb25maWcpIHsKICByZXR1cm4gewogICAgbmFtZTogJ1AyUEhhbmRsZXJTdHViJywKICAgIGluc3RhbmNlOiBuZXcgUDJQSGFuZGxlclN0dWIodXJsLCBidXMsIGNvbmZpZykKICB9Owp9Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4vQ29ubmVjdGlvbkNvbnRyb2xsZXIiOjEyLCJzZXJ2aWNlLWZyYW1ld29yay9kaXN0L1N5bmNoZXIiOjJ9XX0se30sWzEzXSkoMTMpCn0pOw==",
      "sourceCodeClassname": "P2PHandlerProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-38b3da70-28d4-8082-38f1-b1709f6ee7692",
    "version": 0.7999999999999999,
    "description": "Description of P2PHandlerProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "P2PHandlerProtoStub",
    "configuration": {
      "iceServers": [
        {
          "urls": "stun:stun.voiparound.com"
        },
        {
          "urls": "stun:stun.voipbuster.com"
        },
        {
          "urls": "stun:stun.voipstunt.com"
        },
        {
          "urls": "stun:stun.voxgratia.org"
        },
        {
          "urls": "stun:stun.ekiga.net"
        },
        {
          "urls": "stun:stun.schlund.de"
        },
        {
          "urls": "stun:stun.iptel.org"
        },
        {
          "urls": "stun:stun.l.google.com:19302"
        },
        {
          "urls": "stun:stun1.l.google.com:19302"
        },
        {
          "urls": "stun:stun.ideasip.com"
        },
        {
          "urls": "stun:stun4.l.google.com:19302"
        },
        {
          "urls": "stun:stun2.l.google.com:19302"
        },
        {
          "urls": "stun:stun3.l.google.com:19302"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=tcp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=udp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:numb.viagenie.ca",
          "credential": "muazkh",
          "username": "webrtc@live.com"
        }
      ]
    },
    "messageSchemas": "",
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": "{ windowSandbox: true }",
    "interworking": false,
    "dataObjects": []
  },
  "P2PRequesterProtoStub": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBTRFAgaGVscGVycy4KdmFyIFNEUFV0aWxzID0ge307CgovLyBHZW5lcmF0ZSBhbiBhbHBoYW51bWVyaWMgaWRlbnRpZmllciBmb3IgY25hbWUgb3IgbWlkcy4KLy8gVE9ETzogdXNlIFVVSURzIGluc3RlYWQ/IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2plZC85ODI4ODMKU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCAxMCk7Cn07CgovLyBUaGUgUlRDUCBDTkFNRSB1c2VkIGJ5IGFsbCBwZWVyY29ubmVjdGlvbnMgZnJvbSB0aGUgc2FtZSBKUy4KU0RQVXRpbHMubG9jYWxDTmFtZSA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwoKLy8gU3BsaXRzIFNEUCBpbnRvIGxpbmVzLCBkZWFsaW5nIHdpdGggYm90aCBDUkxGIGFuZCBMRi4KU0RQVXRpbHMuc3BsaXRMaW5lcyA9IGZ1bmN0aW9uKGJsb2IpIHsKICByZXR1cm4gYmxvYi50cmltKCkuc3BsaXQoJ1xuJykubWFwKGZ1bmN0aW9uKGxpbmUpIHsKICAgIHJldHVybiBsaW5lLnRyaW0oKTsKICB9KTsKfTsKLy8gU3BsaXRzIFNEUCBpbnRvIHNlc3Npb25wYXJ0IGFuZCBtZWRpYXNlY3Rpb25zLiBFbnN1cmVzIENSTEYuClNEUFV0aWxzLnNwbGl0U2VjdGlvbnMgPSBmdW5jdGlvbihibG9iKSB7CiAgdmFyIHBhcnRzID0gYmxvYi5zcGxpdCgnXG5tPScpOwogIHJldHVybiBwYXJ0cy5tYXAoZnVuY3Rpb24ocGFydCwgaW5kZXgpIHsKICAgIHJldHVybiAoaW5kZXggPiAwID8gJ209JyArIHBhcnQgOiBwYXJ0KS50cmltKCkgKyAnXHJcbic7CiAgfSk7Cn07CgovLyBSZXR1cm5zIGxpbmVzIHRoYXQgc3RhcnQgd2l0aCBhIGNlcnRhaW4gcHJlZml4LgpTRFBVdGlscy5tYXRjaFByZWZpeCA9IGZ1bmN0aW9uKGJsb2IsIHByZWZpeCkgewogIHJldHVybiBTRFBVdGlscy5zcGxpdExpbmVzKGJsb2IpLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gbGluZS5pbmRleE9mKHByZWZpeCkgPT09IDA7CiAgfSk7Cn07CgovLyBQYXJzZXMgYW4gSUNFIGNhbmRpZGF0ZSBsaW5lLiBTYW1wbGUgaW5wdXQ6Ci8vIGNhbmRpZGF0ZTo3MDI3ODYzNTAgMiB1ZHAgNDE4MTk5MDIgOC44LjguOCA2MDc2OSB0eXAgcmVsYXkgcmFkZHIgOC44LjguOAovLyBycG9ydCA1NTk5NiIKU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzOwogIC8vIFBhcnNlIGJvdGggdmFyaWFudHMuCiAgaWYgKGxpbmUuaW5kZXhPZignYT1jYW5kaWRhdGU6JykgPT09IDApIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTIpLnNwbGl0KCcgJyk7CiAgfSBlbHNlIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTApLnNwbGl0KCcgJyk7CiAgfQoKICB2YXIgY2FuZGlkYXRlID0gewogICAgZm91bmRhdGlvbjogcGFydHNbMF0sCiAgICBjb21wb25lbnQ6IHBhcnRzWzFdLAogICAgcHJvdG9jb2w6IHBhcnRzWzJdLnRvTG93ZXJDYXNlKCksCiAgICBwcmlvcml0eTogcGFyc2VJbnQocGFydHNbM10sIDEwKSwKICAgIGlwOiBwYXJ0c1s0XSwKICAgIHBvcnQ6IHBhcnNlSW50KHBhcnRzWzVdLCAxMCksCiAgICAvLyBza2lwIHBhcnRzWzZdID09ICd0eXAnCiAgICB0eXBlOiBwYXJ0c1s3XQogIH07CgogIGZvciAodmFyIGkgPSA4OyBpIDwgcGFydHMubGVuZ3RoOyBpICs9IDIpIHsKICAgIHN3aXRjaCAocGFydHNbaV0pIHsKICAgICAgY2FzZSAncmFkZHInOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAncnBvcnQnOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCA9IHBhcnNlSW50KHBhcnRzW2kgKyAxXSwgMTApOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICd0Y3B0eXBlJzoKICAgICAgICBjYW5kaWRhdGUudGNwVHlwZSA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDogLy8gVW5rbm93biBleHRlbnNpb25zIGFyZSBzaWxlbnRseSBpZ25vcmVkLgogICAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gY2FuZGlkYXRlOwp9OwoKLy8gVHJhbnNsYXRlcyBhIGNhbmRpZGF0ZSBvYmplY3QgaW50byBTRFAgY2FuZGlkYXRlIGF0dHJpYnV0ZS4KU0RQVXRpbHMud3JpdGVDYW5kaWRhdGUgPSBmdW5jdGlvbihjYW5kaWRhdGUpIHsKICB2YXIgc2RwID0gW107CiAgc2RwLnB1c2goY2FuZGlkYXRlLmZvdW5kYXRpb24pOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5jb21wb25lbnQpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5wcm90b2NvbC50b1VwcGVyQ2FzZSgpKTsKICBzZHAucHVzaChjYW5kaWRhdGUucHJpb3JpdHkpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5pcCk7CiAgc2RwLnB1c2goY2FuZGlkYXRlLnBvcnQpOwoKICB2YXIgdHlwZSA9IGNhbmRpZGF0ZS50eXBlOwogIHNkcC5wdXNoKCd0eXAnKTsKICBzZHAucHVzaCh0eXBlKTsKICBpZiAodHlwZSAhPT0gJ2hvc3QnICYmIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyAmJgogICAgICBjYW5kaWRhdGUucmVsYXRlZFBvcnQpIHsKICAgIHNkcC5wdXNoKCdyYWRkcicpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnJlbGF0ZWRBZGRyZXNzKTsgLy8gd2FzOiByZWxBZGRyCiAgICBzZHAucHVzaCgncnBvcnQnKTsKICAgIHNkcC5wdXNoKGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCk7IC8vIHdhczogcmVsUG9ydAogIH0KICBpZiAoY2FuZGlkYXRlLnRjcFR5cGUgJiYgY2FuZGlkYXRlLnByb3RvY29sLnRvTG93ZXJDYXNlKCkgPT09ICd0Y3AnKSB7CiAgICBzZHAucHVzaCgndGNwdHlwZScpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnRjcFR5cGUpOwogIH0KICByZXR1cm4gJ2NhbmRpZGF0ZTonICsgc2RwLmpvaW4oJyAnKTsKfTsKCi8vIFBhcnNlcyBhbiBydHBtYXAgbGluZSwgcmV0dXJucyBSVENSdHBDb2RkZWNQYXJhbWV0ZXJzLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9cnRwbWFwOjExMSBvcHVzLzQ4MDAwLzIKU0RQVXRpbHMucGFyc2VSdHBNYXAgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIoOSkuc3BsaXQoJyAnKTsKICB2YXIgcGFyc2VkID0gewogICAgcGF5bG9hZFR5cGU6IHBhcnNlSW50KHBhcnRzLnNoaWZ0KCksIDEwKSAvLyB3YXM6IGlkCiAgfTsKCiAgcGFydHMgPSBwYXJ0c1swXS5zcGxpdCgnLycpOwoKICBwYXJzZWQubmFtZSA9IHBhcnRzWzBdOwogIHBhcnNlZC5jbG9ja1JhdGUgPSBwYXJzZUludChwYXJ0c1sxXSwgMTApOyAvLyB3YXM6IGNsb2NrcmF0ZQogIC8vIHdhczogY2hhbm5lbHMKICBwYXJzZWQubnVtQ2hhbm5lbHMgPSBwYXJ0cy5sZW5ndGggPT09IDMgPyBwYXJzZUludChwYXJ0c1syXSwgMTApIDogMTsKICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGUgYW4gYT1ydHBtYXAgbGluZSBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvcgovLyBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRwTWFwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgcmV0dXJuICdhPXJ0cG1hcDonICsgcHQgKyAnICcgKyBjb2RlYy5uYW1lICsgJy8nICsgY29kZWMuY2xvY2tSYXRlICsKICAgICAgKGNvZGVjLm51bUNoYW5uZWxzICE9PSAxID8gJy8nICsgY29kZWMubnVtQ2hhbm5lbHMgOiAnJykgKyAnXHJcbic7Cn07CgovLyBQYXJzZXMgYW4gYT1leHRtYXAgbGluZSAoaGVhZGVyZXh0ZW5zaW9uIGZyb20gUkZDIDUyODUpLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9ZXh0bWFwOjIgdXJuOmlldGY6cGFyYW1zOnJ0cC1oZHJleHQ6dG9mZnNldApTRFBVdGlscy5wYXJzZUV4dG1hcCA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cig5KS5zcGxpdCgnICcpOwogIHJldHVybiB7CiAgICBpZDogcGFyc2VJbnQocGFydHNbMF0sIDEwKSwKICAgIHVyaTogcGFydHNbMV0KICB9Owp9OwoKLy8gR2VuZXJhdGVzIGE9ZXh0bWFwIGxpbmUgZnJvbSBSVENSdHBIZWFkZXJFeHRlbnNpb25QYXJhbWV0ZXJzIG9yCi8vIFJUQ1J0cEhlYWRlckV4dGVuc2lvbi4KU0RQVXRpbHMud3JpdGVFeHRtYXAgPSBmdW5jdGlvbihoZWFkZXJFeHRlbnNpb24pIHsKICByZXR1cm4gJ2E9ZXh0bWFwOicgKyAoaGVhZGVyRXh0ZW5zaW9uLmlkIHx8IGhlYWRlckV4dGVuc2lvbi5wcmVmZXJyZWRJZCkgKwogICAgICAgJyAnICsgaGVhZGVyRXh0ZW5zaW9uLnVyaSArICdcclxuJzsKfTsKCi8vIFBhcnNlcyBhbiBmdG1wIGxpbmUsIHJldHVybnMgZGljdGlvbmFyeS4gU2FtcGxlIGlucHV0OgovLyBhPWZtdHA6OTYgdmJyPW9uO2NuZz1vbgovLyBBbHNvIGRlYWxzIHdpdGggdmJyPW9uOyBjbmc9b24KU0RQVXRpbHMucGFyc2VGbXRwID0gZnVuY3Rpb24obGluZSkgewogIHZhciBwYXJzZWQgPSB7fTsKICB2YXIga3Y7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIobGluZS5pbmRleE9mKCcgJykgKyAxKS5zcGxpdCgnOycpOwogIGZvciAodmFyIGogPSAwOyBqIDwgcGFydHMubGVuZ3RoOyBqKyspIHsKICAgIGt2ID0gcGFydHNbal0udHJpbSgpLnNwbGl0KCc9Jyk7CiAgICBwYXJzZWRba3ZbMF0udHJpbSgpXSA9IGt2WzFdOwogIH0KICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGVzIGFuIGE9ZnRtcCBsaW5lIGZyb20gUlRDUnRwQ29kZWNDYXBhYmlsaXR5IG9yIFJUQ1J0cENvZGVjUGFyYW1ldGVycy4KU0RQVXRpbHMud3JpdGVGbXRwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZSA9ICcnOwogIHZhciBwdCA9IGNvZGVjLnBheWxvYWRUeXBlOwogIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICBwdCA9IGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlOwogIH0KICBpZiAoY29kZWMucGFyYW1ldGVycyAmJiBPYmplY3Qua2V5cyhjb2RlYy5wYXJhbWV0ZXJzKS5sZW5ndGgpIHsKICAgIHZhciBwYXJhbXMgPSBbXTsKICAgIE9iamVjdC5rZXlzKGNvZGVjLnBhcmFtZXRlcnMpLmZvckVhY2goZnVuY3Rpb24ocGFyYW0pIHsKICAgICAgcGFyYW1zLnB1c2gocGFyYW0gKyAnPScgKyBjb2RlYy5wYXJhbWV0ZXJzW3BhcmFtXSk7CiAgICB9KTsKICAgIGxpbmUgKz0gJ2E9Zm10cDonICsgcHQgKyAnICcgKyBwYXJhbXMuam9pbignOycpICsgJ1xyXG4nOwogIH0KICByZXR1cm4gbGluZTsKfTsKCi8vIFBhcnNlcyBhbiBydGNwLWZiIGxpbmUsIHJldHVybnMgUlRDUFJ0Y3BGZWVkYmFjayBvYmplY3QuIFNhbXBsZSBpbnB1dDoKLy8gYT1ydGNwLWZiOjk4IG5hY2sgcnBzaQpTRFBVdGlscy5wYXJzZVJ0Y3BGYiA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cihsaW5lLmluZGV4T2YoJyAnKSArIDEpLnNwbGl0KCcgJyk7CiAgcmV0dXJuIHsKICAgIHR5cGU6IHBhcnRzLnNoaWZ0KCksCiAgICBwYXJhbWV0ZXI6IHBhcnRzLmpvaW4oJyAnKQogIH07Cn07Ci8vIEdlbmVyYXRlIGE9cnRjcC1mYiBsaW5lcyBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvciBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRjcEZiID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZXMgPSAnJzsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgaWYgKGNvZGVjLnJ0Y3BGZWVkYmFjayAmJiBjb2RlYy5ydGNwRmVlZGJhY2subGVuZ3RoKSB7CiAgICAvLyBGSVhNRTogc3BlY2lhbCBoYW5kbGluZyBmb3IgdHJyLWludD8KICAgIGNvZGVjLnJ0Y3BGZWVkYmFjay5mb3JFYWNoKGZ1bmN0aW9uKGZiKSB7CiAgICAgIGxpbmVzICs9ICdhPXJ0Y3AtZmI6JyArIHB0ICsgJyAnICsgZmIudHlwZSArCiAgICAgIChmYi5wYXJhbWV0ZXIgJiYgZmIucGFyYW1ldGVyLmxlbmd0aCA/ICcgJyArIGZiLnBhcmFtZXRlciA6ICcnKSArCiAgICAgICAgICAnXHJcbic7CiAgICB9KTsKICB9CiAgcmV0dXJuIGxpbmVzOwp9OwoKLy8gUGFyc2VzIGFuIFJGQyA1NTc2IHNzcmMgbWVkaWEgYXR0cmlidXRlLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9c3NyYzozNzM1OTI4NTU5IGNuYW1lOnNvbWV0aGluZwpTRFBVdGlscy5wYXJzZVNzcmNNZWRpYSA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgc3AgPSBsaW5lLmluZGV4T2YoJyAnKTsKICB2YXIgcGFydHMgPSB7CiAgICBzc3JjOiBwYXJzZUludChsaW5lLnN1YnN0cig3LCBzcCAtIDcpLCAxMCkKICB9OwogIHZhciBjb2xvbiA9IGxpbmUuaW5kZXhPZignOicsIHNwKTsKICBpZiAoY29sb24gPiAtMSkgewogICAgcGFydHMuYXR0cmlidXRlID0gbGluZS5zdWJzdHIoc3AgKyAxLCBjb2xvbiAtIHNwIC0gMSk7CiAgICBwYXJ0cy52YWx1ZSA9IGxpbmUuc3Vic3RyKGNvbG9uICsgMSk7CiAgfSBlbHNlIHsKICAgIHBhcnRzLmF0dHJpYnV0ZSA9IGxpbmUuc3Vic3RyKHNwICsgMSk7CiAgfQogIHJldHVybiBwYXJ0czsKfTsKCi8vIEV4dHJhY3RzIERUTFMgcGFyYW1ldGVycyBmcm9tIFNEUCBtZWRpYSBzZWN0aW9uIG9yIHNlc3Npb25wYXJ0LgovLyBGSVhNRTogZm9yIGNvbnNpc3RlbmN5IHdpdGggb3RoZXIgZnVuY3Rpb25zIHRoaXMgc2hvdWxkIG9ubHkKLy8gICBnZXQgdGhlIGZpbmdlcnByaW50IGxpbmUgYXMgaW5wdXQuIFNlZSBhbHNvIGdldEljZVBhcmFtZXRlcnMuClNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBmcExpbmUgPSBsaW5lcy5maWx0ZXIoZnVuY3Rpb24obGluZSkgewogICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1maW5nZXJwcmludDonKSA9PT0gMDsKICB9KVswXS5zdWJzdHIoMTQpOwogIC8vIE5vdGU6IGE9c2V0dXAgbGluZSBpcyBpZ25vcmVkIHNpbmNlIHdlIHVzZSB0aGUgJ2F1dG8nIHJvbGUuCiAgdmFyIGR0bHNQYXJhbWV0ZXJzID0gewogICAgcm9sZTogJ2F1dG8nLAogICAgZmluZ2VycHJpbnRzOiBbewogICAgICBhbGdvcml0aG06IGZwTGluZS5zcGxpdCgnICcpWzBdLAogICAgICB2YWx1ZTogZnBMaW5lLnNwbGl0KCcgJylbMV0KICAgIH1dCiAgfTsKICByZXR1cm4gZHRsc1BhcmFtZXRlcnM7Cn07CgovLyBTZXJpYWxpemVzIERUTFMgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMgPSBmdW5jdGlvbihwYXJhbXMsIHNldHVwVHlwZSkgewogIHZhciBzZHAgPSAnYT1zZXR1cDonICsgc2V0dXBUeXBlICsgJ1xyXG4nOwogIHBhcmFtcy5maW5nZXJwcmludHMuZm9yRWFjaChmdW5jdGlvbihmcCkgewogICAgc2RwICs9ICdhPWZpbmdlcnByaW50OicgKyBmcC5hbGdvcml0aG0gKyAnICcgKyBmcC52YWx1ZSArICdcclxuJzsKICB9KTsKICByZXR1cm4gc2RwOwp9OwovLyBQYXJzZXMgSUNFIGluZm9ybWF0aW9uIGZyb20gU0RQIG1lZGlhIHNlY3Rpb24gb3Igc2Vzc2lvbnBhcnQuCi8vIEZJWE1FOiBmb3IgY29uc2lzdGVuY3kgd2l0aCBvdGhlciBmdW5jdGlvbnMgdGhpcyBzaG91bGQgb25seQovLyAgIGdldCB0aGUgaWNlLXVmcmFnIGFuZCBpY2UtcHdkIGxpbmVzIGFzIGlucHV0LgpTRFBVdGlscy5nZXRJY2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBpY2VQYXJhbWV0ZXJzID0gewogICAgdXNlcm5hbWVGcmFnbWVudDogbGluZXMuZmlsdGVyKGZ1bmN0aW9uKGxpbmUpIHsKICAgICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1pY2UtdWZyYWc6JykgPT09IDA7CiAgICB9KVswXS5zdWJzdHIoMTIpLAogICAgcGFzc3dvcmQ6IGxpbmVzLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICAgIHJldHVybiBsaW5lLmluZGV4T2YoJ2E9aWNlLXB3ZDonKSA9PT0gMDsKICAgIH0pWzBdLnN1YnN0cigxMCkKICB9OwogIHJldHVybiBpY2VQYXJhbWV0ZXJzOwp9OwoKLy8gU2VyaWFsaXplcyBJQ0UgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlSWNlUGFyYW1ldGVycyA9IGZ1bmN0aW9uKHBhcmFtcykgewogIHJldHVybiAnYT1pY2UtdWZyYWc6JyArIHBhcmFtcy51c2VybmFtZUZyYWdtZW50ICsgJ1xyXG4nICsKICAgICAgJ2E9aWNlLXB3ZDonICsgcGFyYW1zLnBhc3N3b3JkICsgJ1xyXG4nOwp9OwoKLy8gUGFyc2VzIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBhbmQgcmV0dXJucyBSVENSdHBQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHsKICB2YXIgZGVzY3JpcHRpb24gPSB7CiAgICBjb2RlY3M6IFtdLAogICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICBmZWNNZWNoYW5pc21zOiBbXSwKICAgIHJ0Y3A6IFtdCiAgfTsKICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7CiAgdmFyIG1saW5lID0gbGluZXNbMF0uc3BsaXQoJyAnKTsKICBmb3IgKHZhciBpID0gMzsgaSA8IG1saW5lLmxlbmd0aDsgaSsrKSB7IC8vIGZpbmQgYWxsIGNvZGVjcyBmcm9tIG1saW5lWzMuLl0KICAgIHZhciBwdCA9IG1saW5lW2ldOwogICAgdmFyIHJ0cG1hcGxpbmUgPSBTRFBVdGlscy5tYXRjaFByZWZpeCgKICAgICAgICBtZWRpYVNlY3Rpb24sICdhPXJ0cG1hcDonICsgcHQgKyAnICcpWzBdOwogICAgaWYgKHJ0cG1hcGxpbmUpIHsKICAgICAgdmFyIGNvZGVjID0gU0RQVXRpbHMucGFyc2VSdHBNYXAocnRwbWFwbGluZSk7CiAgICAgIHZhciBmbXRwcyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1mbXRwOicgKyBwdCArICcgJyk7CiAgICAgIC8vIE9ubHkgdGhlIGZpcnN0IGE9Zm10cDo8cHQ+IGlzIGNvbnNpZGVyZWQuCiAgICAgIGNvZGVjLnBhcmFtZXRlcnMgPSBmbXRwcy5sZW5ndGggPyBTRFBVdGlscy5wYXJzZUZtdHAoZm10cHNbMF0pIDoge307CiAgICAgIGNvZGVjLnJ0Y3BGZWVkYmFjayA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1ydGNwLWZiOicgKyBwdCArICcgJykKICAgICAgICAubWFwKFNEUFV0aWxzLnBhcnNlUnRjcEZiKTsKICAgICAgZGVzY3JpcHRpb24uY29kZWNzLnB1c2goY29kZWMpOwogICAgICAvLyBwYXJzZSBGRUMgbWVjaGFuaXNtcyBmcm9tIHJ0cG1hcCBsaW5lcy4KICAgICAgc3dpdGNoIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkpIHsKICAgICAgICBjYXNlICdSRUQnOgogICAgICAgIGNhc2UgJ1VMUEZFQyc6CiAgICAgICAgICBkZXNjcmlwdGlvbi5mZWNNZWNoYW5pc21zLnB1c2goY29kZWMubmFtZS50b1VwcGVyQ2FzZSgpKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IC8vIG9ubHkgUkVEIGFuZCBVTFBGRUMgYXJlIHJlY29nbml6ZWQgYXMgRkVDIG1lY2hhbmlzbXMuCiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0KICBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPWV4dG1hcDonKS5mb3JFYWNoKGZ1bmN0aW9uKGxpbmUpIHsKICAgIGRlc2NyaXB0aW9uLmhlYWRlckV4dGVuc2lvbnMucHVzaChTRFBVdGlscy5wYXJzZUV4dG1hcChsaW5lKSk7CiAgfSk7CiAgLy8gRklYTUU6IHBhcnNlIHJ0Y3AuCiAgcmV0dXJuIGRlc2NyaXB0aW9uOwp9OwoKLy8gR2VuZXJhdGVzIHBhcnRzIG9mIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBkZXNjcmliaW5nIHRoZSBjYXBhYmlsaXRpZXMgLwovLyBwYXJhbWV0ZXJzLgpTRFBVdGlscy53cml0ZVJ0cERlc2NyaXB0aW9uID0gZnVuY3Rpb24oa2luZCwgY2FwcykgewogIHZhciBzZHAgPSAnJzsKCiAgLy8gQnVpbGQgdGhlIG1saW5lLgogIHNkcCArPSAnbT0nICsga2luZCArICcgJzsKICBzZHAgKz0gY2Fwcy5jb2RlY3MubGVuZ3RoID4gMCA/ICc5JyA6ICcwJzsgLy8gcmVqZWN0IGlmIG5vIGNvZGVjcy4KICBzZHAgKz0gJyBVRFAvVExTL1JUUC9TQVZQRiAnOwogIHNkcCArPSBjYXBzLmNvZGVjcy5tYXAoZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICAgIH0KICAgIHJldHVybiBjb2RlYy5wYXlsb2FkVHlwZTsKICB9KS5qb2luKCcgJykgKyAnXHJcbic7CgogIHNkcCArPSAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nOwogIHNkcCArPSAnYT1ydGNwOjkgSU4gSVA0IDAuMC4wLjBcclxuJzsKCiAgLy8gQWRkIGE9cnRwbWFwIGxpbmVzIGZvciBlYWNoIGNvZGVjLiBBbHNvIGZtdHAgYW5kIHJ0Y3AtZmIuCiAgY2Fwcy5jb2RlY3MuZm9yRWFjaChmdW5jdGlvbihjb2RlYykgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRwTWFwKGNvZGVjKTsKICAgIHNkcCArPSBTRFBVdGlscy53cml0ZUZtdHAoY29kZWMpOwogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRjcEZiKGNvZGVjKTsKICB9KTsKICB2YXIgbWF4cHRpbWUgPSAwOwogIGNhcHMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5tYXhwdGltZSA+IG1heHB0aW1lKSB7CiAgICAgIG1heHB0aW1lID0gY29kZWMubWF4cHRpbWU7CiAgICB9CiAgfSk7CiAgaWYgKG1heHB0aW1lID4gMCkgewogICAgc2RwICs9ICdhPW1heHB0aW1lOicgKyBtYXhwdGltZSArICdcclxuJzsKICB9CiAgc2RwICs9ICdhPXJ0Y3AtbXV4XHJcbic7CgogIGNhcHMuaGVhZGVyRXh0ZW5zaW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGV4dGVuc2lvbikgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlRXh0bWFwKGV4dGVuc2lvbik7CiAgfSk7CiAgLy8gRklYTUU6IHdyaXRlIGZlY01lY2hhbmlzbXMuCiAgcmV0dXJuIHNkcDsKfTsKCi8vIFBhcnNlcyB0aGUgU0RQIG1lZGlhIHNlY3Rpb24gYW5kIHJldHVybnMgYW4gYXJyYXkgb2YKLy8gUlRDUnRwRW5jb2RpbmdQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cEVuY29kaW5nUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikgewogIHZhciBlbmNvZGluZ1BhcmFtZXRlcnMgPSBbXTsKICB2YXIgZGVzY3JpcHRpb24gPSBTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMobWVkaWFTZWN0aW9uKTsKICB2YXIgaGFzUmVkID0gZGVzY3JpcHRpb24uZmVjTWVjaGFuaXNtcy5pbmRleE9mKCdSRUQnKSAhPT0gLTE7CiAgdmFyIGhhc1VscGZlYyA9IGRlc2NyaXB0aW9uLmZlY01lY2hhbmlzbXMuaW5kZXhPZignVUxQRkVDJykgIT09IC0xOwoKICAvLyBmaWx0ZXIgYT1zc3JjOi4uLiBjbmFtZTosIGlnbm9yZSBQbGFuQi1tc2lkCiAgdmFyIHNzcmNzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjOicpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgfSkKICAuZmlsdGVyKGZ1bmN0aW9uKHBhcnRzKSB7CiAgICByZXR1cm4gcGFydHMuYXR0cmlidXRlID09PSAnY25hbWUnOwogIH0pOwogIHZhciBwcmltYXJ5U3NyYyA9IHNzcmNzLmxlbmd0aCA+IDAgJiYgc3NyY3NbMF0uc3NyYzsKICB2YXIgc2Vjb25kYXJ5U3NyYzsKCiAgdmFyIGZsb3dzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjLWdyb3VwOkZJRCcpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICB2YXIgcGFydHMgPSBsaW5lLnNwbGl0KCcgJyk7CiAgICBwYXJ0cy5zaGlmdCgpOwogICAgcmV0dXJuIHBhcnRzLm1hcChmdW5jdGlvbihwYXJ0KSB7CiAgICAgIHJldHVybiBwYXJzZUludChwYXJ0LCAxMCk7CiAgICB9KTsKICB9KTsKICBpZiAoZmxvd3MubGVuZ3RoID4gMCAmJiBmbG93c1swXS5sZW5ndGggPiAxICYmIGZsb3dzWzBdWzBdID09PSBwcmltYXJ5U3NyYykgewogICAgc2Vjb25kYXJ5U3NyYyA9IGZsb3dzWzBdWzFdOwogIH0KCiAgZGVzY3JpcHRpb24uY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkgPT09ICdSVFgnICYmIGNvZGVjLnBhcmFtZXRlcnMuYXB0KSB7CiAgICAgIHZhciBlbmNQYXJhbSA9IHsKICAgICAgICBzc3JjOiBwcmltYXJ5U3NyYywKICAgICAgICBjb2RlY1BheWxvYWRUeXBlOiBwYXJzZUludChjb2RlYy5wYXJhbWV0ZXJzLmFwdCwgMTApLAogICAgICAgIHJ0eDogewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYwogICAgICAgIH0KICAgICAgfTsKICAgICAgZW5jb2RpbmdQYXJhbWV0ZXJzLnB1c2goZW5jUGFyYW0pOwogICAgICBpZiAoaGFzUmVkKSB7CiAgICAgICAgZW5jUGFyYW0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVuY1BhcmFtKSk7CiAgICAgICAgZW5jUGFyYW0uZmVjID0gewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYywKICAgICAgICAgIG1lY2hhbmlzbTogaGFzVWxwZmVjID8gJ3JlZCt1bHBmZWMnIDogJ3JlZCcKICAgICAgICB9OwogICAgICAgIGVuY29kaW5nUGFyYW1ldGVycy5wdXNoKGVuY1BhcmFtKTsKICAgICAgfQogICAgfQogIH0pOwogIGlmIChlbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoID09PSAwICYmIHByaW1hcnlTc3JjKSB7CiAgICBlbmNvZGluZ1BhcmFtZXRlcnMucHVzaCh7CiAgICAgIHNzcmM6IHByaW1hcnlTc3JjCiAgICB9KTsKICB9CgogIC8vIHdlIHN1cHBvcnQgYm90aCBiPUFTIGFuZCBiPVRJQVMgYnV0IGludGVycHJldCBBUyBhcyBUSUFTLgogIHZhciBiYW5kd2lkdGggPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdiPScpOwogIGlmIChiYW5kd2lkdGgubGVuZ3RoKSB7CiAgICBpZiAoYmFuZHdpZHRoWzBdLmluZGV4T2YoJ2I9VElBUzonKSA9PT0gMCkgewogICAgICBiYW5kd2lkdGggPSBwYXJzZUludChiYW5kd2lkdGhbMF0uc3Vic3RyKDcpLCAxMCk7CiAgICB9IGVsc2UgaWYgKGJhbmR3aWR0aFswXS5pbmRleE9mKCdiPUFTOicpID09PSAwKSB7CiAgICAgIGJhbmR3aWR0aCA9IHBhcnNlSW50KGJhbmR3aWR0aFswXS5zdWJzdHIoNSksIDEwKTsKICAgIH0KICAgIGVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtcykgewogICAgICBwYXJhbXMubWF4Qml0cmF0ZSA9IGJhbmR3aWR0aDsKICAgIH0pOwogIH0KICByZXR1cm4gZW5jb2RpbmdQYXJhbWV0ZXJzOwp9OwoKU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUgPSBmdW5jdGlvbigpIHsKICAvLyBGSVhNRTogc2Vzcy1pZCBzaG91bGQgYmUgYW4gTlRQIHRpbWVzdGFtcC4KICByZXR1cm4gJ3Y9MFxyXG4nICsKICAgICAgJ289dGhpc2lzYWRhcHRlcm9ydGMgODE2OTYzOTkxNTY0Njk0MzEzNyAyIElOIElQNCAxMjcuMC4wLjFcclxuJyArCiAgICAgICdzPS1cclxuJyArCiAgICAgICd0PTAgMFxyXG4nOwp9OwoKU0RQVXRpbHMud3JpdGVNZWRpYVNlY3Rpb24gPSBmdW5jdGlvbih0cmFuc2NlaXZlciwgY2FwcywgdHlwZSwgc3RyZWFtKSB7CiAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlUnRwRGVzY3JpcHRpb24odHJhbnNjZWl2ZXIua2luZCwgY2Fwcyk7CgogIC8vIE1hcCBJQ0UgcGFyYW1ldGVycyAodWZyYWcsIHB3ZCkgdG8gU0RQLgogIHNkcCArPSBTRFBVdGlscy53cml0ZUljZVBhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmdldExvY2FsUGFyYW1ldGVycygpKTsKCiAgLy8gTWFwIERUTFMgcGFyYW1ldGVycyB0byBTRFAuCiAgc2RwICs9IFNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuZ2V0TG9jYWxQYXJhbWV0ZXJzKCksCiAgICAgIHR5cGUgPT09ICdvZmZlcicgPyAnYWN0cGFzcycgOiAnYWN0aXZlJyk7CgogIHNkcCArPSAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlciAmJiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcikgewogICAgc2RwICs9ICdhPXNlbmRyZWN2XHJcbic7CiAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHsKICAgIHNkcCArPSAnYT1zZW5kb25seVxyXG4nOwogIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgIHNkcCArPSAnYT1yZWN2b25seVxyXG4nOwogIH0gZWxzZSB7CiAgICBzZHAgKz0gJ2E9aW5hY3RpdmVcclxuJzsKICB9CgogIC8vIEZJWE1FOiBmb3IgUlRYIHRoZXJlIG1pZ2h0IGJlIG11bHRpcGxlIFNTUkNzLiBOb3QgaW1wbGVtZW50ZWQgaW4gRWRnZSB5ZXQuCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlcikgewogICAgdmFyIG1zaWQgPSAnbXNpZDonICsgc3RyZWFtLmlkICsgJyAnICsKICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIudHJhY2suaWQgKyAnXHJcbic7CiAgICBzZHAgKz0gJ2E9JyArIG1zaWQ7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgICAnICcgKyBtc2lkOwogICAgaWYgKHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICAgIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICcgJyArIG1zaWQ7CiAgICAgIHNkcCArPSAnYT1zc3JjLWdyb3VwOkZJRCAnICsKICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYyArICcgJyArCiAgICAgICAgICB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICdcclxuJzsKICAgIH0KICB9CiAgLy8gRklYTUU6IHRoaXMgc2hvdWxkIGJlIHdyaXR0ZW4gYnkgd3JpdGVSdHBEZXNjcmlwdGlvbi4KICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHguc3NyYyArCiAgICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICB9CiAgcmV0dXJuIHNkcDsKfTsKCi8vIEdldHMgdGhlIGRpcmVjdGlvbiBmcm9tIHRoZSBtZWRpYVNlY3Rpb24gb3IgdGhlIHNlc3Npb25wYXJ0LgpTRFBVdGlscy5nZXREaXJlY3Rpb24gPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KSB7CiAgLy8gTG9vayBmb3Igc2VuZHJlY3YsIHNlbmRvbmx5LCByZWN2b25seSwgaW5hY3RpdmUsIGRlZmF1bHQgdG8gc2VuZHJlY3YuCiAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHsKICAgIHN3aXRjaCAobGluZXNbaV0pIHsKICAgICAgY2FzZSAnYT1zZW5kcmVjdic6CiAgICAgIGNhc2UgJ2E9c2VuZG9ubHknOgogICAgICBjYXNlICdhPXJlY3Zvbmx5JzoKICAgICAgY2FzZSAnYT1pbmFjdGl2ZSc6CiAgICAgICAgcmV0dXJuIGxpbmVzW2ldLnN1YnN0cigyKTsKICAgICAgZGVmYXVsdDoKICAgICAgICAvLyBGSVhNRTogV2hhdCBzaG91bGQgaGFwcGVuIGhlcmU/CiAgICB9CiAgfQogIGlmIChzZXNzaW9ucGFydCkgewogICAgcmV0dXJuIFNEUFV0aWxzLmdldERpcmVjdGlvbihzZXNzaW9ucGFydCk7CiAgfQogIHJldHVybiAnc2VuZHJlY3YnOwp9OwoKLy8gRXhwb3NlIHB1YmxpYyBtZXRob2RzLgptb2R1bGUuZXhwb3J0cyA9IFNEUFV0aWxzOwoKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8vIHZlcnNpb246IDAuNS4xCi8vIGRhdGU6IFR1ZSBGZWIgMDcgMjAxNyAxNjowMDozOSBHTVQrMDAwMCAoV0VUKQovLyBsaWNlbmNlOiAKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgoKKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiU3luY2hlciIsIFtdLCBmYWN0b3J5KTsKCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCWV4cG9ydHNbIlN5bmNoZXIiXSA9IGZhY3RvcnkoKTsKCWVsc2UKCQlyb290WyIiXSA9IHJvb3RbIiJdIHx8IHt9LCByb290WyIiXVsiU3luY2hlciJdID0gZmFjdG9yeSgpOwp9KSh0aGlzLCBmdW5jdGlvbigpIHsKcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXAKLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCXZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307Ci8qKioqKiovCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLwovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQovKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJaTogbW9kdWxlSWQsCi8qKioqKiovIAkJCWw6IGZhbHNlLAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAovKioqKioqLyAJCW1vZHVsZS5sID0gdHJ1ZTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8KLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7Ci8qKioqKiovCi8qKioqKiovIAkvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0Ci8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHMKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikgewovKioqKioqLyAJCWlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKLyoqKioqKi8gCQkJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsKLyoqKioqKi8gCQkJCWNvbmZpZ3VyYWJsZTogZmFsc2UsCi8qKioqKiovIAkJCQllbnVtZXJhYmxlOiB0cnVlLAovKioqKioqLyAJCQkJZ2V0OiBnZXR0ZXIKLyoqKioqKi8gCQkJfSk7Ci8qKioqKiovIAkJfQovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHsKLyoqKioqKi8gCQl2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID8KLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTsKLyoqKioqKi8gCQlfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7Ci8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKLyoqKioqKi8KLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMTYyKTsKLyoqKioqKi8gfSkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gKFsKLyogMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0ge3ZlcnNpb246ICcyLjQuMCd9OwppZih0eXBlb2YgX19lID09ICdudW1iZXInKV9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy84NiNpc3N1ZWNvbW1lbnQtMTE1NzU5MDI4CnZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aAogID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsKaWYodHlwZW9mIF9fZyA9PSAnbnVtYmVyJylfX2cgPSBnbG9iYWw7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzdG9yZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ3drcycpCiAgLCB1aWQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykKICAsIFN5bWJvbCAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLlN5bWJvbAogICwgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJzsKCnZhciAkZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obmFtZSl7CiAgcmV0dXJuIHN0b3JlW25hbWVdIHx8IChzdG9yZVtuYW1lXSA9CiAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IHVpZCkoJ1N5bWJvbC4nICsgbmFtZSkpOwp9OwoKJGV4cG9ydHMuc3RvcmUgPSBzdG9yZTsKCi8qKiovIH0pLAovKiAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHkKbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGRQICAgICAgICAgICAgID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpewogIGFuT2JqZWN0KE8pOwogIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKICBhbk9iamVjdChBdHRyaWJ1dGVzKTsKICBpZihJRThfRE9NX0RFRklORSl0cnkgewogICAgcmV0dXJuIGRQKE8sIFAsIEF0dHJpYnV0ZXMpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICBpZignZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpdGhyb3cgVHlwZUVycm9yKCdBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEnKTsKICBpZigndmFsdWUnIGluIEF0dHJpYnV0ZXMpT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZighaXNPYmplY3QoaXQpKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKICAsIGNyZWF0ZURlc2MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpID8gZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICByZXR1cm4gZFAuZihvYmplY3QsIGtleSwgY3JlYXRlRGVzYygxLCB2YWx1ZSkpOwp9IDogZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICBvYmplY3Rba2V5XSA9IHZhbHVlOwogIHJldHVybiBvYmplY3Q7Cn07CgovKioqLyB9KSwKLyogNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nOwp9OwoKLyoqKi8gfSksCi8qIDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGNvcmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGN0eCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCiAgLCBoaWRlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCiAgLCBQUk9UT1RZUEUgPSAncHJvdG90eXBlJzsKCnZhciAkZXhwb3J0ID0gZnVuY3Rpb24odHlwZSwgbmFtZSwgc291cmNlKXsKICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRgogICAgLCBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HCiAgICAsIElTX1NUQVRJQyA9IHR5cGUgJiAkZXhwb3J0LlMKICAgICwgSVNfUFJPVE8gID0gdHlwZSAmICRleHBvcnQuUAogICAgLCBJU19CSU5EICAgPSB0eXBlICYgJGV4cG9ydC5CCiAgICAsIElTX1dSQVAgICA9IHR5cGUgJiAkZXhwb3J0LlcKICAgICwgZXhwb3J0cyAgID0gSVNfR0xPQkFMID8gY29yZSA6IGNvcmVbbmFtZV0gfHwgKGNvcmVbbmFtZV0gPSB7fSkKICAgICwgZXhwUHJvdG8gID0gZXhwb3J0c1tQUk9UT1RZUEVdCiAgICAsIHRhcmdldCAgICA9IElTX0dMT0JBTCA/IGdsb2JhbCA6IElTX1NUQVRJQyA/IGdsb2JhbFtuYW1lXSA6IChnbG9iYWxbbmFtZV0gfHwge30pW1BST1RPVFlQRV0KICAgICwga2V5LCBvd24sIG91dDsKICBpZihJU19HTE9CQUwpc291cmNlID0gbmFtZTsKICBmb3Ioa2V5IGluIHNvdXJjZSl7CiAgICAvLyBjb250YWlucyBpbiBuYXRpdmUKICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIHRhcmdldFtrZXldICE9PSB1bmRlZmluZWQ7CiAgICBpZihvd24gJiYga2V5IGluIGV4cG9ydHMpY29udGludWU7CiAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZAogICAgb3V0ID0gb3duID8gdGFyZ2V0W2tleV0gOiBzb3VyY2Vba2V5XTsKICAgIC8vIHByZXZlbnQgZ2xvYmFsIHBvbGx1dGlvbiBmb3IgbmFtZXNwYWNlcwogICAgZXhwb3J0c1trZXldID0gSVNfR0xPQkFMICYmIHR5cGVvZiB0YXJnZXRba2V5XSAhPSAnZnVuY3Rpb24nID8gc291cmNlW2tleV0KICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0CiAgICA6IElTX0JJTkQgJiYgb3duID8gY3R4KG91dCwgZ2xvYmFsKQogICAgLy8gd3JhcCBnbG9iYWwgY29uc3RydWN0b3JzIGZvciBwcmV2ZW50IGNoYW5nZSB0aGVtIGluIGxpYnJhcnkKICAgIDogSVNfV1JBUCAmJiB0YXJnZXRba2V5XSA9PSBvdXQgPyAoZnVuY3Rpb24oQyl7CiAgICAgIHZhciBGID0gZnVuY3Rpb24oYSwgYiwgYyl7CiAgICAgICAgaWYodGhpcyBpbnN0YW5jZW9mIEMpewogICAgICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpewogICAgICAgICAgICBjYXNlIDA6IHJldHVybiBuZXcgQzsKICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gbmV3IEMoYSk7CiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBDKGEsIGIpOwogICAgICAgICAgfSByZXR1cm4gbmV3IEMoYSwgYiwgYyk7CiAgICAgICAgfSByZXR1cm4gQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgICBGW1BST1RPVFlQRV0gPSBDW1BST1RPVFlQRV07CiAgICAgIHJldHVybiBGOwogICAgLy8gbWFrZSBzdGF0aWMgdmVyc2lvbnMgZm9yIHByb3RvdHlwZSBtZXRob2RzCiAgICB9KShvdXQpIDogSVNfUFJPVE8gJiYgdHlwZW9mIG91dCA9PSAnZnVuY3Rpb24nID8gY3R4KEZ1bmN0aW9uLmNhbGwsIG91dCkgOiBvdXQ7CiAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUubWV0aG9kcy4lTkFNRSUKICAgIGlmKElTX1BST1RPKXsKICAgICAgKGV4cG9ydHMudmlydHVhbCB8fCAoZXhwb3J0cy52aXJ0dWFsID0ge30pKVtrZXldID0gb3V0OwogICAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUucHJvdG90eXBlLiVOQU1FJQogICAgICBpZih0eXBlICYgJGV4cG9ydC5SICYmIGV4cFByb3RvICYmICFleHBQcm90b1trZXldKWhpZGUoZXhwUHJvdG8sIGtleSwgb3V0KTsKICAgIH0KICB9Cn07Ci8vIHR5cGUgYml0bWFwCiRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkCiRleHBvcnQuRyA9IDI7ICAgLy8gZ2xvYmFsCiRleHBvcnQuUyA9IDQ7ICAgLy8gc3RhdGljCiRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG8KJGV4cG9ydC5CID0gMTY7ICAvLyBiaW5kCiRleHBvcnQuVyA9IDMyOyAgLy8gd3JhcAokZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmUKJGV4cG9ydC5SID0gMTI4OyAvLyByZWFsIHByb3RvIG1ldGhvZCBmb3IgYGxpYnJhcnlgIAptb2R1bGUuZXhwb3J0cyA9ICRleHBvcnQ7CgovKioqLyB9KSwKLyogOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDEwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMzYpOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZWZpbmVQcm9wZXJ0eSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICAgICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogICAgfQogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICAgIHJldHVybiBDb25zdHJ1Y3RvcjsKICB9Owp9KCk7CgovKioqLyB9KSwKLyogMTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjKXsKICB0cnkgewogICAgcmV0dXJuICEhZXhlYygpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn07CgovKioqLyB9KSwKLyogMTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGhhc093blByb3BlcnR5ID0ge30uaGFzT3duUHJvcGVydHk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIGtleSl7CiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoaXQsIGtleSk7Cn07CgovKioqLyB9KSwKLyogMTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzCnZhciBJT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NikKICAsIGRlZmluZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpOwp9OwoKLyoqKi8gfSksCi8qIDE0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZwp2YXIgYUZ1bmN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIHRoYXQsIGxlbmd0aCl7CiAgYUZ1bmN0aW9uKGZuKTsKICBpZih0aGF0ID09PSB1bmRlZmluZWQpcmV0dXJuIGZuOwogIHN3aXRjaChsZW5ndGgpewogICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpOwogICAgfTsKICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTsKICAgIH07CiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7CiAgICB9OwogIH0KICByZXR1cm4gZnVuY3Rpb24oLyogLi4uYXJncyAqLyl7CiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDE1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0ge307CgovKioqLyB9KSwKLyogMTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiaXRtYXAsIHZhbHVlKXsKICByZXR1cm4gewogICAgZW51bWVyYWJsZSAgOiAhKGJpdG1hcCAmIDEpLAogICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLAogICAgd3JpdGFibGUgICAgOiAhKGJpdG1hcCAmIDQpLAogICAgdmFsdWUgICAgICAgOiB2YWx1ZQogIH07Cn07CgovKioqLyB9KSwKLyogMTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjE0IC8gMTUuMi4zLjE0IE9iamVjdC5rZXlzKE8pCnZhciAka2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpOwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pewogIHJldHVybiAka2V5cyhPLCBlbnVtQnVnS2V5cyk7Cn07CgovKioqLyB9KSwKLyogMTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpOwp9OwoKLyoqKi8gfSksCi8qIDE5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5kb2N1bWVudAogIC8vIGluIG9sZCBJRSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JwogICwgaXMgPSBpc09iamVjdChkb2N1bWVudCkgJiYgaXNPYmplY3QoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307Cn07CgovKioqLyB9KSwKLyogMjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRlZiA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaGFzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIFRBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3RvU3RyaW5nVGFnJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCB0YWcsIHN0YXQpewogIGlmKGl0ICYmICFoYXMoaXQgPSBzdGF0ID8gaXQgOiBpdC5wcm90b3R5cGUsIFRBRykpZGVmKGl0LCBUQUcsIHtjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiB0YWd9KTsKfTsKCi8qKiovIH0pLAovKiAyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSkKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2UKLy8gYW5kIHRoZSBzZWNvbmQgYXJndW1lbnQgLSBmbGFnIC0gcHJlZmVycmVkIHR5cGUgaXMgYSBzdHJpbmcKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgUyl7CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gaXQ7CiAgdmFyIGZuLCB2YWw7CiAgaWYoUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIGlmKHR5cGVvZiAoZm4gPSBpdC52YWx1ZU9mKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICBpZighUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIHRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlIik7Cn07CgovKioqLyB9KSwKLyogMjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGlkID0gMAogICwgcHggPSBNYXRoLnJhbmRvbSgpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7CiAgcmV0dXJuICdTeW1ib2woJy5jb25jYXQoa2V5ID09PSB1bmRlZmluZWQgPyAnJyA6IGtleSwgJylfJywgKCsraWQgKyBweCkudG9TdHJpbmcoMzYpKTsKfTsKCi8qKiovIH0pLAovKiAyNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyA3LjIuMSBSZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGFyZ3VtZW50KQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIiArIGl0KTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSB0cnVlOwoKLyoqKi8gfSksCi8qIDI2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzaGFyZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKSgna2V5cycpCiAgLCB1aWQgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzaGFyZWRba2V5XSB8fCAoc2hhcmVkW2tleV0gPSB1aWQoa2V5KSk7Cn07CgovKioqLyB9KSwKLyogMjcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gNy4xLjQgVG9JbnRlZ2VyCnZhciBjZWlsICA9IE1hdGguY2VpbAogICwgZmxvb3IgPSBNYXRoLmZsb29yOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXNOYU4oaXQgPSAraXQpID8gMCA6IChpdCA+IDAgPyBmbG9vciA6IGNlaWwpKGl0KTsKfTsKCi8qKiovIH0pLAovKiAyOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzCm1vZHVsZS5leHBvcnRzID0gKAogICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnCikuc3BsaXQoJywnKTsKCi8qKiovIH0pLAovKiAyOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDMpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoX193ZWJwYWNrX3JlcXVpcmVfXygxOSkoJ2RpdicpLCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiAzMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXycKICAsIHN0b3JlICA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzdG9yZVtrZXldIHx8IChzdG9yZVtrZXldID0ge30pOwp9OwoKLyoqKi8gfSksCi8qIDMxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNzkpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogMzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KQp2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gT2JqZWN0KGRlZmluZWQoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAzMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfc2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc1KTsKCnZhciBfc2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jcmVhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc0KTsKCnZhciBfY3JlYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZSk7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHN1cGVyQ2xhc3MgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoc3VwZXJDbGFzcykpKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9ICgwLCBfY3JlYXRlMi5kZWZhdWx0KShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZjIuZGVmYXVsdCA/ICgwLCBfc2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7Cn07CgovKioqLyB9KSwKLyogMzQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzZWxmLCBjYWxsKSB7CiAgaWYgKCFzZWxmKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIGNhbGwgJiYgKCh0eXBlb2YgY2FsbCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6ICgwLCBfdHlwZW9mMy5kZWZhdWx0KShjYWxsKSkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOwp9OwoKLyoqKi8gfSksCi8qIDM1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQp2YXIgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBkUHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBFbXB0eSAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KICAsIFBST1RPVFlQRSAgID0gJ3Byb3RvdHlwZSc7CgovLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlCnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24oKXsKICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1ZwogIHZhciBpZnJhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KSgnaWZyYW1lJykKICAgICwgaSAgICAgID0gZW51bUJ1Z0tleXMubGVuZ3RoCiAgICAsIGx0ICAgICA9ICc8JwogICAgLCBndCAgICAgPSAnPicKICAgICwgaWZyYW1lRG9jdW1lbnQ7CiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg0MikuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsCiAgLy8gY3JlYXRlRGljdCA9IGlmcmFtZS5jb250ZW50V2luZG93Lk9iamVjdDsKICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7CiAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKICBpZnJhbWVEb2N1bWVudC5vcGVuKCk7CiAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpOwogIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7CiAgY3JlYXRlRGljdCA9IGlmcmFtZURvY3VtZW50LkY7CiAgd2hpbGUoaS0tKWRlbGV0ZSBjcmVhdGVEaWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbaV1dOwogIHJldHVybiBjcmVhdGVEaWN0KCk7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpewogIHZhciByZXN1bHQ7CiAgaWYoTyAhPT0gbnVsbCl7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7CiAgICByZXN1bHQgPSBuZXcgRW1wdHk7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gbnVsbDsKICAgIC8vIGFkZCAiX19wcm90b19fIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsCiAgICByZXN1bHRbSUVfUFJPVE9dID0gTzsKICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpOwogIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkUHMocmVzdWx0LCBQcm9wZXJ0aWVzKTsKfTsKCgovKioqLyB9KSwKLyogMzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygzNyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAzNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKXsKICByZXR1cm4gJE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKTsKfTsKCi8qKiovIH0pLAovKiAzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgTElCUkFSWSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBoaWRlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIEl0ZXJhdG9ycyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsICRpdGVyQ3JlYXRlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MikKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MykKICAsIElURVJBVE9SICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgQlVHR1kgICAgICAgICAgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSkgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YAogICwgRkZfSVRFUkFUT1IgICAgPSAnQEBpdGVyYXRvcicKICAsIEtFWVMgICAgICAgICAgID0gJ2tleXMnCiAgLCBWQUxVRVMgICAgICAgICA9ICd2YWx1ZXMnOwoKdmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKXsKICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7CiAgdmFyIGdldE1ldGhvZCA9IGZ1bmN0aW9uKGtpbmQpewogICAgaWYoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pcmV0dXJuIHByb3RvW2tpbmRdOwogICAgc3dpdGNoKGtpbmQpewogICAgICBjYXNlIEtFWVM6IHJldHVybiBmdW5jdGlvbiBrZXlzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgfTsKICB2YXIgVEFHICAgICAgICA9IE5BTUUgKyAnIEl0ZXJhdG9yJwogICAgLCBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVMKICAgICwgVkFMVUVTX0JVRyA9IGZhbHNlCiAgICAsIHByb3RvICAgICAgPSBCYXNlLnByb3RvdHlwZQogICAgLCAkbmF0aXZlICAgID0gcHJvdG9bSVRFUkFUT1JdIHx8IHByb3RvW0ZGX0lURVJBVE9SXSB8fCBERUZBVUxUICYmIHByb3RvW0RFRkFVTFRdCiAgICAsICRkZWZhdWx0ICAgPSAkbmF0aXZlIHx8IGdldE1ldGhvZChERUZBVUxUKQogICAgLCAkZW50cmllcyAgID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZAogICAgLCAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZQogICAgLCBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlOwogIC8vIEZpeCBuYXRpdmUKICBpZigkYW55TmF0aXZlKXsKICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoJGFueU5hdGl2ZS5jYWxsKG5ldyBCYXNlKSk7CiAgICBpZihJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSl7CiAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnMKICAgICAgc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JQcm90b3R5cGUsIFRBRywgdHJ1ZSk7CiAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lcwogICAgICBpZighTElCUkFSWSAmJiAhaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikpaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwogICAgfQogIH0KICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGCiAgaWYoREVGX1ZBTFVFUyAmJiAkbmF0aXZlICYmICRuYXRpdmUubmFtZSAhPT0gVkFMVUVTKXsKICAgIFZBTFVFU19CVUcgPSB0cnVlOwogICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTsKICB9CiAgLy8gRGVmaW5lIGl0ZXJhdG9yCiAgaWYoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpewogICAgaGlkZShwcm90bywgSVRFUkFUT1IsICRkZWZhdWx0KTsKICB9CiAgLy8gUGx1ZyBmb3IgbGlicmFyeQogIEl0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0OwogIEl0ZXJhdG9yc1tUQUddICA9IHJldHVyblRoaXM7CiAgaWYoREVGQVVMVCl7CiAgICBtZXRob2RzID0gewogICAgICB2YWx1ZXM6ICBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSwKICAgICAga2V5czogICAgSVNfU0VUICAgICA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLAogICAgICBlbnRyaWVzOiAkZW50cmllcwogICAgfTsKICAgIGlmKEZPUkNFRClmb3Ioa2V5IGluIG1ldGhvZHMpewogICAgICBpZighKGtleSBpbiBwcm90bykpcmVkZWZpbmUocHJvdG8sIGtleSwgbWV0aG9kc1trZXldKTsKICAgIH0gZWxzZSAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7CiAgfQogIHJldHVybiBtZXRob2RzOwp9OwoKLyoqKi8gfSksCi8qIDM5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKLy8gMTkuMS4yLjQgLyAxNS4yLjMuNiBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhX193ZWJwYWNrX3JlcXVpcmVfXygzKSwgJ09iamVjdCcsIHtkZWZpbmVQcm9wZXJ0eTogX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mfSk7CgovKioqLyB9KSwKLyogNDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg1MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA0MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTsKCi8qKiovIH0pLAovKiA0MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZG9jdW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKLyoqKi8gfSksCi8qIDQzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi45IC8gMTUuMi4zLjIgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciBoYXMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCB0b09iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBPYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihPKXsKICBPID0gdG9PYmplY3QoTyk7CiAgaWYoaGFzKE8sIElFX1BST1RPKSlyZXR1cm4gT1tJRV9QUk9UT107CiAgaWYodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcil7CiAgICByZXR1cm4gTy5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7CiAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvIDogbnVsbDsKfTsKCi8qKiovIH0pLAovKiA0NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaGFzICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIHRvSU9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCBhcnJheUluZGV4T2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKShmYWxzZSkKICAsIElFX1BST1RPICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIG5hbWVzKXsKICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKICAgICwgaSAgICAgID0gMAogICAgLCByZXN1bHQgPSBbXQogICAgLCBrZXk7CiAgZm9yKGtleSBpbiBPKWlmKGtleSAhPSBJRV9QUk9UTyloYXMoTywga2V5KSAmJiByZXN1bHQucHVzaChrZXkpOwogIC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXMKICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKWlmKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSl7CiAgICB+YXJyYXlJbmRleE9mKHJlc3VsdCwga2V5KSB8fCByZXN1bHQucHVzaChrZXkpOwogIH0KICByZXR1cm4gcmVzdWx0Owp9OwoKLyoqKi8gfSksCi8qIDQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG1vc3QgT2JqZWN0IG1ldGhvZHMgYnkgRVM2IHNob3VsZCBhY2NlcHQgcHJpbWl0aXZlcwp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKICAsIGNvcmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBmYWlscyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBleGVjKXsKICB2YXIgZm4gID0gKGNvcmUuT2JqZWN0IHx8IHt9KVtLRVldIHx8IE9iamVjdFtLRVldCiAgICAsIGV4cCA9IHt9OwogIGV4cFtLRVldID0gZXhlYyhmbik7CiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbigpeyBmbigxKTsgfSksICdPYmplY3QnLCBleHApOwp9OwoKLyoqKi8gfSksCi8qIDQ2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCi8qKiovIH0pLAovKiA0NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMTUgVG9MZW5ndGgKdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpCiAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ID4gMCA/IG1pbih0b0ludGVnZXIoaXQpLCAweDFmZmZmZmZmZmZmZmZmKSA6IDA7IC8vIHBvdygyLCA1MykgLSAxID09IDkwMDcxOTkyNTQ3NDA5OTEKfTsKCi8qKiovIH0pLAovKiA0OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIExJQlJBUlkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKICAsIHdrc0V4dCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkKICAsIGRlZmluZVByb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewogIHZhciAkU3ltYm9sID0gY29yZS5TeW1ib2wgfHwgKGNvcmUuU3ltYm9sID0gTElCUkFSWSA/IHt9IDogZ2xvYmFsLlN5bWJvbCB8fCB7fSk7CiAgaWYobmFtZS5jaGFyQXQoMCkgIT0gJ18nICYmICEobmFtZSBpbiAkU3ltYm9sKSlkZWZpbmVQcm9wZXJ0eSgkU3ltYm9sLCBuYW1lLCB7dmFsdWU6IHdrc0V4dC5mKG5hbWUpfSk7Cn07CgovKioqLyB9KSwKLyogNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTsKCi8qKiovIH0pLAovKiA1MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgJGF0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNjYpKHRydWUpOwoKLy8gMjEuMS4zLjI3IFN0cmluZy5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQpfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KShTdHJpbmcsICdTdHJpbmcnLCBmdW5jdGlvbihpdGVyYXRlZCl7CiAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4Ci8vIDIxLjEuNS4yLjEgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKfSwgZnVuY3Rpb24oKXsKICB2YXIgTyAgICAgPSB0aGlzLl90CiAgICAsIGluZGV4ID0gdGhpcy5faQogICAgLCBwb2ludDsKICBpZihpbmRleCA+PSBPLmxlbmd0aClyZXR1cm4ge3ZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWV9OwogIHBvaW50ID0gJGF0KE8sIGluZGV4KTsKICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDsKICByZXR1cm4ge3ZhbHVlOiBwb2ludCwgZG9uZTogZmFsc2V9Owp9KTsKCi8qKiovIH0pLAovKiA1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDY5KTsKdmFyIGdsb2JhbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBoaWRlICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgSXRlcmF0b3JzICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCBUT19TVFJJTkdfVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKTsKCmZvcih2YXIgY29sbGVjdGlvbnMgPSBbJ05vZGVMaXN0JywgJ0RPTVRva2VuTGlzdCcsICdNZWRpYUxpc3QnLCAnU3R5bGVTaGVldExpc3QnLCAnQ1NTUnVsZUxpc3QnXSwgaSA9IDA7IGkgPCA1OyBpKyspewogIHZhciBOQU1FICAgICAgID0gY29sbGVjdGlvbnNbaV0KICAgICwgQ29sbGVjdGlvbiA9IGdsb2JhbFtOQU1FXQogICAgLCBwcm90byAgICAgID0gQ29sbGVjdGlvbiAmJiBDb2xsZWN0aW9uLnByb3RvdHlwZTsKICBpZihwcm90byAmJiAhcHJvdG9bVE9fU1RSSU5HX1RBR10paGlkZShwcm90bywgVE9fU1RSSU5HX1RBRywgTkFNRSk7CiAgSXRlcmF0b3JzW05BTUVdID0gSXRlcmF0b3JzLkFycmF5Owp9CgovKioqLyB9KSwKLyogNTIgKi8sCi8qIDUzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjb3JlICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsICRKU09OID0gY29yZS5KU09OIHx8IChjb3JlLkpTT04gPSB7c3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeX0pOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICByZXR1cm4gJEpTT04uc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmd1bWVudHMpOwp9OwoKLyoqKi8gfSksCi8qIDU0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgoKLyoqKi8gfSksCi8qIDU1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGdldHRpbmcgdGFnIGZyb20gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KQogICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKQogIC8vIEVTMyB3cm9uZyBoZXJlCiAgLCBBUkcgPSBjb2YoZnVuY3Rpb24oKXsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJzsKCi8vIGZhbGxiYWNrIGZvciBJRTExIFNjcmlwdCBBY2Nlc3MgRGVuaWVkIGVycm9yCnZhciB0cnlHZXQgPSBmdW5jdGlvbihpdCwga2V5KXsKICB0cnkgewogICAgcmV0dXJuIGl0W2tleV07CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgdmFyIE8sIFQsIEI7CiAgcmV0dXJuIGl0ID09PSB1bmRlZmluZWQgPyAnVW5kZWZpbmVkJyA6IGl0ID09PSBudWxsID8gJ051bGwnCiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2UKICAgIDogdHlwZW9mIChUID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUQUcpKSA9PSAnc3RyaW5nJyA/IFQKICAgIC8vIGJ1aWx0aW5UYWcgY2FzZQogICAgOiBBUkcgPyBjb2YoTykKICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2sKICAgIDogKEIgPSBjb2YoTykpID09ICdPYmplY3QnICYmIHR5cGVvZiBPLmNhbGxlZSA9PSAnZnVuY3Rpb24nID8gJ0FyZ3VtZW50cycgOiBCOwp9OwoKLyoqKi8gfSksCi8qIDU2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gY29mKGl0KSA9PSAnU3RyaW5nJyA/IGl0LnNwbGl0KCcnKSA6IE9iamVjdChpdCk7Cn07CgovKioqLyB9KSwKLyogNTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHBJRSAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIGdPUEQgICAgICAgICAgID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKCmV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBnT1BEIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApewogIE8gPSB0b0lPYmplY3QoTyk7CiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwogIGlmKElFOF9ET01fREVGSU5FKXRyeSB7CiAgICByZXR1cm4gZ09QRChPLCBQKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgaWYoaGFzKE8sIFApKXJldHVybiBjcmVhdGVEZXNjKCFwSUUuZi5jYWxsKE8sIFApLCBPW1BdKTsKfTsKCi8qKiovIH0pLAovKiA1OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKLyoqKi8gfSksCi8qIDU5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9pdGVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oNzcpOwoKdmFyIF9pdGVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pdGVyYXRvcik7Cgp2YXIgX3N5bWJvbCA9IF9fd2VicGFja19yZXF1aXJlX18oNzYpOwoKdmFyIF9zeW1ib2wyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3ltYm9sKTsKCnZhciBfdHlwZW9mID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIF9pdGVyYXRvcjIuZGVmYXVsdCA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YoX2l0ZXJhdG9yMi5kZWZhdWx0KSA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG9iaik7Cn0gOiBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IF9zeW1ib2wyLmRlZmF1bHQgJiYgb2JqICE9PSBfc3ltYm9sMi5kZWZhdWx0LnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iaiA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yob2JqKTsKfTsKCi8qKiovIH0pLAovKiA2MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH07CgovKioqLyB9KSwKLyogNjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsc2UgLT4gQXJyYXkjaW5kZXhPZgovLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlcwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvTGVuZ3RoICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCB0b0luZGV4ICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY4KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihJU19JTkNMVURFUyl7CiAgcmV0dXJuIGZ1bmN0aW9uKCR0aGlzLCBlbCwgZnJvbUluZGV4KXsKICAgIHZhciBPICAgICAgPSB0b0lPYmplY3QoJHRoaXMpCiAgICAgICwgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpCiAgICAgICwgaW5kZXggID0gdG9JbmRleChmcm9tSW5kZXgsIGxlbmd0aCkKICAgICAgLCB2YWx1ZTsKICAgIC8vIEFycmF5I2luY2x1ZGVzIHVzZXMgU2FtZVZhbHVlWmVybyBlcXVhbGl0eSBhbGdvcml0aG0KICAgIGlmKElTX0lOQ0xVREVTICYmIGVsICE9IGVsKXdoaWxlKGxlbmd0aCA+IGluZGV4KXsKICAgICAgdmFsdWUgPSBPW2luZGV4KytdOwogICAgICBpZih2YWx1ZSAhPSB2YWx1ZSlyZXR1cm4gdHJ1ZTsKICAgIC8vIEFycmF5I3RvSW5kZXggaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3QKICAgIH0gZWxzZSBmb3IoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKWlmKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pewogICAgICBpZihPW2luZGV4XSA9PT0gZWwpcmV0dXJuIElTX0lOQ0xVREVTIHx8IGluZGV4IHx8IDA7CiAgICB9IHJldHVybiAhSVNfSU5DTFVERVMgJiYgLTE7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgY3JlYXRlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KQogICwgZGVzY3JpcHRvciAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTsKCi8vIDI1LjEuMi4xLjEgJUl0ZXJhdG9yUHJvdG90eXBlJVtAQGl0ZXJhdG9yXSgpCl9fd2VicGFja19yZXF1aXJlX18oNikoSXRlcmF0b3JQcm90b3R5cGUsIF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJyksIGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9KTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpewogIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwge25leHQ6IGRlc2NyaXB0b3IoMSwgbmV4dCl9KTsKICBzZXRUb1N0cmluZ1RhZyhDb25zdHJ1Y3RvciwgTkFNRSArICcgSXRlcmF0b3InKTsKfTsKCi8qKiovIH0pLAovKiA2MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGRvbmUsIHZhbHVlKXsKICByZXR1cm4ge3ZhbHVlOiB2YWx1ZSwgZG9uZTogISFkb25lfTsKfTsKCi8qKiovIH0pLAovKiA2NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIGdldEtleXMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcyl7CiAgYW5PYmplY3QoTyk7CiAgdmFyIGtleXMgICA9IGdldEtleXMoUHJvcGVydGllcykKICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgKICAgICwgaSA9IDAKICAgICwgUDsKICB3aGlsZShsZW5ndGggPiBpKWRQLmYoTywgUCA9IGtleXNbaSsrXSwgUHJvcGVydGllc1tQXSk7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjcgLyAxNS4yLjMuNCBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKQp2YXIgJGtleXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBoaWRkZW5LZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKE8pewogIHJldHVybiAka2V5cyhPLCBoaWRkZW5LZXlzKTsKfTsKCi8qKiovIH0pLAovKiA2NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykKICAsIGRlZmluZWQgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwovLyB0cnVlICAtPiBTdHJpbmcjYXQKLy8gZmFsc2UgLT4gU3RyaW5nI2NvZGVQb2ludEF0Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oVE9fU1RSSU5HKXsKICByZXR1cm4gZnVuY3Rpb24odGhhdCwgcG9zKXsKICAgIHZhciBzID0gU3RyaW5nKGRlZmluZWQodGhhdCkpCiAgICAgICwgaSA9IHRvSW50ZWdlcihwb3MpCiAgICAgICwgbCA9IHMubGVuZ3RoCiAgICAgICwgYSwgYjsKICAgIGlmKGkgPCAwIHx8IGkgPj0gbClyZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7CiAgICBhID0gcy5jaGFyQ29kZUF0KGkpOwogICAgcmV0dXJuIGEgPCAweGQ4MDAgfHwgYSA+IDB4ZGJmZiB8fCBpICsgMSA9PT0gbCB8fCAoYiA9IHMuY2hhckNvZGVBdChpICsgMSkpIDwgMHhkYzAwIHx8IGIgPiAweGRmZmYKICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGEKICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGludm9rZSAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODgpCiAgLCBodG1sICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKQogICwgY2VsICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSkKICAsIGdsb2JhbCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBzZXRUYXNrICAgICAgICAgICAgPSBnbG9iYWwuc2V0SW1tZWRpYXRlCiAgLCBjbGVhclRhc2sgICAgICAgICAgPSBnbG9iYWwuY2xlYXJJbW1lZGlhdGUKICAsIE1lc3NhZ2VDaGFubmVsICAgICA9IGdsb2JhbC5NZXNzYWdlQ2hhbm5lbAogICwgY291bnRlciAgICAgICAgICAgID0gMAogICwgcXVldWUgICAgICAgICAgICAgID0ge30KICAsIE9OUkVBRFlTVEFURUNIQU5HRSA9ICdvbnJlYWR5c3RhdGVjaGFuZ2UnCiAgLCBkZWZlciwgY2hhbm5lbCwgcG9ydDsKdmFyIHJ1biA9IGZ1bmN0aW9uKCl7CiAgdmFyIGlkID0gK3RoaXM7CiAgaWYocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKXsKICAgIHZhciBmbiA9IHF1ZXVlW2lkXTsKICAgIGRlbGV0ZSBxdWV1ZVtpZF07CiAgICBmbigpOwogIH0KfTsKdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpewogIHJ1bi5jYWxsKGV2ZW50LmRhdGEpOwp9OwovLyBOb2RlLmpzIDAuOSsgJiBJRTEwKyBoYXMgc2V0SW1tZWRpYXRlLCBvdGhlcndpc2U6CmlmKCFzZXRUYXNrIHx8ICFjbGVhclRhc2spewogIHNldFRhc2sgPSBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoZm4pewogICAgdmFyIGFyZ3MgPSBbXSwgaSA9IDE7CiAgICB3aGlsZShhcmd1bWVudHMubGVuZ3RoID4gaSlhcmdzLnB1c2goYXJndW1lbnRzW2krK10pOwogICAgcXVldWVbKytjb3VudGVyXSA9IGZ1bmN0aW9uKCl7CiAgICAgIGludm9rZSh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pLCBhcmdzKTsKICAgIH07CiAgICBkZWZlcihjb3VudGVyKTsKICAgIHJldHVybiBjb3VudGVyOwogIH07CiAgY2xlYXJUYXNrID0gZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaWQpewogICAgZGVsZXRlIHF1ZXVlW2lkXTsKICB9OwogIC8vIE5vZGUuanMgMC44LQogIGlmKF9fd2VicGFja19yZXF1aXJlX18oMTgpKHByb2Nlc3MpID09ICdwcm9jZXNzJyl7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgcHJvY2Vzcy5uZXh0VGljayhjdHgocnVuLCBpZCwgMSkpOwogICAgfTsKICAvLyBCcm93c2VycyB3aXRoIE1lc3NhZ2VDaGFubmVsLCBpbmNsdWRlcyBXZWJXb3JrZXJzCiAgfSBlbHNlIGlmKE1lc3NhZ2VDaGFubmVsKXsKICAgIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWw7CiAgICBwb3J0ICAgID0gY2hhbm5lbC5wb3J0MjsKICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gbGlzdGVuZXI7CiAgICBkZWZlciA9IGN0eChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTsKICAvLyBCcm93c2VycyB3aXRoIHBvc3RNZXNzYWdlLCBza2lwIFdlYldvcmtlcnMKICAvLyBJRTggaGFzIHBvc3RNZXNzYWdlLCBidXQgaXQncyBzeW5jICYgdHlwZW9mIGl0cyBwb3N0TWVzc2FnZSBpcyAnb2JqZWN0JwogIH0gZWxzZSBpZihnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lciAmJiB0eXBlb2YgcG9zdE1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJyAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShpZCArICcnLCAnKicpOwogICAgfTsKICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbGlzdGVuZXIsIGZhbHNlKTsKICAvLyBJRTgtCiAgfSBlbHNlIGlmKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKXsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBodG1sLmFwcGVuZENoaWxkKGNlbCgnc2NyaXB0JykpW09OUkVBRFlTVEFURUNIQU5HRV0gPSBmdW5jdGlvbigpewogICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7CiAgICAgICAgcnVuLmNhbGwoaWQpOwogICAgICB9OwogICAgfTsKICAvLyBSZXN0IG9sZCBicm93c2VycwogIH0gZWxzZSB7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgc2V0VGltZW91dChjdHgocnVuLCBpZCwgMSksIDApOwogICAgfTsKICB9Cn0KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2V0OiAgIHNldFRhc2ssCiAgY2xlYXI6IGNsZWFyVGFzawp9OwoKLyoqKi8gfSksCi8qIDY4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KQogICwgbWF4ICAgICAgID0gTWF0aC5tYXgKICAsIG1pbiAgICAgICA9IE1hdGgubWluOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGluZGV4LCBsZW5ndGgpewogIGluZGV4ID0gdG9JbnRlZ2VyKGluZGV4KTsKICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbihpbmRleCwgbGVuZ3RoKTsKfTsKCi8qKiovIH0pLAovKiA2OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgYWRkVG9VbnNjb3BhYmxlcyA9IF9fd2VicGFja19yZXF1aXJlX18oNjApCiAgLCBzdGVwICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MykKICAsIEl0ZXJhdG9ycyAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQogICwgdG9JT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwoKLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKQovLyAyMi4xLjMuMTMgQXJyYXkucHJvdG90eXBlLmtleXMoKQovLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpCi8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzgpKEFycmF5LCAnQXJyYXknLCBmdW5jdGlvbihpdGVyYXRlZCwga2luZCl7CiAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4CiAgdGhpcy5fayA9IGtpbmQ7ICAgICAgICAgICAgICAgIC8vIGtpbmQKLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpCn0sIGZ1bmN0aW9uKCl7CiAgdmFyIE8gICAgID0gdGhpcy5fdAogICAgLCBraW5kICA9IHRoaXMuX2sKICAgICwgaW5kZXggPSB0aGlzLl9pKys7CiAgaWYoIU8gfHwgaW5kZXggPj0gTy5sZW5ndGgpewogICAgdGhpcy5fdCA9IHVuZGVmaW5lZDsKICAgIHJldHVybiBzdGVwKDEpOwogIH0KICBpZihraW5kID09ICdrZXlzJyAgKXJldHVybiBzdGVwKDAsIGluZGV4KTsKICBpZihraW5kID09ICd2YWx1ZXMnKXJldHVybiBzdGVwKDAsIE9baW5kZXhdKTsKICByZXR1cm4gc3RlcCgwLCBbaW5kZXgsIE9baW5kZXhdXSk7Cn0sICd2YWx1ZXMnKTsKCi8vIGFyZ3VtZW50c0xpc3RbQEBpdGVyYXRvcl0gaXMgJUFycmF5UHJvdG9fdmFsdWVzJSAoOS40LjQuNiwgOS40LjQuNykKSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTsKCmFkZFRvVW5zY29wYWJsZXMoJ2tleXMnKTsKYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7CmFkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTsKCi8qKiovIH0pLAovKiA3MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDcxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODIpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIE1FVEEgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykoJ21ldGEnKQogICwgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBoYXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBzZXREZXNjICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaWQgICAgICAgPSAwOwp2YXIgaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZSB8fCBmdW5jdGlvbigpewogIHJldHVybiB0cnVlOwp9Owp2YXIgRlJFRVpFID0gIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGlzRXh0ZW5zaWJsZShPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe30pKTsKfSk7CnZhciBzZXRNZXRhID0gZnVuY3Rpb24oaXQpewogIHNldERlc2MoaXQsIE1FVEEsIHt2YWx1ZTogewogICAgaTogJ08nICsgKytpZCwgLy8gb2JqZWN0IElECiAgICB3OiB7fSAgICAgICAgICAvLyB3ZWFrIGNvbGxlY3Rpb25zIElEcwogIH19KTsKfTsKdmFyIGZhc3RLZXkgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICAvLyByZXR1cm4gcHJpbWl0aXZlIHdpdGggcHJlZml4CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnID8gaXQgOiAodHlwZW9mIGl0ID09ICdzdHJpbmcnID8gJ1MnIDogJ1AnKSArIGl0OwogIGlmKCFoYXMoaXQsIE1FVEEpKXsKICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0CiAgICBpZighaXNFeHRlbnNpYmxlKGl0KSlyZXR1cm4gJ0YnOwogICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGEKICAgIGlmKCFjcmVhdGUpcmV0dXJuICdFJzsKICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhCiAgICBzZXRNZXRhKGl0KTsKICAvLyByZXR1cm4gb2JqZWN0IElECiAgfSByZXR1cm4gaXRbTUVUQV0uaTsKfTsKdmFyIGdldFdlYWsgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICBpZighaGFzKGl0LCBNRVRBKSl7CiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdAogICAgaWYoIWlzRXh0ZW5zaWJsZShpdCkpcmV0dXJuIHRydWU7CiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YQogICAgaWYoIWNyZWF0ZSlyZXR1cm4gZmFsc2U7CiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YQogICAgc2V0TWV0YShpdCk7CiAgLy8gcmV0dXJuIGhhc2ggd2VhayBjb2xsZWN0aW9ucyBJRHMKICB9IHJldHVybiBpdFtNRVRBXS53Owp9OwovLyBhZGQgbWV0YWRhdGEgb24gZnJlZXplLWZhbWlseSBtZXRob2RzIGNhbGxpbmcKdmFyIG9uRnJlZXplID0gZnVuY3Rpb24oaXQpewogIGlmKEZSRUVaRSAmJiBtZXRhLk5FRUQgJiYgaXNFeHRlbnNpYmxlKGl0KSAmJiAhaGFzKGl0LCBNRVRBKSlzZXRNZXRhKGl0KTsKICByZXR1cm4gaXQ7Cn07CnZhciBtZXRhID0gbW9kdWxlLmV4cG9ydHMgPSB7CiAgS0VZOiAgICAgIE1FVEEsCiAgTkVFRDogICAgIGZhbHNlLAogIGZhc3RLZXk6ICBmYXN0S2V5LAogIGdldFdlYWs6ICBnZXRXZWFrLAogIG9uRnJlZXplOiBvbkZyZWV6ZQp9OwoKLyoqKi8gfSksCi8qIDczICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjbGFzc29mICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KQogICwgSVRFUkFUT1IgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgSXRlcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCAhPSB1bmRlZmluZWQpcmV0dXJuIGl0W0lURVJBVE9SXQogICAgfHwgaXRbJ0BAaXRlcmF0b3InXQogICAgfHwgSXRlcmF0b3JzW2NsYXNzb2YoaXQpXTsKfTsKCi8qKiovIH0pLAovKiA3NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDc4KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODEpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDg0KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAwKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGUoUCwgRCl7CiAgcmV0dXJuICRPYmplY3QuY3JlYXRlKFAsIEQpOwp9OwoKLyoqKi8gfSksCi8qIDc5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAxKTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5nZXRQcm90b3R5cGVPZjsKCi8qKiovIH0pLAovKiA4MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMik7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Qua2V5czsKCi8qKiovIH0pLAovKiA4MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMyk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Quc2V0UHJvdG90eXBlT2Y7CgovKioqLyB9KSwKLyogODIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg1NCk7Cl9fd2VicGFja19yZXF1aXJlX18oNTApOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKX193ZWJwYWNrX3JlcXVpcmVfXygxMDQpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuUHJvbWlzZTsKCi8qKiovIH0pLAovKiA4MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNSk7Cl9fd2VicGFja19yZXF1aXJlX18oNTQpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNik7Cl9fd2VicGFja19yZXF1aXJlX18oMTA3KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLlN5bWJvbDsKCi8qKiovIH0pLAovKiA4NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkuZignaXRlcmF0b3InKTsKCi8qKiovIH0pLAovKiA4NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSwgZm9yYmlkZGVuRmllbGQpewogIGlmKCEoaXQgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikgfHwgKGZvcmJpZGRlbkZpZWxkICE9PSB1bmRlZmluZWQgJiYgZm9yYmlkZGVuRmllbGQgaW4gaXQpKXsKICAgIHRocm93IFR5cGVFcnJvcihuYW1lICsgJzogaW5jb3JyZWN0IGludm9jYXRpb24hJyk7CiAgfSByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogODYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gYWxsIGVudW1lcmFibGUgb2JqZWN0IGtleXMsIGluY2x1ZGVzIHN5bWJvbHMKdmFyIGdldEtleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QUyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHZhciByZXN1bHQgICAgID0gZ2V0S2V5cyhpdCkKICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZjsKICBpZihnZXRTeW1ib2xzKXsKICAgIHZhciBzeW1ib2xzID0gZ2V0U3ltYm9scyhpdCkKICAgICAgLCBpc0VudW0gID0gcElFLmYKICAgICAgLCBpICAgICAgID0gMAogICAgICAsIGtleTsKICAgIHdoaWxlKHN5bWJvbHMubGVuZ3RoID4gaSlpZihpc0VudW0uY2FsbChpdCwga2V5ID0gc3ltYm9sc1tpKytdKSlyZXN1bHQucHVzaChrZXkpOwogIH0gcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiA4NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgY2FsbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkxKQogICwgaXNBcnJheUl0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg5KQogICwgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCB0b0xlbmd0aCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCBnZXRJdGVyRm4gICA9IF9fd2VicGFja19yZXF1aXJlX18oNzMpCiAgLCBCUkVBSyAgICAgICA9IHt9CiAgLCBSRVRVUk4gICAgICA9IHt9Owp2YXIgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXRlcmFibGUsIGVudHJpZXMsIGZuLCB0aGF0LCBJVEVSQVRPUil7CiAgdmFyIGl0ZXJGbiA9IElURVJBVE9SID8gZnVuY3Rpb24oKXsgcmV0dXJuIGl0ZXJhYmxlOyB9IDogZ2V0SXRlckZuKGl0ZXJhYmxlKQogICAgLCBmICAgICAgPSBjdHgoZm4sIHRoYXQsIGVudHJpZXMgPyAyIDogMSkKICAgICwgaW5kZXggID0gMAogICAgLCBsZW5ndGgsIHN0ZXAsIGl0ZXJhdG9yLCByZXN1bHQ7CiAgaWYodHlwZW9mIGl0ZXJGbiAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdGVyYWJsZSArICcgaXMgbm90IGl0ZXJhYmxlIScpOwogIC8vIGZhc3QgY2FzZSBmb3IgYXJyYXlzIHdpdGggZGVmYXVsdCBpdGVyYXRvcgogIGlmKGlzQXJyYXlJdGVyKGl0ZXJGbikpZm9yKGxlbmd0aCA9IHRvTGVuZ3RoKGl0ZXJhYmxlLmxlbmd0aCk7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKXsKICAgIHJlc3VsdCA9IGVudHJpZXMgPyBmKGFuT2JqZWN0KHN0ZXAgPSBpdGVyYWJsZVtpbmRleF0pWzBdLCBzdGVwWzFdKSA6IGYoaXRlcmFibGVbaW5kZXhdKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9IGVsc2UgZm9yKGl0ZXJhdG9yID0gaXRlckZuLmNhbGwoaXRlcmFibGUpOyAhKHN0ZXAgPSBpdGVyYXRvci5uZXh0KCkpLmRvbmU7ICl7CiAgICByZXN1bHQgPSBjYWxsKGl0ZXJhdG9yLCBmLCBzdGVwLnZhbHVlLCBlbnRyaWVzKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9Cn07CmV4cG9ydHMuQlJFQUsgID0gQlJFQUs7CmV4cG9ydHMuUkVUVVJOID0gUkVUVVJOOwoKLyoqKi8gfSksCi8qIDg4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGZhc3QgYXBwbHksIGh0dHA6Ly9qc3BlcmYubG5raXQuY29tL2Zhc3QtYXBwbHkvNQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCBhcmdzLCB0aGF0KXsKICB2YXIgdW4gPSB0aGF0ID09PSB1bmRlZmluZWQ7CiAgc3dpdGNoKGFyZ3MubGVuZ3RoKXsKICAgIGNhc2UgMDogcmV0dXJuIHVuID8gZm4oKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQpOwogICAgY2FzZSAxOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0pOwogICAgY2FzZSAyOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0pOwogICAgY2FzZSAzOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pOwogICAgY2FzZSA0OiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pOwogIH0gcmV0dXJuICAgICAgICAgICAgICBmbi5hcHBseSh0aGF0LCBhcmdzKTsKfTsKCi8qKiovIH0pLAovKiA4OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBjaGVjayBvbiBkZWZhdWx0IEFycmF5IGl0ZXJhdG9yCnZhciBJdGVyYXRvcnMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsIElURVJBVE9SICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpCiAgLCBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b1tJVEVSQVRPUl0gPT09IGl0KTsKfTsKCi8qKiovIH0pLAovKiA5MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjIuMiBJc0FycmF5KGFyZ3VtZW50KQp2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7Cm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5KGFyZyl7CiAgcmV0dXJuIGNvZihhcmcpID09ICdBcnJheSc7Cn07CgovKioqLyB9KSwKLyogOTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gY2FsbCBzb21ldGhpbmcgb24gaXRlcmF0b3Igc3RlcCB3aXRoIHNhZmUgY2xvc2luZyBvbiBlcnJvcgp2YXIgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhdG9yLCBmbiwgdmFsdWUsIGVudHJpZXMpewogIHRyeSB7CiAgICByZXR1cm4gZW50cmllcyA/IGZuKGFuT2JqZWN0KHZhbHVlKVswXSwgdmFsdWVbMV0pIDogZm4odmFsdWUpOwogIC8vIDcuNC42IEl0ZXJhdG9yQ2xvc2UoaXRlcmF0b3IsIGNvbXBsZXRpb24pCiAgfSBjYXRjaChlKXsKICAgIHZhciByZXQgPSBpdGVyYXRvclsncmV0dXJuJ107CiAgICBpZihyZXQgIT09IHVuZGVmaW5lZClhbk9iamVjdChyZXQuY2FsbChpdGVyYXRvcikpOwogICAgdGhyb3cgZTsKICB9Cn07CgovKioqLyB9KSwKLyogOTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIElURVJBVE9SICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJykKICAsIFNBRkVfQ0xPU0lORyA9IGZhbHNlOwoKdHJ5IHsKICB2YXIgcml0ZXIgPSBbN11bSVRFUkFUT1JdKCk7CiAgcml0ZXJbJ3JldHVybiddID0gZnVuY3Rpb24oKXsgU0FGRV9DTE9TSU5HID0gdHJ1ZTsgfTsKICBBcnJheS5mcm9tKHJpdGVyLCBmdW5jdGlvbigpeyB0aHJvdyAyOyB9KTsKfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjLCBza2lwQ2xvc2luZyl7CiAgaWYoIXNraXBDbG9zaW5nICYmICFTQUZFX0NMT1NJTkcpcmV0dXJuIGZhbHNlOwogIHZhciBzYWZlID0gZmFsc2U7CiAgdHJ5IHsKICAgIHZhciBhcnIgID0gWzddCiAgICAgICwgaXRlciA9IGFycltJVEVSQVRPUl0oKTsKICAgIGl0ZXIubmV4dCA9IGZ1bmN0aW9uKCl7IHJldHVybiB7ZG9uZTogc2FmZSA9IHRydWV9OyB9OwogICAgYXJyW0lURVJBVE9SXSA9IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyOyB9OwogICAgZXhlYyhhcnIpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICByZXR1cm4gc2FmZTsKfTsKCi8qKiovIH0pLAovKiA5MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2V0S2V5cyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykKICAsIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgZWwpewogIHZhciBPICAgICAgPSB0b0lPYmplY3Qob2JqZWN0KQogICAgLCBrZXlzICAgPSBnZXRLZXlzKE8pCiAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCiAgICAsIGluZGV4ICA9IDAKICAgICwga2V5OwogIHdoaWxlKGxlbmd0aCA+IGluZGV4KWlmKE9ba2V5ID0ga2V5c1tpbmRleCsrXV0gPT09IGVsKXJldHVybiBrZXk7Cn07CgovKioqLyB9KSwKLyogOTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIG1hY3JvdGFzayA9IF9fd2VicGFja19yZXF1aXJlX18oNjcpLnNldAogICwgT2JzZXJ2ZXIgID0gZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIKICAsIHByb2Nlc3MgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBQcm9taXNlICAgPSBnbG9iYWwuUHJvbWlzZQogICwgaXNOb2RlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkocHJvY2VzcykgPT0gJ3Byb2Nlc3MnOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpewogIHZhciBoZWFkLCBsYXN0LCBub3RpZnk7CgogIHZhciBmbHVzaCA9IGZ1bmN0aW9uKCl7CiAgICB2YXIgcGFyZW50LCBmbjsKICAgIGlmKGlzTm9kZSAmJiAocGFyZW50ID0gcHJvY2Vzcy5kb21haW4pKXBhcmVudC5leGl0KCk7CiAgICB3aGlsZShoZWFkKXsKICAgICAgZm4gICA9IGhlYWQuZm47CiAgICAgIGhlYWQgPSBoZWFkLm5leHQ7CiAgICAgIHRyeSB7CiAgICAgICAgZm4oKTsKICAgICAgfSBjYXRjaChlKXsKICAgICAgICBpZihoZWFkKW5vdGlmeSgpOwogICAgICAgIGVsc2UgbGFzdCA9IHVuZGVmaW5lZDsKICAgICAgICB0aHJvdyBlOwogICAgICB9CiAgICB9IGxhc3QgPSB1bmRlZmluZWQ7CiAgICBpZihwYXJlbnQpcGFyZW50LmVudGVyKCk7CiAgfTsKCiAgLy8gTm9kZS5qcwogIGlmKGlzTm9kZSl7CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBwcm9jZXNzLm5leHRUaWNrKGZsdXNoKTsKICAgIH07CiAgLy8gYnJvd3NlcnMgd2l0aCBNdXRhdGlvbk9ic2VydmVyCiAgfSBlbHNlIGlmKE9ic2VydmVyKXsKICAgIHZhciB0b2dnbGUgPSB0cnVlCiAgICAgICwgbm9kZSAgID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpOwogICAgbmV3IE9ic2VydmVyKGZsdXNoKS5vYnNlcnZlKG5vZGUsIHtjaGFyYWN0ZXJEYXRhOiB0cnVlfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBub2RlLmRhdGEgPSB0b2dnbGUgPSAhdG9nZ2xlOwogICAgfTsKICAvLyBlbnZpcm9ubWVudHMgd2l0aCBtYXliZSBub24tY29tcGxldGVseSBjb3JyZWN0LCBidXQgZXhpc3RlbnQgUHJvbWlzZQogIH0gZWxzZSBpZihQcm9taXNlICYmIFByb21pc2UucmVzb2x2ZSl7CiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpOwogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgcHJvbWlzZS50aGVuKGZsdXNoKTsKICAgIH07CiAgLy8gZm9yIG90aGVyIGVudmlyb25tZW50cyAtIG1hY3JvdGFzayBiYXNlZCBvbjoKICAvLyAtIHNldEltbWVkaWF0ZQogIC8vIC0gTWVzc2FnZUNoYW5uZWwKICAvLyAtIHdpbmRvdy5wb3N0TWVzc2FnCiAgLy8gLSBvbnJlYWR5c3RhdGVjaGFuZ2UKICAvLyAtIHNldFRpbWVvdXQKICB9IGVsc2UgewogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgLy8gc3RyYW5nZSBJRSArIHdlYnBhY2sgZGV2IHNlcnZlciBidWcgLSB1c2UgLmNhbGwoZ2xvYmFsKQogICAgICBtYWNyb3Rhc2suY2FsbChnbG9iYWwsIGZsdXNoKTsKICAgIH07CiAgfQoKICByZXR1cm4gZnVuY3Rpb24oZm4pewogICAgdmFyIHRhc2sgPSB7Zm46IGZuLCBuZXh0OiB1bmRlZmluZWR9OwogICAgaWYobGFzdClsYXN0Lm5leHQgPSB0YXNrOwogICAgaWYoIWhlYWQpewogICAgICBoZWFkID0gdGFzazsKICAgICAgbm90aWZ5KCk7CiAgICB9IGxhc3QgPSB0YXNrOwogIH07Cn07CgovKioqLyB9KSwKLyogOTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsbGJhY2sgZm9yIElFMTEgYnVnZ3kgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgd2l0aCBpZnJhbWUgYW5kIHdpbmRvdwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIGdPUE4gICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjUpLmYKICAsIHRvU3RyaW5nICA9IHt9LnRvU3RyaW5nOwoKdmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMKICA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdykgOiBbXTsKCnZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uKGl0KXsKICB0cnkgewogICAgcmV0dXJuIGdPUE4oaXQpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gd2luZG93TmFtZXMuc2xpY2UoKTsKICB9Cn07Cgptb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCl7CiAgcmV0dXJuIHdpbmRvd05hbWVzICYmIHRvU3RyaW5nLmNhbGwoaXQpID09ICdbb2JqZWN0IFdpbmRvd10nID8gZ2V0V2luZG93TmFtZXMoaXQpIDogZ09QTih0b0lPYmplY3QoaXQpKTsKfTsKCgovKioqLyB9KSwKLyogOTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGhpZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHRhcmdldCwgc3JjLCBzYWZlKXsKICBmb3IodmFyIGtleSBpbiBzcmMpewogICAgaWYoc2FmZSAmJiB0YXJnZXRba2V5XSl0YXJnZXRba2V5XSA9IHNyY1trZXldOwogICAgZWxzZSBoaWRlKHRhcmdldCwga2V5LCBzcmNba2V5XSk7CiAgfSByZXR1cm4gdGFyZ2V0Owp9OwoKLyoqKi8gfSksCi8qIDk3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFdvcmtzIHdpdGggX19wcm90b19fIG9ubHkuIE9sZCB2OCBjYW4ndCB3b3JrIHdpdGggbnVsbCBwcm90byBvYmplY3RzLgovKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqLwp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CnZhciBjaGVjayA9IGZ1bmN0aW9uKE8sIHByb3RvKXsKICBhbk9iamVjdChPKTsKICBpZighaXNPYmplY3QocHJvdG8pICYmIHByb3RvICE9PSBudWxsKXRocm93IFR5cGVFcnJvcihwcm90byArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7Cn07Cm1vZHVsZS5leHBvcnRzID0gewogIHNldDogT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8ICgnX19wcm90b19fJyBpbiB7fSA/IC8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAgIGZ1bmN0aW9uKHRlc3QsIGJ1Z2d5LCBzZXQpewogICAgICB0cnkgewogICAgICAgIHNldCA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpKEZ1bmN0aW9uLmNhbGwsIF9fd2VicGFja19yZXF1aXJlX18oNTcpLmYoT2JqZWN0LnByb3RvdHlwZSwgJ19fcHJvdG9fXycpLnNldCwgMik7CiAgICAgICAgc2V0KHRlc3QsIFtdKTsKICAgICAgICBidWdneSA9ICEodGVzdCBpbnN0YW5jZW9mIEFycmF5KTsKICAgICAgfSBjYXRjaChlKXsgYnVnZ3kgPSB0cnVlOyB9CiAgICAgIHJldHVybiBmdW5jdGlvbiBzZXRQcm90b3R5cGVPZihPLCBwcm90byl7CiAgICAgICAgY2hlY2soTywgcHJvdG8pOwogICAgICAgIGlmKGJ1Z2d5KU8uX19wcm90b19fID0gcHJvdG87CiAgICAgICAgZWxzZSBzZXQoTywgcHJvdG8pOwogICAgICAgIHJldHVybiBPOwogICAgICB9OwogICAgfSh7fSwgZmFsc2UpIDogdW5kZWZpbmVkKSwKICBjaGVjazogY2hlY2sKfTsKCi8qKiovIH0pLAovKiA5OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZ2xvYmFsICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGRQICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgREVTQ1JJUFRPUlMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpCiAgLCBTUEVDSUVTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZKXsKICB2YXIgQyA9IHR5cGVvZiBjb3JlW0tFWV0gPT0gJ2Z1bmN0aW9uJyA/IGNvcmVbS0VZXSA6IGdsb2JhbFtLRVldOwogIGlmKERFU0NSSVBUT1JTICYmIEMgJiYgIUNbU1BFQ0lFU10pZFAuZihDLCBTUEVDSUVTLCB7CiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9CiAgfSk7Cn07CgovKioqLyB9KSwKLyogOTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpCnZhciBhbk9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBhRnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgU1BFQ0lFUyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnc3BlY2llcycpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE8sIEQpewogIHZhciBDID0gYW5PYmplY3QoTykuY29uc3RydWN0b3IsIFM7CiAgcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBEIDogYUZ1bmN0aW9uKFMpOwp9OwoKLyoqKi8gfSksCi8qIDEwMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0Jywge2NyZWF0ZTogX193ZWJwYWNrX3JlcXVpcmVfXygzNSl9KTsKCi8qKiovIH0pLAovKiAxMDEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjkgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciB0b09iamVjdCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Myk7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KSgnZ2V0UHJvdG90eXBlT2YnLCBmdW5jdGlvbigpewogIHJldHVybiBmdW5jdGlvbiBnZXRQcm90b3R5cGVPZihpdCl7CiAgICByZXR1cm4gJGdldFByb3RvdHlwZU9mKHRvT2JqZWN0KGl0KSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4xNCBPYmplY3Qua2V5cyhPKQp2YXIgdG9PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGtleXMgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCl9fd2VicGFja19yZXF1aXJlX18oNDUpKCdrZXlzJywgZnVuY3Rpb24oKXsKICByZXR1cm4gZnVuY3Rpb24ga2V5cyhpdCl7CiAgICByZXR1cm4gJGtleXModG9PYmplY3QoaXQpKTsKICB9Owp9KTsKCi8qKiovIH0pLAovKiAxMDMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjE5IE9iamVjdC5zZXRQcm90b3R5cGVPZihPLCBwcm90bykKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwokZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtzZXRQcm90b3R5cGVPZjogX193ZWJwYWNrX3JlcXVpcmVfXyg5Nykuc2V0fSk7CgovKioqLyB9KSwKLyogMTA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBMSUJSQVJZICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgZ2xvYmFsICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGNsYXNzb2YgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTUpCiAgLCAkZXhwb3J0ICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCBpc09iamVjdCAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhRnVuY3Rpb24gICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgYW5JbnN0YW5jZSAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NSkKICAsIGZvck9mICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODcpCiAgLCBzcGVjaWVzQ29uc3RydWN0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KQogICwgdGFzayAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Nykuc2V0CiAgLCBtaWNyb3Rhc2sgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk0KSgpCiAgLCBQUk9NSVNFICAgICAgICAgICAgPSAnUHJvbWlzZScKICAsIFR5cGVFcnJvciAgICAgICAgICA9IGdsb2JhbC5UeXBlRXJyb3IKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCAkUHJvbWlzZSAgICAgICAgICAgPSBnbG9iYWxbUFJPTUlTRV0KICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBpc05vZGUgICAgICAgICAgICAgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJwogICwgZW1wdHkgICAgICAgICAgICAgID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfQogICwgSW50ZXJuYWwsIEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSwgV3JhcHBlcjsKCnZhciBVU0VfTkFUSVZFID0gISFmdW5jdGlvbigpewogIHRyeSB7CiAgICAvLyBjb3JyZWN0IHN1YmNsYXNzaW5nIHdpdGggQEBzcGVjaWVzIHN1cHBvcnQKICAgIHZhciBwcm9taXNlICAgICA9ICRQcm9taXNlLnJlc29sdmUoMSkKICAgICAgLCBGYWtlUHJvbWlzZSA9IChwcm9taXNlLmNvbnN0cnVjdG9yID0ge30pW19fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKV0gPSBmdW5jdGlvbihleGVjKXsgZXhlYyhlbXB0eSwgZW1wdHkpOyB9OwogICAgLy8gdW5oYW5kbGVkIHJlamVjdGlvbnMgdHJhY2tpbmcgc3VwcG9ydCwgTm9kZUpTIFByb21pc2Ugd2l0aG91dCBpdCBmYWlscyBAQHNwZWNpZXMgdGVzdAogICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKSAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2U7CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9KCk7CgovLyBoZWxwZXJzCnZhciBzYW1lQ29uc3RydWN0b3IgPSBmdW5jdGlvbihhLCBiKXsKICAvLyB3aXRoIGxpYnJhcnkgd3JhcHBlciBzcGVjaWFsIGNhc2UKICByZXR1cm4gYSA9PT0gYiB8fCBhID09PSAkUHJvbWlzZSAmJiBiID09PSBXcmFwcGVyOwp9Owp2YXIgaXNUaGVuYWJsZSA9IGZ1bmN0aW9uKGl0KXsKICB2YXIgdGhlbjsKICByZXR1cm4gaXNPYmplY3QoaXQpICYmIHR5cGVvZiAodGhlbiA9IGl0LnRoZW4pID09ICdmdW5jdGlvbicgPyB0aGVuIDogZmFsc2U7Cn07CnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewogIHJldHVybiBzYW1lQ29uc3RydWN0b3IoJFByb21pc2UsIEMpCiAgICA/IG5ldyBQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgOiBuZXcgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5KEMpOwp9Owp2YXIgUHJvbWlzZUNhcGFiaWxpdHkgPSBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbihDKXsKICB2YXIgcmVzb2x2ZSwgcmVqZWN0OwogIHRoaXMucHJvbWlzZSA9IG5ldyBDKGZ1bmN0aW9uKCQkcmVzb2x2ZSwgJCRyZWplY3QpewogICAgaWYocmVzb2x2ZSAhPT0gdW5kZWZpbmVkIHx8IHJlamVjdCAhPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcignQmFkIFByb21pc2UgY29uc3RydWN0b3InKTsKICAgIHJlc29sdmUgPSAkJHJlc29sdmU7CiAgICByZWplY3QgID0gJCRyZWplY3Q7CiAgfSk7CiAgdGhpcy5yZXNvbHZlID0gYUZ1bmN0aW9uKHJlc29sdmUpOwogIHRoaXMucmVqZWN0ICA9IGFGdW5jdGlvbihyZWplY3QpOwp9Owp2YXIgcGVyZm9ybSA9IGZ1bmN0aW9uKGV4ZWMpewogIHRyeSB7CiAgICBleGVjKCk7CiAgfSBjYXRjaChlKXsKICAgIHJldHVybiB7ZXJyb3I6IGV9OwogIH0KfTsKdmFyIG5vdGlmeSA9IGZ1bmN0aW9uKHByb21pc2UsIGlzUmVqZWN0KXsKICBpZihwcm9taXNlLl9uKXJldHVybjsKICBwcm9taXNlLl9uID0gdHJ1ZTsKICB2YXIgY2hhaW4gPSBwcm9taXNlLl9jOwogIG1pY3JvdGFzayhmdW5jdGlvbigpewogICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgogICAgICAsIG9rICAgID0gcHJvbWlzZS5fcyA9PSAxCiAgICAgICwgaSAgICAgPSAwOwogICAgdmFyIHJ1biA9IGZ1bmN0aW9uKHJlYWN0aW9uKXsKICAgICAgdmFyIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbAogICAgICAgICwgcmVzb2x2ZSA9IHJlYWN0aW9uLnJlc29sdmUKICAgICAgICAsIHJlamVjdCAgPSByZWFjdGlvbi5yZWplY3QKICAgICAgICAsIGRvbWFpbiAgPSByZWFjdGlvbi5kb21haW4KICAgICAgICAsIHJlc3VsdCwgdGhlbjsKICAgICAgdHJ5IHsKICAgICAgICBpZihoYW5kbGVyKXsKICAgICAgICAgIGlmKCFvayl7CiAgICAgICAgICAgIGlmKHByb21pc2UuX2ggPT0gMilvbkhhbmRsZVVuaGFuZGxlZChwcm9taXNlKTsKICAgICAgICAgICAgcHJvbWlzZS5faCA9IDE7CiAgICAgICAgICB9CiAgICAgICAgICBpZihoYW5kbGVyID09PSB0cnVlKXJlc3VsdCA9IHZhbHVlOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZW50ZXIoKTsKICAgICAgICAgICAgcmVzdWx0ID0gaGFuZGxlcih2YWx1ZSk7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZXhpdCgpOwogICAgICAgICAgfQogICAgICAgICAgaWYocmVzdWx0ID09PSByZWFjdGlvbi5wcm9taXNlKXsKICAgICAgICAgICAgcmVqZWN0KFR5cGVFcnJvcignUHJvbWlzZS1jaGFpbiBjeWNsZScpKTsKICAgICAgICAgIH0gZWxzZSBpZih0aGVuID0gaXNUaGVuYWJsZShyZXN1bHQpKXsKICAgICAgICAgICAgdGhlbi5jYWxsKHJlc3VsdCwgcmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgICAgIH0gZWxzZSByZXNvbHZlKHJlc3VsdCk7CiAgICAgICAgfSBlbHNlIHJlamVjdCh2YWx1ZSk7CiAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgcmVqZWN0KGUpOwogICAgICB9CiAgICB9OwogICAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSlydW4oY2hhaW5baSsrXSk7IC8vIHZhcmlhYmxlIGxlbmd0aCAtIGNhbid0IHVzZSBmb3JFYWNoCiAgICBwcm9taXNlLl9jID0gW107CiAgICBwcm9taXNlLl9uID0gZmFsc2U7CiAgICBpZihpc1JlamVjdCAmJiAhcHJvbWlzZS5faClvblVuaGFuZGxlZChwcm9taXNlKTsKICB9KTsKfTsKdmFyIG9uVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YKICAgICAgLCBhYnJ1cHQsIGhhbmRsZXIsIGNvbnNvbGU7CiAgICBpZihpc1VuaGFuZGxlZChwcm9taXNlKSl7CiAgICAgIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgICBpZihpc05vZGUpewogICAgICAgICAgcHJvY2Vzcy5lbWl0KCd1bmhhbmRsZWRSZWplY3Rpb24nLCB2YWx1ZSwgcHJvbWlzZSk7CiAgICAgICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub251bmhhbmRsZWRyZWplY3Rpb24pewogICAgICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiB2YWx1ZX0pOwogICAgICAgIH0gZWxzZSBpZigoY29uc29sZSA9IGdsb2JhbC5jb25zb2xlKSAmJiBjb25zb2xlLmVycm9yKXsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbicsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBCcm93c2VycyBzaG91bGQgbm90IHRyaWdnZXIgYHJlamVjdGlvbkhhbmRsZWRgIGV2ZW50IGlmIGl0IHdhcyBoYW5kbGVkIGhlcmUsIE5vZGVKUyAtIHNob3VsZAogICAgICBwcm9taXNlLl9oID0gaXNOb2RlIHx8IGlzVW5oYW5kbGVkKHByb21pc2UpID8gMiA6IDE7CiAgICB9IHByb21pc2UuX2EgPSB1bmRlZmluZWQ7CiAgICBpZihhYnJ1cHQpdGhyb3cgYWJydXB0LmVycm9yOwogIH0pOwp9Owp2YXIgaXNVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKICBpZihwcm9taXNlLl9oID09IDEpcmV0dXJuIGZhbHNlOwogIHZhciBjaGFpbiA9IHByb21pc2UuX2EgfHwgcHJvbWlzZS5fYwogICAgLCBpICAgICA9IDAKICAgICwgcmVhY3Rpb247CiAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSl7CiAgICByZWFjdGlvbiA9IGNoYWluW2krK107CiAgICBpZihyZWFjdGlvbi5mYWlsIHx8ICFpc1VuaGFuZGxlZChyZWFjdGlvbi5wcm9taXNlKSlyZXR1cm4gZmFsc2U7CiAgfSByZXR1cm4gdHJ1ZTsKfTsKdmFyIG9uSGFuZGxlVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciBoYW5kbGVyOwogICAgaWYoaXNOb2RlKXsKICAgICAgcHJvY2Vzcy5lbWl0KCdyZWplY3Rpb25IYW5kbGVkJywgcHJvbWlzZSk7CiAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnJlamVjdGlvbmhhbmRsZWQpewogICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHByb21pc2UuX3Z9KTsKICAgIH0KICB9KTsKfTsKdmFyICRyZWplY3QgPSBmdW5jdGlvbih2YWx1ZSl7CiAgdmFyIHByb21pc2UgPSB0aGlzOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHByb21pc2UuX3YgPSB2YWx1ZTsKICBwcm9taXNlLl9zID0gMjsKICBpZighcHJvbWlzZS5fYSlwcm9taXNlLl9hID0gcHJvbWlzZS5fYy5zbGljZSgpOwogIG5vdGlmeShwcm9taXNlLCB0cnVlKTsKfTsKdmFyICRyZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpewogIHZhciBwcm9taXNlID0gdGhpcwogICAgLCB0aGVuOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHRyeSB7CiAgICBpZihwcm9taXNlID09PSB2YWx1ZSl0aHJvdyBUeXBlRXJyb3IoIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmIik7CiAgICBpZih0aGVuID0gaXNUaGVuYWJsZSh2YWx1ZSkpewogICAgICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKICAgICAgICB2YXIgd3JhcHBlciA9IHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfTsgLy8gd3JhcAogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGVuLmNhbGwodmFsdWUsIGN0eCgkcmVzb2x2ZSwgd3JhcHBlciwgMSksIGN0eCgkcmVqZWN0LCB3cmFwcGVyLCAxKSk7CiAgICAgICAgfSBjYXRjaChlKXsKICAgICAgICAgICRyZWplY3QuY2FsbCh3cmFwcGVyLCBlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgcHJvbWlzZS5fdiA9IHZhbHVlOwogICAgICBwcm9taXNlLl9zID0gMTsKICAgICAgbm90aWZ5KHByb21pc2UsIGZhbHNlKTsKICAgIH0KICB9IGNhdGNoKGUpewogICAgJHJlamVjdC5jYWxsKHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfSwgZSk7IC8vIHdyYXAKICB9Cn07CgovLyBjb25zdHJ1Y3RvciBwb2x5ZmlsbAppZighVVNFX05BVElWRSl7CiAgLy8gMjUuNC4zLjEgUHJvbWlzZShleGVjdXRvcikKICAkUHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpewogICAgYW5JbnN0YW5jZSh0aGlzLCAkUHJvbWlzZSwgUFJPTUlTRSwgJ19oJyk7CiAgICBhRnVuY3Rpb24oZXhlY3V0b3IpOwogICAgSW50ZXJuYWwuY2FsbCh0aGlzKTsKICAgIHRyeSB7CiAgICAgIGV4ZWN1dG9yKGN0eCgkcmVzb2x2ZSwgdGhpcywgMSksIGN0eCgkcmVqZWN0LCB0aGlzLCAxKSk7CiAgICB9IGNhdGNoKGVycil7CiAgICAgICRyZWplY3QuY2FsbCh0aGlzLCBlcnIpOwogICAgfQogIH07CiAgSW50ZXJuYWwgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKICAgIHRoaXMuX2MgPSBbXTsgICAgICAgICAgICAgLy8gPC0gYXdhaXRpbmcgcmVhY3Rpb25zCiAgICB0aGlzLl9hID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIGNoZWNrZWQgaW4gaXNVbmhhbmRsZWQgcmVhY3Rpb25zCiAgICB0aGlzLl9zID0gMDsgICAgICAgICAgICAgIC8vIDwtIHN0YXRlCiAgICB0aGlzLl9kID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIGRvbmUKICAgIHRoaXMuX3YgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gdmFsdWUKICAgIHRoaXMuX2ggPSAwOyAgICAgICAgICAgICAgLy8gPC0gcmVqZWN0aW9uIHN0YXRlLCAwIC0gZGVmYXVsdCwgMSAtIGhhbmRsZWQsIDIgLSB1bmhhbmRsZWQKICAgIHRoaXMuX24gPSBmYWxzZTsgICAgICAgICAgLy8gPC0gbm90aWZ5CiAgfTsKICBJbnRlcm5hbC5wcm90b3R5cGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KSgkUHJvbWlzZS5wcm90b3R5cGUsIHsKICAgIC8vIDI1LjQuNS4zIFByb21pc2UucHJvdG90eXBlLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpCiAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKXsKICAgICAgdmFyIHJlYWN0aW9uICAgID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsICRQcm9taXNlKSk7CiAgICAgIHJlYWN0aW9uLm9rICAgICA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PSAnZnVuY3Rpb24nID8gb25GdWxmaWxsZWQgOiB0cnVlOwogICAgICByZWFjdGlvbi5mYWlsICAgPSB0eXBlb2Ygb25SZWplY3RlZCA9PSAnZnVuY3Rpb24nICYmIG9uUmVqZWN0ZWQ7CiAgICAgIHJlYWN0aW9uLmRvbWFpbiA9IGlzTm9kZSA/IHByb2Nlc3MuZG9tYWluIDogdW5kZWZpbmVkOwogICAgICB0aGlzLl9jLnB1c2gocmVhY3Rpb24pOwogICAgICBpZih0aGlzLl9hKXRoaXMuX2EucHVzaChyZWFjdGlvbik7CiAgICAgIGlmKHRoaXMuX3Mpbm90aWZ5KHRoaXMsIGZhbHNlKTsKICAgICAgcmV0dXJuIHJlYWN0aW9uLnByb21pc2U7CiAgICB9LAogICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2gob25SZWplY3RlZCkKICAgICdjYXRjaCc6IGZ1bmN0aW9uKG9uUmVqZWN0ZWQpewogICAgICByZXR1cm4gdGhpcy50aGVuKHVuZGVmaW5lZCwgb25SZWplY3RlZCk7CiAgICB9CiAgfSk7CiAgUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbigpewogICAgdmFyIHByb21pc2UgID0gbmV3IEludGVybmFsOwogICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTsKICAgIHRoaXMucmVzb2x2ZSA9IGN0eCgkcmVzb2x2ZSwgcHJvbWlzZSwgMSk7CiAgICB0aGlzLnJlamVjdCAgPSBjdHgoJHJlamVjdCwgcHJvbWlzZSwgMSk7CiAgfTsKfQoKJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1Byb21pc2U6ICRQcm9taXNlfSk7Cl9fd2VicGFja19yZXF1aXJlX18oMjEpKCRQcm9taXNlLCBQUk9NSVNFKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg5OCkoUFJPTUlTRSk7CldyYXBwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApW1BST01JU0VdOwoKLy8gc3RhdGljcwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCBQUk9NSVNFLCB7CiAgLy8gMjUuNC40LjUgUHJvbWlzZS5yZWplY3QocikKICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyKXsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlamVjdCAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgICAkJHJlamVjdChyKTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQp9KTsKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoTElCUkFSWSB8fCAhVVNFX05BVElWRSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuNiBQcm9taXNlLnJlc29sdmUoeCkKICByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKHgpewogICAgLy8gaW5zdGFuY2VvZiBpbnN0ZWFkIG9mIGludGVybmFsIHNsb3QgY2hlY2sgYmVjYXVzZSB3ZSBzaG91bGQgZml4IGl0IHdpdGhvdXQgcmVwbGFjZW1lbnQgbmF0aXZlIFByb21pc2UgY29yZQogICAgaWYoeCBpbnN0YW5jZW9mICRQcm9taXNlICYmIHNhbWVDb25zdHJ1Y3Rvcih4LmNvbnN0cnVjdG9yLCB0aGlzKSlyZXR1cm4geDsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlc29sdmUgID0gY2FwYWJpbGl0eS5yZXNvbHZlOwogICAgJCRyZXNvbHZlKHgpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoVVNFX05BVElWRSAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fKDkyKShmdW5jdGlvbihpdGVyKXsKICAkUHJvbWlzZS5hbGwoaXRlcilbJ2NhdGNoJ10oZW1wdHkpOwp9KSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuMSBQcm9taXNlLmFsbChpdGVyYWJsZSkKICBhbGw6IGZ1bmN0aW9uIGFsbChpdGVyYWJsZSl7CiAgICB2YXIgQyAgICAgICAgICA9IHRoaXMKICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKICAgICAgLCByZXNvbHZlICAgID0gY2FwYWJpbGl0eS5yZXNvbHZlCiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwogICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgdmFyIHZhbHVlcyAgICA9IFtdCiAgICAgICAgLCBpbmRleCAgICAgPSAwCiAgICAgICAgLCByZW1haW5pbmcgPSAxOwogICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2UpewogICAgICAgIHZhciAkaW5kZXggICAgICAgID0gaW5kZXgrKwogICAgICAgICAgLCBhbHJlYWR5Q2FsbGVkID0gZmFsc2U7CiAgICAgICAgdmFsdWVzLnB1c2godW5kZWZpbmVkKTsKICAgICAgICByZW1haW5pbmcrKzsKICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgICBpZihhbHJlYWR5Q2FsbGVkKXJldHVybjsKICAgICAgICAgIGFscmVhZHlDYWxsZWQgID0gdHJ1ZTsKICAgICAgICAgIHZhbHVlc1skaW5kZXhdID0gdmFsdWU7CiAgICAgICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgfSk7CiAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9LAogIC8vIDI1LjQuNC40IFByb21pc2UucmFjZShpdGVyYWJsZSkKICByYWNlOiBmdW5jdGlvbiByYWNlKGl0ZXJhYmxlKXsKICAgIHZhciBDICAgICAgICAgID0gdGhpcwogICAgICAsIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgICAsIHJlamVjdCAgICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oY2FwYWJpbGl0eS5yZXNvbHZlLCByZWplY3QpOwogICAgICB9KTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwoKLyoqKi8gfSksCi8qIDEwNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyBFQ01BU2NyaXB0IDYgc3ltYm9scyBzaGltCnZhciBnbG9iYWwgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIERFU0NSSVBUT1JTICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBNRVRBICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpLktFWQogICwgJGZhaWxzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKQogICwgc2hhcmVkICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgdWlkICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKQogICwgd2tzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpCiAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCiAgLCB3a3NEZWZpbmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDgpCiAgLCBrZXlPZiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTMpCiAgLCBlbnVtS2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODYpCiAgLCBpc0FycmF5ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTApCiAgLCBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIF9jcmVhdGUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSkKICAsIGdPUE5FeHQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NSkKICAsICRHT1BEICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NykKICAsICREUCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgJGtleXMgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QRCAgICAgICAgICAgPSAkR09QRC5mCiAgLCBkUCAgICAgICAgICAgICA9ICREUC5mCiAgLCBnT1BOICAgICAgICAgICA9IGdPUE5FeHQuZgogICwgJFN5bWJvbCAgICAgICAgPSBnbG9iYWwuU3ltYm9sCiAgLCAkSlNPTiAgICAgICAgICA9IGdsb2JhbC5KU09OCiAgLCBfc3RyaW5naWZ5ICAgICA9ICRKU09OICYmICRKU09OLnN0cmluZ2lmeQogICwgUFJPVE9UWVBFICAgICAgPSAncHJvdG90eXBlJwogICwgSElEREVOICAgICAgICAgPSB3a3MoJ19oaWRkZW4nKQogICwgVE9fUFJJTUlUSVZFICAgPSB3a3MoJ3RvUHJpbWl0aXZlJykKICAsIGlzRW51bSAgICAgICAgID0ge30ucHJvcGVydHlJc0VudW1lcmFibGUKICAsIFN5bWJvbFJlZ2lzdHJ5ID0gc2hhcmVkKCdzeW1ib2wtcmVnaXN0cnknKQogICwgQWxsU3ltYm9scyAgICAgPSBzaGFyZWQoJ3N5bWJvbHMnKQogICwgT1BTeW1ib2xzICAgICAgPSBzaGFyZWQoJ29wLXN5bWJvbHMnKQogICwgT2JqZWN0UHJvdG8gICAgPSBPYmplY3RbUFJPVE9UWVBFXQogICwgVVNFX05BVElWRSAgICAgPSB0eXBlb2YgJFN5bWJvbCA9PSAnZnVuY3Rpb24nCiAgLCBRT2JqZWN0ICAgICAgICA9IGdsb2JhbC5RT2JqZWN0OwovLyBEb24ndCB1c2Ugc2V0dGVycyBpbiBRdCBTY3JpcHQsIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8xNzMKdmFyIHNldHRlciA9ICFRT2JqZWN0IHx8ICFRT2JqZWN0W1BST1RPVFlQRV0gfHwgIVFPYmplY3RbUFJPVE9UWVBFXS5maW5kQ2hpbGQ7CgovLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODcKdmFyIHNldFN5bWJvbERlc2MgPSBERVNDUklQVE9SUyAmJiAkZmFpbHMoZnVuY3Rpb24oKXsKICByZXR1cm4gX2NyZWF0ZShkUCh7fSwgJ2EnLCB7CiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBkUCh0aGlzLCAnYScsIHt2YWx1ZTogN30pLmE7IH0KICB9KSkuYSAhPSA3Owp9KSA/IGZ1bmN0aW9uKGl0LCBrZXksIEQpewogIHZhciBwcm90b0Rlc2MgPSBnT1BEKE9iamVjdFByb3RvLCBrZXkpOwogIGlmKHByb3RvRGVzYylkZWxldGUgT2JqZWN0UHJvdG9ba2V5XTsKICBkUChpdCwga2V5LCBEKTsKICBpZihwcm90b0Rlc2MgJiYgaXQgIT09IE9iamVjdFByb3RvKWRQKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7Cn0gOiBkUDsKCnZhciB3cmFwID0gZnVuY3Rpb24odGFnKXsKICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pOwogIHN5bS5fayA9IHRhZzsKICByZXR1cm4gc3ltOwp9OwoKdmFyIGlzU3ltYm9sID0gVVNFX05BVElWRSAmJiB0eXBlb2YgJFN5bWJvbC5pdGVyYXRvciA9PSAnc3ltYm9sJyA/IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnOwp9IDogZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCBpbnN0YW5jZW9mICRTeW1ib2w7Cn07Cgp2YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCl7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvKSRkZWZpbmVQcm9wZXJ0eShPUFN5bWJvbHMsIGtleSwgRCk7CiAgYW5PYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgYW5PYmplY3QoRCk7CiAgaWYoaGFzKEFsbFN5bWJvbHMsIGtleSkpewogICAgaWYoIUQuZW51bWVyYWJsZSl7CiAgICAgIGlmKCFoYXMoaXQsIEhJRERFTikpZFAoaXQsIEhJRERFTiwgY3JlYXRlRGVzYygxLCB7fSkpOwogICAgICBpdFtISURERU5dW2tleV0gPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgaWYoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSlpdFtISURERU5dW2tleV0gPSBmYWxzZTsKICAgICAgRCA9IF9jcmVhdGUoRCwge2VudW1lcmFibGU6IGNyZWF0ZURlc2MoMCwgZmFsc2UpfSk7CiAgICB9IHJldHVybiBzZXRTeW1ib2xEZXNjKGl0LCBrZXksIEQpOwogIH0gcmV0dXJuIGRQKGl0LCBrZXksIEQpOwp9Owp2YXIgJGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKGl0LCBQKXsKICBhbk9iamVjdChpdCk7CiAgdmFyIGtleXMgPSBlbnVtS2V5cyhQID0gdG9JT2JqZWN0KFApKQogICAgLCBpICAgID0gMAogICAgLCBsID0ga2V5cy5sZW5ndGgKICAgICwga2V5OwogIHdoaWxlKGwgPiBpKSRkZWZpbmVQcm9wZXJ0eShpdCwga2V5ID0ga2V5c1tpKytdLCBQW2tleV0pOwogIHJldHVybiBpdDsKfTsKdmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaXQsIFApewogIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfY3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9jcmVhdGUoaXQpLCBQKTsKfTsKdmFyICRwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IGZ1bmN0aW9uIHByb3BlcnR5SXNFbnVtZXJhYmxlKGtleSl7CiAgdmFyIEUgPSBpc0VudW0uY2FsbCh0aGlzLCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKTsKICBpZih0aGlzID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSlyZXR1cm4gZmFsc2U7CiAgcmV0dXJuIEUgfHwgIWhhcyh0aGlzLCBrZXkpIHx8ICFoYXMoQWxsU3ltYm9scywga2V5KSB8fCBoYXModGhpcywgSElEREVOKSAmJiB0aGlzW0hJRERFTl1ba2V5XSA/IEUgOiB0cnVlOwp9Owp2YXIgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICBpdCAgPSB0b0lPYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKXJldHVybjsKICB2YXIgRCA9IGdPUEQoaXQsIGtleSk7CiAgaWYoRCAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKUQuZW51bWVyYWJsZSA9IHRydWU7CiAgcmV0dXJuIEQ7Cn07CnZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpewogIHZhciBuYW1lcyAgPSBnT1BOKHRvSU9iamVjdChpdCkpCiAgICAsIHJlc3VsdCA9IFtdCiAgICAsIGkgICAgICA9IDAKICAgICwga2V5OwogIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewogICAgaWYoIWhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiBrZXkgIT0gSElEREVOICYmIGtleSAhPSBNRVRBKXJlc3VsdC5wdXNoKGtleSk7CiAgfSByZXR1cm4gcmVzdWx0Owp9Owp2YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCl7CiAgdmFyIElTX09QICA9IGl0ID09PSBPYmplY3RQcm90bwogICAgLCBuYW1lcyAgPSBnT1BOKElTX09QID8gT1BTeW1ib2xzIDogdG9JT2JqZWN0KGl0KSkKICAgICwgcmVzdWx0ID0gW10KICAgICwgaSAgICAgID0gMAogICAgLCBrZXk7CiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7CiAgICBpZihoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYgKElTX09QID8gaGFzKE9iamVjdFByb3RvLCBrZXkpIDogdHJ1ZSkpcmVzdWx0LnB1c2goQWxsU3ltYm9sc1trZXldKTsKICB9IHJldHVybiByZXN1bHQ7Cn07CgovLyAxOS40LjEuMSBTeW1ib2woW2Rlc2NyaXB0aW9uXSkKaWYoIVVTRV9OQVRJVkUpewogICRTeW1ib2wgPSBmdW5jdGlvbiBTeW1ib2woKXsKICAgIGlmKHRoaXMgaW5zdGFuY2VvZiAkU3ltYm9sKXRocm93IFR5cGVFcnJvcignU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIScpOwogICAgdmFyIHRhZyA9IHVpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7CiAgICB2YXIgJHNldCA9IGZ1bmN0aW9uKHZhbHVlKXsKICAgICAgaWYodGhpcyA9PT0gT2JqZWN0UHJvdG8pJHNldC5jYWxsKE9QU3ltYm9scywgdmFsdWUpOwogICAgICBpZihoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKXRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7CiAgICAgIHNldFN5bWJvbERlc2ModGhpcywgdGFnLCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7CiAgICB9OwogICAgaWYoREVTQ1JJUFRPUlMgJiYgc2V0dGVyKXNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0fSk7CiAgICByZXR1cm4gd3JhcCh0YWcpOwogIH07CiAgcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEVdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpewogICAgcmV0dXJuIHRoaXMuX2s7CiAgfSk7CgogICRHT1BELmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwogICREUC5mICAgPSAkZGVmaW5lUHJvcGVydHk7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg2NSkuZiA9IGdPUE5FeHQuZiA9ICRnZXRPd25Qcm9wZXJ0eU5hbWVzOwogIF9fd2VicGFja19yZXF1aXJlX18oNDEpLmYgID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlOwogIF9fd2VicGFja19yZXF1aXJlX18oNTgpLmYgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKICBpZihERVNDUklQVE9SUyAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygyNSkpewogICAgcmVkZWZpbmUoT2JqZWN0UHJvdG8sICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsICRwcm9wZXJ0eUlzRW51bWVyYWJsZSwgdHJ1ZSk7CiAgfQoKICB3a3NFeHQuZiA9IGZ1bmN0aW9uKG5hbWUpewogICAgcmV0dXJuIHdyYXAod2tzKG5hbWUpKTsKICB9Cn0KCiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtTeW1ib2w6ICRTeW1ib2x9KTsKCmZvcih2YXIgc3ltYm9scyA9ICgKICAvLyAxOS40LjIuMiwgMTkuNC4yLjMsIDE5LjQuMi40LCAxOS40LjIuNiwgMTkuNC4yLjgsIDE5LjQuMi45LCAxOS40LjIuMTAsIDE5LjQuMi4xMSwgMTkuNC4yLjEyLCAxOS40LjIuMTMsIDE5LjQuMi4xNAogICdoYXNJbnN0YW5jZSxpc0NvbmNhdFNwcmVhZGFibGUsaXRlcmF0b3IsbWF0Y2gscmVwbGFjZSxzZWFyY2gsc3BlY2llcyxzcGxpdCx0b1ByaW1pdGl2ZSx0b1N0cmluZ1RhZyx1bnNjb3BhYmxlcycKKS5zcGxpdCgnLCcpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzKHN5bWJvbHNbaSsrXSk7Cgpmb3IodmFyIHN5bWJvbHMgPSAka2V5cyh3a3Muc3RvcmUpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzRGVmaW5lKHN5bWJvbHNbaSsrXSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywgewogIC8vIDE5LjQuMi4xIFN5bWJvbC5mb3Ioa2V5KQogICdmb3InOiBmdW5jdGlvbihrZXkpewogICAgcmV0dXJuIGhhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKQogICAgICA/IFN5bWJvbFJlZ2lzdHJ5W2tleV0KICAgICAgOiBTeW1ib2xSZWdpc3RyeVtrZXldID0gJFN5bWJvbChrZXkpOwogIH0sCiAgLy8gMTkuNC4yLjUgU3ltYm9sLmtleUZvcihzeW0pCiAga2V5Rm9yOiBmdW5jdGlvbiBrZXlGb3Ioa2V5KXsKICAgIGlmKGlzU3ltYm9sKGtleSkpcmV0dXJuIGtleU9mKFN5bWJvbFJlZ2lzdHJ5LCBrZXkpOwogICAgdGhyb3cgVHlwZUVycm9yKGtleSArICcgaXMgbm90IGEgc3ltYm9sIScpOwogIH0sCiAgdXNlU2V0dGVyOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSB0cnVlOyB9LAogIHVzZVNpbXBsZTogZnVuY3Rpb24oKXsgc2V0dGVyID0gZmFsc2U7IH0KfSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnT2JqZWN0JywgewogIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKICBjcmVhdGU6ICRjcmVhdGUsCiAgLy8gMTkuMS4yLjQgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCiAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSwKICAvLyAxOS4xLjIuMyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKQogIGRlZmluZVByb3BlcnRpZXM6ICRkZWZpbmVQcm9wZXJ0aWVzLAogIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkKICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsCiAgLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcywKICAvLyAxOS4xLjIuOCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKE8pCiAgZ2V0T3duUHJvcGVydHlTeW1ib2xzOiAkZ2V0T3duUHJvcGVydHlTeW1ib2xzCn0pOwoKLy8gMjQuMy4yIEpTT04uc3RyaW5naWZ5KHZhbHVlIFssIHJlcGxhY2VyIFssIHNwYWNlXV0pCiRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbigpewogIHZhciBTID0gJFN5bWJvbCgpOwogIC8vIE1TIEVkZ2UgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIHt9CiAgLy8gV2ViS2l0IGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyBudWxsCiAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHMKICByZXR1cm4gX3N0cmluZ2lmeShbU10pICE9ICdbbnVsbF0nIHx8IF9zdHJpbmdpZnkoe2E6IFN9KSAhPSAne30nIHx8IF9zdHJpbmdpZnkoT2JqZWN0KFMpKSAhPSAne30nOwp9KSksICdKU09OJywgewogIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXsKICAgIGlmKGl0ID09PSB1bmRlZmluZWQgfHwgaXNTeW1ib2woaXQpKXJldHVybjsgLy8gSUU4IHJldHVybnMgc3RyaW5nIG9uIHVuZGVmaW5lZAogICAgdmFyIGFyZ3MgPSBbaXRdCiAgICAgICwgaSAgICA9IDEKICAgICAgLCByZXBsYWNlciwgJHJlcGxhY2VyOwogICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKICAgIHJlcGxhY2VyID0gYXJnc1sxXTsKICAgIGlmKHR5cGVvZiByZXBsYWNlciA9PSAnZnVuY3Rpb24nKSRyZXBsYWNlciA9IHJlcGxhY2VyOwogICAgaWYoJHJlcGxhY2VyIHx8ICFpc0FycmF5KHJlcGxhY2VyKSlyZXBsYWNlciA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpewogICAgICBpZigkcmVwbGFjZXIpdmFsdWUgPSAkcmVwbGFjZXIuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTsKICAgICAgaWYoIWlzU3ltYm9sKHZhbHVlKSlyZXR1cm4gdmFsdWU7CiAgICB9OwogICAgYXJnc1sxXSA9IHJlcGxhY2VyOwogICAgcmV0dXJuIF9zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3MpOwogIH0KfSk7CgovLyAxOS40LjMuNCBTeW1ib2wucHJvdG90eXBlW0BAdG9QcmltaXRpdmVdKGhpbnQpCiRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IF9fd2VicGFja19yZXF1aXJlX18oNikoJFN5bWJvbFtQUk9UT1RZUEVdLCBUT19QUklNSVRJVkUsICRTeW1ib2xbUFJPVE9UWVBFXS52YWx1ZU9mKTsKLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXQpzZXRUb1N0cmluZ1RhZygkU3ltYm9sLCAnU3ltYm9sJyk7Ci8vIDIwLjIuMS45IE1hdGhbQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTsKLy8gMjQuMy4zIEpTT05bQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoZ2xvYmFsLkpTT04sICdKU09OJywgdHJ1ZSk7CgovKioqLyB9KSwKLyogMTA2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdhc3luY0l0ZXJhdG9yJyk7CgovKioqLyB9KSwKLyogMTA3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdvYnNlcnZhYmxlJyk7CgovKioqLyB9KSwKLyogMTA4ICovLAovKiAxMDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfc3RyaW5naWZ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7Cgp2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKZXhwb3J0cy5kaXZpZGVFbWFpbCA9IGRpdmlkZUVtYWlsOwpleHBvcnRzLmVtcHR5T2JqZWN0ID0gZW1wdHlPYmplY3Q7CmV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwpleHBvcnRzLmdldFVzZXJVUkxGcm9tRW1haWwgPSBnZXRVc2VyVVJMRnJvbUVtYWlsOwpleHBvcnRzLmdldFVzZXJFbWFpbEZyb21VUkwgPSBnZXRVc2VyRW1haWxGcm9tVVJMOwpleHBvcnRzLmNvbnZlcnRUb1VzZXJVUkwgPSBjb252ZXJ0VG9Vc2VyVVJMOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwovKioKICogU3VwcG9ydCBtb2R1bGUgd2l0aCBzb21lIGZ1bmN0aW9ucyB3aWxsIGJlIHVzZWZ1bAogKiBAbW9kdWxlIHV0aWxzCiAqLwoKLyoqCiAqIEB0eXBlZGVmIGRpdmlkZVVSTAogKiBAdHlwZSBPYmplY3QKICogQHByb3BlcnR5IHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgVVJMCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkb21haW4gVGhlIGRvbWFpbiBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiBVUkwKICovCgovKioKICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5CiAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAqIEByZXR1cm4ge2RpdmlkZVVSTH0gdGhlIHJlc3VsdCBvZiBkaXZpZGVVUkwKICovCmZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHsKCiAgaWYgKCF1cmwpIHRocm93IEVycm9yKCdVUkwgaXMgbmVlZGVkIHRvIHNwbGl0Jyk7CgogIGZ1bmN0aW9uIHJlY3Vyc2UodmFsdWUpIHsKICAgIHZhciByZWdleCA9IC8oW2EtekEtWi1dKikoOlwvXC8oPzpcLik/fDopKFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTsKICAgIHZhciBzdWJzdCA9ICckMSwkMywkNCc7CiAgICB2YXIgcGFydHMgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBzdWJzdCkuc3BsaXQoJywnKTsKICAgIHJldHVybiBwYXJ0czsKICB9CgogIHZhciBwYXJ0cyA9IHJlY3Vyc2UodXJsKTsKCiAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lCiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgIXBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKCiAgICB2YXIgX3Jlc3VsdCA9IHsKICAgICAgdHlwZTogIiIsCiAgICAgIGRvbWFpbjogdXJsLAogICAgICBpZGVudGl0eTogIiIKICAgIH07CgogICAgY29uc29sZS5lcnJvcignW0RpdmlkZVVSTF0gRGl2aWRlVVJMIGRvblwndCBzdXBwb3J0IHVybCB3aXRob3V0IHNjaGVtZS4gUGxlYXNlIHJldmlldyB5b3VyIHVybCBhZGRyZXNzJywgdXJsKTsKCiAgICByZXR1cm4gX3Jlc3VsdDsKICB9CgogIC8vIGNoZWNrIGlmIHRoZSB1cmwgaGFzIHRoZSBzY2hlbWUgYW5kIGluY2x1ZGVzIGFuIEAKICBpZiAocGFydHNbMF0gPT09IHVybCAmJiBwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CiAgICB2YXIgc2NoZW1lID0gcGFydHNbMF0gPT09IHVybCA/ICdzbXRwJyA6IHBhcnRzWzBdOwogICAgcGFydHMgPSByZWN1cnNlKHNjaGVtZSArICc6Ly8nICsgcGFydHNbMF0pOwogIH0KCiAgLy8gaWYgdGhlIGRvbWFpbiBpbmNsdWRlcyBhbiBALCBkaXZpZGUgaXQgdG8gZG9tYWluIGFuZCBpZGVudGl0eSByZXNwZWN0aXZlbHkKICBpZiAocGFydHNbMV0uaW5jbHVkZXMoJ0AnKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1swXSArICc6Ly8nICsgcGFydHNbMV07CiAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdLnN1YnN0cihwYXJ0c1sxXS5pbmRleE9mKCdAJykgKyAxKTsKICB9IC8qZWxzZSBpZiAocGFydHNbMl0uaW5jbHVkZXMoJy8nKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1syXS5zdWJzdHIocGFydHNbMl0ubGFzdEluZGV4T2YoJy8nKSsxKTsKICAgIH0qLwoKICB2YXIgcmVzdWx0ID0gewogICAgdHlwZTogcGFydHNbMF0sCiAgICBkb21haW46IHBhcnRzWzFdLAogICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgfTsKCiAgcmV0dXJuIHJlc3VsdDsKfQoKZnVuY3Rpb24gZGl2aWRlRW1haWwoZW1haWwpIHsKICB2YXIgaW5kZXhPZkF0ID0gZW1haWwuaW5kZXhPZignQCcpOwoKICB2YXIgcmVzdWx0ID0gewogICAgdXNlcm5hbWU6IGVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpLAogICAgZG9tYWluOiBlbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgZW1haWwubGVuZ3RoKQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBDaGVjayBpZiBhbiBPYmplY3QgaXMgZW1wdHkKICogQHBhcmFtICB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IHRvIGJlIGNoZWNrZWQKICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgc3RhdHVzIG9mIE9iamVjdCwgZW1wdHkgb3Igbm90ICh0cnVlfGZhbHNlKTsKICovCmZ1bmN0aW9uIGVtcHR5T2JqZWN0KG9iamVjdCkgewogIHJldHVybiAoMCwgX2tleXMyLmRlZmF1bHQpKG9iamVjdCkubGVuZ3RoID4gMCA/IGZhbHNlIDogdHJ1ZTsKfQoKLyoqCiAqIE1ha2UgYSBDT1BZIG9mIHRoZSBvcmlnaW5hbCBkYXRhCiAqIEBwYXJhbSAge09iamVjdH0gIG9iaiAtIG9iamVjdCB0byBiZSBjbG9uZWQKICogQHJldHVybiB7T2JqZWN0fQogKi8KZnVuY3Rpb24gZGVlcENsb25lKG9iaikgewogIC8vVE9ETzogc2ltcGxlIGJ1dCBpbmVmZmljaWVudCBKU09OIGRlZXAgY2xvbmUuLi4KICBpZiAob2JqKSByZXR1cm4gSlNPTi5wYXJzZSgoMCwgX3N0cmluZ2lmeTIuZGVmYXVsdCkob2JqKSk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIFVSTCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gZW1haWwKICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICogQHJldHVybiB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICovCmZ1bmN0aW9uIGdldFVzZXJVUkxGcm9tRW1haWwodXNlckVtYWlsKSB7CiAgdmFyIGluZGV4T2ZBdCA9IHVzZXJFbWFpbC5pbmRleE9mKCdAJyk7CiAgcmV0dXJuICd1c2VyOi8vJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgdXNlckVtYWlsLmxlbmd0aCkgKyAnLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIGVtYWlsIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBVUkwKICogQHBhcmFtICB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICogQHJldHVybiB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICovCmZ1bmN0aW9uIGdldFVzZXJFbWFpbEZyb21VUkwodXNlclVSTCkgewogIHZhciB1cmwgPSBkaXZpZGVVUkwodXNlclVSTCk7CiAgcmV0dXJuIHVybC5pZGVudGl0eS5yZXBsYWNlKCcvJywgJycpICsgJ0AnICsgdXJsLmRvbWFpbjsgLy8gaWRlbnRpdHkgZmllbGQgaGFzICcvZXhhbXBsZUlEJyBpbnN0ZWFkIG9mICdleGFtcGxlSUQnCn0KCi8qKgogKiBDaGVjayBpZiB0aGUgdXNlciBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIFVSTCBmb3JtYXQsIGlmIG5vdCwgY29udmVydCB0byBVUkwgZm9ybWF0CiAqIEBwYXJhbSAge3N0cmluZ30gICBpZGVudGlmaWVyICB1c2VyIGlkZW50aWZpZXIKICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMCiAqLwpmdW5jdGlvbiBjb252ZXJ0VG9Vc2VyVVJMKGlkZW50aWZpZXIpIHsKCiAgLy8gY2hlY2sgaWYgdGhlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgdXJsIGZvcm1hdAogIGlmIChpZGVudGlmaWVyLnN1YnN0cmluZygwLCA3KSA9PT0gJ3VzZXI6Ly8nKSB7CiAgICB2YXIgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChpZGVudGlmaWVyKTsKCiAgICAvL2NoZWNrIGlmIHRoZSB1cmwgaXMgd2VsbCBmb3JtYXRlZAogICAgaWYgKGRpdmlkZWRVUkwuZG9tYWluICYmIGRpdmlkZWRVUkwuaWRlbnRpdHkpIHsKICAgICAgcmV0dXJuIGlkZW50aWZpZXI7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyAndXNlclVSTCB3aXRoIHdyb25nIGZvcm1hdCc7CiAgICB9CgogICAgLy9pZiBub3QsIGNvbnZlcnQgdGhlIHVzZXIgZW1haWwgdG8gVVJMIGZvcm1hdAogIH0gZWxzZSB7CiAgICByZXR1cm4gZ2V0VXNlclVSTEZyb21FbWFpbChpZGVudGlmaWVyKTsKICB9Cn0KCi8qKiovIH0pLAovKiAxMTAgKi8sCi8qIDExMSAqLywKLyogMTEyICovLAovKiAxMTMgKi8sCi8qIDExNCAqLywKLyogMTE1ICovLAovKiAxMTYgKi8sCi8qIDExNyAqLywKLyogMTE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMik7Cgp2YXIgX2dldDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMyk7Cgp2YXIgX2dldDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXQyKTsKCnZhciBfaW5oZXJpdHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMyk7Cgp2YXIgX2luaGVyaXRzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2luaGVyaXRzMik7Cgp2YXIgX0RhdGFPYmplY3QyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjApOwoKdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCnZhciBfRGF0YU9iamVjdENoaWxkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjEpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdENoaWxkKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBGaWx0ZXJUeXBlID0geyBBTlk6ICdhbnknLCBTVEFSVDogJ3N0YXJ0JywgRVhBQ1Q6ICdleGFjdCcgfTsKCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBzdWJzY3JpYmUgY2FsbC4KICogVG8gYmUgdXNlZCBhcyBhbiBvYnNlcnZhdGlvbiBwb2ludCBmcm9tIGEgRGF0YU9iamVjdFJlcG9ydGVyIGNoYW5nZS4KICovCgp2YXIgRGF0YU9iamVjdE9ic2VydmVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CiAgKDAsIF9pbmhlcml0czMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBfRGF0YU9iamVjdCk7CgogIC8qIHByaXZhdGUKICBfY2hhbmdlTGlzdGVuZXI6IE1zZ0xpc3RlbmVyCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfZmlsdGVyczogezxmaWx0ZXI+OiB7dHlwZTogPHN0YXJ0LCBleGFjdD4sIGNhbGxiYWNrOiA8ZnVuY3Rpb24+fSB9CiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyLnN1YnNjcmliZSBtZXRob2QKICAgKi8KCiAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogIGZ1bmN0aW9uIERhdGFPYmplY3RPYnNlcnZlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucywgaW5pdGlhbFZlcnNpb24sIG11dHVhbCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdE9ic2VydmVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdE9ic2VydmVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YS5kYXRhLCBjaGlsZHJlbnMsIG11dHVhbCkpOwoKICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IGluaXRpYWxWZXJzaW9uOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewogICAgICBfdGhpcy5fb25GaWx0ZXIoZXZlbnQpOwogICAgfSk7CgogICAgLy9zZXR1cCBjaGlsZHJlbnMgZGF0YSBmcm9tIHN1YnNjcmlwdGlvbgogICAgKDAsIF9rZXlzMi5kZWZhdWx0KShpbml0aWFsRGF0YS5jaGlsZHJlbnMpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkSWQpIHsKICAgICAgdmFyIGNoaWxkRGF0YSA9IGluaXRpYWxEYXRhLmNoaWxkcmVuc1tjaGlsZElkXTsKICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBjaGlsZElkLCBjaGlsZERhdGEpOwogICAgfSk7CgogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwgKyAnL2NoYW5nZXMnLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgaWYgKG1zZy50eXBlID09PSAndXBkYXRlJykgewogICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwogICAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChfdGhpcy5fc3luY09iaiwgbXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICd1bnN1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsVW5TdWJzY3JpYmUKICAgICAgdmFyIHVuU3Vic2NyaWJlTXNnID0gewogICAgICAgIHR5cGU6ICd1bnN1YnNjcmliZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHVuU3Vic2NyaWJlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdE9ic2VydmVyLVVOU1VCU0NSSUJFOiAnLCByZXBseSk7CiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsdGVyIC0gRmlsdGVyIHRoYXQgaWRlbnRpZmllcyB0aGUgZmllbGQgKHNlcGFyYXRlZCBkb3QgcGF0aCkuIEFjY2VwdHMgKiBhdCB0aGUgZW5kIGZvciBhIG1vcmUgdW5yZXN0cmljdGVkIGZpbHRlcmluZy4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkNoYW5nZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2UoZmlsdGVyLCBjYWxsYmFjaykgewogICAgICB2YXIga2V5ID0gZmlsdGVyOwogICAgICB2YXIgZmlsdGVyT2JqID0gewogICAgICAgIHR5cGU6IEZpbHRlclR5cGUuRVhBQ1QsCiAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrCiAgICAgIH07CgogICAgICB2YXIgaWR4ID0gZmlsdGVyLmluZGV4T2YoJyonKTsKICAgICAgaWYgKGlkeCA9PT0gZmlsdGVyLmxlbmd0aCAtIDEpIHsKICAgICAgICBpZiAoaWR4ID09PSAwKSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuQU5ZOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuU1RBUlQ7CiAgICAgICAgICBrZXkgPSBmaWx0ZXIuc3Vic3RyKDAsIGZpbHRlci5sZW5ndGggLSAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuX2ZpbHRlcnNba2V5XSA9IGZpbHRlck9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25GaWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZpbHRlcihldmVudCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fZmlsdGVycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdmFyIGZpbHRlciA9IF90aGlzLl9maWx0ZXJzW2tleV07CiAgICAgICAgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLkFOWSkgewogICAgICAgICAgLy9tYXRjaCBhbnl0aGluZwogICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKICAgICAgICB9IGVsc2UgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLlNUQVJUKSB7CiAgICAgICAgICAvL2lmIHN0YXJ0cyB3aXRoIGZpbHRlci4uLgogICAgICAgICAgaWYgKGV2ZW50LmZpZWxkLmluZGV4T2Yoa2V5KSA9PT0gMCkgewogICAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuRVhBQ1QpIHsKICAgICAgICAgIC8vZXhhY3QgbWF0Y2gKICAgICAgICAgIGlmIChldmVudC5maWVsZCA9PT0ga2V5KSB7CiAgICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFPYmplY3RPYnNlcnZlcjsKfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdE9ic2VydmVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKdmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yKTsKCnZhciBfZ2V0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCnZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKdmFyIF9pbmhlcml0czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTsKCnZhciBfaW5oZXJpdHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5oZXJpdHMyKTsKCnZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCk7Cgp2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgY3JlYXRlIGNhbGwuCiAqIFRvIGJlIHVzZWQgYXMgYSByZXBvcnRlciBwb2ludCwgY2hhbmdlcyB3aWxsIGJlIHN1Ym1pdGVkIHRvIERhdGFPYmplY3RPYnNlcnZlciBpbnN0YW5jZXMuCiAqLwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBEYXRhT2JqZWN0UmVwb3J0ZXIgPSBmdW5jdGlvbiAoX0RhdGFPYmplY3QpIHsKICAoMCwgX2luaGVyaXRzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIF9EYXRhT2JqZWN0KTsKCiAgLyogcHJpdmF0ZQogIF9zdWJzY3JpcHRpb25zOiA8aHlwZXJ0eVVybDogeyBzdGF0dXM6IHN0cmluZyB9IH0+CiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25TdWJzY3JpcHRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICBfb25SZXNwb25zZUhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlYWRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuY3JlYXRlIG1ldGhvZAogICAqLwogIGZ1bmN0aW9uIERhdGFPYmplY3RSZXBvcnRlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdFJlcG9ydGVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdFJlcG9ydGVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSk7CgogICAgdmFyIF90aGlzID0gX3RoaXMyOwoKICAgIF90aGlzLl9zdWJzY3JpcHRpb25zID0ge307CgogICAgX3RoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci0nICsgdXJsICsgJy1TRU5EOiAnLCBldmVudCk7CiAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCk7CiAgICB9KTsKCiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgIHJldHVybiBfdGhpczI7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX2FsbG9jYXRlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9vYmplY3RMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgewogICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0LScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewogICAgICAgICAgY2FzZSAncmVzcG9uc2UnOgogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpO2JyZWFrOwogICAgICAgICAgY2FzZSAncmVhZCc6CiAgICAgICAgICAgIF90aGlzLl9vblJlYWQobXNnKTticmVhazsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX29iamVjdExpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogU2VuZCBpbnZpdGF0aW9ucyAoY3JlYXRlIG1lc3NhZ2VzKSB0byBoeXBlcnRpZXMsIG9ic2VydmVycyBsaXN0LgogICAgICogQHBhcmFtICB7SHlwZXJ0eVVSTFtdfSBvYnNlcnZlcnMgTGlzdCBvZiBIeXBlcnR5IFVSTCdzCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnaW52aXRlT2JzZXJ2ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnZpdGVPYnNlcnZlcnMob2JzZXJ2ZXJzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkNyZWF0ZQogICAgICB2YXIgaW52aXRlTXNnID0gewogICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fc3luY2hlci5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAogICAgICAgIGJvZHk6IHsgcmVzdW1lOiBmYWxzZSwgcmVzb3VyY2U6IF90aGlzLl91cmwsIHNjaGVtYTogX3RoaXMuX3NjaGVtYSwgdmFsdWU6IF90aGlzLl9zeW5jT2JqLmRhdGEsIGF1dGhvcmlzZTogb2JzZXJ2ZXJzIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoaW52aXRlTXNnKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uRGVsZXRlCiAgICAgIHZhciBkZWxldGVNc2cgPSB7CiAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGRlbGV0ZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1ERUxFVEU6ICcsIHJlcGx5KTsKICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX3JlcG9ydGVyc1tfdGhpcy5fdXJsXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU3Vic2NyaXB0aW9ucyByZXF1ZXN0ZWQgYW5kIGFjY2VwdGVkIHRvIHRoaXMgcmVwb3J0ZXIKICAgICAqIEB0eXBlIHtPYmplY3Q8SHlwZXJ0eVVSTCwgU3luY1N1YnNjcmlwdGlvbj59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25TdWJzY3JpcHRpb24nLAoKCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHN1YnNjcmliZSBhbmQgdW5zdWJzY3JpYmUgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TdWJzY3JpcHRpb24oY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZXNwb25zZSBub3RpZmljYXRpb25zIG9mIHRoZSBjcmVhdGUncwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlYWQgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVhZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZWFkKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVhZEhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBwYXJlbnQgU3luY2hlciAtPiBfb25Gb3J3YXJkCgogIH0sIHsKICAgIGtleTogJ19vbkZvcndhcmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLVJDVjogJywgbXNnKTsKICAgICAgc3dpdGNoIChtc2cuYm9keS50eXBlKSB7CiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblN1YnNjcmliZShtc2cpO2JyZWFrOwogICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGlzIC0+IF9vbkZvcndhcmQ6IGVtaXR0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBzdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uU3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdWJzY3JpYmUobXNnKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwogICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RSZXBvcnRlci5fb25TdWJzY3JpYmVdJywgbXNnKTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIC8vY3JlYXRlIG5ldyBzdWJzY3JpcHRpb24KICAgICAgICAgIHZhciBzdWIgPSB7IHVybDogaHlwZXJ0eVVybCwgc3RhdHVzOiAnb24nIH07CiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjsKCiAgICAgICAgICAvL3Byb2Nlc3MgYW5kIHNlbmQgY2hpbGRyZW5zIGRhdGEKICAgICAgICAgIHZhciBjaGlsZHJlblZhbHVlcyA9IHt9OwogICAgICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CiAgICAgICAgICAgIHZhciBjaGlsZERhdGEgPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLmRhdGE7CiAgICAgICAgICAgIGNoaWxkcmVuVmFsdWVzW2NoaWxkSWRdID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGNoaWxkRGF0YSk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgc2VuZE1zZyA9IHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoX3RoaXMuZGF0YSksIGNoaWxkcmVuczogY2hpbGRyZW5WYWx1ZXMgfSB9CiAgICAgICAgICB9OwoKICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsQXV0aGVudGljYXRpb24nKSAmJiAhbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24pIHsKICAgICAgICAgICAgc2VuZE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbjsKICAgICAgICAgICAgX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBvayByZXNwb25zZSBtZXNzYWdlCiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHNlbmRNc2cpOwoKICAgICAgICAgIHJldHVybiBzdWI7CiAgICAgICAgfSwKCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7CiAgICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdTVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoaXMgLT4gX29uRm9yd2FyZDogZW1pdHRlZCBieSBhIHJlbW90ZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgLT4gdW5zdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uVW5TdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblVuU3Vic2NyaWJlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgaHlwZXJ0eVVybCA9IG1zZy5ib2R5LmZyb207CgogICAgICB2YXIgc3ViID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CiAgICAgIGRlbGV0ZSBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKICAgICAgICBvYmplY3Q6IHN1YgogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBSZXBvcnRlclVSTCBhZGRyZXNzOiBlbWl0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBfb25SZW1vdGVDcmVhdGUgLT4gZXZlbnQuYWNrCgogIH0sIHsKICAgIGtleTogJ19vblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZXNwb25zZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICB1cmw6IG1zZy5mcm9tLAogICAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGUKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVTUE9OU0UtRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gcmVhZAoKICB9LCB7CiAgICBrZXk6ICdfb25SZWFkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWFkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmZyb20sCgogICAgICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgdmFsdWU6ICgwLCBfdXRpbHMuZGVlcENsb25lKShfdGhpcy5kYXRhKSB9CiAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDEsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uUmVhZEhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVBRC1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblJlYWRIYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3N1YnNjcmlwdGlvbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdFJlcG9ydGVyOwp9KF9EYXRhT2JqZWN0My5kZWZhdWx0IC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0UmVwb3J0ZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEyMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9wcm9taXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7Cgp2YXIgX3Byb21pc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvbWlzZSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX1Byb3h5T2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKdmFyIF9Qcm94eU9iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Qcm94eU9iamVjdCk7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCnZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7Cgp2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBNYWluIGV4dGVuc2lvbiBjbGFzcyBmb3Igb2JzZXJ2ZXJzIGFuZCByZXBvcnRlcnMsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIG1ldGhvZHMuCiAqIENoaWxkcmVuIG1hbmFnZW1lbnQgaXMgY29tbW9uIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycy4KICovCnZhciBEYXRhT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICBfdmVyc2lvbjogbnVtYmVyCiAgIF9vd25lcjogSHlwZXJ0eVVSTAogIF91cmw6IE9iamVjdFVSTAogIF9zY2hlbWE6IFNjaGVtYQogIF9idXM6IE1pbmlCdXMKICBfc3RhdHVzOiBvbiB8IHBhdXNlZAogIF9zeW5jT2JqOiBTeW5jRGF0YQogICBfY2hpbGRyZW46IHsgaWQ6IERhdGFPYmplY3RDaGlsZCB9CiAgX2NoaWxkcmVuTGlzdGVuZXJzOiBbTXNnTGlzdGVuZXJdCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25BZGRDaGlsZEhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogICovCgogIC8qKgogICAqIEBpZ25vcmUKICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlciBjcmVhdGUgb3Igc3Vic2NyaWJlIG1ldGhvZCdzCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdChzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgdmFyIG11dHVhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDogdHJ1ZTsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX3N5bmNoZXIgPSBzeW5jaGVyOwogICAgX3RoaXMuX3VybCA9IHVybDsKICAgIF90aGlzLl9zY2hlbWEgPSBzY2hlbWE7CiAgICBfdGhpcy5fc3RhdHVzID0gaW5pdGlhbFN0YXR1czsKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CiAgICBfdGhpcy5fY2hpbGRyZW5zID0gY2hpbGRyZW5zOwoKICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgIF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbDsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IDA7CiAgICBfdGhpcy5fY2hpbGRJZCA9IDA7CiAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzID0ge307CiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTsKCiAgICBfdGhpcy5fb3duZXIgPSBzeW5jaGVyLl9vd25lcjsKICAgIF90aGlzLl9idXMgPSBzeW5jaGVyLl9idXM7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0LCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBjaGlsZEJhc2VVUkwgPSBfdGhpcy5fdXJsICsgJy9jaGlsZHJlbi8nOwogICAgICBjb25zb2xlLmxvZygnW0RhdGEgT2JqZWN0IC0gQWxsb2NhdGVMaXN0ZW5lcnNdIC0gJywgX3RoaXMuX2NoaWxkcmVucyk7CiAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW5zKSB7CiAgICAgICAgX3RoaXMuX2NoaWxkcmVucy5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkgewogICAgICAgICAgdmFyIGNoaWxkVVJMID0gY2hpbGRCYXNlVVJMICsgY2hpbGQ7CiAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgICAgICAgaWYgKG1zZy5mcm9tICE9PSBfdGhpczIuX293bmVyKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3QtQ2hpbGRyZW4tUkNWOiAnLCBtc2cpOwogICAgICAgICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6CiAgICAgICAgICAgICAgICAgIF90aGlzLl9vbkNoaWxkQ3JlYXRlKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOgogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO2JyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgX3RoaXMuX2NoYW5nZUNoaWxkcmVuKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHsKICAgICAgICBsaXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfSk7CgogICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNba2V5XS5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBVUkwgb2YgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIKICAgICAqIEB0eXBlIHtPYmplY3RVUkx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncGF1c2UnLAoKCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkgewogICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CiAgICB9CgogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncmVzdW1lJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7CiAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdG9wJywKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICAvL1RPRE86IHNob3VsZCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBhbmQgc2VuZCBtZXNzYWdlIHVuc3Vic2NyaWJlPwogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgYWRkIGEgRGF0YU9iamVjdENoaWxkIHRvIGEgY2hpbGRyZW4gY29sbGVjdGlvbi4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGlsZHJlbiAtIENoaWxkcmVuIG5hbWUgd2hlcmUgdGhlIGNoaWxkIGlzIGFkZGVkLgogICAgICogQHBhcmFtIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgY2hpbGQKICAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdENoaWxkPn0gLSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBEYXRhT2JqZWN0Q2hpbGQuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnYWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENoaWxkKGNoaWxkcmVuLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9jcmVhdGUgbmV3IGNoaWxkIHVuaXF1ZSBJRCwgYmFzZWQgb24gaHlwZXJ0eVVSTAogICAgICBfdGhpcy5fY2hpbGRJZCsrOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IF90aGlzLl9vd25lciArICcjJyArIF90aGlzLl9jaGlsZElkOwogICAgICB2YXIgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJyArIGNoaWxkcmVuOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoaWxkIGFkZHJlc3M6IE1lc3NhZ2VCdXMKICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IG1zZ0NoaWxkUGF0aCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBtc2dDaGlsZElkLCB2YWx1ZTogaW5pdGlhbERhdGEgfQogICAgICB9OwoKICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgcmVxdWVzdE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uOwoKICAgICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbAogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgdmFyIG1zZ0lkID0gX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXF1ZXN0TXNnKTsKCiAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZS1yZXBvcnRlci1jaGlsZCggJyArIF90aGlzLl9vd25lciArICcgKTogJywgcmVxdWVzdE1zZyk7CiAgICAgICAgdmFyIG5ld0NoaWxkID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIG1zZ0NoaWxkSWQsIGluaXRpYWxEYXRhLCBfdGhpcy5fb3duZXIsIG1zZ0lkKTsKICAgICAgICBuZXdDaGlsZC5vbkNoYW5nZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCwgeyBwYXRoOiBtc2dDaGlsZFBhdGgsIGNoaWxkSWQ6IG1zZ0NoaWxkSWQgfSk7CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgICAgcmVzb2x2ZShuZXdDaGlsZCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgY3JlYXRlIGFuZCBkZWxldGUgb2YgY2hpbGRyZW5zLgogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uQWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQWRkQ2hpbGQoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IGFkZENoaWxkCgogIH0sIHsKICAgIGtleTogJ19vbkNoaWxkQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGlsZENyZWF0ZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIG1zZ0NoaWxkSWQgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUtb2JzZXJ2ZXItY2hpbGQoICcgKyBfdGhpcy5fb3duZXIgKyAnICk6ICcsIG1zZyk7CiAgICAgIHZhciBuZXdDaGlsZCA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBtc2dDaGlsZElkLCBtc2cuYm9keS52YWx1ZSk7CiAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIC8vRkxPVy1PVVQ6IHdpbGwgZmxvdyB0byBEYXRhT2JqZWN0Q2hpbGQgLT4gX29uUmVzcG9uc2UKICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHNvdXJjZTogX3RoaXMuX293bmVyIH0KICAgICAgICB9KTsKICAgICAgfSk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmZyb20sCiAgICAgICAgdXJsOiBtc2cudG8sCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGNoaWxkSWQ6IG1zZ0NoaWxkSWQsCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ0FERC1DSElMRFJFTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL3NlbmQgZGVsdGEgbWVzc2FnZXMgdG8gc3Vic2NyaXB0aW9ucwoKICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoYW5nZShldmVudCwgY2hpbGRJbmZvKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fdmVyc2lvbisrOwoKICAgICAgaWYgKF90aGlzLl9zdGF0dXMgPT09ICdvbicpIHsKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIGEgcmVzb3VyY2UgY2hhbmdlcyBhZGRyZXNzOiBNZXNzYWdlQnVzCiAgICAgICAgdmFyIGNoYW5nZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogX3RoaXMuX3VybCArICcvY2hhbmdlcycsCiAgICAgICAgICBib2R5OiB7IHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCBzb3VyY2U6IF90aGlzLl9vd25lciwgYXR0cmlidXRlOiBldmVudC5maWVsZCB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0IC0gX29uQ2hhbmdlXSAtICcsIGV2ZW50LCBjaGlsZEluZm8sIGNoYW5nZU1zZyk7CgogICAgICAgIGlmIChldmVudC5vVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuT0JKRUNUKSB7CiAgICAgICAgICBpZiAoZXZlbnQuY1R5cGUgIT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPSBldmVudC5vVHlwZTsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKICAgICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuVVBEQVRFKSB7CiAgICAgICAgICAgIGNoYW5nZU1zZy5ib2R5Lm9wZXJhdGlvbiA9IGV2ZW50LmNUeXBlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy9jaGlsZEluZm8gbXVzdCBoYXZlIChwYXRoLCBjaGlsZElkKQogICAgICAgIGlmIChjaGlsZEluZm8pIHsKICAgICAgICAgIGNoYW5nZU1zZy50byA9IGNoaWxkSW5mby5wYXRoOwogICAgICAgICAgY2hhbmdlTXNnLmJvZHkucmVzb3VyY2UgPSBjaGlsZEluZm8uY2hpbGRJZDsKICAgICAgICB9CgogICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgY2hhbmdlTXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoY2hhbmdlTXNnKTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogZGVsdGEgbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RSZXBvcnRlciBvciBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VPYmplY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VPYmplY3Qoc3luY09iaiwgbXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL1RPRE86IHVwZGF0ZSB2ZXJzaW9uID8KICAgICAgLy9ob3cgdG8gaGFuZGxlIGFuIGluY29ycmVjdCB2ZXJzaW9uID8gRXhhbXBsZTogcmVjZWl2ZSBhIHZlcnNpb24gMyB3aGVuIHRoZSBvYnNlcnZlciBpcyBpbiB2ZXJzaW9uIDEsIHdoZXJlIGlzIHRoZSB2ZXJzaW9uIDIgPwogICAgICAvL3dpbGwgd2UgbmVlZCB0byBjb25maXJtIHRoZSByZWNlcHRpb24gPwogICAgICBpZiAoX3RoaXMuX3ZlcnNpb24gKyAxID09PSBtc2cuYm9keS52ZXJzaW9uKSB7CiAgICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKICAgICAgICB2YXIgcGF0aCA9IG1zZy5ib2R5LmF0dHJpYnV0ZTsKICAgICAgICB2YXIgdmFsdWUgPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkobXNnLmJvZHkudmFsdWUpOwogICAgICAgIHZhciBmaW5kUmVzdWx0ID0gc3luY09iai5maW5kQmVmb3JlKHBhdGgpOwoKICAgICAgICBpZiAobXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuQVJSQVkpIHsKICAgICAgICAgIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLkFERCkgewogICAgICAgICAgICB2YXIgYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBpbmRleCA9IGZpbmRSZXN1bHQubGFzdDsKICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShhcnIsIFtpbmRleCwgMF0uY29uY2F0KHZhbHVlKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CiAgICAgICAgICAgIHZhciBfYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBfaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIF9hcnIuc3BsaWNlKF9pbmRleCwgdmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XSA9IHZhbHVlOyAvLyBVUERBVEUKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKG1zZy5ib2R5LnZhbHVlKSB7CiAgICAgICAgICAgIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF0gPSB2YWx1ZTsgLy8gVVBEQVRFIG9yIEFERAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVsZXRlIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF07IC8vIFJFTU9WRQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvL1RPRE86IGhvdyB0byBoYW5kbGUgdW5zeW5jaHJvbml6ZWQgdmVyc2lvbnM/CiAgICAgICAgY29uc29sZS5sb2coJ1VOU1lOQ0hST05JWkVEIFZFUlNJT046IChkYXRhID0+ICcgKyBfdGhpcy5fdmVyc2lvbiArICcsIG1zZyA9PiAnICsgbXNnLmJvZHkudmVyc2lvbiArICcpJyk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VDaGlsZHJlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NoYW5nZUNoaWxkcmVuKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBjb25zb2xlLmxvZygnQ2hhbmdlIGNoaWxkcmVuOiAnLCBfdGhpcy5fb3duZXIsIG1zZyk7CgogICAgICB2YXIgY2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlOwogICAgICB2YXIgY2hpbGRyZW4gPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdOwoKICAgICAgaWYgKGNoaWxkcmVuKSB7CiAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChjaGlsZHJlbi5fc3luY09iaiwgbXNnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygnTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAnLCBjaGlsZElkKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3VybCcsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3VybDsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBzY2hlbWEgVVJMICh0aGlzIGZpZWxkIGlzIG5vdCB5ZXQgc3RhYmxlLCBhbmQgaXMgc3Vic2plY3QgdG8gY2hhbmdlKQogICAgICogQHR5cGUge1NjaGVtYVVSTH0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzY2hlbWEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zY2hlbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdGF0dXMgb2YgdGhlIHJlcG9ydGVyIG9yIG9ic2VydmVyIGNvbm5lY3Rpb24gKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpCiAgICAgKiBAdHlwZSB7U3RhdHVzfSAtIEVudW0gb2Y6IG9uIHwgcGF1c2VkCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnc3RhdHVzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3RhdHVzOwogICAgfQoKICAgIC8qKgogICAgICogRGF0YSBzdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLgogICAgICogQHR5cGUge0pTT059IC0gSlNPTiBzdHJ1Y3R1cmUgdGhhdCBzaG91bGQgZm9sbG93IHRoZSBkZWZpbmVkIHNjaGVtYSwgaWYgYW55LgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RhdGEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGwgY3JlYXRlZCBjaGlsZHJlbidzIHNpbmNlIHRoZSBzdWJzY3JpcHRpb24sIGRvZXNuJ3QgY29udGFpbiBhbGwgY2hpbGRyZW4ncyBzaW5jZSByZXBvcnRlciBjcmVhdGlvbi4KICAgICAqIEB0eXBlIHtPYmplY3Q8Q2hpbGRJZCwgRGF0YU9iamVjdENoaWxkPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdjaGlsZHJlbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhT2JqZWN0Owp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTIxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIyKTsKCnZhciBfUHJveHlPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUHJveHlPYmplY3QpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgRGF0YU9iamVjdCBhZGRDaGlsZHJlbiBjYWxsIG9yIGZyb20gb25BZGRDaGlsZHJlbiBpZiByZW1vdGVseSBjcmVhdGVkLgogKiBDaGlsZHJlbiBvYmplY3Qgc3luY2hyb25pemF0aW9uIGlzIGEgYSBmYXN0IGZvcndhcmQgbWVjaGFuaXNtLCBubyBuZWVkIGZvciBkaXJlY3Qgc3Vic2NyaXB0aW9ucywgaXQgdXNlcyB0aGUgYWxyZWFkeSBhdXRob3JpemVkIHN1YnNjcmlwdGlvbiBmcm9tIHRoZSBwYXJlbnQgRGF0YU9iamVjdC4KICovCnZhciBEYXRhT2JqZWN0Q2hpbGQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBEYXRhT2JqZWN0LmFkZENoaWxkcmVuCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdENoaWxkKHBhcmVudCwgY2hpbGRJZCwgaW5pdGlhbERhdGEsIG93bmVyLCBtc2dJZCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdENoaWxkKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9wYXJlbnQgPSBwYXJlbnQ7CiAgICBfdGhpcy5fY2hpbGRJZCA9IGNoaWxkSWQ7CiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl9tc2dJZCA9IG1zZ0lkOwoKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CgogICAgX3RoaXMuX2J1cyA9IHBhcmVudC5fYnVzOwogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0Q2hpbGQsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vdGhpcyBpcyBvbmx5IG5lZWRlZCBmb3IgY2hpbGRyZW4gcmVwb3J0ZXJzCiAgICAgIGlmIChfdGhpcy5fb3duZXIpIHsKICAgICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl9vd25lciwgZnVuY3Rpb24gKG1zZykgewogICAgICAgICAgaWYgKG1zZy50eXBlID09PSAncmVzcG9uc2UnICYmIG1zZy5pZCA9PT0gX3RoaXMuX21zZ0lkKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZTonLCBtc2cpOwogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKF90aGlzLl9saXN0ZW5lcikgewogICAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgZGVsZXRlIF90aGlzLl9wYXJlbnQuX2NoaWxkcmVuW190aGlzLl9jaGlsZElkXTsKCiAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgogICAgICAvL1RPRE86IHNlbmQgZGVsZXRlIG1lc3NhZ2UgPwogICAgfQoKICAgIC8qKgogICAgICogQ2hpbGRyZW4gSUQgZ2VuZXJhdGVkIG9uIGFkZENoaWxkcmVuLiBVbmlxdWUgaWRlbnRpZmllcgogICAgICogQHR5cGUge1VSTH0gLSBVUkwgb2YgdGhlIGZvcm1hdCA8SHlwZXJ0eVVSTD4jPG51bWVyaWMtc2VxdWVuY2U+CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25DaGFuZ2UnLAoKCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyIGNoaWxkCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZShjYWxsYmFjaykgewogICAgICB0aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlc3BvbnNlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIGNyZWF0ZXMKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlc3BvbnNlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVzcG9uc2VIYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdCAtPiBfb25DaGlsZENyZWF0ZQoKICB9LCB7CiAgICBrZXk6ICdfb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVzcG9uc2UobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgdXJsOiBtc2cuYm9keS5zb3VyY2UsCiAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdjaGlsZElkJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKICAgIH0KCiAgICAvKioKICAgICAqIERhdGEgU3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC4KICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdENoaWxkOwp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdENoaWxkOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5PYmplY3RUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0gdW5kZWZpbmVkOwoKdmFyIF9zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCnZhciBfc3RyaW5naWZ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmeSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKX193ZWJwYWNrX3JlcXVpcmVfXygxNTMpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBvYmplY3RUeXBlID0geyBBUlJBWTogJ1tvYmplY3QgQXJyYXldJywgT0JKRUNUOiAnW29iamVjdCBPYmplY3RdJyB9OwoKLyoqCiAqIEBhY2Nlc3MgcHJpdmF0ZQogKiBNYWluIGNsYXNzIHRoYXQgbWFpbnRhaW5zIGEgSlNPTiBvYmplY3QsIGFuZCBvYnNlcnZlcyBjaGFuZ2VzIGluIHRoaXMgb2JqZWN0LCByZWN1cnNpdmVseS4KICogSW50ZXJuYWwgb2JqZWN0cyBhbmQgYXJyYXlzIGFyZSBhbHNvIG9ic2VydmVkLgogKi8KCnZhciBTeW5jT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFN5bmNPYmplY3QoaW5pdGlhbERhdGEpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFN5bmNPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX29ic2VydmVycyA9IFtdOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICB0aGlzLl9kYXRhID0gaW5pdGlhbERhdGEgfHwge307CgogICAgdGhpcy5faW50ZXJuYWxPYnNlcnZlKHRoaXMuX2RhdGEpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoU3luY09iamVjdCwgW3sKICAgIGtleTogJ29ic2VydmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnB1c2goY2FsbGJhY2spOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmQocGF0aCkgewogICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCiAgICAgIHJldHVybiB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmRCZWZvcmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRCZWZvcmUocGF0aCkgewogICAgICB2YXIgcmVzdWx0ID0ge307CiAgICAgIHZhciBsaXN0ID0gcGF0aC5zcGxpdCgnLicpOwogICAgICByZXN1bHQubGFzdCA9IGxpc3QucG9wKCk7CiAgICAgIHJlc3VsdC5vYmogPSB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmluZFdpdGhTcGxpdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbmRXaXRoU3BsaXQobGlzdCkgewogICAgICB2YXIgb2JqID0gdGhpcy5fZGF0YTsKICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIG9iaiA9IG9ialt2YWx1ZV07CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIG9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfaXNPYnNlcnZhYmxlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNPYnNlcnZhYmxlKG9iaikgewogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBPYmplY3QgfHwgb2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2ludGVybmFsT2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsT2JzZXJ2ZShvYmplY3QpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoY2hhbmdlc2V0KSB7CgogICAgICAgIGNoYW5nZXNldC5ldmVyeShmdW5jdGlvbiAoY2hhbmdlKSB7CiAgICAgICAgICBfdGhpczIuX29uQ2hhbmdlcyhjaGFuZ2UpOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgdGhpcy5fZGF0YSA9IE9iamVjdC5kZWVwT2JzZXJ2ZShvYmplY3QsIGhhbmRsZXIpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19maXJlRXZlbnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maXJlRXZlbnQoZXZlbnQpIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2VzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2VzKGNoYW5nZSkgewoKICAgICAgdmFyIG9iaiA9IGNoYW5nZS5vYmplY3Q7CiAgICAgIHZhciBvYmpUeXBlID0gdm9pZCAwOwoKICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuT0JKRUNUOwogICAgICB9CgogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIG9ialR5cGUgPSBPYmplY3RUeXBlLkFSUkFZOwogICAgICB9CgogICAgICB2YXIgZmllbGRTdHJpbmcgPSBjaGFuZ2Uua2V5cGF0aDsKCiAgICAgIC8vIGNvbnNvbGUubG9nKCdGaWVsZDonLCBmaWVsZFN0cmluZyk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCd0eXBlOicsIGNoYW5nZS50eXBlKTsKCiAgICAgIC8vbGV0IG9sZFZhbHVlID0gY2hhbmdlLm9sZFZhbHVlOwogICAgICB2YXIgbmV3VmFsdWUgPSBvYmpbY2hhbmdlLm5hbWVdOwoKICAgICAgY29uc29sZS5pbmZvKGNoYW5nZS50eXBlICsgJyB8IEZpZWxkOiAnICsgZmllbGRTdHJpbmcgKyAnIHwgTmV3IFZhbHVlOicsICgwLCBfc3RyaW5naWZ5Mi5kZWZhdWx0KShuZXdWYWx1ZSkpOwoKICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAndXBkYXRlJykgewogICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5VUERBVEUsCiAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZywKICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2FkZCcpIHsKICAgICAgICB0aGlzLl9maXJlRXZlbnQoewogICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuQURELAogICAgICAgICAgb1R5cGU6IG9ialR5cGUsCiAgICAgICAgICBmaWVsZDogZmllbGRTdHJpbmcsCiAgICAgICAgICBkYXRhOiBuZXdWYWx1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdkZWxldGUnKSB7CiAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLlJFTU9WRSwKICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fZGF0YTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFN5bmNPYmplY3Q7Cn0oKTsKCnZhciBDaGFuZ2VUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0geyBVUERBVEU6ICd1cGRhdGUnLCBBREQ6ICdhZGQnLCBSRU1PVkU6ICdyZW1vdmUnIH07CnZhciBPYmplY3RUeXBlID0gZXhwb3J0cy5PYmplY3RUeXBlID0geyBPQkpFQ1Q6ICdvYmplY3QnLCBBUlJBWTogJ2FycmF5JyB9OwpleHBvcnRzLmRlZmF1bHQgPSBTeW5jT2JqZWN0OwoKLyoqKi8gfSksCi8qIDEyMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzOCk7Cgp2YXIgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgewogIGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsKICB2YXIgZGVzYyA9ICgwLCBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMi5kZWZhdWx0KShvYmplY3QsIHByb3BlcnR5KTsKCiAgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgewogICAgdmFyIHBhcmVudCA9ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKG9iamVjdCk7CgogICAgaWYgKHBhcmVudCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7CiAgICB9CiAgfSBlbHNlIGlmICgidmFsdWUiIGluIGRlc2MpIHsKICAgIHJldHVybiBkZXNjLnZhbHVlOwogIH0gZWxzZSB7CiAgICB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7CgogICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsKICB9Cn07CgovKioqLyB9KSwKLyogMTI0ICovLAovKiAxMjUgKi8sCi8qIDEyNiAqLywKLyogMTI3ICovLAovKiAxMjggKi8sCi8qIDEyOSAqLywKLyogMTMwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX3Byb21pc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCnZhciBfYXNzaWduID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzYpOwoKdmFyIF9hc3NpZ24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXNzaWduKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE5KTsKCnZhciBfRGF0YU9iamVjdFJlcG9ydGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RSZXBvcnRlcik7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE4KTsKCnZhciBfRGF0YU9iamVjdE9ic2VydmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RPYnNlcnZlcik7Cgp2YXIgX0RhdGFQcm92aXNpb25hbCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMzKTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFQcm92aXNpb25hbCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogVGhlIG1haW4gY2xhc3MgZm9yIHRoZSBzeW5jaGVyIHBhY2thZ2UuCiogVGhlIFN5bmNoZXIgaXMgYSBzaW5nbGV0b24gY2xhc3MgcGVyIEh5cGVydHkvVVJMIGFuZCBpdCBpcyB0aGUgb3duZXIgb2YgYWxsIGNyZWF0ZWQgRGF0YSBTeW5jIE9iamVjdHMgYWNjb3JkaW5nIHRvIHRoZSBSZXBvcnRlciAtIE9ic2VydmVyIHBhdHRlcm4uCiogTWFpbiBmdW5jdGlvbmFsaXR5IGlzIHRvIGNyZWF0ZSByZXBvcnRlcnMgYW5kIHRvIHN1YnNjcmliZSB0byBleGlzdGluZyBvbmVzLgoqLwp2YXIgU3luY2hlciA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgX293bmVyOiBVUkwKICBfYnVzOiBNaW5pQnVzCiAgIF9zdWJVUkw6IFVSTAogICBfcmVwb3J0ZXJzOiA8dXJsOiBEYXRhT2JqZWN0UmVwb3J0ZXI+CiAgX29ic2VydmVyczogPHVybDogRGF0YU9iamVjdE9ic2VydmVyPgogIF9wcm92aXNpb25hbHM6IDx1cmw6IERhdGFQcm92aXNpb25hbD4KICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vbk5vdGlmaWNhdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlc3VtZTogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgKiBDb25zdHJ1Y3RvciB0aGF0IHNob3VsZCBiZSB1c2VkIGJ5IHRoZSBIeXBlcnR5IG93bmVyCiAgKiBAcGFyYW0ge0h5cGVydHlVUkx9IG93bmVyIC0gSHlwZXJ0eSBVUkwgb3duZXIuIEFuIFVSTCBhbGxvY2F0ZWQgYnkgdGhlIHJ1bnRpbWUgdGhhdCB1bmlxdWVseSBpZGVudGlmaWVzIHRoZSBIeXBlcnR5LgogICogQHBhcmFtIHtNaW5pQnVzfSBidXMgLSBBbiBpbnN0YW5jZSBvZiB0aGUgTWluaUJ1cyBwcm92aWRlZCBpbiB0aGUgc2FuZGJveC4gV2hlbiBhbiBvYmplY3QgKFJlcG9ydGVyIG9yIE9ic2VydmVkKSBpcyBjcmVhdGVkLCB0aGUgU3luY2hlck1hbmFnZXIgd2lsbCBhZGQgYSBsaXN0ZW5lciBpbiB0aGUgTWluaUJ1cyB0byByZWNlaXZlL3NlbmQgTWVzc2FnZXMgb2YgdGhhdCBvYmplY3QuCiAgKiBAcGFyYW0ge0pTT059IGNvbmZpZyAtIENvbmZpZ3VyYXRpb24gZGF0YS4gVGhlIG9ubHkgcmVxdWlyZWQgZmllbGQgZm9yIG5vdyBpcyB0aGUgcnVudGltZVVSTC4KICAqLwogIGZ1bmN0aW9uIFN5bmNoZXIob3duZXIsIGJ1cywgY29uZmlnKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBTeW5jaGVyKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX2J1cyA9IGJ1czsKCiAgICBfdGhpcy5fc3ViVVJMID0gY29uZmlnLnJ1bnRpbWVVUkwgKyAnL3NtJzsKCiAgICBfdGhpcy5fcmVwb3J0ZXJzID0ge307CiAgICBfdGhpcy5fb2JzZXJ2ZXJzID0ge307CiAgICBfdGhpcy5fcHJvdmlzaW9uYWxzID0ge307CgogICAgYnVzLmFkZExpc3RlbmVyKG93bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikgewogICAgICAgIGNvbnNvbGUuaW5mbygnW1N5bmNoZXJdIFN5bmNoZXItUkNWOiAnLCBtc2cpOwogICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgIGNhc2UgJ2ZvcndhcmQnOgogICAgICAgICAgICBfdGhpcy5fb25Gb3J3YXJkKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdjcmVhdGUnOgogICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVDcmVhdGUobXNnKTticmVhazsKICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAgIF90aGlzLl9vblJlbW90ZURlbGV0ZShtc2cpO2JyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQoKICAvKioKICAqIFRoZSBvd25lciBvZiB0aGUgU3luY2hlciBhbmQgYWxsIGNyZWF0ZWQgcmVwb3J0ZXJzLgogICogQHR5cGUge0h5cGVydHlVUkx9CiAgKi8KCgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKFN5bmNoZXIsIFt7CiAgICBrZXk6ICdjcmVhdGUnLAoKCiAgICAvKioKICAgICogUmVxdWVzdCBhIERhdGFPYmplY3RSZXBvcnRlciBjcmVhdGlvbi4gVGhlIFVSTCB3aWxsIGJlIGJlIHJlcXVlc3RlZCBieSB0aGUgYWxsb2NhdGlvbiBtZWNoYW5pc20uCiAgICAqIEBwYXJhbSAge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hCiAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIC0gTGlzdCBvZiBoeXBlcnRpZXMgdGhhdCBhcmUgcHJlLWF1dGhvcml6ZWQgZm9yIHN1YnNjcmlwdGlvbgogICAgKiBAcGFyYW0gIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICogQHBhcmFtICB7c3RyaW5nfSBvYmplY3RVUkwgLSByZXVzYWJsZSBkYXRhT2JqZWN0IFVSTAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IFJlcG9ydGVyLiBUaGUgcmVwb3J0ZXIgY2FuIGJlIGFjY2VwdGVkIG9yIHJlamVjdGVkIGJ5IHRoZSBQRVAKICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKHNjaGVtYSwgb2JzZXJ2ZXJzLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgc3RvcmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgcDJwID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiBmYWxzZTsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBjcml0ZXJpYSA9IHt9OwoKICAgICAgY3JpdGVyaWEucDJwID0gcDJwOwogICAgICBjcml0ZXJpYS5zdG9yZSA9IHN0b3JlOwogICAgICBjcml0ZXJpYS5zY2hlbWEgPSBzY2hlbWE7CiAgICAgIGNyaXRlcmlhLm9ic2VydmVycyA9IG9ic2VydmVyczsKICAgICAgY3JpdGVyaWEuaW5pdGlhbERhdGEgPSBpbml0aWFsRGF0YTsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUgUmVwb3J0ZXIgLSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogZmFsc2UgfSk7CgogICAgICByZXR1cm4gX3RoaXMuX2NyZWF0ZShjcml0ZXJpYSk7CiAgICB9CiAgfSwgewogICAga2V5OiAncmVzdW1lUmVwb3J0ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVSZXBvcnRlcnMoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBSZXBvcnRlciAtIGNyaXRlcmlhOiAnLCBjcml0ZXJpYSk7CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiB0cnVlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9jcmVhdGUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtTY2hlbWFVUkx9IHNjaGVtYSAtIEh5cGVydHkgQ2F0YWxvZ3VlIFVSTCBhZGRyZXNzIHRoYXQgY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIEpTT04tU2NoZW1hIGRlc2NyaWJpbmcgdGhlIERhdGEgT2JqZWN0IHNjaGVtYQogICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gQWRkcmVzcyBvZiB0aGUgZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIG9ic2VydmVkCiAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3N0b3JlPWZhbHNlXSAtIFNhdmUgdGhlIHN1YnNjcmlwdGlvbiBvbiB0aGUgU3luY2hlciBNYW5hZ2VyIGZvciBmdXJ0aGVyIHJlc3VtZSAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbcDJwPWZhbHNlXSAtIEluZm8gYWJvdXQgaWYgc2hvdWxkIHVzZSBwMnAgY29ubmVjdGlvbiAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbbXV0dWFsPXRydWVdIC0gSW5mbyBhYm91dCBpZiBtZXNzYWdlcyBvZiB0aGlzIG9iamVjdCBzaG91bGQgYmUgZW5jcnlwdGVkIChEZWZhdWx0IGlzIHRydWUpCiAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdE9ic2VydmVyPn0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgb2JzZXJ2ZXIuIEl0J3MgYXNzb2NpYXRlZCB3aXRoIHRoZSByZXBvcnRlci4KICAgICovCgogIH0sIHsKICAgIGtleTogJ3N1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3Vic2NyaWJlKHNjaGVtYSwgb2JqVVJMKSB7CiAgICAgIHZhciBzdG9yZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgIHZhciBwMnAgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgbXV0dWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB0cnVlOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGNyaXRlcmlhID0ge307CgogICAgICBjcml0ZXJpYS5wMnAgPSBwMnA7CiAgICAgIGNyaXRlcmlhLnN0b3JlID0gc3RvcmU7CiAgICAgIGNyaXRlcmlhLnNjaGVtYSA9IHNjaGVtYTsKICAgICAgY3JpdGVyaWEucmVzb3VyY2UgPSBvYmpVUkw7CgogICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgIGNyaXRlcmlhLm11dHVhbCA9IG11dHVhbDsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIHN1YnNjcmliZV0gLSBzdWJzY3JpYmUgY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCiAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShjcml0ZXJpYSwgeyByZXN1bWU6IGZhbHNlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9zdWJzY3JpYmUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtjcml0ZXJpYX0gY3JpdGVyaWEgLSBJbmZvcm1hdGlvbiB0byBkaXNjb3ZlcnkgdGhlIG9ic2VydmVyIG9iamVjdAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXN1bWVPYnNlcnZlcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZU9ic2VydmVycyhjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgX2NyaXRlcmlhID0gY3JpdGVyaWEgfHwge307CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoX2NyaXRlcmlhLCB7IHJlc3VtZTogdHJ1ZSB9KTsKCiAgICAgIHJldHVybiBfdGhpcy5fc3Vic2NyaWJlKF9jcml0ZXJpYSk7CiAgICB9CgogICAgLyoqCiAgICAqIFJlcXVlc3QgYSByZWFkIGFjdGlvbiBvbiB0aGUgcmVwb3J0ZXIgb2JqZWN0CiAgICAqIEBwYXJhbSB7T2JqZWN0VVJMfSBvYmpVUkwgLSBVUkwgb2YgdGhlIHJlcG9ydGVyIG9iamVjdCB0byBiZSByZWFkCiAgICAqIEByZXR1cm4ge1Byb21pc2U8T2JqZWN0Pn0gUmV0dXJuIFByb21pc2UgdG8gbGFzdCBhdmFpbGFibGUgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICovCgogIH0sIHsKICAgIGtleTogJ3JlYWQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWQob2JqVVJMKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIHJlcG9ydGVyIG9iamVjdCAobWF5YmUgdGhlcmUgaXMgbm8gbGlzdGVuZXIgYXZhaWxhYmxlLCBzbyBpdCB3aWxsIGJlIHJlc29sdmVkIHdpdGggTWVzc2FnZUJ1cyAtPiByZXNvbHZlKQogICAgICAvL3dpbGwgcmVhY2ggdGhlIHJlbW90ZSBvYmplY3QgaW4gRGF0YU9iamVjdFJlcG9ydGVyIC0+IF9vblJlYWQKICAgICAgdmFyIHJlYWRNc2cgPSB7CiAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBvYmpVUkwKICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVhZE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygncmVhZC1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIGV2ZW50cyBvZiByZW1vdmUgUmVwb3J0ZXIgb2JqZWN0cy4KICAgICogVGhpcyBpcyByZWxlYXRlZCB0byB0aGUgbWVzc2FnZW5zIHNlbnQgYnkgY3JlYXRlIHRvIHRoZSBvYnNlcnZlcnMgSHlwZXJ0eSBhcnJheS4KICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgKi8KCiAgfSwgewogICAga2V5OiAnb25Ob3RpZmljYXRpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uTm90aWZpY2F0aW9uKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ19jcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciByZXN1bWUgPSBjcml0ZXJpYS5yZXN1bWU7CiAgICAgICAgdmFyIGluaXRpYWxEYXRhID0gY3JpdGVyaWEuaW5pdGlhbERhdGEgfHwge307CiAgICAgICAgdmFyIHNjaGVtYSA9IHZvaWQgMDsKCiAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKICAgICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keTogeyByZXN1bWU6IHJlc3VtZSB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXTogJywgY3JpdGVyaWEsIHJlcXVlc3RNc2cpOwoKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUgPSBpbml0aWFsRGF0YTsKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUucmVwb3J0ZXIgPSBfdGhpcy5fb3duZXI7CgogICAgICAgIGlmIChjcml0ZXJpYS5zY2hlbWEpIHsKICAgICAgICAgIHNjaGVtYSA9IGNyaXRlcmlhLnNjaGVtYTsKICAgICAgICAgIHJlcXVlc3RNc2cuYm9keS5zY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CiAgICAgICAgfQoKICAgICAgICBpZiAoY3JpdGVyaWEucDJwKSByZXF1ZXN0TXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgIGlmIChjcml0ZXJpYS5zdG9yZSkgcmVxdWVzdE1zZy5ib2R5LnN0b3JlID0gY3JpdGVyaWEuc3RvcmU7CiAgICAgICAgaWYgKGNyaXRlcmlhLm9ic2VydmVycykgcmVxdWVzdE1zZy5ib2R5LmF1dGhvcmlzZSA9IGNyaXRlcmlhLm9ic2VydmVyczsKCiAgICAgICAgaWYgKHJlc3VtZSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9CgogICAgICAgIC8vcmVxdWVzdCBjcmVhdGUgdG8gdGhlIGFsbG9jYXRpb24gc3lzdGVtLiBDYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIFBvbGljeUVuZ2luZS4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gYWNjZXB0ZWQKICAgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgICBpZiAocmVzdW1lKSB7CiAgICAgICAgICAgICAgc2NoZW1hID0gcmVwbHkuYm9keS5zY2hlbWE7CiAgICAgICAgICAgICAgaW5pdGlhbERhdGEgPSByZXBseS5ib2R5LnZhbHVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgc2NoZW1hLCAnb24nLCBpbml0aWFsRGF0YSwgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CiAgICAgICAgICAgIF90aGlzLl9yZXBvcnRlcnNbb2JqVVJMXSA9IG5ld09iajsKCiAgICAgICAgICAgIHJlc29sdmUobmV3T2JqKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gcmVqZWN0ZWQKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zdWJzY3JpYmUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsU3Vic2NyaWJlCiAgICAgICAgdmFyIHN1YnNjcmliZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keToge30KICAgICAgICB9OwoKICAgICAgICAvLyBIeXBlcnR5IHJlcXVlc3QgdG8gYmUgYW4gT2JzZXJ2ZXIKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNoeXBlcnR5LXJlcXVlc3QtdG8tYmUtYW4tb2JzZXJ2ZXIKCiAgICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIHRoZSBzYW1lIEh5cGVydHkgVVJMCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLXRoZS1zYW1lLWh5cGVydHktdXJsCgogICAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciBhIGNlcnRhaW4gdXNlciBhbmQgZGF0YSBzY2hlbWEgaW5kZXBlbmRlbnRseSBvZiB0aGUgSHlwZXJ0eSBVUkwuCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLWEtY2VydGFpbi11c2VyLWFuZC1kYXRhLXNjaGVtYS1pbmRlcGVuZGVudGx5LW9mLXRoZS1oeXBlcnR5LXVybAogICAgICAgIGlmIChjcml0ZXJpYSkgewogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdwMnAnKSkgc3Vic2NyaWJlTXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzdG9yZScpKSBzdWJzY3JpYmVNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzY2hlbWEnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdpZGVudGl0eScpKSBzdWJzY3JpYmVNc2cuYm9keS5pZGVudGl0eSA9IGNyaXRlcmlhLmlkZW50aXR5OwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZScpKSBzdWJzY3JpYmVNc2cuYm9keS5yZXNvdXJjZSA9IGNyaXRlcmlhLnJlc291cmNlOwogICAgICAgIH0KCiAgICAgICAgc3Vic2NyaWJlTXNnLmJvZHkucmVzdW1lID0gY3JpdGVyaWEucmVzdW1lOwoKICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgdmFyIG11dHVhbEF1dGhlbnRpY2F0aW9uID0gY3JpdGVyaWEubXV0dWFsOwogICAgICAgIGlmICghbXV0dWFsQXV0aGVudGljYXRpb24pIHN1YnNjcmliZU1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUgbWVzc2FnZTogJywgY3JpdGVyaWEsIHN1YnNjcmliZU1zZyk7CgogICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KICAgICAgICAvL1Byb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICAgICAgICAvL2ZvciBtb3JlIGluZm8gc2VlIHRoZSBEYXRhUHJvdmlzaW9uYWwgY2xhc3MgZG9jdW1lbnRhdGlvbi4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gc3Vic2NyaWJlLXJlc3BvbnNlOiAnLCByZXBseSk7CgogICAgICAgICAgdmFyIHNjaGVtYSA9IHJlcGx5LmJvZHkuc2NoZW1hOwogICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgdmFyIG5ld1Byb3Zpc2lvbmFsID0gX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKICAgICAgICAgIGlmIChuZXdQcm92aXNpb25hbCkgbmV3UHJvdmlzaW9uYWwuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlIDwgMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YVByb3Zpc2lvbmFsOiAnLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzLCBvYmpVUkwpOwogICAgICAgICAgICBuZXdQcm92aXNpb25hbCA9IG5ldyBfRGF0YVByb3Zpc2lvbmFsMi5kZWZhdWx0KF90aGlzLl9vd25lciwgb2JqVVJMLCBfdGhpcy5fYnVzLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKICAgICAgICAgICAgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdID0gbmV3UHJvdmlzaW9uYWw7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YSBPYmplY3QgT2JzZXJ2ZXI6ICcsIHJlcGx5LCBfdGhpcy5fcHJvdmlzaW9uYWxzKTsKCiAgICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgICAgdmFyIG5ld09iaiA9IG5ldyBfRGF0YU9iamVjdE9ic2VydmVyMi5kZWZhdWx0KF90aGlzLCBvYmpVUkwsIHNjaGVtYSwgJ29uJywgcmVwbHkuYm9keS52YWx1ZSwgbmV3UHJvdmlzaW9uYWwuY2hpbGRyZW4sIHJlcGx5LmJvZHkudmVyc2lvbiwgbXV0dWFsQXV0aGVudGljYXRpb24pOwogICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF0gPSBuZXdPYmo7CgogICAgICAgICAgICByZXNvbHZlKG5ld09iaik7CiAgICAgICAgICAgIG5ld1Byb3Zpc2lvbmFsLmFwcGx5KG5ld09iaik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSBsb2NhbCBydW50aW1lIFJlcG9ydGVyT2JqZWN0IC0+IF9vblJlbW90ZVN1YnNjcmliZQoKICB9LCB7CiAgICBrZXk6ICdfb25Gb3J3YXJkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Gb3J3YXJkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHJlcG9ydGVyID0gX3RoaXMuX3JlcG9ydGVyc1ttc2cuYm9keS50b107CiAgICAgIHJlcG9ydGVyLl9vbkZvcndhcmQobXNnKTsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBTeW5jaGVyIC0+IGNyZWF0ZSAodGhpcyBpcyBhY3R1YWxseSBhbiBpbnZpdGF0aW9uIHRvIHN1YnNjcmliZSkKCiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVDcmVhdGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5mcm9tLnNsaWNlKDAsIC0xMyk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmJvZHkuc291cmNlLAogICAgICAgIHVybDogcmVzb3VyY2UsCiAgICAgICAgc2NoZW1hOiBtc2cuYm9keS5zY2hlbWEsCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgYWNrOiBmdW5jdGlvbiBhY2sodHlwZSkgewogICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgbFR5cGUgPSB0eXBlOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbU3luY2hlcl0gTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gZGVsZXRlCgogIH0sIHsKICAgIGtleTogJ19vblJlbW90ZURlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVtb3RlRGVsZXRlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9yZW1vdmUgIi9zdWJzY3JpcHRpb24iIGZyb20gdGhlIFVSTAogICAgICB2YXIgcmVzb3VyY2UgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIHZhciBvYmplY3QgPSBfdGhpcy5fb2JzZXJ2ZXJzW3Jlc291cmNlXTsKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIHZhciBldmVudCA9IHsKICAgICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgICAgdXJsOiByZXNvdXJjZSwKICAgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgICBhY2s6IGZ1bmN0aW9uIGFjayh0eXBlKSB7CiAgICAgICAgICAgIHZhciBsVHlwZSA9IDIwMDsKICAgICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgICBsVHlwZSA9IHR5cGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vVE9ETzogYW55IG90aGVyIGRpZmZlcmVudCBvcHRpb25zIGZvciB0aGUgcmVsZWFzZSBwcm9jZXNzLCBsaWtlIGFjY2VwdCBidXQgbm9yIHJlbGVhc2UgbG9jYWw/CiAgICAgICAgICAgIGlmIChsVHlwZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgb2JqZWN0LmRlbGV0ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL3NlbmQgYWNrIHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgICAgYm9keTogeyBjb2RlOiBsVHlwZSwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBpZiAoX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcikgewogICAgICAgICAgY29uc29sZS5sb2coJ05PVElGSUNBVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwNCwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnb3duZXInLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9vd25lcjsKICAgIH0KCiAgICAvKioKICAgICogQWxsIG93bmVkIHJlcG9ydGVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBjcmVhdGUKICAgICogQHR5cGUge09iamVjdDxVUkwsIERhdGFPYmplY3RSZXBvcnRlcj59CiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnRlcnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9yZXBvcnRlcnM7CiAgICB9CgogICAgLyoqCiAgICAqIEFsbCBvd25lZCBvYnNlcnZlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgbG9jYWwgc3Vic2NyaXB0aW9uCiAgICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0T2JzZXJ2ZXI+fQogICAgKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZXJzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fb2JzZXJ2ZXJzOwogICAgfQogIH1dKTsKICByZXR1cm4gU3luY2hlcjsKfSgpOyAvKioKICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICoKICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgKgogICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAqCiAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IFN5bmNoZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEzMSAqLywKLyogMTMyICovLAovKiAxMzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovKioKICogQGFjY2VzcyBwcml2YXRlCiAqIFRoaXMgY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIGNvbGxlY3RpbmcgZGVsdGEgY2hhbmdlcyBpbiByZW1vdGUgb2JqZWN0cywgYmVmb3JlIHRoZSByZXNwb25zZSBvZiBzdWJzY3JpcHRpb24gcmVhY2ggdGhlIG9ic2VydmVyLgogKiBJdCdzIHVzZWQgaW4gU3luY2hlciAtPiBzdWJzY3JpYmUuIFRoZSBmbG93IGlzIGRlZmluZWQgYXM6CiAqIDEuIChvYnNlcnZlcikgLS1zdWJzY3JpYmUtLT4gKHJlcG9ydGVyKQogKiAyLiAob2JzZXJ2ZXIpIDwtLWRlbHRhIHVwZGF0ZXMtLSAocmVwb3J0ZXIpCiAqIDMuIChvYnNlcnZlcikgPC0tc3Vic2NyaWJlIHJlc3BvbnNlLS0gKHJlcG9ydGVyKQogKiBUaGlzIG1lYW5zIHRoYXQgdGhlcmUgY291bGQgYmUgZGVsdGEgdXBkYXRlcyB0cmFuc2ZlcnJlZCBiZWZvcmUgdGhlIHN1YnNjcmlwdGlvbiBjb25maXJtYXRpb24uCiAqIFNpbmNlIHRoZXJlIGlzIG5vIERhdGFPYmplY3RPYnNlcnZlciBiZWZvcmUgdGhlIHVic2NyaXB0aW9uIGNvbmZpcm1hdGlvbiwgdGhlcmUgc2hvdWxkIGJlIHNvbWUgb3RoZXIgb2JqZWN0IGNvbGxlY3RpbmcgdGhlIHVwZGF0ZXMuCiAqIFByb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICovCnZhciBEYXRhUHJvdmlzaW9uYWwgPSBmdW5jdGlvbiAoKSB7CiAgLyogcHJpdmF0ZQogIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXQogIF9saXN0ZW5lcjogTXNnTGlzdGVuZXIKICAgX2NoYW5nZXM6IFtdCiAgKi8KCiAgZnVuY3Rpb24gRGF0YVByb3Zpc2lvbmFsKG93bmVyLCB1cmwsIGJ1cywgY2hpbGRyZW4pIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFQcm92aXNpb25hbCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl91cmwgPSB1cmw7CiAgICBfdGhpcy5fYnVzID0gYnVzOwogICAgX3RoaXMuX2NoaWxkcmVuID0gY2hpbGRyZW47CgogICAgX3RoaXMuX2NoYW5nZXMgPSBbXTsKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YVByb3Zpc2lvbmFsLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YVByb3Zpc2lvbmFsLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgX3RoaXMuX2NoYW5nZXMucHVzaChtc2cpOwogICAgICB9KTsKCiAgICAgIC8qCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwogICAgICBpZiAoX3RoaXMuX2NoaWxkcmVuKSB7CiAgICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IHVybCArICcvY2hpbGRyZW4vJzsKICAgICAgICBfdGhpcy5fY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHsKICAgICAgICAgIGxldCBjaGlsZFVSTCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOwogICAgICAgICAgbGV0IGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgKG1zZykgPT4gewogICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCiAgICAgICAgICAgIGlmIChtc2cuZnJvbSAhPT0gb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0qLwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKCiAgICAgIC8qX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7CiAgICAgICAgbGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgIH0pOyovCiAgICB9CiAgfSwgewogICAga2V5OiAnYXBwbHknLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5KG9ic2VydmVyKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIF90aGlzLl9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZSkgewogICAgICAgIG9ic2VydmVyLl9jaGFuZ2VPYmplY3Qob2JzZXJ2ZXIuX3N5bmNPYmosIGNoYW5nZSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ2NoaWxkcmVuJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW47CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhUHJvdmlzaW9uYWw7Cn0oKTsKCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFQcm92aXNpb25hbDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTM0ICovLAovKiAxMzUgKi8sCi8qIDEzNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzcgKi8sCi8qIDEzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0NSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzkgKi8sCi8qIDE0MCAqLywKLyogMTQxICovLAovKiAxNDIgKi8sCi8qIDE0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDE0OSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3QuYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NCAqLywKLyogMTQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTUxKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7CiAgcmV0dXJuICRPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpOwp9OwoKLyoqKi8gfSksCi8qIDE0NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyAxOS4xLjIuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlLCAuLi4pCnZhciBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpCiAgLCBnT1BTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCiAgLCB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJT2JqZWN0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpCiAgLCAkYXNzaWduICA9IE9iamVjdC5hc3NpZ247CgovLyBzaG91bGQgd29yayB3aXRoIHN5bWJvbHMgYW5kIHNob3VsZCBoYXZlIGRldGVybWluaXN0aWMgcHJvcGVydHkgb3JkZXIgKFY4IGJ1ZykKbW9kdWxlLmV4cG9ydHMgPSAhJGFzc2lnbiB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHZhciBBID0ge30KICAgICwgQiA9IHt9CiAgICAsIFMgPSBTeW1ib2woKQogICAgLCBLID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0JzsKICBBW1NdID0gNzsKICBLLnNwbGl0KCcnKS5mb3JFYWNoKGZ1bmN0aW9uKGspeyBCW2tdID0gazsgfSk7CiAgcmV0dXJuICRhc3NpZ24oe30sIEEpW1NdICE9IDcgfHwgT2JqZWN0LmtleXMoJGFzc2lnbih7fSwgQikpLmpvaW4oJycpICE9IEs7Cn0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycwogIHZhciBUICAgICA9IHRvT2JqZWN0KHRhcmdldCkKICAgICwgYUxlbiAgPSBhcmd1bWVudHMubGVuZ3RoCiAgICAsIGluZGV4ID0gMQogICAgLCBnZXRTeW1ib2xzID0gZ09QUy5mCiAgICAsIGlzRW51bSAgICAgPSBwSUUuZjsKICB3aGlsZShhTGVuID4gaW5kZXgpewogICAgdmFyIFMgICAgICA9IElPYmplY3QoYXJndW1lbnRzW2luZGV4KytdKQogICAgICAsIGtleXMgICA9IGdldFN5bWJvbHMgPyBnZXRLZXlzKFMpLmNvbmNhdChnZXRTeW1ib2xzKFMpKSA6IGdldEtleXMoUykKICAgICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAogICAgICAsIGogICAgICA9IDAKICAgICAgLCBrZXk7CiAgICB3aGlsZShsZW5ndGggPiBqKWlmKGlzRW51bS5jYWxsKFMsIGtleSA9IGtleXNbaisrXSkpVFtrZXldID0gU1trZXldOwogIH0gcmV0dXJuIFQ7Cn0gOiAkYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NyAqLywKLyogMTQ4ICovLAovKiAxNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSkKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYsICdPYmplY3QnLCB7YXNzaWduOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Nil9KTsKCi8qKiovIH0pLAovKiAxNTAgKi8sCi8qIDE1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApCnZhciB0b0lPYmplY3QgICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KS5mOwoKX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2dldE93blByb3BlcnR5RGVzY3JpcHRvcicsIGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICAgIHJldHVybiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRvSU9iamVjdChpdCksIGtleSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTUyICovLAovKiAxNTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gICAgIHByb3h5LW9ic2VydmUgdjAuMC4xOAovLyAgICAgQ29weXJpZ2h0IChjKSAyMDE1LCAyMDE2IFNpbW9uIFkuIEJsYWNrd2VsbCwgQW55V2hpY2hXYXkKLy8gICAgIE1JVCBMaWNlbnNlIC0gaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocAooZnVuY3Rpb24oKSB7CgkidXNlIHN0cmljdCI7CgkvLyBDcmVhdGVzIGFuZCByZXR1cm5zIGEgUHJveHkgd3JhcHBpbmcgYSB0YXJnZXQgc28gdGhhdCBhbGwgY2hhbmdlcyBjYW4gYmUgdHJhcHBlZCBhbmQgZm9yd2FyZGVkIHRvCgkvLyBhIGNhbGxiYWNrLiBUaGUgY2FsbGJhY2sgdGFrZXMgYW4gYXJyYXkgb2YgY2hhbmdlcyBqdXN0IGxpa2UgdGhlIHRyYWRpdGlvbmFsIG9yaWdpbmFsIENocm9tZSBPYmplY3Qub2JzZXJ2ZQoJLy8ge29iamVjdDo8b2JqZWN0IGNoYW5nZWQ+LG5hbWU6PGZpZWxkIGNoYW5nZWQ+LHR5cGU6YWRkfHVwZGF0ZXxkZWxldGV8cmVjb25maWd1cmV8cHJldmVudEV4dGVuc2lvbnN8c2V0UHJvdG90eXBlLG9sZFZhbHVlOjxvbGQgdmFsdWUgaWYgdXBkYXRlIHwgZGVsZXRlPn0KCS8vIFRoZSBhY2NlcHRsaXN0IGNhbiBiZSBhZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUuCgkvLyB2IDAuMC4xMCB0byBzdXBwb3J0IHBhdXNpbmcgYW5kIHJlc3RhcnRpbmcgb2JzZXJ2YXRpb24gdHdvIGFkZGl0aW9uYWwgY29uc3RydWN0b3IgYXJndW1lbnRzIGFyZSBhdmFpbGFibGUgdG8gT2JqZWN0Lm9ic2VydmU6CgkvLyBwYXVzYWJsZSAtIGNyZWF0ZSB0aGUgT2JzZXJ2ZXIgc28gaXQgY2FuIGJlIHBhdXNlZAoJLy8gcGF1c2UgLSBjcmVhdGUgb2JzZXJ2ZXIgaW4gcGF1c2VkIHN0YXRlCgkvLyBpZiBwYXVzYWJsZSBpcyB0cnVlIHRoZW4gYW4gYWRkaXRpb25hbCBtZXRob2QgZGVsaXZlcihpZ25vcmVQcmV2aW91cykgaXMgYXZhaWxhYmxlIHRvIHN0YXJ0IGRlbGl2ZXJ5CgkvLyB0byBwYXVzZSBkZWxpdmVyeSBzZXQgYSBwcm9wZXJ0eSBjYWxsZWQgcGF1c2Ugb24gdGhlIGZ1bmN0aW9uIGRlbGl2ZXIgdG8gdHJ1ZQoJLy8gcGF1c2FibGUgaXMgb3B0aW9uYWwgdG8gcmVkdWNlIHRoZSBjaGFuY2Ugb2Ygc2hhZG93aW5nIGEgcHJvcGVydHkgb3IgbWV0aG9kIG9uIGFueSBleGlzdGluZyBjb2RlIGNhbGxlZCBkZWxpdmVyCglpZighT2JqZWN0Lm9ic2VydmUgJiYgdHlwZW9mKFByb3h5KT09PSJmdW5jdGlvbiIpIHsKCQlmdW5jdGlvbiBPYnNlcnZlcih0YXJnZXQsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgewoJICAgIAl2YXIgbWUgPSB0aGlzLCBwcm94eTsKCSAgICAJZnVuY3Rpb24gZGVsaXZlcihpZ25vcmVQcmV2aW91cyxkZWxheSkgewoJICAgIAkJZGVsaXZlci5kZWxheSA9IGRlbGF5OwoJICAgIAkJaWYoIWRlbGl2ZXIucGF1c2UpIHsKCSAgICAgICAgCQlpZihtZS5jaGFuZ2VzZXQubGVuZ3RoPjApIHsKCSAgICAgICAgCQkJaWYoIWlnbm9yZVByZXZpb3VzKSB7CgkJICAgIAkgICAgCQl2YXIgY2hhbmdlcyA9IG1lLmNoYW5nZXNldC5maWx0ZXIoZnVuY3Rpb24oY2hhbmdlKSB7IHJldHVybiAhYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wOyB9KTsKCQkgICAgICAgIAkJCWlmKGNoYW5nZXMubGVuZ3RoPjApIHsKCQkgICAgICAgIAkJCQljYWxsYmFjayhjaGFuZ2VzKTsKCQkgICAgICAgIAkJCX0KCSAgICAgICAgCQkJfQoJICAgICAgICAJCQltZS5jaGFuZ2VzZXQgPSBbXTsKCSAgICAgICAgCQl9CgkgICAgCQl9CgkgICAgCX0KCSAgICAJZGVsaXZlci5wYXVzZSA9IHBhdXNlOwoJICAgIAlkZWxpdmVyLmRlbGF5ID0gZGVsYXk7CgkJICAgIG1lLmdldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCQkgICAgCWlmKHByb3BlcnR5PT09Il9fb2JzZXJ2ZXJfXyIpIHsKCQkgICAgCQlyZXR1cm4gbWU7CgkJICAgIAl9CgkJICAgIAlpZihwcm9wZXJ0eT09PSJ1bm9ic2VydmUiKSB7CgkJICAgIAkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCSAgICAJCQlPYmplY3QudW5vYnNlcnZlKHRhcmdldCk7CgkJICAgIAkJCXJldHVybiB0YXJnZXQ7CgkJICAgIAkJfTsKCQkgICAgCX0KCQkgICAgCWlmKHByb3BlcnR5PT09ImRlbGl2ZXIiKSB7CgkJICAgIAkJcmV0dXJuIGRlbGl2ZXI7CgkJICAgIAl9CgkJICAgIAlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCQkgICAgfQoJICAgIAltZS50YXJnZXQgPSB0YXJnZXQ7CgkgICAgCW1lLmNoYW5nZXNldCA9IFtdOwoJICAgIAlpZighbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXykgewoJICAgIAkJLy8gX19vYnNlcnZlckNhbGxiYWNrc19fIGlzIHVzZWQgYXMgYW4gaW5kZXggdG8gZ2V0IGF0IHRoZSBwcm94eSB3aGljaCBpcyB0aGUgb2JzZXJ2ZXIsIHNvIHdlIGNhbiB1bm9ic2VydmUKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJDYWxsYmFja3NfXyIse2VudW1lcmFibGU6ZmFsc2UsY29uZmlndXJhYmxlOnRydWUsd3JpdGFibGU6ZmFsc2UsdmFsdWU6W119KTsKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJzX18iLHtlbnVtZXJhYmxlOmZhbHNlLGNvbmZpZ3VyYWJsZTp0cnVlLHdyaXRhYmxlOmZhbHNlLHZhbHVlOltdfSk7CgkgICAgCX0KCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5wdXNoKGNhbGxiYWNrKTsKCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJzX18ucHVzaCh0aGlzKTsKCSAgICAJcHJveHkgPSBuZXcgUHJveHkodGFyZ2V0LG1lKTsKCSAgICAJZGVsaXZlcihmYWxzZSxkZWxheSk7CgkgICAgCXJldHVybiBwcm94eTsKCSAgICB9CgkJT2JzZXJ2ZXIucHJvdG90eXBlLmRlbGl2ZXIgPSBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMuZ2V0KG51bGwsImRlbGl2ZXIiKTsKCQl9CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIHZhbHVlKSB7IC8vICwgcmVjZWl2ZXIKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJdmFyIHR5cGUgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKTsKCSAgICAJdGFyZ2V0W3Byb3BlcnR5XSA9IHZhbHVlOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICghdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKHR5cGUpPj0wKSkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZTp0eXBlfSwKCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAgICAgCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAlpZih0eXBlPT09InVwZGF0ZSIpIHsKCSAgICAgICAgCQljaGFuZ2Uub2xkVmFsdWUgPSBvbGR2YWx1ZTsKCSAgICAgICAgCX0KCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWxldGVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJLy9pZih0eXBlb2Yob2xkdmFsdWUpIT09InVuZGVmaW5lZCIpIHsKCQkgICAgCWRlbGV0ZSB0YXJnZXRbcHJvcGVydHldOwoJCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJkZWxldGUiKT49MCkgewoJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6ImRlbGV0ZSIsb2xkVmFsdWU6b2xkdmFsdWV9LAoJCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCQkgICAgICAgIAkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCQkgICAgICAgIAlpZihzdGFydCkgewoJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJCSAgICAgICAgCX0KCQkgICAgCX0KCSAgICAJLy99CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcikgewoJICAgIAlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcik7CgkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigicmVjb25maWd1cmUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZToicmVjb25maWd1cmUifSwKICAgICAgICAJCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKICAgICAgICAJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7CgkgICAgICAgIAlpZihzdGFydCkgewoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7CgkgICAgICAgIAl9CgkgICAgCX0KCSAgICAJcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBPYnNlcnZlci5wcm90b3R5cGUuc2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbih0YXJnZXQsIHByb3RvdHlwZSkgewoJICAgIAl2YXIgb2xkdmFsdWUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KTsKCSAgICAJT2JqZWN0LnNldFByb3RvdHlwZU9mKHRhcmdldCwgcHJvdG90eXBlKTsKCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJzZXRQcm90b3R5cGUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6Il9fcHJvdG9fXyIsdHlwZToic2V0UHJvdG90eXBlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sCiAgICAJCQkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsCiAgICAJCQkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgICAgICAJaWYoc3RhcnQpIHsKCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgICAgICAJfQoJICAgIAl9CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnByZXZlbnRFeHRlbnNpb25zID0gZnVuY3Rpb24odGFyZ2V0KSB7CgkgICAgICAgIE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh0YXJnZXQpOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInByZXZlbnRFeHRlbnNpb25zIik+PTApIHsKCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCx0eXBlOiJwcmV2ZW50RXh0ZW5zaW9ucyJ9LAoJCQkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLAoJCQkJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsKCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9iamVjdC5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJcmV0dXJuIG5ldyBPYnNlcnZlcihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSk7CgkgICAgfTsKCSAgICBPYmplY3QudW5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrKSB7CgkgICAgCWlmKG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsKCSAgICAJCWlmKCFjYWxsYmFjaykgewoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uc3BsaWNlKDAsb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5sZW5ndGgpOwoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZSgwLG9iamVjdC5fX29ic2VydmVyc19fLmxlbmd0aCk7CgkgICAgCQkJcmV0dXJuOwoJICAgIAkJfQoJICAgIAkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5mb3JFYWNoKGZ1bmN0aW9uKG9ic2VydmVyY2FsbGJhY2ssaSkgewoJICAgIAkJCWlmKGNhbGxiYWNrPT09b2JzZXJ2ZXJjYWxsYmFjaykgewoJICAgIAkJCQlvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLnNwbGljZShpLDEpOwoJICAgIAkJCQlkZWxldGUgb2JqZWN0Ll9fb2JzZXJ2ZXJzX19baV0uY2FsbGJhY2s7CgkgICAgCQkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZShpLDEpOwoJICAgIAkJCX0KCSAgICAJCX0pOwoJICAgIAl9CgkgICAgfTsKCSAgICBBcnJheS5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJaWYoIShvYmplY3QgaW5zdGFuY2VvZiBBcnJheSkgJiYgIUFycmF5LmlzQXJyYXkob2JqZWN0KSkgewoJICAgIAkJdGhyb3cgbmV3IFR5cGVFcnJvcigiRmlyc3QgYXJndW1lbnQgdG8gQXJyYXkub2JzZXJ2ZXIgaXMgbm90IGFuIEFycmF5Iik7CgkgICAgCX0KICAgICAgICAgICAgCWFjY2VwdGxpc3QgPSBhY2NlcHRsaXN0IHx8IFsiYWRkIiwgInVwZGF0ZSIsICJkZWxldGUiLCAic3BsaWNlIl07CgkgICAgCXZhciBhcnJheXByb3h5ID0gbmV3IFByb3h5KG9iamVjdCx7Z2V0OiBmdW5jdGlvbih0YXJnZXQscHJvcGVydHkpIHsKCSAgICAJCWlmKHByb3BlcnR5PT09InVub2JzZXJ2ZSIpIHsKCQkgICAgCQlyZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2spIHsKCQkgICAgCQkJaWYoY2FsbGJhY2spIHsKCQkgICAgCQkJCXJldHVybiBPYmplY3QudW5vYnNlcnZlKHRhcmdldCxjYWxsYmFjayk7CgkJICAgIAkJCX0KCQkgICAgCQkJcmV0dXJuIHRhcmdldC51bm9ic2VydmUoKTsKCQkgICAgCQl9OwoJCSAgICAJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic3BsaWNlIikgewoJICAgIAkJCXJldHVybiBmdW5jdGlvbihzdGFydCxlbmQpIHsKCSAgICAJCQkJaWYodHlwZW9mKHN0YXJ0KSE9PSJudW1iZXIiIHx8IHR5cGVvZihlbmQpIT09Im51bWJlciIpIHsKCSAgICAJCQkJCXRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IHR3byBhcmd1bWVudHMgdG8gQXJyYXkgc3BsaWNlIGFyZSBub3QgbnVtYmVyLCBudW1iZXIiKTsKCSAgICAJCQkJfQoJICAgIAkgICAgCQl2YXIgcmVtb3ZlZCA9IHRoaXMuc2xpY2Uoc3RhcnQsc3RhcnQrZW5kKSwKCSAgICAJICAgIAkJCWFkZGVkQ291bnQgPSAoYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHMubGVuZ3RoLTIgOiAwKSwKCSAgICAJICAgIAkJCWNoYW5nZSA9ICB7b2JqZWN0Om9iamVjdCx0eXBlOiJzcGxpY2UiLGluZGV4OnN0YXJ0LHJlbW92ZWQ6cmVtb3ZlZCxhZGRlZENvdW50OmFkZGVkQ291bnR9OwoJICAgIAkgICAgCQl0YXJnZXQuc3BsaWNlLmFwcGx5KHRhcmdldCxhcmd1bWVudHMpOwoJICAgIAkgICAgCQlpZihhY2NlcHRsaXN0LmluZGV4T2YoInNwbGljZSIpPj0wKSB7CgkgICAgCSAgICAJCQl2YXIgc3RhcnQgPSBwcm94eS5fX29ic2VydmVyX18uY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAJICAgICAgICAJCQlkZWxpdmVyID0gcHJveHkuX19vYnNlcnZlcl9fLmRlbGl2ZXIoKTsKCSAgICAJICAgIAkJCXByb3h5Ll9fb2JzZXJ2ZXJfXy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgIAkgICAgCQkJaWYoc3RhcnQpIHsKCSAgICAJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgIAkJICAgICAgICAJfQoJICAgIAkgICAgCQl9CgkgICAgCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icHVzaCIpIHsKCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHsKCSAgICAJCSAgICAJcmV0dXJuIHRoaXMuc3BsaWNlKHRoaXMubGVuZ3RoLDAsaXRlbSk7CgkgICAgCQkgICAgfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icG9wIikgewoJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oKSB7CgkgICAgCQkgICAgCXJldHVybiB0aGlzLnNwbGljZSh0aGlzLmxlbmd0aC0xLDEpOwoJICAgIAkJICAgIH0KCSAgICAJCX0KCSAgICAJCWlmKHByb3BlcnR5PT09InVuc2hpZnQiKSB7CgkgICAgCQkJIHJldHVybiBmdW5jdGlvbihpdGVtKSB7CiAgICAJCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDAsaXRlbSk7CiAgICAJCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic2hpZnQiKSB7CgkgICAgCQkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJICAgIAkgICAgCQlyZXR1cm4gdGhpcy5zcGxpY2UoMCwxKTsKCSAgICAJICAgIAl9CgkgICAgCQl9CgkgICAgCQlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJfX0pOwoJICAgIAl2YXIgcHJveHkgPSBPYmplY3Qub2JzZXJ2ZShhcnJheXByb3h5LGZ1bmN0aW9uKGNoYW5nZXNldCkgeyAKCSAgICAJCXZhciBjaGFuZ2VzID0gY2hhbmdlc2V0LmZpbHRlcihmdW5jdGlvbihjaGFuZ2UpIHsgcmV0dXJuIGNoYW5nZS5uYW1lIT09Imxlbmd0aCIgJiYgY2hhbmdlLm5hbWUhPT0iYWRkIiAmJiAoIWFjY2VwdGxpc3QgfHwgYWNjZXB0bGlzdC5pbmRleE9mKGNoYW5nZS50eXBlKT49MCk7IH0pOwoJICAgIAkJaWYoY2hhbmdlcy5sZW5ndGg+MCkgewoJICAgIAkJCWNhbGxiYWNrKGNoYW5nZXMpOwoJICAgIAkJfQoJICAgIAl9LGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpOwoJICAgIAlyZXR1cm4gcHJveHk7CgkgICAgfTsKCSAgICBBcnJheS51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsKCQkgIHJldHVybiBvYmplY3QudW5vYnNlcnZlKGNhbGxiYWNrKTsKCSAgICB9Cgl9CglPYmplY3QuZGVlcE9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2sscGFydHMpIHsKCgkJcGFydHMgPSAocGFydHMgPyBwYXJ0cyA6IFtdKTsKCgkJdmFyIHRvVHlwZU5hbWUgPSBmdW5jdGlvbihvYmopIHsKCQkJcmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvYmopLm1hdGNoKC9ccyhbYS16QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKQoJCX0KCgkJZnVuY3Rpb24gcmVvYnNlcnZlKHZhbHVlLCBwYXJ0cykgewoJCQl2YXIga2V5cyA9IE9iamVjdC5rZXlzKHZhbHVlKTsKCQkJa2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJaWYoKHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdvYmplY3QnIHx8IHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdhcnJheScpICYmICF2YWx1ZVtrZXldLmhhc093blByb3BlcnR5KCdfX29ic2VydmVyc19fJykpIHsKCQkJCQl2YXIgbmV3cGFydHMgPSBwYXJ0cy5zbGljZSgwKTsKCQkJCQluZXdwYXJ0cy5wdXNoKGtleSk7CgkJCQkJdmFsdWVba2V5XSA9IE9iamVjdC5kZWVwT2JzZXJ2ZSh2YWx1ZVtrZXldLGNhbGxiYWNrLG5ld3BhcnRzKTsKCQkJCX0KCQkJfSk7CgkJfQoKCQlyZW9ic2VydmUob2JqZWN0LCBwYXJ0cyk7CgoJCXZhciBvYnNlcnZlZCA9IE9iamVjdC5vYnNlcnZlKG9iamVjdCxmdW5jdGlvbihjaGFuZ2VzZXQpIHsKCQkJdmFyIGNoYW5nZXMgPSBbXTsKCQkJZnVuY3Rpb24gcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0LG5ld09iamVjdCxwYXRoKSB7CgkJCQlpZihuZXdPYmplY3QgaW5zdGFuY2VvZiBPYmplY3QpIHsKCQkJCQl2YXIgbmV3a2V5cyA9IE9iamVjdC5rZXlzKG5ld09iamVjdCk7CgkJCQkJbmV3a2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJCQlpZighb2xkT2JqZWN0IHx8IChvbGRPYmplY3Rba2V5XSE9PW5ld09iamVjdFtrZXldKSkgewoJCQkJCQkJdmFyIG9sZHZhbHVlID0gKG9sZE9iamVjdCAmJiBvbGRPYmplY3Rba2V5XSE9PXVuZGVmaW5lZCA/IG9sZE9iamVjdFtrZXldIDogdW5kZWZpbmVkKSwKCQkJCQkJCQljaGFuZ2UgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKSwKCQkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCgkJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGR2YWx1ZSxuZXdWYWx1ZTpuZXdPYmplY3Rba2V5XSxrZXlwYXRoOmtleXBhdGh9KTsKCQkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZHZhbHVlLG5ld09iamVjdFtrZXldLGtleXBhdGgpOwoJCQkJCQl9CgkJCQkJfSk7CgkJCQl9IGVsc2UgaWYob2xkT2JqZWN0IGluc3RhbmNlb2YgT2JqZWN0KSB7CgkJCQkJdmFyIG9sZGtleXMgPSBPYmplY3Qua2V5cyhvbGRPYmplY3QpOwoJCQkJCW9sZGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsKCQkJCQkJdmFyIGNoYW5nZSA9IChuZXdPYmplY3Q9PT1udWxsID8gInVwZGF0ZSIgOiAiZGVsZXRlIiksCgkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCQkJCQkJCQoJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGRPYmplY3Rba2V5XSxuZXdWYWx1ZTpuZXdPYmplY3Qsa2V5cGF0aDprZXlwYXRofSk7CgkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZE9iamVjdFtrZXldLHVuZGVmaW5lZCxrZXlwYXRoKTsKCQkJCQl9KTsKCQkJCX0KCQkJfQoJCQljaGFuZ2VzZXQuZm9yRWFjaChmdW5jdGlvbihjaGFuZ2UpIHsKCQkJCXZhciBrZXlwYXRoID0gKHBhcnRzLmxlbmd0aD4wID8gcGFydHMuam9pbigiLiIpICsgIi4iIDogIiIpICsgY2hhbmdlLm5hbWU7CgoJCQkJaWYgKGNoYW5nZS50eXBlID09PSAidXBkYXRlIiB8fCBjaGFuZ2UudHlwZSA9PT0gImFkZCIpIHsgCgkJCQkJcmVvYnNlcnZlKGNoYW5nZS5vYmplY3QsIHBhcnRzKTsKCQkJCX0KCgkJCQljaGFuZ2VzLnB1c2goe25hbWU6Y2hhbmdlLm5hbWUsb2JqZWN0OmNoYW5nZS5vYmplY3QsdHlwZTpjaGFuZ2UudHlwZSxvbGRWYWx1ZTpjaGFuZ2Uub2xkVmFsdWUsbmV3VmFsdWU6Y2hhbmdlLm9iamVjdFtjaGFuZ2UubmFtZV0sa2V5cGF0aDprZXlwYXRofSk7CgkJCQlyZWN1cnNlKGNoYW5nZS5uYW1lLGNoYW5nZS5vYmplY3QsY2hhbmdlLm9sZFZhbHVlLGNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGgpOwoJCQl9KTsKCQkJY2FsbGJhY2soY2hhbmdlcyk7CgkJfSk7CgkJcmV0dXJuIG9ic2VydmVkOwoJfTsKfSkoKTsKCgovKioqLyB9KSwKLyogMTU0ICovLAovKiAxNTUgKi8sCi8qIDE1NiAqLywKLyogMTU3ICovLAovKiAxNTggKi8sCi8qIDE1OSAqLywKLyogMTYwICovLAovKiAxNjEgKi8sCi8qIDE2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkRhdGFPYmplY3RPYnNlcnZlciA9IGV4cG9ydHMuRGF0YU9iamVjdFJlcG9ydGVyID0gZXhwb3J0cy5TeW5jaGVyID0gdW5kZWZpbmVkOwoKdmFyIF9TeW5jaGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzApOwoKdmFyIF9TeW5jaGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1N5bmNoZXIpOwoKdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOSk7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuU3luY2hlciA9IF9TeW5jaGVyMi5kZWZhdWx0OwpleHBvcnRzLkRhdGFPYmplY3RSZXBvcnRlciA9IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQ7CmV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdDsKCi8qKiovIH0pCi8qKioqKiovIF0pOwp9KTsKCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwoKJ3VzZSBzdHJpY3QnOwoKLy8gU2hpbW1pbmcgc3RhcnRzIGhlcmUuCihmdW5jdGlvbigpIHsKICAvLyBVdGlscy4KICB2YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7CiAgdmFyIGxvZ2dpbmcgPSB1dGlscy5sb2c7CiAgdmFyIGJyb3dzZXJEZXRhaWxzID0gdXRpbHMuYnJvd3NlckRldGFpbHM7CiAgLy8gRXhwb3J0IHRvIHRoZSBhZGFwdGVyIGdsb2JhbCBvYmplY3QgdmlzaWJsZSBpbiB0aGUgYnJvd3Nlci4KICBtb2R1bGUuZXhwb3J0cy5icm93c2VyRGV0YWlscyA9IGJyb3dzZXJEZXRhaWxzOwogIG1vZHVsZS5leHBvcnRzLmV4dHJhY3RWZXJzaW9uID0gdXRpbHMuZXh0cmFjdFZlcnNpb247CiAgbW9kdWxlLmV4cG9ydHMuZGlzYWJsZUxvZyA9IHV0aWxzLmRpc2FibGVMb2c7CgogIC8vIFVuY29tbWVudCB0aGUgbGluZSBiZWxvdyBpZiB5b3Ugd2FudCBsb2dnaW5nIHRvIG9jY3VyLCBpbmNsdWRpbmcgbG9nZ2luZwogIC8vIGZvciB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdy4gQ2FuIGFsc28gYmUgdHVybmVkIG9uIGluIHRoZSBicm93c2VyIHZpYQogIC8vIGFkYXB0ZXIuZGlzYWJsZUxvZyhmYWxzZSksIGJ1dCB0aGVuIGxvZ2dpbmcgZnJvbSB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdwogIC8vIHdpbGwgbm90IGFwcGVhci4KICAvLyByZXF1aXJlKCcuL3V0aWxzJykuZGlzYWJsZUxvZyhmYWxzZSk7CgogIC8vIEJyb3dzZXIgc2hpbXMuCiAgdmFyIGNocm9tZVNoaW0gPSByZXF1aXJlKCcuL2Nocm9tZS9jaHJvbWVfc2hpbScpIHx8IG51bGw7CiAgdmFyIGVkZ2VTaGltID0gcmVxdWlyZSgnLi9lZGdlL2VkZ2Vfc2hpbScpIHx8IG51bGw7CiAgdmFyIGZpcmVmb3hTaGltID0gcmVxdWlyZSgnLi9maXJlZm94L2ZpcmVmb3hfc2hpbScpIHx8IG51bGw7CiAgdmFyIHNhZmFyaVNoaW0gPSByZXF1aXJlKCcuL3NhZmFyaS9zYWZhcmlfc2hpbScpIHx8IG51bGw7CgogIC8vIFNoaW0gYnJvd3NlciBpZiBmb3VuZC4KICBzd2l0Y2ggKGJyb3dzZXJEZXRhaWxzLmJyb3dzZXIpIHsKICAgIGNhc2UgJ2Nocm9tZSc6CiAgICAgIGlmICghY2hyb21lU2hpbSB8fCAhY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdDaHJvbWUgc2hpbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhpcyBhZGFwdGVyIHJlbGVhc2UuJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGxvZ2dpbmcoJ2FkYXB0ZXIuanMgc2hpbW1pbmcgY2hyb21lLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGNocm9tZVNoaW07CgogICAgICBjaHJvbWVTaGltLnNoaW1HZXRVc2VyTWVkaWEoKTsKICAgICAgY2hyb21lU2hpbS5zaGltTWVkaWFTdHJlYW0oKTsKICAgICAgdXRpbHMuc2hpbUNyZWF0ZU9iamVjdFVSTCgpOwogICAgICBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QoKTsKICAgICAgY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgY2hyb21lU2hpbS5zaGltT25UcmFjaygpOwogICAgICBicmVhazsKICAgIGNhc2UgJ2ZpcmVmb3gnOgogICAgICBpZiAoIWZpcmVmb3hTaGltIHx8ICFmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdGaXJlZm94IHNoaW0gaXMgbm90IGluY2x1ZGVkIGluIHRoaXMgYWRhcHRlciByZWxlYXNlLicpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBsb2dnaW5nKCdhZGFwdGVyLmpzIHNoaW1taW5nIGZpcmVmb3guJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gZmlyZWZveFNoaW07CgogICAgICBmaXJlZm94U2hpbS5zaGltR2V0VXNlck1lZGlhKCk7CiAgICAgIHV0aWxzLnNoaW1DcmVhdGVPYmplY3RVUkwoKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbVNvdXJjZU9iamVjdCgpOwogICAgICBmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbU9uVHJhY2soKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdlZGdlJzoKICAgICAgaWYgKCFlZGdlU2hpbSB8fCAhZWRnZVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uKSB7CiAgICAgICAgbG9nZ2luZygnTVMgZWRnZSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBlZGdlLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGVkZ2VTaGltOwoKICAgICAgZWRnZVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMKCk7CiAgICAgIGVkZ2VTaGltLnNoaW1QZWVyQ29ubmVjdGlvbigpOwogICAgICBicmVhazsKICAgIGNhc2UgJ3NhZmFyaSc6CiAgICAgIGlmICghc2FmYXJpU2hpbSkgewogICAgICAgIGxvZ2dpbmcoJ1NhZmFyaSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBzYWZhcmkuJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gc2FmYXJpU2hpbTsKCiAgICAgIHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgIGxvZ2dpbmcoJ1Vuc3VwcG9ydGVkIGJyb3dzZXIhJyk7CiAgfQp9KSgpOwoKfSx7Ii4vY2hyb21lL2Nocm9tZV9zaGltIjo0LCIuL2VkZ2UvZWRnZV9zaGltIjo2LCIuL2ZpcmVmb3gvZmlyZWZveF9zaGltIjo4LCIuL3NhZmFyaS9zYWZhcmlfc2hpbSI6MTAsIi4vdXRpbHMiOjExfV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CgovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzLmpzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgY2hyb21lU2hpbSA9IHsKICBzaGltTWVkaWFTdHJlYW06IGZ1bmN0aW9uKCkgewogICAgd2luZG93Lk1lZGlhU3RyZWFtID0gd2luZG93Lk1lZGlhU3RyZWFtIHx8IHdpbmRvdy53ZWJraXRNZWRpYVN0cmVhbTsKICB9LAoKICBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmICEoJ29udHJhY2snIGluCiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUsICdvbnRyYWNrJywgewogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5fb250cmFjazsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24oZikgewogICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgaWYgKHRoaXMuX29udHJhY2spIHsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFjaycsIHRoaXMuX29udHJhY2spOwogICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5KTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrID0gZik7CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5ID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAvLyBvbmFkZHN0cmVhbSBkb2VzIG5vdCBmaXJlIHdoZW4gYSB0cmFjayBpcyBhZGRlZCB0byBhbiBleGlzdGluZwogICAgICAgICAgICAvLyBzdHJlYW0uIEJ1dCBzdHJlYW0ub25hZGR0cmFjayBpcyBpbXBsZW1lbnRlZCBzbyB3ZSB1c2UgdGhhdC4KICAgICAgICAgICAgZS5zdHJlYW0uYWRkRXZlbnRMaXN0ZW5lcignYWRkdHJhY2snLCBmdW5jdGlvbih0ZSkgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRlLnRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0ZS50cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGUuc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHsKICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ3RyYWNrJyk7CiAgICAgICAgICAgICAgZXZlbnQudHJhY2sgPSB0cmFjazsKICAgICAgICAgICAgICBldmVudC5yZWNlaXZlciA9IHt0cmFjazogdHJhY2t9OwogICAgICAgICAgICAgIGV2ZW50LnN0cmVhbXMgPSBbZS5zdHJlYW1dOwogICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgICB9LmJpbmQodGhpcykpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKCiAgc2hpbVNvdXJjZU9iamVjdDogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHsKICAgICAgaWYgKHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50ICYmCiAgICAgICAgISgnc3JjT2JqZWN0JyBpbiB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUpKSB7CiAgICAgICAgLy8gU2hpbSB0aGUgc3JjT2JqZWN0IHByb3BlcnR5LCBvbmNlLCB3aGVuIEhUTUxNZWRpYUVsZW1lbnQgaXMgZm91bmQuCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyY09iamVjdCcsIHsKICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zcmNPYmplY3Q7CiAgICAgICAgICB9LAogICAgICAgICAgc2V0OiBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgICAvLyBVc2UgX3NyY09iamVjdCBhcyBhIHByaXZhdGUgcHJvcGVydHkgZm9yIHRoaXMgc2hpbQogICAgICAgICAgICB0aGlzLl9zcmNPYmplY3QgPSBzdHJlYW07CiAgICAgICAgICAgIGlmICh0aGlzLnNyYykgewogICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5zcmMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIXN0cmVhbSkgewogICAgICAgICAgICAgIHRoaXMuc3JjID0gJyc7CiAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTsKICAgICAgICAgICAgLy8gV2UgbmVlZCB0byByZWNyZWF0ZSB0aGUgYmxvYiB1cmwgd2hlbiBhIHRyYWNrIGlzIGFkZGVkIG9yCiAgICAgICAgICAgIC8vIHJlbW92ZWQuIERvaW5nIGl0IG1hbnVhbGx5IHNpbmNlIHdlIHdhbnQgdG8gYXZvaWQgYSByZWN1cnNpb24uCiAgICAgICAgICAgIHN0cmVhbS5hZGRFdmVudExpc3RlbmVyKCdhZGR0cmFjaycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIGlmIChzZWxmLnNyYykgewogICAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChzZWxmLnNyYyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHNlbGYuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc3RyZWFtLmFkZEV2ZW50TGlzdGVuZXIoJ3JlbW92ZXRyYWNrJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgaWYgKHNlbGYuc3JjKSB7CiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHNlbGYuc3JjKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgc2VsZi5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIC8vIFRoZSBSVENQZWVyQ29ubmVjdGlvbiBvYmplY3QuCiAgICBpZiAoIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikgewogICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gPSBmdW5jdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cykgewogICAgICAgIC8vIFRyYW5zbGF0ZSBpY2VUcmFuc3BvcnRQb2xpY3kgdG8gaWNlVHJhbnNwb3J0cywKICAgICAgICAvLyBzZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD00ODY5CiAgICAgICAgLy8gdGhpcyB3YXMgZml4ZWQgaW4gTTU2IGFsb25nIHdpdGggdW5wcmVmaXhpbmcgUlRDUGVlckNvbm5lY3Rpb24uCiAgICAgICAgbG9nZ2luZygnUGVlckNvbm5lY3Rpb24nKTsKICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5KSB7CiAgICAgICAgICBwY0NvbmZpZy5pY2VUcmFuc3BvcnRzID0gcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CiAgICAgIC8vIHdyYXAgc3RhdGljIG1ldGhvZHMuIEN1cnJlbnRseSBqdXN0IGdlbmVyYXRlQ2VydGlmaWNhdGUuCiAgICAgIGlmICh3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5nZW5lcmF0ZUNlcnRpZmljYXRlKSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiwgJ2dlbmVyYXRlQ2VydGlmaWNhdGUnLCB7CiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gd2Via2l0UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIHZhciBvcmlnR2V0U3RhdHMgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHM7CiAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbihzZWxlY3RvciwKICAgICAgICBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgYXJncyA9IGFyZ3VtZW50czsKCiAgICAgIC8vIElmIHNlbGVjdG9yIGlzIGEgZnVuY3Rpb24gdGhlbiB3ZSBhcmUgaW4gdGhlIG9sZCBzdHlsZSBzdGF0cyBzbyBqdXN0CiAgICAgIC8vIHBhc3MgYmFjayB0aGUgb3JpZ2luYWwgZ2V0U3RhdHMgZm9ybWF0IHRvIGF2b2lkIGJyZWFraW5nIG9sZCB1c2Vycy4KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHJldHVybiBvcmlnR2V0U3RhdHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgLy8gV2hlbiBzcGVjLXN0eWxlIGdldFN0YXRzIGlzIHN1cHBvcnRlZCwgcmV0dXJuIHRob3NlIHdoZW4gY2FsbGVkIHdpdGgKICAgICAgLy8gZWl0aGVyIG5vIGFyZ3VtZW50cyBvciB0aGUgc2VsZWN0b3IgYXJndW1lbnQgaXMgbnVsbC4KICAgICAgaWYgKG9yaWdHZXRTdGF0cy5sZW5ndGggPT09IDAgJiYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHwKICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpKSB7CiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbXSk7CiAgICAgIH0KCiAgICAgIHZhciBmaXhDaHJvbWVTdGF0c18gPSBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgIHZhciBzdGFuZGFyZFJlcG9ydCA9IHt9OwogICAgICAgIHZhciByZXBvcnRzID0gcmVzcG9uc2UucmVzdWx0KCk7CiAgICAgICAgcmVwb3J0cy5mb3JFYWNoKGZ1bmN0aW9uKHJlcG9ydCkgewogICAgICAgICAgdmFyIHN0YW5kYXJkU3RhdHMgPSB7CiAgICAgICAgICAgIGlkOiByZXBvcnQuaWQsCiAgICAgICAgICAgIHRpbWVzdGFtcDogcmVwb3J0LnRpbWVzdGFtcCwKICAgICAgICAgICAgdHlwZTogewogICAgICAgICAgICAgIGxvY2FsY2FuZGlkYXRlOiAnbG9jYWwtY2FuZGlkYXRlJywKICAgICAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgICAgICB9W3JlcG9ydC50eXBlXSB8fCByZXBvcnQudHlwZQogICAgICAgICAgfTsKICAgICAgICAgIHJlcG9ydC5uYW1lcygpLmZvckVhY2goZnVuY3Rpb24obmFtZSkgewogICAgICAgICAgICBzdGFuZGFyZFN0YXRzW25hbWVdID0gcmVwb3J0LnN0YXQobmFtZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHN0YW5kYXJkUmVwb3J0W3N0YW5kYXJkU3RhdHMuaWRdID0gc3RhbmRhcmRTdGF0czsKICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIHN0YW5kYXJkUmVwb3J0OwogICAgICB9OwoKICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICB2YXIgbWFrZU1hcFN0YXRzID0gZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICByZXR1cm4gbmV3IE1hcChPYmplY3Qua2V5cyhzdGF0cykubWFwKGZ1bmN0aW9uKGtleSkgewogICAgICAgICAgcmV0dXJuW2tleSwgc3RhdHNba2V5XV07CiAgICAgICAgfSkpOwogICAgICB9OwoKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMikgewogICAgICAgIHZhciBzdWNjZXNzQ2FsbGJhY2tXcmFwcGVyXyA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICBhcmdzWzFdKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgfTsKCiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbc3VjY2Vzc0NhbGxiYWNrV3JhcHBlcl8sCiAgICAgICAgICAgIGFyZ3VtZW50c1swXV0pOwogICAgICB9CgogICAgICAvLyBwcm9taXNlLXN1cHBvcnQKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIG9yaWdHZXRTdGF0cy5hcHBseShzZWxmLCBbCiAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICByZXNvbHZlKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgICB9LCByZWplY3RdKTsKICAgICAgfSkudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spOwogICAgfTsKCiAgICAvLyBhZGQgcHJvbWlzZSBzdXBwb3J0IC0tIG5hdGl2ZWx5IGF2YWlsYWJsZSBpbiBDaHJvbWUgNTEKICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNTEpIHsKICAgICAgWydzZXRMb2NhbERlc2NyaXB0aW9uJywgJ3NldFJlbW90ZURlc2NyaXB0aW9uJywgJ2FkZEljZUNhbmRpZGF0ZSddCiAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzOwogICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFthcmdzWzBdLCByZXNvbHZlLCByZWplY3RdKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGFyZ3NbMV0uYXBwbHkobnVsbCwgW10pOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZnVuY3Rpb24oZXJyKSB7CiAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPj0gMykgewogICAgICAgICAgICAgICAgICBhcmdzWzJdLmFwcGx5KG51bGwsIFtlcnJdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgfQoKICAgIC8vIHByb21pc2Ugc3VwcG9ydCBmb3IgY3JlYXRlT2ZmZXIgYW5kIGNyZWF0ZUFuc3dlci4gQXZhaWxhYmxlICh3aXRob3V0CiAgICAvLyBidWdzKSBzaW5jZSBNNTI6IGNyYnVnLzYxOTI4OQogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MikgewogICAgICBbJ2NyZWF0ZU9mZmVyJywgJ2NyZWF0ZUFuc3dlciddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDEgfHwgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYKICAgICAgICAgICAgICB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnb2JqZWN0JykpIHsKICAgICAgICAgICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkOwogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFtyZXNvbHZlLCByZWplY3QsIG9wdHNdKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CgogICAgLy8gc2hpbSBpbXBsaWNpdCBjcmVhdGlvbiBvZiBSVENTZXNzaW9uRGVzY3JpcHRpb24vUlRDSWNlQ2FuZGlkYXRlCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfQp9OwoKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbU1lZGlhU3RyZWFtOiBjaHJvbWVTaGltLnNoaW1NZWRpYVN0cmVhbSwKICBzaGltT25UcmFjazogY2hyb21lU2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QsCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBjaHJvbWVTaGltLnNoaW1QZWVyQ29ubmVjdGlvbiwKICBzaGltR2V0VXNlck1lZGlhOiByZXF1aXJlKCcuL2dldHVzZXJtZWRpYScpCn07Cgp9LHsiLi4vdXRpbHMuanMiOjExLCIuL2dldHVzZXJtZWRpYSI6NX1dLDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIGNvbnN0cmFpbnRzVG9DaHJvbWVfID0gZnVuY3Rpb24oYykgewogICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLm1hbmRhdG9yeSB8fCBjLm9wdGlvbmFsKSB7CiAgICAgIHJldHVybiBjOwogICAgfQogICAgdmFyIGNjID0ge307CiAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICBpZiAoa2V5ID09PSAncmVxdWlyZScgfHwga2V5ID09PSAnYWR2YW5jZWQnIHx8IGtleSA9PT0gJ21lZGlhU291cmNlJykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgciA9ICh0eXBlb2YgY1trZXldID09PSAnb2JqZWN0JykgPyBjW2tleV0gOiB7aWRlYWw6IGNba2V5XX07CiAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHIuZXhhY3QgPT09ICdudW1iZXInKSB7CiAgICAgICAgci5taW4gPSByLm1heCA9IHIuZXhhY3Q7CiAgICAgIH0KICAgICAgdmFyIG9sZG5hbWVfID0gZnVuY3Rpb24ocHJlZml4LCBuYW1lKSB7CiAgICAgICAgaWYgKHByZWZpeCkgewogICAgICAgICAgcmV0dXJuIHByZWZpeCArIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gKG5hbWUgPT09ICdkZXZpY2VJZCcpID8gJ3NvdXJjZUlkJyA6IG5hbWU7CiAgICAgIH07CiAgICAgIGlmIChyLmlkZWFsICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjYy5vcHRpb25hbCA9IGNjLm9wdGlvbmFsIHx8IFtdOwogICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgIGlmICh0eXBlb2Ygci5pZGVhbCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCdtaW4nLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICAgIG9jID0ge307CiAgICAgICAgICBvY1tvbGRuYW1lXygnbWF4Jywga2V5KV0gPSByLmlkZWFsOwogICAgICAgICAgY2Mub3B0aW9uYWwucHVzaChvYyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHIuZXhhY3QgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygci5leGFjdCAhPT0gJ251bWJlcicpIHsKICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgY2MubWFuZGF0b3J5W29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuZXhhY3Q7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgWydtaW4nLCAnbWF4J10uZm9yRWFjaChmdW5jdGlvbihtaXgpIHsKICAgICAgICAgIGlmIChyW21peF0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgICAgIGNjLm1hbmRhdG9yeVtvbGRuYW1lXyhtaXgsIGtleSldID0gclttaXhdOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICAgIGlmIChjLmFkdmFuY2VkKSB7CiAgICAgIGNjLm9wdGlvbmFsID0gKGNjLm9wdGlvbmFsIHx8IFtdKS5jb25jYXQoYy5hZHZhbmNlZCk7CiAgICB9CiAgICByZXR1cm4gY2M7CiAgfTsKCiAgdmFyIHNoaW1Db25zdHJhaW50c18gPSBmdW5jdGlvbihjb25zdHJhaW50cywgZnVuYykgewogICAgY29uc3RyYWludHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7CiAgICBpZiAoY29uc3RyYWludHMgJiYgY29uc3RyYWludHMuYXVkaW8pIHsKICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy5hdWRpbyk7CiAgICB9CiAgICBpZiAoY29uc3RyYWludHMgJiYgdHlwZW9mIGNvbnN0cmFpbnRzLnZpZGVvID09PSAnb2JqZWN0JykgewogICAgICAvLyBTaGltIGZhY2luZ01vZGUgZm9yIG1vYmlsZSwgd2hlcmUgaXQgZGVmYXVsdHMgdG8gInVzZXIiLgogICAgICB2YXIgZmFjZSA9IGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgIGZhY2UgPSBmYWNlICYmICgodHlwZW9mIGZhY2UgPT09ICdvYmplY3QnKSA/IGZhY2UgOiB7aWRlYWw6IGZhY2V9KTsKCiAgICAgIGlmICgoZmFjZSAmJiAoZmFjZS5leGFjdCA9PT0gJ3VzZXInIHx8IGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwKICAgICAgICAgICAgICAgICAgICBmYWNlLmlkZWFsID09PSAndXNlcicgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykpICYmCiAgICAgICAgICAhKG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0U3VwcG9ydGVkQ29uc3RyYWludHMgJiYKICAgICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRTdXBwb3J0ZWRDb25zdHJhaW50cygpLmZhY2luZ01vZGUpKSB7CiAgICAgICAgZGVsZXRlIGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgICAgaWYgKGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykgewogICAgICAgICAgLy8gTG9vayBmb3IgImJhY2siIGluIGxhYmVsLCBvciB1c2UgbGFzdCBjYW0gKHR5cGljYWxseSBiYWNrIGNhbSkuCiAgICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzKCkKICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgZGV2aWNlcyA9IGRldmljZXMuZmlsdGVyKGZ1bmN0aW9uKGQpIHsKICAgICAgICAgICAgICByZXR1cm4gZC5raW5kID09PSAndmlkZW9pbnB1dCc7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgYmFjayA9IGRldmljZXMuZmluZChmdW5jdGlvbihkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGQubGFiZWwudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdiYWNrJykgIT09IC0xOwogICAgICAgICAgICB9KSB8fCAoZGV2aWNlcy5sZW5ndGggJiYgZGV2aWNlc1tkZXZpY2VzLmxlbmd0aCAtIDFdKTsKICAgICAgICAgICAgaWYgKGJhY2spIHsKICAgICAgICAgICAgICBjb25zdHJhaW50cy52aWRlby5kZXZpY2VJZCA9IGZhY2UuZXhhY3QgPyB7ZXhhY3Q6IGJhY2suZGV2aWNlSWR9IDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aWRlYWw6IGJhY2suZGV2aWNlSWR9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0Nocm9tZV8oY29uc3RyYWludHMudmlkZW8pOwogICAgICAgICAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgICAgICAgICByZXR1cm4gZnVuYyhjb25zdHJhaW50cyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3RyYWludHMudmlkZW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy52aWRlbyk7CiAgICB9CiAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgcmV0dXJuIGZ1bmMoY29uc3RyYWludHMpOwogIH07CgogIHZhciBzaGltRXJyb3JfID0gZnVuY3Rpb24oZSkgewogICAgcmV0dXJuIHsKICAgICAgbmFtZTogewogICAgICAgIFBlcm1pc3Npb25EZW5pZWRFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgQ29uc3RyYWludE5vdFNhdGlzZmllZEVycm9yOiAnT3ZlcmNvbnN0cmFpbmVkRXJyb3InCiAgICAgIH1bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50TmFtZSwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgc2hpbUNvbnN0cmFpbnRzXyhjb25zdHJhaW50cywgZnVuY3Rpb24oYykgewogICAgICBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKGMsIG9uU3VjY2VzcywgZnVuY3Rpb24oZSkgewogICAgICAgIG9uRXJyb3Ioc2hpbUVycm9yXyhlKSk7CiAgICAgIH0pOwogICAgfSk7CiAgfTsKCiAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IGdldFVzZXJNZWRpYV87CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICBpZiAoIW5hdmlnYXRvci5tZWRpYURldmljZXMpIHsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMgPSB7CiAgICAgIGdldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGVudW1lcmF0ZURldmljZXM6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIga2luZHMgPSB7YXVkaW86ICdhdWRpb2lucHV0JywgdmlkZW86ICd2aWRlb2lucHV0J307CiAgICAgICAgICByZXR1cm4gTWVkaWFTdHJlYW1UcmFjay5nZXRTb3VyY2VzKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgcmVzb2x2ZShkZXZpY2VzLm1hcChmdW5jdGlvbihkZXZpY2UpIHsKICAgICAgICAgICAgICByZXR1cm4ge2xhYmVsOiBkZXZpY2UubGFiZWwsCiAgICAgICAgICAgICAgICAgICAgICBraW5kOiBraW5kc1tkZXZpY2Uua2luZF0sCiAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZDogZGV2aWNlLmlkLAogICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogJyd9OwogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfTsKICB9CgogIC8vIEEgc2hpbSBmb3IgZ2V0VXNlck1lZGlhIG1ldGhvZCBvbiB0aGUgbWVkaWFEZXZpY2VzIG9iamVjdC4KICAvLyBUT0RPKEthcHRlbkphbnNzb24pIHJlbW92ZSBvbmNlIGltcGxlbWVudGVkIGluIENocm9tZSBzdGFibGUuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSkgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cykgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhUHJvbWlzZV8oY29uc3RyYWludHMpOwogICAgfTsKICB9IGVsc2UgewogICAgLy8gRXZlbiB0aG91Z2ggQ2hyb21lIDQ1IGhhcyBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzIGFuZCBhIGdldFVzZXJNZWRpYQogICAgLy8gZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhIFByb21pc2UsIGl0IGRvZXMgbm90IGFjY2VwdCBzcGVjLXN0eWxlCiAgICAvLyBjb25zdHJhaW50cy4KICAgIHZhciBvcmlnR2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEuCiAgICAgICAgYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY3MpIHsKICAgICAgcmV0dXJuIHNoaW1Db25zdHJhaW50c18oY3MsIGZ1bmN0aW9uKGMpIHsKICAgICAgICByZXR1cm4gb3JpZ0dldFVzZXJNZWRpYShjKS50aGVuKGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICAgIGMudmlkZW8gJiYgIXN0cmVhbS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCkgewogICAgICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJycsICdOb3RGb3VuZEVycm9yJyk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gc3RyZWFtOwogICAgICAgIH0sIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KCiAgLy8gRHVtbXkgZGV2aWNlY2hhbmdlIGV2ZW50IG1ldGhvZHMuCiAgLy8gVE9ETyhLYXB0ZW5KYW5zc29uKSByZW1vdmUgb25jZSBpbXBsZW1lbnRlZCBpbiBDaHJvbWUgc3RhYmxlLgogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQp9OwoKfSx7Ii4uL3V0aWxzLmpzIjoxMX1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7Cgp2YXIgU0RQVXRpbHMgPSByZXF1aXJlKCdzZHAnKTsKdmFyIGJyb3dzZXJEZXRhaWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5icm93c2VyRGV0YWlsczsKCnZhciBlZGdlU2hpbSA9IHsKICBzaGltUGVlckNvbm5lY3Rpb246IGZ1bmN0aW9uKCkgewogICAgaWYgKHdpbmRvdy5SVENJY2VHYXRoZXJlcikgewogICAgICAvLyBPUlRDIGRlZmluZXMgYW4gUlRDSWNlQ2FuZGlkYXRlIG9iamVjdCBidXQgbm8gY29uc3RydWN0b3IuCiAgICAgIC8vIE5vdCBpbXBsZW1lbnRlZCBpbiBFZGdlLgogICAgICBpZiAoIXdpbmRvdy5SVENJY2VDYW5kaWRhdGUpIHsKICAgICAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oYXJncykgewogICAgICAgICAgcmV0dXJuIGFyZ3M7CiAgICAgICAgfTsKICAgICAgfQogICAgICAvLyBPUlRDIGRvZXMgbm90IGhhdmUgYSBzZXNzaW9uIGRlc2NyaXB0aW9uIG9iamVjdCBidXQKICAgICAgLy8gb3RoZXIgYnJvd3NlcnMgKGkuZS4gQ2hyb21lKSB0aGF0IHdpbGwgc3VwcG9ydCBib3RoIFBDIGFuZCBPUlRDCiAgICAgIC8vIGluIHRoZSBmdXR1cmUgbWlnaHQgaGF2ZSB0aGlzIGRlZmluZWQgYWxyZWFkeS4KICAgICAgaWYgKCF3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKSB7CiAgICAgICAgd2luZG93LlJUQ1Nlc3Npb25EZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGFyZ3MpIHsKICAgICAgICAgIHJldHVybiBhcmdzOwogICAgICAgIH07CiAgICAgIH0KICAgICAgLy8gdGhpcyBhZGRzIGFuIGFkZGl0aW9uYWwgZXZlbnQgbGlzdGVuZXIgdG8gTWVkaWFTdHJhY2tUcmFjayB0aGF0IHNpZ25hbHMKICAgICAgLy8gd2hlbiBhIHRyYWNrcyBlbmFibGVkIHByb3BlcnR5IHdhcyBjaGFuZ2VkLiBXb3JrYXJvdW5kIGZvciBhIGJ1ZyBpbgogICAgICAvLyBhZGRTdHJlYW0sIHNlZSBiZWxvdy4gTm8gbG9uZ2VyIHJlcXVpcmVkIGluIDE1MDI1KwogICAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDE1MDI1KSB7CiAgICAgICAgdmFyIG9yaWdNU1RFbmFibGVkID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcigKICAgICAgICAgICAgTWVkaWFTdHJlYW1UcmFjay5wcm90b3R5cGUsICdlbmFibGVkJyk7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLCAnZW5hYmxlZCcsIHsKICAgICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgb3JpZ01TVEVuYWJsZWQuc2V0LmNhbGwodGhpcywgdmFsdWUpOwogICAgICAgICAgICB2YXIgZXYgPSBuZXcgRXZlbnQoJ2VuYWJsZWQnKTsKICAgICAgICAgICAgZXYuZW5hYmxlZCA9IHZhbHVlOwogICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24oY29uZmlnKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgIHZhciBfZXZlbnRUYXJnZXQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CiAgICAgIFsnYWRkRXZlbnRMaXN0ZW5lcicsICdyZW1vdmVFdmVudExpc3RlbmVyJywgJ2Rpc3BhdGNoRXZlbnQnXQogICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgICAgIHNlbGZbbWV0aG9kXSA9IF9ldmVudFRhcmdldFttZXRob2RdLmJpbmQoX2V2ZW50VGFyZ2V0KTsKICAgICAgICAgIH0pOwoKICAgICAgdGhpcy5vbmljZWNhbmRpZGF0ZSA9IG51bGw7CiAgICAgIHRoaXMub25hZGRzdHJlYW0gPSBudWxsOwogICAgICB0aGlzLm9udHJhY2sgPSBudWxsOwogICAgICB0aGlzLm9ucmVtb3Zlc3RyZWFtID0gbnVsbDsKICAgICAgdGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlID0gbnVsbDsKICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCA9IG51bGw7CiAgICAgIHRoaXMub25kYXRhY2hhbm5lbCA9IG51bGw7CgogICAgICB0aGlzLmxvY2FsU3RyZWFtcyA9IFtdOwogICAgICB0aGlzLnJlbW90ZVN0cmVhbXMgPSBbXTsKICAgICAgdGhpcy5nZXRMb2NhbFN0cmVhbXMgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gc2VsZi5sb2NhbFN0cmVhbXM7CiAgICAgIH07CiAgICAgIHRoaXMuZ2V0UmVtb3RlU3RyZWFtcyA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBzZWxmLnJlbW90ZVN0cmVhbXM7CiAgICAgIH07CgogICAgICB0aGlzLmxvY2FsRGVzY3JpcHRpb24gPSBuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHsKICAgICAgICB0eXBlOiAnJywKICAgICAgICBzZHA6ICcnCiAgICAgIH0pOwogICAgICB0aGlzLnJlbW90ZURlc2NyaXB0aW9uID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJycsCiAgICAgICAgc2RwOiAnJwogICAgICB9KTsKICAgICAgdGhpcy5zaWduYWxpbmdTdGF0ZSA9ICdzdGFibGUnOwogICAgICB0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSA9ICduZXcnOwogICAgICB0aGlzLmljZUdhdGhlcmluZ1N0YXRlID0gJ25ldyc7CgogICAgICB0aGlzLmljZU9wdGlvbnMgPSB7CiAgICAgICAgZ2F0aGVyUG9saWN5OiAnYWxsJywKICAgICAgICBpY2VTZXJ2ZXJzOiBbXQogICAgICB9OwogICAgICBpZiAoY29uZmlnICYmIGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICBzd2l0Y2ggKGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICAgIGNhc2UgJ2FsbCc6CiAgICAgICAgICBjYXNlICdyZWxheSc6CiAgICAgICAgICAgIHRoaXMuaWNlT3B0aW9ucy5nYXRoZXJQb2xpY3kgPSBjb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgJ25vbmUnOgogICAgICAgICAgICAvLyBGSVhNRTogcmVtb3ZlIG9uY2UgaW1wbGVtZW50YXRpb24gYW5kIHNwZWMgaGF2ZSBhZGRlZCB0aGlzLgogICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpY2VUcmFuc3BvcnRQb2xpY3kgIm5vbmUiIG5vdCBzdXBwb3J0ZWQnKTsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIC8vIGRvbid0IHNldCBpY2VUcmFuc3BvcnRQb2xpY3kuCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnVzaW5nQnVuZGxlID0gY29uZmlnICYmIGNvbmZpZy5idW5kbGVQb2xpY3kgPT09ICdtYXgtYnVuZGxlJzsKCiAgICAgIGlmIChjb25maWcgJiYgY29uZmlnLmljZVNlcnZlcnMpIHsKICAgICAgICAvLyBFZGdlIGRvZXMgbm90IGxpa2UKICAgICAgICAvLyAxKSBzdHVuOgogICAgICAgIC8vIDIpIHR1cm46IHRoYXQgZG9lcyBub3QgaGF2ZSBhbGwgb2YgdHVybjpob3N0OnBvcnQ/dHJhbnNwb3J0PXVkcAogICAgICAgIC8vIDMpIHR1cm46IHdpdGggaXB2NiBhZGRyZXNzZXMKICAgICAgICB2YXIgaWNlU2VydmVycyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29uZmlnLmljZVNlcnZlcnMpKTsKICAgICAgICB0aGlzLmljZU9wdGlvbnMuaWNlU2VydmVycyA9IGljZVNlcnZlcnMuZmlsdGVyKGZ1bmN0aW9uKHNlcnZlcikgewogICAgICAgICAgaWYgKHNlcnZlciAmJiBzZXJ2ZXIudXJscykgewogICAgICAgICAgICB2YXIgdXJscyA9IHNlcnZlci51cmxzOwogICAgICAgICAgICBpZiAodHlwZW9mIHVybHMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgdXJscyA9IFt1cmxzXTsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cmxzID0gdXJscy5maWx0ZXIoZnVuY3Rpb24odXJsKSB7CiAgICAgICAgICAgICAgcmV0dXJuICh1cmwuaW5kZXhPZigndHVybjonKSA9PT0gMCAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHJhbnNwb3J0PXVkcCcpICE9PSAtMSAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHVybjpbJykgPT09IC0xKSB8fAogICAgICAgICAgICAgICAgICAodXJsLmluZGV4T2YoJ3N0dW46JykgPT09IDAgJiYKICAgICAgICAgICAgICAgICAgICBicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE0MzkzKTsKICAgICAgICAgICAgfSlbMF07CiAgICAgICAgICAgIHJldHVybiAhIXVybHM7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnOwoKICAgICAgLy8gcGVyLXRyYWNrIGljZUdhdGhlcnMsIGljZVRyYW5zcG9ydHMsIGR0bHNUcmFuc3BvcnRzLCBydHBTZW5kZXJzLCAuLi4KICAgICAgLy8gZXZlcnl0aGluZyB0aGF0IGlzIG5lZWRlZCB0byBkZXNjcmliZSBhIFNEUCBtLWxpbmUuCiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzID0gW107CgogICAgICAvLyBzaW5jZSB0aGUgaWNlR2F0aGVyZXIgaXMgY3VycmVudGx5IGNyZWF0ZWQgaW4gY3JlYXRlT2ZmZXIgYnV0IHdlCiAgICAgIC8vIG11c3Qgbm90IGVtaXQgY2FuZGlkYXRlcyB1bnRpbCBhZnRlciBzZXRMb2NhbERlc2NyaXB0aW9uIHdlIGJ1ZmZlcgogICAgICAvLyB0aGVtIGluIHRoaXMgYXJyYXkuCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlciA9IFtdOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZScpOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICBpZiAodGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgdGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlKGV2ZW50KTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLmxvY2FsRGVzY3JpcHRpb24uc2RwKTsKICAgICAgLy8gRklYTUU6IG5lZWQgdG8gYXBwbHkgaWNlIGNhbmRpZGF0ZXMgaW4gYSB3YXkgd2hpY2ggaXMgYXN5bmMgYnV0CiAgICAgIC8vIGluLW9yZGVyCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlci5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgdmFyIGVuZCA9ICFldmVudC5jYW5kaWRhdGUgfHwgT2JqZWN0LmtleXMoZXZlbnQuY2FuZGlkYXRlKS5sZW5ndGggPT09IDA7CiAgICAgICAgaWYgKGVuZCkgewogICAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBzZWN0aW9ucy5sZW5ndGg7IGorKykgewogICAgICAgICAgICBpZiAoc2VjdGlvbnNbal0uaW5kZXhPZignXHJcbmE9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJykgPT09IC0xKSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbal0gKz0gJ2E9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWN0aW9uc1tldmVudC5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleCArIDFdICs9CiAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgfQogICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICBzZWxmLm9uaWNlY2FuZGlkYXRlKGV2ZW50KTsKICAgICAgICB9CiAgICAgICAgaWYgKCFldmVudC5jYW5kaWRhdGUgJiYgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSAhPT0gJ2NvbXBsZXRlJykgewogICAgICAgICAgdmFyIGNvbXBsZXRlID0gc2VsZi50cmFuc2NlaXZlcnMuZXZlcnkoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICB0cmFuc2NlaXZlci5pY2VHYXRoZXJlci5zdGF0ZSA9PT0gJ2NvbXBsZXRlZCc7CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChjb21wbGV0ZSAmJiBzZWxmLmljZUdhdGhlcmluZ1N0YXRlQ2hhbmdlICE9PSAnY29tcGxldGUnKSB7CiAgICAgICAgICAgIHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUgPSAnY29tcGxldGUnOwogICAgICAgICAgICBzZWxmLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIgPSBbXTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRDb25maWd1cmF0aW9uID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLl9jb25maWc7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkU3RyZWFtID0gZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE1MDI1KSB7CiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXMucHVzaChzdHJlYW0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIENsb25lIGlzIG5lY2Vzc2FyeSBmb3IgbG9jYWwgZGVtb3MgbW9zdGx5LCBhdHRhY2hpbmcgZGlyZWN0bHkKICAgICAgICAvLyB0byB0d28gZGlmZmVyZW50IHNlbmRlcnMgZG9lcyBub3Qgd29yayAoYnVpbGQgMTA1NDcpLgogICAgICAgIC8vIEZpeGVkIGluIDE1MDI1IChvciBlYXJsaWVyKQogICAgICAgIHZhciBjbG9uZWRTdHJlYW0gPSBzdHJlYW0uY2xvbmUoKTsKICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaywgaWR4KSB7CiAgICAgICAgICB2YXIgY2xvbmVkVHJhY2sgPSBjbG9uZWRTdHJlYW0uZ2V0VHJhY2tzKClbaWR4XTsKICAgICAgICAgIHRyYWNrLmFkZEV2ZW50TGlzdGVuZXIoJ2VuYWJsZWQnLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBjbG9uZWRUcmFjay5lbmFibGVkID0gZXZlbnQuZW5hYmxlZDsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHRoaXMubG9jYWxTdHJlYW1zLnB1c2goY2xvbmVkU3RyZWFtKTsKICAgICAgfQogICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICB2YXIgaWR4ID0gdGhpcy5sb2NhbFN0cmVhbXMuaW5kZXhPZihzdHJlYW0pOwogICAgICBpZiAoaWR4ID4gLTEpIHsKICAgICAgICB0aGlzLmxvY2FsU3RyZWFtcy5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy50cmFuc2NlaXZlcnMuZmlsdGVyKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuICEhdHJhbnNjZWl2ZXIucnRwU2VuZGVyOwogICAgICB9KQogICAgICAubWFwKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLnJ0cFNlbmRlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVjZWl2ZXJzID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLnRyYW5zY2VpdmVycy5maWx0ZXIoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICByZXR1cm4gISF0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSkKICAgICAgLm1hcChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIHJldHVybiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIC8vIERldGVybWluZXMgdGhlIGludGVyc2VjdGlvbiBvZiBsb2NhbCBhbmQgcmVtb3RlIGNhcGFiaWxpdGllcy4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2dldENvbW1vbkNhcGFiaWxpdGllcyA9CiAgICAgICAgZnVuY3Rpb24obG9jYWxDYXBhYmlsaXRpZXMsIHJlbW90ZUNhcGFiaWxpdGllcykgewogICAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHsKICAgICAgICAgICAgY29kZWNzOiBbXSwKICAgICAgICAgICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICAgICAgICAgIGZlY01lY2hhbmlzbXM6IFtdCiAgICAgICAgICB9OwogICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24obENvZGVjKSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3RlQ2FwYWJpbGl0aWVzLmNvZGVjcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIHZhciByQ29kZWMgPSByZW1vdGVDYXBhYmlsaXRpZXMuY29kZWNzW2ldOwogICAgICAgICAgICAgIGlmIChsQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpID09PSByQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpICYmCiAgICAgICAgICAgICAgICAgIGxDb2RlYy5jbG9ja1JhdGUgPT09IHJDb2RlYy5jbG9ja1JhdGUpIHsKICAgICAgICAgICAgICAgIC8vIG51bWJlciBvZiBjaGFubmVscyBpcyB0aGUgaGlnaGVzdCBjb21tb24gbnVtYmVyIG9mIGNoYW5uZWxzCiAgICAgICAgICAgICAgICByQ29kZWMubnVtQ2hhbm5lbHMgPSBNYXRoLm1pbihsQ29kZWMubnVtQ2hhbm5lbHMsCiAgICAgICAgICAgICAgICAgICAgckNvZGVjLm51bUNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIC8vIHB1c2ggckNvZGVjIHNvIHdlIHJlcGx5IHdpdGggb2ZmZXJlciBwYXlsb2FkIHR5cGUKICAgICAgICAgICAgICAgIGNvbW1vbkNhcGFiaWxpdGllcy5jb2RlY3MucHVzaChyQ29kZWMpOwoKICAgICAgICAgICAgICAgIC8vIGRldGVybWluZSBjb21tb24gZmVlZGJhY2sgbWVjaGFuaXNtcwogICAgICAgICAgICAgICAgckNvZGVjLnJ0Y3BGZWVkYmFjayA9IHJDb2RlYy5ydGNwRmVlZGJhY2suZmlsdGVyKGZ1bmN0aW9uKGZiKSB7CiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbENvZGVjLnJ0Y3BGZWVkYmFjay5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGlmIChsQ29kZWMucnRjcEZlZWRiYWNrW2pdLnR5cGUgPT09IGZiLnR5cGUgJiYKICAgICAgICAgICAgICAgICAgICAgICAgbENvZGVjLnJ0Y3BGZWVkYmFja1tqXS5wYXJhbWV0ZXIgPT09IGZiLnBhcmFtZXRlcikgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFsc28gbmVlZCB0byBkZXRlcm1pbmUgLnBhcmFtZXRlcnMKICAgICAgICAgICAgICAgIC8vICBzZWUgaHR0cHM6Ly9naXRodWIuY29tL29wZW5wZWVyL29ydGMvaXNzdWVzLzU2OQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zCiAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obEhlYWRlckV4dGVuc2lvbikgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZW1vdGVDYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9ucy5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgIGkrKykgewogICAgICAgICAgICAgICAgICB2YXIgckhlYWRlckV4dGVuc2lvbiA9IHJlbW90ZUNhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zW2ldOwogICAgICAgICAgICAgICAgICBpZiAobEhlYWRlckV4dGVuc2lvbi51cmkgPT09IHJIZWFkZXJFeHRlbnNpb24udXJpKSB7CiAgICAgICAgICAgICAgICAgICAgY29tbW9uQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMucHVzaChySGVhZGVyRXh0ZW5zaW9uKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgIC8vIEZJWE1FOiBmZWNNZWNoYW5pc21zCiAgICAgICAgICByZXR1cm4gY29tbW9uQ2FwYWJpbGl0aWVzOwogICAgICAgIH07CgogICAgLy8gQ3JlYXRlIElDRSBnYXRoZXJlciwgSUNFIHRyYW5zcG9ydCBhbmQgRFRMUyB0cmFuc3BvcnQuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyA9CiAgICAgICAgZnVuY3Rpb24obWlkLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgaWNlR2F0aGVyZXIgPSBuZXcgUlRDSWNlR2F0aGVyZXIoc2VsZi5pY2VPcHRpb25zKTsKICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSBuZXcgUlRDSWNlVHJhbnNwb3J0KGljZUdhdGhlcmVyKTsKICAgICAgICAgIGljZUdhdGhlcmVyLm9ubG9jYWxjYW5kaWRhdGUgPSBmdW5jdGlvbihldnQpIHsKICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKTsKICAgICAgICAgICAgZXZlbnQuY2FuZGlkYXRlID0ge3NkcE1pZDogbWlkLCBzZHBNTGluZUluZGV4OiBzZHBNTGluZUluZGV4fTsKCiAgICAgICAgICAgIHZhciBjYW5kID0gZXZ0LmNhbmRpZGF0ZTsKICAgICAgICAgICAgdmFyIGVuZCA9ICFjYW5kIHx8IE9iamVjdC5rZXlzKGNhbmQpLmxlbmd0aCA9PT0gMDsKICAgICAgICAgICAgLy8gRWRnZSBlbWl0cyBhbiBlbXB0eSBvYmplY3QgZm9yIFJUQ0ljZUNhbmRpZGF0ZUNvbXBsZXRl4oClCiAgICAgICAgICAgIGlmIChlbmQpIHsKICAgICAgICAgICAgICAvLyBwb2x5ZmlsbCBzaW5jZSBSVENJY2VHYXRoZXJlci5zdGF0ZSBpcyBub3QgaW1wbGVtZW50ZWQgaW4KICAgICAgICAgICAgICAvLyBFZGdlIDEwNTQ3IHlldC4KICAgICAgICAgICAgICBpZiAoaWNlR2F0aGVyZXIuc3RhdGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgaWNlR2F0aGVyZXIuc3RhdGUgPSAnY29tcGxldGVkJzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gUlRDSWNlQ2FuZGlkYXRlIGRvZXNuJ3QgaGF2ZSBhIGNvbXBvbmVudCwgbmVlZHMgdG8gYmUgYWRkZWQKICAgICAgICAgICAgICBjYW5kLmNvbXBvbmVudCA9IGljZVRyYW5zcG9ydC5jb21wb25lbnQgPT09ICdSVENQJyA/IDIgOiAxOwogICAgICAgICAgICAgIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgPSBTRFBVdGlscy53cml0ZUNhbmRpZGF0ZShjYW5kKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdXBkYXRlIGxvY2FsIGRlc2NyaXB0aW9uLgogICAgICAgICAgICB2YXIgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHApOwogICAgICAgICAgICBpZiAoIWVuZCkgewogICAgICAgICAgICAgIHNlY3Rpb25zW2V2ZW50LmNhbmRpZGF0ZS5zZHBNTGluZUluZGV4ICsgMV0gKz0KICAgICAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbZXZlbnQuY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXggKyAxXSArPQogICAgICAgICAgICAgICAgICAnYT1lbmQtb2YtY2FuZGlkYXRlc1xyXG4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IHNlbGYuX3BlbmRpbmdPZmZlciA/IHNlbGYuX3BlbmRpbmdPZmZlciA6CiAgICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyczsKICAgICAgICAgICAgdmFyIGNvbXBsZXRlID0gdHJhbnNjZWl2ZXJzLmV2ZXJ5KGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLnN0YXRlID09PSAnY29tcGxldGVkJzsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBFbWl0IGNhbmRpZGF0ZSBpZiBsb2NhbERlc2NyaXB0aW9uIGlzIHNldC4KICAgICAgICAgICAgLy8gQWxzbyBlbWl0cyBudWxsIGNhbmRpZGF0ZSB3aGVuIGFsbCBnYXRoZXJlcnMgYXJlIGNvbXBsZXRlLgogICAgICAgICAgICBzd2l0Y2ggKHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUpIHsKICAgICAgICAgICAgICBjYXNlICduZXcnOgogICAgICAgICAgICAgICAgaWYgKCFlbmQpIHsKICAgICAgICAgICAgICAgICAgc2VsZi5fbG9jYWxJY2VDYW5kaWRhdGVzQnVmZmVyLnB1c2goZXZlbnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGVuZCAmJiBjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIucHVzaCgKICAgICAgICAgICAgICAgICAgICAgIG5ldyBFdmVudCgnaWNlY2FuZGlkYXRlJykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAnZ2F0aGVyaW5nJzoKICAgICAgICAgICAgICAgIHNlbGYuX2VtaXRCdWZmZXJlZENhbmRpZGF0ZXMoKTsKICAgICAgICAgICAgICAgIGlmICghZW5kKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShldmVudCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKSk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShuZXcgRXZlbnQoJ2ljZWNhbmRpZGF0ZScpKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBzZWxmLmljZUdhdGhlcmluZ1N0YXRlID0gJ2NvbXBsZXRlJzsKICAgICAgICAgICAgICAgICAgc2VsZi5fZW1pdEdhdGhlcmluZ1N0YXRlQ2hhbmdlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlICdjb21wbGV0ZSc6CiAgICAgICAgICAgICAgICAvLyBzaG91bGQgbm90IGhhcHBlbi4uLiBjdXJyZW50bHkhCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBkZWZhdWx0OiAvLyBuby1vcC4KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgaWNlVHJhbnNwb3J0Lm9uaWNlc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHZhciBkdGxzVHJhbnNwb3J0ID0gbmV3IFJUQ0R0bHNUcmFuc3BvcnQoaWNlVHJhbnNwb3J0KTsKICAgICAgICAgIGR0bHNUcmFuc3BvcnQub25kdGxzc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwogICAgICAgICAgZHRsc1RyYW5zcG9ydC5vbmVycm9yID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIC8vIG9uZXJyb3IgZG9lcyBub3Qgc2V0IHN0YXRlIHRvIGZhaWxlZCBieSBpdHNlbGYuCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQuc3RhdGUgPSAnZmFpbGVkJzsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGljZUdhdGhlcmVyOiBpY2VHYXRoZXJlciwKICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiBpY2VUcmFuc3BvcnQsCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IGR0bHNUcmFuc3BvcnQKICAgICAgICAgIH07CiAgICAgICAgfTsKCiAgICAvLyBTdGFydCB0aGUgUlRQIFNlbmRlciBhbmQgUmVjZWl2ZXIgZm9yIGEgdHJhbnNjZWl2ZXIuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl90cmFuc2NlaXZlID0gZnVuY3Rpb24odHJhbnNjZWl2ZXIsCiAgICAgICAgc2VuZCwgcmVjdikgewogICAgICB2YXIgcGFyYW1zID0gdGhpcy5fZ2V0Q29tbW9uQ2FwYWJpbGl0aWVzKHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLAogICAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzKTsKICAgICAgaWYgKHNlbmQgJiYgdHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgcGFyYW1zLmVuY29kaW5ncyA9IHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgcGFyYW1zLnJ0Y3AgPSB7CiAgICAgICAgICBjbmFtZTogU0RQVXRpbHMubG9jYWxDTmFtZQogICAgICAgIH07CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLnJlY3ZFbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoKSB7CiAgICAgICAgICBwYXJhbXMucnRjcC5zc3JjID0gdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjOwogICAgICAgIH0KICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc2VuZChwYXJhbXMpOwogICAgICB9CiAgICAgIGlmIChyZWN2ICYmIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyKSB7CiAgICAgICAgLy8gcmVtb3ZlIFJUWCBmaWVsZCBpbiBFZGdlIDE0OTQyCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmtpbmQgPT09ICd2aWRlbycKICAgICAgICAgICAgJiYgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycykgewogICAgICAgICAgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHApIHsKICAgICAgICAgICAgZGVsZXRlIHAucnR4OwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHBhcmFtcy5lbmNvZGluZ3MgPSB0cmFuc2NlaXZlci5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgIHBhcmFtcy5ydGNwID0gewogICAgICAgICAgY25hbWU6IHRyYW5zY2VpdmVyLmNuYW1lCiAgICAgICAgfTsKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycy5sZW5ndGgpIHsKICAgICAgICAgIHBhcmFtcy5ydGNwLnNzcmMgPSB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmM7CiAgICAgICAgfQogICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnJlY2VpdmUocGFyYW1zKTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb24gPQogICAgICAgIGZ1bmN0aW9uKGRlc2NyaXB0aW9uKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgc2VjdGlvbnM7CiAgICAgICAgICB2YXIgc2Vzc2lvbnBhcnQ7CiAgICAgICAgICBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ29mZmVyJykgewogICAgICAgICAgICAvLyBGSVhNRTogV2hhdCB3YXMgdGhlIHB1cnBvc2Ugb2YgdGhpcyBlbXB0eSBpZiBzdGF0ZW1lbnQ/CiAgICAgICAgICAgIC8vIGlmICghdGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgICAgIC8vIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nT2ZmZXIpIHsKICAgICAgICAgICAgICAvLyBWRVJZIGxpbWl0ZWQgc3VwcG9ydCBmb3IgU0RQIG11bmdpbmcuIExpbWl0ZWQgdG86CiAgICAgICAgICAgICAgLy8gKiBjaGFuZ2luZyB0aGUgb3JkZXIgb2YgY29kZWNzCiAgICAgICAgICAgICAgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKGRlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQgPSBzZWN0aW9ucy5zaGlmdCgpOwogICAgICAgICAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICAgICAgICB2YXIgY2FwcyA9IFNEUFV0aWxzLnBhcnNlUnRwUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICAgICAgc2VsZi5fcGVuZGluZ09mZmVyW3NkcE1MaW5lSW5kZXhdLmxvY2FsQ2FwYWJpbGl0aWVzID0gY2FwczsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0aGlzLnRyYW5zY2VpdmVycyA9IHRoaXMuX3BlbmRpbmdPZmZlcjsKICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcGVuZGluZ09mZmVyOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgICAgIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgIHNlc3Npb25wYXJ0ID0gc2VjdGlvbnMuc2hpZnQoKTsKICAgICAgICAgICAgdmFyIGlzSWNlTGl0ZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgICBzZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKG1lZGlhU2VjdGlvbiwgc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQ7CiAgICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0OwogICAgICAgICAgICAgIHZhciBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwogICAgICAgICAgICAgIHZhciByZW1vdGVDYXBhYmlsaXRpZXMgPSB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IG1lZGlhU2VjdGlvbi5zcGxpdCgnXG4nLCAxKVswXQogICAgICAgICAgICAgICAgICAuc3BsaXQoJyAnLCAyKVsxXSA9PT0gJzAnOwoKICAgICAgICAgICAgICBpZiAoIXJlamVjdGVkICYmICF0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSWNlUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldEljZVBhcmFtZXRlcnMoCiAgICAgICAgICAgICAgICAgICAgbWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCk7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnMgPSBTRFBVdGlscy5nZXREdGxzUGFyYW1ldGVycygKICAgICAgICAgICAgICAgICAgICBtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICAgIGlmIChpc0ljZUxpdGUpIHsKICAgICAgICAgICAgICAgICAgcmVtb3RlRHRsc1BhcmFtZXRlcnMucm9sZSA9ICdzZXJ2ZXInOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydC5zdGFydChpY2VHYXRoZXJlciwgcmVtb3RlSWNlUGFyYW1ldGVycywKICAgICAgICAgICAgICAgICAgICAgIGlzSWNlTGl0ZSA/ICdjb250cm9sbGluZycgOiAnY29udHJvbGxlZCcpOwogICAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgaW50ZXJzZWN0aW9uIG9mIGNhcGFiaWxpdGllcy4KICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSBzZWxmLl9nZXRDb21tb25DYXBhYmlsaXRpZXMobG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgICAgICAgICAgcmVtb3RlQ2FwYWJpbGl0aWVzKTsKCiAgICAgICAgICAgICAgICAvLyBTdGFydCB0aGUgUlRDUnRwU2VuZGVyLiBUaGUgUlRDUnRwUmVjZWl2ZXIgZm9yIHRoaXMKICAgICAgICAgICAgICAgIC8vIHRyYW5zY2VpdmVyIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBpbiBzZXRSZW1vdGVEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmNvZGVjcy5sZW5ndGggPiAwLAogICAgICAgICAgICAgICAgICAgIGZhbHNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMubG9jYWxEZXNjcmlwdGlvbiA9IHsKICAgICAgICAgICAgdHlwZTogZGVzY3JpcHRpb24udHlwZSwKICAgICAgICAgICAgc2RwOiBkZXNjcmlwdGlvbi5zZHAKICAgICAgICAgIH07CiAgICAgICAgICBzd2l0Y2ggKGRlc2NyaXB0aW9uLnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAnb2ZmZXInOgogICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdoYXZlLWxvY2FsLW9mZmVyJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2Fuc3dlcic6CiAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ3N0YWJsZScpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3Vuc3VwcG9ydGVkIHR5cGUgIicgKyBkZXNjcmlwdGlvbi50eXBlICsKICAgICAgICAgICAgICAgICAgJyInKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBJZiBhIHN1Y2Nlc3MgY2FsbGJhY2sgd2FzIHByb3ZpZGVkLCBlbWl0IElDRSBjYW5kaWRhdGVzIGFmdGVyIGl0CiAgICAgICAgICAvLyBoYXMgYmVlbiBleGVjdXRlZC4gT3RoZXJ3aXNlLCBlbWl0IGNhbGxiYWNrIGFmdGVyIHRoZSBQcm9taXNlIGlzCiAgICAgICAgICAvLyByZXNvbHZlZC4KICAgICAgICAgIHZhciBoYXNDYWxsYmFjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmCiAgICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbic7CiAgICAgICAgICBpZiAoaGFzQ2FsbGJhY2spIHsKICAgICAgICAgICAgdmFyIGNiID0gYXJndW1lbnRzWzFdOwogICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICBjYigpOwogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBzZWxmLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzKCk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHAgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICAgIHAudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgaWYgKCFoYXNDYWxsYmFjaykgewogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBVc3VhbGx5IGNhbmRpZGF0ZXMgd2lsbCBiZSBlbWl0dGVkIGVhcmxpZXIuCiAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoc2VsZi5fZW1pdEJ1ZmZlcmVkQ2FuZGlkYXRlcy5iaW5kKHNlbGYpLCA1MDApOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBwOwogICAgICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbiA9CiAgICAgICAgZnVuY3Rpb24oZGVzY3JpcHRpb24pIHsKICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgIHZhciBzdHJlYW0gPSBuZXcgTWVkaWFTdHJlYW0oKTsKICAgICAgICAgIHZhciByZWNlaXZlckxpc3QgPSBbXTsKICAgICAgICAgIHZhciBzZWN0aW9ucyA9IFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMoZGVzY3JpcHRpb24uc2RwKTsKICAgICAgICAgIHZhciBzZXNzaW9ucGFydCA9IHNlY3Rpb25zLnNoaWZ0KCk7CiAgICAgICAgICB2YXIgaXNJY2VMaXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoc2Vzc2lvbnBhcnQsCiAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgdGhpcy51c2luZ0J1bmRsZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICdhPWdyb3VwOkJVTkRMRSAnKS5sZW5ndGggPiAwOwogICAgICAgICAgc2VjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNkcE1MaW5lSW5kZXgpIHsKICAgICAgICAgICAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICB2YXIgbWxpbmUgPSBsaW5lc1swXS5zdWJzdHIoMikuc3BsaXQoJyAnKTsKICAgICAgICAgICAgdmFyIGtpbmQgPSBtbGluZVswXTsKICAgICAgICAgICAgdmFyIHJlamVjdGVkID0gbWxpbmVbMV0gPT09ICcwJzsKICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IFNEUFV0aWxzLmdldERpcmVjdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKCiAgICAgICAgICAgIHZhciBtaWQgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPW1pZDonKTsKICAgICAgICAgICAgaWYgKG1pZC5sZW5ndGgpIHsKICAgICAgICAgICAgICBtaWQgPSBtaWRbMF0uc3Vic3RyKDYpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG1pZCA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBSZWplY3QgZGF0YWNoYW5uZWxzIHdoaWNoIGFyZSBub3QgaW1wbGVtZW50ZWQgeWV0LgogICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2FwcGxpY2F0aW9uJyAmJiBtbGluZVsyXSA9PT0gJ0RUTFMvU0NUUCcpIHsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIG1pZDogbWlkLAogICAgICAgICAgICAgICAgaXNEYXRhY2hhbm5lbDogdHJ1ZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgdHJhbnNjZWl2ZXI7CiAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlcjsKICAgICAgICAgICAgdmFyIGljZVRyYW5zcG9ydDsKICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQ7CiAgICAgICAgICAgIHZhciBydHBTZW5kZXI7CiAgICAgICAgICAgIHZhciBydHBSZWNlaXZlcjsKICAgICAgICAgICAgdmFyIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgICAgIHZhciByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICB2YXIgdHJhY2s7CiAgICAgICAgICAgIC8vIEZJWE1FOiBlbnN1cmUgdGhlIG1lZGlhU2VjdGlvbiBoYXMgcnRjcC1tdXggc2V0LgogICAgICAgICAgICB2YXIgcmVtb3RlQ2FwYWJpbGl0aWVzID0gU0RQVXRpbHMucGFyc2VSdHBQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CiAgICAgICAgICAgIHZhciByZW1vdGVJY2VQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnM7CiAgICAgICAgICAgIGlmICghcmVqZWN0ZWQpIHsKICAgICAgICAgICAgICByZW1vdGVJY2VQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0SWNlUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24sCiAgICAgICAgICAgICAgICAgIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICByZW1vdGVEdGxzUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbiwKICAgICAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQpOwogICAgICAgICAgICAgIHJlbW90ZUR0bHNQYXJhbWV0ZXJzLnJvbGUgPSAnY2xpZW50JzsKICAgICAgICAgICAgfQogICAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgIFNEUFV0aWxzLnBhcnNlUnRwRW5jb2RpbmdQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CgogICAgICAgICAgICB2YXIgY25hbWU7CiAgICAgICAgICAgIC8vIEdldHMgdGhlIGZpcnN0IFNTUkMuIE5vdGUgdGhhdCB3aXRoIFJUWCB0aGVyZSBtaWdodCBiZSBtdWx0aXBsZQogICAgICAgICAgICAvLyBTU1JDcy4KICAgICAgICAgICAgdmFyIHJlbW90ZVNzcmMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNzcmM6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24obGluZSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihvYmopIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iai5hdHRyaWJ1dGUgPT09ICdjbmFtZSc7CiAgICAgICAgICAgICAgICB9KVswXTsKICAgICAgICAgICAgaWYgKHJlbW90ZVNzcmMpIHsKICAgICAgICAgICAgICBjbmFtZSA9IHJlbW90ZVNzcmMudmFsdWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBpc0NvbXBsZXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLAogICAgICAgICAgICAgICAgJ2E9ZW5kLW9mLWNhbmRpZGF0ZXMnLCBzZXNzaW9ucGFydCkubGVuZ3RoID4gMDsKICAgICAgICAgICAgdmFyIGNhbmRzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1jYW5kaWRhdGU6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24oY2FuZCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUoY2FuZCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihjYW5kKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBjYW5kLmNvbXBvbmVudCA9PT0gJzEnOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInICYmICFyZWplY3RlZCkgewogICAgICAgICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiBzZWxmLnRyYW5zY2VpdmVyc1swXS5pY2VHYXRoZXJlciwKICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uaWNlVHJhbnNwb3J0LAogICAgICAgICAgICAgICAgZHRsc1RyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICAgICAgICBpZiAoaXNDb21wbGV0ZSAmJiAoIXNlbGYudXNpbmdCdW5kbGUgfHwgc2RwTUxpbmVJbmRleCA9PT0gMCkpIHsKICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuaWNlVHJhbnNwb3J0LnNldFJlbW90ZUNhbmRpZGF0ZXMoY2FuZHMpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBSZWNlaXZlci5nZXRDYXBhYmlsaXRpZXMoa2luZCk7CgogICAgICAgICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMgPSBbewogICAgICAgICAgICAgICAgc3NyYzogKDIgKiBzZHBNTGluZUluZGV4ICsgMikgKiAxMDAxCiAgICAgICAgICAgICAgfV07CgogICAgICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CgogICAgICAgICAgICAgIHRyYWNrID0gcnRwUmVjZWl2ZXIudHJhY2s7CiAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgIC8vIEZJWE1FOiBub3QgY29ycmVjdCB3aGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBzdHJlYW1zIGJ1dCB0aGF0IGlzCiAgICAgICAgICAgICAgLy8gbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgaW4gdGhpcyBzaGltLgogICAgICAgICAgICAgIHN0cmVhbS5hZGRUcmFjayh0cmFjayk7CgogICAgICAgICAgICAgIC8vIEZJWE1FOiBsb29rIGF0IGRpcmVjdGlvbi4KICAgICAgICAgICAgICBpZiAoc2VsZi5sb2NhbFN0cmVhbXMubGVuZ3RoID4gMCAmJgogICAgICAgICAgICAgICAgICBzZWxmLmxvY2FsU3RyZWFtc1swXS5nZXRUcmFja3MoKS5sZW5ndGggPj0gc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgICAgdmFyIGxvY2FsVHJhY2s7CiAgICAgICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0QXVkaW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2luZCA9PT0gJ3ZpZGVvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0VmlkZW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChsb2NhbFRyYWNrKSB7CiAgICAgICAgICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIobG9jYWxUcmFjaywKICAgICAgICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc3BvcnRzLmljZUdhdGhlcmVyLAogICAgICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmljZVRyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzOiBsb2NhbENhcGFiaWxpdGllcywKICAgICAgICAgICAgICAgIHJlbW90ZUNhcGFiaWxpdGllczogcmVtb3RlQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAgICAgcnRwU2VuZGVyOiBydHBTZW5kZXIsCiAgICAgICAgICAgICAgICBydHBSZWNlaXZlcjogcnRwUmVjZWl2ZXIsCiAgICAgICAgICAgICAgICBraW5kOiBraW5kLAogICAgICAgICAgICAgICAgbWlkOiBtaWQsCiAgICAgICAgICAgICAgICBjbmFtZTogY25hbWUsCiAgICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzOiBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzLAogICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczogcmVjdkVuY29kaW5nUGFyYW1ldGVycwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgLy8gU3RhcnQgdGhlIFJUQ1J0cFJlY2VpdmVyIG5vdy4gVGhlIFJUUFNlbmRlciBpcyBzdGFydGVkIGluCiAgICAgICAgICAgICAgLy8gc2V0TG9jYWxEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICBzZWxmLl90cmFuc2NlaXZlKHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLAogICAgICAgICAgICAgICAgICBmYWxzZSwKICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uID09PSAnc2VuZHJlY3YnIHx8IGRpcmVjdGlvbiA9PT0gJ3NlbmRvbmx5Jyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ2Fuc3dlcicgJiYgIXJlamVjdGVkKSB7CiAgICAgICAgICAgICAgdHJhbnNjZWl2ZXIgPSBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XTsKICAgICAgICAgICAgICBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIGljZVRyYW5zcG9ydCA9IHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydDsKICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0ID0gdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydDsKICAgICAgICAgICAgICBydHBTZW5kZXIgPSB0cmFuc2NlaXZlci5ydHBTZW5kZXI7CiAgICAgICAgICAgICAgcnRwUmVjZWl2ZXIgPSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzID0gdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZW1vdGVDYXBhYmlsaXRpZXMgPQogICAgICAgICAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM7CiAgICAgICAgICAgICAgc2VsZi50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uY25hbWUgPSBjbmFtZTsKCiAgICAgICAgICAgICAgaWYgKChpc0ljZUxpdGUgfHwgaXNDb21wbGV0ZSkgJiYgY2FuZHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc2V0UmVtb3RlQ2FuZGlkYXRlcyhjYW5kcyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc3RhcnQoaWNlR2F0aGVyZXIsIHJlbW90ZUljZVBhcmFtZXRlcnMsCiAgICAgICAgICAgICAgICAgICAgJ2NvbnRyb2xsaW5nJyk7CiAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdyZWN2b25seScsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpOwoKICAgICAgICAgICAgICBpZiAocnRwUmVjZWl2ZXIgJiYKICAgICAgICAgICAgICAgICAgKGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpKSB7CiAgICAgICAgICAgICAgICB0cmFjayA9IHJ0cFJlY2VpdmVyLnRyYWNrOwogICAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgICAgc3RyZWFtLmFkZFRyYWNrKHRyYWNrKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFjdHVhbGx5IHRoZSByZWNlaXZlciBzaG91bGQgYmUgY3JlYXRlZCBsYXRlci4KICAgICAgICAgICAgICAgIGRlbGV0ZSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIHRoaXMucmVtb3RlRGVzY3JpcHRpb24gPSB7CiAgICAgICAgICAgIHR5cGU6IGRlc2NyaXB0aW9uLnR5cGUsCiAgICAgICAgICAgIHNkcDogZGVzY3JpcHRpb24uc2RwCiAgICAgICAgICB9OwogICAgICAgICAgc3dpdGNoIChkZXNjcmlwdGlvbi50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgJ29mZmVyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnaGF2ZS1yZW1vdGUtb2ZmZXInKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnYW5zd2VyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnc3RhYmxlJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigndW5zdXBwb3J0ZWQgdHlwZSAiJyArIGRlc2NyaXB0aW9uLnR5cGUgKwogICAgICAgICAgICAgICAgICAnIicpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHN0cmVhbS5nZXRUcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgICAgc2VsZi5yZW1vdGVTdHJlYW1zLnB1c2goc3RyZWFtKTsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdhZGRzdHJlYW0nKTsKICAgICAgICAgICAgICBldmVudC5zdHJlYW0gPSBzdHJlYW07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgICBpZiAoc2VsZi5vbmFkZHN0cmVhbSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYub25hZGRzdHJlYW0oZXZlbnQpOwogICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZWNlaXZlckxpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CiAgICAgICAgICAgICAgICB2YXIgdHJhY2sgPSBpdGVtWzBdOwogICAgICAgICAgICAgICAgdmFyIHJlY2VpdmVyID0gaXRlbVsxXTsKICAgICAgICAgICAgICAgIHZhciB0cmFja0V2ZW50ID0gbmV3IEV2ZW50KCd0cmFjaycpOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5yZWNlaXZlciA9IHJlY2VpdmVyOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5zdHJlYW1zID0gW3N0cmVhbV07CiAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQodHJhY2tFdmVudCk7CiAgICAgICAgICAgICAgICBpZiAoc2VsZi5vbnRyYWNrICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHNlbGYub250cmFjayh0cmFja0V2ZW50KTsKICAgICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoYXJndW1lbnRzWzFdLCAwKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIC8qIG5vdCB5ZXQKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgICovCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCkgewogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0b3AoKTsKICAgICAgICB9CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBGSVhNRTogY2xlYW4gdXAgdHJhY2tzLCBsb2NhbCBzdHJlYW1zLCByZW1vdGUgc3RyZWFtcywgZXRjCiAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdjbG9zZWQnKTsKICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBzaWduYWxpbmcgc3RhdGUuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl91cGRhdGVTaWduYWxpbmdTdGF0ZSA9CiAgICAgICAgZnVuY3Rpb24obmV3U3RhdGUpIHsKICAgICAgICAgIHRoaXMuc2lnbmFsaW5nU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnc2lnbmFsaW5nc3RhdGVjaGFuZ2UnKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICBpZiAodGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHRoaXMub25zaWduYWxpbmdzdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAvLyBEZXRlcm1pbmUgd2hldGhlciB0byBmaXJlIHRoZSBuZWdvdGlhdGlvbm5lZWRlZCBldmVudC4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX21heWJlRmlyZU5lZ290aWF0aW9uTmVlZGVkID0KICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgIC8vIEZpcmUgYXdheSAoZm9yIG5vdykuCiAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ25lZ290aWF0aW9ubmVlZGVkJyk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgICAgaWYgKHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCAhPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLm9ubmVnb3RpYXRpb25uZWVkZWQoZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBjb25uZWN0aW9uIHN0YXRlLgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fdXBkYXRlQ29ubmVjdGlvblN0YXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIG5ld1N0YXRlOwogICAgICB2YXIgc3RhdGVzID0gewogICAgICAgICduZXcnOiAwLAogICAgICAgIGNsb3NlZDogMCwKICAgICAgICBjb25uZWN0aW5nOiAwLAogICAgICAgIGNoZWNraW5nOiAwLAogICAgICAgIGNvbm5lY3RlZDogMCwKICAgICAgICBjb21wbGV0ZWQ6IDAsCiAgICAgICAgZmFpbGVkOiAwCiAgICAgIH07CiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICBzdGF0ZXNbdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICAgIHN0YXRlc1t0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICB9KTsKICAgICAgLy8gSUNFVHJhbnNwb3J0LmNvbXBsZXRlZCBhbmQgY29ubmVjdGVkIGFyZSB0aGUgc2FtZSBmb3IgdGhpcyBwdXJwb3NlLgogICAgICBzdGF0ZXMuY29ubmVjdGVkICs9IHN0YXRlcy5jb21wbGV0ZWQ7CgogICAgICBuZXdTdGF0ZSA9ICduZXcnOwogICAgICBpZiAoc3RhdGVzLmZhaWxlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdmYWlsZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5jb25uZWN0aW5nID4gMCB8fCBzdGF0ZXMuY2hlY2tpbmcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnY29ubmVjdGluZyc7CiAgICAgIH0gZWxzZSBpZiAoc3RhdGVzLmRpc2Nvbm5lY3RlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdkaXNjb25uZWN0ZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5uZXcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnbmV3JzsKICAgICAgfSBlbHNlIGlmIChzdGF0ZXMuY29ubmVjdGVkID4gMCB8fCBzdGF0ZXMuY29tcGxldGVkID4gMCkgewogICAgICAgIG5ld1N0YXRlID0gJ2Nvbm5lY3RlZCc7CiAgICAgIH0KCiAgICAgIGlmIChuZXdTdGF0ZSAhPT0gc2VsZi5pY2VDb25uZWN0aW9uU3RhdGUpIHsKICAgICAgICBzZWxmLmljZUNvbm5lY3Rpb25TdGF0ZSA9IG5ld1N0YXRlOwogICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlJyk7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICBpZiAodGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSAhPT0gbnVsbCkgewogICAgICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY3JlYXRlT2ZmZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAodGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjcmVhdGVPZmZlciBjYWxsZWQgd2hpbGUgdGhlcmUgaXMgYSBwZW5kaW5nIG9mZmVyLicpOwogICAgICB9CiAgICAgIHZhciBvZmZlck9wdGlvbnM7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpIHsKICAgICAgICBvZmZlck9wdGlvbnMgPSBhcmd1bWVudHNbMF07CiAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykgewogICAgICAgIG9mZmVyT3B0aW9ucyA9IGFyZ3VtZW50c1syXTsKICAgICAgfQoKICAgICAgdmFyIHRyYWNrcyA9IFtdOwogICAgICB2YXIgbnVtQXVkaW9UcmFja3MgPSAwOwogICAgICB2YXIgbnVtVmlkZW9UcmFja3MgPSAwOwogICAgICAvLyBEZWZhdWx0IHRvIHNlbmRyZWN2LgogICAgICBpZiAodGhpcy5sb2NhbFN0cmVhbXMubGVuZ3RoKSB7CiAgICAgICAgbnVtQXVkaW9UcmFja3MgPSB0aGlzLmxvY2FsU3RyZWFtc1swXS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aDsKICAgICAgICBudW1WaWRlb1RyYWNrcyA9IHRoaXMubG9jYWxTdHJlYW1zWzBdLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoOwogICAgICB9CiAgICAgIC8vIERldGVybWluZSBudW1iZXIgb2YgYXVkaW8gYW5kIHZpZGVvIHRyYWNrcyB3ZSBuZWVkIHRvIHNlbmQvcmVjdi4KICAgICAgaWYgKG9mZmVyT3B0aW9ucykgewogICAgICAgIC8vIFJlamVjdCBDaHJvbWUgbGVnYWN5IGNvbnN0cmFpbnRzLgogICAgICAgIGlmIChvZmZlck9wdGlvbnMubWFuZGF0b3J5IHx8IG9mZmVyT3B0aW9ucy5vcHRpb25hbCkgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigKICAgICAgICAgICAgICAnTGVnYWN5IG1hbmRhdG9yeS9vcHRpb25hbCBjb25zdHJhaW50cyBub3Qgc3VwcG9ydGVkLicpOwogICAgICAgIH0KICAgICAgICBpZiAob2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgbnVtQXVkaW9UcmFja3MgPSBvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbzsKICAgICAgICB9CiAgICAgICAgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzID0gb2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlVmlkZW87CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmxvY2FsU3RyZWFtcy5sZW5ndGgpIHsKICAgICAgICAvLyBQdXNoIGxvY2FsIHN0cmVhbXMuCiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXNbMF0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiB0cmFjay5raW5kLAogICAgICAgICAgICB0cmFjazogdHJhY2ssCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cmFjay5raW5kID09PSAnYXVkaW8nID8KICAgICAgICAgICAgICAgIG51bUF1ZGlvVHJhY2tzID4gMCA6IG51bVZpZGVvVHJhY2tzID4gMAogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAodHJhY2sua2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgICAgfSBlbHNlIGlmICh0cmFjay5raW5kID09PSAndmlkZW8nKSB7CiAgICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgLy8gQ3JlYXRlIE0tbGluZXMgZm9yIHJlY3Zvbmx5IHN0cmVhbXMuCiAgICAgIHdoaWxlIChudW1BdWRpb1RyYWNrcyA+IDAgfHwgbnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgaWYgKG51bUF1ZGlvVHJhY2tzID4gMCkgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiAnYXVkaW8nLAogICAgICAgICAgICB3YW50UmVjZWl2ZTogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgIH0KICAgICAgICBpZiAobnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgICB0cmFja3MucHVzaCh7CiAgICAgICAgICAgIGtpbmQ6ICd2aWRlbycsCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUoKTsKICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IFtdOwogICAgICB0cmFja3MuZm9yRWFjaChmdW5jdGlvbihtbGluZSwgc2RwTUxpbmVJbmRleCkgewogICAgICAgIC8vIEZvciBlYWNoIHRyYWNrLCBjcmVhdGUgYW4gaWNlIGdhdGhlcmVyLCBpY2UgdHJhbnNwb3J0LAogICAgICAgIC8vIGR0bHMgdHJhbnNwb3J0LCBwb3RlbnRpYWxseSBydHBzZW5kZXIgYW5kIHJ0cHJlY2VpdmVyLgogICAgICAgIHZhciB0cmFjayA9IG1saW5lLnRyYWNrOwogICAgICAgIHZhciBraW5kID0gbWxpbmUua2luZDsKICAgICAgICB2YXIgbWlkID0gU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyKCk7CgogICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc2NlaXZlcnNbMF0uaWNlR2F0aGVyZXIsCiAgICAgICAgICBpY2VUcmFuc3BvcnQ6IHRyYW5zY2VpdmVyc1swXS5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBTZW5kZXIuZ2V0Q2FwYWJpbGl0aWVzKGtpbmQpOwogICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgfSk7CiAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgICAgICAgIC8vIHdvcmsgYXJvdW5kIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD02NTUyCiAgICAgICAgICAvLyBieSBhZGRpbmcgbGV2ZWwtYXN5bW1ldHJ5LWFsbG93ZWQ9MQogICAgICAgICAgaWYgKGNvZGVjLm5hbWUgPT09ICdIMjY0JyAmJgogICAgICAgICAgICAgIGNvZGVjLnBhcmFtZXRlcnNbJ2xldmVsLWFzeW1tZXRyeS1hbGxvd2VkJ10gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb2RlYy5wYXJhbWV0ZXJzWydsZXZlbC1hc3ltbWV0cnktYWxsb3dlZCddID0gJzEnOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICB2YXIgcnRwU2VuZGVyOwogICAgICAgIHZhciBydHBSZWNlaXZlcjsKCiAgICAgICAgLy8gZ2VuZXJhdGUgYW4gc3NyYyBub3csIHRvIGJlIHVzZWQgbGF0ZXIgaW4gcnRwU2VuZGVyLnNlbmQKICAgICAgICB2YXIgc2VuZEVuY29kaW5nUGFyYW1ldGVycyA9IFt7CiAgICAgICAgICBzc3JjOiAoMiAqIHNkcE1MaW5lSW5kZXggKyAxKSAqIDEwMDEKICAgICAgICB9XTsKICAgICAgICBpZiAodHJhY2spIHsKICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIodHJhY2ssIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgfQoKICAgICAgICBpZiAobWxpbmUud2FudFJlY2VpdmUpIHsKICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CiAgICAgICAgfQoKICAgICAgICB0cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0gPSB7CiAgICAgICAgICBpY2VHYXRoZXJlcjogdHJhbnNwb3J0cy5pY2VHYXRoZXJlciwKICAgICAgICAgIGljZVRyYW5zcG9ydDogdHJhbnNwb3J0cy5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmR0bHNUcmFuc3BvcnQsCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllczogbG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM6IG51bGwsCiAgICAgICAgICBydHBTZW5kZXI6IHJ0cFNlbmRlciwKICAgICAgICAgIHJ0cFJlY2VpdmVyOiBydHBSZWNlaXZlciwKICAgICAgICAgIGtpbmQ6IGtpbmQsCiAgICAgICAgICBtaWQ6IG1pZCwKICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM6IHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMsCiAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOiBudWxsCiAgICAgICAgfTsKICAgICAgfSk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdHJhbnNjZWl2ZXJzLm1hcChmdW5jdGlvbih0KSB7CiAgICAgICAgICByZXR1cm4gdC5taWQ7CiAgICAgICAgfSkuam9pbignICcpICsgJ1xyXG4nOwogICAgICB9CiAgICAgIHRyYWNrcy5mb3JFYWNoKGZ1bmN0aW9uKG1saW5lLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgdmFyIHRyYW5zY2VpdmVyID0gdHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsICdvZmZlcicsIHNlbGYubG9jYWxTdHJlYW1zWzBdKTsKICAgICAgfSk7CgogICAgICB0aGlzLl9wZW5kaW5nT2ZmZXIgPSB0cmFuc2NlaXZlcnM7CiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ29mZmVyJywKICAgICAgICBzZHA6IHNkcAogICAgICB9KTsKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGFyZ3VtZW50c1swXSwgMCwgZGVzYyk7CiAgICAgIH0KICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZXNjKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVBbnN3ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlU2Vzc2lvbkJvaWxlcnBsYXRlKCk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdGhpcy50cmFuc2NlaXZlcnMubWFwKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgIHJldHVybiB0Lm1pZDsKICAgICAgICB9KS5qb2luKCcgJykgKyAnXHJcbic7CiAgICAgIH0KICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIGlmICh0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICBzZHAgKz0gJ209YXBwbGljYXRpb24gMCBEVExTL1NDVFAgNTAwMFxyXG4nICsKICAgICAgICAgICAgICAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nICsKICAgICAgICAgICAgICAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gQ2FsY3VsYXRlIGludGVyc2VjdGlvbiBvZiBjYXBhYmlsaXRpZXMuCiAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHNlbGYuX2dldENvbW1vbkNhcGFiaWxpdGllcygKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgIHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcyk7CgogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwgY29tbW9uQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAnYW5zd2VyJywgc2VsZi5sb2NhbFN0cmVhbXNbMF0pOwogICAgICB9KTsKCiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ2Fuc3dlcicsCiAgICAgICAgc2RwOiBzZHAKICAgICAgfSk7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMF0sIDAsIGRlc2MpOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGVzYyk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oY2FuZGlkYXRlKSB7CiAgICAgIGlmICghY2FuZGlkYXRlKSB7CiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnRyYW5zY2VpdmVycy5sZW5ndGg7IGorKykgewogICAgICAgICAgdGhpcy50cmFuc2NlaXZlcnNbal0uaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZSh7fSk7CiAgICAgICAgICBpZiAodGhpcy51c2luZ0J1bmRsZSkgewogICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBtTGluZUluZGV4ID0gY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXg7CiAgICAgICAgaWYgKGNhbmRpZGF0ZS5zZHBNaWQpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFuc2NlaXZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNjZWl2ZXJzW2ldLm1pZCA9PT0gY2FuZGlkYXRlLnNkcE1pZCkgewogICAgICAgICAgICAgIG1MaW5lSW5kZXggPSBpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHRoaXMudHJhbnNjZWl2ZXJzW21MaW5lSW5kZXhdOwogICAgICAgIGlmICh0cmFuc2NlaXZlcikgewogICAgICAgICAgdmFyIGNhbmQgPSBPYmplY3Qua2V5cyhjYW5kaWRhdGUuY2FuZGlkYXRlKS5sZW5ndGggPiAwID8KICAgICAgICAgICAgICBTRFBVdGlscy5wYXJzZUNhbmRpZGF0ZShjYW5kaWRhdGUuY2FuZGlkYXRlKSA6IHt9OwogICAgICAgICAgLy8gSWdub3JlIENocm9tZSdzIGludmFsaWQgY2FuZGlkYXRlcyBzaW5jZSBFZGdlIGRvZXMgbm90IGxpa2UgdGhlbS4KICAgICAgICAgIGlmIChjYW5kLnByb3RvY29sID09PSAndGNwJyAmJiAoY2FuZC5wb3J0ID09PSAwIHx8IGNhbmQucG9ydCA9PT0gOSkpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgLy8gSWdub3JlIFJUQ1AgY2FuZGlkYXRlcywgd2UgYXNzdW1lIFJUQ1AtTVVYLgogICAgICAgICAgaWYgKGNhbmQuY29tcG9uZW50ICE9PSAnMScpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZShjYW5kKTsKCiAgICAgICAgICAvLyB1cGRhdGUgdGhlIHJlbW90ZURlc2NyaXB0aW9uLgogICAgICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyh0aGlzLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICBzZWN0aW9uc1ttTGluZUluZGV4ICsgMV0gKz0gKGNhbmQudHlwZSA/IGNhbmRpZGF0ZS5jYW5kaWRhdGUudHJpbSgpCiAgICAgICAgICAgICAgOiAnYT1lbmQtb2YtY2FuZGlkYXRlcycpICsgJ1xyXG4nOwogICAgICAgICAgdGhpcy5yZW1vdGVEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMV0sIDApOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcHJvbWlzZXMgPSBbXTsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIFsncnRwU2VuZGVyJywgJ3J0cFJlY2VpdmVyJywgJ2ljZUdhdGhlcmVyJywgJ2ljZVRyYW5zcG9ydCcsCiAgICAgICAgICAgICdkdGxzVHJhbnNwb3J0J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgICBpZiAodHJhbnNjZWl2ZXJbbWV0aG9kXSkgewogICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0cmFuc2NlaXZlclttZXRob2RdLmdldFN0YXRzKCkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB2YXIgY2IgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnZnVuY3Rpb24nICYmCiAgICAgICAgICBhcmd1bWVudHNbMV07CiAgICAgIHZhciBmaXhTdGF0c1R5cGUgPSBmdW5jdGlvbihzdGF0KSB7CiAgICAgICAgc3RhdC50eXBlID0gewogICAgICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgICAgIG91dGJvdW5kcnRwOiAnb3V0Ym91bmQtcnRwJywKICAgICAgICAgIGNhbmRpZGF0ZXBhaXI6ICdjYW5kaWRhdGUtcGFpcicsCiAgICAgICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgIH1bc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgcmV0dXJuIHN0YXQ7CiAgICAgIH07CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICAgIHZhciByZXN1bHRzID0gbmV3IE1hcCgpOwogICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKHJlcykgewogICAgICAgICAgcmVzLmZvckVhY2goZnVuY3Rpb24ocmVzdWx0KSB7CiAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlc3VsdCkuZm9yRWFjaChmdW5jdGlvbihpZCkgewogICAgICAgICAgICAgIHJlc3VsdFtpZF0udHlwZSA9IGZpeFN0YXRzVHlwZShyZXN1bHRbaWRdKTsKICAgICAgICAgICAgICByZXN1bHRzLnNldChpZCwgcmVzdWx0W2lkXSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoY2IpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoY2IsIDAsIHJlc3VsdHMpOwogICAgICAgICAgfQogICAgICAgICAgcmVzb2x2ZShyZXN1bHRzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KfTsKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbVBlZXJDb25uZWN0aW9uOiBlZGdlU2hpbS5zaGltUGVlckNvbm5lY3Rpb24sCiAgc2hpbUdldFVzZXJNZWRpYTogcmVxdWlyZSgnLi9nZXR1c2VybWVkaWEnKQp9OwoKfSx7Ii4uL3V0aWxzIjoxMSwiLi9nZXR1c2VybWVkaWEiOjcsInNkcCI6MX1dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7UGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJ31bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50LAogICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTsKICAgICAgfQogICAgfTsKICB9OwoKICAvLyBnZXRVc2VyTWVkaWEgZXJyb3Igc2hpbS4KICB2YXIgb3JpZ0dldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhLgogICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oYykgewogICAgcmV0dXJuIG9yaWdHZXRVc2VyTWVkaWEoYykuY2F0Y2goZnVuY3Rpb24oZSkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3Qoc2hpbUVycm9yXyhlKSk7CiAgICB9KTsKICB9Owp9OwoKfSx7fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgZmlyZWZveFNoaW0gPSB7CiAgc2hpbU9uVHJhY2s6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnICYmIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiAmJiAhKCdvbnRyYWNrJyBpbgogICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnb250cmFjaycsIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX29udHJhY2s7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKGYpIHsKICAgICAgICAgIGlmICh0aGlzLl9vbnRyYWNrKSB7CiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrKTsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgdGhpcy5fb250cmFjayA9IGYpOwogICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgZS5zdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTsKICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAoKICBzaGltU291cmNlT2JqZWN0OiBmdW5jdGlvbigpIHsKICAgIC8vIEZpcmVmb3ggaGFzIHN1cHBvcnRlZCBtb3pTcmNPYmplY3Qgc2luY2UgRkYyMiwgdW5wcmVmaXhlZCBpbiA0Mi4KICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgewogICAgICBpZiAod2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAhKCdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgICAvLyBTaGltIHRoZSBzcmNPYmplY3QgcHJvcGVydHksIG9uY2UsIHdoZW4gSFRNTE1lZGlhRWxlbWVudCBpcyBmb3VuZC4KICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLCAnc3JjT2JqZWN0JywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMubW96U3JjT2JqZWN0OwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgICAgIHRoaXMubW96U3JjT2JqZWN0ID0gc3RyZWFtOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAnb2JqZWN0JyB8fCAhKHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiB8fAogICAgICAgIHdpbmRvdy5tb3pSVENQZWVyQ29ubmVjdGlvbikpIHsKICAgICAgcmV0dXJuOyAvLyBwcm9iYWJseSBtZWRpYS5wZWVyY29ubmVjdGlvbi5lbmFibGVkPWZhbHNlIGluIGFib3V0OmNvbmZpZwogICAgfQogICAgLy8gVGhlIFJUQ1BlZXJDb25uZWN0aW9uIG9iamVjdC4KICAgIGlmICghd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uKSB7CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiA9IGZ1bmN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKSB7CiAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICAgICAgLy8gLnVybHMgaXMgbm90IHN1cHBvcnRlZCBpbiBGRiA8IDM4LgogICAgICAgICAgLy8gY3JlYXRlIFJUQ0ljZVNlcnZlcnMgd2l0aCBhIHNpbmdsZSB1cmwuCiAgICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlU2VydmVycykgewogICAgICAgICAgICB2YXIgbmV3SWNlU2VydmVycyA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBjQ29uZmlnLmljZVNlcnZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICB2YXIgc2VydmVyID0gcGNDb25maWcuaWNlU2VydmVyc1tpXTsKICAgICAgICAgICAgICBpZiAoc2VydmVyLmhhc093blByb3BlcnR5KCd1cmxzJykpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VydmVyLnVybHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgdmFyIG5ld1NlcnZlciA9IHsKICAgICAgICAgICAgICAgICAgICB1cmw6IHNlcnZlci51cmxzW2pdCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIGlmIChzZXJ2ZXIudXJsc1tqXS5pbmRleE9mKCd0dXJuJykgPT09IDApIHsKICAgICAgICAgICAgICAgICAgICBuZXdTZXJ2ZXIudXNlcm5hbWUgPSBzZXJ2ZXIudXNlcm5hbWU7CiAgICAgICAgICAgICAgICAgICAgbmV3U2VydmVyLmNyZWRlbnRpYWwgPSBzZXJ2ZXIuY3JlZGVudGlhbDsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBuZXdJY2VTZXJ2ZXJzLnB1c2gobmV3U2VydmVyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV3SWNlU2VydmVycy5wdXNoKHBjQ29uZmlnLmljZVNlcnZlcnNbaV0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBwY0NvbmZpZy5pY2VTZXJ2ZXJzID0gbmV3SWNlU2VydmVyczsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBtb3pSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSBtb3pSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CgogICAgICAvLyB3cmFwIHN0YXRpYyBtZXRob2RzLiBDdXJyZW50bHkganVzdCBnZW5lcmF0ZUNlcnRpZmljYXRlLgogICAgICBpZiAobW96UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24sICdnZW5lcmF0ZUNlcnRpZmljYXRlJywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIG1velJUQ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24gPSBtb3pSVENTZXNzaW9uRGVzY3JpcHRpb247CiAgICAgIHdpbmRvdy5SVENJY2VDYW5kaWRhdGUgPSBtb3pSVENJY2VDYW5kaWRhdGU7CiAgICB9CgogICAgLy8gc2hpbSBhd2F5IG5lZWQgZm9yIG9ic29sZXRlIFJUQ0ljZUNhbmRpZGF0ZS9SVENTZXNzaW9uRGVzY3JpcHRpb24uCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgdmFyIG1ha2VNYXBTdGF0cyA9IGZ1bmN0aW9uKHN0YXRzKSB7CiAgICAgIHZhciBtYXAgPSBuZXcgTWFwKCk7CiAgICAgIE9iamVjdC5rZXlzKHN0YXRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIG1hcC5zZXQoa2V5LCBzdGF0c1trZXldKTsKICAgICAgICBtYXBba2V5XSA9IHN0YXRzW2tleV07CiAgICAgIH0pOwogICAgICByZXR1cm4gbWFwOwogICAgfTsKCiAgICB2YXIgbW9kZXJuU3RhdHNUeXBlcyA9IHsKICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgb3V0Ym91bmRydHA6ICdvdXRib3VuZC1ydHAnLAogICAgICBjYW5kaWRhdGVwYWlyOiAnY2FuZGlkYXRlLXBhaXInLAogICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgIHJlbW90ZWNhbmRpZGF0ZTogJ3JlbW90ZS1jYW5kaWRhdGUnCiAgICB9OwoKICAgIHZhciBuYXRpdmVHZXRTdGF0cyA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0czsKICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBvblN1Y2MsIG9uRXJyKSB7CiAgICAgIHJldHVybiBuYXRpdmVHZXRTdGF0cy5hcHBseSh0aGlzLCBbc2VsZWN0b3IgfHwgbnVsbF0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNDgpIHsKICAgICAgICAgICAgc3RhdHMgPSBtYWtlTWFwU3RhdHMoc3RhdHMpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MyAmJiAhb25TdWNjKSB7CiAgICAgICAgICAgIC8vIFNoaW0gb25seSBwcm9taXNlIGdldFN0YXRzIHdpdGggc3BlYy1oeXBoZW5zIGluIHR5cGUgbmFtZXMKICAgICAgICAgICAgLy8gTGVhdmUgY2FsbGJhY2sgdmVyc2lvbiBhbG9uZTsgbWlzYyBvbGQgdXNlcyBvZiBmb3JFYWNoIGJlZm9yZSBNYXAKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBzdGF0cy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXQpIHsKICAgICAgICAgICAgICAgIHN0YXQudHlwZSA9IG1vZGVyblN0YXRzVHlwZXNbc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICBpZiAoZS5uYW1lICE9PSAnVHlwZUVycm9yJykgewogICAgICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gQXZvaWQgVHlwZUVycm9yOiAidHlwZSIgaXMgcmVhZC1vbmx5LCBpbiBvbGQgdmVyc2lvbnMuIDM0LTQzaXNoCiAgICAgICAgICAgICAgc3RhdHMuZm9yRWFjaChmdW5jdGlvbihzdGF0LCBpKSB7CiAgICAgICAgICAgICAgICBzdGF0cy5zZXQoaSwgT2JqZWN0LmFzc2lnbih7fSwgc3RhdCwgewogICAgICAgICAgICAgICAgICB0eXBlOiBtb2Rlcm5TdGF0c1R5cGVzW3N0YXQudHlwZV0gfHwgc3RhdC50eXBlCiAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBzdGF0czsKICAgICAgICB9KQogICAgICAgIC50aGVuKG9uU3VjYywgb25FcnIpOwogICAgfTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1PblRyYWNrOiBmaXJlZm94U2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBmaXJlZm94U2hpbS5zaGltU291cmNlT2JqZWN0LAogIHNoaW1QZWVyQ29ubmVjdGlvbjogZmlyZWZveFNoaW0uc2hpbVBlZXJDb25uZWN0aW9uLAogIHNoaW1HZXRVc2VyTWVkaWE6IHJlcXVpcmUoJy4vZ2V0dXNlcm1lZGlhJykKfTsKCn0seyIuLi91dGlscyI6MTEsIi4vZ2V0dXNlcm1lZGlhIjo5fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7CiAgICAgICAgU2VjdXJpdHlFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgUGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJwogICAgICB9W2UubmFtZV0gfHwgZS5uYW1lLAogICAgICBtZXNzYWdlOiB7CiAgICAgICAgJ1RoZSBvcGVyYXRpb24gaXMgaW5zZWN1cmUuJzogJ1RoZSByZXF1ZXN0IGlzIG5vdCBhbGxvd2VkIGJ5IHRoZSAnICsKICAgICAgICAndXNlciBhZ2VudCBvciB0aGUgcGxhdGZvcm0gaW4gdGhlIGN1cnJlbnQgY29udGV4dC4nCiAgICAgIH1bZS5tZXNzYWdlXSB8fCBlLm1lc3NhZ2UsCiAgICAgIGNvbnN0cmFpbnQ6IGUuY29uc3RyYWludCwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIC8vIGdldFVzZXJNZWRpYSBjb25zdHJhaW50cyBzaGltLgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgdmFyIGNvbnN0cmFpbnRzVG9GRjM3XyA9IGZ1bmN0aW9uKGMpIHsKICAgICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLnJlcXVpcmUpIHsKICAgICAgICByZXR1cm4gYzsKICAgICAgfQogICAgICB2YXIgcmVxdWlyZSA9IFtdOwogICAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIGlmIChrZXkgPT09ICdyZXF1aXJlJyB8fCBrZXkgPT09ICdhZHZhbmNlZCcgfHwga2V5ID09PSAnbWVkaWFTb3VyY2UnKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciByID0gY1trZXldID0gKHR5cGVvZiBjW2tleV0gPT09ICdvYmplY3QnKSA/CiAgICAgICAgICAgIGNba2V5XSA6IHtpZGVhbDogY1trZXldfTsKICAgICAgICBpZiAoci5taW4gIT09IHVuZGVmaW5lZCB8fAogICAgICAgICAgICByLm1heCAhPT0gdW5kZWZpbmVkIHx8IHIuZXhhY3QgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmVxdWlyZS5wdXNoKGtleSk7CiAgICAgICAgfQogICAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmICh0eXBlb2Ygci5leGFjdCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgci4gbWluID0gci5tYXggPSByLmV4YWN0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY1trZXldID0gci5leGFjdDsKICAgICAgICAgIH0KICAgICAgICAgIGRlbGV0ZSByLmV4YWN0OwogICAgICAgIH0KICAgICAgICBpZiAoci5pZGVhbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBjLmFkdmFuY2VkID0gYy5hZHZhbmNlZCB8fCBbXTsKICAgICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgICAgaWYgKHR5cGVvZiByLmlkZWFsID09PSAnbnVtYmVyJykgewogICAgICAgICAgICBvY1trZXldID0ge21pbjogci5pZGVhbCwgbWF4OiByLmlkZWFsfTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9jW2tleV0gPSByLmlkZWFsOwogICAgICAgICAgfQogICAgICAgICAgYy5hZHZhbmNlZC5wdXNoKG9jKTsKICAgICAgICAgIGRlbGV0ZSByLmlkZWFsOwogICAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhyKS5sZW5ndGgpIHsKICAgICAgICAgICAgZGVsZXRlIGNba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAocmVxdWlyZS5sZW5ndGgpIHsKICAgICAgICBjLnJlcXVpcmUgPSByZXF1aXJlOwogICAgICB9CiAgICAgIHJldHVybiBjOwogICAgfTsKICAgIGNvbnN0cmFpbnRzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICBsb2dnaW5nKCdzcGVjOiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgICAgaWYgKGNvbnN0cmFpbnRzLmF1ZGlvKSB7CiAgICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvRkYzN18oY29uc3RyYWludHMuYXVkaW8pOwogICAgICB9CiAgICAgIGlmIChjb25zdHJhaW50cy52aWRlbykgewogICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0ZGMzdfKGNvbnN0cmFpbnRzLnZpZGVvKTsKICAgICAgfQogICAgICBsb2dnaW5nKCdmZjM3OiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgIH0KICAgIHJldHVybiBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzLCBvblN1Y2Nlc3MsIGZ1bmN0aW9uKGUpIHsKICAgICAgb25FcnJvcihzaGltRXJyb3JfKGUpKTsKICAgIH0pOwogIH07CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGdldFVzZXJNZWRpYV8oY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICAvLyBTaGltIGZvciBtZWRpYURldmljZXMgb24gb2xkZXIgdmVyc2lvbnMuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKSB7CiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzID0ge2dldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKCkgeyB9LAogICAgICByZW1vdmVFdmVudExpc3RlbmVyOiBmdW5jdGlvbigpIHsgfQogICAgfTsKICB9CiAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzID0KICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzIHx8IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIgaW5mb3MgPSBbCiAgICAgICAgICAgIHtraW5kOiAnYXVkaW9pbnB1dCcsIGRldmljZUlkOiAnZGVmYXVsdCcsIGxhYmVsOiAnJywgZ3JvdXBJZDogJyd9LAogICAgICAgICAgICB7a2luZDogJ3ZpZGVvaW5wdXQnLCBkZXZpY2VJZDogJ2RlZmF1bHQnLCBsYWJlbDogJycsIGdyb3VwSWQ6ICcnfQogICAgICAgICAgXTsKICAgICAgICAgIHJlc29sdmUoaW5mb3MpOwogICAgICAgIH0pOwogICAgICB9OwoKICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDQxKSB7CiAgICAvLyBXb3JrIGFyb3VuZCBodHRwOi8vYnVnemlsLmxhLzExNjk2NjUKICAgIHZhciBvcmdFbnVtZXJhdGVEZXZpY2VzID0KICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMuYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gb3JnRW51bWVyYXRlRGV2aWNlcygpLnRoZW4odW5kZWZpbmVkLCBmdW5jdGlvbihlKSB7CiAgICAgICAgaWYgKGUubmFtZSA9PT0gJ05vdEZvdW5kRXJyb3InKSB7CiAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgfQogICAgICAgIHRocm93IGU7CiAgICAgIH0pOwogICAgfTsKICB9CiAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0OSkgewogICAgdmFyIG9yaWdHZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYS4KICAgICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjKSB7CiAgICAgIHJldHVybiBvcmlnR2V0VXNlck1lZGlhKGMpLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgLy8gV29yayBhcm91bmQgaHR0cHM6Ly9idWd6aWwubGEvODAyMzI2CiAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICBjLnZpZGVvICYmICFzdHJlYW0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7CiAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgIH0pOwogICAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignVGhlIG9iamVjdCBjYW4gbm90IGJlIGZvdW5kIGhlcmUuJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ05vdEZvdW5kRXJyb3InKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cmVhbTsKICAgICAgfSwgZnVuY3Rpb24oZSkgewogICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgfSk7CiAgICB9OwogIH0KICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0NCkgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhXyhjb25zdHJhaW50cywgb25TdWNjZXNzLCBvbkVycm9yKTsKICAgIH0KICAgIC8vIFJlcGxhY2UgRmlyZWZveCA0NCsncyBkZXByZWNhdGlvbiB3YXJuaW5nIHdpdGggdW5wcmVmaXhlZCB2ZXJzaW9uLgogICAgY29uc29sZS53YXJuKCduYXZpZ2F0b3IuZ2V0VXNlck1lZGlhIGhhcyBiZWVuIHJlcGxhY2VkIGJ5ICcgKwogICAgICAgICAgICAgICAgICduYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYScpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTsKICB9Owp9OwoKfSx7Ii4uL3V0aWxzIjoxMX1dLDEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLyoKICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICoKICogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlIGxpY2Vuc2UKICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZQogKiAgdHJlZS4KICovCid1c2Ugc3RyaWN0JzsKdmFyIHNhZmFyaVNoaW0gPSB7CiAgLy8gVE9ETzogRHJBbGV4LCBzaG91bGQgYmUgaGVyZSwgZG91YmxlIGNoZWNrIGFnYWluc3QgTGF5b3V0VGVzdHMKICAvLyBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7IH0sCgogIC8vIFRPRE86IG9uY2UgdGhlIGJhY2stZW5kIGZvciB0aGUgbWFjIHBvcnQgaXMgZG9uZSwgYWRkLgogIC8vIFRPRE86IGNoZWNrIGZvciB3ZWJraXRHVEsrCiAgLy8gc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsgfSwKCiAgc2hpbUdldFVzZXJNZWRpYTogZnVuY3Rpb24oKSB7CiAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1HZXRVc2VyTWVkaWE6IHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYQogIC8vIFRPRE8KICAvLyBzaGltT25UcmFjazogc2FmYXJpU2hpbS5zaGltT25UcmFjaywKICAvLyBzaGltUGVlckNvbm5lY3Rpb246IHNhZmFyaVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uCn07Cgp9LHt9XSwxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dEaXNhYmxlZF8gPSB0cnVlOwoKLy8gVXRpbGl0eSBtZXRob2RzLgp2YXIgdXRpbHMgPSB7CiAgZGlzYWJsZUxvZzogZnVuY3Rpb24oYm9vbCkgewogICAgaWYgKHR5cGVvZiBib29sICE9PSAnYm9vbGVhbicpIHsKICAgICAgcmV0dXJuIG5ldyBFcnJvcignQXJndW1lbnQgdHlwZTogJyArIHR5cGVvZiBib29sICsKICAgICAgICAgICcuIFBsZWFzZSB1c2UgYSBib29sZWFuLicpOwogICAgfQogICAgbG9nRGlzYWJsZWRfID0gYm9vbDsKICAgIHJldHVybiAoYm9vbCkgPyAnYWRhcHRlci5qcyBsb2dnaW5nIGRpc2FibGVkJyA6CiAgICAgICAgJ2FkYXB0ZXIuanMgbG9nZ2luZyBlbmFibGVkJzsKICB9LAoKICBsb2c6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSB7CiAgICAgIGlmIChsb2dEaXNhYmxlZF8pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5sb2cgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLyoqCiAgICogRXh0cmFjdCBicm93c2VyIHZlcnNpb24gb3V0IG9mIHRoZSBwcm92aWRlZCB1c2VyIGFnZW50IHN0cmluZy4KICAgKgogICAqIEBwYXJhbSB7IXN0cmluZ30gdWFzdHJpbmcgdXNlckFnZW50IHN0cmluZy4KICAgKiBAcGFyYW0geyFzdHJpbmd9IGV4cHIgUmVndWxhciBleHByZXNzaW9uIHVzZWQgYXMgbWF0Y2ggY3JpdGVyaWEuCiAgICogQHBhcmFtIHshbnVtYmVyfSBwb3MgcG9zaXRpb24gaW4gdGhlIHZlcnNpb24gc3RyaW5nIHRvIGJlIHJldHVybmVkLgogICAqIEByZXR1cm4geyFudW1iZXJ9IGJyb3dzZXIgdmVyc2lvbi4KICAgKi8KICBleHRyYWN0VmVyc2lvbjogZnVuY3Rpb24odWFzdHJpbmcsIGV4cHIsIHBvcykgewogICAgdmFyIG1hdGNoID0gdWFzdHJpbmcubWF0Y2goZXhwcik7CiAgICByZXR1cm4gbWF0Y2ggJiYgbWF0Y2gubGVuZ3RoID49IHBvcyAmJiBwYXJzZUludChtYXRjaFtwb3NdLCAxMCk7CiAgfSwKCiAgLyoqCiAgICogQnJvd3NlciBkZXRlY3Rvci4KICAgKgogICAqIEByZXR1cm4ge29iamVjdH0gcmVzdWx0IGNvbnRhaW5pbmcgYnJvd3NlciBhbmQgdmVyc2lvbgogICAqICAgICBwcm9wZXJ0aWVzLgogICAqLwogIGRldGVjdEJyb3dzZXI6IGZ1bmN0aW9uKCkgewogICAgLy8gUmV0dXJuZWQgcmVzdWx0IG9iamVjdC4KICAgIHZhciByZXN1bHQgPSB7fTsKICAgIHJlc3VsdC5icm93c2VyID0gbnVsbDsKICAgIHJlc3VsdC52ZXJzaW9uID0gbnVsbDsKCiAgICAvLyBGYWlsIGVhcmx5IGlmIGl0J3Mgbm90IGEgYnJvd3NlcgogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8ICF3aW5kb3cubmF2aWdhdG9yKSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIGJyb3dzZXIuJzsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvLyBGaXJlZm94LgogICAgaWYgKG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEpIHsKICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnZmlyZWZveCc7CiAgICAgIHJlc3VsdC52ZXJzaW9uID0gdGhpcy5leHRyYWN0VmVyc2lvbihuYXZpZ2F0b3IudXNlckFnZW50LAogICAgICAgICAgL0ZpcmVmb3hcLyhbMC05XSspXC4vLCAxKTsKCiAgICAvLyBhbGwgd2Via2l0LWJhc2VkIGJyb3dzZXJzCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEpIHsKICAgICAgLy8gQ2hyb21lLCBDaHJvbWl1bSwgV2VidmlldywgT3BlcmEsIGFsbCB1c2UgdGhlIGNocm9tZSBzaGltIGZvciBub3cKICAgICAgaWYgKHdpbmRvdy53ZWJraXRSVENQZWVyQ29ubmVjdGlvbikgewogICAgICAgIHJlc3VsdC5icm93c2VyID0gJ2Nocm9tZSc7CiAgICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvQ2hyb20oZXxpdW0pXC8oWzAtOV0rKVwuLywgMik7CgogICAgICAvLyBTYWZhcmkgb3IgdW5rbm93biB3ZWJraXQtYmFzZWQKICAgICAgLy8gZm9yIHRoZSB0aW1lIGJlaW5nIFNhZmFyaSBoYXMgc3VwcG9ydCBmb3IgTWVkaWFTdHJlYW1zIGJ1dCBub3Qgd2ViUlRDCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gU2FmYXJpIFVBIHN1YnN0cmluZ3Mgb2YgaW50ZXJlc3QgZm9yIHJlZmVyZW5jZToKICAgICAgICAvLyAtIHdlYmtpdCB2ZXJzaW9uOiAgICAgICAgICAgQXBwbGVXZWJLaXQvNjAyLjEuMjUgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLyAtIHNhZmFyaSBVSSB2ZXJzaW9uOiAgICAgICAgVmVyc2lvbi85LjAuMyAodW5pcXVlIHRvIFNhZmFyaSkKICAgICAgICAvLyAtIHNhZmFyaSBVSSB3ZWJraXQgdmVyc2lvbjogU2FmYXJpLzYwMS40LjQgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLwogICAgICAgIC8vIGlmIHRoZSB3ZWJraXQgdmVyc2lvbiBhbmQgc2FmYXJpIFVJIHdlYmtpdCB2ZXJzaW9ucyBhcmUgZXF1YWxzLAogICAgICAgIC8vIC4uLiB0aGlzIGlzIGEgc3RhYmxlIHZlcnNpb24uCiAgICAgICAgLy8KICAgICAgICAvLyBvbmx5IHRoZSBpbnRlcm5hbCB3ZWJraXQgdmVyc2lvbiBpcyBpbXBvcnRhbnQgdG9kYXkgdG8ga25vdyBpZgogICAgICAgIC8vIG1lZGlhIHN0cmVhbXMgYXJlIHN1cHBvcnRlZAogICAgICAgIC8vCiAgICAgICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1ZlcnNpb25cLyhcZCspLihcZCspLykpIHsKICAgICAgICAgIHJlc3VsdC5icm93c2VyID0gJ3NhZmFyaSc7CiAgICAgICAgICByZXN1bHQudmVyc2lvbiA9IHRoaXMuZXh0cmFjdFZlcnNpb24obmF2aWdhdG9yLnVzZXJBZ2VudCwKICAgICAgICAgICAgL0FwcGxlV2ViS2l0XC8oWzAtOV0rKVwuLywgMSk7CgogICAgICAgIC8vIHVua25vd24gd2Via2l0LWJhc2VkIGJyb3dzZXIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnVW5zdXBwb3J0ZWQgd2Via2l0LWJhc2VkIGJyb3dzZXIgJyArCiAgICAgICAgICAgICAgJ3dpdGggR1VNIHN1cHBvcnQgYnV0IG5vIFdlYlJUQyBzdXBwb3J0Lic7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgICAgfQoKICAgIC8vIEVkZ2UuCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMgJiYKICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9FZGdlXC8oXGQrKS4oXGQrKSQvKSkgewogICAgICByZXN1bHQuYnJvd3NlciA9ICdlZGdlJzsKICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvRWRnZVwvKFxkKykuKFxkKykkLywgMik7CgogICAgLy8gRGVmYXVsdCBmYWxsdGhyb3VnaDogbm90IHN1cHBvcnRlZC4KICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIHN1cHBvcnRlZCBicm93c2VyLic7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9LAoKICAvLyBzaGltQ3JlYXRlT2JqZWN0VVJMIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBzaGltU291cmNlT2JqZWN0IHRvIGF2b2lkIGxvb3AuCgogIHNoaW1DcmVhdGVPYmplY3RVUkw6IGZ1bmN0aW9uKCkgewogICAgaWYgKCEodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAgICdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgLy8gT25seSBzaGltIENyZWF0ZU9iamVjdFVSTCB1c2luZyBzcmNPYmplY3QgaWYgc3JjT2JqZWN0IGV4aXN0cy4KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICB2YXIgbmF0aXZlQ3JlYXRlT2JqZWN0VVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgbmF0aXZlUmV2b2tlT2JqZWN0VVJMID0gVVJMLnJldm9rZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgc3RyZWFtcyA9IG5ldyBNYXAoKSwgbmV3SWQgPSAwOwoKICAgIFVSTC5jcmVhdGVPYmplY3RVUkwgPSBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgaWYgKCdnZXRUcmFja3MnIGluIHN0cmVhbSkgewogICAgICAgIHZhciB1cmwgPSAncG9seWJsb2I6JyArICgrK25ld0lkKTsKICAgICAgICBzdHJlYW1zLnNldCh1cmwsIHN0cmVhbSk7CiAgICAgICAgY29uc29sZS5sb2coJ1VSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKSBpcyBkZXByZWNhdGVkISAnICsKICAgICAgICAgICAgICAgICAgICAnVXNlIGVsZW0uc3JjT2JqZWN0ID0gc3RyZWFtIGluc3RlYWQhJyk7CiAgICAgICAgcmV0dXJuIHVybDsKICAgICAgfQogICAgICByZXR1cm4gbmF0aXZlQ3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICB9OwogICAgVVJMLnJldm9rZU9iamVjdFVSTCA9IGZ1bmN0aW9uKHVybCkgewogICAgICBuYXRpdmVSZXZva2VPYmplY3RVUkwodXJsKTsKICAgICAgc3RyZWFtcy5kZWxldGUodXJsKTsKICAgIH07CgogICAgdmFyIGRzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NyYycpOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyYycsIHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gZHNjLmdldC5hcHBseSh0aGlzKTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbih1cmwpIHsKICAgICAgICB0aGlzLnNyY09iamVjdCA9IHN0cmVhbXMuZ2V0KHVybCkgfHwgbnVsbDsKICAgICAgICByZXR1cm4gZHNjLnNldC5hcHBseSh0aGlzLCBbdXJsXSk7CiAgICAgIH0KICAgIH0pOwogIH0KfTsKCi8vIEV4cG9ydC4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgbG9nOiB1dGlscy5sb2csCiAgZGlzYWJsZUxvZzogdXRpbHMuZGlzYWJsZUxvZywKICBicm93c2VyRGV0YWlsczogdXRpbHMuZGV0ZWN0QnJvd3NlcigpLAogIGV4dHJhY3RWZXJzaW9uOiB1dGlscy5leHRyYWN0VmVyc2lvbiwKICBzaGltQ3JlYXRlT2JqZWN0VVJMOiB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMCn07Cgp9LHt9XSwxMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCnJlcXVpcmUoJ3dlYnJ0Yy1hZGFwdGVyJyk7CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCi8qKgogIFRoZSBDb25uZWN0aW9uQ29udHJvbGxlciBoYXMgYSBnZW5lcmljIGRlc2lnbiBzbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGluIGJvdGggc3R1YnMuCiAgSXQgbWFuYWdlcyBhIHNpbmdsZSBEYXRhQ2hhbm5lbCwgaXQgaXMgbm90IHJlcXVlc3RpbmcgYWNjZXNzIHRvIG1lZGlhIGlucHV0LCBpLmUuCiAgZG9lcyBub3QgaGF2ZSBhdWRpby92aWRlbyBzdHJlYW1zLgoqKi8KdmFyIENvbm5lY3Rpb25Db250cm9sbGVyID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENvbm5lY3Rpb25Db250cm9sbGVyKG15VXJsLCBzeW5jaGVyLCBjb25maWd1cmF0aW9uLCBjYWxsZXIpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb25uZWN0aW9uQ29udHJvbGxlcik7CgogICAgaWYgKCFteVVybCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgb3duIHVybCAobXlVcmwpIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFzeW5jaGVyKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzeW5jaGVyIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFjb25maWd1cmF0aW9uKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWd1cmF0aW9uIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoKICAgIHRoaXMuX2RvbWFpbiA9IHRoaXMuX2RpdmlkZVVSTChteVVybClbImRvbWFpbiJdOwogICAgdGhpcy5fb2JqZWN0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovL2NhdGFsb2d1ZS4nICsgdGhpcy5fZG9tYWluICsgJy8ud2VsbC1rbm93bi9kYXRhc2NoZW1hL0Nvbm5lY3Rpb24nOwoKICAgIHRoaXMuX215VXJsID0gbXlVcmw7CiAgICB0aGlzLl9zeW5jaGVyID0gc3luY2hlcjsKICAgIHRoaXMuX2NvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uOwogICAgdGhpcy5fY2FsbGVyID0gY2FsbGVyOwogICAgdGhpcy5fZGF0YU9iamVjdE9ic2VydmVyOwogICAgdGhpcy5fZGF0YU9iamVjdFJlcG9ydGVyOwogICAgdGhpcy5fcGVlclVybDsKICAgIHRoaXMuX2RhdGFDaGFubmVsOwogICAgdGhpcy5fb25TdGF0dXNVcGRhdGU7CiAgICB0aGlzLl9yZW1vdGVSdW50aW1lVVJMOwoKICAgIHRoaXMuX3BlZXJDb25uZWN0aW9uID0gdGhpcy5fY3JlYXRlUGVlckNvbm5lY3Rpb24oKTsKICB9CgogIC8vY3JlYXRlIGEgcGVlciBjb25uZWN0aW9uIHdpdGggaXRzIGV2ZW50IGhhbmRsZXJzCgoKICBfY3JlYXRlQ2xhc3MoQ29ubmVjdGlvbkNvbnRyb2xsZXIsIFt7CiAgICBrZXk6ICdfY3JlYXRlUGVlckNvbm5lY3Rpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVQZWVyQ29ubmVjdGlvbigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBwYyA9IHRoaXMuX3BlZXJDb25uZWN0aW9uOwogICAgICBpZiAoIXBjKSB7CiAgICAgICAgcGMgPSBuZXcgUlRDUGVlckNvbm5lY3Rpb24odGhpcy5fY29uZmlndXJhdGlvbik7CiAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiBjcmVhdGVkIFBlZXJDb25uZWN0aW9uIik7CgogICAgICAgIC8vIGFkZCBoYW5kbGVyIGZvciBkYXRhY2hhbm5lbCBjcmVhdGlvbiBmcm9tIHBlZXIgc2lkZQogICAgICAgIHBjLm9uZGF0YWNoYW5uZWwgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogb25kYXRhY2hhbm5lbCAtPiByZW1vdGUgc2lkZSBoYXMgY3JlYXRlZCBhIGRhdGFjaGFubmVsIik7CiAgICAgICAgICBfdGhpcy5fZGF0YUNoYW5uZWwgPSBldmVudC5jaGFubmVsOwogICAgICAgICAgX3RoaXMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfTsKCiAgICAgICAgLy8gZXZlbnQgaGFuZGxlciBmb3IgbG9jYWwgaWNlIGNhbmRpZGF0ZXMKICAgICAgICBwYy5vbmljZWNhbmRpZGF0ZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IGljZWNhbmRpZGF0ZWV2ZW50IG9jY3VyZWQ6ICIsIGUpOwogICAgICAgICAgaWYgKCFlLmNhbmRpZGF0ZSkgcmV0dXJuOwogICAgICAgICAgdmFyIGljZWNhbmRpZGF0ZSA9IHsKICAgICAgICAgICAgdHlwZTogJ2NhbmRpZGF0ZScsCiAgICAgICAgICAgIGNhbmRpZGF0ZTogZS5jYW5kaWRhdGUuY2FuZGlkYXRlLAogICAgICAgICAgICBzZHBNaWQ6IGUuY2FuZGlkYXRlLnNkcE1pZCwKICAgICAgICAgICAgc2RwTUxpbmVJbmRleDogZS5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleAogICAgICAgICAgfTsKICAgICAgICAgIC8vIHNlbmQgY2FuZGlkYXRlIHRvIHJlbW90ZSBwZWVyIGJ5IHB1c2hpbmcgaXQgdG8gdGhlIHJlcG9ydGVyIG9iamVjdAogICAgICAgICAgX3RoaXMuX2RhdGFPYmplY3RSZXBvcnRlci5kYXRhLmljZUNhbmRpZGF0ZXMucHVzaChpY2VjYW5kaWRhdGUpOwogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIHBjOwogICAgfQoKICAgIC8qKgogICAgUmVhY3QgdG8gdGhlIGdpdmVuIGludml0YXRpb24gZXZlbnQgYnkgc3Vic2NyaWJpbmcgdG8gdGhlIHByb3ZpZGVkIGludml0YXRpb25FdmVudC51cmwuCiAgICAqKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb2JzZXJ2ZShpbnZpdGF0aW9uRXZlbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLl9wZWVyVXJsID0gaW52aXRhdGlvbkV2ZW50LmZyb207CiAgICAgIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwgPSBpbnZpdGF0aW9uRXZlbnQudmFsdWUucnVudGltZVVSTDsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIF90aGlzMi5fc3luY2hlci5zdWJzY3JpYmUoX3RoaXMyLl9vYmplY3REZXNjVVJMLCBpbnZpdGF0aW9uRXZlbnQudXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgICAgIGNvbnNvbGUuaW5mbygnK1tQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIGdvdCBEYXRhIE9iamVjdCBPYnNlcnZlcicsIGRhdGFPYmplY3RPYnNlcnZlcik7CiAgICAgICAgICBfdGhpczIuX3NldHVwT2JzZXJ2ZXIoZGF0YU9iamVjdE9ic2VydmVyKTsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICByZWplY3QoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICBDcmVhdGVzIGEgc3luY2hlciBvYmplY3QgYW5kIGludml0ZSB0aGUgZ2l2ZW4gcGVlclVybCB0byBzdWJzY3JpYmUgZm9yIGl0LgogICAgQWxzbyBjcmVhdGVzIHRoZSBsb2NhbCBvZmZlciwgcGVyZm9ybXMgc2V0TG9jYWxEZXNjcmlwdGlvbiBhbmQgcHVibGlzaGVzIHRoZSBvZmZlciB2aWEgdGhlIHJlcG9ydGVyIG9iamVjdC4KICAgICoqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcG9ydChwZWVyVXJsLCBvd25SdW50aW1lVXJsKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLl9wZWVyVXJsKSB0aGlzLl9wZWVyVXJsID0gcGVlclVybDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgLy8gIGlmIHdlIGFyZSB0aGUgY2FsbGVyIChpLmUuIG5vIHJlcG9ydGVyIG9iamVjdCBwcmVzZW50IHlldCwgaW5pdGFsaXplIHRoZSBjcmVhdGlvbiBvZiB0aGUgRGF0YUNoYW5uZWwpCiAgICAgICAgaWYgKF90aGlzMy5fY2FsbGVyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHdlIGFyZSBpbiBjYWxsZXIgcm9sZSAtLT4gY3JlYXRlRGF0YUNoYW5uZWwgLi4uIik7CiAgICAgICAgICBfdGhpczMuX2RhdGFDaGFubmVsID0gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVEYXRhQ2hhbm5lbCgiUDJQQ2hhbm5lbCIsIHsgcmVsaWFibGU6IGZhbHNlIH0pOwogICAgICAgICAgY29uc29sZS5sb2coIlAyUDogZGF0YWNoYW5uZWwgb2JqZWN0IiwgX3RoaXMzLl9kYXRhQ2hhbm5lbCk7CiAgICAgICAgICBfdGhpczMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBpbml0aWFsIGRhdGEgZm9yIHJlcG9ydGVyIHN5bmMgb2JqZWN0CiAgICAgICAgdmFyIGRhdGFPYmplY3QgPSB7CiAgICAgICAgICBuYW1lOiAiUDJQQ29ubmVjdGlvbiIsCiAgICAgICAgICBzdGF0dXM6ICIiLAogICAgICAgICAgb3duZXI6IF90aGlzMy5fbXlVcmwsCiAgICAgICAgICBydW50aW1lVVJMOiBvd25SdW50aW1lVXJsLCAvLyBwdXQgdGhlIG93biBydW50aW1lVVJMIHRvIHRoZSBkYXRhT2JqZWN0IChhcyBkaXNjdXNzZWQgd2l0aCBQYXVsbykKICAgICAgICAgIGNvbm5lY3Rpb25EZXNjcmlwdGlvbjoge30sCiAgICAgICAgICBpY2VDYW5kaWRhdGVzOiBbXQogICAgICAgIH07CiAgICAgICAgLy8gZW5zdXJlIHRoaXMgdGhlIG9ialJlcG9ydGVyIG9iamVjdCBpcyBjcmVhdGVkIGJlZm9yZSB3ZSBjcmVhdGUgdGhlIG9mZmVyCiAgICAgICAgX3RoaXMzLl9zeW5jaGVyLmNyZWF0ZShfdGhpczMuX29iamVjdERlc2NVUkwsIFtfdGhpczMuX3BlZXJVcmxdLCBkYXRhT2JqZWN0KS50aGVuKGZ1bmN0aW9uIChvYmpSZXBvcnRlcikgewogICAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBDcmVhdGVkIFdlYlJUQyBPYmplY3QgUmVwb3J0ZXInLCBvYmpSZXBvcnRlcik7CgogICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIgPSBvYmpSZXBvcnRlcjsKICAgICAgICAgIF90aGlzMy5fZGF0YU9iamVjdFJlcG9ydGVyLm9uU3Vic2NyaXB0aW9uKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICBldmVudC5hY2NlcHQoKTsgLy8gYWxsIHN1YnNjcmlwdGlvbiByZXF1ZXN0ZWQgYXJlIGFjY2VwdGVkCiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgY29uc3RyYWludHMgPSB7CiAgICAgICAgICAgIG9mZmVyVG9SZWNlaXZlQXVkaW86IGZhbHNlLAogICAgICAgICAgICBvZmZlclRvUmVjZWl2ZVZpZGVvOiBmYWxzZQogICAgICAgICAgfTsKICAgICAgICAgIC8vIGVpdGhlciBpbnZva2UgY3JlYXRlT2ZmZXIgb3IgY3JlYXRlQW5zd2VyLCBkZXBlbmRpbmcgb24gdGhlIHJvbGVzCiAgICAgICAgICB2YXIgc2RwUHJvbWlzZSA9IF90aGlzMy5fY2FsbGVyID8gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVPZmZlcihjb25zdHJhaW50cykgOiBfdGhpczMuX3BlZXJDb25uZWN0aW9uLmNyZWF0ZUFuc3dlcigpOwogICAgICAgICAgc2RwUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChzZHApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIFNEUCBjcmVhdGVkIiwgc2RwKTsKICAgICAgICAgICAgX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5zZXRMb2NhbERlc2NyaXB0aW9uKG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oc2RwKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gbG9jYWxEZXNjcmlwdGlvbiBzZXQgc3VjY2Vzc2Z1bGx5Jyk7CiAgICAgICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIuZGF0YS5jb25uZWN0aW9uRGVzY3JpcHRpb24gPSBzZHA7CiAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHJlamVjdCgic2V0dGluZyBvZiBsb2NhbERlc2NyaXB0aW9uIGZhaWxlZDogIiwgZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICAgIHJlamVjdChyZWFzb24pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25NZXNzYWdlKGNhbGxiYWNrKSB7CiAgICAgIC8vIGFkZCB0aGUgbWVzc2FnZSBjYWxsYmFjawogICAgICB0aGlzLl9vbkRhdGFDaGFubmVsTWVzc2FnZSA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uU3RhdHVzVXBkYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblN0YXR1c1VwZGF0ZShjYWxsYmFjaykgewogICAgICAvLyBhZGQgYSBjb25uZWN0aW9uIHN0YXR1cyB1cGRhdGUgY2FsbGJhY2sKICAgICAgdGhpcy5fb25TdGF0dXNVcGRhdGUgPSBjYWxsYmFjazsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdzZW5kTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZE1lc3NhZ2UobSkgewogICAgICAvLyB0b2RvOiBvbmx5IHNlbmQgaWYgZGF0YSBjaGFubmVsIGlzIGNvbm5lY3RlZAogICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gLS0+IG91dGdvaW5nIG1zZzogIiwgbSk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLnNlbmQobSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnY2xlYW51cCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYW51cCgpIHsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RPYnNlcnZlcjsKICAgICAgaWYgKHRoaXMuX2RhdGFDaGFubmVsKSB0aGlzLl9kYXRhQ2hhbm5lbC5jbG9zZSgpOwogICAgICBpZiAodGhpcy5fcGVlckNvbm5lY3Rpb24pIHRoaXMuX3BlZXJDb25uZWN0aW9uLmNsb3NlKCk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsID0gbnVsbDsKICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24gPSBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogJ19hZGREYXRhQ2hhbm5lbExpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxPcGVuKCk7CiAgICAgIH07CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzNC5fb25EYXRhQ2hhbm5lbEVycm9yKGUpOwogICAgICB9OwogICAgICB0aGlzLl9kYXRhQ2hhbm5lbC5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAobSkgewogICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSA8LS0gaW5jb21pbmcgbXNnOiAiLCBtKTsKICAgICAgICBpZiAoX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZSkgX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZShtKTsKICAgICAgfTsKICAgICAgdGhpcy5fZGF0YUNoYW5uZWwub25jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxDbG9zZSgpOwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZXR1cE9ic2VydmVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0dXBPYnNlcnZlcihkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIgPSBkYXRhT2JqZWN0T2JzZXJ2ZXI7CgogICAgICB2YXIgcGVlckRhdGEgPSB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YTsKICAgICAgY29uc29sZS5pbmZvKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogX3NldHVwT2JzZXJ2ZXIgUGVlciBEYXRhOiIsIHBlZXJEYXRhKTsKCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnY29ubmVjdGlvbkRlc2NyaXB0aW9uJykpIHsKICAgICAgICB0aGlzLl9wcm9jZXNzUGVlckluZm9ybWF0aW9uKHBlZXJEYXRhLmNvbm5lY3Rpb25EZXNjcmlwdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnaWNlQ2FuZGlkYXRlcycpKSB7CiAgICAgICAgcGVlckRhdGEuaWNlQ2FuZGlkYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChpY2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogaGFuZGxlT2JzZXJ2ZXJPYmplY3QgZm9yIGljZSIsIGljZSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oaWNlKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgLy8gc2V0dXAgbGlzdGVuZXIgZm9yIGZ1dHVyZSBjaGFuZ2VzIG9uIHRoZSBvYnNlcnZlZCBkYXRhIG9iamVjdAogICAgICBkYXRhT2JqZWN0T2JzZXJ2ZXIub25DaGFuZ2UoJyonLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBjb25zb2xlLmRlYnVnKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogT2JzZXJ2ZXIgb24gY2hhbmdlIG1lc3NhZ2U6ICcsIGV2ZW50KTsKICAgICAgICAvLyB3ZSBuZWVkIHRvIHByb2Nlc3MgdGhlIGFuc3dlciBmcm9tIGV2ZW50LmRhdGEgYW5kIHRoZSBjYW5kaWRhdGVzIHdoaWNoIG1pZ2h0IHRyaWNrbGUKICAgICAgICAvLyBmcm9tIGV2ZW50LmRhdGFbMF0KICAgICAgICBpZiAoZXZlbnQuZGF0YVswXSkgewogICAgICAgICAgLy8gWzBdIHRoaXMgZG9lcyB0aGUgdHJpY2sgd2hlbiBpY2UgY2FuZGlkYXRlcyBhcmUgdHJpY2tsaW5nIDspCiAgICAgICAgICBjb25zb2xlLmxvZygnPj5ldmVudC5kYXRhWzBdJywgZXZlbnQuZGF0YVswXSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oZXZlbnQuZGF0YVswXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogPj5ldmVudCcsIGV2ZW50KTsKICAgICAgICAgIF90aGlzNS5fcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihldmVudC5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19wcm9jZXNzUGVlckluZm9ybWF0aW9uJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihkYXRhKSB7CiAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246ICIsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgaWYgKCF0aGlzLl9wZWVyQ29ubmVjdGlvbikgewogICAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246IG5vIFBlZXJDb25uZWN0aW9uIGV4aXN0aW5nIC0tPiBtYXliZSBpbiBkaXNjb25uZWN0aW5nIHByb2Nlc3MuIC0tPiBpZ25vcmluZyB0aGlzIHVwZGF0ZSIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGRhdGEudHlwZSA9PT0gJ29mZmVyJyB8fCBkYXRhLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogUHJvY2VzcyBDb25uZWN0aW9uIERlc2NyaXB0aW9uOiAnLCBkYXRhKTsKICAgICAgICB0aGlzLl9wZWVyQ29ubmVjdGlvbi5zZXRSZW1vdGVEZXNjcmlwdGlvbihuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKGRhdGEpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogcmVtb3RlIHN1Y2Nlc3MiKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiByZW1vdGUgZXJyb3I6ICIsIGUpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoZGF0YS5jYW5kaWRhdGUpIHsKICAgICAgICBjb25zb2xlLmluZm8oJ1Byb2Nlc3MgSWNlIENhbmRpZGF0ZTogJywgZGF0YSk7CiAgICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24uYWRkSWNlQ2FuZGlkYXRlKG5ldyBSVENJY2VDYW5kaWRhdGUoewogICAgICAgICAgY2FuZGlkYXRlOiBkYXRhLmNhbmRpZGF0ZQogICAgICAgIH0pKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsT3BlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRGF0YUNoYW5uZWxPcGVuKCkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgb3BlbmVkJyk7CiAgICAgIGlmICh0aGlzLl9vblN0YXR1c1VwZGF0ZSkgdGhpcy5fb25TdGF0dXNVcGRhdGUoImxpdmUiLCB1bmRlZmluZWQsIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsRXJyb3InLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsRXJyb3IoZSkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgZXJyb3I6ICcsIGUpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiIiArIGUpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsQ2xvc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsQ2xvc2UoKSB7CiAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBEYXRhQ2hhbm5lbCBjbG9zZWQ6ICcpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiY2xvc2VkIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICAgICAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAgICAgKiBAcmV0dXJuIHtkaXZpZGVVUkx9IHRoZSByZXN1bHQgb2YgZGl2aWRlVVJMCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnX2RpdmlkZVVSTCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RpdmlkZVVSTCh1cmwpIHsKCiAgICAgIC8vIGxldCByZSA9IC8oW2EtekEtWi1dKik/OlwvXC8oPzpcLik/KFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIpKihcL1tcL1xkXHdcLi1dKikqKD86W1w/XSkqKC4rKSovZ2k7CiAgICAgIHZhciByZSA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogICAgICB2YXIgc3Vic3QgPSAnJDEsJDIsJDMnOwogICAgICB2YXIgcGFydHMgPSB1cmwucmVwbGFjZShyZSwgc3Vic3QpLnNwbGl0KCcsJyk7CgogICAgICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzCiAgICAgIGlmIChwYXJ0c1swXSA9PT0gdXJsKSB7CiAgICAgICAgcGFydHNbMF0gPSAnaHR0cHMnOwogICAgICAgIHBhcnRzWzFdID0gdXJsOwogICAgICB9CgogICAgICB2YXIgcmVzdWx0ID0gewogICAgICAgIHR5cGU6IHBhcnRzWzBdLAogICAgICAgIGRvbWFpbjogcGFydHNbMV0sCiAgICAgICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgICAgIH07CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIENvbm5lY3Rpb25Db250cm9sbGVyOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBDb25uZWN0aW9uQ29udHJvbGxlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsid2VicnRjLWFkYXB0ZXIiOjN9XSwxMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IGFjdGl2YXRlOwoKdmFyIF9TeW5jaGVyID0gcmVxdWlyZSgnc2VydmljZS1mcmFtZXdvcmsvZGlzdC9TeW5jaGVyJyk7Cgp2YXIgX0Nvbm5lY3Rpb25Db250cm9sbGVyID0gcmVxdWlyZSgnLi9Db25uZWN0aW9uQ29udHJvbGxlcicpOwoKdmFyIF9Db25uZWN0aW9uQ29udHJvbGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Db25uZWN0aW9uQ29udHJvbGxlcik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgovLyBUT0RPOiBpbnRlZ3JhdGUgdGhlIHN0YXR1cyBldmVudGluZwoKLyoqCiAqIFByb3RvU3R1YiBJbnRlcmZhY2UKICovCnZhciBQMlBSZXF1ZXN0ZXJTdHViID0gZnVuY3Rpb24gKCkgewoKICAvKioKICAgKiBJbml0aWFsaXNlIHRoZSBwcm90b2NvbCBzdHViIGluY2x1ZGluZyBhcyBpbnB1dCBwYXJhbWV0ZXJzIGl0cyBhbGxvY2F0ZWQKICAgKiBjb21wb25lbnQgcnVudGltZSB1cmwsIHRoZSBydW50aW1lIEJVUyBwb3N0TWVzc2FnZSBmdW5jdGlvbiB0byBiZSBpbnZva2VkCiAgICogb24gbWVzc2FnZXMgcmVjZWl2ZWQgYnkgdGhlIHByb3RvY29sIHN0dWIgYW5kIHJlcXVpcmVkIGNvbmZpZ3VyYXRpb24gcmV0cmlldmVkIGZyb20gcHJvdG9jb2xTdHViIGRlc2NyaXB0b3IuCiAgICogQHBhcmFtICB7VVJMLnJ1bnRpbWVQcm90b1N0dWJVUkx9ICAgICAgICAgICAgICAgICAgIHJ1bnRpbWVQcm90b1N0dWJVUkwgcnVudGltZVByb3RvU3ViVVJMCiAgICogQHBhcmFtICB7TWVzc2FnZS5NZXNzYWdlfSAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1c1Bvc3RNZXNzYWdlICAgICBjb25maWd1cmF0aW9uCiAgICogQHBhcmFtICB7UHJvdG9TdHViRGVzY3JpcHRvci5Db25maWd1cmF0aW9uRGF0YUxpc3R9IGNvbmZpZ3VyYXRpb24gICAgICBjb25maWd1cmF0aW9uCiAgICovCiAgZnVuY3Rpb24gUDJQUmVxdWVzdGVyU3R1YihydW50aW1lUHJvdG9TdHViVVJMLCBtaW5pQnVzLCBjb25maWd1cmF0aW9uKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQMlBSZXF1ZXN0ZXJTdHViKTsKCiAgICBpZiAoIXJ1bnRpbWVQcm90b1N0dWJVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIHJ1bnRpbWVQcm90b1N0dWJVUkwgaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKICAgIGlmICghbWluaUJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWNvbmZpZ3VyYXRpb24pIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZ3VyYXRpb24gaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKICAgIC8vIGlmICghY29uZmlndXJhdGlvbi5wMnBIYW5kbGVyKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBwMnBIYW5kbGVyIGlzIGEgcmVxdWlyZWQgYXR0cmlidXRlIGluIHRoZSBjb25maWd1cmF0aW9uIHBhcmFtZXRlcicpOwoKICAgIGNvbnNvbGUubG9nKCcrW1AyUFJlcXVlc3RlclN0dWIuY29uc3RydWN0b3JdIGNvbmZpZyBpczogJywgY29uZmlndXJhdGlvbik7CiAgICB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMID0gcnVudGltZVByb3RvU3R1YlVSTDsKICAgIHRoaXMuX3J1bnRpbWVVUkwgPSBjb25maWd1cmF0aW9uLnJ1bnRpbWVVUkw7CiAgICB0aGlzLl9yZW1vdGVSdW50aW1lVVJMID0gY29uZmlndXJhdGlvbi5yZW1vdGVSdW50aW1lVVJMOyAvLyByZXF1aXJlZCBmb3Igc3RhdHVzIGV2ZW50cwogICAgdGhpcy5fY29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247CiAgICB0aGlzLl9idXMgPSBtaW5pQnVzOwogICAgdGhpcy5fYnVzLmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24gKG1zZykgewogICAgICBfdGhpcy5fc2VuZENoYW5uZWxNc2cobXNnKTsKICAgIH0pOwoKICAgIHRoaXMuX3N5bmNoZXIgPSBuZXcgX1N5bmNoZXIuU3luY2hlcihydW50aW1lUHJvdG9TdHViVVJMLCBtaW5pQnVzLCBjb25maWd1cmF0aW9uKTsKICAgIHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyID0gbmV3IF9Db25uZWN0aW9uQ29udHJvbGxlcjIuZGVmYXVsdCh0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMLCB0aGlzLl9zeW5jaGVyLCB0aGlzLl9jb25maWd1cmF0aW9uLCB0cnVlKTsKICAgIHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyLm9uU3RhdHVzVXBkYXRlKGZ1bmN0aW9uIChzdGF0dXMsIHJlYXNvbikgewogICAgICBfdGhpcy5fc2VuZFN0YXR1cyhzdGF0dXMsIHJlYXNvbik7CiAgICB9KTsKCiAgICB0aGlzLl9zeW5jaGVyLm9uTm90aWZpY2F0aW9uKGZ1bmN0aW9uIChldmVudCkgewogICAgICBjb25zb2xlLmxvZygnK1tQMlBSZXF1ZXN0ZXJTdHViXSBPbiBTeW5jaGVyIE5vdGlmaWNhdGlvbjogJywgZXZlbnQpOwogICAgICBldmVudC5hY2soMjAwKTsKCiAgICAgIHN3aXRjaCAoZXZlbnQudHlwZSkgewoKICAgICAgICBjYXNlICdjcmVhdGUnOgogICAgICAgICAgLy8gaW5jb21pbmcgb2JzZXJ2ZSBpbnZpdGF0aW9uIGZyb20gcGVlcgogICAgICAgICAgaWYgKF90aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcikgewogICAgICAgICAgICBfdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXIub2JzZXJ2ZShldmVudCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIitbUDJQUmVxdWVzdGVyU3R1Yl0gb2JzZXJ2ZXIgY3JlYXRlZCAiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnZGVsZXRlJzoKICAgICAgICAgIC8vIFRPRE86IHF1ZXN0aW9uIHJlZ2FyZGluZyBjb2RlIGluIENvbm5lY3RvcjogLS0+IHRoZXJlIGl0IGRlbGV0ZXMgYWxsIGNvbnRyb2xsZXJzIC0tPiB3aHk/CiAgICAgICAgICBjb25zb2xlLmxvZygiK1tQMlBSZXF1ZXN0ZXJTdHViXSBkZWxldGluZyBjb25uZWN0aW9uIGhhbmRsZXIgZm9yICIgKyBldmVudC5mcm9tKTsKCiAgICAgICAgICBkaXNjb25uZWN0KCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgfQogICAgfSk7CgogICAgdGhpcy5fc2VuZFN0YXR1cygiY3JlYXRlIik7CgogICAgLy8gdGhlIHRhcmdldCBoYW5kbGVyIHN0dWIgdXJsIG11c3QgYmUgcHJlc2VudCBpbiB0aGUgY29uZmlndXJhdGlvbiBhcyAicDJwSGFuZGxlciIgYXR0cmlidXRlCiAgICBpZiAodGhpcy5fY29uZmlndXJhdGlvbi5wMnBIYW5kbGVyKSB0aGlzLmNvbm5lY3QodGhpcy5fY29uZmlndXJhdGlvbi5wMnBIYW5kbGVyKTsKICB9CgogIF9jcmVhdGVDbGFzcyhQMlBSZXF1ZXN0ZXJTdHViLCBbewogICAga2V5OiAnY29ubmVjdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29ubmVjdChoYW5kbGVyVVJMKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXIucmVwb3J0KGhhbmRsZXJVUkwsIHRoaXMuX3J1bnRpbWVVUkwpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIC8vIHNlbmQgImluLXByb2dyZXNzIiBldmVudCwgaWYgdGhlIHN5bmNoZXIuY3JlYXRlIHdhcyBkb25lCiAgICAgICAgX3RoaXMyLl9zZW5kU3RhdHVzKCJpbi1wcm9ncmVzcyIpOwogICAgICAgIF90aGlzMi5fY29ubmVjdGlvbkNvbnRyb2xsZXIub25NZXNzYWdlKGZ1bmN0aW9uIChtKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiK1tQMlBSZXF1ZXN0ZXJTdHViXSBvbk1lc3NhZ2U6ICIsIG0pOwogICAgICAgICAgX3RoaXMyLl9kZWxpdmVyKG0pOwogICAgICAgIH0pOwogICAgICAgIGNvbnNvbGUubG9nKCIrW1AyUFJlcXVlc3RlclN0dWJdIHNldHVwIHJlcG9ydGVyIG9iamVjdCBzdWNjZXNzZnVsbHkiKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUbyBkaXNjb25uZWN0IHRoZSBwcm90b2NvbCBzdHViLgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2Rpc2Nvbm5lY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2Nvbm5lY3QoKSB7CiAgICAgIGlmICh0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcikgewogICAgICAgIHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyLmNsZWFudXAoKTsKICAgICAgICB0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlciA9IG51bGw7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc2VuZENoYW5uZWxNc2cnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kQ2hhbm5lbE1zZyhtc2cpIHsKICAgICAgaWYgKHRoaXMuX2ZpbHRlcihtc2cpKSB7CiAgICAgICAgaWYgKHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyKSB7CiAgICAgICAgICB0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlci5zZW5kTWVzc2FnZShKU09OLnN0cmluZ2lmeShtc2cpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc2VuZFN0YXR1cycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRTdGF0dXModmFsdWUsIHJlYXNvbikgewogICAgICB2YXIgbXNnID0gewogICAgICAgIHR5cGU6ICd1cGRhdGUnLAogICAgICAgIGZyb206IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwsCiAgICAgICAgdG86IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgKyAnL3N0YXR1cycsCiAgICAgICAgYm9keTogewogICAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgICAgcmVzb3VyY2U6IHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwKICAgICAgICB9CiAgICAgIH07CiAgICAgIGlmIChyZWFzb24pIHsKICAgICAgICBtc2cuYm9keS5kZXNjID0gcmVhc29uOwogICAgICB9CiAgICAgIHRoaXMuX2J1cy5wb3N0TWVzc2FnZShtc2cpOwogICAgICBjb25zb2xlLmxvZygiK1tQMlByZXF1ZXN0ZXJTdHViXSBzZW5kaW5nIHN0YXR1cyB1cGRhdGU6ICIsIG1zZyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBGaWx0ZXIgbWV0aG9kIHRoYXQgc2hvdWxkIGJlIHVzZWQgZm9yIGV2ZXJ5IG1lc3NhZ2VzIGluIGRpcmVjdGlvbjogUHJvdG9zdHViIC0+IE1lc3NhZ2VOb2RlCiAgICAgKiBAcGFyYW0gIHtNZXNzYWdlfSBtc2cgT3JpZ2luYWwgbWVzc2FnZSBmcm9tIHRoZSBNZXNzYWdlQnVzCiAgICAgKiBAcmV0dXJuIHtib29sZWFufSB0cnVlIGlmIGl0J3MgdG8gYmUgZGVsaXZlciBpbiB0aGUgTWVzc2FnZU5vZGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdfZmlsdGVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlsdGVyKG1zZykgewogICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkudmlhID09PSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMKSByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogTWV0aG9kIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gZGVsaXZlciB0aGUgbWVzc2FnZSBpbiBkaXJlY3Rpb246IFByb3Rvc3R1YiAtPiBNZXNzYWdlQnVzIChjb3JlKQogICAgICogQHBhcmFtICB7TWVzc2FnZX0gbXNnIE9yaWdpbmFsIG1lc3NhZ2UgZnJvbSB0aGUgTWVzc2FnZU5vZGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdfZGVsaXZlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGl2ZXIobXNnKSB7CiAgICAgIGNvbnNvbGUubG9nKCIrW1AyUHJlcXVlc3RlclN0dWJdIHBvc3RpbmcgbWVzc2FnZSB0byBtc2cgYnVzOiAiLCBtc2cpOwoKICAgICAgdmFyIG1lc3NhZ2UgPSBKU09OLnBhcnNlKG1zZy5kYXRhKTsKCiAgICAgIGlmICghbWVzc2FnZS5ib2R5KSBtc2cuYm9keSA9IHt9OwoKICAgICAgbWVzc2FnZS5ib2R5LnZpYSA9IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkw7CiAgICAgIHRoaXMuX2J1cy5wb3N0TWVzc2FnZShtZXNzYWdlKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBQMlBSZXF1ZXN0ZXJTdHViOwp9KCk7CgpmdW5jdGlvbiBhY3RpdmF0ZSh1cmwsIGJ1cywgY29uZmlnKSB7CiAgcmV0dXJuIHsKICAgIG5hbWU6ICdQMlBSZXF1ZXN0ZXJTdHViJywKICAgIGluc3RhbmNlOiBuZXcgUDJQUmVxdWVzdGVyU3R1Yih1cmwsIGJ1cywgY29uZmlnKQogIH07Cn0KbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi9Db25uZWN0aW9uQ29udHJvbGxlciI6MTIsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlciI6Mn1dfSx7fSxbMTNdKSgxMykKfSk7",
      "sourceCodeClassname": "P2PRequesterProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-38b3da70-28d4-8082-38f1-b1709f6ee7693",
    "version": 0.7999999999999999,
    "description": "Description of P2PRequesterProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "P2PRequesterProtoStub",
    "configuration": {
      "iceServers": [
        {
          "urls": "stun:stun.voiparound.com"
        },
        {
          "urls": "stun:stun.voipbuster.com"
        },
        {
          "urls": "stun:stun.voipstunt.com"
        },
        {
          "urls": "stun:stun.voxgratia.org"
        },
        {
          "urls": "stun:stun.ekiga.net"
        },
        {
          "urls": "stun:stun.schlund.de"
        },
        {
          "urls": "stun:stun.iptel.org"
        },
        {
          "urls": "stun:stun.l.google.com:19302"
        },
        {
          "urls": "stun:stun1.l.google.com:19302"
        },
        {
          "urls": "stun:stun.ideasip.com"
        },
        {
          "urls": "stun:stun4.l.google.com:19302"
        },
        {
          "urls": "stun:stun2.l.google.com:19302"
        },
        {
          "urls": "stun:stun3.l.google.com:19302"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=tcp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=udp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:numb.viagenie.ca",
          "credential": "muazkh",
          "username": "webrtc@live.com"
        }
      ]
    },
    "messageSchemas": "",
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": "{ windowSandbox: true }",
    "interworking": false,
    "dataObjects": []
  },
  "SlackProtoStub": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiYWN0aXZhdGUiLCBbXSwgZmFjdG9yeSk7CgllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JykKCQlleHBvcnRzWyJhY3RpdmF0ZSJdID0gZmFjdG9yeSgpOwoJZWxzZQoJCXJvb3RbImFjdGl2YXRlIl0gPSBmYWN0b3J5KCk7Cn0pKHRoaXMsIGZ1bmN0aW9uKCkgewpyZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsKCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewoKLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7CgovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewovKioqKioqLyAJCQlleHBvcnRzOiB7fSwKLyoqKioqKi8gCQkJaWQ6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsb2FkZWQ6IGZhbHNlCi8qKioqKiovIAkJfTsKCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7CgovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubG9hZGVkID0gdHJ1ZTsKCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9CgoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwoKLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwovKioqKioqLyB9KQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAoWwovKiAwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsKCglleHBvcnRzLmRlZmF1bHQgPSBhY3RpdmF0ZTsKCgl2YXIgX3NsYWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTsKCgl2YXIgX3NsYWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NsYWNrKTsKCgl2YXIgX1N5bmNoZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3Nik7CgoJdmFyIF9JZGVudGl0eUZhY3RvcnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3Nyk7CgoJdmFyIF9JZGVudGl0eUZhY3RvcnkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfSWRlbnRpdHlGYWN0b3J5KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKCXZhciBTbGFja1Byb3RvU3R1YiA9IGZ1bmN0aW9uICgpIHsKCSAgZnVuY3Rpb24gU2xhY2tQcm90b1N0dWIocnVudGltZVByb3RvU3R1YlVSTCwgYnVzLCBjb25maWcpIHsKCSAgICB2YXIgX3RoaXMyID0gdGhpczsKCgkgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNsYWNrUHJvdG9TdHViKTsKCgkgICAgaWYgKCFydW50aW1lUHJvdG9TdHViVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBydW50aW1lUHJvdG9TdHViVVJMIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoJICAgIGlmICghYnVzKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBidXMgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CgkgICAgaWYgKCFjb25maWcpIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZyBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCgkgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gQ29uc3RydWN0b3IgTG9hZGVkJyk7CgoJICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgIHRoaXMuX3N1YnNjcmliZWRMaXN0ID0gW107CgkgICAgdGhpcy5fbWVzc2FnZUhpc3RvcnlDb250cm9sID0ge307CgkgICAgdGhpcy5fdXNlcnNMaXN0ID0gW107CgkgICAgdGhpcy5fZ3JvdXBzTGlzdCA9IFtdOwoJICAgIHRoaXMuX2NoYW5uZWxzTGlzdCA9IFtdOwoJICAgIHRoaXMuX2ltc0xpc3QgPSBbXTsKCSAgICB0aGlzLl9vYnNlcnZlcjsKCSAgICB0aGlzLl9jaGFubmVsSUQgPSAnJzsKCSAgICB0aGlzLl9pZCA9IDA7CgkgICAgdGhpcy5fY29udGludW91c09wZW4gPSB0cnVlOwoJICAgIHRoaXMuX3Rva2VuID0gJyc7CgoJICAgIHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgPSBydW50aW1lUHJvdG9TdHViVVJMOwoJICAgIHRoaXMuX2J1cyA9IGJ1czsKCSAgICB0aGlzLl9jb25maWcgPSBjb25maWc7CgoJICAgIHRoaXMuX3J1bnRpbWVTZXNzaW9uVVJMID0gY29uZmlnLnJ1bnRpbWVVUkw7CgkgICAgdGhpcy5fcmVPcGVuID0gZmFsc2U7CgkgICAgdGhpcy5fc2xhY2sgPSBfc2xhY2syLmRlZmF1bHQ7CgkgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gaW5zdGFudGlhdGUgc3luY2hlciB3aXRoIHJ1bnRpbWVVcmwnLCBydW50aW1lUHJvdG9TdHViVVJMKTsKCSAgICB0aGlzLl9zeW5jaGVyID0gbmV3IF9TeW5jaGVyLlN5bmNoZXIocnVudGltZVByb3RvU3R1YlVSTCwgYnVzLCBjb25maWcpOwoKCSAgICB0aGlzLl9zeW5jaGVyLm9uTm90aWZpY2F0aW9uKGZ1bmN0aW9uIChldmVudCkgewoJICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gT24gU3luY2hlciBOb3RpZmljYXRpb24nLCBldmVudCk7CgkgICAgfSk7CgoJICAgIGJ1cy5hZGRMaXN0ZW5lcignKicsIGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIG5ldyBtc2cnLCBtc2cpOwoJICAgICAgaWYgKG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdpZGVudGl0eScpICYmIG1zZy5ib2R5LmlkZW50aXR5Lmhhc093blByb3BlcnR5KCdhY2Nlc3NfdG9rZW4nKSAmJiBtc2cuYm9keS5pZGVudGl0eS5hY2Nlc3NfdG9rZW4pIHsKCgkgICAgICAgIHZhciB0b2tlbiA9IG1zZy5ib2R5LmlkZW50aXR5LmFjY2Vzc190b2tlbjsKCSAgICAgICAgX3RoaXMyLl90b2tlbiA9IHRva2VuOwoKCSAgICAgICAgX3RoaXMuX29wZW4odG9rZW4sIGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICBpZiAoX3RoaXMuX2ZpbHRlcihtc2cpKSB7CgoJICAgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gQWZ0ZXIgRmlsdGVyJywgbXNnKTsKCgkgICAgICAgICAgICB2YXIgc2NoZW1hVXJsID0gbXNnLmJvZHkuc2NoZW1hOwoJICAgICAgICAgICAgaWYgKHNjaGVtYVVybCAmJiBtc2cuYm9keS52YWx1ZS5uYW1lKSB7CgoJICAgICAgICAgICAgICB2YXIgc2NoZW1hU3BsaXR0ZWQgPSBzY2hlbWFVcmwuc3BsaXQoJy8nKTsKCgkgICAgICAgICAgICAgIGlmIChzY2hlbWFTcGxpdHRlZFtzY2hlbWFTcGxpdHRlZC5sZW5ndGggLSAxXSA9PT0gJ0NvbW11bmljYXRpb24nKSB7CgoJICAgICAgICAgICAgICAgIF90aGlzLl9nZXRTbGFja0luZm9ybWF0aW9uKG1zZy50bykudGhlbihmdW5jdGlvbiAodXNlckluZm8pIHsKCgkgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2xhY2sgVXNlciBpbmZvcm1hdGlvbjogJywgdXNlckluZm8pOwoKCSAgICAgICAgICAgICAgICAgIC8vIHVzZXJuYW1lLCB1c2VyVVJMLCBhdmF0YXIsIGNuLCBsb2NhbGUsIGlkcCwgYXNzZXJ0aW9uCgkgICAgICAgICAgICAgICAgICB2YXIgaWRlbnRpdHkgPSBuZXcgX0lkZW50aXR5RmFjdG9yeTIuZGVmYXVsdCh1c2VySW5mby5uYW1lLCAnc2xhY2s6Ly9zbGFjay5jb20vJyArIHVzZXJJbmZvLm5hbWUgKyAnQHNsYWNrLmNvbScsIHVzZXJJbmZvLnByb2ZpbGUuaW1hZ2VfMTkyLCB1c2VySW5mby5uYW1lLCAnJywgJ3NsYWNrLmNvbScpOwoKCSAgICAgICAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb25VcmwgPSBtc2cuZnJvbTsKCgkgICAgICAgICAgICAgICAgICAvLyBmb3Igc2Vzc2lvbiByZXN1bWUKCSAgICAgICAgICAgICAgICAgIGlmIChtc2cuYm9keS5yZXNvdXJjZSkgewoJICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25VcmwgPSBtc2cuYm9keS5yZXNvdXJjZSArICcvc3Vic2NyaXB0aW9uJzsKCSAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBzdWJzY3JpYmluZyBvYmplY3QnLCBzdWJzY3JpcHRpb25VcmwpOwoKCSAgICAgICAgICAgICAgICAgIF90aGlzLl9zdWJzY3JpYmUoc2NoZW1hVXJsLCBzdWJzY3JpcHRpb25VcmwsIGlkZW50aXR5KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkgewoJICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIHN1YnNjcmliZSByZXN1bHQnLCByZXN1bHQpOwoKCSAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fdG9rZW4gPSB0b2tlbjsKCgkgICAgICAgICAgICAgICAgICAgICAgaWYgKG1zZy5ib2R5LmlkZW50aXR5LnVzZXJQcm9maWxlLmlkKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5faWQgPSBtc2cuYm9keS5pZGVudGl0eS51c2VyUHJvZmlsZS5pZDsKCSAgICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9jcmVhdGVDaGFubmVsKG1zZywgdXNlckluZm8uaWQpOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICB9KTsKCSAgICAgICAgICAgICAgICB9KTsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0KCSAgICAgICAgfSk7CgkgICAgICB9CgkgICAgfSk7CgoJICAgIF90aGlzLl9zZW5kU3RhdHVzKCdjcmVhdGVkJyk7CgkgIH0KCgkgIF9jcmVhdGVDbGFzcyhTbGFja1Byb3RvU3R1YiwgW3sKCSAgICBrZXk6ICdfZ2V0U2xhY2tJbmZvcm1hdGlvbicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRTbGFja0luZm9ybWF0aW9uKHRvKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgoJICAgICAgICB2YXIgVVJMVXNlcnNMaXN0ID0gJ2h0dHBzOi8vc2xhY2suY29tL2FwaS91c2Vycy5saXN0P3Rva2VuPScgKyBfdGhpcy5fdG9rZW47CgkgICAgICAgIHZhciBVUkxHcm91cHNMaXN0ID0gJ2h0dHBzOi8vc2xhY2suY29tL2FwaS9ncm91cHMubGlzdD90b2tlbj0nICsgX3RoaXMuX3Rva2VuOwoJICAgICAgICB2YXIgVVJMQ2hhbm5lbHNMaXN0ID0gJ2h0dHBzOi8vc2xhY2suY29tL2FwaS9jaGFubmVscy5saXN0P3Rva2VuPScgKyBfdGhpcy5fdG9rZW47CgkgICAgICAgIHZhciBVUkxJbXNMaXN0ID0gJ2h0dHBzOi8vc2xhY2suY29tL2FwaS9pbS5saXN0P3Rva2VuPScgKyBfdGhpcy5fdG9rZW47CgoJICAgICAgICB2YXIgVXNlcnNMaXN0UHJvbWlzZSA9IF90aGlzLl9zZW5kSFRUUFJlcXVlc3QoJ0dFVCcsIFVSTFVzZXJzTGlzdCk7CgkgICAgICAgIHZhciBHcm91cHNMaXN0UHJvbWlzZSA9IF90aGlzLl9zZW5kSFRUUFJlcXVlc3QoJ0dFVCcsIFVSTEdyb3Vwc0xpc3QpOwoJICAgICAgICB2YXIgQ2hhbm5lbHNMaXN0UHJvbWlzZSA9IF90aGlzLl9zZW5kSFRUUFJlcXVlc3QoJ0dFVCcsIFVSTENoYW5uZWxzTGlzdCk7CgkgICAgICAgIHZhciBJbXNMaXN0UHJvbWlzZSA9IF90aGlzLl9zZW5kSFRUUFJlcXVlc3QoJ0dFVCcsIFVSTEltc0xpc3QpOwoKCSAgICAgICAgUHJvbWlzZS5hbGwoW1VzZXJzTGlzdFByb21pc2UsIEdyb3Vwc0xpc3RQcm9taXNlLCBDaGFubmVsc0xpc3RQcm9taXNlLCBJbXNMaXN0UHJvbWlzZV0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewoJICAgICAgICAgIF90aGlzLl91c2Vyc0xpc3QgPSByZXN1bHRbMF0ubWVtYmVyczsKCSAgICAgICAgICBfdGhpcy5fZ3JvdXBzTGlzdCA9IHJlc3VsdFsxXS5ncm91cHM7CgkgICAgICAgICAgX3RoaXMuX2NoYW5uZWxzTGlzdCA9IHJlc3VsdFsyXS5jaGFubmVsczsKCSAgICAgICAgICBfdGhpcy5faW1zTGlzdCA9IHJlc3VsdFszXS5pbXM7CgoJICAgICAgICAgIC8vZ2V0IHVzZXJJRCB0byBpbnZpdGUKCSAgICAgICAgICB2YXIgdG9TcGxpdHRlZCA9IHRvLnNwbGl0KCc6Ly8nKVsxXTsKCSAgICAgICAgICB2YXIgdXNlciA9IHRvU3BsaXR0ZWQuc3BsaXQoJ0AnKVswXTsKCSAgICAgICAgICB2YXIgdXNlckluZm8gPSBfdGhpcy5fdXNlcnNMaXN0LmZpbHRlcihmdW5jdGlvbiAodmFsdWUpIHsKCSAgICAgICAgICAgIHJldHVybiB2YWx1ZS5uYW1lID09PSB1c2VyOwoJICAgICAgICAgIH0pWzBdOwoKCSAgICAgICAgICByZXNvbHZlKHVzZXJJbmZvKTsKCSAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7CgkgICAgICAgICAgY29uc29sZS5lcnJvcignW1NsYWNrUHJvdG9zdHViXSAnLCBlcnJvcik7CgkgICAgICAgICAgcmVqZWN0KGVycm9yKTsKCSAgICAgICAgfSk7CgkgICAgICB9KTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfY3JlYXRlQ2hhbm5lbCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVDaGFubmVsKG1zZywgdXNlcklEKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoJICAgICAgdmFyIGNoYW5uZWxFeGlzdHMgPSBfdGhpcy5fY2hhbm5lbHNMaXN0LmZpbHRlcihmdW5jdGlvbiAodmFsdWUpIHsKCSAgICAgICAgcmV0dXJuIHZhbHVlLm5hbWUgPT09IG1zZy5ib2R5LnZhbHVlLm5hbWU7CgkgICAgICB9KVswXTsKCgkgICAgICAvLyBpZiBjaGFubmVsIGV4aXN0LCBpbnZpdGUgdXNlciwgZWxzZSBjaGFubmVsIG5lZWQgdG8gYmUgY3JlYXRlZCBhbmQgdGhlbiBpbnZpdGUgdXNlcgoJICAgICAgaWYgKGNoYW5uZWxFeGlzdHMpIHsKCSAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gY2hhbm5lbCBleGlzdCcsIGNoYW5uZWxFeGlzdHMpOwoKCSAgICAgICAgdmFyIGNoYW5uZWxNZW1iZXJzID0gX3RoaXMuX2NoYW5uZWxzTGlzdC5maWx0ZXIoZnVuY3Rpb24gKHZhbHVlKSB7CgkgICAgICAgICAgcmV0dXJuIHZhbHVlLm5hbWUgPT09IG1zZy5ib2R5LnZhbHVlLm5hbWU7CgkgICAgICAgIH0pWzBdLm1lbWJlcnM7CgkgICAgICAgIHZhciBhbHJlYWR5T25DaGFubmVsID0gZmFsc2U7CgoJICAgICAgICBjaGFubmVsTWVtYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChzKSB7CgkgICAgICAgICAgaWYgKHMgPT09IHVzZXJJRCkgewoJICAgICAgICAgICAgYWxyZWFkeU9uQ2hhbm5lbCA9IHRydWU7CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gY2hhbm5lbCBtZW1iZXJzJywgY2hhbm5lbE1lbWJlcnMsICcgICAtPicsIGFscmVhZHlPbkNoYW5uZWwpOwoKCSAgICAgICAgLy8gaWYgdXNlciBpc250IG9uIENoYW5uZWwgaW52aXRlLCBlbHNlIGp1c3Qgc2V0IGNoYW5uZWxJRAoJICAgICAgICBpZiAoIWFscmVhZHlPbkNoYW5uZWwpIHsKCSAgICAgICAgICBfdGhpcy5faW52aXRlKHVzZXJJRCwgY2hhbm5lbEV4aXN0cy5pZCk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgX3RoaXMuX2NoYW5uZWxJRCA9IGNoYW5uZWxFeGlzdHMuaWQ7CgkgICAgICAgIH0KCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIF90aGlzLl9jcmVhdGUobXNnLmJvZHkudmFsdWUubmFtZSwgdXNlcklEKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKCSAgICAgICAgICBpZiAocmVzdWx0KSB7CgkgICAgICAgICAgICBfdGhpcy5faW52aXRlKHVzZXJJRCk7CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgIH0KCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfZmlsdGVyJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbHRlcihtc2cpIHsKCSAgICAgIGlmIChtc2cuYm9keSAmJiBtc2cuYm9keS52aWEgPT09IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwpIHsKCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgfQoKCSAgICAgIHJldHVybiB0cnVlOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19vcGVuJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29wZW4odG9rZW4sIGNhbGxiYWNrKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGlmICghX3RoaXMuX3Nlc3Npb24pIHsKCSAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2luLXByb2dyZXNzJyk7CgkgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIG5ldyBTZXNzaW9uIGZvciB0b2tlbjonLCB0b2tlbik7CgkgICAgICAgIF90aGlzLl9zZXNzaW9uID0gX3RoaXMuX3NsYWNrLnJ0bS5jbGllbnQoKTsKCgkgICAgICAgIF90aGlzLl9zZXNzaW9uLmxpc3Rlbih7IHRva2VuOiB0b2tlbiB9KTsKCgkgICAgICAgIF90aGlzLl9zZXNzaW9uLm1lc3NhZ2UoZnVuY3Rpb24gKG1lc3NhZ2UpIHsKCSAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBuZXcgbWVzc2FnZSBvbiBzZXNzaW9uJywgbWVzc2FnZSk7CgkgICAgICAgICAgaWYgKG1lc3NhZ2UuY2hhbm5lbCkgewoJICAgICAgICAgICAgaWYgKG1lc3NhZ2UuY2hhbm5lbCA9PT0gX3RoaXMuX2NoYW5uZWxJRCAmJiBtZXNzYWdlLnVzZXIgIT09IF90aGlzLl9pZCB8fCAhbWVzc2FnZS5oYXNPd25Qcm9wZXJ0eSgnYm90X2lkJykgJiYgbWVzc2FnZS51c2VyID09PSBfdGhpcy5faWQgJiYgbWVzc2FnZS5jaGFubmVsID09PSBfdGhpcy5fY2hhbm5lbElEKSB7CgoJICAgICAgICAgICAgICBfdGhpcy5fZ2V0VXNlckluZm8obWVzc2FnZS51c2VyKS50aGVuKGZ1bmN0aW9uIChpZGVudGl0eSkgewoJICAgICAgICAgICAgICAgIF90aGlzLl9vYnNlcnZlci5hZGRDaGlsZCgnY2hhdG1lc3NhZ2VzJywgeyBtZXNzYWdlOiBtZXNzYWdlLnRleHQgfSwgaWRlbnRpdHkpOwoJICAgICAgICAgICAgICB9KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygnbGl2ZScpOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gc2Vzc2lvbiBhbHJlYWR5IGV4aXN0Jyk7CgkgICAgICB9CgkgICAgICBjYWxsYmFjaygpOwoJICAgIH0KCgkgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCgkgICAgKiBJdCByZXRyaWV2ZXMgaW5mb3JtYXRpb24gZnJvbSBhIHNsYWNrIHVzZXIgYW5kIGNyZWF0ZXMgYSByZVRISU5LIElkZW50aXR5IG9iamVjdCB3aXRoIGl0CgkgICAgKiBAcGFyYW0ge3N0cmluZ30gdXNlciAtIHNsYWNrIHVzZXIgaWQKCSAgICAqIEByZXR1cm4ge1Byb21pc2U8T2JqZWN0Pn0gUmV0dXJucyBhIHByb21pc2Ugd2l0aCBhbiBJZGVudGl0eSBvYmplY3QgcmVzb2x2ZWQKCSAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKCSAgfSwgewoJICAgIGtleTogJ19nZXRVc2VySW5mbycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRVc2VySW5mbyh1c2VyKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewoJICAgICAgICBfdGhpcy5fc2xhY2sudXNlcnMuaW5mbyh7IHRva2VuOiBfdGhpcy5fdG9rZW4sIHVzZXI6IHVzZXIgfSwgZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJICAgICAgICAgIGlmIChlcnIpIHsKCSAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTbGFja1Byb3Rvc3R1Yl0gZXJyb3InLCBlcnIpOwoJICAgICAgICAgIH0gZWxzZSB7CgoJICAgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1YiBnZXRVc2VySW5mb10gJywgZGF0YSk7CgkgICAgICAgICAgICB2YXIgaWRlbnRpdHkgPSBuZXcgX0lkZW50aXR5RmFjdG9yeTIuZGVmYXVsdChkYXRhLnVzZXIubmFtZSwgJ3NsYWNrOi8vc2xhY2suY29tLycgKyBkYXRhLnVzZXIubmFtZSArICdAc2xhY2suY29tJywgZGF0YS51c2VyLnByb2ZpbGUuaW1hZ2VfMTkyLCBkYXRhLnVzZXIubmFtZSwgJycsICdzbGFjay5jb20nKTsKCgkgICAgICAgICAgICByZXNvbHZlKGlkZW50aXR5KTsKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3N1YnNjcmliZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9zdWJzY3JpYmUoc2NoZW1hLCB1cmxEYXRhT2JqLCBpZGVudGl0eSkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKCSAgICAgICAgdmFyIGlzU3Vic2NyaWJlZCA9IGZhbHNlOwoJICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBJZGVudGl0eSBTdWJzY3JpYmUgLT4nLCBpZGVudGl0eSk7CgkgICAgICAgIF90aGlzLl9zdWJzY3JpYmVkTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHsKCSAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBTdWJzY3JpcHRpb24gTGlzdCAtPicsIG9iaik7CgkgICAgICAgICAgaWYgKG9iai51cmxEYXRhT2JqID09PSB1cmxEYXRhT2JqICYmIG9iai5zdWJzY3JpYmVkICYmIG9iai5pZGVudGl0eS51c2VyUHJvZmlsZS51c2VyVVJMID09PSBpZGVudGl0eS51c2VyUHJvZmlsZS51c2VyVVJMKSB7CgkgICAgICAgICAgICBpc1N1YnNjcmliZWQgPSB0cnVlOwoJICAgICAgICAgIH0KCSAgICAgICAgfSk7CgoJICAgICAgICBpZiAoaXNTdWJzY3JpYmVkKSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gQWxyZWFkeSBTdWJzY3JpYmVkJyk7CgkgICAgICAgICAgcmV0dXJuIHJlc29sdmUodHJ1ZSk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHsgdXJsRGF0YU9iajogdXJsRGF0YU9iaiwgc2NoZW1hOiBzY2hlbWEsIHN1YnNjcmliZWQ6IHRydWUsIGlkZW50aXR5OiBpZGVudGl0eSB9OwoKCSAgICAgICAgdmFyIG9iamVjdERlc2NVUkwgPSBzY2hlbWE7CgkgICAgICAgIHZhciBkYXRhT2JqZWN0VXJsID0gdXJsRGF0YU9iai5zdWJzdHJpbmcoMCwgdXJsRGF0YU9iai5sYXN0SW5kZXhPZignLycpKTsKCgkgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIG5ldyBzdWJzY3JpcHRpb24gZm9yIHNjaGVtYTonLCBvYmplY3REZXNjVVJMLCAnIGFuZCBkYXRhT2JqZWN0OicsIGRhdGFPYmplY3RVcmwpOwoKCSAgICAgICAgcmV0dXJuIF90aGlzLl9zeW5jaGVyLnN1YnNjcmliZShvYmplY3REZXNjVVJMLCBkYXRhT2JqZWN0VXJsLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBpZGVudGl0eSkudGhlbihmdW5jdGlvbiAob2JzZXJ2ZXIpIHsKCSAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXIgPSBvYnNlcnZlcjsKCSAgICAgICAgICBfdGhpcy5fc3Vic2NyaWJlZExpc3QucHVzaChzdWJzY3JpcHRpb24pOwoJICAgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIHN1YnNjcmliZWQnLCBkYXRhT2JqZWN0VXJsKTsKCSAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBPYnNlcnZlcicsIG9ic2VydmVyKTsKCSAgICAgICAgICBvYnNlcnZlci5vbkFkZENoaWxkKGZ1bmN0aW9uIChjaGlsZCkgewoJICAgICAgICAgICAgY29uc29sZS5pbmZvKCdbU2xhY2tQcm90b3N0dWJdIE9ic2VydmVyIC0gQWRkIENoaWxkOiAnLCBjaGlsZCk7CgoJICAgICAgICAgICAgLy9jaGVjayBpZiBmb3IgZWFjaCBjaGlsZCBtZXNzYWdlIGhhcyBiZWVuIGRlbGl2ZXJlZCwgYW5kIGNvbnRyb2wgdGhhdCBmb3Igd2hlbiB3ZSBoYXZlIG1vcmUgdGhhbiBvbmUgc2xhY2sgdXNlciBzdWJzY3JpYmVkCgkgICAgICAgICAgICB2YXIgY3VycmVudElEID0gY2hpbGQuY2hpbGRJZC5zcGxpdCgnIycpWzFdOwoJICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBjaGlsZCBhbHJlYWR5IHNlbnQgbWVzc2FnZXMKCSAgICAgICAgICAgIGlmIChfdGhpcy5fbWVzc2FnZUhpc3RvcnlDb250cm9sLmhhc093blByb3BlcnR5KGNoaWxkLmZyb20pKSB7CgkgICAgICAgICAgICAgIC8vIGluIHRoYXQgY2FzZSBjaGVjayBpZiB0aGUgY3VycmVudElEIGl0cyBlcXVhbCB0byBvbGRJRAoJICAgICAgICAgICAgICB2YXIgb2xkSUQgPSBfdGhpcy5fbWVzc2FnZUhpc3RvcnlDb250cm9sW2NoaWxkLmZyb21dLmlkOwoJICAgICAgICAgICAgICBpZiAoX3RoaXMuX21lc3NhZ2VIaXN0b3J5Q29udHJvbFtjaGlsZC5mcm9tXS5pZCAhPT0gY3VycmVudElEKSB7CgkgICAgICAgICAgICAgICAgX3RoaXMuX21lc3NhZ2VIaXN0b3J5Q29udHJvbFtjaGlsZC5mcm9tXS5pZCA9IGN1cnJlbnRJRDsKCSAgICAgICAgICAgICAgICBfdGhpcy5fZGVsaXZlcihjaGlsZCk7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgIF90aGlzLl9tZXNzYWdlSGlzdG9yeUNvbnRyb2xbY2hpbGQuZnJvbV0gPSB7IGlkOiBjdXJyZW50SUQgfTsKCSAgICAgICAgICAgICAgX3RoaXMuX2RlbGl2ZXIoY2hpbGQpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0pOwoKCSAgICAgICAgICBvYnNlcnZlci5vbkNoYW5nZSgnKicsIGZ1bmN0aW9uIChldmVudCkgewoJICAgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gT2JzZXJ2ZXIgLSBvbkNoYW5nZTogJywgZXZlbnQpOwoJICAgICAgICAgIH0pOwoJICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CgkgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewoJICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTbGFja1Byb3Rvc3R1Yl0gU3Vic2NyaWJlJywgZXJyb3IpOwoJICAgICAgICAgIHJlc29sdmUoZmFsc2UpOwoJICAgICAgICB9KTsKCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19pbnZpdGUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfaW52aXRlKGlkVXNlciwgaWRDaGFubmVsKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGlmICghaWRDaGFubmVsKSB7CgkgICAgICAgIGlkQ2hhbm5lbCA9IF90aGlzLl9jaGFubmVsSUQ7CgkgICAgICB9CgoJICAgICAgdmFyIHRvSW52aXRlID0geyB0b2tlbjogX3RoaXMuX3Rva2VuLCBjaGFubmVsOiBpZENoYW5uZWwsIHVzZXI6IGlkVXNlciB9OwoKCSAgICAgIF90aGlzLl9zbGFjay5jaGFubmVscy5pbnZpdGUodG9JbnZpdGUsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKCSAgICAgICAgaWYgKGVycikgewoJICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTbGFja1Byb3Rvc3R1Yl0gZXJyb3InLCBlcnIpOwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgIF90aGlzLl9jaGFubmVsSUQgPSBpZENoYW5uZWw7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gdXNlciBpbnZpdGVkIHdpdGggc3VjZXNzJywgZGF0YSk7CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19kZWxpdmVyJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGl2ZXIoY2hpbGQpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgaWYgKF90aGlzLl9jaGFubmVsSUQgIT09ICcnICYmIGNoaWxkLnZhbHVlLm1lc3NhZ2UpIHsKCgkgICAgICAgIGlmIChjaGlsZC5oYXNPd25Qcm9wZXJ0eSgnaWRlbnRpdHknKSAmJiBjaGlsZC5pZGVudGl0eS5oYXNPd25Qcm9wZXJ0eSgndXNlclByb2ZpbGUnKSAmJiBjaGlsZC5pZGVudGl0eS51c2VyUHJvZmlsZS5oYXNPd25Qcm9wZXJ0eSgndXNlcm5hbWUnKSAmJiBjaGlsZC5pZGVudGl0eS51c2VyUHJvZmlsZS51c2VybmFtZSkgewoKCSAgICAgICAgICB2YXIgdGV4dCA9ICcnICsgY2hpbGQuaWRlbnRpdHkudXNlclByb2ZpbGUudXNlcm5hbWUgKyAnOiAnICsgY2hpbGQudmFsdWUubWVzc2FnZTsKCSAgICAgICAgICB2YXIgbWVzc2FnZSA9IHsgYXNfdXNlcjogdHJ1ZSwgdG9rZW46IF90aGlzLl90b2tlbiwgY2hhbm5lbDogX3RoaXMuX2NoYW5uZWxJRCwgdGV4dDogdGV4dCB9OwoJICAgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIChQb3N0TWVzc2FnZSBzbGFjayBhcGkpIHRva2VuKCcsIF90aGlzLl90b2tlbiwgJykgIGNoYW5uZWwoJywgX3RoaXMuX2NoYW5uZWxJRCwgJykgdGV4dCgnLCBjaGlsZC52YWx1ZS5tZXNzYWdlLCAnKScpOwoKCSAgICAgICAgICBfdGhpcy5fc2xhY2suY2hhdC5wb3N0TWVzc2FnZShtZXNzYWdlLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7CgkgICAgICAgICAgICBpZiAoZXJyKSB7CgkgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTbGFja1Byb3Rvc3R1Yl0gZXJyb3InLCBlcnIpOwoJICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gUG9zdE1lc3NhZ2Ugd2l0aCBTdWNlc3MnLCBkYXRhKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9KTsKCSAgICAgICAgfQoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19jcmVhdGUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfY3JlYXRlKGNoYW5uZWxOYW1lKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewoJICAgICAgICB2YXIgdG9DcmVhdGUgPSB7IHRva2VuOiBfdGhpcy5fdG9rZW4sIG5hbWU6IGNoYW5uZWxOYW1lIH07CgkgICAgICAgIF90aGlzLl9zbGFjay5jaGFubmVscy5jcmVhdGUodG9DcmVhdGUsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKCSAgICAgICAgICBpZiAoZXJyKSB7CgkgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbU2xhY2tQcm90b3N0dWJdICcsIGVycik7CgkgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIGlmIChkYXRhLm9rKSB7CgkgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIENoYW5uZWwgQ3JlYXRlZCB3aXRoIFN1Y2VzcyAnLCBkYXRhKTsKCSAgICAgICAgICAgICAgX3RoaXMuX2NoYW5uZWxJRCA9IGRhdGEuY2hhbm5lbC5pZDsKCSAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3NlbmRIVFRQUmVxdWVzdCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kSFRUUFJlcXVlc3QobWV0aG9kLCB1cmwpIHsKCSAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgkgICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKCSAgICAgICAgaWYgKCd3aXRoQ3JlZGVudGlhbHMnIGluIHhocikgewoJICAgICAgICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsLCB0cnVlKTsKCSAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgWERvbWFpblJlcXVlc3QgIT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgLy8gT3RoZXJ3aXNlLCBjaGVjayBpZiBYRG9tYWluUmVxdWVzdC4KCSAgICAgICAgICAvLyBYRG9tYWluUmVxdWVzdCBvbmx5IGV4aXN0cyBpbiBJRSwgYW5kIGlzIElFJ3Mgd2F5IG9mIG1ha2luZyBDT1JTIHJlcXVlc3RzLgoJICAgICAgICAgIHhociA9IG5ldyBYRG9tYWluUmVxdWVzdCgpOwoJICAgICAgICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsKTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAvLyBPdGhlcndpc2UsIENPUlMgaXMgbm90IHN1cHBvcnRlZCBieSB0aGUgYnJvd3Nlci4KCSAgICAgICAgICB4aHIgPSBudWxsOwoJICAgICAgICB9CgkgICAgICAgIGlmICh4aHIpIHsKCSAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7CgkgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHsKCSAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7CgkgICAgICAgICAgICAgICAgcmVzb2x2ZShpbmZvKTsKCSAgICAgICAgICAgICAgfSBlbHNlIGlmICh4aHIuc3RhdHVzID09PSA0MDApIHsKCSAgICAgICAgICAgICAgICByZWplY3QoJ1RoZXJlIHdhcyBhbiBlcnJvciBwcm9jZXNzaW5nIHRoZSB0b2tlbicpOwoJICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgIHJlamVjdCgnc29tZXRoaW5nIGVsc2Ugb3RoZXIgdGhhbiAyMDAgd2FzIHJldHVybmVkJyk7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9OwoJICAgICAgICAgIHhoci5zZW5kKCk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgcmVqZWN0KCdDT1JTIG5vdCBzdXBwb3J0ZWQnKTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3NlbmRTdGF0dXMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VuZFN0YXR1cyh2YWx1ZSwgcmVhc29uKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWIgc3RhdHVzIGNoYW5nZWRdIHRvICcsIHZhbHVlKTsKCgkgICAgICBfdGhpcy5fc3RhdGUgPSB2YWx1ZTsKCgkgICAgICB2YXIgbXNnID0gewoJICAgICAgICB0eXBlOiAndXBkYXRlJywKCSAgICAgICAgZnJvbTogX3RoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwsCgkgICAgICAgIHRvOiBfdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCArICcvc3RhdHVzJywKCSAgICAgICAgYm9keTogewoJICAgICAgICAgIHZhbHVlOiB2YWx1ZQoJICAgICAgICB9CgkgICAgICB9OwoKCSAgICAgIGlmIChyZWFzb24pIHsKCSAgICAgICAgbXNnLmJvZHkuZGVzYyA9IHJlYXNvbjsKCSAgICAgIH0KCgkgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1zZyk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnY29uZmlnJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9jb25maWc7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAncnVudGltZVNlc3Npb24nLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX3J1bnRpbWVTZXNzaW9uVVJMOwoJICAgIH0KCSAgfV0pOwoKCSAgcmV0dXJuIFNsYWNrUHJvdG9TdHViOwoJfSgpOwoKCWZ1bmN0aW9uIGFjdGl2YXRlKHVybCwgYnVzLCBjb25maWcpIHsKCSAgcmV0dXJuIHsKCSAgICBuYW1lOiAnU2xhY2tQcm90b1N0dWInLAoJICAgIGluc3RhbmNlOiBuZXcgU2xhY2tQcm90b1N0dWIodXJsLCBidXMsIGNvbmZpZykKCSAgfTsKCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9hcGkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpOwoKCXZhciBfYXBpMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2FwaSk7CgoJdmFyIF9hcGkzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF9hcGk0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXBpMyk7CgoJdmFyIF9ib3RzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTcpOwoKCXZhciBfYm90czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ib3RzKTsKCgl2YXIgX2F1dGggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgX2F1dGgyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXV0aCk7CgoJdmFyIF9jaGFubmVscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTU4KTsKCgl2YXIgX2NoYW5uZWxzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzKTsKCgl2YXIgX2NoYXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1OSk7CgoJdmFyIF9jaGF0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYXQpOwoKCXZhciBfZG5kID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNjApOwoKCXZhciBfZG5kMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RuZCk7CgoJdmFyIF9lbW9qaSA9IF9fd2VicGFja19yZXF1aXJlX18oNzcpOwoKCXZhciBfZW1vamkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZW1vamkpOwoKCXZhciBfZmlsZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2MSk7CgoJdmFyIF9maWxlczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlcyk7CgoJdmFyIF9ncm91cHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2Mik7CgoJdmFyIF9ncm91cHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzKTsKCgl2YXIgX2ltID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNjMpOwoKCXZhciBfaW0yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW0pOwoKCXZhciBfbXBpbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTY0KTsKCgl2YXIgX21waW0yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXBpbSk7CgoJdmFyIF9vYXV0aCA9IF9fd2VicGFja19yZXF1aXJlX18oMTY1KTsKCgl2YXIgX29hdXRoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX29hdXRoKTsKCgl2YXIgX3JlYWN0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oMTY2KTsKCgl2YXIgX3JlYWN0aW9uczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdGlvbnMpOwoKCXZhciBfcmVtaW5kZXJzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNjcpOwoKCXZhciBfcmVtaW5kZXJzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlbWluZGVycyk7CgoJdmFyIF9waW5zID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNjgpOwoKCXZhciBfcGluczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9waW5zKTsKCgl2YXIgX3J0bSA9IF9fd2VicGFja19yZXF1aXJlX18oMTY5KTsKCgl2YXIgX3J0bTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ydG0pOwoKCXZhciBfcnRtMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTI4KTsKCgl2YXIgX3J0bTQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ydG0zKTsKCgl2YXIgX3NlYXJjaCA9IF9fd2VicGFja19yZXF1aXJlX18oMTcxKTsKCgl2YXIgX3NlYXJjaDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZWFyY2gpOwoKCXZhciBfc3RhcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3Mik7CgoJdmFyIF9zdGFyczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdGFycyk7CgoJdmFyIF90ZWFtID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNzMpOwoKCXZhciBfdGVhbTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZWFtKTsKCgl2YXIgX3VzZXJncm91cHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3NCk7CgoJdmFyIF91c2VyZ3JvdXBzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJncm91cHMpOwoKCXZhciBfdXNlcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3NSk7CgoJdmFyIF91c2VyczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2Vycyk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgl2YXIgZGVzY3JpYmUgPSAnXG4gIHNsYWNrXG4gICAgYXBpLmNsaWVudCh0b2tlbilcbiAgICBhcGkudGVzdChwYXJhbXMsIChlcnIsIGRhdGEpPT4pXG4gICAgYXV0aC50ZXN0KHRva2VuLCAoZXJyLCBkYXRhKT0+KVxuICAgIGJvdHMuaW5mb1xuICAgIGNoYW5uZWxzLmFyY2hpdmUoe3Rva2VuLCBjaGFubmVsfSwgKGVyciwgZGF0YSk9PilcbiAgICBjaGFubmVscy5jcmVhdGUoe3Rva2VuLCBuYW1lfSwgKGVyciwgZGF0YSk9PilcbiAgICBjaGFubmVscy5oaXN0b3J5KHt0b2tlbiwgY2hhbm5lbH0sIChlcnIsIGRhdGEpPT4pXG4gICAgY2hhbm5lbHMuaW5mb1xuICAgIGNoYW5uZWxzLmludml0ZVxuICAgIGNoYW5uZWxzLmpvaW5cbiAgICBjaGFubmVscy5raWNrXG4gICAgY2hhbm5lbHMubGVhdmVcbiAgICBjaGFubmVscy5saXN0KHt0b2tlbiwgZXhjbHVkZV9hcmNoaXZlZH0sIChlcnIsIGRhdGEpPT4pXG4gICAgY2hhbm5lbHMubWFya1xuICAgIGNoYW5uZWxzLnJlbmFtZVxuICAgIGNoYW5uZWxzLnNldFB1cnBvc2VcbiAgICBjaGFubmVscy5zZXRUb3BpY1xuICAgIGNoYW5uZWxzLnVuYXJjaGl2ZVxuICAgIGNoYXQuZGVsZXRlXG4gICAgY2hhdC5wb3N0TWVzc2FnZSh7dG9rZW4sIHRleHQsIGNoYW5uZWx9LCAoZXJyLCBkYXRhKT0+KVxuICAgIGNoYXQudXBkYXRlXG4gICAgZW1vamkubGlzdFxuICAgIGZpbGVzLmRlbGV0ZVxuICAgIGZpbGVzLmluZm9cbiAgICBmaWxlcy5saXN0XG4gICAgZmlsZXMudXBsb2FkXG4gICAgZ3JvdXBzLmFyY2hpdmVcbiAgICBncm91cHMuY2xvc2VcbiAgICBncm91cHMuY3JlYXRlXG4gICAgZ3JvdXBzLmNyZWF0ZUNoaWxkXG4gICAgZ3JvdXBzLmhpc3RvcnlcbiAgICBncm91cHMuaW5mb1xuICAgIGdyb3Vwcy5pbnZpdGVcbiAgICBncm91cHMua2lja1xuICAgIGdyb3Vwcy5sZWF2ZVxuICAgIGdyb3Vwcy5saXN0XG4gICAgZ3JvdXBzLm1hcmtcbiAgICBncm91cHMub3BlblxuICAgIGdyb3Vwcy5yZW5hbWVcbiAgICBncm91cHMuc2V0UHVycG9zZVxuICAgIGdyb3Vwcy5zZXRUb3BpY1xuICAgIGdyb3Vwcy51bmFyY2hpdmVcbiAgICBpbS5jbG9zZVxuICAgIGltLmhpc3RvcnlcbiAgICBpbS5saXN0XG4gICAgaW0ubWFya1xuICAgIGltLm9wZW5cbiAgICBtcGltLmNsb3NlXG4gICAgbXBpbS5oaXN0b3J5XG4gICAgbXBpbS5saXN0XG4gICAgbXBpbS5tYXJrXG4gICAgbXBpbS5vcGVuXG4gICAgb2F1dGguYWNjZXNzKHtjbGllbnRfaWQsIGNsaWVudF9zZWNyZXQsIGNvZGV9LCAoZXJyLCBkYXRhKT0+KVxuICAgIHBpbnMuYWRkXG4gICAgcGlucy5saXN0XG4gICAgcGlucy5yZW1vdmVcbiAgICByZWFjdGlvbnMuYWRkXG4gICAgcmVhY3Rpb25zLmdldFxuICAgIHJlYWN0aW9ucy5saXN0XG4gICAgcmVhY3Rpb25zLnJlbW92ZVxuICAgIHJlbWluZGVycy5hZGRcbiAgICByZW1pbmRlcnMuY29tcGxldGVcbiAgICByZW1pbmRlcnMuZGVsZXRlXG4gICAgcmVtaW5kZXJzLmluZm9cbiAgICByZW1pbmRlcnMubGlzdFxuICAgIHJ0bS5jbGllbnQoKVxuICAgIHJ0bS5zdGFydCh7dG9rZW59LCAoZXJyLCBkYXRhKT0+KVxuICAgIHNlYXJjaC5hbGxcbiAgICBzZWFyY2guZmlsZXNcbiAgICBzZWFyY2gubWVzc2FnZXNcbiAgICBzdGFycy5hZGRcbiAgICBzdGFycy5saXN0XG4gICAgc3RhcnMucmVtb3ZlXG4gICAgdGVhbS5hY2NjZXNzTG9nc1xuICAgIHRlYW0uYmlsbGFibGVJbmZvXG4gICAgdGVhbS5pbmZvKHRva2VuLCAoZXJyLCBkYXRhKT0+KVxuICAgIHRlYW0uaW50ZWdyYXRpb25Mb2dzXG4gICAgdGVhbS5wcm9maWxlLmdldFxuICAgIHVzZXJncm91cHMuY3JlYXRlXG4gICAgdXNlcmdyb3Vwcy5kaXNhYmxlXG4gICAgdXNlcmdyb3Vwcy5lbmFibGVcbiAgICB1c2VyZ3JvdXBzLmxpc3RcbiAgICB1c2VyZ3JvdXBzLnVwZGF0ZVxuICAgIHVzZXJncm91cHMudXNlcnMubGlzdFxuICAgIHVzZXJncm91cHMudXNlcnMudXBkYXRlXG4gICAgdXNlcnMuZ2V0UHJlc2VuY2VcbiAgICB1c2Vycy5pZGVudGl0eVxuICAgIHVzZXJzLmluZm9cbiAgICB1c2Vycy5saXN0KHRva2VuLCAoZXJyLCBkYXRhKT0+KVxuICAgIHVzZXJzLnNldEFjdGl2ZVxuICAgIHVzZXJzLnNldFByZXNlbmNlXG4nOwoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgZGVzY3JpYmU6IGRlc2NyaWJlLAoJICBhcGk6IHsgdGVzdDogX2FwaTIuZGVmYXVsdCwgY2xpZW50OiBfYXBpNC5kZWZhdWx0IH0sCgkgIGF1dGg6IHsgdGVzdDogX2F1dGgyLmRlZmF1bHQgfSwKCSAgYm90czogX2JvdHMyLmRlZmF1bHQsCgkgIGNoYW5uZWxzOiBfY2hhbm5lbHMyLmRlZmF1bHQsCgkgIGNoYXQ6IF9jaGF0Mi5kZWZhdWx0LAoJICBkbmQ6IF9kbmQyLmRlZmF1bHQsCgkgIGVtb2ppOiB7IGxpc3Q6IF9lbW9qaTIuZGVmYXVsdCB9LAoJICBmaWxlczogX2ZpbGVzMi5kZWZhdWx0LAoJICBncm91cHM6IF9ncm91cHMyLmRlZmF1bHQsCgkgIGltOiBfaW0yLmRlZmF1bHQsCgkgIG1waW06IF9tcGltMi5kZWZhdWx0LAoJICBvYXV0aDogeyBhY2Nlc3M6IF9vYXV0aDIuZGVmYXVsdCB9LAoJICByZWFjdGlvbnM6IF9yZWFjdGlvbnMyLmRlZmF1bHQsCgkgIHJlbWluZGVyczogX3JlbWluZGVyczIuZGVmYXVsdCwKCSAgcGluczogX3BpbnMyLmRlZmF1bHQsCgkgIHJ0bTogeyBjbGllbnQ6IF9ydG0yLmRlZmF1bHQsIHN0YXJ0OiBfcnRtNC5kZWZhdWx0IH0sCgkgIHNlYXJjaDogX3NlYXJjaDIuZGVmYXVsdCwKCSAgc3RhcnM6IF9zdGFyczIuZGVmYXVsdCwKCSAgdGVhbTogX3RlYW0yLmRlZmF1bHQsCgkgIHVzZXJncm91cHM6IF91c2VyZ3JvdXBzMi5kZWZhdWx0LAoJICB1c2VyczogX3VzZXJzMi5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGFwaXRlc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGFwaXRlc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnYXBpLnRlc3QnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07CgoJZXhwb3J0cy5kZWZhdWx0ID0gZXhlYzsKCgl2YXIgX3RpbnlKc29uSHR0cCA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7CgoJdmFyIF90aW55SnNvbkh0dHAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGlueUpzb25IdHRwKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWZ1bmN0aW9uIGV4ZWModXJsLCBmb3JtLCBjYWxsYmFjaykgewoKCSAgLy8gc3RyaW5naWZ5IGFueSBvYmplY3RzIHVuZGVyIGtleXMgc2luY2UgZm9ybSBpcyBwb3N0ZWQgYXMgYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkCgkgIE9iamVjdC5rZXlzKGZvcm0pLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewoJICAgIGlmIChfdHlwZW9mKGZvcm1ba2V5XSkgPT09ICdvYmplY3QnKSB7CgkgICAgICBmb3JtW2tleV0gPSBKU09OLnN0cmluZ2lmeShmb3JtW2tleV0pOwoJICAgIH0KCSAgfSk7CgoJICAvLyBhbHdheXMgcG9zdAoJICBfdGlueUpzb25IdHRwMi5kZWZhdWx0LnBvc3QoewoJICAgIHVybDogJ2h0dHBzOi8vc2xhY2suY29tL2FwaS8nICsgdXJsLAoJICAgIGhlYWRlcnM6IHsKCSAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJwoJICAgIH0sCgkgICAgZGF0YTogZm9ybQoJICB9LCBmdW5jdGlvbiBfcmVzKGVyciwgcmVzKSB7CgkgICAgLy8gdmFyIHJhdGVMaW1pdCA9ICdZb3UgYXJlIHNlbmRpbmcgdG9vIG1hbnkgcmVxdWVzdHMuIFBsZWFzZSByZWxheC4nCgkgICAgaWYgKGVycikgewoJICAgICAgLy8gaWYgcmVxdWVzdCBmYWlsZWQgYnViYmxlIHRoZSBlcnJvcgoJICAgICAgY2FsbGJhY2soZXJyKTsKCSAgICB9IGVsc2UgaWYgKHJlcy5ib2R5ICYmIHJlcy5ib2R5LmVycm9yKSB7CgkgICAgICBjYWxsYmFjayhFcnJvcihyZXMuYm9keS5lcnJvcikpOwoJICAgIH0gZWxzZSB7CgkgICAgICBjYWxsYmFjayhudWxsLCByZXMuYm9keSk7CgkgICAgfQoJICB9KTsKCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogNCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgX3JlYWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCgl2YXIgX3dyaXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NikKCgltb2R1bGUuZXhwb3J0cyA9IHsKCSAgZ2V0OiBfcmVhZCwKCSAgcG9zdDogX3dyaXRlLmJpbmQoe30sICdQT1NUJyksCgkgIHB1dDogX3dyaXRlLmJpbmQoe30sICdQVVQnKSwKCSAgZGVsOiBfd3JpdGUuYmluZCh7fSwgJ0RFTEVURScpLAoJfQoKCi8qKiovIH0sCi8qIDUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKEJ1ZmZlcikge3ZhciBodHRwID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCkKCXZhciBodHRwcyA9IF9fd2VicGFja19yZXF1aXJlX18oNDUpCgl2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXygzOCkKCXZhciBxcyA9IF9fd2VicGFja19yZXF1aXJlX18oNDIpCgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBfcmVhZChvcHRpb25zLCBjYWxsYmFjaykgewoKCSAgLy8gcmVxdWlyZSBvcHRpb25zLnVybCBvciBmYWlsIG5vaXNpbHkgCgkgIGlmICghb3B0aW9ucy51cmwpIHsKCSAgICB0aHJvdyBFcnJvcignb3B0aW9ucy51cmwgcmVxdWlyZWQnKQoJICB9CgoJICAvLyBwYXJzZSBvdXQgdGhlIG9wdGlvbnMgZnJvbSBvcHRpb25zLnVybAoJICB2YXIgb3B0cyA9IHVybC5wYXJzZShvcHRpb25zLnVybCkKCgkgIC8vIGNoZWNrIGZvciBhZGRpdGlvbmFsIHF1ZXJ5IHBhcmFtcwoJICBpZiAob3B0aW9ucy5kYXRhKSB7CgkgICAgdmFyIGlzU2VhcmNoID0gISFvcHRzLnNlYXJjaAoJICAgIG9wdGlvbnMudXJsICs9IChpc1NlYXJjaD8gJyYnIDogJz8nKSArIHFzLnN0cmluZ2lmeShvcHRpb25zLmRhdGEpCgkgICAgb3B0cyA9IHVybC5wYXJzZShvcHRpb25zLnVybCkKCSAgfQoKCSAgdmFyIG1ldGhvZCA9IG9wdHMucHJvdG9jb2wgPT09ICdodHRwczonPyBodHRwcy5nZXQgOiBodHRwLmdldAoKCSAgb3B0cy5yZWplY3RVbmF1dGhvcml6ZWQgPSBmYWxzZQoJICBvcHRzLmFnZW50ID0gZmFsc2UKCSAgb3B0cy5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzIHx8IHt9CgkgIG9wdHMuaGVhZGVyc1snVXNlci1BZ2VudCddID0gb3B0cy5oZWFkZXJzWydVc2VyLUFnZW50J10gfHwgJ3RpbnktaHR0cCcKCSAgb3B0cy5oZWFkZXJzWydDb250ZW50LVR5cGUnXSA9IG9wdHMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gfHwgJ2FwcGxpY2F0aW9uL2pzb24nCgkgIAoJICAvLyBtYWtlIGEgcmVxdWVzdAoJICB2YXIgcmVxID0gbWV0aG9kKG9wdHMsIGZ1bmN0aW9uIF9fcmVzKHJlcykgewoJICAgCgkgICAgdmFyIHJhdyA9IFtdCgoJICAgIHZhciBvayA9IHJlcy5zdGF0dXNDb2RlID49IDIwMCAmJiByZXMuc3RhdHVzQ29kZSA8IDMwMAoJICAgIGlmICghb2spIHsKCSAgICAgIGNhbGxiYWNrKEVycm9yKCdHRVQgZmFpbGVkIHdpdGg6ICcgKyByZXMuc3RhdHVzQ29kZSkpCgkgICAgICByZXMucmVzdW1lKCkKCSAgICAgIHJldHVybgoJICAgIH0KCSAKCSAgICByZXMub24oJ2RhdGEnLCBmdW5jdGlvbiBfX2RhdGEoY2h1bmspIHsKCSAgICAgIHJhdy5wdXNoKGNodW5rKQoJICAgIH0pCgoJICAgIHJlcy5vbignZW5kJywgZnVuY3Rpb24gX19lbmQoKSB7CgkgICAgICB2YXIgZXJyID0gbnVsbAoJICAgICAgdmFyIHJlc3VsdCA9IG51bGwKCSAgICAgIHRyeSB7CgkgICAgICAgIHZhciBpc0pTT04gPSByZXMuaGVhZGVyc1snY29udGVudC10eXBlJ10uc3RhcnRzV2l0aCgnYXBwbGljYXRpb24vanNvbicpCgkgICAgICAgIHZhciByYXdEYXRhID0gQnVmZmVyLmNvbmNhdChyYXcpLnRvU3RyaW5nKCkKCSAgICAgICAgcmVzdWx0ID0gaXNKU09OPyBKU09OLnBhcnNlKHJhd0RhdGEpIDogcmF3RGF0YQoJICAgICAgfSAKCSAgICAgIGNhdGNoIChlKSB7CgkgICAgICAgIGVyciA9IGUKCSAgICAgIH0KCSAgICAgIGNhbGxiYWNrKGVyciwge2JvZHk6cmVzdWx0LCBoZWFkZXJzOnJlcy5oZWFkZXJzfSkKCSAgICB9KQoJICB9KQoJICAKCSAgcmVxLm9uKCdlcnJvcicsIGNhbGxiYWNrKQoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpLkJ1ZmZlcikpCgovKioqLyB9LAovKiA2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHsvKiEKCSAqIFRoZSBidWZmZXIgbW9kdWxlIGZyb20gbm9kZS5qcywgZm9yIHRoZSBicm93c2VyLgoJICoKCSAqIEBhdXRob3IgICBGZXJvc3MgQWJvdWtoYWRpamVoIDxmZXJvc3NAZmVyb3NzLm9yZz4gPGh0dHA6Ly9mZXJvc3Mub3JnPgoJICogQGxpY2Vuc2UgIE1JVAoJICovCgkvKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqLwoKCSd1c2Ugc3RyaWN0JwoKCXZhciBiYXNlNjQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCgl2YXIgaWVlZTc1NCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKCXZhciBpc0FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KQoKCWV4cG9ydHMuQnVmZmVyID0gQnVmZmVyCglleHBvcnRzLlNsb3dCdWZmZXIgPSBTbG93QnVmZmVyCglleHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTID0gNTAKCgkvKioKCSAqIElmIGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGA6CgkgKiAgID09PSB0cnVlICAgIFVzZSBVaW50OEFycmF5IGltcGxlbWVudGF0aW9uIChmYXN0ZXN0KQoJICogICA9PT0gZmFsc2UgICBVc2UgT2JqZWN0IGltcGxlbWVudGF0aW9uIChtb3N0IGNvbXBhdGlibGUsIGV2ZW4gSUU2KQoJICoKCSAqIEJyb3dzZXJzIHRoYXQgc3VwcG9ydCB0eXBlZCBhcnJheXMgYXJlIElFIDEwKywgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBTYWZhcmkgNS4xKywKCSAqIE9wZXJhIDExLjYrLCBpT1MgNC4yKy4KCSAqCgkgKiBEdWUgdG8gdmFyaW91cyBicm93c2VyIGJ1Z3MsIHNvbWV0aW1lcyB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uIHdpbGwgYmUgdXNlZCBldmVuCgkgKiB3aGVuIHRoZSBicm93c2VyIHN1cHBvcnRzIHR5cGVkIGFycmF5cy4KCSAqCgkgKiBOb3RlOgoJICoKCSAqICAgLSBGaXJlZm94IDQtMjkgbGFja3Mgc3VwcG9ydCBmb3IgYWRkaW5nIG5ldyBwcm9wZXJ0aWVzIHRvIGBVaW50OEFycmF5YCBpbnN0YW5jZXMsCgkgKiAgICAgU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02OTU0MzguCgkgKgoJICogICAtIENocm9tZSA5LTEwIGlzIG1pc3NpbmcgdGhlIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24uCgkgKgoJICogICAtIElFMTAgaGFzIGEgYnJva2VuIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhcnJheXMgb2YKCSAqICAgICBpbmNvcnJlY3QgbGVuZ3RoIGluIHNvbWUgc2l0dWF0aW9ucy4KCgkgKiBXZSBkZXRlY3QgdGhlc2UgYnVnZ3kgYnJvd3NlcnMgYW5kIHNldCBgQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRgIHRvIGBmYWxzZWAgc28gdGhleQoJICogZ2V0IHRoZSBPYmplY3QgaW1wbGVtZW50YXRpb24sIHdoaWNoIGlzIHNsb3dlciBidXQgYmVoYXZlcyBjb3JyZWN0bHkuCgkgKi8KCUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUID0gZ2xvYmFsLlRZUEVEX0FSUkFZX1NVUFBPUlQgIT09IHVuZGVmaW5lZAoJICA/IGdsb2JhbC5UWVBFRF9BUlJBWV9TVVBQT1JUCgkgIDogdHlwZWRBcnJheVN1cHBvcnQoKQoKCS8qCgkgKiBFeHBvcnQga01heExlbmd0aCBhZnRlciB0eXBlZCBhcnJheSBzdXBwb3J0IGlzIGRldGVybWluZWQuCgkgKi8KCWV4cG9ydHMua01heExlbmd0aCA9IGtNYXhMZW5ndGgoKQoKCWZ1bmN0aW9uIHR5cGVkQXJyYXlTdXBwb3J0ICgpIHsKCSAgdHJ5IHsKCSAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMSkKCSAgICBhcnIuX19wcm90b19fID0ge19fcHJvdG9fXzogVWludDhBcnJheS5wcm90b3R5cGUsIGZvbzogZnVuY3Rpb24gKCkgeyByZXR1cm4gNDIgfX0KCSAgICByZXR1cm4gYXJyLmZvbygpID09PSA0MiAmJiAvLyB0eXBlZCBhcnJheSBpbnN0YW5jZXMgY2FuIGJlIGF1Z21lbnRlZAoJICAgICAgICB0eXBlb2YgYXJyLnN1YmFycmF5ID09PSAnZnVuY3Rpb24nICYmIC8vIGNocm9tZSA5LTEwIGxhY2sgYHN1YmFycmF5YAoJICAgICAgICBhcnIuc3ViYXJyYXkoMSwgMSkuYnl0ZUxlbmd0aCA9PT0gMCAvLyBpZTEwIGhhcyBicm9rZW4gYHN1YmFycmF5YAoJICB9IGNhdGNoIChlKSB7CgkgICAgcmV0dXJuIGZhbHNlCgkgIH0KCX0KCglmdW5jdGlvbiBrTWF4TGVuZ3RoICgpIHsKCSAgcmV0dXJuIEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUCgkgICAgPyAweDdmZmZmZmZmCgkgICAgOiAweDNmZmZmZmZmCgl9CgoJZnVuY3Rpb24gY3JlYXRlQnVmZmVyICh0aGF0LCBsZW5ndGgpIHsKCSAgaWYgKGtNYXhMZW5ndGgoKSA8IGxlbmd0aCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHR5cGVkIGFycmF5IGxlbmd0aCcpCgkgIH0KCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlCgkgICAgdGhhdCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCkKCSAgICB0aGF0Ll9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGUKCSAgfSBlbHNlIHsKCSAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzCgkgICAgaWYgKHRoYXQgPT09IG51bGwpIHsKCSAgICAgIHRoYXQgPSBuZXcgQnVmZmVyKGxlbmd0aCkKCSAgICB9CgkgICAgdGhhdC5sZW5ndGggPSBsZW5ndGgKCSAgfQoKCSAgcmV0dXJuIHRoYXQKCX0KCgkvKioKCSAqIFRoZSBCdWZmZXIgY29uc3RydWN0b3IgcmV0dXJucyBpbnN0YW5jZXMgb2YgYFVpbnQ4QXJyYXlgIHRoYXQgaGF2ZSB0aGVpcgoJICogcHJvdG90eXBlIGNoYW5nZWQgdG8gYEJ1ZmZlci5wcm90b3R5cGVgLiBGdXJ0aGVybW9yZSwgYEJ1ZmZlcmAgaXMgYSBzdWJjbGFzcyBvZgoJICogYFVpbnQ4QXJyYXlgLCBzbyB0aGUgcmV0dXJuZWQgaW5zdGFuY2VzIHdpbGwgaGF2ZSBhbGwgdGhlIG5vZGUgYEJ1ZmZlcmAgbWV0aG9kcwoJICogYW5kIHRoZSBgVWludDhBcnJheWAgbWV0aG9kcy4gU3F1YXJlIGJyYWNrZXQgbm90YXRpb24gd29ya3MgYXMgZXhwZWN0ZWQgLS0gaXQKCSAqIHJldHVybnMgYSBzaW5nbGUgb2N0ZXQuCgkgKgoJICogVGhlIGBVaW50OEFycmF5YCBwcm90b3R5cGUgcmVtYWlucyB1bm1vZGlmaWVkLgoJICovCgoJZnVuY3Rpb24gQnVmZmVyIChhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkgewoJICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmICEodGhpcyBpbnN0YW5jZW9mIEJ1ZmZlcikpIHsKCSAgICByZXR1cm4gbmV3IEJ1ZmZlcihhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkKCSAgfQoKCSAgLy8gQ29tbW9uIGNhc2UuCgkgIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykgewoJICAgIGlmICh0eXBlb2YgZW5jb2RpbmdPck9mZnNldCA9PT0gJ3N0cmluZycpIHsKCSAgICAgIHRocm93IG5ldyBFcnJvcigKCSAgICAgICAgJ0lmIGVuY29kaW5nIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nJwoJICAgICAgKQoJICAgIH0KCSAgICByZXR1cm4gYWxsb2NVbnNhZmUodGhpcywgYXJnKQoJICB9CgkgIHJldHVybiBmcm9tKHRoaXMsIGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKQoJfQoKCUJ1ZmZlci5wb29sU2l6ZSA9IDgxOTIgLy8gbm90IHVzZWQgYnkgdGhpcyBpbXBsZW1lbnRhdGlvbgoKCS8vIFRPRE86IExlZ2FjeSwgbm90IG5lZWRlZCBhbnltb3JlLiBSZW1vdmUgaW4gbmV4dCBtYWpvciB2ZXJzaW9uLgoJQnVmZmVyLl9hdWdtZW50ID0gZnVuY3Rpb24gKGFycikgewoJICBhcnIuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZQoJICByZXR1cm4gYXJyCgl9CgoJZnVuY3Rpb24gZnJvbSAodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkgewoJICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyJ2YWx1ZSIgYXJndW1lbnQgbXVzdCBub3QgYmUgYSBudW1iZXInKQoJICB9CgoJICBpZiAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7CgkgICAgcmV0dXJuIGZyb21BcnJheUJ1ZmZlcih0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKQoJICB9CgoJICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgewoJICAgIHJldHVybiBmcm9tU3RyaW5nKHRoYXQsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0KQoJICB9CgoJICByZXR1cm4gZnJvbU9iamVjdCh0aGF0LCB2YWx1ZSkKCX0KCgkvKioKCSAqIEZ1bmN0aW9uYWxseSBlcXVpdmFsZW50IHRvIEJ1ZmZlcihhcmcsIGVuY29kaW5nKSBidXQgdGhyb3dzIGEgVHlwZUVycm9yCgkgKiBpZiB2YWx1ZSBpcyBhIG51bWJlci4KCSAqIEJ1ZmZlci5mcm9tKHN0clssIGVuY29kaW5nXSkKCSAqIEJ1ZmZlci5mcm9tKGFycmF5KQoJICogQnVmZmVyLmZyb20oYnVmZmVyKQoJICogQnVmZmVyLmZyb20oYXJyYXlCdWZmZXJbLCBieXRlT2Zmc2V0WywgbGVuZ3RoXV0pCgkgKiovCglCdWZmZXIuZnJvbSA9IGZ1bmN0aW9uICh2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBmcm9tKG51bGwsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpCgl9CgoJaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgIEJ1ZmZlci5wcm90b3R5cGUuX19wcm90b19fID0gVWludDhBcnJheS5wcm90b3R5cGUKCSAgQnVmZmVyLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXkKCSAgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC5zcGVjaWVzICYmCgkgICAgICBCdWZmZXJbU3ltYm9sLnNwZWNpZXNdID09PSBCdWZmZXIpIHsKCSAgICAvLyBGaXggc3ViYXJyYXkoKSBpbiBFUzIwMTYuIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2Zlcm9zcy9idWZmZXIvcHVsbC85NwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWZmZXIsIFN5bWJvbC5zcGVjaWVzLCB7CgkgICAgICB2YWx1ZTogbnVsbCwKCSAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQoJICAgIH0pCgkgIH0KCX0KCglmdW5jdGlvbiBhc3NlcnRTaXplIChzaXplKSB7CgkgIGlmICh0eXBlb2Ygc2l6ZSAhPT0gJ251bWJlcicpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcic2l6ZSIgYXJndW1lbnQgbXVzdCBiZSBhIG51bWJlcicpCgkgIH0gZWxzZSBpZiAoc2l6ZSA8IDApIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignInNpemUiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG5lZ2F0aXZlJykKCSAgfQoJfQoKCWZ1bmN0aW9uIGFsbG9jICh0aGF0LCBzaXplLCBmaWxsLCBlbmNvZGluZykgewoJICBhc3NlcnRTaXplKHNpemUpCgkgIGlmIChzaXplIDw9IDApIHsKCSAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpCgkgIH0KCSAgaWYgKGZpbGwgIT09IHVuZGVmaW5lZCkgewoJICAgIC8vIE9ubHkgcGF5IGF0dGVudGlvbiB0byBlbmNvZGluZyBpZiBpdCdzIGEgc3RyaW5nLiBUaGlzCgkgICAgLy8gcHJldmVudHMgYWNjaWRlbnRhbGx5IHNlbmRpbmcgaW4gYSBudW1iZXIgdGhhdCB3b3VsZAoJICAgIC8vIGJlIGludGVycHJldHRlZCBhcyBhIHN0YXJ0IG9mZnNldC4KCSAgICByZXR1cm4gdHlwZW9mIGVuY29kaW5nID09PSAnc3RyaW5nJwoJICAgICAgPyBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkuZmlsbChmaWxsLCBlbmNvZGluZykKCSAgICAgIDogY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpLmZpbGwoZmlsbCkKCSAgfQoJICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpCgl9CgoJLyoqCgkgKiBDcmVhdGVzIGEgbmV3IGZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuCgkgKiBhbGxvYyhzaXplWywgZmlsbFssIGVuY29kaW5nXV0pCgkgKiovCglCdWZmZXIuYWxsb2MgPSBmdW5jdGlvbiAoc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHsKCSAgcmV0dXJuIGFsbG9jKG51bGwsIHNpemUsIGZpbGwsIGVuY29kaW5nKQoJfQoKCWZ1bmN0aW9uIGFsbG9jVW5zYWZlICh0aGF0LCBzaXplKSB7CgkgIGFzc2VydFNpemUoc2l6ZSkKCSAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplIDwgMCA/IDAgOiBjaGVja2VkKHNpemUpIHwgMCkKCSAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgKytpKSB7CgkgICAgICB0aGF0W2ldID0gMAoJICAgIH0KCSAgfQoJICByZXR1cm4gdGhhdAoJfQoKCS8qKgoJICogRXF1aXZhbGVudCB0byBCdWZmZXIobnVtKSwgYnkgZGVmYXVsdCBjcmVhdGVzIGEgbm9uLXplcm8tZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS4KCSAqICovCglCdWZmZXIuYWxsb2NVbnNhZmUgPSBmdW5jdGlvbiAoc2l6ZSkgewoJICByZXR1cm4gYWxsb2NVbnNhZmUobnVsbCwgc2l6ZSkKCX0KCS8qKgoJICogRXF1aXZhbGVudCB0byBTbG93QnVmZmVyKG51bSksIGJ5IGRlZmF1bHQgY3JlYXRlcyBhIG5vbi16ZXJvLWZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuCgkgKi8KCUJ1ZmZlci5hbGxvY1Vuc2FmZVNsb3cgPSBmdW5jdGlvbiAoc2l6ZSkgewoJICByZXR1cm4gYWxsb2NVbnNhZmUobnVsbCwgc2l6ZSkKCX0KCglmdW5jdGlvbiBmcm9tU3RyaW5nICh0aGF0LCBzdHJpbmcsIGVuY29kaW5nKSB7CgkgIGlmICh0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnIHx8IGVuY29kaW5nID09PSAnJykgewoJICAgIGVuY29kaW5nID0gJ3V0ZjgnCgkgIH0KCgkgIGlmICghQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignImVuY29kaW5nIiBtdXN0IGJlIGEgdmFsaWQgc3RyaW5nIGVuY29kaW5nJykKCSAgfQoKCSAgdmFyIGxlbmd0aCA9IGJ5dGVMZW5ndGgoc3RyaW5nLCBlbmNvZGluZykgfCAwCgkgIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKQoKCSAgdmFyIGFjdHVhbCA9IHRoYXQud3JpdGUoc3RyaW5nLCBlbmNvZGluZykKCgkgIGlmIChhY3R1YWwgIT09IGxlbmd0aCkgewoJICAgIC8vIFdyaXRpbmcgYSBoZXggc3RyaW5nLCBmb3IgZXhhbXBsZSwgdGhhdCBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMgd2lsbAoJICAgIC8vIGNhdXNlIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGZpcnN0IGludmFsaWQgY2hhcmFjdGVyIHRvIGJlIGlnbm9yZWQuIChlLmcuCgkgICAgLy8gJ2FieHhjZCcgd2lsbCBiZSB0cmVhdGVkIGFzICdhYicpCgkgICAgdGhhdCA9IHRoYXQuc2xpY2UoMCwgYWN0dWFsKQoJICB9CgoJICByZXR1cm4gdGhhdAoJfQoKCWZ1bmN0aW9uIGZyb21BcnJheUxpa2UgKHRoYXQsIGFycmF5KSB7CgkgIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGggPCAwID8gMCA6IGNoZWNrZWQoYXJyYXkubGVuZ3RoKSB8IDAKCSAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBsZW5ndGgpCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHsKCSAgICB0aGF0W2ldID0gYXJyYXlbaV0gJiAyNTUKCSAgfQoJICByZXR1cm4gdGhhdAoJfQoKCWZ1bmN0aW9uIGZyb21BcnJheUJ1ZmZlciAodGhhdCwgYXJyYXksIGJ5dGVPZmZzZXQsIGxlbmd0aCkgewoJICBhcnJheS5ieXRlTGVuZ3RoIC8vIHRoaXMgdGhyb3dzIGlmIGBhcnJheWAgaXMgbm90IGEgdmFsaWQgQXJyYXlCdWZmZXIKCgkgIGlmIChieXRlT2Zmc2V0IDwgMCB8fCBhcnJheS5ieXRlTGVuZ3RoIDwgYnl0ZU9mZnNldCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcJ29mZnNldFwnIGlzIG91dCBvZiBib3VuZHMnKQoJICB9CgoJICBpZiAoYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQgKyAobGVuZ3RoIHx8IDApKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wnbGVuZ3RoXCcgaXMgb3V0IG9mIGJvdW5kcycpCgkgIH0KCgkgIGlmIChieXRlT2Zmc2V0ID09PSB1bmRlZmluZWQgJiYgbGVuZ3RoID09PSB1bmRlZmluZWQpIHsKCSAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5KQoJICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldCkKCSAgfSBlbHNlIHsKCSAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0LCBsZW5ndGgpCgkgIH0KCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIC8vIFJldHVybiBhbiBhdWdtZW50ZWQgYFVpbnQ4QXJyYXlgIGluc3RhbmNlLCBmb3IgYmVzdCBwZXJmb3JtYW5jZQoJICAgIHRoYXQgPSBhcnJheQoJICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZQoJICB9IGVsc2UgewoJICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3MKCSAgICB0aGF0ID0gZnJvbUFycmF5TGlrZSh0aGF0LCBhcnJheSkKCSAgfQoJICByZXR1cm4gdGhhdAoJfQoKCWZ1bmN0aW9uIGZyb21PYmplY3QgKHRoYXQsIG9iaikgewoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKG9iaikpIHsKCSAgICB2YXIgbGVuID0gY2hlY2tlZChvYmoubGVuZ3RoKSB8IDAKCSAgICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbikKCgkgICAgaWYgKHRoYXQubGVuZ3RoID09PSAwKSB7CgkgICAgICByZXR1cm4gdGhhdAoJICAgIH0KCgkgICAgb2JqLmNvcHkodGhhdCwgMCwgMCwgbGVuKQoJICAgIHJldHVybiB0aGF0CgkgIH0KCgkgIGlmIChvYmopIHsKCSAgICBpZiAoKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYKCSAgICAgICAgb2JqLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB8fCAnbGVuZ3RoJyBpbiBvYmopIHsKCSAgICAgIGlmICh0eXBlb2Ygb2JqLmxlbmd0aCAhPT0gJ251bWJlcicgfHwgaXNuYW4ob2JqLmxlbmd0aCkpIHsKCSAgICAgICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCAwKQoJICAgICAgfQoJICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqKQoJICAgIH0KCgkgICAgaWYgKG9iai50eXBlID09PSAnQnVmZmVyJyAmJiBpc0FycmF5KG9iai5kYXRhKSkgewoJICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqLmRhdGEpCgkgICAgfQoJICB9CgoJICB0aHJvdyBuZXcgVHlwZUVycm9yKCdGaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nLCBCdWZmZXIsIEFycmF5QnVmZmVyLCBBcnJheSwgb3IgYXJyYXktbGlrZSBvYmplY3QuJykKCX0KCglmdW5jdGlvbiBjaGVja2VkIChsZW5ndGgpIHsKCSAgLy8gTm90ZTogY2Fubm90IHVzZSBgbGVuZ3RoIDwga01heExlbmd0aCgpYCBoZXJlIGJlY2F1c2UgdGhhdCBmYWlscyB3aGVuCgkgIC8vIGxlbmd0aCBpcyBOYU4gKHdoaWNoIGlzIG90aGVyd2lzZSBjb2VyY2VkIHRvIHplcm8uKQoJICBpZiAobGVuZ3RoID49IGtNYXhMZW5ndGgoKSkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIGFsbG9jYXRlIEJ1ZmZlciBsYXJnZXIgdGhhbiBtYXhpbXVtICcgKwoJICAgICAgICAgICAgICAgICAgICAgICAgICdzaXplOiAweCcgKyBrTWF4TGVuZ3RoKCkudG9TdHJpbmcoMTYpICsgJyBieXRlcycpCgkgIH0KCSAgcmV0dXJuIGxlbmd0aCB8IDAKCX0KCglmdW5jdGlvbiBTbG93QnVmZmVyIChsZW5ndGgpIHsKCSAgaWYgKCtsZW5ndGggIT0gbGVuZ3RoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZXFlcWVxCgkgICAgbGVuZ3RoID0gMAoJICB9CgkgIHJldHVybiBCdWZmZXIuYWxsb2MoK2xlbmd0aCkKCX0KCglCdWZmZXIuaXNCdWZmZXIgPSBmdW5jdGlvbiBpc0J1ZmZlciAoYikgewoJICByZXR1cm4gISEoYiAhPSBudWxsICYmIGIuX2lzQnVmZmVyKQoJfQoKCUJ1ZmZlci5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAoYSwgYikgewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihhKSB8fCAhQnVmZmVyLmlzQnVmZmVyKGIpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnRzIG11c3QgYmUgQnVmZmVycycpCgkgIH0KCgkgIGlmIChhID09PSBiKSByZXR1cm4gMAoKCSAgdmFyIHggPSBhLmxlbmd0aAoJICB2YXIgeSA9IGIubGVuZ3RoCgoJICBmb3IgKHZhciBpID0gMCwgbGVuID0gTWF0aC5taW4oeCwgeSk7IGkgPCBsZW47ICsraSkgewoJICAgIGlmIChhW2ldICE9PSBiW2ldKSB7CgkgICAgICB4ID0gYVtpXQoJICAgICAgeSA9IGJbaV0KCSAgICAgIGJyZWFrCgkgICAgfQoJICB9CgoJICBpZiAoeCA8IHkpIHJldHVybiAtMQoJICBpZiAoeSA8IHgpIHJldHVybiAxCgkgIHJldHVybiAwCgl9CgoJQnVmZmVyLmlzRW5jb2RpbmcgPSBmdW5jdGlvbiBpc0VuY29kaW5nIChlbmNvZGluZykgewoJICBzd2l0Y2ggKFN0cmluZyhlbmNvZGluZykudG9Mb3dlckNhc2UoKSkgewoJICAgIGNhc2UgJ2hleCc6CgkgICAgY2FzZSAndXRmOCc6CgkgICAgY2FzZSAndXRmLTgnOgoJICAgIGNhc2UgJ2FzY2lpJzoKCSAgICBjYXNlICdsYXRpbjEnOgoJICAgIGNhc2UgJ2JpbmFyeSc6CgkgICAgY2FzZSAnYmFzZTY0JzoKCSAgICBjYXNlICd1Y3MyJzoKCSAgICBjYXNlICd1Y3MtMic6CgkgICAgY2FzZSAndXRmMTZsZSc6CgkgICAgY2FzZSAndXRmLTE2bGUnOgoJICAgICAgcmV0dXJuIHRydWUKCSAgICBkZWZhdWx0OgoJICAgICAgcmV0dXJuIGZhbHNlCgkgIH0KCX0KCglCdWZmZXIuY29uY2F0ID0gZnVuY3Rpb24gY29uY2F0IChsaXN0LCBsZW5ndGgpIHsKCSAgaWYgKCFpc0FycmF5KGxpc3QpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignImxpc3QiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpCgkgIH0KCgkgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMCkgewoJICAgIHJldHVybiBCdWZmZXIuYWxsb2MoMCkKCSAgfQoKCSAgdmFyIGkKCSAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgbGVuZ3RoID0gMAoJICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7CgkgICAgICBsZW5ndGggKz0gbGlzdFtpXS5sZW5ndGgKCSAgICB9CgkgIH0KCgkgIHZhciBidWZmZXIgPSBCdWZmZXIuYWxsb2NVbnNhZmUobGVuZ3RoKQoJICB2YXIgcG9zID0gMAoJICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7ICsraSkgewoJICAgIHZhciBidWYgPSBsaXN0W2ldCgkgICAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmKSkgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignImxpc3QiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpCgkgICAgfQoJICAgIGJ1Zi5jb3B5KGJ1ZmZlciwgcG9zKQoJICAgIHBvcyArPSBidWYubGVuZ3RoCgkgIH0KCSAgcmV0dXJuIGJ1ZmZlcgoJfQoKCWZ1bmN0aW9uIGJ5dGVMZW5ndGggKHN0cmluZywgZW5jb2RpbmcpIHsKCSAgaWYgKEJ1ZmZlci5pc0J1ZmZlcihzdHJpbmcpKSB7CgkgICAgcmV0dXJuIHN0cmluZy5sZW5ndGgKCSAgfQoJICBpZiAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgQXJyYXlCdWZmZXIuaXNWaWV3ID09PSAnZnVuY3Rpb24nICYmCgkgICAgICAoQXJyYXlCdWZmZXIuaXNWaWV3KHN0cmluZykgfHwgc3RyaW5nIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpKSB7CgkgICAgcmV0dXJuIHN0cmluZy5ieXRlTGVuZ3RoCgkgIH0KCSAgaWYgKHR5cGVvZiBzdHJpbmcgIT09ICdzdHJpbmcnKSB7CgkgICAgc3RyaW5nID0gJycgKyBzdHJpbmcKCSAgfQoKCSAgdmFyIGxlbiA9IHN0cmluZy5sZW5ndGgKCSAgaWYgKGxlbiA9PT0gMCkgcmV0dXJuIDAKCgkgIC8vIFVzZSBhIGZvciBsb29wIHRvIGF2b2lkIHJlY3Vyc2lvbgoJICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZQoJICBmb3IgKDs7KSB7CgkgICAgc3dpdGNoIChlbmNvZGluZykgewoJICAgICAgY2FzZSAnYXNjaWknOgoJICAgICAgY2FzZSAnbGF0aW4xJzoKCSAgICAgIGNhc2UgJ2JpbmFyeSc6CgkgICAgICAgIHJldHVybiBsZW4KCSAgICAgIGNhc2UgJ3V0ZjgnOgoJICAgICAgY2FzZSAndXRmLTgnOgoJICAgICAgY2FzZSB1bmRlZmluZWQ6CgkgICAgICAgIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aAoJICAgICAgY2FzZSAndWNzMic6CgkgICAgICBjYXNlICd1Y3MtMic6CgkgICAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIGNhc2UgJ3V0Zi0xNmxlJzoKCSAgICAgICAgcmV0dXJuIGxlbiAqIDIKCSAgICAgIGNhc2UgJ2hleCc6CgkgICAgICAgIHJldHVybiBsZW4gPj4+IDEKCSAgICAgIGNhc2UgJ2Jhc2U2NCc6CgkgICAgICAgIHJldHVybiBiYXNlNjRUb0J5dGVzKHN0cmluZykubGVuZ3RoCgkgICAgICBkZWZhdWx0OgoJICAgICAgICBpZiAobG93ZXJlZENhc2UpIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aCAvLyBhc3N1bWUgdXRmOAoJICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpCgkgICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZQoJICAgIH0KCSAgfQoJfQoJQnVmZmVyLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoCgoJZnVuY3Rpb24gc2xvd1RvU3RyaW5nIChlbmNvZGluZywgc3RhcnQsIGVuZCkgewoJICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZQoKCSAgLy8gTm8gbmVlZCB0byB2ZXJpZnkgdGhhdCAidGhpcy5sZW5ndGggPD0gTUFYX1VJTlQzMiIgc2luY2UgaXQncyBhIHJlYWQtb25seQoJICAvLyBwcm9wZXJ0eSBvZiBhIHR5cGVkIGFycmF5LgoKCSAgLy8gVGhpcyBiZWhhdmVzIG5laXRoZXIgbGlrZSBTdHJpbmcgbm9yIFVpbnQ4QXJyYXkgaW4gdGhhdCB3ZSBzZXQgc3RhcnQvZW5kCgkgIC8vIHRvIHRoZWlyIHVwcGVyL2xvd2VyIGJvdW5kcyBpZiB0aGUgdmFsdWUgcGFzc2VkIGlzIG91dCBvZiByYW5nZS4KCSAgLy8gdW5kZWZpbmVkIGlzIGhhbmRsZWQgc3BlY2lhbGx5IGFzIHBlciBFQ01BLTI2MiA2dGggRWRpdGlvbiwKCSAgLy8gU2VjdGlvbiAxMy4zLjMuNyBSdW50aW1lIFNlbWFudGljczogS2V5ZWRCaW5kaW5nSW5pdGlhbGl6YXRpb24uCgkgIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkIHx8IHN0YXJ0IDwgMCkgewoJICAgIHN0YXJ0ID0gMAoJICB9CgkgIC8vIFJldHVybiBlYXJseSBpZiBzdGFydCA+IHRoaXMubGVuZ3RoLiBEb25lIGhlcmUgdG8gcHJldmVudCBwb3RlbnRpYWwgdWludDMyCgkgIC8vIGNvZXJjaW9uIGZhaWwgYmVsb3cuCgkgIGlmIChzdGFydCA+IHRoaXMubGVuZ3RoKSB7CgkgICAgcmV0dXJuICcnCgkgIH0KCgkgIGlmIChlbmQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPiB0aGlzLmxlbmd0aCkgewoJICAgIGVuZCA9IHRoaXMubGVuZ3RoCgkgIH0KCgkgIGlmIChlbmQgPD0gMCkgewoJICAgIHJldHVybiAnJwoJICB9CgoJICAvLyBGb3JjZSBjb2Vyc2lvbiB0byB1aW50MzIuIFRoaXMgd2lsbCBhbHNvIGNvZXJjZSBmYWxzZXkvTmFOIHZhbHVlcyB0byAwLgoJICBlbmQgPj4+PSAwCgkgIHN0YXJ0ID4+Pj0gMAoKCSAgaWYgKGVuZCA8PSBzdGFydCkgewoJICAgIHJldHVybiAnJwoJICB9CgoJICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4JwoKCSAgd2hpbGUgKHRydWUpIHsKCSAgICBzd2l0Y2ggKGVuY29kaW5nKSB7CgkgICAgICBjYXNlICdoZXgnOgoJICAgICAgICByZXR1cm4gaGV4U2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICd1dGY4JzoKCSAgICAgIGNhc2UgJ3V0Zi04JzoKCSAgICAgICAgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGNhc2UgJ2FzY2lpJzoKCSAgICAgICAgcmV0dXJuIGFzY2lpU2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICdsYXRpbjEnOgoJICAgICAgY2FzZSAnYmluYXJ5JzoKCSAgICAgICAgcmV0dXJuIGxhdGluMVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgY2FzZSAnYmFzZTY0JzoKCSAgICAgICAgcmV0dXJuIGJhc2U2NFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgY2FzZSAndWNzMic6CgkgICAgICBjYXNlICd1Y3MtMic6CgkgICAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIGNhc2UgJ3V0Zi0xNmxlJzoKCSAgICAgICAgcmV0dXJuIHV0ZjE2bGVTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGRlZmF1bHQ6CgkgICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKQoJICAgICAgICBlbmNvZGluZyA9IChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpCgkgICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZQoJICAgIH0KCSAgfQoJfQoKCS8vIFRoZSBwcm9wZXJ0eSBpcyB1c2VkIGJ5IGBCdWZmZXIuaXNCdWZmZXJgIGFuZCBgaXMtYnVmZmVyYCAoaW4gU2FmYXJpIDUtNykgdG8gZGV0ZWN0CgkvLyBCdWZmZXIgaW5zdGFuY2VzLgoJQnVmZmVyLnByb3RvdHlwZS5faXNCdWZmZXIgPSB0cnVlCgoJZnVuY3Rpb24gc3dhcCAoYiwgbiwgbSkgewoJICB2YXIgaSA9IGJbbl0KCSAgYltuXSA9IGJbbV0KCSAgYlttXSA9IGkKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXAxNiA9IGZ1bmN0aW9uIHN3YXAxNiAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgMiAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMTYtYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDEpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXAzMiA9IGZ1bmN0aW9uIHN3YXAzMiAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgNCAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMzItYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDMpCgkgICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDIpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXA2NCA9IGZ1bmN0aW9uIHN3YXA2NCAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgOCAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNjQtYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gOCkgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDcpCgkgICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDYpCgkgICAgc3dhcCh0aGlzLCBpICsgMiwgaSArIDUpCgkgICAgc3dhcCh0aGlzLCBpICsgMywgaSArIDQpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkgewoJICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGggfCAwCgkgIGlmIChsZW5ndGggPT09IDApIHJldHVybiAnJwoJICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCAwLCBsZW5ndGgpCgkgIHJldHVybiBzbG93VG9TdHJpbmcuYXBwbHkodGhpcywgYXJndW1lbnRzKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gZXF1YWxzIChiKSB7CgkgIGlmICghQnVmZmVyLmlzQnVmZmVyKGIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyJykKCSAgaWYgKHRoaXMgPT09IGIpIHJldHVybiB0cnVlCgkgIHJldHVybiBCdWZmZXIuY29tcGFyZSh0aGlzLCBiKSA9PT0gMAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuaW5zcGVjdCA9IGZ1bmN0aW9uIGluc3BlY3QgKCkgewoJICB2YXIgc3RyID0gJycKCSAgdmFyIG1heCA9IGV4cG9ydHMuSU5TUEVDVF9NQVhfQllURVMKCSAgaWYgKHRoaXMubGVuZ3RoID4gMCkgewoJICAgIHN0ciA9IHRoaXMudG9TdHJpbmcoJ2hleCcsIDAsIG1heCkubWF0Y2goLy57Mn0vZykuam9pbignICcpCgkgICAgaWYgKHRoaXMubGVuZ3RoID4gbWF4KSBzdHIgKz0gJyAuLi4gJwoJICB9CgkgIHJldHVybiAnPEJ1ZmZlciAnICsgc3RyICsgJz4nCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAodGFyZ2V0LCBzdGFydCwgZW5kLCB0aGlzU3RhcnQsIHRoaXNFbmQpIHsKCSAgaWYgKCFCdWZmZXIuaXNCdWZmZXIodGFyZ2V0KSkgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKQoJICB9CgoJICBpZiAoc3RhcnQgPT09IHVuZGVmaW5lZCkgewoJICAgIHN0YXJ0ID0gMAoJICB9CgkgIGlmIChlbmQgPT09IHVuZGVmaW5lZCkgewoJICAgIGVuZCA9IHRhcmdldCA/IHRhcmdldC5sZW5ndGggOiAwCgkgIH0KCSAgaWYgKHRoaXNTdGFydCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgdGhpc1N0YXJ0ID0gMAoJICB9CgkgIGlmICh0aGlzRW5kID09PSB1bmRlZmluZWQpIHsKCSAgICB0aGlzRW5kID0gdGhpcy5sZW5ndGgKCSAgfQoKCSAgaWYgKHN0YXJ0IDwgMCB8fCBlbmQgPiB0YXJnZXQubGVuZ3RoIHx8IHRoaXNTdGFydCA8IDAgfHwgdGhpc0VuZCA+IHRoaXMubGVuZ3RoKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ291dCBvZiByYW5nZSBpbmRleCcpCgkgIH0KCgkgIGlmICh0aGlzU3RhcnQgPj0gdGhpc0VuZCAmJiBzdGFydCA+PSBlbmQpIHsKCSAgICByZXR1cm4gMAoJICB9CgkgIGlmICh0aGlzU3RhcnQgPj0gdGhpc0VuZCkgewoJICAgIHJldHVybiAtMQoJICB9CgkgIGlmIChzdGFydCA+PSBlbmQpIHsKCSAgICByZXR1cm4gMQoJICB9CgoJICBzdGFydCA+Pj49IDAKCSAgZW5kID4+Pj0gMAoJICB0aGlzU3RhcnQgPj4+PSAwCgkgIHRoaXNFbmQgPj4+PSAwCgoJICBpZiAodGhpcyA9PT0gdGFyZ2V0KSByZXR1cm4gMAoKCSAgdmFyIHggPSB0aGlzRW5kIC0gdGhpc1N0YXJ0CgkgIHZhciB5ID0gZW5kIC0gc3RhcnQKCSAgdmFyIGxlbiA9IE1hdGgubWluKHgsIHkpCgoJICB2YXIgdGhpc0NvcHkgPSB0aGlzLnNsaWNlKHRoaXNTdGFydCwgdGhpc0VuZCkKCSAgdmFyIHRhcmdldENvcHkgPSB0YXJnZXQuc2xpY2Uoc3RhcnQsIGVuZCkKCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHsKCSAgICBpZiAodGhpc0NvcHlbaV0gIT09IHRhcmdldENvcHlbaV0pIHsKCSAgICAgIHggPSB0aGlzQ29weVtpXQoJICAgICAgeSA9IHRhcmdldENvcHlbaV0KCSAgICAgIGJyZWFrCgkgICAgfQoJICB9CgoJICBpZiAoeCA8IHkpIHJldHVybiAtMQoJICBpZiAoeSA8IHgpIHJldHVybiAxCgkgIHJldHVybiAwCgl9CgoJLy8gRmluZHMgZWl0aGVyIHRoZSBmaXJzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPj0gYGJ5dGVPZmZzZXRgLAoJLy8gT1IgdGhlIGxhc3QgaW5kZXggb2YgYHZhbGAgaW4gYGJ1ZmZlcmAgYXQgb2Zmc2V0IDw9IGBieXRlT2Zmc2V0YC4KCS8vCgkvLyBBcmd1bWVudHM6CgkvLyAtIGJ1ZmZlciAtIGEgQnVmZmVyIHRvIHNlYXJjaAoJLy8gLSB2YWwgLSBhIHN0cmluZywgQnVmZmVyLCBvciBudW1iZXIKCS8vIC0gYnl0ZU9mZnNldCAtIGFuIGluZGV4IGludG8gYGJ1ZmZlcmA7IHdpbGwgYmUgY2xhbXBlZCB0byBhbiBpbnQzMgoJLy8gLSBlbmNvZGluZyAtIGFuIG9wdGlvbmFsIGVuY29kaW5nLCByZWxldmFudCBpcyB2YWwgaXMgYSBzdHJpbmcKCS8vIC0gZGlyIC0gdHJ1ZSBmb3IgaW5kZXhPZiwgZmFsc2UgZm9yIGxhc3RJbmRleE9mCglmdW5jdGlvbiBiaWRpcmVjdGlvbmFsSW5kZXhPZiAoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHsKCSAgLy8gRW1wdHkgYnVmZmVyIG1lYW5zIG5vIG1hdGNoCgkgIGlmIChidWZmZXIubGVuZ3RoID09PSAwKSByZXR1cm4gLTEKCgkgIC8vIE5vcm1hbGl6ZSBieXRlT2Zmc2V0CgkgIGlmICh0eXBlb2YgYnl0ZU9mZnNldCA9PT0gJ3N0cmluZycpIHsKCSAgICBlbmNvZGluZyA9IGJ5dGVPZmZzZXQKCSAgICBieXRlT2Zmc2V0ID0gMAoJICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPiAweDdmZmZmZmZmKSB7CgkgICAgYnl0ZU9mZnNldCA9IDB4N2ZmZmZmZmYKCSAgfSBlbHNlIGlmIChieXRlT2Zmc2V0IDwgLTB4ODAwMDAwMDApIHsKCSAgICBieXRlT2Zmc2V0ID0gLTB4ODAwMDAwMDAKCSAgfQoJICBieXRlT2Zmc2V0ID0gK2J5dGVPZmZzZXQgIC8vIENvZXJjZSB0byBOdW1iZXIuCgkgIGlmIChpc05hTihieXRlT2Zmc2V0KSkgewoJICAgIC8vIGJ5dGVPZmZzZXQ6IGl0IGl0J3MgdW5kZWZpbmVkLCBudWxsLCBOYU4sICJmb28iLCBldGMsIHNlYXJjaCB3aG9sZSBidWZmZXIKCSAgICBieXRlT2Zmc2V0ID0gZGlyID8gMCA6IChidWZmZXIubGVuZ3RoIC0gMSkKCSAgfQoKCSAgLy8gTm9ybWFsaXplIGJ5dGVPZmZzZXQ6IG5lZ2F0aXZlIG9mZnNldHMgc3RhcnQgZnJvbSB0aGUgZW5kIG9mIHRoZSBidWZmZXIKCSAgaWYgKGJ5dGVPZmZzZXQgPCAwKSBieXRlT2Zmc2V0ID0gYnVmZmVyLmxlbmd0aCArIGJ5dGVPZmZzZXQKCSAgaWYgKGJ5dGVPZmZzZXQgPj0gYnVmZmVyLmxlbmd0aCkgewoJICAgIGlmIChkaXIpIHJldHVybiAtMQoJICAgIGVsc2UgYnl0ZU9mZnNldCA9IGJ1ZmZlci5sZW5ndGggLSAxCgkgIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA8IDApIHsKCSAgICBpZiAoZGlyKSBieXRlT2Zmc2V0ID0gMAoJICAgIGVsc2UgcmV0dXJuIC0xCgkgIH0KCgkgIC8vIE5vcm1hbGl6ZSB2YWwKCSAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7CgkgICAgdmFsID0gQnVmZmVyLmZyb20odmFsLCBlbmNvZGluZykKCSAgfQoKCSAgLy8gRmluYWxseSwgc2VhcmNoIGVpdGhlciBpbmRleE9mIChpZiBkaXIgaXMgdHJ1ZSkgb3IgbGFzdEluZGV4T2YKCSAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWwpKSB7CgkgICAgLy8gU3BlY2lhbCBjYXNlOiBsb29raW5nIGZvciBlbXB0eSBzdHJpbmcvYnVmZmVyIGFsd2F5cyBmYWlscwoJICAgIGlmICh2YWwubGVuZ3RoID09PSAwKSB7CgkgICAgICByZXR1cm4gLTEKCSAgICB9CgkgICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikKCSAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykgewoJICAgIHZhbCA9IHZhbCAmIDB4RkYgLy8gU2VhcmNoIGZvciBhIGJ5dGUgdmFsdWUgWzAtMjU1XQoJICAgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCAmJgoJICAgICAgICB0eXBlb2YgVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA9PT0gJ2Z1bmN0aW9uJykgewoJICAgICAgaWYgKGRpcikgewoJICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KQoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgcmV0dXJuIFVpbnQ4QXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpCgkgICAgICB9CgkgICAgfQoJICAgIHJldHVybiBhcnJheUluZGV4T2YoYnVmZmVyLCBbIHZhbCBdLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKQoJICB9CgoJICB0aHJvdyBuZXcgVHlwZUVycm9yKCd2YWwgbXVzdCBiZSBzdHJpbmcsIG51bWJlciBvciBCdWZmZXInKQoJfQoKCWZ1bmN0aW9uIGFycmF5SW5kZXhPZiAoYXJyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHsKCSAgdmFyIGluZGV4U2l6ZSA9IDEKCSAgdmFyIGFyckxlbmd0aCA9IGFyci5sZW5ndGgKCSAgdmFyIHZhbExlbmd0aCA9IHZhbC5sZW5ndGgKCgkgIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkKSB7CgkgICAgZW5jb2RpbmcgPSBTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkKCSAgICBpZiAoZW5jb2RpbmcgPT09ICd1Y3MyJyB8fCBlbmNvZGluZyA9PT0gJ3Vjcy0yJyB8fAoJICAgICAgICBlbmNvZGluZyA9PT0gJ3V0ZjE2bGUnIHx8IGVuY29kaW5nID09PSAndXRmLTE2bGUnKSB7CgkgICAgICBpZiAoYXJyLmxlbmd0aCA8IDIgfHwgdmFsLmxlbmd0aCA8IDIpIHsKCSAgICAgICAgcmV0dXJuIC0xCgkgICAgICB9CgkgICAgICBpbmRleFNpemUgPSAyCgkgICAgICBhcnJMZW5ndGggLz0gMgoJICAgICAgdmFsTGVuZ3RoIC89IDIKCSAgICAgIGJ5dGVPZmZzZXQgLz0gMgoJICAgIH0KCSAgfQoKCSAgZnVuY3Rpb24gcmVhZCAoYnVmLCBpKSB7CgkgICAgaWYgKGluZGV4U2l6ZSA9PT0gMSkgewoJICAgICAgcmV0dXJuIGJ1ZltpXQoJICAgIH0gZWxzZSB7CgkgICAgICByZXR1cm4gYnVmLnJlYWRVSW50MTZCRShpICogaW5kZXhTaXplKQoJICAgIH0KCSAgfQoKCSAgdmFyIGkKCSAgaWYgKGRpcikgewoJICAgIHZhciBmb3VuZEluZGV4ID0gLTEKCSAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpIDwgYXJyTGVuZ3RoOyBpKyspIHsKCSAgICAgIGlmIChyZWFkKGFyciwgaSkgPT09IHJlYWQodmFsLCBmb3VuZEluZGV4ID09PSAtMSA/IDAgOiBpIC0gZm91bmRJbmRleCkpIHsKCSAgICAgICAgaWYgKGZvdW5kSW5kZXggPT09IC0xKSBmb3VuZEluZGV4ID0gaQoJICAgICAgICBpZiAoaSAtIGZvdW5kSW5kZXggKyAxID09PSB2YWxMZW5ndGgpIHJldHVybiBmb3VuZEluZGV4ICogaW5kZXhTaXplCgkgICAgICB9IGVsc2UgewoJICAgICAgICBpZiAoZm91bmRJbmRleCAhPT0gLTEpIGkgLT0gaSAtIGZvdW5kSW5kZXgKCSAgICAgICAgZm91bmRJbmRleCA9IC0xCgkgICAgICB9CgkgICAgfQoJICB9IGVsc2UgewoJICAgIGlmIChieXRlT2Zmc2V0ICsgdmFsTGVuZ3RoID4gYXJyTGVuZ3RoKSBieXRlT2Zmc2V0ID0gYXJyTGVuZ3RoIC0gdmFsTGVuZ3RoCgkgICAgZm9yIChpID0gYnl0ZU9mZnNldDsgaSA+PSAwOyBpLS0pIHsKCSAgICAgIHZhciBmb3VuZCA9IHRydWUKCSAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdmFsTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgaWYgKHJlYWQoYXJyLCBpICsgaikgIT09IHJlYWQodmFsLCBqKSkgewoJICAgICAgICAgIGZvdW5kID0gZmFsc2UKCSAgICAgICAgICBicmVhawoJICAgICAgICB9CgkgICAgICB9CgkgICAgICBpZiAoZm91bmQpIHJldHVybiBpCgkgICAgfQoJICB9CgoJICByZXR1cm4gLTEKCX0KCglCdWZmZXIucHJvdG90eXBlLmluY2x1ZGVzID0gZnVuY3Rpb24gaW5jbHVkZXMgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHsKCSAgcmV0dXJuIHRoaXMuaW5kZXhPZih2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSAhPT0gLTEKCX0KCglCdWZmZXIucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiBpbmRleE9mICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7CgkgIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCB0cnVlKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUubGFzdEluZGV4T2YgPSBmdW5jdGlvbiBsYXN0SW5kZXhPZiAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgewoJICByZXR1cm4gYmlkaXJlY3Rpb25hbEluZGV4T2YodGhpcywgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZmFsc2UpCgl9CgoJZnVuY3Rpb24gaGV4V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkgewoJICBvZmZzZXQgPSBOdW1iZXIob2Zmc2V0KSB8fCAwCgkgIHZhciByZW1haW5pbmcgPSBidWYubGVuZ3RoIC0gb2Zmc2V0CgkgIGlmICghbGVuZ3RoKSB7CgkgICAgbGVuZ3RoID0gcmVtYWluaW5nCgkgIH0gZWxzZSB7CgkgICAgbGVuZ3RoID0gTnVtYmVyKGxlbmd0aCkKCSAgICBpZiAobGVuZ3RoID4gcmVtYWluaW5nKSB7CgkgICAgICBsZW5ndGggPSByZW1haW5pbmcKCSAgICB9CgkgIH0KCgkgIC8vIG11c3QgYmUgYW4gZXZlbiBudW1iZXIgb2YgZGlnaXRzCgkgIHZhciBzdHJMZW4gPSBzdHJpbmcubGVuZ3RoCgkgIGlmIChzdHJMZW4gJSAyICE9PSAwKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGhleCBzdHJpbmcnKQoKCSAgaWYgKGxlbmd0aCA+IHN0ckxlbiAvIDIpIHsKCSAgICBsZW5ndGggPSBzdHJMZW4gLyAyCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewoJICAgIHZhciBwYXJzZWQgPSBwYXJzZUludChzdHJpbmcuc3Vic3RyKGkgKiAyLCAyKSwgMTYpCgkgICAgaWYgKGlzTmFOKHBhcnNlZCkpIHJldHVybiBpCgkgICAgYnVmW29mZnNldCArIGldID0gcGFyc2VkCgkgIH0KCSAgcmV0dXJuIGkKCX0KCglmdW5jdGlvbiB1dGY4V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkgewoJICByZXR1cm4gYmxpdEJ1ZmZlcih1dGY4VG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIGFzY2lpV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkgewoJICByZXR1cm4gYmxpdEJ1ZmZlcihhc2NpaVRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aCkKCX0KCglmdW5jdGlvbiBsYXRpbjFXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBhc2NpaVdyaXRlKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCX0KCglmdW5jdGlvbiBiYXNlNjRXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKGJhc2U2NFRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aCkKCX0KCglmdW5jdGlvbiB1Y3MyV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkgewoJICByZXR1cm4gYmxpdEJ1ZmZlcih1dGYxNmxlVG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiB3cml0ZSAoc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCwgZW5jb2RpbmcpIHsKCSAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZykKCSAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgZW5jb2RpbmcgPSAndXRmOCcKCSAgICBsZW5ndGggPSB0aGlzLmxlbmd0aAoJICAgIG9mZnNldCA9IDAKCSAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgZW5jb2RpbmcpCgkgIH0gZWxzZSBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgJiYgdHlwZW9mIG9mZnNldCA9PT0gJ3N0cmluZycpIHsKCSAgICBlbmNvZGluZyA9IG9mZnNldAoJICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoCgkgICAgb2Zmc2V0ID0gMAoJICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBvZmZzZXRbLCBsZW5ndGhdWywgZW5jb2RpbmddKQoJICB9IGVsc2UgaWYgKGlzRmluaXRlKG9mZnNldCkpIHsKCSAgICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgICAgaWYgKGlzRmluaXRlKGxlbmd0aCkpIHsKCSAgICAgIGxlbmd0aCA9IGxlbmd0aCB8IDAKCSAgICAgIGlmIChlbmNvZGluZyA9PT0gdW5kZWZpbmVkKSBlbmNvZGluZyA9ICd1dGY4JwoJICAgIH0gZWxzZSB7CgkgICAgICBlbmNvZGluZyA9IGxlbmd0aAoJICAgICAgbGVuZ3RoID0gdW5kZWZpbmVkCgkgICAgfQoJICAvLyBsZWdhY3kgd3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0LCBsZW5ndGgpIC0gcmVtb3ZlIGluIHYwLjEzCgkgIH0gZWxzZSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKAoJICAgICAgJ0J1ZmZlci53cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXRbLCBsZW5ndGhdKSBpcyBubyBsb25nZXIgc3VwcG9ydGVkJwoJICAgICkKCSAgfQoKCSAgdmFyIHJlbWFpbmluZyA9IHRoaXMubGVuZ3RoIC0gb2Zmc2V0CgkgIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCB8fCBsZW5ndGggPiByZW1haW5pbmcpIGxlbmd0aCA9IHJlbWFpbmluZwoKCSAgaWYgKChzdHJpbmcubGVuZ3RoID4gMCAmJiAobGVuZ3RoIDwgMCB8fCBvZmZzZXQgPCAwKSkgfHwgb2Zmc2V0ID4gdGhpcy5sZW5ndGgpIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQXR0ZW1wdCB0byB3cml0ZSBvdXRzaWRlIGJ1ZmZlciBib3VuZHMnKQoJICB9CgoJICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4JwoKCSAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2UKCSAgZm9yICg7OykgewoJICAgIHN3aXRjaCAoZW5jb2RpbmcpIHsKCSAgICAgIGNhc2UgJ2hleCc6CgkgICAgICAgIHJldHVybiBoZXhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGNhc2UgJ3V0ZjgnOgoJICAgICAgY2FzZSAndXRmLTgnOgoJICAgICAgICByZXR1cm4gdXRmOFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgY2FzZSAnYXNjaWknOgoJICAgICAgICByZXR1cm4gYXNjaWlXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGNhc2UgJ2xhdGluMSc6CgkgICAgICBjYXNlICdiaW5hcnknOgoJICAgICAgICByZXR1cm4gbGF0aW4xV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBjYXNlICdiYXNlNjQnOgoJICAgICAgICAvLyBXYXJuaW5nOiBtYXhMZW5ndGggbm90IHRha2VuIGludG8gYWNjb3VudCBpbiBiYXNlNjRXcml0ZQoJICAgICAgICByZXR1cm4gYmFzZTY0V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBjYXNlICd1Y3MyJzoKCSAgICAgIGNhc2UgJ3Vjcy0yJzoKCSAgICAgIGNhc2UgJ3V0ZjE2bGUnOgoJICAgICAgY2FzZSAndXRmLTE2bGUnOgoJICAgICAgICByZXR1cm4gdWNzMldyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgZGVmYXVsdDoKCSAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpCgkgICAgICAgIGVuY29kaW5nID0gKCcnICsgZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkKCSAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlCgkgICAgfQoJICB9Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiB0b0pTT04gKCkgewoJICByZXR1cm4gewoJICAgIHR5cGU6ICdCdWZmZXInLAoJICAgIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKQoJICB9Cgl9CgoJZnVuY3Rpb24gYmFzZTY0U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICBpZiAoc3RhcnQgPT09IDAgJiYgZW5kID09PSBidWYubGVuZ3RoKSB7CgkgICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1ZikKCSAgfSBlbHNlIHsKCSAgICByZXR1cm4gYmFzZTY0LmZyb21CeXRlQXJyYXkoYnVmLnNsaWNlKHN0YXJ0LCBlbmQpKQoJICB9Cgl9CgoJZnVuY3Rpb24gdXRmOFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKQoJICB2YXIgcmVzID0gW10KCgkgIHZhciBpID0gc3RhcnQKCSAgd2hpbGUgKGkgPCBlbmQpIHsKCSAgICB2YXIgZmlyc3RCeXRlID0gYnVmW2ldCgkgICAgdmFyIGNvZGVQb2ludCA9IG51bGwKCSAgICB2YXIgYnl0ZXNQZXJTZXF1ZW5jZSA9IChmaXJzdEJ5dGUgPiAweEVGKSA/IDQKCSAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4REYpID8gMwoJICAgICAgOiAoZmlyc3RCeXRlID4gMHhCRikgPyAyCgkgICAgICA6IDEKCgkgICAgaWYgKGkgKyBieXRlc1BlclNlcXVlbmNlIDw9IGVuZCkgewoJICAgICAgdmFyIHNlY29uZEJ5dGUsIHRoaXJkQnl0ZSwgZm91cnRoQnl0ZSwgdGVtcENvZGVQb2ludAoKCSAgICAgIHN3aXRjaCAoYnl0ZXNQZXJTZXF1ZW5jZSkgewoJICAgICAgICBjYXNlIDE6CgkgICAgICAgICAgaWYgKGZpcnN0Qnl0ZSA8IDB4ODApIHsKCSAgICAgICAgICAgIGNvZGVQb2ludCA9IGZpcnN0Qnl0ZQoJICAgICAgICAgIH0KCSAgICAgICAgICBicmVhawoJICAgICAgICBjYXNlIDI6CgkgICAgICAgICAgc2Vjb25kQnl0ZSA9IGJ1ZltpICsgMV0KCSAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkgewoJICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweDFGKSA8PCAweDYgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpCgkgICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4N0YpIHsKCSAgICAgICAgICAgICAgY29kZVBvaW50ID0gdGVtcENvZGVQb2ludAoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0KCSAgICAgICAgICBicmVhawoJICAgICAgICBjYXNlIDM6CgkgICAgICAgICAgc2Vjb25kQnl0ZSA9IGJ1ZltpICsgMV0KCSAgICAgICAgICB0aGlyZEJ5dGUgPSBidWZbaSArIDJdCgkgICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHhDIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweDYgfCAodGhpcmRCeXRlICYgMHgzRikKCSAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3RkYgJiYgKHRlbXBDb2RlUG9pbnQgPCAweEQ4MDAgfHwgdGVtcENvZGVQb2ludCA+IDB4REZGRikpIHsKCSAgICAgICAgICAgICAgY29kZVBvaW50ID0gdGVtcENvZGVQb2ludAoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0KCSAgICAgICAgICBicmVhawoJICAgICAgICBjYXNlIDQ6CgkgICAgICAgICAgc2Vjb25kQnl0ZSA9IGJ1ZltpICsgMV0KCSAgICAgICAgICB0aGlyZEJ5dGUgPSBidWZbaSArIDJdCgkgICAgICAgICAgZm91cnRoQnl0ZSA9IGJ1ZltpICsgM10KCSAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAodGhpcmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKGZvdXJ0aEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkgewoJICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweEYpIDw8IDB4MTIgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpIDw8IDB4QyB8ICh0aGlyZEJ5dGUgJiAweDNGKSA8PCAweDYgfCAoZm91cnRoQnl0ZSAmIDB4M0YpCgkgICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4RkZGRiAmJiB0ZW1wQ29kZVBvaW50IDwgMHgxMTAwMDApIHsKCSAgICAgICAgICAgICAgY29kZVBvaW50ID0gdGVtcENvZGVQb2ludAoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0KCSAgICAgIH0KCSAgICB9CgoJICAgIGlmIChjb2RlUG9pbnQgPT09IG51bGwpIHsKCSAgICAgIC8vIHdlIGRpZCBub3QgZ2VuZXJhdGUgYSB2YWxpZCBjb2RlUG9pbnQgc28gaW5zZXJ0IGEKCSAgICAgIC8vIHJlcGxhY2VtZW50IGNoYXIgKFUrRkZGRCkgYW5kIGFkdmFuY2Ugb25seSAxIGJ5dGUKCSAgICAgIGNvZGVQb2ludCA9IDB4RkZGRAoJICAgICAgYnl0ZXNQZXJTZXF1ZW5jZSA9IDEKCSAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA+IDB4RkZGRikgewoJICAgICAgLy8gZW5jb2RlIHRvIHV0ZjE2IChzdXJyb2dhdGUgcGFpciBkYW5jZSkKCSAgICAgIGNvZGVQb2ludCAtPSAweDEwMDAwCgkgICAgICByZXMucHVzaChjb2RlUG9pbnQgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApCgkgICAgICBjb2RlUG9pbnQgPSAweERDMDAgfCBjb2RlUG9pbnQgJiAweDNGRgoJICAgIH0KCgkgICAgcmVzLnB1c2goY29kZVBvaW50KQoJICAgIGkgKz0gYnl0ZXNQZXJTZXF1ZW5jZQoJICB9CgoJICByZXR1cm4gZGVjb2RlQ29kZVBvaW50c0FycmF5KHJlcykKCX0KCgkvLyBCYXNlZCBvbiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yMjc0NzI3Mi82ODA3NDIsIHRoZSBicm93c2VyIHdpdGgKCS8vIHRoZSBsb3dlc3QgbGltaXQgaXMgQ2hyb21lLCB3aXRoIDB4MTAwMDAgYXJncy4KCS8vIFdlIGdvIDEgbWFnbml0dWRlIGxlc3MsIGZvciBzYWZldHkKCXZhciBNQVhfQVJHVU1FTlRTX0xFTkdUSCA9IDB4MTAwMAoKCWZ1bmN0aW9uIGRlY29kZUNvZGVQb2ludHNBcnJheSAoY29kZVBvaW50cykgewoJICB2YXIgbGVuID0gY29kZVBvaW50cy5sZW5ndGgKCSAgaWYgKGxlbiA8PSBNQVhfQVJHVU1FTlRTX0xFTkdUSCkgewoJICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZywgY29kZVBvaW50cykgLy8gYXZvaWQgZXh0cmEgc2xpY2UoKQoJICB9CgoJICAvLyBEZWNvZGUgaW4gY2h1bmtzIHRvIGF2b2lkICJjYWxsIHN0YWNrIHNpemUgZXhjZWVkZWQiLgoJICB2YXIgcmVzID0gJycKCSAgdmFyIGkgPSAwCgkgIHdoaWxlIChpIDwgbGVuKSB7CgkgICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoCgkgICAgICBTdHJpbmcsCgkgICAgICBjb2RlUG9pbnRzLnNsaWNlKGksIGkgKz0gTUFYX0FSR1VNRU5UU19MRU5HVEgpCgkgICAgKQoJICB9CgkgIHJldHVybiByZXMKCX0KCglmdW5jdGlvbiBhc2NpaVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgdmFyIHJldCA9ICcnCgkgIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZCkKCgkgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7CgkgICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldICYgMHg3RikKCSAgfQoJICByZXR1cm4gcmV0Cgl9CgoJZnVuY3Rpb24gbGF0aW4xU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICB2YXIgcmV0ID0gJycKCSAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKQoKCSAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHsKCSAgICByZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZbaV0pCgkgIH0KCSAgcmV0dXJuIHJldAoJfQoKCWZ1bmN0aW9uIGhleFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgdmFyIGxlbiA9IGJ1Zi5sZW5ndGgKCgkgIGlmICghc3RhcnQgfHwgc3RhcnQgPCAwKSBzdGFydCA9IDAKCSAgaWYgKCFlbmQgfHwgZW5kIDwgMCB8fCBlbmQgPiBsZW4pIGVuZCA9IGxlbgoKCSAgdmFyIG91dCA9ICcnCgkgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7CgkgICAgb3V0ICs9IHRvSGV4KGJ1ZltpXSkKCSAgfQoJICByZXR1cm4gb3V0Cgl9CgoJZnVuY3Rpb24gdXRmMTZsZVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgdmFyIGJ5dGVzID0gYnVmLnNsaWNlKHN0YXJ0LCBlbmQpCgkgIHZhciByZXMgPSAnJwoJICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzLmxlbmd0aDsgaSArPSAyKSB7CgkgICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0gKyBieXRlc1tpICsgMV0gKiAyNTYpCgkgIH0KCSAgcmV0dXJuIHJlcwoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiBzbGljZSAoc3RhcnQsIGVuZCkgewoJICB2YXIgbGVuID0gdGhpcy5sZW5ndGgKCSAgc3RhcnQgPSB+fnN0YXJ0CgkgIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogfn5lbmQKCgkgIGlmIChzdGFydCA8IDApIHsKCSAgICBzdGFydCArPSBsZW4KCSAgICBpZiAoc3RhcnQgPCAwKSBzdGFydCA9IDAKCSAgfSBlbHNlIGlmIChzdGFydCA+IGxlbikgewoJICAgIHN0YXJ0ID0gbGVuCgkgIH0KCgkgIGlmIChlbmQgPCAwKSB7CgkgICAgZW5kICs9IGxlbgoJICAgIGlmIChlbmQgPCAwKSBlbmQgPSAwCgkgIH0gZWxzZSBpZiAoZW5kID4gbGVuKSB7CgkgICAgZW5kID0gbGVuCgkgIH0KCgkgIGlmIChlbmQgPCBzdGFydCkgZW5kID0gc3RhcnQKCgkgIHZhciBuZXdCdWYKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgbmV3QnVmID0gdGhpcy5zdWJhcnJheShzdGFydCwgZW5kKQoJICAgIG5ld0J1Zi5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlCgkgIH0gZWxzZSB7CgkgICAgdmFyIHNsaWNlTGVuID0gZW5kIC0gc3RhcnQKCSAgICBuZXdCdWYgPSBuZXcgQnVmZmVyKHNsaWNlTGVuLCB1bmRlZmluZWQpCgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzbGljZUxlbjsgKytpKSB7CgkgICAgICBuZXdCdWZbaV0gPSB0aGlzW2kgKyBzdGFydF0KCSAgICB9CgkgIH0KCgkgIHJldHVybiBuZXdCdWYKCX0KCgkvKgoJICogTmVlZCB0byBtYWtlIHN1cmUgdGhhdCBidWZmZXIgaXNuJ3QgdHJ5aW5nIHRvIHdyaXRlIG91dCBvZiBib3VuZHMuCgkgKi8KCWZ1bmN0aW9uIGNoZWNrT2Zmc2V0IChvZmZzZXQsIGV4dCwgbGVuZ3RoKSB7CgkgIGlmICgob2Zmc2V0ICUgMSkgIT09IDAgfHwgb2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ29mZnNldCBpcyBub3QgdWludCcpCgkgIGlmIChvZmZzZXQgKyBleHQgPiBsZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoJykKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50TEUgPSBmdW5jdGlvbiByZWFkVUludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpCgoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdCgkgIHZhciBtdWwgPSAxCgkgIHZhciBpID0gMAoJICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsCgkgIH0KCgkgIHJldHVybiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50QkUgPSBmdW5jdGlvbiByZWFkVUludEJFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwCgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKQoJICB9CgoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWJ5dGVMZW5ndGhdCgkgIHZhciBtdWwgPSAxCgkgIHdoaWxlIChieXRlTGVuZ3RoID4gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0gKiBtdWwKCSAgfQoKCSAgcmV0dXJuIHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQ4ID0gZnVuY3Rpb24gcmVhZFVJbnQ4IChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiB0aGlzW29mZnNldF0KCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gKHRoaXNbb2Zmc2V0XSA8PCA4KSB8IHRoaXNbb2Zmc2V0ICsgMV0KCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MzJMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MzJMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoKCSAgcmV0dXJuICgodGhpc1tvZmZzZXRdKSB8CgkgICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8CgkgICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikpICsKCSAgICAgICh0aGlzW29mZnNldCArIDNdICogMHgxMDAwMDAwKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkJFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgoJICByZXR1cm4gKHRoaXNbb2Zmc2V0XSAqIDB4MTAwMDAwMCkgKwoJICAgICgodGhpc1tvZmZzZXQgKyAxXSA8PCAxNikgfAoJICAgICh0aGlzW29mZnNldCArIDJdIDw8IDgpIHwKCSAgICB0aGlzW29mZnNldCArIDNdKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludExFID0gZnVuY3Rpb24gcmVhZEludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpCgoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdCgkgIHZhciBtdWwgPSAxCgkgIHZhciBpID0gMAoJICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsCgkgIH0KCSAgbXVsICo9IDB4ODAKCgkgIGlmICh2YWwgPj0gbXVsKSB2YWwgLT0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpCgoJICByZXR1cm4gdmFsCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50QkUgPSBmdW5jdGlvbiByZWFkSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCkKCgkgIHZhciBpID0gYnl0ZUxlbmd0aAoJICB2YXIgbXVsID0gMQoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWldCgkgIHdoaWxlIChpID4gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0taV0gKiBtdWwKCSAgfQoJICBtdWwgKj0gMHg4MAoKCSAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkKCgkgIHJldHVybiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQ4ID0gZnVuY3Rpb24gcmVhZEludDggKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aCkKCSAgaWYgKCEodGhpc1tvZmZzZXRdICYgMHg4MCkpIHJldHVybiAodGhpc1tvZmZzZXRdKQoJICByZXR1cm4gKCgweGZmIC0gdGhpc1tvZmZzZXRdICsgMSkgKiAtMSkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkxFID0gZnVuY3Rpb24gcmVhZEludDE2TEUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aCkKCSAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XSB8ICh0aGlzW29mZnNldCArIDFdIDw8IDgpCgkgIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkJFID0gZnVuY3Rpb24gcmVhZEludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aCkKCSAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgMV0gfCAodGhpc1tvZmZzZXRdIDw8IDgpCgkgIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkxFID0gZnVuY3Rpb24gcmVhZEludDMyTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aCkKCgkgIHJldHVybiAodGhpc1tvZmZzZXRdKSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkgfAoJICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgM10gPDwgMjQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgoJICByZXR1cm4gKHRoaXNbb2Zmc2V0XSA8PCAyNCkgfAoJICAgICh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfAoJICAgICh0aGlzW29mZnNldCArIDNdKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0TEUgPSBmdW5jdGlvbiByZWFkRmxvYXRMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgMjMsIDQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRCRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdEJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgMjMsIDQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlTEUgPSBmdW5jdGlvbiByZWFkRG91YmxlTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aCkKCSAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIHRydWUsIDUyLCA4KQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUJFID0gZnVuY3Rpb24gcmVhZERvdWJsZUJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgNTIsIDgpCgl9CgoJZnVuY3Rpb24gY2hlY2tJbnQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikgewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCciYnVmZmVyIiBhcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyIGluc3RhbmNlJykKCSAgaWYgKHZhbHVlID4gbWF4IHx8IHZhbHVlIDwgbWluKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignInZhbHVlIiBhcmd1bWVudCBpcyBvdXQgb2YgYm91bmRzJykKCSAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIHZhciBtYXhCeXRlcyA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSAtIDEKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBtYXhCeXRlcywgMCkKCSAgfQoKCSAgdmFyIG11bCA9IDEKCSAgdmFyIGkgPSAwCgkgIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRgoJICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRgoJICB9CgoJICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnRCRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIHZhciBtYXhCeXRlcyA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSAtIDEKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBtYXhCeXRlcywgMCkKCSAgfQoKCSAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMQoJICB2YXIgbXVsID0gMQoJICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGCgkgIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRgoJICB9CgoJICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50OCA9IGZ1bmN0aW9uIHdyaXRlVUludDggKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMSwgMHhmZiwgMCkKCSAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKQoJICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKQoJICByZXR1cm4gb2Zmc2V0ICsgMQoJfQoKCWZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDE2IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikgewoJICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZiArIHZhbHVlICsgMQoJICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDIpOyBpIDwgajsgKytpKSB7CgkgICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlICYgKDB4ZmYgPDwgKDggKiAobGl0dGxlRW5kaWFuID8gaSA6IDEgLSBpKSkpKSA+Pj4KCSAgICAgIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpICogOAoJICB9Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKQoJICB9CgkgIHJldHVybiBvZmZzZXQgKyAyCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkJFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOCkKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZikKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgMgoJfQoKCWZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDMyIChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikgewoJICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZmZmZmYgKyB2YWx1ZSArIDEKCSAgZm9yICh2YXIgaSA9IDAsIGogPSBNYXRoLm1pbihidWYubGVuZ3RoIC0gb2Zmc2V0LCA0KTsgaSA8IGo7ICsraSkgewoJICAgIGJ1ZltvZmZzZXQgKyBpXSA9ICh2YWx1ZSA+Pj4gKGxpdHRsZUVuZGlhbiA/IGkgOiAzIC0gaSkgKiA4KSAmIDB4ZmYKCSAgfQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpCgkgICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpCgkgIH0KCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQzMkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpCgkgICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZikKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgNAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlSW50TEUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSkKCgkgICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbGltaXQgLSAxLCAtbGltaXQpCgkgIH0KCgkgIHZhciBpID0gMAoJICB2YXIgbXVsID0gMQoJICB2YXIgc3ViID0gMAoJICB0aGlzW29mZnNldF0gPSB2YWx1ZSAmIDB4RkYKCSAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHsKCSAgICBpZiAodmFsdWUgPCAwICYmIHN1YiA9PT0gMCAmJiB0aGlzW29mZnNldCArIGkgLSAxXSAhPT0gMCkgewoJICAgICAgc3ViID0gMQoJICAgIH0KCSAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGCgkgIH0KCgkgIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUludEJFID0gZnVuY3Rpb24gd3JpdGVJbnRCRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgdmFyIGxpbWl0ID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGggLSAxKQoKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdCkKCSAgfQoKCSAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMQoJICB2YXIgbXVsID0gMQoJICB2YXIgc3ViID0gMAoJICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGCgkgIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSArIDFdICE9PSAwKSB7CgkgICAgICBzdWIgPSAxCgkgICAgfQoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50OCA9IGZ1bmN0aW9uIHdyaXRlSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweDdmLCAtMHg4MCkKCSAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKQoJICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmYgKyB2YWx1ZSArIDEKCSAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgcmV0dXJuIG9mZnNldCArIDEKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKQoJICB9CgkgIHJldHVybiBvZmZzZXQgKyAyCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZUludDE2QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHg3ZmZmLCAtMHg4MDAwKQoJICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDgpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSAmIDB4ZmYpCgkgIH0gZWxzZSB7CgkgICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpCgkgIH0KCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KQoJICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KQoJICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpCgkgIH0KCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMCkKCSAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpCgkgICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpCgkgICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZikKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgNAoJfQoKCWZ1bmN0aW9uIGNoZWNrSUVFRTc1NCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBleHQsIG1heCwgbWluKSB7CgkgIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJykKCSAgaWYgKG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKQoJfQoKCWZ1bmN0aW9uIHdyaXRlRmxvYXQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgNCwgMy40MDI4MjM0NjYzODUyODg2ZSszOCwgLTMuNDAyODIzNDY2Mzg1Mjg4NmUrMzgpCgkgIH0KCSAgaWVlZTc1NC53cml0ZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgMjMsIDQpCgkgIHJldHVybiBvZmZzZXQgKyA0Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0TEUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUsIG5vQXNzZXJ0KQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdEJFID0gZnVuY3Rpb24gd3JpdGVGbG9hdEJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICByZXR1cm4gd3JpdGVGbG9hdCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpCgl9CgoJZnVuY3Rpb24gd3JpdGVEb3VibGUgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgOCwgMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgsIC0xLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCkKCSAgfQoJICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCA1MiwgOCkKCSAgcmV0dXJuIG9mZnNldCArIDgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlTEUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUJFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgcmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydCkKCX0KCgkvLyBjb3B5KHRhcmdldEJ1ZmZlciwgdGFyZ2V0U3RhcnQ9MCwgc291cmNlU3RhcnQ9MCwgc291cmNlRW5kPWJ1ZmZlci5sZW5ndGgpCglCdWZmZXIucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiBjb3B5ICh0YXJnZXQsIHRhcmdldFN0YXJ0LCBzdGFydCwgZW5kKSB7CgkgIGlmICghc3RhcnQpIHN0YXJ0ID0gMAoJICBpZiAoIWVuZCAmJiBlbmQgIT09IDApIGVuZCA9IHRoaXMubGVuZ3RoCgkgIGlmICh0YXJnZXRTdGFydCA+PSB0YXJnZXQubGVuZ3RoKSB0YXJnZXRTdGFydCA9IHRhcmdldC5sZW5ndGgKCSAgaWYgKCF0YXJnZXRTdGFydCkgdGFyZ2V0U3RhcnQgPSAwCgkgIGlmIChlbmQgPiAwICYmIGVuZCA8IHN0YXJ0KSBlbmQgPSBzdGFydAoKCSAgLy8gQ29weSAwIGJ5dGVzOyB3ZSdyZSBkb25lCgkgIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm4gMAoJICBpZiAodGFyZ2V0Lmxlbmd0aCA9PT0gMCB8fCB0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDAKCgkgIC8vIEZhdGFsIGVycm9yIGNvbmRpdGlvbnMKCSAgaWYgKHRhcmdldFN0YXJ0IDwgMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCd0YXJnZXRTdGFydCBvdXQgb2YgYm91bmRzJykKCSAgfQoJICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlU3RhcnQgb3V0IG9mIGJvdW5kcycpCgkgIGlmIChlbmQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlRW5kIG91dCBvZiBib3VuZHMnKQoKCSAgLy8gQXJlIHdlIG9vYj8KCSAgaWYgKGVuZCA+IHRoaXMubGVuZ3RoKSBlbmQgPSB0aGlzLmxlbmd0aAoJICBpZiAodGFyZ2V0Lmxlbmd0aCAtIHRhcmdldFN0YXJ0IDwgZW5kIC0gc3RhcnQpIHsKCSAgICBlbmQgPSB0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgKyBzdGFydAoJICB9CgoJICB2YXIgbGVuID0gZW5kIC0gc3RhcnQKCSAgdmFyIGkKCgkgIGlmICh0aGlzID09PSB0YXJnZXQgJiYgc3RhcnQgPCB0YXJnZXRTdGFydCAmJiB0YXJnZXRTdGFydCA8IGVuZCkgewoJICAgIC8vIGRlc2NlbmRpbmcgY29weSBmcm9tIGVuZAoJICAgIGZvciAoaSA9IGxlbiAtIDE7IGkgPj0gMDsgLS1pKSB7CgkgICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XQoJICAgIH0KCSAgfSBlbHNlIGlmIChsZW4gPCAxMDAwIHx8ICFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIC8vIGFzY2VuZGluZyBjb3B5IGZyb20gc3RhcnQKCSAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyArK2kpIHsKCSAgICAgIHRhcmdldFtpICsgdGFyZ2V0U3RhcnRdID0gdGhpc1tpICsgc3RhcnRdCgkgICAgfQoJICB9IGVsc2UgewoJICAgIFVpbnQ4QXJyYXkucHJvdG90eXBlLnNldC5jYWxsKAoJICAgICAgdGFyZ2V0LAoJICAgICAgdGhpcy5zdWJhcnJheShzdGFydCwgc3RhcnQgKyBsZW4pLAoJICAgICAgdGFyZ2V0U3RhcnQKCSAgICApCgkgIH0KCgkgIHJldHVybiBsZW4KCX0KCgkvLyBVc2FnZToKCS8vICAgIGJ1ZmZlci5maWxsKG51bWJlclssIG9mZnNldFssIGVuZF1dKQoJLy8gICAgYnVmZmVyLmZpbGwoYnVmZmVyWywgb2Zmc2V0WywgZW5kXV0pCgkvLyAgICBidWZmZXIuZmlsbChzdHJpbmdbLCBvZmZzZXRbLCBlbmRdXVssIGVuY29kaW5nXSkKCUJ1ZmZlci5wcm90b3R5cGUuZmlsbCA9IGZ1bmN0aW9uIGZpbGwgKHZhbCwgc3RhcnQsIGVuZCwgZW5jb2RpbmcpIHsKCSAgLy8gSGFuZGxlIHN0cmluZyBjYXNlczoKCSAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7CgkgICAgaWYgKHR5cGVvZiBzdGFydCA9PT0gJ3N0cmluZycpIHsKCSAgICAgIGVuY29kaW5nID0gc3RhcnQKCSAgICAgIHN0YXJ0ID0gMAoJICAgICAgZW5kID0gdGhpcy5sZW5ndGgKCSAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbmQgPT09ICdzdHJpbmcnKSB7CgkgICAgICBlbmNvZGluZyA9IGVuZAoJICAgICAgZW5kID0gdGhpcy5sZW5ndGgKCSAgICB9CgkgICAgaWYgKHZhbC5sZW5ndGggPT09IDEpIHsKCSAgICAgIHZhciBjb2RlID0gdmFsLmNoYXJDb2RlQXQoMCkKCSAgICAgIGlmIChjb2RlIDwgMjU2KSB7CgkgICAgICAgIHZhbCA9IGNvZGUKCSAgICAgIH0KCSAgICB9CgkgICAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIGVuY29kaW5nICE9PSAnc3RyaW5nJykgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZW5jb2RpbmcgbXVzdCBiZSBhIHN0cmluZycpCgkgICAgfQoJICAgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnICYmICFCdWZmZXIuaXNFbmNvZGluZyhlbmNvZGluZykpIHsKCSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZykKCSAgICB9CgkgIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHsKCSAgICB2YWwgPSB2YWwgJiAyNTUKCSAgfQoKCSAgLy8gSW52YWxpZCByYW5nZXMgYXJlIG5vdCBzZXQgdG8gYSBkZWZhdWx0LCBzbyBjYW4gcmFuZ2UgY2hlY2sgZWFybHkuCgkgIGlmIChzdGFydCA8IDAgfHwgdGhpcy5sZW5ndGggPCBzdGFydCB8fCB0aGlzLmxlbmd0aCA8IGVuZCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdPdXQgb2YgcmFuZ2UgaW5kZXgnKQoJICB9CgoJICBpZiAoZW5kIDw9IHN0YXJ0KSB7CgkgICAgcmV0dXJuIHRoaXMKCSAgfQoKCSAgc3RhcnQgPSBzdGFydCA+Pj4gMAoJICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IHRoaXMubGVuZ3RoIDogZW5kID4+PiAwCgoJICBpZiAoIXZhbCkgdmFsID0gMAoKCSAgdmFyIGkKCSAgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7CgkgICAgZm9yIChpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkgewoJICAgICAgdGhpc1tpXSA9IHZhbAoJICAgIH0KCSAgfSBlbHNlIHsKCSAgICB2YXIgYnl0ZXMgPSBCdWZmZXIuaXNCdWZmZXIodmFsKQoJICAgICAgPyB2YWwKCSAgICAgIDogdXRmOFRvQnl0ZXMobmV3IEJ1ZmZlcih2YWwsIGVuY29kaW5nKS50b1N0cmluZygpKQoJICAgIHZhciBsZW4gPSBieXRlcy5sZW5ndGgKCSAgICBmb3IgKGkgPSAwOyBpIDwgZW5kIC0gc3RhcnQ7ICsraSkgewoJICAgICAgdGhpc1tpICsgc3RhcnRdID0gYnl0ZXNbaSAlIGxlbl0KCSAgICB9CgkgIH0KCgkgIHJldHVybiB0aGlzCgl9CgoJLy8gSEVMUEVSIEZVTkNUSU9OUwoJLy8gPT09PT09PT09PT09PT09PQoKCXZhciBJTlZBTElEX0JBU0U2NF9SRSA9IC9bXitcLzAtOUEtWmEtei1fXS9nCgoJZnVuY3Rpb24gYmFzZTY0Y2xlYW4gKHN0cikgewoJICAvLyBOb2RlIHN0cmlwcyBvdXQgaW52YWxpZCBjaGFyYWN0ZXJzIGxpa2UgXG4gYW5kIFx0IGZyb20gdGhlIHN0cmluZywgYmFzZTY0LWpzIGRvZXMgbm90CgkgIHN0ciA9IHN0cmluZ3RyaW0oc3RyKS5yZXBsYWNlKElOVkFMSURfQkFTRTY0X1JFLCAnJykKCSAgLy8gTm9kZSBjb252ZXJ0cyBzdHJpbmdzIHdpdGggbGVuZ3RoIDwgMiB0byAnJwoJICBpZiAoc3RyLmxlbmd0aCA8IDIpIHJldHVybiAnJwoJICAvLyBOb2RlIGFsbG93cyBmb3Igbm9uLXBhZGRlZCBiYXNlNjQgc3RyaW5ncyAobWlzc2luZyB0cmFpbGluZyA9PT0pLCBiYXNlNjQtanMgZG9lcyBub3QKCSAgd2hpbGUgKHN0ci5sZW5ndGggJSA0ICE9PSAwKSB7CgkgICAgc3RyID0gc3RyICsgJz0nCgkgIH0KCSAgcmV0dXJuIHN0cgoJfQoKCWZ1bmN0aW9uIHN0cmluZ3RyaW0gKHN0cikgewoJICBpZiAoc3RyLnRyaW0pIHJldHVybiBzdHIudHJpbSgpCgkgIHJldHVybiBzdHIucmVwbGFjZSgvXlxzK3xccyskL2csICcnKQoJfQoKCWZ1bmN0aW9uIHRvSGV4IChuKSB7CgkgIGlmIChuIDwgMTYpIHJldHVybiAnMCcgKyBuLnRvU3RyaW5nKDE2KQoJICByZXR1cm4gbi50b1N0cmluZygxNikKCX0KCglmdW5jdGlvbiB1dGY4VG9CeXRlcyAoc3RyaW5nLCB1bml0cykgewoJICB1bml0cyA9IHVuaXRzIHx8IEluZmluaXR5CgkgIHZhciBjb2RlUG9pbnQKCSAgdmFyIGxlbmd0aCA9IHN0cmluZy5sZW5ndGgKCSAgdmFyIGxlYWRTdXJyb2dhdGUgPSBudWxsCgkgIHZhciBieXRlcyA9IFtdCgoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CgkgICAgY29kZVBvaW50ID0gc3RyaW5nLmNoYXJDb2RlQXQoaSkKCgkgICAgLy8gaXMgc3Vycm9nYXRlIGNvbXBvbmVudAoJICAgIGlmIChjb2RlUG9pbnQgPiAweEQ3RkYgJiYgY29kZVBvaW50IDwgMHhFMDAwKSB7CgkgICAgICAvLyBsYXN0IGNoYXIgd2FzIGEgbGVhZAoJICAgICAgaWYgKCFsZWFkU3Vycm9nYXRlKSB7CgkgICAgICAgIC8vIG5vIGxlYWQgeWV0CgkgICAgICAgIGlmIChjb2RlUG9pbnQgPiAweERCRkYpIHsKCSAgICAgICAgICAvLyB1bmV4cGVjdGVkIHRyYWlsCgkgICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpCgkgICAgICAgICAgY29udGludWUKCSAgICAgICAgfSBlbHNlIGlmIChpICsgMSA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgLy8gdW5wYWlyZWQgbGVhZAoJICAgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKQoJICAgICAgICAgIGNvbnRpbnVlCgkgICAgICAgIH0KCgkgICAgICAgIC8vIHZhbGlkIGxlYWQKCSAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludAoKCSAgICAgICAgY29udGludWUKCSAgICAgIH0KCgkgICAgICAvLyAyIGxlYWRzIGluIGEgcm93CgkgICAgICBpZiAoY29kZVBvaW50IDwgMHhEQzAwKSB7CgkgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKQoJICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50CgkgICAgICAgIGNvbnRpbnVlCgkgICAgICB9CgoJICAgICAgLy8gdmFsaWQgc3Vycm9nYXRlIHBhaXIKCSAgICAgIGNvZGVQb2ludCA9IChsZWFkU3Vycm9nYXRlIC0gMHhEODAwIDw8IDEwIHwgY29kZVBvaW50IC0gMHhEQzAwKSArIDB4MTAwMDAKCSAgICB9IGVsc2UgaWYgKGxlYWRTdXJyb2dhdGUpIHsKCSAgICAgIC8vIHZhbGlkIGJtcCBjaGFyLCBidXQgbGFzdCBjaGFyIHdhcyBhIGxlYWQKCSAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKQoJICAgIH0KCgkgICAgbGVhZFN1cnJvZ2F0ZSA9IG51bGwKCgkgICAgLy8gZW5jb2RlIHV0ZjgKCSAgICBpZiAoY29kZVBvaW50IDwgMHg4MCkgewoJICAgICAgaWYgKCh1bml0cyAtPSAxKSA8IDApIGJyZWFrCgkgICAgICBieXRlcy5wdXNoKGNvZGVQb2ludCkKCSAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4ODAwKSB7CgkgICAgICBpZiAoKHVuaXRzIC09IDIpIDwgMCkgYnJlYWsKCSAgICAgIGJ5dGVzLnB1c2goCgkgICAgICAgIGNvZGVQb2ludCA+PiAweDYgfCAweEMwLAoJICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MAoJICAgICAgKQoJICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHgxMDAwMCkgewoJICAgICAgaWYgKCh1bml0cyAtPSAzKSA8IDApIGJyZWFrCgkgICAgICBieXRlcy5wdXNoKAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHhDIHwgMHhFMCwKCSAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLAoJICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MAoJICAgICAgKQoJICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHgxMTAwMDApIHsKCSAgICAgIGlmICgodW5pdHMgLT0gNCkgPCAwKSBicmVhawoJICAgICAgYnl0ZXMucHVzaCgKCSAgICAgICAgY29kZVBvaW50ID4+IDB4MTIgfCAweEYwLAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHhDICYgMHgzRiB8IDB4ODAsCgkgICAgICAgIGNvZGVQb2ludCA+PiAweDYgJiAweDNGIHwgMHg4MCwKCSAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODAKCSAgICAgICkKCSAgICB9IGVsc2UgewoJICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNvZGUgcG9pbnQnKQoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIGJ5dGVzCgl9CgoJZnVuY3Rpb24gYXNjaWlUb0J5dGVzIChzdHIpIHsKCSAgdmFyIGJ5dGVBcnJheSA9IFtdCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7CgkgICAgLy8gTm9kZSdzIGNvZGUgc2VlbXMgdG8gYmUgZG9pbmcgdGhpcyBhbmQgbm90ICYgMHg3Ri4uCgkgICAgYnl0ZUFycmF5LnB1c2goc3RyLmNoYXJDb2RlQXQoaSkgJiAweEZGKQoJICB9CgkgIHJldHVybiBieXRlQXJyYXkKCX0KCglmdW5jdGlvbiB1dGYxNmxlVG9CeXRlcyAoc3RyLCB1bml0cykgewoJICB2YXIgYywgaGksIGxvCgkgIHZhciBieXRlQXJyYXkgPSBbXQoJICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7ICsraSkgewoJICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVhawoKCSAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSkKCSAgICBoaSA9IGMgPj4gOAoJICAgIGxvID0gYyAlIDI1NgoJICAgIGJ5dGVBcnJheS5wdXNoKGxvKQoJICAgIGJ5dGVBcnJheS5wdXNoKGhpKQoJICB9CgoJICByZXR1cm4gYnl0ZUFycmF5Cgl9CgoJZnVuY3Rpb24gYmFzZTY0VG9CeXRlcyAoc3RyKSB7CgkgIHJldHVybiBiYXNlNjQudG9CeXRlQXJyYXkoYmFzZTY0Y2xlYW4oc3RyKSkKCX0KCglmdW5jdGlvbiBibGl0QnVmZmVyIChzcmMsIGRzdCwgb2Zmc2V0LCBsZW5ndGgpIHsKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewoJICAgIGlmICgoaSArIG9mZnNldCA+PSBkc3QubGVuZ3RoKSB8fCAoaSA+PSBzcmMubGVuZ3RoKSkgYnJlYWsKCSAgICBkc3RbaSArIG9mZnNldF0gPSBzcmNbaV0KCSAgfQoJICByZXR1cm4gaQoJfQoKCWZ1bmN0aW9uIGlzbmFuICh2YWwpIHsKCSAgcmV0dXJuIHZhbCAhPT0gdmFsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2VsZi1jb21wYXJlCgl9CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKQoKLyoqKi8gfSwKLyogNyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkndXNlIHN0cmljdCcKCglleHBvcnRzLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoCglleHBvcnRzLnRvQnl0ZUFycmF5ID0gdG9CeXRlQXJyYXkKCWV4cG9ydHMuZnJvbUJ5dGVBcnJheSA9IGZyb21CeXRlQXJyYXkKCgl2YXIgbG9va3VwID0gW10KCXZhciByZXZMb29rdXAgPSBbXQoJdmFyIEFyciA9IHR5cGVvZiBVaW50OEFycmF5ICE9PSAndW5kZWZpbmVkJyA/IFVpbnQ4QXJyYXkgOiBBcnJheQoKCXZhciBjb2RlID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nCglmb3IgKHZhciBpID0gMCwgbGVuID0gY29kZS5sZW5ndGg7IGkgPCBsZW47ICsraSkgewoJICBsb29rdXBbaV0gPSBjb2RlW2ldCgkgIHJldkxvb2t1cFtjb2RlLmNoYXJDb2RlQXQoaSldID0gaQoJfQoKCXJldkxvb2t1cFsnLScuY2hhckNvZGVBdCgwKV0gPSA2MgoJcmV2TG9va3VwWydfJy5jaGFyQ29kZUF0KDApXSA9IDYzCgoJZnVuY3Rpb24gcGxhY2VIb2xkZXJzQ291bnQgKGI2NCkgewoJICB2YXIgbGVuID0gYjY0Lmxlbmd0aAoJICBpZiAobGVuICUgNCA+IDApIHsKCSAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgc3RyaW5nLiBMZW5ndGggbXVzdCBiZSBhIG11bHRpcGxlIG9mIDQnKQoJICB9CgoJICAvLyB0aGUgbnVtYmVyIG9mIGVxdWFsIHNpZ25zIChwbGFjZSBob2xkZXJzKQoJICAvLyBpZiB0aGVyZSBhcmUgdHdvIHBsYWNlaG9sZGVycywgdGhhbiB0aGUgdHdvIGNoYXJhY3RlcnMgYmVmb3JlIGl0CgkgIC8vIHJlcHJlc2VudCBvbmUgYnl0ZQoJICAvLyBpZiB0aGVyZSBpcyBvbmx5IG9uZSwgdGhlbiB0aGUgdGhyZWUgY2hhcmFjdGVycyBiZWZvcmUgaXQgcmVwcmVzZW50IDIgYnl0ZXMKCSAgLy8gdGhpcyBpcyBqdXN0IGEgY2hlYXAgaGFjayB0byBub3QgZG8gaW5kZXhPZiB0d2ljZQoJICByZXR1cm4gYjY0W2xlbiAtIDJdID09PSAnPScgPyAyIDogYjY0W2xlbiAtIDFdID09PSAnPScgPyAxIDogMAoJfQoKCWZ1bmN0aW9uIGJ5dGVMZW5ndGggKGI2NCkgewoJICAvLyBiYXNlNjQgaXMgNC8zICsgdXAgdG8gdHdvIGNoYXJhY3RlcnMgb2YgdGhlIG9yaWdpbmFsIGRhdGEKCSAgcmV0dXJuIGI2NC5sZW5ndGggKiAzIC8gNCAtIHBsYWNlSG9sZGVyc0NvdW50KGI2NCkKCX0KCglmdW5jdGlvbiB0b0J5dGVBcnJheSAoYjY0KSB7CgkgIHZhciBpLCBqLCBsLCB0bXAsIHBsYWNlSG9sZGVycywgYXJyCgkgIHZhciBsZW4gPSBiNjQubGVuZ3RoCgkgIHBsYWNlSG9sZGVycyA9IHBsYWNlSG9sZGVyc0NvdW50KGI2NCkKCgkgIGFyciA9IG5ldyBBcnIobGVuICogMyAvIDQgLSBwbGFjZUhvbGRlcnMpCgoJICAvLyBpZiB0aGVyZSBhcmUgcGxhY2Vob2xkZXJzLCBvbmx5IGdldCB1cCB0byB0aGUgbGFzdCBjb21wbGV0ZSA0IGNoYXJzCgkgIGwgPSBwbGFjZUhvbGRlcnMgPiAwID8gbGVuIC0gNCA6IGxlbgoKCSAgdmFyIEwgPSAwCgoJICBmb3IgKGkgPSAwLCBqID0gMDsgaSA8IGw7IGkgKz0gNCwgaiArPSAzKSB7CgkgICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMTgpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDEyKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDIpXSA8PCA2KSB8IHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMyldCgkgICAgYXJyW0wrK10gPSAodG1wID4+IDE2KSAmIDB4RkYKCSAgICBhcnJbTCsrXSA9ICh0bXAgPj4gOCkgJiAweEZGCgkgICAgYXJyW0wrK10gPSB0bXAgJiAweEZGCgkgIH0KCgkgIGlmIChwbGFjZUhvbGRlcnMgPT09IDIpIHsKCSAgICB0bXAgPSAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAyKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDEpXSA+PiA0KQoJICAgIGFycltMKytdID0gdG1wICYgMHhGRgoJICB9IGVsc2UgaWYgKHBsYWNlSG9sZGVycyA9PT0gMSkgewoJICAgIHRtcCA9IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDEwKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDEpXSA8PCA0KSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDIpXSA+PiAyKQoJICAgIGFycltMKytdID0gKHRtcCA+PiA4KSAmIDB4RkYKCSAgICBhcnJbTCsrXSA9IHRtcCAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIGFycgoJfQoKCWZ1bmN0aW9uIHRyaXBsZXRUb0Jhc2U2NCAobnVtKSB7CgkgIHJldHVybiBsb29rdXBbbnVtID4+IDE4ICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDEyICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDYgJiAweDNGXSArIGxvb2t1cFtudW0gJiAweDNGXQoJfQoKCWZ1bmN0aW9uIGVuY29kZUNodW5rICh1aW50OCwgc3RhcnQsIGVuZCkgewoJICB2YXIgdG1wCgkgIHZhciBvdXRwdXQgPSBbXQoJICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkgKz0gMykgewoJICAgIHRtcCA9ICh1aW50OFtpXSA8PCAxNikgKyAodWludDhbaSArIDFdIDw8IDgpICsgKHVpbnQ4W2kgKyAyXSkKCSAgICBvdXRwdXQucHVzaCh0cmlwbGV0VG9CYXNlNjQodG1wKSkKCSAgfQoJICByZXR1cm4gb3V0cHV0LmpvaW4oJycpCgl9CgoJZnVuY3Rpb24gZnJvbUJ5dGVBcnJheSAodWludDgpIHsKCSAgdmFyIHRtcAoJICB2YXIgbGVuID0gdWludDgubGVuZ3RoCgkgIHZhciBleHRyYUJ5dGVzID0gbGVuICUgMyAvLyBpZiB3ZSBoYXZlIDEgYnl0ZSBsZWZ0LCBwYWQgMiBieXRlcwoJICB2YXIgb3V0cHV0ID0gJycKCSAgdmFyIHBhcnRzID0gW10KCSAgdmFyIG1heENodW5rTGVuZ3RoID0gMTYzODMgLy8gbXVzdCBiZSBtdWx0aXBsZSBvZiAzCgoJICAvLyBnbyB0aHJvdWdoIHRoZSBhcnJheSBldmVyeSB0aHJlZSBieXRlcywgd2UnbGwgZGVhbCB3aXRoIHRyYWlsaW5nIHN0dWZmIGxhdGVyCgkgIGZvciAodmFyIGkgPSAwLCBsZW4yID0gbGVuIC0gZXh0cmFCeXRlczsgaSA8IGxlbjI7IGkgKz0gbWF4Q2h1bmtMZW5ndGgpIHsKCSAgICBwYXJ0cy5wdXNoKGVuY29kZUNodW5rKHVpbnQ4LCBpLCAoaSArIG1heENodW5rTGVuZ3RoKSA+IGxlbjIgPyBsZW4yIDogKGkgKyBtYXhDaHVua0xlbmd0aCkpKQoJICB9CgoJICAvLyBwYWQgdGhlIGVuZCB3aXRoIHplcm9zLCBidXQgbWFrZSBzdXJlIHRvIG5vdCBmb3JnZXQgdGhlIGV4dHJhIGJ5dGVzCgkgIGlmIChleHRyYUJ5dGVzID09PSAxKSB7CgkgICAgdG1wID0gdWludDhbbGVuIC0gMV0KCSAgICBvdXRwdXQgKz0gbG9va3VwW3RtcCA+PiAyXQoJICAgIG91dHB1dCArPSBsb29rdXBbKHRtcCA8PCA0KSAmIDB4M0ZdCgkgICAgb3V0cHV0ICs9ICc9PScKCSAgfSBlbHNlIGlmIChleHRyYUJ5dGVzID09PSAyKSB7CgkgICAgdG1wID0gKHVpbnQ4W2xlbiAtIDJdIDw8IDgpICsgKHVpbnQ4W2xlbiAtIDFdKQoJICAgIG91dHB1dCArPSBsb29rdXBbdG1wID4+IDEwXQoJICAgIG91dHB1dCArPSBsb29rdXBbKHRtcCA+PiA0KSAmIDB4M0ZdCgkgICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wIDw8IDIpICYgMHgzRl0KCSAgICBvdXRwdXQgKz0gJz0nCgkgIH0KCgkgIHBhcnRzLnB1c2gob3V0cHV0KQoKCSAgcmV0dXJuIHBhcnRzLmpvaW4oJycpCgl9CgoKLyoqKi8gfSwKLyogOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCglleHBvcnRzLnJlYWQgPSBmdW5jdGlvbiAoYnVmZmVyLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykgewoJICB2YXIgZSwgbQoJICB2YXIgZUxlbiA9IG5CeXRlcyAqIDggLSBtTGVuIC0gMQoJICB2YXIgZU1heCA9ICgxIDw8IGVMZW4pIC0gMQoJICB2YXIgZUJpYXMgPSBlTWF4ID4+IDEKCSAgdmFyIG5CaXRzID0gLTcKCSAgdmFyIGkgPSBpc0xFID8gKG5CeXRlcyAtIDEpIDogMAoJICB2YXIgZCA9IGlzTEUgPyAtMSA6IDEKCSAgdmFyIHMgPSBidWZmZXJbb2Zmc2V0ICsgaV0KCgkgIGkgKz0gZAoKCSAgZSA9IHMgJiAoKDEgPDwgKC1uQml0cykpIC0gMSkKCSAgcyA+Pj0gKC1uQml0cykKCSAgbkJpdHMgKz0gZUxlbgoJICBmb3IgKDsgbkJpdHMgPiAwOyBlID0gZSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fQoKCSAgbSA9IGUgJiAoKDEgPDwgKC1uQml0cykpIC0gMSkKCSAgZSA+Pj0gKC1uQml0cykKCSAgbkJpdHMgKz0gbUxlbgoJICBmb3IgKDsgbkJpdHMgPiAwOyBtID0gbSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fQoKCSAgaWYgKGUgPT09IDApIHsKCSAgICBlID0gMSAtIGVCaWFzCgkgIH0gZWxzZSBpZiAoZSA9PT0gZU1heCkgewoJICAgIHJldHVybiBtID8gTmFOIDogKChzID8gLTEgOiAxKSAqIEluZmluaXR5KQoJICB9IGVsc2UgewoJICAgIG0gPSBtICsgTWF0aC5wb3coMiwgbUxlbikKCSAgICBlID0gZSAtIGVCaWFzCgkgIH0KCSAgcmV0dXJuIChzID8gLTEgOiAxKSAqIG0gKiBNYXRoLnBvdygyLCBlIC0gbUxlbikKCX0KCglleHBvcnRzLndyaXRlID0gZnVuY3Rpb24gKGJ1ZmZlciwgdmFsdWUsIG9mZnNldCwgaXNMRSwgbUxlbiwgbkJ5dGVzKSB7CgkgIHZhciBlLCBtLCBjCgkgIHZhciBlTGVuID0gbkJ5dGVzICogOCAtIG1MZW4gLSAxCgkgIHZhciBlTWF4ID0gKDEgPDwgZUxlbikgLSAxCgkgIHZhciBlQmlhcyA9IGVNYXggPj4gMQoJICB2YXIgcnQgPSAobUxlbiA9PT0gMjMgPyBNYXRoLnBvdygyLCAtMjQpIC0gTWF0aC5wb3coMiwgLTc3KSA6IDApCgkgIHZhciBpID0gaXNMRSA/IDAgOiAobkJ5dGVzIC0gMSkKCSAgdmFyIGQgPSBpc0xFID8gMSA6IC0xCgkgIHZhciBzID0gdmFsdWUgPCAwIHx8ICh2YWx1ZSA9PT0gMCAmJiAxIC8gdmFsdWUgPCAwKSA/IDEgOiAwCgoJICB2YWx1ZSA9IE1hdGguYWJzKHZhbHVlKQoKCSAgaWYgKGlzTmFOKHZhbHVlKSB8fCB2YWx1ZSA9PT0gSW5maW5pdHkpIHsKCSAgICBtID0gaXNOYU4odmFsdWUpID8gMSA6IDAKCSAgICBlID0gZU1heAoJICB9IGVsc2UgewoJICAgIGUgPSBNYXRoLmZsb29yKE1hdGgubG9nKHZhbHVlKSAvIE1hdGguTE4yKQoJICAgIGlmICh2YWx1ZSAqIChjID0gTWF0aC5wb3coMiwgLWUpKSA8IDEpIHsKCSAgICAgIGUtLQoJICAgICAgYyAqPSAyCgkgICAgfQoJICAgIGlmIChlICsgZUJpYXMgPj0gMSkgewoJICAgICAgdmFsdWUgKz0gcnQgLyBjCgkgICAgfSBlbHNlIHsKCSAgICAgIHZhbHVlICs9IHJ0ICogTWF0aC5wb3coMiwgMSAtIGVCaWFzKQoJICAgIH0KCSAgICBpZiAodmFsdWUgKiBjID49IDIpIHsKCSAgICAgIGUrKwoJICAgICAgYyAvPSAyCgkgICAgfQoKCSAgICBpZiAoZSArIGVCaWFzID49IGVNYXgpIHsKCSAgICAgIG0gPSAwCgkgICAgICBlID0gZU1heAoJICAgIH0gZWxzZSBpZiAoZSArIGVCaWFzID49IDEpIHsKCSAgICAgIG0gPSAodmFsdWUgKiBjIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKQoJICAgICAgZSA9IGUgKyBlQmlhcwoJICAgIH0gZWxzZSB7CgkgICAgICBtID0gdmFsdWUgKiBNYXRoLnBvdygyLCBlQmlhcyAtIDEpICogTWF0aC5wb3coMiwgbUxlbikKCSAgICAgIGUgPSAwCgkgICAgfQoJICB9CgoJICBmb3IgKDsgbUxlbiA+PSA4OyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBtICYgMHhmZiwgaSArPSBkLCBtIC89IDI1NiwgbUxlbiAtPSA4KSB7fQoKCSAgZSA9IChlIDw8IG1MZW4pIHwgbQoJICBlTGVuICs9IG1MZW4KCSAgZm9yICg7IGVMZW4gPiAwOyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBlICYgMHhmZiwgaSArPSBkLCBlIC89IDI1NiwgZUxlbiAtPSA4KSB7fQoKCSAgYnVmZmVyW29mZnNldCArIGkgLSBkXSB8PSBzICogMTI4Cgl9CgoKLyoqKi8gfSwKLyogOSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgl2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZzsKCgltb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKGFycikgewoJICByZXR1cm4gdG9TdHJpbmcuY2FsbChhcnIpID09ICdbb2JqZWN0IEFycmF5XSc7Cgl9OwoKCi8qKiovIH0sCi8qIDEwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHt2YXIgQ2xpZW50UmVxdWVzdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpCgl2YXIgZXh0ZW5kID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNikKCXZhciBzdGF0dXNDb2RlcyA9IF9fd2VicGFja19yZXF1aXJlX18oMzcpCgl2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXygzOCkKCgl2YXIgaHR0cCA9IGV4cG9ydHMKCglodHRwLnJlcXVlc3QgPSBmdW5jdGlvbiAob3B0cywgY2IpIHsKCQlpZiAodHlwZW9mIG9wdHMgPT09ICdzdHJpbmcnKQoJCQlvcHRzID0gdXJsLnBhcnNlKG9wdHMpCgkJZWxzZQoJCQlvcHRzID0gZXh0ZW5kKG9wdHMpCgoJCS8vIE5vcm1hbGx5LCB0aGUgcGFnZSBpcyBsb2FkZWQgZnJvbSBodHRwIG9yIGh0dHBzLCBzbyBub3Qgc3BlY2lmeWluZyBhIHByb3RvY29sCgkJLy8gd2lsbCByZXN1bHQgaW4gYSAodmFsaWQpIHByb3RvY29sLXJlbGF0aXZlIHVybC4gSG93ZXZlciwgdGhpcyB3b24ndCB3b3JrIGlmCgkJLy8gdGhlIHByb3RvY29sIGlzIHNvbWV0aGluZyBlbHNlLCBsaWtlICdmaWxlOicKCQl2YXIgZGVmYXVsdFByb3RvY29sID0gZ2xvYmFsLmxvY2F0aW9uLnByb3RvY29sLnNlYXJjaCgvXmh0dHBzPzokLykgPT09IC0xID8gJ2h0dHA6JyA6ICcnCgoJCXZhciBwcm90b2NvbCA9IG9wdHMucHJvdG9jb2wgfHwgZGVmYXVsdFByb3RvY29sCgkJdmFyIGhvc3QgPSBvcHRzLmhvc3RuYW1lIHx8IG9wdHMuaG9zdAoJCXZhciBwb3J0ID0gb3B0cy5wb3J0CgkJdmFyIHBhdGggPSBvcHRzLnBhdGggfHwgJy8nCgoJCS8vIE5lY2Vzc2FyeSBmb3IgSVB2NiBhZGRyZXNzZXMKCQlpZiAoaG9zdCAmJiBob3N0LmluZGV4T2YoJzonKSAhPT0gLTEpCgkJCWhvc3QgPSAnWycgKyBob3N0ICsgJ10nCgoJCS8vIFRoaXMgbWF5IGJlIGEgcmVsYXRpdmUgdXJsLiBUaGUgYnJvd3NlciBzaG91bGQgYWx3YXlzIGJlIGFibGUgdG8gaW50ZXJwcmV0IGl0IGNvcnJlY3RseS4KCQlvcHRzLnVybCA9IChob3N0ID8gKHByb3RvY29sICsgJy8vJyArIGhvc3QpIDogJycpICsgKHBvcnQgPyAnOicgKyBwb3J0IDogJycpICsgcGF0aAoJCW9wdHMubWV0aG9kID0gKG9wdHMubWV0aG9kIHx8ICdHRVQnKS50b1VwcGVyQ2FzZSgpCgkJb3B0cy5oZWFkZXJzID0gb3B0cy5oZWFkZXJzIHx8IHt9CgoJCS8vIEFsc28gdmFsaWQgb3B0cy5hdXRoLCBvcHRzLm1vZGUKCgkJdmFyIHJlcSA9IG5ldyBDbGllbnRSZXF1ZXN0KG9wdHMpCgkJaWYgKGNiKQoJCQlyZXEub24oJ3Jlc3BvbnNlJywgY2IpCgkJcmV0dXJuIHJlcQoJfQoKCWh0dHAuZ2V0ID0gZnVuY3Rpb24gZ2V0IChvcHRzLCBjYikgewoJCXZhciByZXEgPSBodHRwLnJlcXVlc3Qob3B0cywgY2IpCgkJcmVxLmVuZCgpCgkJcmV0dXJuIHJlcQoJfQoKCWh0dHAuQWdlbnQgPSBmdW5jdGlvbiAoKSB7fQoJaHR0cC5BZ2VudC5kZWZhdWx0TWF4U29ja2V0cyA9IDQKCglodHRwLlNUQVRVU19DT0RFUyA9IHN0YXR1c0NvZGVzCgoJaHR0cC5NRVRIT0RTID0gWwoJCSdDSEVDS09VVCcsCgkJJ0NPTk5FQ1QnLAoJCSdDT1BZJywKCQknREVMRVRFJywKCQknR0VUJywKCQknSEVBRCcsCgkJJ0xPQ0snLAoJCSdNLVNFQVJDSCcsCgkJJ01FUkdFJywKCQknTUtBQ1RJVklUWScsCgkJJ01LQ09MJywKCQknTU9WRScsCgkJJ05PVElGWScsCgkJJ09QVElPTlMnLAoJCSdQQVRDSCcsCgkJJ1BPU1QnLAoJCSdQUk9QRklORCcsCgkJJ1BST1BQQVRDSCcsCgkJJ1BVUkdFJywKCQknUFVUJywKCQknUkVQT1JUJywKCQknU0VBUkNIJywKCQknU1VCU0NSSUJFJywKCQknVFJBQ0UnLAoJCSdVTkxPQ0snLAoJCSdVTlNVQlNDUklCRScKCV0KCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSkKCi8qKiovIH0sCi8qIDExICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIsIGdsb2JhbCwgcHJvY2Vzcykge3ZhciBjYXBhYmlsaXR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKCXZhciBpbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCgl2YXIgcmVzcG9uc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQoJdmFyIHN0cmVhbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCgl2YXIgdG9BcnJheUJ1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpCgoJdmFyIEluY29taW5nTWVzc2FnZSA9IHJlc3BvbnNlLkluY29taW5nTWVzc2FnZQoJdmFyIHJTdGF0ZXMgPSByZXNwb25zZS5yZWFkeVN0YXRlcwoKCWZ1bmN0aW9uIGRlY2lkZU1vZGUgKHByZWZlckJpbmFyeSwgdXNlRmV0Y2gpIHsKCQlpZiAoY2FwYWJpbGl0eS5mZXRjaCAmJiB1c2VGZXRjaCkgewoJCQlyZXR1cm4gJ2ZldGNoJwoJCX0gZWxzZSBpZiAoY2FwYWJpbGl0eS5tb3pjaHVua2VkYXJyYXlidWZmZXIpIHsKCQkJcmV0dXJuICdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcicKCQl9IGVsc2UgaWYgKGNhcGFiaWxpdHkubXNzdHJlYW0pIHsKCQkJcmV0dXJuICdtcy1zdHJlYW0nCgkJfSBlbHNlIGlmIChjYXBhYmlsaXR5LmFycmF5YnVmZmVyICYmIHByZWZlckJpbmFyeSkgewoJCQlyZXR1cm4gJ2FycmF5YnVmZmVyJwoJCX0gZWxzZSBpZiAoY2FwYWJpbGl0eS52YkFycmF5ICYmIHByZWZlckJpbmFyeSkgewoJCQlyZXR1cm4gJ3RleHQ6dmJhcnJheScKCQl9IGVsc2UgewoJCQlyZXR1cm4gJ3RleHQnCgkJfQoJfQoKCXZhciBDbGllbnRSZXF1ZXN0ID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob3B0cykgewoJCXZhciBzZWxmID0gdGhpcwoJCXN0cmVhbS5Xcml0YWJsZS5jYWxsKHNlbGYpCgoJCXNlbGYuX29wdHMgPSBvcHRzCgkJc2VsZi5fYm9keSA9IFtdCgkJc2VsZi5faGVhZGVycyA9IHt9CgkJaWYgKG9wdHMuYXV0aCkKCQkJc2VsZi5zZXRIZWFkZXIoJ0F1dGhvcml6YXRpb24nLCAnQmFzaWMgJyArIG5ldyBCdWZmZXIob3B0cy5hdXRoKS50b1N0cmluZygnYmFzZTY0JykpCgkJT2JqZWN0LmtleXMob3B0cy5oZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CgkJCXNlbGYuc2V0SGVhZGVyKG5hbWUsIG9wdHMuaGVhZGVyc1tuYW1lXSkKCQl9KQoKCQl2YXIgcHJlZmVyQmluYXJ5CgkJdmFyIHVzZUZldGNoID0gdHJ1ZQoJCWlmIChvcHRzLm1vZGUgPT09ICdkaXNhYmxlLWZldGNoJyB8fCAndGltZW91dCcgaW4gb3B0cykgewoJCQkvLyBJZiB0aGUgdXNlIG9mIFhIUiBzaG91bGQgYmUgcHJlZmVycmVkIGFuZCBpbmNsdWRlcyBwcmVzZXJ2aW5nIHRoZSAnY29udGVudC10eXBlJyBoZWFkZXIuCgkJCS8vIEZvcmNlIFhIUiB0byBiZSB1c2VkIHNpbmNlIHRoZSBGZXRjaCBBUEkgZG9lcyBub3QgeWV0IHN1cHBvcnQgdGltZW91dHMuCgkJCXVzZUZldGNoID0gZmFsc2UKCQkJcHJlZmVyQmluYXJ5ID0gdHJ1ZQoJCX0gZWxzZSBpZiAob3B0cy5tb2RlID09PSAncHJlZmVyLXN0cmVhbWluZycpIHsKCQkJLy8gSWYgc3RyZWFtaW5nIGlzIGEgaGlnaCBwcmlvcml0eSBidXQgYmluYXJ5IGNvbXBhdGliaWxpdHkgYW5kCgkJCS8vIHRoZSBhY2N1cmFjeSBvZiB0aGUgJ2NvbnRlbnQtdHlwZScgaGVhZGVyIGFyZW4ndAoJCQlwcmVmZXJCaW5hcnkgPSBmYWxzZQoJCX0gZWxzZSBpZiAob3B0cy5tb2RlID09PSAnYWxsb3ctd3JvbmctY29udGVudC10eXBlJykgewoJCQkvLyBJZiBzdHJlYW1pbmcgaXMgbW9yZSBpbXBvcnRhbnQgdGhhbiBwcmVzZXJ2aW5nIHRoZSAnY29udGVudC10eXBlJyBoZWFkZXIKCQkJcHJlZmVyQmluYXJ5ID0gIWNhcGFiaWxpdHkub3ZlcnJpZGVNaW1lVHlwZQoJCX0gZWxzZSBpZiAoIW9wdHMubW9kZSB8fCBvcHRzLm1vZGUgPT09ICdkZWZhdWx0JyB8fCBvcHRzLm1vZGUgPT09ICdwcmVmZXItZmFzdCcpIHsKCQkJLy8gVXNlIGJpbmFyeSBpZiB0ZXh0IHN0cmVhbWluZyBtYXkgY29ycnVwdCBkYXRhIG9yIHRoZSBjb250ZW50LXR5cGUgaGVhZGVyLCBvciBmb3Igc3BlZWQKCQkJcHJlZmVyQmluYXJ5ID0gdHJ1ZQoJCX0gZWxzZSB7CgkJCXRocm93IG5ldyBFcnJvcignSW52YWxpZCB2YWx1ZSBmb3Igb3B0cy5tb2RlJykKCQl9CgkJc2VsZi5fbW9kZSA9IGRlY2lkZU1vZGUocHJlZmVyQmluYXJ5LCB1c2VGZXRjaCkKCgkJc2VsZi5vbignZmluaXNoJywgZnVuY3Rpb24gKCkgewoJCQlzZWxmLl9vbkZpbmlzaCgpCgkJfSkKCX0KCglpbmhlcml0cyhDbGllbnRSZXF1ZXN0LCBzdHJlYW0uV3JpdGFibGUpCgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuc2V0SGVhZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJdmFyIGxvd2VyTmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKQoJCS8vIFRoaXMgY2hlY2sgaXMgbm90IG5lY2Vzc2FyeSwgYnV0IGl0IHByZXZlbnRzIHdhcm5pbmdzIGZyb20gYnJvd3NlcnMgYWJvdXQgc2V0dGluZyB1bnNhZmUKCQkvLyBoZWFkZXJzLiBUbyBiZSBob25lc3QgSSdtIG5vdCBlbnRpcmVseSBzdXJlIGhpZGluZyB0aGVzZSB3YXJuaW5ncyBpcyBhIGdvb2QgdGhpbmcsIGJ1dAoJCS8vIGh0dHAtYnJvd3NlcmlmeSBkaWQgaXQsIHNvIEkgd2lsbCB0b28uCgkJaWYgKHVuc2FmZUhlYWRlcnMuaW5kZXhPZihsb3dlck5hbWUpICE9PSAtMSkKCQkJcmV0dXJuCgoJCXNlbGYuX2hlYWRlcnNbbG93ZXJOYW1lXSA9IHsKCQkJbmFtZTogbmFtZSwKCQkJdmFsdWU6IHZhbHVlCgkJfQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLmdldEhlYWRlciA9IGZ1bmN0aW9uIChuYW1lKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJcmV0dXJuIHNlbGYuX2hlYWRlcnNbbmFtZS50b0xvd2VyQ2FzZSgpXS52YWx1ZQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLnJlbW92ZUhlYWRlciA9IGZ1bmN0aW9uIChuYW1lKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJZGVsZXRlIHNlbGYuX2hlYWRlcnNbbmFtZS50b0xvd2VyQ2FzZSgpXQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLl9vbkZpbmlzaCA9IGZ1bmN0aW9uICgpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCgkJaWYgKHNlbGYuX2Rlc3Ryb3llZCkKCQkJcmV0dXJuCgkJdmFyIG9wdHMgPSBzZWxmLl9vcHRzCgoJCXZhciBoZWFkZXJzT2JqID0gc2VsZi5faGVhZGVycwoJCXZhciBib2R5ID0gbnVsbAoJCWlmIChvcHRzLm1ldGhvZCAhPT0gJ0dFVCcgJiYgb3B0cy5tZXRob2QgIT09ICdIRUFEJykgewoJCQlpZiAoY2FwYWJpbGl0eS5ibG9iQ29uc3RydWN0b3IpIHsKCQkJCWJvZHkgPSBuZXcgZ2xvYmFsLkJsb2Ioc2VsZi5fYm9keS5tYXAoZnVuY3Rpb24gKGJ1ZmZlcikgewoJCQkJCXJldHVybiB0b0FycmF5QnVmZmVyKGJ1ZmZlcikKCQkJCX0pLCB7CgkJCQkJdHlwZTogKGhlYWRlcnNPYmpbJ2NvbnRlbnQtdHlwZSddIHx8IHt9KS52YWx1ZSB8fCAnJwoJCQkJfSkKCQkJfSBlbHNlIHsKCQkJCS8vIGdldCB1dGY4IHN0cmluZwoJCQkJYm9keSA9IEJ1ZmZlci5jb25jYXQoc2VsZi5fYm9keSkudG9TdHJpbmcoKQoJCQl9CgkJfQoKCQkvLyBjcmVhdGUgZmxhdHRlbmVkIGxpc3Qgb2YgaGVhZGVycwoJCXZhciBoZWFkZXJzTGlzdCA9IFtdCgkJT2JqZWN0LmtleXMoaGVhZGVyc09iaikuZm9yRWFjaChmdW5jdGlvbiAoa2V5TmFtZSkgewoJCQl2YXIgbmFtZSA9IGhlYWRlcnNPYmpba2V5TmFtZV0ubmFtZQoJCQl2YXIgdmFsdWUgPSBoZWFkZXJzT2JqW2tleU5hbWVdLnZhbHVlCgkJCWlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgewoJCQkJdmFsdWUuZm9yRWFjaChmdW5jdGlvbiAodikgewoJCQkJCWhlYWRlcnNMaXN0LnB1c2goW25hbWUsIHZdKQoJCQkJfSkKCQkJfSBlbHNlIHsKCQkJCWhlYWRlcnNMaXN0LnB1c2goW25hbWUsIHZhbHVlXSkKCQkJfQoJCX0pCgoJCWlmIChzZWxmLl9tb2RlID09PSAnZmV0Y2gnKSB7CgkJCWdsb2JhbC5mZXRjaChzZWxmLl9vcHRzLnVybCwgewoJCQkJbWV0aG9kOiBzZWxmLl9vcHRzLm1ldGhvZCwKCQkJCWhlYWRlcnM6IGhlYWRlcnNMaXN0LAoJCQkJYm9keTogYm9keSB8fCB1bmRlZmluZWQsCgkJCQltb2RlOiAnY29ycycsCgkJCQljcmVkZW50aWFsczogb3B0cy53aXRoQ3JlZGVudGlhbHMgPyAnaW5jbHVkZScgOiAnc2FtZS1vcmlnaW4nCgkJCX0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CgkJCQlzZWxmLl9mZXRjaFJlc3BvbnNlID0gcmVzcG9uc2UKCQkJCXNlbGYuX2Nvbm5lY3QoKQoJCQl9LCBmdW5jdGlvbiAocmVhc29uKSB7CgkJCQlzZWxmLmVtaXQoJ2Vycm9yJywgcmVhc29uKQoJCQl9KQoJCX0gZWxzZSB7CgkJCXZhciB4aHIgPSBzZWxmLl94aHIgPSBuZXcgZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0KCkKCQkJdHJ5IHsKCQkJCXhoci5vcGVuKHNlbGYuX29wdHMubWV0aG9kLCBzZWxmLl9vcHRzLnVybCwgdHJ1ZSkKCQkJfSBjYXRjaCAoZXJyKSB7CgkJCQlwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsKCQkJCQlzZWxmLmVtaXQoJ2Vycm9yJywgZXJyKQoJCQkJfSkKCQkJCXJldHVybgoJCQl9CgoJCQkvLyBDYW4ndCBzZXQgcmVzcG9uc2VUeXBlIG9uIHJlYWxseSBvbGQgYnJvd3NlcnMKCQkJaWYgKCdyZXNwb25zZVR5cGUnIGluIHhocikKCQkJCXhoci5yZXNwb25zZVR5cGUgPSBzZWxmLl9tb2RlLnNwbGl0KCc6JylbMF0KCgkJCWlmICgnd2l0aENyZWRlbnRpYWxzJyBpbiB4aHIpCgkJCQl4aHIud2l0aENyZWRlbnRpYWxzID0gISFvcHRzLndpdGhDcmVkZW50aWFscwoKCQkJaWYgKHNlbGYuX21vZGUgPT09ICd0ZXh0JyAmJiAnb3ZlcnJpZGVNaW1lVHlwZScgaW4geGhyKQoJCQkJeGhyLm92ZXJyaWRlTWltZVR5cGUoJ3RleHQvcGxhaW47IGNoYXJzZXQ9eC11c2VyLWRlZmluZWQnKQoKCQkJaWYgKCd0aW1lb3V0JyBpbiBvcHRzKSB7CgkJCQl4aHIudGltZW91dCA9IG9wdHMudGltZW91dAoJCQkJeGhyLm9udGltZW91dCA9IGZ1bmN0aW9uICgpIHsKCQkJCQlzZWxmLmVtaXQoJ3RpbWVvdXQnKQoJCQkJfQoJCQl9CgoJCQloZWFkZXJzTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHsKCQkJCXhoci5zZXRSZXF1ZXN0SGVhZGVyKGhlYWRlclswXSwgaGVhZGVyWzFdKQoJCQl9KQoKCQkJc2VsZi5fcmVzcG9uc2UgPSBudWxsCgkJCXhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7CgkJCQlzd2l0Y2ggKHhoci5yZWFkeVN0YXRlKSB7CgkJCQkJY2FzZSByU3RhdGVzLkxPQURJTkc6CgkJCQkJY2FzZSByU3RhdGVzLkRPTkU6CgkJCQkJCXNlbGYuX29uWEhSUHJvZ3Jlc3MoKQoJCQkJCQlicmVhawoJCQkJfQoJCQl9CgkJCS8vIE5lY2Vzc2FyeSBmb3Igc3RyZWFtaW5nIGluIEZpcmVmb3gsIHNpbmNlIHhoci5yZXNwb25zZSBpcyBPTkxZIGRlZmluZWQKCQkJLy8gaW4gb25wcm9ncmVzcywgbm90IGluIG9ucmVhZHlzdGF0ZWNoYW5nZSB3aXRoIHhoci5yZWFkeVN0YXRlID0gMwoJCQlpZiAoc2VsZi5fbW9kZSA9PT0gJ21vei1jaHVua2VkLWFycmF5YnVmZmVyJykgewoJCQkJeGhyLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbiAoKSB7CgkJCQkJc2VsZi5fb25YSFJQcm9ncmVzcygpCgkJCQl9CgkJCX0KCgkJCXhoci5vbmVycm9yID0gZnVuY3Rpb24gKCkgewoJCQkJaWYgKHNlbGYuX2Rlc3Ryb3llZCkKCQkJCQlyZXR1cm4KCQkJCXNlbGYuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ1hIUiBlcnJvcicpKQoJCQl9CgoJCQl0cnkgewoJCQkJeGhyLnNlbmQoYm9keSkKCQkJfSBjYXRjaCAoZXJyKSB7CgkJCQlwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsKCQkJCQlzZWxmLmVtaXQoJ2Vycm9yJywgZXJyKQoJCQkJfSkKCQkJCXJldHVybgoJCQl9CgkJfQoJfQoKCS8qKgoJICogQ2hlY2tzIGlmIHhoci5zdGF0dXMgaXMgcmVhZGFibGUgYW5kIG5vbi16ZXJvLCBpbmRpY2F0aW5nIG5vIGVycm9yLgoJICogRXZlbiB0aG91Z2ggdGhlIHNwZWMgc2F5cyBpdCBzaG91bGQgYmUgYXZhaWxhYmxlIGluIHJlYWR5U3RhdGUgMywKCSAqIGFjY2Vzc2luZyBpdCB0aHJvd3MgYW4gZXhjZXB0aW9uIGluIElFOAoJICovCglmdW5jdGlvbiBzdGF0dXNWYWxpZCAoeGhyKSB7CgkJdHJ5IHsKCQkJdmFyIHN0YXR1cyA9IHhoci5zdGF0dXMKCQkJcmV0dXJuIChzdGF0dXMgIT09IG51bGwgJiYgc3RhdHVzICE9PSAwKQoJCX0gY2F0Y2ggKGUpIHsKCQkJcmV0dXJuIGZhbHNlCgkJfQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLl9vblhIUlByb2dyZXNzID0gZnVuY3Rpb24gKCkgewoJCXZhciBzZWxmID0gdGhpcwoKCQlpZiAoIXN0YXR1c1ZhbGlkKHNlbGYuX3hocikgfHwgc2VsZi5fZGVzdHJveWVkKQoJCQlyZXR1cm4KCgkJaWYgKCFzZWxmLl9yZXNwb25zZSkKCQkJc2VsZi5fY29ubmVjdCgpCgoJCXNlbGYuX3Jlc3BvbnNlLl9vblhIUlByb2dyZXNzKCkKCX0KCglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5fY29ubmVjdCA9IGZ1bmN0aW9uICgpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCgkJaWYgKHNlbGYuX2Rlc3Ryb3llZCkKCQkJcmV0dXJuCgoJCXNlbGYuX3Jlc3BvbnNlID0gbmV3IEluY29taW5nTWVzc2FnZShzZWxmLl94aHIsIHNlbGYuX2ZldGNoUmVzcG9uc2UsIHNlbGYuX21vZGUpCgkJc2VsZi5fcmVzcG9uc2Uub24oJ2Vycm9yJywgZnVuY3Rpb24oZXJyKSB7CgkJCXNlbGYuZW1pdCgnZXJyb3InLCBlcnIpCgkJfSkKCgkJc2VsZi5lbWl0KCdyZXNwb25zZScsIHNlbGYuX3Jlc3BvbnNlKQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLl93cml0ZSA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgoJCXNlbGYuX2JvZHkucHVzaChjaHVuaykKCQljYigpCgl9CgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuYWJvcnQgPSBDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkgewoJCXZhciBzZWxmID0gdGhpcwoJCXNlbGYuX2Rlc3Ryb3llZCA9IHRydWUKCQlpZiAoc2VsZi5fcmVzcG9uc2UpCgkJCXNlbGYuX3Jlc3BvbnNlLl9kZXN0cm95ZWQgPSB0cnVlCgkJaWYgKHNlbGYuX3hocikKCQkJc2VsZi5feGhyLmFib3J0KCkKCQkvLyBDdXJyZW50bHksIHRoZXJlIGlzbid0IGEgd2F5IHRvIHRydWx5IGFib3J0IGEgZmV0Y2guCgkJLy8gSWYgeW91IGxpa2UgYmlrZXNoZWRkaW5nLCBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3doYXR3Zy9mZXRjaC9pc3N1ZXMvMjcKCX0KCglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5lbmQgPSBmdW5jdGlvbiAoZGF0YSwgZW5jb2RpbmcsIGNiKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJaWYgKHR5cGVvZiBkYXRhID09PSAnZnVuY3Rpb24nKSB7CgkJCWNiID0gZGF0YQoJCQlkYXRhID0gdW5kZWZpbmVkCgkJfQoKCQlzdHJlYW0uV3JpdGFibGUucHJvdG90eXBlLmVuZC5jYWxsKHNlbGYsIGRhdGEsIGVuY29kaW5nLCBjYikKCX0KCglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5mbHVzaEhlYWRlcnMgPSBmdW5jdGlvbiAoKSB7fQoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuc2V0VGltZW91dCA9IGZ1bmN0aW9uICgpIHt9CglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5zZXROb0RlbGF5ID0gZnVuY3Rpb24gKCkge30KCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLnNldFNvY2tldEtlZXBBbGl2ZSA9IGZ1bmN0aW9uICgpIHt9CgoJLy8gVGFrZW4gZnJvbSBodHRwOi8vd3d3LnczLm9yZy9UUi9YTUxIdHRwUmVxdWVzdC8jdGhlLXNldHJlcXVlc3RoZWFkZXIlMjglMjktbWV0aG9kCgl2YXIgdW5zYWZlSGVhZGVycyA9IFsKCQknYWNjZXB0LWNoYXJzZXQnLAoJCSdhY2NlcHQtZW5jb2RpbmcnLAoJCSdhY2Nlc3MtY29udHJvbC1yZXF1ZXN0LWhlYWRlcnMnLAoJCSdhY2Nlc3MtY29udHJvbC1yZXF1ZXN0LW1ldGhvZCcsCgkJJ2Nvbm5lY3Rpb24nLAoJCSdjb250ZW50LWxlbmd0aCcsCgkJJ2Nvb2tpZScsCgkJJ2Nvb2tpZTInLAoJCSdkYXRlJywKCQknZG50JywKCQknZXhwZWN0JywKCQknaG9zdCcsCgkJJ2tlZXAtYWxpdmUnLAoJCSdvcmlnaW4nLAoJCSdyZWZlcmVyJywKCQkndGUnLAoJCSd0cmFpbGVyJywKCQkndHJhbnNmZXItZW5jb2RpbmcnLAoJCSd1cGdyYWRlJywKCQkndXNlci1hZ2VudCcsCgkJJ3ZpYScKCV0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg2KS5CdWZmZXIsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSksIF9fd2VicGFja19yZXF1aXJlX18oMTIpKSkKCi8qKiovIH0sCi8qIDEyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlcgoJdmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9OwoKCS8vIGNhY2hlZCBmcm9tIHdoYXRldmVyIGdsb2JhbCBpcyBwcmVzZW50IHNvIHRoYXQgdGVzdCBydW5uZXJzIHRoYXQgc3R1YiBpdAoJLy8gZG9uJ3QgYnJlYWsgdGhpbmdzLiAgQnV0IHdlIG5lZWQgdG8gd3JhcCBpdCBpbiBhIHRyeSBjYXRjaCBpbiBjYXNlIGl0IGlzCgkvLyB3cmFwcGVkIGluIHN0cmljdCBtb2RlIGNvZGUgd2hpY2ggZG9lc24ndCBkZWZpbmUgYW55IGdsb2JhbHMuICBJdCdzIGluc2lkZSBhCgkvLyBmdW5jdGlvbiBiZWNhdXNlIHRyeS9jYXRjaGVzIGRlb3B0aW1pemUgaW4gY2VydGFpbiBlbmdpbmVzLgoKCXZhciBjYWNoZWRTZXRUaW1lb3V0OwoJdmFyIGNhY2hlZENsZWFyVGltZW91dDsKCglmdW5jdGlvbiBkZWZhdWx0U2V0VGltb3V0KCkgewoJICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpOwoJfQoJZnVuY3Rpb24gZGVmYXVsdENsZWFyVGltZW91dCAoKSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTsKCX0KCShmdW5jdGlvbiAoKSB7CgkgICAgdHJ5IHsKCSAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0OwoJICAgICAgICB9CgkgICAgfSBjYXRjaCAoZSkgewoJICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDsKCSAgICB9CgkgICAgdHJ5IHsKCSAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHsKCSAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7CgkgICAgICAgIH0KCSAgICB9IGNhdGNoIChlKSB7CgkgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7CgkgICAgfQoJfSAoKSkKCWZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7CgkgICAgaWYgKGNhY2hlZFNldFRpbWVvdXQgPT09IHNldFRpbWVvdXQpIHsKCSAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zCgkgICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7CgkgICAgfQoJICAgIC8vIGlmIHNldFRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkCgkgICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7CgkgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0OwoJICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApOwoJICAgIH0KCSAgICB0cnkgewoJICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzCgkgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7CgkgICAgfSBjYXRjaChlKXsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseQoJICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbChudWxsLCBmdW4sIDApOwoJICAgICAgICB9IGNhdGNoKGUpewoJICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IKCSAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwodGhpcywgZnVuLCAwKTsKCSAgICAgICAgfQoJICAgIH0KCgoJfQoJZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikgewoJICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkgewoJICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnMKCSAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpOwoJICAgIH0KCSAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkCgkgICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7CgkgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDsKCSAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpOwoJICAgIH0KCSAgICB0cnkgewoJICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzCgkgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTsKCSAgICB9IGNhdGNoIChlKXsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHkKCSAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpOwoJICAgICAgICB9IGNhdGNoIChlKXsKCSAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLgoJICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dAoJICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7CgkgICAgICAgIH0KCSAgICB9CgoKCgl9Cgl2YXIgcXVldWUgPSBbXTsKCXZhciBkcmFpbmluZyA9IGZhbHNlOwoJdmFyIGN1cnJlbnRRdWV1ZTsKCXZhciBxdWV1ZUluZGV4ID0gLTE7CgoJZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkgewoJICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkgewoJICAgICAgICByZXR1cm47CgkgICAgfQoJICAgIGRyYWluaW5nID0gZmFsc2U7CgkgICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHsKCSAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTsKCSAgICB9IGVsc2UgewoJICAgICAgICBxdWV1ZUluZGV4ID0gLTE7CgkgICAgfQoJICAgIGlmIChxdWV1ZS5sZW5ndGgpIHsKCSAgICAgICAgZHJhaW5RdWV1ZSgpOwoJICAgIH0KCX0KCglmdW5jdGlvbiBkcmFpblF1ZXVlKCkgewoJICAgIGlmIChkcmFpbmluZykgewoJICAgICAgICByZXR1cm47CgkgICAgfQoJICAgIHZhciB0aW1lb3V0ID0gcnVuVGltZW91dChjbGVhblVwTmV4dFRpY2spOwoJICAgIGRyYWluaW5nID0gdHJ1ZTsKCgkgICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDsKCSAgICB3aGlsZShsZW4pIHsKCSAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7CgkgICAgICAgIHF1ZXVlID0gW107CgkgICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHsKCSAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHsKCSAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcXVldWVJbmRleCA9IC0xOwoJICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7CgkgICAgfQoJICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7CgkgICAgZHJhaW5pbmcgPSBmYWxzZTsKCSAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7Cgl9CgoJcHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHsKCSAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7CgkgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTsKCSAgICAgICAgfQoJICAgIH0KCSAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpOwoJICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7CgkgICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7CgkgICAgfQoJfTsKCgkvLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzCglmdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHsKCSAgICB0aGlzLmZ1biA9IGZ1bjsKCSAgICB0aGlzLmFycmF5ID0gYXJyYXk7Cgl9CglJdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7CgkgICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7Cgl9OwoJcHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJzsKCXByb2Nlc3MuYnJvd3NlciA9IHRydWU7Cglwcm9jZXNzLmVudiA9IHt9OwoJcHJvY2Vzcy5hcmd2ID0gW107Cglwcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXMKCXByb2Nlc3MudmVyc2lvbnMgPSB7fTsKCglmdW5jdGlvbiBub29wKCkge30KCglwcm9jZXNzLm9uID0gbm9vcDsKCXByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wOwoJcHJvY2Vzcy5vbmNlID0gbm9vcDsKCXByb2Nlc3Mub2ZmID0gbm9vcDsKCXByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wOwoJcHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wOwoJcHJvY2Vzcy5lbWl0ID0gbm9vcDsKCglwcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTsKCX07CgoJcHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTsKCXByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTsKCX07Cglwcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9OwoKCi8qKiovIH0sCi8qIDEzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHtleHBvcnRzLmZldGNoID0gaXNGdW5jdGlvbihnbG9iYWwuZmV0Y2gpICYmIGlzRnVuY3Rpb24oZ2xvYmFsLlJlYWRhYmxlU3RyZWFtKQoKCWV4cG9ydHMuYmxvYkNvbnN0cnVjdG9yID0gZmFsc2UKCXRyeSB7CgkJbmV3IEJsb2IoW25ldyBBcnJheUJ1ZmZlcigxKV0pCgkJZXhwb3J0cy5ibG9iQ29uc3RydWN0b3IgPSB0cnVlCgl9IGNhdGNoIChlKSB7fQoKCS8vIFRoZSB4aHIgcmVxdWVzdCB0byBleGFtcGxlLmNvbSBtYXkgdmlvbGF0ZSBzb21lIHJlc3RyaWN0aXZlIENTUCBjb25maWd1cmF0aW9ucywKCS8vIHNvIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gYSBicm93c2VyIHRoYXQgc3VwcG9ydHMgYGZldGNoYCwgYXZvaWQgY2FsbGluZyBnZXRYSFIoKQoJLy8gYW5kIGFzc3VtZSBzdXBwb3J0IGZvciBjZXJ0YWluIGZlYXR1cmVzIGJlbG93LgoJdmFyIHhocgoJZnVuY3Rpb24gZ2V0WEhSICgpIHsKCQkvLyBDYWNoZSB0aGUgeGhyIHZhbHVlCgkJaWYgKHhociAhPT0gdW5kZWZpbmVkKSByZXR1cm4geGhyCgoJCWlmIChnbG9iYWwuWE1MSHR0cFJlcXVlc3QpIHsKCQkJeGhyID0gbmV3IGdsb2JhbC5YTUxIdHRwUmVxdWVzdCgpCgkJCS8vIElmIFhEb21haW5SZXF1ZXN0IGlzIGF2YWlsYWJsZSAoaWUgb25seSwgd2hlcmUgeGhyIG1pZ2h0IG5vdCB3b3JrCgkJCS8vIGNyb3NzIGRvbWFpbiksIHVzZSB0aGUgcGFnZSBsb2NhdGlvbi4gT3RoZXJ3aXNlIHVzZSBleGFtcGxlLmNvbQoJCQkvLyBOb3RlOiB0aGlzIGRvZXNuJ3QgYWN0dWFsbHkgbWFrZSBhbiBodHRwIHJlcXVlc3QuCgkJCXRyeSB7CgkJCQl4aHIub3BlbignR0VUJywgZ2xvYmFsLlhEb21haW5SZXF1ZXN0ID8gJy8nIDogJ2h0dHBzOi8vZXhhbXBsZS5jb20nKQoJCQl9IGNhdGNoKGUpIHsKCQkJCXhociA9IG51bGwKCQkJfQoJCX0gZWxzZSB7CgkJCS8vIFNlcnZpY2Ugd29ya2VycyBkb24ndCBoYXZlIFhIUgoJCQl4aHIgPSBudWxsCgkJfQoJCXJldHVybiB4aHIKCX0KCglmdW5jdGlvbiBjaGVja1R5cGVTdXBwb3J0ICh0eXBlKSB7CgkJdmFyIHhociA9IGdldFhIUigpCgkJaWYgKCF4aHIpIHJldHVybiBmYWxzZQoJCXRyeSB7CgkJCXhoci5yZXNwb25zZVR5cGUgPSB0eXBlCgkJCXJldHVybiB4aHIucmVzcG9uc2VUeXBlID09PSB0eXBlCgkJfSBjYXRjaCAoZSkge30KCQlyZXR1cm4gZmFsc2UKCX0KCgkvLyBGb3Igc29tZSBzdHJhbmdlIHJlYXNvbiwgU2FmYXJpIDcuMCByZXBvcnRzIHR5cGVvZiBnbG9iYWwuQXJyYXlCdWZmZXIgPT09ICdvYmplY3QnLgoJLy8gU2FmYXJpIDcuMSBhcHBlYXJzIHRvIGhhdmUgZml4ZWQgdGhpcyBidWcuCgl2YXIgaGF2ZUFycmF5QnVmZmVyID0gdHlwZW9mIGdsb2JhbC5BcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcKCXZhciBoYXZlU2xpY2UgPSBoYXZlQXJyYXlCdWZmZXIgJiYgaXNGdW5jdGlvbihnbG9iYWwuQXJyYXlCdWZmZXIucHJvdG90eXBlLnNsaWNlKQoKCS8vIElmIGZldGNoIGlzIHN1cHBvcnRlZCwgdGhlbiBhcnJheWJ1ZmZlciB3aWxsIGJlIHN1cHBvcnRlZCB0b28uIFNraXAgY2FsbGluZwoJLy8gY2hlY2tUeXBlU3VwcG9ydCgpLCBzaW5jZSB0aGF0IGNhbGxzIGdldFhIUigpLgoJZXhwb3J0cy5hcnJheWJ1ZmZlciA9IGV4cG9ydHMuZmV0Y2ggfHwgKGhhdmVBcnJheUJ1ZmZlciAmJiBjaGVja1R5cGVTdXBwb3J0KCdhcnJheWJ1ZmZlcicpKQoKCS8vIFRoZXNlIG5leHQgdHdvIHRlc3RzIHVuYXZvaWRhYmx5IHNob3cgd2FybmluZ3MgaW4gQ2hyb21lLiBTaW5jZSBmZXRjaCB3aWxsIGFsd2F5cwoJLy8gYmUgdXNlZCBpZiBpdCdzIGF2YWlsYWJsZSwganVzdCByZXR1cm4gZmFsc2UgZm9yIHRoZXNlIHRvIGF2b2lkIHRoZSB3YXJuaW5ncy4KCWV4cG9ydHMubXNzdHJlYW0gPSAhZXhwb3J0cy5mZXRjaCAmJiBoYXZlU2xpY2UgJiYgY2hlY2tUeXBlU3VwcG9ydCgnbXMtc3RyZWFtJykKCWV4cG9ydHMubW96Y2h1bmtlZGFycmF5YnVmZmVyID0gIWV4cG9ydHMuZmV0Y2ggJiYgaGF2ZUFycmF5QnVmZmVyICYmCgkJY2hlY2tUeXBlU3VwcG9ydCgnbW96LWNodW5rZWQtYXJyYXlidWZmZXInKQoKCS8vIElmIGZldGNoIGlzIHN1cHBvcnRlZCwgdGhlbiBvdmVycmlkZU1pbWVUeXBlIHdpbGwgYmUgc3VwcG9ydGVkIHRvby4gU2tpcCBjYWxsaW5nCgkvLyBnZXRYSFIoKS4KCWV4cG9ydHMub3ZlcnJpZGVNaW1lVHlwZSA9IGV4cG9ydHMuZmV0Y2ggfHwgKGdldFhIUigpID8gaXNGdW5jdGlvbihnZXRYSFIoKS5vdmVycmlkZU1pbWVUeXBlKSA6IGZhbHNlKQoKCWV4cG9ydHMudmJBcnJheSA9IGlzRnVuY3Rpb24oZ2xvYmFsLlZCQXJyYXkpCgoJZnVuY3Rpb24gaXNGdW5jdGlvbiAodmFsdWUpIHsKCQlyZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nCgl9CgoJeGhyID0gbnVsbCAvLyBIZWxwIGdjCgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKQoKLyoqKi8gfSwKLyogMTQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJaWYgKHR5cGVvZiBPYmplY3QuY3JlYXRlID09PSAnZnVuY3Rpb24nKSB7CgkgIC8vIGltcGxlbWVudGF0aW9uIGZyb20gc3RhbmRhcmQgbm9kZS5qcyAndXRpbCcgbW9kdWxlCgkgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaW5oZXJpdHMoY3Rvciwgc3VwZXJDdG9yKSB7CgkgICAgY3Rvci5zdXBlcl8gPSBzdXBlckN0b3IKCSAgICBjdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDdG9yLnByb3RvdHlwZSwgewoJICAgICAgY29uc3RydWN0b3I6IHsKCSAgICAgICAgdmFsdWU6IGN0b3IsCgkgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLAoJICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlCgkgICAgICB9CgkgICAgfSk7CgkgIH07Cgl9IGVsc2UgewoJICAvLyBvbGQgc2Nob29sIHNoaW0gZm9yIG9sZCBicm93c2VycwoJICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluaGVyaXRzKGN0b3IsIHN1cGVyQ3RvcikgewoJICAgIGN0b3Iuc3VwZXJfID0gc3VwZXJDdG9yCgkgICAgdmFyIFRlbXBDdG9yID0gZnVuY3Rpb24gKCkge30KCSAgICBUZW1wQ3Rvci5wcm90b3R5cGUgPSBzdXBlckN0b3IucHJvdG90eXBlCgkgICAgY3Rvci5wcm90b3R5cGUgPSBuZXcgVGVtcEN0b3IoKQoJICAgIGN0b3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gY3RvcgoJICB9Cgl9CgoKLyoqKi8gfSwKLyogMTUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKHByb2Nlc3MsIEJ1ZmZlciwgZ2xvYmFsKSB7dmFyIGNhcGFiaWxpdHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQoJdmFyIGluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKCXZhciBzdHJlYW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQoKCXZhciByU3RhdGVzID0gZXhwb3J0cy5yZWFkeVN0YXRlcyA9IHsKCQlVTlNFTlQ6IDAsCgkJT1BFTkVEOiAxLAoJCUhFQURFUlNfUkVDRUlWRUQ6IDIsCgkJTE9BRElORzogMywKCQlET05FOiA0Cgl9CgoJdmFyIEluY29taW5nTWVzc2FnZSA9IGV4cG9ydHMuSW5jb21pbmdNZXNzYWdlID0gZnVuY3Rpb24gKHhociwgcmVzcG9uc2UsIG1vZGUpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCQlzdHJlYW0uUmVhZGFibGUuY2FsbChzZWxmKQoKCQlzZWxmLl9tb2RlID0gbW9kZQoJCXNlbGYuaGVhZGVycyA9IHt9CgkJc2VsZi5yYXdIZWFkZXJzID0gW10KCQlzZWxmLnRyYWlsZXJzID0ge30KCQlzZWxmLnJhd1RyYWlsZXJzID0gW10KCgkJLy8gRmFrZSB0aGUgJ2Nsb3NlJyBldmVudCwgYnV0IG9ubHkgb25jZSAnZW5kJyBmaXJlcwoJCXNlbGYub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsKCQkJLy8gVGhlIG5leHRUaWNrIGlzIG5lY2Vzc2FyeSB0byBwcmV2ZW50IHRoZSAncmVxdWVzdCcgbW9kdWxlIGZyb20gY2F1c2luZyBhbiBpbmZpbml0ZSBsb29wCgkJCXByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gKCkgewoJCQkJc2VsZi5lbWl0KCdjbG9zZScpCgkJCX0pCgkJfSkKCgkJaWYgKG1vZGUgPT09ICdmZXRjaCcpIHsKCQkJc2VsZi5fZmV0Y2hSZXNwb25zZSA9IHJlc3BvbnNlCgoJCQlzZWxmLnVybCA9IHJlc3BvbnNlLnVybAoJCQlzZWxmLnN0YXR1c0NvZGUgPSByZXNwb25zZS5zdGF0dXMKCQkJc2VsZi5zdGF0dXNNZXNzYWdlID0gcmVzcG9uc2Uuc3RhdHVzVGV4dAoJCQkKCQkJcmVzcG9uc2UuaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKGhlYWRlciwga2V5KXsKCQkJCXNlbGYuaGVhZGVyc1trZXkudG9Mb3dlckNhc2UoKV0gPSBoZWFkZXIKCQkJCXNlbGYucmF3SGVhZGVycy5wdXNoKGtleSwgaGVhZGVyKQoJCQl9KQoKCgkJCS8vIFRPRE86IHRoaXMgZG9lc24ndCByZXNwZWN0IGJhY2twcmVzc3VyZS4gT25jZSBXcml0YWJsZVN0cmVhbSBpcyBhdmFpbGFibGUsIHRoaXMgY2FuIGJlIGZpeGVkCgkJCXZhciByZWFkZXIgPSByZXNwb25zZS5ib2R5LmdldFJlYWRlcigpCgkJCWZ1bmN0aW9uIHJlYWQgKCkgewoJCQkJcmVhZGVyLnJlYWQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKCQkJCQlpZiAoc2VsZi5fZGVzdHJveWVkKQoJCQkJCQlyZXR1cm4KCQkJCQlpZiAocmVzdWx0LmRvbmUpIHsKCQkJCQkJc2VsZi5wdXNoKG51bGwpCgkJCQkJCXJldHVybgoJCQkJCX0KCQkJCQlzZWxmLnB1c2gobmV3IEJ1ZmZlcihyZXN1bHQudmFsdWUpKQoJCQkJCXJlYWQoKQoJCQkJfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7CgkJCQkJc2VsZi5lbWl0KCdlcnJvcicsIGVycikKCQkJCX0pCgkJCX0KCQkJcmVhZCgpCgoJCX0gZWxzZSB7CgkJCXNlbGYuX3hociA9IHhocgoJCQlzZWxmLl9wb3MgPSAwCgoJCQlzZWxmLnVybCA9IHhoci5yZXNwb25zZVVSTAoJCQlzZWxmLnN0YXR1c0NvZGUgPSB4aHIuc3RhdHVzCgkJCXNlbGYuc3RhdHVzTWVzc2FnZSA9IHhoci5zdGF0dXNUZXh0CgkJCXZhciBoZWFkZXJzID0geGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpLnNwbGl0KC9ccj9cbi8pCgkJCWhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbiAoaGVhZGVyKSB7CgkJCQl2YXIgbWF0Y2hlcyA9IGhlYWRlci5tYXRjaCgvXihbXjpdKyk6XHMqKC4qKS8pCgkJCQlpZiAobWF0Y2hlcykgewoJCQkJCXZhciBrZXkgPSBtYXRjaGVzWzFdLnRvTG93ZXJDYXNlKCkKCQkJCQlpZiAoa2V5ID09PSAnc2V0LWNvb2tpZScpIHsKCQkJCQkJaWYgKHNlbGYuaGVhZGVyc1trZXldID09PSB1bmRlZmluZWQpIHsKCQkJCQkJCXNlbGYuaGVhZGVyc1trZXldID0gW10KCQkJCQkJfQoJCQkJCQlzZWxmLmhlYWRlcnNba2V5XS5wdXNoKG1hdGNoZXNbMl0pCgkJCQkJfSBlbHNlIGlmIChzZWxmLmhlYWRlcnNba2V5XSAhPT0gdW5kZWZpbmVkKSB7CgkJCQkJCXNlbGYuaGVhZGVyc1trZXldICs9ICcsICcgKyBtYXRjaGVzWzJdCgkJCQkJfSBlbHNlIHsKCQkJCQkJc2VsZi5oZWFkZXJzW2tleV0gPSBtYXRjaGVzWzJdCgkJCQkJfQoJCQkJCXNlbGYucmF3SGVhZGVycy5wdXNoKG1hdGNoZXNbMV0sIG1hdGNoZXNbMl0pCgkJCQl9CgkJCX0pCgoJCQlzZWxmLl9jaGFyc2V0ID0gJ3gtdXNlci1kZWZpbmVkJwoJCQlpZiAoIWNhcGFiaWxpdHkub3ZlcnJpZGVNaW1lVHlwZSkgewoJCQkJdmFyIG1pbWVUeXBlID0gc2VsZi5yYXdIZWFkZXJzWydtaW1lLXR5cGUnXQoJCQkJaWYgKG1pbWVUeXBlKSB7CgkJCQkJdmFyIGNoYXJzZXRNYXRjaCA9IG1pbWVUeXBlLm1hdGNoKC87XHMqY2hhcnNldD0oW147XSkoO3wkKS8pCgkJCQkJaWYgKGNoYXJzZXRNYXRjaCkgewoJCQkJCQlzZWxmLl9jaGFyc2V0ID0gY2hhcnNldE1hdGNoWzFdLnRvTG93ZXJDYXNlKCkKCQkJCQl9CgkJCQl9CgkJCQlpZiAoIXNlbGYuX2NoYXJzZXQpCgkJCQkJc2VsZi5fY2hhcnNldCA9ICd1dGYtOCcgLy8gYmVzdCBndWVzcwoJCQl9CgkJfQoJfQoKCWluaGVyaXRzKEluY29taW5nTWVzc2FnZSwgc3RyZWFtLlJlYWRhYmxlKQoKCUluY29taW5nTWVzc2FnZS5wcm90b3R5cGUuX3JlYWQgPSBmdW5jdGlvbiAoKSB7fQoKCUluY29taW5nTWVzc2FnZS5wcm90b3R5cGUuX29uWEhSUHJvZ3Jlc3MgPSBmdW5jdGlvbiAoKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgoJCXZhciB4aHIgPSBzZWxmLl94aHIKCgkJdmFyIHJlc3BvbnNlID0gbnVsbAoJCXN3aXRjaCAoc2VsZi5fbW9kZSkgewoJCQljYXNlICd0ZXh0OnZiYXJyYXknOiAvLyBGb3IgSUU5CgkJCQlpZiAoeGhyLnJlYWR5U3RhdGUgIT09IHJTdGF0ZXMuRE9ORSkKCQkJCQlicmVhawoJCQkJdHJ5IHsKCQkJCQkvLyBUaGlzIGZhaWxzIGluIElFOAoJCQkJCXJlc3BvbnNlID0gbmV3IGdsb2JhbC5WQkFycmF5KHhoci5yZXNwb25zZUJvZHkpLnRvQXJyYXkoKQoJCQkJfSBjYXRjaCAoZSkge30KCQkJCWlmIChyZXNwb25zZSAhPT0gbnVsbCkgewoJCQkJCXNlbGYucHVzaChuZXcgQnVmZmVyKHJlc3BvbnNlKSkKCQkJCQlicmVhawoJCQkJfQoJCQkJLy8gRmFsbHMgdGhyb3VnaCBpbiBJRTgJCgkJCWNhc2UgJ3RleHQnOgoJCQkJdHJ5IHsgLy8gVGhpcyB3aWxsIGZhaWwgd2hlbiByZWFkeVN0YXRlID0gMyBpbiBJRTkuIFN3aXRjaCBtb2RlIGFuZCB3YWl0IGZvciByZWFkeVN0YXRlID0gNAoJCQkJCXJlc3BvbnNlID0geGhyLnJlc3BvbnNlVGV4dAoJCQkJfSBjYXRjaCAoZSkgewoJCQkJCXNlbGYuX21vZGUgPSAndGV4dDp2YmFycmF5JwoJCQkJCWJyZWFrCgkJCQl9CgkJCQlpZiAocmVzcG9uc2UubGVuZ3RoID4gc2VsZi5fcG9zKSB7CgkJCQkJdmFyIG5ld0RhdGEgPSByZXNwb25zZS5zdWJzdHIoc2VsZi5fcG9zKQoJCQkJCWlmIChzZWxmLl9jaGFyc2V0ID09PSAneC11c2VyLWRlZmluZWQnKSB7CgkJCQkJCXZhciBidWZmZXIgPSBuZXcgQnVmZmVyKG5ld0RhdGEubGVuZ3RoKQoJCQkJCQlmb3IgKHZhciBpID0gMDsgaSA8IG5ld0RhdGEubGVuZ3RoOyBpKyspCgkJCQkJCQlidWZmZXJbaV0gPSBuZXdEYXRhLmNoYXJDb2RlQXQoaSkgJiAweGZmCgoJCQkJCQlzZWxmLnB1c2goYnVmZmVyKQoJCQkJCX0gZWxzZSB7CgkJCQkJCXNlbGYucHVzaChuZXdEYXRhLCBzZWxmLl9jaGFyc2V0KQoJCQkJCX0KCQkJCQlzZWxmLl9wb3MgPSByZXNwb25zZS5sZW5ndGgKCQkJCX0KCQkJCWJyZWFrCgkJCWNhc2UgJ2FycmF5YnVmZmVyJzoKCQkJCWlmICh4aHIucmVhZHlTdGF0ZSAhPT0gclN0YXRlcy5ET05FIHx8ICF4aHIucmVzcG9uc2UpCgkJCQkJYnJlYWsKCQkJCXJlc3BvbnNlID0geGhyLnJlc3BvbnNlCgkJCQlzZWxmLnB1c2gobmV3IEJ1ZmZlcihuZXcgVWludDhBcnJheShyZXNwb25zZSkpKQoJCQkJYnJlYWsKCQkJY2FzZSAnbW96LWNodW5rZWQtYXJyYXlidWZmZXInOiAvLyB0YWtlIHdob2xlCgkJCQlyZXNwb25zZSA9IHhoci5yZXNwb25zZQoJCQkJaWYgKHhoci5yZWFkeVN0YXRlICE9PSByU3RhdGVzLkxPQURJTkcgfHwgIXJlc3BvbnNlKQoJCQkJCWJyZWFrCgkJCQlzZWxmLnB1c2gobmV3IEJ1ZmZlcihuZXcgVWludDhBcnJheShyZXNwb25zZSkpKQoJCQkJYnJlYWsKCQkJY2FzZSAnbXMtc3RyZWFtJzoKCQkJCXJlc3BvbnNlID0geGhyLnJlc3BvbnNlCgkJCQlpZiAoeGhyLnJlYWR5U3RhdGUgIT09IHJTdGF0ZXMuTE9BRElORykKCQkJCQlicmVhawoJCQkJdmFyIHJlYWRlciA9IG5ldyBnbG9iYWwuTVNTdHJlYW1SZWFkZXIoKQoJCQkJcmVhZGVyLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbiAoKSB7CgkJCQkJaWYgKHJlYWRlci5yZXN1bHQuYnl0ZUxlbmd0aCA+IHNlbGYuX3BvcykgewoJCQkJCQlzZWxmLnB1c2gobmV3IEJ1ZmZlcihuZXcgVWludDhBcnJheShyZWFkZXIucmVzdWx0LnNsaWNlKHNlbGYuX3BvcykpKSkKCQkJCQkJc2VsZi5fcG9zID0gcmVhZGVyLnJlc3VsdC5ieXRlTGVuZ3RoCgkJCQkJfQoJCQkJfQoJCQkJcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKCQkJCQlzZWxmLnB1c2gobnVsbCkKCQkJCX0KCQkJCS8vIHJlYWRlci5vbmVycm9yID0gPz8/IC8vIFRPRE86IHRoaXMKCQkJCXJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihyZXNwb25zZSkKCQkJCWJyZWFrCgkJfQoKCQkvLyBUaGUgbXMtc3RyZWFtIGNhc2UgaGFuZGxlcyBlbmQgc2VwYXJhdGVseSBpbiByZWFkZXIub25sb2FkKCkKCQlpZiAoc2VsZi5feGhyLnJlYWR5U3RhdGUgPT09IHJTdGF0ZXMuRE9ORSAmJiBzZWxmLl9tb2RlICE9PSAnbXMtc3RyZWFtJykgewoJCQlzZWxmLnB1c2gobnVsbCkKCQl9Cgl9CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMTIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpLkJ1ZmZlciwgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpCgovKioqLyB9LAovKiAxNiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCWV4cG9ydHMuU3RyZWFtID0gZXhwb3J0czsKCWV4cG9ydHMuUmVhZGFibGUgPSBleHBvcnRzOwoJZXhwb3J0cy5Xcml0YWJsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpOwoJZXhwb3J0cy5EdXBsZXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTsKCWV4cG9ydHMuVHJhbnNmb3JtID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMyk7CglleHBvcnRzLlBhc3NUaHJvdWdoID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNCk7CgoKLyoqKi8gfSwKLyogMTcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKHByb2Nlc3MpIHsndXNlIHN0cmljdCc7CgoJbW9kdWxlLmV4cG9ydHMgPSBSZWFkYWJsZTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHByb2Nlc3NOZXh0VGljayA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBpc0FycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIER1cGxleDsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCVJlYWRhYmxlLlJlYWRhYmxlU3RhdGUgPSBSZWFkYWJsZVN0YXRlOwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgRUUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKS5FdmVudEVtaXR0ZXI7CgoJdmFyIEVFbGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uIChlbWl0dGVyLCB0eXBlKSB7CgkgIHJldHVybiBlbWl0dGVyLmxpc3RlbmVycyh0eXBlKS5sZW5ndGg7Cgl9OwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBTdHJlYW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXZhciBCdWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKS5CdWZmZXI7CgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIGJ1ZmZlclNoaW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgdXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwoJdXRpbC5pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBkZWJ1Z1V0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KTsKCXZhciBkZWJ1ZyA9IHZvaWQgMDsKCWlmIChkZWJ1Z1V0aWwgJiYgZGVidWdVdGlsLmRlYnVnbG9nKSB7CgkgIGRlYnVnID0gZGVidWdVdGlsLmRlYnVnbG9nKCdzdHJlYW0nKTsKCX0gZWxzZSB7CgkgIGRlYnVnID0gZnVuY3Rpb24gKCkge307Cgl9CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl2YXIgQnVmZmVyTGlzdCA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpOwoJdmFyIFN0cmluZ0RlY29kZXI7CgoJdXRpbC5pbmhlcml0cyhSZWFkYWJsZSwgU3RyZWFtKTsKCgl2YXIga1Byb3h5RXZlbnRzID0gWydlcnJvcicsICdjbG9zZScsICdkZXN0cm95JywgJ3BhdXNlJywgJ3Jlc3VtZSddOwoKCWZ1bmN0aW9uIHByZXBlbmRMaXN0ZW5lcihlbWl0dGVyLCBldmVudCwgZm4pIHsKCSAgLy8gU2FkbHkgdGhpcyBpcyBub3QgY2FjaGVhYmxlIGFzIHNvbWUgbGlicmFyaWVzIGJ1bmRsZSB0aGVpciBvd24KCSAgLy8gZXZlbnQgZW1pdHRlciBpbXBsZW1lbnRhdGlvbiB3aXRoIHRoZW0uCgkgIGlmICh0eXBlb2YgZW1pdHRlci5wcmVwZW5kTGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHsKCSAgICByZXR1cm4gZW1pdHRlci5wcmVwZW5kTGlzdGVuZXIoZXZlbnQsIGZuKTsKCSAgfSBlbHNlIHsKCSAgICAvLyBUaGlzIGlzIGEgaGFjayB0byBtYWtlIHN1cmUgdGhhdCBvdXIgZXJyb3IgaGFuZGxlciBpcyBhdHRhY2hlZCBiZWZvcmUgYW55CgkgICAgLy8gdXNlcmxhbmQgb25lcy4gIE5FVkVSIERPIFRISVMuIFRoaXMgaXMgaGVyZSBvbmx5IGJlY2F1c2UgdGhpcyBjb2RlIG5lZWRzCgkgICAgLy8gdG8gY29udGludWUgdG8gd29yayB3aXRoIG9sZGVyIHZlcnNpb25zIG9mIE5vZGUuanMgdGhhdCBkbyBub3QgaW5jbHVkZQoJICAgIC8vIHRoZSBwcmVwZW5kTGlzdGVuZXIoKSBtZXRob2QuIFRoZSBnb2FsIGlzIHRvIGV2ZW50dWFsbHkgcmVtb3ZlIHRoaXMgaGFjay4KCSAgICBpZiAoIWVtaXR0ZXIuX2V2ZW50cyB8fCAhZW1pdHRlci5fZXZlbnRzW2V2ZW50XSkgZW1pdHRlci5vbihldmVudCwgZm4pO2Vsc2UgaWYgKGlzQXJyYXkoZW1pdHRlci5fZXZlbnRzW2V2ZW50XSkpIGVtaXR0ZXIuX2V2ZW50c1tldmVudF0udW5zaGlmdChmbik7ZWxzZSBlbWl0dGVyLl9ldmVudHNbZXZlbnRdID0gW2ZuLCBlbWl0dGVyLl9ldmVudHNbZXZlbnRdXTsKCSAgfQoJfQoKCWZ1bmN0aW9uIFJlYWRhYmxlU3RhdGUob3B0aW9ucywgc3RyZWFtKSB7CgkgIER1cGxleCA9IER1cGxleCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTsKCgkgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKCSAgLy8gb2JqZWN0IHN0cmVhbSBmbGFnLiBVc2VkIHRvIG1ha2UgcmVhZChuKSBpZ25vcmUgbiBhbmQgdG8KCSAgLy8gbWFrZSBhbGwgdGhlIGJ1ZmZlciBtZXJnaW5nIGFuZCBsZW5ndGggY2hlY2tzIGdvIGF3YXkKCSAgdGhpcy5vYmplY3RNb2RlID0gISFvcHRpb25zLm9iamVjdE1vZGU7CgoJICBpZiAoc3RyZWFtIGluc3RhbmNlb2YgRHVwbGV4KSB0aGlzLm9iamVjdE1vZGUgPSB0aGlzLm9iamVjdE1vZGUgfHwgISFvcHRpb25zLnJlYWRhYmxlT2JqZWN0TW9kZTsKCgkgIC8vIHRoZSBwb2ludCBhdCB3aGljaCBpdCBzdG9wcyBjYWxsaW5nIF9yZWFkKCkgdG8gZmlsbCB0aGUgYnVmZmVyCgkgIC8vIE5vdGU6IDAgaXMgYSB2YWxpZCB2YWx1ZSwgbWVhbnMgImRvbid0IGNhbGwgX3JlYWQgcHJlZW1wdGl2ZWx5IGV2ZXIiCgkgIHZhciBod20gPSBvcHRpb25zLmhpZ2hXYXRlck1hcms7CgkgIHZhciBkZWZhdWx0SHdtID0gdGhpcy5vYmplY3RNb2RlID8gMTYgOiAxNiAqIDEwMjQ7CgkgIHRoaXMuaGlnaFdhdGVyTWFyayA9IGh3bSB8fCBod20gPT09IDAgPyBod20gOiBkZWZhdWx0SHdtOwoKCSAgLy8gY2FzdCB0byBpbnRzLgoJICB0aGlzLmhpZ2hXYXRlck1hcmsgPSB+fnRoaXMuaGlnaFdhdGVyTWFyazsKCgkgIC8vIEEgbGlua2VkIGxpc3QgaXMgdXNlZCB0byBzdG9yZSBkYXRhIGNodW5rcyBpbnN0ZWFkIG9mIGFuIGFycmF5IGJlY2F1c2UgdGhlCgkgIC8vIGxpbmtlZCBsaXN0IGNhbiByZW1vdmUgZWxlbWVudHMgZnJvbSB0aGUgYmVnaW5uaW5nIGZhc3RlciB0aGFuCgkgIC8vIGFycmF5LnNoaWZ0KCkKCSAgdGhpcy5idWZmZXIgPSBuZXcgQnVmZmVyTGlzdCgpOwoJICB0aGlzLmxlbmd0aCA9IDA7CgkgIHRoaXMucGlwZXMgPSBudWxsOwoJICB0aGlzLnBpcGVzQ291bnQgPSAwOwoJICB0aGlzLmZsb3dpbmcgPSBudWxsOwoJICB0aGlzLmVuZGVkID0gZmFsc2U7CgkgIHRoaXMuZW5kRW1pdHRlZCA9IGZhbHNlOwoJICB0aGlzLnJlYWRpbmcgPSBmYWxzZTsKCgkgIC8vIGEgZmxhZyB0byBiZSBhYmxlIHRvIHRlbGwgaWYgdGhlIG9ud3JpdGUgY2IgaXMgY2FsbGVkIGltbWVkaWF0ZWx5LAoJICAvLyBvciBvbiBhIGxhdGVyIHRpY2suICBXZSBzZXQgdGhpcyB0byB0cnVlIGF0IGZpcnN0LCBiZWNhdXNlIGFueQoJICAvLyBhY3Rpb25zIHRoYXQgc2hvdWxkbid0IGhhcHBlbiB1bnRpbCAibGF0ZXIiIHNob3VsZCBnZW5lcmFsbHkgYWxzbwoJICAvLyBub3QgaGFwcGVuIGJlZm9yZSB0aGUgZmlyc3Qgd3JpdGUgY2FsbC4KCSAgdGhpcy5zeW5jID0gdHJ1ZTsKCgkgIC8vIHdoZW5ldmVyIHdlIHJldHVybiBudWxsLCB0aGVuIHdlIHNldCBhIGZsYWcgdG8gc2F5CgkgIC8vIHRoYXQgd2UncmUgYXdhaXRpbmcgYSAncmVhZGFibGUnIGV2ZW50IGVtaXNzaW9uLgoJICB0aGlzLm5lZWRSZWFkYWJsZSA9IGZhbHNlOwoJICB0aGlzLmVtaXR0ZWRSZWFkYWJsZSA9IGZhbHNlOwoJICB0aGlzLnJlYWRhYmxlTGlzdGVuaW5nID0gZmFsc2U7CgkgIHRoaXMucmVzdW1lU2NoZWR1bGVkID0gZmFsc2U7CgoJICAvLyBDcnlwdG8gaXMga2luZCBvZiBvbGQgYW5kIGNydXN0eS4gIEhpc3RvcmljYWxseSwgaXRzIGRlZmF1bHQgc3RyaW5nCgkgIC8vIGVuY29kaW5nIGlzICdiaW5hcnknIHNvIHdlIGhhdmUgdG8gbWFrZSB0aGlzIGNvbmZpZ3VyYWJsZS4KCSAgLy8gRXZlcnl0aGluZyBlbHNlIGluIHRoZSB1bml2ZXJzZSB1c2VzICd1dGY4JywgdGhvdWdoLgoJICB0aGlzLmRlZmF1bHRFbmNvZGluZyA9IG9wdGlvbnMuZGVmYXVsdEVuY29kaW5nIHx8ICd1dGY4JzsKCgkgIC8vIHdoZW4gcGlwaW5nLCB3ZSBvbmx5IGNhcmUgYWJvdXQgJ3JlYWRhYmxlJyBldmVudHMgdGhhdCBoYXBwZW4KCSAgLy8gYWZ0ZXIgcmVhZCgpaW5nIGFsbCB0aGUgYnl0ZXMgYW5kIG5vdCBnZXR0aW5nIGFueSBwdXNoYmFjay4KCSAgdGhpcy5yYW5PdXQgPSBmYWxzZTsKCgkgIC8vIHRoZSBudW1iZXIgb2Ygd3JpdGVycyB0aGF0IGFyZSBhd2FpdGluZyBhIGRyYWluIGV2ZW50IGluIC5waXBlKClzCgkgIHRoaXMuYXdhaXREcmFpbiA9IDA7CgoJICAvLyBpZiB0cnVlLCBhIG1heWJlUmVhZE1vcmUgaGFzIGJlZW4gc2NoZWR1bGVkCgkgIHRoaXMucmVhZGluZ01vcmUgPSBmYWxzZTsKCgkgIHRoaXMuZGVjb2RlciA9IG51bGw7CgkgIHRoaXMuZW5jb2RpbmcgPSBudWxsOwoJICBpZiAob3B0aW9ucy5lbmNvZGluZykgewoJICAgIGlmICghU3RyaW5nRGVjb2RlcikgU3RyaW5nRGVjb2RlciA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpLlN0cmluZ0RlY29kZXI7CgkgICAgdGhpcy5kZWNvZGVyID0gbmV3IFN0cmluZ0RlY29kZXIob3B0aW9ucy5lbmNvZGluZyk7CgkgICAgdGhpcy5lbmNvZGluZyA9IG9wdGlvbnMuZW5jb2Rpbmc7CgkgIH0KCX0KCglmdW5jdGlvbiBSZWFkYWJsZShvcHRpb25zKSB7CgkgIER1cGxleCA9IER1cGxleCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTsKCgkgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBSZWFkYWJsZSkpIHJldHVybiBuZXcgUmVhZGFibGUob3B0aW9ucyk7CgoJICB0aGlzLl9yZWFkYWJsZVN0YXRlID0gbmV3IFJlYWRhYmxlU3RhdGUob3B0aW9ucywgdGhpcyk7CgoJICAvLyBsZWdhY3kKCSAgdGhpcy5yZWFkYWJsZSA9IHRydWU7CgoJICBpZiAob3B0aW9ucyAmJiB0eXBlb2Ygb3B0aW9ucy5yZWFkID09PSAnZnVuY3Rpb24nKSB0aGlzLl9yZWFkID0gb3B0aW9ucy5yZWFkOwoKCSAgU3RyZWFtLmNhbGwodGhpcyk7Cgl9CgoJLy8gTWFudWFsbHkgc2hvdmUgc29tZXRoaW5nIGludG8gdGhlIHJlYWQoKSBidWZmZXIuCgkvLyBUaGlzIHJldHVybnMgdHJ1ZSBpZiB0aGUgaGlnaFdhdGVyTWFyayBoYXMgbm90IGJlZW4gaGl0IHlldCwKCS8vIHNpbWlsYXIgdG8gaG93IFdyaXRhYmxlLndyaXRlKCkgcmV0dXJucyB0cnVlIGlmIHlvdSBzaG91bGQKCS8vIHdyaXRlKCkgc29tZSBtb3JlLgoJUmVhZGFibGUucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoY2h1bmssIGVuY29kaW5nKSB7CgkgIHZhciBzdGF0ZSA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgoJICBpZiAoIXN0YXRlLm9iamVjdE1vZGUgJiYgdHlwZW9mIGNodW5rID09PSAnc3RyaW5nJykgewoJICAgIGVuY29kaW5nID0gZW5jb2RpbmcgfHwgc3RhdGUuZGVmYXVsdEVuY29kaW5nOwoJICAgIGlmIChlbmNvZGluZyAhPT0gc3RhdGUuZW5jb2RpbmcpIHsKCSAgICAgIGNodW5rID0gYnVmZmVyU2hpbS5mcm9tKGNodW5rLCBlbmNvZGluZyk7CgkgICAgICBlbmNvZGluZyA9ICcnOwoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIHJlYWRhYmxlQWRkQ2h1bmsodGhpcywgc3RhdGUsIGNodW5rLCBlbmNvZGluZywgZmFsc2UpOwoJfTsKCgkvLyBVbnNoaWZ0IHNob3VsZCAqYWx3YXlzKiBiZSBzb21ldGhpbmcgZGlyZWN0bHkgb3V0IG9mIHJlYWQoKQoJUmVhZGFibGUucHJvdG90eXBlLnVuc2hpZnQgPSBmdW5jdGlvbiAoY2h1bmspIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsKCSAgcmV0dXJuIHJlYWRhYmxlQWRkQ2h1bmsodGhpcywgc3RhdGUsIGNodW5rLCAnJywgdHJ1ZSk7Cgl9OwoKCVJlYWRhYmxlLnByb3RvdHlwZS5pc1BhdXNlZCA9IGZ1bmN0aW9uICgpIHsKCSAgcmV0dXJuIHRoaXMuX3JlYWRhYmxlU3RhdGUuZmxvd2luZyA9PT0gZmFsc2U7Cgl9OwoKCWZ1bmN0aW9uIHJlYWRhYmxlQWRkQ2h1bmsoc3RyZWFtLCBzdGF0ZSwgY2h1bmssIGVuY29kaW5nLCBhZGRUb0Zyb250KSB7CgkgIHZhciBlciA9IGNodW5rSW52YWxpZChzdGF0ZSwgY2h1bmspOwoJICBpZiAoZXIpIHsKCSAgICBzdHJlYW0uZW1pdCgnZXJyb3InLCBlcik7CgkgIH0gZWxzZSBpZiAoY2h1bmsgPT09IG51bGwpIHsKCSAgICBzdGF0ZS5yZWFkaW5nID0gZmFsc2U7CgkgICAgb25Fb2ZDaHVuayhzdHJlYW0sIHN0YXRlKTsKCSAgfSBlbHNlIGlmIChzdGF0ZS5vYmplY3RNb2RlIHx8IGNodW5rICYmIGNodW5rLmxlbmd0aCA+IDApIHsKCSAgICBpZiAoc3RhdGUuZW5kZWQgJiYgIWFkZFRvRnJvbnQpIHsKCSAgICAgIHZhciBlID0gbmV3IEVycm9yKCdzdHJlYW0ucHVzaCgpIGFmdGVyIEVPRicpOwoJICAgICAgc3RyZWFtLmVtaXQoJ2Vycm9yJywgZSk7CgkgICAgfSBlbHNlIGlmIChzdGF0ZS5lbmRFbWl0dGVkICYmIGFkZFRvRnJvbnQpIHsKCSAgICAgIHZhciBfZSA9IG5ldyBFcnJvcignc3RyZWFtLnVuc2hpZnQoKSBhZnRlciBlbmQgZXZlbnQnKTsKCSAgICAgIHN0cmVhbS5lbWl0KCdlcnJvcicsIF9lKTsKCSAgICB9IGVsc2UgewoJICAgICAgdmFyIHNraXBBZGQ7CgkgICAgICBpZiAoc3RhdGUuZGVjb2RlciAmJiAhYWRkVG9Gcm9udCAmJiAhZW5jb2RpbmcpIHsKCSAgICAgICAgY2h1bmsgPSBzdGF0ZS5kZWNvZGVyLndyaXRlKGNodW5rKTsKCSAgICAgICAgc2tpcEFkZCA9ICFzdGF0ZS5vYmplY3RNb2RlICYmIGNodW5rLmxlbmd0aCA9PT0gMDsKCSAgICAgIH0KCgkgICAgICBpZiAoIWFkZFRvRnJvbnQpIHN0YXRlLnJlYWRpbmcgPSBmYWxzZTsKCgkgICAgICAvLyBEb24ndCBhZGQgdG8gdGhlIGJ1ZmZlciBpZiB3ZSd2ZSBkZWNvZGVkIHRvIGFuIGVtcHR5IHN0cmluZyBjaHVuayBhbmQKCSAgICAgIC8vIHdlJ3JlIG5vdCBpbiBvYmplY3QgbW9kZQoJICAgICAgaWYgKCFza2lwQWRkKSB7CgkgICAgICAgIC8vIGlmIHdlIHdhbnQgdGhlIGRhdGEgbm93LCBqdXN0IGVtaXQgaXQuCgkgICAgICAgIGlmIChzdGF0ZS5mbG93aW5nICYmIHN0YXRlLmxlbmd0aCA9PT0gMCAmJiAhc3RhdGUuc3luYykgewoJICAgICAgICAgIHN0cmVhbS5lbWl0KCdkYXRhJywgY2h1bmspOwoJICAgICAgICAgIHN0cmVhbS5yZWFkKDApOwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgYnVmZmVyIGluZm8uCgkgICAgICAgICAgc3RhdGUubGVuZ3RoICs9IHN0YXRlLm9iamVjdE1vZGUgPyAxIDogY2h1bmsubGVuZ3RoOwoJICAgICAgICAgIGlmIChhZGRUb0Zyb250KSBzdGF0ZS5idWZmZXIudW5zaGlmdChjaHVuayk7ZWxzZSBzdGF0ZS5idWZmZXIucHVzaChjaHVuayk7CgoJICAgICAgICAgIGlmIChzdGF0ZS5uZWVkUmVhZGFibGUpIGVtaXRSZWFkYWJsZShzdHJlYW0pOwoJICAgICAgICB9CgkgICAgICB9CgoJICAgICAgbWF5YmVSZWFkTW9yZShzdHJlYW0sIHN0YXRlKTsKCSAgICB9CgkgIH0gZWxzZSBpZiAoIWFkZFRvRnJvbnQpIHsKCSAgICBzdGF0ZS5yZWFkaW5nID0gZmFsc2U7CgkgIH0KCgkgIHJldHVybiBuZWVkTW9yZURhdGEoc3RhdGUpOwoJfQoKCS8vIGlmIGl0J3MgcGFzdCB0aGUgaGlnaCB3YXRlciBtYXJrLCB3ZSBjYW4gcHVzaCBpbiBzb21lIG1vcmUuCgkvLyBBbHNvLCBpZiB3ZSBoYXZlIG5vIGRhdGEgeWV0LCB3ZSBjYW4gc3RhbmQgc29tZQoJLy8gbW9yZSBieXRlcy4gIFRoaXMgaXMgdG8gd29yayBhcm91bmQgY2FzZXMgd2hlcmUgaHdtPTAsCgkvLyBzdWNoIGFzIHRoZSByZXBsLiAgQWxzbywgaWYgdGhlIHB1c2goKSB0cmlnZ2VyZWQgYQoJLy8gcmVhZGFibGUgZXZlbnQsIGFuZCB0aGUgdXNlciBjYWxsZWQgcmVhZChsYXJnZU51bWJlcikgc3VjaCB0aGF0CgkvLyBuZWVkUmVhZGFibGUgd2FzIHNldCwgdGhlbiB3ZSBvdWdodCB0byBwdXNoIG1vcmUsIHNvIHRoYXQgYW5vdGhlcgoJLy8gJ3JlYWRhYmxlJyBldmVudCB3aWxsIGJlIHRyaWdnZXJlZC4KCWZ1bmN0aW9uIG5lZWRNb3JlRGF0YShzdGF0ZSkgewoJICByZXR1cm4gIXN0YXRlLmVuZGVkICYmIChzdGF0ZS5uZWVkUmVhZGFibGUgfHwgc3RhdGUubGVuZ3RoIDwgc3RhdGUuaGlnaFdhdGVyTWFyayB8fCBzdGF0ZS5sZW5ndGggPT09IDApOwoJfQoKCS8vIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LgoJUmVhZGFibGUucHJvdG90eXBlLnNldEVuY29kaW5nID0gZnVuY3Rpb24gKGVuYykgewoJICBpZiAoIVN0cmluZ0RlY29kZXIpIFN0cmluZ0RlY29kZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKS5TdHJpbmdEZWNvZGVyOwoJICB0aGlzLl9yZWFkYWJsZVN0YXRlLmRlY29kZXIgPSBuZXcgU3RyaW5nRGVjb2RlcihlbmMpOwoJICB0aGlzLl9yZWFkYWJsZVN0YXRlLmVuY29kaW5nID0gZW5jOwoJICByZXR1cm4gdGhpczsKCX07CgoJLy8gRG9uJ3QgcmFpc2UgdGhlIGh3bSA+IDhNQgoJdmFyIE1BWF9IV00gPSAweDgwMDAwMDsKCWZ1bmN0aW9uIGNvbXB1dGVOZXdIaWdoV2F0ZXJNYXJrKG4pIHsKCSAgaWYgKG4gPj0gTUFYX0hXTSkgewoJICAgIG4gPSBNQVhfSFdNOwoJICB9IGVsc2UgewoJICAgIC8vIEdldCB0aGUgbmV4dCBoaWdoZXN0IHBvd2VyIG9mIDIgdG8gcHJldmVudCBpbmNyZWFzaW5nIGh3bSBleGNlc3NpdmVseSBpbgoJICAgIC8vIHRpbnkgYW1vdW50cwoJICAgIG4tLTsKCSAgICBuIHw9IG4gPj4+IDE7CgkgICAgbiB8PSBuID4+PiAyOwoJICAgIG4gfD0gbiA+Pj4gNDsKCSAgICBuIHw9IG4gPj4+IDg7CgkgICAgbiB8PSBuID4+PiAxNjsKCSAgICBuKys7CgkgIH0KCSAgcmV0dXJuIG47Cgl9CgoJLy8gVGhpcyBmdW5jdGlvbiBpcyBkZXNpZ25lZCB0byBiZSBpbmxpbmFibGUsIHNvIHBsZWFzZSB0YWtlIGNhcmUgd2hlbiBtYWtpbmcKCS8vIGNoYW5nZXMgdG8gdGhlIGZ1bmN0aW9uIGJvZHkuCglmdW5jdGlvbiBob3dNdWNoVG9SZWFkKG4sIHN0YXRlKSB7CgkgIGlmIChuIDw9IDAgfHwgc3RhdGUubGVuZ3RoID09PSAwICYmIHN0YXRlLmVuZGVkKSByZXR1cm4gMDsKCSAgaWYgKHN0YXRlLm9iamVjdE1vZGUpIHJldHVybiAxOwoJICBpZiAobiAhPT0gbikgewoJICAgIC8vIE9ubHkgZmxvdyBvbmUgYnVmZmVyIGF0IGEgdGltZQoJICAgIGlmIChzdGF0ZS5mbG93aW5nICYmIHN0YXRlLmxlbmd0aCkgcmV0dXJuIHN0YXRlLmJ1ZmZlci5oZWFkLmRhdGEubGVuZ3RoO2Vsc2UgcmV0dXJuIHN0YXRlLmxlbmd0aDsKCSAgfQoJICAvLyBJZiB3ZSdyZSBhc2tpbmcgZm9yIG1vcmUgdGhhbiB0aGUgY3VycmVudCBod20sIHRoZW4gcmFpc2UgdGhlIGh3bS4KCSAgaWYgKG4gPiBzdGF0ZS5oaWdoV2F0ZXJNYXJrKSBzdGF0ZS5oaWdoV2F0ZXJNYXJrID0gY29tcHV0ZU5ld0hpZ2hXYXRlck1hcmsobik7CgkgIGlmIChuIDw9IHN0YXRlLmxlbmd0aCkgcmV0dXJuIG47CgkgIC8vIERvbid0IGhhdmUgZW5vdWdoCgkgIGlmICghc3RhdGUuZW5kZWQpIHsKCSAgICBzdGF0ZS5uZWVkUmVhZGFibGUgPSB0cnVlOwoJICAgIHJldHVybiAwOwoJICB9CgkgIHJldHVybiBzdGF0ZS5sZW5ndGg7Cgl9CgoJLy8geW91IGNhbiBvdmVycmlkZSBlaXRoZXIgdGhpcyBtZXRob2QsIG9yIHRoZSBhc3luYyBfcmVhZChuKSBiZWxvdy4KCVJlYWRhYmxlLnByb3RvdHlwZS5yZWFkID0gZnVuY3Rpb24gKG4pIHsKCSAgZGVidWcoJ3JlYWQnLCBuKTsKCSAgbiA9IHBhcnNlSW50KG4sIDEwKTsKCSAgdmFyIHN0YXRlID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsKCSAgdmFyIG5PcmlnID0gbjsKCgkgIGlmIChuICE9PSAwKSBzdGF0ZS5lbWl0dGVkUmVhZGFibGUgPSBmYWxzZTsKCgkgIC8vIGlmIHdlJ3JlIGRvaW5nIHJlYWQoMCkgdG8gdHJpZ2dlciBhIHJlYWRhYmxlIGV2ZW50LCBidXQgd2UKCSAgLy8gYWxyZWFkeSBoYXZlIGEgYnVuY2ggb2YgZGF0YSBpbiB0aGUgYnVmZmVyLCB0aGVuIGp1c3QgdHJpZ2dlcgoJICAvLyB0aGUgJ3JlYWRhYmxlJyBldmVudCBhbmQgbW92ZSBvbi4KCSAgaWYgKG4gPT09IDAgJiYgc3RhdGUubmVlZFJlYWRhYmxlICYmIChzdGF0ZS5sZW5ndGggPj0gc3RhdGUuaGlnaFdhdGVyTWFyayB8fCBzdGF0ZS5lbmRlZCkpIHsKCSAgICBkZWJ1ZygncmVhZDogZW1pdFJlYWRhYmxlJywgc3RhdGUubGVuZ3RoLCBzdGF0ZS5lbmRlZCk7CgkgICAgaWYgKHN0YXRlLmxlbmd0aCA9PT0gMCAmJiBzdGF0ZS5lbmRlZCkgZW5kUmVhZGFibGUodGhpcyk7ZWxzZSBlbWl0UmVhZGFibGUodGhpcyk7CgkgICAgcmV0dXJuIG51bGw7CgkgIH0KCgkgIG4gPSBob3dNdWNoVG9SZWFkKG4sIHN0YXRlKTsKCgkgIC8vIGlmIHdlJ3ZlIGVuZGVkLCBhbmQgd2UncmUgbm93IGNsZWFyLCB0aGVuIGZpbmlzaCBpdCB1cC4KCSAgaWYgKG4gPT09IDAgJiYgc3RhdGUuZW5kZWQpIHsKCSAgICBpZiAoc3RhdGUubGVuZ3RoID09PSAwKSBlbmRSZWFkYWJsZSh0aGlzKTsKCSAgICByZXR1cm4gbnVsbDsKCSAgfQoKCSAgLy8gQWxsIHRoZSBhY3R1YWwgY2h1bmsgZ2VuZXJhdGlvbiBsb2dpYyBuZWVkcyB0byBiZQoJICAvLyAqYmVsb3cqIHRoZSBjYWxsIHRvIF9yZWFkLiAgVGhlIHJlYXNvbiBpcyB0aGF0IGluIGNlcnRhaW4KCSAgLy8gc3ludGhldGljIHN0cmVhbSBjYXNlcywgc3VjaCBhcyBwYXNzdGhyb3VnaCBzdHJlYW1zLCBfcmVhZAoJICAvLyBtYXkgYmUgYSBjb21wbGV0ZWx5IHN5bmNocm9ub3VzIG9wZXJhdGlvbiB3aGljaCBtYXkgY2hhbmdlCgkgIC8vIHRoZSBzdGF0ZSBvZiB0aGUgcmVhZCBidWZmZXIsIHByb3ZpZGluZyBlbm91Z2ggZGF0YSB3aGVuCgkgIC8vIGJlZm9yZSB0aGVyZSB3YXMgKm5vdCogZW5vdWdoLgoJICAvLwoJICAvLyBTbywgdGhlIHN0ZXBzIGFyZToKCSAgLy8gMS4gRmlndXJlIG91dCB3aGF0IHRoZSBzdGF0ZSBvZiB0aGluZ3Mgd2lsbCBiZSBhZnRlciB3ZSBkbwoJICAvLyBhIHJlYWQgZnJvbSB0aGUgYnVmZmVyLgoJICAvLwoJICAvLyAyLiBJZiB0aGF0IHJlc3VsdGluZyBzdGF0ZSB3aWxsIHRyaWdnZXIgYSBfcmVhZCwgdGhlbiBjYWxsIF9yZWFkLgoJICAvLyBOb3RlIHRoYXQgdGhpcyBtYXkgYmUgYXN5bmNocm9ub3VzLCBvciBzeW5jaHJvbm91cy4gIFllcywgaXQgaXMKCSAgLy8gZGVlcGx5IHVnbHkgdG8gd3JpdGUgQVBJcyB0aGlzIHdheSwgYnV0IHRoYXQgc3RpbGwgZG9lc24ndCBtZWFuCgkgIC8vIHRoYXQgdGhlIFJlYWRhYmxlIGNsYXNzIHNob3VsZCBiZWhhdmUgaW1wcm9wZXJseSwgYXMgc3RyZWFtcyBhcmUKCSAgLy8gZGVzaWduZWQgdG8gYmUgc3luYy9hc3luYyBhZ25vc3RpYy4KCSAgLy8gVGFrZSBub3RlIGlmIHRoZSBfcmVhZCBjYWxsIGlzIHN5bmMgb3IgYXN5bmMgKGllLCBpZiB0aGUgcmVhZCBjYWxsCgkgIC8vIGhhcyByZXR1cm5lZCB5ZXQpLCBzbyB0aGF0IHdlIGtub3cgd2hldGhlciBvciBub3QgaXQncyBzYWZlIHRvIGVtaXQKCSAgLy8gJ3JlYWRhYmxlJyBldGMuCgkgIC8vCgkgIC8vIDMuIEFjdHVhbGx5IHB1bGwgdGhlIHJlcXVlc3RlZCBjaHVua3Mgb3V0IG9mIHRoZSBidWZmZXIgYW5kIHJldHVybi4KCgkgIC8vIGlmIHdlIG5lZWQgYSByZWFkYWJsZSBldmVudCwgdGhlbiB3ZSBuZWVkIHRvIGRvIHNvbWUgcmVhZGluZy4KCSAgdmFyIGRvUmVhZCA9IHN0YXRlLm5lZWRSZWFkYWJsZTsKCSAgZGVidWcoJ25lZWQgcmVhZGFibGUnLCBkb1JlYWQpOwoKCSAgLy8gaWYgd2UgY3VycmVudGx5IGhhdmUgbGVzcyB0aGFuIHRoZSBoaWdoV2F0ZXJNYXJrLCB0aGVuIGFsc28gcmVhZCBzb21lCgkgIGlmIChzdGF0ZS5sZW5ndGggPT09IDAgfHwgc3RhdGUubGVuZ3RoIC0gbiA8IHN0YXRlLmhpZ2hXYXRlck1hcmspIHsKCSAgICBkb1JlYWQgPSB0cnVlOwoJICAgIGRlYnVnKCdsZW5ndGggbGVzcyB0aGFuIHdhdGVybWFyaycsIGRvUmVhZCk7CgkgIH0KCgkgIC8vIGhvd2V2ZXIsIGlmIHdlJ3ZlIGVuZGVkLCB0aGVuIHRoZXJlJ3Mgbm8gcG9pbnQsIGFuZCBpZiB3ZSdyZSBhbHJlYWR5CgkgIC8vIHJlYWRpbmcsIHRoZW4gaXQncyB1bm5lY2Vzc2FyeS4KCSAgaWYgKHN0YXRlLmVuZGVkIHx8IHN0YXRlLnJlYWRpbmcpIHsKCSAgICBkb1JlYWQgPSBmYWxzZTsKCSAgICBkZWJ1ZygncmVhZGluZyBvciBlbmRlZCcsIGRvUmVhZCk7CgkgIH0gZWxzZSBpZiAoZG9SZWFkKSB7CgkgICAgZGVidWcoJ2RvIHJlYWQnKTsKCSAgICBzdGF0ZS5yZWFkaW5nID0gdHJ1ZTsKCSAgICBzdGF0ZS5zeW5jID0gdHJ1ZTsKCSAgICAvLyBpZiB0aGUgbGVuZ3RoIGlzIGN1cnJlbnRseSB6ZXJvLCB0aGVuIHdlICpuZWVkKiBhIHJlYWRhYmxlIGV2ZW50LgoJICAgIGlmIChzdGF0ZS5sZW5ndGggPT09IDApIHN0YXRlLm5lZWRSZWFkYWJsZSA9IHRydWU7CgkgICAgLy8gY2FsbCBpbnRlcm5hbCByZWFkIG1ldGhvZAoJICAgIHRoaXMuX3JlYWQoc3RhdGUuaGlnaFdhdGVyTWFyayk7CgkgICAgc3RhdGUuc3luYyA9IGZhbHNlOwoJICAgIC8vIElmIF9yZWFkIHB1c2hlZCBkYXRhIHN5bmNocm9ub3VzbHksIHRoZW4gYHJlYWRpbmdgIHdpbGwgYmUgZmFsc2UsCgkgICAgLy8gYW5kIHdlIG5lZWQgdG8gcmUtZXZhbHVhdGUgaG93IG11Y2ggZGF0YSB3ZSBjYW4gcmV0dXJuIHRvIHRoZSB1c2VyLgoJICAgIGlmICghc3RhdGUucmVhZGluZykgbiA9IGhvd011Y2hUb1JlYWQobk9yaWcsIHN0YXRlKTsKCSAgfQoKCSAgdmFyIHJldDsKCSAgaWYgKG4gPiAwKSByZXQgPSBmcm9tTGlzdChuLCBzdGF0ZSk7ZWxzZSByZXQgPSBudWxsOwoKCSAgaWYgKHJldCA9PT0gbnVsbCkgewoJICAgIHN0YXRlLm5lZWRSZWFkYWJsZSA9IHRydWU7CgkgICAgbiA9IDA7CgkgIH0gZWxzZSB7CgkgICAgc3RhdGUubGVuZ3RoIC09IG47CgkgIH0KCgkgIGlmIChzdGF0ZS5sZW5ndGggPT09IDApIHsKCSAgICAvLyBJZiB3ZSBoYXZlIG5vdGhpbmcgaW4gdGhlIGJ1ZmZlciwgdGhlbiB3ZSB3YW50IHRvIGtub3cKCSAgICAvLyBhcyBzb29uIGFzIHdlICpkbyogZ2V0IHNvbWV0aGluZyBpbnRvIHRoZSBidWZmZXIuCgkgICAgaWYgKCFzdGF0ZS5lbmRlZCkgc3RhdGUubmVlZFJlYWRhYmxlID0gdHJ1ZTsKCgkgICAgLy8gSWYgd2UgdHJpZWQgdG8gcmVhZCgpIHBhc3QgdGhlIEVPRiwgdGhlbiBlbWl0IGVuZCBvbiB0aGUgbmV4dCB0aWNrLgoJICAgIGlmIChuT3JpZyAhPT0gbiAmJiBzdGF0ZS5lbmRlZCkgZW5kUmVhZGFibGUodGhpcyk7CgkgIH0KCgkgIGlmIChyZXQgIT09IG51bGwpIHRoaXMuZW1pdCgnZGF0YScsIHJldCk7CgoJICByZXR1cm4gcmV0OwoJfTsKCglmdW5jdGlvbiBjaHVua0ludmFsaWQoc3RhdGUsIGNodW5rKSB7CgkgIHZhciBlciA9IG51bGw7CgkgIGlmICghQnVmZmVyLmlzQnVmZmVyKGNodW5rKSAmJiB0eXBlb2YgY2h1bmsgIT09ICdzdHJpbmcnICYmIGNodW5rICE9PSBudWxsICYmIGNodW5rICE9PSB1bmRlZmluZWQgJiYgIXN0YXRlLm9iamVjdE1vZGUpIHsKCSAgICBlciA9IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgbm9uLXN0cmluZy9idWZmZXIgY2h1bmsnKTsKCSAgfQoJICByZXR1cm4gZXI7Cgl9CgoJZnVuY3Rpb24gb25Fb2ZDaHVuayhzdHJlYW0sIHN0YXRlKSB7CgkgIGlmIChzdGF0ZS5lbmRlZCkgcmV0dXJuOwoJICBpZiAoc3RhdGUuZGVjb2RlcikgewoJICAgIHZhciBjaHVuayA9IHN0YXRlLmRlY29kZXIuZW5kKCk7CgkgICAgaWYgKGNodW5rICYmIGNodW5rLmxlbmd0aCkgewoJICAgICAgc3RhdGUuYnVmZmVyLnB1c2goY2h1bmspOwoJICAgICAgc3RhdGUubGVuZ3RoICs9IHN0YXRlLm9iamVjdE1vZGUgPyAxIDogY2h1bmsubGVuZ3RoOwoJICAgIH0KCSAgfQoJICBzdGF0ZS5lbmRlZCA9IHRydWU7CgoJICAvLyBlbWl0ICdyZWFkYWJsZScgbm93IHRvIG1ha2Ugc3VyZSBpdCBnZXRzIHBpY2tlZCB1cC4KCSAgZW1pdFJlYWRhYmxlKHN0cmVhbSk7Cgl9CgoJLy8gRG9uJ3QgZW1pdCByZWFkYWJsZSByaWdodCBhd2F5IGluIHN5bmMgbW9kZSwgYmVjYXVzZSB0aGlzIGNhbiB0cmlnZ2VyCgkvLyBhbm90aGVyIHJlYWQoKSBjYWxsID0+IHN0YWNrIG92ZXJmbG93LiAgVGhpcyB3YXksIGl0IG1pZ2h0IHRyaWdnZXIKCS8vIGEgbmV4dFRpY2sgcmVjdXJzaW9uIHdhcm5pbmcsIGJ1dCB0aGF0J3Mgbm90IHNvIGJhZC4KCWZ1bmN0aW9uIGVtaXRSZWFkYWJsZShzdHJlYW0pIHsKCSAgdmFyIHN0YXRlID0gc3RyZWFtLl9yZWFkYWJsZVN0YXRlOwoJICBzdGF0ZS5uZWVkUmVhZGFibGUgPSBmYWxzZTsKCSAgaWYgKCFzdGF0ZS5lbWl0dGVkUmVhZGFibGUpIHsKCSAgICBkZWJ1ZygnZW1pdFJlYWRhYmxlJywgc3RhdGUuZmxvd2luZyk7CgkgICAgc3RhdGUuZW1pdHRlZFJlYWRhYmxlID0gdHJ1ZTsKCSAgICBpZiAoc3RhdGUuc3luYykgcHJvY2Vzc05leHRUaWNrKGVtaXRSZWFkYWJsZV8sIHN0cmVhbSk7ZWxzZSBlbWl0UmVhZGFibGVfKHN0cmVhbSk7CgkgIH0KCX0KCglmdW5jdGlvbiBlbWl0UmVhZGFibGVfKHN0cmVhbSkgewoJICBkZWJ1ZygnZW1pdCByZWFkYWJsZScpOwoJICBzdHJlYW0uZW1pdCgncmVhZGFibGUnKTsKCSAgZmxvdyhzdHJlYW0pOwoJfQoKCS8vIGF0IHRoaXMgcG9pbnQsIHRoZSB1c2VyIGhhcyBwcmVzdW1hYmx5IHNlZW4gdGhlICdyZWFkYWJsZScgZXZlbnQsCgkvLyBhbmQgY2FsbGVkIHJlYWQoKSB0byBjb25zdW1lIHNvbWUgZGF0YS4gIHRoYXQgbWF5IGhhdmUgdHJpZ2dlcmVkCgkvLyBpbiB0dXJuIGFub3RoZXIgX3JlYWQobikgY2FsbCwgaW4gd2hpY2ggY2FzZSByZWFkaW5nID0gdHJ1ZSBpZgoJLy8gaXQncyBpbiBwcm9ncmVzcy4KCS8vIEhvd2V2ZXIsIGlmIHdlJ3JlIG5vdCBlbmRlZCwgb3IgcmVhZGluZywgYW5kIHRoZSBsZW5ndGggPCBod20sCgkvLyB0aGVuIGdvIGFoZWFkIGFuZCB0cnkgdG8gcmVhZCBzb21lIG1vcmUgcHJlZW1wdGl2ZWx5LgoJZnVuY3Rpb24gbWF5YmVSZWFkTW9yZShzdHJlYW0sIHN0YXRlKSB7CgkgIGlmICghc3RhdGUucmVhZGluZ01vcmUpIHsKCSAgICBzdGF0ZS5yZWFkaW5nTW9yZSA9IHRydWU7CgkgICAgcHJvY2Vzc05leHRUaWNrKG1heWJlUmVhZE1vcmVfLCBzdHJlYW0sIHN0YXRlKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIG1heWJlUmVhZE1vcmVfKHN0cmVhbSwgc3RhdGUpIHsKCSAgdmFyIGxlbiA9IHN0YXRlLmxlbmd0aDsKCSAgd2hpbGUgKCFzdGF0ZS5yZWFkaW5nICYmICFzdGF0ZS5mbG93aW5nICYmICFzdGF0ZS5lbmRlZCAmJiBzdGF0ZS5sZW5ndGggPCBzdGF0ZS5oaWdoV2F0ZXJNYXJrKSB7CgkgICAgZGVidWcoJ21heWJlUmVhZE1vcmUgcmVhZCAwJyk7CgkgICAgc3RyZWFtLnJlYWQoMCk7CgkgICAgaWYgKGxlbiA9PT0gc3RhdGUubGVuZ3RoKQoJICAgICAgLy8gZGlkbid0IGdldCBhbnkgZGF0YSwgc3RvcCBzcGlubmluZy4KCSAgICAgIGJyZWFrO2Vsc2UgbGVuID0gc3RhdGUubGVuZ3RoOwoJICB9CgkgIHN0YXRlLnJlYWRpbmdNb3JlID0gZmFsc2U7Cgl9CgoJLy8gYWJzdHJhY3QgbWV0aG9kLiAgdG8gYmUgb3ZlcnJpZGRlbiBpbiBzcGVjaWZpYyBpbXBsZW1lbnRhdGlvbiBjbGFzc2VzLgoJLy8gY2FsbCBjYihlciwgZGF0YSkgd2hlcmUgZGF0YSBpcyA8PSBuIGluIGxlbmd0aC4KCS8vIGZvciB2aXJ0dWFsIChub24tc3RyaW5nLCBub24tYnVmZmVyKSBzdHJlYW1zLCAibGVuZ3RoIiBpcyBzb21ld2hhdAoJLy8gYXJiaXRyYXJ5LCBhbmQgcGVyaGFwcyBub3QgdmVyeSBtZWFuaW5nZnVsLgoJUmVhZGFibGUucHJvdG90eXBlLl9yZWFkID0gZnVuY3Rpb24gKG4pIHsKCSAgdGhpcy5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignX3JlYWQoKSBpcyBub3QgaW1wbGVtZW50ZWQnKSk7Cgl9OwoKCVJlYWRhYmxlLnByb3RvdHlwZS5waXBlID0gZnVuY3Rpb24gKGRlc3QsIHBpcGVPcHRzKSB7CgkgIHZhciBzcmMgPSB0aGlzOwoJICB2YXIgc3RhdGUgPSB0aGlzLl9yZWFkYWJsZVN0YXRlOwoKCSAgc3dpdGNoIChzdGF0ZS5waXBlc0NvdW50KSB7CgkgICAgY2FzZSAwOgoJICAgICAgc3RhdGUucGlwZXMgPSBkZXN0OwoJICAgICAgYnJlYWs7CgkgICAgY2FzZSAxOgoJICAgICAgc3RhdGUucGlwZXMgPSBbc3RhdGUucGlwZXMsIGRlc3RdOwoJICAgICAgYnJlYWs7CgkgICAgZGVmYXVsdDoKCSAgICAgIHN0YXRlLnBpcGVzLnB1c2goZGVzdCk7CgkgICAgICBicmVhazsKCSAgfQoJICBzdGF0ZS5waXBlc0NvdW50ICs9IDE7CgkgIGRlYnVnKCdwaXBlIGNvdW50PSVkIG9wdHM9JWonLCBzdGF0ZS5waXBlc0NvdW50LCBwaXBlT3B0cyk7CgoJICB2YXIgZG9FbmQgPSAoIXBpcGVPcHRzIHx8IHBpcGVPcHRzLmVuZCAhPT0gZmFsc2UpICYmIGRlc3QgIT09IHByb2Nlc3Muc3Rkb3V0ICYmIGRlc3QgIT09IHByb2Nlc3Muc3RkZXJyOwoKCSAgdmFyIGVuZEZuID0gZG9FbmQgPyBvbmVuZCA6IGNsZWFudXA7CgkgIGlmIChzdGF0ZS5lbmRFbWl0dGVkKSBwcm9jZXNzTmV4dFRpY2soZW5kRm4pO2Vsc2Ugc3JjLm9uY2UoJ2VuZCcsIGVuZEZuKTsKCgkgIGRlc3Qub24oJ3VucGlwZScsIG9udW5waXBlKTsKCSAgZnVuY3Rpb24gb251bnBpcGUocmVhZGFibGUpIHsKCSAgICBkZWJ1Zygnb251bnBpcGUnKTsKCSAgICBpZiAocmVhZGFibGUgPT09IHNyYykgewoJICAgICAgY2xlYW51cCgpOwoJICAgIH0KCSAgfQoKCSAgZnVuY3Rpb24gb25lbmQoKSB7CgkgICAgZGVidWcoJ29uZW5kJyk7CgkgICAgZGVzdC5lbmQoKTsKCSAgfQoKCSAgLy8gd2hlbiB0aGUgZGVzdCBkcmFpbnMsIGl0IHJlZHVjZXMgdGhlIGF3YWl0RHJhaW4gY291bnRlcgoJICAvLyBvbiB0aGUgc291cmNlLiAgVGhpcyB3b3VsZCBiZSBtb3JlIGVsZWdhbnQgd2l0aCBhIC5vbmNlKCkKCSAgLy8gaGFuZGxlciBpbiBmbG93KCksIGJ1dCBhZGRpbmcgYW5kIHJlbW92aW5nIHJlcGVhdGVkbHkgaXMKCSAgLy8gdG9vIHNsb3cuCgkgIHZhciBvbmRyYWluID0gcGlwZU9uRHJhaW4oc3JjKTsKCSAgZGVzdC5vbignZHJhaW4nLCBvbmRyYWluKTsKCgkgIHZhciBjbGVhbmVkVXAgPSBmYWxzZTsKCSAgZnVuY3Rpb24gY2xlYW51cCgpIHsKCSAgICBkZWJ1ZygnY2xlYW51cCcpOwoJICAgIC8vIGNsZWFudXAgZXZlbnQgaGFuZGxlcnMgb25jZSB0aGUgcGlwZSBpcyBicm9rZW4KCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdjbG9zZScsIG9uY2xvc2UpOwoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2ZpbmlzaCcsIG9uZmluaXNoKTsKCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdkcmFpbicsIG9uZHJhaW4pOwoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25lcnJvcik7CgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcigndW5waXBlJywgb251bnBpcGUpOwoJICAgIHNyYy5yZW1vdmVMaXN0ZW5lcignZW5kJywgb25lbmQpOwoJICAgIHNyYy5yZW1vdmVMaXN0ZW5lcignZW5kJywgY2xlYW51cCk7CgkgICAgc3JjLnJlbW92ZUxpc3RlbmVyKCdkYXRhJywgb25kYXRhKTsKCgkgICAgY2xlYW5lZFVwID0gdHJ1ZTsKCgkgICAgLy8gaWYgdGhlIHJlYWRlciBpcyB3YWl0aW5nIGZvciBhIGRyYWluIGV2ZW50IGZyb20gdGhpcwoJICAgIC8vIHNwZWNpZmljIHdyaXRlciwgdGhlbiBpdCB3b3VsZCBjYXVzZSBpdCB0byBuZXZlciBzdGFydAoJICAgIC8vIGZsb3dpbmcgYWdhaW4uCgkgICAgLy8gU28sIGlmIHRoaXMgaXMgYXdhaXRpbmcgYSBkcmFpbiwgdGhlbiB3ZSBqdXN0IGNhbGwgaXQgbm93LgoJICAgIC8vIElmIHdlIGRvbid0IGtub3csIHRoZW4gYXNzdW1lIHRoYXQgd2UgYXJlIHdhaXRpbmcgZm9yIG9uZS4KCSAgICBpZiAoc3RhdGUuYXdhaXREcmFpbiAmJiAoIWRlc3QuX3dyaXRhYmxlU3RhdGUgfHwgZGVzdC5fd3JpdGFibGVTdGF0ZS5uZWVkRHJhaW4pKSBvbmRyYWluKCk7CgkgIH0KCgkgIC8vIElmIHRoZSB1c2VyIHB1c2hlcyBtb3JlIGRhdGEgd2hpbGUgd2UncmUgd3JpdGluZyB0byBkZXN0IHRoZW4gd2UnbGwgZW5kIHVwCgkgIC8vIGluIG9uZGF0YSBhZ2Fpbi4gSG93ZXZlciwgd2Ugb25seSB3YW50IHRvIGluY3JlYXNlIGF3YWl0RHJhaW4gb25jZSBiZWNhdXNlCgkgIC8vIGRlc3Qgd2lsbCBvbmx5IGVtaXQgb25lICdkcmFpbicgZXZlbnQgZm9yIHRoZSBtdWx0aXBsZSB3cml0ZXMuCgkgIC8vID0+IEludHJvZHVjZSBhIGd1YXJkIG9uIGluY3JlYXNpbmcgYXdhaXREcmFpbi4KCSAgdmFyIGluY3JlYXNlZEF3YWl0RHJhaW4gPSBmYWxzZTsKCSAgc3JjLm9uKCdkYXRhJywgb25kYXRhKTsKCSAgZnVuY3Rpb24gb25kYXRhKGNodW5rKSB7CgkgICAgZGVidWcoJ29uZGF0YScpOwoJICAgIGluY3JlYXNlZEF3YWl0RHJhaW4gPSBmYWxzZTsKCSAgICB2YXIgcmV0ID0gZGVzdC53cml0ZShjaHVuayk7CgkgICAgaWYgKGZhbHNlID09PSByZXQgJiYgIWluY3JlYXNlZEF3YWl0RHJhaW4pIHsKCSAgICAgIC8vIElmIHRoZSB1c2VyIHVucGlwZWQgZHVyaW5nIGBkZXN0LndyaXRlKClgLCBpdCBpcyBwb3NzaWJsZQoJICAgICAgLy8gdG8gZ2V0IHN0dWNrIGluIGEgcGVybWFuZW50bHkgcGF1c2VkIHN0YXRlIGlmIHRoYXQgd3JpdGUKCSAgICAgIC8vIGFsc28gcmV0dXJuZWQgZmFsc2UuCgkgICAgICAvLyA9PiBDaGVjayB3aGV0aGVyIGBkZXN0YCBpcyBzdGlsbCBhIHBpcGluZyBkZXN0aW5hdGlvbi4KCSAgICAgIGlmICgoc3RhdGUucGlwZXNDb3VudCA9PT0gMSAmJiBzdGF0ZS5waXBlcyA9PT0gZGVzdCB8fCBzdGF0ZS5waXBlc0NvdW50ID4gMSAmJiBpbmRleE9mKHN0YXRlLnBpcGVzLCBkZXN0KSAhPT0gLTEpICYmICFjbGVhbmVkVXApIHsKCSAgICAgICAgZGVidWcoJ2ZhbHNlIHdyaXRlIHJlc3BvbnNlLCBwYXVzZScsIHNyYy5fcmVhZGFibGVTdGF0ZS5hd2FpdERyYWluKTsKCSAgICAgICAgc3JjLl9yZWFkYWJsZVN0YXRlLmF3YWl0RHJhaW4rKzsKCSAgICAgICAgaW5jcmVhc2VkQXdhaXREcmFpbiA9IHRydWU7CgkgICAgICB9CgkgICAgICBzcmMucGF1c2UoKTsKCSAgICB9CgkgIH0KCgkgIC8vIGlmIHRoZSBkZXN0IGhhcyBhbiBlcnJvciwgdGhlbiBzdG9wIHBpcGluZyBpbnRvIGl0LgoJICAvLyBob3dldmVyLCBkb24ndCBzdXBwcmVzcyB0aGUgdGhyb3dpbmcgYmVoYXZpb3IgZm9yIHRoaXMuCgkgIGZ1bmN0aW9uIG9uZXJyb3IoZXIpIHsKCSAgICBkZWJ1Zygnb25lcnJvcicsIGVyKTsKCSAgICB1bnBpcGUoKTsKCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdlcnJvcicsIG9uZXJyb3IpOwoJICAgIGlmIChFRWxpc3RlbmVyQ291bnQoZGVzdCwgJ2Vycm9yJykgPT09IDApIGRlc3QuZW1pdCgnZXJyb3InLCBlcik7CgkgIH0KCgkgIC8vIE1ha2Ugc3VyZSBvdXIgZXJyb3IgaGFuZGxlciBpcyBhdHRhY2hlZCBiZWZvcmUgdXNlcmxhbmQgb25lcy4KCSAgcHJlcGVuZExpc3RlbmVyKGRlc3QsICdlcnJvcicsIG9uZXJyb3IpOwoKCSAgLy8gQm90aCBjbG9zZSBhbmQgZmluaXNoIHNob3VsZCB0cmlnZ2VyIHVucGlwZSwgYnV0IG9ubHkgb25jZS4KCSAgZnVuY3Rpb24gb25jbG9zZSgpIHsKCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdmaW5pc2gnLCBvbmZpbmlzaCk7CgkgICAgdW5waXBlKCk7CgkgIH0KCSAgZGVzdC5vbmNlKCdjbG9zZScsIG9uY2xvc2UpOwoJICBmdW5jdGlvbiBvbmZpbmlzaCgpIHsKCSAgICBkZWJ1Zygnb25maW5pc2gnKTsKCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdjbG9zZScsIG9uY2xvc2UpOwoJICAgIHVucGlwZSgpOwoJICB9CgkgIGRlc3Qub25jZSgnZmluaXNoJywgb25maW5pc2gpOwoKCSAgZnVuY3Rpb24gdW5waXBlKCkgewoJICAgIGRlYnVnKCd1bnBpcGUnKTsKCSAgICBzcmMudW5waXBlKGRlc3QpOwoJICB9CgoJICAvLyB0ZWxsIHRoZSBkZXN0IHRoYXQgaXQncyBiZWluZyBwaXBlZCB0bwoJICBkZXN0LmVtaXQoJ3BpcGUnLCBzcmMpOwoKCSAgLy8gc3RhcnQgdGhlIGZsb3cgaWYgaXQgaGFzbid0IGJlZW4gc3RhcnRlZCBhbHJlYWR5LgoJICBpZiAoIXN0YXRlLmZsb3dpbmcpIHsKCSAgICBkZWJ1ZygncGlwZSByZXN1bWUnKTsKCSAgICBzcmMucmVzdW1lKCk7CgkgIH0KCgkgIHJldHVybiBkZXN0OwoJfTsKCglmdW5jdGlvbiBwaXBlT25EcmFpbihzcmMpIHsKCSAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgc3RhdGUgPSBzcmMuX3JlYWRhYmxlU3RhdGU7CgkgICAgZGVidWcoJ3BpcGVPbkRyYWluJywgc3RhdGUuYXdhaXREcmFpbik7CgkgICAgaWYgKHN0YXRlLmF3YWl0RHJhaW4pIHN0YXRlLmF3YWl0RHJhaW4tLTsKCSAgICBpZiAoc3RhdGUuYXdhaXREcmFpbiA9PT0gMCAmJiBFRWxpc3RlbmVyQ291bnQoc3JjLCAnZGF0YScpKSB7CgkgICAgICBzdGF0ZS5mbG93aW5nID0gdHJ1ZTsKCSAgICAgIGZsb3coc3JjKTsKCSAgICB9CgkgIH07Cgl9CgoJUmVhZGFibGUucHJvdG90eXBlLnVucGlwZSA9IGZ1bmN0aW9uIChkZXN0KSB7CgkgIHZhciBzdGF0ZSA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgoJICAvLyBpZiB3ZSdyZSBub3QgcGlwaW5nIGFueXdoZXJlLCB0aGVuIGRvIG5vdGhpbmcuCgkgIGlmIChzdGF0ZS5waXBlc0NvdW50ID09PSAwKSByZXR1cm4gdGhpczsKCgkgIC8vIGp1c3Qgb25lIGRlc3RpbmF0aW9uLiAgbW9zdCBjb21tb24gY2FzZS4KCSAgaWYgKHN0YXRlLnBpcGVzQ291bnQgPT09IDEpIHsKCSAgICAvLyBwYXNzZWQgaW4gb25lLCBidXQgaXQncyBub3QgdGhlIHJpZ2h0IG9uZS4KCSAgICBpZiAoZGVzdCAmJiBkZXN0ICE9PSBzdGF0ZS5waXBlcykgcmV0dXJuIHRoaXM7CgoJICAgIGlmICghZGVzdCkgZGVzdCA9IHN0YXRlLnBpcGVzOwoKCSAgICAvLyBnb3QgYSBtYXRjaC4KCSAgICBzdGF0ZS5waXBlcyA9IG51bGw7CgkgICAgc3RhdGUucGlwZXNDb3VudCA9IDA7CgkgICAgc3RhdGUuZmxvd2luZyA9IGZhbHNlOwoJICAgIGlmIChkZXN0KSBkZXN0LmVtaXQoJ3VucGlwZScsIHRoaXMpOwoJICAgIHJldHVybiB0aGlzOwoJICB9CgoJICAvLyBzbG93IGNhc2UuIG11bHRpcGxlIHBpcGUgZGVzdGluYXRpb25zLgoKCSAgaWYgKCFkZXN0KSB7CgkgICAgLy8gcmVtb3ZlIGFsbC4KCSAgICB2YXIgZGVzdHMgPSBzdGF0ZS5waXBlczsKCSAgICB2YXIgbGVuID0gc3RhdGUucGlwZXNDb3VudDsKCSAgICBzdGF0ZS5waXBlcyA9IG51bGw7CgkgICAgc3RhdGUucGlwZXNDb3VudCA9IDA7CgkgICAgc3RhdGUuZmxvd2luZyA9IGZhbHNlOwoKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CgkgICAgICBkZXN0c1tpXS5lbWl0KCd1bnBpcGUnLCB0aGlzKTsKCSAgICB9cmV0dXJuIHRoaXM7CgkgIH0KCgkgIC8vIHRyeSB0byBmaW5kIHRoZSByaWdodCBvbmUuCgkgIHZhciBpbmRleCA9IGluZGV4T2Yoc3RhdGUucGlwZXMsIGRlc3QpOwoJICBpZiAoaW5kZXggPT09IC0xKSByZXR1cm4gdGhpczsKCgkgIHN0YXRlLnBpcGVzLnNwbGljZShpbmRleCwgMSk7CgkgIHN0YXRlLnBpcGVzQ291bnQgLT0gMTsKCSAgaWYgKHN0YXRlLnBpcGVzQ291bnQgPT09IDEpIHN0YXRlLnBpcGVzID0gc3RhdGUucGlwZXNbMF07CgoJICBkZXN0LmVtaXQoJ3VucGlwZScsIHRoaXMpOwoKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCS8vIHNldCB1cCBkYXRhIGV2ZW50cyBpZiB0aGV5IGFyZSBhc2tlZCBmb3IKCS8vIEVuc3VyZSByZWFkYWJsZSBsaXN0ZW5lcnMgZXZlbnR1YWxseSBnZXQgc29tZXRoaW5nCglSZWFkYWJsZS5wcm90b3R5cGUub24gPSBmdW5jdGlvbiAoZXYsIGZuKSB7CgkgIHZhciByZXMgPSBTdHJlYW0ucHJvdG90eXBlLm9uLmNhbGwodGhpcywgZXYsIGZuKTsKCgkgIGlmIChldiA9PT0gJ2RhdGEnKSB7CgkgICAgLy8gU3RhcnQgZmxvd2luZyBvbiBuZXh0IHRpY2sgaWYgc3RyZWFtIGlzbid0IGV4cGxpY2l0bHkgcGF1c2VkCgkgICAgaWYgKHRoaXMuX3JlYWRhYmxlU3RhdGUuZmxvd2luZyAhPT0gZmFsc2UpIHRoaXMucmVzdW1lKCk7CgkgIH0gZWxzZSBpZiAoZXYgPT09ICdyZWFkYWJsZScpIHsKCSAgICB2YXIgc3RhdGUgPSB0aGlzLl9yZWFkYWJsZVN0YXRlOwoJICAgIGlmICghc3RhdGUuZW5kRW1pdHRlZCAmJiAhc3RhdGUucmVhZGFibGVMaXN0ZW5pbmcpIHsKCSAgICAgIHN0YXRlLnJlYWRhYmxlTGlzdGVuaW5nID0gc3RhdGUubmVlZFJlYWRhYmxlID0gdHJ1ZTsKCSAgICAgIHN0YXRlLmVtaXR0ZWRSZWFkYWJsZSA9IGZhbHNlOwoJICAgICAgaWYgKCFzdGF0ZS5yZWFkaW5nKSB7CgkgICAgICAgIHByb2Nlc3NOZXh0VGljayhuUmVhZGluZ05leHRUaWNrLCB0aGlzKTsKCSAgICAgIH0gZWxzZSBpZiAoc3RhdGUubGVuZ3RoKSB7CgkgICAgICAgIGVtaXRSZWFkYWJsZSh0aGlzLCBzdGF0ZSk7CgkgICAgICB9CgkgICAgfQoJICB9CgoJICByZXR1cm4gcmVzOwoJfTsKCVJlYWRhYmxlLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IFJlYWRhYmxlLnByb3RvdHlwZS5vbjsKCglmdW5jdGlvbiBuUmVhZGluZ05leHRUaWNrKHNlbGYpIHsKCSAgZGVidWcoJ3JlYWRhYmxlIG5leHR0aWNrIHJlYWQgMCcpOwoJICBzZWxmLnJlYWQoMCk7Cgl9CgoJLy8gcGF1c2UoKSBhbmQgcmVzdW1lKCkgYXJlIHJlbW5hbnRzIG9mIHRoZSBsZWdhY3kgcmVhZGFibGUgc3RyZWFtIEFQSQoJLy8gSWYgdGhlIHVzZXIgdXNlcyB0aGVtLCB0aGVuIHN3aXRjaCBpbnRvIG9sZCBtb2RlLgoJUmVhZGFibGUucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsKCSAgaWYgKCFzdGF0ZS5mbG93aW5nKSB7CgkgICAgZGVidWcoJ3Jlc3VtZScpOwoJICAgIHN0YXRlLmZsb3dpbmcgPSB0cnVlOwoJICAgIHJlc3VtZSh0aGlzLCBzdGF0ZSk7CgkgIH0KCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCWZ1bmN0aW9uIHJlc3VtZShzdHJlYW0sIHN0YXRlKSB7CgkgIGlmICghc3RhdGUucmVzdW1lU2NoZWR1bGVkKSB7CgkgICAgc3RhdGUucmVzdW1lU2NoZWR1bGVkID0gdHJ1ZTsKCSAgICBwcm9jZXNzTmV4dFRpY2socmVzdW1lXywgc3RyZWFtLCBzdGF0ZSk7CgkgIH0KCX0KCglmdW5jdGlvbiByZXN1bWVfKHN0cmVhbSwgc3RhdGUpIHsKCSAgaWYgKCFzdGF0ZS5yZWFkaW5nKSB7CgkgICAgZGVidWcoJ3Jlc3VtZSByZWFkIDAnKTsKCSAgICBzdHJlYW0ucmVhZCgwKTsKCSAgfQoKCSAgc3RhdGUucmVzdW1lU2NoZWR1bGVkID0gZmFsc2U7CgkgIHN0YXRlLmF3YWl0RHJhaW4gPSAwOwoJICBzdHJlYW0uZW1pdCgncmVzdW1lJyk7CgkgIGZsb3coc3RyZWFtKTsKCSAgaWYgKHN0YXRlLmZsb3dpbmcgJiYgIXN0YXRlLnJlYWRpbmcpIHN0cmVhbS5yZWFkKDApOwoJfQoKCVJlYWRhYmxlLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHsKCSAgZGVidWcoJ2NhbGwgcGF1c2UgZmxvd2luZz0laicsIHRoaXMuX3JlYWRhYmxlU3RhdGUuZmxvd2luZyk7CgkgIGlmIChmYWxzZSAhPT0gdGhpcy5fcmVhZGFibGVTdGF0ZS5mbG93aW5nKSB7CgkgICAgZGVidWcoJ3BhdXNlJyk7CgkgICAgdGhpcy5fcmVhZGFibGVTdGF0ZS5mbG93aW5nID0gZmFsc2U7CgkgICAgdGhpcy5lbWl0KCdwYXVzZScpOwoJICB9CgkgIHJldHVybiB0aGlzOwoJfTsKCglmdW5jdGlvbiBmbG93KHN0cmVhbSkgewoJICB2YXIgc3RhdGUgPSBzdHJlYW0uX3JlYWRhYmxlU3RhdGU7CgkgIGRlYnVnKCdmbG93Jywgc3RhdGUuZmxvd2luZyk7CgkgIHdoaWxlIChzdGF0ZS5mbG93aW5nICYmIHN0cmVhbS5yZWFkKCkgIT09IG51bGwpIHt9Cgl9CgoJLy8gd3JhcCBhbiBvbGQtc3R5bGUgc3RyZWFtIGFzIHRoZSBhc3luYyBkYXRhIHNvdXJjZS4KCS8vIFRoaXMgaXMgKm5vdCogcGFydCBvZiB0aGUgcmVhZGFibGUgc3RyZWFtIGludGVyZmFjZS4KCS8vIEl0IGlzIGFuIHVnbHkgdW5mb3J0dW5hdGUgbWVzcyBvZiBoaXN0b3J5LgoJUmVhZGFibGUucHJvdG90eXBlLndyYXAgPSBmdW5jdGlvbiAoc3RyZWFtKSB7CgkgIHZhciBzdGF0ZSA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgkgIHZhciBwYXVzZWQgPSBmYWxzZTsKCgkgIHZhciBzZWxmID0gdGhpczsKCSAgc3RyZWFtLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CgkgICAgZGVidWcoJ3dyYXBwZWQgZW5kJyk7CgkgICAgaWYgKHN0YXRlLmRlY29kZXIgJiYgIXN0YXRlLmVuZGVkKSB7CgkgICAgICB2YXIgY2h1bmsgPSBzdGF0ZS5kZWNvZGVyLmVuZCgpOwoJICAgICAgaWYgKGNodW5rICYmIGNodW5rLmxlbmd0aCkgc2VsZi5wdXNoKGNodW5rKTsKCSAgICB9CgoJICAgIHNlbGYucHVzaChudWxsKTsKCSAgfSk7CgoJICBzdHJlYW0ub24oJ2RhdGEnLCBmdW5jdGlvbiAoY2h1bmspIHsKCSAgICBkZWJ1Zygnd3JhcHBlZCBkYXRhJyk7CgkgICAgaWYgKHN0YXRlLmRlY29kZXIpIGNodW5rID0gc3RhdGUuZGVjb2Rlci53cml0ZShjaHVuayk7CgoJICAgIC8vIGRvbid0IHNraXAgb3ZlciBmYWxzeSB2YWx1ZXMgaW4gb2JqZWN0TW9kZQoJICAgIGlmIChzdGF0ZS5vYmplY3RNb2RlICYmIChjaHVuayA9PT0gbnVsbCB8fCBjaHVuayA9PT0gdW5kZWZpbmVkKSkgcmV0dXJuO2Vsc2UgaWYgKCFzdGF0ZS5vYmplY3RNb2RlICYmICghY2h1bmsgfHwgIWNodW5rLmxlbmd0aCkpIHJldHVybjsKCgkgICAgdmFyIHJldCA9IHNlbGYucHVzaChjaHVuayk7CgkgICAgaWYgKCFyZXQpIHsKCSAgICAgIHBhdXNlZCA9IHRydWU7CgkgICAgICBzdHJlYW0ucGF1c2UoKTsKCSAgICB9CgkgIH0pOwoKCSAgLy8gcHJveHkgYWxsIHRoZSBvdGhlciBtZXRob2RzLgoJICAvLyBpbXBvcnRhbnQgd2hlbiB3cmFwcGluZyBmaWx0ZXJzIGFuZCBkdXBsZXhlcy4KCSAgZm9yICh2YXIgaSBpbiBzdHJlYW0pIHsKCSAgICBpZiAodGhpc1tpXSA9PT0gdW5kZWZpbmVkICYmIHR5cGVvZiBzdHJlYW1baV0gPT09ICdmdW5jdGlvbicpIHsKCSAgICAgIHRoaXNbaV0gPSBmdW5jdGlvbiAobWV0aG9kKSB7CgkgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgcmV0dXJuIHN0cmVhbVttZXRob2RdLmFwcGx5KHN0cmVhbSwgYXJndW1lbnRzKTsKCSAgICAgICAgfTsKCSAgICAgIH0oaSk7CgkgICAgfQoJICB9CgoJICAvLyBwcm94eSBjZXJ0YWluIGltcG9ydGFudCBldmVudHMuCgkgIGZvciAodmFyIG4gPSAwOyBuIDwga1Byb3h5RXZlbnRzLmxlbmd0aDsgbisrKSB7CgkgICAgc3RyZWFtLm9uKGtQcm94eUV2ZW50c1tuXSwgc2VsZi5lbWl0LmJpbmQoc2VsZiwga1Byb3h5RXZlbnRzW25dKSk7CgkgIH0KCgkgIC8vIHdoZW4gd2UgdHJ5IHRvIGNvbnN1bWUgc29tZSBtb3JlIGJ5dGVzLCBzaW1wbHkgdW5wYXVzZSB0aGUKCSAgLy8gdW5kZXJseWluZyBzdHJlYW0uCgkgIHNlbGYuX3JlYWQgPSBmdW5jdGlvbiAobikgewoJICAgIGRlYnVnKCd3cmFwcGVkIF9yZWFkJywgbik7CgkgICAgaWYgKHBhdXNlZCkgewoJICAgICAgcGF1c2VkID0gZmFsc2U7CgkgICAgICBzdHJlYW0ucmVzdW1lKCk7CgkgICAgfQoJICB9OwoKCSAgcmV0dXJuIHNlbGY7Cgl9OwoKCS8vIGV4cG9zZWQgZm9yIHRlc3RpbmcgcHVycG9zZXMgb25seS4KCVJlYWRhYmxlLl9mcm9tTGlzdCA9IGZyb21MaXN0OwoKCS8vIFBsdWNrIG9mZiBuIGJ5dGVzIGZyb20gYW4gYXJyYXkgb2YgYnVmZmVycy4KCS8vIExlbmd0aCBpcyB0aGUgY29tYmluZWQgbGVuZ3RocyBvZiBhbGwgdGhlIGJ1ZmZlcnMgaW4gdGhlIGxpc3QuCgkvLyBUaGlzIGZ1bmN0aW9uIGlzIGRlc2lnbmVkIHRvIGJlIGlubGluYWJsZSwgc28gcGxlYXNlIHRha2UgY2FyZSB3aGVuIG1ha2luZwoJLy8gY2hhbmdlcyB0byB0aGUgZnVuY3Rpb24gYm9keS4KCWZ1bmN0aW9uIGZyb21MaXN0KG4sIHN0YXRlKSB7CgkgIC8vIG5vdGhpbmcgYnVmZmVyZWQKCSAgaWYgKHN0YXRlLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7CgoJICB2YXIgcmV0OwoJICBpZiAoc3RhdGUub2JqZWN0TW9kZSkgcmV0ID0gc3RhdGUuYnVmZmVyLnNoaWZ0KCk7ZWxzZSBpZiAoIW4gfHwgbiA+PSBzdGF0ZS5sZW5ndGgpIHsKCSAgICAvLyByZWFkIGl0IGFsbCwgdHJ1bmNhdGUgdGhlIGxpc3QKCSAgICBpZiAoc3RhdGUuZGVjb2RlcikgcmV0ID0gc3RhdGUuYnVmZmVyLmpvaW4oJycpO2Vsc2UgaWYgKHN0YXRlLmJ1ZmZlci5sZW5ndGggPT09IDEpIHJldCA9IHN0YXRlLmJ1ZmZlci5oZWFkLmRhdGE7ZWxzZSByZXQgPSBzdGF0ZS5idWZmZXIuY29uY2F0KHN0YXRlLmxlbmd0aCk7CgkgICAgc3RhdGUuYnVmZmVyLmNsZWFyKCk7CgkgIH0gZWxzZSB7CgkgICAgLy8gcmVhZCBwYXJ0IG9mIGxpc3QKCSAgICByZXQgPSBmcm9tTGlzdFBhcnRpYWwobiwgc3RhdGUuYnVmZmVyLCBzdGF0ZS5kZWNvZGVyKTsKCSAgfQoKCSAgcmV0dXJuIHJldDsKCX0KCgkvLyBFeHRyYWN0cyBvbmx5IGVub3VnaCBidWZmZXJlZCBkYXRhIHRvIHNhdGlzZnkgdGhlIGFtb3VudCByZXF1ZXN0ZWQuCgkvLyBUaGlzIGZ1bmN0aW9uIGlzIGRlc2lnbmVkIHRvIGJlIGlubGluYWJsZSwgc28gcGxlYXNlIHRha2UgY2FyZSB3aGVuIG1ha2luZwoJLy8gY2hhbmdlcyB0byB0aGUgZnVuY3Rpb24gYm9keS4KCWZ1bmN0aW9uIGZyb21MaXN0UGFydGlhbChuLCBsaXN0LCBoYXNTdHJpbmdzKSB7CgkgIHZhciByZXQ7CgkgIGlmIChuIDwgbGlzdC5oZWFkLmRhdGEubGVuZ3RoKSB7CgkgICAgLy8gc2xpY2UgaXMgdGhlIHNhbWUgZm9yIGJ1ZmZlcnMgYW5kIHN0cmluZ3MKCSAgICByZXQgPSBsaXN0LmhlYWQuZGF0YS5zbGljZSgwLCBuKTsKCSAgICBsaXN0LmhlYWQuZGF0YSA9IGxpc3QuaGVhZC5kYXRhLnNsaWNlKG4pOwoJICB9IGVsc2UgaWYgKG4gPT09IGxpc3QuaGVhZC5kYXRhLmxlbmd0aCkgewoJICAgIC8vIGZpcnN0IGNodW5rIGlzIGEgcGVyZmVjdCBtYXRjaAoJICAgIHJldCA9IGxpc3Quc2hpZnQoKTsKCSAgfSBlbHNlIHsKCSAgICAvLyByZXN1bHQgc3BhbnMgbW9yZSB0aGFuIG9uZSBidWZmZXIKCSAgICByZXQgPSBoYXNTdHJpbmdzID8gY29weUZyb21CdWZmZXJTdHJpbmcobiwgbGlzdCkgOiBjb3B5RnJvbUJ1ZmZlcihuLCBsaXN0KTsKCSAgfQoJICByZXR1cm4gcmV0OwoJfQoKCS8vIENvcGllcyBhIHNwZWNpZmllZCBhbW91bnQgb2YgY2hhcmFjdGVycyBmcm9tIHRoZSBsaXN0IG9mIGJ1ZmZlcmVkIGRhdGEKCS8vIGNodW5rcy4KCS8vIFRoaXMgZnVuY3Rpb24gaXMgZGVzaWduZWQgdG8gYmUgaW5saW5hYmxlLCBzbyBwbGVhc2UgdGFrZSBjYXJlIHdoZW4gbWFraW5nCgkvLyBjaGFuZ2VzIHRvIHRoZSBmdW5jdGlvbiBib2R5LgoJZnVuY3Rpb24gY29weUZyb21CdWZmZXJTdHJpbmcobiwgbGlzdCkgewoJICB2YXIgcCA9IGxpc3QuaGVhZDsKCSAgdmFyIGMgPSAxOwoJICB2YXIgcmV0ID0gcC5kYXRhOwoJICBuIC09IHJldC5sZW5ndGg7CgkgIHdoaWxlIChwID0gcC5uZXh0KSB7CgkgICAgdmFyIHN0ciA9IHAuZGF0YTsKCSAgICB2YXIgbmIgPSBuID4gc3RyLmxlbmd0aCA/IHN0ci5sZW5ndGggOiBuOwoJICAgIGlmIChuYiA9PT0gc3RyLmxlbmd0aCkgcmV0ICs9IHN0cjtlbHNlIHJldCArPSBzdHIuc2xpY2UoMCwgbik7CgkgICAgbiAtPSBuYjsKCSAgICBpZiAobiA9PT0gMCkgewoJICAgICAgaWYgKG5iID09PSBzdHIubGVuZ3RoKSB7CgkgICAgICAgICsrYzsKCSAgICAgICAgaWYgKHAubmV4dCkgbGlzdC5oZWFkID0gcC5uZXh0O2Vsc2UgbGlzdC5oZWFkID0gbGlzdC50YWlsID0gbnVsbDsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGxpc3QuaGVhZCA9IHA7CgkgICAgICAgIHAuZGF0YSA9IHN0ci5zbGljZShuYik7CgkgICAgICB9CgkgICAgICBicmVhazsKCSAgICB9CgkgICAgKytjOwoJICB9CgkgIGxpc3QubGVuZ3RoIC09IGM7CgkgIHJldHVybiByZXQ7Cgl9CgoJLy8gQ29waWVzIGEgc3BlY2lmaWVkIGFtb3VudCBvZiBieXRlcyBmcm9tIHRoZSBsaXN0IG9mIGJ1ZmZlcmVkIGRhdGEgY2h1bmtzLgoJLy8gVGhpcyBmdW5jdGlvbiBpcyBkZXNpZ25lZCB0byBiZSBpbmxpbmFibGUsIHNvIHBsZWFzZSB0YWtlIGNhcmUgd2hlbiBtYWtpbmcKCS8vIGNoYW5nZXMgdG8gdGhlIGZ1bmN0aW9uIGJvZHkuCglmdW5jdGlvbiBjb3B5RnJvbUJ1ZmZlcihuLCBsaXN0KSB7CgkgIHZhciByZXQgPSBidWZmZXJTaGltLmFsbG9jVW5zYWZlKG4pOwoJICB2YXIgcCA9IGxpc3QuaGVhZDsKCSAgdmFyIGMgPSAxOwoJICBwLmRhdGEuY29weShyZXQpOwoJICBuIC09IHAuZGF0YS5sZW5ndGg7CgkgIHdoaWxlIChwID0gcC5uZXh0KSB7CgkgICAgdmFyIGJ1ZiA9IHAuZGF0YTsKCSAgICB2YXIgbmIgPSBuID4gYnVmLmxlbmd0aCA/IGJ1Zi5sZW5ndGggOiBuOwoJICAgIGJ1Zi5jb3B5KHJldCwgcmV0Lmxlbmd0aCAtIG4sIDAsIG5iKTsKCSAgICBuIC09IG5iOwoJICAgIGlmIChuID09PSAwKSB7CgkgICAgICBpZiAobmIgPT09IGJ1Zi5sZW5ndGgpIHsKCSAgICAgICAgKytjOwoJICAgICAgICBpZiAocC5uZXh0KSBsaXN0LmhlYWQgPSBwLm5leHQ7ZWxzZSBsaXN0LmhlYWQgPSBsaXN0LnRhaWwgPSBudWxsOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgbGlzdC5oZWFkID0gcDsKCSAgICAgICAgcC5kYXRhID0gYnVmLnNsaWNlKG5iKTsKCSAgICAgIH0KCSAgICAgIGJyZWFrOwoJICAgIH0KCSAgICArK2M7CgkgIH0KCSAgbGlzdC5sZW5ndGggLT0gYzsKCSAgcmV0dXJuIHJldDsKCX0KCglmdW5jdGlvbiBlbmRSZWFkYWJsZShzdHJlYW0pIHsKCSAgdmFyIHN0YXRlID0gc3RyZWFtLl9yZWFkYWJsZVN0YXRlOwoKCSAgLy8gSWYgd2UgZ2V0IGhlcmUgYmVmb3JlIGNvbnN1bWluZyBhbGwgdGhlIGJ5dGVzLCB0aGVuIHRoYXQgaXMgYQoJICAvLyBidWcgaW4gbm9kZS4gIFNob3VsZCBuZXZlciBoYXBwZW4uCgkgIGlmIChzdGF0ZS5sZW5ndGggPiAwKSB0aHJvdyBuZXcgRXJyb3IoJyJlbmRSZWFkYWJsZSgpIiBjYWxsZWQgb24gbm9uLWVtcHR5IHN0cmVhbScpOwoKCSAgaWYgKCFzdGF0ZS5lbmRFbWl0dGVkKSB7CgkgICAgc3RhdGUuZW5kZWQgPSB0cnVlOwoJICAgIHByb2Nlc3NOZXh0VGljayhlbmRSZWFkYWJsZU5ULCBzdGF0ZSwgc3RyZWFtKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIGVuZFJlYWRhYmxlTlQoc3RhdGUsIHN0cmVhbSkgewoJICAvLyBDaGVjayB0aGF0IHdlIGRpZG4ndCBnZXQgb25lIGxhc3QgdW5zaGlmdC4KCSAgaWYgKCFzdGF0ZS5lbmRFbWl0dGVkICYmIHN0YXRlLmxlbmd0aCA9PT0gMCkgewoJICAgIHN0YXRlLmVuZEVtaXR0ZWQgPSB0cnVlOwoJICAgIHN0cmVhbS5yZWFkYWJsZSA9IGZhbHNlOwoJICAgIHN0cmVhbS5lbWl0KCdlbmQnKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIGZvckVhY2goeHMsIGYpIHsKCSAgZm9yICh2YXIgaSA9IDAsIGwgPSB4cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKCSAgICBmKHhzW2ldLCBpKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIGluZGV4T2YoeHMsIHgpIHsKCSAgZm9yICh2YXIgaSA9IDAsIGwgPSB4cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKCSAgICBpZiAoeHNbaV0gPT09IHgpIHJldHVybiBpOwoJICB9CgkgIHJldHVybiAtMTsKCX0KCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKSkpCgovKioqLyB9LAovKiAxOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24ocHJvY2Vzcykgeyd1c2Ugc3RyaWN0JzsKCglpZiAoIXByb2Nlc3MudmVyc2lvbiB8fAoJICAgIHByb2Nlc3MudmVyc2lvbi5pbmRleE9mKCd2MC4nKSA9PT0gMCB8fAoJICAgIHByb2Nlc3MudmVyc2lvbi5pbmRleE9mKCd2MS4nKSA9PT0gMCAmJiBwcm9jZXNzLnZlcnNpb24uaW5kZXhPZigndjEuOC4nKSAhPT0gMCkgewoJICBtb2R1bGUuZXhwb3J0cyA9IG5leHRUaWNrOwoJfSBlbHNlIHsKCSAgbW9kdWxlLmV4cG9ydHMgPSBwcm9jZXNzLm5leHRUaWNrOwoJfQoKCWZ1bmN0aW9uIG5leHRUaWNrKGZuLCBhcmcxLCBhcmcyLCBhcmczKSB7CgkgIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCciY2FsbGJhY2siIGFyZ3VtZW50IG11c3QgYmUgYSBmdW5jdGlvbicpOwoJICB9CgkgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOwoJICB2YXIgYXJncywgaTsKCSAgc3dpdGNoIChsZW4pIHsKCSAgY2FzZSAwOgoJICBjYXNlIDE6CgkgICAgcmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZm4pOwoJICBjYXNlIDI6CgkgICAgcmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gYWZ0ZXJUaWNrT25lKCkgewoJICAgICAgZm4uY2FsbChudWxsLCBhcmcxKTsKCSAgICB9KTsKCSAgY2FzZSAzOgoJICAgIHJldHVybiBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uIGFmdGVyVGlja1R3bygpIHsKCSAgICAgIGZuLmNhbGwobnVsbCwgYXJnMSwgYXJnMik7CgkgICAgfSk7CgkgIGNhc2UgNDoKCSAgICByZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiBhZnRlclRpY2tUaHJlZSgpIHsKCSAgICAgIGZuLmNhbGwobnVsbCwgYXJnMSwgYXJnMiwgYXJnMyk7CgkgICAgfSk7CgkgIGRlZmF1bHQ6CgkgICAgYXJncyA9IG5ldyBBcnJheShsZW4gLSAxKTsKCSAgICBpID0gMDsKCSAgICB3aGlsZSAoaSA8IGFyZ3MubGVuZ3RoKSB7CgkgICAgICBhcmdzW2krK10gPSBhcmd1bWVudHNbaV07CgkgICAgfQoJICAgIHJldHVybiBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uIGFmdGVyVGljaygpIHsKCSAgICAgIGZuLmFwcGx5KG51bGwsIGFyZ3MpOwoJICAgIH0pOwoJICB9Cgl9CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMTIpKSkKCi8qKiovIH0sCi8qIDE5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCXZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nOwoKCW1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoYXJyKSB7CgkgIHJldHVybiB0b1N0cmluZy5jYWxsKGFycikgPT0gJ1tvYmplY3QgQXJyYXldJzsKCX07CgoKLyoqKi8gfSwKLyogMjAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuCgkvLwoJLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKCS8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKCS8vICJTb2Z0d2FyZSIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcKCS8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwKCS8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQKCS8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZQoJLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6CgkvLwoJLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQKCS8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgoJLy8KCS8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTCgkvLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GCgkvLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOCgkvLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwKCS8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUgoJLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRQoJLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KCglmdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7CgkgIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fTsKCSAgdGhpcy5fbWF4TGlzdGVuZXJzID0gdGhpcy5fbWF4TGlzdGVuZXJzIHx8IHVuZGVmaW5lZDsKCX0KCW1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyOwoKCS8vIEJhY2t3YXJkcy1jb21wYXQgd2l0aCBub2RlIDAuMTAueAoJRXZlbnRFbWl0dGVyLkV2ZW50RW1pdHRlciA9IEV2ZW50RW1pdHRlcjsKCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLl9ldmVudHMgPSB1bmRlZmluZWQ7CglFdmVudEVtaXR0ZXIucHJvdG90eXBlLl9tYXhMaXN0ZW5lcnMgPSB1bmRlZmluZWQ7CgoJLy8gQnkgZGVmYXVsdCBFdmVudEVtaXR0ZXJzIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIG1vcmUgdGhhbiAxMCBsaXN0ZW5lcnMgYXJlCgkvLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLgoJRXZlbnRFbWl0dGVyLmRlZmF1bHRNYXhMaXN0ZW5lcnMgPSAxMDsKCgkvLyBPYnZpb3VzbHkgbm90IGFsbCBFbWl0dGVycyBzaG91bGQgYmUgbGltaXRlZCB0byAxMC4gVGhpcyBmdW5jdGlvbiBhbGxvd3MKCS8vIHRoYXQgdG8gYmUgaW5jcmVhc2VkLiBTZXQgdG8gemVybyBmb3IgdW5saW1pdGVkLgoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5zZXRNYXhMaXN0ZW5lcnMgPSBmdW5jdGlvbihuKSB7CgkgIGlmICghaXNOdW1iZXIobikgfHwgbiA8IDAgfHwgaXNOYU4obikpCgkgICAgdGhyb3cgVHlwZUVycm9yKCduIG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXInKTsKCSAgdGhpcy5fbWF4TGlzdGVuZXJzID0gbjsKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uKHR5cGUpIHsKCSAgdmFyIGVyLCBoYW5kbGVyLCBsZW4sIGFyZ3MsIGksIGxpc3RlbmVyczsKCgkgIGlmICghdGhpcy5fZXZlbnRzKQoJICAgIHRoaXMuX2V2ZW50cyA9IHt9OwoKCSAgLy8gSWYgdGhlcmUgaXMgbm8gJ2Vycm9yJyBldmVudCBsaXN0ZW5lciB0aGVuIHRocm93LgoJICBpZiAodHlwZSA9PT0gJ2Vycm9yJykgewoJICAgIGlmICghdGhpcy5fZXZlbnRzLmVycm9yIHx8CgkgICAgICAgIChpc09iamVjdCh0aGlzLl9ldmVudHMuZXJyb3IpICYmICF0aGlzLl9ldmVudHMuZXJyb3IubGVuZ3RoKSkgewoJICAgICAgZXIgPSBhcmd1bWVudHNbMV07CgkgICAgICBpZiAoZXIgaW5zdGFuY2VvZiBFcnJvcikgewoJICAgICAgICB0aHJvdyBlcjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnQKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIC8vIEF0IGxlYXN0IGdpdmUgc29tZSBraW5kIG9mIGNvbnRleHQgdG8gdGhlIHVzZXIKCSAgICAgICAgdmFyIGVyciA9IG5ldyBFcnJvcignVW5jYXVnaHQsIHVuc3BlY2lmaWVkICJlcnJvciIgZXZlbnQuICgnICsgZXIgKyAnKScpOwoJICAgICAgICBlcnIuY29udGV4dCA9IGVyOwoJICAgICAgICB0aHJvdyBlcnI7CgkgICAgICB9CgkgICAgfQoJICB9CgoJICBoYW5kbGVyID0gdGhpcy5fZXZlbnRzW3R5cGVdOwoKCSAgaWYgKGlzVW5kZWZpbmVkKGhhbmRsZXIpKQoJICAgIHJldHVybiBmYWxzZTsKCgkgIGlmIChpc0Z1bmN0aW9uKGhhbmRsZXIpKSB7CgkgICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7CgkgICAgICAvLyBmYXN0IGNhc2VzCgkgICAgICBjYXNlIDE6CgkgICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzKTsKCSAgICAgICAgYnJlYWs7CgkgICAgICBjYXNlIDI6CgkgICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0pOwoJICAgICAgICBicmVhazsKCSAgICAgIGNhc2UgMzoKCSAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTsKCSAgICAgICAgYnJlYWs7CgkgICAgICAvLyBzbG93ZXIKCSAgICAgIGRlZmF1bHQ6CgkgICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOwoJICAgICAgICBoYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIH0KCSAgfSBlbHNlIGlmIChpc09iamVjdChoYW5kbGVyKSkgewoJICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOwoJICAgIGxpc3RlbmVycyA9IGhhbmRsZXIuc2xpY2UoKTsKCSAgICBsZW4gPSBsaXN0ZW5lcnMubGVuZ3RoOwoJICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykKCSAgICAgIGxpc3RlbmVyc1tpXS5hcHBseSh0aGlzLCBhcmdzKTsKCSAgfQoKCSAgcmV0dXJuIHRydWU7Cgl9OwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikgewoJICB2YXIgbTsKCgkgIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpCgkgICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTsKCgkgIGlmICghdGhpcy5fZXZlbnRzKQoJICAgIHRoaXMuX2V2ZW50cyA9IHt9OwoKCSAgLy8gVG8gYXZvaWQgcmVjdXJzaW9uIGluIHRoZSBjYXNlIHRoYXQgdHlwZSA9PT0gIm5ld0xpc3RlbmVyIiEgQmVmb3JlCgkgIC8vIGFkZGluZyBpdCB0byB0aGUgbGlzdGVuZXJzLCBmaXJzdCBlbWl0ICJuZXdMaXN0ZW5lciIuCgkgIGlmICh0aGlzLl9ldmVudHMubmV3TGlzdGVuZXIpCgkgICAgdGhpcy5lbWl0KCduZXdMaXN0ZW5lcicsIHR5cGUsCgkgICAgICAgICAgICAgIGlzRnVuY3Rpb24obGlzdGVuZXIubGlzdGVuZXIpID8KCSAgICAgICAgICAgICAgbGlzdGVuZXIubGlzdGVuZXIgOiBsaXN0ZW5lcik7CgoJICBpZiAoIXRoaXMuX2V2ZW50c1t0eXBlXSkKCSAgICAvLyBPcHRpbWl6ZSB0aGUgY2FzZSBvZiBvbmUgbGlzdGVuZXIuIERvbid0IG5lZWQgdGhlIGV4dHJhIGFycmF5IG9iamVjdC4KCSAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjsKCSAgZWxzZSBpZiAoaXNPYmplY3QodGhpcy5fZXZlbnRzW3R5cGVdKSkKCSAgICAvLyBJZiB3ZSd2ZSBhbHJlYWR5IGdvdCBhbiBhcnJheSwganVzdCBhcHBlbmQuCgkgICAgdGhpcy5fZXZlbnRzW3R5cGVdLnB1c2gobGlzdGVuZXIpOwoJICBlbHNlCgkgICAgLy8gQWRkaW5nIHRoZSBzZWNvbmQgZWxlbWVudCwgbmVlZCB0byBjaGFuZ2UgdG8gYXJyYXkuCgkgICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gW3RoaXMuX2V2ZW50c1t0eXBlXSwgbGlzdGVuZXJdOwoKCSAgLy8gQ2hlY2sgZm9yIGxpc3RlbmVyIGxlYWsKCSAgaWYgKGlzT2JqZWN0KHRoaXMuX2V2ZW50c1t0eXBlXSkgJiYgIXRoaXMuX2V2ZW50c1t0eXBlXS53YXJuZWQpIHsKCSAgICBpZiAoIWlzVW5kZWZpbmVkKHRoaXMuX21heExpc3RlbmVycykpIHsKCSAgICAgIG0gPSB0aGlzLl9tYXhMaXN0ZW5lcnM7CgkgICAgfSBlbHNlIHsKCSAgICAgIG0gPSBFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVyczsKCSAgICB9CgoJICAgIGlmIChtICYmIG0gPiAwICYmIHRoaXMuX2V2ZW50c1t0eXBlXS5sZW5ndGggPiBtKSB7CgkgICAgICB0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkID0gdHJ1ZTsKCSAgICAgIGNvbnNvbGUuZXJyb3IoJyhub2RlKSB3YXJuaW5nOiBwb3NzaWJsZSBFdmVudEVtaXR0ZXIgbWVtb3J5ICcgKwoJICAgICAgICAgICAgICAgICAgICAnbGVhayBkZXRlY3RlZC4gJWQgbGlzdGVuZXJzIGFkZGVkLiAnICsKCSAgICAgICAgICAgICAgICAgICAgJ1VzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvIGluY3JlYXNlIGxpbWl0LicsCgkgICAgICAgICAgICAgICAgICAgIHRoaXMuX2V2ZW50c1t0eXBlXS5sZW5ndGgpOwoJICAgICAgaWYgKHR5cGVvZiBjb25zb2xlLnRyYWNlID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICAgIC8vIG5vdCBzdXBwb3J0ZWQgaW4gSUUgMTAKCSAgICAgICAgY29uc29sZS50cmFjZSgpOwoJICAgICAgfQoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUub24gPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyOwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7CgkgIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpCgkgICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTsKCgkgIHZhciBmaXJlZCA9IGZhbHNlOwoKCSAgZnVuY3Rpb24gZygpIHsKCSAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGcpOwoKCSAgICBpZiAoIWZpcmVkKSB7CgkgICAgICBmaXJlZCA9IHRydWU7CgkgICAgICBsaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICAgIH0KCSAgfQoKCSAgZy5saXN0ZW5lciA9IGxpc3RlbmVyOwoJICB0aGlzLm9uKHR5cGUsIGcpOwoKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCS8vIGVtaXRzIGEgJ3JlbW92ZUxpc3RlbmVyJyBldmVudCBpZmYgdGhlIGxpc3RlbmVyIHdhcyByZW1vdmVkCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHsKCSAgdmFyIGxpc3QsIHBvc2l0aW9uLCBsZW5ndGgsIGk7CgoJICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKQoJICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7CgoJICBpZiAoIXRoaXMuX2V2ZW50cyB8fCAhdGhpcy5fZXZlbnRzW3R5cGVdKQoJICAgIHJldHVybiB0aGlzOwoKCSAgbGlzdCA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCSAgbGVuZ3RoID0gbGlzdC5sZW5ndGg7CgkgIHBvc2l0aW9uID0gLTE7CgoJICBpZiAobGlzdCA9PT0gbGlzdGVuZXIgfHwKCSAgICAgIChpc0Z1bmN0aW9uKGxpc3QubGlzdGVuZXIpICYmIGxpc3QubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkgewoJICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07CgkgICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikKCSAgICAgIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lcik7CgoJICB9IGVsc2UgaWYgKGlzT2JqZWN0KGxpc3QpKSB7CgkgICAgZm9yIChpID0gbGVuZ3RoOyBpLS0gPiAwOykgewoJICAgICAgaWYgKGxpc3RbaV0gPT09IGxpc3RlbmVyIHx8CgkgICAgICAgICAgKGxpc3RbaV0ubGlzdGVuZXIgJiYgbGlzdFtpXS5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7CgkgICAgICAgIHBvc2l0aW9uID0gaTsKCSAgICAgICAgYnJlYWs7CgkgICAgICB9CgkgICAgfQoKCSAgICBpZiAocG9zaXRpb24gPCAwKQoJICAgICAgcmV0dXJuIHRoaXM7CgoJICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMSkgewoJICAgICAgbGlzdC5sZW5ndGggPSAwOwoJICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTsKCSAgICB9IGVsc2UgewoJICAgICAgbGlzdC5zcGxpY2UocG9zaXRpb24sIDEpOwoJICAgIH0KCgkgICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikKCSAgICAgIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lcik7CgkgIH0KCgkgIHJldHVybiB0aGlzOwoJfTsKCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycyA9IGZ1bmN0aW9uKHR5cGUpIHsKCSAgdmFyIGtleSwgbGlzdGVuZXJzOwoKCSAgaWYgKCF0aGlzLl9ldmVudHMpCgkgICAgcmV0dXJuIHRoaXM7CgoJICAvLyBub3QgbGlzdGVuaW5nIGZvciByZW1vdmVMaXN0ZW5lciwgbm8gbmVlZCB0byBlbWl0CgkgIGlmICghdGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKSB7CgkgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApCgkgICAgICB0aGlzLl9ldmVudHMgPSB7fTsKCSAgICBlbHNlIGlmICh0aGlzLl9ldmVudHNbdHlwZV0pCgkgICAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdOwoJICAgIHJldHVybiB0aGlzOwoJICB9CgoJICAvLyBlbWl0IHJlbW92ZUxpc3RlbmVyIGZvciBhbGwgbGlzdGVuZXJzIG9uIGFsbCBldmVudHMKCSAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsKCSAgICBmb3IgKGtleSBpbiB0aGlzLl9ldmVudHMpIHsKCSAgICAgIGlmIChrZXkgPT09ICdyZW1vdmVMaXN0ZW5lcicpIGNvbnRpbnVlOwoJICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoa2V5KTsKCSAgICB9CgkgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ3JlbW92ZUxpc3RlbmVyJyk7CgkgICAgdGhpcy5fZXZlbnRzID0ge307CgkgICAgcmV0dXJuIHRoaXM7CgkgIH0KCgkgIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCgkgIGlmIChpc0Z1bmN0aW9uKGxpc3RlbmVycykpIHsKCSAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVycyk7CgkgIH0gZWxzZSBpZiAobGlzdGVuZXJzKSB7CgkgICAgLy8gTElGTyBvcmRlcgoJICAgIHdoaWxlIChsaXN0ZW5lcnMubGVuZ3RoKQoJICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnNbbGlzdGVuZXJzLmxlbmd0aCAtIDFdKTsKCSAgfQoJICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdOwoKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24odHlwZSkgewoJICB2YXIgcmV0OwoJICBpZiAoIXRoaXMuX2V2ZW50cyB8fCAhdGhpcy5fZXZlbnRzW3R5cGVdKQoJICAgIHJldCA9IFtdOwoJICBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoaXMuX2V2ZW50c1t0eXBlXSkpCgkgICAgcmV0ID0gW3RoaXMuX2V2ZW50c1t0eXBlXV07CgkgIGVsc2UKCSAgICByZXQgPSB0aGlzLl9ldmVudHNbdHlwZV0uc2xpY2UoKTsKCSAgcmV0dXJuIHJldDsKCX07CgoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24odHlwZSkgewoJICBpZiAodGhpcy5fZXZlbnRzKSB7CgkgICAgdmFyIGV2bGlzdGVuZXIgPSB0aGlzLl9ldmVudHNbdHlwZV07CgoJICAgIGlmIChpc0Z1bmN0aW9uKGV2bGlzdGVuZXIpKQoJICAgICAgcmV0dXJuIDE7CgkgICAgZWxzZSBpZiAoZXZsaXN0ZW5lcikKCSAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDsKCSAgfQoJICByZXR1cm4gMDsKCX07CgoJRXZlbnRFbWl0dGVyLmxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbihlbWl0dGVyLCB0eXBlKSB7CgkgIHJldHVybiBlbWl0dGVyLmxpc3RlbmVyQ291bnQodHlwZSk7Cgl9OwoKCWZ1bmN0aW9uIGlzRnVuY3Rpb24oYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnZnVuY3Rpb24nOwoJfQoKCWZ1bmN0aW9uIGlzTnVtYmVyKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ251bWJlcic7Cgl9CgoJZnVuY3Rpb24gaXNPYmplY3QoYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiBhcmcgIT09IG51bGw7Cgl9CgoJZnVuY3Rpb24gaXNVbmRlZmluZWQoYXJnKSB7CgkgIHJldHVybiBhcmcgPT09IHZvaWQgMDsKCX0KCgovKioqLyB9LAovKiAyMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjApLkV2ZW50RW1pdHRlcjsKCgovKioqLyB9LAovKiAyMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oQnVmZmVyKSB7LyohCgkgKiBUaGUgYnVmZmVyIG1vZHVsZSBmcm9tIG5vZGUuanMsIGZvciB0aGUgYnJvd3Nlci4KCSAqCgkgKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8ZmVyb3NzQGZlcm9zcy5vcmc+IDxodHRwOi8vZmVyb3NzLm9yZz4KCSAqIEBsaWNlbnNlICBNSVQKCSAqLwoJLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi8KCgkndXNlIHN0cmljdCcKCgl2YXIgYmFzZTY0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KQoJdmFyIGllZWU3NTQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCgoJZXhwb3J0cy5CdWZmZXIgPSBCdWZmZXIKCWV4cG9ydHMuU2xvd0J1ZmZlciA9IFNsb3dCdWZmZXIKCWV4cG9ydHMuSU5TUEVDVF9NQVhfQllURVMgPSA1MAoKCXZhciBLX01BWF9MRU5HVEggPSAweDdmZmZmZmZmCglleHBvcnRzLmtNYXhMZW5ndGggPSBLX01BWF9MRU5HVEgKCgkvKioKCSAqIElmIGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGA6CgkgKiAgID09PSB0cnVlICAgIFVzZSBVaW50OEFycmF5IGltcGxlbWVudGF0aW9uIChmYXN0ZXN0KQoJICogICA9PT0gZmFsc2UgICBQcmludCB3YXJuaW5nIGFuZCByZWNvbW1lbmQgdXNpbmcgYGJ1ZmZlcmAgdjQueCB3aGljaCBoYXMgYW4gT2JqZWN0CgkgKiAgICAgICAgICAgICAgIGltcGxlbWVudGF0aW9uIChtb3N0IGNvbXBhdGlibGUsIGV2ZW4gSUU2KQoJICoKCSAqIEJyb3dzZXJzIHRoYXQgc3VwcG9ydCB0eXBlZCBhcnJheXMgYXJlIElFIDEwKywgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBTYWZhcmkgNS4xKywKCSAqIE9wZXJhIDExLjYrLCBpT1MgNC4yKy4KCSAqCgkgKiBXZSByZXBvcnQgdGhhdCB0aGUgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IHR5cGVkIGFycmF5cyBpZiB0aGUgYXJlIG5vdCBzdWJjbGFzc2FibGUKCSAqIHVzaW5nIF9fcHJvdG9fXy4gRmlyZWZveCA0LTI5IGxhY2tzIHN1cHBvcnQgZm9yIGFkZGluZyBuZXcgcHJvcGVydGllcyB0byBgVWludDhBcnJheWAKCSAqIChTZWU6IGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY5NTQzOCkuIElFIDEwIGxhY2tzIHN1cHBvcnQKCSAqIGZvciBfX3Byb3RvX18gYW5kIGhhcyBhIGJ1Z2d5IHR5cGVkIGFycmF5IGltcGxlbWVudGF0aW9uLgoJICovCglCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCA9IHR5cGVkQXJyYXlTdXBwb3J0KCkKCglpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmIHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJgoJICAgIHR5cGVvZiBjb25zb2xlLmVycm9yID09PSAnZnVuY3Rpb24nKSB7CgkgIGNvbnNvbGUuZXJyb3IoCgkgICAgJ1RoaXMgYnJvd3NlciBsYWNrcyB0eXBlZCBhcnJheSAoVWludDhBcnJheSkgc3VwcG9ydCB3aGljaCBpcyByZXF1aXJlZCBieSAnICsKCSAgICAnYGJ1ZmZlcmAgdjUueC4gVXNlIGBidWZmZXJgIHY0LnggaWYgeW91IHJlcXVpcmUgb2xkIGJyb3dzZXIgc3VwcG9ydC4nCgkgICkKCX0KCglmdW5jdGlvbiB0eXBlZEFycmF5U3VwcG9ydCAoKSB7CgkgIC8vIENhbiB0eXBlZCBhcnJheSBpbnN0YW5jZXMgY2FuIGJlIGF1Z21lbnRlZD8KCSAgdHJ5IHsKCSAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMSkKCSAgICBhcnIuX19wcm90b19fID0ge19fcHJvdG9fXzogVWludDhBcnJheS5wcm90b3R5cGUsIGZvbzogZnVuY3Rpb24gKCkgeyByZXR1cm4gNDIgfX0KCSAgICByZXR1cm4gYXJyLmZvbygpID09PSA0MgoJICB9IGNhdGNoIChlKSB7CgkgICAgcmV0dXJuIGZhbHNlCgkgIH0KCX0KCglmdW5jdGlvbiBjcmVhdGVCdWZmZXIgKGxlbmd0aCkgewoJICBpZiAobGVuZ3RoID4gS19NQVhfTEVOR1RIKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgdHlwZWQgYXJyYXkgbGVuZ3RoJykKCSAgfQoJICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZQoJICB2YXIgYnVmID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKQoJICBidWYuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZQoJICByZXR1cm4gYnVmCgl9CgoJLyoqCgkgKiBUaGUgQnVmZmVyIGNvbnN0cnVjdG9yIHJldHVybnMgaW5zdGFuY2VzIG9mIGBVaW50OEFycmF5YCB0aGF0IGhhdmUgdGhlaXIKCSAqIHByb3RvdHlwZSBjaGFuZ2VkIHRvIGBCdWZmZXIucHJvdG90eXBlYC4gRnVydGhlcm1vcmUsIGBCdWZmZXJgIGlzIGEgc3ViY2xhc3Mgb2YKCSAqIGBVaW50OEFycmF5YCwgc28gdGhlIHJldHVybmVkIGluc3RhbmNlcyB3aWxsIGhhdmUgYWxsIHRoZSBub2RlIGBCdWZmZXJgIG1ldGhvZHMKCSAqIGFuZCB0aGUgYFVpbnQ4QXJyYXlgIG1ldGhvZHMuIFNxdWFyZSBicmFja2V0IG5vdGF0aW9uIHdvcmtzIGFzIGV4cGVjdGVkIC0tIGl0CgkgKiByZXR1cm5zIGEgc2luZ2xlIG9jdGV0LgoJICoKCSAqIFRoZSBgVWludDhBcnJheWAgcHJvdG90eXBlIHJlbWFpbnMgdW5tb2RpZmllZC4KCSAqLwoKCWZ1bmN0aW9uIEJ1ZmZlciAoYXJnLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHsKCSAgLy8gQ29tbW9uIGNhc2UuCgkgIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykgewoJICAgIGlmICh0eXBlb2YgZW5jb2RpbmdPck9mZnNldCA9PT0gJ3N0cmluZycpIHsKCSAgICAgIHRocm93IG5ldyBFcnJvcigKCSAgICAgICAgJ0lmIGVuY29kaW5nIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nJwoJICAgICAgKQoJICAgIH0KCSAgICByZXR1cm4gYWxsb2NVbnNhZmUoYXJnKQoJICB9CgkgIHJldHVybiBmcm9tKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKQoJfQoKCS8vIEZpeCBzdWJhcnJheSgpIGluIEVTMjAxNi4gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZmVyb3NzL2J1ZmZlci9wdWxsLzk3CglpZiAodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnNwZWNpZXMgJiYKCSAgICBCdWZmZXJbU3ltYm9sLnNwZWNpZXNdID09PSBCdWZmZXIpIHsKCSAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1ZmZlciwgU3ltYm9sLnNwZWNpZXMsIHsKCSAgICB2YWx1ZTogbnVsbCwKCSAgICBjb25maWd1cmFibGU6IHRydWUsCgkgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgd3JpdGFibGU6IGZhbHNlCgkgIH0pCgl9CgoJQnVmZmVyLnBvb2xTaXplID0gODE5MiAvLyBub3QgdXNlZCBieSB0aGlzIGltcGxlbWVudGF0aW9uCgoJZnVuY3Rpb24gZnJvbSAodmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkgewoJICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyJ2YWx1ZSIgYXJndW1lbnQgbXVzdCBub3QgYmUgYSBudW1iZXInKQoJICB9CgoJICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgewoJICAgIHJldHVybiBmcm9tQXJyYXlCdWZmZXIodmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkKCSAgfQoKCSAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHsKCSAgICByZXR1cm4gZnJvbVN0cmluZyh2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCkKCSAgfQoKCSAgcmV0dXJuIGZyb21PYmplY3QodmFsdWUpCgl9CgoJLyoqCgkgKiBGdW5jdGlvbmFsbHkgZXF1aXZhbGVudCB0byBCdWZmZXIoYXJnLCBlbmNvZGluZykgYnV0IHRocm93cyBhIFR5cGVFcnJvcgoJICogaWYgdmFsdWUgaXMgYSBudW1iZXIuCgkgKiBCdWZmZXIuZnJvbShzdHJbLCBlbmNvZGluZ10pCgkgKiBCdWZmZXIuZnJvbShhcnJheSkKCSAqIEJ1ZmZlci5mcm9tKGJ1ZmZlcikKCSAqIEJ1ZmZlci5mcm9tKGFycmF5QnVmZmVyWywgYnl0ZU9mZnNldFssIGxlbmd0aF1dKQoJICoqLwoJQnVmZmVyLmZyb20gPSBmdW5jdGlvbiAodmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkgewoJICByZXR1cm4gZnJvbSh2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKQoJfQoKCS8vIE5vdGU6IENoYW5nZSBwcm90b3R5cGUgKmFmdGVyKiBCdWZmZXIuZnJvbSBpcyBkZWZpbmVkIHRvIHdvcmthcm91bmQgQ2hyb21lIGJ1ZzoKCS8vIGh0dHBzOi8vZ2l0aHViLmNvbS9mZXJvc3MvYnVmZmVyL3B1bGwvMTQ4CglCdWZmZXIucHJvdG90eXBlLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXkucHJvdG90eXBlCglCdWZmZXIuX19wcm90b19fID0gVWludDhBcnJheQoKCWZ1bmN0aW9uIGFzc2VydFNpemUgKHNpemUpIHsKCSAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyJzaXplIiBhcmd1bWVudCBtdXN0IGJlIGEgbnVtYmVyJykKCSAgfSBlbHNlIGlmIChzaXplIDwgMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCcic2l6ZSIgYXJndW1lbnQgbXVzdCBub3QgYmUgbmVnYXRpdmUnKQoJICB9Cgl9CgoJZnVuY3Rpb24gYWxsb2MgKHNpemUsIGZpbGwsIGVuY29kaW5nKSB7CgkgIGFzc2VydFNpemUoc2l6ZSkKCSAgaWYgKHNpemUgPD0gMCkgewoJICAgIHJldHVybiBjcmVhdGVCdWZmZXIoc2l6ZSkKCSAgfQoJICBpZiAoZmlsbCAhPT0gdW5kZWZpbmVkKSB7CgkgICAgLy8gT25seSBwYXkgYXR0ZW50aW9uIHRvIGVuY29kaW5nIGlmIGl0J3MgYSBzdHJpbmcuIFRoaXMKCSAgICAvLyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgc2VuZGluZyBpbiBhIG51bWJlciB0aGF0IHdvdWxkCgkgICAgLy8gYmUgaW50ZXJwcmV0dGVkIGFzIGEgc3RhcnQgb2Zmc2V0LgoJICAgIHJldHVybiB0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnCgkgICAgICA/IGNyZWF0ZUJ1ZmZlcihzaXplKS5maWxsKGZpbGwsIGVuY29kaW5nKQoJICAgICAgOiBjcmVhdGVCdWZmZXIoc2l6ZSkuZmlsbChmaWxsKQoJICB9CgkgIHJldHVybiBjcmVhdGVCdWZmZXIoc2l6ZSkKCX0KCgkvKioKCSAqIENyZWF0ZXMgYSBuZXcgZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS4KCSAqIGFsbG9jKHNpemVbLCBmaWxsWywgZW5jb2RpbmddXSkKCSAqKi8KCUJ1ZmZlci5hbGxvYyA9IGZ1bmN0aW9uIChzaXplLCBmaWxsLCBlbmNvZGluZykgewoJICByZXR1cm4gYWxsb2Moc2l6ZSwgZmlsbCwgZW5jb2RpbmcpCgl9CgoJZnVuY3Rpb24gYWxsb2NVbnNhZmUgKHNpemUpIHsKCSAgYXNzZXJ0U2l6ZShzaXplKQoJICByZXR1cm4gY3JlYXRlQnVmZmVyKHNpemUgPCAwID8gMCA6IGNoZWNrZWQoc2l6ZSkgfCAwKQoJfQoKCS8qKgoJICogRXF1aXZhbGVudCB0byBCdWZmZXIobnVtKSwgYnkgZGVmYXVsdCBjcmVhdGVzIGEgbm9uLXplcm8tZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS4KCSAqICovCglCdWZmZXIuYWxsb2NVbnNhZmUgPSBmdW5jdGlvbiAoc2l6ZSkgewoJICByZXR1cm4gYWxsb2NVbnNhZmUoc2l6ZSkKCX0KCS8qKgoJICogRXF1aXZhbGVudCB0byBTbG93QnVmZmVyKG51bSksIGJ5IGRlZmF1bHQgY3JlYXRlcyBhIG5vbi16ZXJvLWZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuCgkgKi8KCUJ1ZmZlci5hbGxvY1Vuc2FmZVNsb3cgPSBmdW5jdGlvbiAoc2l6ZSkgewoJICByZXR1cm4gYWxsb2NVbnNhZmUoc2l6ZSkKCX0KCglmdW5jdGlvbiBmcm9tU3RyaW5nIChzdHJpbmcsIGVuY29kaW5nKSB7CgkgIGlmICh0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnIHx8IGVuY29kaW5nID09PSAnJykgewoJICAgIGVuY29kaW5nID0gJ3V0ZjgnCgkgIH0KCgkgIGlmICghQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignImVuY29kaW5nIiBtdXN0IGJlIGEgdmFsaWQgc3RyaW5nIGVuY29kaW5nJykKCSAgfQoKCSAgdmFyIGxlbmd0aCA9IGJ5dGVMZW5ndGgoc3RyaW5nLCBlbmNvZGluZykgfCAwCgkgIHZhciBidWYgPSBjcmVhdGVCdWZmZXIobGVuZ3RoKQoKCSAgdmFyIGFjdHVhbCA9IGJ1Zi53cml0ZShzdHJpbmcsIGVuY29kaW5nKQoKCSAgaWYgKGFjdHVhbCAhPT0gbGVuZ3RoKSB7CgkgICAgLy8gV3JpdGluZyBhIGhleCBzdHJpbmcsIGZvciBleGFtcGxlLCB0aGF0IGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycyB3aWxsCgkgICAgLy8gY2F1c2UgZXZlcnl0aGluZyBhZnRlciB0aGUgZmlyc3QgaW52YWxpZCBjaGFyYWN0ZXIgdG8gYmUgaWdub3JlZC4gKGUuZy4KCSAgICAvLyAnYWJ4eGNkJyB3aWxsIGJlIHRyZWF0ZWQgYXMgJ2FiJykKCSAgICBidWYgPSBidWYuc2xpY2UoMCwgYWN0dWFsKQoJICB9CgoJICByZXR1cm4gYnVmCgl9CgoJZnVuY3Rpb24gZnJvbUFycmF5TGlrZSAoYXJyYXkpIHsKCSAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aCA8IDAgPyAwIDogY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMAoJICB2YXIgYnVmID0gY3JlYXRlQnVmZmVyKGxlbmd0aCkKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkgewoJICAgIGJ1ZltpXSA9IGFycmF5W2ldICYgMjU1CgkgIH0KCSAgcmV0dXJuIGJ1ZgoJfQoKCWZ1bmN0aW9uIGZyb21BcnJheUJ1ZmZlciAoYXJyYXksIGJ5dGVPZmZzZXQsIGxlbmd0aCkgewoJICBpZiAoYnl0ZU9mZnNldCA8IDAgfHwgYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQpIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXCdvZmZzZXRcJyBpcyBvdXQgb2YgYm91bmRzJykKCSAgfQoKCSAgaWYgKGFycmF5LmJ5dGVMZW5ndGggPCBieXRlT2Zmc2V0ICsgKGxlbmd0aCB8fCAwKSkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcJ2xlbmd0aFwnIGlzIG91dCBvZiBib3VuZHMnKQoJICB9CgoJICB2YXIgYnVmCgkgIGlmIChieXRlT2Zmc2V0ID09PSB1bmRlZmluZWQgJiYgbGVuZ3RoID09PSB1bmRlZmluZWQpIHsKCSAgICBidWYgPSBuZXcgVWludDhBcnJheShhcnJheSkKCSAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkgewoJICAgIGJ1ZiA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0KQoJICB9IGVsc2UgewoJICAgIGJ1ZiA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0LCBsZW5ndGgpCgkgIH0KCgkgIC8vIFJldHVybiBhbiBhdWdtZW50ZWQgYFVpbnQ4QXJyYXlgIGluc3RhbmNlCgkgIGJ1Zi5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlCgkgIHJldHVybiBidWYKCX0KCglmdW5jdGlvbiBmcm9tT2JqZWN0IChvYmopIHsKCSAgaWYgKEJ1ZmZlci5pc0J1ZmZlcihvYmopKSB7CgkgICAgdmFyIGxlbiA9IGNoZWNrZWQob2JqLmxlbmd0aCkgfCAwCgkgICAgdmFyIGJ1ZiA9IGNyZWF0ZUJ1ZmZlcihsZW4pCgoJICAgIGlmIChidWYubGVuZ3RoID09PSAwKSB7CgkgICAgICByZXR1cm4gYnVmCgkgICAgfQoKCSAgICBvYmouY29weShidWYsIDAsIDAsIGxlbikKCSAgICByZXR1cm4gYnVmCgkgIH0KCgkgIGlmIChvYmopIHsKCSAgICBpZiAoaXNBcnJheUJ1ZmZlclZpZXcob2JqKSB8fCAnbGVuZ3RoJyBpbiBvYmopIHsKCSAgICAgIGlmICh0eXBlb2Ygb2JqLmxlbmd0aCAhPT0gJ251bWJlcicgfHwgbnVtYmVySXNOYU4ob2JqLmxlbmd0aCkpIHsKCSAgICAgICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcigwKQoJICAgICAgfQoJICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2Uob2JqKQoJICAgIH0KCgkgICAgaWYgKG9iai50eXBlID09PSAnQnVmZmVyJyAmJiBBcnJheS5pc0FycmF5KG9iai5kYXRhKSkgewoJICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2Uob2JqLmRhdGEpCgkgICAgfQoJICB9CgoJICB0aHJvdyBuZXcgVHlwZUVycm9yKCdGaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nLCBCdWZmZXIsIEFycmF5QnVmZmVyLCBBcnJheSwgb3IgYXJyYXktbGlrZSBvYmplY3QuJykKCX0KCglmdW5jdGlvbiBjaGVja2VkIChsZW5ndGgpIHsKCSAgLy8gTm90ZTogY2Fubm90IHVzZSBgbGVuZ3RoIDwgS19NQVhfTEVOR1RIYCBoZXJlIGJlY2F1c2UgdGhhdCBmYWlscyB3aGVuCgkgIC8vIGxlbmd0aCBpcyBOYU4gKHdoaWNoIGlzIG90aGVyd2lzZSBjb2VyY2VkIHRvIHplcm8uKQoJICBpZiAobGVuZ3RoID49IEtfTUFYX0xFTkdUSCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIGFsbG9jYXRlIEJ1ZmZlciBsYXJnZXIgdGhhbiBtYXhpbXVtICcgKwoJICAgICAgICAgICAgICAgICAgICAgICAgICdzaXplOiAweCcgKyBLX01BWF9MRU5HVEgudG9TdHJpbmcoMTYpICsgJyBieXRlcycpCgkgIH0KCSAgcmV0dXJuIGxlbmd0aCB8IDAKCX0KCglmdW5jdGlvbiBTbG93QnVmZmVyIChsZW5ndGgpIHsKCSAgaWYgKCtsZW5ndGggIT0gbGVuZ3RoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZXFlcWVxCgkgICAgbGVuZ3RoID0gMAoJICB9CgkgIHJldHVybiBCdWZmZXIuYWxsb2MoK2xlbmd0aCkKCX0KCglCdWZmZXIuaXNCdWZmZXIgPSBmdW5jdGlvbiBpc0J1ZmZlciAoYikgewoJICByZXR1cm4gYiAhPSBudWxsICYmIGIuX2lzQnVmZmVyID09PSB0cnVlCgl9CgoJQnVmZmVyLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlIChhLCBiKSB7CgkgIGlmICghQnVmZmVyLmlzQnVmZmVyKGEpIHx8ICFCdWZmZXIuaXNCdWZmZXIoYikpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzJykKCSAgfQoKCSAgaWYgKGEgPT09IGIpIHJldHVybiAwCgoJICB2YXIgeCA9IGEubGVuZ3RoCgkgIHZhciB5ID0gYi5sZW5ndGgKCgkgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBNYXRoLm1pbih4LCB5KTsgaSA8IGxlbjsgKytpKSB7CgkgICAgaWYgKGFbaV0gIT09IGJbaV0pIHsKCSAgICAgIHggPSBhW2ldCgkgICAgICB5ID0gYltpXQoJICAgICAgYnJlYWsKCSAgICB9CgkgIH0KCgkgIGlmICh4IDwgeSkgcmV0dXJuIC0xCgkgIGlmICh5IDwgeCkgcmV0dXJuIDEKCSAgcmV0dXJuIDAKCX0KCglCdWZmZXIuaXNFbmNvZGluZyA9IGZ1bmN0aW9uIGlzRW5jb2RpbmcgKGVuY29kaW5nKSB7CgkgIHN3aXRjaCAoU3RyaW5nKGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpKSB7CgkgICAgY2FzZSAnaGV4JzoKCSAgICBjYXNlICd1dGY4JzoKCSAgICBjYXNlICd1dGYtOCc6CgkgICAgY2FzZSAnYXNjaWknOgoJICAgIGNhc2UgJ2xhdGluMSc6CgkgICAgY2FzZSAnYmluYXJ5JzoKCSAgICBjYXNlICdiYXNlNjQnOgoJICAgIGNhc2UgJ3VjczInOgoJICAgIGNhc2UgJ3Vjcy0yJzoKCSAgICBjYXNlICd1dGYxNmxlJzoKCSAgICBjYXNlICd1dGYtMTZsZSc6CgkgICAgICByZXR1cm4gdHJ1ZQoJICAgIGRlZmF1bHQ6CgkgICAgICByZXR1cm4gZmFsc2UKCSAgfQoJfQoKCUJ1ZmZlci5jb25jYXQgPSBmdW5jdGlvbiBjb25jYXQgKGxpc3QsIGxlbmd0aCkgewoJICBpZiAoIUFycmF5LmlzQXJyYXkobGlzdCkpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcibGlzdCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJykKCSAgfQoKCSAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7CgkgICAgcmV0dXJuIEJ1ZmZlci5hbGxvYygwKQoJICB9CgoJICB2YXIgaQoJICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIHsKCSAgICBsZW5ndGggPSAwCgkgICAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyArK2kpIHsKCSAgICAgIGxlbmd0aCArPSBsaXN0W2ldLmxlbmd0aAoJICAgIH0KCSAgfQoKCSAgdmFyIGJ1ZmZlciA9IEJ1ZmZlci5hbGxvY1Vuc2FmZShsZW5ndGgpCgkgIHZhciBwb3MgPSAwCgkgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7CgkgICAgdmFyIGJ1ZiA9IGxpc3RbaV0KCSAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB7CgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcibGlzdCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJykKCSAgICB9CgkgICAgYnVmLmNvcHkoYnVmZmVyLCBwb3MpCgkgICAgcG9zICs9IGJ1Zi5sZW5ndGgKCSAgfQoJICByZXR1cm4gYnVmZmVyCgl9CgoJZnVuY3Rpb24gYnl0ZUxlbmd0aCAoc3RyaW5nLCBlbmNvZGluZykgewoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKHN0cmluZykpIHsKCSAgICByZXR1cm4gc3RyaW5nLmxlbmd0aAoJICB9CgkgIGlmIChpc0FycmF5QnVmZmVyVmlldyhzdHJpbmcpIHx8IHN0cmluZyBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7CgkgICAgcmV0dXJuIHN0cmluZy5ieXRlTGVuZ3RoCgkgIH0KCSAgaWYgKHR5cGVvZiBzdHJpbmcgIT09ICdzdHJpbmcnKSB7CgkgICAgc3RyaW5nID0gJycgKyBzdHJpbmcKCSAgfQoKCSAgdmFyIGxlbiA9IHN0cmluZy5sZW5ndGgKCSAgaWYgKGxlbiA9PT0gMCkgcmV0dXJuIDAKCgkgIC8vIFVzZSBhIGZvciBsb29wIHRvIGF2b2lkIHJlY3Vyc2lvbgoJICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZQoJICBmb3IgKDs7KSB7CgkgICAgc3dpdGNoIChlbmNvZGluZykgewoJICAgICAgY2FzZSAnYXNjaWknOgoJICAgICAgY2FzZSAnbGF0aW4xJzoKCSAgICAgIGNhc2UgJ2JpbmFyeSc6CgkgICAgICAgIHJldHVybiBsZW4KCSAgICAgIGNhc2UgJ3V0ZjgnOgoJICAgICAgY2FzZSAndXRmLTgnOgoJICAgICAgY2FzZSB1bmRlZmluZWQ6CgkgICAgICAgIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aAoJICAgICAgY2FzZSAndWNzMic6CgkgICAgICBjYXNlICd1Y3MtMic6CgkgICAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIGNhc2UgJ3V0Zi0xNmxlJzoKCSAgICAgICAgcmV0dXJuIGxlbiAqIDIKCSAgICAgIGNhc2UgJ2hleCc6CgkgICAgICAgIHJldHVybiBsZW4gPj4+IDEKCSAgICAgIGNhc2UgJ2Jhc2U2NCc6CgkgICAgICAgIHJldHVybiBiYXNlNjRUb0J5dGVzKHN0cmluZykubGVuZ3RoCgkgICAgICBkZWZhdWx0OgoJICAgICAgICBpZiAobG93ZXJlZENhc2UpIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aCAvLyBhc3N1bWUgdXRmOAoJICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpCgkgICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZQoJICAgIH0KCSAgfQoJfQoJQnVmZmVyLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoCgoJZnVuY3Rpb24gc2xvd1RvU3RyaW5nIChlbmNvZGluZywgc3RhcnQsIGVuZCkgewoJICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZQoKCSAgLy8gTm8gbmVlZCB0byB2ZXJpZnkgdGhhdCAidGhpcy5sZW5ndGggPD0gTUFYX1VJTlQzMiIgc2luY2UgaXQncyBhIHJlYWQtb25seQoJICAvLyBwcm9wZXJ0eSBvZiBhIHR5cGVkIGFycmF5LgoKCSAgLy8gVGhpcyBiZWhhdmVzIG5laXRoZXIgbGlrZSBTdHJpbmcgbm9yIFVpbnQ4QXJyYXkgaW4gdGhhdCB3ZSBzZXQgc3RhcnQvZW5kCgkgIC8vIHRvIHRoZWlyIHVwcGVyL2xvd2VyIGJvdW5kcyBpZiB0aGUgdmFsdWUgcGFzc2VkIGlzIG91dCBvZiByYW5nZS4KCSAgLy8gdW5kZWZpbmVkIGlzIGhhbmRsZWQgc3BlY2lhbGx5IGFzIHBlciBFQ01BLTI2MiA2dGggRWRpdGlvbiwKCSAgLy8gU2VjdGlvbiAxMy4zLjMuNyBSdW50aW1lIFNlbWFudGljczogS2V5ZWRCaW5kaW5nSW5pdGlhbGl6YXRpb24uCgkgIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkIHx8IHN0YXJ0IDwgMCkgewoJICAgIHN0YXJ0ID0gMAoJICB9CgkgIC8vIFJldHVybiBlYXJseSBpZiBzdGFydCA+IHRoaXMubGVuZ3RoLiBEb25lIGhlcmUgdG8gcHJldmVudCBwb3RlbnRpYWwgdWludDMyCgkgIC8vIGNvZXJjaW9uIGZhaWwgYmVsb3cuCgkgIGlmIChzdGFydCA+IHRoaXMubGVuZ3RoKSB7CgkgICAgcmV0dXJuICcnCgkgIH0KCgkgIGlmIChlbmQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPiB0aGlzLmxlbmd0aCkgewoJICAgIGVuZCA9IHRoaXMubGVuZ3RoCgkgIH0KCgkgIGlmIChlbmQgPD0gMCkgewoJICAgIHJldHVybiAnJwoJICB9CgoJICAvLyBGb3JjZSBjb2Vyc2lvbiB0byB1aW50MzIuIFRoaXMgd2lsbCBhbHNvIGNvZXJjZSBmYWxzZXkvTmFOIHZhbHVlcyB0byAwLgoJICBlbmQgPj4+PSAwCgkgIHN0YXJ0ID4+Pj0gMAoKCSAgaWYgKGVuZCA8PSBzdGFydCkgewoJICAgIHJldHVybiAnJwoJICB9CgoJICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4JwoKCSAgd2hpbGUgKHRydWUpIHsKCSAgICBzd2l0Y2ggKGVuY29kaW5nKSB7CgkgICAgICBjYXNlICdoZXgnOgoJICAgICAgICByZXR1cm4gaGV4U2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICd1dGY4JzoKCSAgICAgIGNhc2UgJ3V0Zi04JzoKCSAgICAgICAgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGNhc2UgJ2FzY2lpJzoKCSAgICAgICAgcmV0dXJuIGFzY2lpU2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICdsYXRpbjEnOgoJICAgICAgY2FzZSAnYmluYXJ5JzoKCSAgICAgICAgcmV0dXJuIGxhdGluMVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgY2FzZSAnYmFzZTY0JzoKCSAgICAgICAgcmV0dXJuIGJhc2U2NFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgY2FzZSAndWNzMic6CgkgICAgICBjYXNlICd1Y3MtMic6CgkgICAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIGNhc2UgJ3V0Zi0xNmxlJzoKCSAgICAgICAgcmV0dXJuIHV0ZjE2bGVTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGRlZmF1bHQ6CgkgICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKQoJICAgICAgICBlbmNvZGluZyA9IChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpCgkgICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZQoJICAgIH0KCSAgfQoJfQoKCS8vIFRoaXMgcHJvcGVydHkgaXMgdXNlZCBieSBgQnVmZmVyLmlzQnVmZmVyYCAoYW5kIHRoZSBgaXMtYnVmZmVyYCBucG0gcGFja2FnZSkKCS8vIHRvIGRldGVjdCBhIEJ1ZmZlciBpbnN0YW5jZS4gSXQncyBub3QgcG9zc2libGUgdG8gdXNlIGBpbnN0YW5jZW9mIEJ1ZmZlcmAKCS8vIHJlbGlhYmx5IGluIGEgYnJvd3NlcmlmeSBjb250ZXh0IGJlY2F1c2UgdGhlcmUgY291bGQgYmUgbXVsdGlwbGUgZGlmZmVyZW50CgkvLyBjb3BpZXMgb2YgdGhlICdidWZmZXInIHBhY2thZ2UgaW4gdXNlLiBUaGlzIG1ldGhvZCB3b3JrcyBldmVuIGZvciBCdWZmZXIKCS8vIGluc3RhbmNlcyB0aGF0IHdlcmUgY3JlYXRlZCBmcm9tIGFub3RoZXIgY29weSBvZiB0aGUgYGJ1ZmZlcmAgcGFja2FnZS4KCS8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2Zlcm9zcy9idWZmZXIvaXNzdWVzLzE1NAoJQnVmZmVyLnByb3RvdHlwZS5faXNCdWZmZXIgPSB0cnVlCgoJZnVuY3Rpb24gc3dhcCAoYiwgbiwgbSkgewoJICB2YXIgaSA9IGJbbl0KCSAgYltuXSA9IGJbbV0KCSAgYlttXSA9IGkKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXAxNiA9IGZ1bmN0aW9uIHN3YXAxNiAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgMiAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMTYtYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDEpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXAzMiA9IGZ1bmN0aW9uIHN3YXAzMiAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgNCAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMzItYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDMpCgkgICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDIpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnN3YXA2NCA9IGZ1bmN0aW9uIHN3YXA2NCAoKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBpZiAobGVuICUgOCAhPT0gMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNjQtYml0cycpCgkgIH0KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gOCkgewoJICAgIHN3YXAodGhpcywgaSwgaSArIDcpCgkgICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDYpCgkgICAgc3dhcCh0aGlzLCBpICsgMiwgaSArIDUpCgkgICAgc3dhcCh0aGlzLCBpICsgMywgaSArIDQpCgkgIH0KCSAgcmV0dXJuIHRoaXMKCX0KCglCdWZmZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkgewoJICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgKCSAgaWYgKGxlbmd0aCA9PT0gMCkgcmV0dXJuICcnCgkgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIDAsIGxlbmd0aCkKCSAgcmV0dXJuIHNsb3dUb1N0cmluZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiBlcXVhbHMgKGIpIHsKCSAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYikpIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKQoJICBpZiAodGhpcyA9PT0gYikgcmV0dXJuIHRydWUKCSAgcmV0dXJuIEJ1ZmZlci5jb21wYXJlKHRoaXMsIGIpID09PSAwCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5pbnNwZWN0ID0gZnVuY3Rpb24gaW5zcGVjdCAoKSB7CgkgIHZhciBzdHIgPSAnJwoJICB2YXIgbWF4ID0gZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFUwoJICBpZiAodGhpcy5sZW5ndGggPiAwKSB7CgkgICAgc3RyID0gdGhpcy50b1N0cmluZygnaGV4JywgMCwgbWF4KS5tYXRjaCgvLnsyfS9nKS5qb2luKCcgJykKCSAgICBpZiAodGhpcy5sZW5ndGggPiBtYXgpIHN0ciArPSAnIC4uLiAnCgkgIH0KCSAgcmV0dXJuICc8QnVmZmVyICcgKyBzdHIgKyAnPicKCX0KCglCdWZmZXIucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlICh0YXJnZXQsIHN0YXJ0LCBlbmQsIHRoaXNTdGFydCwgdGhpc0VuZCkgewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcih0YXJnZXQpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpCgkgIH0KCgkgIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgc3RhcnQgPSAwCgkgIH0KCSAgaWYgKGVuZCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgZW5kID0gdGFyZ2V0ID8gdGFyZ2V0Lmxlbmd0aCA6IDAKCSAgfQoJICBpZiAodGhpc1N0YXJ0ID09PSB1bmRlZmluZWQpIHsKCSAgICB0aGlzU3RhcnQgPSAwCgkgIH0KCSAgaWYgKHRoaXNFbmQgPT09IHVuZGVmaW5lZCkgewoJICAgIHRoaXNFbmQgPSB0aGlzLmxlbmd0aAoJICB9CgoJICBpZiAoc3RhcnQgPCAwIHx8IGVuZCA+IHRhcmdldC5sZW5ndGggfHwgdGhpc1N0YXJ0IDwgMCB8fCB0aGlzRW5kID4gdGhpcy5sZW5ndGgpIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignb3V0IG9mIHJhbmdlIGluZGV4JykKCSAgfQoKCSAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kICYmIHN0YXJ0ID49IGVuZCkgewoJICAgIHJldHVybiAwCgkgIH0KCSAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kKSB7CgkgICAgcmV0dXJuIC0xCgkgIH0KCSAgaWYgKHN0YXJ0ID49IGVuZCkgewoJICAgIHJldHVybiAxCgkgIH0KCgkgIHN0YXJ0ID4+Pj0gMAoJICBlbmQgPj4+PSAwCgkgIHRoaXNTdGFydCA+Pj49IDAKCSAgdGhpc0VuZCA+Pj49IDAKCgkgIGlmICh0aGlzID09PSB0YXJnZXQpIHJldHVybiAwCgoJICB2YXIgeCA9IHRoaXNFbmQgLSB0aGlzU3RhcnQKCSAgdmFyIHkgPSBlbmQgLSBzdGFydAoJICB2YXIgbGVuID0gTWF0aC5taW4oeCwgeSkKCgkgIHZhciB0aGlzQ29weSA9IHRoaXMuc2xpY2UodGhpc1N0YXJ0LCB0aGlzRW5kKQoJICB2YXIgdGFyZ2V0Q29weSA9IHRhcmdldC5zbGljZShzdGFydCwgZW5kKQoKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkgewoJICAgIGlmICh0aGlzQ29weVtpXSAhPT0gdGFyZ2V0Q29weVtpXSkgewoJICAgICAgeCA9IHRoaXNDb3B5W2ldCgkgICAgICB5ID0gdGFyZ2V0Q29weVtpXQoJICAgICAgYnJlYWsKCSAgICB9CgkgIH0KCgkgIGlmICh4IDwgeSkgcmV0dXJuIC0xCgkgIGlmICh5IDwgeCkgcmV0dXJuIDEKCSAgcmV0dXJuIDAKCX0KCgkvLyBGaW5kcyBlaXRoZXIgdGhlIGZpcnN0IGluZGV4IG9mIGB2YWxgIGluIGBidWZmZXJgIGF0IG9mZnNldCA+PSBgYnl0ZU9mZnNldGAsCgkvLyBPUiB0aGUgbGFzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPD0gYGJ5dGVPZmZzZXRgLgoJLy8KCS8vIEFyZ3VtZW50czoKCS8vIC0gYnVmZmVyIC0gYSBCdWZmZXIgdG8gc2VhcmNoCgkvLyAtIHZhbCAtIGEgc3RyaW5nLCBCdWZmZXIsIG9yIG51bWJlcgoJLy8gLSBieXRlT2Zmc2V0IC0gYW4gaW5kZXggaW50byBgYnVmZmVyYDsgd2lsbCBiZSBjbGFtcGVkIHRvIGFuIGludDMyCgkvLyAtIGVuY29kaW5nIC0gYW4gb3B0aW9uYWwgZW5jb2RpbmcsIHJlbGV2YW50IGlzIHZhbCBpcyBhIHN0cmluZwoJLy8gLSBkaXIgLSB0cnVlIGZvciBpbmRleE9mLCBmYWxzZSBmb3IgbGFzdEluZGV4T2YKCWZ1bmN0aW9uIGJpZGlyZWN0aW9uYWxJbmRleE9mIChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikgewoJICAvLyBFbXB0eSBidWZmZXIgbWVhbnMgbm8gbWF0Y2gKCSAgaWYgKGJ1ZmZlci5sZW5ndGggPT09IDApIHJldHVybiAtMQoKCSAgLy8gTm9ybWFsaXplIGJ5dGVPZmZzZXQKCSAgaWYgKHR5cGVvZiBieXRlT2Zmc2V0ID09PSAnc3RyaW5nJykgewoJICAgIGVuY29kaW5nID0gYnl0ZU9mZnNldAoJICAgIGJ5dGVPZmZzZXQgPSAwCgkgIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA+IDB4N2ZmZmZmZmYpIHsKCSAgICBieXRlT2Zmc2V0ID0gMHg3ZmZmZmZmZgoJICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAtMHg4MDAwMDAwMCkgewoJICAgIGJ5dGVPZmZzZXQgPSAtMHg4MDAwMDAwMAoJICB9CgkgIGJ5dGVPZmZzZXQgPSArYnl0ZU9mZnNldCAgLy8gQ29lcmNlIHRvIE51bWJlci4KCSAgaWYgKG51bWJlcklzTmFOKGJ5dGVPZmZzZXQpKSB7CgkgICAgLy8gYnl0ZU9mZnNldDogaXQgaXQncyB1bmRlZmluZWQsIG51bGwsIE5hTiwgImZvbyIsIGV0Yywgc2VhcmNoIHdob2xlIGJ1ZmZlcgoJICAgIGJ5dGVPZmZzZXQgPSBkaXIgPyAwIDogKGJ1ZmZlci5sZW5ndGggLSAxKQoJICB9CgoJICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldDogbmVnYXRpdmUgb2Zmc2V0cyBzdGFydCBmcm9tIHRoZSBlbmQgb2YgdGhlIGJ1ZmZlcgoJICBpZiAoYnl0ZU9mZnNldCA8IDApIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoICsgYnl0ZU9mZnNldAoJICBpZiAoYnl0ZU9mZnNldCA+PSBidWZmZXIubGVuZ3RoKSB7CgkgICAgaWYgKGRpcikgcmV0dXJuIC0xCgkgICAgZWxzZSBieXRlT2Zmc2V0ID0gYnVmZmVyLmxlbmd0aCAtIDEKCSAgfSBlbHNlIGlmIChieXRlT2Zmc2V0IDwgMCkgewoJICAgIGlmIChkaXIpIGJ5dGVPZmZzZXQgPSAwCgkgICAgZWxzZSByZXR1cm4gLTEKCSAgfQoKCSAgLy8gTm9ybWFsaXplIHZhbAoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHsKCSAgICB2YWwgPSBCdWZmZXIuZnJvbSh2YWwsIGVuY29kaW5nKQoJICB9CgoJICAvLyBGaW5hbGx5LCBzZWFyY2ggZWl0aGVyIGluZGV4T2YgKGlmIGRpciBpcyB0cnVlKSBvciBsYXN0SW5kZXhPZgoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKHZhbCkpIHsKCSAgICAvLyBTcGVjaWFsIGNhc2U6IGxvb2tpbmcgZm9yIGVtcHR5IHN0cmluZy9idWZmZXIgYWx3YXlzIGZhaWxzCgkgICAgaWYgKHZhbC5sZW5ndGggPT09IDApIHsKCSAgICAgIHJldHVybiAtMQoJICAgIH0KCSAgICByZXR1cm4gYXJyYXlJbmRleE9mKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKQoJICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7CgkgICAgdmFsID0gdmFsICYgMHhGRiAvLyBTZWFyY2ggZm9yIGEgYnl0ZSB2YWx1ZSBbMC0yNTVdCgkgICAgaWYgKHR5cGVvZiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICBpZiAoZGlyKSB7CgkgICAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpCgkgICAgICB9IGVsc2UgewoJICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUubGFzdEluZGV4T2YuY2FsbChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCkKCSAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIFsgdmFsIF0sIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpCgkgIH0KCgkgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ZhbCBtdXN0IGJlIHN0cmluZywgbnVtYmVyIG9yIEJ1ZmZlcicpCgl9CgoJZnVuY3Rpb24gYXJyYXlJbmRleE9mIChhcnIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikgewoJICB2YXIgaW5kZXhTaXplID0gMQoJICB2YXIgYXJyTGVuZ3RoID0gYXJyLmxlbmd0aAoJICB2YXIgdmFsTGVuZ3RoID0gdmFsLmxlbmd0aAoKCSAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQpIHsKCSAgICBlbmNvZGluZyA9IFN0cmluZyhlbmNvZGluZykudG9Mb3dlckNhc2UoKQoJICAgIGlmIChlbmNvZGluZyA9PT0gJ3VjczInIHx8IGVuY29kaW5nID09PSAndWNzLTInIHx8CgkgICAgICAgIGVuY29kaW5nID09PSAndXRmMTZsZScgfHwgZW5jb2RpbmcgPT09ICd1dGYtMTZsZScpIHsKCSAgICAgIGlmIChhcnIubGVuZ3RoIDwgMiB8fCB2YWwubGVuZ3RoIDwgMikgewoJICAgICAgICByZXR1cm4gLTEKCSAgICAgIH0KCSAgICAgIGluZGV4U2l6ZSA9IDIKCSAgICAgIGFyckxlbmd0aCAvPSAyCgkgICAgICB2YWxMZW5ndGggLz0gMgoJICAgICAgYnl0ZU9mZnNldCAvPSAyCgkgICAgfQoJICB9CgoJICBmdW5jdGlvbiByZWFkIChidWYsIGkpIHsKCSAgICBpZiAoaW5kZXhTaXplID09PSAxKSB7CgkgICAgICByZXR1cm4gYnVmW2ldCgkgICAgfSBlbHNlIHsKCSAgICAgIHJldHVybiBidWYucmVhZFVJbnQxNkJFKGkgKiBpbmRleFNpemUpCgkgICAgfQoJICB9CgoJICB2YXIgaQoJICBpZiAoZGlyKSB7CgkgICAgdmFyIGZvdW5kSW5kZXggPSAtMQoJICAgIGZvciAoaSA9IGJ5dGVPZmZzZXQ7IGkgPCBhcnJMZW5ndGg7IGkrKykgewoJICAgICAgaWYgKHJlYWQoYXJyLCBpKSA9PT0gcmVhZCh2YWwsIGZvdW5kSW5kZXggPT09IC0xID8gMCA6IGkgLSBmb3VuZEluZGV4KSkgewoJICAgICAgICBpZiAoZm91bmRJbmRleCA9PT0gLTEpIGZvdW5kSW5kZXggPSBpCgkgICAgICAgIGlmIChpIC0gZm91bmRJbmRleCArIDEgPT09IHZhbExlbmd0aCkgcmV0dXJuIGZvdW5kSW5kZXggKiBpbmRleFNpemUKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGlmIChmb3VuZEluZGV4ICE9PSAtMSkgaSAtPSBpIC0gZm91bmRJbmRleAoJICAgICAgICBmb3VuZEluZGV4ID0gLTEKCSAgICAgIH0KCSAgICB9CgkgIH0gZWxzZSB7CgkgICAgaWYgKGJ5dGVPZmZzZXQgKyB2YWxMZW5ndGggPiBhcnJMZW5ndGgpIGJ5dGVPZmZzZXQgPSBhcnJMZW5ndGggLSB2YWxMZW5ndGgKCSAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpID49IDA7IGktLSkgewoJICAgICAgdmFyIGZvdW5kID0gdHJ1ZQoJICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB2YWxMZW5ndGg7IGorKykgewoJICAgICAgICBpZiAocmVhZChhcnIsIGkgKyBqKSAhPT0gcmVhZCh2YWwsIGopKSB7CgkgICAgICAgICAgZm91bmQgPSBmYWxzZQoJICAgICAgICAgIGJyZWFrCgkgICAgICAgIH0KCSAgICAgIH0KCSAgICAgIGlmIChmb3VuZCkgcmV0dXJuIGkKCSAgICB9CgkgIH0KCgkgIHJldHVybiAtMQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuaW5jbHVkZXMgPSBmdW5jdGlvbiBpbmNsdWRlcyAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgewoJICByZXR1cm4gdGhpcy5pbmRleE9mKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpICE9PSAtMQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHsKCSAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIHRydWUpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5sYXN0SW5kZXhPZiA9IGZ1bmN0aW9uIGxhc3RJbmRleE9mICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7CgkgIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBmYWxzZSkKCX0KCglmdW5jdGlvbiBoZXhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIG9mZnNldCA9IE51bWJlcihvZmZzZXQpIHx8IDAKCSAgdmFyIHJlbWFpbmluZyA9IGJ1Zi5sZW5ndGggLSBvZmZzZXQKCSAgaWYgKCFsZW5ndGgpIHsKCSAgICBsZW5ndGggPSByZW1haW5pbmcKCSAgfSBlbHNlIHsKCSAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKQoJICAgIGlmIChsZW5ndGggPiByZW1haW5pbmcpIHsKCSAgICAgIGxlbmd0aCA9IHJlbWFpbmluZwoJICAgIH0KCSAgfQoKCSAgLy8gbXVzdCBiZSBhbiBldmVuIG51bWJlciBvZiBkaWdpdHMKCSAgdmFyIHN0ckxlbiA9IHN0cmluZy5sZW5ndGgKCSAgaWYgKHN0ckxlbiAlIDIgIT09IDApIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpCgoJICBpZiAobGVuZ3RoID4gc3RyTGVuIC8gMikgewoJICAgIGxlbmd0aCA9IHN0ckxlbiAvIDIKCSAgfQoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CgkgICAgdmFyIHBhcnNlZCA9IHBhcnNlSW50KHN0cmluZy5zdWJzdHIoaSAqIDIsIDIpLCAxNikKCSAgICBpZiAobnVtYmVySXNOYU4ocGFyc2VkKSkgcmV0dXJuIGkKCSAgICBidWZbb2Zmc2V0ICsgaV0gPSBwYXJzZWQKCSAgfQoJICByZXR1cm4gaQoJfQoKCWZ1bmN0aW9uIHV0ZjhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKHV0ZjhUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpCgl9CgoJZnVuY3Rpb24gYXNjaWlXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKGFzY2lpVG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIGxhdGluMVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHsKCSAgcmV0dXJuIGFzY2lpV3JpdGUoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIGJhc2U2NFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHsKCSAgcmV0dXJuIGJsaXRCdWZmZXIoYmFzZTY0VG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIHVjczJXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKHV0ZjE2bGVUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIHdyaXRlIChzdHJpbmcsIG9mZnNldCwgbGVuZ3RoLCBlbmNvZGluZykgewoJICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nKQoJICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIHsKCSAgICBlbmNvZGluZyA9ICd1dGY4JwoJICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoCgkgICAgb2Zmc2V0ID0gMAoJICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBlbmNvZGluZykKCSAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygb2Zmc2V0ID09PSAnc3RyaW5nJykgewoJICAgIGVuY29kaW5nID0gb2Zmc2V0CgkgICAgbGVuZ3RoID0gdGhpcy5sZW5ndGgKCSAgICBvZmZzZXQgPSAwCgkgIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcsIG9mZnNldFssIGxlbmd0aF1bLCBlbmNvZGluZ10pCgkgIH0gZWxzZSBpZiAoaXNGaW5pdGUob2Zmc2V0KSkgewoJICAgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICAgIGlmIChpc0Zpbml0ZShsZW5ndGgpKSB7CgkgICAgICBsZW5ndGggPSBsZW5ndGggPj4+IDAKCSAgICAgIGlmIChlbmNvZGluZyA9PT0gdW5kZWZpbmVkKSBlbmNvZGluZyA9ICd1dGY4JwoJICAgIH0gZWxzZSB7CgkgICAgICBlbmNvZGluZyA9IGxlbmd0aAoJICAgICAgbGVuZ3RoID0gdW5kZWZpbmVkCgkgICAgfQoJICB9IGVsc2UgewoJICAgIHRocm93IG5ldyBFcnJvcigKCSAgICAgICdCdWZmZXIud3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0WywgbGVuZ3RoXSkgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCcKCSAgICApCgkgIH0KCgkgIHZhciByZW1haW5pbmcgPSB0aGlzLmxlbmd0aCAtIG9mZnNldAoJICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgfHwgbGVuZ3RoID4gcmVtYWluaW5nKSBsZW5ndGggPSByZW1haW5pbmcKCgkgIGlmICgoc3RyaW5nLmxlbmd0aCA+IDAgJiYgKGxlbmd0aCA8IDAgfHwgb2Zmc2V0IDwgMCkpIHx8IG9mZnNldCA+IHRoaXMubGVuZ3RoKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gd3JpdGUgb3V0c2lkZSBidWZmZXIgYm91bmRzJykKCSAgfQoKCSAgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSAndXRmOCcKCgkgIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlCgkgIGZvciAoOzspIHsKCSAgICBzd2l0Y2ggKGVuY29kaW5nKSB7CgkgICAgICBjYXNlICdoZXgnOgoJICAgICAgICByZXR1cm4gaGV4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBjYXNlICd1dGY4JzoKCSAgICAgIGNhc2UgJ3V0Zi04JzoKCSAgICAgICAgcmV0dXJuIHV0ZjhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGNhc2UgJ2FzY2lpJzoKCSAgICAgICAgcmV0dXJuIGFzY2lpV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBjYXNlICdsYXRpbjEnOgoJICAgICAgY2FzZSAnYmluYXJ5JzoKCSAgICAgICAgcmV0dXJuIGxhdGluMVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgY2FzZSAnYmFzZTY0JzoKCSAgICAgICAgLy8gV2FybmluZzogbWF4TGVuZ3RoIG5vdCB0YWtlbiBpbnRvIGFjY291bnQgaW4gYmFzZTY0V3JpdGUKCSAgICAgICAgcmV0dXJuIGJhc2U2NFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgY2FzZSAndWNzMic6CgkgICAgICBjYXNlICd1Y3MtMic6CgkgICAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIGNhc2UgJ3V0Zi0xNmxlJzoKCSAgICAgICAgcmV0dXJuIHVjczJXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGRlZmF1bHQ6CgkgICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKQoJICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpCgkgICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZQoJICAgIH0KCSAgfQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gdG9KU09OICgpIHsKCSAgcmV0dXJuIHsKCSAgICB0eXBlOiAnQnVmZmVyJywKCSAgICBkYXRhOiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0aGlzLl9hcnIgfHwgdGhpcywgMCkKCSAgfQoJfQoKCWZ1bmN0aW9uIGJhc2U2NFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgaWYgKHN0YXJ0ID09PSAwICYmIGVuZCA9PT0gYnVmLmxlbmd0aCkgewoJICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYpCgkgIH0gZWxzZSB7CgkgICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1Zi5zbGljZShzdGFydCwgZW5kKSkKCSAgfQoJfQoKCWZ1bmN0aW9uIHV0ZjhTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZCkKCSAgdmFyIHJlcyA9IFtdCgoJICB2YXIgaSA9IHN0YXJ0CgkgIHdoaWxlIChpIDwgZW5kKSB7CgkgICAgdmFyIGZpcnN0Qnl0ZSA9IGJ1ZltpXQoJICAgIHZhciBjb2RlUG9pbnQgPSBudWxsCgkgICAgdmFyIGJ5dGVzUGVyU2VxdWVuY2UgPSAoZmlyc3RCeXRlID4gMHhFRikgPyA0CgkgICAgICA6IChmaXJzdEJ5dGUgPiAweERGKSA/IDMKCSAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4QkYpID8gMgoJICAgICAgOiAxCgoJICAgIGlmIChpICsgYnl0ZXNQZXJTZXF1ZW5jZSA8PSBlbmQpIHsKCSAgICAgIHZhciBzZWNvbmRCeXRlLCB0aGlyZEJ5dGUsIGZvdXJ0aEJ5dGUsIHRlbXBDb2RlUG9pbnQKCgkgICAgICBzd2l0Y2ggKGJ5dGVzUGVyU2VxdWVuY2UpIHsKCSAgICAgICAgY2FzZSAxOgoJICAgICAgICAgIGlmIChmaXJzdEJ5dGUgPCAweDgwKSB7CgkgICAgICAgICAgICBjb2RlUG9pbnQgPSBmaXJzdEJ5dGUKCSAgICAgICAgICB9CgkgICAgICAgICAgYnJlYWsKCSAgICAgICAgY2FzZSAyOgoJICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdCgkgICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHsKCSAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHgxRikgPDwgMHg2IHwgKHNlY29uZEJ5dGUgJiAweDNGKQoJICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGKSB7CgkgICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnQKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgICAgYnJlYWsKCSAgICAgICAgY2FzZSAzOgoJICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdCgkgICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXQoJICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkgewoJICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweEYpIDw8IDB4QyB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKHRoaXJkQnl0ZSAmIDB4M0YpCgkgICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4N0ZGICYmICh0ZW1wQ29kZVBvaW50IDwgMHhEODAwIHx8IHRlbXBDb2RlUG9pbnQgPiAweERGRkYpKSB7CgkgICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnQKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgICAgYnJlYWsKCSAgICAgICAgY2FzZSA0OgoJICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdCgkgICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXQoJICAgICAgICAgIGZvdXJ0aEJ5dGUgPSBidWZbaSArIDNdCgkgICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwICYmIChmb3VydGhCeXRlICYgMHhDMCkgPT09IDB4ODApIHsKCSAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweDEyIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweEMgfCAodGhpcmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKGZvdXJ0aEJ5dGUgJiAweDNGKQoJICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweEZGRkYgJiYgdGVtcENvZGVQb2ludCA8IDB4MTEwMDAwKSB7CgkgICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnQKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICB9CgkgICAgfQoKCSAgICBpZiAoY29kZVBvaW50ID09PSBudWxsKSB7CgkgICAgICAvLyB3ZSBkaWQgbm90IGdlbmVyYXRlIGEgdmFsaWQgY29kZVBvaW50IHNvIGluc2VydCBhCgkgICAgICAvLyByZXBsYWNlbWVudCBjaGFyIChVK0ZGRkQpIGFuZCBhZHZhbmNlIG9ubHkgMSBieXRlCgkgICAgICBjb2RlUG9pbnQgPSAweEZGRkQKCSAgICAgIGJ5dGVzUGVyU2VxdWVuY2UgPSAxCgkgICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPiAweEZGRkYpIHsKCSAgICAgIC8vIGVuY29kZSB0byB1dGYxNiAoc3Vycm9nYXRlIHBhaXIgZGFuY2UpCgkgICAgICBjb2RlUG9pbnQgLT0gMHgxMDAwMAoJICAgICAgcmVzLnB1c2goY29kZVBvaW50ID4+PiAxMCAmIDB4M0ZGIHwgMHhEODAwKQoJICAgICAgY29kZVBvaW50ID0gMHhEQzAwIHwgY29kZVBvaW50ICYgMHgzRkYKCSAgICB9CgoJICAgIHJlcy5wdXNoKGNvZGVQb2ludCkKCSAgICBpICs9IGJ5dGVzUGVyU2VxdWVuY2UKCSAgfQoKCSAgcmV0dXJuIGRlY29kZUNvZGVQb2ludHNBcnJheShyZXMpCgl9CgoJLy8gQmFzZWQgb24gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjI3NDcyNzIvNjgwNzQyLCB0aGUgYnJvd3NlciB3aXRoCgkvLyB0aGUgbG93ZXN0IGxpbWl0IGlzIENocm9tZSwgd2l0aCAweDEwMDAwIGFyZ3MuCgkvLyBXZSBnbyAxIG1hZ25pdHVkZSBsZXNzLCBmb3Igc2FmZXR5Cgl2YXIgTUFYX0FSR1VNRU5UU19MRU5HVEggPSAweDEwMDAKCglmdW5jdGlvbiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkgKGNvZGVQb2ludHMpIHsKCSAgdmFyIGxlbiA9IGNvZGVQb2ludHMubGVuZ3RoCgkgIGlmIChsZW4gPD0gTUFYX0FSR1VNRU5UU19MRU5HVEgpIHsKCSAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsIGNvZGVQb2ludHMpIC8vIGF2b2lkIGV4dHJhIHNsaWNlKCkKCSAgfQoKCSAgLy8gRGVjb2RlIGluIGNodW5rcyB0byBhdm9pZCAiY2FsbCBzdGFjayBzaXplIGV4Y2VlZGVkIi4KCSAgdmFyIHJlcyA9ICcnCgkgIHZhciBpID0gMAoJICB3aGlsZSAoaSA8IGxlbikgewoJICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KAoJICAgICAgU3RyaW5nLAoJICAgICAgY29kZVBvaW50cy5zbGljZShpLCBpICs9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKQoJICAgICkKCSAgfQoJICByZXR1cm4gcmVzCgl9CgoJZnVuY3Rpb24gYXNjaWlTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIHZhciByZXQgPSAnJwoJICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpCgoJICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkgewoJICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSAmIDB4N0YpCgkgIH0KCSAgcmV0dXJuIHJldAoJfQoKCWZ1bmN0aW9uIGxhdGluMVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHsKCSAgdmFyIHJldCA9ICcnCgkgIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZCkKCgkgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7CgkgICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldKQoJICB9CgkgIHJldHVybiByZXQKCX0KCglmdW5jdGlvbiBoZXhTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIHZhciBsZW4gPSBidWYubGVuZ3RoCgoJICBpZiAoIXN0YXJ0IHx8IHN0YXJ0IDwgMCkgc3RhcnQgPSAwCgkgIGlmICghZW5kIHx8IGVuZCA8IDAgfHwgZW5kID4gbGVuKSBlbmQgPSBsZW4KCgkgIHZhciBvdXQgPSAnJwoJICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkgewoJICAgIG91dCArPSB0b0hleChidWZbaV0pCgkgIH0KCSAgcmV0dXJuIG91dAoJfQoKCWZ1bmN0aW9uIHV0ZjE2bGVTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIHZhciBieXRlcyA9IGJ1Zi5zbGljZShzdGFydCwgZW5kKQoJICB2YXIgcmVzID0gJycKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBieXRlcy5sZW5ndGg7IGkgKz0gMikgewoJICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ5dGVzW2ldICsgKGJ5dGVzW2kgKyAxXSAqIDI1NikpCgkgIH0KCSAgcmV0dXJuIHJlcwoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiBzbGljZSAoc3RhcnQsIGVuZCkgewoJICB2YXIgbGVuID0gdGhpcy5sZW5ndGgKCSAgc3RhcnQgPSB+fnN0YXJ0CgkgIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogfn5lbmQKCgkgIGlmIChzdGFydCA8IDApIHsKCSAgICBzdGFydCArPSBsZW4KCSAgICBpZiAoc3RhcnQgPCAwKSBzdGFydCA9IDAKCSAgfSBlbHNlIGlmIChzdGFydCA+IGxlbikgewoJICAgIHN0YXJ0ID0gbGVuCgkgIH0KCgkgIGlmIChlbmQgPCAwKSB7CgkgICAgZW5kICs9IGxlbgoJICAgIGlmIChlbmQgPCAwKSBlbmQgPSAwCgkgIH0gZWxzZSBpZiAoZW5kID4gbGVuKSB7CgkgICAgZW5kID0gbGVuCgkgIH0KCgkgIGlmIChlbmQgPCBzdGFydCkgZW5kID0gc3RhcnQKCgkgIHZhciBuZXdCdWYgPSB0aGlzLnN1YmFycmF5KHN0YXJ0LCBlbmQpCgkgIC8vIFJldHVybiBhbiBhdWdtZW50ZWQgYFVpbnQ4QXJyYXlgIGluc3RhbmNlCgkgIG5ld0J1Zi5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlCgkgIHJldHVybiBuZXdCdWYKCX0KCgkvKgoJICogTmVlZCB0byBtYWtlIHN1cmUgdGhhdCBidWZmZXIgaXNuJ3QgdHJ5aW5nIHRvIHdyaXRlIG91dCBvZiBib3VuZHMuCgkgKi8KCWZ1bmN0aW9uIGNoZWNrT2Zmc2V0IChvZmZzZXQsIGV4dCwgbGVuZ3RoKSB7CgkgIGlmICgob2Zmc2V0ICUgMSkgIT09IDAgfHwgb2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ29mZnNldCBpcyBub3QgdWludCcpCgkgIGlmIChvZmZzZXQgKyBleHQgPiBsZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoJykKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50TEUgPSBmdW5jdGlvbiByZWFkVUludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKQoKCSAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XQoJICB2YXIgbXVsID0gMQoJICB2YXIgaSA9IDAKCSAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHsKCSAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyBpXSAqIG11bAoJICB9CgoJICByZXR1cm4gdmFsCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludEJFID0gZnVuY3Rpb24gcmVhZFVJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpCgkgIH0KCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0KCSAgdmFyIG11bCA9IDEKCSAgd2hpbGUgKGJ5dGVMZW5ndGggPiAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXSAqIG11bAoJICB9CgoJICByZXR1cm4gdmFsCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiByZWFkVUludDggKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiB0aGlzW29mZnNldF0KCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aCkKCSAgcmV0dXJuIHRoaXNbb2Zmc2V0XSB8ICh0aGlzW29mZnNldCArIDFdIDw8IDgpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2QkUgPSBmdW5jdGlvbiByZWFkVUludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDgpIHwgdGhpc1tvZmZzZXQgKyAxXQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoKCSAgcmV0dXJuICgodGhpc1tvZmZzZXRdKSB8CgkgICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8CgkgICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikpICsKCSAgICAgICh0aGlzW29mZnNldCArIDNdICogMHgxMDAwMDAwKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkJFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoKCSAgcmV0dXJuICh0aGlzW29mZnNldF0gKiAweDEwMDAwMDApICsKCSAgICAoKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHwKCSAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8CgkgICAgdGhpc1tvZmZzZXQgKyAzXSkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnRMRSA9IGZ1bmN0aW9uIHJlYWRJbnRMRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCkKCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldF0KCSAgdmFyIG11bCA9IDEKCSAgdmFyIGkgPSAwCgkgIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWwKCSAgfQoJICBtdWwgKj0gMHg4MAoKCSAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkKCgkgIHJldHVybiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnRCRSA9IGZ1bmN0aW9uIHJlYWRJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCkKCgkgIHZhciBpID0gYnl0ZUxlbmd0aAoJICB2YXIgbXVsID0gMQoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWldCgkgIHdoaWxlIChpID4gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0taV0gKiBtdWwKCSAgfQoJICBtdWwgKj0gMHg4MAoKCSAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkKCgkgIHJldHVybiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQ4ID0gZnVuY3Rpb24gcmVhZEludDggKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpCgkgIGlmICghKHRoaXNbb2Zmc2V0XSAmIDB4ODApKSByZXR1cm4gKHRoaXNbb2Zmc2V0XSkKCSAgcmV0dXJuICgoMHhmZiAtIHRoaXNbb2Zmc2V0XSArIDEpICogLTEpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRJbnQxNkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKQoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkKCSAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2QkUgPSBmdW5jdGlvbiByZWFkSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aCkKCSAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgMV0gfCAodGhpc1tvZmZzZXRdIDw8IDgpCgkgIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkxFID0gZnVuY3Rpb24gcmVhZEludDMyTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgoJICByZXR1cm4gKHRoaXNbb2Zmc2V0XSkgfAoJICAgICh0aGlzW29mZnNldCArIDFdIDw8IDgpIHwKCSAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikgfAoJICAgICh0aGlzW29mZnNldCArIDNdIDw8IDI0KQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyQkUgPSBmdW5jdGlvbiByZWFkSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aCkKCgkgIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDI0KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHwKCSAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgM10pCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRMRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdExFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgMjMsIDQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRCRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdEJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgZmFsc2UsIDIzLCA0KQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUxFID0gZnVuY3Rpb24gcmVhZERvdWJsZUxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDgsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgNTIsIDgpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlQkUgPSBmdW5jdGlvbiByZWFkRG91YmxlQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgNTIsIDgpCgl9CgoJZnVuY3Rpb24gY2hlY2tJbnQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikgewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCciYnVmZmVyIiBhcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyIGluc3RhbmNlJykKCSAgaWYgKHZhbHVlID4gbWF4IHx8IHZhbHVlIDwgbWluKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignInZhbHVlIiBhcmd1bWVudCBpcyBvdXQgb2YgYm91bmRzJykKCSAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICB2YXIgbWF4Qnl0ZXMgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkgLSAxCgkgICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbWF4Qnl0ZXMsIDApCgkgIH0KCgkgIHZhciBtdWwgPSAxCgkgIHZhciBpID0gMAoJICB0aGlzW29mZnNldF0gPSB2YWx1ZSAmIDB4RkYKCSAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHsKCSAgICB0aGlzW29mZnNldCArIGldID0gKHZhbHVlIC8gbXVsKSAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlVUludEJFID0gZnVuY3Rpb24gd3JpdGVVSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMQoJICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKQoJICB9CgoJICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxCgkgIHZhciBtdWwgPSAxCgkgIHRoaXNbb2Zmc2V0ICsgaV0gPSB2YWx1ZSAmIDB4RkYKCSAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGCgkgIH0KCgkgIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVVSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4ZmYsIDApCgkgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgIHJldHVybiBvZmZzZXQgKyAxCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMCkKCSAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKQoJICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDgpCgkgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKQoJICByZXR1cm4gb2Zmc2V0ICsgMgoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKQoJICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlID4+PiAyNCkKCSAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpCgkgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpCgkgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgIHJldHVybiBvZmZzZXQgKyA0Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkJFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApCgkgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpCgkgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KQoJICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KQoJICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZikKCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50TEUgPSBmdW5jdGlvbiB3cml0ZUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsICg4ICogYnl0ZUxlbmd0aCkgLSAxKQoKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdCkKCSAgfQoKCSAgdmFyIGkgPSAwCgkgIHZhciBtdWwgPSAxCgkgIHZhciBzdWIgPSAwCgkgIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRgoJICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSAtIDFdICE9PSAwKSB7CgkgICAgICBzdWIgPSAxCgkgICAgfQoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50QkUgPSBmdW5jdGlvbiB3cml0ZUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgPj4+IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsICg4ICogYnl0ZUxlbmd0aCkgLSAxKQoKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdCkKCSAgfQoKCSAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMQoJICB2YXIgbXVsID0gMQoJICB2YXIgc3ViID0gMAoJICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGCgkgIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSArIDFdICE9PSAwKSB7CgkgICAgICBzdWIgPSAxCgkgICAgfQoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50OCA9IGZ1bmN0aW9uIHdyaXRlSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4N2YsIC0weDgwKQoJICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmYgKyB2YWx1ZSArIDEKCSAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgcmV0dXJuIG9mZnNldCArIDEKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMCkKCSAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOCkKCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMCkKCSAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KQoJICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZikKCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKQoJICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKQoJICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KQoJICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiAxNikKCSAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpCgkgIHJldHVybiBvZmZzZXQgKyA0Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMCkKCSAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxCgkgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpCgkgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KQoJICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KQoJICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZikKCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglmdW5jdGlvbiBjaGVja0lFRUU3NTQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikgewoJICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpCgkgIGlmIChvZmZzZXQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJykKCX0KCglmdW5jdGlvbiB3cml0ZUZsb2F0IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0ID4+PiAwCgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA0LCAzLjQwMjgyMzQ2NjM4NTI4ODZlKzM4LCAtMy40MDI4MjM0NjYzODUyODg2ZSszOCkKCSAgfQoJICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCAyMywgNCkKCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRMRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0QkUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydCkKCX0KCglmdW5jdGlvbiB3cml0ZURvdWJsZSAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCA+Pj4gMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgOCwgMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgsIC0xLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCkKCSAgfQoJICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCA1MiwgOCkKCSAgcmV0dXJuIG9mZnNldCArIDgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlTEUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUJFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgcmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydCkKCX0KCgkvLyBjb3B5KHRhcmdldEJ1ZmZlciwgdGFyZ2V0U3RhcnQ9MCwgc291cmNlU3RhcnQ9MCwgc291cmNlRW5kPWJ1ZmZlci5sZW5ndGgpCglCdWZmZXIucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiBjb3B5ICh0YXJnZXQsIHRhcmdldFN0YXJ0LCBzdGFydCwgZW5kKSB7CgkgIGlmICghc3RhcnQpIHN0YXJ0ID0gMAoJICBpZiAoIWVuZCAmJiBlbmQgIT09IDApIGVuZCA9IHRoaXMubGVuZ3RoCgkgIGlmICh0YXJnZXRTdGFydCA+PSB0YXJnZXQubGVuZ3RoKSB0YXJnZXRTdGFydCA9IHRhcmdldC5sZW5ndGgKCSAgaWYgKCF0YXJnZXRTdGFydCkgdGFyZ2V0U3RhcnQgPSAwCgkgIGlmIChlbmQgPiAwICYmIGVuZCA8IHN0YXJ0KSBlbmQgPSBzdGFydAoKCSAgLy8gQ29weSAwIGJ5dGVzOyB3ZSdyZSBkb25lCgkgIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm4gMAoJICBpZiAodGFyZ2V0Lmxlbmd0aCA9PT0gMCB8fCB0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDAKCgkgIC8vIEZhdGFsIGVycm9yIGNvbmRpdGlvbnMKCSAgaWYgKHRhcmdldFN0YXJ0IDwgMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCd0YXJnZXRTdGFydCBvdXQgb2YgYm91bmRzJykKCSAgfQoJICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlU3RhcnQgb3V0IG9mIGJvdW5kcycpCgkgIGlmIChlbmQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlRW5kIG91dCBvZiBib3VuZHMnKQoKCSAgLy8gQXJlIHdlIG9vYj8KCSAgaWYgKGVuZCA+IHRoaXMubGVuZ3RoKSBlbmQgPSB0aGlzLmxlbmd0aAoJICBpZiAodGFyZ2V0Lmxlbmd0aCAtIHRhcmdldFN0YXJ0IDwgZW5kIC0gc3RhcnQpIHsKCSAgICBlbmQgPSB0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgKyBzdGFydAoJICB9CgoJICB2YXIgbGVuID0gZW5kIC0gc3RhcnQKCSAgdmFyIGkKCgkgIGlmICh0aGlzID09PSB0YXJnZXQgJiYgc3RhcnQgPCB0YXJnZXRTdGFydCAmJiB0YXJnZXRTdGFydCA8IGVuZCkgewoJICAgIC8vIGRlc2NlbmRpbmcgY29weSBmcm9tIGVuZAoJICAgIGZvciAoaSA9IGxlbiAtIDE7IGkgPj0gMDsgLS1pKSB7CgkgICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XQoJICAgIH0KCSAgfSBlbHNlIGlmIChsZW4gPCAxMDAwKSB7CgkgICAgLy8gYXNjZW5kaW5nIGNvcHkgZnJvbSBzdGFydAoJICAgIGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSkgewoJICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF0KCSAgICB9CgkgIH0gZWxzZSB7CgkgICAgVWludDhBcnJheS5wcm90b3R5cGUuc2V0LmNhbGwoCgkgICAgICB0YXJnZXQsCgkgICAgICB0aGlzLnN1YmFycmF5KHN0YXJ0LCBzdGFydCArIGxlbiksCgkgICAgICB0YXJnZXRTdGFydAoJICAgICkKCSAgfQoKCSAgcmV0dXJuIGxlbgoJfQoKCS8vIFVzYWdlOgoJLy8gICAgYnVmZmVyLmZpbGwobnVtYmVyWywgb2Zmc2V0WywgZW5kXV0pCgkvLyAgICBidWZmZXIuZmlsbChidWZmZXJbLCBvZmZzZXRbLCBlbmRdXSkKCS8vICAgIGJ1ZmZlci5maWxsKHN0cmluZ1ssIG9mZnNldFssIGVuZF1dWywgZW5jb2RpbmddKQoJQnVmZmVyLnByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gZmlsbCAodmFsLCBzdGFydCwgZW5kLCBlbmNvZGluZykgewoJICAvLyBIYW5kbGUgc3RyaW5nIGNhc2VzOgoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHsKCSAgICBpZiAodHlwZW9mIHN0YXJ0ID09PSAnc3RyaW5nJykgewoJICAgICAgZW5jb2RpbmcgPSBzdGFydAoJICAgICAgc3RhcnQgPSAwCgkgICAgICBlbmQgPSB0aGlzLmxlbmd0aAoJICAgIH0gZWxzZSBpZiAodHlwZW9mIGVuZCA9PT0gJ3N0cmluZycpIHsKCSAgICAgIGVuY29kaW5nID0gZW5kCgkgICAgICBlbmQgPSB0aGlzLmxlbmd0aAoJICAgIH0KCSAgICBpZiAodmFsLmxlbmd0aCA9PT0gMSkgewoJICAgICAgdmFyIGNvZGUgPSB2YWwuY2hhckNvZGVBdCgwKQoJICAgICAgaWYgKGNvZGUgPCAyNTYpIHsKCSAgICAgICAgdmFsID0gY29kZQoJICAgICAgfQoJICAgIH0KCSAgICBpZiAoZW5jb2RpbmcgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnKSB7CgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdlbmNvZGluZyBtdXN0IGJlIGEgc3RyaW5nJykKCSAgICB9CgkgICAgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycgJiYgIUJ1ZmZlci5pc0VuY29kaW5nKGVuY29kaW5nKSkgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKQoJICAgIH0KCSAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykgewoJICAgIHZhbCA9IHZhbCAmIDI1NQoJICB9CgoJICAvLyBJbnZhbGlkIHJhbmdlcyBhcmUgbm90IHNldCB0byBhIGRlZmF1bHQsIHNvIGNhbiByYW5nZSBjaGVjayBlYXJseS4KCSAgaWYgKHN0YXJ0IDwgMCB8fCB0aGlzLmxlbmd0aCA8IHN0YXJ0IHx8IHRoaXMubGVuZ3RoIDwgZW5kKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ091dCBvZiByYW5nZSBpbmRleCcpCgkgIH0KCgkgIGlmIChlbmQgPD0gc3RhcnQpIHsKCSAgICByZXR1cm4gdGhpcwoJICB9CgoJICBzdGFydCA9IHN0YXJ0ID4+PiAwCgkgIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gdGhpcy5sZW5ndGggOiBlbmQgPj4+IDAKCgkgIGlmICghdmFsKSB2YWwgPSAwCgoJICB2YXIgaQoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHsKCSAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7CgkgICAgICB0aGlzW2ldID0gdmFsCgkgICAgfQoJICB9IGVsc2UgewoJICAgIHZhciBieXRlcyA9IEJ1ZmZlci5pc0J1ZmZlcih2YWwpCgkgICAgICA/IHZhbAoJICAgICAgOiBuZXcgQnVmZmVyKHZhbCwgZW5jb2RpbmcpCgkgICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aAoJICAgIGZvciAoaSA9IDA7IGkgPCBlbmQgLSBzdGFydDsgKytpKSB7CgkgICAgICB0aGlzW2kgKyBzdGFydF0gPSBieXRlc1tpICUgbGVuXQoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIHRoaXMKCX0KCgkvLyBIRUxQRVIgRlVOQ1RJT05TCgkvLyA9PT09PT09PT09PT09PT09CgoJdmFyIElOVkFMSURfQkFTRTY0X1JFID0gL1teKy8wLTlBLVphLXotX10vZwoKCWZ1bmN0aW9uIGJhc2U2NGNsZWFuIChzdHIpIHsKCSAgLy8gTm9kZSBzdHJpcHMgb3V0IGludmFsaWQgY2hhcmFjdGVycyBsaWtlIFxuIGFuZCBcdCBmcm9tIHRoZSBzdHJpbmcsIGJhc2U2NC1qcyBkb2VzIG5vdAoJICBzdHIgPSBzdHIudHJpbSgpLnJlcGxhY2UoSU5WQUxJRF9CQVNFNjRfUkUsICcnKQoJICAvLyBOb2RlIGNvbnZlcnRzIHN0cmluZ3Mgd2l0aCBsZW5ndGggPCAyIHRvICcnCgkgIGlmIChzdHIubGVuZ3RoIDwgMikgcmV0dXJuICcnCgkgIC8vIE5vZGUgYWxsb3dzIGZvciBub24tcGFkZGVkIGJhc2U2NCBzdHJpbmdzIChtaXNzaW5nIHRyYWlsaW5nID09PSksIGJhc2U2NC1qcyBkb2VzIG5vdAoJICB3aGlsZSAoc3RyLmxlbmd0aCAlIDQgIT09IDApIHsKCSAgICBzdHIgPSBzdHIgKyAnPScKCSAgfQoJICByZXR1cm4gc3RyCgl9CgoJZnVuY3Rpb24gdG9IZXggKG4pIHsKCSAgaWYgKG4gPCAxNikgcmV0dXJuICcwJyArIG4udG9TdHJpbmcoMTYpCgkgIHJldHVybiBuLnRvU3RyaW5nKDE2KQoJfQoKCWZ1bmN0aW9uIHV0ZjhUb0J5dGVzIChzdHJpbmcsIHVuaXRzKSB7CgkgIHVuaXRzID0gdW5pdHMgfHwgSW5maW5pdHkKCSAgdmFyIGNvZGVQb2ludAoJICB2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aAoJICB2YXIgbGVhZFN1cnJvZ2F0ZSA9IG51bGwKCSAgdmFyIGJ5dGVzID0gW10KCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKCSAgICBjb2RlUG9pbnQgPSBzdHJpbmcuY2hhckNvZGVBdChpKQoKCSAgICAvLyBpcyBzdXJyb2dhdGUgY29tcG9uZW50CgkgICAgaWYgKGNvZGVQb2ludCA+IDB4RDdGRiAmJiBjb2RlUG9pbnQgPCAweEUwMDApIHsKCSAgICAgIC8vIGxhc3QgY2hhciB3YXMgYSBsZWFkCgkgICAgICBpZiAoIWxlYWRTdXJyb2dhdGUpIHsKCSAgICAgICAgLy8gbm8gbGVhZCB5ZXQKCSAgICAgICAgaWYgKGNvZGVQb2ludCA+IDB4REJGRikgewoJICAgICAgICAgIC8vIHVuZXhwZWN0ZWQgdHJhaWwKCSAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRCkKCSAgICAgICAgICBjb250aW51ZQoJICAgICAgICB9IGVsc2UgaWYgKGkgKyAxID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAvLyB1bnBhaXJlZCBsZWFkCgkgICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpCgkgICAgICAgICAgY29udGludWUKCSAgICAgICAgfQoKCSAgICAgICAgLy8gdmFsaWQgbGVhZAoJICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50CgoJICAgICAgICBjb250aW51ZQoJICAgICAgfQoKCSAgICAgIC8vIDIgbGVhZHMgaW4gYSByb3cKCSAgICAgIGlmIChjb2RlUG9pbnQgPCAweERDMDApIHsKCSAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpCgkgICAgICAgIGxlYWRTdXJyb2dhdGUgPSBjb2RlUG9pbnQKCSAgICAgICAgY29udGludWUKCSAgICAgIH0KCgkgICAgICAvLyB2YWxpZCBzdXJyb2dhdGUgcGFpcgoJICAgICAgY29kZVBvaW50ID0gKGxlYWRTdXJyb2dhdGUgLSAweEQ4MDAgPDwgMTAgfCBjb2RlUG9pbnQgLSAweERDMDApICsgMHgxMDAwMAoJICAgIH0gZWxzZSBpZiAobGVhZFN1cnJvZ2F0ZSkgewoJICAgICAgLy8gdmFsaWQgYm1wIGNoYXIsIGJ1dCBsYXN0IGNoYXIgd2FzIGEgbGVhZAoJICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpCgkgICAgfQoKCSAgICBsZWFkU3Vycm9nYXRlID0gbnVsbAoKCSAgICAvLyBlbmNvZGUgdXRmOAoJICAgIGlmIChjb2RlUG9pbnQgPCAweDgwKSB7CgkgICAgICBpZiAoKHVuaXRzIC09IDEpIDwgMCkgYnJlYWsKCSAgICAgIGJ5dGVzLnB1c2goY29kZVBvaW50KQoJICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHg4MDApIHsKCSAgICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVhawoJICAgICAgYnl0ZXMucHVzaCgKCSAgICAgICAgY29kZVBvaW50ID4+IDB4NiB8IDB4QzAsCgkgICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwCgkgICAgICApCgkgICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDEwMDAwKSB7CgkgICAgICBpZiAoKHVuaXRzIC09IDMpIDwgMCkgYnJlYWsKCSAgICAgIGJ5dGVzLnB1c2goCgkgICAgICAgIGNvZGVQb2ludCA+PiAweEMgfCAweEUwLAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsCgkgICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwCgkgICAgICApCgkgICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDExMDAwMCkgewoJICAgICAgaWYgKCh1bml0cyAtPSA0KSA8IDApIGJyZWFrCgkgICAgICBieXRlcy5wdXNoKAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHgxMiB8IDB4RjAsCgkgICAgICAgIGNvZGVQb2ludCA+PiAweEMgJiAweDNGIHwgMHg4MCwKCSAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLAoJICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MAoJICAgICAgKQoJICAgIH0gZWxzZSB7CgkgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY29kZSBwb2ludCcpCgkgICAgfQoJICB9CgoJICByZXR1cm4gYnl0ZXMKCX0KCglmdW5jdGlvbiBhc2NpaVRvQnl0ZXMgKHN0cikgewoJICB2YXIgYnl0ZUFycmF5ID0gW10KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyArK2kpIHsKCSAgICAvLyBOb2RlJ3MgY29kZSBzZWVtcyB0byBiZSBkb2luZyB0aGlzIGFuZCBub3QgJiAweDdGLi4KCSAgICBieXRlQXJyYXkucHVzaChzdHIuY2hhckNvZGVBdChpKSAmIDB4RkYpCgkgIH0KCSAgcmV0dXJuIGJ5dGVBcnJheQoJfQoKCWZ1bmN0aW9uIHV0ZjE2bGVUb0J5dGVzIChzdHIsIHVuaXRzKSB7CgkgIHZhciBjLCBoaSwgbG8KCSAgdmFyIGJ5dGVBcnJheSA9IFtdCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7CgkgICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrCgoJICAgIGMgPSBzdHIuY2hhckNvZGVBdChpKQoJICAgIGhpID0gYyA+PiA4CgkgICAgbG8gPSBjICUgMjU2CgkgICAgYnl0ZUFycmF5LnB1c2gobG8pCgkgICAgYnl0ZUFycmF5LnB1c2goaGkpCgkgIH0KCgkgIHJldHVybiBieXRlQXJyYXkKCX0KCglmdW5jdGlvbiBiYXNlNjRUb0J5dGVzIChzdHIpIHsKCSAgcmV0dXJuIGJhc2U2NC50b0J5dGVBcnJheShiYXNlNjRjbGVhbihzdHIpKQoJfQoKCWZ1bmN0aW9uIGJsaXRCdWZmZXIgKHNyYywgZHN0LCBvZmZzZXQsIGxlbmd0aCkgewoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CgkgICAgaWYgKChpICsgb2Zmc2V0ID49IGRzdC5sZW5ndGgpIHx8IChpID49IHNyYy5sZW5ndGgpKSBicmVhawoJICAgIGRzdFtpICsgb2Zmc2V0XSA9IHNyY1tpXQoJICB9CgkgIHJldHVybiBpCgl9CgoJLy8gTm9kZSAwLjEwIHN1cHBvcnRzIGBBcnJheUJ1ZmZlcmAgYnV0IGxhY2tzIGBBcnJheUJ1ZmZlci5pc1ZpZXdgCglmdW5jdGlvbiBpc0FycmF5QnVmZmVyVmlldyAob2JqKSB7CgkgIHJldHVybiAodHlwZW9mIEFycmF5QnVmZmVyLmlzVmlldyA9PT0gJ2Z1bmN0aW9uJykgJiYgQXJyYXlCdWZmZXIuaXNWaWV3KG9iaikKCX0KCglmdW5jdGlvbiBudW1iZXJJc05hTiAob2JqKSB7CgkgIHJldHVybiBvYmogIT09IG9iaiAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXNlbGYtY29tcGFyZQoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpLkJ1ZmZlcikpCgovKioqLyB9LAovKiAyMyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7J3VzZSBzdHJpY3QnOwoKCXZhciBidWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKTsKCXZhciBCdWZmZXIgPSBidWZmZXIuQnVmZmVyOwoJdmFyIFNsb3dCdWZmZXIgPSBidWZmZXIuU2xvd0J1ZmZlcjsKCXZhciBNQVhfTEVOID0gYnVmZmVyLmtNYXhMZW5ndGggfHwgMjE0NzQ4MzY0NzsKCWV4cG9ydHMuYWxsb2MgPSBmdW5jdGlvbiBhbGxvYyhzaXplLCBmaWxsLCBlbmNvZGluZykgewoJICBpZiAodHlwZW9mIEJ1ZmZlci5hbGxvYyA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIHJldHVybiBCdWZmZXIuYWxsb2Moc2l6ZSwgZmlsbCwgZW5jb2RpbmcpOwoJICB9CgkgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZW5jb2RpbmcgbXVzdCBub3QgYmUgbnVtYmVyJyk7CgkgIH0KCSAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3NpemUgbXVzdCBiZSBhIG51bWJlcicpOwoJICB9CgkgIGlmIChzaXplID4gTUFYX0xFTikgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdzaXplIGlzIHRvbyBsYXJnZScpOwoJICB9CgkgIHZhciBlbmMgPSBlbmNvZGluZzsKCSAgdmFyIF9maWxsID0gZmlsbDsKCSAgaWYgKF9maWxsID09PSB1bmRlZmluZWQpIHsKCSAgICBlbmMgPSB1bmRlZmluZWQ7CgkgICAgX2ZpbGwgPSAwOwoJICB9CgkgIHZhciBidWYgPSBuZXcgQnVmZmVyKHNpemUpOwoJICBpZiAodHlwZW9mIF9maWxsID09PSAnc3RyaW5nJykgewoJICAgIHZhciBmaWxsQnVmID0gbmV3IEJ1ZmZlcihfZmlsbCwgZW5jKTsKCSAgICB2YXIgZmxlbiA9IGZpbGxCdWYubGVuZ3RoOwoJICAgIHZhciBpID0gLTE7CgkgICAgd2hpbGUgKCsraSA8IHNpemUpIHsKCSAgICAgIGJ1ZltpXSA9IGZpbGxCdWZbaSAlIGZsZW5dOwoJICAgIH0KCSAgfSBlbHNlIHsKCSAgICBidWYuZmlsbChfZmlsbCk7CgkgIH0KCSAgcmV0dXJuIGJ1ZjsKCX0KCWV4cG9ydHMuYWxsb2NVbnNhZmUgPSBmdW5jdGlvbiBhbGxvY1Vuc2FmZShzaXplKSB7CgkgIGlmICh0eXBlb2YgQnVmZmVyLmFsbG9jVW5zYWZlID09PSAnZnVuY3Rpb24nKSB7CgkgICAgcmV0dXJuIEJ1ZmZlci5hbGxvY1Vuc2FmZShzaXplKTsKCSAgfQoJICBpZiAodHlwZW9mIHNpemUgIT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignc2l6ZSBtdXN0IGJlIGEgbnVtYmVyJyk7CgkgIH0KCSAgaWYgKHNpemUgPiBNQVhfTEVOKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NpemUgaXMgdG9vIGxhcmdlJyk7CgkgIH0KCSAgcmV0dXJuIG5ldyBCdWZmZXIoc2l6ZSk7Cgl9CglleHBvcnRzLmZyb20gPSBmdW5jdGlvbiBmcm9tKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHsKCSAgaWYgKHR5cGVvZiBCdWZmZXIuZnJvbSA9PT0gJ2Z1bmN0aW9uJyAmJiAoIWdsb2JhbC5VaW50OEFycmF5IHx8IFVpbnQ4QXJyYXkuZnJvbSAhPT0gQnVmZmVyLmZyb20pKSB7CgkgICAgcmV0dXJuIEJ1ZmZlci5mcm9tKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpOwoJICB9CgkgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignInZhbHVlIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpOwoJICB9CgkgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7CgkgICAgcmV0dXJuIG5ldyBCdWZmZXIodmFsdWUsIGVuY29kaW5nT3JPZmZzZXQpOwoJICB9CgkgIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIHZhbHVlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsKCSAgICB2YXIgb2Zmc2V0ID0gZW5jb2RpbmdPck9mZnNldDsKCSAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkgewoJICAgICAgcmV0dXJuIG5ldyBCdWZmZXIodmFsdWUpOwoJICAgIH0KCSAgICBpZiAodHlwZW9mIG9mZnNldCA9PT0gJ3VuZGVmaW5lZCcpIHsKCSAgICAgIG9mZnNldCA9IDA7CgkgICAgfQoJICAgIHZhciBsZW4gPSBsZW5ndGg7CgkgICAgaWYgKHR5cGVvZiBsZW4gPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICBsZW4gPSB2YWx1ZS5ieXRlTGVuZ3RoIC0gb2Zmc2V0OwoJICAgIH0KCSAgICBpZiAob2Zmc2V0ID49IHZhbHVlLmJ5dGVMZW5ndGgpIHsKCSAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcJ29mZnNldFwnIGlzIG91dCBvZiBib3VuZHMnKTsKCSAgICB9CgkgICAgaWYgKGxlbiA+IHZhbHVlLmJ5dGVMZW5ndGggLSBvZmZzZXQpIHsKCSAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcJ2xlbmd0aFwnIGlzIG91dCBvZiBib3VuZHMnKTsKCSAgICB9CgkgICAgcmV0dXJuIG5ldyBCdWZmZXIodmFsdWUuc2xpY2Uob2Zmc2V0LCBvZmZzZXQgKyBsZW4pKTsKCSAgfQoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKHZhbHVlKSkgewoJICAgIHZhciBvdXQgPSBuZXcgQnVmZmVyKHZhbHVlLmxlbmd0aCk7CgkgICAgdmFsdWUuY29weShvdXQsIDAsIDAsIHZhbHVlLmxlbmd0aCk7CgkgICAgcmV0dXJuIG91dDsKCSAgfQoJICBpZiAodmFsdWUpIHsKCSAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgfHwgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHx8ICdsZW5ndGgnIGluIHZhbHVlKSB7CgkgICAgICByZXR1cm4gbmV3IEJ1ZmZlcih2YWx1ZSk7CgkgICAgfQoJICAgIGlmICh2YWx1ZS50eXBlID09PSAnQnVmZmVyJyAmJiBBcnJheS5pc0FycmF5KHZhbHVlLmRhdGEpKSB7CgkgICAgICByZXR1cm4gbmV3IEJ1ZmZlcih2YWx1ZS5kYXRhKTsKCSAgICB9CgkgIH0KCgkgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgJyArICdBcnJheUJ1ZmZlciwgQXJyYXksIG9yIGFycmF5LWxpa2Ugb2JqZWN0LicpOwoJfQoJZXhwb3J0cy5hbGxvY1Vuc2FmZVNsb3cgPSBmdW5jdGlvbiBhbGxvY1Vuc2FmZVNsb3coc2l6ZSkgewoJICBpZiAodHlwZW9mIEJ1ZmZlci5hbGxvY1Vuc2FmZVNsb3cgPT09ICdmdW5jdGlvbicpIHsKCSAgICByZXR1cm4gQnVmZmVyLmFsbG9jVW5zYWZlU2xvdyhzaXplKTsKCSAgfQoJICBpZiAodHlwZW9mIHNpemUgIT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignc2l6ZSBtdXN0IGJlIGEgbnVtYmVyJyk7CgkgIH0KCSAgaWYgKHNpemUgPj0gTUFYX0xFTikgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdzaXplIGlzIHRvbyBsYXJnZScpOwoJICB9CgkgIHJldHVybiBuZXcgU2xvd0J1ZmZlcihzaXplKTsKCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpCgovKioqLyB9LAovKiAyNCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oQnVmZmVyKSB7Ly8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuCgkvLwoJLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKCS8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKCS8vICJTb2Z0d2FyZSIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcKCS8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwKCS8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQKCS8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZQoJLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6CgkvLwoJLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQKCS8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgoJLy8KCS8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTCgkvLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GCgkvLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOCgkvLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwKCS8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUgoJLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRQoJLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KCgkvLyBOT1RFOiBUaGVzZSB0eXBlIGNoZWNraW5nIGZ1bmN0aW9ucyBpbnRlbnRpb25hbGx5IGRvbid0IHVzZSBgaW5zdGFuY2VvZmAKCS8vIGJlY2F1c2UgaXQgaXMgZnJhZ2lsZSBhbmQgY2FuIGJlIGVhc2lseSBmYWtlZCB3aXRoIGBPYmplY3QuY3JlYXRlKClgLgoKCWZ1bmN0aW9uIGlzQXJyYXkoYXJnKSB7CgkgIGlmIChBcnJheS5pc0FycmF5KSB7CgkgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoYXJnKTsKCSAgfQoJICByZXR1cm4gb2JqZWN0VG9TdHJpbmcoYXJnKSA9PT0gJ1tvYmplY3QgQXJyYXldJzsKCX0KCWV4cG9ydHMuaXNBcnJheSA9IGlzQXJyYXk7CgoJZnVuY3Rpb24gaXNCb29sZWFuKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Jvb2xlYW4nOwoJfQoJZXhwb3J0cy5pc0Jvb2xlYW4gPSBpc0Jvb2xlYW47CgoJZnVuY3Rpb24gaXNOdWxsKGFyZykgewoJICByZXR1cm4gYXJnID09PSBudWxsOwoJfQoJZXhwb3J0cy5pc051bGwgPSBpc051bGw7CgoJZnVuY3Rpb24gaXNOdWxsT3JVbmRlZmluZWQoYXJnKSB7CgkgIHJldHVybiBhcmcgPT0gbnVsbDsKCX0KCWV4cG9ydHMuaXNOdWxsT3JVbmRlZmluZWQgPSBpc051bGxPclVuZGVmaW5lZDsKCglmdW5jdGlvbiBpc051bWJlcihhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdudW1iZXInOwoJfQoJZXhwb3J0cy5pc051bWJlciA9IGlzTnVtYmVyOwoKCWZ1bmN0aW9uIGlzU3RyaW5nKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ3N0cmluZyc7Cgl9CglleHBvcnRzLmlzU3RyaW5nID0gaXNTdHJpbmc7CgoJZnVuY3Rpb24gaXNTeW1ib2woYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnc3ltYm9sJzsKCX0KCWV4cG9ydHMuaXNTeW1ib2wgPSBpc1N5bWJvbDsKCglmdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHsKCSAgcmV0dXJuIGFyZyA9PT0gdm9pZCAwOwoJfQoJZXhwb3J0cy5pc1VuZGVmaW5lZCA9IGlzVW5kZWZpbmVkOwoKCWZ1bmN0aW9uIGlzUmVnRXhwKHJlKSB7CgkgIHJldHVybiBvYmplY3RUb1N0cmluZyhyZSkgPT09ICdbb2JqZWN0IFJlZ0V4cF0nOwoJfQoJZXhwb3J0cy5pc1JlZ0V4cCA9IGlzUmVnRXhwOwoKCWZ1bmN0aW9uIGlzT2JqZWN0KGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsOwoJfQoJZXhwb3J0cy5pc09iamVjdCA9IGlzT2JqZWN0OwoKCWZ1bmN0aW9uIGlzRGF0ZShkKSB7CgkgIHJldHVybiBvYmplY3RUb1N0cmluZyhkKSA9PT0gJ1tvYmplY3QgRGF0ZV0nOwoJfQoJZXhwb3J0cy5pc0RhdGUgPSBpc0RhdGU7CgoJZnVuY3Rpb24gaXNFcnJvcihlKSB7CgkgIHJldHVybiAob2JqZWN0VG9TdHJpbmcoZSkgPT09ICdbb2JqZWN0IEVycm9yXScgfHwgZSBpbnN0YW5jZW9mIEVycm9yKTsKCX0KCWV4cG9ydHMuaXNFcnJvciA9IGlzRXJyb3I7CgoJZnVuY3Rpb24gaXNGdW5jdGlvbihhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdmdW5jdGlvbic7Cgl9CglleHBvcnRzLmlzRnVuY3Rpb24gPSBpc0Z1bmN0aW9uOwoKCWZ1bmN0aW9uIGlzUHJpbWl0aXZlKGFyZykgewoJICByZXR1cm4gYXJnID09PSBudWxsIHx8CgkgICAgICAgICB0eXBlb2YgYXJnID09PSAnYm9vbGVhbicgfHwKCSAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdudW1iZXInIHx8CgkgICAgICAgICB0eXBlb2YgYXJnID09PSAnc3RyaW5nJyB8fAoJICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ3N5bWJvbCcgfHwgIC8vIEVTNiBzeW1ib2wKCSAgICAgICAgIHR5cGVvZiBhcmcgPT09ICd1bmRlZmluZWQnOwoJfQoJZXhwb3J0cy5pc1ByaW1pdGl2ZSA9IGlzUHJpbWl0aXZlOwoKCWV4cG9ydHMuaXNCdWZmZXIgPSBCdWZmZXIuaXNCdWZmZXI7CgoJZnVuY3Rpb24gb2JqZWN0VG9TdHJpbmcobykgewoJICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pOwoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpLkJ1ZmZlcikpCgovKioqLyB9LAovKiAyNSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvKiAoaWdub3JlZCkgKi8KCi8qKiovIH0sCi8qIDI2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCgl2YXIgQnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikuQnVmZmVyOwoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBidWZmZXJTaGltID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgltb2R1bGUuZXhwb3J0cyA9IEJ1ZmZlckxpc3Q7CgoJZnVuY3Rpb24gQnVmZmVyTGlzdCgpIHsKCSAgdGhpcy5oZWFkID0gbnVsbDsKCSAgdGhpcy50YWlsID0gbnVsbDsKCSAgdGhpcy5sZW5ndGggPSAwOwoJfQoKCUJ1ZmZlckxpc3QucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAodikgewoJICB2YXIgZW50cnkgPSB7IGRhdGE6IHYsIG5leHQ6IG51bGwgfTsKCSAgaWYgKHRoaXMubGVuZ3RoID4gMCkgdGhpcy50YWlsLm5leHQgPSBlbnRyeTtlbHNlIHRoaXMuaGVhZCA9IGVudHJ5OwoJICB0aGlzLnRhaWwgPSBlbnRyeTsKCSAgKyt0aGlzLmxlbmd0aDsKCX07CgoJQnVmZmVyTGlzdC5wcm90b3R5cGUudW5zaGlmdCA9IGZ1bmN0aW9uICh2KSB7CgkgIHZhciBlbnRyeSA9IHsgZGF0YTogdiwgbmV4dDogdGhpcy5oZWFkIH07CgkgIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkgdGhpcy50YWlsID0gZW50cnk7CgkgIHRoaXMuaGVhZCA9IGVudHJ5OwoJICArK3RoaXMubGVuZ3RoOwoJfTsKCglCdWZmZXJMaXN0LnByb3RvdHlwZS5zaGlmdCA9IGZ1bmN0aW9uICgpIHsKCSAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm47CgkgIHZhciByZXQgPSB0aGlzLmhlYWQuZGF0YTsKCSAgaWYgKHRoaXMubGVuZ3RoID09PSAxKSB0aGlzLmhlYWQgPSB0aGlzLnRhaWwgPSBudWxsO2Vsc2UgdGhpcy5oZWFkID0gdGhpcy5oZWFkLm5leHQ7CgkgIC0tdGhpcy5sZW5ndGg7CgkgIHJldHVybiByZXQ7Cgl9OwoKCUJ1ZmZlckxpc3QucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICB0aGlzLmhlYWQgPSB0aGlzLnRhaWwgPSBudWxsOwoJICB0aGlzLmxlbmd0aCA9IDA7Cgl9OwoKCUJ1ZmZlckxpc3QucHJvdG90eXBlLmpvaW4gPSBmdW5jdGlvbiAocykgewoJICBpZiAodGhpcy5sZW5ndGggPT09IDApIHJldHVybiAnJzsKCSAgdmFyIHAgPSB0aGlzLmhlYWQ7CgkgIHZhciByZXQgPSAnJyArIHAuZGF0YTsKCSAgd2hpbGUgKHAgPSBwLm5leHQpIHsKCSAgICByZXQgKz0gcyArIHAuZGF0YTsKCSAgfXJldHVybiByZXQ7Cgl9OwoKCUJ1ZmZlckxpc3QucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uIChuKSB7CgkgIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGJ1ZmZlclNoaW0uYWxsb2MoMCk7CgkgIGlmICh0aGlzLmxlbmd0aCA9PT0gMSkgcmV0dXJuIHRoaXMuaGVhZC5kYXRhOwoJICB2YXIgcmV0ID0gYnVmZmVyU2hpbS5hbGxvY1Vuc2FmZShuID4+PiAwKTsKCSAgdmFyIHAgPSB0aGlzLmhlYWQ7CgkgIHZhciBpID0gMDsKCSAgd2hpbGUgKHApIHsKCSAgICBwLmRhdGEuY29weShyZXQsIGkpOwoJICAgIGkgKz0gcC5kYXRhLmxlbmd0aDsKCSAgICBwID0gcC5uZXh0OwoJICB9CgkgIHJldHVybiByZXQ7Cgl9OwoKLyoqKi8gfSwKLyogMjcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gYSBkdXBsZXggc3RyZWFtIGlzIGp1c3QgYSBzdHJlYW0gdGhhdCBpcyBib3RoIHJlYWRhYmxlIGFuZCB3cml0YWJsZS4KCS8vIFNpbmNlIEpTIGRvZXNuJ3QgaGF2ZSBtdWx0aXBsZSBwcm90b3R5cGFsIGluaGVyaXRhbmNlLCB0aGlzIGNsYXNzCgkvLyBwcm90b3R5cGFsbHkgaW5oZXJpdHMgZnJvbSBSZWFkYWJsZSwgYW5kIHRoZW4gcGFyYXNpdGljYWxseSBmcm9tCgkvLyBXcml0YWJsZS4KCgkndXNlIHN0cmljdCc7CgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCgl2YXIgb2JqZWN0S2V5cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIChvYmopIHsKCSAgdmFyIGtleXMgPSBbXTsKCSAgZm9yICh2YXIga2V5IGluIG9iaikgewoJICAgIGtleXMucHVzaChrZXkpOwoJICB9cmV0dXJuIGtleXM7Cgl9OwoJLyo8L3JlcGxhY2VtZW50PiovCgoJbW9kdWxlLmV4cG9ydHMgPSBEdXBsZXg7CgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBwcm9jZXNzTmV4dFRpY2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgdXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwoJdXRpbC5pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJdmFyIFJlYWRhYmxlID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7Cgl2YXIgV3JpdGFibGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KTsKCgl1dGlsLmluaGVyaXRzKER1cGxleCwgUmVhZGFibGUpOwoKCXZhciBrZXlzID0gb2JqZWN0S2V5cyhXcml0YWJsZS5wcm90b3R5cGUpOwoJZm9yICh2YXIgdiA9IDA7IHYgPCBrZXlzLmxlbmd0aDsgdisrKSB7CgkgIHZhciBtZXRob2QgPSBrZXlzW3ZdOwoJICBpZiAoIUR1cGxleC5wcm90b3R5cGVbbWV0aG9kXSkgRHVwbGV4LnByb3RvdHlwZVttZXRob2RdID0gV3JpdGFibGUucHJvdG90eXBlW21ldGhvZF07Cgl9CgoJZnVuY3Rpb24gRHVwbGV4KG9wdGlvbnMpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIER1cGxleCkpIHJldHVybiBuZXcgRHVwbGV4KG9wdGlvbnMpOwoKCSAgUmVhZGFibGUuY2FsbCh0aGlzLCBvcHRpb25zKTsKCSAgV3JpdGFibGUuY2FsbCh0aGlzLCBvcHRpb25zKTsKCgkgIGlmIChvcHRpb25zICYmIG9wdGlvbnMucmVhZGFibGUgPT09IGZhbHNlKSB0aGlzLnJlYWRhYmxlID0gZmFsc2U7CgoJICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLndyaXRhYmxlID09PSBmYWxzZSkgdGhpcy53cml0YWJsZSA9IGZhbHNlOwoKCSAgdGhpcy5hbGxvd0hhbGZPcGVuID0gdHJ1ZTsKCSAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5hbGxvd0hhbGZPcGVuID09PSBmYWxzZSkgdGhpcy5hbGxvd0hhbGZPcGVuID0gZmFsc2U7CgoJICB0aGlzLm9uY2UoJ2VuZCcsIG9uZW5kKTsKCX0KCgkvLyB0aGUgbm8taGFsZi1vcGVuIGVuZm9yY2VyCglmdW5jdGlvbiBvbmVuZCgpIHsKCSAgLy8gaWYgd2UgYWxsb3cgaGFsZi1vcGVuIHN0YXRlLCBvciBpZiB0aGUgd3JpdGFibGUgc2lkZSBlbmRlZCwKCSAgLy8gdGhlbiB3ZSdyZSBvay4KCSAgaWYgKHRoaXMuYWxsb3dIYWxmT3BlbiB8fCB0aGlzLl93cml0YWJsZVN0YXRlLmVuZGVkKSByZXR1cm47CgoJICAvLyBubyBtb3JlIGRhdGEgY2FuIGJlIHdyaXR0ZW4uCgkgIC8vIEJ1dCBhbGxvdyBtb3JlIHdyaXRlcyB0byBoYXBwZW4gaW4gdGhpcyB0aWNrLgoJICBwcm9jZXNzTmV4dFRpY2sob25FbmROVCwgdGhpcyk7Cgl9CgoJZnVuY3Rpb24gb25FbmROVChzZWxmKSB7CgkgIHNlbGYuZW5kKCk7Cgl9CgoJZnVuY3Rpb24gZm9yRWFjaCh4cywgZikgewoJICBmb3IgKHZhciBpID0gMCwgbCA9IHhzLmxlbmd0aDsgaSA8IGw7IGkrKykgewoJICAgIGYoeHNbaV0sIGkpOwoJICB9Cgl9CgovKioqLyB9LAovKiAyOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24ocHJvY2Vzcywgc2V0SW1tZWRpYXRlKSB7Ly8gQSBiaXQgc2ltcGxlciB0aGFuIHJlYWRhYmxlIHN0cmVhbXMuCgkvLyBJbXBsZW1lbnQgYW4gYXN5bmMgLl93cml0ZShjaHVuaywgZW5jb2RpbmcsIGNiKSwgYW5kIGl0J2xsIGhhbmRsZSBhbGwKCS8vIHRoZSBkcmFpbiBldmVudCBlbWlzc2lvbiBhbmQgYnVmZmVyaW5nLgoKCSd1c2Ugc3RyaWN0JzsKCgltb2R1bGUuZXhwb3J0cyA9IFdyaXRhYmxlOwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgcHJvY2Vzc05leHRUaWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIGFzeW5jV3JpdGUgPSAhcHJvY2Vzcy5icm93c2VyICYmIFsndjAuMTAnLCAndjAuOS4nXS5pbmRleE9mKHByb2Nlc3MudmVyc2lvbi5zbGljZSgwLCA1KSkgPiAtMSA/IHNldEltbWVkaWF0ZSA6IHByb2Nlc3NOZXh0VGljazsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgRHVwbGV4OwoJLyo8L3JlcGxhY2VtZW50PiovCgoJV3JpdGFibGUuV3JpdGFibGVTdGF0ZSA9IFdyaXRhYmxlU3RhdGU7CgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cgl1dGlsLmluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIGludGVybmFsVXRpbCA9IHsKCSAgZGVwcmVjYXRlOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKQoJfTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgU3RyZWFtID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl2YXIgQnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikuQnVmZmVyOwoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBidWZmZXJTaGltID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl1dGlsLmluaGVyaXRzKFdyaXRhYmxlLCBTdHJlYW0pOwoKCWZ1bmN0aW9uIG5vcCgpIHt9CgoJZnVuY3Rpb24gV3JpdGVSZXEoY2h1bmssIGVuY29kaW5nLCBjYikgewoJICB0aGlzLmNodW5rID0gY2h1bms7CgkgIHRoaXMuZW5jb2RpbmcgPSBlbmNvZGluZzsKCSAgdGhpcy5jYWxsYmFjayA9IGNiOwoJICB0aGlzLm5leHQgPSBudWxsOwoJfQoKCWZ1bmN0aW9uIFdyaXRhYmxlU3RhdGUob3B0aW9ucywgc3RyZWFtKSB7CgkgIER1cGxleCA9IER1cGxleCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTsKCgkgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKCSAgLy8gb2JqZWN0IHN0cmVhbSBmbGFnIHRvIGluZGljYXRlIHdoZXRoZXIgb3Igbm90IHRoaXMgc3RyZWFtCgkgIC8vIGNvbnRhaW5zIGJ1ZmZlcnMgb3Igb2JqZWN0cy4KCSAgdGhpcy5vYmplY3RNb2RlID0gISFvcHRpb25zLm9iamVjdE1vZGU7CgoJICBpZiAoc3RyZWFtIGluc3RhbmNlb2YgRHVwbGV4KSB0aGlzLm9iamVjdE1vZGUgPSB0aGlzLm9iamVjdE1vZGUgfHwgISFvcHRpb25zLndyaXRhYmxlT2JqZWN0TW9kZTsKCgkgIC8vIHRoZSBwb2ludCBhdCB3aGljaCB3cml0ZSgpIHN0YXJ0cyByZXR1cm5pbmcgZmFsc2UKCSAgLy8gTm90ZTogMCBpcyBhIHZhbGlkIHZhbHVlLCBtZWFucyB0aGF0IHdlIGFsd2F5cyByZXR1cm4gZmFsc2UgaWYKCSAgLy8gdGhlIGVudGlyZSBidWZmZXIgaXMgbm90IGZsdXNoZWQgaW1tZWRpYXRlbHkgb24gd3JpdGUoKQoJICB2YXIgaHdtID0gb3B0aW9ucy5oaWdoV2F0ZXJNYXJrOwoJICB2YXIgZGVmYXVsdEh3bSA9IHRoaXMub2JqZWN0TW9kZSA/IDE2IDogMTYgKiAxMDI0OwoJICB0aGlzLmhpZ2hXYXRlck1hcmsgPSBod20gfHwgaHdtID09PSAwID8gaHdtIDogZGVmYXVsdEh3bTsKCgkgIC8vIGNhc3QgdG8gaW50cy4KCSAgdGhpcy5oaWdoV2F0ZXJNYXJrID0gfn50aGlzLmhpZ2hXYXRlck1hcms7CgoJICAvLyBkcmFpbiBldmVudCBmbGFnLgoJICB0aGlzLm5lZWREcmFpbiA9IGZhbHNlOwoJICAvLyBhdCB0aGUgc3RhcnQgb2YgY2FsbGluZyBlbmQoKQoJICB0aGlzLmVuZGluZyA9IGZhbHNlOwoJICAvLyB3aGVuIGVuZCgpIGhhcyBiZWVuIGNhbGxlZCwgYW5kIHJldHVybmVkCgkgIHRoaXMuZW5kZWQgPSBmYWxzZTsKCSAgLy8gd2hlbiAnZmluaXNoJyBpcyBlbWl0dGVkCgkgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKCgkgIC8vIHNob3VsZCB3ZSBkZWNvZGUgc3RyaW5ncyBpbnRvIGJ1ZmZlcnMgYmVmb3JlIHBhc3NpbmcgdG8gX3dyaXRlPwoJICAvLyB0aGlzIGlzIGhlcmUgc28gdGhhdCBzb21lIG5vZGUtY29yZSBzdHJlYW1zIGNhbiBvcHRpbWl6ZSBzdHJpbmcKCSAgLy8gaGFuZGxpbmcgYXQgYSBsb3dlciBsZXZlbC4KCSAgdmFyIG5vRGVjb2RlID0gb3B0aW9ucy5kZWNvZGVTdHJpbmdzID09PSBmYWxzZTsKCSAgdGhpcy5kZWNvZGVTdHJpbmdzID0gIW5vRGVjb2RlOwoKCSAgLy8gQ3J5cHRvIGlzIGtpbmQgb2Ygb2xkIGFuZCBjcnVzdHkuICBIaXN0b3JpY2FsbHksIGl0cyBkZWZhdWx0IHN0cmluZwoJICAvLyBlbmNvZGluZyBpcyAnYmluYXJ5JyBzbyB3ZSBoYXZlIHRvIG1ha2UgdGhpcyBjb25maWd1cmFibGUuCgkgIC8vIEV2ZXJ5dGhpbmcgZWxzZSBpbiB0aGUgdW5pdmVyc2UgdXNlcyAndXRmOCcsIHRob3VnaC4KCSAgdGhpcy5kZWZhdWx0RW5jb2RpbmcgPSBvcHRpb25zLmRlZmF1bHRFbmNvZGluZyB8fCAndXRmOCc7CgoJICAvLyBub3QgYW4gYWN0dWFsIGJ1ZmZlciB3ZSBrZWVwIHRyYWNrIG9mLCBidXQgYSBtZWFzdXJlbWVudAoJICAvLyBvZiBob3cgbXVjaCB3ZSdyZSB3YWl0aW5nIHRvIGdldCBwdXNoZWQgdG8gc29tZSB1bmRlcmx5aW5nCgkgIC8vIHNvY2tldCBvciBmaWxlLgoJICB0aGlzLmxlbmd0aCA9IDA7CgoJICAvLyBhIGZsYWcgdG8gc2VlIHdoZW4gd2UncmUgaW4gdGhlIG1pZGRsZSBvZiBhIHdyaXRlLgoJICB0aGlzLndyaXRpbmcgPSBmYWxzZTsKCgkgIC8vIHdoZW4gdHJ1ZSBhbGwgd3JpdGVzIHdpbGwgYmUgYnVmZmVyZWQgdW50aWwgLnVuY29yaygpIGNhbGwKCSAgdGhpcy5jb3JrZWQgPSAwOwoKCSAgLy8gYSBmbGFnIHRvIGJlIGFibGUgdG8gdGVsbCBpZiB0aGUgb253cml0ZSBjYiBpcyBjYWxsZWQgaW1tZWRpYXRlbHksCgkgIC8vIG9yIG9uIGEgbGF0ZXIgdGljay4gIFdlIHNldCB0aGlzIHRvIHRydWUgYXQgZmlyc3QsIGJlY2F1c2UgYW55CgkgIC8vIGFjdGlvbnMgdGhhdCBzaG91bGRuJ3QgaGFwcGVuIHVudGlsICJsYXRlciIgc2hvdWxkIGdlbmVyYWxseSBhbHNvCgkgIC8vIG5vdCBoYXBwZW4gYmVmb3JlIHRoZSBmaXJzdCB3cml0ZSBjYWxsLgoJICB0aGlzLnN5bmMgPSB0cnVlOwoKCSAgLy8gYSBmbGFnIHRvIGtub3cgaWYgd2UncmUgcHJvY2Vzc2luZyBwcmV2aW91c2x5IGJ1ZmZlcmVkIGl0ZW1zLCB3aGljaAoJICAvLyBtYXkgY2FsbCB0aGUgX3dyaXRlKCkgY2FsbGJhY2sgaW4gdGhlIHNhbWUgdGljaywgc28gdGhhdCB3ZSBkb24ndAoJICAvLyBlbmQgdXAgaW4gYW4gb3ZlcmxhcHBlZCBvbndyaXRlIHNpdHVhdGlvbi4KCSAgdGhpcy5idWZmZXJQcm9jZXNzaW5nID0gZmFsc2U7CgoJICAvLyB0aGUgY2FsbGJhY2sgdGhhdCdzIHBhc3NlZCB0byBfd3JpdGUoY2h1bmssY2IpCgkgIHRoaXMub253cml0ZSA9IGZ1bmN0aW9uIChlcikgewoJICAgIG9ud3JpdGUoc3RyZWFtLCBlcik7CgkgIH07CgoJICAvLyB0aGUgY2FsbGJhY2sgdGhhdCB0aGUgdXNlciBzdXBwbGllcyB0byB3cml0ZShjaHVuayxlbmNvZGluZyxjYikKCSAgdGhpcy53cml0ZWNiID0gbnVsbDsKCgkgIC8vIHRoZSBhbW91bnQgdGhhdCBpcyBiZWluZyB3cml0dGVuIHdoZW4gX3dyaXRlIGlzIGNhbGxlZC4KCSAgdGhpcy53cml0ZWxlbiA9IDA7CgoJICB0aGlzLmJ1ZmZlcmVkUmVxdWVzdCA9IG51bGw7CgkgIHRoaXMubGFzdEJ1ZmZlcmVkUmVxdWVzdCA9IG51bGw7CgoJICAvLyBudW1iZXIgb2YgcGVuZGluZyB1c2VyLXN1cHBsaWVkIHdyaXRlIGNhbGxiYWNrcwoJICAvLyB0aGlzIG11c3QgYmUgMCBiZWZvcmUgJ2ZpbmlzaCcgY2FuIGJlIGVtaXR0ZWQKCSAgdGhpcy5wZW5kaW5nY2IgPSAwOwoKCSAgLy8gZW1pdCBwcmVmaW5pc2ggaWYgdGhlIG9ubHkgdGhpbmcgd2UncmUgd2FpdGluZyBmb3IgaXMgX3dyaXRlIGNicwoJICAvLyBUaGlzIGlzIHJlbGV2YW50IGZvciBzeW5jaHJvbm91cyBUcmFuc2Zvcm0gc3RyZWFtcwoJICB0aGlzLnByZWZpbmlzaGVkID0gZmFsc2U7CgoJICAvLyBUcnVlIGlmIHRoZSBlcnJvciB3YXMgYWxyZWFkeSBlbWl0dGVkIGFuZCBzaG91bGQgbm90IGJlIHRocm93biBhZ2FpbgoJICB0aGlzLmVycm9yRW1pdHRlZCA9IGZhbHNlOwoKCSAgLy8gY291bnQgYnVmZmVyZWQgcmVxdWVzdHMKCSAgdGhpcy5idWZmZXJlZFJlcXVlc3RDb3VudCA9IDA7CgoJICAvLyBhbGxvY2F0ZSB0aGUgZmlyc3QgQ29ya2VkUmVxdWVzdCwgdGhlcmUgaXMgYWx3YXlzCgkgIC8vIG9uZSBhbGxvY2F0ZWQgYW5kIGZyZWUgdG8gdXNlLCBhbmQgd2UgbWFpbnRhaW4gYXQgbW9zdCB0d28KCSAgdGhpcy5jb3JrZWRSZXF1ZXN0c0ZyZWUgPSBuZXcgQ29ya2VkUmVxdWVzdCh0aGlzKTsKCX0KCglXcml0YWJsZVN0YXRlLnByb3RvdHlwZS5nZXRCdWZmZXIgPSBmdW5jdGlvbiBnZXRCdWZmZXIoKSB7CgkgIHZhciBjdXJyZW50ID0gdGhpcy5idWZmZXJlZFJlcXVlc3Q7CgkgIHZhciBvdXQgPSBbXTsKCSAgd2hpbGUgKGN1cnJlbnQpIHsKCSAgICBvdXQucHVzaChjdXJyZW50KTsKCSAgICBjdXJyZW50ID0gY3VycmVudC5uZXh0OwoJICB9CgkgIHJldHVybiBvdXQ7Cgl9OwoKCShmdW5jdGlvbiAoKSB7CgkgIHRyeSB7CgkgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFdyaXRhYmxlU3RhdGUucHJvdG90eXBlLCAnYnVmZmVyJywgewoJICAgICAgZ2V0OiBpbnRlcm5hbFV0aWwuZGVwcmVjYXRlKGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QnVmZmVyKCk7CgkgICAgICB9LCAnX3dyaXRhYmxlU3RhdGUuYnVmZmVyIGlzIGRlcHJlY2F0ZWQuIFVzZSBfd3JpdGFibGVTdGF0ZS5nZXRCdWZmZXIgJyArICdpbnN0ZWFkLicpCgkgICAgfSk7CgkgIH0gY2F0Y2ggKF8pIHt9Cgl9KSgpOwoKCS8vIFRlc3QgX3dyaXRhYmxlU3RhdGUgZm9yIGluaGVyaXRhbmNlIHRvIGFjY291bnQgZm9yIER1cGxleCBzdHJlYW1zLAoJLy8gd2hvc2UgcHJvdG90eXBlIGNoYWluIG9ubHkgcG9pbnRzIHRvIFJlYWRhYmxlLgoJdmFyIHJlYWxIYXNJbnN0YW5jZTsKCWlmICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIFN5bWJvbC5oYXNJbnN0YW5jZSAmJiB0eXBlb2YgRnVuY3Rpb24ucHJvdG90eXBlW1N5bWJvbC5oYXNJbnN0YW5jZV0gPT09ICdmdW5jdGlvbicpIHsKCSAgcmVhbEhhc0luc3RhbmNlID0gRnVuY3Rpb24ucHJvdG90eXBlW1N5bWJvbC5oYXNJbnN0YW5jZV07CgkgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXcml0YWJsZSwgU3ltYm9sLmhhc0luc3RhbmNlLCB7CgkgICAgdmFsdWU6IGZ1bmN0aW9uIChvYmplY3QpIHsKCSAgICAgIGlmIChyZWFsSGFzSW5zdGFuY2UuY2FsbCh0aGlzLCBvYmplY3QpKSByZXR1cm4gdHJ1ZTsKCgkgICAgICByZXR1cm4gb2JqZWN0ICYmIG9iamVjdC5fd3JpdGFibGVTdGF0ZSBpbnN0YW5jZW9mIFdyaXRhYmxlU3RhdGU7CgkgICAgfQoJICB9KTsKCX0gZWxzZSB7CgkgIHJlYWxIYXNJbnN0YW5jZSA9IGZ1bmN0aW9uIChvYmplY3QpIHsKCSAgICByZXR1cm4gb2JqZWN0IGluc3RhbmNlb2YgdGhpczsKCSAgfTsKCX0KCglmdW5jdGlvbiBXcml0YWJsZShvcHRpb25zKSB7CgkgIER1cGxleCA9IER1cGxleCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTsKCgkgIC8vIFdyaXRhYmxlIGN0b3IgaXMgYXBwbGllZCB0byBEdXBsZXhlcywgdG9vLgoJICAvLyBgcmVhbEhhc0luc3RhbmNlYCBpcyBuZWNlc3NhcnkgYmVjYXVzZSB1c2luZyBwbGFpbiBgaW5zdGFuY2VvZmAKCSAgLy8gd291bGQgcmV0dXJuIGZhbHNlLCBhcyBubyBgX3dyaXRhYmxlU3RhdGVgIHByb3BlcnR5IGlzIGF0dGFjaGVkLgoKCSAgLy8gVHJ5aW5nIHRvIHVzZSB0aGUgY3VzdG9tIGBpbnN0YW5jZW9mYCBmb3IgV3JpdGFibGUgaGVyZSB3aWxsIGFsc28gYnJlYWsgdGhlCgkgIC8vIE5vZGUuanMgTGF6eVRyYW5zZm9ybSBpbXBsZW1lbnRhdGlvbiwgd2hpY2ggaGFzIGEgbm9uLXRyaXZpYWwgZ2V0dGVyIGZvcgoJICAvLyBgX3dyaXRhYmxlU3RhdGVgIHRoYXQgd291bGQgbGVhZCB0byBpbmZpbml0ZSByZWN1cnNpb24uCgkgIGlmICghcmVhbEhhc0luc3RhbmNlLmNhbGwoV3JpdGFibGUsIHRoaXMpICYmICEodGhpcyBpbnN0YW5jZW9mIER1cGxleCkpIHsKCSAgICByZXR1cm4gbmV3IFdyaXRhYmxlKG9wdGlvbnMpOwoJICB9CgoJICB0aGlzLl93cml0YWJsZVN0YXRlID0gbmV3IFdyaXRhYmxlU3RhdGUob3B0aW9ucywgdGhpcyk7CgoJICAvLyBsZWdhY3kuCgkgIHRoaXMud3JpdGFibGUgPSB0cnVlOwoKCSAgaWYgKG9wdGlvbnMpIHsKCSAgICBpZiAodHlwZW9mIG9wdGlvbnMud3JpdGUgPT09ICdmdW5jdGlvbicpIHRoaXMuX3dyaXRlID0gb3B0aW9ucy53cml0ZTsKCgkgICAgaWYgKHR5cGVvZiBvcHRpb25zLndyaXRldiA9PT0gJ2Z1bmN0aW9uJykgdGhpcy5fd3JpdGV2ID0gb3B0aW9ucy53cml0ZXY7CgkgIH0KCgkgIFN0cmVhbS5jYWxsKHRoaXMpOwoJfQoKCS8vIE90aGVyd2lzZSBwZW9wbGUgY2FuIHBpcGUgV3JpdGFibGUgc3RyZWFtcywgd2hpY2ggaXMganVzdCB3cm9uZy4KCVdyaXRhYmxlLnByb3RvdHlwZS5waXBlID0gZnVuY3Rpb24gKCkgewoJICB0aGlzLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdDYW5ub3QgcGlwZSwgbm90IHJlYWRhYmxlJykpOwoJfTsKCglmdW5jdGlvbiB3cml0ZUFmdGVyRW5kKHN0cmVhbSwgY2IpIHsKCSAgdmFyIGVyID0gbmV3IEVycm9yKCd3cml0ZSBhZnRlciBlbmQnKTsKCSAgLy8gVE9ETzogZGVmZXIgZXJyb3IgZXZlbnRzIGNvbnNpc3RlbnRseSBldmVyeXdoZXJlLCBub3QganVzdCB0aGUgY2IKCSAgc3RyZWFtLmVtaXQoJ2Vycm9yJywgZXIpOwoJICBwcm9jZXNzTmV4dFRpY2soY2IsIGVyKTsKCX0KCgkvLyBDaGVja3MgdGhhdCBhIHVzZXItc3VwcGxpZWQgY2h1bmsgaXMgdmFsaWQsIGVzcGVjaWFsbHkgZm9yIHRoZSBwYXJ0aWN1bGFyCgkvLyBtb2RlIHRoZSBzdHJlYW0gaXMgaW4uIEN1cnJlbnRseSB0aGlzIG1lYW5zIHRoYXQgYG51bGxgIGlzIG5ldmVyIGFjY2VwdGVkCgkvLyBhbmQgdW5kZWZpbmVkL25vbi1zdHJpbmcgdmFsdWVzIGFyZSBvbmx5IGFsbG93ZWQgaW4gb2JqZWN0IG1vZGUuCglmdW5jdGlvbiB2YWxpZENodW5rKHN0cmVhbSwgc3RhdGUsIGNodW5rLCBjYikgewoJICB2YXIgdmFsaWQgPSB0cnVlOwoJICB2YXIgZXIgPSBmYWxzZTsKCgkgIGlmIChjaHVuayA9PT0gbnVsbCkgewoJICAgIGVyID0gbmV3IFR5cGVFcnJvcignTWF5IG5vdCB3cml0ZSBudWxsIHZhbHVlcyB0byBzdHJlYW0nKTsKCSAgfSBlbHNlIGlmICh0eXBlb2YgY2h1bmsgIT09ICdzdHJpbmcnICYmIGNodW5rICE9PSB1bmRlZmluZWQgJiYgIXN0YXRlLm9iamVjdE1vZGUpIHsKCSAgICBlciA9IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgbm9uLXN0cmluZy9idWZmZXIgY2h1bmsnKTsKCSAgfQoJICBpZiAoZXIpIHsKCSAgICBzdHJlYW0uZW1pdCgnZXJyb3InLCBlcik7CgkgICAgcHJvY2Vzc05leHRUaWNrKGNiLCBlcik7CgkgICAgdmFsaWQgPSBmYWxzZTsKCSAgfQoJICByZXR1cm4gdmFsaWQ7Cgl9CgoJV3JpdGFibGUucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKGNodW5rLCBlbmNvZGluZywgY2IpIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fd3JpdGFibGVTdGF0ZTsKCSAgdmFyIHJldCA9IGZhbHNlOwoJICB2YXIgaXNCdWYgPSBCdWZmZXIuaXNCdWZmZXIoY2h1bmspOwoKCSAgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIGNiID0gZW5jb2Rpbmc7CgkgICAgZW5jb2RpbmcgPSBudWxsOwoJICB9CgoJICBpZiAoaXNCdWYpIGVuY29kaW5nID0gJ2J1ZmZlcic7ZWxzZSBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9IHN0YXRlLmRlZmF1bHRFbmNvZGluZzsKCgkgIGlmICh0eXBlb2YgY2IgIT09ICdmdW5jdGlvbicpIGNiID0gbm9wOwoKCSAgaWYgKHN0YXRlLmVuZGVkKSB3cml0ZUFmdGVyRW5kKHRoaXMsIGNiKTtlbHNlIGlmIChpc0J1ZiB8fCB2YWxpZENodW5rKHRoaXMsIHN0YXRlLCBjaHVuaywgY2IpKSB7CgkgICAgc3RhdGUucGVuZGluZ2NiKys7CgkgICAgcmV0ID0gd3JpdGVPckJ1ZmZlcih0aGlzLCBzdGF0ZSwgaXNCdWYsIGNodW5rLCBlbmNvZGluZywgY2IpOwoJICB9CgoJICByZXR1cm4gcmV0OwoJfTsKCglXcml0YWJsZS5wcm90b3R5cGUuY29yayA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fd3JpdGFibGVTdGF0ZTsKCgkgIHN0YXRlLmNvcmtlZCsrOwoJfTsKCglXcml0YWJsZS5wcm90b3R5cGUudW5jb3JrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgc3RhdGUgPSB0aGlzLl93cml0YWJsZVN0YXRlOwoKCSAgaWYgKHN0YXRlLmNvcmtlZCkgewoJICAgIHN0YXRlLmNvcmtlZC0tOwoKCSAgICBpZiAoIXN0YXRlLndyaXRpbmcgJiYgIXN0YXRlLmNvcmtlZCAmJiAhc3RhdGUuZmluaXNoZWQgJiYgIXN0YXRlLmJ1ZmZlclByb2Nlc3NpbmcgJiYgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0KSBjbGVhckJ1ZmZlcih0aGlzLCBzdGF0ZSk7CgkgIH0KCX07CgoJV3JpdGFibGUucHJvdG90eXBlLnNldERlZmF1bHRFbmNvZGluZyA9IGZ1bmN0aW9uIHNldERlZmF1bHRFbmNvZGluZyhlbmNvZGluZykgewoJICAvLyBub2RlOjpQYXJzZUVuY29kaW5nKCkgcmVxdWlyZXMgbG93ZXIgY2FzZS4KCSAgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycpIGVuY29kaW5nID0gZW5jb2RpbmcudG9Mb3dlckNhc2UoKTsKCSAgaWYgKCEoWydoZXgnLCAndXRmOCcsICd1dGYtOCcsICdhc2NpaScsICdiaW5hcnknLCAnYmFzZTY0JywgJ3VjczInLCAndWNzLTInLCAndXRmMTZsZScsICd1dGYtMTZsZScsICdyYXcnXS5pbmRleE9mKChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpKSA+IC0xKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKTsKCSAgdGhpcy5fd3JpdGFibGVTdGF0ZS5kZWZhdWx0RW5jb2RpbmcgPSBlbmNvZGluZzsKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCWZ1bmN0aW9uIGRlY29kZUNodW5rKHN0YXRlLCBjaHVuaywgZW5jb2RpbmcpIHsKCSAgaWYgKCFzdGF0ZS5vYmplY3RNb2RlICYmIHN0YXRlLmRlY29kZVN0cmluZ3MgIT09IGZhbHNlICYmIHR5cGVvZiBjaHVuayA9PT0gJ3N0cmluZycpIHsKCSAgICBjaHVuayA9IGJ1ZmZlclNoaW0uZnJvbShjaHVuaywgZW5jb2RpbmcpOwoJICB9CgkgIHJldHVybiBjaHVuazsKCX0KCgkvLyBpZiB3ZSdyZSBhbHJlYWR5IHdyaXRpbmcgc29tZXRoaW5nLCB0aGVuIGp1c3QgcHV0IHRoaXMKCS8vIGluIHRoZSBxdWV1ZSwgYW5kIHdhaXQgb3VyIHR1cm4uICBPdGhlcndpc2UsIGNhbGwgX3dyaXRlCgkvLyBJZiB3ZSByZXR1cm4gZmFsc2UsIHRoZW4gd2UgbmVlZCBhIGRyYWluIGV2ZW50LCBzbyBzZXQgdGhhdCBmbGFnLgoJZnVuY3Rpb24gd3JpdGVPckJ1ZmZlcihzdHJlYW0sIHN0YXRlLCBpc0J1ZiwgY2h1bmssIGVuY29kaW5nLCBjYikgewoJICBpZiAoIWlzQnVmKSB7CgkgICAgY2h1bmsgPSBkZWNvZGVDaHVuayhzdGF0ZSwgY2h1bmssIGVuY29kaW5nKTsKCSAgICBpZiAoQnVmZmVyLmlzQnVmZmVyKGNodW5rKSkgZW5jb2RpbmcgPSAnYnVmZmVyJzsKCSAgfQoJICB2YXIgbGVuID0gc3RhdGUub2JqZWN0TW9kZSA/IDEgOiBjaHVuay5sZW5ndGg7CgoJICBzdGF0ZS5sZW5ndGggKz0gbGVuOwoKCSAgdmFyIHJldCA9IHN0YXRlLmxlbmd0aCA8IHN0YXRlLmhpZ2hXYXRlck1hcms7CgkgIC8vIHdlIG11c3QgZW5zdXJlIHRoYXQgcHJldmlvdXMgbmVlZERyYWluIHdpbGwgbm90IGJlIHJlc2V0IHRvIGZhbHNlLgoJICBpZiAoIXJldCkgc3RhdGUubmVlZERyYWluID0gdHJ1ZTsKCgkgIGlmIChzdGF0ZS53cml0aW5nIHx8IHN0YXRlLmNvcmtlZCkgewoJICAgIHZhciBsYXN0ID0gc3RhdGUubGFzdEJ1ZmZlcmVkUmVxdWVzdDsKCSAgICBzdGF0ZS5sYXN0QnVmZmVyZWRSZXF1ZXN0ID0gbmV3IFdyaXRlUmVxKGNodW5rLCBlbmNvZGluZywgY2IpOwoJICAgIGlmIChsYXN0KSB7CgkgICAgICBsYXN0Lm5leHQgPSBzdGF0ZS5sYXN0QnVmZmVyZWRSZXF1ZXN0OwoJICAgIH0gZWxzZSB7CgkgICAgICBzdGF0ZS5idWZmZXJlZFJlcXVlc3QgPSBzdGF0ZS5sYXN0QnVmZmVyZWRSZXF1ZXN0OwoJICAgIH0KCSAgICBzdGF0ZS5idWZmZXJlZFJlcXVlc3RDb3VudCArPSAxOwoJICB9IGVsc2UgewoJICAgIGRvV3JpdGUoc3RyZWFtLCBzdGF0ZSwgZmFsc2UsIGxlbiwgY2h1bmssIGVuY29kaW5nLCBjYik7CgkgIH0KCgkgIHJldHVybiByZXQ7Cgl9CgoJZnVuY3Rpb24gZG9Xcml0ZShzdHJlYW0sIHN0YXRlLCB3cml0ZXYsIGxlbiwgY2h1bmssIGVuY29kaW5nLCBjYikgewoJICBzdGF0ZS53cml0ZWxlbiA9IGxlbjsKCSAgc3RhdGUud3JpdGVjYiA9IGNiOwoJICBzdGF0ZS53cml0aW5nID0gdHJ1ZTsKCSAgc3RhdGUuc3luYyA9IHRydWU7CgkgIGlmICh3cml0ZXYpIHN0cmVhbS5fd3JpdGV2KGNodW5rLCBzdGF0ZS5vbndyaXRlKTtlbHNlIHN0cmVhbS5fd3JpdGUoY2h1bmssIGVuY29kaW5nLCBzdGF0ZS5vbndyaXRlKTsKCSAgc3RhdGUuc3luYyA9IGZhbHNlOwoJfQoKCWZ1bmN0aW9uIG9ud3JpdGVFcnJvcihzdHJlYW0sIHN0YXRlLCBzeW5jLCBlciwgY2IpIHsKCSAgLS1zdGF0ZS5wZW5kaW5nY2I7CgkgIGlmIChzeW5jKSBwcm9jZXNzTmV4dFRpY2soY2IsIGVyKTtlbHNlIGNiKGVyKTsKCgkgIHN0cmVhbS5fd3JpdGFibGVTdGF0ZS5lcnJvckVtaXR0ZWQgPSB0cnVlOwoJICBzdHJlYW0uZW1pdCgnZXJyb3InLCBlcik7Cgl9CgoJZnVuY3Rpb24gb253cml0ZVN0YXRlVXBkYXRlKHN0YXRlKSB7CgkgIHN0YXRlLndyaXRpbmcgPSBmYWxzZTsKCSAgc3RhdGUud3JpdGVjYiA9IG51bGw7CgkgIHN0YXRlLmxlbmd0aCAtPSBzdGF0ZS53cml0ZWxlbjsKCSAgc3RhdGUud3JpdGVsZW4gPSAwOwoJfQoKCWZ1bmN0aW9uIG9ud3JpdGUoc3RyZWFtLCBlcikgewoJICB2YXIgc3RhdGUgPSBzdHJlYW0uX3dyaXRhYmxlU3RhdGU7CgkgIHZhciBzeW5jID0gc3RhdGUuc3luYzsKCSAgdmFyIGNiID0gc3RhdGUud3JpdGVjYjsKCgkgIG9ud3JpdGVTdGF0ZVVwZGF0ZShzdGF0ZSk7CgoJICBpZiAoZXIpIG9ud3JpdGVFcnJvcihzdHJlYW0sIHN0YXRlLCBzeW5jLCBlciwgY2IpO2Vsc2UgewoJICAgIC8vIENoZWNrIGlmIHdlJ3JlIGFjdHVhbGx5IHJlYWR5IHRvIGZpbmlzaCwgYnV0IGRvbid0IGVtaXQgeWV0CgkgICAgdmFyIGZpbmlzaGVkID0gbmVlZEZpbmlzaChzdGF0ZSk7CgoJICAgIGlmICghZmluaXNoZWQgJiYgIXN0YXRlLmNvcmtlZCAmJiAhc3RhdGUuYnVmZmVyUHJvY2Vzc2luZyAmJiBzdGF0ZS5idWZmZXJlZFJlcXVlc3QpIHsKCSAgICAgIGNsZWFyQnVmZmVyKHN0cmVhbSwgc3RhdGUpOwoJICAgIH0KCgkgICAgaWYgKHN5bmMpIHsKCSAgICAgIC8qPHJlcGxhY2VtZW50PiovCgkgICAgICBhc3luY1dyaXRlKGFmdGVyV3JpdGUsIHN0cmVhbSwgc3RhdGUsIGZpbmlzaGVkLCBjYik7CgkgICAgICAvKjwvcmVwbGFjZW1lbnQ+Ki8KCSAgICB9IGVsc2UgewoJICAgICAgYWZ0ZXJXcml0ZShzdHJlYW0sIHN0YXRlLCBmaW5pc2hlZCwgY2IpOwoJICAgIH0KCSAgfQoJfQoKCWZ1bmN0aW9uIGFmdGVyV3JpdGUoc3RyZWFtLCBzdGF0ZSwgZmluaXNoZWQsIGNiKSB7CgkgIGlmICghZmluaXNoZWQpIG9ud3JpdGVEcmFpbihzdHJlYW0sIHN0YXRlKTsKCSAgc3RhdGUucGVuZGluZ2NiLS07CgkgIGNiKCk7CgkgIGZpbmlzaE1heWJlKHN0cmVhbSwgc3RhdGUpOwoJfQoKCS8vIE11c3QgZm9yY2UgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIG9uIG5leHRUaWNrLCBzbyB0aGF0IHdlIGRvbid0CgkvLyBlbWl0ICdkcmFpbicgYmVmb3JlIHRoZSB3cml0ZSgpIGNvbnN1bWVyIGdldHMgdGhlICdmYWxzZScgcmV0dXJuCgkvLyB2YWx1ZSwgYW5kIGhhcyBhIGNoYW5jZSB0byBhdHRhY2ggYSAnZHJhaW4nIGxpc3RlbmVyLgoJZnVuY3Rpb24gb253cml0ZURyYWluKHN0cmVhbSwgc3RhdGUpIHsKCSAgaWYgKHN0YXRlLmxlbmd0aCA9PT0gMCAmJiBzdGF0ZS5uZWVkRHJhaW4pIHsKCSAgICBzdGF0ZS5uZWVkRHJhaW4gPSBmYWxzZTsKCSAgICBzdHJlYW0uZW1pdCgnZHJhaW4nKTsKCSAgfQoJfQoKCS8vIGlmIHRoZXJlJ3Mgc29tZXRoaW5nIGluIHRoZSBidWZmZXIgd2FpdGluZywgdGhlbiBwcm9jZXNzIGl0CglmdW5jdGlvbiBjbGVhckJ1ZmZlcihzdHJlYW0sIHN0YXRlKSB7CgkgIHN0YXRlLmJ1ZmZlclByb2Nlc3NpbmcgPSB0cnVlOwoJICB2YXIgZW50cnkgPSBzdGF0ZS5idWZmZXJlZFJlcXVlc3Q7CgoJICBpZiAoc3RyZWFtLl93cml0ZXYgJiYgZW50cnkgJiYgZW50cnkubmV4dCkgewoJICAgIC8vIEZhc3QgY2FzZSwgd3JpdGUgZXZlcnl0aGluZyB1c2luZyBfd3JpdGV2KCkKCSAgICB2YXIgbCA9IHN0YXRlLmJ1ZmZlcmVkUmVxdWVzdENvdW50OwoJICAgIHZhciBidWZmZXIgPSBuZXcgQXJyYXkobCk7CgkgICAgdmFyIGhvbGRlciA9IHN0YXRlLmNvcmtlZFJlcXVlc3RzRnJlZTsKCSAgICBob2xkZXIuZW50cnkgPSBlbnRyeTsKCgkgICAgdmFyIGNvdW50ID0gMDsKCSAgICB3aGlsZSAoZW50cnkpIHsKCSAgICAgIGJ1ZmZlcltjb3VudF0gPSBlbnRyeTsKCSAgICAgIGVudHJ5ID0gZW50cnkubmV4dDsKCSAgICAgIGNvdW50ICs9IDE7CgkgICAgfQoKCSAgICBkb1dyaXRlKHN0cmVhbSwgc3RhdGUsIHRydWUsIHN0YXRlLmxlbmd0aCwgYnVmZmVyLCAnJywgaG9sZGVyLmZpbmlzaCk7CgoJICAgIC8vIGRvV3JpdGUgaXMgYWxtb3N0IGFsd2F5cyBhc3luYywgZGVmZXIgdGhlc2UgdG8gc2F2ZSBhIGJpdCBvZiB0aW1lCgkgICAgLy8gYXMgdGhlIGhvdCBwYXRoIGVuZHMgd2l0aCBkb1dyaXRlCgkgICAgc3RhdGUucGVuZGluZ2NiKys7CgkgICAgc3RhdGUubGFzdEJ1ZmZlcmVkUmVxdWVzdCA9IG51bGw7CgkgICAgaWYgKGhvbGRlci5uZXh0KSB7CgkgICAgICBzdGF0ZS5jb3JrZWRSZXF1ZXN0c0ZyZWUgPSBob2xkZXIubmV4dDsKCSAgICAgIGhvbGRlci5uZXh0ID0gbnVsbDsKCSAgICB9IGVsc2UgewoJICAgICAgc3RhdGUuY29ya2VkUmVxdWVzdHNGcmVlID0gbmV3IENvcmtlZFJlcXVlc3Qoc3RhdGUpOwoJICAgIH0KCSAgfSBlbHNlIHsKCSAgICAvLyBTbG93IGNhc2UsIHdyaXRlIGNodW5rcyBvbmUtYnktb25lCgkgICAgd2hpbGUgKGVudHJ5KSB7CgkgICAgICB2YXIgY2h1bmsgPSBlbnRyeS5jaHVuazsKCSAgICAgIHZhciBlbmNvZGluZyA9IGVudHJ5LmVuY29kaW5nOwoJICAgICAgdmFyIGNiID0gZW50cnkuY2FsbGJhY2s7CgkgICAgICB2YXIgbGVuID0gc3RhdGUub2JqZWN0TW9kZSA/IDEgOiBjaHVuay5sZW5ndGg7CgoJICAgICAgZG9Xcml0ZShzdHJlYW0sIHN0YXRlLCBmYWxzZSwgbGVuLCBjaHVuaywgZW5jb2RpbmcsIGNiKTsKCSAgICAgIGVudHJ5ID0gZW50cnkubmV4dDsKCSAgICAgIC8vIGlmIHdlIGRpZG4ndCBjYWxsIHRoZSBvbndyaXRlIGltbWVkaWF0ZWx5LCB0aGVuCgkgICAgICAvLyBpdCBtZWFucyB0aGF0IHdlIG5lZWQgdG8gd2FpdCB1bnRpbCBpdCBkb2VzLgoJICAgICAgLy8gYWxzbywgdGhhdCBtZWFucyB0aGF0IHRoZSBjaHVuayBhbmQgY2IgYXJlIGN1cnJlbnRseQoJICAgICAgLy8gYmVpbmcgcHJvY2Vzc2VkLCBzbyBtb3ZlIHRoZSBidWZmZXIgY291bnRlciBwYXN0IHRoZW0uCgkgICAgICBpZiAoc3RhdGUud3JpdGluZykgewoJICAgICAgICBicmVhazsKCSAgICAgIH0KCSAgICB9CgoJICAgIGlmIChlbnRyeSA9PT0gbnVsbCkgc3RhdGUubGFzdEJ1ZmZlcmVkUmVxdWVzdCA9IG51bGw7CgkgIH0KCgkgIHN0YXRlLmJ1ZmZlcmVkUmVxdWVzdENvdW50ID0gMDsKCSAgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0ID0gZW50cnk7CgkgIHN0YXRlLmJ1ZmZlclByb2Nlc3NpbmcgPSBmYWxzZTsKCX0KCglXcml0YWJsZS5wcm90b3R5cGUuX3dyaXRlID0gZnVuY3Rpb24gKGNodW5rLCBlbmNvZGluZywgY2IpIHsKCSAgY2IobmV3IEVycm9yKCdfd3JpdGUoKSBpcyBub3QgaW1wbGVtZW50ZWQnKSk7Cgl9OwoKCVdyaXRhYmxlLnByb3RvdHlwZS5fd3JpdGV2ID0gbnVsbDsKCglXcml0YWJsZS5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24gKGNodW5rLCBlbmNvZGluZywgY2IpIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fd3JpdGFibGVTdGF0ZTsKCgkgIGlmICh0eXBlb2YgY2h1bmsgPT09ICdmdW5jdGlvbicpIHsKCSAgICBjYiA9IGNodW5rOwoJICAgIGNodW5rID0gbnVsbDsKCSAgICBlbmNvZGluZyA9IG51bGw7CgkgIH0gZWxzZSBpZiAodHlwZW9mIGVuY29kaW5nID09PSAnZnVuY3Rpb24nKSB7CgkgICAgY2IgPSBlbmNvZGluZzsKCSAgICBlbmNvZGluZyA9IG51bGw7CgkgIH0KCgkgIGlmIChjaHVuayAhPT0gbnVsbCAmJiBjaHVuayAhPT0gdW5kZWZpbmVkKSB0aGlzLndyaXRlKGNodW5rLCBlbmNvZGluZyk7CgoJICAvLyAuZW5kKCkgZnVsbHkgdW5jb3JrcwoJICBpZiAoc3RhdGUuY29ya2VkKSB7CgkgICAgc3RhdGUuY29ya2VkID0gMTsKCSAgICB0aGlzLnVuY29yaygpOwoJICB9CgoJICAvLyBpZ25vcmUgdW5uZWNlc3NhcnkgZW5kKCkgY2FsbHMuCgkgIGlmICghc3RhdGUuZW5kaW5nICYmICFzdGF0ZS5maW5pc2hlZCkgZW5kV3JpdGFibGUodGhpcywgc3RhdGUsIGNiKTsKCX07CgoJZnVuY3Rpb24gbmVlZEZpbmlzaChzdGF0ZSkgewoJICByZXR1cm4gc3RhdGUuZW5kaW5nICYmIHN0YXRlLmxlbmd0aCA9PT0gMCAmJiBzdGF0ZS5idWZmZXJlZFJlcXVlc3QgPT09IG51bGwgJiYgIXN0YXRlLmZpbmlzaGVkICYmICFzdGF0ZS53cml0aW5nOwoJfQoKCWZ1bmN0aW9uIHByZWZpbmlzaChzdHJlYW0sIHN0YXRlKSB7CgkgIGlmICghc3RhdGUucHJlZmluaXNoZWQpIHsKCSAgICBzdGF0ZS5wcmVmaW5pc2hlZCA9IHRydWU7CgkgICAgc3RyZWFtLmVtaXQoJ3ByZWZpbmlzaCcpOwoJICB9Cgl9CgoJZnVuY3Rpb24gZmluaXNoTWF5YmUoc3RyZWFtLCBzdGF0ZSkgewoJICB2YXIgbmVlZCA9IG5lZWRGaW5pc2goc3RhdGUpOwoJICBpZiAobmVlZCkgewoJICAgIGlmIChzdGF0ZS5wZW5kaW5nY2IgPT09IDApIHsKCSAgICAgIHByZWZpbmlzaChzdHJlYW0sIHN0YXRlKTsKCSAgICAgIHN0YXRlLmZpbmlzaGVkID0gdHJ1ZTsKCSAgICAgIHN0cmVhbS5lbWl0KCdmaW5pc2gnKTsKCSAgICB9IGVsc2UgewoJICAgICAgcHJlZmluaXNoKHN0cmVhbSwgc3RhdGUpOwoJICAgIH0KCSAgfQoJICByZXR1cm4gbmVlZDsKCX0KCglmdW5jdGlvbiBlbmRXcml0YWJsZShzdHJlYW0sIHN0YXRlLCBjYikgewoJICBzdGF0ZS5lbmRpbmcgPSB0cnVlOwoJICBmaW5pc2hNYXliZShzdHJlYW0sIHN0YXRlKTsKCSAgaWYgKGNiKSB7CgkgICAgaWYgKHN0YXRlLmZpbmlzaGVkKSBwcm9jZXNzTmV4dFRpY2soY2IpO2Vsc2Ugc3RyZWFtLm9uY2UoJ2ZpbmlzaCcsIGNiKTsKCSAgfQoJICBzdGF0ZS5lbmRlZCA9IHRydWU7CgkgIHN0cmVhbS53cml0YWJsZSA9IGZhbHNlOwoJfQoKCS8vIEl0IHNlZW1zIGEgbGlua2VkIGxpc3QgYnV0IGl0IGlzIG5vdAoJLy8gdGhlcmUgd2lsbCBiZSBvbmx5IDIgb2YgdGhlc2UgZm9yIGVhY2ggc3RyZWFtCglmdW5jdGlvbiBDb3JrZWRSZXF1ZXN0KHN0YXRlKSB7CgkgIHZhciBfdGhpcyA9IHRoaXM7CgoJICB0aGlzLm5leHQgPSBudWxsOwoJICB0aGlzLmVudHJ5ID0gbnVsbDsKCSAgdGhpcy5maW5pc2ggPSBmdW5jdGlvbiAoZXJyKSB7CgkgICAgdmFyIGVudHJ5ID0gX3RoaXMuZW50cnk7CgkgICAgX3RoaXMuZW50cnkgPSBudWxsOwoJICAgIHdoaWxlIChlbnRyeSkgewoJICAgICAgdmFyIGNiID0gZW50cnkuY2FsbGJhY2s7CgkgICAgICBzdGF0ZS5wZW5kaW5nY2ItLTsKCSAgICAgIGNiKGVycik7CgkgICAgICBlbnRyeSA9IGVudHJ5Lm5leHQ7CgkgICAgfQoJICAgIGlmIChzdGF0ZS5jb3JrZWRSZXF1ZXN0c0ZyZWUpIHsKCSAgICAgIHN0YXRlLmNvcmtlZFJlcXVlc3RzRnJlZS5uZXh0ID0gX3RoaXM7CgkgICAgfSBlbHNlIHsKCSAgICAgIHN0YXRlLmNvcmtlZFJlcXVlc3RzRnJlZSA9IF90aGlzOwoJICAgIH0KCSAgfTsKCX0KCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKSwgX193ZWJwYWNrX3JlcXVpcmVfXygyOSkuc2V0SW1tZWRpYXRlKSkKCi8qKiovIH0sCi8qIDI5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBhcHBseSA9IEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseTsKCgkvLyBET00gQVBJcywgZm9yIGNvbXBsZXRlbmVzcwoKCWV4cG9ydHMuc2V0VGltZW91dCA9IGZ1bmN0aW9uKCkgewoJICByZXR1cm4gbmV3IFRpbWVvdXQoYXBwbHkuY2FsbChzZXRUaW1lb3V0LCB3aW5kb3csIGFyZ3VtZW50cyksIGNsZWFyVGltZW91dCk7Cgl9OwoJZXhwb3J0cy5zZXRJbnRlcnZhbCA9IGZ1bmN0aW9uKCkgewoJICByZXR1cm4gbmV3IFRpbWVvdXQoYXBwbHkuY2FsbChzZXRJbnRlcnZhbCwgd2luZG93LCBhcmd1bWVudHMpLCBjbGVhckludGVydmFsKTsKCX07CglleHBvcnRzLmNsZWFyVGltZW91dCA9CglleHBvcnRzLmNsZWFySW50ZXJ2YWwgPSBmdW5jdGlvbih0aW1lb3V0KSB7CgkgIGlmICh0aW1lb3V0KSB7CgkgICAgdGltZW91dC5jbG9zZSgpOwoJICB9Cgl9OwoKCWZ1bmN0aW9uIFRpbWVvdXQoaWQsIGNsZWFyRm4pIHsKCSAgdGhpcy5faWQgPSBpZDsKCSAgdGhpcy5fY2xlYXJGbiA9IGNsZWFyRm47Cgl9CglUaW1lb3V0LnByb3RvdHlwZS51bnJlZiA9IFRpbWVvdXQucHJvdG90eXBlLnJlZiA9IGZ1bmN0aW9uKCkge307CglUaW1lb3V0LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkgewoJICB0aGlzLl9jbGVhckZuLmNhbGwod2luZG93LCB0aGlzLl9pZCk7Cgl9OwoKCS8vIERvZXMgbm90IHN0YXJ0IHRoZSB0aW1lLCBqdXN0IHNldHMgdXAgdGhlIG1lbWJlcnMgbmVlZGVkLgoJZXhwb3J0cy5lbnJvbGwgPSBmdW5jdGlvbihpdGVtLCBtc2VjcykgewoJICBjbGVhclRpbWVvdXQoaXRlbS5faWRsZVRpbWVvdXRJZCk7CgkgIGl0ZW0uX2lkbGVUaW1lb3V0ID0gbXNlY3M7Cgl9OwoKCWV4cG9ydHMudW5lbnJvbGwgPSBmdW5jdGlvbihpdGVtKSB7CgkgIGNsZWFyVGltZW91dChpdGVtLl9pZGxlVGltZW91dElkKTsKCSAgaXRlbS5faWRsZVRpbWVvdXQgPSAtMTsKCX07CgoJZXhwb3J0cy5fdW5yZWZBY3RpdmUgPSBleHBvcnRzLmFjdGl2ZSA9IGZ1bmN0aW9uKGl0ZW0pIHsKCSAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpOwoKCSAgdmFyIG1zZWNzID0gaXRlbS5faWRsZVRpbWVvdXQ7CgkgIGlmIChtc2VjcyA+PSAwKSB7CgkgICAgaXRlbS5faWRsZVRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gb25UaW1lb3V0KCkgewoJICAgICAgaWYgKGl0ZW0uX29uVGltZW91dCkKCSAgICAgICAgaXRlbS5fb25UaW1lb3V0KCk7CgkgICAgfSwgbXNlY3MpOwoJICB9Cgl9OwoKCS8vIHNldGltbWVkaWF0ZSBhdHRhY2hlcyBpdHNlbGYgdG8gdGhlIGdsb2JhbCBvYmplY3QKCV9fd2VicGFja19yZXF1aXJlX18oMzApOwoJZXhwb3J0cy5zZXRJbW1lZGlhdGUgPSBzZXRJbW1lZGlhdGU7CglleHBvcnRzLmNsZWFySW1tZWRpYXRlID0gY2xlYXJJbW1lZGlhdGU7CgoKLyoqKi8gfSwKLyogMzAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCwgcHJvY2VzcykgeyhmdW5jdGlvbiAoZ2xvYmFsLCB1bmRlZmluZWQpIHsKCSAgICAidXNlIHN0cmljdCI7CgoJICAgIGlmIChnbG9iYWwuc2V0SW1tZWRpYXRlKSB7CgkgICAgICAgIHJldHVybjsKCSAgICB9CgoJICAgIHZhciBuZXh0SGFuZGxlID0gMTsgLy8gU3BlYyBzYXlzIGdyZWF0ZXIgdGhhbiB6ZXJvCgkgICAgdmFyIHRhc2tzQnlIYW5kbGUgPSB7fTsKCSAgICB2YXIgY3VycmVudGx5UnVubmluZ0FUYXNrID0gZmFsc2U7CgkgICAgdmFyIGRvYyA9IGdsb2JhbC5kb2N1bWVudDsKCSAgICB2YXIgcmVnaXN0ZXJJbW1lZGlhdGU7CgoJICAgIGZ1bmN0aW9uIHNldEltbWVkaWF0ZShjYWxsYmFjaykgewoJICAgICAgLy8gQ2FsbGJhY2sgY2FuIGVpdGhlciBiZSBhIGZ1bmN0aW9uIG9yIGEgc3RyaW5nCgkgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSAiZnVuY3Rpb24iKSB7CgkgICAgICAgIGNhbGxiYWNrID0gbmV3IEZ1bmN0aW9uKCIiICsgY2FsbGJhY2spOwoJICAgICAgfQoJICAgICAgLy8gQ29weSBmdW5jdGlvbiBhcmd1bWVudHMKCSAgICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTsKCSAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykgewoJICAgICAgICAgIGFyZ3NbaV0gPSBhcmd1bWVudHNbaSArIDFdOwoJICAgICAgfQoJICAgICAgLy8gU3RvcmUgYW5kIHJlZ2lzdGVyIHRoZSB0YXNrCgkgICAgICB2YXIgdGFzayA9IHsgY2FsbGJhY2s6IGNhbGxiYWNrLCBhcmdzOiBhcmdzIH07CgkgICAgICB0YXNrc0J5SGFuZGxlW25leHRIYW5kbGVdID0gdGFzazsKCSAgICAgIHJlZ2lzdGVySW1tZWRpYXRlKG5leHRIYW5kbGUpOwoJICAgICAgcmV0dXJuIG5leHRIYW5kbGUrKzsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGNsZWFySW1tZWRpYXRlKGhhbmRsZSkgewoJICAgICAgICBkZWxldGUgdGFza3NCeUhhbmRsZVtoYW5kbGVdOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gcnVuKHRhc2spIHsKCSAgICAgICAgdmFyIGNhbGxiYWNrID0gdGFzay5jYWxsYmFjazsKCSAgICAgICAgdmFyIGFyZ3MgPSB0YXNrLmFyZ3M7CgkgICAgICAgIHN3aXRjaCAoYXJncy5sZW5ndGgpIHsKCSAgICAgICAgY2FzZSAwOgoJICAgICAgICAgICAgY2FsbGJhY2soKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBjYXNlIDE6CgkgICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBjYXNlIDI6CgkgICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBjYXNlIDM6CgkgICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodW5kZWZpbmVkLCBhcmdzKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBmdW5jdGlvbiBydW5JZlByZXNlbnQoaGFuZGxlKSB7CgkgICAgICAgIC8vIEZyb20gdGhlIHNwZWM6ICJXYWl0IHVudGlsIGFueSBpbnZvY2F0aW9ucyBvZiB0aGlzIGFsZ29yaXRobSBzdGFydGVkIGJlZm9yZSB0aGlzIG9uZSBoYXZlIGNvbXBsZXRlZC4iCgkgICAgICAgIC8vIFNvIGlmIHdlJ3JlIGN1cnJlbnRseSBydW5uaW5nIGEgdGFzaywgd2UnbGwgbmVlZCB0byBkZWxheSB0aGlzIGludm9jYXRpb24uCgkgICAgICAgIGlmIChjdXJyZW50bHlSdW5uaW5nQVRhc2spIHsKCSAgICAgICAgICAgIC8vIERlbGF5IGJ5IGRvaW5nIGEgc2V0VGltZW91dC4gc2V0SW1tZWRpYXRlIHdhcyB0cmllZCBpbnN0ZWFkLCBidXQgaW4gRmlyZWZveCA3IGl0IGdlbmVyYXRlZCBhCgkgICAgICAgICAgICAvLyAidG9vIG11Y2ggcmVjdXJzaW9uIiBlcnJvci4KCSAgICAgICAgICAgIHNldFRpbWVvdXQocnVuSWZQcmVzZW50LCAwLCBoYW5kbGUpOwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgdmFyIHRhc2sgPSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07CgkgICAgICAgICAgICBpZiAodGFzaykgewoJICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IHRydWU7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgcnVuKHRhc2spOwoJICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CgkgICAgICAgICAgICAgICAgICAgIGNsZWFySW1tZWRpYXRlKGhhbmRsZSk7CgkgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCgkgICAgZnVuY3Rpb24gaW5zdGFsbE5leHRUaWNrSW1wbGVtZW50YXRpb24oKSB7CgkgICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7CgkgICAgICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsgcnVuSWZQcmVzZW50KGhhbmRsZSk7IH0pOwoJICAgICAgICB9OwoJICAgIH0KCgkgICAgZnVuY3Rpb24gY2FuVXNlUG9zdE1lc3NhZ2UoKSB7CgkgICAgICAgIC8vIFRoZSB0ZXN0IGFnYWluc3QgYGltcG9ydFNjcmlwdHNgIHByZXZlbnRzIHRoaXMgaW1wbGVtZW50YXRpb24gZnJvbSBiZWluZyBpbnN0YWxsZWQgaW5zaWRlIGEgd2ViIHdvcmtlciwKCSAgICAgICAgLy8gd2hlcmUgYGdsb2JhbC5wb3N0TWVzc2FnZWAgbWVhbnMgc29tZXRoaW5nIGNvbXBsZXRlbHkgZGlmZmVyZW50IGFuZCBjYW4ndCBiZSB1c2VkIGZvciB0aGlzIHB1cnBvc2UuCgkgICAgICAgIGlmIChnbG9iYWwucG9zdE1lc3NhZ2UgJiYgIWdsb2JhbC5pbXBvcnRTY3JpcHRzKSB7CgkgICAgICAgICAgICB2YXIgcG9zdE1lc3NhZ2VJc0FzeW5jaHJvbm91cyA9IHRydWU7CgkgICAgICAgICAgICB2YXIgb2xkT25NZXNzYWdlID0gZ2xvYmFsLm9ubWVzc2FnZTsKCSAgICAgICAgICAgIGdsb2JhbC5vbm1lc3NhZ2UgPSBmdW5jdGlvbigpIHsKCSAgICAgICAgICAgICAgICBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzID0gZmFsc2U7CgkgICAgICAgICAgICB9OwoJICAgICAgICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKCIiLCAiKiIpOwoJICAgICAgICAgICAgZ2xvYmFsLm9ubWVzc2FnZSA9IG9sZE9uTWVzc2FnZTsKCSAgICAgICAgICAgIHJldHVybiBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBmdW5jdGlvbiBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpIHsKCSAgICAgICAgLy8gSW5zdGFsbHMgYW4gZXZlbnQgaGFuZGxlciBvbiBgZ2xvYmFsYCBmb3IgdGhlIGBtZXNzYWdlYCBldmVudDogc2VlCgkgICAgICAgIC8vICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vRE9NL3dpbmRvdy5wb3N0TWVzc2FnZQoJICAgICAgICAvLyAqIGh0dHA6Ly93d3cud2hhdHdnLm9yZy9zcGVjcy93ZWItYXBwcy9jdXJyZW50LXdvcmsvbXVsdGlwYWdlL2NvbW1zLmh0bWwjY3Jvc3NEb2N1bWVudE1lc3NhZ2VzCgoJICAgICAgICB2YXIgbWVzc2FnZVByZWZpeCA9ICJzZXRJbW1lZGlhdGUkIiArIE1hdGgucmFuZG9tKCkgKyAiJCI7CgkgICAgICAgIHZhciBvbkdsb2JhbE1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkgewoJICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gZ2xvYmFsICYmCgkgICAgICAgICAgICAgICAgdHlwZW9mIGV2ZW50LmRhdGEgPT09ICJzdHJpbmciICYmCgkgICAgICAgICAgICAgICAgZXZlbnQuZGF0YS5pbmRleE9mKG1lc3NhZ2VQcmVmaXgpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcnVuSWZQcmVzZW50KCtldmVudC5kYXRhLnNsaWNlKG1lc3NhZ2VQcmVmaXgubGVuZ3RoKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH07CgoJICAgICAgICBpZiAoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIpIHsKCSAgICAgICAgICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgb25HbG9iYWxNZXNzYWdlLCBmYWxzZSk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBnbG9iYWwuYXR0YWNoRXZlbnQoIm9ubWVzc2FnZSIsIG9uR2xvYmFsTWVzc2FnZSk7CgkgICAgICAgIH0KCgkgICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7CgkgICAgICAgICAgICBnbG9iYWwucG9zdE1lc3NhZ2UobWVzc2FnZVByZWZpeCArIGhhbmRsZSwgIioiKTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGluc3RhbGxNZXNzYWdlQ2hhbm5lbEltcGxlbWVudGF0aW9uKCkgewoJICAgICAgICB2YXIgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpOwoJICAgICAgICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkgICAgICAgICAgICB2YXIgaGFuZGxlID0gZXZlbnQuZGF0YTsKCSAgICAgICAgICAgIHJ1bklmUHJlc2VudChoYW5kbGUpOwoJICAgICAgICB9OwoKCSAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHsKCSAgICAgICAgICAgIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoaGFuZGxlKTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGluc3RhbGxSZWFkeVN0YXRlQ2hhbmdlSW1wbGVtZW50YXRpb24oKSB7CgkgICAgICAgIHZhciBodG1sID0gZG9jLmRvY3VtZW50RWxlbWVudDsKCSAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHsKCSAgICAgICAgICAgIC8vIENyZWF0ZSBhIDxzY3JpcHQ+IGVsZW1lbnQ7IGl0cyByZWFkeXN0YXRlY2hhbmdlIGV2ZW50IHdpbGwgYmUgZmlyZWQgYXN5bmNocm9ub3VzbHkgb25jZSBpdCBpcyBpbnNlcnRlZAoJICAgICAgICAgICAgLy8gaW50byB0aGUgZG9jdW1lbnQuIERvIHNvLCB0aHVzIHF1ZXVpbmcgdXAgdGhlIHRhc2suIFJlbWVtYmVyIHRvIGNsZWFuIHVwIG9uY2UgaXQncyBiZWVuIGNhbGxlZC4KCSAgICAgICAgICAgIHZhciBzY3JpcHQgPSBkb2MuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CgkgICAgICAgICAgICBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgICAgIHJ1bklmUHJlc2VudChoYW5kbGUpOwoJICAgICAgICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsOwoJICAgICAgICAgICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQoc2NyaXB0KTsKCSAgICAgICAgICAgICAgICBzY3JpcHQgPSBudWxsOwoJICAgICAgICAgICAgfTsKCSAgICAgICAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoc2NyaXB0KTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGluc3RhbGxTZXRUaW1lb3V0SW1wbGVtZW50YXRpb24oKSB7CgkgICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7CgkgICAgICAgICAgICBzZXRUaW1lb3V0KHJ1bklmUHJlc2VudCwgMCwgaGFuZGxlKTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIC8vIElmIHN1cHBvcnRlZCwgd2Ugc2hvdWxkIGF0dGFjaCB0byB0aGUgcHJvdG90eXBlIG9mIGdsb2JhbCwgc2luY2UgdGhhdCBpcyB3aGVyZSBzZXRUaW1lb3V0IGV0IGFsLiBsaXZlLgoJICAgIHZhciBhdHRhY2hUbyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiAmJiBPYmplY3QuZ2V0UHJvdG90eXBlT2YoZ2xvYmFsKTsKCSAgICBhdHRhY2hUbyA9IGF0dGFjaFRvICYmIGF0dGFjaFRvLnNldFRpbWVvdXQgPyBhdHRhY2hUbyA6IGdsb2JhbDsKCgkgICAgLy8gRG9uJ3QgZ2V0IGZvb2xlZCBieSBlLmcuIGJyb3dzZXJpZnkgZW52aXJvbm1lbnRzLgoJICAgIGlmICh7fS50b1N0cmluZy5jYWxsKGdsb2JhbC5wcm9jZXNzKSA9PT0gIltvYmplY3QgcHJvY2Vzc10iKSB7CgkgICAgICAgIC8vIEZvciBOb2RlLmpzIGJlZm9yZSAwLjkKCSAgICAgICAgaW5zdGFsbE5leHRUaWNrSW1wbGVtZW50YXRpb24oKTsKCgkgICAgfSBlbHNlIGlmIChjYW5Vc2VQb3N0TWVzc2FnZSgpKSB7CgkgICAgICAgIC8vIEZvciBub24tSUUxMCBtb2Rlcm4gYnJvd3NlcnMKCSAgICAgICAgaW5zdGFsbFBvc3RNZXNzYWdlSW1wbGVtZW50YXRpb24oKTsKCgkgICAgfSBlbHNlIGlmIChnbG9iYWwuTWVzc2FnZUNoYW5uZWwpIHsKCSAgICAgICAgLy8gRm9yIHdlYiB3b3JrZXJzLCB3aGVyZSBzdXBwb3J0ZWQKCSAgICAgICAgaW5zdGFsbE1lc3NhZ2VDaGFubmVsSW1wbGVtZW50YXRpb24oKTsKCgkgICAgfSBlbHNlIGlmIChkb2MgJiYgIm9ucmVhZHlzdGF0ZWNoYW5nZSIgaW4gZG9jLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpKSB7CgkgICAgICAgIC8vIEZvciBJRSA24oCTOAoJICAgICAgICBpbnN0YWxsUmVhZHlTdGF0ZUNoYW5nZUltcGxlbWVudGF0aW9uKCk7CgoJICAgIH0gZWxzZSB7CgkgICAgICAgIC8vIEZvciBvbGRlciBicm93c2VycwoJICAgICAgICBpbnN0YWxsU2V0VGltZW91dEltcGxlbWVudGF0aW9uKCk7CgkgICAgfQoKCSAgICBhdHRhY2hUby5zZXRJbW1lZGlhdGUgPSBzZXRJbW1lZGlhdGU7CgkgICAgYXR0YWNoVG8uY2xlYXJJbW1lZGlhdGUgPSBjbGVhckltbWVkaWF0ZTsKCX0odHlwZW9mIHNlbGYgPT09ICJ1bmRlZmluZWQiID8gdHlwZW9mIGdsb2JhbCA9PT0gInVuZGVmaW5lZCIgPyB0aGlzIDogZ2xvYmFsIDogc2VsZikpOwoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKSkpCgovKioqLyB9LAovKiAzMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7CgkvKioKCSAqIE1vZHVsZSBleHBvcnRzLgoJICovCgoJbW9kdWxlLmV4cG9ydHMgPSBkZXByZWNhdGU7CgoJLyoqCgkgKiBNYXJrIHRoYXQgYSBtZXRob2Qgc2hvdWxkIG5vdCBiZSB1c2VkLgoJICogUmV0dXJucyBhIG1vZGlmaWVkIGZ1bmN0aW9uIHdoaWNoIHdhcm5zIG9uY2UgYnkgZGVmYXVsdC4KCSAqCgkgKiBJZiBgbG9jYWxTdG9yYWdlLm5vRGVwcmVjYXRpb24gPSB0cnVlYCBpcyBzZXQsIHRoZW4gaXQgaXMgYSBuby1vcC4KCSAqCgkgKiBJZiBgbG9jYWxTdG9yYWdlLnRocm93RGVwcmVjYXRpb24gPSB0cnVlYCBpcyBzZXQsIHRoZW4gZGVwcmVjYXRlZCBmdW5jdGlvbnMKCSAqIHdpbGwgdGhyb3cgYW4gRXJyb3Igd2hlbiBpbnZva2VkLgoJICoKCSAqIElmIGBsb2NhbFN0b3JhZ2UudHJhY2VEZXByZWNhdGlvbiA9IHRydWVgIGlzIHNldCwgdGhlbiBkZXByZWNhdGVkIGZ1bmN0aW9ucwoJICogd2lsbCBpbnZva2UgYGNvbnNvbGUudHJhY2UoKWAgaW5zdGVhZCBvZiBgY29uc29sZS5lcnJvcigpYC4KCSAqCgkgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIHRoZSBmdW5jdGlvbiB0byBkZXByZWNhdGUKCSAqIEBwYXJhbSB7U3RyaW5nfSBtc2cgLSB0aGUgc3RyaW5nIHRvIHByaW50IHRvIHRoZSBjb25zb2xlIHdoZW4gYGZuYCBpcyBpbnZva2VkCgkgKiBAcmV0dXJucyB7RnVuY3Rpb259IGEgbmV3ICJkZXByZWNhdGVkIiB2ZXJzaW9uIG9mIGBmbmAKCSAqIEBhcGkgcHVibGljCgkgKi8KCglmdW5jdGlvbiBkZXByZWNhdGUgKGZuLCBtc2cpIHsKCSAgaWYgKGNvbmZpZygnbm9EZXByZWNhdGlvbicpKSB7CgkgICAgcmV0dXJuIGZuOwoJICB9CgoJICB2YXIgd2FybmVkID0gZmFsc2U7CgkgIGZ1bmN0aW9uIGRlcHJlY2F0ZWQoKSB7CgkgICAgaWYgKCF3YXJuZWQpIHsKCSAgICAgIGlmIChjb25maWcoJ3Rocm93RGVwcmVjYXRpb24nKSkgewoJICAgICAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTsKCSAgICAgIH0gZWxzZSBpZiAoY29uZmlnKCd0cmFjZURlcHJlY2F0aW9uJykpIHsKCSAgICAgICAgY29uc29sZS50cmFjZShtc2cpOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgY29uc29sZS53YXJuKG1zZyk7CgkgICAgICB9CgkgICAgICB3YXJuZWQgPSB0cnVlOwoJICAgIH0KCSAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCSAgfQoKCSAgcmV0dXJuIGRlcHJlY2F0ZWQ7Cgl9CgoJLyoqCgkgKiBDaGVja3MgYGxvY2FsU3RvcmFnZWAgZm9yIGJvb2xlYW4gdmFsdWVzIGZvciB0aGUgZ2l2ZW4gYG5hbWVgLgoJICoKCSAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lCgkgKiBAcmV0dXJucyB7Qm9vbGVhbn0KCSAqIEBhcGkgcHJpdmF0ZQoJICovCgoJZnVuY3Rpb24gY29uZmlnIChuYW1lKSB7CgkgIC8vIGFjY2Vzc2luZyBnbG9iYWwubG9jYWxTdG9yYWdlIGNhbiB0cmlnZ2VyIGEgRE9NRXhjZXB0aW9uIGluIHNhbmRib3hlZCBpZnJhbWVzCgkgIHRyeSB7CgkgICAgaWYgKCFnbG9iYWwubG9jYWxTdG9yYWdlKSByZXR1cm4gZmFsc2U7CgkgIH0gY2F0Y2ggKF8pIHsKCSAgICByZXR1cm4gZmFsc2U7CgkgIH0KCSAgdmFyIHZhbCA9IGdsb2JhbC5sb2NhbFN0b3JhZ2VbbmFtZV07CgkgIGlmIChudWxsID09IHZhbCkgcmV0dXJuIGZhbHNlOwoJICByZXR1cm4gU3RyaW5nKHZhbCkudG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnOwoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSkKCi8qKiovIH0sCi8qIDMyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCgl2YXIgQnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikuQnVmZmVyOwoJdmFyIGJ1ZmZlclNoaW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKCgl2YXIgaXNFbmNvZGluZyA9IEJ1ZmZlci5pc0VuY29kaW5nIHx8IGZ1bmN0aW9uIChlbmNvZGluZykgewoJICBlbmNvZGluZyA9ICcnICsgZW5jb2Rpbmc7CgkgIHN3aXRjaCAoZW5jb2RpbmcgJiYgZW5jb2RpbmcudG9Mb3dlckNhc2UoKSkgewoJICAgIGNhc2UgJ2hleCc6Y2FzZSAndXRmOCc6Y2FzZSAndXRmLTgnOmNhc2UgJ2FzY2lpJzpjYXNlICdiaW5hcnknOmNhc2UgJ2Jhc2U2NCc6Y2FzZSAndWNzMic6Y2FzZSAndWNzLTInOmNhc2UgJ3V0ZjE2bGUnOmNhc2UgJ3V0Zi0xNmxlJzpjYXNlICdyYXcnOgoJICAgICAgcmV0dXJuIHRydWU7CgkgICAgZGVmYXVsdDoKCSAgICAgIHJldHVybiBmYWxzZTsKCSAgfQoJfTsKCglmdW5jdGlvbiBfbm9ybWFsaXplRW5jb2RpbmcoZW5jKSB7CgkgIGlmICghZW5jKSByZXR1cm4gJ3V0ZjgnOwoJICB2YXIgcmV0cmllZDsKCSAgd2hpbGUgKHRydWUpIHsKCSAgICBzd2l0Y2ggKGVuYykgewoJICAgICAgY2FzZSAndXRmOCc6CgkgICAgICBjYXNlICd1dGYtOCc6CgkgICAgICAgIHJldHVybiAndXRmOCc7CgkgICAgICBjYXNlICd1Y3MyJzoKCSAgICAgIGNhc2UgJ3Vjcy0yJzoKCSAgICAgIGNhc2UgJ3V0ZjE2bGUnOgoJICAgICAgY2FzZSAndXRmLTE2bGUnOgoJICAgICAgICByZXR1cm4gJ3V0ZjE2bGUnOwoJICAgICAgY2FzZSAnbGF0aW4xJzoKCSAgICAgIGNhc2UgJ2JpbmFyeSc6CgkgICAgICAgIHJldHVybiAnbGF0aW4xJzsKCSAgICAgIGNhc2UgJ2Jhc2U2NCc6CgkgICAgICBjYXNlICdhc2NpaSc6CgkgICAgICBjYXNlICdoZXgnOgoJICAgICAgICByZXR1cm4gZW5jOwoJICAgICAgZGVmYXVsdDoKCSAgICAgICAgaWYgKHJldHJpZWQpIHJldHVybjsgLy8gdW5kZWZpbmVkCgkgICAgICAgIGVuYyA9ICgnJyArIGVuYykudG9Mb3dlckNhc2UoKTsKCSAgICAgICAgcmV0cmllZCA9IHRydWU7CgkgICAgfQoJICB9Cgl9OwoKCS8vIERvIG5vdCBjYWNoZSBgQnVmZmVyLmlzRW5jb2RpbmdgIHdoZW4gY2hlY2tpbmcgZW5jb2RpbmcgbmFtZXMgYXMgc29tZQoJLy8gbW9kdWxlcyBtb25rZXktcGF0Y2ggaXQgdG8gc3VwcG9ydCBhZGRpdGlvbmFsIGVuY29kaW5ncwoJZnVuY3Rpb24gbm9ybWFsaXplRW5jb2RpbmcoZW5jKSB7CgkgIHZhciBuZW5jID0gX25vcm1hbGl6ZUVuY29kaW5nKGVuYyk7CgkgIGlmICh0eXBlb2YgbmVuYyAhPT0gJ3N0cmluZycgJiYgKEJ1ZmZlci5pc0VuY29kaW5nID09PSBpc0VuY29kaW5nIHx8ICFpc0VuY29kaW5nKGVuYykpKSB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmMpOwoJICByZXR1cm4gbmVuYyB8fCBlbmM7Cgl9CgoJLy8gU3RyaW5nRGVjb2RlciBwcm92aWRlcyBhbiBpbnRlcmZhY2UgZm9yIGVmZmljaWVudGx5IHNwbGl0dGluZyBhIHNlcmllcyBvZgoJLy8gYnVmZmVycyBpbnRvIGEgc2VyaWVzIG9mIEpTIHN0cmluZ3Mgd2l0aG91dCBicmVha2luZyBhcGFydCBtdWx0aS1ieXRlCgkvLyBjaGFyYWN0ZXJzLgoJZXhwb3J0cy5TdHJpbmdEZWNvZGVyID0gU3RyaW5nRGVjb2RlcjsKCWZ1bmN0aW9uIFN0cmluZ0RlY29kZXIoZW5jb2RpbmcpIHsKCSAgdGhpcy5lbmNvZGluZyA9IG5vcm1hbGl6ZUVuY29kaW5nKGVuY29kaW5nKTsKCSAgdmFyIG5iOwoJICBzd2l0Y2ggKHRoaXMuZW5jb2RpbmcpIHsKCSAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIHRoaXMudGV4dCA9IHV0ZjE2VGV4dDsKCSAgICAgIHRoaXMuZW5kID0gdXRmMTZFbmQ7CgkgICAgICBuYiA9IDQ7CgkgICAgICBicmVhazsKCSAgICBjYXNlICd1dGY4JzoKCSAgICAgIHRoaXMuZmlsbExhc3QgPSB1dGY4RmlsbExhc3Q7CgkgICAgICBuYiA9IDQ7CgkgICAgICBicmVhazsKCSAgICBjYXNlICdiYXNlNjQnOgoJICAgICAgdGhpcy50ZXh0ID0gYmFzZTY0VGV4dDsKCSAgICAgIHRoaXMuZW5kID0gYmFzZTY0RW5kOwoJICAgICAgbmIgPSAzOwoJICAgICAgYnJlYWs7CgkgICAgZGVmYXVsdDoKCSAgICAgIHRoaXMud3JpdGUgPSBzaW1wbGVXcml0ZTsKCSAgICAgIHRoaXMuZW5kID0gc2ltcGxlRW5kOwoJICAgICAgcmV0dXJuOwoJICB9CgkgIHRoaXMubGFzdE5lZWQgPSAwOwoJICB0aGlzLmxhc3RUb3RhbCA9IDA7CgkgIHRoaXMubGFzdENoYXIgPSBidWZmZXJTaGltLmFsbG9jVW5zYWZlKG5iKTsKCX0KCglTdHJpbmdEZWNvZGVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChidWYpIHsKCSAgaWYgKGJ1Zi5sZW5ndGggPT09IDApIHJldHVybiAnJzsKCSAgdmFyIHI7CgkgIHZhciBpOwoJICBpZiAodGhpcy5sYXN0TmVlZCkgewoJICAgIHIgPSB0aGlzLmZpbGxMYXN0KGJ1Zik7CgkgICAgaWYgKHIgPT09IHVuZGVmaW5lZCkgcmV0dXJuICcnOwoJICAgIGkgPSB0aGlzLmxhc3ROZWVkOwoJICAgIHRoaXMubGFzdE5lZWQgPSAwOwoJICB9IGVsc2UgewoJICAgIGkgPSAwOwoJICB9CgkgIGlmIChpIDwgYnVmLmxlbmd0aCkgcmV0dXJuIHIgPyByICsgdGhpcy50ZXh0KGJ1ZiwgaSkgOiB0aGlzLnRleHQoYnVmLCBpKTsKCSAgcmV0dXJuIHIgfHwgJyc7Cgl9OwoKCVN0cmluZ0RlY29kZXIucHJvdG90eXBlLmVuZCA9IHV0ZjhFbmQ7CgoJLy8gUmV0dXJucyBvbmx5IGNvbXBsZXRlIGNoYXJhY3RlcnMgaW4gYSBCdWZmZXIKCVN0cmluZ0RlY29kZXIucHJvdG90eXBlLnRleHQgPSB1dGY4VGV4dDsKCgkvLyBBdHRlbXB0cyB0byBjb21wbGV0ZSBhIHBhcnRpYWwgbm9uLVVURi04IGNoYXJhY3RlciB1c2luZyBieXRlcyBmcm9tIGEgQnVmZmVyCglTdHJpbmdEZWNvZGVyLnByb3RvdHlwZS5maWxsTGFzdCA9IGZ1bmN0aW9uIChidWYpIHsKCSAgaWYgKHRoaXMubGFzdE5lZWQgPD0gYnVmLmxlbmd0aCkgewoJICAgIGJ1Zi5jb3B5KHRoaXMubGFzdENoYXIsIHRoaXMubGFzdFRvdGFsIC0gdGhpcy5sYXN0TmVlZCwgMCwgdGhpcy5sYXN0TmVlZCk7CgkgICAgcmV0dXJuIHRoaXMubGFzdENoYXIudG9TdHJpbmcodGhpcy5lbmNvZGluZywgMCwgdGhpcy5sYXN0VG90YWwpOwoJICB9CgkgIGJ1Zi5jb3B5KHRoaXMubGFzdENoYXIsIHRoaXMubGFzdFRvdGFsIC0gdGhpcy5sYXN0TmVlZCwgMCwgYnVmLmxlbmd0aCk7CgkgIHRoaXMubGFzdE5lZWQgLT0gYnVmLmxlbmd0aDsKCX07CgoJLy8gQ2hlY2tzIHRoZSB0eXBlIG9mIGEgVVRGLTggYnl0ZSwgd2hldGhlciBpdCdzIEFTQ0lJLCBhIGxlYWRpbmcgYnl0ZSwgb3IgYQoJLy8gY29udGludWF0aW9uIGJ5dGUuCglmdW5jdGlvbiB1dGY4Q2hlY2tCeXRlKGJ5dGUpIHsKCSAgaWYgKGJ5dGUgPD0gMHg3RikgcmV0dXJuIDA7ZWxzZSBpZiAoYnl0ZSA+PiA1ID09PSAweDA2KSByZXR1cm4gMjtlbHNlIGlmIChieXRlID4+IDQgPT09IDB4MEUpIHJldHVybiAzO2Vsc2UgaWYgKGJ5dGUgPj4gMyA9PT0gMHgxRSkgcmV0dXJuIDQ7CgkgIHJldHVybiAtMTsKCX0KCgkvLyBDaGVja3MgYXQgbW9zdCAzIGJ5dGVzIGF0IHRoZSBlbmQgb2YgYSBCdWZmZXIgaW4gb3JkZXIgdG8gZGV0ZWN0IGFuCgkvLyBpbmNvbXBsZXRlIG11bHRpLWJ5dGUgVVRGLTggY2hhcmFjdGVyLiBUaGUgdG90YWwgbnVtYmVyIG9mIGJ5dGVzICgyLCAzLCBvciA0KQoJLy8gbmVlZGVkIHRvIGNvbXBsZXRlIHRoZSBVVEYtOCBjaGFyYWN0ZXIgKGlmIGFwcGxpY2FibGUpIGFyZSByZXR1cm5lZC4KCWZ1bmN0aW9uIHV0ZjhDaGVja0luY29tcGxldGUoc2VsZiwgYnVmLCBpKSB7CgkgIHZhciBqID0gYnVmLmxlbmd0aCAtIDE7CgkgIGlmIChqIDwgaSkgcmV0dXJuIDA7CgkgIHZhciBuYiA9IHV0ZjhDaGVja0J5dGUoYnVmW2pdKTsKCSAgaWYgKG5iID49IDApIHsKCSAgICBpZiAobmIgPiAwKSBzZWxmLmxhc3ROZWVkID0gbmIgLSAxOwoJICAgIHJldHVybiBuYjsKCSAgfQoJICBpZiAoLS1qIDwgaSkgcmV0dXJuIDA7CgkgIG5iID0gdXRmOENoZWNrQnl0ZShidWZbal0pOwoJICBpZiAobmIgPj0gMCkgewoJICAgIGlmIChuYiA+IDApIHNlbGYubGFzdE5lZWQgPSBuYiAtIDI7CgkgICAgcmV0dXJuIG5iOwoJICB9CgkgIGlmICgtLWogPCBpKSByZXR1cm4gMDsKCSAgbmIgPSB1dGY4Q2hlY2tCeXRlKGJ1ZltqXSk7CgkgIGlmIChuYiA+PSAwKSB7CgkgICAgaWYgKG5iID4gMCkgewoJICAgICAgaWYgKG5iID09PSAyKSBuYiA9IDA7ZWxzZSBzZWxmLmxhc3ROZWVkID0gbmIgLSAzOwoJICAgIH0KCSAgICByZXR1cm4gbmI7CgkgIH0KCSAgcmV0dXJuIDA7Cgl9CgoJLy8gVmFsaWRhdGVzIGFzIG1hbnkgY29udGludWF0aW9uIGJ5dGVzIGZvciBhIG11bHRpLWJ5dGUgVVRGLTggY2hhcmFjdGVyIGFzCgkvLyBuZWVkZWQgb3IgYXJlIGF2YWlsYWJsZS4gSWYgd2Ugc2VlIGEgbm9uLWNvbnRpbnVhdGlvbiBieXRlIHdoZXJlIHdlIGV4cGVjdAoJLy8gb25lLCB3ZSAicmVwbGFjZSIgdGhlIHZhbGlkYXRlZCBjb250aW51YXRpb24gYnl0ZXMgd2UndmUgc2VlbiBzbyBmYXIgd2l0aAoJLy8gVVRGLTggcmVwbGFjZW1lbnQgY2hhcmFjdGVycyAoJ1x1ZmZmZCcpLCB0byBtYXRjaCB2OCdzIFVURi04IGRlY29kaW5nCgkvLyBiZWhhdmlvci4gVGhlIGNvbnRpbnVhdGlvbiBieXRlIGNoZWNrIGlzIGluY2x1ZGVkIHRocmVlIHRpbWVzIGluIHRoZSBjYXNlCgkvLyB3aGVyZSBhbGwgb2YgdGhlIGNvbnRpbnVhdGlvbiBieXRlcyBmb3IgYSBjaGFyYWN0ZXIgZXhpc3QgaW4gdGhlIHNhbWUgYnVmZmVyLgoJLy8gSXQgaXMgYWxzbyBkb25lIHRoaXMgd2F5IGFzIGEgc2xpZ2h0IHBlcmZvcm1hbmNlIGluY3JlYXNlIGluc3RlYWQgb2YgdXNpbmcgYQoJLy8gbG9vcC4KCWZ1bmN0aW9uIHV0ZjhDaGVja0V4dHJhQnl0ZXMoc2VsZiwgYnVmLCBwKSB7CgkgIGlmICgoYnVmWzBdICYgMHhDMCkgIT09IDB4ODApIHsKCSAgICBzZWxmLmxhc3ROZWVkID0gMDsKCSAgICByZXR1cm4gJ1x1ZmZmZCcucmVwZWF0KHApOwoJICB9CgkgIGlmIChzZWxmLmxhc3ROZWVkID4gMSAmJiBidWYubGVuZ3RoID4gMSkgewoJICAgIGlmICgoYnVmWzFdICYgMHhDMCkgIT09IDB4ODApIHsKCSAgICAgIHNlbGYubGFzdE5lZWQgPSAxOwoJICAgICAgcmV0dXJuICdcdWZmZmQnLnJlcGVhdChwICsgMSk7CgkgICAgfQoJICAgIGlmIChzZWxmLmxhc3ROZWVkID4gMiAmJiBidWYubGVuZ3RoID4gMikgewoJICAgICAgaWYgKChidWZbMl0gJiAweEMwKSAhPT0gMHg4MCkgewoJICAgICAgICBzZWxmLmxhc3ROZWVkID0gMjsKCSAgICAgICAgcmV0dXJuICdcdWZmZmQnLnJlcGVhdChwICsgMik7CgkgICAgICB9CgkgICAgfQoJICB9Cgl9CgoJLy8gQXR0ZW1wdHMgdG8gY29tcGxldGUgYSBtdWx0aS1ieXRlIFVURi04IGNoYXJhY3RlciB1c2luZyBieXRlcyBmcm9tIGEgQnVmZmVyLgoJZnVuY3Rpb24gdXRmOEZpbGxMYXN0KGJ1ZikgewoJICB2YXIgcCA9IHRoaXMubGFzdFRvdGFsIC0gdGhpcy5sYXN0TmVlZDsKCSAgdmFyIHIgPSB1dGY4Q2hlY2tFeHRyYUJ5dGVzKHRoaXMsIGJ1ZiwgcCk7CgkgIGlmIChyICE9PSB1bmRlZmluZWQpIHJldHVybiByOwoJICBpZiAodGhpcy5sYXN0TmVlZCA8PSBidWYubGVuZ3RoKSB7CgkgICAgYnVmLmNvcHkodGhpcy5sYXN0Q2hhciwgcCwgMCwgdGhpcy5sYXN0TmVlZCk7CgkgICAgcmV0dXJuIHRoaXMubGFzdENoYXIudG9TdHJpbmcodGhpcy5lbmNvZGluZywgMCwgdGhpcy5sYXN0VG90YWwpOwoJICB9CgkgIGJ1Zi5jb3B5KHRoaXMubGFzdENoYXIsIHAsIDAsIGJ1Zi5sZW5ndGgpOwoJICB0aGlzLmxhc3ROZWVkIC09IGJ1Zi5sZW5ndGg7Cgl9CgoJLy8gUmV0dXJucyBhbGwgY29tcGxldGUgVVRGLTggY2hhcmFjdGVycyBpbiBhIEJ1ZmZlci4gSWYgdGhlIEJ1ZmZlciBlbmRlZCBvbiBhCgkvLyBwYXJ0aWFsIGNoYXJhY3RlciwgdGhlIGNoYXJhY3RlcidzIGJ5dGVzIGFyZSBidWZmZXJlZCB1bnRpbCB0aGUgcmVxdWlyZWQKCS8vIG51bWJlciBvZiBieXRlcyBhcmUgYXZhaWxhYmxlLgoJZnVuY3Rpb24gdXRmOFRleHQoYnVmLCBpKSB7CgkgIHZhciB0b3RhbCA9IHV0ZjhDaGVja0luY29tcGxldGUodGhpcywgYnVmLCBpKTsKCSAgaWYgKCF0aGlzLmxhc3ROZWVkKSByZXR1cm4gYnVmLnRvU3RyaW5nKCd1dGY4JywgaSk7CgkgIHRoaXMubGFzdFRvdGFsID0gdG90YWw7CgkgIHZhciBlbmQgPSBidWYubGVuZ3RoIC0gKHRvdGFsIC0gdGhpcy5sYXN0TmVlZCk7CgkgIGJ1Zi5jb3B5KHRoaXMubGFzdENoYXIsIDAsIGVuZCk7CgkgIHJldHVybiBidWYudG9TdHJpbmcoJ3V0ZjgnLCBpLCBlbmQpOwoJfQoKCS8vIEZvciBVVEYtOCwgYSByZXBsYWNlbWVudCBjaGFyYWN0ZXIgZm9yIGVhY2ggYnVmZmVyZWQgYnl0ZSBvZiBhIChwYXJ0aWFsKQoJLy8gY2hhcmFjdGVyIG5lZWRzIHRvIGJlIGFkZGVkIHRvIHRoZSBvdXRwdXQuCglmdW5jdGlvbiB1dGY4RW5kKGJ1ZikgewoJICB2YXIgciA9IGJ1ZiAmJiBidWYubGVuZ3RoID8gdGhpcy53cml0ZShidWYpIDogJyc7CgkgIGlmICh0aGlzLmxhc3ROZWVkKSByZXR1cm4gciArICdcdWZmZmQnLnJlcGVhdCh0aGlzLmxhc3RUb3RhbCAtIHRoaXMubGFzdE5lZWQpOwoJICByZXR1cm4gcjsKCX0KCgkvLyBVVEYtMTZMRSB0eXBpY2FsbHkgbmVlZHMgdHdvIGJ5dGVzIHBlciBjaGFyYWN0ZXIsIGJ1dCBldmVuIGlmIHdlIGhhdmUgYW4gZXZlbgoJLy8gbnVtYmVyIG9mIGJ5dGVzIGF2YWlsYWJsZSwgd2UgbmVlZCB0byBjaGVjayBpZiB3ZSBlbmQgb24gYSBsZWFkaW5nL2hpZ2gKCS8vIHN1cnJvZ2F0ZS4gSW4gdGhhdCBjYXNlLCB3ZSBuZWVkIHRvIHdhaXQgZm9yIHRoZSBuZXh0IHR3byBieXRlcyBpbiBvcmRlciB0bwoJLy8gZGVjb2RlIHRoZSBsYXN0IGNoYXJhY3RlciBwcm9wZXJseS4KCWZ1bmN0aW9uIHV0ZjE2VGV4dChidWYsIGkpIHsKCSAgaWYgKChidWYubGVuZ3RoIC0gaSkgJSAyID09PSAwKSB7CgkgICAgdmFyIHIgPSBidWYudG9TdHJpbmcoJ3V0ZjE2bGUnLCBpKTsKCSAgICBpZiAocikgewoJICAgICAgdmFyIGMgPSByLmNoYXJDb2RlQXQoci5sZW5ndGggLSAxKTsKCSAgICAgIGlmIChjID49IDB4RDgwMCAmJiBjIDw9IDB4REJGRikgewoJICAgICAgICB0aGlzLmxhc3ROZWVkID0gMjsKCSAgICAgICAgdGhpcy5sYXN0VG90YWwgPSA0OwoJICAgICAgICB0aGlzLmxhc3RDaGFyWzBdID0gYnVmW2J1Zi5sZW5ndGggLSAyXTsKCSAgICAgICAgdGhpcy5sYXN0Q2hhclsxXSA9IGJ1ZltidWYubGVuZ3RoIC0gMV07CgkgICAgICAgIHJldHVybiByLnNsaWNlKDAsIC0xKTsKCSAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIHI7CgkgIH0KCSAgdGhpcy5sYXN0TmVlZCA9IDE7CgkgIHRoaXMubGFzdFRvdGFsID0gMjsKCSAgdGhpcy5sYXN0Q2hhclswXSA9IGJ1ZltidWYubGVuZ3RoIC0gMV07CgkgIHJldHVybiBidWYudG9TdHJpbmcoJ3V0ZjE2bGUnLCBpLCBidWYubGVuZ3RoIC0gMSk7Cgl9CgoJLy8gRm9yIFVURi0xNkxFIHdlIGRvIG5vdCBleHBsaWNpdGx5IGFwcGVuZCBzcGVjaWFsIHJlcGxhY2VtZW50IGNoYXJhY3RlcnMgaWYgd2UKCS8vIGVuZCBvbiBhIHBhcnRpYWwgY2hhcmFjdGVyLCB3ZSBzaW1wbHkgbGV0IHY4IGhhbmRsZSB0aGF0LgoJZnVuY3Rpb24gdXRmMTZFbmQoYnVmKSB7CgkgIHZhciByID0gYnVmICYmIGJ1Zi5sZW5ndGggPyB0aGlzLndyaXRlKGJ1ZikgOiAnJzsKCSAgaWYgKHRoaXMubGFzdE5lZWQpIHsKCSAgICB2YXIgZW5kID0gdGhpcy5sYXN0VG90YWwgLSB0aGlzLmxhc3ROZWVkOwoJICAgIHJldHVybiByICsgdGhpcy5sYXN0Q2hhci50b1N0cmluZygndXRmMTZsZScsIDAsIGVuZCk7CgkgIH0KCSAgcmV0dXJuIHI7Cgl9CgoJZnVuY3Rpb24gYmFzZTY0VGV4dChidWYsIGkpIHsKCSAgdmFyIG4gPSAoYnVmLmxlbmd0aCAtIGkpICUgMzsKCSAgaWYgKG4gPT09IDApIHJldHVybiBidWYudG9TdHJpbmcoJ2Jhc2U2NCcsIGkpOwoJICB0aGlzLmxhc3ROZWVkID0gMyAtIG47CgkgIHRoaXMubGFzdFRvdGFsID0gMzsKCSAgaWYgKG4gPT09IDEpIHsKCSAgICB0aGlzLmxhc3RDaGFyWzBdID0gYnVmW2J1Zi5sZW5ndGggLSAxXTsKCSAgfSBlbHNlIHsKCSAgICB0aGlzLmxhc3RDaGFyWzBdID0gYnVmW2J1Zi5sZW5ndGggLSAyXTsKCSAgICB0aGlzLmxhc3RDaGFyWzFdID0gYnVmW2J1Zi5sZW5ndGggLSAxXTsKCSAgfQoJICByZXR1cm4gYnVmLnRvU3RyaW5nKCdiYXNlNjQnLCBpLCBidWYubGVuZ3RoIC0gbik7Cgl9CgoJZnVuY3Rpb24gYmFzZTY0RW5kKGJ1ZikgewoJICB2YXIgciA9IGJ1ZiAmJiBidWYubGVuZ3RoID8gdGhpcy53cml0ZShidWYpIDogJyc7CgkgIGlmICh0aGlzLmxhc3ROZWVkKSByZXR1cm4gciArIHRoaXMubGFzdENoYXIudG9TdHJpbmcoJ2Jhc2U2NCcsIDAsIDMgLSB0aGlzLmxhc3ROZWVkKTsKCSAgcmV0dXJuIHI7Cgl9CgoJLy8gUGFzcyBieXRlcyBvbiB0aHJvdWdoIGZvciBzaW5nbGUtYnl0ZSBlbmNvZGluZ3MgKGUuZy4gYXNjaWksIGxhdGluMSwgaGV4KQoJZnVuY3Rpb24gc2ltcGxlV3JpdGUoYnVmKSB7CgkgIHJldHVybiBidWYudG9TdHJpbmcodGhpcy5lbmNvZGluZyk7Cgl9CgoJZnVuY3Rpb24gc2ltcGxlRW5kKGJ1ZikgewoJICByZXR1cm4gYnVmICYmIGJ1Zi5sZW5ndGggPyB0aGlzLndyaXRlKGJ1ZikgOiAnJzsKCX0KCi8qKiovIH0sCi8qIDMzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGEgdHJhbnNmb3JtIHN0cmVhbSBpcyBhIHJlYWRhYmxlL3dyaXRhYmxlIHN0cmVhbSB3aGVyZSB5b3UgZG8KCS8vIHNvbWV0aGluZyB3aXRoIHRoZSBkYXRhLiAgU29tZXRpbWVzIGl0J3MgY2FsbGVkIGEgImZpbHRlciIsCgkvLyBidXQgdGhhdCdzIG5vdCBhIGdyZWF0IG5hbWUgZm9yIGl0LCBzaW5jZSB0aGF0IGltcGxpZXMgYSB0aGluZyB3aGVyZQoJLy8gc29tZSBiaXRzIHBhc3MgdGhyb3VnaCwgYW5kIG90aGVycyBhcmUgc2ltcGx5IGlnbm9yZWQuICAoVGhhdCB3b3VsZAoJLy8gYmUgYSB2YWxpZCBleGFtcGxlIG9mIGEgdHJhbnNmb3JtLCBvZiBjb3Vyc2UuKQoJLy8KCS8vIFdoaWxlIHRoZSBvdXRwdXQgaXMgY2F1c2FsbHkgcmVsYXRlZCB0byB0aGUgaW5wdXQsIGl0J3Mgbm90IGEKCS8vIG5lY2Vzc2FyaWx5IHN5bW1ldHJpYyBvciBzeW5jaHJvbm91cyB0cmFuc2Zvcm1hdGlvbi4gIEZvciBleGFtcGxlLAoJLy8gYSB6bGliIHN0cmVhbSBtaWdodCB0YWtlIG11bHRpcGxlIHBsYWluLXRleHQgd3JpdGVzKCksIGFuZCB0aGVuCgkvLyBlbWl0IGEgc2luZ2xlIGNvbXByZXNzZWQgY2h1bmsgc29tZSB0aW1lIGluIHRoZSBmdXR1cmUuCgkvLwoJLy8gSGVyZSdzIGhvdyB0aGlzIHdvcmtzOgoJLy8KCS8vIFRoZSBUcmFuc2Zvcm0gc3RyZWFtIGhhcyBhbGwgdGhlIGFzcGVjdHMgb2YgdGhlIHJlYWRhYmxlIGFuZCB3cml0YWJsZQoJLy8gc3RyZWFtIGNsYXNzZXMuICBXaGVuIHlvdSB3cml0ZShjaHVuayksIHRoYXQgY2FsbHMgX3dyaXRlKGNodW5rLGNiKQoJLy8gaW50ZXJuYWxseSwgYW5kIHJldHVybnMgZmFsc2UgaWYgdGhlcmUncyBhIGxvdCBvZiBwZW5kaW5nIHdyaXRlcwoJLy8gYnVmZmVyZWQgdXAuICBXaGVuIHlvdSBjYWxsIHJlYWQoKSwgdGhhdCBjYWxscyBfcmVhZChuKSB1bnRpbAoJLy8gdGhlcmUncyBlbm91Z2ggcGVuZGluZyByZWFkYWJsZSBkYXRhIGJ1ZmZlcmVkIHVwLgoJLy8KCS8vIEluIGEgdHJhbnNmb3JtIHN0cmVhbSwgdGhlIHdyaXR0ZW4gZGF0YSBpcyBwbGFjZWQgaW4gYSBidWZmZXIuICBXaGVuCgkvLyBfcmVhZChuKSBpcyBjYWxsZWQsIGl0IHRyYW5zZm9ybXMgdGhlIHF1ZXVlZCB1cCBkYXRhLCBjYWxsaW5nIHRoZQoJLy8gYnVmZmVyZWQgX3dyaXRlIGNiJ3MgYXMgaXQgY29uc3VtZXMgY2h1bmtzLiAgSWYgY29uc3VtaW5nIGEgc2luZ2xlCgkvLyB3cml0dGVuIGNodW5rIHdvdWxkIHJlc3VsdCBpbiBtdWx0aXBsZSBvdXRwdXQgY2h1bmtzLCB0aGVuIHRoZSBmaXJzdAoJLy8gb3V0cHV0dGVkIGJpdCBjYWxscyB0aGUgcmVhZGNiLCBhbmQgc3Vic2VxdWVudCBjaHVua3MganVzdCBnbyBpbnRvCgkvLyB0aGUgcmVhZCBidWZmZXIsIGFuZCB3aWxsIGNhdXNlIGl0IHRvIGVtaXQgJ3JlYWRhYmxlJyBpZiBuZWNlc3NhcnkuCgkvLwoJLy8gVGhpcyB3YXksIGJhY2stcHJlc3N1cmUgaXMgYWN0dWFsbHkgZGV0ZXJtaW5lZCBieSB0aGUgcmVhZGluZyBzaWRlLAoJLy8gc2luY2UgX3JlYWQgaGFzIHRvIGJlIGNhbGxlZCB0byBzdGFydCBwcm9jZXNzaW5nIGEgbmV3IGNodW5rLiAgSG93ZXZlciwKCS8vIGEgcGF0aG9sb2dpY2FsIGluZmxhdGUgdHlwZSBvZiB0cmFuc2Zvcm0gY2FuIGNhdXNlIGV4Y2Vzc2l2ZSBidWZmZXJpbmcKCS8vIGhlcmUuICBGb3IgZXhhbXBsZSwgaW1hZ2luZSBhIHN0cmVhbSB3aGVyZSBldmVyeSBieXRlIG9mIGlucHV0IGlzCgkvLyBpbnRlcnByZXRlZCBhcyBhbiBpbnRlZ2VyIGZyb20gMC0yNTUsIGFuZCB0aGVuIHJlc3VsdHMgaW4gdGhhdCBtYW55CgkvLyBieXRlcyBvZiBvdXRwdXQuICBXcml0aW5nIHRoZSA0IGJ5dGVzIHtmZixmZixmZixmZn0gd291bGQgcmVzdWx0IGluCgkvLyAxa2Igb2YgZGF0YSBiZWluZyBvdXRwdXQuICBJbiB0aGlzIGNhc2UsIHlvdSBjb3VsZCB3cml0ZSBhIHZlcnkgc21hbGwKCS8vIGFtb3VudCBvZiBpbnB1dCwgYW5kIGVuZCB1cCB3aXRoIGEgdmVyeSBsYXJnZSBhbW91bnQgb2Ygb3V0cHV0LiAgSW4KCS8vIHN1Y2ggYSBwYXRob2xvZ2ljYWwgaW5mbGF0aW5nIG1lY2hhbmlzbSwgdGhlcmUnZCBiZSBubyB3YXkgdG8gdGVsbAoJLy8gdGhlIHN5c3RlbSB0byBzdG9wIGRvaW5nIHRoZSB0cmFuc2Zvcm0uICBBIHNpbmdsZSA0TUIgd3JpdGUgY291bGQKCS8vIGNhdXNlIHRoZSBzeXN0ZW0gdG8gcnVuIG91dCBvZiBtZW1vcnkuCgkvLwoJLy8gSG93ZXZlciwgZXZlbiBpbiBzdWNoIGEgcGF0aG9sb2dpY2FsIGNhc2UsIG9ubHkgYSBzaW5nbGUgd3JpdHRlbiBjaHVuawoJLy8gd291bGQgYmUgY29uc3VtZWQsIGFuZCB0aGVuIHRoZSByZXN0IHdvdWxkIHdhaXQgKHVuLXRyYW5zZm9ybWVkKSB1bnRpbAoJLy8gdGhlIHJlc3VsdHMgb2YgdGhlIHByZXZpb3VzIHRyYW5zZm9ybWVkIGNodW5rIHdlcmUgY29uc3VtZWQuCgoJJ3VzZSBzdHJpY3QnOwoKCW1vZHVsZS5leHBvcnRzID0gVHJhbnNmb3JtOwoKCXZhciBEdXBsZXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKCXV0aWwuaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXV0aWwuaW5oZXJpdHMoVHJhbnNmb3JtLCBEdXBsZXgpOwoKCWZ1bmN0aW9uIFRyYW5zZm9ybVN0YXRlKHN0cmVhbSkgewoJICB0aGlzLmFmdGVyVHJhbnNmb3JtID0gZnVuY3Rpb24gKGVyLCBkYXRhKSB7CgkgICAgcmV0dXJuIGFmdGVyVHJhbnNmb3JtKHN0cmVhbSwgZXIsIGRhdGEpOwoJICB9OwoKCSAgdGhpcy5uZWVkVHJhbnNmb3JtID0gZmFsc2U7CgkgIHRoaXMudHJhbnNmb3JtaW5nID0gZmFsc2U7CgkgIHRoaXMud3JpdGVjYiA9IG51bGw7CgkgIHRoaXMud3JpdGVjaHVuayA9IG51bGw7CgkgIHRoaXMud3JpdGVlbmNvZGluZyA9IG51bGw7Cgl9CgoJZnVuY3Rpb24gYWZ0ZXJUcmFuc2Zvcm0oc3RyZWFtLCBlciwgZGF0YSkgewoJICB2YXIgdHMgPSBzdHJlYW0uX3RyYW5zZm9ybVN0YXRlOwoJICB0cy50cmFuc2Zvcm1pbmcgPSBmYWxzZTsKCgkgIHZhciBjYiA9IHRzLndyaXRlY2I7CgoJICBpZiAoIWNiKSByZXR1cm4gc3RyZWFtLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdubyB3cml0ZWNiIGluIFRyYW5zZm9ybSBjbGFzcycpKTsKCgkgIHRzLndyaXRlY2h1bmsgPSBudWxsOwoJICB0cy53cml0ZWNiID0gbnVsbDsKCgkgIGlmIChkYXRhICE9PSBudWxsICYmIGRhdGEgIT09IHVuZGVmaW5lZCkgc3RyZWFtLnB1c2goZGF0YSk7CgoJICBjYihlcik7CgoJICB2YXIgcnMgPSBzdHJlYW0uX3JlYWRhYmxlU3RhdGU7CgkgIHJzLnJlYWRpbmcgPSBmYWxzZTsKCSAgaWYgKHJzLm5lZWRSZWFkYWJsZSB8fCBycy5sZW5ndGggPCBycy5oaWdoV2F0ZXJNYXJrKSB7CgkgICAgc3RyZWFtLl9yZWFkKHJzLmhpZ2hXYXRlck1hcmspOwoJICB9Cgl9CgoJZnVuY3Rpb24gVHJhbnNmb3JtKG9wdGlvbnMpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFRyYW5zZm9ybSkpIHJldHVybiBuZXcgVHJhbnNmb3JtKG9wdGlvbnMpOwoKCSAgRHVwbGV4LmNhbGwodGhpcywgb3B0aW9ucyk7CgoJICB0aGlzLl90cmFuc2Zvcm1TdGF0ZSA9IG5ldyBUcmFuc2Zvcm1TdGF0ZSh0aGlzKTsKCgkgIHZhciBzdHJlYW0gPSB0aGlzOwoKCSAgLy8gc3RhcnQgb3V0IGFza2luZyBmb3IgYSByZWFkYWJsZSBldmVudCBvbmNlIGRhdGEgaXMgdHJhbnNmb3JtZWQuCgkgIHRoaXMuX3JlYWRhYmxlU3RhdGUubmVlZFJlYWRhYmxlID0gdHJ1ZTsKCgkgIC8vIHdlIGhhdmUgaW1wbGVtZW50ZWQgdGhlIF9yZWFkIG1ldGhvZCwgYW5kIGRvbmUgdGhlIG90aGVyIHRoaW5ncwoJICAvLyB0aGF0IFJlYWRhYmxlIHdhbnRzIGJlZm9yZSB0aGUgZmlyc3QgX3JlYWQgY2FsbCwgc28gdW5zZXQgdGhlCgkgIC8vIHN5bmMgZ3VhcmQgZmxhZy4KCSAgdGhpcy5fcmVhZGFibGVTdGF0ZS5zeW5jID0gZmFsc2U7CgoJICBpZiAob3B0aW9ucykgewoJICAgIGlmICh0eXBlb2Ygb3B0aW9ucy50cmFuc2Zvcm0gPT09ICdmdW5jdGlvbicpIHRoaXMuX3RyYW5zZm9ybSA9IG9wdGlvbnMudHJhbnNmb3JtOwoKCSAgICBpZiAodHlwZW9mIG9wdGlvbnMuZmx1c2ggPT09ICdmdW5jdGlvbicpIHRoaXMuX2ZsdXNoID0gb3B0aW9ucy5mbHVzaDsKCSAgfQoKCSAgLy8gV2hlbiB0aGUgd3JpdGFibGUgc2lkZSBmaW5pc2hlcywgdGhlbiBmbHVzaCBvdXQgYW55dGhpbmcgcmVtYWluaW5nLgoJICB0aGlzLm9uY2UoJ3ByZWZpbmlzaCcsIGZ1bmN0aW9uICgpIHsKCSAgICBpZiAodHlwZW9mIHRoaXMuX2ZsdXNoID09PSAnZnVuY3Rpb24nKSB0aGlzLl9mbHVzaChmdW5jdGlvbiAoZXIsIGRhdGEpIHsKCSAgICAgIGRvbmUoc3RyZWFtLCBlciwgZGF0YSk7CgkgICAgfSk7ZWxzZSBkb25lKHN0cmVhbSk7CgkgIH0pOwoJfQoKCVRyYW5zZm9ybS5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcpIHsKCSAgdGhpcy5fdHJhbnNmb3JtU3RhdGUubmVlZFRyYW5zZm9ybSA9IGZhbHNlOwoJICByZXR1cm4gRHVwbGV4LnByb3RvdHlwZS5wdXNoLmNhbGwodGhpcywgY2h1bmssIGVuY29kaW5nKTsKCX07CgoJLy8gVGhpcyBpcyB0aGUgcGFydCB3aGVyZSB5b3UgZG8gc3R1ZmYhCgkvLyBvdmVycmlkZSB0aGlzIGZ1bmN0aW9uIGluIGltcGxlbWVudGF0aW9uIGNsYXNzZXMuCgkvLyAnY2h1bmsnIGlzIGFuIGlucHV0IGNodW5rLgoJLy8KCS8vIENhbGwgYHB1c2gobmV3Q2h1bmspYCB0byBwYXNzIGFsb25nIHRyYW5zZm9ybWVkIG91dHB1dAoJLy8gdG8gdGhlIHJlYWRhYmxlIHNpZGUuICBZb3UgbWF5IGNhbGwgJ3B1c2gnIHplcm8gb3IgbW9yZSB0aW1lcy4KCS8vCgkvLyBDYWxsIGBjYihlcnIpYCB3aGVuIHlvdSBhcmUgZG9uZSB3aXRoIHRoaXMgY2h1bmsuICBJZiB5b3UgcGFzcwoJLy8gYW4gZXJyb3IsIHRoZW4gdGhhdCdsbCBwdXQgdGhlIGh1cnQgb24gdGhlIHdob2xlIG9wZXJhdGlvbi4gIElmIHlvdQoJLy8gbmV2ZXIgY2FsbCBjYigpLCB0aGVuIHlvdSdsbCBuZXZlciBnZXQgYW5vdGhlciBjaHVuay4KCVRyYW5zZm9ybS5wcm90b3R5cGUuX3RyYW5zZm9ybSA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIHRocm93IG5ldyBFcnJvcignX3RyYW5zZm9ybSgpIGlzIG5vdCBpbXBsZW1lbnRlZCcpOwoJfTsKCglUcmFuc2Zvcm0ucHJvdG90eXBlLl93cml0ZSA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIHZhciB0cyA9IHRoaXMuX3RyYW5zZm9ybVN0YXRlOwoJICB0cy53cml0ZWNiID0gY2I7CgkgIHRzLndyaXRlY2h1bmsgPSBjaHVuazsKCSAgdHMud3JpdGVlbmNvZGluZyA9IGVuY29kaW5nOwoJICBpZiAoIXRzLnRyYW5zZm9ybWluZykgewoJICAgIHZhciBycyA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgkgICAgaWYgKHRzLm5lZWRUcmFuc2Zvcm0gfHwgcnMubmVlZFJlYWRhYmxlIHx8IHJzLmxlbmd0aCA8IHJzLmhpZ2hXYXRlck1hcmspIHRoaXMuX3JlYWQocnMuaGlnaFdhdGVyTWFyayk7CgkgIH0KCX07CgoJLy8gRG9lc24ndCBtYXR0ZXIgd2hhdCB0aGUgYXJncyBhcmUgaGVyZS4KCS8vIF90cmFuc2Zvcm0gZG9lcyBhbGwgdGhlIHdvcmsuCgkvLyBUaGF0IHdlIGdvdCBoZXJlIG1lYW5zIHRoYXQgdGhlIHJlYWRhYmxlIHNpZGUgd2FudHMgbW9yZSBkYXRhLgoJVHJhbnNmb3JtLnByb3RvdHlwZS5fcmVhZCA9IGZ1bmN0aW9uIChuKSB7CgkgIHZhciB0cyA9IHRoaXMuX3RyYW5zZm9ybVN0YXRlOwoKCSAgaWYgKHRzLndyaXRlY2h1bmsgIT09IG51bGwgJiYgdHMud3JpdGVjYiAmJiAhdHMudHJhbnNmb3JtaW5nKSB7CgkgICAgdHMudHJhbnNmb3JtaW5nID0gdHJ1ZTsKCSAgICB0aGlzLl90cmFuc2Zvcm0odHMud3JpdGVjaHVuaywgdHMud3JpdGVlbmNvZGluZywgdHMuYWZ0ZXJUcmFuc2Zvcm0pOwoJICB9IGVsc2UgewoJICAgIC8vIG1hcmsgdGhhdCB3ZSBuZWVkIGEgdHJhbnNmb3JtLCBzbyB0aGF0IGFueSBkYXRhIHRoYXQgY29tZXMgaW4KCSAgICAvLyB3aWxsIGdldCBwcm9jZXNzZWQsIG5vdyB0aGF0IHdlJ3ZlIGFza2VkIGZvciBpdC4KCSAgICB0cy5uZWVkVHJhbnNmb3JtID0gdHJ1ZTsKCSAgfQoJfTsKCglmdW5jdGlvbiBkb25lKHN0cmVhbSwgZXIsIGRhdGEpIHsKCSAgaWYgKGVyKSByZXR1cm4gc3RyZWFtLmVtaXQoJ2Vycm9yJywgZXIpOwoKCSAgaWYgKGRhdGEgIT09IG51bGwgJiYgZGF0YSAhPT0gdW5kZWZpbmVkKSBzdHJlYW0ucHVzaChkYXRhKTsKCgkgIC8vIGlmIHRoZXJlJ3Mgbm90aGluZyBpbiB0aGUgd3JpdGUgYnVmZmVyLCB0aGVuIHRoYXQgbWVhbnMKCSAgLy8gdGhhdCBub3RoaW5nIG1vcmUgd2lsbCBldmVyIGJlIHByb3ZpZGVkCgkgIHZhciB3cyA9IHN0cmVhbS5fd3JpdGFibGVTdGF0ZTsKCSAgdmFyIHRzID0gc3RyZWFtLl90cmFuc2Zvcm1TdGF0ZTsKCgkgIGlmICh3cy5sZW5ndGgpIHRocm93IG5ldyBFcnJvcignQ2FsbGluZyB0cmFuc2Zvcm0gZG9uZSB3aGVuIHdzLmxlbmd0aCAhPSAwJyk7CgoJICBpZiAodHMudHJhbnNmb3JtaW5nKSB0aHJvdyBuZXcgRXJyb3IoJ0NhbGxpbmcgdHJhbnNmb3JtIGRvbmUgd2hlbiBzdGlsbCB0cmFuc2Zvcm1pbmcnKTsKCgkgIHJldHVybiBzdHJlYW0ucHVzaChudWxsKTsKCX0KCi8qKiovIH0sCi8qIDM0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGEgcGFzc3Rocm91Z2ggc3RyZWFtLgoJLy8gYmFzaWNhbGx5IGp1c3QgdGhlIG1vc3QgbWluaW1hbCBzb3J0IG9mIFRyYW5zZm9ybSBzdHJlYW0uCgkvLyBFdmVyeSB3cml0dGVuIGNodW5rIGdldHMgb3V0cHV0IGFzLWlzLgoKCSd1c2Ugc3RyaWN0JzsKCgltb2R1bGUuZXhwb3J0cyA9IFBhc3NUaHJvdWdoOwoKCXZhciBUcmFuc2Zvcm0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKCXV0aWwuaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXV0aWwuaW5oZXJpdHMoUGFzc1Rocm91Z2gsIFRyYW5zZm9ybSk7CgoJZnVuY3Rpb24gUGFzc1Rocm91Z2gob3B0aW9ucykgewoJICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUGFzc1Rocm91Z2gpKSByZXR1cm4gbmV3IFBhc3NUaHJvdWdoKG9wdGlvbnMpOwoKCSAgVHJhbnNmb3JtLmNhbGwodGhpcywgb3B0aW9ucyk7Cgl9CgoJUGFzc1Rocm91Z2gucHJvdG90eXBlLl90cmFuc2Zvcm0gPSBmdW5jdGlvbiAoY2h1bmssIGVuY29kaW5nLCBjYikgewoJICBjYihudWxsLCBjaHVuayk7Cgl9OwoKLyoqKi8gfSwKLyogMzUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIEJ1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjIpLkJ1ZmZlcgoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGJ1ZikgewoJCS8vIElmIHRoZSBidWZmZXIgaXMgYmFja2VkIGJ5IGEgVWludDhBcnJheSwgYSBmYXN0ZXIgdmVyc2lvbiB3aWxsIHdvcmsKCQlpZiAoYnVmIGluc3RhbmNlb2YgVWludDhBcnJheSkgewoJCQkvLyBJZiB0aGUgYnVmZmVyIGlzbid0IGEgc3ViYXJyYXksIHJldHVybiB0aGUgdW5kZXJseWluZyBBcnJheUJ1ZmZlcgoJCQlpZiAoYnVmLmJ5dGVPZmZzZXQgPT09IDAgJiYgYnVmLmJ5dGVMZW5ndGggPT09IGJ1Zi5idWZmZXIuYnl0ZUxlbmd0aCkgewoJCQkJcmV0dXJuIGJ1Zi5idWZmZXIKCQkJfSBlbHNlIGlmICh0eXBlb2YgYnVmLmJ1ZmZlci5zbGljZSA9PT0gJ2Z1bmN0aW9uJykgewoJCQkJLy8gT3RoZXJ3aXNlIHdlIG5lZWQgdG8gZ2V0IGEgcHJvcGVyIGNvcHkKCQkJCXJldHVybiBidWYuYnVmZmVyLnNsaWNlKGJ1Zi5ieXRlT2Zmc2V0LCBidWYuYnl0ZU9mZnNldCArIGJ1Zi5ieXRlTGVuZ3RoKQoJCQl9CgkJfQoKCQlpZiAoQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHsKCQkJLy8gVGhpcyBpcyB0aGUgc2xvdyB2ZXJzaW9uIHRoYXQgd2lsbCB3b3JrIHdpdGggYW55IEJ1ZmZlcgoJCQkvLyBpbXBsZW1lbnRhdGlvbiAoZXZlbiBpbiBvbGQgYnJvd3NlcnMpCgkJCXZhciBhcnJheUNvcHkgPSBuZXcgVWludDhBcnJheShidWYubGVuZ3RoKQoJCQl2YXIgbGVuID0gYnVmLmxlbmd0aAoJCQlmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CgkJCQlhcnJheUNvcHlbaV0gPSBidWZbaV0KCQkJfQoJCQlyZXR1cm4gYXJyYXlDb3B5LmJ1ZmZlcgoJCX0gZWxzZSB7CgkJCXRocm93IG5ldyBFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpCgkJfQoJfQoKCi8qKiovIH0sCi8qIDM2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZXh0ZW5kCgoJdmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKCglmdW5jdGlvbiBleHRlbmQoKSB7CgkgICAgdmFyIHRhcmdldCA9IHt9CgoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0KCgkgICAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsKCSAgICAgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgewoJICAgICAgICAgICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCgkgICAgcmV0dXJuIHRhcmdldAoJfQoKCi8qKiovIH0sCi8qIDM3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gewoJICAiMTAwIjogIkNvbnRpbnVlIiwKCSAgIjEwMSI6ICJTd2l0Y2hpbmcgUHJvdG9jb2xzIiwKCSAgIjEwMiI6ICJQcm9jZXNzaW5nIiwKCSAgIjIwMCI6ICJPSyIsCgkgICIyMDEiOiAiQ3JlYXRlZCIsCgkgICIyMDIiOiAiQWNjZXB0ZWQiLAoJICAiMjAzIjogIk5vbi1BdXRob3JpdGF0aXZlIEluZm9ybWF0aW9uIiwKCSAgIjIwNCI6ICJObyBDb250ZW50IiwKCSAgIjIwNSI6ICJSZXNldCBDb250ZW50IiwKCSAgIjIwNiI6ICJQYXJ0aWFsIENvbnRlbnQiLAoJICAiMjA3IjogIk11bHRpLVN0YXR1cyIsCgkgICIyMDgiOiAiQWxyZWFkeSBSZXBvcnRlZCIsCgkgICIyMjYiOiAiSU0gVXNlZCIsCgkgICIzMDAiOiAiTXVsdGlwbGUgQ2hvaWNlcyIsCgkgICIzMDEiOiAiTW92ZWQgUGVybWFuZW50bHkiLAoJICAiMzAyIjogIkZvdW5kIiwKCSAgIjMwMyI6ICJTZWUgT3RoZXIiLAoJICAiMzA0IjogIk5vdCBNb2RpZmllZCIsCgkgICIzMDUiOiAiVXNlIFByb3h5IiwKCSAgIjMwNyI6ICJUZW1wb3JhcnkgUmVkaXJlY3QiLAoJICAiMzA4IjogIlBlcm1hbmVudCBSZWRpcmVjdCIsCgkgICI0MDAiOiAiQmFkIFJlcXVlc3QiLAoJICAiNDAxIjogIlVuYXV0aG9yaXplZCIsCgkgICI0MDIiOiAiUGF5bWVudCBSZXF1aXJlZCIsCgkgICI0MDMiOiAiRm9yYmlkZGVuIiwKCSAgIjQwNCI6ICJOb3QgRm91bmQiLAoJICAiNDA1IjogIk1ldGhvZCBOb3QgQWxsb3dlZCIsCgkgICI0MDYiOiAiTm90IEFjY2VwdGFibGUiLAoJICAiNDA3IjogIlByb3h5IEF1dGhlbnRpY2F0aW9uIFJlcXVpcmVkIiwKCSAgIjQwOCI6ICJSZXF1ZXN0IFRpbWVvdXQiLAoJICAiNDA5IjogIkNvbmZsaWN0IiwKCSAgIjQxMCI6ICJHb25lIiwKCSAgIjQxMSI6ICJMZW5ndGggUmVxdWlyZWQiLAoJICAiNDEyIjogIlByZWNvbmRpdGlvbiBGYWlsZWQiLAoJICAiNDEzIjogIlBheWxvYWQgVG9vIExhcmdlIiwKCSAgIjQxNCI6ICJVUkkgVG9vIExvbmciLAoJICAiNDE1IjogIlVuc3VwcG9ydGVkIE1lZGlhIFR5cGUiLAoJICAiNDE2IjogIlJhbmdlIE5vdCBTYXRpc2ZpYWJsZSIsCgkgICI0MTciOiAiRXhwZWN0YXRpb24gRmFpbGVkIiwKCSAgIjQxOCI6ICJJJ20gYSB0ZWFwb3QiLAoJICAiNDIxIjogIk1pc2RpcmVjdGVkIFJlcXVlc3QiLAoJICAiNDIyIjogIlVucHJvY2Vzc2FibGUgRW50aXR5IiwKCSAgIjQyMyI6ICJMb2NrZWQiLAoJICAiNDI0IjogIkZhaWxlZCBEZXBlbmRlbmN5IiwKCSAgIjQyNSI6ICJVbm9yZGVyZWQgQ29sbGVjdGlvbiIsCgkgICI0MjYiOiAiVXBncmFkZSBSZXF1aXJlZCIsCgkgICI0MjgiOiAiUHJlY29uZGl0aW9uIFJlcXVpcmVkIiwKCSAgIjQyOSI6ICJUb28gTWFueSBSZXF1ZXN0cyIsCgkgICI0MzEiOiAiUmVxdWVzdCBIZWFkZXIgRmllbGRzIFRvbyBMYXJnZSIsCgkgICI0NTEiOiAiVW5hdmFpbGFibGUgRm9yIExlZ2FsIFJlYXNvbnMiLAoJICAiNTAwIjogIkludGVybmFsIFNlcnZlciBFcnJvciIsCgkgICI1MDEiOiAiTm90IEltcGxlbWVudGVkIiwKCSAgIjUwMiI6ICJCYWQgR2F0ZXdheSIsCgkgICI1MDMiOiAiU2VydmljZSBVbmF2YWlsYWJsZSIsCgkgICI1MDQiOiAiR2F0ZXdheSBUaW1lb3V0IiwKCSAgIjUwNSI6ICJIVFRQIFZlcnNpb24gTm90IFN1cHBvcnRlZCIsCgkgICI1MDYiOiAiVmFyaWFudCBBbHNvIE5lZ290aWF0ZXMiLAoJICAiNTA3IjogIkluc3VmZmljaWVudCBTdG9yYWdlIiwKCSAgIjUwOCI6ICJMb29wIERldGVjdGVkIiwKCSAgIjUwOSI6ICJCYW5kd2lkdGggTGltaXQgRXhjZWVkZWQiLAoJICAiNTEwIjogIk5vdCBFeHRlbmRlZCIsCgkgICI1MTEiOiAiTmV0d29yayBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCIKCX0KCgovKioqLyB9LAovKiAzOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCSd1c2Ugc3RyaWN0JzsKCgl2YXIgcHVueWNvZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KTsKCXZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSk7CgoJZXhwb3J0cy5wYXJzZSA9IHVybFBhcnNlOwoJZXhwb3J0cy5yZXNvbHZlID0gdXJsUmVzb2x2ZTsKCWV4cG9ydHMucmVzb2x2ZU9iamVjdCA9IHVybFJlc29sdmVPYmplY3Q7CglleHBvcnRzLmZvcm1hdCA9IHVybEZvcm1hdDsKCglleHBvcnRzLlVybCA9IFVybDsKCglmdW5jdGlvbiBVcmwoKSB7CgkgIHRoaXMucHJvdG9jb2wgPSBudWxsOwoJICB0aGlzLnNsYXNoZXMgPSBudWxsOwoJICB0aGlzLmF1dGggPSBudWxsOwoJICB0aGlzLmhvc3QgPSBudWxsOwoJICB0aGlzLnBvcnQgPSBudWxsOwoJICB0aGlzLmhvc3RuYW1lID0gbnVsbDsKCSAgdGhpcy5oYXNoID0gbnVsbDsKCSAgdGhpcy5zZWFyY2ggPSBudWxsOwoJICB0aGlzLnF1ZXJ5ID0gbnVsbDsKCSAgdGhpcy5wYXRobmFtZSA9IG51bGw7CgkgIHRoaXMucGF0aCA9IG51bGw7CgkgIHRoaXMuaHJlZiA9IG51bGw7Cgl9CgoJLy8gUmVmZXJlbmNlOiBSRkMgMzk4NiwgUkZDIDE4MDgsIFJGQyAyMzk2CgoJLy8gZGVmaW5lIHRoZXNlIGhlcmUgc28gYXQgbGVhc3QgdGhleSBvbmx5IGhhdmUgdG8gYmUKCS8vIGNvbXBpbGVkIG9uY2Ugb24gdGhlIGZpcnN0IG1vZHVsZSBsb2FkLgoJdmFyIHByb3RvY29sUGF0dGVybiA9IC9eKFthLXowLTkuKy1dKzopL2ksCgkgICAgcG9ydFBhdHRlcm4gPSAvOlswLTldKiQvLAoKCSAgICAvLyBTcGVjaWFsIGNhc2UgZm9yIGEgc2ltcGxlIHBhdGggVVJMCgkgICAgc2ltcGxlUGF0aFBhdHRlcm4gPSAvXihcL1wvPyg/IVwvKVteXD9cc10qKShcP1teXHNdKik/JC8sCgoJICAgIC8vIFJGQyAyMzk2OiBjaGFyYWN0ZXJzIHJlc2VydmVkIGZvciBkZWxpbWl0aW5nIFVSTHMuCgkgICAgLy8gV2UgYWN0dWFsbHkganVzdCBhdXRvLWVzY2FwZSB0aGVzZS4KCSAgICBkZWxpbXMgPSBbJzwnLCAnPicsICciJywgJ2AnLCAnICcsICdccicsICdcbicsICdcdCddLAoKCSAgICAvLyBSRkMgMjM5NjogY2hhcmFjdGVycyBub3QgYWxsb3dlZCBmb3IgdmFyaW91cyByZWFzb25zLgoJICAgIHVud2lzZSA9IFsneycsICd9JywgJ3wnLCAnXFwnLCAnXicsICdgJ10uY29uY2F0KGRlbGltcyksCgoJICAgIC8vIEFsbG93ZWQgYnkgUkZDcywgYnV0IGNhdXNlIG9mIFhTUyBhdHRhY2tzLiAgQWx3YXlzIGVzY2FwZSB0aGVzZS4KCSAgICBhdXRvRXNjYXBlID0gWydcJyddLmNvbmNhdCh1bndpc2UpLAoJICAgIC8vIENoYXJhY3RlcnMgdGhhdCBhcmUgbmV2ZXIgZXZlciBhbGxvd2VkIGluIGEgaG9zdG5hbWUuCgkgICAgLy8gTm90ZSB0aGF0IGFueSBpbnZhbGlkIGNoYXJzIGFyZSBhbHNvIGhhbmRsZWQsIGJ1dCB0aGVzZQoJICAgIC8vIGFyZSB0aGUgb25lcyB0aGF0IGFyZSAqZXhwZWN0ZWQqIHRvIGJlIHNlZW4sIHNvIHdlIGZhc3QtcGF0aAoJICAgIC8vIHRoZW0uCgkgICAgbm9uSG9zdENoYXJzID0gWyclJywgJy8nLCAnPycsICc7JywgJyMnXS5jb25jYXQoYXV0b0VzY2FwZSksCgkgICAgaG9zdEVuZGluZ0NoYXJzID0gWycvJywgJz8nLCAnIyddLAoJICAgIGhvc3RuYW1lTWF4TGVuID0gMjU1LAoJICAgIGhvc3RuYW1lUGFydFBhdHRlcm4gPSAvXlsrYS16MC05QS1aXy1dezAsNjN9JC8sCgkgICAgaG9zdG5hbWVQYXJ0U3RhcnQgPSAvXihbK2EtejAtOUEtWl8tXXswLDYzfSkoLiopJC8sCgkgICAgLy8gcHJvdG9jb2xzIHRoYXQgY2FuIGFsbG93ICJ1bnNhZmUiIGFuZCAidW53aXNlIiBjaGFycy4KCSAgICB1bnNhZmVQcm90b2NvbCA9IHsKCSAgICAgICdqYXZhc2NyaXB0JzogdHJ1ZSwKCSAgICAgICdqYXZhc2NyaXB0Oic6IHRydWUKCSAgICB9LAoJICAgIC8vIHByb3RvY29scyB0aGF0IG5ldmVyIGhhdmUgYSBob3N0bmFtZS4KCSAgICBob3N0bGVzc1Byb3RvY29sID0gewoJICAgICAgJ2phdmFzY3JpcHQnOiB0cnVlLAoJICAgICAgJ2phdmFzY3JpcHQ6JzogdHJ1ZQoJICAgIH0sCgkgICAgLy8gcHJvdG9jb2xzIHRoYXQgYWx3YXlzIGNvbnRhaW4gYSAvLyBiaXQuCgkgICAgc2xhc2hlZFByb3RvY29sID0gewoJICAgICAgJ2h0dHAnOiB0cnVlLAoJICAgICAgJ2h0dHBzJzogdHJ1ZSwKCSAgICAgICdmdHAnOiB0cnVlLAoJICAgICAgJ2dvcGhlcic6IHRydWUsCgkgICAgICAnZmlsZSc6IHRydWUsCgkgICAgICAnaHR0cDonOiB0cnVlLAoJICAgICAgJ2h0dHBzOic6IHRydWUsCgkgICAgICAnZnRwOic6IHRydWUsCgkgICAgICAnZ29waGVyOic6IHRydWUsCgkgICAgICAnZmlsZTonOiB0cnVlCgkgICAgfSwKCSAgICBxdWVyeXN0cmluZyA9IF9fd2VicGFja19yZXF1aXJlX18oNDIpOwoKCWZ1bmN0aW9uIHVybFBhcnNlKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpIHsKCSAgaWYgKHVybCAmJiB1dGlsLmlzT2JqZWN0KHVybCkgJiYgdXJsIGluc3RhbmNlb2YgVXJsKSByZXR1cm4gdXJsOwoKCSAgdmFyIHUgPSBuZXcgVXJsOwoJICB1LnBhcnNlKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpOwoJICByZXR1cm4gdTsKCX0KCglVcmwucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24odXJsLCBwYXJzZVF1ZXJ5U3RyaW5nLCBzbGFzaGVzRGVub3RlSG9zdCkgewoJICBpZiAoIXV0aWwuaXNTdHJpbmcodXJsKSkgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlBhcmFtZXRlciAndXJsJyBtdXN0IGJlIGEgc3RyaW5nLCBub3QgIiArIHR5cGVvZiB1cmwpOwoJICB9CgoJICAvLyBDb3B5IGNocm9tZSwgSUUsIG9wZXJhIGJhY2tzbGFzaC1oYW5kbGluZyBiZWhhdmlvci4KCSAgLy8gQmFjayBzbGFzaGVzIGJlZm9yZSB0aGUgcXVlcnkgc3RyaW5nIGdldCBjb252ZXJ0ZWQgdG8gZm9yd2FyZCBzbGFzaGVzCgkgIC8vIFNlZTogaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTI1OTE2CgkgIHZhciBxdWVyeUluZGV4ID0gdXJsLmluZGV4T2YoJz8nKSwKCSAgICAgIHNwbGl0dGVyID0KCSAgICAgICAgICAocXVlcnlJbmRleCAhPT0gLTEgJiYgcXVlcnlJbmRleCA8IHVybC5pbmRleE9mKCcjJykpID8gJz8nIDogJyMnLAoJICAgICAgdVNwbGl0ID0gdXJsLnNwbGl0KHNwbGl0dGVyKSwKCSAgICAgIHNsYXNoUmVnZXggPSAvXFwvZzsKCSAgdVNwbGl0WzBdID0gdVNwbGl0WzBdLnJlcGxhY2Uoc2xhc2hSZWdleCwgJy8nKTsKCSAgdXJsID0gdVNwbGl0LmpvaW4oc3BsaXR0ZXIpOwoKCSAgdmFyIHJlc3QgPSB1cmw7CgoJICAvLyB0cmltIGJlZm9yZSBwcm9jZWVkaW5nLgoJICAvLyBUaGlzIGlzIHRvIHN1cHBvcnQgcGFyc2Ugc3R1ZmYgbGlrZSAiICBodHRwOi8vZm9vLmNvbSAgXG4iCgkgIHJlc3QgPSByZXN0LnRyaW0oKTsKCgkgIGlmICghc2xhc2hlc0Rlbm90ZUhvc3QgJiYgdXJsLnNwbGl0KCcjJykubGVuZ3RoID09PSAxKSB7CgkgICAgLy8gVHJ5IGZhc3QgcGF0aCByZWdleHAKCSAgICB2YXIgc2ltcGxlUGF0aCA9IHNpbXBsZVBhdGhQYXR0ZXJuLmV4ZWMocmVzdCk7CgkgICAgaWYgKHNpbXBsZVBhdGgpIHsKCSAgICAgIHRoaXMucGF0aCA9IHJlc3Q7CgkgICAgICB0aGlzLmhyZWYgPSByZXN0OwoJICAgICAgdGhpcy5wYXRobmFtZSA9IHNpbXBsZVBhdGhbMV07CgkgICAgICBpZiAoc2ltcGxlUGF0aFsyXSkgewoJICAgICAgICB0aGlzLnNlYXJjaCA9IHNpbXBsZVBhdGhbMl07CgkgICAgICAgIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7CgkgICAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5c3RyaW5nLnBhcnNlKHRoaXMuc2VhcmNoLnN1YnN0cigxKSk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgdGhpcy5xdWVyeSA9IHRoaXMuc2VhcmNoLnN1YnN0cigxKTsKCSAgICAgICAgfQoJICAgICAgfSBlbHNlIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7CgkgICAgICAgIHRoaXMuc2VhcmNoID0gJyc7CgkgICAgICAgIHRoaXMucXVlcnkgPSB7fTsKCSAgICAgIH0KCSAgICAgIHJldHVybiB0aGlzOwoJICAgIH0KCSAgfQoKCSAgdmFyIHByb3RvID0gcHJvdG9jb2xQYXR0ZXJuLmV4ZWMocmVzdCk7CgkgIGlmIChwcm90bykgewoJICAgIHByb3RvID0gcHJvdG9bMF07CgkgICAgdmFyIGxvd2VyUHJvdG8gPSBwcm90by50b0xvd2VyQ2FzZSgpOwoJICAgIHRoaXMucHJvdG9jb2wgPSBsb3dlclByb3RvOwoJICAgIHJlc3QgPSByZXN0LnN1YnN0cihwcm90by5sZW5ndGgpOwoJICB9CgoJICAvLyBmaWd1cmUgb3V0IGlmIGl0J3MgZ290IGEgaG9zdAoJICAvLyB1c2VyQHNlcnZlciBpcyAqYWx3YXlzKiBpbnRlcnByZXRlZCBhcyBhIGhvc3RuYW1lLCBhbmQgdXJsCgkgIC8vIHJlc29sdXRpb24gd2lsbCB0cmVhdCAvL2Zvby9iYXIgYXMgaG9zdD1mb28scGF0aD1iYXIgYmVjYXVzZSB0aGF0J3MKCSAgLy8gaG93IHRoZSBicm93c2VyIHJlc29sdmVzIHJlbGF0aXZlIFVSTHMuCgkgIGlmIChzbGFzaGVzRGVub3RlSG9zdCB8fCBwcm90byB8fCByZXN0Lm1hdGNoKC9eXC9cL1teQFwvXStAW15AXC9dKy8pKSB7CgkgICAgdmFyIHNsYXNoZXMgPSByZXN0LnN1YnN0cigwLCAyKSA9PT0gJy8vJzsKCSAgICBpZiAoc2xhc2hlcyAmJiAhKHByb3RvICYmIGhvc3RsZXNzUHJvdG9jb2xbcHJvdG9dKSkgewoJICAgICAgcmVzdCA9IHJlc3Quc3Vic3RyKDIpOwoJICAgICAgdGhpcy5zbGFzaGVzID0gdHJ1ZTsKCSAgICB9CgkgIH0KCgkgIGlmICghaG9zdGxlc3NQcm90b2NvbFtwcm90b10gJiYKCSAgICAgIChzbGFzaGVzIHx8IChwcm90byAmJiAhc2xhc2hlZFByb3RvY29sW3Byb3RvXSkpKSB7CgoJICAgIC8vIHRoZXJlJ3MgYSBob3N0bmFtZS4KCSAgICAvLyB0aGUgZmlyc3QgaW5zdGFuY2Ugb2YgLywgPywgOywgb3IgIyBlbmRzIHRoZSBob3N0LgoJICAgIC8vCgkgICAgLy8gSWYgdGhlcmUgaXMgYW4gQCBpbiB0aGUgaG9zdG5hbWUsIHRoZW4gbm9uLWhvc3QgY2hhcnMgKmFyZSogYWxsb3dlZAoJICAgIC8vIHRvIHRoZSBsZWZ0IG9mIHRoZSBsYXN0IEAgc2lnbiwgdW5sZXNzIHNvbWUgaG9zdC1lbmRpbmcgY2hhcmFjdGVyCgkgICAgLy8gY29tZXMgKmJlZm9yZSogdGhlIEAtc2lnbi4KCSAgICAvLyBVUkxzIGFyZSBvYm5veGlvdXMuCgkgICAgLy8KCSAgICAvLyBleDoKCSAgICAvLyBodHRwOi8vYUBiQGMvID0+IHVzZXI6YUBiIGhvc3Q6YwoJICAgIC8vIGh0dHA6Ly9hQGI/QGMgPT4gdXNlcjphIGhvc3Q6YyBwYXRoOi8/QGMKCgkgICAgLy8gdjAuMTIgVE9ETyhpc2FhY3MpOiBUaGlzIGlzIG5vdCBxdWl0ZSBob3cgQ2hyb21lIGRvZXMgdGhpbmdzLgoJICAgIC8vIFJldmlldyBvdXIgdGVzdCBjYXNlIGFnYWluc3QgYnJvd3NlcnMgbW9yZSBjb21wcmVoZW5zaXZlbHkuCgoJICAgIC8vIGZpbmQgdGhlIGZpcnN0IGluc3RhbmNlIG9mIGFueSBob3N0RW5kaW5nQ2hhcnMKCSAgICB2YXIgaG9zdEVuZCA9IC0xOwoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaG9zdEVuZGluZ0NoYXJzLmxlbmd0aDsgaSsrKSB7CgkgICAgICB2YXIgaGVjID0gcmVzdC5pbmRleE9mKGhvc3RFbmRpbmdDaGFyc1tpXSk7CgkgICAgICBpZiAoaGVjICE9PSAtMSAmJiAoaG9zdEVuZCA9PT0gLTEgfHwgaGVjIDwgaG9zdEVuZCkpCgkgICAgICAgIGhvc3RFbmQgPSBoZWM7CgkgICAgfQoKCSAgICAvLyBhdCB0aGlzIHBvaW50LCBlaXRoZXIgd2UgaGF2ZSBhbiBleHBsaWNpdCBwb2ludCB3aGVyZSB0aGUKCSAgICAvLyBhdXRoIHBvcnRpb24gY2Fubm90IGdvIHBhc3QsIG9yIHRoZSBsYXN0IEAgY2hhciBpcyB0aGUgZGVjaWRlci4KCSAgICB2YXIgYXV0aCwgYXRTaWduOwoJICAgIGlmIChob3N0RW5kID09PSAtMSkgewoJICAgICAgLy8gYXRTaWduIGNhbiBiZSBhbnl3aGVyZS4KCSAgICAgIGF0U2lnbiA9IHJlc3QubGFzdEluZGV4T2YoJ0AnKTsKCSAgICB9IGVsc2UgewoJICAgICAgLy8gYXRTaWduIG11c3QgYmUgaW4gYXV0aCBwb3J0aW9uLgoJICAgICAgLy8gaHR0cDovL2FAYi9jQGQgPT4gaG9zdDpiIGF1dGg6YSBwYXRoOi9jQGQKCSAgICAgIGF0U2lnbiA9IHJlc3QubGFzdEluZGV4T2YoJ0AnLCBob3N0RW5kKTsKCSAgICB9CgoJICAgIC8vIE5vdyB3ZSBoYXZlIGEgcG9ydGlvbiB3aGljaCBpcyBkZWZpbml0ZWx5IHRoZSBhdXRoLgoJICAgIC8vIFB1bGwgdGhhdCBvZmYuCgkgICAgaWYgKGF0U2lnbiAhPT0gLTEpIHsKCSAgICAgIGF1dGggPSByZXN0LnNsaWNlKDAsIGF0U2lnbik7CgkgICAgICByZXN0ID0gcmVzdC5zbGljZShhdFNpZ24gKyAxKTsKCSAgICAgIHRoaXMuYXV0aCA9IGRlY29kZVVSSUNvbXBvbmVudChhdXRoKTsKCSAgICB9CgoJICAgIC8vIHRoZSBob3N0IGlzIHRoZSByZW1haW5pbmcgdG8gdGhlIGxlZnQgb2YgdGhlIGZpcnN0IG5vbi1ob3N0IGNoYXIKCSAgICBob3N0RW5kID0gLTE7CgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub25Ib3N0Q2hhcnMubGVuZ3RoOyBpKyspIHsKCSAgICAgIHZhciBoZWMgPSByZXN0LmluZGV4T2Yobm9uSG9zdENoYXJzW2ldKTsKCSAgICAgIGlmIChoZWMgIT09IC0xICYmIChob3N0RW5kID09PSAtMSB8fCBoZWMgPCBob3N0RW5kKSkKCSAgICAgICAgaG9zdEVuZCA9IGhlYzsKCSAgICB9CgkgICAgLy8gaWYgd2Ugc3RpbGwgaGF2ZSBub3QgaGl0IGl0LCB0aGVuIHRoZSBlbnRpcmUgdGhpbmcgaXMgYSBob3N0LgoJICAgIGlmIChob3N0RW5kID09PSAtMSkKCSAgICAgIGhvc3RFbmQgPSByZXN0Lmxlbmd0aDsKCgkgICAgdGhpcy5ob3N0ID0gcmVzdC5zbGljZSgwLCBob3N0RW5kKTsKCSAgICByZXN0ID0gcmVzdC5zbGljZShob3N0RW5kKTsKCgkgICAgLy8gcHVsbCBvdXQgcG9ydC4KCSAgICB0aGlzLnBhcnNlSG9zdCgpOwoKCSAgICAvLyB3ZSd2ZSBpbmRpY2F0ZWQgdGhhdCB0aGVyZSBpcyBhIGhvc3RuYW1lLAoJICAgIC8vIHNvIGV2ZW4gaWYgaXQncyBlbXB0eSwgaXQgaGFzIHRvIGJlIHByZXNlbnQuCgkgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUgfHwgJyc7CgoJICAgIC8vIGlmIGhvc3RuYW1lIGJlZ2lucyB3aXRoIFsgYW5kIGVuZHMgd2l0aCBdCgkgICAgLy8gYXNzdW1lIHRoYXQgaXQncyBhbiBJUHY2IGFkZHJlc3MuCgkgICAgdmFyIGlwdjZIb3N0bmFtZSA9IHRoaXMuaG9zdG5hbWVbMF0gPT09ICdbJyAmJgoJICAgICAgICB0aGlzLmhvc3RuYW1lW3RoaXMuaG9zdG5hbWUubGVuZ3RoIC0gMV0gPT09ICddJzsKCgkgICAgLy8gdmFsaWRhdGUgYSBsaXR0bGUuCgkgICAgaWYgKCFpcHY2SG9zdG5hbWUpIHsKCSAgICAgIHZhciBob3N0cGFydHMgPSB0aGlzLmhvc3RuYW1lLnNwbGl0KC9cLi8pOwoJICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBob3N0cGFydHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgICAgIHZhciBwYXJ0ID0gaG9zdHBhcnRzW2ldOwoJICAgICAgICBpZiAoIXBhcnQpIGNvbnRpbnVlOwoJICAgICAgICBpZiAoIXBhcnQubWF0Y2goaG9zdG5hbWVQYXJ0UGF0dGVybikpIHsKCSAgICAgICAgICB2YXIgbmV3cGFydCA9ICcnOwoJICAgICAgICAgIGZvciAodmFyIGogPSAwLCBrID0gcGFydC5sZW5ndGg7IGogPCBrOyBqKyspIHsKCSAgICAgICAgICAgIGlmIChwYXJ0LmNoYXJDb2RlQXQoaikgPiAxMjcpIHsKCSAgICAgICAgICAgICAgLy8gd2UgcmVwbGFjZSBub24tQVNDSUkgY2hhciB3aXRoIGEgdGVtcG9yYXJ5IHBsYWNlaG9sZGVyCgkgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdGhpcyB0byBtYWtlIHN1cmUgc2l6ZSBvZiBob3N0bmFtZSBpcyBub3QKCSAgICAgICAgICAgICAgLy8gYnJva2VuIGJ5IHJlcGxhY2luZyBub24tQVNDSUkgYnkgbm90aGluZwoJICAgICAgICAgICAgICBuZXdwYXJ0ICs9ICd4JzsKCSAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgIG5ld3BhcnQgKz0gcGFydFtqXTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgICAgLy8gd2UgdGVzdCBhZ2FpbiB3aXRoIEFTQ0lJIGNoYXIgb25seQoJICAgICAgICAgIGlmICghbmV3cGFydC5tYXRjaChob3N0bmFtZVBhcnRQYXR0ZXJuKSkgewoJICAgICAgICAgICAgdmFyIHZhbGlkUGFydHMgPSBob3N0cGFydHMuc2xpY2UoMCwgaSk7CgkgICAgICAgICAgICB2YXIgbm90SG9zdCA9IGhvc3RwYXJ0cy5zbGljZShpICsgMSk7CgkgICAgICAgICAgICB2YXIgYml0ID0gcGFydC5tYXRjaChob3N0bmFtZVBhcnRTdGFydCk7CgkgICAgICAgICAgICBpZiAoYml0KSB7CgkgICAgICAgICAgICAgIHZhbGlkUGFydHMucHVzaChiaXRbMV0pOwoJICAgICAgICAgICAgICBub3RIb3N0LnVuc2hpZnQoYml0WzJdKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChub3RIb3N0Lmxlbmd0aCkgewoJICAgICAgICAgICAgICByZXN0ID0gJy8nICsgbm90SG9zdC5qb2luKCcuJykgKyByZXN0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdGhpcy5ob3N0bmFtZSA9IHZhbGlkUGFydHMuam9pbignLicpOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICB9CgkgICAgfQoKCSAgICBpZiAodGhpcy5ob3N0bmFtZS5sZW5ndGggPiBob3N0bmFtZU1heExlbikgewoJICAgICAgdGhpcy5ob3N0bmFtZSA9ICcnOwoJICAgIH0gZWxzZSB7CgkgICAgICAvLyBob3N0bmFtZXMgYXJlIGFsd2F5cyBsb3dlciBjYXNlLgoJICAgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTsKCSAgICB9CgoJICAgIGlmICghaXB2Nkhvc3RuYW1lKSB7CgkgICAgICAvLyBJRE5BIFN1cHBvcnQ6IFJldHVybnMgYSBwdW55Y29kZWQgcmVwcmVzZW50YXRpb24gb2YgImRvbWFpbiIuCgkgICAgICAvLyBJdCBvbmx5IGNvbnZlcnRzIHBhcnRzIG9mIHRoZSBkb21haW4gbmFtZSB0aGF0CgkgICAgICAvLyBoYXZlIG5vbi1BU0NJSSBjaGFyYWN0ZXJzLCBpLmUuIGl0IGRvZXNuJ3QgbWF0dGVyIGlmCgkgICAgICAvLyB5b3UgY2FsbCBpdCB3aXRoIGEgZG9tYWluIHRoYXQgYWxyZWFkeSBpcyBBU0NJSS1vbmx5LgoJICAgICAgdGhpcy5ob3N0bmFtZSA9IHB1bnljb2RlLnRvQVNDSUkodGhpcy5ob3N0bmFtZSk7CgkgICAgfQoKCSAgICB2YXIgcCA9IHRoaXMucG9ydCA/ICc6JyArIHRoaXMucG9ydCA6ICcnOwoJICAgIHZhciBoID0gdGhpcy5ob3N0bmFtZSB8fCAnJzsKCSAgICB0aGlzLmhvc3QgPSBoICsgcDsKCSAgICB0aGlzLmhyZWYgKz0gdGhpcy5ob3N0OwoKCSAgICAvLyBzdHJpcCBbIGFuZCBdIGZyb20gdGhlIGhvc3RuYW1lCgkgICAgLy8gdGhlIGhvc3QgZmllbGQgc3RpbGwgcmV0YWlucyB0aGVtLCB0aG91Z2gKCSAgICBpZiAoaXB2Nkhvc3RuYW1lKSB7CgkgICAgICB0aGlzLmhvc3RuYW1lID0gdGhpcy5ob3N0bmFtZS5zdWJzdHIoMSwgdGhpcy5ob3N0bmFtZS5sZW5ndGggLSAyKTsKCSAgICAgIGlmIChyZXN0WzBdICE9PSAnLycpIHsKCSAgICAgICAgcmVzdCA9ICcvJyArIHJlc3Q7CgkgICAgICB9CgkgICAgfQoJICB9CgoJICAvLyBub3cgcmVzdCBpcyBzZXQgdG8gdGhlIHBvc3QtaG9zdCBzdHVmZi4KCSAgLy8gY2hvcCBvZmYgYW55IGRlbGltIGNoYXJzLgoJICBpZiAoIXVuc2FmZVByb3RvY29sW2xvd2VyUHJvdG9dKSB7CgoJICAgIC8vIEZpcnN0LCBtYWtlIDEwMCUgc3VyZSB0aGF0IGFueSAiYXV0b0VzY2FwZSIgY2hhcnMgZ2V0CgkgICAgLy8gZXNjYXBlZCwgZXZlbiBpZiBlbmNvZGVVUklDb21wb25lbnQgZG9lc24ndCB0aGluayB0aGV5CgkgICAgLy8gbmVlZCB0byBiZS4KCSAgICBmb3IgKHZhciBpID0gMCwgbCA9IGF1dG9Fc2NhcGUubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgICB2YXIgYWUgPSBhdXRvRXNjYXBlW2ldOwoJICAgICAgaWYgKHJlc3QuaW5kZXhPZihhZSkgPT09IC0xKQoJICAgICAgICBjb250aW51ZTsKCSAgICAgIHZhciBlc2MgPSBlbmNvZGVVUklDb21wb25lbnQoYWUpOwoJICAgICAgaWYgKGVzYyA9PT0gYWUpIHsKCSAgICAgICAgZXNjID0gZXNjYXBlKGFlKTsKCSAgICAgIH0KCSAgICAgIHJlc3QgPSByZXN0LnNwbGl0KGFlKS5qb2luKGVzYyk7CgkgICAgfQoJICB9CgoKCSAgLy8gY2hvcCBvZmYgZnJvbSB0aGUgdGFpbCBmaXJzdC4KCSAgdmFyIGhhc2ggPSByZXN0LmluZGV4T2YoJyMnKTsKCSAgaWYgKGhhc2ggIT09IC0xKSB7CgkgICAgLy8gZ290IGEgZnJhZ21lbnQgc3RyaW5nLgoJICAgIHRoaXMuaGFzaCA9IHJlc3Quc3Vic3RyKGhhc2gpOwoJICAgIHJlc3QgPSByZXN0LnNsaWNlKDAsIGhhc2gpOwoJICB9CgkgIHZhciBxbSA9IHJlc3QuaW5kZXhPZignPycpOwoJICBpZiAocW0gIT09IC0xKSB7CgkgICAgdGhpcy5zZWFyY2ggPSByZXN0LnN1YnN0cihxbSk7CgkgICAgdGhpcy5xdWVyeSA9IHJlc3Quc3Vic3RyKHFtICsgMSk7CgkgICAgaWYgKHBhcnNlUXVlcnlTdHJpbmcpIHsKCSAgICAgIHRoaXMucXVlcnkgPSBxdWVyeXN0cmluZy5wYXJzZSh0aGlzLnF1ZXJ5KTsKCSAgICB9CgkgICAgcmVzdCA9IHJlc3Quc2xpY2UoMCwgcW0pOwoJICB9IGVsc2UgaWYgKHBhcnNlUXVlcnlTdHJpbmcpIHsKCSAgICAvLyBubyBxdWVyeSBzdHJpbmcsIGJ1dCBwYXJzZVF1ZXJ5U3RyaW5nIHN0aWxsIHJlcXVlc3RlZAoJICAgIHRoaXMuc2VhcmNoID0gJyc7CgkgICAgdGhpcy5xdWVyeSA9IHt9OwoJICB9CgkgIGlmIChyZXN0KSB0aGlzLnBhdGhuYW1lID0gcmVzdDsKCSAgaWYgKHNsYXNoZWRQcm90b2NvbFtsb3dlclByb3RvXSAmJgoJICAgICAgdGhpcy5ob3N0bmFtZSAmJiAhdGhpcy5wYXRobmFtZSkgewoJICAgIHRoaXMucGF0aG5hbWUgPSAnLyc7CgkgIH0KCgkgIC8vdG8gc3VwcG9ydCBodHRwLnJlcXVlc3QKCSAgaWYgKHRoaXMucGF0aG5hbWUgfHwgdGhpcy5zZWFyY2gpIHsKCSAgICB2YXIgcCA9IHRoaXMucGF0aG5hbWUgfHwgJyc7CgkgICAgdmFyIHMgPSB0aGlzLnNlYXJjaCB8fCAnJzsKCSAgICB0aGlzLnBhdGggPSBwICsgczsKCSAgfQoKCSAgLy8gZmluYWxseSwgcmVjb25zdHJ1Y3QgdGhlIGhyZWYgYmFzZWQgb24gd2hhdCBoYXMgYmVlbiB2YWxpZGF0ZWQuCgkgIHRoaXMuaHJlZiA9IHRoaXMuZm9ybWF0KCk7CgkgIHJldHVybiB0aGlzOwoJfTsKCgkvLyBmb3JtYXQgYSBwYXJzZWQgb2JqZWN0IGludG8gYSB1cmwgc3RyaW5nCglmdW5jdGlvbiB1cmxGb3JtYXQob2JqKSB7CgkgIC8vIGVuc3VyZSBpdCdzIGFuIG9iamVjdCwgYW5kIG5vdCBhIHN0cmluZyB1cmwuCgkgIC8vIElmIGl0J3MgYW4gb2JqLCB0aGlzIGlzIGEgbm8tb3AuCgkgIC8vIHRoaXMgd2F5LCB5b3UgY2FuIGNhbGwgdXJsX2Zvcm1hdCgpIG9uIHN0cmluZ3MKCSAgLy8gdG8gY2xlYW4gdXAgcG90ZW50aWFsbHkgd29ua3kgdXJscy4KCSAgaWYgKHV0aWwuaXNTdHJpbmcob2JqKSkgb2JqID0gdXJsUGFyc2Uob2JqKTsKCSAgaWYgKCEob2JqIGluc3RhbmNlb2YgVXJsKSkgcmV0dXJuIFVybC5wcm90b3R5cGUuZm9ybWF0LmNhbGwob2JqKTsKCSAgcmV0dXJuIG9iai5mb3JtYXQoKTsKCX0KCglVcmwucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uKCkgewoJICB2YXIgYXV0aCA9IHRoaXMuYXV0aCB8fCAnJzsKCSAgaWYgKGF1dGgpIHsKCSAgICBhdXRoID0gZW5jb2RlVVJJQ29tcG9uZW50KGF1dGgpOwoJICAgIGF1dGggPSBhdXRoLnJlcGxhY2UoLyUzQS9pLCAnOicpOwoJICAgIGF1dGggKz0gJ0AnOwoJICB9CgoJICB2YXIgcHJvdG9jb2wgPSB0aGlzLnByb3RvY29sIHx8ICcnLAoJICAgICAgcGF0aG5hbWUgPSB0aGlzLnBhdGhuYW1lIHx8ICcnLAoJICAgICAgaGFzaCA9IHRoaXMuaGFzaCB8fCAnJywKCSAgICAgIGhvc3QgPSBmYWxzZSwKCSAgICAgIHF1ZXJ5ID0gJyc7CgoJICBpZiAodGhpcy5ob3N0KSB7CgkgICAgaG9zdCA9IGF1dGggKyB0aGlzLmhvc3Q7CgkgIH0gZWxzZSBpZiAodGhpcy5ob3N0bmFtZSkgewoJICAgIGhvc3QgPSBhdXRoICsgKHRoaXMuaG9zdG5hbWUuaW5kZXhPZignOicpID09PSAtMSA/CgkgICAgICAgIHRoaXMuaG9zdG5hbWUgOgoJICAgICAgICAnWycgKyB0aGlzLmhvc3RuYW1lICsgJ10nKTsKCSAgICBpZiAodGhpcy5wb3J0KSB7CgkgICAgICBob3N0ICs9ICc6JyArIHRoaXMucG9ydDsKCSAgICB9CgkgIH0KCgkgIGlmICh0aGlzLnF1ZXJ5ICYmCgkgICAgICB1dGlsLmlzT2JqZWN0KHRoaXMucXVlcnkpICYmCgkgICAgICBPYmplY3Qua2V5cyh0aGlzLnF1ZXJ5KS5sZW5ndGgpIHsKCSAgICBxdWVyeSA9IHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeSh0aGlzLnF1ZXJ5KTsKCSAgfQoKCSAgdmFyIHNlYXJjaCA9IHRoaXMuc2VhcmNoIHx8IChxdWVyeSAmJiAoJz8nICsgcXVlcnkpKSB8fCAnJzsKCgkgIGlmIChwcm90b2NvbCAmJiBwcm90b2NvbC5zdWJzdHIoLTEpICE9PSAnOicpIHByb3RvY29sICs9ICc6JzsKCgkgIC8vIG9ubHkgdGhlIHNsYXNoZWRQcm90b2NvbHMgZ2V0IHRoZSAvLy4gIE5vdCBtYWlsdG86LCB4bXBwOiwgZXRjLgoJICAvLyB1bmxlc3MgdGhleSBoYWQgdGhlbSB0byBiZWdpbiB3aXRoLgoJICBpZiAodGhpcy5zbGFzaGVzIHx8CgkgICAgICAoIXByb3RvY29sIHx8IHNsYXNoZWRQcm90b2NvbFtwcm90b2NvbF0pICYmIGhvc3QgIT09IGZhbHNlKSB7CgkgICAgaG9zdCA9ICcvLycgKyAoaG9zdCB8fCAnJyk7CgkgICAgaWYgKHBhdGhuYW1lICYmIHBhdGhuYW1lLmNoYXJBdCgwKSAhPT0gJy8nKSBwYXRobmFtZSA9ICcvJyArIHBhdGhuYW1lOwoJICB9IGVsc2UgaWYgKCFob3N0KSB7CgkgICAgaG9zdCA9ICcnOwoJICB9CgoJICBpZiAoaGFzaCAmJiBoYXNoLmNoYXJBdCgwKSAhPT0gJyMnKSBoYXNoID0gJyMnICsgaGFzaDsKCSAgaWYgKHNlYXJjaCAmJiBzZWFyY2guY2hhckF0KDApICE9PSAnPycpIHNlYXJjaCA9ICc/JyArIHNlYXJjaDsKCgkgIHBhdGhuYW1lID0gcGF0aG5hbWUucmVwbGFjZSgvWz8jXS9nLCBmdW5jdGlvbihtYXRjaCkgewoJICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQobWF0Y2gpOwoJICB9KTsKCSAgc2VhcmNoID0gc2VhcmNoLnJlcGxhY2UoJyMnLCAnJTIzJyk7CgoJICByZXR1cm4gcHJvdG9jb2wgKyBob3N0ICsgcGF0aG5hbWUgKyBzZWFyY2ggKyBoYXNoOwoJfTsKCglmdW5jdGlvbiB1cmxSZXNvbHZlKHNvdXJjZSwgcmVsYXRpdmUpIHsKCSAgcmV0dXJuIHVybFBhcnNlKHNvdXJjZSwgZmFsc2UsIHRydWUpLnJlc29sdmUocmVsYXRpdmUpOwoJfQoKCVVybC5wcm90b3R5cGUucmVzb2x2ZSA9IGZ1bmN0aW9uKHJlbGF0aXZlKSB7CgkgIHJldHVybiB0aGlzLnJlc29sdmVPYmplY3QodXJsUGFyc2UocmVsYXRpdmUsIGZhbHNlLCB0cnVlKSkuZm9ybWF0KCk7Cgl9OwoKCWZ1bmN0aW9uIHVybFJlc29sdmVPYmplY3Qoc291cmNlLCByZWxhdGl2ZSkgewoJICBpZiAoIXNvdXJjZSkgcmV0dXJuIHJlbGF0aXZlOwoJICByZXR1cm4gdXJsUGFyc2Uoc291cmNlLCBmYWxzZSwgdHJ1ZSkucmVzb2x2ZU9iamVjdChyZWxhdGl2ZSk7Cgl9CgoJVXJsLnByb3RvdHlwZS5yZXNvbHZlT2JqZWN0ID0gZnVuY3Rpb24ocmVsYXRpdmUpIHsKCSAgaWYgKHV0aWwuaXNTdHJpbmcocmVsYXRpdmUpKSB7CgkgICAgdmFyIHJlbCA9IG5ldyBVcmwoKTsKCSAgICByZWwucGFyc2UocmVsYXRpdmUsIGZhbHNlLCB0cnVlKTsKCSAgICByZWxhdGl2ZSA9IHJlbDsKCSAgfQoKCSAgdmFyIHJlc3VsdCA9IG5ldyBVcmwoKTsKCSAgdmFyIHRrZXlzID0gT2JqZWN0LmtleXModGhpcyk7CgkgIGZvciAodmFyIHRrID0gMDsgdGsgPCB0a2V5cy5sZW5ndGg7IHRrKyspIHsKCSAgICB2YXIgdGtleSA9IHRrZXlzW3RrXTsKCSAgICByZXN1bHRbdGtleV0gPSB0aGlzW3RrZXldOwoJICB9CgoJICAvLyBoYXNoIGlzIGFsd2F5cyBvdmVycmlkZGVuLCBubyBtYXR0ZXIgd2hhdC4KCSAgLy8gZXZlbiBocmVmPSIiIHdpbGwgcmVtb3ZlIGl0LgoJICByZXN1bHQuaGFzaCA9IHJlbGF0aXZlLmhhc2g7CgoJICAvLyBpZiB0aGUgcmVsYXRpdmUgdXJsIGlzIGVtcHR5LCB0aGVuIHRoZXJlJ3Mgbm90aGluZyBsZWZ0IHRvIGRvIGhlcmUuCgkgIGlmIChyZWxhdGl2ZS5ocmVmID09PSAnJykgewoJICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpOwoJICAgIHJldHVybiByZXN1bHQ7CgkgIH0KCgkgIC8vIGhyZWZzIGxpa2UgLy9mb28vYmFyIGFsd2F5cyBjdXQgdG8gdGhlIHByb3RvY29sLgoJICBpZiAocmVsYXRpdmUuc2xhc2hlcyAmJiAhcmVsYXRpdmUucHJvdG9jb2wpIHsKCSAgICAvLyB0YWtlIGV2ZXJ5dGhpbmcgZXhjZXB0IHRoZSBwcm90b2NvbCBmcm9tIHJlbGF0aXZlCgkgICAgdmFyIHJrZXlzID0gT2JqZWN0LmtleXMocmVsYXRpdmUpOwoJICAgIGZvciAodmFyIHJrID0gMDsgcmsgPCBya2V5cy5sZW5ndGg7IHJrKyspIHsKCSAgICAgIHZhciBya2V5ID0gcmtleXNbcmtdOwoJICAgICAgaWYgKHJrZXkgIT09ICdwcm90b2NvbCcpCgkgICAgICAgIHJlc3VsdFtya2V5XSA9IHJlbGF0aXZlW3JrZXldOwoJICAgIH0KCgkgICAgLy91cmxQYXJzZSBhcHBlbmRzIHRyYWlsaW5nIC8gdG8gdXJscyBsaWtlIGh0dHA6Ly93d3cuZXhhbXBsZS5jb20KCSAgICBpZiAoc2xhc2hlZFByb3RvY29sW3Jlc3VsdC5wcm90b2NvbF0gJiYKCSAgICAgICAgcmVzdWx0Lmhvc3RuYW1lICYmICFyZXN1bHQucGF0aG5hbWUpIHsKCSAgICAgIHJlc3VsdC5wYXRoID0gcmVzdWx0LnBhdGhuYW1lID0gJy8nOwoJICAgIH0KCgkgICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7CgkgICAgcmV0dXJuIHJlc3VsdDsKCSAgfQoKCSAgaWYgKHJlbGF0aXZlLnByb3RvY29sICYmIHJlbGF0aXZlLnByb3RvY29sICE9PSByZXN1bHQucHJvdG9jb2wpIHsKCSAgICAvLyBpZiBpdCdzIGEga25vd24gdXJsIHByb3RvY29sLCB0aGVuIGNoYW5naW5nCgkgICAgLy8gdGhlIHByb3RvY29sIGRvZXMgd2VpcmQgdGhpbmdzCgkgICAgLy8gZmlyc3QsIGlmIGl0J3Mgbm90IGZpbGU6LCB0aGVuIHdlIE1VU1QgaGF2ZSBhIGhvc3QsCgkgICAgLy8gYW5kIGlmIHRoZXJlIHdhcyBhIHBhdGgKCSAgICAvLyB0byBiZWdpbiB3aXRoLCB0aGVuIHdlIE1VU1QgaGF2ZSBhIHBhdGguCgkgICAgLy8gaWYgaXQgaXMgZmlsZTosIHRoZW4gdGhlIGhvc3QgaXMgZHJvcHBlZCwKCSAgICAvLyBiZWNhdXNlIHRoYXQncyBrbm93biB0byBiZSBob3N0bGVzcy4KCSAgICAvLyBhbnl0aGluZyBlbHNlIGlzIGFzc3VtZWQgdG8gYmUgYWJzb2x1dGUuCgkgICAgaWYgKCFzbGFzaGVkUHJvdG9jb2xbcmVsYXRpdmUucHJvdG9jb2xdKSB7CgkgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHJlbGF0aXZlKTsKCSAgICAgIGZvciAodmFyIHYgPSAwOyB2IDwga2V5cy5sZW5ndGg7IHYrKykgewoJICAgICAgICB2YXIgayA9IGtleXNbdl07CgkgICAgICAgIHJlc3VsdFtrXSA9IHJlbGF0aXZlW2tdOwoJICAgICAgfQoJICAgICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7CgkgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH0KCgkgICAgcmVzdWx0LnByb3RvY29sID0gcmVsYXRpdmUucHJvdG9jb2w7CgkgICAgaWYgKCFyZWxhdGl2ZS5ob3N0ICYmICFob3N0bGVzc1Byb3RvY29sW3JlbGF0aXZlLnByb3RvY29sXSkgewoJICAgICAgdmFyIHJlbFBhdGggPSAocmVsYXRpdmUucGF0aG5hbWUgfHwgJycpLnNwbGl0KCcvJyk7CgkgICAgICB3aGlsZSAocmVsUGF0aC5sZW5ndGggJiYgIShyZWxhdGl2ZS5ob3N0ID0gcmVsUGF0aC5zaGlmdCgpKSk7CgkgICAgICBpZiAoIXJlbGF0aXZlLmhvc3QpIHJlbGF0aXZlLmhvc3QgPSAnJzsKCSAgICAgIGlmICghcmVsYXRpdmUuaG9zdG5hbWUpIHJlbGF0aXZlLmhvc3RuYW1lID0gJyc7CgkgICAgICBpZiAocmVsUGF0aFswXSAhPT0gJycpIHJlbFBhdGgudW5zaGlmdCgnJyk7CgkgICAgICBpZiAocmVsUGF0aC5sZW5ndGggPCAyKSByZWxQYXRoLnVuc2hpZnQoJycpOwoJICAgICAgcmVzdWx0LnBhdGhuYW1lID0gcmVsUGF0aC5qb2luKCcvJyk7CgkgICAgfSBlbHNlIHsKCSAgICAgIHJlc3VsdC5wYXRobmFtZSA9IHJlbGF0aXZlLnBhdGhuYW1lOwoJICAgIH0KCSAgICByZXN1bHQuc2VhcmNoID0gcmVsYXRpdmUuc2VhcmNoOwoJICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5OwoJICAgIHJlc3VsdC5ob3N0ID0gcmVsYXRpdmUuaG9zdCB8fCAnJzsKCSAgICByZXN1bHQuYXV0aCA9IHJlbGF0aXZlLmF1dGg7CgkgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVsYXRpdmUuaG9zdG5hbWUgfHwgcmVsYXRpdmUuaG9zdDsKCSAgICByZXN1bHQucG9ydCA9IHJlbGF0aXZlLnBvcnQ7CgkgICAgLy8gdG8gc3VwcG9ydCBodHRwLnJlcXVlc3QKCSAgICBpZiAocmVzdWx0LnBhdGhuYW1lIHx8IHJlc3VsdC5zZWFyY2gpIHsKCSAgICAgIHZhciBwID0gcmVzdWx0LnBhdGhuYW1lIHx8ICcnOwoJICAgICAgdmFyIHMgPSByZXN1bHQuc2VhcmNoIHx8ICcnOwoJICAgICAgcmVzdWx0LnBhdGggPSBwICsgczsKCSAgICB9CgkgICAgcmVzdWx0LnNsYXNoZXMgPSByZXN1bHQuc2xhc2hlcyB8fCByZWxhdGl2ZS5zbGFzaGVzOwoJICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpOwoJICAgIHJldHVybiByZXN1bHQ7CgkgIH0KCgkgIHZhciBpc1NvdXJjZUFicyA9IChyZXN1bHQucGF0aG5hbWUgJiYgcmVzdWx0LnBhdGhuYW1lLmNoYXJBdCgwKSA9PT0gJy8nKSwKCSAgICAgIGlzUmVsQWJzID0gKAoJICAgICAgICAgIHJlbGF0aXZlLmhvc3QgfHwKCSAgICAgICAgICByZWxhdGl2ZS5wYXRobmFtZSAmJiByZWxhdGl2ZS5wYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJwoJICAgICAgKSwKCSAgICAgIG11c3RFbmRBYnMgPSAoaXNSZWxBYnMgfHwgaXNTb3VyY2VBYnMgfHwKCSAgICAgICAgICAgICAgICAgICAgKHJlc3VsdC5ob3N0ICYmIHJlbGF0aXZlLnBhdGhuYW1lKSksCgkgICAgICByZW1vdmVBbGxEb3RzID0gbXVzdEVuZEFicywKCSAgICAgIHNyY1BhdGggPSByZXN1bHQucGF0aG5hbWUgJiYgcmVzdWx0LnBhdGhuYW1lLnNwbGl0KCcvJykgfHwgW10sCgkgICAgICByZWxQYXRoID0gcmVsYXRpdmUucGF0aG5hbWUgJiYgcmVsYXRpdmUucGF0aG5hbWUuc3BsaXQoJy8nKSB8fCBbXSwKCSAgICAgIHBzeWNob3RpYyA9IHJlc3VsdC5wcm90b2NvbCAmJiAhc2xhc2hlZFByb3RvY29sW3Jlc3VsdC5wcm90b2NvbF07CgoJICAvLyBpZiB0aGUgdXJsIGlzIGEgbm9uLXNsYXNoZWQgdXJsLCB0aGVuIHJlbGF0aXZlCgkgIC8vIGxpbmtzIGxpa2UgLi4vLi4gc2hvdWxkIGJlIGFibGUKCSAgLy8gdG8gY3Jhd2wgdXAgdG8gdGhlIGhvc3RuYW1lLCBhcyB3ZWxsLiAgVGhpcyBpcyBzdHJhbmdlLgoJICAvLyByZXN1bHQucHJvdG9jb2wgaGFzIGFscmVhZHkgYmVlbiBzZXQgYnkgbm93LgoJICAvLyBMYXRlciBvbiwgcHV0IHRoZSBmaXJzdCBwYXRoIHBhcnQgaW50byB0aGUgaG9zdCBmaWVsZC4KCSAgaWYgKHBzeWNob3RpYykgewoJICAgIHJlc3VsdC5ob3N0bmFtZSA9ICcnOwoJICAgIHJlc3VsdC5wb3J0ID0gbnVsbDsKCSAgICBpZiAocmVzdWx0Lmhvc3QpIHsKCSAgICAgIGlmIChzcmNQYXRoWzBdID09PSAnJykgc3JjUGF0aFswXSA9IHJlc3VsdC5ob3N0OwoJICAgICAgZWxzZSBzcmNQYXRoLnVuc2hpZnQocmVzdWx0Lmhvc3QpOwoJICAgIH0KCSAgICByZXN1bHQuaG9zdCA9ICcnOwoJICAgIGlmIChyZWxhdGl2ZS5wcm90b2NvbCkgewoJICAgICAgcmVsYXRpdmUuaG9zdG5hbWUgPSBudWxsOwoJICAgICAgcmVsYXRpdmUucG9ydCA9IG51bGw7CgkgICAgICBpZiAocmVsYXRpdmUuaG9zdCkgewoJICAgICAgICBpZiAocmVsUGF0aFswXSA9PT0gJycpIHJlbFBhdGhbMF0gPSByZWxhdGl2ZS5ob3N0OwoJICAgICAgICBlbHNlIHJlbFBhdGgudW5zaGlmdChyZWxhdGl2ZS5ob3N0KTsKCSAgICAgIH0KCSAgICAgIHJlbGF0aXZlLmhvc3QgPSBudWxsOwoJICAgIH0KCSAgICBtdXN0RW5kQWJzID0gbXVzdEVuZEFicyAmJiAocmVsUGF0aFswXSA9PT0gJycgfHwgc3JjUGF0aFswXSA9PT0gJycpOwoJICB9CgoJICBpZiAoaXNSZWxBYnMpIHsKCSAgICAvLyBpdCdzIGFic29sdXRlLgoJICAgIHJlc3VsdC5ob3N0ID0gKHJlbGF0aXZlLmhvc3QgfHwgcmVsYXRpdmUuaG9zdCA9PT0gJycpID8KCSAgICAgICAgICAgICAgICAgIHJlbGF0aXZlLmhvc3QgOiByZXN1bHQuaG9zdDsKCSAgICByZXN1bHQuaG9zdG5hbWUgPSAocmVsYXRpdmUuaG9zdG5hbWUgfHwgcmVsYXRpdmUuaG9zdG5hbWUgPT09ICcnKSA/CgkgICAgICAgICAgICAgICAgICAgICAgcmVsYXRpdmUuaG9zdG5hbWUgOiByZXN1bHQuaG9zdG5hbWU7CgkgICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDsKCSAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTsKCSAgICBzcmNQYXRoID0gcmVsUGF0aDsKCSAgICAvLyBmYWxsIHRocm91Z2ggdG8gdGhlIGRvdC1oYW5kbGluZyBiZWxvdy4KCSAgfSBlbHNlIGlmIChyZWxQYXRoLmxlbmd0aCkgewoJICAgIC8vIGl0J3MgcmVsYXRpdmUKCSAgICAvLyB0aHJvdyBhd2F5IHRoZSBleGlzdGluZyBmaWxlLCBhbmQgdGFrZSB0aGUgbmV3IHBhdGggaW5zdGVhZC4KCSAgICBpZiAoIXNyY1BhdGgpIHNyY1BhdGggPSBbXTsKCSAgICBzcmNQYXRoLnBvcCgpOwoJICAgIHNyY1BhdGggPSBzcmNQYXRoLmNvbmNhdChyZWxQYXRoKTsKCSAgICByZXN1bHQuc2VhcmNoID0gcmVsYXRpdmUuc2VhcmNoOwoJICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5OwoJICB9IGVsc2UgaWYgKCF1dGlsLmlzTnVsbE9yVW5kZWZpbmVkKHJlbGF0aXZlLnNlYXJjaCkpIHsKCSAgICAvLyBqdXN0IHB1bGwgb3V0IHRoZSBzZWFyY2guCgkgICAgLy8gbGlrZSBocmVmPSc/Zm9vJy4KCSAgICAvLyBQdXQgdGhpcyBhZnRlciB0aGUgb3RoZXIgdHdvIGNhc2VzIGJlY2F1c2UgaXQgc2ltcGxpZmllcyB0aGUgYm9vbGVhbnMKCSAgICBpZiAocHN5Y2hvdGljKSB7CgkgICAgICByZXN1bHQuaG9zdG5hbWUgPSByZXN1bHQuaG9zdCA9IHNyY1BhdGguc2hpZnQoKTsKCSAgICAgIC8vb2NjYXRpb25hbHkgdGhlIGF1dGggY2FuIGdldCBzdHVjayBvbmx5IGluIGhvc3QKCSAgICAgIC8vdGhpcyBlc3BlY2lhbGx5IGhhcHBlbnMgaW4gY2FzZXMgbGlrZQoJICAgICAgLy91cmwucmVzb2x2ZU9iamVjdCgnbWFpbHRvOmxvY2FsMUBkb21haW4xJywgJ2xvY2FsMkBkb21haW4yJykKCSAgICAgIHZhciBhdXRoSW5Ib3N0ID0gcmVzdWx0Lmhvc3QgJiYgcmVzdWx0Lmhvc3QuaW5kZXhPZignQCcpID4gMCA/CgkgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ob3N0LnNwbGl0KCdAJykgOiBmYWxzZTsKCSAgICAgIGlmIChhdXRoSW5Ib3N0KSB7CgkgICAgICAgIHJlc3VsdC5hdXRoID0gYXV0aEluSG9zdC5zaGlmdCgpOwoJICAgICAgICByZXN1bHQuaG9zdCA9IHJlc3VsdC5ob3N0bmFtZSA9IGF1dGhJbkhvc3Quc2hpZnQoKTsKCSAgICAgIH0KCSAgICB9CgkgICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDsKCSAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTsKCSAgICAvL3RvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0CgkgICAgaWYgKCF1dGlsLmlzTnVsbChyZXN1bHQucGF0aG5hbWUpIHx8ICF1dGlsLmlzTnVsbChyZXN1bHQuc2VhcmNoKSkgewoJICAgICAgcmVzdWx0LnBhdGggPSAocmVzdWx0LnBhdGhuYW1lID8gcmVzdWx0LnBhdGhuYW1lIDogJycpICsKCSAgICAgICAgICAgICAgICAgICAgKHJlc3VsdC5zZWFyY2ggPyByZXN1bHQuc2VhcmNoIDogJycpOwoJICAgIH0KCSAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTsKCSAgICByZXR1cm4gcmVzdWx0OwoJICB9CgoJICBpZiAoIXNyY1BhdGgubGVuZ3RoKSB7CgkgICAgLy8gbm8gcGF0aCBhdCBhbGwuICBlYXN5LgoJICAgIC8vIHdlJ3ZlIGFscmVhZHkgaGFuZGxlZCB0aGUgb3RoZXIgc3R1ZmYgYWJvdmUuCgkgICAgcmVzdWx0LnBhdGhuYW1lID0gbnVsbDsKCSAgICAvL3RvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0CgkgICAgaWYgKHJlc3VsdC5zZWFyY2gpIHsKCSAgICAgIHJlc3VsdC5wYXRoID0gJy8nICsgcmVzdWx0LnNlYXJjaDsKCSAgICB9IGVsc2UgewoJICAgICAgcmVzdWx0LnBhdGggPSBudWxsOwoJICAgIH0KCSAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTsKCSAgICByZXR1cm4gcmVzdWx0OwoJICB9CgoJICAvLyBpZiBhIHVybCBFTkRzIGluIC4gb3IgLi4sIHRoZW4gaXQgbXVzdCBnZXQgYSB0cmFpbGluZyBzbGFzaC4KCSAgLy8gaG93ZXZlciwgaWYgaXQgZW5kcyBpbiBhbnl0aGluZyBlbHNlIG5vbi1zbGFzaHksCgkgIC8vIHRoZW4gaXQgbXVzdCBOT1QgZ2V0IGEgdHJhaWxpbmcgc2xhc2guCgkgIHZhciBsYXN0ID0gc3JjUGF0aC5zbGljZSgtMSlbMF07CgkgIHZhciBoYXNUcmFpbGluZ1NsYXNoID0gKAoJICAgICAgKHJlc3VsdC5ob3N0IHx8IHJlbGF0aXZlLmhvc3QgfHwgc3JjUGF0aC5sZW5ndGggPiAxKSAmJgoJICAgICAgKGxhc3QgPT09ICcuJyB8fCBsYXN0ID09PSAnLi4nKSB8fCBsYXN0ID09PSAnJyk7CgoJICAvLyBzdHJpcCBzaW5nbGUgZG90cywgcmVzb2x2ZSBkb3VibGUgZG90cyB0byBwYXJlbnQgZGlyCgkgIC8vIGlmIHRoZSBwYXRoIHRyaWVzIHRvIGdvIGFib3ZlIHRoZSByb290LCBgdXBgIGVuZHMgdXAgPiAwCgkgIHZhciB1cCA9IDA7CgkgIGZvciAodmFyIGkgPSBzcmNQYXRoLmxlbmd0aDsgaSA+PSAwOyBpLS0pIHsKCSAgICBsYXN0ID0gc3JjUGF0aFtpXTsKCSAgICBpZiAobGFzdCA9PT0gJy4nKSB7CgkgICAgICBzcmNQYXRoLnNwbGljZShpLCAxKTsKCSAgICB9IGVsc2UgaWYgKGxhc3QgPT09ICcuLicpIHsKCSAgICAgIHNyY1BhdGguc3BsaWNlKGksIDEpOwoJICAgICAgdXArKzsKCSAgICB9IGVsc2UgaWYgKHVwKSB7CgkgICAgICBzcmNQYXRoLnNwbGljZShpLCAxKTsKCSAgICAgIHVwLS07CgkgICAgfQoJICB9CgoJICAvLyBpZiB0aGUgcGF0aCBpcyBhbGxvd2VkIHRvIGdvIGFib3ZlIHRoZSByb290LCByZXN0b3JlIGxlYWRpbmcgLi5zCgkgIGlmICghbXVzdEVuZEFicyAmJiAhcmVtb3ZlQWxsRG90cykgewoJICAgIGZvciAoOyB1cC0tOyB1cCkgewoJICAgICAgc3JjUGF0aC51bnNoaWZ0KCcuLicpOwoJICAgIH0KCSAgfQoKCSAgaWYgKG11c3RFbmRBYnMgJiYgc3JjUGF0aFswXSAhPT0gJycgJiYKCSAgICAgICghc3JjUGF0aFswXSB8fCBzcmNQYXRoWzBdLmNoYXJBdCgwKSAhPT0gJy8nKSkgewoJICAgIHNyY1BhdGgudW5zaGlmdCgnJyk7CgkgIH0KCgkgIGlmIChoYXNUcmFpbGluZ1NsYXNoICYmIChzcmNQYXRoLmpvaW4oJy8nKS5zdWJzdHIoLTEpICE9PSAnLycpKSB7CgkgICAgc3JjUGF0aC5wdXNoKCcnKTsKCSAgfQoKCSAgdmFyIGlzQWJzb2x1dGUgPSBzcmNQYXRoWzBdID09PSAnJyB8fAoJICAgICAgKHNyY1BhdGhbMF0gJiYgc3JjUGF0aFswXS5jaGFyQXQoMCkgPT09ICcvJyk7CgoJICAvLyBwdXQgdGhlIGhvc3QgYmFjawoJICBpZiAocHN5Y2hvdGljKSB7CgkgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVzdWx0Lmhvc3QgPSBpc0Fic29sdXRlID8gJycgOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjUGF0aC5sZW5ndGggPyBzcmNQYXRoLnNoaWZ0KCkgOiAnJzsKCSAgICAvL29jY2F0aW9uYWx5IHRoZSBhdXRoIGNhbiBnZXQgc3R1Y2sgb25seSBpbiBob3N0CgkgICAgLy90aGlzIGVzcGVjaWFsbHkgaGFwcGVucyBpbiBjYXNlcyBsaWtlCgkgICAgLy91cmwucmVzb2x2ZU9iamVjdCgnbWFpbHRvOmxvY2FsMUBkb21haW4xJywgJ2xvY2FsMkBkb21haW4yJykKCSAgICB2YXIgYXV0aEluSG9zdCA9IHJlc3VsdC5ob3N0ICYmIHJlc3VsdC5ob3N0LmluZGV4T2YoJ0AnKSA+IDAgPwoJICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3Quc3BsaXQoJ0AnKSA6IGZhbHNlOwoJICAgIGlmIChhdXRoSW5Ib3N0KSB7CgkgICAgICByZXN1bHQuYXV0aCA9IGF1dGhJbkhvc3Quc2hpZnQoKTsKCSAgICAgIHJlc3VsdC5ob3N0ID0gcmVzdWx0Lmhvc3RuYW1lID0gYXV0aEluSG9zdC5zaGlmdCgpOwoJICAgIH0KCSAgfQoKCSAgbXVzdEVuZEFicyA9IG11c3RFbmRBYnMgfHwgKHJlc3VsdC5ob3N0ICYmIHNyY1BhdGgubGVuZ3RoKTsKCgkgIGlmIChtdXN0RW5kQWJzICYmICFpc0Fic29sdXRlKSB7CgkgICAgc3JjUGF0aC51bnNoaWZ0KCcnKTsKCSAgfQoKCSAgaWYgKCFzcmNQYXRoLmxlbmd0aCkgewoJICAgIHJlc3VsdC5wYXRobmFtZSA9IG51bGw7CgkgICAgcmVzdWx0LnBhdGggPSBudWxsOwoJICB9IGVsc2UgewoJICAgIHJlc3VsdC5wYXRobmFtZSA9IHNyY1BhdGguam9pbignLycpOwoJICB9CgoJICAvL3RvIHN1cHBvcnQgcmVxdWVzdC5odHRwCgkgIGlmICghdXRpbC5pc051bGwocmVzdWx0LnBhdGhuYW1lKSB8fCAhdXRpbC5pc051bGwocmVzdWx0LnNlYXJjaCkpIHsKCSAgICByZXN1bHQucGF0aCA9IChyZXN1bHQucGF0aG5hbWUgPyByZXN1bHQucGF0aG5hbWUgOiAnJykgKwoJICAgICAgICAgICAgICAgICAgKHJlc3VsdC5zZWFyY2ggPyByZXN1bHQuc2VhcmNoIDogJycpOwoJICB9CgkgIHJlc3VsdC5hdXRoID0gcmVsYXRpdmUuYXV0aCB8fCByZXN1bHQuYXV0aDsKCSAgcmVzdWx0LnNsYXNoZXMgPSByZXN1bHQuc2xhc2hlcyB8fCByZWxhdGl2ZS5zbGFzaGVzOwoJICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTsKCSAgcmV0dXJuIHJlc3VsdDsKCX07CgoJVXJsLnByb3RvdHlwZS5wYXJzZUhvc3QgPSBmdW5jdGlvbigpIHsKCSAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7CgkgIHZhciBwb3J0ID0gcG9ydFBhdHRlcm4uZXhlYyhob3N0KTsKCSAgaWYgKHBvcnQpIHsKCSAgICBwb3J0ID0gcG9ydFswXTsKCSAgICBpZiAocG9ydCAhPT0gJzonKSB7CgkgICAgICB0aGlzLnBvcnQgPSBwb3J0LnN1YnN0cigxKTsKCSAgICB9CgkgICAgaG9zdCA9IGhvc3Quc3Vic3RyKDAsIGhvc3QubGVuZ3RoIC0gcG9ydC5sZW5ndGgpOwoJICB9CgkgIGlmIChob3N0KSB0aGlzLmhvc3RuYW1lID0gaG9zdDsKCX07CgoKLyoqKi8gfSwKLyogMzkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihtb2R1bGUsIGdsb2JhbCkgey8qISBodHRwczovL210aHMuYmUvcHVueWNvZGUgdjEuMy4yIGJ5IEBtYXRoaWFzICovCgk7KGZ1bmN0aW9uKHJvb3QpIHsKCgkJLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlcyAqLwoJCXZhciBmcmVlRXhwb3J0cyA9IHR5cGVvZiBleHBvcnRzID09ICdvYmplY3QnICYmIGV4cG9ydHMgJiYKCQkJIWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0czsKCQl2YXIgZnJlZU1vZHVsZSA9IHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlICYmCgkJCSFtb2R1bGUubm9kZVR5cGUgJiYgbW9kdWxlOwoJCXZhciBmcmVlR2xvYmFsID0gdHlwZW9mIGdsb2JhbCA9PSAnb2JqZWN0JyAmJiBnbG9iYWw7CgkJaWYgKAoJCQlmcmVlR2xvYmFsLmdsb2JhbCA9PT0gZnJlZUdsb2JhbCB8fAoJCQlmcmVlR2xvYmFsLndpbmRvdyA9PT0gZnJlZUdsb2JhbCB8fAoJCQlmcmVlR2xvYmFsLnNlbGYgPT09IGZyZWVHbG9iYWwKCQkpIHsKCQkJcm9vdCA9IGZyZWVHbG9iYWw7CgkJfQoKCQkvKioKCQkgKiBUaGUgYHB1bnljb2RlYCBvYmplY3QuCgkJICogQG5hbWUgcHVueWNvZGUKCQkgKiBAdHlwZSBPYmplY3QKCQkgKi8KCQl2YXIgcHVueWNvZGUsCgoJCS8qKiBIaWdoZXN0IHBvc2l0aXZlIHNpZ25lZCAzMi1iaXQgZmxvYXQgdmFsdWUgKi8KCQltYXhJbnQgPSAyMTQ3NDgzNjQ3LCAvLyBha2EuIDB4N0ZGRkZGRkYgb3IgMl4zMS0xCgoJCS8qKiBCb290c3RyaW5nIHBhcmFtZXRlcnMgKi8KCQliYXNlID0gMzYsCgkJdE1pbiA9IDEsCgkJdE1heCA9IDI2LAoJCXNrZXcgPSAzOCwKCQlkYW1wID0gNzAwLAoJCWluaXRpYWxCaWFzID0gNzIsCgkJaW5pdGlhbE4gPSAxMjgsIC8vIDB4ODAKCQlkZWxpbWl0ZXIgPSAnLScsIC8vICdceDJEJwoKCQkvKiogUmVndWxhciBleHByZXNzaW9ucyAqLwoJCXJlZ2V4UHVueWNvZGUgPSAvXnhuLS0vLAoJCXJlZ2V4Tm9uQVNDSUkgPSAvW15ceDIwLVx4N0VdLywgLy8gdW5wcmludGFibGUgQVNDSUkgY2hhcnMgKyBub24tQVNDSUkgY2hhcnMKCQlyZWdleFNlcGFyYXRvcnMgPSAvW1x4MkVcdTMwMDJcdUZGMEVcdUZGNjFdL2csIC8vIFJGQyAzNDkwIHNlcGFyYXRvcnMKCgkJLyoqIEVycm9yIG1lc3NhZ2VzICovCgkJZXJyb3JzID0gewoJCQknb3ZlcmZsb3cnOiAnT3ZlcmZsb3c6IGlucHV0IG5lZWRzIHdpZGVyIGludGVnZXJzIHRvIHByb2Nlc3MnLAoJCQknbm90LWJhc2ljJzogJ0lsbGVnYWwgaW5wdXQgPj0gMHg4MCAobm90IGEgYmFzaWMgY29kZSBwb2ludCknLAoJCQknaW52YWxpZC1pbnB1dCc6ICdJbnZhbGlkIGlucHV0JwoJCX0sCgoJCS8qKiBDb252ZW5pZW5jZSBzaG9ydGN1dHMgKi8KCQliYXNlTWludXNUTWluID0gYmFzZSAtIHRNaW4sCgkJZmxvb3IgPSBNYXRoLmZsb29yLAoJCXN0cmluZ0Zyb21DaGFyQ29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGUsCgoJCS8qKiBUZW1wb3JhcnkgdmFyaWFibGUgKi8KCQlrZXk7CgoJCS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKCQkvKioKCQkgKiBBIGdlbmVyaWMgZXJyb3IgdXRpbGl0eSBmdW5jdGlvbi4KCQkgKiBAcHJpdmF0ZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIFRoZSBlcnJvciB0eXBlLgoJCSAqIEByZXR1cm5zIHtFcnJvcn0gVGhyb3dzIGEgYFJhbmdlRXJyb3JgIHdpdGggdGhlIGFwcGxpY2FibGUgZXJyb3IgbWVzc2FnZS4KCQkgKi8KCQlmdW5jdGlvbiBlcnJvcih0eXBlKSB7CgkJCXRocm93IFJhbmdlRXJyb3IoZXJyb3JzW3R5cGVdKTsKCQl9CgoJCS8qKgoJCSAqIEEgZ2VuZXJpYyBgQXJyYXkjbWFwYCB1dGlsaXR5IGZ1bmN0aW9uLgoJCSAqIEBwcml2YXRlCgkJICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci4KCQkgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCBmb3IgZXZlcnkgYXJyYXkKCQkgKiBpdGVtLgoJCSAqIEByZXR1cm5zIHtBcnJheX0gQSBuZXcgYXJyYXkgb2YgdmFsdWVzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFjayBmdW5jdGlvbi4KCQkgKi8KCQlmdW5jdGlvbiBtYXAoYXJyYXksIGZuKSB7CgkJCXZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7CgkJCXZhciByZXN1bHQgPSBbXTsKCQkJd2hpbGUgKGxlbmd0aC0tKSB7CgkJCQlyZXN1bHRbbGVuZ3RoXSA9IGZuKGFycmF5W2xlbmd0aF0pOwoJCQl9CgkJCXJldHVybiByZXN1bHQ7CgkJfQoKCQkvKioKCQkgKiBBIHNpbXBsZSBgQXJyYXkjbWFwYC1saWtlIHdyYXBwZXIgdG8gd29yayB3aXRoIGRvbWFpbiBuYW1lIHN0cmluZ3Mgb3IgZW1haWwKCQkgKiBhZGRyZXNzZXMuCgkJICogQHByaXZhdGUKCQkgKiBAcGFyYW0ge1N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzLgoJCSAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIGZvciBldmVyeQoJCSAqIGNoYXJhY3Rlci4KCQkgKiBAcmV0dXJucyB7QXJyYXl9IEEgbmV3IHN0cmluZyBvZiBjaGFyYWN0ZXJzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFjawoJCSAqIGZ1bmN0aW9uLgoJCSAqLwoJCWZ1bmN0aW9uIG1hcERvbWFpbihzdHJpbmcsIGZuKSB7CgkJCXZhciBwYXJ0cyA9IHN0cmluZy5zcGxpdCgnQCcpOwoJCQl2YXIgcmVzdWx0ID0gJyc7CgkJCWlmIChwYXJ0cy5sZW5ndGggPiAxKSB7CgkJCQkvLyBJbiBlbWFpbCBhZGRyZXNzZXMsIG9ubHkgdGhlIGRvbWFpbiBuYW1lIHNob3VsZCBiZSBwdW55Y29kZWQuIExlYXZlCgkJCQkvLyB0aGUgbG9jYWwgcGFydCAoaS5lLiBldmVyeXRoaW5nIHVwIHRvIGBAYCkgaW50YWN0LgoJCQkJcmVzdWx0ID0gcGFydHNbMF0gKyAnQCc7CgkJCQlzdHJpbmcgPSBwYXJ0c1sxXTsKCQkJfQoJCQkvLyBBdm9pZCBgc3BsaXQocmVnZXgpYCBmb3IgSUU4IGNvbXBhdGliaWxpdHkuIFNlZSAjMTcuCgkJCXN0cmluZyA9IHN0cmluZy5yZXBsYWNlKHJlZ2V4U2VwYXJhdG9ycywgJ1x4MkUnKTsKCQkJdmFyIGxhYmVscyA9IHN0cmluZy5zcGxpdCgnLicpOwoJCQl2YXIgZW5jb2RlZCA9IG1hcChsYWJlbHMsIGZuKS5qb2luKCcuJyk7CgkJCXJldHVybiByZXN1bHQgKyBlbmNvZGVkOwoJCX0KCgkJLyoqCgkJICogQ3JlYXRlcyBhbiBhcnJheSBjb250YWluaW5nIHRoZSBudW1lcmljIGNvZGUgcG9pbnRzIG9mIGVhY2ggVW5pY29kZQoJCSAqIGNoYXJhY3RlciBpbiB0aGUgc3RyaW5nLiBXaGlsZSBKYXZhU2NyaXB0IHVzZXMgVUNTLTIgaW50ZXJuYWxseSwKCQkgKiB0aGlzIGZ1bmN0aW9uIHdpbGwgY29udmVydCBhIHBhaXIgb2Ygc3Vycm9nYXRlIGhhbHZlcyAoZWFjaCBvZiB3aGljaAoJCSAqIFVDUy0yIGV4cG9zZXMgYXMgc2VwYXJhdGUgY2hhcmFjdGVycykgaW50byBhIHNpbmdsZSBjb2RlIHBvaW50LAoJCSAqIG1hdGNoaW5nIFVURi0xNi4KCQkgKiBAc2VlIGBwdW55Y29kZS51Y3MyLmVuY29kZWAKCQkgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz4KCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUudWNzMgoJCSAqIEBuYW1lIGRlY29kZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSBzdHJpbmcgVGhlIFVuaWNvZGUgaW5wdXQgc3RyaW5nIChVQ1MtMikuCgkJICogQHJldHVybnMge0FycmF5fSBUaGUgbmV3IGFycmF5IG9mIGNvZGUgcG9pbnRzLgoJCSAqLwoJCWZ1bmN0aW9uIHVjczJkZWNvZGUoc3RyaW5nKSB7CgkJCXZhciBvdXRwdXQgPSBbXSwKCQkJICAgIGNvdW50ZXIgPSAwLAoJCQkgICAgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aCwKCQkJICAgIHZhbHVlLAoJCQkgICAgZXh0cmE7CgkJCXdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7CgkJCQl2YWx1ZSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7CgkJCQlpZiAodmFsdWUgPj0gMHhEODAwICYmIHZhbHVlIDw9IDB4REJGRiAmJiBjb3VudGVyIDwgbGVuZ3RoKSB7CgkJCQkJLy8gaGlnaCBzdXJyb2dhdGUsIGFuZCB0aGVyZSBpcyBhIG5leHQgY2hhcmFjdGVyCgkJCQkJZXh0cmEgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspOwoJCQkJCWlmICgoZXh0cmEgJiAweEZDMDApID09IDB4REMwMCkgeyAvLyBsb3cgc3Vycm9nYXRlCgkJCQkJCW91dHB1dC5wdXNoKCgodmFsdWUgJiAweDNGRikgPDwgMTApICsgKGV4dHJhICYgMHgzRkYpICsgMHgxMDAwMCk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJLy8gdW5tYXRjaGVkIHN1cnJvZ2F0ZTsgb25seSBhcHBlbmQgdGhpcyBjb2RlIHVuaXQsIGluIGNhc2UgdGhlIG5leHQKCQkJCQkJLy8gY29kZSB1bml0IGlzIHRoZSBoaWdoIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyCgkJCQkJCW91dHB1dC5wdXNoKHZhbHVlKTsKCQkJCQkJY291bnRlci0tOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJb3V0cHV0LnB1c2godmFsdWUpOwoJCQkJfQoJCQl9CgkJCXJldHVybiBvdXRwdXQ7CgkJfQoKCQkvKioKCQkgKiBDcmVhdGVzIGEgc3RyaW5nIGJhc2VkIG9uIGFuIGFycmF5IG9mIG51bWVyaWMgY29kZSBwb2ludHMuCgkJICogQHNlZSBgcHVueWNvZGUudWNzMi5kZWNvZGVgCgkJICogQG1lbWJlck9mIHB1bnljb2RlLnVjczIKCQkgKiBAbmFtZSBlbmNvZGUKCQkgKiBAcGFyYW0ge0FycmF5fSBjb2RlUG9pbnRzIFRoZSBhcnJheSBvZiBudW1lcmljIGNvZGUgcG9pbnRzLgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBuZXcgVW5pY29kZSBzdHJpbmcgKFVDUy0yKS4KCQkgKi8KCQlmdW5jdGlvbiB1Y3MyZW5jb2RlKGFycmF5KSB7CgkJCXJldHVybiBtYXAoYXJyYXksIGZ1bmN0aW9uKHZhbHVlKSB7CgkJCQl2YXIgb3V0cHV0ID0gJyc7CgkJCQlpZiAodmFsdWUgPiAweEZGRkYpIHsKCQkJCQl2YWx1ZSAtPSAweDEwMDAwOwoJCQkJCW91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApOwoJCQkJCXZhbHVlID0gMHhEQzAwIHwgdmFsdWUgJiAweDNGRjsKCQkJCX0KCQkJCW91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUpOwoJCQkJcmV0dXJuIG91dHB1dDsKCQkJfSkuam9pbignJyk7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIGJhc2ljIGNvZGUgcG9pbnQgaW50byBhIGRpZ2l0L2ludGVnZXIuCgkJICogQHNlZSBgZGlnaXRUb0Jhc2ljKClgCgkJICogQHByaXZhdGUKCQkgKiBAcGFyYW0ge051bWJlcn0gY29kZVBvaW50IFRoZSBiYXNpYyBudW1lcmljIGNvZGUgcG9pbnQgdmFsdWUuCgkJICogQHJldHVybnMge051bWJlcn0gVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50IChmb3IgdXNlIGluCgkJICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpbiB0aGUgcmFuZ2UgYDBgIHRvIGBiYXNlIC0gMWAsIG9yIGBiYXNlYCBpZgoJCSAqIHRoZSBjb2RlIHBvaW50IGRvZXMgbm90IHJlcHJlc2VudCBhIHZhbHVlLgoJCSAqLwoJCWZ1bmN0aW9uIGJhc2ljVG9EaWdpdChjb2RlUG9pbnQpIHsKCQkJaWYgKGNvZGVQb2ludCAtIDQ4IDwgMTApIHsKCQkJCXJldHVybiBjb2RlUG9pbnQgLSAyMjsKCQkJfQoJCQlpZiAoY29kZVBvaW50IC0gNjUgPCAyNikgewoJCQkJcmV0dXJuIGNvZGVQb2ludCAtIDY1OwoJCQl9CgkJCWlmIChjb2RlUG9pbnQgLSA5NyA8IDI2KSB7CgkJCQlyZXR1cm4gY29kZVBvaW50IC0gOTc7CgkJCX0KCQkJcmV0dXJuIGJhc2U7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIGRpZ2l0L2ludGVnZXIgaW50byBhIGJhc2ljIGNvZGUgcG9pbnQuCgkJICogQHNlZSBgYmFzaWNUb0RpZ2l0KClgCgkJICogQHByaXZhdGUKCQkgKiBAcGFyYW0ge051bWJlcn0gZGlnaXQgVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50LgoJCSAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBiYXNpYyBjb2RlIHBvaW50IHdob3NlIHZhbHVlICh3aGVuIHVzZWQgZm9yCgkJICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpcyBgZGlnaXRgLCB3aGljaCBuZWVkcyB0byBiZSBpbiB0aGUgcmFuZ2UKCQkgKiBgMGAgdG8gYGJhc2UgLSAxYC4gSWYgYGZsYWdgIGlzIG5vbi16ZXJvLCB0aGUgdXBwZXJjYXNlIGZvcm0gaXMKCQkgKiB1c2VkOyBlbHNlLCB0aGUgbG93ZXJjYXNlIGZvcm0gaXMgdXNlZC4gVGhlIGJlaGF2aW9yIGlzIHVuZGVmaW5lZAoJCSAqIGlmIGBmbGFnYCBpcyBub24temVybyBhbmQgYGRpZ2l0YCBoYXMgbm8gdXBwZXJjYXNlIGZvcm0uCgkJICovCgkJZnVuY3Rpb24gZGlnaXRUb0Jhc2ljKGRpZ2l0LCBmbGFnKSB7CgkJCS8vICAwLi4yNSBtYXAgdG8gQVNDSUkgYS4ueiBvciBBLi5aCgkJCS8vIDI2Li4zNSBtYXAgdG8gQVNDSUkgMC4uOQoJCQlyZXR1cm4gZGlnaXQgKyAyMiArIDc1ICogKGRpZ2l0IDwgMjYpIC0gKChmbGFnICE9IDApIDw8IDUpOwoJCX0KCgkJLyoqCgkJICogQmlhcyBhZGFwdGF0aW9uIGZ1bmN0aW9uIGFzIHBlciBzZWN0aW9uIDMuNCBvZiBSRkMgMzQ5Mi4KCQkgKiBodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzNDkyI3NlY3Rpb24tMy40CgkJICogQHByaXZhdGUKCQkgKi8KCQlmdW5jdGlvbiBhZGFwdChkZWx0YSwgbnVtUG9pbnRzLCBmaXJzdFRpbWUpIHsKCQkJdmFyIGsgPSAwOwoJCQlkZWx0YSA9IGZpcnN0VGltZSA/IGZsb29yKGRlbHRhIC8gZGFtcCkgOiBkZWx0YSA+PiAxOwoJCQlkZWx0YSArPSBmbG9vcihkZWx0YSAvIG51bVBvaW50cyk7CgkJCWZvciAoLyogbm8gaW5pdGlhbGl6YXRpb24gKi87IGRlbHRhID4gYmFzZU1pbnVzVE1pbiAqIHRNYXggPj4gMTsgayArPSBiYXNlKSB7CgkJCQlkZWx0YSA9IGZsb29yKGRlbHRhIC8gYmFzZU1pbnVzVE1pbik7CgkJCX0KCQkJcmV0dXJuIGZsb29yKGsgKyAoYmFzZU1pbnVzVE1pbiArIDEpICogZGVsdGEgLyAoZGVsdGEgKyBza2V3KSk7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMgdG8gYSBzdHJpbmcgb2YgVW5pY29kZQoJCSAqIHN5bWJvbHMuCgkJICogQG1lbWJlck9mIHB1bnljb2RlCgkJICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSByZXN1bHRpbmcgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scy4KCQkgKi8KCQlmdW5jdGlvbiBkZWNvZGUoaW5wdXQpIHsKCQkJLy8gRG9uJ3QgdXNlIFVDUy0yCgkJCXZhciBvdXRwdXQgPSBbXSwKCQkJICAgIGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoLAoJCQkgICAgb3V0LAoJCQkgICAgaSA9IDAsCgkJCSAgICBuID0gaW5pdGlhbE4sCgkJCSAgICBiaWFzID0gaW5pdGlhbEJpYXMsCgkJCSAgICBiYXNpYywKCQkJICAgIGosCgkJCSAgICBpbmRleCwKCQkJICAgIG9sZGksCgkJCSAgICB3LAoJCQkgICAgaywKCQkJICAgIGRpZ2l0LAoJCQkgICAgdCwKCQkJICAgIC8qKiBDYWNoZWQgY2FsY3VsYXRpb24gcmVzdWx0cyAqLwoJCQkgICAgYmFzZU1pbnVzVDsKCgkJCS8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHM6IGxldCBgYmFzaWNgIGJlIHRoZSBudW1iZXIgb2YgaW5wdXQgY29kZQoJCQkvLyBwb2ludHMgYmVmb3JlIHRoZSBsYXN0IGRlbGltaXRlciwgb3IgYDBgIGlmIHRoZXJlIGlzIG5vbmUsIHRoZW4gY29weQoJCQkvLyB0aGUgZmlyc3QgYmFzaWMgY29kZSBwb2ludHMgdG8gdGhlIG91dHB1dC4KCgkJCWJhc2ljID0gaW5wdXQubGFzdEluZGV4T2YoZGVsaW1pdGVyKTsKCQkJaWYgKGJhc2ljIDwgMCkgewoJCQkJYmFzaWMgPSAwOwoJCQl9CgoJCQlmb3IgKGogPSAwOyBqIDwgYmFzaWM7ICsraikgewoJCQkJLy8gaWYgaXQncyBub3QgYSBiYXNpYyBjb2RlIHBvaW50CgkJCQlpZiAoaW5wdXQuY2hhckNvZGVBdChqKSA+PSAweDgwKSB7CgkJCQkJZXJyb3IoJ25vdC1iYXNpYycpOwoJCQkJfQoJCQkJb3V0cHV0LnB1c2goaW5wdXQuY2hhckNvZGVBdChqKSk7CgkJCX0KCgkJCS8vIE1haW4gZGVjb2RpbmcgbG9vcDogc3RhcnQganVzdCBhZnRlciB0aGUgbGFzdCBkZWxpbWl0ZXIgaWYgYW55IGJhc2ljIGNvZGUKCQkJLy8gcG9pbnRzIHdlcmUgY29waWVkOyBzdGFydCBhdCB0aGUgYmVnaW5uaW5nIG90aGVyd2lzZS4KCgkJCWZvciAoaW5kZXggPSBiYXNpYyA+IDAgPyBiYXNpYyArIDEgOiAwOyBpbmRleCA8IGlucHV0TGVuZ3RoOyAvKiBubyBmaW5hbCBleHByZXNzaW9uICovKSB7CgoJCQkJLy8gYGluZGV4YCBpcyB0aGUgaW5kZXggb2YgdGhlIG5leHQgY2hhcmFjdGVyIHRvIGJlIGNvbnN1bWVkLgoJCQkJLy8gRGVjb2RlIGEgZ2VuZXJhbGl6ZWQgdmFyaWFibGUtbGVuZ3RoIGludGVnZXIgaW50byBgZGVsdGFgLAoJCQkJLy8gd2hpY2ggZ2V0cyBhZGRlZCB0byBgaWAuIFRoZSBvdmVyZmxvdyBjaGVja2luZyBpcyBlYXNpZXIKCQkJCS8vIGlmIHdlIGluY3JlYXNlIGBpYCBhcyB3ZSBnbywgdGhlbiBzdWJ0cmFjdCBvZmYgaXRzIHN0YXJ0aW5nCgkJCQkvLyB2YWx1ZSBhdCB0aGUgZW5kIHRvIG9idGFpbiBgZGVsdGFgLgoJCQkJZm9yIChvbGRpID0gaSwgdyA9IDEsIGsgPSBiYXNlOyAvKiBubyBjb25kaXRpb24gKi87IGsgKz0gYmFzZSkgewoKCQkJCQlpZiAoaW5kZXggPj0gaW5wdXRMZW5ndGgpIHsKCQkJCQkJZXJyb3IoJ2ludmFsaWQtaW5wdXQnKTsKCQkJCQl9CgoJCQkJCWRpZ2l0ID0gYmFzaWNUb0RpZ2l0KGlucHV0LmNoYXJDb2RlQXQoaW5kZXgrKykpOwoKCQkJCQlpZiAoZGlnaXQgPj0gYmFzZSB8fCBkaWdpdCA+IGZsb29yKChtYXhJbnQgLSBpKSAvIHcpKSB7CgkJCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQkJCX0KCgkJCQkJaSArPSBkaWdpdCAqIHc7CgkJCQkJdCA9IGsgPD0gYmlhcyA/IHRNaW4gOiAoayA+PSBiaWFzICsgdE1heCA/IHRNYXggOiBrIC0gYmlhcyk7CgoJCQkJCWlmIChkaWdpdCA8IHQpIHsKCQkJCQkJYnJlYWs7CgkJCQkJfQoKCQkJCQliYXNlTWludXNUID0gYmFzZSAtIHQ7CgkJCQkJaWYgKHcgPiBmbG9vcihtYXhJbnQgLyBiYXNlTWludXNUKSkgewoJCQkJCQllcnJvcignb3ZlcmZsb3cnKTsKCQkJCQl9CgoJCQkJCXcgKj0gYmFzZU1pbnVzVDsKCgkJCQl9CgoJCQkJb3V0ID0gb3V0cHV0Lmxlbmd0aCArIDE7CgkJCQliaWFzID0gYWRhcHQoaSAtIG9sZGksIG91dCwgb2xkaSA9PSAwKTsKCgkJCQkvLyBgaWAgd2FzIHN1cHBvc2VkIHRvIHdyYXAgYXJvdW5kIGZyb20gYG91dGAgdG8gYDBgLAoJCQkJLy8gaW5jcmVtZW50aW5nIGBuYCBlYWNoIHRpbWUsIHNvIHdlJ2xsIGZpeCB0aGF0IG5vdzoKCQkJCWlmIChmbG9vcihpIC8gb3V0KSA+IG1heEludCAtIG4pIHsKCQkJCQllcnJvcignb3ZlcmZsb3cnKTsKCQkJCX0KCgkJCQluICs9IGZsb29yKGkgLyBvdXQpOwoJCQkJaSAlPSBvdXQ7CgoJCQkJLy8gSW5zZXJ0IGBuYCBhdCBwb3NpdGlvbiBgaWAgb2YgdGhlIG91dHB1dAoJCQkJb3V0cHV0LnNwbGljZShpKyssIDAsIG4pOwoKCQkJfQoKCQkJcmV0dXJuIHVjczJlbmNvZGUob3V0cHV0KTsKCQl9CgoJCS8qKgoJCSAqIENvbnZlcnRzIGEgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scyAoZS5nLiBhIGRvbWFpbiBuYW1lIGxhYmVsKSB0byBhCgkJICogUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy4KCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUKCQkgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMuCgkJICogQHJldHVybnMge1N0cmluZ30gVGhlIHJlc3VsdGluZyBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLgoJCSAqLwoJCWZ1bmN0aW9uIGVuY29kZShpbnB1dCkgewoJCQl2YXIgbiwKCQkJICAgIGRlbHRhLAoJCQkgICAgaGFuZGxlZENQQ291bnQsCgkJCSAgICBiYXNpY0xlbmd0aCwKCQkJICAgIGJpYXMsCgkJCSAgICBqLAoJCQkgICAgbSwKCQkJICAgIHEsCgkJCSAgICBrLAoJCQkgICAgdCwKCQkJICAgIGN1cnJlbnRWYWx1ZSwKCQkJICAgIG91dHB1dCA9IFtdLAoJCQkgICAgLyoqIGBpbnB1dExlbmd0aGAgd2lsbCBob2xkIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgaW4gYGlucHV0YC4gKi8KCQkJICAgIGlucHV0TGVuZ3RoLAoJCQkgICAgLyoqIENhY2hlZCBjYWxjdWxhdGlvbiByZXN1bHRzICovCgkJCSAgICBoYW5kbGVkQ1BDb3VudFBsdXNPbmUsCgkJCSAgICBiYXNlTWludXNULAoJCQkgICAgcU1pbnVzVDsKCgkJCS8vIENvbnZlcnQgdGhlIGlucHV0IGluIFVDUy0yIHRvIFVuaWNvZGUKCQkJaW5wdXQgPSB1Y3MyZGVjb2RlKGlucHV0KTsKCgkJCS8vIENhY2hlIHRoZSBsZW5ndGgKCQkJaW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGg7CgoJCQkvLyBJbml0aWFsaXplIHRoZSBzdGF0ZQoJCQluID0gaW5pdGlhbE47CgkJCWRlbHRhID0gMDsKCQkJYmlhcyA9IGluaXRpYWxCaWFzOwoKCQkJLy8gSGFuZGxlIHRoZSBiYXNpYyBjb2RlIHBvaW50cwoJCQlmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikgewoJCQkJY3VycmVudFZhbHVlID0gaW5wdXRbal07CgkJCQlpZiAoY3VycmVudFZhbHVlIDwgMHg4MCkgewoJCQkJCW91dHB1dC5wdXNoKHN0cmluZ0Zyb21DaGFyQ29kZShjdXJyZW50VmFsdWUpKTsKCQkJCX0KCQkJfQoKCQkJaGFuZGxlZENQQ291bnQgPSBiYXNpY0xlbmd0aCA9IG91dHB1dC5sZW5ndGg7CgoJCQkvLyBgaGFuZGxlZENQQ291bnRgIGlzIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgdGhhdCBoYXZlIGJlZW4gaGFuZGxlZDsKCQkJLy8gYGJhc2ljTGVuZ3RoYCBpcyB0aGUgbnVtYmVyIG9mIGJhc2ljIGNvZGUgcG9pbnRzLgoKCQkJLy8gRmluaXNoIHRoZSBiYXNpYyBzdHJpbmcgLSBpZiBpdCBpcyBub3QgZW1wdHkgLSB3aXRoIGEgZGVsaW1pdGVyCgkJCWlmIChiYXNpY0xlbmd0aCkgewoJCQkJb3V0cHV0LnB1c2goZGVsaW1pdGVyKTsKCQkJfQoKCQkJLy8gTWFpbiBlbmNvZGluZyBsb29wOgoJCQl3aGlsZSAoaGFuZGxlZENQQ291bnQgPCBpbnB1dExlbmd0aCkgewoKCQkJCS8vIEFsbCBub24tYmFzaWMgY29kZSBwb2ludHMgPCBuIGhhdmUgYmVlbiBoYW5kbGVkIGFscmVhZHkuIEZpbmQgdGhlIG5leHQKCQkJCS8vIGxhcmdlciBvbmU6CgkJCQlmb3IgKG0gPSBtYXhJbnQsIGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikgewoJCQkJCWN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdOwoJCQkJCWlmIChjdXJyZW50VmFsdWUgPj0gbiAmJiBjdXJyZW50VmFsdWUgPCBtKSB7CgkJCQkJCW0gPSBjdXJyZW50VmFsdWU7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIEluY3JlYXNlIGBkZWx0YWAgZW5vdWdoIHRvIGFkdmFuY2UgdGhlIGRlY29kZXIncyA8bixpPiBzdGF0ZSB0byA8bSwwPiwKCQkJCS8vIGJ1dCBndWFyZCBhZ2FpbnN0IG92ZXJmbG93CgkJCQloYW5kbGVkQ1BDb3VudFBsdXNPbmUgPSBoYW5kbGVkQ1BDb3VudCArIDE7CgkJCQlpZiAobSAtIG4gPiBmbG9vcigobWF4SW50IC0gZGVsdGEpIC8gaGFuZGxlZENQQ291bnRQbHVzT25lKSkgewoJCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQkJfQoKCQkJCWRlbHRhICs9IChtIC0gbikgKiBoYW5kbGVkQ1BDb3VudFBsdXNPbmU7CgkJCQluID0gbTsKCgkJCQlmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikgewoJCQkJCWN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdOwoKCQkJCQlpZiAoY3VycmVudFZhbHVlIDwgbiAmJiArK2RlbHRhID4gbWF4SW50KSB7CgkJCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQkJCX0KCgkJCQkJaWYgKGN1cnJlbnRWYWx1ZSA9PSBuKSB7CgkJCQkJCS8vIFJlcHJlc2VudCBkZWx0YSBhcyBhIGdlbmVyYWxpemVkIHZhcmlhYmxlLWxlbmd0aCBpbnRlZ2VyCgkJCQkJCWZvciAocSA9IGRlbHRhLCBrID0gYmFzZTsgLyogbm8gY29uZGl0aW9uICovOyBrICs9IGJhc2UpIHsKCQkJCQkJCXQgPSBrIDw9IGJpYXMgPyB0TWluIDogKGsgPj0gYmlhcyArIHRNYXggPyB0TWF4IDogayAtIGJpYXMpOwoJCQkJCQkJaWYgKHEgPCB0KSB7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQl9CgkJCQkJCQlxTWludXNUID0gcSAtIHQ7CgkJCQkJCQliYXNlTWludXNUID0gYmFzZSAtIHQ7CgkJCQkJCQlvdXRwdXQucHVzaCgKCQkJCQkJCQlzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHQgKyBxTWludXNUICUgYmFzZU1pbnVzVCwgMCkpCgkJCQkJCQkpOwoJCQkJCQkJcSA9IGZsb29yKHFNaW51c1QgLyBiYXNlTWludXNUKTsKCQkJCQkJfQoKCQkJCQkJb3V0cHV0LnB1c2goc3RyaW5nRnJvbUNoYXJDb2RlKGRpZ2l0VG9CYXNpYyhxLCAwKSkpOwoJCQkJCQliaWFzID0gYWRhcHQoZGVsdGEsIGhhbmRsZWRDUENvdW50UGx1c09uZSwgaGFuZGxlZENQQ291bnQgPT0gYmFzaWNMZW5ndGgpOwoJCQkJCQlkZWx0YSA9IDA7CgkJCQkJCSsraGFuZGxlZENQQ291bnQ7CgkJCQkJfQoJCQkJfQoKCQkJCSsrZGVsdGE7CgkJCQkrK247CgoJCQl9CgkJCXJldHVybiBvdXRwdXQuam9pbignJyk7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSBvciBhbiBlbWFpbCBhZGRyZXNzCgkJICogdG8gVW5pY29kZS4gT25seSB0aGUgUHVueWNvZGVkIHBhcnRzIG9mIHRoZSBpbnB1dCB3aWxsIGJlIGNvbnZlcnRlZCwgaS5lLgoJCSAqIGl0IGRvZXNuJ3QgbWF0dGVyIGlmIHlvdSBjYWxsIGl0IG9uIGEgc3RyaW5nIHRoYXQgaGFzIGFscmVhZHkgYmVlbgoJCSAqIGNvbnZlcnRlZCB0byBVbmljb2RlLgoJCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgUHVueWNvZGVkIGRvbWFpbiBuYW1lIG9yIGVtYWlsIGFkZHJlc3MgdG8KCQkgKiBjb252ZXJ0IHRvIFVuaWNvZGUuCgkJICogQHJldHVybnMge1N0cmluZ30gVGhlIFVuaWNvZGUgcmVwcmVzZW50YXRpb24gb2YgdGhlIGdpdmVuIFB1bnljb2RlCgkJICogc3RyaW5nLgoJCSAqLwoJCWZ1bmN0aW9uIHRvVW5pY29kZShpbnB1dCkgewoJCQlyZXR1cm4gbWFwRG9tYWluKGlucHV0LCBmdW5jdGlvbihzdHJpbmcpIHsKCQkJCXJldHVybiByZWdleFB1bnljb2RlLnRlc3Qoc3RyaW5nKQoJCQkJCT8gZGVjb2RlKHN0cmluZy5zbGljZSg0KS50b0xvd2VyQ2FzZSgpKQoJCQkJCTogc3RyaW5nOwoJCQl9KTsKCQl9CgoJCS8qKgoJCSAqIENvbnZlcnRzIGEgVW5pY29kZSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgZG9tYWluIG5hbWUgb3IgYW4gZW1haWwgYWRkcmVzcyB0bwoJCSAqIFB1bnljb2RlLiBPbmx5IHRoZSBub24tQVNDSUkgcGFydHMgb2YgdGhlIGRvbWFpbiBuYW1lIHdpbGwgYmUgY29udmVydGVkLAoJCSAqIGkuZS4gaXQgZG9lc24ndCBtYXR0ZXIgaWYgeW91IGNhbGwgaXQgd2l0aCBhIGRvbWFpbiB0aGF0J3MgYWxyZWFkeSBpbgoJCSAqIEFTQ0lJLgoJCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcyB0byBjb252ZXJ0LCBhcyBhCgkJICogVW5pY29kZSBzdHJpbmcuCgkJICogQHJldHVybnMge1N0cmluZ30gVGhlIFB1bnljb2RlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBkb21haW4gbmFtZSBvcgoJCSAqIGVtYWlsIGFkZHJlc3MuCgkJICovCgkJZnVuY3Rpb24gdG9BU0NJSShpbnB1dCkgewoJCQlyZXR1cm4gbWFwRG9tYWluKGlucHV0LCBmdW5jdGlvbihzdHJpbmcpIHsKCQkJCXJldHVybiByZWdleE5vbkFTQ0lJLnRlc3Qoc3RyaW5nKQoJCQkJCT8gJ3huLS0nICsgZW5jb2RlKHN0cmluZykKCQkJCQk6IHN0cmluZzsKCQkJfSk7CgkJfQoKCQkvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCgkJLyoqIERlZmluZSB0aGUgcHVibGljIEFQSSAqLwoJCXB1bnljb2RlID0gewoJCQkvKioKCQkJICogQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBjdXJyZW50IFB1bnljb2RlLmpzIHZlcnNpb24gbnVtYmVyLgoJCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUKCQkJICogQHR5cGUgU3RyaW5nCgkJCSAqLwoJCQkndmVyc2lvbic6ICcxLjMuMicsCgkJCS8qKgoJCQkgKiBBbiBvYmplY3Qgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGZyb20gSmF2YVNjcmlwdCdzIGludGVybmFsIGNoYXJhY3RlcgoJCQkgKiByZXByZXNlbnRhdGlvbiAoVUNTLTIpIHRvIFVuaWNvZGUgY29kZSBwb2ludHMsIGFuZCBiYWNrLgoJCQkgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz4KCQkJICogQG1lbWJlck9mIHB1bnljb2RlCgkJCSAqIEB0eXBlIE9iamVjdAoJCQkgKi8KCQkJJ3VjczInOiB7CgkJCQknZGVjb2RlJzogdWNzMmRlY29kZSwKCQkJCSdlbmNvZGUnOiB1Y3MyZW5jb2RlCgkJCX0sCgkJCSdkZWNvZGUnOiBkZWNvZGUsCgkJCSdlbmNvZGUnOiBlbmNvZGUsCgkJCSd0b0FTQ0lJJzogdG9BU0NJSSwKCQkJJ3RvVW5pY29kZSc6IHRvVW5pY29kZQoJCX07CgoJCS8qKiBFeHBvc2UgYHB1bnljb2RlYCAqLwoJCS8vIFNvbWUgQU1EIGJ1aWxkIG9wdGltaXplcnMsIGxpa2Ugci5qcywgY2hlY2sgZm9yIHNwZWNpZmljIGNvbmRpdGlvbiBwYXR0ZXJucwoJCS8vIGxpa2UgdGhlIGZvbGxvd2luZzoKCQlpZiAoCgkJCXRydWUKCQkpIHsKCQkJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCkgewoJCQkJcmV0dXJuIHB1bnljb2RlOwoJCQl9LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXywgZXhwb3J0cywgbW9kdWxlKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpOwoJCX0gZWxzZSBpZiAoZnJlZUV4cG9ydHMgJiYgZnJlZU1vZHVsZSkgewoJCQlpZiAobW9kdWxlLmV4cG9ydHMgPT0gZnJlZUV4cG9ydHMpIHsgLy8gaW4gTm9kZS5qcyBvciBSaW5nb0pTIHYwLjguMCsKCQkJCWZyZWVNb2R1bGUuZXhwb3J0cyA9IHB1bnljb2RlOwoJCQl9IGVsc2UgeyAvLyBpbiBOYXJ3aGFsIG9yIFJpbmdvSlMgdjAuNy4wLQoJCQkJZm9yIChrZXkgaW4gcHVueWNvZGUpIHsKCQkJCQlwdW55Y29kZS5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIChmcmVlRXhwb3J0c1trZXldID0gcHVueWNvZGVba2V5XSk7CgkJCQl9CgkJCX0KCQl9IGVsc2UgeyAvLyBpbiBSaGlubyBvciBhIHdlYiBicm93c2VyCgkJCXJvb3QucHVueWNvZGUgPSBwdW55Y29kZTsKCQl9CgoJfSh0aGlzKSk7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oNDApKG1vZHVsZSksIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKQoKLyoqKi8gfSwKLyogNDAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtb2R1bGUpIHsNCgkJaWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHsNCgkJCW1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9Ow0KCQkJbW9kdWxlLnBhdGhzID0gW107DQoJCQkvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHQNCgkJCW1vZHVsZS5jaGlsZHJlbiA9IFtdOw0KCQkJbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7DQoJCX0NCgkJcmV0dXJuIG1vZHVsZTsNCgl9DQoKCi8qKiovIH0sCi8qIDQxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JzsKCgltb2R1bGUuZXhwb3J0cyA9IHsKCSAgaXNTdHJpbmc6IGZ1bmN0aW9uKGFyZykgewoJICAgIHJldHVybiB0eXBlb2YoYXJnKSA9PT0gJ3N0cmluZyc7CgkgIH0sCgkgIGlzT2JqZWN0OiBmdW5jdGlvbihhcmcpIHsKCSAgICByZXR1cm4gdHlwZW9mKGFyZykgPT09ICdvYmplY3QnICYmIGFyZyAhPT0gbnVsbDsKCSAgfSwKCSAgaXNOdWxsOiBmdW5jdGlvbihhcmcpIHsKCSAgICByZXR1cm4gYXJnID09PSBudWxsOwoJICB9LAoJICBpc051bGxPclVuZGVmaW5lZDogZnVuY3Rpb24oYXJnKSB7CgkgICAgcmV0dXJuIGFyZyA9PSBudWxsOwoJICB9Cgl9OwoKCi8qKiovIH0sCi8qIDQyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglleHBvcnRzLmRlY29kZSA9IGV4cG9ydHMucGFyc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQzKTsKCWV4cG9ydHMuZW5jb2RlID0gZXhwb3J0cy5zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ0KTsKCgovKioqLyB9LAovKiA0MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCSd1c2Ugc3RyaWN0JzsKCgkvLyBJZiBvYmouaGFzT3duUHJvcGVydHkgaGFzIGJlZW4gb3ZlcnJpZGRlbiwgdGhlbiBjYWxsaW5nCgkvLyBvYmouaGFzT3duUHJvcGVydHkocHJvcCkgd2lsbCBicmVhay4KCS8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2pveWVudC9ub2RlL2lzc3Vlcy8xNzA3CglmdW5jdGlvbiBoYXNPd25Qcm9wZXJ0eShvYmosIHByb3ApIHsKCSAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApOwoJfQoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocXMsIHNlcCwgZXEsIG9wdGlvbnMpIHsKCSAgc2VwID0gc2VwIHx8ICcmJzsKCSAgZXEgPSBlcSB8fCAnPSc7CgkgIHZhciBvYmogPSB7fTsKCgkgIGlmICh0eXBlb2YgcXMgIT09ICdzdHJpbmcnIHx8IHFzLmxlbmd0aCA9PT0gMCkgewoJICAgIHJldHVybiBvYmo7CgkgIH0KCgkgIHZhciByZWdleHAgPSAvXCsvZzsKCSAgcXMgPSBxcy5zcGxpdChzZXApOwoKCSAgdmFyIG1heEtleXMgPSAxMDAwOwoJICBpZiAob3B0aW9ucyAmJiB0eXBlb2Ygb3B0aW9ucy5tYXhLZXlzID09PSAnbnVtYmVyJykgewoJICAgIG1heEtleXMgPSBvcHRpb25zLm1heEtleXM7CgkgIH0KCgkgIHZhciBsZW4gPSBxcy5sZW5ndGg7CgkgIC8vIG1heEtleXMgPD0gMCBtZWFucyB0aGF0IHdlIHNob3VsZCBub3QgbGltaXQga2V5cyBjb3VudAoJICBpZiAobWF4S2V5cyA+IDAgJiYgbGVuID4gbWF4S2V5cykgewoJICAgIGxlbiA9IG1heEtleXM7CgkgIH0KCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHsKCSAgICB2YXIgeCA9IHFzW2ldLnJlcGxhY2UocmVnZXhwLCAnJTIwJyksCgkgICAgICAgIGlkeCA9IHguaW5kZXhPZihlcSksCgkgICAgICAgIGtzdHIsIHZzdHIsIGssIHY7CgoJICAgIGlmIChpZHggPj0gMCkgewoJICAgICAga3N0ciA9IHguc3Vic3RyKDAsIGlkeCk7CgkgICAgICB2c3RyID0geC5zdWJzdHIoaWR4ICsgMSk7CgkgICAgfSBlbHNlIHsKCSAgICAgIGtzdHIgPSB4OwoJICAgICAgdnN0ciA9ICcnOwoJICAgIH0KCgkgICAgayA9IGRlY29kZVVSSUNvbXBvbmVudChrc3RyKTsKCSAgICB2ID0gZGVjb2RlVVJJQ29tcG9uZW50KHZzdHIpOwoKCSAgICBpZiAoIWhhc093blByb3BlcnR5KG9iaiwgaykpIHsKCSAgICAgIG9ialtrXSA9IHY7CgkgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KG9ialtrXSkpIHsKCSAgICAgIG9ialtrXS5wdXNoKHYpOwoJICAgIH0gZWxzZSB7CgkgICAgICBvYmpba10gPSBbb2JqW2tdLCB2XTsKCSAgICB9CgkgIH0KCgkgIHJldHVybiBvYmo7Cgl9OwoKCi8qKiovIH0sCi8qIDQ0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLgoJLy8KCS8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCgkvLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCgkvLyAiU29mdHdhcmUiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nCgkvLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCgkvLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0CgkvLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUKCS8vIGZvbGxvd2luZyBjb25kaXRpb25zOgoJLy8KCS8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkCgkvLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCS8vCgkvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUwoJLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgoJLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTgoJLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sCgkvLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKCS8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUKCS8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCgoJJ3VzZSBzdHJpY3QnOwoKCXZhciBzdHJpbmdpZnlQcmltaXRpdmUgPSBmdW5jdGlvbih2KSB7CgkgIHN3aXRjaCAodHlwZW9mIHYpIHsKCSAgICBjYXNlICdzdHJpbmcnOgoJICAgICAgcmV0dXJuIHY7CgoJICAgIGNhc2UgJ2Jvb2xlYW4nOgoJICAgICAgcmV0dXJuIHYgPyAndHJ1ZScgOiAnZmFsc2UnOwoKCSAgICBjYXNlICdudW1iZXInOgoJICAgICAgcmV0dXJuIGlzRmluaXRlKHYpID8gdiA6ICcnOwoKCSAgICBkZWZhdWx0OgoJICAgICAgcmV0dXJuICcnOwoJICB9Cgl9OwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqLCBzZXAsIGVxLCBuYW1lKSB7CgkgIHNlcCA9IHNlcCB8fCAnJic7CgkgIGVxID0gZXEgfHwgJz0nOwoJICBpZiAob2JqID09PSBudWxsKSB7CgkgICAgb2JqID0gdW5kZWZpbmVkOwoJICB9CgoJICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHsKCSAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5tYXAoZnVuY3Rpb24oaykgewoJICAgICAgdmFyIGtzID0gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShrKSkgKyBlcTsKCSAgICAgIGlmIChBcnJheS5pc0FycmF5KG9ialtrXSkpIHsKCSAgICAgICAgcmV0dXJuIG9ialtrXS5tYXAoZnVuY3Rpb24odikgewoJICAgICAgICAgIHJldHVybiBrcyArIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUodikpOwoJICAgICAgICB9KS5qb2luKHNlcCk7CgkgICAgICB9IGVsc2UgewoJICAgICAgICByZXR1cm4ga3MgKyBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG9ialtrXSkpOwoJICAgICAgfQoJICAgIH0pLmpvaW4oc2VwKTsKCgkgIH0KCgkgIGlmICghbmFtZSkgcmV0dXJuICcnOwoJICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShuYW1lKSkgKyBlcSArCgkgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG9iaikpOwoJfTsKCgovKioqLyB9LAovKiA0NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgaHR0cCA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKCXZhciBodHRwcyA9IG1vZHVsZS5leHBvcnRzOwoKCWZvciAodmFyIGtleSBpbiBodHRwKSB7CgkgICAgaWYgKGh0dHAuaGFzT3duUHJvcGVydHkoa2V5KSkgaHR0cHNba2V5XSA9IGh0dHBba2V5XTsKCX07CgoJaHR0cHMucmVxdWVzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNiKSB7CgkgICAgaWYgKCFwYXJhbXMpIHBhcmFtcyA9IHt9OwoJICAgIHBhcmFtcy5zY2hlbWUgPSAnaHR0cHMnOwoJICAgIHBhcmFtcy5wcm90b2NvbCA9ICdodHRwczonOwoJICAgIHJldHVybiBodHRwLnJlcXVlc3QuY2FsbCh0aGlzLCBwYXJhbXMsIGNiKTsKCX0KCgovKioqLyB9LAovKiA0NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oQnVmZmVyKSB7dmFyIHFzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MikKCXZhciBodHRwID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCkKCXZhciBodHRwcyA9IF9fd2VicGFja19yZXF1aXJlX18oNDUpCgl2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXygzOCkKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIF93cml0ZShodHRwTWV0aG9kLCBvcHRpb25zLCBjYWxsYmFjaykgewoKCSAgLy8gcmVxdWlyZSBvcHRpb25zLnVybCBvciBmYWlsIG5vaXNpbHkgCgkgIGlmICghb3B0aW9ucy51cmwpIHsKCSAgICB0aHJvdyBFcnJvcignb3B0aW9ucy51cmwgcmVxdWlyZWQnKQoJICB9CgoJICAvLyBwYXJzZSBvdXQgdGhlIG9wdGlvbnMgZnJvbSBvcHRpb25zLnVybAoJICB2YXIgb3B0cyA9IHVybC5wYXJzZShvcHRpb25zLnVybCkKCSAgdmFyIG1ldGhvZCA9IG9wdHMucHJvdG9jb2wgPT09ICdodHRwczonPyBodHRwcy5yZXF1ZXN0IDogaHR0cC5yZXF1ZXN0CgkgIHZhciBkZWZhdWx0Q29udGVudFR5cGUgPSAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcKCgkgIC8vIHB1dCB0aGUgcGFyYW1zIG9uIHRoZSBxdWVyeSBhcyB3ZWxsIGFzIHRoZSBib2R5PwoJICBpZiAoaHR0cE1ldGhvZCA9PT0gJ0RFTEVURScgJiYgb3B0aW9ucy5kYXRhKSB7CgkgICAgdmFyIGlzU2VhcmNoID0gISFvcHRzLnNlYXJjaAoJICAgIG9wdGlvbnMudXJsICs9IChpc1NlYXJjaD8gJyYnIDogJz8nKSArIHFzLnN0cmluZ2lmeShvcHRpb25zLmRhdGEpCgkgICAgb3B0cyA9IHVybC5wYXJzZShvcHRpb25zLnVybCkKCSAgfQoKCSAgb3B0cy5tZXRob2QgPSBodHRwTWV0aG9kCgkgIG9wdHMucmVqZWN0VW5hdXRob3JpemVkID0gZmFsc2UKCSAgb3B0cy5hZ2VudCA9IGZhbHNlCgkgIG9wdHMuaGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycyB8fCB7fQoJICBvcHRzLmhlYWRlcnNbJ1VzZXItQWdlbnQnXSA9IG9wdHMuaGVhZGVyc1snVXNlci1BZ2VudCddIHx8ICd0aW55LWh0dHAnCgkgIG9wdHMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSBvcHRzLmhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddIHx8IGRlZmF1bHRDb250ZW50VHlwZQoJICB2YXIgcmVxSlNPTiA9IG9wdHMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10uc3RhcnRzV2l0aCgnYXBwbGljYXRpb24vanNvbicpCgkgIHZhciBwb3N0RGF0YSA9IHJlcUpTT04/IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMuZGF0YSB8fCB7fSkgOiBxcy5zdHJpbmdpZnkob3B0aW9ucy5kYXRhIHx8IHt9KQoKCSAgLy8gbWFrZSBhIFBPU1QgcmVxdWVzdAoJICB2YXIgcmVxID0gbWV0aG9kKG9wdHMsIGZ1bmN0aW9uKHJlcykgewoJICAgCgkgICAgdmFyIHJhdyA9IFtdIC8vIGtlZXAgb3VyIGJ1ZmZlcnMgaGVyZQoJICAgIHZhciBvayA9IHJlcy5zdGF0dXNDb2RlID49IDIwMCAmJiByZXMuc3RhdHVzQ29kZSA8IDMwMAoKCSAgICBpZiAoIW9rKSB7CgkgICAgICBjYWxsYmFjayhFcnJvcihodHRwTWV0aG9kICsgJyBmYWlsZWQgd2l0aDogJyArIHJlcy5zdGF0dXNDb2RlKSkKCSAgICAgIHJlcy5yZXN1bWUoKQoJICAgICAgcmV0dXJuCgkgICAgfQoJIAoJICAgIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIF9fZGF0YShjaHVuaykgeyAKCSAgICAgIHJhdy5wdXNoKGNodW5rKSAKCSAgICB9KQoKCSAgICByZXMub24oJ2VuZCcsIGZ1bmN0aW9uIF9fZW5kKCkgewoJICAgICAgdmFyIGVyciA9IG51bGwKCSAgICAgIHZhciByZXN1bHQgPSBudWxsCgkgICAgICB0cnkgewoJICAgICAgICB2YXIgaXNKU09OID0gcmVzLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddLnN0YXJ0c1dpdGgoJ2FwcGxpY2F0aW9uL2pzb24nKQoJICAgICAgICB2YXIgcmF3RGF0YSA9IEJ1ZmZlci5jb25jYXQocmF3KS50b1N0cmluZygpCgkgICAgICAgIHJlc3VsdCA9IGlzSlNPTj8gSlNPTi5wYXJzZShyYXdEYXRhKSA6IHJhd0RhdGEKCSAgICAgIH0gCgkgICAgICBjYXRjaCAoZSkgewoJICAgICAgICBlcnIgPSBlCgkgICAgICB9CgkgICAgICBjYWxsYmFjayhlcnIsIHtib2R5OnJlc3VsdCwgaGVhZGVyczpyZXMuaGVhZGVyc30pCgkgICAgfSkKCSAgfSkKCgkgIHJlcS5vbignZXJyb3InLCBjYWxsYmFjaykKCgkgIHJlcS53cml0ZShwb3N0RGF0YSkKCSAKCSAgcmVxLmVuZCgpCgl9CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oNikuQnVmZmVyKSkKCi8qKiovIH0sCi8qIDQ3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHZhbGlkYXRlOwoKCXZhciBfYXBpID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OCk7CgoJdmFyIF9hcGkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXBpKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWZ1bmN0aW9uIHZhbGlkYXRlKG1ldGhvZCwgcGFyYW1zKSB7CgkgIC8vIGdldCBhbGwgdGhlIHJlcXVyaWVkIHBhcmFtcyBmb3IgdGhpcyBtZXRob2QKCSAgdmFyIHJlcXVpcmVkID0gX2FwaTIuZGVmYXVsdFttZXRob2RdLmZpbHRlcihmdW5jdGlvbiAocGFyYW0pIHsKCSAgICByZXR1cm4gcGFyYW0ucmVxdWlyZWQgPT09ICdSZXF1aXJlZCc7CgkgIH0pOwoJICAvLyBjb2xsZWN0IGFueSBtaXNzaW5nIHBhcmFtcwoJICB2YXIgbWlzc2luZyA9IHJlcXVpcmVkLmZpbHRlcihmdW5jdGlvbiAocGFyYW0pIHsKCSAgICByZXR1cm4gdHlwZW9mIHBhcmFtc1twYXJhbS5uYW1lXSA9PT0gJ3VuZGVmaW5lZCc7CgkgIH0pOwoJICAvLyBvcHRpbWlzaXRjYWxseSBhc3N1bWUgdGhlIGJlc3QKCSAgdmFyIGVyciA9IGZhbHNlOwoJICAvLyBidXQgaGF2ZSBhIHBsYW4gZm9yIHRoZSB3b3JzdAoJICBpZiAobWlzc2luZy5sZW5ndGgpIHsKCSAgICB2YXIgYnVsbGV0cyA9IG1pc3NpbmcubWFwKGZ1bmN0aW9uIChwYXJhbSkgewoJICAgICAgcmV0dXJuICctICcgKyBwYXJhbS5uYW1lICsgJyAuLi4gJyArIHBhcmFtLmRlc2NyaXB0aW9uOwoJICAgIH0pOwoJICAgIHZhciBtc2cgPSBtZXRob2QgKyAnIG1pc3NpbmcgcGFyYW1zOlxuJyArIGJ1bGxldHMuam9pbignXG4nKTsKCSAgICBlcnIgPSBFcnJvcihtc2cpOwoJICB9CgkgIHJldHVybiBlcnI7Cgl9IC8vCgkvLyB2YWxpZGF0ZSByZXR1cm5zIGFuIGVycm9yIG9iamVjdCBpZiBhbnkgcmVxdWlyZWQgcGFyYW1zIGFyZSBtaXNzaW5nCgkvLwoJLy8gZXhhbXBsZSB1c2FnZToKCS8vIAoJLy8gICAvLyB0b2tlbiBhbmQgaWQgYXJlIHJlcXVpcmVkIHBhcmFtcwoJLy8gICBmdW5jdGlvbiBhcGlDYWxsKHBhcmFtcywgY2FsbGJhY2spIHsgCgkvLyAgICAgbGV0IGVyciA9IHZhbGlkYXRlKCdhcGkuc2lnbmF0dXJlJywgcGFyYW1zKQoJLy8gICAgIGlmIChlcnIpIHsKCS8vICAgICAgIGNhbGxiYWNrKGVycikKCS8vICAgICB9CgkvLyAgICAgZWxzZSB7CgkvLyAgICAgICAvLyBkbyBhcGkgY2FsbAoJLy8gICAgIH0KCS8vICAgfQoJLy8KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogNDggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7CgkJImFwaS50ZXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJlcnJvciIsCgkJCQkiZXhhbXBsZSI6ICJteV9lcnJvciIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkVycm9yIHJlc3BvbnNlIHRvIHJldHVyblxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmb28iLAoJCQkJImV4YW1wbGUiOiAiYmFyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiZXhhbXBsZSBwcm9wZXJ0eSB0byByZXR1cm5cbiIKCQkJfQoJCV0sCgkJImF1dGgucmV2b2tlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRlc3QiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlNldHRpbmcgdGhpcyBwYXJhbWV0ZXIgdG8gMSB0cmlnZ2VycyBhIHRlc3RpbmcgbW9kZSB3aGVyZSB0aGUgc3BlY2lmaWVkIHRva2VuIHdpbGwgbm90IGFjdHVhbGx5IGJlIHJldm9rZWQuXG4iCgkJCX0KCQldLAoJCSJhdXRoLnRlc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBpZGVudGlmeVxuIgoJCQl9CgkJXSwKCQkiYm90cy5pbmZvIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJib3QiLAoJCQkJImV4YW1wbGUiOiAiQjEyMzQ1Njc4IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQm90IHVzZXIgdG8gZ2V0IGluZm8gb25cbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLmFyY2hpdmUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byBhcmNoaXZlXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5jcmVhdGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJuYW1lIiwKCQkJCSJleGFtcGxlIjogIm15Y2hhbm5lbCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIk5hbWUgb2YgY2hhbm5lbCB0byBjcmVhdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidmFsaWRhdGUiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIldoZXRoZXIgdG8gcmV0dXJuIGVycm9ycyBvbiBpbnZhbGlkIGNoYW5uZWwgbmFtZSBpbnN0ZWFkIG9mIG1vZGlmeWluZyBpdCB0byBtZWV0IHRoZSBzcGVjaWZpZWQgY3JpdGVyaWEuXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5oaXN0b3J5IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6aGlzdG9yeVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byBmZXRjaCBoaXN0b3J5IGZvci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibGF0ZXN0IiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1ub3ciLAoJCQkJImRlc2NyaXB0aW9uIjogIkVuZCBvZiB0aW1lIHJhbmdlIG9mIG1lc3NhZ2VzIHRvIGluY2x1ZGUgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAib2xkZXN0IiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTdGFydCBvZiB0aW1lIHJhbmdlIG9mIG1lc3NhZ2VzIHRvIGluY2x1ZGUgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVzaXZlIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgbWVzc2FnZXMgd2l0aCBsYXRlc3Qgb3Igb2xkZXN0IHRpbWVzdGFtcCBpbiByZXN1bHRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIxMDAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIG1lc3NhZ2VzIHRvIHJldHVybiwgYmV0d2VlbiAxIGFuZCAxMDAwLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1bnJlYWRzIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgdW5yZWFkX2NvdW50X2Rpc3BsYXkgaW4gdGhlIG91dHB1dD9cbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLmluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIGdldCBpbmZvIG9uXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5pbnZpdGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byBpbnZpdGUgdXNlciB0by5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVzZXIgdG8gaW52aXRlIHRvIGNoYW5uZWwuXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5qb2luIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIk5hbWUgb2YgY2hhbm5lbCB0byBqb2luXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInZhbGlkYXRlIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJXaGV0aGVyIHRvIHJldHVybiBlcnJvcnMgb24gaW52YWxpZCBjaGFubmVsIG5hbWUgaW5zdGVhZCBvZiBtb2RpZnlpbmcgaXQgdG8gbWVldCB0aGUgc3BlY2lmaWVkIGNyaXRlcmlhLlxuIgoJCQl9CgkJXSwKCQkiY2hhbm5lbHMua2ljayI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIHJlbW92ZSB1c2VyIGZyb20uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIHJlbW92ZSBmcm9tIGNoYW5uZWwuXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5sZWF2ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIGxlYXZlXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJleGNsdWRlX2FyY2hpdmVkIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PWZhbHNlIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJEb24ndCByZXR1cm4gYXJjaGl2ZWQgY2hhbm5lbHMuXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5tYXJrIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gc2V0IHJlYWRpbmcgY3Vyc29yIGluLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0cyIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbW9zdCByZWNlbnRseSBzZWVuIG1lc3NhZ2UuXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5yZW5hbWUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byByZW5hbWVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIk5ldyBuYW1lIGZvciBjaGFubmVsLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ2YWxpZGF0ZSIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiV2hldGhlciB0byByZXR1cm4gZXJyb3JzIG9uIGludmFsaWQgY2hhbm5lbCBuYW1lIGluc3RlYWQgb2YgbW9kaWZ5aW5nIGl0IHRvIG1lZXQgdGhlIHNwZWNpZmllZCBjcml0ZXJpYS5cbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLnJlcGxpZXMiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczpoaXN0b3J5XG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIGZldGNoIHRocmVhZCBmcm9tXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRocmVhZF90cyIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVuaXF1ZSBpZGVudGlmaWVyIG9mIGEgdGhyZWFkJ3MgcGFyZW50IG1lc3NhZ2VcbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLnNldFB1cnBvc2UiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byBzZXQgdGhlIHB1cnBvc2Ugb2ZcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicHVycG9zZSIsCgkJCQkiZXhhbXBsZSI6ICJNeSBQdXJwb3NlIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIG5ldyBwdXJwb3NlXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5zZXRUb3BpYyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIHNldCB0aGUgdG9waWMgb2ZcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidG9waWMiLAoJCQkJImV4YW1wbGUiOiAiTXkgVG9waWMiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgbmV3IHRvcGljXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy51bmFyY2hpdmUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byB1bmFyY2hpdmVcbiIKCQkJfQoJCV0sCgkJImNoYXQuZGVsZXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhdDp3cml0ZTpib3Qgb3IgY2hhdDp3cml0ZTp1c2VyXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRzIiwKCQkJCSJleGFtcGxlIjogIjE0MDU4OTQzMjIuMDAyNzY4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtZXNzYWdlIHRvIGJlIGRlbGV0ZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIGNvbnRhaW5pbmcgdGhlIG1lc3NhZ2UgdG8gYmUgZGVsZXRlZC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYXNfdXNlciIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyB0cnVlIHRvIGRlbGV0ZSB0aGUgbWVzc2FnZSBhcyB0aGUgYXV0aGVkIHVzZXIuIEJvdCB1c2VycyBpbiB0aGlzIGNvbnRleHQgYXJlIGNvbnNpZGVyZWQgYXV0aGVkIHVzZXJzLlxuIgoJCQl9CgkJXSwKCQkiY2hhdC5tZU1lc3NhZ2UiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGF0OndyaXRlOnVzZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gc2VuZCBtZXNzYWdlIHRvLiBDYW4gYmUgYSBwdWJsaWMgY2hhbm5lbCwgcHJpdmF0ZSBncm91cCBvciBJTSBjaGFubmVsLiBDYW4gYmUgYW4gZW5jb2RlZCBJRCwgb3IgYSBuYW1lLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0ZXh0IiwKCQkJCSJleGFtcGxlIjogIkhlbGxvIHdvcmxkIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGV4dCBvZiB0aGUgbWVzc2FnZSB0byBzZW5kLlxuIgoJCQl9CgkJXSwKCQkiY2hhdC5wb3N0TWVzc2FnZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYXQ6d3JpdGU6Ym90IG9yIGNoYXQ6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCwgcHJpdmF0ZSBncm91cCwgb3IgSU0gY2hhbm5lbCB0byBzZW5kIG1lc3NhZ2UgdG8uIENhbiBiZSBhbiBlbmNvZGVkIElELCBvciBhIG5hbWUuIFNlZSBiZWxvdyBmb3IgbW9yZSBkZXRhaWxzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0ZXh0IiwKCQkJCSJleGFtcGxlIjogIkhlbGxvIHdvcmxkIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGV4dCBvZiB0aGUgbWVzc2FnZSB0byBzZW5kLiBTZWUgYmVsb3cgZm9yIGFuIGV4cGxhbmF0aW9uIG9mIGZvcm1hdHRpbmcuIFRoaXMgZmllbGQgaXMgdXN1YWxseSByZXF1aXJlZCwgdW5sZXNzIHlvdSdyZSBwcm92aWRpbmcgb25seSBhdHRhY2htZW50cyBpbnN0ZWFkLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYXJzZSIsCgkJCQkiZXhhbXBsZSI6ICJmdWxsIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbmdlIGhvdyBtZXNzYWdlcyBhcmUgdHJlYXRlZC4gRGVmYXVsdHMgdG8gbm9uZS4gU2VlIGJlbG93LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJsaW5rX25hbWVzIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaW5kIGFuZCBsaW5rIGNoYW5uZWwgbmFtZXMgYW5kIHVzZXJuYW1lcy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYXR0YWNobWVudHMiLAoJCQkJImV4YW1wbGUiOiAiW3tcInByZXRleHRcIjogXCJwcmUtaGVsbG9cIiwgXCJ0ZXh0XCI6IFwidGV4dC13b3JsZFwifV0iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTdHJ1Y3R1cmVkIG1lc3NhZ2UgYXR0YWNobWVudHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVuZnVybF9saW5rcyIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyB0cnVlIHRvIGVuYWJsZSB1bmZ1cmxpbmcgb2YgcHJpbWFyaWx5IHRleHQtYmFzZWQgY29udGVudC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidW5mdXJsX21lZGlhIiwKCQkJCSJleGFtcGxlIjogImZhbHNlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyBmYWxzZSB0byBkaXNhYmxlIHVuZnVybGluZyBvZiBtZWRpYSBjb250ZW50LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VybmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJNeSBCb3QiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTZXQgeW91ciBib3QncyB1c2VyIG5hbWUuIE11c3QgYmUgdXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIGFzX3VzZXIgc2V0IHRvIGZhbHNlLCBvdGhlcndpc2UgaWdub3JlZC4gU2VlIGF1dGhvcnNoaXAgYmVsb3cuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImFzX3VzZXIiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhc3MgdHJ1ZSB0byBwb3N0IHRoZSBtZXNzYWdlIGFzIHRoZSBhdXRoZWQgdXNlciwgaW5zdGVhZCBvZiBhcyBhIGJvdC4gRGVmYXVsdHMgdG8gZmFsc2UuIFNlZSBhdXRob3JzaGlwIGJlbG93LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpY29uX3VybCIsCgkJCQkiZXhhbXBsZSI6ICJodHRwOi8vbG9yZW1waXhlbC5jb20vNDgvNDgiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVUkwgdG8gYW4gaW1hZ2UgdG8gdXNlIGFzIHRoZSBpY29uIGZvciB0aGlzIG1lc3NhZ2UuIE11c3QgYmUgdXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIGFzX3VzZXIgc2V0IHRvIGZhbHNlLCBvdGhlcndpc2UgaWdub3JlZC4gU2VlIGF1dGhvcnNoaXAgYmVsb3cuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImljb25fZW1vamkiLAoJCQkJImV4YW1wbGUiOiAiOmNoYXJ0X3dpdGhfdXB3YXJkc190cmVuZDoiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJFbW9qaSB0byB1c2UgYXMgdGhlIGljb24gZm9yIHRoaXMgbWVzc2FnZS4gT3ZlcnJpZGVzIGljb25fdXJsLiBNdXN0IGJlIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCBhc191c2VyIHNldCB0byBmYWxzZSwgb3RoZXJ3aXNlIGlnbm9yZWQuIFNlZSBhdXRob3JzaGlwIGJlbG93LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aHJlYWRfdHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcm92aWRlIGFub3RoZXIgbWVzc2FnZSdzIHRzIHZhbHVlIHRvIG1ha2UgdGhpcyBtZXNzYWdlIGEgcmVwbHkuIEF2b2lkIHVzaW5nIGEgcmVwbHkncyB0cyB2YWx1ZTsgdXNlIGl0cyBwYXJlbnQgaW5zdGVhZC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicmVwbHlfYnJvYWRjYXN0IiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VkIGluIGNvbmp1bmN0aW9uIHdpdGggdGhyZWFkX3RzIGFuZCBpbmRpY2F0ZXMgd2hldGhlciByZXBseSBzaG91bGQgYmUgbWFkZSB2aXNpYmxlIHRvIGV2ZXJ5b25lIGluIHRoZSBjaGFubmVsIG9yIGNvbnZlcnNhdGlvbi4gRGVmYXVsdHMgdG8gZmFsc2UuXG4iCgkJCX0KCQldLAoJCSJjaGF0LnVuZnVybCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGxpbmtzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIElEIG9mIHRoZSBtZXNzYWdlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRzIiwKCQkJCSJleGFtcGxlIjogIsKgIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtZXNzYWdlIHRvIGFkZCB1bmZ1cmwgYmVoYXZpb3IgdG9cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidW5mdXJscyIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkpTT04gbWFwcGluZyBhIHNldCBvZiBVUkxzIGZyb20gdGhlIG1lc3NhZ2UgdG8gdGhlaXIgdW5mdXJsIGF0dGFjaG1lbnRzXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXJfYXV0aF9yZXF1aXJlZCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTZXQgdG8gdHJ1ZSBvciAxIHRvIGluZGljYXRlIHRoZSB1c2VyIG11c3QgaW5zdGFsbCB5b3VyIFNsYWNrIGFwcCB0byB0cmlnZ2VyIHVuZnVybHMgZm9yIHRoaXMgZG9tYWluXG4iCgkJCX0KCQldLAoJCSJjaGF0LnVwZGF0ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYXQ6d3JpdGU6Ym90IG9yIGNoYXQ6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0cyIsCgkJCQkiZXhhbXBsZSI6ICIxNDA1ODk0MzIyLjAwMjc2OCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbWVzc2FnZSB0byBiZSB1cGRhdGVkLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCBjb250YWluaW5nIHRoZSBtZXNzYWdlIHRvIGJlIHVwZGF0ZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRleHQiLAoJCQkJImV4YW1wbGUiOiAiSGVsbG8gd29ybGQiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOZXcgdGV4dCBmb3IgdGhlIG1lc3NhZ2UsIHVzaW5nIHRoZSBkZWZhdWx0IGZvcm1hdHRpbmcgcnVsZXMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImF0dGFjaG1lbnRzIiwKCQkJCSJleGFtcGxlIjogIlt7XCJwcmV0ZXh0XCI6IFwicHJlLWhlbGxvXCIsIFwidGV4dFwiOiBcInRleHQtd29ybGRcIn1dIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU3RydWN0dXJlZCBtZXNzYWdlIGF0dGFjaG1lbnRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYXJzZSIsCgkJCQkiZXhhbXBsZSI6ICJub25lIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbmdlIGhvdyBtZXNzYWdlcyBhcmUgdHJlYXRlZC4gRGVmYXVsdHMgdG8gY2xpZW50LCB1bmxpa2UgY2hhdC5wb3N0TWVzc2FnZS4gU2VlIGJlbG93LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJsaW5rX25hbWVzIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaW5kIGFuZCBsaW5rIGNoYW5uZWwgbmFtZXMgYW5kIHVzZXJuYW1lcy4gRGVmYXVsdHMgdG8gbm9uZS4gVGhpcyBwYXJhbWV0ZXIgc2hvdWxkIGJlIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCBwYXJzZS4gVG8gc2V0IGxpbmtfbmFtZXMgdG8gMSwgc3BlY2lmeSBhIHBhcnNlIG1vZGUgb2YgZnVsbC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYXNfdXNlciIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyB0cnVlIHRvIHVwZGF0ZSB0aGUgbWVzc2FnZSBhcyB0aGUgYXV0aGVkIHVzZXIuIEJvdCB1c2VycyBpbiB0aGlzIGNvbnRleHQgYXJlIGNvbnNpZGVyZWQgYXV0aGVkIHVzZXJzLlxuIgoJCQl9CgkJXSwKCQkiZG5kLmVuZERuZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGRuZDp3cml0ZVxuIgoJCQl9CgkJXSwKCQkiZG5kLmVuZFNub296ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGRuZDp3cml0ZVxuIgoJCQl9CgkJXSwKCQkiZG5kLmluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBkbmQ6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVXNlciB0byBmZXRjaCBzdGF0dXMgZm9yIChkZWZhdWx0cyB0byBjdXJyZW50IHVzZXIpXG4iCgkJCX0KCQldLAoJCSJkbmQuc2V0U25vb3plIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZG5kOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm51bV9taW51dGVzIiwKCQkJCSJleGFtcGxlIjogIjYwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIG1pbnV0ZXMsIGZyb20gbm93LCB0byBzbm9vemUgdW50aWwuXG4iCgkJCX0KCQldLAoJCSJkbmQudGVhbUluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBkbmQ6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VycyIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNCxVNDU2NyIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIHVzZXJzIHRvIGZldGNoIERvIE5vdCBEaXN0dXJiIHN0YXR1cyBmb3JcbiIKCQkJfQoJCV0sCgkJImVtb2ppLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBlbW9qaTpyZWFkXG4iCgkJCX0KCQldLAoJCSJmaWxlcy5jb21tZW50cy5hZGQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBmaWxlczp3cml0ZTp1c2VyXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGUiLAoJCQkJImV4YW1wbGUiOiAiRjEyMzQ0Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIHRvIGFkZCBhIGNvbW1lbnQgdG8uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNvbW1lbnQiLAoJCQkJImV4YW1wbGUiOiAiRXZlcnlvbmUgc2hvdWxkIHRha2UgYSBtb21lbnQgdG8gcmVhZCB0aGlzIGZpbGUuIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGV4dCBvZiB0aGUgY29tbWVudCB0byBhZGQuXG4iCgkJCX0KCQldLAoJCSJmaWxlcy5jb21tZW50cy5kZWxldGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBmaWxlczp3cml0ZTp1c2VyXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGUiLAoJCQkJImV4YW1wbGUiOiAiRjEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIHRvIGRlbGV0ZSBhIGNvbW1lbnQgZnJvbS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaWQiLAoJCQkJImV4YW1wbGUiOiAiRmMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIGNvbW1lbnQgdG8gZGVsZXRlLlxuIgoJCQl9CgkJXSwKCQkiZmlsZXMuY29tbWVudHMuZWRpdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGZpbGVzOndyaXRlOnVzZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgY29udGFpbmluZyB0aGUgY29tbWVudCB0byBlZGl0LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpZCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgY29tbWVudCB0byBlZGl0LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb21tZW50IiwKCQkJCSJleGFtcGxlIjogIkV2ZXJ5b25lIHNob3VsZCB0YWtlIGEgbW9tZW50IHRvIHJlYWQgdGhpcyBmaWxlLCBzZXJpb3VzbHkuIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGV4dCBvZiB0aGUgY29tbWVudCB0byBlZGl0LlxuIgoJCQl9CgkJXSwKCQkiZmlsZXMuZGVsZXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZmlsZXM6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSUQgb2YgZmlsZSB0byBkZWxldGUuXG4iCgkJCX0KCQldLAoJCSJmaWxlcy5pbmZvIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZmlsZXM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYyMTQ3NDgzODYyIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU3BlY2lmeSBhIGZpbGUgYnkgcHJvdmlkaW5nIGl0cyBJRC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMjAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIGl0ZW1zIHRvIHJldHVybiBwZXIgcGFnZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicGFnZSIsCgkJCQkiZXhhbXBsZSI6ICIyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYWdlIG51bWJlciBvZiByZXN1bHRzIHRvIHJldHVybi5cbiIKCQkJfQoJCV0sCgkJImZpbGVzLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBmaWxlczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgZmlsZXMgY3JlYXRlZCBieSBhIHNpbmdsZSB1c2VyLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsdGVyIGZpbGVzIGFwcGVhcmluZyBpbiBhIHNwZWNpZmljIGNoYW5uZWwsIGluZGljYXRlZCBieSBpdHMgSUQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRzX2Zyb20iLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgZmlsZXMgY3JlYXRlZCBhZnRlciB0aGlzIHRpbWVzdGFtcCAoaW5jbHVzaXZlKS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHNfdG8iLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1ub3ciLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbHRlciBmaWxlcyBjcmVhdGVkIGJlZm9yZSB0aGlzIHRpbWVzdGFtcCAoaW5jbHVzaXZlKS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHlwZXMiLAoJCQkJImV4YW1wbGUiOiAiaW1hZ2VzIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1hbGwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbHRlciBmaWxlcyBieSB0eXBlOlxuXG5cbmFsbCAtIEFsbCBmaWxlc1xuc3BhY2VzIC0gUG9zdHNcbnNuaXBwZXRzIC0gU25pcHBldHNcbmltYWdlcyAtIEltYWdlIGZpbGVzXG5nZG9jcyAtIEdvb2dsZSBkb2NzXG56aXBzIC0gWmlwIGZpbGVzXG5wZGZzIC0gUERGIGZpbGVzXG5cblxuWW91IGNhbiBwYXNzIG11bHRpcGxlIHZhbHVlcyBpbiB0aGUgdHlwZXMgYXJndW1lbnQsIGxpa2UgdHlwZXM9c3BhY2VzLHNuaXBwZXRzLlRoZSBkZWZhdWx0IHZhbHVlIGlzIGFsbCwgd2hpY2ggZG9lcyBub3QgZmlsdGVyIHRoZSBsaXN0LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkiZmlsZXMucmV2b2tlUHVibGljVVJMIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZmlsZXM6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSB0byByZXZva2VcbiIKCQkJfQoJCV0sCgkJImZpbGVzLnNoYXJlZFB1YmxpY1VSTCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGZpbGVzOndyaXRlOnVzZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gc2hhcmVcbiIKCQkJfQoJCV0sCgkJImZpbGVzLnVwbG9hZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGZpbGVzOndyaXRlOnVzZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICIuLi4iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbnRlbnRzIHZpYSBtdWx0aXBhcnQvZm9ybS1kYXRhLiBJZiBvbWl0dGluZyB0aGlzIHBhcmFtZXRlciwgeW91IG11c3Qgc3VibWl0IGNvbnRlbnQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNvbnRlbnQiLAoJCQkJImV4YW1wbGUiOiAiLi4uIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSBjb250ZW50cyB2aWEgYSBQT1NUIHZhcmlhYmxlLiBJZiBvbWl0dGluZyB0aGlzIHBhcmFtZXRlciwgeW91IG11c3QgcHJvdmlkZSBhIGZpbGUuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGV0eXBlIiwKCQkJCSJleGFtcGxlIjogInBocCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkEgZmlsZSB0eXBlIGlkZW50aWZpZXIuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVuYW1lIiwKCQkJCSJleGFtcGxlIjogImZvby50eHQiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlbmFtZSBvZiBmaWxlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aXRsZSIsCgkJCQkiZXhhbXBsZSI6ICJNeSBGaWxlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGl0bGUgb2YgZmlsZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5pdGlhbF9jb21tZW50IiwKCQkJCSJleGFtcGxlIjogIkJlc3QhIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5pdGlhbCBjb21tZW50IHRvIGFkZCB0byBmaWxlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVscyIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCxDMjM0NTY3ODkwMSxDMzQ1Njc4OTAxMiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIGNoYW5uZWwgbmFtZXMgb3IgSURzIHdoZXJlIHRoZSBmaWxlIHdpbGwgYmUgc2hhcmVkLlxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLmFyY2hpdmUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBhcmNoaXZlXG4iCgkJCX0KCQldLAoJCSJncm91cHMuY2xvc2UiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBjbG9zZS5cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5jcmVhdGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIk5hbWUgb2YgcHJpdmF0ZSBjaGFubmVsIHRvIGNyZWF0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ2YWxpZGF0ZSIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiV2hldGhlciB0byByZXR1cm4gZXJyb3JzIG9uIGludmFsaWQgY2hhbm5lbCBuYW1lIGluc3RlYWQgb2YgbW9kaWZ5aW5nIGl0IHRvIG1lZXQgdGhlIHNwZWNpZmllZCBjcml0ZXJpYS5cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5jcmVhdGVDaGlsZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIGNsb25lIGFuZCBhcmNoaXZlLlxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLmhpc3RvcnkiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6aGlzdG9yeVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIGZldGNoIGhpc3RvcnkgZm9yLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJsYXRlc3QiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PW5vdyIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRW5kIG9mIHRpbWUgcmFuZ2Ugb2YgbWVzc2FnZXMgdG8gaW5jbHVkZSBpbiByZXN1bHRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJvbGRlc3QiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIlN0YXJ0IG9mIHRpbWUgcmFuZ2Ugb2YgbWVzc2FnZXMgdG8gaW5jbHVkZSBpbiByZXN1bHRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdXNpdmUiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSBtZXNzYWdlcyB3aXRoIGxhdGVzdCBvciBvbGRlc3QgdGltZXN0YW1wIGluIHJlc3VsdHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNvdW50IiwKCQkJCSJleGFtcGxlIjogIjEwMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgbWVzc2FnZXMgdG8gcmV0dXJuLCBiZXR3ZWVuIDEgYW5kIDEwMDAuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVucmVhZHMiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSB1bnJlYWRfY291bnRfZGlzcGxheSBpbiB0aGUgb3V0cHV0P1xuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLmluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIGdldCBpbmZvIG9uXG4iCgkJCX0KCQldLAoJCSJncm91cHMuaW52aXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gaW52aXRlIHVzZXIgdG8uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIGludml0ZS5cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5raWNrIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gcmVtb3ZlIHVzZXIgZnJvbS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVzZXIgdG8gcmVtb3ZlIGZyb20gcHJpdmF0ZSBjaGFubmVsLlxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLmxlYXZlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gbGVhdmVcbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZXhjbHVkZV9hcmNoaXZlZCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJEb24ndCByZXR1cm4gYXJjaGl2ZWQgcHJpdmF0ZSBjaGFubmVscy5cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5tYXJrIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gc2V0IHJlYWRpbmcgY3Vyc29yIGluLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0cyIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbW9zdCByZWNlbnRseSBzZWVuIG1lc3NhZ2UuXG4iCgkJCX0KCQldLAoJCSJncm91cHMub3BlbiI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIG9wZW4uXG4iCgkJCX0KCQldLAoJCSJncm91cHMucmVuYW1lIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gcmVuYW1lXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm5hbWUiLAoJCQkJImV4YW1wbGUiOiAiwqAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOZXcgbmFtZSBmb3IgcHJpdmF0ZSBjaGFubmVsLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ2YWxpZGF0ZSIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiV2hldGhlciB0byByZXR1cm4gZXJyb3JzIG9uIGludmFsaWQgY2hhbm5lbCBuYW1lIGluc3RlYWQgb2YgbW9kaWZ5aW5nIGl0IHRvIG1lZXQgdGhlIHNwZWNpZmllZCBjcml0ZXJpYS5cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5yZXBsaWVzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOmhpc3RvcnlcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBmZXRjaCB0aHJlYWQgZnJvbVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aHJlYWRfdHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVbmlxdWUgaWRlbnRpZmllciBvZiBhIHRocmVhZCdzIHBhcmVudCBtZXNzYWdlXG4iCgkJCX0KCQldLAoJCSJncm91cHMuc2V0UHVycG9zZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIHNldCB0aGUgcHVycG9zZSBvZlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwdXJwb3NlIiwKCQkJCSJleGFtcGxlIjogIk15IFB1cnBvc2UiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgbmV3IHB1cnBvc2VcbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5zZXRUb3BpYyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIHNldCB0aGUgdG9waWMgb2ZcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidG9waWMiLAoJCQkJImV4YW1wbGUiOiAiTXkgVG9waWMiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgbmV3IHRvcGljXG4iCgkJCX0KCQldLAoJCSJncm91cHMudW5hcmNoaXZlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gdW5hcmNoaXZlXG4iCgkJCX0KCQldLAoJCSJpbS5jbG9zZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGltOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRDEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJEaXJlY3QgbWVzc2FnZSBjaGFubmVsIHRvIGNsb3NlLlxuIgoJCQl9CgkJXSwKCQkiaW0uaGlzdG9yeSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGltOmhpc3RvcnlcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJEMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkRpcmVjdCBtZXNzYWdlIGNoYW5uZWwgdG8gZmV0Y2ggaGlzdG9yeSBmb3IuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImxhdGVzdCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9bm93IiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJFbmQgb2YgdGltZSByYW5nZSBvZiBtZXNzYWdlcyB0byBpbmNsdWRlIGluIHJlc3VsdHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm9sZGVzdCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU3RhcnQgb2YgdGltZSByYW5nZSBvZiBtZXNzYWdlcyB0byBpbmNsdWRlIGluIHJlc3VsdHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImluY2x1c2l2ZSIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIG1lc3NhZ2VzIHdpdGggbGF0ZXN0IG9yIG9sZGVzdCB0aW1lc3RhbXAgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMTAwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xMDAiLAoJCQkJImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBtZXNzYWdlcyB0byByZXR1cm4sIGJldHdlZW4gMSBhbmQgMTAwMC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidW5yZWFkcyIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHVucmVhZF9jb3VudF9kaXNwbGF5IGluIHRoZSBvdXRwdXQ/XG4iCgkJCX0KCQldLAoJCSJpbS5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogaW06cmVhZFxuIgoJCQl9CgkJXSwKCQkiaW0ubWFyayI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGltOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRDEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJEaXJlY3QgbWVzc2FnZSBjaGFubmVsIHRvIHNldCByZWFkaW5nIGN1cnNvciBpbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1vc3QgcmVjZW50bHkgc2VlbiBtZXNzYWdlLlxuIgoJCQl9CgkJXSwKCQkiaW0ub3BlbiI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGltOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIG9wZW4gYSBkaXJlY3QgbWVzc2FnZSBjaGFubmVsIHdpdGguXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInJldHVybl9pbSIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQm9vbGVhbiwgaW5kaWNhdGVzIHlvdSB3YW50IHRoZSBmdWxsIElNIGNoYW5uZWwgZGVmaW5pdGlvbiBpbiB0aGUgcmVzcG9uc2UuXG4iCgkJCX0KCQldLAoJCSJpbS5yZXBsaWVzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogaW06aGlzdG9yeVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRGlyZWN0IG1lc3NhZ2UgY2hhbm5lbCB0byBmZXRjaCB0aHJlYWQgZnJvbVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aHJlYWRfdHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVbmlxdWUgaWRlbnRpZmllciBvZiBhIHRocmVhZCdzIHBhcmVudCBtZXNzYWdlXG4iCgkJCX0KCQldLAoJCSJtcGltLmNsb3NlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogbXBpbTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTVBJTSB0byBjbG9zZS5cbiIKCQkJfQoJCV0sCgkJIm1waW0uaGlzdG9yeSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IG1waW06aGlzdG9yeVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTXVsdGlwYXJ0eSBkaXJlY3QgbWVzc2FnZSB0byBmZXRjaCBoaXN0b3J5IGZvci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibGF0ZXN0IiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1ub3ciLAoJCQkJImRlc2NyaXB0aW9uIjogIkVuZCBvZiB0aW1lIHJhbmdlIG9mIG1lc3NhZ2VzIHRvIGluY2x1ZGUgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAib2xkZXN0IiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTdGFydCBvZiB0aW1lIHJhbmdlIG9mIG1lc3NhZ2VzIHRvIGluY2x1ZGUgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVzaXZlIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgbWVzc2FnZXMgd2l0aCBsYXRlc3Qgb3Igb2xkZXN0IHRpbWVzdGFtcCBpbiByZXN1bHRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIxMDAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIG1lc3NhZ2VzIHRvIHJldHVybiwgYmV0d2VlbiAxIGFuZCAxMDAwLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1bnJlYWRzIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgdW5yZWFkX2NvdW50X2Rpc3BsYXkgaW4gdGhlIG91dHB1dD9cbiIKCQkJfQoJCV0sCgkJIm1waW0ubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IG1waW06cmVhZFxuIgoJCQl9CgkJXSwKCQkibXBpbS5tYXJrIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogbXBpbTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAibXVsdGlwYXJ0eSBkaXJlY3QgbWVzc2FnZSBjaGFubmVsIHRvIHNldCByZWFkaW5nIGN1cnNvciBpbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1vc3QgcmVjZW50bHkgc2VlbiBtZXNzYWdlLlxuIgoJCQl9CgkJXSwKCQkibXBpbS5vcGVuIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogbXBpbTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VycyIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCxVMjM0NTY3ODkwMSxVMzQ1Njc4OTAxMiIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNvbW1hIHNlcGFyYXRlZCBsaXN0cyBvZiB1c2Vycy4gIFRoZSBvcmRlcmluZyBvZiB0aGUgdXNlcnMgaXMgcHJlc2VydmVkIHdoZW5ldmVyIGEgTVBJTSBncm91cCBpcyByZXR1cm5lZC5cbiIKCQkJfQoJCV0sCgkJIm1waW0ucmVwbGllcyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IG1waW06aGlzdG9yeVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTXVsdGlwYXJ0eSBkaXJlY3QgbWVzc2FnZSBjaGFubmVsIHRvIGZldGNoIHRocmVhZCBmcm9tLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aHJlYWRfdHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVbmlxdWUgaWRlbnRpZmllciBvZiBhIHRocmVhZCdzIHBhcmVudCBtZXNzYWdlLlxuIgoJCQl9CgkJXSwKCQkib2F1dGguYWNjZXNzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJjbGllbnRfaWQiLAoJCQkJImV4YW1wbGUiOiAiNGIzOWU5LTc1MmM0IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSXNzdWVkIHdoZW4geW91IGNyZWF0ZWQgeW91ciBhcHBsaWNhdGlvbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2xpZW50X3NlY3JldCIsCgkJCQkiZXhhbXBsZSI6ICIzM2ZlYTAxMTNmNWIxIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSXNzdWVkIHdoZW4geW91IGNyZWF0ZWQgeW91ciBhcHBsaWNhdGlvbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY29kZSIsCgkJCQkiZXhhbXBsZSI6ICJjY2RhYTcyYWQiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgY29kZSBwYXJhbSByZXR1cm5lZCB2aWEgdGhlIE9BdXRoIGNhbGxiYWNrLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJyZWRpcmVjdF91cmkiLAoJCQkJImV4YW1wbGUiOiAiaHR0cDovL2V4YW1wbGUuY29tIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhpcyBtdXN0IG1hdGNoIHRoZSBvcmlnaW5hbGx5IHN1Ym1pdHRlZCBVUkkgKGlmIG9uZSB3YXMgc2VudCkuXG4iCgkJCX0KCQldLAoJCSJwaW5zLmFkZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHBpbnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gcGluIHRoZSBpdGVtIGluLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSB0byBwaW4uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVfY29tbWVudCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbW1lbnQgdG8gcGluLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aW1lc3RhbXAiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1lc3NhZ2UgdG8gcGluLlxuIgoJCQl9CgkJXSwKCQkicGlucy5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogcGluczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIGdldCBwaW5uZWQgaXRlbXMgZm9yLlxuIgoJCQl9CgkJXSwKCQkicGlucy5yZW1vdmUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBwaW5zOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHdoZXJlIHRoZSBpdGVtIGlzIHBpbm5lZCB0by5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gdW4tcGluLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlX2NvbW1lbnQiLAoJCQkJImV4YW1wbGUiOiAiRmMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSBjb21tZW50IHRvIHVuLXBpbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGltZXN0YW1wIiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtZXNzYWdlIHRvIHVuLXBpbi5cbiIKCQkJfQoJCV0sCgkJInJlYWN0aW9ucy5hZGQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZWFjdGlvbnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJ0aHVtYnN1cCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlJlYWN0aW9uIChlbW9qaSkgbmFtZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gYWRkIHJlYWN0aW9uIHRvLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlX2NvbW1lbnQiLAoJCQkJImV4YW1wbGUiOiAiRmMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSBjb21tZW50IHRvIGFkZCByZWFjdGlvbiB0by5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgd2hlcmUgdGhlIG1lc3NhZ2UgdG8gYWRkIHJlYWN0aW9uIHRvIHdhcyBwb3N0ZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRpbWVzdGFtcCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbWVzc2FnZSB0byBhZGQgcmVhY3Rpb24gdG8uXG4iCgkJCX0KCQldLAoJCSJyZWFjdGlvbnMuZ2V0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogcmVhY3Rpb25zOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gZ2V0IHJlYWN0aW9ucyBmb3IuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVfY29tbWVudCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbW1lbnQgdG8gZ2V0IHJlYWN0aW9ucyBmb3IuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHdoZXJlIHRoZSBtZXNzYWdlIHRvIGdldCByZWFjdGlvbnMgZm9yIHdhcyBwb3N0ZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRpbWVzdGFtcCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbWVzc2FnZSB0byBnZXQgcmVhY3Rpb25zIGZvci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZnVsbCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSWYgdHJ1ZSBhbHdheXMgcmV0dXJuIHRoZSBjb21wbGV0ZSByZWFjdGlvbiBsaXN0LlxuIgoJCQl9CgkJXSwKCQkicmVhY3Rpb25zLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZWFjdGlvbnM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU2hvdyByZWFjdGlvbnMgbWFkZSBieSB0aGlzIHVzZXIuIERlZmF1bHRzIHRvIHRoZSBhdXRoZWQgdXNlci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZnVsbCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSWYgdHJ1ZSBhbHdheXMgcmV0dXJuIHRoZSBjb21wbGV0ZSByZWFjdGlvbiBsaXN0LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkicmVhY3Rpb25zLnJlbW92ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHJlYWN0aW9uczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJuYW1lIiwKCQkJCSJleGFtcGxlIjogInRodW1ic3VwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUmVhY3Rpb24gKGVtb2ppKSBuYW1lLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSB0byByZW1vdmUgcmVhY3Rpb24gZnJvbS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZV9jb21tZW50IiwKCQkJCSJleGFtcGxlIjogIkZjMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgY29tbWVudCB0byByZW1vdmUgcmVhY3Rpb24gZnJvbS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgd2hlcmUgdGhlIG1lc3NhZ2UgdG8gcmVtb3ZlIHJlYWN0aW9uIGZyb20gd2FzIHBvc3RlZC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGltZXN0YW1wIiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtZXNzYWdlIHRvIHJlbW92ZSByZWFjdGlvbiBmcm9tLlxuIgoJCQl9CgkJXSwKCQkicmVtaW5kZXJzLmFkZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHJlbWluZGVyczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0ZXh0IiwKCQkJCSJleGFtcGxlIjogImVhdCBhIGJhbmFuYSIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRoZSBjb250ZW50IG9mIHRoZSByZW1pbmRlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aW1lIiwKCQkJCSJleGFtcGxlIjogIjE2MDIyODgwMDAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJXaGVuIHRoaXMgcmVtaW5kZXIgc2hvdWxkIGhhcHBlbjogdGhlIFVuaXggdGltZXN0YW1wICh1cCB0byBmaXZlIHllYXJzIGZyb20gbm93KSwgdGhlIG51bWJlciBvZiBzZWNvbmRzIHVudGlsIHRoZSByZW1pbmRlciAoaWYgd2l0aGluIDI0IGhvdXJzKSwgb3IgYSBuYXR1cmFsIGxhbmd1YWdlIGRlc2NyaXB0aW9uIChFeC4gXCJpbiAxNSBtaW51dGVzLFwiIG9yIFwiZXZlcnkgVGh1cnNkYXlcIilcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTg4ODg4ODgiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgdXNlciB3aG8gd2lsbCByZWNlaXZlIHRoZSByZW1pbmRlci4gSWYgbm8gdXNlciBpcyBzcGVjaWZpZWQsIHRoZSByZW1pbmRlciB3aWxsIGdvIHRvIHVzZXIgd2hvIGNyZWF0ZWQgaXQuXG4iCgkJCX0KCQldLAoJCSJyZW1pbmRlcnMuY29tcGxldGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZW1pbmRlcnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicmVtaW5kZXIiLAoJCQkJImV4YW1wbGUiOiAiUm0xMjM0NTY3OCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRoZSBJRCBvZiB0aGUgcmVtaW5kZXIgdG8gYmUgbWFya2VkIGFzIGNvbXBsZXRlXG4iCgkJCX0KCQldLAoJCSJyZW1pbmRlcnMuZGVsZXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogcmVtaW5kZXJzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInJlbWluZGVyIiwKCQkJCSJleGFtcGxlIjogIlJtMTIzNDU2NzgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgSUQgb2YgdGhlIHJlbWluZGVyXG4iCgkJCX0KCQldLAoJCSJyZW1pbmRlcnMuaW5mbyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHJlbWluZGVyczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInJlbWluZGVyIiwKCQkJCSJleGFtcGxlIjogIlJtMjM0NTY3ODkiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgSUQgb2YgdGhlIHJlbWluZGVyXG4iCgkJCX0KCQldLAoJCSJyZW1pbmRlcnMubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHJlbWluZGVyczpyZWFkXG4iCgkJCX0KCQldLAoJCSJydG0uc3RhcnQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjbGllbnRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAic2ltcGxlX2xhdGVzdCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUmV0dXJuIHRpbWVzdGFtcCBvbmx5IGZvciBsYXRlc3QgbWVzc2FnZSBvYmplY3Qgb2YgZWFjaCBjaGFubmVsIChpbXByb3ZlcyBwZXJmb3JtYW5jZSkuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm5vX3VucmVhZHMiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlNraXAgdW5yZWFkIGNvdW50cyBmb3IgZWFjaCBjaGFubmVsIChpbXByb3ZlcyBwZXJmb3JtYW5jZSkuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm1waW1fYXdhcmUiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlJldHVybnMgTVBJTXMgdG8gdGhlIGNsaWVudCBpbiB0aGUgQVBJIHJlc3BvbnNlLlxuIgoJCQl9CgkJXSwKCQkic2VhcmNoLmFsbCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHNlYXJjaDpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInF1ZXJ5IiwKCQkJCSJleGFtcGxlIjogInBpY2tsZWZhY2UiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTZWFyY2ggcXVlcnkuIE1heSBjb250YWlucyBib29sZWFucywgZXRjLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJzb3J0IiwKCQkJCSJleGFtcGxlIjogInRpbWVzdGFtcCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9c2NvcmUiLAoJCQkJImRlc2NyaXB0aW9uIjogIlJldHVybiBtYXRjaGVzIHNvcnRlZCBieSBlaXRoZXIgc2NvcmUgb3IgdGltZXN0YW1wLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJzb3J0X2RpciIsCgkJCQkiZXhhbXBsZSI6ICJhc2MiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PWRlc2MiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5nZSBzb3J0IGRpcmVjdGlvbiB0byBhc2NlbmRpbmcgKGFzYykgb3IgZGVzY2VuZGluZyAoZGVzYykuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImhpZ2hsaWdodCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyBhIHZhbHVlIG9mIHRydWUgdG8gZW5hYmxlIHF1ZXJ5IGhpZ2hsaWdodCBtYXJrZXJzIChzZWUgYmVsb3cpLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MjAiLAoJCQkJImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBpdGVtcyB0byByZXR1cm4gcGVyIHBhZ2UuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInBhZ2UiLAoJCQkJImV4YW1wbGUiOiAiMiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MSIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFnZSBudW1iZXIgb2YgcmVzdWx0cyB0byByZXR1cm4uXG4iCgkJCX0KCQldLAoJCSJzZWFyY2guZmlsZXMiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBzZWFyY2g6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJxdWVyeSIsCgkJCQkiZXhhbXBsZSI6ICJwaWNrbGVmYWNlIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU2VhcmNoIHF1ZXJ5LiBNYXkgY29udGFpbiBib29sZWFucywgZXRjLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJzb3J0IiwKCQkJCSJleGFtcGxlIjogInRpbWVzdGFtcCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9c2NvcmUiLAoJCQkJImRlc2NyaXB0aW9uIjogIlJldHVybiBtYXRjaGVzIHNvcnRlZCBieSBlaXRoZXIgc2NvcmUgb3IgdGltZXN0YW1wLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJzb3J0X2RpciIsCgkJCQkiZXhhbXBsZSI6ICJhc2MiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PWRlc2MiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5nZSBzb3J0IGRpcmVjdGlvbiB0byBhc2NlbmRpbmcgKGFzYykgb3IgZGVzY2VuZGluZyAoZGVzYykuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImhpZ2hsaWdodCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyBhIHZhbHVlIG9mIHRydWUgdG8gZW5hYmxlIHF1ZXJ5IGhpZ2hsaWdodCBtYXJrZXJzIChzZWUgYmVsb3cpLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MjAiLAoJCQkJImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBpdGVtcyB0byByZXR1cm4gcGVyIHBhZ2UuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInBhZ2UiLAoJCQkJImV4YW1wbGUiOiAiMiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MSIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFnZSBudW1iZXIgb2YgcmVzdWx0cyB0byByZXR1cm4uXG4iCgkJCX0KCQldLAoJCSJzZWFyY2gubWVzc2FnZXMiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBzZWFyY2g6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJxdWVyeSIsCgkJCQkiZXhhbXBsZSI6ICJwaWNrbGVmYWNlIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU2VhcmNoIHF1ZXJ5LiBNYXkgY29udGFpbnMgYm9vbGVhbnMsIGV0Yy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAic29ydCIsCgkJCQkiZXhhbXBsZSI6ICJ0aW1lc3RhbXAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PXNjb3JlIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJSZXR1cm4gbWF0Y2hlcyBzb3J0ZWQgYnkgZWl0aGVyIHNjb3JlIG9yIHRpbWVzdGFtcC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAic29ydF9kaXIiLAoJCQkJImV4YW1wbGUiOiAiYXNjIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1kZXNjIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFuZ2Ugc29ydCBkaXJlY3Rpb24gdG8gYXNjZW5kaW5nIChhc2MpIG9yIGRlc2NlbmRpbmcgKGRlc2MpLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJoaWdobGlnaHQiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhc3MgYSB2YWx1ZSBvZiB0cnVlIHRvIGVuYWJsZSBxdWVyeSBoaWdobGlnaHQgbWFya2VycyAoc2VlIGJlbG93KS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMjAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTIwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkic3RhcnMuYWRkIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogc3RhcnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gYWRkIHN0YXIgdG8uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVfY29tbWVudCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbW1lbnQgdG8gYWRkIHN0YXIgdG8uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIGFkZCBzdGFyIHRvLCBvciBjaGFubmVsIHdoZXJlIHRoZSBtZXNzYWdlIHRvIGFkZCBzdGFyIHRvIHdhcyBwb3N0ZWQgKHVzZWQgd2l0aCB0aW1lc3RhbXApLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aW1lc3RhbXAiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1lc3NhZ2UgdG8gYWRkIHN0YXIgdG8uXG4iCgkJCX0KCQldLAoJCSJzdGFycy5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogc3RhcnM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkic3RhcnMucmVtb3ZlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogc3RhcnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gcmVtb3ZlIHN0YXIgZnJvbS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZV9jb21tZW50IiwKCQkJCSJleGFtcGxlIjogIkZjMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgY29tbWVudCB0byByZW1vdmUgc3RhciBmcm9tLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byByZW1vdmUgc3RhciBmcm9tLCBvciBjaGFubmVsIHdoZXJlIHRoZSBtZXNzYWdlIHRvIHJlbW92ZSBzdGFyIGZyb20gd2FzIHBvc3RlZCAodXNlZCB3aXRoIHRpbWVzdGFtcCkuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRpbWVzdGFtcCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbWVzc2FnZSB0byByZW1vdmUgc3RhciBmcm9tLlxuIgoJCQl9CgkJXSwKCQkidGVhbS5hY2Nlc3NMb2dzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogYWRtaW5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMjAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIGl0ZW1zIHRvIHJldHVybiBwZXIgcGFnZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicGFnZSIsCgkJCQkiZXhhbXBsZSI6ICIyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYWdlIG51bWJlciBvZiByZXN1bHRzIHRvIHJldHVybi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYmVmb3JlIiwKCQkJCSJleGFtcGxlIjogIjE0NTc5ODkxNjYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PW5vdyIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRW5kIG9mIHRpbWUgcmFuZ2Ugb2YgbG9ncyB0byBpbmNsdWRlIGluIHJlc3VsdHMgKGluY2x1c2l2ZSkuXG4iCgkJCX0KCQldLAoJCSJ0ZWFtLmJpbGxhYmxlSW5mbyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGFkbWluXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIHVzZXIgdG8gcmV0cmlldmUgdGhlIGJpbGxhYmxlIGluZm9ybWF0aW9uIGZvci4gRGVmYXVsdHMgdG8gYWxsIHVzZXJzLlxuIgoJCQl9CgkJXSwKCQkidGVhbS5pbmZvIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdGVhbTpyZWFkXG4iCgkJCX0KCQldLAoJCSJ0ZWFtLmludGVncmF0aW9uTG9ncyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGFkbWluXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInNlcnZpY2VfaWQiLAoJCQkJImV4YW1wbGUiOiAiwqAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgbG9ncyB0byB0aGlzIHNlcnZpY2UuIERlZmF1bHRzIHRvIGFsbCBsb2dzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJhcHBfaWQiLAoJCQkJImV4YW1wbGUiOiAiwqAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgbG9ncyB0byB0aGlzIFNsYWNrIGFwcC4gRGVmYXVsdHMgdG8gYWxsIGxvZ3MuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgbG9ncyBnZW5lcmF0ZWQgYnkgdGhpcyB1c2Vy4oCZcyBhY3Rpb25zLiBEZWZhdWx0cyB0byBhbGwgbG9ncy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbmdlX3R5cGUiLAoJCQkJImV4YW1wbGUiOiAiYWRkZWQiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgbG9ncyB3aXRoIHRoaXMgY2hhbmdlIHR5cGUuIERlZmF1bHRzIHRvIGFsbCBsb2dzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkidGVhbS5wcm9maWxlLmdldCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJzLnByb2ZpbGU6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ2aXNpYmlsaXR5IiwKCQkJCSJleGFtcGxlIjogImFsbCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbHRlciBieSB2aXNpYmlsaXR5LlxuIgoJCQl9CgkJXSwKCQkidXNlcmdyb3Vwcy5jcmVhdGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2VyZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm5hbWUiLAoJCQkJImV4YW1wbGUiOiAiTXkgVGVzdCBUZWFtIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSBuYW1lIGZvciB0aGUgVXNlciBHcm91cC4gTXVzdCBiZSB1bmlxdWUgYW1vbmcgVXNlciBHcm91cHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImhhbmRsZSIsCgkJCQkiZXhhbXBsZSI6ICJtYXJrZXRpbmciLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIG1lbnRpb24gaGFuZGxlLiBNdXN0IGJlIHVuaXF1ZSBhbW9uZyBjaGFubmVscywgdXNlcnMgYW5kIFVzZXIgR3JvdXBzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJkZXNjcmlwdGlvbiIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkEgc2hvcnQgZGVzY3JpcHRpb24gb2YgdGhlIFVzZXIgR3JvdXAuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWxzIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwLEMyMzQ1Njc4OTAxLEMzNDU2Nzg5MDEyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSBjb21tYSBzZXBhcmF0ZWQgc3RyaW5nIG9mIGVuY29kZWQgY2hhbm5lbCBJRHMgZm9yIHdoaWNoIHRoZSBVc2VyIEdyb3VwIHVzZXMgYXMgYSBkZWZhdWx0LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2NvdW50IiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHRoZSBudW1iZXIgb2YgdXNlcnMgaW4gZWFjaCBVc2VyIEdyb3VwLlxuIgoJCQl9CgkJXSwKCQkidXNlcmdyb3Vwcy5kaXNhYmxlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcmdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyZ3JvdXAiLAoJCQkJImV4YW1wbGUiOiAiUzA2MDRRU0pDIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIGVuY29kZWQgSUQgb2YgdGhlIFVzZXIgR3JvdXAgdG8gZGlzYWJsZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVkZV9jb3VudCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSB0aGUgbnVtYmVyIG9mIHVzZXJzIGluIHRoZSBVc2VyIEdyb3VwLlxuIgoJCQl9CgkJXSwKCQkidXNlcmdyb3Vwcy5lbmFibGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2VyZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXJncm91cCIsCgkJCQkiZXhhbXBsZSI6ICJTMDYwNFFTSkMiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgZW5jb2RlZCBJRCBvZiB0aGUgVXNlciBHcm91cCB0byBlbmFibGUuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImluY2x1ZGVfY291bnQiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgdGhlIG51bWJlciBvZiB1c2VycyBpbiB0aGUgVXNlciBHcm91cC5cbiIKCQkJfQoJCV0sCgkJInVzZXJncm91cHMubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJncm91cHM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2Rpc2FibGVkIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIGRpc2FibGVkIFVzZXIgR3JvdXBzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2NvdW50IiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHRoZSBudW1iZXIgb2YgdXNlcnMgaW4gZWFjaCBVc2VyIEdyb3VwLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX3VzZXJzIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHRoZSBsaXN0IG9mIHVzZXJzIGZvciBlYWNoIFVzZXIgR3JvdXAuXG4iCgkJCX0KCQldLAoJCSJ1c2VyZ3JvdXBzLnVwZGF0ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlcmdyb3VwIiwKCQkJCSJleGFtcGxlIjogIlMwNjA0UVNKQyIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRoZSBlbmNvZGVkIElEIG9mIHRoZSBVc2VyIEdyb3VwIHRvIHVwZGF0ZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJNeSBUZXN0IFRlYW0iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIG5hbWUgZm9yIHRoZSBVc2VyIEdyb3VwLiBNdXN0IGJlIHVuaXF1ZSBhbW9uZyBVc2VyIEdyb3Vwcy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaGFuZGxlIiwKCQkJCSJleGFtcGxlIjogIm1hcmtldGluZyIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkEgbWVudGlvbiBoYW5kbGUuIE11c3QgYmUgdW5pcXVlIGFtb25nIGNoYW5uZWxzLCB1c2VycyBhbmQgVXNlciBHcm91cHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImRlc2NyaXB0aW9uIiwKCQkJCSJleGFtcGxlIjogIsKgIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSBzaG9ydCBkZXNjcmlwdGlvbiBvZiB0aGUgVXNlciBHcm91cC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbHMiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAsQzIzNDU2Nzg5MDEsQzM0NTY3ODkwMTIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIGNvbW1hIHNlcGFyYXRlZCBzdHJpbmcgb2YgZW5jb2RlZCBjaGFubmVsIElEcyBmb3Igd2hpY2ggdGhlIFVzZXIgR3JvdXAgdXNlcyBhcyBhIGRlZmF1bHQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImluY2x1ZGVfY291bnQiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgdGhlIG51bWJlciBvZiB1c2VycyBpbiB0aGUgVXNlciBHcm91cC5cbiIKCQkJfQoJCV0sCgkJInVzZXJncm91cHMudXNlcnMubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJncm91cHM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyZ3JvdXAiLAoJCQkJImV4YW1wbGUiOiAiUzA2MDRRU0pDIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIGVuY29kZWQgSUQgb2YgdGhlIFVzZXIgR3JvdXAgdG8gdXBkYXRlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2Rpc2FibGVkIiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBbGxvdyByZXN1bHRzIHRoYXQgaW52b2x2ZSBkaXNhYmxlZCBVc2VyIEdyb3Vwcy5cbiIKCQkJfQoJCV0sCgkJInVzZXJncm91cHMudXNlcnMudXBkYXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcmdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyZ3JvdXAiLAoJCQkJImV4YW1wbGUiOiAiUzA2MDRRU0pDIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIGVuY29kZWQgSUQgb2YgdGhlIFVzZXIgR3JvdXAgdG8gdXBkYXRlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VycyIsCgkJCQkiZXhhbXBsZSI6ICJVMDYwUjRCSjQsVTA2MFJOUkNaIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSBjb21tYSBzZXBhcmF0ZWQgc3RyaW5nIG9mIGVuY29kZWQgdXNlciBJRHMgdGhhdCByZXByZXNlbnQgdGhlIGVudGlyZSBsaXN0IG9mIHVzZXJzIGZvciB0aGUgVXNlciBHcm91cC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVkZV9jb3VudCIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSB0aGUgbnVtYmVyIG9mIHVzZXJzIGluIHRoZSBVc2VyIEdyb3VwLlxuIgoJCQl9CgkJXSwKCQkidXNlcnMuZGVsZXRlUGhvdG8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2Vycy5wcm9maWxlOndyaXRlXG4iCgkJCX0KCQldLAoJCSJ1c2Vycy5nZXRQcmVzZW5jZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJzOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVzZXIgdG8gZ2V0IHByZXNlbmNlIGluZm8gb24uIERlZmF1bHRzIHRvIHRoZSBhdXRoZWQgdXNlci5cbiIKCQkJfQoJCV0sCgkJInVzZXJzLmlkZW50aXR5IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogaWRlbnRpdHkuYmFzaWNcbiIKCQkJfQoJCV0sCgkJInVzZXJzLmluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2VyczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIGdldCBpbmZvIG9uXG4iCgkJCX0KCQldLAoJCSJ1c2Vycy5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwcmVzZW5jZSIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiV2hldGhlciB0byBpbmNsdWRlIHByZXNlbmNlIGRhdGEgaW4gdGhlIG91dHB1dFxuIgoJCQl9CgkJXSwKCQkidXNlcnMuc2V0QWN0aXZlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnM6d3JpdGVcbiIKCQkJfQoJCV0sCgkJInVzZXJzLnNldFBob3RvIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnMucHJvZmlsZTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbWFnZSIsCgkJCQkiZXhhbXBsZSI6ICIuLi4iLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbnRlbnRzIHZpYSBtdWx0aXBhcnQvZm9ybS1kYXRhLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjcm9wX3giLAoJCQkJImV4YW1wbGUiOiAiMTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJYIGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQgY29ybmVyIG9mIGNyb3AgYm94XG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNyb3BfeSIsCgkJCQkiZXhhbXBsZSI6ICIxNSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlkgY29vcmRpbmF0ZSBvZiB0b3AtbGVmdCBjb3JuZXIgb2YgY3JvcCBib3hcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY3JvcF93IiwKCQkJCSJleGFtcGxlIjogIjEwMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIldpZHRoL2hlaWdodCBvZiBjcm9wIGJveCAoYWx3YXlzIHNxdWFyZSlcbiIKCQkJfQoJCV0sCgkJInVzZXJzLnNldFByZXNlbmNlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicHJlc2VuY2UiLAoJCQkJImV4YW1wbGUiOiAiYXdheSIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkVpdGhlciBhdXRvIG9yIGF3YXlcbiIKCQkJfQoJCV0sCgkJInVzZXJzLnByb2ZpbGUuZ2V0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnMucHJvZmlsZTpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VyIHRvIHJldHJpZXZlIHByb2ZpbGUgaW5mbyBmb3JcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVkZV9sYWJlbHMiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9ZmFsc2UiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgbGFiZWxzIGZvciBlYWNoIElEIGluIGN1c3RvbSBwcm9maWxlIGZpZWxkc1xuIgoJCQl9CgkJXSwKCQkidXNlcnMucHJvZmlsZS5zZXQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2Vycy5wcm9maWxlOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJRCBvZiB1c2VyIHRvIGNoYW5nZS4gVGhpcyBhcmd1bWVudCBtYXkgb25seSBiZSBzcGVjaWZpZWQgYnkgdGVhbSBhZG1pbnMgb24gcGFpZCB0ZWFtcy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicHJvZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJ7IGZpcnN0X25hbWU6IFwiSm9oblwiLCAuLi4gfSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNvbGxlY3Rpb24gb2Yga2V5OnZhbHVlIHBhaXJzIHByZXNlbnRlZCBhcyBhIFVSTC1lbmNvZGVkIEpTT04gaGFzaC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJmaXJzdF9uYW1lIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTmFtZSBvZiBhIHNpbmdsZSBrZXkgdG8gc2V0LiBVc2FibGUgb25seSBpZiBwcm9maWxlIGlzIG5vdCBwYXNzZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInZhbHVlIiwKCQkJCSJleGFtcGxlIjogIkpvaG4iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJWYWx1ZSB0byBzZXQgYSBzaW5nbGUga2V5IHRvLiBVc2FibGUgb25seSBpZiBwcm9maWxlIGlzIG5vdCBwYXNzZWQuXG4iCgkJCX0KCQldCgl9OwoKLyoqKi8gfSwKLyogNDkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gY2xpZW50OwoKCS8vIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtc3RhdGVmdWwtY2xpZW50CglmdW5jdGlvbiBjbGllbnQodG9rZW4pIHsKCSAgdmFyIGFwcGxpZWQgPSB7CgkgICAgYXV0aDogewoJICAgICAgdGVzdDoge30KCSAgICB9LAoJICAgIGJvdHM6IHsKCSAgICAgIGluZm86IHt9CgkgICAgfSwKCSAgICBjaGFubmVsczogewoJICAgICAgYXJjaGl2ZToge30sCgkgICAgICBjcmVhdGU6IHt9LAoJICAgICAgaGlzdG9yeToge30sCgkgICAgICBpbmZvOiB7fSwKCSAgICAgIGludml0ZToge30sCgkgICAgICBqb2luOiB7fSwKCSAgICAgIGtpY2s6IHt9LAoJICAgICAgbGVhdmU6IHt9LAoJICAgICAgbGlzdDoge30sCgkgICAgICBtYXJrOiB7fSwKCSAgICAgIHJlbmFtZToge30sCgkgICAgICByZXBsaWVzOiB7fSwKCSAgICAgIHNldFB1cnBvc2U6IHt9LAoJICAgICAgc2V0VG9waWM6IHt9LAoJICAgICAgdW5hcmNoaXZlOiB7fQoJICAgIH0sCgkgICAgY2hhdDogewoJICAgICAgZGVsZXRlOiB7fSwKCSAgICAgIG1lTWVzc2FnZToge30sCgkgICAgICBwb3N0TWVzc2FnZToge30sCgkgICAgICB1bmZ1cmw6IHt9LAoJICAgICAgdXBkYXRlOiB7fQoJICAgIH0sCgkgICAgZG5kOiB7CgkgICAgICBlbmREbmQ6IHt9LAoJICAgICAgZW5kU25vb3plOiB7fSwKCSAgICAgIGluZm86IHt9LAoJICAgICAgc2V0U25vb3plOiB7fSwKCSAgICAgIHRlYW1JbmZvOiB7fQoJICAgIH0sCgkgICAgZW1vamk6IHsKCSAgICAgIGxpc3Q6IHt9CgkgICAgfSwKCSAgICBmaWxlczogewoJICAgICAgY29tbWVudHM6IHsKCSAgICAgICAgYWRkOiB7fSwKCSAgICAgICAgZGVsZXRlOiB7fSwKCSAgICAgICAgZWRpdDoge30KCSAgICAgIH0sCgkgICAgICBkZWxldGU6IHt9LAoJICAgICAgaW5mbzoge30sCgkgICAgICBsaXN0OiB7fSwKCSAgICAgIHJldm9rZVB1YmxpY1VSTDoge30sCgkgICAgICBzaGFyZWRQdWJsaWNVUkw6IHt9LAoJICAgICAgdXBsb2FkOiB7fQoJICAgIH0sCgkgICAgZ3JvdXBzOiB7CgkgICAgICBhcmNoaXZlOiB7fSwKCSAgICAgIGNsb3NlOiB7fSwKCSAgICAgIGNyZWF0ZToge30sCgkgICAgICBjcmVhdGVDaGlsZDoge30sCgkgICAgICBoaXN0b3J5OiB7fSwKCSAgICAgIGluZm86IHt9LAoJICAgICAgaW52aXRlOiB7fSwKCSAgICAgIGtpY2s6IHt9LAoJICAgICAgbGVhdmU6IHt9LAoJICAgICAgbGlzdDoge30sCgkgICAgICBtYXJrOiB7fSwKCSAgICAgIG9wZW46IHt9LAoJICAgICAgcmVuYW1lOiB7fSwKCSAgICAgIHJlcGxpZXM6IHt9LAoJICAgICAgc2V0UHVycG9zZToge30sCgkgICAgICBzZXRUb3BpYzoge30sCgkgICAgICB1bmFyY2hpdmU6IHt9CgkgICAgfSwKCSAgICBpbTogewoJICAgICAgY2xvc2U6IHt9LAoJICAgICAgaGlzdG9yeToge30sCgkgICAgICBsaXN0OiB7fSwKCSAgICAgIG1hcms6IHt9LAoJICAgICAgb3Blbjoge30sCgkgICAgICByZXBsaWVzOiB7fQoJICAgIH0sCgkgICAgbXBpbTogewoJICAgICAgY2xvc2U6IHt9LAoJICAgICAgaGlzdG9yeToge30sCgkgICAgICBsaXN0OiB7fSwKCSAgICAgIG1hcms6IHt9LAoJICAgICAgb3Blbjoge30sCgkgICAgICByZXBsaWVzOiB7fQoJICAgIH0sCgkgICAgcGluczogewoJICAgICAgYWRkOiB7fSwKCSAgICAgIGxpc3Q6IHt9LAoJICAgICAgcmVtb3ZlOiB7fQoJICAgIH0sCgkgICAgcmVhY3Rpb25zOiB7CgkgICAgICBhZGQ6IHt9LAoJICAgICAgZ2V0OiB7fSwKCSAgICAgIGxpc3Q6IHt9LAoJICAgICAgcmVtb3ZlOiB7fQoJICAgIH0sCgkgICAgcmVtaW5kZXJzOiB7CgkgICAgICBhZGQ6IHt9LAoJICAgICAgY29tcGxldGU6IHt9LAoJICAgICAgZGVsZXRlOiB7fSwKCSAgICAgIGluZm86IHt9LAoJICAgICAgbGlzdDoge30KCSAgICB9LAoJICAgIHJ0bTogewoJICAgICAgc3RhcnQ6IHt9CgkgICAgfSwKCSAgICBzZWFyY2g6IHsKCSAgICAgIGFsbDoge30sCgkgICAgICBmaWxlczoge30sCgkgICAgICBtZXNzYWdlczoge30KCSAgICB9LAoJICAgIHN0YXJzOiB7CgkgICAgICBhZGQ6IHt9LAoJICAgICAgbGlzdDoge30sCgkgICAgICByZW1vdmU6IHt9CgkgICAgfSwKCSAgICB0ZWFtOiB7CgkgICAgICBhY2Nlc3NMb2dzOiB7fSwKCSAgICAgIGJpbGxhYmxlSW5mbzoge30sCgkgICAgICBpbmZvOiB7fSwKCSAgICAgIGludGVncmF0aW9uTG9nczoge30sCgkgICAgICBwcm9maWxlOiB7CgkgICAgICAgIGdldDoge30KCSAgICAgIH0KCSAgICB9LAoJICAgIHVzZXJncm91cHM6IHsKCSAgICAgIGNyZWF0ZToge30sCgkgICAgICBkaXNhYmxlOiB7fSwKCSAgICAgIGVuYWJsZToge30sCgkgICAgICBsaXN0OiB7fSwKCSAgICAgIHVwZGF0ZToge30sCgkgICAgICB1c2VyczogewoJICAgICAgICBsaXN0OiB7fSwKCSAgICAgICAgdXBkYXRlOiB7fQoJICAgICAgfQoJICAgIH0sCgkgICAgdXNlcnM6IHsKCSAgICAgIGRlbGV0ZVBob3RvOiB7fSwKCSAgICAgIGdldFByZXNlbmNlOiB7fSwKCSAgICAgIGlkZW50aXR5OiB7fSwKCSAgICAgIGluZm86IHt9LAoJICAgICAgbGlzdDoge30sCgkgICAgICBwcm9maWxlOiB7CgkgICAgICAgIGdldDoge30sCgkgICAgICAgIHNldDoge30KCSAgICAgIH0sCgkgICAgICBzZXRBY3RpdmU6IHt9LAoJICAgICAgc2V0UGhvdG86IHt9LAoJICAgICAgc2V0UHJlc2VuY2U6IHt9CgkgICAgfQoJICB9OwoKCSAgYXBwbGllZC5hdXRoLnRlc3QgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNTApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmJvdHMuaW5mbyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg1MSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhbm5lbHMuYXJjaGl2ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg1MikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhbm5lbHMuY3JlYXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDUzKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5oaXN0b3J5ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5pbmZvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5pbnZpdGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNTYpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLmpvaW4gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNTcpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLmtpY2sgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNTgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLmxlYXZlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDYwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5tYXJrID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5yZW5hbWUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLnJlcGxpZXMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLnNldFB1cnBvc2UgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLnNldFRvcGljID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDY1KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy51bmFyY2hpdmUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjYpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYXQuZGVsZXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGF0Lm1lTWVzc2FnZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg2OCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhdC5wb3N0TWVzc2FnZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg2OSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhdC51bmZ1cmwgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNzApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYXQudXBkYXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5kbmQuZW5kRG5kID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDcyKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5kbmQuZW5kU25vb3plID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDczKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5kbmQuaW5mbyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3NCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZG5kLnNldFNub296ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3NSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZG5kLnRlYW1JbmZvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDc2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5lbW9qaS5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDc3KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5maWxlcy5jb21tZW50cy5hZGQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNzgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmZpbGVzLmNvbW1lbnRzLmRlbGV0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3OSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZmlsZXMuY29tbWVudHMuZWRpdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg4MCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZmlsZXMuZGVsZXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDgxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5maWxlcy5pbmZvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDgyKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5maWxlcy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDgzKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5maWxlcy5yZXZva2VQdWJsaWNVUkwgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oODQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmZpbGVzLnNoYXJlZFB1YmxpY1VSTCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg4NSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZmlsZXMudXBsb2FkID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDg2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMuYXJjaGl2ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg4NykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLmNsb3NlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDg4KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMuY3JlYXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDg5KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMuY3JlYXRlQ2hpbGQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oOTApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5oaXN0b3J5ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDkxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMuaW5mbyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5MikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLmludml0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5MykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLmtpY2sgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oOTQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5sZWF2ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5NSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLmxpc3QgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oOTYpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5tYXJrID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDk3KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMub3BlbiA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5OCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLnJlbmFtZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5OSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLnJlcGxpZXMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTAwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMuc2V0UHVycG9zZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDEpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5zZXRUb3BpYyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy51bmFyY2hpdmUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTAzKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5pbS5jbG9zZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmltLmhpc3RvcnkgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTA1KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5pbS5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuaW0ubWFyayA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDcpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmltLm9wZW4gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTA4KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5pbS5yZXBsaWVzID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwOSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQubXBpbS5jbG9zZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0uaGlzdG9yeSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTEpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ubGlzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ubWFyayA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ub3BlbiA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ucmVwbGllcyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTUpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnBpbnMuYWRkID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDExNikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucGlucy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDExNykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucGlucy5yZW1vdmUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTE4KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZWFjdGlvbnMuYWRkID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucmVhY3Rpb25zLmdldCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMjApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnJlYWN0aW9ucy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucmVhY3Rpb25zLnJlbW92ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnJlbWluZGVycy5hZGQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTIzKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZW1pbmRlcnMuY29tcGxldGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTI0KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZW1pbmRlcnMuZGVsZXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyNSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucmVtaW5kZXJzLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTI2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZW1pbmRlcnMubGlzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMjcpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnJ0bS5zdGFydCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMjgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnNlYXJjaC5hbGwgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTI5KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zZWFyY2guZmlsZXMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTMwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zZWFyY2gubWVzc2FnZXMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTMxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zdGFycy5hZGQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTMyKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zdGFycy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzMykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuc3RhcnMucmVtb3ZlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudGVhbS5hY2Nlc3NMb2dzID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudGVhbS5iaWxsYWJsZUluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTM2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC50ZWFtLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTM3KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC50ZWFtLmludGVncmF0aW9uTG9ncyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMzgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnRlYW0ucHJvZmlsZS5nZXQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTM5KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2VyZ3JvdXBzLmNyZWF0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNDApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJncm91cHMuZGlzYWJsZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNDEpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJncm91cHMuZW5hYmxlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0MikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcmdyb3Vwcy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0MykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcmdyb3Vwcy51cGRhdGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTQ0KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2VyZ3JvdXBzLnVzZXJzLmxpc3QgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTQ1KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2VyZ3JvdXBzLnVzZXJzLnVwZGF0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNDYpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLmRlbGV0ZVBob3RvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0NykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcnMuZ2V0UHJlc2VuY2UgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTQ4KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2Vycy5pZGVudGl0eSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNDkpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTUwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2Vycy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1MSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcnMucHJvZmlsZS5nZXQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTUyKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2Vycy5wcm9maWxlLnNldCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNTMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLnNldEFjdGl2ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNTQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLnNldFBob3RvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1NSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcnMuc2V0UHJlc2VuY2UgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTU2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCgkgIHJldHVybiBhcHBsaWVkOwoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBhdXRodGVzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gYXV0aHRlc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnYXV0aC50ZXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBib3RzaW5mbzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gYm90c2luZm8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnYm90cy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2FyY2hpdmU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzYXJjaGl2ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5hcmNoaXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2NyZWF0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHNjcmVhdGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMuY3JlYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2hpc3Rvcnk7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzaGlzdG9yeShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5oaXN0b3J5JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2luZm87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzaW5mbyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2ludml0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHNpbnZpdGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMuaW52aXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2pvaW47CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzam9pbihwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5qb2luJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2tpY2s7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxza2ljayhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5raWNrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2xlYXZlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGFubmVsc2xlYXZlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYW5uZWxzLmxlYXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc21hcms7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzbWFyayhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5tYXJrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3JlbmFtZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHNyZW5hbWUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMucmVuYW1lJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3JlcGxpZXM7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzcmVwbGllcyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5yZXBsaWVzJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3NldFB1cnBvc2U7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzc2V0UHVycG9zZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5zZXRQdXJwb3NlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3NldFRvcGljOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGFubmVsc3NldFRvcGljKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYW5uZWxzLnNldFRvcGljJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3VuYXJjaGl2ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHN1bmFyY2hpdmUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMudW5hcmNoaXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0ZGVsZXRlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGF0ZGVsZXRlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYXQuZGVsZXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0bWVNZXNzYWdlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGF0bWVNZXNzYWdlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYXQubWVNZXNzYWdlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0cG9zdE1lc3NhZ2U7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYXRwb3N0TWVzc2FnZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGF0LnBvc3RNZXNzYWdlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0dW5mdXJsOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGF0dW5mdXJsKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYXQudW5mdXJsJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0dXBkYXRlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGF0dXBkYXRlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYXQudXBkYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRlbmREbmQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGRuZGVuZERuZChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdkbmQuZW5kRG5kJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRlbmRTbm9vemU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGRuZGVuZFNub296ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdkbmQuZW5kU25vb3plJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRpbmZvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBkbmRpbmZvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2RuZC5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRzZXRTbm9vemU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGRuZHNldFNub296ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdkbmQuc2V0U25vb3plJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmR0ZWFtSW5mbzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZG5kdGVhbUluZm8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZG5kLnRlYW1JbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBlbW9qaWxpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGVtb2ppbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdlbW9qaS5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2NvbW1lbnRzYWRkOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBmaWxlc2NvbW1lbnRzYWRkKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2ZpbGVzLmNvbW1lbnRzLmFkZCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogNzkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gZmlsZXNjb21tZW50c2RlbGV0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNjb21tZW50c2RlbGV0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5jb21tZW50cy5kZWxldGUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDgwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGZpbGVzY29tbWVudHNlZGl0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBmaWxlc2NvbW1lbnRzZWRpdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5jb21tZW50cy5lZGl0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2RlbGV0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNkZWxldGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMuZGVsZXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2luZm87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGZpbGVzaW5mbyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGZpbGVzbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc3Jldm9rZVB1YmxpY1VSTDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNyZXZva2VQdWJsaWNVUkwocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMucmV2b2tlUHVibGljVVJMJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc3NoYXJlZFB1YmxpY1VSTDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNzaGFyZWRQdWJsaWNVUkwocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMuc2hhcmVkUHVibGljVVJMJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc3VwbG9hZDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXN1cGxvYWQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMudXBsb2FkJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNhcmNoaXZlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNhcmNoaXZlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5hcmNoaXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNjbG9zZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzY2xvc2UocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLmNsb3NlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNjcmVhdGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGdyb3Vwc2NyZWF0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMuY3JlYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNjcmVhdGVDaGlsZDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzY3JlYXRlQ2hpbGQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLmNyZWF0ZUNoaWxkJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNoaXN0b3J5OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNoaXN0b3J5KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5oaXN0b3J5JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNpbmZvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNpbmZvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNpbnZpdGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGdyb3Vwc2ludml0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMuaW52aXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNraWNrOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNraWNrKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5raWNrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNsZWF2ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzbGVhdmUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLmxlYXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNsaXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNsaXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNtYXJrOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNtYXJrKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5tYXJrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNvcGVuOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNvcGVuKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5vcGVuJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNyZW5hbWU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGdyb3Vwc3JlbmFtZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMucmVuYW1lJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gZ3JvdXBzcmVwbGllczsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzcmVwbGllcyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMucmVwbGllcyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTAxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGdyb3Vwc3NldFB1cnBvc2U7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGdyb3Vwc3NldFB1cnBvc2UocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLnNldFB1cnBvc2UnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEwMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNzZXRUb3BpYzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzc2V0VG9waWMocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLnNldFRvcGljJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gZ3JvdXBzdW5hcmNoaXZlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHN1bmFyY2hpdmUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLnVuYXJjaGl2ZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTA0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGltY2xvc2U7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGltY2xvc2UocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnaW0uY2xvc2UnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEwNSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBpbWhpc3Rvcnk7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGltaGlzdG9yeShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdpbS5oaXN0b3J5JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gaW1saXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBpbWxpc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnaW0ubGlzdCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTA3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGltbWFyazsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gaW1tYXJrKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2ltLm1hcmsnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEwOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBpbW9wZW47CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGltb3BlbihwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdpbS5vcGVuJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gaW1yZXBsaWVzOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBpbXJlcGxpZXMocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnaW0ucmVwbGllcyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTEwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IG1waW1jbG9zZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gbXBpbWNsb3NlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ21waW0uY2xvc2UnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDExMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBtcGltaGlzdG9yeTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gbXBpbWhpc3RvcnkocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnbXBpbS5oaXN0b3J5JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMTIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gbXBpbWxpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIG1waW1saXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ21waW0ubGlzdCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTEzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IG1waW1tYXJrOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBtcGltbWFyayhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdtcGltLm1hcmsnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDExNCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBtcGltb3BlbjsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gbXBpbW9wZW4ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnbXBpbS5vcGVuJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMTUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gbXBpbXJlcGxpZXM7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIG1waW1yZXBsaWVzKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ21waW0ucmVwbGllcyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTE2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHBpbnNhZGQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHBpbnNhZGQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncGlucy5hZGQnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDExNyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBwaW5zbGlzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcGluc2xpc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncGlucy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMTggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcGluc3JlbW92ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcGluc3JlbW92ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdwaW5zLnJlbW92ZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTE5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHJlYWN0aW9uc2FkZDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcmVhY3Rpb25zYWRkKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3JlYWN0aW9ucy5hZGQnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyMCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSByZWFjdGlvbnNnZXQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHJlYWN0aW9uc2dldChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdyZWFjdGlvbnMuZ2V0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMjEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcmVhY3Rpb25zbGlzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcmVhY3Rpb25zbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdyZWFjdGlvbnMubGlzdCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTIyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHJlYWN0aW9uc3JlbW92ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcmVhY3Rpb25zcmVtb3ZlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3JlYWN0aW9ucy5yZW1vdmUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyMyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSByZW1pbmRlcnNhZGQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHJlbWluZGVyc2FkZChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdyZW1pbmRlcnMuYWRkJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMjQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcmVtaW5kZXJzY29tcGxldGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHJlbWluZGVyc2NvbXBsZXRlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3JlbWluZGVycy5jb21wbGV0ZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTI1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHJlbWluZGVyc2RlbGV0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcmVtaW5kZXJzZGVsZXRlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3JlbWluZGVycy5kZWxldGUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyNiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSByZW1pbmRlcnNpbmZvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiByZW1pbmRlcnNpbmZvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3JlbWluZGVycy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMjcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcmVtaW5kZXJzbGlzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcmVtaW5kZXJzbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdyZW1pbmRlcnMubGlzdCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTI4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHJ0bXN0YXJ0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBydG1zdGFydChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdydG0uc3RhcnQnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyOSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBzZWFyY2hhbGw7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHNlYXJjaGFsbChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdzZWFyY2guYWxsJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gc2VhcmNoZmlsZXM7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHNlYXJjaGZpbGVzKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3NlYXJjaC5maWxlcyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTMxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHNlYXJjaG1lc3NhZ2VzOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBzZWFyY2htZXNzYWdlcyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdzZWFyY2gubWVzc2FnZXMnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEzMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBzdGFyc2FkZDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gc3RhcnNhZGQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnc3RhcnMuYWRkJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gc3RhcnNsaXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBzdGFyc2xpc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnc3RhcnMubGlzdCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTM0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHN0YXJzcmVtb3ZlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBzdGFyc3JlbW92ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdzdGFycy5yZW1vdmUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEzNSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB0ZWFtYWNjZXNzTG9nczsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdGVhbWFjY2Vzc0xvZ3MocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndGVhbS5hY2Nlc3NMb2dzJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdGVhbWJpbGxhYmxlSW5mbzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdGVhbWJpbGxhYmxlSW5mbyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd0ZWFtLmJpbGxhYmxlSW5mbyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTM3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHRlYW1pbmZvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB0ZWFtaW5mbyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd0ZWFtLmluZm8nOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEzOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB0ZWFtaW50ZWdyYXRpb25Mb2dzOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB0ZWFtaW50ZWdyYXRpb25Mb2dzKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3RlYW0uaW50ZWdyYXRpb25Mb2dzJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdGVhbXByb2ZpbGVnZXQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHRlYW1wcm9maWxlZ2V0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3RlYW0ucHJvZmlsZS5nZXQnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE0MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2VyZ3JvdXBzY3JlYXRlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2VyZ3JvdXBzY3JlYXRlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJncm91cHMuY3JlYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNDEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcmdyb3Vwc2Rpc2FibGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJncm91cHNkaXNhYmxlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJncm91cHMuZGlzYWJsZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJncm91cHNlbmFibGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJncm91cHNlbmFibGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcmdyb3Vwcy5lbmFibGUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE0MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2VyZ3JvdXBzbGlzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcmdyb3Vwc2xpc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcmdyb3Vwcy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNDQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcmdyb3Vwc3VwZGF0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcmdyb3Vwc3VwZGF0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2VyZ3JvdXBzLnVwZGF0ZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQ1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJncm91cHN1c2Vyc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJncm91cHN1c2Vyc2xpc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcmdyb3Vwcy51c2Vycy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNDYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcmdyb3Vwc3VzZXJzdXBkYXRlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2VyZ3JvdXBzdXNlcnN1cGRhdGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcmdyb3Vwcy51c2Vycy51cGRhdGUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE0NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2Vyc2RlbGV0ZVBob3RvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2Vyc2RlbGV0ZVBob3RvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJzLmRlbGV0ZVBob3RvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNDggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcnNnZXRQcmVzZW5jZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcnNnZXRQcmVzZW5jZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2Vycy5nZXRQcmVzZW5jZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQ5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJzaWRlbnRpdHk7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJzaWRlbnRpdHkocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcnMuaWRlbnRpdHknOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE1MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2Vyc2luZm87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJzaW5mbyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2Vycy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNTEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcnNsaXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2Vyc2xpc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcnMubGlzdCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTUyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJzcHJvZmlsZWdldDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcnNwcm9maWxlZ2V0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJzLnByb2ZpbGUuZ2V0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNTMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcnNwcm9maWxlc2V0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2Vyc3Byb2ZpbGVzZXQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcnMucHJvZmlsZS5zZXQnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE1NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2Vyc3NldEFjdGl2ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcnNzZXRBY3RpdmUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcnMuc2V0QWN0aXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNTUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcnNzZXRQaG90bzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcnNzZXRQaG90byhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2Vycy5zZXRQaG90byc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTU2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJzc2V0UHJlc2VuY2U7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJzc2V0UHJlc2VuY2UocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcnMuc2V0UHJlc2VuY2UnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE1NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9ib3RzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7CgoJdmFyIF9ib3RzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2JvdHMpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBpbmZvOiBfYm90czIuZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTU4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2NoYW5uZWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1Mik7CgoJdmFyIF9jaGFubmVsczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVscyk7CgoJdmFyIF9jaGFubmVsczMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUzKTsKCgl2YXIgX2NoYW5uZWxzNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzMyk7CgoJdmFyIF9jaGFubmVsczUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KTsKCgl2YXIgX2NoYW5uZWxzNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzNSk7CgoJdmFyIF9jaGFubmVsczcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KTsKCgl2YXIgX2NoYW5uZWxzOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzNyk7CgoJdmFyIF9jaGFubmVsczkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU2KTsKCgl2YXIgX2NoYW5uZWxzMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczkpOwoKCXZhciBfY2hhbm5lbHMxMSA9IF9fd2VicGFja19yZXF1aXJlX18oNTcpOwoKCXZhciBfY2hhbm5lbHMxMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzMTEpOwoKCXZhciBfY2hhbm5lbHMxMyA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpOwoKCXZhciBfY2hhbm5lbHMxNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzMTMpOwoKCXZhciBfY2hhbm5lbHMxNSA9IF9fd2VicGFja19yZXF1aXJlX18oNTkpOwoKCXZhciBfY2hhbm5lbHMxNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzMTUpOwoKCXZhciBfY2hhbm5lbHMxNyA9IF9fd2VicGFja19yZXF1aXJlX18oNjApOwoKCXZhciBfY2hhbm5lbHMxOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzMTcpOwoKCXZhciBfY2hhbm5lbHMxOSA9IF9fd2VicGFja19yZXF1aXJlX18oNjEpOwoKCXZhciBfY2hhbm5lbHMyMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzMTkpOwoKCXZhciBfY2hhbm5lbHMyMSA9IF9fd2VicGFja19yZXF1aXJlX18oNjIpOwoKCXZhciBfY2hhbm5lbHMyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzMjEpOwoKCXZhciBfY2hhbm5lbHMyMyA9IF9fd2VicGFja19yZXF1aXJlX18oNjMpOwoKCXZhciBfY2hhbm5lbHMyNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzMjMpOwoKCXZhciBfY2hhbm5lbHMyNSA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpOwoKCXZhciBfY2hhbm5lbHMyNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzMjUpOwoKCXZhciBfY2hhbm5lbHMyNyA9IF9fd2VicGFja19yZXF1aXJlX18oNjUpOwoKCXZhciBfY2hhbm5lbHMyOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzMjcpOwoKCXZhciBfY2hhbm5lbHMyOSA9IF9fd2VicGFja19yZXF1aXJlX18oNjYpOwoKCXZhciBfY2hhbm5lbHMzMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYW5uZWxzMjkpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBhcmNoaXZlOiBfY2hhbm5lbHMyLmRlZmF1bHQsCgkgIGNyZWF0ZTogX2NoYW5uZWxzNC5kZWZhdWx0LAoJICBoaXN0b3J5OiBfY2hhbm5lbHM2LmRlZmF1bHQsCgkgIGluZm86IF9jaGFubmVsczguZGVmYXVsdCwKCSAgaW52aXRlOiBfY2hhbm5lbHMxMC5kZWZhdWx0LAoJICBqb2luOiBfY2hhbm5lbHMxMi5kZWZhdWx0LAoJICBraWNrOiBfY2hhbm5lbHMxNC5kZWZhdWx0LAoJICBsZWF2ZTogX2NoYW5uZWxzMTYuZGVmYXVsdCwKCSAgbGlzdDogX2NoYW5uZWxzMTguZGVmYXVsdCwKCSAgbWFyazogX2NoYW5uZWxzMjAuZGVmYXVsdCwKCSAgcmVuYW1lOiBfY2hhbm5lbHMyMi5kZWZhdWx0LAoJICByZXBsaWVzOiBfY2hhbm5lbHMyNC5kZWZhdWx0LAoJICBzZXRQdXJwb3NlOiBfY2hhbm5lbHMyNi5kZWZhdWx0LAoJICBzZXRUb3BpYzogX2NoYW5uZWxzMjguZGVmYXVsdCwKCSAgdW5hcmNoaXZlOiBfY2hhbm5lbHMzMC5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNTkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfY2hhdCA9IF9fd2VicGFja19yZXF1aXJlX18oNjcpOwoKCXZhciBfY2hhdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGF0KTsKCgl2YXIgX2NoYXQzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OCk7CgoJdmFyIF9jaGF0NCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYXQzKTsKCgl2YXIgX2NoYXQ1ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OSk7CgoJdmFyIF9jaGF0NiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYXQ1KTsKCgl2YXIgX2NoYXQ3ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7CgoJdmFyIF9jaGF0OCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NoYXQ3KTsKCgl2YXIgX2NoYXQ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7CgoJdmFyIF9jaGF0MTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGF0OSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGRlbGV0ZTogX2NoYXQyLmRlZmF1bHQsCgkgIG1lTWVzc2FnZTogX2NoYXQ0LmRlZmF1bHQsCgkgIHBvc3RNZXNzYWdlOiBfY2hhdDYuZGVmYXVsdCwKCSAgdW5mdXJsOiBfY2hhdDguZGVmYXVsdCwKCSAgdXBkYXRlOiBfY2hhdDEwLmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE2MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9kbmQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc0KTsKCgl2YXIgX2RuZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kbmQpOwoKCXZhciBfZG5kMyA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpOwoKCXZhciBfZG5kNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RuZDMpOwoKCXZhciBfZG5kNSA9IF9fd2VicGFja19yZXF1aXJlX18oNzMpOwoKCXZhciBfZG5kNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RuZDUpOwoKCXZhciBfZG5kNyA9IF9fd2VicGFja19yZXF1aXJlX18oNzUpOwoKCXZhciBfZG5kOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RuZDcpOwoKCXZhciBfZG5kOSA9IF9fd2VicGFja19yZXF1aXJlX18oNzYpOwoKCXZhciBfZG5kMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kbmQ5KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgaW5mbzogX2RuZDIuZGVmYXVsdCwgZW5kRG5kOiBfZG5kNC5kZWZhdWx0LCBlbmRTbm9vemU6IF9kbmQ2LmRlZmF1bHQsIHNldFNub296ZTogX2RuZDguZGVmYXVsdCwgdGVhbUluZm86IF9kbmQxMC5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfZmlsZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgxKTsKCgl2YXIgX2ZpbGVzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZpbGVzKTsKCgl2YXIgX2ZpbGVzMyA9IF9fd2VicGFja19yZXF1aXJlX18oODIpOwoKCXZhciBfZmlsZXM0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmlsZXMzKTsKCgl2YXIgX2ZpbGVzNSA9IF9fd2VicGFja19yZXF1aXJlX18oODMpOwoKCXZhciBfZmlsZXM2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmlsZXM1KTsKCgl2YXIgX2ZpbGVzNyA9IF9fd2VicGFja19yZXF1aXJlX18oODYpOwoKCXZhciBfZmlsZXM4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmlsZXM3KTsKCgl2YXIgX2ZpbGVzQ29tbWVudHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc4KTsKCgl2YXIgX2ZpbGVzQ29tbWVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmlsZXNDb21tZW50cyk7CgoJdmFyIF9maWxlc0NvbW1lbnRzMyA9IF9fd2VicGFja19yZXF1aXJlX18oNzkpOwoKCXZhciBfZmlsZXNDb21tZW50czQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlc0NvbW1lbnRzMyk7CgoJdmFyIF9maWxlc0NvbW1lbnRzNSA9IF9fd2VicGFja19yZXF1aXJlX18oODApOwoKCXZhciBfZmlsZXNDb21tZW50czYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlc0NvbW1lbnRzNSk7CgoJdmFyIF9maWxlczkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg0KTsKCgl2YXIgX2ZpbGVzMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlczkpOwoKCXZhciBfZmlsZXMxMSA9IF9fd2VicGFja19yZXF1aXJlX18oODUpOwoKCXZhciBfZmlsZXMxMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZpbGVzMTEpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBkZWxldGU6IF9maWxlczIuZGVmYXVsdCwKCSAgaW5mbzogX2ZpbGVzNC5kZWZhdWx0LAoJICBsaXN0OiBfZmlsZXM2LmRlZmF1bHQsCgkgIHVwbG9hZDogX2ZpbGVzOC5kZWZhdWx0LAoJICBjb21tZW50czogewoJICAgIGFkZDogX2ZpbGVzQ29tbWVudHMyLmRlZmF1bHQsCgkgICAgZGVsZXRlOiBfZmlsZXNDb21tZW50czQuZGVmYXVsdCwKCSAgICBlZGl0OiBfZmlsZXNDb21tZW50czYuZGVmYXVsdAoJICB9LAoJICByZXZva2VQdWJsaWNVUkw6IF9maWxlczEwLmRlZmF1bHQsCgkgIHNoYXJlZFB1YmxpY1VSTDogX2ZpbGVzMTIuZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTYyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2dyb3VwcyA9IF9fd2VicGFja19yZXF1aXJlX18oODcpOwoKCXZhciBfZ3JvdXBzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dyb3Vwcyk7CgoJdmFyIF9ncm91cHMzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4OCk7CgoJdmFyIF9ncm91cHM0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMyk7CgoJdmFyIF9ncm91cHM1ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4OSk7CgoJdmFyIF9ncm91cHM2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzNSk7CgoJdmFyIF9ncm91cHM3ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MCk7CgoJdmFyIF9ncm91cHM4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzNyk7CgoJdmFyIF9ncm91cHM5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MSk7CgoJdmFyIF9ncm91cHMxMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dyb3VwczkpOwoKCXZhciBfZ3JvdXBzMTEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkyKTsKCgl2YXIgX2dyb3VwczEyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMTEpOwoKCXZhciBfZ3JvdXBzMTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkzKTsKCgl2YXIgX2dyb3VwczE0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMTMpOwoKCXZhciBfZ3JvdXBzMTUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk0KTsKCgl2YXIgX2dyb3VwczE2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMTUpOwoKCXZhciBfZ3JvdXBzMTcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk1KTsKCgl2YXIgX2dyb3VwczE4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMTcpOwoKCXZhciBfZ3JvdXBzMTkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KTsKCgl2YXIgX2dyb3VwczIwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMTkpOwoKCXZhciBfZ3JvdXBzMjEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk3KTsKCgl2YXIgX2dyb3VwczIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMjEpOwoKCXZhciBfZ3JvdXBzMjMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk4KTsKCgl2YXIgX2dyb3VwczI0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMjMpOwoKCXZhciBfZ3JvdXBzMjUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KTsKCgl2YXIgX2dyb3VwczI2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMjUpOwoKCXZhciBfZ3JvdXBzMjcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMSk7CgoJdmFyIF9ncm91cHMyOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dyb3VwczI3KTsKCgl2YXIgX2dyb3VwczI5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDIpOwoKCXZhciBfZ3JvdXBzMzAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMyOSk7CgoJdmFyIF9ncm91cHMzMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTAzKTsKCgl2YXIgX2dyb3VwczMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMzEpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBhcmNoaXZlOiBfZ3JvdXBzMi5kZWZhdWx0LAoJICBjbG9zZTogX2dyb3VwczQuZGVmYXVsdCwKCSAgY3JlYXRlOiBfZ3JvdXBzNi5kZWZhdWx0LAoJICBjcmVhdGVDaGlsZDogX2dyb3VwczguZGVmYXVsdCwKCSAgaGlzdG9yeTogX2dyb3VwczEwLmRlZmF1bHQsCgkgIGluZm86IF9ncm91cHMxMi5kZWZhdWx0LAoJICBpbnZpdGU6IF9ncm91cHMxNC5kZWZhdWx0LAoJICBraWNrOiBfZ3JvdXBzMTYuZGVmYXVsdCwKCSAgbGVhdmU6IF9ncm91cHMxOC5kZWZhdWx0LAoJICBsaXN0OiBfZ3JvdXBzMjAuZGVmYXVsdCwKCSAgbWFyazogX2dyb3VwczIyLmRlZmF1bHQsCgkgIG9wZW46IF9ncm91cHMyNC5kZWZhdWx0LAoJICByZW5hbWU6IF9ncm91cHMyNi5kZWZhdWx0LAoJICBzZXRQdXJwb3NlOiBfZ3JvdXBzMjguZGVmYXVsdCwKCSAgc2V0VG9waWM6IF9ncm91cHMzMC5kZWZhdWx0LAoJICB1bmFyY2hpdmU6IF9ncm91cHMzMi5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfaW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNCk7CgoJdmFyIF9pbTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbSk7CgoJdmFyIF9pbTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNSk7CgoJdmFyIF9pbTQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbTMpOwoKCXZhciBfaW01ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDYpOwoKCXZhciBfaW02ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW01KTsKCgl2YXIgX2ltNyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA3KTsKCgl2YXIgX2ltOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ltNyk7CgoJdmFyIF9pbTkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwOCk7CgoJdmFyIF9pbTEwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW05KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgY2xvc2U6IF9pbTIuZGVmYXVsdCwgaGlzdG9yeTogX2ltNC5kZWZhdWx0LCBsaXN0OiBfaW02LmRlZmF1bHQsIG1hcms6IF9pbTguZGVmYXVsdCwgb3BlbjogX2ltMTAuZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTY0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX21waW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExMCk7CgoJdmFyIF9tcGltMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21waW0pOwoKCXZhciBfbXBpbTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExMSk7CgoJdmFyIF9tcGltNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21waW0zKTsKCgl2YXIgX21waW01ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTIpOwoKCXZhciBfbXBpbTYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tcGltNSk7CgoJdmFyIF9tcGltNyA9IF9fd2VicGFja19yZXF1aXJlX18oMTEzKTsKCgl2YXIgX21waW04ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXBpbTcpOwoKCXZhciBfbXBpbTkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExNCk7CgoJdmFyIF9tcGltMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tcGltOSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGNsb3NlOiBfbXBpbTIuZGVmYXVsdCwKCSAgaGlzdG9yeTogX21waW00LmRlZmF1bHQsCgkgIGxpc3Q6IF9tcGltNi5kZWZhdWx0LAoJICBtYXJrOiBfbXBpbTguZGVmYXVsdCwKCSAgb3BlbjogX21waW0xMC5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gb2F1dGhhY2Nlc3M7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIG9hdXRoYWNjZXNzKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ29hdXRoLmFjY2Vzcyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTY2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3JlYWN0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oMTE5KTsKCgl2YXIgX3JlYWN0aW9uczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdGlvbnMpOwoKCXZhciBfcmVhY3Rpb25zMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTIwKTsKCgl2YXIgX3JlYWN0aW9uczQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdGlvbnMzKTsKCgl2YXIgX3JlYWN0aW9uczUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMSk7CgoJdmFyIF9yZWFjdGlvbnM2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3Rpb25zNSk7CgoJdmFyIF9yZWFjdGlvbnM3ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKCXZhciBfcmVhY3Rpb25zOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0aW9uczcpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBhZGQ6IF9yZWFjdGlvbnMyLmRlZmF1bHQsIGdldDogX3JlYWN0aW9uczQuZGVmYXVsdCwgbGlzdDogX3JlYWN0aW9uczYuZGVmYXVsdCwgcmVtb3ZlOiBfcmVhY3Rpb25zOC5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfcmVtaW5kZXJzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjMpOwoKCXZhciBfcmVtaW5kZXJzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlbWluZGVycyk7CgoJdmFyIF9yZW1pbmRlcnMzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjQpOwoKCXZhciBfcmVtaW5kZXJzNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlbWluZGVyczMpOwoKCXZhciBfcmVtaW5kZXJzNSA9IF9fd2VicGFja19yZXF1aXJlX18oMTI1KTsKCgl2YXIgX3JlbWluZGVyczYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW1pbmRlcnM1KTsKCgl2YXIgX3JlbWluZGVyczcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyNik7CgoJdmFyIF9yZW1pbmRlcnM4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVtaW5kZXJzNyk7CgoJdmFyIF9yZW1pbmRlcnM5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjcpOwoKCXZhciBfcmVtaW5kZXJzMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW1pbmRlcnM5KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgYWRkOiBfcmVtaW5kZXJzMi5kZWZhdWx0LCBjb21wbGV0ZTogX3JlbWluZGVyczQuZGVmYXVsdCwgZGVsZXRlOiBfcmVtaW5kZXJzNi5kZWZhdWx0LCBpbmZvOiBfcmVtaW5kZXJzOC5kZWZhdWx0LCBsaXN0OiBfcmVtaW5kZXJzMTAuZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTY4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3BpbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExNik7CgoJdmFyIF9waW5zMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BpbnMpOwoKCXZhciBfcGluczMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExNyk7CgoJdmFyIF9waW5zNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BpbnMzKTsKCgl2YXIgX3BpbnM1ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTgpOwoKCXZhciBfcGluczYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9waW5zNSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGFkZDogX3BpbnMyLmRlZmF1bHQsIGxpc3Q6IF9waW5zNC5kZWZhdWx0LCByZW1vdmU6IF9waW5zNi5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gY2xpZW50OwoKCXZhciBfcnRtID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjgpOwoKCXZhciBfcnRtMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3J0bSk7CgoJdmFyIF9ydG0zID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNzApOwoKCXZhciBfcnRtNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3J0bTMpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gc29ja2V0IGZhY3RvcnkKCWZ1bmN0aW9uIGNsaWVudCgpIHsKCgkgIC8vIGJ1aWxkIGEgbmV3IGJvdCBldmVyeSB0aW1lCgkgIHZhciBib3QgPSB7CgkgICAgaGFuZGxlcnM6IHsKCSAgICAgIHN0YXJ0ZWQ6IFtdCgkgICAgfQoJICB9OwoKCSAgLy8gYWRkIHVuZG9jdW1lbnRlZCBwaW5nIGV2ZW50CgkgIF9ydG00LmRlZmF1bHQucHVzaCgncG9uZycpOwoKCSAgLy8gZ2VuZXJhdGUgZXZlbnQgaGFuZGxlciByZWdpc3RyYXRpb24gbWV0aG9kcwoJICBfcnRtNC5kZWZhdWx0LmZvckVhY2goZnVuY3Rpb24gKGUpIHsKCSAgICBib3QuaGFuZGxlcnNbZV0gPSBbXTsKCSAgICBib3RbZV0gPSBmdW5jdGlvbiAoaGFuZGxlcikgewoJICAgICAgYm90LmhhbmRsZXJzW2VdLnB1c2goaGFuZGxlcik7CgkgICAgfTsKCSAgfSk7CgoJICBib3Quc3RhcnRlZCA9IGZ1bmN0aW9uIChoYW5kbGVyKSB7CgkgICAgYm90LmhhbmRsZXJzWydzdGFydGVkJ10ucHVzaChoYW5kbGVyKTsKCSAgfTsKCgkgIC8vIGtpY2tzIHVwIGEgd2ViIHNvY2tldCBjb25uZWN0aW9uCgkgIGJvdC5saXN0ZW4gPSBmdW5jdGlvbiBib3RMaXN0ZW4ocGFyYW1zLCBjYWxsYmFjaykgewoJICAgICgwLCBfcnRtMi5kZWZhdWx0KShwYXJhbXMsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKCSAgICAgIGlmIChlcnIpIHsKCSAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjayhlcnIpO2Vsc2UgdGhyb3cgZXJyOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgLy8gZ3JhYiBhIGhhbmRsZSBvbiB0aGUgc29ja2V0CgkgICAgICAgIGJvdC53cyA9IG5ldyBXZWJTb2NrZXQoZGF0YS51cmwpOwoJICAgICAgICAvLyBkZWxlZ2F0ZSBldmVyeXRoaW5nCgkgICAgICAgIGJvdC53cy5vbm1lc3NhZ2UgPSBmdW5jdGlvbiBtZXNzYWdlKGUpIHsKCSAgICAgICAgICB2YXIganNvbiA9IEpTT04ucGFyc2UoZS5kYXRhKTsKCSAgICAgICAgICAvLyBDYWxsIGFsbCByZWdpc3RlcmVkIGhhbmRsZXJzIGZvciB0aGlzIGV2ZW50LCBpZiBhbnkKCSAgICAgICAgICBpZiAoYm90LmhhbmRsZXJzW2pzb24udHlwZV0pIGJvdC5oYW5kbGVyc1tqc29uLnR5cGVdLmZvckVhY2goZnVuY3Rpb24gKG0pIHsKCSAgICAgICAgICAgIHJldHVybiBtLmNhbGwoe30sIGpzb24pOwoJICAgICAgICAgIH0pOwoJICAgICAgICB9OwoJICAgICAgICAvLyBjYWxsIHN0YXJ0ZWQgY2FsbGJhY2tzCgkgICAgICAgIGJvdC5oYW5kbGVyc1snc3RhcnRlZCddLmZvckVhY2goZnVuY3Rpb24gKG0pIHsKCSAgICAgICAgICByZXR1cm4gbS5jYWxsKHt9LCBkYXRhKTsKCSAgICAgICAgfSk7CgkgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2sobnVsbCwgZGF0YSk7CgkgICAgICB9CgkgICAgfSk7CgkgIH07CgoJICAvLyBjbG9zZXMgdGhlIHNvY2tldAoJICBib3QuY2xvc2UgPSBmdW5jdGlvbiBib3RDbG9zZSgpIHsKCSAgICBib3Qud3MuY2xvc2UoKTsKCSAgfTsKCgkgIC8vLy8vLy8vLy8KCSAgcmV0dXJuIGJvdDsKCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTcwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgkvLyBnZW5lcmF0ZWQgdXNpbmcgLi9zY3JpcHRzL2dlbmVyYXRlLWFsbAoJdmFyIGV2ZW50cyA9IFsnYWNjb3VudHNfY2hhbmdlZCcsICdib3RfYWRkZWQnLCAnYm90X2NoYW5nZWQnLCAnY2hhbm5lbF9hcmNoaXZlJywgJ2NoYW5uZWxfY3JlYXRlZCcsICdjaGFubmVsX2RlbGV0ZWQnLCAnY2hhbm5lbF9oaXN0b3J5X2NoYW5nZWQnLCAnY2hhbm5lbF9qb2luZWQnLCAnY2hhbm5lbF9sZWZ0JywgJ2NoYW5uZWxfbWFya2VkJywgJ2NoYW5uZWxfcmVuYW1lJywgJ2NoYW5uZWxfdW5hcmNoaXZlJywgJ2NvbW1hbmRzX2NoYW5nZWQnLCAnZG5kX3VwZGF0ZWQnLCAnZG5kX3VwZGF0ZWRfdXNlcicsICdlbWFpbF9kb21haW5fY2hhbmdlZCcsICdlbW9qaV9jaGFuZ2VkJywgJ2ZpbGVfY2hhbmdlJywgJ2ZpbGVfY29tbWVudF9hZGRlZCcsICdmaWxlX2NvbW1lbnRfZGVsZXRlZCcsICdmaWxlX2NvbW1lbnRfZWRpdGVkJywgJ2ZpbGVfY3JlYXRlZCcsICdmaWxlX2RlbGV0ZWQnLCAnZmlsZV9wdWJsaWMnLCAnZmlsZV9zaGFyZWQnLCAnZmlsZV91bnNoYXJlZCcsICdnb29kYnllJywgJ2dyb3VwX2FyY2hpdmUnLCAnZ3JvdXBfY2xvc2UnLCAnZ3JvdXBfaGlzdG9yeV9jaGFuZ2VkJywgJ2dyb3VwX2pvaW5lZCcsICdncm91cF9sZWZ0JywgJ2dyb3VwX21hcmtlZCcsICdncm91cF9vcGVuJywgJ2dyb3VwX3JlbmFtZScsICdncm91cF91bmFyY2hpdmUnLCAnaGVsbG8nLCAnaW1fY2xvc2UnLCAnaW1fY3JlYXRlZCcsICdpbV9oaXN0b3J5X2NoYW5nZWQnLCAnaW1fbWFya2VkJywgJ2ltX29wZW4nLCAnbGlua19zaGFyZWQnLCAnbWFudWFsX3ByZXNlbmNlX2NoYW5nZScsICdtZXNzYWdlJywgJ21lc3NhZ2UuY2hhbm5lbHMnLCAnbWVzc2FnZS5ncm91cHMnLCAnbWVzc2FnZS5pbScsICdtZXNzYWdlLm1waW0nLCAncGluX2FkZGVkJywgJ3Bpbl9yZW1vdmVkJywgJ3BvbmcnLCAncHJlZl9jaGFuZ2UnLCAncHJlc2VuY2VfY2hhbmdlJywgJ3JlYWN0aW9uX2FkZGVkJywgJ3JlYWN0aW9uX3JlbW92ZWQnLCAncmVjb25uZWN0X3VybCcsICdzdGFyX2FkZGVkJywgJ3N0YXJfcmVtb3ZlZCcsICdzdWJ0ZWFtX2NyZWF0ZWQnLCAnc3VidGVhbV9zZWxmX2FkZGVkJywgJ3N1YnRlYW1fc2VsZl9yZW1vdmVkJywgJ3N1YnRlYW1fdXBkYXRlZCcsICd0ZWFtX2RvbWFpbl9jaGFuZ2UnLCAndGVhbV9qb2luJywgJ3RlYW1fbWlncmF0aW9uX3N0YXJ0ZWQnLCAndGVhbV9wbGFuX2NoYW5nZScsICd0ZWFtX3ByZWZfY2hhbmdlJywgJ3RlYW1fcHJvZmlsZV9jaGFuZ2UnLCAndGVhbV9wcm9maWxlX2RlbGV0ZScsICd0ZWFtX3Byb2ZpbGVfcmVvcmRlcicsICd0ZWFtX3JlbmFtZScsICd1cmxfdmVyaWZpY2F0aW9uJywgJ3VzZXJfY2hhbmdlJywgJ3VzZXJfdHlwaW5nJ107CgoJZXhwb3J0cy5kZWZhdWx0ID0gZXZlbnRzOwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNzEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfc2VhcmNoID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjkpOwoKCXZhciBfc2VhcmNoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NlYXJjaCk7CgoJdmFyIF9zZWFyY2gzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzApOwoKCXZhciBfc2VhcmNoNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NlYXJjaDMpOwoKCXZhciBfc2VhcmNoNSA9IF9fd2VicGFja19yZXF1aXJlX18oMTMxKTsKCgl2YXIgX3NlYXJjaDYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZWFyY2g1KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgYWxsOiBfc2VhcmNoMi5kZWZhdWx0LCBmaWxlczogX3NlYXJjaDQuZGVmYXVsdCwgbWVzc2FnZXM6IF9zZWFyY2g2LmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE3MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9zdGFycyA9IF9fd2VicGFja19yZXF1aXJlX18oMTMyKTsKCgl2YXIgX3N0YXJzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0YXJzKTsKCgl2YXIgX3N0YXJzMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTMzKTsKCgl2YXIgX3N0YXJzNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0YXJzMyk7CgoJdmFyIF9zdGFyczUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNCk7CgoJdmFyIF9zdGFyczYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdGFyczUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBhZGQ6IF9zdGFyczIuZGVmYXVsdCwgbGlzdDogX3N0YXJzNC5kZWZhdWx0LCByZW1vdmU6IF9zdGFyczYuZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTczICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3RlYW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNSk7CgoJdmFyIF90ZWFtMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RlYW0pOwoKCXZhciBfdGVhbTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNik7CgoJdmFyIF90ZWFtNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RlYW0zKTsKCgl2YXIgX3RlYW01ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzcpOwoKCXZhciBfdGVhbTYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZWFtNSk7CgoJdmFyIF90ZWFtNyA9IF9fd2VicGFja19yZXF1aXJlX18oMTM4KTsKCgl2YXIgX3RlYW04ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGVhbTcpOwoKCXZhciBfdGVhbVByb2ZpbGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzOSk7CgoJdmFyIF90ZWFtUHJvZmlsZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZWFtUHJvZmlsZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGFjY2Vzc0xvZ3M6IF90ZWFtMi5kZWZhdWx0LAoJICBiaWxsYWJsZUluZm86IF90ZWFtNC5kZWZhdWx0LAoJICBpbmZvOiBfdGVhbTYuZGVmYXVsdCwKCSAgaW50ZWdyYXRpb25Mb2dzOiBfdGVhbTguZGVmYXVsdCwKCSAgcHJvZmlsZTogewoJICAgIGdldDogX3RlYW1Qcm9maWxlMi5kZWZhdWx0CgkgIH0KCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE3NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF91c2VyZ3JvdXBzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDApOwoKCXZhciBfdXNlcmdyb3VwczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyZ3JvdXBzKTsKCgl2YXIgX3VzZXJncm91cHMzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDEpOwoKCXZhciBfdXNlcmdyb3VwczQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyZ3JvdXBzMyk7CgoJdmFyIF91c2VyZ3JvdXBzNSA9IF9fd2VicGFja19yZXF1aXJlX18oMTQyKTsKCgl2YXIgX3VzZXJncm91cHM2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcmdyb3VwczUpOwoKCXZhciBfdXNlcmdyb3VwczcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Myk7CgoJdmFyIF91c2VyZ3JvdXBzOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJncm91cHM3KTsKCgl2YXIgX3VzZXJncm91cHM5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDQpOwoKCXZhciBfdXNlcmdyb3VwczEwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcmdyb3VwczkpOwoKCXZhciBfdXNlcmdyb3Vwc1VzZXJzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDUpOwoKCXZhciBfdXNlcmdyb3Vwc1VzZXJzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJncm91cHNVc2Vycyk7CgoJdmFyIF91c2VyZ3JvdXBzVXNlcnMzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDYpOwoKCXZhciBfdXNlcmdyb3Vwc1VzZXJzNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJncm91cHNVc2VyczMpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBjcmVhdGU6IF91c2VyZ3JvdXBzMi5kZWZhdWx0LAoJICBkaXNhYmxlOiBfdXNlcmdyb3VwczQuZGVmYXVsdCwKCSAgZW5hYmxlOiBfdXNlcmdyb3VwczYuZGVmYXVsdCwKCSAgbGlzdDogX3VzZXJncm91cHM4LmRlZmF1bHQsCgkgIHVwZGF0ZTogX3VzZXJncm91cHMxMC5kZWZhdWx0LAoJICB1c2VyczogewoJICAgIGxpc3Q6IF91c2VyZ3JvdXBzVXNlcnMyLmRlZmF1bHQsCgkgICAgdXBkYXRlOiBfdXNlcmdyb3Vwc1VzZXJzNC5kZWZhdWx0CgkgIH0KCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE3NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF91c2VycyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQ4KTsKCgl2YXIgX3VzZXJzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJzKTsKCgl2YXIgX3VzZXJzUHJvZmlsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTUyKTsKCgl2YXIgX3VzZXJzUHJvZmlsZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2Vyc1Byb2ZpbGUpOwoKCXZhciBfdXNlcnMzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDkpOwoKCXZhciBfdXNlcnM0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcnMzKTsKCgl2YXIgX3VzZXJzNSA9IF9fd2VicGFja19yZXF1aXJlX18oMTUwKTsKCgl2YXIgX3VzZXJzNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJzNSk7CgoJdmFyIF91c2VyczcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1MSk7CgoJdmFyIF91c2VyczggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyczcpOwoKCXZhciBfdXNlcnM5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTQpOwoKCXZhciBfdXNlcnMxMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJzOSk7CgoJdmFyIF91c2VyczExID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTYpOwoKCXZhciBfdXNlcnMxMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJzMTEpOwoKCXZhciBfdXNlcnNQcm9maWxlMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTUzKTsKCgl2YXIgX3VzZXJzUHJvZmlsZTQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2Vyc1Byb2ZpbGUzKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgZ2V0UHJlc2VuY2U6IF91c2VyczIuZGVmYXVsdCwKCSAgaWRlbnRpdHk6IF91c2VyczQuZGVmYXVsdCwKCSAgaW5mbzogX3VzZXJzNi5kZWZhdWx0LAoJICBsaXN0OiBfdXNlcnM4LmRlZmF1bHQsCgkgIHByb2ZpbGU6IHsKCSAgICBnZXQ6IF91c2Vyc1Byb2ZpbGUyLmRlZmF1bHQsCgkgICAgc2V0OiBfdXNlcnNQcm9maWxlNC5kZWZhdWx0CgkgIH0sCgkgIHNldEFjdGl2ZTogX3VzZXJzMTAuZGVmYXVsdCwKCSAgc2V0UHJlc2VuY2U6IF91c2VyczEyLmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE3NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyB2ZXJzaW9uOiAwLjUuMQoJLy8gZGF0ZTogVHVlIEFwciAxMSAyMDE3IDEwOjEyOjQ5IEdNVCswMTAwIChXRVNUKQoJLy8gbGljZW5jZTogCgkvKioKCSogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCgkqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoJKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKCSogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSoKCSogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkqCgkqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkqCgkqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkqKi8KCgoJKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCQlpZih0cnVlKQoJCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCQllbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkKCQkJZGVmaW5lKCJTeW5jaGVyIiwgW10sIGZhY3RvcnkpOwoJCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCQlleHBvcnRzWyJTeW5jaGVyIl0gPSBmYWN0b3J5KCk7CgkJZWxzZQoJCQlyb290WyIiXSA9IHJvb3RbIiJdIHx8IHt9LCByb290WyIiXVsiU3luY2hlciJdID0gZmFjdG9yeSgpOwoJfSkodGhpcywgZnVuY3Rpb24oKSB7CglyZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAoJLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKCS8qKioqKiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgoJLyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKCS8qKioqKiovCgkvKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQoJLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKCS8qKioqKiovIAkJCXJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzOwoJLyoqKioqKi8KCS8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKCS8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewoJLyoqKioqKi8gCQkJaTogbW9kdWxlSWQsCgkvKioqKioqLyAJCQlsOiBmYWxzZSwKCS8qKioqKiovIAkJCWV4cG9ydHM6IHt9CgkvKioqKioqLyAJCX07CgkvKioqKioqLwoJLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KCS8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7CgkvKioqKioqLwoJLyoqKioqKi8gCQkvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkCgkvKioqKioqLyAJCW1vZHVsZS5sID0gdHJ1ZTsKCS8qKioqKiovCgkvKioqKioqLyAJCS8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlCgkvKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKCS8qKioqKiovIAl9CgkvKioqKioqLwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKQoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlczsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gaWRlbnRpdHkgZnVuY3Rpb24gZm9yIGNhbGxpbmcgaGFybW9ueSBpbXBvcnRzIHdpdGggdGhlIGNvcnJlY3QgY29udGV4dAoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7CgkvKioqKioqLyAJCWlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKCS8qKioqKiovIAkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7CgkvKioqKioqLyAJCQkJY29uZmlndXJhYmxlOiBmYWxzZSwKCS8qKioqKiovIAkJCQllbnVtZXJhYmxlOiB0cnVlLAoJLyoqKioqKi8gCQkJCWdldDogZ2V0dGVyCgkvKioqKioqLyAJCQl9KTsKCS8qKioqKiovIAkJfQoJLyoqKioqKi8gCX07CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7CgkvKioqKioqLyAJCXZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgPwoJLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKCS8qKioqKiovIAkJCWZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07CgkvKioqKioqLyAJCV9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTsKCS8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKCS8qKioqKiovIAl9OwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKCS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gIiI7CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwoJLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDE0Mik7CgkvKioqKioqLyB9KQoJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCS8qKioqKiovIChbCgkvKiAwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJdmFyIGNvcmUgPSBtb2R1bGUuZXhwb3J0cyA9IHt2ZXJzaW9uOiAnMi40LjAnfTsKCWlmKHR5cGVvZiBfX2UgPT0gJ251bWJlcicpX19lID0gY29yZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZgoKCS8qKiovIH0pLAoJLyogMSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy84NiNpc3N1ZWNvbW1lbnQtMTE1NzU5MDI4Cgl2YXIgZ2xvYmFsID0gbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdy5NYXRoID09IE1hdGgKCSAgPyB3aW5kb3cgOiB0eXBlb2Ygc2VsZiAhPSAndW5kZWZpbmVkJyAmJiBzZWxmLk1hdGggPT0gTWF0aCA/IHNlbGYgOiBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpOwoJaWYodHlwZW9mIF9fZyA9PSAnbnVtYmVyJylfX2cgPSBnbG9iYWw7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCgkvKioqLyB9KSwKCS8qIDIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBUaGFuaydzIElFOCBmb3IgaGlzIGZ1bm55IGRlZmluZVByb3BlcnR5Cgltb2R1bGUuZXhwb3J0cyA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewoJICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3OwoJfSk7CgoJLyoqKi8gfSksCgkvKiAzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIHN0b3JlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKSgnd2tzJykKCSAgLCB1aWQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykKCSAgLCBTeW1ib2wgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5TeW1ib2wKCSAgLCBVU0VfU1lNQk9MID0gdHlwZW9mIFN5bWJvbCA9PSAnZnVuY3Rpb24nOwoKCXZhciAkZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obmFtZSl7CgkgIHJldHVybiBzdG9yZVtuYW1lXSB8fCAoc3RvcmVbbmFtZV0gPQoJICAgIFVTRV9TWU1CT0wgJiYgU3ltYm9sW25hbWVdIHx8IChVU0VfU1lNQk9MID8gU3ltYm9sIDogdWlkKSgnU3ltYm9sLicgKyBuYW1lKSk7Cgl9OwoKCSRleHBvcnRzLnN0b3JlID0gc3RvcmU7CgoJLyoqKi8gfSksCgkvKiA0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGFuT2JqZWN0ICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQoJICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKCSAgLCB0b1ByaW1pdGl2ZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpCgkgICwgZFAgICAgICAgICAgICAgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7CgoJZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpewoJICBhbk9iamVjdChPKTsKCSAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwoJICBhbk9iamVjdChBdHRyaWJ1dGVzKTsKCSAgaWYoSUU4X0RPTV9ERUZJTkUpdHJ5IHsKCSAgICByZXR1cm4gZFAoTywgUCwgQXR0cmlidXRlcyk7CgkgIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCSAgaWYoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKXRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhJyk7CgkgIGlmKCd2YWx1ZScgaW4gQXR0cmlidXRlcylPW1BdID0gQXR0cmlidXRlcy52YWx1ZTsKCSAgcmV0dXJuIE87Cgl9OwoKCS8qKiovIH0pLAoJLyogNSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNik7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgaWYoIWlzT2JqZWN0KGl0KSl0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhbiBvYmplY3QhJyk7CgkgIHJldHVybiBpdDsKCX07CgoJLyoqKi8gfSksCgkvKiA2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiB0eXBlb2YgaXQgPT09ICdvYmplY3QnID8gaXQgIT09IG51bGwgOiB0eXBlb2YgaXQgPT09ICdmdW5jdGlvbic7Cgl9OwoKCS8qKiovIH0pLAoJLyogNyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBkUCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQoJICAsIGNyZWF0ZURlc2MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTsKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSA/IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7CgkgIHJldHVybiBkUC5mKG9iamVjdCwga2V5LCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7Cgl9IDogZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKCSAgb2JqZWN0W2tleV0gPSB2YWx1ZTsKCSAgcmV0dXJuIG9iamVjdDsKCX07CgoJLyoqKi8gfSksCgkvKiA4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCWV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKCSAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKCSAgfQoJfTsKCgkvKioqLyB9KSwKCS8qIDkgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgZ2xvYmFsICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQoJICAsIGNvcmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKCSAgLCBjdHggICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQoJICAsIGhpZGUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNykKCSAgLCBQUk9UT1RZUEUgPSAncHJvdG90eXBlJzsKCgl2YXIgJGV4cG9ydCA9IGZ1bmN0aW9uKHR5cGUsIG5hbWUsIHNvdXJjZSl7CgkgIHZhciBJU19GT1JDRUQgPSB0eXBlICYgJGV4cG9ydC5GCgkgICAgLCBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HCgkgICAgLCBJU19TVEFUSUMgPSB0eXBlICYgJGV4cG9ydC5TCgkgICAgLCBJU19QUk9UTyAgPSB0eXBlICYgJGV4cG9ydC5QCgkgICAgLCBJU19CSU5EICAgPSB0eXBlICYgJGV4cG9ydC5CCgkgICAgLCBJU19XUkFQICAgPSB0eXBlICYgJGV4cG9ydC5XCgkgICAgLCBleHBvcnRzICAgPSBJU19HTE9CQUwgPyBjb3JlIDogY29yZVtuYW1lXSB8fCAoY29yZVtuYW1lXSA9IHt9KQoJICAgICwgZXhwUHJvdG8gID0gZXhwb3J0c1tQUk9UT1RZUEVdCgkgICAgLCB0YXJnZXQgICAgPSBJU19HTE9CQUwgPyBnbG9iYWwgOiBJU19TVEFUSUMgPyBnbG9iYWxbbmFtZV0gOiAoZ2xvYmFsW25hbWVdIHx8IHt9KVtQUk9UT1RZUEVdCgkgICAgLCBrZXksIG93biwgb3V0OwoJICBpZihJU19HTE9CQUwpc291cmNlID0gbmFtZTsKCSAgZm9yKGtleSBpbiBzb3VyY2UpewoJICAgIC8vIGNvbnRhaW5zIGluIG5hdGl2ZQoJICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIHRhcmdldFtrZXldICE9PSB1bmRlZmluZWQ7CgkgICAgaWYob3duICYmIGtleSBpbiBleHBvcnRzKWNvbnRpbnVlOwoJICAgIC8vIGV4cG9ydCBuYXRpdmUgb3IgcGFzc2VkCgkgICAgb3V0ID0gb3duID8gdGFyZ2V0W2tleV0gOiBzb3VyY2Vba2V5XTsKCSAgICAvLyBwcmV2ZW50IGdsb2JhbCBwb2xsdXRpb24gZm9yIG5hbWVzcGFjZXMKCSAgICBleHBvcnRzW2tleV0gPSBJU19HTE9CQUwgJiYgdHlwZW9mIHRhcmdldFtrZXldICE9ICdmdW5jdGlvbicgPyBzb3VyY2Vba2V5XQoJICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0CgkgICAgOiBJU19CSU5EICYmIG93biA/IGN0eChvdXQsIGdsb2JhbCkKCSAgICAvLyB3cmFwIGdsb2JhbCBjb25zdHJ1Y3RvcnMgZm9yIHByZXZlbnQgY2hhbmdlIHRoZW0gaW4gbGlicmFyeQoJICAgIDogSVNfV1JBUCAmJiB0YXJnZXRba2V5XSA9PSBvdXQgPyAoZnVuY3Rpb24oQyl7CgkgICAgICB2YXIgRiA9IGZ1bmN0aW9uKGEsIGIsIGMpewoJICAgICAgICBpZih0aGlzIGluc3RhbmNlb2YgQyl7CgkgICAgICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpewoJICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gbmV3IEM7CgkgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBuZXcgQyhhKTsKCSAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBDKGEsIGIpOwoJICAgICAgICAgIH0gcmV0dXJuIG5ldyBDKGEsIGIsIGMpOwoJICAgICAgICB9IHJldHVybiBDLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgkgICAgICB9OwoJICAgICAgRltQUk9UT1RZUEVdID0gQ1tQUk9UT1RZUEVdOwoJICAgICAgcmV0dXJuIEY7CgkgICAgLy8gbWFrZSBzdGF0aWMgdmVyc2lvbnMgZm9yIHByb3RvdHlwZSBtZXRob2RzCgkgICAgfSkob3V0KSA6IElTX1BST1RPICYmIHR5cGVvZiBvdXQgPT0gJ2Z1bmN0aW9uJyA/IGN0eChGdW5jdGlvbi5jYWxsLCBvdXQpIDogb3V0OwoJICAgIC8vIGV4cG9ydCBwcm90byBtZXRob2RzIHRvIGNvcmUuJUNPTlNUUlVDVE9SJS5tZXRob2RzLiVOQU1FJQoJICAgIGlmKElTX1BST1RPKXsKCSAgICAgIChleHBvcnRzLnZpcnR1YWwgfHwgKGV4cG9ydHMudmlydHVhbCA9IHt9KSlba2V5XSA9IG91dDsKCSAgICAgIC8vIGV4cG9ydCBwcm90byBtZXRob2RzIHRvIGNvcmUuJUNPTlNUUlVDVE9SJS5wcm90b3R5cGUuJU5BTUUlCgkgICAgICBpZih0eXBlICYgJGV4cG9ydC5SICYmIGV4cFByb3RvICYmICFleHBQcm90b1trZXldKWhpZGUoZXhwUHJvdG8sIGtleSwgb3V0KTsKCSAgICB9CgkgIH0KCX07CgkvLyB0eXBlIGJpdG1hcAoJJGV4cG9ydC5GID0gMTsgICAvLyBmb3JjZWQKCSRleHBvcnQuRyA9IDI7ICAgLy8gZ2xvYmFsCgkkZXhwb3J0LlMgPSA0OyAgIC8vIHN0YXRpYwoJJGV4cG9ydC5QID0gODsgICAvLyBwcm90bwoJJGV4cG9ydC5CID0gMTY7ICAvLyBiaW5kCgkkZXhwb3J0LlcgPSAzMjsgIC8vIHdyYXAKCSRleHBvcnQuVSA9IDY0OyAgLy8gc2FmZQoJJGV4cG9ydC5SID0gMTI4OyAvLyByZWFsIHByb3RvIG1ldGhvZCBmb3IgYGxpYnJhcnlgIAoJbW9kdWxlLmV4cG9ydHMgPSAkZXhwb3J0OwoKCS8qKiovIH0pLAoJLyogMTAgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJdmFyIF9kZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMzMpOwoKCXZhciBfZGVmaW5lUHJvcGVydHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVmaW5lUHJvcGVydHkpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkgewoJICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CgkgICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwoJICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwoJICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwoJICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CgkgICAgICAoMCwgX2RlZmluZVByb3BlcnR5Mi5kZWZhdWx0KSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKCSAgICB9CgkgIH0KCgkgIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CgkgICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKCSAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKCSAgICByZXR1cm4gQ29uc3RydWN0b3I7CgkgIH07Cgl9KCk7CgoJLyoqKi8gfSksCgkvKiAxMSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYyl7CgkgIHRyeSB7CgkgICAgcmV0dXJuICEhZXhlYygpOwoJICB9IGNhdGNoKGUpewoJICAgIHJldHVybiB0cnVlOwoJICB9Cgl9OwoKCS8qKiovIH0pLAoJLyogMTIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgl2YXIgaGFzT3duUHJvcGVydHkgPSB7fS5oYXNPd25Qcm9wZXJ0eTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIGtleSl7CgkgIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGl0LCBrZXkpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDEzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzCgl2YXIgSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpCgkgICwgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiBJT2JqZWN0KGRlZmluZWQoaXQpKTsKCX07CgoJLyoqKi8gfSksCgkvKiAxNCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZwoJdmFyIGFGdW5jdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmbiwgdGhhdCwgbGVuZ3RoKXsKCSAgYUZ1bmN0aW9uKGZuKTsKCSAgaWYodGhhdCA9PT0gdW5kZWZpbmVkKXJldHVybiBmbjsKCSAgc3dpdGNoKGxlbmd0aCl7CgkgICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7CgkgICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhKTsKCSAgICB9OwoJICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpewoJICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYik7CgkgICAgfTsKCSAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsKCSAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIsIGMpOwoJICAgIH07CgkgIH0KCSAgcmV0dXJuIGZ1bmN0aW9uKC8qIC4uLmFyZ3MgKi8pewoJICAgIHJldHVybiBmbi5hcHBseSh0aGF0LCBhcmd1bWVudHMpOwoJICB9OwoJfTsKCgkvKioqLyB9KSwKCS8qIDE1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiaXRtYXAsIHZhbHVlKXsKCSAgcmV0dXJuIHsKCSAgICBlbnVtZXJhYmxlICA6ICEoYml0bWFwICYgMSksCgkgICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLAoJICAgIHdyaXRhYmxlICAgIDogIShiaXRtYXAgJiA0KSwKCSAgICB2YWx1ZSAgICAgICA6IHZhbHVlCgkgIH07Cgl9OwoKCS8qKiovIH0pLAoJLyogMTYgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgltb2R1bGUuZXhwb3J0cyA9IHt9OwoKCS8qKiovIH0pLAoJLyogMTcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCgkgICwgZG9jdW1lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLmRvY3VtZW50CgkgIC8vIGluIG9sZCBJRSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JwoJICAsIGlzID0gaXNPYmplY3QoZG9jdW1lbnQpICYmIGlzT2JqZWN0KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307Cgl9OwoKCS8qKiovIH0pLAoJLyogMTggKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjIuMTQgLyAxNS4yLjMuMTQgT2JqZWN0LmtleXMoTykKCXZhciAka2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCgkgICwgZW51bUJ1Z0tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KTsKCgltb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIGtleXMoTyl7CgkgIHJldHVybiAka2V5cyhPLCBlbnVtQnVnS2V5cyk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMTkgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTsKCSAgcmV0dXJuIGl0OwoJfTsKCgkvKioqLyB9KSwKCS8qIDIwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiB0b1N0cmluZy5jYWxsKGl0KS5zbGljZSg4LCAtMSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMjEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSkKCXZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CgkvLyBpbnN0ZWFkIG9mIHRoZSBFUzYgc3BlYyB2ZXJzaW9uLCB3ZSBkaWRuJ3QgaW1wbGVtZW50IEBAdG9QcmltaXRpdmUgY2FzZQoJLy8gYW5kIHRoZSBzZWNvbmQgYXJndW1lbnQgLSBmbGFnIC0gcHJlZmVycmVkIHR5cGUgaXMgYSBzdHJpbmcKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIFMpewoJICBpZighaXNPYmplY3QoaXQpKXJldHVybiBpdDsKCSAgdmFyIGZuLCB2YWw7CgkgIGlmKFMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKCSAgaWYodHlwZW9mIChmbiA9IGl0LnZhbHVlT2YpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwoJICBpZighUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwoJICB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDIyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGRlZiA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgoJICAsIGhhcyA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCgkgICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgndG9TdHJpbmdUYWcnKTsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCB0YWcsIHN0YXQpewoJICBpZihpdCAmJiAhaGFzKGl0ID0gc3RhdCA/IGl0IDogaXQucHJvdG90eXBlLCBUQUcpKWRlZihpdCwgVEFHLCB7Y29uZmlndXJhYmxlOiB0cnVlLCB2YWx1ZTogdGFnfSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMjMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgl2YXIgaWQgPSAwCgkgICwgcHggPSBNYXRoLnJhbmRvbSgpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewoJICByZXR1cm4gJ1N5bWJvbCgnLmNvbmNhdChrZXkgPT09IHVuZGVmaW5lZCA/ICcnIDoga2V5LCAnKV8nLCAoKytpZCArIHB4KS50b1N0cmluZygzNikpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDI0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudCkKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewoJICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIiArIGl0KTsKCSAgcmV0dXJuIGl0OwoJfTsKCgkvKioqLyB9KSwKCS8qIDI1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygyKSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKCSAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KSgnZGl2JyksICdhJywge2dldDogZnVuY3Rpb24oKXsgcmV0dXJuIDc7IH19KS5hICE9IDc7Cgl9KTsKCgkvKioqLyB9KSwKCS8qIDI2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB0cnVlOwoKCS8qKiovIH0pLAoJLyogMjcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgc2hhcmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ2tleXMnKQoJICAsIHVpZCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewoJICByZXR1cm4gc2hhcmVkW2tleV0gfHwgKHNoYXJlZFtrZXldID0gdWlkKGtleSkpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDI4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gNy4xLjQgVG9JbnRlZ2VyCgl2YXIgY2VpbCAgPSBNYXRoLmNlaWwKCSAgLCBmbG9vciA9IE1hdGguZmxvb3I7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgcmV0dXJuIGlzTmFOKGl0ID0gK2l0KSA/IDAgOiAoaXQgPiAwID8gZmxvb3IgOiBjZWlsKShpdCk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMjkgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzCgltb2R1bGUuZXhwb3J0cyA9ICgKCSAgJ2NvbnN0cnVjdG9yLGhhc093blByb3BlcnR5LGlzUHJvdG90eXBlT2YscHJvcGVydHlJc0VudW1lcmFibGUsdG9Mb2NhbGVTdHJpbmcsdG9TdHJpbmcsdmFsdWVPZicKCSkuc3BsaXQoJywnKTsKCgkvKioqLyB9KSwKCS8qIDMwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGdsb2JhbCA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKCSAgLCBTSEFSRUQgPSAnX19jb3JlLWpzX3NoYXJlZF9fJwoJICAsIHN0b3JlICA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsKCSAgcmV0dXJuIHN0b3JlW2tleV0gfHwgKHN0b3JlW2tleV0gPSB7fSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMzEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKCS8qKiovIH0pLAoJLyogMzIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyA3LjEuMTMgVG9PYmplY3QoYXJndW1lbnQpCgl2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiBPYmplY3QoZGVmaW5lZChpdCkpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDMzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygzNiksIF9fZXNNb2R1bGU6IHRydWUgfTsKCgkvKioqLyB9KSwKCS8qIDM0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCXZhciBfc2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc2KTsKCgl2YXIgX3NldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NldFByb3RvdHlwZU9mKTsKCgl2YXIgX2NyZWF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNzUpOwoKCXZhciBfY3JlYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZSk7CgoJdmFyIF90eXBlb2YyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OSk7CgoJdmFyIF90eXBlb2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHlwZW9mMik7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKCSAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHN1cGVyQ2xhc3MgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoc3VwZXJDbGFzcykpKTsKCSAgfQoKCSAgc3ViQ2xhc3MucHJvdG90eXBlID0gKDAsIF9jcmVhdGUyLmRlZmF1bHQpKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsKCSAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgdmFsdWU6IHN1YkNsYXNzLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQoJICAgIH0KCSAgfSk7CgkgIGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2YyLmRlZmF1bHQgPyAoMCwgX3NldFByb3RvdHlwZU9mMi5kZWZhdWx0KShzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOwoJfTsKCgkvKioqLyB9KSwKCS8qIDM1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCXZhciBfdHlwZW9mMiA9IF9fd2VicGFja19yZXF1aXJlX18oNTkpOwoKCXZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKHNlbGYsIGNhbGwpIHsKCSAgaWYgKCFzZWxmKSB7CgkgICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKCSAgfQoKCSAgcmV0dXJuIGNhbGwgJiYgKCh0eXBlb2YgY2FsbCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6ICgwLCBfdHlwZW9mMy5kZWZhdWx0KShjYWxsKSkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOwoJfTsKCgkvKioqLyB9KSwKCS8qIDM2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygzOCk7Cgl2YXIgJE9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0OwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKXsKCSAgcmV0dXJuICRPYmplY3QuZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMzcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKCXZhciBhbk9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKCSAgLCBkUHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpCgkgICwgZW51bUJ1Z0tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KQoJICAsIElFX1BST1RPICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykoJ0lFX1BST1RPJykKCSAgLCBFbXB0eSAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KCSAgLCBQUk9UT1RZUEUgICA9ICdwcm90b3R5cGUnOwoKCS8vIENyZWF0ZSBvYmplY3Qgd2l0aCBmYWtlIGBudWxsYCBwcm90b3R5cGU6IHVzZSBpZnJhbWUgT2JqZWN0IHdpdGggY2xlYXJlZCBwcm90b3R5cGUKCXZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24oKXsKCSAgLy8gVGhyYXNoLCB3YXN0ZSBhbmQgc29kb215OiBJRSBHQyBidWcKCSAgdmFyIGlmcmFtZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpKCdpZnJhbWUnKQoJICAgICwgaSAgICAgID0gZW51bUJ1Z0tleXMubGVuZ3RoCgkgICAgLCBsdCAgICAgPSAnPCcKCSAgICAsIGd0ICAgICA9ICc+JwoJICAgICwgaWZyYW1lRG9jdW1lbnQ7CgkgIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwoJICBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKS5hcHBlbmRDaGlsZChpZnJhbWUpOwoJICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsCgkgIC8vIGNyZWF0ZURpY3QgPSBpZnJhbWUuY29udGVudFdpbmRvdy5PYmplY3Q7CgkgIC8vIGh0bWwucmVtb3ZlQ2hpbGQoaWZyYW1lKTsKCSAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKCSAgaWZyYW1lRG9jdW1lbnQub3BlbigpOwoJICBpZnJhbWVEb2N1bWVudC53cml0ZShsdCArICdzY3JpcHQnICsgZ3QgKyAnZG9jdW1lbnQuRj1PYmplY3QnICsgbHQgKyAnL3NjcmlwdCcgKyBndCk7CgkgIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7CgkgIGNyZWF0ZURpY3QgPSBpZnJhbWVEb2N1bWVudC5GOwoJICB3aGlsZShpLS0pZGVsZXRlIGNyZWF0ZURpY3RbUFJPVE9UWVBFXVtlbnVtQnVnS2V5c1tpXV07CgkgIHJldHVybiBjcmVhdGVEaWN0KCk7Cgl9OwoKCW1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBjcmVhdGUoTywgUHJvcGVydGllcyl7CgkgIHZhciByZXN1bHQ7CgkgIGlmKE8gIT09IG51bGwpewoJICAgIEVtcHR5W1BST1RPVFlQRV0gPSBhbk9iamVjdChPKTsKCSAgICByZXN1bHQgPSBuZXcgRW1wdHk7CgkgICAgRW1wdHlbUFJPVE9UWVBFXSA9IG51bGw7CgkgICAgLy8gYWRkICJfX3Byb3RvX18iIGZvciBPYmplY3QuZ2V0UHJvdG90eXBlT2YgcG9seWZpbGwKCSAgICByZXN1bHRbSUVfUFJPVE9dID0gTzsKCSAgfSBlbHNlIHJlc3VsdCA9IGNyZWF0ZURpY3QoKTsKCSAgcmV0dXJuIFByb3BlcnRpZXMgPT09IHVuZGVmaW5lZCA/IHJlc3VsdCA6IGRQcyhyZXN1bHQsIFByb3BlcnRpZXMpOwoJfTsKCgoJLyoqKi8gfSksCgkvKiAzOCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCS8vIDE5LjEuMi40IC8gMTUuMi4zLjYgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCgkkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFfX3dlYnBhY2tfcmVxdWlyZV9fKDIpLCAnT2JqZWN0Jywge2RlZmluZVByb3BlcnR5OiBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmZ9KTsKCgkvKioqLyB9KSwKCS8qIDM5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCXZhciBMSUJSQVJZICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpCgkgICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpCgkgICwgcmVkZWZpbmUgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ2KQoJICAsIGhpZGUgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KQoJICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKCSAgLCBJdGVyYXRvcnMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCgkgICwgJGl0ZXJDcmVhdGUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYyKQoJICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKCSAgLCBnZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oNDMpCgkgICwgSVRFUkFUT1IgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdpdGVyYXRvcicpCgkgICwgQlVHR1kgICAgICAgICAgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSkgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YAoJICAsIEZGX0lURVJBVE9SICAgID0gJ0BAaXRlcmF0b3InCgkgICwgS0VZUyAgICAgICAgICAgPSAna2V5cycKCSAgLCBWQUxVRVMgICAgICAgICA9ICd2YWx1ZXMnOwoKCXZhciByZXR1cm5UaGlzID0gZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH07CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihCYXNlLCBOQU1FLCBDb25zdHJ1Y3RvciwgbmV4dCwgREVGQVVMVCwgSVNfU0VULCBGT1JDRUQpewoJICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7CgkgIHZhciBnZXRNZXRob2QgPSBmdW5jdGlvbihraW5kKXsKCSAgICBpZighQlVHR1kgJiYga2luZCBpbiBwcm90bylyZXR1cm4gcHJvdG9ba2luZF07CgkgICAgc3dpdGNoKGtpbmQpewoJICAgICAgY2FzZSBLRVlTOiByZXR1cm4gZnVuY3Rpb24ga2V5cygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9OwoJICAgICAgY2FzZSBWQUxVRVM6IHJldHVybiBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTsKCSAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CgkgIH07CgkgIHZhciBUQUcgICAgICAgID0gTkFNRSArICcgSXRlcmF0b3InCgkgICAgLCBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVMKCSAgICAsIFZBTFVFU19CVUcgPSBmYWxzZQoJICAgICwgcHJvdG8gICAgICA9IEJhc2UucHJvdG90eXBlCgkgICAgLCAkbmF0aXZlICAgID0gcHJvdG9bSVRFUkFUT1JdIHx8IHByb3RvW0ZGX0lURVJBVE9SXSB8fCBERUZBVUxUICYmIHByb3RvW0RFRkFVTFRdCgkgICAgLCAkZGVmYXVsdCAgID0gJG5hdGl2ZSB8fCBnZXRNZXRob2QoREVGQVVMVCkKCSAgICAsICRlbnRyaWVzICAgPSBERUZBVUxUID8gIURFRl9WQUxVRVMgPyAkZGVmYXVsdCA6IGdldE1ldGhvZCgnZW50cmllcycpIDogdW5kZWZpbmVkCgkgICAgLCAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZQoJICAgICwgbWV0aG9kcywga2V5LCBJdGVyYXRvclByb3RvdHlwZTsKCSAgLy8gRml4IG5hdGl2ZQoJICBpZigkYW55TmF0aXZlKXsKCSAgICBJdGVyYXRvclByb3RvdHlwZSA9IGdldFByb3RvdHlwZU9mKCRhbnlOYXRpdmUuY2FsbChuZXcgQmFzZSkpOwoJICAgIGlmKEl0ZXJhdG9yUHJvdG90eXBlICE9PSBPYmplY3QucHJvdG90eXBlKXsKCSAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnMKCSAgICAgIHNldFRvU3RyaW5nVGFnKEl0ZXJhdG9yUHJvdG90eXBlLCBUQUcsIHRydWUpOwoJICAgICAgLy8gZml4IGZvciBzb21lIG9sZCBlbmdpbmVzCgkgICAgICBpZighTElCUkFSWSAmJiAhaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikpaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwoJICAgIH0KCSAgfQoJICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGCgkgIGlmKERFRl9WQUxVRVMgJiYgJG5hdGl2ZSAmJiAkbmF0aXZlLm5hbWUgIT09IFZBTFVFUyl7CgkgICAgVkFMVUVTX0JVRyA9IHRydWU7CgkgICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTsKCSAgfQoJICAvLyBEZWZpbmUgaXRlcmF0b3IKCSAgaWYoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpewoJICAgIGhpZGUocHJvdG8sIElURVJBVE9SLCAkZGVmYXVsdCk7CgkgIH0KCSAgLy8gUGx1ZyBmb3IgbGlicmFyeQoJICBJdGVyYXRvcnNbTkFNRV0gPSAkZGVmYXVsdDsKCSAgSXRlcmF0b3JzW1RBR10gID0gcmV0dXJuVGhpczsKCSAgaWYoREVGQVVMVCl7CgkgICAgbWV0aG9kcyA9IHsKCSAgICAgIHZhbHVlczogIERFRl9WQUxVRVMgPyAkZGVmYXVsdCA6IGdldE1ldGhvZChWQUxVRVMpLAoJICAgICAga2V5czogICAgSVNfU0VUICAgICA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLAoJICAgICAgZW50cmllczogJGVudHJpZXMKCSAgICB9OwoJICAgIGlmKEZPUkNFRClmb3Ioa2V5IGluIG1ldGhvZHMpewoJICAgICAgaWYoIShrZXkgaW4gcHJvdG8pKXJlZGVmaW5lKHByb3RvLCBrZXksIG1ldGhvZHNba2V5XSk7CgkgICAgfSBlbHNlICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKEJVR0dZIHx8IFZBTFVFU19CVUcpLCBOQU1FLCBtZXRob2RzKTsKCSAgfQoJICByZXR1cm4gbWV0aG9kczsKCX07CgoJLyoqKi8gfSksCgkvKiA0MCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNTMpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiA0MSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCWV4cG9ydHMuZiA9IHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlOwoKCS8qKiovIH0pLAoJLyogNDIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZG9jdW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKCS8qKiovIH0pLAoJLyogNDMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjIuOSAvIDE1LjIuMy4yIE9iamVjdC5nZXRQcm90b3R5cGVPZihPKQoJdmFyIGhhcyAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKCSAgLCB0b09iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCgkgICwgSUVfUFJPVE8gICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KSgnSUVfUFJPVE8nKQoJICAsIE9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTsKCgltb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihPKXsKCSAgTyA9IHRvT2JqZWN0KE8pOwoJICBpZihoYXMoTywgSUVfUFJPVE8pKXJldHVybiBPW0lFX1BST1RPXTsKCSAgaWYodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcil7CgkgICAgcmV0dXJuIE8uY29uc3RydWN0b3IucHJvdG90eXBlOwoJICB9IHJldHVybiBPIGluc3RhbmNlb2YgT2JqZWN0ID8gT2JqZWN0UHJvdG8gOiBudWxsOwoJfTsKCgkvKioqLyB9KSwKCS8qIDQ0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGhhcyAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCgkgICwgdG9JT2JqZWN0ICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKCSAgLCBhcnJheUluZGV4T2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKShmYWxzZSkKCSAgLCBJRV9QUk9UTyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KSgnSUVfUFJPVE8nKTsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgbmFtZXMpewoJICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKCSAgICAsIGkgICAgICA9IDAKCSAgICAsIHJlc3VsdCA9IFtdCgkgICAgLCBrZXk7CgkgIGZvcihrZXkgaW4gTylpZihrZXkgIT0gSUVfUFJPVE8paGFzKE8sIGtleSkgJiYgcmVzdWx0LnB1c2goa2V5KTsKCSAgLy8gRG9uJ3QgZW51bSBidWcgJiBoaWRkZW4ga2V5cwoJICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKWlmKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSl7CgkgICAgfmFycmF5SW5kZXhPZihyZXN1bHQsIGtleSkgfHwgcmVzdWx0LnB1c2goa2V5KTsKCSAgfQoJICByZXR1cm4gcmVzdWx0OwoJfTsKCgkvKioqLyB9KSwKCS8qIDQ1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gbW9zdCBPYmplY3QgbWV0aG9kcyBieSBFUzYgc2hvdWxkIGFjY2VwdCBwcmltaXRpdmVzCgl2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOSkKCSAgLCBjb3JlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQoJICAsIGZhaWxzICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBleGVjKXsKCSAgdmFyIGZuICA9IChjb3JlLk9iamVjdCB8fCB7fSlbS0VZXSB8fCBPYmplY3RbS0VZXQoJICAgICwgZXhwID0ge307CgkgIGV4cFtLRVldID0gZXhlYyhmbik7CgkgICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogZmFpbHMoZnVuY3Rpb24oKXsgZm4oMSk7IH0pLCAnT2JqZWN0JywgZXhwKTsKCX07CgoJLyoqKi8gfSksCgkvKiA0NiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKCgkvKioqLyB9KSwKCS8qIDQ3ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gNy4xLjE1IFRvTGVuZ3RoCgl2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkKCSAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewoJICByZXR1cm4gaXQgPiAwID8gbWluKHRvSW50ZWdlcihpdCksIDB4MWZmZmZmZmZmZmZmZmYpIDogMDsgLy8gcG93KDIsIDUzKSAtIDEgPT0gOTAwNzE5OTI1NDc0MDk5MQoJfTsKCgkvKioqLyB9KSwKCS8qIDQ4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGdsb2JhbCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQoJICAsIGNvcmUgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQoJICAsIExJQlJBUlkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNikKCSAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCgkgICwgZGVmaW5lUHJvcGVydHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmY7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewoJICB2YXIgJFN5bWJvbCA9IGNvcmUuU3ltYm9sIHx8IChjb3JlLlN5bWJvbCA9IExJQlJBUlkgPyB7fSA6IGdsb2JhbC5TeW1ib2wgfHwge30pOwoJICBpZihuYW1lLmNoYXJBdCgwKSAhPSAnXycgJiYgIShuYW1lIGluICRTeW1ib2wpKWRlZmluZVByb3BlcnR5KCRTeW1ib2wsIG5hbWUsIHt2YWx1ZTogd2tzRXh0LmYobmFtZSl9KTsKCX07CgoJLyoqKi8gfSksCgkvKiA0OSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCWV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJLyoqKi8gfSksCgkvKiA1MCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgl2YXIgJGF0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNjYpKHRydWUpOwoKCS8vIDIxLjEuMy4yNyBTdHJpbmcucHJvdG90eXBlW0BAaXRlcmF0b3JdKCkKCV9fd2VicGFja19yZXF1aXJlX18oMzkpKFN0cmluZywgJ1N0cmluZycsIGZ1bmN0aW9uKGl0ZXJhdGVkKXsKCSAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldAoJICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleAoJLy8gMjEuMS41LjIuMSAlU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUlLm5leHQoKQoJfSwgZnVuY3Rpb24oKXsKCSAgdmFyIE8gICAgID0gdGhpcy5fdAoJICAgICwgaW5kZXggPSB0aGlzLl9pCgkgICAgLCBwb2ludDsKCSAgaWYoaW5kZXggPj0gTy5sZW5ndGgpcmV0dXJuIHt2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlfTsKCSAgcG9pbnQgPSAkYXQoTywgaW5kZXgpOwoJICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDsKCSAgcmV0dXJuIHt2YWx1ZTogcG9pbnQsIGRvbmU6IGZhbHNlfTsKCX0pOwoKCS8qKiovIH0pLAoJLyogNTEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDY5KTsKCXZhciBnbG9iYWwgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQoJICAsIGhpZGUgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCgkgICwgSXRlcmF0b3JzICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCgkgICwgVE9fU1RSSU5HX1RBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMykoJ3RvU3RyaW5nVGFnJyk7CgoJZm9yKHZhciBjb2xsZWN0aW9ucyA9IFsnTm9kZUxpc3QnLCAnRE9NVG9rZW5MaXN0JywgJ01lZGlhTGlzdCcsICdTdHlsZVNoZWV0TGlzdCcsICdDU1NSdWxlTGlzdCddLCBpID0gMDsgaSA8IDU7IGkrKyl7CgkgIHZhciBOQU1FICAgICAgID0gY29sbGVjdGlvbnNbaV0KCSAgICAsIENvbGxlY3Rpb24gPSBnbG9iYWxbTkFNRV0KCSAgICAsIHByb3RvICAgICAgPSBDb2xsZWN0aW9uICYmIENvbGxlY3Rpb24ucHJvdG90eXBlOwoJICBpZihwcm90byAmJiAhcHJvdG9bVE9fU1RSSU5HX1RBR10paGlkZShwcm90bywgVE9fU1RSSU5HX1RBRywgTkFNRSk7CgkgIEl0ZXJhdG9yc1tOQU1FXSA9IEl0ZXJhdG9ycy5BcnJheTsKCX0KCgkvKioqLyB9KSwKCS8qIDUyICovLAoJLyogNTMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgY29yZSAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCgkgICwgJEpTT04gPSBjb3JlLkpTT04gfHwgKGNvcmUuSlNPTiA9IHtzdHJpbmdpZnk6IEpTT04uc3RyaW5naWZ5fSk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKCSAgcmV0dXJuICRKU09OLnN0cmluZ2lmeS5hcHBseSgkSlNPTiwgYXJndW1lbnRzKTsKCX07CgoJLyoqKi8gfSksCgkvKiA1NCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCgoJLyoqKi8gfSksCgkvKiA1NSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGdldHRpbmcgdGFnIGZyb20gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpCgl2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCkKCSAgLCBUQUcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCd0b1N0cmluZ1RhZycpCgkgIC8vIEVTMyB3cm9uZyBoZXJlCgkgICwgQVJHID0gY29mKGZ1bmN0aW9uKCl7IHJldHVybiBhcmd1bWVudHM7IH0oKSkgPT0gJ0FyZ3VtZW50cyc7CgoJLy8gZmFsbGJhY2sgZm9yIElFMTEgU2NyaXB0IEFjY2VzcyBEZW5pZWQgZXJyb3IKCXZhciB0cnlHZXQgPSBmdW5jdGlvbihpdCwga2V5KXsKCSAgdHJ5IHsKCSAgICByZXR1cm4gaXRba2V5XTsKCSAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQoJfTsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgdmFyIE8sIFQsIEI7CgkgIHJldHVybiBpdCA9PT0gdW5kZWZpbmVkID8gJ1VuZGVmaW5lZCcgOiBpdCA9PT0gbnVsbCA/ICdOdWxsJwoJICAgIC8vIEBAdG9TdHJpbmdUYWcgY2FzZQoJICAgIDogdHlwZW9mIChUID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUQUcpKSA9PSAnc3RyaW5nJyA/IFQKCSAgICAvLyBidWlsdGluVGFnIGNhc2UKCSAgICA6IEFSRyA/IGNvZihPKQoJICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2sKCSAgICA6IChCID0gY29mKE8pKSA9PSAnT2JqZWN0JyAmJiB0eXBlb2YgTy5jYWxsZWUgPT0gJ2Z1bmN0aW9uJyA/ICdBcmd1bWVudHMnIDogQjsKCX07CgoJLyoqKi8gfSksCgkvKiA1NiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzCgl2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7Cgltb2R1bGUuZXhwb3J0cyA9IE9iamVjdCgneicpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApID8gT2JqZWN0IDogZnVuY3Rpb24oaXQpewoJICByZXR1cm4gY29mKGl0KSA9PSAnU3RyaW5nJyA/IGl0LnNwbGl0KCcnKSA6IE9iamVjdChpdCk7Cgl9OwoKCS8qKiovIH0pLAoJLyogNTcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgcElFICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQxKQoJICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKCSAgLCB0b0lPYmplY3QgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCgkgICwgdG9QcmltaXRpdmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQoJICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKCSAgLCBJRThfRE9NX0RFRklORSA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpCgkgICwgZ09QRCAgICAgICAgICAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwoKCWV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMikgPyBnT1BEIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApewoJICBPID0gdG9JT2JqZWN0KE8pOwoJICBQID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSk7CgkgIGlmKElFOF9ET01fREVGSU5FKXRyeSB7CgkgICAgcmV0dXJuIGdPUEQoTywgUCk7CgkgIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCSAgaWYoaGFzKE8sIFApKXJldHVybiBjcmVhdGVEZXNjKCFwSUUuZi5jYWxsKE8sIFApLCBPW1BdKTsKCX07CgoJLyoqKi8gfSksCgkvKiA1OCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCWV4cG9ydHMuZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7CgoJLyoqKi8gfSksCgkvKiA1OSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgl2YXIgX2l0ZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3OCk7CgoJdmFyIF9pdGVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pdGVyYXRvcik7CgoJdmFyIF9zeW1ib2wgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc3KTsKCgl2YXIgX3N5bWJvbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zeW1ib2wpOwoKCXZhciBfdHlwZW9mID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIF9pdGVyYXRvcjIuZGVmYXVsdCA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgX3R5cGVvZihfaXRlcmF0b3IyLmRlZmF1bHQpID09PSAic3ltYm9sIiA/IGZ1bmN0aW9uIChvYmopIHsKCSAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG9iaik7Cgl9IDogZnVuY3Rpb24gKG9iaikgewoJICByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihvYmopOwoJfTsKCgkvKioqLyB9KSwKCS8qIDYwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9OwoKCS8qKiovIH0pLAoJLyogNjEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBmYWxzZSAtPiBBcnJheSNpbmRleE9mCgkvLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlcwoJdmFyIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCgkgICwgdG9MZW5ndGggID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NykKCSAgLCB0b0luZGV4ICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY4KTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oSVNfSU5DTFVERVMpewoJICByZXR1cm4gZnVuY3Rpb24oJHRoaXMsIGVsLCBmcm9tSW5kZXgpewoJICAgIHZhciBPICAgICAgPSB0b0lPYmplY3QoJHRoaXMpCgkgICAgICAsIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKQoJICAgICAgLCBpbmRleCAgPSB0b0luZGV4KGZyb21JbmRleCwgbGVuZ3RoKQoJICAgICAgLCB2YWx1ZTsKCSAgICAvLyBBcnJheSNpbmNsdWRlcyB1c2VzIFNhbWVWYWx1ZVplcm8gZXF1YWxpdHkgYWxnb3JpdGhtCgkgICAgaWYoSVNfSU5DTFVERVMgJiYgZWwgIT0gZWwpd2hpbGUobGVuZ3RoID4gaW5kZXgpewoJICAgICAgdmFsdWUgPSBPW2luZGV4KytdOwoJICAgICAgaWYodmFsdWUgIT0gdmFsdWUpcmV0dXJuIHRydWU7CgkgICAgLy8gQXJyYXkjdG9JbmRleCBpZ25vcmVzIGhvbGVzLCBBcnJheSNpbmNsdWRlcyAtIG5vdAoJICAgIH0gZWxzZSBmb3IoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKWlmKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pewoJICAgICAgaWYoT1tpbmRleF0gPT09IGVsKXJldHVybiBJU19JTkNMVURFUyB8fCBpbmRleCB8fCAwOwoJICAgIH0gcmV0dXJuICFJU19JTkNMVURFUyAmJiAtMTsKCSAgfTsKCX07CgoJLyoqKi8gfSksCgkvKiA2MiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgl2YXIgY3JlYXRlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM3KQoJICAsIGRlc2NyaXB0b3IgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKCSAgLCBzZXRUb1N0cmluZ1RhZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjIpCgkgICwgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTsKCgkvLyAyNS4xLjIuMS4xICVJdGVyYXRvclByb3RvdHlwZSVbQEBpdGVyYXRvcl0oKQoJX193ZWJwYWNrX3JlcXVpcmVfXyg3KShJdGVyYXRvclByb3RvdHlwZSwgX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnaXRlcmF0b3InKSwgZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH0pOwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpewoJICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSBjcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUsIHtuZXh0OiBkZXNjcmlwdG9yKDEsIG5leHQpfSk7CgkgIHNldFRvU3RyaW5nVGFnKENvbnN0cnVjdG9yLCBOQU1FICsgJyBJdGVyYXRvcicpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDYzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihkb25lLCB2YWx1ZSl7CgkgIHJldHVybiB7dmFsdWU6IHZhbHVlLCBkb25lOiAhIWRvbmV9OwoJfTsKCgkvKioqLyB9KSwKCS8qIDY0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGRQICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQoJICAsIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQoJICAsIGdldEtleXMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7CgoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpewoJICBhbk9iamVjdChPKTsKCSAgdmFyIGtleXMgICA9IGdldEtleXMoUHJvcGVydGllcykKCSAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCgkgICAgLCBpID0gMAoJICAgICwgUDsKCSAgd2hpbGUobGVuZ3RoID4gaSlkUC5mKE8sIFAgPSBrZXlzW2krK10sIFByb3BlcnRpZXNbUF0pOwoJICByZXR1cm4gTzsKCX07CgoJLyoqKi8gfSksCgkvKiA2NSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIDE5LjEuMi43IC8gMTUuMi4zLjQgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKCXZhciAka2V5cyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NCkKCSAgLCBoaWRkZW5LZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7CgoJZXhwb3J0cy5mID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgfHwgZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhPKXsKCSAgcmV0dXJuICRrZXlzKE8sIGhpZGRlbktleXMpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDY2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCgkgICwgZGVmaW5lZCAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7CgkvLyB0cnVlICAtPiBTdHJpbmcjYXQKCS8vIGZhbHNlIC0+IFN0cmluZyNjb2RlUG9pbnRBdAoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihUT19TVFJJTkcpewoJICByZXR1cm4gZnVuY3Rpb24odGhhdCwgcG9zKXsKCSAgICB2YXIgcyA9IFN0cmluZyhkZWZpbmVkKHRoYXQpKQoJICAgICAgLCBpID0gdG9JbnRlZ2VyKHBvcykKCSAgICAgICwgbCA9IHMubGVuZ3RoCgkgICAgICAsIGEsIGI7CgkgICAgaWYoaSA8IDAgfHwgaSA+PSBsKXJldHVybiBUT19TVFJJTkcgPyAnJyA6IHVuZGVmaW5lZDsKCSAgICBhID0gcy5jaGFyQ29kZUF0KGkpOwoJICAgIHJldHVybiBhIDwgMHhkODAwIHx8IGEgPiAweGRiZmYgfHwgaSArIDEgPT09IGwgfHwgKGIgPSBzLmNoYXJDb2RlQXQoaSArIDEpKSA8IDB4ZGMwMCB8fCBiID4gMHhkZmZmCgkgICAgICA/IFRPX1NUUklORyA/IHMuY2hhckF0KGkpIDogYQoJICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7CgkgIH07Cgl9OwoKCS8qKiovIH0pLAoJLyogNjcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKCSAgLCBpbnZva2UgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg5KQoJICAsIGh0bWwgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDIpCgkgICwgY2VsICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykKCSAgLCBnbG9iYWwgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCgkgICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MKCSAgLCBzZXRUYXNrICAgICAgICAgICAgPSBnbG9iYWwuc2V0SW1tZWRpYXRlCgkgICwgY2xlYXJUYXNrICAgICAgICAgID0gZ2xvYmFsLmNsZWFySW1tZWRpYXRlCgkgICwgTWVzc2FnZUNoYW5uZWwgICAgID0gZ2xvYmFsLk1lc3NhZ2VDaGFubmVsCgkgICwgY291bnRlciAgICAgICAgICAgID0gMAoJICAsIHF1ZXVlICAgICAgICAgICAgICA9IHt9CgkgICwgT05SRUFEWVNUQVRFQ0hBTkdFID0gJ29ucmVhZHlzdGF0ZWNoYW5nZScKCSAgLCBkZWZlciwgY2hhbm5lbCwgcG9ydDsKCXZhciBydW4gPSBmdW5jdGlvbigpewoJICB2YXIgaWQgPSArdGhpczsKCSAgaWYocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKXsKCSAgICB2YXIgZm4gPSBxdWV1ZVtpZF07CgkgICAgZGVsZXRlIHF1ZXVlW2lkXTsKCSAgICBmbigpOwoJICB9Cgl9OwoJdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpewoJICBydW4uY2FsbChldmVudC5kYXRhKTsKCX07CgkvLyBOb2RlLmpzIDAuOSsgJiBJRTEwKyBoYXMgc2V0SW1tZWRpYXRlLCBvdGhlcndpc2U6CglpZighc2V0VGFzayB8fCAhY2xlYXJUYXNrKXsKCSAgc2V0VGFzayA9IGZ1bmN0aW9uIHNldEltbWVkaWF0ZShmbil7CgkgICAgdmFyIGFyZ3MgPSBbXSwgaSA9IDE7CgkgICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKCSAgICBxdWV1ZVsrK2NvdW50ZXJdID0gZnVuY3Rpb24oKXsKCSAgICAgIGludm9rZSh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pLCBhcmdzKTsKCSAgICB9OwoJICAgIGRlZmVyKGNvdW50ZXIpOwoJICAgIHJldHVybiBjb3VudGVyOwoJICB9OwoJICBjbGVhclRhc2sgPSBmdW5jdGlvbiBjbGVhckltbWVkaWF0ZShpZCl7CgkgICAgZGVsZXRlIHF1ZXVlW2lkXTsKCSAgfTsKCSAgLy8gTm9kZS5qcyAwLjgtCgkgIGlmKF9fd2VicGFja19yZXF1aXJlX18oMjApKHByb2Nlc3MpID09ICdwcm9jZXNzJyl7CgkgICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CgkgICAgICBwcm9jZXNzLm5leHRUaWNrKGN0eChydW4sIGlkLCAxKSk7CgkgICAgfTsKCSAgLy8gQnJvd3NlcnMgd2l0aCBNZXNzYWdlQ2hhbm5lbCwgaW5jbHVkZXMgV2ViV29ya2VycwoJICB9IGVsc2UgaWYoTWVzc2FnZUNoYW5uZWwpewoJICAgIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWw7CgkgICAgcG9ydCAgICA9IGNoYW5uZWwucG9ydDI7CgkgICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBsaXN0ZW5lcjsKCSAgICBkZWZlciA9IGN0eChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTsKCSAgLy8gQnJvd3NlcnMgd2l0aCBwb3N0TWVzc2FnZSwgc2tpcCBXZWJXb3JrZXJzCgkgIC8vIElFOCBoYXMgcG9zdE1lc3NhZ2UsIGJ1dCBpdCdzIHN5bmMgJiB0eXBlb2YgaXRzIHBvc3RNZXNzYWdlIGlzICdvYmplY3QnCgkgIH0gZWxzZSBpZihnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lciAmJiB0eXBlb2YgcG9zdE1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJyAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpewoJICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewoJICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKGlkICsgJycsICcqJyk7CgkgICAgfTsKCSAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGxpc3RlbmVyLCBmYWxzZSk7CgkgIC8vIElFOC0KCSAgfSBlbHNlIGlmKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKXsKCSAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKCSAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoY2VsKCdzY3JpcHQnKSlbT05SRUFEWVNUQVRFQ0hBTkdFXSA9IGZ1bmN0aW9uKCl7CgkgICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7CgkgICAgICAgIHJ1bi5jYWxsKGlkKTsKCSAgICAgIH07CgkgICAgfTsKCSAgLy8gUmVzdCBvbGQgYnJvd3NlcnMKCSAgfSBlbHNlIHsKCSAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKCSAgICAgIHNldFRpbWVvdXQoY3R4KHJ1biwgaWQsIDEpLCAwKTsKCSAgICB9OwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IHsKCSAgc2V0OiAgIHNldFRhc2ssCgkgIGNsZWFyOiBjbGVhclRhc2sKCX07CgoJLyoqKi8gfSksCgkvKiA2OCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KQoJICAsIG1heCAgICAgICA9IE1hdGgubWF4CgkgICwgbWluICAgICAgID0gTWF0aC5taW47Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGluZGV4LCBsZW5ndGgpewoJICBpbmRleCA9IHRvSW50ZWdlcihpbmRleCk7CgkgIHJldHVybiBpbmRleCA8IDAgPyBtYXgoaW5kZXggKyBsZW5ndGgsIDApIDogbWluKGluZGV4LCBsZW5ndGgpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDY5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCXZhciBhZGRUb1Vuc2NvcGFibGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MCkKCSAgLCBzdGVwICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MykKCSAgLCBJdGVyYXRvcnMgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKCSAgLCB0b0lPYmplY3QgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyk7CgoJLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKQoJLy8gMjIuMS4zLjEzIEFycmF5LnByb3RvdHlwZS5rZXlzKCkKCS8vIDIyLjEuMy4yOSBBcnJheS5wcm90b3R5cGUudmFsdWVzKCkKCS8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KShBcnJheSwgJ0FycmF5JywgZnVuY3Rpb24oaXRlcmF0ZWQsIGtpbmQpewoJICB0aGlzLl90ID0gdG9JT2JqZWN0KGl0ZXJhdGVkKTsgLy8gdGFyZ2V0CgkgIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4CgkgIHRoaXMuX2sgPSBraW5kOyAgICAgICAgICAgICAgICAvLyBraW5kCgkvLyAyMi4xLjUuMi4xICVBcnJheUl0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKCX0sIGZ1bmN0aW9uKCl7CgkgIHZhciBPICAgICA9IHRoaXMuX3QKCSAgICAsIGtpbmQgID0gdGhpcy5fawoJICAgICwgaW5kZXggPSB0aGlzLl9pKys7CgkgIGlmKCFPIHx8IGluZGV4ID49IE8ubGVuZ3RoKXsKCSAgICB0aGlzLl90ID0gdW5kZWZpbmVkOwoJICAgIHJldHVybiBzdGVwKDEpOwoJICB9CgkgIGlmKGtpbmQgPT0gJ2tleXMnICApcmV0dXJuIHN0ZXAoMCwgaW5kZXgpOwoJICBpZihraW5kID09ICd2YWx1ZXMnKXJldHVybiBzdGVwKDAsIE9baW5kZXhdKTsKCSAgcmV0dXJuIHN0ZXAoMCwgW2luZGV4LCBPW2luZGV4XV0pOwoJfSwgJ3ZhbHVlcycpOwoKCS8vIGFyZ3VtZW50c0xpc3RbQEBpdGVyYXRvcl0gaXMgJUFycmF5UHJvdG9fdmFsdWVzJSAoOS40LjQuNiwgOS40LjQuNykKCUl0ZXJhdG9ycy5Bcmd1bWVudHMgPSBJdGVyYXRvcnMuQXJyYXk7CgoJYWRkVG9VbnNjb3BhYmxlcygna2V5cycpOwoJYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7CglhZGRUb1Vuc2NvcGFibGVzKCdlbnRyaWVzJyk7CgoJLyoqKi8gfSksCgkvKiA3MCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODEpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiA3MSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCgl2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKCXZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKCXZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCglleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKCWV4cG9ydHMuZGl2aWRlRW1haWwgPSBkaXZpZGVFbWFpbDsKCWV4cG9ydHMuZW1wdHlPYmplY3QgPSBlbXB0eU9iamVjdDsKCWV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwoJZXhwb3J0cy5nZXRVc2VyVVJMRnJvbUVtYWlsID0gZ2V0VXNlclVSTEZyb21FbWFpbDsKCWV4cG9ydHMuZ2V0VXNlckVtYWlsRnJvbVVSTCA9IGdldFVzZXJFbWFpbEZyb21VUkw7CglleHBvcnRzLmNvbnZlcnRUb1VzZXJVUkwgPSBjb252ZXJ0VG9Vc2VyVVJMOwoJZXhwb3J0cy5jaGVja0F0dHJpYnV0ZSA9IGNoZWNrQXR0cmlidXRlOwoJZXhwb3J0cy5wYXJzZUF0dHJpYnV0ZXMgPSBwYXJzZUF0dHJpYnV0ZXM7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvKioKCSogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCgkqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoJKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKCSogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSoKCSogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkqCgkqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkqCgkqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkqKi8KCS8qKgoJICogU3VwcG9ydCBtb2R1bGUgd2l0aCBzb21lIGZ1bmN0aW9ucyB3aWxsIGJlIHVzZWZ1bAoJICogQG1vZHVsZSB1dGlscwoJICovCgoJLyoqCgkgKiBAdHlwZWRlZiBkaXZpZGVVUkwKCSAqIEB0eXBlIE9iamVjdAoJICogQHByb3BlcnR5IHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgVVJMCgkgKiBAcHJvcGVydHkge3N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gb2YgVVJMCgkgKiBAcHJvcGVydHkge3N0cmluZ30gaWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIFVSTAoJICovCgoJLyoqCgkgKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKCSAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCgkgKiBAcmV0dXJuIHtkaXZpZGVVUkx9IHRoZSByZXN1bHQgb2YgZGl2aWRlVVJMCgkgKi8KCWZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHsKCgkgIGlmICghdXJsKSB0aHJvdyBFcnJvcignVVJMIGlzIG5lZWRlZCB0byBzcGxpdCcpOwoKCSAgZnVuY3Rpb24gcmVjdXJzZSh2YWx1ZSkgewoJICAgIHZhciByZWdleCA9IC8oW2EtekEtWi1dKikoOlwvXC8oPzpcLik/fDopKFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTsKCSAgICB2YXIgc3Vic3QgPSAnJDEsJDMsJDQnOwoJICAgIHZhciBwYXJ0cyA9IHZhbHVlLnJlcGxhY2UocmVnZXgsIHN1YnN0KS5zcGxpdCgnLCcpOwoJICAgIHJldHVybiBwYXJ0czsKCSAgfQoKCSAgdmFyIHBhcnRzID0gcmVjdXJzZSh1cmwpOwoKCSAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lCgkgIGlmIChwYXJ0c1swXSA9PT0gdXJsICYmICFwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CgoJICAgIHZhciBfcmVzdWx0ID0gewoJICAgICAgdHlwZTogIiIsCgkgICAgICBkb21haW46IHVybCwKCSAgICAgIGlkZW50aXR5OiAiIgoJICAgIH07CgoJICAgIGNvbnNvbGUuZXJyb3IoJ1tEaXZpZGVVUkxdIERpdmlkZVVSTCBkb25cJ3Qgc3VwcG9ydCB1cmwgd2l0aG91dCBzY2hlbWUuIFBsZWFzZSByZXZpZXcgeW91ciB1cmwgYWRkcmVzcycsIHVybCk7CgoJICAgIHJldHVybiBfcmVzdWx0OwoJICB9CgoJICAvLyBjaGVjayBpZiB0aGUgdXJsIGhhcyB0aGUgc2NoZW1lIGFuZCBpbmNsdWRlcyBhbiBACgkgIGlmIChwYXJ0c1swXSA9PT0gdXJsICYmIHBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKCSAgICB2YXIgc2NoZW1lID0gcGFydHNbMF0gPT09IHVybCA/ICdzbXRwJyA6IHBhcnRzWzBdOwoJICAgIHBhcnRzID0gcmVjdXJzZShzY2hlbWUgKyAnOi8vJyArIHBhcnRzWzBdKTsKCSAgfQoKCSAgLy8gaWYgdGhlIGRvbWFpbiBpbmNsdWRlcyBhbiBALCBkaXZpZGUgaXQgdG8gZG9tYWluIGFuZCBpZGVudGl0eSByZXNwZWN0aXZlbHkKCSAgaWYgKHBhcnRzWzFdLmluY2x1ZGVzKCdAJykpIHsKCSAgICBwYXJ0c1syXSA9IHBhcnRzWzBdICsgJzovLycgKyBwYXJ0c1sxXTsKCSAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdLnN1YnN0cihwYXJ0c1sxXS5pbmRleE9mKCdAJykgKyAxKTsKCSAgfSAvKmVsc2UgaWYgKHBhcnRzWzJdLmluY2x1ZGVzKCcvJykpIHsKCSAgICBwYXJ0c1syXSA9IHBhcnRzWzJdLnN1YnN0cihwYXJ0c1syXS5sYXN0SW5kZXhPZignLycpKzEpOwoJICAgIH0qLwoKCSAgdmFyIHJlc3VsdCA9IHsKCSAgICB0eXBlOiBwYXJ0c1swXSwKCSAgICBkb21haW46IHBhcnRzWzFdLAoJICAgIGlkZW50aXR5OiBwYXJ0c1syXQoJICB9OwoKCSAgcmV0dXJuIHJlc3VsdDsKCX0KCglmdW5jdGlvbiBkaXZpZGVFbWFpbChlbWFpbCkgewoJICB2YXIgaW5kZXhPZkF0ID0gZW1haWwuaW5kZXhPZignQCcpOwoKCSAgdmFyIHJlc3VsdCA9IHsKCSAgICB1c2VybmFtZTogZW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCksCgkgICAgZG9tYWluOiBlbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgZW1haWwubGVuZ3RoKQoJICB9OwoKCSAgcmV0dXJuIHJlc3VsdDsKCX0KCgkvKioKCSAqIENoZWNrIGlmIGFuIE9iamVjdCBpcyBlbXB0eQoJICogQHBhcmFtICB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IHRvIGJlIGNoZWNrZWQKCSAqIEByZXR1cm4ge0Jvb2xlYW59ICAgICAgIHN0YXR1cyBvZiBPYmplY3QsIGVtcHR5IG9yIG5vdCAodHJ1ZXxmYWxzZSk7CgkgKi8KCWZ1bmN0aW9uIGVtcHR5T2JqZWN0KG9iamVjdCkgewoJICByZXR1cm4gKDAsIF9rZXlzMi5kZWZhdWx0KShvYmplY3QpLmxlbmd0aCA+IDAgPyBmYWxzZSA6IHRydWU7Cgl9CgoJLyoqCgkgKiBNYWtlIGEgQ09QWSBvZiB0aGUgb3JpZ2luYWwgZGF0YQoJICogQHBhcmFtICB7T2JqZWN0fSAgb2JqIC0gb2JqZWN0IHRvIGJlIGNsb25lZAoJICogQHJldHVybiB7T2JqZWN0fQoJICovCglmdW5jdGlvbiBkZWVwQ2xvbmUob2JqKSB7CgkgIC8vVE9ETzogc2ltcGxlIGJ1dCBpbmVmZmljaWVudCBKU09OIGRlZXAgY2xvbmUuLi4KCSAgaWYgKG9iaikgcmV0dXJuIEpTT04ucGFyc2UoKDAsIF9zdHJpbmdpZnkyLmRlZmF1bHQpKG9iaikpOwoJfQoKCS8qKgoJICogT2J0YWlucyB0aGUgdXNlciBVUkwgdGhhdCBjb3JyZXNwb25kcyB0byBhIGdpdmVuIGVtYWlsCgkgKiBAcGFyYW0gIHtzdHJpbmd9IHVzZXJFbWFpbCBUaGUgdXNlciBlbWFpbAoJICogQHJldHVybiB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKCSAqLwoJZnVuY3Rpb24gZ2V0VXNlclVSTEZyb21FbWFpbCh1c2VyRW1haWwpIHsKCSAgdmFyIGluZGV4T2ZBdCA9IHVzZXJFbWFpbC5pbmRleE9mKCdAJyk7CgkgIHJldHVybiAndXNlcjovLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKGluZGV4T2ZBdCArIDEsIHVzZXJFbWFpbC5sZW5ndGgpICsgJy8nICsgdXNlckVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpOwoJfQoKCS8qKgoJICogT2J0YWlucyB0aGUgdXNlciBlbWFpbCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gVVJMCgkgKiBAcGFyYW0gIHtVUkwuVVJMfSB1c2VyVVJMIFRoZSB1c2VyIFVSTAoJICogQHJldHVybiB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKCSAqLwoJZnVuY3Rpb24gZ2V0VXNlckVtYWlsRnJvbVVSTCh1c2VyVVJMKSB7CgkgIHZhciB1cmwgPSBkaXZpZGVVUkwodXNlclVSTCk7CgkgIHJldHVybiB1cmwuaWRlbnRpdHkucmVwbGFjZSgnLycsICcnKSArICdAJyArIHVybC5kb21haW47IC8vIGlkZW50aXR5IGZpZWxkIGhhcyAnL2V4YW1wbGVJRCcgaW5zdGVhZCBvZiAnZXhhbXBsZUlEJwoJfQoKCS8qKgoJICogQ2hlY2sgaWYgdGhlIHVzZXIgaWRlbnRpZmllciBpcyBhbHJlYWR5IGluIHRoZSBVUkwgZm9ybWF0LCBpZiBub3QsIGNvbnZlcnQgdG8gVVJMIGZvcm1hdAoJICogQHBhcmFtICB7c3RyaW5nfSAgIGlkZW50aWZpZXIgIHVzZXIgaWRlbnRpZmllcgoJICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMCgkgKi8KCWZ1bmN0aW9uIGNvbnZlcnRUb1VzZXJVUkwoaWRlbnRpZmllcikgewoKCSAgLy8gY2hlY2sgaWYgdGhlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgdXJsIGZvcm1hdAoJICBpZiAoaWRlbnRpZmllci5zdWJzdHJpbmcoMCwgNykgPT09ICd1c2VyOi8vJykgewoJICAgIHZhciBkaXZpZGVkVVJMID0gZGl2aWRlVVJMKGlkZW50aWZpZXIpOwoKCSAgICAvL2NoZWNrIGlmIHRoZSB1cmwgaXMgd2VsbCBmb3JtYXRlZAoJICAgIGlmIChkaXZpZGVkVVJMLmRvbWFpbiAmJiBkaXZpZGVkVVJMLmlkZW50aXR5KSB7CgkgICAgICByZXR1cm4gaWRlbnRpZmllcjsKCSAgICB9IGVsc2UgewoJICAgICAgdGhyb3cgJ3VzZXJVUkwgd2l0aCB3cm9uZyBmb3JtYXQnOwoJICAgIH0KCgkgICAgLy9pZiBub3QsIGNvbnZlcnQgdGhlIHVzZXIgZW1haWwgdG8gVVJMIGZvcm1hdAoJICB9IGVsc2UgewoJICAgIHJldHVybiBnZXRVc2VyVVJMRnJvbUVtYWlsKGlkZW50aWZpZXIpOwoJICB9Cgl9CgoJZnVuY3Rpb24gY2hlY2tBdHRyaWJ1dGUocGF0aCkgewoKCSAgdmFyIHJlZ2V4ID0gLygoKFthLXpBLVpdKyk6XC9cLyhbMC05YS16QS1aXVstXHddKlswLTlhLXpBLVpdXC4pK1thLXpBLVpdezIsOX0pXC9bYS16QS1aMC05XC5dK0BbYS16QS1aMC05XSsoXC0pP1thLXpBLVowLTldKyhcLik/W2EtekEtWjAtOV17MiwxMH0/XC5bYS16QS1aXXsyLDEwfSkoLisoPz0uaWRlbnRpdHkpKT8vZ207CgoJICB2YXIgbGlzdCA9IFtdOwoJICB2YXIgZmluYWwgPSBbXTsKCSAgdmFyIHRlc3QgPSBwYXRoLm1hdGNoKHJlZ2V4KTsKCgkgIGlmICh0ZXN0ID09IG51bGwpIHsKCSAgICBmaW5hbCA9IHBhdGguc3BsaXQoJy4nKTsKCSAgfSBlbHNlIHsKCSAgICB2YXIgbSA9IHZvaWQgMDsKCSAgICB3aGlsZSAoKG0gPSByZWdleC5leGVjKHBhdGgpKSAhPT0gbnVsbCkgewoJICAgICAgLy8gVGhpcyBpcyBuZWNlc3NhcnkgdG8gYXZvaWQgaW5maW5pdGUgbG9vcHMgd2l0aCB6ZXJvLXdpZHRoIG1hdGNoZXMKCSAgICAgIGlmIChtLmluZGV4ID09PSByZWdleC5sYXN0SW5kZXgpIHsKCSAgICAgICAgcmVnZXgubGFzdEluZGV4Kys7CgkgICAgICB9CgoJICAgICAgLy8gVGhlIHJlc3VsdCBjYW4gYmUgYWNjZXNzZWQgdGhyb3VnaCB0aGUgYG1gLXZhcmlhYmxlLgoJICAgICAgbS5mb3JFYWNoKGZ1bmN0aW9uIChtYXRjaCwgZ3JvdXBJbmRleCkgewoJICAgICAgICBpZiAoZ3JvdXBJbmRleCA9PT0gMCkgewoJICAgICAgICAgIGxpc3QucHVzaChtYXRjaCk7CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCSAgICB2YXIgcmVzdWx0ID0gdm9pZCAwOwoJICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAodXJsKSB7CgkgICAgICByZXN1bHQgPSBwYXRoLnJlcGxhY2UodXJsLCAnKisqJyk7CgoJICAgICAgZmluYWwgPSByZXN1bHQuc3BsaXQoJy4nKS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKCSAgICAgICAgaWYgKGl0ZW0gPT09ICcqKyonKSB7CgkgICAgICAgICAgcmV0dXJuIHVybDsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gaXRlbTsKCSAgICAgIH0pOwoJICAgIH0pOwoJICB9CgoJICBjb25zb2xlLmxvZygnW1NlcnZpY2VGcmFtZXdvcmsuVXRpbHMuY2hlY2tBdHRyaWJ1dGVdJywgZmluYWwpOwoJICByZXR1cm4gZmluYWw7Cgl9CgoJZnVuY3Rpb24gcGFyc2VBdHRyaWJ1dGVzKHBhdGgpIHsKCSAgdmFyIHJlZ2V4ID0gLyhbMC05YS16QS1aXVstXHddKik6XC9cLy9nOwoKCSAgdmFyIHN0cmluZzMgPSAnaWRlbnRpdHknOwoKCSAgaWYgKCFwYXRoLmluY2x1ZGVzKCc6Ly8nKSkgewoJICAgIHJldHVybiBwYXRoLnNwbGl0KCcuJyk7CgkgIH0gZWxzZSB7CgkgICAgdmFyIHN0cmluZzEgPSBwYXRoLnNwbGl0KHJlZ2V4KVswXTsKCgkgICAgdmFyIGFycmF5MSA9IHN0cmluZzEuc3BsaXQoJy4nKTsKCgkgICAgdmFyIHN0cmluZzIgPSBwYXRoLnJlcGxhY2Uoc3RyaW5nMSwgJycpOwoKCSAgICBpZiAocGF0aC5pbmNsdWRlcyhzdHJpbmczKSkgewoKCSAgICAgIHZhciBhcnJheTIgPSBzdHJpbmcyLnNwbGl0KHN0cmluZzMgKyAnLicpOwoKCSAgICAgIGNvbnNvbGUubG9nKCdhcnJheTIgJyArIGFycmF5Mik7CgoJICAgICAgc3RyaW5nMiA9IGFycmF5MlswXS5zbGljZSgnLicsIC0xKTsKCgkgICAgICBhcnJheTIgPSBhcnJheTJbMV0uc3BsaXQoJy4nKTsKCgkgICAgICBhcnJheTEucHVzaChzdHJpbmcyLCBzdHJpbmczKTsKCgkgICAgICBhcnJheTEgPSBhcnJheTEuY29uY2F0KGFycmF5Mik7CgkgICAgfSBlbHNlIHsKCSAgICAgIGFycmF5MS5wdXNoKHN0cmluZzIpOwoJICAgIH0KCgkgICAgcmV0dXJuIGFycmF5MS5maWx0ZXIoQm9vbGVhbik7CgkgIH0KCX0KCgkvKioqLyB9KSwKCS8qIDcyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCgkvKioqLyB9KSwKCS8qIDczICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIE1FVEEgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykoJ21ldGEnKQoJICAsIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQoJICAsIGhhcyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKCSAgLCBzZXREZXNjICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgoJICAsIGlkICAgICAgID0gMDsKCXZhciBpc0V4dGVuc2libGUgPSBPYmplY3QuaXNFeHRlbnNpYmxlIHx8IGZ1bmN0aW9uKCl7CgkgIHJldHVybiB0cnVlOwoJfTsKCXZhciBGUkVFWkUgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKCSAgcmV0dXJuIGlzRXh0ZW5zaWJsZShPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe30pKTsKCX0pOwoJdmFyIHNldE1ldGEgPSBmdW5jdGlvbihpdCl7CgkgIHNldERlc2MoaXQsIE1FVEEsIHt2YWx1ZTogewoJICAgIGk6ICdPJyArICsraWQsIC8vIG9iamVjdCBJRAoJICAgIHc6IHt9ICAgICAgICAgIC8vIHdlYWsgY29sbGVjdGlvbnMgSURzCgkgIH19KTsKCX07Cgl2YXIgZmFzdEtleSA9IGZ1bmN0aW9uKGl0LCBjcmVhdGUpewoJICAvLyByZXR1cm4gcHJpbWl0aXZlIHdpdGggcHJlZml4CgkgIGlmKCFpc09iamVjdChpdCkpcmV0dXJuIHR5cGVvZiBpdCA9PSAnc3ltYm9sJyA/IGl0IDogKHR5cGVvZiBpdCA9PSAnc3RyaW5nJyA/ICdTJyA6ICdQJykgKyBpdDsKCSAgaWYoIWhhcyhpdCwgTUVUQSkpewoJICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0CgkgICAgaWYoIWlzRXh0ZW5zaWJsZShpdCkpcmV0dXJuICdGJzsKCSAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YQoJICAgIGlmKCFjcmVhdGUpcmV0dXJuICdFJzsKCSAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YQoJICAgIHNldE1ldGEoaXQpOwoJICAvLyByZXR1cm4gb2JqZWN0IElECgkgIH0gcmV0dXJuIGl0W01FVEFdLmk7Cgl9OwoJdmFyIGdldFdlYWsgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKCSAgaWYoIWhhcyhpdCwgTUVUQSkpewoJICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0CgkgICAgaWYoIWlzRXh0ZW5zaWJsZShpdCkpcmV0dXJuIHRydWU7CgkgICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGEKCSAgICBpZighY3JlYXRlKXJldHVybiBmYWxzZTsKCSAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YQoJICAgIHNldE1ldGEoaXQpOwoJICAvLyByZXR1cm4gaGFzaCB3ZWFrIGNvbGxlY3Rpb25zIElEcwoJICB9IHJldHVybiBpdFtNRVRBXS53OwoJfTsKCS8vIGFkZCBtZXRhZGF0YSBvbiBmcmVlemUtZmFtaWx5IG1ldGhvZHMgY2FsbGluZwoJdmFyIG9uRnJlZXplID0gZnVuY3Rpb24oaXQpewoJICBpZihGUkVFWkUgJiYgbWV0YS5ORUVEICYmIGlzRXh0ZW5zaWJsZShpdCkgJiYgIWhhcyhpdCwgTUVUQSkpc2V0TWV0YShpdCk7CgkgIHJldHVybiBpdDsKCX07Cgl2YXIgbWV0YSA9IG1vZHVsZS5leHBvcnRzID0gewoJICBLRVk6ICAgICAgTUVUQSwKCSAgTkVFRDogICAgIGZhbHNlLAoJICBmYXN0S2V5OiAgZmFzdEtleSwKCSAgZ2V0V2VhazogIGdldFdlYWssCgkgIG9uRnJlZXplOiBvbkZyZWV6ZQoJfTsKCgkvKioqLyB9KSwKCS8qIDc0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGNsYXNzb2YgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTUpCgkgICwgSVRFUkFUT1IgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnaXRlcmF0b3InKQoJICAsIEl0ZXJhdG9ycyA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpOwoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLmdldEl0ZXJhdG9yTWV0aG9kID0gZnVuY3Rpb24oaXQpewoJICBpZihpdCAhPSB1bmRlZmluZWQpcmV0dXJuIGl0W0lURVJBVE9SXQoJICAgIHx8IGl0WydAQGl0ZXJhdG9yJ10KCSAgICB8fCBJdGVyYXRvcnNbY2xhc3NvZihpdCldOwoJfTsKCgkvKioqLyB9KSwKCS8qIDc1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg3OSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCgkvKioqLyB9KSwKCS8qIDc2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MiksIF9fZXNNb2R1bGU6IHRydWUgfTsKCgkvKioqLyB9KSwKCS8qIDc3ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4NCksIF9fZXNNb2R1bGU6IHRydWUgfTsKCgkvKioqLyB9KSwKCS8qIDc4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4NSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCgkvKioqLyB9KSwKCS8qIDc5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygxMDEpOwoJdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY3JlYXRlKFAsIEQpewoJICByZXR1cm4gJE9iamVjdC5jcmVhdGUoUCwgRCk7Cgl9OwoKCS8qKiovIH0pLAoJLyogODAgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMik7Cgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0LmdldFByb3RvdHlwZU9mOwoKCS8qKiovIH0pLAoJLyogODEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMyk7Cgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0LmtleXM7CgoJLyoqKi8gfSksCgkvKiA4MiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oMTA0KTsKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Quc2V0UHJvdG90eXBlT2Y7CgoJLyoqKi8gfSksCgkvKiA4MyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oNTQpOwoJX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CglfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKCV9fd2VicGFja19yZXF1aXJlX18oMTA1KTsKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5Qcm9taXNlOwoKCS8qKiovIH0pLAoJLyogODQgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNik7CglfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KTsKCV9fd2VicGFja19yZXF1aXJlX18oMTA3KTsKCV9fd2VicGFja19yZXF1aXJlX18oMTA4KTsKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5TeW1ib2w7CgoJLyoqKi8gfSksCgkvKiA4NSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oNTApOwoJX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7Cgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpLmYoJ2l0ZXJhdG9yJyk7CgoJLyoqKi8gfSksCgkvKiA4NiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIENvbnN0cnVjdG9yLCBuYW1lLCBmb3JiaWRkZW5GaWVsZCl7CgkgIGlmKCEoaXQgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikgfHwgKGZvcmJpZGRlbkZpZWxkICE9PSB1bmRlZmluZWQgJiYgZm9yYmlkZGVuRmllbGQgaW4gaXQpKXsKCSAgICB0aHJvdyBUeXBlRXJyb3IobmFtZSArICc6IGluY29ycmVjdCBpbnZvY2F0aW9uIScpOwoJICB9IHJldHVybiBpdDsKCX07CgoJLyoqKi8gfSksCgkvKiA4NyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGFsbCBlbnVtZXJhYmxlIG9iamVjdCBrZXlzLCBpbmNsdWRlcyBzeW1ib2xzCgl2YXIgZ2V0S2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpCgkgICwgZ09QUyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCgkgICwgcElFICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHZhciByZXN1bHQgICAgID0gZ2V0S2V5cyhpdCkKCSAgICAsIGdldFN5bWJvbHMgPSBnT1BTLmY7CgkgIGlmKGdldFN5bWJvbHMpewoJICAgIHZhciBzeW1ib2xzID0gZ2V0U3ltYm9scyhpdCkKCSAgICAgICwgaXNFbnVtICA9IHBJRS5mCgkgICAgICAsIGkgICAgICAgPSAwCgkgICAgICAsIGtleTsKCSAgICB3aGlsZShzeW1ib2xzLmxlbmd0aCA+IGkpaWYoaXNFbnVtLmNhbGwoaXQsIGtleSA9IHN5bWJvbHNbaSsrXSkpcmVzdWx0LnB1c2goa2V5KTsKCSAgfSByZXR1cm4gcmVzdWx0OwoJfTsKCgkvKioqLyB9KSwKCS8qIDg4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGN0eCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKCSAgLCBjYWxsICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTIpCgkgICwgaXNBcnJheUl0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkwKQoJICAsIGFuT2JqZWN0ICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQoJICAsIHRvTGVuZ3RoICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NykKCSAgLCBnZXRJdGVyRm4gICA9IF9fd2VicGFja19yZXF1aXJlX18oNzQpCgkgICwgQlJFQUsgICAgICAgPSB7fQoJICAsIFJFVFVSTiAgICAgID0ge307Cgl2YXIgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXRlcmFibGUsIGVudHJpZXMsIGZuLCB0aGF0LCBJVEVSQVRPUil7CgkgIHZhciBpdGVyRm4gPSBJVEVSQVRPUiA/IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyYWJsZTsgfSA6IGdldEl0ZXJGbihpdGVyYWJsZSkKCSAgICAsIGYgICAgICA9IGN0eChmbiwgdGhhdCwgZW50cmllcyA/IDIgOiAxKQoJICAgICwgaW5kZXggID0gMAoJICAgICwgbGVuZ3RoLCBzdGVwLCBpdGVyYXRvciwgcmVzdWx0OwoJICBpZih0eXBlb2YgaXRlckZuICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ZXJhYmxlICsgJyBpcyBub3QgaXRlcmFibGUhJyk7CgkgIC8vIGZhc3QgY2FzZSBmb3IgYXJyYXlzIHdpdGggZGVmYXVsdCBpdGVyYXRvcgoJICBpZihpc0FycmF5SXRlcihpdGVyRm4pKWZvcihsZW5ndGggPSB0b0xlbmd0aChpdGVyYWJsZS5sZW5ndGgpOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKyl7CgkgICAgcmVzdWx0ID0gZW50cmllcyA/IGYoYW5PYmplY3Qoc3RlcCA9IGl0ZXJhYmxlW2luZGV4XSlbMF0sIHN0ZXBbMV0pIDogZihpdGVyYWJsZVtpbmRleF0pOwoJICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKCSAgfSBlbHNlIGZvcihpdGVyYXRvciA9IGl0ZXJGbi5jYWxsKGl0ZXJhYmxlKTsgIShzdGVwID0gaXRlcmF0b3IubmV4dCgpKS5kb25lOyApewoJICAgIHJlc3VsdCA9IGNhbGwoaXRlcmF0b3IsIGYsIHN0ZXAudmFsdWUsIGVudHJpZXMpOwoJICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKCSAgfQoJfTsKCWV4cG9ydHMuQlJFQUsgID0gQlJFQUs7CglleHBvcnRzLlJFVFVSTiA9IFJFVFVSTjsKCgkvKioqLyB9KSwKCS8qIDg5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gZmFzdCBhcHBseSwgaHR0cDovL2pzcGVyZi5sbmtpdC5jb20vZmFzdC1hcHBseS81Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCBhcmdzLCB0aGF0KXsKCSAgdmFyIHVuID0gdGhhdCA9PT0gdW5kZWZpbmVkOwoJICBzd2l0Y2goYXJncy5sZW5ndGgpewoJICAgIGNhc2UgMDogcmV0dXJuIHVuID8gZm4oKQoJICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0KTsKCSAgICBjYXNlIDE6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0pCgkgICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0pOwoJICAgIGNhc2UgMjogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSkKCSAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSwgYXJnc1sxXSk7CgkgICAgY2FzZSAzOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKQoJICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTsKCSAgICBjYXNlIDQ6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pCgkgICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pOwoJICB9IHJldHVybiAgICAgICAgICAgICAgZm4uYXBwbHkodGhhdCwgYXJncyk7Cgl9OwoKCS8qKiovIH0pLAoJLyogOTAgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBjaGVjayBvbiBkZWZhdWx0IEFycmF5IGl0ZXJhdG9yCgl2YXIgSXRlcmF0b3JzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCgkgICwgSVRFUkFUT1IgICA9IF9fd2VicGFja19yZXF1aXJlX18oMykoJ2l0ZXJhdG9yJykKCSAgLCBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlOwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewoJICByZXR1cm4gaXQgIT09IHVuZGVmaW5lZCAmJiAoSXRlcmF0b3JzLkFycmF5ID09PSBpdCB8fCBBcnJheVByb3RvW0lURVJBVE9SXSA9PT0gaXQpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDkxICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gNy4yLjIgSXNBcnJheShhcmd1bWVudCkKCXZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKTsKCW1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5KGFyZyl7CgkgIHJldHVybiBjb2YoYXJnKSA9PSAnQXJyYXknOwoJfTsKCgkvKioqLyB9KSwKCS8qIDkyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gY2FsbCBzb21ldGhpbmcgb24gaXRlcmF0b3Igc3RlcCB3aXRoIHNhZmUgY2xvc2luZyBvbiBlcnJvcgoJdmFyIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXRlcmF0b3IsIGZuLCB2YWx1ZSwgZW50cmllcyl7CgkgIHRyeSB7CgkgICAgcmV0dXJuIGVudHJpZXMgPyBmbihhbk9iamVjdCh2YWx1ZSlbMF0sIHZhbHVlWzFdKSA6IGZuKHZhbHVlKTsKCSAgLy8gNy40LjYgSXRlcmF0b3JDbG9zZShpdGVyYXRvciwgY29tcGxldGlvbikKCSAgfSBjYXRjaChlKXsKCSAgICB2YXIgcmV0ID0gaXRlcmF0b3JbJ3JldHVybiddOwoJICAgIGlmKHJldCAhPT0gdW5kZWZpbmVkKWFuT2JqZWN0KHJldC5jYWxsKGl0ZXJhdG9yKSk7CgkgICAgdGhyb3cgZTsKCSAgfQoJfTsKCgkvKioqLyB9KSwKCS8qIDkzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIElURVJBVE9SICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMykoJ2l0ZXJhdG9yJykKCSAgLCBTQUZFX0NMT1NJTkcgPSBmYWxzZTsKCgl0cnkgewoJICB2YXIgcml0ZXIgPSBbN11bSVRFUkFUT1JdKCk7CgkgIHJpdGVyWydyZXR1cm4nXSA9IGZ1bmN0aW9uKCl7IFNBRkVfQ0xPU0lORyA9IHRydWU7IH07CgkgIEFycmF5LmZyb20ocml0ZXIsIGZ1bmN0aW9uKCl7IHRocm93IDI7IH0pOwoJfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYywgc2tpcENsb3NpbmcpewoJICBpZighc2tpcENsb3NpbmcgJiYgIVNBRkVfQ0xPU0lORylyZXR1cm4gZmFsc2U7CgkgIHZhciBzYWZlID0gZmFsc2U7CgkgIHRyeSB7CgkgICAgdmFyIGFyciAgPSBbN10KCSAgICAgICwgaXRlciA9IGFycltJVEVSQVRPUl0oKTsKCSAgICBpdGVyLm5leHQgPSBmdW5jdGlvbigpeyByZXR1cm4ge2RvbmU6IHNhZmUgPSB0cnVlfTsgfTsKCSAgICBhcnJbSVRFUkFUT1JdID0gZnVuY3Rpb24oKXsgcmV0dXJuIGl0ZXI7IH07CgkgICAgZXhlYyhhcnIpOwoJICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CgkgIHJldHVybiBzYWZlOwoJfTsKCgkvKioqLyB9KSwKCS8qIDk0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGdldEtleXMgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpCgkgICwgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgZWwpewoJICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKCSAgICAsIGtleXMgICA9IGdldEtleXMoTykKCSAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCgkgICAgLCBpbmRleCAgPSAwCgkgICAgLCBrZXk7CgkgIHdoaWxlKGxlbmd0aCA+IGluZGV4KWlmKE9ba2V5ID0ga2V5c1tpbmRleCsrXV0gPT09IGVsKXJldHVybiBrZXk7Cgl9OwoKCS8qKiovIH0pLAoJLyogOTUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgZ2xvYmFsICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQoJICAsIG1hY3JvdGFzayA9IF9fd2VicGFja19yZXF1aXJlX18oNjcpLnNldAoJICAsIE9ic2VydmVyICA9IGdsb2JhbC5NdXRhdGlvbk9ic2VydmVyIHx8IGdsb2JhbC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyCgkgICwgcHJvY2VzcyAgID0gZ2xvYmFsLnByb2Nlc3MKCSAgLCBQcm9taXNlICAgPSBnbG9iYWwuUHJvbWlzZQoJICAsIGlzTm9kZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjApKHByb2Nlc3MpID09ICdwcm9jZXNzJzsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCl7CgkgIHZhciBoZWFkLCBsYXN0LCBub3RpZnk7CgoJICB2YXIgZmx1c2ggPSBmdW5jdGlvbigpewoJICAgIHZhciBwYXJlbnQsIGZuOwoJICAgIGlmKGlzTm9kZSAmJiAocGFyZW50ID0gcHJvY2Vzcy5kb21haW4pKXBhcmVudC5leGl0KCk7CgkgICAgd2hpbGUoaGVhZCl7CgkgICAgICBmbiAgID0gaGVhZC5mbjsKCSAgICAgIGhlYWQgPSBoZWFkLm5leHQ7CgkgICAgICB0cnkgewoJICAgICAgICBmbigpOwoJICAgICAgfSBjYXRjaChlKXsKCSAgICAgICAgaWYoaGVhZClub3RpZnkoKTsKCSAgICAgICAgZWxzZSBsYXN0ID0gdW5kZWZpbmVkOwoJICAgICAgICB0aHJvdyBlOwoJICAgICAgfQoJICAgIH0gbGFzdCA9IHVuZGVmaW5lZDsKCSAgICBpZihwYXJlbnQpcGFyZW50LmVudGVyKCk7CgkgIH07CgoJICAvLyBOb2RlLmpzCgkgIGlmKGlzTm9kZSl7CgkgICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKCSAgICAgIHByb2Nlc3MubmV4dFRpY2soZmx1c2gpOwoJICAgIH07CgkgIC8vIGJyb3dzZXJzIHdpdGggTXV0YXRpb25PYnNlcnZlcgoJICB9IGVsc2UgaWYoT2JzZXJ2ZXIpewoJICAgIHZhciB0b2dnbGUgPSB0cnVlCgkgICAgICAsIG5vZGUgICA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTsKCSAgICBuZXcgT2JzZXJ2ZXIoZmx1c2gpLm9ic2VydmUobm9kZSwge2NoYXJhY3RlckRhdGE6IHRydWV9KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXcKCSAgICBub3RpZnkgPSBmdW5jdGlvbigpewoJICAgICAgbm9kZS5kYXRhID0gdG9nZ2xlID0gIXRvZ2dsZTsKCSAgICB9OwoJICAvLyBlbnZpcm9ubWVudHMgd2l0aCBtYXliZSBub24tY29tcGxldGVseSBjb3JyZWN0LCBidXQgZXhpc3RlbnQgUHJvbWlzZQoJICB9IGVsc2UgaWYoUHJvbWlzZSAmJiBQcm9taXNlLnJlc29sdmUpewoJICAgIHZhciBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7CgkgICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKCSAgICAgIHByb21pc2UudGhlbihmbHVzaCk7CgkgICAgfTsKCSAgLy8gZm9yIG90aGVyIGVudmlyb25tZW50cyAtIG1hY3JvdGFzayBiYXNlZCBvbjoKCSAgLy8gLSBzZXRJbW1lZGlhdGUKCSAgLy8gLSBNZXNzYWdlQ2hhbm5lbAoJICAvLyAtIHdpbmRvdy5wb3N0TWVzc2FnCgkgIC8vIC0gb25yZWFkeXN0YXRlY2hhbmdlCgkgIC8vIC0gc2V0VGltZW91dAoJICB9IGVsc2UgewoJICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CgkgICAgICAvLyBzdHJhbmdlIElFICsgd2VicGFjayBkZXYgc2VydmVyIGJ1ZyAtIHVzZSAuY2FsbChnbG9iYWwpCgkgICAgICBtYWNyb3Rhc2suY2FsbChnbG9iYWwsIGZsdXNoKTsKCSAgICB9OwoJICB9CgoJICByZXR1cm4gZnVuY3Rpb24oZm4pewoJICAgIHZhciB0YXNrID0ge2ZuOiBmbiwgbmV4dDogdW5kZWZpbmVkfTsKCSAgICBpZihsYXN0KWxhc3QubmV4dCA9IHRhc2s7CgkgICAgaWYoIWhlYWQpewoJICAgICAgaGVhZCA9IHRhc2s7CgkgICAgICBub3RpZnkoKTsKCSAgICB9IGxhc3QgPSB0YXNrOwoJICB9OwoJfTsKCgkvKioqLyB9KSwKCS8qIDk2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gZmFsbGJhY2sgZm9yIElFMTEgYnVnZ3kgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgd2l0aCBpZnJhbWUgYW5kIHdpbmRvdwoJdmFyIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCgkgICwgZ09QTiAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2NSkuZgoJICAsIHRvU3RyaW5nICA9IHt9LnRvU3RyaW5nOwoKCXZhciB3aW5kb3dOYW1lcyA9IHR5cGVvZiB3aW5kb3cgPT0gJ29iamVjdCcgJiYgd2luZG93ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzCgkgID8gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMod2luZG93KSA6IFtdOwoKCXZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uKGl0KXsKCSAgdHJ5IHsKCSAgICByZXR1cm4gZ09QTihpdCk7CgkgIH0gY2F0Y2goZSl7CgkgICAgcmV0dXJuIHdpbmRvd05hbWVzLnNsaWNlKCk7CgkgIH0KCX07CgoJbW9kdWxlLmV4cG9ydHMuZiA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpewoJICByZXR1cm4gd2luZG93TmFtZXMgJiYgdG9TdHJpbmcuY2FsbChpdCkgPT0gJ1tvYmplY3QgV2luZG93XScgPyBnZXRXaW5kb3dOYW1lcyhpdCkgOiBnT1BOKHRvSU9iamVjdChpdCkpOwoJfTsKCgoJLyoqKi8gfSksCgkvKiA5NyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBoaWRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odGFyZ2V0LCBzcmMsIHNhZmUpewoJICBmb3IodmFyIGtleSBpbiBzcmMpewoJICAgIGlmKHNhZmUgJiYgdGFyZ2V0W2tleV0pdGFyZ2V0W2tleV0gPSBzcmNba2V5XTsKCSAgICBlbHNlIGhpZGUodGFyZ2V0LCBrZXksIHNyY1trZXldKTsKCSAgfSByZXR1cm4gdGFyZ2V0OwoJfTsKCgkvKioqLyB9KSwKCS8qIDk4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gV29ya3Mgd2l0aCBfX3Byb3RvX18gb25seS4gT2xkIHY4IGNhbid0IHdvcmsgd2l0aCBudWxsIHByb3RvIG9iamVjdHMuCgkvKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqLwoJdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQoJICAsIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKCXZhciBjaGVjayA9IGZ1bmN0aW9uKE8sIHByb3RvKXsKCSAgYW5PYmplY3QoTyk7CgkgIGlmKCFpc09iamVjdChwcm90bykgJiYgcHJvdG8gIT09IG51bGwpdGhyb3cgVHlwZUVycm9yKHByb3RvICsgIjogY2FuJ3Qgc2V0IGFzIHByb3RvdHlwZSEiKTsKCX07Cgltb2R1bGUuZXhwb3J0cyA9IHsKCSAgc2V0OiBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgKCdfX3Byb3RvX18nIGluIHt9ID8gLy8gZXNsaW50LWRpc2FibGUtbGluZQoJICAgIGZ1bmN0aW9uKHRlc3QsIGJ1Z2d5LCBzZXQpewoJICAgICAgdHJ5IHsKCSAgICAgICAgc2V0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkoRnVuY3Rpb24uY2FsbCwgX193ZWJwYWNrX3JlcXVpcmVfXyg1NykuZihPYmplY3QucHJvdG90eXBlLCAnX19wcm90b19fJykuc2V0LCAyKTsKCSAgICAgICAgc2V0KHRlc3QsIFtdKTsKCSAgICAgICAgYnVnZ3kgPSAhKHRlc3QgaW5zdGFuY2VvZiBBcnJheSk7CgkgICAgICB9IGNhdGNoKGUpeyBidWdneSA9IHRydWU7IH0KCSAgICAgIHJldHVybiBmdW5jdGlvbiBzZXRQcm90b3R5cGVPZihPLCBwcm90byl7CgkgICAgICAgIGNoZWNrKE8sIHByb3RvKTsKCSAgICAgICAgaWYoYnVnZ3kpTy5fX3Byb3RvX18gPSBwcm90bzsKCSAgICAgICAgZWxzZSBzZXQoTywgcHJvdG8pOwoJICAgICAgICByZXR1cm4gTzsKCSAgICAgIH07CgkgICAgfSh7fSwgZmFsc2UpIDogdW5kZWZpbmVkKSwKCSAgY2hlY2s6IGNoZWNrCgl9OwoKCS8qKiovIH0pLAoJLyogOTkgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoJdmFyIGdsb2JhbCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQoJICAsIGNvcmUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQoJICAsIGRQICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQoJICAsIERFU0NSSVBUT1JTID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKQoJICAsIFNQRUNJRVMgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnc3BlY2llcycpOwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZKXsKCSAgdmFyIEMgPSB0eXBlb2YgY29yZVtLRVldID09ICdmdW5jdGlvbicgPyBjb3JlW0tFWV0gOiBnbG9iYWxbS0VZXTsKCSAgaWYoREVTQ1JJUFRPUlMgJiYgQyAmJiAhQ1tTUEVDSUVTXSlkUC5mKEMsIFNQRUNJRVMsIHsKCSAgICBjb25maWd1cmFibGU6IHRydWUsCgkgICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfQoJICB9KTsKCX07CgoJLyoqKi8gfSksCgkvKiAxMDAgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyA3LjMuMjAgU3BlY2llc0NvbnN0cnVjdG9yKE8sIGRlZmF1bHRDb25zdHJ1Y3RvcikKCXZhciBhbk9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCgkgICwgYUZ1bmN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSkKCSAgLCBTUEVDSUVTICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdzcGVjaWVzJyk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE8sIEQpewoJICB2YXIgQyA9IGFuT2JqZWN0KE8pLmNvbnN0cnVjdG9yLCBTOwoJICByZXR1cm4gQyA9PT0gdW5kZWZpbmVkIHx8IChTID0gYW5PYmplY3QoQylbU1BFQ0lFU10pID09IHVuZGVmaW5lZCA/IEQgOiBhRnVuY3Rpb24oUyk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMTAxICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpCgkvLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKCSRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0Jywge2NyZWF0ZTogX193ZWJwYWNrX3JlcXVpcmVfXygzNyl9KTsKCgkvKioqLyB9KSwKCS8qIDEwMiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIDE5LjEuMi45IE9iamVjdC5nZXRQcm90b3R5cGVPZihPKQoJdmFyIHRvT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCgkgICwgJGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Myk7CgoJX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2dldFByb3RvdHlwZU9mJywgZnVuY3Rpb24oKXsKCSAgcmV0dXJuIGZ1bmN0aW9uIGdldFByb3RvdHlwZU9mKGl0KXsKCSAgICByZXR1cm4gJGdldFByb3RvdHlwZU9mKHRvT2JqZWN0KGl0KSk7CgkgIH07Cgl9KTsKCgkvKioqLyB9KSwKCS8qIDEwMyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIDE5LjEuMi4xNCBPYmplY3Qua2V5cyhPKQoJdmFyIHRvT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMikKCSAgLCAka2V5cyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpOwoKCV9fd2VicGFja19yZXF1aXJlX18oNDUpKCdrZXlzJywgZnVuY3Rpb24oKXsKCSAgcmV0dXJuIGZ1bmN0aW9uIGtleXMoaXQpewoJICAgIHJldHVybiAka2V5cyh0b09iamVjdChpdCkpOwoJICB9OwoJfSk7CgoJLyoqKi8gfSksCgkvKiAxMDQgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjMuMTkgT2JqZWN0LnNldFByb3RvdHlwZU9mKE8sIHByb3RvKQoJdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoJJGV4cG9ydCgkZXhwb3J0LlMsICdPYmplY3QnLCB7c2V0UHJvdG90eXBlT2Y6IF9fd2VicGFja19yZXF1aXJlX18oOTgpLnNldH0pOwoKCS8qKiovIH0pLAoJLyogMTA1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCXZhciBMSUJSQVJZICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KQoJICAsIGdsb2JhbCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKCSAgLCBjdHggICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQoJICAsIGNsYXNzb2YgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTUpCgkgICwgJGV4cG9ydCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KQoJICAsIGlzT2JqZWN0ICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKCSAgLCBhRnVuY3Rpb24gICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KQoJICAsIGFuSW5zdGFuY2UgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODYpCgkgICwgZm9yT2YgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4OCkKCSAgLCBzcGVjaWVzQ29uc3RydWN0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMCkKCSAgLCB0YXNrICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KS5zZXQKCSAgLCBtaWNyb3Rhc2sgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk1KSgpCgkgICwgUFJPTUlTRSAgICAgICAgICAgID0gJ1Byb21pc2UnCgkgICwgVHlwZUVycm9yICAgICAgICAgID0gZ2xvYmFsLlR5cGVFcnJvcgoJICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCgkgICwgJFByb21pc2UgICAgICAgICAgID0gZ2xvYmFsW1BST01JU0VdCgkgICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MKCSAgLCBpc05vZGUgICAgICAgICAgICAgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJwoJICAsIGVtcHR5ICAgICAgICAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KCSAgLCBJbnRlcm5hbCwgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5LCBXcmFwcGVyOwoKCXZhciBVU0VfTkFUSVZFID0gISFmdW5jdGlvbigpewoJICB0cnkgewoJICAgIC8vIGNvcnJlY3Qgc3ViY2xhc3Npbmcgd2l0aCBAQHNwZWNpZXMgc3VwcG9ydAoJICAgIHZhciBwcm9taXNlICAgICA9ICRQcm9taXNlLnJlc29sdmUoMSkKCSAgICAgICwgRmFrZVByb21pc2UgPSAocHJvbWlzZS5jb25zdHJ1Y3RvciA9IHt9KVtfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdzcGVjaWVzJyldID0gZnVuY3Rpb24oZXhlYyl7IGV4ZWMoZW1wdHksIGVtcHR5KTsgfTsKCSAgICAvLyB1bmhhbmRsZWQgcmVqZWN0aW9ucyB0cmFja2luZyBzdXBwb3J0LCBOb2RlSlMgUHJvbWlzZSB3aXRob3V0IGl0IGZhaWxzIEBAc3BlY2llcyB0ZXN0CgkgICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKSAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2U7CgkgIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCX0oKTsKCgkvLyBoZWxwZXJzCgl2YXIgc2FtZUNvbnN0cnVjdG9yID0gZnVuY3Rpb24oYSwgYil7CgkgIC8vIHdpdGggbGlicmFyeSB3cmFwcGVyIHNwZWNpYWwgY2FzZQoJICByZXR1cm4gYSA9PT0gYiB8fCBhID09PSAkUHJvbWlzZSAmJiBiID09PSBXcmFwcGVyOwoJfTsKCXZhciBpc1RoZW5hYmxlID0gZnVuY3Rpb24oaXQpewoJICB2YXIgdGhlbjsKCSAgcmV0dXJuIGlzT2JqZWN0KGl0KSAmJiB0eXBlb2YgKHRoZW4gPSBpdC50aGVuKSA9PSAnZnVuY3Rpb24nID8gdGhlbiA6IGZhbHNlOwoJfTsKCXZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewoJICByZXR1cm4gc2FtZUNvbnN0cnVjdG9yKCRQcm9taXNlLCBDKQoJICAgID8gbmV3IFByb21pc2VDYXBhYmlsaXR5KEMpCgkgICAgOiBuZXcgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5KEMpOwoJfTsKCXZhciBQcm9taXNlQ2FwYWJpbGl0eSA9IEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewoJICB2YXIgcmVzb2x2ZSwgcmVqZWN0OwoJICB0aGlzLnByb21pc2UgPSBuZXcgQyhmdW5jdGlvbigkJHJlc29sdmUsICQkcmVqZWN0KXsKCSAgICBpZihyZXNvbHZlICE9PSB1bmRlZmluZWQgfHwgcmVqZWN0ICE9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCdCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvcicpOwoJICAgIHJlc29sdmUgPSAkJHJlc29sdmU7CgkgICAgcmVqZWN0ICA9ICQkcmVqZWN0OwoJICB9KTsKCSAgdGhpcy5yZXNvbHZlID0gYUZ1bmN0aW9uKHJlc29sdmUpOwoJICB0aGlzLnJlamVjdCAgPSBhRnVuY3Rpb24ocmVqZWN0KTsKCX07Cgl2YXIgcGVyZm9ybSA9IGZ1bmN0aW9uKGV4ZWMpewoJICB0cnkgewoJICAgIGV4ZWMoKTsKCSAgfSBjYXRjaChlKXsKCSAgICByZXR1cm4ge2Vycm9yOiBlfTsKCSAgfQoJfTsKCXZhciBub3RpZnkgPSBmdW5jdGlvbihwcm9taXNlLCBpc1JlamVjdCl7CgkgIGlmKHByb21pc2UuX24pcmV0dXJuOwoJICBwcm9taXNlLl9uID0gdHJ1ZTsKCSAgdmFyIGNoYWluID0gcHJvbWlzZS5fYzsKCSAgbWljcm90YXNrKGZ1bmN0aW9uKCl7CgkgICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgoJICAgICAgLCBvayAgICA9IHByb21pc2UuX3MgPT0gMQoJICAgICAgLCBpICAgICA9IDA7CgkgICAgdmFyIHJ1biA9IGZ1bmN0aW9uKHJlYWN0aW9uKXsKCSAgICAgIHZhciBoYW5kbGVyID0gb2sgPyByZWFjdGlvbi5vayA6IHJlYWN0aW9uLmZhaWwKCSAgICAgICAgLCByZXNvbHZlID0gcmVhY3Rpb24ucmVzb2x2ZQoJICAgICAgICAsIHJlamVjdCAgPSByZWFjdGlvbi5yZWplY3QKCSAgICAgICAgLCBkb21haW4gID0gcmVhY3Rpb24uZG9tYWluCgkgICAgICAgICwgcmVzdWx0LCB0aGVuOwoJICAgICAgdHJ5IHsKCSAgICAgICAgaWYoaGFuZGxlcil7CgkgICAgICAgICAgaWYoIW9rKXsKCSAgICAgICAgICAgIGlmKHByb21pc2UuX2ggPT0gMilvbkhhbmRsZVVuaGFuZGxlZChwcm9taXNlKTsKCSAgICAgICAgICAgIHByb21pc2UuX2ggPSAxOwoJICAgICAgICAgIH0KCSAgICAgICAgICBpZihoYW5kbGVyID09PSB0cnVlKXJlc3VsdCA9IHZhbHVlOwoJICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgaWYoZG9tYWluKWRvbWFpbi5lbnRlcigpOwoJICAgICAgICAgICAgcmVzdWx0ID0gaGFuZGxlcih2YWx1ZSk7CgkgICAgICAgICAgICBpZihkb21haW4pZG9tYWluLmV4aXQoKTsKCSAgICAgICAgICB9CgkgICAgICAgICAgaWYocmVzdWx0ID09PSByZWFjdGlvbi5wcm9taXNlKXsKCSAgICAgICAgICAgIHJlamVjdChUeXBlRXJyb3IoJ1Byb21pc2UtY2hhaW4gY3ljbGUnKSk7CgkgICAgICAgICAgfSBlbHNlIGlmKHRoZW4gPSBpc1RoZW5hYmxlKHJlc3VsdCkpewoJICAgICAgICAgICAgdGhlbi5jYWxsKHJlc3VsdCwgcmVzb2x2ZSwgcmVqZWN0KTsKCSAgICAgICAgICB9IGVsc2UgcmVzb2x2ZShyZXN1bHQpOwoJICAgICAgICB9IGVsc2UgcmVqZWN0KHZhbHVlKTsKCSAgICAgIH0gY2F0Y2goZSl7CgkgICAgICAgIHJlamVjdChlKTsKCSAgICAgIH0KCSAgICB9OwoJICAgIHdoaWxlKGNoYWluLmxlbmd0aCA+IGkpcnVuKGNoYWluW2krK10pOyAvLyB2YXJpYWJsZSBsZW5ndGggLSBjYW4ndCB1c2UgZm9yRWFjaAoJICAgIHByb21pc2UuX2MgPSBbXTsKCSAgICBwcm9taXNlLl9uID0gZmFsc2U7CgkgICAgaWYoaXNSZWplY3QgJiYgIXByb21pc2UuX2gpb25VbmhhbmRsZWQocHJvbWlzZSk7CgkgIH0pOwoJfTsKCXZhciBvblVuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2UpewoJICB0YXNrLmNhbGwoZ2xvYmFsLCBmdW5jdGlvbigpewoJICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YKCSAgICAgICwgYWJydXB0LCBoYW5kbGVyLCBjb25zb2xlOwoJICAgIGlmKGlzVW5oYW5kbGVkKHByb21pc2UpKXsKCSAgICAgIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKCSAgICAgICAgaWYoaXNOb2RlKXsKCSAgICAgICAgICBwcm9jZXNzLmVtaXQoJ3VuaGFuZGxlZFJlamVjdGlvbicsIHZhbHVlLCBwcm9taXNlKTsKCSAgICAgICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub251bmhhbmRsZWRyZWplY3Rpb24pewoJICAgICAgICAgIGhhbmRsZXIoe3Byb21pc2U6IHByb21pc2UsIHJlYXNvbjogdmFsdWV9KTsKCSAgICAgICAgfSBlbHNlIGlmKChjb25zb2xlID0gZ2xvYmFsLmNvbnNvbGUpICYmIGNvbnNvbGUuZXJyb3IpewoJICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbicsIHZhbHVlKTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgICAvLyBCcm93c2VycyBzaG91bGQgbm90IHRyaWdnZXIgYHJlamVjdGlvbkhhbmRsZWRgIGV2ZW50IGlmIGl0IHdhcyBoYW5kbGVkIGhlcmUsIE5vZGVKUyAtIHNob3VsZAoJICAgICAgcHJvbWlzZS5faCA9IGlzTm9kZSB8fCBpc1VuaGFuZGxlZChwcm9taXNlKSA/IDIgOiAxOwoJICAgIH0gcHJvbWlzZS5fYSA9IHVuZGVmaW5lZDsKCSAgICBpZihhYnJ1cHQpdGhyb3cgYWJydXB0LmVycm9yOwoJICB9KTsKCX07Cgl2YXIgaXNVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKCSAgaWYocHJvbWlzZS5faCA9PSAxKXJldHVybiBmYWxzZTsKCSAgdmFyIGNoYWluID0gcHJvbWlzZS5fYSB8fCBwcm9taXNlLl9jCgkgICAgLCBpICAgICA9IDAKCSAgICAsIHJlYWN0aW9uOwoJICB3aGlsZShjaGFpbi5sZW5ndGggPiBpKXsKCSAgICByZWFjdGlvbiA9IGNoYWluW2krK107CgkgICAgaWYocmVhY3Rpb24uZmFpbCB8fCAhaXNVbmhhbmRsZWQocmVhY3Rpb24ucHJvbWlzZSkpcmV0dXJuIGZhbHNlOwoJICB9IHJldHVybiB0cnVlOwoJfTsKCXZhciBvbkhhbmRsZVVuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2UpewoJICB0YXNrLmNhbGwoZ2xvYmFsLCBmdW5jdGlvbigpewoJICAgIHZhciBoYW5kbGVyOwoJICAgIGlmKGlzTm9kZSl7CgkgICAgICBwcm9jZXNzLmVtaXQoJ3JlamVjdGlvbkhhbmRsZWQnLCBwcm9taXNlKTsKCSAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnJlamVjdGlvbmhhbmRsZWQpewoJICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiBwcm9taXNlLl92fSk7CgkgICAgfQoJICB9KTsKCX07Cgl2YXIgJHJlamVjdCA9IGZ1bmN0aW9uKHZhbHVlKXsKCSAgdmFyIHByb21pc2UgPSB0aGlzOwoJICBpZihwcm9taXNlLl9kKXJldHVybjsKCSAgcHJvbWlzZS5fZCA9IHRydWU7CgkgIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAoJICBwcm9taXNlLl92ID0gdmFsdWU7CgkgIHByb21pc2UuX3MgPSAyOwoJICBpZighcHJvbWlzZS5fYSlwcm9taXNlLl9hID0gcHJvbWlzZS5fYy5zbGljZSgpOwoJICBub3RpZnkocHJvbWlzZSwgdHJ1ZSk7Cgl9OwoJdmFyICRyZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpewoJICB2YXIgcHJvbWlzZSA9IHRoaXMKCSAgICAsIHRoZW47CgkgIGlmKHByb21pc2UuX2QpcmV0dXJuOwoJICBwcm9taXNlLl9kID0gdHJ1ZTsKCSAgcHJvbWlzZSA9IHByb21pc2UuX3cgfHwgcHJvbWlzZTsgLy8gdW53cmFwCgkgIHRyeSB7CgkgICAgaWYocHJvbWlzZSA9PT0gdmFsdWUpdGhyb3cgVHlwZUVycm9yKCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZiIpOwoJICAgIGlmKHRoZW4gPSBpc1RoZW5hYmxlKHZhbHVlKSl7CgkgICAgICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKCSAgICAgICAgdmFyIHdyYXBwZXIgPSB7X3c6IHByb21pc2UsIF9kOiBmYWxzZX07IC8vIHdyYXAKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICB0aGVuLmNhbGwodmFsdWUsIGN0eCgkcmVzb2x2ZSwgd3JhcHBlciwgMSksIGN0eCgkcmVqZWN0LCB3cmFwcGVyLCAxKSk7CgkgICAgICAgIH0gY2F0Y2goZSl7CgkgICAgICAgICAgJHJlamVjdC5jYWxsKHdyYXBwZXIsIGUpOwoJICAgICAgICB9CgkgICAgICB9KTsKCSAgICB9IGVsc2UgewoJICAgICAgcHJvbWlzZS5fdiA9IHZhbHVlOwoJICAgICAgcHJvbWlzZS5fcyA9IDE7CgkgICAgICBub3RpZnkocHJvbWlzZSwgZmFsc2UpOwoJICAgIH0KCSAgfSBjYXRjaChlKXsKCSAgICAkcmVqZWN0LmNhbGwoe193OiBwcm9taXNlLCBfZDogZmFsc2V9LCBlKTsgLy8gd3JhcAoJICB9Cgl9OwoKCS8vIGNvbnN0cnVjdG9yIHBvbHlmaWxsCglpZighVVNFX05BVElWRSl7CgkgIC8vIDI1LjQuMy4xIFByb21pc2UoZXhlY3V0b3IpCgkgICRQcm9taXNlID0gZnVuY3Rpb24gUHJvbWlzZShleGVjdXRvcil7CgkgICAgYW5JbnN0YW5jZSh0aGlzLCAkUHJvbWlzZSwgUFJPTUlTRSwgJ19oJyk7CgkgICAgYUZ1bmN0aW9uKGV4ZWN1dG9yKTsKCSAgICBJbnRlcm5hbC5jYWxsKHRoaXMpOwoJICAgIHRyeSB7CgkgICAgICBleGVjdXRvcihjdHgoJHJlc29sdmUsIHRoaXMsIDEpLCBjdHgoJHJlamVjdCwgdGhpcywgMSkpOwoJICAgIH0gY2F0Y2goZXJyKXsKCSAgICAgICRyZWplY3QuY2FsbCh0aGlzLCBlcnIpOwoJICAgIH0KCSAgfTsKCSAgSW50ZXJuYWwgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKCSAgICB0aGlzLl9jID0gW107ICAgICAgICAgICAgIC8vIDwtIGF3YWl0aW5nIHJlYWN0aW9ucwoJICAgIHRoaXMuX2EgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gY2hlY2tlZCBpbiBpc1VuaGFuZGxlZCByZWFjdGlvbnMKCSAgICB0aGlzLl9zID0gMDsgICAgICAgICAgICAgIC8vIDwtIHN0YXRlCgkgICAgdGhpcy5fZCA9IGZhbHNlOyAgICAgICAgICAvLyA8LSBkb25lCgkgICAgdGhpcy5fdiA9IHVuZGVmaW5lZDsgICAgICAvLyA8LSB2YWx1ZQoJICAgIHRoaXMuX2ggPSAwOyAgICAgICAgICAgICAgLy8gPC0gcmVqZWN0aW9uIHN0YXRlLCAwIC0gZGVmYXVsdCwgMSAtIGhhbmRsZWQsIDIgLSB1bmhhbmRsZWQKCSAgICB0aGlzLl9uID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIG5vdGlmeQoJICB9OwoJICBJbnRlcm5hbC5wcm90b3R5cGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk3KSgkUHJvbWlzZS5wcm90b3R5cGUsIHsKCSAgICAvLyAyNS40LjUuMyBQcm9taXNlLnByb3RvdHlwZS50aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKQoJICAgIHRoZW46IGZ1bmN0aW9uIHRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpewoJICAgICAgdmFyIHJlYWN0aW9uICAgID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsICRQcm9taXNlKSk7CgkgICAgICByZWFjdGlvbi5vayAgICAgPSB0eXBlb2Ygb25GdWxmaWxsZWQgPT0gJ2Z1bmN0aW9uJyA/IG9uRnVsZmlsbGVkIDogdHJ1ZTsKCSAgICAgIHJlYWN0aW9uLmZhaWwgICA9IHR5cGVvZiBvblJlamVjdGVkID09ICdmdW5jdGlvbicgJiYgb25SZWplY3RlZDsKCSAgICAgIHJlYWN0aW9uLmRvbWFpbiA9IGlzTm9kZSA/IHByb2Nlc3MuZG9tYWluIDogdW5kZWZpbmVkOwoJICAgICAgdGhpcy5fYy5wdXNoKHJlYWN0aW9uKTsKCSAgICAgIGlmKHRoaXMuX2EpdGhpcy5fYS5wdXNoKHJlYWN0aW9uKTsKCSAgICAgIGlmKHRoaXMuX3Mpbm90aWZ5KHRoaXMsIGZhbHNlKTsKCSAgICAgIHJldHVybiByZWFjdGlvbi5wcm9taXNlOwoJICAgIH0sCgkgICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2gob25SZWplY3RlZCkKCSAgICAnY2F0Y2gnOiBmdW5jdGlvbihvblJlamVjdGVkKXsKCSAgICAgIHJldHVybiB0aGlzLnRoZW4odW5kZWZpbmVkLCBvblJlamVjdGVkKTsKCSAgICB9CgkgIH0pOwoJICBQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKCl7CgkgICAgdmFyIHByb21pc2UgID0gbmV3IEludGVybmFsOwoJICAgIHRoaXMucHJvbWlzZSA9IHByb21pc2U7CgkgICAgdGhpcy5yZXNvbHZlID0gY3R4KCRyZXNvbHZlLCBwcm9taXNlLCAxKTsKCSAgICB0aGlzLnJlamVjdCAgPSBjdHgoJHJlamVjdCwgcHJvbWlzZSwgMSk7CgkgIH07Cgl9CgoJJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1Byb21pc2U6ICRQcm9taXNlfSk7CglfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKSgkUHJvbWlzZSwgUFJPTUlTRSk7CglfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KShQUk9NSVNFKTsKCVdyYXBwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApW1BST01JU0VdOwoKCS8vIHN0YXRpY3MKCSRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIFBST01JU0UsIHsKCSAgLy8gMjUuNC40LjUgUHJvbWlzZS5yZWplY3QocikKCSAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3Qocil7CgkgICAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eSh0aGlzKQoJICAgICAgLCAkJHJlamVjdCAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CgkgICAgJCRyZWplY3Qocik7CgkgICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKCSAgfQoJfSk7CgkkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIChMSUJSQVJZIHx8ICFVU0VfTkFUSVZFKSwgUFJPTUlTRSwgewoJICAvLyAyNS40LjQuNiBQcm9taXNlLnJlc29sdmUoeCkKCSAgcmVzb2x2ZTogZnVuY3Rpb24gcmVzb2x2ZSh4KXsKCSAgICAvLyBpbnN0YW5jZW9mIGluc3RlYWQgb2YgaW50ZXJuYWwgc2xvdCBjaGVjayBiZWNhdXNlIHdlIHNob3VsZCBmaXggaXQgd2l0aG91dCByZXBsYWNlbWVudCBuYXRpdmUgUHJvbWlzZSBjb3JlCgkgICAgaWYoeCBpbnN0YW5jZW9mICRQcm9taXNlICYmIHNhbWVDb25zdHJ1Y3Rvcih4LmNvbnN0cnVjdG9yLCB0aGlzKSlyZXR1cm4geDsKCSAgICB2YXIgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHRoaXMpCgkgICAgICAsICQkcmVzb2x2ZSAgPSBjYXBhYmlsaXR5LnJlc29sdmU7CgkgICAgJCRyZXNvbHZlKHgpOwoJICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CgkgIH0KCX0pOwoJJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhKFVTRV9OQVRJVkUgJiYgX193ZWJwYWNrX3JlcXVpcmVfXyg5MykoZnVuY3Rpb24oaXRlcil7CgkgICRQcm9taXNlLmFsbChpdGVyKVsnY2F0Y2gnXShlbXB0eSk7Cgl9KSksIFBST01JU0UsIHsKCSAgLy8gMjUuNC40LjEgUHJvbWlzZS5hbGwoaXRlcmFibGUpCgkgIGFsbDogZnVuY3Rpb24gYWxsKGl0ZXJhYmxlKXsKCSAgICB2YXIgQyAgICAgICAgICA9IHRoaXMKCSAgICAgICwgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KEMpCgkgICAgICAsIHJlc29sdmUgICAgPSBjYXBhYmlsaXR5LnJlc29sdmUKCSAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwoJICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CgkgICAgICB2YXIgdmFsdWVzICAgID0gW10KCSAgICAgICAgLCBpbmRleCAgICAgPSAwCgkgICAgICAgICwgcmVtYWluaW5nID0gMTsKCSAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CgkgICAgICAgIHZhciAkaW5kZXggICAgICAgID0gaW5kZXgrKwoJICAgICAgICAgICwgYWxyZWFkeUNhbGxlZCA9IGZhbHNlOwoJICAgICAgICB2YWx1ZXMucHVzaCh1bmRlZmluZWQpOwoJICAgICAgICByZW1haW5pbmcrKzsKCSAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oZnVuY3Rpb24odmFsdWUpewoJICAgICAgICAgIGlmKGFscmVhZHlDYWxsZWQpcmV0dXJuOwoJICAgICAgICAgIGFscmVhZHlDYWxsZWQgID0gdHJ1ZTsKCSAgICAgICAgICB2YWx1ZXNbJGluZGV4XSA9IHZhbHVlOwoJICAgICAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKCSAgICAgICAgfSwgcmVqZWN0KTsKCSAgICAgIH0pOwoJICAgICAgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpOwoJICAgIH0pOwoJICAgIGlmKGFicnVwdClyZWplY3QoYWJydXB0LmVycm9yKTsKCSAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwoJICB9LAoJICAvLyAyNS40LjQuNCBQcm9taXNlLnJhY2UoaXRlcmFibGUpCgkgIHJhY2U6IGZ1bmN0aW9uIHJhY2UoaXRlcmFibGUpewoJICAgIHZhciBDICAgICAgICAgID0gdGhpcwoJICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKCSAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwoJICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CgkgICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2UpewoJICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihjYXBhYmlsaXR5LnJlc29sdmUsIHJlamVjdCk7CgkgICAgICB9KTsKCSAgICB9KTsKCSAgICBpZihhYnJ1cHQpcmVqZWN0KGFicnVwdC5lcnJvcik7CgkgICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKCSAgfQoJfSk7CgoJLyoqKi8gfSksCgkvKiAxMDYgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoJLy8gRUNNQVNjcmlwdCA2IHN5bWJvbHMgc2hpbQoJdmFyIGdsb2JhbCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQoJICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKCSAgLCBERVNDUklQVE9SUyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikKCSAgLCAkZXhwb3J0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOSkKCSAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCgkgICwgTUVUQSAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDczKS5LRVkKCSAgLCAkZmFpbHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpCgkgICwgc2hhcmVkICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKQoJICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKCSAgLCB1aWQgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpCgkgICwgd2tzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpCgkgICwgd2tzRXh0ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KQoJICAsIHdrc0RlZmluZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OCkKCSAgLCBrZXlPZiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTQpCgkgICwgZW51bUtleXMgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg3KQoJICAsIGlzQXJyYXkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MSkKCSAgLCBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKCSAgLCB0b0lPYmplY3QgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCgkgICwgdG9QcmltaXRpdmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQoJICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKCSAgLCBfY3JlYXRlICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzcpCgkgICwgZ09QTkV4dCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KQoJICAsICRHT1BEICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NykKCSAgLCAkRFAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKCSAgLCAka2V5cyAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpCgkgICwgZ09QRCAgICAgICAgICAgPSAkR09QRC5mCgkgICwgZFAgICAgICAgICAgICAgPSAkRFAuZgoJICAsIGdPUE4gICAgICAgICAgID0gZ09QTkV4dC5mCgkgICwgJFN5bWJvbCAgICAgICAgPSBnbG9iYWwuU3ltYm9sCgkgICwgJEpTT04gICAgICAgICAgPSBnbG9iYWwuSlNPTgoJICAsIF9zdHJpbmdpZnkgICAgID0gJEpTT04gJiYgJEpTT04uc3RyaW5naWZ5CgkgICwgUFJPVE9UWVBFICAgICAgPSAncHJvdG90eXBlJwoJICAsIEhJRERFTiAgICAgICAgID0gd2tzKCdfaGlkZGVuJykKCSAgLCBUT19QUklNSVRJVkUgICA9IHdrcygndG9QcmltaXRpdmUnKQoJICAsIGlzRW51bSAgICAgICAgID0ge30ucHJvcGVydHlJc0VudW1lcmFibGUKCSAgLCBTeW1ib2xSZWdpc3RyeSA9IHNoYXJlZCgnc3ltYm9sLXJlZ2lzdHJ5JykKCSAgLCBBbGxTeW1ib2xzICAgICA9IHNoYXJlZCgnc3ltYm9scycpCgkgICwgT1BTeW1ib2xzICAgICAgPSBzaGFyZWQoJ29wLXN5bWJvbHMnKQoJICAsIE9iamVjdFByb3RvICAgID0gT2JqZWN0W1BST1RPVFlQRV0KCSAgLCBVU0VfTkFUSVZFICAgICA9IHR5cGVvZiAkU3ltYm9sID09ICdmdW5jdGlvbicKCSAgLCBRT2JqZWN0ICAgICAgICA9IGdsb2JhbC5RT2JqZWN0OwoJLy8gRG9uJ3QgdXNlIHNldHRlcnMgaW4gUXQgU2NyaXB0LCBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvMTczCgl2YXIgc2V0dGVyID0gIVFPYmplY3QgfHwgIVFPYmplY3RbUFJPVE9UWVBFXSB8fCAhUU9iamVjdFtQUk9UT1RZUEVdLmZpbmRDaGlsZDsKCgkvLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODcKCXZhciBzZXRTeW1ib2xEZXNjID0gREVTQ1JJUFRPUlMgJiYgJGZhaWxzKGZ1bmN0aW9uKCl7CgkgIHJldHVybiBfY3JlYXRlKGRQKHt9LCAnYScsIHsKCSAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBkUCh0aGlzLCAnYScsIHt2YWx1ZTogN30pLmE7IH0KCSAgfSkpLmEgIT0gNzsKCX0pID8gZnVuY3Rpb24oaXQsIGtleSwgRCl7CgkgIHZhciBwcm90b0Rlc2MgPSBnT1BEKE9iamVjdFByb3RvLCBrZXkpOwoJICBpZihwcm90b0Rlc2MpZGVsZXRlIE9iamVjdFByb3RvW2tleV07CgkgIGRQKGl0LCBrZXksIEQpOwoJICBpZihwcm90b0Rlc2MgJiYgaXQgIT09IE9iamVjdFByb3RvKWRQKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7Cgl9IDogZFA7CgoJdmFyIHdyYXAgPSBmdW5jdGlvbih0YWcpewoJICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pOwoJICBzeW0uX2sgPSB0YWc7CgkgIHJldHVybiBzeW07Cgl9OwoKCXZhciBpc1N5bWJvbCA9IFVTRV9OQVRJVkUgJiYgdHlwZW9mICRTeW1ib2wuaXRlcmF0b3IgPT0gJ3N5bWJvbCcgPyBmdW5jdGlvbihpdCl7CgkgIHJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCc7Cgl9IDogZnVuY3Rpb24oaXQpewoJICByZXR1cm4gaXQgaW5zdGFuY2VvZiAkU3ltYm9sOwoJfTsKCgl2YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCl7CgkgIGlmKGl0ID09PSBPYmplY3RQcm90bykkZGVmaW5lUHJvcGVydHkoT1BTeW1ib2xzLCBrZXksIEQpOwoJICBhbk9iamVjdChpdCk7CgkgIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CgkgIGFuT2JqZWN0KEQpOwoJICBpZihoYXMoQWxsU3ltYm9scywga2V5KSl7CgkgICAgaWYoIUQuZW51bWVyYWJsZSl7CgkgICAgICBpZighaGFzKGl0LCBISURERU4pKWRQKGl0LCBISURERU4sIGNyZWF0ZURlc2MoMSwge30pKTsKCSAgICAgIGl0W0hJRERFTl1ba2V5XSA9IHRydWU7CgkgICAgfSBlbHNlIHsKCSAgICAgIGlmKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0paXRbSElEREVOXVtrZXldID0gZmFsc2U7CgkgICAgICBEID0gX2NyZWF0ZShELCB7ZW51bWVyYWJsZTogY3JlYXRlRGVzYygwLCBmYWxzZSl9KTsKCSAgICB9IHJldHVybiBzZXRTeW1ib2xEZXNjKGl0LCBrZXksIEQpOwoJICB9IHJldHVybiBkUChpdCwga2V5LCBEKTsKCX07Cgl2YXIgJGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKGl0LCBQKXsKCSAgYW5PYmplY3QoaXQpOwoJICB2YXIga2V5cyA9IGVudW1LZXlzKFAgPSB0b0lPYmplY3QoUCkpCgkgICAgLCBpICAgID0gMAoJICAgICwgbCA9IGtleXMubGVuZ3RoCgkgICAgLCBrZXk7CgkgIHdoaWxlKGwgPiBpKSRkZWZpbmVQcm9wZXJ0eShpdCwga2V5ID0ga2V5c1tpKytdLCBQW2tleV0pOwoJICByZXR1cm4gaXQ7Cgl9OwoJdmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaXQsIFApewoJICByZXR1cm4gUCA9PT0gdW5kZWZpbmVkID8gX2NyZWF0ZShpdCkgOiAkZGVmaW5lUHJvcGVydGllcyhfY3JlYXRlKGl0KSwgUCk7Cgl9OwoJdmFyICRwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IGZ1bmN0aW9uIHByb3BlcnR5SXNFbnVtZXJhYmxlKGtleSl7CgkgIHZhciBFID0gaXNFbnVtLmNhbGwodGhpcywga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKSk7CgkgIGlmKHRoaXMgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKXJldHVybiBmYWxzZTsKCSAgcmV0dXJuIEUgfHwgIWhhcyh0aGlzLCBrZXkpIHx8ICFoYXMoQWxsU3ltYm9scywga2V5KSB8fCBoYXModGhpcywgSElEREVOKSAmJiB0aGlzW0hJRERFTl1ba2V5XSA/IEUgOiB0cnVlOwoJfTsKCXZhciAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpewoJICBpdCAgPSB0b0lPYmplY3QoaXQpOwoJICBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpOwoJICBpZihpdCA9PT0gT2JqZWN0UHJvdG8gJiYgaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIWhhcyhPUFN5bWJvbHMsIGtleSkpcmV0dXJuOwoJICB2YXIgRCA9IGdPUEQoaXQsIGtleSk7CgkgIGlmKEQgJiYgaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIShoYXMoaXQsIEhJRERFTikgJiYgaXRbSElEREVOXVtrZXldKSlELmVudW1lcmFibGUgPSB0cnVlOwoJICByZXR1cm4gRDsKCX07Cgl2YXIgJGdldE93blByb3BlcnR5TmFtZXMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKGl0KXsKCSAgdmFyIG5hbWVzICA9IGdPUE4odG9JT2JqZWN0KGl0KSkKCSAgICAsIHJlc3VsdCA9IFtdCgkgICAgLCBpICAgICAgPSAwCgkgICAgLCBrZXk7CgkgIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewoJICAgIGlmKCFoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYga2V5ICE9IEhJRERFTiAmJiBrZXkgIT0gTUVUQSlyZXN1bHQucHVzaChrZXkpOwoJICB9IHJldHVybiByZXN1bHQ7Cgl9OwoJdmFyICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMoaXQpewoJICB2YXIgSVNfT1AgID0gaXQgPT09IE9iamVjdFByb3RvCgkgICAgLCBuYW1lcyAgPSBnT1BOKElTX09QID8gT1BTeW1ib2xzIDogdG9JT2JqZWN0KGl0KSkKCSAgICAsIHJlc3VsdCA9IFtdCgkgICAgLCBpICAgICAgPSAwCgkgICAgLCBrZXk7CgkgIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewoJICAgIGlmKGhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiAoSVNfT1AgPyBoYXMoT2JqZWN0UHJvdG8sIGtleSkgOiB0cnVlKSlyZXN1bHQucHVzaChBbGxTeW1ib2xzW2tleV0pOwoJICB9IHJldHVybiByZXN1bHQ7Cgl9OwoKCS8vIDE5LjQuMS4xIFN5bWJvbChbZGVzY3JpcHRpb25dKQoJaWYoIVVTRV9OQVRJVkUpewoJICAkU3ltYm9sID0gZnVuY3Rpb24gU3ltYm9sKCl7CgkgICAgaWYodGhpcyBpbnN0YW5jZW9mICRTeW1ib2wpdGhyb3cgVHlwZUVycm9yKCdTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3IhJyk7CgkgICAgdmFyIHRhZyA9IHVpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7CgkgICAgdmFyICRzZXQgPSBmdW5jdGlvbih2YWx1ZSl7CgkgICAgICBpZih0aGlzID09PSBPYmplY3RQcm90bykkc2V0LmNhbGwoT1BTeW1ib2xzLCB2YWx1ZSk7CgkgICAgICBpZihoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKXRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7CgkgICAgICBzZXRTeW1ib2xEZXNjKHRoaXMsIHRhZywgY3JlYXRlRGVzYygxLCB2YWx1ZSkpOwoJICAgIH07CgkgICAgaWYoREVTQ1JJUFRPUlMgJiYgc2V0dGVyKXNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0fSk7CgkgICAgcmV0dXJuIHdyYXAodGFnKTsKCSAgfTsKCSAgcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEVdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpewoJICAgIHJldHVybiB0aGlzLl9rOwoJICB9KTsKCgkgICRHT1BELmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwoJICAkRFAuZiAgID0gJGRlZmluZVByb3BlcnR5OwoJICBfX3dlYnBhY2tfcmVxdWlyZV9fKDY1KS5mID0gZ09QTkV4dC5mID0gJGdldE93blByb3BlcnR5TmFtZXM7CgkgIF9fd2VicGFja19yZXF1aXJlX18oNDEpLmYgID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlOwoJICBfX3dlYnBhY2tfcmVxdWlyZV9fKDU4KS5mID0gJGdldE93blByb3BlcnR5U3ltYm9sczsKCgkgIGlmKERFU0NSSVBUT1JTICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KSl7CgkgICAgcmVkZWZpbmUoT2JqZWN0UHJvdG8sICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsICRwcm9wZXJ0eUlzRW51bWVyYWJsZSwgdHJ1ZSk7CgkgIH0KCgkgIHdrc0V4dC5mID0gZnVuY3Rpb24obmFtZSl7CgkgICAgcmV0dXJuIHdyYXAod2tzKG5hbWUpKTsKCSAgfQoJfQoKCSRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtTeW1ib2w6ICRTeW1ib2x9KTsKCglmb3IodmFyIHN5bWJvbHMgPSAoCgkgIC8vIDE5LjQuMi4yLCAxOS40LjIuMywgMTkuNC4yLjQsIDE5LjQuMi42LCAxOS40LjIuOCwgMTkuNC4yLjksIDE5LjQuMi4xMCwgMTkuNC4yLjExLCAxOS40LjIuMTIsIDE5LjQuMi4xMywgMTkuNC4yLjE0CgkgICdoYXNJbnN0YW5jZSxpc0NvbmNhdFNwcmVhZGFibGUsaXRlcmF0b3IsbWF0Y2gscmVwbGFjZSxzZWFyY2gsc3BlY2llcyxzcGxpdCx0b1ByaW1pdGl2ZSx0b1N0cmluZ1RhZyx1bnNjb3BhYmxlcycKCSkuc3BsaXQoJywnKSwgaSA9IDA7IHN5bWJvbHMubGVuZ3RoID4gaTsgKXdrcyhzeW1ib2xzW2krK10pOwoKCWZvcih2YXIgc3ltYm9scyA9ICRrZXlzKHdrcy5zdG9yZSksIGkgPSAwOyBzeW1ib2xzLmxlbmd0aCA+IGk7ICl3a3NEZWZpbmUoc3ltYm9sc1tpKytdKTsKCgkkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywgewoJICAvLyAxOS40LjIuMSBTeW1ib2wuZm9yKGtleSkKCSAgJ2Zvcic6IGZ1bmN0aW9uKGtleSl7CgkgICAgcmV0dXJuIGhhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKQoJICAgICAgPyBTeW1ib2xSZWdpc3RyeVtrZXldCgkgICAgICA6IFN5bWJvbFJlZ2lzdHJ5W2tleV0gPSAkU3ltYm9sKGtleSk7CgkgIH0sCgkgIC8vIDE5LjQuMi41IFN5bWJvbC5rZXlGb3Ioc3ltKQoJICBrZXlGb3I6IGZ1bmN0aW9uIGtleUZvcihrZXkpewoJICAgIGlmKGlzU3ltYm9sKGtleSkpcmV0dXJuIGtleU9mKFN5bWJvbFJlZ2lzdHJ5LCBrZXkpOwoJICAgIHRocm93IFR5cGVFcnJvcihrZXkgKyAnIGlzIG5vdCBhIHN5bWJvbCEnKTsKCSAgfSwKCSAgdXNlU2V0dGVyOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSB0cnVlOyB9LAoJICB1c2VTaW1wbGU6IGZ1bmN0aW9uKCl7IHNldHRlciA9IGZhbHNlOyB9Cgl9KTsKCgkkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnT2JqZWN0JywgewoJICAvLyAxOS4xLjIuMiBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCgkgIGNyZWF0ZTogJGNyZWF0ZSwKCSAgLy8gMTkuMS4yLjQgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCgkgIGRlZmluZVByb3BlcnR5OiAkZGVmaW5lUHJvcGVydHksCgkgIC8vIDE5LjEuMi4zIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpCgkgIGRlZmluZVByb3BlcnRpZXM6ICRkZWZpbmVQcm9wZXJ0aWVzLAoJICAvLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApCgkgIGdldE93blByb3BlcnR5RGVzY3JpcHRvcjogJGdldE93blByb3BlcnR5RGVzY3JpcHRvciwKCSAgLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKCSAgZ2V0T3duUHJvcGVydHlOYW1lczogJGdldE93blByb3BlcnR5TmFtZXMsCgkgIC8vIDE5LjEuMi44IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoTykKCSAgZ2V0T3duUHJvcGVydHlTeW1ib2xzOiAkZ2V0T3duUHJvcGVydHlTeW1ib2xzCgl9KTsKCgkvLyAyNC4zLjIgSlNPTi5zdHJpbmdpZnkodmFsdWUgWywgcmVwbGFjZXIgWywgc3BhY2VdXSkKCSRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbigpewoJICB2YXIgUyA9ICRTeW1ib2woKTsKCSAgLy8gTVMgRWRnZSBjb252ZXJ0cyBzeW1ib2wgdmFsdWVzIHRvIEpTT04gYXMge30KCSAgLy8gV2ViS2l0IGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyBudWxsCgkgIC8vIFY4IHRocm93cyBvbiBib3hlZCBzeW1ib2xzCgkgIHJldHVybiBfc3RyaW5naWZ5KFtTXSkgIT0gJ1tudWxsXScgfHwgX3N0cmluZ2lmeSh7YTogU30pICE9ICd7fScgfHwgX3N0cmluZ2lmeShPYmplY3QoUykpICE9ICd7fSc7Cgl9KSksICdKU09OJywgewoJICBzdHJpbmdpZnk6IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7CgkgICAgaWYoaXQgPT09IHVuZGVmaW5lZCB8fCBpc1N5bWJvbChpdCkpcmV0dXJuOyAvLyBJRTggcmV0dXJucyBzdHJpbmcgb24gdW5kZWZpbmVkCgkgICAgdmFyIGFyZ3MgPSBbaXRdCgkgICAgICAsIGkgICAgPSAxCgkgICAgICAsIHJlcGxhY2VyLCAkcmVwbGFjZXI7CgkgICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKCSAgICByZXBsYWNlciA9IGFyZ3NbMV07CgkgICAgaWYodHlwZW9mIHJlcGxhY2VyID09ICdmdW5jdGlvbicpJHJlcGxhY2VyID0gcmVwbGFjZXI7CgkgICAgaWYoJHJlcGxhY2VyIHx8ICFpc0FycmF5KHJlcGxhY2VyKSlyZXBsYWNlciA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpewoJICAgICAgaWYoJHJlcGxhY2VyKXZhbHVlID0gJHJlcGxhY2VyLmNhbGwodGhpcywga2V5LCB2YWx1ZSk7CgkgICAgICBpZighaXNTeW1ib2wodmFsdWUpKXJldHVybiB2YWx1ZTsKCSAgICB9OwoJICAgIGFyZ3NbMV0gPSByZXBsYWNlcjsKCSAgICByZXR1cm4gX3N0cmluZ2lmeS5hcHBseSgkSlNPTiwgYXJncyk7CgkgIH0KCX0pOwoKCS8vIDE5LjQuMy40IFN5bWJvbC5wcm90b3R5cGVbQEB0b1ByaW1pdGl2ZV0oaGludCkKCSRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IF9fd2VicGFja19yZXF1aXJlX18oNykoJFN5bWJvbFtQUk9UT1RZUEVdLCBUT19QUklNSVRJVkUsICRTeW1ib2xbUFJPVE9UWVBFXS52YWx1ZU9mKTsKCS8vIDE5LjQuMy41IFN5bWJvbC5wcm90b3R5cGVbQEB0b1N0cmluZ1RhZ10KCXNldFRvU3RyaW5nVGFnKCRTeW1ib2wsICdTeW1ib2wnKTsKCS8vIDIwLjIuMS45IE1hdGhbQEB0b1N0cmluZ1RhZ10KCXNldFRvU3RyaW5nVGFnKE1hdGgsICdNYXRoJywgdHJ1ZSk7CgkvLyAyNC4zLjMgSlNPTltAQHRvU3RyaW5nVGFnXQoJc2V0VG9TdHJpbmdUYWcoZ2xvYmFsLkpTT04sICdKU09OJywgdHJ1ZSk7CgoJLyoqKi8gfSksCgkvKiAxMDcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDQ4KSgnYXN5bmNJdGVyYXRvcicpOwoKCS8qKiovIH0pLAoJLyogMTA4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXyg0OCkoJ29ic2VydmFibGUnKTsKCgkvKioqLyB9KSwKCS8qIDEwOSAqLywKCS8qIDExMCAqLywKCS8qIDExMSAqLywKCS8qIDExMiAqLywKCS8qIDExMyAqLywKCS8qIDExNCAqLywKCS8qIDExNSAqLywKCS8qIDExNiAqLywKCS8qIDExNyAqLywKCS8qIDExOCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKCXZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCgl2YXIgX1Byb3h5T2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjQpOwoKCXZhciBfUHJveHlPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUHJveHlPYmplY3QpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLyoqCgkgKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgRGF0YU9iamVjdCBhZGRDaGlsZHJlbiBjYWxsIG9yIGZyb20gb25BZGRDaGlsZHJlbiBpZiByZW1vdGVseSBjcmVhdGVkLgoJICogQ2hpbGRyZW4gb2JqZWN0IHN5bmNocm9uaXphdGlvbiBpcyBhIGEgZmFzdCBmb3J3YXJkIG1lY2hhbmlzbSwgbm8gbmVlZCBmb3IgZGlyZWN0IHN1YnNjcmlwdGlvbnMsIGl0IHVzZXMgdGhlIGFscmVhZHkgYXV0aG9yaXplZCBzdWJzY3JpcHRpb24gZnJvbSB0aGUgcGFyZW50IERhdGFPYmplY3QuCgkgKi8KCXZhciBEYXRhT2JqZWN0Q2hpbGQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovID0gZnVuY3Rpb24gKCkgewoJICAvKiBwcml2YXRlCgkgICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCgkgIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCgkgICovCgoJICAvKioKCSAgICogQGlnbm9yZQoJICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgRGF0YU9iamVjdC5hZGRDaGlsZHJlbgoJICAgKi8KCSAgZnVuY3Rpb24gRGF0YU9iamVjdENoaWxkKHBhcmVudCwgY2hpbGRJZCwgaW5pdGlhbERhdGEsIG93bmVyLCBtc2dJZCkgewoJICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3RDaGlsZCk7CgoJICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgIF90aGlzLl9wYXJlbnQgPSBwYXJlbnQ7CgkgICAgX3RoaXMuX2NoaWxkSWQgPSBjaGlsZElkOwoJICAgIF90aGlzLl9vd25lciA9IG93bmVyOwoJICAgIF90aGlzLl9tc2dJZCA9IG1zZ0lkOwoKCSAgICBfdGhpcy5fc3luY09iaiA9IG5ldyBfUHJveHlPYmplY3QyLmRlZmF1bHQoaW5pdGlhbERhdGEpOwoKCSAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RDaGlsZCAtICBDb25zdHJ1Y3Rvcl0gLSAnLCBfdGhpcy5fc3luY09iaik7CgoJICAgIF90aGlzLl9idXMgPSBwYXJlbnQuX2J1czsKCSAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKCSAgfQoKCSAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdENoaWxkLCBbewoJICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgLy90aGlzIGlzIG9ubHkgbmVlZGVkIGZvciBjaGlsZHJlbiByZXBvcnRlcnMKCSAgICAgIGlmIChfdGhpcy5fb3duZXIpIHsKCSAgICAgICAgX3RoaXMuX2xpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fb3duZXIsIGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgICAgICBpZiAobXNnLnR5cGUgPT09ICdyZXNwb25zZScgJiYgbXNnLmlkID09PSBfdGhpcy5fbXNnSWQpIHsKCSAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZTonLCBtc2cpOwoJICAgICAgICAgICAgX3RoaXMuX29uUmVzcG9uc2UobXNnKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGlmIChfdGhpcy5fbGlzdGVuZXIpIHsKCSAgICAgICAgX3RoaXMuX2xpc3RlbmVyLnJlbW92ZSgpOwoJICAgICAgfQoJICAgIH0KCgkgICAgLyoqCgkgICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnZGVsZXRlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgZGVsZXRlIF90aGlzLl9wYXJlbnQuX2NoaWxkcmVuW190aGlzLl9jaGlsZElkXTsKCgkgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwoKCSAgICAgIC8vVE9ETzogc2VuZCBkZWxldGUgbWVzc2FnZSA/CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBDaGlsZHJlbiBJRCBnZW5lcmF0ZWQgb24gYWRkQ2hpbGRyZW4uIFVuaXF1ZSBpZGVudGlmaWVyCgkgICAgICogQHR5cGUge1VSTH0gLSBVUkwgb2YgdGhlIGZvcm1hdCA8SHlwZXJ0eVVSTD4jPG51bWVyaWMtc2VxdWVuY2U+CgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25DaGFuZ2UnLAoKCgkgICAgLyoqCgkgICAgICogUmVnaXN0ZXIgdGhlIGNoYW5nZSBsaXN0ZW5lcnMgc2VudCBieSB0aGUgcmVwb3J0ZXIgY2hpbGQKCSAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCgkgICAgICovCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlKGNhbGxiYWNrKSB7CgkgICAgICB0aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdENoaWxkIC0gb2JzZXJ2ZXJdIC0gJywgZXZlbnQpOwoJICAgICAgICBjYWxsYmFjayhldmVudCk7CgkgICAgICB9KTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlc3BvbnNlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIGNyZWF0ZXMKCSAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25SZXNwb25zZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKCSAgICAgIHRoaXMuX29uUmVzcG9uc2VIYW5kbGVyID0gY2FsbGJhY2s7CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IF9vbkNoaWxkQ3JlYXRlCgoJICB9LCB7CgkgICAga2V5OiAnX29uUmVzcG9uc2UnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZXNwb25zZShtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgdmFyIGV2ZW50ID0gewoJICAgICAgICB0eXBlOiBtc2cudHlwZSwKCSAgICAgICAgdXJsOiBtc2cuYm9keS5zb3VyY2UsCgkgICAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGUKCSAgICAgIH07CgoJICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewoJICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ2NoaWxkSWQnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkSWQ7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBEYXRhIFN0cnVjdHVyZSB0byBiZSBzeW5jaHJvbml6ZWQuCgkgICAgICogQHR5cGUge0pTT059IC0gSlNPTiBzdHJ1Y3R1cmUgdGhhdCBzaG91bGQgZm9sbG93IHRoZSBkZWZpbmVkIHNjaGVtYSwgaWYgYW55LgoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ2RhdGEnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX3N5bmNPYmouZGF0YTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFNldCBmb3IgdGhpcyBkYXRhT2JqZWN0Q2hpbGQgYW4gaWRlbnRpdHkKCSAgICAgKiBAbWV0aG9kIGlkZW50aXR5CgkgICAgICogQHBhcmFtICB7SWRlbnRpdHl9IGlkZW50aXR5IGlkZW50aXR5IGZyb20gd2hvIGNyZWF0ZWQgdGhlIG1lc3NhZ2UKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdpZGVudGl0eScsCgkgICAgc2V0OiBmdW5jdGlvbiBzZXQoaWRlbnRpdHkpIHsKCSAgICAgIHRoaXMuX2lkZW50aXR5ID0gaWRlbnRpdHk7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBHZXQgZm9yIHRoaXMgZGF0YU9iamVjdENoaWxkIGFuIGlkZW50aXR5CgkgICAgICogQG1ldGhvZCBpZGVudGl0eQoJICAgICAqIEByZXR1cm4ge0lkZW50aXR5fSBpZGVudGl0eSBmcm9tIHdobyBjcmVhdGVkIHRoZSBtZXNzYWdlCgkgICAgICovCgkgICAgLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX2lkZW50aXR5OwoJICAgIH0KCSAgfV0pOwoJICByZXR1cm4gRGF0YU9iamVjdENoaWxkOwoJfSgpOyAvKioKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoJICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCgkgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCgkgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQoJICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCgkgICAgICoKCSAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgICAgICoKCSAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICAgICAqCgkgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICAgICAqKi8KCglleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0Q2hpbGQ7Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9KSwKCS8qIDExOSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8vICAgICBwcm94eS1vYnNlcnZlIHYwLjAuMTgNCgkvLyAgICAgQ29weXJpZ2h0IChjKSAyMDE1LCAyMDE2IFNpbW9uIFkuIEJsYWNrd2VsbCwgQW55V2hpY2hXYXkNCgkvLyAgICAgTUlUIExpY2Vuc2UgLSBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwDQoJKGZ1bmN0aW9uKCkgew0KCQkidXNlIHN0cmljdCI7DQoJCS8vIENyZWF0ZXMgYW5kIHJldHVybnMgYSBQcm94eSB3cmFwcGluZyBhIHRhcmdldCBzbyB0aGF0IGFsbCBjaGFuZ2VzIGNhbiBiZSB0cmFwcGVkIGFuZCBmb3J3YXJkZWQgdG8NCgkJLy8gYSBjYWxsYmFjay4gVGhlIGNhbGxiYWNrIHRha2VzIGFuIGFycmF5IG9mIGNoYW5nZXMganVzdCBsaWtlIHRoZSB0cmFkaXRpb25hbCBvcmlnaW5hbCBDaHJvbWUgT2JqZWN0Lm9ic2VydmUNCgkJLy8ge29iamVjdDo8b2JqZWN0IGNoYW5nZWQ+LG5hbWU6PGZpZWxkIGNoYW5nZWQ+LHR5cGU6YWRkfHVwZGF0ZXxkZWxldGV8cmVjb25maWd1cmV8cHJldmVudEV4dGVuc2lvbnN8c2V0UHJvdG90eXBlLG9sZFZhbHVlOjxvbGQgdmFsdWUgaWYgdXBkYXRlIHwgZGVsZXRlPn0NCgkJLy8gVGhlIGFjY2VwdGxpc3QgY2FuIGJlIGFkZHx1cGRhdGV8ZGVsZXRlfHJlY29uZmlndXJlfHByZXZlbnRFeHRlbnNpb25zfHNldFByb3RvdHlwZS4NCgkJLy8gdiAwLjAuMTAgdG8gc3VwcG9ydCBwYXVzaW5nIGFuZCByZXN0YXJ0aW5nIG9ic2VydmF0aW9uIHR3byBhZGRpdGlvbmFsIGNvbnN0cnVjdG9yIGFyZ3VtZW50cyBhcmUgYXZhaWxhYmxlIHRvIE9iamVjdC5vYnNlcnZlOg0KCQkvLyBwYXVzYWJsZSAtIGNyZWF0ZSB0aGUgT2JzZXJ2ZXIgc28gaXQgY2FuIGJlIHBhdXNlZA0KCQkvLyBwYXVzZSAtIGNyZWF0ZSBvYnNlcnZlciBpbiBwYXVzZWQgc3RhdGUNCgkJLy8gaWYgcGF1c2FibGUgaXMgdHJ1ZSB0aGVuIGFuIGFkZGl0aW9uYWwgbWV0aG9kIGRlbGl2ZXIoaWdub3JlUHJldmlvdXMpIGlzIGF2YWlsYWJsZSB0byBzdGFydCBkZWxpdmVyeQ0KCQkvLyB0byBwYXVzZSBkZWxpdmVyeSBzZXQgYSBwcm9wZXJ0eSBjYWxsZWQgcGF1c2Ugb24gdGhlIGZ1bmN0aW9uIGRlbGl2ZXIgdG8gdHJ1ZQ0KCQkvLyBwYXVzYWJsZSBpcyBvcHRpb25hbCB0byByZWR1Y2UgdGhlIGNoYW5jZSBvZiBzaGFkb3dpbmcgYSBwcm9wZXJ0eSBvciBtZXRob2Qgb24gYW55IGV4aXN0aW5nIGNvZGUgY2FsbGVkIGRlbGl2ZXINCgkJaWYoIU9iamVjdC5vYnNlcnZlICYmIHR5cGVvZihQcm94eSk9PT0iZnVuY3Rpb24iKSB7DQoJCQlmdW5jdGlvbiBPYnNlcnZlcih0YXJnZXQsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgew0KCQkgICAgCXZhciBtZSA9IHRoaXMsIHByb3h5Ow0KCQkgICAgCWZ1bmN0aW9uIGRlbGl2ZXIoaWdub3JlUHJldmlvdXMsZGVsYXkpIHsNCgkJICAgIAkJZGVsaXZlci5kZWxheSA9IGRlbGF5Ow0KCQkgICAgCQlpZighZGVsaXZlci5wYXVzZSkgew0KCQkgICAgICAgIAkJaWYobWUuY2hhbmdlc2V0Lmxlbmd0aD4wKSB7DQoJCSAgICAgICAgCQkJaWYoIWlnbm9yZVByZXZpb3VzKSB7DQoJCQkgICAgCSAgICAJCXZhciBjaGFuZ2VzID0gbWUuY2hhbmdlc2V0LmZpbHRlcihmdW5jdGlvbihjaGFuZ2UpIHsgcmV0dXJuICFhY2NlcHRsaXN0IHx8IGFjY2VwdGxpc3QuaW5kZXhPZihjaGFuZ2UudHlwZSk+PTA7IH0pOw0KCQkJICAgICAgICAJCQlpZihjaGFuZ2VzLmxlbmd0aD4wKSB7DQoJCQkgICAgICAgIAkJCQljYWxsYmFjayhjaGFuZ2VzKTsNCgkJCSAgICAgICAgCQkJfQ0KCQkgICAgICAgIAkJCX0NCgkJICAgICAgICAJCQltZS5jaGFuZ2VzZXQgPSBbXTsNCgkJICAgICAgICAJCX0NCgkJICAgIAkJfQ0KCQkgICAgCX0NCgkJICAgIAlkZWxpdmVyLnBhdXNlID0gcGF1c2U7DQoJCSAgICAJZGVsaXZlci5kZWxheSA9IGRlbGF5Ow0KCQkJICAgIG1lLmdldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsNCgkJCSAgICAJaWYocHJvcGVydHk9PT0iX19vYnNlcnZlcl9fIikgew0KCQkJICAgIAkJcmV0dXJuIG1lOw0KCQkJICAgIAl9DQoJCQkgICAgCWlmKHByb3BlcnR5PT09InVub2JzZXJ2ZSIpIHsNCgkJCSAgICAJCXJldHVybiBmdW5jdGlvbigpIHsNCgkJCSAgICAJCQlPYmplY3QudW5vYnNlcnZlKHRhcmdldCk7DQoJCQkgICAgCQkJcmV0dXJuIHRhcmdldDsNCgkJCSAgICAJCX07DQoJCQkgICAgCX0NCgkJCSAgICAJaWYocHJvcGVydHk9PT0iZGVsaXZlciIpIHsNCgkJCSAgICAJCXJldHVybiBkZWxpdmVyOw0KCQkJICAgIAl9DQoJCQkgICAgCXJldHVybiB0YXJnZXRbcHJvcGVydHldOw0KCQkJICAgIH0NCgkJICAgIAltZS50YXJnZXQgPSB0YXJnZXQ7DQoJCSAgICAJbWUuY2hhbmdlc2V0ID0gW107DQoJCSAgICAJaWYoIW1lLnRhcmdldC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsNCgkJICAgIAkJLy8gX19vYnNlcnZlckNhbGxiYWNrc19fIGlzIHVzZWQgYXMgYW4gaW5kZXggdG8gZ2V0IGF0IHRoZSBwcm94eSB3aGljaCBpcyB0aGUgb2JzZXJ2ZXIsIHNvIHdlIGNhbiB1bm9ic2VydmUNCgkJICAgIAkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwiX19vYnNlcnZlckNhbGxiYWNrc19fIix7ZW51bWVyYWJsZTpmYWxzZSxjb25maWd1cmFibGU6dHJ1ZSx3cml0YWJsZTpmYWxzZSx2YWx1ZTpbXX0pOw0KCQkgICAgCQlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCJfX29ic2VydmVyc19fIix7ZW51bWVyYWJsZTpmYWxzZSxjb25maWd1cmFibGU6dHJ1ZSx3cml0YWJsZTpmYWxzZSx2YWx1ZTpbXX0pOw0KCQkgICAgCX0NCgkJICAgIAltZS50YXJnZXQuX19vYnNlcnZlckNhbGxiYWNrc19fLnB1c2goY2FsbGJhY2spOw0KCQkgICAgCW1lLnRhcmdldC5fX29ic2VydmVyc19fLnB1c2godGhpcyk7DQoJCSAgICAJcHJveHkgPSBuZXcgUHJveHkodGFyZ2V0LG1lKTsNCgkJICAgIAlkZWxpdmVyKGZhbHNlLGRlbGF5KTsNCgkJICAgIAlyZXR1cm4gcHJveHk7DQoJCSAgICB9DQoJCQlPYnNlcnZlci5wcm90b3R5cGUuZGVsaXZlciA9IGZ1bmN0aW9uKCkgew0KCQkJCXJldHVybiB0aGlzLmdldChudWxsLCJkZWxpdmVyIik7DQoJCQl9DQoJCSAgICBPYnNlcnZlci5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSwgdmFsdWUpIHsgLy8gLCByZWNlaXZlcg0KCQkgICAgCXZhciBvbGR2YWx1ZSA9IHRhcmdldFtwcm9wZXJ0eV07DQoJCSAgICAJdmFyIHR5cGUgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKTsNCgkJICAgIAl0YXJnZXRbcHJvcGVydHldID0gdmFsdWU7DQoJCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAoIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZih0eXBlKT49MCkpIHsNCgkJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZTp0eXBlfSwNCgkJICAgICAgICAJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLA0KCQkgICAgICAgIAkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOw0KCQkgICAgICAgIAlpZih0eXBlPT09InVwZGF0ZSIpIHsNCgkJICAgICAgICAJCWNoYW5nZS5vbGRWYWx1ZSA9IG9sZHZhbHVlOw0KCQkgICAgICAgIAl9DQoJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsNCgkJICAgICAgICAJaWYoc3RhcnQpIHsNCgkJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJCSAgICAgICAgCX0NCgkJICAgIAl9DQoJCSAgICAJcmV0dXJuIHRydWU7DQoJCSAgICB9Ow0KCQkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLmRlbGV0ZVByb3BlcnR5ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSkgew0KCQkgICAgCXZhciBvbGR2YWx1ZSA9IHRhcmdldFtwcm9wZXJ0eV07DQoJCSAgICAJLy9pZih0eXBlb2Yob2xkdmFsdWUpIT09InVuZGVmaW5lZCIpIHsNCgkJCSAgICAJZGVsZXRlIHRhcmdldFtwcm9wZXJ0eV07DQoJCQkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigiZGVsZXRlIik+PTApIHsNCgkJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6ImRlbGV0ZSIsb2xkVmFsdWU6b2xkdmFsdWV9LA0KCQkJICAgICAgICAJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLA0KCQkJICAgICAgICAJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsNCgkJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsNCgkJCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJCQkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkJCSAgICAgICAgCX0NCgkJCSAgICAJfQ0KCQkgICAgCS8vfQ0KCQkgICAgCXJldHVybiB0cnVlOw0KCQkgICAgfTsNCgkJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIGRlc2NyaXB0b3IpIHsNCgkJICAgIAlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcik7DQoJCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJyZWNvbmZpZ3VyZSIpPj0wKSB7DQoJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6InJlY29uZmlndXJlIn0sDQoJICAgICAgICAJCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkgICAgICAgIAkJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsNCgkJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCQkgICAgICAgIAlpZihzdGFydCkgew0KCQkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkJICAgICAgICAJfQ0KCQkgICAgCX0NCgkJICAgIAlyZXR1cm4gdHJ1ZTsNCgkJICAgIH07DQoJCSAgICBPYnNlcnZlci5wcm90b3R5cGUuc2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbih0YXJnZXQsIHByb3RvdHlwZSkgew0KCQkgICAgCXZhciBvbGR2YWx1ZSA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih0YXJnZXQpOw0KCQkgICAgCU9iamVjdC5zZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSk7DQoJCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJzZXRQcm90b3R5cGUiKT49MCkgew0KCQkgICAgICAgIAl2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsbmFtZToiX19wcm90b19fIix0eXBlOiJzZXRQcm90b3R5cGUiLG9sZFZhbHVlOm9sZHZhbHVlfSwNCgkgICAgCQkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLA0KCSAgICAJCQkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOw0KCQkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7DQoJCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOw0KCQkgICAgICAgIAl9DQoJCSAgICAJfQ0KCQkgICAgCXJldHVybiB0cnVlOw0KCQkgICAgfTsNCgkJICAgIE9ic2VydmVyLnByb3RvdHlwZS5wcmV2ZW50RXh0ZW5zaW9ucyA9IGZ1bmN0aW9uKHRhcmdldCkgew0KCQkgICAgICAgIE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh0YXJnZXQpOw0KCQkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigicHJldmVudEV4dGVuc2lvbnMiKT49MCkgew0KCQkgICAgICAgIAl2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsdHlwZToicHJldmVudEV4dGVuc2lvbnMifSwNCgkJCQkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLA0KCQkJCQkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOw0KCQkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7DQoJCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOw0KCQkgICAgICAgIAl9DQoJCSAgICAJfQ0KCQkgICAgCXJldHVybiB0cnVlOw0KCQkgICAgfTsNCgkJICAgIE9iamVjdC5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsNCgkJICAgIAlyZXR1cm4gbmV3IE9ic2VydmVyKG9iamVjdCxjYWxsYmFjayxhY2NlcHRsaXN0LHBhdXNhYmxlLHBhdXNlLGRlbGF5KTsNCgkJICAgIH07DQoJCSAgICBPYmplY3QudW5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrKSB7DQoJCSAgICAJaWYob2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXykgew0KCQkgICAgCQlpZighY2FsbGJhY2spIHsNCgkJICAgIAkJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uc3BsaWNlKDAsb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5sZW5ndGgpOw0KCQkgICAgCQkJb2JqZWN0Ll9fb2JzZXJ2ZXJzX18uc3BsaWNlKDAsb2JqZWN0Ll9fb2JzZXJ2ZXJzX18ubGVuZ3RoKTsNCgkJICAgIAkJCXJldHVybjsNCgkJICAgIAkJfQ0KCQkgICAgCQlvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLmZvckVhY2goZnVuY3Rpb24ob2JzZXJ2ZXJjYWxsYmFjayxpKSB7DQoJCSAgICAJCQlpZihjYWxsYmFjaz09PW9ic2VydmVyY2FsbGJhY2spIHsNCgkJICAgIAkJCQlvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLnNwbGljZShpLDEpOw0KCQkgICAgCQkJCWRlbGV0ZSBvYmplY3QuX19vYnNlcnZlcnNfX1tpXS5jYWxsYmFjazsNCgkJICAgIAkJCQlvYmplY3QuX19vYnNlcnZlcnNfXy5zcGxpY2UoaSwxKTsNCgkJICAgIAkJCX0NCgkJICAgIAkJfSk7DQoJCSAgICAJfQ0KCQkgICAgfTsNCgkJICAgIEFycmF5Lm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgew0KCQkgICAgCWlmKCEob2JqZWN0IGluc3RhbmNlb2YgQXJyYXkpICYmICFBcnJheS5pc0FycmF5KG9iamVjdCkpIHsNCgkJICAgIAkJdGhyb3cgbmV3IFR5cGVFcnJvcigiRmlyc3QgYXJndW1lbnQgdG8gQXJyYXkub2JzZXJ2ZXIgaXMgbm90IGFuIEFycmF5Iik7DQoJCSAgICAJfQ0KCSAgICAgICAgICAgIAlhY2NlcHRsaXN0ID0gYWNjZXB0bGlzdCB8fCBbImFkZCIsICJ1cGRhdGUiLCAiZGVsZXRlIiwgInNwbGljZSJdOw0KCQkgICAgCXZhciBhcnJheXByb3h5ID0gbmV3IFByb3h5KG9iamVjdCx7Z2V0OiBmdW5jdGlvbih0YXJnZXQscHJvcGVydHkpIHsNCgkJICAgIAkJaWYocHJvcGVydHk9PT0idW5vYnNlcnZlIikgew0KCQkJICAgIAkJcmV0dXJuIGZ1bmN0aW9uKGNhbGxiYWNrKSB7DQoJCQkgICAgCQkJaWYoY2FsbGJhY2spIHsNCgkJCSAgICAJCQkJcmV0dXJuIE9iamVjdC51bm9ic2VydmUodGFyZ2V0LGNhbGxiYWNrKTsNCgkJCSAgICAJCQl9DQoJCQkgICAgCQkJcmV0dXJuIHRhcmdldC51bm9ic2VydmUoKTsNCgkJCSAgICAJCX07DQoJCQkgICAgCX0NCgkJICAgIAkJaWYocHJvcGVydHk9PT0ic3BsaWNlIikgew0KCQkgICAgCQkJcmV0dXJuIGZ1bmN0aW9uKHN0YXJ0LGVuZCkgew0KCQkgICAgCQkJCWlmKHR5cGVvZihzdGFydCkhPT0ibnVtYmVyIiB8fCB0eXBlb2YoZW5kKSE9PSJudW1iZXIiKSB7DQoJCSAgICAJCQkJCXRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IHR3byBhcmd1bWVudHMgdG8gQXJyYXkgc3BsaWNlIGFyZSBub3QgbnVtYmVyLCBudW1iZXIiKTsNCgkJICAgIAkJCQl9DQoJCSAgICAJICAgIAkJdmFyIHJlbW92ZWQgPSB0aGlzLnNsaWNlKHN0YXJ0LHN0YXJ0K2VuZCksDQoJCSAgICAJICAgIAkJCWFkZGVkQ291bnQgPSAoYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHMubGVuZ3RoLTIgOiAwKSwNCgkJICAgIAkgICAgCQkJY2hhbmdlID0gIHtvYmplY3Q6b2JqZWN0LHR5cGU6InNwbGljZSIsaW5kZXg6c3RhcnQscmVtb3ZlZDpyZW1vdmVkLGFkZGVkQ291bnQ6YWRkZWRDb3VudH07DQoJCSAgICAJICAgIAkJdGFyZ2V0LnNwbGljZS5hcHBseSh0YXJnZXQsYXJndW1lbnRzKTsNCgkJICAgIAkgICAgCQlpZihhY2NlcHRsaXN0LmluZGV4T2YoInNwbGljZSIpPj0wKSB7DQoJCSAgICAJICAgIAkJCXZhciBzdGFydCA9IHByb3h5Ll9fb2JzZXJ2ZXJfXy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLA0KCQkgICAgCSAgICAgICAgCQkJZGVsaXZlciA9IHByb3h5Ll9fb2JzZXJ2ZXJfXy5kZWxpdmVyKCk7DQoJCSAgICAJICAgIAkJCXByb3h5Ll9fb2JzZXJ2ZXJfXy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCQkgICAgCSAgICAJCQlpZihzdGFydCkgew0KCQkgICAgCQkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkJICAgIAkJICAgICAgICAJfQ0KCQkgICAgCSAgICAJCX0NCgkJICAgIAkgICAgCX0NCgkJICAgIAkJfQ0KCQkgICAgCQlpZihwcm9wZXJ0eT09PSJwdXNoIikgew0KCQkgICAgCQkJIHJldHVybiBmdW5jdGlvbihpdGVtKSB7DQoJCSAgICAJCSAgICAJcmV0dXJuIHRoaXMuc3BsaWNlKHRoaXMubGVuZ3RoLDAsaXRlbSk7DQoJCSAgICAJCSAgICB9DQoJCSAgICAJCX0NCgkJICAgIAkJaWYocHJvcGVydHk9PT0icG9wIikgew0KCQkgICAgCQkJIHJldHVybiBmdW5jdGlvbigpIHsNCgkJICAgIAkJICAgIAlyZXR1cm4gdGhpcy5zcGxpY2UodGhpcy5sZW5ndGgtMSwxKTsNCgkJICAgIAkJICAgIH0NCgkJICAgIAkJfQ0KCQkgICAgCQlpZihwcm9wZXJ0eT09PSJ1bnNoaWZ0Iikgew0KCQkgICAgCQkJIHJldHVybiBmdW5jdGlvbihpdGVtKSB7DQoJICAgIAkJICAgIAkJcmV0dXJuIHRoaXMuc3BsaWNlKDAsMCxpdGVtKTsNCgkgICAgCQkgICAgCX0NCgkJICAgIAkJfQ0KCQkgICAgCQlpZihwcm9wZXJ0eT09PSJzaGlmdCIpIHsNCgkJICAgIAkJCXJldHVybiBmdW5jdGlvbigpIHsNCgkJICAgIAkgICAgCQlyZXR1cm4gdGhpcy5zcGxpY2UoMCwxKTsNCgkJICAgIAkgICAgCX0NCgkJICAgIAkJfQ0KCQkgICAgCQlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsNCgkJICAgIAl9fSk7DQoJCSAgICAJdmFyIHByb3h5ID0gT2JqZWN0Lm9ic2VydmUoYXJyYXlwcm94eSxmdW5jdGlvbihjaGFuZ2VzZXQpIHsgDQoJCSAgICAJCXZhciBjaGFuZ2VzID0gY2hhbmdlc2V0LmZpbHRlcihmdW5jdGlvbihjaGFuZ2UpIHsgcmV0dXJuIGNoYW5nZS5uYW1lIT09Imxlbmd0aCIgJiYgY2hhbmdlLm5hbWUhPT0iYWRkIiAmJiAoIWFjY2VwdGxpc3QgfHwgYWNjZXB0bGlzdC5pbmRleE9mKGNoYW5nZS50eXBlKT49MCk7IH0pOw0KCQkgICAgCQlpZihjaGFuZ2VzLmxlbmd0aD4wKSB7DQoJCSAgICAJCQljYWxsYmFjayhjaGFuZ2VzKTsNCgkJICAgIAkJfQ0KCQkgICAgCX0sYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSk7DQoJCSAgICAJcmV0dXJuIHByb3h5Ow0KCQkgICAgfTsNCgkJICAgIEFycmF5LnVub2JzZXJ2ZSA9IGZ1bmN0aW9uKG9iamVjdCxjYWxsYmFjaykgew0KCQkJICByZXR1cm4gb2JqZWN0LnVub2JzZXJ2ZShjYWxsYmFjayk7DQoJCSAgICB9DQoJCX0NCgkJT2JqZWN0LmRlZXBPYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLHBhcnRzKSB7DQoNCgkJCXBhcnRzID0gKHBhcnRzID8gcGFydHMgOiBbXSk7DQoNCgkJCXZhciB0b1R5cGVOYW1lID0gZnVuY3Rpb24ob2JqKSB7DQoJCQkJcmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvYmopLm1hdGNoKC9ccyhbYS16QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKQ0KCQkJfQ0KDQoJCQlmdW5jdGlvbiByZW9ic2VydmUodmFsdWUsIHBhcnRzKSB7DQoJCQkJdmFyIGtleXMgPSBPYmplY3Qua2V5cyh2YWx1ZSk7DQoJCQkJa2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgew0KCQkJCQlpZigodG9UeXBlTmFtZSh2YWx1ZVtrZXldKSA9PT0gJ29iamVjdCcgfHwgdG9UeXBlTmFtZSh2YWx1ZVtrZXldKSA9PT0gJ2FycmF5JykgJiYgIXZhbHVlW2tleV0uaGFzT3duUHJvcGVydHkoJ19fb2JzZXJ2ZXJzX18nKSkgew0KCQkJCQkJdmFyIG5ld3BhcnRzID0gcGFydHMuc2xpY2UoMCk7DQoJCQkJCQluZXdwYXJ0cy5wdXNoKGtleSk7DQoJCQkJCQl2YWx1ZVtrZXldID0gT2JqZWN0LmRlZXBPYnNlcnZlKHZhbHVlW2tleV0sY2FsbGJhY2ssbmV3cGFydHMpOw0KCQkJCQl9DQoJCQkJfSk7DQoJCQl9DQoNCgkJCXJlb2JzZXJ2ZShvYmplY3QsIHBhcnRzKTsNCg0KCQkJdmFyIG9ic2VydmVkID0gT2JqZWN0Lm9ic2VydmUob2JqZWN0LGZ1bmN0aW9uKGNoYW5nZXNldCkgew0KCQkJCXZhciBjaGFuZ2VzID0gW107DQoJCQkJZnVuY3Rpb24gcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0LG5ld09iamVjdCxwYXRoKSB7DQoJCQkJCWlmKG5ld09iamVjdCBpbnN0YW5jZW9mIE9iamVjdCkgew0KCQkJCQkJdmFyIG5ld2tleXMgPSBPYmplY3Qua2V5cyhuZXdPYmplY3QpOw0KCQkJCQkJbmV3a2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgew0KCQkJCQkJCWlmKCFvbGRPYmplY3QgfHwgKG9sZE9iamVjdFtrZXldIT09bmV3T2JqZWN0W2tleV0pKSB7DQoJCQkJCQkJCXZhciBvbGR2YWx1ZSA9IChvbGRPYmplY3QgJiYgb2xkT2JqZWN0W2tleV0hPT11bmRlZmluZWQgPyBvbGRPYmplY3Rba2V5XSA6IHVuZGVmaW5lZCksDQoJCQkJCQkJCQljaGFuZ2UgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKSwNCgkJCQkJCQkJCWtleXBhdGggPSBwYXRoICsgIi4iICsga2V5Ow0KDQoJCQkJCQkJCWNoYW5nZXMucHVzaCh7bmFtZTpuYW1lLG9iamVjdDpyb290T2JqZWN0LHR5cGU6Y2hhbmdlLG9sZFZhbHVlOm9sZHZhbHVlLG5ld1ZhbHVlOm5ld09iamVjdFtrZXldLGtleXBhdGg6a2V5cGF0aH0pOw0KCQkJCQkJCQlyZWN1cnNlKG5hbWUscm9vdE9iamVjdCxvbGR2YWx1ZSxuZXdPYmplY3Rba2V5XSxrZXlwYXRoKTsNCgkJCQkJCQl9DQoJCQkJCQl9KTsNCgkJCQkJfSBlbHNlIGlmKG9sZE9iamVjdCBpbnN0YW5jZW9mIE9iamVjdCkgew0KCQkJCQkJdmFyIG9sZGtleXMgPSBPYmplY3Qua2V5cyhvbGRPYmplY3QpOw0KCQkJCQkJb2xka2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgew0KCQkJCQkJCXZhciBjaGFuZ2UgPSAobmV3T2JqZWN0PT09bnVsbCA/ICJ1cGRhdGUiIDogImRlbGV0ZSIpLA0KCQkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsNCgkJCQkJCQkJDQoJCQkJCQkJY2hhbmdlcy5wdXNoKHtuYW1lOm5hbWUsb2JqZWN0OnJvb3RPYmplY3QsdHlwZTpjaGFuZ2Usb2xkVmFsdWU6b2xkT2JqZWN0W2tleV0sbmV3VmFsdWU6bmV3T2JqZWN0LGtleXBhdGg6a2V5cGF0aH0pOw0KCQkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZE9iamVjdFtrZXldLHVuZGVmaW5lZCxrZXlwYXRoKTsNCgkJCQkJCX0pOw0KCQkJCQl9DQoJCQkJfQ0KCQkJCWNoYW5nZXNldC5mb3JFYWNoKGZ1bmN0aW9uKGNoYW5nZSkgew0KCQkJCQl2YXIga2V5cGF0aCA9IChwYXJ0cy5sZW5ndGg+MCA/IHBhcnRzLmpvaW4oIi4iKSArICIuIiA6ICIiKSArIGNoYW5nZS5uYW1lOw0KDQoJCQkJCWlmIChjaGFuZ2UudHlwZSA9PT0gInVwZGF0ZSIgfHwgY2hhbmdlLnR5cGUgPT09ICJhZGQiKSB7IA0KCQkJCQkJcmVvYnNlcnZlKGNoYW5nZS5vYmplY3QsIHBhcnRzKTsNCgkJCQkJfQ0KDQoJCQkJCWNoYW5nZXMucHVzaCh7bmFtZTpjaGFuZ2UubmFtZSxvYmplY3Q6Y2hhbmdlLm9iamVjdCx0eXBlOmNoYW5nZS50eXBlLG9sZFZhbHVlOmNoYW5nZS5vbGRWYWx1ZSxuZXdWYWx1ZTpjaGFuZ2Uub2JqZWN0W2NoYW5nZS5uYW1lXSxrZXlwYXRoOmtleXBhdGh9KTsNCgkJCQkJcmVjdXJzZShjaGFuZ2UubmFtZSxjaGFuZ2Uub2JqZWN0LGNoYW5nZS5vbGRWYWx1ZSxjaGFuZ2Uub2JqZWN0W2NoYW5nZS5uYW1lXSxrZXlwYXRoKTsNCgkJCQl9KTsNCgkJCQljYWxsYmFjayhjaGFuZ2VzKTsNCgkJCX0pOw0KCQkJcmV0dXJuIG9ic2VydmVkOw0KCQl9Ow0KCX0pKCk7DQoKCgkvKioqLyB9KSwKCS8qIDEyMCAqLywKCS8qIDEyMSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7CgoJdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKCXZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCgl2YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFByb3RvdHlwZU9mKTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKCXZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7CgoJdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKCXZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KTsKCgl2YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4zID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIpOwoKCXZhciBfZ2V0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTI1KTsKCgl2YXIgX2dldDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXQyKTsKCgl2YXIgX2luaGVyaXRzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpOwoKCXZhciBfaW5oZXJpdHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5oZXJpdHMyKTsKCgl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7CgoJdmFyIF9EYXRhT2JqZWN0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCgl2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKCXZhciBfRGF0YU9iamVjdENoaWxkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTgpOwoKCXZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgl2YXIgRmlsdGVyVHlwZSA9IHsgQU5ZOiAnYW55JywgU1RBUlQ6ICdzdGFydCcsIEVYQUNUOiAnZXhhY3QnIH07CgoJLyoqCgkgKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBzdWJzY3JpYmUgY2FsbC4KCSAqIFRvIGJlIHVzZWQgYXMgYW4gb2JzZXJ2YXRpb24gcG9pbnQgZnJvbSBhIERhdGFPYmplY3RSZXBvcnRlciBjaGFuZ2UuCgkgKi8KCS8qKgoJKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKCSogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKCSogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCgkqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCgkqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoJKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCgkqIENvcHlyaWdodCAyMDE2IEFwaXplZQoJKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoJKgoJKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSoKCSogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSoKCSogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSoqLwoKCXZhciBEYXRhT2JqZWN0T2JzZXJ2ZXIgPSBmdW5jdGlvbiAoX0RhdGFPYmplY3QpIHsKCSAgKDAsIF9pbmhlcml0czMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBfRGF0YU9iamVjdCk7CgoJICAvKiBwcml2YXRlCgkgIF9jaGFuZ2VMaXN0ZW5lcjogTXNnTGlzdGVuZXIKCSAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KCSAgX2ZpbHRlcnM6IHs8ZmlsdGVyPjoge3R5cGU6IDxzdGFydCwgZXhhY3Q+LCBjYWxsYmFjazogPGZ1bmN0aW9uPn0gfQoJICAqLwoKCSAgLyoqCgkgICAqIEBpZ25vcmUKCSAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuc3Vic2NyaWJlIG1ldGhvZAoJICAgKi8KCgkgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKCSAgZnVuY3Rpb24gRGF0YU9iamVjdE9ic2VydmVyKHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zLCBpbml0aWFsVmVyc2lvbiwgbXV0dWFsKSB7CgkgICAgdmFyIHJlc3VtZWQgPSBhcmd1bWVudHMubGVuZ3RoID4gOCAmJiBhcmd1bWVudHNbOF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s4XSA6IGZhbHNlOwoJICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3RPYnNlcnZlcik7CgoJICAgIHZhciBfdGhpczIgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4zLmRlZmF1bHQpKHRoaXMsIChEYXRhT2JqZWN0T2JzZXJ2ZXIuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlcikpLmNhbGwodGhpcywgc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLmRhdGEsIGNoaWxkcmVucywgbXV0dWFsLCByZXN1bWVkKSk7CgoJICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCgkgICAgX3RoaXMuX3ZlcnNpb24gPSBpbml0aWFsVmVyc2lvbjsKCSAgICBfdGhpcy5fZmlsdGVycyA9IHt9OwoKCSAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewoJICAgICAgX3RoaXMuX29uRmlsdGVyKGV2ZW50KTsKCSAgICB9KTsKCgkgICAgdmFyIGNoaWxkSWRTdHJpbmcgPSBfdGhpcy5fb3duZXIgKyAnIycgKyBfdGhpcy5fY2hpbGRJZDsKCgkgICAgLy9zZXR1cCBjaGlsZHJlbnMgZGF0YSBmcm9tIHN1YnNjcmlwdGlvbgoJICAgICgwLCBfa2V5czIuZGVmYXVsdCkoaW5pdGlhbERhdGEuY2hpbGRyZW5zKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZHJlblJlc291cmNlKSB7CgkgICAgICB2YXIgY2hpbGRyZW4gPSBpbml0aWFsRGF0YS5jaGlsZHJlbnNbY2hpbGRyZW5SZXNvdXJjZV07CgkgICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RPYnNlcnZlciAtIG5ldyBEYXRhT2JqZWN0Q2hpbGRdOiAnLCBjaGlsZHJlblJlc291cmNlLCBjaGlsZHJlbiwgX3RoaXMuX3Jlc3VtZWQpOwoJICAgICAgaWYgKF90aGlzLl9yZXN1bWVkKSB7CgoJICAgICAgICAvLyBpZiBpcyByZXN1bWVkCgkgICAgICAgICgwLCBfa2V5czIuZGVmYXVsdCkoY2hpbGRyZW4pLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkSWQpIHsKCSAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIGNoaWxkSWQsIGNoaWxkcmVuW2NoaWxkSWRdLnZhbHVlKTsKCSAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLmlkZW50aXR5ID0gY2hpbGRyZW5bY2hpbGRJZF0uaWRlbnRpdHk7CgoJICAgICAgICAgIGlmIChjaGlsZElkID4gY2hpbGRJZFN0cmluZykgewoJICAgICAgICAgICAgY2hpbGRJZFN0cmluZyA9IGNoaWxkSWQ7CgkgICAgICAgICAgfQoKCSAgICAgICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RPYnNlcnZlciAtIG5ldyBEYXRhT2JqZWN0Q2hpbGRdIC0gcmVzdW1lZDogJywgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSwgY2hpbGRJZCwgY2hpbGRyZW5bY2hpbGRJZF0udmFsdWUpOwoJICAgICAgICB9KTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIC8vIGlmIGlzIG5vdCByZXN1bWVkCgkgICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRyZW5SZXNvdXJjZV0gPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpcywgY2hpbGRyZW5SZXNvdXJjZSwgY2hpbGRyZW4pOwoJICAgICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RPYnNlcnZlciAtIG5ldyBEYXRhT2JqZWN0Q2hpbGRdIC0gbm90IHJlc3VtZWQ6ICcsIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRyZW5SZXNvdXJjZV0pOwoJICAgICAgfQoJICAgIH0pOwoKCSAgICBfdGhpcy5fY2hpbGRJZCA9IE51bWJlcihjaGlsZElkU3RyaW5nLnNwbGl0KCcjJylbMV0pOwoKCSAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKCSAgICByZXR1cm4gX3RoaXMyOwoJICB9CgoJICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIsIFt7CgkgICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewoJICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUpLCAnX2FsbG9jYXRlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsICsgJy9jaGFuZ2VzJywgZnVuY3Rpb24gKG1zZykgewoJICAgICAgICBpZiAobXNnLnR5cGUgPT09ICd1cGRhdGUnKSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwoJICAgICAgICAgIF90aGlzLl9jaGFuZ2VPYmplY3QoX3RoaXMuX3N5bmNPYmosIG1zZyk7CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CgkgICAgICAoMCwgX2dldDMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZSksICdfcmVsZWFzZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lci5yZW1vdmUoKTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ2RlbGV0ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgkgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX29ic2VydmVyc1tfdGhpcy5fdXJsXTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3Vuc3Vic2NyaWJlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uTG9jYWxVblN1YnNjcmliZQoJICAgICAgdmFyIHVuU3Vic2NyaWJlTXNnID0gewoJICAgICAgICB0eXBlOiAndW5zdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAoJICAgICAgICBib2R5OiB7IHJlc291cmNlOiBfdGhpcy5fdXJsIH0KCSAgICAgIH07CgoJICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh1blN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0T2JzZXJ2ZXItVU5TVUJTQ1JJQkU6ICcsIHJlcGx5KTsKCSAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CgkgICAgICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCSAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX29ic2VydmVyc1tfdGhpcy5fdXJsXTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBSZWdpc3RlciB0aGUgY2hhbmdlIGxpc3RlbmVycyBzZW50IGJ5IHRoZSByZXBvcnRlcgoJICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWx0ZXIgLSBGaWx0ZXIgdGhhdCBpZGVudGlmaWVzIHRoZSBmaWVsZCAoc2VwYXJhdGVkIGRvdCBwYXRoKS4gQWNjZXB0cyAqIGF0IHRoZSBlbmQgZm9yIGEgbW9yZSB1bnJlc3RyaWN0ZWQgZmlsdGVyaW5nLgoJICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvbkNoYW5nZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlKGZpbHRlciwgY2FsbGJhY2spIHsKCSAgICAgIHZhciBrZXkgPSBmaWx0ZXI7CgkgICAgICB2YXIgZmlsdGVyT2JqID0gewoJICAgICAgICB0eXBlOiBGaWx0ZXJUeXBlLkVYQUNULAoJICAgICAgICBjYWxsYmFjazogY2FsbGJhY2sKCSAgICAgIH07CgoJICAgICAgdmFyIGlkeCA9IGZpbHRlci5pbmRleE9mKCcqJyk7CgkgICAgICBpZiAoaWR4ID09PSBmaWx0ZXIubGVuZ3RoIC0gMSkgewoJICAgICAgICBpZiAoaWR4ID09PSAwKSB7CgkgICAgICAgICAgZmlsdGVyT2JqLnR5cGUgPSBGaWx0ZXJUeXBlLkFOWTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuU1RBUlQ7CgkgICAgICAgICAga2V5ID0gZmlsdGVyLnN1YnN0cigwLCBmaWx0ZXIubGVuZ3RoIC0gMSk7CgkgICAgICAgIH0KCSAgICAgIH0KCgkgICAgICB0aGlzLl9maWx0ZXJzW2tleV0gPSBmaWx0ZXJPYmo7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX29uRmlsdGVyJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uRmlsdGVyKGV2ZW50KSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgICgwLCBfa2V5czIuZGVmYXVsdCkoX3RoaXMuX2ZpbHRlcnMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewoJICAgICAgICB2YXIgZmlsdGVyID0gX3RoaXMuX2ZpbHRlcnNba2V5XTsKCSAgICAgICAgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLkFOWSkgewoJICAgICAgICAgIC8vbWF0Y2ggYW55dGhpbmcKCSAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwoJICAgICAgICB9IGVsc2UgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLlNUQVJUKSB7CgkgICAgICAgICAgLy9pZiBzdGFydHMgd2l0aCBmaWx0ZXIuLi4KCSAgICAgICAgICBpZiAoZXZlbnQuZmllbGQuaW5kZXhPZihrZXkpID09PSAwKSB7CgkgICAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwoJICAgICAgICAgIH0KCSAgICAgICAgfSBlbHNlIGlmIChmaWx0ZXIudHlwZSA9PT0gRmlsdGVyVHlwZS5FWEFDVCkgewoJICAgICAgICAgIC8vZXhhY3QgbWF0Y2gKCSAgICAgICAgICBpZiAoZXZlbnQuZmllbGQgPT09IGtleSkgewoJICAgICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKCSAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCSAgfV0pOwoJICByZXR1cm4gRGF0YU9iamVjdE9ic2VydmVyOwoJfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3RPYnNlcnZlcjsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0pLAoJLyogMTIyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCgl2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgoJdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKCXZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7CgoJdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgoJdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpOwoKCXZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMik7CgoJdmFyIF9nZXQyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjUpOwoKCXZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKCXZhciBfaW5oZXJpdHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNCk7CgoJdmFyIF9pbmhlcml0czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbmhlcml0czIpOwoKCXZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMyk7CgoJdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCgl2YXIgX0RhdGFPYmplY3RDaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18oMTE4KTsKCgl2YXIgX0RhdGFPYmplY3RDaGlsZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Q2hpbGQpOwoKCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8qKgoJICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgY3JlYXRlIGNhbGwuCgkgKiBUbyBiZSB1c2VkIGFzIGEgcmVwb3J0ZXIgcG9pbnQsIGNoYW5nZXMgd2lsbCBiZSBzdWJtaXRlZCB0byBEYXRhT2JqZWN0T2JzZXJ2ZXIgaW5zdGFuY2VzLgoJICovCgl2YXIgRGF0YU9iamVjdFJlcG9ydGVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CgkgICgwLCBfaW5oZXJpdHMzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlciwgX0RhdGFPYmplY3QpOwoKCSAgLyogcHJpdmF0ZQoJICBfc3Vic2NyaXB0aW9uczogPGh5cGVydHlVcmw6IHsgc3RhdHVzOiBzdHJpbmcgfSB9PgoJICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQoJICBfb25TdWJzY3JpcHRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKCSAgX29uUmVzcG9uc2VIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKCSAgX29uUmVhZEhhbmRsZXI6IChldmVudCkgPT4gdm9pZAoJICAqLwoKCSAgLyoqCgkgICAqIEBpZ25vcmUKCSAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuY3JlYXRlIG1ldGhvZAoJICAgKi8KCSAgZnVuY3Rpb24gRGF0YU9iamVjdFJlcG9ydGVyKHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zLCBtdXR1YWwpIHsKCSAgICB2YXIgcmVzdW1lZCA9IGFyZ3VtZW50cy5sZW5ndGggPiA3ICYmIGFyZ3VtZW50c1s3XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzddIDogZmFsc2U7CgkgICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdFJlcG9ydGVyKTsKCgkgICAgdmFyIF90aGlzMiA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMuZGVmYXVsdCkodGhpcywgKERhdGFPYmplY3RSZXBvcnRlci5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyKSkuY2FsbCh0aGlzLCBzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucywgbXV0dWFsLCByZXN1bWVkKSk7CgoJICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCgkgICAgX3RoaXMuX3N1YnNjcmlwdGlvbnMgPSB7fTsKCgkgICAgX3RoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKCSAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0UmVwb3J0ZXItJyArIHVybCArICctU0VORDogJywgZXZlbnQpOwoJICAgICAgX3RoaXMuX29uQ2hhbmdlKGV2ZW50KTsKCSAgICB9KTsKCgkgICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CgkgICAgcmV0dXJuIF90aGlzMjsKCSAgfQoKCSAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLCBbewoJICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKCSAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9vYmplY3RMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgewoJICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdC0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwoJICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CgkgICAgICAgICAgY2FzZSAncmVzcG9uc2UnOgoJICAgICAgICAgICAgX3RoaXMuX29uUmVzcG9uc2UobXNnKTticmVhazsKCSAgICAgICAgICBjYXNlICdyZWFkJzoKCSAgICAgICAgICAgIF90aGlzLl9vblJlYWQobXNnKTticmVhazsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKCSAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlKSwgJ19yZWxlYXNlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX29iamVjdExpc3RlbmVyLnJlbW92ZSgpOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdyZXN1bWVDaGlsZHJlbnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVDaGlsZHJlbnMoY2hpbGRyZW5zKSB7CgkgICAgICB2YXIgX3RoaXMzID0gdGhpczsKCgkgICAgICB2YXIgY2hpbGRJZFN0cmluZyA9IHRoaXMuX293bmVyICsgJyMnICsgdGhpcy5fY2hpbGRJZDsKCgkgICAgICAvL3NldHVwIGNoaWxkcmVucyBkYXRhIGZyb20gc3Vic2NyaXB0aW9uCgkgICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKGNoaWxkcmVucykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRyZW5SZXNvdXJjZSkgewoJICAgICAgICB2YXIgY2hpbGRyZW4gPSBjaGlsZHJlbnNbY2hpbGRyZW5SZXNvdXJjZV07CgkgICAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdFJlcG9ydGVyIC0gbmV3IERhdGFPYmplY3RDaGlsZF06ICcsIGNoaWxkcmVuUmVzb3VyY2UsIGNoaWxkcmVuLCBfdGhpczMuX3Jlc3VtZWQpOwoKCSAgICAgICAgLy8gaWYgaXMgcmVzdW1lZAoJICAgICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKGNoaWxkcmVuKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CgkgICAgICAgICAgX3RoaXMzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF0gPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpczMsIGNoaWxkSWQsIGNoaWxkcmVuW2NoaWxkSWRdLnZhbHVlKTsKCSAgICAgICAgICBfdGhpczMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXS5pZGVudGl0eSA9IGNoaWxkcmVuW2NoaWxkSWRdLmlkZW50aXR5OwoKCSAgICAgICAgICBpZiAoY2hpbGRJZCA+IGNoaWxkSWRTdHJpbmcpIHsKCSAgICAgICAgICAgIGNoaWxkSWRTdHJpbmcgPSBjaGlsZElkOwoJICAgICAgICAgIH0KCgkgICAgICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0UmVwb3J0ZXIgLSBuZXcgRGF0YU9iamVjdENoaWxkXSAtIHJlc3VtZWQ6ICcsIF90aGlzMy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLCBjaGlsZElkLCBjaGlsZHJlbltjaGlsZElkXS52YWx1ZSk7CgkgICAgICAgIH0pOwoJICAgICAgfSk7CgoJICAgICAgdGhpcy5fY2hpbGRJZCA9IE51bWJlcihjaGlsZElkU3RyaW5nLnNwbGl0KCcjJylbMV0pOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogU2VuZCBpbnZpdGF0aW9ucyAoY3JlYXRlIG1lc3NhZ2VzKSB0byBoeXBlcnRpZXMsIG9ic2VydmVycyBsaXN0LgoJICAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIExpc3Qgb2YgSHlwZXJ0eSBVUkwncwoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ2ludml0ZU9ic2VydmVycycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIGludml0ZU9ic2VydmVycyhvYnNlcnZlcnMpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKCSAgICAgIHZhciBpbnZpdGVNc2cgPSB7CgkgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fc3luY2hlci5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAoJICAgICAgICBib2R5OiB7IHJlc3VtZTogZmFsc2UsIHJlc291cmNlOiBfdGhpcy5fdXJsLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZhbHVlOiBfdGhpcy5fc3luY09iai5kYXRhLCBhdXRob3Jpc2U6IG9ic2VydmVycyB9CgkgICAgICB9OwoKCSAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoaW52aXRlTXNnKTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ2RlbGV0ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uRGVsZXRlCgkgICAgICB2YXIgZGVsZXRlTXNnID0gewoJICAgICAgICB0eXBlOiAnZGVsZXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCwKCSAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CgkgICAgICB9OwoKCSAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoZGVsZXRlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKCSAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1ERUxFVEU6ICcsIHJlcGx5KTsKCSAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CgkgICAgICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCSAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX3JlcG9ydGVyc1tfdGhpcy5fdXJsXTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBTdWJzY3JpcHRpb25zIHJlcXVlc3RlZCBhbmQgYWNjZXB0ZWQgdG8gdGhpcyByZXBvcnRlcgoJICAgICAqIEB0eXBlIHtPYmplY3Q8SHlwZXJ0eVVSTCwgU3luY1N1YnNjcmlwdGlvbj59CgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25TdWJzY3JpcHRpb24nLAoKCgkgICAgLyoqCgkgICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3Mgc3Vic2NyaWJlIGFuZCB1bnN1YnNjcmliZSBub3RpZmljYXRpb25zCgkgICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwoJICAgICAqLwoJICAgIHZhbHVlOiBmdW5jdGlvbiBvblN1YnNjcmlwdGlvbihjYWxsYmFjaykgewoJICAgICAgdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyID0gY2FsbGJhY2s7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZXNwb25zZSBub3RpZmljYXRpb25zIG9mIHRoZSBjcmVhdGUncwoJICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sgZnVuY3Rpb24gdG8gcmVjZWl2ZSBldmVudHMKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvblJlc3BvbnNlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gb25SZXNwb25zZShjYWxsYmFjaykgewoJICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlYWQgbm90aWZpY2F0aW9ucwoJICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvblJlYWQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlYWQoY2FsbGJhY2spIHsKCSAgICAgIHRoaXMuX29uUmVhZEhhbmRsZXIgPSBjYWxsYmFjazsKCSAgICB9CgoJICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHBhcmVudCBTeW5jaGVyIC0+IF9vbkZvcndhcmQKCgkgIH0sIHsKCSAgICBrZXk6ICdfb25Gb3J3YXJkJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uRm9yd2FyZChtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1SQ1Y6ICcsIG1zZyk7CgkgICAgICBzd2l0Y2ggKG1zZy5ib2R5LnR5cGUpIHsKCSAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKCSAgICAgICAgICBfdGhpcy5fb25TdWJzY3JpYmUobXNnKTticmVhazsKCSAgICAgICAgY2FzZSAndW5zdWJzY3JpYmUnOgoJICAgICAgICAgIF90aGlzLl9vblVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7CgkgICAgICB9CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGlzIC0+IF9vbkZvcndhcmQ6IGVtaXR0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBzdWJzY3JpYmUKCgkgIH0sIHsKCSAgICBrZXk6ICdfb25TdWJzY3JpYmUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdWJzY3JpYmUobXNnKSB7CgkgICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoJICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwoJICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0UmVwb3J0ZXIuX29uU3Vic2NyaWJlXScsIG1zZyk7CgoJICAgICAgdmFyIGV2ZW50ID0gewoJICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAoJICAgICAgICB1cmw6IGh5cGVydHlVcmwsCgoJICAgICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHksCgoJICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKCSAgICAgICAgICAvL2NyZWF0ZSBuZXcgc3Vic2NyaXB0aW9uCgkgICAgICAgICAgdmFyIHN1YiA9IHsgdXJsOiBoeXBlcnR5VXJsLCBzdGF0dXM6ICdvbicgfTsKCSAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjsKCgkgICAgICAgICAgLy9wcm9jZXNzIGFuZCBzZW5kIGNoaWxkcmVucyBkYXRhCgkgICAgICAgICAgdmFyIGNoaWxkcmVuVmFsdWVzID0ge307CgkgICAgICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CgkgICAgICAgICAgICB2YXIgY2hpbGREYXRhID0gX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXS5kYXRhOwoJICAgICAgICAgICAgY2hpbGRyZW5WYWx1ZXNbY2hpbGRJZF0gPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoY2hpbGREYXRhKTsKCSAgICAgICAgICB9KTsKCgkgICAgICAgICAgdmFyIHNlbmRNc2cgPSB7CgkgICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKCSAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoX3RoaXMuZGF0YSksIGNoaWxkcmVuczogY2hpbGRyZW5WYWx1ZXMgfSB9CgkgICAgICAgICAgfTsKCgkgICAgICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQoJICAgICAgICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsQXV0aGVudGljYXRpb24nKSAmJiAhbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24pIHsKCSAgICAgICAgICAgIHNlbmRNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IF90aGlzNC5fbXV0dWFsQXV0aGVudGljYXRpb247CgkgICAgICAgICAgICBfdGhpczQuX211dHVhbEF1dGhlbnRpY2F0aW9uID0gbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb247CgkgICAgICAgICAgfQoKCSAgICAgICAgICAvL3NlbmQgb2sgcmVzcG9uc2UgbWVzc2FnZQoJICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoc2VuZE1zZyk7CgoJICAgICAgICAgIHJldHVybiBzdWI7CgkgICAgICAgIH0sCgoJICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsKCSAgICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2UKCSAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKCSAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAoJICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9CgkgICAgICAgICAgfSk7CgkgICAgICAgIH0KCSAgICAgIH07CgoJICAgICAgaWYgKF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIpIHsKCSAgICAgICAgY29uc29sZS5sb2coJ1NVQlNDUklQVElPTi1FVkVOVDogJywgZXZlbnQpOwoJICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKCSAgICAgIH0KCSAgICB9CgoJICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoaXMgLT4gX29uRm9yd2FyZDogZW1pdHRlZCBieSBhIHJlbW90ZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgLT4gdW5zdWJzY3JpYmUKCgkgIH0sIHsKCSAgICBrZXk6ICdfb25VblN1YnNjcmliZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblVuU3Vic2NyaWJlKG1zZykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCSAgICAgIHZhciBoeXBlcnR5VXJsID0gbXNnLmJvZHkuZnJvbTsKCgkgICAgICB2YXIgc3ViID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CgkgICAgICBkZWxldGUgX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CgoJICAgICAgdmFyIGV2ZW50ID0gewoJICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAoJICAgICAgICB1cmw6IGh5cGVydHlVcmwsCgkgICAgICAgIG9iamVjdDogc3ViCgkgICAgICB9OwoKCSAgICAgIGlmIChfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdVTi1TVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKCSAgICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7CgkgICAgICB9CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBSZXBvcnRlclVSTCBhZGRyZXNzOiBlbWl0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBfb25SZW1vdGVDcmVhdGUgLT4gZXZlbnQuYWNrCgoJICB9LCB7CgkgICAga2V5OiAnX29uUmVzcG9uc2UnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZXNwb25zZShtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgdmFyIGV2ZW50ID0gewoJICAgICAgICB0eXBlOiBtc2cudHlwZSwKCSAgICAgICAgdXJsOiBtc2cuZnJvbSwKCSAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyKSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdSRVNQT05TRS1FVkVOVDogJywgZXZlbnQpOwoJICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwoJICAgICAgfQoJICAgIH0KCgkgICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gcmVhZAoKCSAgfSwgewoJICAgIGtleTogJ19vblJlYWQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWFkKG1zZykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICB2YXIgZXZlbnQgPSB7CgkgICAgICAgIHR5cGU6IG1zZy50eXBlLAoJICAgICAgICB1cmw6IG1zZy5mcm9tLAoKCSAgICAgICAgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQoKSB7CgkgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CgkgICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKCSAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCB2YWx1ZTogKDAsIF91dGlscy5kZWVwQ2xvbmUpKF90aGlzLmRhdGEpIH0KCSAgICAgICAgICB9KTsKCSAgICAgICAgfSwKCgkgICAgICAgIHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KHJlYXNvbikgewoJICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewoJICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCgkgICAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwMSwgZGVzYzogcmVhc29uIH0KCSAgICAgICAgICB9KTsKCSAgICAgICAgfQoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX29uUmVhZEhhbmRsZXIpIHsKCSAgICAgICAgY29uc29sZS5sb2coJ1JFQUQtRVZFTlQ6ICcsIGV2ZW50KTsKCSAgICAgICAgX3RoaXMuX29uUmVhZEhhbmRsZXIoZXZlbnQpOwoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ3N1YnNjcmlwdGlvbnMnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmlwdGlvbnM7CgkgICAgfQoJICB9XSk7CgkgIHJldHVybiBEYXRhT2JqZWN0UmVwb3J0ZXI7Cgl9KF9EYXRhT2JqZWN0My5kZWZhdWx0IC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyk7IC8qKgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqLwoKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3RSZXBvcnRlcjsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0pLAoJLyogMTIzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3Byb21pc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcyKTsKCgl2YXIgX3Byb21pc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvbWlzZSk7CgoJdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7CgoJdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7CgoJdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgoJdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTI0KTsKCgl2YXIgX1Byb3h5T2JqZWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1Byb3h5T2JqZWN0KTsKCgl2YXIgX0RhdGFPYmplY3RDaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18oMTE4KTsKCgl2YXIgX0RhdGFPYmplY3RDaGlsZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Q2hpbGQpOwoKCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8qKgoJICogTWFpbiBleHRlbnNpb24gY2xhc3MgZm9yIG9ic2VydmVycyBhbmQgcmVwb3J0ZXJzLCB3aXRoIGNvbW1vbiBwcm9wZXJ0aWVzIGFuZCBtZXRob2RzLgoJICogQ2hpbGRyZW4gbWFuYWdlbWVudCBpcyBjb21tb24gZm9yIG9ic2VydmVycyBhbmQgcmVwb3J0ZXJzLgoJICovCgl2YXIgRGF0YU9iamVjdCA9IGZ1bmN0aW9uICgpIHsKCSAgLyogcHJpdmF0ZQoJICBfdmVyc2lvbjogbnVtYmVyCgkgICBfb3duZXI6IEh5cGVydHlVUkwKCSAgX3VybDogT2JqZWN0VVJMCgkgIF9zY2hlbWE6IFNjaGVtYQoJICBfYnVzOiBNaW5pQnVzCgkgIF9zdGF0dXM6IG9uIHwgcGF1c2VkCgkgIF9zeW5jT2JqOiBTeW5jRGF0YQoJICAgX2NoaWxkcmVuOiB7IGlkOiBEYXRhT2JqZWN0Q2hpbGQgfQoJICBfY2hpbGRyZW5MaXN0ZW5lcnM6IFtNc2dMaXN0ZW5lcl0KCSAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KCSAgX29uQWRkQ2hpbGRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKCSAgKi8KCgkgIC8qKgoJICAgKiBAaWdub3JlCgkgICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyIGNyZWF0ZSBvciBzdWJzY3JpYmUgbWV0aG9kJ3MKCSAgICovCgkgIGZ1bmN0aW9uIERhdGFPYmplY3Qoc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlbnMpIHsKCSAgICB2YXIgbXV0dWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDYgJiYgYXJndW1lbnRzWzZdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNl0gOiB0cnVlOwoJICAgIHZhciByZXN1bWVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDcgJiYgYXJndW1lbnRzWzddICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbN10gOiBmYWxzZTsKCSAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBEYXRhT2JqZWN0KTsKCgkgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgX3RoaXMuX3N5bmNoZXIgPSBzeW5jaGVyOwoJICAgIF90aGlzLl91cmwgPSB1cmw7CgkgICAgX3RoaXMuX3NjaGVtYSA9IHNjaGVtYTsKCSAgICBfdGhpcy5fc3RhdHVzID0gaW5pdGlhbFN0YXR1czsKCSAgICBfdGhpcy5fc3luY09iaiA9IG5ldyBfUHJveHlPYmplY3QyLmRlZmF1bHQoaW5pdGlhbERhdGEpOwoJICAgIF90aGlzLl9jaGlsZHJlbnMgPSBjaGlsZHJlbnM7CgoJICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKCSAgICBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb24gPSBtdXR1YWw7CgoJICAgIF90aGlzLl92ZXJzaW9uID0gMDsKCSAgICBfdGhpcy5fY2hpbGRJZCA9IDA7CgkgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0cyA9IHt9OwoJICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwoKCSAgICBfdGhpcy5fcmVzdW1lZCA9IHJlc3VtZWQ7CgoJICAgIF90aGlzLl9vd25lciA9IHN5bmNoZXIuX293bmVyOwoJICAgIF90aGlzLl9idXMgPSBzeW5jaGVyLl9idXM7CgoJICAgIC8qaWYgKHJlc3VtZWQgJiYgY2hpbGRyZW5zKSB7CgkgICAgICBfdGhpcy5fY2hpbGRJZCA9IF90aGlzLl9nZXRMYXN0Q2hpbGRJZCgpOwoJICAgICAgY29uc29sZS5sb2coJ1tEYXRhIE9iamVjdCByZXN1bWVkXSBsYXN0IENoaWxkSWQ6ICcsIF90aGlzLl9jaGlsZElkKTsKCSAgICB9Ki8KCSAgfQoKCSAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdCwgW3sKCSAgICBrZXk6ICdfZ2V0TGFzdENoaWxkSWQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0TGFzdENoaWxkSWQoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIHZhciBjaGlsZElkSW50ID0gMDsKCSAgICAgIHZhciBjaGlsZElkU3RyaW5nID0gX3RoaXMuX293bmVyICsgJyMnICsgY2hpbGRJZEludDsKCgkgICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKF90aGlzLl9jaGlsZHJlbnMpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7CgkgICAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW5zW2tleV0uY2hpbGRJZCA+IGNoaWxkSWRTdHJpbmcpIHsKCSAgICAgICAgICBjaGlsZElkU3RyaW5nID0gX3RoaXMuX2NoaWxkcmVuc1trZXldLmNoaWxkSWQ7CgkgICAgICAgIH0KCSAgICAgIH0pOwoKCSAgICAgIHJldHVybiBjaGlsZElkSW50ID0gTnVtYmVyKGNoaWxkSWRTdHJpbmcuc3BsaXQoJyMnKVsxXSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewoJICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICB2YXIgY2hpbGRCYXNlVVJMID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJzsKCSAgICAgIGNvbnNvbGUubG9nKCdbRGF0YSBPYmplY3QgLSBBbGxvY2F0ZUxpc3RlbmVyc10gLSAnLCBfdGhpcy5fY2hpbGRyZW5zKTsKCSAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW5zKSB7CgkgICAgICAgIF90aGlzLl9jaGlsZHJlbnMuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHsKCSAgICAgICAgICB2YXIgY2hpbGRVUkwgPSBjaGlsZEJhc2VVUkwgKyBjaGlsZDsKCSAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCBmdW5jdGlvbiAobXNnKSB7CgkgICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCgkgICAgICAgICAgICBpZiAobXNnLmZyb20gIT09IF90aGlzMi5fb3duZXIpIHsKCSAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3QtQ2hpbGRyZW4tUkNWOiAnLCBtc2cpOwoJICAgICAgICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CgkgICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlJzoKCSAgICAgICAgICAgICAgICAgIF90aGlzLl9vbkNoaWxkQ3JlYXRlKG1zZyk7YnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzoKCSAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7YnJlYWs7CgkgICAgICAgICAgICAgICAgZGVmYXVsdDoKCSAgICAgICAgICAgICAgICAgIF90aGlzLl9jaGFuZ2VDaGlsZHJlbihtc2cpO2JyZWFrOwoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfSk7CgoJICAgICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTsKCSAgICAgICAgfSk7CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKGxpc3RlbmVyKSB7CgkgICAgICAgIGxpc3RlbmVyLnJlbW92ZSgpOwoJICAgICAgfSk7CgoJICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKCSAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1trZXldLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgkgICAgICB9KTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIE9iamVjdCBVUkwgb2YgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIKCSAgICAgKiBAdHlwZSB7T2JqZWN0VVJMfQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3BhdXNlJywKCgoJICAgIC8qKgoJICAgICAqIEBpZ25vcmUKCSAgICAgKi8KCSAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2UoKSB7CgkgICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKCSAgICAgIHRocm93ICdOb3QgaW1wbGVtZW50ZWQnOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogQGlnbm9yZQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3Jlc3VtZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZSgpIHsKCSAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQoJICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBAaWdub3JlCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnc3RvcCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3AoKSB7CgkgICAgICAvL1RPRE86IHNob3VsZCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBhbmQgc2VuZCBtZXNzYWdlIHVuc3Vic2NyaWJlPwoJICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBDcmVhdGUgYW5kIGFkZCBhIERhdGFPYmplY3RDaGlsZCB0byBhIGNoaWxkcmVuIGNvbGxlY3Rpb24uCgkgICAgICogQHBhcmFtIHtTdHJpbmd9IGNoaWxkcmVuIC0gQ2hpbGRyZW4gbmFtZSB3aGVyZSB0aGUgY2hpbGQgaXMgYWRkZWQuCgkgICAgICogQHBhcmFtIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgY2hpbGQKCSAgICAgKiBAcGFyYW0gIHtNZXNzYWdlQm9keUlkZW50aXR5fSBpZGVudGl0eSAtIChvcHRpb25hbCkgaWRlbnRpdHkgZGF0YSB0byBiZSBhZGRlZCB0byBpZGVudGl0eSB0aGUgdXNlciByZXBvcnRlci4gVG8gYmUgdXNlZCBmb3IgbGVnYWN5IGlkZW50aXRpZXMuCgkgICAgICogQHJldHVybiB7UHJvbWlzZTxEYXRhT2JqZWN0Q2hpbGQ+fSAtIFJldHVybiBQcm9taXNlIHRvIGEgbmV3IERhdGFPYmplY3RDaGlsZC4KCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdhZGRDaGlsZCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENoaWxkKGNoaWxkcmVuLCBpbml0aWFsRGF0YSwgaWRlbnRpdHkpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgLy9jcmVhdGUgbmV3IGNoaWxkIHVuaXF1ZSBJRCwgYmFzZWQgb24gaHlwZXJ0eVVSTAoJICAgICAgX3RoaXMuX2NoaWxkSWQrKzsKCSAgICAgIHZhciBtc2dDaGlsZElkID0gX3RoaXMuX293bmVyICsgJyMnICsgX3RoaXMuX2NoaWxkSWQ7CgkgICAgICB2YXIgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJyArIGNoaWxkcmVuOwoKCSAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgZGlyZWN0bHkgdG8gYSByZXNvdXJjZSBjaGlsZCBhZGRyZXNzOiBNZXNzYWdlQnVzCgkgICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKCSAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IG1zZ0NoaWxkUGF0aCwKCSAgICAgICAgYm9keTogeyByZXNvdXJjZTogbXNnQ2hpbGRJZCwgdmFsdWU6IGluaXRpYWxEYXRhIH0KCSAgICAgIH07CgoJICAgICAgaWYgKGlkZW50aXR5KSB7CgkgICAgICAgIHJlcXVlc3RNc2cuYm9keS5pZGVudGl0eSA9IGlkZW50aXR5OwoJICAgICAgfQoKCSAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKCSAgICAgIGlmICghX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uKSByZXF1ZXN0TXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb247CgoJICAgICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbAoJICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSkgewoJICAgICAgICB2YXIgbXNnSWQgPSBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2cpOwoKCSAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZS1yZXBvcnRlci1jaGlsZCggJyArIF90aGlzLl9vd25lciArICcgKTogJywgcmVxdWVzdE1zZyk7CgkgICAgICAgIHZhciBuZXdDaGlsZCA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBtc2dDaGlsZElkLCBpbml0aWFsRGF0YSwgX3RoaXMuX293bmVyLCBtc2dJZCk7CgkgICAgICAgIG5ld0NoaWxkLm9uQ2hhbmdlKGZ1bmN0aW9uIChldmVudCkgewoJICAgICAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCwgeyBwYXRoOiBtc2dDaGlsZFBhdGgsIGNoaWxkSWQ6IG1zZ0NoaWxkSWQgfSk7CgkgICAgICAgIH0pOwoKCSAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1ttc2dDaGlsZElkXSA9IG5ld0NoaWxkOwoKCSAgICAgICAgcmVzb2x2ZShuZXdDaGlsZCk7CgkgICAgICB9KTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIG9mIGNoaWxkcmVucy4KCSAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25BZGRDaGlsZCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQWRkQ2hpbGQoY2FsbGJhY2spIHsKCSAgICAgIHRoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyID0gY2FsbGJhY2s7CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IGFkZENoaWxkCgoJICB9LCB7CgkgICAga2V5OiAnX29uQ2hpbGRDcmVhdGUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGlsZENyZWF0ZShtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICB2YXIgbXNnQ2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlOwoKCSAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUtb2JzZXJ2ZXItY2hpbGQoICcgKyBfdGhpcy5fb3duZXIgKyAnICk6ICcsIG1zZyk7CgkgICAgICB2YXIgbmV3Q2hpbGQgPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpcywgbXNnQ2hpbGRJZCwgbXNnLmJvZHkudmFsdWUpOwoJICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1ttc2dDaGlsZElkXSA9IG5ld0NoaWxkOwoKCSAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewoJICAgICAgICAvL0ZMT1ctT1VUOiB3aWxsIGZsb3cgdG8gRGF0YU9iamVjdENoaWxkIC0+IF9vblJlc3BvbnNlCgkgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewoJICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAoJICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzb3VyY2U6IF90aGlzLl9vd25lciB9CgkgICAgICAgIH0pOwoJICAgICAgfSk7CgoJICAgICAgdmFyIGV2ZW50ID0gewoJICAgICAgICB0eXBlOiBtc2cudHlwZSwKCSAgICAgICAgZnJvbTogbXNnLmZyb20sCgkgICAgICAgIHVybDogbXNnLnRvLAoJICAgICAgICB2YWx1ZTogbXNnLmJvZHkudmFsdWUsCgkgICAgICAgIGNoaWxkSWQ6IG1zZ0NoaWxkSWQsCgkgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eQoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdBREQtQ0hJTERSRU4tRVZFTlQ6ICcsIGV2ZW50KTsKCSAgICAgICAgX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKGV2ZW50KTsKCSAgICAgIH0KCSAgICB9CgoJICAgIC8vc2VuZCBkZWx0YSBtZXNzYWdlcyB0byBzdWJzY3JpcHRpb25zCgoJICB9LCB7CgkgICAga2V5OiAnX29uQ2hhbmdlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uQ2hhbmdlKGV2ZW50LCBjaGlsZEluZm8pIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKCgkgICAgICBpZiAoX3RoaXMuX3N0YXR1cyA9PT0gJ29uJykgewoJICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIGEgcmVzb3VyY2UgY2hhbmdlcyBhZGRyZXNzOiBNZXNzYWdlQnVzCgkgICAgICAgIHZhciBjaGFuZ2VNc2cgPSB7CgkgICAgICAgICAgdHlwZTogJ3VwZGF0ZScsIGZyb206IF90aGlzLl91cmwsIHRvOiBfdGhpcy5fdXJsICsgJy9jaGFuZ2VzJywKCSAgICAgICAgICBib2R5OiB7IHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCBzb3VyY2U6IF90aGlzLl9vd25lciwgYXR0cmlidXRlOiBldmVudC5maWVsZCB9CgkgICAgICAgIH07CgoJICAgICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3QgLSBfb25DaGFuZ2VdIC0gJywgZXZlbnQsIGNoaWxkSW5mbywgY2hhbmdlTXNnKTsKCgkgICAgICAgIGlmIChldmVudC5vVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuT0JKRUNUKSB7CgkgICAgICAgICAgaWYgKGV2ZW50LmNUeXBlICE9PSBfUHJveHlPYmplY3QuQ2hhbmdlVHlwZS5SRU1PVkUpIHsKCSAgICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKCSAgICAgICAgICB9CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgY2hhbmdlTXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9IGV2ZW50Lm9UeXBlOwoJICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKCSAgICAgICAgICBpZiAoZXZlbnQuY1R5cGUgIT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlVQREFURSkgewoJICAgICAgICAgICAgY2hhbmdlTXNnLmJvZHkub3BlcmF0aW9uID0gZXZlbnQuY1R5cGU7CgkgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgICAvL2NoaWxkSW5mbyBtdXN0IGhhdmUgKHBhdGgsIGNoaWxkSWQpCgkgICAgICAgIGlmIChjaGlsZEluZm8pIHsKCSAgICAgICAgICBjaGFuZ2VNc2cudG8gPSBjaGlsZEluZm8ucGF0aDsKCSAgICAgICAgICBjaGFuZ2VNc2cuYm9keS5yZXNvdXJjZSA9IGNoaWxkSW5mby5jaGlsZElkOwoJICAgICAgICB9CgoJICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CgkgICAgICAgIGlmICghX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uKSBjaGFuZ2VNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbjsKCgkgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoY2hhbmdlTXNnKTsKCSAgICAgIH0KCSAgICB9CgoJICAgIC8vRkxPVy1JTjogZGVsdGEgbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RSZXBvcnRlciBvciBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgoJICB9LCB7CgkgICAga2V5OiAnX2NoYW5nZU9iamVjdCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VPYmplY3Qoc3luY09iaiwgbXNnKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIC8vVE9ETzogdXBkYXRlIHZlcnNpb24gPwoJICAgICAgLy9ob3cgdG8gaGFuZGxlIGFuIGluY29ycmVjdCB2ZXJzaW9uID8gRXhhbXBsZTogcmVjZWl2ZSBhIHZlcnNpb24gMyB3aGVuIHRoZSBvYnNlcnZlciBpcyBpbiB2ZXJzaW9uIDEsIHdoZXJlIGlzIHRoZSB2ZXJzaW9uIDIgPwoJICAgICAgLy93aWxsIHdlIG5lZWQgdG8gY29uZmlybSB0aGUgcmVjZXB0aW9uID8KCSAgICAgIGlmIChfdGhpcy5fdmVyc2lvbiArIDEgPT09IG1zZy5ib2R5LnZlcnNpb24pIHsKCSAgICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKCSAgICAgICAgdmFyIHBhdGggPSBtc2cuYm9keS5hdHRyaWJ1dGU7CgkgICAgICAgIHZhciB2YWx1ZSA9ICgwLCBfdXRpbHMuZGVlcENsb25lKShtc2cuYm9keS52YWx1ZSk7CgkgICAgICAgIHZhciBmaW5kUmVzdWx0ID0gc3luY09iai5maW5kQmVmb3JlKHBhdGgpOwoKCSAgICAgICAgaWYgKG1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPT09IF9Qcm94eU9iamVjdC5PYmplY3RUeXBlLkFSUkFZKSB7CgkgICAgICAgICAgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuQUREKSB7CgkgICAgICAgICAgICB2YXIgYXJyID0gZmluZFJlc3VsdC5vYmo7CgkgICAgICAgICAgICB2YXIgaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CgkgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuc3BsaWNlLmFwcGx5KGFyciwgW2luZGV4LCAwXS5jb25jYXQodmFsdWUpKTsKCSAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CgkgICAgICAgICAgICB2YXIgX2FyciA9IGZpbmRSZXN1bHQub2JqOwoJICAgICAgICAgICAgdmFyIF9pbmRleCA9IGZpbmRSZXN1bHQubGFzdDsKCSAgICAgICAgICAgIF9hcnIuc3BsaWNlKF9pbmRleCwgdmFsdWUpOwoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdID0gdmFsdWU7IC8vIFVQREFURQoJICAgICAgICAgIH0KCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICBpZiAobXNnLmJvZHkudmFsdWUpIHsKCSAgICAgICAgICAgIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF0gPSB2YWx1ZTsgLy8gVVBEQVRFIG9yIEFERAoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBkZWxldGUgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XTsgLy8gUkVNT1ZFCgkgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICB9IGVsc2UgewoJICAgICAgICAvL1RPRE86IGhvdyB0byBoYW5kbGUgdW5zeW5jaHJvbml6ZWQgdmVyc2lvbnM/CgkgICAgICAgIGNvbnNvbGUubG9nKCdVTlNZTkNIUk9OSVpFRCBWRVJTSU9OOiAoZGF0YSA9PiAnICsgX3RoaXMuX3ZlcnNpb24gKyAnLCBtc2cgPT4gJyArIG1zZy5ib2R5LnZlcnNpb24gKyAnKScpOwoJICAgICAgfQoJICAgIH0KCgkgICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdENoaWxkIHdoZW4gY2hhbmdpbmcgZGF0YQoKCSAgfSwgewoJICAgIGtleTogJ19jaGFuZ2VDaGlsZHJlbicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VDaGlsZHJlbihtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICBjb25zb2xlLmxvZygnQ2hhbmdlIGNoaWxkcmVuOiAnLCBfdGhpcy5fb3duZXIsIG1zZyk7CgoJICAgICAgdmFyIGNoaWxkSWQgPSBtc2cuYm9keS5yZXNvdXJjZTsKCSAgICAgIHZhciBjaGlsZHJlbiA9IF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF07CgoJICAgICAgaWYgKGNoaWxkcmVuKSB7CgkgICAgICAgIF90aGlzLl9jaGFuZ2VPYmplY3QoY2hpbGRyZW4uX3N5bmNPYmosIG1zZyk7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBjb25zb2xlLmxvZygnTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAnLCBjaGlsZElkKTsKCSAgICAgIH0KCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICd1cmwnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX3VybDsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIE9iamVjdCBzY2hlbWEgVVJMICh0aGlzIGZpZWxkIGlzIG5vdCB5ZXQgc3RhYmxlLCBhbmQgaXMgc3Vic2plY3QgdG8gY2hhbmdlKQoJICAgICAqIEB0eXBlIHtTY2hlbWFVUkx9CgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnc2NoZW1hJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9zY2hlbWE7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBTdGF0dXMgb2YgdGhlIHJlcG9ydGVyIG9yIG9ic2VydmVyIGNvbm5lY3Rpb24gKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpCgkgICAgICogQHR5cGUge1N0YXR1c30gLSBFbnVtIG9mOiBvbiB8IHBhdXNlZAoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3N0YXR1cycsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fc3RhdHVzOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogRGF0YSBzdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLgoJICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdkYXRhJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBBbGwgY3JlYXRlZCBjaGlsZHJlbidzIHNpbmNlIHRoZSBzdWJzY3JpcHRpb24sIGRvZXNuJ3QgY29udGFpbiBhbGwgY2hpbGRyZW4ncyBzaW5jZSByZXBvcnRlciBjcmVhdGlvbi4KCSAgICAgKiBAdHlwZSB7T2JqZWN0PENoaWxkSWQsIERhdGFPYmplY3RDaGlsZD59CgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnY2hpbGRyZW5zJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7CgkgICAgfQoJICB9XSk7CgkgIHJldHVybiBEYXRhT2JqZWN0OwoJfSgpOyAvKioKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoJICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCgkgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCgkgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQoJICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCgkgICAgICoKCSAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgICAgICoKCSAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICAgICAqCgkgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICAgICAqKi8KCglleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSksCgkvKiAxMjQgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5PYmplY3RUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0gdW5kZWZpbmVkOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7CgoJdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygxMTkpOwoKCXZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCXZhciBvYmplY3RUeXBlID0geyBBUlJBWTogJ1tvYmplY3QgQXJyYXldJywgT0JKRUNUOiAnW29iamVjdCBPYmplY3RdJyB9OwoKCS8qKgoJICogQGFjY2VzcyBwcml2YXRlCgkgKiBNYWluIGNsYXNzIHRoYXQgbWFpbnRhaW5zIGEgSlNPTiBvYmplY3QsIGFuZCBvYnNlcnZlcyBjaGFuZ2VzIGluIHRoaXMgb2JqZWN0LCByZWN1cnNpdmVseS4KCSAqIEludGVybmFsIG9iamVjdHMgYW5kIGFycmF5cyBhcmUgYWxzbyBvYnNlcnZlZC4KCSAqLwoKCXZhciBTeW5jT2JqZWN0ID0gZnVuY3Rpb24gKCkgewoJICBmdW5jdGlvbiBTeW5jT2JqZWN0KGluaXRpYWxEYXRhKSB7CgkgICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgU3luY09iamVjdCk7CgoJICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgIF90aGlzLl9vYnNlcnZlcnMgPSBbXTsKCSAgICBfdGhpcy5fZmlsdGVycyA9IHt9OwoKCSAgICB0aGlzLl9kYXRhID0gaW5pdGlhbERhdGEgfHwge307CgoJICAgIHRoaXMuX2ludGVybmFsT2JzZXJ2ZSh0aGlzLl9kYXRhKTsKCSAgfQoKCSAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoU3luY09iamVjdCwgW3sKCSAgICBrZXk6ICdvYnNlcnZlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gb2JzZXJ2ZShjYWxsYmFjaykgewoJICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnB1c2goY2FsbGJhY2spOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ2ZpbmQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kKHBhdGgpIHsKCSAgICAgIHZhciBsaXN0ID0gKDAsIF91dGlscy5wYXJzZUF0dHJpYnV0ZXMpKHBhdGgpOwoKCSAgICAgIHJldHVybiB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ2ZpbmRCZWZvcmUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kQmVmb3JlKHBhdGgpIHsKCSAgICAgIHZhciByZXN1bHQgPSB7fTsKCSAgICAgIHZhciBsaXN0ID0gKDAsIF91dGlscy5wYXJzZUF0dHJpYnV0ZXMpKHBhdGgpOwoJICAgICAgcmVzdWx0Lmxhc3QgPSBsaXN0LnBvcCgpOwoJICAgICAgcmVzdWx0Lm9iaiA9IHRoaXMuX2ZpbmRXaXRoU3BsaXQobGlzdCk7CgoJICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfZmluZFdpdGhTcGxpdCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9maW5kV2l0aFNwbGl0KGxpc3QpIHsKCSAgICAgIHZhciBvYmogPSB0aGlzLl9kYXRhOwoJICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewoJICAgICAgICBvYmogPSBvYmpbdmFsdWVdOwoJICAgICAgfSk7CgoJICAgICAgcmV0dXJuIG9iajsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfaW50ZXJuYWxPYnNlcnZlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsT2JzZXJ2ZShvYmplY3QpIHsKCSAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKCSAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24gaGFuZGxlcihjaGFuZ2VzZXQpIHsKCgkgICAgICAgIGNoYW5nZXNldC5ldmVyeShmdW5jdGlvbiAoY2hhbmdlKSB7CgkgICAgICAgICAgX3RoaXMyLl9vbkNoYW5nZXMoY2hhbmdlKTsKCSAgICAgICAgfSk7CgkgICAgICB9OwoKCSAgICAgIHRoaXMuX2RhdGEgPSBPYmplY3QuZGVlcE9ic2VydmUob2JqZWN0LCBoYW5kbGVyKTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfZmlyZUV2ZW50JywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpcmVFdmVudChldmVudCkgewoJICAgICAgdGhpcy5fb2JzZXJ2ZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7CgkgICAgICAgIGNhbGxiYWNrKGV2ZW50KTsKCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19vbkNoYW5nZXMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2VzKGNoYW5nZSkgewoKCSAgICAgIHZhciBvYmogPSBjaGFuZ2Uub2JqZWN0OwoJICAgICAgdmFyIG9ialR5cGUgPSB2b2lkIDA7CgoJICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CgkgICAgICAgIG9ialR5cGUgPSBPYmplY3RUeXBlLk9CSkVDVDsKCSAgICAgIH0KCgkgICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewoJICAgICAgICBvYmpUeXBlID0gT2JqZWN0VHlwZS5BUlJBWTsKCSAgICAgIH0KCgkgICAgICB2YXIgZmllbGRTdHJpbmcgPSBjaGFuZ2Uua2V5cGF0aDsKCgkgICAgICAvLyBjb25zb2xlLmxvZygnRmllbGQ6JywgZmllbGRTdHJpbmcpOwoJICAgICAgLy8gY29uc29sZS5sb2coJ3R5cGU6JywgY2hhbmdlLnR5cGUpOwoKCSAgICAgIC8vbGV0IG9sZFZhbHVlID0gY2hhbmdlLm9sZFZhbHVlOwoJICAgICAgdmFyIG5ld1ZhbHVlID0gb2JqW2NoYW5nZS5uYW1lXTsKCgkgICAgICAvLyBjb25zb2xlLmluZm8oY2hhbmdlLnR5cGUgKyAnIHwgRmllbGQ6ICcgKyBmaWVsZFN0cmluZyArICcgfCBOZXcgVmFsdWU6JywgSlNPTi5zdHJpbmdpZnkobmV3VmFsdWUpLCBmaWVsZFN0cmluZy5pbmNsdWRlcygnbGVuZ3RoJykpOwoKCSAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ3VwZGF0ZScgJiYgIWZpZWxkU3RyaW5nLmluY2x1ZGVzKCcubGVuZ3RoJykpIHsKCSAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKCSAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5VUERBVEUsCgkgICAgICAgICAgb1R5cGU6IG9ialR5cGUsCgkgICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nLAoJICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlCgkgICAgICAgIH0pOwoJICAgICAgfQoKCSAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2FkZCcpIHsKCSAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKCSAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5BREQsCgkgICAgICAgICAgb1R5cGU6IG9ialR5cGUsCgkgICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nLAoJICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlCgkgICAgICAgIH0pOwoJICAgICAgfQoKCSAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2RlbGV0ZScpIHsKCSAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKCSAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5SRU1PVkUsCgkgICAgICAgICAgb1R5cGU6IG9ialR5cGUsCgkgICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nCgkgICAgICAgIH0pOwoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ2RhdGEnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7CgkgICAgfQoJICB9XSk7CgkgIHJldHVybiBTeW5jT2JqZWN0OwoJfSgpOwoKCXZhciBDaGFuZ2VUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0geyBVUERBVEU6ICd1cGRhdGUnLCBBREQ6ICdhZGQnLCBSRU1PVkU6ICdyZW1vdmUnIH07Cgl2YXIgT2JqZWN0VHlwZSA9IGV4cG9ydHMuT2JqZWN0VHlwZSA9IHsgT0JKRUNUOiAnb2JqZWN0JywgQVJSQVk6ICdhcnJheScgfTsKCWV4cG9ydHMuZGVmYXVsdCA9IFN5bmNPYmplY3Q7CgoJLyoqKi8gfSksCgkvKiAxMjUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKCXZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKCXZhciBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTMpOwoKCXZhciBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldE93blByb3BlcnR5RGVzY3JpcHRvcik7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsKCSAgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOwoJICB2YXIgZGVzYyA9ICgwLCBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMi5kZWZhdWx0KShvYmplY3QsIHByb3BlcnR5KTsKCgkgIGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsKCSAgICB2YXIgcGFyZW50ID0gKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkob2JqZWN0KTsKCgkgICAgaWYgKHBhcmVudCA9PT0gbnVsbCkgewoJICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKCSAgICB9IGVsc2UgewoJICAgICAgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7CgkgICAgfQoJICB9IGVsc2UgaWYgKCJ2YWx1ZSIgaW4gZGVzYykgewoJICAgIHJldHVybiBkZXNjLnZhbHVlOwoJICB9IGVsc2UgewoJICAgIHZhciBnZXR0ZXIgPSBkZXNjLmdldDsKCgkgICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7CgkgICAgICByZXR1cm4gdW5kZWZpbmVkOwoJICAgIH0KCgkgICAgcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsKCSAgfQoJfTsKCgkvKioqLyB9KSwKCS8qIDEyNiAqLywKCS8qIDEyNyAqLywKCS8qIDEyOCAqLywKCS8qIDEyOSAqLywKCS8qIDEzMCAqLywKCS8qIDEzMSAqLywKCS8qIDEzMiAqLywKCS8qIDEzMyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9wcm9taXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3Mik7CgoJdmFyIF9wcm9taXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Byb21pc2UpOwoKCXZhciBfYXNzaWduID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTEpOwoKCXZhciBfYXNzaWduMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Fzc2lnbik7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKCXZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCgl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7CgoJdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMik7CgoJdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdFJlcG9ydGVyKTsKCgl2YXIgX0RhdGFPYmplY3RPYnNlcnZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCgl2YXIgX0RhdGFPYmplY3RPYnNlcnZlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKCXZhciBfRGF0YVByb3Zpc2lvbmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDgpOwoKCXZhciBfRGF0YVByb3Zpc2lvbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFQcm92aXNpb25hbCk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvKioKCSogVGhlIG1haW4gY2xhc3MgZm9yIHRoZSBzeW5jaGVyIHBhY2thZ2UuCgkqIFRoZSBTeW5jaGVyIGlzIGEgc2luZ2xldG9uIGNsYXNzIHBlciBIeXBlcnR5L1VSTCBhbmQgaXQgaXMgdGhlIG93bmVyIG9mIGFsbCBjcmVhdGVkIERhdGEgU3luYyBPYmplY3RzIGFjY29yZGluZyB0byB0aGUgUmVwb3J0ZXIgLSBPYnNlcnZlciBwYXR0ZXJuLgoJKiBNYWluIGZ1bmN0aW9uYWxpdHkgaXMgdG8gY3JlYXRlIHJlcG9ydGVycyBhbmQgdG8gc3Vic2NyaWJlIHRvIGV4aXN0aW5nIG9uZXMuCgkqLwoJLyoqCgkqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoJKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoJKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKCSogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKCSogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCgkqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKCSogQ29weXJpZ2h0IDIwMTYgQXBpemVlCgkqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCgkqCgkqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJKgoJKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJKgoJKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJKiovCgl2YXIgU3luY2hlciA9IGZ1bmN0aW9uICgpIHsKCSAgLyogcHJpdmF0ZQoJICBfb3duZXI6IFVSTAoJICBfYnVzOiBNaW5pQnVzCgkgICBfc3ViVVJMOiBVUkwKCSAgIF9yZXBvcnRlcnM6IDx1cmw6IERhdGFPYmplY3RSZXBvcnRlcj4KCSAgX29ic2VydmVyczogPHVybDogRGF0YU9iamVjdE9ic2VydmVyPgoJICBfcHJvdmlzaW9uYWxzOiA8dXJsOiBEYXRhUHJvdmlzaW9uYWw+CgkgICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCgkgIF9vbk5vdGlmaWNhdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAoJICBfb25SZXN1bWU6IChldmVudCkgPT4gdm9pZAoJICAqLwoKCSAgLyoqCgkgICogQ29uc3RydWN0b3IgdGhhdCBzaG91bGQgYmUgdXNlZCBieSB0aGUgSHlwZXJ0eSBvd25lcgoJICAqIEBwYXJhbSB7SHlwZXJ0eVVSTH0gb3duZXIgLSBIeXBlcnR5IFVSTCBvd25lci4gQW4gVVJMIGFsbG9jYXRlZCBieSB0aGUgcnVudGltZSB0aGF0IHVuaXF1ZWx5IGlkZW50aWZpZXMgdGhlIEh5cGVydHkuCgkgICogQHBhcmFtIHtNaW5pQnVzfSBidXMgLSBBbiBpbnN0YW5jZSBvZiB0aGUgTWluaUJ1cyBwcm92aWRlZCBpbiB0aGUgc2FuZGJveC4gV2hlbiBhbiBvYmplY3QgKFJlcG9ydGVyIG9yIE9ic2VydmVkKSBpcyBjcmVhdGVkLCB0aGUgU3luY2hlck1hbmFnZXIgd2lsbCBhZGQgYSBsaXN0ZW5lciBpbiB0aGUgTWluaUJ1cyB0byByZWNlaXZlL3NlbmQgTWVzc2FnZXMgb2YgdGhhdCBvYmplY3QuCgkgICogQHBhcmFtIHtKU09OfSBjb25maWcgLSBDb25maWd1cmF0aW9uIGRhdGEuIFRoZSBvbmx5IHJlcXVpcmVkIGZpZWxkIGZvciBub3cgaXMgdGhlIHJ1bnRpbWVVUkwuCgkgICovCgkgIGZ1bmN0aW9uIFN5bmNoZXIob3duZXIsIGJ1cywgY29uZmlnKSB7CgkgICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgU3luY2hlcik7CgoJICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgIF90aGlzLl9vd25lciA9IG93bmVyOwoJICAgIF90aGlzLl9idXMgPSBidXM7CgoJICAgIF90aGlzLl9zdWJVUkwgPSBjb25maWcucnVudGltZVVSTCArICcvc20nOwoKCSAgICBfdGhpcy5fcmVwb3J0ZXJzID0ge307CgkgICAgX3RoaXMuX29ic2VydmVycyA9IHt9OwoJICAgIF90aGlzLl9wcm92aXNpb25hbHMgPSB7fTsKCgkgICAgYnVzLmFkZExpc3RlbmVyKG93bmVyLCBmdW5jdGlvbiAobXNnKSB7CgkgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCgkgICAgICBpZiAobXNnLmZyb20gIT09IG93bmVyKSB7CgkgICAgICAgIGNvbnNvbGUuaW5mbygnW1N5bmNoZXJdIFN5bmNoZXItUkNWOiAnLCBtc2csIF90aGlzKTsKCSAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewoJICAgICAgICAgIGNhc2UgJ2ZvcndhcmQnOgoJICAgICAgICAgICAgX3RoaXMuX29uRm9yd2FyZChtc2cpO2JyZWFrOwoJICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6CgkgICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVDcmVhdGUobXNnKTticmVhazsKCSAgICAgICAgICBjYXNlICdkZWxldGUnOgoJICAgICAgICAgICAgX3RoaXMuX29uUmVtb3RlRGVsZXRlKG1zZyk7YnJlYWs7CgkgICAgICAgIH0KCSAgICAgIH0KCSAgICB9KTsKCSAgfQoKCSAgLyoqCgkgICogVGhlIG93bmVyIG9mIHRoZSBTeW5jaGVyIGFuZCBhbGwgY3JlYXRlZCByZXBvcnRlcnMuCgkgICogQHR5cGUge0h5cGVydHlVUkx9CgkgICovCgoKCSAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoU3luY2hlciwgW3sKCSAgICBrZXk6ICdjcmVhdGUnLAoKCgkgICAgLyoqCgkgICAgKiBSZXF1ZXN0IGEgRGF0YU9iamVjdFJlcG9ydGVyIGNyZWF0aW9uLiBUaGUgVVJMIHdpbGwgYmUgYmUgcmVxdWVzdGVkIGJ5IHRoZSBhbGxvY2F0aW9uIG1lY2hhbmlzbS4KCSAgICAqIEBwYXJhbSAge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hCgkgICAgKiBAcGFyYW0gIHtIeXBlcnR5VVJMW119IG9ic2VydmVycyAtIExpc3Qgb2YgaHlwZXJ0aWVzIHRoYXQgYXJlIHByZS1hdXRob3JpemVkIGZvciBzdWJzY3JpcHRpb24KCSAgICAqIEBwYXJhbSAge0pTT059IGluaXRpYWxEYXRhIC0gSW5pdGlhbCBkYXRhIG9mIHRoZSByZXBvcnRlcgoJICAgICogQHBhcmFtICB7Ym9vbGVhbn0gc3RvcmUgLSAoT3B0aW9uYWwpIGlmIHRydWUsIG9iamVjdCB3aWxsIGJlIHN0b3JlZCBieSB0aGUgcnVudGltZQoJICAgICogQHBhcmFtICB7Ym9vbGVhbn0gcDJwIC0gKE9wdGlvbmFsKSBpZiB0cnVlLCBkYXRhIHN5bmNocm9uaXNhdGlvbiBzdHJlYW0gd2lsbCB1c2UgcDJwIGNvbm5lY3Rpb24gYXMgbXVjaCBhcyBwb3NzaWJsZQoJICAgICogQHBhcmFtICB7TWVzc2FnZUJvZHlJZGVudGl0eX0gaWRlbnRpdHkgLSAob3B0aW9uYWwpIGlkZW50aXR5IGRhdGEgdG8gYmUgYWRkZWQgdG8gaWRlbnRpdHkgdGhlIHVzZXIgcmVwb3J0ZXIuIFRvIGJlIHVzZWQgZm9yIGxlZ2FjeSBpZGVudGl0aWVzLgoJICAgICogQHJldHVybiB7UHJvbWlzZTxEYXRhT2JqZWN0UmVwb3J0ZXI+fSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBSZXBvcnRlci4gVGhlIHJlcG9ydGVyIGNhbiBiZSBhY2NlcHRlZCBvciByZWplY3RlZCBieSB0aGUgUEVQCgkgICAgKi8KCSAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKHNjaGVtYSwgb2JzZXJ2ZXJzLCBpbml0aWFsRGF0YSkgewoJICAgICAgdmFyIHN0b3JlID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKCSAgICAgIHZhciBwMnAgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IGZhbHNlOwoJICAgICAgdmFyIGlkZW50aXR5ID0gYXJndW1lbnRzWzVdOwoKCgkgICAgICBpZiAoIXNjaGVtYSkgdGhyb3cgRXJyb3IoJ1tTeW5jaGVyIC0gQ3JlYXRlXSAtIFlvdSBuZWVkIHNwZWNpZnkgdGhlIGRhdGEgb2JqZWN0IHNjaGVtYScpOwoJICAgICAgaWYgKCFvYnNlcnZlcnMpIHRocm93IEVycm9yKCdbU3luY2hlciAtIENyZWF0ZV0gLVRoZSBvYnNlcnZlcnMgc2hvdWxkIGJlIGRlZmluZWQnKTsKCSAgICAgIGlmICghaW5pdGlhbERhdGEpIHRocm93IEVycm9yKCdbU3luY2hlciAtIENyZWF0ZV0gLSBZb3UgaW5pdGlhbERhdGEgc2hvdWxkIGJlIGRlZmluZWQnKTsKCgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoJICAgICAgdmFyIGNyaXRlcmlhID0ge307CgoJICAgICAgY3JpdGVyaWEucDJwID0gcDJwOwoJICAgICAgY3JpdGVyaWEuc3RvcmUgPSBzdG9yZTsKCSAgICAgIGNyaXRlcmlhLnNjaGVtYSA9IHNjaGVtYTsKCSAgICAgIGNyaXRlcmlhLm9ic2VydmVycyA9IG9ic2VydmVyczsKCSAgICAgIGNyaXRlcmlhLmluaXRpYWxEYXRhID0gaW5pdGlhbERhdGE7CgoJICAgICAgaWYgKGlkZW50aXR5KSB7CgkgICAgICAgIGNyaXRlcmlhLmlkZW50aXR5ID0gaWRlbnRpdHk7CgkgICAgICB9CgoJICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogZmFsc2UgfSk7CgoJICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZSBSZXBvcnRlciAtIGNyaXRlcmlhOiAnLCBjcml0ZXJpYSk7CgoJICAgICAgcmV0dXJuIF90aGlzLl9jcmVhdGUoY3JpdGVyaWEpOwoJICAgIH0KCgkgICAgLyoqCgkgICAgKiBSZXF1ZXN0IGEgRGF0YU9iamVjdFJlcG9ydGVyIGNyZWF0aW9uLiBUaGUgVVJMIHdpbGwgYmUgYmUgcmVxdWVzdGVkIGJ5IHRoZSBhbGxvY2F0aW9uIG1lY2hhbmlzbS4KCSAgICAqIEBwYXJhbSAge09iamVjdH0gY3JpdGVyaWEgLSAob3B0aW9uYWwpIGlkZW50aXR5IGRhdGEgdG8gYmUgYWRkZWQgdG8gaWRlbnRpdHkgdGhlIHVzZXIgcmVwb3J0ZXIuIFRvIGJlIHVzZWQgZm9yIGxlZ2FjeSBpZGVudGl0aWVzLgoJICAgICogQHJldHVybiB7UHJvbWlzZTxEYXRhT2JqZWN0UmVwb3J0ZXI+W119IFJldHVybiBhIHByb21pc2Ugd2l0aCBhIGxpc3Qgb2YgRGF0YU9iamVjdFJlcG9ydGVyIHRvIGJlIHJlc3VtZWQ7CgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdyZXN1bWVSZXBvcnRlcnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVSZXBvcnRlcnMoY3JpdGVyaWEpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdIC0gcmVzdW1lIFJlcG9ydGVyIC0gY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCgkgICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiB0cnVlIH0pOwoKCSAgICAgIHJldHVybiBfdGhpcy5fcmVzdW1lQ3JlYXRlKGNyaXRlcmlhKTsKCSAgICB9CgoJICAgIC8qKgoJICAgICogUmVxdWVzdCBhIHN1YnNjcmlwdGlvbiB0byBhbiBleGlzdGVudCByZXBvcnRlciBvYmplY3QuCgkgICAgKiBAcGFyYW0ge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hCgkgICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gQWRkcmVzcyBvZiB0aGUgZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIG9ic2VydmVkCgkgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtzdG9yZT1mYWxzZV0gLSBTYXZlIHRoZSBzdWJzY3JpcHRpb24gb24gdGhlIFN5bmNoZXIgTWFuYWdlciBmb3IgZnVydGhlciByZXN1bWUgKERlZmF1bHQgaXMgZmFsc2UpCgkgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtwMnA9ZmFsc2VdIC0gSW5mbyBhYm91dCBpZiBzaG91bGQgdXNlIHAycCBjb25uZWN0aW9uIChEZWZhdWx0IGlzIGZhbHNlKQoJICAgICogQHBhcmFtIHtCb29sZWFufSBbbXV0dWFsPXRydWVdIC0gSW5mbyBhYm91dCBpZiBtZXNzYWdlcyBvZiB0aGlzIG9iamVjdCBzaG91bGQgYmUgZW5jcnlwdGVkIChEZWZhdWx0IGlzIHRydWUpCgkgICAgKiBAcGFyYW0gIHtNZXNzYWdlQm9keUlkZW50aXR5fSBpZGVudGl0eSAtIChvcHRpb25hbCkgaWRlbnRpdHkgZGF0YSB0byBiZSBhZGRlZCB0byBpZGVudGl0eSB0aGUgdXNlciByZXBvcnRlci4gVG8gYmUgdXNlZCBmb3IgbGVnYWN5IGlkZW50aXRpZXMuCgkgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuCgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdzdWJzY3JpYmUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBzdWJzY3JpYmUoc2NoZW1hLCBvYmpVUkwpIHsKCSAgICAgIHZhciBzdG9yZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CgkgICAgICB2YXIgcDJwID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKCSAgICAgIHZhciBtdXR1YWwgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IHRydWU7CgkgICAgICB2YXIgaWRlbnRpdHkgPSBhcmd1bWVudHNbNV07CgoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCSAgICAgIHZhciBjcml0ZXJpYSA9IHt9OwoKCSAgICAgIGNyaXRlcmlhLnAycCA9IHAycDsKCSAgICAgIGNyaXRlcmlhLnN0b3JlID0gc3RvcmU7CgkgICAgICBjcml0ZXJpYS5zY2hlbWEgPSBzY2hlbWE7CgoJICAgICAgY3JpdGVyaWEucmVzb3VyY2UgPSBvYmpVUkw7CgkgICAgICBpZiAoaWRlbnRpdHkpIHsKCSAgICAgICAgY3JpdGVyaWEuaWRlbnRpdHkgPSBpZGVudGl0eTsKCSAgICAgIH0KCgkgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CgkgICAgICBjcml0ZXJpYS5tdXR1YWwgPSBtdXR1YWw7CgoJICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gc3Vic2NyaWJlXSAtIHN1YnNjcmliZSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKCSAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShjcml0ZXJpYSwgeyByZXN1bWU6IGZhbHNlIH0pOwoKCSAgICAgIHJldHVybiBfdGhpcy5fc3Vic2NyaWJlKGNyaXRlcmlhKTsKCSAgICB9CgoJICAgIC8qKgoJICAgICogUmVxdWVzdCBhIHN1YnNjcmlwdGlvbiB0byBhbiBleGlzdGVudCByZXBvcnRlciBvYmplY3QuCgkgICAgKiBAcGFyYW0ge2NyaXRlcmlhfSBjcml0ZXJpYSAtIEluZm9ybWF0aW9uIHRvIGRpc2NvdmVyeSB0aGUgb2JzZXJ2ZXIgb2JqZWN0CgkgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuCgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdyZXN1bWVPYnNlcnZlcnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVPYnNlcnZlcnMoY3JpdGVyaWEpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICB2YXIgX2NyaXRlcmlhID0gY3JpdGVyaWEgfHwge307CgoJICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKF9jcml0ZXJpYSwgeyByZXN1bWU6IHRydWUgfSk7CgoJICAgICAgcmV0dXJuIF90aGlzLl9yZXN1bWVTdWJzY3JpYmUoX2NyaXRlcmlhKTsKCSAgICB9CgoJICAgIC8qKgoJICAgICogUmVxdWVzdCBhIHJlYWQgYWN0aW9uIG9uIHRoZSByZXBvcnRlciBvYmplY3QKCSAgICAqIEBwYXJhbSB7T2JqZWN0VVJMfSBvYmpVUkwgLSBVUkwgb2YgdGhlIHJlcG9ydGVyIG9iamVjdCB0byBiZSByZWFkCgkgICAgKiBAcmV0dXJuIHtQcm9taXNlPE9iamVjdD59IFJldHVybiBQcm9taXNlIHRvIGxhc3QgYXZhaWxhYmxlIGRhdGEgb2YgdGhlIHJlcG9ydGVyCgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdyZWFkJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZChvYmpVUkwpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byByZXBvcnRlciBvYmplY3QgKG1heWJlIHRoZXJlIGlzIG5vIGxpc3RlbmVyIGF2YWlsYWJsZSwgc28gaXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIE1lc3NhZ2VCdXMgLT4gcmVzb2x2ZSkKCSAgICAgIC8vd2lsbCByZWFjaCB0aGUgcmVtb3RlIG9iamVjdCBpbiBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gX29uUmVhZAoJICAgICAgdmFyIHJlYWRNc2cgPSB7CgkgICAgICAgIHR5cGU6ICdyZWFkJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogb2JqVVJMCgkgICAgICB9OwoKCSAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoJICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlYWRNc2csIGZ1bmN0aW9uIChyZXBseSkgewoJICAgICAgICAgIGNvbnNvbGUubG9nKCdyZWFkLXJlc3BvbnNlOiAnLCByZXBseSk7CgkgICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CgkgICAgICAgICAgICByZXNvbHZlKHJlcGx5LmJvZHkudmFsdWUpOwoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIGV2ZW50cyBvZiByZW1vdmUgUmVwb3J0ZXIgb2JqZWN0cy4KCSAgICAqIFRoaXMgaXMgcmVsZWF0ZWQgdG8gdGhlIG1lc3NhZ2VucyBzZW50IGJ5IGNyZWF0ZSB0byB0aGUgb2JzZXJ2ZXJzIEh5cGVydHkgYXJyYXkuCgkgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvbk5vdGlmaWNhdGlvbicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9uTm90aWZpY2F0aW9uKGNhbGxiYWNrKSB7CgkgICAgICB0aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIgPSBjYWxsYmFjazsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfY3JlYXRlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZShjcml0ZXJpYSkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCSAgICAgICAgdmFyIHJlc3VtZSA9IGNyaXRlcmlhLnJlc3VtZTsKCSAgICAgICAgdmFyIGluaXRpYWxEYXRhID0gY3JpdGVyaWEuaW5pdGlhbERhdGEgfHwge307CgkgICAgICAgIHZhciBzY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CgoJICAgICAgICBpbml0aWFsRGF0YS5yZXBvcnRlciA9IF90aGlzLl9vd25lcjsKCSAgICAgICAgaW5pdGlhbERhdGEuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwoKCSAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKCSAgICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CgkgICAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zdWJVUkwsCgkgICAgICAgICAgYm9keTogeyByZXN1bWU6IHJlc3VtZSB9CgkgICAgICAgIH07CgoJICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdOiAnLCBjcml0ZXJpYSwgcmVxdWVzdE1zZyk7CgoJICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUgPSBpbml0aWFsRGF0YTsKCSAgICAgICAgcmVxdWVzdE1zZy5ib2R5LnJlcG9ydGVyID0gX3RoaXMuX293bmVyOwoJICAgICAgICByZXF1ZXN0TXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwoKCSAgICAgICAgaWYgKGNyaXRlcmlhLnAycCkgcmVxdWVzdE1zZy5ib2R5LnAycCA9IGNyaXRlcmlhLnAycDsKCSAgICAgICAgaWYgKGNyaXRlcmlhLnN0b3JlKSByZXF1ZXN0TXNnLmJvZHkuc3RvcmUgPSBjcml0ZXJpYS5zdG9yZTsKCSAgICAgICAgaWYgKGNyaXRlcmlhLm9ic2VydmVycykgcmVxdWVzdE1zZy5ib2R5LmF1dGhvcmlzZSA9IGNyaXRlcmlhLm9ic2VydmVyczsKCSAgICAgICAgaWYgKGNyaXRlcmlhLmlkZW50aXR5KSByZXF1ZXN0TXNnLmJvZHkuaWRlbnRpdHkgPSBjcml0ZXJpYS5pZGVudGl0eTsKCgkgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUgbWVzc2FnZTogJywgcmVxdWVzdE1zZyk7CgoJICAgICAgICAvL3JlcXVlc3QgY3JlYXRlIHRvIHRoZSBhbGxvY2F0aW9uIHN5c3RlbS4gQ2FuIGJlIHJlamVjdGVkIGJ5IHRoZSBQb2xpY3lFbmdpbmUuCgkgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVxdWVzdE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXNwb25zZTogJywgcmVwbHkpOwoJICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewoJICAgICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiBhY2NlcHRlZAoJICAgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgoJICAgICAgICAgICAgdmFyIG5ld09iaiA9IG5ldyBfRGF0YU9iamVjdFJlcG9ydGVyMi5kZWZhdWx0KF90aGlzLCBvYmpVUkwsIHNjaGVtYSwgJ29uJywgaW5pdGlhbERhdGEsIHJlcGx5LmJvZHkuY2hpbGRyZW5SZXNvdXJjZXMpOwoJICAgICAgICAgICAgX3RoaXMuX3JlcG9ydGVyc1tvYmpVUkxdID0gbmV3T2JqOwoKCSAgICAgICAgICAgIHJlc29sdmUobmV3T2JqKTsKCSAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiByZWplY3RlZAoJICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19yZXN1bWVDcmVhdGUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVzdW1lQ3JlYXRlKGNyaXRlcmlhKSB7CgkgICAgICB2YXIgX3RoaXMyID0gdGhpczsKCgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoJICAgICAgICB2YXIgcmVzdW1lID0gY3JpdGVyaWEucmVzdW1lOwoJICAgICAgICB2YXIgaW5pdGlhbERhdGEgPSBjcml0ZXJpYS5pbml0aWFsRGF0YSB8fCB7fTsKCgkgICAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uQ3JlYXRlCgkgICAgICAgIHZhciByZXF1ZXN0TXNnID0gewoJICAgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAoJICAgICAgICAgIGJvZHk6IHsgcmVzdW1lOiByZXN1bWUgfQoJICAgICAgICB9OwoKCSAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXTogJywgY3JpdGVyaWEsIHJlcXVlc3RNc2cpOwoKCSAgICAgICAgcmVxdWVzdE1zZy5ib2R5LnZhbHVlID0gaW5pdGlhbERhdGE7CgkgICAgICAgIHJlcXVlc3RNc2cuYm9keS52YWx1ZS5yZXBvcnRlciA9IF90aGlzLl9vd25lcjsKCgkgICAgICAgIGlmIChjcml0ZXJpYS5wMnApIHJlcXVlc3RNc2cuYm9keS5wMnAgPSBjcml0ZXJpYS5wMnA7CgkgICAgICAgIGlmIChjcml0ZXJpYS5zdG9yZSkgcmVxdWVzdE1zZy5ib2R5LnN0b3JlID0gY3JpdGVyaWEuc3RvcmU7CgkgICAgICAgIGlmIChjcml0ZXJpYS5vYnNlcnZlcnMpIHJlcXVlc3RNc2cuYm9keS5hdXRob3Jpc2UgPSBjcml0ZXJpYS5vYnNlcnZlcnM7CgkgICAgICAgIGlmIChjcml0ZXJpYS5pZGVudGl0eSkgcmVxdWVzdE1zZy5ib2R5LmlkZW50aXR5ID0gY3JpdGVyaWEuaWRlbnRpdHk7CgoJICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdIC0gcmVzdW1lIG1lc3NhZ2U6ICcsIHJlcXVlc3RNc2cpOwoKCSAgICAgICAgLy9yZXF1ZXN0IGNyZWF0ZSB0byB0aGUgYWxsb2NhdGlvbiBzeXN0ZW0uIENhbiBiZSByZWplY3RlZCBieSB0aGUgUG9saWN5RW5naW5lLgoJICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2csIGZ1bmN0aW9uIChyZXBseSkgewoJICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUtcmVzdW1lZC1yZXNwb25zZTogJywgcmVwbHkpOwoJICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewoKCSAgICAgICAgICAgIHZhciBsaXN0T2ZSZXBvcnRlcnMgPSByZXBseS5ib2R5LnZhbHVlOwoKCSAgICAgICAgICAgIGZvciAodmFyIGluZGV4IGluIGxpc3RPZlJlcG9ydGVycykgewoKCSAgICAgICAgICAgICAgdmFyIGRhdGFPYmplY3QgPSBsaXN0T2ZSZXBvcnRlcnNbaW5kZXhdOwoKCSAgICAgICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiBhY2NlcHRlZAoJICAgICAgICAgICAgICB2YXIgb2JqVVJMID0gZGF0YU9iamVjdC5yZXNvdXJjZTsKCSAgICAgICAgICAgICAgdmFyIHNjaGVtYSA9IGRhdGFPYmplY3Quc2NoZW1hOwoJICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gZGF0YU9iamVjdC5zdGF0dXMgfHwgJ29uJzsKCSAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuUmVzb3VyY2VzID0gZGF0YU9iamVjdC5jaGlsZHJlblJlc291cmNlczsKCgkgICAgICAgICAgICAgIC8vIGluaXRpYWxEYXRhLmNoaWxkcmVucyA9IGRlZXBDbG9uZShkYXRhT2JqZWN0LmNoaWxkcmVucykgfHwge307CgkgICAgICAgICAgICAgIC8vIGluaXRpYWxEYXRhID0gZGVlcENsb25lKGRhdGFPYmplY3QuZGF0YSkgfHwge307CgkgICAgICAgICAgICAgIHZhciBpbml0ID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGRhdGFPYmplY3QuZGF0YSkgfHwge307CgkgICAgICAgICAgICAgIHZhciBjaGlsZHJlbnMgPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoZGF0YU9iamVjdC5jaGlsZHJlbnMpIHx8IHt9OwoKCSAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXN1bWVkLWRhdGFPYmplY3RSZXBvcnRlcicsIG9ialVSTCwgc3RhdHVzLCBpbml0KTsKCgkgICAgICAgICAgICAgIHZhciBuZXdPYmogPSBuZXcgX0RhdGFPYmplY3RSZXBvcnRlcjIuZGVmYXVsdChfdGhpcywgb2JqVVJMLCBzY2hlbWEsIHN0YXR1cywgaW5pdCwgY2hpbGRyZW5SZXNvdXJjZXMsIGZhbHNlLCB0cnVlKTsKCSAgICAgICAgICAgICAgbmV3T2JqLnJlc3VtZUNoaWxkcmVucyhjaGlsZHJlbnMpOwoJICAgICAgICAgICAgICBfdGhpcy5fcmVwb3J0ZXJzW29ialVSTF0gPSBuZXdPYmo7CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgcmVzb2x2ZShfdGhpcy5fcmVwb3J0ZXJzKTsKCSAgICAgICAgICAgIGlmIChfdGhpczIuX29uUmVwb3J0ZXJzUmVzdW1lKSBfdGhpczIuX29uUmVwb3J0ZXJzUmVzdW1lKF90aGlzMi5fcmVwb3J0ZXJzKTsKCSAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiByZWplY3RlZAoJICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19zdWJzY3JpYmUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfc3Vic2NyaWJlKGNyaXRlcmlhKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKCSAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25Mb2NhbFN1YnNjcmliZQoJICAgICAgICB2YXIgc3Vic2NyaWJlTXNnID0gewoJICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAoJICAgICAgICAgIGJvZHk6IHt9CgkgICAgICAgIH07CgoJICAgICAgICAvLyBIeXBlcnR5IHJlcXVlc3QgdG8gYmUgYW4gT2JzZXJ2ZXIKCSAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjaHlwZXJ0eS1yZXF1ZXN0LXRvLWJlLWFuLW9ic2VydmVyCgoJICAgICAgICAvLyBSZXN1bWUgU3Vic2NyaXB0aW9ucyBmb3IgdGhlIHNhbWUgSHlwZXJ0eSBVUkwKCSAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLXRoZS1zYW1lLWh5cGVydHktdXJsCgoJICAgICAgICAvLyBSZXN1bWUgU3Vic2NyaXB0aW9ucyBmb3IgYSBjZXJ0YWluIHVzZXIgYW5kIGRhdGEgc2NoZW1hIGluZGVwZW5kZW50bHkgb2YgdGhlIEh5cGVydHkgVVJMLgoJICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNyZXN1bWUtc3Vic2NyaXB0aW9ucy1mb3ItYS1jZXJ0YWluLXVzZXItYW5kLWRhdGEtc2NoZW1hLWluZGVwZW5kZW50bHktb2YtdGhlLWh5cGVydHktdXJsCgkgICAgICAgIGlmIChjcml0ZXJpYSkgewoJICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgncDJwJykpIHN1YnNjcmliZU1zZy5ib2R5LnAycCA9IGNyaXRlcmlhLnAycDsKCSAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ3N0b3JlJykpIHN1YnNjcmliZU1zZy5ib2R5LnN0b3JlID0gY3JpdGVyaWEuc3RvcmU7CgkgICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzY2hlbWEnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwoJICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgnaWRlbnRpdHknKSkgc3Vic2NyaWJlTXNnLmJvZHkuaWRlbnRpdHkgPSBjcml0ZXJpYS5pZGVudGl0eTsKCSAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ3Jlc291cmNlJykpIHN1YnNjcmliZU1zZy5ib2R5LnJlc291cmNlID0gY3JpdGVyaWEucmVzb3VyY2U7CgkgICAgICAgIH0KCgkgICAgICAgIHN1YnNjcmliZU1zZy5ib2R5LnJlc3VtZSA9IGNyaXRlcmlhLnJlc3VtZTsKCgkgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKCSAgICAgICAgdmFyIG11dHVhbEF1dGhlbnRpY2F0aW9uID0gY3JpdGVyaWEubXV0dWFsOwoJICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ211dHVhbCcpKSBzdWJzY3JpYmVNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbEF1dGhlbnRpY2F0aW9uOwoKCSAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIHN1YnNjcmliZSBtZXNzYWdlOiAnLCBjcml0ZXJpYSwgc3Vic2NyaWJlTXNnKTsKCgkgICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KCSAgICAgICAgLy9Qcm92aXNpb25hbCBkYXRhIGlzIGFwcGxpZWQgdG8gdGhlIERhdGFPYmplY3RPYnNlcnZlciBhZnRlciBjb25maXJtYXRpb24uIE9yIGRpc2NhcmRlZCBpZiB0aGVyZSBpcyBubyBjb25maXJtYXRpb24uCgkgICAgICAgIC8vZm9yIG1vcmUgaW5mbyBzZWUgdGhlIERhdGFQcm92aXNpb25hbCBjbGFzcyBkb2N1bWVudGF0aW9uLgoJICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIHN1YnNjcmliZS1yZXNwb25zZTogJywgcmVwbHkpOwoKCSAgICAgICAgICB2YXIgc2NoZW1hID0gcmVwbHkuYm9keS5zY2hlbWE7CgkgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgoJICAgICAgICAgIHZhciBuZXdQcm92aXNpb25hbCA9IF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKCSAgICAgICAgICBkZWxldGUgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwoJICAgICAgICAgIGlmIChuZXdQcm92aXNpb25hbCkgbmV3UHJvdmlzaW9uYWwuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCgkgICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA8IDIwMCkgewoJICAgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIG5ldyBEYXRhUHJvdmlzaW9uYWw6ICcsIHJlcGx5LmJvZHkuY2hpbGRyZW5SZXNvdXJjZXMsIG9ialVSTCk7CgkgICAgICAgICAgICBuZXdQcm92aXNpb25hbCA9IG5ldyBfRGF0YVByb3Zpc2lvbmFsMi5kZWZhdWx0KF90aGlzLl9vd25lciwgb2JqVVJMLCBfdGhpcy5fYnVzLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKCSAgICAgICAgICAgIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXSA9IG5ld1Byb3Zpc2lvbmFsOwoJICAgICAgICAgIH0gZWxzZSBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKCSAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YSBPYmplY3QgT2JzZXJ2ZXI6ICcsIHJlcGx5LCBfdGhpcy5fcHJvdmlzaW9uYWxzKTsKCgkgICAgICAgICAgICB2YXIgaW5pdGlhbERhdGEgPSByZXBseS5ib2R5LnZhbHVlOwoJICAgICAgICAgICAgaWYgKCFpbml0aWFsRGF0YS5oYXNPd25Qcm9wZXJ0eSgnY2hpbGRyZW5zJykpIHsKCSAgICAgICAgICAgICAgaW5pdGlhbERhdGEuY2hpbGRyZW5zID0ge307CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoIWluaXRpYWxEYXRhLmhhc093blByb3BlcnR5KCdkYXRhJykpIHsKCSAgICAgICAgICAgICAgaW5pdGlhbERhdGEuZGF0YSA9IHt9OwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIC8vVE9ETzogbXV0dWFsQXV0aGVudGljYXRpb24gRm9yIEZ1cnRoZXIgU3R1ZHkKCSAgICAgICAgICAgIHZhciBuZXdPYmogPSBuZXcgX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdChfdGhpcywgb2JqVVJMLCBzY2hlbWEsICdvbicsIGluaXRpYWxEYXRhLCBuZXdQcm92aXNpb25hbC5jaGlsZHJlbiwgcmVwbHkuYm9keS52ZXJzaW9uLCBtdXR1YWxBdXRoZW50aWNhdGlvbik7CgkgICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF0gPSBuZXdPYmo7CgoJICAgICAgICAgICAgcmVzb2x2ZShuZXdPYmopOwoJICAgICAgICAgICAgbmV3UHJvdmlzaW9uYWwuYXBwbHkobmV3T2JqKTsKCSAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19yZXN1bWVTdWJzY3JpYmUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVzdW1lU3Vic2NyaWJlKGNyaXRlcmlhKSB7CgkgICAgICB2YXIgX3RoaXMzID0gdGhpczsKCgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKCSAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25Mb2NhbFN1YnNjcmliZQoJICAgICAgICB2YXIgc3Vic2NyaWJlTXNnID0gewoJICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAoJICAgICAgICAgIGJvZHk6IHt9CgkgICAgICAgIH07CgoJICAgICAgICAvLyBIeXBlcnR5IHJlcXVlc3QgdG8gYmUgYW4gT2JzZXJ2ZXIKCSAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjaHlwZXJ0eS1yZXF1ZXN0LXRvLWJlLWFuLW9ic2VydmVyCgoJICAgICAgICAvLyBSZXN1bWUgU3Vic2NyaXB0aW9ucyBmb3IgdGhlIHNhbWUgSHlwZXJ0eSBVUkwKCSAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLXRoZS1zYW1lLWh5cGVydHktdXJsCgoJICAgICAgICAvLyBSZXN1bWUgU3Vic2NyaXB0aW9ucyBmb3IgYSBjZXJ0YWluIHVzZXIgYW5kIGRhdGEgc2NoZW1hIGluZGVwZW5kZW50bHkgb2YgdGhlIEh5cGVydHkgVVJMLgoJICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNyZXN1bWUtc3Vic2NyaXB0aW9ucy1mb3ItYS1jZXJ0YWluLXVzZXItYW5kLWRhdGEtc2NoZW1hLWluZGVwZW5kZW50bHktb2YtdGhlLWh5cGVydHktdXJsCgkgICAgICAgIGlmIChjcml0ZXJpYSkgewoJICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgncDJwJykpIHN1YnNjcmliZU1zZy5ib2R5LnAycCA9IGNyaXRlcmlhLnAycDsKCSAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ3N0b3JlJykpIHN1YnNjcmliZU1zZy5ib2R5LnN0b3JlID0gY3JpdGVyaWEuc3RvcmU7CgkgICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzY2hlbWEnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwoJICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgnaWRlbnRpdHknKSkgc3Vic2NyaWJlTXNnLmJvZHkuaWRlbnRpdHkgPSBjcml0ZXJpYS5pZGVudGl0eTsKCSAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ3Jlc291cmNlJykpIHN1YnNjcmliZU1zZy5ib2R5LnJlc291cmNlID0gY3JpdGVyaWEucmVzb3VyY2U7CgkgICAgICAgIH0KCgkgICAgICAgIHN1YnNjcmliZU1zZy5ib2R5LnJlc3VtZSA9IGNyaXRlcmlhLnJlc3VtZTsKCgkgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKCSAgICAgICAgdmFyIG11dHVhbEF1dGhlbnRpY2F0aW9uID0gY3JpdGVyaWEubXV0dWFsOwoJICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ211dHVhbCcpKSBzdWJzY3JpYmVNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbEF1dGhlbnRpY2F0aW9uOwoKCSAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIHN1YnNjcmliZSBtZXNzYWdlOiAnLCBjcml0ZXJpYSwgc3Vic2NyaWJlTXNnKTsKCgkgICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KCSAgICAgICAgLy9Qcm92aXNpb25hbCBkYXRhIGlzIGFwcGxpZWQgdG8gdGhlIERhdGFPYmplY3RPYnNlcnZlciBhZnRlciBjb25maXJtYXRpb24uIE9yIGRpc2NhcmRlZCBpZiB0aGVyZSBpcyBubyBjb25maXJtYXRpb24uCgkgICAgICAgIC8vZm9yIG1vcmUgaW5mbyBzZWUgdGhlIERhdGFQcm92aXNpb25hbCBjbGFzcyBkb2N1bWVudGF0aW9uLgoJICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIHN1YnNjcmliZS1yZXN1bWVkLXJlc3BvbnNlOiAnLCByZXBseSk7CgoJICAgICAgICAgIHZhciBvYmpVUkwgPSByZXBseS5ib2R5LnJlc291cmNlOwoKCSAgICAgICAgICB2YXIgbmV3UHJvdmlzaW9uYWwgPSBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF07CgkgICAgICAgICAgZGVsZXRlIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKCSAgICAgICAgICBpZiAobmV3UHJvdmlzaW9uYWwpIG5ld1Byb3Zpc2lvbmFsLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgoJICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPCAyMDApIHsKCgkgICAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gcmVzdW1lIG5ldyBEYXRhUHJvdmlzaW9uYWw6ICcsIHJlcGx5LCBvYmpVUkwpOwoJICAgICAgICAgICAgbmV3UHJvdmlzaW9uYWwgPSBuZXcgX0RhdGFQcm92aXNpb25hbDIuZGVmYXVsdChfdGhpcy5fb3duZXIsIG9ialVSTCwgX3RoaXMuX2J1cywgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CgkgICAgICAgICAgICBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF0gPSBuZXdQcm92aXNpb25hbDsKCSAgICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CgoJICAgICAgICAgICAgdmFyIGxpc3RPZk9ic2VydmVycyA9IHJlcGx5LmJvZHkudmFsdWU7CgoJICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggaW4gbGlzdE9mT2JzZXJ2ZXJzKSB7CgoJICAgICAgICAgICAgICB2YXIgZGF0YU9iamVjdCA9IGxpc3RPZk9ic2VydmVyc1tpbmRleF07CgkgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBSZXN1bWUgT2JqZWN0IE9ic2VydmVyOiAnLCByZXBseSwgZGF0YU9iamVjdCwgX3RoaXMuX3Byb3Zpc2lvbmFscyk7CgoJICAgICAgICAgICAgICB2YXIgc2NoZW1hID0gZGF0YU9iamVjdC5zY2hlbWE7CgkgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSBkYXRhT2JqZWN0LnN0YXR1cyB8fCAnb24nOwoJICAgICAgICAgICAgICB2YXIgX29ialVSTCA9IGRhdGFPYmplY3QucmVzb3VyY2U7CgkgICAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gZGF0YU9iamVjdC52ZXJzaW9uIHx8IDA7CgkgICAgICAgICAgICAgIHZhciBjaGlsZHJlblJlc291cmNlcyA9IGRhdGFPYmplY3QuY2hpbGRyZW5SZXNvdXJjZXM7CgoJICAgICAgICAgICAgICB2YXIgaW5pdGlhbERhdGEgPSB7fTsKCSAgICAgICAgICAgICAgaW5pdGlhbERhdGEuY2hpbGRyZW5zID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGRhdGFPYmplY3QuY2hpbGRyZW5zKSB8fCB7fTsKCSAgICAgICAgICAgICAgaW5pdGlhbERhdGEuZGF0YSA9ICgwLCBfdXRpbHMuZGVlcENsb25lKShkYXRhT2JqZWN0LmRhdGEpIHx8IHt9OwoKCSAgICAgICAgICAgICAgLy9UT0RPOiBtdXR1YWxBdXRoZW50aWNhdGlvbiBGb3IgRnVydGhlciBTdHVkeQoJICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSByZXN1bWUgc3Vic2NyaWJlXSAtIGNyZWF0ZSBuZXcgZGF0YU9iamVjdDogJywgc3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5SZXNvdXJjZXMsIHZlcnNpb24pOwoJICAgICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0T2JzZXJ2ZXIyLmRlZmF1bHQoX3RoaXMsIF9vYmpVUkwsIHNjaGVtYSwgc3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5SZXNvdXJjZXMsIHZlcnNpb24sIG11dHVhbEF1dGhlbnRpY2F0aW9uLCB0cnVlKTsKCgkgICAgICAgICAgICAgIF90aGlzLl9vYnNlcnZlcnNbX29ialVSTF0gPSBuZXdPYmo7CgoJICAgICAgICAgICAgICBfdGhpcy5fcHJvdmlzaW9uYWxzW19vYmpVUkxdLmFwcGx5KG5ld09iaik7CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgcmVzb2x2ZShfdGhpcy5fb2JzZXJ2ZXJzKTsKCgkgICAgICAgICAgICBpZiAoX3RoaXMzLl9vbk9ic2VydmVyc1Jlc3VtZSkgX3RoaXMzLl9vbk9ic2VydmVyc1Jlc3VtZShfdGhpcy5fb2JzZXJ2ZXJzKTsKCSAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgIH0pOwoJICAgIH0KCgkgICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSBsb2NhbCBydW50aW1lIFJlcG9ydGVyT2JqZWN0IC0+IF9vblJlbW90ZVN1YnNjcmliZQoKCSAgfSwgewoJICAgIGtleTogJ19vbkZvcndhcmQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Gb3J3YXJkKG1zZykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICB2YXIgcmVwb3J0ZXIgPSBfdGhpcy5fcmVwb3J0ZXJzW21zZy5ib2R5LnRvXTsKCSAgICAgIHJlcG9ydGVyLl9vbkZvcndhcmQobXNnKTsKCSAgICB9CgoJICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIFN5bmNoZXIgLT4gY3JlYXRlICh0aGlzIGlzIGFjdHVhbGx5IGFuIGludml0YXRpb24gdG8gc3Vic2NyaWJlKQoKCSAgfSwgewoJICAgIGtleTogJ19vblJlbW90ZUNyZWF0ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlbW90ZUNyZWF0ZShtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgLy9yZW1vdmUgIi9zdWJzY3JpcHRpb24iIGZyb20gdGhlIFVSTAoJICAgICAgdmFyIHJlc291cmNlID0gbXNnLmZyb20uc2xpY2UoMCwgLTEzKTsKCgkgICAgICB2YXIgZXZlbnQgPSB7CgkgICAgICAgIHR5cGU6IG1zZy50eXBlLAoJICAgICAgICBmcm9tOiBtc2cuYm9keS5zb3VyY2UsCgkgICAgICAgIHVybDogcmVzb3VyY2UsCgkgICAgICAgIHNjaGVtYTogbXNnLmJvZHkuc2NoZW1hLAoJICAgICAgICB2YWx1ZTogbXNnLmJvZHkudmFsdWUsCgkgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCgkgICAgICAgIGFjazogZnVuY3Rpb24gYWNrKHR5cGUpIHsKCSAgICAgICAgICB2YXIgbFR5cGUgPSAyMDA7CgkgICAgICAgICAgaWYgKHR5cGUpIHsKCSAgICAgICAgICAgIGxUeXBlID0gdHlwZTsKCSAgICAgICAgICB9CgoJICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQoJICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewoJICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCgkgICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlIH0KCSAgICAgICAgICB9KTsKCSAgICAgICAgfQoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcikgewoJICAgICAgICBjb25zb2xlLmluZm8oJ1tTeW5jaGVyXSBOT1RJRklDQVRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKCSAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CgkgICAgICB9CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gZGVsZXRlCgoJICB9LCB7CgkgICAga2V5OiAnX29uUmVtb3RlRGVsZXRlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVtb3RlRGVsZXRlKG1zZykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCgkgICAgICB2YXIgcmVzb3VyY2UgPSBtc2cuYm9keS5yZXNvdXJjZTsKCgkgICAgICB2YXIgb2JqZWN0ID0gX3RoaXMuX29ic2VydmVyc1tyZXNvdXJjZV07CgkgICAgICBpZiAob2JqZWN0KSB7CgkgICAgICAgIHZhciBldmVudCA9IHsKCSAgICAgICAgICB0eXBlOiBtc2cudHlwZSwKCSAgICAgICAgICB1cmw6IHJlc291cmNlLAoJICAgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCgkgICAgICAgICAgYWNrOiBmdW5jdGlvbiBhY2sodHlwZSkgewoJICAgICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwoJICAgICAgICAgICAgaWYgKHR5cGUpIHsKCSAgICAgICAgICAgICAgbFR5cGUgPSB0eXBlOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIC8vVE9ETzogYW55IG90aGVyIGRpZmZlcmVudCBvcHRpb25zIGZvciB0aGUgcmVsZWFzZSBwcm9jZXNzLCBsaWtlIGFjY2VwdCBidXQgbm9yIHJlbGVhc2UgbG9jYWw/CgkgICAgICAgICAgICBpZiAobFR5cGUgPT09IDIwMCkgewoJICAgICAgICAgICAgICBvYmplY3QuZGVsZXRlKCk7CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgLy9zZW5kIGFjayByZXNwb25zZSBtZXNzYWdlCgkgICAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKCSAgICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCgkgICAgICAgICAgICAgIGJvZHk6IHsgY29kZTogbFR5cGUsIHNvdXJjZTogX3RoaXMuX293bmVyIH0KCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgIH0KCSAgICAgICAgfTsKCgkgICAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ05PVElGSUNBVElPTi1FVkVOVDogJywgZXZlbnQpOwoJICAgICAgICAgIF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIoZXZlbnQpOwoJICAgICAgICB9CgkgICAgICB9IGVsc2UgewoJICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKCSAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKCSAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwNCwgc291cmNlOiBfdGhpcy5fb3duZXIgfQoJICAgICAgICB9KTsKCSAgICAgIH0KCSAgICB9CgoJICAgIC8qKgoJICAgICogQ2FsbGJhY2sgc3lzdGVtIHRvIHRyaWdnZXIgdGhlIHJlc3VtZWQgcmVwb3J0ZXJzCgkgICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBmdW5jdGlvbiBjYWxsYmFjayB3aGljaCB3aWxsIGJlIGludm9rZWQKCSAgICAqIEByZXR1cm4ge09iamVjdDxVUkwsIERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBvbmUgb2JqZWN0IHdpdGggYWxsIHJlc3VtZWQgcmVwb3J0ZXJzOwoJICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25SZXBvcnRlcnNSZXN1bWUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlcG9ydGVyc1Jlc3VtZShjYWxsYmFjaykgewoJICAgICAgdGhpcy5fb25SZXBvcnRlcnNSZXN1bWUgPSBjYWxsYmFjazsKCSAgICB9CgoJICAgIC8qKgoJICAgICogQ2FsbGJhY2sgc3lzdGVtIHRvIHRyaWdnZXIgdGhlIHJlc3VtZWQgb2JzZXJ2ZXJzCgkgICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBmdW5jdGlvbiBjYWxsYmFjayB3aGljaCB3aWxsIGJlIGludm9rZWQKCSAgICAqIEByZXR1cm4ge09iamVjdDxVUkwsIERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBvbmUgb2JqZWN0IHdpdGggYWxsIHJlc3VtZWQgb2JzZXJ2ZXJzOwoJICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25PYnNlcnZlcnNSZXN1bWUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBvbk9ic2VydmVyc1Jlc3VtZShjYWxsYmFjaykgewoJICAgICAgdGhpcy5fb25PYnNlcnZlcnNSZXN1bWUgPSBjYWxsYmFjazsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdvd25lcicsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fb3duZXI7CgkgICAgfQoKCSAgICAvKioKCSAgICAqIEFsbCBvd25lZCByZXBvcnRlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgY3JlYXRlCgkgICAgKiBAdHlwZSB7T2JqZWN0PFVSTCwgRGF0YU9iamVjdFJlcG9ydGVyPn0KCSAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3JlcG9ydGVycycsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fcmVwb3J0ZXJzOwoJICAgIH0KCgkgICAgLyoqCgkgICAgKiBBbGwgb3duZWQgb2JzZXJ2ZXJzLCB0aGUgb25lcyB0aGF0IHdlcmUgY3JlYXRlZCBieSBhIGxvY2FsIHN1YnNjcmlwdGlvbgoJICAgICogQHR5cGUge09iamVjdDxVUkwsIERhdGFPYmplY3RPYnNlcnZlcj59CgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvYnNlcnZlcnMnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX29ic2VydmVyczsKCSAgICB9CgkgIH1dKTsKCSAgcmV0dXJuIFN5bmNoZXI7Cgl9KCk7CgoJZXhwb3J0cy5kZWZhdWx0ID0gU3luY2hlcjsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0pLAoJLyogMTM0ICovLAoJLyogMTM1ICovLAoJLyogMTM2ICovLAoJLyogMTM3ICovLAoJLyogMTM4ICovLAoJLyogMTM5ICovLAoJLyogMTQwICovLAoJLyogMTQxICovLAoJLyogMTQyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gZXhwb3J0cy5EYXRhT2JqZWN0UmVwb3J0ZXIgPSBleHBvcnRzLlN5bmNoZXIgPSB1bmRlZmluZWQ7CgoJdmFyIF9TeW5jaGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzMpOwoKCXZhciBfU3luY2hlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9TeW5jaGVyKTsKCgl2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTIyKTsKCgl2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKCXZhciBfRGF0YU9iamVjdE9ic2VydmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjEpOwoKCXZhciBfRGF0YU9iamVjdE9ic2VydmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RPYnNlcnZlcik7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLlN5bmNoZXIgPSBfU3luY2hlcjIuZGVmYXVsdDsKCWV4cG9ydHMuRGF0YU9iamVjdFJlcG9ydGVyID0gX0RhdGFPYmplY3RSZXBvcnRlcjIuZGVmYXVsdDsKCWV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdDsKCgkvKioqLyB9KSwKCS8qIDE0MyAqLywKCS8qIDE0NCAqLywKCS8qIDE0NSAqLywKCS8qIDE0NiAqLywKCS8qIDE0NyAqLywKCS8qIDE0OCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKCXZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8qKgoJKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKCSogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKCSogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCgkqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCgkqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoJKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCgkqIENvcHlyaWdodCAyMDE2IEFwaXplZQoJKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoJKgoJKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSoKCSogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSoKCSogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSoqLwoKCS8qKgoJICogQGFjY2VzcyBwcml2YXRlCgkgKiBUaGlzIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvciBjb2xsZWN0aW5nIGRlbHRhIGNoYW5nZXMgaW4gcmVtb3RlIG9iamVjdHMsIGJlZm9yZSB0aGUgcmVzcG9uc2Ugb2Ygc3Vic2NyaXB0aW9uIHJlYWNoIHRoZSBvYnNlcnZlci4KCSAqIEl0J3MgdXNlZCBpbiBTeW5jaGVyIC0+IHN1YnNjcmliZS4gVGhlIGZsb3cgaXMgZGVmaW5lZCBhczoKCSAqIDEuIChvYnNlcnZlcikgLS1zdWJzY3JpYmUtLT4gKHJlcG9ydGVyKQoJICogMi4gKG9ic2VydmVyKSA8LS1kZWx0YSB1cGRhdGVzLS0gKHJlcG9ydGVyKQoJICogMy4gKG9ic2VydmVyKSA8LS1zdWJzY3JpYmUgcmVzcG9uc2UtLSAocmVwb3J0ZXIpCgkgKiBUaGlzIG1lYW5zIHRoYXQgdGhlcmUgY291bGQgYmUgZGVsdGEgdXBkYXRlcyB0cmFuc2ZlcnJlZCBiZWZvcmUgdGhlIHN1YnNjcmlwdGlvbiBjb25maXJtYXRpb24uCgkgKiBTaW5jZSB0aGVyZSBpcyBubyBEYXRhT2JqZWN0T2JzZXJ2ZXIgYmVmb3JlIHRoZSB1YnNjcmlwdGlvbiBjb25maXJtYXRpb24sIHRoZXJlIHNob3VsZCBiZSBzb21lIG90aGVyIG9iamVjdCBjb2xsZWN0aW5nIHRoZSB1cGRhdGVzLgoJICogUHJvdmlzaW9uYWwgZGF0YSBpcyBhcHBsaWVkIHRvIHRoZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgYWZ0ZXIgY29uZmlybWF0aW9uLiBPciBkaXNjYXJkZWQgaWYgdGhlcmUgaXMgbm8gY29uZmlybWF0aW9uLgoJICovCgl2YXIgRGF0YVByb3Zpc2lvbmFsID0gZnVuY3Rpb24gKCkgewoJICAvKiBwcml2YXRlCgkgIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXQoJICBfbGlzdGVuZXI6IE1zZ0xpc3RlbmVyCgkgICBfY2hhbmdlczogW10KCSAgKi8KCgkgIGZ1bmN0aW9uIERhdGFQcm92aXNpb25hbChvd25lciwgdXJsLCBidXMsIGNoaWxkcmVuKSB7CgkgICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YVByb3Zpc2lvbmFsKTsKCgkgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgX3RoaXMuX293bmVyID0gb3duZXI7CgkgICAgX3RoaXMuX3VybCA9IHVybDsKCSAgICBfdGhpcy5fYnVzID0gYnVzOwoJICAgIF90aGlzLl9jaGlsZHJlbiA9IGNoaWxkcmVuOwoKCSAgICBfdGhpcy5fY2hhbmdlcyA9IFtdOwoJICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwoJICB9CgoJICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhUHJvdmlzaW9uYWwsIFt7CgkgICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgICAgY29uc29sZS5sb2coJ0RhdGFQcm92aXNpb25hbC0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwoJICAgICAgICBfdGhpcy5fY2hhbmdlcy5wdXNoKG1zZyk7CgkgICAgICB9KTsKCgkgICAgICAvKgoJICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzID0gW107CgkgICAgICBpZiAoX3RoaXMuX2NoaWxkcmVuKSB7CgkgICAgICAgIGxldCBjaGlsZEJhc2VVUkwgPSB1cmwgKyAnL2NoaWxkcmVuLyc7CgkgICAgICAgIF90aGlzLl9jaGlsZHJlbi5mb3JFYWNoKChjaGlsZCkgPT4gewoJICAgICAgICAgIGxldCBjaGlsZFVSTCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOwoJICAgICAgICAgIGxldCBsaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoY2hpbGRVUkwsIChtc2cpID0+IHsKCSAgICAgICAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKCSAgICAgICAgICAgIGlmIChtc2cuZnJvbSAhPT0gb3duZXIpIHsKCSAgICAgICAgICAgICAgY29uc29sZS5sb2cobXNnKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9KTsKCSAgICAgICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpOwoJICAgICAgICB9KTsKCSAgICAgIH0qLwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKCgkgICAgICAvKl90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5mb3JFYWNoKChsaXN0ZW5lcikgPT4gewoJICAgICAgICBsaXN0ZW5lci5yZW1vdmUoKTsKCSAgICAgIH0pOyovCgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnYXBwbHknLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBseShvYnNlcnZlcikgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCSAgICAgIF90aGlzLl9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZSkgewoJICAgICAgICBvYnNlcnZlci5fY2hhbmdlT2JqZWN0KG9ic2VydmVyLl9zeW5jT2JqLCBjaGFuZ2UpOwoJICAgICAgfSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnY2hpbGRyZW4nLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuOwoJICAgIH0KCSAgfV0pOwoJICByZXR1cm4gRGF0YVByb3Zpc2lvbmFsOwoJfSgpOwoKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFQcm92aXNpb25hbDsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0pLAoJLyogMTQ5ICovLAoJLyogMTUwICovLAoJLyogMTUxICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygxNTgpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiAxNTIgKi8sCgkvKiAxNTMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2MCksIF9fZXNNb2R1bGU6IHRydWUgfTsKCgkvKioqLyB9KSwKCS8qIDE1NCAqLywKCS8qIDE1NSAqLywKCS8qIDE1NiAqLywKCS8qIDE1NyAqLywKCS8qIDE1OCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oMTY0KTsKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3QuYXNzaWduOwoKCS8qKiovIH0pLAoJLyogMTU5ICovLAoJLyogMTYwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygxNjYpOwoJdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpewoJICByZXR1cm4gJE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMTYxICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCS8vIDE5LjEuMi4xIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBzb3VyY2UsIC4uLikKCXZhciBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpCgkgICwgZ09QUyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU4KQoJICAsIHBJRSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkKCSAgLCB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCgkgICwgSU9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU2KQoJICAsICRhc3NpZ24gID0gT2JqZWN0LmFzc2lnbjsKCgkvLyBzaG91bGQgd29yayB3aXRoIHN5bWJvbHMgYW5kIHNob3VsZCBoYXZlIGRldGVybWluaXN0aWMgcHJvcGVydHkgb3JkZXIgKFY4IGJ1ZykKCW1vZHVsZS5leHBvcnRzID0gISRhc3NpZ24gfHwgX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKCSAgdmFyIEEgPSB7fQoJICAgICwgQiA9IHt9CgkgICAgLCBTID0gU3ltYm9sKCkKCSAgICAsIEsgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3QnOwoJICBBW1NdID0gNzsKCSAgSy5zcGxpdCgnJykuZm9yRWFjaChmdW5jdGlvbihrKXsgQltrXSA9IGs7IH0pOwoJICByZXR1cm4gJGFzc2lnbih7fSwgQSlbU10gIT0gNyB8fCBPYmplY3Qua2V5cygkYXNzaWduKHt9LCBCKSkuam9pbignJykgIT0gSzsKCX0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycwoJICB2YXIgVCAgICAgPSB0b09iamVjdCh0YXJnZXQpCgkgICAgLCBhTGVuICA9IGFyZ3VtZW50cy5sZW5ndGgKCSAgICAsIGluZGV4ID0gMQoJICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZgoJICAgICwgaXNFbnVtICAgICA9IHBJRS5mOwoJICB3aGlsZShhTGVuID4gaW5kZXgpewoJICAgIHZhciBTICAgICAgPSBJT2JqZWN0KGFyZ3VtZW50c1tpbmRleCsrXSkKCSAgICAgICwga2V5cyAgID0gZ2V0U3ltYm9scyA/IGdldEtleXMoUykuY29uY2F0KGdldFN5bWJvbHMoUykpIDogZ2V0S2V5cyhTKQoJICAgICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAoJICAgICAgLCBqICAgICAgPSAwCgkgICAgICAsIGtleTsKCSAgICB3aGlsZShsZW5ndGggPiBqKWlmKGlzRW51bS5jYWxsKFMsIGtleSA9IGtleXNbaisrXSkpVFtrZXldID0gU1trZXldOwoJICB9IHJldHVybiBUOwoJfSA6ICRhc3NpZ247CgoJLyoqKi8gfSksCgkvKiAxNjIgKi8sCgkvKiAxNjMgKi8sCgkvKiAxNjQgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjMuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlKQoJdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKCSRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GLCAnT2JqZWN0Jywge2Fzc2lnbjogX193ZWJwYWNrX3JlcXVpcmVfXygxNjEpfSk7CgoJLyoqKi8gfSksCgkvKiAxNjUgKi8sCgkvKiAxNjYgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApCgl2YXIgdG9JT2JqZWN0ICAgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCgkgICwgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IF9fd2VicGFja19yZXF1aXJlX18oNTcpLmY7CgoJX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2dldE93blByb3BlcnR5RGVzY3JpcHRvcicsIGZ1bmN0aW9uKCl7CgkgIHJldHVybiBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7CgkgICAgcmV0dXJuICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodG9JT2JqZWN0KGl0KSwga2V5KTsKCSAgfTsKCX0pOwoKCS8qKiovIH0pCgkvKioqKioqLyBdKTsKCX0pOwoJLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTg7YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0p6YjNWeVkyVnpJanBiSW5kbFluQmhZMnM2THk4dmQyVmljR0ZqYXk5MWJtbDJaWEp6WVd4TmIyUjFiR1ZFWldacGJtbDBhVzl1UHpWallUWWlMQ0ozWldKd1lXTnJPaTh2TDNkbFluQmhZMnN2WW05dmRITjBjbUZ3SURJME1UQTBZemxtTVRSbE1EaGpNRGd3WWpZeFAyRTJZelVpTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZMjl5WlM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5bmJHOWlZV3d1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWkdWelkzSnBjSFJ2Y25NdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmQydHpMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMjlpYW1WamRDMWtjQzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTloYmkxdlltcGxZM1F1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYVhNdGIySnFaV04wTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJocFpHVXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlpWVdKbGJDMXlkVzUwYVcxbEwyaGxiSEJsY25NdlkyeGhjM05EWVd4c1EyaGxZMnN1YW5NL01qRmhaaUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWxlSEJ2Y25RdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJobGJIQmxjbk12WTNKbFlYUmxRMnhoYzNNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZlptRnBiSE11YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYUdGekxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzUnZMV2x2WW1wbFkzUXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZM1I0TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDNCeWIzQmxjblI1TFdSbGMyTXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhWFJsY21GMGIzSnpMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMlJ2YlMxamNtVmhkR1V1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMV3RsZVhNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZllTMW1kVzVqZEdsdmJpNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWpiMll1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmZEc4dGNISnBiV2wwYVhabExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzTmxkQzEwYnkxemRISnBibWN0ZEdGbkxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzVnBaQzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlrWldacGJtVmtMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMmxsT0Mxa2IyMHRaR1ZtYVc1bExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyeHBZbkpoY25rdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmMyaGhjbVZrTFd0bGVTNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOTBieTFwYm5SbFoyVnlMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMlZ1ZFcwdFluVm5MV3RsZVhNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmMyaGhjbVZrTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlqYjNKbExXcHpMMjlpYW1WamRDOW5aWFF0Y0hKdmRHOTBlWEJsTFc5bUxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzUnZMVzlpYW1WamRDNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMkpoWW1Wc0xYSjFiblJwYldVdlkyOXlaUzFxY3k5dlltcGxZM1F2WkdWbWFXNWxMWEJ5YjNCbGNuUjVMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOW9aV3h3WlhKekwybHVhR1Z5YVhSekxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZbUZpWld3dGNuVnVkR2x0WlM5b1pXeHdaWEp6TDNCdmMzTnBZbXhsUTI5dWMzUnlkV04wYjNKU1pYUjFjbTR1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmIySnFaV04wTDJSbFptbHVaUzF3Y205d1pYSjBlUzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl2WW1wbFkzUXRZM0psWVhSbExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNWtaV1pwYm1VdGNISnZjR1Z5ZEhrdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFYUmxjaTFrWldacGJtVXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlpWVdKbGJDMXlkVzUwYVcxbEwyTnZjbVV0YW5NdmFuTnZiaTl6ZEhKcGJtZHBabmt1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMWEJwWlM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5b2RHMXNMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMjlpYW1WamRDMW5jRzh1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMV3RsZVhNdGFXNTBaWEp1WVd3dWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmIySnFaV04wTFhOaGNDNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXlaV1JsWm1sdVpTNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOTBieTFzWlc1bmRHZ3Vhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZkMnR6TFdSbFptbHVaUzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTkzYTNNdFpYaDBMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZaWE0yTG5OMGNtbHVaeTVwZEdWeVlYUnZjaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMM2RsWWk1a2IyMHVhWFJsY21GaWJHVXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2YW5OdmJpOXpkSEpwYm1kcFpua3Vhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZMnhoYzNOdlppNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXBiMkpxWldOMExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyOWlhbVZqZEMxbmIzQmtMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMjlpYW1WamRDMW5iM0J6TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlvWld4d1pYSnpMM1I1Y0dWdlppNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWhaR1F0ZEc4dGRXNXpZMjl3WVdKc1pYTXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZWEp5WVhrdGFXNWpiSFZrWlhNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFYUmxjaTFqY21WaGRHVXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhWFJsY2kxemRHVndMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMjlpYW1WamRDMWtjSE11YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMV2R2Y0c0dWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmMzUnlhVzVuTFdGMExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzUmhjMnN1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmZEc4dGFXNWtaWGd1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlsY3pZdVlYSnlZWGt1YVhSbGNtRjBiM0l1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMk52Y21VdGFuTXZiMkpxWldOMEwydGxlWE11YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2YzNKakwzVjBhV3h6TDNWMGFXeHpMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOWpiM0psTFdwekwzQnliMjFwYzJVdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmJXVjBZUzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMk52Y21VdVoyVjBMV2wwWlhKaGRHOXlMVzFsZEdodlpDNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMkpoWW1Wc0xYSjFiblJwYldVdlkyOXlaUzFxY3k5dlltcGxZM1F2WTNKbFlYUmxMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOWpiM0psTFdwekwyOWlhbVZqZEM5elpYUXRjSEp2ZEc5MGVYQmxMVzltTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlqYjNKbExXcHpMM041YldKdmJDNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMkpoWW1Wc0xYSjFiblJwYldVdlkyOXlaUzFxY3k5emVXMWliMnd2YVhSbGNtRjBiM0l1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmIySnFaV04wTDJOeVpXRjBaUzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzltYmk5dlltcGxZM1F2WjJWMExYQnliM1J2ZEhsd1pTMXZaaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzltYmk5dlltcGxZM1F2YTJWNWN5NXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOW1iaTl2WW1wbFkzUXZjMlYwTFhCeWIzUnZkSGx3WlMxdlppNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOW1iaTl3Y205dGFYTmxMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMlp1TDNONWJXSnZiQzlwYm1SbGVDNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOW1iaTl6ZVcxaWIyd3ZhWFJsY21GMGIzSXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZVzR0YVc1emRHRnVZMlV1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWlc1MWJTMXJaWGx6TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJadmNpMXZaaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlwYm5admEyVXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhWE10WVhKeVlYa3RhWFJsY2k1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5cGN5MWhjbkpoZVM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5cGRHVnlMV05oYkd3dWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFYUmxjaTFrWlhSbFkzUXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhMlY1YjJZdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmJXbGpjbTkwWVhOckxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyOWlhbVZqZEMxbmIzQnVMV1Y0ZEM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5eVpXUmxabWx1WlMxaGJHd3Vhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZjMlYwTFhCeWIzUnZMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM05sZEMxemNHVmphV1Z6TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDNOd1pXTnBaWE10WTI5dWMzUnlkV04wYjNJdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5bGN6WXViMkpxWldOMExtTnlaV0YwWlM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDJWek5pNXZZbXBsWTNRdVoyVjBMWEJ5YjNSdmRIbHdaUzF2Wmk1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDJWek5pNXZZbXBsWTNRdWEyVjVjeTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMlZ6Tmk1dlltcGxZM1F1YzJWMExYQnliM1J2ZEhsd1pTMXZaaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMlZ6Tmk1d2NtOXRhWE5sTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNMkxuTjViV0p2YkM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDJWek55NXplVzFpYjJ3dVlYTjVibU10YVhSbGNtRjBiM0l1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlsY3pjdWMzbHRZbTlzTG05aWMyVnlkbUZpYkdVdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmMzSmpMM041Ym1Ob1pYSXZSR0YwWVU5aWFtVmpkRU5vYVd4a0xtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZjSEp2ZUhrdGIySnpaWEoyWlM5cGJtUmxlQzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTl6Y21NdmMzbHVZMmhsY2k5RVlYUmhUMkpxWldOMFQySnpaWEoyWlhJdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmMzSmpMM041Ym1Ob1pYSXZSR0YwWVU5aWFtVmpkRkpsY0c5eWRHVnlMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMM055WXk5emVXNWphR1Z5TDBSaGRHRlBZbXBsWTNRdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmMzSmpMM041Ym1Ob1pYSXZVSEp2ZUhsUFltcGxZM1F1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMmhsYkhCbGNuTXZaMlYwTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDNOeVl5OXplVzVqYUdWeUwxTjVibU5vWlhJdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmMzSmpMMU41Ym1Ob1pYSXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZjM0pqTDNONWJtTm9aWEl2UkdGMFlWQnliM1pwYzJsdmJtRnNMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOWpiM0psTFdwekwyOWlhbVZqZEM5aGMzTnBaMjR1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMk52Y21VdGFuTXZiMkpxWldOMEwyZGxkQzF2ZDI0dGNISnZjR1Z5ZEhrdFpHVnpZM0pwY0hSdmNpNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOW1iaTl2WW1wbFkzUXZZWE56YVdkdUxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMjlpYW1WamRDOW5aWFF0YjNkdUxYQnliM0JsY25SNUxXUmxjMk55YVhCMGIzSXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZiMkpxWldOMExXRnpjMmxuYmk1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDJWek5pNXZZbXBsWTNRdVlYTnphV2R1TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNMkxtOWlhbVZqZEM1blpYUXRiM2R1TFhCeWIzQmxjblI1TFdSbGMyTnlhWEIwYjNJdWFuTWlYU3dpYm1GdFpYTWlPbHNpWkdsMmFXUmxWVkpNSWl3aVpHbDJhV1JsUlcxaGFXd2lMQ0psYlhCMGVVOWlhbVZqZENJc0ltUmxaWEJEYkc5dVpTSXNJbWRsZEZWelpYSlZVa3hHY205dFJXMWhhV3dpTENKblpYUlZjMlZ5UlcxaGFXeEdjbTl0VlZKTUlpd2lZMjl1ZG1WeWRGUnZWWE5sY2xWU1RDSXNJbU5vWldOclFYUjBjbWxpZFhSbElpd2ljR0Z5YzJWQmRIUnlhV0oxZEdWeklpd2lkWEpzSWl3aVJYSnliM0lpTENKeVpXTjFjbk5sSWl3aWRtRnNkV1VpTENKeVpXZGxlQ0lzSW5OMVluTjBJaXdpY0dGeWRITWlMQ0p5WlhCc1lXTmxJaXdpYzNCc2FYUWlMQ0pwYm1Oc2RXUmxjeUlzSW5KbGMzVnNkQ0lzSW5SNWNHVWlMQ0prYjIxaGFXNGlMQ0pwWkdWdWRHbDBlU0lzSW1OdmJuTnZiR1VpTENKbGNuSnZjaUlzSW5OamFHVnRaU0lzSW5OMVluTjBjaUlzSW1sdVpHVjRUMllpTENKbGJXRnBiQ0lzSW1sdVpHVjRUMlpCZENJc0luVnpaWEp1WVcxbElpd2ljM1ZpYzNSeWFXNW5JaXdpYkdWdVozUm9JaXdpYjJKcVpXTjBJaXdpYjJKcUlpd2lTbE5QVGlJc0luQmhjbk5sSWl3aWRYTmxja1Z0WVdsc0lpd2lkWE5sY2xWU1RDSXNJbWxrWlc1MGFXWnBaWElpTENKa2FYWnBaR1ZrVlZKTUlpd2ljR0YwYUNJc0lteHBjM1FpTENKbWFXNWhiQ0lzSW5SbGMzUWlMQ0p0WVhSamFDSXNJbTBpTENKbGVHVmpJaXdpYVc1a1pYZ2lMQ0pzWVhOMFNXNWtaWGdpTENKbWIzSkZZV05vSWl3aVozSnZkWEJKYm1SbGVDSXNJbkIxYzJnaUxDSnRZWEFpTENKcGRHVnRJaXdpYkc5bklpd2ljM1J5YVc1bk15SXNJbk4wY21sdVp6RWlMQ0poY25KaGVURWlMQ0p6ZEhKcGJtY3lJaXdpWVhKeVlYa3lJaXdpYzJ4cFkyVWlMQ0pqYjI1allYUWlMQ0ptYVd4MFpYSWlMQ0pDYjI5c1pXRnVJaXdpUkdGMFlVOWlhbVZqZEVOb2FXeGtJaXdpY0dGeVpXNTBJaXdpWTJocGJHUkpaQ0lzSW1sdWFYUnBZV3hFWVhSaElpd2liM2R1WlhJaUxDSnRjMmRKWkNJc0lsOTBhR2x6SWl3aVgzQmhjbVZ1ZENJc0lsOWphR2xzWkVsa0lpd2lYMjkzYm1WeUlpd2lYMjF6WjBsa0lpd2lYM041Ym1OUFltb2lMQ0pmWW5Weklpd2lYMkZzYkc5allYUmxUR2x6ZEdWdVpYSnpJaXdpWDJ4cGMzUmxibVZ5SWl3aVlXUmtUR2x6ZEdWdVpYSWlMQ0p0YzJjaUxDSnBaQ0lzSWw5dmJsSmxjM0J2Ym5ObElpd2ljbVZ0YjNabElpd2lYMk5vYVd4a2NtVnVJaXdpWDNKbGJHVmhjMlZNYVhOMFpXNWxjbk1pTENKallXeHNZbUZqYXlJc0ltOWljMlZ5ZG1VaUxDSmxkbVZ1ZENJc0lsOXZibEpsYzNCdmJuTmxTR0Z1Wkd4bGNpSXNJbUp2WkhraUxDSnpiM1Z5WTJVaUxDSmpiMlJsSWl3aVpHRjBZU0lzSWw5cFpHVnVkR2wwZVNJc0lrWnBiSFJsY2xSNWNHVWlMQ0pCVGxraUxDSlRWRUZTVkNJc0lrVllRVU5VSWl3aVJHRjBZVTlpYW1WamRFOWljMlZ5ZG1WeUlpd2ljM2x1WTJobGNpSXNJbk5qYUdWdFlTSXNJbWx1YVhScFlXeFRkR0YwZFhNaUxDSmphR2xzWkhKbGJuTWlMQ0pwYm1sMGFXRnNWbVZ5YzJsdmJpSXNJbTExZEhWaGJDSXNJbkpsYzNWdFpXUWlMQ0pmZG1WeWMybHZiaUlzSWw5bWFXeDBaWEp6SWl3aVgyOXVSbWxzZEdWeUlpd2lZMmhwYkdSSlpGTjBjbWx1WnlJc0ltTm9hV3hrY21WdVVtVnpiM1Z5WTJVaUxDSmphR2xzWkhKbGJpSXNJbDl5WlhOMWJXVmtJaXdpWDJOb2FXeGtjbVZ1VDJKcVpXTjBjeUlzSWs1MWJXSmxjaUlzSWw5amFHRnVaMlZNYVhOMFpXNWxjaUlzSWw5MWNtd2lMQ0pmWTJoaGJtZGxUMkpxWldOMElpd2lYM041Ym1Ob1pYSWlMQ0pmYjJKelpYSjJaWEp6SWl3aWRXNVRkV0p6WTNKcFltVk5jMmNpTENKbWNtOXRJaXdpZEc4aUxDSmZjM1ZpVlZKTUlpd2ljbVZ6YjNWeVkyVWlMQ0p3YjNOMFRXVnpjMkZuWlNJc0luSmxjR3g1SWl3aWEyVjVJaXdpWm1sc2RHVnlUMkpxSWl3aWFXUjRJaXdpWm1sbGJHUWlMQ0pFWVhSaFQySnFaV04wVW1Wd2IzSjBaWElpTENKZmMzVmljMk55YVhCMGFXOXVjeUlzSWw5dmJrTm9ZVzVuWlNJc0lsOXZZbXBsWTNSTWFYTjBaVzVsY2lJc0lsOXZibEpsWVdRaUxDSnZZbk5sY25abGNuTWlMQ0pwYm5acGRHVk5jMmNpTENKeVpYTjFiV1VpTENKZmMyTm9aVzFoSWl3aVlYVjBhRzl5YVhObElpd2laR1ZzWlhSbFRYTm5JaXdpWDNKbGNHOXlkR1Z5Y3lJc0lsOXZibE4xWW5OamNtbHdkR2x2YmtoaGJtUnNaWElpTENKZmIyNVNaV0ZrU0dGdVpHeGxjaUlzSWw5dmJsTjFZbk5qY21saVpTSXNJbDl2YmxWdVUzVmljMk55YVdKbElpd2lhSGx3WlhKMGVWVnliQ0lzSW1GalkyVndkQ0lzSW5OMVlpSXNJbk4wWVhSMWN5SXNJbU5vYVd4a2NtVnVWbUZzZFdWeklpd2lZMmhwYkdSRVlYUmhJaXdpYzJWdVpFMXpaeUlzSW5abGNuTnBiMjRpTENKb1lYTlBkMjVRY205d1pYSjBlU0lzSW0xMWRIVmhiRUYxZEdobGJuUnBZMkYwYVc5dUlpd2lYMjExZEhWaGJFRjFkR2hsYm5ScFkyRjBhVzl1SWl3aWNtVnFaV04wSWl3aWNtVmhjMjl1SWl3aVpHVnpZeUlzSWtSaGRHRlBZbXBsWTNRaUxDSmZjM1JoZEhWeklpd2lYMk5vYVd4a2NtVnVjeUlzSWw5amFHbHNaSEpsYmt4cGMzUmxibVZ5Y3lJc0ltTm9hV3hrU1dSSmJuUWlMQ0pqYUdsc1pFSmhjMlZWVWt3aUxDSmphR2xzWkNJc0ltTm9hV3hrVlZKTUlpd2liR2x6ZEdWdVpYSWlMQ0pmYjI1RGFHbHNaRU55WldGMFpTSXNJbDlqYUdGdVoyVkRhR2xzWkhKbGJpSXNJbTF6WjBOb2FXeGtTV1FpTENKdGMyZERhR2xzWkZCaGRHZ2lMQ0p5WlhGMVpYTjBUWE5uSWl3aWNtVnpiMngyWlNJc0ltNWxkME5vYVd4a0lpd2liMjVEYUdGdVoyVWlMQ0pmYjI1QlpHUkRhR2xzWkhKbGJraGhibVJzWlhJaUxDSnpaWFJVYVcxbGIzVjBJaXdpWTJocGJHUkpibVp2SWl3aVkyaGhibWRsVFhObklpd2lZWFIwY21saWRYUmxJaXdpYjFSNWNHVWlMQ0pQUWtwRlExUWlMQ0pqVkhsd1pTSXNJbEpGVFU5V1JTSXNJbUYwZEhKcFluVjBaVlI1Y0dVaUxDSlZVRVJCVkVVaUxDSnZjR1Z5WVhScGIyNGlMQ0p6ZVc1alQySnFJaXdpWm1sdVpGSmxjM1ZzZENJc0ltWnBibVJDWldadmNtVWlMQ0pCVWxKQldTSXNJa0ZFUkNJc0ltRnljaUlzSW14aGMzUWlMQ0pCY25KaGVTSXNJbkJ5YjNSdmRIbHdaU0lzSW5Od2JHbGpaU0lzSW1Gd2NHeDVJaXdpYjJKcVpXTjBWSGx3WlNJc0lsTjVibU5QWW1wbFkzUWlMQ0pmWkdGMFlTSXNJbDlwYm5SbGNtNWhiRTlpYzJWeWRtVWlMQ0pmWm1sdVpGZHBkR2hUY0d4cGRDSXNJbkJ2Y0NJc0ltaGhibVJzWlhJaUxDSmphR0Z1WjJWelpYUWlMQ0psZG1WeWVTSXNJbU5vWVc1blpTSXNJbDl2YmtOb1lXNW5aWE1pTENKUFltcGxZM1FpTENKa1pXVndUMkp6WlhKMlpTSXNJbTlpYWxSNWNHVWlMQ0pqYjI1emRISjFZM1J2Y2lJc0lrOWlhbVZqZEZSNWNHVWlMQ0ptYVdWc1pGTjBjbWx1WnlJc0ltdGxlWEJoZEdnaUxDSnVaWGRXWVd4MVpTSXNJbTVoYldVaUxDSmZabWx5WlVWMlpXNTBJaXdpUTJoaGJtZGxWSGx3WlNJc0lsTjVibU5vWlhJaUxDSmlkWE1pTENKamIyNW1hV2NpTENKeWRXNTBhVzFsVlZKTUlpd2lYM0J5YjNacGMybHZibUZzY3lJc0ltbHVabThpTENKZmIyNUdiM0ozWVhKa0lpd2lYMjl1VW1WdGIzUmxRM0psWVhSbElpd2lYMjl1VW1WdGIzUmxSR1ZzWlhSbElpd2ljM1J2Y21VaUxDSndNbkFpTENKamNtbDBaWEpwWVNJc0lsOWpjbVZoZEdVaUxDSmZjbVZ6ZFcxbFEzSmxZWFJsSWl3aWIySnFWVkpNSWl3aVgzTjFZbk5qY21saVpTSXNJbDlqY21sMFpYSnBZU0lzSWw5eVpYTjFiV1ZUZFdKelkzSnBZbVVpTENKeVpXRmtUWE5uSWl3aVgyOXVUbTkwYVdacFkyRjBhVzl1U0dGdVpHeGxjaUlzSW5KbGNHOXlkR1Z5SWl3aWJtVjNUMkpxSWl3aVkyaHBiR1J5Wlc1U1pYTnZkWEpqWlhNaUxDSnNhWE4wVDJaU1pYQnZjblJsY25NaUxDSmtZWFJoVDJKcVpXTjBJaXdpYVc1cGRDSXNJbkpsYzNWdFpVTm9hV3hrY21WdWN5SXNJbDl2YmxKbGNHOXlkR1Z5YzFKbGMzVnRaU0lzSW5OMVluTmpjbWxpWlUxelp5SXNJbTVsZDFCeWIzWnBjMmx2Ym1Gc0lpd2liR2x6ZEU5bVQySnpaWEoyWlhKeklpd2lYMjl1VDJKelpYSjJaWEp6VW1WemRXMWxJaXdpWVdOcklpd2liRlI1Y0dVaUxDSmtaV3hsZEdVaUxDSkVZWFJoVUhKdmRtbHphVzl1WVd3aUxDSmZZMmhoYm1kbGN5SXNJbTlpYzJWeWRtVnlJbDBzSW0xaGNIQnBibWR6SWpvaVFVRkJRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc01rSkJRVEpDTzBGQlF6TkNMRU5CUVVNN1FVRkRSQ3hQTzBGRFZrRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHM3UVVGRlFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHM3TzBGQlIwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk96dEJRVVZCTzBGQlEwRXNiVVJCUVRKRExHTkJRV003TzBGQlJYcEVPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNZVUZCU3p0QlFVTk1PMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRXNiVU5CUVRKQ0xEQkNRVUV3UWl4RlFVRkZPMEZCUTNaRUxIbERRVUZwUXl4bFFVRmxPMEZCUTJoRU8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJMRGhFUVVGelJDd3JSRUZCSzBRN08wRkJSWEpJTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHM3T3pzN096dEJRMmhGUVN3MlFrRkJOa0k3UVVGRE4wSXNjVU5CUVhGRExHZERPenM3T3pzN1FVTkVja003UVVGRFFUdEJRVU5CTzBGQlEwRXNkVU5CUVhWRExHZERPenM3T3pzN1FVTklka003UVVGRFFUdEJRVU5CTEdsRFFVRnBReXhSUVVGUkxHZENRVUZuUWl4VlFVRlZMRWRCUVVjN1FVRkRkRVVzUTBGQlF5eEZPenM3T3pzN1FVTklSRHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFTeDFRanM3T3pzN08wRkRWa0U3UVVGRFFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnl4VlFVRlZPMEZCUTJJN1FVRkRRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEWmtFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEZPenM3T3pzN1FVTktRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEUmtFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeERRVUZETzBGQlEwUTdRVUZEUVR0QlFVTkJMRVU3T3pzN096czdRVU5RUVRzN1FVRkZRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMUpCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3h0UlVGQmJVVTdRVUZEYmtVN1FVRkRRU3h4UmtGQmNVWTdRVUZEY2tZN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxGZEJRVmM3UVVGRFdDeFRRVUZUTzBGQlExUTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hMUVVGTE8wRkJRMHc3UVVGRFFUdEJRVU5CTEN0RFFVRXJRenRCUVVNdlF6dEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hqUVVGak8wRkJRMlFzWTBGQll6dEJRVU5rTEdOQlFXTTdRVUZEWkN4alFVRmpPMEZCUTJRc1pVRkJaVHRCUVVObUxHVkJRV1U3UVVGRFppeGxRVUZsTzBGQlEyWXNaMEpCUVdkQ08wRkJRMmhDTEhsQ096czdPenM3TzBGRE5VUkJPenRCUVVWQk96dEJRVVZCT3p0QlFVVkJPenRCUVVWQkxITkRRVUZ6UXl4MVEwRkJkVU1zWjBKQlFXZENPenRCUVVVM1JqdEJRVU5CTzBGQlEwRXNiVUpCUVcxQ0xHdENRVUZyUWp0QlFVTnlRenRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNRMEZCUXl4SE96czdPenM3UVVNeFFrUTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSU8wRkJRMEU3UVVGRFFTeEZPenM3T3pzN1FVTk9RU3gxUWtGQmRVSTdRVUZEZGtJN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEwaEJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEZPenM3T3pzN1FVTk1RVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEyNUNRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMUJCTEc5Q096czdPenM3UVVOQlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hGT3pzN096czdRVU5PUVR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTA1Qk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTBoQkxHbENRVUZwUWpzN1FVRkZha0k3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTBwQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEZPenM3T3pzN1FVTllRVHRCUVVOQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVN4clJVRkJhMFVzSzBKQlFTdENPMEZCUTJwSExFVTdPenM3T3p0QlEwNUJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEU2tFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEZPenM3T3pzN1FVTktRVHRCUVVOQkxIRkZRVUZ6UlN4blFrRkJaMElzVlVGQlZTeEhRVUZITzBGQlEyNUhMRU5CUVVNc1JUczdPenM3TzBGRFJrUXNjMEk3T3pzN096dEJRMEZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRFNrRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEweEJPMEZCUTBFN1FVRkRRVHRCUVVOQkxHRTdPenM3T3p0QlEwaEJPMEZCUTBFN1FVRkRRU3h0UkVGQmJVUTdRVUZEYmtRN1FVRkRRU3gxUTBGQmRVTTdRVUZEZGtNc1JUczdPenM3TzBGRFRFRXNhMEpCUVd0Q0xIZEVPenM3T3pzN1FVTkJiRUk3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3UVVOS1FTeHJRa0ZCYTBJc2QwUTdPenM3T3pzN1FVTkJiRUk3TzBGQlJVRTdPMEZCUlVFN08wRkJSVUU3TzBGQlJVRTdPMEZCUlVFN08wRkJSVUU3TzBGQlJVRTdPMEZCUlVFc2MwTkJRWE5ETEhWRFFVRjFReXhuUWtGQlowSTdPMEZCUlRkR08wRkJRMEU3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklPMEZCUTBFc1JUczdPenM3T3p0QlEyaERRVHM3UVVGRlFUczdRVUZGUVRzN1FVRkZRVHM3UVVGRlFTeHpRMEZCYzBNc2RVTkJRWFZETEdkQ1FVRm5RanM3UVVGRk4wWTdRVUZEUVR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFTeEZPenM3T3pzN1FVTm9Ra0U3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3UVVOS1FUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc05rSkJRVFpDTzBGQlF6ZENPenRCUVVWQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzTmtKQlFUWkNPMEZCUXpkQ08wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVRzN096czdPenRCUTNoRFFUdEJRVU5CTzBGQlEwRXNiMFZCUVhWRkxIbERRVUV3UXl4Rk96czdPenM3TzBGRFJtcElPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVN3MFFrRkJORUlzWVVGQllUczdRVUZGZWtNN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEhkRFFVRjNReXh2UTBGQmIwTTdRVUZETlVVc05FTkJRVFJETEc5RFFVRnZRenRCUVVOb1JpeExRVUZMTERKQ1FVRXlRaXh2UTBGQmIwTTdRVUZEY0VVN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxHZENRVUZuUWl4dFFrRkJiVUk3UVVGRGJrTTdRVUZEUVR0QlFVTkJMR2xEUVVGcFF5d3lRa0ZCTWtJN1FVRkROVVE3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hMUVVGTE8wRkJRMHc3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTNKRlFTeHJRa0ZCYTBJc2QwUTdPenM3T3p0QlEwRnNRaXhqUVVGakxITkNPenM3T3pzN1FVTkJaQ3cyUlRzN096czdPMEZEUVVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTEVVN096czdPenRCUTFwQk8wRkJRMEU3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hGT3pzN096czdRVU5vUWtFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTERoQ1FVRTRRanRCUVVNNVFqdEJRVU5CTzBGQlEwRXNiVVJCUVcxRUxFOUJRVThzUlVGQlJUdEJRVU0xUkN4Rk96czdPenM3UVVOVVFTeDNRenM3T3pzN08wRkRRVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN3eVJFRkJNa1E3UVVGRE0wUXNSVHM3T3pzN08wRkRURUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc01FUkJRVEJFTEhOQ1FVRnpRanRCUVVOb1JpeG5Sa0ZCWjBZc2MwSkJRWE5DTzBGQlEzUkhMRVU3T3pzN096dEJRMUpCTEcxRE96czdPenM3TzBGRFFVRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEVzTmtKQlFUWkNPMEZCUXpkQ0xHTkJRV003UVVGRFpEdEJRVU5CTEVOQlFVTTdRVUZEUkR0QlFVTkJPMEZCUTBFN1FVRkRRU3dyUWtGQkswSTdRVUZETDBJN1FVRkRRVHRCUVVOQkxGVkJRVlU3UVVGRFZpeERRVUZETEVVN096czdPenRCUTJoQ1JEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPenRCUVVWQkxIZEhRVUYzUnl4UFFVRlBPMEZCUXk5SE8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4RE96czdPenM3TzBGRFdrRTdRVUZEUVN4MVEwRkJkVU1zTUVKQlFUQkNPMEZCUTJwRkxIZERRVUYzUXp0QlFVTjRRenRCUVVOQkxFVTdPenM3T3pzN096czdPenRCUTBwQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNlVUpCUVhsQ0xHdENRVUZyUWl4RlFVRkZPenRCUVVVM1F6dEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRWRCUVVjc1ZVRkJWVHRCUVVOaU96dEJRVVZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTNSQ1FUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMHBCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSExGVkJRVlU3UVVGRFlqdEJRVU5CTEVVN096czdPenRCUTJaQkxIbERPenM3T3pzN08wRkRRVUU3TzBGQlJVRTdPMEZCUlVFN08wRkJSVUU3TzBGQlJVRTdPMEZCUlVFN08wRkJSVUVzYVVoQlFXbElMRzFDUVVGdFFpeEZRVUZGTEcxQ1FVRnRRaXcwU2tGQk5FbzdPMEZCUlhKVUxITkRRVUZ6UXl4MVEwRkJkVU1zWjBKQlFXZENPenRCUVVVM1JqdEJRVU5CTzBGQlEwRXNRMEZCUXp0QlFVTkVPMEZCUTBFc1JUczdPenM3TzBGRGNFSkJMRFJDUVVFMFFpeGxPenM3T3pzN1FVTkJOVUk3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hMUVVGTExGZEJRVmNzWlVGQlpUdEJRVU12UWp0QlFVTkJMRXRCUVVzN1FVRkRURHRCUVVOQkxFVTdPenM3T3pzN1FVTndRa0U3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQkxIbEdRVUZuUml4aFFVRmhMRVZCUVVVN08wRkJSUzlHTzBGQlEwRXNjVVJCUVhGRUxEQkNRVUV3UWp0QlFVTXZSVHRCUVVOQkxFVTdPenM3T3p0QlExcEJPMEZCUTBFc1ZVRkJWVHRCUVVOV0xFVTdPenM3T3p0QlEwWkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEV2tFN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3UVVOT1FUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEyaENRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRWRCUVVjN1FVRkRTRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3UVVNeFJVRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPenRCUTA1Qk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEdkRFFVRm5RenRCUVVOb1F5eGpRVUZqTzBGQlEyUXNhVUpCUVdsQ08wRkJRMnBDTzBGQlEwRXNRMEZCUXp0QlFVTkVPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1EwRkJRenM3UVVGRlJEdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRU3cwUWpzN096czdPMEZEYWtOQkxHdENRVUZyUWl4M1JEczdPenM3T3pzN096czdPenM3T3pzN096czdPMUZEZDBOR1FTeFRMRWRCUVVGQkxGTTdVVUZyUkVGRExGY3NSMEZCUVVFc1Z6dFJRV2RDUVVNc1Z5eEhRVUZCUVN4WE8xRkJVMEZETEZNc1IwRkJRVUVzVXp0UlFWVkJReXh0UWl4SFFVRkJRU3h0UWp0UlFWVkJReXh0UWl4SFFVRkJRU3h0UWp0UlFWZEJReXhuUWl4SFFVRkJRU3huUWp0UlFXMUNRVU1zWXl4SFFVRkJRU3hqTzFGQmVVTkJReXhsTEVkQlFVRkJMR1U3T3pzN1FVRTVUV2hDT3pzN096czdPenM3T3pzN096czdPenM3T3pzN08wRkJjMEpCT3pzN096dEJRVXRCT3pzN096czdPenRCUVZGQk96czdPenRCUVV0UExGTkJRVk5TTEZOQlFWUXNRMEZCYlVKVExFZEJRVzVDTEVWQlFYZENPenRCUVVVM1FpeE5RVUZKTEVOQlFVTkJMRWRCUVV3c1JVRkJWU3hOUVVGTlF5eE5RVUZOTEhkQ1FVRk9MRU5CUVU0N08wRkJSVmdzVjBGQlUwTXNUMEZCVkN4RFFVRnBRa01zUzBGQmFrSXNSVUZCZDBJN1FVRkRka0lzVVVGQlRVTXNVVUZCVVN3d1JrRkJaRHRCUVVORkxGRkJRVTFETEZGQlFWRXNWVUZCWkR0QlFVTkVMRkZCUVVsRExGRkJRVkZJTEUxQlFVMUpMRTlCUVU0c1EwRkJZMGdzUzBGQlpDeEZRVUZ4UWtNc1MwRkJja0lzUlVGQk5FSkhMRXRCUVRWQ0xFTkJRV3RETEVkQlFXeERMRU5CUVZvN1FVRkRSQ3hYUVVGUFJpeExRVUZRTzBGQlEwRTdPMEZCUlVRc1RVRkJTVUVzVVVGQlVVb3NVVUZCVVVZc1IwRkJVaXhEUVVGYU96dEJRVVZETzBGQlEwRXNUVUZCU1Uwc1RVRkJUU3hEUVVGT0xFMUJRV0ZPTEVkQlFXSXNTVUZCYjBJc1EwRkJRMDBzVFVGQlRTeERRVUZPTEVWQlFWTkhMRkZCUVZRc1EwRkJhMElzUjBGQmJFSXNRMEZCZWtJc1JVRkJhVVE3TzBGQlJTOURMRkZCUVVsRExGVkJRVk03UVVGRFdFTXNXVUZCVFN4RlFVUkxPMEZCUlZoRExHTkJRVkZhTEVkQlJrYzdRVUZIV0dFc1owSkJRVlU3UVVGSVF5eExRVUZpT3p0QlFVMUJReXhaUVVGUlF5eExRVUZTTEVOQlFXTXNlVVpCUVdRc1JVRkJlVWRtTEVkQlFYcEhPenRCUVVWQkxGZEJRVTlWTEU5QlFWQTdRVUZEUkRzN1FVRkZSanRCUVVOQkxFMUJRVWxLTEUxQlFVMHNRMEZCVGl4TlFVRmhUaXhIUVVGaUxFbEJRVzlDVFN4TlFVRk5MRU5CUVU0c1JVRkJVMGNzVVVGQlZDeERRVUZyUWl4SFFVRnNRaXhEUVVGNFFpeEZRVUZuUkR0QlFVTXZReXhSUVVGSlR5eFRRVUZUVml4TlFVRk5MRU5CUVU0c1RVRkJZVTRzUjBGQllpeEhRVUZ0UWl4TlFVRnVRaXhIUVVFMFFrMHNUVUZCVFN4RFFVRk9MRU5CUVhwRE8wRkJRMEZCTEZsQlFWRktMRkZCUVZGakxGTkJRVk1zUzBGQlZDeEhRVUZwUWxZc1RVRkJUU3hEUVVGT0xFTkJRWHBDTEVOQlFWSTdRVUZEUVRzN1FVRkZSRHRCUVVOQkxFMUJRVWxCTEUxQlFVMHNRMEZCVGl4RlFVRlRSeXhSUVVGVUxFTkJRV3RDTEVkQlFXeENMRU5CUVVvc1JVRkJORUk3UVVGRE0wSklMRlZCUVUwc1EwRkJUaXhKUVVGWFFTeE5RVUZOTEVOQlFVNHNTVUZCVnl4TFFVRllMRWRCUVcxQ1FTeE5RVUZOTEVOQlFVNHNRMEZCT1VJN1FVRkRRVUVzVlVGQlRTeERRVUZPTEVsQlFWZEJMRTFCUVUwc1EwRkJUaXhGUVVGVFZ5eE5RVUZVTEVOQlFXZENXQ3hOUVVGTkxFTkJRVTRzUlVGQlUxa3NUMEZCVkN4RFFVRnBRaXhIUVVGcVFpeEpRVUYzUWl4RFFVRjRReXhEUVVGWU8wRkJRMGNzUjBGeVF6QkNMRU5CY1VONFFqczdPenRCUVVsTUxFMUJRVWxTTEZOQlFWTTdRVUZEV0VNc1ZVRkJUVXdzVFVGQlRTeERRVUZPTEVOQlJFczdRVUZGV0Uwc1dVRkJVVTRzVFVGQlRTeERRVUZPTEVOQlJrYzdRVUZIV0U4c1kwRkJWVkFzVFVGQlRTeERRVUZPTzBGQlNFTXNSMEZCWWpzN1FVRk5RU3hUUVVGUFNTeE5RVUZRTzBGQlEwUTdPMEZCUlUwc1UwRkJVMnhDTEZkQlFWUXNRMEZCY1VJeVFpeExRVUZ5UWl4RlFVRTBRanRCUVVOcVF5eE5RVUZKUXl4WlFVRlpSQ3hOUVVGTlJDeFBRVUZPTEVOQlFXTXNSMEZCWkN4RFFVRm9RanM3UVVGRlFTeE5RVUZKVWl4VFFVRlRPMEZCUTFoWExHTkJRVlZHTEUxQlFVMUhMRk5CUVU0c1EwRkJaMElzUTBGQmFFSXNSVUZCYlVKR0xGTkJRVzVDTEVOQlJFTTdRVUZGV0ZJc1dVRkJVVThzVFVGQlRVY3NVMEZCVGl4RFFVRm5Ra1lzV1VGQldTeERRVUUxUWl4RlFVRXJRa1FzVFVGQlRVa3NUVUZCY2tNN1FVRkdSeXhIUVVGaU96dEJRVXRCTEZOQlFVOWlMRTFCUVZBN1FVRkRSRHM3UVVGRlJEczdPenM3UVVGTFR5eFRRVUZUYWtJc1YwRkJWQ3hEUVVGeFFpdENMRTFCUVhKQ0xFVkJRVFpDTzBGQlEyeERMRk5CUVU4c2IwSkJRVmxCTEUxQlFWb3NSVUZCYjBKRUxFMUJRWEJDTEVkQlFUWkNMRU5CUVRkQ0xFZEJRV2xETEV0QlFXcERMRWRCUVhsRExFbEJRV2hFTzBGQlEwUTdPMEZCUlVRN096czdPMEZCUzA4c1UwRkJVemRDTEZOQlFWUXNRMEZCYlVJclFpeEhRVUZ1UWl4RlFVRjNRanRCUVVNM1FqdEJRVU5CTEUxQlFVbEJMRWRCUVVvc1JVRkJVeXhQUVVGUFF5eExRVUZMUXl4TFFVRk1MRU5CUVZjc2VVSkJRV1ZHTEVkQlFXWXNRMEZCV0N4RFFVRlFPMEZCUTFZN08wRkJSVVE3T3pzN08wRkJTMDhzVTBGQlV6bENMRzFDUVVGVUxFTkJRVFpDYVVNc1UwRkJOMElzUlVGQmQwTTdRVUZETjBNc1RVRkJTVklzV1VGQldWRXNWVUZCVlZZc1QwRkJWaXhEUVVGclFpeEhRVUZzUWl4RFFVRm9RanRCUVVOQkxGTkJRVThzV1VGQldWVXNWVUZCVlU0c1UwRkJWaXhEUVVGdlFrWXNXVUZCV1N4RFFVRm9ReXhGUVVGdFExRXNWVUZCVlV3c1RVRkJOME1zUTBGQldpeEhRVUZ0UlN4SFFVRnVSU3hIUVVGNVJVc3NWVUZCVlU0c1UwRkJWaXhEUVVGdlFpeERRVUZ3UWl4RlFVRjFRa1lzVTBGQmRrSXNRMEZCYUVZN1FVRkRSRHM3UVVGRlJEczdPenM3UVVGTFR5eFRRVUZUZUVJc2JVSkJRVlFzUTBGQk5rSnBReXhQUVVFM1FpeEZRVUZ6UXp0QlFVTXpReXhOUVVGSk4wSXNUVUZCVFZRc1ZVRkJWWE5ETEU5QlFWWXNRMEZCVmp0QlFVTkJMRk5CUVU4M1FpeEpRVUZKWVN4UlFVRktMRU5CUVdGT0xFOUJRV0lzUTBGQmNVSXNSMEZCY2tJc1JVRkJNRUlzUlVGQk1VSXNTVUZCWjBNc1IwRkJhRU1zUjBGQmMwTlFMRWxCUVVsWkxFMUJRV3BFTEVOQlJqSkRMRU5CUldNN1FVRkRNVVE3TzBGQlIwUTdPenM3TzBGQlMwOHNVMEZCVTJZc1owSkJRVlFzUTBGQk1FSnBReXhWUVVFeFFpeEZRVUZ6UXpzN1FVRkZNME03UVVGRFFTeE5RVUZKUVN4WFFVRlhVaXhUUVVGWUxFTkJRWEZDTEVOQlFYSkNMRVZCUVhkQ0xFTkJRWGhDTEUxQlFTdENMRk5CUVc1RExFVkJRVGhETzBGQlF6VkRMRkZCUVVsVExHRkJRV0Y0UXl4VlFVRlZkVU1zVlVGQlZpeERRVUZxUWpzN1FVRkZRVHRCUVVOQkxGRkJRVWxETEZkQlFWZHVRaXhOUVVGWUxFbEJRWEZDYlVJc1YwRkJWMnhDTEZGQlFYQkRMRVZCUVRoRE8wRkJRelZETEdGQlFVOXBRaXhWUVVGUU8wRkJRMFFzUzBGR1JDeE5RVVZQTzBGQlEwd3NXVUZCVFN3eVFrRkJUanRCUVVORU96dEJRVVZJTzBGQlEwTXNSMEZZUkN4TlFWZFBPMEZCUTB3c1YwRkJUMjVETEc5Q1FVRnZRbTFETEZWQlFYQkNMRU5CUVZBN1FVRkRSRHRCUVVOR096dEJRVVZOTEZOQlFWTm9ReXhqUVVGVUxFTkJRWGRDYTBNc1NVRkJlRUlzUlVGQk9FSTdPMEZCUlc1RExFMUJRVWsxUWl4UlFVRlJMRFpMUVVGYU96dEJRVVZCTEUxQlFVazJRaXhQUVVGUExFVkJRVmc3UVVGRFFTeE5RVUZKUXl4UlFVRlJMRVZCUVZvN1FVRkRRU3hOUVVGSlF5eFBRVUZQU0N4TFFVRkxTU3hMUVVGTUxFTkJRVmRvUXl4TFFVRllMRU5CUVZnN08wRkJSVUVzVFVGQlNTdENMRkZCUVZFc1NVRkJXaXhGUVVGclFqdEJRVU5vUWtRc1dVRkJVVVlzUzBGQlMzaENMRXRCUVV3c1EwRkJWeXhIUVVGWUxFTkJRVkk3UVVGRFJDeEhRVVpFTEUxQlJVODdRVUZEVEN4UlFVRkpOa0lzVlVGQlNqdEJRVU5CTEZkQlFVOHNRMEZCUTBFc1NVRkJTV3BETEUxQlFVMXJReXhKUVVGT0xFTkJRVmRPTEVsQlFWZ3NRMEZCVEN4TlFVRXlRaXhKUVVGc1F5eEZRVUYzUXp0QlFVTjBRenRCUVVOQkxGVkJRVWxMTEVWQlFVVkZMRXRCUVVZc1MwRkJXVzVETEUxQlFVMXZReXhUUVVGMFFpeEZRVUZwUXp0QlFVTXZRbkJETEdOQlFVMXZReXhUUVVGT08wRkJRMFE3TzBGQlJVUTdRVUZEUVVnc1VVRkJSVWtzVDBGQlJpeERRVUZWTEZWQlFVTk1MRXRCUVVRc1JVRkJVVTBzVlVGQlVpeEZRVUYxUWp0QlFVTXZRaXhaUVVGSlFTeGxRVUZsTEVOQlFXNUNMRVZCUVhOQ08wRkJRM0JDVkN4bFFVRkxWU3hKUVVGTUxFTkJRVlZRTEV0QlFWWTdRVUZEUkR0QlFVTkdMRTlCU2tRN1FVRkxSRHRCUVVORUxGRkJRVWt4UWl4bFFVRktPMEZCUTBGMVFpeFRRVUZMVVN4UFFVRk1MRU5CUVdFc1ZVRkJRM3BETEVkQlFVUXNSVUZCVXp0QlFVTndRbFVzWlVGQlUzTkNMRXRCUVV0NlFpeFBRVUZNTEVOQlFXRlFMRWRCUVdJc1JVRkJhMElzUzBGQmJFSXNRMEZCVkRzN1FVRkZRV3RETEdOQlFWRjRRaXhQUVVGUFJpeExRVUZRTEVOQlFXRXNSMEZCWWl4RlFVRnJRbTlETEVkQlFXeENMRU5CUVhOQ0xGVkJRVU5ETEVsQlFVUXNSVUZCVlR0QlFVTjBReXhaUVVGSlFTeFRRVUZUTEV0QlFXSXNSVUZCYjBJN1FVRkJSU3hwUWtGQlR6ZERMRWRCUVZBN1FVRkJZVHRCUVVOdVF5eGxRVUZQTmtNc1NVRkJVRHRCUVVORUxFOUJTRThzUTBGQlVqdEJRVXRFTEV0QlVrUTdRVUZUUkRzN1FVRkZSQzlDTEZWQlFWRm5ReXhIUVVGU0xFTkJRVmtzZVVOQlFWb3NSVUZCZFVSYUxFdEJRWFpFTzBGQlEwRXNVMEZCVDBFc1MwRkJVRHRCUVVORU96dEJRVVZOTEZOQlFWTnVReXhsUVVGVUxFTkJRWGxDYVVNc1NVRkJla0lzUlVGQkswSTdRVUZEY0VNc1RVRkJTVFZDTEZGQlFWRXNNa0pCUVZvN08wRkJSVUVzVFVGQlNUSkRMRlZCUVZVc1ZVRkJaRHM3UVVGRlFTeE5RVUZKTEVOQlFVTm1MRXRCUVV0MlFpeFJRVUZNTEVOQlFXTXNTMEZCWkN4RFFVRk1MRVZCUVRKQ08wRkJRM3BDTEZkQlFWRjFRaXhMUVVGTGVFSXNTMEZCVEN4RFFVRlhMRWRCUVZnc1EwRkJVanRCUVVORUxFZEJSa1FzVFVGRlR6dEJRVU5NTEZGQlFVbDNReXhWUVVGVmFFSXNTMEZCUzNoQ0xFdEJRVXdzUTBGQlYwb3NTMEZCV0N4RlFVRnJRaXhEUVVGc1FpeERRVUZrT3p0QlFVVkJMRkZCUVVrMlF5eFRRVUZUUkN4UlFVRlJlRU1zUzBGQlVpeERRVUZqTEVkQlFXUXNRMEZCWWpzN1FVRkZRU3hSUVVGSk1FTXNWVUZCVld4Q0xFdEJRVXQ2UWl4UFFVRk1MRU5CUVdGNVF5eFBRVUZpTEVWQlFYTkNMRVZCUVhSQ0xFTkJRV1E3TzBGQlJVRXNVVUZCU1doQ0xFdEJRVXQyUWl4UlFVRk1MRU5CUVdOelF5eFBRVUZrTEVOQlFVb3NSVUZCTkVJN08wRkJSVEZDTEZWQlFVbEpMRk5CUVZORUxGRkJRVkV4UXl4TFFVRlNMRU5CUVdOMVF5eFZRVUZWTEVkQlFYaENMRU5CUVdJN08wRkJSVUZxUXl4alFVRlJaME1zUjBGQlVpeERRVUZaTEZsQlFWbExMRTFCUVhoQ096dEJRVVZCUkN4blFrRkJWVU1zVDBGQlR5eERRVUZRTEVWQlFWVkRMRXRCUVZZc1EwRkJaMElzUjBGQmFFSXNSVUZCY1VJc1EwRkJReXhEUVVGMFFpeERRVUZXT3p0QlFVVkJSQ3hsUVVGVFFTeFBRVUZQTEVOQlFWQXNSVUZCVlRORExFdEJRVllzUTBGQlowSXNSMEZCYUVJc1EwRkJWRHM3UVVGRlFYbERMR0ZCUVU5T0xFbEJRVkFzUTBGQldVOHNUMEZCV2l4RlFVRnhRa2dzVDBGQmNrSTdPMEZCUlVGRkxHVkJRVk5CTEU5QlFVOUpMRTFCUVZBc1EwRkJZMFlzVFVGQlpDeERRVUZVTzBGQlJVUXNTMEZrUkN4TlFXTlBPMEZCUTB4R0xHRkJRVTlPTEVsQlFWQXNRMEZCV1U4c1QwRkJXanRCUVVWRU96dEJRVVZFTEZkQlFWRkVMRTlCUVU5TExFMUJRVkFzUTBGQlkwTXNUMEZCWkN4RFFVRlNPMEZCUlVRN1FVRkRSaXhET3pzN096czdRVU5zVUVRc2EwSkJRV3RDTEhkRU96czdPenM3UVVOQmJFSTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNhVVJCUVdsRU8wRkJRMnBFTEVOQlFVTTdRVUZEUkR0QlFVTkJMSEZDUVVGeFFqdEJRVU55UWp0QlFVTkJMRk5CUVZNN1FVRkRWQ3hKUVVGSk8wRkJRMG83UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTNCRVFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlExQkJMR3RDUVVGclFpeDNSRHM3T3pzN08wRkRRV3hDTEd0Q1FVRnJRaXgzUkRzN096czdPMEZEUVd4Q0xHdENRVUZyUWl4M1JEczdPenM3TzBGRFFXeENMR3RDUVVGclFpeDNSRHM3T3pzN08wRkRRV3hDTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRFNrRTdRVUZEUVN3NFJEczdPenM3TzBGRFJFRTdRVUZEUVN4dlJEczdPenM3TzBGRFJFRTdRVUZEUVN3NFJEczdPenM3TzBGRFJFRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3huUkRzN096czdPMEZEU2tFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTd3JRenM3T3pzN08wRkRTa0U3UVVGRFFUdEJRVU5CTEhWRU96czdPenM3UVVOR1FUdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnc1JUczdPenM3TzBGRFNrRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGdzUlRzN096czdPMEZEWkVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc2NVTkJRWEZETEdsQ1FVRnBRaXhGUVVGRk8wRkJRM2hFTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3huUlVGQlowVXNaMEpCUVdkQ08wRkJRMmhHTzBGQlEwRTdRVUZEUVN4SFFVRkhMREpEUVVFeVF5eG5RMEZCWjBNN1FVRkRPVVU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMSGRDT3pzN096czdRVU40UWtFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVkQlFVYzdRVUZEU0N4Rk96czdPenM3UVVObVFUdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEVUVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEZPenM3T3pzN1FVTktRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEZPenM3T3pzN1FVTllRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVN3clFrRkJLMElzY1VKQlFYRkNPMEZCUTNCRUxDdENRVUVyUWl4VFFVRlRMRVZCUVVVN1FVRkRNVU1zUTBGQlF5eFZRVUZWT3p0QlFVVllPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTERKQ1FVRXlRaXhUUVVGVExHMUNRVUZ0UWp0QlFVTjJSQ3dyUWtGQkswSXNZVUZCWVR0QlFVTTFRenRCUVVOQkxFZEJRVWNzVlVGQlZUdEJRVU5pTzBGQlEwRXNSVHM3T3pzN08wRkRjRUpCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTFSQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeFBRVUZQTzBGQlExQTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hMUVVGTE8wRkJRMHc3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVR0QlFVTkJMSFZEUVVGMVF5eHZRa0ZCYjBJc1JVRkJSVHRCUVVNM1JEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRWRCUVVjN1FVRkRTRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFZEJRVWM3UVVGRFNEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPenRCUVVWQk8wRkJRMEVzWjBKQlFXZENPMEZCUTJoQ08wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNTMEZCU3p0QlFVTk1PMEZCUTBFc1JUczdPenM3TzBGRGJrVkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxHdENRVUZyUWpzN1FVRkZiRUk3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGc3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHM3T3pzN096dEJRMnhDUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTEVVN096czdPenRCUTA1Qk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxHdEVRVUZyUkR0QlFVTnNSRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNUMEZCVHl4VlFVRlZMR05CUVdNN1FVRkRMMEk3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1MwRkJTeXhIUVVGSE8wRkJRMUk3UVVGRFFTeEZPenM3T3pzN08wRkRlRUpCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRzlDUVVGdlFpeGhRVUZoTzBGQlEycERMRWRCUVVjN1FVRkRTQ3hGT3pzN096czdRVU5pUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTFCQk8wRkJRMEU3UVVGRFFTdzRRa0ZCT0VJc1owTkJRVzlETEVVN096czdPenRCUTBac1JUdEJRVU5CTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeERRVUZETEVVN096czdPenRCUTFKRU8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFTkJRVU1zUlRzN096czdPMEZEVWtRN1FVRkRRVHRCUVVOQkxEaENRVUU0UWl3MFEwRkJORU1zUlRzN096czdPenRCUTBZeFJUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEc5RFFVRnZRenRCUVVOd1F6czdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxDdERRVUVyUXl4elJFRkJhVVFzYjBKQlFXOUNPMEZCUTNCSU8wRkJRMEU3UVVGRFFTeEhRVUZITEZWQlFWVTdRVUZEWWl4RFFVRkRPenRCUVVWRU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTEZsQlFWazdRVUZEV2p0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hYUVVGWE8wRkJRMWc3UVVGRFFTeFhRVUZYTzBGQlExZ3NVMEZCVXp0QlFVTlVMRTlCUVU4N1FVRkRVRHRCUVVOQk8wRkJRMEU3UVVGRFFTd3lRMEZCTWtNN1FVRkRNME03UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRk5CUVZNN1FVRkRWQ3h0UWtGQmJVSXNaME5CUVdkRE8wRkJRMjVFTEZOQlFWTTdRVUZEVkR0QlFVTkJPMEZCUTBFc1QwRkJUenRCUVVOUU8wRkJRMEU3UVVGRFFTeExRVUZMTzBGQlEwdzdRVUZEUVN4SFFVRkhPMEZCUTBnN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRXRCUVVzN1FVRkRUQ3hsUVVGbExIRkRRVUZ4UXp0QlFVTndSRHRCUVVOQkxFZEJRVWM3UVVGRFNEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc2EwTkJRV3RETzBGQlEyeERPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc2EwTkJRV3RETzBGQlEyeERPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzZFVKQlFYVkNMSGRDUVVGM1FqdEJRVU12UXp0QlFVTkJPMEZCUTBFc1UwRkJVenRCUVVOVU8wRkJRMEU3UVVGRFFTeFBRVUZQTzBGQlExQXNTMEZCU3p0QlFVTk1PMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTEd0Q1FVRnJRaXgxUWtGQmRVSXNTMEZCU3p0QlFVTTVRenRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEV0QlFVczdRVUZEVER0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxHbENRVUZwUWp0QlFVTnFRaXgzUWtGQmQwSTdRVUZEZUVJc1owSkJRV2RDTzBGQlEyaENMRzlDUVVGdlFqdEJRVU53UWl4M1FrRkJkMEk3UVVGRGVFSXNaMEpCUVdkQ08wRkJRMmhDTEc5Q1FVRnZRanRCUVVOd1FqdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4TFFVRkxPMEZCUTB3N1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3TzBGQlJVRXNNRVJCUVRCRUxHdENRVUZyUWp0QlFVTTFSVHRCUVVOQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNRMEZCUXp0QlFVTkVPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1EwRkJRenRCUVVORU8wRkJRMEU3UVVGRFFTeERRVUZETzBGQlEwUTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRk5CUVZNN1FVRkRWQ3hQUVVGUE8wRkJRMUE3UVVGRFFTeExRVUZMTzBGQlEwdzdRVUZEUVR0QlFVTkJMRWRCUVVjN1FVRkRTRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1QwRkJUenRCUVVOUUxFdEJRVXM3UVVGRFREdEJRVU5CTzBGQlEwRTdRVUZEUVN4RFFVRkRMRVU3T3pzN096czdRVU14VTBRN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc2RVSkJRWFZDTzBGQlEzWkNPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHRCUVVOQkxITkNRVUZ6UWp0QlFVTjBRaXh2UWtGQmIwSXNkVUpCUVhWQ0xGTkJRVk1zU1VGQlNUdEJRVU40UkN4SFFVRkhPMEZCUTBnc1EwRkJRenRCUVVORU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNRMEZCUXpzN1FVRkZSRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRU3hEUVVGRE8wRkJRMFE3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEhsRVFVRjVSRHRCUVVONlJEdEJRVU5CTEV0QlFVczdRVUZEVER0QlFVTkJMSE5DUVVGelFpeHBRMEZCYVVNN1FVRkRka1FzUzBGQlN6dEJRVU5NTEVkQlFVYzdRVUZEU0R0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklPenRCUVVWQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzT0VSQlFUaEVMRGhDUVVFNFFqdEJRVU0xUmp0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFZEJRVWM3TzBGQlJVZzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3TzBGQlJVRXNNRVJCUVRCRUxHZENRVUZuUWpzN1FVRkZNVVU3UVVGRFFUdEJRVU5CTzBGQlEwRXNiMEpCUVc5Q0xHOUNRVUZ2UWpzN1FVRkZlRU1zTUVOQlFUQkRMRzlDUVVGdlFqczdRVUZGT1VRN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTEhkQ1FVRjNRaXhsUVVGbExFVkJRVVU3UVVGRGVrTXNkMEpCUVhkQ0xHZENRVUZuUWp0QlFVTjRReXhEUVVGRE96dEJRVVZFTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1EwRkJRenM3UVVGRlJEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3h2UkVGQmIwUXNTMEZCU3l4UlFVRlJMR2xEUVVGcFF6dEJRVU5zUnl4RFFVRkRPMEZCUTBRN1FVRkRRU3dyUTBGQkswTTdRVUZETDBNN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeERRVUZET3p0QlFVVkVPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNNRU03T3pzN096dEJRekZQUVN4NVF6czdPenM3TzBGRFFVRXNjME03T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3p0QlEzVkNRVHM3T3pzN08wRkJSVUU3T3pzN1NVRkpUVU1zWlN4RFFVRm5RaXd5UWp0QlFVTndRanM3T3pzN1FVRk5RVHM3T3p0QlFVbEJMREpDUVVGWlF5eE5RVUZhTEVWQlFXOUNReXhQUVVGd1FpeEZRVUUyUWtNc1YwRkJOMElzUlVGQk1FTkRMRXRCUVRGRExFVkJRV2xFUXl4TFFVRnFSQ3hGUVVGM1JEdEJRVUZCT3p0QlFVTjBSQ3hSUVVGSlF5eFJRVUZSTEVsQlFWbzdPMEZCUlVGQkxGVkJRVTFETEU5QlFVNHNSMEZCWjBKT0xFMUJRV2hDTzBGQlEwRkxMRlZCUVUxRkxGRkJRVTRzUjBGQmFVSk9MRTlCUVdwQ08wRkJRMEZKTEZWQlFVMUhMRTFCUVU0c1IwRkJaVXdzUzBGQlpqdEJRVU5CUlN4VlFVRk5TU3hOUVVGT0xFZEJRV1ZNTEV0QlFXWTdPMEZCUlVGRExGVkJRVTFMTEZGQlFVNHNSMEZCYVVJc01FSkJRV1ZTTEZkQlFXWXNRMEZCYWtJN08wRkJSVUUzUXl4WlFVRlJaME1zUjBGQlVpeERRVUZaTEhGRFFVRmFMRVZCUVcxRVowSXNUVUZCVFVzc1VVRkJla1E3TzBGQlJVRk1MRlZCUVUxTkxFbEJRVTRzUjBGQllWZ3NUMEZCVDFjc1NVRkJjRUk3UVVGRFFVNHNWVUZCVFU4c2EwSkJRVTQ3UVVGRFJEczdPenQ1UTBGRmIwSTdRVUZEYmtJc1ZVRkJTVkFzVVVGQlVTeEpRVUZhT3p0QlFVVkJPMEZCUTBFc1ZVRkJTVUVzVFVGQlRVY3NUVUZCVml4RlFVRnJRanRCUVVOb1FrZ3NZMEZCVFZFc1UwRkJUaXhIUVVGclFsSXNUVUZCVFUwc1NVRkJUaXhEUVVGWFJ5eFhRVUZZTEVOQlFYVkNWQ3hOUVVGTlJ5eE5RVUUzUWl4RlFVRnhReXhWUVVGRFR5eEhRVUZFTEVWQlFWTTdRVUZET1VRc1kwRkJTVUVzU1VGQlNUZEVMRWxCUVVvc1MwRkJZU3hWUVVGaUxFbEJRVEpDTmtRc1NVRkJTVU1zUlVGQlNpeExRVUZYV0N4TlFVRk5TU3hOUVVGb1JDeEZRVUYzUkR0QlFVTjBSSEJFTEc5Q1FVRlJaME1zUjBGQlVpeERRVUZaTERaQ1FVRmFMRVZCUVRKRE1FSXNSMEZCTTBNN1FVRkRRVllzYTBKQlFVMVpMRmRCUVU0c1EwRkJhMEpHTEVkQlFXeENPMEZCUTBRN1FVRkRSaXhUUVV4cFFpeERRVUZzUWp0QlFVMUVPMEZCUTBZN096dDNRMEZGYlVJN1FVRkRiRUlzVlVGQlNWWXNVVUZCVVN4SlFVRmFPenRCUVVWQkxGVkJRVWxCTEUxQlFVMVJMRk5CUVZZc1JVRkJjVUk3UVVGRGJrSlNMR05CUVUxUkxGTkJRVTRzUTBGQlowSkxMRTFCUVdoQ08wRkJRMFE3UVVGRFJqczdRVUZGUkRzN096czdPemhDUVVkVE8wRkJRMUFzVlVGQlNXSXNVVUZCVVN4SlFVRmFPenRCUVVWQkxHRkJRVTlCTEUxQlFVMURMRTlCUVU0c1EwRkJZMkVzVTBGQlpDeERRVUYzUW1Rc1RVRkJUVVVzVVVGQk9VSXNRMEZCVURzN1FVRkZRVVlzV1VGQlRXVXNhVUpCUVU0N08wRkJSVUU3UVVGRFJEczdRVUZGUkRzN096czdPenM3TzBGQk1FSkJPenM3T3paQ1FVbFRReXhSTEVWQlFWVTdRVUZEYWtJc1YwRkJTMWdzVVVGQlRDeERRVUZqV1N4UFFVRmtMRU5CUVhOQ0xGVkJRVU5ETEV0QlFVUXNSVUZCVnp0QlFVTXZRbXhGTEdkQ1FVRlJaME1zUjBGQlVpeERRVUZaTEdsRFFVRmFMRVZCUVN0RGEwTXNTMEZCTDBNN1FVRkRRVVlzYVVKQlFWTkZMRXRCUVZRN1FVRkRSQ3hQUVVoRU8wRkJTVVE3TzBGQlJVUTdPenM3T3pzN0swSkJTVmRHTEZFc1JVRkJWVHRCUVVOdVFpeFhRVUZMUnl4clFrRkJUQ3hIUVVFd1FrZ3NVVUZCTVVJN1FVRkRSRHM3UVVGRlJEczdPenRuUTBGRFdVNHNSeXhGUVVGTE8wRkJRMllzVlVGQlNWWXNVVUZCVVN4SlFVRmFPenRCUVVWQkxGVkJRVWxyUWl4UlFVRlJPMEZCUTFaeVJTeGpRVUZOTmtRc1NVRkJTVGRFTEVsQlJFRTdRVUZGVmxnc1lVRkJTM2RGTEVsQlFVbFZMRWxCUVVvc1EwRkJVME1zVFVGR1NqdEJRVWRXUXl4alFVRk5XaXhKUVVGSlZTeEpRVUZLTEVOQlFWTkZPMEZCU0V3c1QwRkJXanM3UVVGTlFTeFZRVUZKZEVJc1RVRkJUVzFDTEd0Q1FVRldMRVZCUVRoQ08wRkJRelZDYmtJc1kwRkJUVzFDTEd0Q1FVRk9MRU5CUVhsQ1JDeExRVUY2UWp0QlFVTkVPMEZCUTBZN096dDNRa0YwUkdFN1FVRkJSU3hoUVVGUExFdEJRVXRvUWl4UlFVRmFPMEZCUVhWQ096dEJRVVYyUXpzN096czdPenQzUWtGSlZ6dEJRVUZGTEdGQlFVOHNTMEZCUzBjc1VVRkJUQ3hEUVVGamEwSXNTVUZCY2tJN1FVRkJORUk3TzBGQlJYcERPenM3T3pzN096dHpRa0ZMWVhoRkxGRXNSVUZCVlR0QlFVRkZMRmRCUVV0NVJTeFRRVUZNTEVkQlFXbENla1VzVVVGQmFrSTdRVUZCTkVJN08wRkJSWEpFT3pzN096czdkMEpCUzJVN1FVRkJSU3hoUVVGUExFdEJRVXQ1UlN4VFFVRmFPMEZCUVhkQ096czdTMEZ1U0RORE96czdPenM3T3pzN096czdPenM3T3pzN096czdPenRyUWtGNVNtVTVRaXhsT3pzN096czdPMEZEZWtwbU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1MwRkJTenRCUVVOTU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMR2xGUVVGcFJTd3dSRUZCTUVRc1JVRkJSVHRCUVVNM1NEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNOa1JCUVRaRUxESkVRVUV5UkR0QlFVTjRTQ3h4UkVGQmNVUXNNa1JCUVRKRU8wRkJRMmhJTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNhVVZCUVdsRk8wRkJRMnBGTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc2QwSkJRWGRDTEhORFFVRnpRenRCUVVNNVJEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzZVVKQlFYbENMRFJFUVVFMFJEdEJRVU55Ump0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxIZENRVUYzUWl3clEwRkJLME03UVVGRGRrVTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3gzUWtGQmQwSXNjVVZCUVhGRk8wRkJRemRHTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMSGRDUVVGM1FpeDFRMEZCZFVNN1FVRkRMMFE3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hSUVVGUk8wRkJRMUk3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3g1UTBGQmVVTTdRVUZEZWtNN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNkMEpCUVhkQ08wRkJRM2hDTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hSUVVGUk8wRkJRMUlzYVVVN1FVRkRRU3gzUkVGQmQwUXNOa2RCUVRaSExFVkJRVVU3UVVGRGRrczdRVUZEUVR0QlFVTkJPMEZCUTBFc1QwRkJUenRCUVVOUU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPenRCUVVWQk96dEJRVVZCTzBGQlEwRXNZVUZCWVR0QlFVTmlPenRCUVVWQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hKUVVGSk8wRkJRMG83TzBGQlJVRTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN08wRkJSVUVzY1VKQlFYRkNMR3RIUVVGclJ6dEJRVU4yU0R0QlFVTkJPMEZCUTBFc1RVRkJUVHRCUVVOT0xFdEJRVXM3UVVGRFREdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRU3h2UWtGQmIwSXNiVWRCUVcxSE8wRkJRM1pJTzBGQlEwRXNUVUZCVFR0QlFVTk9PMEZCUTBFN1FVRkRRVHRCUVVOQk96dEJRVVZCTERSRU8wRkJRMEU3UVVGRFFUczdRVUZGUVN4clFrRkJhMElzYjBsQlFXOUpPMEZCUTNSS08wRkJRMEVzU1VGQlNUdEJRVU5LTzBGQlEwRXNSMEZCUnp0QlFVTklPMEZCUTBFN1FVRkRRU3hEUVVGRE96czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3TzBGRGRsRkVPenRCUVVWQk96czdPMEZCUTBFN096czdPenRCUVVWQkxFbEJRVWtyUWl4aFFVRmhMRVZCUVVORExFdEJRVXNzUzBGQlRpeEZRVUZoUXl4UFFVRlBMRTlCUVhCQ0xFVkJRVFpDUXl4UFFVRlBMRTlCUVhCRExFVkJRV3BDT3p0QlFVVkJPenM3TzBGQk9VSkJPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3p0SlFXdERUVU1zYTBJN096dEJRVU5LT3pzN096czdRVUZQUVRzN096czdRVUZMUVR0QlFVTkJMRGhDUVVGWlF5eFBRVUZhTEVWQlFYRkNOVVlzUjBGQmNrSXNSVUZCTUVJMlJpeE5RVUV4UWl4RlFVRnJRME1zWVVGQmJFTXNSVUZCYVVSdVF5eFhRVUZxUkN4RlFVRTRSRzlETEZOQlFUbEVMRVZCUVhsRlF5eGpRVUY2UlN4RlFVRjVSa01zVFVGQmVrWXNSVUZCYTBnN1FVRkJRU3hSUVVGcVFrTXNUMEZCYVVJc2RVVkJRVkFzUzBGQlR6dEJRVUZCT3p0QlFVRkJMQ3RLUVVNeFIwNHNUMEZFTUVjc1JVRkRha2MxUml4SFFVUnBSeXhGUVVNMVJqWkdMRTFCUkRSR0xFVkJRM0JHUXl4aFFVUnZSaXhGUVVOeVJXNURMRmxCUVZrd1FpeEpRVVI1UkN4RlFVTnVSRlVzVTBGRWJVUXNSVUZEZUVORkxFMUJSSGRETEVWQlEyaERReXhQUVVSblF6czdRVUZGYUVnc1VVRkJTWEJETEdOQlFVbzdPMEZCUlVGQkxGVkJRVTF4UXl4UlFVRk9MRWRCUVdsQ1NDeGpRVUZxUWp0QlFVTkJiRU1zVlVGQlRYTkRMRkZCUVU0c1IwRkJhVUlzUlVGQmFrSTdPMEZCUlVGMFF5eFZRVUZOU3l4UlFVRk9MRU5CUVdWWkxFOUJRV1lzUTBGQmRVSXNWVUZCUTBNc1MwRkJSQ3hGUVVGWE8wRkJRMmhEYkVJc1dVRkJUWFZETEZOQlFVNHNRMEZCWjBKeVFpeExRVUZvUWp0QlFVTkVMRXRCUmtRN08wRkJTVUVzVVVGQlNYTkNMR2RDUVVGblFuaERMRTFCUVUxSExFMUJRVTRzUjBGQlpTeEhRVUZtTEVkQlFYRkNTQ3hOUVVGTlJTeFJRVUV2UXpzN1FVRkhRVHRCUVVOQkxIZENRVUZaVEN4WlFVRlpiME1zVTBGQmVFSXNSVUZCYlVOMFJDeFBRVUZ1UXl4RFFVRXlReXhWUVVGRE9FUXNaMEpCUVVRc1JVRkJjMEk3UVVGREwwUXNWVUZCU1VNc1YwRkJWemRETEZsQlFWbHZReXhUUVVGYUxFTkJRWE5DVVN4blFrRkJkRUlzUTBGQlpqdEJRVU5CZWtZc1kwRkJVV2RETEVkQlFWSXNRMEZCV1N3NFEwRkJXaXhGUVVFMFJIbEVMR2RDUVVFMVJDeEZRVUU0UlVNc1VVRkJPVVVzUlVGQmQwWXhReXhOUVVGTk1rTXNVVUZCT1VZN1FVRkRRU3hWUVVGSk0wTXNUVUZCVFRKRExGRkJRVllzUlVGQmIwSTdPMEZCUld4Q08wRkJRMEVzTkVKQlFWbEVMRkZCUVZvc1JVRkJjMEl2UkN4UFFVRjBRaXhEUVVFNFFpeFZRVUZEYVVJc1QwRkJSQ3hGUVVGaE8wRkJRM3BEU1N4blFrRkJUVFJETEdkQ1FVRk9MRU5CUVhWQ2FFUXNUMEZCZGtJc1NVRkJhME1zT0VKQlFXOUNTU3hMUVVGd1FpeEZRVUV5UWtvc1QwRkJNMElzUlVGQmIwTTRReXhUUVVGVE9VTXNUMEZCVkN4RlFVRnJRblpFTEV0QlFYUkVMRU5CUVd4RE8wRkJRMEV5UkN4blFrRkJUVFJETEdkQ1FVRk9MRU5CUVhWQ2FFUXNUMEZCZGtJc1JVRkJaME0zUXl4UlFVRm9ReXhIUVVFeVF6SkdMRk5CUVZNNVF5eFBRVUZVTEVWQlFXdENOME1zVVVGQk4wUTdPMEZCUlVFc1kwRkJTVFpETEZWQlFWVTBReXhoUVVGa0xFVkJRVFpDTzBGQlF6TkNRU3cwUWtGQlowSTFReXhQUVVGb1FqdEJRVU5FT3p0QlFVVkVOVU1zYTBKQlFWRm5ReXhIUVVGU0xFTkJRVmtzZDBSQlFWb3NSVUZCYzBWblFpeE5RVUZOTkVNc1owSkJRVTRzUTBGQmRVSm9SQ3hQUVVGMlFpeERRVUYwUlN4RlFVRjNSMEVzVDBGQmVFY3NSVUZCYVVnNFF5eFRRVUZUT1VNc1QwRkJWQ3hGUVVGclFuWkVMRXRCUVc1Sk8wRkJRMFFzVTBGVVJEdEJRVmRFTEU5QlpFUXNUVUZqVHp0QlFVTk1PMEZCUTBFeVJDeGpRVUZOTkVNc1owSkJRVTRzUTBGQmRVSklMR2RDUVVGMlFpeEpRVUV5UXl3NFFrRkJiMEo2UXl4TFFVRndRaXhGUVVFeVFubERMR2RDUVVFelFpeEZRVUUyUTBNc1VVRkJOME1zUTBGQk0wTTdRVUZEUVRGR0xHZENRVUZSWjBNc1IwRkJVaXhEUVVGWkxEUkVRVUZhTEVWQlFUQkZaMElzVFVGQlRUUkRMR2RDUVVGT0xFTkJRWFZDU0N4blFrRkJka0lzUTBGQk1VVTdRVUZEUkR0QlFVVkdMRXRCZGtKRU96dEJRWGxDUVhwRExGVkJRVTFGTEZGQlFVNHNSMEZCYVVJeVF5eFBRVUZQVEN4alFVRmpPVVlzUzBGQlpDeERRVUZ2UWl4SFFVRndRaXhGUVVGNVFpeERRVUY2UWl4RFFVRlFMRU5CUVdwQ096dEJRVVZCYzBRc1ZVRkJUVThzYTBKQlFVNDdRVUV4UTJkSU8wRkJNa05xU0RzN096dDVRMEZGYjBJN1FVRkRia0k3UVVGRFFTeFZRVUZKVUN4UlFVRlJMRWxCUVZvN08wRkJSVUZCTEZsQlFVMDRReXhsUVVGT0xFZEJRWGRDT1VNc1RVRkJUVTBzU1VGQlRpeERRVUZYUnl4WFFVRllMRU5CUVhWQ1ZDeE5RVUZOSzBNc1NVRkJUaXhIUVVGaExGVkJRWEJETEVWQlFXZEVMRlZCUVVOeVF5eEhRVUZFTEVWQlFWTTdRVUZETDBVc1dVRkJTVUVzU1VGQlNUZEVMRWxCUVVvc1MwRkJZU3hSUVVGcVFpeEZRVUV5UWp0QlFVTjZRa2NzYTBKQlFWRm5ReXhIUVVGU0xFTkJRVmtzZDBKQlFYZENaMElzVFVGQlRTdERMRWxCUVRsQ0xFZEJRWEZETEZGQlFXcEVMRVZCUVRKRWNrTXNSMEZCTTBRN1FVRkRRVllzWjBKQlFVMW5SQ3hoUVVGT0xFTkJRVzlDYUVRc1RVRkJUVXNzVVVGQk1VSXNSVUZCYjBOTExFZEJRWEJETzBGQlEwUTdRVUZEUml4UFFVeDFRaXhEUVVGNFFqdEJRVTFFT3pzN2QwTkJSVzFDTzBGQlEyeENPMEZCUTBFc1ZVRkJTVllzVVVGQlVTeEpRVUZhT3p0QlFVVkJRU3haUVVGTk9FTXNaVUZCVGl4RFFVRnpRbXBETEUxQlFYUkNPMEZCUTBRN08wRkJSVVE3T3pzN096czRRa0ZIVXp0QlFVTlFMRlZCUVVsaUxGRkJRVkVzU1VGQldqczdRVUZGUVVFc1dVRkJUV1VzYVVKQlFVNDdRVUZEUVN4aFFVRlBaaXhOUVVGTmFVUXNVVUZCVGl4RFFVRmxReXhWUVVGbUxFTkJRVEJDYkVRc1RVRkJUU3RETEVsQlFXaERMRU5CUVZBN1FVRkRSRHM3UVVGRlJEczdPenM3TzJ0RFFVZGpPMEZCUTFvc1ZVRkJTUzlETEZGQlFWRXNTVUZCV2pzN1FVRkZRVHRCUVVOQkxGVkJRVWx0UkN4cFFrRkJhVUk3UVVGRGJrSjBSeXhqUVVGTkxHRkJSR0VzUlVGRFJYVkhMRTFCUVUxd1JDeE5RVUZOUnl4TlFVUmtMRVZCUTNOQ2EwUXNTVUZCU1hKRUxFMUJRVTFwUkN4UlFVRk9MRU5CUVdWTExFOUJSSHBETzBGQlJXNUNiRU1zWTBGQlRTeEZRVUZGYlVNc1ZVRkJWWFpFTEUxQlFVMHJReXhKUVVGc1FqdEJRVVpoTEU5QlFYSkNPenRCUVV0QkwwTXNXVUZCVFUwc1NVRkJUaXhEUVVGWGEwUXNWMEZCV0N4RFFVRjFRa3dzWTBGQmRrSXNSVUZCZFVNc1ZVRkJRMDBzUzBGQlJDeEZRVUZYTzBGQlEyaEVla2NzWjBKQlFWRm5ReXhIUVVGU0xFTkJRVmtzYTBOQlFWb3NSVUZCWjBSNVJTeExRVUZvUkR0QlFVTkJMRmxCUVVsQkxFMUJRVTF5UXl4SlFVRk9MRU5CUVZkRkxFbEJRVmdzUzBGQmIwSXNSMEZCZUVJc1JVRkJOa0k3UVVGRE0wSjBRaXhuUWtGQlRXVXNhVUpCUVU0N1FVRkRRU3hwUWtGQlQyWXNUVUZCVFdsRUxGRkJRVTRzUTBGQlpVTXNWVUZCWml4RFFVRXdRbXhFTEUxQlFVMHJReXhKUVVGb1F5eERRVUZRTzBGQlEwUTdRVUZEUml4UFFVNUVPMEZCVDBRN08wRkJSVVE3T3pzN096czdPelpDUVV0VGRrUXNUU3hGUVVGUmQwSXNVU3hGUVVGVk8wRkJRM3BDTEZWQlFVa3dReXhOUVVGTmJFVXNUVUZCVmp0QlFVTkJMRlZCUVVsdFJTeFpRVUZaTzBGQlEyUTVSeXhqUVVGTk5FVXNWMEZCVjBjc1MwRkVTRHRCUVVWa1dpeHJRa0ZCVlVFN1FVRkdTU3hQUVVGb1FqczdRVUZMUVN4VlFVRkpORU1zVFVGQlRYQkZMRTlCUVU5d1F5eFBRVUZRTEVOQlFXVXNSMEZCWml4RFFVRldPMEZCUTBFc1ZVRkJTWGRITEZGQlFWRndSU3hQUVVGUEwwSXNUVUZCVUN4SFFVRm5RaXhEUVVFMVFpeEZRVUVyUWp0QlFVTTNRaXhaUVVGSmJVY3NVVUZCVVN4RFFVRmFMRVZCUVdVN1FVRkRZa1FzYjBKQlFWVTVSeXhKUVVGV0xFZEJRV2xDTkVVc1YwRkJWME1zUjBGQk5VSTdRVUZEUkN4VFFVWkVMRTFCUlU4N1FVRkRUR2xETEc5Q1FVRlZPVWNzU1VGQlZpeEhRVUZwUWpSRkxGZEJRVmRGTEV0QlFUVkNPMEZCUTBFclFpeG5Ra0ZCVFd4RkxFOUJRVTl5UXl4TlFVRlFMRU5CUVdNc1EwRkJaQ3hGUVVGcFFuRkRMRTlCUVU4dlFpeE5RVUZRTEVkQlFXZENMRU5CUVdwRExFTkJRVTQ3UVVGRFJEdEJRVU5HT3p0QlFVVkVMRmRCUVVzMlJTeFJRVUZNTEVOQlFXTnZRaXhIUVVGa0xFbEJRWEZDUXl4VFFVRnlRanRCUVVORU96czdPRUpCUlZONlF5eExMRVZCUVU4N1FVRkRaaXhWUVVGSmJFSXNVVUZCVVN4SlFVRmFPenRCUVVWQkxEQkNRVUZaUVN4TlFVRk5jME1zVVVGQmJFSXNSVUZCTkVJelJDeFBRVUUxUWl4RFFVRnZReXhWUVVGREswVXNSMEZCUkN4RlFVRlRPMEZCUXpORExGbEJRVWxzUlN4VFFVRlRVU3hOUVVGTmMwTXNVVUZCVGl4RFFVRmxiMElzUjBGQlppeERRVUZpTzBGQlEwRXNXVUZCU1d4RkxFOUJRVTh6UXl4SlFVRlFMRXRCUVdkQ05FVXNWMEZCVjBNc1IwRkJMMElzUlVGQmIwTTdRVUZEYkVNN1FVRkRRV3hETEdsQ1FVRlBkMElzVVVGQlVDeERRVUZuUWtVc1MwRkJhRUk3UVVGRFJDeFRRVWhFTEUxQlIwOHNTVUZCU1RGQ0xFOUJRVTh6UXl4SlFVRlFMRXRCUVdkQ05FVXNWMEZCVjBVc1MwRkJMMElzUlVGQmMwTTdRVUZETTBNN1FVRkRRU3hqUVVGSlZDeE5RVUZOTWtNc1MwRkJUaXhEUVVGWmVrY3NUMEZCV2l4RFFVRnZRbk5ITEVkQlFYQkNMRTFCUVRaQ0xFTkJRV3BETEVWQlFXOURPMEZCUTJ4RGJFVXNiVUpCUVU5M1FpeFJRVUZRTEVOQlFXZENSU3hMUVVGb1FqdEJRVU5FTzBGQlEwWXNVMEZNVFN4TlFVdEJMRWxCUVVreFFpeFBRVUZQTTBNc1NVRkJVQ3hMUVVGblFqUkZMRmRCUVZkSExFdEJRUzlDTEVWQlFYTkRPMEZCUXpORE8wRkJRMEVzWTBGQlNWWXNUVUZCVFRKRExFdEJRVTRzUzBGQlowSklMRWRCUVhCQ0xFVkJRWGxDTzBGQlEzWkNiRVVzYlVKQlFVOTNRaXhSUVVGUUxFTkJRV2RDUlN4TFFVRm9RanRCUVVORU8wRkJRMFk3UVVGRFJpeFBRV2hDUkR0QlFXbENSRHM3TzNWQ1FURktlVU1zTWtJN08ydENRVFpLTjBKWExHdENPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN1FVTjRTMlk3T3pzN1FVRkZRVHM3T3p0QlFVVkJPenM3TzBGQlJVRTdPenM3U1VGSlRXbERMR3RDT3pzN1FVRkRTanM3T3pzN096czdRVUZUUVRzN096dEJRVWxCTERoQ1FVRlphRU1zVDBGQldpeEZRVUZ4UWpWR0xFZEJRWEpDTEVWQlFUQkNOa1lzVFVGQk1VSXNSVUZCYTBORExHRkJRV3hETEVWQlFXbEVia01zVjBGQmFrUXNSVUZCT0VSdlF5eFRRVUU1UkN4RlFVRjVSVVVzVFVGQmVrVXNSVUZCYTBjN1FVRkJRU3hSUVVGcVFrTXNUMEZCYVVJc2RVVkJRVkFzUzBGQlR6dEJRVUZCT3p0QlFVRkJMQ3RLUVVNeFJrNHNUMEZFTUVZc1JVRkRha1kxUml4SFFVUnBSaXhGUVVNMVJUWkdMRTFCUkRSRkxFVkJRM0JGUXl4aFFVUnZSU3hGUVVOeVJHNURMRmRCUkhGRUxFVkJRM2hEYjBNc1UwRkVkME1zUlVGRE4wSkZMRTFCUkRaQ0xFVkJRM0pDUXl4UFFVUnhRanM3UVVGRmFFY3NVVUZCU1hCRExHTkJRVW83TzBGQlJVRkJMRlZCUVUwclJDeGpRVUZPTEVkQlFYVkNMRVZCUVhaQ096dEJRVVZCTDBRc1ZVRkJUVXNzVVVGQlRpeERRVUZsV1N4UFFVRm1MRU5CUVhWQ0xGVkJRVU5ETEV0QlFVUXNSVUZCVnp0QlFVTm9RMnhGTEdOQlFWRm5ReXhIUVVGU0xFTkJRVmtzZDBKQlFYZENPVU1zUjBGQmVFSXNSMEZCT0VJc1UwRkJNVU1zUlVGQmNVUm5SaXhMUVVGeVJEdEJRVU5CYkVJc1dVRkJUV2RGTEZOQlFVNHNRMEZCWjBJNVF5eExRVUZvUWp0QlFVTkVMRXRCU0VRN08wRkJTMEZzUWl4VlFVRk5UeXhyUWtGQlRqdEJRVmhuUnp0QlFWbHFSenM3T3p0NVEwRkZiMEk3UVVGRGJrSTdRVUZEUVN4VlFVRkpVQ3hSUVVGUkxFbEJRVm83TzBGQlJVRkJMRmxCUVUxcFJTeGxRVUZPTEVkQlFYZENha1VzVFVGQlRVMHNTVUZCVGl4RFFVRlhSeXhYUVVGWUxFTkJRWFZDVkN4TlFVRk5LME1zU1VGQk4wSXNSVUZCYlVNc1ZVRkJRM0pETEVkQlFVUXNSVUZCVXp0QlFVTnNSVEZFTEdkQ1FVRlJaME1zUjBGQlVpeERRVUZaTEdkQ1FVRm5RbWRDTEUxQlFVMHJReXhKUVVGMFFpeEhRVUUyUWl4UlFVRjZReXhGUVVGdFJISkRMRWRCUVc1RU8wRkJRMEVzWjBKQlFWRkJMRWxCUVVrM1JDeEpRVUZhTzBGQlEwVXNaVUZCU3l4VlFVRk1PMEZCUVdsQ2JVUXNhMEpCUVUxWkxGZEJRVTRzUTBGQmEwSkdMRWRCUVd4Q0xFVkJRWGRDTzBGQlEzcERMR1ZCUVVzc1RVRkJURHRCUVVGaFZpeHJRa0ZCVFd0RkxFOUJRVTRzUTBGQlkzaEVMRWRCUVdRc1JVRkJiMEk3UVVGR2JrTTdRVUZKUkN4UFFVNTFRaXhEUVVGNFFqdEJRVTlFT3pzN2QwTkJSVzFDTzBGQlEyeENPMEZCUTBFc1ZVRkJTVllzVVVGQlVTeEpRVUZhT3p0QlFVVkJRU3haUVVGTmFVVXNaVUZCVGl4RFFVRnpRbkJFTEUxQlFYUkNPMEZCUTBRN08wRkJSVVE3T3pzN096dHZRMEZIWjBKdlFpeFRMRVZCUVZjN1FVRkJRVHM3UVVGRmVrSXNWVUZCU1U4c1owSkJRV2RDTEV0QlFVdHlReXhOUVVGTUxFZEJRV01zUjBGQlpDeEhRVUZ2UWl4TFFVRkxSQ3hSUVVFM1F6czdRVUZGUVR0QlFVTkJMREJDUVVGWkswSXNVMEZCV2l4RlFVRjFRblJFTEU5QlFYWkNMRU5CUVN0Q0xGVkJRVU00UkN4blFrRkJSQ3hGUVVGelFqdEJRVU51UkN4WlFVRkpReXhYUVVGWFZDeFZRVUZWVVN4blFrRkJWaXhEUVVGbU8wRkJRMEY2Uml4blFrRkJVV2RETEVkQlFWSXNRMEZCV1N3NFEwRkJXaXhGUVVFMFJIbEVMR2RDUVVFMVJDeEZRVUU0UlVNc1VVRkJPVVVzUlVGQmQwWXNUMEZCUzBNc1VVRkJOMFk3TzBGQlJVRTdRVUZEUVN3MFFrRkJXVVFzVVVGQldpeEZRVUZ6UWk5RUxFOUJRWFJDTEVOQlFUaENMRlZCUVVOcFFpeFBRVUZFTEVWQlFXRTdRVUZEZWtNc2FVSkJRVXRuUkN4blFrRkJUQ3hEUVVGelFtaEVMRTlCUVhSQ0xFbEJRV2xETEhORFFVRXdRa0VzVDBGQk1VSXNSVUZCYlVNNFF5eFRRVUZUT1VNc1QwRkJWQ3hGUVVGclFuWkVMRXRCUVhKRUxFTkJRV3BETzBGQlEwRXNhVUpCUVV0MVJ5eG5Ra0ZCVEN4RFFVRnpRbWhFTEU5QlFYUkNMRVZCUVN0Q04wTXNVVUZCTDBJc1IwRkJNRU15Uml4VFFVRlRPVU1zVDBGQlZDeEZRVUZyUWpkRExGRkJRVFZFT3p0QlFVVkJMR05CUVVrMlF5eFZRVUZWTkVNc1lVRkJaQ3hGUVVFMlFqdEJRVU16UWtFc05FSkJRV2RDTlVNc1QwRkJhRUk3UVVGRFJEczdRVUZGUkRWRExHdENRVUZSWjBNc1IwRkJVaXhEUVVGWkxIZEVRVUZhTEVWQlFYTkZMRTlCUVVzMFJDeG5Ra0ZCVEN4RFFVRnpRbWhFTEU5QlFYUkNMRU5CUVhSRkxFVkJRWFZIUVN4UFFVRjJSeXhGUVVGblNEaERMRk5CUVZNNVF5eFBRVUZVTEVWQlFXdENka1FzUzBGQmJFazdRVUZEUkN4VFFWUkVPMEZCVlVRc1QwRm1SRHM3UVVGcFFrRXNWMEZCU3paRUxGRkJRVXdzUjBGQlowSXlReXhQUVVGUFRDeGpRVUZqT1VZc1MwRkJaQ3hEUVVGdlFpeEhRVUZ3UWl4RlFVRjVRaXhEUVVGNlFpeERRVUZRTEVOQlFXaENPMEZCUTBRN08wRkJSVVE3T3pzN096czdiME5CU1dkQ2VVZ3NVeXhGUVVGWE8wRkJRM3BDTEZWQlFVbHVSU3hSUVVGUkxFbEJRVm83TzBGQlJVRTdRVUZEUVN4VlFVRkpiMFVzV1VGQldUdEJRVU5rZGtnc1kwRkJUU3hSUVVSUkxFVkJRMFYxUnl4TlFVRk5jRVFzVFVGQlRXbEVMRkZCUVU0c1EwRkJaVGxETEUxQlJIWkNMRVZCUXl0Q2EwUXNTVUZCU1hKRUxFMUJRVTFwUkN4UlFVRk9MRU5CUVdWTExFOUJSR3hFTzBGQlJXUnNReXhqUVVGTkxFVkJRVVZwUkN4UlFVRlJMRXRCUVZZc1JVRkJhVUprTEZWQlFWVjJSQ3hOUVVGTkswTXNTVUZCYWtNc1JVRkJkVU5vUWl4UlFVRlJMMElzVFVGQlRYTkZMRTlCUVhKRUxFVkJRVGhFYWtrc1QwRkJUekpFTEUxQlFVMUxMRkZCUVU0c1EwRkJaV3RDTEVsQlFYQkdMRVZCUVRCR1owUXNWMEZCVjBvc1UwRkJja2M3UVVGR1VTeFBRVUZvUWpzN1FVRkxRVzVGTEZsQlFVMU5MRWxCUVU0c1EwRkJWMnRFTEZkQlFWZ3NRMEZCZFVKWkxGTkJRWFpDTzBGQlEwUTdPMEZCUlVRN096czdPenM0UWtGSFV6dEJRVU5RTEZWQlFVbHdSU3hSUVVGUkxFbEJRVm83TzBGQlJVRTdRVUZEUVN4VlFVRkpkMFVzV1VGQldUdEJRVU5rTTBnc1kwRkJUU3hSUVVSUkxFVkJRMFYxUnl4TlFVRk5jRVFzVFVGQlRVY3NUVUZFWkN4RlFVTnpRbXRFTEVsQlFVbHlSQ3hOUVVGTmFVUXNVVUZCVGl4RFFVRmxTeXhQUVVSNlF6dEJRVVZrYkVNc1kwRkJUU3hGUVVGRmJVTXNWVUZCVlhaRUxFMUJRVTByUXl4SlFVRnNRanRCUVVaUkxFOUJRV2hDT3p0QlFVdEJMME1zV1VGQlRVMHNTVUZCVGl4RFFVRlhhMFFzVjBGQldDeERRVUYxUW1kQ0xGTkJRWFpDTEVWQlFXdERMRlZCUVVObUxFdEJRVVFzUlVGQlZ6dEJRVU16UTNwSExHZENRVUZSWjBNc1IwRkJVaXhEUVVGWkxEWkNRVUZhTEVWQlFUSkRlVVVzUzBGQk0wTTdRVUZEUVN4WlFVRkpRU3hOUVVGTmNrTXNTVUZCVGl4RFFVRlhSU3hKUVVGWUxFdEJRVzlDTEVkQlFYaENMRVZCUVRaQ08wRkJRek5DZEVJc1owSkJRVTFsTEdsQ1FVRk9PMEZCUTBFc2FVSkJRVTltTEUxQlFVMXBSQ3hSUVVGT0xFTkJRV1YzUWl4VlFVRm1MRU5CUVRCQ2VrVXNUVUZCVFN0RExFbEJRV2hETEVOQlFWQTdRVUZEUkR0QlFVTkdMRTlCVGtRN1FVRlBSRHM3UVVGRlJEczdPenM3T3pzN08wRkJUVUU3T3pzN2JVTkJTV1V2UWl4UkxFVkJRVlU3UVVGRGRrSXNWMEZCU3pCRUxITkNRVUZNTEVkQlFUaENNVVFzVVVGQk9VSTdRVUZEUkRzN1FVRkZSRHM3T3pzN096c3JRa0ZKVjBFc1VTeEZRVUZWTzBGQlEyNUNMRmRCUVV0SExHdENRVUZNTEVkQlFUQkNTQ3hSUVVFeFFqdEJRVU5FT3p0QlFVVkVPenM3T3pzN096SkNRVWxQUVN4UkxFVkJRVlU3UVVGRFppeFhRVUZMTWtRc1kwRkJUQ3hIUVVGelFqTkVMRkZCUVhSQ08wRkJRMFE3TzBGQlJVUTdPenM3SzBKQlExZE9MRWNzUlVGQlN6dEJRVU5rTEZWQlFVbFdMRkZCUVZFc1NVRkJXanM3UVVGRlFXaEVMR05CUVZGblF5eEhRVUZTTEVOQlFWa3NNRUpCUVZvc1JVRkJkME13UWl4SFFVRjRRenRCUVVOQkxHTkJRVkZCTEVsQlFVbFZMRWxCUVVvc1EwRkJVM1pGTEVsQlFXcENPMEZCUTBVc1lVRkJTeXhYUVVGTU8wRkJRV3RDYlVRc1owSkJRVTAwUlN4WlFVRk9MRU5CUVcxQ2JFVXNSMEZCYmtJc1JVRkJlVUk3UVVGRE0wTXNZVUZCU3l4aFFVRk1PMEZCUVc5Q1ZpeG5Ra0ZCVFRaRkxHTkJRVTRzUTBGQmNVSnVSU3hIUVVGeVFpeEZRVUV5UWp0QlFVWnFSRHRCUVVsRU96dEJRVVZFT3pzN08ybERRVU5oUVN4SExFVkJRVXM3UVVGQlFUczdRVUZEYUVJc1ZVRkJTVllzVVVGQlVTeEpRVUZhTzBGQlEwRXNWVUZCU1RoRkxHRkJRV0Z3UlN4SlFVRkpWU3hKUVVGS0xFTkJRVk5uUXl4SlFVRXhRanRCUVVOQmNFY3NZMEZCVVdkRExFZEJRVklzUTBGQldTeHRRMEZCV2l4RlFVRnBSREJDTEVkQlFXcEVPenRCUVVWQkxGVkJRVWxSTEZGQlFWRTdRVUZEVm5KRkxHTkJRVTAyUkN4SlFVRkpWU3hKUVVGS0xFTkJRVk4yUlN4SlFVUk1PMEZCUlZaWUxHRkJRVXMwU1N4VlFVWkxPenRCUVVsV0wwZ3NhMEpCUVZVeVJDeEpRVUZKVlN4SlFVRktMRU5CUVZOeVJTeFJRVXBVT3p0QlFVMVdaMGtzWjBKQlFWRXNhMEpCUVUwN1FVRkRXanRCUVVOQkxHTkJRVWxETEUxQlFVMHNSVUZCUlRsSkxFdEJRVXMwU1N4VlFVRlFMRVZCUVcxQ1J5eFJRVUZSTEVsQlFUTkNMRVZCUVZZN1FVRkRRV3BHTEdkQ1FVRk5LMFFzWTBGQlRpeERRVUZ4UW1Vc1ZVRkJja0lzU1VGQmJVTkZMRWRCUVc1RE96dEJRVVZCTzBGQlEwRXNZMEZCU1VVc2FVSkJRV2xDTEVWQlFYSkNPMEZCUTBFc09FSkJRVmxzUml4TlFVRk5ORU1zWjBKQlFXeENMRVZCUVc5RGFrVXNUMEZCY0VNc1EwRkJORU1zVlVGQlEybENMRTlCUVVRc1JVRkJZVHRCUVVOMlJDeG5Ra0ZCU1hWR0xGbEJRVmx1Uml4TlFVRk5ORU1zWjBKQlFVNHNRMEZCZFVKb1JDeFBRVUYyUWl4RlFVRm5RekpDTEVsQlFXaEVPMEZCUTBFeVJDd3lRa0ZCWlhSR0xFOUJRV1lzU1VGQk1FSXNjMEpCUVZWMVJpeFRRVUZXTEVOQlFURkNPMEZCUTBRc1YwRklSRHM3UVVGTFFTeGpRVUZKUXl4VlFVRlZPMEZCUTFwNlJTeG5Ra0ZCU1VRc1NVRkJTVU1zUlVGRVNTeEZRVU5CT1VRc1RVRkJUU3hWUVVST0xFVkJRMnRDZFVjc1RVRkJUVEZETEVsQlFVa3lReXhGUVVRMVFpeEZRVU5uUTBFc1NVRkJTVE5ETEVsQlFVa3dReXhKUVVSNFF6dEJRVVZhYUVNc2EwSkJRVTBzUlVGQlJVVXNUVUZCVFN4SFFVRlNMRVZCUVdGVExGRkJRVkV2UWl4TlFVRk5jMFVzVDBGQk0wSXNSVUZCYjBObExGTkJRVk55Uml4TlFVRk5jVU1zVVVGQmJrUXNSVUZCTmtSb1J5eFBRVUZQTEVWQlFVVnJSaXhOUVVGTkxITkNRVUZWZGtJc1RVRkJUWFZDTEVsQlFXaENMRU5CUVZJc1JVRkJLMEpWTEZkQlFWZHBSQ3hqUVVFeFF5eEZRVUZ3UlR0QlFVWk5MRmRCUVdRN08wRkJTMEU3UVVGRFFTeGpRVUZKZUVVc1NVRkJTVlVzU1VGQlNpeERRVUZUYTBVc1kwRkJWQ3hEUVVGM1FpeHpRa0ZCZUVJc1MwRkJiVVFzUTBGQlF6VkZMRWxCUVVsVkxFbEJRVW9zUTBGQlUyMUZMRzlDUVVGcVJTeEZRVUYxUmp0QlFVTnlSa2dzYjBKQlFWRm9SU3hKUVVGU0xFTkJRV0Z0UlN4dlFrRkJZaXhIUVVGdlF5eFBRVUZMUXl4eFFrRkJla003UVVGRFFTeHRRa0ZCUzBFc2NVSkJRVXdzUjBGQk5rSTVSU3hKUVVGSlZTeEpRVUZLTEVOQlFWTnRSU3h2UWtGQmRFTTdRVUZEUkRzN1FVRkZSRHRCUVVOQmRrWXNaMEpCUVUxTkxFbEJRVTRzUTBGQlYydEVMRmRCUVZnc1EwRkJkVUkwUWl4UFFVRjJRanM3UVVGRlFTeHBRa0ZCVDBvc1IwRkJVRHRCUVVORUxGTkJha05UT3p0QlFXMURWbE1zWjBKQlFWRXNaMEpCUVVORExFMUJRVVFzUlVGQldUdEJRVU5zUWp0QlFVTkJNVVlzWjBKQlFVMU5MRWxCUVU0c1EwRkJWMnRFTEZkQlFWZ3NRMEZCZFVJN1FVRkRja0kzUXl4blFrRkJTVVFzU1VGQlNVTXNSVUZFWVN4RlFVTlVPVVFzVFVGQlRTeFZRVVJITEVWQlExTjFSeXhOUVVGTk1VTXNTVUZCU1RKRExFVkJSRzVDTEVWQlEzVkNRU3hKUVVGSk0wTXNTVUZCU1RCRExFbEJSQzlDTzBGQlJYSkNhRU1zYTBKQlFVMHNSVUZCUlVVc1RVRkJUU3hIUVVGU0xFVkJRV0Z4UlN4TlFVRk5SQ3hOUVVGdVFqdEJRVVpsTEZkQlFYWkNPMEZCU1VRN1FVRjZRMU1zVDBGQldqczdRVUUwUTBFc1ZVRkJTVEZHTEUxQlFVMHdSU3h6UWtGQlZpeEZRVUZyUXp0QlFVTm9RekZJTEdkQ1FVRlJaME1zUjBGQlVpeERRVUZaTEhOQ1FVRmFMRVZCUVc5RGEwTXNTMEZCY0VNN1FVRkRRV3hDTEdOQlFVMHdSU3h6UWtGQlRpeERRVUUyUW5oRUxFdEJRVGRDTzBGQlEwUTdRVUZEUmpzN1FVRkZSRHM3T3p0dFEwRkRaVklzUnl4RlFVRkxPMEZCUTJ4Q0xGVkJRVWxXTEZGQlFWRXNTVUZCV2p0QlFVTkJMRlZCUVVrNFJTeGhRVUZoY0VVc1NVRkJTVlVzU1VGQlNpeERRVUZUWjBNc1NVRkJNVUk3TzBGQlJVRXNWVUZCU1RSQ0xFMUJRVTFvUml4TlFVRk5LMFFzWTBGQlRpeERRVUZ4UW1Vc1ZVRkJja0lzUTBGQlZqdEJRVU5CTEdGQlFVODVSU3hOUVVGTkswUXNZMEZCVGl4RFFVRnhRbVVzVlVGQmNrSXNRMEZCVURzN1FVRkZRU3hWUVVGSk5VUXNVVUZCVVR0QlFVTldja1VzWTBGQlRUWkVMRWxCUVVsVkxFbEJRVW9zUTBGQlUzWkZMRWxCUkV3N1FVRkZWbGdzWVVGQlN6UkpMRlZCUmtzN1FVRkhWbkJJTEdkQ1FVRlJjMGc3UVVGSVJTeFBRVUZhT3p0QlFVMUJMRlZCUVVsb1JpeE5RVUZOTUVVc2MwSkJRVllzUlVGQmEwTTdRVUZEYUVNeFNDeG5Ra0ZCVVdkRExFZEJRVklzUTBGQldTeDVRa0ZCV2l4RlFVRjFRMnRETEV0QlFYWkRPMEZCUTBGc1FpeGpRVUZOTUVVc2MwSkJRVTRzUTBGQk5rSjRSQ3hMUVVFM1FqdEJRVU5FTzBGQlEwWTdPMEZCUlVRN096czdaME5CUTFsU0xFY3NSVUZCU3p0QlFVTm1MRlZCUVVsV0xGRkJRVkVzU1VGQldqczdRVUZGUVN4VlFVRkphMElzVVVGQlVUdEJRVU5XY2tVc1kwRkJUVFpFTEVsQlFVazNSQ3hKUVVSQk8wRkJSVlpZTEdGQlFVdDNSU3hKUVVGSk1FTXNTVUZHUXp0QlFVZFdPVUlzWTBGQlRWb3NTVUZCU1ZVc1NVRkJTaXhEUVVGVFJUdEJRVWhNTEU5QlFWbzdPMEZCVFVFc1ZVRkJTWFJDTEUxQlFVMXRRaXhyUWtGQlZpeEZRVUU0UWp0QlFVTTFRbTVGTEdkQ1FVRlJaME1zUjBGQlVpeERRVUZaTEd0Q1FVRmFMRVZCUVdkRGEwTXNTMEZCYUVNN1FVRkRRV3hDTEdOQlFVMXRRaXhyUWtGQlRpeERRVUY1UWtRc1MwRkJla0k3UVVGRFJEdEJRVU5HT3p0QlFVVkVPenM3T3pSQ1FVTlJVaXhITEVWQlFVczdRVUZEV0N4VlFVRkpWaXhSUVVGUkxFbEJRVm83TzBGQlJVRXNWVUZCU1d0Q0xGRkJRVkU3UVVGRFZuSkZMR05CUVUwMlJDeEpRVUZKTjBRc1NVRkVRVHRCUVVWV1dDeGhRVUZMZDBVc1NVRkJTVEJETEVsQlJrTTdPMEZCU1ZZeVFpeG5Ra0ZCVVN4clFrRkJUVHRCUVVOYUwwVXNaMEpCUVUxTkxFbEJRVTRzUTBGQlYydEVMRmRCUVZnc1EwRkJkVUk3UVVGRGNrSTNReXhuUWtGQlNVUXNTVUZCU1VNc1JVRkVZU3hGUVVOVU9VUXNUVUZCVFN4VlFVUkhMRVZCUTFOMVJ5eE5RVUZOTVVNc1NVRkJTVEpETEVWQlJHNUNMRVZCUTNWQ1FTeEpRVUZKTTBNc1NVRkJTVEJETEVsQlJDOUNPMEZCUlhKQ2FFTXNhMEpCUVUwc1JVRkJSVVVzVFVGQlRTeEhRVUZTTEVWQlFXRnFSaXhQUVVGUExITkNRVUZWTWtRc1RVRkJUWFZDTEVsQlFXaENMRU5CUVhCQ08wRkJSbVVzVjBGQmRrSTdRVUZKUkN4VFFWUlRPenRCUVZkV2EwVXNaMEpCUVZFc1owSkJRVU5ETEUxQlFVUXNSVUZCV1R0QlFVTnNRakZHTEdkQ1FVRk5UU3hKUVVGT0xFTkJRVmRyUkN4WFFVRllMRU5CUVhWQ08wRkJRM0pDTjBNc1owSkJRVWxFTEVsQlFVbERMRVZCUkdFc1JVRkRWRGxFTEUxQlFVMHNWVUZFUnl4RlFVTlRkVWNzVFVGQlRURkRMRWxCUVVreVF5eEZRVVJ1UWl4RlFVTjFRa0VzU1VGQlNUTkRMRWxCUVVrd1F5eEpRVVF2UWp0QlFVVnlRbWhETEd0Q1FVRk5MRVZCUVVWRkxFMUJRVTBzUjBGQlVpeEZRVUZoY1VVc1RVRkJUVVFzVFVGQmJrSTdRVUZHWlN4WFFVRjJRanRCUVVsRU8wRkJhRUpUTEU5QlFWbzdPMEZCYlVKQkxGVkJRVWt4Uml4TlFVRk5Na1VzWTBGQlZpeEZRVUV3UWp0QlFVTjRRak5JTEdkQ1FVRlJaME1zUjBGQlVpeERRVUZaTEdOQlFWb3NSVUZCTkVKclF5eExRVUUxUWp0QlFVTkJiRUlzWTBGQlRUSkZMR05CUVU0c1EwRkJjVUo2UkN4TFFVRnlRanRCUVVORU8wRkJRMFk3T3p0M1FrRTFTbTFDTzBGQlFVVXNZVUZCVHl4TFFVRkxOa01zWTBGQldqdEJRVUUyUWpzN08zVkNRWEpJVkN3eVFpeEhRV3BETlVNN096czdPenM3T3pzN096czdPenM3T3pzN096czdPMnRDUVhOVVpVUXNhMEk3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3p0QlF5OVNaanM3T3p0QlFVTkJPenM3TzBGQlEwRTdPenM3UVVGRlFUczdPenRKUVVsTk9FSXNWVHRCUVVOS096czdPenM3T3pzN096czdPenRCUVdsQ1FUczdPenRCUVVsQkxITkNRVUZaT1VRc1QwRkJXaXhGUVVGeFFqVkdMRWRCUVhKQ0xFVkJRVEJDTmtZc1RVRkJNVUlzUlVGQmEwTkRMR0ZCUVd4RExFVkJRV2xFYmtNc1YwRkJha1FzUlVGQk9FUnZReXhUUVVFNVJDeEZRVUY1Unp0QlFVRkJMRkZCUVdoRFJTeE5RVUZuUXl4MVJVRkJka0lzU1VGQmRVSTdRVUZCUVN4UlFVRnFRa01zVDBGQmFVSXNkVVZCUVZBc1MwRkJUenRCUVVGQk96dEJRVU4yUnl4UlFVRkpjRU1zVVVGQlVTeEpRVUZhT3p0QlFVVkJRU3hWUVVGTmFVUXNVVUZCVGl4SFFVRnBRbTVDTEU5QlFXcENPMEZCUTBFNVFpeFZRVUZOSzBNc1NVRkJUaXhIUVVGaE4wY3NSMEZCWWp0QlFVTkJPRVFzVlVGQlRYTkZMRTlCUVU0c1IwRkJaMEoyUXl4TlFVRm9RanRCUVVOQkwwSXNWVUZCVFRaR0xFOUJRVTRzUjBGQlowSTNSQ3hoUVVGb1FqdEJRVU5CYUVNc1ZVRkJUVXNzVVVGQlRpeEhRVUZwUWl3d1FrRkJaVklzVjBGQlppeERRVUZxUWp0QlFVTkJSeXhWUVVGTk9FWXNWVUZCVGl4SFFVRnRRamRFTEZOQlFXNUNPenRCUVVWQk8wRkJRMEZxUXl4VlFVRk5kMFlzY1VKQlFVNHNSMEZCT0VKeVJDeE5RVUU1UWpzN1FVRkZRVzVETEZWQlFVMXhReXhSUVVGT0xFZEJRV2xDTEVOQlFXcENPMEZCUTBGeVF5eFZRVUZOUlN4UlFVRk9MRWRCUVdsQ0xFTkJRV3BDTzBGQlEwRkdMRlZCUVUwMFF5eG5Ra0ZCVGl4SFFVRjVRaXhGUVVGNlFqdEJRVU5CTlVNc1ZVRkJUU3RHTEd0Q1FVRk9MRWRCUVRKQ0xFVkJRVE5DT3p0QlFVVkJMMFlzVlVGQlRUSkRMRkZCUVU0c1IwRkJhVUpRTEU5QlFXcENPenRCUVVkQmNFTXNWVUZCVFVjc1RVRkJUaXhIUVVGbE1rSXNVVUZCVVROQ0xFMUJRWFpDTzBGQlEwRklMRlZCUVUxTkxFbEJRVTRzUjBGQllYZENMRkZCUVZGNFFpeEpRVUZ5UWpzN1FVRkZRVHM3T3p0QlFVbEVPenM3TzNORFFVVnBRanRCUVVOb1FpeFZRVUZKVGl4UlFVRlJMRWxCUVZvN08wRkJSVUVzVlVGQlNXZEhMR0ZCUVdFc1EwRkJha0k3UVVGRFFTeFZRVUZKZUVRc1owSkJRV2RDZUVNc1RVRkJUVWNzVFVGQlRpeEhRVUZsTEVkQlFXWXNSMEZCY1VJMlJpeFZRVUY2UXpzN1FVRkhRU3d3UWtGQldXaEhMRTFCUVUwNFJpeFZRVUZzUWl4RlFVRTRRblJITEUxQlFUbENMRU5CUVhGRExGVkJRVU5yUlN4SFFVRkVMRVZCUVZNN1FVRkROVU1zV1VGQlNURkVMRTFCUVUwNFJpeFZRVUZPTEVOQlFXbENjRU1zUjBGQmFrSXNSVUZCYzBJNVJDeFBRVUYwUWl4SFFVRm5RelJETEdGQlFYQkRMRVZCUVcxRU8wRkJRMnBFUVN3d1FrRkJaMEo0UXl4TlFVRk5PRVlzVlVGQlRpeERRVUZwUW5CRExFZEJRV3BDTEVWQlFYTkNPVVFzVDBGQmRFTTdRVUZEUkR0QlFVTkdMRTlCU2tRN08wRkJUVUVzWVVGQlQyOUhMR0ZCUVdGdVJDeFBRVUZQVEN4alFVRmpPVVlzUzBGQlpDeERRVUZ2UWl4SFFVRndRaXhGUVVGNVFpeERRVUY2UWl4RFFVRlFMRU5CUVhCQ08wRkJRMFE3T3p0NVEwRkZiMEk3UVVGQlFUczdRVUZEYmtJc1ZVRkJTWE5FTEZGQlFWRXNTVUZCV2pzN1FVRkZRU3hWUVVGSmFVY3NaVUZCWldwSExFMUJRVTByUXl4SlFVRk9MRWRCUVdFc1dVRkJhRU03UVVGRFFTOUdMR05CUVZGblF5eEhRVUZTTEVOQlFWa3NjME5CUVZvc1JVRkJiMFJuUWl4TlFVRk5PRVlzVlVGQk1VUTdRVUZEUVN4VlFVRkpPVVlzVFVGQlRUaEdMRlZCUVZZc1JVRkJjMEk3UVVGRGNFSTVSaXhqUVVGTk9FWXNWVUZCVGl4RFFVRnBRbTVJTEU5QlFXcENMRU5CUVhsQ0xGVkJRVU4xU0N4TFFVRkVMRVZCUVZjN1FVRkRiRU1zWTBGQlNVTXNWMEZCVjBZc1pVRkJaVU1zUzBGQk9VSTdRVUZEUVN4alFVRkpSU3hYUVVGWGNFY3NUVUZCVFUwc1NVRkJUaXhEUVVGWFJ5eFhRVUZZTEVOQlFYVkNNRVlzVVVGQmRrSXNSVUZCYVVNc1ZVRkJRM3BHTEVkQlFVUXNSVUZCVXp0QlFVTjJSRHRCUVVOQkxHZENRVUZKUVN4SlFVRkpNRU1zU1VGQlNpeExRVUZoTEU5QlFVdHFSQ3hOUVVGMFFpeEZRVUU0UWp0QlFVTTFRbTVFTEhOQ1FVRlJaME1zUjBGQlVpeERRVUZaTERKQ1FVRmFMRVZCUVhsRE1FSXNSMEZCZWtNN1FVRkRRU3h6UWtGQlVVRXNTVUZCU1RkRUxFbEJRVm83UVVGRFJTeHhRa0ZCU3l4UlFVRk1PMEZCUVdWdFJDeDNRa0ZCVFhGSExHTkJRVTRzUTBGQmNVSXpSaXhIUVVGeVFpeEZRVUV5UWp0QlFVTXhReXh4UWtGQlN5eFJRVUZNTzBGQlFXVXhSQ3d3UWtGQlVXZERMRWRCUVZJc1EwRkJXVEJDTEVkQlFWb3NSVUZCYTBJN1FVRkRha003UVVGQlUxWXNkMEpCUVUxelJ5eGxRVUZPTEVOQlFYTkNOVVlzUjBGQmRFSXNSVUZCTkVJN1FVRklka003UVVGTFJEdEJRVU5HTEZkQlZtTXNRMEZCWmpzN1FVRlpRVllzWjBKQlFVMHJSaXhyUWtGQlRpeERRVUY1UW14SUxFbEJRWHBDTEVOQlFUaENkVWdzVVVGQk9VSTdRVUZEUkN4VFFXWkVPMEZCWjBKRU8wRkJRMFk3T3p0M1EwRkZiVUk3UVVGRGJFSXNWVUZCU1hCSExGRkJRVkVzU1VGQldqczdRVUZGUVVFc1dVRkJUU3RHTEd0Q1FVRk9MRU5CUVhsQ2NFZ3NUMEZCZWtJc1EwRkJhVU1zVlVGQlEzbElMRkZCUVVRc1JVRkJZenRCUVVNM1EwRXNhVUpCUVZOMlJpeE5RVUZVTzBGQlEwUXNUMEZHUkRzN1FVRkpRU3d3UWtGQldXSXNUVUZCVFRSRExHZENRVUZzUWl4RlFVRnZRMnBGTEU5QlFYQkRMRU5CUVRSRExGVkJRVU1yUlN4SFFVRkVMRVZCUVZNN1FVRkRia1F4UkN4alFVRk5ORU1zWjBKQlFVNHNRMEZCZFVKakxFZEJRWFpDTEVWQlFUUkNNME1zYVVKQlFUVkNPMEZCUTBRc1QwRkdSRHRCUVVkRU96dEJRVVZFT3pzN096czdPenM3UVVFNFFrRTdPenMwUWtGSFVUdEJRVU5PTzBGQlEwRXNXVUZCVFN4cFFrRkJUanRCUVVORU96dEJRVVZFT3pzN096czdOa0pCUjFNN1FVRkRVRHRCUVVOQkxGbEJRVTBzYVVKQlFVNDdRVUZEUkRzN1FVRkZSRHM3T3pzN096SkNRVWRQTzBGQlEwdzdRVUZEUVN4WlFVRk5MR2xDUVVGT08wRkJRMFE3TzBGQlJVUTdPenM3T3pzN096czdOa0pCVDFNeVFpeFJMRVZCUVZVM1F5eFhMRVZCUVdFNVF5eFJMRVZCUVZVN1FVRkRlRU1zVlVGQlNXbEVMRkZCUVZFc1NVRkJXanM3UVVGRlFUdEJRVU5CUVN4WlFVRk5SU3hSUVVGT08wRkJRMEVzVlVGQlNYRkhMR0ZCUVdGMlJ5eE5RVUZOUnl4TlFVRk9MRWRCUVdVc1IwRkJaaXhIUVVGeFFrZ3NUVUZCVFVVc1VVRkJOVU03UVVGRFFTeFZRVUZKYzBjc1pVRkJaWGhITEUxQlFVMHJReXhKUVVGT0xFZEJRV0VzV1VGQllpeEhRVUUwUWt3c1VVRkJMME03TzBGQlJVRTdRVUZEUVN4VlFVRkpLMFFzWVVGQllUdEJRVU5tTlVvc1kwRkJUU3hSUVVSVExFVkJRME4xUnl4TlFVRk5jRVFzVFVGQlRVY3NUVUZFWWl4RlFVTnhRbXRFTEVsQlFVbHRSQ3haUVVSNlFqdEJRVVZtY0VZc1kwRkJUU3hGUVVGRmJVTXNWVUZCVldkRUxGVkJRVm9zUlVGQmQwSnNTeXhQUVVGUGQwUXNWMEZCTDBJN1FVRkdVeXhQUVVGcVFqczdRVUZMUVN4VlFVRkpPVU1zVVVGQlNpeEZRVUZ0UWp0QlFVRkZNRW9zYlVKQlFWZHlSaXhKUVVGWUxFTkJRV2RDY2tVc1VVRkJhRUlzUjBGQk1rSkJMRkZCUVROQ08wRkJRWE5ET3p0QlFVVXpSRHRCUVVOQkxGVkJRVWtzUTBGQlEybEVMRTFCUVUxM1JpeHhRa0ZCV0N4RlFVRnJRMmxDTEZkQlFWZHlSaXhKUVVGWUxFTkJRV2RDYlVVc2IwSkJRV2hDTEVkQlFYVkRka1lzVFVGQlRYZEdMSEZDUVVFM1F6czdRVUZGYkVNN1FVRkRRU3hoUVVGUExITkNRVUZaTEZWQlFVTnJRaXhQUVVGRUxFVkJRV0U3UVVGRE9VSXNXVUZCU1ROSExGRkJRVkZETEUxQlFVMU5MRWxCUVU0c1EwRkJWMnRFTEZkQlFWZ3NRMEZCZFVKcFJDeFZRVUYyUWl4RFFVRmFPenRCUVVWQmVrb3NaMEpCUVZGblF5eEhRVUZTTEVOQlFWa3NORUpCUVRSQ1owSXNUVUZCVFVjc1RVRkJiRU1zUjBGQk1rTXNUVUZCZGtRc1JVRkJLMFJ6Unl4VlFVRXZSRHRCUVVOQkxGbEJRVWxGTEZkQlFWY3NPRUpCUVc5Q00wY3NTMEZCY0VJc1JVRkJNa0oxUnl4VlFVRXpRaXhGUVVGMVF6RkhMRmRCUVhaRExFVkJRVzlFUnl4TlFVRk5SeXhOUVVFeFJDeEZRVUZyUlVvc1MwRkJiRVVzUTBGQlpqdEJRVU5CTkVjc2FVSkJRVk5ETEZGQlFWUXNRMEZCYTBJc1ZVRkJRekZHTEV0QlFVUXNSVUZCVnp0QlFVTXpRbXhDTEdkQ1FVRk5aMFVzVTBGQlRpeERRVUZuUWpsRExFdEJRV2hDTEVWQlFYVkNMRVZCUVVWb1JDeE5RVUZOYzBrc1dVRkJVaXhGUVVGelFqVkhMRk5CUVZNeVJ5eFZRVUV2UWl4RlFVRjJRanRCUVVORUxGTkJSa1E3TzBGQlNVRjJSeXhqUVVGTk5FTXNaMEpCUVU0c1EwRkJkVUl5UkN4VlFVRjJRaXhKUVVGeFEwa3NVVUZCY2tNN08wRkJSVUZFTEdkQ1FVRlJReXhSUVVGU08wRkJRMFFzVDBGYVRTeERRVUZRTzBGQllVUTdPMEZCUlVRN096czdPenM3SzBKQlNWY3pSaXhSTEVWQlFWVTdRVUZEYmtJc1YwRkJTelpHTEhGQ1FVRk1MRWRCUVRaQ04wWXNVVUZCTjBJN1FVRkRSRHM3UVVGRlJEczdPenR0UTBGRFpVNHNSeXhGUVVGTE8wRkJRMnhDTEZWQlFVbFdMRkZCUVZFc1NVRkJXanRCUVVOQkxGVkJRVWwxUnl4aFFVRmhOMFlzU1VGQlNWVXNTVUZCU2l4RFFVRlRiVU1zVVVGQk1VSTdPMEZCUlVGMlJ5eGpRVUZSWjBNc1IwRkJVaXhEUVVGWkxEUkNRVUUwUW1kQ0xFMUJRVTFITEUxQlFXeERMRWRCUVRKRExFMUJRWFpFTEVWQlFTdEVUeXhIUVVFdlJEdEJRVU5CTEZWQlFVbHBSeXhYUVVGWExEaENRVUZ2UWpOSExFdEJRWEJDTEVWQlFUSkNkVWNzVlVGQk0wSXNSVUZCZFVNM1JpeEpRVUZKVlN4SlFVRktMRU5CUVZNdlJTeExRVUZvUkN4RFFVRm1PMEZCUTBFeVJDeFpRVUZOTkVNc1owSkJRVTRzUTBGQmRVSXlSQ3hWUVVGMlFpeEpRVUZ4UTBrc1VVRkJja003TzBGQlJVRkhMR2xDUVVGWExGbEJRVTA3UVVGRFpqdEJRVU5CT1Vjc1kwRkJUVTBzU1VGQlRpeERRVUZYYTBRc1YwRkJXQ3hEUVVGMVFqdEJRVU55UWpkRExHTkJRVWxFTEVsQlFVbERMRVZCUkdFc1JVRkRWRGxFTEUxQlFVMHNWVUZFUnl4RlFVTlRkVWNzVFVGQlRURkRMRWxCUVVreVF5eEZRVVJ1UWl4RlFVTjFRa0VzU1VGQlNUTkRMRWxCUVVrd1F5eEpRVVF2UWp0QlFVVnlRbWhETEdkQ1FVRk5MRVZCUVVWRkxFMUJRVTBzUjBGQlVpeEZRVUZoUkN4UlFVRlJja0lzVFVGQlRVY3NUVUZCTTBJN1FVRkdaU3hUUVVGMlFqdEJRVWxFTEU5QlRrUTdPMEZCVVVFc1ZVRkJTV1VzVVVGQlVUdEJRVU5XY2tVc1kwRkJUVFpFTEVsQlFVazNSQ3hKUVVSQk8wRkJSVloxUnl4alFVRk5NVU1zU1VGQlNUQkRMRWxCUmtFN1FVRkhWbXhJTEdGQlFVdDNSU3hKUVVGSk1rTXNSVUZJUXp0QlFVbFdhRWdzWlVGQlQzRkZMRWxCUVVsVkxFbEJRVW9zUTBGQlV5OUZMRXRCU2s0N1FVRkxWblZFTEdsQ1FVRlRNa2NzVlVGTVF6dEJRVTFXZUVvc2EwSkJRVlV5UkN4SlFVRkpWU3hKUVVGS0xFTkJRVk55UlR0QlFVNVVMRTlCUVZvN08wRkJVMEVzVlVGQlNXbEVMRTFCUVUwMlJ5eHhRa0ZCVml4RlFVRnBRenRCUVVNdlFqZEtMR2RDUVVGUlowTXNSMEZCVWl4RFFVRlpMSE5DUVVGYUxFVkJRVzlEYTBNc1MwRkJjRU03UVVGRFFXeENMR05CUVUwMlJ5eHhRa0ZCVGl4RFFVRTBRak5HTEV0QlFUVkNPMEZCUTBRN1FVRkRSanM3UVVGRlJEczdPenM0UWtGRFZVRXNTeXhGUVVGUE5rWXNVeXhGUVVGWE8wRkJRekZDTEZWQlFVa3ZSeXhSUVVGUkxFbEJRVm83TzBGQlJVRkJMRmxCUVUxeFF5eFJRVUZPT3p0QlFVVkJMRlZCUVVseVF5eE5RVUZOTmtZc1QwRkJUaXhMUVVGclFpeEpRVUYwUWl4RlFVRTBRanRCUVVNeFFqdEJRVU5CTEZsQlFVbHRRaXhaUVVGWk8wRkJRMlJ1U3l4blFrRkJUU3hSUVVSUkxFVkJRMFYxUnl4TlFVRk5jRVFzVFVGQlRTdERMRWxCUkdRc1JVRkRiMEpOTEVsQlFVbHlSQ3hOUVVGTkswTXNTVUZCVGl4SFFVRmhMRlZCUkhKRE8wRkJSV1F6UWl4blFrRkJUU3hGUVVGRmFVVXNVMEZCVTNKR0xFMUJRVTF4UXl4UlFVRnFRaXhGUVVFeVFtaENMRkZCUVZGeVFpeE5RVUZOUnl4TlFVRjZReXhGUVVGcFJEaEhMRmRCUVZjdlJpeE5RVUZOTWtNc1MwRkJiRVU3UVVGR1VTeFRRVUZvUWpzN1FVRkxRVGRITEdkQ1FVRlJaME1zUjBGQlVpeERRVUZaTERaQ1FVRmFMRVZCUVRKRGEwTXNTMEZCTTBNc1JVRkJhMFEyUml4VFFVRnNSQ3hGUVVFMlJFTXNVMEZCTjBRN08wRkJSVUVzV1VGQlNUbEdMRTFCUVUxblJ5eExRVUZPTEV0QlFXZENMSGRDUVVGWFF5eE5RVUV2UWl4RlFVRjFRenRCUVVOeVF5eGpRVUZKYWtjc1RVRkJUV3RITEV0QlFVNHNTMEZCWjBJc2QwSkJRVmRETEUxQlFTOUNMRVZCUVhWRE8wRkJRM0pEVEN4elFrRkJWVFZHTEVsQlFWWXNRMEZCWlM5RkxFdEJRV1lzUjBGQmRVSTJSU3hOUVVGTlN5eEpRVUUzUWp0QlFVTkVPMEZCUTBZc1UwRktSQ3hOUVVsUE8wRkJRMHg1Uml4dlFrRkJWVFZHTEVsQlFWWXNRMEZCWld0SExHRkJRV1lzUjBGQkswSndSeXhOUVVGTlowY3NTMEZCY2tNN1FVRkRRVVlzYjBKQlFWVTFSaXhKUVVGV0xFTkJRV1V2UlN4TFFVRm1MRWRCUVhWQ05rVXNUVUZCVFVzc1NVRkJOMEk3UVVGRFFTeGpRVUZKVEN4TlFVRk5hMGNzUzBGQlRpeExRVUZuUWl4M1FrRkJWMGNzVFVGQkwwSXNSVUZCZFVNN1FVRkRja05RTEhOQ1FVRlZOVVlzU1VGQlZpeERRVUZsYjBjc1UwRkJaaXhIUVVFeVFuUkhMRTFCUVUxclJ5eExRVUZxUXp0QlFVTkVPMEZCUTBZN08wRkJSVVE3UVVGRFFTeFpRVUZKVEN4VFFVRktMRVZCUVdVN1FVRkRZa01zYjBKQlFWVXpSQ3hGUVVGV0xFZEJRV1V3UkN4VlFVRlZOMGtzU1VGQmVrSTdRVUZEUVRoSkxHOUNRVUZWTlVZc1NVRkJWaXhEUVVGbGJVTXNVVUZCWml4SFFVRXdRbmRFTEZWQlFWVnVTQ3hQUVVGd1F6dEJRVU5FT3p0QlFVVkVPMEZCUTBFc1dVRkJTU3hEUVVGRFNTeE5RVUZOZDBZc2NVSkJRVmdzUlVGQmEwTjNRaXhWUVVGVk5VWXNTVUZCVml4RFFVRmxiVVVzYjBKQlFXWXNSMEZCYzBOMlJpeE5RVUZOZDBZc2NVSkJRVFZET3p0QlFVVnNRM2hHTEdOQlFVMU5MRWxCUVU0c1EwRkJWMnRFTEZkQlFWZ3NRMEZCZFVKM1JDeFRRVUYyUWp0QlFVTkVPMEZCUTBZN08wRkJSVVE3T3pzN2EwTkJRMk5UTEU4c1JVRkJVeTlITEVjc1JVRkJTenRCUVVNeFFpeFZRVUZKVml4UlFVRlJMRWxCUVZvN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRXNWVUZCU1VFc1RVRkJUWEZETEZGQlFVNHNSMEZCYVVJc1EwRkJha0lzUzBGQmRVSXpRaXhKUVVGSlZTeEpRVUZLTEVOQlFWTnBSU3hQUVVGd1F5eEZRVUUyUXp0QlFVTXpRM0pHTEdOQlFVMXhReXhSUVVGT08wRkJRMEVzV1VGQlNXNUZMRTlCUVU5M1F5eEpRVUZKVlN4SlFVRktMRU5CUVZNMlJpeFRRVUZ3UWp0QlFVTkJMRmxCUVVrMVN5eFJRVUZSTEhOQ1FVRlZjVVVzU1VGQlNWVXNTVUZCU2l4RFFVRlRMMFVzUzBGQmJrSXNRMEZCV2p0QlFVTkJMRmxCUVVseFRDeGhRVUZoUkN4UlFVRlJSU3hWUVVGU0xFTkJRVzFDZWtvc1NVRkJia0lzUTBGQmFrSTdPMEZCUlVFc1dVRkJTWGRETEVsQlFVbFZMRWxCUVVvc1EwRkJVMnRITEdGQlFWUXNTMEZCTWtJc2QwSkJRVmROTEV0QlFURkRMRVZCUVdsRU8wRkJReTlETEdOQlFVbHNTQ3hKUVVGSlZTeEpRVUZLTEVOQlFWTnZSeXhUUVVGVUxFdEJRWFZDTEhkQ1FVRlhTeXhIUVVGMFF5eEZRVUV5UXp0QlFVTjZReXhuUWtGQlNVTXNUVUZCVFVvc1YwRkJWeTlLTEVkQlFYSkNPMEZCUTBFc1owSkJRVWxqTEZGQlFWRnBTaXhYUVVGWFN5eEpRVUYyUWp0QlFVTkJReXhyUWtGQlRVTXNVMEZCVGl4RFFVRm5Ra01zVFVGQmFFSXNRMEZCZFVKRExFdEJRWFpDTEVOQlFUWkNUQ3hIUVVFM1FpeEZRVUZyUXl4RFFVRkRja29zUzBGQlJDeEZRVUZSTEVOQlFWSXNSVUZCVjJNc1RVRkJXQ3hEUVVGclFteEVMRXRCUVd4Q0xFTkJRV3hETzBGQlEwUXNWMEZLUkN4TlFVbFBMRWxCUVVseFJTeEpRVUZKVlN4SlFVRktMRU5CUVZOdlJ5eFRRVUZVTEV0QlFYVkNMSGRDUVVGWFNDeE5RVUYwUXl4RlFVRTRRenRCUVVOdVJDeG5Ra0ZCU1ZNc1QwRkJUVW9zVjBGQlZ5OUtMRWRCUVhKQ08wRkJRMEVzWjBKQlFVbGpMRk5CUVZGcFNpeFhRVUZYU3l4SlFVRjJRanRCUVVOQlJDeHBRa0ZCU1Vrc1RVRkJTaXhEUVVGWGVrb3NUVUZCV0N4RlFVRnJRbkJETEV0QlFXeENPMEZCUTBRc1YwRktUU3hOUVVsQk8wRkJRMHh4VEN4MVFrRkJWeTlLTEVkQlFWZ3NRMEZCWlN0S0xGZEJRVmRMTEVsQlFURkNMRWxCUVd0RE1Vd3NTMEZCYkVNc1EwRkVTeXhEUVVOdlF6dEJRVU14UXp0QlFVTkdMRk5CV2tRc1RVRlpUenRCUVVOTUxHTkJRVWx4UlN4SlFVRkpWU3hKUVVGS0xFTkJRVk12UlN4TFFVRmlMRVZCUVc5Q08wRkJRMnhDY1V3c2RVSkJRVmN2U2l4SFFVRllMRU5CUVdVclNpeFhRVUZYU3l4SlFVRXhRaXhKUVVGclF6Rk1MRXRCUVd4RExFTkJSR3RDTEVOQlEzVkNPMEZCUXpGRExGZEJSa1FzVFVGRlR6dEJRVU5NTEcxQ1FVRlBjVXdzVjBGQlZ5OUtMRWRCUVZnc1EwRkJaU3RLTEZkQlFWZExMRWxCUVRGQ0xFTkJRVkFzUTBGRVN5eERRVU50UXp0QlFVTjZRenRCUVVOR08wRkJRMFlzVDBGNlFrUXNUVUY1UWs4N1FVRkRURHRCUVVOQkwwc3NaMEpCUVZGblF5eEhRVUZTTEVOQlFWa3NjME5CUVhORFowSXNUVUZCVFhGRExGRkJRVFZETEVkQlFYVkVMRmRCUVhaRUxFZEJRWEZGTTBJc1NVRkJTVlVzU1VGQlNpeERRVUZUYVVVc1QwRkJPVVVzUjBGQmQwWXNSMEZCY0VjN1FVRkRSRHRCUVVOR096dEJRVVZFT3pzN08yOURRVU5uUWpORkxFY3NSVUZCU3p0QlFVTnVRaXhWUVVGSlZpeFJRVUZSTEVsQlFWbzdRVUZEUVdoRUxHTkJRVkZuUXl4SFFVRlNMRU5CUVZrc2JVSkJRVm9zUlVGQmFVTm5RaXhOUVVGTlJ5eE5RVUYyUXl4RlFVRXJRMDhzUjBGQkwwTTdPMEZCUlVFc1ZVRkJTV1FzVlVGQlZXTXNTVUZCU1ZVc1NVRkJTaXhEUVVGVGJVTXNVVUZCZGtJN1FVRkRRU3hWUVVGSllpeFhRVUZYTVVNc1RVRkJUVFJETEdkQ1FVRk9MRU5CUVhWQ2FFUXNUMEZCZGtJc1EwRkJaanM3UVVGRlFTeFZRVUZKT0VNc1VVRkJTaXhGUVVGak8wRkJRMW94UXl4alFVRk5aMFFzWVVGQlRpeERRVUZ2UWs0c1UwRkJVM0pETEZGQlFUZENMRVZCUVhWRFN5eEhRVUYyUXp0QlFVTkVMRTlCUmtRc1RVRkZUenRCUVVOTU1VUXNaMEpCUVZGblF5eEhRVUZTTEVOQlFWa3NlVUpCUVZvc1JVRkJkVU5aTEU5QlFYWkRPMEZCUTBRN1FVRkRSanM3TzNkQ1FTOU9VenRCUVVGRkxHRkJRVThzUzBGQlMyMUVMRWxCUVZvN1FVRkJiVUk3TzBGQlJTOUNPenM3T3pzN08zZENRVWxoTzBGQlFVVXNZVUZCVHl4TFFVRkxkVUlzVDBGQldqdEJRVUZ6UWpzN1FVRkZja003T3pzN096czdkMEpCU1dFN1FVRkJSU3hoUVVGUExFdEJRVXQxUWl4UFFVRmFPMEZCUVhOQ096dEJRVVZ5UXpzN096czdPenQzUWtGSlZ6dEJRVUZGTEdGQlFVOHNTMEZCUzNoR0xGRkJRVXdzUTBGQlkydENMRWxCUVhKQ08wRkJRVFJDT3p0QlFVVjZRenM3T3pzN096dDNRa0ZKWjBJN1FVRkJSU3hoUVVGUExFdEJRVXR4UWl4blFrRkJXanRCUVVFclFqczdPMHRCY0V0dVJEczdPenM3T3pzN096czdPenM3T3pzN096czdPenM3YTBKQksxZGxaMFFzVlRzN096czdPenM3T3pzN096czdPenM3T3pzN096czdRVU12VjJZN08wRkJRMEU3T3pzN1FVRkZRU3hKUVVGTmQwTXNZVUZCWVN4RlFVRkRVaXhQUVVGUExHZENRVUZTTEVWQlFUQkNWQ3hSUVVGUkxHbENRVUZzUXl4RlFVRnVRanM3UVVGRlFUczdPenM3TzBsQlMwMXJRaXhWTzBGQlJVb3NjMEpCUVZsNFNTeFhRVUZhTEVWQlFYbENPMEZCUVVFN08wRkJRM1pDTEZGQlFVbEhMRkZCUVZFc1NVRkJXanM3UVVGRlFVRXNWVUZCVFd0RUxGVkJRVTRzUjBGQmJVSXNSVUZCYmtJN1FVRkRRV3hFTEZWQlFVMXpReXhSUVVGT0xFZEJRV2xDTEVWQlFXcENPenRCUVVWQkxGTkJRVXRuUnl4TFFVRk1MRWRCUVdGNlNTeGxRVUZsTEVWQlFUVkNPenRCUVVWQkxGTkJRVXN3U1N4blFrRkJUQ3hEUVVGelFpeExRVUZMUkN4TFFVRXpRanRCUVVORU96czdPelJDUVVsUGRFZ3NVU3hGUVVGVk8wRkJRMmhDTEZkQlFVdHJReXhWUVVGTUxFTkJRV2RDY2tVc1NVRkJhRUlzUTBGQmNVSnRReXhSUVVGeVFqdEJRVU5FT3pzN2VVSkJSVWs1UXl4SkxFVkJRVTA3UVVGRFZDeFZRVUZKUXl4UFFVRlBMRFJDUVVGblFrUXNTVUZCYUVJc1EwRkJXRHM3UVVGRlFTeGhRVUZQTEV0QlFVdHpTeXhqUVVGTUxFTkJRVzlDY2tzc1NVRkJjRUlzUTBGQlVEdEJRVU5FT3pzN0swSkJSVlZFTEVrc1JVRkJUVHRCUVVObUxGVkJRVWwwUWl4VFFVRlRMRVZCUVdJN1FVRkRRU3hWUVVGSmRVSXNUMEZCVHl3MFFrRkJaMEpFTEVsQlFXaENMRU5CUVZnN1FVRkRRWFJDTEdGQlFVOXRUQ3hKUVVGUUxFZEJRV00xU2l4TFFVRkxjMHNzUjBGQlRDeEZRVUZrTzBGQlEwRTNUQ3hoUVVGUFpTeEhRVUZRTEVkQlFXRXNTMEZCU3paTExHTkJRVXdzUTBGQmIwSnlTeXhKUVVGd1FpeERRVUZpT3p0QlFVVkJMR0ZCUVU5MlFpeE5RVUZRTzBGQlEwUTdPenR0UTBGRlkzVkNMRWtzUlVGQlRUdEJRVU51UWl4VlFVRkpVaXhOUVVGTkxFdEJRVXN5U3l4TFFVRm1PMEZCUTBGdVN5eFhRVUZMVVN4UFFVRk1MRU5CUVdFc1ZVRkJRM1JETEV0QlFVUXNSVUZCVnp0QlFVTjBRbk5DTEdOQlFVMUJMRWxCUVVsMFFpeExRVUZLTEVOQlFVNDdRVUZEUkN4UFFVWkVPenRCUVVsQkxHRkJRVTl6UWl4SFFVRlFPMEZCUTBRN096dHhRMEZGWjBKRUxFMHNSVUZCVVR0QlFVRkJPenRCUVVWMlFpeFZRVUZKWjB3c1ZVRkJWU3hUUVVGV1FTeFBRVUZWTEVOQlFVTkRMRk5CUVVRc1JVRkJaVHM3UVVGRk0wSkJMR3RDUVVGVlF5eExRVUZXTEVOQlFXZENMRlZCUVVORExFMUJRVVFzUlVGQldUdEJRVU14UWl4cFFrRkJTME1zVlVGQlRDeERRVUZuUWtRc1RVRkJhRUk3UVVGRFJDeFRRVVpFTzBGQlNVUXNUMEZPUkRzN1FVRlJRU3hYUVVGTFVDeExRVUZNTEVkQlFXRlRMRTlCUVU5RExGZEJRVkFzUTBGQmJVSjBUQ3hOUVVGdVFpeEZRVUV5UW1kTUxFOUJRVE5DTEVOQlFXSTdRVUZGUkRzN095dENRVVZWZUVnc1N5eEZRVUZQTzBGQlEyaENMRmRCUVV0blF5eFZRVUZNTEVOQlFXZENka1VzVDBGQmFFSXNRMEZCZDBJc1ZVRkJRM0ZETEZGQlFVUXNSVUZCWXp0QlFVTndRMEVzYVVKQlFWTkZMRXRCUVZRN1FVRkRSQ3hQUVVaRU8wRkJSMFE3T3pzclFrRkZWVEpJTEUwc1JVRkJVVHM3UVVGRmFrSXNWVUZCU1d4TUxFMUJRVTFyVEN4UFFVRlBia3dzVFVGQmFrSTdRVUZEUVN4VlFVRkpkVXdzWjBKQlFVbzdPMEZCUlVFc1ZVRkJTWFJNTEVsQlFVbDFUQ3hYUVVGS0xFdEJRVzlDU0N4TlFVRjRRaXhGUVVGblF6dEJRVU01UWtVc2EwSkJRVlZGTEZkQlFWZG9ReXhOUVVGeVFqdEJRVU5FT3p0QlFVVkVMRlZCUVVsNFNpeEpRVUZKZFV3c1YwRkJTaXhMUVVGdlFteENMRXRCUVhoQ0xFVkJRU3RDTzBGQlF6ZENhVUlzYTBKQlFWVkZMRmRCUVZkMlFpeExRVUZ5UWp0QlFVTkVPenRCUVVWRUxGVkJRVWwzUWl4alFVRmpVQ3hQUVVGUFVTeFBRVUY2UWpzN1FVRkZRVHRCUVVOQk96dEJRVVZCTzBGQlEwRXNWVUZCU1VNc1YwRkJWek5NTEVsQlFVbHJUQ3hQUVVGUFZTeEpRVUZZTEVOQlFXWTdPMEZCUlVFN08wRkJSVUVzVlVGQlNWWXNUMEZCVDJoTkxFbEJRVkFzUzBGQlowSXNVVUZCYUVJc1NVRkJORUlzUTBGQlEzVk5MRmxCUVZsNlRTeFJRVUZhTEVOQlFYRkNMRk5CUVhKQ0xFTkJRV3BETEVWQlFXdEZPMEZCUTJoRkxHRkJRVXMyVFN4VlFVRk1MRU5CUVdkQ08wRkJRMlJ3UXl4cFFrRkJUM0ZETEZkQlFWZHNReXhOUVVSS08wRkJSV1JNTEdsQ1FVRlBLMElzVDBGR1R6dEJRVWRrY0VZc2FVSkJRVTkxUml4WFFVaFBPMEZCU1dRM1NDeG5Ra0ZCVFN0SU8wRkJTbEVzVTBGQmFFSTdRVUZOUkRzN1FVRkZSQ3hWUVVGSlZDeFBRVUZQYUUwc1NVRkJVQ3hMUVVGblFpeExRVUZ3UWl4RlFVRXlRanRCUVVONlFpeGhRVUZMTWswc1ZVRkJUQ3hEUVVGblFqdEJRVU5rY0VNc2FVSkJRVTl4UXl4WFFVRlhOVUlzUjBGRVNqdEJRVVZrV0N4cFFrRkJUeXRDTEU5QlJrODdRVUZIWkhCR0xHbENRVUZQZFVZc1YwRklUenRCUVVsa04wZ3NaMEpCUVUwclNEdEJRVXBSTEZOQlFXaENPMEZCVFVRN08wRkJSVVFzVlVGQlNWUXNUMEZCVDJoTkxFbEJRVkFzUzBGQlowSXNVVUZCY0VJc1JVRkJPRUk3UVVGRE5VSXNZVUZCU3pKTkxGVkJRVXdzUTBGQlowSTdRVUZEWkhCRExHbENRVUZQY1VNc1YwRkJWM0JETEUxQlJFbzdRVUZGWkVnc2FVSkJRVThyUWl4UFFVWlBPMEZCUjJSd1JpeHBRa0ZCVDNWR08wRkJTRThzVTBGQmFFSTdRVUZMUkR0QlFVTkdPenM3ZDBKQmJFZFZPMEZCUVVVc1lVRkJUeXhMUVVGTFpDeExRVUZhTzBGQlFXOUNPenM3T3p0QlFYTkhOVUlzU1VGQlNXMUNMR3REUVVGaExFVkJRVU5zUXl4UlFVRlJMRkZCUVZRc1JVRkJiVUpOTEV0QlFVc3NTMEZCZUVJc1JVRkJLMEpTTEZGQlFWRXNVVUZCZGtNc1JVRkJha0k3UVVGRFFTeEpRVUZKT0VJc2EwTkJRV0VzUlVGQlEyaERMRkZCUVZFc1VVRkJWQ3hGUVVGdFFsTXNUMEZCVHl4UFFVRXhRaXhGUVVGcVFqdHJRa0ZEVVZNc1ZUczdPenM3T3p0QlF5OUlaanM3UVVGRlFUczdRVUZGUVRzN1FVRkZRVHM3UVVGRlFUczdRVUZGUVRzN1FVRkZRU3h6UTBGQmMwTXNkVU5CUVhWRExHZENRVUZuUWpzN1FVRkZOMFk3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTEV0QlFVczdRVUZEVER0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSU8wRkJRMEVzUjBGQlJ6dEJRVU5JT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRXNSVHM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPMEZEWmtFN08wRkJSVUU3T3pzN1FVRkRRVHM3T3p0QlFVTkJPenM3T3pzN1FVRkZRVHM3T3pzN1FVRTFRa0U3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN1NVRnBRMDF4UWl4UE8wRkJRMG83T3pzN096czdPenM3T3p0QlFXVkJPenM3T3pzN1FVRk5RU3h0UWtGQldUVktMRXRCUVZvc1JVRkJiVUkyU2l4SFFVRnVRaXhGUVVGM1FrTXNUVUZCZUVJc1JVRkJaME03UVVGQlFUczdRVUZET1VJc1VVRkJTVFZLTEZGQlFWRXNTVUZCV2pzN1FVRkZRVUVzVlVGQlRVY3NUVUZCVGl4SFFVRmxUQ3hMUVVGbU8wRkJRMEZGTEZWQlFVMU5MRWxCUVU0c1IwRkJZWEZLTEVkQlFXSTdPMEZCUlVFelNpeFZRVUZOYzBRc1QwRkJUaXhIUVVGblFuTkhMRTlCUVU5RExGVkJRVkFzUjBGQmIwSXNTMEZCY0VNN08wRkJSVUUzU2l4VlFVRk5lVVVzVlVGQlRpeEhRVUZ0UWl4RlFVRnVRanRCUVVOQmVrVXNWVUZCVFd0RUxGVkJRVTRzUjBGQmJVSXNSVUZCYmtJN1FVRkRRV3hFTEZWQlFVMDRTaXhoUVVGT0xFZEJRWE5DTEVWQlFYUkNPenRCUVVWQlNDeFJRVUZKYkVvc1YwRkJTaXhEUVVGblFsZ3NTMEZCYUVJc1JVRkJkVUlzVlVGQlExa3NSMEZCUkN4RlFVRlRPMEZCUXpsQ08wRkJRMEVzVlVGQlNVRXNTVUZCU1RCRExFbEJRVW9zUzBGQllYUkVMRXRCUVdwQ0xFVkJRWGRDTzBGQlEzUkNPVU1zWjBKQlFWRXJUU3hKUVVGU0xFTkJRV0VzZVVKQlFXSXNSVUZCZDBOeVNpeEhRVUY0UXl4RlFVRTJRMVlzUzBGQk4wTTdRVUZEUVN4blFrRkJVVlVzU1VGQlNUZEVMRWxCUVZvN1FVRkRSU3hsUVVGTExGTkJRVXc3UVVGQlowSnRSQ3hyUWtGQlRXZExMRlZCUVU0c1EwRkJhVUowU2l4SFFVRnFRaXhGUVVGMVFqdEJRVU4yUXl4bFFVRkxMRkZCUVV3N1FVRkJaVllzYTBKQlFVMXBTeXhsUVVGT0xFTkJRWE5DZGtvc1IwRkJkRUlzUlVGQk5FSTdRVUZETTBNc1pVRkJTeXhSUVVGTU8wRkJRV1ZXTEd0Q1FVRk5hMHNzWlVGQlRpeERRVUZ6UW5oS0xFZEJRWFJDTEVWQlFUUkNPMEZCU0RkRE8wRkJTMFE3UVVGRFJpeExRVlpFTzBGQlYwUTdPMEZCUlVRN096czdPenM3T3pzN1FVRnJRa0U3T3pzN096czdPenM3TWtKQlZVOXhRaXhOTEVWQlFWRnZReXhUTEVWQlFWZDBSU3hYTEVWQlFXMUVPMEZCUVVFc1ZVRkJkRU56U3l4TFFVRnpReXgxUlVGQk9VSXNTMEZCT0VJN1FVRkJRU3hWUVVGMlFrTXNSMEZCZFVJc2RVVkJRV3BDTEV0QlFXbENPMEZCUVVFc1ZVRkJWbkpPTEZGQlFWVTdPenRCUVVVelJTeFZRVUZKTEVOQlFVTm5SaXhOUVVGTUxFVkJRV0VzVFVGQlRUVkdMRTFCUVUwc09FUkJRVTRzUTBGQlRqdEJRVU5pTEZWQlFVa3NRMEZCUTJkSkxGTkJRVXdzUlVGQlowSXNUVUZCVFdoSkxFMUJRVTBzY1VSQlFVNHNRMEZCVGp0QlFVTm9RaXhWUVVGSkxFTkJRVU13UkN4WFFVRk1MRVZCUVd0Q0xFMUJRVTB4UkN4TlFVRk5MSGRFUVVGT0xFTkJRVTQ3TzBGQlJXeENMRlZCUVVrMlJDeFJRVUZSTEVsQlFWbzdRVUZEUVN4VlFVRkpjVXNzVjBGQlZ5eEZRVUZtT3p0QlFVVkJRU3hsUVVGVFJDeEhRVUZVTEVkQlFXVkJMRWRCUVdZN1FVRkRRVU1zWlVGQlUwWXNTMEZCVkN4SFFVRnBRa0VzUzBGQmFrSTdRVUZEUVVVc1pVRkJVM1JKTEUxQlFWUXNSMEZCYTBKQkxFMUJRV3hDTzBGQlEwRnpTU3hsUVVGVGJFY3NVMEZCVkN4SFFVRnhRa0VzVTBGQmNrSTdRVUZEUVd0SExHVkJRVk40U3l4WFFVRlVMRWRCUVhWQ1FTeFhRVUYyUWpzN1FVRkZRU3hWUVVGSk9VTXNVVUZCU2l4RlFVRnRRanRCUVVGRmMwNHNhVUpCUVZOMFRpeFJRVUZVTEVkQlFXOUNRU3hSUVVGd1FqdEJRVUVyUWpzN1FVRkZjRVFzTkVKQlFXTnpUaXhSUVVGa0xFVkJRWGRDTEVWQlFVTm9SeXhSUVVGUkxFdEJRVlFzUlVGQmVFSTdPMEZCUlVGeVNDeGpRVUZSWjBNc1IwRkJVaXhEUVVGWkxHMUVRVUZhTEVWQlFXbEZjVXdzVVVGQmFrVTdPMEZCUlVFc1lVRkJUM0pMTEUxQlFVMXpTeXhQUVVGT0xFTkJRV05FTEZGQlFXUXNRMEZCVUR0QlFVTkVPenRCUVVWRU96czdPenM3T3p0dlEwRkxaMEpCTEZFc1JVRkJWVHRCUVVONFFpeFZRVUZKY2tzc1VVRkJVU3hKUVVGYU8wRkJRMEZvUkN4alFVRlJaME1zUjBGQlVpeERRVUZaTEcxRVFVRmFMRVZCUVdsRmNVd3NVVUZCYWtVN08wRkJSVUVzTkVKQlFXTkJMRkZCUVdRc1JVRkJkMElzUlVGQlEyaEhMRkZCUVZFc1NVRkJWQ3hGUVVGNFFqczdRVUZGUVN4aFFVRlBja1VzVFVGQlRYVkxMR0ZCUVU0c1EwRkJiMEpHTEZGQlFYQkNMRU5CUVZBN1FVRkRSRHM3UVVGRlJEczdPenM3T3pzN096czdPenM0UWtGVlZYUkpMRTBzUlVGQlVYbEpMRTBzUlVGQk5rUTdRVUZCUVN4VlFVRnlSRXdzUzBGQmNVUXNkVVZCUVRkRExFdEJRVFpETzBGQlFVRXNWVUZCZEVORExFZEJRWE5ETEhWRlFVRm9ReXhMUVVGblF6dEJRVUZCTEZWQlFYcENha2tzVFVGQmVVSXNkVVZCUVdoQ0xFbEJRV2RDTzBGQlFVRXNWVUZCVm5CR0xGRkJRVlU3TzBGQlF6ZEZMRlZCUVVscFJDeFJRVUZSTEVsQlFWbzdRVUZEUVN4VlFVRkpjVXNzVjBGQlZ5eEZRVUZtT3p0QlFVVkJRU3hsUVVGVFJDeEhRVUZVTEVkQlFXVkJMRWRCUVdZN1FVRkRRVU1zWlVGQlUwWXNTMEZCVkN4SFFVRnBRa0VzUzBGQmFrSTdRVUZEUVVVc1pVRkJVM1JKTEUxQlFWUXNSMEZCYTBKQkxFMUJRV3hDT3p0QlFVVkJjMGtzWlVGQlV6bEhMRkZCUVZRc1IwRkJiMEpwU0N4TlFVRndRanRCUVVOQkxGVkJRVWw2VGl4UlFVRktMRVZCUVcxQ08wRkJRVVZ6VGl4cFFrRkJVM1JPTEZGQlFWUXNSMEZCYjBKQkxGRkJRWEJDTzBGQlFTdENPenRCUVVWd1JEdEJRVU5CYzA0c1pVRkJVMnhKTEUxQlFWUXNSMEZCYTBKQkxFMUJRV3hDT3p0QlFVVkJia1lzWTBGQlVXZERMRWRCUVZJc1EwRkJXU3c0UTBGQldpeEZRVUUwUkhGTUxGRkJRVFZFT3p0QlFVVkJMRFJDUVVGalFTeFJRVUZrTEVWQlFYZENMRVZCUVVOb1J5eFJRVUZSTEV0QlFWUXNSVUZCZUVJN08wRkJSVUVzWVVGQlQzSkZMRTFCUVUxNVN5eFZRVUZPTEVOQlFXbENTaXhSUVVGcVFpeERRVUZRTzBGQlEwUTdPMEZCUlVRN096czdPenM3TzI5RFFVdG5Ra0VzVVN4RlFVRlZPMEZCUTNoQ0xGVkJRVWx5U3l4UlFVRlJMRWxCUVZvN1FVRkRRU3hWUVVGSk1Fc3NXVUZCV1V3c1dVRkJXU3hGUVVFMVFqczdRVUZGUVN3MFFrRkJZMHNzVTBGQlpDeEZRVUY1UWl4RlFVRkRja2NzVVVGQlVTeEpRVUZVTEVWQlFYcENPenRCUVVWQkxHRkJRVTl5UlN4TlFVRk5Na3NzWjBKQlFVNHNRMEZCZFVKRUxGTkJRWFpDTEVOQlFWQTdRVUZEUkRzN1FVRkZSRHM3T3pzN096czdlVUpCUzB0R0xFMHNSVUZCVVR0QlFVTllMRlZCUVVsNFN5eFJRVUZSTEVsQlFWbzdPMEZCUlVFN1FVRkRRVHRCUVVOQkxGVkJRVWswU3l4VlFVRlZPMEZCUTFvdlRpeGpRVUZOTEUxQlJFMHNSVUZEUlhWSExFMUJRVTF3UkN4TlFVRk5SeXhOUVVSa0xFVkJRM05DYTBRc1NVRkJTVzFJTzBGQlJERkNMRTlCUVdRN08wRkJTVUVzWVVGQlR5eHpRa0ZCV1N4VlFVRkRPVVFzVDBGQlJDeEZRVUZWYWtJc1RVRkJWaXhGUVVGeFFqdEJRVU4wUTNwR0xHTkJRVTFOTEVsQlFVNHNRMEZCVjJ0RUxGZEJRVmdzUTBGQmRVSnZTQ3hQUVVGMlFpeEZRVUZuUXl4VlFVRkRia2dzUzBGQlJDeEZRVUZYTzBGQlEzcERla2NzYTBKQlFWRm5ReXhIUVVGU0xFTkJRVmtzYVVKQlFWb3NSVUZCSzBKNVJTeExRVUV2UWp0QlFVTkJMR05CUVVsQkxFMUJRVTF5UXl4SlFVRk9MRU5CUVZkRkxFbEJRVmdzUzBGQmIwSXNSMEZCZUVJc1JVRkJOa0k3UVVGRE0wSnZSaXh2UWtGQlVXcEVMRTFCUVUxeVF5eEpRVUZPTEVOQlFWY3ZSU3hMUVVGdVFqdEJRVU5FTEZkQlJrUXNUVUZGVHp0QlFVTk1iMG9zYlVKQlFVOW9ReXhOUVVGTmNrTXNTVUZCVGl4RFFVRlhkVVVzU1VGQmJFSTdRVUZEUkR0QlFVTkdMRk5CVUVRN1FVRlJSQ3hQUVZSTkxFTkJRVkE3UVVGVlJEczdRVUZGUkRzN096czdPenM3YlVOQlMyVXpSU3hSTEVWQlFWVTdRVUZEZGtJc1YwRkJTelpLTEhOQ1FVRk1MRWRCUVRoQ04wb3NVVUZCT1VJN1FVRkRSRHM3T3pSQ1FVVlBjVW9zVVN4RlFVRlZPMEZCUTJoQ0xGVkJRVWx5U3l4UlFVRlJMRWxCUVZvN08wRkJSVUVzWVVGQlR5eHpRa0ZCV1N4VlFVRkRNRWNzVDBGQlJDeEZRVUZWYWtJc1RVRkJWaXhGUVVGeFFqdEJRVU4wUXl4WlFVRkpjRUlzVTBGQlUyZEhMRk5CUVZOb1J5eE5RVUYwUWp0QlFVTkJMRmxCUVVsNFJTeGpRVUZqZDBzc1UwRkJVM2hMTEZkQlFWUXNTVUZCZDBJc1JVRkJNVU03UVVGRFFTeFpRVUZKYTBNc1UwRkJVM05KTEZOQlFWTjBTU3hOUVVGMFFqczdRVUZGUVd4RExHOUNRVUZaYVV3c1VVRkJXaXhIUVVGMVFqbExMRTFCUVUxSExFMUJRVGRDTzBGQlEwRk9MRzlDUVVGWmEwTXNUVUZCV2l4SFFVRnhRbk5KTEZOQlFWTjBTU3hOUVVFNVFqczdRVUZGUVR0QlFVTkJMRmxCUVVrd1JTeGhRVUZoTzBGQlEyWTFTaXhuUWtGQlRTeFJRVVJUTEVWQlEwTjFSeXhOUVVGTmNFUXNUVUZCVFVjc1RVRkVZaXhGUVVOeFFtdEVMRWxCUVVseVJDeE5RVUZOYzBRc1QwRkVMMEk3UVVGRlpteERMR2RDUVVGTkxFVkJRVVZwUkN4UlFVRlJRU3hOUVVGV08wRkJSbE1zVTBGQmFrSTdPMEZCUzBGeVNDeG5Ra0ZCVVdkRExFZEJRVklzUTBGQldTeHpRa0ZCV2l4RlFVRnZRM0ZNTEZGQlFYQkRMRVZCUVRoRE5VUXNWVUZCT1VNN08wRkJSVUZCTEcxQ1FVRlhja1lzU1VGQldDeERRVUZuUWk5RkxFdEJRV2hDTEVkQlFYZENkMFFzVjBGQmVFSTdRVUZEUVRSSExHMUNRVUZYY2tZc1NVRkJXQ3hEUVVGblFqQktMRkZCUVdoQ0xFZEJRVEpDT1Vzc1RVRkJUVWNzVFVGQmFrTTdRVUZEUVhOSExHMUNRVUZYY2tZc1NVRkJXQ3hEUVVGblFsY3NUVUZCYUVJc1IwRkJlVUp6U1N4VFFVRlRkRWtzVFVGQmJFTTdPMEZCUlVFc1dVRkJTWE5KTEZOQlFWTkVMRWRCUVdJc1JVRkJhMEl6UkN4WFFVRlhja1lzU1VGQldDeERRVUZuUW1kS0xFZEJRV2hDTEVkQlFYTkNReXhUUVVGVFJDeEhRVUV2UWp0QlFVTnNRaXhaUVVGSlF5eFRRVUZUUml4TFFVRmlMRVZCUVc5Q01VUXNWMEZCVjNKR0xFbEJRVmdzUTBGQlowSXJTU3hMUVVGb1FpeEhRVUYzUWtVc1UwRkJVMFlzUzBGQmFrTTdRVUZEY0VJc1dVRkJTVVVzVTBGQlUyeEhMRk5CUVdJc1JVRkJkMEp6UXl4WFFVRlhja1lzU1VGQldDeERRVUZuUW0xRUxGTkJRV2hDTEVkQlFUUkNPRVlzVTBGQlUyeEhMRk5CUVhKRE8wRkJRM2hDTEZsQlFVbHJSeXhUUVVGVGRFNHNVVUZCWWl4RlFVRjFRakJLTEZkQlFWZHlSaXhKUVVGWUxFTkJRV2RDY2tVc1VVRkJhRUlzUjBGQk1rSnpUaXhUUVVGVGRFNHNVVUZCY0VNN08wRkJSWFpDUXl4blFrRkJVV2RETEVkQlFWSXNRMEZCV1N4MVEwRkJXaXhGUVVGeFJIbElMRlZCUVhKRU96dEJRVVZCTzBGQlEwRjZSeXhqUVVGTlRTeEpRVUZPTEVOQlFWZHJSQ3hYUVVGWUxFTkJRWFZDYVVRc1ZVRkJka0lzUlVGQmJVTXNWVUZCUTJoRUxFdEJRVVFzUlVGQlZ6dEJRVU0xUTNwSExHdENRVUZSWjBNc1IwRkJVaXhEUVVGWkxIZERRVUZhTEVWQlFYTkVlVVVzUzBGQmRFUTdRVUZEUVN4alFVRkpRU3hOUVVGTmNrTXNTVUZCVGl4RFFVRlhSU3hKUVVGWUxFdEJRVzlDTEVkQlFYaENMRVZCUVRaQ08wRkJRek5DTzBGQlEwRXNaMEpCUVVsclNpeFRRVUZUTDBjc1RVRkJUWEpETEVsQlFVNHNRMEZCVjIxRExGRkJRWGhDT3p0QlFVVkJMR2RDUVVGSmQwZ3NVMEZCVXl4cFEwRkJkVUl2U3l4TFFVRjJRaXhGUVVFNFFuZExMRTFCUVRsQ0xFVkJRWE5EZWtrc1RVRkJkRU1zUlVGQk9FTXNTVUZCT1VNc1JVRkJiMFJzUXl4WFFVRndSQ3hGUVVGcFJUUkVMRTFCUVUxeVF5eEpRVUZPTEVOQlFWYzBTaXhwUWtGQk5VVXNRMEZCWWp0QlFVTkJhRXdzYTBKQlFVMTVSU3hWUVVGT0xFTkJRV2xDSzBZc1RVRkJha0lzU1VGQk1rSlBMRTFCUVROQ096dEJRVVZCY2tVc2IwSkJRVkZ4UlN4TlFVRlNPMEZCUTBRc1YwRlNSQ3hOUVZGUE8wRkJRMHc3UVVGRFFYUkdMRzFDUVVGUGFFTXNUVUZCVFhKRExFbEJRVTRzUTBGQlYzVkZMRWxCUVd4Q08wRkJRMFE3UVVGRFJpeFRRV1JFTzBGQlpVUXNUMEV6UTAwc1EwRkJVRHRCUVRaRFJEczdPMnREUVVWaE1FVXNVU3hGUVVGVk8wRkJRVUU3TzBGQlEzUkNMRlZCUVVseVN5eFJRVUZSTEVsQlFWbzdPMEZCUlVFc1lVRkJUeXh6UWtGQldTeFZRVUZETUVjc1QwRkJSQ3hGUVVGVmFrSXNUVUZCVml4RlFVRnhRanRCUVVOMFF5eFpRVUZKY0VJc1UwRkJVMmRITEZOQlFWTm9SeXhOUVVGMFFqdEJRVU5CTEZsQlFVbDRSU3hqUVVGamQwc3NVMEZCVTNoTExGZEJRVlFzU1VGQmQwSXNSVUZCTVVNN08wRkJSVUU3UVVGRFFTeFpRVUZKTkVjc1lVRkJZVHRCUVVObU5Vb3NaMEpCUVUwc1VVRkVVeXhGUVVORGRVY3NUVUZCVFhCRUxFMUJRVTFITEUxQlJHSXNSVUZEY1VKclJDeEpRVUZKY2tRc1RVRkJUWE5FTEU5QlJDOUNPMEZCUldac1F5eG5Ra0ZCVFN4RlFVRkZhVVFzVVVGQlVVRXNUVUZCVmp0QlFVWlRMRk5CUVdwQ096dEJRVXRCY2tnc1owSkJRVkZuUXl4SFFVRlNMRU5CUVZrc2MwSkJRVm9zUlVGQmIwTnhUQ3hSUVVGd1F5eEZRVUU0UXpWRUxGVkJRVGxET3p0QlFVVkJRU3h0UWtGQlYzSkdMRWxCUVZnc1EwRkJaMEl2UlN4TFFVRm9RaXhIUVVGM1FuZEVMRmRCUVhoQ08wRkJRMEUwUnl4dFFrRkJWM0pHTEVsQlFWZ3NRMEZCWjBJdlJTeExRVUZvUWl4RFFVRnpRbmxQTEZGQlFYUkNMRWRCUVdsRE9Vc3NUVUZCVFVjc1RVRkJka003TzBGQlJVRXNXVUZCU1d0TExGTkJRVk5FTEVkQlFXSXNSVUZCYTBJelJDeFhRVUZYY2tZc1NVRkJXQ3hEUVVGblFtZEtMRWRCUVdoQ0xFZEJRWE5DUXl4VFFVRlRSQ3hIUVVFdlFqdEJRVU5zUWl4WlFVRkpReXhUUVVGVFJpeExRVUZpTEVWQlFXOUNNVVFzVjBGQlYzSkdMRWxCUVZnc1EwRkJaMElyU1N4TFFVRm9RaXhIUVVGM1FrVXNVMEZCVTBZc1MwRkJha003UVVGRGNFSXNXVUZCU1VVc1UwRkJVMnhITEZOQlFXSXNSVUZCZDBKelF5eFhRVUZYY2tZc1NVRkJXQ3hEUVVGblFtMUVMRk5CUVdoQ0xFZEJRVFJDT0VZc1UwRkJVMnhITEZOQlFYSkRPMEZCUTNoQ0xGbEJRVWxyUnl4VFFVRlRkRTRzVVVGQllpeEZRVUYxUWpCS0xGZEJRVmR5Uml4SlFVRllMRU5CUVdkQ2NrVXNVVUZCYUVJc1IwRkJNa0p6VGl4VFFVRlRkRTRzVVVGQmNFTTdPMEZCUlhaQ1F5eG5Ra0ZCVVdkRExFZEJRVklzUTBGQldTeDFRMEZCV2l4RlFVRnhSSGxJTEZWQlFYSkVPenRCUVVWQk8wRkJRMEY2Unl4alFVRk5UU3hKUVVGT0xFTkJRVmRyUkN4WFFVRllMRU5CUVhWQ2FVUXNWVUZCZGtJc1JVRkJiVU1zVlVGQlEyaEVMRXRCUVVRc1JVRkJWenRCUVVNMVEzcEhMR3RDUVVGUlowTXNSMEZCVWl4RFFVRlpMR2RFUVVGYUxFVkJRVGhFZVVVc1MwRkJPVVE3UVVGRFFTeGpRVUZKUVN4TlFVRk5ja01zU1VGQlRpeERRVUZYUlN4SlFVRllMRXRCUVc5Q0xFZEJRWGhDTEVWQlFUWkNPenRCUVVVelFpeG5Ra0ZCU1RKS0xHdENRVUZyUW5oSUxFMUJRVTF5UXl4SlFVRk9MRU5CUVZjdlJTeExRVUZxUXpzN1FVRkZRU3hwUWtGQlN5eEpRVUZKYjBNc1MwRkJWQ3hKUVVGclFuZE5MR1ZCUVd4Q0xFVkJRVzFET3p0QlFVVnFReXhyUWtGQlNVTXNZVUZCWVVRc1owSkJRV2RDZUUwc1MwRkJhRUlzUTBGQmFrSTdPMEZCUlVFN1FVRkRRU3hyUWtGQlNTdE1MRk5CUVZOVkxGZEJRVmN6U0N4UlFVRjRRanRCUVVOQkxHdENRVUZKZUVJc1UwRkJVMjFLTEZkQlFWZHVTaXhOUVVGNFFqdEJRVU5CTEd0Q1FVRkphMFFzVTBGQlUybEhMRmRCUVZkcVJ5eE5RVUZZTEVsQlFYRkNMRWxCUVd4RE8wRkJRMEVzYTBKQlFVa3JSaXh2UWtGQmIwSkZMRmRCUVZkR0xHbENRVUZ1UXpzN1FVRkZRVHRCUVVOQk8wRkJRMEVzYTBKQlFVbEhMRTlCUVU4c2MwSkJRVlZFTEZkQlFWY3pTaXhKUVVGeVFpeExRVUU0UWl4RlFVRjZRenRCUVVOQkxHdENRVUZKVlN4WlFVRlpMSE5DUVVGVmFVb3NWMEZCVjJwS0xGTkJRWEpDTEV0QlFXMURMRVZCUVc1RU96dEJRVVZCYWtZc2MwSkJRVkZuUXl4SFFVRlNMRU5CUVZrc2QwUkJRVm9zUlVGQmMwVjNUQ3hOUVVGMFJTeEZRVUU0UlhaR0xFMUJRVGxGTEVWQlFYTkdhMGNzU1VGQmRFWTdPMEZCUlVFc2EwSkJRVWxLTEZOQlFWTXNhVU5CUVhWQ0wwc3NTMEZCZGtJc1JVRkJPRUozU3l4TlFVRTVRaXhGUVVGelEzcEpMRTFCUVhSRExFVkJRVGhEYTBRc1RVRkJPVU1zUlVGQmMwUnJSeXhKUVVGMFJDeEZRVUUwUkVnc2FVSkJRVFZFTEVWQlFTdEZMRXRCUVM5RkxFVkJRWE5HTEVsQlFYUkdMRU5CUVdJN1FVRkRRVVFzY1VKQlFVOUxMR1ZCUVZBc1EwRkJkVUp1U2l4VFFVRjJRanRCUVVOQmFrTXNiMEpCUVUxNVJTeFZRVUZPTEVOQlFXbENLMFlzVFVGQmFrSXNTVUZCTWtKUExFMUJRVE5DTzBGQlJVUTdPMEZCUlVSeVJTeHZRa0ZCVVRGSExFMUJRVTE1UlN4VlFVRmtPMEZCUTBFc1owSkJRVWtzVDBGQlN6UkhMR3RDUVVGVUxFVkJRVFpDTEU5QlFVdEJMR3RDUVVGTUxFTkJRWGRDTEU5QlFVczFSeXhWUVVFM1FqdEJRVVU1UWl4WFFUbENSQ3hOUVRoQ1R6dEJRVU5NTzBGQlEwRm5RaXh0UWtGQlQyaERMRTFCUVUxeVF5eEpRVUZPTEVOQlFWZDFSU3hKUVVGc1FqdEJRVU5FTzBGQlEwWXNVMEZ3UTBRN1FVRnhRMFFzVDBFMVJFMHNRMEZCVUR0QlFUWkVSRHM3T3l0Q1FVVlZNRVVzVVN4RlFVRlZPMEZCUTI1Q0xGVkJRVWx5U3l4UlFVRlJMRWxCUVZvN08wRkJSVUVzWVVGQlR5eHpRa0ZCV1N4VlFVRkRNRWNzVDBGQlJDeEZRVUZWYWtJc1RVRkJWaXhGUVVGeFFqczdRVUZGZEVNN1FVRkRRU3haUVVGSk5rWXNaVUZCWlR0QlFVTnFRbnBQTEdkQ1FVRk5MRmRCUkZjc1JVRkRSWFZITEUxQlFVMXdSQ3hOUVVGTlJ5eE5RVVJrTEVWQlEzTkNhMFFzU1VGQlNYSkVMRTFCUVUxelJDeFBRVVJvUXp0QlFVVnFRbXhETEdkQ1FVRk5PMEZCUmxjc1UwRkJia0k3TzBGQlMwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVN4WlFVRkphVW9zVVVGQlNpeEZRVUZqTzBGQlExb3NZMEZCU1VFc1UwRkJVeTlGTEdOQlFWUXNRMEZCZDBJc1MwRkJlRUlzUTBGQlNpeEZRVUZ2UTJkSExHRkJRV0ZzU3l4SlFVRmlMRU5CUVd0Q1owb3NSMEZCYkVJc1IwRkJkMEpETEZOQlFWTkVMRWRCUVdwRE8wRkJRM0JETEdOQlFVbERMRk5CUVZNdlJTeGpRVUZVTEVOQlFYZENMRTlCUVhoQ0xFTkJRVW9zUlVGQmMwTm5SeXhoUVVGaGJFc3NTVUZCWWl4RFFVRnJRaXRKTEV0QlFXeENMRWRCUVRCQ1JTeFRRVUZUUml4TFFVRnVRenRCUVVOMFF5eGpRVUZKUlN4VFFVRlRMMFVzWTBGQlZDeERRVUYzUWl4UlFVRjRRaXhEUVVGS0xFVkJRWFZEWjBjc1lVRkJZV3hMTEVsQlFXSXNRMEZCYTBKWExFMUJRV3hDTEVkQlFUSkNjMGtzVTBGQlUzUkpMRTFCUVhCRE8wRkJRM1pETEdOQlFVbHpTU3hUUVVGVEwwVXNZMEZCVkN4RFFVRjNRaXhWUVVGNFFpeERRVUZLTEVWQlFYbERaMGNzWVVGQllXeExMRWxCUVdJc1EwRkJhMEp5UlN4UlFVRnNRaXhIUVVFMlFuTk9MRk5CUVZOMFRpeFJRVUYwUXp0QlFVTjZReXhqUVVGSmMwNHNVMEZCVXk5RkxHTkJRVlFzUTBGQmQwSXNWVUZCZUVJc1EwRkJTaXhGUVVGNVEyZEhMR0ZCUVdGc1N5eEpRVUZpTEVOQlFXdENiVU1zVVVGQmJFSXNSMEZCTmtJNFJ5eFRRVUZUT1Vjc1VVRkJkRU03UVVGRE1VTTdPMEZCUlVRclNDeHhRa0ZCWVd4TExFbEJRV0lzUTBGQmEwSnBSQ3hOUVVGc1FpeEhRVUV5UW1kSExGTkJRVk5vUnl4TlFVRndRenM3UVVGRlFUdEJRVU5CTEZsQlFVbHJRaXgxUWtGQmRVSTRSU3hUUVVGVGJFa3NUVUZCY0VNN1FVRkRRU3haUVVGSmEwa3NVMEZCVXk5RkxHTkJRVlFzUTBGQmQwSXNVVUZCZUVJc1EwRkJTaXhGUVVGMVEyZEhMR0ZCUVdGc1N5eEpRVUZpTEVOQlFXdENiVVVzYjBKQlFXeENMRWRCUVhsRFFTeHZRa0ZCZWtNN08wRkJSWFpEZGtrc1owSkJRVkZuUXl4SFFVRlNMRU5CUVZrc2FVTkJRVm9zUlVGQkswTnhUQ3hSUVVFdlF5eEZRVUY1UkdsQ0xGbEJRWHBFT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQmRFd3NZMEZCVFUwc1NVRkJUaXhEUVVGWGEwUXNWMEZCV0N4RFFVRjFRamhJTEZsQlFYWkNMRVZCUVhGRExGVkJRVU0zU0N4TFFVRkVMRVZCUVZjN1FVRkRPVU42Unl4clFrRkJVV2RETEVkQlFWSXNRMEZCV1N4clEwRkJXaXhGUVVGblJIbEZMRXRCUVdoRU96dEJRVVZCTEdOQlFVa3hRaXhUUVVGVE1FSXNUVUZCVFhKRExFbEJRVTRzUTBGQlYxY3NUVUZCZUVJN1FVRkRRU3hqUVVGSmVVa3NVMEZCVXk5SExFMUJRVTF5UXl4SlFVRk9MRU5CUVZkdFF5eFJRVUY0UWpzN1FVRkZRU3hqUVVGSlowa3NhVUpCUVdsQ2Rrd3NUVUZCVFRoS0xHRkJRVTRzUTBGQmIwSlZMRTFCUVhCQ0xFTkJRWEpDTzBGQlEwRXNhVUpCUVU5NFN5eE5RVUZOT0Vvc1lVRkJUaXhEUVVGdlFsVXNUVUZCY0VJc1EwRkJVRHRCUVVOQkxHTkJRVWxsTEdOQlFVb3NSVUZCYjBKQkxHVkJRV1Y0U3l4cFFrRkJaanM3UVVGRmNFSXNZMEZCU1RCRExFMUJRVTF5UXl4SlFVRk9MRU5CUVZkRkxFbEJRVmdzUjBGQmEwSXNSMEZCZEVJc1JVRkJNa0k3UVVGRGVrSjBSU3h2UWtGQlVXZERMRWRCUVZJc1EwRkJXU3h0UTBGQldpeEZRVUZwUkhsRkxFMUJRVTF5UXl4SlFVRk9MRU5CUVZjMFNpeHBRa0ZCTlVRc1JVRkJLMFZTTEUxQlFTOUZPMEZCUTBGbExEWkNRVUZwUWl3NFFrRkJiMEoyVEN4TlFVRk5SeXhOUVVFeFFpeEZRVUZyUTNGTExFMUJRV3hETEVWQlFUQkRlRXNzVFVGQlRVMHNTVUZCYUVRc1JVRkJjMFJ0UkN4TlFVRk5ja01zU1VGQlRpeERRVUZYTkVvc2FVSkJRV3BGTEVOQlFXcENPMEZCUTBGb1RDeHJRa0ZCVFRoS0xHRkJRVTRzUTBGQmIwSlZMRTFCUVhCQ0xFbEJRVGhDWlN4alFVRTVRanRCUVVORUxGZEJTa1FzVFVGSlR5eEpRVUZKT1Vnc1RVRkJUWEpETEVsQlFVNHNRMEZCVjBVc1NVRkJXQ3hMUVVGdlFpeEhRVUY0UWl4RlFVRTJRanRCUVVOc1EzUkZMRzlDUVVGUlowTXNSMEZCVWl4RFFVRlpMSGREUVVGYUxFVkJRWE5FZVVVc1MwRkJkRVFzUlVGQk5rUjZSQ3hOUVVGTk9Fb3NZVUZCYmtVN08wRkJSVUVzWjBKQlFVbHFTeXhqUVVGak5FUXNUVUZCVFhKRExFbEJRVTRzUTBGQlZ5OUZMRXRCUVRkQ08wRkJRMEVzWjBKQlFVa3NRMEZCUTNkRUxGbEJRVmw1Uml4alFVRmFMRU5CUVRKQ0xGZEJRVE5DTEVOQlFVd3NSVUZCT0VNN1FVRkJSWHBHTERCQ1FVRlpiME1zVTBGQldpeEhRVUYzUWl4RlFVRjRRanRCUVVFMlFqdEJRVU0zUlN4blFrRkJTU3hEUVVGRGNFTXNXVUZCV1hsR0xHTkJRVm9zUTBGQk1rSXNUVUZCTTBJc1EwRkJUQ3hGUVVGNVF6dEJRVUZGZWtZc01FSkJRVmt3UWl4SlFVRmFMRWRCUVcxQ0xFVkJRVzVDTzBGQlFYZENPenRCUVVWdVJUdEJRVU5CTEdkQ1FVRkpkMG9zVTBGQlV5eHBRMEZCZFVJdlN5eExRVUYyUWl4RlFVRTRRbmRMTEUxQlFUbENMRVZCUVhORGVra3NUVUZCZEVNc1JVRkJPRU1zU1VGQk9VTXNSVUZCYjBSc1F5eFhRVUZ3UkN4RlFVRnBSVEJNTEdWQlFXVTNTU3hSUVVGb1JpeEZRVUV3Um1Vc1RVRkJUWEpETEVsQlFVNHNRMEZCVjJsRkxFOUJRWEpITEVWQlFUaEhSU3h2UWtGQk9VY3NRMEZCWWp0QlFVTkJka1lzYTBKQlFVMXJSQ3hWUVVGT0xFTkJRV2xDYzBnc1RVRkJha0lzU1VGQk1rSlBMRTFCUVROQ096dEJRVVZCY2tVc2IwSkJRVkZ4UlN4TlFVRlNPMEZCUTBGUkxESkNRVUZsY0VRc1MwRkJaaXhEUVVGeFFqUkRMRTFCUVhKQ08wRkJRMFFzVjBGaVRTeE5RV0ZCTzBGQlEweDBSaXh0UWtGQlQyaERMRTFCUVUxeVF5eEpRVUZPTEVOQlFWZDFSU3hKUVVGc1FqdEJRVU5FTzBGQlEwWXNVMEU1UWtRN1FVRXJRa1FzVDBGc1JVMHNRMEZCVUR0QlFXMUZSRHM3TzNGRFFVVm5RakJGTEZFc1JVRkJWVHRCUVVGQk96dEJRVU42UWl4VlFVRkpja3NzVVVGQlVTeEpRVUZhT3p0QlFVVkJMR0ZCUVU4c2MwSkJRVmtzVlVGQlF6QkhMRTlCUVVRc1JVRkJWV3BDTEUxQlFWWXNSVUZCY1VJN08wRkJSWFJETzBGQlEwRXNXVUZCU1RaR0xHVkJRV1U3UVVGRGFrSjZUeXhuUWtGQlRTeFhRVVJYTEVWQlEwVjFSeXhOUVVGTmNFUXNUVUZCVFVjc1RVRkVaQ3hGUVVOelFtdEVMRWxCUVVseVJDeE5RVUZOYzBRc1QwRkVhRU03UVVGRmFrSnNReXhuUWtGQlRUdEJRVVpYTEZOQlFXNUNPenRCUVV0Qk8wRkJRMEU3TzBGQlJVRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEVzV1VGQlNXbEtMRkZCUVVvc1JVRkJZenRCUVVOYUxHTkJRVWxCTEZOQlFWTXZSU3hqUVVGVUxFTkJRWGRDTEV0QlFYaENMRU5CUVVvc1JVRkJiME5uUnl4aFFVRmhiRXNzU1VGQllpeERRVUZyUW1kS0xFZEJRV3hDTEVkQlFYZENReXhUUVVGVFJDeEhRVUZxUXp0QlFVTndReXhqUVVGSlF5eFRRVUZUTDBVc1kwRkJWQ3hEUVVGM1FpeFBRVUY0UWl4RFFVRktMRVZCUVhORFowY3NZVUZCWVd4TExFbEJRV0lzUTBGQmEwSXJTU3hMUVVGc1FpeEhRVUV3UWtVc1UwRkJVMFlzUzBGQmJrTTdRVUZEZEVNc1kwRkJTVVVzVTBGQlV5OUZMR05CUVZRc1EwRkJkMElzVVVGQmVFSXNRMEZCU2l4RlFVRjFRMmRITEdGQlFXRnNTeXhKUVVGaUxFTkJRV3RDVnl4TlFVRnNRaXhIUVVFeVFuTkpMRk5CUVZOMFNTeE5RVUZ3UXp0QlFVTjJReXhqUVVGSmMwa3NVMEZCVXk5RkxHTkJRVlFzUTBGQmQwSXNWVUZCZUVJc1EwRkJTaXhGUVVGNVEyZEhMR0ZCUVdGc1N5eEpRVUZpTEVOQlFXdENja1VzVVVGQmJFSXNSMEZCTmtKelRpeFRRVUZUZEU0c1VVRkJkRU03UVVGRGVrTXNZMEZCU1hOT0xGTkJRVk12UlN4alFVRlVMRU5CUVhkQ0xGVkJRWGhDTEVOQlFVb3NSVUZCZVVOblJ5eGhRVUZoYkVzc1NVRkJZaXhEUVVGclFtMURMRkZCUVd4Q0xFZEJRVFpDT0Vjc1UwRkJVemxITEZGQlFYUkRPMEZCUXpGRE96dEJRVVZFSzBnc2NVSkJRV0ZzU3l4SlFVRmlMRU5CUVd0Q2FVUXNUVUZCYkVJc1IwRkJNa0puUnl4VFFVRlRhRWNzVFVGQmNFTTdPMEZCUlVFN1FVRkRRU3haUVVGSmEwSXNkVUpCUVhWQ09FVXNVMEZCVTJ4SkxFMUJRWEJETzBGQlEwRXNXVUZCU1d0SkxGTkJRVk12UlN4alFVRlVMRU5CUVhkQ0xGRkJRWGhDTEVOQlFVb3NSVUZCZFVOblJ5eGhRVUZoYkVzc1NVRkJZaXhEUVVGclFtMUZMRzlDUVVGc1FpeEhRVUY1UTBFc2IwSkJRWHBET3p0QlFVVjJRM1pKTEdkQ1FVRlJaME1zUjBGQlVpeERRVUZaTEdsRFFVRmFMRVZCUVN0RGNVd3NVVUZCTDBNc1JVRkJlVVJwUWl4WlFVRjZSRHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVhSTUxHTkJRVTFOTEVsQlFVNHNRMEZCVjJ0RUxGZEJRVmdzUTBGQmRVSTRTQ3haUVVGMlFpeEZRVUZ4UXl4VlFVRkROMGdzUzBGQlJDeEZRVUZYTzBGQlF6bERla2NzYTBKQlFWRm5ReXhIUVVGU0xFTkJRVmtzTUVOQlFWb3NSVUZCZDBSNVJTeExRVUY0UkRzN1FVRkZRU3hqUVVGSkswY3NVMEZCVXk5SExFMUJRVTF5UXl4SlFVRk9MRU5CUVZkdFF5eFJRVUY0UWpzN1FVRkZRU3hqUVVGSlowa3NhVUpCUVdsQ2Rrd3NUVUZCVFRoS0xHRkJRVTRzUTBGQmIwSlZMRTFCUVhCQ0xFTkJRWEpDTzBGQlEwRXNhVUpCUVU5NFN5eE5RVUZOT0Vvc1lVRkJUaXhEUVVGdlFsVXNUVUZCY0VJc1EwRkJVRHRCUVVOQkxHTkJRVWxsTEdOQlFVb3NSVUZCYjBKQkxHVkJRV1Y0U3l4cFFrRkJaanM3UVVGRmNFSXNZMEZCU1RCRExFMUJRVTF5UXl4SlFVRk9MRU5CUVZkRkxFbEJRVmdzUjBGQmEwSXNSMEZCZEVJc1JVRkJNa0k3TzBGQlJYcENkRVVzYjBKQlFWRm5ReXhIUVVGU0xFTkJRVmtzTUVOQlFWb3NSVUZCZDBSNVJTeExRVUY0UkN4RlFVRXJSQ3RITEUxQlFTOUVPMEZCUTBGbExEWkNRVUZwUWl3NFFrRkJiMEoyVEN4TlFVRk5SeXhOUVVFeFFpeEZRVUZyUTNGTExFMUJRV3hETEVWQlFUQkRlRXNzVFVGQlRVMHNTVUZCYUVRc1JVRkJjMFJ0UkN4TlFVRk5ja01zU1VGQlRpeERRVUZYTkVvc2FVSkJRV3BGTEVOQlFXcENPMEZCUTBGb1RDeHJRa0ZCVFRoS0xHRkJRVTRzUTBGQmIwSlZMRTFCUVhCQ0xFbEJRVGhDWlN4alFVRTVRanRCUVVWRUxGZEJUa1FzVFVGTlR5eEpRVUZKT1Vnc1RVRkJUWEpETEVsQlFVNHNRMEZCVjBVc1NVRkJXQ3hMUVVGdlFpeEhRVUY0UWl4RlFVRTJRanM3UVVGRmJFTXNaMEpCUVVsclN5eHJRa0ZCYTBJdlNDeE5RVUZOY2tNc1NVRkJUaXhEUVVGWEwwVXNTMEZCYWtNN08wRkJSVUVzYVVKQlFVc3NTVUZCU1c5RExFdEJRVlFzU1VGQmEwSXJUU3hsUVVGc1FpeEZRVUZ0UXpzN1FVRkZha01zYTBKQlFVbE9MR0ZCUVdGTkxHZENRVUZuUWk5TkxFdEJRV2hDTEVOQlFXcENPMEZCUTBGNlFpeHpRa0ZCVVdkRExFZEJRVklzUTBGQldTeHpRMEZCV2l4RlFVRnZSSGxGTEV0QlFYQkVMRVZCUVRKRWVVZ3NWVUZCTTBRc1JVRkJkVVZzVEN4TlFVRk5PRW9zWVVGQk4wVTdPMEZCUlVFc2EwSkJRVWt2U0N4VFFVRlRiVW9zVjBGQlYyNUtMRTFCUVhoQ08wRkJRMEVzYTBKQlFVbHJSQ3hUUVVGVGFVY3NWMEZCVjJwSExFMUJRVmdzU1VGQmNVSXNTVUZCYkVNN1FVRkRRU3hyUWtGQlNYVkdMRlZCUVZOVkxGZEJRVmN6U0N4UlFVRjRRanRCUVVOQkxHdENRVUZKT0VJc1ZVRkJWVFpHTEZkQlFWYzNSaXhQUVVGWUxFbEJRWE5DTEVOQlFYQkRPMEZCUTBFc2EwSkJRVWt5Uml4dlFrRkJiMEpGTEZkQlFWZEdMR2xDUVVGdVF6czdRVUZGUVN4clFrRkJTVzVNTEdOQlFXTXNSVUZCYkVJN1FVRkRRVUVzTUVKQlFWbHZReXhUUVVGYUxFZEJRWGRDTEhOQ1FVRlZhVW9zVjBGQlYycEtMRk5CUVhKQ0xFdEJRVzFETEVWQlFUTkVPMEZCUTBGd1F5d3dRa0ZCV1RCQ0xFbEJRVm9zUjBGQmJVSXNjMEpCUVZVeVNpeFhRVUZYTTBvc1NVRkJja0lzUzBGQk9FSXNSVUZCYWtRN08wRkJSMEU3UVVGRFFYWkZMSE5DUVVGUlowTXNSMEZCVWl4RFFVRlpMSGRFUVVGYUxFVkJRWE5GYVVjc1RVRkJkRVVzUlVGQk9FVndSaXhYUVVFNVJTeEZRVUV5Um0xTUxHbENRVUV6Uml4RlFVRTRSek5HTEU5QlFUbEhPMEZCUTBFc2EwSkJRVWt3Uml4VFFVRlRMR2xEUVVGMVFpOUxMRXRCUVhaQ0xFVkJRVGhDZDBzc1QwRkJPVUlzUlVGQmMwTjZTU3hOUVVGMFF5eEZRVUU0UTJ0RUxFMUJRVGxETEVWQlFYTkVjRVlzVjBGQmRFUXNSVUZCYlVWdFRDeHBRa0ZCYmtVc1JVRkJjMFl6Uml4UFFVRjBSaXhGUVVFclJrVXNiMEpCUVM5R0xFVkJRWEZJTEVsQlFYSklMRU5CUVdJN08wRkJSVUYyUml4dlFrRkJUV3RFTEZWQlFVNHNRMEZCYVVKelNDeFBRVUZxUWl4SlFVRXlRazhzVFVGQk0wSTdPMEZCUlVFdlN5eHZRa0ZCVFRoS0xHRkJRVTRzUTBGQmIwSlZMRTlCUVhCQ0xFVkJRVFJDY2tNc1MwRkJOVUlzUTBGQmEwTTBReXhOUVVGc1F6dEJRVU5FT3p0QlFVVkVja1VzYjBKQlFWRXhSeXhOUVVGTmEwUXNWVUZCWkRzN1FVRkZRU3huUWtGQlNTeFBRVUZMZFVrc2EwSkJRVlFzUlVGQk5rSXNUMEZCUzBFc2EwSkJRVXdzUTBGQmQwSjZUQ3hOUVVGTmEwUXNWVUZCT1VJN1FVRkZPVUlzVjBGcVEwMHNUVUZwUTBFN1FVRkRUSFZETEcxQ1FVRlBhRU1zVFVGQlRYSkRMRWxCUVU0c1EwRkJWM1ZGTEVsQlFXeENPMEZCUTBRN1FVRkRSaXhUUVc1RVJEdEJRVzlFUkN4UFFYWkdUU3hEUVVGUU8wRkJlVVpFT3p0QlFVVkVPenM3T3l0Q1FVTlhha1lzUnl4RlFVRkxPMEZCUTJRc1ZVRkJTVllzVVVGQlVTeEpRVUZhT3p0QlFVVkJMRlZCUVVrNFN5eFhRVUZYT1Vzc1RVRkJUWGxGTEZWQlFVNHNRMEZCYVVJdlJDeEpRVUZKVlN4SlFVRktMRU5CUVZOcFF5eEZRVUV4UWl4RFFVRm1PMEZCUTBGNVNDeGxRVUZUWkN4VlFVRlVMRU5CUVc5Q2RFb3NSMEZCY0VJN1FVRkRSRHM3UVVGRlJEczdPenR2UTBGRFowSkJMRWNzUlVGQlN6dEJRVU51UWl4VlFVRkpWaXhSUVVGUkxFbEJRVm83TzBGQlJVUTdRVUZEUXl4VlFVRkpkVVFzVjBGQlZ6ZERMRWxCUVVrd1F5eEpRVUZLTEVOQlFWTTVSQ3hMUVVGVUxFTkJRV1VzUTBGQlppeEZRVUZyUWl4RFFVRkRMRVZCUVc1Q0xFTkJRV1k3TzBGQlJVRXNWVUZCU1RSQ0xGRkJRVkU3UVVGRFZuSkZMR05CUVUwMlJDeEpRVUZKTjBRc1NVRkVRVHRCUVVWV2RVY3NZMEZCVFRGRExFbEJRVWxWTEVsQlFVb3NRMEZCVTBNc1RVRkdURHRCUVVkV2JrWXNZVUZCUzNGSUxGRkJTRXM3UVVGSlZuaENMR2RDUVVGUmNrSXNTVUZCU1ZVc1NVRkJTaXhEUVVGVFZ5eE5RVXBRTzBGQlMxWXhSaXhsUVVGUGNVVXNTVUZCU1ZVc1NVRkJTaXhEUVVGVEwwVXNTMEZNVGp0QlFVMVdWU3hyUWtGQlZUSkVMRWxCUVVsVkxFbEJRVW9zUTBGQlUzSkZMRkZCVGxRN08wRkJVVll5VHl4aFFVRkxMR0ZCUVVNM1R5eEpRVUZFTEVWQlFWVTdRVUZEWWl4alFVRkpPRThzVVVGQlVTeEhRVUZhTzBGQlEwRXNZMEZCU1RsUExFbEJRVW9zUlVGQlZUdEJRVU5TT0U4c2IwSkJRVkU1VHl4SlFVRlNPMEZCUTBRN08wRkJSVVk3UVVGRFEyMUVMR2RDUVVGTlRTeEpRVUZPTEVOQlFWZHJSQ3hYUVVGWUxFTkJRWFZDTzBGQlEzSkNOME1zWjBKQlFVbEVMRWxCUVVsRExFVkJSR0VzUlVGRFZEbEVMRTFCUVUwc1ZVRkVSeXhGUVVOVGRVY3NUVUZCVFRGRExFbEJRVWt5UXl4RlFVUnVRaXhGUVVOMVFrRXNTVUZCU1RORExFbEJRVWt3UXl4SlFVUXZRanRCUVVWeVFtaERMR3RDUVVGTkxFVkJRVVZGTEUxQlFVMXhTeXhMUVVGU08wRkJSbVVzVjBGQmRrSTdRVUZKUkR0QlFXNUNVeXhQUVVGYU96dEJRWE5DUVN4VlFVRkpNMHdzVFVGQlRUWkxMSE5DUVVGV0xFVkJRV3RETzBGQlEyaEROMDRzWjBKQlFWRXJUU3hKUVVGU0xFTkJRV0VzWjBOQlFXSXNSVUZCSzBNM1NTeExRVUV2UXp0QlFVTkJiRUlzWTBGQlRUWkxMSE5DUVVGT0xFTkJRVFpDTTBvc1MwRkJOMEk3UVVGRFJEdEJRVU5HT3p0QlFVVkVPenM3TzI5RFFVTm5RbElzUnl4RlFVRkxPMEZCUTI1Q0xGVkJRVWxXTEZGQlFWRXNTVUZCV2pzN1FVRkZSRHRCUVVORExGVkJRVWwxUkN4WFFVRlhOME1zU1VGQlNWVXNTVUZCU2l4RFFVRlRiVU1zVVVGQmVFSTdPMEZCUlVFc1ZVRkJTVGRHTEZOQlFWTnpReXhOUVVGTmEwUXNWVUZCVGl4RFFVRnBRa3NzVVVGQmFrSXNRMEZCWWp0QlFVTkJMRlZCUVVrM1JpeE5RVUZLTEVWQlFWazdRVUZEVml4WlFVRkpkMFFzVVVGQlVUdEJRVU5XY2tVc1owSkJRVTAyUkN4SlFVRkpOMFFzU1VGRVFUdEJRVVZXV0N4bFFVRkxjVWdzVVVGR1N6dEJRVWRXZUVjc2IwSkJRVlV5UkN4SlFVRkpWU3hKUVVGS0xFTkJRVk55UlN4UlFVaFVPenRCUVV0V01rOHNaVUZCU3l4aFFVRkROMDhzU1VGQlJDeEZRVUZWTzBGQlEySXNaMEpCUVVrNFR5eFJRVUZSTEVkQlFWbzdRVUZEUVN4blFrRkJTVGxQTEVsQlFVb3NSVUZCVlR0QlFVTlNPRThzYzBKQlFWRTVUeXhKUVVGU08wRkJRMFE3TzBGQlJVWTdRVUZEUXl4blFrRkJTVGhQTEZWQlFWVXNSMEZCWkN4RlFVRnRRanRCUVVOcVFtcFBMSEZDUVVGUGEwOHNUVUZCVUR0QlFVTkVPenRCUVVWRU8wRkJRMEUxVEN4clFrRkJUVTBzU1VGQlRpeERRVUZYYTBRc1YwRkJXQ3hEUVVGMVFqdEJRVU55UWpkRExHdENRVUZKUkN4SlFVRkpReXhGUVVSaExFVkJRMVE1UkN4TlFVRk5MRlZCUkVjc1JVRkRVM1ZITEUxQlFVMHhReXhKUVVGSk1rTXNSVUZFYmtJc1JVRkRkVUpCTEVsQlFVa3pReXhKUVVGSk1FTXNTVUZFTDBJN1FVRkZja0pvUXl4dlFrRkJUU3hGUVVGRlJTeE5RVUZOY1Vzc1MwRkJVaXhGUVVGbGRFc3NVVUZCVVhKQ0xFMUJRVTFITEUxQlFUZENPMEZCUm1Vc1lVRkJka0k3UVVGSlJEdEJRWEpDVXl4VFFVRmFPenRCUVhkQ1FTeFpRVUZKU0N4TlFVRk5Oa3NzYzBKQlFWWXNSVUZCYTBNN1FVRkRhRU0zVGl4clFrRkJVV2RETEVkQlFWSXNRMEZCV1N4elFrRkJXaXhGUVVGdlEydERMRXRCUVhCRE8wRkJRMEZzUWl4blFrRkJUVFpMTEhOQ1FVRk9MRU5CUVRaQ00wb3NTMEZCTjBJN1FVRkRSRHRCUVVOR0xFOUJOMEpFTEUxQk5rSlBPMEZCUTB4c1FpeGpRVUZOVFN4SlFVRk9MRU5CUVZkclJDeFhRVUZZTEVOQlFYVkNPMEZCUTNKQ04wTXNZMEZCU1VRc1NVRkJTVU1zUlVGRVlTeEZRVU5VT1VRc1RVRkJUU3hWUVVSSExFVkJRMU4xUnl4TlFVRk5NVU1zU1VGQlNUSkRMRVZCUkc1Q0xFVkJRM1ZDUVN4SlFVRkpNME1zU1VGQlNUQkRMRWxCUkM5Q08wRkJSWEpDYUVNc1owSkJRVTBzUlVGQlJVVXNUVUZCVFN4SFFVRlNMRVZCUVdGRUxGRkJRVkZ5UWl4TlFVRk5SeXhOUVVFelFqdEJRVVpsTEZOQlFYWkNPMEZCU1VRN1FVRkRSanM3UVVGRlJEczdPenM3T3pzN2MwTkJTMnRDWVN4UkxFVkJRVlU3UVVGRE1VSXNWMEZCUzNGTExHdENRVUZNTEVkQlFUQkNja3NzVVVGQk1VSTdRVUZEUkRzN1FVRkZSRHM3T3pzN096czdjME5CUzJ0Q1FTeFJMRVZCUVZVN1FVRkRNVUlzVjBGQlMzbExMR3RDUVVGTUxFZEJRVEJDZWtzc1VVRkJNVUk3UVVGRFJEczdPM2RDUVdob1FsYzdRVUZCUlN4aFFVRlBMRXRCUVV0aUxFMUJRVm83UVVGQmNVSTdPMEZCUlc1RE96czdPenM3TzNkQ1FVbG5RanRCUVVGRkxHRkJRVThzUzBGQlMzTkZMRlZCUVZvN1FVRkJlVUk3TzBGQlJUTkRPenM3T3pzN08zZENRVWxuUWp0QlFVRkZMR0ZCUVU4c1MwRkJTM1pDTEZWQlFWbzdRVUZCZVVJN096czdPMnRDUVhkblFqbENkMGNzVHpzN096czdPenM3T3pzN096czdPenM3T3pzN096czdRVU40YlVKbU96czdPMEZCUTBFN096czdRVUZEUVRzN096czdPMUZCUlZGQkxFODdVVUZCVXpWR0xHdENPMUZCUVc5Q2FrTXNhMEk3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3UVVOS2NrTTdPenM3T3pzN096czdPenM3T3pzN096czdPenM3TzBGQmRVSkJPenM3T3pzN096czdPenRKUVZkTlowc3NaVHRCUVVOS096czdPenM3UVVGUFFTd3lRa0ZCV1M5TUxFdEJRVm9zUlVGQmJVSTFSQ3hIUVVGdVFpeEZRVUYzUW5sT0xFZEJRWGhDTEVWQlFUWkNha2dzVVVGQk4wSXNSVUZCZFVNN1FVRkJRVHM3UVVGRGNrTXNVVUZCU1RGRExGRkJRVkVzU1VGQldqczdRVUZGUVVFc1ZVRkJUVWNzVFVGQlRpeEhRVUZsVEN4TFFVRm1PMEZCUTBGRkxGVkJRVTByUXl4SlFVRk9MRWRCUVdFM1J5eEhRVUZpTzBGQlEwRTRSQ3hWUVVGTlRTeEpRVUZPTEVkQlFXRnhTaXhIUVVGaU8wRkJRMEV6U2l4VlFVRk5ZeXhUUVVGT0xFZEJRV3RDTkVJc1VVRkJiRUk3TzBGQlJVRXhReXhWUVVGTk9Fd3NVVUZCVGl4SFFVRnBRaXhGUVVGcVFqdEJRVU5CT1V3c1ZVRkJUVThzYTBKQlFVNDdRVUZEUkRzN096dDVRMEZGYjBJN1FVRkRia0lzVlVGQlNWQXNVVUZCVVN4SlFVRmFPenRCUVVWQlFTeFpRVUZOVVN4VFFVRk9MRWRCUVd0Q1VpeE5RVUZOVFN4SlFVRk9MRU5CUVZkSExGZEJRVmdzUTBGQmRVSlVMRTFCUVUwclF5eEpRVUUzUWl4RlFVRnRReXhWUVVGRGNrTXNSMEZCUkN4RlFVRlRPMEZCUXpWRU1VUXNaMEpCUVZGblF5eEhRVUZTTEVOQlFWa3NjVUpCUVhGQ1owSXNUVUZCVFN0RExFbEJRVE5DTEVkQlFXdERMRkZCUVRsRExFVkJRWGRFY2tNc1IwRkJlRVE3UVVGRFFWWXNZMEZCVFRoTUxGRkJRVTRzUTBGQlpXcE9MRWxCUVdZc1EwRkJiMEkyUWl4SFFVRndRanRCUVVORUxFOUJTR2xDTEVOQlFXeENPenRCUVV0Qk96czdPenM3T3pzN096czdPenM3UVVGblFrUTdPenQzUTBGRmJVSTdRVUZEYkVJc1ZVRkJTVllzVVVGQlVTeEpRVUZhT3p0QlFVVkJRU3haUVVGTlVTeFRRVUZPTEVOQlFXZENTeXhOUVVGb1FqczdRVUZGUVRzN08wRkJSMFE3T3pzd1FrRkpTMnRNTEZFc1JVRkJWVHRCUVVOa0xGVkJRVWt2VEN4UlFVRlJMRWxCUVZvN1FVRkRRVUVzV1VGQlRUaE1MRkZCUVU0c1EwRkJaVzVPTEU5QlFXWXNRMEZCZFVJc1ZVRkJRMnRMTEUxQlFVUXNSVUZCV1R0QlFVTnFRMnRFTEdsQ1FVRlRMMGtzWVVGQlZDeERRVUYxUWl0SkxGTkJRVk14VEN4UlFVRm9ReXhGUVVFd1EzZEpMRTFCUVRGRE8wRkJRMFFzVDBGR1JEdEJRVWRFT3pzN2QwSkJVR003UVVGQlJTeGhRVUZQTEV0QlFVc3ZTQ3hUUVVGYU8wRkJRWGRDT3pzN096dHJRa0ZWTlVJclN5eGxPenM3T3pzN096czdRVU53UjJZc2EwSkJRV3RDTEhsRU96czdPenM3TzBGRFFXeENMR3RDUVVGclFpeDVSRHM3T3pzN096czdPenRCUTBGc1FqdEJRVU5CTEhORU96czdPenM3TzBGRFJFRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hGT3pzN096czdPMEZEU2tFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMR3REUVVGclF5eFZRVUZWTEVWQlFVVTdRVUZET1VNc2JVSkJRVzFDTEhORFFVRnpRenRCUVVONlJDeERRVUZETEc5RFFVRnZRenRCUVVOeVF6dEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnc1EwRkJReXhYT3pzN096czdPenRCUTJoRFJEdEJRVU5CT3p0QlFVVkJMREJEUVVFd1F5eHBRMEZCYjBNc1JUczdPenM3T3p0QlEwZzVSVHRCUVVOQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hEUVVGRExFVWlMQ0ptYVd4bElqb2lVM2x1WTJobGNpNXFjeUlzSW5OdmRYSmpaWE5EYjI1MFpXNTBJanBiSWlobWRXNWpkR2x2YmlCM1pXSndZV05yVlc1cGRtVnljMkZzVFc5a2RXeGxSR1ZtYVc1cGRHbHZiaWh5YjI5MExDQm1ZV04wYjNKNUtTQjdYRzVjZEdsbUtIUjVjR1Z2WmlCbGVIQnZjblJ6SUQwOVBTQW5iMkpxWldOMEp5QW1KaUIwZVhCbGIyWWdiVzlrZFd4bElEMDlQU0FuYjJKcVpXTjBKeWxjYmx4MFhIUnRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWmhZM1J2Y25rb0tUdGNibHgwWld4elpTQnBaaWgwZVhCbGIyWWdaR1ZtYVc1bElEMDlQU0FuWm5WdVkzUnBiMjRuSUNZbUlHUmxabWx1WlM1aGJXUXBYRzVjZEZ4MFpHVm1hVzVsS0Z3aVUzbHVZMmhsY2x3aUxDQmJYU3dnWm1GamRHOXllU2s3WEc1Y2RHVnNjMlVnYVdZb2RIbHdaVzltSUdWNGNHOXlkSE1nUFQwOUlDZHZZbXBsWTNRbktWeHVYSFJjZEdWNGNHOXlkSE5iWENKVGVXNWphR1Z5WENKZElEMGdabUZqZEc5eWVTZ3BPMXh1WEhSbGJITmxYRzVjZEZ4MGNtOXZkRnRjSWx3aVhTQTlJSEp2YjNSYlhDSmNJbDBnZkh3Z2UzMHNJSEp2YjNSYlhDSmNJbDFiWENKVGVXNWphR1Z5WENKZElEMGdabUZqZEc5eWVTZ3BPMXh1ZlNrb2RHaHBjeXdnWm5WdVkzUnBiMjRvS1NCN1hHNXlaWFIxY200Z1hHNWNibHh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVklnTHk5Y2JpOHZJSGRsWW5CaFkyc3ZkVzVwZG1WeWMyRnNUVzlrZFd4bFJHVm1hVzVwZEdsdmJpSXNJaUJjZEM4dklGUm9aU0J0YjJSMWJHVWdZMkZqYUdWY2JpQmNkSFpoY2lCcGJuTjBZV3hzWldSTmIyUjFiR1Z6SUQwZ2UzMDdYRzVjYmlCY2RDOHZJRlJvWlNCeVpYRjFhWEpsSUdaMWJtTjBhVzl1WEc0Z1hIUm1kVzVqZEdsdmJpQmZYM2RsWW5CaFkydGZjbVZ4ZFdseVpWOWZLRzF2WkhWc1pVbGtLU0I3WEc1Y2JpQmNkRngwTHk4Z1EyaGxZMnNnYVdZZ2JXOWtkV3hsSUdseklHbHVJR05oWTJobFhHNGdYSFJjZEdsbUtHbHVjM1JoYkd4bFpFMXZaSFZzWlhOYmJXOWtkV3hsU1dSZEtWeHVJRngwWEhSY2RISmxkSFZ5YmlCcGJuTjBZV3hzWldSTmIyUjFiR1Z6VzIxdlpIVnNaVWxrWFM1bGVIQnZjblJ6TzF4dVhHNGdYSFJjZEM4dklFTnlaV0YwWlNCaElHNWxkeUJ0YjJSMWJHVWdLR0Z1WkNCd2RYUWdhWFFnYVc1MGJ5QjBhR1VnWTJGamFHVXBYRzRnWEhSY2RIWmhjaUJ0YjJSMWJHVWdQU0JwYm5OMFlXeHNaV1JOYjJSMWJHVnpXMjF2WkhWc1pVbGtYU0E5SUh0Y2JpQmNkRngwWEhScE9pQnRiMlIxYkdWSlpDeGNiaUJjZEZ4MFhIUnNPaUJtWVd4elpTeGNiaUJjZEZ4MFhIUmxlSEJ2Y25Sek9pQjdmVnh1SUZ4MFhIUjlPMXh1WEc0Z1hIUmNkQzh2SUVWNFpXTjFkR1VnZEdobElHMXZaSFZzWlNCbWRXNWpkR2x2Ymx4dUlGeDBYSFJ0YjJSMWJHVnpXMjF2WkhWc1pVbGtYUzVqWVd4c0tHMXZaSFZzWlM1bGVIQnZjblJ6TENCdGIyUjFiR1VzSUcxdlpIVnNaUzVsZUhCdmNuUnpMQ0JmWDNkbFluQmhZMnRmY21WeGRXbHlaVjlmS1R0Y2JseHVJRngwWEhRdkx5QkdiR0ZuSUhSb1pTQnRiMlIxYkdVZ1lYTWdiRzloWkdWa1hHNGdYSFJjZEcxdlpIVnNaUzVzSUQwZ2RISjFaVHRjYmx4dUlGeDBYSFF2THlCU1pYUjFjbTRnZEdobElHVjRjRzl5ZEhNZ2IyWWdkR2hsSUcxdlpIVnNaVnh1SUZ4MFhIUnlaWFIxY200Z2JXOWtkV3hsTG1WNGNHOXlkSE03WEc0Z1hIUjlYRzVjYmx4dUlGeDBMeThnWlhod2IzTmxJSFJvWlNCdGIyUjFiR1Z6SUc5aWFtVmpkQ0FvWDE5M1pXSndZV05yWDIxdlpIVnNaWE5mWHlsY2JpQmNkRjlmZDJWaWNHRmphMTl5WlhGMWFYSmxYMTh1YlNBOUlHMXZaSFZzWlhNN1hHNWNiaUJjZEM4dklHVjRjRzl6WlNCMGFHVWdiVzlrZFd4bElHTmhZMmhsWEc0Z1hIUmZYM2RsWW5CaFkydGZjbVZ4ZFdseVpWOWZMbU1nUFNCcGJuTjBZV3hzWldSTmIyUjFiR1Z6TzF4dVhHNGdYSFF2THlCcFpHVnVkR2wwZVNCbWRXNWpkR2x2YmlCbWIzSWdZMkZzYkdsdVp5Qm9ZWEp0YjI1NUlHbHRjRzl5ZEhNZ2QybDBhQ0IwYUdVZ1kyOXljbVZqZENCamIyNTBaWGgwWEc0Z1hIUmZYM2RsWW5CaFkydGZjbVZ4ZFdseVpWOWZMbWtnUFNCbWRXNWpkR2x2YmloMllXeDFaU2tnZXlCeVpYUjFjbTRnZG1Gc2RXVTdJSDA3WEc1Y2JpQmNkQzh2SUdSbFptbHVaU0JuWlhSMFpYSWdablZ1WTNScGIyNGdabTl5SUdoaGNtMXZibmtnWlhod2IzSjBjMXh1SUZ4MFgxOTNaV0p3WVdOclgzSmxjWFZwY21WZlh5NWtJRDBnWm5WdVkzUnBiMjRvWlhod2IzSjBjeXdnYm1GdFpTd2daMlYwZEdWeUtTQjdYRzRnWEhSY2RHbG1LQ0ZmWDNkbFluQmhZMnRmY21WeGRXbHlaVjlmTG04b1pYaHdiM0owY3l3Z2JtRnRaU2twSUh0Y2JpQmNkRngwWEhSUFltcGxZM1F1WkdWbWFXNWxVSEp2Y0dWeWRIa29aWGh3YjNKMGN5d2dibUZ0WlN3Z2UxeHVJRngwWEhSY2RGeDBZMjl1Wm1sbmRYSmhZbXhsT2lCbVlXeHpaU3hjYmlCY2RGeDBYSFJjZEdWdWRXMWxjbUZpYkdVNklIUnlkV1VzWEc0Z1hIUmNkRngwWEhSblpYUTZJR2RsZEhSbGNseHVJRngwWEhSY2RIMHBPMXh1SUZ4MFhIUjlYRzRnWEhSOU8xeHVYRzRnWEhRdkx5Qm5aWFJFWldaaGRXeDBSWGh3YjNKMElHWjFibU4wYVc5dUlHWnZjaUJqYjIxd1lYUnBZbWxzYVhSNUlIZHBkR2dnYm05dUxXaGhjbTF2Ym5rZ2JXOWtkV3hsYzF4dUlGeDBYMTkzWldKd1lXTnJYM0psY1hWcGNtVmZYeTV1SUQwZ1puVnVZM1JwYjI0b2JXOWtkV3hsS1NCN1hHNGdYSFJjZEhaaGNpQm5aWFIwWlhJZ1BTQnRiMlIxYkdVZ0ppWWdiVzlrZFd4bExsOWZaWE5OYjJSMWJHVWdQMXh1SUZ4MFhIUmNkR1oxYm1OMGFXOXVJR2RsZEVSbFptRjFiSFFvS1NCN0lISmxkSFZ5YmlCdGIyUjFiR1ZiSjJSbFptRjFiSFFuWFRzZ2ZTQTZYRzRnWEhSY2RGeDBablZ1WTNScGIyNGdaMlYwVFc5a2RXeGxSWGh3YjNKMGN5Z3BJSHNnY21WMGRYSnVJRzF2WkhWc1pUc2dmVHRjYmlCY2RGeDBYMTkzWldKd1lXTnJYM0psY1hWcGNtVmZYeTVrS0dkbGRIUmxjaXdnSjJFbkxDQm5aWFIwWlhJcE8xeHVJRngwWEhSeVpYUjFjbTRnWjJWMGRHVnlPMXh1SUZ4MGZUdGNibHh1SUZ4MEx5OGdUMkpxWldOMExuQnliM1J2ZEhsd1pTNW9ZWE5QZDI1UWNtOXdaWEowZVM1allXeHNYRzRnWEhSZlgzZGxZbkJoWTJ0ZmNtVnhkV2x5WlY5ZkxtOGdQU0JtZFc1amRHbHZiaWh2WW1wbFkzUXNJSEJ5YjNCbGNuUjVLU0I3SUhKbGRIVnliaUJQWW1wbFkzUXVjSEp2ZEc5MGVYQmxMbWhoYzA5M2JsQnliM0JsY25SNUxtTmhiR3dvYjJKcVpXTjBMQ0J3Y205d1pYSjBlU2s3SUgwN1hHNWNiaUJjZEM4dklGOWZkMlZpY0dGamExOXdkV0pzYVdOZmNHRjBhRjlmWEc0Z1hIUmZYM2RsWW5CaFkydGZjbVZ4ZFdseVpWOWZMbkFnUFNCY0lsd2lPMXh1WEc0Z1hIUXZMeUJNYjJGa0lHVnVkSEo1SUcxdlpIVnNaU0JoYm1RZ2NtVjBkWEp1SUdWNGNHOXlkSE5jYmlCY2RISmxkSFZ5YmlCZlgzZGxZbkJoWTJ0ZmNtVnhkV2x5WlY5ZktGOWZkMlZpY0dGamExOXlaWEYxYVhKbFgxOHVjeUE5SURFME1pazdYRzVjYmx4dVhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVpQXZMMXh1THk4Z2QyVmljR0ZqYXk5aWIyOTBjM1J5WVhBZ01qUXhNRFJqT1dZeE5HVXdPR013T0RCaU5qRWlMQ0oyWVhJZ1kyOXlaU0E5SUcxdlpIVnNaUzVsZUhCdmNuUnpJRDBnZTNabGNuTnBiMjQ2SUNjeUxqUXVNQ2Q5TzF4dWFXWW9kSGx3Wlc5bUlGOWZaU0E5UFNBbmJuVnRZbVZ5SnlsZlgyVWdQU0JqYjNKbE95QXZMeUJsYzJ4cGJuUXRaR2x6WVdKc1pTMXNhVzVsSUc1dkxYVnVaR1ZtWEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWpiM0psTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBd1hHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVnTmlBM0lEZ2dPU0lzSWk4dklHaDBkSEJ6T2k4dloybDBhSFZpTG1OdmJTOTZiRzlwY205amF5OWpiM0psTFdwekwybHpjM1ZsY3k4NE5pTnBjM04xWldOdmJXMWxiblF0TVRFMU56VTVNREk0WEc1MllYSWdaMnh2WW1Gc0lEMGdiVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQjBlWEJsYjJZZ2QybHVaRzkzSUNFOUlDZDFibVJsWm1sdVpXUW5JQ1ltSUhkcGJtUnZkeTVOWVhSb0lEMDlJRTFoZEdoY2JpQWdQeUIzYVc1a2IzY2dPaUIwZVhCbGIyWWdjMlZzWmlBaFBTQW5kVzVrWldacGJtVmtKeUFtSmlCelpXeG1MazFoZEdnZ1BUMGdUV0YwYUNBL0lITmxiR1lnT2lCR2RXNWpkR2x2YmlnbmNtVjBkWEp1SUhSb2FYTW5LU2dwTzF4dWFXWW9kSGx3Wlc5bUlGOWZaeUE5UFNBbmJuVnRZbVZ5SnlsZlgyY2dQU0JuYkc5aVlXdzdJQzh2SUdWemJHbHVkQzFrYVhOaFlteGxMV3hwYm1VZ2JtOHRkVzVrWldaY2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMmRzYjJKaGJDNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlEWWdOeUE0SURraUxDSXZMeUJVYUdGdWF5ZHpJRWxGT0NCbWIzSWdhR2x6SUdaMWJtNTVJR1JsWm1sdVpWQnliM0JsY25SNVhHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlDRnlaWEYxYVhKbEtDY3VMMTltWVdsc2N5Y3BLR1oxYm1OMGFXOXVLQ2w3WEc0Z0lISmxkSFZ5YmlCUFltcGxZM1F1WkdWbWFXNWxVSEp2Y0dWeWRIa29lMzBzSUNkaEp5d2dlMmRsZERvZ1puVnVZM1JwYjI0b0tYc2djbVYwZFhKdUlEYzdJSDE5S1M1aElDRTlJRGM3WEc1OUtUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJSbGMyTnlhWEIwYjNKekxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXlYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVZ05pQTNJRGdnT1NJc0luWmhjaUJ6ZEc5eVpTQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZjMmhoY21Wa0p5a29KM2RyY3ljcFhHNGdJQ3dnZFdsa0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYM1ZwWkNjcFhHNGdJQ3dnVTNsdFltOXNJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMmRzYjJKaGJDY3BMbE41YldKdmJGeHVJQ0FzSUZWVFJWOVRXVTFDVDB3Z1BTQjBlWEJsYjJZZ1UzbHRZbTlzSUQwOUlDZG1kVzVqZEdsdmJpYzdYRzVjYm5aaGNpQWtaWGh3YjNKMGN5QTlJRzF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9ibUZ0WlNsN1hHNGdJSEpsZEhWeWJpQnpkRzl5WlZ0dVlXMWxYU0I4ZkNBb2MzUnZjbVZiYm1GdFpWMGdQVnh1SUNBZ0lGVlRSVjlUV1UxQ1Qwd2dKaVlnVTNsdFltOXNXMjVoYldWZElIeDhJQ2hWVTBWZlUxbE5RazlNSUQ4Z1UzbHRZbTlzSURvZ2RXbGtLU2duVTNsdFltOXNMaWNnS3lCdVlXMWxLU2s3WEc1OU8xeHVYRzRrWlhod2IzSjBjeTV6ZEc5eVpTQTlJSE4wYjNKbE8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmZDJ0ekxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXpYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSjJZWElnWVc1UFltcGxZM1FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5aGJpMXZZbXBsWTNRbktWeHVJQ0FzSUVsRk9GOUVUMDFmUkVWR1NVNUZJRDBnY21WeGRXbHlaU2duTGk5ZmFXVTRMV1J2YlMxa1pXWnBibVVuS1Z4dUlDQXNJSFJ2VUhKcGJXbDBhWFpsSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZEc4dGNISnBiV2wwYVhabEp5bGNiaUFnTENCa1VDQWdJQ0FnSUNBZ0lDQWdJQ0E5SUU5aWFtVmpkQzVrWldacGJtVlFjbTl3WlhKMGVUdGNibHh1Wlhod2IzSjBjeTVtSUQwZ2NtVnhkV2x5WlNnbkxpOWZaR1Z6WTNKcGNIUnZjbk1uS1NBL0lFOWlhbVZqZEM1a1pXWnBibVZRY205d1pYSjBlU0E2SUdaMWJtTjBhVzl1SUdSbFptbHVaVkJ5YjNCbGNuUjVLRThzSUZBc0lFRjBkSEpwWW5WMFpYTXBlMXh1SUNCaGJrOWlhbVZqZENoUEtUdGNiaUFnVUNBOUlIUnZVSEpwYldsMGFYWmxLRkFzSUhSeWRXVXBPMXh1SUNCaGJrOWlhbVZqZENoQmRIUnlhV0oxZEdWektUdGNiaUFnYVdZb1NVVTRYMFJQVFY5RVJVWkpUa1VwZEhKNUlIdGNiaUFnSUNCeVpYUjFjbTRnWkZBb1R5d2dVQ3dnUVhSMGNtbGlkWFJsY3lrN1hHNGdJSDBnWTJGMFkyZ29aU2w3SUM4cUlHVnRjSFI1SUNvdklIMWNiaUFnYVdZb0oyZGxkQ2NnYVc0Z1FYUjBjbWxpZFhSbGN5QjhmQ0FuYzJWMEp5QnBiaUJCZEhSeWFXSjFkR1Z6S1hSb2NtOTNJRlI1Y0dWRmNuSnZjaWduUVdOalpYTnpiM0p6SUc1dmRDQnpkWEJ3YjNKMFpXUWhKeWs3WEc0Z0lHbG1LQ2QyWVd4MVpTY2dhVzRnUVhSMGNtbGlkWFJsY3lsUFcxQmRJRDBnUVhSMGNtbGlkWFJsY3k1MllXeDFaVHRjYmlBZ2NtVjBkWEp1SUU4N1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmIySnFaV04wTFdSd0xtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTBYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVZ05pQTNJRGdnT1NJc0luWmhjaUJwYzA5aWFtVmpkQ0E5SUhKbGNYVnBjbVVvSnk0dlgybHpMVzlpYW1WamRDY3BPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhwZENsN1hHNGdJR2xtS0NGcGMwOWlhbVZqZENocGRDa3BkR2h5YjNjZ1ZIbHdaVVZ5Y205eUtHbDBJQ3NnSnlCcGN5QnViM1FnWVc0Z2IySnFaV04wSVNjcE8xeHVJQ0J5WlhSMWNtNGdhWFE3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmWVc0dGIySnFaV04wTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBMVhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVnTmlBM0lEZ2dPU0lzSW0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRvYVhRcGUxeHVJQ0J5WlhSMWNtNGdkSGx3Wlc5bUlHbDBJRDA5UFNBbmIySnFaV04wSnlBL0lHbDBJQ0U5UFNCdWRXeHNJRG9nZEhsd1pXOW1JR2wwSUQwOVBTQW5ablZ1WTNScGIyNG5PMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMmx6TFc5aWFtVmpkQzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTmx4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJRFlnTnlBNElEa2lMQ0oyWVhJZ1pGQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzFrY0NjcFhHNGdJQ3dnWTNKbFlYUmxSR1Z6WXlBOUlISmxjWFZwY21Vb0p5NHZYM0J5YjNCbGNuUjVMV1JsYzJNbktUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdjbVZ4ZFdseVpTZ25MaTlmWkdWelkzSnBjSFJ2Y25NbktTQS9JR1oxYm1OMGFXOXVLRzlpYW1WamRDd2dhMlY1TENCMllXeDFaU2w3WEc0Z0lISmxkSFZ5YmlCa1VDNW1LRzlpYW1WamRDd2dhMlY1TENCamNtVmhkR1ZFWlhOaktERXNJSFpoYkhWbEtTazdYRzU5SURvZ1puVnVZM1JwYjI0b2IySnFaV04wTENCclpYa3NJSFpoYkhWbEtYdGNiaUFnYjJKcVpXTjBXMnRsZVYwZ1BTQjJZV3gxWlR0Y2JpQWdjbVYwZFhKdUlHOWlhbVZqZER0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5b2FXUmxMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0EzWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWdOaUEzSURnZ09TSXNJbHdpZFhObElITjBjbWxqZEZ3aU8xeHVYRzVsZUhCdmNuUnpMbDlmWlhOTmIyUjFiR1VnUFNCMGNuVmxPMXh1WEc1bGVIQnZjblJ6TG1SbFptRjFiSFFnUFNCbWRXNWpkR2x2YmlBb2FXNXpkR0Z1WTJVc0lFTnZibk4wY25WamRHOXlLU0I3WEc0Z0lHbG1JQ2doS0dsdWMzUmhibU5sSUdsdWMzUmhibU5sYjJZZ1EyOXVjM1J5ZFdOMGIzSXBLU0I3WEc0Z0lDQWdkR2h5YjNjZ2JtVjNJRlI1Y0dWRmNuSnZjaWhjSWtOaGJtNXZkQ0JqWVd4c0lHRWdZMnhoYzNNZ1lYTWdZU0JtZFc1amRHbHZibHdpS1R0Y2JpQWdmVnh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOW9aV3h3WlhKekwyTnNZWE56UTJGc2JFTm9aV05yTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBNFhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVnTmlBM0lEZ2dPU0F4TUNJc0luWmhjaUJuYkc5aVlXd2dJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOW5iRzlpWVd3bktWeHVJQ0FzSUdOdmNtVWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMk52Y21VbktWeHVJQ0FzSUdOMGVDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMk4wZUNjcFhHNGdJQ3dnYUdsa1pTQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZhR2xrWlNjcFhHNGdJQ3dnVUZKUFZFOVVXVkJGSUQwZ0ozQnliM1J2ZEhsd1pTYzdYRzVjYm5aaGNpQWtaWGh3YjNKMElEMGdablZ1WTNScGIyNG9kSGx3WlN3Z2JtRnRaU3dnYzI5MWNtTmxLWHRjYmlBZ2RtRnlJRWxUWDBaUFVrTkZSQ0E5SUhSNWNHVWdKaUFrWlhod2IzSjBMa1pjYmlBZ0lDQXNJRWxUWDBkTVQwSkJUQ0E5SUhSNWNHVWdKaUFrWlhod2IzSjBMa2RjYmlBZ0lDQXNJRWxUWDFOVVFWUkpReUE5SUhSNWNHVWdKaUFrWlhod2IzSjBMbE5jYmlBZ0lDQXNJRWxUWDFCU1QxUlBJQ0E5SUhSNWNHVWdKaUFrWlhod2IzSjBMbEJjYmlBZ0lDQXNJRWxUWDBKSlRrUWdJQ0E5SUhSNWNHVWdKaUFrWlhod2IzSjBMa0pjYmlBZ0lDQXNJRWxUWDFkU1FWQWdJQ0E5SUhSNWNHVWdKaUFrWlhod2IzSjBMbGRjYmlBZ0lDQXNJR1Y0Y0c5eWRITWdJQ0E5SUVsVFgwZE1UMEpCVENBL0lHTnZjbVVnT2lCamIzSmxXMjVoYldWZElIeDhJQ2hqYjNKbFcyNWhiV1ZkSUQwZ2UzMHBYRzRnSUNBZ0xDQmxlSEJRY205MGJ5QWdQU0JsZUhCdmNuUnpXMUJTVDFSUFZGbFFSVjFjYmlBZ0lDQXNJSFJoY21kbGRDQWdJQ0E5SUVsVFgwZE1UMEpCVENBL0lHZHNiMkpoYkNBNklFbFRYMU5VUVZSSlF5QS9JR2RzYjJKaGJGdHVZVzFsWFNBNklDaG5iRzlpWVd4YmJtRnRaVjBnZkh3Z2UzMHBXMUJTVDFSUFZGbFFSVjFjYmlBZ0lDQXNJR3RsZVN3Z2IzZHVMQ0J2ZFhRN1hHNGdJR2xtS0VsVFgwZE1UMEpCVENsemIzVnlZMlVnUFNCdVlXMWxPMXh1SUNCbWIzSW9hMlY1SUdsdUlITnZkWEpqWlNsN1hHNGdJQ0FnTHk4Z1kyOXVkR0ZwYm5NZ2FXNGdibUYwYVhabFhHNGdJQ0FnYjNkdUlEMGdJVWxUWDBaUFVrTkZSQ0FtSmlCMFlYSm5aWFFnSmlZZ2RHRnlaMlYwVzJ0bGVWMGdJVDA5SUhWdVpHVm1hVzVsWkR0Y2JpQWdJQ0JwWmlodmQyNGdKaVlnYTJWNUlHbHVJR1Y0Y0c5eWRITXBZMjl1ZEdsdWRXVTdYRzRnSUNBZ0x5OGdaWGh3YjNKMElHNWhkR2wyWlNCdmNpQndZWE56WldSY2JpQWdJQ0J2ZFhRZ1BTQnZkMjRnUHlCMFlYSm5aWFJiYTJWNVhTQTZJSE52ZFhKalpWdHJaWGxkTzF4dUlDQWdJQzh2SUhCeVpYWmxiblFnWjJ4dlltRnNJSEJ2Ykd4MWRHbHZiaUJtYjNJZ2JtRnRaWE53WVdObGMxeHVJQ0FnSUdWNGNHOXlkSE5iYTJWNVhTQTlJRWxUWDBkTVQwSkJUQ0FtSmlCMGVYQmxiMllnZEdGeVoyVjBXMnRsZVYwZ0lUMGdKMloxYm1OMGFXOXVKeUEvSUhOdmRYSmpaVnRyWlhsZFhHNGdJQ0FnTHk4Z1ltbHVaQ0IwYVcxbGNuTWdkRzhnWjJ4dlltRnNJR1p2Y2lCallXeHNJR1p5YjIwZ1pYaHdiM0owSUdOdmJuUmxlSFJjYmlBZ0lDQTZJRWxUWDBKSlRrUWdKaVlnYjNkdUlEOGdZM1I0S0c5MWRDd2daMnh2WW1Gc0tWeHVJQ0FnSUM4dklIZHlZWEFnWjJ4dlltRnNJR052Ym5OMGNuVmpkRzl5Y3lCbWIzSWdjSEpsZG1WdWRDQmphR0Z1WjJVZ2RHaGxiU0JwYmlCc2FXSnlZWEo1WEc0Z0lDQWdPaUJKVTE5WFVrRlFJQ1ltSUhSaGNtZGxkRnRyWlhsZElEMDlJRzkxZENBL0lDaG1kVzVqZEdsdmJpaERLWHRjYmlBZ0lDQWdJSFpoY2lCR0lEMGdablZ1WTNScGIyNG9ZU3dnWWl3Z1l5bDdYRzRnSUNBZ0lDQWdJR2xtS0hSb2FYTWdhVzV6ZEdGdVkyVnZaaUJES1h0Y2JpQWdJQ0FnSUNBZ0lDQnpkMmwwWTJnb1lYSm5kVzFsYm5SekxteGxibWQwYUNsN1hHNGdJQ0FnSUNBZ0lDQWdJQ0JqWVhObElEQTZJSEpsZEhWeWJpQnVaWGNnUXp0Y2JpQWdJQ0FnSUNBZ0lDQWdJR05oYzJVZ01Ub2djbVYwZFhKdUlHNWxkeUJES0dFcE8xeHVJQ0FnSUNBZ0lDQWdJQ0FnWTJGelpTQXlPaUJ5WlhSMWNtNGdibVYzSUVNb1lTd2dZaWs3WEc0Z0lDQWdJQ0FnSUNBZ2ZTQnlaWFIxY200Z2JtVjNJRU1vWVN3Z1lpd2dZeWs3WEc0Z0lDQWdJQ0FnSUgwZ2NtVjBkWEp1SUVNdVlYQndiSGtvZEdocGN5d2dZWEpuZFcxbGJuUnpLVHRjYmlBZ0lDQWdJSDA3WEc0Z0lDQWdJQ0JHVzFCU1QxUlBWRmxRUlYwZ1BTQkRXMUJTVDFSUFZGbFFSVjA3WEc0Z0lDQWdJQ0J5WlhSMWNtNGdSanRjYmlBZ0lDQXZMeUJ0WVd0bElITjBZWFJwWXlCMlpYSnphVzl1Y3lCbWIzSWdjSEp2ZEc5MGVYQmxJRzFsZEdodlpITmNiaUFnSUNCOUtTaHZkWFFwSURvZ1NWTmZVRkpQVkU4Z0ppWWdkSGx3Wlc5bUlHOTFkQ0E5UFNBblpuVnVZM1JwYjI0bklEOGdZM1I0S0VaMWJtTjBhVzl1TG1OaGJHd3NJRzkxZENrZ09pQnZkWFE3WEc0Z0lDQWdMeThnWlhod2IzSjBJSEJ5YjNSdklHMWxkR2h2WkhNZ2RHOGdZMjl5WlM0bFEwOU9VMVJTVlVOVVQxSWxMbTFsZEdodlpITXVKVTVCVFVVbFhHNGdJQ0FnYVdZb1NWTmZVRkpQVkU4cGUxeHVJQ0FnSUNBZ0tHVjRjRzl5ZEhNdWRtbHlkSFZoYkNCOGZDQW9aWGh3YjNKMGN5NTJhWEowZFdGc0lEMGdlMzBwS1Z0clpYbGRJRDBnYjNWME8xeHVJQ0FnSUNBZ0x5OGdaWGh3YjNKMElIQnliM1J2SUcxbGRHaHZaSE1nZEc4Z1kyOXlaUzRsUTA5T1UxUlNWVU5VVDFJbExuQnliM1J2ZEhsd1pTNGxUa0ZOUlNWY2JpQWdJQ0FnSUdsbUtIUjVjR1VnSmlBa1pYaHdiM0owTGxJZ0ppWWdaWGh3VUhKdmRHOGdKaVlnSVdWNGNGQnliM1J2VzJ0bGVWMHBhR2xrWlNobGVIQlFjbTkwYnl3Z2EyVjVMQ0J2ZFhRcE8xeHVJQ0FnSUgxY2JpQWdmVnh1ZlR0Y2JpOHZJSFI1Y0dVZ1ltbDBiV0Z3WEc0a1pYaHdiM0owTGtZZ1BTQXhPeUFnSUM4dklHWnZjbU5sWkZ4dUpHVjRjRzl5ZEM1SElEMGdNanNnSUNBdkx5Qm5iRzlpWVd4Y2JpUmxlSEJ2Y25RdVV5QTlJRFE3SUNBZ0x5OGdjM1JoZEdsalhHNGtaWGh3YjNKMExsQWdQU0E0T3lBZ0lDOHZJSEJ5YjNSdlhHNGtaWGh3YjNKMExrSWdQU0F4TmpzZ0lDOHZJR0pwYm1SY2JpUmxlSEJ2Y25RdVZ5QTlJRE15T3lBZ0x5OGdkM0poY0Z4dUpHVjRjRzl5ZEM1VklEMGdOalE3SUNBdkx5QnpZV1psWEc0a1pYaHdiM0owTGxJZ1BTQXhNamc3SUM4dklISmxZV3dnY0hKdmRHOGdiV1YwYUc5a0lHWnZjaUJnYkdsaWNtRnllV0FnWEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUNSbGVIQnZjblE3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWxlSEJ2Y25RdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEbGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNBMklEY2dPQ0E1SWl3aVhDSjFjMlVnYzNSeWFXTjBYQ0k3WEc1Y2JtVjRjRzl5ZEhNdVgxOWxjMDF2WkhWc1pTQTlJSFJ5ZFdVN1hHNWNiblpoY2lCZlpHVm1hVzVsVUhKdmNHVnlkSGtnUFNCeVpYRjFhWEpsS0Z3aUxpNHZZMjl5WlMxcWN5OXZZbXBsWTNRdlpHVm1hVzVsTFhCeWIzQmxjblI1WENJcE8xeHVYRzUyWVhJZ1gyUmxabWx1WlZCeWIzQmxjblI1TWlBOUlGOXBiblJsY205d1VtVnhkV2x5WlVSbFptRjFiSFFvWDJSbFptbHVaVkJ5YjNCbGNuUjVLVHRjYmx4dVpuVnVZM1JwYjI0Z1gybHVkR1Z5YjNCU1pYRjFhWEpsUkdWbVlYVnNkQ2h2WW1vcElIc2djbVYwZFhKdUlHOWlhaUFtSmlCdlltb3VYMTlsYzAxdlpIVnNaU0EvSUc5aWFpQTZJSHNnWkdWbVlYVnNkRG9nYjJKcUlIMDdJSDFjYmx4dVpYaHdiM0owY3k1a1pXWmhkV3gwSUQwZ1puVnVZM1JwYjI0Z0tDa2dlMXh1SUNCbWRXNWpkR2x2YmlCa1pXWnBibVZRY205d1pYSjBhV1Z6S0hSaGNtZGxkQ3dnY0hKdmNITXBJSHRjYmlBZ0lDQm1iM0lnS0haaGNpQnBJRDBnTURzZ2FTQThJSEJ5YjNCekxteGxibWQwYURzZ2FTc3JLU0I3WEc0Z0lDQWdJQ0IyWVhJZ1pHVnpZM0pwY0hSdmNpQTlJSEJ5YjNCelcybGRPMXh1SUNBZ0lDQWdaR1Z6WTNKcGNIUnZjaTVsYm5WdFpYSmhZbXhsSUQwZ1pHVnpZM0pwY0hSdmNpNWxiblZ0WlhKaFlteGxJSHg4SUdaaGJITmxPMXh1SUNBZ0lDQWdaR1Z6WTNKcGNIUnZjaTVqYjI1bWFXZDFjbUZpYkdVZ1BTQjBjblZsTzF4dUlDQWdJQ0FnYVdZZ0tGd2lkbUZzZFdWY0lpQnBiaUJrWlhOamNtbHdkRzl5S1NCa1pYTmpjbWx3ZEc5eUxuZHlhWFJoWW14bElEMGdkSEoxWlR0Y2JpQWdJQ0FnSUNnd0xDQmZaR1ZtYVc1bFVISnZjR1Z5ZEhreUxtUmxabUYxYkhRcEtIUmhjbWRsZEN3Z1pHVnpZM0pwY0hSdmNpNXJaWGtzSUdSbGMyTnlhWEIwYjNJcE8xeHVJQ0FnSUgxY2JpQWdmVnh1WEc0Z0lISmxkSFZ5YmlCbWRXNWpkR2x2YmlBb1EyOXVjM1J5ZFdOMGIzSXNJSEJ5YjNSdlVISnZjSE1zSUhOMFlYUnBZMUJ5YjNCektTQjdYRzRnSUNBZ2FXWWdLSEJ5YjNSdlVISnZjSE1wSUdSbFptbHVaVkJ5YjNCbGNuUnBaWE1vUTI5dWMzUnlkV04wYjNJdWNISnZkRzkwZVhCbExDQndjbTkwYjFCeWIzQnpLVHRjYmlBZ0lDQnBaaUFvYzNSaGRHbGpVSEp2Y0hNcElHUmxabWx1WlZCeWIzQmxjblJwWlhNb1EyOXVjM1J5ZFdOMGIzSXNJSE4wWVhScFkxQnliM0J6S1R0Y2JpQWdJQ0J5WlhSMWNtNGdRMjl1YzNSeWRXTjBiM0k3WEc0Z0lIMDdYRzU5S0NrN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJKaFltVnNMWEoxYm5ScGJXVXZhR1ZzY0dWeWN5OWpjbVZoZEdWRGJHRnpjeTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTVRCY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0EySURjZ09DQTVJaXdpYlc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhsZUdWaktYdGNiaUFnZEhKNUlIdGNiaUFnSUNCeVpYUjFjbTRnSVNGbGVHVmpLQ2s3WEc0Z0lIMGdZMkYwWTJnb1pTbDdYRzRnSUNBZ2NtVjBkWEp1SUhSeWRXVTdYRzRnSUgxY2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5bVlXbHNjeTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTVRGY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0EySURjZ09DQTVJaXdpZG1GeUlHaGhjMDkzYmxCeWIzQmxjblI1SUQwZ2UzMHVhR0Z6VDNkdVVISnZjR1Z5ZEhrN1hHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHbDBMQ0JyWlhrcGUxeHVJQ0J5WlhSMWNtNGdhR0Z6VDNkdVVISnZjR1Z5ZEhrdVkyRnNiQ2hwZEN3Z2EyVjVLVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlvWVhNdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlERXlYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSXZMeUIwYnlCcGJtUmxlR1ZrSUc5aWFtVmpkQ3dnZEc5UFltcGxZM1FnZDJsMGFDQm1ZV3hzWW1GamF5Qm1iM0lnYm05dUxXRnljbUY1TFd4cGEyVWdSVk16SUhOMGNtbHVaM05jYm5aaGNpQkpUMkpxWldOMElEMGdjbVZ4ZFdseVpTZ25MaTlmYVc5aWFtVmpkQ2NwWEc0Z0lDd2daR1ZtYVc1bFpDQTlJSEpsY1hWcGNtVW9KeTR2WDJSbFptbHVaV1FuS1R0Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b2FYUXBlMXh1SUNCeVpYUjFjbTRnU1U5aWFtVmpkQ2hrWldacGJtVmtLR2wwS1NrN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmRHOHRhVzlpYW1WamRDNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVE5jYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TSXNJaTh2SUc5d2RHbHZibUZzSUM4Z2MybHRjR3hsSUdOdmJuUmxlSFFnWW1sdVpHbHVaMXh1ZG1GeUlHRkdkVzVqZEdsdmJpQTlJSEpsY1hWcGNtVW9KeTR2WDJFdFpuVnVZM1JwYjI0bktUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9abTRzSUhSb1lYUXNJR3hsYm1kMGFDbDdYRzRnSUdGR2RXNWpkR2x2YmlobWJpazdYRzRnSUdsbUtIUm9ZWFFnUFQwOUlIVnVaR1ZtYVc1bFpDbHlaWFIxY200Z1ptNDdYRzRnSUhOM2FYUmphQ2hzWlc1bmRHZ3BlMXh1SUNBZ0lHTmhjMlVnTVRvZ2NtVjBkWEp1SUdaMWJtTjBhVzl1S0dFcGUxeHVJQ0FnSUNBZ2NtVjBkWEp1SUdadUxtTmhiR3dvZEdoaGRDd2dZU2s3WEc0Z0lDQWdmVHRjYmlBZ0lDQmpZWE5sSURJNklISmxkSFZ5YmlCbWRXNWpkR2x2YmloaExDQmlLWHRjYmlBZ0lDQWdJSEpsZEhWeWJpQm1iaTVqWVd4c0tIUm9ZWFFzSUdFc0lHSXBPMXh1SUNBZ0lIMDdYRzRnSUNBZ1kyRnpaU0F6T2lCeVpYUjFjbTRnWm5WdVkzUnBiMjRvWVN3Z1lpd2dZeWw3WEc0Z0lDQWdJQ0J5WlhSMWNtNGdabTR1WTJGc2JDaDBhR0YwTENCaExDQmlMQ0JqS1R0Y2JpQWdJQ0I5TzF4dUlDQjlYRzRnSUhKbGRIVnliaUJtZFc1amRHbHZiaWd2S2lBdUxpNWhjbWR6SUNvdktYdGNiaUFnSUNCeVpYUjFjbTRnWm00dVlYQndiSGtvZEdoaGRDd2dZWEpuZFcxbGJuUnpLVHRjYmlBZ2ZUdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWpkSGd1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURFMFhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVnTmlBM0lEZ2dPU0lzSW0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRvWW1sMGJXRndMQ0IyWVd4MVpTbDdYRzRnSUhKbGRIVnliaUI3WEc0Z0lDQWdaVzUxYldWeVlXSnNaU0FnT2lBaEtHSnBkRzFoY0NBbUlERXBMRnh1SUNBZ0lHTnZibVpwWjNWeVlXSnNaVG9nSVNoaWFYUnRZWEFnSmlBeUtTeGNiaUFnSUNCM2NtbDBZV0pzWlNBZ0lDQTZJQ0VvWW1sMGJXRndJQ1lnTkNrc1hHNGdJQ0FnZG1Gc2RXVWdJQ0FnSUNBZ09pQjJZV3gxWlZ4dUlDQjlPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM0J5YjNCbGNuUjVMV1JsYzJNdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlERTFYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVZ05pQTNJRGdnT1NJc0ltMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ2UzMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5cGRHVnlZWFJ2Y25NdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlERTJYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSjJZWElnYVhOUFltcGxZM1FnUFNCeVpYRjFhWEpsS0NjdUwxOXBjeTF2WW1wbFkzUW5LVnh1SUNBc0lHUnZZM1Z0Wlc1MElEMGdjbVZ4ZFdseVpTZ25MaTlmWjJ4dlltRnNKeWt1Wkc5amRXMWxiblJjYmlBZ0x5OGdhVzRnYjJ4a0lFbEZJSFI1Y0dWdlppQmtiMk4xYldWdWRDNWpjbVZoZEdWRmJHVnRaVzUwSUdseklDZHZZbXBsWTNRblhHNGdJQ3dnYVhNZ1BTQnBjMDlpYW1WamRDaGtiMk4xYldWdWRDa2dKaVlnYVhOUFltcGxZM1FvWkc5amRXMWxiblF1WTNKbFlYUmxSV3hsYldWdWRDazdYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLR2wwS1h0Y2JpQWdjbVYwZFhKdUlHbHpJRDhnWkc5amRXMWxiblF1WTNKbFlYUmxSV3hsYldWdWRDaHBkQ2tnT2lCN2ZUdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWtiMjB0WTNKbFlYUmxMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F4TjF4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJRFlnTnlBNElEa2lMQ0l2THlBeE9TNHhMakl1TVRRZ0x5QXhOUzR5TGpNdU1UUWdUMkpxWldOMExtdGxlWE1vVHlsY2JuWmhjaUFrYTJWNWN5QWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMXJaWGx6TFdsdWRHVnlibUZzSnlsY2JpQWdMQ0JsYm5WdFFuVm5TMlY1Y3lBOUlISmxjWFZwY21Vb0p5NHZYMlZ1ZFcwdFluVm5MV3RsZVhNbktUdGNibHh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JQWW1wbFkzUXVhMlY1Y3lCOGZDQm1kVzVqZEdsdmJpQnJaWGx6S0U4cGUxeHVJQ0J5WlhSMWNtNGdKR3RsZVhNb1R5d2daVzUxYlVKMVowdGxlWE1wTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDI5aWFtVmpkQzFyWlhsekxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXhPRnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlpd2liVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpaHBkQ2w3WEc0Z0lHbG1LSFI1Y0dWdlppQnBkQ0FoUFNBblpuVnVZM1JwYjI0bktYUm9jbTkzSUZSNWNHVkZjbkp2Y2locGRDQXJJQ2NnYVhNZ2JtOTBJR0VnWm5WdVkzUnBiMjRoSnlrN1hHNGdJSEpsZEhWeWJpQnBkRHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTloTFdaMWJtTjBhVzl1TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeE9WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSURZZ055QTRJRGtpTENKMllYSWdkRzlUZEhKcGJtY2dQU0I3ZlM1MGIxTjBjbWx1Wnp0Y2JseHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpaHBkQ2w3WEc0Z0lISmxkSFZ5YmlCMGIxTjBjbWx1Wnk1allXeHNLR2wwS1M1emJHbGpaU2c0TENBdE1TazdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZMjltTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeU1GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSWl3aUx5OGdOeTR4TGpFZ1ZHOVFjbWx0YVhScGRtVW9hVzV3ZFhRZ1d5d2dVSEpsWm1WeWNtVmtWSGx3WlYwcFhHNTJZWElnYVhOUFltcGxZM1FnUFNCeVpYRjFhWEpsS0NjdUwxOXBjeTF2WW1wbFkzUW5LVHRjYmk4dklHbHVjM1JsWVdRZ2IyWWdkR2hsSUVWVE5pQnpjR1ZqSUhabGNuTnBiMjRzSUhkbElHUnBaRzRuZENCcGJYQnNaVzFsYm5RZ1FFQjBiMUJ5YVcxcGRHbDJaU0JqWVhObFhHNHZMeUJoYm1RZ2RHaGxJSE5sWTI5dVpDQmhjbWQxYldWdWRDQXRJR1pzWVdjZ0xTQndjbVZtWlhKeVpXUWdkSGx3WlNCcGN5QmhJSE4wY21sdVoxeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpaHBkQ3dnVXlsN1hHNGdJR2xtS0NGcGMwOWlhbVZqZENocGRDa3BjbVYwZFhKdUlHbDBPMXh1SUNCMllYSWdabTRzSUhaaGJEdGNiaUFnYVdZb1V5QW1KaUIwZVhCbGIyWWdLR1p1SUQwZ2FYUXVkRzlUZEhKcGJtY3BJRDA5SUNkbWRXNWpkR2x2YmljZ0ppWWdJV2x6VDJKcVpXTjBLSFpoYkNBOUlHWnVMbU5oYkd3b2FYUXBLU2x5WlhSMWNtNGdkbUZzTzF4dUlDQnBaaWgwZVhCbGIyWWdLR1p1SUQwZ2FYUXVkbUZzZFdWUFppa2dQVDBnSjJaMWJtTjBhVzl1SnlBbUppQWhhWE5QWW1wbFkzUW9kbUZzSUQwZ1ptNHVZMkZzYkNocGRDa3BLWEpsZEhWeWJpQjJZV3c3WEc0Z0lHbG1LQ0ZUSUNZbUlIUjVjR1Z2WmlBb1ptNGdQU0JwZEM1MGIxTjBjbWx1WnlrZ1BUMGdKMloxYm1OMGFXOXVKeUFtSmlBaGFYTlBZbXBsWTNRb2RtRnNJRDBnWm00dVkyRnNiQ2hwZENrcEtYSmxkSFZ5YmlCMllXdzdYRzRnSUhSb2NtOTNJRlI1Y0dWRmNuSnZjaWhjSWtOaGJpZDBJR052Ym5abGNuUWdiMkpxWldOMElIUnZJSEJ5YVcxcGRHbDJaU0IyWVd4MVpWd2lLVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTkwYnkxd2NtbHRhWFJwZG1VdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlESXhYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVZ05pQTNJRGdnT1NJc0luWmhjaUJrWldZZ1BTQnlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRaSEFuS1M1bVhHNGdJQ3dnYUdGeklEMGdjbVZ4ZFdseVpTZ25MaTlmYUdGekp5bGNiaUFnTENCVVFVY2dQU0J5WlhGMWFYSmxLQ2N1TDE5M2EzTW5LU2duZEc5VGRISnBibWRVWVdjbktUdGNibHh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhwZEN3Z2RHRm5MQ0J6ZEdGMEtYdGNiaUFnYVdZb2FYUWdKaVlnSVdoaGN5aHBkQ0E5SUhOMFlYUWdQeUJwZENBNklHbDBMbkJ5YjNSdmRIbHdaU3dnVkVGSEtTbGtaV1lvYVhRc0lGUkJSeXdnZTJOdmJtWnBaM1Z5WVdKc1pUb2dkSEoxWlN3Z2RtRnNkV1U2SUhSaFozMHBPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM05sZEMxMGJ5MXpkSEpwYm1jdGRHRm5MbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F5TWx4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpZG1GeUlHbGtJRDBnTUZ4dUlDQXNJSEI0SUQwZ1RXRjBhQzV5WVc1a2IyMG9LVHRjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRvYTJWNUtYdGNiaUFnY21WMGRYSnVJQ2RUZVcxaWIyd29KeTVqYjI1allYUW9hMlY1SUQwOVBTQjFibVJsWm1sdVpXUWdQeUFuSnlBNklHdGxlU3dnSnlsZkp5d2dLQ3NyYVdRZ0t5QndlQ2t1ZEc5VGRISnBibWNvTXpZcEtUdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOTFhV1F1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURJelhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVpTENJdkx5QTNMakl1TVNCU1pYRjFhWEpsVDJKcVpXTjBRMjlsY21OcFlteGxLR0Z5WjNWdFpXNTBLVnh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhwZENsN1hHNGdJR2xtS0dsMElEMDlJSFZ1WkdWbWFXNWxaQ2wwYUhKdmR5QlVlWEJsUlhKeWIzSW9YQ0pEWVc0bmRDQmpZV3hzSUcxbGRHaHZaQ0J2YmlBZ1hDSWdLeUJwZENrN1hHNGdJSEpsZEhWeWJpQnBkRHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlrWldacGJtVmtMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F5TkZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpYlc5a2RXeGxMbVY0Y0c5eWRITWdQU0FoY21WeGRXbHlaU2duTGk5ZlpHVnpZM0pwY0hSdmNuTW5LU0FtSmlBaGNtVnhkV2x5WlNnbkxpOWZabUZwYkhNbktTaG1kVzVqZEdsdmJpZ3BlMXh1SUNCeVpYUjFjbTRnVDJKcVpXTjBMbVJsWm1sdVpWQnliM0JsY25SNUtISmxjWFZwY21Vb0p5NHZYMlJ2YlMxamNtVmhkR1VuS1NnblpHbDJKeWtzSUNkaEp5d2dlMmRsZERvZ1puVnVZM1JwYjI0b0tYc2djbVYwZFhKdUlEYzdJSDE5S1M1aElDRTlJRGM3WEc1OUtUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJsbE9DMWtiMjB0WkdWbWFXNWxMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F5TlZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJRFlnTnlBNElEa2lMQ0p0YjJSMWJHVXVaWGh3YjNKMGN5QTlJSFJ5ZFdVN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlzYVdKeVlYSjVMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F5Tmx4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpZG1GeUlITm9ZWEpsWkNBOUlISmxjWFZwY21Vb0p5NHZYM05vWVhKbFpDY3BLQ2RyWlhsekp5bGNiaUFnTENCMWFXUWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOTFhV1FuS1R0Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b2EyVjVLWHRjYmlBZ2NtVjBkWEp1SUhOb1lYSmxaRnRyWlhsZElIeDhJQ2h6YUdGeVpXUmJhMlY1WFNBOUlIVnBaQ2hyWlhrcEtUdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXphR0Z5WldRdGEyVjVMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F5TjF4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpTHk4Z055NHhMalFnVkc5SmJuUmxaMlZ5WEc1MllYSWdZMlZwYkNBZ1BTQk5ZWFJvTG1ObGFXeGNiaUFnTENCbWJHOXZjaUE5SUUxaGRHZ3VabXh2YjNJN1hHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHbDBLWHRjYmlBZ2NtVjBkWEp1SUdselRtRk9LR2wwSUQwZ0sybDBLU0EvSURBZ09pQW9hWFFnUGlBd0lEOGdabXh2YjNJZ09pQmpaV2xzS1NocGRDazdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZkRzh0YVc1MFpXZGxjaTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTWpoY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSWk4dklFbEZJRGd0SUdSdmJpZDBJR1Z1ZFcwZ1luVm5JR3RsZVhOY2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ0tGeHVJQ0FuWTI5dWMzUnlkV04wYjNJc2FHRnpUM2R1VUhKdmNHVnlkSGtzYVhOUWNtOTBiM1I1Y0dWUFppeHdjbTl3WlhKMGVVbHpSVzUxYldWeVlXSnNaU3gwYjB4dlkyRnNaVk4wY21sdVp5eDBiMU4wY21sdVp5eDJZV3gxWlU5bUoxeHVLUzV6Y0d4cGRDZ25MQ2NwTzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZaVzUxYlMxaWRXY3RhMlY1Y3k1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01qbGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0luWmhjaUJuYkc5aVlXd2dQU0J5WlhGMWFYSmxLQ2N1TDE5bmJHOWlZV3duS1Z4dUlDQXNJRk5JUVZKRlJDQTlJQ2RmWDJOdmNtVXRhbk5mYzJoaGNtVmtYMThuWEc0Z0lDd2djM1J2Y21VZ0lEMGdaMnh2WW1Gc1cxTklRVkpGUkYwZ2ZId2dLR2RzYjJKaGJGdFRTRUZTUlVSZElEMGdlMzBwTzF4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCbWRXNWpkR2x2YmloclpYa3BlMXh1SUNCeVpYUjFjbTRnYzNSdmNtVmJhMlY1WFNCOGZDQW9jM1J2Y21WYmEyVjVYU0E5SUh0OUtUdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXphR0Z5WldRdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlETXdYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSnRiMlIxYkdVdVpYaHdiM0owY3lBOUlIc2dYQ0prWldaaGRXeDBYQ0k2SUhKbGNYVnBjbVVvWENKamIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmIySnFaV04wTDJkbGRDMXdjbTkwYjNSNWNHVXRiMlpjSWlrc0lGOWZaWE5OYjJSMWJHVTZJSFJ5ZFdVZ2ZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlqYjNKbExXcHpMMjlpYW1WamRDOW5aWFF0Y0hKdmRHOTBlWEJsTFc5bUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXpNVnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENJdkx5QTNMakV1TVRNZ1ZHOVBZbXBsWTNRb1lYSm5kVzFsYm5RcFhHNTJZWElnWkdWbWFXNWxaQ0E5SUhKbGNYVnBjbVVvSnk0dlgyUmxabWx1WldRbktUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9hWFFwZTF4dUlDQnlaWFIxY200Z1QySnFaV04wS0dSbFptbHVaV1FvYVhRcEtUdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOTBieTF2WW1wbFkzUXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRE15WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWlMQ0p0YjJSMWJHVXVaWGh3YjNKMGN5QTlJSHNnWENKa1pXWmhkV3gwWENJNklISmxjWFZwY21Vb1hDSmpiM0psTFdwekwyeHBZbkpoY25rdlptNHZiMkpxWldOMEwyUmxabWx1WlMxd2NtOXdaWEowZVZ3aUtTd2dYMTlsYzAxdlpIVnNaVG9nZEhKMVpTQjlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJOdmNtVXRhbk12YjJKcVpXTjBMMlJsWm1sdVpTMXdjbTl3WlhKMGVTNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNek5jYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TQTJJRGNnT0NBNUlpd2lYQ0oxYzJVZ2MzUnlhV04wWENJN1hHNWNibVY0Y0c5eWRITXVYMTlsYzAxdlpIVnNaU0E5SUhSeWRXVTdYRzVjYm5aaGNpQmZjMlYwVUhKdmRHOTBlWEJsVDJZZ1BTQnlaWEYxYVhKbEtGd2lMaTR2WTI5eVpTMXFjeTl2WW1wbFkzUXZjMlYwTFhCeWIzUnZkSGx3WlMxdlpsd2lLVHRjYmx4dWRtRnlJRjl6WlhSUWNtOTBiM1I1Y0dWUFpqSWdQU0JmYVc1MFpYSnZjRkpsY1hWcGNtVkVaV1poZFd4MEtGOXpaWFJRY205MGIzUjVjR1ZQWmlrN1hHNWNiblpoY2lCZlkzSmxZWFJsSUQwZ2NtVnhkV2x5WlNoY0lpNHVMMk52Y21VdGFuTXZiMkpxWldOMEwyTnlaV0YwWlZ3aUtUdGNibHh1ZG1GeUlGOWpjbVZoZEdVeUlEMGdYMmx1ZEdWeWIzQlNaWEYxYVhKbFJHVm1ZWFZzZENoZlkzSmxZWFJsS1R0Y2JseHVkbUZ5SUY5MGVYQmxiMll5SUQwZ2NtVnhkV2x5WlNoY0lpNHVMMmhsYkhCbGNuTXZkSGx3Wlc5bVhDSXBPMXh1WEc1MllYSWdYM1I1Y0dWdlpqTWdQU0JmYVc1MFpYSnZjRkpsY1hWcGNtVkVaV1poZFd4MEtGOTBlWEJsYjJZeUtUdGNibHh1Wm5WdVkzUnBiMjRnWDJsdWRHVnliM0JTWlhGMWFYSmxSR1ZtWVhWc2RDaHZZbW9wSUhzZ2NtVjBkWEp1SUc5aWFpQW1KaUJ2WW1vdVgxOWxjMDF2WkhWc1pTQS9JRzlpYWlBNklIc2daR1ZtWVhWc2REb2diMkpxSUgwN0lIMWNibHh1Wlhod2IzSjBjeTVrWldaaGRXeDBJRDBnWm5WdVkzUnBiMjRnS0hOMVlrTnNZWE56TENCemRYQmxja05zWVhOektTQjdYRzRnSUdsbUlDaDBlWEJsYjJZZ2MzVndaWEpEYkdGemN5QWhQVDBnWENKbWRXNWpkR2x2Ymx3aUlDWW1JSE4xY0dWeVEyeGhjM01nSVQwOUlHNTFiR3dwSUh0Y2JpQWdJQ0IwYUhKdmR5QnVaWGNnVkhsd1pVVnljbTl5S0Z3aVUzVndaWElnWlhod2NtVnpjMmx2YmlCdGRYTjBJR1ZwZEdobGNpQmlaU0J1ZFd4c0lHOXlJR0VnWm5WdVkzUnBiMjRzSUc1dmRDQmNJaUFySUNoMGVYQmxiMllnYzNWd1pYSkRiR0Z6Y3lBOVBUMGdYQ0oxYm1SbFptbHVaV1JjSWlBL0lGd2lkVzVrWldacGJtVmtYQ0lnT2lBb01Dd2dYM1I1Y0dWdlpqTXVaR1ZtWVhWc2RDa29jM1Z3WlhKRGJHRnpjeWtwS1R0Y2JpQWdmVnh1WEc0Z0lITjFZa05zWVhOekxuQnliM1J2ZEhsd1pTQTlJQ2d3TENCZlkzSmxZWFJsTWk1a1pXWmhkV3gwS1NoemRYQmxja05zWVhOeklDWW1JSE4xY0dWeVEyeGhjM011Y0hKdmRHOTBlWEJsTENCN1hHNGdJQ0FnWTI5dWMzUnlkV04wYjNJNklIdGNiaUFnSUNBZ0lIWmhiSFZsT2lCemRXSkRiR0Z6Y3l4Y2JpQWdJQ0FnSUdWdWRXMWxjbUZpYkdVNklHWmhiSE5sTEZ4dUlDQWdJQ0FnZDNKcGRHRmliR1U2SUhSeWRXVXNYRzRnSUNBZ0lDQmpiMjVtYVdkMWNtRmliR1U2SUhSeWRXVmNiaUFnSUNCOVhHNGdJSDBwTzF4dUlDQnBaaUFvYzNWd1pYSkRiR0Z6Y3lrZ1gzTmxkRkJ5YjNSdmRIbHdaVTltTWk1a1pXWmhkV3gwSUQ4Z0tEQXNJRjl6WlhSUWNtOTBiM1I1Y0dWUFpqSXVaR1ZtWVhWc2RDa29jM1ZpUTJ4aGMzTXNJSE4xY0dWeVEyeGhjM01wSURvZ2MzVmlRMnhoYzNNdVgxOXdjbTkwYjE5ZklEMGdjM1Z3WlhKRGJHRnpjenRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJKaFltVnNMWEoxYm5ScGJXVXZhR1ZzY0dWeWN5OXBibWhsY21sMGN5NXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNelJjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SWl3aVhDSjFjMlVnYzNSeWFXTjBYQ0k3WEc1Y2JtVjRjRzl5ZEhNdVgxOWxjMDF2WkhWc1pTQTlJSFJ5ZFdVN1hHNWNiblpoY2lCZmRIbHdaVzltTWlBOUlISmxjWFZwY21Vb1hDSXVMaTlvWld4d1pYSnpMM1I1Y0dWdlpsd2lLVHRjYmx4dWRtRnlJRjkwZVhCbGIyWXpJRDBnWDJsdWRHVnliM0JTWlhGMWFYSmxSR1ZtWVhWc2RDaGZkSGx3Wlc5bU1pazdYRzVjYm1aMWJtTjBhVzl1SUY5cGJuUmxjbTl3VW1WeGRXbHlaVVJsWm1GMWJIUW9iMkpxS1NCN0lISmxkSFZ5YmlCdlltb2dKaVlnYjJKcUxsOWZaWE5OYjJSMWJHVWdQeUJ2WW1vZ09pQjdJR1JsWm1GMWJIUTZJRzlpYWlCOU95QjlYRzVjYm1WNGNHOXlkSE11WkdWbVlYVnNkQ0E5SUdaMWJtTjBhVzl1SUNoelpXeG1MQ0JqWVd4c0tTQjdYRzRnSUdsbUlDZ2hjMlZzWmlrZ2UxeHVJQ0FnSUhSb2NtOTNJRzVsZHlCU1pXWmxjbVZ1WTJWRmNuSnZjaWhjSW5Sb2FYTWdhR0Z6YmlkMElHSmxaVzRnYVc1cGRHbGhiR2x6WldRZ0xTQnpkWEJsY2lncElHaGhjMjRuZENCaVpXVnVJR05oYkd4bFpGd2lLVHRjYmlBZ2ZWeHVYRzRnSUhKbGRIVnliaUJqWVd4c0lDWW1JQ2dvZEhsd1pXOW1JR05oYkd3Z1BUMDlJRndpZFc1a1pXWnBibVZrWENJZ1B5QmNJblZ1WkdWbWFXNWxaRndpSURvZ0tEQXNJRjkwZVhCbGIyWXpMbVJsWm1GMWJIUXBLR05oYkd3cEtTQTlQVDBnWENKdlltcGxZM1JjSWlCOGZDQjBlWEJsYjJZZ1kyRnNiQ0E5UFQwZ1hDSm1kVzVqZEdsdmJsd2lLU0EvSUdOaGJHd2dPaUJ6Wld4bU8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZbUZpWld3dGNuVnVkR2x0WlM5b1pXeHdaWEp6TDNCdmMzTnBZbXhsUTI5dWMzUnlkV04wYjNKU1pYUjFjbTR1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURNMVhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015SXNJbkpsY1hWcGNtVW9KeTR1THk0dUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNWtaV1pwYm1VdGNISnZjR1Z5ZEhrbktUdGNiblpoY2lBa1QySnFaV04wSUQwZ2NtVnhkV2x5WlNnbkxpNHZMaTR2Ylc5a2RXeGxjeTlmWTI5eVpTY3BMazlpYW1WamREdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNGdaR1ZtYVc1bFVISnZjR1Z5ZEhrb2FYUXNJR3RsZVN3Z1pHVnpZeWw3WEc0Z0lISmxkSFZ5YmlBa1QySnFaV04wTG1SbFptbHVaVkJ5YjNCbGNuUjVLR2wwTENCclpYa3NJR1JsYzJNcE8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMjlpYW1WamRDOWtaV1pwYm1VdGNISnZjR1Z5ZEhrdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlETTJYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVZ05pQTNJRGdnT1NJc0lpOHZJREU1TGpFdU1pNHlJQzhnTVRVdU1pNHpMalVnVDJKcVpXTjBMbU55WldGMFpTaFBJRnNzSUZCeWIzQmxjblJwWlhOZEtWeHVkbUZ5SUdGdVQySnFaV04wSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmWVc0dGIySnFaV04wSnlsY2JpQWdMQ0JrVUhNZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMWtjSE1uS1Z4dUlDQXNJR1Z1ZFcxQ2RXZExaWGx6SUQwZ2NtVnhkV2x5WlNnbkxpOWZaVzUxYlMxaWRXY3RhMlY1Y3ljcFhHNGdJQ3dnU1VWZlVGSlBWRThnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTl6YUdGeVpXUXRhMlY1Snlrb0owbEZYMUJTVDFSUEp5bGNiaUFnTENCRmJYQjBlU0FnSUNBZ0lDQTlJR1oxYm1OMGFXOXVLQ2w3SUM4cUlHVnRjSFI1SUNvdklIMWNiaUFnTENCUVVrOVVUMVJaVUVVZ0lDQTlJQ2R3Y205MGIzUjVjR1VuTzF4dVhHNHZMeUJEY21WaGRHVWdiMkpxWldOMElIZHBkR2dnWm1GclpTQmdiblZzYkdBZ2NISnZkRzkwZVhCbE9pQjFjMlVnYVdaeVlXMWxJRTlpYW1WamRDQjNhWFJvSUdOc1pXRnlaV1FnY0hKdmRHOTBlWEJsWEc1MllYSWdZM0psWVhSbFJHbGpkQ0E5SUdaMWJtTjBhVzl1S0NsN1hHNGdJQzh2SUZSb2NtRnphQ3dnZDJGemRHVWdZVzVrSUhOdlpHOXRlVG9nU1VVZ1IwTWdZblZuWEc0Z0lIWmhjaUJwWm5KaGJXVWdQU0J5WlhGMWFYSmxLQ2N1TDE5a2IyMHRZM0psWVhSbEp5a29KMmxtY21GdFpTY3BYRzRnSUNBZ0xDQnBJQ0FnSUNBZ1BTQmxiblZ0UW5WblMyVjVjeTVzWlc1bmRHaGNiaUFnSUNBc0lHeDBJQ0FnSUNBOUlDYzhKMXh1SUNBZ0lDd2daM1FnSUNBZ0lEMGdKejRuWEc0Z0lDQWdMQ0JwWm5KaGJXVkViMk4xYldWdWREdGNiaUFnYVdaeVlXMWxMbk4wZVd4bExtUnBjM0JzWVhrZ1BTQW5ibTl1WlNjN1hHNGdJSEpsY1hWcGNtVW9KeTR2WDJoMGJXd25LUzVoY0hCbGJtUkRhR2xzWkNocFpuSmhiV1VwTzF4dUlDQnBabkpoYldVdWMzSmpJRDBnSjJwaGRtRnpZM0pwY0hRNkp6c2dMeThnWlhOc2FXNTBMV1JwYzJGaWJHVXRiR2x1WlNCdWJ5MXpZM0pwY0hRdGRYSnNYRzRnSUM4dklHTnlaV0YwWlVScFkzUWdQU0JwWm5KaGJXVXVZMjl1ZEdWdWRGZHBibVJ2ZHk1UFltcGxZM1E3WEc0Z0lDOHZJR2gwYld3dWNtVnRiM1psUTJocGJHUW9hV1p5WVcxbEtUdGNiaUFnYVdaeVlXMWxSRzlqZFcxbGJuUWdQU0JwWm5KaGJXVXVZMjl1ZEdWdWRGZHBibVJ2ZHk1a2IyTjFiV1Z1ZER0Y2JpQWdhV1p5WVcxbFJHOWpkVzFsYm5RdWIzQmxiaWdwTzF4dUlDQnBabkpoYldWRWIyTjFiV1Z1ZEM1M2NtbDBaU2hzZENBcklDZHpZM0pwY0hRbklDc2daM1FnS3lBblpHOWpkVzFsYm5RdVJqMVBZbXBsWTNRbklDc2diSFFnS3lBbkwzTmpjbWx3ZENjZ0t5Qm5kQ2s3WEc0Z0lHbG1jbUZ0WlVSdlkzVnRaVzUwTG1Oc2IzTmxLQ2s3WEc0Z0lHTnlaV0YwWlVScFkzUWdQU0JwWm5KaGJXVkViMk4xYldWdWRDNUdPMXh1SUNCM2FHbHNaU2hwTFMwcFpHVnNaWFJsSUdOeVpXRjBaVVJwWTNSYlVGSlBWRTlVV1ZCRlhWdGxiblZ0UW5WblMyVjVjMXRwWFYwN1hHNGdJSEpsZEhWeWJpQmpjbVZoZEdWRWFXTjBLQ2s3WEc1OU8xeHVYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJRTlpYW1WamRDNWpjbVZoZEdVZ2ZId2dablZ1WTNScGIyNGdZM0psWVhSbEtFOHNJRkJ5YjNCbGNuUnBaWE1wZTF4dUlDQjJZWElnY21WemRXeDBPMXh1SUNCcFppaFBJQ0U5UFNCdWRXeHNLWHRjYmlBZ0lDQkZiWEIwZVZ0UVVrOVVUMVJaVUVWZElEMGdZVzVQWW1wbFkzUW9UeWs3WEc0Z0lDQWdjbVZ6ZFd4MElEMGdibVYzSUVWdGNIUjVPMXh1SUNBZ0lFVnRjSFI1VzFCU1QxUlBWRmxRUlYwZ1BTQnVkV3hzTzF4dUlDQWdJQzh2SUdGa1pDQmNJbDlmY0hKdmRHOWZYMXdpSUdadmNpQlBZbXBsWTNRdVoyVjBVSEp2ZEc5MGVYQmxUMllnY0c5c2VXWnBiR3hjYmlBZ0lDQnlaWE4xYkhSYlNVVmZVRkpQVkU5ZElEMGdUenRjYmlBZ2ZTQmxiSE5sSUhKbGMzVnNkQ0E5SUdOeVpXRjBaVVJwWTNRb0tUdGNiaUFnY21WMGRYSnVJRkJ5YjNCbGNuUnBaWE1nUFQwOUlIVnVaR1ZtYVc1bFpDQS9JSEpsYzNWc2RDQTZJR1JRY3loeVpYTjFiSFFzSUZCeWIzQmxjblJwWlhNcE8xeHVmVHRjYmx4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZiMkpxWldOMExXTnlaV0YwWlM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ016ZGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0luWmhjaUFrWlhod2IzSjBJRDBnY21WeGRXbHlaU2duTGk5ZlpYaHdiM0owSnlrN1hHNHZMeUF4T1M0eExqSXVOQ0F2SURFMUxqSXVNeTQySUU5aWFtVmpkQzVrWldacGJtVlFjbTl3WlhKMGVTaFBMQ0JRTENCQmRIUnlhV0oxZEdWektWeHVKR1Y0Y0c5eWRDZ2taWGh3YjNKMExsTWdLeUFrWlhod2IzSjBMa1lnS2lBaGNtVnhkV2x5WlNnbkxpOWZaR1Z6WTNKcGNIUnZjbk1uS1N3Z0owOWlhbVZqZENjc0lIdGtaV1pwYm1WUWNtOXdaWEowZVRvZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXUndKeWt1Wm4wcE8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlsY3pZdWIySnFaV04wTG1SbFptbHVaUzF3Y205d1pYSjBlUzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTXpoY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0EySURjZ09DQTVJaXdpSjNWelpTQnpkSEpwWTNRbk8xeHVkbUZ5SUV4SlFsSkJVbGtnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmJHbGljbUZ5ZVNjcFhHNGdJQ3dnSkdWNGNHOXlkQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5bGVIQnZjblFuS1Z4dUlDQXNJSEpsWkdWbWFXNWxJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmY21Wa1pXWnBibVVuS1Z4dUlDQXNJR2hwWkdVZ0lDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYUdsa1pTY3BYRzRnSUN3Z2FHRnpJQ0FnSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOW9ZWE1uS1Z4dUlDQXNJRWwwWlhKaGRHOXljeUFnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYVhSbGNtRjBiM0p6SnlsY2JpQWdMQ0FrYVhSbGNrTnlaV0YwWlNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJsMFpYSXRZM0psWVhSbEp5bGNiaUFnTENCelpYUlViMU4wY21sdVoxUmhaeUE5SUhKbGNYVnBjbVVvSnk0dlgzTmxkQzEwYnkxemRISnBibWN0ZEdGbkp5bGNiaUFnTENCblpYUlFjbTkwYjNSNWNHVlBaaUE5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxbmNHOG5LVnh1SUNBc0lFbFVSVkpCVkU5U0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZkMnR6Snlrb0oybDBaWEpoZEc5eUp5bGNiaUFnTENCQ1ZVZEhXU0FnSUNBZ0lDQWdJQ0E5SUNFb1cxMHVhMlY1Y3lBbUppQW5ibVY0ZENjZ2FXNGdXMTB1YTJWNWN5Z3BLU0F2THlCVFlXWmhjbWtnYUdGeklHSjFaMmQ1SUdsMFpYSmhkRzl5Y3lCM0wyOGdZRzVsZUhSZ1hHNGdJQ3dnUmtaZlNWUkZVa0ZVVDFJZ0lDQWdQU0FuUUVCcGRHVnlZWFJ2Y2lkY2JpQWdMQ0JMUlZsVElDQWdJQ0FnSUNBZ0lDQTlJQ2RyWlhsekoxeHVJQ0FzSUZaQlRGVkZVeUFnSUNBZ0lDQWdJRDBnSjNaaGJIVmxjeWM3WEc1Y2JuWmhjaUJ5WlhSMWNtNVVhR2x6SUQwZ1puVnVZM1JwYjI0b0tYc2djbVYwZFhKdUlIUm9hWE03SUgwN1hHNWNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9RbUZ6WlN3Z1RrRk5SU3dnUTI5dWMzUnlkV04wYjNJc0lHNWxlSFFzSUVSRlJrRlZURlFzSUVsVFgxTkZWQ3dnUms5U1EwVkVLWHRjYmlBZ0pHbDBaWEpEY21WaGRHVW9RMjl1YzNSeWRXTjBiM0lzSUU1QlRVVXNJRzVsZUhRcE8xeHVJQ0IyWVhJZ1oyVjBUV1YwYUc5a0lEMGdablZ1WTNScGIyNG9hMmx1WkNsN1hHNGdJQ0FnYVdZb0lVSlZSMGRaSUNZbUlHdHBibVFnYVc0Z2NISnZkRzhwY21WMGRYSnVJSEJ5YjNSdlcydHBibVJkTzF4dUlDQWdJSE4zYVhSamFDaHJhVzVrS1h0Y2JpQWdJQ0FnSUdOaGMyVWdTMFZaVXpvZ2NtVjBkWEp1SUdaMWJtTjBhVzl1SUd0bGVYTW9LWHNnY21WMGRYSnVJRzVsZHlCRGIyNXpkSEoxWTNSdmNpaDBhR2x6TENCcmFXNWtLVHNnZlR0Y2JpQWdJQ0FnSUdOaGMyVWdWa0ZNVlVWVE9pQnlaWFIxY200Z1puVnVZM1JwYjI0Z2RtRnNkV1Z6S0NsN0lISmxkSFZ5YmlCdVpYY2dRMjl1YzNSeWRXTjBiM0lvZEdocGN5d2dhMmx1WkNrN0lIMDdYRzRnSUNBZ2ZTQnlaWFIxY200Z1puVnVZM1JwYjI0Z1pXNTBjbWxsY3lncGV5QnlaWFIxY200Z2JtVjNJRU52Ym5OMGNuVmpkRzl5S0hSb2FYTXNJR3RwYm1RcE95QjlPMXh1SUNCOU8xeHVJQ0IyWVhJZ1ZFRkhJQ0FnSUNBZ0lDQTlJRTVCVFVVZ0t5QW5JRWwwWlhKaGRHOXlKMXh1SUNBZ0lDd2dSRVZHWDFaQlRGVkZVeUE5SUVSRlJrRlZURlFnUFQwZ1ZrRk1WVVZUWEc0Z0lDQWdMQ0JXUVV4VlJWTmZRbFZISUQwZ1ptRnNjMlZjYmlBZ0lDQXNJSEJ5YjNSdklDQWdJQ0FnUFNCQ1lYTmxMbkJ5YjNSdmRIbHdaVnh1SUNBZ0lDd2dKRzVoZEdsMlpTQWdJQ0E5SUhCeWIzUnZXMGxVUlZKQlZFOVNYU0I4ZkNCd2NtOTBiMXRHUmw5SlZFVlNRVlJQVWwwZ2ZId2dSRVZHUVZWTVZDQW1KaUJ3Y205MGIxdEVSVVpCVlV4VVhWeHVJQ0FnSUN3Z0pHUmxabUYxYkhRZ0lDQTlJQ1J1WVhScGRtVWdmSHdnWjJWMFRXVjBhRzlrS0VSRlJrRlZURlFwWEc0Z0lDQWdMQ0FrWlc1MGNtbGxjeUFnSUQwZ1JFVkdRVlZNVkNBL0lDRkVSVVpmVmtGTVZVVlRJRDhnSkdSbFptRjFiSFFnT2lCblpYUk5aWFJvYjJRb0oyVnVkSEpwWlhNbktTQTZJSFZ1WkdWbWFXNWxaRnh1SUNBZ0lDd2dKR0Z1ZVU1aGRHbDJaU0E5SUU1QlRVVWdQVDBnSjBGeWNtRjVKeUEvSUhCeWIzUnZMbVZ1ZEhKcFpYTWdmSHdnSkc1aGRHbDJaU0E2SUNSdVlYUnBkbVZjYmlBZ0lDQXNJRzFsZEdodlpITXNJR3RsZVN3Z1NYUmxjbUYwYjNKUWNtOTBiM1I1Y0dVN1hHNGdJQzh2SUVacGVDQnVZWFJwZG1WY2JpQWdhV1lvSkdGdWVVNWhkR2wyWlNsN1hHNGdJQ0FnU1hSbGNtRjBiM0pRY205MGIzUjVjR1VnUFNCblpYUlFjbTkwYjNSNWNHVlBaaWdrWVc1NVRtRjBhWFpsTG1OaGJHd29ibVYzSUVKaGMyVXBLVHRjYmlBZ0lDQnBaaWhKZEdWeVlYUnZjbEJ5YjNSdmRIbHdaU0FoUFQwZ1QySnFaV04wTG5CeWIzUnZkSGx3WlNsN1hHNGdJQ0FnSUNBdkx5QlRaWFFnUUVCMGIxTjBjbWx1WjFSaFp5QjBieUJ1WVhScGRtVWdhWFJsY21GMGIzSnpYRzRnSUNBZ0lDQnpaWFJVYjFOMGNtbHVaMVJoWnloSmRHVnlZWFJ2Y2xCeWIzUnZkSGx3WlN3Z1ZFRkhMQ0IwY25WbEtUdGNiaUFnSUNBZ0lDOHZJR1pwZUNCbWIzSWdjMjl0WlNCdmJHUWdaVzVuYVc1bGMxeHVJQ0FnSUNBZ2FXWW9JVXhKUWxKQlVsa2dKaVlnSVdoaGN5aEpkR1Z5WVhSdmNsQnliM1J2ZEhsd1pTd2dTVlJGVWtGVVQxSXBLV2hwWkdVb1NYUmxjbUYwYjNKUWNtOTBiM1I1Y0dVc0lFbFVSVkpCVkU5U0xDQnlaWFIxY201VWFHbHpLVHRjYmlBZ0lDQjlYRzRnSUgxY2JpQWdMeThnWm1sNElFRnljbUY1STN0MllXeDFaWE1zSUVCQWFYUmxjbUYwYjNKOUxtNWhiV1VnYVc0Z1ZqZ2dMeUJHUmx4dUlDQnBaaWhFUlVaZlZrRk1WVVZUSUNZbUlDUnVZWFJwZG1VZ0ppWWdKRzVoZEdsMlpTNXVZVzFsSUNFOVBTQldRVXhWUlZNcGUxeHVJQ0FnSUZaQlRGVkZVMTlDVlVjZ1BTQjBjblZsTzF4dUlDQWdJQ1JrWldaaGRXeDBJRDBnWm5WdVkzUnBiMjRnZG1Gc2RXVnpLQ2w3SUhKbGRIVnliaUFrYm1GMGFYWmxMbU5oYkd3b2RHaHBjeWs3SUgwN1hHNGdJSDFjYmlBZ0x5OGdSR1ZtYVc1bElHbDBaWEpoZEc5eVhHNGdJR2xtS0NnaFRFbENVa0ZTV1NCOGZDQkdUMUpEUlVRcElDWW1JQ2hDVlVkSFdTQjhmQ0JXUVV4VlJWTmZRbFZISUh4OElDRndjbTkwYjF0SlZFVlNRVlJQVWwwcEtYdGNiaUFnSUNCb2FXUmxLSEJ5YjNSdkxDQkpWRVZTUVZSUFVpd2dKR1JsWm1GMWJIUXBPMXh1SUNCOVhHNGdJQzh2SUZCc2RXY2dabTl5SUd4cFluSmhjbmxjYmlBZ1NYUmxjbUYwYjNKelcwNUJUVVZkSUQwZ0pHUmxabUYxYkhRN1hHNGdJRWwwWlhKaGRHOXljMXRVUVVkZElDQTlJSEpsZEhWeWJsUm9hWE03WEc0Z0lHbG1LRVJGUmtGVlRGUXBlMXh1SUNBZ0lHMWxkR2h2WkhNZ1BTQjdYRzRnSUNBZ0lDQjJZV3gxWlhNNklDQkVSVVpmVmtGTVZVVlRJRDhnSkdSbFptRjFiSFFnT2lCblpYUk5aWFJvYjJRb1ZrRk1WVVZUS1N4Y2JpQWdJQ0FnSUd0bGVYTTZJQ0FnSUVsVFgxTkZWQ0FnSUNBZ1B5QWtaR1ZtWVhWc2RDQTZJR2RsZEUxbGRHaHZaQ2hMUlZsVEtTeGNiaUFnSUNBZ0lHVnVkSEpwWlhNNklDUmxiblJ5YVdWelhHNGdJQ0FnZlR0Y2JpQWdJQ0JwWmloR1QxSkRSVVFwWm05eUtHdGxlU0JwYmlCdFpYUm9iMlJ6S1h0Y2JpQWdJQ0FnSUdsbUtDRW9hMlY1SUdsdUlIQnliM1J2S1NseVpXUmxabWx1WlNod2NtOTBieXdnYTJWNUxDQnRaWFJvYjJSelcydGxlVjBwTzF4dUlDQWdJSDBnWld4elpTQWtaWGh3YjNKMEtDUmxlSEJ2Y25RdVVDQXJJQ1JsZUhCdmNuUXVSaUFxSUNoQ1ZVZEhXU0I4ZkNCV1FVeFZSVk5mUWxWSEtTd2dUa0ZOUlN3Z2JXVjBhRzlrY3lrN1hHNGdJSDFjYmlBZ2NtVjBkWEp1SUcxbGRHaHZaSE03WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYVhSbGNpMWtaV1pwYm1VdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlETTVYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSnRiMlIxYkdVdVpYaHdiM0owY3lBOUlIc2dYQ0prWldaaGRXeDBYQ0k2SUhKbGNYVnBjbVVvWENKamIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmFuTnZiaTl6ZEhKcGJtZHBabmxjSWlrc0lGOWZaWE5OYjJSMWJHVTZJSFJ5ZFdVZ2ZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlqYjNKbExXcHpMMnB6YjI0dmMzUnlhVzVuYVdaNUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTBNRnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlEWWlMQ0psZUhCdmNuUnpMbVlnUFNCN2ZTNXdjbTl3WlhKMGVVbHpSVzUxYldWeVlXSnNaVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyOWlhbVZqZEMxd2FXVXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRFF4WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlJc0ltMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ2NtVnhkV2x5WlNnbkxpOWZaMnh2WW1Gc0p5a3VaRzlqZFcxbGJuUWdKaVlnWkc5amRXMWxiblF1Wkc5amRXMWxiblJGYkdWdFpXNTBPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFIUnRiQzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTkRKY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSWk4dklERTVMakV1TWk0NUlDOGdNVFV1TWk0ekxqSWdUMkpxWldOMExtZGxkRkJ5YjNSdmRIbHdaVTltS0U4cFhHNTJZWElnYUdGeklDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlvWVhNbktWeHVJQ0FzSUhSdlQySnFaV04wSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZEc4dGIySnFaV04wSnlsY2JpQWdMQ0JKUlY5UVVrOVVUeUFnSUNBOUlISmxjWFZwY21Vb0p5NHZYM05vWVhKbFpDMXJaWGtuS1NnblNVVmZVRkpQVkU4bktWeHVJQ0FzSUU5aWFtVmpkRkJ5YjNSdklEMGdUMkpxWldOMExuQnliM1J2ZEhsd1pUdGNibHh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JQWW1wbFkzUXVaMlYwVUhKdmRHOTBlWEJsVDJZZ2ZId2dablZ1WTNScGIyNG9UeWw3WEc0Z0lFOGdQU0IwYjA5aWFtVmpkQ2hQS1R0Y2JpQWdhV1lvYUdGektFOHNJRWxGWDFCU1QxUlBLU2x5WlhSMWNtNGdUMXRKUlY5UVVrOVVUMTA3WEc0Z0lHbG1LSFI1Y0dWdlppQlBMbU52Ym5OMGNuVmpkRzl5SUQwOUlDZG1kVzVqZEdsdmJpY2dKaVlnVHlCcGJuTjBZVzVqWlc5bUlFOHVZMjl1YzNSeWRXTjBiM0lwZTF4dUlDQWdJSEpsZEhWeWJpQlBMbU52Ym5OMGNuVmpkRzl5TG5CeWIzUnZkSGx3WlR0Y2JpQWdmU0J5WlhSMWNtNGdUeUJwYm5OMFlXNWpaVzltSUU5aWFtVmpkQ0EvSUU5aWFtVmpkRkJ5YjNSdklEb2diblZzYkR0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5dlltcGxZM1F0WjNCdkxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTBNMXh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlpd2lkbUZ5SUdoaGN5QWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJoaGN5Y3BYRzRnSUN3Z2RHOUpUMkpxWldOMElDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmRHOHRhVzlpYW1WamRDY3BYRzRnSUN3Z1lYSnlZWGxKYm1SbGVFOW1JRDBnY21WeGRXbHlaU2duTGk5ZllYSnlZWGt0YVc1amJIVmtaWE1uS1NobVlXeHpaU2xjYmlBZ0xDQkpSVjlRVWs5VVR5QWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXphR0Z5WldRdGEyVjVKeWtvSjBsRlgxQlNUMVJQSnlrN1hHNWNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9iMkpxWldOMExDQnVZVzFsY3lsN1hHNGdJSFpoY2lCUElDQWdJQ0FnUFNCMGIwbFBZbXBsWTNRb2IySnFaV04wS1Z4dUlDQWdJQ3dnYVNBZ0lDQWdJRDBnTUZ4dUlDQWdJQ3dnY21WemRXeDBJRDBnVzExY2JpQWdJQ0FzSUd0bGVUdGNiaUFnWm05eUtHdGxlU0JwYmlCUEtXbG1LR3RsZVNBaFBTQkpSVjlRVWs5VVR5bG9ZWE1vVHl3Z2EyVjVLU0FtSmlCeVpYTjFiSFF1Y0hWemFDaHJaWGtwTzF4dUlDQXZMeUJFYjI0bmRDQmxiblZ0SUdKMVp5QW1JR2hwWkdSbGJpQnJaWGx6WEc0Z0lIZG9hV3hsS0c1aGJXVnpMbXhsYm1kMGFDQStJR2twYVdZb2FHRnpLRThzSUd0bGVTQTlJRzVoYldWelcya3JLMTBwS1h0Y2JpQWdJQ0IrWVhKeVlYbEpibVJsZUU5bUtISmxjM1ZzZEN3Z2EyVjVLU0I4ZkNCeVpYTjFiSFF1Y0hWemFDaHJaWGtwTzF4dUlDQjlYRzRnSUhKbGRIVnliaUJ5WlhOMWJIUTdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZiMkpxWldOMExXdGxlWE10YVc1MFpYSnVZV3d1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURRMFhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVpTENJdkx5QnRiM04wSUU5aWFtVmpkQ0J0WlhSb2IyUnpJR0o1SUVWVE5pQnphRzkxYkdRZ1lXTmpaWEIwSUhCeWFXMXBkR2wyWlhOY2JuWmhjaUFrWlhod2IzSjBJRDBnY21WeGRXbHlaU2duTGk5ZlpYaHdiM0owSnlsY2JpQWdMQ0JqYjNKbElDQWdJRDBnY21WeGRXbHlaU2duTGk5ZlkyOXlaU2NwWEc0Z0lDd2dabUZwYkhNZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJaaGFXeHpKeWs3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0V0RldTd2daWGhsWXlsN1hHNGdJSFpoY2lCbWJpQWdQU0FvWTI5eVpTNVBZbXBsWTNRZ2ZId2dlMzBwVzB0RldWMGdmSHdnVDJKcVpXTjBXMHRGV1YxY2JpQWdJQ0FzSUdWNGNDQTlJSHQ5TzF4dUlDQmxlSEJiUzBWWlhTQTlJR1Y0WldNb1ptNHBPMXh1SUNBa1pYaHdiM0owS0NSbGVIQnZjblF1VXlBcklDUmxlSEJ2Y25RdVJpQXFJR1poYVd4ektHWjFibU4wYVc5dUtDbDdJR1p1S0RFcE95QjlLU3dnSjA5aWFtVmpkQ2NzSUdWNGNDazdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZiMkpxWldOMExYTmhjQzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTkRWY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSW0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnY21WeGRXbHlaU2duTGk5ZmFHbGtaU2NwTzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZjbVZrWldacGJtVXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRFEyWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWlMQ0l2THlBM0xqRXVNVFVnVkc5TVpXNW5kR2hjYm5aaGNpQjBiMGx1ZEdWblpYSWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXBiblJsWjJWeUp5bGNiaUFnTENCdGFXNGdJQ0FnSUNBZ1BTQk5ZWFJvTG0xcGJqdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9hWFFwZTF4dUlDQnlaWFIxY200Z2FYUWdQaUF3SUQ4Z2JXbHVLSFJ2U1c1MFpXZGxjaWhwZENrc0lEQjRNV1ptWm1abVptWm1abVptWm1ZcElEb2dNRHNnTHk4Z2NHOTNLRElzSURVektTQXRJREVnUFQwZ09UQXdOekU1T1RJMU5EYzBNRGs1TVZ4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDNSdkxXeGxibWQwYUM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ05EZGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0luWmhjaUJuYkc5aVlXd2dJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJkc2IySmhiQ2NwWEc0Z0lDd2dZMjl5WlNBZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlqYjNKbEp5bGNiaUFnTENCTVNVSlNRVkpaSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyeHBZbkpoY25rbktWeHVJQ0FzSUhkcmMwVjRkQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmQydHpMV1Y0ZENjcFhHNGdJQ3dnWkdWbWFXNWxVSEp2Y0dWeWRIa2dQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0WkhBbktTNW1PMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWh1WVcxbEtYdGNiaUFnZG1GeUlDUlRlVzFpYjJ3Z1BTQmpiM0psTGxONWJXSnZiQ0I4ZkNBb1kyOXlaUzVUZVcxaWIyd2dQU0JNU1VKU1FWSlpJRDhnZTMwZ09pQm5iRzlpWVd3dVUzbHRZbTlzSUh4OElIdDlLVHRjYmlBZ2FXWW9ibUZ0WlM1amFHRnlRWFFvTUNrZ0lUMGdKMThuSUNZbUlDRW9ibUZ0WlNCcGJpQWtVM2x0WW05c0tTbGtaV1pwYm1WUWNtOXdaWEowZVNna1UzbHRZbTlzTENCdVlXMWxMQ0I3ZG1Gc2RXVTZJSGRyYzBWNGRDNW1LRzVoYldVcGZTazdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZkMnR6TFdSbFptbHVaUzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTkRoY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklpd2laWGh3YjNKMGN5NW1JRDBnY21WeGRXbHlaU2duTGk5ZmQydHpKeWs3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOTNhM010WlhoMExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTBPVnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENJbmRYTmxJSE4wY21samRDYzdYRzUyWVhJZ0pHRjBJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzTjBjbWx1WnkxaGRDY3BLSFJ5ZFdVcE8xeHVYRzR2THlBeU1TNHhMak11TWpjZ1UzUnlhVzVuTG5CeWIzUnZkSGx3WlZ0QVFHbDBaWEpoZEc5eVhTZ3BYRzV5WlhGMWFYSmxLQ2N1TDE5cGRHVnlMV1JsWm1sdVpTY3BLRk4wY21sdVp5d2dKMU4wY21sdVp5Y3NJR1oxYm1OMGFXOXVLR2wwWlhKaGRHVmtLWHRjYmlBZ2RHaHBjeTVmZENBOUlGTjBjbWx1WnlocGRHVnlZWFJsWkNrN0lDOHZJSFJoY21kbGRGeHVJQ0IwYUdsekxsOXBJRDBnTURzZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnTHk4Z2JtVjRkQ0JwYm1SbGVGeHVMeThnTWpFdU1TNDFMakl1TVNBbFUzUnlhVzVuU1hSbGNtRjBiM0pRY205MGIzUjVjR1VsTG01bGVIUW9LVnh1ZlN3Z1puVnVZM1JwYjI0b0tYdGNiaUFnZG1GeUlFOGdJQ0FnSUQwZ2RHaHBjeTVmZEZ4dUlDQWdJQ3dnYVc1a1pYZ2dQU0IwYUdsekxsOXBYRzRnSUNBZ0xDQndiMmx1ZER0Y2JpQWdhV1lvYVc1a1pYZ2dQajBnVHk1c1pXNW5kR2dwY21WMGRYSnVJSHQyWVd4MVpUb2dkVzVrWldacGJtVmtMQ0JrYjI1bE9pQjBjblZsZlR0Y2JpQWdjRzlwYm5RZ1BTQWtZWFFvVHl3Z2FXNWtaWGdwTzF4dUlDQjBhR2x6TGw5cElDczlJSEJ2YVc1MExteGxibWQwYUR0Y2JpQWdjbVYwZFhKdUlIdDJZV3gxWlRvZ2NHOXBiblFzSUdSdmJtVTZJR1poYkhObGZUdGNibjBwTzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWxjell1YzNSeWFXNW5MbWwwWlhKaGRHOXlMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0ExTUZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpY21WeGRXbHlaU2duTGk5bGN6WXVZWEp5WVhrdWFYUmxjbUYwYjNJbktUdGNiblpoY2lCbmJHOWlZV3dnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZloyeHZZbUZzSnlsY2JpQWdMQ0JvYVdSbElDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYUdsa1pTY3BYRzRnSUN3Z1NYUmxjbUYwYjNKeklDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgybDBaWEpoZEc5eWN5Y3BYRzRnSUN3Z1ZFOWZVMVJTU1U1SFgxUkJSeUE5SUhKbGNYVnBjbVVvSnk0dlgzZHJjeWNwS0NkMGIxTjBjbWx1WjFSaFp5Y3BPMXh1WEc1bWIzSW9kbUZ5SUdOdmJHeGxZM1JwYjI1eklEMGdXeWRPYjJSbFRHbHpkQ2NzSUNkRVQwMVViMnRsYmt4cGMzUW5MQ0FuVFdWa2FXRk1hWE4wSnl3Z0oxTjBlV3hsVTJobFpYUk1hWE4wSnl3Z0owTlRVMUoxYkdWTWFYTjBKMTBzSUdrZ1BTQXdPeUJwSUR3Z05Uc2dhU3NyS1h0Y2JpQWdkbUZ5SUU1QlRVVWdJQ0FnSUNBZ1BTQmpiMnhzWldOMGFXOXVjMXRwWFZ4dUlDQWdJQ3dnUTI5c2JHVmpkR2x2YmlBOUlHZHNiMkpoYkZ0T1FVMUZYVnh1SUNBZ0lDd2djSEp2ZEc4Z0lDQWdJQ0E5SUVOdmJHeGxZM1JwYjI0Z0ppWWdRMjlzYkdWamRHbHZiaTV3Y205MGIzUjVjR1U3WEc0Z0lHbG1LSEJ5YjNSdklDWW1JQ0Z3Y205MGIxdFVUMTlUVkZKSlRrZGZWRUZIWFNsb2FXUmxLSEJ5YjNSdkxDQlVUMTlUVkZKSlRrZGZWRUZITENCT1FVMUZLVHRjYmlBZ1NYUmxjbUYwYjNKelcwNUJUVVZkSUQwZ1NYUmxjbUYwYjNKekxrRnljbUY1TzF4dWZWeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTkzWldJdVpHOXRMbWwwWlhKaFlteGxMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0ExTVZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpZG1GeUlHTnZjbVVnSUQwZ2NtVnhkV2x5WlNnbkxpNHZMaTR2Ylc5a2RXeGxjeTlmWTI5eVpTY3BYRzRnSUN3Z0pFcFRUMDRnUFNCamIzSmxMa3BUVDA0Z2ZId2dLR052Y21VdVNsTlBUaUE5SUh0emRISnBibWRwWm5rNklFcFRUMDR1YzNSeWFXNW5hV1o1ZlNrN1hHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUlITjBjbWx1WjJsbWVTaHBkQ2w3SUM4dklHVnpiR2x1ZEMxa2FYTmhZbXhsTFd4cGJtVWdibTh0ZFc1MWMyVmtMWFpoY25OY2JpQWdjbVYwZFhKdUlDUktVMDlPTG5OMGNtbHVaMmxtZVM1aGNIQnNlU2drU2xOUFRpd2dZWEpuZFcxbGJuUnpLVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzltYmk5cWMyOXVMM04wY21sdVoybG1lUzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTlROY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0EySWl3aUx5OGdaMlYwZEdsdVp5QjBZV2NnWm5KdmJTQXhPUzR4TGpNdU5pQlBZbXBsWTNRdWNISnZkRzkwZVhCbExuUnZVM1J5YVc1bktDbGNiblpoY2lCamIyWWdQU0J5WlhGMWFYSmxLQ2N1TDE5amIyWW5LVnh1SUNBc0lGUkJSeUE5SUhKbGNYVnBjbVVvSnk0dlgzZHJjeWNwS0NkMGIxTjBjbWx1WjFSaFp5Y3BYRzRnSUM4dklFVlRNeUIzY205dVp5Qm9aWEpsWEc0Z0lDd2dRVkpISUQwZ1kyOW1LR1oxYm1OMGFXOXVLQ2w3SUhKbGRIVnliaUJoY21kMWJXVnVkSE03SUgwb0tTa2dQVDBnSjBGeVozVnRaVzUwY3ljN1hHNWNiaTh2SUdaaGJHeGlZV05ySUdadmNpQkpSVEV4SUZOamNtbHdkQ0JCWTJObGMzTWdSR1Z1YVdWa0lHVnljbTl5WEc1MllYSWdkSEo1UjJWMElEMGdablZ1WTNScGIyNG9hWFFzSUd0bGVTbDdYRzRnSUhSeWVTQjdYRzRnSUNBZ2NtVjBkWEp1SUdsMFcydGxlVjA3WEc0Z0lIMGdZMkYwWTJnb1pTbDdJQzhxSUdWdGNIUjVJQ292SUgxY2JuMDdYRzVjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRvYVhRcGUxeHVJQ0IyWVhJZ1R5d2dWQ3dnUWp0Y2JpQWdjbVYwZFhKdUlHbDBJRDA5UFNCMWJtUmxabWx1WldRZ1B5QW5WVzVrWldacGJtVmtKeUE2SUdsMElEMDlQU0J1ZFd4c0lEOGdKMDUxYkd3blhHNGdJQ0FnTHk4Z1FFQjBiMU4wY21sdVoxUmhaeUJqWVhObFhHNGdJQ0FnT2lCMGVYQmxiMllnS0ZRZ1BTQjBjbmxIWlhRb1R5QTlJRTlpYW1WamRDaHBkQ2tzSUZSQlJ5a3BJRDA5SUNkemRISnBibWNuSUQ4Z1ZGeHVJQ0FnSUM4dklHSjFhV3gwYVc1VVlXY2dZMkZ6WlZ4dUlDQWdJRG9nUVZKSElEOGdZMjltS0U4cFhHNGdJQ0FnTHk4Z1JWTXpJR0Z5WjNWdFpXNTBjeUJtWVd4c1ltRmphMXh1SUNBZ0lEb2dLRUlnUFNCamIyWW9UeWtwSUQwOUlDZFBZbXBsWTNRbklDWW1JSFI1Y0dWdlppQlBMbU5oYkd4bFpTQTlQU0FuWm5WdVkzUnBiMjRuSUQ4Z0owRnlaM1Z0Wlc1MGN5Y2dPaUJDTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJOc1lYTnpiMll1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURVMVhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURRZ05TSXNJaTh2SUdaaGJHeGlZV05ySUdadmNpQnViMjR0WVhKeVlYa3RiR2xyWlNCRlV6TWdZVzVrSUc1dmJpMWxiblZ0WlhKaFlteGxJRzlzWkNCV09DQnpkSEpwYm1kelhHNTJZWElnWTI5bUlEMGdjbVZ4ZFdseVpTZ25MaTlmWTI5bUp5azdYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJRTlpYW1WamRDZ25laWNwTG5CeWIzQmxjblI1U1hORmJuVnRaWEpoWW14bEtEQXBJRDhnVDJKcVpXTjBJRG9nWm5WdVkzUnBiMjRvYVhRcGUxeHVJQ0J5WlhSMWNtNGdZMjltS0dsMEtTQTlQU0FuVTNSeWFXNW5KeUEvSUdsMExuTndiR2wwS0NjbktTQTZJRTlpYW1WamRDaHBkQ2s3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYVc5aWFtVmpkQzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTlRaY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSW5aaGNpQndTVVVnSUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMXdhV1VuS1Z4dUlDQXNJR055WldGMFpVUmxjMk1nSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmY0hKdmNHVnlkSGt0WkdWell5Y3BYRzRnSUN3Z2RHOUpUMkpxWldOMElDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOTBieTFwYjJKcVpXTjBKeWxjYmlBZ0xDQjBiMUJ5YVcxcGRHbDJaU0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYM1J2TFhCeWFXMXBkR2wyWlNjcFhHNGdJQ3dnYUdGeklDQWdJQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5b1lYTW5LVnh1SUNBc0lFbEZPRjlFVDAxZlJFVkdTVTVGSUQwZ2NtVnhkV2x5WlNnbkxpOWZhV1U0TFdSdmJTMWtaV1pwYm1VbktWeHVJQ0FzSUdkUFVFUWdJQ0FnSUNBZ0lDQWdJRDBnVDJKcVpXTjBMbWRsZEU5M2JsQnliM0JsY25SNVJHVnpZM0pwY0hSdmNqdGNibHh1Wlhod2IzSjBjeTVtSUQwZ2NtVnhkV2x5WlNnbkxpOWZaR1Z6WTNKcGNIUnZjbk1uS1NBL0lHZFBVRVFnT2lCbWRXNWpkR2x2YmlCblpYUlBkMjVRY205d1pYSjBlVVJsYzJOeWFYQjBiM0lvVHl3Z1VDbDdYRzRnSUU4Z1BTQjBiMGxQWW1wbFkzUW9UeWs3WEc0Z0lGQWdQU0IwYjFCeWFXMXBkR2wyWlNoUUxDQjBjblZsS1R0Y2JpQWdhV1lvU1VVNFgwUlBUVjlFUlVaSlRrVXBkSEo1SUh0Y2JpQWdJQ0J5WlhSMWNtNGdaMDlRUkNoUExDQlFLVHRjYmlBZ2ZTQmpZWFJqYUNobEtYc2dMeW9nWlcxd2RIa2dLaThnZlZ4dUlDQnBaaWhvWVhNb1R5d2dVQ2twY21WMGRYSnVJR055WldGMFpVUmxjMk1vSVhCSlJTNW1MbU5oYkd3b1R5d2dVQ2tzSUU5YlVGMHBPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMjlpYW1WamRDMW5iM0JrTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBMU4xeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWlMQ0psZUhCdmNuUnpMbVlnUFNCUFltcGxZM1F1WjJWMFQzZHVVSEp2Y0dWeWRIbFRlVzFpYjJ4ek8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMV2R2Y0hNdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEVTRYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUlzSWx3aWRYTmxJSE4wY21samRGd2lPMXh1WEc1bGVIQnZjblJ6TGw5ZlpYTk5iMlIxYkdVZ1BTQjBjblZsTzF4dVhHNTJZWElnWDJsMFpYSmhkRzl5SUQwZ2NtVnhkV2x5WlNoY0lpNHVMMk52Y21VdGFuTXZjM2x0WW05c0wybDBaWEpoZEc5eVhDSXBPMXh1WEc1MllYSWdYMmwwWlhKaGRHOXlNaUE5SUY5cGJuUmxjbTl3VW1WeGRXbHlaVVJsWm1GMWJIUW9YMmwwWlhKaGRHOXlLVHRjYmx4dWRtRnlJRjl6ZVcxaWIyd2dQU0J5WlhGMWFYSmxLRndpTGk0dlkyOXlaUzFxY3k5emVXMWliMnhjSWlrN1hHNWNiblpoY2lCZmMzbHRZbTlzTWlBOUlGOXBiblJsY205d1VtVnhkV2x5WlVSbFptRjFiSFFvWDNONWJXSnZiQ2s3WEc1Y2JuWmhjaUJmZEhsd1pXOW1JRDBnZEhsd1pXOW1JRjl6ZVcxaWIyd3lMbVJsWm1GMWJIUWdQVDA5SUZ3aVpuVnVZM1JwYjI1Y0lpQW1KaUIwZVhCbGIyWWdYMmwwWlhKaGRHOXlNaTVrWldaaGRXeDBJRDA5UFNCY0luTjViV0p2YkZ3aUlEOGdablZ1WTNScGIyNGdLRzlpYWlrZ2V5QnlaWFIxY200Z2RIbHdaVzltSUc5aWFqc2dmU0E2SUdaMWJtTjBhVzl1SUNodlltb3BJSHNnY21WMGRYSnVJRzlpYWlBbUppQjBlWEJsYjJZZ1gzTjViV0p2YkRJdVpHVm1ZWFZzZENBOVBUMGdYQ0ptZFc1amRHbHZibHdpSUNZbUlHOWlhaTVqYjI1emRISjFZM1J2Y2lBOVBUMGdYM041YldKdmJESXVaR1ZtWVhWc2RDQW1KaUJ2WW1vZ0lUMDlJRjl6ZVcxaWIyd3lMbVJsWm1GMWJIUXVjSEp2ZEc5MGVYQmxJRDhnWENKemVXMWliMnhjSWlBNklIUjVjR1Z2WmlCdlltbzdJSDA3WEc1Y2JtWjFibU4wYVc5dUlGOXBiblJsY205d1VtVnhkV2x5WlVSbFptRjFiSFFvYjJKcUtTQjdJSEpsZEhWeWJpQnZZbW9nSmlZZ2IySnFMbDlmWlhOTmIyUjFiR1VnUHlCdlltb2dPaUI3SUdSbFptRjFiSFE2SUc5aWFpQjlPeUI5WEc1Y2JtVjRjRzl5ZEhNdVpHVm1ZWFZzZENBOUlIUjVjR1Z2WmlCZmMzbHRZbTlzTWk1a1pXWmhkV3gwSUQwOVBTQmNJbVoxYm1OMGFXOXVYQ0lnSmlZZ1gzUjVjR1Z2WmloZmFYUmxjbUYwYjNJeUxtUmxabUYxYkhRcElEMDlQU0JjSW5ONWJXSnZiRndpSUQ4Z1puVnVZM1JwYjI0Z0tHOWlhaWtnZTF4dUlDQnlaWFIxY200Z2RIbHdaVzltSUc5aWFpQTlQVDBnWENKMWJtUmxabWx1WldSY0lpQS9JRndpZFc1a1pXWnBibVZrWENJZ09pQmZkSGx3Wlc5bUtHOWlhaWs3WEc1OUlEb2dablZ1WTNScGIyNGdLRzlpYWlrZ2UxeHVJQ0J5WlhSMWNtNGdiMkpxSUNZbUlIUjVjR1Z2WmlCZmMzbHRZbTlzTWk1a1pXWmhkV3gwSUQwOVBTQmNJbVoxYm1OMGFXOXVYQ0lnSmlZZ2IySnFMbU52Ym5OMGNuVmpkRzl5SUQwOVBTQmZjM2x0WW05c01pNWtaV1poZFd4MElDWW1JRzlpYWlBaFBUMGdYM041YldKdmJESXVaR1ZtWVhWc2RDNXdjbTkwYjNSNWNHVWdQeUJjSW5ONWJXSnZiRndpSURvZ2RIbHdaVzltSUc5aWFpQTlQVDBnWENKMWJtUmxabWx1WldSY0lpQS9JRndpZFc1a1pXWnBibVZrWENJZ09pQmZkSGx3Wlc5bUtHOWlhaWs3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMmhsYkhCbGNuTXZkSGx3Wlc5bUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTFPVnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENKdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0NsN0lDOHFJR1Z0Y0hSNUlDb3ZJSDA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWhaR1F0ZEc4dGRXNXpZMjl3WVdKc1pYTXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRFl3WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWlMQ0l2THlCbVlXeHpaU0F0UGlCQmNuSmhlU05wYm1SbGVFOW1YRzR2THlCMGNuVmxJQ0F0UGlCQmNuSmhlU05wYm1Oc2RXUmxjMXh1ZG1GeUlIUnZTVTlpYW1WamRDQTlJSEpsY1hWcGNtVW9KeTR2WDNSdkxXbHZZbXBsWTNRbktWeHVJQ0FzSUhSdlRHVnVaM1JvSUNBOUlISmxjWFZwY21Vb0p5NHZYM1J2TFd4bGJtZDBhQ2NwWEc0Z0lDd2dkRzlKYm1SbGVDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmRHOHRhVzVrWlhnbktUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9TVk5mU1U1RFRGVkVSVk1wZTF4dUlDQnlaWFIxY200Z1puVnVZM1JwYjI0b0pIUm9hWE1zSUdWc0xDQm1jbTl0U1c1a1pYZ3BlMXh1SUNBZ0lIWmhjaUJQSUNBZ0lDQWdQU0IwYjBsUFltcGxZM1FvSkhSb2FYTXBYRzRnSUNBZ0lDQXNJR3hsYm1kMGFDQTlJSFJ2VEdWdVozUm9LRTh1YkdWdVozUm9LVnh1SUNBZ0lDQWdMQ0JwYm1SbGVDQWdQU0IwYjBsdVpHVjRLR1p5YjIxSmJtUmxlQ3dnYkdWdVozUm9LVnh1SUNBZ0lDQWdMQ0IyWVd4MVpUdGNiaUFnSUNBdkx5QkJjbkpoZVNOcGJtTnNkV1JsY3lCMWMyVnpJRk5oYldWV1lXeDFaVnBsY204Z1pYRjFZV3hwZEhrZ1lXeG5iM0pwZEdodFhHNGdJQ0FnYVdZb1NWTmZTVTVEVEZWRVJWTWdKaVlnWld3Z0lUMGdaV3dwZDJocGJHVW9iR1Z1WjNSb0lENGdhVzVrWlhncGUxeHVJQ0FnSUNBZ2RtRnNkV1VnUFNCUFcybHVaR1Y0S3l0ZE8xeHVJQ0FnSUNBZ2FXWW9kbUZzZFdVZ0lUMGdkbUZzZFdVcGNtVjBkWEp1SUhSeWRXVTdYRzRnSUNBZ0x5OGdRWEp5WVhramRHOUpibVJsZUNCcFoyNXZjbVZ6SUdodmJHVnpMQ0JCY25KaGVTTnBibU5zZFdSbGN5QXRJRzV2ZEZ4dUlDQWdJSDBnWld4elpTQm1iM0lvTzJ4bGJtZDBhQ0ErSUdsdVpHVjRPeUJwYm1SbGVDc3JLV2xtS0VsVFgwbE9RMHhWUkVWVElIeDhJR2x1WkdWNElHbHVJRThwZTF4dUlDQWdJQ0FnYVdZb1QxdHBibVJsZUYwZ1BUMDlJR1ZzS1hKbGRIVnliaUJKVTE5SlRrTk1WVVJGVXlCOGZDQnBibVJsZUNCOGZDQXdPMXh1SUNBZ0lIMGdjbVYwZFhKdUlDRkpVMTlKVGtOTVZVUkZVeUFtSmlBdE1UdGNiaUFnZlR0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5aGNuSmhlUzFwYm1Oc2RXUmxjeTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTmpGY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSWlkMWMyVWdjM1J5YVdOMEp6dGNiblpoY2lCamNtVmhkR1VnSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxamNtVmhkR1VuS1Z4dUlDQXNJR1JsYzJOeWFYQjBiM0lnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmY0hKdmNHVnlkSGt0WkdWell5Y3BYRzRnSUN3Z2MyVjBWRzlUZEhKcGJtZFVZV2NnUFNCeVpYRjFhWEpsS0NjdUwxOXpaWFF0ZEc4dGMzUnlhVzVuTFhSaFp5Y3BYRzRnSUN3Z1NYUmxjbUYwYjNKUWNtOTBiM1I1Y0dVZ1BTQjdmVHRjYmx4dUx5OGdNalV1TVM0eUxqRXVNU0FsU1hSbGNtRjBiM0pRY205MGIzUjVjR1VsVzBCQWFYUmxjbUYwYjNKZEtDbGNibkpsY1hWcGNtVW9KeTR2WDJocFpHVW5LU2hKZEdWeVlYUnZjbEJ5YjNSdmRIbHdaU3dnY21WeGRXbHlaU2duTGk5ZmQydHpKeWtvSjJsMFpYSmhkRzl5Snlrc0lHWjFibU4wYVc5dUtDbDdJSEpsZEhWeWJpQjBhR2x6T3lCOUtUdGNibHh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhEYjI1emRISjFZM1J2Y2l3Z1RrRk5SU3dnYm1WNGRDbDdYRzRnSUVOdmJuTjBjblZqZEc5eUxuQnliM1J2ZEhsd1pTQTlJR055WldGMFpTaEpkR1Z5WVhSdmNsQnliM1J2ZEhsd1pTd2dlMjVsZUhRNklHUmxjMk55YVhCMGIzSW9NU3dnYm1WNGRDbDlLVHRjYmlBZ2MyVjBWRzlUZEhKcGJtZFVZV2NvUTI5dWMzUnlkV04wYjNJc0lFNUJUVVVnS3lBbklFbDBaWEpoZEc5eUp5azdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhWFJsY2kxamNtVmhkR1V1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURZeVhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVpTENKdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0dSdmJtVXNJSFpoYkhWbEtYdGNiaUFnY21WMGRYSnVJSHQyWVd4MVpUb2dkbUZzZFdVc0lHUnZibVU2SUNFaFpHOXVaWDA3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYVhSbGNpMXpkR1Z3TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBMk0xeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSWl3aWRtRnlJR1JRSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmIySnFaV04wTFdSd0p5bGNiaUFnTENCaGJrOWlhbVZqZENBOUlISmxjWFZwY21Vb0p5NHZYMkZ1TFc5aWFtVmpkQ2NwWEc0Z0lDd2daMlYwUzJWNWN5QWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0YTJWNWN5Y3BPMXh1WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhKbGNYVnBjbVVvSnk0dlgyUmxjMk55YVhCMGIzSnpKeWtnUHlCUFltcGxZM1F1WkdWbWFXNWxVSEp2Y0dWeWRHbGxjeUE2SUdaMWJtTjBhVzl1SUdSbFptbHVaVkJ5YjNCbGNuUnBaWE1vVHl3Z1VISnZjR1Z5ZEdsbGN5bDdYRzRnSUdGdVQySnFaV04wS0U4cE8xeHVJQ0IyWVhJZ2EyVjVjeUFnSUQwZ1oyVjBTMlY1Y3loUWNtOXdaWEowYVdWektWeHVJQ0FnSUN3Z2JHVnVaM1JvSUQwZ2EyVjVjeTVzWlc1bmRHaGNiaUFnSUNBc0lHa2dQU0F3WEc0Z0lDQWdMQ0JRTzF4dUlDQjNhR2xzWlNoc1pXNW5kR2dnUGlCcEtXUlFMbVlvVHl3Z1VDQTlJR3RsZVhOYmFTc3JYU3dnVUhKdmNHVnlkR2xsYzF0UVhTazdYRzRnSUhKbGRIVnliaUJQTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDI5aWFtVmpkQzFrY0hNdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEWTBYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSXZMeUF4T1M0eExqSXVOeUF2SURFMUxqSXVNeTQwSUU5aWFtVmpkQzVuWlhSUGQyNVFjbTl3WlhKMGVVNWhiV1Z6S0U4cFhHNTJZWElnSkd0bGVYTWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMXJaWGx6TFdsdWRHVnlibUZzSnlsY2JpQWdMQ0JvYVdSa1pXNUxaWGx6SUQwZ2NtVnhkV2x5WlNnbkxpOWZaVzUxYlMxaWRXY3RhMlY1Y3ljcExtTnZibU5oZENnbmJHVnVaM1JvSnl3Z0ozQnliM1J2ZEhsd1pTY3BPMXh1WEc1bGVIQnZjblJ6TG1ZZ1BTQlBZbXBsWTNRdVoyVjBUM2R1VUhKdmNHVnlkSGxPWVcxbGN5QjhmQ0JtZFc1amRHbHZiaUJuWlhSUGQyNVFjbTl3WlhKMGVVNWhiV1Z6S0U4cGUxeHVJQ0J5WlhSMWNtNGdKR3RsZVhNb1R5d2dhR2xrWkdWdVMyVjVjeWs3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMV2R2Y0c0dWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEWTFYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUlzSW5aaGNpQjBiMGx1ZEdWblpYSWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXBiblJsWjJWeUp5bGNiaUFnTENCa1pXWnBibVZrSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlrWldacGJtVmtKeWs3WEc0dkx5QjBjblZsSUNBdFBpQlRkSEpwYm1jallYUmNiaTh2SUdaaGJITmxJQzArSUZOMGNtbHVaeU5qYjJSbFVHOXBiblJCZEZ4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCbWRXNWpkR2x2YmloVVQxOVRWRkpKVGtjcGUxeHVJQ0J5WlhSMWNtNGdablZ1WTNScGIyNG9kR2hoZEN3Z2NHOXpLWHRjYmlBZ0lDQjJZWElnY3lBOUlGTjBjbWx1Wnloa1pXWnBibVZrS0hSb1lYUXBLVnh1SUNBZ0lDQWdMQ0JwSUQwZ2RHOUpiblJsWjJWeUtIQnZjeWxjYmlBZ0lDQWdJQ3dnYkNBOUlITXViR1Z1WjNSb1hHNGdJQ0FnSUNBc0lHRXNJR0k3WEc0Z0lDQWdhV1lvYVNBOElEQWdmSHdnYVNBK1BTQnNLWEpsZEhWeWJpQlVUMTlUVkZKSlRrY2dQeUFuSnlBNklIVnVaR1ZtYVc1bFpEdGNiaUFnSUNCaElEMGdjeTVqYUdGeVEyOWtaVUYwS0drcE8xeHVJQ0FnSUhKbGRIVnliaUJoSUR3Z01IaGtPREF3SUh4OElHRWdQaUF3ZUdSaVptWWdmSHdnYVNBcklERWdQVDA5SUd3Z2ZId2dLR0lnUFNCekxtTm9ZWEpEYjJSbFFYUW9hU0FySURFcEtTQThJREI0WkdNd01DQjhmQ0JpSUQ0Z01IaGtabVptWEc0Z0lDQWdJQ0EvSUZSUFgxTlVVa2xPUnlBL0lITXVZMmhoY2tGMEtHa3BJRG9nWVZ4dUlDQWdJQ0FnT2lCVVQxOVRWRkpKVGtjZ1B5QnpMbk5zYVdObEtHa3NJR2tnS3lBeUtTQTZJQ2hoSUMwZ01IaGtPREF3SUR3OElERXdLU0FySUNoaUlDMGdNSGhrWXpBd0tTQXJJREI0TVRBd01EQTdYRzRnSUgwN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmMzUnlhVzVuTFdGMExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTJObHh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlpd2lkbUZ5SUdOMGVDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMk4wZUNjcFhHNGdJQ3dnYVc1MmIydGxJQ0FnSUNBZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZhVzUyYjJ0bEp5bGNiaUFnTENCb2RHMXNJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlvZEcxc0p5bGNiaUFnTENCalpXd2dJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlrYjIwdFkzSmxZWFJsSnlsY2JpQWdMQ0JuYkc5aVlXd2dJQ0FnSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOW5iRzlpWVd3bktWeHVJQ0FzSUhCeWIyTmxjM01nSUNBZ0lDQWdJQ0FnSUNBOUlHZHNiMkpoYkM1d2NtOWpaWE56WEc0Z0lDd2djMlYwVkdGemF5QWdJQ0FnSUNBZ0lDQWdJRDBnWjJ4dlltRnNMbk5sZEVsdGJXVmthV0YwWlZ4dUlDQXNJR05zWldGeVZHRnpheUFnSUNBZ0lDQWdJQ0E5SUdkc2IySmhiQzVqYkdWaGNrbHRiV1ZrYVdGMFpWeHVJQ0FzSUUxbGMzTmhaMlZEYUdGdWJtVnNJQ0FnSUNBOUlHZHNiMkpoYkM1TlpYTnpZV2RsUTJoaGJtNWxiRnh1SUNBc0lHTnZkVzUwWlhJZ0lDQWdJQ0FnSUNBZ0lDQTlJREJjYmlBZ0xDQnhkV1YxWlNBZ0lDQWdJQ0FnSUNBZ0lDQWdQU0I3ZlZ4dUlDQXNJRTlPVWtWQlJGbFRWRUZVUlVOSVFVNUhSU0E5SUNkdmJuSmxZV1I1YzNSaGRHVmphR0Z1WjJVblhHNGdJQ3dnWkdWbVpYSXNJR05vWVc1dVpXd3NJSEJ2Y25RN1hHNTJZWElnY25WdUlEMGdablZ1WTNScGIyNG9LWHRjYmlBZ2RtRnlJR2xrSUQwZ0szUm9hWE03WEc0Z0lHbG1LSEYxWlhWbExtaGhjMDkzYmxCeWIzQmxjblI1S0dsa0tTbDdYRzRnSUNBZ2RtRnlJR1p1SUQwZ2NYVmxkV1ZiYVdSZE8xeHVJQ0FnSUdSbGJHVjBaU0J4ZFdWMVpWdHBaRjA3WEc0Z0lDQWdabTRvS1R0Y2JpQWdmVnh1ZlR0Y2JuWmhjaUJzYVhOMFpXNWxjaUE5SUdaMWJtTjBhVzl1S0dWMlpXNTBLWHRjYmlBZ2NuVnVMbU5oYkd3b1pYWmxiblF1WkdGMFlTazdYRzU5TzF4dUx5OGdUbTlrWlM1cWN5QXdMamtySUNZZ1NVVXhNQ3NnYUdGeklITmxkRWx0YldWa2FXRjBaU3dnYjNSb1pYSjNhWE5sT2x4dWFXWW9JWE5sZEZSaGMyc2dmSHdnSVdOc1pXRnlWR0Z6YXlsN1hHNGdJSE5sZEZSaGMyc2dQU0JtZFc1amRHbHZiaUJ6WlhSSmJXMWxaR2xoZEdVb1ptNHBlMXh1SUNBZ0lIWmhjaUJoY21keklEMGdXMTBzSUdrZ1BTQXhPMXh1SUNBZ0lIZG9hV3hsS0dGeVozVnRaVzUwY3k1c1pXNW5kR2dnUGlCcEtXRnlaM011Y0hWemFDaGhjbWQxYldWdWRITmJhU3NyWFNrN1hHNGdJQ0FnY1hWbGRXVmJLeXRqYjNWdWRHVnlYU0E5SUdaMWJtTjBhVzl1S0NsN1hHNGdJQ0FnSUNCcGJuWnZhMlVvZEhsd1pXOW1JR1p1SUQwOUlDZG1kVzVqZEdsdmJpY2dQeUJtYmlBNklFWjFibU4wYVc5dUtHWnVLU3dnWVhKbmN5azdYRzRnSUNBZ2ZUdGNiaUFnSUNCa1pXWmxjaWhqYjNWdWRHVnlLVHRjYmlBZ0lDQnlaWFIxY200Z1kyOTFiblJsY2p0Y2JpQWdmVHRjYmlBZ1kyeGxZWEpVWVhOcklEMGdablZ1WTNScGIyNGdZMnhsWVhKSmJXMWxaR2xoZEdVb2FXUXBlMXh1SUNBZ0lHUmxiR1YwWlNCeGRXVjFaVnRwWkYwN1hHNGdJSDA3WEc0Z0lDOHZJRTV2WkdVdWFuTWdNQzQ0TFZ4dUlDQnBaaWh5WlhGMWFYSmxLQ2N1TDE5amIyWW5LU2h3Y205alpYTnpLU0E5UFNBbmNISnZZMlZ6Y3ljcGUxeHVJQ0FnSUdSbFptVnlJRDBnWm5WdVkzUnBiMjRvYVdRcGUxeHVJQ0FnSUNBZ2NISnZZMlZ6Y3k1dVpYaDBWR2xqYXloamRIZ29jblZ1TENCcFpDd2dNU2twTzF4dUlDQWdJSDA3WEc0Z0lDOHZJRUp5YjNkelpYSnpJSGRwZEdnZ1RXVnpjMkZuWlVOb1lXNXVaV3dzSUdsdVkyeDFaR1Z6SUZkbFlsZHZjbXRsY25OY2JpQWdmU0JsYkhObElHbG1LRTFsYzNOaFoyVkRhR0Z1Ym1Wc0tYdGNiaUFnSUNCamFHRnVibVZzSUQwZ2JtVjNJRTFsYzNOaFoyVkRhR0Z1Ym1Wc08xeHVJQ0FnSUhCdmNuUWdJQ0FnUFNCamFHRnVibVZzTG5CdmNuUXlPMXh1SUNBZ0lHTm9ZVzV1Wld3dWNHOXlkREV1YjI1dFpYTnpZV2RsSUQwZ2JHbHpkR1Z1WlhJN1hHNGdJQ0FnWkdWbVpYSWdQU0JqZEhnb2NHOXlkQzV3YjNOMFRXVnpjMkZuWlN3Z2NHOXlkQ3dnTVNrN1hHNGdJQzh2SUVKeWIzZHpaWEp6SUhkcGRHZ2djRzl6ZEUxbGMzTmhaMlVzSUhOcmFYQWdWMlZpVjI5eWEyVnljMXh1SUNBdkx5QkpSVGdnYUdGeklIQnZjM1JOWlhOellXZGxMQ0JpZFhRZ2FYUW5jeUJ6ZVc1aklDWWdkSGx3Wlc5bUlHbDBjeUJ3YjNOMFRXVnpjMkZuWlNCcGN5QW5iMkpxWldOMEoxeHVJQ0I5SUdWc2MyVWdhV1lvWjJ4dlltRnNMbUZrWkVWMlpXNTBUR2x6ZEdWdVpYSWdKaVlnZEhsd1pXOW1JSEJ2YzNSTlpYTnpZV2RsSUQwOUlDZG1kVzVqZEdsdmJpY2dKaVlnSVdkc2IySmhiQzVwYlhCdmNuUlRZM0pwY0hSektYdGNiaUFnSUNCa1pXWmxjaUE5SUdaMWJtTjBhVzl1S0dsa0tYdGNiaUFnSUNBZ0lHZHNiMkpoYkM1d2IzTjBUV1Z6YzJGblpTaHBaQ0FySUNjbkxDQW5LaWNwTzF4dUlDQWdJSDA3WEc0Z0lDQWdaMnh2WW1Gc0xtRmtaRVYyWlc1MFRHbHpkR1Z1WlhJb0oyMWxjM05oWjJVbkxDQnNhWE4wWlc1bGNpd2dabUZzYzJVcE8xeHVJQ0F2THlCSlJUZ3RYRzRnSUgwZ1pXeHpaU0JwWmloUFRsSkZRVVJaVTFSQlZFVkRTRUZPUjBVZ2FXNGdZMlZzS0NkelkzSnBjSFFuS1NsN1hHNGdJQ0FnWkdWbVpYSWdQU0JtZFc1amRHbHZiaWhwWkNsN1hHNGdJQ0FnSUNCb2RHMXNMbUZ3Y0dWdVpFTm9hV3hrS0dObGJDZ25jMk55YVhCMEp5a3BXMDlPVWtWQlJGbFRWRUZVUlVOSVFVNUhSVjBnUFNCbWRXNWpkR2x2YmlncGUxeHVJQ0FnSUNBZ0lDQm9kRzFzTG5KbGJXOTJaVU5vYVd4a0tIUm9hWE1wTzF4dUlDQWdJQ0FnSUNCeWRXNHVZMkZzYkNocFpDazdYRzRnSUNBZ0lDQjlPMXh1SUNBZ0lIMDdYRzRnSUM4dklGSmxjM1FnYjJ4a0lHSnliM2R6WlhKelhHNGdJSDBnWld4elpTQjdYRzRnSUNBZ1pHVm1aWElnUFNCbWRXNWpkR2x2YmlocFpDbDdYRzRnSUNBZ0lDQnpaWFJVYVcxbGIzVjBLR04wZUNoeWRXNHNJR2xrTENBeEtTd2dNQ2s3WEc0Z0lDQWdmVHRjYmlBZ2ZWeHVmVnh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0I3WEc0Z0lITmxkRG9nSUNCelpYUlVZWE5yTEZ4dUlDQmpiR1ZoY2pvZ1kyeGxZWEpVWVhOclhHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmRHRnpheTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTmpkY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTkNBMUlpd2lkbUZ5SUhSdlNXNTBaV2RsY2lBOUlISmxjWFZwY21Vb0p5NHZYM1J2TFdsdWRHVm5aWEluS1Z4dUlDQXNJRzFoZUNBZ0lDQWdJQ0E5SUUxaGRHZ3ViV0Y0WEc0Z0lDd2diV2x1SUNBZ0lDQWdJRDBnVFdGMGFDNXRhVzQ3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0dsdVpHVjRMQ0JzWlc1bmRHZ3BlMXh1SUNCcGJtUmxlQ0E5SUhSdlNXNTBaV2RsY2locGJtUmxlQ2s3WEc0Z0lISmxkSFZ5YmlCcGJtUmxlQ0E4SURBZ1B5QnRZWGdvYVc1a1pYZ2dLeUJzWlc1bmRHZ3NJREFwSURvZ2JXbHVLR2x1WkdWNExDQnNaVzVuZEdncE8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzUnZMV2x1WkdWNExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTJPRnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlpd2lKM1Z6WlNCemRISnBZM1FuTzF4dWRtRnlJR0ZrWkZSdlZXNXpZMjl3WVdKc1pYTWdQU0J5WlhGMWFYSmxLQ2N1TDE5aFpHUXRkRzh0ZFc1elkyOXdZV0pzWlhNbktWeHVJQ0FzSUhOMFpYQWdJQ0FnSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXBkR1Z5TFhOMFpYQW5LVnh1SUNBc0lFbDBaWEpoZEc5eWN5QWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlwZEdWeVlYUnZjbk1uS1Z4dUlDQXNJSFJ2U1U5aWFtVmpkQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXBiMkpxWldOMEp5azdYRzVjYmk4dklESXlMakV1TXk0MElFRnljbUY1TG5CeWIzUnZkSGx3WlM1bGJuUnlhV1Z6S0NsY2JpOHZJREl5TGpFdU15NHhNeUJCY25KaGVTNXdjbTkwYjNSNWNHVXVhMlY1Y3lncFhHNHZMeUF5TWk0eExqTXVNamtnUVhKeVlYa3VjSEp2ZEc5MGVYQmxMblpoYkhWbGN5Z3BYRzR2THlBeU1pNHhMak11TXpBZ1FYSnlZWGt1Y0hKdmRHOTBlWEJsVzBCQWFYUmxjbUYwYjNKZEtDbGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdjbVZ4ZFdseVpTZ25MaTlmYVhSbGNpMWtaV1pwYm1VbktTaEJjbkpoZVN3Z0owRnljbUY1Snl3Z1puVnVZM1JwYjI0b2FYUmxjbUYwWldRc0lHdHBibVFwZTF4dUlDQjBhR2x6TGw5MElEMGdkRzlKVDJKcVpXTjBLR2wwWlhKaGRHVmtLVHNnTHk4Z2RHRnlaMlYwWEc0Z0lIUm9hWE11WDJrZ1BTQXdPeUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0F2THlCdVpYaDBJR2x1WkdWNFhHNGdJSFJvYVhNdVgyc2dQU0JyYVc1a095QWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBdkx5QnJhVzVrWEc0dkx5QXlNaTR4TGpVdU1pNHhJQ1ZCY25KaGVVbDBaWEpoZEc5eVVISnZkRzkwZVhCbEpTNXVaWGgwS0NsY2JuMHNJR1oxYm1OMGFXOXVLQ2w3WEc0Z0lIWmhjaUJQSUNBZ0lDQTlJSFJvYVhNdVgzUmNiaUFnSUNBc0lHdHBibVFnSUQwZ2RHaHBjeTVmYTF4dUlDQWdJQ3dnYVc1a1pYZ2dQU0IwYUdsekxsOXBLeXM3WEc0Z0lHbG1LQ0ZQSUh4OElHbHVaR1Y0SUQ0OUlFOHViR1Z1WjNSb0tYdGNiaUFnSUNCMGFHbHpMbDkwSUQwZ2RXNWtaV1pwYm1Wa08xeHVJQ0FnSUhKbGRIVnliaUJ6ZEdWd0tERXBPMXh1SUNCOVhHNGdJR2xtS0d0cGJtUWdQVDBnSjJ0bGVYTW5JQ0FwY21WMGRYSnVJSE4wWlhBb01Dd2dhVzVrWlhncE8xeHVJQ0JwWmlocmFXNWtJRDA5SUNkMllXeDFaWE1uS1hKbGRIVnliaUJ6ZEdWd0tEQXNJRTliYVc1a1pYaGRLVHRjYmlBZ2NtVjBkWEp1SUhOMFpYQW9NQ3dnVzJsdVpHVjRMQ0JQVzJsdVpHVjRYVjBwTzF4dWZTd2dKM1poYkhWbGN5Y3BPMXh1WEc0dkx5QmhjbWQxYldWdWRITk1hWE4wVzBCQWFYUmxjbUYwYjNKZElHbHpJQ1ZCY25KaGVWQnliM1J2WDNaaGJIVmxjeVVnS0RrdU5DNDBMallzSURrdU5DNDBMamNwWEc1SmRHVnlZWFJ2Y25NdVFYSm5kVzFsYm5SeklEMGdTWFJsY21GMGIzSnpMa0Z5Y21GNU8xeHVYRzVoWkdSVWIxVnVjMk52Y0dGaWJHVnpLQ2RyWlhsekp5azdYRzVoWkdSVWIxVnVjMk52Y0dGaWJHVnpLQ2QyWVd4MVpYTW5LVHRjYm1Ga1pGUnZWVzV6WTI5d1lXSnNaWE1vSjJWdWRISnBaWE1uS1R0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZaWE0yTG1GeWNtRjVMbWwwWlhKaGRHOXlMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0EyT1Z4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpYlc5a2RXeGxMbVY0Y0c5eWRITWdQU0I3SUZ3aVpHVm1ZWFZzZEZ3aU9pQnlaWEYxYVhKbEtGd2lZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMjlpYW1WamRDOXJaWGx6WENJcExDQmZYMlZ6VFc5a2RXeGxPaUIwY25WbElIMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wySmhZbVZzTFhKMWJuUnBiV1V2WTI5eVpTMXFjeTl2WW1wbFkzUXZhMlY1Y3k1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ056QmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURJZ05DQTFJaXdpTHlvcVhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklGQlVJRWx1YjNaaHc2ZkRvMjhnWlNCVGFYTjBaVzFoY3lCVFFWeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQkpUa1ZUUXkxSlJGeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQlJWVTlDU1ZNZ1RrVlVWMDlTUzFNZ1UweGNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdSbEpCVlU1SVQwWkZVaTFIUlZORlRFeFRRMGhCUmxRZ1dsVlNJRVpQUlZKRVJWSlZUa2NnUkVWU0lFRk9SMFZYUVU1RVZFVk9JRVpQVWxORFNGVk9SeUJGTGxaY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1QxSkJUa2RGSUZOQlhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklFUmxkWFJ6WTJobElGUmxiR1ZyYjIwZ1FVZGNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdRWEJwZW1WbFhHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklGUkZRMGhPU1ZORFNFVWdWVTVKVmtWU1UwbFVRVlFnUWtWU1RFbE9YRzRxWEc0cUlFeHBZMlZ1YzJWa0lIVnVaR1Z5SUhSb1pTQkJjR0ZqYUdVZ1RHbGpaVzV6WlN3Z1ZtVnljMmx2YmlBeUxqQWdLSFJvWlNCY0lreHBZMlZ1YzJWY0lpazdYRzRxSUhsdmRTQnRZWGtnYm05MElIVnpaU0IwYUdseklHWnBiR1VnWlhoalpYQjBJR2x1SUdOdmJYQnNhV0Z1WTJVZ2QybDBhQ0IwYUdVZ1RHbGpaVzV6WlM1Y2Jpb2dXVzkxSUcxaGVTQnZZblJoYVc0Z1lTQmpiM0I1SUc5bUlIUm9aU0JNYVdObGJuTmxJR0YwWEc0cVhHNHFJQ0FnYUhSMGNEb3ZMM2QzZHk1aGNHRmphR1V1YjNKbkwyeHBZMlZ1YzJWekwweEpRMFZPVTBVdE1pNHdYRzRxWEc0cUlGVnViR1Z6Y3lCeVpYRjFhWEpsWkNCaWVTQmhjSEJzYVdOaFlteGxJR3hoZHlCdmNpQmhaM0psWldRZ2RHOGdhVzRnZDNKcGRHbHVaeXdnYzI5bWRIZGhjbVZjYmlvZ1pHbHpkSEpwWW5WMFpXUWdkVzVrWlhJZ2RHaGxJRXhwWTJWdWMyVWdhWE1nWkdsemRISnBZblYwWldRZ2IyNGdZVzRnWENKQlV5QkpVMXdpSUVKQlUwbFRMRnh1S2lCWFNWUklUMVZVSUZkQlVsSkJUbFJKUlZNZ1QxSWdRMDlPUkVsVVNVOU9VeUJQUmlCQlRsa2dTMGxPUkN3Z1pXbDBhR1Z5SUdWNGNISmxjM01nYjNJZ2FXMXdiR2xsWkM1Y2Jpb2dVMlZsSUhSb1pTQk1hV05sYm5ObElHWnZjaUIwYUdVZ2MzQmxZMmxtYVdNZ2JHRnVaM1ZoWjJVZ1oyOTJaWEp1YVc1bklIQmxjbTFwYzNOcGIyNXpJR0Z1WkZ4dUtpQnNhVzFwZEdGMGFXOXVjeUIxYm1SbGNpQjBhR1VnVEdsalpXNXpaUzVjYmlvcUwxeHVMeW9xWEc0Z0tpQlRkWEJ3YjNKMElHMXZaSFZzWlNCM2FYUm9JSE52YldVZ1puVnVZM1JwYjI1eklIZHBiR3dnWW1VZ2RYTmxablZzWEc0Z0tpQkFiVzlrZFd4bElIVjBhV3h6WEc0Z0tpOWNibHh1THlvcVhHNGdLaUJBZEhsd1pXUmxaaUJrYVhacFpHVlZVa3hjYmlBcUlFQjBlWEJsSUU5aWFtVmpkRnh1SUNvZ1FIQnliM0JsY25SNUlIdHpkSEpwYm1kOUlIUjVjR1VnVkdobElIUjVjR1VnYjJZZ1ZWSk1YRzRnS2lCQWNISnZjR1Z5ZEhrZ2UzTjBjbWx1WjMwZ1pHOXRZV2x1SUZSb1pTQmtiMjFoYVc0Z2IyWWdWVkpNWEc0Z0tpQkFjSEp2Y0dWeWRIa2dlM04wY21sdVozMGdhV1JsYm5ScGRIa2dWR2hsSUdsa1pXNTBhWFI1SUc5bUlGVlNURnh1SUNvdlhHNWNiaThxS2x4dUlDb2dSR2wyYVdSbElHRnVJSFZ5YkNCcGJpQjBlWEJsTENCa2IyMWhhVzRnWVc1a0lHbGtaVzUwYVhSNVhHNGdLaUJBY0dGeVlXMGdJSHRWVWt3dVZWSk1mU0IxY213Z0xTQjFjbXdnWVdSa2NtVnpjMXh1SUNvZ1FISmxkSFZ5YmlCN1pHbDJhV1JsVlZKTWZTQjBhR1VnY21WemRXeDBJRzltSUdScGRtbGtaVlZTVEZ4dUlDb3ZYRzVsZUhCdmNuUWdablZ1WTNScGIyNGdaR2wyYVdSbFZWSk1LSFZ5YkNrZ2UxeHVYRzRnSUdsbUlDZ2hkWEpzS1NCMGFISnZkeUJGY25KdmNpZ25WVkpNSUdseklHNWxaV1JsWkNCMGJ5QnpjR3hwZENjcE8xeHVYRzVjZEdaMWJtTjBhVzl1SUhKbFkzVnljMlVvZG1Gc2RXVXBJSHRjYmx4MFhIUmpiMjV6ZENCeVpXZGxlQ0E5SUM4b1cyRXRla0V0V2kxZEtpa29PbHhjTDF4Y0x5Zy9PbHhjTGlrL2ZEb3BLRnN0WVMxNlFTMWFNQzA1UURvbExsOWNYQ3QrSXoxZGV6SXNNalUyZlNrb1d5MWhMWHBCTFZvd0xUbEFPaVV1WDF4Y0szNGpQVnhjTDEwcUtTOW5hVHRjYmlBZ0lDQmpiMjV6ZENCemRXSnpkQ0E5SUNja01Td2tNeXdrTkNjN1hHNWNkQ0FnYkdWMElIQmhjblJ6SUQwZ2RtRnNkV1V1Y21Wd2JHRmpaU2h5WldkbGVDd2djM1ZpYzNRcExuTndiR2wwS0Njc0p5azdYRzVjZEZ4MGNtVjBkWEp1SUhCaGNuUnpPMXh1WEhSOVhHNWNibHgwYkdWMElIQmhjblJ6SUQwZ2NtVmpkWEp6WlNoMWNtd3BPMXh1WEc0Z0lDOHZJRWxtSUhSb1pTQjFjbXdnYUdGeklHNXZJSE5qYUdWdFpWeHVJQ0JwWmlBb2NHRnlkSE5iTUYwZ1BUMDlJSFZ5YkNBbUppQWhjR0Z5ZEhOYk1GMHVhVzVqYkhWa1pYTW9KMEFuS1NrZ2UxeHVYRzRnSUNBZ2JHVjBJSEpsYzNWc2RDQTlJSHRjYmlBZ0lDQWdJSFI1Y0dVNklGd2lYQ0lzWEc0Z0lDQWdJQ0JrYjIxaGFXNDZJSFZ5YkN4Y2JpQWdJQ0FnSUdsa1pXNTBhWFI1T2lCY0lsd2lYRzRnSUNBZ2ZUdGNibHh1SUNBZ0lHTnZibk52YkdVdVpYSnliM0lvSjF0RWFYWnBaR1ZWVWt4ZElFUnBkbWxrWlZWU1RDQmtiMjVjWENkMElITjFjSEJ2Y25RZ2RYSnNJSGRwZEdodmRYUWdjMk5vWlcxbExpQlFiR1ZoYzJVZ2NtVjJhV1YzSUhsdmRYSWdkWEpzSUdGa1pISmxjM01uTENCMWNtd3BPMXh1WEc0Z0lDQWdjbVYwZFhKdUlISmxjM1ZzZER0Y2JpQWdmVnh1WEc1Y2RDOHZJR05vWldOcklHbG1JSFJvWlNCMWNtd2dhR0Z6SUhSb1pTQnpZMmhsYldVZ1lXNWtJR2x1WTJ4MVpHVnpJR0Z1SUVCY2JseDBhV1lnS0hCaGNuUnpXekJkSUQwOVBTQjFjbXdnSmlZZ2NHRnlkSE5iTUYwdWFXNWpiSFZrWlhNb0owQW5LU2tnZTF4dVhIUmNkR3hsZENCelkyaGxiV1VnUFNCd1lYSjBjMXN3WFNBOVBUMGdkWEpzSUQ4Z0ozTnRkSEFuSURvZ2NHRnlkSE5iTUYwN1hHNWNkRngwY0dGeWRITWdQU0J5WldOMWNuTmxLSE5qYUdWdFpTQXJJQ2M2THk4bklDc2djR0Z5ZEhOYk1GMHBPMXh1WEhSOVhHNWNibHgwTHk4Z2FXWWdkR2hsSUdSdmJXRnBiaUJwYm1Oc2RXUmxjeUJoYmlCQUxDQmthWFpwWkdVZ2FYUWdkRzhnWkc5dFlXbHVJR0Z1WkNCcFpHVnVkR2wwZVNCeVpYTndaV04wYVhabGJIbGNibHgwYVdZZ0tIQmhjblJ6V3pGZExtbHVZMngxWkdWektDZEFKeWtwSUh0Y2JseDBYSFJ3WVhKMGMxc3lYU0E5SUhCaGNuUnpXekJkSUNzZ0p6b3ZMeWNnS3lCd1lYSjBjMXN4WFR0Y2JseDBYSFJ3WVhKMGMxc3hYU0E5SUhCaGNuUnpXekZkTG5OMVluTjBjaWh3WVhKMGMxc3hYUzVwYm1SbGVFOW1LQ2RBSnlrZ0t5QXhLVnh1SUNBZ0lIMGdYSFF2S21Wc2MyVWdhV1lnS0hCaGNuUnpXekpkTG1sdVkyeDFaR1Z6S0Njdkp5a3BJSHRjYmlBZ0lDQndZWEowYzFzeVhTQTlJSEJoY25Seld6SmRMbk4xWW5OMGNpaHdZWEowYzFzeVhTNXNZWE4wU1c1a1pYaFBaaWduTHljcEt6RXBPMXh1SUNCOUtpOWNibHh1SUNCc1pYUWdjbVZ6ZFd4MElEMGdlMXh1SUNBZ0lIUjVjR1U2SUhCaGNuUnpXekJkTEZ4dUlDQWdJR1J2YldGcGJqb2djR0Z5ZEhOYk1WMHNYRzRnSUNBZ2FXUmxiblJwZEhrNklIQmhjblJ6V3pKZFhHNGdJSDA3WEc1Y2JpQWdjbVYwZFhKdUlISmxjM1ZzZER0Y2JuMWNibHh1Wlhod2IzSjBJR1oxYm1OMGFXOXVJR1JwZG1sa1pVVnRZV2xzS0dWdFlXbHNLU0I3WEc0Z0lHeGxkQ0JwYm1SbGVFOW1RWFFnUFNCbGJXRnBiQzVwYm1SbGVFOW1LQ2RBSnlrN1hHNWNiaUFnYkdWMElISmxjM1ZzZENBOUlIdGNiaUFnSUNCMWMyVnlibUZ0WlRvZ1pXMWhhV3d1YzNWaWMzUnlhVzVuS0RBc0lHbHVaR1Y0VDJaQmRDa3NYRzRnSUNBZ1pHOXRZV2x1T2lCbGJXRnBiQzV6ZFdKemRISnBibWNvYVc1a1pYaFBaa0YwSUNzZ01Td2daVzFoYVd3dWJHVnVaM1JvS1Z4dUlDQjlPMXh1WEc0Z0lISmxkSFZ5YmlCeVpYTjFiSFE3WEc1OVhHNWNiaThxS2x4dUlDb2dRMmhsWTJzZ2FXWWdZVzRnVDJKcVpXTjBJR2x6SUdWdGNIUjVYRzRnS2lCQWNHRnlZVzBnSUh0UFltcGxZM1I5SUc5aWFtVmpkQ0JQWW1wbFkzUWdkRzhnWW1VZ1kyaGxZMnRsWkZ4dUlDb2dRSEpsZEhWeWJpQjdRbTl2YkdWaGJuMGdJQ0FnSUNBZ2MzUmhkSFZ6SUc5bUlFOWlhbVZqZEN3Z1pXMXdkSGtnYjNJZ2JtOTBJQ2gwY25WbGZHWmhiSE5sS1R0Y2JpQXFMMXh1Wlhod2IzSjBJR1oxYm1OMGFXOXVJR1Z0Y0hSNVQySnFaV04wS0c5aWFtVmpkQ2tnZTF4dUlDQnlaWFIxY200Z1QySnFaV04wTG10bGVYTW9iMkpxWldOMEtTNXNaVzVuZEdnZ1BpQXdJRDhnWm1Gc2MyVWdPaUIwY25WbE8xeHVmVnh1WEc0dktpcGNiaUFxSUUxaGEyVWdZU0JEVDFCWklHOW1JSFJvWlNCdmNtbG5hVzVoYkNCa1lYUmhYRzRnS2lCQWNHRnlZVzBnSUh0UFltcGxZM1I5SUNCdlltb2dMU0J2WW1wbFkzUWdkRzhnWW1VZ1kyeHZibVZrWEc0Z0tpQkFjbVYwZFhKdUlIdFBZbXBsWTNSOVhHNGdLaTljYm1WNGNHOXlkQ0JtZFc1amRHbHZiaUJrWldWd1EyeHZibVVvYjJKcUtTQjdYRzRnSUM4dlZFOUVUem9nYzJsdGNHeGxJR0oxZENCcGJtVm1abWxqYVdWdWRDQktVMDlPSUdSbFpYQWdZMnh2Ym1VdUxpNWNiaUFnYVdZZ0tHOWlhaWtnY21WMGRYSnVJRXBUVDA0dWNHRnljMlVvU2xOUFRpNXpkSEpwYm1kcFpua29iMkpxS1NrN1hHNTlYRzVjYmk4cUtseHVJQ29nVDJKMFlXbHVjeUIwYUdVZ2RYTmxjaUJWVWt3Z2RHaGhkQ0JqYjNKeVpYTndiMjVrY3lCMGJ5QmhJR2RwZG1WdUlHVnRZV2xzWEc0Z0tpQkFjR0Z5WVcwZ0lIdHpkSEpwYm1kOUlIVnpaWEpGYldGcGJDQlVhR1VnZFhObGNpQmxiV0ZwYkZ4dUlDb2dRSEpsZEhWeWJpQjdWVkpNTGxWU1RIMGdkWE5sY2xWU1RDQlVhR1VnZFhObGNpQlZVa3hjYmlBcUwxeHVaWGh3YjNKMElHWjFibU4wYVc5dUlHZGxkRlZ6WlhKVlVreEdjbTl0UlcxaGFXd29kWE5sY2tWdFlXbHNLU0I3WEc0Z0lHeGxkQ0JwYm1SbGVFOW1RWFFnUFNCMWMyVnlSVzFoYVd3dWFXNWtaWGhQWmlnblFDY3BPMXh1SUNCeVpYUjFjbTRnSjNWelpYSTZMeThuSUNzZ2RYTmxja1Z0WVdsc0xuTjFZbk4wY21sdVp5aHBibVJsZUU5bVFYUWdLeUF4TENCMWMyVnlSVzFoYVd3dWJHVnVaM1JvS1NBcklDY3ZKeUFySUhWelpYSkZiV0ZwYkM1emRXSnpkSEpwYm1jb01Dd2dhVzVrWlhoUFprRjBLVHRjYm4xY2JseHVMeW9xWEc0Z0tpQlBZblJoYVc1eklIUm9aU0IxYzJWeUlHVnRZV2xzSUhSb1lYUWdZMjl5Y21WemNHOXVaSE1nZEc4Z1lTQm5hWFpsYmlCVlVreGNiaUFxSUVCd1lYSmhiU0FnZTFWU1RDNVZVa3g5SUhWelpYSlZVa3dnVkdobElIVnpaWElnVlZKTVhHNGdLaUJBY21WMGRYSnVJSHR6ZEhKcGJtZDlJSFZ6WlhKRmJXRnBiQ0JVYUdVZ2RYTmxjaUJsYldGcGJGeHVJQ292WEc1bGVIQnZjblFnWm5WdVkzUnBiMjRnWjJWMFZYTmxja1Z0WVdsc1JuSnZiVlZTVENoMWMyVnlWVkpNS1NCN1hHNGdJR3hsZENCMWNtd2dQU0JrYVhacFpHVlZVa3dvZFhObGNsVlNUQ2s3WEc0Z0lISmxkSFZ5YmlCMWNtd3VhV1JsYm5ScGRIa3VjbVZ3YkdGalpTZ25MeWNzSUNjbktTQXJJQ2RBSnlBcklIVnliQzVrYjIxaGFXNDdJQzh2SUdsa1pXNTBhWFI1SUdacFpXeGtJR2hoY3lBbkwyVjRZVzF3YkdWSlJDY2dhVzV6ZEdWaFpDQnZaaUFuWlhoaGJYQnNaVWxFSjF4dWZWeHVYRzVjYmk4cUtseHVJQ29nUTJobFkyc2dhV1lnZEdobElIVnpaWElnYVdSbGJuUnBabWxsY2lCcGN5QmhiSEpsWVdSNUlHbHVJSFJvWlNCVlVrd2dabTl5YldGMExDQnBaaUJ1YjNRc0lHTnZiblpsY25RZ2RHOGdWVkpNSUdadmNtMWhkRnh1SUNvZ1FIQmhjbUZ0SUNCN2MzUnlhVzVuZlNBZ0lHbGtaVzUwYVdacFpYSWdJSFZ6WlhJZ2FXUmxiblJwWm1sbGNseHVJQ29nUUhKbGRIVnliaUI3YzNSeWFXNW5mU0FnSUhWelpYSlZVa3dnSUNBZ2RHaGxJSFZ6WlhJZ1ZWSk1YRzRnS2k5Y2JtVjRjRzl5ZENCbWRXNWpkR2x2YmlCamIyNTJaWEowVkc5VmMyVnlWVkpNS0dsa1pXNTBhV1pwWlhJcElIdGNibHh1SUNBdkx5QmphR1ZqYXlCcFppQjBhR1VnYVdSbGJuUnBabWxsY2lCcGN5QmhiSEpsWVdSNUlHbHVJSFJvWlNCMWNtd2dabTl5YldGMFhHNGdJR2xtSUNocFpHVnVkR2xtYVdWeUxuTjFZbk4wY21sdVp5Z3dMQ0EzS1NBOVBUMGdKM1Z6WlhJNkx5OG5LU0I3WEc0Z0lDQWdiR1YwSUdScGRtbGtaV1JWVWt3Z1BTQmthWFpwWkdWVlVrd29hV1JsYm5ScFptbGxjaWs3WEc1Y2JpQWdJQ0F2TDJOb1pXTnJJR2xtSUhSb1pTQjFjbXdnYVhNZ2QyVnNiQ0JtYjNKdFlYUmxaRnh1SUNBZ0lHbG1JQ2hrYVhacFpHVmtWVkpNTG1SdmJXRnBiaUFtSmlCa2FYWnBaR1ZrVlZKTUxtbGtaVzUwYVhSNUtTQjdYRzRnSUNBZ0lDQnlaWFIxY200Z2FXUmxiblJwWm1sbGNqdGNiaUFnSUNCOUlHVnNjMlVnZTF4dUlDQWdJQ0FnZEdoeWIzY2dKM1Z6WlhKVlVrd2dkMmwwYUNCM2NtOXVaeUJtYjNKdFlYUW5PMXh1SUNBZ0lIMWNibHh1SUNBdkwybG1JRzV2ZEN3Z1kyOXVkbVZ5ZENCMGFHVWdkWE5sY2lCbGJXRnBiQ0IwYnlCVlVrd2dabTl5YldGMFhHNGdJSDBnWld4elpTQjdYRzRnSUNBZ2NtVjBkWEp1SUdkbGRGVnpaWEpWVWt4R2NtOXRSVzFoYVd3b2FXUmxiblJwWm1sbGNpazdYRzRnSUgxY2JuMWNibHh1Wlhod2IzSjBJR1oxYm1OMGFXOXVJR05vWldOclFYUjBjbWxpZFhSbEtIQmhkR2dwSUh0Y2JseHVJQ0JzWlhRZ2NtVm5aWGdnUFNBdktDZ29XMkV0ZWtFdFdsMHJLVHBjWEM5Y1hDOG9XekF0T1dFdGVrRXRXbDFiTFZ4Y2QxMHFXekF0T1dFdGVrRXRXbDFjWEM0cEsxdGhMWHBCTFZwZGV6SXNPWDBwWEZ3dlcyRXRla0V0V2pBdE9WeGNMbDByUUZ0aExYcEJMVm93TFRsZEt5aGNYQzBwUDF0aExYcEJMVm93TFRsZEt5aGNYQzRwUDF0aExYcEJMVm93TFRsZGV6SXNNVEI5UDF4Y0xsdGhMWHBCTFZwZGV6SXNNVEI5S1NndUt5Zy9QUzVwWkdWdWRHbDBlU2twUHk5bmJUdGNibHh1SUNCc1pYUWdiR2x6ZENBOUlGdGRPMXh1SUNCc1pYUWdabWx1WVd3Z1BTQmJYVHRjYmlBZ2JHVjBJSFJsYzNRZ1BTQndZWFJvTG0xaGRHTm9LSEpsWjJWNEtUdGNibHh1SUNCcFppQW9kR1Z6ZENBOVBTQnVkV3hzS1NCN1hHNGdJQ0FnWm1sdVlXd2dQU0J3WVhSb0xuTndiR2wwS0NjdUp5azdYRzRnSUgwZ1pXeHpaU0I3WEc0Z0lDQWdiR1YwSUcwN1hHNGdJQ0FnZDJocGJHVWdLQ2h0SUQwZ2NtVm5aWGd1WlhobFl5aHdZWFJvS1NrZ0lUMDlJRzUxYkd3cElIdGNiaUFnSUNBZ0lDOHZJRlJvYVhNZ2FYTWdibVZqWlhOellYSjVJSFJ2SUdGMmIybGtJR2x1Wm1sdWFYUmxJR3h2YjNCeklIZHBkR2dnZW1WeWJ5MTNhV1IwYUNCdFlYUmphR1Z6WEc0Z0lDQWdJQ0JwWmlBb2JTNXBibVJsZUNBOVBUMGdjbVZuWlhndWJHRnpkRWx1WkdWNEtTQjdYRzRnSUNBZ0lDQWdJSEpsWjJWNExteGhjM1JKYm1SbGVDc3JPMXh1SUNBZ0lDQWdmVnh1WEc0Z0lDQWdJQ0F2THlCVWFHVWdjbVZ6ZFd4MElHTmhiaUJpWlNCaFkyTmxjM05sWkNCMGFISnZkV2RvSUhSb1pTQmdiV0F0ZG1GeWFXRmliR1V1WEc0Z0lDQWdJQ0J0TG1admNrVmhZMmdvS0cxaGRHTm9MQ0JuY205MWNFbHVaR1Y0S1NBOVBpQjdYRzRnSUNBZ0lDQWdJR2xtSUNobmNtOTFjRWx1WkdWNElEMDlQU0F3S1NCN1hHNGdJQ0FnSUNBZ0lDQWdiR2x6ZEM1d2RYTm9LRzFoZEdOb0tUdGNiaUFnSUNBZ0lDQWdmVnh1SUNBZ0lDQWdmU2s3WEc0Z0lDQWdmVnh1SUNBZ0lHeGxkQ0J5WlhOMWJIUTdYRzRnSUNBZ2JHbHpkQzVtYjNKRllXTm9LQ2gxY213cElEMCtJSHRjYmlBZ0lDQWdJSEpsYzNWc2RDQTlJSEJoZEdndWNtVndiR0ZqWlNoMWNtd3NJQ2NxS3lvbktUdGNibHh1SUNBZ0lDQWdabWx1WVd3Z1BTQnlaWE4xYkhRdWMzQnNhWFFvSnk0bktTNXRZWEFvS0dsMFpXMHBJRDArSUh0Y2JpQWdJQ0FnSUNBZ2FXWWdLR2wwWlcwZ1BUMDlJQ2NxS3lvbktTQjdJSEpsZEhWeWJpQjFjbXc3SUgxY2JpQWdJQ0FnSUNBZ2NtVjBkWEp1SUdsMFpXMDdYRzRnSUNBZ0lDQjlLVHRjYmx4dUlDQWdJSDBwTzF4dUlDQjlYRzVjYmlBZ1kyOXVjMjlzWlM1c2IyY29KMXRUWlhKMmFXTmxSbkpoYldWM2IzSnJMbFYwYVd4ekxtTm9aV05yUVhSMGNtbGlkWFJsWFNjc0lHWnBibUZzS1R0Y2JpQWdjbVYwZFhKdUlHWnBibUZzTzF4dWZWeHVYRzVsZUhCdmNuUWdablZ1WTNScGIyNGdjR0Z5YzJWQmRIUnlhV0oxZEdWektIQmhkR2dwSUh0Y2JpQWdiR1YwSUhKbFoyVjRJRDBnTHloYk1DMDVZUzE2UVMxYVhWc3RYRngzWFNvcE9seGNMMXhjTHk5bk8xeHVYRzRnSUd4bGRDQnpkSEpwYm1jeklEMGdKMmxrWlc1MGFYUjVKenRjYmx4dUlDQnBaaUFvSVhCaGRHZ3VhVzVqYkhWa1pYTW9Kem92THljcEtTQjdYRzRnSUNBZ2NtVjBkWEp1SUNod1lYUm9Mbk53YkdsMEtDY3VKeWtwTzF4dUlDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUd4bGRDQnpkSEpwYm1jeElEMGdjR0YwYUM1emNHeHBkQ2h5WldkbGVDbGJNRjA3WEc1Y2JpQWdJQ0JzWlhRZ1lYSnlZWGt4SUQwZ2MzUnlhVzVuTVM1emNHeHBkQ2duTGljcE8xeHVYRzRnSUNBZ2JHVjBJSE4wY21sdVp6SWdQU0J3WVhSb0xuSmxjR3hoWTJVb2MzUnlhVzVuTVN3Z0p5Y3BPMXh1WEc0Z0lDQWdhV1lnS0hCaGRHZ3VhVzVqYkhWa1pYTW9jM1J5YVc1bk15a3BJSHRjYmx4dUlDQWdJQ0FnYkdWMElHRnljbUY1TWlBOUlITjBjbWx1WnpJdWMzQnNhWFFvYzNSeWFXNW5NeUFySUNjdUp5azdYRzVjYmlBZ0lDQWdJR052Ym5OdmJHVXViRzluS0NkaGNuSmhlVElnSnlBcklHRnljbUY1TWlrN1hHNWNiaUFnSUNBZ0lITjBjbWx1WnpJZ1BTQmhjbkpoZVRKYk1GMHVjMnhwWTJVb0p5NG5MQ0F0TVNrN1hHNWNiaUFnSUNBZ0lHRnljbUY1TWlBOUlHRnljbUY1TWxzeFhTNXpjR3hwZENnbkxpY3BPMXh1WEc0Z0lDQWdJQ0JoY25KaGVURXVjSFZ6YUNoemRISnBibWN5TENCemRISnBibWN6S1R0Y2JseHVJQ0FnSUNBZ1lYSnlZWGt4SUQwZ1lYSnlZWGt4TG1OdmJtTmhkQ2hoY25KaGVUSXBPMXh1WEc0Z0lDQWdmU0JsYkhObElIdGNiaUFnSUNBZ0lHRnljbUY1TVM1d2RYTm9LSE4wY21sdVp6SXBPMXh1WEc0Z0lDQWdmVnh1WEc0Z0lDQWdjbVYwZFhKdUlDaGhjbkpoZVRFdVptbHNkR1Z5S0VKdmIyeGxZVzRwS1R0Y2JseHVJQ0I5WEc1OVhHNWNibHh1WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWlBdkwxeHVMeThnTGk5emNtTXZkWFJwYkhNdmRYUnBiSE11YW5NaUxDSnRiMlIxYkdVdVpYaHdiM0owY3lBOUlIc2dYQ0prWldaaGRXeDBYQ0k2SUhKbGNYVnBjbVVvWENKamIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmNISnZiV2x6WlZ3aUtTd2dYMTlsYzAxdlpIVnNaVG9nZEhKMVpTQjlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJOdmNtVXRhbk12Y0hKdmJXbHpaUzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTnpKY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTkNBMUlpd2lkbUZ5SUUxRlZFRWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZkV2xrSnlrb0oyMWxkR0VuS1Z4dUlDQXNJR2x6VDJKcVpXTjBJRDBnY21WeGRXbHlaU2duTGk5ZmFYTXRiMkpxWldOMEp5bGNiaUFnTENCb1lYTWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMmhoY3ljcFhHNGdJQ3dnYzJWMFJHVnpZeUFnUFNCeVpYRjFhWEpsS0NjdUwxOXZZbXBsWTNRdFpIQW5LUzVtWEc0Z0lDd2dhV1FnSUNBZ0lDQWdQU0F3TzF4dWRtRnlJR2x6UlhoMFpXNXphV0pzWlNBOUlFOWlhbVZqZEM1cGMwVjRkR1Z1YzJsaWJHVWdmSHdnWm5WdVkzUnBiMjRvS1h0Y2JpQWdjbVYwZFhKdUlIUnlkV1U3WEc1OU8xeHVkbUZ5SUVaU1JVVmFSU0E5SUNGeVpYRjFhWEpsS0NjdUwxOW1ZV2xzY3ljcEtHWjFibU4wYVc5dUtDbDdYRzRnSUhKbGRIVnliaUJwYzBWNGRHVnVjMmxpYkdVb1QySnFaV04wTG5CeVpYWmxiblJGZUhSbGJuTnBiMjV6S0h0OUtTazdYRzU5S1R0Y2JuWmhjaUJ6WlhSTlpYUmhJRDBnWm5WdVkzUnBiMjRvYVhRcGUxeHVJQ0J6WlhSRVpYTmpLR2wwTENCTlJWUkJMQ0I3ZG1Gc2RXVTZJSHRjYmlBZ0lDQnBPaUFuVHljZ0t5QXJLMmxrTENBdkx5QnZZbXBsWTNRZ1NVUmNiaUFnSUNCM09pQjdmU0FnSUNBZ0lDQWdJQ0F2THlCM1pXRnJJR052Ykd4bFkzUnBiMjV6SUVsRWMxeHVJQ0I5ZlNrN1hHNTlPMXh1ZG1GeUlHWmhjM1JMWlhrZ1BTQm1kVzVqZEdsdmJpaHBkQ3dnWTNKbFlYUmxLWHRjYmlBZ0x5OGdjbVYwZFhKdUlIQnlhVzFwZEdsMlpTQjNhWFJvSUhCeVpXWnBlRnh1SUNCcFppZ2hhWE5QWW1wbFkzUW9hWFFwS1hKbGRIVnliaUIwZVhCbGIyWWdhWFFnUFQwZ0ozTjViV0p2YkNjZ1B5QnBkQ0E2SUNoMGVYQmxiMllnYVhRZ1BUMGdKM04wY21sdVp5Y2dQeUFuVXljZ09pQW5VQ2NwSUNzZ2FYUTdYRzRnSUdsbUtDRm9ZWE1vYVhRc0lFMUZWRUVwS1h0Y2JpQWdJQ0F2THlCallXNG5kQ0J6WlhRZ2JXVjBZV1JoZEdFZ2RHOGdkVzVqWVhWbmFIUWdabkp2ZW1WdUlHOWlhbVZqZEZ4dUlDQWdJR2xtS0NGcGMwVjRkR1Z1YzJsaWJHVW9hWFFwS1hKbGRIVnliaUFuUmljN1hHNGdJQ0FnTHk4Z2JtOTBJRzVsWTJWemMyRnllU0IwYnlCaFpHUWdiV1YwWVdSaGRHRmNiaUFnSUNCcFppZ2hZM0psWVhSbEtYSmxkSFZ5YmlBblJTYzdYRzRnSUNBZ0x5OGdZV1JrSUcxcGMzTnBibWNnYldWMFlXUmhkR0ZjYmlBZ0lDQnpaWFJOWlhSaEtHbDBLVHRjYmlBZ0x5OGdjbVYwZFhKdUlHOWlhbVZqZENCSlJGeHVJQ0I5SUhKbGRIVnliaUJwZEZ0TlJWUkJYUzVwTzF4dWZUdGNiblpoY2lCblpYUlhaV0ZySUQwZ1puVnVZM1JwYjI0b2FYUXNJR055WldGMFpTbDdYRzRnSUdsbUtDRm9ZWE1vYVhRc0lFMUZWRUVwS1h0Y2JpQWdJQ0F2THlCallXNG5kQ0J6WlhRZ2JXVjBZV1JoZEdFZ2RHOGdkVzVqWVhWbmFIUWdabkp2ZW1WdUlHOWlhbVZqZEZ4dUlDQWdJR2xtS0NGcGMwVjRkR1Z1YzJsaWJHVW9hWFFwS1hKbGRIVnliaUIwY25WbE8xeHVJQ0FnSUM4dklHNXZkQ0J1WldObGMzTmhjbmtnZEc4Z1lXUmtJRzFsZEdGa1lYUmhYRzRnSUNBZ2FXWW9JV055WldGMFpTbHlaWFIxY200Z1ptRnNjMlU3WEc0Z0lDQWdMeThnWVdSa0lHMXBjM05wYm1jZ2JXVjBZV1JoZEdGY2JpQWdJQ0J6WlhSTlpYUmhLR2wwS1R0Y2JpQWdMeThnY21WMGRYSnVJR2hoYzJnZ2QyVmhheUJqYjJ4c1pXTjBhVzl1Y3lCSlJITmNiaUFnZlNCeVpYUjFjbTRnYVhSYlRVVlVRVjB1ZHp0Y2JuMDdYRzR2THlCaFpHUWdiV1YwWVdSaGRHRWdiMjRnWm5KbFpYcGxMV1poYldsc2VTQnRaWFJvYjJSeklHTmhiR3hwYm1kY2JuWmhjaUJ2YmtaeVpXVjZaU0E5SUdaMWJtTjBhVzl1S0dsMEtYdGNiaUFnYVdZb1JsSkZSVnBGSUNZbUlHMWxkR0V1VGtWRlJDQW1KaUJwYzBWNGRHVnVjMmxpYkdVb2FYUXBJQ1ltSUNGb1lYTW9hWFFzSUUxRlZFRXBLWE5sZEUxbGRHRW9hWFFwTzF4dUlDQnlaWFIxY200Z2FYUTdYRzU5TzF4dWRtRnlJRzFsZEdFZ1BTQnRiMlIxYkdVdVpYaHdiM0owY3lBOUlIdGNiaUFnUzBWWk9pQWdJQ0FnSUUxRlZFRXNYRzRnSUU1RlJVUTZJQ0FnSUNCbVlXeHpaU3hjYmlBZ1ptRnpkRXRsZVRvZ0lHWmhjM1JMWlhrc1hHNGdJR2RsZEZkbFlXczZJQ0JuWlhSWFpXRnJMRnh1SUNCdmJrWnlaV1Y2WlRvZ2IyNUdjbVZsZW1WY2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5dFpYUmhMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0EzTTF4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNaUxDSjJZWElnWTJ4aGMzTnZaaUFnSUQwZ2NtVnhkV2x5WlNnbkxpOWZZMnhoYzNOdlppY3BYRzRnSUN3Z1NWUkZVa0ZVVDFJZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZDJ0ekp5a29KMmwwWlhKaGRHOXlKeWxjYmlBZ0xDQkpkR1Z5WVhSdmNuTWdQU0J5WlhGMWFYSmxLQ2N1TDE5cGRHVnlZWFJ2Y25NbktUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdjbVZ4ZFdseVpTZ25MaTlmWTI5eVpTY3BMbWRsZEVsMFpYSmhkRzl5VFdWMGFHOWtJRDBnWm5WdVkzUnBiMjRvYVhRcGUxeHVJQ0JwWmlocGRDQWhQU0IxYm1SbFptbHVaV1FwY21WMGRYSnVJR2wwVzBsVVJWSkJWRTlTWFZ4dUlDQWdJSHg4SUdsMFd5ZEFRR2wwWlhKaGRHOXlKMTFjYmlBZ0lDQjhmQ0JKZEdWeVlYUnZjbk5iWTJ4aGMzTnZaaWhwZENsZE8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlkyOXlaUzVuWlhRdGFYUmxjbUYwYjNJdGJXVjBhRzlrTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBM05GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBMElEVWlMQ0p0YjJSMWJHVXVaWGh3YjNKMGN5QTlJSHNnWENKa1pXWmhkV3gwWENJNklISmxjWFZwY21Vb1hDSmpiM0psTFdwekwyeHBZbkpoY25rdlptNHZiMkpxWldOMEwyTnlaV0YwWlZ3aUtTd2dYMTlsYzAxdlpIVnNaVG9nZEhKMVpTQjlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJOdmNtVXRhbk12YjJKcVpXTjBMMk55WldGMFpTNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdOelZjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SWl3aWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCN0lGd2laR1ZtWVhWc2RGd2lPaUJ5WlhGMWFYSmxLRndpWTI5eVpTMXFjeTlzYVdKeVlYSjVMMlp1TDI5aWFtVmpkQzl6WlhRdGNISnZkRzkwZVhCbExXOW1YQ0lwTENCZlgyVnpUVzlrZFd4bE9pQjBjblZsSUgwN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJKaFltVnNMWEoxYm5ScGJXVXZZMjl5WlMxcWN5OXZZbXBsWTNRdmMyVjBMWEJ5YjNSdmRIbHdaUzF2Wmk1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ056WmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJaXdpYlc5a2RXeGxMbVY0Y0c5eWRITWdQU0I3SUZ3aVpHVm1ZWFZzZEZ3aU9pQnlaWEYxYVhKbEtGd2lZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMM041YldKdmJGd2lLU3dnWDE5bGMwMXZaSFZzWlRvZ2RISjFaU0I5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlpWVdKbGJDMXlkVzUwYVcxbEwyTnZjbVV0YW5NdmMzbHRZbTlzTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBM04xeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWlMQ0p0YjJSMWJHVXVaWGh3YjNKMGN5QTlJSHNnWENKa1pXWmhkV3gwWENJNklISmxjWFZwY21Vb1hDSmpiM0psTFdwekwyeHBZbkpoY25rdlptNHZjM2x0WW05c0wybDBaWEpoZEc5eVhDSXBMQ0JmWDJWelRXOWtkV3hsT2lCMGNuVmxJSDA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMkpoWW1Wc0xYSjFiblJwYldVdlkyOXlaUzFxY3k5emVXMWliMnd2YVhSbGNtRjBiM0l1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURjNFhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015SXNJbkpsY1hWcGNtVW9KeTR1THk0dUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNWpjbVZoZEdVbktUdGNiblpoY2lBa1QySnFaV04wSUQwZ2NtVnhkV2x5WlNnbkxpNHZMaTR2Ylc5a2RXeGxjeTlmWTI5eVpTY3BMazlpYW1WamREdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNGdZM0psWVhSbEtGQXNJRVFwZTF4dUlDQnlaWFIxY200Z0pFOWlhbVZqZEM1amNtVmhkR1VvVUN3Z1JDazdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2YjJKcVpXTjBMMk55WldGMFpTNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdOemxjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SWl3aWNtVnhkV2x5WlNnbkxpNHZMaTR2Ylc5a2RXeGxjeTlsY3pZdWIySnFaV04wTG1kbGRDMXdjbTkwYjNSNWNHVXRiMlluS1R0Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ2NtVnhkV2x5WlNnbkxpNHZMaTR2Ylc5a2RXeGxjeTlmWTI5eVpTY3BMazlpYW1WamRDNW5aWFJRY205MGIzUjVjR1ZQWmp0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMlp1TDI5aWFtVmpkQzluWlhRdGNISnZkRzkwZVhCbExXOW1MbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0E0TUZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNaUxDSnlaWEYxYVhKbEtDY3VMaTh1TGk5dGIyUjFiR1Z6TDJWek5pNXZZbXBsWTNRdWEyVjVjeWNwTzF4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCeVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMTlqYjNKbEp5a3VUMkpxWldOMExtdGxlWE03WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOW1iaTl2WW1wbFkzUXZhMlY1Y3k1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ09ERmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURJZ05DQTFJaXdpY21WeGRXbHlaU2duTGk0dkxpNHZiVzlrZFd4bGN5OWxjell1YjJKcVpXTjBMbk5sZEMxd2NtOTBiM1I1Y0dVdGIyWW5LVHRjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnY21WeGRXbHlaU2duTGk0dkxpNHZiVzlrZFd4bGN5OWZZMjl5WlNjcExrOWlhbVZqZEM1elpYUlFjbTkwYjNSNWNHVlBaanRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMjlpYW1WamRDOXpaWFF0Y0hKdmRHOTBlWEJsTFc5bUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTRNbHh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENKeVpYRjFhWEpsS0NjdUxpOXRiMlIxYkdWekwyVnpOaTV2WW1wbFkzUXVkRzh0YzNSeWFXNW5KeWs3WEc1eVpYRjFhWEpsS0NjdUxpOXRiMlIxYkdWekwyVnpOaTV6ZEhKcGJtY3VhWFJsY21GMGIzSW5LVHRjYm5KbGNYVnBjbVVvSnk0dUwyMXZaSFZzWlhNdmQyVmlMbVJ2YlM1cGRHVnlZV0pzWlNjcE8xeHVjbVZ4ZFdseVpTZ25MaTR2Ylc5a2RXeGxjeTlsY3pZdWNISnZiV2x6WlNjcE8xeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQnlaWEYxYVhKbEtDY3VMaTl0YjJSMWJHVnpMMTlqYjNKbEp5a3VVSEp2YldselpUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwzQnliMjFwYzJVdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEZ3pYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElEUWdOU0lzSW5KbGNYVnBjbVVvSnk0dUx5NHVMMjF2WkhWc1pYTXZaWE0yTG5ONWJXSnZiQ2NwTzF4dWNtVnhkV2x5WlNnbkxpNHZMaTR2Ylc5a2RXeGxjeTlsY3pZdWIySnFaV04wTG5SdkxYTjBjbWx1WnljcE8xeHVjbVZ4ZFdseVpTZ25MaTR2TGk0dmJXOWtkV3hsY3k5bGN6Y3VjM2x0WW05c0xtRnplVzVqTFdsMFpYSmhkRzl5SnlrN1hHNXlaWEYxYVhKbEtDY3VMaTh1TGk5dGIyUjFiR1Z6TDJWek55NXplVzFpYjJ3dWIySnpaWEoyWVdKc1pTY3BPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0J5WlhGMWFYSmxLQ2N1TGk4dUxpOXRiMlIxYkdWekwxOWpiM0psSnlrdVUzbHRZbTlzTzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2YzNsdFltOXNMMmx1WkdWNExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTRORnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENKeVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMlZ6Tmk1emRISnBibWN1YVhSbGNtRjBiM0luS1R0Y2JuSmxjWFZwY21Vb0p5NHVMeTR1TDIxdlpIVnNaWE12ZDJWaUxtUnZiUzVwZEdWeVlXSnNaU2NwTzF4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCeVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMTkzYTNNdFpYaDBKeWt1WmlnbmFYUmxjbUYwYjNJbktUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwzTjViV0p2YkM5cGRHVnlZWFJ2Y2k1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ09EVmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJaXdpYlc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhwZEN3Z1EyOXVjM1J5ZFdOMGIzSXNJRzVoYldVc0lHWnZjbUpwWkdSbGJrWnBaV3hrS1h0Y2JpQWdhV1lvSVNocGRDQnBibk4wWVc1alpXOW1JRU52Ym5OMGNuVmpkRzl5S1NCOGZDQW9abTl5WW1sa1pHVnVSbWxsYkdRZ0lUMDlJSFZ1WkdWbWFXNWxaQ0FtSmlCbWIzSmlhV1JrWlc1R2FXVnNaQ0JwYmlCcGRDa3BlMXh1SUNBZ0lIUm9jbTkzSUZSNWNHVkZjbkp2Y2lodVlXMWxJQ3NnSnpvZ2FXNWpiM0p5WldOMElHbHVkbTlqWVhScGIyNGhKeWs3WEc0Z0lIMGdjbVYwZFhKdUlHbDBPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMkZ1TFdsdWMzUmhibU5sTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBNE5seHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBMElEVWlMQ0l2THlCaGJHd2daVzUxYldWeVlXSnNaU0J2WW1wbFkzUWdhMlY1Y3l3Z2FXNWpiSFZrWlhNZ2MzbHRZbTlzYzF4dWRtRnlJR2RsZEV0bGVYTWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0YTJWNWN5Y3BYRzRnSUN3Z1owOVFVeUFnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMW5iM0J6SnlsY2JpQWdMQ0J3U1VVZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmIySnFaV04wTFhCcFpTY3BPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhwZENsN1hHNGdJSFpoY2lCeVpYTjFiSFFnSUNBZ0lEMGdaMlYwUzJWNWN5aHBkQ2xjYmlBZ0lDQXNJR2RsZEZONWJXSnZiSE1nUFNCblQxQlRMbVk3WEc0Z0lHbG1LR2RsZEZONWJXSnZiSE1wZTF4dUlDQWdJSFpoY2lCemVXMWliMnh6SUQwZ1oyVjBVM2x0WW05c2N5aHBkQ2xjYmlBZ0lDQWdJQ3dnYVhORmJuVnRJQ0E5SUhCSlJTNW1YRzRnSUNBZ0lDQXNJR2tnSUNBZ0lDQWdQU0F3WEc0Z0lDQWdJQ0FzSUd0bGVUdGNiaUFnSUNCM2FHbHNaU2h6ZVcxaWIyeHpMbXhsYm1kMGFDQStJR2twYVdZb2FYTkZiblZ0TG1OaGJHd29hWFFzSUd0bGVTQTlJSE41YldKdmJITmJhU3NyWFNrcGNtVnpkV3gwTG5CMWMyZ29hMlY1S1R0Y2JpQWdmU0J5WlhSMWNtNGdjbVZ6ZFd4ME8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyVnVkVzB0YTJWNWN5NXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdPRGRjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SWl3aWRtRnlJR04wZUNBZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZZM1I0SnlsY2JpQWdMQ0JqWVd4c0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMmwwWlhJdFkyRnNiQ2NwWEc0Z0lDd2dhWE5CY25KaGVVbDBaWElnUFNCeVpYRjFhWEpsS0NjdUwxOXBjeTFoY25KaGVTMXBkR1Z5SnlsY2JpQWdMQ0JoYms5aWFtVmpkQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMkZ1TFc5aWFtVmpkQ2NwWEc0Z0lDd2dkRzlNWlc1bmRHZ2dJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOTBieTFzWlc1bmRHZ25LVnh1SUNBc0lHZGxkRWwwWlhKR2JpQWdJRDBnY21WeGRXbHlaU2duTGk5amIzSmxMbWRsZEMxcGRHVnlZWFJ2Y2kxdFpYUm9iMlFuS1Z4dUlDQXNJRUpTUlVGTElDQWdJQ0FnSUQwZ2UzMWNiaUFnTENCU1JWUlZVazRnSUNBZ0lDQTlJSHQ5TzF4dWRtRnlJR1Y0Y0c5eWRITWdQU0J0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLR2wwWlhKaFlteGxMQ0JsYm5SeWFXVnpMQ0JtYml3Z2RHaGhkQ3dnU1ZSRlVrRlVUMUlwZTF4dUlDQjJZWElnYVhSbGNrWnVJRDBnU1ZSRlVrRlVUMUlnUHlCbWRXNWpkR2x2YmlncGV5QnlaWFIxY200Z2FYUmxjbUZpYkdVN0lIMGdPaUJuWlhSSmRHVnlSbTRvYVhSbGNtRmliR1VwWEc0Z0lDQWdMQ0JtSUNBZ0lDQWdQU0JqZEhnb1ptNHNJSFJvWVhRc0lHVnVkSEpwWlhNZ1B5QXlJRG9nTVNsY2JpQWdJQ0FzSUdsdVpHVjRJQ0E5SURCY2JpQWdJQ0FzSUd4bGJtZDBhQ3dnYzNSbGNDd2dhWFJsY21GMGIzSXNJSEpsYzNWc2REdGNiaUFnYVdZb2RIbHdaVzltSUdsMFpYSkdiaUFoUFNBblpuVnVZM1JwYjI0bktYUm9jbTkzSUZSNWNHVkZjbkp2Y2locGRHVnlZV0pzWlNBcklDY2dhWE1nYm05MElHbDBaWEpoWW14bElTY3BPMXh1SUNBdkx5Qm1ZWE4wSUdOaGMyVWdabTl5SUdGeWNtRjVjeUIzYVhSb0lHUmxabUYxYkhRZ2FYUmxjbUYwYjNKY2JpQWdhV1lvYVhOQmNuSmhlVWwwWlhJb2FYUmxja1p1S1NsbWIzSW9iR1Z1WjNSb0lEMGdkRzlNWlc1bmRHZ29hWFJsY21GaWJHVXViR1Z1WjNSb0tUc2diR1Z1WjNSb0lENGdhVzVrWlhnN0lHbHVaR1Y0S3lzcGUxeHVJQ0FnSUhKbGMzVnNkQ0E5SUdWdWRISnBaWE1nUHlCbUtHRnVUMkpxWldOMEtITjBaWEFnUFNCcGRHVnlZV0pzWlZ0cGJtUmxlRjBwV3pCZExDQnpkR1Z3V3pGZEtTQTZJR1lvYVhSbGNtRmliR1ZiYVc1a1pYaGRLVHRjYmlBZ0lDQnBaaWh5WlhOMWJIUWdQVDA5SUVKU1JVRkxJSHg4SUhKbGMzVnNkQ0E5UFQwZ1VrVlVWVkpPS1hKbGRIVnliaUJ5WlhOMWJIUTdYRzRnSUgwZ1pXeHpaU0JtYjNJb2FYUmxjbUYwYjNJZ1BTQnBkR1Z5Um00dVkyRnNiQ2hwZEdWeVlXSnNaU2s3SUNFb2MzUmxjQ0E5SUdsMFpYSmhkRzl5TG01bGVIUW9LU2t1Wkc5dVpUc2dLWHRjYmlBZ0lDQnlaWE4xYkhRZ1BTQmpZV3hzS0dsMFpYSmhkRzl5TENCbUxDQnpkR1Z3TG5aaGJIVmxMQ0JsYm5SeWFXVnpLVHRjYmlBZ0lDQnBaaWh5WlhOMWJIUWdQVDA5SUVKU1JVRkxJSHg4SUhKbGMzVnNkQ0E5UFQwZ1VrVlVWVkpPS1hKbGRIVnliaUJ5WlhOMWJIUTdYRzRnSUgxY2JuMDdYRzVsZUhCdmNuUnpMa0pTUlVGTElDQTlJRUpTUlVGTE8xeHVaWGh3YjNKMGN5NVNSVlJWVWs0Z1BTQlNSVlJWVWs0N1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTltYjNJdGIyWXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRGc0WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRFFnTlNJc0lpOHZJR1poYzNRZ1lYQndiSGtzSUdoMGRIQTZMeTlxYzNCbGNtWXViRzVyYVhRdVkyOXRMMlpoYzNRdFlYQndiSGt2TlZ4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCbWRXNWpkR2x2YmlobWJpd2dZWEpuY3l3Z2RHaGhkQ2w3WEc0Z0lIWmhjaUIxYmlBOUlIUm9ZWFFnUFQwOUlIVnVaR1ZtYVc1bFpEdGNiaUFnYzNkcGRHTm9LR0Z5WjNNdWJHVnVaM1JvS1h0Y2JpQWdJQ0JqWVhObElEQTZJSEpsZEhWeWJpQjFiaUEvSUdadUtDbGNiaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBNklHWnVMbU5oYkd3b2RHaGhkQ2s3WEc0Z0lDQWdZMkZ6WlNBeE9pQnlaWFIxY200Z2RXNGdQeUJtYmloaGNtZHpXekJkS1Z4dUlDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJRG9nWm00dVkyRnNiQ2gwYUdGMExDQmhjbWR6V3pCZEtUdGNiaUFnSUNCallYTmxJREk2SUhKbGRIVnliaUIxYmlBL0lHWnVLR0Z5WjNOYk1GMHNJR0Z5WjNOYk1WMHBYRzRnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ09pQm1iaTVqWVd4c0tIUm9ZWFFzSUdGeVozTmJNRjBzSUdGeVozTmJNVjBwTzF4dUlDQWdJR05oYzJVZ016b2djbVYwZFhKdUlIVnVJRDhnWm00b1lYSm5jMXN3WFN3Z1lYSm5jMXN4WFN3Z1lYSm5jMXN5WFNsY2JpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0E2SUdadUxtTmhiR3dvZEdoaGRDd2dZWEpuYzFzd1hTd2dZWEpuYzFzeFhTd2dZWEpuYzFzeVhTazdYRzRnSUNBZ1kyRnpaU0EwT2lCeVpYUjFjbTRnZFc0Z1B5Qm1iaWhoY21keld6QmRMQ0JoY21keld6RmRMQ0JoY21keld6SmRMQ0JoY21keld6TmRLVnh1SUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lEb2dabTR1WTJGc2JDaDBhR0YwTENCaGNtZHpXekJkTENCaGNtZHpXekZkTENCaGNtZHpXekpkTENCaGNtZHpXek5kS1R0Y2JpQWdmU0J5WlhSMWNtNGdJQ0FnSUNBZ0lDQWdJQ0FnSUdadUxtRndjR3g1S0hSb1lYUXNJR0Z5WjNNcE8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgybHVkbTlyWlM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ09EbGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ05DQTFJaXdpTHk4Z1kyaGxZMnNnYjI0Z1pHVm1ZWFZzZENCQmNuSmhlU0JwZEdWeVlYUnZjbHh1ZG1GeUlFbDBaWEpoZEc5eWN5QWdQU0J5WlhGMWFYSmxLQ2N1TDE5cGRHVnlZWFJ2Y25NbktWeHVJQ0FzSUVsVVJWSkJWRTlTSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTkzYTNNbktTZ25hWFJsY21GMGIzSW5LVnh1SUNBc0lFRnljbUY1VUhKdmRHOGdQU0JCY25KaGVTNXdjbTkwYjNSNWNHVTdYRzVjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRvYVhRcGUxeHVJQ0J5WlhSMWNtNGdhWFFnSVQwOUlIVnVaR1ZtYVc1bFpDQW1KaUFvU1hSbGNtRjBiM0p6TGtGeWNtRjVJRDA5UFNCcGRDQjhmQ0JCY25KaGVWQnliM1J2VzBsVVJWSkJWRTlTWFNBOVBUMGdhWFFwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJsekxXRnljbUY1TFdsMFpYSXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRGt3WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRFFnTlNJc0lpOHZJRGN1TWk0eUlFbHpRWEp5WVhrb1lYSm5kVzFsYm5RcFhHNTJZWElnWTI5bUlEMGdjbVZ4ZFdseVpTZ25MaTlmWTI5bUp5azdYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJRUZ5Y21GNUxtbHpRWEp5WVhrZ2ZId2dablZ1WTNScGIyNGdhWE5CY25KaGVTaGhjbWNwZTF4dUlDQnlaWFIxY200Z1kyOW1LR0Z5WnlrZ1BUMGdKMEZ5Y21GNUp6dGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXBjeTFoY25KaGVTNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdPVEZjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SWl3aUx5OGdZMkZzYkNCemIyMWxkR2hwYm1jZ2IyNGdhWFJsY21GMGIzSWdjM1JsY0NCM2FYUm9JSE5oWm1VZ1kyeHZjMmx1WnlCdmJpQmxjbkp2Y2x4dWRtRnlJR0Z1VDJKcVpXTjBJRDBnY21WeGRXbHlaU2duTGk5ZllXNHRiMkpxWldOMEp5azdYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLR2wwWlhKaGRHOXlMQ0JtYml3Z2RtRnNkV1VzSUdWdWRISnBaWE1wZTF4dUlDQjBjbmtnZTF4dUlDQWdJSEpsZEhWeWJpQmxiblJ5YVdWeklEOGdabTRvWVc1UFltcGxZM1FvZG1Gc2RXVXBXekJkTENCMllXeDFaVnN4WFNrZ09pQm1iaWgyWVd4MVpTazdYRzRnSUM4dklEY3VOQzQySUVsMFpYSmhkRzl5UTJ4dmMyVW9hWFJsY21GMGIzSXNJR052YlhCc1pYUnBiMjRwWEc0Z0lIMGdZMkYwWTJnb1pTbDdYRzRnSUNBZ2RtRnlJSEpsZENBOUlHbDBaWEpoZEc5eVd5ZHlaWFIxY200blhUdGNiaUFnSUNCcFppaHlaWFFnSVQwOUlIVnVaR1ZtYVc1bFpDbGhiazlpYW1WamRDaHlaWFF1WTJGc2JDaHBkR1Z5WVhSdmNpa3BPMXh1SUNBZ0lIUm9jbTkzSUdVN1hHNGdJSDFjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlwZEdWeUxXTmhiR3d1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURreVhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURRZ05TSXNJblpoY2lCSlZFVlNRVlJQVWlBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5M2EzTW5LU2duYVhSbGNtRjBiM0luS1Z4dUlDQXNJRk5CUmtWZlEweFBVMGxPUnlBOUlHWmhiSE5sTzF4dVhHNTBjbmtnZTF4dUlDQjJZWElnY21sMFpYSWdQU0JiTjExYlNWUkZVa0ZVVDFKZEtDazdYRzRnSUhKcGRHVnlXeWR5WlhSMWNtNG5YU0E5SUdaMWJtTjBhVzl1S0NsN0lGTkJSa1ZmUTB4UFUwbE9SeUE5SUhSeWRXVTdJSDA3WEc0Z0lFRnljbUY1TG1aeWIyMG9jbWwwWlhJc0lHWjFibU4wYVc5dUtDbDdJSFJvY205M0lESTdJSDBwTzF4dWZTQmpZWFJqYUNobEtYc2dMeW9nWlcxd2RIa2dLaThnZlZ4dVhHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHVjRaV01zSUhOcmFYQkRiRzl6YVc1bktYdGNiaUFnYVdZb0lYTnJhWEJEYkc5emFXNW5JQ1ltSUNGVFFVWkZYME5NVDFOSlRrY3BjbVYwZFhKdUlHWmhiSE5sTzF4dUlDQjJZWElnYzJGbVpTQTlJR1poYkhObE8xeHVJQ0IwY25rZ2UxeHVJQ0FnSUhaaGNpQmhjbklnSUQwZ1d6ZGRYRzRnSUNBZ0lDQXNJR2wwWlhJZ1BTQmhjbkpiU1ZSRlVrRlVUMUpkS0NrN1hHNGdJQ0FnYVhSbGNpNXVaWGgwSUQwZ1puVnVZM1JwYjI0b0tYc2djbVYwZFhKdUlIdGtiMjVsT2lCellXWmxJRDBnZEhKMVpYMDdJSDA3WEc0Z0lDQWdZWEp5VzBsVVJWSkJWRTlTWFNBOUlHWjFibU4wYVc5dUtDbDdJSEpsZEhWeWJpQnBkR1Z5T3lCOU8xeHVJQ0FnSUdWNFpXTW9ZWEp5S1R0Y2JpQWdmU0JqWVhSamFDaGxLWHNnTHlvZ1pXMXdkSGtnS2k4Z2ZWeHVJQ0J5WlhSMWNtNGdjMkZtWlR0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5cGRHVnlMV1JsZEdWamRDNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdPVE5jYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdOQ0ExSWl3aWRtRnlJR2RsZEV0bGVYTWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxclpYbHpKeWxjYmlBZ0xDQjBiMGxQWW1wbFkzUWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXBiMkpxWldOMEp5azdYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLRzlpYW1WamRDd2daV3dwZTF4dUlDQjJZWElnVHlBZ0lDQWdJRDBnZEc5SlQySnFaV04wS0c5aWFtVmpkQ2xjYmlBZ0lDQXNJR3RsZVhNZ0lDQTlJR2RsZEV0bGVYTW9UeWxjYmlBZ0lDQXNJR3hsYm1kMGFDQTlJR3RsZVhNdWJHVnVaM1JvWEc0Z0lDQWdMQ0JwYm1SbGVDQWdQU0F3WEc0Z0lDQWdMQ0JyWlhrN1hHNGdJSGRvYVd4bEtHeGxibWQwYUNBK0lHbHVaR1Y0S1dsbUtFOWJhMlY1SUQwZ2EyVjVjMXRwYm1SbGVDc3JYVjBnUFQwOUlHVnNLWEpsZEhWeWJpQnJaWGs3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYTJWNWIyWXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRGswWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlJc0luWmhjaUJuYkc5aVlXd2dJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOW5iRzlpWVd3bktWeHVJQ0FzSUcxaFkzSnZkR0Z6YXlBOUlISmxjWFZwY21Vb0p5NHZYM1JoYzJzbktTNXpaWFJjYmlBZ0xDQlBZbk5sY25abGNpQWdQU0JuYkc5aVlXd3VUWFYwWVhScGIyNVBZbk5sY25abGNpQjhmQ0JuYkc5aVlXd3VWMlZpUzJsMFRYVjBZWFJwYjI1UFluTmxjblpsY2x4dUlDQXNJSEJ5YjJObGMzTWdJQ0E5SUdkc2IySmhiQzV3Y205alpYTnpYRzRnSUN3Z1VISnZiV2x6WlNBZ0lEMGdaMnh2WW1Gc0xsQnliMjFwYzJWY2JpQWdMQ0JwYzA1dlpHVWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOWpiMlluS1Nod2NtOWpaWE56S1NBOVBTQW5jSEp2WTJWemN5YzdYRzVjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRvS1h0Y2JpQWdkbUZ5SUdobFlXUXNJR3hoYzNRc0lHNXZkR2xtZVR0Y2JseHVJQ0IyWVhJZ1pteDFjMmdnUFNCbWRXNWpkR2x2YmlncGUxeHVJQ0FnSUhaaGNpQndZWEpsYm5Rc0lHWnVPMXh1SUNBZ0lHbG1LR2x6VG05a1pTQW1KaUFvY0dGeVpXNTBJRDBnY0hKdlkyVnpjeTVrYjIxaGFXNHBLWEJoY21WdWRDNWxlR2wwS0NrN1hHNGdJQ0FnZDJocGJHVW9hR1ZoWkNsN1hHNGdJQ0FnSUNCbWJpQWdJRDBnYUdWaFpDNW1ianRjYmlBZ0lDQWdJR2hsWVdRZ1BTQm9aV0ZrTG01bGVIUTdYRzRnSUNBZ0lDQjBjbmtnZTF4dUlDQWdJQ0FnSUNCbWJpZ3BPMXh1SUNBZ0lDQWdmU0JqWVhSamFDaGxLWHRjYmlBZ0lDQWdJQ0FnYVdZb2FHVmhaQ2x1YjNScFpua29LVHRjYmlBZ0lDQWdJQ0FnWld4elpTQnNZWE4wSUQwZ2RXNWtaV1pwYm1Wa08xeHVJQ0FnSUNBZ0lDQjBhSEp2ZHlCbE8xeHVJQ0FnSUNBZ2ZWeHVJQ0FnSUgwZ2JHRnpkQ0E5SUhWdVpHVm1hVzVsWkR0Y2JpQWdJQ0JwWmlod1lYSmxiblFwY0dGeVpXNTBMbVZ1ZEdWeUtDazdYRzRnSUgwN1hHNWNiaUFnTHk4Z1RtOWtaUzVxYzF4dUlDQnBaaWhwYzA1dlpHVXBlMXh1SUNBZ0lHNXZkR2xtZVNBOUlHWjFibU4wYVc5dUtDbDdYRzRnSUNBZ0lDQndjbTlqWlhOekxtNWxlSFJVYVdOcktHWnNkWE5vS1R0Y2JpQWdJQ0I5TzF4dUlDQXZMeUJpY205M2MyVnljeUIzYVhSb0lFMTFkR0YwYVc5dVQySnpaWEoyWlhKY2JpQWdmU0JsYkhObElHbG1LRTlpYzJWeWRtVnlLWHRjYmlBZ0lDQjJZWElnZEc5bloyeGxJRDBnZEhKMVpWeHVJQ0FnSUNBZ0xDQnViMlJsSUNBZ1BTQmtiMk4xYldWdWRDNWpjbVZoZEdWVVpYaDBUbTlrWlNnbkp5azdYRzRnSUNBZ2JtVjNJRTlpYzJWeWRtVnlLR1pzZFhOb0tTNXZZbk5sY25abEtHNXZaR1VzSUh0amFHRnlZV04wWlhKRVlYUmhPaUIwY25WbGZTazdJQzh2SUdWemJHbHVkQzFrYVhOaFlteGxMV3hwYm1VZ2JtOHRibVYzWEc0Z0lDQWdibTkwYVdaNUlEMGdablZ1WTNScGIyNG9LWHRjYmlBZ0lDQWdJRzV2WkdVdVpHRjBZU0E5SUhSdloyZHNaU0E5SUNGMGIyZG5iR1U3WEc0Z0lDQWdmVHRjYmlBZ0x5OGdaVzUyYVhKdmJtMWxiblJ6SUhkcGRHZ2diV0Y1WW1VZ2JtOXVMV052YlhCc1pYUmxiSGtnWTI5eWNtVmpkQ3dnWW5WMElHVjRhWE4wWlc1MElGQnliMjFwYzJWY2JpQWdmU0JsYkhObElHbG1LRkJ5YjIxcGMyVWdKaVlnVUhKdmJXbHpaUzV5WlhOdmJIWmxLWHRjYmlBZ0lDQjJZWElnY0hKdmJXbHpaU0E5SUZCeWIyMXBjMlV1Y21WemIyeDJaU2dwTzF4dUlDQWdJRzV2ZEdsbWVTQTlJR1oxYm1OMGFXOXVLQ2w3WEc0Z0lDQWdJQ0J3Y205dGFYTmxMblJvWlc0b1pteDFjMmdwTzF4dUlDQWdJSDA3WEc0Z0lDOHZJR1p2Y2lCdmRHaGxjaUJsYm5acGNtOXViV1Z1ZEhNZ0xTQnRZV055YjNSaGMyc2dZbUZ6WldRZ2IyNDZYRzRnSUM4dklDMGdjMlYwU1cxdFpXUnBZWFJsWEc0Z0lDOHZJQzBnVFdWemMyRm5aVU5vWVc1dVpXeGNiaUFnTHk4Z0xTQjNhVzVrYjNjdWNHOXpkRTFsYzNOaFoxeHVJQ0F2THlBdElHOXVjbVZoWkhsemRHRjBaV05vWVc1blpWeHVJQ0F2THlBdElITmxkRlJwYldWdmRYUmNiaUFnZlNCbGJITmxJSHRjYmlBZ0lDQnViM1JwWm5rZ1BTQm1kVzVqZEdsdmJpZ3BlMXh1SUNBZ0lDQWdMeThnYzNSeVlXNW5aU0JKUlNBcklIZGxZbkJoWTJzZ1pHVjJJSE5sY25abGNpQmlkV2NnTFNCMWMyVWdMbU5oYkd3b1oyeHZZbUZzS1Z4dUlDQWdJQ0FnYldGamNtOTBZWE5yTG1OaGJHd29aMnh2WW1Gc0xDQm1iSFZ6YUNrN1hHNGdJQ0FnZlR0Y2JpQWdmVnh1WEc0Z0lISmxkSFZ5YmlCbWRXNWpkR2x2YmlobWJpbDdYRzRnSUNBZ2RtRnlJSFJoYzJzZ1BTQjdabTQ2SUdadUxDQnVaWGgwT2lCMWJtUmxabWx1WldSOU8xeHVJQ0FnSUdsbUtHeGhjM1FwYkdGemRDNXVaWGgwSUQwZ2RHRnphenRjYmlBZ0lDQnBaaWdoYUdWaFpDbDdYRzRnSUNBZ0lDQm9aV0ZrSUQwZ2RHRnphenRjYmlBZ0lDQWdJRzV2ZEdsbWVTZ3BPMXh1SUNBZ0lIMGdiR0Z6ZENBOUlIUmhjMnM3WEc0Z0lIMDdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZiV2xqY205MFlYTnJMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0E1TlZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0EwSURVaUxDSXZMeUJtWVd4c1ltRmpheUJtYjNJZ1NVVXhNU0JpZFdkbmVTQlBZbXBsWTNRdVoyVjBUM2R1VUhKdmNHVnlkSGxPWVcxbGN5QjNhWFJvSUdsbWNtRnRaU0JoYm1RZ2QybHVaRzkzWEc1MllYSWdkRzlKVDJKcVpXTjBJRDBnY21WeGRXbHlaU2duTGk5ZmRHOHRhVzlpYW1WamRDY3BYRzRnSUN3Z1owOVFUaUFnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMV2R2Y0c0bktTNW1YRzRnSUN3Z2RHOVRkSEpwYm1jZ0lEMGdlMzB1ZEc5VGRISnBibWM3WEc1Y2JuWmhjaUIzYVc1a2IzZE9ZVzFsY3lBOUlIUjVjR1Z2WmlCM2FXNWtiM2NnUFQwZ0oyOWlhbVZqZENjZ0ppWWdkMmx1Wkc5M0lDWW1JRTlpYW1WamRDNW5aWFJQZDI1UWNtOXdaWEowZVU1aGJXVnpYRzRnSUQ4Z1QySnFaV04wTG1kbGRFOTNibEJ5YjNCbGNuUjVUbUZ0WlhNb2QybHVaRzkzS1NBNklGdGRPMXh1WEc1MllYSWdaMlYwVjJsdVpHOTNUbUZ0WlhNZ1BTQm1kVzVqZEdsdmJpaHBkQ2w3WEc0Z0lIUnllU0I3WEc0Z0lDQWdjbVYwZFhKdUlHZFBVRTRvYVhRcE8xeHVJQ0I5SUdOaGRHTm9LR1VwZTF4dUlDQWdJSEpsZEhWeWJpQjNhVzVrYjNkT1lXMWxjeTV6YkdsalpTZ3BPMXh1SUNCOVhHNTlPMXh1WEc1dGIyUjFiR1V1Wlhod2IzSjBjeTVtSUQwZ1puVnVZM1JwYjI0Z1oyVjBUM2R1VUhKdmNHVnlkSGxPWVcxbGN5aHBkQ2w3WEc0Z0lISmxkSFZ5YmlCM2FXNWtiM2RPWVcxbGN5QW1KaUIwYjFOMGNtbHVaeTVqWVd4c0tHbDBLU0E5UFNBblcyOWlhbVZqZENCWGFXNWtiM2RkSnlBL0lHZGxkRmRwYm1SdmQwNWhiV1Z6S0dsMEtTQTZJR2RQVUU0b2RHOUpUMkpxWldOMEtHbDBLU2s3WEc1OU8xeHVYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5dlltcGxZM1F0WjI5d2JpMWxlSFF1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURrMlhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015SXNJblpoY2lCb2FXUmxJRDBnY21WeGRXbHlaU2duTGk5ZmFHbGtaU2NwTzF4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCbWRXNWpkR2x2YmloMFlYSm5aWFFzSUhOeVl5d2djMkZtWlNsN1hHNGdJR1p2Y2loMllYSWdhMlY1SUdsdUlITnlZeWw3WEc0Z0lDQWdhV1lvYzJGbVpTQW1KaUIwWVhKblpYUmJhMlY1WFNsMFlYSm5aWFJiYTJWNVhTQTlJSE55WTF0clpYbGRPMXh1SUNBZ0lHVnNjMlVnYUdsa1pTaDBZWEpuWlhRc0lHdGxlU3dnYzNKalcydGxlVjBwTzF4dUlDQjlJSEpsZEhWeWJpQjBZWEpuWlhRN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmNtVmtaV1pwYm1VdFlXeHNMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0E1TjF4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0EwSURVaUxDSXZMeUJYYjNKcmN5QjNhWFJvSUY5ZmNISnZkRzlmWHlCdmJteDVMaUJQYkdRZ2RqZ2dZMkZ1SjNRZ2QyOXlheUIzYVhSb0lHNTFiR3dnY0hKdmRHOGdiMkpxWldOMGN5NWNiaThxSUdWemJHbHVkQzFrYVhOaFlteGxJRzV2TFhCeWIzUnZJQ292WEc1MllYSWdhWE5QWW1wbFkzUWdQU0J5WlhGMWFYSmxLQ2N1TDE5cGN5MXZZbXBsWTNRbktWeHVJQ0FzSUdGdVQySnFaV04wSUQwZ2NtVnhkV2x5WlNnbkxpOWZZVzR0YjJKcVpXTjBKeWs3WEc1MllYSWdZMmhsWTJzZ1BTQm1kVzVqZEdsdmJpaFBMQ0J3Y205MGJ5bDdYRzRnSUdGdVQySnFaV04wS0U4cE8xeHVJQ0JwWmlnaGFYTlBZbXBsWTNRb2NISnZkRzhwSUNZbUlIQnliM1J2SUNFOVBTQnVkV3hzS1hSb2NtOTNJRlI1Y0dWRmNuSnZjaWh3Y205MGJ5QXJJRndpT2lCallXNG5kQ0J6WlhRZ1lYTWdjSEp2ZEc5MGVYQmxJVndpS1R0Y2JuMDdYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJSHRjYmlBZ2MyVjBPaUJQWW1wbFkzUXVjMlYwVUhKdmRHOTBlWEJsVDJZZ2ZId2dLQ2RmWDNCeWIzUnZYMThuSUdsdUlIdDlJRDhnTHk4Z1pYTnNhVzUwTFdScGMyRmliR1V0YkdsdVpWeHVJQ0FnSUdaMWJtTjBhVzl1S0hSbGMzUXNJR0oxWjJkNUxDQnpaWFFwZTF4dUlDQWdJQ0FnZEhKNUlIdGNiaUFnSUNBZ0lDQWdjMlYwSUQwZ2NtVnhkV2x5WlNnbkxpOWZZM1I0Snlrb1JuVnVZM1JwYjI0dVkyRnNiQ3dnY21WeGRXbHlaU2duTGk5ZmIySnFaV04wTFdkdmNHUW5LUzVtS0U5aWFtVmpkQzV3Y205MGIzUjVjR1VzSUNkZlgzQnliM1J2WDE4bktTNXpaWFFzSURJcE8xeHVJQ0FnSUNBZ0lDQnpaWFFvZEdWemRDd2dXMTBwTzF4dUlDQWdJQ0FnSUNCaWRXZG5lU0E5SUNFb2RHVnpkQ0JwYm5OMFlXNWpaVzltSUVGeWNtRjVLVHRjYmlBZ0lDQWdJSDBnWTJGMFkyZ29aU2w3SUdKMVoyZDVJRDBnZEhKMVpUc2dmVnh1SUNBZ0lDQWdjbVYwZFhKdUlHWjFibU4wYVc5dUlITmxkRkJ5YjNSdmRIbHdaVTltS0U4c0lIQnliM1J2S1h0Y2JpQWdJQ0FnSUNBZ1kyaGxZMnNvVHl3Z2NISnZkRzhwTzF4dUlDQWdJQ0FnSUNCcFppaGlkV2RuZVNsUExsOWZjSEp2ZEc5Zlh5QTlJSEJ5YjNSdk8xeHVJQ0FnSUNBZ0lDQmxiSE5sSUhObGRDaFBMQ0J3Y205MGJ5azdYRzRnSUNBZ0lDQWdJSEpsZEhWeWJpQlBPMXh1SUNBZ0lDQWdmVHRjYmlBZ0lDQjlLSHQ5TENCbVlXeHpaU2tnT2lCMWJtUmxabWx1WldRcExGeHVJQ0JqYUdWamF6b2dZMmhsWTJ0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5elpYUXRjSEp2ZEc4dWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEazRYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUlzSWlkMWMyVWdjM1J5YVdOMEp6dGNiblpoY2lCbmJHOWlZV3dnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJkc2IySmhiQ2NwWEc0Z0lDd2dZMjl5WlNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOWpiM0psSnlsY2JpQWdMQ0JrVUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMWtjQ2NwWEc0Z0lDd2dSRVZUUTFKSlVGUlBVbE1nUFNCeVpYRjFhWEpsS0NjdUwxOWtaWE5qY21sd2RHOXljeWNwWEc0Z0lDd2dVMUJGUTBsRlV5QWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOTNhM01uS1NnbmMzQmxZMmxsY3ljcE8xeHVYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLRXRGV1NsN1hHNGdJSFpoY2lCRElEMGdkSGx3Wlc5bUlHTnZjbVZiUzBWWlhTQTlQU0FuWm5WdVkzUnBiMjRuSUQ4Z1kyOXlaVnRMUlZsZElEb2daMnh2WW1Gc1cwdEZXVjA3WEc0Z0lHbG1LRVJGVTBOU1NWQlVUMUpUSUNZbUlFTWdKaVlnSVVOYlUxQkZRMGxGVTEwcFpGQXVaaWhETENCVFVFVkRTVVZUTENCN1hHNGdJQ0FnWTI5dVptbG5kWEpoWW14bE9pQjBjblZsTEZ4dUlDQWdJR2RsZERvZ1puVnVZM1JwYjI0b0tYc2djbVYwZFhKdUlIUm9hWE03SUgxY2JpQWdmU2s3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYzJWMExYTndaV05wWlhNdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEazVYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElEUWdOU0lzSWk4dklEY3VNeTR5TUNCVGNHVmphV1Z6UTI5dWMzUnlkV04wYjNJb1R5d2daR1ZtWVhWc2RFTnZibk4wY25WamRHOXlLVnh1ZG1GeUlHRnVUMkpxWldOMElDQTlJSEpsY1hWcGNtVW9KeTR2WDJGdUxXOWlhbVZqZENjcFhHNGdJQ3dnWVVaMWJtTjBhVzl1SUQwZ2NtVnhkV2x5WlNnbkxpOWZZUzFtZFc1amRHbHZiaWNwWEc0Z0lDd2dVMUJGUTBsRlV5QWdJRDBnY21WeGRXbHlaU2duTGk5ZmQydHpKeWtvSjNOd1pXTnBaWE1uS1R0Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b1R5d2dSQ2w3WEc0Z0lIWmhjaUJESUQwZ1lXNVBZbXBsWTNRb1R5a3VZMjl1YzNSeWRXTjBiM0lzSUZNN1hHNGdJSEpsZEhWeWJpQkRJRDA5UFNCMWJtUmxabWx1WldRZ2ZId2dLRk1nUFNCaGJrOWlhbVZqZENoREtWdFRVRVZEU1VWVFhTa2dQVDBnZFc1a1pXWnBibVZrSUQ4Z1JDQTZJR0ZHZFc1amRHbHZiaWhUS1R0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5emNHVmphV1Z6TFdOdmJuTjBjblZqZEc5eUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXhNREJjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdOQ0ExSWl3aWRtRnlJQ1JsZUhCdmNuUWdQU0J5WlhGMWFYSmxLQ2N1TDE5bGVIQnZjblFuS1Z4dUx5OGdNVGt1TVM0eUxqSWdMeUF4TlM0eUxqTXVOU0JQWW1wbFkzUXVZM0psWVhSbEtFOGdXeXdnVUhKdmNHVnlkR2xsYzEwcFhHNGtaWGh3YjNKMEtDUmxlSEJ2Y25RdVV5d2dKMDlpYW1WamRDY3NJSHRqY21WaGRHVTZJSEpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzFqY21WaGRHVW5LWDBwTzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWxjell1YjJKcVpXTjBMbU55WldGMFpTNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVEF4WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlJc0lpOHZJREU1TGpFdU1pNDVJRTlpYW1WamRDNW5aWFJRY205MGIzUjVjR1ZQWmloUEtWeHVkbUZ5SUhSdlQySnFaV04wSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzUnZMVzlpYW1WamRDY3BYRzRnSUN3Z0pHZGxkRkJ5YjNSdmRIbHdaVTltSUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXZHdieWNwTzF4dVhHNXlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRjMkZ3Snlrb0oyZGxkRkJ5YjNSdmRIbHdaVTltSnl3Z1puVnVZM1JwYjI0b0tYdGNiaUFnY21WMGRYSnVJR1oxYm1OMGFXOXVJR2RsZEZCeWIzUnZkSGx3WlU5bUtHbDBLWHRjYmlBZ0lDQnlaWFIxY200Z0pHZGxkRkJ5YjNSdmRIbHdaVTltS0hSdlQySnFaV04wS0dsMEtTazdYRzRnSUgwN1hHNTlLVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNW5aWFF0Y0hKdmRHOTBlWEJsTFc5bUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXhNREpjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SWl3aUx5OGdNVGt1TVM0eUxqRTBJRTlpYW1WamRDNXJaWGx6S0U4cFhHNTJZWElnZEc5UFltcGxZM1FnUFNCeVpYRjFhWEpsS0NjdUwxOTBieTF2WW1wbFkzUW5LVnh1SUNBc0lDUnJaWGx6SUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMV3RsZVhNbktUdGNibHh1Y21WeGRXbHlaU2duTGk5ZmIySnFaV04wTFhOaGNDY3BLQ2RyWlhsekp5d2dablZ1WTNScGIyNG9LWHRjYmlBZ2NtVjBkWEp1SUdaMWJtTjBhVzl1SUd0bGVYTW9hWFFwZTF4dUlDQWdJSEpsZEhWeWJpQWthMlY1Y3loMGIwOWlhbVZqZENocGRDa3BPMXh1SUNCOU8xeHVmU2s3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwyVnpOaTV2WW1wbFkzUXVhMlY1Y3k1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01UQXpYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeUlEUWdOU0lzSWk4dklERTVMakV1TXk0eE9TQlBZbXBsWTNRdWMyVjBVSEp2ZEc5MGVYQmxUMllvVHl3Z2NISnZkRzhwWEc1MllYSWdKR1Y0Y0c5eWRDQTlJSEpsY1hWcGNtVW9KeTR2WDJWNGNHOXlkQ2NwTzF4dUpHVjRjRzl5ZENna1pYaHdiM0owTGxNc0lDZFBZbXBsWTNRbkxDQjdjMlYwVUhKdmRHOTBlWEJsVDJZNklISmxjWFZwY21Vb0p5NHZYM05sZEMxd2NtOTBieWNwTG5ObGRIMHBPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5bGN6WXViMkpxWldOMExuTmxkQzF3Y205MGIzUjVjR1V0YjJZdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlERXdORnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENJbmRYTmxJSE4wY21samRDYzdYRzUyWVhJZ1RFbENVa0ZTV1NBZ0lDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYkdsaWNtRnllU2NwWEc0Z0lDd2daMnh2WW1Gc0lDQWdJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZloyeHZZbUZzSnlsY2JpQWdMQ0JqZEhnZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOWpkSGduS1Z4dUlDQXNJR05zWVhOemIyWWdJQ0FnSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyTnNZWE56YjJZbktWeHVJQ0FzSUNSbGVIQnZjblFnSUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMlY0Y0c5eWRDY3BYRzRnSUN3Z2FYTlBZbXBsWTNRZ0lDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYVhNdGIySnFaV04wSnlsY2JpQWdMQ0JoUm5WdVkzUnBiMjRnSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOWhMV1oxYm1OMGFXOXVKeWxjYmlBZ0xDQmhia2x1YzNSaGJtTmxJQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5aGJpMXBibk4wWVc1alpTY3BYRzRnSUN3Z1ptOXlUMllnSUNBZ0lDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmWm05eUxXOW1KeWxjYmlBZ0xDQnpjR1ZqYVdWelEyOXVjM1J5ZFdOMGIzSWdQU0J5WlhGMWFYSmxLQ2N1TDE5emNHVmphV1Z6TFdOdmJuTjBjblZqZEc5eUp5bGNiaUFnTENCMFlYTnJJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTkwWVhOckp5a3VjMlYwWEc0Z0lDd2diV2xqY205MFlYTnJJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmJXbGpjbTkwWVhOckp5a29LVnh1SUNBc0lGQlNUMDFKVTBVZ0lDQWdJQ0FnSUNBZ0lDQTlJQ2RRY205dGFYTmxKMXh1SUNBc0lGUjVjR1ZGY25KdmNpQWdJQ0FnSUNBZ0lDQTlJR2RzYjJKaGJDNVVlWEJsUlhKeWIzSmNiaUFnTENCd2NtOWpaWE56SUNBZ0lDQWdJQ0FnSUNBZ1BTQm5iRzlpWVd3dWNISnZZMlZ6YzF4dUlDQXNJQ1JRY205dGFYTmxJQ0FnSUNBZ0lDQWdJQ0E5SUdkc2IySmhiRnRRVWs5TlNWTkZYVnh1SUNBc0lIQnliMk5sYzNNZ0lDQWdJQ0FnSUNBZ0lDQTlJR2RzYjJKaGJDNXdjbTlqWlhOelhHNGdJQ3dnYVhOT2IyUmxJQ0FnSUNBZ0lDQWdJQ0FnSUQwZ1kyeGhjM052Wmlod2NtOWpaWE56S1NBOVBTQW5jSEp2WTJWemN5ZGNiaUFnTENCbGJYQjBlU0FnSUNBZ0lDQWdJQ0FnSUNBZ1BTQm1kVzVqZEdsdmJpZ3BleUF2S2lCbGJYQjBlU0FxTHlCOVhHNGdJQ3dnU1c1MFpYSnVZV3dzSUVkbGJtVnlhV05RY205dGFYTmxRMkZ3WVdKcGJHbDBlU3dnVjNKaGNIQmxjanRjYmx4dWRtRnlJRlZUUlY5T1FWUkpWa1VnUFNBaElXWjFibU4wYVc5dUtDbDdYRzRnSUhSeWVTQjdYRzRnSUNBZ0x5OGdZMjl5Y21WamRDQnpkV0pqYkdGemMybHVaeUIzYVhSb0lFQkFjM0JsWTJsbGN5QnpkWEJ3YjNKMFhHNGdJQ0FnZG1GeUlIQnliMjFwYzJVZ0lDQWdJRDBnSkZCeWIyMXBjMlV1Y21WemIyeDJaU2d4S1Z4dUlDQWdJQ0FnTENCR1lXdGxVSEp2YldselpTQTlJQ2h3Y205dGFYTmxMbU52Ym5OMGNuVmpkRzl5SUQwZ2UzMHBXM0psY1hWcGNtVW9KeTR2WDNkcmN5Y3BLQ2R6Y0dWamFXVnpKeWxkSUQwZ1puVnVZM1JwYjI0b1pYaGxZeWw3SUdWNFpXTW9aVzF3ZEhrc0lHVnRjSFI1S1RzZ2ZUdGNiaUFnSUNBdkx5QjFibWhoYm1Sc1pXUWdjbVZxWldOMGFXOXVjeUIwY21GamEybHVaeUJ6ZFhCd2IzSjBMQ0JPYjJSbFNsTWdVSEp2YldselpTQjNhWFJvYjNWMElHbDBJR1poYVd4eklFQkFjM0JsWTJsbGN5QjBaWE4wWEc0Z0lDQWdjbVYwZFhKdUlDaHBjMDV2WkdVZ2ZId2dkSGx3Wlc5bUlGQnliMjFwYzJWU1pXcGxZM1JwYjI1RmRtVnVkQ0E5UFNBblpuVnVZM1JwYjI0bktTQW1KaUJ3Y205dGFYTmxMblJvWlc0b1pXMXdkSGtwSUdsdWMzUmhibU5sYjJZZ1JtRnJaVkJ5YjIxcGMyVTdYRzRnSUgwZ1kyRjBZMmdvWlNsN0lDOHFJR1Z0Y0hSNUlDb3ZJSDFjYm4wb0tUdGNibHh1THk4Z2FHVnNjR1Z5YzF4dWRtRnlJSE5oYldWRGIyNXpkSEoxWTNSdmNpQTlJR1oxYm1OMGFXOXVLR0VzSUdJcGUxeHVJQ0F2THlCM2FYUm9JR3hwWW5KaGNua2dkM0poY0hCbGNpQnpjR1ZqYVdGc0lHTmhjMlZjYmlBZ2NtVjBkWEp1SUdFZ1BUMDlJR0lnZkh3Z1lTQTlQVDBnSkZCeWIyMXBjMlVnSmlZZ1lpQTlQVDBnVjNKaGNIQmxjanRjYm4wN1hHNTJZWElnYVhOVWFHVnVZV0pzWlNBOUlHWjFibU4wYVc5dUtHbDBLWHRjYmlBZ2RtRnlJSFJvWlc0N1hHNGdJSEpsZEhWeWJpQnBjMDlpYW1WamRDaHBkQ2tnSmlZZ2RIbHdaVzltSUNoMGFHVnVJRDBnYVhRdWRHaGxiaWtnUFQwZ0oyWjFibU4wYVc5dUp5QS9JSFJvWlc0Z09pQm1ZV3h6WlR0Y2JuMDdYRzUyWVhJZ2JtVjNVSEp2YldselpVTmhjR0ZpYVd4cGRIa2dQU0JtZFc1amRHbHZiaWhES1h0Y2JpQWdjbVYwZFhKdUlITmhiV1ZEYjI1emRISjFZM1J2Y2lna1VISnZiV2x6WlN3Z1F5bGNiaUFnSUNBL0lHNWxkeUJRY205dGFYTmxRMkZ3WVdKcGJHbDBlU2hES1Z4dUlDQWdJRG9nYm1WM0lFZGxibVZ5YVdOUWNtOXRhWE5sUTJGd1lXSnBiR2wwZVNoREtUdGNibjA3WEc1MllYSWdVSEp2YldselpVTmhjR0ZpYVd4cGRIa2dQU0JIWlc1bGNtbGpVSEp2YldselpVTmhjR0ZpYVd4cGRIa2dQU0JtZFc1amRHbHZiaWhES1h0Y2JpQWdkbUZ5SUhKbGMyOXNkbVVzSUhKbGFtVmpkRHRjYmlBZ2RHaHBjeTV3Y205dGFYTmxJRDBnYm1WM0lFTW9ablZ1WTNScGIyNG9KQ1J5WlhOdmJIWmxMQ0FrSkhKbGFtVmpkQ2w3WEc0Z0lDQWdhV1lvY21WemIyeDJaU0FoUFQwZ2RXNWtaV1pwYm1Wa0lIeDhJSEpsYW1WamRDQWhQVDBnZFc1a1pXWnBibVZrS1hSb2NtOTNJRlI1Y0dWRmNuSnZjaWduUW1Ga0lGQnliMjFwYzJVZ1kyOXVjM1J5ZFdOMGIzSW5LVHRjYmlBZ0lDQnlaWE52YkhabElEMGdKQ1J5WlhOdmJIWmxPMXh1SUNBZ0lISmxhbVZqZENBZ1BTQWtKSEpsYW1WamREdGNiaUFnZlNrN1hHNGdJSFJvYVhNdWNtVnpiMngyWlNBOUlHRkdkVzVqZEdsdmJpaHlaWE52YkhabEtUdGNiaUFnZEdocGN5NXlaV3BsWTNRZ0lEMGdZVVoxYm1OMGFXOXVLSEpsYW1WamRDazdYRzU5TzF4dWRtRnlJSEJsY21admNtMGdQU0JtZFc1amRHbHZiaWhsZUdWaktYdGNiaUFnZEhKNUlIdGNiaUFnSUNCbGVHVmpLQ2s3WEc0Z0lIMGdZMkYwWTJnb1pTbDdYRzRnSUNBZ2NtVjBkWEp1SUh0bGNuSnZjam9nWlgwN1hHNGdJSDFjYm4wN1hHNTJZWElnYm05MGFXWjVJRDBnWm5WdVkzUnBiMjRvY0hKdmJXbHpaU3dnYVhOU1pXcGxZM1FwZTF4dUlDQnBaaWh3Y205dGFYTmxMbDl1S1hKbGRIVnlianRjYmlBZ2NISnZiV2x6WlM1ZmJpQTlJSFJ5ZFdVN1hHNGdJSFpoY2lCamFHRnBiaUE5SUhCeWIyMXBjMlV1WDJNN1hHNGdJRzFwWTNKdmRHRnpheWhtZFc1amRHbHZiaWdwZTF4dUlDQWdJSFpoY2lCMllXeDFaU0E5SUhCeWIyMXBjMlV1WDNaY2JpQWdJQ0FnSUN3Z2Iyc2dJQ0FnUFNCd2NtOXRhWE5sTGw5eklEMDlJREZjYmlBZ0lDQWdJQ3dnYVNBZ0lDQWdQU0F3TzF4dUlDQWdJSFpoY2lCeWRXNGdQU0JtZFc1amRHbHZiaWh5WldGamRHbHZiaWw3WEc0Z0lDQWdJQ0IyWVhJZ2FHRnVaR3hsY2lBOUlHOXJJRDhnY21WaFkzUnBiMjR1YjJzZ09pQnlaV0ZqZEdsdmJpNW1ZV2xzWEc0Z0lDQWdJQ0FnSUN3Z2NtVnpiMngyWlNBOUlISmxZV04wYVc5dUxuSmxjMjlzZG1WY2JpQWdJQ0FnSUNBZ0xDQnlaV3BsWTNRZ0lEMGdjbVZoWTNScGIyNHVjbVZxWldOMFhHNGdJQ0FnSUNBZ0lDd2daRzl0WVdsdUlDQTlJSEpsWVdOMGFXOXVMbVJ2YldGcGJseHVJQ0FnSUNBZ0lDQXNJSEpsYzNWc2RDd2dkR2hsYmp0Y2JpQWdJQ0FnSUhSeWVTQjdYRzRnSUNBZ0lDQWdJR2xtS0doaGJtUnNaWElwZTF4dUlDQWdJQ0FnSUNBZ0lHbG1LQ0Z2YXlsN1hHNGdJQ0FnSUNBZ0lDQWdJQ0JwWmlod2NtOXRhWE5sTGw5b0lEMDlJRElwYjI1SVlXNWtiR1ZWYm1oaGJtUnNaV1FvY0hKdmJXbHpaU2s3WEc0Z0lDQWdJQ0FnSUNBZ0lDQndjbTl0YVhObExsOW9JRDBnTVR0Y2JpQWdJQ0FnSUNBZ0lDQjlYRzRnSUNBZ0lDQWdJQ0FnYVdZb2FHRnVaR3hsY2lBOVBUMGdkSEoxWlNseVpYTjFiSFFnUFNCMllXeDFaVHRjYmlBZ0lDQWdJQ0FnSUNCbGJITmxJSHRjYmlBZ0lDQWdJQ0FnSUNBZ0lHbG1LR1J2YldGcGJpbGtiMjFoYVc0dVpXNTBaWElvS1R0Y2JpQWdJQ0FnSUNBZ0lDQWdJSEpsYzNWc2RDQTlJR2hoYm1Sc1pYSW9kbUZzZFdVcE8xeHVJQ0FnSUNBZ0lDQWdJQ0FnYVdZb1pHOXRZV2x1S1dSdmJXRnBiaTVsZUdsMEtDazdYRzRnSUNBZ0lDQWdJQ0FnZlZ4dUlDQWdJQ0FnSUNBZ0lHbG1LSEpsYzNWc2RDQTlQVDBnY21WaFkzUnBiMjR1Y0hKdmJXbHpaU2w3WEc0Z0lDQWdJQ0FnSUNBZ0lDQnlaV3BsWTNRb1ZIbHdaVVZ5Y205eUtDZFFjbTl0YVhObExXTm9ZV2x1SUdONVkyeGxKeWtwTzF4dUlDQWdJQ0FnSUNBZ0lIMGdaV3h6WlNCcFppaDBhR1Z1SUQwZ2FYTlVhR1Z1WVdKc1pTaHlaWE4xYkhRcEtYdGNiaUFnSUNBZ0lDQWdJQ0FnSUhSb1pXNHVZMkZzYkNoeVpYTjFiSFFzSUhKbGMyOXNkbVVzSUhKbGFtVmpkQ2s3WEc0Z0lDQWdJQ0FnSUNBZ2ZTQmxiSE5sSUhKbGMyOXNkbVVvY21WemRXeDBLVHRjYmlBZ0lDQWdJQ0FnZlNCbGJITmxJSEpsYW1WamRDaDJZV3gxWlNrN1hHNGdJQ0FnSUNCOUlHTmhkR05vS0dVcGUxeHVJQ0FnSUNBZ0lDQnlaV3BsWTNRb1pTazdYRzRnSUNBZ0lDQjlYRzRnSUNBZ2ZUdGNiaUFnSUNCM2FHbHNaU2hqYUdGcGJpNXNaVzVuZEdnZ1BpQnBLWEoxYmloamFHRnBibHRwS3l0ZEtUc2dMeThnZG1GeWFXRmliR1VnYkdWdVozUm9JQzBnWTJGdUozUWdkWE5sSUdadmNrVmhZMmhjYmlBZ0lDQndjbTl0YVhObExsOWpJRDBnVzEwN1hHNGdJQ0FnY0hKdmJXbHpaUzVmYmlBOUlHWmhiSE5sTzF4dUlDQWdJR2xtS0dselVtVnFaV04wSUNZbUlDRndjbTl0YVhObExsOW9LVzl1Vlc1b1lXNWtiR1ZrS0hCeWIyMXBjMlVwTzF4dUlDQjlLVHRjYm4wN1hHNTJZWElnYjI1VmJtaGhibVJzWldRZ1BTQm1kVzVqZEdsdmJpaHdjbTl0YVhObEtYdGNiaUFnZEdGemF5NWpZV3hzS0dkc2IySmhiQ3dnWm5WdVkzUnBiMjRvS1h0Y2JpQWdJQ0IyWVhJZ2RtRnNkV1VnUFNCd2NtOXRhWE5sTGw5MlhHNGdJQ0FnSUNBc0lHRmljblZ3ZEN3Z2FHRnVaR3hsY2l3Z1kyOXVjMjlzWlR0Y2JpQWdJQ0JwWmlocGMxVnVhR0Z1Wkd4bFpDaHdjbTl0YVhObEtTbDdYRzRnSUNBZ0lDQmhZbkoxY0hRZ1BTQndaWEptYjNKdEtHWjFibU4wYVc5dUtDbDdYRzRnSUNBZ0lDQWdJR2xtS0dselRtOWtaU2w3WEc0Z0lDQWdJQ0FnSUNBZ2NISnZZMlZ6Y3k1bGJXbDBLQ2QxYm1oaGJtUnNaV1JTWldwbFkzUnBiMjRuTENCMllXeDFaU3dnY0hKdmJXbHpaU2s3WEc0Z0lDQWdJQ0FnSUgwZ1pXeHpaU0JwWmlob1lXNWtiR1Z5SUQwZ1oyeHZZbUZzTG05dWRXNW9ZVzVrYkdWa2NtVnFaV04wYVc5dUtYdGNiaUFnSUNBZ0lDQWdJQ0JvWVc1a2JHVnlLSHR3Y205dGFYTmxPaUJ3Y205dGFYTmxMQ0J5WldGemIyNDZJSFpoYkhWbGZTazdYRzRnSUNBZ0lDQWdJSDBnWld4elpTQnBaaWdvWTI5dWMyOXNaU0E5SUdkc2IySmhiQzVqYjI1emIyeGxLU0FtSmlCamIyNXpiMnhsTG1WeWNtOXlLWHRjYmlBZ0lDQWdJQ0FnSUNCamIyNXpiMnhsTG1WeWNtOXlLQ2RWYm1oaGJtUnNaV1FnY0hKdmJXbHpaU0J5WldwbFkzUnBiMjRuTENCMllXeDFaU2s3WEc0Z0lDQWdJQ0FnSUgxY2JpQWdJQ0FnSUgwcE8xeHVJQ0FnSUNBZ0x5OGdRbkp2ZDNObGNuTWdjMmh2ZFd4a0lHNXZkQ0IwY21sbloyVnlJR0J5WldwbFkzUnBiMjVJWVc1a2JHVmtZQ0JsZG1WdWRDQnBaaUJwZENCM1lYTWdhR0Z1Wkd4bFpDQm9aWEpsTENCT2IyUmxTbE1nTFNCemFHOTFiR1JjYmlBZ0lDQWdJSEJ5YjIxcGMyVXVYMmdnUFNCcGMwNXZaR1VnZkh3Z2FYTlZibWhoYm1Sc1pXUW9jSEp2YldselpTa2dQeUF5SURvZ01UdGNiaUFnSUNCOUlIQnliMjFwYzJVdVgyRWdQU0IxYm1SbFptbHVaV1E3WEc0Z0lDQWdhV1lvWVdKeWRYQjBLWFJvY205M0lHRmljblZ3ZEM1bGNuSnZjanRjYmlBZ2ZTazdYRzU5TzF4dWRtRnlJR2x6Vlc1b1lXNWtiR1ZrSUQwZ1puVnVZM1JwYjI0b2NISnZiV2x6WlNsN1hHNGdJR2xtS0hCeWIyMXBjMlV1WDJnZ1BUMGdNU2x5WlhSMWNtNGdabUZzYzJVN1hHNGdJSFpoY2lCamFHRnBiaUE5SUhCeWIyMXBjMlV1WDJFZ2ZId2djSEp2YldselpTNWZZMXh1SUNBZ0lDd2dhU0FnSUNBZ1BTQXdYRzRnSUNBZ0xDQnlaV0ZqZEdsdmJqdGNiaUFnZDJocGJHVW9ZMmhoYVc0dWJHVnVaM1JvSUQ0Z2FTbDdYRzRnSUNBZ2NtVmhZM1JwYjI0Z1BTQmphR0ZwYmx0cEt5dGRPMXh1SUNBZ0lHbG1LSEpsWVdOMGFXOXVMbVpoYVd3Z2ZId2dJV2x6Vlc1b1lXNWtiR1ZrS0hKbFlXTjBhVzl1TG5CeWIyMXBjMlVwS1hKbGRIVnliaUJtWVd4elpUdGNiaUFnZlNCeVpYUjFjbTRnZEhKMVpUdGNibjA3WEc1MllYSWdiMjVJWVc1a2JHVlZibWhoYm1Sc1pXUWdQU0JtZFc1amRHbHZiaWh3Y205dGFYTmxLWHRjYmlBZ2RHRnpheTVqWVd4c0tHZHNiMkpoYkN3Z1puVnVZM1JwYjI0b0tYdGNiaUFnSUNCMllYSWdhR0Z1Wkd4bGNqdGNiaUFnSUNCcFppaHBjMDV2WkdVcGUxeHVJQ0FnSUNBZ2NISnZZMlZ6Y3k1bGJXbDBLQ2R5WldwbFkzUnBiMjVJWVc1a2JHVmtKeXdnY0hKdmJXbHpaU2s3WEc0Z0lDQWdmU0JsYkhObElHbG1LR2hoYm1Sc1pYSWdQU0JuYkc5aVlXd3ViMjV5WldwbFkzUnBiMjVvWVc1a2JHVmtLWHRjYmlBZ0lDQWdJR2hoYm1Sc1pYSW9lM0J5YjIxcGMyVTZJSEJ5YjIxcGMyVXNJSEpsWVhOdmJqb2djSEp2YldselpTNWZkbjBwTzF4dUlDQWdJSDFjYmlBZ2ZTazdYRzU5TzF4dWRtRnlJQ1J5WldwbFkzUWdQU0JtZFc1amRHbHZiaWgyWVd4MVpTbDdYRzRnSUhaaGNpQndjbTl0YVhObElEMGdkR2hwY3p0Y2JpQWdhV1lvY0hKdmJXbHpaUzVmWkNseVpYUjFjbTQ3WEc0Z0lIQnliMjFwYzJVdVgyUWdQU0IwY25WbE8xeHVJQ0J3Y205dGFYTmxJRDBnY0hKdmJXbHpaUzVmZHlCOGZDQndjbTl0YVhObE95QXZMeUIxYm5keVlYQmNiaUFnY0hKdmJXbHpaUzVmZGlBOUlIWmhiSFZsTzF4dUlDQndjbTl0YVhObExsOXpJRDBnTWp0Y2JpQWdhV1lvSVhCeWIyMXBjMlV1WDJFcGNISnZiV2x6WlM1ZllTQTlJSEJ5YjIxcGMyVXVYMk11YzJ4cFkyVW9LVHRjYmlBZ2JtOTBhV1o1S0hCeWIyMXBjMlVzSUhSeWRXVXBPMXh1ZlR0Y2JuWmhjaUFrY21WemIyeDJaU0E5SUdaMWJtTjBhVzl1S0haaGJIVmxLWHRjYmlBZ2RtRnlJSEJ5YjIxcGMyVWdQU0IwYUdselhHNGdJQ0FnTENCMGFHVnVPMXh1SUNCcFppaHdjbTl0YVhObExsOWtLWEpsZEhWeWJqdGNiaUFnY0hKdmJXbHpaUzVmWkNBOUlIUnlkV1U3WEc0Z0lIQnliMjFwYzJVZ1BTQndjbTl0YVhObExsOTNJSHg4SUhCeWIyMXBjMlU3SUM4dklIVnVkM0poY0Z4dUlDQjBjbmtnZTF4dUlDQWdJR2xtS0hCeWIyMXBjMlVnUFQwOUlIWmhiSFZsS1hSb2NtOTNJRlI1Y0dWRmNuSnZjaWhjSWxCeWIyMXBjMlVnWTJGdUozUWdZbVVnY21WemIyeDJaV1FnYVhSelpXeG1YQ0lwTzF4dUlDQWdJR2xtS0hSb1pXNGdQU0JwYzFSb1pXNWhZbXhsS0haaGJIVmxLU2w3WEc0Z0lDQWdJQ0J0YVdOeWIzUmhjMnNvWm5WdVkzUnBiMjRvS1h0Y2JpQWdJQ0FnSUNBZ2RtRnlJSGR5WVhCd1pYSWdQU0I3WDNjNklIQnliMjFwYzJVc0lGOWtPaUJtWVd4elpYMDdJQzh2SUhkeVlYQmNiaUFnSUNBZ0lDQWdkSEo1SUh0Y2JpQWdJQ0FnSUNBZ0lDQjBhR1Z1TG1OaGJHd29kbUZzZFdVc0lHTjBlQ2drY21WemIyeDJaU3dnZDNKaGNIQmxjaXdnTVNrc0lHTjBlQ2drY21WcVpXTjBMQ0IzY21Gd2NHVnlMQ0F4S1NrN1hHNGdJQ0FnSUNBZ0lIMGdZMkYwWTJnb1pTbDdYRzRnSUNBZ0lDQWdJQ0FnSkhKbGFtVmpkQzVqWVd4c0tIZHlZWEJ3WlhJc0lHVXBPMXh1SUNBZ0lDQWdJQ0I5WEc0Z0lDQWdJQ0I5S1R0Y2JpQWdJQ0I5SUdWc2MyVWdlMXh1SUNBZ0lDQWdjSEp2YldselpTNWZkaUE5SUhaaGJIVmxPMXh1SUNBZ0lDQWdjSEp2YldselpTNWZjeUE5SURFN1hHNGdJQ0FnSUNCdWIzUnBabmtvY0hKdmJXbHpaU3dnWm1Gc2MyVXBPMXh1SUNBZ0lIMWNiaUFnZlNCallYUmphQ2hsS1h0Y2JpQWdJQ0FrY21WcVpXTjBMbU5oYkd3b2UxOTNPaUJ3Y205dGFYTmxMQ0JmWkRvZ1ptRnNjMlY5TENCbEtUc2dMeThnZDNKaGNGeHVJQ0I5WEc1OU8xeHVYRzR2THlCamIyNXpkSEoxWTNSdmNpQndiMng1Wm1sc2JGeHVhV1lvSVZWVFJWOU9RVlJKVmtVcGUxeHVJQ0F2THlBeU5TNDBMak11TVNCUWNtOXRhWE5sS0dWNFpXTjFkRzl5S1Z4dUlDQWtVSEp2YldselpTQTlJR1oxYm1OMGFXOXVJRkJ5YjIxcGMyVW9aWGhsWTNWMGIzSXBlMXh1SUNBZ0lHRnVTVzV6ZEdGdVkyVW9kR2hwY3l3Z0pGQnliMjFwYzJVc0lGQlNUMDFKVTBVc0lDZGZhQ2NwTzF4dUlDQWdJR0ZHZFc1amRHbHZiaWhsZUdWamRYUnZjaWs3WEc0Z0lDQWdTVzUwWlhKdVlXd3VZMkZzYkNoMGFHbHpLVHRjYmlBZ0lDQjBjbmtnZTF4dUlDQWdJQ0FnWlhobFkzVjBiM0lvWTNSNEtDUnlaWE52YkhabExDQjBhR2x6TENBeEtTd2dZM1I0S0NSeVpXcGxZM1FzSUhSb2FYTXNJREVwS1R0Y2JpQWdJQ0I5SUdOaGRHTm9LR1Z5Y2lsN1hHNGdJQ0FnSUNBa2NtVnFaV04wTG1OaGJHd29kR2hwY3l3Z1pYSnlLVHRjYmlBZ0lDQjlYRzRnSUgwN1hHNGdJRWx1ZEdWeWJtRnNJRDBnWm5WdVkzUnBiMjRnVUhKdmJXbHpaU2hsZUdWamRYUnZjaWw3WEc0Z0lDQWdkR2hwY3k1Zll5QTlJRnRkT3lBZ0lDQWdJQ0FnSUNBZ0lDQXZMeUE4TFNCaGQyRnBkR2x1WnlCeVpXRmpkR2x2Ym5OY2JpQWdJQ0IwYUdsekxsOWhJRDBnZFc1a1pXWnBibVZrT3lBZ0lDQWdJQzh2SUR3dElHTm9aV05yWldRZ2FXNGdhWE5WYm1oaGJtUnNaV1FnY21WaFkzUnBiMjV6WEc0Z0lDQWdkR2hwY3k1ZmN5QTlJREE3SUNBZ0lDQWdJQ0FnSUNBZ0lDQXZMeUE4TFNCemRHRjBaVnh1SUNBZ0lIUm9hWE11WDJRZ1BTQm1ZV3h6WlRzZ0lDQWdJQ0FnSUNBZ0x5OGdQQzBnWkc5dVpWeHVJQ0FnSUhSb2FYTXVYM1lnUFNCMWJtUmxabWx1WldRN0lDQWdJQ0FnTHk4Z1BDMGdkbUZzZFdWY2JpQWdJQ0IwYUdsekxsOW9JRDBnTURzZ0lDQWdJQ0FnSUNBZ0lDQWdJQzh2SUR3dElISmxhbVZqZEdsdmJpQnpkR0YwWlN3Z01DQXRJR1JsWm1GMWJIUXNJREVnTFNCb1lXNWtiR1ZrTENBeUlDMGdkVzVvWVc1a2JHVmtYRzRnSUNBZ2RHaHBjeTVmYmlBOUlHWmhiSE5sT3lBZ0lDQWdJQ0FnSUNBdkx5QThMU0J1YjNScFpubGNiaUFnZlR0Y2JpQWdTVzUwWlhKdVlXd3VjSEp2ZEc5MGVYQmxJRDBnY21WeGRXbHlaU2duTGk5ZmNtVmtaV1pwYm1VdFlXeHNKeWtvSkZCeWIyMXBjMlV1Y0hKdmRHOTBlWEJsTENCN1hHNGdJQ0FnTHk4Z01qVXVOQzQxTGpNZ1VISnZiV2x6WlM1d2NtOTBiM1I1Y0dVdWRHaGxiaWh2YmtaMWJHWnBiR3hsWkN3Z2IyNVNaV3BsWTNSbFpDbGNiaUFnSUNCMGFHVnVPaUJtZFc1amRHbHZiaUIwYUdWdUtHOXVSblZzWm1sc2JHVmtMQ0J2YmxKbGFtVmpkR1ZrS1h0Y2JpQWdJQ0FnSUhaaGNpQnlaV0ZqZEdsdmJpQWdJQ0E5SUc1bGQxQnliMjFwYzJWRFlYQmhZbWxzYVhSNUtITndaV05wWlhORGIyNXpkSEoxWTNSdmNpaDBhR2x6TENBa1VISnZiV2x6WlNrcE8xeHVJQ0FnSUNBZ2NtVmhZM1JwYjI0dWIyc2dJQ0FnSUQwZ2RIbHdaVzltSUc5dVJuVnNabWxzYkdWa0lEMDlJQ2RtZFc1amRHbHZiaWNnUHlCdmJrWjFiR1pwYkd4bFpDQTZJSFJ5ZFdVN1hHNGdJQ0FnSUNCeVpXRmpkR2x2Ymk1bVlXbHNJQ0FnUFNCMGVYQmxiMllnYjI1U1pXcGxZM1JsWkNBOVBTQW5ablZ1WTNScGIyNG5JQ1ltSUc5dVVtVnFaV04wWldRN1hHNGdJQ0FnSUNCeVpXRmpkR2x2Ymk1a2IyMWhhVzRnUFNCcGMwNXZaR1VnUHlCd2NtOWpaWE56TG1SdmJXRnBiaUE2SUhWdVpHVm1hVzVsWkR0Y2JpQWdJQ0FnSUhSb2FYTXVYMk11Y0hWemFDaHlaV0ZqZEdsdmJpazdYRzRnSUNBZ0lDQnBaaWgwYUdsekxsOWhLWFJvYVhNdVgyRXVjSFZ6YUNoeVpXRmpkR2x2YmlrN1hHNGdJQ0FnSUNCcFppaDBhR2x6TGw5ektXNXZkR2xtZVNoMGFHbHpMQ0JtWVd4elpTazdYRzRnSUNBZ0lDQnlaWFIxY200Z2NtVmhZM1JwYjI0dWNISnZiV2x6WlR0Y2JpQWdJQ0I5TEZ4dUlDQWdJQzh2SURJMUxqUXVOUzR4SUZCeWIyMXBjMlV1Y0hKdmRHOTBlWEJsTG1OaGRHTm9LRzl1VW1WcVpXTjBaV1FwWEc0Z0lDQWdKMk5oZEdOb0p6b2dablZ1WTNScGIyNG9iMjVTWldwbFkzUmxaQ2w3WEc0Z0lDQWdJQ0J5WlhSMWNtNGdkR2hwY3k1MGFHVnVLSFZ1WkdWbWFXNWxaQ3dnYjI1U1pXcGxZM1JsWkNrN1hHNGdJQ0FnZlZ4dUlDQjlLVHRjYmlBZ1VISnZiV2x6WlVOaGNHRmlhV3hwZEhrZ1BTQm1kVzVqZEdsdmJpZ3BlMXh1SUNBZ0lIWmhjaUJ3Y205dGFYTmxJQ0E5SUc1bGR5QkpiblJsY201aGJEdGNiaUFnSUNCMGFHbHpMbkJ5YjIxcGMyVWdQU0J3Y205dGFYTmxPMXh1SUNBZ0lIUm9hWE11Y21WemIyeDJaU0E5SUdOMGVDZ2tjbVZ6YjJ4MlpTd2djSEp2YldselpTd2dNU2s3WEc0Z0lDQWdkR2hwY3k1eVpXcGxZM1FnSUQwZ1kzUjRLQ1J5WldwbFkzUXNJSEJ5YjIxcGMyVXNJREVwTzF4dUlDQjlPMXh1ZlZ4dVhHNGtaWGh3YjNKMEtDUmxlSEJ2Y25RdVJ5QXJJQ1JsZUhCdmNuUXVWeUFySUNSbGVIQnZjblF1UmlBcUlDRlZVMFZmVGtGVVNWWkZMQ0I3VUhKdmJXbHpaVG9nSkZCeWIyMXBjMlY5S1R0Y2JuSmxjWFZwY21Vb0p5NHZYM05sZEMxMGJ5MXpkSEpwYm1jdGRHRm5KeWtvSkZCeWIyMXBjMlVzSUZCU1QwMUpVMFVwTzF4dWNtVnhkV2x5WlNnbkxpOWZjMlYwTFhOd1pXTnBaWE1uS1NoUVVrOU5TVk5GS1R0Y2JsZHlZWEJ3WlhJZ1BTQnlaWEYxYVhKbEtDY3VMMTlqYjNKbEp5bGJVRkpQVFVsVFJWMDdYRzVjYmk4dklITjBZWFJwWTNOY2JpUmxlSEJ2Y25Rb0pHVjRjRzl5ZEM1VElDc2dKR1Y0Y0c5eWRDNUdJQ29nSVZWVFJWOU9RVlJKVmtVc0lGQlNUMDFKVTBVc0lIdGNiaUFnTHk4Z01qVXVOQzQwTGpVZ1VISnZiV2x6WlM1eVpXcGxZM1FvY2lsY2JpQWdjbVZxWldOME9pQm1kVzVqZEdsdmJpQnlaV3BsWTNRb2NpbDdYRzRnSUNBZ2RtRnlJR05oY0dGaWFXeHBkSGtnUFNCdVpYZFFjbTl0YVhObFEyRndZV0pwYkdsMGVTaDBhR2x6S1Z4dUlDQWdJQ0FnTENBa0pISmxhbVZqZENBZ0lEMGdZMkZ3WVdKcGJHbDBlUzV5WldwbFkzUTdYRzRnSUNBZ0pDUnlaV3BsWTNRb2NpazdYRzRnSUNBZ2NtVjBkWEp1SUdOaGNHRmlhV3hwZEhrdWNISnZiV2x6WlR0Y2JpQWdmVnh1ZlNrN1hHNGtaWGh3YjNKMEtDUmxlSEJ2Y25RdVV5QXJJQ1JsZUhCdmNuUXVSaUFxSUNoTVNVSlNRVkpaSUh4OElDRlZVMFZmVGtGVVNWWkZLU3dnVUZKUFRVbFRSU3dnZTF4dUlDQXZMeUF5TlM0MExqUXVOaUJRY205dGFYTmxMbkpsYzI5c2RtVW9lQ2xjYmlBZ2NtVnpiMngyWlRvZ1puVnVZM1JwYjI0Z2NtVnpiMngyWlNoNEtYdGNiaUFnSUNBdkx5QnBibk4wWVc1alpXOW1JR2x1YzNSbFlXUWdiMllnYVc1MFpYSnVZV3dnYzJ4dmRDQmphR1ZqYXlCaVpXTmhkWE5sSUhkbElITm9iM1ZzWkNCbWFYZ2dhWFFnZDJsMGFHOTFkQ0J5WlhCc1lXTmxiV1Z1ZENCdVlYUnBkbVVnVUhKdmJXbHpaU0JqYjNKbFhHNGdJQ0FnYVdZb2VDQnBibk4wWVc1alpXOW1JQ1JRY205dGFYTmxJQ1ltSUhOaGJXVkRiMjV6ZEhKMVkzUnZjaWg0TG1OdmJuTjBjblZqZEc5eUxDQjBhR2x6S1NseVpYUjFjbTRnZUR0Y2JpQWdJQ0IyWVhJZ1kyRndZV0pwYkdsMGVTQTlJRzVsZDFCeWIyMXBjMlZEWVhCaFltbHNhWFI1S0hSb2FYTXBYRzRnSUNBZ0lDQXNJQ1FrY21WemIyeDJaU0FnUFNCallYQmhZbWxzYVhSNUxuSmxjMjlzZG1VN1hHNGdJQ0FnSkNSeVpYTnZiSFpsS0hncE8xeHVJQ0FnSUhKbGRIVnliaUJqWVhCaFltbHNhWFI1TG5CeWIyMXBjMlU3WEc0Z0lIMWNibjBwTzF4dUpHVjRjRzl5ZENna1pYaHdiM0owTGxNZ0t5QWtaWGh3YjNKMExrWWdLaUFoS0ZWVFJWOU9RVlJKVmtVZ0ppWWdjbVZ4ZFdseVpTZ25MaTlmYVhSbGNpMWtaWFJsWTNRbktTaG1kVzVqZEdsdmJpaHBkR1Z5S1h0Y2JpQWdKRkJ5YjIxcGMyVXVZV3hzS0dsMFpYSXBXeWRqWVhSamFDZGRLR1Z0Y0hSNUtUdGNibjBwS1N3Z1VGSlBUVWxUUlN3Z2UxeHVJQ0F2THlBeU5TNDBMalF1TVNCUWNtOXRhWE5sTG1Gc2JDaHBkR1Z5WVdKc1pTbGNiaUFnWVd4c09pQm1kVzVqZEdsdmJpQmhiR3dvYVhSbGNtRmliR1VwZTF4dUlDQWdJSFpoY2lCRElDQWdJQ0FnSUNBZ0lEMGdkR2hwYzF4dUlDQWdJQ0FnTENCallYQmhZbWxzYVhSNUlEMGdibVYzVUhKdmJXbHpaVU5oY0dGaWFXeHBkSGtvUXlsY2JpQWdJQ0FnSUN3Z2NtVnpiMngyWlNBZ0lDQTlJR05oY0dGaWFXeHBkSGt1Y21WemIyeDJaVnh1SUNBZ0lDQWdMQ0J5WldwbFkzUWdJQ0FnSUQwZ1kyRndZV0pwYkdsMGVTNXlaV3BsWTNRN1hHNGdJQ0FnZG1GeUlHRmljblZ3ZENBOUlIQmxjbVp2Y20wb1puVnVZM1JwYjI0b0tYdGNiaUFnSUNBZ0lIWmhjaUIyWVd4MVpYTWdJQ0FnUFNCYlhWeHVJQ0FnSUNBZ0lDQXNJR2x1WkdWNElDQWdJQ0E5SURCY2JpQWdJQ0FnSUNBZ0xDQnlaVzFoYVc1cGJtY2dQU0F4TzF4dUlDQWdJQ0FnWm05eVQyWW9hWFJsY21GaWJHVXNJR1poYkhObExDQm1kVzVqZEdsdmJpaHdjbTl0YVhObEtYdGNiaUFnSUNBZ0lDQWdkbUZ5SUNScGJtUmxlQ0FnSUNBZ0lDQWdQU0JwYm1SbGVDc3JYRzRnSUNBZ0lDQWdJQ0FnTENCaGJISmxZV1I1UTJGc2JHVmtJRDBnWm1Gc2MyVTdYRzRnSUNBZ0lDQWdJSFpoYkhWbGN5NXdkWE5vS0hWdVpHVm1hVzVsWkNrN1hHNGdJQ0FnSUNBZ0lISmxiV0ZwYm1sdVp5c3JPMXh1SUNBZ0lDQWdJQ0JETG5KbGMyOXNkbVVvY0hKdmJXbHpaU2t1ZEdobGJpaG1kVzVqZEdsdmJpaDJZV3gxWlNsN1hHNGdJQ0FnSUNBZ0lDQWdhV1lvWVd4eVpXRmtlVU5oYkd4bFpDbHlaWFIxY200N1hHNGdJQ0FnSUNBZ0lDQWdZV3h5WldGa2VVTmhiR3hsWkNBZ1BTQjBjblZsTzF4dUlDQWdJQ0FnSUNBZ0lIWmhiSFZsYzFza2FXNWtaWGhkSUQwZ2RtRnNkV1U3WEc0Z0lDQWdJQ0FnSUNBZ0xTMXlaVzFoYVc1cGJtY2dmSHdnY21WemIyeDJaU2gyWVd4MVpYTXBPMXh1SUNBZ0lDQWdJQ0I5TENCeVpXcGxZM1FwTzF4dUlDQWdJQ0FnZlNrN1hHNGdJQ0FnSUNBdExYSmxiV0ZwYm1sdVp5QjhmQ0J5WlhOdmJIWmxLSFpoYkhWbGN5azdYRzRnSUNBZ2ZTazdYRzRnSUNBZ2FXWW9ZV0p5ZFhCMEtYSmxhbVZqZENoaFluSjFjSFF1WlhKeWIzSXBPMXh1SUNBZ0lISmxkSFZ5YmlCallYQmhZbWxzYVhSNUxuQnliMjFwYzJVN1hHNGdJSDBzWEc0Z0lDOHZJREkxTGpRdU5DNDBJRkJ5YjIxcGMyVXVjbUZqWlNocGRHVnlZV0pzWlNsY2JpQWdjbUZqWlRvZ1puVnVZM1JwYjI0Z2NtRmpaU2hwZEdWeVlXSnNaU2w3WEc0Z0lDQWdkbUZ5SUVNZ0lDQWdJQ0FnSUNBZ1BTQjBhR2x6WEc0Z0lDQWdJQ0FzSUdOaGNHRmlhV3hwZEhrZ1BTQnVaWGRRY205dGFYTmxRMkZ3WVdKcGJHbDBlU2hES1Z4dUlDQWdJQ0FnTENCeVpXcGxZM1FnSUNBZ0lEMGdZMkZ3WVdKcGJHbDBlUzV5WldwbFkzUTdYRzRnSUNBZ2RtRnlJR0ZpY25Wd2RDQTlJSEJsY21admNtMG9ablZ1WTNScGIyNG9LWHRjYmlBZ0lDQWdJR1p2Y2s5bUtHbDBaWEpoWW14bExDQm1ZV3h6WlN3Z1puVnVZM1JwYjI0b2NISnZiV2x6WlNsN1hHNGdJQ0FnSUNBZ0lFTXVjbVZ6YjJ4MlpTaHdjbTl0YVhObEtTNTBhR1Z1S0dOaGNHRmlhV3hwZEhrdWNtVnpiMngyWlN3Z2NtVnFaV04wS1R0Y2JpQWdJQ0FnSUgwcE8xeHVJQ0FnSUgwcE8xeHVJQ0FnSUdsbUtHRmljblZ3ZENseVpXcGxZM1FvWVdKeWRYQjBMbVZ5Y205eUtUdGNiaUFnSUNCeVpYUjFjbTRnWTJGd1lXSnBiR2wwZVM1d2NtOXRhWE5sTzF4dUlDQjlYRzU5S1R0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZaWE0yTG5CeWIyMXBjMlV1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURFd05WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBMElEVWlMQ0luZFhObElITjBjbWxqZENjN1hHNHZMeUJGUTAxQlUyTnlhWEIwSURZZ2MzbHRZbTlzY3lCemFHbHRYRzUyWVhJZ1oyeHZZbUZzSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOW5iRzlpWVd3bktWeHVJQ0FzSUdoaGN5QWdJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmFHRnpKeWxjYmlBZ0xDQkVSVk5EVWtsUVZFOVNVeUFnSUNBOUlISmxjWFZwY21Vb0p5NHZYMlJsYzJOeWFYQjBiM0p6SnlsY2JpQWdMQ0FrWlhod2IzSjBJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJWNGNHOXlkQ2NwWEc0Z0lDd2djbVZrWldacGJtVWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTl5WldSbFptbHVaU2NwWEc0Z0lDd2dUVVZVUVNBZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTl0WlhSaEp5a3VTMFZaWEc0Z0lDd2dKR1poYVd4eklDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTltWVdsc2N5Y3BYRzRnSUN3Z2MyaGhjbVZrSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXphR0Z5WldRbktWeHVJQ0FzSUhObGRGUnZVM1J5YVc1blZHRm5JRDBnY21WeGRXbHlaU2duTGk5ZmMyVjBMWFJ2TFhOMGNtbHVaeTEwWVdjbktWeHVJQ0FzSUhWcFpDQWdJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmRXbGtKeWxjYmlBZ0xDQjNhM01nSUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYM2RyY3ljcFhHNGdJQ3dnZDJ0elJYaDBJQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5M2EzTXRaWGgwSnlsY2JpQWdMQ0IzYTNORVpXWnBibVVnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDNkcmN5MWtaV1pwYm1VbktWeHVJQ0FzSUd0bGVVOW1JQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmEyVjViMlluS1Z4dUlDQXNJR1Z1ZFcxTFpYbHpJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmWlc1MWJTMXJaWGx6SnlsY2JpQWdMQ0JwYzBGeWNtRjVJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJsekxXRnljbUY1SnlsY2JpQWdMQ0JoYms5aWFtVmpkQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJGdUxXOWlhbVZqZENjcFhHNGdJQ3dnZEc5SlQySnFaV04wSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXBiMkpxWldOMEp5bGNiaUFnTENCMGIxQnlhVzFwZEdsMlpTQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzUnZMWEJ5YVcxcGRHbDJaU2NwWEc0Z0lDd2dZM0psWVhSbFJHVnpZeUFnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTl3Y205d1pYSjBlUzFrWlhOakp5bGNiaUFnTENCZlkzSmxZWFJsSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxamNtVmhkR1VuS1Z4dUlDQXNJR2RQVUU1RmVIUWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMV2R2Y0c0dFpYaDBKeWxjYmlBZ0xDQWtSMDlRUkNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMW5iM0JrSnlsY2JpQWdMQ0FrUkZBZ0lDQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzFrY0NjcFhHNGdJQ3dnSkd0bGVYTWdJQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0YTJWNWN5Y3BYRzRnSUN3Z1owOVFSQ0FnSUNBZ0lDQWdJQ0FnUFNBa1IwOVFSQzVtWEc0Z0lDd2daRkFnSUNBZ0lDQWdJQ0FnSUNBZ1BTQWtSRkF1Wmx4dUlDQXNJR2RQVUU0Z0lDQWdJQ0FnSUNBZ0lEMGdaMDlRVGtWNGRDNW1YRzRnSUN3Z0pGTjViV0p2YkNBZ0lDQWdJQ0FnUFNCbmJHOWlZV3d1VTNsdFltOXNYRzRnSUN3Z0pFcFRUMDRnSUNBZ0lDQWdJQ0FnUFNCbmJHOWlZV3d1U2xOUFRseHVJQ0FzSUY5emRISnBibWRwWm5rZ0lDQWdJRDBnSkVwVFQwNGdKaVlnSkVwVFQwNHVjM1J5YVc1bmFXWjVYRzRnSUN3Z1VGSlBWRTlVV1ZCRklDQWdJQ0FnUFNBbmNISnZkRzkwZVhCbEoxeHVJQ0FzSUVoSlJFUkZUaUFnSUNBZ0lDQWdJRDBnZDJ0ektDZGZhR2xrWkdWdUp5bGNiaUFnTENCVVQxOVFVa2xOU1ZSSlZrVWdJQ0E5SUhkcmN5Z25kRzlRY21sdGFYUnBkbVVuS1Z4dUlDQXNJR2x6Ulc1MWJTQWdJQ0FnSUNBZ0lEMGdlMzB1Y0hKdmNHVnlkSGxKYzBWdWRXMWxjbUZpYkdWY2JpQWdMQ0JUZVcxaWIyeFNaV2RwYzNSeWVTQTlJSE5vWVhKbFpDZ25jM2x0WW05c0xYSmxaMmx6ZEhKNUp5bGNiaUFnTENCQmJHeFRlVzFpYjJ4eklDQWdJQ0E5SUhOb1lYSmxaQ2duYzNsdFltOXNjeWNwWEc0Z0lDd2dUMUJUZVcxaWIyeHpJQ0FnSUNBZ1BTQnphR0Z5WldRb0oyOXdMWE41YldKdmJITW5LVnh1SUNBc0lFOWlhbVZqZEZCeWIzUnZJQ0FnSUQwZ1QySnFaV04wVzFCU1QxUlBWRmxRUlYxY2JpQWdMQ0JWVTBWZlRrRlVTVlpGSUNBZ0lDQTlJSFI1Y0dWdlppQWtVM2x0WW05c0lEMDlJQ2RtZFc1amRHbHZiaWRjYmlBZ0xDQlJUMkpxWldOMElDQWdJQ0FnSUNBOUlHZHNiMkpoYkM1UlQySnFaV04wTzF4dUx5OGdSRzl1SjNRZ2RYTmxJSE5sZEhSbGNuTWdhVzRnVVhRZ1UyTnlhWEIwTENCb2RIUndjem92TDJkcGRHaDFZaTVqYjIwdmVteHZhWEp2WTJzdlkyOXlaUzFxY3k5cGMzTjFaWE12TVRjelhHNTJZWElnYzJWMGRHVnlJRDBnSVZGUFltcGxZM1FnZkh3Z0lWRlBZbXBsWTNSYlVGSlBWRTlVV1ZCRlhTQjhmQ0FoVVU5aWFtVmpkRnRRVWs5VVQxUlpVRVZkTG1acGJtUkRhR2xzWkR0Y2JseHVMeThnWm1Gc2JHSmhZMnNnWm05eUlHOXNaQ0JCYm1SeWIybGtMQ0JvZEhSd2N6b3ZMMk52WkdVdVoyOXZaMnhsTG1OdmJTOXdMM1k0TDJsemMzVmxjeTlrWlhSaGFXdy9hV1E5TmpnM1hHNTJZWElnYzJWMFUzbHRZbTlzUkdWell5QTlJRVJGVTBOU1NWQlVUMUpUSUNZbUlDUm1ZV2xzY3lobWRXNWpkR2x2YmlncGUxeHVJQ0J5WlhSMWNtNGdYMk55WldGMFpTaGtVQ2g3ZlN3Z0oyRW5MQ0I3WEc0Z0lDQWdaMlYwT2lCbWRXNWpkR2x2YmlncGV5QnlaWFIxY200Z1pGQW9kR2hwY3l3Z0oyRW5MQ0I3ZG1Gc2RXVTZJRGQ5S1M1aE95QjlYRzRnSUgwcEtTNWhJQ0U5SURjN1hHNTlLU0EvSUdaMWJtTjBhVzl1S0dsMExDQnJaWGtzSUVRcGUxeHVJQ0IyWVhJZ2NISnZkRzlFWlhOaklEMGdaMDlRUkNoUFltcGxZM1JRY205MGJ5d2dhMlY1S1R0Y2JpQWdhV1lvY0hKdmRHOUVaWE5qS1dSbGJHVjBaU0JQWW1wbFkzUlFjbTkwYjF0clpYbGRPMXh1SUNCa1VDaHBkQ3dnYTJWNUxDQkVLVHRjYmlBZ2FXWW9jSEp2ZEc5RVpYTmpJQ1ltSUdsMElDRTlQU0JQWW1wbFkzUlFjbTkwYnlsa1VDaFBZbXBsWTNSUWNtOTBieXdnYTJWNUxDQndjbTkwYjBSbGMyTXBPMXh1ZlNBNklHUlFPMXh1WEc1MllYSWdkM0poY0NBOUlHWjFibU4wYVc5dUtIUmhaeWw3WEc0Z0lIWmhjaUJ6ZVcwZ1BTQkJiR3hUZVcxaWIyeHpXM1JoWjEwZ1BTQmZZM0psWVhSbEtDUlRlVzFpYjJ4YlVGSlBWRTlVV1ZCRlhTazdYRzRnSUhONWJTNWZheUE5SUhSaFp6dGNiaUFnY21WMGRYSnVJSE41YlR0Y2JuMDdYRzVjYm5aaGNpQnBjMU41YldKdmJDQTlJRlZUUlY5T1FWUkpWa1VnSmlZZ2RIbHdaVzltSUNSVGVXMWliMnd1YVhSbGNtRjBiM0lnUFQwZ0ozTjViV0p2YkNjZ1B5Qm1kVzVqZEdsdmJpaHBkQ2w3WEc0Z0lISmxkSFZ5YmlCMGVYQmxiMllnYVhRZ1BUMGdKM041YldKdmJDYzdYRzU5SURvZ1puVnVZM1JwYjI0b2FYUXBlMXh1SUNCeVpYUjFjbTRnYVhRZ2FXNXpkR0Z1WTJWdlppQWtVM2x0WW05c08xeHVmVHRjYmx4dWRtRnlJQ1JrWldacGJtVlFjbTl3WlhKMGVTQTlJR1oxYm1OMGFXOXVJR1JsWm1sdVpWQnliM0JsY25SNUtHbDBMQ0JyWlhrc0lFUXBlMXh1SUNCcFppaHBkQ0E5UFQwZ1QySnFaV04wVUhKdmRHOHBKR1JsWm1sdVpWQnliM0JsY25SNUtFOVFVM2x0WW05c2N5d2dhMlY1TENCRUtUdGNiaUFnWVc1UFltcGxZM1FvYVhRcE8xeHVJQ0JyWlhrZ1BTQjBiMUJ5YVcxcGRHbDJaU2hyWlhrc0lIUnlkV1VwTzF4dUlDQmhiazlpYW1WamRDaEVLVHRjYmlBZ2FXWW9hR0Z6S0VGc2JGTjViV0p2YkhNc0lHdGxlU2twZTF4dUlDQWdJR2xtS0NGRUxtVnVkVzFsY21GaWJHVXBlMXh1SUNBZ0lDQWdhV1lvSVdoaGN5aHBkQ3dnU0VsRVJFVk9LU2xrVUNocGRDd2dTRWxFUkVWT0xDQmpjbVZoZEdWRVpYTmpLREVzSUh0OUtTazdYRzRnSUNBZ0lDQnBkRnRJU1VSRVJVNWRXMnRsZVYwZ1BTQjBjblZsTzF4dUlDQWdJSDBnWld4elpTQjdYRzRnSUNBZ0lDQnBaaWhvWVhNb2FYUXNJRWhKUkVSRlRpa2dKaVlnYVhSYlNFbEVSRVZPWFZ0clpYbGRLV2wwVzBoSlJFUkZUbDFiYTJWNVhTQTlJR1poYkhObE8xeHVJQ0FnSUNBZ1JDQTlJRjlqY21WaGRHVW9SQ3dnZTJWdWRXMWxjbUZpYkdVNklHTnlaV0YwWlVSbGMyTW9NQ3dnWm1Gc2MyVXBmU2s3WEc0Z0lDQWdmU0J5WlhSMWNtNGdjMlYwVTNsdFltOXNSR1Z6WXlocGRDd2dhMlY1TENCRUtUdGNiaUFnZlNCeVpYUjFjbTRnWkZBb2FYUXNJR3RsZVN3Z1JDazdYRzU5TzF4dWRtRnlJQ1JrWldacGJtVlFjbTl3WlhKMGFXVnpJRDBnWm5WdVkzUnBiMjRnWkdWbWFXNWxVSEp2Y0dWeWRHbGxjeWhwZEN3Z1VDbDdYRzRnSUdGdVQySnFaV04wS0dsMEtUdGNiaUFnZG1GeUlHdGxlWE1nUFNCbGJuVnRTMlY1Y3loUUlEMGdkRzlKVDJKcVpXTjBLRkFwS1Z4dUlDQWdJQ3dnYVNBZ0lDQTlJREJjYmlBZ0lDQXNJR3dnUFNCclpYbHpMbXhsYm1kMGFGeHVJQ0FnSUN3Z2EyVjVPMXh1SUNCM2FHbHNaU2hzSUQ0Z2FTa2taR1ZtYVc1bFVISnZjR1Z5ZEhrb2FYUXNJR3RsZVNBOUlHdGxlWE5iYVNzclhTd2dVRnRyWlhsZEtUdGNiaUFnY21WMGRYSnVJR2wwTzF4dWZUdGNiblpoY2lBa1kzSmxZWFJsSUQwZ1puVnVZM1JwYjI0Z1kzSmxZWFJsS0dsMExDQlFLWHRjYmlBZ2NtVjBkWEp1SUZBZ1BUMDlJSFZ1WkdWbWFXNWxaQ0EvSUY5amNtVmhkR1VvYVhRcElEb2dKR1JsWm1sdVpWQnliM0JsY25ScFpYTW9YMk55WldGMFpTaHBkQ2tzSUZBcE8xeHVmVHRjYm5aaGNpQWtjSEp2Y0dWeWRIbEpjMFZ1ZFcxbGNtRmliR1VnUFNCbWRXNWpkR2x2YmlCd2NtOXdaWEowZVVselJXNTFiV1Z5WVdKc1pTaHJaWGtwZTF4dUlDQjJZWElnUlNBOUlHbHpSVzUxYlM1allXeHNLSFJvYVhNc0lHdGxlU0E5SUhSdlVISnBiV2wwYVhabEtHdGxlU3dnZEhKMVpTa3BPMXh1SUNCcFppaDBhR2x6SUQwOVBTQlBZbXBsWTNSUWNtOTBieUFtSmlCb1lYTW9RV3hzVTNsdFltOXNjeXdnYTJWNUtTQW1KaUFoYUdGektFOVFVM2x0WW05c2N5d2dhMlY1S1NseVpYUjFjbTRnWm1Gc2MyVTdYRzRnSUhKbGRIVnliaUJGSUh4OElDRm9ZWE1vZEdocGN5d2dhMlY1S1NCOGZDQWhhR0Z6S0VGc2JGTjViV0p2YkhNc0lHdGxlU2tnZkh3Z2FHRnpLSFJvYVhNc0lFaEpSRVJGVGlrZ0ppWWdkR2hwYzF0SVNVUkVSVTVkVzJ0bGVWMGdQeUJGSURvZ2RISjFaVHRjYm4wN1hHNTJZWElnSkdkbGRFOTNibEJ5YjNCbGNuUjVSR1Z6WTNKcGNIUnZjaUE5SUdaMWJtTjBhVzl1SUdkbGRFOTNibEJ5YjNCbGNuUjVSR1Z6WTNKcGNIUnZjaWhwZEN3Z2EyVjVLWHRjYmlBZ2FYUWdJRDBnZEc5SlQySnFaV04wS0dsMEtUdGNiaUFnYTJWNUlEMGdkRzlRY21sdGFYUnBkbVVvYTJWNUxDQjBjblZsS1R0Y2JpQWdhV1lvYVhRZ1BUMDlJRTlpYW1WamRGQnliM1J2SUNZbUlHaGhjeWhCYkd4VGVXMWliMnh6TENCclpYa3BJQ1ltSUNGb1lYTW9UMUJUZVcxaWIyeHpMQ0JyWlhrcEtYSmxkSFZ5Ymp0Y2JpQWdkbUZ5SUVRZ1BTQm5UMUJFS0dsMExDQnJaWGtwTzF4dUlDQnBaaWhFSUNZbUlHaGhjeWhCYkd4VGVXMWliMnh6TENCclpYa3BJQ1ltSUNFb2FHRnpLR2wwTENCSVNVUkVSVTRwSUNZbUlHbDBXMGhKUkVSRlRsMWJhMlY1WFNrcFJDNWxiblZ0WlhKaFlteGxJRDBnZEhKMVpUdGNiaUFnY21WMGRYSnVJRVE3WEc1OU8xeHVkbUZ5SUNSblpYUlBkMjVRY205d1pYSjBlVTVoYldWeklEMGdablZ1WTNScGIyNGdaMlYwVDNkdVVISnZjR1Z5ZEhsT1lXMWxjeWhwZENsN1hHNGdJSFpoY2lCdVlXMWxjeUFnUFNCblQxQk9LSFJ2U1U5aWFtVmpkQ2hwZENrcFhHNGdJQ0FnTENCeVpYTjFiSFFnUFNCYlhWeHVJQ0FnSUN3Z2FTQWdJQ0FnSUQwZ01GeHVJQ0FnSUN3Z2EyVjVPMXh1SUNCM2FHbHNaU2h1WVcxbGN5NXNaVzVuZEdnZ1BpQnBLWHRjYmlBZ0lDQnBaaWdoYUdGektFRnNiRk41YldKdmJITXNJR3RsZVNBOUlHNWhiV1Z6VzJrcksxMHBJQ1ltSUd0bGVTQWhQU0JJU1VSRVJVNGdKaVlnYTJWNUlDRTlJRTFGVkVFcGNtVnpkV3gwTG5CMWMyZ29hMlY1S1R0Y2JpQWdmU0J5WlhSMWNtNGdjbVZ6ZFd4ME8xeHVmVHRjYm5aaGNpQWtaMlYwVDNkdVVISnZjR1Z5ZEhsVGVXMWliMnh6SUQwZ1puVnVZM1JwYjI0Z1oyVjBUM2R1VUhKdmNHVnlkSGxUZVcxaWIyeHpLR2wwS1h0Y2JpQWdkbUZ5SUVsVFgwOVFJQ0E5SUdsMElEMDlQU0JQWW1wbFkzUlFjbTkwYjF4dUlDQWdJQ3dnYm1GdFpYTWdJRDBnWjA5UVRpaEpVMTlQVUNBL0lFOVFVM2x0WW05c2N5QTZJSFJ2U1U5aWFtVmpkQ2hwZENrcFhHNGdJQ0FnTENCeVpYTjFiSFFnUFNCYlhWeHVJQ0FnSUN3Z2FTQWdJQ0FnSUQwZ01GeHVJQ0FnSUN3Z2EyVjVPMXh1SUNCM2FHbHNaU2h1WVcxbGN5NXNaVzVuZEdnZ1BpQnBLWHRjYmlBZ0lDQnBaaWhvWVhNb1FXeHNVM2x0WW05c2N5d2dhMlY1SUQwZ2JtRnRaWE5iYVNzclhTa2dKaVlnS0VsVFgwOVFJRDhnYUdGektFOWlhbVZqZEZCeWIzUnZMQ0JyWlhrcElEb2dkSEoxWlNrcGNtVnpkV3gwTG5CMWMyZ29RV3hzVTNsdFltOXNjMXRyWlhsZEtUdGNiaUFnZlNCeVpYUjFjbTRnY21WemRXeDBPMXh1ZlR0Y2JseHVMeThnTVRrdU5DNHhMakVnVTNsdFltOXNLRnRrWlhOamNtbHdkR2x2YmwwcFhHNXBaaWdoVlZORlgwNUJWRWxXUlNsN1hHNGdJQ1JUZVcxaWIyd2dQU0JtZFc1amRHbHZiaUJUZVcxaWIyd29LWHRjYmlBZ0lDQnBaaWgwYUdseklHbHVjM1JoYm1ObGIyWWdKRk41YldKdmJDbDBhSEp2ZHlCVWVYQmxSWEp5YjNJb0oxTjViV0p2YkNCcGN5QnViM1FnWVNCamIyNXpkSEoxWTNSdmNpRW5LVHRjYmlBZ0lDQjJZWElnZEdGbklEMGdkV2xrS0dGeVozVnRaVzUwY3k1c1pXNW5kR2dnUGlBd0lEOGdZWEpuZFcxbGJuUnpXekJkSURvZ2RXNWtaV1pwYm1Wa0tUdGNiaUFnSUNCMllYSWdKSE5sZENBOUlHWjFibU4wYVc5dUtIWmhiSFZsS1h0Y2JpQWdJQ0FnSUdsbUtIUm9hWE1nUFQwOUlFOWlhbVZqZEZCeWIzUnZLU1J6WlhRdVkyRnNiQ2hQVUZONWJXSnZiSE1zSUhaaGJIVmxLVHRjYmlBZ0lDQWdJR2xtS0doaGN5aDBhR2x6TENCSVNVUkVSVTRwSUNZbUlHaGhjeWgwYUdselcwaEpSRVJGVGwwc0lIUmhaeWtwZEdocGMxdElTVVJFUlU1ZFczUmhaMTBnUFNCbVlXeHpaVHRjYmlBZ0lDQWdJSE5sZEZONWJXSnZiRVJsYzJNb2RHaHBjeXdnZEdGbkxDQmpjbVZoZEdWRVpYTmpLREVzSUhaaGJIVmxLU2s3WEc0Z0lDQWdmVHRjYmlBZ0lDQnBaaWhFUlZORFVrbFFWRTlTVXlBbUppQnpaWFIwWlhJcGMyVjBVM2x0WW05c1JHVnpZeWhQWW1wbFkzUlFjbTkwYnl3Z2RHRm5MQ0I3WTI5dVptbG5kWEpoWW14bE9pQjBjblZsTENCelpYUTZJQ1J6WlhSOUtUdGNiaUFnSUNCeVpYUjFjbTRnZDNKaGNDaDBZV2NwTzF4dUlDQjlPMXh1SUNCeVpXUmxabWx1WlNna1UzbHRZbTlzVzFCU1QxUlBWRmxRUlYwc0lDZDBiMU4wY21sdVp5Y3NJR1oxYm1OMGFXOXVJSFJ2VTNSeWFXNW5LQ2w3WEc0Z0lDQWdjbVYwZFhKdUlIUm9hWE11WDJzN1hHNGdJSDBwTzF4dVhHNGdJQ1JIVDFCRUxtWWdQU0FrWjJWMFQzZHVVSEp2Y0dWeWRIbEVaWE5qY21sd2RHOXlPMXh1SUNBa1JGQXVaaUFnSUQwZ0pHUmxabWx1WlZCeWIzQmxjblI1TzF4dUlDQnlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRaMjl3YmljcExtWWdQU0JuVDFCT1JYaDBMbVlnUFNBa1oyVjBUM2R1VUhKdmNHVnlkSGxPWVcxbGN6dGNiaUFnY21WeGRXbHlaU2duTGk5ZmIySnFaV04wTFhCcFpTY3BMbVlnSUQwZ0pIQnliM0JsY25SNVNYTkZiblZ0WlhKaFlteGxPMXh1SUNCeVpYRjFhWEpsS0NjdUwxOXZZbXBsWTNRdFoyOXdjeWNwTG1ZZ1BTQWtaMlYwVDNkdVVISnZjR1Z5ZEhsVGVXMWliMnh6TzF4dVhHNGdJR2xtS0VSRlUwTlNTVkJVVDFKVElDWW1JQ0Z5WlhGMWFYSmxLQ2N1TDE5c2FXSnlZWEo1SnlrcGUxeHVJQ0FnSUhKbFpHVm1hVzVsS0U5aWFtVmpkRkJ5YjNSdkxDQW5jSEp2Y0dWeWRIbEpjMFZ1ZFcxbGNtRmliR1VuTENBa2NISnZjR1Z5ZEhsSmMwVnVkVzFsY21GaWJHVXNJSFJ5ZFdVcE8xeHVJQ0I5WEc1Y2JpQWdkMnR6UlhoMExtWWdQU0JtZFc1amRHbHZiaWh1WVcxbEtYdGNiaUFnSUNCeVpYUjFjbTRnZDNKaGNDaDNhM01vYm1GdFpTa3BPMXh1SUNCOVhHNTlYRzVjYmlSbGVIQnZjblFvSkdWNGNHOXlkQzVISUNzZ0pHVjRjRzl5ZEM1WElDc2dKR1Y0Y0c5eWRDNUdJQ29nSVZWVFJWOU9RVlJKVmtVc0lIdFRlVzFpYjJ3NklDUlRlVzFpYjJ4OUtUdGNibHh1Wm05eUtIWmhjaUJ6ZVcxaWIyeHpJRDBnS0Z4dUlDQXZMeUF4T1M0MExqSXVNaXdnTVRrdU5DNHlMak1zSURFNUxqUXVNaTQwTENBeE9TNDBMakl1Tml3Z01Ua3VOQzR5TGpnc0lERTVMalF1TWk0NUxDQXhPUzQwTGpJdU1UQXNJREU1TGpRdU1pNHhNU3dnTVRrdU5DNHlMakV5TENBeE9TNDBMakl1TVRNc0lERTVMalF1TWk0eE5GeHVJQ0FuYUdGelNXNXpkR0Z1WTJVc2FYTkRiMjVqWVhSVGNISmxZV1JoWW14bExHbDBaWEpoZEc5eUxHMWhkR05vTEhKbGNHeGhZMlVzYzJWaGNtTm9MSE53WldOcFpYTXNjM0JzYVhRc2RHOVFjbWx0YVhScGRtVXNkRzlUZEhKcGJtZFVZV2NzZFc1elkyOXdZV0pzWlhNblhHNHBMbk53YkdsMEtDY3NKeWtzSUdrZ1BTQXdPeUJ6ZVcxaWIyeHpMbXhsYm1kMGFDQStJR2s3SUNsM2EzTW9jM2x0WW05c2MxdHBLeXRkS1R0Y2JseHVabTl5S0haaGNpQnplVzFpYjJ4eklEMGdKR3RsZVhNb2QydHpMbk4wYjNKbEtTd2dhU0E5SURBN0lITjViV0p2YkhNdWJHVnVaM1JvSUQ0Z2FUc2dLWGRyYzBSbFptbHVaU2h6ZVcxaWIyeHpXMmtySzEwcE8xeHVYRzRrWlhod2IzSjBLQ1JsZUhCdmNuUXVVeUFySUNSbGVIQnZjblF1UmlBcUlDRlZVMFZmVGtGVVNWWkZMQ0FuVTNsdFltOXNKeXdnZTF4dUlDQXZMeUF4T1M0MExqSXVNU0JUZVcxaWIyd3VabTl5S0d0bGVTbGNiaUFnSjJadmNpYzZJR1oxYm1OMGFXOXVLR3RsZVNsN1hHNGdJQ0FnY21WMGRYSnVJR2hoY3loVGVXMWliMnhTWldkcGMzUnllU3dnYTJWNUlDczlJQ2NuS1Z4dUlDQWdJQ0FnUHlCVGVXMWliMnhTWldkcGMzUnllVnRyWlhsZFhHNGdJQ0FnSUNBNklGTjViV0p2YkZKbFoybHpkSEo1VzJ0bGVWMGdQU0FrVTNsdFltOXNLR3RsZVNrN1hHNGdJSDBzWEc0Z0lDOHZJREU1TGpRdU1pNDFJRk41YldKdmJDNXJaWGxHYjNJb2MzbHRLVnh1SUNCclpYbEdiM0k2SUdaMWJtTjBhVzl1SUd0bGVVWnZjaWhyWlhrcGUxeHVJQ0FnSUdsbUtHbHpVM2x0WW05c0tHdGxlU2twY21WMGRYSnVJR3RsZVU5bUtGTjViV0p2YkZKbFoybHpkSEo1TENCclpYa3BPMXh1SUNBZ0lIUm9jbTkzSUZSNWNHVkZjbkp2Y2loclpYa2dLeUFuSUdseklHNXZkQ0JoSUhONWJXSnZiQ0VuS1R0Y2JpQWdmU3hjYmlBZ2RYTmxVMlYwZEdWeU9pQm1kVzVqZEdsdmJpZ3BleUJ6WlhSMFpYSWdQU0IwY25WbE95QjlMRnh1SUNCMWMyVlRhVzF3YkdVNklHWjFibU4wYVc5dUtDbDdJSE5sZEhSbGNpQTlJR1poYkhObE95QjlYRzU5S1R0Y2JseHVKR1Y0Y0c5eWRDZ2taWGh3YjNKMExsTWdLeUFrWlhod2IzSjBMa1lnS2lBaFZWTkZYMDVCVkVsV1JTd2dKMDlpYW1WamRDY3NJSHRjYmlBZ0x5OGdNVGt1TVM0eUxqSWdUMkpxWldOMExtTnlaV0YwWlNoUElGc3NJRkJ5YjNCbGNuUnBaWE5kS1Z4dUlDQmpjbVZoZEdVNklDUmpjbVZoZEdVc1hHNGdJQzh2SURFNUxqRXVNaTQwSUU5aWFtVmpkQzVrWldacGJtVlFjbTl3WlhKMGVTaFBMQ0JRTENCQmRIUnlhV0oxZEdWektWeHVJQ0JrWldacGJtVlFjbTl3WlhKMGVUb2dKR1JsWm1sdVpWQnliM0JsY25SNUxGeHVJQ0F2THlBeE9TNHhMakl1TXlCUFltcGxZM1F1WkdWbWFXNWxVSEp2Y0dWeWRHbGxjeWhQTENCUWNtOXdaWEowYVdWektWeHVJQ0JrWldacGJtVlFjbTl3WlhKMGFXVnpPaUFrWkdWbWFXNWxVSEp2Y0dWeWRHbGxjeXhjYmlBZ0x5OGdNVGt1TVM0eUxqWWdUMkpxWldOMExtZGxkRTkzYmxCeWIzQmxjblI1UkdWelkzSnBjSFJ2Y2loUExDQlFLVnh1SUNCblpYUlBkMjVRY205d1pYSjBlVVJsYzJOeWFYQjBiM0k2SUNSblpYUlBkMjVRY205d1pYSjBlVVJsYzJOeWFYQjBiM0lzWEc0Z0lDOHZJREU1TGpFdU1pNDNJRTlpYW1WamRDNW5aWFJQZDI1UWNtOXdaWEowZVU1aGJXVnpLRThwWEc0Z0lHZGxkRTkzYmxCeWIzQmxjblI1VG1GdFpYTTZJQ1JuWlhSUGQyNVFjbTl3WlhKMGVVNWhiV1Z6TEZ4dUlDQXZMeUF4T1M0eExqSXVPQ0JQWW1wbFkzUXVaMlYwVDNkdVVISnZjR1Z5ZEhsVGVXMWliMnh6S0U4cFhHNGdJR2RsZEU5M2JsQnliM0JsY25SNVUzbHRZbTlzY3pvZ0pHZGxkRTkzYmxCeWIzQmxjblI1VTNsdFltOXNjMXh1ZlNrN1hHNWNiaTh2SURJMExqTXVNaUJLVTA5T0xuTjBjbWx1WjJsbWVTaDJZV3gxWlNCYkxDQnlaWEJzWVdObGNpQmJMQ0J6Y0dGalpWMWRLVnh1SkVwVFQwNGdKaVlnSkdWNGNHOXlkQ2drWlhod2IzSjBMbE1nS3lBa1pYaHdiM0owTGtZZ0tpQW9JVlZUUlY5T1FWUkpWa1VnZkh3Z0pHWmhhV3h6S0daMWJtTjBhVzl1S0NsN1hHNGdJSFpoY2lCVElEMGdKRk41YldKdmJDZ3BPMXh1SUNBdkx5Qk5VeUJGWkdkbElHTnZiblpsY25SeklITjViV0p2YkNCMllXeDFaWE1nZEc4Z1NsTlBUaUJoY3lCN2ZWeHVJQ0F2THlCWFpXSkxhWFFnWTI5dWRtVnlkSE1nYzNsdFltOXNJSFpoYkhWbGN5QjBieUJLVTA5T0lHRnpJRzUxYkd4Y2JpQWdMeThnVmpnZ2RHaHliM2R6SUc5dUlHSnZlR1ZrSUhONWJXSnZiSE5jYmlBZ2NtVjBkWEp1SUY5emRISnBibWRwWm5rb1cxTmRLU0FoUFNBblcyNTFiR3hkSnlCOGZDQmZjM1J5YVc1bmFXWjVLSHRoT2lCVGZTa2dJVDBnSjN0OUp5QjhmQ0JmYzNSeWFXNW5hV1o1S0U5aWFtVmpkQ2hUS1NrZ0lUMGdKM3Q5Snp0Y2JuMHBLU3dnSjBwVFQwNG5MQ0I3WEc0Z0lITjBjbWx1WjJsbWVUb2dablZ1WTNScGIyNGdjM1J5YVc1bmFXWjVLR2wwS1h0Y2JpQWdJQ0JwWmlocGRDQTlQVDBnZFc1a1pXWnBibVZrSUh4OElHbHpVM2x0WW05c0tHbDBLU2x5WlhSMWNtNDdJQzh2SUVsRk9DQnlaWFIxY201eklITjBjbWx1WnlCdmJpQjFibVJsWm1sdVpXUmNiaUFnSUNCMllYSWdZWEpuY3lBOUlGdHBkRjFjYmlBZ0lDQWdJQ3dnYVNBZ0lDQTlJREZjYmlBZ0lDQWdJQ3dnY21Wd2JHRmpaWElzSUNSeVpYQnNZV05sY2p0Y2JpQWdJQ0IzYUdsc1pTaGhjbWQxYldWdWRITXViR1Z1WjNSb0lENGdhU2xoY21kekxuQjFjMmdvWVhKbmRXMWxiblJ6VzJrcksxMHBPMXh1SUNBZ0lISmxjR3hoWTJWeUlEMGdZWEpuYzFzeFhUdGNiaUFnSUNCcFppaDBlWEJsYjJZZ2NtVndiR0ZqWlhJZ1BUMGdKMloxYm1OMGFXOXVKeWtrY21Wd2JHRmpaWElnUFNCeVpYQnNZV05sY2p0Y2JpQWdJQ0JwWmlna2NtVndiR0ZqWlhJZ2ZId2dJV2x6UVhKeVlYa29jbVZ3YkdGalpYSXBLWEpsY0d4aFkyVnlJRDBnWm5WdVkzUnBiMjRvYTJWNUxDQjJZV3gxWlNsN1hHNGdJQ0FnSUNCcFppZ2tjbVZ3YkdGalpYSXBkbUZzZFdVZ1BTQWtjbVZ3YkdGalpYSXVZMkZzYkNoMGFHbHpMQ0JyWlhrc0lIWmhiSFZsS1R0Y2JpQWdJQ0FnSUdsbUtDRnBjMU41YldKdmJDaDJZV3gxWlNrcGNtVjBkWEp1SUhaaGJIVmxPMXh1SUNBZ0lIMDdYRzRnSUNBZ1lYSm5jMXN4WFNBOUlISmxjR3hoWTJWeU8xeHVJQ0FnSUhKbGRIVnliaUJmYzNSeWFXNW5hV1o1TG1Gd2NHeDVLQ1JLVTA5T0xDQmhjbWR6S1R0Y2JpQWdmVnh1ZlNrN1hHNWNiaTh2SURFNUxqUXVNeTQwSUZONWJXSnZiQzV3Y205MGIzUjVjR1ZiUUVCMGIxQnlhVzFwZEdsMlpWMG9hR2x1ZENsY2JpUlRlVzFpYjJ4YlVGSlBWRTlVV1ZCRlhWdFVUMTlRVWtsTlNWUkpWa1ZkSUh4OElISmxjWFZwY21Vb0p5NHZYMmhwWkdVbktTZ2tVM2x0WW05c1cxQlNUMVJQVkZsUVJWMHNJRlJQWDFCU1NVMUpWRWxXUlN3Z0pGTjViV0p2YkZ0UVVrOVVUMVJaVUVWZExuWmhiSFZsVDJZcE8xeHVMeThnTVRrdU5DNHpMalVnVTNsdFltOXNMbkJ5YjNSdmRIbHdaVnRBUUhSdlUzUnlhVzVuVkdGblhWeHVjMlYwVkc5VGRISnBibWRVWVdjb0pGTjViV0p2YkN3Z0oxTjViV0p2YkNjcE8xeHVMeThnTWpBdU1pNHhMamtnVFdGMGFGdEFRSFJ2VTNSeWFXNW5WR0ZuWFZ4dWMyVjBWRzlUZEhKcGJtZFVZV2NvVFdGMGFDd2dKMDFoZEdnbkxDQjBjblZsS1R0Y2JpOHZJREkwTGpNdU15QktVMDlPVzBCQWRHOVRkSEpwYm1kVVlXZGRYRzV6WlhSVWIxTjBjbWx1WjFSaFp5aG5iRzlpWVd3dVNsTlBUaXdnSjBwVFQwNG5MQ0IwY25WbEtUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNMkxuTjViV0p2YkM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01UQTJYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUlzSW5KbGNYVnBjbVVvSnk0dlgzZHJjeTFrWldacGJtVW5LU2duWVhONWJtTkpkR1Z5WVhSdmNpY3BPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5bGN6Y3VjM2x0WW05c0xtRnplVzVqTFdsMFpYSmhkRzl5TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeE1EZGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJaXdpY21WeGRXbHlaU2duTGk5ZmQydHpMV1JsWm1sdVpTY3BLQ2R2WW5ObGNuWmhZbXhsSnlrN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMlZ6Tnk1emVXMWliMnd1YjJKelpYSjJZV0pzWlM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01UQTRYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUlzSWk4cUtseHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQlFWQ0JKYm05MlljT253Nk52SUdVZ1UybHpkR1Z0WVhNZ1UwRmNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdTVTVGVTBNdFNVUmNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdVVlZQUWtsVElFNUZWRmRQVWt0VElGTk1YRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRVpTUVZWT1NFOUdSVkl0UjBWVFJVeE1VME5JUVVaVUlGcFZVaUJHVDBWU1JFVlNWVTVISUVSRlVpQkJUa2RGVjBGT1JGUkZUaUJHVDFKVFEwaFZUa2NnUlM1V1hHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklFOVNRVTVIUlNCVFFWeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQkVaWFYwYzJOb1pTQlVaV3hsYTI5dElFRkhYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRUZ3YVhwbFpWeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQlVSVU5JVGtsVFEwaEZJRlZPU1ZaRlVsTkpWRUZVSUVKRlVreEpUbHh1S2x4dUtpQk1hV05sYm5ObFpDQjFibVJsY2lCMGFHVWdRWEJoWTJobElFeHBZMlZ1YzJVc0lGWmxjbk5wYjI0Z01pNHdJQ2gwYUdVZ1hDSk1hV05sYm5ObFhDSXBPMXh1S2lCNWIzVWdiV0Y1SUc1dmRDQjFjMlVnZEdocGN5Qm1hV3hsSUdWNFkyVndkQ0JwYmlCamIyMXdiR2xoYm1ObElIZHBkR2dnZEdobElFeHBZMlZ1YzJVdVhHNHFJRmx2ZFNCdFlYa2diMkowWVdsdUlHRWdZMjl3ZVNCdlppQjBhR1VnVEdsalpXNXpaU0JoZEZ4dUtseHVLaUFnSUdoMGRIQTZMeTkzZDNjdVlYQmhZMmhsTG05eVp5OXNhV05sYm5ObGN5OU1TVU5GVGxORkxUSXVNRnh1S2x4dUtpQlZibXhsYzNNZ2NtVnhkV2x5WldRZ1lua2dZWEJ3YkdsallXSnNaU0JzWVhjZ2IzSWdZV2R5WldWa0lIUnZJR2x1SUhkeWFYUnBibWNzSUhOdlpuUjNZWEpsWEc0cUlHUnBjM1J5YVdKMWRHVmtJSFZ1WkdWeUlIUm9aU0JNYVdObGJuTmxJR2x6SUdScGMzUnlhV0oxZEdWa0lHOXVJR0Z1SUZ3aVFWTWdTVk5jSWlCQ1FWTkpVeXhjYmlvZ1YwbFVTRTlWVkNCWFFWSlNRVTVVU1VWVElFOVNJRU5QVGtSSlZFbFBUbE1nVDBZZ1FVNVpJRXRKVGtRc0lHVnBkR2hsY2lCbGVIQnlaWE56SUc5eUlHbHRjR3hwWldRdVhHNHFJRk5sWlNCMGFHVWdUR2xqWlc1elpTQm1iM0lnZEdobElITndaV05wWm1saklHeGhibWQxWVdkbElHZHZkbVZ5Ym1sdVp5QndaWEp0YVhOemFXOXVjeUJoYm1SY2Jpb2diR2x0YVhSaGRHbHZibk1nZFc1a1pYSWdkR2hsSUV4cFkyVnVjMlV1WEc0cUtpOWNibHh1YVcxd2IzSjBJRk41Ym1OUFltcGxZM1FnWm5KdmJTQW5MaTlRY205NGVVOWlhbVZqZENjN1hHNWNiaThxS2x4dUlDb2dWR2hsSUdOc1lYTnpJSEpsZEhWeWJtVmtJR1p5YjIwZ2RHaGxJRVJoZEdGUFltcGxZM1FnWVdSa1EyaHBiR1J5Wlc0Z1kyRnNiQ0J2Y2lCbWNtOXRJRzl1UVdSa1EyaHBiR1J5Wlc0Z2FXWWdjbVZ0YjNSbGJIa2dZM0psWVhSbFpDNWNiaUFxSUVOb2FXeGtjbVZ1SUc5aWFtVmpkQ0J6ZVc1amFISnZibWw2WVhScGIyNGdhWE1nWVNCaElHWmhjM1FnWm05eWQyRnlaQ0J0WldOb1lXNXBjMjBzSUc1dklHNWxaV1FnWm05eUlHUnBjbVZqZENCemRXSnpZM0pwY0hScGIyNXpMQ0JwZENCMWMyVnpJSFJvWlNCaGJISmxZV1I1SUdGMWRHaHZjbWw2WldRZ2MzVmljMk55YVhCMGFXOXVJR1p5YjIwZ2RHaGxJSEJoY21WdWRDQkVZWFJoVDJKcVpXTjBMbHh1SUNvdlhHNWpiR0Z6Y3lCRVlYUmhUMkpxWldOMFEyaHBiR1FnTHlvZ2FXMXdiR1Z0Wlc1MGN5QlRlVzVqVTNSaGRIVnpJQ292SUh0Y2JpQWdMeW9nY0hKcGRtRjBaVnh1WEc0Z0lDMHRMUzFsZG1WdWRDQm9ZVzVrYkdWeWN5MHRMUzFjYmlBZ1gyOXVVbVZ6Y0c5dWMyVklZVzVrYkdWeU9pQW9aWFpsYm5RcElEMCtJSFp2YVdSY2JpQWdLaTljYmx4dUlDQXZLaXBjYmlBZ0lDb2dRR2xuYm05eVpWeHVJQ0FnS2lCVGFHOTFiR1FnYm05MElHSmxJSFZ6WldRZ1pHbHlaV04wYkhrZ1lua2dTSGx3WlhKMGFXVnpMaUJKZENkeklHTmhiR3hsWkNCaWVTQjBhR1VnUkdGMFlVOWlhbVZqZEM1aFpHUkRhR2xzWkhKbGJseHVJQ0FnS2k5Y2JpQWdZMjl1YzNSeWRXTjBiM0lvY0dGeVpXNTBMQ0JqYUdsc1pFbGtMQ0JwYm1sMGFXRnNSR0YwWVN3Z2IzZHVaWElzSUcxelowbGtLU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lGOTBhR2x6TGw5d1lYSmxiblFnUFNCd1lYSmxiblE3WEc0Z0lDQWdYM1JvYVhNdVgyTm9hV3hrU1dRZ1BTQmphR2xzWkVsa08xeHVJQ0FnSUY5MGFHbHpMbDl2ZDI1bGNpQTlJRzkzYm1WeU8xeHVJQ0FnSUY5MGFHbHpMbDl0YzJkSlpDQTlJRzF6WjBsa08xeHVYRzRnSUNBZ1gzUm9hWE11WDNONWJtTlBZbW9nUFNCdVpYY2dVM2x1WTA5aWFtVmpkQ2hwYm1sMGFXRnNSR0YwWVNrN1hHNWNiaUFnSUNCamIyNXpiMnhsTG14dlp5Z25XMFJoZEdGUFltcGxZM1JEYUdsc1pDQXRJQ0JEYjI1emRISjFZM1J2Y2wwZ0xTQW5MQ0JmZEdocGN5NWZjM2x1WTA5aWFpazdYRzVjYmlBZ0lDQmZkR2hwY3k1ZlluVnpJRDBnY0dGeVpXNTBMbDlpZFhNN1hHNGdJQ0FnWDNSb2FYTXVYMkZzYkc5allYUmxUR2x6ZEdWdVpYSnpLQ2s3WEc0Z0lIMWNibHh1SUNCZllXeHNiMk5oZEdWTWFYTjBaVzVsY25Nb0tTQjdYRzRnSUNBZ2JHVjBJRjkwYUdseklEMGdkR2hwY3p0Y2JseHVJQ0FnSUM4dmRHaHBjeUJwY3lCdmJteDVJRzVsWldSbFpDQm1iM0lnWTJocGJHUnlaVzRnY21Wd2IzSjBaWEp6WEc0Z0lDQWdhV1lnS0Y5MGFHbHpMbDl2ZDI1bGNpa2dlMXh1SUNBZ0lDQWdYM1JvYVhNdVgyeHBjM1JsYm1WeUlEMGdYM1JvYVhNdVgySjFjeTVoWkdSTWFYTjBaVzVsY2loZmRHaHBjeTVmYjNkdVpYSXNJQ2h0YzJjcElEMCtJSHRjYmlBZ0lDQWdJQ0FnYVdZZ0tHMXpaeTUwZVhCbElEMDlQU0FuY21WemNHOXVjMlVuSUNZbUlHMXpaeTVwWkNBOVBUMGdYM1JvYVhNdVgyMXpaMGxrS1NCN1hHNGdJQ0FnSUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvSjBSaGRHRlBZbXBsWTNSRGFHbHNaQzV2YmxKbGMzQnZibk5sT2ljc0lHMXpaeWs3WEc0Z0lDQWdJQ0FnSUNBZ1gzUm9hWE11WDI5dVVtVnpjRzl1YzJVb2JYTm5LVHRjYmlBZ0lDQWdJQ0FnZlZ4dUlDQWdJQ0FnZlNrN1hHNGdJQ0FnZlZ4dUlDQjlYRzVjYmlBZ1gzSmxiR1ZoYzJWTWFYTjBaVzVsY25Nb0tTQjdYRzRnSUNBZ2JHVjBJRjkwYUdseklEMGdkR2hwY3p0Y2JseHVJQ0FnSUdsbUlDaGZkR2hwY3k1ZmJHbHpkR1Z1WlhJcElIdGNiaUFnSUNBZ0lGOTBhR2x6TGw5c2FYTjBaVzVsY2k1eVpXMXZkbVVvS1R0Y2JpQWdJQ0I5WEc0Z0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1VtVnNaV0Z6WlNCaGJtUWdaR1ZzWlhSbElHOWlhbVZqZENCa1lYUmhYRzRnSUNBcUwxeHVJQ0JrWld4bGRHVW9LU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lHUmxiR1YwWlNCZmRHaHBjeTVmY0dGeVpXNTBMbDlqYUdsc1pISmxibHRmZEdocGN5NWZZMmhwYkdSSlpGMDdYRzVjYmlBZ0lDQmZkR2hwY3k1ZmNtVnNaV0Z6WlV4cGMzUmxibVZ5Y3lncE8xeHVYRzRnSUNBZ0x5OVVUMFJQT2lCelpXNWtJR1JsYkdWMFpTQnRaWE56WVdkbElEOWNiaUFnZlZ4dVhHNGdJQzhxS2x4dUlDQWdLaUJEYUdsc1pISmxiaUJKUkNCblpXNWxjbUYwWldRZ2IyNGdZV1JrUTJocGJHUnlaVzR1SUZWdWFYRjFaU0JwWkdWdWRHbG1hV1Z5WEc0Z0lDQXFJRUIwZVhCbElIdFZVa3g5SUMwZ1ZWSk1JRzltSUhSb1pTQm1iM0p0WVhRZ1BFaDVjR1Z5ZEhsVlVrdytJenh1ZFcxbGNtbGpMWE5sY1hWbGJtTmxQbHh1SUNBZ0tpOWNiaUFnWjJWMElHTm9hV3hrU1dRb0tTQjdJSEpsZEhWeWJpQjBhR2x6TGw5amFHbHNaRWxrT3lCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUVSaGRHRWdVM1J5ZFdOMGRYSmxJSFJ2SUdKbElITjVibU5vY205dWFYcGxaQzVjYmlBZ0lDb2dRSFI1Y0dVZ2UwcFRUMDU5SUMwZ1NsTlBUaUJ6ZEhKMVkzUjFjbVVnZEdoaGRDQnphRzkxYkdRZ1ptOXNiRzkzSUhSb1pTQmtaV1pwYm1Wa0lITmphR1Z0WVN3Z2FXWWdZVzU1TGx4dUlDQWdLaTljYmlBZ1oyVjBJR1JoZEdFb0tTQjdJSEpsZEhWeWJpQjBhR2x6TGw5emVXNWpUMkpxTG1SaGRHRTdJSDFjYmx4dUlDQXZLaXBjYmlBZ0lDb2dVMlYwSUdadmNpQjBhR2x6SUdSaGRHRlBZbXBsWTNSRGFHbHNaQ0JoYmlCcFpHVnVkR2wwZVZ4dUlDQWdLaUJBYldWMGFHOWtJR2xrWlc1MGFYUjVYRzRnSUNBcUlFQndZWEpoYlNBZ2UwbGtaVzUwYVhSNWZTQnBaR1Z1ZEdsMGVTQnBaR1Z1ZEdsMGVTQm1jbTl0SUhkb2J5QmpjbVZoZEdWa0lIUm9aU0J0WlhOellXZGxYRzRnSUNBcUwxeHVJQ0J6WlhRZ2FXUmxiblJwZEhrb2FXUmxiblJwZEhrcElIc2dkR2hwY3k1ZmFXUmxiblJwZEhrZ1BTQnBaR1Z1ZEdsMGVUc2dmVnh1WEc0Z0lDOHFLbHh1SUNBZ0tpQkhaWFFnWm05eUlIUm9hWE1nWkdGMFlVOWlhbVZqZEVOb2FXeGtJR0Z1SUdsa1pXNTBhWFI1WEc0Z0lDQXFJRUJ0WlhSb2IyUWdhV1JsYm5ScGRIbGNiaUFnSUNvZ1FISmxkSFZ5YmlCN1NXUmxiblJwZEhsOUlHbGtaVzUwYVhSNUlHWnliMjBnZDJodklHTnlaV0YwWldRZ2RHaGxJRzFsYzNOaFoyVmNiaUFnSUNvdlhHNGdJR2RsZENCcFpHVnVkR2wwZVNncElIc2djbVYwZFhKdUlIUm9hWE11WDJsa1pXNTBhWFI1T3lCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUZKbFoybHpkR1Z5SUhSb1pTQmphR0Z1WjJVZ2JHbHpkR1Z1WlhKeklITmxiblFnWW5rZ2RHaGxJSEpsY0c5eWRHVnlJR05vYVd4a1hHNGdJQ0FxSUVCd1lYSmhiU0I3Wm5WdVkzUnBiMjRvWlhabGJuUTZJRTF6WjBWMlpXNTBLWDBnWTJGc2JHSmhZMnRjYmlBZ0lDb3ZYRzRnSUc5dVEyaGhibWRsS0dOaGJHeGlZV05yS1NCN1hHNGdJQ0FnZEdocGN5NWZjM2x1WTA5aWFpNXZZbk5sY25abEtDaGxkbVZ1ZENrZ1BUNGdlMXh1SUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvSjF0RVlYUmhUMkpxWldOMFEyaHBiR1FnTFNCdlluTmxjblpsY2wwZ0xTQW5MQ0JsZG1WdWRDazdYRzRnSUNBZ0lDQmpZV3hzWW1GamF5aGxkbVZ1ZENrN1hHNGdJQ0FnZlNrN1hHNGdJSDFjYmx4dUlDQXZLaXBjYmlBZ0lDb2dVMlYwZFhBZ2RHaGxJR05oYkd4aVlXTnJJSFJ2SUhCeWIyTmxjM01nY21WemNHOXVjMlVnYm05MGFXWnBZMkYwYVc5dWN5QnZaaUIwYUdVZ1kzSmxZWFJsYzF4dUlDQWdLaUJBY0dGeVlXMGdlMloxYm1OMGFXOXVLR1YyWlc1ME9pQk5jMmRGZG1WdWRDbDlJR05oYkd4aVlXTnJYRzRnSUNBcUwxeHVJQ0J2YmxKbGMzQnZibk5sS0dOaGJHeGlZV05yS1NCN1hHNGdJQ0FnZEdocGN5NWZiMjVTWlhOd2IyNXpaVWhoYm1Sc1pYSWdQU0JqWVd4c1ltRmphenRjYmlBZ2ZWeHVYRzRnSUM4dlJreFBWeTFKVGpvZ2JXVnpjMkZuWlNCeVpXTmxhWFpsWkNCbWNtOXRJR0VnY21WdGIzUmxJRVJoZEdGUFltcGxZM1FnTFQ0Z1gyOXVRMmhwYkdSRGNtVmhkR1ZjYmlBZ1gyOXVVbVZ6Y0c5dWMyVW9iWE5uS1NCN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmx4dUlDQWdJR3hsZENCbGRtVnVkQ0E5SUh0Y2JpQWdJQ0FnSUhSNWNHVTZJRzF6Wnk1MGVYQmxMRnh1SUNBZ0lDQWdkWEpzT2lCdGMyY3VZbTlrZVM1emIzVnlZMlVzWEc0Z0lDQWdJQ0JqYjJSbE9pQnRjMmN1WW05a2VTNWpiMlJsWEc0Z0lDQWdmVHRjYmx4dUlDQWdJR2xtSUNoZmRHaHBjeTVmYjI1U1pYTndiMjV6WlVoaGJtUnNaWElwSUh0Y2JpQWdJQ0FnSUY5MGFHbHpMbDl2YmxKbGMzQnZibk5sU0dGdVpHeGxjaWhsZG1WdWRDazdYRzRnSUNBZ2ZWeHVJQ0I5WEc1Y2JuMWNibHh1Wlhod2IzSjBJR1JsWm1GMWJIUWdSR0YwWVU5aWFtVmpkRU5vYVd4a08xeHVYRzVjYmx4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZJZ0x5OWNiaTh2SUM0dmMzSmpMM041Ym1Ob1pYSXZSR0YwWVU5aWFtVmpkRU5vYVd4a0xtcHpJaXdpTHk4Z0lDQWdJSEJ5YjNoNUxXOWljMlZ5ZG1VZ2RqQXVNQzR4T0Z4eVhHNHZMeUFnSUNBZ1EyOXdlWEpwWjJoMElDaGpLU0F5TURFMUxDQXlNREUySUZOcGJXOXVJRmt1SUVKc1lXTnJkMlZzYkN3Z1FXNTVWMmhwWTJoWFlYbGNjbHh1THk4Z0lDQWdJRTFKVkNCTWFXTmxibk5sSUMwZ2FIUjBjRG92TDI5d1pXNXpiM1Z5WTJVdWIzSm5MMnhwWTJWdWMyVnpMMjFwZEMxc2FXTmxibk5sTG5Cb2NGeHlYRzRvWm5WdVkzUnBiMjRvS1NCN1hISmNibHgwWENKMWMyVWdjM1J5YVdOMFhDSTdYSEpjYmx4MEx5OGdRM0psWVhSbGN5QmhibVFnY21WMGRYSnVjeUJoSUZCeWIzaDVJSGR5WVhCd2FXNW5JR0VnZEdGeVoyVjBJSE52SUhSb1lYUWdZV3hzSUdOb1lXNW5aWE1nWTJGdUlHSmxJSFJ5WVhCd1pXUWdZVzVrSUdadmNuZGhjbVJsWkNCMGIxeHlYRzVjZEM4dklHRWdZMkZzYkdKaFkyc3VJRlJvWlNCallXeHNZbUZqYXlCMFlXdGxjeUJoYmlCaGNuSmhlU0J2WmlCamFHRnVaMlZ6SUdwMWMzUWdiR2xyWlNCMGFHVWdkSEpoWkdsMGFXOXVZV3dnYjNKcFoybHVZV3dnUTJoeWIyMWxJRTlpYW1WamRDNXZZbk5sY25abFhISmNibHgwTHk4Z2UyOWlhbVZqZERvOGIySnFaV04wSUdOb1lXNW5aV1ErTEc1aGJXVTZQR1pwWld4a0lHTm9ZVzVuWldRK0xIUjVjR1U2WVdSa2ZIVndaR0YwWlh4a1pXeGxkR1Y4Y21WamIyNW1hV2QxY21WOGNISmxkbVZ1ZEVWNGRHVnVjMmx2Ym5OOGMyVjBVSEp2ZEc5MGVYQmxMRzlzWkZaaGJIVmxPanh2YkdRZ2RtRnNkV1VnYVdZZ2RYQmtZWFJsSUh3Z1pHVnNaWFJsUG4xY2NseHVYSFF2THlCVWFHVWdZV05qWlhCMGJHbHpkQ0JqWVc0Z1ltVWdZV1JrZkhWd1pHRjBaWHhrWld4bGRHVjhjbVZqYjI1bWFXZDFjbVY4Y0hKbGRtVnVkRVY0ZEdWdWMybHZibk44YzJWMFVISnZkRzkwZVhCbExseHlYRzVjZEM4dklIWWdNQzR3TGpFd0lIUnZJSE4xY0hCdmNuUWdjR0YxYzJsdVp5QmhibVFnY21WemRHRnlkR2x1WnlCdlluTmxjblpoZEdsdmJpQjBkMjhnWVdSa2FYUnBiMjVoYkNCamIyNXpkSEoxWTNSdmNpQmhjbWQxYldWdWRITWdZWEpsSUdGMllXbHNZV0pzWlNCMGJ5QlBZbXBsWTNRdWIySnpaWEoyWlRwY2NseHVYSFF2THlCd1lYVnpZV0pzWlNBdElHTnlaV0YwWlNCMGFHVWdUMkp6WlhKMlpYSWdjMjhnYVhRZ1kyRnVJR0psSUhCaGRYTmxaRnh5WEc1Y2RDOHZJSEJoZFhObElDMGdZM0psWVhSbElHOWljMlZ5ZG1WeUlHbHVJSEJoZFhObFpDQnpkR0YwWlZ4eVhHNWNkQzh2SUdsbUlIQmhkWE5oWW14bElHbHpJSFJ5ZFdVZ2RHaGxiaUJoYmlCaFpHUnBkR2x2Ym1Gc0lHMWxkR2h2WkNCa1pXeHBkbVZ5S0dsbmJtOXlaVkJ5WlhacGIzVnpLU0JwY3lCaGRtRnBiR0ZpYkdVZ2RHOGdjM1JoY25RZ1pHVnNhWFpsY25sY2NseHVYSFF2THlCMGJ5QndZWFZ6WlNCa1pXeHBkbVZ5ZVNCelpYUWdZU0J3Y205d1pYSjBlU0JqWVd4c1pXUWdjR0YxYzJVZ2IyNGdkR2hsSUdaMWJtTjBhVzl1SUdSbGJHbDJaWElnZEc4Z2RISjFaVnh5WEc1Y2RDOHZJSEJoZFhOaFlteGxJR2x6SUc5d2RHbHZibUZzSUhSdklISmxaSFZqWlNCMGFHVWdZMmhoYm1ObElHOW1JSE5vWVdSdmQybHVaeUJoSUhCeWIzQmxjblI1SUc5eUlHMWxkR2h2WkNCdmJpQmhibmtnWlhocGMzUnBibWNnWTI5a1pTQmpZV3hzWldRZ1pHVnNhWFpsY2x4eVhHNWNkR2xtS0NGUFltcGxZM1F1YjJKelpYSjJaU0FtSmlCMGVYQmxiMllvVUhKdmVIa3BQVDA5WENKbWRXNWpkR2x2Ymx3aUtTQjdYSEpjYmx4MFhIUm1kVzVqZEdsdmJpQlBZbk5sY25abGNpaDBZWEpuWlhRc1kyRnNiR0poWTJzc1lXTmpaWEIwYkdsemRDeHdZWFZ6WVdKc1pTeHdZWFZ6WlN4a1pXeGhlU2tnZTF4eVhHNWNkQ0FnSUNCY2RIWmhjaUJ0WlNBOUlIUm9hWE1zSUhCeWIzaDVPMXh5WEc1Y2RDQWdJQ0JjZEdaMWJtTjBhVzl1SUdSbGJHbDJaWElvYVdkdWIzSmxVSEpsZG1sdmRYTXNaR1ZzWVhrcElIdGNjbHh1WEhRZ0lDQWdYSFJjZEdSbGJHbDJaWEl1WkdWc1lYa2dQU0JrWld4aGVUdGNjbHh1WEhRZ0lDQWdYSFJjZEdsbUtDRmtaV3hwZG1WeUxuQmhkWE5sS1NCN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEZ4MGFXWW9iV1V1WTJoaGJtZGxjMlYwTG14bGJtZDBhRDR3S1NCN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEZ4MFhIUnBaaWdoYVdkdWIzSmxVSEpsZG1sdmRYTXBJSHRjY2x4dVhIUmNkQ0FnSUNCY2RDQWdJQ0JjZEZ4MGRtRnlJR05vWVc1blpYTWdQU0J0WlM1amFHRnVaMlZ6WlhRdVptbHNkR1Z5S0daMWJtTjBhVzl1S0dOb1lXNW5aU2tnZXlCeVpYUjFjbTRnSVdGalkyVndkR3hwYzNRZ2ZId2dZV05qWlhCMGJHbHpkQzVwYm1SbGVFOW1LR05vWVc1blpTNTBlWEJsS1Q0OU1Ec2dmU2s3WEhKY2JseDBYSFFnSUNBZ0lDQWdJRngwWEhSY2RHbG1LR05vWVc1blpYTXViR1Z1WjNSb1BqQXBJSHRjY2x4dVhIUmNkQ0FnSUNBZ0lDQWdYSFJjZEZ4MFhIUmpZV3hzWW1GamF5aGphR0Z1WjJWektUdGNjbHh1WEhSY2RDQWdJQ0FnSUNBZ1hIUmNkRngwZlZ4eVhHNWNkQ0FnSUNBZ0lDQWdYSFJjZEZ4MGZWeHlYRzVjZENBZ0lDQWdJQ0FnWEhSY2RGeDBiV1V1WTJoaGJtZGxjMlYwSUQwZ1cxMDdYSEpjYmx4MElDQWdJQ0FnSUNCY2RGeDBmVnh5WEc1Y2RDQWdJQ0JjZEZ4MGZWeHlYRzVjZENBZ0lDQmNkSDFjY2x4dVhIUWdJQ0FnWEhSa1pXeHBkbVZ5TG5CaGRYTmxJRDBnY0dGMWMyVTdYSEpjYmx4MElDQWdJRngwWkdWc2FYWmxjaTVrWld4aGVTQTlJR1JsYkdGNU8xeHlYRzVjZEZ4MElDQWdJRzFsTG1kbGRDQTlJR1oxYm1OMGFXOXVLSFJoY21kbGRDd2djSEp2Y0dWeWRIa3BJSHRjY2x4dVhIUmNkQ0FnSUNCY2RHbG1LSEJ5YjNCbGNuUjVQVDA5WENKZlgyOWljMlZ5ZG1WeVgxOWNJaWtnZTF4eVhHNWNkRngwSUNBZ0lGeDBYSFJ5WlhSMWNtNGdiV1U3WEhKY2JseDBYSFFnSUNBZ1hIUjlYSEpjYmx4MFhIUWdJQ0FnWEhScFppaHdjbTl3WlhKMGVUMDlQVndpZFc1dlluTmxjblpsWENJcElIdGNjbHh1WEhSY2RDQWdJQ0JjZEZ4MGNtVjBkWEp1SUdaMWJtTjBhVzl1S0NrZ2UxeHlYRzVjZEZ4MElDQWdJRngwWEhSY2RFOWlhbVZqZEM1MWJtOWljMlZ5ZG1Vb2RHRnlaMlYwS1R0Y2NseHVYSFJjZENBZ0lDQmNkRngwWEhSeVpYUjFjbTRnZEdGeVoyVjBPMXh5WEc1Y2RGeDBJQ0FnSUZ4MFhIUjlPMXh5WEc1Y2RGeDBJQ0FnSUZ4MGZWeHlYRzVjZEZ4MElDQWdJRngwYVdZb2NISnZjR1Z5ZEhrOVBUMWNJbVJsYkdsMlpYSmNJaWtnZTF4eVhHNWNkRngwSUNBZ0lGeDBYSFJ5WlhSMWNtNGdaR1ZzYVhabGNqdGNjbHh1WEhSY2RDQWdJQ0JjZEgxY2NseHVYSFJjZENBZ0lDQmNkSEpsZEhWeWJpQjBZWEpuWlhSYmNISnZjR1Z5ZEhsZE8xeHlYRzVjZEZ4MElDQWdJSDFjY2x4dVhIUWdJQ0FnWEhSdFpTNTBZWEpuWlhRZ1BTQjBZWEpuWlhRN1hISmNibHgwSUNBZ0lGeDBiV1V1WTJoaGJtZGxjMlYwSUQwZ1cxMDdYSEpjYmx4MElDQWdJRngwYVdZb0lXMWxMblJoY21kbGRDNWZYMjlpYzJWeWRtVnlRMkZzYkdKaFkydHpYMThwSUh0Y2NseHVYSFFnSUNBZ1hIUmNkQzh2SUY5ZmIySnpaWEoyWlhKRFlXeHNZbUZqYTNOZlh5QnBjeUIxYzJWa0lHRnpJR0Z1SUdsdVpHVjRJSFJ2SUdkbGRDQmhkQ0IwYUdVZ2NISnZlSGtnZDJocFkyZ2dhWE1nZEdobElHOWljMlZ5ZG1WeUxDQnpieUIzWlNCallXNGdkVzV2WW5ObGNuWmxYSEpjYmx4MElDQWdJRngwWEhSUFltcGxZM1F1WkdWbWFXNWxVSEp2Y0dWeWRIa29kR0Z5WjJWMExGd2lYMTl2WW5ObGNuWmxja05oYkd4aVlXTnJjMTlmWENJc2UyVnVkVzFsY21GaWJHVTZabUZzYzJVc1kyOXVabWxuZFhKaFlteGxPblJ5ZFdVc2QzSnBkR0ZpYkdVNlptRnNjMlVzZG1Gc2RXVTZXMTE5S1R0Y2NseHVYSFFnSUNBZ1hIUmNkRTlpYW1WamRDNWtaV1pwYm1WUWNtOXdaWEowZVNoMFlYSm5aWFFzWENKZlgyOWljMlZ5ZG1WeWMxOWZYQ0lzZTJWdWRXMWxjbUZpYkdVNlptRnNjMlVzWTI5dVptbG5kWEpoWW14bE9uUnlkV1VzZDNKcGRHRmliR1U2Wm1Gc2MyVXNkbUZzZFdVNlcxMTlLVHRjY2x4dVhIUWdJQ0FnWEhSOVhISmNibHgwSUNBZ0lGeDBiV1V1ZEdGeVoyVjBMbDlmYjJKelpYSjJaWEpEWVd4c1ltRmphM05mWHk1d2RYTm9LR05oYkd4aVlXTnJLVHRjY2x4dVhIUWdJQ0FnWEhSdFpTNTBZWEpuWlhRdVgxOXZZbk5sY25abGNuTmZYeTV3ZFhOb0tIUm9hWE1wTzF4eVhHNWNkQ0FnSUNCY2RIQnliM2g1SUQwZ2JtVjNJRkJ5YjNoNUtIUmhjbWRsZEN4dFpTazdYSEpjYmx4MElDQWdJRngwWkdWc2FYWmxjaWhtWVd4elpTeGtaV3hoZVNrN1hISmNibHgwSUNBZ0lGeDBjbVYwZFhKdUlIQnliM2g1TzF4eVhHNWNkQ0FnSUNCOVhISmNibHgwWEhSUFluTmxjblpsY2k1d2NtOTBiM1I1Y0dVdVpHVnNhWFpsY2lBOUlHWjFibU4wYVc5dUtDa2dlMXh5WEc1Y2RGeDBYSFJ5WlhSMWNtNGdkR2hwY3k1blpYUW9iblZzYkN4Y0ltUmxiR2wyWlhKY0lpazdYSEpjYmx4MFhIUjlYSEpjYmx4MElDQWdJRTlpYzJWeWRtVnlMbkJ5YjNSdmRIbHdaUzV6WlhRZ1BTQm1kVzVqZEdsdmJpaDBZWEpuWlhRc0lIQnliM0JsY25SNUxDQjJZV3gxWlNrZ2V5QXZMeUFzSUhKbFkyVnBkbVZ5WEhKY2JseDBJQ0FnSUZ4MGRtRnlJRzlzWkhaaGJIVmxJRDBnZEdGeVoyVjBXM0J5YjNCbGNuUjVYVHRjY2x4dVhIUWdJQ0FnWEhSMllYSWdkSGx3WlNBOUlDaHZiR1IyWVd4MVpUMDlQWFZ1WkdWbWFXNWxaQ0EvSUZ3aVlXUmtYQ0lnT2lCY0luVndaR0YwWlZ3aUtUdGNjbHh1WEhRZ0lDQWdYSFIwWVhKblpYUmJjSEp2Y0dWeWRIbGRJRDBnZG1Gc2RXVTdYSEpjYmx4MElDQWdJRngwYVdZb2RHRnlaMlYwTGw5ZmIySnpaWEoyWlhKelgxOHVhVzVrWlhoUFppaDBhR2x6S1Q0OU1DQW1KaUFvSVhSb2FYTXVZV05qWlhCMGJHbHpkQ0I4ZkNCMGFHbHpMbUZqWTJWd2RHeHBjM1F1YVc1a1pYaFBaaWgwZVhCbEtUNDlNQ2twSUh0Y2NseHVYSFFnSUNBZ0lDQWdJRngwZG1GeUlHTm9ZVzVuWlNBOUlIdHZZbXBsWTNRNmRHRnlaMlYwTEc1aGJXVTZjSEp2Y0dWeWRIa3NkSGx3WlRwMGVYQmxmU3hjY2x4dVhIUWdJQ0FnSUNBZ0lGeDBYSFJ6ZEdGeWRDQTlJSFJvYVhNdVkyaGhibWRsYzJWMExteGxibWQwYUNBOVBUMGdNQ3hjY2x4dVhIUWdJQ0FnSUNBZ0lGeDBYSFJrWld4cGRtVnlJRDBnZEdocGN5NWtaV3hwZG1WeUtDazdYSEpjYmx4MElDQWdJQ0FnSUNCY2RHbG1LSFI1Y0dVOVBUMWNJblZ3WkdGMFpWd2lLU0I3WEhKY2JseDBJQ0FnSUNBZ0lDQmNkRngwWTJoaGJtZGxMbTlzWkZaaGJIVmxJRDBnYjJ4a2RtRnNkV1U3WEhKY2JseDBJQ0FnSUNBZ0lDQmNkSDFjY2x4dVhIUWdJQ0FnSUNBZ0lGeDBkR2hwY3k1amFHRnVaMlZ6WlhRdWNIVnphQ2hqYUdGdVoyVXBPMXh5WEc1Y2RDQWdJQ0FnSUNBZ1hIUnBaaWh6ZEdGeWRDa2dlMXh5WEc1Y2RDQWdJQ0FnSUNBZ1hIUmNkR1JsYkdsMlpYSW9abUZzYzJVc0tIUjVjR1Z2Wmloa1pXeHBkbVZ5TG1SbGJHRjVLVDA5UFZ3aWJuVnRZbVZ5WENJZ1B5QmtaV3hwZG1WeUxtUmxiR0Y1SURvZ01UQXBLVHRjY2x4dVhIUWdJQ0FnSUNBZ0lGeDBmVnh5WEc1Y2RDQWdJQ0JjZEgxY2NseHVYSFFnSUNBZ1hIUnlaWFIxY200Z2RISjFaVHRjY2x4dVhIUWdJQ0FnZlR0Y2NseHVYSFFnSUNBZ1QySnpaWEoyWlhJdWNISnZkRzkwZVhCbExtUmxiR1YwWlZCeWIzQmxjblI1SUQwZ1puVnVZM1JwYjI0b2RHRnlaMlYwTENCd2NtOXdaWEowZVNrZ2UxeHlYRzVjZENBZ0lDQmNkSFpoY2lCdmJHUjJZV3gxWlNBOUlIUmhjbWRsZEZ0d2NtOXdaWEowZVYwN1hISmNibHgwSUNBZ0lGeDBMeTlwWmloMGVYQmxiMllvYjJ4a2RtRnNkV1VwSVQwOVhDSjFibVJsWm1sdVpXUmNJaWtnZTF4eVhHNWNkRngwSUNBZ0lGeDBaR1ZzWlhSbElIUmhjbWRsZEZ0d2NtOXdaWEowZVYwN1hISmNibHgwWEhRZ0lDQWdYSFJwWmloMFlYSm5aWFF1WDE5dlluTmxjblpsY25OZlh5NXBibVJsZUU5bUtIUm9hWE1wUGowd0lDWW1JQ0YwYUdsekxtRmpZMlZ3ZEd4cGMzUWdmSHdnZEdocGN5NWhZMk5sY0hSc2FYTjBMbWx1WkdWNFQyWW9YQ0prWld4bGRHVmNJaWsrUFRBcElIdGNjbHh1WEhSY2RDQWdJQ0FnSUNBZ1hIUjJZWElnWTJoaGJtZGxJRDBnZTI5aWFtVmpkRHAwWVhKblpYUXNibUZ0WlRwd2NtOXdaWEowZVN4MGVYQmxPbHdpWkdWc1pYUmxYQ0lzYjJ4a1ZtRnNkV1U2YjJ4a2RtRnNkV1Y5TEZ4eVhHNWNkRngwSUNBZ0lDQWdJQ0JjZEZ4MGMzUmhjblFnUFNCMGFHbHpMbU5vWVc1blpYTmxkQzVzWlc1bmRHZ2dQVDA5SURBc1hISmNibHgwWEhRZ0lDQWdJQ0FnSUZ4MFhIUmtaV3hwZG1WeUlEMGdkR2hwY3k1a1pXeHBkbVZ5S0NrN1hISmNibHgwWEhRZ0lDQWdJQ0FnSUZ4MGRHaHBjeTVqYUdGdVoyVnpaWFF1Y0hWemFDaGphR0Z1WjJVcE8xeHlYRzVjZEZ4MElDQWdJQ0FnSUNCY2RHbG1LSE4wWVhKMEtTQjdYSEpjYmx4MFhIUWdJQ0FnSUNBZ0lGeDBYSFJrWld4cGRtVnlLR1poYkhObExDaDBlWEJsYjJZb1pHVnNhWFpsY2k1a1pXeGhlU2s5UFQxY0ltNTFiV0psY2x3aUlEOGdaR1ZzYVhabGNpNWtaV3hoZVNBNklERXdLU2s3WEhKY2JseDBYSFFnSUNBZ0lDQWdJRngwZlZ4eVhHNWNkRngwSUNBZ0lGeDBmVnh5WEc1Y2RDQWdJQ0JjZEM4dmZWeHlYRzVjZENBZ0lDQmNkSEpsZEhWeWJpQjBjblZsTzF4eVhHNWNkQ0FnSUNCOU8xeHlYRzVjZENBZ0lDQlBZbk5sY25abGNpNXdjbTkwYjNSNWNHVXVaR1ZtYVc1bFVISnZjR1Z5ZEhrZ1BTQm1kVzVqZEdsdmJpaDBZWEpuWlhRc0lIQnliM0JsY25SNUxDQmtaWE5qY21sd2RHOXlLU0I3WEhKY2JseDBJQ0FnSUZ4MFQySnFaV04wTG1SbFptbHVaVkJ5YjNCbGNuUjVLSFJoY21kbGRDd2djSEp2Y0dWeWRIa3NJR1JsYzJOeWFYQjBiM0lwTzF4eVhHNWNkQ0FnSUNCY2RHbG1LSFJoY21kbGRDNWZYMjlpYzJWeWRtVnljMTlmTG1sdVpHVjRUMllvZEdocGN5aytQVEFnSmlZZ0lYUm9hWE11WVdOalpYQjBiR2x6ZENCOGZDQjBhR2x6TG1GalkyVndkR3hwYzNRdWFXNWtaWGhQWmloY0luSmxZMjl1Wm1sbmRYSmxYQ0lwUGowd0tTQjdYSEpjYmx4MElDQWdJQ0FnSUNCY2RIWmhjaUJqYUdGdVoyVWdQU0I3YjJKcVpXTjBPblJoY21kbGRDeHVZVzFsT25CeWIzQmxjblI1TEhSNWNHVTZYQ0p5WldOdmJtWnBaM1Z5WlZ3aWZTeGNjbHh1SUNBZ0lDQWdJQ0JjZEZ4MFhIUnpkR0Z5ZENBOUlIUm9hWE11WTJoaGJtZGxjMlYwTG14bGJtZDBhQ0E5UFQwZ01DeGNjbHh1SUNBZ0lDQWdJQ0JjZEZ4MFhIUmtaV3hwZG1WeUlEMGdkR2hwY3k1a1pXeHBkbVZ5S0NrN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEhSb2FYTXVZMmhoYm1kbGMyVjBMbkIxYzJnb1kyaGhibWRsS1R0Y2NseHVYSFFnSUNBZ0lDQWdJRngwYVdZb2MzUmhjblFwSUh0Y2NseHVYSFFnSUNBZ0lDQWdJRngwWEhSa1pXeHBkbVZ5S0daaGJITmxMQ2gwZVhCbGIyWW9aR1ZzYVhabGNpNWtaV3hoZVNrOVBUMWNJbTUxYldKbGNsd2lJRDhnWkdWc2FYWmxjaTVrWld4aGVTQTZJREV3S1NrN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEgxY2NseHVYSFFnSUNBZ1hIUjlYSEpjYmx4MElDQWdJRngwY21WMGRYSnVJSFJ5ZFdVN1hISmNibHgwSUNBZ0lIMDdYSEpjYmx4MElDQWdJRTlpYzJWeWRtVnlMbkJ5YjNSdmRIbHdaUzV6WlhSUWNtOTBiM1I1Y0dWUFppQTlJR1oxYm1OMGFXOXVLSFJoY21kbGRDd2djSEp2ZEc5MGVYQmxLU0I3WEhKY2JseDBJQ0FnSUZ4MGRtRnlJRzlzWkhaaGJIVmxJRDBnVDJKcVpXTjBMbWRsZEZCeWIzUnZkSGx3WlU5bUtIUmhjbWRsZENrN1hISmNibHgwSUNBZ0lGeDBUMkpxWldOMExuTmxkRkJ5YjNSdmRIbHdaVTltS0hSaGNtZGxkQ3dnY0hKdmRHOTBlWEJsS1R0Y2NseHVYSFFnSUNBZ1hIUnBaaWgwWVhKblpYUXVYMTl2WW5ObGNuWmxjbk5mWHk1cGJtUmxlRTltS0hSb2FYTXBQajB3SUNZbUlDRjBhR2x6TG1GalkyVndkR3hwYzNRZ2ZId2dkR2hwY3k1aFkyTmxjSFJzYVhOMExtbHVaR1Y0VDJZb1hDSnpaWFJRY205MGIzUjVjR1ZjSWlrK1BUQXBJSHRjY2x4dVhIUWdJQ0FnSUNBZ0lGeDBkbUZ5SUdOb1lXNW5aU0E5SUh0dlltcGxZM1E2ZEdGeVoyVjBMRzVoYldVNlhDSmZYM0J5YjNSdlgxOWNJaXgwZVhCbE9sd2ljMlYwVUhKdmRHOTBlWEJsWENJc2IyeGtWbUZzZFdVNmIyeGtkbUZzZFdWOUxGeHlYRzRnSUNBZ1hIUmNkRngwWEhSemRHRnlkQ0E5SUhSb2FYTXVZMmhoYm1kbGMyVjBMbXhsYm1kMGFDQTlQVDBnTUN4Y2NseHVJQ0FnSUZ4MFhIUmNkRngwWkdWc2FYWmxjaUE5SUhSb2FYTXVaR1ZzYVhabGNpZ3BPMXh5WEc1Y2RDQWdJQ0FnSUNBZ1hIUjBhR2x6TG1Ob1lXNW5aWE5sZEM1d2RYTm9LR05vWVc1blpTazdYSEpjYmx4MElDQWdJQ0FnSUNCY2RHbG1LSE4wWVhKMEtTQjdYSEpjYmx4MElDQWdJQ0FnSUNCY2RGeDBaR1ZzYVhabGNpaG1ZV3h6WlN3b2RIbHdaVzltS0dSbGJHbDJaWEl1WkdWc1lYa3BQVDA5WENKdWRXMWlaWEpjSWlBL0lHUmxiR2wyWlhJdVpHVnNZWGtnT2lBeE1Da3BPMXh5WEc1Y2RDQWdJQ0FnSUNBZ1hIUjlYSEpjYmx4MElDQWdJRngwZlZ4eVhHNWNkQ0FnSUNCY2RISmxkSFZ5YmlCMGNuVmxPMXh5WEc1Y2RDQWdJQ0I5TzF4eVhHNWNkQ0FnSUNCUFluTmxjblpsY2k1d2NtOTBiM1I1Y0dVdWNISmxkbVZ1ZEVWNGRHVnVjMmx2Ym5NZ1BTQm1kVzVqZEdsdmJpaDBZWEpuWlhRcElIdGNjbHh1WEhRZ0lDQWdJQ0FnSUU5aWFtVmpkQzV3Y21WMlpXNTBSWGgwWlc1emFXOXVjeWgwWVhKblpYUXBPMXh5WEc1Y2RDQWdJQ0JjZEdsbUtIUmhjbWRsZEM1ZlgyOWljMlZ5ZG1WeWMxOWZMbWx1WkdWNFQyWW9kR2hwY3lrK1BUQWdKaVlnSVhSb2FYTXVZV05qWlhCMGJHbHpkQ0I4ZkNCMGFHbHpMbUZqWTJWd2RHeHBjM1F1YVc1a1pYaFBaaWhjSW5CeVpYWmxiblJGZUhSbGJuTnBiMjV6WENJcFBqMHdLU0I3WEhKY2JseDBJQ0FnSUNBZ0lDQmNkSFpoY2lCamFHRnVaMlVnUFNCN2IySnFaV04wT25SaGNtZGxkQ3gwZVhCbE9sd2ljSEpsZG1WdWRFVjRkR1Z1YzJsdmJuTmNJbjBzWEhKY2JseDBYSFJjZEZ4MFhIUnpkR0Z5ZENBOUlIUm9hWE11WTJoaGJtZGxjMlYwTG14bGJtZDBhQ0E5UFQwZ01DeGNjbHh1WEhSY2RGeDBYSFJjZEdSbGJHbDJaWElnUFNCMGFHbHpMbVJsYkdsMlpYSW9LVHRjY2x4dVhIUWdJQ0FnSUNBZ0lGeDBkR2hwY3k1amFHRnVaMlZ6WlhRdWNIVnphQ2hqYUdGdVoyVXBPMXh5WEc1Y2RDQWdJQ0FnSUNBZ1hIUnBaaWh6ZEdGeWRDa2dlMXh5WEc1Y2RDQWdJQ0FnSUNBZ1hIUmNkR1JsYkdsMlpYSW9abUZzYzJVc0tIUjVjR1Z2Wmloa1pXeHBkbVZ5TG1SbGJHRjVLVDA5UFZ3aWJuVnRZbVZ5WENJZ1B5QmtaV3hwZG1WeUxtUmxiR0Y1SURvZ01UQXBLVHRjY2x4dVhIUWdJQ0FnSUNBZ0lGeDBmVnh5WEc1Y2RDQWdJQ0JjZEgxY2NseHVYSFFnSUNBZ1hIUnlaWFIxY200Z2RISjFaVHRjY2x4dVhIUWdJQ0FnZlR0Y2NseHVYSFFnSUNBZ1QySnFaV04wTG05aWMyVnlkbVVnUFNCbWRXNWpkR2x2YmlodlltcGxZM1FzWTJGc2JHSmhZMnNzWVdOalpYQjBiR2x6ZEN4d1lYVnpZV0pzWlN4d1lYVnpaU3hrWld4aGVTa2dlMXh5WEc1Y2RDQWdJQ0JjZEhKbGRIVnliaUJ1WlhjZ1QySnpaWEoyWlhJb2IySnFaV04wTEdOaGJHeGlZV05yTEdGalkyVndkR3hwYzNRc2NHRjFjMkZpYkdVc2NHRjFjMlVzWkdWc1lYa3BPMXh5WEc1Y2RDQWdJQ0I5TzF4eVhHNWNkQ0FnSUNCUFltcGxZM1F1ZFc1dlluTmxjblpsSUQwZ1puVnVZM1JwYjI0b2IySnFaV04wTEdOaGJHeGlZV05yS1NCN1hISmNibHgwSUNBZ0lGeDBhV1lvYjJKcVpXTjBMbDlmYjJKelpYSjJaWEpEWVd4c1ltRmphM05mWHlrZ2UxeHlYRzVjZENBZ0lDQmNkRngwYVdZb0lXTmhiR3hpWVdOcktTQjdYSEpjYmx4MElDQWdJRngwWEhSY2RHOWlhbVZqZEM1ZlgyOWljMlZ5ZG1WeVEyRnNiR0poWTJ0elgxOHVjM0JzYVdObEtEQXNiMkpxWldOMExsOWZiMkp6WlhKMlpYSkRZV3hzWW1GamEzTmZYeTVzWlc1bmRHZ3BPMXh5WEc1Y2RDQWdJQ0JjZEZ4MFhIUnZZbXBsWTNRdVgxOXZZbk5sY25abGNuTmZYeTV6Y0d4cFkyVW9NQ3h2WW1wbFkzUXVYMTl2WW5ObGNuWmxjbk5mWHk1c1pXNW5kR2dwTzF4eVhHNWNkQ0FnSUNCY2RGeDBYSFJ5WlhSMWNtNDdYSEpjYmx4MElDQWdJRngwWEhSOVhISmNibHgwSUNBZ0lGeDBYSFJ2WW1wbFkzUXVYMTl2WW5ObGNuWmxja05oYkd4aVlXTnJjMTlmTG1admNrVmhZMmdvWm5WdVkzUnBiMjRvYjJKelpYSjJaWEpqWVd4c1ltRmpheXhwS1NCN1hISmNibHgwSUNBZ0lGeDBYSFJjZEdsbUtHTmhiR3hpWVdOclBUMDliMkp6WlhKMlpYSmpZV3hzWW1GamF5a2dlMXh5WEc1Y2RDQWdJQ0JjZEZ4MFhIUmNkRzlpYW1WamRDNWZYMjlpYzJWeWRtVnlRMkZzYkdKaFkydHpYMTh1YzNCc2FXTmxLR2tzTVNrN1hISmNibHgwSUNBZ0lGeDBYSFJjZEZ4MFpHVnNaWFJsSUc5aWFtVmpkQzVmWDI5aWMyVnlkbVZ5YzE5ZlcybGRMbU5oYkd4aVlXTnJPMXh5WEc1Y2RDQWdJQ0JjZEZ4MFhIUmNkRzlpYW1WamRDNWZYMjlpYzJWeWRtVnljMTlmTG5Od2JHbGpaU2hwTERFcE8xeHlYRzVjZENBZ0lDQmNkRngwWEhSOVhISmNibHgwSUNBZ0lGeDBYSFI5S1R0Y2NseHVYSFFnSUNBZ1hIUjlYSEpjYmx4MElDQWdJSDA3WEhKY2JseDBJQ0FnSUVGeWNtRjVMbTlpYzJWeWRtVWdQU0JtZFc1amRHbHZiaWh2WW1wbFkzUXNZMkZzYkdKaFkyc3NZV05qWlhCMGJHbHpkQ3h3WVhWellXSnNaU3h3WVhWelpTeGtaV3hoZVNrZ2UxeHlYRzVjZENBZ0lDQmNkR2xtS0NFb2IySnFaV04wSUdsdWMzUmhibU5sYjJZZ1FYSnlZWGtwSUNZbUlDRkJjbkpoZVM1cGMwRnljbUY1S0c5aWFtVmpkQ2twSUh0Y2NseHVYSFFnSUNBZ1hIUmNkSFJvY205M0lHNWxkeUJVZVhCbFJYSnliM0lvWENKR2FYSnpkQ0JoY21kMWJXVnVkQ0IwYnlCQmNuSmhlUzV2WW5ObGNuWmxjaUJwY3lCdWIzUWdZVzRnUVhKeVlYbGNJaWs3WEhKY2JseDBJQ0FnSUZ4MGZWeHlYRzRnSUNBZ0lDQWdJQ0FnSUNCY2RHRmpZMlZ3ZEd4cGMzUWdQU0JoWTJObGNIUnNhWE4wSUh4OElGdGNJbUZrWkZ3aUxDQmNJblZ3WkdGMFpWd2lMQ0JjSW1SbGJHVjBaVndpTENCY0luTndiR2xqWlZ3aVhUdGNjbHh1WEhRZ0lDQWdYSFIyWVhJZ1lYSnlZWGx3Y205NGVTQTlJRzVsZHlCUWNtOTRlU2h2WW1wbFkzUXNlMmRsZERvZ1puVnVZM1JwYjI0b2RHRnlaMlYwTEhCeWIzQmxjblI1S1NCN1hISmNibHgwSUNBZ0lGeDBYSFJwWmlod2NtOXdaWEowZVQwOVBWd2lkVzV2WW5ObGNuWmxYQ0lwSUh0Y2NseHVYSFJjZENBZ0lDQmNkRngwY21WMGRYSnVJR1oxYm1OMGFXOXVLR05oYkd4aVlXTnJLU0I3WEhKY2JseDBYSFFnSUNBZ1hIUmNkRngwYVdZb1kyRnNiR0poWTJzcElIdGNjbHh1WEhSY2RDQWdJQ0JjZEZ4MFhIUmNkSEpsZEhWeWJpQlBZbXBsWTNRdWRXNXZZbk5sY25abEtIUmhjbWRsZEN4allXeHNZbUZqYXlrN1hISmNibHgwWEhRZ0lDQWdYSFJjZEZ4MGZWeHlYRzVjZEZ4MElDQWdJRngwWEhSY2RISmxkSFZ5YmlCMFlYSm5aWFF1ZFc1dlluTmxjblpsS0NrN1hISmNibHgwWEhRZ0lDQWdYSFJjZEgwN1hISmNibHgwWEhRZ0lDQWdYSFI5WEhKY2JseDBJQ0FnSUZ4MFhIUnBaaWh3Y205d1pYSjBlVDA5UFZ3aWMzQnNhV05sWENJcElIdGNjbHh1WEhRZ0lDQWdYSFJjZEZ4MGNtVjBkWEp1SUdaMWJtTjBhVzl1S0hOMFlYSjBMR1Z1WkNrZ2UxeHlYRzVjZENBZ0lDQmNkRngwWEhSY2RHbG1LSFI1Y0dWdlppaHpkR0Z5ZENraFBUMWNJbTUxYldKbGNsd2lJSHg4SUhSNWNHVnZaaWhsYm1RcElUMDlYQ0p1ZFcxaVpYSmNJaWtnZTF4eVhHNWNkQ0FnSUNCY2RGeDBYSFJjZEZ4MGRHaHliM2NnYm1WM0lGUjVjR1ZGY25KdmNpaGNJa1pwY25OMElIUjNieUJoY21kMWJXVnVkSE1nZEc4Z1FYSnlZWGtnYzNCc2FXTmxJR0Z5WlNCdWIzUWdiblZ0WW1WeUxDQnVkVzFpWlhKY0lpazdYSEpjYmx4MElDQWdJRngwWEhSY2RGeDBmVnh5WEc1Y2RDQWdJQ0JjZENBZ0lDQmNkRngwZG1GeUlISmxiVzkyWldRZ1BTQjBhR2x6TG5Oc2FXTmxLSE4wWVhKMExITjBZWEowSzJWdVpDa3NYSEpjYmx4MElDQWdJRngwSUNBZ0lGeDBYSFJjZEdGa1pHVmtRMjkxYm5RZ1BTQW9ZWEpuZFcxbGJuUnpMbXhsYm1kMGFDQStJREVnUHlCaGNtZDFiV1Z1ZEhNdWJHVnVaM1JvTFRJZ09pQXdLU3hjY2x4dVhIUWdJQ0FnWEhRZ0lDQWdYSFJjZEZ4MFkyaGhibWRsSUQwZ0lIdHZZbXBsWTNRNmIySnFaV04wTEhSNWNHVTZYQ0p6Y0d4cFkyVmNJaXhwYm1SbGVEcHpkR0Z5ZEN4eVpXMXZkbVZrT25KbGJXOTJaV1FzWVdSa1pXUkRiM1Z1ZERwaFpHUmxaRU52ZFc1MGZUdGNjbHh1WEhRZ0lDQWdYSFFnSUNBZ1hIUmNkSFJoY21kbGRDNXpjR3hwWTJVdVlYQndiSGtvZEdGeVoyVjBMR0Z5WjNWdFpXNTBjeWs3WEhKY2JseDBJQ0FnSUZ4MElDQWdJRngwWEhScFppaGhZMk5sY0hSc2FYTjBMbWx1WkdWNFQyWW9YQ0p6Y0d4cFkyVmNJaWsrUFRBcElIdGNjbHh1WEhRZ0lDQWdYSFFnSUNBZ1hIUmNkRngwZG1GeUlITjBZWEowSUQwZ2NISnZlSGt1WDE5dlluTmxjblpsY2w5ZkxtTm9ZVzVuWlhObGRDNXNaVzVuZEdnZ1BUMDlJREFzWEhKY2JseDBJQ0FnSUZ4MElDQWdJQ0FnSUNCY2RGeDBYSFJrWld4cGRtVnlJRDBnY0hKdmVIa3VYMTl2WW5ObGNuWmxjbDlmTG1SbGJHbDJaWElvS1R0Y2NseHVYSFFnSUNBZ1hIUWdJQ0FnWEhSY2RGeDBjSEp2ZUhrdVgxOXZZbk5sY25abGNsOWZMbU5vWVc1blpYTmxkQzV3ZFhOb0tHTm9ZVzVuWlNrN1hISmNibHgwSUNBZ0lGeDBJQ0FnSUZ4MFhIUmNkR2xtS0hOMFlYSjBLU0I3WEhKY2JseDBJQ0FnSUZ4MFhIUWdJQ0FnSUNBZ0lGeDBYSFJrWld4cGRtVnlLR1poYkhObExDaDBlWEJsYjJZb1pHVnNhWFpsY2k1a1pXeGhlU2s5UFQxY0ltNTFiV0psY2x3aUlEOGdaR1ZzYVhabGNpNWtaV3hoZVNBNklERXdLU2s3WEhKY2JseDBJQ0FnSUZ4MFhIUWdJQ0FnSUNBZ0lGeDBmVnh5WEc1Y2RDQWdJQ0JjZENBZ0lDQmNkRngwZlZ4eVhHNWNkQ0FnSUNCY2RDQWdJQ0JjZEgxY2NseHVYSFFnSUNBZ1hIUmNkSDFjY2x4dVhIUWdJQ0FnWEhSY2RHbG1LSEJ5YjNCbGNuUjVQVDA5WENKd2RYTm9YQ0lwSUh0Y2NseHVYSFFnSUNBZ1hIUmNkRngwSUhKbGRIVnliaUJtZFc1amRHbHZiaWhwZEdWdEtTQjdYSEpjYmx4MElDQWdJRngwWEhRZ0lDQWdYSFJ5WlhSMWNtNGdkR2hwY3k1emNHeHBZMlVvZEdocGN5NXNaVzVuZEdnc01DeHBkR1Z0S1R0Y2NseHVYSFFnSUNBZ1hIUmNkQ0FnSUNCOVhISmNibHgwSUNBZ0lGeDBYSFI5WEhKY2JseDBJQ0FnSUZ4MFhIUnBaaWh3Y205d1pYSjBlVDA5UFZ3aWNHOXdYQ0lwSUh0Y2NseHVYSFFnSUNBZ1hIUmNkRngwSUhKbGRIVnliaUJtZFc1amRHbHZiaWdwSUh0Y2NseHVYSFFnSUNBZ1hIUmNkQ0FnSUNCY2RISmxkSFZ5YmlCMGFHbHpMbk53YkdsalpTaDBhR2x6TG14bGJtZDBhQzB4TERFcE8xeHlYRzVjZENBZ0lDQmNkRngwSUNBZ0lIMWNjbHh1WEhRZ0lDQWdYSFJjZEgxY2NseHVYSFFnSUNBZ1hIUmNkR2xtS0hCeWIzQmxjblI1UFQwOVhDSjFibk5vYVdaMFhDSXBJSHRjY2x4dVhIUWdJQ0FnWEhSY2RGeDBJSEpsZEhWeWJpQm1kVzVqZEdsdmJpaHBkR1Z0S1NCN1hISmNiaUFnSUNCY2RGeDBJQ0FnSUZ4MFhIUnlaWFIxY200Z2RHaHBjeTV6Y0d4cFkyVW9NQ3d3TEdsMFpXMHBPMXh5WEc0Z0lDQWdYSFJjZENBZ0lDQmNkSDFjY2x4dVhIUWdJQ0FnWEhSY2RIMWNjbHh1WEhRZ0lDQWdYSFJjZEdsbUtIQnliM0JsY25SNVBUMDlYQ0p6YUdsbWRGd2lLU0I3WEhKY2JseDBJQ0FnSUZ4MFhIUmNkSEpsZEhWeWJpQm1kVzVqZEdsdmJpZ3BJSHRjY2x4dVhIUWdJQ0FnWEhRZ0lDQWdYSFJjZEhKbGRIVnliaUIwYUdsekxuTndiR2xqWlNnd0xERXBPMXh5WEc1Y2RDQWdJQ0JjZENBZ0lDQmNkSDFjY2x4dVhIUWdJQ0FnWEhSY2RIMWNjbHh1WEhRZ0lDQWdYSFJjZEhKbGRIVnliaUIwWVhKblpYUmJjSEp2Y0dWeWRIbGRPMXh5WEc1Y2RDQWdJQ0JjZEgxOUtUdGNjbHh1WEhRZ0lDQWdYSFIyWVhJZ2NISnZlSGtnUFNCUFltcGxZM1F1YjJKelpYSjJaU2hoY25KaGVYQnliM2g1TEdaMWJtTjBhVzl1S0dOb1lXNW5aWE5sZENrZ2V5QmNjbHh1WEhRZ0lDQWdYSFJjZEhaaGNpQmphR0Z1WjJWeklEMGdZMmhoYm1kbGMyVjBMbVpwYkhSbGNpaG1kVzVqZEdsdmJpaGphR0Z1WjJVcElIc2djbVYwZFhKdUlHTm9ZVzVuWlM1dVlXMWxJVDA5WENKc1pXNW5kR2hjSWlBbUppQmphR0Z1WjJVdWJtRnRaU0U5UFZ3aVlXUmtYQ0lnSmlZZ0tDRmhZMk5sY0hSc2FYTjBJSHg4SUdGalkyVndkR3hwYzNRdWFXNWtaWGhQWmloamFHRnVaMlV1ZEhsd1pTaytQVEFwT3lCOUtUdGNjbHh1WEhRZ0lDQWdYSFJjZEdsbUtHTm9ZVzVuWlhNdWJHVnVaM1JvUGpBcElIdGNjbHh1WEhRZ0lDQWdYSFJjZEZ4MFkyRnNiR0poWTJzb1kyaGhibWRsY3lrN1hISmNibHgwSUNBZ0lGeDBYSFI5WEhKY2JseDBJQ0FnSUZ4MGZTeGhZMk5sY0hSc2FYTjBMSEJoZFhOaFlteGxMSEJoZFhObExHUmxiR0Y1S1R0Y2NseHVYSFFnSUNBZ1hIUnlaWFIxY200Z2NISnZlSGs3WEhKY2JseDBJQ0FnSUgwN1hISmNibHgwSUNBZ0lFRnljbUY1TG5WdWIySnpaWEoyWlNBOUlHWjFibU4wYVc5dUtHOWlhbVZqZEN4allXeHNZbUZqYXlrZ2UxeHlYRzVjZEZ4MElDQnlaWFIxY200Z2IySnFaV04wTG5WdWIySnpaWEoyWlNoallXeHNZbUZqYXlrN1hISmNibHgwSUNBZ0lIMWNjbHh1WEhSOVhISmNibHgwVDJKcVpXTjBMbVJsWlhCUFluTmxjblpsSUQwZ1puVnVZM1JwYjI0b2IySnFaV04wTEdOaGJHeGlZV05yTEhCaGNuUnpLU0I3WEhKY2JseHlYRzVjZEZ4MGNHRnlkSE1nUFNBb2NHRnlkSE1nUHlCd1lYSjBjeUE2SUZ0ZEtUdGNjbHh1WEhKY2JseDBYSFIyWVhJZ2RHOVVlWEJsVG1GdFpTQTlJR1oxYm1OMGFXOXVLRzlpYWlrZ2UxeHlYRzVjZEZ4MFhIUnlaWFIxY200Z0tIdDlLUzUwYjFOMGNtbHVaeTVqWVd4c0tHOWlhaWt1YldGMFkyZ29MMXhjY3loYllTMTZRUzFhWFNzcEx5bGJNVjB1ZEc5TWIzZGxja05oYzJVb0tWeHlYRzVjZEZ4MGZWeHlYRzVjY2x4dVhIUmNkR1oxYm1OMGFXOXVJSEpsYjJKelpYSjJaU2gyWVd4MVpTd2djR0Z5ZEhNcElIdGNjbHh1WEhSY2RGeDBkbUZ5SUd0bGVYTWdQU0JQWW1wbFkzUXVhMlY1Y3loMllXeDFaU2s3WEhKY2JseDBYSFJjZEd0bGVYTXVabTl5UldGamFDaG1kVzVqZEdsdmJpaHJaWGtwSUh0Y2NseHVYSFJjZEZ4MFhIUnBaaWdvZEc5VWVYQmxUbUZ0WlNoMllXeDFaVnRyWlhsZEtTQTlQVDBnSjI5aWFtVmpkQ2NnZkh3Z2RHOVVlWEJsVG1GdFpTaDJZV3gxWlZ0clpYbGRLU0E5UFQwZ0oyRnljbUY1SnlrZ0ppWWdJWFpoYkhWbFcydGxlVjB1YUdGelQzZHVVSEp2Y0dWeWRIa29KMTlmYjJKelpYSjJaWEp6WDE4bktTa2dlMXh5WEc1Y2RGeDBYSFJjZEZ4MGRtRnlJRzVsZDNCaGNuUnpJRDBnY0dGeWRITXVjMnhwWTJVb01DazdYSEpjYmx4MFhIUmNkRngwWEhSdVpYZHdZWEowY3k1d2RYTm9LR3RsZVNrN1hISmNibHgwWEhSY2RGeDBYSFIyWVd4MVpWdHJaWGxkSUQwZ1QySnFaV04wTG1SbFpYQlBZbk5sY25abEtIWmhiSFZsVzJ0bGVWMHNZMkZzYkdKaFkyc3NibVYzY0dGeWRITXBPMXh5WEc1Y2RGeDBYSFJjZEgxY2NseHVYSFJjZEZ4MGZTazdYSEpjYmx4MFhIUjlYSEpjYmx4eVhHNWNkRngwY21WdlluTmxjblpsS0c5aWFtVmpkQ3dnY0dGeWRITXBPMXh5WEc1Y2NseHVYSFJjZEhaaGNpQnZZbk5sY25abFpDQTlJRTlpYW1WamRDNXZZbk5sY25abEtHOWlhbVZqZEN4bWRXNWpkR2x2YmloamFHRnVaMlZ6WlhRcElIdGNjbHh1WEhSY2RGeDBkbUZ5SUdOb1lXNW5aWE1nUFNCYlhUdGNjbHh1WEhSY2RGeDBablZ1WTNScGIyNGdjbVZqZFhKelpTaHVZVzFsTEhKdmIzUlBZbXBsWTNRc2IyeGtUMkpxWldOMExHNWxkMDlpYW1WamRDeHdZWFJvS1NCN1hISmNibHgwWEhSY2RGeDBhV1lvYm1WM1QySnFaV04wSUdsdWMzUmhibU5sYjJZZ1QySnFaV04wS1NCN1hISmNibHgwWEhSY2RGeDBYSFIyWVhJZ2JtVjNhMlY1Y3lBOUlFOWlhbVZqZEM1clpYbHpLRzVsZDA5aWFtVmpkQ2s3WEhKY2JseDBYSFJjZEZ4MFhIUnVaWGRyWlhsekxtWnZja1ZoWTJnb1puVnVZM1JwYjI0b2EyVjVLU0I3WEhKY2JseDBYSFJjZEZ4MFhIUmNkR2xtS0NGdmJHUlBZbXBsWTNRZ2ZId2dLRzlzWkU5aWFtVmpkRnRyWlhsZElUMDlibVYzVDJKcVpXTjBXMnRsZVYwcEtTQjdYSEpjYmx4MFhIUmNkRngwWEhSY2RGeDBkbUZ5SUc5c1pIWmhiSFZsSUQwZ0tHOXNaRTlpYW1WamRDQW1KaUJ2YkdSUFltcGxZM1JiYTJWNVhTRTlQWFZ1WkdWbWFXNWxaQ0EvSUc5c1pFOWlhbVZqZEZ0clpYbGRJRG9nZFc1a1pXWnBibVZrS1N4Y2NseHVYSFJjZEZ4MFhIUmNkRngwWEhSY2RHTm9ZVzVuWlNBOUlDaHZiR1IyWVd4MVpUMDlQWFZ1WkdWbWFXNWxaQ0EvSUZ3aVlXUmtYQ0lnT2lCY0luVndaR0YwWlZ3aUtTeGNjbHh1WEhSY2RGeDBYSFJjZEZ4MFhIUmNkR3RsZVhCaGRHZ2dQU0J3WVhSb0lDc2dYQ0l1WENJZ0t5QnJaWGs3WEhKY2JseHlYRzVjZEZ4MFhIUmNkRngwWEhSY2RHTm9ZVzVuWlhNdWNIVnphQ2g3Ym1GdFpUcHVZVzFsTEc5aWFtVmpkRHB5YjI5MFQySnFaV04wTEhSNWNHVTZZMmhoYm1kbExHOXNaRlpoYkhWbE9tOXNaSFpoYkhWbExHNWxkMVpoYkhWbE9tNWxkMDlpYW1WamRGdHJaWGxkTEd0bGVYQmhkR2c2YTJWNWNHRjBhSDBwTzF4eVhHNWNkRngwWEhSY2RGeDBYSFJjZEhKbFkzVnljMlVvYm1GdFpTeHliMjkwVDJKcVpXTjBMRzlzWkhaaGJIVmxMRzVsZDA5aWFtVmpkRnRyWlhsZExHdGxlWEJoZEdncE8xeHlYRzVjZEZ4MFhIUmNkRngwWEhSOVhISmNibHgwWEhSY2RGeDBYSFI5S1R0Y2NseHVYSFJjZEZ4MFhIUjlJR1ZzYzJVZ2FXWW9iMnhrVDJKcVpXTjBJR2x1YzNSaGJtTmxiMllnVDJKcVpXTjBLU0I3WEhKY2JseDBYSFJjZEZ4MFhIUjJZWElnYjJ4a2EyVjVjeUE5SUU5aWFtVmpkQzVyWlhsektHOXNaRTlpYW1WamRDazdYSEpjYmx4MFhIUmNkRngwWEhSdmJHUnJaWGx6TG1admNrVmhZMmdvWm5WdVkzUnBiMjRvYTJWNUtTQjdYSEpjYmx4MFhIUmNkRngwWEhSY2RIWmhjaUJqYUdGdVoyVWdQU0FvYm1WM1QySnFaV04wUFQwOWJuVnNiQ0EvSUZ3aWRYQmtZWFJsWENJZ09pQmNJbVJsYkdWMFpWd2lLU3hjY2x4dVhIUmNkRngwWEhSY2RGeDBYSFJyWlhsd1lYUm9JRDBnY0dGMGFDQXJJRndpTGx3aUlDc2dhMlY1TzF4eVhHNWNkRngwWEhSY2RGeDBYSFJjZEZ4eVhHNWNkRngwWEhSY2RGeDBYSFJqYUdGdVoyVnpMbkIxYzJnb2UyNWhiV1U2Ym1GdFpTeHZZbXBsWTNRNmNtOXZkRTlpYW1WamRDeDBlWEJsT21Ob1lXNW5aU3h2YkdSV1lXeDFaVHB2YkdSUFltcGxZM1JiYTJWNVhTeHVaWGRXWVd4MVpUcHVaWGRQWW1wbFkzUXNhMlY1Y0dGMGFEcHJaWGx3WVhSb2ZTazdYSEpjYmx4MFhIUmNkRngwWEhSY2RISmxZM1Z5YzJVb2JtRnRaU3h5YjI5MFQySnFaV04wTEc5c1pFOWlhbVZqZEZ0clpYbGRMSFZ1WkdWbWFXNWxaQ3hyWlhsd1lYUm9LVHRjY2x4dVhIUmNkRngwWEhSY2RIMHBPMXh5WEc1Y2RGeDBYSFJjZEgxY2NseHVYSFJjZEZ4MGZWeHlYRzVjZEZ4MFhIUmphR0Z1WjJWelpYUXVabTl5UldGamFDaG1kVzVqZEdsdmJpaGphR0Z1WjJVcElIdGNjbHh1WEhSY2RGeDBYSFIyWVhJZ2EyVjVjR0YwYUNBOUlDaHdZWEowY3k1c1pXNW5kR2crTUNBL0lIQmhjblJ6TG1wdmFXNG9YQ0l1WENJcElDc2dYQ0l1WENJZ09pQmNJbHdpS1NBcklHTm9ZVzVuWlM1dVlXMWxPMXh5WEc1Y2NseHVYSFJjZEZ4MFhIUnBaaUFvWTJoaGJtZGxMblI1Y0dVZ1BUMDlJRndpZFhCa1lYUmxYQ0lnZkh3Z1kyaGhibWRsTG5SNWNHVWdQVDA5SUZ3aVlXUmtYQ0lwSUhzZ1hISmNibHgwWEhSY2RGeDBYSFJ5Wlc5aWMyVnlkbVVvWTJoaGJtZGxMbTlpYW1WamRDd2djR0Z5ZEhNcE8xeHlYRzVjZEZ4MFhIUmNkSDFjY2x4dVhISmNibHgwWEhSY2RGeDBZMmhoYm1kbGN5NXdkWE5vS0h0dVlXMWxPbU5vWVc1blpTNXVZVzFsTEc5aWFtVmpkRHBqYUdGdVoyVXViMkpxWldOMExIUjVjR1U2WTJoaGJtZGxMblI1Y0dVc2IyeGtWbUZzZFdVNlkyaGhibWRsTG05c1pGWmhiSFZsTEc1bGQxWmhiSFZsT21Ob1lXNW5aUzV2WW1wbFkzUmJZMmhoYm1kbExtNWhiV1ZkTEd0bGVYQmhkR2c2YTJWNWNHRjBhSDBwTzF4eVhHNWNkRngwWEhSY2RISmxZM1Z5YzJVb1kyaGhibWRsTG01aGJXVXNZMmhoYm1kbExtOWlhbVZqZEN4amFHRnVaMlV1YjJ4a1ZtRnNkV1VzWTJoaGJtZGxMbTlpYW1WamRGdGphR0Z1WjJVdWJtRnRaVjBzYTJWNWNHRjBhQ2s3WEhKY2JseDBYSFJjZEgwcE8xeHlYRzVjZEZ4MFhIUmpZV3hzWW1GamF5aGphR0Z1WjJWektUdGNjbHh1WEhSY2RIMHBPMXh5WEc1Y2RGeDBjbVYwZFhKdUlHOWljMlZ5ZG1Wa08xeHlYRzVjZEgwN1hISmNibjBwS0NrN1hISmNibHh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOXdjbTk0ZVMxdlluTmxjblpsTDJsdVpHVjRMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F4TVRsY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJRGNpTENJdktpcGNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdVRlFnU1c1dmRtSERwOE9qYnlCbElGTnBjM1JsYldGeklGTkJYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRWxPUlZORExVbEVYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRkZWVDBKSlV5Qk9SVlJYVDFKTFV5QlRURnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJHVWtGVlRraFBSa1ZTTFVkRlUwVk1URk5EU0VGR1ZDQmFWVklnUms5RlVrUkZVbFZPUnlCRVJWSWdRVTVIUlZkQlRrUlVSVTRnUms5U1UwTklWVTVISUVVdVZseHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQlBVa0ZPUjBVZ1UwRmNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdSR1YxZEhOamFHVWdWR1ZzWld0dmJTQkJSMXh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJCY0dsNlpXVmNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdWRVZEU0U1SlUwTklSU0JWVGtsV1JWSlRTVlJCVkNCQ1JWSk1TVTVjYmlwY2Jpb2dUR2xqWlc1elpXUWdkVzVrWlhJZ2RHaGxJRUZ3WVdOb1pTQk1hV05sYm5ObExDQldaWEp6YVc5dUlESXVNQ0FvZEdobElGd2lUR2xqWlc1elpWd2lLVHRjYmlvZ2VXOTFJRzFoZVNCdWIzUWdkWE5sSUhSb2FYTWdabWxzWlNCbGVHTmxjSFFnYVc0Z1kyOXRjR3hwWVc1alpTQjNhWFJvSUhSb1pTQk1hV05sYm5ObExseHVLaUJaYjNVZ2JXRjVJRzlpZEdGcGJpQmhJR052Y0hrZ2IyWWdkR2hsSUV4cFkyVnVjMlVnWVhSY2JpcGNiaW9nSUNCb2RIUndPaTh2ZDNkM0xtRndZV05vWlM1dmNtY3ZiR2xqWlc1elpYTXZURWxEUlU1VFJTMHlMakJjYmlwY2Jpb2dWVzVzWlhOeklISmxjWFZwY21Wa0lHSjVJR0Z3Y0d4cFkyRmliR1VnYkdGM0lHOXlJR0ZuY21WbFpDQjBieUJwYmlCM2NtbDBhVzVuTENCemIyWjBkMkZ5WlZ4dUtpQmthWE4wY21saWRYUmxaQ0IxYm1SbGNpQjBhR1VnVEdsalpXNXpaU0JwY3lCa2FYTjBjbWxpZFhSbFpDQnZiaUJoYmlCY0lrRlRJRWxUWENJZ1FrRlRTVk1zWEc0cUlGZEpWRWhQVlZRZ1YwRlNVa0ZPVkVsRlV5QlBVaUJEVDA1RVNWUkpUMDVUSUU5R0lFRk9XU0JMU1U1RUxDQmxhWFJvWlhJZ1pYaHdjbVZ6Y3lCdmNpQnBiWEJzYVdWa0xseHVLaUJUWldVZ2RHaGxJRXhwWTJWdWMyVWdabTl5SUhSb1pTQnpjR1ZqYVdacFl5QnNZVzVuZFdGblpTQm5iM1psY201cGJtY2djR1Z5YldsemMybHZibk1nWVc1a1hHNHFJR3hwYldsMFlYUnBiMjV6SUhWdVpHVnlJSFJvWlNCTWFXTmxibk5sTGx4dUtpb3ZYRzVjYm1sdGNHOXlkQ0I3SUdSbFpYQkRiRzl1WlNCOUlHWnliMjBnSnk0dUwzVjBhV3h6TDNWMGFXeHpKenRjYmx4dWFXMXdiM0owSUVSaGRHRlBZbXBsWTNRZ1puSnZiU0FuTGk5RVlYUmhUMkpxWldOMEp6dGNibWx0Y0c5eWRDQkVZWFJoVDJKcVpXTjBRMmhwYkdRZ1puSnZiU0FuTGk5RVlYUmhUMkpxWldOMFEyaHBiR1FuTzF4dVhHNXNaWFFnUm1sc2RHVnlWSGx3WlNBOUlIdEJUbGs2SUNkaGJua25MQ0JUVkVGU1ZEb2dKM04wWVhKMEp5d2dSVmhCUTFRNklDZGxlR0ZqZENkOU8xeHVYRzR2S2lwY2JpQXFJRlJvWlNCamJHRnpjeUJ5WlhSMWNtNWxaQ0JtY205dElIUm9aU0JUZVc1amFHVnlJSE4xWW5OamNtbGlaU0JqWVd4c0xseHVJQ29nVkc4Z1ltVWdkWE5sWkNCaGN5QmhiaUJ2WW5ObGNuWmhkR2x2YmlCd2IybHVkQ0JtY205dElHRWdSR0YwWVU5aWFtVmpkRkpsY0c5eWRHVnlJR05vWVc1blpTNWNiaUFxTDF4dVkyeGhjM01nUkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5SUdWNGRHVnVaSE1nUkdGMFlVOWlhbVZqZENBdktpQnBiWEJzWlcxbGJuUnpJRk41Ym1OVGRHRjBkWE1nS2k4Z2UxeHVJQ0F2S2lCd2NtbDJZWFJsWEc0Z0lGOWphR0Z1WjJWTWFYTjBaVzVsY2pvZ1RYTm5UR2x6ZEdWdVpYSmNibHh1SUNBdExTMHRaWFpsYm5RZ2FHRnVaR3hsY25NdExTMHRYRzRnSUY5bWFXeDBaWEp6T2lCN1BHWnBiSFJsY2o0NklIdDBlWEJsT2lBOGMzUmhjblFzSUdWNFlXTjBQaXdnWTJGc2JHSmhZMnM2SUR4bWRXNWpkR2x2Ymo1OUlIMWNiaUFnS2k5Y2JseHVJQ0F2S2lwY2JpQWdJQ29nUUdsbmJtOXlaVnh1SUNBZ0tpQlRhRzkxYkdRZ2JtOTBJR0psSUhWelpXUWdaR2x5WldOMGJIa2dZbmtnU0hsd1pYSjBhV1Z6TGlCSmRDZHpJR05oYkd4bFpDQmllU0IwYUdVZ1UzbHVZMmhsY2k1emRXSnpZM0pwWW1VZ2JXVjBhRzlrWEc0Z0lDQXFMMXh1WEc0Z0lDOHZWRTlFVHpvZ1JtOXlJRVoxY25Sb1pYSWdVM1IxWkhsY2JpQWdZMjl1YzNSeWRXTjBiM0lvYzNsdVkyaGxjaXdnZFhKc0xDQnpZMmhsYldFc0lHbHVhWFJwWVd4VGRHRjBkWE1zSUdsdWFYUnBZV3hFWVhSaExDQmphR2xzWkhKbGJuTXNJR2x1YVhScFlXeFdaWEp6YVc5dUxDQnRkWFIxWVd3c0lISmxjM1Z0WldRZ1BTQm1ZV3h6WlNrZ2UxeHVJQ0FnSUhOMWNHVnlLSE41Ym1Ob1pYSXNJSFZ5YkN3Z2MyTm9aVzFoTENCcGJtbDBhV0ZzVTNSaGRIVnpMQ0JwYm1sMGFXRnNSR0YwWVM1a1lYUmhMQ0JqYUdsc1pISmxibk1zSUcxMWRIVmhiQ3dnY21WemRXMWxaQ2s3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lGOTBhR2x6TGw5MlpYSnphVzl1SUQwZ2FXNXBkR2xoYkZabGNuTnBiMjQ3WEc0Z0lDQWdYM1JvYVhNdVgyWnBiSFJsY25NZ1BTQjdmVHRjYmx4dUlDQWdJRjkwYUdsekxsOXplVzVqVDJKcUxtOWljMlZ5ZG1Vb0tHVjJaVzUwS1NBOVBpQjdYRzRnSUNBZ0lDQmZkR2hwY3k1ZmIyNUdhV3gwWlhJb1pYWmxiblFwTzF4dUlDQWdJSDBwTzF4dVhHNGdJQ0FnYkdWMElHTm9hV3hrU1dSVGRISnBibWNnUFNCZmRHaHBjeTVmYjNkdVpYSWdLeUFuSXljZ0t5QmZkR2hwY3k1ZlkyaHBiR1JKWkR0Y2JseHVYRzRnSUNBZ0x5OXpaWFIxY0NCamFHbHNaSEpsYm5NZ1pHRjBZU0JtY205dElITjFZbk5qY21sd2RHbHZibHh1SUNBZ0lFOWlhbVZqZEM1clpYbHpLR2x1YVhScFlXeEVZWFJoTG1Ob2FXeGtjbVZ1Y3lrdVptOXlSV0ZqYUNnb1kyaHBiR1J5Wlc1U1pYTnZkWEpqWlNrZ1BUNGdlMXh1SUNBZ0lDQWdiR1YwSUdOb2FXeGtjbVZ1SUQwZ2FXNXBkR2xoYkVSaGRHRXVZMmhwYkdSeVpXNXpXMk5vYVd4a2NtVnVVbVZ6YjNWeVkyVmRPMXh1SUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvSjF0RVlYUmhUMkpxWldOMFQySnpaWEoyWlhJZ0xTQnVaWGNnUkdGMFlVOWlhbVZqZEVOb2FXeGtYVG9nSnl3Z1kyaHBiR1J5Wlc1U1pYTnZkWEpqWlN3Z1kyaHBiR1J5Wlc0c0lGOTBhR2x6TGw5eVpYTjFiV1ZrS1R0Y2JpQWdJQ0FnSUdsbUlDaGZkR2hwY3k1ZmNtVnpkVzFsWkNrZ2UxeHVYRzRnSUNBZ0lDQWdJQzh2SUdsbUlHbHpJSEpsYzNWdFpXUmNiaUFnSUNBZ0lDQWdUMkpxWldOMExtdGxlWE1vWTJocGJHUnlaVzRwTG1admNrVmhZMmdvS0dOb2FXeGtTV1FwSUQwK0lIdGNiaUFnSUNBZ0lDQWdJQ0JmZEdocGN5NWZZMmhwYkdSeVpXNVBZbXBsWTNSelcyTm9hV3hrU1dSZElEMGdibVYzSUVSaGRHRlBZbXBsWTNSRGFHbHNaQ2hmZEdocGN5d2dZMmhwYkdSSlpDd2dZMmhwYkdSeVpXNWJZMmhwYkdSSlpGMHVkbUZzZFdVcE8xeHVJQ0FnSUNBZ0lDQWdJRjkwYUdsekxsOWphR2xzWkhKbGJrOWlhbVZqZEhOYlkyaHBiR1JKWkYwdWFXUmxiblJwZEhrZ1BTQmphR2xzWkhKbGJsdGphR2xzWkVsa1hTNXBaR1Z1ZEdsMGVUdGNibHh1SUNBZ0lDQWdJQ0FnSUdsbUlDaGphR2xzWkVsa0lENGdZMmhwYkdSSlpGTjBjbWx1WnlrZ2UxeHVJQ0FnSUNBZ0lDQWdJQ0FnWTJocGJHUkpaRk4wY21sdVp5QTlJR05vYVd4a1NXUTdYRzRnSUNBZ0lDQWdJQ0FnZlZ4dVhHNGdJQ0FnSUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvSjF0RVlYUmhUMkpxWldOMFQySnpaWEoyWlhJZ0xTQnVaWGNnUkdGMFlVOWlhbVZqZEVOb2FXeGtYU0F0SUhKbGMzVnRaV1E2SUNjc0lGOTBhR2x6TGw5amFHbHNaSEpsYms5aWFtVmpkSE5iWTJocGJHUkpaRjBzSUNCamFHbHNaRWxrTENCamFHbHNaSEpsYmx0amFHbHNaRWxrWFM1MllXeDFaU2s3WEc0Z0lDQWdJQ0FnSUgwcE8xeHVYRzRnSUNBZ0lDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ0lDQXZMeUJwWmlCcGN5QnViM1FnY21WemRXMWxaRnh1SUNBZ0lDQWdJQ0JmZEdocGN5NWZZMmhwYkdSeVpXNVBZbXBsWTNSelcyTm9hV3hrY21WdVVtVnpiM1Z5WTJWZElEMGdibVYzSUVSaGRHRlBZbXBsWTNSRGFHbHNaQ2hmZEdocGN5d2dZMmhwYkdSeVpXNVNaWE52ZFhKalpTd2dZMmhwYkdSeVpXNHBPMXh1SUNBZ0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblcwUmhkR0ZQWW1wbFkzUlBZbk5sY25abGNpQXRJRzVsZHlCRVlYUmhUMkpxWldOMFEyaHBiR1JkSUMwZ2JtOTBJSEpsYzNWdFpXUTZJQ2NzSUY5MGFHbHpMbDlqYUdsc1pISmxiazlpYW1WamRITmJZMmhwYkdSeVpXNVNaWE52ZFhKalpWMHBPMXh1SUNBZ0lDQWdmVnh1WEc0Z0lDQWdmU2s3WEc1Y2JpQWdJQ0JmZEdocGN5NWZZMmhwYkdSSlpDQTlJRTUxYldKbGNpaGphR2xzWkVsa1UzUnlhVzVuTG5Od2JHbDBLQ2NqSnlsYk1WMHBPMXh1WEc0Z0lDQWdYM1JvYVhNdVgyRnNiRzlqWVhSbFRHbHpkR1Z1WlhKektDazdYRzRnSUgxY2JseHVJQ0JmWVd4c2IyTmhkR1ZNYVhOMFpXNWxjbk1vS1NCN1hHNGdJQ0FnYzNWd1pYSXVYMkZzYkc5allYUmxUR2x6ZEdWdVpYSnpLQ2s3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lGOTBhR2x6TGw5amFHRnVaMlZNYVhOMFpXNWxjaUE5SUY5MGFHbHpMbDlpZFhNdVlXUmtUR2x6ZEdWdVpYSW9YM1JvYVhNdVgzVnliQ0FySUNjdlkyaGhibWRsY3ljc0lDaHRjMmNwSUQwK0lIdGNiaUFnSUNBZ0lHbG1JQ2h0YzJjdWRIbHdaU0E5UFQwZ0ozVndaR0YwWlNjcElIdGNiaUFnSUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvSjBSaGRHRlBZbXBsWTNSUFluTmxjblpsY2kwbklDc2dYM1JvYVhNdVgzVnliQ0FySUNjdFVrTldPaUFuTENCdGMyY3BPMXh1SUNBZ0lDQWdJQ0JmZEdocGN5NWZZMmhoYm1kbFQySnFaV04wS0Y5MGFHbHpMbDl6ZVc1alQySnFMQ0J0YzJjcE8xeHVJQ0FnSUNBZ2ZWeHVJQ0FnSUgwcE8xeHVJQ0I5WEc1Y2JpQWdYM0psYkdWaGMyVk1hWE4wWlc1bGNuTW9LU0I3WEc0Z0lDQWdjM1Z3WlhJdVgzSmxiR1ZoYzJWTWFYTjBaVzVsY25Nb0tUdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWDNSb2FYTXVYMk5vWVc1blpVeHBjM1JsYm1WeUxuSmxiVzkyWlNncE8xeHVJQ0I5WEc1Y2JpQWdMeW9xWEc0Z0lDQXFJRkpsYkdWaGMyVWdZVzVrSUdSbGJHVjBaU0J2WW1wbFkzUWdaR0YwWVZ4dUlDQWdLaTljYmlBZ1pHVnNaWFJsS0NrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQ0JmZEdocGN5NWZjbVZzWldGelpVeHBjM1JsYm1WeWN5Z3BPMXh1SUNBZ0lHUmxiR1YwWlNCZmRHaHBjeTVmYzNsdVkyaGxjaTVmYjJKelpYSjJaWEp6VzE5MGFHbHpMbDkxY214ZE8xeHVJQ0I5WEc1Y2JpQWdMeW9xWEc0Z0lDQXFJRkpsYkdWaGMyVWdZVzVrSUdSbGJHVjBaU0J2WW1wbFkzUWdaR0YwWVZ4dUlDQWdLaTljYmlBZ2RXNXpkV0p6WTNKcFltVW9LU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lDOHZSa3hQVnkxUFZWUTZJSFJvYVhNZ2JXVnpjMkZuWlNCM2FXeHNJR0psSUhObGJuUWdkRzhnZEdobElISjFiblJwYldVZ2FXNXpkR0Z1WTJVZ2IyWWdVM2x1WTJobGNrMWhibUZuWlhJZ0xUNGdYMjl1VEc5allXeFZibE4xWW5OamNtbGlaVnh1SUNBZ0lHeGxkQ0IxYmxOMVluTmpjbWxpWlUxelp5QTlJSHRjYmlBZ0lDQWdJSFI1Y0dVNklDZDFibk4xWW5OamNtbGlaU2NzSUdaeWIyMDZJRjkwYUdsekxsOXZkMjVsY2l3Z2RHODZJRjkwYUdsekxsOXplVzVqYUdWeUxsOXpkV0pWVWt3c1hHNGdJQ0FnSUNCaWIyUjVPaUI3SUhKbGMyOTFjbU5sT2lCZmRHaHBjeTVmZFhKc0lIMWNiaUFnSUNCOU8xeHVYRzRnSUNBZ1gzUm9hWE11WDJKMWN5NXdiM04wVFdWemMyRm5aU2gxYmxOMVluTmpjbWxpWlUxelp5d2dLSEpsY0d4NUtTQTlQaUI3WEc0Z0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblJHRjBZVTlpYW1WamRFOWljMlZ5ZG1WeUxWVk9VMVZDVTBOU1NVSkZPaUFuTENCeVpYQnNlU2s3WEc0Z0lDQWdJQ0JwWmlBb2NtVndiSGt1WW05a2VTNWpiMlJsSUQwOVBTQXlNREFwSUh0Y2JpQWdJQ0FnSUNBZ1gzUm9hWE11WDNKbGJHVmhjMlZNYVhOMFpXNWxjbk1vS1R0Y2JpQWdJQ0FnSUNBZ1pHVnNaWFJsSUY5MGFHbHpMbDl6ZVc1amFHVnlMbDl2WW5ObGNuWmxjbk5iWDNSb2FYTXVYM1Z5YkYwN1hHNGdJQ0FnSUNCOVhHNGdJQ0FnZlNrN1hHNGdJSDFjYmx4dUlDQXZLaXBjYmlBZ0lDb2dVbVZuYVhOMFpYSWdkR2hsSUdOb1lXNW5aU0JzYVhOMFpXNWxjbk1nYzJWdWRDQmllU0IwYUdVZ2NtVndiM0owWlhKY2JpQWdJQ29nUUhCaGNtRnRJSHR6ZEhKcGJtZDlJR1pwYkhSbGNpQXRJRVpwYkhSbGNpQjBhR0YwSUdsa1pXNTBhV1pwWlhNZ2RHaGxJR1pwWld4a0lDaHpaWEJoY21GMFpXUWdaRzkwSUhCaGRHZ3BMaUJCWTJObGNIUnpJQ29nWVhRZ2RHaGxJR1Z1WkNCbWIzSWdZU0J0YjNKbElIVnVjbVZ6ZEhKcFkzUmxaQ0JtYVd4MFpYSnBibWN1WEc0Z0lDQXFJRUJ3WVhKaGJTQjdablZ1WTNScGIyNG9aWFpsYm5RNklFMXpaMFYyWlc1MEtYMGdZMkZzYkdKaFkydGNiaUFnSUNvdlhHNGdJRzl1UTJoaGJtZGxLR1pwYkhSbGNpd2dZMkZzYkdKaFkyc3BJSHRjYmlBZ0lDQnNaWFFnYTJWNUlEMGdabWxzZEdWeU8xeHVJQ0FnSUd4bGRDQm1hV3gwWlhKUFltb2dQU0I3WEc0Z0lDQWdJQ0IwZVhCbE9pQkdhV3gwWlhKVWVYQmxMa1ZZUVVOVUxGeHVJQ0FnSUNBZ1kyRnNiR0poWTJzNklHTmhiR3hpWVdOclhHNGdJQ0FnZlR0Y2JseHVJQ0FnSUd4bGRDQnBaSGdnUFNCbWFXeDBaWEl1YVc1a1pYaFBaaWduS2ljcE8xeHVJQ0FnSUdsbUlDaHBaSGdnUFQwOUlHWnBiSFJsY2k1c1pXNW5kR2dnTFNBeEtTQjdYRzRnSUNBZ0lDQnBaaUFvYVdSNElEMDlQU0F3S1NCN1hHNGdJQ0FnSUNBZ0lHWnBiSFJsY2s5aWFpNTBlWEJsSUQwZ1JtbHNkR1Z5Vkhsd1pTNUJUbGs3WEc0Z0lDQWdJQ0I5SUdWc2MyVWdlMXh1SUNBZ0lDQWdJQ0JtYVd4MFpYSlBZbW91ZEhsd1pTQTlJRVpwYkhSbGNsUjVjR1V1VTFSQlVsUTdYRzRnSUNBZ0lDQWdJR3RsZVNBOUlHWnBiSFJsY2k1emRXSnpkSElvTUN3Z1ptbHNkR1Z5TG14bGJtZDBhQ0F0SURFcE8xeHVJQ0FnSUNBZ2ZWeHVJQ0FnSUgxY2JseHVJQ0FnSUhSb2FYTXVYMlpwYkhSbGNuTmJhMlY1WFNBOUlHWnBiSFJsY2s5aWFqdGNiaUFnZlZ4dVhHNGdJRjl2YmtacGJIUmxjaWhsZG1WdWRDa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNCUFltcGxZM1F1YTJWNWN5aGZkR2hwY3k1ZlptbHNkR1Z5Y3lrdVptOXlSV0ZqYUNnb2EyVjVLU0E5UGlCN1hHNGdJQ0FnSUNCc1pYUWdabWxzZEdWeUlEMGdYM1JvYVhNdVgyWnBiSFJsY25OYmEyVjVYVHRjYmlBZ0lDQWdJR2xtSUNobWFXeDBaWEl1ZEhsd1pTQTlQVDBnUm1sc2RHVnlWSGx3WlM1QlRsa3BJSHRjYmlBZ0lDQWdJQ0FnTHk5dFlYUmphQ0JoYm5sMGFHbHVaMXh1SUNBZ0lDQWdJQ0JtYVd4MFpYSXVZMkZzYkdKaFkyc29aWFpsYm5RcE8xeHVJQ0FnSUNBZ2ZTQmxiSE5sSUdsbUlDaG1hV3gwWlhJdWRIbHdaU0E5UFQwZ1JtbHNkR1Z5Vkhsd1pTNVRWRUZTVkNrZ2UxeHVJQ0FnSUNBZ0lDQXZMMmxtSUhOMFlYSjBjeUIzYVhSb0lHWnBiSFJsY2k0dUxseHVJQ0FnSUNBZ0lDQnBaaUFvWlhabGJuUXVabWxsYkdRdWFXNWtaWGhQWmloclpYa3BJRDA5UFNBd0tTQjdYRzRnSUNBZ0lDQWdJQ0FnWm1sc2RHVnlMbU5oYkd4aVlXTnJLR1YyWlc1MEtUdGNiaUFnSUNBZ0lDQWdmVnh1SUNBZ0lDQWdmU0JsYkhObElHbG1JQ2htYVd4MFpYSXVkSGx3WlNBOVBUMGdSbWxzZEdWeVZIbHdaUzVGV0VGRFZDa2dlMXh1SUNBZ0lDQWdJQ0F2TDJWNFlXTjBJRzFoZEdOb1hHNGdJQ0FnSUNBZ0lHbG1JQ2hsZG1WdWRDNW1hV1ZzWkNBOVBUMGdhMlY1S1NCN1hHNGdJQ0FnSUNBZ0lDQWdabWxzZEdWeUxtTmhiR3hpWVdOcktHVjJaVzUwS1R0Y2JpQWdJQ0FnSUNBZ2ZWeHVJQ0FnSUNBZ2ZWeHVJQ0FnSUgwcE8xeHVJQ0I5WEc1OVhHNWNibVY0Y0c5eWRDQmtaV1poZFd4MElFUmhkR0ZQWW1wbFkzUlBZbk5sY25abGNqdGNibHh1WEc1Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU0lDOHZYRzR2THlBdUwzTnlZeTl6ZVc1amFHVnlMMFJoZEdGUFltcGxZM1JQWW5ObGNuWmxjaTVxY3lJc0lpOHFLbHh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJRVkNCSmJtOTJZY09udzZOdklHVWdVMmx6ZEdWdFlYTWdVMEZjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnU1U1RlUwTXRTVVJjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVVZWUFFrbFRJRTVGVkZkUFVrdFRJRk5NWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVaU1FWVk9TRTlHUlZJdFIwVlRSVXhNVTBOSVFVWlVJRnBWVWlCR1QwVlNSRVZTVlU1SElFUkZVaUJCVGtkRlYwRk9SRlJGVGlCR1QxSlRRMGhWVGtjZ1JTNVdYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRTlTUVU1SFJTQlRRVnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJFWlhWMGMyTm9aU0JVWld4bGEyOXRJRUZIWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVGd2FYcGxaVnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJVUlVOSVRrbFRRMGhGSUZWT1NWWkZVbE5KVkVGVUlFSkZVa3hKVGx4dUtseHVLaUJNYVdObGJuTmxaQ0IxYm1SbGNpQjBhR1VnUVhCaFkyaGxJRXhwWTJWdWMyVXNJRlpsY25OcGIyNGdNaTR3SUNoMGFHVWdYQ0pNYVdObGJuTmxYQ0lwTzF4dUtpQjViM1VnYldGNUlHNXZkQ0IxYzJVZ2RHaHBjeUJtYVd4bElHVjRZMlZ3ZENCcGJpQmpiMjF3YkdsaGJtTmxJSGRwZEdnZ2RHaGxJRXhwWTJWdWMyVXVYRzRxSUZsdmRTQnRZWGtnYjJKMFlXbHVJR0VnWTI5d2VTQnZaaUIwYUdVZ1RHbGpaVzV6WlNCaGRGeHVLbHh1S2lBZ0lHaDBkSEE2THk5M2QzY3VZWEJoWTJobExtOXlaeTlzYVdObGJuTmxjeTlNU1VORlRsTkZMVEl1TUZ4dUtseHVLaUJWYm14bGMzTWdjbVZ4ZFdseVpXUWdZbmtnWVhCd2JHbGpZV0pzWlNCc1lYY2diM0lnWVdkeVpXVmtJSFJ2SUdsdUlIZHlhWFJwYm1jc0lITnZablIzWVhKbFhHNHFJR1JwYzNSeWFXSjFkR1ZrSUhWdVpHVnlJSFJvWlNCTWFXTmxibk5sSUdseklHUnBjM1J5YVdKMWRHVmtJRzl1SUdGdUlGd2lRVk1nU1ZOY0lpQkNRVk5KVXl4Y2Jpb2dWMGxVU0U5VlZDQlhRVkpTUVU1VVNVVlRJRTlTSUVOUFRrUkpWRWxQVGxNZ1QwWWdRVTVaSUV0SlRrUXNJR1ZwZEdobGNpQmxlSEJ5WlhOeklHOXlJR2x0Y0d4cFpXUXVYRzRxSUZObFpTQjBhR1VnVEdsalpXNXpaU0JtYjNJZ2RHaGxJSE53WldOcFptbGpJR3hoYm1kMVlXZGxJR2R2ZG1WeWJtbHVaeUJ3WlhKdGFYTnphVzl1Y3lCaGJtUmNiaW9nYkdsdGFYUmhkR2x2Ym5NZ2RXNWtaWElnZEdobElFeHBZMlZ1YzJVdVhHNHFLaTljYmx4dWFXMXdiM0owSUVSaGRHRlBZbXBsWTNRZ1puSnZiU0FuTGk5RVlYUmhUMkpxWldOMEp6dGNibHh1YVcxd2IzSjBJRVJoZEdGUFltcGxZM1JEYUdsc1pDQm1jbTl0SUNjdUwwUmhkR0ZQWW1wbFkzUkRhR2xzWkNjN1hHNWNibWx0Y0c5eWRDQjdJR1JsWlhCRGJHOXVaU0I5SUdaeWIyMGdKeTR1TDNWMGFXeHpMM1YwYVd4ekxtcHpKenRjYmx4dUx5b3FYRzRnS2lCVWFHVWdZMnhoYzNNZ2NtVjBkWEp1WldRZ1puSnZiU0IwYUdVZ1UzbHVZMmhsY2lCamNtVmhkR1VnWTJGc2JDNWNiaUFxSUZSdklHSmxJSFZ6WldRZ1lYTWdZU0J5WlhCdmNuUmxjaUJ3YjJsdWRDd2dZMmhoYm1kbGN5QjNhV3hzSUdKbElITjFZbTFwZEdWa0lIUnZJRVJoZEdGUFltcGxZM1JQWW5ObGNuWmxjaUJwYm5OMFlXNWpaWE11WEc0Z0tpOWNibU5zWVhOeklFUmhkR0ZQWW1wbFkzUlNaWEJ2Y25SbGNpQmxlSFJsYm1SeklFUmhkR0ZQWW1wbFkzUWdMeW9nYVcxd2JHVnRaVzUwY3lCVGVXNWpVM1JoZEhWeklDb3ZJSHRjYmlBZ0x5b2djSEpwZG1GMFpWeHVJQ0JmYzNWaWMyTnlhWEIwYVc5dWN6b2dQR2g1Y0dWeWRIbFZjbXc2SUhzZ2MzUmhkSFZ6T2lCemRISnBibWNnZlNCOVBseHVYRzRnSUMwdExTMWxkbVZ1ZENCb1lXNWtiR1Z5Y3kwdExTMWNiaUFnWDI5dVUzVmljMk55YVhCMGFXOXVTR0Z1Wkd4bGNqb2dLR1YyWlc1MEtTQTlQaUIyYjJsa1hHNGdJRjl2YmxKbGMzQnZibk5sU0dGdVpHeGxjam9nS0dWMlpXNTBLU0E5UGlCMmIybGtYRzRnSUY5dmJsSmxZV1JJWVc1a2JHVnlPaUFvWlhabGJuUXBJRDArSUhadmFXUmNiaUFnS2k5Y2JseHVJQ0F2S2lwY2JpQWdJQ29nUUdsbmJtOXlaVnh1SUNBZ0tpQlRhRzkxYkdRZ2JtOTBJR0psSUhWelpXUWdaR2x5WldOMGJIa2dZbmtnU0hsd1pYSjBhV1Z6TGlCSmRDZHpJR05oYkd4bFpDQmllU0IwYUdVZ1UzbHVZMmhsY2k1amNtVmhkR1VnYldWMGFHOWtYRzRnSUNBcUwxeHVJQ0JqYjI1emRISjFZM1J2Y2loemVXNWphR1Z5TENCMWNtd3NJSE5qYUdWdFlTd2dhVzVwZEdsaGJGTjBZWFIxY3l3Z2FXNXBkR2xoYkVSaGRHRXNJR05vYVd4a2NtVnVjeXdnYlhWMGRXRnNMQ0J5WlhOMWJXVmtJRDBnWm1Gc2MyVXBJSHRjYmlBZ0lDQnpkWEJsY2loemVXNWphR1Z5TENCMWNtd3NJSE5qYUdWdFlTd2dhVzVwZEdsaGJGTjBZWFIxY3l3Z2FXNXBkR2xoYkVSaGRHRXNJR05vYVd4a2NtVnVjeXdnYlhWMGRXRnNMQ0J5WlhOMWJXVmtLVHRjYmlBZ0lDQnNaWFFnWDNSb2FYTWdQU0IwYUdsek8xeHVYRzRnSUNBZ1gzUm9hWE11WDNOMVluTmpjbWx3ZEdsdmJuTWdQU0I3ZlR0Y2JseHVJQ0FnSUY5MGFHbHpMbDl6ZVc1alQySnFMbTlpYzJWeWRtVW9LR1YyWlc1MEtTQTlQaUI3WEc0Z0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblJHRjBZVTlpYW1WamRGSmxjRzl5ZEdWeUxTY2dLeUIxY213Z0t5QW5MVk5GVGtRNklDY3NJR1YyWlc1MEtUdGNiaUFnSUNBZ0lGOTBhR2x6TGw5dmJrTm9ZVzVuWlNobGRtVnVkQ2s3WEc0Z0lDQWdmU2s3WEc1Y2JpQWdJQ0JmZEdocGN5NWZZV3hzYjJOaGRHVk1hWE4wWlc1bGNuTW9LVHRjYmlBZ2ZWeHVYRzRnSUY5aGJHeHZZMkYwWlV4cGMzUmxibVZ5Y3lncElIdGNiaUFnSUNCemRYQmxjaTVmWVd4c2IyTmhkR1ZNYVhOMFpXNWxjbk1vS1R0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdYM1JvYVhNdVgyOWlhbVZqZEV4cGMzUmxibVZ5SUQwZ1gzUm9hWE11WDJKMWN5NWhaR1JNYVhOMFpXNWxjaWhmZEdocGN5NWZkWEpzTENBb2JYTm5LU0E5UGlCN1hHNGdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25SR0YwWVU5aWFtVmpkQzBuSUNzZ1gzUm9hWE11WDNWeWJDQXJJQ2N0VWtOV09pQW5MQ0J0YzJjcE8xeHVJQ0FnSUNBZ2MzZHBkR05vSUNodGMyY3VkSGx3WlNrZ2UxeHVJQ0FnSUNBZ0lDQmpZWE5sSUNkeVpYTndiMjV6WlNjNklGOTBhR2x6TGw5dmJsSmxjM0J2Ym5ObEtHMXpaeWs3SUdKeVpXRnJPMXh1SUNBZ0lDQWdJQ0JqWVhObElDZHlaV0ZrSnpvZ1gzUm9hWE11WDI5dVVtVmhaQ2h0YzJjcE95QmljbVZoYXp0Y2JpQWdJQ0FnSUgxY2JpQWdJQ0I5S1R0Y2JpQWdmVnh1WEc0Z0lGOXlaV3hsWVhObFRHbHpkR1Z1WlhKektDa2dlMXh1SUNBZ0lITjFjR1Z5TGw5eVpXeGxZWE5sVEdsemRHVnVaWEp6S0NrN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmx4dUlDQWdJRjkwYUdsekxsOXZZbXBsWTNSTWFYTjBaVzVsY2k1eVpXMXZkbVVvS1R0Y2JpQWdmVnh1WEc0Z0lDOHFLbHh1SUNBZ0tseHVJQ0FnS2k5Y2JpQWdjbVZ6ZFcxbFEyaHBiR1J5Wlc1ektHTm9hV3hrY21WdWN5a2dlMXh1WEc0Z0lDQWdiR1YwSUdOb2FXeGtTV1JUZEhKcGJtY2dQU0IwYUdsekxsOXZkMjVsY2lBcklDY2pKeUFySUhSb2FYTXVYMk5vYVd4a1NXUTdYRzVjYmlBZ0lDQXZMM05sZEhWd0lHTm9hV3hrY21WdWN5QmtZWFJoSUdaeWIyMGdjM1ZpYzJOeWFYQjBhVzl1WEc0Z0lDQWdUMkpxWldOMExtdGxlWE1vWTJocGJHUnlaVzV6S1M1bWIzSkZZV05vS0NoamFHbHNaSEpsYmxKbGMyOTFjbU5sS1NBOVBpQjdYRzRnSUNBZ0lDQnNaWFFnWTJocGJHUnlaVzRnUFNCamFHbHNaSEpsYm5OYlkyaHBiR1J5Wlc1U1pYTnZkWEpqWlYwN1hHNGdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25XMFJoZEdGUFltcGxZM1JTWlhCdmNuUmxjaUF0SUc1bGR5QkVZWFJoVDJKcVpXTjBRMmhwYkdSZE9pQW5MQ0JqYUdsc1pISmxibEpsYzI5MWNtTmxMQ0JqYUdsc1pISmxiaXdnZEdocGN5NWZjbVZ6ZFcxbFpDazdYRzVjYmlBZ0lDQWdJQzh2SUdsbUlHbHpJSEpsYzNWdFpXUmNiaUFnSUNBZ0lFOWlhbVZqZEM1clpYbHpLR05vYVd4a2NtVnVLUzVtYjNKRllXTm9LQ2hqYUdsc1pFbGtLU0E5UGlCN1hHNGdJQ0FnSUNBZ0lIUm9hWE11WDJOb2FXeGtjbVZ1VDJKcVpXTjBjMXRqYUdsc1pFbGtYU0E5SUc1bGR5QkVZWFJoVDJKcVpXTjBRMmhwYkdRb2RHaHBjeXdnWTJocGJHUkpaQ3dnWTJocGJHUnlaVzViWTJocGJHUkpaRjB1ZG1Gc2RXVXBPMXh1SUNBZ0lDQWdJQ0IwYUdsekxsOWphR2xzWkhKbGJrOWlhbVZqZEhOYlkyaHBiR1JKWkYwdWFXUmxiblJwZEhrZ1BTQmphR2xzWkhKbGJsdGphR2xzWkVsa1hTNXBaR1Z1ZEdsMGVUdGNibHh1SUNBZ0lDQWdJQ0JwWmlBb1kyaHBiR1JKWkNBK0lHTm9hV3hrU1dSVGRISnBibWNwSUh0Y2JpQWdJQ0FnSUNBZ0lDQmphR2xzWkVsa1UzUnlhVzVuSUQwZ1kyaHBiR1JKWkR0Y2JpQWdJQ0FnSUNBZ2ZWeHVYRzRnSUNBZ0lDQWdJR052Ym5OdmJHVXViRzluS0NkYlJHRjBZVTlpYW1WamRGSmxjRzl5ZEdWeUlDMGdibVYzSUVSaGRHRlBZbXBsWTNSRGFHbHNaRjBnTFNCeVpYTjFiV1ZrT2lBbkxDQjBhR2x6TGw5amFHbHNaSEpsYms5aWFtVmpkSE5iWTJocGJHUkpaRjBzSUNCamFHbHNaRWxrTENCamFHbHNaSEpsYmx0amFHbHNaRWxrWFM1MllXeDFaU2s3WEc0Z0lDQWdJQ0I5S1R0Y2JpQWdJQ0I5S1R0Y2JseHVJQ0FnSUhSb2FYTXVYMk5vYVd4a1NXUWdQU0JPZFcxaVpYSW9ZMmhwYkdSSlpGTjBjbWx1Wnk1emNHeHBkQ2duSXljcFd6RmRLVHRjYmlBZ2ZWeHVYRzRnSUM4cUtseHVJQ0FnS2lCVFpXNWtJR2x1ZG1sMFlYUnBiMjV6SUNoamNtVmhkR1VnYldWemMyRm5aWE1wSUhSdklHaDVjR1Z5ZEdsbGN5d2diMkp6WlhKMlpYSnpJR3hwYzNRdVhHNGdJQ0FxSUVCd1lYSmhiU0FnZTBoNWNHVnlkSGxWVWt4YlhYMGdiMkp6WlhKMlpYSnpJRXhwYzNRZ2IyWWdTSGx3WlhKMGVTQlZVa3duYzF4dUlDQWdLaTljYmlBZ2FXNTJhWFJsVDJKelpYSjJaWEp6S0c5aWMyVnlkbVZ5Y3lrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQ0F2TDBaTVQxY3RUMVZVT2lCMGFHbHpJRzFsYzNOaFoyVWdkMmxzYkNCaVpTQnpaVzUwSUhSdklIUm9aU0J5ZFc1MGFXMWxJR2x1YzNSaGJtTmxJRzltSUZONWJtTm9aWEpOWVc1aFoyVnlJQzArSUY5dmJrTnlaV0YwWlZ4dUlDQWdJR3hsZENCcGJuWnBkR1ZOYzJjZ1BTQjdYRzRnSUNBZ0lDQjBlWEJsT2lBblkzSmxZWFJsSnl3Z1puSnZiVG9nWDNSb2FYTXVYM041Ym1Ob1pYSXVYMjkzYm1WeUxDQjBiem9nWDNSb2FYTXVYM041Ym1Ob1pYSXVYM04xWWxWU1RDeGNiaUFnSUNBZ0lHSnZaSGs2SUhzZ2NtVnpkVzFsT2lCbVlXeHpaU3dnY21WemIzVnlZMlU2SUY5MGFHbHpMbDkxY213c0lITmphR1Z0WVRvZ1gzUm9hWE11WDNOamFHVnRZU3dnZG1Gc2RXVTZJRjkwYUdsekxsOXplVzVqVDJKcUxtUmhkR0VzSUdGMWRHaHZjbWx6WlRvZ2IySnpaWEoyWlhKeklIMWNiaUFnSUNCOU8xeHVYRzRnSUNBZ1gzUm9hWE11WDJKMWN5NXdiM04wVFdWemMyRm5aU2hwYm5acGRHVk5jMmNwTzF4dUlDQjlYRzVjYmlBZ0x5b3FYRzRnSUNBcUlGSmxiR1ZoYzJVZ1lXNWtJR1JsYkdWMFpTQnZZbXBsWTNRZ1pHRjBZVnh1SUNBZ0tpOWNiaUFnWkdWc1pYUmxLQ2tnZTF4dUlDQWdJR3hsZENCZmRHaHBjeUE5SUhSb2FYTTdYRzVjYmlBZ0lDQXZMMFpNVDFjdFQxVlVPaUIwYUdseklHMWxjM05oWjJVZ2QybHNiQ0JpWlNCelpXNTBJSFJ2SUhSb1pTQnlkVzUwYVcxbElHbHVjM1JoYm1ObElHOW1JRk41Ym1Ob1pYSk5ZVzVoWjJWeUlDMCtJRjl2YmtSbGJHVjBaVnh1SUNBZ0lHeGxkQ0JrWld4bGRHVk5jMmNnUFNCN1hHNGdJQ0FnSUNCMGVYQmxPaUFuWkdWc1pYUmxKeXdnWm5KdmJUb2dYM1JvYVhNdVgyOTNibVZ5TENCMGJ6b2dYM1JvYVhNdVgzTjVibU5vWlhJdVgzTjFZbFZTVEN4Y2JpQWdJQ0FnSUdKdlpIazZJSHNnY21WemIzVnlZMlU2SUY5MGFHbHpMbDkxY213Z2ZWeHVJQ0FnSUgwN1hHNWNiaUFnSUNCZmRHaHBjeTVmWW5WekxuQnZjM1JOWlhOellXZGxLR1JsYkdWMFpVMXpaeXdnS0hKbGNHeDVLU0E5UGlCN1hHNGdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25SR0YwWVU5aWFtVmpkRkpsY0c5eWRHVnlMVVJGVEVWVVJUb2dKeXdnY21Wd2JIa3BPMXh1SUNBZ0lDQWdhV1lnS0hKbGNHeDVMbUp2WkhrdVkyOWtaU0E5UFQwZ01qQXdLU0I3WEc0Z0lDQWdJQ0FnSUY5MGFHbHpMbDl5Wld4bFlYTmxUR2x6ZEdWdVpYSnpLQ2s3WEc0Z0lDQWdJQ0FnSUdSbGJHVjBaU0JmZEdocGN5NWZjM2x1WTJobGNpNWZjbVZ3YjNKMFpYSnpXMTkwYUdsekxsOTFjbXhkTzF4dUlDQWdJQ0FnZlZ4dUlDQWdJSDBwTzF4dUlDQjlYRzVjYmlBZ0x5b3FYRzRnSUNBcUlGTjFZbk5qY21sd2RHbHZibk1nY21WeGRXVnpkR1ZrSUdGdVpDQmhZMk5sY0hSbFpDQjBieUIwYUdseklISmxjRzl5ZEdWeVhHNGdJQ0FxSUVCMGVYQmxJSHRQWW1wbFkzUThTSGx3WlhKMGVWVlNUQ3dnVTNsdVkxTjFZbk5qY21sd2RHbHZiajU5WEc0Z0lDQXFMMXh1SUNCblpYUWdjM1ZpYzJOeWFYQjBhVzl1Y3lncElIc2djbVYwZFhKdUlIUm9hWE11WDNOMVluTmpjbWx3ZEdsdmJuTTdJSDFjYmx4dUlDQXZLaXBjYmlBZ0lDb2dVMlYwZFhBZ2RHaGxJR05oYkd4aVlXTnJJSFJ2SUhCeWIyTmxjM01nYzNWaWMyTnlhV0psSUdGdVpDQjFibk4xWW5OamNtbGlaU0J1YjNScFptbGpZWFJwYjI1elhHNGdJQ0FxSUVCd1lYSmhiU0I3Wm5WdVkzUnBiMjRvWlhabGJuUTZJRTF6WjBWMlpXNTBLWDBnWTJGc2JHSmhZMnNnWm5WdVkzUnBiMjRnZEc4Z2NtVmpaV2wyWlNCbGRtVnVkSE5jYmlBZ0lDb3ZYRzRnSUc5dVUzVmljMk55YVhCMGFXOXVLR05oYkd4aVlXTnJLU0I3WEc0Z0lDQWdkR2hwY3k1ZmIyNVRkV0p6WTNKcGNIUnBiMjVJWVc1a2JHVnlJRDBnWTJGc2JHSmhZMnM3WEc0Z0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1UyVjBkWEFnZEdobElHTmhiR3hpWVdOcklIUnZJSEJ5YjJObGMzTWdjbVZ6Y0c5dWMyVWdibTkwYVdacFkyRjBhVzl1Y3lCdlppQjBhR1VnWTNKbFlYUmxKM05jYmlBZ0lDb2dRSEJoY21GdElIdG1kVzVqZEdsdmJpaGxkbVZ1ZERvZ1RYTm5SWFpsYm5RcGZTQmpZV3hzWW1GamF5Qm1kVzVqZEdsdmJpQjBieUJ5WldObGFYWmxJR1YyWlc1MGMxeHVJQ0FnS2k5Y2JpQWdiMjVTWlhOd2IyNXpaU2hqWVd4c1ltRmpheWtnZTF4dUlDQWdJSFJvYVhNdVgyOXVVbVZ6Y0c5dWMyVklZVzVrYkdWeUlEMGdZMkZzYkdKaFkyczdYRzRnSUgxY2JseHVJQ0F2S2lwY2JpQWdJQ29nVTJWMGRYQWdkR2hsSUdOaGJHeGlZV05ySUhSdklIQnliMk5sYzNNZ2NtVmhaQ0J1YjNScFptbGpZWFJwYjI1elhHNGdJQ0FxSUVCd1lYSmhiU0I3Wm5WdVkzUnBiMjRvWlhabGJuUTZJRTF6WjBWMlpXNTBLWDBnWTJGc2JHSmhZMnRjYmlBZ0lDb3ZYRzRnSUc5dVVtVmhaQ2hqWVd4c1ltRmpheWtnZTF4dUlDQWdJSFJvYVhNdVgyOXVVbVZoWkVoaGJtUnNaWElnUFNCallXeHNZbUZqYXp0Y2JpQWdmVnh1WEc0Z0lDOHZSa3hQVnkxSlRqb2diV1Z6YzJGblpTQnlaV05sYVhabFpDQm1jbTl0SUhCaGNtVnVkQ0JUZVc1amFHVnlJQzArSUY5dmJrWnZjbmRoY21SY2JpQWdYMjl1Um05eWQyRnlaQ2h0YzJjcElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWTI5dWMyOXNaUzVzYjJjb0owUmhkR0ZQWW1wbFkzUlNaWEJ2Y25SbGNpMVNRMVk2SUNjc0lHMXpaeWs3WEc0Z0lDQWdjM2RwZEdOb0lDaHRjMmN1WW05a2VTNTBlWEJsS1NCN1hHNGdJQ0FnSUNCallYTmxJQ2R6ZFdKelkzSnBZbVVuT2lCZmRHaHBjeTVmYjI1VGRXSnpZM0pwWW1Vb2JYTm5LVHNnWW5KbFlXczdYRzRnSUNBZ0lDQmpZWE5sSUNkMWJuTjFZbk5qY21saVpTYzZJRjkwYUdsekxsOXZibFZ1VTNWaWMyTnlhV0psS0cxelp5azdJR0p5WldGck8xeHVJQ0FnSUgxY2JpQWdmVnh1WEc0Z0lDOHZSa3hQVnkxSlRqb2diV1Z6YzJGblpTQnlaV05sYVhabFpDQm1jbTl0SUhSb2FYTWdMVDRnWDI5dVJtOXlkMkZ5WkRvZ1pXMXBkSFJsWkNCaWVTQmhJSEpsYlc5MFpTQlRlVzVqYUdWeUlDMCtJSE4xWW5OamNtbGlaVnh1SUNCZmIyNVRkV0p6WTNKcFltVW9iWE5uS1NCN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmlBZ0lDQnNaWFFnYUhsd1pYSjBlVlZ5YkNBOUlHMXpaeTVpYjJSNUxtWnliMjA3WEc0Z0lDQWdZMjl1YzI5c1pTNXNiMmNvSjF0RVlYUmhUMkpxWldOMFVtVndiM0owWlhJdVgyOXVVM1ZpYzJOeWFXSmxYU2NzSUcxelp5azdYRzVjYmlBZ0lDQnNaWFFnWlhabGJuUWdQU0I3WEc0Z0lDQWdJQ0IwZVhCbE9pQnRjMmN1WW05a2VTNTBlWEJsTEZ4dUlDQWdJQ0FnZFhKc09pQm9lWEJsY25SNVZYSnNMRnh1WEc0Z0lDQWdJQ0JwWkdWdWRHbDBlVG9nYlhObkxtSnZaSGt1YVdSbGJuUnBkSGtzWEc1Y2JpQWdJQ0FnSUdGalkyVndkRG9nS0NrZ1BUNGdlMXh1SUNBZ0lDQWdJQ0F2TDJOeVpXRjBaU0J1WlhjZ2MzVmljMk55YVhCMGFXOXVYRzRnSUNBZ0lDQWdJR3hsZENCemRXSWdQU0I3SUhWeWJEb2dhSGx3WlhKMGVWVnliQ3dnYzNSaGRIVnpPaUFuYjI0bklIMDdYRzRnSUNBZ0lDQWdJRjkwYUdsekxsOXpkV0p6WTNKcGNIUnBiMjV6VzJoNWNHVnlkSGxWY214ZElEMGdjM1ZpTzF4dVhHNGdJQ0FnSUNBZ0lDOHZjSEp2WTJWemN5QmhibVFnYzJWdVpDQmphR2xzWkhKbGJuTWdaR0YwWVZ4dUlDQWdJQ0FnSUNCc1pYUWdZMmhwYkdSeVpXNVdZV3gxWlhNZ1BTQjdmVHRjYmlBZ0lDQWdJQ0FnVDJKcVpXTjBMbXRsZVhNb1gzUm9hWE11WDJOb2FXeGtjbVZ1VDJKcVpXTjBjeWt1Wm05eVJXRmphQ2dvWTJocGJHUkpaQ2tnUFQ0Z2UxeHVJQ0FnSUNBZ0lDQWdJR3hsZENCamFHbHNaRVJoZEdFZ1BTQmZkR2hwY3k1ZlkyaHBiR1J5Wlc1UFltcGxZM1J6VzJOb2FXeGtTV1JkTG1SaGRHRTdYRzRnSUNBZ0lDQWdJQ0FnWTJocGJHUnlaVzVXWVd4MVpYTmJZMmhwYkdSSlpGMGdQU0JrWldWd1EyeHZibVVvWTJocGJHUkVZWFJoS1R0Y2JpQWdJQ0FnSUNBZ2ZTazdYRzVjYmlBZ0lDQWdJQ0FnYkdWMElITmxibVJOYzJjZ1BTQjdYRzRnSUNBZ0lDQWdJQ0FnYVdRNklHMXpaeTVwWkN3Z2RIbHdaVG9nSjNKbGMzQnZibk5sSnl3Z1puSnZiVG9nYlhObkxuUnZMQ0IwYnpvZ2JYTm5MbVp5YjIwc1hHNGdJQ0FnSUNBZ0lDQWdZbTlrZVRvZ2V5QmpiMlJsT2lBeU1EQXNJSE5qYUdWdFlUb2dYM1JvYVhNdVgzTmphR1Z0WVN3Z2RtVnljMmx2YmpvZ1gzUm9hWE11WDNabGNuTnBiMjRzSUhaaGJIVmxPaUI3SUdSaGRHRTZJR1JsWlhCRGJHOXVaU2hmZEdocGN5NWtZWFJoS1N3Z1kyaHBiR1J5Wlc1ek9pQmphR2xzWkhKbGJsWmhiSFZsY3lCOUlIMWNiaUFnSUNBZ0lDQWdmVHRjYmx4dUlDQWdJQ0FnSUNBdkwxUlBSRTg2SUVadmNpQkdkWEowYUdWeUlGTjBkV1I1WEc0Z0lDQWdJQ0FnSUdsbUlDaHRjMmN1WW05a2VTNW9ZWE5QZDI1UWNtOXdaWEowZVNnbmJYVjBkV0ZzUVhWMGFHVnVkR2xqWVhScGIyNG5LU0FtSmlBaGJYTm5MbUp2WkhrdWJYVjBkV0ZzUVhWMGFHVnVkR2xqWVhScGIyNHBJSHRjYmlBZ0lDQWdJQ0FnSUNCelpXNWtUWE5uTG1KdlpIa3ViWFYwZFdGc1FYVjBhR1Z1ZEdsallYUnBiMjRnUFNCMGFHbHpMbDl0ZFhSMVlXeEJkWFJvWlc1MGFXTmhkR2x2Ymp0Y2JpQWdJQ0FnSUNBZ0lDQjBhR2x6TGw5dGRYUjFZV3hCZFhSb1pXNTBhV05oZEdsdmJpQTlJRzF6Wnk1aWIyUjVMbTExZEhWaGJFRjFkR2hsYm5ScFkyRjBhVzl1TzF4dUlDQWdJQ0FnSUNCOVhHNWNiaUFnSUNBZ0lDQWdMeTl6Wlc1a0lHOXJJSEpsYzNCdmJuTmxJRzFsYzNOaFoyVmNiaUFnSUNBZ0lDQWdYM1JvYVhNdVgySjFjeTV3YjNOMFRXVnpjMkZuWlNoelpXNWtUWE5uS1R0Y2JseHVJQ0FnSUNBZ0lDQnlaWFIxY200Z2MzVmlPMXh1SUNBZ0lDQWdmU3hjYmx4dUlDQWdJQ0FnY21WcVpXTjBPaUFvY21WaGMyOXVLU0E5UGlCN1hHNGdJQ0FnSUNBZ0lDOHZjMlZ1WkNCeVpXcGxZM1FnY21WemNHOXVjMlVnYldWemMyRm5aVnh1SUNBZ0lDQWdJQ0JmZEdocGN5NWZZblZ6TG5CdmMzUk5aWE56WVdkbEtIdGNiaUFnSUNBZ0lDQWdJQ0JwWkRvZ2JYTm5MbWxrTENCMGVYQmxPaUFuY21WemNHOXVjMlVuTENCbWNtOXRPaUJ0YzJjdWRHOHNJSFJ2T2lCdGMyY3Vabkp2YlN4Y2JpQWdJQ0FnSUNBZ0lDQmliMlI1T2lCN0lHTnZaR1U2SURRd015d2daR1Z6WXpvZ2NtVmhjMjl1SUgxY2JpQWdJQ0FnSUNBZ2ZTazdYRzRnSUNBZ0lDQjlYRzRnSUNBZ2ZUdGNibHh1SUNBZ0lHbG1JQ2hmZEdocGN5NWZiMjVUZFdKelkzSnBjSFJwYjI1SVlXNWtiR1Z5S1NCN1hHNGdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25VMVZDVTBOU1NWQlVTVTlPTFVWV1JVNVVPaUFuTENCbGRtVnVkQ2s3WEc0Z0lDQWdJQ0JmZEdocGN5NWZiMjVUZFdKelkzSnBjSFJwYjI1SVlXNWtiR1Z5S0dWMlpXNTBLVHRjYmlBZ0lDQjlYRzRnSUgxY2JseHVJQ0F2TDBaTVQxY3RTVTQ2SUcxbGMzTmhaMlVnY21WalpXbDJaV1FnWm5KdmJTQjBhR2x6SUMwK0lGOXZia1p2Y25kaGNtUTZJR1Z0YVhSMFpXUWdZbmtnWVNCeVpXMXZkR1VnUkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5SUMwK0lIVnVjM1ZpYzJOeWFXSmxYRzRnSUY5dmJsVnVVM1ZpYzJOeWFXSmxLRzF6WnlrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc0Z0lDQWdiR1YwSUdoNWNHVnlkSGxWY213Z1BTQnRjMmN1WW05a2VTNW1jbTl0TzF4dVhHNGdJQ0FnYkdWMElITjFZaUE5SUY5MGFHbHpMbDl6ZFdKelkzSnBjSFJwYjI1elcyaDVjR1Z5ZEhsVmNteGRPMXh1SUNBZ0lHUmxiR1YwWlNCZmRHaHBjeTVmYzNWaWMyTnlhWEIwYVc5dWMxdG9lWEJsY25SNVZYSnNYVHRjYmx4dUlDQWdJR3hsZENCbGRtVnVkQ0E5SUh0Y2JpQWdJQ0FnSUhSNWNHVTZJRzF6Wnk1aWIyUjVMblI1Y0dVc1hHNGdJQ0FnSUNCMWNtdzZJR2g1Y0dWeWRIbFZjbXdzWEc0Z0lDQWdJQ0J2WW1wbFkzUTZJSE4xWWx4dUlDQWdJSDA3WEc1Y2JpQWdJQ0JwWmlBb1gzUm9hWE11WDI5dVUzVmljMk55YVhCMGFXOXVTR0Z1Wkd4bGNpa2dlMXh1SUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvSjFWT0xWTlZRbE5EVWtsUVZFbFBUaTFGVmtWT1ZEb2dKeXdnWlhabGJuUXBPMXh1SUNBZ0lDQWdYM1JvYVhNdVgyOXVVM1ZpYzJOeWFYQjBhVzl1U0dGdVpHeGxjaWhsZG1WdWRDazdYRzRnSUNBZ2ZWeHVJQ0I5WEc1Y2JpQWdMeTlHVEU5WExVbE9PaUJ0WlhOellXZGxJSEpsWTJWcGRtVmtJR1p5YjIwZ1VtVndiM0owWlhKVlVrd2dZV1JrY21WemN6b2daVzFwZEdWa0lHSjVJR0VnY21WdGIzUmxJRk41Ym1Ob1pYSWdMVDRnWDI5dVVtVnRiM1JsUTNKbFlYUmxJQzArSUdWMlpXNTBMbUZqYTF4dUlDQmZiMjVTWlhOd2IyNXpaU2h0YzJjcElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnYkdWMElHVjJaVzUwSUQwZ2UxeHVJQ0FnSUNBZ2RIbHdaVG9nYlhObkxuUjVjR1VzWEc0Z0lDQWdJQ0IxY213NklHMXpaeTVtY205dExGeHVJQ0FnSUNBZ1kyOWtaVG9nYlhObkxtSnZaSGt1WTI5a1pWeHVJQ0FnSUgwN1hHNWNiaUFnSUNCcFppQW9YM1JvYVhNdVgyOXVVbVZ6Y0c5dWMyVklZVzVrYkdWeUtTQjdYRzRnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVWtWVFVFOU9VMFV0UlZaRlRsUTZJQ2NzSUdWMlpXNTBLVHRjYmlBZ0lDQWdJRjkwYUdsekxsOXZibEpsYzNCdmJuTmxTR0Z1Wkd4bGNpaGxkbVZ1ZENrN1hHNGdJQ0FnZlZ4dUlDQjlYRzVjYmlBZ0x5OUdURTlYTFVsT09pQnRaWE56WVdkbElISmxZMlZwZG1Wa0lHWnliMjBnVW1Wd2IzSjBaWEpWVWt3Z1lXUmtjbVZ6Y3pvZ1pXMXBkR1ZrSUdKNUlHRWdjbVZ0YjNSbElGTjVibU5vWlhJZ0xUNGdjbVZoWkZ4dUlDQmZiMjVTWldGa0tHMXpaeWtnZTF4dUlDQWdJR3hsZENCZmRHaHBjeUE5SUhSb2FYTTdYRzVjYmlBZ0lDQnNaWFFnWlhabGJuUWdQU0I3WEc0Z0lDQWdJQ0IwZVhCbE9pQnRjMmN1ZEhsd1pTeGNiaUFnSUNBZ0lIVnliRG9nYlhObkxtWnliMjBzWEc1Y2JpQWdJQ0FnSUdGalkyVndkRG9nS0NrZ1BUNGdlMXh1SUNBZ0lDQWdJQ0JmZEdocGN5NWZZblZ6TG5CdmMzUk5aWE56WVdkbEtIdGNiaUFnSUNBZ0lDQWdJQ0JwWkRvZ2JYTm5MbWxrTENCMGVYQmxPaUFuY21WemNHOXVjMlVuTENCbWNtOXRPaUJ0YzJjdWRHOHNJSFJ2T2lCdGMyY3Vabkp2YlN4Y2JpQWdJQ0FnSUNBZ0lDQmliMlI1T2lCN0lHTnZaR1U2SURJd01Dd2dkbUZzZFdVNklHUmxaWEJEYkc5dVpTaGZkR2hwY3k1a1lYUmhLU0I5WEc0Z0lDQWdJQ0FnSUgwcE8xeHVJQ0FnSUNBZ2ZTeGNibHh1SUNBZ0lDQWdjbVZxWldOME9pQW9jbVZoYzI5dUtTQTlQaUI3WEc0Z0lDQWdJQ0FnSUY5MGFHbHpMbDlpZFhNdWNHOXpkRTFsYzNOaFoyVW9lMXh1SUNBZ0lDQWdJQ0FnSUdsa09pQnRjMmN1YVdRc0lIUjVjR1U2SUNkeVpYTndiMjV6WlNjc0lHWnliMjA2SUcxelp5NTBieXdnZEc4NklHMXpaeTVtY205dExGeHVJQ0FnSUNBZ0lDQWdJR0p2WkhrNklIc2dZMjlrWlRvZ05EQXhMQ0JrWlhOak9pQnlaV0Z6YjI0Z2ZWeHVJQ0FnSUNBZ0lDQjlLVHRjYmlBZ0lDQWdJSDFjYmlBZ0lDQjlPMXh1WEc0Z0lDQWdhV1lnS0Y5MGFHbHpMbDl2YmxKbFlXUklZVzVrYkdWeUtTQjdYRzRnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVWtWQlJDMUZWa1ZPVkRvZ0p5d2daWFpsYm5RcE8xeHVJQ0FnSUNBZ1gzUm9hWE11WDI5dVVtVmhaRWhoYm1Sc1pYSW9aWFpsYm5RcE8xeHVJQ0FnSUgxY2JpQWdmVnh1WEc1OVhHNWNibVY0Y0c5eWRDQmtaV1poZFd4MElFUmhkR0ZQWW1wbFkzUlNaWEJ2Y25SbGNqdGNibHh1WEc1Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU0lDOHZYRzR2THlBdUwzTnlZeTl6ZVc1amFHVnlMMFJoZEdGUFltcGxZM1JTWlhCdmNuUmxjaTVxY3lJc0lpOHFLbHh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJRVkNCSmJtOTJZY09udzZOdklHVWdVMmx6ZEdWdFlYTWdVMEZjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnU1U1RlUwTXRTVVJjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVVZWUFFrbFRJRTVGVkZkUFVrdFRJRk5NWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVaU1FWVk9TRTlHUlZJdFIwVlRSVXhNVTBOSVFVWlVJRnBWVWlCR1QwVlNSRVZTVlU1SElFUkZVaUJCVGtkRlYwRk9SRlJGVGlCR1QxSlRRMGhWVGtjZ1JTNVdYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRTlTUVU1SFJTQlRRVnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJFWlhWMGMyTm9aU0JVWld4bGEyOXRJRUZIWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVGd2FYcGxaVnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJVUlVOSVRrbFRRMGhGSUZWT1NWWkZVbE5KVkVGVUlFSkZVa3hKVGx4dUtseHVLaUJNYVdObGJuTmxaQ0IxYm1SbGNpQjBhR1VnUVhCaFkyaGxJRXhwWTJWdWMyVXNJRlpsY25OcGIyNGdNaTR3SUNoMGFHVWdYQ0pNYVdObGJuTmxYQ0lwTzF4dUtpQjViM1VnYldGNUlHNXZkQ0IxYzJVZ2RHaHBjeUJtYVd4bElHVjRZMlZ3ZENCcGJpQmpiMjF3YkdsaGJtTmxJSGRwZEdnZ2RHaGxJRXhwWTJWdWMyVXVYRzRxSUZsdmRTQnRZWGtnYjJKMFlXbHVJR0VnWTI5d2VTQnZaaUIwYUdVZ1RHbGpaVzV6WlNCaGRGeHVLbHh1S2lBZ0lHaDBkSEE2THk5M2QzY3VZWEJoWTJobExtOXlaeTlzYVdObGJuTmxjeTlNU1VORlRsTkZMVEl1TUZ4dUtseHVLaUJWYm14bGMzTWdjbVZ4ZFdseVpXUWdZbmtnWVhCd2JHbGpZV0pzWlNCc1lYY2diM0lnWVdkeVpXVmtJSFJ2SUdsdUlIZHlhWFJwYm1jc0lITnZablIzWVhKbFhHNHFJR1JwYzNSeWFXSjFkR1ZrSUhWdVpHVnlJSFJvWlNCTWFXTmxibk5sSUdseklHUnBjM1J5YVdKMWRHVmtJRzl1SUdGdUlGd2lRVk1nU1ZOY0lpQkNRVk5KVXl4Y2Jpb2dWMGxVU0U5VlZDQlhRVkpTUVU1VVNVVlRJRTlTSUVOUFRrUkpWRWxQVGxNZ1QwWWdRVTVaSUV0SlRrUXNJR1ZwZEdobGNpQmxlSEJ5WlhOeklHOXlJR2x0Y0d4cFpXUXVYRzRxSUZObFpTQjBhR1VnVEdsalpXNXpaU0JtYjNJZ2RHaGxJSE53WldOcFptbGpJR3hoYm1kMVlXZGxJR2R2ZG1WeWJtbHVaeUJ3WlhKdGFYTnphVzl1Y3lCaGJtUmNiaW9nYkdsdGFYUmhkR2x2Ym5NZ2RXNWtaWElnZEdobElFeHBZMlZ1YzJVdVhHNHFLaTljYmx4dWFXMXdiM0owSUZONWJtTlBZbXBsWTNRc0lIdERhR0Z1WjJWVWVYQmxMQ0JQWW1wbFkzUlVlWEJsZlNCbWNtOXRJQ2N1TDFCeWIzaDVUMkpxWldOMEp6dGNibWx0Y0c5eWRDQkVZWFJoVDJKcVpXTjBRMmhwYkdRZ1puSnZiU0FuTGk5RVlYUmhUMkpxWldOMFEyaHBiR1FuTzF4dWFXMXdiM0owSUh0a1pXVndRMnh2Ym1WOUlHWnliMjBnSnk0dUwzVjBhV3h6TDNWMGFXeHpMbXB6Snp0Y2JseHVMeW9xWEc0Z0tpQk5ZV2x1SUdWNGRHVnVjMmx2YmlCamJHRnpjeUJtYjNJZ2IySnpaWEoyWlhKeklHRnVaQ0J5WlhCdmNuUmxjbk1zSUhkcGRHZ2dZMjl0Ylc5dUlIQnliM0JsY25ScFpYTWdZVzVrSUcxbGRHaHZaSE11WEc0Z0tpQkRhR2xzWkhKbGJpQnRZVzVoWjJWdFpXNTBJR2x6SUdOdmJXMXZiaUJtYjNJZ2IySnpaWEoyWlhKeklHRnVaQ0J5WlhCdmNuUmxjbk11WEc0Z0tpOWNibU5zWVhOeklFUmhkR0ZQWW1wbFkzUWdlMXh1SUNBdktpQndjbWwyWVhSbFhHNGdJRjkyWlhKemFXOXVPaUJ1ZFcxaVpYSmNibHh1SUNCZmIzZHVaWEk2SUVoNWNHVnlkSGxWVWt4Y2JpQWdYM1Z5YkRvZ1QySnFaV04wVlZKTVhHNGdJRjl6WTJobGJXRTZJRk5qYUdWdFlWeHVJQ0JmWW5Wek9pQk5hVzVwUW5WelhHNGdJRjl6ZEdGMGRYTTZJRzl1SUh3Z2NHRjFjMlZrWEc0Z0lGOXplVzVqVDJKcU9pQlRlVzVqUkdGMFlWeHVYRzRnSUY5amFHbHNaSEpsYmpvZ2V5QnBaRG9nUkdGMFlVOWlhbVZqZEVOb2FXeGtJSDFjYmlBZ1gyTm9hV3hrY21WdVRHbHpkR1Z1WlhKek9pQmJUWE5uVEdsemRHVnVaWEpkWEc1Y2JpQWdMUzB0TFdWMlpXNTBJR2hoYm1Sc1pYSnpMUzB0TFZ4dUlDQmZiMjVCWkdSRGFHbHNaRWhoYm1Sc1pYSTZJQ2hsZG1WdWRDa2dQVDRnZG05cFpGeHVJQ0FxTDF4dVhHNGdJQzhxS2x4dUlDQWdLaUJBYVdkdWIzSmxYRzRnSUNBcUlGTm9iM1ZzWkNCdWIzUWdZbVVnZFhObFpDQmthWEpsWTNSc2VTQmllU0JJZVhCbGNuUnBaWE11SUVsMEozTWdZMkZzYkdWa0lHSjVJSFJvWlNCVGVXNWphR1Z5SUdOeVpXRjBaU0J2Y2lCemRXSnpZM0pwWW1VZ2JXVjBhRzlrSjNOY2JpQWdJQ292WEc0Z0lHTnZibk4wY25WamRHOXlLSE41Ym1Ob1pYSXNJSFZ5YkN3Z2MyTm9aVzFoTENCcGJtbDBhV0ZzVTNSaGRIVnpMQ0JwYm1sMGFXRnNSR0YwWVN3Z1kyaHBiR1J5Wlc1ekxDQnRkWFIxWVd3Z1BTQjBjblZsTENCeVpYTjFiV1ZrSUQwZ1ptRnNjMlVwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdYM1JvYVhNdVgzTjVibU5vWlhJZ1BTQnplVzVqYUdWeU8xeHVJQ0FnSUY5MGFHbHpMbDkxY213Z1BTQjFjbXc3WEc0Z0lDQWdYM1JvYVhNdVgzTmphR1Z0WVNBOUlITmphR1Z0WVR0Y2JpQWdJQ0JmZEdocGN5NWZjM1JoZEhWeklEMGdhVzVwZEdsaGJGTjBZWFIxY3p0Y2JpQWdJQ0JmZEdocGN5NWZjM2x1WTA5aWFpQTlJRzVsZHlCVGVXNWpUMkpxWldOMEtHbHVhWFJwWVd4RVlYUmhLVHRjYmlBZ0lDQmZkR2hwY3k1ZlkyaHBiR1J5Wlc1eklEMGdZMmhwYkdSeVpXNXpPMXh1WEc0Z0lDQWdMeTlVVDBSUE9pQkdiM0lnUm5WeWRHaGxjaUJUZEhWa2VWeHVJQ0FnSUY5MGFHbHpMbDl0ZFhSMVlXeEJkWFJvWlc1MGFXTmhkR2x2YmlBOUlHMTFkSFZoYkR0Y2JseHVJQ0FnSUY5MGFHbHpMbDkyWlhKemFXOXVJRDBnTUR0Y2JpQWdJQ0JmZEdocGN5NWZZMmhwYkdSSlpDQTlJREE3WEc0Z0lDQWdYM1JvYVhNdVgyTm9hV3hrY21WdVQySnFaV04wY3lBOUlIdDlPMXh1SUNBZ0lGOTBhR2x6TGw5amFHbHNaSEpsYmt4cGMzUmxibVZ5Y3lBOUlGdGRPMXh1WEc0Z0lDQWdYM1JvYVhNdVgzSmxjM1Z0WldRZ1BTQnlaWE4xYldWa08xeHVYRzVjYmlBZ0lDQmZkR2hwY3k1ZmIzZHVaWElnUFNCemVXNWphR1Z5TGw5dmQyNWxjanRjYmlBZ0lDQmZkR2hwY3k1ZlluVnpJRDBnYzNsdVkyaGxjaTVmWW5Wek8xeHVYRzRnSUNBZ0x5cHBaaUFvY21WemRXMWxaQ0FtSmlCamFHbHNaSEpsYm5NcElIdGNiaUFnSUNBZ0lGOTBhR2x6TGw5amFHbHNaRWxrSUQwZ1gzUm9hWE11WDJkbGRFeGhjM1JEYUdsc1pFbGtLQ2s3WEc0Z0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblcwUmhkR0VnVDJKcVpXTjBJSEpsYzNWdFpXUmRJR3hoYzNRZ1EyaHBiR1JKWkRvZ0p5d2dYM1JvYVhNdVgyTm9hV3hrU1dRcE8xeHVJQ0FnSUgwcUwxeHVJQ0I5WEc1Y2JpQWdYMmRsZEV4aGMzUkRhR2xzWkVsa0tDa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNCc1pYUWdZMmhwYkdSSlpFbHVkQ0E5SURBN1hHNGdJQ0FnYkdWMElHTm9hV3hrU1dSVGRISnBibWNnUFNCZmRHaHBjeTVmYjNkdVpYSWdLeUFuSXljZ0t5QmphR2xzWkVsa1NXNTBPMXh1WEc1Y2JpQWdJQ0JQWW1wbFkzUXVhMlY1Y3loZmRHaHBjeTVmWTJocGJHUnlaVzV6S1M1bWFXeDBaWElvS0d0bGVTa2dQVDRnZTF4dUlDQWdJQ0FnYVdZZ0tGOTBhR2x6TGw5amFHbHNaSEpsYm5OYmEyVjVYUzVqYUdsc1pFbGtJRDRnWTJocGJHUkpaRk4wY21sdVp5a2dlMXh1SUNBZ0lDQWdJQ0JqYUdsc1pFbGtVM1J5YVc1bklEMGdYM1JvYVhNdVgyTm9hV3hrY21WdWMxdHJaWGxkTG1Ob2FXeGtTV1E3WEc0Z0lDQWdJQ0I5WEc0Z0lDQWdmU2s3WEc1Y2JpQWdJQ0J5WlhSMWNtNGdZMmhwYkdSSlpFbHVkQ0E5SUU1MWJXSmxjaWhqYUdsc1pFbGtVM1J5YVc1bkxuTndiR2wwS0Njakp5bGJNVjBwTzF4dUlDQjlYRzVjYmlBZ1gyRnNiRzlqWVhSbFRHbHpkR1Z1WlhKektDa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNCc1pYUWdZMmhwYkdSQ1lYTmxWVkpNSUQwZ1gzUm9hWE11WDNWeWJDQXJJQ2N2WTJocGJHUnlaVzR2Snp0Y2JpQWdJQ0JqYjI1emIyeGxMbXh2WnlnblcwUmhkR0VnVDJKcVpXTjBJQzBnUVd4c2IyTmhkR1ZNYVhOMFpXNWxjbk5kSUMwZ0p5d2dYM1JvYVhNdVgyTm9hV3hrY21WdWN5azdYRzRnSUNBZ2FXWWdLRjkwYUdsekxsOWphR2xzWkhKbGJuTXBJSHRjYmlBZ0lDQWdJRjkwYUdsekxsOWphR2xzWkhKbGJuTXVabTl5UldGamFDZ29ZMmhwYkdRcElEMCtJSHRjYmlBZ0lDQWdJQ0FnYkdWMElHTm9hV3hrVlZKTUlEMGdZMmhwYkdSQ1lYTmxWVkpNSUNzZ1kyaHBiR1E3WEc0Z0lDQWdJQ0FnSUd4bGRDQnNhWE4wWlc1bGNpQTlJRjkwYUdsekxsOWlkWE11WVdSa1RHbHpkR1Z1WlhJb1kyaHBiR1JWVWt3c0lDaHRjMmNwSUQwK0lIdGNiaUFnSUNBZ0lDQWdJQ0F2TDJsbmJtOXlaU0J0YzJjZ2MyVnVkQ0JpZVNCb2FXMXpaV3htWEc0Z0lDQWdJQ0FnSUNBZ2FXWWdLRzF6Wnk1bWNtOXRJQ0U5UFNCMGFHbHpMbDl2ZDI1bGNpa2dlMXh1SUNBZ0lDQWdJQ0FnSUNBZ1kyOXVjMjlzWlM1c2IyY29KMFJoZEdGUFltcGxZM1F0UTJocGJHUnlaVzR0VWtOV09pQW5MQ0J0YzJjcE8xeHVJQ0FnSUNBZ0lDQWdJQ0FnYzNkcGRHTm9JQ2h0YzJjdWRIbHdaU2tnZTF4dUlDQWdJQ0FnSUNBZ0lDQWdJQ0JqWVhObElDZGpjbVZoZEdVbk9pQmZkR2hwY3k1ZmIyNURhR2xzWkVOeVpXRjBaU2h0YzJjcE95QmljbVZoYXp0Y2JpQWdJQ0FnSUNBZ0lDQWdJQ0FnWTJGelpTQW5aR1ZzWlhSbEp6b2dZMjl1YzI5c1pTNXNiMmNvYlhObktUc2dZbkpsWVdzN1hHNGdJQ0FnSUNBZ0lDQWdJQ0FnSUdSbFptRjFiSFE2SUY5MGFHbHpMbDlqYUdGdVoyVkRhR2xzWkhKbGJpaHRjMmNwT3lCaWNtVmhhenRjYmlBZ0lDQWdJQ0FnSUNBZ0lIMWNiaUFnSUNBZ0lDQWdJQ0I5WEc0Z0lDQWdJQ0FnSUgwcE8xeHVYRzRnSUNBZ0lDQWdJRjkwYUdsekxsOWphR2xzWkhKbGJreHBjM1JsYm1WeWN5NXdkWE5vS0d4cGMzUmxibVZ5S1R0Y2JpQWdJQ0FnSUgwcE8xeHVJQ0FnSUgxY2JpQWdmVnh1WEc0Z0lGOXlaV3hsWVhObFRHbHpkR1Z1WlhKektDa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNCZmRHaHBjeTVmWTJocGJHUnlaVzVNYVhOMFpXNWxjbk11Wm05eVJXRmphQ2dvYkdsemRHVnVaWElwSUQwK0lIdGNiaUFnSUNBZ0lHeHBjM1JsYm1WeUxuSmxiVzkyWlNncE8xeHVJQ0FnSUgwcE8xeHVYRzRnSUNBZ1QySnFaV04wTG10bGVYTW9YM1JvYVhNdVgyTm9hV3hrY21WdVQySnFaV04wY3lrdVptOXlSV0ZqYUNnb2EyVjVLU0E5UGlCN1hHNGdJQ0FnSUNCZmRHaHBjeTVmWTJocGJHUnlaVzVQWW1wbFkzUnpXMnRsZVYwdVgzSmxiR1ZoYzJWTWFYTjBaVzVsY25Nb0tUdGNiaUFnSUNCOUtUdGNiaUFnZlZ4dVhHNGdJQzhxS2x4dUlDQWdLaUJQWW1wbFkzUWdWVkpNSUc5bUlISmxjRzl5ZEdWeUlHOXlJRzlpYzJWeWRtVnlYRzRnSUNBcUlFQjBlWEJsSUh0UFltcGxZM1JWVWt4OVhHNGdJQ0FxTDF4dUlDQm5aWFFnZFhKc0tDa2dleUJ5WlhSMWNtNGdkR2hwY3k1ZmRYSnNPeUI5WEc1Y2JpQWdMeW9xWEc0Z0lDQXFJRTlpYW1WamRDQnpZMmhsYldFZ1ZWSk1JQ2gwYUdseklHWnBaV3hrSUdseklHNXZkQ0I1WlhRZ2MzUmhZbXhsTENCaGJtUWdhWE1nYzNWaWMycGxZM1FnZEc4Z1kyaGhibWRsS1Z4dUlDQWdLaUJBZEhsd1pTQjdVMk5vWlcxaFZWSk1mVnh1SUNBZ0tpOWNiaUFnWjJWMElITmphR1Z0WVNncElIc2djbVYwZFhKdUlIUm9hWE11WDNOamFHVnRZVHNnZlZ4dVhHNGdJQzhxS2x4dUlDQWdLaUJUZEdGMGRYTWdiMllnZEdobElISmxjRzl5ZEdWeUlHOXlJRzlpYzJWeWRtVnlJR052Ym01bFkzUnBiMjRnS0hSb2FYTWdabWxsYkdRZ2FYTWdibTkwSUhsbGRDQnpkR0ZpYkdVc0lHRnVaQ0JwY3lCemRXSnphbVZqZENCMGJ5QmphR0Z1WjJVcFhHNGdJQ0FxSUVCMGVYQmxJSHRUZEdGMGRYTjlJQzBnUlc1MWJTQnZaam9nYjI0Z2ZDQndZWFZ6WldSY2JpQWdJQ292WEc0Z0lHZGxkQ0J6ZEdGMGRYTW9LU0I3SUhKbGRIVnliaUIwYUdsekxsOXpkR0YwZFhNN0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1JHRjBZU0J6ZEhKMVkzUjFjbVVnZEc4Z1ltVWdjM2x1WTJoeWIyNXBlbVZrTGx4dUlDQWdLaUJBZEhsd1pTQjdTbE5QVG4wZ0xTQktVMDlPSUhOMGNuVmpkSFZ5WlNCMGFHRjBJSE5vYjNWc1pDQm1iMnhzYjNjZ2RHaGxJR1JsWm1sdVpXUWdjMk5vWlcxaExDQnBaaUJoYm5rdVhHNGdJQ0FxTDF4dUlDQm5aWFFnWkdGMFlTZ3BJSHNnY21WMGRYSnVJSFJvYVhNdVgzTjVibU5QWW1vdVpHRjBZVHNnZlZ4dVhHNGdJQzhxS2x4dUlDQWdLaUJCYkd3Z1kzSmxZWFJsWkNCamFHbHNaSEpsYmlkeklITnBibU5sSUhSb1pTQnpkV0p6WTNKcGNIUnBiMjRzSUdSdlpYTnVKM1FnWTI5dWRHRnBiaUJoYkd3Z1kyaHBiR1J5Wlc0bmN5QnphVzVqWlNCeVpYQnZjblJsY2lCamNtVmhkR2x2Ymk1Y2JpQWdJQ29nUUhSNWNHVWdlMDlpYW1WamREeERhR2xzWkVsa0xDQkVZWFJoVDJKcVpXTjBRMmhwYkdRK2ZWeHVJQ0FnS2k5Y2JpQWdaMlYwSUdOb2FXeGtjbVZ1Y3lncElIc2djbVYwZFhKdUlIUm9hWE11WDJOb2FXeGtjbVZ1VDJKcVpXTjBjenNnZlZ4dVhHNGdJQzhxS2x4dUlDQWdLaUJBYVdkdWIzSmxYRzRnSUNBcUwxeHVJQ0J3WVhWelpTZ3BJSHRjYmlBZ0lDQXZMMVJQUkU4NklIUm9hWE1nWm1WaGRIVnlaU0J1WldWa2N5QnRiM0psSUdGdVlXeHBjMlZjYmlBZ0lDQjBhSEp2ZHlBblRtOTBJR2x0Y0d4bGJXVnVkR1ZrSnp0Y2JpQWdmVnh1WEc0Z0lDOHFLbHh1SUNBZ0tpQkFhV2R1YjNKbFhHNGdJQ0FxTDF4dUlDQnlaWE4xYldVb0tTQjdYRzRnSUNBZ0x5OVVUMFJQT2lCMGFHbHpJR1psWVhSMWNtVWdibVZsWkhNZ2JXOXlaU0JoYm1Gc2FYTmxYRzRnSUNBZ2RHaHliM2NnSjA1dmRDQnBiWEJzWlcxbGJuUmxaQ2M3WEc0Z0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1FHbG5ibTl5WlZ4dUlDQWdLaTljYmlBZ2MzUnZjQ2dwSUh0Y2JpQWdJQ0F2TDFSUFJFODZJSE5vYjNWc1pDQnlaVzF2ZG1VZ2RHaGxJSE4xWW5OamNtbHdkR2x2YmlCaGJtUWdjMlZ1WkNCdFpYTnpZV2RsSUhWdWMzVmljMk55YVdKbFAxeHVJQ0FnSUhSb2NtOTNJQ2RPYjNRZ2FXMXdiR1Z0Wlc1MFpXUW5PMXh1SUNCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUVOeVpXRjBaU0JoYm1RZ1lXUmtJR0VnUkdGMFlVOWlhbVZqZEVOb2FXeGtJSFJ2SUdFZ1kyaHBiR1J5Wlc0Z1kyOXNiR1ZqZEdsdmJpNWNiaUFnSUNvZ1FIQmhjbUZ0SUh0VGRISnBibWQ5SUdOb2FXeGtjbVZ1SUMwZ1EyaHBiR1J5Wlc0Z2JtRnRaU0IzYUdWeVpTQjBhR1VnWTJocGJHUWdhWE1nWVdSa1pXUXVYRzRnSUNBcUlFQndZWEpoYlNCN1NsTlBUbjBnYVc1cGRHbGhiRVJoZEdFZ0xTQkpibWwwYVdGc0lHUmhkR0VnYjJZZ2RHaGxJR05vYVd4a1hHNGdJQ0FxSUVCd1lYSmhiU0FnZTAxbGMzTmhaMlZDYjJSNVNXUmxiblJwZEhsOUlHbGtaVzUwYVhSNUlDMGdLRzl3ZEdsdmJtRnNLU0JwWkdWdWRHbDBlU0JrWVhSaElIUnZJR0psSUdGa1pHVmtJSFJ2SUdsa1pXNTBhWFI1SUhSb1pTQjFjMlZ5SUhKbGNHOXlkR1Z5TGlCVWJ5QmlaU0IxYzJWa0lHWnZjaUJzWldkaFkza2dhV1JsYm5ScGRHbGxjeTVjYmlBZ0lDb2dRSEpsZEhWeWJpQjdVSEp2YldselpUeEVZWFJoVDJKcVpXTjBRMmhwYkdRK2ZTQXRJRkpsZEhWeWJpQlFjbTl0YVhObElIUnZJR0VnYm1WM0lFUmhkR0ZQWW1wbFkzUkRhR2xzWkM1Y2JpQWdJQ292WEc0Z0lHRmtaRU5vYVd4a0tHTm9hV3hrY21WdUxDQnBibWwwYVdGc1JHRjBZU3dnYVdSbGJuUnBkSGtwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdMeTlqY21WaGRHVWdibVYzSUdOb2FXeGtJSFZ1YVhGMVpTQkpSQ3dnWW1GelpXUWdiMjRnYUhsd1pYSjBlVlZTVEZ4dUlDQWdJRjkwYUdsekxsOWphR2xzWkVsa0t5czdYRzRnSUNBZ2JHVjBJRzF6WjBOb2FXeGtTV1FnUFNCZmRHaHBjeTVmYjNkdVpYSWdLeUFuSXljZ0t5QmZkR2hwY3k1ZlkyaHBiR1JKWkR0Y2JpQWdJQ0JzWlhRZ2JYTm5RMmhwYkdSUVlYUm9JRDBnWDNSb2FYTXVYM1Z5YkNBcklDY3ZZMmhwYkdSeVpXNHZKeUFySUdOb2FXeGtjbVZ1TzF4dVhHNGdJQ0FnTHk5R1RFOVhMVTlWVkRvZ2RHaHBjeUJ0WlhOellXZGxJSGRwYkd3Z1ltVWdjMlZ1ZENCa2FYSmxZM1JzZVNCMGJ5QmhJSEpsYzI5MWNtTmxJR05vYVd4a0lHRmtaSEpsYzNNNklFMWxjM05oWjJWQ2RYTmNiaUFnSUNCc1pYUWdjbVZ4ZFdWemRFMXpaeUE5SUh0Y2JpQWdJQ0FnSUhSNWNHVTZJQ2RqY21WaGRHVW5MQ0JtY205dE9pQmZkR2hwY3k1ZmIzZHVaWElzSUhSdk9pQnRjMmREYUdsc1pGQmhkR2dzWEc0Z0lDQWdJQ0JpYjJSNU9pQjdJSEpsYzI5MWNtTmxPaUJ0YzJkRGFHbHNaRWxrTENCMllXeDFaVG9nYVc1cGRHbGhiRVJoZEdFZ2ZWeHVJQ0FnSUgwN1hHNWNiaUFnSUNCcFppQW9hV1JsYm5ScGRIa3BJQ0FnSUNBZ2V5QnlaWEYxWlhOMFRYTm5MbUp2WkhrdWFXUmxiblJwZEhrZ1BTQnBaR1Z1ZEdsMGVUc2dmVnh1WEc0Z0lDQWdMeTlVVDBSUE9pQkdiM0lnUm5WeWRHaGxjaUJUZEhWa2VWeHVJQ0FnSUdsbUlDZ2hYM1JvYVhNdVgyMTFkSFZoYkVGMWRHaGxiblJwWTJGMGFXOXVLU0J5WlhGMVpYTjBUWE5uTG1KdlpIa3ViWFYwZFdGc1FYVjBhR1Z1ZEdsallYUnBiMjRnUFNCZmRHaHBjeTVmYlhWMGRXRnNRWFYwYUdWdWRHbGpZWFJwYjI0N1hHNWNiaUFnSUNBdkwzSmxkSFZ5Ym5NZ2NISnZiV2x6WlN3Z2FXNGdkR2hsSUdaMWRIVnlaU3dnZEdobElFRlFTU0J0WVhrZ1kyaGhibWRsSUhSdklHRnplVzVqYUhKdmJtOTFjeUJqWVd4c1hHNGdJQ0FnY21WMGRYSnVJRzVsZHlCUWNtOXRhWE5sS0NoeVpYTnZiSFpsS1NBOVBpQjdYRzRnSUNBZ0lDQnNaWFFnYlhOblNXUWdQU0JmZEdocGN5NWZZblZ6TG5CdmMzUk5aWE56WVdkbEtISmxjWFZsYzNSTmMyY3BPMXh1WEc0Z0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblkzSmxZWFJsTFhKbGNHOXlkR1Z5TFdOb2FXeGtLQ0FuSUNzZ1gzUm9hWE11WDI5M2JtVnlJQ3NnSnlBcE9pQW5MQ0J5WlhGMVpYTjBUWE5uS1R0Y2JpQWdJQ0FnSUd4bGRDQnVaWGREYUdsc1pDQTlJRzVsZHlCRVlYUmhUMkpxWldOMFEyaHBiR1FvWDNSb2FYTXNJRzF6WjBOb2FXeGtTV1FzSUdsdWFYUnBZV3hFWVhSaExDQmZkR2hwY3k1ZmIzZHVaWElzSUcxelowbGtLVHRjYmlBZ0lDQWdJRzVsZDBOb2FXeGtMbTl1UTJoaGJtZGxLQ2hsZG1WdWRDa2dQVDRnZTF4dUlDQWdJQ0FnSUNCZmRHaHBjeTVmYjI1RGFHRnVaMlVvWlhabGJuUXNJSHNnY0dGMGFEb2diWE5uUTJocGJHUlFZWFJvTENCamFHbHNaRWxrT2lCdGMyZERhR2xzWkVsa0lIMHBPMXh1SUNBZ0lDQWdmU2s3WEc1Y2JpQWdJQ0FnSUY5MGFHbHpMbDlqYUdsc1pISmxiazlpYW1WamRITmJiWE5uUTJocGJHUkpaRjBnUFNCdVpYZERhR2xzWkR0Y2JseHVJQ0FnSUNBZ2NtVnpiMngyWlNodVpYZERhR2xzWkNrN1hHNGdJQ0FnZlNrN1hHNGdJSDFjYmx4dUlDQXZLaXBjYmlBZ0lDb2dVMlYwZFhBZ2RHaGxJR05oYkd4aVlXTnJJSFJ2SUhCeWIyTmxjM01nWTNKbFlYUmxJR0Z1WkNCa1pXeGxkR1VnYjJZZ1kyaHBiR1J5Wlc1ekxseHVJQ0FnS2lCQWNHRnlZVzBnZTJaMWJtTjBhVzl1S0dWMlpXNTBPaUJOYzJkRmRtVnVkQ2w5SUdOaGJHeGlZV05yWEc0Z0lDQXFMMXh1SUNCdmJrRmtaRU5vYVd4a0tHTmhiR3hpWVdOcktTQjdYRzRnSUNBZ2RHaHBjeTVmYjI1QlpHUkRhR2xzWkhKbGJraGhibVJzWlhJZ1BTQmpZV3hzWW1GamF6dGNiaUFnZlZ4dVhHNGdJQzh2Umt4UFZ5MUpUam9nYldWemMyRm5aU0J5WldObGFYWmxaQ0JtY205dElHRWdjbVZ0YjNSbElFUmhkR0ZQWW1wbFkzUWdMVDRnWVdSa1EyaHBiR1JjYmlBZ1gyOXVRMmhwYkdSRGNtVmhkR1VvYlhObktTQjdYRzRnSUNBZ2JHVjBJRjkwYUdseklEMGdkR2hwY3p0Y2JpQWdJQ0JzWlhRZ2JYTm5RMmhwYkdSSlpDQTlJRzF6Wnk1aWIyUjVMbkpsYzI5MWNtTmxPMXh1WEc0Z0lDQWdZMjl1YzI5c1pTNXNiMmNvSjJOeVpXRjBaUzF2WW5ObGNuWmxjaTFqYUdsc1pDZ2dKeUFySUY5MGFHbHpMbDl2ZDI1bGNpQXJJQ2NnS1RvZ0p5d2diWE5uS1R0Y2JpQWdJQ0JzWlhRZ2JtVjNRMmhwYkdRZ1BTQnVaWGNnUkdGMFlVOWlhbVZqZEVOb2FXeGtLRjkwYUdsekxDQnRjMmREYUdsc1pFbGtMQ0J0YzJjdVltOWtlUzUyWVd4MVpTazdYRzRnSUNBZ1gzUm9hWE11WDJOb2FXeGtjbVZ1VDJKcVpXTjBjMXR0YzJkRGFHbHNaRWxrWFNBOUlHNWxkME5vYVd4a08xeHVYRzRnSUNBZ2MyVjBWR2x0Wlc5MWRDZ29LU0E5UGlCN1hHNGdJQ0FnSUNBdkwwWk1UMWN0VDFWVU9pQjNhV3hzSUdac2IzY2dkRzhnUkdGMFlVOWlhbVZqZEVOb2FXeGtJQzArSUY5dmJsSmxjM0J2Ym5ObFhHNGdJQ0FnSUNCZmRHaHBjeTVmWW5WekxuQnZjM1JOWlhOellXZGxLSHRjYmlBZ0lDQWdJQ0FnYVdRNklHMXpaeTVwWkN3Z2RIbHdaVG9nSjNKbGMzQnZibk5sSnl3Z1puSnZiVG9nYlhObkxuUnZMQ0IwYnpvZ2JYTm5MbVp5YjIwc1hHNGdJQ0FnSUNBZ0lHSnZaSGs2SUhzZ1kyOWtaVG9nTWpBd0xDQnpiM1Z5WTJVNklGOTBhR2x6TGw5dmQyNWxjaUI5WEc0Z0lDQWdJQ0I5S1R0Y2JpQWdJQ0I5S1R0Y2JseHVJQ0FnSUd4bGRDQmxkbVZ1ZENBOUlIdGNiaUFnSUNBZ0lIUjVjR1U2SUcxelp5NTBlWEJsTEZ4dUlDQWdJQ0FnWm5KdmJUb2diWE5uTG1aeWIyMHNYRzRnSUNBZ0lDQjFjbXc2SUcxelp5NTBieXhjYmlBZ0lDQWdJSFpoYkhWbE9pQnRjMmN1WW05a2VTNTJZV3gxWlN4Y2JpQWdJQ0FnSUdOb2FXeGtTV1E2SUcxelowTm9hV3hrU1dRc1hHNGdJQ0FnSUNCcFpHVnVkR2wwZVRvZ2JYTm5MbUp2WkhrdWFXUmxiblJwZEhsY2JpQWdJQ0I5TzF4dVhHNGdJQ0FnYVdZZ0tGOTBhR2x6TGw5dmJrRmtaRU5vYVd4a2NtVnVTR0Z1Wkd4bGNpa2dlMXh1SUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvSjBGRVJDMURTRWxNUkZKRlRpMUZWa1ZPVkRvZ0p5d2daWFpsYm5RcE8xeHVJQ0FnSUNBZ1gzUm9hWE11WDI5dVFXUmtRMmhwYkdSeVpXNUlZVzVrYkdWeUtHVjJaVzUwS1R0Y2JpQWdJQ0I5WEc0Z0lIMWNibHh1SUNBdkwzTmxibVFnWkdWc2RHRWdiV1Z6YzJGblpYTWdkRzhnYzNWaWMyTnlhWEIwYVc5dWMxeHVJQ0JmYjI1RGFHRnVaMlVvWlhabGJuUXNJR05vYVd4a1NXNW1ieWtnZTF4dUlDQWdJR3hsZENCZmRHaHBjeUE5SUhSb2FYTTdYRzVjYmlBZ0lDQmZkR2hwY3k1ZmRtVnljMmx2Ymlzck8xeHVYRzRnSUNBZ2FXWWdLRjkwYUdsekxsOXpkR0YwZFhNZ1BUMDlJQ2R2YmljcElIdGNiaUFnSUNBZ0lDOHZSa3hQVnkxUFZWUTZJSFJvYVhNZ2JXVnpjMkZuWlNCM2FXeHNJR0psSUhObGJuUWdaR2x5WldOMGJIa2dkRzhnWVNCeVpYTnZkWEpqWlNCamFHRnVaMlZ6SUdGa1pISmxjM002SUUxbGMzTmhaMlZDZFhOY2JpQWdJQ0FnSUd4bGRDQmphR0Z1WjJWTmMyY2dQU0I3WEc0Z0lDQWdJQ0FnSUhSNWNHVTZJQ2QxY0dSaGRHVW5MQ0JtY205dE9pQmZkR2hwY3k1ZmRYSnNMQ0IwYnpvZ1gzUm9hWE11WDNWeWJDQXJJQ2N2WTJoaGJtZGxjeWNzWEc0Z0lDQWdJQ0FnSUdKdlpIazZJSHNnZG1WeWMybHZiam9nWDNSb2FYTXVYM1psY25OcGIyNHNJSE52ZFhKalpUb2dYM1JvYVhNdVgyOTNibVZ5TENCaGRIUnlhV0oxZEdVNklHVjJaVzUwTG1acFpXeGtJSDFjYmlBZ0lDQWdJSDA3WEc1Y2JpQWdJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZGJSR0YwWVU5aWFtVmpkQ0F0SUY5dmJrTm9ZVzVuWlYwZ0xTQW5MQ0JsZG1WdWRDd2dZMmhwYkdSSmJtWnZMQ0JqYUdGdVoyVk5jMmNwTzF4dVhHNGdJQ0FnSUNCcFppQW9aWFpsYm5RdWIxUjVjR1VnUFQwOUlFOWlhbVZqZEZSNWNHVXVUMEpLUlVOVUtTQjdYRzRnSUNBZ0lDQWdJR2xtSUNobGRtVnVkQzVqVkhsd1pTQWhQVDBnUTJoaGJtZGxWSGx3WlM1U1JVMVBWa1VwSUh0Y2JpQWdJQ0FnSUNBZ0lDQmphR0Z1WjJWTmMyY3VZbTlrZVM1MllXeDFaU0E5SUdWMlpXNTBMbVJoZEdFN1hHNGdJQ0FnSUNBZ0lIMWNiaUFnSUNBZ0lIMGdaV3h6WlNCN1hHNGdJQ0FnSUNBZ0lHTm9ZVzVuWlUxelp5NWliMlI1TG1GMGRISnBZblYwWlZSNWNHVWdQU0JsZG1WdWRDNXZWSGx3WlR0Y2JpQWdJQ0FnSUNBZ1kyaGhibWRsVFhObkxtSnZaSGt1ZG1Gc2RXVWdQU0JsZG1WdWRDNWtZWFJoTzF4dUlDQWdJQ0FnSUNCcFppQW9aWFpsYm5RdVkxUjVjR1VnSVQwOUlFTm9ZVzVuWlZSNWNHVXVWVkJFUVZSRktTQjdYRzRnSUNBZ0lDQWdJQ0FnWTJoaGJtZGxUWE5uTG1KdlpIa3ViM0JsY21GMGFXOXVJRDBnWlhabGJuUXVZMVI1Y0dVN1hHNGdJQ0FnSUNBZ0lIMWNiaUFnSUNBZ0lIMWNibHh1SUNBZ0lDQWdMeTlqYUdsc1pFbHVabThnYlhWemRDQm9ZWFpsSUNod1lYUm9MQ0JqYUdsc1pFbGtLVnh1SUNBZ0lDQWdhV1lnS0dOb2FXeGtTVzVtYnlrZ2UxeHVJQ0FnSUNBZ0lDQmphR0Z1WjJWTmMyY3VkRzhnUFNCamFHbHNaRWx1Wm04dWNHRjBhRHRjYmlBZ0lDQWdJQ0FnWTJoaGJtZGxUWE5uTG1KdlpIa3VjbVZ6YjNWeVkyVWdQU0JqYUdsc1pFbHVabTh1WTJocGJHUkpaRHRjYmlBZ0lDQWdJSDFjYmx4dUlDQWdJQ0FnTHk5VVQwUlBPaUJHYjNJZ1JuVnlkR2hsY2lCVGRIVmtlVnh1SUNBZ0lDQWdhV1lnS0NGZmRHaHBjeTVmYlhWMGRXRnNRWFYwYUdWdWRHbGpZWFJwYjI0cElHTm9ZVzVuWlUxelp5NWliMlI1TG0xMWRIVmhiRUYxZEdobGJuUnBZMkYwYVc5dUlEMGdYM1JvYVhNdVgyMTFkSFZoYkVGMWRHaGxiblJwWTJGMGFXOXVPMXh1WEc0Z0lDQWdJQ0JmZEdocGN5NWZZblZ6TG5CdmMzUk5aWE56WVdkbEtHTm9ZVzVuWlUxelp5azdYRzRnSUNBZ2ZWeHVJQ0I5WEc1Y2JpQWdMeTlHVEU5WExVbE9PaUJrWld4MFlTQnRaWE56WVdkbElISmxZMlZwZG1Wa0lHWnliMjBnWVNCeVpXMXZkR1VnUkdGMFlVOWlhbVZqZEZKbGNHOXlkR1Z5SUc5eUlFUmhkR0ZQWW1wbFkzUkRhR2xzWkNCM2FHVnVJR05vWVc1bmFXNW5JR1JoZEdGY2JpQWdYMk5vWVc1blpVOWlhbVZqZENoemVXNWpUMkpxTENCdGMyY3BJSHRjYmlBZ0lDQnNaWFFnWDNSb2FYTWdQU0IwYUdsek8xeHVYRzRnSUNBZ0x5OVVUMFJQT2lCMWNHUmhkR1VnZG1WeWMybHZiaUEvWEc0Z0lDQWdMeTlvYjNjZ2RHOGdhR0Z1Wkd4bElHRnVJR2x1WTI5eWNtVmpkQ0IyWlhKemFXOXVJRDhnUlhoaGJYQnNaVG9nY21WalpXbDJaU0JoSUhabGNuTnBiMjRnTXlCM2FHVnVJSFJvWlNCdlluTmxjblpsY2lCcGN5QnBiaUIyWlhKemFXOXVJREVzSUhkb1pYSmxJR2x6SUhSb1pTQjJaWEp6YVc5dUlESWdQMXh1SUNBZ0lDOHZkMmxzYkNCM1pTQnVaV1ZrSUhSdklHTnZibVpwY20wZ2RHaGxJSEpsWTJWd2RHbHZiaUEvWEc0Z0lDQWdhV1lnS0Y5MGFHbHpMbDkyWlhKemFXOXVJQ3NnTVNBOVBUMGdiWE5uTG1KdlpIa3VkbVZ5YzJsdmJpa2dlMXh1SUNBZ0lDQWdYM1JvYVhNdVgzWmxjbk5wYjI0ckt6dGNiaUFnSUNBZ0lHeGxkQ0J3WVhSb0lEMGdiWE5uTG1KdlpIa3VZWFIwY21saWRYUmxPMXh1SUNBZ0lDQWdiR1YwSUhaaGJIVmxJRDBnWkdWbGNFTnNiMjVsS0cxelp5NWliMlI1TG5aaGJIVmxLVHRjYmlBZ0lDQWdJR3hsZENCbWFXNWtVbVZ6ZFd4MElEMGdjM2x1WTA5aWFpNW1hVzVrUW1WbWIzSmxLSEJoZEdncE8xeHVYRzRnSUNBZ0lDQnBaaUFvYlhObkxtSnZaSGt1WVhSMGNtbGlkWFJsVkhsd1pTQTlQVDBnVDJKcVpXTjBWSGx3WlM1QlVsSkJXU2tnZTF4dUlDQWdJQ0FnSUNCcFppQW9iWE5uTG1KdlpIa3ViM0JsY21GMGFXOXVJRDA5UFNCRGFHRnVaMlZVZVhCbExrRkVSQ2tnZTF4dUlDQWdJQ0FnSUNBZ0lHeGxkQ0JoY25JZ1BTQm1hVzVrVW1WemRXeDBMbTlpYWp0Y2JpQWdJQ0FnSUNBZ0lDQnNaWFFnYVc1a1pYZ2dQU0JtYVc1a1VtVnpkV3gwTG14aGMzUTdYRzRnSUNBZ0lDQWdJQ0FnUVhKeVlYa3VjSEp2ZEc5MGVYQmxMbk53YkdsalpTNWhjSEJzZVNoaGNuSXNJRnRwYm1SbGVDd2dNRjB1WTI5dVkyRjBLSFpoYkhWbEtTazdYRzRnSUNBZ0lDQWdJSDBnWld4elpTQnBaaUFvYlhObkxtSnZaSGt1YjNCbGNtRjBhVzl1SUQwOVBTQkRhR0Z1WjJWVWVYQmxMbEpGVFU5V1JTa2dlMXh1SUNBZ0lDQWdJQ0FnSUd4bGRDQmhjbklnUFNCbWFXNWtVbVZ6ZFd4MExtOWlhanRjYmlBZ0lDQWdJQ0FnSUNCc1pYUWdhVzVrWlhnZ1BTQm1hVzVrVW1WemRXeDBMbXhoYzNRN1hHNGdJQ0FnSUNBZ0lDQWdZWEp5TG5Od2JHbGpaU2hwYm1SbGVDd2dkbUZzZFdVcE8xeHVJQ0FnSUNBZ0lDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ0lDQWdJR1pwYm1SU1pYTjFiSFF1YjJKcVcyWnBibVJTWlhOMWJIUXViR0Z6ZEYwZ1BTQjJZV3gxWlRzZ0x5OGdWVkJFUVZSRlhHNGdJQ0FnSUNBZ0lIMWNiaUFnSUNBZ0lIMGdaV3h6WlNCN1hHNGdJQ0FnSUNBZ0lHbG1JQ2h0YzJjdVltOWtlUzUyWVd4MVpTa2dlMXh1SUNBZ0lDQWdJQ0FnSUdacGJtUlNaWE4xYkhRdWIySnFXMlpwYm1SU1pYTjFiSFF1YkdGemRGMGdQU0IyWVd4MVpUc2dMeThnVlZCRVFWUkZJRzl5SUVGRVJGeHVJQ0FnSUNBZ0lDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ0lDQWdJR1JsYkdWMFpTQm1hVzVrVW1WemRXeDBMbTlpYWx0bWFXNWtVbVZ6ZFd4MExteGhjM1JkT3lBdkx5QlNSVTFQVmtWY2JpQWdJQ0FnSUNBZ2ZWeHVJQ0FnSUNBZ2ZWeHVJQ0FnSUgwZ1pXeHpaU0I3WEc0Z0lDQWdJQ0F2TDFSUFJFODZJR2h2ZHlCMGJ5Qm9ZVzVrYkdVZ2RXNXplVzVqYUhKdmJtbDZaV1FnZG1WeWMybHZibk0vWEc0Z0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblZVNVRXVTVEU0ZKUFRrbGFSVVFnVmtWU1UwbFBUam9nS0dSaGRHRWdQVDRnSnlBcklGOTBhR2x6TGw5MlpYSnphVzl1SUNzZ0p5d2diWE5uSUQwK0lDY2dLeUJ0YzJjdVltOWtlUzUyWlhKemFXOXVJQ3NnSnlrbktUdGNiaUFnSUNCOVhHNGdJSDFjYmx4dUlDQXZMMFpNVDFjdFNVNDZJRzFsYzNOaFoyVWdjbVZqWldsMlpXUWdabkp2YlNCaElISmxiVzkwWlNCRVlYUmhUMkpxWldOMFEyaHBiR1FnZDJobGJpQmphR0Z1WjJsdVp5QmtZWFJoWEc0Z0lGOWphR0Z1WjJWRGFHbHNaSEpsYmlodGMyY3BJSHRjYmlBZ0lDQnNaWFFnWDNSb2FYTWdQU0IwYUdsek8xeHVJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZERhR0Z1WjJVZ1kyaHBiR1J5Wlc0NklDY3NJRjkwYUdsekxsOXZkMjVsY2l3Z2JYTm5LVHRjYmx4dUlDQWdJR3hsZENCamFHbHNaRWxrSUQwZ2JYTm5MbUp2WkhrdWNtVnpiM1Z5WTJVN1hHNGdJQ0FnYkdWMElHTm9hV3hrY21WdUlEMGdYM1JvYVhNdVgyTm9hV3hrY21WdVQySnFaV04wYzF0amFHbHNaRWxrWFR0Y2JseHVJQ0FnSUdsbUlDaGphR2xzWkhKbGJpa2dlMXh1SUNBZ0lDQWdYM1JvYVhNdVgyTm9ZVzVuWlU5aWFtVmpkQ2hqYUdsc1pISmxiaTVmYzNsdVkwOWlhaXdnYlhObktUdGNiaUFnSUNCOUlHVnNjMlVnZTF4dUlDQWdJQ0FnWTI5dWMyOXNaUzVzYjJjb0owNXZJR05vYVd4a2NtVnVJR1p2ZFc1a0lHWnZjam9nSnl3Z1kyaHBiR1JKWkNrN1hHNGdJQ0FnZlZ4dUlDQjlYRzVjYm4xY2JseHVaWGh3YjNKMElHUmxabUYxYkhRZ1JHRjBZVTlpYW1WamREdGNibHh1WEc1Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU0lDOHZYRzR2THlBdUwzTnlZeTl6ZVc1amFHVnlMMFJoZEdGUFltcGxZM1F1YW5NaUxDSnBiWEJ2Y25RZ0ozQnliM2g1TFc5aWMyVnlkbVVuTzF4dWFXMXdiM0owSUh0d1lYSnpaVUYwZEhKcFluVjBaWE45SUdaeWIyMGdKeTR1TDNWMGFXeHpMM1YwYVd4ekp6dGNibHh1WTI5dWMzUWdiMkpxWldOMFZIbHdaU0E5SUh0QlVsSkJXVG9nSjF0dlltcGxZM1FnUVhKeVlYbGRKeXdnVDBKS1JVTlVPaUFuVzI5aWFtVmpkQ0JQWW1wbFkzUmRKeUI5TzF4dVhHNHZLaXBjYmlBcUlFQmhZMk5sYzNNZ2NISnBkbUYwWlZ4dUlDb2dUV0ZwYmlCamJHRnpjeUIwYUdGMElHMWhhVzUwWVdsdWN5QmhJRXBUVDA0Z2IySnFaV04wTENCaGJtUWdiMkp6WlhKMlpYTWdZMmhoYm1kbGN5QnBiaUIwYUdseklHOWlhbVZqZEN3Z2NtVmpkWEp6YVhabGJIa3VYRzRnS2lCSmJuUmxjbTVoYkNCdlltcGxZM1J6SUdGdVpDQmhjbkpoZVhNZ1lYSmxJR0ZzYzI4Z2IySnpaWEoyWldRdVhHNGdLaTljYm1Oc1lYTnpJRk41Ym1OUFltcGxZM1FnZTF4dVhHNGdJR052Ym5OMGNuVmpkRzl5S0dsdWFYUnBZV3hFWVhSaEtTQjdYRzRnSUNBZ2JHVjBJRjkwYUdseklEMGdkR2hwY3p0Y2JseHVJQ0FnSUY5MGFHbHpMbDl2WW5ObGNuWmxjbk1nUFNCYlhUdGNiaUFnSUNCZmRHaHBjeTVmWm1sc2RHVnljeUE5SUh0OU8xeHVYRzRnSUNBZ2RHaHBjeTVmWkdGMFlTQTlJR2x1YVhScFlXeEVZWFJoSUh4OElIdDlPMXh1WEc0Z0lDQWdkR2hwY3k1ZmFXNTBaWEp1WVd4UFluTmxjblpsS0hSb2FYTXVYMlJoZEdFcE8xeHVJQ0I5WEc1Y2JpQWdaMlYwSUdSaGRHRW9LU0I3SUhKbGRIVnliaUIwYUdsekxsOWtZWFJoT3lCOVhHNWNiaUFnYjJKelpYSjJaU2hqWVd4c1ltRmpheWtnZTF4dUlDQWdJSFJvYVhNdVgyOWljMlZ5ZG1WeWN5NXdkWE5vS0dOaGJHeGlZV05yS1R0Y2JpQWdmVnh1WEc0Z0lHWnBibVFvY0dGMGFDa2dlMXh1SUNBZ0lHeGxkQ0JzYVhOMElEMGdjR0Z5YzJWQmRIUnlhV0oxZEdWektIQmhkR2dwTzF4dVhHNGdJQ0FnY21WMGRYSnVJSFJvYVhNdVgyWnBibVJYYVhSb1UzQnNhWFFvYkdsemRDazdYRzRnSUgxY2JseHVJQ0JtYVc1a1FtVm1iM0psS0hCaGRHZ3BJSHRjYmlBZ0lDQnNaWFFnY21WemRXeDBJRDBnZTMwN1hHNGdJQ0FnYkdWMElHeHBjM1FnUFNCd1lYSnpaVUYwZEhKcFluVjBaWE1vY0dGMGFDazdYRzRnSUNBZ2NtVnpkV3gwTG14aGMzUWdQU0JzYVhOMExuQnZjQ2dwTzF4dUlDQWdJSEpsYzNWc2RDNXZZbW9nUFNCMGFHbHpMbDltYVc1a1YybDBhRk53YkdsMEtHeHBjM1FwTzF4dVhHNGdJQ0FnY21WMGRYSnVJSEpsYzNWc2REdGNiaUFnZlZ4dVhHNGdJRjltYVc1a1YybDBhRk53YkdsMEtHeHBjM1FwSUh0Y2JpQWdJQ0JzWlhRZ2IySnFJRDBnZEdocGN5NWZaR0YwWVR0Y2JpQWdJQ0JzYVhOMExtWnZja1ZoWTJnb0tIWmhiSFZsS1NBOVBpQjdYRzRnSUNBZ0lDQnZZbW9nUFNCdlltcGJkbUZzZFdWZE8xeHVJQ0FnSUgwcE8xeHVYRzRnSUNBZ2NtVjBkWEp1SUc5aWFqdGNiaUFnZlZ4dVhHNGdJRjlwYm5SbGNtNWhiRTlpYzJWeWRtVW9iMkpxWldOMEtTQjdYRzVjYmlBZ0lDQnNaWFFnYUdGdVpHeGxjaUE5SUNoamFHRnVaMlZ6WlhRcElEMCtJSHRjYmx4dUlDQWdJQ0FnWTJoaGJtZGxjMlYwTG1WMlpYSjVLQ2hqYUdGdVoyVXBJRDArSUh0Y2JpQWdJQ0FnSUNBZ2RHaHBjeTVmYjI1RGFHRnVaMlZ6S0dOb1lXNW5aU2s3WEc0Z0lDQWdJQ0I5S1R0Y2JseHVJQ0FnSUgwN1hHNWNiaUFnSUNCMGFHbHpMbDlrWVhSaElEMGdUMkpxWldOMExtUmxaWEJQWW5ObGNuWmxLRzlpYW1WamRDd2dhR0Z1Wkd4bGNpazdYRzVjYmlBZ2ZWeHVYRzRnSUY5bWFYSmxSWFpsYm5Rb1pYWmxiblFwSUh0Y2JpQWdJQ0IwYUdsekxsOXZZbk5sY25abGNuTXVabTl5UldGamFDZ29ZMkZzYkdKaFkyc3BJRDArSUh0Y2JpQWdJQ0FnSUdOaGJHeGlZV05yS0dWMlpXNTBLVHRjYmlBZ0lDQjlLVHRjYmlBZ2ZWeHVYRzRnSUY5dmJrTm9ZVzVuWlhNb1kyaGhibWRsS1NCN1hHNWNiaUFnSUNCc1pYUWdiMkpxSUQwZ1kyaGhibWRsTG05aWFtVmpkRHRjYmlBZ0lDQnNaWFFnYjJKcVZIbHdaVHRjYmx4dUlDQWdJR2xtSUNodlltb3VZMjl1YzNSeWRXTjBiM0lnUFQwOUlFOWlhbVZqZENrZ2UxeHVJQ0FnSUNBZ2IySnFWSGx3WlNBOUlFOWlhbVZqZEZSNWNHVXVUMEpLUlVOVU8xeHVJQ0FnSUgxY2JseHVJQ0FnSUdsbUlDaHZZbW91WTI5dWMzUnlkV04wYjNJZ1BUMDlJRUZ5Y21GNUtTQjdYRzRnSUNBZ0lDQnZZbXBVZVhCbElEMGdUMkpxWldOMFZIbHdaUzVCVWxKQldUdGNiaUFnSUNCOVhHNWNiaUFnSUNCc1pYUWdabWxsYkdSVGRISnBibWNnUFNCamFHRnVaMlV1YTJWNWNHRjBhRHRjYmx4dUlDQWdJQzh2SUdOdmJuTnZiR1V1Ykc5bktDZEdhV1ZzWkRvbkxDQm1hV1ZzWkZOMGNtbHVaeWs3WEc0Z0lDQWdMeThnWTI5dWMyOXNaUzVzYjJjb0ozUjVjR1U2Snl3Z1kyaGhibWRsTG5SNWNHVXBPMXh1WEc0Z0lDQWdMeTlzWlhRZ2IyeGtWbUZzZFdVZ1BTQmphR0Z1WjJVdWIyeGtWbUZzZFdVN1hHNGdJQ0FnYkdWMElHNWxkMVpoYkhWbElEMGdiMkpxVzJOb1lXNW5aUzV1WVcxbFhUdGNibHh1SUNBZ0lDOHZJR052Ym5OdmJHVXVhVzVtYnloamFHRnVaMlV1ZEhsd1pTQXJJQ2NnZkNCR2FXVnNaRG9nSnlBcklHWnBaV3hrVTNSeWFXNW5JQ3NnSnlCOElFNWxkeUJXWVd4MVpUb25MQ0JLVTA5T0xuTjBjbWx1WjJsbWVTaHVaWGRXWVd4MVpTa3NJR1pwWld4a1UzUnlhVzVuTG1sdVkyeDFaR1Z6S0Nkc1pXNW5kR2duS1NrN1hHNWNiaUFnSUNCcFppQW9ZMmhoYm1kbExuUjVjR1VnUFQwOUlDZDFjR1JoZEdVbklDWW1JQ0ZtYVdWc1pGTjBjbWx1Wnk1cGJtTnNkV1JsY3lnbkxteGxibWQwYUNjcEtTQjdYRzRnSUNBZ0lDQjBhR2x6TGw5bWFYSmxSWFpsYm5Rb2UxeHVJQ0FnSUNBZ0lDQmpWSGx3WlRvZ1EyaGhibWRsVkhsd1pTNVZVRVJCVkVVc1hHNGdJQ0FnSUNBZ0lHOVVlWEJsT2lCdlltcFVlWEJsTEZ4dUlDQWdJQ0FnSUNCbWFXVnNaRG9nWm1sbGJHUlRkSEpwYm1jc1hHNGdJQ0FnSUNBZ0lHUmhkR0U2SUc1bGQxWmhiSFZsWEc0Z0lDQWdJQ0I5S1R0Y2JpQWdJQ0I5WEc1Y2JpQWdJQ0JwWmlBb1kyaGhibWRsTG5SNWNHVWdQVDA5SUNkaFpHUW5LU0I3WEc0Z0lDQWdJQ0IwYUdsekxsOW1hWEpsUlhabGJuUW9lMXh1SUNBZ0lDQWdJQ0JqVkhsd1pUb2dRMmhoYm1kbFZIbHdaUzVCUkVRc1hHNGdJQ0FnSUNBZ0lHOVVlWEJsT2lCdlltcFVlWEJsTEZ4dUlDQWdJQ0FnSUNCbWFXVnNaRG9nWm1sbGJHUlRkSEpwYm1jc1hHNGdJQ0FnSUNBZ0lHUmhkR0U2SUc1bGQxWmhiSFZsWEc0Z0lDQWdJQ0I5S1R0Y2JpQWdJQ0I5WEc1Y2JpQWdJQ0JwWmlBb1kyaGhibWRsTG5SNWNHVWdQVDA5SUNka1pXeGxkR1VuS1NCN1hHNGdJQ0FnSUNCMGFHbHpMbDltYVhKbFJYWmxiblFvZTF4dUlDQWdJQ0FnSUNCalZIbHdaVG9nUTJoaGJtZGxWSGx3WlM1U1JVMVBWa1VzWEc0Z0lDQWdJQ0FnSUc5VWVYQmxPaUJ2WW1wVWVYQmxMRnh1SUNBZ0lDQWdJQ0JtYVdWc1pEb2dabWxsYkdSVGRISnBibWRjYmlBZ0lDQWdJSDBwTzF4dUlDQWdJSDFjYmlBZ2ZWeHVYRzU5WEc1Y2JtVjRjRzl5ZENCc1pYUWdRMmhoYm1kbFZIbHdaU0E5SUh0VlVFUkJWRVU2SUNkMWNHUmhkR1VuTENCQlJFUTZJQ2RoWkdRbkxDQlNSVTFQVmtVNklDZHlaVzF2ZG1VbmZUdGNibVY0Y0c5eWRDQnNaWFFnVDJKcVpXTjBWSGx3WlNBOUlIdFBRa3BGUTFRNklDZHZZbXBsWTNRbkxDQkJVbEpCV1RvZ0oyRnljbUY1SjMwN1hHNWxlSEJ2Y25RZ1pHVm1ZWFZzZENCVGVXNWpUMkpxWldOME8xeHVYRzVjYmx4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZJZ0x5OWNiaTh2SUM0dmMzSmpMM041Ym1Ob1pYSXZVSEp2ZUhsUFltcGxZM1F1YW5NaUxDSmNJblZ6WlNCemRISnBZM1JjSWp0Y2JseHVaWGh3YjNKMGN5NWZYMlZ6VFc5a2RXeGxJRDBnZEhKMVpUdGNibHh1ZG1GeUlGOW5aWFJRY205MGIzUjVjR1ZQWmlBOUlISmxjWFZwY21Vb1hDSXVMaTlqYjNKbExXcHpMMjlpYW1WamRDOW5aWFF0Y0hKdmRHOTBlWEJsTFc5bVhDSXBPMXh1WEc1MllYSWdYMmRsZEZCeWIzUnZkSGx3WlU5bU1pQTlJRjlwYm5SbGNtOXdVbVZ4ZFdseVpVUmxabUYxYkhRb1gyZGxkRkJ5YjNSdmRIbHdaVTltS1R0Y2JseHVkbUZ5SUY5blpYUlBkMjVRY205d1pYSjBlVVJsYzJOeWFYQjBiM0lnUFNCeVpYRjFhWEpsS0Z3aUxpNHZZMjl5WlMxcWN5OXZZbXBsWTNRdloyVjBMVzkzYmkxd2NtOXdaWEowZVMxa1pYTmpjbWx3ZEc5eVhDSXBPMXh1WEc1MllYSWdYMmRsZEU5M2JsQnliM0JsY25SNVJHVnpZM0pwY0hSdmNqSWdQU0JmYVc1MFpYSnZjRkpsY1hWcGNtVkVaV1poZFd4MEtGOW5aWFJQZDI1UWNtOXdaWEowZVVSbGMyTnlhWEIwYjNJcE8xeHVYRzVtZFc1amRHbHZiaUJmYVc1MFpYSnZjRkpsY1hWcGNtVkVaV1poZFd4MEtHOWlhaWtnZXlCeVpYUjFjbTRnYjJKcUlDWW1JRzlpYWk1ZlgyVnpUVzlrZFd4bElEOGdiMkpxSURvZ2V5QmtaV1poZFd4ME9pQnZZbW9nZlRzZ2ZWeHVYRzVsZUhCdmNuUnpMbVJsWm1GMWJIUWdQU0JtZFc1amRHbHZiaUJuWlhRb2IySnFaV04wTENCd2NtOXdaWEowZVN3Z2NtVmpaV2wyWlhJcElIdGNiaUFnYVdZZ0tHOWlhbVZqZENBOVBUMGdiblZzYkNrZ2IySnFaV04wSUQwZ1JuVnVZM1JwYjI0dWNISnZkRzkwZVhCbE8xeHVJQ0IyWVhJZ1pHVnpZeUE5SUNnd0xDQmZaMlYwVDNkdVVISnZjR1Z5ZEhsRVpYTmpjbWx3ZEc5eU1pNWtaV1poZFd4MEtTaHZZbXBsWTNRc0lIQnliM0JsY25SNUtUdGNibHh1SUNCcFppQW9aR1Z6WXlBOVBUMGdkVzVrWldacGJtVmtLU0I3WEc0Z0lDQWdkbUZ5SUhCaGNtVnVkQ0E5SUNnd0xDQmZaMlYwVUhKdmRHOTBlWEJsVDJZeUxtUmxabUYxYkhRcEtHOWlhbVZqZENrN1hHNWNiaUFnSUNCcFppQW9jR0Z5Wlc1MElEMDlQU0J1ZFd4c0tTQjdYRzRnSUNBZ0lDQnlaWFIxY200Z2RXNWtaV1pwYm1Wa08xeHVJQ0FnSUgwZ1pXeHpaU0I3WEc0Z0lDQWdJQ0J5WlhSMWNtNGdaMlYwS0hCaGNtVnVkQ3dnY0hKdmNHVnlkSGtzSUhKbFkyVnBkbVZ5S1R0Y2JpQWdJQ0I5WEc0Z0lIMGdaV3h6WlNCcFppQW9YQ0oyWVd4MVpWd2lJR2x1SUdSbGMyTXBJSHRjYmlBZ0lDQnlaWFIxY200Z1pHVnpZeTUyWVd4MVpUdGNiaUFnZlNCbGJITmxJSHRjYmlBZ0lDQjJZWElnWjJWMGRHVnlJRDBnWkdWell5NW5aWFE3WEc1Y2JpQWdJQ0JwWmlBb1oyVjBkR1Z5SUQwOVBTQjFibVJsWm1sdVpXUXBJSHRjYmlBZ0lDQWdJSEpsZEhWeWJpQjFibVJsWm1sdVpXUTdYRzRnSUNBZ2ZWeHVYRzRnSUNBZ2NtVjBkWEp1SUdkbGRIUmxjaTVqWVd4c0tISmxZMlZwZG1WeUtUdGNiaUFnZlZ4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlvWld4d1pYSnpMMmRsZEM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01USTFYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNJc0lpOHFLbHh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJRVkNCSmJtOTJZY09udzZOdklHVWdVMmx6ZEdWdFlYTWdVMEZjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnU1U1RlUwTXRTVVJjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVVZWUFFrbFRJRTVGVkZkUFVrdFRJRk5NWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVaU1FWVk9TRTlHUlZJdFIwVlRSVXhNVTBOSVFVWlVJRnBWVWlCR1QwVlNSRVZTVlU1SElFUkZVaUJCVGtkRlYwRk9SRlJGVGlCR1QxSlRRMGhWVGtjZ1JTNVdYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRTlTUVU1SFJTQlRRVnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJFWlhWMGMyTm9aU0JVWld4bGEyOXRJRUZIWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVGd2FYcGxaVnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJVUlVOSVRrbFRRMGhGSUZWT1NWWkZVbE5KVkVGVUlFSkZVa3hKVGx4dUtseHVLaUJNYVdObGJuTmxaQ0IxYm1SbGNpQjBhR1VnUVhCaFkyaGxJRXhwWTJWdWMyVXNJRlpsY25OcGIyNGdNaTR3SUNoMGFHVWdYQ0pNYVdObGJuTmxYQ0lwTzF4dUtpQjViM1VnYldGNUlHNXZkQ0IxYzJVZ2RHaHBjeUJtYVd4bElHVjRZMlZ3ZENCcGJpQmpiMjF3YkdsaGJtTmxJSGRwZEdnZ2RHaGxJRXhwWTJWdWMyVXVYRzRxSUZsdmRTQnRZWGtnYjJKMFlXbHVJR0VnWTI5d2VTQnZaaUIwYUdVZ1RHbGpaVzV6WlNCaGRGeHVLbHh1S2lBZ0lHaDBkSEE2THk5M2QzY3VZWEJoWTJobExtOXlaeTlzYVdObGJuTmxjeTlNU1VORlRsTkZMVEl1TUZ4dUtseHVLaUJWYm14bGMzTWdjbVZ4ZFdseVpXUWdZbmtnWVhCd2JHbGpZV0pzWlNCc1lYY2diM0lnWVdkeVpXVmtJSFJ2SUdsdUlIZHlhWFJwYm1jc0lITnZablIzWVhKbFhHNHFJR1JwYzNSeWFXSjFkR1ZrSUhWdVpHVnlJSFJvWlNCTWFXTmxibk5sSUdseklHUnBjM1J5YVdKMWRHVmtJRzl1SUdGdUlGd2lRVk1nU1ZOY0lpQkNRVk5KVXl4Y2Jpb2dWMGxVU0U5VlZDQlhRVkpTUVU1VVNVVlRJRTlTSUVOUFRrUkpWRWxQVGxNZ1QwWWdRVTVaSUV0SlRrUXNJR1ZwZEdobGNpQmxlSEJ5WlhOeklHOXlJR2x0Y0d4cFpXUXVYRzRxSUZObFpTQjBhR1VnVEdsalpXNXpaU0JtYjNJZ2RHaGxJSE53WldOcFptbGpJR3hoYm1kMVlXZGxJR2R2ZG1WeWJtbHVaeUJ3WlhKdGFYTnphVzl1Y3lCaGJtUmNiaW9nYkdsdGFYUmhkR2x2Ym5NZ2RXNWtaWElnZEdobElFeHBZMlZ1YzJVdVhHNHFLaTljYm1sdGNHOXlkQ0I3SUdSbFpYQkRiRzl1WlNCOUlHWnliMjBnSnk0dUwzVjBhV3h6TDNWMGFXeHpKenRjYmx4dWFXMXdiM0owSUVSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2lCbWNtOXRJQ2N1TDBSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2ljN1hHNXBiWEJ2Y25RZ1JHRjBZVTlpYW1WamRFOWljMlZ5ZG1WeUlHWnliMjBnSnk0dlJHRjBZVTlpYW1WamRFOWljMlZ5ZG1WeUp6dGNibWx0Y0c5eWRDQkVZWFJoVUhKdmRtbHphVzl1WVd3Z1puSnZiU0FuTGk5RVlYUmhVSEp2ZG1semFXOXVZV3duTzF4dVhHNHZLaXBjYmlvZ1ZHaGxJRzFoYVc0Z1kyeGhjM01nWm05eUlIUm9aU0J6ZVc1amFHVnlJSEJoWTJ0aFoyVXVYRzRxSUZSb1pTQlRlVzVqYUdWeUlHbHpJR0VnYzJsdVoyeGxkRzl1SUdOc1lYTnpJSEJsY2lCSWVYQmxjblI1TDFWU1RDQmhibVFnYVhRZ2FYTWdkR2hsSUc5M2JtVnlJRzltSUdGc2JDQmpjbVZoZEdWa0lFUmhkR0VnVTNsdVl5QlBZbXBsWTNSeklHRmpZMjl5WkdsdVp5QjBieUIwYUdVZ1VtVndiM0owWlhJZ0xTQlBZbk5sY25abGNpQndZWFIwWlhKdUxseHVLaUJOWVdsdUlHWjFibU4wYVc5dVlXeHBkSGtnYVhNZ2RHOGdZM0psWVhSbElISmxjRzl5ZEdWeWN5QmhibVFnZEc4Z2MzVmljMk55YVdKbElIUnZJR1Y0YVhOMGFXNW5JRzl1WlhNdVhHNHFMMXh1WTJ4aGMzTWdVM2x1WTJobGNpQjdYRzRnSUM4cUlIQnlhWFpoZEdWY2JpQWdYMjkzYm1WeU9pQlZVa3hjYmlBZ1gySjFjem9nVFdsdWFVSjFjMXh1WEc0Z0lGOXpkV0pWVWt3NklGVlNURnh1WEc0Z0lGOXlaWEJ2Y25SbGNuTTZJRHgxY213NklFUmhkR0ZQWW1wbFkzUlNaWEJ2Y25SbGNqNWNiaUFnWDI5aWMyVnlkbVZ5Y3pvZ1BIVnliRG9nUkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5UGx4dUlDQmZjSEp2ZG1semFXOXVZV3h6T2lBOGRYSnNPaUJFWVhSaFVISnZkbWx6YVc5dVlXdytYRzVjYmlBZ0xTMHRMV1YyWlc1MElHaGhibVJzWlhKekxTMHRMVnh1SUNCZmIyNU9iM1JwWm1sallYUnBiMjVJWVc1a2JHVnlPaUFvWlhabGJuUXBJRDArSUhadmFXUmNiaUFnWDI5dVVtVnpkVzFsT2lBb1pYWmxiblFwSUQwK0lIWnZhV1JjYmlBZ0tpOWNibHh1SUNBdktpcGNiaUFnS2lCRGIyNXpkSEoxWTNSdmNpQjBhR0YwSUhOb2IzVnNaQ0JpWlNCMWMyVmtJR0o1SUhSb1pTQkllWEJsY25SNUlHOTNibVZ5WEc0Z0lDb2dRSEJoY21GdElIdEllWEJsY25SNVZWSk1mU0J2ZDI1bGNpQXRJRWg1Y0dWeWRIa2dWVkpNSUc5M2JtVnlMaUJCYmlCVlVrd2dZV3hzYjJOaGRHVmtJR0o1SUhSb1pTQnlkVzUwYVcxbElIUm9ZWFFnZFc1cGNYVmxiSGtnYVdSbGJuUnBabWxsY3lCMGFHVWdTSGx3WlhKMGVTNWNiaUFnS2lCQWNHRnlZVzBnZTAxcGJtbENkWE45SUdKMWN5QXRJRUZ1SUdsdWMzUmhibU5sSUc5bUlIUm9aU0JOYVc1cFFuVnpJSEJ5YjNacFpHVmtJR2x1SUhSb1pTQnpZVzVrWW05NExpQlhhR1Z1SUdGdUlHOWlhbVZqZENBb1VtVndiM0owWlhJZ2IzSWdUMkp6WlhKMlpXUXBJR2x6SUdOeVpXRjBaV1FzSUhSb1pTQlRlVzVqYUdWeVRXRnVZV2RsY2lCM2FXeHNJR0ZrWkNCaElHeHBjM1JsYm1WeUlHbHVJSFJvWlNCTmFXNXBRblZ6SUhSdklISmxZMlZwZG1VdmMyVnVaQ0JOWlhOellXZGxjeUJ2WmlCMGFHRjBJRzlpYW1WamRDNWNiaUFnS2lCQWNHRnlZVzBnZTBwVFQwNTlJR052Ym1acFp5QXRJRU52Ym1acFozVnlZWFJwYjI0Z1pHRjBZUzRnVkdobElHOXViSGtnY21WeGRXbHlaV1FnWm1sbGJHUWdabTl5SUc1dmR5QnBjeUIwYUdVZ2NuVnVkR2x0WlZWU1RDNWNiaUFnS2k5Y2JpQWdZMjl1YzNSeWRXTjBiM0lvYjNkdVpYSXNJR0oxY3l3Z1kyOXVabWxuS1NCN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmx4dUlDQWdJRjkwYUdsekxsOXZkMjVsY2lBOUlHOTNibVZ5TzF4dUlDQWdJRjkwYUdsekxsOWlkWE1nUFNCaWRYTTdYRzVjYmlBZ0lDQmZkR2hwY3k1ZmMzVmlWVkpNSUQwZ1kyOXVabWxuTG5KMWJuUnBiV1ZWVWt3Z0t5QW5MM050Snp0Y2JseHVJQ0FnSUY5MGFHbHpMbDl5WlhCdmNuUmxjbk1nUFNCN2ZUdGNiaUFnSUNCZmRHaHBjeTVmYjJKelpYSjJaWEp6SUQwZ2UzMDdYRzRnSUNBZ1gzUm9hWE11WDNCeWIzWnBjMmx2Ym1Gc2N5QTlJSHQ5TzF4dVhHNGdJQ0FnWW5WekxtRmtaRXhwYzNSbGJtVnlLRzkzYm1WeUxDQW9iWE5uS1NBOVBpQjdYRzRnSUNBZ0lDQXZMMmxuYm05eVpTQnRjMmNnYzJWdWRDQmllU0JvYVcxelpXeG1YRzRnSUNBZ0lDQnBaaUFvYlhObkxtWnliMjBnSVQwOUlHOTNibVZ5S1NCN1hHNGdJQ0FnSUNBZ0lHTnZibk52YkdVdWFXNW1ieWduVzFONWJtTm9aWEpkSUZONWJtTm9aWEl0VWtOV09pQW5MQ0J0YzJjc0lGOTBhR2x6S1R0Y2JpQWdJQ0FnSUNBZ2MzZHBkR05vSUNodGMyY3VkSGx3WlNrZ2UxeHVJQ0FnSUNBZ0lDQWdJR05oYzJVZ0oyWnZjbmRoY21Rbk9pQmZkR2hwY3k1ZmIyNUdiM0ozWVhKa0tHMXpaeWs3SUdKeVpXRnJPMXh1SUNBZ0lDQWdJQ0FnSUdOaGMyVWdKMk55WldGMFpTYzZJRjkwYUdsekxsOXZibEpsYlc5MFpVTnlaV0YwWlNodGMyY3BPeUJpY21WaGF6dGNiaUFnSUNBZ0lDQWdJQ0JqWVhObElDZGtaV3hsZEdVbk9pQmZkR2hwY3k1ZmIyNVNaVzF2ZEdWRVpXeGxkR1VvYlhObktUc2dZbkpsWVdzN1hHNGdJQ0FnSUNBZ0lIMWNiaUFnSUNBZ0lIMWNiaUFnSUNCOUtUdGNiaUFnZlZ4dVhHNGdJQzhxS2x4dUlDQXFJRlJvWlNCdmQyNWxjaUJ2WmlCMGFHVWdVM2x1WTJobGNpQmhibVFnWVd4c0lHTnlaV0YwWldRZ2NtVndiM0owWlhKekxseHVJQ0FxSUVCMGVYQmxJSHRJZVhCbGNuUjVWVkpNZlZ4dUlDQXFMMXh1SUNCblpYUWdiM2R1WlhJb0tTQjdJSEpsZEhWeWJpQjBhR2x6TGw5dmQyNWxjanNnZlZ4dVhHNGdJQzhxS2x4dUlDQXFJRUZzYkNCdmQyNWxaQ0J5WlhCdmNuUmxjbk1zSUhSb1pTQnZibVZ6SUhSb1lYUWdkMlZ5WlNCamNtVmhkR1ZrSUdKNUlHRWdZM0psWVhSbFhHNGdJQ29nUUhSNWNHVWdlMDlpYW1WamREeFZVa3dzSUVSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2o1OVhHNGdJQ292WEc0Z0lHZGxkQ0J5WlhCdmNuUmxjbk1vS1NCN0lISmxkSFZ5YmlCMGFHbHpMbDl5WlhCdmNuUmxjbk03SUgxY2JseHVJQ0F2S2lwY2JpQWdLaUJCYkd3Z2IzZHVaV1FnYjJKelpYSjJaWEp6TENCMGFHVWdiMjVsY3lCMGFHRjBJSGRsY21VZ1kzSmxZWFJsWkNCaWVTQmhJR3h2WTJGc0lITjFZbk5qY21sd2RHbHZibHh1SUNBcUlFQjBlWEJsSUh0UFltcGxZM1E4VlZKTUxDQkVZWFJoVDJKcVpXTjBUMkp6WlhKMlpYSStmVnh1SUNBcUwxeHVJQ0JuWlhRZ2IySnpaWEoyWlhKektDa2dleUJ5WlhSMWNtNGdkR2hwY3k1ZmIySnpaWEoyWlhKek95QjlYRzVjYmlBZ0x5b3FYRzRnSUNvZ1VtVnhkV1Z6ZENCaElFUmhkR0ZQWW1wbFkzUlNaWEJ2Y25SbGNpQmpjbVZoZEdsdmJpNGdWR2hsSUZWU1RDQjNhV3hzSUdKbElHSmxJSEpsY1hWbGMzUmxaQ0JpZVNCMGFHVWdZV3hzYjJOaGRHbHZiaUJ0WldOb1lXNXBjMjB1WEc0Z0lDb2dRSEJoY21GdElDQjdVMk5vWlcxaFZWSk1mU0J6WTJobGJXRWdMU0JJZVhCbGNuUjVJRU5oZEdGc2IyZDFaU0JWVWt3Z1lXUmtjbVZ6Y3lCMGFHRjBJR05oYmlCaVpTQjFjMlZrSUhSdklISmxkSEpwWlhabElIUm9aU0JLVTA5T0xWTmphR1Z0WVNCa1pYTmpjbWxpYVc1bklIUm9aU0JFWVhSaElFOWlhbVZqZENCelkyaGxiV0ZjYmlBZ0tpQkFjR0Z5WVcwZ0lIdEllWEJsY25SNVZWSk1XMTE5SUc5aWMyVnlkbVZ5Y3lBdElFeHBjM1FnYjJZZ2FIbHdaWEowYVdWeklIUm9ZWFFnWVhKbElIQnlaUzFoZFhSb2IzSnBlbVZrSUdadmNpQnpkV0p6WTNKcGNIUnBiMjVjYmlBZ0tpQkFjR0Z5WVcwZ0lIdEtVMDlPZlNCcGJtbDBhV0ZzUkdGMFlTQXRJRWx1YVhScFlXd2daR0YwWVNCdlppQjBhR1VnY21Wd2IzSjBaWEpjYmlBZ0tpQkFjR0Z5WVcwZ0lIdGliMjlzWldGdWZTQnpkRzl5WlNBdElDaFBjSFJwYjI1aGJDa2dhV1lnZEhKMVpTd2diMkpxWldOMElIZHBiR3dnWW1VZ2MzUnZjbVZrSUdKNUlIUm9aU0J5ZFc1MGFXMWxYRzRnSUNvZ1FIQmhjbUZ0SUNCN1ltOXZiR1ZoYm4wZ2NESndJQzBnS0U5d2RHbHZibUZzS1NCcFppQjBjblZsTENCa1lYUmhJSE41Ym1Ob2NtOXVhWE5oZEdsdmJpQnpkSEpsWVcwZ2QybHNiQ0IxYzJVZ2NESndJR052Ym01bFkzUnBiMjRnWVhNZ2JYVmphQ0JoY3lCd2IzTnphV0pzWlZ4dUlDQXFJRUJ3WVhKaGJTQWdlMDFsYzNOaFoyVkNiMlI1U1dSbGJuUnBkSGw5SUdsa1pXNTBhWFI1SUMwZ0tHOXdkR2x2Ym1Gc0tTQnBaR1Z1ZEdsMGVTQmtZWFJoSUhSdklHSmxJR0ZrWkdWa0lIUnZJR2xrWlc1MGFYUjVJSFJvWlNCMWMyVnlJSEpsY0c5eWRHVnlMaUJVYnlCaVpTQjFjMlZrSUdadmNpQnNaV2RoWTNrZ2FXUmxiblJwZEdsbGN5NWNiaUFnS2lCQWNtVjBkWEp1SUh0UWNtOXRhWE5sUEVSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2o1OUlGSmxkSFZ5YmlCUWNtOXRhWE5sSUhSdklHRWdibVYzSUZKbGNHOXlkR1Z5TGlCVWFHVWdjbVZ3YjNKMFpYSWdZMkZ1SUdKbElHRmpZMlZ3ZEdWa0lHOXlJSEpsYW1WamRHVmtJR0o1SUhSb1pTQlFSVkJjYmlBZ0tpOWNiaUFnWTNKbFlYUmxLSE5qYUdWdFlTd2diMkp6WlhKMlpYSnpMQ0JwYm1sMGFXRnNSR0YwWVN3Z2MzUnZjbVVnUFNCbVlXeHpaU3dnY0RKd0lEMGdabUZzYzJVc0lHbGtaVzUwYVhSNUtTQjdYRzVjYmlBZ0lDQnBaaUFvSVhOamFHVnRZU2tnZEdoeWIzY2dSWEp5YjNJb0oxdFRlVzVqYUdWeUlDMGdRM0psWVhSbFhTQXRJRmx2ZFNCdVpXVmtJSE53WldOcFpua2dkR2hsSUdSaGRHRWdiMkpxWldOMElITmphR1Z0WVNjcE8xeHVJQ0FnSUdsbUlDZ2hiMkp6WlhKMlpYSnpLU0IwYUhKdmR5QkZjbkp2Y2lnblcxTjVibU5vWlhJZ0xTQkRjbVZoZEdWZElDMVVhR1VnYjJKelpYSjJaWEp6SUhOb2IzVnNaQ0JpWlNCa1pXWnBibVZrSnlrN1hHNGdJQ0FnYVdZZ0tDRnBibWwwYVdGc1JHRjBZU2tnZEdoeWIzY2dSWEp5YjNJb0oxdFRlVzVqYUdWeUlDMGdRM0psWVhSbFhTQXRJRmx2ZFNCcGJtbDBhV0ZzUkdGMFlTQnphRzkxYkdRZ1ltVWdaR1ZtYVc1bFpDY3BPMXh1WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNiaUFnSUNCc1pYUWdZM0pwZEdWeWFXRWdQU0I3ZlR0Y2JseHVJQ0FnSUdOeWFYUmxjbWxoTG5BeWNDQTlJSEF5Y0R0Y2JpQWdJQ0JqY21sMFpYSnBZUzV6ZEc5eVpTQTlJSE4wYjNKbE8xeHVJQ0FnSUdOeWFYUmxjbWxoTG5OamFHVnRZU0E5SUhOamFHVnRZVHRjYmlBZ0lDQmpjbWwwWlhKcFlTNXZZbk5sY25abGNuTWdQU0J2WW5ObGNuWmxjbk03WEc0Z0lDQWdZM0pwZEdWeWFXRXVhVzVwZEdsaGJFUmhkR0VnUFNCcGJtbDBhV0ZzUkdGMFlUdGNibHh1SUNBZ0lHbG1JQ2hwWkdWdWRHbDBlU2tnSUNBZ0lDQjdJR055YVhSbGNtbGhMbWxrWlc1MGFYUjVJRDBnYVdSbGJuUnBkSGs3SUgxY2JseHVJQ0FnSUU5aWFtVmpkQzVoYzNOcFoyNG9ZM0pwZEdWeWFXRXNJSHR5WlhOMWJXVTZJR1poYkhObGZTazdYRzVjYmlBZ0lDQmpiMjV6YjJ4bExteHZaeWduVzNONWJtTm9aWElnTFNCamNtVmhkR1ZkSUMwZ1kzSmxZWFJsSUZKbGNHOXlkR1Z5SUMwZ1kzSnBkR1Z5YVdFNklDY3NJR055YVhSbGNtbGhLVHRjYmx4dUlDQWdJSEpsZEhWeWJpQmZkR2hwY3k1ZlkzSmxZWFJsS0dOeWFYUmxjbWxoS1R0Y2JpQWdmVnh1WEc0Z0lDOHFLbHh1SUNBcUlGSmxjWFZsYzNRZ1lTQkVZWFJoVDJKcVpXTjBVbVZ3YjNKMFpYSWdZM0psWVhScGIyNHVJRlJvWlNCVlVrd2dkMmxzYkNCaVpTQmlaU0J5WlhGMVpYTjBaV1FnWW5rZ2RHaGxJR0ZzYkc5allYUnBiMjRnYldWamFHRnVhWE50TGx4dUlDQXFJRUJ3WVhKaGJTQWdlMDlpYW1WamRIMGdZM0pwZEdWeWFXRWdMU0FvYjNCMGFXOXVZV3dwSUdsa1pXNTBhWFI1SUdSaGRHRWdkRzhnWW1VZ1lXUmtaV1FnZEc4Z2FXUmxiblJwZEhrZ2RHaGxJSFZ6WlhJZ2NtVndiM0owWlhJdUlGUnZJR0psSUhWelpXUWdabTl5SUd4bFoyRmplU0JwWkdWdWRHbDBhV1Z6TGx4dUlDQXFJRUJ5WlhSMWNtNGdlMUJ5YjIxcGMyVThSR0YwWVU5aWFtVmpkRkpsY0c5eWRHVnlQbHRkZlNCU1pYUjFjbTRnWVNCd2NtOXRhWE5sSUhkcGRHZ2dZU0JzYVhOMElHOW1JRVJoZEdGUFltcGxZM1JTWlhCdmNuUmxjaUIwYnlCaVpTQnlaWE4xYldWa08xeHVJQ0FxTDF4dUlDQnlaWE4xYldWU1pYQnZjblJsY25Nb1kzSnBkR1Z5YVdFcElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dUlDQWdJR052Ym5OdmJHVXViRzluS0NkYmMzbHVZMmhsY2lBdElHTnlaV0YwWlYwZ0xTQnlaWE4xYldVZ1VtVndiM0owWlhJZ0xTQmpjbWwwWlhKcFlUb2dKeXdnWTNKcGRHVnlhV0VwTzF4dVhHNGdJQ0FnVDJKcVpXTjBMbUZ6YzJsbmJpaGpjbWwwWlhKcFlTd2dlM0psYzNWdFpUb2dkSEoxWlgwcE8xeHVYRzRnSUNBZ2NtVjBkWEp1SUY5MGFHbHpMbDl5WlhOMWJXVkRjbVZoZEdVb1kzSnBkR1Z5YVdFcE8xeHVJQ0I5WEc1Y2JpQWdMeW9xWEc0Z0lDb2dVbVZ4ZFdWemRDQmhJSE4xWW5OamNtbHdkR2x2YmlCMGJ5QmhiaUJsZUdsemRHVnVkQ0J5WlhCdmNuUmxjaUJ2WW1wbFkzUXVYRzRnSUNvZ1FIQmhjbUZ0SUh0VFkyaGxiV0ZWVWt4OUlITmphR1Z0WVNBdElFaDVjR1Z5ZEhrZ1EyRjBZV3h2WjNWbElGVlNUQ0JoWkdSeVpYTnpJSFJvWVhRZ1kyRnVJR0psSUhWelpXUWdkRzhnY21WMGNtbGxkbVVnZEdobElFcFRUMDR0VTJOb1pXMWhJR1JsYzJOeWFXSnBibWNnZEdobElFUmhkR0VnVDJKcVpXTjBJSE5qYUdWdFlWeHVJQ0FxSUVCd1lYSmhiU0I3VDJKcVpXTjBWVkpNZlNCdlltcFZVa3dnTFNCQlpHUnlaWE56SUc5bUlIUm9aU0JsZUdsemRHVnVkQ0J5WlhCdmNuUmxjaUJ2WW1wbFkzUWdkRzhnWW1VZ2IySnpaWEoyWldSY2JpQWdLaUJBY0dGeVlXMGdlMEp2YjJ4bFlXNTlJRnR6ZEc5eVpUMW1ZV3h6WlYwZ0xTQlRZWFpsSUhSb1pTQnpkV0p6WTNKcGNIUnBiMjRnYjI0Z2RHaGxJRk41Ym1Ob1pYSWdUV0Z1WVdkbGNpQm1iM0lnWm5WeWRHaGxjaUJ5WlhOMWJXVWdLRVJsWm1GMWJIUWdhWE1nWm1Gc2MyVXBYRzRnSUNvZ1FIQmhjbUZ0SUh0Q2IyOXNaV0Z1ZlNCYmNESndQV1poYkhObFhTQXRJRWx1Wm04Z1lXSnZkWFFnYVdZZ2MyaHZkV3hrSUhWelpTQndNbkFnWTI5dWJtVmpkR2x2YmlBb1JHVm1ZWFZzZENCcGN5Qm1ZV3h6WlNsY2JpQWdLaUJBY0dGeVlXMGdlMEp2YjJ4bFlXNTlJRnR0ZFhSMVlXdzlkSEoxWlYwZ0xTQkpibVp2SUdGaWIzVjBJR2xtSUcxbGMzTmhaMlZ6SUc5bUlIUm9hWE1nYjJKcVpXTjBJSE5vYjNWc1pDQmlaU0JsYm1OeWVYQjBaV1FnS0VSbFptRjFiSFFnYVhNZ2RISjFaU2xjYmlBZ0tpQkFjR0Z5WVcwZ0lIdE5aWE56WVdkbFFtOWtlVWxrWlc1MGFYUjVmU0JwWkdWdWRHbDBlU0F0SUNodmNIUnBiMjVoYkNrZ2FXUmxiblJwZEhrZ1pHRjBZU0IwYnlCaVpTQmhaR1JsWkNCMGJ5QnBaR1Z1ZEdsMGVTQjBhR1VnZFhObGNpQnlaWEJ2Y25SbGNpNGdWRzhnWW1VZ2RYTmxaQ0JtYjNJZ2JHVm5ZV041SUdsa1pXNTBhWFJwWlhNdVhHNGdJQ29nUUhKbGRIVnliaUI3VUhKdmJXbHpaVHhFWVhSaFQySnFaV04wVDJKelpYSjJaWEkrZlNCU1pYUjFjbTRnVUhKdmJXbHpaU0IwYnlCaElHNWxkeUJ2WW5ObGNuWmxjaTRnU1hRbmN5QmhjM052WTJsaGRHVmtJSGRwZEdnZ2RHaGxJSEpsY0c5eWRHVnlMbHh1SUNBcUwxeHVJQ0J6ZFdKelkzSnBZbVVvYzJOb1pXMWhMQ0J2WW1wVlVrd3NJSE4wYjNKbElEMGdabUZzYzJVc0lIQXljQ0E5SUdaaGJITmxMQ0J0ZFhSMVlXd2dQU0IwY25WbExDQnBaR1Z1ZEdsMGVTa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNGdJQ0FnYkdWMElHTnlhWFJsY21saElEMGdlMzA3WEc1Y2JpQWdJQ0JqY21sMFpYSnBZUzV3TW5BZ1BTQndNbkE3WEc0Z0lDQWdZM0pwZEdWeWFXRXVjM1J2Y21VZ1BTQnpkRzl5WlR0Y2JpQWdJQ0JqY21sMFpYSnBZUzV6WTJobGJXRWdQU0J6WTJobGJXRTdYRzVjYmlBZ0lDQmpjbWwwWlhKcFlTNXlaWE52ZFhKalpTQTlJRzlpYWxWU1REdGNiaUFnSUNCcFppQW9hV1JsYm5ScGRIa3BJQ0FnSUNBZ2V5QmpjbWwwWlhKcFlTNXBaR1Z1ZEdsMGVTQTlJR2xrWlc1MGFYUjVPeUI5WEc1Y2JpQWdJQ0F2TDFSUFJFODZJRVp2Y2lCR2RYSjBhR1Z5SUZOMGRXUjVYRzRnSUNBZ1kzSnBkR1Z5YVdFdWJYVjBkV0ZzSUQwZ2JYVjBkV0ZzTzF4dVhHNGdJQ0FnWTI5dWMyOXNaUzVzYjJjb0oxdHplVzVqYUdWeUlDMGdjM1ZpYzJOeWFXSmxYU0F0SUhOMVluTmpjbWxpWlNCamNtbDBaWEpwWVRvZ0p5d2dZM0pwZEdWeWFXRXBPMXh1WEc0Z0lDQWdUMkpxWldOMExtRnpjMmxuYmloamNtbDBaWEpwWVN3Z2UzSmxjM1Z0WlRvZ1ptRnNjMlY5S1R0Y2JseHVJQ0FnSUhKbGRIVnliaUJmZEdocGN5NWZjM1ZpYzJOeWFXSmxLR055YVhSbGNtbGhLVHRjYmlBZ2ZWeHVYRzRnSUM4cUtseHVJQ0FxSUZKbGNYVmxjM1FnWVNCemRXSnpZM0pwY0hScGIyNGdkRzhnWVc0Z1pYaHBjM1JsYm5RZ2NtVndiM0owWlhJZ2IySnFaV04wTGx4dUlDQXFJRUJ3WVhKaGJTQjdZM0pwZEdWeWFXRjlJR055YVhSbGNtbGhJQzBnU1c1bWIzSnRZWFJwYjI0Z2RHOGdaR2x6WTI5MlpYSjVJSFJvWlNCdlluTmxjblpsY2lCdlltcGxZM1JjYmlBZ0tpQkFjbVYwZFhKdUlIdFFjbTl0YVhObFBFUmhkR0ZQWW1wbFkzUlBZbk5sY25abGNqNTlJRkpsZEhWeWJpQlFjbTl0YVhObElIUnZJR0VnYm1WM0lHOWljMlZ5ZG1WeUxpQkpkQ2R6SUdGemMyOWphV0YwWldRZ2QybDBhQ0IwYUdVZ2NtVndiM0owWlhJdVhHNGdJQ292WEc0Z0lISmxjM1Z0WlU5aWMyVnlkbVZ5Y3loamNtbDBaWEpwWVNrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc0Z0lDQWdiR1YwSUY5amNtbDBaWEpwWVNBOUlHTnlhWFJsY21saElIeDhJSHQ5TzF4dVhHNGdJQ0FnVDJKcVpXTjBMbUZ6YzJsbmJpaGZZM0pwZEdWeWFXRXNJSHR5WlhOMWJXVTZJSFJ5ZFdWOUtUdGNibHh1SUNBZ0lISmxkSFZ5YmlCZmRHaHBjeTVmY21WemRXMWxVM1ZpYzJOeWFXSmxLRjlqY21sMFpYSnBZU2s3WEc0Z0lIMWNibHh1SUNBdktpcGNiaUFnS2lCU1pYRjFaWE4wSUdFZ2NtVmhaQ0JoWTNScGIyNGdiMjRnZEdobElISmxjRzl5ZEdWeUlHOWlhbVZqZEZ4dUlDQXFJRUJ3WVhKaGJTQjdUMkpxWldOMFZWSk1mU0J2WW1wVlVrd2dMU0JWVWt3Z2IyWWdkR2hsSUhKbGNHOXlkR1Z5SUc5aWFtVmpkQ0IwYnlCaVpTQnlaV0ZrWEc0Z0lDb2dRSEpsZEhWeWJpQjdVSEp2YldselpUeFBZbXBsWTNRK2ZTQlNaWFIxY200Z1VISnZiV2x6WlNCMGJ5QnNZWE4wSUdGMllXbHNZV0pzWlNCa1lYUmhJRzltSUhSb1pTQnlaWEJ2Y25SbGNseHVJQ0FxTDF4dUlDQnlaV0ZrS0c5aWFsVlNUQ2tnZTF4dUlDQWdJR3hsZENCZmRHaHBjeUE5SUhSb2FYTTdYRzVjYmlBZ0lDQXZMMFpNVDFjdFQxVlVPaUIwYUdseklHMWxjM05oWjJVZ2QybHNiQ0JpWlNCelpXNTBJR1JwY21WamRHeDVJSFJ2SUhKbGNHOXlkR1Z5SUc5aWFtVmpkQ0FvYldGNVltVWdkR2hsY21VZ2FYTWdibThnYkdsemRHVnVaWElnWVhaaGFXeGhZbXhsTENCemJ5QnBkQ0IzYVd4c0lHSmxJSEpsYzI5c2RtVmtJSGRwZEdnZ1RXVnpjMkZuWlVKMWN5QXRQaUJ5WlhOdmJIWmxLVnh1SUNBZ0lDOHZkMmxzYkNCeVpXRmphQ0IwYUdVZ2NtVnRiM1JsSUc5aWFtVmpkQ0JwYmlCRVlYUmhUMkpxWldOMFVtVndiM0owWlhJZ0xUNGdYMjl1VW1WaFpGeHVJQ0FnSUd4bGRDQnlaV0ZrVFhObklEMGdlMXh1SUNBZ0lDQWdkSGx3WlRvZ0ozSmxZV1FuTENCbWNtOXRPaUJmZEdocGN5NWZiM2R1WlhJc0lIUnZPaUJ2WW1wVlVreGNiaUFnSUNCOU8xeHVYRzRnSUNBZ2NtVjBkWEp1SUc1bGR5QlFjbTl0YVhObEtDaHlaWE52YkhabExDQnlaV3BsWTNRcElEMCtJSHRjYmlBZ0lDQWdJRjkwYUdsekxsOWlkWE11Y0c5emRFMWxjM05oWjJVb2NtVmhaRTF6Wnl3Z0tISmxjR3g1S1NBOVBpQjdYRzRnSUNBZ0lDQWdJR052Ym5OdmJHVXViRzluS0NkeVpXRmtMWEpsYzNCdmJuTmxPaUFuTENCeVpYQnNlU2s3WEc0Z0lDQWdJQ0FnSUdsbUlDaHlaWEJzZVM1aWIyUjVMbU52WkdVZ1BUMDlJREl3TUNrZ2UxeHVJQ0FnSUNBZ0lDQWdJSEpsYzI5c2RtVW9jbVZ3YkhrdVltOWtlUzUyWVd4MVpTazdYRzRnSUNBZ0lDQWdJSDBnWld4elpTQjdYRzRnSUNBZ0lDQWdJQ0FnY21WcVpXTjBLSEpsY0d4NUxtSnZaSGt1WkdWell5azdYRzRnSUNBZ0lDQWdJSDFjYmlBZ0lDQWdJSDBwTzF4dUlDQWdJSDBwTzF4dUlDQjlYRzVjYmlBZ0x5b3FYRzRnSUNvZ1UyVjBkWEFnZEdobElHTmhiR3hpWVdOcklIUnZJSEJ5YjJObGMzTWdZM0psWVhSbElHRnVaQ0JrWld4bGRHVWdaWFpsYm5SeklHOW1JSEpsYlc5MlpTQlNaWEJ2Y25SbGNpQnZZbXBsWTNSekxseHVJQ0FxSUZSb2FYTWdhWE1nY21Wc1pXRjBaV1FnZEc4Z2RHaGxJRzFsYzNOaFoyVnVjeUJ6Wlc1MElHSjVJR055WldGMFpTQjBieUIwYUdVZ2IySnpaWEoyWlhKeklFaDVjR1Z5ZEhrZ1lYSnlZWGt1WEc0Z0lDb2dRSEJoY21GdElIdG1kVzVqZEdsdmJpaGxkbVZ1ZERvZ1RYTm5SWFpsYm5RcGZTQmpZV3hzWW1GamExeHVJQ0FxTDF4dUlDQnZiazV2ZEdsbWFXTmhkR2x2YmloallXeHNZbUZqYXlrZ2UxeHVJQ0FnSUhSb2FYTXVYMjl1VG05MGFXWnBZMkYwYVc5dVNHRnVaR3hsY2lBOUlHTmhiR3hpWVdOck8xeHVJQ0I5WEc1Y2JpQWdYMk55WldGMFpTaGpjbWwwWlhKcFlTa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNCeVpYUjFjbTRnYm1WM0lGQnliMjFwYzJVb0tISmxjMjlzZG1Vc0lISmxhbVZqZENrZ1BUNGdlMXh1SUNBZ0lDQWdiR1YwSUhKbGMzVnRaU0E5SUdOeWFYUmxjbWxoTG5KbGMzVnRaVHRjYmlBZ0lDQWdJR3hsZENCcGJtbDBhV0ZzUkdGMFlTQTlJR055YVhSbGNtbGhMbWx1YVhScFlXeEVZWFJoSUh4OElIdDlPMXh1SUNBZ0lDQWdiR1YwSUhOamFHVnRZU0E5SUdOeWFYUmxjbWxoTG5OamFHVnRZVHRjYmx4dUlDQWdJQ0FnYVc1cGRHbGhiRVJoZEdFdWNtVndiM0owWlhJZ1BTQmZkR2hwY3k1ZmIzZHVaWEk3WEc0Z0lDQWdJQ0JwYm1sMGFXRnNSR0YwWVM1elkyaGxiV0VnUFNCamNtbDBaWEpwWVM1elkyaGxiV0U3WEc1Y2JpQWdJQ0FnSUM4dlJreFBWeTFQVlZRNklIUm9hWE1nYldWemMyRm5aU0IzYVd4c0lHSmxJSE5sYm5RZ2RHOGdkR2hsSUhKMWJuUnBiV1VnYVc1emRHRnVZMlVnYjJZZ1UzbHVZMmhsY2sxaGJtRm5aWElnTFQ0Z1gyOXVRM0psWVhSbFhHNGdJQ0FnSUNCc1pYUWdjbVZ4ZFdWemRFMXpaeUE5SUh0Y2JpQWdJQ0FnSUNBZ2RIbHdaVG9nSjJOeVpXRjBaU2NzSUdaeWIyMDZJRjkwYUdsekxsOXZkMjVsY2l3Z2RHODZJRjkwYUdsekxsOXpkV0pWVWt3c1hHNGdJQ0FnSUNBZ0lHSnZaSGs2SUhzZ2NtVnpkVzFsT2lCeVpYTjFiV1VnZlZ4dUlDQWdJQ0FnZlR0Y2JseHVJQ0FnSUNBZ1kyOXVjMjlzWlM1c2IyY29KMXR6ZVc1amFHVnlJQzBnWTNKbFlYUmxYVG9nSnl3Z1kzSnBkR1Z5YVdFc0lISmxjWFZsYzNSTmMyY3BPMXh1WEc0Z0lDQWdJQ0J5WlhGMVpYTjBUWE5uTG1KdlpIa3VkbUZzZFdVZ1BTQnBibWwwYVdGc1JHRjBZVHRjYmlBZ0lDQWdJSEpsY1hWbGMzUk5jMmN1WW05a2VTNXlaWEJ2Y25SbGNpQTlJRjkwYUdsekxsOXZkMjVsY2p0Y2JpQWdJQ0FnSUhKbGNYVmxjM1JOYzJjdVltOWtlUzV6WTJobGJXRWdQU0JqY21sMFpYSnBZUzV6WTJobGJXRTdYRzVjYmlBZ0lDQWdJR2xtSUNoamNtbDBaWEpwWVM1d01uQXBJSEpsY1hWbGMzUk5jMmN1WW05a2VTNXdNbkFnUFNCamNtbDBaWEpwWVM1d01uQTdYRzRnSUNBZ0lDQnBaaUFvWTNKcGRHVnlhV0V1YzNSdmNtVXBJSEpsY1hWbGMzUk5jMmN1WW05a2VTNXpkRzl5WlNBOUlHTnlhWFJsY21saExuTjBiM0psTzF4dUlDQWdJQ0FnYVdZZ0tHTnlhWFJsY21saExtOWljMlZ5ZG1WeWN5a2djbVZ4ZFdWemRFMXpaeTVpYjJSNUxtRjFkR2h2Y21selpTQTlJR055YVhSbGNtbGhMbTlpYzJWeWRtVnljenRjYmlBZ0lDQWdJR2xtSUNoamNtbDBaWEpwWVM1cFpHVnVkR2wwZVNrZ2NtVnhkV1Z6ZEUxelp5NWliMlI1TG1sa1pXNTBhWFI1SUQwZ1kzSnBkR1Z5YVdFdWFXUmxiblJwZEhrN1hHNWNiaUFnSUNBZ0lHTnZibk52YkdVdWJHOW5LQ2RiYzNsdVkyaGxjaUF0SUdOeVpXRjBaVjBnTFNCamNtVmhkR1VnYldWemMyRm5aVG9nSnl3Z2NtVnhkV1Z6ZEUxelp5azdYRzVjYmlBZ0lDQWdJQzh2Y21WeGRXVnpkQ0JqY21WaGRHVWdkRzhnZEdobElHRnNiRzlqWVhScGIyNGdjM2x6ZEdWdExpQkRZVzRnWW1VZ2NtVnFaV04wWldRZ1lua2dkR2hsSUZCdmJHbGplVVZ1WjJsdVpTNWNiaUFnSUNBZ0lGOTBhR2x6TGw5aWRYTXVjRzl6ZEUxbGMzTmhaMlVvY21WeGRXVnpkRTF6Wnl3Z0tISmxjR3g1S1NBOVBpQjdYRzRnSUNBZ0lDQWdJR052Ym5OdmJHVXViRzluS0NkYmMzbHVZMmhsY2lBdElHTnlaV0YwWlYwZ0xTQmpjbVZoZEdVdGNtVnpjRzl1YzJVNklDY3NJSEpsY0d4NUtUdGNiaUFnSUNBZ0lDQWdhV1lnS0hKbGNHeDVMbUp2WkhrdVkyOWtaU0E5UFQwZ01qQXdLU0I3WEc0Z0lDQWdJQ0FnSUNBZ0x5OXlaWEJ2Y25SbGNpQmpjbVZoZEdsdmJpQmhZMk5sY0hSbFpGeHVJQ0FnSUNBZ0lDQWdJR3hsZENCdlltcFZVa3dnUFNCeVpYQnNlUzVpYjJSNUxuSmxjMjkxY21ObE8xeHVYRzRnSUNBZ0lDQWdJQ0FnYkdWMElHNWxkMDlpYWlBOUlHNWxkeUJFWVhSaFQySnFaV04wVW1Wd2IzSjBaWElvWDNSb2FYTXNJRzlpYWxWU1RDd2djMk5vWlcxaExDQW5iMjRuTENCcGJtbDBhV0ZzUkdGMFlTd2djbVZ3YkhrdVltOWtlUzVqYUdsc1pISmxibEpsYzI5MWNtTmxjeWs3WEc0Z0lDQWdJQ0FnSUNBZ1gzUm9hWE11WDNKbGNHOXlkR1Z5YzF0dlltcFZVa3hkSUQwZ2JtVjNUMkpxTzF4dVhHNGdJQ0FnSUNBZ0lDQWdjbVZ6YjJ4MlpTaHVaWGRQWW1vcE8xeHVJQ0FnSUNBZ0lDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ0lDQWdJQzh2Y21Wd2IzSjBaWElnWTNKbFlYUnBiMjRnY21WcVpXTjBaV1JjYmlBZ0lDQWdJQ0FnSUNCeVpXcGxZM1FvY21Wd2JIa3VZbTlrZVM1a1pYTmpLVHRjYmlBZ0lDQWdJQ0FnZlZ4dUlDQWdJQ0FnZlNrN1hHNGdJQ0FnZlNrN1hHNWNiaUFnZlZ4dVhHNGdJRjl5WlhOMWJXVkRjbVZoZEdVb1kzSnBkR1Z5YVdFcElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnY21WMGRYSnVJRzVsZHlCUWNtOXRhWE5sS0NoeVpYTnZiSFpsTENCeVpXcGxZM1FwSUQwK0lIdGNiaUFnSUNBZ0lHeGxkQ0J5WlhOMWJXVWdQU0JqY21sMFpYSnBZUzV5WlhOMWJXVTdYRzRnSUNBZ0lDQnNaWFFnYVc1cGRHbGhiRVJoZEdFZ1BTQmpjbWwwWlhKcFlTNXBibWwwYVdGc1JHRjBZU0I4ZkNCN2ZUdGNibHh1SUNBZ0lDQWdMeTlHVEU5WExVOVZWRG9nZEdocGN5QnRaWE56WVdkbElIZHBiR3dnWW1VZ2MyVnVkQ0IwYnlCMGFHVWdjblZ1ZEdsdFpTQnBibk4wWVc1alpTQnZaaUJUZVc1amFHVnlUV0Z1WVdkbGNpQXRQaUJmYjI1RGNtVmhkR1ZjYmlBZ0lDQWdJR3hsZENCeVpYRjFaWE4wVFhObklEMGdlMXh1SUNBZ0lDQWdJQ0IwZVhCbE9pQW5ZM0psWVhSbEp5d2dabkp2YlRvZ1gzUm9hWE11WDI5M2JtVnlMQ0IwYnpvZ1gzUm9hWE11WDNOMVlsVlNUQ3hjYmlBZ0lDQWdJQ0FnWW05a2VUb2dleUJ5WlhOMWJXVTZJSEpsYzNWdFpTQjlYRzRnSUNBZ0lDQjlPMXh1WEc0Z0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblczTjVibU5vWlhJZ0xTQmpjbVZoZEdWZE9pQW5MQ0JqY21sMFpYSnBZU3dnY21WeGRXVnpkRTF6WnlrN1hHNWNiaUFnSUNBZ0lISmxjWFZsYzNSTmMyY3VZbTlrZVM1MllXeDFaU0E5SUdsdWFYUnBZV3hFWVhSaE8xeHVJQ0FnSUNBZ2NtVnhkV1Z6ZEUxelp5NWliMlI1TG5aaGJIVmxMbkpsY0c5eWRHVnlJRDBnWDNSb2FYTXVYMjkzYm1WeU8xeHVYRzRnSUNBZ0lDQnBaaUFvWTNKcGRHVnlhV0V1Y0RKd0tTQnlaWEYxWlhOMFRYTm5MbUp2WkhrdWNESndJRDBnWTNKcGRHVnlhV0V1Y0RKd08xeHVJQ0FnSUNBZ2FXWWdLR055YVhSbGNtbGhMbk4wYjNKbEtTQnlaWEYxWlhOMFRYTm5MbUp2WkhrdWMzUnZjbVVnUFNCamNtbDBaWEpwWVM1emRHOXlaVHRjYmlBZ0lDQWdJR2xtSUNoamNtbDBaWEpwWVM1dlluTmxjblpsY25NcElISmxjWFZsYzNSTmMyY3VZbTlrZVM1aGRYUm9iM0pwYzJVZ1BTQmpjbWwwWlhKcFlTNXZZbk5sY25abGNuTTdYRzRnSUNBZ0lDQnBaaUFvWTNKcGRHVnlhV0V1YVdSbGJuUnBkSGtwSUhKbGNYVmxjM1JOYzJjdVltOWtlUzVwWkdWdWRHbDBlU0E5SUdOeWFYUmxjbWxoTG1sa1pXNTBhWFI1TzF4dVhHNGdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25XM041Ym1Ob1pYSWdMU0JqY21WaGRHVmRJQzBnY21WemRXMWxJRzFsYzNOaFoyVTZJQ2NzSUhKbGNYVmxjM1JOYzJjcE8xeHVYRzRnSUNBZ0lDQXZMM0psY1hWbGMzUWdZM0psWVhSbElIUnZJSFJvWlNCaGJHeHZZMkYwYVc5dUlITjVjM1JsYlM0Z1EyRnVJR0psSUhKbGFtVmpkR1ZrSUdKNUlIUm9aU0JRYjJ4cFkzbEZibWRwYm1VdVhHNGdJQ0FnSUNCZmRHaHBjeTVmWW5WekxuQnZjM1JOWlhOellXZGxLSEpsY1hWbGMzUk5jMmNzSUNoeVpYQnNlU2tnUFQ0Z2UxeHVJQ0FnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVzNONWJtTm9aWElnTFNCamNtVmhkR1ZkSUMwZ1kzSmxZWFJsTFhKbGMzVnRaV1F0Y21WemNHOXVjMlU2SUNjc0lISmxjR3g1S1R0Y2JpQWdJQ0FnSUNBZ2FXWWdLSEpsY0d4NUxtSnZaSGt1WTI5a1pTQTlQVDBnTWpBd0tTQjdYRzVjYmlBZ0lDQWdJQ0FnSUNCc1pYUWdiR2x6ZEU5bVVtVndiM0owWlhKeklEMGdjbVZ3YkhrdVltOWtlUzUyWVd4MVpUdGNibHh1SUNBZ0lDQWdJQ0FnSUdadmNpQW9iR1YwSUdsdVpHVjRJR2x1SUd4cGMzUlBabEpsY0c5eWRHVnljeWtnZTF4dVhHNGdJQ0FnSUNBZ0lDQWdJQ0JzWlhRZ1pHRjBZVTlpYW1WamRDQTlJR3hwYzNSUFpsSmxjRzl5ZEdWeWMxdHBibVJsZUYwN1hHNWNiaUFnSUNBZ0lDQWdJQ0FnSUM4dmNtVndiM0owWlhJZ1kzSmxZWFJwYjI0Z1lXTmpaWEIwWldSY2JpQWdJQ0FnSUNBZ0lDQWdJR3hsZENCdlltcFZVa3dnUFNCa1lYUmhUMkpxWldOMExuSmxjMjkxY21ObE8xeHVJQ0FnSUNBZ0lDQWdJQ0FnYkdWMElITmphR1Z0WVNBOUlHUmhkR0ZQWW1wbFkzUXVjMk5vWlcxaE8xeHVJQ0FnSUNBZ0lDQWdJQ0FnYkdWMElITjBZWFIxY3lBOUlHUmhkR0ZQWW1wbFkzUXVjM1JoZEhWeklIeDhJQ2R2YmljN1hHNGdJQ0FnSUNBZ0lDQWdJQ0JzWlhRZ1kyaHBiR1J5Wlc1U1pYTnZkWEpqWlhNZ1BTQmtZWFJoVDJKcVpXTjBMbU5vYVd4a2NtVnVVbVZ6YjNWeVkyVnpPMXh1WEc0Z0lDQWdJQ0FnSUNBZ0lDQXZMeUJwYm1sMGFXRnNSR0YwWVM1amFHbHNaSEpsYm5NZ1BTQmtaV1Z3UTJ4dmJtVW9aR0YwWVU5aWFtVmpkQzVqYUdsc1pISmxibk1wSUh4OElIdDlPMXh1SUNBZ0lDQWdJQ0FnSUNBZ0x5OGdhVzVwZEdsaGJFUmhkR0VnUFNCa1pXVndRMnh2Ym1Vb1pHRjBZVTlpYW1WamRDNWtZWFJoS1NCOGZDQjdmVHRjYmlBZ0lDQWdJQ0FnSUNBZ0lHeGxkQ0JwYm1sMElEMGdaR1ZsY0VOc2IyNWxLR1JoZEdGUFltcGxZM1F1WkdGMFlTa2dmSHdnZTMwN1hHNGdJQ0FnSUNBZ0lDQWdJQ0JzWlhRZ1kyaHBiR1J5Wlc1eklEMGdaR1ZsY0VOc2IyNWxLR1JoZEdGUFltcGxZM1F1WTJocGJHUnlaVzV6S1NCOGZDQjdmVHRjYmx4dUlDQWdJQ0FnSUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvSjF0emVXNWphR1Z5SUMwZ1kzSmxZWFJsWFNBdElHTnlaV0YwWlMxeVpYTjFiV1ZrTFdSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2ljc0lHOWlhbFZTVEN3Z2MzUmhkSFZ6TENCcGJtbDBLVHRjYmx4dUlDQWdJQ0FnSUNBZ0lDQWdiR1YwSUc1bGQwOWlhaUE5SUc1bGR5QkVZWFJoVDJKcVpXTjBVbVZ3YjNKMFpYSW9YM1JvYVhNc0lHOWlhbFZTVEN3Z2MyTm9aVzFoTENCemRHRjBkWE1zSUdsdWFYUXNJR05vYVd4a2NtVnVVbVZ6YjNWeVkyVnpMQ0JtWVd4elpTd2dkSEoxWlNrN1hHNGdJQ0FnSUNBZ0lDQWdJQ0J1WlhkUFltb3VjbVZ6ZFcxbFEyaHBiR1J5Wlc1ektHTm9hV3hrY21WdWN5azdYRzRnSUNBZ0lDQWdJQ0FnSUNCZmRHaHBjeTVmY21Wd2IzSjBaWEp6VzI5aWFsVlNURjBnUFNCdVpYZFBZbW83WEc1Y2JpQWdJQ0FnSUNBZ0lDQjlYRzVjYmlBZ0lDQWdJQ0FnSUNCeVpYTnZiSFpsS0Y5MGFHbHpMbDl5WlhCdmNuUmxjbk1wTzF4dUlDQWdJQ0FnSUNBZ0lHbG1JQ2gwYUdsekxsOXZibEpsY0c5eWRHVnljMUpsYzNWdFpTa2dkR2hwY3k1ZmIyNVNaWEJ2Y25SbGNuTlNaWE4xYldVb2RHaHBjeTVmY21Wd2IzSjBaWEp6S1R0Y2JseHVJQ0FnSUNBZ0lDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ0lDQWdJQzh2Y21Wd2IzSjBaWElnWTNKbFlYUnBiMjRnY21WcVpXTjBaV1JjYmlBZ0lDQWdJQ0FnSUNCeVpXcGxZM1FvY21Wd2JIa3VZbTlrZVM1a1pYTmpLVHRjYmlBZ0lDQWdJQ0FnZlZ4dUlDQWdJQ0FnZlNrN1hHNGdJQ0FnZlNrN1hHNGdJSDFjYmx4dUlDQmZjM1ZpYzJOeWFXSmxLR055YVhSbGNtbGhLU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lISmxkSFZ5YmlCdVpYY2dVSEp2YldselpTZ29jbVZ6YjJ4MlpTd2djbVZxWldOMEtTQTlQaUI3WEc1Y2JpQWdJQ0FnSUM4dlJreFBWeTFQVlZRNklIUm9hWE1nYldWemMyRm5aU0IzYVd4c0lHSmxJSE5sYm5RZ2RHOGdkR2hsSUhKMWJuUnBiV1VnYVc1emRHRnVZMlVnYjJZZ1UzbHVZMmhsY2sxaGJtRm5aWElnTFQ0Z1gyOXVURzlqWVd4VGRXSnpZM0pwWW1WY2JpQWdJQ0FnSUd4bGRDQnpkV0p6WTNKcFltVk5jMmNnUFNCN1hHNGdJQ0FnSUNBZ0lIUjVjR1U2SUNkemRXSnpZM0pwWW1VbkxDQm1jbTl0T2lCZmRHaHBjeTVmYjNkdVpYSXNJSFJ2T2lCZmRHaHBjeTVmYzNWaVZWSk1MRnh1SUNBZ0lDQWdJQ0JpYjJSNU9pQjdmVnh1SUNBZ0lDQWdmVHRjYmx4dUlDQWdJQ0FnTHk4Z1NIbHdaWEowZVNCeVpYRjFaWE4wSUhSdklHSmxJR0Z1SUU5aWMyVnlkbVZ5WEc0Z0lDQWdJQ0F2THlCb2RIUndjem92TDJkcGRHaDFZaTVqYjIwdmNtVlVTRWxPU3kxd2NtOXFaV04wTDNOd1pXTnpMMkpzYjJJdmJXRnpkR1Z5TDIxbGMzTmhaMlZ6TDJSaGRHRXRjM2x1WXkxdFpYTnpZV2RsY3k1dFpDTm9lWEJsY25SNUxYSmxjWFZsYzNRdGRHOHRZbVV0WVc0dGIySnpaWEoyWlhKY2JseHVJQ0FnSUNBZ0x5OGdVbVZ6ZFcxbElGTjFZbk5qY21sd2RHbHZibk1nWm05eUlIUm9aU0J6WVcxbElFaDVjR1Z5ZEhrZ1ZWSk1YRzRnSUNBZ0lDQXZMeUJvZEhSd2N6b3ZMMmRwZEdoMVlpNWpiMjB2Y21WVVNFbE9TeTF3Y205cVpXTjBMM053WldOekwySnNiMkl2YldGemRHVnlMMjFsYzNOaFoyVnpMMlJoZEdFdGMzbHVZeTF0WlhOellXZGxjeTV0WkNOeVpYTjFiV1V0YzNWaWMyTnlhWEIwYVc5dWN5MW1iM0l0ZEdobExYTmhiV1V0YUhsd1pYSjBlUzExY214Y2JseHVJQ0FnSUNBZ0x5OGdVbVZ6ZFcxbElGTjFZbk5qY21sd2RHbHZibk1nWm05eUlHRWdZMlZ5ZEdGcGJpQjFjMlZ5SUdGdVpDQmtZWFJoSUhOamFHVnRZU0JwYm1SbGNHVnVaR1Z1ZEd4NUlHOW1JSFJvWlNCSWVYQmxjblI1SUZWU1RDNWNiaUFnSUNBZ0lDOHZJR2gwZEhCek9pOHZaMmwwYUhWaUxtTnZiUzl5WlZSSVNVNUxMWEJ5YjJwbFkzUXZjM0JsWTNNdllteHZZaTl0WVhOMFpYSXZiV1Z6YzJGblpYTXZaR0YwWVMxemVXNWpMVzFsYzNOaFoyVnpMbTFrSTNKbGMzVnRaUzF6ZFdKelkzSnBjSFJwYjI1ekxXWnZjaTFoTFdObGNuUmhhVzR0ZFhObGNpMWhibVF0WkdGMFlTMXpZMmhsYldFdGFXNWtaWEJsYm1SbGJuUnNlUzF2WmkxMGFHVXRhSGx3WlhKMGVTMTFjbXhjYmlBZ0lDQWdJR2xtSUNoamNtbDBaWEpwWVNrZ2UxeHVJQ0FnSUNBZ0lDQnBaaUFvWTNKcGRHVnlhV0V1YUdGelQzZHVVSEp2Y0dWeWRIa29KM0F5Y0NjcEtTQnpkV0p6WTNKcFltVk5jMmN1WW05a2VTNXdNbkFnUFNCamNtbDBaWEpwWVM1d01uQTdYRzRnSUNBZ0lDQWdJR2xtSUNoamNtbDBaWEpwWVM1b1lYTlBkMjVRY205d1pYSjBlU2duYzNSdmNtVW5LU2tnYzNWaWMyTnlhV0psVFhObkxtSnZaSGt1YzNSdmNtVWdQU0JqY21sMFpYSnBZUzV6ZEc5eVpUdGNiaUFnSUNBZ0lDQWdhV1lnS0dOeWFYUmxjbWxoTG1oaGMwOTNibEJ5YjNCbGNuUjVLQ2R6WTJobGJXRW5LU2tnYzNWaWMyTnlhV0psVFhObkxtSnZaSGt1YzJOb1pXMWhJRDBnWTNKcGRHVnlhV0V1YzJOb1pXMWhPMXh1SUNBZ0lDQWdJQ0JwWmlBb1kzSnBkR1Z5YVdFdWFHRnpUM2R1VUhKdmNHVnlkSGtvSjJsa1pXNTBhWFI1SnlrcElITjFZbk5qY21saVpVMXpaeTVpYjJSNUxtbGtaVzUwYVhSNUlEMGdZM0pwZEdWeWFXRXVhV1JsYm5ScGRIazdYRzRnSUNBZ0lDQWdJR2xtSUNoamNtbDBaWEpwWVM1b1lYTlBkMjVRY205d1pYSjBlU2duY21WemIzVnlZMlVuS1NrZ2MzVmljMk55YVdKbFRYTm5MbUp2WkhrdWNtVnpiM1Z5WTJVZ1BTQmpjbWwwWlhKcFlTNXlaWE52ZFhKalpUdGNiaUFnSUNBZ0lIMWNibHh1SUNBZ0lDQWdjM1ZpYzJOeWFXSmxUWE5uTG1KdlpIa3VjbVZ6ZFcxbElEMGdZM0pwZEdWeWFXRXVjbVZ6ZFcxbE8xeHVYRzRnSUNBZ0lDQXZMMVJQUkU4NklFWnZjaUJHZFhKMGFHVnlJRk4wZFdSNVhHNGdJQ0FnSUNCc1pYUWdiWFYwZFdGc1FYVjBhR1Z1ZEdsallYUnBiMjRnUFNCamNtbDBaWEpwWVM1dGRYUjFZV3c3WEc0Z0lDQWdJQ0JwWmlBb1kzSnBkR1Z5YVdFdWFHRnpUM2R1VUhKdmNHVnlkSGtvSjIxMWRIVmhiQ2NwS1NCemRXSnpZM0pwWW1WTmMyY3VZbTlrZVM1dGRYUjFZV3hCZFhSb1pXNTBhV05oZEdsdmJpQTlJRzExZEhWaGJFRjFkR2hsYm5ScFkyRjBhVzl1TzF4dVhHNGdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25XM041Ym1Ob1pYSmRJQzBnYzNWaWMyTnlhV0psSUcxbGMzTmhaMlU2SUNjc0lHTnlhWFJsY21saExDQnpkV0p6WTNKcFltVk5jMmNwTzF4dVhHNGdJQ0FnSUNBdkwzSmxjWFZsYzNRZ2MzVmljMk55YVhCMGFXOXVYRzRnSUNBZ0lDQXZMMUJ5YjNacGMybHZibUZzSUdSaGRHRWdhWE1nWVhCd2JHbGxaQ0IwYnlCMGFHVWdSR0YwWVU5aWFtVmpkRTlpYzJWeWRtVnlJR0ZtZEdWeUlHTnZibVpwY20xaGRHbHZiaTRnVDNJZ1pHbHpZMkZ5WkdWa0lHbG1JSFJvWlhKbElHbHpJRzV2SUdOdmJtWnBjbTFoZEdsdmJpNWNiaUFnSUNBZ0lDOHZabTl5SUcxdmNtVWdhVzVtYnlCelpXVWdkR2hsSUVSaGRHRlFjbTkyYVhOcGIyNWhiQ0JqYkdGemN5QmtiMk4xYldWdWRHRjBhVzl1TGx4dUlDQWdJQ0FnWDNSb2FYTXVYMkoxY3k1d2IzTjBUV1Z6YzJGblpTaHpkV0p6WTNKcFltVk5jMmNzSUNoeVpYQnNlU2tnUFQ0Z2UxeHVJQ0FnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVzNONWJtTm9aWEpkSUMwZ2MzVmljMk55YVdKbExYSmxjM0J2Ym5ObE9pQW5MQ0J5WlhCc2VTazdYRzVjYmlBZ0lDQWdJQ0FnYkdWMElITmphR1Z0WVNBOUlISmxjR3g1TG1KdlpIa3VjMk5vWlcxaE8xeHVJQ0FnSUNBZ0lDQnNaWFFnYjJKcVZWSk1JRDBnY21Wd2JIa3VZbTlrZVM1eVpYTnZkWEpqWlR0Y2JseHVJQ0FnSUNBZ0lDQnNaWFFnYm1WM1VISnZkbWx6YVc5dVlXd2dQU0JmZEdocGN5NWZjSEp2ZG1semFXOXVZV3h6VzI5aWFsVlNURjA3WEc0Z0lDQWdJQ0FnSUdSbGJHVjBaU0JmZEdocGN5NWZjSEp2ZG1semFXOXVZV3h6VzI5aWFsVlNURjA3WEc0Z0lDQWdJQ0FnSUdsbUlDaHVaWGRRY205MmFYTnBiMjVoYkNrZ2JtVjNVSEp2ZG1semFXOXVZV3d1WDNKbGJHVmhjMlZNYVhOMFpXNWxjbk1vS1R0Y2JseHVJQ0FnSUNBZ0lDQnBaaUFvY21Wd2JIa3VZbTlrZVM1amIyUmxJRHdnTWpBd0tTQjdYRzRnSUNBZ0lDQWdJQ0FnWTI5dWMyOXNaUzVzYjJjb0oxdHplVzVqYUdWeVhTQXRJRzVsZHlCRVlYUmhVSEp2ZG1semFXOXVZV3c2SUNjc0lISmxjR3g1TG1KdlpIa3VZMmhwYkdSeVpXNVNaWE52ZFhKalpYTXNJRzlpYWxWU1RDazdYRzRnSUNBZ0lDQWdJQ0FnYm1WM1VISnZkbWx6YVc5dVlXd2dQU0J1WlhjZ1JHRjBZVkJ5YjNacGMybHZibUZzS0Y5MGFHbHpMbDl2ZDI1bGNpd2diMkpxVlZKTUxDQmZkR2hwY3k1ZlluVnpMQ0J5WlhCc2VTNWliMlI1TG1Ob2FXeGtjbVZ1VW1WemIzVnlZMlZ6S1R0Y2JpQWdJQ0FnSUNBZ0lDQmZkR2hwY3k1ZmNISnZkbWx6YVc5dVlXeHpXMjlpYWxWU1RGMGdQU0J1WlhkUWNtOTJhWE5wYjI1aGJEdGNiaUFnSUNBZ0lDQWdmU0JsYkhObElHbG1JQ2h5WlhCc2VTNWliMlI1TG1OdlpHVWdQVDA5SURJd01Da2dlMXh1SUNBZ0lDQWdJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZGJjM2x1WTJobGNsMGdMU0J1WlhjZ1JHRjBZU0JQWW1wbFkzUWdUMkp6WlhKMlpYSTZJQ2NzSUhKbGNHeDVMQ0JmZEdocGN5NWZjSEp2ZG1semFXOXVZV3h6S1R0Y2JseHVJQ0FnSUNBZ0lDQWdJR3hsZENCcGJtbDBhV0ZzUkdGMFlTQTlJSEpsY0d4NUxtSnZaSGt1ZG1Gc2RXVTdYRzRnSUNBZ0lDQWdJQ0FnYVdZZ0tDRnBibWwwYVdGc1JHRjBZUzVvWVhOUGQyNVFjbTl3WlhKMGVTZ25ZMmhwYkdSeVpXNXpKeWtwSUhzZ2FXNXBkR2xoYkVSaGRHRXVZMmhwYkdSeVpXNXpJRDBnZTMwN0lIMWNiaUFnSUNBZ0lDQWdJQ0JwWmlBb0lXbHVhWFJwWVd4RVlYUmhMbWhoYzA5M2JsQnliM0JsY25SNUtDZGtZWFJoSnlrcElIc2dhVzVwZEdsaGJFUmhkR0V1WkdGMFlTQTlJSHQ5T3lCOVhHNWNiaUFnSUNBZ0lDQWdJQ0F2TDFSUFJFODZJRzExZEhWaGJFRjFkR2hsYm5ScFkyRjBhVzl1SUVadmNpQkdkWEowYUdWeUlGTjBkV1I1WEc0Z0lDQWdJQ0FnSUNBZ2JHVjBJRzVsZDA5aWFpQTlJRzVsZHlCRVlYUmhUMkpxWldOMFQySnpaWEoyWlhJb1gzUm9hWE1zSUc5aWFsVlNUQ3dnYzJOb1pXMWhMQ0FuYjI0bkxDQnBibWwwYVdGc1JHRjBZU3dnYm1WM1VISnZkbWx6YVc5dVlXd3VZMmhwYkdSeVpXNHNJSEpsY0d4NUxtSnZaSGt1ZG1WeWMybHZiaXdnYlhWMGRXRnNRWFYwYUdWdWRHbGpZWFJwYjI0cE8xeHVJQ0FnSUNBZ0lDQWdJRjkwYUdsekxsOXZZbk5sY25abGNuTmJiMkpxVlZKTVhTQTlJRzVsZDA5aWFqdGNibHh1SUNBZ0lDQWdJQ0FnSUhKbGMyOXNkbVVvYm1WM1QySnFLVHRjYmlBZ0lDQWdJQ0FnSUNCdVpYZFFjbTkyYVhOcGIyNWhiQzVoY0hCc2VTaHVaWGRQWW1vcE8xeHVJQ0FnSUNBZ0lDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ0lDQWdJSEpsYW1WamRDaHlaWEJzZVM1aWIyUjVMbVJsYzJNcE8xeHVJQ0FnSUNBZ0lDQjlYRzRnSUNBZ0lDQjlLVHRjYmlBZ0lDQjlLVHRjYmlBZ2ZWeHVYRzRnSUY5eVpYTjFiV1ZUZFdKelkzSnBZbVVvWTNKcGRHVnlhV0VwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdjbVYwZFhKdUlHNWxkeUJRY205dGFYTmxLQ2h5WlhOdmJIWmxMQ0J5WldwbFkzUXBJRDArSUh0Y2JseHVJQ0FnSUNBZ0x5OUdURTlYTFU5VlZEb2dkR2hwY3lCdFpYTnpZV2RsSUhkcGJHd2dZbVVnYzJWdWRDQjBieUIwYUdVZ2NuVnVkR2x0WlNCcGJuTjBZVzVqWlNCdlppQlRlVzVqYUdWeVRXRnVZV2RsY2lBdFBpQmZiMjVNYjJOaGJGTjFZbk5qY21saVpWeHVJQ0FnSUNBZ2JHVjBJSE4xWW5OamNtbGlaVTF6WnlBOUlIdGNiaUFnSUNBZ0lDQWdkSGx3WlRvZ0ozTjFZbk5qY21saVpTY3NJR1p5YjIwNklGOTBhR2x6TGw5dmQyNWxjaXdnZEc4NklGOTBhR2x6TGw5emRXSlZVa3dzWEc0Z0lDQWdJQ0FnSUdKdlpIazZJSHQ5WEc0Z0lDQWdJQ0I5TzF4dVhHNGdJQ0FnSUNBdkx5QkllWEJsY25SNUlISmxjWFZsYzNRZ2RHOGdZbVVnWVc0Z1QySnpaWEoyWlhKY2JpQWdJQ0FnSUM4dklHaDBkSEJ6T2k4dloybDBhSFZpTG1OdmJTOXlaVlJJU1U1TExYQnliMnBsWTNRdmMzQmxZM012WW14dllpOXRZWE4wWlhJdmJXVnpjMkZuWlhNdlpHRjBZUzF6ZVc1akxXMWxjM05oWjJWekxtMWtJMmg1Y0dWeWRIa3RjbVZ4ZFdWemRDMTBieTFpWlMxaGJpMXZZbk5sY25abGNseHVYRzRnSUNBZ0lDQXZMeUJTWlhOMWJXVWdVM1ZpYzJOeWFYQjBhVzl1Y3lCbWIzSWdkR2hsSUhOaGJXVWdTSGx3WlhKMGVTQlZVa3hjYmlBZ0lDQWdJQzh2SUdoMGRIQnpPaTh2WjJsMGFIVmlMbU52YlM5eVpWUklTVTVMTFhCeWIycGxZM1F2YzNCbFkzTXZZbXh2WWk5dFlYTjBaWEl2YldWemMyRm5aWE12WkdGMFlTMXplVzVqTFcxbGMzTmhaMlZ6TG0xa0kzSmxjM1Z0WlMxemRXSnpZM0pwY0hScGIyNXpMV1p2Y2kxMGFHVXRjMkZ0WlMxb2VYQmxjblI1TFhWeWJGeHVYRzRnSUNBZ0lDQXZMeUJTWlhOMWJXVWdVM1ZpYzJOeWFYQjBhVzl1Y3lCbWIzSWdZU0JqWlhKMFlXbHVJSFZ6WlhJZ1lXNWtJR1JoZEdFZ2MyTm9aVzFoSUdsdVpHVndaVzVrWlc1MGJIa2diMllnZEdobElFaDVjR1Z5ZEhrZ1ZWSk1MbHh1SUNBZ0lDQWdMeThnYUhSMGNITTZMeTluYVhSb2RXSXVZMjl0TDNKbFZFaEpUa3N0Y0hKdmFtVmpkQzl6Y0dWamN5OWliRzlpTDIxaGMzUmxjaTl0WlhOellXZGxjeTlrWVhSaExYTjVibU10YldWemMyRm5aWE11YldRamNtVnpkVzFsTFhOMVluTmpjbWx3ZEdsdmJuTXRabTl5TFdFdFkyVnlkR0ZwYmkxMWMyVnlMV0Z1WkMxa1lYUmhMWE5qYUdWdFlTMXBibVJsY0dWdVpHVnVkR3g1TFc5bUxYUm9aUzFvZVhCbGNuUjVMWFZ5YkZ4dUlDQWdJQ0FnYVdZZ0tHTnlhWFJsY21saEtTQjdYRzRnSUNBZ0lDQWdJR2xtSUNoamNtbDBaWEpwWVM1b1lYTlBkMjVRY205d1pYSjBlU2duY0RKd0p5a3BJSE4xWW5OamNtbGlaVTF6Wnk1aWIyUjVMbkF5Y0NBOUlHTnlhWFJsY21saExuQXljRHRjYmlBZ0lDQWdJQ0FnYVdZZ0tHTnlhWFJsY21saExtaGhjMDkzYmxCeWIzQmxjblI1S0NkemRHOXlaU2NwS1NCemRXSnpZM0pwWW1WTmMyY3VZbTlrZVM1emRHOXlaU0E5SUdOeWFYUmxjbWxoTG5OMGIzSmxPMXh1SUNBZ0lDQWdJQ0JwWmlBb1kzSnBkR1Z5YVdFdWFHRnpUM2R1VUhKdmNHVnlkSGtvSjNOamFHVnRZU2NwS1NCemRXSnpZM0pwWW1WTmMyY3VZbTlrZVM1elkyaGxiV0VnUFNCamNtbDBaWEpwWVM1elkyaGxiV0U3WEc0Z0lDQWdJQ0FnSUdsbUlDaGpjbWwwWlhKcFlTNW9ZWE5QZDI1UWNtOXdaWEowZVNnbmFXUmxiblJwZEhrbktTa2djM1ZpYzJOeWFXSmxUWE5uTG1KdlpIa3VhV1JsYm5ScGRIa2dQU0JqY21sMFpYSnBZUzVwWkdWdWRHbDBlVHRjYmlBZ0lDQWdJQ0FnYVdZZ0tHTnlhWFJsY21saExtaGhjMDkzYmxCeWIzQmxjblI1S0NkeVpYTnZkWEpqWlNjcEtTQnpkV0p6WTNKcFltVk5jMmN1WW05a2VTNXlaWE52ZFhKalpTQTlJR055YVhSbGNtbGhMbkpsYzI5MWNtTmxPMXh1SUNBZ0lDQWdmVnh1WEc0Z0lDQWdJQ0J6ZFdKelkzSnBZbVZOYzJjdVltOWtlUzV5WlhOMWJXVWdQU0JqY21sMFpYSnBZUzV5WlhOMWJXVTdYRzVjYmlBZ0lDQWdJQzh2VkU5RVR6b2dSbTl5SUVaMWNuUm9aWElnVTNSMVpIbGNiaUFnSUNBZ0lHeGxkQ0J0ZFhSMVlXeEJkWFJvWlc1MGFXTmhkR2x2YmlBOUlHTnlhWFJsY21saExtMTFkSFZoYkR0Y2JpQWdJQ0FnSUdsbUlDaGpjbWwwWlhKcFlTNW9ZWE5QZDI1UWNtOXdaWEowZVNnbmJYVjBkV0ZzSnlrcElITjFZbk5qY21saVpVMXpaeTVpYjJSNUxtMTFkSFZoYkVGMWRHaGxiblJwWTJGMGFXOXVJRDBnYlhWMGRXRnNRWFYwYUdWdWRHbGpZWFJwYjI0N1hHNWNiaUFnSUNBZ0lHTnZibk52YkdVdWJHOW5LQ2RiYzNsdVkyaGxjbDBnTFNCemRXSnpZM0pwWW1VZ2JXVnpjMkZuWlRvZ0p5d2dZM0pwZEdWeWFXRXNJSE4xWW5OamNtbGlaVTF6WnlrN1hHNWNiaUFnSUNBZ0lDOHZjbVZ4ZFdWemRDQnpkV0p6WTNKcGNIUnBiMjVjYmlBZ0lDQWdJQzh2VUhKdmRtbHphVzl1WVd3Z1pHRjBZU0JwY3lCaGNIQnNhV1ZrSUhSdklIUm9aU0JFWVhSaFQySnFaV04wVDJKelpYSjJaWElnWVdaMFpYSWdZMjl1Wm1seWJXRjBhVzl1TGlCUGNpQmthWE5qWVhKa1pXUWdhV1lnZEdobGNtVWdhWE1nYm04Z1kyOXVabWx5YldGMGFXOXVMbHh1SUNBZ0lDQWdMeTltYjNJZ2JXOXlaU0JwYm1adklITmxaU0IwYUdVZ1JHRjBZVkJ5YjNacGMybHZibUZzSUdOc1lYTnpJR1J2WTNWdFpXNTBZWFJwYjI0dVhHNGdJQ0FnSUNCZmRHaHBjeTVmWW5WekxuQnZjM1JOWlhOellXZGxLSE4xWW5OamNtbGlaVTF6Wnl3Z0tISmxjR3g1S1NBOVBpQjdYRzRnSUNBZ0lDQWdJR052Ym5OdmJHVXViRzluS0NkYmMzbHVZMmhsY2wwZ0xTQnpkV0p6WTNKcFltVXRjbVZ6ZFcxbFpDMXlaWE53YjI1elpUb2dKeXdnY21Wd2JIa3BPMXh1WEc0Z0lDQWdJQ0FnSUd4bGRDQnZZbXBWVWt3Z1BTQnlaWEJzZVM1aWIyUjVMbkpsYzI5MWNtTmxPMXh1WEc0Z0lDQWdJQ0FnSUd4bGRDQnVaWGRRY205MmFYTnBiMjVoYkNBOUlGOTBhR2x6TGw5d2NtOTJhWE5wYjI1aGJITmJiMkpxVlZKTVhUdGNiaUFnSUNBZ0lDQWdaR1ZzWlhSbElGOTBhR2x6TGw5d2NtOTJhWE5wYjI1aGJITmJiMkpxVlZKTVhUdGNiaUFnSUNBZ0lDQWdhV1lnS0c1bGQxQnliM1pwYzJsdmJtRnNLU0J1WlhkUWNtOTJhWE5wYjI1aGJDNWZjbVZzWldGelpVeHBjM1JsYm1WeWN5Z3BPMXh1WEc0Z0lDQWdJQ0FnSUdsbUlDaHlaWEJzZVM1aWIyUjVMbU52WkdVZ1BDQXlNREFwSUh0Y2JseHVJQ0FnSUNBZ0lDQWdJR052Ym5OdmJHVXViRzluS0NkYmMzbHVZMmhsY2wwZ0xTQnlaWE4xYldVZ2JtVjNJRVJoZEdGUWNtOTJhWE5wYjI1aGJEb2dKeXdnY21Wd2JIa3NJRzlpYWxWU1RDazdYRzRnSUNBZ0lDQWdJQ0FnYm1WM1VISnZkbWx6YVc5dVlXd2dQU0J1WlhjZ1JHRjBZVkJ5YjNacGMybHZibUZzS0Y5MGFHbHpMbDl2ZDI1bGNpd2diMkpxVlZKTUxDQmZkR2hwY3k1ZlluVnpMQ0J5WlhCc2VTNWliMlI1TG1Ob2FXeGtjbVZ1VW1WemIzVnlZMlZ6S1R0Y2JpQWdJQ0FnSUNBZ0lDQmZkR2hwY3k1ZmNISnZkbWx6YVc5dVlXeHpXMjlpYWxWU1RGMGdQU0J1WlhkUWNtOTJhWE5wYjI1aGJEdGNibHh1SUNBZ0lDQWdJQ0I5SUdWc2MyVWdhV1lnS0hKbGNHeDVMbUp2WkhrdVkyOWtaU0E5UFQwZ01qQXdLU0I3WEc1Y2JpQWdJQ0FnSUNBZ0lDQnNaWFFnYkdsemRFOW1UMkp6WlhKMlpYSnpJRDBnY21Wd2JIa3VZbTlrZVM1MllXeDFaVHRjYmx4dUlDQWdJQ0FnSUNBZ0lHWnZjaUFvYkdWMElHbHVaR1Y0SUdsdUlHeHBjM1JQWms5aWMyVnlkbVZ5Y3lrZ2UxeHVYRzRnSUNBZ0lDQWdJQ0FnSUNCc1pYUWdaR0YwWVU5aWFtVmpkQ0E5SUd4cGMzUlBaazlpYzJWeWRtVnljMXRwYm1SbGVGMDdYRzRnSUNBZ0lDQWdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25XM041Ym1Ob1pYSmRJQzBnVW1WemRXMWxJRTlpYW1WamRDQlBZbk5sY25abGNqb2dKeXdnY21Wd2JIa3NJR1JoZEdGUFltcGxZM1FzSUY5MGFHbHpMbDl3Y205MmFYTnBiMjVoYkhNcE8xeHVYRzRnSUNBZ0lDQWdJQ0FnSUNCc1pYUWdjMk5vWlcxaElEMGdaR0YwWVU5aWFtVmpkQzV6WTJobGJXRTdYRzRnSUNBZ0lDQWdJQ0FnSUNCc1pYUWdjM1JoZEhWeklEMGdaR0YwWVU5aWFtVmpkQzV6ZEdGMGRYTWdmSHdnSjI5dUp6dGNiaUFnSUNBZ0lDQWdJQ0FnSUd4bGRDQnZZbXBWVWt3Z1BTQmtZWFJoVDJKcVpXTjBMbkpsYzI5MWNtTmxPMXh1SUNBZ0lDQWdJQ0FnSUNBZ2JHVjBJSFpsY25OcGIyNGdQU0JrWVhSaFQySnFaV04wTG5abGNuTnBiMjRnZkh3Z01EdGNiaUFnSUNBZ0lDQWdJQ0FnSUd4bGRDQmphR2xzWkhKbGJsSmxjMjkxY21ObGN5QTlJR1JoZEdGUFltcGxZM1F1WTJocGJHUnlaVzVTWlhOdmRYSmpaWE03WEc1Y2JpQWdJQ0FnSUNBZ0lDQWdJR3hsZENCcGJtbDBhV0ZzUkdGMFlTQTlJSHQ5TzF4dUlDQWdJQ0FnSUNBZ0lDQWdhVzVwZEdsaGJFUmhkR0V1WTJocGJHUnlaVzV6SUQwZ1pHVmxjRU5zYjI1bEtHUmhkR0ZQWW1wbFkzUXVZMmhwYkdSeVpXNXpLU0I4ZkNCN2ZUdGNiaUFnSUNBZ0lDQWdJQ0FnSUdsdWFYUnBZV3hFWVhSaExtUmhkR0VnUFNCa1pXVndRMnh2Ym1Vb1pHRjBZVTlpYW1WamRDNWtZWFJoS1NCOGZDQjdmVHRjYmx4dVhHNGdJQ0FnSUNBZ0lDQWdJQ0F2TDFSUFJFODZJRzExZEhWaGJFRjFkR2hsYm5ScFkyRjBhVzl1SUVadmNpQkdkWEowYUdWeUlGTjBkV1I1WEc0Z0lDQWdJQ0FnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVzNONWJtTm9aWElnTFNCeVpYTjFiV1VnYzNWaWMyTnlhV0psWFNBdElHTnlaV0YwWlNCdVpYY2daR0YwWVU5aWFtVmpkRG9nSnl3Z2MzUmhkSFZ6TENCcGJtbDBhV0ZzUkdGMFlTd2dZMmhwYkdSeVpXNVNaWE52ZFhKalpYTXNJSFpsY25OcGIyNHBPMXh1SUNBZ0lDQWdJQ0FnSUNBZ2JHVjBJRzVsZDA5aWFpQTlJRzVsZHlCRVlYUmhUMkpxWldOMFQySnpaWEoyWlhJb1gzUm9hWE1zSUc5aWFsVlNUQ3dnYzJOb1pXMWhMQ0J6ZEdGMGRYTXNJR2x1YVhScFlXeEVZWFJoTENCamFHbHNaSEpsYmxKbGMyOTFjbU5sY3l3Z2RtVnljMmx2Yml3Z2JYVjBkV0ZzUVhWMGFHVnVkR2xqWVhScGIyNHNJSFJ5ZFdVcE8xeHVYRzRnSUNBZ0lDQWdJQ0FnSUNCZmRHaHBjeTVmYjJKelpYSjJaWEp6VzI5aWFsVlNURjBnUFNCdVpYZFBZbW83WEc1Y2JpQWdJQ0FnSUNBZ0lDQWdJRjkwYUdsekxsOXdjbTkyYVhOcGIyNWhiSE5iYjJKcVZWSk1YUzVoY0hCc2VTaHVaWGRQWW1vcE8xeHVJQ0FnSUNBZ0lDQWdJSDFjYmx4dUlDQWdJQ0FnSUNBZ0lISmxjMjlzZG1Vb1gzUm9hWE11WDI5aWMyVnlkbVZ5Y3lrN1hHNWNiaUFnSUNBZ0lDQWdJQ0JwWmlBb2RHaHBjeTVmYjI1UFluTmxjblpsY25OU1pYTjFiV1VwSUhSb2FYTXVYMjl1VDJKelpYSjJaWEp6VW1WemRXMWxLRjkwYUdsekxsOXZZbk5sY25abGNuTXBPMXh1WEc0Z0lDQWdJQ0FnSUgwZ1pXeHpaU0I3WEc0Z0lDQWdJQ0FnSUNBZ2NtVnFaV04wS0hKbGNHeDVMbUp2WkhrdVpHVnpZeWs3WEc0Z0lDQWdJQ0FnSUgxY2JpQWdJQ0FnSUgwcE8xeHVJQ0FnSUgwcE8xeHVYRzRnSUgxY2JseHVJQ0F2TDBaTVQxY3RTVTQ2SUcxbGMzTmhaMlVnY21WalpXbDJaV1FnWm5KdmJTQmhJR3h2WTJGc0lISjFiblJwYldVZ1VtVndiM0owWlhKUFltcGxZM1FnTFQ0Z1gyOXVVbVZ0YjNSbFUzVmljMk55YVdKbFhHNGdJRjl2YmtadmNuZGhjbVFvYlhObktTQjdYRzRnSUNBZ2JHVjBJRjkwYUdseklEMGdkR2hwY3p0Y2JseHVJQ0FnSUd4bGRDQnlaWEJ2Y25SbGNpQTlJRjkwYUdsekxsOXlaWEJ2Y25SbGNuTmJiWE5uTG1KdlpIa3VkRzlkTzF4dUlDQWdJSEpsY0c5eWRHVnlMbDl2YmtadmNuZGhjbVFvYlhObktUdGNiaUFnZlZ4dVhHNGdJQzh2Umt4UFZ5MUpUam9nYldWemMyRm5aU0J5WldObGFYWmxaQ0JtY205dElHRWdjbVZ0YjNSbElGTjVibU5vWlhJZ0xUNGdZM0psWVhSbElDaDBhR2x6SUdseklHRmpkSFZoYkd4NUlHRnVJR2x1ZG1sMFlYUnBiMjRnZEc4Z2MzVmljMk55YVdKbEtWeHVJQ0JmYjI1U1pXMXZkR1ZEY21WaGRHVW9iWE5uS1NCN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmx4dUlDQWdMeTl5WlcxdmRtVWdYQ0l2YzNWaWMyTnlhWEIwYVc5dVhDSWdabkp2YlNCMGFHVWdWVkpNWEc0Z0lDQWdiR1YwSUhKbGMyOTFjbU5sSUQwZ2JYTm5MbVp5YjIwdWMyeHBZMlVvTUN3Z0xURXpLVHRjYmx4dUlDQWdJR3hsZENCbGRtVnVkQ0E5SUh0Y2JpQWdJQ0FnSUhSNWNHVTZJRzF6Wnk1MGVYQmxMRnh1SUNBZ0lDQWdabkp2YlRvZ2JYTm5MbUp2WkhrdWMyOTFjbU5sTEZ4dUlDQWdJQ0FnZFhKc09pQnlaWE52ZFhKalpTeGNiaUFnSUNBZ0lITmphR1Z0WVRvZ2JYTm5MbUp2WkhrdWMyTm9aVzFoTEZ4dUlDQWdJQ0FnZG1Gc2RXVTZJRzF6Wnk1aWIyUjVMblpoYkhWbExGeHVJQ0FnSUNBZ2FXUmxiblJwZEhrNklHMXpaeTVpYjJSNUxtbGtaVzUwYVhSNUxGeHVYRzRnSUNBZ0lDQmhZMnM2SUNoMGVYQmxLU0E5UGlCN1hHNGdJQ0FnSUNBZ0lHeGxkQ0JzVkhsd1pTQTlJREl3TUR0Y2JpQWdJQ0FnSUNBZ2FXWWdLSFI1Y0dVcElIdGNiaUFnSUNBZ0lDQWdJQ0JzVkhsd1pTQTlJSFI1Y0dVN1hHNGdJQ0FnSUNBZ0lIMWNibHh1SUNBZ0lDQWdJQzh2YzJWdVpDQmhZMnNnY21WemNHOXVjMlVnYldWemMyRm5aVnh1SUNBZ0lDQWdJQ0JmZEdocGN5NWZZblZ6TG5CdmMzUk5aWE56WVdkbEtIdGNiaUFnSUNBZ0lDQWdJQ0JwWkRvZ2JYTm5MbWxrTENCMGVYQmxPaUFuY21WemNHOXVjMlVuTENCbWNtOXRPaUJ0YzJjdWRHOHNJSFJ2T2lCdGMyY3Vabkp2YlN4Y2JpQWdJQ0FnSUNBZ0lDQmliMlI1T2lCN0lHTnZaR1U2SUd4VWVYQmxJSDFjYmlBZ0lDQWdJQ0FnZlNrN1hHNGdJQ0FnSUNCOVhHNGdJQ0FnZlR0Y2JseHVJQ0FnSUdsbUlDaGZkR2hwY3k1ZmIyNU9iM1JwWm1sallYUnBiMjVJWVc1a2JHVnlLU0I3WEc0Z0lDQWdJQ0JqYjI1emIyeGxMbWx1Wm04b0oxdFRlVzVqYUdWeVhTQk9UMVJKUmtsRFFWUkpUMDR0UlZaRlRsUTZJQ2NzSUdWMlpXNTBLVHRjYmlBZ0lDQWdJRjkwYUdsekxsOXZiazV2ZEdsbWFXTmhkR2x2YmtoaGJtUnNaWElvWlhabGJuUXBPMXh1SUNBZ0lIMWNiaUFnZlZ4dVhHNGdJQzh2Umt4UFZ5MUpUam9nYldWemMyRm5aU0J5WldObGFYWmxaQ0JtY205dElHRWdjbVZ0YjNSbElFUmhkR0ZQWW1wbFkzUlNaWEJ2Y25SbGNpQXRQaUJrWld4bGRHVmNiaUFnWDI5dVVtVnRiM1JsUkdWc1pYUmxLRzF6WnlrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQzh2Y21WdGIzWmxJRndpTDNOMVluTmpjbWx3ZEdsdmJsd2lJR1p5YjIwZ2RHaGxJRlZTVEZ4dUlDQWdJR3hsZENCeVpYTnZkWEpqWlNBOUlHMXpaeTVpYjJSNUxuSmxjMjkxY21ObE8xeHVYRzRnSUNBZ2JHVjBJRzlpYW1WamRDQTlJRjkwYUdsekxsOXZZbk5sY25abGNuTmJjbVZ6YjNWeVkyVmRPMXh1SUNBZ0lHbG1JQ2h2WW1wbFkzUXBJSHRjYmlBZ0lDQWdJR3hsZENCbGRtVnVkQ0E5SUh0Y2JpQWdJQ0FnSUNBZ2RIbHdaVG9nYlhObkxuUjVjR1VzWEc0Z0lDQWdJQ0FnSUhWeWJEb2djbVZ6YjNWeVkyVXNYRzRnSUNBZ0lDQWdJR2xrWlc1MGFYUjVPaUJ0YzJjdVltOWtlUzVwWkdWdWRHbDBlU3hjYmx4dUlDQWdJQ0FnSUNCaFkyczZJQ2gwZVhCbEtTQTlQaUI3WEc0Z0lDQWdJQ0FnSUNBZ2JHVjBJR3hVZVhCbElEMGdNakF3TzF4dUlDQWdJQ0FnSUNBZ0lHbG1JQ2gwZVhCbEtTQjdYRzRnSUNBZ0lDQWdJQ0FnSUNCc1ZIbHdaU0E5SUhSNWNHVTdYRzRnSUNBZ0lDQWdJQ0FnZlZ4dVhHNGdJQ0FnSUNBZ0lDQXZMMVJQUkU4NklHRnVlU0J2ZEdobGNpQmthV1ptWlhKbGJuUWdiM0IwYVc5dWN5Qm1iM0lnZEdobElISmxiR1ZoYzJVZ2NISnZZMlZ6Y3l3Z2JHbHJaU0JoWTJObGNIUWdZblYwSUc1dmNpQnlaV3hsWVhObElHeHZZMkZzUDF4dUlDQWdJQ0FnSUNBZ0lHbG1JQ2hzVkhsd1pTQTlQVDBnTWpBd0tTQjdYRzRnSUNBZ0lDQWdJQ0FnSUNCdlltcGxZM1F1WkdWc1pYUmxLQ2s3WEc0Z0lDQWdJQ0FnSUNBZ2ZWeHVYRzRnSUNBZ0lDQWdJQ0FnTHk5elpXNWtJR0ZqYXlCeVpYTndiMjV6WlNCdFpYTnpZV2RsWEc0Z0lDQWdJQ0FnSUNBZ1gzUm9hWE11WDJKMWN5NXdiM04wVFdWemMyRm5aU2g3WEc0Z0lDQWdJQ0FnSUNBZ0lDQnBaRG9nYlhObkxtbGtMQ0IwZVhCbE9pQW5jbVZ6Y0c5dWMyVW5MQ0JtY205dE9pQnRjMmN1ZEc4c0lIUnZPaUJ0YzJjdVpuSnZiU3hjYmlBZ0lDQWdJQ0FnSUNBZ0lHSnZaSGs2SUhzZ1kyOWtaVG9nYkZSNWNHVXNJSE52ZFhKalpUb2dYM1JvYVhNdVgyOTNibVZ5SUgxY2JpQWdJQ0FnSUNBZ0lDQjlLVHRjYmlBZ0lDQWdJQ0FnZlZ4dUlDQWdJQ0FnZlR0Y2JseHVJQ0FnSUNBZ2FXWWdLRjkwYUdsekxsOXZiazV2ZEdsbWFXTmhkR2x2YmtoaGJtUnNaWElwSUh0Y2JpQWdJQ0FnSUNBZ1kyOXVjMjlzWlM1c2IyY29KMDVQVkVsR1NVTkJWRWxQVGkxRlZrVk9WRG9nSnl3Z1pYWmxiblFwTzF4dUlDQWdJQ0FnSUNCZmRHaHBjeTVmYjI1T2IzUnBabWxqWVhScGIyNUlZVzVrYkdWeUtHVjJaVzUwS1R0Y2JpQWdJQ0FnSUgxY2JpQWdJQ0I5SUdWc2MyVWdlMXh1SUNBZ0lDQWdYM1JvYVhNdVgySjFjeTV3YjNOMFRXVnpjMkZuWlNoN1hHNGdJQ0FnSUNBZ0lHbGtPaUJ0YzJjdWFXUXNJSFI1Y0dVNklDZHlaWE53YjI1elpTY3NJR1p5YjIwNklHMXpaeTUwYnl3Z2RHODZJRzF6Wnk1bWNtOXRMRnh1SUNBZ0lDQWdJQ0JpYjJSNU9pQjdJR052WkdVNklEUXdOQ3dnYzI5MWNtTmxPaUJmZEdocGN5NWZiM2R1WlhJZ2ZWeHVJQ0FnSUNBZ2ZTazdYRzRnSUNBZ2ZWeHVJQ0I5WEc1Y2JpQWdMeW9xWEc0Z0lDb2dRMkZzYkdKaFkyc2djM2x6ZEdWdElIUnZJSFJ5YVdkblpYSWdkR2hsSUhKbGMzVnRaV1FnY21Wd2IzSjBaWEp6WEc0Z0lDb2dRSEJoY21GdElDQjdSblZ1WTNScGIyNTlJR05oYkd4aVlXTnJJQzBnWm5WdVkzUnBiMjRnWTJGc2JHSmhZMnNnZDJocFkyZ2dkMmxzYkNCaVpTQnBiblp2YTJWa1hHNGdJQ29nUUhKbGRIVnliaUI3VDJKcVpXTjBQRlZTVEN3Z1JHRjBZVTlpYW1WamRGSmxjRzl5ZEdWeVBuMGdVbVYwZFhKdUlHOXVaU0J2WW1wbFkzUWdkMmwwYUNCaGJHd2djbVZ6ZFcxbFpDQnlaWEJ2Y25SbGNuTTdYRzRnSUNvdlhHNGdJRzl1VW1Wd2IzSjBaWEp6VW1WemRXMWxLR05oYkd4aVlXTnJLU0I3WEc0Z0lDQWdkR2hwY3k1ZmIyNVNaWEJ2Y25SbGNuTlNaWE4xYldVZ1BTQmpZV3hzWW1GamF6dGNiaUFnZlZ4dVhHNGdJQzhxS2x4dUlDQXFJRU5oYkd4aVlXTnJJSE41YzNSbGJTQjBieUIwY21sbloyVnlJSFJvWlNCeVpYTjFiV1ZrSUc5aWMyVnlkbVZ5YzF4dUlDQXFJRUJ3WVhKaGJTQWdlMFoxYm1OMGFXOXVmU0JqWVd4c1ltRmpheUF0SUdaMWJtTjBhVzl1SUdOaGJHeGlZV05ySUhkb2FXTm9JSGRwYkd3Z1ltVWdhVzUyYjJ0bFpGeHVJQ0FxSUVCeVpYUjFjbTRnZTA5aWFtVmpkRHhWVWt3c0lFUmhkR0ZQWW1wbFkzUlBZbk5sY25abGNqNTlJRkpsZEhWeWJpQnZibVVnYjJKcVpXTjBJSGRwZEdnZ1lXeHNJSEpsYzNWdFpXUWdiMkp6WlhKMlpYSnpPMXh1SUNBcUwxeHVJQ0J2Yms5aWMyVnlkbVZ5YzFKbGMzVnRaU2hqWVd4c1ltRmpheWtnZTF4dUlDQWdJSFJvYVhNdVgyOXVUMkp6WlhKMlpYSnpVbVZ6ZFcxbElEMGdZMkZzYkdKaFkyczdYRzRnSUgxY2JseHVmVnh1WEc1bGVIQnZjblFnWkdWbVlYVnNkQ0JUZVc1amFHVnlPMXh1WEc1Y2JseHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSWdMeTljYmk4dklDNHZjM0pqTDNONWJtTm9aWEl2VTNsdVkyaGxjaTVxY3lJc0ltbHRjRzl5ZENCVGVXNWphR1Z5SUdaeWIyMGdKeTR2YzNsdVkyaGxjaTlUZVc1amFHVnlKenRjYm1sdGNHOXlkQ0JFWVhSaFQySnFaV04wVW1Wd2IzSjBaWElnWm5KdmJTQW5MaTl6ZVc1amFHVnlMMFJoZEdGUFltcGxZM1JTWlhCdmNuUmxjaWM3WEc1cGJYQnZjblFnUkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5SUdaeWIyMGdKeTR2YzNsdVkyaGxjaTlFWVhSaFQySnFaV04wVDJKelpYSjJaWEluTzF4dVhHNWxlSEJ2Y25RZ2UxTjVibU5vWlhJc0lFUmhkR0ZQWW1wbFkzUlNaWEJ2Y25SbGNpd2dSR0YwWVU5aWFtVmpkRTlpYzJWeWRtVnlmVHRjYmx4dVhHNWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNJQzh2WEc0dkx5QXVMM055WXk5VGVXNWphR1Z5TG1weklpd2lMeW9xWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZCVUlFbHViM1podzZmRG8yOGdaU0JUYVhOMFpXMWhjeUJUUVZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCSlRrVlRReTFKUkZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCUlZVOUNTVk1nVGtWVVYwOVNTMU1nVTB4Y2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1JsSkJWVTVJVDBaRlVpMUhSVk5GVEV4VFEwaEJSbFFnV2xWU0lFWlBSVkpFUlZKVlRrY2dSRVZTSUVGT1IwVlhRVTVFVkVWT0lFWlBVbE5EU0ZWT1J5QkZMbFpjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVDFKQlRrZEZJRk5CWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVSbGRYUnpZMmhsSUZSbGJHVnJiMjBnUVVkY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1FYQnBlbVZsWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZSRlEwaE9TVk5EU0VVZ1ZVNUpWa1ZTVTBsVVFWUWdRa1ZTVEVsT1hHNHFYRzRxSUV4cFkyVnVjMlZrSUhWdVpHVnlJSFJvWlNCQmNHRmphR1VnVEdsalpXNXpaU3dnVm1WeWMybHZiaUF5TGpBZ0tIUm9aU0JjSWt4cFkyVnVjMlZjSWlrN1hHNHFJSGx2ZFNCdFlYa2dibTkwSUhWelpTQjBhR2x6SUdacGJHVWdaWGhqWlhCMElHbHVJR052YlhCc2FXRnVZMlVnZDJsMGFDQjBhR1VnVEdsalpXNXpaUzVjYmlvZ1dXOTFJRzFoZVNCdlluUmhhVzRnWVNCamIzQjVJRzltSUhSb1pTQk1hV05sYm5ObElHRjBYRzRxWEc0cUlDQWdhSFIwY0RvdkwzZDNkeTVoY0dGamFHVXViM0puTDJ4cFkyVnVjMlZ6TDB4SlEwVk9VMFV0TWk0d1hHNHFYRzRxSUZWdWJHVnpjeUJ5WlhGMWFYSmxaQ0JpZVNCaGNIQnNhV05oWW14bElHeGhkeUJ2Y2lCaFozSmxaV1FnZEc4Z2FXNGdkM0pwZEdsdVp5d2djMjltZEhkaGNtVmNiaW9nWkdsemRISnBZblYwWldRZ2RXNWtaWElnZEdobElFeHBZMlZ1YzJVZ2FYTWdaR2x6ZEhKcFluVjBaV1FnYjI0Z1lXNGdYQ0pCVXlCSlUxd2lJRUpCVTBsVExGeHVLaUJYU1ZSSVQxVlVJRmRCVWxKQlRsUkpSVk1nVDFJZ1EwOU9SRWxVU1U5T1V5QlBSaUJCVGxrZ1MwbE9SQ3dnWldsMGFHVnlJR1Y0Y0hKbGMzTWdiM0lnYVcxd2JHbGxaQzVjYmlvZ1UyVmxJSFJvWlNCTWFXTmxibk5sSUdadmNpQjBhR1VnYzNCbFkybG1hV01nYkdGdVozVmhaMlVnWjI5MlpYSnVhVzVuSUhCbGNtMXBjM05wYjI1eklHRnVaRnh1S2lCc2FXMXBkR0YwYVc5dWN5QjFibVJsY2lCMGFHVWdUR2xqWlc1elpTNWNiaW9xTDF4dVhHNHZLaXBjYmlBcUlFQmhZMk5sYzNNZ2NISnBkbUYwWlZ4dUlDb2dWR2hwY3lCamJHRnpjeUJwY3lCeVpYTndiMjV6YVdKc1pTQm1iM0lnWTI5c2JHVmpkR2x1WnlCa1pXeDBZU0JqYUdGdVoyVnpJR2x1SUhKbGJXOTBaU0J2WW1wbFkzUnpMQ0JpWldadmNtVWdkR2hsSUhKbGMzQnZibk5sSUc5bUlITjFZbk5qY21sd2RHbHZiaUJ5WldGamFDQjBhR1VnYjJKelpYSjJaWEl1WEc0Z0tpQkpkQ2R6SUhWelpXUWdhVzRnVTNsdVkyaGxjaUF0UGlCemRXSnpZM0pwWW1VdUlGUm9aU0JtYkc5M0lHbHpJR1JsWm1sdVpXUWdZWE02WEc0Z0tpQXhMaUFvYjJKelpYSjJaWElwSUMwdGMzVmljMk55YVdKbExTMCtJQ2h5WlhCdmNuUmxjaWxjYmlBcUlESXVJQ2h2WW5ObGNuWmxjaWtnUEMwdFpHVnNkR0VnZFhCa1lYUmxjeTB0SUNoeVpYQnZjblJsY2lsY2JpQXFJRE11SUNodlluTmxjblpsY2lrZ1BDMHRjM1ZpYzJOeWFXSmxJSEpsYzNCdmJuTmxMUzBnS0hKbGNHOXlkR1Z5S1Z4dUlDb2dWR2hwY3lCdFpXRnVjeUIwYUdGMElIUm9aWEpsSUdOdmRXeGtJR0psSUdSbGJIUmhJSFZ3WkdGMFpYTWdkSEpoYm5ObVpYSnlaV1FnWW1WbWIzSmxJSFJvWlNCemRXSnpZM0pwY0hScGIyNGdZMjl1Wm1seWJXRjBhVzl1TGx4dUlDb2dVMmx1WTJVZ2RHaGxjbVVnYVhNZ2JtOGdSR0YwWVU5aWFtVmpkRTlpYzJWeWRtVnlJR0psWm05eVpTQjBhR1VnZFdKelkzSnBjSFJwYjI0Z1kyOXVabWx5YldGMGFXOXVMQ0IwYUdWeVpTQnphRzkxYkdRZ1ltVWdjMjl0WlNCdmRHaGxjaUJ2WW1wbFkzUWdZMjlzYkdWamRHbHVaeUIwYUdVZ2RYQmtZWFJsY3k1Y2JpQXFJRkJ5YjNacGMybHZibUZzSUdSaGRHRWdhWE1nWVhCd2JHbGxaQ0IwYnlCMGFHVWdSR0YwWVU5aWFtVmpkRTlpYzJWeWRtVnlJR0ZtZEdWeUlHTnZibVpwY20xaGRHbHZiaTRnVDNJZ1pHbHpZMkZ5WkdWa0lHbG1JSFJvWlhKbElHbHpJRzV2SUdOdmJtWnBjbTFoZEdsdmJpNWNiaUFxTDF4dVkyeGhjM01nUkdGMFlWQnliM1pwYzJsdmJtRnNJSHRjYmlBZ0x5b2djSEpwZG1GMFpWeHVJQ0JmWTJocGJHUnlaVzVNYVhOMFpXNWxjbk02SUZ0TmMyZE1hWE4wWlc1bGNsMWNiaUFnWDJ4cGMzUmxibVZ5T2lCTmMyZE1hWE4wWlc1bGNseHVYRzRnSUY5amFHRnVaMlZ6T2lCYlhWeHVJQ0FxTDF4dVhHNGdJR052Ym5OMGNuVmpkRzl5S0c5M2JtVnlMQ0IxY213c0lHSjFjeXdnWTJocGJHUnlaVzRwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdYM1JvYVhNdVgyOTNibVZ5SUQwZ2IzZHVaWEk3WEc0Z0lDQWdYM1JvYVhNdVgzVnliQ0E5SUhWeWJEdGNiaUFnSUNCZmRHaHBjeTVmWW5WeklEMGdZblZ6TzF4dUlDQWdJRjkwYUdsekxsOWphR2xzWkhKbGJpQTlJR05vYVd4a2NtVnVPMXh1WEc0Z0lDQWdYM1JvYVhNdVgyTm9ZVzVuWlhNZ1BTQmJYVHRjYmlBZ0lDQmZkR2hwY3k1ZllXeHNiMk5oZEdWTWFYTjBaVzVsY25Nb0tUdGNiaUFnZlZ4dVhHNGdJRjloYkd4dlkyRjBaVXhwYzNSbGJtVnljeWdwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdYM1JvYVhNdVgyeHBjM1JsYm1WeUlEMGdYM1JvYVhNdVgySjFjeTVoWkdSTWFYTjBaVzVsY2loZmRHaHBjeTVmZFhKc0xDQW9iWE5uS1NBOVBpQjdYRzRnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduUkdGMFlWQnliM1pwYzJsdmJtRnNMU2NnS3lCZmRHaHBjeTVmZFhKc0lDc2dKeTFTUTFZNklDY3NJRzF6WnlrN1hHNGdJQ0FnSUNCZmRHaHBjeTVmWTJoaGJtZGxjeTV3ZFhOb0tHMXpaeWs3WEc0Z0lDQWdmU2s3WEc1Y2JpQWdJQ0F2S2x4dUlDQWdJRjkwYUdsekxsOWphR2xzWkhKbGJreHBjM1JsYm1WeWN5QTlJRnRkTzF4dUlDQWdJR2xtSUNoZmRHaHBjeTVmWTJocGJHUnlaVzRwSUh0Y2JpQWdJQ0FnSUd4bGRDQmphR2xzWkVKaGMyVlZVa3dnUFNCMWNtd2dLeUFuTDJOb2FXeGtjbVZ1THljN1hHNGdJQ0FnSUNCZmRHaHBjeTVmWTJocGJHUnlaVzR1Wm05eVJXRmphQ2dvWTJocGJHUXBJRDArSUh0Y2JpQWdJQ0FnSUNBZ2JHVjBJR05vYVd4a1ZWSk1JRDBnWTJocGJHUkNZWE5sVlZKTUlDc2dZMmhwYkdRN1hHNGdJQ0FnSUNBZ0lHeGxkQ0JzYVhOMFpXNWxjaUE5SUY5MGFHbHpMbDlpZFhNdVlXUmtUR2x6ZEdWdVpYSW9ZMmhwYkdSVlVrd3NJQ2h0YzJjcElEMCtJSHRjYmlBZ0lDQWdJQ0FnSUNBdkwybG5ibTl5WlNCdGMyY2djMlZ1ZENCaWVTQm9hVzF6Wld4bVhHNGdJQ0FnSUNBZ0lDQWdhV1lnS0cxelp5NW1jbTl0SUNFOVBTQnZkMjVsY2lrZ2UxeHVJQ0FnSUNBZ0lDQWdJQ0FnWTI5dWMyOXNaUzVzYjJjb2JYTm5LVHRjYmlBZ0lDQWdJQ0FnSUNCOVhHNGdJQ0FnSUNBZ0lIMHBPMXh1WEc0Z0lDQWdJQ0FnSUY5MGFHbHpMbDlqYUdsc1pISmxia3hwYzNSbGJtVnljeTV3ZFhOb0tHeHBjM1JsYm1WeUtUdGNiaUFnSUNBZ0lIMHBPMXh1SUNBZ0lIMHFMMXh1SUNCOVhHNWNiaUFnWDNKbGJHVmhjMlZNYVhOMFpXNWxjbk1vS1NCN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmx4dUlDQWdJRjkwYUdsekxsOXNhWE4wWlc1bGNpNXlaVzF2ZG1Vb0tUdGNibHh1SUNBZ0lDOHFYM1JvYVhNdVgyTm9hV3hrY21WdVRHbHpkR1Z1WlhKekxtWnZja1ZoWTJnb0tHeHBjM1JsYm1WeUtTQTlQaUI3WEc0Z0lDQWdJQ0JzYVhOMFpXNWxjaTV5WlcxdmRtVW9LVHRjYmlBZ0lDQjlLVHNxTDF4dUlDQjlYRzVjYmlBZ1oyVjBJR05vYVd4a2NtVnVLQ2tnZXlCeVpYUjFjbTRnZEdocGN5NWZZMmhwYkdSeVpXNDdJSDFjYmx4dUlDQmhjSEJzZVNodlluTmxjblpsY2lrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc0Z0lDQWdYM1JvYVhNdVgyTm9ZVzVuWlhNdVptOXlSV0ZqYUNnb1kyaGhibWRsS1NBOVBpQjdYRzRnSUNBZ0lDQnZZbk5sY25abGNpNWZZMmhoYm1kbFQySnFaV04wS0c5aWMyVnlkbVZ5TGw5emVXNWpUMkpxTENCamFHRnVaMlVwTzF4dUlDQWdJSDBwTzF4dUlDQjlYRzU5WEc1Y2JtVjRjRzl5ZENCa1pXWmhkV3gwSUVSaGRHRlFjbTkyYVhOcGIyNWhiRHRjYmx4dVhHNWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNJQzh2WEc0dkx5QXVMM055WXk5emVXNWphR1Z5TDBSaGRHRlFjbTkyYVhOcGIyNWhiQzVxY3lJc0ltMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ2V5QmNJbVJsWm1GMWJIUmNJam9nY21WeGRXbHlaU2hjSW1OdmNtVXRhbk12YkdsaWNtRnllUzltYmk5dlltcGxZM1F2WVhOemFXZHVYQ0lwTENCZlgyVnpUVzlrZFd4bE9pQjBjblZsSUgwN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJKaFltVnNMWEoxYm5ScGJXVXZZMjl5WlMxcWN5OXZZbXBsWTNRdllYTnphV2R1TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeE5URmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SWl3aWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCN0lGd2laR1ZtWVhWc2RGd2lPaUJ5WlhGMWFYSmxLRndpWTI5eVpTMXFjeTlzYVdKeVlYSjVMMlp1TDI5aWFtVmpkQzluWlhRdGIzZHVMWEJ5YjNCbGNuUjVMV1JsYzJOeWFYQjBiM0pjSWlrc0lGOWZaWE5OYjJSMWJHVTZJSFJ5ZFdVZ2ZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlqYjNKbExXcHpMMjlpYW1WamRDOW5aWFF0YjNkdUxYQnliM0JsY25SNUxXUmxjMk55YVhCMGIzSXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJREUxTTF4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWlMQ0p5WlhGMWFYSmxLQ2N1TGk4dUxpOXRiMlIxYkdWekwyVnpOaTV2WW1wbFkzUXVZWE56YVdkdUp5azdYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJSEpsY1hWcGNtVW9KeTR1THk0dUwyMXZaSFZzWlhNdlgyTnZjbVVuS1M1UFltcGxZM1F1WVhOemFXZHVPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdlptNHZiMkpxWldOMEwyRnpjMmxuYmk1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01UVTRYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNJc0luSmxjWFZwY21Vb0p5NHVMeTR1TDIxdlpIVnNaWE12WlhNMkxtOWlhbVZqZEM1blpYUXRiM2R1TFhCeWIzQmxjblI1TFdSbGMyTnlhWEIwYjNJbktUdGNiblpoY2lBa1QySnFaV04wSUQwZ2NtVnhkV2x5WlNnbkxpNHZMaTR2Ylc5a2RXeGxjeTlmWTI5eVpTY3BMazlpYW1WamREdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNGdaMlYwVDNkdVVISnZjR1Z5ZEhsRVpYTmpjbWx3ZEc5eUtHbDBMQ0JyWlhrcGUxeHVJQ0J5WlhSMWNtNGdKRTlpYW1WamRDNW5aWFJQZDI1UWNtOXdaWEowZVVSbGMyTnlhWEIwYjNJb2FYUXNJR3RsZVNrN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdlptNHZiMkpxWldOMEwyZGxkQzF2ZDI0dGNISnZjR1Z5ZEhrdFpHVnpZM0pwY0hSdmNpNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVFl3WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DSXNJaWQxYzJVZ2MzUnlhV04wSnp0Y2JpOHZJREU1TGpFdU1pNHhJRTlpYW1WamRDNWhjM05wWjI0b2RHRnlaMlYwTENCemIzVnlZMlVzSUM0dUxpbGNiblpoY2lCblpYUkxaWGx6SUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMXJaWGx6SnlsY2JpQWdMQ0JuVDFCVElDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxbmIzQnpKeWxjYmlBZ0xDQndTVVVnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzF3YVdVbktWeHVJQ0FzSUhSdlQySnFaV04wSUQwZ2NtVnhkV2x5WlNnbkxpOWZkRzh0YjJKcVpXTjBKeWxjYmlBZ0xDQkpUMkpxWldOMElDQTlJSEpsY1hWcGNtVW9KeTR2WDJsdlltcGxZM1FuS1Z4dUlDQXNJQ1JoYzNOcFoyNGdJRDBnVDJKcVpXTjBMbUZ6YzJsbmJqdGNibHh1THk4Z2MyaHZkV3hrSUhkdmNtc2dkMmwwYUNCemVXMWliMnh6SUdGdVpDQnphRzkxYkdRZ2FHRjJaU0JrWlhSbGNtMXBibWx6ZEdsaklIQnliM0JsY25SNUlHOXlaR1Z5SUNoV09DQmlkV2NwWEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUNFa1lYTnphV2R1SUh4OElISmxjWFZwY21Vb0p5NHZYMlpoYVd4ekp5a29ablZ1WTNScGIyNG9LWHRjYmlBZ2RtRnlJRUVnUFNCN2ZWeHVJQ0FnSUN3Z1FpQTlJSHQ5WEc0Z0lDQWdMQ0JUSUQwZ1UzbHRZbTlzS0NsY2JpQWdJQ0FzSUVzZ1BTQW5ZV0pqWkdWbVoyaHBhbXRzYlc1dmNIRnljM1FuTzF4dUlDQkJXMU5kSUQwZ056dGNiaUFnU3k1emNHeHBkQ2duSnlrdVptOXlSV0ZqYUNobWRXNWpkR2x2YmlocktYc2dRbHRyWFNBOUlHczdJSDBwTzF4dUlDQnlaWFIxY200Z0pHRnpjMmxuYmloN2ZTd2dRU2xiVTEwZ0lUMGdOeUI4ZkNCUFltcGxZM1F1YTJWNWN5Z2tZWE56YVdkdUtIdDlMQ0JDS1NrdWFtOXBiaWduSnlrZ0lUMGdTenRjYm4wcElEOGdablZ1WTNScGIyNGdZWE56YVdkdUtIUmhjbWRsZEN3Z2MyOTFjbU5sS1hzZ0x5OGdaWE5zYVc1MExXUnBjMkZpYkdVdGJHbHVaU0J1YnkxMWJuVnpaV1F0ZG1GeWMxeHVJQ0IyWVhJZ1ZDQWdJQ0FnUFNCMGIwOWlhbVZqZENoMFlYSm5aWFFwWEc0Z0lDQWdMQ0JoVEdWdUlDQTlJR0Z5WjNWdFpXNTBjeTVzWlc1bmRHaGNiaUFnSUNBc0lHbHVaR1Y0SUQwZ01WeHVJQ0FnSUN3Z1oyVjBVM2x0WW05c2N5QTlJR2RQVUZNdVpseHVJQ0FnSUN3Z2FYTkZiblZ0SUNBZ0lDQTlJSEJKUlM1bU8xeHVJQ0IzYUdsc1pTaGhUR1Z1SUQ0Z2FXNWtaWGdwZTF4dUlDQWdJSFpoY2lCVElDQWdJQ0FnUFNCSlQySnFaV04wS0dGeVozVnRaVzUwYzF0cGJtUmxlQ3NyWFNsY2JpQWdJQ0FnSUN3Z2EyVjVjeUFnSUQwZ1oyVjBVM2x0WW05c2N5QS9JR2RsZEV0bGVYTW9VeWt1WTI5dVkyRjBLR2RsZEZONWJXSnZiSE1vVXlrcElEb2daMlYwUzJWNWN5aFRLVnh1SUNBZ0lDQWdMQ0JzWlc1bmRHZ2dQU0JyWlhsekxteGxibWQwYUZ4dUlDQWdJQ0FnTENCcUlDQWdJQ0FnUFNBd1hHNGdJQ0FnSUNBc0lHdGxlVHRjYmlBZ0lDQjNhR2xzWlNoc1pXNW5kR2dnUGlCcUtXbG1LR2x6Ulc1MWJTNWpZV3hzS0ZNc0lHdGxlU0E5SUd0bGVYTmJhaXNyWFNrcFZGdHJaWGxkSUQwZ1UxdHJaWGxkTzF4dUlDQjlJSEpsZEhWeWJpQlVPMXh1ZlNBNklDUmhjM05wWjI0N1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl2WW1wbFkzUXRZWE56YVdkdUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXhOakZjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lpd2lMeThnTVRrdU1TNHpMakVnVDJKcVpXTjBMbUZ6YzJsbmJpaDBZWEpuWlhRc0lITnZkWEpqWlNsY2JuWmhjaUFrWlhod2IzSjBJRDBnY21WeGRXbHlaU2duTGk5ZlpYaHdiM0owSnlrN1hHNWNiaVJsZUhCdmNuUW9KR1Y0Y0c5eWRDNVRJQ3NnSkdWNGNHOXlkQzVHTENBblQySnFaV04wSnl3Z2UyRnpjMmxuYmpvZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXRnpjMmxuYmljcGZTazdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDJWek5pNXZZbXBsWTNRdVlYTnphV2R1TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeE5qUmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SWl3aUx5OGdNVGt1TVM0eUxqWWdUMkpxWldOMExtZGxkRTkzYmxCeWIzQmxjblI1UkdWelkzSnBjSFJ2Y2loUExDQlFLVnh1ZG1GeUlIUnZTVTlpYW1WamRDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTkwYnkxcGIySnFaV04wSnlsY2JpQWdMQ0FrWjJWMFQzZHVVSEp2Y0dWeWRIbEVaWE5qY21sd2RHOXlJRDBnY21WeGRXbHlaU2duTGk5ZmIySnFaV04wTFdkdmNHUW5LUzVtTzF4dVhHNXlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRjMkZ3Snlrb0oyZGxkRTkzYmxCeWIzQmxjblI1UkdWelkzSnBjSFJ2Y2ljc0lHWjFibU4wYVc5dUtDbDdYRzRnSUhKbGRIVnliaUJtZFc1amRHbHZiaUJuWlhSUGQyNVFjbTl3WlhKMGVVUmxjMk55YVhCMGIzSW9hWFFzSUd0bGVTbDdYRzRnSUNBZ2NtVjBkWEp1SUNSblpYUlBkMjVRY205d1pYSjBlVVJsYzJOeWFYQjBiM0lvZEc5SlQySnFaV04wS0dsMEtTd2dhMlY1S1R0Y2JpQWdmVHRjYm4wcE8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlsY3pZdWIySnFaV04wTG1kbGRDMXZkMjR0Y0hKdmNHVnlkSGt0WkdWelkzSnBjSFJ2Y2k1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01UWTJYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNKZExDSnpiM1Z5WTJWU2IyOTBJam9pSW4wPQoKLyoqKi8gfSwKLyogMTc3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIHZlcnNpb246IDAuNS4xCgkvLyBkYXRlOiBUdWUgQXByIDExIDIwMTcgMTA6MTI6NDkgR01UKzAxMDAgKFdFU1QpCgkvLyBsaWNlbmNlOiAKCS8qKgoJKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKCSogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKCSogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCgkqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCgkqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoJKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCgkqIENvcHlyaWdodCAyMDE2IEFwaXplZQoJKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoJKgoJKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSoKCSogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSoKCSogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSoqLwoKCgkoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkgewoJCWlmKHRydWUpCgkJCW1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpOwoJCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCQlkZWZpbmUoIklkZW50aXR5RmFjdG9yeSIsIFtdLCBmYWN0b3J5KTsKCQllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JykKCQkJZXhwb3J0c1siSWRlbnRpdHlGYWN0b3J5Il0gPSBmYWN0b3J5KCk7CgkJZWxzZQoJCQlyb290WyIiXSA9IHJvb3RbIiJdIHx8IHt9LCByb290WyIiXVsiSWRlbnRpdHlGYWN0b3J5Il0gPSBmYWN0b3J5KCk7Cgl9KSh0aGlzLCBmdW5jdGlvbigpIHsKCXJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwCgkvKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQoJLyoqKioqKi8gCXZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uCgkvKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewoJLyoqKioqKi8KCS8qKioqKiovIAkJLy8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlCgkvKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQoJLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7CgkvKioqKioqLwoJLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQoJLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7CgkvKioqKioqLyAJCQlpOiBtb2R1bGVJZCwKCS8qKioqKiovIAkJCWw6IGZhbHNlLAoJLyoqKioqKi8gCQkJZXhwb3J0czoge30KCS8qKioqKiovIAkJfTsKCS8qKioqKiovCgkvKioqKioqLyAJCS8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbgoJLyoqKioqKi8gCQltb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKCS8qKioqKiovCgkvKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKCS8qKioqKiovIAkJbW9kdWxlLmwgPSB0cnVlOwoJLyoqKioqKi8KCS8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKCS8qKioqKiovIAkJcmV0dXJuIG1vZHVsZS5leHBvcnRzOwoJLyoqKioqKi8gCX0KCS8qKioqKiovCgkvKioqKioqLwoJLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlczsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKCS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0CgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5pID0gZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9OwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHMKCS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHsKCS8qKioqKiovIAkJaWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkgewoJLyoqKioqKi8gCQkJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsKCS8qKioqKiovIAkJCQljb25maWd1cmFibGU6IGZhbHNlLAoJLyoqKioqKi8gCQkJCWVudW1lcmFibGU6IHRydWUsCgkvKioqKioqLyAJCQkJZ2V0OiBnZXR0ZXIKCS8qKioqKiovIAkJCX0pOwoJLyoqKioqKi8gCQl9CgkvKioqKioqLyAJfTsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXMKCS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHsKCS8qKioqKiovIAkJdmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/CgkvKioqKioqLyAJCQlmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOgoJLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTsKCS8qKioqKiovIAkJX193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpOwoJLyoqKioqKi8gCQlyZXR1cm4gZ2V0dGVyOwoJLyoqKioqKi8gCX07CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbAoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gX193ZWJwYWNrX3B1YmxpY19wYXRoX18KCS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzCgkvKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMTM3KTsKCS8qKioqKiovIH0pCgkvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoJLyoqKioqKi8gKHsKCgkvKioqLyAxMjA6CgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLyoqCgkqIFRoZSBVc2VyUHJvZmlsZSBhY2NvcmRpbmcgdG8gVXNlciBJZGVudGl0eSBEYXRhIE1vZGVsCgkqLwoKCXZhciBVc2VyUHJvZmlsZSA9IGZ1bmN0aW9uIFVzZXJQcm9maWxlKHVzZXJuYW1lLCB1c2VyVVJMLCBhdmF0YXIsIGNuLCBsb2NhbGUpIHsKCSAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgVXNlclByb2ZpbGUpOwoKCgkgIGlmICh1c2VybmFtZSkgewoJICAgIHRoaXMudXNlcm5hbWUgPSB1c2VybmFtZTsKCSAgfQoJICBpZiAoYXZhdGFyKSB7CgkgICAgdGhpcy5hdmF0YXIgPSBhdmF0YXI7CgkgIH0KCSAgaWYgKGNuKSB7CgkgICAgdGhpcy5jbiA9IGNuOwoJICB9CgkgIGlmIChsb2NhbGUpIHsKCSAgICB0aGlzLmxvY2FsZSA9IGxvY2FsZTsKCSAgfQoJICBpZiAodXNlclVSTCkgewoJICAgIHRoaXMudXNlclVSTCA9IHVzZXJVUkw7CgkgIH0KCX07CgoJZXhwb3J0cy5kZWZhdWx0ID0gVXNlclByb2ZpbGU7Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbImRlZmF1bHQiXTsKCgkvKioqLyB9KSwKCgkvKioqLyAxMjg6CgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKCXZhciBfVXNlclByb2ZpbGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCk7CgoJdmFyIF9Vc2VyUHJvZmlsZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Vc2VyUHJvZmlsZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgl2YXIgTWVzc2FnZUJvZHlJZGVudGl0eSA9IGZ1bmN0aW9uIE1lc3NhZ2VCb2R5SWRlbnRpdHkodXNlcm5hbWUsIHVzZXJVUkwsIGF2YXRhciwgY24sIGxvY2FsZSwgaWRwLCBhc3NlcnRpb24pIHsKCSAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgTWVzc2FnZUJvZHlJZGVudGl0eSk7CgoKCSAgaWYgKCFpZHApIHRocm93IG5ldyBFcnJvcignSURQIHNob3VsZCBiZSBhIHBhcmFtZXRlcicpOwoJICBpZiAoIXVzZXJuYW1lKSB0aHJvdyBuZXcgRXJyb3IoJ3VzZXJuYW1lIHNob3VsZCBiZSBhIHBhcmFtZXRlcicpOwoKCSAgdGhpcy5pZHAgPSBpZHA7CgoJICBpZiAoYXNzZXJ0aW9uKSB7CgkgICAgdGhpcy5hc3NlcnRpb24gPSBhc3NlcnRpb247CgkgIH0KCSAgdGhpcy51c2VyUHJvZmlsZSA9IG5ldyBfVXNlclByb2ZpbGUyLmRlZmF1bHQodXNlcm5hbWUsIHVzZXJVUkwsIGF2YXRhciwgY24sIGxvY2FsZSk7Cgl9OyAvKioKCSAgICogVGhlIElkZW50aXR5IGluZm8gdG8gYmUgYWRkZWQgdG8gTWVzc2FnZS5Cb2R5LklkZW50aXR5CgkgICAqLwoKCWV4cG9ydHMuZGVmYXVsdCA9IE1lc3NhZ2VCb2R5SWRlbnRpdHk7Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9KSwKCgkvKioqLyAxMzc6CgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuVXNlclByb2ZpbGUgPSB1bmRlZmluZWQ7CgoJdmFyIF9Vc2VyUHJvZmlsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTIwKTsKCgl2YXIgX1VzZXJQcm9maWxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1VzZXJQcm9maWxlKTsKCgl2YXIgX01lc3NhZ2VCb2R5SWRlbnRpdHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyOCk7CgoJdmFyIF9NZXNzYWdlQm9keUlkZW50aXR5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX01lc3NhZ2VCb2R5SWRlbnRpdHkpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5Vc2VyUHJvZmlsZSA9IF9Vc2VyUHJvZmlsZTIuZGVmYXVsdDsKCWV4cG9ydHMuZGVmYXVsdCA9IF9NZXNzYWdlQm9keUlkZW50aXR5Mi5kZWZhdWx0OwoKCS8qKiovIH0pLAoKCS8qKiovIDg6CgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCWV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKCSAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKCSAgfQoJfTsKCgkvKioqLyB9KQoKCS8qKioqKiovIH0pOwoJfSk7CgkvLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtODtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSnpiM1Z5WTJWeklqcGJJbmRsWW5CaFkyczZMeTh2ZDJWaWNHRmpheTkxYm1sMlpYSnpZV3hOYjJSMWJHVkVaV1pwYm1sMGFXOXVQelZqWVRZcUtpb3FLaW9xS2lvaUxDSjNaV0p3WVdOck9pOHZMM2RsWW5CaFkyc3ZZbTl2ZEhOMGNtRndJREkwTVRBMFl6bG1NVFJsTURoak1EZ3dZall4UDJFMll6VXFLaW9xS2lvcUtpb2lMQ0ozWldKd1lXTnJPaTh2THk0dmMzSmpMMmxrWlc1MGFYUjVMMVZ6WlhKUWNtOW1hV3hsTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDNOeVl5OXBaR1Z1ZEdsMGVTOU5aWE56WVdkbFFtOWtlVWxrWlc1MGFYUjVMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMM055WXk5SlpHVnVkR2wwZVVaaFkzUnZjbmt1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMmhsYkhCbGNuTXZZMnhoYzNORFlXeHNRMmhsWTJzdWFuTS9NakZoWmlvcUtpb3FLaW9xS2lKZExDSnVZVzFsY3lJNld5SlZjMlZ5VUhKdlptbHNaU0lzSW5WelpYSnVZVzFsSWl3aWRYTmxjbFZTVENJc0ltRjJZWFJoY2lJc0ltTnVJaXdpYkc5allXeGxJaXdpVFdWemMyRm5aVUp2WkhsSlpHVnVkR2wwZVNJc0ltbGtjQ0lzSW1GemMyVnlkR2x2YmlJc0lrVnljbTl5SWl3aWRYTmxjbEJ5YjJacGJHVWlYU3dpYldGd2NHbHVaM01pT2lKQlFVRkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN3eVFrRkJNa0k3UVVGRE0wSXNRMEZCUXp0QlFVTkVMRTg3UVVOV1FUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJPenM3UVVGSFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN08wRkJSVUU3UVVGRFFTeHRSRUZCTWtNc1kwRkJZenM3UVVGRmVrUTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeGhRVUZMTzBGQlEwdzdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeHRRMEZCTWtJc01FSkJRVEJDTEVWQlFVVTdRVUZEZGtRc2VVTkJRV2xETEdWQlFXVTdRVUZEYUVRN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRXNPRVJCUVhORUxDdEVRVUVyUkRzN1FVRkZja2c3UVVGRFFUczdRVUZGUVR0QlFVTkJPenM3T3pzN096czdPenM3T3pzN096czdPenM3UVVOb1JVRTdPenM3U1VGTFRVRXNWeXhIUVVWS0xIRkNRVUZaUXl4UlFVRmFMRVZCUVhOQ1F5eFBRVUYwUWl4RlFVRXJRa01zVFVGQkwwSXNSVUZCZFVORExFVkJRWFpETEVWQlFUSkRReXhOUVVFelF5eEZRVUZ0UkR0QlFVRkJPenM3UVVGRmFrUXNUVUZCU1Vvc1VVRkJTaXhGUVVGak8wRkJRVVVzVTBGQlMwRXNVVUZCVEN4SFFVRm5Ra0VzVVVGQmFFSTdRVUZCTWtJN1FVRkRNME1zVFVGQlNVVXNUVUZCU2l4RlFVRlpPMEZCUVVVc1UwRkJTMEVzVFVGQlRDeEhRVUZqUVN4TlFVRmtPMEZCUVhWQ08wRkJRM0pETEUxQlFVbERMRVZCUVVvc1JVRkJVVHRCUVVGRkxGTkJRVXRCTEVWQlFVd3NSMEZCVlVFc1JVRkJWanRCUVVGbE8wRkJRM3BDTEUxQlFVbERMRTFCUVVvc1JVRkJXVHRCUVVGRkxGTkJRVXRCTEUxQlFVd3NSMEZCWTBFc1RVRkJaRHRCUVVGMVFqdEJRVU55UXl4TlFVRkpTQ3hQUVVGS0xFVkJRV0U3UVVGQlJTeFRRVUZMUVN4UFFVRk1MRWRCUVdWQkxFOUJRV1k3UVVGQmVVSTdRVUZGZWtNc1F6czdhMEpCUjFsR0xGYzdPenM3T3pzN096czdPenM3T3pzN096czdRVU5rWmpzN096czdPMGxCUlUxTkxHMUNMRWRCUlVvc05rSkJRVmxNTEZGQlFWb3NSVUZCYzBKRExFOUJRWFJDTEVWQlFTdENReXhOUVVFdlFpeEZRVUYxUTBNc1JVRkJka01zUlVGQk1rTkRMRTFCUVRORExFVkJRVzFFUlN4SFFVRnVSQ3hGUVVGM1JFTXNVMEZCZUVRc1JVRkJiVVU3UVVGQlFUczdPMEZCUldwRkxFMUJRVWtzUTBGQlEwUXNSMEZCVEN4RlFVRlZMRTFCUVUwc1NVRkJTVVVzUzBGQlNpeERRVUZWTERKQ1FVRldMRU5CUVU0N1FVRkRWaXhOUVVGSkxFTkJRVU5TTEZGQlFVd3NSVUZCWlN4TlFVRk5MRWxCUVVsUkxFdEJRVW9zUTBGQlZTeG5RMEZCVml4RFFVRk9PenRCUVVWbUxFOUJRVXRHTEVkQlFVd3NSMEZCVjBFc1IwRkJXRHM3UVVGRlFTeE5RVUZKUXl4VFFVRktMRVZCUVc5Q08wRkJRVVVzVTBGQlMwRXNVMEZCVEN4SFFVRnBRa0VzVTBGQmFrSTdRVUZCTmtJN1FVRkRia1FzVDBGQlMwVXNWMEZCVEN4SFFVRnRRaXd3UWtGQlowSlVMRkZCUVdoQ0xFVkJRVEJDUXl4UFFVRXhRaXhGUVVGdFEwTXNUVUZCYmtNc1JVRkJNa05ETEVWQlFUTkRMRVZCUVN0RFF5eE5RVUV2UXl4RFFVRnVRanRCUVVWRUxFTXNSVUZzUWtnN096czdhMEpCZFVKbFF5eHRRanM3T3pzN096czdPenM3T3pzN096dEJRM1pDWmpzN096dEJRVU5CT3pzN096czdVVUZGVTA0c1Z6czdPenM3T3pzN08wRkRTRlE3TzBGQlJVRTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEZJaXdpWm1sc1pTSTZJa2xrWlc1MGFYUjVSbUZqZEc5eWVTNXFjeUlzSW5OdmRYSmpaWE5EYjI1MFpXNTBJanBiSWlobWRXNWpkR2x2YmlCM1pXSndZV05yVlc1cGRtVnljMkZzVFc5a2RXeGxSR1ZtYVc1cGRHbHZiaWh5YjI5MExDQm1ZV04wYjNKNUtTQjdYRzVjZEdsbUtIUjVjR1Z2WmlCbGVIQnZjblJ6SUQwOVBTQW5iMkpxWldOMEp5QW1KaUIwZVhCbGIyWWdiVzlrZFd4bElEMDlQU0FuYjJKcVpXTjBKeWxjYmx4MFhIUnRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWmhZM1J2Y25rb0tUdGNibHgwWld4elpTQnBaaWgwZVhCbGIyWWdaR1ZtYVc1bElEMDlQU0FuWm5WdVkzUnBiMjRuSUNZbUlHUmxabWx1WlM1aGJXUXBYRzVjZEZ4MFpHVm1hVzVsS0Z3aVNXUmxiblJwZEhsR1lXTjBiM0o1WENJc0lGdGRMQ0JtWVdOMGIzSjVLVHRjYmx4MFpXeHpaU0JwWmloMGVYQmxiMllnWlhod2IzSjBjeUE5UFQwZ0oyOWlhbVZqZENjcFhHNWNkRngwWlhod2IzSjBjMXRjSWtsa1pXNTBhWFI1Um1GamRHOXllVndpWFNBOUlHWmhZM1J2Y25rb0tUdGNibHgwWld4elpWeHVYSFJjZEhKdmIzUmJYQ0pjSWwwZ1BTQnliMjkwVzF3aVhDSmRJSHg4SUh0OUxDQnliMjkwVzF3aVhDSmRXMXdpU1dSbGJuUnBkSGxHWVdOMGIzSjVYQ0pkSUQwZ1ptRmpkRzl5ZVNncE8xeHVmU2tvZEdocGN5d2dablZ1WTNScGIyNG9LU0I3WEc1eVpYUjFjbTRnWEc1Y2JseHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSWdMeTljYmk4dklIZGxZbkJoWTJzdmRXNXBkbVZ5YzJGc1RXOWtkV3hsUkdWbWFXNXBkR2x2YmlJc0lpQmNkQzh2SUZSb1pTQnRiMlIxYkdVZ1kyRmphR1ZjYmlCY2RIWmhjaUJwYm5OMFlXeHNaV1JOYjJSMWJHVnpJRDBnZTMwN1hHNWNiaUJjZEM4dklGUm9aU0J5WlhGMWFYSmxJR1oxYm1OMGFXOXVYRzRnWEhSbWRXNWpkR2x2YmlCZlgzZGxZbkJoWTJ0ZmNtVnhkV2x5WlY5ZktHMXZaSFZzWlVsa0tTQjdYRzVjYmlCY2RGeDBMeThnUTJobFkyc2dhV1lnYlc5a2RXeGxJR2x6SUdsdUlHTmhZMmhsWEc0Z1hIUmNkR2xtS0dsdWMzUmhiR3hsWkUxdlpIVnNaWE5iYlc5a2RXeGxTV1JkS1Z4dUlGeDBYSFJjZEhKbGRIVnliaUJwYm5OMFlXeHNaV1JOYjJSMWJHVnpXMjF2WkhWc1pVbGtYUzVsZUhCdmNuUnpPMXh1WEc0Z1hIUmNkQzh2SUVOeVpXRjBaU0JoSUc1bGR5QnRiMlIxYkdVZ0tHRnVaQ0J3ZFhRZ2FYUWdhVzUwYnlCMGFHVWdZMkZqYUdVcFhHNGdYSFJjZEhaaGNpQnRiMlIxYkdVZ1BTQnBibk4wWVd4c1pXUk5iMlIxYkdWelcyMXZaSFZzWlVsa1hTQTlJSHRjYmlCY2RGeDBYSFJwT2lCdGIyUjFiR1ZKWkN4Y2JpQmNkRngwWEhSc09pQm1ZV3h6WlN4Y2JpQmNkRngwWEhSbGVIQnZjblJ6T2lCN2ZWeHVJRngwWEhSOU8xeHVYRzRnWEhSY2RDOHZJRVY0WldOMWRHVWdkR2hsSUcxdlpIVnNaU0JtZFc1amRHbHZibHh1SUZ4MFhIUnRiMlIxYkdWelcyMXZaSFZzWlVsa1hTNWpZV3hzS0cxdlpIVnNaUzVsZUhCdmNuUnpMQ0J0YjJSMWJHVXNJRzF2WkhWc1pTNWxlSEJ2Y25SekxDQmZYM2RsWW5CaFkydGZjbVZ4ZFdseVpWOWZLVHRjYmx4dUlGeDBYSFF2THlCR2JHRm5JSFJvWlNCdGIyUjFiR1VnWVhNZ2JHOWhaR1ZrWEc0Z1hIUmNkRzF2WkhWc1pTNXNJRDBnZEhKMVpUdGNibHh1SUZ4MFhIUXZMeUJTWlhSMWNtNGdkR2hsSUdWNGNHOXlkSE1nYjJZZ2RHaGxJRzF2WkhWc1pWeHVJRngwWEhSeVpYUjFjbTRnYlc5a2RXeGxMbVY0Y0c5eWRITTdYRzRnWEhSOVhHNWNibHh1SUZ4MEx5OGdaWGh3YjNObElIUm9aU0J0YjJSMWJHVnpJRzlpYW1WamRDQW9YMTkzWldKd1lXTnJYMjF2WkhWc1pYTmZYeWxjYmlCY2RGOWZkMlZpY0dGamExOXlaWEYxYVhKbFgxOHViU0E5SUcxdlpIVnNaWE03WEc1Y2JpQmNkQzh2SUdWNGNHOXpaU0IwYUdVZ2JXOWtkV3hsSUdOaFkyaGxYRzRnWEhSZlgzZGxZbkJoWTJ0ZmNtVnhkV2x5WlY5ZkxtTWdQU0JwYm5OMFlXeHNaV1JOYjJSMWJHVnpPMXh1WEc0Z1hIUXZMeUJwWkdWdWRHbDBlU0JtZFc1amRHbHZiaUJtYjNJZ1kyRnNiR2x1WnlCb1lYSnRiMjU1SUdsdGNHOXlkSE1nZDJsMGFDQjBhR1VnWTI5eWNtVmpkQ0JqYjI1MFpYaDBYRzRnWEhSZlgzZGxZbkJoWTJ0ZmNtVnhkV2x5WlY5Zkxta2dQU0JtZFc1amRHbHZiaWgyWVd4MVpTa2dleUJ5WlhSMWNtNGdkbUZzZFdVN0lIMDdYRzVjYmlCY2RDOHZJR1JsWm1sdVpTQm5aWFIwWlhJZ1puVnVZM1JwYjI0Z1ptOXlJR2hoY20xdmJua2daWGh3YjNKMGMxeHVJRngwWDE5M1pXSndZV05yWDNKbGNYVnBjbVZmWHk1a0lEMGdablZ1WTNScGIyNG9aWGh3YjNKMGN5d2dibUZ0WlN3Z1oyVjBkR1Z5S1NCN1hHNGdYSFJjZEdsbUtDRmZYM2RsWW5CaFkydGZjbVZ4ZFdseVpWOWZMbThvWlhod2IzSjBjeXdnYm1GdFpTa3BJSHRjYmlCY2RGeDBYSFJQWW1wbFkzUXVaR1ZtYVc1bFVISnZjR1Z5ZEhrb1pYaHdiM0owY3l3Z2JtRnRaU3dnZTF4dUlGeDBYSFJjZEZ4MFkyOXVabWxuZFhKaFlteGxPaUJtWVd4elpTeGNiaUJjZEZ4MFhIUmNkR1Z1ZFcxbGNtRmliR1U2SUhSeWRXVXNYRzRnWEhSY2RGeDBYSFJuWlhRNklHZGxkSFJsY2x4dUlGeDBYSFJjZEgwcE8xeHVJRngwWEhSOVhHNGdYSFI5TzF4dVhHNGdYSFF2THlCblpYUkVaV1poZFd4MFJYaHdiM0owSUdaMWJtTjBhVzl1SUdadmNpQmpiMjF3WVhScFltbHNhWFI1SUhkcGRHZ2dibTl1TFdoaGNtMXZibmtnYlc5a2RXeGxjMXh1SUZ4MFgxOTNaV0p3WVdOclgzSmxjWFZwY21WZlh5NXVJRDBnWm5WdVkzUnBiMjRvYlc5a2RXeGxLU0I3WEc0Z1hIUmNkSFpoY2lCblpYUjBaWElnUFNCdGIyUjFiR1VnSmlZZ2JXOWtkV3hsTGw5ZlpYTk5iMlIxYkdVZ1AxeHVJRngwWEhSY2RHWjFibU4wYVc5dUlHZGxkRVJsWm1GMWJIUW9LU0I3SUhKbGRIVnliaUJ0YjJSMWJHVmJKMlJsWm1GMWJIUW5YVHNnZlNBNlhHNGdYSFJjZEZ4MFpuVnVZM1JwYjI0Z1oyVjBUVzlrZFd4bFJYaHdiM0owY3lncElIc2djbVYwZFhKdUlHMXZaSFZzWlRzZ2ZUdGNiaUJjZEZ4MFgxOTNaV0p3WVdOclgzSmxjWFZwY21WZlh5NWtLR2RsZEhSbGNpd2dKMkVuTENCblpYUjBaWElwTzF4dUlGeDBYSFJ5WlhSMWNtNGdaMlYwZEdWeU8xeHVJRngwZlR0Y2JseHVJRngwTHk4Z1QySnFaV04wTG5CeWIzUnZkSGx3WlM1b1lYTlBkMjVRY205d1pYSjBlUzVqWVd4c1hHNGdYSFJmWDNkbFluQmhZMnRmY21WeGRXbHlaVjlmTG04Z1BTQm1kVzVqZEdsdmJpaHZZbXBsWTNRc0lIQnliM0JsY25SNUtTQjdJSEpsZEhWeWJpQlBZbXBsWTNRdWNISnZkRzkwZVhCbExtaGhjMDkzYmxCeWIzQmxjblI1TG1OaGJHd29iMkpxWldOMExDQndjbTl3WlhKMGVTazdJSDA3WEc1Y2JpQmNkQzh2SUY5ZmQyVmljR0ZqYTE5d2RXSnNhV05mY0dGMGFGOWZYRzRnWEhSZlgzZGxZbkJoWTJ0ZmNtVnhkV2x5WlY5ZkxuQWdQU0JjSWx3aU8xeHVYRzRnWEhRdkx5Qk1iMkZrSUdWdWRISjVJRzF2WkhWc1pTQmhibVFnY21WMGRYSnVJR1Y0Y0c5eWRITmNiaUJjZEhKbGRIVnliaUJmWDNkbFluQmhZMnRmY21WeGRXbHlaVjlmS0Y5ZmQyVmljR0ZqYTE5eVpYRjFhWEpsWDE4dWN5QTlJREV6TnlrN1hHNWNibHh1WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWlBdkwxeHVMeThnZDJWaWNHRmpheTlpYjI5MGMzUnlZWEFnTWpReE1EUmpPV1l4TkdVd09HTXdPREJpTmpFaUxDSXZLaXBjYmlvZ1ZHaGxJRlZ6WlhKUWNtOW1hV3hsSUdGalkyOXlaR2x1WnlCMGJ5QlZjMlZ5SUVsa1pXNTBhWFI1SUVSaGRHRWdUVzlrWld4Y2Jpb3ZYRzVjYmx4dVkyeGhjM01nVlhObGNsQnliMlpwYkdVZ2UxeHVYRzRnSUdOdmJuTjBjblZqZEc5eUtIVnpaWEp1WVcxbExDQjFjMlZ5VlZKTUxDQmhkbUYwWVhJc0lHTnVMQ0JzYjJOaGJHVXBJSHRjYmx4dUlDQWdJR2xtSUNoMWMyVnlibUZ0WlNrZ2V5QjBhR2x6TG5WelpYSnVZVzFsSUQwZ2RYTmxjbTVoYldVN0lIMWNiaUFnSUNCcFppQW9ZWFpoZEdGeUtTQjdJSFJvYVhNdVlYWmhkR0Z5SUQwZ1lYWmhkR0Z5T3lCOVhHNGdJQ0FnYVdZZ0tHTnVLU0I3SUhSb2FYTXVZMjRnUFNCamJqc2dmVnh1SUNBZ0lHbG1JQ2hzYjJOaGJHVXBJSHNnZEdocGN5NXNiMk5oYkdVZ1BTQnNiMk5oYkdVN0lIMWNiaUFnSUNCcFppQW9kWE5sY2xWU1RDa2dleUIwYUdsekxuVnpaWEpWVWt3Z1BTQjFjMlZ5VlZKTU95QjlYRzVjYmlBZ2ZWeHVmVnh1WEc1bGVIQnZjblFnWkdWbVlYVnNkQ0JWYzJWeVVISnZabWxzWlR0Y2JseHVYRzVjYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTSUM4dlhHNHZMeUF1TDNOeVl5OXBaR1Z1ZEdsMGVTOVZjMlZ5VUhKdlptbHNaUzVxY3lJc0lpOHFLbHh1S2lCVWFHVWdTV1JsYm5ScGRIa2dhVzVtYnlCMGJ5QmlaU0JoWkdSbFpDQjBieUJOWlhOellXZGxMa0p2WkhrdVNXUmxiblJwZEhsY2Jpb3ZYRzVjYm1sdGNHOXlkQ0JWYzJWeVVISnZabWxzWlNCbWNtOXRJQ2N1TDFWelpYSlFjbTltYVd4bEp6dGNibHh1WTJ4aGMzTWdUV1Z6YzJGblpVSnZaSGxKWkdWdWRHbDBlU0I3WEc1Y2JpQWdZMjl1YzNSeWRXTjBiM0lvZFhObGNtNWhiV1VzSUhWelpYSlZVa3dzSUdGMllYUmhjaXdnWTI0c0lHeHZZMkZzWlN3Z2FXUndMQ0JoYzNObGNuUnBiMjRwSUh0Y2JseHVJQ0FnSUdsbUlDZ2hhV1J3S1NCMGFISnZkeUJ1WlhjZ1JYSnliM0lvSjBsRVVDQnphRzkxYkdRZ1ltVWdZU0J3WVhKaGJXVjBaWEluS1R0Y2JpQWdJQ0JwWmlBb0lYVnpaWEp1WVcxbEtTQjBhSEp2ZHlCdVpYY2dSWEp5YjNJb0ozVnpaWEp1WVcxbElITm9iM1ZzWkNCaVpTQmhJSEJoY21GdFpYUmxjaWNwTzF4dVhHNGdJQ0FnZEdocGN5NXBaSEFnUFNCcFpIQTdYRzVjYmlBZ0lDQnBaaUFvWVhOelpYSjBhVzl1S1NBZ0lDQWdJSHNnZEdocGN5NWhjM05sY25ScGIyNGdQU0JoYzNObGNuUnBiMjQ3SUgxY2JpQWdJQ0IwYUdsekxuVnpaWEpRY205bWFXeGxJRDBnYm1WM0lGVnpaWEpRY205bWFXeGxLSFZ6WlhKdVlXMWxMQ0IxYzJWeVZWSk1MQ0JoZG1GMFlYSXNJR051TENCc2IyTmhiR1VwTzF4dVhHNGdJSDFjYmx4dWZWeHVYRzVjYm1WNGNHOXlkQ0JrWldaaGRXeDBJRTFsYzNOaFoyVkNiMlI1U1dSbGJuUnBkSGs3WEc1Y2JseHVYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVaUF2TDF4dUx5OGdMaTl6Y21NdmFXUmxiblJwZEhrdlRXVnpjMkZuWlVKdlpIbEpaR1Z1ZEdsMGVTNXFjeUlzSW1sdGNHOXlkQ0JWYzJWeVVISnZabWxzWlNCbWNtOXRJQ2N1TDJsa1pXNTBhWFI1TDFWelpYSlFjbTltYVd4bEp6dGNibWx0Y0c5eWRDQk5aWE56WVdkbFFtOWtlVWxrWlc1MGFYUjVJR1p5YjIwZ0p5NHZhV1JsYm5ScGRIa3ZUV1Z6YzJGblpVSnZaSGxKWkdWdWRHbDBlU2M3WEc1Y2JtVjRjRzl5ZENCN0lGVnpaWEpRY205bWFXeGxJSDA3WEc1bGVIQnZjblFnWkdWbVlYVnNkQ0JOWlhOellXZGxRbTlrZVVsa1pXNTBhWFI1TzF4dVhHNWNibHh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVklnTHk5Y2JpOHZJQzR2YzNKakwwbGtaVzUwYVhSNVJtRmpkRzl5ZVM1cWN5SXNJbHdpZFhObElITjBjbWxqZEZ3aU8xeHVYRzVsZUhCdmNuUnpMbDlmWlhOTmIyUjFiR1VnUFNCMGNuVmxPMXh1WEc1bGVIQnZjblJ6TG1SbFptRjFiSFFnUFNCbWRXNWpkR2x2YmlBb2FXNXpkR0Z1WTJVc0lFTnZibk4wY25WamRHOXlLU0I3WEc0Z0lHbG1JQ2doS0dsdWMzUmhibU5sSUdsdWMzUmhibU5sYjJZZ1EyOXVjM1J5ZFdOMGIzSXBLU0I3WEc0Z0lDQWdkR2h5YjNjZ2JtVjNJRlI1Y0dWRmNuSnZjaWhjSWtOaGJtNXZkQ0JqWVd4c0lHRWdZMnhoYzNNZ1lYTWdZU0JtZFc1amRHbHZibHdpS1R0Y2JpQWdmVnh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOW9aV3h3WlhKekwyTnNZWE56UTJGc2JFTm9aV05yTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBNFhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVnTmlBM0lEZ2dPU0F4TUNKZExDSnpiM1Z5WTJWU2IyOTBJam9pSW4wPQoKLyoqKi8gfQovKioqKioqLyBdKQp9KTsKOw==",
      "sourceCodeClassname": "SlackProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-38b3da70-28d4-8082-38f1-b1709f6ee7694",
    "version": 3.900000000000002,
    "description": "Description of SlackProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "slack.slack.com",
    "configuration": {},
    "messageSchemas": "",
    "dataObjects": [],
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": {
      "browser": true
    },
    "interworking": true
  },
  "IMSIWProtoStub": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuCi8vCi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwovLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQKLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCi8vIGZvbGxvd2luZyBjb25kaXRpb25zOgovLwovLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAovLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KLy8KLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgovLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOCi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAovLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRQovLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKZnVuY3Rpb24gRXZlbnRFbWl0dGVyKCkgewogIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fTsKICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkOwp9Cm1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyOwoKLy8gQmFja3dhcmRzLWNvbXBhdCB3aXRoIG5vZGUgMC4xMC54CkV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7CgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLl9ldmVudHMgPSB1bmRlZmluZWQ7CkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDsKCi8vIEJ5IGRlZmF1bHQgRXZlbnRFbWl0dGVycyB3aWxsIHByaW50IGEgd2FybmluZyBpZiBtb3JlIHRoYW4gMTAgbGlzdGVuZXJzIGFyZQovLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLgpFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycyA9IDEwOwoKLy8gT2J2aW91c2x5IG5vdCBhbGwgRW1pdHRlcnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gMTAuIFRoaXMgZnVuY3Rpb24gYWxsb3dzCi8vIHRoYXQgdG8gYmUgaW5jcmVhc2VkLiBTZXQgdG8gemVybyBmb3IgdW5saW1pdGVkLgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLnNldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uKG4pIHsKICBpZiAoIWlzTnVtYmVyKG4pIHx8IG4gPCAwIHx8IGlzTmFOKG4pKQogICAgdGhyb3cgVHlwZUVycm9yKCduIG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXInKTsKICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSBuOwogIHJldHVybiB0aGlzOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24odHlwZSkgewogIHZhciBlciwgaGFuZGxlciwgbGVuLCBhcmdzLCBpLCBsaXN0ZW5lcnM7CgogIGlmICghdGhpcy5fZXZlbnRzKQogICAgdGhpcy5fZXZlbnRzID0ge307CgogIC8vIElmIHRoZXJlIGlzIG5vICdlcnJvcicgZXZlbnQgbGlzdGVuZXIgdGhlbiB0aHJvdy4KICBpZiAodHlwZSA9PT0gJ2Vycm9yJykgewogICAgaWYgKCF0aGlzLl9ldmVudHMuZXJyb3IgfHwKICAgICAgICAoaXNPYmplY3QodGhpcy5fZXZlbnRzLmVycm9yKSAmJiAhdGhpcy5fZXZlbnRzLmVycm9yLmxlbmd0aCkpIHsKICAgICAgZXIgPSBhcmd1bWVudHNbMV07CiAgICAgIGlmIChlciBpbnN0YW5jZW9mIEVycm9yKSB7CiAgICAgICAgdGhyb3cgZXI7IC8vIFVuaGFuZGxlZCAnZXJyb3InIGV2ZW50CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gQXQgbGVhc3QgZ2l2ZSBzb21lIGtpbmQgb2YgY29udGV4dCB0byB0aGUgdXNlcgogICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoJ1VuY2F1Z2h0LCB1bnNwZWNpZmllZCAiZXJyb3IiIGV2ZW50LiAoJyArIGVyICsgJyknKTsKICAgICAgICBlcnIuY29udGV4dCA9IGVyOwogICAgICAgIHRocm93IGVycjsKICAgICAgfQogICAgfQogIH0KCiAgaGFuZGxlciA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCiAgaWYgKGlzVW5kZWZpbmVkKGhhbmRsZXIpKQogICAgcmV0dXJuIGZhbHNlOwoKICBpZiAoaXNGdW5jdGlvbihoYW5kbGVyKSkgewogICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7CiAgICAgIC8vIGZhc3QgY2FzZXMKICAgICAgY2FzZSAxOgogICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAyOgogICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIDM6CiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgLy8gc2xvd2VyCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CiAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKTsKICAgIH0KICB9IGVsc2UgaWYgKGlzT2JqZWN0KGhhbmRsZXIpKSB7CiAgICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKICAgIGxpc3RlbmVycyA9IGhhbmRsZXIuc2xpY2UoKTsKICAgIGxlbiA9IGxpc3RlbmVycy5sZW5ndGg7CiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspCiAgICAgIGxpc3RlbmVyc1tpXS5hcHBseSh0aGlzLCBhcmdzKTsKICB9CgogIHJldHVybiB0cnVlOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7CiAgdmFyIG07CgogIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpCiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpOwoKICBpZiAoIXRoaXMuX2V2ZW50cykKICAgIHRoaXMuX2V2ZW50cyA9IHt9OwoKICAvLyBUbyBhdm9pZCByZWN1cnNpb24gaW4gdGhlIGNhc2UgdGhhdCB0eXBlID09PSAibmV3TGlzdGVuZXIiISBCZWZvcmUKICAvLyBhZGRpbmcgaXQgdG8gdGhlIGxpc3RlbmVycywgZmlyc3QgZW1pdCAibmV3TGlzdGVuZXIiLgogIGlmICh0aGlzLl9ldmVudHMubmV3TGlzdGVuZXIpCiAgICB0aGlzLmVtaXQoJ25ld0xpc3RlbmVyJywgdHlwZSwKICAgICAgICAgICAgICBpc0Z1bmN0aW9uKGxpc3RlbmVyLmxpc3RlbmVyKSA/CiAgICAgICAgICAgICAgbGlzdGVuZXIubGlzdGVuZXIgOiBsaXN0ZW5lcik7CgogIGlmICghdGhpcy5fZXZlbnRzW3R5cGVdKQogICAgLy8gT3B0aW1pemUgdGhlIGNhc2Ugb2Ygb25lIGxpc3RlbmVyLiBEb24ndCBuZWVkIHRoZSBleHRyYSBhcnJheSBvYmplY3QuCiAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjsKICBlbHNlIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pKQogICAgLy8gSWYgd2UndmUgYWxyZWFkeSBnb3QgYW4gYXJyYXksIGp1c3QgYXBwZW5kLgogICAgdGhpcy5fZXZlbnRzW3R5cGVdLnB1c2gobGlzdGVuZXIpOwogIGVsc2UKICAgIC8vIEFkZGluZyB0aGUgc2Vjb25kIGVsZW1lbnQsIG5lZWQgdG8gY2hhbmdlIHRvIGFycmF5LgogICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gW3RoaXMuX2V2ZW50c1t0eXBlXSwgbGlzdGVuZXJdOwoKICAvLyBDaGVjayBmb3IgbGlzdGVuZXIgbGVhawogIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pICYmICF0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkKSB7CiAgICBpZiAoIWlzVW5kZWZpbmVkKHRoaXMuX21heExpc3RlbmVycykpIHsKICAgICAgbSA9IHRoaXMuX21heExpc3RlbmVyczsKICAgIH0gZWxzZSB7CiAgICAgIG0gPSBFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVyczsKICAgIH0KCiAgICBpZiAobSAmJiBtID4gMCAmJiB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoID4gbSkgewogICAgICB0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkID0gdHJ1ZTsKICAgICAgY29uc29sZS5lcnJvcignKG5vZGUpIHdhcm5pbmc6IHBvc3NpYmxlIEV2ZW50RW1pdHRlciBtZW1vcnkgJyArCiAgICAgICAgICAgICAgICAgICAgJ2xlYWsgZGV0ZWN0ZWQuICVkIGxpc3RlbmVycyBhZGRlZC4gJyArCiAgICAgICAgICAgICAgICAgICAgJ1VzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvIGluY3JlYXNlIGxpbWl0LicsCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLmxlbmd0aCk7CiAgICAgIGlmICh0eXBlb2YgY29uc29sZS50cmFjZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIC8vIG5vdCBzdXBwb3J0ZWQgaW4gSUUgMTAKICAgICAgICBjb25zb2xlLnRyYWNlKCk7CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiB0aGlzOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXI7CgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikgewogIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpCiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpOwoKICB2YXIgZmlyZWQgPSBmYWxzZTsKCiAgZnVuY3Rpb24gZygpIHsKICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgZyk7CgogICAgaWYgKCFmaXJlZCkgewogICAgICBmaXJlZCA9IHRydWU7CiAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CiAgfQoKICBnLmxpc3RlbmVyID0gbGlzdGVuZXI7CiAgdGhpcy5vbih0eXBlLCBnKTsKCiAgcmV0dXJuIHRoaXM7Cn07CgovLyBlbWl0cyBhICdyZW1vdmVMaXN0ZW5lcicgZXZlbnQgaWZmIHRoZSBsaXN0ZW5lciB3YXMgcmVtb3ZlZApFdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHsKICB2YXIgbGlzdCwgcG9zaXRpb24sIGxlbmd0aCwgaTsKCiAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSkKICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7CgogIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pCiAgICByZXR1cm4gdGhpczsKCiAgbGlzdCA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKICBsZW5ndGggPSBsaXN0Lmxlbmd0aDsKICBwb3NpdGlvbiA9IC0xOwoKICBpZiAobGlzdCA9PT0gbGlzdGVuZXIgfHwKICAgICAgKGlzRnVuY3Rpb24obGlzdC5saXN0ZW5lcikgJiYgbGlzdC5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7CiAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdOwogICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikKICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTsKCiAgfSBlbHNlIGlmIChpc09iamVjdChsaXN0KSkgewogICAgZm9yIChpID0gbGVuZ3RoOyBpLS0gPiAwOykgewogICAgICBpZiAobGlzdFtpXSA9PT0gbGlzdGVuZXIgfHwKICAgICAgICAgIChsaXN0W2ldLmxpc3RlbmVyICYmIGxpc3RbaV0ubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkgewogICAgICAgIHBvc2l0aW9uID0gaTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGlmIChwb3NpdGlvbiA8IDApCiAgICAgIHJldHVybiB0aGlzOwoKICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMSkgewogICAgICBsaXN0Lmxlbmd0aCA9IDA7CiAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07CiAgICB9IGVsc2UgewogICAgICBsaXN0LnNwbGljZShwb3NpdGlvbiwgMSk7CiAgICB9CgogICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikKICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTsKICB9CgogIHJldHVybiB0aGlzOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbih0eXBlKSB7CiAgdmFyIGtleSwgbGlzdGVuZXJzOwoKICBpZiAoIXRoaXMuX2V2ZW50cykKICAgIHJldHVybiB0aGlzOwoKICAvLyBub3QgbGlzdGVuaW5nIGZvciByZW1vdmVMaXN0ZW5lciwgbm8gbmVlZCB0byBlbWl0CiAgaWYgKCF0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpIHsKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKQogICAgICB0aGlzLl9ldmVudHMgPSB7fTsKICAgIGVsc2UgaWYgKHRoaXMuX2V2ZW50c1t0eXBlXSkKICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLy8gZW1pdCByZW1vdmVMaXN0ZW5lciBmb3IgYWxsIGxpc3RlbmVycyBvbiBhbGwgZXZlbnRzCiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsKICAgIGZvciAoa2V5IGluIHRoaXMuX2V2ZW50cykgewogICAgICBpZiAoa2V5ID09PSAncmVtb3ZlTGlzdGVuZXInKSBjb250aW51ZTsKICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoa2V5KTsKICAgIH0KICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCdyZW1vdmVMaXN0ZW5lcicpOwogICAgdGhpcy5fZXZlbnRzID0ge307CiAgICByZXR1cm4gdGhpczsKICB9CgogIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCiAgaWYgKGlzRnVuY3Rpb24obGlzdGVuZXJzKSkgewogICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpOwogIH0gZWxzZSBpZiAobGlzdGVuZXJzKSB7CiAgICAvLyBMSUZPIG9yZGVyCiAgICB3aGlsZSAobGlzdGVuZXJzLmxlbmd0aCkKICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnNbbGlzdGVuZXJzLmxlbmd0aCAtIDFdKTsKICB9CiAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTsKCiAgcmV0dXJuIHRoaXM7Cn07CgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uKHR5cGUpIHsKICB2YXIgcmV0OwogIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pCiAgICByZXQgPSBbXTsKICBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoaXMuX2V2ZW50c1t0eXBlXSkpCiAgICByZXQgPSBbdGhpcy5fZXZlbnRzW3R5cGVdXTsKICBlbHNlCiAgICByZXQgPSB0aGlzLl9ldmVudHNbdHlwZV0uc2xpY2UoKTsKICByZXR1cm4gcmV0Owp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24odHlwZSkgewogIGlmICh0aGlzLl9ldmVudHMpIHsKICAgIHZhciBldmxpc3RlbmVyID0gdGhpcy5fZXZlbnRzW3R5cGVdOwoKICAgIGlmIChpc0Z1bmN0aW9uKGV2bGlzdGVuZXIpKQogICAgICByZXR1cm4gMTsKICAgIGVsc2UgaWYgKGV2bGlzdGVuZXIpCiAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDsKICB9CiAgcmV0dXJuIDA7Cn07CgpFdmVudEVtaXR0ZXIubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKGVtaXR0ZXIsIHR5cGUpIHsKICByZXR1cm4gZW1pdHRlci5saXN0ZW5lckNvdW50KHR5cGUpOwp9OwoKZnVuY3Rpb24gaXNGdW5jdGlvbihhcmcpIHsKICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Z1bmN0aW9uJzsKfQoKZnVuY3Rpb24gaXNOdW1iZXIoYXJnKSB7CiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdudW1iZXInOwp9CgpmdW5jdGlvbiBpc09iamVjdChhcmcpIHsKICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsOwp9CgpmdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHsKICByZXR1cm4gYXJnID09PSB2b2lkIDA7Cn0KCn0se31dLDI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewp2YXIgZ3JhbW1hciA9IG1vZHVsZS5leHBvcnRzID0gewogIHY6IFt7CiAgICAgIG5hbWU6ICd2ZXJzaW9uJywKICAgICAgcmVnOiAvXihcZCopJC8KICB9XSwKICBvOiBbeyAvL289LSAyMDUxOCAwIElOIElQNCAyMDMuMC4xMTMuMQogICAgLy8gTkI6IHNlc3Npb25JZCB3aWxsIGJlIGEgU3RyaW5nIGluIG1vc3QgY2FzZXMgYmVjYXVzZSBpdCBpcyBodWdlCiAgICBuYW1lOiAnb3JpZ2luJywKICAgIHJlZzogL14oXFMqKSAoXGQqKSAoXGQqKSAoXFMqKSBJUChcZCkgKFxTKikvLAogICAgbmFtZXM6IFsndXNlcm5hbWUnLCAnc2Vzc2lvbklkJywgJ3Nlc3Npb25WZXJzaW9uJywgJ25ldFR5cGUnLCAnaXBWZXInLCAnYWRkcmVzcyddLAogICAgZm9ybWF0OiAiJXMgJXMgJWQgJXMgSVAlZCAlcyIKICB9XSwKICAvLyBkZWZhdWx0IHBhcnNpbmcgb2YgdGhlc2Ugb25seSAodGhvdWdoIHNvbWUgb2YgdGhlc2UgZmVlbCBvdXRkYXRlZCkKICBzOiBbeyBuYW1lOiAnbmFtZScgfV0sCiAgaTogW3sgbmFtZTogJ2Rlc2NyaXB0aW9uJyB9XSwKICB1OiBbeyBuYW1lOiAndXJpJyB9XSwKICBlOiBbeyBuYW1lOiAnZW1haWwnIH1dLAogIHA6IFt7IG5hbWU6ICdwaG9uZScgfV0sCiAgejogW3sgbmFtZTogJ3RpbWV6b25lcycgfV0sIC8vIFRPRE86IHRoaXMgb25lIGNhbiBhY3R1YWxseSBiZSBwYXJzZWQgcHJvcGVybHkuLgogIHI6IFt7IG5hbWU6ICdyZXBlYXRzJyB9XSwgICAvLyBUT0RPOiB0aGlzIG9uZSBjYW4gYWxzbyBiZSBwYXJzZWQgcHJvcGVybHkKICAvL2s6IFt7fV0sIC8vIG91dGRhdGVkIHRoaW5nIGlnbm9yZWQKICB0OiBbeyAvL3Q9MCAwCiAgICBuYW1lOiAndGltaW5nJywKICAgIHJlZzogL14oXGQqKSAoXGQqKS8sCiAgICBuYW1lczogWydzdGFydCcsICdzdG9wJ10sCiAgICBmb3JtYXQ6ICIlZCAlZCIKICB9XSwKICBjOiBbeyAvL2M9SU4gSVA0IDEwLjQ3LjE5Ny4yNgogICAgICBuYW1lOiAnY29ubmVjdGlvbicsCiAgICAgIHJlZzogL15JTiBJUChcZCkgKFxTKikvLAogICAgICBuYW1lczogWyd2ZXJzaW9uJywgJ2lwJ10sCiAgICAgIGZvcm1hdDogIklOIElQJWQgJXMiCiAgfV0sCiAgYjogW3sgLy9iPUFTOjQwMDAKICAgICAgcHVzaDogJ2JhbmR3aWR0aCcsCiAgICAgIHJlZzogL14oVElBU3xBU3xDVHxSUnxSUyk6KFxkKikvLAogICAgICBuYW1lczogWyd0eXBlJywgJ2xpbWl0J10sCiAgICAgIGZvcm1hdDogIiVzOiVzIgogIH1dLAogIG06IFt7IC8vbT12aWRlbyA1MTc0NCBSVFAvQVZQIDEyNiA5NyA5OCAzNCAzMQogICAgICAvLyBOQjogc3BlY2lhbCAtIHB1c2hlcyB0byBzZXNzaW9uCiAgICAgIC8vIFRPRE86IHJ0cC9mbXRwIHNob3VsZCBiZSBmaWx0ZXJlZCBieSB0aGUgcGF5bG9hZHMgZm91bmQgaGVyZT8KICAgICAgcmVnOiAvXihcdyopIChcZCopIChbXHdcL10qKSg/OiAoLiopKT8vLAogICAgICBuYW1lczogWyd0eXBlJywgJ3BvcnQnLCAncHJvdG9jb2wnLCAncGF5bG9hZHMnXSwKICAgICAgZm9ybWF0OiAiJXMgJWQgJXMgJXMiCiAgfV0sCiAgYTogWwogICAgeyAvL2E9cnRwbWFwOjExMCBvcHVzLzQ4MDAwLzIKICAgICAgcHVzaDogJ3J0cCcsCiAgICAgIHJlZzogL15ydHBtYXA6KFxkKikgKFtcd1wtXC5dKikoPzpccypcLyhcZCopKD86XHMqXC8oXFMqKSk/KT8vLAogICAgICBuYW1lczogWydwYXlsb2FkJywgJ2NvZGVjJywgJ3JhdGUnLCAnZW5jb2RpbmcnXSwKICAgICAgZm9ybWF0OiBmdW5jdGlvbiAobykgewogICAgICAgIHJldHVybiAoby5lbmNvZGluZykgPwogICAgICAgICAgInJ0cG1hcDolZCAlcy8lcy8lcyI6CiAgICAgICAgICBvLnJhdGUgPwogICAgICAgICAgInJ0cG1hcDolZCAlcy8lcyI6CiAgICAgICAgICAicnRwbWFwOiVkICVzIjsKICAgICAgfQogICAgfSwKICAgIHsKICAgICAgLy9hPWZtdHA6MTA4IHByb2ZpbGUtbGV2ZWwtaWQ9MjQ7b2JqZWN0PTIzO2JpdHJhdGU9NjQwMDAKICAgICAgLy9hPWZtdHA6MTExIG1pbnB0aW1lPTEwOyB1c2VpbmJhbmRmZWM9MQogICAgICBwdXNoOiAnZm10cCcsCiAgICAgIHJlZzogL15mbXRwOihcZCopIChbXFN8IF0qKS8sCiAgICAgIG5hbWVzOiBbJ3BheWxvYWQnLCAnY29uZmlnJ10sCiAgICAgIGZvcm1hdDogImZtdHA6JWQgJXMiCiAgICB9LAogICAgeyAvL2E9Y29udHJvbDpzdHJlYW1pZD0wCiAgICAgICAgbmFtZTogJ2NvbnRyb2wnLAogICAgICAgIHJlZzogL15jb250cm9sOiguKikvLAogICAgICAgIGZvcm1hdDogImNvbnRyb2w6JXMiCiAgICB9LAogICAgeyAvL2E9cnRjcDo2NTE3OSBJTiBJUDQgMTkzLjg0Ljc3LjE5NAogICAgICBuYW1lOiAncnRjcCcsCiAgICAgIHJlZzogL15ydGNwOihcZCopKD86IChcUyopIElQKFxkKSAoXFMqKSk/LywKICAgICAgbmFtZXM6IFsncG9ydCcsICduZXRUeXBlJywgJ2lwVmVyJywgJ2FkZHJlc3MnXSwKICAgICAgZm9ybWF0OiBmdW5jdGlvbiAobykgewogICAgICAgIHJldHVybiAoby5hZGRyZXNzICE9IG51bGwpID8KICAgICAgICAgICJydGNwOiVkICVzIElQJWQgJXMiOgogICAgICAgICAgInJ0Y3A6JWQiOwogICAgICB9CiAgICB9LAogICAgeyAvL2E9cnRjcC1mYjo5OCB0cnItaW50IDEwMAogICAgICBwdXNoOiAncnRjcEZiVHJySW50JywKICAgICAgcmVnOiAvXnJ0Y3AtZmI6KFwqfFxkKikgdHJyLWludCAoXGQqKS8sCiAgICAgIG5hbWVzOiBbJ3BheWxvYWQnLCAndmFsdWUnXSwKICAgICAgZm9ybWF0OiAicnRjcC1mYjolZCB0cnItaW50ICVkIgogICAgfSwKICAgIHsgLy9hPXJ0Y3AtZmI6OTggbmFjayBycHNpCiAgICAgIHB1c2g6ICdydGNwRmInLAogICAgICByZWc6IC9ecnRjcC1mYjooXCp8XGQqKSAoW1x3LV9dKikoPzogKFtcdy1fXSopKT8vLAogICAgICBuYW1lczogWydwYXlsb2FkJywgJ3R5cGUnLCAnc3VidHlwZSddLAogICAgICBmb3JtYXQ6IGZ1bmN0aW9uIChvKSB7CiAgICAgICAgcmV0dXJuIChvLnN1YnR5cGUgIT0gbnVsbCkgPwogICAgICAgICAgInJ0Y3AtZmI6JXMgJXMgJXMiOgogICAgICAgICAgInJ0Y3AtZmI6JXMgJXMiOwogICAgICB9CiAgICB9LAogICAgeyAvL2E9ZXh0bWFwOjIgdXJuOmlldGY6cGFyYW1zOnJ0cC1oZHJleHQ6dG9mZnNldAogICAgICAvL2E9ZXh0bWFwOjEvcmVjdm9ubHkgVVJJLWdwcy1zdHJpbmcKICAgICAgcHVzaDogJ2V4dCcsCiAgICAgIHJlZzogL15leHRtYXA6KFtcd19cL10qKSAoXFMqKSg/OiAoXFMqKSk/LywKICAgICAgbmFtZXM6IFsndmFsdWUnLCAndXJpJywgJ2NvbmZpZyddLCAvLyB2YWx1ZSBtYXkgaW5jbHVkZSAiL2RpcmVjdGlvbiIgc3VmZml4CiAgICAgIGZvcm1hdDogZnVuY3Rpb24gKG8pIHsKICAgICAgICByZXR1cm4gKG8uY29uZmlnICE9IG51bGwpID8KICAgICAgICAgICJleHRtYXA6JXMgJXMgJXMiOgogICAgICAgICAgImV4dG1hcDolcyAlcyI7CiAgICAgIH0KICAgIH0sCiAgICB7CiAgICAgIC8vYT1jcnlwdG86MSBBRVNfQ01fMTI4X0hNQUNfU0hBMV84MCBpbmxpbmU6UFMxdVFDVmVlQ0ZDYW5WbWNqa3BQeXdqTldoY1lEMG1YWHR4YVZCUnwyXjIwfDE6MzIKICAgICAgcHVzaDogJ2NyeXB0bycsCiAgICAgIHJlZzogL15jcnlwdG86KFxkKikgKFtcd19dKikgKFxTKikoPzogKFxTKikpPy8sCiAgICAgIG5hbWVzOiBbJ2lkJywgJ3N1aXRlJywgJ2NvbmZpZycsICdzZXNzaW9uQ29uZmlnJ10sCiAgICAgIGZvcm1hdDogZnVuY3Rpb24gKG8pIHsKICAgICAgICByZXR1cm4gKG8uc2Vzc2lvbkNvbmZpZyAhPSBudWxsKSA/CiAgICAgICAgICAiY3J5cHRvOiVkICVzICVzICVzIjoKICAgICAgICAgICJjcnlwdG86JWQgJXMgJXMiOwogICAgICB9CiAgICB9LAogICAgeyAvL2E9c2V0dXA6YWN0cGFzcwogICAgICBuYW1lOiAnc2V0dXAnLAogICAgICByZWc6IC9ec2V0dXA6KFx3KikvLAogICAgICBmb3JtYXQ6ICJzZXR1cDolcyIKICAgIH0sCiAgICB7IC8vYT1taWQ6MQogICAgICBuYW1lOiAnbWlkJywKICAgICAgcmVnOiAvXm1pZDooW15cc10qKS8sCiAgICAgIGZvcm1hdDogIm1pZDolcyIKICAgIH0sCiAgICB7IC8vYT1tc2lkOjBjOGIwNjRkLWQ4MDctNDNiNC1iNDM0LWY5MmE4ODlkODU4NyA5ODE3ODY4NS1kNDA5LTQ2ZTAtOGUxNi03ZWYwZGIwZGI2NGEKICAgICAgbmFtZTogJ21zaWQnLAogICAgICByZWc6IC9ebXNpZDooLiopLywKICAgICAgZm9ybWF0OiAibXNpZDolcyIKICAgIH0sCiAgICB7IC8vYT1wdGltZToyMAogICAgICBuYW1lOiAncHRpbWUnLAogICAgICByZWc6IC9ecHRpbWU6KFxkKikvLAogICAgICBmb3JtYXQ6ICJwdGltZTolZCIKICAgIH0sCiAgICB7IC8vYT1tYXhwdGltZTo2MAogICAgICBuYW1lOiAnbWF4cHRpbWUnLAogICAgICByZWc6IC9ebWF4cHRpbWU6KFxkKikvLAogICAgICBmb3JtYXQ6ICJtYXhwdGltZTolZCIKICAgIH0sCiAgICB7IC8vYT1zZW5kcmVjdgogICAgICBuYW1lOiAnZGlyZWN0aW9uJywKICAgICAgcmVnOiAvXihzZW5kcmVjdnxyZWN2b25seXxzZW5kb25seXxpbmFjdGl2ZSkvCiAgICB9LAogICAgeyAvL2E9aWNlLWxpdGUKICAgICAgbmFtZTogJ2ljZWxpdGUnLAogICAgICByZWc6IC9eKGljZS1saXRlKS8KICAgIH0sCiAgICB7IC8vYT1pY2UtdWZyYWc6RjdnSQogICAgICBuYW1lOiAnaWNlVWZyYWcnLAogICAgICByZWc6IC9eaWNlLXVmcmFnOihcUyopLywKICAgICAgZm9ybWF0OiAiaWNlLXVmcmFnOiVzIgogICAgfSwKICAgIHsgLy9hPWljZS1wd2Q6eDljbWwvWXppY2hWMitYbGhpTXU4ZwogICAgICBuYW1lOiAnaWNlUHdkJywKICAgICAgcmVnOiAvXmljZS1wd2Q6KFxTKikvLAogICAgICBmb3JtYXQ6ICJpY2UtcHdkOiVzIgogICAgfSwKICAgIHsgLy9hPWZpbmdlcnByaW50OlNIQS0xIDAwOjExOjIyOjMzOjQ0OjU1OjY2Ojc3Ojg4Ojk5OkFBOkJCOkNDOkREOkVFOkZGOjAwOjExOjIyOjMzCiAgICAgIG5hbWU6ICdmaW5nZXJwcmludCcsCiAgICAgIHJlZzogL15maW5nZXJwcmludDooXFMqKSAoXFMqKS8sCiAgICAgIG5hbWVzOiBbJ3R5cGUnLCAnaGFzaCddLAogICAgICBmb3JtYXQ6ICJmaW5nZXJwcmludDolcyAlcyIKICAgIH0sCiAgICB7CiAgICAgIC8vYT1jYW5kaWRhdGU6MCAxIFVEUCAyMTEzNjY3MzI3IDIwMy4wLjExMy4xIDU0NDAwIHR5cCBob3N0CiAgICAgIC8vYT1jYW5kaWRhdGU6MTE2Mjg3NTA4MSAxIHVkcCAyMTEzOTM3MTUxIDE5Mi4xNjguMzQuNzUgNjAwMTcgdHlwIGhvc3QgZ2VuZXJhdGlvbiAwIG5ldHdvcmstaWQgMyBuZXR3b3JrLWNvc3QgMTAKICAgICAgLy9hPWNhbmRpZGF0ZTozMjg5OTEyOTU3IDIgdWRwIDE4NDU1MDE2OTUgMTkzLjg0Ljc3LjE5NCA2MDAxNyB0eXAgc3JmbHggcmFkZHIgMTkyLjE2OC4zNC43NSBycG9ydCA2MDAxNyBnZW5lcmF0aW9uIDAgbmV0d29yay1pZCAzIG5ldHdvcmstY29zdCAxMAogICAgICAvL2E9Y2FuZGlkYXRlOjIyOTgxNTYyMCAxIHRjcCAxNTE4MjgwNDQ3IDE5Mi4xNjguMTUwLjE5IDYwMDE3IHR5cCBob3N0IHRjcHR5cGUgYWN0aXZlIGdlbmVyYXRpb24gMCBuZXR3b3JrLWlkIDMgbmV0d29yay1jb3N0IDEwCiAgICAgIC8vYT1jYW5kaWRhdGU6MzI4OTkxMjk1NyAyIHRjcCAxODQ1NTAxNjk1IDE5My44NC43Ny4xOTQgNjAwMTcgdHlwIHNyZmx4IHJhZGRyIDE5Mi4xNjguMzQuNzUgcnBvcnQgNjAwMTcgdGNwdHlwZSBwYXNzaXZlIGdlbmVyYXRpb24gMCBuZXR3b3JrLWlkIDMgbmV0d29yay1jb3N0IDEwCiAgICAgIHB1c2g6J2NhbmRpZGF0ZXMnLAogICAgICByZWc6IC9eY2FuZGlkYXRlOihcUyopIChcZCopIChcUyopIChcZCopIChcUyopIChcZCopIHR5cCAoXFMqKSg/OiByYWRkciAoXFMqKSBycG9ydCAoXGQqKSk/KD86IHRjcHR5cGUgKFxTKikpPyg/OiBnZW5lcmF0aW9uIChcZCopKT8oPzogbmV0d29yay1pZCAoXGQqKSk/KD86IG5ldHdvcmstY29zdCAoXGQqKSk/LywKICAgICAgbmFtZXM6IFsnZm91bmRhdGlvbicsICdjb21wb25lbnQnLCAndHJhbnNwb3J0JywgJ3ByaW9yaXR5JywgJ2lwJywgJ3BvcnQnLCAndHlwZScsICdyYWRkcicsICdycG9ydCcsICd0Y3B0eXBlJywgJ2dlbmVyYXRpb24nLCAnbmV0d29yay1pZCcsICduZXR3b3JrLWNvc3QnXSwKICAgICAgZm9ybWF0OiBmdW5jdGlvbiAobykgewogICAgICAgIHZhciBzdHIgPSAiY2FuZGlkYXRlOiVzICVkICVzICVkICVzICVkIHR5cCAlcyI7CgogICAgICAgIHN0ciArPSAoby5yYWRkciAhPSBudWxsKSA/ICIgcmFkZHIgJXMgcnBvcnQgJWQiIDogIiV2JXYiOwoKICAgICAgICAvLyBOQjogY2FuZGlkYXRlIGhhcyB0aHJlZSBvcHRpb25hbCBjaHVua3MsIHNvICV2b2lkIG1pZGRsZXMgb25lIGlmIGl0J3MgbWlzc2luZwogICAgICAgIHN0ciArPSAoby50Y3B0eXBlICE9IG51bGwpID8gIiB0Y3B0eXBlICVzIiA6ICIldiI7CgogICAgICAgIGlmIChvLmdlbmVyYXRpb24gIT0gbnVsbCkgewogICAgICAgICAgc3RyICs9ICIgZ2VuZXJhdGlvbiAlZCI7CiAgICAgICAgfQoKICAgICAgICBzdHIgKz0gKG9bJ25ldHdvcmstaWQnXSAhPSBudWxsKSA/ICIgbmV0d29yay1pZCAlZCIgOiAiJXYiOwogICAgICAgIHN0ciArPSAob1snbmV0d29yay1jb3N0J10gIT0gbnVsbCkgPyAiIG5ldHdvcmstY29zdCAlZCIgOiAiJXYiOwogICAgICAgIHJldHVybiBzdHI7CiAgICAgIH0KICAgIH0sCiAgICB7IC8vYT1lbmQtb2YtY2FuZGlkYXRlcyAoa2VlcCBhZnRlciB0aGUgY2FuZGlkYXRlcyBsaW5lIGZvciByZWFkYWJpbGl0eSkKICAgICAgbmFtZTogJ2VuZE9mQ2FuZGlkYXRlcycsCiAgICAgIHJlZzogL14oZW5kLW9mLWNhbmRpZGF0ZXMpLwogICAgfSwKICAgIHsgLy9hPXJlbW90ZS1jYW5kaWRhdGVzOjEgMjAzLjAuMTEzLjEgNTQ0MDAgMiAyMDMuMC4xMTMuMSA1NDQwMSAuLi4KICAgICAgbmFtZTogJ3JlbW90ZUNhbmRpZGF0ZXMnLAogICAgICByZWc6IC9ecmVtb3RlLWNhbmRpZGF0ZXM6KC4qKS8sCiAgICAgIGZvcm1hdDogInJlbW90ZS1jYW5kaWRhdGVzOiVzIgogICAgfSwKICAgIHsgLy9hPWljZS1vcHRpb25zOmdvb2dsZS1pY2UKICAgICAgbmFtZTogJ2ljZU9wdGlvbnMnLAogICAgICByZWc6IC9eaWNlLW9wdGlvbnM6KFxTKikvLAogICAgICBmb3JtYXQ6ICJpY2Utb3B0aW9uczolcyIKICAgIH0sCiAgICB7IC8vYT1zc3JjOjI1NjYxMDc1NjkgY25hbWU6dDlZVThNMVV4VEY4WTFBMQogICAgICBwdXNoOiAic3NyY3MiLAogICAgICByZWc6IC9ec3NyYzooXGQqKSAoW1x3X10qKSg/OjooLiopKT8vLAogICAgICBuYW1lczogWydpZCcsICdhdHRyaWJ1dGUnLCAndmFsdWUnXSwKICAgICAgZm9ybWF0OiBmdW5jdGlvbiAobykgewogICAgICAgIHZhciBzdHIgPSAic3NyYzolZCI7CiAgICAgICAgaWYgKG8uYXR0cmlidXRlICE9IG51bGwpIHsKICAgICAgICAgIHN0ciArPSAiICVzIjsKICAgICAgICAgIGlmIChvLnZhbHVlICE9IG51bGwpIHsKICAgICAgICAgICAgc3RyICs9ICI6JXMiOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gc3RyOwogICAgICB9CiAgICB9LAogICAgeyAvL2E9c3NyYy1ncm91cDpGRUMgMSAyCiAgICAgIHB1c2g6ICJzc3JjR3JvdXBzIiwKICAgICAgcmVnOiAvXnNzcmMtZ3JvdXA6KFx3KikgKC4qKS8sCiAgICAgIG5hbWVzOiBbJ3NlbWFudGljcycsICdzc3JjcyddLAogICAgICBmb3JtYXQ6ICJzc3JjLWdyb3VwOiVzICVzIgogICAgfSwKICAgIHsgLy9hPW1zaWQtc2VtYW50aWM6IFdNUyBKdmxhbTVYM1NYMU9QNnBuMjB6V29ndmFLSno1SGpmOU9ubFYKICAgICAgbmFtZTogIm1zaWRTZW1hbnRpYyIsCiAgICAgIHJlZzogL15tc2lkLXNlbWFudGljOlxzPyhcdyopIChcUyopLywKICAgICAgbmFtZXM6IFsnc2VtYW50aWMnLCAndG9rZW4nXSwKICAgICAgZm9ybWF0OiAibXNpZC1zZW1hbnRpYzogJXMgJXMiIC8vIHNwYWNlIGFmdGVyICI6IiBpcyBub3QgYWNjaWRlbnRhbAogICAgfSwKICAgIHsgLy9hPWdyb3VwOkJVTkRMRSBhdWRpbyB2aWRlbwogICAgICBwdXNoOiAnZ3JvdXBzJywKICAgICAgcmVnOiAvXmdyb3VwOihcdyopICguKikvLAogICAgICBuYW1lczogWyd0eXBlJywgJ21pZHMnXSwKICAgICAgZm9ybWF0OiAiZ3JvdXA6JXMgJXMiCiAgICB9LAogICAgeyAvL2E9cnRjcC1tdXgKICAgICAgbmFtZTogJ3J0Y3BNdXgnLAogICAgICByZWc6IC9eKHJ0Y3AtbXV4KS8KICAgIH0sCiAgICB7IC8vYT1ydGNwLXJzaXplCiAgICAgIG5hbWU6ICdydGNwUnNpemUnLAogICAgICByZWc6IC9eKHJ0Y3AtcnNpemUpLwogICAgfSwKICAgIHsgLy9hPXNjdHBtYXA6NTAwMCB3ZWJydGMtZGF0YWNoYW5uZWwgMTAyNAogICAgICBuYW1lOiAnc2N0cG1hcCcsCiAgICAgIHJlZzogL15zY3RwbWFwOihbXHdfXC9dKikgKFxTKikoPzogKFxTKikpPy8sCiAgICAgIG5hbWVzOiBbJ3NjdHBtYXBOdW1iZXInLCAnYXBwJywgJ21heE1lc3NhZ2VTaXplJ10sCiAgICAgIGZvcm1hdDogZnVuY3Rpb24gKG8pIHsKICAgICAgICByZXR1cm4gKG8ubWF4TWVzc2FnZVNpemUgIT0gbnVsbCkgPwogICAgICAgICAgInNjdHBtYXA6JXMgJXMgJXMiIDoKICAgICAgICAgICJzY3RwbWFwOiVzICVzIjsKICAgICAgfQogICAgfSwKICAgIHsgLy8gYW55IGE9IHRoYXQgd2UgZG9uJ3QgdW5kZXJzdGFuZCBpcyBrZXB0cyB2ZXJiYXRpbSBvbiBtZWRpYS5pbnZhbGlkCiAgICAgIHB1c2g6ICdpbnZhbGlkJywKICAgICAgbmFtZXM6IFsidmFsdWUiXQogICAgfQogIF0KfTsKCi8vIHNldCBzZW5zaWJsZSBkZWZhdWx0cyB0byBhdm9pZCBwb2xsdXRpbmcgdGhlIGdyYW1tYXIgd2l0aCBib3JpbmcgZGV0YWlscwpPYmplY3Qua2V5cyhncmFtbWFyKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICB2YXIgb2JqcyA9IGdyYW1tYXJba2V5XTsKICBvYmpzLmZvckVhY2goZnVuY3Rpb24gKG9iaikgewogICAgaWYgKCFvYmoucmVnKSB7CiAgICAgIG9iai5yZWcgPSAvKC4qKS87CiAgICB9CiAgICBpZiAoIW9iai5mb3JtYXQpIHsKICAgICAgb2JqLmZvcm1hdCA9ICIlcyI7CiAgICB9CiAgfSk7Cn0pOwoKfSx7fV0sMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CnZhciBwYXJzZXIgPSByZXF1aXJlKCcuL3BhcnNlcicpOwp2YXIgd3JpdGVyID0gcmVxdWlyZSgnLi93cml0ZXInKTsKCmV4cG9ydHMud3JpdGUgPSB3cml0ZXI7CmV4cG9ydHMucGFyc2UgPSBwYXJzZXIucGFyc2U7CmV4cG9ydHMucGFyc2VGbXRwQ29uZmlnID0gcGFyc2VyLnBhcnNlRm10cENvbmZpZzsKZXhwb3J0cy5wYXJzZVBheWxvYWRzID0gcGFyc2VyLnBhcnNlUGF5bG9hZHM7CmV4cG9ydHMucGFyc2VSZW1vdGVDYW5kaWRhdGVzID0gcGFyc2VyLnBhcnNlUmVtb3RlQ2FuZGlkYXRlczsKCn0seyIuL3BhcnNlciI6NCwiLi93cml0ZXIiOjV9XSw0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKdmFyIHRvSW50SWZJbnQgPSBmdW5jdGlvbiAodikgewogIHJldHVybiBTdHJpbmcoTnVtYmVyKHYpKSA9PT0gdiA/IE51bWJlcih2KSA6IHY7Cn07Cgp2YXIgYXR0YWNoUHJvcGVydGllcyA9IGZ1bmN0aW9uIChtYXRjaCwgbG9jYXRpb24sIG5hbWVzLCByYXdOYW1lKSB7CiAgaWYgKHJhd05hbWUgJiYgIW5hbWVzKSB7CiAgICBsb2NhdGlvbltyYXdOYW1lXSA9IHRvSW50SWZJbnQobWF0Y2hbMV0pOwogIH0KICBlbHNlIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbmFtZXMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgaWYgKG1hdGNoW2krMV0gIT0gbnVsbCkgewogICAgICAgIGxvY2F0aW9uW25hbWVzW2ldXSA9IHRvSW50SWZJbnQobWF0Y2hbaSsxXSk7CiAgICAgIH0KICAgIH0KICB9Cn07Cgp2YXIgcGFyc2VSZWcgPSBmdW5jdGlvbiAob2JqLCBsb2NhdGlvbiwgY29udGVudCkgewogIHZhciBuZWVkc0JsYW5rID0gb2JqLm5hbWUgJiYgb2JqLm5hbWVzOwogIGlmIChvYmoucHVzaCAmJiAhbG9jYXRpb25bb2JqLnB1c2hdKSB7CiAgICBsb2NhdGlvbltvYmoucHVzaF0gPSBbXTsKICB9CiAgZWxzZSBpZiAobmVlZHNCbGFuayAmJiAhbG9jYXRpb25bb2JqLm5hbWVdKSB7CiAgICBsb2NhdGlvbltvYmoubmFtZV0gPSB7fTsKICB9CiAgdmFyIGtleUxvY2F0aW9uID0gb2JqLnB1c2ggPwogICAge30gOiAgLy8gYmxhbmsgb2JqZWN0IHRoYXQgd2lsbCBiZSBwdXNoZWQKICAgIG5lZWRzQmxhbmsgPyBsb2NhdGlvbltvYmoubmFtZV0gOiBsb2NhdGlvbjsgLy8gb3RoZXJ3aXNlLCBuYW1lZCBsb2NhdGlvbiBvciByb290CgogIGF0dGFjaFByb3BlcnRpZXMoY29udGVudC5tYXRjaChvYmoucmVnKSwga2V5TG9jYXRpb24sIG9iai5uYW1lcywgb2JqLm5hbWUpOwoKICBpZiAob2JqLnB1c2gpIHsKICAgIGxvY2F0aW9uW29iai5wdXNoXS5wdXNoKGtleUxvY2F0aW9uKTsKICB9Cn07Cgp2YXIgZ3JhbW1hciA9IHJlcXVpcmUoJy4vZ3JhbW1hcicpOwp2YXIgdmFsaWRMaW5lID0gUmVnRXhwLnByb3RvdHlwZS50ZXN0LmJpbmQoL14oW2Etel0pPSguKikvKTsKCmV4cG9ydHMucGFyc2UgPSBmdW5jdGlvbiAoc2RwKSB7CiAgdmFyIHNlc3Npb24gPSB7fQogICAgLCBtZWRpYSA9IFtdCiAgICAsIGxvY2F0aW9uID0gc2Vzc2lvbjsgLy8gcG9pbnRzIGF0IHdoZXJlIHByb3BlcnRpZXMgZ28gdW5kZXIgKG9uZSBvZiB0aGUgYWJvdmUpCgogIC8vIHBhcnNlIGxpbmVzIHdlIHVuZGVyc3RhbmQKICBzZHAuc3BsaXQoLyhcclxufFxyfFxuKS8pLmZpbHRlcih2YWxpZExpbmUpLmZvckVhY2goZnVuY3Rpb24gKGwpIHsKICAgIHZhciB0eXBlID0gbFswXTsKICAgIHZhciBjb250ZW50ID0gbC5zbGljZSgyKTsKICAgIGlmICh0eXBlID09PSAnbScpIHsKICAgICAgbWVkaWEucHVzaCh7cnRwOiBbXSwgZm10cDogW119KTsKICAgICAgbG9jYXRpb24gPSBtZWRpYVttZWRpYS5sZW5ndGgtMV07IC8vIHBvaW50IGF0IGxhdGVzdCBtZWRpYSBsaW5lCiAgICB9CgogICAgZm9yICh2YXIgaiA9IDA7IGogPCAoZ3JhbW1hclt0eXBlXSB8fCBbXSkubGVuZ3RoOyBqICs9IDEpIHsKICAgICAgdmFyIG9iaiA9IGdyYW1tYXJbdHlwZV1bal07CiAgICAgIGlmIChvYmoucmVnLnRlc3QoY29udGVudCkpIHsKICAgICAgICByZXR1cm4gcGFyc2VSZWcob2JqLCBsb2NhdGlvbiwgY29udGVudCk7CiAgICAgIH0KICAgIH0KICB9KTsKCiAgc2Vzc2lvbi5tZWRpYSA9IG1lZGlhOyAvLyBsaW5rIGl0IHVwCiAgcmV0dXJuIHNlc3Npb247Cn07Cgp2YXIgZm10cFJlZHVjZXIgPSBmdW5jdGlvbiAoYWNjLCBleHByKSB7CiAgdmFyIHMgPSBleHByLnNwbGl0KC89KC4rKS8sIDIpOwogIGlmIChzLmxlbmd0aCA9PT0gMikgewogICAgYWNjW3NbMF1dID0gdG9JbnRJZkludChzWzFdKTsKICB9CiAgcmV0dXJuIGFjYzsKfTsKCmV4cG9ydHMucGFyc2VGbXRwQ29uZmlnID0gZnVuY3Rpb24gKHN0cikgewogIHJldHVybiBzdHIuc3BsaXQoL1w7XHM/LykucmVkdWNlKGZtdHBSZWR1Y2VyLCB7fSk7Cn07CgpleHBvcnRzLnBhcnNlUGF5bG9hZHMgPSBmdW5jdGlvbiAoc3RyKSB7CiAgcmV0dXJuIHN0ci5zcGxpdCgnICcpLm1hcChOdW1iZXIpOwp9OwoKZXhwb3J0cy5wYXJzZVJlbW90ZUNhbmRpZGF0ZXMgPSBmdW5jdGlvbiAoc3RyKSB7CiAgdmFyIGNhbmRpZGF0ZXMgPSBbXTsKICB2YXIgcGFydHMgPSBzdHIuc3BsaXQoJyAnKS5tYXAodG9JbnRJZkludCk7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGg7IGkgKz0gMykgewogICAgY2FuZGlkYXRlcy5wdXNoKHsKICAgICAgY29tcG9uZW50OiBwYXJ0c1tpXSwKICAgICAgaXA6IHBhcnRzW2kgKyAxXSwKICAgICAgcG9ydDogcGFydHNbaSArIDJdCiAgICB9KTsKICB9CiAgcmV0dXJuIGNhbmRpZGF0ZXM7Cn07Cgp9LHsiLi9ncmFtbWFyIjoyfV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CnZhciBncmFtbWFyID0gcmVxdWlyZSgnLi9ncmFtbWFyJyk7CgovLyBjdXN0b21pemVkIHV0aWwuZm9ybWF0IC0gZGlzY2FyZHMgZXhjZXNzIGFyZ3VtZW50cyBhbmQgY2FuIHZvaWQgbWlkZGxlIG9uZXMKdmFyIGZvcm1hdFJlZ0V4cCA9IC8lW3NkdiVdL2c7CnZhciBmb3JtYXQgPSBmdW5jdGlvbiAoZm9ybWF0U3RyKSB7CiAgdmFyIGkgPSAxOwogIHZhciBhcmdzID0gYXJndW1lbnRzOwogIHZhciBsZW4gPSBhcmdzLmxlbmd0aDsKICByZXR1cm4gZm9ybWF0U3RyLnJlcGxhY2UoZm9ybWF0UmVnRXhwLCBmdW5jdGlvbiAoeCkgewogICAgaWYgKGkgPj0gbGVuKSB7CiAgICAgIHJldHVybiB4OyAvLyBtaXNzaW5nIGFyZ3VtZW50CiAgICB9CiAgICB2YXIgYXJnID0gYXJnc1tpXTsKICAgIGkgKz0gMTsKICAgIHN3aXRjaCAoeCkgewogICAgICBjYXNlICclJSc6CiAgICAgICAgcmV0dXJuICclJzsKICAgICAgY2FzZSAnJXMnOgogICAgICAgIHJldHVybiBTdHJpbmcoYXJnKTsKICAgICAgY2FzZSAnJWQnOgogICAgICAgIHJldHVybiBOdW1iZXIoYXJnKTsKICAgICAgY2FzZSAnJXYnOgogICAgICAgIHJldHVybiAnJzsKICAgIH0KICB9KTsKICAvLyBOQjogd2UgZGlzY2FyZCBleGNlc3MgYXJndW1lbnRzIC0gdGhleSBhcmUgdHlwaWNhbGx5IHVuZGVmaW5lZCBmcm9tIG1ha2VMaW5lCn07Cgp2YXIgbWFrZUxpbmUgPSBmdW5jdGlvbiAodHlwZSwgb2JqLCBsb2NhdGlvbikgewogIHZhciBzdHIgPSBvYmouZm9ybWF0IGluc3RhbmNlb2YgRnVuY3Rpb24gPwogICAgKG9iai5mb3JtYXQob2JqLnB1c2ggPyBsb2NhdGlvbiA6IGxvY2F0aW9uW29iai5uYW1lXSkpIDoKICAgIG9iai5mb3JtYXQ7CgogIHZhciBhcmdzID0gW3R5cGUgKyAnPScgKyBzdHJdOwogIGlmIChvYmoubmFtZXMpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqLm5hbWVzLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgIHZhciBuID0gb2JqLm5hbWVzW2ldOwogICAgICBpZiAob2JqLm5hbWUpIHsKICAgICAgICBhcmdzLnB1c2gobG9jYXRpb25bb2JqLm5hbWVdW25dKTsKICAgICAgfQogICAgICBlbHNlIHsgLy8gZm9yIG1MaW5lIGFuZCBwdXNoIGF0dHJpYnV0ZXMKICAgICAgICBhcmdzLnB1c2gobG9jYXRpb25bb2JqLm5hbWVzW2ldXSk7CiAgICAgIH0KICAgIH0KICB9CiAgZWxzZSB7CiAgICBhcmdzLnB1c2gobG9jYXRpb25bb2JqLm5hbWVdKTsKICB9CiAgcmV0dXJuIGZvcm1hdC5hcHBseShudWxsLCBhcmdzKTsKfTsKCi8vIFJGQyBzcGVjaWZpZWQgb3JkZXIKLy8gVE9ETzogZXh0ZW5kIHRoaXMgd2l0aCBhbGwgdGhlIHJlc3QKdmFyIGRlZmF1bHRPdXRlck9yZGVyID0gWwogICd2JywgJ28nLCAncycsICdpJywKICAndScsICdlJywgJ3AnLCAnYycsCiAgJ2InLCAndCcsICdyJywgJ3onLCAnYScKXTsKdmFyIGRlZmF1bHRJbm5lck9yZGVyID0gWydpJywgJ2MnLCAnYicsICdhJ107CgoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoc2Vzc2lvbiwgb3B0cykgewogIG9wdHMgPSBvcHRzIHx8IHt9OwogIC8vIGVuc3VyZSBjZXJ0YWluIHByb3BlcnRpZXMgZXhpc3QKICBpZiAoc2Vzc2lvbi52ZXJzaW9uID09IG51bGwpIHsKICAgIHNlc3Npb24udmVyc2lvbiA9IDA7IC8vICJ2PTAiIG11c3QgYmUgdGhlcmUgKG9ubHkgZGVmaW5lZCB2ZXJzaW9uIGF0bSkKICB9CiAgaWYgKHNlc3Npb24ubmFtZSA9PSBudWxsKSB7CiAgICBzZXNzaW9uLm5hbWUgPSAiICI7IC8vICJzPSAiIG11c3QgYmUgdGhlcmUgaWYgbm8gbWVhbmluZ2Z1bCBuYW1lIHNldAogIH0KICBzZXNzaW9uLm1lZGlhLmZvckVhY2goZnVuY3Rpb24gKG1MaW5lKSB7CiAgICBpZiAobUxpbmUucGF5bG9hZHMgPT0gbnVsbCkgewogICAgICBtTGluZS5wYXlsb2FkcyA9ICIiOwogICAgfQogIH0pOwoKICB2YXIgb3V0ZXJPcmRlciA9IG9wdHMub3V0ZXJPcmRlciB8fCBkZWZhdWx0T3V0ZXJPcmRlcjsKICB2YXIgaW5uZXJPcmRlciA9IG9wdHMuaW5uZXJPcmRlciB8fCBkZWZhdWx0SW5uZXJPcmRlcjsKICB2YXIgc2RwID0gW107CgogIC8vIGxvb3AgdGhyb3VnaCBvdXRlck9yZGVyIGZvciBtYXRjaGluZyBwcm9wZXJ0aWVzIG9uIHNlc3Npb24KICBvdXRlck9yZGVyLmZvckVhY2goZnVuY3Rpb24gKHR5cGUpIHsKICAgIGdyYW1tYXJbdHlwZV0uZm9yRWFjaChmdW5jdGlvbiAob2JqKSB7CiAgICAgIGlmIChvYmoubmFtZSBpbiBzZXNzaW9uICYmIHNlc3Npb25bb2JqLm5hbWVdICE9IG51bGwpIHsKICAgICAgICBzZHAucHVzaChtYWtlTGluZSh0eXBlLCBvYmosIHNlc3Npb24pKTsKICAgICAgfQogICAgICBlbHNlIGlmIChvYmoucHVzaCBpbiBzZXNzaW9uICYmIHNlc3Npb25bb2JqLnB1c2hdICE9IG51bGwpIHsKICAgICAgICBzZXNzaW9uW29iai5wdXNoXS5mb3JFYWNoKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgc2RwLnB1c2gobWFrZUxpbmUodHlwZSwgb2JqLCBlbCkpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICB9KTsKCiAgLy8gdGhlbiBmb3IgZWFjaCBtZWRpYSBsaW5lLCBmb2xsb3cgdGhlIGlubmVyT3JkZXIKICBzZXNzaW9uLm1lZGlhLmZvckVhY2goZnVuY3Rpb24gKG1MaW5lKSB7CiAgICBzZHAucHVzaChtYWtlTGluZSgnbScsIGdyYW1tYXIubVswXSwgbUxpbmUpKTsKCiAgICBpbm5lck9yZGVyLmZvckVhY2goZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgZ3JhbW1hclt0eXBlXS5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICBpZiAob2JqLm5hbWUgaW4gbUxpbmUgJiYgbUxpbmVbb2JqLm5hbWVdICE9IG51bGwpIHsKICAgICAgICAgIHNkcC5wdXNoKG1ha2VMaW5lKHR5cGUsIG9iaiwgbUxpbmUpKTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAob2JqLnB1c2ggaW4gbUxpbmUgJiYgbUxpbmVbb2JqLnB1c2hdICE9IG51bGwpIHsKICAgICAgICAgIG1MaW5lW29iai5wdXNoXS5mb3JFYWNoKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICBzZHAucHVzaChtYWtlTGluZSh0eXBlLCBvYmosIGVsKSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgfSk7CgogIHJldHVybiBzZHAuam9pbignXHJcbicpICsgJ1xyXG4nOwp9OwoKfSx7Ii4vZ3JhbW1hciI6Mn1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovLyB2ZXJzaW9uOiAwLjUuMQovLyBkYXRlOiBUaHUgQXByIDEzIDIwMTcgMjM6NTE6MjggR01UKzAxMDAgKEdNVCBEYXlsaWdodCBUaW1lKQovLyBsaWNlbmNlOiAKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgoKKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiRGlzY292ZXJ5IiwgW10sIGZhY3RvcnkpOwoJZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpCgkJZXhwb3J0c1siRGlzY292ZXJ5Il0gPSBmYWN0b3J5KCk7CgllbHNlCgkJcm9vdFsiIl0gPSByb290WyIiXSB8fCB7fSwgcm9vdFsiIl1bIkRpc2NvdmVyeSJdID0gZmFjdG9yeSgpOwp9KSh0aGlzLCBmdW5jdGlvbigpIHsKcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXAKLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCXZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307Ci8qKioqKiovCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLwovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQovKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJaTogbW9kdWxlSWQsCi8qKioqKiovIAkJCWw6IGZhbHNlLAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAovKioqKioqLyAJCW1vZHVsZS5sID0gdHJ1ZTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8KLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7Ci8qKioqKiovCi8qKioqKiovIAkvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0Ci8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHMKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikgewovKioqKioqLyAJCWlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKLyoqKioqKi8gCQkJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsKLyoqKioqKi8gCQkJCWNvbmZpZ3VyYWJsZTogZmFsc2UsCi8qKioqKiovIAkJCQllbnVtZXJhYmxlOiB0cnVlLAovKioqKioqLyAJCQkJZ2V0OiBnZXR0ZXIKLyoqKioqKi8gCQkJfSk7Ci8qKioqKiovIAkJfQovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHsKLyoqKioqKi8gCQl2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID8KLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTsKLyoqKioqKi8gCQlfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7Ci8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKLyoqKioqKi8KLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMTM2KTsKLyoqKioqKi8gfSkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gKFsKLyogMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0ge3ZlcnNpb246ICcyLjQuMCd9OwppZih0eXBlb2YgX19lID09ICdudW1iZXInKV9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy84NiNpc3N1ZWNvbW1lbnQtMTE1NzU5MDI4CnZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aAogID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsKaWYodHlwZW9mIF9fZyA9PSAnbnVtYmVyJylfX2cgPSBnbG9iYWw7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHkKbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzdG9yZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ3drcycpCiAgLCB1aWQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykKICAsIFN5bWJvbCAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLlN5bWJvbAogICwgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJzsKCnZhciAkZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obmFtZSl7CiAgcmV0dXJuIHN0b3JlW25hbWVdIHx8IChzdG9yZVtuYW1lXSA9CiAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IHVpZCkoJ1N5bWJvbC4nICsgbmFtZSkpOwp9OwoKJGV4cG9ydHMuc3RvcmUgPSBzdG9yZTsKCi8qKiovIH0pLAovKiA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIGRQICAgICAgICAgICAgID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpewogIGFuT2JqZWN0KE8pOwogIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKICBhbk9iamVjdChBdHRyaWJ1dGVzKTsKICBpZihJRThfRE9NX0RFRklORSl0cnkgewogICAgcmV0dXJuIGRQKE8sIFAsIEF0dHJpYnV0ZXMpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICBpZignZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpdGhyb3cgVHlwZUVycm9yKCdBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEnKTsKICBpZigndmFsdWUnIGluIEF0dHJpYnV0ZXMpT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZighaXNPYmplY3QoaXQpKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nOwp9OwoKLyoqKi8gfSksCi8qIDcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRQICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBjcmVhdGVEZXNjID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSA/IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7CiAgcmV0dXJuIGRQLmYob2JqZWN0LCBrZXksIGNyZWF0ZURlc2MoMSwgdmFsdWUpKTsKfSA6IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7CiAgb2JqZWN0W2tleV0gPSB2YWx1ZTsKICByZXR1cm4gb2JqZWN0Owp9OwoKLyoqKi8gfSksCi8qIDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfTsKCi8qKiovIH0pLAovKiA5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBjdHggICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgaGlkZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KQogICwgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7Cgp2YXIgJGV4cG9ydCA9IGZ1bmN0aW9uKHR5cGUsIG5hbWUsIHNvdXJjZSl7CiAgdmFyIElTX0ZPUkNFRCA9IHR5cGUgJiAkZXhwb3J0LkYKICAgICwgSVNfR0xPQkFMID0gdHlwZSAmICRleHBvcnQuRwogICAgLCBJU19TVEFUSUMgPSB0eXBlICYgJGV4cG9ydC5TCiAgICAsIElTX1BST1RPICA9IHR5cGUgJiAkZXhwb3J0LlAKICAgICwgSVNfQklORCAgID0gdHlwZSAmICRleHBvcnQuQgogICAgLCBJU19XUkFQICAgPSB0eXBlICYgJGV4cG9ydC5XCiAgICAsIGV4cG9ydHMgICA9IElTX0dMT0JBTCA/IGNvcmUgOiBjb3JlW25hbWVdIHx8IChjb3JlW25hbWVdID0ge30pCiAgICAsIGV4cFByb3RvICA9IGV4cG9ydHNbUFJPVE9UWVBFXQogICAgLCB0YXJnZXQgICAgPSBJU19HTE9CQUwgPyBnbG9iYWwgOiBJU19TVEFUSUMgPyBnbG9iYWxbbmFtZV0gOiAoZ2xvYmFsW25hbWVdIHx8IHt9KVtQUk9UT1RZUEVdCiAgICAsIGtleSwgb3duLCBvdXQ7CiAgaWYoSVNfR0xPQkFMKXNvdXJjZSA9IG5hbWU7CiAgZm9yKGtleSBpbiBzb3VyY2UpewogICAgLy8gY29udGFpbnMgaW4gbmF0aXZlCiAgICBvd24gPSAhSVNfRk9SQ0VEICYmIHRhcmdldCAmJiB0YXJnZXRba2V5XSAhPT0gdW5kZWZpbmVkOwogICAgaWYob3duICYmIGtleSBpbiBleHBvcnRzKWNvbnRpbnVlOwogICAgLy8gZXhwb3J0IG5hdGl2ZSBvciBwYXNzZWQKICAgIG91dCA9IG93biA/IHRhcmdldFtrZXldIDogc291cmNlW2tleV07CiAgICAvLyBwcmV2ZW50IGdsb2JhbCBwb2xsdXRpb24gZm9yIG5hbWVzcGFjZXMKICAgIGV4cG9ydHNba2V5XSA9IElTX0dMT0JBTCAmJiB0eXBlb2YgdGFyZ2V0W2tleV0gIT0gJ2Z1bmN0aW9uJyA/IHNvdXJjZVtrZXldCiAgICAvLyBiaW5kIHRpbWVycyB0byBnbG9iYWwgZm9yIGNhbGwgZnJvbSBleHBvcnQgY29udGV4dAogICAgOiBJU19CSU5EICYmIG93biA/IGN0eChvdXQsIGdsb2JhbCkKICAgIC8vIHdyYXAgZ2xvYmFsIGNvbnN0cnVjdG9ycyBmb3IgcHJldmVudCBjaGFuZ2UgdGhlbSBpbiBsaWJyYXJ5CiAgICA6IElTX1dSQVAgJiYgdGFyZ2V0W2tleV0gPT0gb3V0ID8gKGZ1bmN0aW9uKEMpewogICAgICB2YXIgRiA9IGZ1bmN0aW9uKGEsIGIsIGMpewogICAgICAgIGlmKHRoaXMgaW5zdGFuY2VvZiBDKXsKICAgICAgICAgIHN3aXRjaChhcmd1bWVudHMubGVuZ3RoKXsKICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gbmV3IEM7CiAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIG5ldyBDKGEpOwogICAgICAgICAgICBjYXNlIDI6IHJldHVybiBuZXcgQyhhLCBiKTsKICAgICAgICAgIH0gcmV0dXJuIG5ldyBDKGEsIGIsIGMpOwogICAgICAgIH0gcmV0dXJuIEMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgICAgRltQUk9UT1RZUEVdID0gQ1tQUk9UT1RZUEVdOwogICAgICByZXR1cm4gRjsKICAgIC8vIG1ha2Ugc3RhdGljIHZlcnNpb25zIGZvciBwcm90b3R5cGUgbWV0aG9kcwogICAgfSkob3V0KSA6IElTX1BST1RPICYmIHR5cGVvZiBvdXQgPT0gJ2Z1bmN0aW9uJyA/IGN0eChGdW5jdGlvbi5jYWxsLCBvdXQpIDogb3V0OwogICAgLy8gZXhwb3J0IHByb3RvIG1ldGhvZHMgdG8gY29yZS4lQ09OU1RSVUNUT1IlLm1ldGhvZHMuJU5BTUUlCiAgICBpZihJU19QUk9UTyl7CiAgICAgIChleHBvcnRzLnZpcnR1YWwgfHwgKGV4cG9ydHMudmlydHVhbCA9IHt9KSlba2V5XSA9IG91dDsKICAgICAgLy8gZXhwb3J0IHByb3RvIG1ldGhvZHMgdG8gY29yZS4lQ09OU1RSVUNUT1IlLnByb3RvdHlwZS4lTkFNRSUKICAgICAgaWYodHlwZSAmICRleHBvcnQuUiAmJiBleHBQcm90byAmJiAhZXhwUHJvdG9ba2V5XSloaWRlKGV4cFByb3RvLCBrZXksIG91dCk7CiAgICB9CiAgfQp9OwovLyB0eXBlIGJpdG1hcAokZXhwb3J0LkYgPSAxOyAgIC8vIGZvcmNlZAokZXhwb3J0LkcgPSAyOyAgIC8vIGdsb2JhbAokZXhwb3J0LlMgPSA0OyAgIC8vIHN0YXRpYwokZXhwb3J0LlAgPSA4OyAgIC8vIHByb3RvCiRleHBvcnQuQiA9IDE2OyAgLy8gYmluZAokZXhwb3J0LlcgPSAzMjsgIC8vIHdyYXAKJGV4cG9ydC5VID0gNjQ7ICAvLyBzYWZlCiRleHBvcnQuUiA9IDEyODsgLy8gcmVhbCBwcm90byBtZXRob2QgZm9yIGBsaWJyYXJ5YCAKbW9kdWxlLmV4cG9ydHMgPSAkZXhwb3J0OwoKLyoqKi8gfSksCi8qIDEwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMzMpOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZWZpbmVQcm9wZXJ0eSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICAgICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogICAgfQogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICAgIHJldHVybiBDb25zdHJ1Y3RvcjsKICB9Owp9KCk7CgovKioqLyB9KSwKLyogMTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjKXsKICB0cnkgewogICAgcmV0dXJuICEhZXhlYygpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn07CgovKioqLyB9KSwKLyogMTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGhhc093blByb3BlcnR5ID0ge30uaGFzT3duUHJvcGVydHk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIGtleSl7CiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoaXQsIGtleSk7Cn07CgovKioqLyB9KSwKLyogMTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzCnZhciBJT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NikKICAsIGRlZmluZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpOwp9OwoKLyoqKi8gfSksCi8qIDE0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZwp2YXIgYUZ1bmN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIHRoYXQsIGxlbmd0aCl7CiAgYUZ1bmN0aW9uKGZuKTsKICBpZih0aGF0ID09PSB1bmRlZmluZWQpcmV0dXJuIGZuOwogIHN3aXRjaChsZW5ndGgpewogICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpOwogICAgfTsKICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTsKICAgIH07CiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7CiAgICB9OwogIH0KICByZXR1cm4gZnVuY3Rpb24oLyogLi4uYXJncyAqLyl7CiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDE1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYml0bWFwLCB2YWx1ZSl7CiAgcmV0dXJuIHsKICAgIGVudW1lcmFibGUgIDogIShiaXRtYXAgJiAxKSwKICAgIGNvbmZpZ3VyYWJsZTogIShiaXRtYXAgJiAyKSwKICAgIHdyaXRhYmxlICAgIDogIShiaXRtYXAgJiA0KSwKICAgIHZhbHVlICAgICAgIDogdmFsdWUKICB9Owp9OwoKLyoqKi8gfSksCi8qIDE2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0ge307CgovKioqLyB9KSwKLyogMTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgZG9jdW1lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLmRvY3VtZW50CiAgLy8gaW4gb2xkIElFIHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFbGVtZW50IGlzICdvYmplY3QnCiAgLCBpcyA9IGlzT2JqZWN0KGRvY3VtZW50KSAmJiBpc09iamVjdChkb2N1bWVudC5jcmVhdGVFbGVtZW50KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGlzID8gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChpdCkgOiB7fTsKfTsKCi8qKiovIH0pLAovKiAxOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuMTQgLyAxNS4yLjMuMTQgT2JqZWN0LmtleXMoTykKdmFyICRrZXlzICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NCkKICAsIGVudW1CdWdLZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSk7Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIGtleXMoTyl7CiAgcmV0dXJuICRrZXlzKE8sIGVudW1CdWdLZXlzKTsKfTsKCi8qKiovIH0pLAovKiAxOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZih0eXBlb2YgaXQgIT0gJ2Z1bmN0aW9uJyl0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhIGZ1bmN0aW9uIScpOwogIHJldHVybiBpdDsKfTsKCi8qKiovIH0pLAovKiAyMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZzsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiB0b1N0cmluZy5jYWxsKGl0KS5zbGljZSg4LCAtMSk7Cn07CgovKioqLyB9KSwKLyogMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjEgVG9QcmltaXRpdmUoaW5wdXQgWywgUHJlZmVycmVkVHlwZV0pCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNik7Ci8vIGluc3RlYWQgb2YgdGhlIEVTNiBzcGVjIHZlcnNpb24sIHdlIGRpZG4ndCBpbXBsZW1lbnQgQEB0b1ByaW1pdGl2ZSBjYXNlCi8vIGFuZCB0aGUgc2Vjb25kIGFyZ3VtZW50IC0gZmxhZyAtIHByZWZlcnJlZCB0eXBlIGlzIGEgc3RyaW5nCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIFMpewogIGlmKCFpc09iamVjdChpdCkpcmV0dXJuIGl0OwogIHZhciBmbiwgdmFsOwogIGlmKFMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICBpZih0eXBlb2YgKGZuID0gaXQudmFsdWVPZikgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKXJldHVybiB2YWw7CiAgaWYoIVMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpOwp9OwoKLyoqKi8gfSksCi8qIDIyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBkZWYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmYKICAsIGhhcyA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBUQUcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCd0b1N0cmluZ1RhZycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgdGFnLCBzdGF0KXsKICBpZihpdCAmJiAhaGFzKGl0ID0gc3RhdCA/IGl0IDogaXQucHJvdG90eXBlLCBUQUcpKWRlZihpdCwgVEFHLCB7Y29uZmlndXJhYmxlOiB0cnVlLCB2YWx1ZTogdGFnfSk7Cn07CgovKioqLyB9KSwKLyogMjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGlkID0gMAogICwgcHggPSBNYXRoLnJhbmRvbSgpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7CiAgcmV0dXJuICdTeW1ib2woJy5jb25jYXQoa2V5ID09PSB1bmRlZmluZWQgPyAnJyA6IGtleSwgJylfJywgKCsraWQgKyBweCkudG9TdHJpbmcoMzYpKTsKfTsKCi8qKiovIH0pLAovKiAyNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyA3LjIuMSBSZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGFyZ3VtZW50KQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIiArIGl0KTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygyKSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KF9fd2VicGFja19yZXF1aXJlX18oMTcpKCdkaXYnKSwgJ2EnLCB7Z2V0OiBmdW5jdGlvbigpeyByZXR1cm4gNzsgfX0pLmEgIT0gNzsKfSk7CgovKioqLyB9KSwKLyogMjYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSB0cnVlOwoKLyoqKi8gfSksCi8qIDI3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzaGFyZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKSgna2V5cycpCiAgLCB1aWQgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzaGFyZWRba2V5XSB8fCAoc2hhcmVkW2tleV0gPSB1aWQoa2V5KSk7Cn07CgovKioqLyB9KSwKLyogMjggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gNy4xLjQgVG9JbnRlZ2VyCnZhciBjZWlsICA9IE1hdGguY2VpbAogICwgZmxvb3IgPSBNYXRoLmZsb29yOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXNOYU4oaXQgPSAraXQpID8gMCA6IChpdCA+IDAgPyBmbG9vciA6IGNlaWwpKGl0KTsKfTsKCi8qKiovIH0pLAovKiAyOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzCm1vZHVsZS5leHBvcnRzID0gKAogICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnCikuc3BsaXQoJywnKTsKCi8qKiovIH0pLAovKiAzMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXycKICAsIHN0b3JlICA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzdG9yZVtrZXldIHx8IChzdG9yZVtrZXldID0ge30pOwp9OwoKLyoqKi8gfSksCi8qIDMxICovLAovKiAzMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMTMgVG9PYmplY3QoYXJndW1lbnQpCnZhciBkZWZpbmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBPYmplY3QoZGVmaW5lZChpdCkpOwp9OwoKLyoqKi8gfSksCi8qIDMzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oMzYpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogMzQgKi8sCi8qIDM1ICovLAovKiAzNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKXsKICByZXR1cm4gJE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKTsKfTsKCi8qKiovIH0pLAovKiAzNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKdmFyIGFuT2JqZWN0ICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQogICwgZFBzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY0KQogICwgZW51bUJ1Z0tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KQogICwgSUVfUFJPVE8gICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KSgnSUVfUFJPVE8nKQogICwgRW1wdHkgICAgICAgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9CiAgLCBQUk9UT1RZUEUgICA9ICdwcm90b3R5cGUnOwoKLy8gQ3JlYXRlIG9iamVjdCB3aXRoIGZha2UgYG51bGxgIHByb3RvdHlwZTogdXNlIGlmcmFtZSBPYmplY3Qgd2l0aCBjbGVhcmVkIHByb3RvdHlwZQp2YXIgY3JlYXRlRGljdCA9IGZ1bmN0aW9uKCl7CiAgLy8gVGhyYXNoLCB3YXN0ZSBhbmQgc29kb215OiBJRSBHQyBidWcKICB2YXIgaWZyYW1lID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykoJ2lmcmFtZScpCiAgICAsIGkgICAgICA9IGVudW1CdWdLZXlzLmxlbmd0aAogICAgLCBsdCAgICAgPSAnPCcKICAgICwgZ3QgICAgID0gJz4nCiAgICAsIGlmcmFtZURvY3VtZW50OwogIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogIF9fd2VicGFja19yZXF1aXJlX18oNDIpLmFwcGVuZENoaWxkKGlmcmFtZSk7CiAgaWZyYW1lLnNyYyA9ICdqYXZhc2NyaXB0Oic7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2NyaXB0LXVybAogIC8vIGNyZWF0ZURpY3QgPSBpZnJhbWUuY29udGVudFdpbmRvdy5PYmplY3Q7CiAgLy8gaHRtbC5yZW1vdmVDaGlsZChpZnJhbWUpOwogIGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7CiAgaWZyYW1lRG9jdW1lbnQub3BlbigpOwogIGlmcmFtZURvY3VtZW50LndyaXRlKGx0ICsgJ3NjcmlwdCcgKyBndCArICdkb2N1bWVudC5GPU9iamVjdCcgKyBsdCArICcvc2NyaXB0JyArIGd0KTsKICBpZnJhbWVEb2N1bWVudC5jbG9zZSgpOwogIGNyZWF0ZURpY3QgPSBpZnJhbWVEb2N1bWVudC5GOwogIHdoaWxlKGktLSlkZWxldGUgY3JlYXRlRGljdFtQUk9UT1RZUEVdW2VudW1CdWdLZXlzW2ldXTsKICByZXR1cm4gY3JlYXRlRGljdCgpOwp9OwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuY3JlYXRlIHx8IGZ1bmN0aW9uIGNyZWF0ZShPLCBQcm9wZXJ0aWVzKXsKICB2YXIgcmVzdWx0OwogIGlmKE8gIT09IG51bGwpewogICAgRW1wdHlbUFJPVE9UWVBFXSA9IGFuT2JqZWN0KE8pOwogICAgcmVzdWx0ID0gbmV3IEVtcHR5OwogICAgRW1wdHlbUFJPVE9UWVBFXSA9IG51bGw7CiAgICAvLyBhZGQgIl9fcHJvdG9fXyIgZm9yIE9iamVjdC5nZXRQcm90b3R5cGVPZiBwb2x5ZmlsbAogICAgcmVzdWx0W0lFX1BST1RPXSA9IE87CiAgfSBlbHNlIHJlc3VsdCA9IGNyZWF0ZURpY3QoKTsKICByZXR1cm4gUHJvcGVydGllcyA9PT0gdW5kZWZpbmVkID8gcmVzdWx0IDogZFBzKHJlc3VsdCwgUHJvcGVydGllcyk7Cn07CgoKLyoqKi8gfSksCi8qIDM4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKLy8gMTkuMS4yLjQgLyAxNS4yLjMuNiBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhX193ZWJwYWNrX3JlcXVpcmVfXygyKSwgJ09iamVjdCcsIHtkZWZpbmVQcm9wZXJ0eTogX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mfSk7CgovKioqLyB9KSwKLyogMzkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIExJQlJBUlkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNikKICAsICRleHBvcnQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KQogICwgcmVkZWZpbmUgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ2KQogICwgaGlkZSAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBoYXMgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBJdGVyYXRvcnMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCiAgLCAkaXRlckNyZWF0ZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjIpCiAgLCBzZXRUb1N0cmluZ1RhZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjIpCiAgLCBnZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oNDMpCiAgLCBJVEVSQVRPUiAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMykoJ2l0ZXJhdG9yJykKICAsIEJVR0dZICAgICAgICAgID0gIShbXS5rZXlzICYmICduZXh0JyBpbiBbXS5rZXlzKCkpIC8vIFNhZmFyaSBoYXMgYnVnZ3kgaXRlcmF0b3JzIHcvbyBgbmV4dGAKICAsIEZGX0lURVJBVE9SICAgID0gJ0BAaXRlcmF0b3InCiAgLCBLRVlTICAgICAgICAgICA9ICdrZXlzJwogICwgVkFMVUVTICAgICAgICAgPSAndmFsdWVzJzsKCnZhciByZXR1cm5UaGlzID0gZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH07Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEJhc2UsIE5BTUUsIENvbnN0cnVjdG9yLCBuZXh0LCBERUZBVUxULCBJU19TRVQsIEZPUkNFRCl7CiAgJGl0ZXJDcmVhdGUoQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpOwogIHZhciBnZXRNZXRob2QgPSBmdW5jdGlvbihraW5kKXsKICAgIGlmKCFCVUdHWSAmJiBraW5kIGluIHByb3RvKXJldHVybiBwcm90b1traW5kXTsKICAgIHN3aXRjaChraW5kKXsKICAgICAgY2FzZSBLRVlTOiByZXR1cm4gZnVuY3Rpb24ga2V5cygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9OwogICAgICBjYXNlIFZBTFVFUzogcmV0dXJuIGZ1bmN0aW9uIHZhbHVlcygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9OwogICAgfSByZXR1cm4gZnVuY3Rpb24gZW50cmllcygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9OwogIH07CiAgdmFyIFRBRyAgICAgICAgPSBOQU1FICsgJyBJdGVyYXRvcicKICAgICwgREVGX1ZBTFVFUyA9IERFRkFVTFQgPT0gVkFMVUVTCiAgICAsIFZBTFVFU19CVUcgPSBmYWxzZQogICAgLCBwcm90byAgICAgID0gQmFzZS5wcm90b3R5cGUKICAgICwgJG5hdGl2ZSAgICA9IHByb3RvW0lURVJBVE9SXSB8fCBwcm90b1tGRl9JVEVSQVRPUl0gfHwgREVGQVVMVCAmJiBwcm90b1tERUZBVUxUXQogICAgLCAkZGVmYXVsdCAgID0gJG5hdGl2ZSB8fCBnZXRNZXRob2QoREVGQVVMVCkKICAgICwgJGVudHJpZXMgICA9IERFRkFVTFQgPyAhREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKCdlbnRyaWVzJykgOiB1bmRlZmluZWQKICAgICwgJGFueU5hdGl2ZSA9IE5BTUUgPT0gJ0FycmF5JyA/IHByb3RvLmVudHJpZXMgfHwgJG5hdGl2ZSA6ICRuYXRpdmUKICAgICwgbWV0aG9kcywga2V5LCBJdGVyYXRvclByb3RvdHlwZTsKICAvLyBGaXggbmF0aXZlCiAgaWYoJGFueU5hdGl2ZSl7CiAgICBJdGVyYXRvclByb3RvdHlwZSA9IGdldFByb3RvdHlwZU9mKCRhbnlOYXRpdmUuY2FsbChuZXcgQmFzZSkpOwogICAgaWYoSXRlcmF0b3JQcm90b3R5cGUgIT09IE9iamVjdC5wcm90b3R5cGUpewogICAgICAvLyBTZXQgQEB0b1N0cmluZ1RhZyB0byBuYXRpdmUgaXRlcmF0b3JzCiAgICAgIHNldFRvU3RyaW5nVGFnKEl0ZXJhdG9yUHJvdG90eXBlLCBUQUcsIHRydWUpOwogICAgICAvLyBmaXggZm9yIHNvbWUgb2xkIGVuZ2luZXMKICAgICAgaWYoIUxJQlJBUlkgJiYgIWhhcyhJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IpKWhpZGUoSXRlcmF0b3JQcm90b3R5cGUsIElURVJBVE9SLCByZXR1cm5UaGlzKTsKICAgIH0KICB9CiAgLy8gZml4IEFycmF5I3t2YWx1ZXMsIEBAaXRlcmF0b3J9Lm5hbWUgaW4gVjggLyBGRgogIGlmKERFRl9WQUxVRVMgJiYgJG5hdGl2ZSAmJiAkbmF0aXZlLm5hbWUgIT09IFZBTFVFUyl7CiAgICBWQUxVRVNfQlVHID0gdHJ1ZTsKICAgICRkZWZhdWx0ID0gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiAkbmF0aXZlLmNhbGwodGhpcyk7IH07CiAgfQogIC8vIERlZmluZSBpdGVyYXRvcgogIGlmKCghTElCUkFSWSB8fCBGT1JDRUQpICYmIChCVUdHWSB8fCBWQUxVRVNfQlVHIHx8ICFwcm90b1tJVEVSQVRPUl0pKXsKICAgIGhpZGUocHJvdG8sIElURVJBVE9SLCAkZGVmYXVsdCk7CiAgfQogIC8vIFBsdWcgZm9yIGxpYnJhcnkKICBJdGVyYXRvcnNbTkFNRV0gPSAkZGVmYXVsdDsKICBJdGVyYXRvcnNbVEFHXSAgPSByZXR1cm5UaGlzOwogIGlmKERFRkFVTFQpewogICAgbWV0aG9kcyA9IHsKICAgICAgdmFsdWVzOiAgREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKFZBTFVFUyksCiAgICAgIGtleXM6ICAgIElTX1NFVCAgICAgPyAkZGVmYXVsdCA6IGdldE1ldGhvZChLRVlTKSwKICAgICAgZW50cmllczogJGVudHJpZXMKICAgIH07CiAgICBpZihGT1JDRUQpZm9yKGtleSBpbiBtZXRob2RzKXsKICAgICAgaWYoIShrZXkgaW4gcHJvdG8pKXJlZGVmaW5lKHByb3RvLCBrZXksIG1ldGhvZHNba2V5XSk7CiAgICB9IGVsc2UgJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAoQlVHR1kgfHwgVkFMVUVTX0JVRyksIE5BTUUsIG1ldGhvZHMpOwogIH0KICByZXR1cm4gbWV0aG9kczsKfTsKCi8qKiovIH0pLAovKiA0MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDUzKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDQxICovLAovKiA0MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZG9jdW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKLyoqKi8gfSksCi8qIDQzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi45IC8gMTUuMi4zLjIgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciBoYXMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCB0b09iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpKCdJRV9QUk9UTycpCiAgLCBPYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihPKXsKICBPID0gdG9PYmplY3QoTyk7CiAgaWYoaGFzKE8sIElFX1BST1RPKSlyZXR1cm4gT1tJRV9QUk9UT107CiAgaWYodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcil7CiAgICByZXR1cm4gTy5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7CiAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvIDogbnVsbDsKfTsKCi8qKiovIH0pLAovKiA0NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaGFzICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIHRvSU9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCBhcnJheUluZGV4T2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKShmYWxzZSkKICAsIElFX1BST1RPICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpKCdJRV9QUk9UTycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIG5hbWVzKXsKICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKICAgICwgaSAgICAgID0gMAogICAgLCByZXN1bHQgPSBbXQogICAgLCBrZXk7CiAgZm9yKGtleSBpbiBPKWlmKGtleSAhPSBJRV9QUk9UTyloYXMoTywga2V5KSAmJiByZXN1bHQucHVzaChrZXkpOwogIC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXMKICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKWlmKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSl7CiAgICB+YXJyYXlJbmRleE9mKHJlc3VsdCwga2V5KSB8fCByZXN1bHQucHVzaChrZXkpOwogIH0KICByZXR1cm4gcmVzdWx0Owp9OwoKLyoqKi8gfSksCi8qIDQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG1vc3QgT2JqZWN0IG1ldGhvZHMgYnkgRVM2IHNob3VsZCBhY2NlcHQgcHJpbWl0aXZlcwp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOSkKICAsIGNvcmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBmYWlscyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBleGVjKXsKICB2YXIgZm4gID0gKGNvcmUuT2JqZWN0IHx8IHt9KVtLRVldIHx8IE9iamVjdFtLRVldCiAgICAsIGV4cCA9IHt9OwogIGV4cFtLRVldID0gZXhlYyhmbik7CiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbigpeyBmbigxKTsgfSksICdPYmplY3QnLCBleHApOwp9OwoKLyoqKi8gfSksCi8qIDQ2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKCi8qKiovIH0pLAovKiA0NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMTUgVG9MZW5ndGgKdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCiAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ID4gMCA/IG1pbih0b0ludGVnZXIoaXQpLCAweDFmZmZmZmZmZmZmZmZmKSA6IDA7IC8vIHBvdygyLCA1MykgLSAxID09IDkwMDcxOTkyNTQ3NDA5OTEKfTsKCi8qKiovIH0pLAovKiA0OCAqLywKLyogNDkgKi8sCi8qIDUwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciAkYXQgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2NikodHJ1ZSk7CgovLyAyMS4xLjMuMjcgU3RyaW5nLnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpCl9fd2VicGFja19yZXF1aXJlX18oMzkpKFN0cmluZywgJ1N0cmluZycsIGZ1bmN0aW9uKGl0ZXJhdGVkKXsKICB0aGlzLl90ID0gU3RyaW5nKGl0ZXJhdGVkKTsgLy8gdGFyZ2V0CiAgdGhpcy5faSA9IDA7ICAgICAgICAgICAgICAgIC8vIG5leHQgaW5kZXgKLy8gMjEuMS41LjIuMSAlU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUlLm5leHQoKQp9LCBmdW5jdGlvbigpewogIHZhciBPICAgICA9IHRoaXMuX3QKICAgICwgaW5kZXggPSB0aGlzLl9pCiAgICAsIHBvaW50OwogIGlmKGluZGV4ID49IE8ubGVuZ3RoKXJldHVybiB7dmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZX07CiAgcG9pbnQgPSAkYXQoTywgaW5kZXgpOwogIHRoaXMuX2kgKz0gcG9pbnQubGVuZ3RoOwogIHJldHVybiB7dmFsdWU6IHBvaW50LCBkb25lOiBmYWxzZX07Cn0pOwoKLyoqKi8gfSksCi8qIDUxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNjkpOwp2YXIgZ2xvYmFsICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGhpZGUgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBJdGVyYXRvcnMgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIFRPX1NUUklOR19UQUcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCd0b1N0cmluZ1RhZycpOwoKZm9yKHZhciBjb2xsZWN0aW9ucyA9IFsnTm9kZUxpc3QnLCAnRE9NVG9rZW5MaXN0JywgJ01lZGlhTGlzdCcsICdTdHlsZVNoZWV0TGlzdCcsICdDU1NSdWxlTGlzdCddLCBpID0gMDsgaSA8IDU7IGkrKyl7CiAgdmFyIE5BTUUgICAgICAgPSBjb2xsZWN0aW9uc1tpXQogICAgLCBDb2xsZWN0aW9uID0gZ2xvYmFsW05BTUVdCiAgICAsIHByb3RvICAgICAgPSBDb2xsZWN0aW9uICYmIENvbGxlY3Rpb24ucHJvdG90eXBlOwogIGlmKHByb3RvICYmICFwcm90b1tUT19TVFJJTkdfVEFHXSloaWRlKHByb3RvLCBUT19TVFJJTkdfVEFHLCBOQU1FKTsKICBJdGVyYXRvcnNbTkFNRV0gPSBJdGVyYXRvcnMuQXJyYXk7Cn0KCi8qKiovIH0pLAovKiA1MiAqLywKLyogNTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGNvcmUgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQogICwgJEpTT04gPSBjb3JlLkpTT04gfHwgKGNvcmUuSlNPTiA9IHtzdHJpbmdpZnk6IEpTT04uc3RyaW5naWZ5fSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycwogIHJldHVybiAkSlNPTi5zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3VtZW50cyk7Cn07CgovKioqLyB9KSwKLyogNTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCgovKioqLyB9KSwKLyogNTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZ2V0dGluZyB0YWcgZnJvbSAxOS4xLjMuNiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nKCkKdmFyIGNvZiA9IF9fd2VicGFja19yZXF1aXJlX18oMjApCiAgLCBUQUcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCd0b1N0cmluZ1RhZycpCiAgLy8gRVMzIHdyb25nIGhlcmUKICAsIEFSRyA9IGNvZihmdW5jdGlvbigpeyByZXR1cm4gYXJndW1lbnRzOyB9KCkpID09ICdBcmd1bWVudHMnOwoKLy8gZmFsbGJhY2sgZm9yIElFMTEgU2NyaXB0IEFjY2VzcyBEZW5pZWQgZXJyb3IKdmFyIHRyeUdldCA9IGZ1bmN0aW9uKGl0LCBrZXkpewogIHRyeSB7CiAgICByZXR1cm4gaXRba2V5XTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9Cn07Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICB2YXIgTywgVCwgQjsKICByZXR1cm4gaXQgPT09IHVuZGVmaW5lZCA/ICdVbmRlZmluZWQnIDogaXQgPT09IG51bGwgPyAnTnVsbCcKICAgIC8vIEBAdG9TdHJpbmdUYWcgY2FzZQogICAgOiB0eXBlb2YgKFQgPSB0cnlHZXQoTyA9IE9iamVjdChpdCksIFRBRykpID09ICdzdHJpbmcnID8gVAogICAgLy8gYnVpbHRpblRhZyBjYXNlCiAgICA6IEFSRyA/IGNvZihPKQogICAgLy8gRVMzIGFyZ3VtZW50cyBmYWxsYmFjawogICAgOiAoQiA9IGNvZihPKSkgPT0gJ09iamVjdCcgJiYgdHlwZW9mIE8uY2FsbGVlID09ICdmdW5jdGlvbicgPyAnQXJndW1lbnRzJyA6IEI7Cn07CgovKioqLyB9KSwKLyogNTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBhbmQgbm9uLWVudW1lcmFibGUgb2xkIFY4IHN0cmluZ3MKdmFyIGNvZiA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwptb2R1bGUuZXhwb3J0cyA9IE9iamVjdCgneicpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApID8gT2JqZWN0IDogZnVuY3Rpb24oaXQpewogIHJldHVybiBjb2YoaXQpID09ICdTdHJpbmcnID8gaXQuc3BsaXQoJycpIDogT2JqZWN0KGl0KTsKfTsKCi8qKiovIH0pLAovKiA1NyAqLywKLyogNTggKi8sCi8qIDU5ICovLAovKiA2MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH07CgovKioqLyB9KSwKLyogNjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsc2UgLT4gQXJyYXkjaW5kZXhPZgovLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlcwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvTGVuZ3RoICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCB0b0luZGV4ICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY4KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihJU19JTkNMVURFUyl7CiAgcmV0dXJuIGZ1bmN0aW9uKCR0aGlzLCBlbCwgZnJvbUluZGV4KXsKICAgIHZhciBPICAgICAgPSB0b0lPYmplY3QoJHRoaXMpCiAgICAgICwgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpCiAgICAgICwgaW5kZXggID0gdG9JbmRleChmcm9tSW5kZXgsIGxlbmd0aCkKICAgICAgLCB2YWx1ZTsKICAgIC8vIEFycmF5I2luY2x1ZGVzIHVzZXMgU2FtZVZhbHVlWmVybyBlcXVhbGl0eSBhbGdvcml0aG0KICAgIGlmKElTX0lOQ0xVREVTICYmIGVsICE9IGVsKXdoaWxlKGxlbmd0aCA+IGluZGV4KXsKICAgICAgdmFsdWUgPSBPW2luZGV4KytdOwogICAgICBpZih2YWx1ZSAhPSB2YWx1ZSlyZXR1cm4gdHJ1ZTsKICAgIC8vIEFycmF5I3RvSW5kZXggaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3QKICAgIH0gZWxzZSBmb3IoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKWlmKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pewogICAgICBpZihPW2luZGV4XSA9PT0gZWwpcmV0dXJuIElTX0lOQ0xVREVTIHx8IGluZGV4IHx8IDA7CiAgICB9IHJldHVybiAhSVNfSU5DTFVERVMgJiYgLTE7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgY3JlYXRlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM3KQogICwgZGVzY3JpcHRvciAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKQogICwgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTsKCi8vIDI1LjEuMi4xLjEgJUl0ZXJhdG9yUHJvdG90eXBlJVtAQGl0ZXJhdG9yXSgpCl9fd2VicGFja19yZXF1aXJlX18oNykoSXRlcmF0b3JQcm90b3R5cGUsIF9fd2VicGFja19yZXF1aXJlX18oMykoJ2l0ZXJhdG9yJyksIGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9KTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpewogIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwge25leHQ6IGRlc2NyaXB0b3IoMSwgbmV4dCl9KTsKICBzZXRUb1N0cmluZ1RhZyhDb25zdHJ1Y3RvciwgTkFNRSArICcgSXRlcmF0b3InKTsKfTsKCi8qKiovIH0pLAovKiA2MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGRvbmUsIHZhbHVlKXsKICByZXR1cm4ge3ZhbHVlOiB2YWx1ZSwgZG9uZTogISFkb25lfTsKfTsKCi8qKiovIH0pLAovKiA2NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIGdldEtleXMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMikgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcyl7CiAgYW5PYmplY3QoTyk7CiAgdmFyIGtleXMgICA9IGdldEtleXMoUHJvcGVydGllcykKICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgKICAgICwgaSA9IDAKICAgICwgUDsKICB3aGlsZShsZW5ndGggPiBpKWRQLmYoTywgUCA9IGtleXNbaSsrXSwgUHJvcGVydGllc1tQXSk7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNjUgKi8sCi8qIDY2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KQogICwgZGVmaW5lZCAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Ci8vIHRydWUgIC0+IFN0cmluZyNhdAovLyBmYWxzZSAtPiBTdHJpbmcjY29kZVBvaW50QXQKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihUT19TVFJJTkcpewogIHJldHVybiBmdW5jdGlvbih0aGF0LCBwb3MpewogICAgdmFyIHMgPSBTdHJpbmcoZGVmaW5lZCh0aGF0KSkKICAgICAgLCBpID0gdG9JbnRlZ2VyKHBvcykKICAgICAgLCBsID0gcy5sZW5ndGgKICAgICAgLCBhLCBiOwogICAgaWYoaSA8IDAgfHwgaSA+PSBsKXJldHVybiBUT19TVFJJTkcgPyAnJyA6IHVuZGVmaW5lZDsKICAgIGEgPSBzLmNoYXJDb2RlQXQoaSk7CiAgICByZXR1cm4gYSA8IDB4ZDgwMCB8fCBhID4gMHhkYmZmIHx8IGkgKyAxID09PSBsIHx8IChiID0gcy5jaGFyQ29kZUF0KGkgKyAxKSkgPCAweGRjMDAgfHwgYiA+IDB4ZGZmZgogICAgICA/IFRPX1NUUklORyA/IHMuY2hhckF0KGkpIDogYQogICAgICA6IFRPX1NUUklORyA/IHMuc2xpY2UoaSwgaSArIDIpIDogKGEgLSAweGQ4MDAgPDwgMTApICsgKGIgLSAweGRjMDApICsgMHgxMDAwMDsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDY3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjdHggICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgaW52b2tlICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4OSkKICAsIGh0bWwgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDIpCiAgLCBjZWwgICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ2xvYmFsICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MKICAsIHNldFRhc2sgICAgICAgICAgICA9IGdsb2JhbC5zZXRJbW1lZGlhdGUKICAsIGNsZWFyVGFzayAgICAgICAgICA9IGdsb2JhbC5jbGVhckltbWVkaWF0ZQogICwgTWVzc2FnZUNoYW5uZWwgICAgID0gZ2xvYmFsLk1lc3NhZ2VDaGFubmVsCiAgLCBjb3VudGVyICAgICAgICAgICAgPSAwCiAgLCBxdWV1ZSAgICAgICAgICAgICAgPSB7fQogICwgT05SRUFEWVNUQVRFQ0hBTkdFID0gJ29ucmVhZHlzdGF0ZWNoYW5nZScKICAsIGRlZmVyLCBjaGFubmVsLCBwb3J0Owp2YXIgcnVuID0gZnVuY3Rpb24oKXsKICB2YXIgaWQgPSArdGhpczsKICBpZihxdWV1ZS5oYXNPd25Qcm9wZXJ0eShpZCkpewogICAgdmFyIGZuID0gcXVldWVbaWRdOwogICAgZGVsZXRlIHF1ZXVlW2lkXTsKICAgIGZuKCk7CiAgfQp9Owp2YXIgbGlzdGVuZXIgPSBmdW5jdGlvbihldmVudCl7CiAgcnVuLmNhbGwoZXZlbnQuZGF0YSk7Cn07Ci8vIE5vZGUuanMgMC45KyAmIElFMTArIGhhcyBzZXRJbW1lZGlhdGUsIG90aGVyd2lzZToKaWYoIXNldFRhc2sgfHwgIWNsZWFyVGFzayl7CiAgc2V0VGFzayA9IGZ1bmN0aW9uIHNldEltbWVkaWF0ZShmbil7CiAgICB2YXIgYXJncyA9IFtdLCBpID0gMTsKICAgIHdoaWxlKGFyZ3VtZW50cy5sZW5ndGggPiBpKWFyZ3MucHVzaChhcmd1bWVudHNbaSsrXSk7CiAgICBxdWV1ZVsrK2NvdW50ZXJdID0gZnVuY3Rpb24oKXsKICAgICAgaW52b2tlKHR5cGVvZiBmbiA9PSAnZnVuY3Rpb24nID8gZm4gOiBGdW5jdGlvbihmbiksIGFyZ3MpOwogICAgfTsKICAgIGRlZmVyKGNvdW50ZXIpOwogICAgcmV0dXJuIGNvdW50ZXI7CiAgfTsKICBjbGVhclRhc2sgPSBmdW5jdGlvbiBjbGVhckltbWVkaWF0ZShpZCl7CiAgICBkZWxldGUgcXVldWVbaWRdOwogIH07CiAgLy8gTm9kZS5qcyAwLjgtCiAgaWYoX193ZWJwYWNrX3JlcXVpcmVfXygyMCkocHJvY2VzcykgPT0gJ3Byb2Nlc3MnKXsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBwcm9jZXNzLm5leHRUaWNrKGN0eChydW4sIGlkLCAxKSk7CiAgICB9OwogIC8vIEJyb3dzZXJzIHdpdGggTWVzc2FnZUNoYW5uZWwsIGluY2x1ZGVzIFdlYldvcmtlcnMKICB9IGVsc2UgaWYoTWVzc2FnZUNoYW5uZWwpewogICAgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbDsKICAgIHBvcnQgICAgPSBjaGFubmVsLnBvcnQyOwogICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBsaXN0ZW5lcjsKICAgIGRlZmVyID0gY3R4KHBvcnQucG9zdE1lc3NhZ2UsIHBvcnQsIDEpOwogIC8vIEJyb3dzZXJzIHdpdGggcG9zdE1lc3NhZ2UsIHNraXAgV2ViV29ya2VycwogIC8vIElFOCBoYXMgcG9zdE1lc3NhZ2UsIGJ1dCBpdCdzIHN5bmMgJiB0eXBlb2YgaXRzIHBvc3RNZXNzYWdlIGlzICdvYmplY3QnCiAgfSBlbHNlIGlmKGdsb2JhbC5hZGRFdmVudExpc3RlbmVyICYmIHR5cGVvZiBwb3N0TWVzc2FnZSA9PSAnZnVuY3Rpb24nICYmICFnbG9iYWwuaW1wb3J0U2NyaXB0cyl7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKGlkICsgJycsICcqJyk7CiAgICB9OwogICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBsaXN0ZW5lciwgZmFsc2UpOwogIC8vIElFOC0KICB9IGVsc2UgaWYoT05SRUFEWVNUQVRFQ0hBTkdFIGluIGNlbCgnc2NyaXB0JykpewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoY2VsKCdzY3JpcHQnKSlbT05SRUFEWVNUQVRFQ0hBTkdFXSA9IGZ1bmN0aW9uKCl7CiAgICAgICAgaHRtbC5yZW1vdmVDaGlsZCh0aGlzKTsKICAgICAgICBydW4uY2FsbChpZCk7CiAgICAgIH07CiAgICB9OwogIC8vIFJlc3Qgb2xkIGJyb3dzZXJzCiAgfSBlbHNlIHsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBzZXRUaW1lb3V0KGN0eChydW4sIGlkLCAxKSwgMCk7CiAgICB9OwogIH0KfQptb2R1bGUuZXhwb3J0cyA9IHsKICBzZXQ6ICAgc2V0VGFzaywKICBjbGVhcjogY2xlYXJUYXNrCn07CgovKioqLyB9KSwKLyogNjggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCiAgLCBtYXggICAgICAgPSBNYXRoLm1heAogICwgbWluICAgICAgID0gTWF0aC5taW47Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaW5kZXgsIGxlbmd0aCl7CiAgaW5kZXggPSB0b0ludGVnZXIoaW5kZXgpOwogIHJldHVybiBpbmRleCA8IDAgPyBtYXgoaW5kZXggKyBsZW5ndGgsIDApIDogbWluKGluZGV4LCBsZW5ndGgpOwp9OwoKLyoqKi8gfSksCi8qIDY5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBhZGRUb1Vuc2NvcGFibGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MCkKICAsIHN0ZXAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYzKQogICwgSXRlcmF0b3JzICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCiAgLCB0b0lPYmplY3QgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyk7CgovLyAyMi4xLjMuNCBBcnJheS5wcm90b3R5cGUuZW50cmllcygpCi8vIDIyLjEuMy4xMyBBcnJheS5wcm90b3R5cGUua2V5cygpCi8vIDIyLjEuMy4yOSBBcnJheS5wcm90b3R5cGUudmFsdWVzKCkKLy8gMjIuMS4zLjMwIEFycmF5LnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpCm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygzOSkoQXJyYXksICdBcnJheScsIGZ1bmN0aW9uKGl0ZXJhdGVkLCBraW5kKXsKICB0aGlzLl90ID0gdG9JT2JqZWN0KGl0ZXJhdGVkKTsgLy8gdGFyZ2V0CiAgdGhpcy5faSA9IDA7ICAgICAgICAgICAgICAgICAgIC8vIG5leHQgaW5kZXgKICB0aGlzLl9rID0ga2luZDsgICAgICAgICAgICAgICAgLy8ga2luZAovLyAyMi4xLjUuMi4xICVBcnJheUl0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKfSwgZnVuY3Rpb24oKXsKICB2YXIgTyAgICAgPSB0aGlzLl90CiAgICAsIGtpbmQgID0gdGhpcy5fawogICAgLCBpbmRleCA9IHRoaXMuX2krKzsKICBpZighTyB8fCBpbmRleCA+PSBPLmxlbmd0aCl7CiAgICB0aGlzLl90ID0gdW5kZWZpbmVkOwogICAgcmV0dXJuIHN0ZXAoMSk7CiAgfQogIGlmKGtpbmQgPT0gJ2tleXMnICApcmV0dXJuIHN0ZXAoMCwgaW5kZXgpOwogIGlmKGtpbmQgPT0gJ3ZhbHVlcycpcmV0dXJuIHN0ZXAoMCwgT1tpbmRleF0pOwogIHJldHVybiBzdGVwKDAsIFtpbmRleCwgT1tpbmRleF1dKTsKfSwgJ3ZhbHVlcycpOwoKLy8gYXJndW1lbnRzTGlzdFtAQGl0ZXJhdG9yXSBpcyAlQXJyYXlQcm90b192YWx1ZXMlICg5LjQuNC42LCA5LjQuNC43KQpJdGVyYXRvcnMuQXJndW1lbnRzID0gSXRlcmF0b3JzLkFycmF5OwoKYWRkVG9VbnNjb3BhYmxlcygna2V5cycpOwphZGRUb1Vuc2NvcGFibGVzKCd2YWx1ZXMnKTsKYWRkVG9VbnNjb3BhYmxlcygnZW50cmllcycpOwoKLyoqKi8gfSksCi8qIDcwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODEpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfc3RyaW5naWZ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7Cgp2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKZXhwb3J0cy5kaXZpZGVFbWFpbCA9IGRpdmlkZUVtYWlsOwpleHBvcnRzLmVtcHR5T2JqZWN0ID0gZW1wdHlPYmplY3Q7CmV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwpleHBvcnRzLmdldFVzZXJVUkxGcm9tRW1haWwgPSBnZXRVc2VyVVJMRnJvbUVtYWlsOwpleHBvcnRzLmdldFVzZXJFbWFpbEZyb21VUkwgPSBnZXRVc2VyRW1haWxGcm9tVVJMOwpleHBvcnRzLmNvbnZlcnRUb1VzZXJVUkwgPSBjb252ZXJ0VG9Vc2VyVVJMOwpleHBvcnRzLmNoZWNrQXR0cmlidXRlID0gY2hlY2tBdHRyaWJ1dGU7CmV4cG9ydHMucGFyc2VBdHRyaWJ1dGVzID0gcGFyc2VBdHRyaWJ1dGVzOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwovKioKICogU3VwcG9ydCBtb2R1bGUgd2l0aCBzb21lIGZ1bmN0aW9ucyB3aWxsIGJlIHVzZWZ1bAogKiBAbW9kdWxlIHV0aWxzCiAqLwoKLyoqCiAqIEB0eXBlZGVmIGRpdmlkZVVSTAogKiBAdHlwZSBPYmplY3QKICogQHByb3BlcnR5IHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgVVJMCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkb21haW4gVGhlIGRvbWFpbiBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiBVUkwKICovCgovKioKICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5CiAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAqIEByZXR1cm4ge2RpdmlkZVVSTH0gdGhlIHJlc3VsdCBvZiBkaXZpZGVVUkwKICovCmZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHsKCiAgaWYgKCF1cmwpIHRocm93IEVycm9yKCdVUkwgaXMgbmVlZGVkIHRvIHNwbGl0Jyk7CgogIGZ1bmN0aW9uIHJlY3Vyc2UodmFsdWUpIHsKICAgIHZhciByZWdleCA9IC8oW2EtekEtWi1dKikoOlwvXC8oPzpcLik/fDopKFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTsKICAgIHZhciBzdWJzdCA9ICckMSwkMywkNCc7CiAgICB2YXIgcGFydHMgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBzdWJzdCkuc3BsaXQoJywnKTsKICAgIHJldHVybiBwYXJ0czsKICB9CgogIHZhciBwYXJ0cyA9IHJlY3Vyc2UodXJsKTsKCiAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lCiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgIXBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKCiAgICB2YXIgX3Jlc3VsdCA9IHsKICAgICAgdHlwZTogIiIsCiAgICAgIGRvbWFpbjogdXJsLAogICAgICBpZGVudGl0eTogIiIKICAgIH07CgogICAgY29uc29sZS5lcnJvcignW0RpdmlkZVVSTF0gRGl2aWRlVVJMIGRvblwndCBzdXBwb3J0IHVybCB3aXRob3V0IHNjaGVtZS4gUGxlYXNlIHJldmlldyB5b3VyIHVybCBhZGRyZXNzJywgdXJsKTsKCiAgICByZXR1cm4gX3Jlc3VsdDsKICB9CgogIC8vIGNoZWNrIGlmIHRoZSB1cmwgaGFzIHRoZSBzY2hlbWUgYW5kIGluY2x1ZGVzIGFuIEAKICBpZiAocGFydHNbMF0gPT09IHVybCAmJiBwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CiAgICB2YXIgc2NoZW1lID0gcGFydHNbMF0gPT09IHVybCA/ICdzbXRwJyA6IHBhcnRzWzBdOwogICAgcGFydHMgPSByZWN1cnNlKHNjaGVtZSArICc6Ly8nICsgcGFydHNbMF0pOwogIH0KCiAgLy8gaWYgdGhlIGRvbWFpbiBpbmNsdWRlcyBhbiBALCBkaXZpZGUgaXQgdG8gZG9tYWluIGFuZCBpZGVudGl0eSByZXNwZWN0aXZlbHkKICBpZiAocGFydHNbMV0uaW5jbHVkZXMoJ0AnKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1swXSArICc6Ly8nICsgcGFydHNbMV07CiAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdLnN1YnN0cihwYXJ0c1sxXS5pbmRleE9mKCdAJykgKyAxKTsKICB9IC8qZWxzZSBpZiAocGFydHNbMl0uaW5jbHVkZXMoJy8nKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1syXS5zdWJzdHIocGFydHNbMl0ubGFzdEluZGV4T2YoJy8nKSsxKTsKICAgIH0qLwoKICB2YXIgcmVzdWx0ID0gewogICAgdHlwZTogcGFydHNbMF0sCiAgICBkb21haW46IHBhcnRzWzFdLAogICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgfTsKCiAgcmV0dXJuIHJlc3VsdDsKfQoKZnVuY3Rpb24gZGl2aWRlRW1haWwoZW1haWwpIHsKICB2YXIgaW5kZXhPZkF0ID0gZW1haWwuaW5kZXhPZignQCcpOwoKICB2YXIgcmVzdWx0ID0gewogICAgdXNlcm5hbWU6IGVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpLAogICAgZG9tYWluOiBlbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgZW1haWwubGVuZ3RoKQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBDaGVjayBpZiBhbiBPYmplY3QgaXMgZW1wdHkKICogQHBhcmFtICB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IHRvIGJlIGNoZWNrZWQKICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgc3RhdHVzIG9mIE9iamVjdCwgZW1wdHkgb3Igbm90ICh0cnVlfGZhbHNlKTsKICovCmZ1bmN0aW9uIGVtcHR5T2JqZWN0KG9iamVjdCkgewogIHJldHVybiAoMCwgX2tleXMyLmRlZmF1bHQpKG9iamVjdCkubGVuZ3RoID4gMCA/IGZhbHNlIDogdHJ1ZTsKfQoKLyoqCiAqIE1ha2UgYSBDT1BZIG9mIHRoZSBvcmlnaW5hbCBkYXRhCiAqIEBwYXJhbSAge09iamVjdH0gIG9iaiAtIG9iamVjdCB0byBiZSBjbG9uZWQKICogQHJldHVybiB7T2JqZWN0fQogKi8KZnVuY3Rpb24gZGVlcENsb25lKG9iaikgewogIC8vVE9ETzogc2ltcGxlIGJ1dCBpbmVmZmljaWVudCBKU09OIGRlZXAgY2xvbmUuLi4KICBpZiAob2JqKSByZXR1cm4gSlNPTi5wYXJzZSgoMCwgX3N0cmluZ2lmeTIuZGVmYXVsdCkob2JqKSk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIFVSTCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gZW1haWwKICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICogQHJldHVybiB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICovCmZ1bmN0aW9uIGdldFVzZXJVUkxGcm9tRW1haWwodXNlckVtYWlsKSB7CiAgdmFyIGluZGV4T2ZBdCA9IHVzZXJFbWFpbC5pbmRleE9mKCdAJyk7CiAgcmV0dXJuICd1c2VyOi8vJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgdXNlckVtYWlsLmxlbmd0aCkgKyAnLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIGVtYWlsIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBVUkwKICogQHBhcmFtICB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICogQHJldHVybiB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICovCmZ1bmN0aW9uIGdldFVzZXJFbWFpbEZyb21VUkwodXNlclVSTCkgewogIHZhciB1cmwgPSBkaXZpZGVVUkwodXNlclVSTCk7CiAgcmV0dXJuIHVybC5pZGVudGl0eS5yZXBsYWNlKCcvJywgJycpICsgJ0AnICsgdXJsLmRvbWFpbjsgLy8gaWRlbnRpdHkgZmllbGQgaGFzICcvZXhhbXBsZUlEJyBpbnN0ZWFkIG9mICdleGFtcGxlSUQnCn0KCi8qKgogKiBDaGVjayBpZiB0aGUgdXNlciBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIFVSTCBmb3JtYXQsIGlmIG5vdCwgY29udmVydCB0byBVUkwgZm9ybWF0CiAqIEBwYXJhbSAge3N0cmluZ30gICBpZGVudGlmaWVyICB1c2VyIGlkZW50aWZpZXIKICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMCiAqLwpmdW5jdGlvbiBjb252ZXJ0VG9Vc2VyVVJMKGlkZW50aWZpZXIpIHsKCiAgLy8gY2hlY2sgaWYgdGhlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgdXJsIGZvcm1hdAogIGlmIChpZGVudGlmaWVyLnN1YnN0cmluZygwLCA3KSA9PT0gJ3VzZXI6Ly8nKSB7CiAgICB2YXIgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChpZGVudGlmaWVyKTsKCiAgICAvL2NoZWNrIGlmIHRoZSB1cmwgaXMgd2VsbCBmb3JtYXRlZAogICAgaWYgKGRpdmlkZWRVUkwuZG9tYWluICYmIGRpdmlkZWRVUkwuaWRlbnRpdHkpIHsKICAgICAgcmV0dXJuIGlkZW50aWZpZXI7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyAndXNlclVSTCB3aXRoIHdyb25nIGZvcm1hdCc7CiAgICB9CgogICAgLy9pZiBub3QsIGNvbnZlcnQgdGhlIHVzZXIgZW1haWwgdG8gVVJMIGZvcm1hdAogIH0gZWxzZSB7CiAgICByZXR1cm4gZ2V0VXNlclVSTEZyb21FbWFpbChpZGVudGlmaWVyKTsKICB9Cn0KCmZ1bmN0aW9uIGNoZWNrQXR0cmlidXRlKHBhdGgpIHsKCiAgdmFyIHJlZ2V4ID0gLygoKFthLXpBLVpdKyk6XC9cLyhbMC05YS16QS1aXVstXHddKlswLTlhLXpBLVpdXC4pK1thLXpBLVpdezIsOX0pXC9bYS16QS1aMC05XC5dK0BbYS16QS1aMC05XSsoXC0pP1thLXpBLVowLTldKyhcLik/W2EtekEtWjAtOV17MiwxMH0/XC5bYS16QS1aXXsyLDEwfSkoLisoPz0uaWRlbnRpdHkpKT8vZ207CgogIHZhciBsaXN0ID0gW107CiAgdmFyIGZpbmFsID0gW107CiAgdmFyIHRlc3QgPSBwYXRoLm1hdGNoKHJlZ2V4KTsKCiAgaWYgKHRlc3QgPT0gbnVsbCkgewogICAgZmluYWwgPSBwYXRoLnNwbGl0KCcuJyk7CiAgfSBlbHNlIHsKICAgIHZhciBtID0gdm9pZCAwOwogICAgd2hpbGUgKChtID0gcmVnZXguZXhlYyhwYXRoKSkgIT09IG51bGwpIHsKICAgICAgLy8gVGhpcyBpcyBuZWNlc3NhcnkgdG8gYXZvaWQgaW5maW5pdGUgbG9vcHMgd2l0aCB6ZXJvLXdpZHRoIG1hdGNoZXMKICAgICAgaWYgKG0uaW5kZXggPT09IHJlZ2V4Lmxhc3RJbmRleCkgewogICAgICAgIHJlZ2V4Lmxhc3RJbmRleCsrOwogICAgICB9CgogICAgICAvLyBUaGUgcmVzdWx0IGNhbiBiZSBhY2Nlc3NlZCB0aHJvdWdoIHRoZSBgbWAtdmFyaWFibGUuCiAgICAgIG0uZm9yRWFjaChmdW5jdGlvbiAobWF0Y2gsIGdyb3VwSW5kZXgpIHsKICAgICAgICBpZiAoZ3JvdXBJbmRleCA9PT0gMCkgewogICAgICAgICAgbGlzdC5wdXNoKG1hdGNoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgdmFyIHJlc3VsdCA9IHZvaWQgMDsKICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAodXJsKSB7CiAgICAgIHJlc3VsdCA9IHBhdGgucmVwbGFjZSh1cmwsICcqKyonKTsKCiAgICAgIGZpbmFsID0gcmVzdWx0LnNwbGl0KCcuJykubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0gPT09ICcqKyonKSB7CiAgICAgICAgICByZXR1cm4gdXJsOwogICAgICAgIH0KICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfSk7CiAgICB9KTsKICB9CgogIGNvbnNvbGUubG9nKCdbU2VydmljZUZyYW1ld29yay5VdGlscy5jaGVja0F0dHJpYnV0ZV0nLCBmaW5hbCk7CiAgcmV0dXJuIGZpbmFsOwp9CgpmdW5jdGlvbiBwYXJzZUF0dHJpYnV0ZXMocGF0aCkgewogIHZhciByZWdleCA9IC8oWzAtOWEtekEtWl1bLVx3XSopOlwvXC8vZzsKCiAgdmFyIHN0cmluZzMgPSAnaWRlbnRpdHknOwoKICBpZiAoIXBhdGguaW5jbHVkZXMoJzovLycpKSB7CiAgICByZXR1cm4gcGF0aC5zcGxpdCgnLicpOwogIH0gZWxzZSB7CiAgICB2YXIgc3RyaW5nMSA9IHBhdGguc3BsaXQocmVnZXgpWzBdOwoKICAgIHZhciBhcnJheTEgPSBzdHJpbmcxLnNwbGl0KCcuJyk7CgogICAgdmFyIHN0cmluZzIgPSBwYXRoLnJlcGxhY2Uoc3RyaW5nMSwgJycpOwoKICAgIGlmIChwYXRoLmluY2x1ZGVzKHN0cmluZzMpKSB7CgogICAgICB2YXIgYXJyYXkyID0gc3RyaW5nMi5zcGxpdChzdHJpbmczICsgJy4nKTsKCiAgICAgIGNvbnNvbGUubG9nKCdhcnJheTIgJyArIGFycmF5Mik7CgogICAgICBzdHJpbmcyID0gYXJyYXkyWzBdLnNsaWNlKCcuJywgLTEpOwoKICAgICAgYXJyYXkyID0gYXJyYXkyWzFdLnNwbGl0KCcuJyk7CgogICAgICBhcnJheTEucHVzaChzdHJpbmcyLCBzdHJpbmczKTsKCiAgICAgIGFycmF5MSA9IGFycmF5MS5jb25jYXQoYXJyYXkyKTsKICAgIH0gZWxzZSB7CiAgICAgIGFycmF5MS5wdXNoKHN0cmluZzIpOwogICAgfQoKICAgIHJldHVybiBhcnJheTEuZmlsdGVyKEJvb2xlYW4pOwogIH0KfQoKLyoqKi8gfSksCi8qIDcyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODMpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzMgKi8sCi8qIDc0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjbGFzc29mICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KQogICwgSVRFUkFUT1IgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnaXRlcmF0b3InKQogICwgSXRlcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNik7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCAhPSB1bmRlZmluZWQpcmV0dXJuIGl0W0lURVJBVE9SXQogICAgfHwgaXRbJ0BAaXRlcmF0b3InXQogICAgfHwgSXRlcmF0b3JzW2NsYXNzb2YoaXQpXTsKfTsKCi8qKiovIH0pLAovKiA3NSAqLywKLyogNzYgKi8sCi8qIDc3ICovLAovKiA3OCAqLywKLyogNzkgKi8sCi8qIDgwICovLAovKiA4MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMyk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Qua2V5czsKCi8qKiovIH0pLAovKiA4MiAqLywKLyogODMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg1NCk7Cl9fd2VicGFja19yZXF1aXJlX18oNTApOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKX193ZWJwYWNrX3JlcXVpcmVfXygxMDUpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuUHJvbWlzZTsKCi8qKiovIH0pLAovKiA4NCAqLywKLyogODUgKi8sCi8qIDg2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIENvbnN0cnVjdG9yLCBuYW1lLCBmb3JiaWRkZW5GaWVsZCl7CiAgaWYoIShpdCBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSB8fCAoZm9yYmlkZGVuRmllbGQgIT09IHVuZGVmaW5lZCAmJiBmb3JiaWRkZW5GaWVsZCBpbiBpdCkpewogICAgdGhyb3cgVHlwZUVycm9yKG5hbWUgKyAnOiBpbmNvcnJlY3QgaW52b2NhdGlvbiEnKTsKICB9IHJldHVybiBpdDsKfTsKCi8qKiovIH0pLAovKiA4NyAqLywKLyogODggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGN0eCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGNhbGwgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MikKICAsIGlzQXJyYXlJdGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MCkKICAsIGFuT2JqZWN0ICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQogICwgdG9MZW5ndGggICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KQogICwgZ2V0SXRlckZuICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc0KQogICwgQlJFQUsgICAgICAgPSB7fQogICwgUkVUVVJOICAgICAgPSB7fTsKdmFyIGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhYmxlLCBlbnRyaWVzLCBmbiwgdGhhdCwgSVRFUkFUT1IpewogIHZhciBpdGVyRm4gPSBJVEVSQVRPUiA/IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyYWJsZTsgfSA6IGdldEl0ZXJGbihpdGVyYWJsZSkKICAgICwgZiAgICAgID0gY3R4KGZuLCB0aGF0LCBlbnRyaWVzID8gMiA6IDEpCiAgICAsIGluZGV4ICA9IDAKICAgICwgbGVuZ3RoLCBzdGVwLCBpdGVyYXRvciwgcmVzdWx0OwogIGlmKHR5cGVvZiBpdGVyRm4gIT0gJ2Z1bmN0aW9uJyl0aHJvdyBUeXBlRXJyb3IoaXRlcmFibGUgKyAnIGlzIG5vdCBpdGVyYWJsZSEnKTsKICAvLyBmYXN0IGNhc2UgZm9yIGFycmF5cyB3aXRoIGRlZmF1bHQgaXRlcmF0b3IKICBpZihpc0FycmF5SXRlcihpdGVyRm4pKWZvcihsZW5ndGggPSB0b0xlbmd0aChpdGVyYWJsZS5sZW5ndGgpOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKyl7CiAgICByZXN1bHQgPSBlbnRyaWVzID8gZihhbk9iamVjdChzdGVwID0gaXRlcmFibGVbaW5kZXhdKVswXSwgc3RlcFsxXSkgOiBmKGl0ZXJhYmxlW2luZGV4XSk7CiAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7CiAgfSBlbHNlIGZvcihpdGVyYXRvciA9IGl0ZXJGbi5jYWxsKGl0ZXJhYmxlKTsgIShzdGVwID0gaXRlcmF0b3IubmV4dCgpKS5kb25lOyApewogICAgcmVzdWx0ID0gY2FsbChpdGVyYXRvciwgZiwgc3RlcC52YWx1ZSwgZW50cmllcyk7CiAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7CiAgfQp9OwpleHBvcnRzLkJSRUFLICA9IEJSRUFLOwpleHBvcnRzLlJFVFVSTiA9IFJFVFVSTjsKCi8qKiovIH0pLAovKiA4OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBmYXN0IGFwcGx5LCBodHRwOi8vanNwZXJmLmxua2l0LmNvbS9mYXN0LWFwcGx5LzUKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmbiwgYXJncywgdGhhdCl7CiAgdmFyIHVuID0gdGhhdCA9PT0gdW5kZWZpbmVkOwogIHN3aXRjaChhcmdzLmxlbmd0aCl7CiAgICBjYXNlIDA6IHJldHVybiB1biA/IGZuKCkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0KTsKICAgIGNhc2UgMTogcmV0dXJuIHVuID8gZm4oYXJnc1swXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdKTsKICAgIGNhc2UgMjogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdKTsKICAgIGNhc2UgMzogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTsKICAgIGNhc2UgNDogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKTsKICB9IHJldHVybiAgICAgICAgICAgICAgZm4uYXBwbHkodGhhdCwgYXJncyk7Cn07CgovKioqLyB9KSwKLyogOTAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gY2hlY2sgb24gZGVmYXVsdCBBcnJheSBpdGVyYXRvcgp2YXIgSXRlcmF0b3JzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCiAgLCBJVEVSQVRPUiAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnaXRlcmF0b3InKQogICwgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCAhPT0gdW5kZWZpbmVkICYmIChJdGVyYXRvcnMuQXJyYXkgPT09IGl0IHx8IEFycmF5UHJvdG9bSVRFUkFUT1JdID09PSBpdCk7Cn07CgovKioqLyB9KSwKLyogOTEgKi8sCi8qIDkyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGNhbGwgc29tZXRoaW5nIG9uIGl0ZXJhdG9yIHN0ZXAgd2l0aCBzYWZlIGNsb3Npbmcgb24gZXJyb3IKdmFyIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdGVyYXRvciwgZm4sIHZhbHVlLCBlbnRyaWVzKXsKICB0cnkgewogICAgcmV0dXJuIGVudHJpZXMgPyBmbihhbk9iamVjdCh2YWx1ZSlbMF0sIHZhbHVlWzFdKSA6IGZuKHZhbHVlKTsKICAvLyA3LjQuNiBJdGVyYXRvckNsb3NlKGl0ZXJhdG9yLCBjb21wbGV0aW9uKQogIH0gY2F0Y2goZSl7CiAgICB2YXIgcmV0ID0gaXRlcmF0b3JbJ3JldHVybiddOwogICAgaWYocmV0ICE9PSB1bmRlZmluZWQpYW5PYmplY3QocmV0LmNhbGwoaXRlcmF0b3IpKTsKICAgIHRocm93IGU7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDkzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBJVEVSQVRPUiAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdpdGVyYXRvcicpCiAgLCBTQUZFX0NMT1NJTkcgPSBmYWxzZTsKCnRyeSB7CiAgdmFyIHJpdGVyID0gWzddW0lURVJBVE9SXSgpOwogIHJpdGVyWydyZXR1cm4nXSA9IGZ1bmN0aW9uKCl7IFNBRkVfQ0xPU0lORyA9IHRydWU7IH07CiAgQXJyYXkuZnJvbShyaXRlciwgZnVuY3Rpb24oKXsgdGhyb3cgMjsgfSk7Cn0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYywgc2tpcENsb3NpbmcpewogIGlmKCFza2lwQ2xvc2luZyAmJiAhU0FGRV9DTE9TSU5HKXJldHVybiBmYWxzZTsKICB2YXIgc2FmZSA9IGZhbHNlOwogIHRyeSB7CiAgICB2YXIgYXJyICA9IFs3XQogICAgICAsIGl0ZXIgPSBhcnJbSVRFUkFUT1JdKCk7CiAgICBpdGVyLm5leHQgPSBmdW5jdGlvbigpeyByZXR1cm4ge2RvbmU6IHNhZmUgPSB0cnVlfTsgfTsKICAgIGFycltJVEVSQVRPUl0gPSBmdW5jdGlvbigpeyByZXR1cm4gaXRlcjsgfTsKICAgIGV4ZWMoYXJyKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgcmV0dXJuIHNhZmU7Cn07CgovKioqLyB9KSwKLyogOTQgKi8sCi8qIDk1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBtYWNyb3Rhc2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KS5zZXQKICAsIE9ic2VydmVyICA9IGdsb2JhbC5NdXRhdGlvbk9ic2VydmVyIHx8IGdsb2JhbC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyCiAgLCBwcm9jZXNzICAgPSBnbG9iYWwucHJvY2VzcwogICwgUHJvbWlzZSAgID0gZ2xvYmFsLlByb21pc2UKICAsIGlzTm9kZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjApKHByb2Nlc3MpID09ICdwcm9jZXNzJzsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKXsKICB2YXIgaGVhZCwgbGFzdCwgbm90aWZ5OwoKICB2YXIgZmx1c2ggPSBmdW5jdGlvbigpewogICAgdmFyIHBhcmVudCwgZm47CiAgICBpZihpc05vZGUgJiYgKHBhcmVudCA9IHByb2Nlc3MuZG9tYWluKSlwYXJlbnQuZXhpdCgpOwogICAgd2hpbGUoaGVhZCl7CiAgICAgIGZuICAgPSBoZWFkLmZuOwogICAgICBoZWFkID0gaGVhZC5uZXh0OwogICAgICB0cnkgewogICAgICAgIGZuKCk7CiAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgaWYoaGVhZClub3RpZnkoKTsKICAgICAgICBlbHNlIGxhc3QgPSB1bmRlZmluZWQ7CiAgICAgICAgdGhyb3cgZTsKICAgICAgfQogICAgfSBsYXN0ID0gdW5kZWZpbmVkOwogICAgaWYocGFyZW50KXBhcmVudC5lbnRlcigpOwogIH07CgogIC8vIE5vZGUuanMKICBpZihpc05vZGUpewogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgcHJvY2Vzcy5uZXh0VGljayhmbHVzaCk7CiAgICB9OwogIC8vIGJyb3dzZXJzIHdpdGggTXV0YXRpb25PYnNlcnZlcgogIH0gZWxzZSBpZihPYnNlcnZlcil7CiAgICB2YXIgdG9nZ2xlID0gdHJ1ZQogICAgICAsIG5vZGUgICA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTsKICAgIG5ldyBPYnNlcnZlcihmbHVzaCkub2JzZXJ2ZShub2RlLCB7Y2hhcmFjdGVyRGF0YTogdHJ1ZX0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldwogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgbm9kZS5kYXRhID0gdG9nZ2xlID0gIXRvZ2dsZTsKICAgIH07CiAgLy8gZW52aXJvbm1lbnRzIHdpdGggbWF5YmUgbm9uLWNvbXBsZXRlbHkgY29ycmVjdCwgYnV0IGV4aXN0ZW50IFByb21pc2UKICB9IGVsc2UgaWYoUHJvbWlzZSAmJiBQcm9taXNlLnJlc29sdmUpewogICAgdmFyIHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CiAgICAgIHByb21pc2UudGhlbihmbHVzaCk7CiAgICB9OwogIC8vIGZvciBvdGhlciBlbnZpcm9ubWVudHMgLSBtYWNyb3Rhc2sgYmFzZWQgb246CiAgLy8gLSBzZXRJbW1lZGlhdGUKICAvLyAtIE1lc3NhZ2VDaGFubmVsCiAgLy8gLSB3aW5kb3cucG9zdE1lc3NhZwogIC8vIC0gb25yZWFkeXN0YXRlY2hhbmdlCiAgLy8gLSBzZXRUaW1lb3V0CiAgfSBlbHNlIHsKICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CiAgICAgIC8vIHN0cmFuZ2UgSUUgKyB3ZWJwYWNrIGRldiBzZXJ2ZXIgYnVnIC0gdXNlIC5jYWxsKGdsb2JhbCkKICAgICAgbWFjcm90YXNrLmNhbGwoZ2xvYmFsLCBmbHVzaCk7CiAgICB9OwogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uKGZuKXsKICAgIHZhciB0YXNrID0ge2ZuOiBmbiwgbmV4dDogdW5kZWZpbmVkfTsKICAgIGlmKGxhc3QpbGFzdC5uZXh0ID0gdGFzazsKICAgIGlmKCFoZWFkKXsKICAgICAgaGVhZCA9IHRhc2s7CiAgICAgIG5vdGlmeSgpOwogICAgfSBsYXN0ID0gdGFzazsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDk2ICovLAovKiA5NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaGlkZSA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odGFyZ2V0LCBzcmMsIHNhZmUpewogIGZvcih2YXIga2V5IGluIHNyYyl7CiAgICBpZihzYWZlICYmIHRhcmdldFtrZXldKXRhcmdldFtrZXldID0gc3JjW2tleV07CiAgICBlbHNlIGhpZGUodGFyZ2V0LCBrZXksIHNyY1trZXldKTsKICB9IHJldHVybiB0YXJnZXQ7Cn07CgovKioqLyB9KSwKLyogOTggKi8sCi8qIDk5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBnbG9iYWwgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGNvcmUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQogICwgZFAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBERVNDUklQVE9SUyA9IF9fd2VicGFja19yZXF1aXJlX18oMikKICAsIFNQRUNJRVMgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnc3BlY2llcycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihLRVkpewogIHZhciBDID0gdHlwZW9mIGNvcmVbS0VZXSA9PSAnZnVuY3Rpb24nID8gY29yZVtLRVldIDogZ2xvYmFsW0tFWV07CiAgaWYoREVTQ1JJUFRPUlMgJiYgQyAmJiAhQ1tTUEVDSUVTXSlkUC5mKEMsIFNQRUNJRVMsIHsKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgIGdldDogZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH0KICB9KTsKfTsKCi8qKiovIH0pLAovKiAxMDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpCnZhciBhbk9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBhRnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KQogICwgU1BFQ0lFUyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnc3BlY2llcycpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE8sIEQpewogIHZhciBDID0gYW5PYmplY3QoTykuY29uc3RydWN0b3IsIFM7CiAgcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBEIDogYUZ1bmN0aW9uKFMpOwp9OwoKLyoqKi8gfSksCi8qIDEwMSAqLywKLyogMTAyICovLAovKiAxMDMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjE0IE9iamVjdC5rZXlzKE8pCnZhciB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCAka2V5cyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpOwoKX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2tleXMnLCBmdW5jdGlvbigpewogIHJldHVybiBmdW5jdGlvbiBrZXlzKGl0KXsKICAgIHJldHVybiAka2V5cyh0b09iamVjdChpdCkpOwogIH07Cn0pOwoKLyoqKi8gfSksCi8qIDEwNCAqLywKLyogMTA1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBMSUJSQVJZICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KQogICwgZ2xvYmFsICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGNsYXNzb2YgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTUpCiAgLCAkZXhwb3J0ICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpCiAgLCBpc09iamVjdCAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCiAgLCBhRnVuY3Rpb24gICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KQogICwgYW5JbnN0YW5jZSAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NikKICAsIGZvck9mICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODgpCiAgLCBzcGVjaWVzQ29uc3RydWN0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMCkKICAsIHRhc2sgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjcpLnNldAogICwgbWljcm90YXNrICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NSkoKQogICwgUFJPTUlTRSAgICAgICAgICAgID0gJ1Byb21pc2UnCiAgLCBUeXBlRXJyb3IgICAgICAgICAgPSBnbG9iYWwuVHlwZUVycm9yCiAgLCBwcm9jZXNzICAgICAgICAgICAgPSBnbG9iYWwucHJvY2VzcwogICwgJFByb21pc2UgICAgICAgICAgID0gZ2xvYmFsW1BST01JU0VdCiAgLCBwcm9jZXNzICAgICAgICAgICAgPSBnbG9iYWwucHJvY2VzcwogICwgaXNOb2RlICAgICAgICAgICAgID0gY2xhc3NvZihwcm9jZXNzKSA9PSAncHJvY2VzcycKICAsIGVtcHR5ICAgICAgICAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KICAsIEludGVybmFsLCBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHksIFdyYXBwZXI7Cgp2YXIgVVNFX05BVElWRSA9ICEhZnVuY3Rpb24oKXsKICB0cnkgewogICAgLy8gY29ycmVjdCBzdWJjbGFzc2luZyB3aXRoIEBAc3BlY2llcyBzdXBwb3J0CiAgICB2YXIgcHJvbWlzZSAgICAgPSAkUHJvbWlzZS5yZXNvbHZlKDEpCiAgICAgICwgRmFrZVByb21pc2UgPSAocHJvbWlzZS5jb25zdHJ1Y3RvciA9IHt9KVtfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdzcGVjaWVzJyldID0gZnVuY3Rpb24oZXhlYyl7IGV4ZWMoZW1wdHksIGVtcHR5KTsgfTsKICAgIC8vIHVuaGFuZGxlZCByZWplY3Rpb25zIHRyYWNraW5nIHN1cHBvcnQsIE5vZGVKUyBQcm9taXNlIHdpdGhvdXQgaXQgZmFpbHMgQEBzcGVjaWVzIHRlc3QKICAgIHJldHVybiAoaXNOb2RlIHx8IHR5cGVvZiBQcm9taXNlUmVqZWN0aW9uRXZlbnQgPT0gJ2Z1bmN0aW9uJykgJiYgcHJvbWlzZS50aGVuKGVtcHR5KSBpbnN0YW5jZW9mIEZha2VQcm9taXNlOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KfSgpOwoKLy8gaGVscGVycwp2YXIgc2FtZUNvbnN0cnVjdG9yID0gZnVuY3Rpb24oYSwgYil7CiAgLy8gd2l0aCBsaWJyYXJ5IHdyYXBwZXIgc3BlY2lhbCBjYXNlCiAgcmV0dXJuIGEgPT09IGIgfHwgYSA9PT0gJFByb21pc2UgJiYgYiA9PT0gV3JhcHBlcjsKfTsKdmFyIGlzVGhlbmFibGUgPSBmdW5jdGlvbihpdCl7CiAgdmFyIHRoZW47CiAgcmV0dXJuIGlzT2JqZWN0KGl0KSAmJiB0eXBlb2YgKHRoZW4gPSBpdC50aGVuKSA9PSAnZnVuY3Rpb24nID8gdGhlbiA6IGZhbHNlOwp9Owp2YXIgbmV3UHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbihDKXsKICByZXR1cm4gc2FtZUNvbnN0cnVjdG9yKCRQcm9taXNlLCBDKQogICAgPyBuZXcgUHJvbWlzZUNhcGFiaWxpdHkoQykKICAgIDogbmV3IEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eShDKTsKfTsKdmFyIFByb21pc2VDYXBhYmlsaXR5ID0gR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24oQyl7CiAgdmFyIHJlc29sdmUsIHJlamVjdDsKICB0aGlzLnByb21pc2UgPSBuZXcgQyhmdW5jdGlvbigkJHJlc29sdmUsICQkcmVqZWN0KXsKICAgIGlmKHJlc29sdmUgIT09IHVuZGVmaW5lZCB8fCByZWplY3QgIT09IHVuZGVmaW5lZCl0aHJvdyBUeXBlRXJyb3IoJ0JhZCBQcm9taXNlIGNvbnN0cnVjdG9yJyk7CiAgICByZXNvbHZlID0gJCRyZXNvbHZlOwogICAgcmVqZWN0ICA9ICQkcmVqZWN0OwogIH0pOwogIHRoaXMucmVzb2x2ZSA9IGFGdW5jdGlvbihyZXNvbHZlKTsKICB0aGlzLnJlamVjdCAgPSBhRnVuY3Rpb24ocmVqZWN0KTsKfTsKdmFyIHBlcmZvcm0gPSBmdW5jdGlvbihleGVjKXsKICB0cnkgewogICAgZXhlYygpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4ge2Vycm9yOiBlfTsKICB9Cn07CnZhciBub3RpZnkgPSBmdW5jdGlvbihwcm9taXNlLCBpc1JlamVjdCl7CiAgaWYocHJvbWlzZS5fbilyZXR1cm47CiAgcHJvbWlzZS5fbiA9IHRydWU7CiAgdmFyIGNoYWluID0gcHJvbWlzZS5fYzsKICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YKICAgICAgLCBvayAgICA9IHByb21pc2UuX3MgPT0gMQogICAgICAsIGkgICAgID0gMDsKICAgIHZhciBydW4gPSBmdW5jdGlvbihyZWFjdGlvbil7CiAgICAgIHZhciBoYW5kbGVyID0gb2sgPyByZWFjdGlvbi5vayA6IHJlYWN0aW9uLmZhaWwKICAgICAgICAsIHJlc29sdmUgPSByZWFjdGlvbi5yZXNvbHZlCiAgICAgICAgLCByZWplY3QgID0gcmVhY3Rpb24ucmVqZWN0CiAgICAgICAgLCBkb21haW4gID0gcmVhY3Rpb24uZG9tYWluCiAgICAgICAgLCByZXN1bHQsIHRoZW47CiAgICAgIHRyeSB7CiAgICAgICAgaWYoaGFuZGxlcil7CiAgICAgICAgICBpZighb2spewogICAgICAgICAgICBpZihwcm9taXNlLl9oID09IDIpb25IYW5kbGVVbmhhbmRsZWQocHJvbWlzZSk7CiAgICAgICAgICAgIHByb21pc2UuX2ggPSAxOwogICAgICAgICAgfQogICAgICAgICAgaWYoaGFuZGxlciA9PT0gdHJ1ZSlyZXN1bHQgPSB2YWx1ZTsKICAgICAgICAgIGVsc2UgewogICAgICAgICAgICBpZihkb21haW4pZG9tYWluLmVudGVyKCk7CiAgICAgICAgICAgIHJlc3VsdCA9IGhhbmRsZXIodmFsdWUpOwogICAgICAgICAgICBpZihkb21haW4pZG9tYWluLmV4aXQoKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmKHJlc3VsdCA9PT0gcmVhY3Rpb24ucHJvbWlzZSl7CiAgICAgICAgICAgIHJlamVjdChUeXBlRXJyb3IoJ1Byb21pc2UtY2hhaW4gY3ljbGUnKSk7CiAgICAgICAgICB9IGVsc2UgaWYodGhlbiA9IGlzVGhlbmFibGUocmVzdWx0KSl7CiAgICAgICAgICAgIHRoZW4uY2FsbChyZXN1bHQsIHJlc29sdmUsIHJlamVjdCk7CiAgICAgICAgICB9IGVsc2UgcmVzb2x2ZShyZXN1bHQpOwogICAgICAgIH0gZWxzZSByZWplY3QodmFsdWUpOwogICAgICB9IGNhdGNoKGUpewogICAgICAgIHJlamVjdChlKTsKICAgICAgfQogICAgfTsKICAgIHdoaWxlKGNoYWluLmxlbmd0aCA+IGkpcnVuKGNoYWluW2krK10pOyAvLyB2YXJpYWJsZSBsZW5ndGggLSBjYW4ndCB1c2UgZm9yRWFjaAogICAgcHJvbWlzZS5fYyA9IFtdOwogICAgcHJvbWlzZS5fbiA9IGZhbHNlOwogICAgaWYoaXNSZWplY3QgJiYgIXByb21pc2UuX2gpb25VbmhhbmRsZWQocHJvbWlzZSk7CiAgfSk7Cn07CnZhciBvblVuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2UpewogIHRhc2suY2FsbChnbG9iYWwsIGZ1bmN0aW9uKCl7CiAgICB2YXIgdmFsdWUgPSBwcm9taXNlLl92CiAgICAgICwgYWJydXB0LCBoYW5kbGVyLCBjb25zb2xlOwogICAgaWYoaXNVbmhhbmRsZWQocHJvbWlzZSkpewogICAgICBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CiAgICAgICAgaWYoaXNOb2RlKXsKICAgICAgICAgIHByb2Nlc3MuZW1pdCgndW5oYW5kbGVkUmVqZWN0aW9uJywgdmFsdWUsIHByb21pc2UpOwogICAgICAgIH0gZWxzZSBpZihoYW5kbGVyID0gZ2xvYmFsLm9udW5oYW5kbGVkcmVqZWN0aW9uKXsKICAgICAgICAgIGhhbmRsZXIoe3Byb21pc2U6IHByb21pc2UsIHJlYXNvbjogdmFsdWV9KTsKICAgICAgICB9IGVsc2UgaWYoKGNvbnNvbGUgPSBnbG9iYWwuY29uc29sZSkgJiYgY29uc29sZS5lcnJvcil7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb24nLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgLy8gQnJvd3NlcnMgc2hvdWxkIG5vdCB0cmlnZ2VyIGByZWplY3Rpb25IYW5kbGVkYCBldmVudCBpZiBpdCB3YXMgaGFuZGxlZCBoZXJlLCBOb2RlSlMgLSBzaG91bGQKICAgICAgcHJvbWlzZS5faCA9IGlzTm9kZSB8fCBpc1VuaGFuZGxlZChwcm9taXNlKSA/IDIgOiAxOwogICAgfSBwcm9taXNlLl9hID0gdW5kZWZpbmVkOwogICAgaWYoYWJydXB0KXRocm93IGFicnVwdC5lcnJvcjsKICB9KTsKfTsKdmFyIGlzVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgaWYocHJvbWlzZS5faCA9PSAxKXJldHVybiBmYWxzZTsKICB2YXIgY2hhaW4gPSBwcm9taXNlLl9hIHx8IHByb21pc2UuX2MKICAgICwgaSAgICAgPSAwCiAgICAsIHJlYWN0aW9uOwogIHdoaWxlKGNoYWluLmxlbmd0aCA+IGkpewogICAgcmVhY3Rpb24gPSBjaGFpbltpKytdOwogICAgaWYocmVhY3Rpb24uZmFpbCB8fCAhaXNVbmhhbmRsZWQocmVhY3Rpb24ucHJvbWlzZSkpcmV0dXJuIGZhbHNlOwogIH0gcmV0dXJuIHRydWU7Cn07CnZhciBvbkhhbmRsZVVuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2UpewogIHRhc2suY2FsbChnbG9iYWwsIGZ1bmN0aW9uKCl7CiAgICB2YXIgaGFuZGxlcjsKICAgIGlmKGlzTm9kZSl7CiAgICAgIHByb2Nlc3MuZW1pdCgncmVqZWN0aW9uSGFuZGxlZCcsIHByb21pc2UpOwogICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub25yZWplY3Rpb25oYW5kbGVkKXsKICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiBwcm9taXNlLl92fSk7CiAgICB9CiAgfSk7Cn07CnZhciAkcmVqZWN0ID0gZnVuY3Rpb24odmFsdWUpewogIHZhciBwcm9taXNlID0gdGhpczsKICBpZihwcm9taXNlLl9kKXJldHVybjsKICBwcm9taXNlLl9kID0gdHJ1ZTsKICBwcm9taXNlID0gcHJvbWlzZS5fdyB8fCBwcm9taXNlOyAvLyB1bndyYXAKICBwcm9taXNlLl92ID0gdmFsdWU7CiAgcHJvbWlzZS5fcyA9IDI7CiAgaWYoIXByb21pc2UuX2EpcHJvbWlzZS5fYSA9IHByb21pc2UuX2Muc2xpY2UoKTsKICBub3RpZnkocHJvbWlzZSwgdHJ1ZSk7Cn07CnZhciAkcmVzb2x2ZSA9IGZ1bmN0aW9uKHZhbHVlKXsKICB2YXIgcHJvbWlzZSA9IHRoaXMKICAgICwgdGhlbjsKICBpZihwcm9taXNlLl9kKXJldHVybjsKICBwcm9taXNlLl9kID0gdHJ1ZTsKICBwcm9taXNlID0gcHJvbWlzZS5fdyB8fCBwcm9taXNlOyAvLyB1bndyYXAKICB0cnkgewogICAgaWYocHJvbWlzZSA9PT0gdmFsdWUpdGhyb3cgVHlwZUVycm9yKCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZiIpOwogICAgaWYodGhlbiA9IGlzVGhlbmFibGUodmFsdWUpKXsKICAgICAgbWljcm90YXNrKGZ1bmN0aW9uKCl7CiAgICAgICAgdmFyIHdyYXBwZXIgPSB7X3c6IHByb21pc2UsIF9kOiBmYWxzZX07IC8vIHdyYXAKICAgICAgICB0cnkgewogICAgICAgICAgdGhlbi5jYWxsKHZhbHVlLCBjdHgoJHJlc29sdmUsIHdyYXBwZXIsIDEpLCBjdHgoJHJlamVjdCwgd3JhcHBlciwgMSkpOwogICAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgICAkcmVqZWN0LmNhbGwod3JhcHBlciwgZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHByb21pc2UuX3YgPSB2YWx1ZTsKICAgICAgcHJvbWlzZS5fcyA9IDE7CiAgICAgIG5vdGlmeShwcm9taXNlLCBmYWxzZSk7CiAgICB9CiAgfSBjYXRjaChlKXsKICAgICRyZWplY3QuY2FsbCh7X3c6IHByb21pc2UsIF9kOiBmYWxzZX0sIGUpOyAvLyB3cmFwCiAgfQp9OwoKLy8gY29uc3RydWN0b3IgcG9seWZpbGwKaWYoIVVTRV9OQVRJVkUpewogIC8vIDI1LjQuMy4xIFByb21pc2UoZXhlY3V0b3IpCiAgJFByb21pc2UgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKICAgIGFuSW5zdGFuY2UodGhpcywgJFByb21pc2UsIFBST01JU0UsICdfaCcpOwogICAgYUZ1bmN0aW9uKGV4ZWN1dG9yKTsKICAgIEludGVybmFsLmNhbGwodGhpcyk7CiAgICB0cnkgewogICAgICBleGVjdXRvcihjdHgoJHJlc29sdmUsIHRoaXMsIDEpLCBjdHgoJHJlamVjdCwgdGhpcywgMSkpOwogICAgfSBjYXRjaChlcnIpewogICAgICAkcmVqZWN0LmNhbGwodGhpcywgZXJyKTsKICAgIH0KICB9OwogIEludGVybmFsID0gZnVuY3Rpb24gUHJvbWlzZShleGVjdXRvcil7CiAgICB0aGlzLl9jID0gW107ICAgICAgICAgICAgIC8vIDwtIGF3YWl0aW5nIHJlYWN0aW9ucwogICAgdGhpcy5fYSA9IHVuZGVmaW5lZDsgICAgICAvLyA8LSBjaGVja2VkIGluIGlzVW5oYW5kbGVkIHJlYWN0aW9ucwogICAgdGhpcy5fcyA9IDA7ICAgICAgICAgICAgICAvLyA8LSBzdGF0ZQogICAgdGhpcy5fZCA9IGZhbHNlOyAgICAgICAgICAvLyA8LSBkb25lCiAgICB0aGlzLl92ID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIHZhbHVlCiAgICB0aGlzLl9oID0gMDsgICAgICAgICAgICAgIC8vIDwtIHJlamVjdGlvbiBzdGF0ZSwgMCAtIGRlZmF1bHQsIDEgLSBoYW5kbGVkLCAyIC0gdW5oYW5kbGVkCiAgICB0aGlzLl9uID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIG5vdGlmeQogIH07CiAgSW50ZXJuYWwucHJvdG90eXBlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NykoJFByb21pc2UucHJvdG90eXBlLCB7CiAgICAvLyAyNS40LjUuMyBQcm9taXNlLnByb3RvdHlwZS50aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKQogICAgdGhlbjogZnVuY3Rpb24gdGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCl7CiAgICAgIHZhciByZWFjdGlvbiAgICA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHNwZWNpZXNDb25zdHJ1Y3Rvcih0aGlzLCAkUHJvbWlzZSkpOwogICAgICByZWFjdGlvbi5vayAgICAgPSB0eXBlb2Ygb25GdWxmaWxsZWQgPT0gJ2Z1bmN0aW9uJyA/IG9uRnVsZmlsbGVkIDogdHJ1ZTsKICAgICAgcmVhY3Rpb24uZmFpbCAgID0gdHlwZW9mIG9uUmVqZWN0ZWQgPT0gJ2Z1bmN0aW9uJyAmJiBvblJlamVjdGVkOwogICAgICByZWFjdGlvbi5kb21haW4gPSBpc05vZGUgPyBwcm9jZXNzLmRvbWFpbiA6IHVuZGVmaW5lZDsKICAgICAgdGhpcy5fYy5wdXNoKHJlYWN0aW9uKTsKICAgICAgaWYodGhpcy5fYSl0aGlzLl9hLnB1c2gocmVhY3Rpb24pOwogICAgICBpZih0aGlzLl9zKW5vdGlmeSh0aGlzLCBmYWxzZSk7CiAgICAgIHJldHVybiByZWFjdGlvbi5wcm9taXNlOwogICAgfSwKICAgIC8vIDI1LjQuNS4xIFByb21pc2UucHJvdG90eXBlLmNhdGNoKG9uUmVqZWN0ZWQpCiAgICAnY2F0Y2gnOiBmdW5jdGlvbihvblJlamVjdGVkKXsKICAgICAgcmV0dXJuIHRoaXMudGhlbih1bmRlZmluZWQsIG9uUmVqZWN0ZWQpOwogICAgfQogIH0pOwogIFByb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24oKXsKICAgIHZhciBwcm9taXNlICA9IG5ldyBJbnRlcm5hbDsKICAgIHRoaXMucHJvbWlzZSA9IHByb21pc2U7CiAgICB0aGlzLnJlc29sdmUgPSBjdHgoJHJlc29sdmUsIHByb21pc2UsIDEpOwogICAgdGhpcy5yZWplY3QgID0gY3R4KCRyZWplY3QsIHByb21pc2UsIDEpOwogIH07Cn0KCiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtQcm9taXNlOiAkUHJvbWlzZX0pOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKSgkUHJvbWlzZSwgUFJPTUlTRSk7Cl9fd2VicGFja19yZXF1aXJlX18oOTkpKFBST01JU0UpOwpXcmFwcGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKVtQUk9NSVNFXTsKCi8vIHN0YXRpY3MKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgUFJPTUlTRSwgewogIC8vIDI1LjQuNC41IFByb21pc2UucmVqZWN0KHIpCiAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3Qocil7CiAgICB2YXIgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHRoaXMpCiAgICAgICwgJCRyZWplY3QgICA9IGNhcGFiaWxpdHkucmVqZWN0OwogICAgJCRyZWplY3Qocik7CiAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwogIH0KfSk7CiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKExJQlJBUlkgfHwgIVVTRV9OQVRJVkUpLCBQUk9NSVNFLCB7CiAgLy8gMjUuNC40LjYgUHJvbWlzZS5yZXNvbHZlKHgpCiAgcmVzb2x2ZTogZnVuY3Rpb24gcmVzb2x2ZSh4KXsKICAgIC8vIGluc3RhbmNlb2YgaW5zdGVhZCBvZiBpbnRlcm5hbCBzbG90IGNoZWNrIGJlY2F1c2Ugd2Ugc2hvdWxkIGZpeCBpdCB3aXRob3V0IHJlcGxhY2VtZW50IG5hdGl2ZSBQcm9taXNlIGNvcmUKICAgIGlmKHggaW5zdGFuY2VvZiAkUHJvbWlzZSAmJiBzYW1lQ29uc3RydWN0b3IoeC5jb25zdHJ1Y3RvciwgdGhpcykpcmV0dXJuIHg7CiAgICB2YXIgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHRoaXMpCiAgICAgICwgJCRyZXNvbHZlICA9IGNhcGFiaWxpdHkucmVzb2x2ZTsKICAgICQkcmVzb2x2ZSh4KTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQp9KTsKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhKFVTRV9OQVRJVkUgJiYgX193ZWJwYWNrX3JlcXVpcmVfXyg5MykoZnVuY3Rpb24oaXRlcil7CiAgJFByb21pc2UuYWxsKGl0ZXIpWydjYXRjaCddKGVtcHR5KTsKfSkpLCBQUk9NSVNFLCB7CiAgLy8gMjUuNC40LjEgUHJvbWlzZS5hbGwoaXRlcmFibGUpCiAgYWxsOiBmdW5jdGlvbiBhbGwoaXRlcmFibGUpewogICAgdmFyIEMgICAgICAgICAgPSB0aGlzCiAgICAgICwgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KEMpCiAgICAgICwgcmVzb2x2ZSAgICA9IGNhcGFiaWxpdHkucmVzb2x2ZQogICAgICAsIHJlamVjdCAgICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CiAgICAgIHZhciB2YWx1ZXMgICAgPSBbXQogICAgICAgICwgaW5kZXggICAgID0gMAogICAgICAgICwgcmVtYWluaW5nID0gMTsKICAgICAgZm9yT2YoaXRlcmFibGUsIGZhbHNlLCBmdW5jdGlvbihwcm9taXNlKXsKICAgICAgICB2YXIgJGluZGV4ICAgICAgICA9IGluZGV4KysKICAgICAgICAgICwgYWxyZWFkeUNhbGxlZCA9IGZhbHNlOwogICAgICAgIHZhbHVlcy5wdXNoKHVuZGVmaW5lZCk7CiAgICAgICAgcmVtYWluaW5nKys7CiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oZnVuY3Rpb24odmFsdWUpewogICAgICAgICAgaWYoYWxyZWFkeUNhbGxlZClyZXR1cm47CiAgICAgICAgICBhbHJlYWR5Q2FsbGVkICA9IHRydWU7CiAgICAgICAgICB2YWx1ZXNbJGluZGV4XSA9IHZhbHVlOwogICAgICAgICAgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpOwogICAgICAgIH0sIHJlamVjdCk7CiAgICAgIH0pOwogICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICB9KTsKICAgIGlmKGFicnVwdClyZWplY3QoYWJydXB0LmVycm9yKTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfSwKICAvLyAyNS40LjQuNCBQcm9taXNlLnJhY2UoaXRlcmFibGUpCiAgcmFjZTogZnVuY3Rpb24gcmFjZShpdGVyYWJsZSl7CiAgICB2YXIgQyAgICAgICAgICA9IHRoaXMKICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKICAgICAgLCByZWplY3QgICAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgICB2YXIgYWJydXB0ID0gcGVyZm9ybShmdW5jdGlvbigpewogICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2UpewogICAgICAgIEMucmVzb2x2ZShwcm9taXNlKS50aGVuKGNhcGFiaWxpdHkucmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgfSk7CiAgICB9KTsKICAgIGlmKGFicnVwdClyZWplY3QoYWJydXB0LmVycm9yKTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQp9KTsKCi8qKiovIH0pLAovKiAxMDYgKi8sCi8qIDEwNyAqLywKLyogMTA4ICovLAovKiAxMDkgKi8sCi8qIDExMCAqLywKLyogMTExICovLAovKiAxMTIgKi8sCi8qIDExMyAqLywKLyogMTE0ICovLAovKiAxMTUgKi8sCi8qIDExNiAqLywKLyogMTE3ICovLAovKiAxMTggKi8sCi8qIDExOSAqLywKLyogMTIwICovLAovKiAxMjEgKi8sCi8qIDEyMiAqLywKLyogMTIzICovLAovKiAxMjQgKi8sCi8qIDEyNSAqLywKLyogMTI2ICovLAovKiAxMjcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfcHJvbWlzZSA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpOwoKdmFyIF9wcm9taXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Byb21pc2UpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKKiBDb3JlIERpc2NvdmVyeSBpbnRlcmZhY2UKKiBDbGFzcyB0byBhbGxvdyBhcHBsaWNhdGlvbnMgdG8gc2VhcmNoIGZvciBoeXBlcnRpZXMgYW5kIERhdGFPYmplY3RzIHVzaW5nIHRoZSBtZXNzYWdlIGJ1cwoqLwp2YXIgRGlzY292ZXJ5ID0gZnVuY3Rpb24gKCkgewoKICAvKioKICAqIFRvIGluaXRpYWxpc2UgdGhlIEh5cGVydHlEaXNjb3Zlciwgd2hpY2ggd2lsbCBwcm92aWRlIHRoZSBzdXBwb3J0IGZvciBoeXBlcnRpZXMgdG8KICAqIHF1ZXJ5IHVzZXJzIHJlZ2lzdGVyZWQgaW4gb3V0c2lkZSB0aGUgaW50ZXJuYWwgY29yZS4KICAqIEBwYXJhbSAge01lc3NhZ2VCdXN9ICAgICAgICAgIG1zZ2J1cyAgICAgICAgICAgICAgICBtc2didXMKICAqIEBwYXJhbSAge1J1bnRpbWVVUkx9ICAgICAgICAgIHJ1bnRpbWVVUkwgICAgICAgICAgICBydW50aW1lVVJMCiAgKi8KICBmdW5jdGlvbiBEaXNjb3ZlcnkoaHlwZXJ0eVVSTCwgcnVudGltZVVSTCwgbXNnQnVzKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBEaXNjb3ZlcnkpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICBfdGhpcy5tZXNzYWdlQnVzID0gbXNnQnVzOwogICAgX3RoaXMucnVudGltZVVSTCA9IHJ1bnRpbWVVUkw7CgogICAgX3RoaXMuZG9tYWluID0gKDAsIF91dGlscy5kaXZpZGVVUkwpKGh5cGVydHlVUkwpLmRvbWFpbjsKICAgIF90aGlzLmRpc2NvdmVyeVVSTCA9IGh5cGVydHlVUkw7CiAgfQoKICAvKioKICAqIEFkdmFuY2VkIFNlYXJjaCBmb3IgSHlwZXJ0aWVzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5IGFzc29jaWF0ZWQgd2l0aCBzb21lIHVzZXIgaWRlbnRpZmllciAoZWcgZW1haWwsIG5hbWUgLi4uKQogICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgdXNlcklkZW50aWZpZXIKICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHNjaGVtYSAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBoeXBlcnRpZXMgc2NoZW1hcwogICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGh5cGVydGllcyByZXNvdXJjZXMKICAqLwoKCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGlzY292ZXJ5LCBbewogICAga2V5OiAnX2lzTGVnYWN5VXNlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2lzTGVnYWN5VXNlcih1c2VySWRlbnRpZmllcikgewogICAgICBpZiAodXNlcklkZW50aWZpZXIuaW5jbHVkZXMoJzonKSAmJiAhdXNlcklkZW50aWZpZXIuaW5jbHVkZXMoJ3VzZXI6Ly8nKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgKiBBZHZhbmNlZCBTZWFyY2ggZm9yIEh5cGVydGllcyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSBhc3NvY2lhdGVkIHdpdGggc29tZSB1c2VyIGlkZW50aWZpZXIgKGVnIGVtYWlsLCBuYW1lIC4uLikKICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgdXNlcklkZW50aWZpZXIKICAgICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGh5cGVydGllcyBzY2hlbWFzCiAgICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBoeXBlcnRpZXMgcmVzb3VyY2VzCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkaXNjb3Zlckh5cGVydGllc1BlclVzZXJQcm9maWxlRGF0YScsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY292ZXJIeXBlcnRpZXNQZXJVc2VyUHJvZmlsZURhdGEodXNlcklkZW50aWZpZXIsIHNjaGVtYSwgcmVzb3VyY2VzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgbXNnID0gewogICAgICAgIHR5cGU6ICdyZWFkJywKICAgICAgICBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsCiAgICAgICAgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nLAogICAgICAgIGJvZHk6IHsKICAgICAgICAgIHJlc291cmNlOiAnL2h5cGVydHkvdXNlcnByb2ZpbGUvJyArIHVzZXJJZGVudGlmaWVyCiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKHNjaGVtYSB8fCByZXNvdXJjZXMpIHsKICAgICAgICBtc2cuYm9keVsnY3JpdGVyaWEnXSA9IHsKICAgICAgICAgIHJlc291cmNlczogcmVzb3VyY2VzLAogICAgICAgICAgZGF0YVNjaGVtZXM6IHNjaGVtYQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBpZiAoIV90aGlzLl9pc0xlZ2FjeVVzZXIodXNlcklkZW50aWZpZXIpKSB7CiAgICAgICAgICAvLyB0b2RvOiB0byByZW9tdmUgd2hlbiBkaXNjb3Zlcnkgb2YgbGVnY2F5IHVzZXJzIGFyZSBzdXBwb3J0ZWQKICAgICAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKCiAgICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXBseSBsb2c6ICIsIHJlcGx5LmJvZHkudmFsdWUpOwogICAgICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIExvZzogIiwgcmVwbHkuYm9keS5kZXNjcmlwdGlvbik7CiAgICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzY3JpcHRpb24pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzb2x2ZSh7IGh5cGVydHlJRDogdXNlcklkZW50aWZpZXIgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICogQWR2YW5jZWQgU2VhcmNoIGZvciBEYXRhT2JqZWN0cyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSBhc3NvY2lhdGVkIHdpdGggc29tZSB1c2VyIGlkZW50aWZpZXIgKGVnIGVtYWlsLCBuYW1lIC4uLikKICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgdXNlcklkZW50aWZpZXIKICAgICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGh5cGVydGllcyBzY2hlbWFzCiAgICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBoeXBlcnRpZXMgcmVzb3VyY2VzCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkaXNjb3ZlckRhdGFPYmplY3RzUGVyVXNlclByb2ZpbGVEYXRhJywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb3ZlckRhdGFPYmplY3RzUGVyVXNlclByb2ZpbGVEYXRhKHVzZXJJZGVudGlmaWVyLCBzY2hlbWEsIHJlc291cmNlcykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICB0eXBlOiAncmVhZCcsCiAgICAgICAgZnJvbTogX3RoaXMuZGlzY292ZXJ5VVJMLAogICAgICAgIHRvOiBfdGhpcy5ydW50aW1lVVJMICsgJy9kaXNjb3ZlcnkvJywKICAgICAgICBib2R5OiB7CiAgICAgICAgICByZXNvdXJjZTogJy9kYXRhT2JqZWN0L3VzZXJwcm9maWxlLycgKyB1c2VySWRlbnRpZmllcgogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChzY2hlbWEgfHwgcmVzb3VyY2VzKSB7CiAgICAgICAgbXNnLmJvZHlbJ2NyaXRlcmlhJ10gPSB7CiAgICAgICAgICByZXNvdXJjZXM6IHJlc291cmNlcywKICAgICAgICAgIGRhdGFTY2hlbWVzOiBzY2hlbWEKICAgICAgICB9OwogICAgICB9CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgaWYgKCFfdGhpcy5faXNMZWdhY3lVc2VyKHVzZXJJZGVudGlmaWVyKSkgewogICAgICAgICAgLy8gdG9kbzogdG8gcmVvbXZlIHdoZW4gZGlzY292ZXJ5IG9mIGxlZ2NheSB1c2VycyBhcmUgc3VwcG9ydGVkCgogICAgICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2csIGZ1bmN0aW9uIChyZXBseSkgewoKICAgICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIlJlcGx5IGxvZzogIiwgcmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LnZhbHVlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgTG9nOiAiLCByZXBseS5ib2R5LmRlc2NyaXB0aW9uKTsKICAgICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjcmlwdGlvbik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXNvbHZlKHsgaHlwZXJ0eUlEOiB1c2VySWRlbnRpZmllciB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgKiBBZHZhbmNlZCBTZWFyY2ggZm9yIEh5cGVydGllcyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSBhc3NvY2lhdGVkIHdpdGggc29tZSBHVUlECiAgICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGd1aWRVUkwgICAgICAgICAgICAgICAgZ3VpZCBVUkwgZS5nIHVzZXItZ3VpZDovLzx1bmlxdWUtdXNlci1pZGVudGlmaWVyPgogICAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICBzY2hlbWEgKE9wdGlvbmFsKSAgICAgdHlwZXMgb2YgaHlwZXJ0aWVzIHNjaGVtYXMKICAgICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGh5cGVydGllcyByZXNvdXJjZXMKICAgICovCgogIH0sIHsKICAgIGtleTogJ2Rpc2NvdmVySHlwZXJ0aWVzUGVyR1VJRCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY292ZXJIeXBlcnRpZXNQZXJHVUlEKGd1aWRVUkwsIHNjaGVtYSwgcmVzb3VyY2VzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgbXNnID0gewogICAgICAgIHR5cGU6ICdyZWFkJywKICAgICAgICBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsCiAgICAgICAgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nLAogICAgICAgIGJvZHk6IHsKICAgICAgICAgIHJlc291cmNlOiAnL2h5cGVydHkvZ3VpZC8nICsgZ3VpZFVSTAogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChzY2hlbWEgfHwgcmVzb3VyY2VzKSB7CiAgICAgICAgbXNnLmJvZHlbJ2NyaXRlcmlhJ10gPSB7CiAgICAgICAgICByZXNvdXJjZXM6IHJlc291cmNlcywKICAgICAgICAgIGRhdGFTY2hlbWVzOiBzY2hlbWEKICAgICAgICB9OwogICAgICB9CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2csIGZ1bmN0aW9uIChyZXBseSkgewoKICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiUmVwbHkgbG9nOiAiLCByZXBseS5ib2R5LnZhbHVlKTsKICAgICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LnZhbHVlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciBMb2c6ICIsIHJlcGx5LmJvZHkuZGVzY3JpcHRpb24pOwogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjcmlwdGlvbik7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgKiBBZHZhbmNlZCBTZWFyY2ggZm9yIERhdGFPYmplY3RzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5IGFzc29jaWF0ZWQgd2l0aCBzb21lIEdVSUQKICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgZ3VpZFVSTCAgICAgICAgICAgICAgICBndWlkIFVSTCBlLmcgdXNlci1ndWlkOi8vPHVuaXF1ZS11c2VyLWlkZW50aWZpZXI+CiAgICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHNjaGVtYSAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBoeXBlcnRpZXMgc2NoZW1hcwogICAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICByZXNvdXJjZXMgKE9wdGlvbmFsKSAgdHlwZXMgb2YgaHlwZXJ0aWVzIHJlc291cmNlcwogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKSAgICAgZG9tYWluIG9mIHRoZSByZWdpc3RyeSB0byBzZWFyY2gKICAgICovCgogIH0sIHsKICAgIGtleTogJ2Rpc2NvdmVyRGF0YU9iamVjdHNQZXJHVUlEJywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb3ZlckRhdGFPYmplY3RzUGVyR1VJRChndWlkVVJMLCBzY2hlbWEsIHJlc291cmNlcykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICB0eXBlOiAncmVhZCcsCiAgICAgICAgZnJvbTogX3RoaXMuZGlzY292ZXJ5VVJMLAogICAgICAgIHRvOiBfdGhpcy5ydW50aW1lVVJMICsgJy9kaXNjb3ZlcnkvJywKICAgICAgICBib2R5OiB7CiAgICAgICAgICByZXNvdXJjZTogJy9kYXRhT2JqZWN0L2d1aWQvJyArIGd1aWRVUkwKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoc2NoZW1hIHx8IHJlc291cmNlcykgewogICAgICAgIG1zZy5ib2R5Wydjcml0ZXJpYSddID0gewogICAgICAgICAgcmVzb3VyY2VzOiByZXNvdXJjZXMsCiAgICAgICAgICBkYXRhU2NoZW1lczogc2NoZW1hCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlJlcGx5IGxvZzogIiwgcmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgTG9nOiAiLCByZXBseS5ib2R5LmRlc2NyaXB0aW9uKTsKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzY3JpcHRpb24pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICAvKiogQWR2YW5jZWQgU2VhcmNoIGZvciBIeXBlcnRpZXMgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnkKICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgdXNlciAgICAgICAgICAgICAgICAgIHVzZXIgaWRlbnRpZmllciwgZWl0aGVyIGluIHVybCBvciBlbWFpbCBmb3JtYXQKICAgICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGh5cGVydGllcyBzY2hlbWFzCiAgICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBoeXBlcnRpZXMgcmVzb3VyY2VzCiAgICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpICAgICBkb21haW4gb2YgdGhlIHJlZ2lzdHJ5IHRvIHNlYXJjaAogICAgKi8KCiAgfSwgewogICAga2V5OiAnZGlzY292ZXJIeXBlcnRpZXMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2NvdmVySHlwZXJ0aWVzKHVzZXIsIHNjaGVtYSwgcmVzb3VyY2VzLCBkb21haW4pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGFjdGl2ZURvbWFpbiA9IHZvaWQgMDsKCiAgICAgIGFjdGl2ZURvbWFpbiA9ICFkb21haW4gPyBfdGhpcy5kb21haW4gOiBkb21haW47CgogICAgICB2YXIgbXNnID0gewogICAgICAgIHR5cGU6ICdyZWFkJywKICAgICAgICBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsCiAgICAgICAgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nLAogICAgICAgIGJvZHk6IHsKICAgICAgICAgIHJlc291cmNlOiAnL2h5cGVydHkvdXNlci8nICsgdXNlcgogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChzY2hlbWEgfHwgcmVzb3VyY2VzKSB7CiAgICAgICAgbXNnLmJvZHlbJ2NyaXRlcmlhJ10gPSB7CiAgICAgICAgICByZXNvdXJjZXM6IHJlc291cmNlcywKICAgICAgICAgIGRhdGFTY2hlbWVzOiBzY2hlbWEsCiAgICAgICAgICBkb21haW46IGFjdGl2ZURvbWFpbgogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbXNnLmJvZHlbJ2NyaXRlcmlhJ10gPSB7CiAgICAgICAgICBkb21haW46IGFjdGl2ZURvbWFpbgogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBpZiAoIV90aGlzLl9pc0xlZ2FjeVVzZXIodXNlcikpIHsKICAgICAgICAgIC8vIHRvZG86IHRvIHJlb212ZSB3aGVuIGRpc2NvdmVyeSBvZiBsZWdjYXkgdXNlcnMgYXJlIHN1cHBvcnRlZAoKICAgICAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKCiAgICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXBseSBsb2c6ICIsIHJlcGx5LmJvZHkudmFsdWUpOwogICAgICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIExvZzogIiwgcmVwbHkuYm9keS5kZXNjcmlwdGlvbik7CiAgICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzY3JpcHRpb24pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzb2x2ZSh7IGh5cGVydHlJRDogdXNlciB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8qKiBBZHZhbmNlZCBTZWFyY2ggZm9yIERhdGFPYmplY3RzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5CiAgICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIHVzZXIgICAgICAgICAgICAgICAgICB1c2VyIGlkZW50aWZpZXIsIGVpdGhlciBpbiB1cmwgb3IgZW1haWwgZm9ybWF0CiAgICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHNjaGVtYSAoT3B0aW9uYWwpICAgICB0eXBlcyBvZiBkYXRhT2JqZWN0cyBzY2hlbWFzCiAgICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBkYXRhT2JqZWN0cyByZXNvdXJjZXMKICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgZG9tYWluIChPcHRpb25hbCkgICAgIGRvbWFpbiBvZiB0aGUgcmVnaXN0cnkgdG8gc2VhcmNoCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkaXNjb3ZlckRhdGFPYmplY3RzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb3ZlckRhdGFPYmplY3RzKHVzZXIsIHNjaGVtYSwgcmVzb3VyY2VzLCBkb21haW4pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGFjdGl2ZURvbWFpbiA9IHZvaWQgMDsKCiAgICAgIGFjdGl2ZURvbWFpbiA9ICFkb21haW4gPyBfdGhpcy5kb21haW4gOiBkb21haW47CgogICAgICB2YXIgbXNnID0gewogICAgICAgIHR5cGU6ICdyZWFkJywKICAgICAgICBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsCiAgICAgICAgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nLAogICAgICAgIGJvZHk6IHsKICAgICAgICAgIHJlc291cmNlOiAnL2RhdGFPYmplY3QvdXNlci8nICsgdXNlcgogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChzY2hlbWEgfHwgcmVzb3VyY2VzKSB7CiAgICAgICAgbXNnLmJvZHlbJ2NyaXRlcmlhJ10gPSB7CiAgICAgICAgICByZXNvdXJjZXM6IHJlc291cmNlcywKICAgICAgICAgIGRhdGFTY2hlbWVzOiBzY2hlbWEsCiAgICAgICAgICBkb21haW46IGFjdGl2ZURvbWFpbgogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbXNnLmJvZHlbJ2NyaXRlcmlhJ10gPSB7CiAgICAgICAgICBkb21haW46IGFjdGl2ZURvbWFpbgogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXBseSBWYWx1ZSBMb2c6ICIsIHJlcGx5LmJvZHkudmFsdWUpOwogICAgICAgICAgICByZXNvbHZlKHJlcGx5LmJvZHkudmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIExvZzogIiwgcmVwbHkuYm9keS5kZXNjcmlwdGlvbik7CiAgICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2NyaXB0aW9uKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAqIGZ1bmN0aW9uIHRvIHJlcXVlc3QgYWJvdXQgaHlwZXJ0aWVzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5LCBhbmQKICAgICogcmV0dXJuIHRoZSBoeXBlcnR5IGluZm9ybWF0aW9uLCBpZiBmb3VuZC4KICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgICAgdXJsICBoeXBlcnR5IFVSTAogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgZG9tYWluIChPcHRpb25hbCkKICAgICovCgogIH0sIHsKICAgIGtleTogJ2Rpc2NvdmVySHlwZXJ0eVBlclVSTCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY292ZXJIeXBlcnR5UGVyVVJMKHVybCwgZG9tYWluKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBhY3RpdmVEb21haW4gPSB2b2lkIDA7CgogICAgICBhY3RpdmVEb21haW4gPSAhZG9tYWluID8gX3RoaXMuZG9tYWluIDogZG9tYWluOwoKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICB0eXBlOiAncmVhZCcsCiAgICAgICAgZnJvbTogX3RoaXMuZGlzY292ZXJ5VVJMLAogICAgICAgIHRvOiBfdGhpcy5ydW50aW1lVVJMICsgJy9kaXNjb3ZlcnkvJywKICAgICAgICBib2R5OiB7CiAgICAgICAgICByZXNvdXJjZTogJy9oeXBlcnR5L3VybC8nICsgdXJsLAogICAgICAgICAgY3JpdGVyaWE6IHsKICAgICAgICAgICAgZG9tYWluOiBhY3RpdmVEb21haW4KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2csIGZ1bmN0aW9uIChyZXBseSkgewoKICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiUmVwbHkgVmFsdWUgTG9nOiAiLCByZXBseS5ib2R5LnZhbHVlKTsKICAgICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LnZhbHVlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciBMb2c6ICIsIHJlcGx5LmJvZHkuZGVzY3JpcHRpb24pOwogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjcmlwdGlvbik7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IGRhdGFPYmplY3QgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnksIGFuZAogICAgKiByZXR1cm4gdGhlIGRhdGFPYmplY3QgaW5mb3JtYXRpb24sIGlmIGZvdW5kLgogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgICB1cmwgIGRhdGFPYmplY3QgVVJMCiAgICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKQogICAgKi8KCiAgfSwgewogICAga2V5OiAnZGlzY292ZXJEYXRhT2JqZWN0UGVyVVJMJywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb3ZlckRhdGFPYmplY3RQZXJVUkwodXJsLCBkb21haW4pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGFjdGl2ZURvbWFpbiA9IHZvaWQgMDsKCiAgICAgIGFjdGl2ZURvbWFpbiA9ICFkb21haW4gPyBfdGhpcy5kb21haW4gOiBkb21haW47CgogICAgICB2YXIgbXNnID0gewogICAgICAgIHR5cGU6ICdyZWFkJywKICAgICAgICBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsCiAgICAgICAgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nLAogICAgICAgIGJvZHk6IHsKICAgICAgICAgIHJlc291cmNlOiAnL2RhdGFPYmplY3QvdXJsLycgKyB1cmwsCiAgICAgICAgICBjcml0ZXJpYTogewogICAgICAgICAgICBkb21haW46IGFjdGl2ZURvbWFpbgogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXBseSBWYWx1ZSBMb2c6ICIsIHJlcGx5LmJvZHkudmFsdWUpOwogICAgICAgICAgICByZXNvbHZlKHJlcGx5LmJvZHkudmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIExvZzogIiwgcmVwbHkuYm9keS5kZXNjcmlwdGlvbik7CiAgICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2NyaXB0aW9uKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAqIGZ1bmN0aW9uIHRvIHJlcXVlc3QgYWJvdXQgYW4gZGF0YU9iamVjdHMgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnkgd2l0aCBhIGdpdmVuIG5hbWUsIGFuZAogICAgKiByZXR1cm4gdGhlIGRhdGFPYmplY3RzIGluZm9ybWF0aW9uLCBpZiBmb3VuZC4KICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgICAgbmFtZSAgZGF0YU9iamVjdCBVUkwKICAgICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHNjaGVtYXMKICAgICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHJlc291cmNlcwogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICAgZG9tYWluIChPcHRpb25hbCkKICAgICovCgogIH0sIHsKICAgIGtleTogJ2Rpc2NvdmVyRGF0YU9iamVjdHNQZXJOYW1lJywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb3ZlckRhdGFPYmplY3RzUGVyTmFtZShuYW1lLCBzY2hlbWEsIHJlc291cmNlcywgZG9tYWluKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBhY3RpdmVEb21haW4gPSB2b2lkIDA7CgogICAgICBhY3RpdmVEb21haW4gPSAhZG9tYWluID8gX3RoaXMuZG9tYWluIDogZG9tYWluOwoKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICB0eXBlOiAncmVhZCcsCiAgICAgICAgZnJvbTogX3RoaXMuZGlzY292ZXJ5VVJMLAogICAgICAgIHRvOiBfdGhpcy5ydW50aW1lVVJMICsgJy9kaXNjb3ZlcnkvJywKICAgICAgICBib2R5OiB7CiAgICAgICAgICByZXNvdXJjZTogJy9kYXRhT2JqZWN0L25hbWUvJyArIG5hbWUKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoc2NoZW1hIHx8IHJlc291cmNlcykgewogICAgICAgIG1zZy5ib2R5Wydjcml0ZXJpYSddID0gewogICAgICAgICAgcmVzb3VyY2VzOiByZXNvdXJjZXMsCiAgICAgICAgICBkYXRhU2NoZW1lczogc2NoZW1hLAogICAgICAgICAgZG9tYWluOiBhY3RpdmVEb21haW4KICAgICAgICB9OwogICAgICB9IGVsc2UgewogICAgICAgIG1zZy5ib2R5Wydjcml0ZXJpYSddID0gewogICAgICAgICAgZG9tYWluOiBhY3RpdmVEb21haW4KICAgICAgICB9OwogICAgICB9CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2csIGZ1bmN0aW9uIChyZXBseSkgewoKICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiUmVwbHkgVmFsdWUgTG9nOiAiLCByZXBseS5ib2R5LnZhbHVlKTsKICAgICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LnZhbHVlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciBMb2c6ICIsIHJlcGx5LmJvZHkuZGVzY3JpcHRpb24pOwogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjcmlwdGlvbik7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IHNwZWNpZmljIHJlcG9ydGVyIGRhdGFPYmplY3QgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnksIGFuZAogICAgKiByZXR1cm4gdGhlIGRhdGFPYmplY3RzIGZyb20gdGhhdCByZXBvcnRlci4KICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgcmVwb3J0ZXIgICAgIGRhdGFPYmplY3QgcmVwb3J0ZXIKICAgICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHNjaGVtYXMKICAgICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgcmVzb3VyY2VzIChPcHRpb25hbCkgIHR5cGVzIG9mIGRhdGFPYmplY3RzIHJlc291cmNlcwogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICBkb21haW4gICAgICAgKE9wdGlvbmFsKQogICAgKi8KCiAgfSwgewogICAga2V5OiAnZGlzY292ZXJEYXRhT2JqZWN0c1BlclJlcG9ydGVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb3ZlckRhdGFPYmplY3RzUGVyUmVwb3J0ZXIocmVwb3J0ZXIsIHNjaGVtYSwgcmVzb3VyY2VzLCBkb21haW4pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGFjdGl2ZURvbWFpbiA9IHZvaWQgMDsKCiAgICAgIGFjdGl2ZURvbWFpbiA9ICFkb21haW4gPyBfdGhpcy5kb21haW4gOiBkb21haW47CgogICAgICB2YXIgbXNnID0gewogICAgICAgIHR5cGU6ICdyZWFkJywKICAgICAgICBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsCiAgICAgICAgdG86IF90aGlzLnJ1bnRpbWVVUkwgKyAnL2Rpc2NvdmVyeS8nLAogICAgICAgIGJvZHk6IHsKICAgICAgICAgIHJlc291cmNlOiAnL2RhdGFPYmplY3QvcmVwb3J0ZXIvJyArIHJlcG9ydGVyCiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKHNjaGVtYSB8fCByZXNvdXJjZXMpIHsKICAgICAgICBtc2cuYm9keVsnY3JpdGVyaWEnXSA9IHsKICAgICAgICAgIHJlc291cmNlczogcmVzb3VyY2VzLAogICAgICAgICAgZGF0YVNjaGVtZXM6IHNjaGVtYSwKICAgICAgICAgIGRvbWFpbjogYWN0aXZlRG9tYWluCiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtc2cuYm9keVsnY3JpdGVyaWEnXSA9IHsKICAgICAgICAgIGRvbWFpbjogYWN0aXZlRG9tYWluCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlJlcGx5IFZhbHVlIExvZzogIiwgcmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgTG9nOiAiLCByZXBseS5ib2R5LmRlc2NyaXB0aW9uKTsKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzY3JpcHRpb24pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICAvKiogQWR2YW5jZWQgU2VhcmNoIGZvciBkYXRhT2JqZWN0cyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeQogICAgKiBAZGVwcmVjYXRlZCBEZXByZWNhdGVkLiBVc2UgZGlzY292ZXJEYXRhT2JqZWN0c1Blck5hbWUgaW5zdGVhZAogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICBuYW1lICAgICAgICAgICAgICAgICAgbmFtZSBvZiB0aGUgZGF0YU9iamVjdAogICAgKiBAcGFyYW0gIHtBcnJheTxzdHJpbmc+fSAgICBzY2hlbWEgKE9wdGlvbmFsKSAgICAgdHlwZXMgb2YgZGF0YU9iamVjdCBzY2hlbWFzCiAgICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBkYXRhT2JqZWN0IHJlc291cmNlcwogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKSAgICAgZG9tYWluIG9mIHRoZSByZWdpc3RyeSB0byBzZWFyY2gKICAgICovCgogIH0sIHsKICAgIGtleTogJ2Rpc2NvdmVyRGF0YU9iamVjdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY292ZXJEYXRhT2JqZWN0KG5hbWUsIHNjaGVtYSwgcmVzb3VyY2VzLCBkb21haW4pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGFjdGl2ZURvbWFpbiA9IHZvaWQgMDsKICAgICAgLy9sZXQgdXNlcklkZW50aWZpZXIgPSBjb252ZXJ0VG9Vc2VyVVJMKHVzZXIpOwoKICAgICAgYWN0aXZlRG9tYWluID0gIWRvbWFpbiA/IF90aGlzLmRvbWFpbiA6IGRvbWFpbjsKCiAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsIHRvOiAnZG9tYWluOi8vcmVnaXN0cnkuJyArIGFjdGl2ZURvbWFpbiArICcvJywgYm9keTogeyByZXNvdXJjZTogbmFtZSwKICAgICAgICAgIGNyaXRlcmlhOiB7IHJlc291cmNlczogcmVzb3VyY2VzLCBkYXRhU2NoZW1lczogc2NoZW1hIH0KICAgICAgICB9CiAgICAgIH07CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2csIGZ1bmN0aW9uIChyZXBseSkgewoKICAgICAgICAgIHZhciBoeXBlcnRpZXMgPSByZXBseS5ib2R5LnZhbHVlOwoKICAgICAgICAgIGlmIChoeXBlcnRpZXMpIHsKICAgICAgICAgICAgcmVzb2x2ZShoeXBlcnRpZXMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVqZWN0KCdObyBEYXRhT2JqZWN0IHdhcyBmb3VuZCcpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICAvKiogQWR2YW5jZWQgU2VhcmNoIGZvciBIeXBlcnRpZXMgcmVnaXN0ZXJlZCBpbiBkb21haW4gcmVnaXN0cnkKICAgICogQGRlcHJlY2F0ZWQgRGVwcmVjYXRlZC4gVXNlIGRpc2NvdmVySHlwZXJ0aWVzIGluc3RlYWQKICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgICAgICAgdXNlciAgICAgICAgICAgICAgICAgIHVzZXIgaWRlbnRpZmllciwgZWl0aGVyIGluIHVybCBvciBlbWFpbCBmb3JtYXQKICAgICogQHBhcmFtICB7QXJyYXk8c3RyaW5nPn0gICAgc2NoZW1hIChPcHRpb25hbCkgICAgIHR5cGVzIG9mIGh5cGVydGllcyBzY2hlbWFzCiAgICAqIEBwYXJhbSAge0FycmF5PHN0cmluZz59ICAgIHJlc291cmNlcyAoT3B0aW9uYWwpICB0eXBlcyBvZiBoeXBlcnRpZXMgcmVzb3VyY2VzCiAgICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgICAgIGRvbWFpbiAoT3B0aW9uYWwpICAgICBkb21haW4gb2YgdGhlIHJlZ2lzdHJ5IHRvIHNlYXJjaAogICAgKi8KCiAgfSwgewogICAga2V5OiAnZGlzY292ZXJIeXBlcnR5JywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb3Zlckh5cGVydHkodXNlciwgc2NoZW1hLCByZXNvdXJjZXMsIGRvbWFpbikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgYWN0aXZlRG9tYWluID0gdm9pZCAwOwogICAgICB2YXIgdXNlcklkZW50aWZpZXIgPSAoMCwgX3V0aWxzLmNvbnZlcnRUb1VzZXJVUkwpKHVzZXIpOwoKICAgICAgaWYgKCFkb21haW4pIHsKICAgICAgICBhY3RpdmVEb21haW4gPSBfdGhpcy5kb21haW47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWN0aXZlRG9tYWluID0gZG9tYWluOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgY29uc29sZS5sb2coJ1tEaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnR5XSBBQ1RJVkUgRE9NQUlOIC0+ICcsIGFjdGl2ZURvbWFpbiwgJ3VzZXItPicsIHVzZXIsICdzY2hlbWEtPicsIHNjaGVtYSwgJ3Jlc291cmNlcy0+JywgcmVzb3VyY2VzLCAnZG9tYWluLT4nLCBkb21haW4pOwogICAgICAgIGlmICh1c2VyLmluY2x1ZGVzKCc6JykgJiYgIXVzZXIuaW5jbHVkZXMoJ3VzZXI6Ly8nKSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tEaXNjb3ZlcnkuZGlzY292ZXJIeXBlcnR5XSAnICsgdXNlciArICcgaXMgbGVnYWN5IGRvbWFpbicpOwogICAgICAgICAgdmFyIGxlZ2FjeVVzZXIgPSB7IHVzZXJJRDogdXNlciwgaHlwZXJ0eUlEOiB1c2VyLCBzY2hlbWE6IHNjaGVtYSwgcmVzb3VyY2VzOiByZXNvdXJjZXMgfTsKICAgICAgICAgIHJldHVybiByZXNvbHZlKGxlZ2FjeVVzZXIpOwogICAgICAgIH0KICAgICAgICB2YXIgbXNnID0gewogICAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5kaXNjb3ZlcnlVUkwsIHRvOiAnZG9tYWluOi8vcmVnaXN0cnkuJyArIGFjdGl2ZURvbWFpbiArICcvJywgYm9keTogeyByZXNvdXJjZTogdXNlcklkZW50aWZpZXIsCiAgICAgICAgICAgIGNyaXRlcmlhOiB7IHJlc291cmNlczogcmVzb3VyY2VzLCBkYXRhU2NoZW1lczogc2NoZW1hIH0KICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBjb25zb2xlLmluZm8oJ1tEaXNjb3ZlcnldIG1zZyB0byBzZW5kLT4nLCBtc2cpOwoKICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgogICAgICAgICAgY29uc29sZS5pbmZvKCdbRGlzY292ZXJ5XSBPTiBkaXNjb3Zlckh5cGVydHktPicsIHJlcGx5KTsKICAgICAgICAgIHZhciBoeXBlcnRpZXMgPSByZXBseS5ib2R5LnZhbHVlOwoKICAgICAgICAgIGlmIChoeXBlcnRpZXMpIHsKICAgICAgICAgICAgcmVzb2x2ZShoeXBlcnRpZXMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVqZWN0KCdObyBIeXBlcnR5IHdhcyBmb3VuZCcpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICogZnVuY3Rpb24gdG8gcmVxdWVzdCBhYm91dCB1c2VycyByZWdpc3RlcmVkIGluIGRvbWFpbiByZWdpc3RyeSwgYW5kCiAgICAqIHJldHVybiB0aGUgbGFzdCBoeXBlcnR5IGluc3RhbmNlIHJlZ2lzdGVyZWQgYnkgdGhlIHVzZXIuCiAgICAqIEBkZXByZWNhdGVkIERlcHJlY2F0ZWQuIFVzZSBkaXNjb3Zlckh5cGVydHkgaW5zdGVhZAogICAgKiBAcGFyYW0gIHtlbWFpbH0gICAgICAgICAgICAgIGVtYWlsCiAgICAqIEBwYXJhbSAge2RvbWFpbn0gICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKQogICAgKi8KCiAgfSwgewogICAga2V5OiAnZGlzY292ZXJIeXBlcnR5UGVyVXNlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY292ZXJIeXBlcnR5UGVyVXNlcihlbWFpbCwgZG9tYWluKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBhY3RpdmVEb21haW4gPSB2b2lkIDA7CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgLy8gSGFjayBmb3IgbGVnYWN5IHVzZXJzCiAgICAgICAgaWYgKGVtYWlsLmluY2x1ZGVzKCc6JykgJiYgIWVtYWlsLmluY2x1ZGVzKCd1c2VyOi8vJykpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbRGlzY292ZXJ5LmRpc2NvdmVySHlwZXJ0eV0gJyArIGVtYWlsICsgJ2lzIGxlZ2FjeSBkb21haW4nKTsKICAgICAgICAgIHZhciBsZWdhY3lVc2VyID0geyBpZDogZW1haWwsIGh5cGVydHlVUkw6IGVtYWlsLCBkZXNjcmlwdG9yOiAndW5rbm93bicgfTsKICAgICAgICAgIHJldHVybiByZXNvbHZlKGxlZ2FjeVVzZXIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFkb21haW4pIHsKICAgICAgICAgIGFjdGl2ZURvbWFpbiA9IF90aGlzLmRvbWFpbjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWN0aXZlRG9tYWluID0gZG9tYWluOwogICAgICAgIH0KCiAgICAgICAgdmFyIGlkZW50aXR5VVJMID0gJ3VzZXI6Ly8nICsgZW1haWwuc3Vic3RyaW5nKGVtYWlsLmluZGV4T2YoJ0AnKSArIDEsIGVtYWlsLmxlbmd0aCkgKyAnLycgKyBlbWFpbC5zdWJzdHJpbmcoMCwgZW1haWwuaW5kZXhPZignQCcpKTsKCiAgICAgICAgLy8gbWVzc2FnZSB0byBxdWVyeSBkb21haW4gcmVnaXN0cnksIGFza2luZyBmb3IgYSB1c2VyIGh5cGVydHkuCiAgICAgICAgdmFyIG1lc3NhZ2UgPSB7CiAgICAgICAgICB0eXBlOiAncmVhZCcsIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCwgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluICsgJy8nLCBib2R5OiB7IHJlc291cmNlOiBpZGVudGl0eVVSTCB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5pbmZvKCdbRGlzY292ZXJ5XSBNZXNzYWdlOiAnLCBtZXNzYWdlLCBhY3RpdmVEb21haW4sIGlkZW50aXR5VVJMKTsKCiAgICAgICAgLy9jb25zb2xlLmluZm8oJ1tEaXNjb3ZlcnldIG1lc3NhZ2UgUkVBRCcsIG1lc3NhZ2UpOwoKICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5pbmZvKCdbRGlzY292ZXJ5XSBtZXNzYWdlIHJlcGx5JywgcmVwbHkpOwoKICAgICAgICAgIHZhciBoeXBlcnR5ID0gdm9pZCAwOwogICAgICAgICAgdmFyIG1vc3RSZWNlbnQgPSB2b2lkIDA7CiAgICAgICAgICB2YXIgbGFzdEh5cGVydHkgPSB2b2lkIDA7CiAgICAgICAgICB2YXIgdmFsdWUgPSByZXBseS5ib2R5LnZhbHVlOwoKICAgICAgICAgIGZvciAoaHlwZXJ0eSBpbiB2YWx1ZSkgewogICAgICAgICAgICBpZiAodmFsdWVbaHlwZXJ0eV0ubGFzdE1vZGlmaWVkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICBpZiAobW9zdFJlY2VudCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICBtb3N0UmVjZW50ID0gbmV3IERhdGUodmFsdWVbaHlwZXJ0eV0ubGFzdE1vZGlmaWVkKTsKICAgICAgICAgICAgICAgIGxhc3RIeXBlcnR5ID0gaHlwZXJ0eTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdmFyIGh5cGVydHlEYXRlID0gbmV3IERhdGUodmFsdWVbaHlwZXJ0eV0ubGFzdE1vZGlmaWVkKTsKICAgICAgICAgICAgICAgIGlmIChtb3N0UmVjZW50LmdldFRpbWUoKSA8IGh5cGVydHlEYXRlLmdldFRpbWUoKSkgewogICAgICAgICAgICAgICAgICBtb3N0UmVjZW50ID0gaHlwZXJ0eURhdGU7CiAgICAgICAgICAgICAgICAgIGxhc3RIeXBlcnR5ID0gaHlwZXJ0eTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBjb25zb2xlLmluZm8oJ1tEaXNjb3ZlcnldIExhc3QgSHlwZXJ0eTogJywgbGFzdEh5cGVydHksIG1vc3RSZWNlbnQpOwoKICAgICAgICAgIHZhciBoeXBlcnR5VVJMID0gbGFzdEh5cGVydHk7CgogICAgICAgICAgaWYgKGh5cGVydHlVUkwgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICByZXR1cm4gcmVqZWN0KCdVc2VyIEh5cGVydHkgbm90IGZvdW5kJyk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGlkUGFja2FnZSA9IHsKICAgICAgICAgICAgaWQ6IGVtYWlsLAogICAgICAgICAgICBkZXNjcmlwdG9yOiB2YWx1ZVtoeXBlcnR5VVJMXS5kZXNjcmlwdG9yLAogICAgICAgICAgICBoeXBlcnR5VVJMOiBoeXBlcnR5VVJMCiAgICAgICAgICB9OwoKICAgICAgICAgIGNvbnNvbGUuaW5mbygnW0Rpc2NvdmVyeV0gPT09PiBoeXBlcnR5RGlzY292ZXJ5IG1lc3NhZ2VCdW5kbGU6ICcsIGlkUGFja2FnZSk7CiAgICAgICAgICByZXNvbHZlKGlkUGFja2FnZSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgKiBmdW5jdGlvbiB0byByZXF1ZXN0IGFib3V0IHVzZXJzIHJlZ2lzdGVyZWQgaW4gZG9tYWluIHJlZ2lzdHJ5LCBhbmQKICAgICogcmV0dXJuIHRoZSBhbGwgdGhlIGh5cGVydGllcyByZWdpc3RlcmVkIGJ5IHRoZSB1c2VyCiAgICAqIEBkZXByZWNhdGVkIERlcHJlY2F0ZWQuIFVzZSBkaXNjb3Zlckh5cGVydHkgaW5zdGVhZAogICAgKiBAcGFyYW0gIHtlbWFpbH0gICAgICAgICAgICAgIGVtYWlsCiAgICAqIEBwYXJhbSAge2RvbWFpbn0gICAgICAgICAgICBkb21haW4gKE9wdGlvbmFsKQogICAgKi8KCiAgfSwgewogICAga2V5OiAnZGlzY292ZXJIeXBlcnRpZXNQZXJVc2VyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb3Zlckh5cGVydGllc1BlclVzZXIoZW1haWwsIGRvbWFpbikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgYWN0aXZlRG9tYWluID0gdm9pZCAwOwogICAgICBjb25zb2xlLmxvZygnb24gRnVuY3Rpb24tPicsIGVtYWlsKTsKICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIGlmIChlbWFpbC5pbmNsdWRlcygnOicpICYmICFlbWFpbC5pbmNsdWRlcygndXNlcjovLycpKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW0Rpc2NvdmVyeS5kaXNjb3Zlckh5cGVydHldIGlzIGxlZ2FjeSBkb21haW4nKTsKICAgICAgICAgIHZhciBsZWdhY3lVc2VyID0geyB1c2VySUQ6IGVtYWlsLCBoeXBlcnR5SUQ6IGVtYWlsLCBzY2hlbWE6IHNjaGVtYSwgcmVzb3VyY2VzOiByZXNvdXJjZXMgfTsKICAgICAgICAgIHJldHVybiByZXNvbHZlKGxlZ2FjeVVzZXIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFkb21haW4pIHsKICAgICAgICAgIGFjdGl2ZURvbWFpbiA9IF90aGlzLmRvbWFpbjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWN0aXZlRG9tYWluID0gZG9tYWluOwogICAgICAgIH0KCiAgICAgICAgdmFyIGlkZW50aXR5VVJMID0gJ3VzZXI6Ly8nICsgZW1haWwuc3Vic3RyaW5nKGVtYWlsLmluZGV4T2YoJ0AnKSArIDEsIGVtYWlsLmxlbmd0aCkgKyAnLycgKyBlbWFpbC5zdWJzdHJpbmcoMCwgZW1haWwuaW5kZXhPZignQCcpKTsKCiAgICAgICAgLy8gbWVzc2FnZSB0byBxdWVyeSBkb21haW4gcmVnaXN0cnksIGFza2luZyBmb3IgYSB1c2VyIGh5cGVydHkuCiAgICAgICAgdmFyIG1lc3NhZ2UgPSB7CiAgICAgICAgICB0eXBlOiAncmVhZCcsIGZyb206IF90aGlzLmRpc2NvdmVyeVVSTCwgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgYWN0aXZlRG9tYWluICsgJy8nLCBib2R5OiB7IHJlc291cmNlOiBpZGVudGl0eVVSTCB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tEaXNjb3ZlcnldIE1lc3NhZ2UgZGlzY292ZXJIeXBlcnRpZXNQZXJVc2VyOiAnLCBtZXNzYWdlLCBhY3RpdmVEb21haW4sIGlkZW50aXR5VVJMKTsKCiAgICAgICAgLy9jb25zb2xlLmluZm8oJ1tEaXNjb3ZlcnldIG1lc3NhZ2UgUkVBRCcsIG1lc3NhZ2UpOwoKICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5pbmZvKCdbRGlzY292ZXJ5XSBkaXNjb3Zlckh5cGVydGllc1BlclVzZXIgcmVwbHknLCByZXBseSk7CgogICAgICAgICAgdmFyIHZhbHVlID0gcmVwbHkuYm9keS52YWx1ZTsKCiAgICAgICAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgICAgIHJldHVybiByZWplY3QoJ1VzZXIgSHlwZXJ0eSBub3QgZm91bmQnKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXNvbHZlKHZhbHVlKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfV0pOwogIHJldHVybiBEaXNjb3Zlcnk7Cn0oKTsgLyoqCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQogICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KICAgICAqCiAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICoKICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAgICAgKgogICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAgICAgKiovCgpleHBvcnRzLmRlZmF1bHQgPSBEaXNjb3Zlcnk7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEyOCAqLywKLyogMTI5ICovLAovKiAxMzAgKi8sCi8qIDEzMSAqLywKLyogMTMyICovLAovKiAxMzMgKi8sCi8qIDEzNCAqLywKLyogMTM1ICovLAovKiAxMzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfRGlzY292ZXJ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjcpOwoKdmFyIF9EaXNjb3ZlcnkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGlzY292ZXJ5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLmRlZmF1bHQgPSBfRGlzY292ZXJ5Mi5kZWZhdWx0Owptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pCi8qKioqKiovIF0pOwp9KTsKCn0se31dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovLyB2ZXJzaW9uOiAwLjUuMQovLyBkYXRlOiBUaHUgQXByIDEzIDIwMTcgMjM6NTE6MjggR01UKzAxMDAgKEdNVCBEYXlsaWdodCBUaW1lKQovLyBsaWNlbmNlOiAKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgoKKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiSWRlbnRpdHlGYWN0b3J5IiwgW10sIGZhY3RvcnkpOwoJZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpCgkJZXhwb3J0c1siSWRlbnRpdHlGYWN0b3J5Il0gPSBmYWN0b3J5KCk7CgllbHNlCgkJcm9vdFsiIl0gPSByb290WyIiXSB8fCB7fSwgcm9vdFsiIl1bIklkZW50aXR5RmFjdG9yeSJdID0gZmFjdG9yeSgpOwp9KSh0aGlzLCBmdW5jdGlvbigpIHsKcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXAKLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCXZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307Ci8qKioqKiovCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLwovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQovKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJaTogbW9kdWxlSWQsCi8qKioqKiovIAkJCWw6IGZhbHNlLAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAovKioqKioqLyAJCW1vZHVsZS5sID0gdHJ1ZTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8KLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7Ci8qKioqKiovCi8qKioqKiovIAkvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0Ci8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHMKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikgewovKioqKioqLyAJCWlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKLyoqKioqKi8gCQkJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsKLyoqKioqKi8gCQkJCWNvbmZpZ3VyYWJsZTogZmFsc2UsCi8qKioqKiovIAkJCQllbnVtZXJhYmxlOiB0cnVlLAovKioqKioqLyAJCQkJZ2V0OiBnZXR0ZXIKLyoqKioqKi8gCQkJfSk7Ci8qKioqKiovIAkJfQovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHsKLyoqKioqKi8gCQl2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID8KLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTsKLyoqKioqKi8gCQlfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7Ci8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKLyoqKioqKi8KLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMTM3KTsKLyoqKioqKi8gfSkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gKHsKCi8qKiovIDEyMDoKLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKKiBUaGUgVXNlclByb2ZpbGUgYWNjb3JkaW5nIHRvIFVzZXIgSWRlbnRpdHkgRGF0YSBNb2RlbAoqLwoKdmFyIFVzZXJQcm9maWxlID0gZnVuY3Rpb24gVXNlclByb2ZpbGUodXNlcm5hbWUsIHVzZXJVUkwsIGF2YXRhciwgY24sIGxvY2FsZSkgewogICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFVzZXJQcm9maWxlKTsKCgogIGlmICh1c2VybmFtZSkgewogICAgdGhpcy51c2VybmFtZSA9IHVzZXJuYW1lOwogIH0KICBpZiAoYXZhdGFyKSB7CiAgICB0aGlzLmF2YXRhciA9IGF2YXRhcjsKICB9CiAgaWYgKGNuKSB7CiAgICB0aGlzLmNuID0gY247CiAgfQogIGlmIChsb2NhbGUpIHsKICAgIHRoaXMubG9jYWxlID0gbG9jYWxlOwogIH0KICBpZiAodXNlclVSTCkgewogICAgdGhpcy51c2VyVVJMID0gdXNlclVSTDsKICB9Cn07CgpleHBvcnRzLmRlZmF1bHQgPSBVc2VyUHJvZmlsZTsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWyJkZWZhdWx0Il07CgovKioqLyB9KSwKCi8qKiovIDEyOToKLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICAgIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9Vc2VyUHJvZmlsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTIwKTsKCnZhciBfVXNlclByb2ZpbGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfVXNlclByb2ZpbGUpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBNZXNzYWdlQm9keUlkZW50aXR5ID0gZnVuY3Rpb24gTWVzc2FnZUJvZHlJZGVudGl0eSh1c2VybmFtZSwgdXNlclVSTCwgYXZhdGFyLCBjbiwgbG9jYWxlLCBpZHAsIGFzc2VydGlvbikgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgTWVzc2FnZUJvZHlJZGVudGl0eSk7CgoKICAgIGlmICghaWRwKSB0aHJvdyBuZXcgRXJyb3IoJ0lEUCBzaG91bGQgYmUgYSBwYXJhbWV0ZXInKTsKICAgIGlmICghdXNlcm5hbWUpIHRocm93IG5ldyBFcnJvcigndXNlcm5hbWUgc2hvdWxkIGJlIGEgcGFyYW1ldGVyJyk7CgogICAgdGhpcy5pZHAgPSBpZHA7CgogICAgaWYgKGFzc2VydGlvbikgewogICAgICAgIHRoaXMuYXNzZXJ0aW9uID0gYXNzZXJ0aW9uOwogICAgfQogICAgdGhpcy51c2VyUHJvZmlsZSA9IG5ldyBfVXNlclByb2ZpbGUyLmRlZmF1bHQodXNlcm5hbWUsIHVzZXJVUkwsIGF2YXRhciwgY24sIGxvY2FsZSk7Cn07IC8qKgogICAqIFRoZSBJZGVudGl0eSBpbmZvIHRvIGJlIGFkZGVkIHRvIE1lc3NhZ2UuQm9keS5JZGVudGl0eQogICAqLwoKZXhwb3J0cy5kZWZhdWx0ID0gTWVzc2FnZUJvZHlJZGVudGl0eTsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKCi8qKiovIDEzNzoKLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5Vc2VyUHJvZmlsZSA9IHVuZGVmaW5lZDsKCnZhciBfVXNlclByb2ZpbGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCk7Cgp2YXIgX1VzZXJQcm9maWxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1VzZXJQcm9maWxlKTsKCnZhciBfTWVzc2FnZUJvZHlJZGVudGl0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMTI5KTsKCnZhciBfTWVzc2FnZUJvZHlJZGVudGl0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9NZXNzYWdlQm9keUlkZW50aXR5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLlVzZXJQcm9maWxlID0gX1VzZXJQcm9maWxlMi5kZWZhdWx0OwpleHBvcnRzLmRlZmF1bHQgPSBfTWVzc2FnZUJvZHlJZGVudGl0eTIuZGVmYXVsdDsKCi8qKiovIH0pLAoKLyoqKi8gODoKLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgpleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogIH0KfTsKCi8qKiovIH0pCgovKioqKioqLyB9KTsKfSk7Cgp9LHt9XSw4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLy8gdmVyc2lvbjogMC41LjEKLy8gZGF0ZTogVGh1IEFwciAxMyAyMDE3IDIzOjUxOjI4IEdNVCswMTAwIChHTVQgRGF5bGlnaHQgVGltZSkKLy8gbGljZW5jZTogCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwoKCihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7CglpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpCgkJbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7CgllbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkKCQlkZWZpbmUoIlN5bmNoZXIiLCBbXSwgZmFjdG9yeSk7CgllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JykKCQlleHBvcnRzWyJTeW5jaGVyIl0gPSBmYWN0b3J5KCk7CgllbHNlCgkJcm9vdFsiIl0gPSByb290WyIiXSB8fCB7fSwgcm9vdFsiIl1bIlN5bmNoZXIiXSA9IGZhY3RvcnkoKTsKfSkodGhpcywgZnVuY3Rpb24oKSB7CnJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwovKioqKioqLwovKioqKioqLyAJLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb24KLyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCWk6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsOiBmYWxzZSwKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLwovKioqKioqLyAJCS8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbgovKioqKioqLyAJCW1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pOwovKioqKioqLwovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubCA9IHRydWU7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9Ci8qKioqKiovCi8qKioqKiovCi8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKQovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlczsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gaWRlbnRpdHkgZnVuY3Rpb24gZm9yIGNhbGxpbmcgaGFybW9ueSBpbXBvcnRzIHdpdGggdGhlIGNvcnJlY3QgY29udGV4dAovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5pID0gZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9OwovKioqKioqLwovKioqKioqLyAJLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHsKLyoqKioqKi8gCQlpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7Ci8qKioqKiovIAkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7Ci8qKioqKiovIAkJCQljb25maWd1cmFibGU6IGZhbHNlLAovKioqKioqLyAJCQkJZW51bWVyYWJsZTogdHJ1ZSwKLyoqKioqKi8gCQkJCWdldDogZ2V0dGVyCi8qKioqKiovIAkJCX0pOwovKioqKioqLyAJCX0KLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlcwovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7Ci8qKioqKiovIAkJdmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/Ci8qKioqKiovIAkJCWZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6Ci8qKioqKiovIAkJCWZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07Ci8qKioqKiovIAkJX193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpOwovKioqKioqLyAJCXJldHVybiBnZXR0ZXI7Ci8qKioqKiovIAl9OwovKioqKioqLwovKioqKioqLyAJLy8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfXwovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gIiI7Ci8qKioqKiovCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDE0Mik7Ci8qKioqKiovIH0pCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIChbCi8qIDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGNvcmUgPSBtb2R1bGUuZXhwb3J0cyA9IHt2ZXJzaW9uOiAnMi40LjAnfTsKaWYodHlwZW9mIF9fZSA9PSAnbnVtYmVyJylfX2UgPSBjb3JlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmCgovKioqLyB9KSwKLyogMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOAp2YXIgZ2xvYmFsID0gbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdy5NYXRoID09IE1hdGgKICA/IHdpbmRvdyA6IHR5cGVvZiBzZWxmICE9ICd1bmRlZmluZWQnICYmIHNlbGYuTWF0aCA9PSBNYXRoID8gc2VsZiA6IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7CmlmKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmCgovKioqLyB9KSwKLyogMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBUaGFuaydzIElFOCBmb3IgaGlzIGZ1bm55IGRlZmluZVByb3BlcnR5Cm1vZHVsZS5leHBvcnRzID0gIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ2EnLCB7Z2V0OiBmdW5jdGlvbigpeyByZXR1cm4gNzsgfX0pLmEgIT0gNzsKfSk7CgovKioqLyB9KSwKLyogMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgc3RvcmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzApKCd3a3MnKQogICwgdWlkICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpCiAgLCBTeW1ib2wgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5TeW1ib2wKICAsIFVTRV9TWU1CT0wgPSB0eXBlb2YgU3ltYm9sID09ICdmdW5jdGlvbic7Cgp2YXIgJGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewogIHJldHVybiBzdG9yZVtuYW1lXSB8fCAoc3RvcmVbbmFtZV0gPQogICAgVVNFX1NZTUJPTCAmJiBTeW1ib2xbbmFtZV0gfHwgKFVTRV9TWU1CT0wgPyBTeW1ib2wgOiB1aWQpKCdTeW1ib2wuJyArIG5hbWUpKTsKfTsKCiRleHBvcnRzLnN0b3JlID0gc3RvcmU7CgovKioqLyB9KSwKLyogNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgYW5PYmplY3QgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBJRThfRE9NX0RFRklORSA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpCiAgLCB0b1ByaW1pdGl2ZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpCiAgLCBkUCAgICAgICAgICAgICA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTsKCmV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMikgPyBPYmplY3QuZGVmaW5lUHJvcGVydHkgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKXsKICBhbk9iamVjdChPKTsKICBQID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSk7CiAgYW5PYmplY3QoQXR0cmlidXRlcyk7CiAgaWYoSUU4X0RPTV9ERUZJTkUpdHJ5IHsKICAgIHJldHVybiBkUChPLCBQLCBBdHRyaWJ1dGVzKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgaWYoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKXRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhJyk7CiAgaWYoJ3ZhbHVlJyBpbiBBdHRyaWJ1dGVzKU9bUF0gPSBBdHRyaWJ1dGVzLnZhbHVlOwogIHJldHVybiBPOwp9OwoKLyoqKi8gfSksCi8qIDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYoIWlzT2JqZWN0KGl0KSl0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhbiBvYmplY3QhJyk7CiAgcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIHR5cGVvZiBpdCA9PT0gJ29iamVjdCcgPyBpdCAhPT0gbnVsbCA6IHR5cGVvZiBpdCA9PT0gJ2Z1bmN0aW9uJzsKfTsKCi8qKiovIH0pLAovKiA3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBkUCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgY3JlYXRlRGVzYyA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMikgPyBmdW5jdGlvbihvYmplY3QsIGtleSwgdmFsdWUpewogIHJldHVybiBkUC5mKG9iamVjdCwga2V5LCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7Cn0gOiBmdW5jdGlvbihvYmplY3QsIGtleSwgdmFsdWUpewogIG9iamVjdFtrZXldID0gdmFsdWU7CiAgcmV0dXJuIG9iamVjdDsKfTsKCi8qKiovIH0pLAovKiA4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn07CgovKioqLyB9KSwKLyogOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY29yZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQogICwgY3R4ICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGhpZGUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnOwoKdmFyICRleHBvcnQgPSBmdW5jdGlvbih0eXBlLCBuYW1lLCBzb3VyY2UpewogIHZhciBJU19GT1JDRUQgPSB0eXBlICYgJGV4cG9ydC5GCiAgICAsIElTX0dMT0JBTCA9IHR5cGUgJiAkZXhwb3J0LkcKICAgICwgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuUwogICAgLCBJU19QUk9UTyAgPSB0eXBlICYgJGV4cG9ydC5QCiAgICAsIElTX0JJTkQgICA9IHR5cGUgJiAkZXhwb3J0LkIKICAgICwgSVNfV1JBUCAgID0gdHlwZSAmICRleHBvcnQuVwogICAgLCBleHBvcnRzICAgPSBJU19HTE9CQUwgPyBjb3JlIDogY29yZVtuYW1lXSB8fCAoY29yZVtuYW1lXSA9IHt9KQogICAgLCBleHBQcm90byAgPSBleHBvcnRzW1BST1RPVFlQRV0KICAgICwgdGFyZ2V0ICAgID0gSVNfR0xPQkFMID8gZ2xvYmFsIDogSVNfU1RBVElDID8gZ2xvYmFsW25hbWVdIDogKGdsb2JhbFtuYW1lXSB8fCB7fSlbUFJPVE9UWVBFXQogICAgLCBrZXksIG93biwgb3V0OwogIGlmKElTX0dMT0JBTClzb3VyY2UgPSBuYW1lOwogIGZvcihrZXkgaW4gc291cmNlKXsKICAgIC8vIGNvbnRhaW5zIGluIG5hdGl2ZQogICAgb3duID0gIUlTX0ZPUkNFRCAmJiB0YXJnZXQgJiYgdGFyZ2V0W2tleV0gIT09IHVuZGVmaW5lZDsKICAgIGlmKG93biAmJiBrZXkgaW4gZXhwb3J0cyljb250aW51ZTsKICAgIC8vIGV4cG9ydCBuYXRpdmUgb3IgcGFzc2VkCiAgICBvdXQgPSBvd24gPyB0YXJnZXRba2V5XSA6IHNvdXJjZVtrZXldOwogICAgLy8gcHJldmVudCBnbG9iYWwgcG9sbHV0aW9uIGZvciBuYW1lc3BhY2VzCiAgICBleHBvcnRzW2tleV0gPSBJU19HTE9CQUwgJiYgdHlwZW9mIHRhcmdldFtrZXldICE9ICdmdW5jdGlvbicgPyBzb3VyY2Vba2V5XQogICAgLy8gYmluZCB0aW1lcnMgdG8gZ2xvYmFsIGZvciBjYWxsIGZyb20gZXhwb3J0IGNvbnRleHQKICAgIDogSVNfQklORCAmJiBvd24gPyBjdHgob3V0LCBnbG9iYWwpCiAgICAvLyB3cmFwIGdsb2JhbCBjb25zdHJ1Y3RvcnMgZm9yIHByZXZlbnQgY2hhbmdlIHRoZW0gaW4gbGlicmFyeQogICAgOiBJU19XUkFQICYmIHRhcmdldFtrZXldID09IG91dCA/IChmdW5jdGlvbihDKXsKICAgICAgdmFyIEYgPSBmdW5jdGlvbihhLCBiLCBjKXsKICAgICAgICBpZih0aGlzIGluc3RhbmNlb2YgQyl7CiAgICAgICAgICBzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7CiAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIG5ldyBDOwogICAgICAgICAgICBjYXNlIDE6IHJldHVybiBuZXcgQyhhKTsKICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gbmV3IEMoYSwgYik7CiAgICAgICAgICB9IHJldHVybiBuZXcgQyhhLCBiLCBjKTsKICAgICAgICB9IHJldHVybiBDLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICAgIEZbUFJPVE9UWVBFXSA9IENbUFJPVE9UWVBFXTsKICAgICAgcmV0dXJuIEY7CiAgICAvLyBtYWtlIHN0YXRpYyB2ZXJzaW9ucyBmb3IgcHJvdG90eXBlIG1ldGhvZHMKICAgIH0pKG91dCkgOiBJU19QUk9UTyAmJiB0eXBlb2Ygb3V0ID09ICdmdW5jdGlvbicgPyBjdHgoRnVuY3Rpb24uY2FsbCwgb3V0KSA6IG91dDsKICAgIC8vIGV4cG9ydCBwcm90byBtZXRob2RzIHRvIGNvcmUuJUNPTlNUUlVDVE9SJS5tZXRob2RzLiVOQU1FJQogICAgaWYoSVNfUFJPVE8pewogICAgICAoZXhwb3J0cy52aXJ0dWFsIHx8IChleHBvcnRzLnZpcnR1YWwgPSB7fSkpW2tleV0gPSBvdXQ7CiAgICAgIC8vIGV4cG9ydCBwcm90byBtZXRob2RzIHRvIGNvcmUuJUNPTlNUUlVDVE9SJS5wcm90b3R5cGUuJU5BTUUlCiAgICAgIGlmKHR5cGUgJiAkZXhwb3J0LlIgJiYgZXhwUHJvdG8gJiYgIWV4cFByb3RvW2tleV0paGlkZShleHBQcm90bywga2V5LCBvdXQpOwogICAgfQogIH0KfTsKLy8gdHlwZSBiaXRtYXAKJGV4cG9ydC5GID0gMTsgICAvLyBmb3JjZWQKJGV4cG9ydC5HID0gMjsgICAvLyBnbG9iYWwKJGV4cG9ydC5TID0gNDsgICAvLyBzdGF0aWMKJGV4cG9ydC5QID0gODsgICAvLyBwcm90bwokZXhwb3J0LkIgPSAxNjsgIC8vIGJpbmQKJGV4cG9ydC5XID0gMzI7ICAvLyB3cmFwCiRleHBvcnQuVSA9IDY0OyAgLy8gc2FmZQokZXhwb3J0LlIgPSAxMjg7IC8vIHJlYWwgcHJvdG8gbWV0aG9kIGZvciBgbGlicmFyeWAgCm1vZHVsZS5leHBvcnRzID0gJGV4cG9ydDsKCi8qKiovIH0pLAovKiAxMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfZGVmaW5lUHJvcGVydHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTsKCnZhciBfZGVmaW5lUHJvcGVydHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVmaW5lUHJvcGVydHkpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgICAoMCwgX2RlZmluZVByb3BlcnR5Mi5kZWZhdWx0KSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICAgIH0KICB9CgogIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CiAgICBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogICAgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7CiAgICByZXR1cm4gQ29uc3RydWN0b3I7CiAgfTsKfSgpOwoKLyoqKi8gfSksCi8qIDExICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYyl7CiAgdHJ5IHsKICAgIHJldHVybiAhIWV4ZWMoKTsKICB9IGNhdGNoKGUpewogICAgcmV0dXJuIHRydWU7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDEyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciBoYXNPd25Qcm9wZXJ0eSA9IHt9Lmhhc093blByb3BlcnR5Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBrZXkpewogIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGl0LCBrZXkpOwp9OwoKLyoqKi8gfSksCi8qIDEzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIHRvIGluZGV4ZWQgb2JqZWN0LCB0b09iamVjdCB3aXRoIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgc3RyaW5ncwp2YXIgSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpCiAgLCBkZWZpbmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBJT2JqZWN0KGRlZmluZWQoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAxNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBvcHRpb25hbCAvIHNpbXBsZSBjb250ZXh0IGJpbmRpbmcKdmFyIGFGdW5jdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCB0aGF0LCBsZW5ndGgpewogIGFGdW5jdGlvbihmbik7CiAgaWYodGhhdCA9PT0gdW5kZWZpbmVkKXJldHVybiBmbjsKICBzd2l0Y2gobGVuZ3RoKXsKICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uKGEpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhKTsKICAgIH07CiAgICBjYXNlIDI6IHJldHVybiBmdW5jdGlvbihhLCBiKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYik7CiAgICB9OwogICAgY2FzZSAzOiByZXR1cm4gZnVuY3Rpb24oYSwgYiwgYyl7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIsIGMpOwogICAgfTsKICB9CiAgcmV0dXJuIGZ1bmN0aW9uKC8qIC4uLmFyZ3MgKi8pewogICAgcmV0dXJuIGZuLmFwcGx5KHRoYXQsIGFyZ3VtZW50cyk7CiAgfTsKfTsKCi8qKiovIH0pLAovKiAxNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGJpdG1hcCwgdmFsdWUpewogIHJldHVybiB7CiAgICBlbnVtZXJhYmxlICA6ICEoYml0bWFwICYgMSksCiAgICBjb25maWd1cmFibGU6ICEoYml0bWFwICYgMiksCiAgICB3cml0YWJsZSAgICA6ICEoYml0bWFwICYgNCksCiAgICB2YWx1ZSAgICAgICA6IHZhbHVlCiAgfTsKfTsKCi8qKiovIH0pLAovKiAxNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHt9OwoKLyoqKi8gfSksCi8qIDE3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNikKICAsIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5kb2N1bWVudAogIC8vIGluIG9sZCBJRSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JwogICwgaXMgPSBpc09iamVjdChkb2N1bWVudCkgJiYgaXNPYmplY3QoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307Cn07CgovKioqLyB9KSwKLyogMTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjE0IC8gMTUuMi4zLjE0IE9iamVjdC5rZXlzKE8pCnZhciAka2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpOwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pewogIHJldHVybiAka2V5cyhPLCBlbnVtQnVnS2V5cyk7Cn07CgovKioqLyB9KSwKLyogMTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpOwp9OwoKLyoqKi8gfSksCi8qIDIxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDcuMS4xIFRvUHJpbWl0aXZlKGlucHV0IFssIFByZWZlcnJlZFR5cGVdKQp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwovLyBpbnN0ZWFkIG9mIHRoZSBFUzYgc3BlYyB2ZXJzaW9uLCB3ZSBkaWRuJ3QgaW1wbGVtZW50IEBAdG9QcmltaXRpdmUgY2FzZQovLyBhbmQgdGhlIHNlY29uZCBhcmd1bWVudCAtIGZsYWcgLSBwcmVmZXJyZWQgdHlwZSBpcyBhIHN0cmluZwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBTKXsKICBpZighaXNPYmplY3QoaXQpKXJldHVybiBpdDsKICB2YXIgZm4sIHZhbDsKICBpZihTICYmIHR5cGVvZiAoZm4gPSBpdC50b1N0cmluZykgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKXJldHVybiB2YWw7CiAgaWYodHlwZW9mIChmbiA9IGl0LnZhbHVlT2YpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIGlmKCFTICYmIHR5cGVvZiAoZm4gPSBpdC50b1N0cmluZykgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKXJldHVybiB2YWw7CiAgdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWUiKTsKfTsKCi8qKiovIH0pLAovKiAyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZGVmID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mCiAgLCBoYXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQogICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgndG9TdHJpbmdUYWcnKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIHRhZywgc3RhdCl7CiAgaWYoaXQgJiYgIWhhcyhpdCA9IHN0YXQgPyBpdCA6IGl0LnByb3RvdHlwZSwgVEFHKSlkZWYoaXQsIFRBRywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgdmFsdWU6IHRhZ30pOwp9OwoKLyoqKi8gfSksCi8qIDIzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciBpZCA9IDAKICAsIHB4ID0gTWF0aC5yYW5kb20oKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiAnU3ltYm9sKCcuY29uY2F0KGtleSA9PT0gdW5kZWZpbmVkID8gJycgOiBrZXksICcpXycsICgrK2lkICsgcHgpLnRvU3RyaW5nKDM2KSk7Cn07CgovKioqLyB9KSwKLyogMjQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudCkKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYoaXQgPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gICIgKyBpdCk7CiAgcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDI1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0gIV9fd2VicGFja19yZXF1aXJlX18oMikgJiYgIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KSgnZGl2JyksICdhJywge2dldDogZnVuY3Rpb24oKXsgcmV0dXJuIDc7IH19KS5hICE9IDc7Cn0pOwoKLyoqKi8gfSksCi8qIDI2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gdHJ1ZTsKCi8qKiovIH0pLAovKiAyNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgc2hhcmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ2tleXMnKQogICwgdWlkICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsKICByZXR1cm4gc2hhcmVkW2tleV0gfHwgKHNoYXJlZFtrZXldID0gdWlkKGtleSkpOwp9OwoKLyoqKi8gfSksCi8qIDI4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIDcuMS40IFRvSW50ZWdlcgp2YXIgY2VpbCAgPSBNYXRoLmNlaWwKICAsIGZsb29yID0gTWF0aC5mbG9vcjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGlzTmFOKGl0ID0gK2l0KSA/IDAgOiAoaXQgPiAwID8gZmxvb3IgOiBjZWlsKShpdCk7Cn07CgovKioqLyB9KSwKLyogMjkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gSUUgOC0gZG9uJ3QgZW51bSBidWcga2V5cwptb2R1bGUuZXhwb3J0cyA9ICgKICAnY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mJwopLnNwbGl0KCcsJyk7CgovKioqLyB9KSwKLyogMzAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIFNIQVJFRCA9ICdfX2NvcmUtanNfc2hhcmVkX18nCiAgLCBzdG9yZSAgPSBnbG9iYWxbU0hBUkVEXSB8fCAoZ2xvYmFsW1NIQVJFRF0gPSB7fSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsKICByZXR1cm4gc3RvcmVba2V5XSB8fCAoc3RvcmVba2V5XSA9IHt9KTsKfTsKCi8qKiovIH0pLAovKiAzMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDMyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDcuMS4xMyBUb09iamVjdChhcmd1bWVudCkKdmFyIGRlZmluZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIE9iamVjdChkZWZpbmVkKGl0KSk7Cn07CgovKioqLyB9KSwKLyogMzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygzNiksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAzNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfc2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc2KTsKCnZhciBfc2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jcmVhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc1KTsKCnZhciBfY3JlYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZSk7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHN1cGVyQ2xhc3MgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoc3VwZXJDbGFzcykpKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9ICgwLCBfY3JlYXRlMi5kZWZhdWx0KShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZjIuZGVmYXVsdCA/ICgwLCBfc2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7Cn07CgovKioqLyB9KSwKLyogMzUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzZWxmLCBjYWxsKSB7CiAgaWYgKCFzZWxmKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIGNhbGwgJiYgKCh0eXBlb2YgY2FsbCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6ICgwLCBfdHlwZW9mMy5kZWZhdWx0KShjYWxsKSkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOwp9OwoKLyoqKi8gfSksCi8qIDM2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMzgpOwp2YXIgJE9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KGl0LCBrZXksIGRlc2MpewogIHJldHVybiAkT2JqZWN0LmRlZmluZVByb3BlcnR5KGl0LCBrZXksIGRlc2MpOwp9OwoKLyoqKi8gfSksCi8qIDM3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQp2YXIgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBkUHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpKCdJRV9QUk9UTycpCiAgLCBFbXB0eSAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KICAsIFBST1RPVFlQRSAgID0gJ3Byb3RvdHlwZSc7CgovLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlCnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24oKXsKICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1ZwogIHZhciBpZnJhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KSgnaWZyYW1lJykKICAgICwgaSAgICAgID0gZW51bUJ1Z0tleXMubGVuZ3RoCiAgICAsIGx0ICAgICA9ICc8JwogICAgLCBndCAgICAgPSAnPicKICAgICwgaWZyYW1lRG9jdW1lbnQ7CiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg0MikuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsCiAgLy8gY3JlYXRlRGljdCA9IGlmcmFtZS5jb250ZW50V2luZG93Lk9iamVjdDsKICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7CiAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKICBpZnJhbWVEb2N1bWVudC5vcGVuKCk7CiAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpOwogIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7CiAgY3JlYXRlRGljdCA9IGlmcmFtZURvY3VtZW50LkY7CiAgd2hpbGUoaS0tKWRlbGV0ZSBjcmVhdGVEaWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbaV1dOwogIHJldHVybiBjcmVhdGVEaWN0KCk7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpewogIHZhciByZXN1bHQ7CiAgaWYoTyAhPT0gbnVsbCl7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7CiAgICByZXN1bHQgPSBuZXcgRW1wdHk7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gbnVsbDsKICAgIC8vIGFkZCAiX19wcm90b19fIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsCiAgICByZXN1bHRbSUVfUFJPVE9dID0gTzsKICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpOwogIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkUHMocmVzdWx0LCBQcm9wZXJ0aWVzKTsKfTsKCgovKioqLyB9KSwKLyogMzggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwovLyAxOS4xLjIuNCAvIDE1LjIuMy42IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFfX3dlYnBhY2tfcmVxdWlyZV9fKDIpLCAnT2JqZWN0Jywge2RlZmluZVByb3BlcnR5OiBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmZ9KTsKCi8qKiovIH0pLAovKiAzOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgTElCUkFSWSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBoaWRlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIEl0ZXJhdG9ycyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsICRpdGVyQ3JlYXRlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MikKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MykKICAsIElURVJBVE9SICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnaXRlcmF0b3InKQogICwgQlVHR1kgICAgICAgICAgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSkgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YAogICwgRkZfSVRFUkFUT1IgICAgPSAnQEBpdGVyYXRvcicKICAsIEtFWVMgICAgICAgICAgID0gJ2tleXMnCiAgLCBWQUxVRVMgICAgICAgICA9ICd2YWx1ZXMnOwoKdmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKXsKICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7CiAgdmFyIGdldE1ldGhvZCA9IGZ1bmN0aW9uKGtpbmQpewogICAgaWYoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pcmV0dXJuIHByb3RvW2tpbmRdOwogICAgc3dpdGNoKGtpbmQpewogICAgICBjYXNlIEtFWVM6IHJldHVybiBmdW5jdGlvbiBrZXlzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgfTsKICB2YXIgVEFHICAgICAgICA9IE5BTUUgKyAnIEl0ZXJhdG9yJwogICAgLCBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVMKICAgICwgVkFMVUVTX0JVRyA9IGZhbHNlCiAgICAsIHByb3RvICAgICAgPSBCYXNlLnByb3RvdHlwZQogICAgLCAkbmF0aXZlICAgID0gcHJvdG9bSVRFUkFUT1JdIHx8IHByb3RvW0ZGX0lURVJBVE9SXSB8fCBERUZBVUxUICYmIHByb3RvW0RFRkFVTFRdCiAgICAsICRkZWZhdWx0ICAgPSAkbmF0aXZlIHx8IGdldE1ldGhvZChERUZBVUxUKQogICAgLCAkZW50cmllcyAgID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZAogICAgLCAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZQogICAgLCBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlOwogIC8vIEZpeCBuYXRpdmUKICBpZigkYW55TmF0aXZlKXsKICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoJGFueU5hdGl2ZS5jYWxsKG5ldyBCYXNlKSk7CiAgICBpZihJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSl7CiAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnMKICAgICAgc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JQcm90b3R5cGUsIFRBRywgdHJ1ZSk7CiAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lcwogICAgICBpZighTElCUkFSWSAmJiAhaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikpaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwogICAgfQogIH0KICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGCiAgaWYoREVGX1ZBTFVFUyAmJiAkbmF0aXZlICYmICRuYXRpdmUubmFtZSAhPT0gVkFMVUVTKXsKICAgIFZBTFVFU19CVUcgPSB0cnVlOwogICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTsKICB9CiAgLy8gRGVmaW5lIGl0ZXJhdG9yCiAgaWYoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpewogICAgaGlkZShwcm90bywgSVRFUkFUT1IsICRkZWZhdWx0KTsKICB9CiAgLy8gUGx1ZyBmb3IgbGlicmFyeQogIEl0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0OwogIEl0ZXJhdG9yc1tUQUddICA9IHJldHVyblRoaXM7CiAgaWYoREVGQVVMVCl7CiAgICBtZXRob2RzID0gewogICAgICB2YWx1ZXM6ICBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSwKICAgICAga2V5czogICAgSVNfU0VUICAgICA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLAogICAgICBlbnRyaWVzOiAkZW50cmllcwogICAgfTsKICAgIGlmKEZPUkNFRClmb3Ioa2V5IGluIG1ldGhvZHMpewogICAgICBpZighKGtleSBpbiBwcm90bykpcmVkZWZpbmUocHJvdG8sIGtleSwgbWV0aG9kc1trZXldKTsKICAgIH0gZWxzZSAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7CiAgfQogIHJldHVybiBtZXRob2RzOwp9OwoKLyoqKi8gfSksCi8qIDQwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNTMpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNDEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKZXhwb3J0cy5mID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7CgovKioqLyB9KSwKLyogNDIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLmRvY3VtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCi8qKiovIH0pLAovKiA0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuOSAvIDE1LjIuMy4yIE9iamVjdC5nZXRQcm90b3R5cGVPZihPKQp2YXIgaGFzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQogICwgdG9PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgSUVfUFJPVE8gICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KSgnSUVfUFJPVE8nKQogICwgT2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlOwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24oTyl7CiAgTyA9IHRvT2JqZWN0KE8pOwogIGlmKGhhcyhPLCBJRV9QUk9UTykpcmV0dXJuIE9bSUVfUFJPVE9dOwogIGlmKHR5cGVvZiBPLmNvbnN0cnVjdG9yID09ICdmdW5jdGlvbicgJiYgTyBpbnN0YW5jZW9mIE8uY29uc3RydWN0b3IpewogICAgcmV0dXJuIE8uY29uc3RydWN0b3IucHJvdG90eXBlOwogIH0gcmV0dXJuIE8gaW5zdGFuY2VvZiBPYmplY3QgPyBPYmplY3RQcm90byA6IG51bGw7Cn07CgovKioqLyB9KSwKLyogNDQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGhhcyAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCB0b0lPYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQogICwgYXJyYXlJbmRleE9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MSkoZmFsc2UpCiAgLCBJRV9QUk9UTyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KSgnSUVfUFJPVE8nKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqZWN0LCBuYW1lcyl7CiAgdmFyIE8gICAgICA9IHRvSU9iamVjdChvYmplY3QpCiAgICAsIGkgICAgICA9IDAKICAgICwgcmVzdWx0ID0gW10KICAgICwga2V5OwogIGZvcihrZXkgaW4gTylpZihrZXkgIT0gSUVfUFJPVE8paGFzKE8sIGtleSkgJiYgcmVzdWx0LnB1c2goa2V5KTsKICAvLyBEb24ndCBlbnVtIGJ1ZyAmIGhpZGRlbiBrZXlzCiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSlpZihoYXMoTywga2V5ID0gbmFtZXNbaSsrXSkpewogICAgfmFycmF5SW5kZXhPZihyZXN1bHQsIGtleSkgfHwgcmVzdWx0LnB1c2goa2V5KTsKICB9CiAgcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiA0NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBtb3N0IE9iamVjdCBtZXRob2RzIGJ5IEVTNiBzaG91bGQgYWNjZXB0IHByaW1pdGl2ZXMKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpCiAgLCBjb3JlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQogICwgZmFpbHMgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEtFWSwgZXhlYyl7CiAgdmFyIGZuICA9IChjb3JlLk9iamVjdCB8fCB7fSlbS0VZXSB8fCBPYmplY3RbS0VZXQogICAgLCBleHAgPSB7fTsKICBleHBbS0VZXSA9IGV4ZWMoZm4pOwogICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogZmFpbHMoZnVuY3Rpb24oKXsgZm4oMSk7IH0pLCAnT2JqZWN0JywgZXhwKTsKfTsKCi8qKiovIH0pLAovKiA0NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7CgovKioqLyB9KSwKLyogNDcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjE1IFRvTGVuZ3RoCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KQogICwgbWluICAgICAgID0gTWF0aC5taW47Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCA+IDAgPyBtaW4odG9JbnRlZ2VyKGl0KSwgMHgxZmZmZmZmZmZmZmZmZikgOiAwOyAvLyBwb3coMiwgNTMpIC0gMSA9PSA5MDA3MTk5MjU0NzQwOTkxCn07CgovKioqLyB9KSwKLyogNDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY29yZSAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBMSUJSQVJZICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpCiAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCiAgLCBkZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihuYW1lKXsKICB2YXIgJFN5bWJvbCA9IGNvcmUuU3ltYm9sIHx8IChjb3JlLlN5bWJvbCA9IExJQlJBUlkgPyB7fSA6IGdsb2JhbC5TeW1ib2wgfHwge30pOwogIGlmKG5hbWUuY2hhckF0KDApICE9ICdfJyAmJiAhKG5hbWUgaW4gJFN5bWJvbCkpZGVmaW5lUHJvcGVydHkoJFN5bWJvbCwgbmFtZSwge3ZhbHVlOiB3a3NFeHQuZihuYW1lKX0pOwp9OwoKLyoqKi8gfSksCi8qIDQ5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgovKioqLyB9KSwKLyogNTAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyICRhdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY2KSh0cnVlKTsKCi8vIDIxLjEuMy4yNyBTdHJpbmcucHJvdG90eXBlW0BAaXRlcmF0b3JdKCkKX193ZWJwYWNrX3JlcXVpcmVfXygzOSkoU3RyaW5nLCAnU3RyaW5nJywgZnVuY3Rpb24oaXRlcmF0ZWQpewogIHRoaXMuX3QgPSBTdHJpbmcoaXRlcmF0ZWQpOyAvLyB0YXJnZXQKICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleAovLyAyMS4xLjUuMi4xICVTdHJpbmdJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpCn0sIGZ1bmN0aW9uKCl7CiAgdmFyIE8gICAgID0gdGhpcy5fdAogICAgLCBpbmRleCA9IHRoaXMuX2kKICAgICwgcG9pbnQ7CiAgaWYoaW5kZXggPj0gTy5sZW5ndGgpcmV0dXJuIHt2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlfTsKICBwb2ludCA9ICRhdChPLCBpbmRleCk7CiAgdGhpcy5faSArPSBwb2ludC5sZW5ndGg7CiAgcmV0dXJuIHt2YWx1ZTogcG9pbnQsIGRvbmU6IGZhbHNlfTsKfSk7CgovKioqLyB9KSwKLyogNTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg2OSk7CnZhciBnbG9iYWwgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgaGlkZSAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIEl0ZXJhdG9ycyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQogICwgVE9fU1RSSU5HX1RBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMykoJ3RvU3RyaW5nVGFnJyk7Cgpmb3IodmFyIGNvbGxlY3Rpb25zID0gWydOb2RlTGlzdCcsICdET01Ub2tlbkxpc3QnLCAnTWVkaWFMaXN0JywgJ1N0eWxlU2hlZXRMaXN0JywgJ0NTU1J1bGVMaXN0J10sIGkgPSAwOyBpIDwgNTsgaSsrKXsKICB2YXIgTkFNRSAgICAgICA9IGNvbGxlY3Rpb25zW2ldCiAgICAsIENvbGxlY3Rpb24gPSBnbG9iYWxbTkFNRV0KICAgICwgcHJvdG8gICAgICA9IENvbGxlY3Rpb24gJiYgQ29sbGVjdGlvbi5wcm90b3R5cGU7CiAgaWYocHJvdG8gJiYgIXByb3RvW1RPX1NUUklOR19UQUddKWhpZGUocHJvdG8sIFRPX1NUUklOR19UQUcsIE5BTUUpOwogIEl0ZXJhdG9yc1tOQU1FXSA9IEl0ZXJhdG9ycy5BcnJheTsKfQoKLyoqKi8gfSksCi8qIDUyICovLAovKiA1MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY29yZSAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCAkSlNPTiA9IGNvcmUuSlNPTiB8fCAoY29yZS5KU09OID0ge3N0cmluZ2lmeTogSlNPTi5zdHJpbmdpZnl9KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzdHJpbmdpZnkoaXQpeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzCiAgcmV0dXJuICRKU09OLnN0cmluZ2lmeS5hcHBseSgkSlNPTiwgYXJndW1lbnRzKTsKfTsKCi8qKiovIH0pLAovKiA1NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoKCi8qKiovIH0pLAovKiA1NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBnZXR0aW5nIHRhZyBmcm9tIDE5LjEuMy42IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcoKQp2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCkKICAsIFRBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMykoJ3RvU3RyaW5nVGFnJykKICAvLyBFUzMgd3JvbmcgaGVyZQogICwgQVJHID0gY29mKGZ1bmN0aW9uKCl7IHJldHVybiBhcmd1bWVudHM7IH0oKSkgPT0gJ0FyZ3VtZW50cyc7CgovLyBmYWxsYmFjayBmb3IgSUUxMSBTY3JpcHQgQWNjZXNzIERlbmllZCBlcnJvcgp2YXIgdHJ5R2V0ID0gZnVuY3Rpb24oaXQsIGtleSl7CiAgdHJ5IHsKICAgIHJldHVybiBpdFtrZXldOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KfTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHZhciBPLCBULCBCOwogIHJldHVybiBpdCA9PT0gdW5kZWZpbmVkID8gJ1VuZGVmaW5lZCcgOiBpdCA9PT0gbnVsbCA/ICdOdWxsJwogICAgLy8gQEB0b1N0cmluZ1RhZyBjYXNlCiAgICA6IHR5cGVvZiAoVCA9IHRyeUdldChPID0gT2JqZWN0KGl0KSwgVEFHKSkgPT0gJ3N0cmluZycgPyBUCiAgICAvLyBidWlsdGluVGFnIGNhc2UKICAgIDogQVJHID8gY29mKE8pCiAgICAvLyBFUzMgYXJndW1lbnRzIGZhbGxiYWNrCiAgICA6IChCID0gY29mKE8pKSA9PSAnT2JqZWN0JyAmJiB0eXBlb2YgTy5jYWxsZWUgPT0gJ2Z1bmN0aW9uJyA/ICdBcmd1bWVudHMnIDogQjsKfTsKCi8qKiovIH0pLAovKiA1NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBmYWxsYmFjayBmb3Igbm9uLWFycmF5LWxpa2UgRVMzIGFuZCBub24tZW51bWVyYWJsZSBvbGQgVjggc3RyaW5ncwp2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7Cm1vZHVsZS5leHBvcnRzID0gT2JqZWN0KCd6JykucHJvcGVydHlJc0VudW1lcmFibGUoMCkgPyBPYmplY3QgOiBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGNvZihpdCkgPT0gJ1N0cmluZycgPyBpdC5zcGxpdCgnJykgOiBPYmplY3QoaXQpOwp9OwoKLyoqKi8gfSksCi8qIDU3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBwSUUgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCiAgLCBjcmVhdGVEZXNjICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCB0b0lPYmplY3QgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCB0b1ByaW1pdGl2ZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpCiAgLCBoYXMgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBJRThfRE9NX0RFRklORSA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpCiAgLCBnT1BEICAgICAgICAgICA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CgpleHBvcnRzLmYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpID8gZ09QRCA6IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKXsKICBPID0gdG9JT2JqZWN0KE8pOwogIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKICBpZihJRThfRE9NX0RFRklORSl0cnkgewogICAgcmV0dXJuIGdPUEQoTywgUCk7CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQogIGlmKGhhcyhPLCBQKSlyZXR1cm4gY3JlYXRlRGVzYyghcElFLmYuY2FsbChPLCBQKSwgT1tQXSk7Cn07CgovKioqLyB9KSwKLyogNTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKZXhwb3J0cy5mID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczsKCi8qKiovIH0pLAovKiA1OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfaXRlcmF0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc4KTsKCnZhciBfaXRlcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaXRlcmF0b3IpOwoKdmFyIF9zeW1ib2wgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc3KTsKCnZhciBfc3ltYm9sMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N5bWJvbCk7Cgp2YXIgX3R5cGVvZiA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBfaXRlcmF0b3IyLmRlZmF1bHQgPT09ICJzeW1ib2wiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IF9zeW1ib2wyLmRlZmF1bHQgJiYgb2JqICE9PSBfc3ltYm9sMi5kZWZhdWx0LnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLmRlZmF1bHQgPSB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBfdHlwZW9mKF9pdGVyYXRvcjIuZGVmYXVsdCkgPT09ICJzeW1ib2wiID8gZnVuY3Rpb24gKG9iaikgewogIHJldHVybiB0eXBlb2Ygb2JqID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihvYmopOwp9IDogZnVuY3Rpb24gKG9iaikgewogIHJldHVybiBvYmogJiYgdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBfc3ltYm9sMi5kZWZhdWx0ICYmIG9iaiAhPT0gX3N5bWJvbDIuZGVmYXVsdC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmogPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG9iaik7Cn07CgovKioqLyB9KSwKLyogNjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9OwoKLyoqKi8gfSksCi8qIDYxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbHNlIC0+IEFycmF5I2luZGV4T2YKLy8gdHJ1ZSAgLT4gQXJyYXkjaW5jbHVkZXMKdmFyIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCB0b0xlbmd0aCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KQogICwgdG9JbmRleCAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oSVNfSU5DTFVERVMpewogIHJldHVybiBmdW5jdGlvbigkdGhpcywgZWwsIGZyb21JbmRleCl7CiAgICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KCR0aGlzKQogICAgICAsIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKQogICAgICAsIGluZGV4ICA9IHRvSW5kZXgoZnJvbUluZGV4LCBsZW5ndGgpCiAgICAgICwgdmFsdWU7CiAgICAvLyBBcnJheSNpbmNsdWRlcyB1c2VzIFNhbWVWYWx1ZVplcm8gZXF1YWxpdHkgYWxnb3JpdGhtCiAgICBpZihJU19JTkNMVURFUyAmJiBlbCAhPSBlbCl3aGlsZShsZW5ndGggPiBpbmRleCl7CiAgICAgIHZhbHVlID0gT1tpbmRleCsrXTsKICAgICAgaWYodmFsdWUgIT0gdmFsdWUpcmV0dXJuIHRydWU7CiAgICAvLyBBcnJheSN0b0luZGV4IGlnbm9yZXMgaG9sZXMsIEFycmF5I2luY2x1ZGVzIC0gbm90CiAgICB9IGVsc2UgZm9yKDtsZW5ndGggPiBpbmRleDsgaW5kZXgrKylpZihJU19JTkNMVURFUyB8fCBpbmRleCBpbiBPKXsKICAgICAgaWYoT1tpbmRleF0gPT09IGVsKXJldHVybiBJU19JTkNMVURFUyB8fCBpbmRleCB8fCAwOwogICAgfSByZXR1cm4gIUlTX0lOQ0xVREVTICYmIC0xOwogIH07Cn07CgovKioqLyB9KSwKLyogNjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIGNyZWF0ZSAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNykKICAsIGRlc2NyaXB0b3IgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIEl0ZXJhdG9yUHJvdG90eXBlID0ge307CgovLyAyNS4xLjIuMS4xICVJdGVyYXRvclByb3RvdHlwZSVbQEBpdGVyYXRvcl0oKQpfX3dlYnBhY2tfcmVxdWlyZV9fKDcpKEl0ZXJhdG9yUHJvdG90eXBlLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdpdGVyYXRvcicpLCBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfSk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKENvbnN0cnVjdG9yLCBOQU1FLCBuZXh0KXsKICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSBjcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUsIHtuZXh0OiBkZXNjcmlwdG9yKDEsIG5leHQpfSk7CiAgc2V0VG9TdHJpbmdUYWcoQ29uc3RydWN0b3IsIE5BTUUgKyAnIEl0ZXJhdG9yJyk7Cn07CgovKioqLyB9KSwKLyogNjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihkb25lLCB2YWx1ZSl7CiAgcmV0dXJuIHt2YWx1ZTogdmFsdWUsIGRvbmU6ICEhZG9uZX07Cn07CgovKioqLyB9KSwKLyogNjQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRQICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpOwoKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpewogIGFuT2JqZWN0KE8pOwogIHZhciBrZXlzICAgPSBnZXRLZXlzKFByb3BlcnRpZXMpCiAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCiAgICAsIGkgPSAwCiAgICAsIFA7CiAgd2hpbGUobGVuZ3RoID4gaSlkUC5mKE8sIFAgPSBrZXlzW2krK10sIFByb3BlcnRpZXNbUF0pOwogIHJldHVybiBPOwp9OwoKLyoqKi8gfSksCi8qIDY1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi43IC8gMTUuMi4zLjQgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKdmFyICRrZXlzICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ0KQogICwgaGlkZGVuS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpLmNvbmNhdCgnbGVuZ3RoJywgJ3Byb3RvdHlwZScpOwoKZXhwb3J0cy5mID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgfHwgZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhPKXsKICByZXR1cm4gJGtleXMoTywgaGlkZGVuS2V5cyk7Cn07CgovKioqLyB9KSwKLyogNjYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCiAgLCBkZWZpbmVkICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKLy8gdHJ1ZSAgLT4gU3RyaW5nI2F0Ci8vIGZhbHNlIC0+IFN0cmluZyNjb2RlUG9pbnRBdAptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFRPX1NUUklORyl7CiAgcmV0dXJuIGZ1bmN0aW9uKHRoYXQsIHBvcyl7CiAgICB2YXIgcyA9IFN0cmluZyhkZWZpbmVkKHRoYXQpKQogICAgICAsIGkgPSB0b0ludGVnZXIocG9zKQogICAgICAsIGwgPSBzLmxlbmd0aAogICAgICAsIGEsIGI7CiAgICBpZihpIDwgMCB8fCBpID49IGwpcmV0dXJuIFRPX1NUUklORyA/ICcnIDogdW5kZWZpbmVkOwogICAgYSA9IHMuY2hhckNvZGVBdChpKTsKICAgIHJldHVybiBhIDwgMHhkODAwIHx8IGEgPiAweGRiZmYgfHwgaSArIDEgPT09IGwgfHwgKGIgPSBzLmNoYXJDb2RlQXQoaSArIDEpKSA8IDB4ZGMwMCB8fCBiID4gMHhkZmZmCiAgICAgID8gVE9fU1RSSU5HID8gcy5jaGFyQXQoaSkgOiBhCiAgICAgIDogVE9fU1RSSU5HID8gcy5zbGljZShpLCBpICsgMikgOiAoYSAtIDB4ZDgwMCA8PCAxMCkgKyAoYiAtIDB4ZGMwMCkgKyAweDEwMDAwOwogIH07Cn07CgovKioqLyB9KSwKLyogNjcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGN0eCAgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCiAgLCBpbnZva2UgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg5KQogICwgaHRtbCAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MikKICAsIGNlbCAgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpCiAgLCBnbG9iYWwgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBwcm9jZXNzICAgICAgICAgICAgPSBnbG9iYWwucHJvY2VzcwogICwgc2V0VGFzayAgICAgICAgICAgID0gZ2xvYmFsLnNldEltbWVkaWF0ZQogICwgY2xlYXJUYXNrICAgICAgICAgID0gZ2xvYmFsLmNsZWFySW1tZWRpYXRlCiAgLCBNZXNzYWdlQ2hhbm5lbCAgICAgPSBnbG9iYWwuTWVzc2FnZUNoYW5uZWwKICAsIGNvdW50ZXIgICAgICAgICAgICA9IDAKICAsIHF1ZXVlICAgICAgICAgICAgICA9IHt9CiAgLCBPTlJFQURZU1RBVEVDSEFOR0UgPSAnb25yZWFkeXN0YXRlY2hhbmdlJwogICwgZGVmZXIsIGNoYW5uZWwsIHBvcnQ7CnZhciBydW4gPSBmdW5jdGlvbigpewogIHZhciBpZCA9ICt0aGlzOwogIGlmKHF1ZXVlLmhhc093blByb3BlcnR5KGlkKSl7CiAgICB2YXIgZm4gPSBxdWV1ZVtpZF07CiAgICBkZWxldGUgcXVldWVbaWRdOwogICAgZm4oKTsKICB9Cn07CnZhciBsaXN0ZW5lciA9IGZ1bmN0aW9uKGV2ZW50KXsKICBydW4uY2FsbChldmVudC5kYXRhKTsKfTsKLy8gTm9kZS5qcyAwLjkrICYgSUUxMCsgaGFzIHNldEltbWVkaWF0ZSwgb3RoZXJ3aXNlOgppZighc2V0VGFzayB8fCAhY2xlYXJUYXNrKXsKICBzZXRUYXNrID0gZnVuY3Rpb24gc2V0SW1tZWRpYXRlKGZuKXsKICAgIHZhciBhcmdzID0gW10sIGkgPSAxOwogICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKICAgIHF1ZXVlWysrY291bnRlcl0gPSBmdW5jdGlvbigpewogICAgICBpbnZva2UodHlwZW9mIGZuID09ICdmdW5jdGlvbicgPyBmbiA6IEZ1bmN0aW9uKGZuKSwgYXJncyk7CiAgICB9OwogICAgZGVmZXIoY291bnRlcik7CiAgICByZXR1cm4gY291bnRlcjsKICB9OwogIGNsZWFyVGFzayA9IGZ1bmN0aW9uIGNsZWFySW1tZWRpYXRlKGlkKXsKICAgIGRlbGV0ZSBxdWV1ZVtpZF07CiAgfTsKICAvLyBOb2RlLmpzIDAuOC0KICBpZihfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKShwcm9jZXNzKSA9PSAncHJvY2VzcycpewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIHByb2Nlc3MubmV4dFRpY2soY3R4KHJ1biwgaWQsIDEpKTsKICAgIH07CiAgLy8gQnJvd3NlcnMgd2l0aCBNZXNzYWdlQ2hhbm5lbCwgaW5jbHVkZXMgV2ViV29ya2VycwogIH0gZWxzZSBpZihNZXNzYWdlQ2hhbm5lbCl7CiAgICBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsOwogICAgcG9ydCAgICA9IGNoYW5uZWwucG9ydDI7CiAgICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGxpc3RlbmVyOwogICAgZGVmZXIgPSBjdHgocG9ydC5wb3N0TWVzc2FnZSwgcG9ydCwgMSk7CiAgLy8gQnJvd3NlcnMgd2l0aCBwb3N0TWVzc2FnZSwgc2tpcCBXZWJXb3JrZXJzCiAgLy8gSUU4IGhhcyBwb3N0TWVzc2FnZSwgYnV0IGl0J3Mgc3luYyAmIHR5cGVvZiBpdHMgcG9zdE1lc3NhZ2UgaXMgJ29iamVjdCcKICB9IGVsc2UgaWYoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIgJiYgdHlwZW9mIHBvc3RNZXNzYWdlID09ICdmdW5jdGlvbicgJiYgIWdsb2JhbC5pbXBvcnRTY3JpcHRzKXsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBnbG9iYWwucG9zdE1lc3NhZ2UoaWQgKyAnJywgJyonKTsKICAgIH07CiAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGxpc3RlbmVyLCBmYWxzZSk7CiAgLy8gSUU4LQogIH0gZWxzZSBpZihPTlJFQURZU1RBVEVDSEFOR0UgaW4gY2VsKCdzY3JpcHQnKSl7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgaHRtbC5hcHBlbmRDaGlsZChjZWwoJ3NjcmlwdCcpKVtPTlJFQURZU1RBVEVDSEFOR0VdID0gZnVuY3Rpb24oKXsKICAgICAgICBodG1sLnJlbW92ZUNoaWxkKHRoaXMpOwogICAgICAgIHJ1bi5jYWxsKGlkKTsKICAgICAgfTsKICAgIH07CiAgLy8gUmVzdCBvbGQgYnJvd3NlcnMKICB9IGVsc2UgewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIHNldFRpbWVvdXQoY3R4KHJ1biwgaWQsIDEpLCAwKTsKICAgIH07CiAgfQp9Cm1vZHVsZS5leHBvcnRzID0gewogIHNldDogICBzZXRUYXNrLAogIGNsZWFyOiBjbGVhclRhc2sKfTsKCi8qKiovIH0pLAovKiA2OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkKICAsIG1heCAgICAgICA9IE1hdGgubWF4CiAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpbmRleCwgbGVuZ3RoKXsKICBpbmRleCA9IHRvSW50ZWdlcihpbmRleCk7CiAgcmV0dXJuIGluZGV4IDwgMCA/IG1heChpbmRleCArIGxlbmd0aCwgMCkgOiBtaW4oaW5kZXgsIGxlbmd0aCk7Cn07CgovKioqLyB9KSwKLyogNjkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIGFkZFRvVW5zY29wYWJsZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYwKQogICwgc3RlcCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjMpCiAgLCBJdGVyYXRvcnMgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIHRvSU9iamVjdCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTsKCi8vIDIyLjEuMy40IEFycmF5LnByb3RvdHlwZS5lbnRyaWVzKCkKLy8gMjIuMS4zLjEzIEFycmF5LnByb3RvdHlwZS5rZXlzKCkKLy8gMjIuMS4zLjI5IEFycmF5LnByb3RvdHlwZS52YWx1ZXMoKQovLyAyMi4xLjMuMzAgQXJyYXkucHJvdG90eXBlW0BAaXRlcmF0b3JdKCkKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KShBcnJheSwgJ0FycmF5JywgZnVuY3Rpb24oaXRlcmF0ZWQsIGtpbmQpewogIHRoaXMuX3QgPSB0b0lPYmplY3QoaXRlcmF0ZWQpOyAvLyB0YXJnZXQKICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleAogIHRoaXMuX2sgPSBraW5kOyAgICAgICAgICAgICAgICAvLyBraW5kCi8vIDIyLjEuNS4yLjEgJUFycmF5SXRlcmF0b3JQcm90b3R5cGUlLm5leHQoKQp9LCBmdW5jdGlvbigpewogIHZhciBPICAgICA9IHRoaXMuX3QKICAgICwga2luZCAgPSB0aGlzLl9rCiAgICAsIGluZGV4ID0gdGhpcy5faSsrOwogIGlmKCFPIHx8IGluZGV4ID49IE8ubGVuZ3RoKXsKICAgIHRoaXMuX3QgPSB1bmRlZmluZWQ7CiAgICByZXR1cm4gc3RlcCgxKTsKICB9CiAgaWYoa2luZCA9PSAna2V5cycgIClyZXR1cm4gc3RlcCgwLCBpbmRleCk7CiAgaWYoa2luZCA9PSAndmFsdWVzJylyZXR1cm4gc3RlcCgwLCBPW2luZGV4XSk7CiAgcmV0dXJuIHN0ZXAoMCwgW2luZGV4LCBPW2luZGV4XV0pOwp9LCAndmFsdWVzJyk7CgovLyBhcmd1bWVudHNMaXN0W0BAaXRlcmF0b3JdIGlzICVBcnJheVByb3RvX3ZhbHVlcyUgKDkuNC40LjYsIDkuNC40LjcpCkl0ZXJhdG9ycy5Bcmd1bWVudHMgPSBJdGVyYXRvcnMuQXJyYXk7CgphZGRUb1Vuc2NvcGFibGVzKCdrZXlzJyk7CmFkZFRvVW5zY29wYWJsZXMoJ3ZhbHVlcycpOwphZGRUb1Vuc2NvcGFibGVzKCdlbnRyaWVzJyk7CgovKioqLyB9KSwKLyogNzAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCnZhciBfc3RyaW5naWZ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmeSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCmV4cG9ydHMuZGl2aWRlVVJMID0gZGl2aWRlVVJMOwpleHBvcnRzLmRpdmlkZUVtYWlsID0gZGl2aWRlRW1haWw7CmV4cG9ydHMuZW1wdHlPYmplY3QgPSBlbXB0eU9iamVjdDsKZXhwb3J0cy5kZWVwQ2xvbmUgPSBkZWVwQ2xvbmU7CmV4cG9ydHMuZ2V0VXNlclVSTEZyb21FbWFpbCA9IGdldFVzZXJVUkxGcm9tRW1haWw7CmV4cG9ydHMuZ2V0VXNlckVtYWlsRnJvbVVSTCA9IGdldFVzZXJFbWFpbEZyb21VUkw7CmV4cG9ydHMuY29udmVydFRvVXNlclVSTCA9IGNvbnZlcnRUb1VzZXJVUkw7CmV4cG9ydHMuY2hlY2tBdHRyaWJ1dGUgPSBjaGVja0F0dHJpYnV0ZTsKZXhwb3J0cy5wYXJzZUF0dHJpYnV0ZXMgPSBwYXJzZUF0dHJpYnV0ZXM7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqDQoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQ0KKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRA0KKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wNCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBDQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcNCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElODQoqDQoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuDQoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KKg0KKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KKg0KKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KKiovCi8qKg0KICogU3VwcG9ydCBtb2R1bGUgd2l0aCBzb21lIGZ1bmN0aW9ucyB3aWxsIGJlIHVzZWZ1bA0KICogQG1vZHVsZSB1dGlscw0KICovCgovKioNCiAqIEB0eXBlZGVmIGRpdmlkZVVSTA0KICogQHR5cGUgT2JqZWN0DQogKiBAcHJvcGVydHkge3N0cmluZ30gdHlwZSBUaGUgdHlwZSBvZiBVUkwNCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkb21haW4gVGhlIGRvbWFpbiBvZiBVUkwNCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBpZGVudGl0eSBUaGUgaWRlbnRpdHkgb2YgVVJMDQogKi8KCi8qKg0KICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5DQogKiBAcGFyYW0gIHtVUkwuVVJMfSB1cmwgLSB1cmwgYWRkcmVzcw0KICogQHJldHVybiB7ZGl2aWRlVVJMfSB0aGUgcmVzdWx0IG9mIGRpdmlkZVVSTA0KICovCmZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHsKCiAgaWYgKCF1cmwpIHRocm93IEVycm9yKCdVUkwgaXMgbmVlZGVkIHRvIHNwbGl0Jyk7CgogIGZ1bmN0aW9uIHJlY3Vyc2UodmFsdWUpIHsKICAgIHZhciByZWdleCA9IC8oW2EtekEtWi1dKikoOlwvXC8oPzpcLik/fDopKFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTsKICAgIHZhciBzdWJzdCA9ICckMSwkMywkNCc7CiAgICB2YXIgcGFydHMgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBzdWJzdCkuc3BsaXQoJywnKTsKICAgIHJldHVybiBwYXJ0czsKICB9CgogIHZhciBwYXJ0cyA9IHJlY3Vyc2UodXJsKTsKCiAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lCiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgIXBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKCiAgICB2YXIgX3Jlc3VsdCA9IHsKICAgICAgdHlwZTogIiIsCiAgICAgIGRvbWFpbjogdXJsLAogICAgICBpZGVudGl0eTogIiIKICAgIH07CgogICAgY29uc29sZS5lcnJvcignW0RpdmlkZVVSTF0gRGl2aWRlVVJMIGRvblwndCBzdXBwb3J0IHVybCB3aXRob3V0IHNjaGVtZS4gUGxlYXNlIHJldmlldyB5b3VyIHVybCBhZGRyZXNzJywgdXJsKTsKCiAgICByZXR1cm4gX3Jlc3VsdDsKICB9CgogIC8vIGNoZWNrIGlmIHRoZSB1cmwgaGFzIHRoZSBzY2hlbWUgYW5kIGluY2x1ZGVzIGFuIEAKICBpZiAocGFydHNbMF0gPT09IHVybCAmJiBwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CiAgICB2YXIgc2NoZW1lID0gcGFydHNbMF0gPT09IHVybCA/ICdzbXRwJyA6IHBhcnRzWzBdOwogICAgcGFydHMgPSByZWN1cnNlKHNjaGVtZSArICc6Ly8nICsgcGFydHNbMF0pOwogIH0KCiAgLy8gaWYgdGhlIGRvbWFpbiBpbmNsdWRlcyBhbiBALCBkaXZpZGUgaXQgdG8gZG9tYWluIGFuZCBpZGVudGl0eSByZXNwZWN0aXZlbHkKICBpZiAocGFydHNbMV0uaW5jbHVkZXMoJ0AnKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1swXSArICc6Ly8nICsgcGFydHNbMV07CiAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdLnN1YnN0cihwYXJ0c1sxXS5pbmRleE9mKCdAJykgKyAxKTsKICB9IC8qZWxzZSBpZiAocGFydHNbMl0uaW5jbHVkZXMoJy8nKSkgew0KICAgIHBhcnRzWzJdID0gcGFydHNbMl0uc3Vic3RyKHBhcnRzWzJdLmxhc3RJbmRleE9mKCcvJykrMSk7DQogICAgfSovCgogIHZhciByZXN1bHQgPSB7CiAgICB0eXBlOiBwYXJ0c1swXSwKICAgIGRvbWFpbjogcGFydHNbMV0sCiAgICBpZGVudGl0eTogcGFydHNbMl0KICB9OwoKICByZXR1cm4gcmVzdWx0Owp9CgpmdW5jdGlvbiBkaXZpZGVFbWFpbChlbWFpbCkgewogIHZhciBpbmRleE9mQXQgPSBlbWFpbC5pbmRleE9mKCdAJyk7CgogIHZhciByZXN1bHQgPSB7CiAgICB1c2VybmFtZTogZW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCksCiAgICBkb21haW46IGVtYWlsLnN1YnN0cmluZyhpbmRleE9mQXQgKyAxLCBlbWFpbC5sZW5ndGgpCiAgfTsKCiAgcmV0dXJuIHJlc3VsdDsKfQoKLyoqDQogKiBDaGVjayBpZiBhbiBPYmplY3QgaXMgZW1wdHkNCiAqIEBwYXJhbSAge09iamVjdH0gb2JqZWN0IE9iamVjdCB0byBiZSBjaGVja2VkDQogKiBAcmV0dXJuIHtCb29sZWFufSAgICAgICBzdGF0dXMgb2YgT2JqZWN0LCBlbXB0eSBvciBub3QgKHRydWV8ZmFsc2UpOw0KICovCmZ1bmN0aW9uIGVtcHR5T2JqZWN0KG9iamVjdCkgewogIHJldHVybiAoMCwgX2tleXMyLmRlZmF1bHQpKG9iamVjdCkubGVuZ3RoID4gMCA/IGZhbHNlIDogdHJ1ZTsKfQoKLyoqDQogKiBNYWtlIGEgQ09QWSBvZiB0aGUgb3JpZ2luYWwgZGF0YQ0KICogQHBhcmFtICB7T2JqZWN0fSAgb2JqIC0gb2JqZWN0IHRvIGJlIGNsb25lZA0KICogQHJldHVybiB7T2JqZWN0fQ0KICovCmZ1bmN0aW9uIGRlZXBDbG9uZShvYmopIHsKICAvL1RPRE86IHNpbXBsZSBidXQgaW5lZmZpY2llbnQgSlNPTiBkZWVwIGNsb25lLi4uCiAgaWYgKG9iaikgcmV0dXJuIEpTT04ucGFyc2UoKDAsIF9zdHJpbmdpZnkyLmRlZmF1bHQpKG9iaikpOwp9CgovKioNCiAqIE9idGFpbnMgdGhlIHVzZXIgVVJMIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBlbWFpbA0KICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwNCiAqIEByZXR1cm4ge1VSTC5VUkx9IHVzZXJVUkwgVGhlIHVzZXIgVVJMDQogKi8KZnVuY3Rpb24gZ2V0VXNlclVSTEZyb21FbWFpbCh1c2VyRW1haWwpIHsKICB2YXIgaW5kZXhPZkF0ID0gdXNlckVtYWlsLmluZGV4T2YoJ0AnKTsKICByZXR1cm4gJ3VzZXI6Ly8nICsgdXNlckVtYWlsLnN1YnN0cmluZyhpbmRleE9mQXQgKyAxLCB1c2VyRW1haWwubGVuZ3RoKSArICcvJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoMCwgaW5kZXhPZkF0KTsKfQoKLyoqDQogKiBPYnRhaW5zIHRoZSB1c2VyIGVtYWlsIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBVUkwNCiAqIEBwYXJhbSAge1VSTC5VUkx9IHVzZXJVUkwgVGhlIHVzZXIgVVJMDQogKiBAcmV0dXJuIHtzdHJpbmd9IHVzZXJFbWFpbCBUaGUgdXNlciBlbWFpbA0KICovCmZ1bmN0aW9uIGdldFVzZXJFbWFpbEZyb21VUkwodXNlclVSTCkgewogIHZhciB1cmwgPSBkaXZpZGVVUkwodXNlclVSTCk7CiAgcmV0dXJuIHVybC5pZGVudGl0eS5yZXBsYWNlKCcvJywgJycpICsgJ0AnICsgdXJsLmRvbWFpbjsgLy8gaWRlbnRpdHkgZmllbGQgaGFzICcvZXhhbXBsZUlEJyBpbnN0ZWFkIG9mICdleGFtcGxlSUQnCn0KCi8qKg0KICogQ2hlY2sgaWYgdGhlIHVzZXIgaWRlbnRpZmllciBpcyBhbHJlYWR5IGluIHRoZSBVUkwgZm9ybWF0LCBpZiBub3QsIGNvbnZlcnQgdG8gVVJMIGZvcm1hdA0KICogQHBhcmFtICB7c3RyaW5nfSAgIGlkZW50aWZpZXIgIHVzZXIgaWRlbnRpZmllcg0KICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMDQogKi8KZnVuY3Rpb24gY29udmVydFRvVXNlclVSTChpZGVudGlmaWVyKSB7CgogIC8vIGNoZWNrIGlmIHRoZSBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIHVybCBmb3JtYXQKICBpZiAoaWRlbnRpZmllci5zdWJzdHJpbmcoMCwgNykgPT09ICd1c2VyOi8vJykgewogICAgdmFyIGRpdmlkZWRVUkwgPSBkaXZpZGVVUkwoaWRlbnRpZmllcik7CgogICAgLy9jaGVjayBpZiB0aGUgdXJsIGlzIHdlbGwgZm9ybWF0ZWQKICAgIGlmIChkaXZpZGVkVVJMLmRvbWFpbiAmJiBkaXZpZGVkVVJMLmlkZW50aXR5KSB7CiAgICAgIHJldHVybiBpZGVudGlmaWVyOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgJ3VzZXJVUkwgd2l0aCB3cm9uZyBmb3JtYXQnOwogICAgfQoKICAgIC8vaWYgbm90LCBjb252ZXJ0IHRoZSB1c2VyIGVtYWlsIHRvIFVSTCBmb3JtYXQKICB9IGVsc2UgewogICAgcmV0dXJuIGdldFVzZXJVUkxGcm9tRW1haWwoaWRlbnRpZmllcik7CiAgfQp9CgpmdW5jdGlvbiBjaGVja0F0dHJpYnV0ZShwYXRoKSB7CgogIHZhciByZWdleCA9IC8oKChbYS16QS1aXSspOlwvXC8oWzAtOWEtekEtWl1bLVx3XSpbMC05YS16QS1aXVwuKStbYS16QS1aXXsyLDl9KVwvW2EtekEtWjAtOVwuXStAW2EtekEtWjAtOV0rKFwtKT9bYS16QS1aMC05XSsoXC4pP1thLXpBLVowLTldezIsMTB9P1wuW2EtekEtWl17MiwxMH0pKC4rKD89LmlkZW50aXR5KSk/L2dtOwoKICB2YXIgbGlzdCA9IFtdOwogIHZhciBmaW5hbCA9IFtdOwogIHZhciB0ZXN0ID0gcGF0aC5tYXRjaChyZWdleCk7CgogIGlmICh0ZXN0ID09IG51bGwpIHsKICAgIGZpbmFsID0gcGF0aC5zcGxpdCgnLicpOwogIH0gZWxzZSB7CiAgICB2YXIgbSA9IHZvaWQgMDsKICAgIHdoaWxlICgobSA9IHJlZ2V4LmV4ZWMocGF0aCkpICE9PSBudWxsKSB7CiAgICAgIC8vIFRoaXMgaXMgbmVjZXNzYXJ5IHRvIGF2b2lkIGluZmluaXRlIGxvb3BzIHdpdGggemVyby13aWR0aCBtYXRjaGVzCiAgICAgIGlmIChtLmluZGV4ID09PSByZWdleC5sYXN0SW5kZXgpIHsKICAgICAgICByZWdleC5sYXN0SW5kZXgrKzsKICAgICAgfQoKICAgICAgLy8gVGhlIHJlc3VsdCBjYW4gYmUgYWNjZXNzZWQgdGhyb3VnaCB0aGUgYG1gLXZhcmlhYmxlLgogICAgICBtLmZvckVhY2goZnVuY3Rpb24gKG1hdGNoLCBncm91cEluZGV4KSB7CiAgICAgICAgaWYgKGdyb3VwSW5kZXggPT09IDApIHsKICAgICAgICAgIGxpc3QucHVzaChtYXRjaCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIHZhciByZXN1bHQgPSB2b2lkIDA7CiAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24gKHVybCkgewogICAgICByZXN1bHQgPSBwYXRoLnJlcGxhY2UodXJsLCAnKisqJyk7CgogICAgICBmaW5hbCA9IHJlc3VsdC5zcGxpdCgnLicpLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGlmIChpdGVtID09PSAnKisqJykgewogICAgICAgICAgcmV0dXJuIHVybDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICBjb25zb2xlLmxvZygnW1NlcnZpY2VGcmFtZXdvcmsuVXRpbHMuY2hlY2tBdHRyaWJ1dGVdJywgZmluYWwpOwogIHJldHVybiBmaW5hbDsKfQoKZnVuY3Rpb24gcGFyc2VBdHRyaWJ1dGVzKHBhdGgpIHsKICB2YXIgcmVnZXggPSAvKFswLTlhLXpBLVpdWy1cd10qKTpcL1wvL2c7CgogIHZhciBzdHJpbmczID0gJ2lkZW50aXR5JzsKCiAgaWYgKCFwYXRoLmluY2x1ZGVzKCc6Ly8nKSkgewogICAgcmV0dXJuIHBhdGguc3BsaXQoJy4nKTsKICB9IGVsc2UgewogICAgdmFyIHN0cmluZzEgPSBwYXRoLnNwbGl0KHJlZ2V4KVswXTsKCiAgICB2YXIgYXJyYXkxID0gc3RyaW5nMS5zcGxpdCgnLicpOwoKICAgIHZhciBzdHJpbmcyID0gcGF0aC5yZXBsYWNlKHN0cmluZzEsICcnKTsKCiAgICBpZiAocGF0aC5pbmNsdWRlcyhzdHJpbmczKSkgewoKICAgICAgdmFyIGFycmF5MiA9IHN0cmluZzIuc3BsaXQoc3RyaW5nMyArICcuJyk7CgogICAgICBjb25zb2xlLmxvZygnYXJyYXkyICcgKyBhcnJheTIpOwoKICAgICAgc3RyaW5nMiA9IGFycmF5MlswXS5zbGljZSgnLicsIC0xKTsKCiAgICAgIGFycmF5MiA9IGFycmF5MlsxXS5zcGxpdCgnLicpOwoKICAgICAgYXJyYXkxLnB1c2goc3RyaW5nMiwgc3RyaW5nMyk7CgogICAgICBhcnJheTEgPSBhcnJheTEuY29uY2F0KGFycmF5Mik7CiAgICB9IGVsc2UgewogICAgICBhcnJheTEucHVzaChzdHJpbmcyKTsKICAgIH0KCiAgICByZXR1cm4gYXJyYXkxLmZpbHRlcihCb29sZWFuKTsKICB9Cn0KCi8qKiovIH0pLAovKiA3MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgzKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDczICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBNRVRBICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpKCdtZXRhJykKICAsIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgaGFzICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQogICwgc2V0RGVzYyAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmYKICAsIGlkICAgICAgID0gMDsKdmFyIGlzRXh0ZW5zaWJsZSA9IE9iamVjdC5pc0V4dGVuc2libGUgfHwgZnVuY3Rpb24oKXsKICByZXR1cm4gdHJ1ZTsKfTsKdmFyIEZSRUVaRSA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHJldHVybiBpc0V4dGVuc2libGUoT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKHt9KSk7Cn0pOwp2YXIgc2V0TWV0YSA9IGZ1bmN0aW9uKGl0KXsKICBzZXREZXNjKGl0LCBNRVRBLCB7dmFsdWU6IHsKICAgIGk6ICdPJyArICsraWQsIC8vIG9iamVjdCBJRAogICAgdzoge30gICAgICAgICAgLy8gd2VhayBjb2xsZWN0aW9ucyBJRHMKICB9fSk7Cn07CnZhciBmYXN0S2V5ID0gZnVuY3Rpb24oaXQsIGNyZWF0ZSl7CiAgLy8gcmV0dXJuIHByaW1pdGl2ZSB3aXRoIHByZWZpeAogIGlmKCFpc09iamVjdChpdCkpcmV0dXJuIHR5cGVvZiBpdCA9PSAnc3ltYm9sJyA/IGl0IDogKHR5cGVvZiBpdCA9PSAnc3RyaW5nJyA/ICdTJyA6ICdQJykgKyBpdDsKICBpZighaGFzKGl0LCBNRVRBKSl7CiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdAogICAgaWYoIWlzRXh0ZW5zaWJsZShpdCkpcmV0dXJuICdGJzsKICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhCiAgICBpZighY3JlYXRlKXJldHVybiAnRSc7CiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YQogICAgc2V0TWV0YShpdCk7CiAgLy8gcmV0dXJuIG9iamVjdCBJRAogIH0gcmV0dXJuIGl0W01FVEFdLmk7Cn07CnZhciBnZXRXZWFrID0gZnVuY3Rpb24oaXQsIGNyZWF0ZSl7CiAgaWYoIWhhcyhpdCwgTUVUQSkpewogICAgLy8gY2FuJ3Qgc2V0IG1ldGFkYXRhIHRvIHVuY2F1Z2h0IGZyb3plbiBvYmplY3QKICAgIGlmKCFpc0V4dGVuc2libGUoaXQpKXJldHVybiB0cnVlOwogICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGEKICAgIGlmKCFjcmVhdGUpcmV0dXJuIGZhbHNlOwogICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGEKICAgIHNldE1ldGEoaXQpOwogIC8vIHJldHVybiBoYXNoIHdlYWsgY29sbGVjdGlvbnMgSURzCiAgfSByZXR1cm4gaXRbTUVUQV0udzsKfTsKLy8gYWRkIG1ldGFkYXRhIG9uIGZyZWV6ZS1mYW1pbHkgbWV0aG9kcyBjYWxsaW5nCnZhciBvbkZyZWV6ZSA9IGZ1bmN0aW9uKGl0KXsKICBpZihGUkVFWkUgJiYgbWV0YS5ORUVEICYmIGlzRXh0ZW5zaWJsZShpdCkgJiYgIWhhcyhpdCwgTUVUQSkpc2V0TWV0YShpdCk7CiAgcmV0dXJuIGl0Owp9Owp2YXIgbWV0YSA9IG1vZHVsZS5leHBvcnRzID0gewogIEtFWTogICAgICBNRVRBLAogIE5FRUQ6ICAgICBmYWxzZSwKICBmYXN0S2V5OiAgZmFzdEtleSwKICBnZXRXZWFrOiAgZ2V0V2VhaywKICBvbkZyZWV6ZTogb25GcmVlemUKfTsKCi8qKiovIH0pLAovKiA3NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY2xhc3NvZiAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NSkKICAsIElURVJBVE9SICA9IF9fd2VicGFja19yZXF1aXJlX18oMykoJ2l0ZXJhdG9yJykKICAsIEl0ZXJhdG9ycyA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuZ2V0SXRlcmF0b3JNZXRob2QgPSBmdW5jdGlvbihpdCl7CiAgaWYoaXQgIT0gdW5kZWZpbmVkKXJldHVybiBpdFtJVEVSQVRPUl0KICAgIHx8IGl0WydAQGl0ZXJhdG9yJ10KICAgIHx8IEl0ZXJhdG9yc1tjbGFzc29mKGl0KV07Cn07CgovKioqLyB9KSwKLyogNzUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg3OSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgyKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODQpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4NSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMSk7CnZhciAkT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Q7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY3JlYXRlKFAsIEQpewogIHJldHVybiAkT2JqZWN0LmNyZWF0ZShQLCBEKTsKfTsKCi8qKiovIH0pLAovKiA4MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMik7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3QuZ2V0UHJvdG90eXBlT2Y7CgovKioqLyB9KSwKLyogODEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygxMDMpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0LmtleXM7CgovKioqLyB9KSwKLyogODIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygxMDQpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0LnNldFByb3RvdHlwZU9mOwoKLyoqKi8gfSksCi8qIDgzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNTQpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7Cl9fd2VicGFja19yZXF1aXJlX18oMTA1KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLlByb21pc2U7CgovKioqLyB9KSwKLyogODQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygxMDYpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KTsKX193ZWJwYWNrX3JlcXVpcmVfXygxMDcpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwOCk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5TeW1ib2w7CgovKioqLyB9KSwKLyogODUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7Cl9fd2VicGFja19yZXF1aXJlX18oNTEpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpLmYoJ2l0ZXJhdG9yJyk7CgovKioqLyB9KSwKLyogODYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgQ29uc3RydWN0b3IsIG5hbWUsIGZvcmJpZGRlbkZpZWxkKXsKICBpZighKGl0IGluc3RhbmNlb2YgQ29uc3RydWN0b3IpIHx8IChmb3JiaWRkZW5GaWVsZCAhPT0gdW5kZWZpbmVkICYmIGZvcmJpZGRlbkZpZWxkIGluIGl0KSl7CiAgICB0aHJvdyBUeXBlRXJyb3IobmFtZSArICc6IGluY29ycmVjdCBpbnZvY2F0aW9uIScpOwogIH0gcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDg3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGFsbCBlbnVtZXJhYmxlIG9iamVjdCBrZXlzLCBpbmNsdWRlcyBzeW1ib2xzCnZhciBnZXRLZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkKICAsIGdPUFMgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU4KQogICwgcElFICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICB2YXIgcmVzdWx0ICAgICA9IGdldEtleXMoaXQpCiAgICAsIGdldFN5bWJvbHMgPSBnT1BTLmY7CiAgaWYoZ2V0U3ltYm9scyl7CiAgICB2YXIgc3ltYm9scyA9IGdldFN5bWJvbHMoaXQpCiAgICAgICwgaXNFbnVtICA9IHBJRS5mCiAgICAgICwgaSAgICAgICA9IDAKICAgICAgLCBrZXk7CiAgICB3aGlsZShzeW1ib2xzLmxlbmd0aCA+IGkpaWYoaXNFbnVtLmNhbGwoaXQsIGtleSA9IHN5bWJvbHNbaSsrXSkpcmVzdWx0LnB1c2goa2V5KTsKICB9IHJldHVybiByZXN1bHQ7Cn07CgovKioqLyB9KSwKLyogODggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGN0eCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGNhbGwgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MikKICAsIGlzQXJyYXlJdGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MCkKICAsIGFuT2JqZWN0ICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQogICwgdG9MZW5ndGggICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KQogICwgZ2V0SXRlckZuICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc0KQogICwgQlJFQUsgICAgICAgPSB7fQogICwgUkVUVVJOICAgICAgPSB7fTsKdmFyIGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhYmxlLCBlbnRyaWVzLCBmbiwgdGhhdCwgSVRFUkFUT1IpewogIHZhciBpdGVyRm4gPSBJVEVSQVRPUiA/IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyYWJsZTsgfSA6IGdldEl0ZXJGbihpdGVyYWJsZSkKICAgICwgZiAgICAgID0gY3R4KGZuLCB0aGF0LCBlbnRyaWVzID8gMiA6IDEpCiAgICAsIGluZGV4ICA9IDAKICAgICwgbGVuZ3RoLCBzdGVwLCBpdGVyYXRvciwgcmVzdWx0OwogIGlmKHR5cGVvZiBpdGVyRm4gIT0gJ2Z1bmN0aW9uJyl0aHJvdyBUeXBlRXJyb3IoaXRlcmFibGUgKyAnIGlzIG5vdCBpdGVyYWJsZSEnKTsKICAvLyBmYXN0IGNhc2UgZm9yIGFycmF5cyB3aXRoIGRlZmF1bHQgaXRlcmF0b3IKICBpZihpc0FycmF5SXRlcihpdGVyRm4pKWZvcihsZW5ndGggPSB0b0xlbmd0aChpdGVyYWJsZS5sZW5ndGgpOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKyl7CiAgICByZXN1bHQgPSBlbnRyaWVzID8gZihhbk9iamVjdChzdGVwID0gaXRlcmFibGVbaW5kZXhdKVswXSwgc3RlcFsxXSkgOiBmKGl0ZXJhYmxlW2luZGV4XSk7CiAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7CiAgfSBlbHNlIGZvcihpdGVyYXRvciA9IGl0ZXJGbi5jYWxsKGl0ZXJhYmxlKTsgIShzdGVwID0gaXRlcmF0b3IubmV4dCgpKS5kb25lOyApewogICAgcmVzdWx0ID0gY2FsbChpdGVyYXRvciwgZiwgc3RlcC52YWx1ZSwgZW50cmllcyk7CiAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7CiAgfQp9OwpleHBvcnRzLkJSRUFLICA9IEJSRUFLOwpleHBvcnRzLlJFVFVSTiA9IFJFVFVSTjsKCi8qKiovIH0pLAovKiA4OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBmYXN0IGFwcGx5LCBodHRwOi8vanNwZXJmLmxua2l0LmNvbS9mYXN0LWFwcGx5LzUKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmbiwgYXJncywgdGhhdCl7CiAgdmFyIHVuID0gdGhhdCA9PT0gdW5kZWZpbmVkOwogIHN3aXRjaChhcmdzLmxlbmd0aCl7CiAgICBjYXNlIDA6IHJldHVybiB1biA/IGZuKCkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0KTsKICAgIGNhc2UgMTogcmV0dXJuIHVuID8gZm4oYXJnc1swXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdKTsKICAgIGNhc2UgMjogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdKTsKICAgIGNhc2UgMzogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTsKICAgIGNhc2UgNDogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSkKICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKTsKICB9IHJldHVybiAgICAgICAgICAgICAgZm4uYXBwbHkodGhhdCwgYXJncyk7Cn07CgovKioqLyB9KSwKLyogOTAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gY2hlY2sgb24gZGVmYXVsdCBBcnJheSBpdGVyYXRvcgp2YXIgSXRlcmF0b3JzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCiAgLCBJVEVSQVRPUiAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnaXRlcmF0b3InKQogICwgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCAhPT0gdW5kZWZpbmVkICYmIChJdGVyYXRvcnMuQXJyYXkgPT09IGl0IHx8IEFycmF5UHJvdG9bSVRFUkFUT1JdID09PSBpdCk7Cn07CgovKioqLyB9KSwKLyogOTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4yLjIgSXNBcnJheShhcmd1bWVudCkKdmFyIGNvZiA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwptb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gaXNBcnJheShhcmcpewogIHJldHVybiBjb2YoYXJnKSA9PSAnQXJyYXknOwp9OwoKLyoqKi8gfSksCi8qIDkyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGNhbGwgc29tZXRoaW5nIG9uIGl0ZXJhdG9yIHN0ZXAgd2l0aCBzYWZlIGNsb3Npbmcgb24gZXJyb3IKdmFyIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdGVyYXRvciwgZm4sIHZhbHVlLCBlbnRyaWVzKXsKICB0cnkgewogICAgcmV0dXJuIGVudHJpZXMgPyBmbihhbk9iamVjdCh2YWx1ZSlbMF0sIHZhbHVlWzFdKSA6IGZuKHZhbHVlKTsKICAvLyA3LjQuNiBJdGVyYXRvckNsb3NlKGl0ZXJhdG9yLCBjb21wbGV0aW9uKQogIH0gY2F0Y2goZSl7CiAgICB2YXIgcmV0ID0gaXRlcmF0b3JbJ3JldHVybiddOwogICAgaWYocmV0ICE9PSB1bmRlZmluZWQpYW5PYmplY3QocmV0LmNhbGwoaXRlcmF0b3IpKTsKICAgIHRocm93IGU7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDkzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBJVEVSQVRPUiAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdpdGVyYXRvcicpCiAgLCBTQUZFX0NMT1NJTkcgPSBmYWxzZTsKCnRyeSB7CiAgdmFyIHJpdGVyID0gWzddW0lURVJBVE9SXSgpOwogIHJpdGVyWydyZXR1cm4nXSA9IGZ1bmN0aW9uKCl7IFNBRkVfQ0xPU0lORyA9IHRydWU7IH07CiAgQXJyYXkuZnJvbShyaXRlciwgZnVuY3Rpb24oKXsgdGhyb3cgMjsgfSk7Cn0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYywgc2tpcENsb3NpbmcpewogIGlmKCFza2lwQ2xvc2luZyAmJiAhU0FGRV9DTE9TSU5HKXJldHVybiBmYWxzZTsKICB2YXIgc2FmZSA9IGZhbHNlOwogIHRyeSB7CiAgICB2YXIgYXJyICA9IFs3XQogICAgICAsIGl0ZXIgPSBhcnJbSVRFUkFUT1JdKCk7CiAgICBpdGVyLm5leHQgPSBmdW5jdGlvbigpeyByZXR1cm4ge2RvbmU6IHNhZmUgPSB0cnVlfTsgfTsKICAgIGFycltJVEVSQVRPUl0gPSBmdW5jdGlvbigpeyByZXR1cm4gaXRlcjsgfTsKICAgIGV4ZWMoYXJyKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgcmV0dXJuIHNhZmU7Cn07CgovKioqLyB9KSwKLyogOTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdldEtleXMgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpCiAgLCB0b0lPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIGVsKXsKICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKICAgICwga2V5cyAgID0gZ2V0S2V5cyhPKQogICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAogICAgLCBpbmRleCAgPSAwCiAgICAsIGtleTsKICB3aGlsZShsZW5ndGggPiBpbmRleClpZihPW2tleSA9IGtleXNbaW5kZXgrK11dID09PSBlbClyZXR1cm4ga2V5Owp9OwoKLyoqKi8gfSksCi8qIDk1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBtYWNyb3Rhc2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KS5zZXQKICAsIE9ic2VydmVyICA9IGdsb2JhbC5NdXRhdGlvbk9ic2VydmVyIHx8IGdsb2JhbC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyCiAgLCBwcm9jZXNzICAgPSBnbG9iYWwucHJvY2VzcwogICwgUHJvbWlzZSAgID0gZ2xvYmFsLlByb21pc2UKICAsIGlzTm9kZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjApKHByb2Nlc3MpID09ICdwcm9jZXNzJzsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKXsKICB2YXIgaGVhZCwgbGFzdCwgbm90aWZ5OwoKICB2YXIgZmx1c2ggPSBmdW5jdGlvbigpewogICAgdmFyIHBhcmVudCwgZm47CiAgICBpZihpc05vZGUgJiYgKHBhcmVudCA9IHByb2Nlc3MuZG9tYWluKSlwYXJlbnQuZXhpdCgpOwogICAgd2hpbGUoaGVhZCl7CiAgICAgIGZuICAgPSBoZWFkLmZuOwogICAgICBoZWFkID0gaGVhZC5uZXh0OwogICAgICB0cnkgewogICAgICAgIGZuKCk7CiAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgaWYoaGVhZClub3RpZnkoKTsKICAgICAgICBlbHNlIGxhc3QgPSB1bmRlZmluZWQ7CiAgICAgICAgdGhyb3cgZTsKICAgICAgfQogICAgfSBsYXN0ID0gdW5kZWZpbmVkOwogICAgaWYocGFyZW50KXBhcmVudC5lbnRlcigpOwogIH07CgogIC8vIE5vZGUuanMKICBpZihpc05vZGUpewogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgcHJvY2Vzcy5uZXh0VGljayhmbHVzaCk7CiAgICB9OwogIC8vIGJyb3dzZXJzIHdpdGggTXV0YXRpb25PYnNlcnZlcgogIH0gZWxzZSBpZihPYnNlcnZlcil7CiAgICB2YXIgdG9nZ2xlID0gdHJ1ZQogICAgICAsIG5vZGUgICA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTsKICAgIG5ldyBPYnNlcnZlcihmbHVzaCkub2JzZXJ2ZShub2RlLCB7Y2hhcmFjdGVyRGF0YTogdHJ1ZX0pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldwogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgbm9kZS5kYXRhID0gdG9nZ2xlID0gIXRvZ2dsZTsKICAgIH07CiAgLy8gZW52aXJvbm1lbnRzIHdpdGggbWF5YmUgbm9uLWNvbXBsZXRlbHkgY29ycmVjdCwgYnV0IGV4aXN0ZW50IFByb21pc2UKICB9IGVsc2UgaWYoUHJvbWlzZSAmJiBQcm9taXNlLnJlc29sdmUpewogICAgdmFyIHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CiAgICAgIHByb21pc2UudGhlbihmbHVzaCk7CiAgICB9OwogIC8vIGZvciBvdGhlciBlbnZpcm9ubWVudHMgLSBtYWNyb3Rhc2sgYmFzZWQgb246CiAgLy8gLSBzZXRJbW1lZGlhdGUKICAvLyAtIE1lc3NhZ2VDaGFubmVsCiAgLy8gLSB3aW5kb3cucG9zdE1lc3NhZwogIC8vIC0gb25yZWFkeXN0YXRlY2hhbmdlCiAgLy8gLSBzZXRUaW1lb3V0CiAgfSBlbHNlIHsKICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CiAgICAgIC8vIHN0cmFuZ2UgSUUgKyB3ZWJwYWNrIGRldiBzZXJ2ZXIgYnVnIC0gdXNlIC5jYWxsKGdsb2JhbCkKICAgICAgbWFjcm90YXNrLmNhbGwoZ2xvYmFsLCBmbHVzaCk7CiAgICB9OwogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uKGZuKXsKICAgIHZhciB0YXNrID0ge2ZuOiBmbiwgbmV4dDogdW5kZWZpbmVkfTsKICAgIGlmKGxhc3QpbGFzdC5uZXh0ID0gdGFzazsKICAgIGlmKCFoZWFkKXsKICAgICAgaGVhZCA9IHRhc2s7CiAgICAgIG5vdGlmeSgpOwogICAgfSBsYXN0ID0gdGFzazsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDk2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbGxiYWNrIGZvciBJRTExIGJ1Z2d5IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHdpdGggaWZyYW1lIGFuZCB3aW5kb3cKdmFyIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCBnT1BOICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY1KS5mCiAgLCB0b1N0cmluZyAgPSB7fS50b1N0cmluZzsKCnZhciB3aW5kb3dOYW1lcyA9IHR5cGVvZiB3aW5kb3cgPT0gJ29iamVjdCcgJiYgd2luZG93ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzCiAgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW107Cgp2YXIgZ2V0V2luZG93TmFtZXMgPSBmdW5jdGlvbihpdCl7CiAgdHJ5IHsKICAgIHJldHVybiBnT1BOKGl0KTsKICB9IGNhdGNoKGUpewogICAgcmV0dXJuIHdpbmRvd05hbWVzLnNsaWNlKCk7CiAgfQp9OwoKbW9kdWxlLmV4cG9ydHMuZiA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpewogIHJldHVybiB3aW5kb3dOYW1lcyAmJiB0b1N0cmluZy5jYWxsKGl0KSA9PSAnW29iamVjdCBXaW5kb3ddJyA/IGdldFdpbmRvd05hbWVzKGl0KSA6IGdPUE4odG9JT2JqZWN0KGl0KSk7Cn07CgoKLyoqKi8gfSksCi8qIDk3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBoaWRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih0YXJnZXQsIHNyYywgc2FmZSl7CiAgZm9yKHZhciBrZXkgaW4gc3JjKXsKICAgIGlmKHNhZmUgJiYgdGFyZ2V0W2tleV0pdGFyZ2V0W2tleV0gPSBzcmNba2V5XTsKICAgIGVsc2UgaGlkZSh0YXJnZXQsIGtleSwgc3JjW2tleV0pOwogIH0gcmV0dXJuIHRhcmdldDsKfTsKCi8qKiovIH0pLAovKiA5OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBXb3JrcyB3aXRoIF9fcHJvdG9fXyBvbmx5LiBPbGQgdjggY2FuJ3Qgd29yayB3aXRoIG51bGwgcHJvdG8gb2JqZWN0cy4KLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi8KdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwp2YXIgY2hlY2sgPSBmdW5jdGlvbihPLCBwcm90byl7CiAgYW5PYmplY3QoTyk7CiAgaWYoIWlzT2JqZWN0KHByb3RvKSAmJiBwcm90byAhPT0gbnVsbCl0aHJvdyBUeXBlRXJyb3IocHJvdG8gKyAiOiBjYW4ndCBzZXQgYXMgcHJvdG90eXBlISIpOwp9Owptb2R1bGUuZXhwb3J0cyA9IHsKICBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoJ19fcHJvdG9fXycgaW4ge30gPyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCiAgICBmdW5jdGlvbih0ZXN0LCBidWdneSwgc2V0KXsKICAgICAgdHJ5IHsKICAgICAgICBzZXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KShGdW5jdGlvbi5jYWxsLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KS5mKE9iamVjdC5wcm90b3R5cGUsICdfX3Byb3RvX18nKS5zZXQsIDIpOwogICAgICAgIHNldCh0ZXN0LCBbXSk7CiAgICAgICAgYnVnZ3kgPSAhKHRlc3QgaW5zdGFuY2VvZiBBcnJheSk7CiAgICAgIH0gY2F0Y2goZSl7IGJ1Z2d5ID0gdHJ1ZTsgfQogICAgICByZXR1cm4gZnVuY3Rpb24gc2V0UHJvdG90eXBlT2YoTywgcHJvdG8pewogICAgICAgIGNoZWNrKE8sIHByb3RvKTsKICAgICAgICBpZihidWdneSlPLl9fcHJvdG9fXyA9IHByb3RvOwogICAgICAgIGVsc2Ugc2V0KE8sIHByb3RvKTsKICAgICAgICByZXR1cm4gTzsKICAgICAgfTsKICAgIH0oe30sIGZhbHNlKSA6IHVuZGVmaW5lZCksCiAgY2hlY2s6IGNoZWNrCn07CgovKioqLyB9KSwKLyogOTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIGdsb2JhbCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY29yZSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBkUCAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKICAsIERFU0NSSVBUT1JTID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKQogICwgU1BFQ0lFUyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdzcGVjaWVzJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEtFWSl7CiAgdmFyIEMgPSB0eXBlb2YgY29yZVtLRVldID09ICdmdW5jdGlvbicgPyBjb3JlW0tFWV0gOiBnbG9iYWxbS0VZXTsKICBpZihERVNDUklQVE9SUyAmJiBDICYmICFDW1NQRUNJRVNdKWRQLmYoQywgU1BFQ0lFUywgewogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfQogIH0pOwp9OwoKLyoqKi8gfSksCi8qIDEwMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjMuMjAgU3BlY2llc0NvbnN0cnVjdG9yKE8sIGRlZmF1bHRDb25zdHJ1Y3RvcikKdmFyIGFuT2JqZWN0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIGFGdW5jdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpCiAgLCBTUEVDSUVTICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdzcGVjaWVzJyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oTywgRCl7CiAgdmFyIEMgPSBhbk9iamVjdChPKS5jb25zdHJ1Y3RvciwgUzsKICByZXR1cm4gQyA9PT0gdW5kZWZpbmVkIHx8IChTID0gYW5PYmplY3QoQylbU1BFQ0lFU10pID09IHVuZGVmaW5lZCA/IEQgOiBhRnVuY3Rpb24oUyk7Cn07CgovKioqLyB9KSwKLyogMTAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KQovLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKJGV4cG9ydCgkZXhwb3J0LlMsICdPYmplY3QnLCB7Y3JlYXRlOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDM3KX0pOwoKLyoqKi8gfSksCi8qIDEwMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuOSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTykKdmFyIHRvT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCAkZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQzKTsKCl9fd2VicGFja19yZXF1aXJlX18oNDUpKCdnZXRQcm90b3R5cGVPZicsIGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGZ1bmN0aW9uIGdldFByb3RvdHlwZU9mKGl0KXsKICAgIHJldHVybiAkZ2V0UHJvdG90eXBlT2YodG9PYmplY3QoaXQpKTsKICB9Owp9KTsKCi8qKiovIH0pLAovKiAxMDMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjE0IE9iamVjdC5rZXlzKE8pCnZhciB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCAka2V5cyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpOwoKX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2tleXMnLCBmdW5jdGlvbigpewogIHJldHVybiBmdW5jdGlvbiBrZXlzKGl0KXsKICAgIHJldHVybiAka2V5cyh0b09iamVjdChpdCkpOwogIH07Cn0pOwoKLyoqKi8gfSksCi8qIDEwNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjMuMTkgT2JqZWN0LnNldFByb3RvdHlwZU9mKE8sIHByb3RvKQp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7CiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0Jywge3NldFByb3RvdHlwZU9mOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDk4KS5zZXR9KTsKCi8qKiovIH0pLAovKiAxMDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIExJQlJBUlkgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpCiAgLCBnbG9iYWwgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjdHggICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgY2xhc3NvZiAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NSkKICAsICRleHBvcnQgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOSkKICAsIGlzT2JqZWN0ICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKICAsIGFGdW5jdGlvbiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpCiAgLCBhbkluc3RhbmNlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg2KQogICwgZm9yT2YgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4OCkKICAsIHNwZWNpZXNDb25zdHJ1Y3RvciA9IF9fd2VicGFja19yZXF1aXJlX18oMTAwKQogICwgdGFzayAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Nykuc2V0CiAgLCBtaWNyb3Rhc2sgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk1KSgpCiAgLCBQUk9NSVNFICAgICAgICAgICAgPSAnUHJvbWlzZScKICAsIFR5cGVFcnJvciAgICAgICAgICA9IGdsb2JhbC5UeXBlRXJyb3IKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCAkUHJvbWlzZSAgICAgICAgICAgPSBnbG9iYWxbUFJPTUlTRV0KICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBpc05vZGUgICAgICAgICAgICAgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJwogICwgZW1wdHkgICAgICAgICAgICAgID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfQogICwgSW50ZXJuYWwsIEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSwgV3JhcHBlcjsKCnZhciBVU0VfTkFUSVZFID0gISFmdW5jdGlvbigpewogIHRyeSB7CiAgICAvLyBjb3JyZWN0IHN1YmNsYXNzaW5nIHdpdGggQEBzcGVjaWVzIHN1cHBvcnQKICAgIHZhciBwcm9taXNlICAgICA9ICRQcm9taXNlLnJlc29sdmUoMSkKICAgICAgLCBGYWtlUHJvbWlzZSA9IChwcm9taXNlLmNvbnN0cnVjdG9yID0ge30pW19fd2VicGFja19yZXF1aXJlX18oMykoJ3NwZWNpZXMnKV0gPSBmdW5jdGlvbihleGVjKXsgZXhlYyhlbXB0eSwgZW1wdHkpOyB9OwogICAgLy8gdW5oYW5kbGVkIHJlamVjdGlvbnMgdHJhY2tpbmcgc3VwcG9ydCwgTm9kZUpTIFByb21pc2Ugd2l0aG91dCBpdCBmYWlscyBAQHNwZWNpZXMgdGVzdAogICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKSAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2U7CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9KCk7CgovLyBoZWxwZXJzCnZhciBzYW1lQ29uc3RydWN0b3IgPSBmdW5jdGlvbihhLCBiKXsKICAvLyB3aXRoIGxpYnJhcnkgd3JhcHBlciBzcGVjaWFsIGNhc2UKICByZXR1cm4gYSA9PT0gYiB8fCBhID09PSAkUHJvbWlzZSAmJiBiID09PSBXcmFwcGVyOwp9Owp2YXIgaXNUaGVuYWJsZSA9IGZ1bmN0aW9uKGl0KXsKICB2YXIgdGhlbjsKICByZXR1cm4gaXNPYmplY3QoaXQpICYmIHR5cGVvZiAodGhlbiA9IGl0LnRoZW4pID09ICdmdW5jdGlvbicgPyB0aGVuIDogZmFsc2U7Cn07CnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewogIHJldHVybiBzYW1lQ29uc3RydWN0b3IoJFByb21pc2UsIEMpCiAgICA/IG5ldyBQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgOiBuZXcgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5KEMpOwp9Owp2YXIgUHJvbWlzZUNhcGFiaWxpdHkgPSBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbihDKXsKICB2YXIgcmVzb2x2ZSwgcmVqZWN0OwogIHRoaXMucHJvbWlzZSA9IG5ldyBDKGZ1bmN0aW9uKCQkcmVzb2x2ZSwgJCRyZWplY3QpewogICAgaWYocmVzb2x2ZSAhPT0gdW5kZWZpbmVkIHx8IHJlamVjdCAhPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcignQmFkIFByb21pc2UgY29uc3RydWN0b3InKTsKICAgIHJlc29sdmUgPSAkJHJlc29sdmU7CiAgICByZWplY3QgID0gJCRyZWplY3Q7CiAgfSk7CiAgdGhpcy5yZXNvbHZlID0gYUZ1bmN0aW9uKHJlc29sdmUpOwogIHRoaXMucmVqZWN0ICA9IGFGdW5jdGlvbihyZWplY3QpOwp9Owp2YXIgcGVyZm9ybSA9IGZ1bmN0aW9uKGV4ZWMpewogIHRyeSB7CiAgICBleGVjKCk7CiAgfSBjYXRjaChlKXsKICAgIHJldHVybiB7ZXJyb3I6IGV9OwogIH0KfTsKdmFyIG5vdGlmeSA9IGZ1bmN0aW9uKHByb21pc2UsIGlzUmVqZWN0KXsKICBpZihwcm9taXNlLl9uKXJldHVybjsKICBwcm9taXNlLl9uID0gdHJ1ZTsKICB2YXIgY2hhaW4gPSBwcm9taXNlLl9jOwogIG1pY3JvdGFzayhmdW5jdGlvbigpewogICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgogICAgICAsIG9rICAgID0gcHJvbWlzZS5fcyA9PSAxCiAgICAgICwgaSAgICAgPSAwOwogICAgdmFyIHJ1biA9IGZ1bmN0aW9uKHJlYWN0aW9uKXsKICAgICAgdmFyIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbAogICAgICAgICwgcmVzb2x2ZSA9IHJlYWN0aW9uLnJlc29sdmUKICAgICAgICAsIHJlamVjdCAgPSByZWFjdGlvbi5yZWplY3QKICAgICAgICAsIGRvbWFpbiAgPSByZWFjdGlvbi5kb21haW4KICAgICAgICAsIHJlc3VsdCwgdGhlbjsKICAgICAgdHJ5IHsKICAgICAgICBpZihoYW5kbGVyKXsKICAgICAgICAgIGlmKCFvayl7CiAgICAgICAgICAgIGlmKHByb21pc2UuX2ggPT0gMilvbkhhbmRsZVVuaGFuZGxlZChwcm9taXNlKTsKICAgICAgICAgICAgcHJvbWlzZS5faCA9IDE7CiAgICAgICAgICB9CiAgICAgICAgICBpZihoYW5kbGVyID09PSB0cnVlKXJlc3VsdCA9IHZhbHVlOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZW50ZXIoKTsKICAgICAgICAgICAgcmVzdWx0ID0gaGFuZGxlcih2YWx1ZSk7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZXhpdCgpOwogICAgICAgICAgfQogICAgICAgICAgaWYocmVzdWx0ID09PSByZWFjdGlvbi5wcm9taXNlKXsKICAgICAgICAgICAgcmVqZWN0KFR5cGVFcnJvcignUHJvbWlzZS1jaGFpbiBjeWNsZScpKTsKICAgICAgICAgIH0gZWxzZSBpZih0aGVuID0gaXNUaGVuYWJsZShyZXN1bHQpKXsKICAgICAgICAgICAgdGhlbi5jYWxsKHJlc3VsdCwgcmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgICAgIH0gZWxzZSByZXNvbHZlKHJlc3VsdCk7CiAgICAgICAgfSBlbHNlIHJlamVjdCh2YWx1ZSk7CiAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgcmVqZWN0KGUpOwogICAgICB9CiAgICB9OwogICAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSlydW4oY2hhaW5baSsrXSk7IC8vIHZhcmlhYmxlIGxlbmd0aCAtIGNhbid0IHVzZSBmb3JFYWNoCiAgICBwcm9taXNlLl9jID0gW107CiAgICBwcm9taXNlLl9uID0gZmFsc2U7CiAgICBpZihpc1JlamVjdCAmJiAhcHJvbWlzZS5faClvblVuaGFuZGxlZChwcm9taXNlKTsKICB9KTsKfTsKdmFyIG9uVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YKICAgICAgLCBhYnJ1cHQsIGhhbmRsZXIsIGNvbnNvbGU7CiAgICBpZihpc1VuaGFuZGxlZChwcm9taXNlKSl7CiAgICAgIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgICBpZihpc05vZGUpewogICAgICAgICAgcHJvY2Vzcy5lbWl0KCd1bmhhbmRsZWRSZWplY3Rpb24nLCB2YWx1ZSwgcHJvbWlzZSk7CiAgICAgICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub251bmhhbmRsZWRyZWplY3Rpb24pewogICAgICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiB2YWx1ZX0pOwogICAgICAgIH0gZWxzZSBpZigoY29uc29sZSA9IGdsb2JhbC5jb25zb2xlKSAmJiBjb25zb2xlLmVycm9yKXsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbicsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBCcm93c2VycyBzaG91bGQgbm90IHRyaWdnZXIgYHJlamVjdGlvbkhhbmRsZWRgIGV2ZW50IGlmIGl0IHdhcyBoYW5kbGVkIGhlcmUsIE5vZGVKUyAtIHNob3VsZAogICAgICBwcm9taXNlLl9oID0gaXNOb2RlIHx8IGlzVW5oYW5kbGVkKHByb21pc2UpID8gMiA6IDE7CiAgICB9IHByb21pc2UuX2EgPSB1bmRlZmluZWQ7CiAgICBpZihhYnJ1cHQpdGhyb3cgYWJydXB0LmVycm9yOwogIH0pOwp9Owp2YXIgaXNVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKICBpZihwcm9taXNlLl9oID09IDEpcmV0dXJuIGZhbHNlOwogIHZhciBjaGFpbiA9IHByb21pc2UuX2EgfHwgcHJvbWlzZS5fYwogICAgLCBpICAgICA9IDAKICAgICwgcmVhY3Rpb247CiAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSl7CiAgICByZWFjdGlvbiA9IGNoYWluW2krK107CiAgICBpZihyZWFjdGlvbi5mYWlsIHx8ICFpc1VuaGFuZGxlZChyZWFjdGlvbi5wcm9taXNlKSlyZXR1cm4gZmFsc2U7CiAgfSByZXR1cm4gdHJ1ZTsKfTsKdmFyIG9uSGFuZGxlVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciBoYW5kbGVyOwogICAgaWYoaXNOb2RlKXsKICAgICAgcHJvY2Vzcy5lbWl0KCdyZWplY3Rpb25IYW5kbGVkJywgcHJvbWlzZSk7CiAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnJlamVjdGlvbmhhbmRsZWQpewogICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHByb21pc2UuX3Z9KTsKICAgIH0KICB9KTsKfTsKdmFyICRyZWplY3QgPSBmdW5jdGlvbih2YWx1ZSl7CiAgdmFyIHByb21pc2UgPSB0aGlzOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHByb21pc2UuX3YgPSB2YWx1ZTsKICBwcm9taXNlLl9zID0gMjsKICBpZighcHJvbWlzZS5fYSlwcm9taXNlLl9hID0gcHJvbWlzZS5fYy5zbGljZSgpOwogIG5vdGlmeShwcm9taXNlLCB0cnVlKTsKfTsKdmFyICRyZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpewogIHZhciBwcm9taXNlID0gdGhpcwogICAgLCB0aGVuOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHRyeSB7CiAgICBpZihwcm9taXNlID09PSB2YWx1ZSl0aHJvdyBUeXBlRXJyb3IoIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmIik7CiAgICBpZih0aGVuID0gaXNUaGVuYWJsZSh2YWx1ZSkpewogICAgICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKICAgICAgICB2YXIgd3JhcHBlciA9IHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfTsgLy8gd3JhcAogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGVuLmNhbGwodmFsdWUsIGN0eCgkcmVzb2x2ZSwgd3JhcHBlciwgMSksIGN0eCgkcmVqZWN0LCB3cmFwcGVyLCAxKSk7CiAgICAgICAgfSBjYXRjaChlKXsKICAgICAgICAgICRyZWplY3QuY2FsbCh3cmFwcGVyLCBlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgcHJvbWlzZS5fdiA9IHZhbHVlOwogICAgICBwcm9taXNlLl9zID0gMTsKICAgICAgbm90aWZ5KHByb21pc2UsIGZhbHNlKTsKICAgIH0KICB9IGNhdGNoKGUpewogICAgJHJlamVjdC5jYWxsKHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfSwgZSk7IC8vIHdyYXAKICB9Cn07CgovLyBjb25zdHJ1Y3RvciBwb2x5ZmlsbAppZighVVNFX05BVElWRSl7CiAgLy8gMjUuNC4zLjEgUHJvbWlzZShleGVjdXRvcikKICAkUHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpewogICAgYW5JbnN0YW5jZSh0aGlzLCAkUHJvbWlzZSwgUFJPTUlTRSwgJ19oJyk7CiAgICBhRnVuY3Rpb24oZXhlY3V0b3IpOwogICAgSW50ZXJuYWwuY2FsbCh0aGlzKTsKICAgIHRyeSB7CiAgICAgIGV4ZWN1dG9yKGN0eCgkcmVzb2x2ZSwgdGhpcywgMSksIGN0eCgkcmVqZWN0LCB0aGlzLCAxKSk7CiAgICB9IGNhdGNoKGVycil7CiAgICAgICRyZWplY3QuY2FsbCh0aGlzLCBlcnIpOwogICAgfQogIH07CiAgSW50ZXJuYWwgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKICAgIHRoaXMuX2MgPSBbXTsgICAgICAgICAgICAgLy8gPC0gYXdhaXRpbmcgcmVhY3Rpb25zCiAgICB0aGlzLl9hID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIGNoZWNrZWQgaW4gaXNVbmhhbmRsZWQgcmVhY3Rpb25zCiAgICB0aGlzLl9zID0gMDsgICAgICAgICAgICAgIC8vIDwtIHN0YXRlCiAgICB0aGlzLl9kID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIGRvbmUKICAgIHRoaXMuX3YgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gdmFsdWUKICAgIHRoaXMuX2ggPSAwOyAgICAgICAgICAgICAgLy8gPC0gcmVqZWN0aW9uIHN0YXRlLCAwIC0gZGVmYXVsdCwgMSAtIGhhbmRsZWQsIDIgLSB1bmhhbmRsZWQKICAgIHRoaXMuX24gPSBmYWxzZTsgICAgICAgICAgLy8gPC0gbm90aWZ5CiAgfTsKICBJbnRlcm5hbC5wcm90b3R5cGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk3KSgkUHJvbWlzZS5wcm90b3R5cGUsIHsKICAgIC8vIDI1LjQuNS4zIFByb21pc2UucHJvdG90eXBlLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpCiAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKXsKICAgICAgdmFyIHJlYWN0aW9uICAgID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsICRQcm9taXNlKSk7CiAgICAgIHJlYWN0aW9uLm9rICAgICA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PSAnZnVuY3Rpb24nID8gb25GdWxmaWxsZWQgOiB0cnVlOwogICAgICByZWFjdGlvbi5mYWlsICAgPSB0eXBlb2Ygb25SZWplY3RlZCA9PSAnZnVuY3Rpb24nICYmIG9uUmVqZWN0ZWQ7CiAgICAgIHJlYWN0aW9uLmRvbWFpbiA9IGlzTm9kZSA/IHByb2Nlc3MuZG9tYWluIDogdW5kZWZpbmVkOwogICAgICB0aGlzLl9jLnB1c2gocmVhY3Rpb24pOwogICAgICBpZih0aGlzLl9hKXRoaXMuX2EucHVzaChyZWFjdGlvbik7CiAgICAgIGlmKHRoaXMuX3Mpbm90aWZ5KHRoaXMsIGZhbHNlKTsKICAgICAgcmV0dXJuIHJlYWN0aW9uLnByb21pc2U7CiAgICB9LAogICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2gob25SZWplY3RlZCkKICAgICdjYXRjaCc6IGZ1bmN0aW9uKG9uUmVqZWN0ZWQpewogICAgICByZXR1cm4gdGhpcy50aGVuKHVuZGVmaW5lZCwgb25SZWplY3RlZCk7CiAgICB9CiAgfSk7CiAgUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbigpewogICAgdmFyIHByb21pc2UgID0gbmV3IEludGVybmFsOwogICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTsKICAgIHRoaXMucmVzb2x2ZSA9IGN0eCgkcmVzb2x2ZSwgcHJvbWlzZSwgMSk7CiAgICB0aGlzLnJlamVjdCAgPSBjdHgoJHJlamVjdCwgcHJvbWlzZSwgMSk7CiAgfTsKfQoKJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1Byb21pc2U6ICRQcm9taXNlfSk7Cl9fd2VicGFja19yZXF1aXJlX18oMjIpKCRQcm9taXNlLCBQUk9NSVNFKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg5OSkoUFJPTUlTRSk7CldyYXBwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApW1BST01JU0VdOwoKLy8gc3RhdGljcwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCBQUk9NSVNFLCB7CiAgLy8gMjUuNC40LjUgUHJvbWlzZS5yZWplY3QocikKICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyKXsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlamVjdCAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgICAkJHJlamVjdChyKTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQp9KTsKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoTElCUkFSWSB8fCAhVVNFX05BVElWRSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuNiBQcm9taXNlLnJlc29sdmUoeCkKICByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKHgpewogICAgLy8gaW5zdGFuY2VvZiBpbnN0ZWFkIG9mIGludGVybmFsIHNsb3QgY2hlY2sgYmVjYXVzZSB3ZSBzaG91bGQgZml4IGl0IHdpdGhvdXQgcmVwbGFjZW1lbnQgbmF0aXZlIFByb21pc2UgY29yZQogICAgaWYoeCBpbnN0YW5jZW9mICRQcm9taXNlICYmIHNhbWVDb25zdHJ1Y3Rvcih4LmNvbnN0cnVjdG9yLCB0aGlzKSlyZXR1cm4geDsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlc29sdmUgID0gY2FwYWJpbGl0eS5yZXNvbHZlOwogICAgJCRyZXNvbHZlKHgpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoVVNFX05BVElWRSAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fKDkzKShmdW5jdGlvbihpdGVyKXsKICAkUHJvbWlzZS5hbGwoaXRlcilbJ2NhdGNoJ10oZW1wdHkpOwp9KSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuMSBQcm9taXNlLmFsbChpdGVyYWJsZSkKICBhbGw6IGZ1bmN0aW9uIGFsbChpdGVyYWJsZSl7CiAgICB2YXIgQyAgICAgICAgICA9IHRoaXMKICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKICAgICAgLCByZXNvbHZlICAgID0gY2FwYWJpbGl0eS5yZXNvbHZlCiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwogICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgdmFyIHZhbHVlcyAgICA9IFtdCiAgICAgICAgLCBpbmRleCAgICAgPSAwCiAgICAgICAgLCByZW1haW5pbmcgPSAxOwogICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2UpewogICAgICAgIHZhciAkaW5kZXggICAgICAgID0gaW5kZXgrKwogICAgICAgICAgLCBhbHJlYWR5Q2FsbGVkID0gZmFsc2U7CiAgICAgICAgdmFsdWVzLnB1c2godW5kZWZpbmVkKTsKICAgICAgICByZW1haW5pbmcrKzsKICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgICBpZihhbHJlYWR5Q2FsbGVkKXJldHVybjsKICAgICAgICAgIGFscmVhZHlDYWxsZWQgID0gdHJ1ZTsKICAgICAgICAgIHZhbHVlc1skaW5kZXhdID0gdmFsdWU7CiAgICAgICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgfSk7CiAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9LAogIC8vIDI1LjQuNC40IFByb21pc2UucmFjZShpdGVyYWJsZSkKICByYWNlOiBmdW5jdGlvbiByYWNlKGl0ZXJhYmxlKXsKICAgIHZhciBDICAgICAgICAgID0gdGhpcwogICAgICAsIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgICAsIHJlamVjdCAgICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oY2FwYWJpbGl0eS5yZXNvbHZlLCByZWplY3QpOwogICAgICB9KTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwoKLyoqKi8gfSksCi8qIDEwNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyBFQ01BU2NyaXB0IDYgc3ltYm9scyBzaGltCnZhciBnbG9iYWwgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIERFU0NSSVBUT1JTICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBNRVRBICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNzMpLktFWQogICwgJGZhaWxzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKQogICwgc2hhcmVkICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKQogICwgdWlkICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKQogICwgd2tzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpCiAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCiAgLCB3a3NEZWZpbmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDgpCiAgLCBrZXlPZiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTQpCiAgLCBlbnVtS2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODcpCiAgLCBpc0FycmF5ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTEpCiAgLCBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsIF9jcmVhdGUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNykKICAsIGdPUE5FeHQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NikKICAsICRHT1BEICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NykKICAsICREUCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgJGtleXMgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KQogICwgZ09QRCAgICAgICAgICAgPSAkR09QRC5mCiAgLCBkUCAgICAgICAgICAgICA9ICREUC5mCiAgLCBnT1BOICAgICAgICAgICA9IGdPUE5FeHQuZgogICwgJFN5bWJvbCAgICAgICAgPSBnbG9iYWwuU3ltYm9sCiAgLCAkSlNPTiAgICAgICAgICA9IGdsb2JhbC5KU09OCiAgLCBfc3RyaW5naWZ5ICAgICA9ICRKU09OICYmICRKU09OLnN0cmluZ2lmeQogICwgUFJPVE9UWVBFICAgICAgPSAncHJvdG90eXBlJwogICwgSElEREVOICAgICAgICAgPSB3a3MoJ19oaWRkZW4nKQogICwgVE9fUFJJTUlUSVZFICAgPSB3a3MoJ3RvUHJpbWl0aXZlJykKICAsIGlzRW51bSAgICAgICAgID0ge30ucHJvcGVydHlJc0VudW1lcmFibGUKICAsIFN5bWJvbFJlZ2lzdHJ5ID0gc2hhcmVkKCdzeW1ib2wtcmVnaXN0cnknKQogICwgQWxsU3ltYm9scyAgICAgPSBzaGFyZWQoJ3N5bWJvbHMnKQogICwgT1BTeW1ib2xzICAgICAgPSBzaGFyZWQoJ29wLXN5bWJvbHMnKQogICwgT2JqZWN0UHJvdG8gICAgPSBPYmplY3RbUFJPVE9UWVBFXQogICwgVVNFX05BVElWRSAgICAgPSB0eXBlb2YgJFN5bWJvbCA9PSAnZnVuY3Rpb24nCiAgLCBRT2JqZWN0ICAgICAgICA9IGdsb2JhbC5RT2JqZWN0OwovLyBEb24ndCB1c2Ugc2V0dGVycyBpbiBRdCBTY3JpcHQsIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8xNzMKdmFyIHNldHRlciA9ICFRT2JqZWN0IHx8ICFRT2JqZWN0W1BST1RPVFlQRV0gfHwgIVFPYmplY3RbUFJPVE9UWVBFXS5maW5kQ2hpbGQ7CgovLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODcKdmFyIHNldFN5bWJvbERlc2MgPSBERVNDUklQVE9SUyAmJiAkZmFpbHMoZnVuY3Rpb24oKXsKICByZXR1cm4gX2NyZWF0ZShkUCh7fSwgJ2EnLCB7CiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBkUCh0aGlzLCAnYScsIHt2YWx1ZTogN30pLmE7IH0KICB9KSkuYSAhPSA3Owp9KSA/IGZ1bmN0aW9uKGl0LCBrZXksIEQpewogIHZhciBwcm90b0Rlc2MgPSBnT1BEKE9iamVjdFByb3RvLCBrZXkpOwogIGlmKHByb3RvRGVzYylkZWxldGUgT2JqZWN0UHJvdG9ba2V5XTsKICBkUChpdCwga2V5LCBEKTsKICBpZihwcm90b0Rlc2MgJiYgaXQgIT09IE9iamVjdFByb3RvKWRQKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7Cn0gOiBkUDsKCnZhciB3cmFwID0gZnVuY3Rpb24odGFnKXsKICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pOwogIHN5bS5fayA9IHRhZzsKICByZXR1cm4gc3ltOwp9OwoKdmFyIGlzU3ltYm9sID0gVVNFX05BVElWRSAmJiB0eXBlb2YgJFN5bWJvbC5pdGVyYXRvciA9PSAnc3ltYm9sJyA/IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnOwp9IDogZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCBpbnN0YW5jZW9mICRTeW1ib2w7Cn07Cgp2YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCl7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvKSRkZWZpbmVQcm9wZXJ0eShPUFN5bWJvbHMsIGtleSwgRCk7CiAgYW5PYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgYW5PYmplY3QoRCk7CiAgaWYoaGFzKEFsbFN5bWJvbHMsIGtleSkpewogICAgaWYoIUQuZW51bWVyYWJsZSl7CiAgICAgIGlmKCFoYXMoaXQsIEhJRERFTikpZFAoaXQsIEhJRERFTiwgY3JlYXRlRGVzYygxLCB7fSkpOwogICAgICBpdFtISURERU5dW2tleV0gPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgaWYoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSlpdFtISURERU5dW2tleV0gPSBmYWxzZTsKICAgICAgRCA9IF9jcmVhdGUoRCwge2VudW1lcmFibGU6IGNyZWF0ZURlc2MoMCwgZmFsc2UpfSk7CiAgICB9IHJldHVybiBzZXRTeW1ib2xEZXNjKGl0LCBrZXksIEQpOwogIH0gcmV0dXJuIGRQKGl0LCBrZXksIEQpOwp9Owp2YXIgJGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKGl0LCBQKXsKICBhbk9iamVjdChpdCk7CiAgdmFyIGtleXMgPSBlbnVtS2V5cyhQID0gdG9JT2JqZWN0KFApKQogICAgLCBpICAgID0gMAogICAgLCBsID0ga2V5cy5sZW5ndGgKICAgICwga2V5OwogIHdoaWxlKGwgPiBpKSRkZWZpbmVQcm9wZXJ0eShpdCwga2V5ID0ga2V5c1tpKytdLCBQW2tleV0pOwogIHJldHVybiBpdDsKfTsKdmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaXQsIFApewogIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfY3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9jcmVhdGUoaXQpLCBQKTsKfTsKdmFyICRwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IGZ1bmN0aW9uIHByb3BlcnR5SXNFbnVtZXJhYmxlKGtleSl7CiAgdmFyIEUgPSBpc0VudW0uY2FsbCh0aGlzLCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKTsKICBpZih0aGlzID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSlyZXR1cm4gZmFsc2U7CiAgcmV0dXJuIEUgfHwgIWhhcyh0aGlzLCBrZXkpIHx8ICFoYXMoQWxsU3ltYm9scywga2V5KSB8fCBoYXModGhpcywgSElEREVOKSAmJiB0aGlzW0hJRERFTl1ba2V5XSA/IEUgOiB0cnVlOwp9Owp2YXIgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICBpdCAgPSB0b0lPYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKXJldHVybjsKICB2YXIgRCA9IGdPUEQoaXQsIGtleSk7CiAgaWYoRCAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKUQuZW51bWVyYWJsZSA9IHRydWU7CiAgcmV0dXJuIEQ7Cn07CnZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpewogIHZhciBuYW1lcyAgPSBnT1BOKHRvSU9iamVjdChpdCkpCiAgICAsIHJlc3VsdCA9IFtdCiAgICAsIGkgICAgICA9IDAKICAgICwga2V5OwogIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewogICAgaWYoIWhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiBrZXkgIT0gSElEREVOICYmIGtleSAhPSBNRVRBKXJlc3VsdC5wdXNoKGtleSk7CiAgfSByZXR1cm4gcmVzdWx0Owp9Owp2YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCl7CiAgdmFyIElTX09QICA9IGl0ID09PSBPYmplY3RQcm90bwogICAgLCBuYW1lcyAgPSBnT1BOKElTX09QID8gT1BTeW1ib2xzIDogdG9JT2JqZWN0KGl0KSkKICAgICwgcmVzdWx0ID0gW10KICAgICwgaSAgICAgID0gMAogICAgLCBrZXk7CiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7CiAgICBpZihoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYgKElTX09QID8gaGFzKE9iamVjdFByb3RvLCBrZXkpIDogdHJ1ZSkpcmVzdWx0LnB1c2goQWxsU3ltYm9sc1trZXldKTsKICB9IHJldHVybiByZXN1bHQ7Cn07CgovLyAxOS40LjEuMSBTeW1ib2woW2Rlc2NyaXB0aW9uXSkKaWYoIVVTRV9OQVRJVkUpewogICRTeW1ib2wgPSBmdW5jdGlvbiBTeW1ib2woKXsKICAgIGlmKHRoaXMgaW5zdGFuY2VvZiAkU3ltYm9sKXRocm93IFR5cGVFcnJvcignU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIScpOwogICAgdmFyIHRhZyA9IHVpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7CiAgICB2YXIgJHNldCA9IGZ1bmN0aW9uKHZhbHVlKXsKICAgICAgaWYodGhpcyA9PT0gT2JqZWN0UHJvdG8pJHNldC5jYWxsKE9QU3ltYm9scywgdmFsdWUpOwogICAgICBpZihoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKXRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7CiAgICAgIHNldFN5bWJvbERlc2ModGhpcywgdGFnLCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7CiAgICB9OwogICAgaWYoREVTQ1JJUFRPUlMgJiYgc2V0dGVyKXNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0fSk7CiAgICByZXR1cm4gd3JhcCh0YWcpOwogIH07CiAgcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEVdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpewogICAgcmV0dXJuIHRoaXMuX2s7CiAgfSk7CgogICRHT1BELmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwogICREUC5mICAgPSAkZGVmaW5lUHJvcGVydHk7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg2NSkuZiA9IGdPUE5FeHQuZiA9ICRnZXRPd25Qcm9wZXJ0eU5hbWVzOwogIF9fd2VicGFja19yZXF1aXJlX18oNDEpLmYgID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlOwogIF9fd2VicGFja19yZXF1aXJlX18oNTgpLmYgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKICBpZihERVNDUklQVE9SUyAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygyNikpewogICAgcmVkZWZpbmUoT2JqZWN0UHJvdG8sICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsICRwcm9wZXJ0eUlzRW51bWVyYWJsZSwgdHJ1ZSk7CiAgfQoKICB3a3NFeHQuZiA9IGZ1bmN0aW9uKG5hbWUpewogICAgcmV0dXJuIHdyYXAod2tzKG5hbWUpKTsKICB9Cn0KCiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtTeW1ib2w6ICRTeW1ib2x9KTsKCmZvcih2YXIgc3ltYm9scyA9ICgKICAvLyAxOS40LjIuMiwgMTkuNC4yLjMsIDE5LjQuMi40LCAxOS40LjIuNiwgMTkuNC4yLjgsIDE5LjQuMi45LCAxOS40LjIuMTAsIDE5LjQuMi4xMSwgMTkuNC4yLjEyLCAxOS40LjIuMTMsIDE5LjQuMi4xNAogICdoYXNJbnN0YW5jZSxpc0NvbmNhdFNwcmVhZGFibGUsaXRlcmF0b3IsbWF0Y2gscmVwbGFjZSxzZWFyY2gsc3BlY2llcyxzcGxpdCx0b1ByaW1pdGl2ZSx0b1N0cmluZ1RhZyx1bnNjb3BhYmxlcycKKS5zcGxpdCgnLCcpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzKHN5bWJvbHNbaSsrXSk7Cgpmb3IodmFyIHN5bWJvbHMgPSAka2V5cyh3a3Muc3RvcmUpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzRGVmaW5lKHN5bWJvbHNbaSsrXSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywgewogIC8vIDE5LjQuMi4xIFN5bWJvbC5mb3Ioa2V5KQogICdmb3InOiBmdW5jdGlvbihrZXkpewogICAgcmV0dXJuIGhhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKQogICAgICA/IFN5bWJvbFJlZ2lzdHJ5W2tleV0KICAgICAgOiBTeW1ib2xSZWdpc3RyeVtrZXldID0gJFN5bWJvbChrZXkpOwogIH0sCiAgLy8gMTkuNC4yLjUgU3ltYm9sLmtleUZvcihzeW0pCiAga2V5Rm9yOiBmdW5jdGlvbiBrZXlGb3Ioa2V5KXsKICAgIGlmKGlzU3ltYm9sKGtleSkpcmV0dXJuIGtleU9mKFN5bWJvbFJlZ2lzdHJ5LCBrZXkpOwogICAgdGhyb3cgVHlwZUVycm9yKGtleSArICcgaXMgbm90IGEgc3ltYm9sIScpOwogIH0sCiAgdXNlU2V0dGVyOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSB0cnVlOyB9LAogIHVzZVNpbXBsZTogZnVuY3Rpb24oKXsgc2V0dGVyID0gZmFsc2U7IH0KfSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnT2JqZWN0JywgewogIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKICBjcmVhdGU6ICRjcmVhdGUsCiAgLy8gMTkuMS4yLjQgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCiAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSwKICAvLyAxOS4xLjIuMyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKQogIGRlZmluZVByb3BlcnRpZXM6ICRkZWZpbmVQcm9wZXJ0aWVzLAogIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkKICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsCiAgLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcywKICAvLyAxOS4xLjIuOCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKE8pCiAgZ2V0T3duUHJvcGVydHlTeW1ib2xzOiAkZ2V0T3duUHJvcGVydHlTeW1ib2xzCn0pOwoKLy8gMjQuMy4yIEpTT04uc3RyaW5naWZ5KHZhbHVlIFssIHJlcGxhY2VyIFssIHNwYWNlXV0pCiRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbigpewogIHZhciBTID0gJFN5bWJvbCgpOwogIC8vIE1TIEVkZ2UgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIHt9CiAgLy8gV2ViS2l0IGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyBudWxsCiAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHMKICByZXR1cm4gX3N0cmluZ2lmeShbU10pICE9ICdbbnVsbF0nIHx8IF9zdHJpbmdpZnkoe2E6IFN9KSAhPSAne30nIHx8IF9zdHJpbmdpZnkoT2JqZWN0KFMpKSAhPSAne30nOwp9KSksICdKU09OJywgewogIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXsKICAgIGlmKGl0ID09PSB1bmRlZmluZWQgfHwgaXNTeW1ib2woaXQpKXJldHVybjsgLy8gSUU4IHJldHVybnMgc3RyaW5nIG9uIHVuZGVmaW5lZAogICAgdmFyIGFyZ3MgPSBbaXRdCiAgICAgICwgaSAgICA9IDEKICAgICAgLCByZXBsYWNlciwgJHJlcGxhY2VyOwogICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKICAgIHJlcGxhY2VyID0gYXJnc1sxXTsKICAgIGlmKHR5cGVvZiByZXBsYWNlciA9PSAnZnVuY3Rpb24nKSRyZXBsYWNlciA9IHJlcGxhY2VyOwogICAgaWYoJHJlcGxhY2VyIHx8ICFpc0FycmF5KHJlcGxhY2VyKSlyZXBsYWNlciA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpewogICAgICBpZigkcmVwbGFjZXIpdmFsdWUgPSAkcmVwbGFjZXIuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTsKICAgICAgaWYoIWlzU3ltYm9sKHZhbHVlKSlyZXR1cm4gdmFsdWU7CiAgICB9OwogICAgYXJnc1sxXSA9IHJlcGxhY2VyOwogICAgcmV0dXJuIF9zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3MpOwogIH0KfSk7CgovLyAxOS40LjMuNCBTeW1ib2wucHJvdG90eXBlW0BAdG9QcmltaXRpdmVdKGhpbnQpCiRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IF9fd2VicGFja19yZXF1aXJlX18oNykoJFN5bWJvbFtQUk9UT1RZUEVdLCBUT19QUklNSVRJVkUsICRTeW1ib2xbUFJPVE9UWVBFXS52YWx1ZU9mKTsKLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXQpzZXRUb1N0cmluZ1RhZygkU3ltYm9sLCAnU3ltYm9sJyk7Ci8vIDIwLjIuMS45IE1hdGhbQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTsKLy8gMjQuMy4zIEpTT05bQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoZ2xvYmFsLkpTT04sICdKU09OJywgdHJ1ZSk7CgovKioqLyB9KSwKLyogMTA3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdhc3luY0l0ZXJhdG9yJyk7CgovKioqLyB9KSwKLyogMTA4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdvYnNlcnZhYmxlJyk7CgovKioqLyB9KSwKLyogMTA5ICovLAovKiAxMTAgKi8sCi8qIDExMSAqLywKLyogMTEyICovLAovKiAxMTMgKi8sCi8qIDExNCAqLywKLyogMTE1ICovLAovKiAxMTYgKi8sCi8qIDExNyAqLywKLyogMTE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTI0KTsKCnZhciBfUHJveHlPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUHJveHlPYmplY3QpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKg0KICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIERhdGFPYmplY3QgYWRkQ2hpbGRyZW4gY2FsbCBvciBmcm9tIG9uQWRkQ2hpbGRyZW4gaWYgcmVtb3RlbHkgY3JlYXRlZC4NCiAqIENoaWxkcmVuIG9iamVjdCBzeW5jaHJvbml6YXRpb24gaXMgYSBhIGZhc3QgZm9yd2FyZCBtZWNoYW5pc20sIG5vIG5lZWQgZm9yIGRpcmVjdCBzdWJzY3JpcHRpb25zLCBpdCB1c2VzIHRoZSBhbHJlYWR5IGF1dGhvcml6ZWQgc3Vic2NyaXB0aW9uIGZyb20gdGhlIHBhcmVudCBEYXRhT2JqZWN0Lg0KICovCnZhciBEYXRhT2JqZWN0Q2hpbGQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUNCiAgICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tDQogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkDQogICovCgogIC8qKg0KICAgKiBAaWdub3JlDQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBEYXRhT2JqZWN0LmFkZENoaWxkcmVuDQogICAqLwogIGZ1bmN0aW9uIERhdGFPYmplY3RDaGlsZChwYXJlbnQsIGNoaWxkSWQsIGluaXRpYWxEYXRhLCBvd25lciwgbXNnSWQpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3RDaGlsZCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fcGFyZW50ID0gcGFyZW50OwogICAgX3RoaXMuX2NoaWxkSWQgPSBjaGlsZElkOwogICAgX3RoaXMuX293bmVyID0gb3duZXI7CiAgICBfdGhpcy5fbXNnSWQgPSBtc2dJZDsKCiAgICBfdGhpcy5fc3luY09iaiA9IG5ldyBfUHJveHlPYmplY3QyLmRlZmF1bHQoaW5pdGlhbERhdGEpOwoKICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdENoaWxkIC0gIENvbnN0cnVjdG9yXSAtICcsIF90aGlzLl9zeW5jT2JqKTsKCiAgICBfdGhpcy5fYnVzID0gcGFyZW50Ll9idXM7CiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICB9CgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERhdGFPYmplY3RDaGlsZCwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy90aGlzIGlzIG9ubHkgbmVlZGVkIGZvciBjaGlsZHJlbiByZXBvcnRlcnMKICAgICAgaWYgKF90aGlzLl9vd25lcikgewogICAgICAgIF90aGlzLl9saXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX293bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICBpZiAobXNnLnR5cGUgPT09ICdyZXNwb25zZScgJiYgbXNnLmlkID09PSBfdGhpcy5fbXNnSWQpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RDaGlsZC5vblJlc3BvbnNlOicsIG1zZyk7CiAgICAgICAgICAgIF90aGlzLl9vblJlc3BvbnNlKG1zZyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoX3RoaXMuX2xpc3RlbmVyKSB7CiAgICAgICAgX3RoaXMuX2xpc3RlbmVyLnJlbW92ZSgpOwogICAgICB9CiAgICB9CgogICAgLyoqDQogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhDQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGRlbGV0ZSBfdGhpcy5fcGFyZW50Ll9jaGlsZHJlbltfdGhpcy5fY2hpbGRJZF07CgogICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwoKICAgICAgLy9UT0RPOiBzZW5kIGRlbGV0ZSBtZXNzYWdlID8KICAgIH0KCiAgICAvKioNCiAgICAgKiBDaGlsZHJlbiBJRCBnZW5lcmF0ZWQgb24gYWRkQ2hpbGRyZW4uIFVuaXF1ZSBpZGVudGlmaWVyDQogICAgICogQHR5cGUge1VSTH0gLSBVUkwgb2YgdGhlIGZvcm1hdCA8SHlwZXJ0eVVSTD4jPG51bWVyaWMtc2VxdWVuY2U+DQogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uQ2hhbmdlJywKCgogICAgLyoqDQogICAgICogUmVnaXN0ZXIgdGhlIGNoYW5nZSBsaXN0ZW5lcnMgc2VudCBieSB0aGUgcmVwb3J0ZXIgY2hpbGQNCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrDQogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdENoaWxkIC0gb2JzZXJ2ZXJdIC0gJywgZXZlbnQpOwogICAgICAgIGNhbGxiYWNrKGV2ZW50KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqDQogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgcmVzcG9uc2Ugbm90aWZpY2F0aW9ucyBvZiB0aGUgY3JlYXRlcw0KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZXNwb25zZShjYWxsYmFjaykgewogICAgICB0aGlzLl9vblJlc3BvbnNlSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3QgLT4gX29uQ2hpbGRDcmVhdGUKCiAgfSwgewogICAga2V5OiAnX29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlc3BvbnNlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmJvZHkuc291cmNlLAogICAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGUKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIpIHsKICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnY2hpbGRJZCcsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkSWQ7CiAgICB9CgogICAgLyoqDQogICAgICogRGF0YSBTdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLg0KICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4NCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGF0YScsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N5bmNPYmouZGF0YTsKICAgIH0KCiAgICAvKioNCiAgICAgKiBTZXQgZm9yIHRoaXMgZGF0YU9iamVjdENoaWxkIGFuIGlkZW50aXR5DQogICAgICogQG1ldGhvZCBpZGVudGl0eQ0KICAgICAqIEBwYXJhbSAge0lkZW50aXR5fSBpZGVudGl0eSBpZGVudGl0eSBmcm9tIHdobyBjcmVhdGVkIHRoZSBtZXNzYWdlDQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2lkZW50aXR5JywKICAgIHNldDogZnVuY3Rpb24gc2V0KGlkZW50aXR5KSB7CiAgICAgIHRoaXMuX2lkZW50aXR5ID0gaWRlbnRpdHk7CiAgICB9CgogICAgLyoqDQogICAgICogR2V0IGZvciB0aGlzIGRhdGFPYmplY3RDaGlsZCBhbiBpZGVudGl0eQ0KICAgICAqIEBtZXRob2QgaWRlbnRpdHkNCiAgICAgKiBAcmV0dXJuIHtJZGVudGl0eX0gaWRlbnRpdHkgZnJvbSB3aG8gY3JlYXRlZCB0aGUgbWVzc2FnZQ0KICAgICAqLwogICAgLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9pZGVudGl0eTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFPYmplY3RDaGlsZDsKfSgpOyAvKioNCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0ENCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRA0KICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTA0KICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WDQogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBDQogICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRw0KICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQ0KICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElODQogICAgICoNCiAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuDQogICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQogICAgICoNCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICAgICAqDQogICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQ0KICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQogICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZA0KICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICAgICAqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3RDaGlsZDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTE5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vICAgICBwcm94eS1vYnNlcnZlIHYwLjAuMTgNCi8vICAgICBDb3B5cmlnaHQgKGMpIDIwMTUsIDIwMTYgU2ltb24gWS4gQmxhY2t3ZWxsLCBBbnlXaGljaFdheQ0KLy8gICAgIE1JVCBMaWNlbnNlIC0gaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocA0KKGZ1bmN0aW9uKCkgew0KCSJ1c2Ugc3RyaWN0IjsNCgkvLyBDcmVhdGVzIGFuZCByZXR1cm5zIGEgUHJveHkgd3JhcHBpbmcgYSB0YXJnZXQgc28gdGhhdCBhbGwgY2hhbmdlcyBjYW4gYmUgdHJhcHBlZCBhbmQgZm9yd2FyZGVkIHRvDQoJLy8gYSBjYWxsYmFjay4gVGhlIGNhbGxiYWNrIHRha2VzIGFuIGFycmF5IG9mIGNoYW5nZXMganVzdCBsaWtlIHRoZSB0cmFkaXRpb25hbCBvcmlnaW5hbCBDaHJvbWUgT2JqZWN0Lm9ic2VydmUNCgkvLyB7b2JqZWN0OjxvYmplY3QgY2hhbmdlZD4sbmFtZTo8ZmllbGQgY2hhbmdlZD4sdHlwZTphZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUsb2xkVmFsdWU6PG9sZCB2YWx1ZSBpZiB1cGRhdGUgfCBkZWxldGU+fQ0KCS8vIFRoZSBhY2NlcHRsaXN0IGNhbiBiZSBhZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUuDQoJLy8gdiAwLjAuMTAgdG8gc3VwcG9ydCBwYXVzaW5nIGFuZCByZXN0YXJ0aW5nIG9ic2VydmF0aW9uIHR3byBhZGRpdGlvbmFsIGNvbnN0cnVjdG9yIGFyZ3VtZW50cyBhcmUgYXZhaWxhYmxlIHRvIE9iamVjdC5vYnNlcnZlOg0KCS8vIHBhdXNhYmxlIC0gY3JlYXRlIHRoZSBPYnNlcnZlciBzbyBpdCBjYW4gYmUgcGF1c2VkDQoJLy8gcGF1c2UgLSBjcmVhdGUgb2JzZXJ2ZXIgaW4gcGF1c2VkIHN0YXRlDQoJLy8gaWYgcGF1c2FibGUgaXMgdHJ1ZSB0aGVuIGFuIGFkZGl0aW9uYWwgbWV0aG9kIGRlbGl2ZXIoaWdub3JlUHJldmlvdXMpIGlzIGF2YWlsYWJsZSB0byBzdGFydCBkZWxpdmVyeQ0KCS8vIHRvIHBhdXNlIGRlbGl2ZXJ5IHNldCBhIHByb3BlcnR5IGNhbGxlZCBwYXVzZSBvbiB0aGUgZnVuY3Rpb24gZGVsaXZlciB0byB0cnVlDQoJLy8gcGF1c2FibGUgaXMgb3B0aW9uYWwgdG8gcmVkdWNlIHRoZSBjaGFuY2Ugb2Ygc2hhZG93aW5nIGEgcHJvcGVydHkgb3IgbWV0aG9kIG9uIGFueSBleGlzdGluZyBjb2RlIGNhbGxlZCBkZWxpdmVyDQoJaWYoIU9iamVjdC5vYnNlcnZlICYmIHR5cGVvZihQcm94eSk9PT0iZnVuY3Rpb24iKSB7DQoJCWZ1bmN0aW9uIE9ic2VydmVyKHRhcmdldCxjYWxsYmFjayxhY2NlcHRsaXN0LHBhdXNhYmxlLHBhdXNlLGRlbGF5KSB7DQoJICAgIAl2YXIgbWUgPSB0aGlzLCBwcm94eTsNCgkgICAgCWZ1bmN0aW9uIGRlbGl2ZXIoaWdub3JlUHJldmlvdXMsZGVsYXkpIHsNCgkgICAgCQlkZWxpdmVyLmRlbGF5ID0gZGVsYXk7DQoJICAgIAkJaWYoIWRlbGl2ZXIucGF1c2UpIHsNCgkgICAgICAgIAkJaWYobWUuY2hhbmdlc2V0Lmxlbmd0aD4wKSB7DQoJICAgICAgICAJCQlpZighaWdub3JlUHJldmlvdXMpIHsNCgkJICAgIAkgICAgCQl2YXIgY2hhbmdlcyA9IG1lLmNoYW5nZXNldC5maWx0ZXIoZnVuY3Rpb24oY2hhbmdlKSB7IHJldHVybiAhYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wOyB9KTsNCgkJICAgICAgICAJCQlpZihjaGFuZ2VzLmxlbmd0aD4wKSB7DQoJCSAgICAgICAgCQkJCWNhbGxiYWNrKGNoYW5nZXMpOw0KCQkgICAgICAgIAkJCX0NCgkgICAgICAgIAkJCX0NCgkgICAgICAgIAkJCW1lLmNoYW5nZXNldCA9IFtdOw0KCSAgICAgICAgCQl9DQoJICAgIAkJfQ0KCSAgICAJfQ0KCSAgICAJZGVsaXZlci5wYXVzZSA9IHBhdXNlOw0KCSAgICAJZGVsaXZlci5kZWxheSA9IGRlbGF5Ow0KCQkgICAgbWUuZ2V0ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSkgew0KCQkgICAgCWlmKHByb3BlcnR5PT09Il9fb2JzZXJ2ZXJfXyIpIHsNCgkJICAgIAkJcmV0dXJuIG1lOw0KCQkgICAgCX0NCgkJICAgIAlpZihwcm9wZXJ0eT09PSJ1bm9ic2VydmUiKSB7DQoJCSAgICAJCXJldHVybiBmdW5jdGlvbigpIHsNCgkJICAgIAkJCU9iamVjdC51bm9ic2VydmUodGFyZ2V0KTsNCgkJICAgIAkJCXJldHVybiB0YXJnZXQ7DQoJCSAgICAJCX07DQoJCSAgICAJfQ0KCQkgICAgCWlmKHByb3BlcnR5PT09ImRlbGl2ZXIiKSB7DQoJCSAgICAJCXJldHVybiBkZWxpdmVyOw0KCQkgICAgCX0NCgkJICAgIAlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsNCgkJICAgIH0NCgkgICAgCW1lLnRhcmdldCA9IHRhcmdldDsNCgkgICAgCW1lLmNoYW5nZXNldCA9IFtdOw0KCSAgICAJaWYoIW1lLnRhcmdldC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsNCgkgICAgCQkvLyBfX29ic2VydmVyQ2FsbGJhY2tzX18gaXMgdXNlZCBhcyBhbiBpbmRleCB0byBnZXQgYXQgdGhlIHByb3h5IHdoaWNoIGlzIHRoZSBvYnNlcnZlciwgc28gd2UgY2FuIHVub2JzZXJ2ZQ0KCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJDYWxsYmFja3NfXyIse2VudW1lcmFibGU6ZmFsc2UsY29uZmlndXJhYmxlOnRydWUsd3JpdGFibGU6ZmFsc2UsdmFsdWU6W119KTsNCgkgICAgCQlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCJfX29ic2VydmVyc19fIix7ZW51bWVyYWJsZTpmYWxzZSxjb25maWd1cmFibGU6dHJ1ZSx3cml0YWJsZTpmYWxzZSx2YWx1ZTpbXX0pOw0KCSAgICAJfQ0KCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5wdXNoKGNhbGxiYWNrKTsNCgkgICAgCW1lLnRhcmdldC5fX29ic2VydmVyc19fLnB1c2godGhpcyk7DQoJICAgIAlwcm94eSA9IG5ldyBQcm94eSh0YXJnZXQsbWUpOw0KCSAgICAJZGVsaXZlcihmYWxzZSxkZWxheSk7DQoJICAgIAlyZXR1cm4gcHJveHk7DQoJICAgIH0NCgkJT2JzZXJ2ZXIucHJvdG90eXBlLmRlbGl2ZXIgPSBmdW5jdGlvbigpIHsNCgkJCXJldHVybiB0aGlzLmdldChudWxsLCJkZWxpdmVyIik7DQoJCX0NCgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIHZhbHVlKSB7IC8vICwgcmVjZWl2ZXINCgkgICAgCXZhciBvbGR2YWx1ZSA9IHRhcmdldFtwcm9wZXJ0eV07DQoJICAgIAl2YXIgdHlwZSA9IChvbGR2YWx1ZT09PXVuZGVmaW5lZCA/ICJhZGQiIDogInVwZGF0ZSIpOw0KCSAgICAJdGFyZ2V0W3Byb3BlcnR5XSA9IHZhbHVlOw0KCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAoIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZih0eXBlKT49MCkpIHsNCgkgICAgICAgIAl2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsbmFtZTpwcm9wZXJ0eSx0eXBlOnR5cGV9LA0KCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkgICAgICAgIAkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOw0KCSAgICAgICAgCWlmKHR5cGU9PT0idXBkYXRlIikgew0KCSAgICAgICAgCQljaGFuZ2Uub2xkVmFsdWUgPSBvbGR2YWx1ZTsNCgkgICAgICAgIAl9DQoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJICAgICAgICAJfQ0KCSAgICAJfQ0KCSAgICAJcmV0dXJuIHRydWU7DQoJICAgIH07DQoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWxldGVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsNCgkgICAgCXZhciBvbGR2YWx1ZSA9IHRhcmdldFtwcm9wZXJ0eV07DQoJICAgIAkvL2lmKHR5cGVvZihvbGR2YWx1ZSkhPT0idW5kZWZpbmVkIikgew0KCQkgICAgCWRlbGV0ZSB0YXJnZXRbcHJvcGVydHldOw0KCQkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigiZGVsZXRlIik+PTApIHsNCgkJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZToiZGVsZXRlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sDQoJCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkJICAgICAgICAJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsNCgkJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCQkgICAgICAgIAlpZihzdGFydCkgew0KCQkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkJICAgICAgICAJfQ0KCQkgICAgCX0NCgkgICAgCS8vfQ0KCSAgICAJcmV0dXJuIHRydWU7DQoJICAgIH07DQoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIGRlc2NyaXB0b3IpIHsNCgkgICAgCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5LCBkZXNjcmlwdG9yKTsNCgkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigicmVjb25maWd1cmUiKT49MCkgew0KCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6InJlY29uZmlndXJlIn0sDQogICAgICAgIAkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLA0KICAgICAgICAJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7DQoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJICAgICAgICAJfQ0KCSAgICAJfQ0KCSAgICAJcmV0dXJuIHRydWU7DQoJICAgIH07DQoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5zZXRQcm90b3R5cGVPZiA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvdG90eXBlKSB7DQoJICAgIAl2YXIgb2xkdmFsdWUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KTsNCgkgICAgCU9iamVjdC5zZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSk7DQoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInNldFByb3RvdHlwZSIpPj0wKSB7DQoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6Il9fcHJvdG9fXyIsdHlwZToic2V0UHJvdG90eXBlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sDQogICAgCQkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLA0KICAgIAkJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7DQoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJICAgICAgICAJfQ0KCSAgICAJfQ0KCSAgICAJcmV0dXJuIHRydWU7DQoJICAgIH07DQoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5wcmV2ZW50RXh0ZW5zaW9ucyA9IGZ1bmN0aW9uKHRhcmdldCkgew0KCSAgICAgICAgT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKHRhcmdldCk7DQoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInByZXZlbnRFeHRlbnNpb25zIik+PTApIHsNCgkgICAgICAgIAl2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsdHlwZToicHJldmVudEV4dGVuc2lvbnMifSwNCgkJCQkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsDQoJCQkJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsNCgkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7DQoJICAgICAgICAJaWYoc3RhcnQpIHsNCgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkgICAgICAgIAl9DQoJICAgIAl9DQoJICAgIAlyZXR1cm4gdHJ1ZTsNCgkgICAgfTsNCgkgICAgT2JqZWN0Lm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgew0KCSAgICAJcmV0dXJuIG5ldyBPYnNlcnZlcihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSk7DQoJICAgIH07DQoJICAgIE9iamVjdC51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsNCgkgICAgCWlmKG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsNCgkgICAgCQlpZighY2FsbGJhY2spIHsNCgkgICAgCQkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5zcGxpY2UoMCxvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLmxlbmd0aCk7DQoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZSgwLG9iamVjdC5fX29ic2VydmVyc19fLmxlbmd0aCk7DQoJICAgIAkJCXJldHVybjsNCgkgICAgCQl9DQoJICAgIAkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5mb3JFYWNoKGZ1bmN0aW9uKG9ic2VydmVyY2FsbGJhY2ssaSkgew0KCSAgICAJCQlpZihjYWxsYmFjaz09PW9ic2VydmVyY2FsbGJhY2spIHsNCgkgICAgCQkJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uc3BsaWNlKGksMSk7DQoJICAgIAkJCQlkZWxldGUgb2JqZWN0Ll9fb2JzZXJ2ZXJzX19baV0uY2FsbGJhY2s7DQoJICAgIAkJCQlvYmplY3QuX19vYnNlcnZlcnNfXy5zcGxpY2UoaSwxKTsNCgkgICAgCQkJfQ0KCSAgICAJCX0pOw0KCSAgICAJfQ0KCSAgICB9Ow0KCSAgICBBcnJheS5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsNCgkgICAgCWlmKCEob2JqZWN0IGluc3RhbmNlb2YgQXJyYXkpICYmICFBcnJheS5pc0FycmF5KG9iamVjdCkpIHsNCgkgICAgCQl0aHJvdyBuZXcgVHlwZUVycm9yKCJGaXJzdCBhcmd1bWVudCB0byBBcnJheS5vYnNlcnZlciBpcyBub3QgYW4gQXJyYXkiKTsNCgkgICAgCX0NCiAgICAgICAgICAgIAlhY2NlcHRsaXN0ID0gYWNjZXB0bGlzdCB8fCBbImFkZCIsICJ1cGRhdGUiLCAiZGVsZXRlIiwgInNwbGljZSJdOw0KCSAgICAJdmFyIGFycmF5cHJveHkgPSBuZXcgUHJveHkob2JqZWN0LHtnZXQ6IGZ1bmN0aW9uKHRhcmdldCxwcm9wZXJ0eSkgew0KCSAgICAJCWlmKHByb3BlcnR5PT09InVub2JzZXJ2ZSIpIHsNCgkJICAgIAkJcmV0dXJuIGZ1bmN0aW9uKGNhbGxiYWNrKSB7DQoJCSAgICAJCQlpZihjYWxsYmFjaykgew0KCQkgICAgCQkJCXJldHVybiBPYmplY3QudW5vYnNlcnZlKHRhcmdldCxjYWxsYmFjayk7DQoJCSAgICAJCQl9DQoJCSAgICAJCQlyZXR1cm4gdGFyZ2V0LnVub2JzZXJ2ZSgpOw0KCQkgICAgCQl9Ow0KCQkgICAgCX0NCgkgICAgCQlpZihwcm9wZXJ0eT09PSJzcGxpY2UiKSB7DQoJICAgIAkJCXJldHVybiBmdW5jdGlvbihzdGFydCxlbmQpIHsNCgkgICAgCQkJCWlmKHR5cGVvZihzdGFydCkhPT0ibnVtYmVyIiB8fCB0eXBlb2YoZW5kKSE9PSJudW1iZXIiKSB7DQoJICAgIAkJCQkJdGhyb3cgbmV3IFR5cGVFcnJvcigiRmlyc3QgdHdvIGFyZ3VtZW50cyB0byBBcnJheSBzcGxpY2UgYXJlIG5vdCBudW1iZXIsIG51bWJlciIpOw0KCSAgICAJCQkJfQ0KCSAgICAJICAgIAkJdmFyIHJlbW92ZWQgPSB0aGlzLnNsaWNlKHN0YXJ0LHN0YXJ0K2VuZCksDQoJICAgIAkgICAgCQkJYWRkZWRDb3VudCA9IChhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50cy5sZW5ndGgtMiA6IDApLA0KCSAgICAJICAgIAkJCWNoYW5nZSA9ICB7b2JqZWN0Om9iamVjdCx0eXBlOiJzcGxpY2UiLGluZGV4OnN0YXJ0LHJlbW92ZWQ6cmVtb3ZlZCxhZGRlZENvdW50OmFkZGVkQ291bnR9Ow0KCSAgICAJICAgIAkJdGFyZ2V0LnNwbGljZS5hcHBseSh0YXJnZXQsYXJndW1lbnRzKTsNCgkgICAgCSAgICAJCWlmKGFjY2VwdGxpc3QuaW5kZXhPZigic3BsaWNlIik+PTApIHsNCgkgICAgCSAgICAJCQl2YXIgc3RhcnQgPSBwcm94eS5fX29ic2VydmVyX18uY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkgICAgCSAgICAgICAgCQkJZGVsaXZlciA9IHByb3h5Ll9fb2JzZXJ2ZXJfXy5kZWxpdmVyKCk7DQoJICAgIAkgICAgCQkJcHJveHkuX19vYnNlcnZlcl9fLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7DQoJICAgIAkgICAgCQkJaWYoc3RhcnQpIHsNCgkgICAgCQkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkgICAgCQkgICAgICAgIAl9DQoJICAgIAkgICAgCQl9DQoJICAgIAkgICAgCX0NCgkgICAgCQl9DQoJICAgIAkJaWYocHJvcGVydHk9PT0icHVzaCIpIHsNCgkgICAgCQkJIHJldHVybiBmdW5jdGlvbihpdGVtKSB7DQoJICAgIAkJICAgIAlyZXR1cm4gdGhpcy5zcGxpY2UodGhpcy5sZW5ndGgsMCxpdGVtKTsNCgkgICAgCQkgICAgfQ0KCSAgICAJCX0NCgkgICAgCQlpZihwcm9wZXJ0eT09PSJwb3AiKSB7DQoJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oKSB7DQoJICAgIAkJICAgIAlyZXR1cm4gdGhpcy5zcGxpY2UodGhpcy5sZW5ndGgtMSwxKTsNCgkgICAgCQkgICAgfQ0KCSAgICAJCX0NCgkgICAgCQlpZihwcm9wZXJ0eT09PSJ1bnNoaWZ0Iikgew0KCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHsNCiAgICAJCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDAsaXRlbSk7DQogICAgCQkgICAgCX0NCgkgICAgCQl9DQoJICAgIAkJaWYocHJvcGVydHk9PT0ic2hpZnQiKSB7DQoJICAgIAkJCXJldHVybiBmdW5jdGlvbigpIHsNCgkgICAgCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDEpOw0KCSAgICAJICAgIAl9DQoJICAgIAkJfQ0KCSAgICAJCXJldHVybiB0YXJnZXRbcHJvcGVydHldOw0KCSAgICAJfX0pOw0KCSAgICAJdmFyIHByb3h5ID0gT2JqZWN0Lm9ic2VydmUoYXJyYXlwcm94eSxmdW5jdGlvbihjaGFuZ2VzZXQpIHsgDQoJICAgIAkJdmFyIGNoYW5nZXMgPSBjaGFuZ2VzZXQuZmlsdGVyKGZ1bmN0aW9uKGNoYW5nZSkgeyByZXR1cm4gY2hhbmdlLm5hbWUhPT0ibGVuZ3RoIiAmJiBjaGFuZ2UubmFtZSE9PSJhZGQiICYmICghYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wKTsgfSk7DQoJICAgIAkJaWYoY2hhbmdlcy5sZW5ndGg+MCkgew0KCSAgICAJCQljYWxsYmFjayhjaGFuZ2VzKTsNCgkgICAgCQl9DQoJICAgIAl9LGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpOw0KCSAgICAJcmV0dXJuIHByb3h5Ow0KCSAgICB9Ow0KCSAgICBBcnJheS51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsNCgkJICByZXR1cm4gb2JqZWN0LnVub2JzZXJ2ZShjYWxsYmFjayk7DQoJICAgIH0NCgl9DQoJT2JqZWN0LmRlZXBPYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLHBhcnRzKSB7DQoNCgkJcGFydHMgPSAocGFydHMgPyBwYXJ0cyA6IFtdKTsNCg0KCQl2YXIgdG9UeXBlTmFtZSA9IGZ1bmN0aW9uKG9iaikgew0KCQkJcmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvYmopLm1hdGNoKC9ccyhbYS16QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKQ0KCQl9DQoNCgkJZnVuY3Rpb24gcmVvYnNlcnZlKHZhbHVlLCBwYXJ0cykgew0KCQkJdmFyIGtleXMgPSBPYmplY3Qua2V5cyh2YWx1ZSk7DQoJCQlrZXlzLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7DQoJCQkJaWYoKHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdvYmplY3QnIHx8IHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdhcnJheScpICYmICF2YWx1ZVtrZXldLmhhc093blByb3BlcnR5KCdfX29ic2VydmVyc19fJykpIHsNCgkJCQkJdmFyIG5ld3BhcnRzID0gcGFydHMuc2xpY2UoMCk7DQoJCQkJCW5ld3BhcnRzLnB1c2goa2V5KTsNCgkJCQkJdmFsdWVba2V5XSA9IE9iamVjdC5kZWVwT2JzZXJ2ZSh2YWx1ZVtrZXldLGNhbGxiYWNrLG5ld3BhcnRzKTsNCgkJCQl9DQoJCQl9KTsNCgkJfQ0KDQoJCXJlb2JzZXJ2ZShvYmplY3QsIHBhcnRzKTsNCg0KCQl2YXIgb2JzZXJ2ZWQgPSBPYmplY3Qub2JzZXJ2ZShvYmplY3QsZnVuY3Rpb24oY2hhbmdlc2V0KSB7DQoJCQl2YXIgY2hhbmdlcyA9IFtdOw0KCQkJZnVuY3Rpb24gcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0LG5ld09iamVjdCxwYXRoKSB7DQoJCQkJaWYobmV3T2JqZWN0IGluc3RhbmNlb2YgT2JqZWN0KSB7DQoJCQkJCXZhciBuZXdrZXlzID0gT2JqZWN0LmtleXMobmV3T2JqZWN0KTsNCgkJCQkJbmV3a2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgew0KCQkJCQkJaWYoIW9sZE9iamVjdCB8fCAob2xkT2JqZWN0W2tleV0hPT1uZXdPYmplY3Rba2V5XSkpIHsNCgkJCQkJCQl2YXIgb2xkdmFsdWUgPSAob2xkT2JqZWN0ICYmIG9sZE9iamVjdFtrZXldIT09dW5kZWZpbmVkID8gb2xkT2JqZWN0W2tleV0gOiB1bmRlZmluZWQpLA0KCQkJCQkJCQljaGFuZ2UgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKSwNCgkJCQkJCQkJa2V5cGF0aCA9IHBhdGggKyAiLiIgKyBrZXk7DQoNCgkJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGR2YWx1ZSxuZXdWYWx1ZTpuZXdPYmplY3Rba2V5XSxrZXlwYXRoOmtleXBhdGh9KTsNCgkJCQkJCQlyZWN1cnNlKG5hbWUscm9vdE9iamVjdCxvbGR2YWx1ZSxuZXdPYmplY3Rba2V5XSxrZXlwYXRoKTsNCgkJCQkJCX0NCgkJCQkJfSk7DQoJCQkJfSBlbHNlIGlmKG9sZE9iamVjdCBpbnN0YW5jZW9mIE9iamVjdCkgew0KCQkJCQl2YXIgb2xka2V5cyA9IE9iamVjdC5rZXlzKG9sZE9iamVjdCk7DQoJCQkJCW9sZGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsNCgkJCQkJCXZhciBjaGFuZ2UgPSAobmV3T2JqZWN0PT09bnVsbCA/ICJ1cGRhdGUiIDogImRlbGV0ZSIpLA0KCQkJCQkJCWtleXBhdGggPSBwYXRoICsgIi4iICsga2V5Ow0KCQkJCQkJCQ0KCQkJCQkJY2hhbmdlcy5wdXNoKHtuYW1lOm5hbWUsb2JqZWN0OnJvb3RPYmplY3QsdHlwZTpjaGFuZ2Usb2xkVmFsdWU6b2xkT2JqZWN0W2tleV0sbmV3VmFsdWU6bmV3T2JqZWN0LGtleXBhdGg6a2V5cGF0aH0pOw0KCQkJCQkJcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0W2tleV0sdW5kZWZpbmVkLGtleXBhdGgpOw0KCQkJCQl9KTsNCgkJCQl9DQoJCQl9DQoJCQljaGFuZ2VzZXQuZm9yRWFjaChmdW5jdGlvbihjaGFuZ2UpIHsNCgkJCQl2YXIga2V5cGF0aCA9IChwYXJ0cy5sZW5ndGg+MCA/IHBhcnRzLmpvaW4oIi4iKSArICIuIiA6ICIiKSArIGNoYW5nZS5uYW1lOw0KDQoJCQkJaWYgKGNoYW5nZS50eXBlID09PSAidXBkYXRlIiB8fCBjaGFuZ2UudHlwZSA9PT0gImFkZCIpIHsgDQoJCQkJCXJlb2JzZXJ2ZShjaGFuZ2Uub2JqZWN0LCBwYXJ0cyk7DQoJCQkJfQ0KDQoJCQkJY2hhbmdlcy5wdXNoKHtuYW1lOmNoYW5nZS5uYW1lLG9iamVjdDpjaGFuZ2Uub2JqZWN0LHR5cGU6Y2hhbmdlLnR5cGUsb2xkVmFsdWU6Y2hhbmdlLm9sZFZhbHVlLG5ld1ZhbHVlOmNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGg6a2V5cGF0aH0pOw0KCQkJCXJlY3Vyc2UoY2hhbmdlLm5hbWUsY2hhbmdlLm9iamVjdCxjaGFuZ2Uub2xkVmFsdWUsY2hhbmdlLm9iamVjdFtjaGFuZ2UubmFtZV0sa2V5cGF0aCk7DQoJCQl9KTsNCgkJCWNhbGxiYWNrKGNoYW5nZXMpOw0KCQl9KTsNCgkJcmV0dXJuIG9ic2VydmVkOw0KCX07DQp9KSgpOw0KCgovKioqLyB9KSwKLyogMTIwICovLAovKiAxMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKdmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yKTsKCnZhciBfZ2V0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTI1KTsKCnZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKdmFyIF9pbmhlcml0czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCnZhciBfaW5oZXJpdHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5oZXJpdHMyKTsKCnZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCnZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMyk7Cgp2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Q2hpbGQpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBGaWx0ZXJUeXBlID0geyBBTlk6ICdhbnknLCBTVEFSVDogJ3N0YXJ0JywgRVhBQ1Q6ICdleGFjdCcgfTsKCi8qKg0KICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgc3Vic2NyaWJlIGNhbGwuDQogKiBUbyBiZSB1c2VkIGFzIGFuIG9ic2VydmF0aW9uIHBvaW50IGZyb20gYSBEYXRhT2JqZWN0UmVwb3J0ZXIgY2hhbmdlLg0KICovCi8qKg0KKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0ENCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQNCiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMDQoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WDQoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQ0KKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHDQoqIENvcHlyaWdodCAyMDE2IEFwaXplZQ0KKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTg0KKg0KKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLg0KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCioNCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCioNCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQ0KKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLA0KKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4NCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZA0KKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4NCioqLwoKdmFyIERhdGFPYmplY3RPYnNlcnZlciA9IGZ1bmN0aW9uIChfRGF0YU9iamVjdCkgewogICgwLCBfaW5oZXJpdHMzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlciwgX0RhdGFPYmplY3QpOwoKICAvKiBwcml2YXRlDQogIF9jaGFuZ2VMaXN0ZW5lcjogTXNnTGlzdGVuZXINCiAgICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tDQogIF9maWx0ZXJzOiB7PGZpbHRlcj46IHt0eXBlOiA8c3RhcnQsIGV4YWN0PiwgY2FsbGJhY2s6IDxmdW5jdGlvbj59IH0NCiAgKi8KCiAgLyoqDQogICAqIEBpZ25vcmUNCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuc3Vic2NyaWJlIG1ldGhvZA0KICAgKi8KCiAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogIGZ1bmN0aW9uIERhdGFPYmplY3RPYnNlcnZlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucywgaW5pdGlhbFZlcnNpb24sIG11dHVhbCkgewogICAgdmFyIHJlc3VtZWQgPSBhcmd1bWVudHMubGVuZ3RoID4gOCAmJiBhcmd1bWVudHNbOF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s4XSA6IGZhbHNlOwogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdE9ic2VydmVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdE9ic2VydmVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YS5kYXRhLCBjaGlsZHJlbnMsIG11dHVhbCwgcmVzdW1lZCkpOwoKICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IGluaXRpYWxWZXJzaW9uOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewogICAgICBfdGhpcy5fb25GaWx0ZXIoZXZlbnQpOwogICAgfSk7CgogICAgdmFyIGNoaWxkSWRTdHJpbmcgPSBfdGhpcy5fb3duZXIgKyAnIycgKyBfdGhpcy5fY2hpbGRJZDsKCiAgICAvL3NldHVwIGNoaWxkcmVucyBkYXRhIGZyb20gc3Vic2NyaXB0aW9uCiAgICAoMCwgX2tleXMyLmRlZmF1bHQpKGluaXRpYWxEYXRhLmNoaWxkcmVucykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRyZW5SZXNvdXJjZSkgewogICAgICB2YXIgY2hpbGRyZW4gPSBpbml0aWFsRGF0YS5jaGlsZHJlbnNbY2hpbGRyZW5SZXNvdXJjZV07CiAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdE9ic2VydmVyIC0gbmV3IERhdGFPYmplY3RDaGlsZF06ICcsIGNoaWxkcmVuUmVzb3VyY2UsIGNoaWxkcmVuLCBfdGhpcy5fcmVzdW1lZCk7CiAgICAgIGlmIChfdGhpcy5fcmVzdW1lZCkgewoKICAgICAgICAvLyBpZiBpcyByZXN1bWVkCiAgICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShjaGlsZHJlbikuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRJZCkgewogICAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBjaGlsZElkLCBjaGlsZHJlbltjaGlsZElkXS52YWx1ZSk7CiAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLmlkZW50aXR5ID0gY2hpbGRyZW5bY2hpbGRJZF0uaWRlbnRpdHk7CgogICAgICAgICAgaWYgKGNoaWxkSWQgPiBjaGlsZElkU3RyaW5nKSB7CiAgICAgICAgICAgIGNoaWxkSWRTdHJpbmcgPSBjaGlsZElkOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdE9ic2VydmVyIC0gbmV3IERhdGFPYmplY3RDaGlsZF0gLSByZXN1bWVkOiAnLCBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLCBjaGlsZElkLCBjaGlsZHJlbltjaGlsZElkXS52YWx1ZSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gaWYgaXMgbm90IHJlc3VtZWQKICAgICAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkcmVuUmVzb3VyY2VdID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIGNoaWxkcmVuUmVzb3VyY2UsIGNoaWxkcmVuKTsKICAgICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RPYnNlcnZlciAtIG5ldyBEYXRhT2JqZWN0Q2hpbGRdIC0gbm90IHJlc3VtZWQ6ICcsIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRyZW5SZXNvdXJjZV0pOwogICAgICB9CiAgICB9KTsKCiAgICBfdGhpcy5fY2hpbGRJZCA9IE51bWJlcihjaGlsZElkU3RyaW5nLnNwbGl0KCcjJylbMV0pOwoKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogICAgcmV0dXJuIF90aGlzMjsKICB9CgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlciwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICAoMCwgX2dldDMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZSksICdfYWxsb2NhdGVMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsICsgJy9jaGFuZ2VzJywgZnVuY3Rpb24gKG1zZykgewogICAgICAgIGlmIChtc2cudHlwZSA9PT0gJ3VwZGF0ZScpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0T2JzZXJ2ZXItJyArIF90aGlzLl91cmwgKyAnLVJDVjogJywgbXNnKTsKICAgICAgICAgIF90aGlzLl9jaGFuZ2VPYmplY3QoX3RoaXMuX3N5bmNPYmosIG1zZyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlKSwgJ19yZWxlYXNlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lci5yZW1vdmUoKTsKICAgIH0KCiAgICAvKioNCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGENCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICB9CgogICAgLyoqDQogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhDQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3Vuc3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiB1bnN1YnNjcmliZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uTG9jYWxVblN1YnNjcmliZQogICAgICB2YXIgdW5TdWJzY3JpYmVNc2cgPSB7CiAgICAgICAgdHlwZTogJ3Vuc3Vic2NyaWJlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBfdGhpcy5fdXJsIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UodW5TdWJzY3JpYmVNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0T2JzZXJ2ZXItVU5TVUJTQ1JJQkU6ICcsIHJlcGx5KTsKICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX29ic2VydmVyc1tfdGhpcy5fdXJsXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8qKg0KICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyDQogICAgICogQHBhcmFtIHtzdHJpbmd9IGZpbHRlciAtIEZpbHRlciB0aGF0IGlkZW50aWZpZXMgdGhlIGZpZWxkIChzZXBhcmF0ZWQgZG90IHBhdGgpLiBBY2NlcHRzICogYXQgdGhlIGVuZCBmb3IgYSBtb3JlIHVucmVzdHJpY3RlZCBmaWx0ZXJpbmcuDQogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjaw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkNoYW5nZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2UoZmlsdGVyLCBjYWxsYmFjaykgewogICAgICB2YXIga2V5ID0gZmlsdGVyOwogICAgICB2YXIgZmlsdGVyT2JqID0gewogICAgICAgIHR5cGU6IEZpbHRlclR5cGUuRVhBQ1QsCiAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrCiAgICAgIH07CgogICAgICB2YXIgaWR4ID0gZmlsdGVyLmluZGV4T2YoJyonKTsKICAgICAgaWYgKGlkeCA9PT0gZmlsdGVyLmxlbmd0aCAtIDEpIHsKICAgICAgICBpZiAoaWR4ID09PSAwKSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuQU5ZOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuU1RBUlQ7CiAgICAgICAgICBrZXkgPSBmaWx0ZXIuc3Vic3RyKDAsIGZpbHRlci5sZW5ndGggLSAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuX2ZpbHRlcnNba2V5XSA9IGZpbHRlck9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25GaWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZpbHRlcihldmVudCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fZmlsdGVycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdmFyIGZpbHRlciA9IF90aGlzLl9maWx0ZXJzW2tleV07CiAgICAgICAgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLkFOWSkgewogICAgICAgICAgLy9tYXRjaCBhbnl0aGluZwogICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKICAgICAgICB9IGVsc2UgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLlNUQVJUKSB7CiAgICAgICAgICAvL2lmIHN0YXJ0cyB3aXRoIGZpbHRlci4uLgogICAgICAgICAgaWYgKGV2ZW50LmZpZWxkLmluZGV4T2Yoa2V5KSA9PT0gMCkgewogICAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuRVhBQ1QpIHsKICAgICAgICAgIC8vZXhhY3QgbWF0Y2gKICAgICAgICAgIGlmIChldmVudC5maWVsZCA9PT0ga2V5KSB7CiAgICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFPYmplY3RPYnNlcnZlcjsKfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdE9ic2VydmVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKdmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yKTsKCnZhciBfZ2V0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTI1KTsKCnZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKdmFyIF9pbmhlcml0czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCnZhciBfaW5oZXJpdHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5oZXJpdHMyKTsKCnZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMyk7Cgp2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Q2hpbGQpOwoKdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNzEpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKg0KICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgY3JlYXRlIGNhbGwuDQogKiBUbyBiZSB1c2VkIGFzIGEgcmVwb3J0ZXIgcG9pbnQsIGNoYW5nZXMgd2lsbCBiZSBzdWJtaXRlZCB0byBEYXRhT2JqZWN0T2JzZXJ2ZXIgaW5zdGFuY2VzLg0KICovCnZhciBEYXRhT2JqZWN0UmVwb3J0ZXIgPSBmdW5jdGlvbiAoX0RhdGFPYmplY3QpIHsKICAoMCwgX2luaGVyaXRzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIF9EYXRhT2JqZWN0KTsKCiAgLyogcHJpdmF0ZQ0KICBfc3Vic2NyaXB0aW9uczogPGh5cGVydHlVcmw6IHsgc3RhdHVzOiBzdHJpbmcgfSB9Pg0KICAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0NCiAgX29uU3Vic2NyaXB0aW9uSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkDQogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkDQogIF9vblJlYWRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQNCiAgKi8KCiAgLyoqDQogICAqIEBpZ25vcmUNCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuY3JlYXRlIG1ldGhvZA0KICAgKi8KICBmdW5jdGlvbiBEYXRhT2JqZWN0UmVwb3J0ZXIoc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlbnMsIG11dHVhbCkgewogICAgdmFyIHJlc3VtZWQgPSBhcmd1bWVudHMubGVuZ3RoID4gNyAmJiBhcmd1bWVudHNbN10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s3XSA6IGZhbHNlOwogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdFJlcG9ydGVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdFJlcG9ydGVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zLCBtdXR1YWwsIHJlc3VtZWQpKTsKCiAgICB2YXIgX3RoaXMgPSBfdGhpczI7CgogICAgX3RoaXMuX3N1YnNjcmlwdGlvbnMgPSB7fTsKCiAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewogICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLScgKyB1cmwgKyAnLVNFTkQ6ICcsIGV2ZW50KTsKICAgICAgX3RoaXMuX29uQ2hhbmdlKGV2ZW50KTsKICAgIH0pOwoKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogICAgcmV0dXJuIF90aGlzMjsKICB9CgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlciwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICAoMCwgX2dldDMuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZSksICdfYWxsb2NhdGVMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX29iamVjdExpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3QtJyArIF90aGlzLl91cmwgKyAnLVJDVjogJywgbXNnKTsKICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CiAgICAgICAgICBjYXNlICdyZXNwb25zZSc6CiAgICAgICAgICAgIF90aGlzLl9vblJlc3BvbnNlKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdyZWFkJzoKICAgICAgICAgICAgX3RoaXMuX29uUmVhZChtc2cpO2JyZWFrOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewogICAgICAoMCwgX2dldDMuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZSksICdfcmVsZWFzZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fb2JqZWN0TGlzdGVuZXIucmVtb3ZlKCk7CiAgICB9CgogICAgLyoqDQogICAgICoNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncmVzdW1lQ2hpbGRyZW5zJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVDaGlsZHJlbnMoY2hpbGRyZW5zKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIGNoaWxkSWRTdHJpbmcgPSB0aGlzLl9vd25lciArICcjJyArIHRoaXMuX2NoaWxkSWQ7CgogICAgICAvL3NldHVwIGNoaWxkcmVucyBkYXRhIGZyb20gc3Vic2NyaXB0aW9uCiAgICAgICgwLCBfa2V5czIuZGVmYXVsdCkoY2hpbGRyZW5zKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZHJlblJlc291cmNlKSB7CiAgICAgICAgdmFyIGNoaWxkcmVuID0gY2hpbGRyZW5zW2NoaWxkcmVuUmVzb3VyY2VdOwogICAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdFJlcG9ydGVyIC0gbmV3IERhdGFPYmplY3RDaGlsZF06ICcsIGNoaWxkcmVuUmVzb3VyY2UsIGNoaWxkcmVuLCBfdGhpczMuX3Jlc3VtZWQpOwoKICAgICAgICAvLyBpZiBpcyByZXN1bWVkCiAgICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShjaGlsZHJlbikuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRJZCkgewogICAgICAgICAgX3RoaXMzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF0gPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpczMsIGNoaWxkSWQsIGNoaWxkcmVuW2NoaWxkSWRdLnZhbHVlKTsKICAgICAgICAgIF90aGlzMy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLmlkZW50aXR5ID0gY2hpbGRyZW5bY2hpbGRJZF0uaWRlbnRpdHk7CgogICAgICAgICAgaWYgKGNoaWxkSWQgPiBjaGlsZElkU3RyaW5nKSB7CiAgICAgICAgICAgIGNoaWxkSWRTdHJpbmcgPSBjaGlsZElkOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdFJlcG9ydGVyIC0gbmV3IERhdGFPYmplY3RDaGlsZF0gLSByZXN1bWVkOiAnLCBfdGhpczMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSwgY2hpbGRJZCwgY2hpbGRyZW5bY2hpbGRJZF0udmFsdWUpOwogICAgICAgIH0pOwogICAgICB9KTsKCiAgICAgIHRoaXMuX2NoaWxkSWQgPSBOdW1iZXIoY2hpbGRJZFN0cmluZy5zcGxpdCgnIycpWzFdKTsKICAgIH0KCiAgICAvKioNCiAgICAgKiBTZW5kIGludml0YXRpb25zIChjcmVhdGUgbWVzc2FnZXMpIHRvIGh5cGVydGllcywgb2JzZXJ2ZXJzIGxpc3QuDQogICAgICogQHBhcmFtICB7SHlwZXJ0eVVSTFtdfSBvYnNlcnZlcnMgTGlzdCBvZiBIeXBlcnR5IFVSTCdzDQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2ludml0ZU9ic2VydmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW52aXRlT2JzZXJ2ZXJzKG9ic2VydmVycykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKICAgICAgdmFyIGludml0ZU1zZyA9IHsKICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMuX3N5bmNoZXIuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCwKICAgICAgICBib2R5OiB7IHJlc3VtZTogZmFsc2UsIHJlc291cmNlOiBfdGhpcy5fdXJsLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZhbHVlOiBfdGhpcy5fc3luY09iai5kYXRhLCBhdXRob3Jpc2U6IG9ic2VydmVycyB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGludml0ZU1zZyk7CiAgICB9CgogICAgLyoqDQogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhDQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uRGVsZXRlCiAgICAgIHZhciBkZWxldGVNc2cgPSB7CiAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGRlbGV0ZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1ERUxFVEU6ICcsIHJlcGx5KTsKICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX3JlcG9ydGVyc1tfdGhpcy5fdXJsXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8qKg0KICAgICAqIFN1YnNjcmlwdGlvbnMgcmVxdWVzdGVkIGFuZCBhY2NlcHRlZCB0byB0aGlzIHJlcG9ydGVyDQogICAgICogQHR5cGUge09iamVjdDxIeXBlcnR5VVJMLCBTeW5jU3Vic2NyaXB0aW9uPn0NCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25TdWJzY3JpcHRpb24nLAoKCiAgICAvKioNCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyBzdWJzY3JpYmUgYW5kIHVuc3Vic2NyaWJlIG5vdGlmaWNhdGlvbnMNCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrIGZ1bmN0aW9uIHRvIHJlY2VpdmUgZXZlbnRzDQogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TdWJzY3JpcHRpb24oY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLyoqDQogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgcmVzcG9uc2Ugbm90aWZpY2F0aW9ucyBvZiB0aGUgY3JlYXRlJ3MNCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrIGZ1bmN0aW9uIHRvIHJlY2VpdmUgZXZlbnRzDQogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvKioNCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZWFkIG5vdGlmaWNhdGlvbnMNCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrDQogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVhZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZWFkKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVhZEhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBwYXJlbnQgU3luY2hlciAtPiBfb25Gb3J3YXJkCgogIH0sIHsKICAgIGtleTogJ19vbkZvcndhcmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLVJDVjogJywgbXNnKTsKICAgICAgc3dpdGNoIChtc2cuYm9keS50eXBlKSB7CiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblN1YnNjcmliZShtc2cpO2JyZWFrOwogICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGlzIC0+IF9vbkZvcndhcmQ6IGVtaXR0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBzdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uU3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdWJzY3JpYmUobXNnKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwogICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RSZXBvcnRlci5fb25TdWJzY3JpYmVdJywgbXNnKTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIC8vY3JlYXRlIG5ldyBzdWJzY3JpcHRpb24KICAgICAgICAgIHZhciBzdWIgPSB7IHVybDogaHlwZXJ0eVVybCwgc3RhdHVzOiAnb24nIH07CiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjsKCiAgICAgICAgICAvL3Byb2Nlc3MgYW5kIHNlbmQgY2hpbGRyZW5zIGRhdGEKICAgICAgICAgIHZhciBjaGlsZHJlblZhbHVlcyA9IHt9OwogICAgICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CiAgICAgICAgICAgIHZhciBjaGlsZERhdGEgPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLmRhdGE7CiAgICAgICAgICAgIGNoaWxkcmVuVmFsdWVzW2NoaWxkSWRdID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGNoaWxkRGF0YSk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgc2VuZE1zZyA9IHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoX3RoaXMuZGF0YSksIGNoaWxkcmVuczogY2hpbGRyZW5WYWx1ZXMgfSB9CiAgICAgICAgICB9OwoKICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsQXV0aGVudGljYXRpb24nKSAmJiAhbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24pIHsKICAgICAgICAgICAgc2VuZE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXM0Ll9tdXR1YWxBdXRoZW50aWNhdGlvbjsKICAgICAgICAgICAgX3RoaXM0Ll9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBvayByZXNwb25zZSBtZXNzYWdlCiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHNlbmRNc2cpOwoKICAgICAgICAgIHJldHVybiBzdWI7CiAgICAgICAgfSwKCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7CiAgICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdTVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoaXMgLT4gX29uRm9yd2FyZDogZW1pdHRlZCBieSBhIHJlbW90ZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgLT4gdW5zdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uVW5TdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblVuU3Vic2NyaWJlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgaHlwZXJ0eVVybCA9IG1zZy5ib2R5LmZyb207CgogICAgICB2YXIgc3ViID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CiAgICAgIGRlbGV0ZSBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKICAgICAgICBvYmplY3Q6IHN1YgogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBSZXBvcnRlclVSTCBhZGRyZXNzOiBlbWl0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBfb25SZW1vdGVDcmVhdGUgLT4gZXZlbnQuYWNrCgogIH0sIHsKICAgIGtleTogJ19vblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZXNwb25zZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICB1cmw6IG1zZy5mcm9tLAogICAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGUKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVTUE9OU0UtRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gcmVhZAoKICB9LCB7CiAgICBrZXk6ICdfb25SZWFkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWFkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmZyb20sCgogICAgICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgdmFsdWU6ICgwLCBfdXRpbHMuZGVlcENsb25lKShfdGhpcy5kYXRhKSB9CiAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDEsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uUmVhZEhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVBRC1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblJlYWRIYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3N1YnNjcmlwdGlvbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdFJlcG9ydGVyOwp9KF9EYXRhT2JqZWN0My5kZWZhdWx0IC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyk7IC8qKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlEDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0ENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdFJlcG9ydGVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfcHJvbWlzZSA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpOwoKdmFyIF9wcm9taXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Byb21pc2UpOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTI0KTsKCnZhciBfUHJveHlPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUHJveHlPYmplY3QpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Q2hpbGQpOwoKdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNzEpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKg0KICogTWFpbiBleHRlbnNpb24gY2xhc3MgZm9yIG9ic2VydmVycyBhbmQgcmVwb3J0ZXJzLCB3aXRoIGNvbW1vbiBwcm9wZXJ0aWVzIGFuZCBtZXRob2RzLg0KICogQ2hpbGRyZW4gbWFuYWdlbWVudCBpcyBjb21tb24gZm9yIG9ic2VydmVycyBhbmQgcmVwb3J0ZXJzLg0KICovCnZhciBEYXRhT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUNCiAgX3ZlcnNpb246IG51bWJlcg0KICAgIF9vd25lcjogSHlwZXJ0eVVSTA0KICBfdXJsOiBPYmplY3RVUkwNCiAgX3NjaGVtYTogU2NoZW1hDQogIF9idXM6IE1pbmlCdXMNCiAgX3N0YXR1czogb24gfCBwYXVzZWQNCiAgX3N5bmNPYmo6IFN5bmNEYXRhDQogICAgX2NoaWxkcmVuOiB7IGlkOiBEYXRhT2JqZWN0Q2hpbGQgfQ0KICBfY2hpbGRyZW5MaXN0ZW5lcnM6IFtNc2dMaXN0ZW5lcl0NCiAgICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tDQogIF9vbkFkZENoaWxkSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkDQogICovCgogIC8qKg0KICAgKiBAaWdub3JlDQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyIGNyZWF0ZSBvciBzdWJzY3JpYmUgbWV0aG9kJ3MNCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdChzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgdmFyIG11dHVhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDogdHJ1ZTsKICAgIHZhciByZXN1bWVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDcgJiYgYXJndW1lbnRzWzddICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbN10gOiBmYWxzZTsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX3N5bmNoZXIgPSBzeW5jaGVyOwogICAgX3RoaXMuX3VybCA9IHVybDsKICAgIF90aGlzLl9zY2hlbWEgPSBzY2hlbWE7CiAgICBfdGhpcy5fc3RhdHVzID0gaW5pdGlhbFN0YXR1czsKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CiAgICBfdGhpcy5fY2hpbGRyZW5zID0gY2hpbGRyZW5zOwoKICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgIF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbDsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IDA7CiAgICBfdGhpcy5fY2hpbGRJZCA9IDA7CiAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzID0ge307CiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTsKCiAgICBfdGhpcy5fcmVzdW1lZCA9IHJlc3VtZWQ7CgogICAgX3RoaXMuX293bmVyID0gc3luY2hlci5fb3duZXI7CiAgICBfdGhpcy5fYnVzID0gc3luY2hlci5fYnVzOwoKICAgIC8qaWYgKHJlc3VtZWQgJiYgY2hpbGRyZW5zKSB7DQogICAgICBfdGhpcy5fY2hpbGRJZCA9IF90aGlzLl9nZXRMYXN0Q2hpbGRJZCgpOw0KICAgICAgY29uc29sZS5sb2coJ1tEYXRhIE9iamVjdCByZXN1bWVkXSBsYXN0IENoaWxkSWQ6ICcsIF90aGlzLl9jaGlsZElkKTsNCiAgICB9Ki8KICB9CgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERhdGFPYmplY3QsIFt7CiAgICBrZXk6ICdfZ2V0TGFzdENoaWxkSWQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRMYXN0Q2hpbGRJZCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBjaGlsZElkSW50ID0gMDsKICAgICAgdmFyIGNoaWxkSWRTdHJpbmcgPSBfdGhpcy5fb3duZXIgKyAnIycgKyBjaGlsZElkSW50OwoKICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5zKS5maWx0ZXIoZnVuY3Rpb24gKGtleSkgewogICAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW5zW2tleV0uY2hpbGRJZCA+IGNoaWxkSWRTdHJpbmcpIHsKICAgICAgICAgIGNoaWxkSWRTdHJpbmcgPSBfdGhpcy5fY2hpbGRyZW5zW2tleV0uY2hpbGRJZDsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGNoaWxkSWRJbnQgPSBOdW1iZXIoY2hpbGRJZFN0cmluZy5zcGxpdCgnIycpWzFdKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGNoaWxkQmFzZVVSTCA9IF90aGlzLl91cmwgKyAnL2NoaWxkcmVuLyc7CiAgICAgIGNvbnNvbGUubG9nKCdbRGF0YSBPYmplY3QgLSBBbGxvY2F0ZUxpc3RlbmVyc10gLSAnLCBfdGhpcy5fY2hpbGRyZW5zKTsKICAgICAgaWYgKF90aGlzLl9jaGlsZHJlbnMpIHsKICAgICAgICBfdGhpcy5fY2hpbGRyZW5zLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7CiAgICAgICAgICB2YXIgY2hpbGRVUkwgPSBjaGlsZEJhc2VVUkwgKyBjaGlsZDsKICAgICAgICAgIHZhciBsaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoY2hpbGRVUkwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZgogICAgICAgICAgICBpZiAobXNnLmZyb20gIT09IF90aGlzMi5fb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdC1DaGlsZHJlbi1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewogICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlJzoKICAgICAgICAgICAgICAgICAgX3RoaXMuX29uQ2hpbGRDcmVhdGUobXNnKTticmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICBfdGhpcy5fY2hhbmdlQ2hpbGRyZW4obXNnKTticmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikgewogICAgICAgIGxpc3RlbmVyLnJlbW92ZSgpOwogICAgICB9KTsKCiAgICAgICgwLCBfa2V5czIuZGVmYXVsdCkoX3RoaXMuX2NoaWxkcmVuT2JqZWN0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1trZXldLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKg0KICAgICAqIE9iamVjdCBVUkwgb2YgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXINCiAgICAgKiBAdHlwZSB7T2JqZWN0VVJMfQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdwYXVzZScsCgoKICAgIC8qKg0KICAgICAqIEBpZ25vcmUNCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHsKICAgICAgLy9UT0RPOiB0aGlzIGZlYXR1cmUgbmVlZHMgbW9yZSBhbmFsaXNlCiAgICAgIHRocm93ICdOb3QgaW1wbGVtZW50ZWQnOwogICAgfQoKICAgIC8qKg0KICAgICAqIEBpZ25vcmUNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncmVzdW1lJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7CiAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioNCiAgICAgKiBAaWdub3JlDQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3N0b3AnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3AoKSB7CiAgICAgIC8vVE9ETzogc2hvdWxkIHJlbW92ZSB0aGUgc3Vic2NyaXB0aW9uIGFuZCBzZW5kIG1lc3NhZ2UgdW5zdWJzY3JpYmU/CiAgICAgIHRocm93ICdOb3QgaW1wbGVtZW50ZWQnOwogICAgfQoKICAgIC8qKg0KICAgICAqIENyZWF0ZSBhbmQgYWRkIGEgRGF0YU9iamVjdENoaWxkIHRvIGEgY2hpbGRyZW4gY29sbGVjdGlvbi4NCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY2hpbGRyZW4gLSBDaGlsZHJlbiBuYW1lIHdoZXJlIHRoZSBjaGlsZCBpcyBhZGRlZC4NCiAgICAgKiBAcGFyYW0ge0pTT059IGluaXRpYWxEYXRhIC0gSW5pdGlhbCBkYXRhIG9mIHRoZSBjaGlsZA0KICAgICAqIEBwYXJhbSAge01lc3NhZ2VCb2R5SWRlbnRpdHl9IGlkZW50aXR5IC0gKG9wdGlvbmFsKSBpZGVudGl0eSBkYXRhIHRvIGJlIGFkZGVkIHRvIGlkZW50aXR5IHRoZSB1c2VyIHJlcG9ydGVyLiBUbyBiZSB1c2VkIGZvciBsZWdhY3kgaWRlbnRpdGllcy4NCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RDaGlsZD59IC0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgRGF0YU9iamVjdENoaWxkLg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdhZGRDaGlsZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkQ2hpbGQoY2hpbGRyZW4sIGluaXRpYWxEYXRhLCBpZGVudGl0eSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9jcmVhdGUgbmV3IGNoaWxkIHVuaXF1ZSBJRCwgYmFzZWQgb24gaHlwZXJ0eVVSTAogICAgICBfdGhpcy5fY2hpbGRJZCsrOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IF90aGlzLl9vd25lciArICcjJyArIF90aGlzLl9jaGlsZElkOwogICAgICB2YXIgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJyArIGNoaWxkcmVuOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoaWxkIGFkZHJlc3M6IE1lc3NhZ2VCdXMKICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IG1zZ0NoaWxkUGF0aCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBtc2dDaGlsZElkLCB2YWx1ZTogaW5pdGlhbERhdGEgfQogICAgICB9OwoKICAgICAgaWYgKGlkZW50aXR5KSB7CiAgICAgICAgcmVxdWVzdE1zZy5ib2R5LmlkZW50aXR5ID0gaWRlbnRpdHk7CiAgICAgIH0KCiAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgaWYgKCFfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb24pIHJlcXVlc3RNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbjsKCiAgICAgIC8vcmV0dXJucyBwcm9taXNlLCBpbiB0aGUgZnV0dXJlLCB0aGUgQVBJIG1heSBjaGFuZ2UgdG8gYXN5bmNocm9ub3VzIGNhbGwKICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIHZhciBtc2dJZCA9IF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVxdWVzdE1zZyk7CgogICAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUtcmVwb3J0ZXItY2hpbGQoICcgKyBfdGhpcy5fb3duZXIgKyAnICk6ICcsIHJlcXVlc3RNc2cpOwogICAgICAgIHZhciBuZXdDaGlsZCA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBtc2dDaGlsZElkLCBpbml0aWFsRGF0YSwgX3RoaXMuX293bmVyLCBtc2dJZCk7CiAgICAgICAgbmV3Q2hpbGQub25DaGFuZ2UoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICBfdGhpcy5fb25DaGFuZ2UoZXZlbnQsIHsgcGF0aDogbXNnQ2hpbGRQYXRoLCBjaGlsZElkOiBtc2dDaGlsZElkIH0pOwogICAgICAgIH0pOwoKICAgICAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW21zZ0NoaWxkSWRdID0gbmV3Q2hpbGQ7CgogICAgICAgIHJlc29sdmUobmV3Q2hpbGQpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioNCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyBjcmVhdGUgYW5kIGRlbGV0ZSBvZiBjaGlsZHJlbnMuDQogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjaw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkFkZENoaWxkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkFkZENoaWxkKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdCAtPiBhZGRDaGlsZAoKICB9LCB7CiAgICBrZXk6ICdfb25DaGlsZENyZWF0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uQ2hpbGRDcmVhdGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBtc2dDaGlsZElkID0gbXNnLmJvZHkucmVzb3VyY2U7CgogICAgICBjb25zb2xlLmxvZygnY3JlYXRlLW9ic2VydmVyLWNoaWxkKCAnICsgX3RoaXMuX293bmVyICsgJyApOiAnLCBtc2cpOwogICAgICB2YXIgbmV3Q2hpbGQgPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpcywgbXNnQ2hpbGRJZCwgbXNnLmJvZHkudmFsdWUpOwogICAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW21zZ0NoaWxkSWRdID0gbmV3Q2hpbGQ7CgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAvL0ZMT1ctT1VUOiB3aWxsIGZsb3cgdG8gRGF0YU9iamVjdENoaWxkIC0+IF9vblJlc3BvbnNlCiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgfSk7CiAgICAgIH0pOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIGZyb206IG1zZy5mcm9tLAogICAgICAgIHVybDogbXNnLnRvLAogICAgICAgIHZhbHVlOiBtc2cuYm9keS52YWx1ZSwKICAgICAgICBjaGlsZElkOiBtc2dDaGlsZElkLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdBREQtQ0hJTERSRU4tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9zZW5kIGRlbHRhIG1lc3NhZ2VzIHRvIHN1YnNjcmlwdGlvbnMKCiAgfSwgewogICAga2V5OiAnX29uQ2hhbmdlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2UoZXZlbnQsIGNoaWxkSW5mbykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKCiAgICAgIGlmIChfdGhpcy5fc3RhdHVzID09PSAnb24nKSB7CiAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoYW5nZXMgYWRkcmVzczogTWVzc2FnZUJ1cwogICAgICAgIHZhciBjaGFuZ2VNc2cgPSB7CiAgICAgICAgICB0eXBlOiAndXBkYXRlJywgZnJvbTogX3RoaXMuX3VybCwgdG86IF90aGlzLl91cmwgKyAnL2NoYW5nZXMnLAogICAgICAgICAgYm9keTogeyB2ZXJzaW9uOiBfdGhpcy5fdmVyc2lvbiwgc291cmNlOiBfdGhpcy5fb3duZXIsIGF0dHJpYnV0ZTogZXZlbnQuZmllbGQgfQogICAgICAgIH07CgogICAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdCAtIF9vbkNoYW5nZV0gLSAnLCBldmVudCwgY2hpbGRJbmZvLCBjaGFuZ2VNc2cpOwoKICAgICAgICBpZiAoZXZlbnQub1R5cGUgPT09IF9Qcm94eU9iamVjdC5PYmplY3RUeXBlLk9CSkVDVCkgewogICAgICAgICAgaWYgKGV2ZW50LmNUeXBlICE9PSBfUHJveHlPYmplY3QuQ2hhbmdlVHlwZS5SRU1PVkUpIHsKICAgICAgICAgICAgY2hhbmdlTXNnLmJvZHkudmFsdWUgPSBldmVudC5kYXRhOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjaGFuZ2VNc2cuYm9keS5hdHRyaWJ1dGVUeXBlID0gZXZlbnQub1R5cGU7CiAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CiAgICAgICAgICBpZiAoZXZlbnQuY1R5cGUgIT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlVQREFURSkgewogICAgICAgICAgICBjaGFuZ2VNc2cuYm9keS5vcGVyYXRpb24gPSBldmVudC5jVHlwZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vY2hpbGRJbmZvIG11c3QgaGF2ZSAocGF0aCwgY2hpbGRJZCkKICAgICAgICBpZiAoY2hpbGRJbmZvKSB7CiAgICAgICAgICBjaGFuZ2VNc2cudG8gPSBjaGlsZEluZm8ucGF0aDsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnJlc291cmNlID0gY2hpbGRJbmZvLmNoaWxkSWQ7CiAgICAgICAgfQoKICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgaWYgKCFfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb24pIGNoYW5nZU1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uOwoKICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGNoYW5nZU1zZyk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IGRlbHRhIG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgb3IgRGF0YU9iamVjdENoaWxkIHdoZW4gY2hhbmdpbmcgZGF0YQoKICB9LCB7CiAgICBrZXk6ICdfY2hhbmdlT2JqZWN0JywKICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hhbmdlT2JqZWN0KHN5bmNPYmosIG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9UT0RPOiB1cGRhdGUgdmVyc2lvbiA/CiAgICAgIC8vaG93IHRvIGhhbmRsZSBhbiBpbmNvcnJlY3QgdmVyc2lvbiA/IEV4YW1wbGU6IHJlY2VpdmUgYSB2ZXJzaW9uIDMgd2hlbiB0aGUgb2JzZXJ2ZXIgaXMgaW4gdmVyc2lvbiAxLCB3aGVyZSBpcyB0aGUgdmVyc2lvbiAyID8KICAgICAgLy93aWxsIHdlIG5lZWQgdG8gY29uZmlybSB0aGUgcmVjZXB0aW9uID8KICAgICAgaWYgKF90aGlzLl92ZXJzaW9uICsgMSA9PT0gbXNnLmJvZHkudmVyc2lvbikgewogICAgICAgIF90aGlzLl92ZXJzaW9uKys7CiAgICAgICAgdmFyIHBhdGggPSBtc2cuYm9keS5hdHRyaWJ1dGU7CiAgICAgICAgdmFyIHZhbHVlID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKG1zZy5ib2R5LnZhbHVlKTsKICAgICAgICB2YXIgZmluZFJlc3VsdCA9IHN5bmNPYmouZmluZEJlZm9yZShwYXRoKTsKCiAgICAgICAgaWYgKG1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPT09IF9Qcm94eU9iamVjdC5PYmplY3RUeXBlLkFSUkFZKSB7CiAgICAgICAgICBpZiAobXNnLmJvZHkub3BlcmF0aW9uID09PSBfUHJveHlPYmplY3QuQ2hhbmdlVHlwZS5BREQpIHsKICAgICAgICAgICAgdmFyIGFyciA9IGZpbmRSZXN1bHQub2JqOwogICAgICAgICAgICB2YXIgaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5zcGxpY2UuYXBwbHkoYXJyLCBbaW5kZXgsIDBdLmNvbmNhdCh2YWx1ZSkpOwogICAgICAgICAgfSBlbHNlIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICB2YXIgX2FyciA9IGZpbmRSZXN1bHQub2JqOwogICAgICAgICAgICB2YXIgX2luZGV4ID0gZmluZFJlc3VsdC5sYXN0OwogICAgICAgICAgICBfYXJyLnNwbGljZShfaW5kZXgsIHZhbHVlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF0gPSB2YWx1ZTsgLy8gVVBEQVRFCiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChtc2cuYm9keS52YWx1ZSkgewogICAgICAgICAgICBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdID0gdmFsdWU7IC8vIFVQREFURSBvciBBREQKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGRlbGV0ZSBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdOyAvLyBSRU1PVkUKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy9UT0RPOiBob3cgdG8gaGFuZGxlIHVuc3luY2hyb25pemVkIHZlcnNpb25zPwogICAgICAgIGNvbnNvbGUubG9nKCdVTlNZTkNIUk9OSVpFRCBWRVJTSU9OOiAoZGF0YSA9PiAnICsgX3RoaXMuX3ZlcnNpb24gKyAnLCBtc2cgPT4gJyArIG1zZy5ib2R5LnZlcnNpb24gKyAnKScpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdENoaWxkIHdoZW4gY2hhbmdpbmcgZGF0YQoKICB9LCB7CiAgICBrZXk6ICdfY2hhbmdlQ2hpbGRyZW4nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VDaGlsZHJlbihtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgY29uc29sZS5sb2coJ0NoYW5nZSBjaGlsZHJlbjogJywgX3RoaXMuX293bmVyLCBtc2cpOwoKICAgICAgdmFyIGNoaWxkSWQgPSBtc2cuYm9keS5yZXNvdXJjZTsKICAgICAgdmFyIGNoaWxkcmVuID0gX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXTsKCiAgICAgIGlmIChjaGlsZHJlbikgewogICAgICAgIF90aGlzLl9jaGFuZ2VPYmplY3QoY2hpbGRyZW4uX3N5bmNPYmosIG1zZyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coJ05vIGNoaWxkcmVuIGZvdW5kIGZvcjogJywgY2hpbGRJZCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICd1cmwnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl91cmw7CiAgICB9CgogICAgLyoqDQogICAgICogT2JqZWN0IHNjaGVtYSBVUkwgKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpDQogICAgICogQHR5cGUge1NjaGVtYVVSTH0NCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnc2NoZW1hJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc2NoZW1hOwogICAgfQoKICAgIC8qKg0KICAgICAqIFN0YXR1cyBvZiB0aGUgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIgY29ubmVjdGlvbiAodGhpcyBmaWVsZCBpcyBub3QgeWV0IHN0YWJsZSwgYW5kIGlzIHN1YnNqZWN0IHRvIGNoYW5nZSkNCiAgICAgKiBAdHlwZSB7U3RhdHVzfSAtIEVudW0gb2Y6IG9uIHwgcGF1c2VkDQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3N0YXR1cycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1czsKICAgIH0KCiAgICAvKioNCiAgICAgKiBEYXRhIHN0cnVjdHVyZSB0byBiZSBzeW5jaHJvbml6ZWQuDQogICAgICogQHR5cGUge0pTT059IC0gSlNPTiBzdHJ1Y3R1cmUgdGhhdCBzaG91bGQgZm9sbG93IHRoZSBkZWZpbmVkIHNjaGVtYSwgaWYgYW55Lg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwogICAgfQoKICAgIC8qKg0KICAgICAqIEFsbCBjcmVhdGVkIGNoaWxkcmVuJ3Mgc2luY2UgdGhlIHN1YnNjcmlwdGlvbiwgZG9lc24ndCBjb250YWluIGFsbCBjaGlsZHJlbidzIHNpbmNlIHJlcG9ydGVyIGNyZWF0aW9uLg0KICAgICAqIEB0eXBlIHtPYmplY3Q8Q2hpbGRJZCwgRGF0YU9iamVjdENoaWxkPn0NCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnY2hpbGRyZW5zJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW5PYmplY3RzOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdDsKfSgpOyAvKioNCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0ENCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRA0KICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTA0KICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WDQogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBDQogICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRw0KICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQ0KICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElODQogICAgICoNCiAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuDQogICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQogICAgICoNCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICAgICAqDQogICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQ0KICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQogICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZA0KICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICAgICAqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3Q7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEyNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk9iamVjdFR5cGUgPSBleHBvcnRzLkNoYW5nZVR5cGUgPSB1bmRlZmluZWQ7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKX193ZWJwYWNrX3JlcXVpcmVfXygxMTkpOwoKdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNzEpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBvYmplY3RUeXBlID0geyBBUlJBWTogJ1tvYmplY3QgQXJyYXldJywgT0JKRUNUOiAnW29iamVjdCBPYmplY3RdJyB9OwoKLyoqDQogKiBAYWNjZXNzIHByaXZhdGUNCiAqIE1haW4gY2xhc3MgdGhhdCBtYWludGFpbnMgYSBKU09OIG9iamVjdCwgYW5kIG9ic2VydmVzIGNoYW5nZXMgaW4gdGhpcyBvYmplY3QsIHJlY3Vyc2l2ZWx5Lg0KICogSW50ZXJuYWwgb2JqZWN0cyBhbmQgYXJyYXlzIGFyZSBhbHNvIG9ic2VydmVkLg0KICovCgp2YXIgU3luY09iamVjdCA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBTeW5jT2JqZWN0KGluaXRpYWxEYXRhKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBTeW5jT2JqZWN0KTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vYnNlcnZlcnMgPSBbXTsKICAgIF90aGlzLl9maWx0ZXJzID0ge307CgogICAgdGhpcy5fZGF0YSA9IGluaXRpYWxEYXRhIHx8IHt9OwoKICAgIHRoaXMuX2ludGVybmFsT2JzZXJ2ZSh0aGlzLl9kYXRhKTsKICB9CgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKFN5bmNPYmplY3QsIFt7CiAgICBrZXk6ICdvYnNlcnZlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvYnNlcnZlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29ic2VydmVycy5wdXNoKGNhbGxiYWNrKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdmaW5kJywKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kKHBhdGgpIHsKICAgICAgdmFyIGxpc3QgPSAoMCwgX3V0aWxzLnBhcnNlQXR0cmlidXRlcykocGF0aCk7CgogICAgICByZXR1cm4gdGhpcy5fZmluZFdpdGhTcGxpdChsaXN0KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdmaW5kQmVmb3JlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kQmVmb3JlKHBhdGgpIHsKICAgICAgdmFyIHJlc3VsdCA9IHt9OwogICAgICB2YXIgbGlzdCA9ICgwLCBfdXRpbHMucGFyc2VBdHRyaWJ1dGVzKShwYXRoKTsKICAgICAgcmVzdWx0Lmxhc3QgPSBsaXN0LnBvcCgpOwogICAgICByZXN1bHQub2JqID0gdGhpcy5fZmluZFdpdGhTcGxpdChsaXN0KTsKCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2ZpbmRXaXRoU3BsaXQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maW5kV2l0aFNwbGl0KGxpc3QpIHsKICAgICAgdmFyIG9iaiA9IHRoaXMuX2RhdGE7CiAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICBvYmogPSBvYmpbdmFsdWVdOwogICAgICB9KTsKCiAgICAgIHJldHVybiBvYmo7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2ludGVybmFsT2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsT2JzZXJ2ZShvYmplY3QpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoY2hhbmdlc2V0KSB7CgogICAgICAgIGNoYW5nZXNldC5ldmVyeShmdW5jdGlvbiAoY2hhbmdlKSB7CiAgICAgICAgICBfdGhpczIuX29uQ2hhbmdlcyhjaGFuZ2UpOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgdGhpcy5fZGF0YSA9IE9iamVjdC5kZWVwT2JzZXJ2ZShvYmplY3QsIGhhbmRsZXIpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19maXJlRXZlbnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maXJlRXZlbnQoZXZlbnQpIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2VzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2VzKGNoYW5nZSkgewoKICAgICAgdmFyIG9iaiA9IGNoYW5nZS5vYmplY3Q7CiAgICAgIHZhciBvYmpUeXBlID0gdm9pZCAwOwoKICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuT0JKRUNUOwogICAgICB9CgogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIG9ialR5cGUgPSBPYmplY3RUeXBlLkFSUkFZOwogICAgICB9CgogICAgICB2YXIgZmllbGRTdHJpbmcgPSBjaGFuZ2Uua2V5cGF0aDsKCiAgICAgIC8vIGNvbnNvbGUubG9nKCdGaWVsZDonLCBmaWVsZFN0cmluZyk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCd0eXBlOicsIGNoYW5nZS50eXBlKTsKCiAgICAgIC8vbGV0IG9sZFZhbHVlID0gY2hhbmdlLm9sZFZhbHVlOwogICAgICB2YXIgbmV3VmFsdWUgPSBvYmpbY2hhbmdlLm5hbWVdOwoKICAgICAgLy8gY29uc29sZS5pbmZvKGNoYW5nZS50eXBlICsgJyB8IEZpZWxkOiAnICsgZmllbGRTdHJpbmcgKyAnIHwgTmV3IFZhbHVlOicsIEpTT04uc3RyaW5naWZ5KG5ld1ZhbHVlKSwgZmllbGRTdHJpbmcuaW5jbHVkZXMoJ2xlbmd0aCcpKTsKCiAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ3VwZGF0ZScgJiYgIWZpZWxkU3RyaW5nLmluY2x1ZGVzKCcubGVuZ3RoJykpIHsKICAgICAgICB0aGlzLl9maXJlRXZlbnQoewogICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuVVBEQVRFLAogICAgICAgICAgb1R5cGU6IG9ialR5cGUsCiAgICAgICAgICBmaWVsZDogZmllbGRTdHJpbmcsCiAgICAgICAgICBkYXRhOiBuZXdWYWx1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdhZGQnKSB7CiAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLkFERCwKICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nLAogICAgICAgICAgZGF0YTogbmV3VmFsdWUKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAnZGVsZXRlJykgewogICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5SRU1PVkUsCiAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnZGF0YScsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7CiAgICB9CiAgfV0pOwogIHJldHVybiBTeW5jT2JqZWN0Owp9KCk7Cgp2YXIgQ2hhbmdlVHlwZSA9IGV4cG9ydHMuQ2hhbmdlVHlwZSA9IHsgVVBEQVRFOiAndXBkYXRlJywgQUREOiAnYWRkJywgUkVNT1ZFOiAncmVtb3ZlJyB9Owp2YXIgT2JqZWN0VHlwZSA9IGV4cG9ydHMuT2JqZWN0VHlwZSA9IHsgT0JKRUNUOiAnb2JqZWN0JywgQVJSQVk6ICdhcnJheScgfTsKZXhwb3J0cy5kZWZhdWx0ID0gU3luY09iamVjdDsKCi8qKiovIH0pLAovKiAxMjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX2dldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMSk7Cgp2YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFByb3RvdHlwZU9mKTsKCnZhciBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTMpOwoKdmFyIF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsKICBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7CiAgdmFyIGRlc2MgPSAoMCwgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIuZGVmYXVsdCkob2JqZWN0LCBwcm9wZXJ0eSk7CgogIGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsKICAgIHZhciBwYXJlbnQgPSAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShvYmplY3QpOwoKICAgIGlmIChwYXJlbnQgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOwogICAgfQogIH0gZWxzZSBpZiAoInZhbHVlIiBpbiBkZXNjKSB7CiAgICByZXR1cm4gZGVzYy52YWx1ZTsKICB9IGVsc2UgewogICAgdmFyIGdldHRlciA9IGRlc2MuZ2V0OwoKICAgIGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQoKICAgIHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDEyNiAqLywKLyogMTI3ICovLAovKiAxMjggKi8sCi8qIDEyOSAqLywKLyogMTMwICovLAovKiAxMzEgKi8sCi8qIDEzMiAqLywKLyogMTMzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX3Byb21pc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcyKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCnZhciBfYXNzaWduID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTEpOwoKdmFyIF9hc3NpZ24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXNzaWduKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTIyKTsKCnZhciBfRGF0YU9iamVjdFJlcG9ydGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RSZXBvcnRlcik7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCnZhciBfRGF0YU9iamVjdE9ic2VydmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RPYnNlcnZlcik7Cgp2YXIgX0RhdGFQcm92aXNpb25hbCA9IF9fd2VicGFja19yZXF1aXJlX18oMTQ4KTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFQcm92aXNpb25hbCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqDQoqIFRoZSBtYWluIGNsYXNzIGZvciB0aGUgc3luY2hlciBwYWNrYWdlLg0KKiBUaGUgU3luY2hlciBpcyBhIHNpbmdsZXRvbiBjbGFzcyBwZXIgSHlwZXJ0eS9VUkwgYW5kIGl0IGlzIHRoZSBvd25lciBvZiBhbGwgY3JlYXRlZCBEYXRhIFN5bmMgT2JqZWN0cyBhY2NvcmRpbmcgdG8gdGhlIFJlcG9ydGVyIC0gT2JzZXJ2ZXIgcGF0dGVybi4NCiogTWFpbiBmdW5jdGlvbmFsaXR5IGlzIHRvIGNyZWF0ZSByZXBvcnRlcnMgYW5kIHRvIHN1YnNjcmliZSB0byBleGlzdGluZyBvbmVzLg0KKi8KLyoqDQoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQ0KKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRA0KKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wNCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBDQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcNCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElODQoqDQoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuDQoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KKg0KKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KKg0KKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KKiovCnZhciBTeW5jaGVyID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUNCiAgX293bmVyOiBVUkwNCiAgX2J1czogTWluaUJ1cw0KICAgIF9zdWJVUkw6IFVSTA0KICAgIF9yZXBvcnRlcnM6IDx1cmw6IERhdGFPYmplY3RSZXBvcnRlcj4NCiAgX29ic2VydmVyczogPHVybDogRGF0YU9iamVjdE9ic2VydmVyPg0KICBfcHJvdmlzaW9uYWxzOiA8dXJsOiBEYXRhUHJvdmlzaW9uYWw+DQogICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQ0KICBfb25Ob3RpZmljYXRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQNCiAgX29uUmVzdW1lOiAoZXZlbnQpID0+IHZvaWQNCiAgKi8KCiAgLyoqDQogICogQ29uc3RydWN0b3IgdGhhdCBzaG91bGQgYmUgdXNlZCBieSB0aGUgSHlwZXJ0eSBvd25lcg0KICAqIEBwYXJhbSB7SHlwZXJ0eVVSTH0gb3duZXIgLSBIeXBlcnR5IFVSTCBvd25lci4gQW4gVVJMIGFsbG9jYXRlZCBieSB0aGUgcnVudGltZSB0aGF0IHVuaXF1ZWx5IGlkZW50aWZpZXMgdGhlIEh5cGVydHkuDQogICogQHBhcmFtIHtNaW5pQnVzfSBidXMgLSBBbiBpbnN0YW5jZSBvZiB0aGUgTWluaUJ1cyBwcm92aWRlZCBpbiB0aGUgc2FuZGJveC4gV2hlbiBhbiBvYmplY3QgKFJlcG9ydGVyIG9yIE9ic2VydmVkKSBpcyBjcmVhdGVkLCB0aGUgU3luY2hlck1hbmFnZXIgd2lsbCBhZGQgYSBsaXN0ZW5lciBpbiB0aGUgTWluaUJ1cyB0byByZWNlaXZlL3NlbmQgTWVzc2FnZXMgb2YgdGhhdCBvYmplY3QuDQogICogQHBhcmFtIHtKU09OfSBjb25maWcgLSBDb25maWd1cmF0aW9uIGRhdGEuIFRoZSBvbmx5IHJlcXVpcmVkIGZpZWxkIGZvciBub3cgaXMgdGhlIHJ1bnRpbWVVUkwuDQogICovCiAgZnVuY3Rpb24gU3luY2hlcihvd25lciwgYnVzLCBjb25maWcpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFN5bmNoZXIpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX293bmVyID0gb3duZXI7CiAgICBfdGhpcy5fYnVzID0gYnVzOwoKICAgIF90aGlzLl9zdWJVUkwgPSBjb25maWcucnVudGltZVVSTCArICcvc20nOwoKICAgIF90aGlzLl9yZXBvcnRlcnMgPSB7fTsKICAgIF90aGlzLl9vYnNlcnZlcnMgPSB7fTsKICAgIF90aGlzLl9wcm92aXNpb25hbHMgPSB7fTsKCiAgICBidXMuYWRkTGlzdGVuZXIob3duZXIsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZgogICAgICBpZiAobXNnLmZyb20gIT09IG93bmVyKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbU3luY2hlcl0gU3luY2hlci1SQ1Y6ICcsIG1zZywgX3RoaXMpOwogICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgIGNhc2UgJ2ZvcndhcmQnOgogICAgICAgICAgICBfdGhpcy5fb25Gb3J3YXJkKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdjcmVhdGUnOgogICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVDcmVhdGUobXNnKTticmVhazsKICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAgIF90aGlzLl9vblJlbW90ZURlbGV0ZShtc2cpO2JyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQoKICAvKioNCiAgKiBUaGUgb3duZXIgb2YgdGhlIFN5bmNoZXIgYW5kIGFsbCBjcmVhdGVkIHJlcG9ydGVycy4NCiAgKiBAdHlwZSB7SHlwZXJ0eVVSTH0NCiAgKi8KCgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKFN5bmNoZXIsIFt7CiAgICBrZXk6ICdjcmVhdGUnLAoKCiAgICAvKioNCiAgICAqIFJlcXVlc3QgYSBEYXRhT2JqZWN0UmVwb3J0ZXIgY3JlYXRpb24uIFRoZSBVUkwgd2lsbCBiZSBiZSByZXF1ZXN0ZWQgYnkgdGhlIGFsbG9jYXRpb24gbWVjaGFuaXNtLg0KICAgICogQHBhcmFtICB7U2NoZW1hVVJMfSBzY2hlbWEgLSBIeXBlcnR5IENhdGFsb2d1ZSBVUkwgYWRkcmVzcyB0aGF0IGNhbiBiZSB1c2VkIHRvIHJldHJpZXZlIHRoZSBKU09OLVNjaGVtYSBkZXNjcmliaW5nIHRoZSBEYXRhIE9iamVjdCBzY2hlbWENCiAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIC0gTGlzdCBvZiBoeXBlcnRpZXMgdGhhdCBhcmUgcHJlLWF1dGhvcml6ZWQgZm9yIHN1YnNjcmlwdGlvbg0KICAgICogQHBhcmFtICB7SlNPTn0gaW5pdGlhbERhdGEgLSBJbml0aWFsIGRhdGEgb2YgdGhlIHJlcG9ydGVyDQogICAgKiBAcGFyYW0gIHtib29sZWFufSBzdG9yZSAtIChPcHRpb25hbCkgaWYgdHJ1ZSwgb2JqZWN0IHdpbGwgYmUgc3RvcmVkIGJ5IHRoZSBydW50aW1lDQogICAgKiBAcGFyYW0gIHtib29sZWFufSBwMnAgLSAoT3B0aW9uYWwpIGlmIHRydWUsIGRhdGEgc3luY2hyb25pc2F0aW9uIHN0cmVhbSB3aWxsIHVzZSBwMnAgY29ubmVjdGlvbiBhcyBtdWNoIGFzIHBvc3NpYmxlDQogICAgKiBAcGFyYW0gIHtNZXNzYWdlQm9keUlkZW50aXR5fSBpZGVudGl0eSAtIChvcHRpb25hbCkgaWRlbnRpdHkgZGF0YSB0byBiZSBhZGRlZCB0byBpZGVudGl0eSB0aGUgdXNlciByZXBvcnRlci4gVG8gYmUgdXNlZCBmb3IgbGVnYWN5IGlkZW50aXRpZXMuDQogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IFJlcG9ydGVyLiBUaGUgcmVwb3J0ZXIgY2FuIGJlIGFjY2VwdGVkIG9yIHJlamVjdGVkIGJ5IHRoZSBQRVANCiAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZShzY2hlbWEsIG9ic2VydmVycywgaW5pdGlhbERhdGEpIHsKICAgICAgdmFyIHN0b3JlID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKICAgICAgdmFyIHAycCA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogZmFsc2U7CiAgICAgIHZhciBpZGVudGl0eSA9IGFyZ3VtZW50c1s1XTsKCgogICAgICBpZiAoIXNjaGVtYSkgdGhyb3cgRXJyb3IoJ1tTeW5jaGVyIC0gQ3JlYXRlXSAtIFlvdSBuZWVkIHNwZWNpZnkgdGhlIGRhdGEgb2JqZWN0IHNjaGVtYScpOwogICAgICBpZiAoIW9ic2VydmVycykgdGhyb3cgRXJyb3IoJ1tTeW5jaGVyIC0gQ3JlYXRlXSAtVGhlIG9ic2VydmVycyBzaG91bGQgYmUgZGVmaW5lZCcpOwogICAgICBpZiAoIWluaXRpYWxEYXRhKSB0aHJvdyBFcnJvcignW1N5bmNoZXIgLSBDcmVhdGVdIC0gWW91IGluaXRpYWxEYXRhIHNob3VsZCBiZSBkZWZpbmVkJyk7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgY3JpdGVyaWEgPSB7fTsKCiAgICAgIGNyaXRlcmlhLnAycCA9IHAycDsKICAgICAgY3JpdGVyaWEuc3RvcmUgPSBzdG9yZTsKICAgICAgY3JpdGVyaWEuc2NoZW1hID0gc2NoZW1hOwogICAgICBjcml0ZXJpYS5vYnNlcnZlcnMgPSBvYnNlcnZlcnM7CiAgICAgIGNyaXRlcmlhLmluaXRpYWxEYXRhID0gaW5pdGlhbERhdGE7CgogICAgICBpZiAoaWRlbnRpdHkpIHsKICAgICAgICBjcml0ZXJpYS5pZGVudGl0eSA9IGlkZW50aXR5OwogICAgICB9CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiBmYWxzZSB9KTsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUgUmVwb3J0ZXIgLSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKICAgICAgcmV0dXJuIF90aGlzLl9jcmVhdGUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKg0KICAgICogUmVxdWVzdCBhIERhdGFPYmplY3RSZXBvcnRlciBjcmVhdGlvbi4gVGhlIFVSTCB3aWxsIGJlIGJlIHJlcXVlc3RlZCBieSB0aGUgYWxsb2NhdGlvbiBtZWNoYW5pc20uDQogICAgKiBAcGFyYW0gIHtPYmplY3R9IGNyaXRlcmlhIC0gKG9wdGlvbmFsKSBpZGVudGl0eSBkYXRhIHRvIGJlIGFkZGVkIHRvIGlkZW50aXR5IHRoZSB1c2VyIHJlcG9ydGVyLiBUbyBiZSB1c2VkIGZvciBsZWdhY3kgaWRlbnRpdGllcy4NCiAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdFJlcG9ydGVyPltdfSBSZXR1cm4gYSBwcm9taXNlIHdpdGggYSBsaXN0IG9mIERhdGFPYmplY3RSZXBvcnRlciB0byBiZSByZXN1bWVkOw0KICAgICovCgogIH0sIHsKICAgIGtleTogJ3Jlc3VtZVJlcG9ydGVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzdW1lUmVwb3J0ZXJzKGNyaXRlcmlhKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSByZXN1bWUgUmVwb3J0ZXIgLSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogdHJ1ZSB9KTsKCiAgICAgIHJldHVybiBfdGhpcy5fcmVzdW1lQ3JlYXRlKGNyaXRlcmlhKTsKICAgIH0KCiAgICAvKioNCiAgICAqIFJlcXVlc3QgYSBzdWJzY3JpcHRpb24gdG8gYW4gZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0Lg0KICAgICogQHBhcmFtIHtTY2hlbWFVUkx9IHNjaGVtYSAtIEh5cGVydHkgQ2F0YWxvZ3VlIFVSTCBhZGRyZXNzIHRoYXQgY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIEpTT04tU2NoZW1hIGRlc2NyaWJpbmcgdGhlIERhdGEgT2JqZWN0IHNjaGVtYQ0KICAgICogQHBhcmFtIHtPYmplY3RVUkx9IG9ialVSTCAtIEFkZHJlc3Mgb2YgdGhlIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdCB0byBiZSBvYnNlcnZlZA0KICAgICogQHBhcmFtIHtCb29sZWFufSBbc3RvcmU9ZmFsc2VdIC0gU2F2ZSB0aGUgc3Vic2NyaXB0aW9uIG9uIHRoZSBTeW5jaGVyIE1hbmFnZXIgZm9yIGZ1cnRoZXIgcmVzdW1lIChEZWZhdWx0IGlzIGZhbHNlKQ0KICAgICogQHBhcmFtIHtCb29sZWFufSBbcDJwPWZhbHNlXSAtIEluZm8gYWJvdXQgaWYgc2hvdWxkIHVzZSBwMnAgY29ubmVjdGlvbiAoRGVmYXVsdCBpcyBmYWxzZSkNCiAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW211dHVhbD10cnVlXSAtIEluZm8gYWJvdXQgaWYgbWVzc2FnZXMgb2YgdGhpcyBvYmplY3Qgc2hvdWxkIGJlIGVuY3J5cHRlZCAoRGVmYXVsdCBpcyB0cnVlKQ0KICAgICogQHBhcmFtICB7TWVzc2FnZUJvZHlJZGVudGl0eX0gaWRlbnRpdHkgLSAob3B0aW9uYWwpIGlkZW50aXR5IGRhdGEgdG8gYmUgYWRkZWQgdG8gaWRlbnRpdHkgdGhlIHVzZXIgcmVwb3J0ZXIuIFRvIGJlIHVzZWQgZm9yIGxlZ2FjeSBpZGVudGl0aWVzLg0KICAgICogQHJldHVybiB7UHJvbWlzZTxEYXRhT2JqZWN0T2JzZXJ2ZXI+fSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBvYnNlcnZlci4gSXQncyBhc3NvY2lhdGVkIHdpdGggdGhlIHJlcG9ydGVyLg0KICAgICovCgogIH0sIHsKICAgIGtleTogJ3N1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3Vic2NyaWJlKHNjaGVtYSwgb2JqVVJMKSB7CiAgICAgIHZhciBzdG9yZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgIHZhciBwMnAgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgbXV0dWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB0cnVlOwogICAgICB2YXIgaWRlbnRpdHkgPSBhcmd1bWVudHNbNV07CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgY3JpdGVyaWEgPSB7fTsKCiAgICAgIGNyaXRlcmlhLnAycCA9IHAycDsKICAgICAgY3JpdGVyaWEuc3RvcmUgPSBzdG9yZTsKICAgICAgY3JpdGVyaWEuc2NoZW1hID0gc2NoZW1hOwoKICAgICAgY3JpdGVyaWEucmVzb3VyY2UgPSBvYmpVUkw7CiAgICAgIGlmIChpZGVudGl0eSkgewogICAgICAgIGNyaXRlcmlhLmlkZW50aXR5ID0gaWRlbnRpdHk7CiAgICAgIH0KCiAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgY3JpdGVyaWEubXV0dWFsID0gbXV0dWFsOwoKICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gc3Vic2NyaWJlXSAtIHN1YnNjcmliZSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogZmFsc2UgfSk7CgogICAgICByZXR1cm4gX3RoaXMuX3N1YnNjcmliZShjcml0ZXJpYSk7CiAgICB9CgogICAgLyoqDQogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4NCiAgICAqIEBwYXJhbSB7Y3JpdGVyaWF9IGNyaXRlcmlhIC0gSW5mb3JtYXRpb24gdG8gZGlzY292ZXJ5IHRoZSBvYnNlcnZlciBvYmplY3QNCiAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdE9ic2VydmVyPn0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgb2JzZXJ2ZXIuIEl0J3MgYXNzb2NpYXRlZCB3aXRoIHRoZSByZXBvcnRlci4NCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXN1bWVPYnNlcnZlcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZU9ic2VydmVycyhjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgX2NyaXRlcmlhID0gY3JpdGVyaWEgfHwge307CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoX2NyaXRlcmlhLCB7IHJlc3VtZTogdHJ1ZSB9KTsKCiAgICAgIHJldHVybiBfdGhpcy5fcmVzdW1lU3Vic2NyaWJlKF9jcml0ZXJpYSk7CiAgICB9CgogICAgLyoqDQogICAgKiBSZXF1ZXN0IGEgcmVhZCBhY3Rpb24gb24gdGhlIHJlcG9ydGVyIG9iamVjdA0KICAgICogQHBhcmFtIHtPYmplY3RVUkx9IG9ialVSTCAtIFVSTCBvZiB0aGUgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIHJlYWQNCiAgICAqIEByZXR1cm4ge1Byb21pc2U8T2JqZWN0Pn0gUmV0dXJuIFByb21pc2UgdG8gbGFzdCBhdmFpbGFibGUgZGF0YSBvZiB0aGUgcmVwb3J0ZXINCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZWFkJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZWFkKG9ialVSTCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byByZXBvcnRlciBvYmplY3QgKG1heWJlIHRoZXJlIGlzIG5vIGxpc3RlbmVyIGF2YWlsYWJsZSwgc28gaXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIE1lc3NhZ2VCdXMgLT4gcmVzb2x2ZSkKICAgICAgLy93aWxsIHJlYWNoIHRoZSByZW1vdGUgb2JqZWN0IGluIERhdGFPYmplY3RSZXBvcnRlciAtPiBfb25SZWFkCiAgICAgIHZhciByZWFkTXNnID0gewogICAgICAgIHR5cGU6ICdyZWFkJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogb2JqVVJMCiAgICAgIH07CgogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlYWRNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5sb2coJ3JlYWQtcmVzcG9uc2U6ICcsIHJlcGx5KTsKICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICByZXNvbHZlKHJlcGx5LmJvZHkudmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKg0KICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgY3JlYXRlIGFuZCBkZWxldGUgZXZlbnRzIG9mIHJlbW92ZSBSZXBvcnRlciBvYmplY3RzLg0KICAgICogVGhpcyBpcyByZWxlYXRlZCB0byB0aGUgbWVzc2FnZW5zIHNlbnQgYnkgY3JlYXRlIHRvIHRoZSBvYnNlcnZlcnMgSHlwZXJ0eSBhcnJheS4NCiAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sNCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbk5vdGlmaWNhdGlvbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Ob3RpZmljYXRpb24oY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2NyZWF0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZShjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIHJlc3VtZSA9IGNyaXRlcmlhLnJlc3VtZTsKICAgICAgICB2YXIgaW5pdGlhbERhdGEgPSBjcml0ZXJpYS5pbml0aWFsRGF0YSB8fCB7fTsKICAgICAgICB2YXIgc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwoKICAgICAgICBpbml0aWFsRGF0YS5yZXBvcnRlciA9IF90aGlzLl9vd25lcjsKICAgICAgICBpbml0aWFsRGF0YS5zY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CgogICAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uQ3JlYXRlCiAgICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CiAgICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N1YlVSTCwKICAgICAgICAgIGJvZHk6IHsgcmVzdW1lOiByZXN1bWUgfQogICAgICAgIH07CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV06ICcsIGNyaXRlcmlhLCByZXF1ZXN0TXNnKTsKCiAgICAgICAgcmVxdWVzdE1zZy5ib2R5LnZhbHVlID0gaW5pdGlhbERhdGE7CiAgICAgICAgcmVxdWVzdE1zZy5ib2R5LnJlcG9ydGVyID0gX3RoaXMuX293bmVyOwogICAgICAgIHJlcXVlc3RNc2cuYm9keS5zY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CgogICAgICAgIGlmIChjcml0ZXJpYS5wMnApIHJlcXVlc3RNc2cuYm9keS5wMnAgPSBjcml0ZXJpYS5wMnA7CiAgICAgICAgaWYgKGNyaXRlcmlhLnN0b3JlKSByZXF1ZXN0TXNnLmJvZHkuc3RvcmUgPSBjcml0ZXJpYS5zdG9yZTsKICAgICAgICBpZiAoY3JpdGVyaWEub2JzZXJ2ZXJzKSByZXF1ZXN0TXNnLmJvZHkuYXV0aG9yaXNlID0gY3JpdGVyaWEub2JzZXJ2ZXJzOwogICAgICAgIGlmIChjcml0ZXJpYS5pZGVudGl0eSkgcmVxdWVzdE1zZy5ib2R5LmlkZW50aXR5ID0gY3JpdGVyaWEuaWRlbnRpdHk7CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUgbWVzc2FnZTogJywgcmVxdWVzdE1zZyk7CgogICAgICAgIC8vcmVxdWVzdCBjcmVhdGUgdG8gdGhlIGFsbG9jYXRpb24gc3lzdGVtLiBDYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIFBvbGljeUVuZ2luZS4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gYWNjZXB0ZWQKICAgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgc2NoZW1hLCAnb24nLCBpbml0aWFsRGF0YSwgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CiAgICAgICAgICAgIF90aGlzLl9yZXBvcnRlcnNbb2JqVVJMXSA9IG5ld09iajsKCiAgICAgICAgICAgIHJlc29sdmUobmV3T2JqKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gcmVqZWN0ZWQKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZXN1bWVDcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZXN1bWVDcmVhdGUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIHJlc3VtZSA9IGNyaXRlcmlhLnJlc3VtZTsKICAgICAgICB2YXIgaW5pdGlhbERhdGEgPSBjcml0ZXJpYS5pbml0aWFsRGF0YSB8fCB7fTsKCiAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKICAgICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keTogeyByZXN1bWU6IHJlc3VtZSB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXTogJywgY3JpdGVyaWEsIHJlcXVlc3RNc2cpOwoKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUgPSBpbml0aWFsRGF0YTsKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUucmVwb3J0ZXIgPSBfdGhpcy5fb3duZXI7CgogICAgICAgIGlmIChjcml0ZXJpYS5wMnApIHJlcXVlc3RNc2cuYm9keS5wMnAgPSBjcml0ZXJpYS5wMnA7CiAgICAgICAgaWYgKGNyaXRlcmlhLnN0b3JlKSByZXF1ZXN0TXNnLmJvZHkuc3RvcmUgPSBjcml0ZXJpYS5zdG9yZTsKICAgICAgICBpZiAoY3JpdGVyaWEub2JzZXJ2ZXJzKSByZXF1ZXN0TXNnLmJvZHkuYXV0aG9yaXNlID0gY3JpdGVyaWEub2JzZXJ2ZXJzOwogICAgICAgIGlmIChjcml0ZXJpYS5pZGVudGl0eSkgcmVxdWVzdE1zZy5ib2R5LmlkZW50aXR5ID0gY3JpdGVyaWEuaWRlbnRpdHk7CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSByZXN1bWUgbWVzc2FnZTogJywgcmVxdWVzdE1zZyk7CgogICAgICAgIC8vcmVxdWVzdCBjcmVhdGUgdG8gdGhlIGFsbG9jYXRpb24gc3lzdGVtLiBDYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIFBvbGljeUVuZ2luZS4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXN1bWVkLXJlc3BvbnNlOiAnLCByZXBseSk7CiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKCiAgICAgICAgICAgIHZhciBsaXN0T2ZSZXBvcnRlcnMgPSByZXBseS5ib2R5LnZhbHVlOwoKICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggaW4gbGlzdE9mUmVwb3J0ZXJzKSB7CgogICAgICAgICAgICAgIHZhciBkYXRhT2JqZWN0ID0gbGlzdE9mUmVwb3J0ZXJzW2luZGV4XTsKCiAgICAgICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiBhY2NlcHRlZAogICAgICAgICAgICAgIHZhciBvYmpVUkwgPSBkYXRhT2JqZWN0LnJlc291cmNlOwogICAgICAgICAgICAgIHZhciBzY2hlbWEgPSBkYXRhT2JqZWN0LnNjaGVtYTsKICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gZGF0YU9iamVjdC5zdGF0dXMgfHwgJ29uJzsKICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5SZXNvdXJjZXMgPSBkYXRhT2JqZWN0LmNoaWxkcmVuUmVzb3VyY2VzOwoKICAgICAgICAgICAgICAvLyBpbml0aWFsRGF0YS5jaGlsZHJlbnMgPSBkZWVwQ2xvbmUoZGF0YU9iamVjdC5jaGlsZHJlbnMpIHx8IHt9OwogICAgICAgICAgICAgIC8vIGluaXRpYWxEYXRhID0gZGVlcENsb25lKGRhdGFPYmplY3QuZGF0YSkgfHwge307CiAgICAgICAgICAgICAgdmFyIGluaXQgPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoZGF0YU9iamVjdC5kYXRhKSB8fCB7fTsKICAgICAgICAgICAgICB2YXIgY2hpbGRyZW5zID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGRhdGFPYmplY3QuY2hpbGRyZW5zKSB8fCB7fTsKCiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXN1bWVkLWRhdGFPYmplY3RSZXBvcnRlcicsIG9ialVSTCwgc3RhdHVzLCBpbml0KTsKCiAgICAgICAgICAgICAgdmFyIG5ld09iaiA9IG5ldyBfRGF0YU9iamVjdFJlcG9ydGVyMi5kZWZhdWx0KF90aGlzLCBvYmpVUkwsIHNjaGVtYSwgc3RhdHVzLCBpbml0LCBjaGlsZHJlblJlc291cmNlcywgZmFsc2UsIHRydWUpOwogICAgICAgICAgICAgIG5ld09iai5yZXN1bWVDaGlsZHJlbnMoY2hpbGRyZW5zKTsKICAgICAgICAgICAgICBfdGhpcy5fcmVwb3J0ZXJzW29ialVSTF0gPSBuZXdPYmo7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuX3JlcG9ydGVycyk7CiAgICAgICAgICAgIGlmIChfdGhpczIuX29uUmVwb3J0ZXJzUmVzdW1lKSBfdGhpczIuX29uUmVwb3J0ZXJzUmVzdW1lKF90aGlzMi5fcmVwb3J0ZXJzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gcmVqZWN0ZWQKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zdWJzY3JpYmUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsU3Vic2NyaWJlCiAgICAgICAgdmFyIHN1YnNjcmliZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keToge30KICAgICAgICB9OwoKICAgICAgICAvLyBIeXBlcnR5IHJlcXVlc3QgdG8gYmUgYW4gT2JzZXJ2ZXIKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNoeXBlcnR5LXJlcXVlc3QtdG8tYmUtYW4tb2JzZXJ2ZXIKCiAgICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIHRoZSBzYW1lIEh5cGVydHkgVVJMCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLXRoZS1zYW1lLWh5cGVydHktdXJsCgogICAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciBhIGNlcnRhaW4gdXNlciBhbmQgZGF0YSBzY2hlbWEgaW5kZXBlbmRlbnRseSBvZiB0aGUgSHlwZXJ0eSBVUkwuCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLWEtY2VydGFpbi11c2VyLWFuZC1kYXRhLXNjaGVtYS1pbmRlcGVuZGVudGx5LW9mLXRoZS1oeXBlcnR5LXVybAogICAgICAgIGlmIChjcml0ZXJpYSkgewogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdwMnAnKSkgc3Vic2NyaWJlTXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzdG9yZScpKSBzdWJzY3JpYmVNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzY2hlbWEnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdpZGVudGl0eScpKSBzdWJzY3JpYmVNc2cuYm9keS5pZGVudGl0eSA9IGNyaXRlcmlhLmlkZW50aXR5OwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZScpKSBzdWJzY3JpYmVNc2cuYm9keS5yZXNvdXJjZSA9IGNyaXRlcmlhLnJlc291cmNlOwogICAgICAgIH0KCiAgICAgICAgc3Vic2NyaWJlTXNnLmJvZHkucmVzdW1lID0gY3JpdGVyaWEucmVzdW1lOwoKICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgdmFyIG11dHVhbEF1dGhlbnRpY2F0aW9uID0gY3JpdGVyaWEubXV0dWFsOwogICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsJykpIHN1YnNjcmliZU1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUgbWVzc2FnZTogJywgY3JpdGVyaWEsIHN1YnNjcmliZU1zZyk7CgogICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KICAgICAgICAvL1Byb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICAgICAgICAvL2ZvciBtb3JlIGluZm8gc2VlIHRoZSBEYXRhUHJvdmlzaW9uYWwgY2xhc3MgZG9jdW1lbnRhdGlvbi4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gc3Vic2NyaWJlLXJlc3BvbnNlOiAnLCByZXBseSk7CgogICAgICAgICAgdmFyIHNjaGVtYSA9IHJlcGx5LmJvZHkuc2NoZW1hOwogICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgdmFyIG5ld1Byb3Zpc2lvbmFsID0gX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKICAgICAgICAgIGlmIChuZXdQcm92aXNpb25hbCkgbmV3UHJvdmlzaW9uYWwuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlIDwgMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YVByb3Zpc2lvbmFsOiAnLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzLCBvYmpVUkwpOwogICAgICAgICAgICBuZXdQcm92aXNpb25hbCA9IG5ldyBfRGF0YVByb3Zpc2lvbmFsMi5kZWZhdWx0KF90aGlzLl9vd25lciwgb2JqVVJMLCBfdGhpcy5fYnVzLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKICAgICAgICAgICAgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdID0gbmV3UHJvdmlzaW9uYWw7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YSBPYmplY3QgT2JzZXJ2ZXI6ICcsIHJlcGx5LCBfdGhpcy5fcHJvdmlzaW9uYWxzKTsKCiAgICAgICAgICAgIHZhciBpbml0aWFsRGF0YSA9IHJlcGx5LmJvZHkudmFsdWU7CiAgICAgICAgICAgIGlmICghaW5pdGlhbERhdGEuaGFzT3duUHJvcGVydHkoJ2NoaWxkcmVucycpKSB7CiAgICAgICAgICAgICAgaW5pdGlhbERhdGEuY2hpbGRyZW5zID0ge307CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFpbml0aWFsRGF0YS5oYXNPd25Qcm9wZXJ0eSgnZGF0YScpKSB7CiAgICAgICAgICAgICAgaW5pdGlhbERhdGEuZGF0YSA9IHt9OwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL1RPRE86IG11dHVhbEF1dGhlbnRpY2F0aW9uIEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgICAgIHZhciBuZXdPYmogPSBuZXcgX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdChfdGhpcywgb2JqVVJMLCBzY2hlbWEsICdvbicsIGluaXRpYWxEYXRhLCBuZXdQcm92aXNpb25hbC5jaGlsZHJlbiwgcmVwbHkuYm9keS52ZXJzaW9uLCBtdXR1YWxBdXRoZW50aWNhdGlvbik7CiAgICAgICAgICAgIF90aGlzLl9vYnNlcnZlcnNbb2JqVVJMXSA9IG5ld09iajsKCiAgICAgICAgICAgIHJlc29sdmUobmV3T2JqKTsKICAgICAgICAgICAgbmV3UHJvdmlzaW9uYWwuYXBwbHkobmV3T2JqKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVzdW1lU3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVzdW1lU3Vic2NyaWJlKGNyaXRlcmlhKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsU3Vic2NyaWJlCiAgICAgICAgdmFyIHN1YnNjcmliZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keToge30KICAgICAgICB9OwoKICAgICAgICAvLyBIeXBlcnR5IHJlcXVlc3QgdG8gYmUgYW4gT2JzZXJ2ZXIKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNoeXBlcnR5LXJlcXVlc3QtdG8tYmUtYW4tb2JzZXJ2ZXIKCiAgICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIHRoZSBzYW1lIEh5cGVydHkgVVJMCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLXRoZS1zYW1lLWh5cGVydHktdXJsCgogICAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciBhIGNlcnRhaW4gdXNlciBhbmQgZGF0YSBzY2hlbWEgaW5kZXBlbmRlbnRseSBvZiB0aGUgSHlwZXJ0eSBVUkwuCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLWEtY2VydGFpbi11c2VyLWFuZC1kYXRhLXNjaGVtYS1pbmRlcGVuZGVudGx5LW9mLXRoZS1oeXBlcnR5LXVybAogICAgICAgIGlmIChjcml0ZXJpYSkgewogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdwMnAnKSkgc3Vic2NyaWJlTXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzdG9yZScpKSBzdWJzY3JpYmVNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzY2hlbWEnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdpZGVudGl0eScpKSBzdWJzY3JpYmVNc2cuYm9keS5pZGVudGl0eSA9IGNyaXRlcmlhLmlkZW50aXR5OwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZScpKSBzdWJzY3JpYmVNc2cuYm9keS5yZXNvdXJjZSA9IGNyaXRlcmlhLnJlc291cmNlOwogICAgICAgIH0KCiAgICAgICAgc3Vic2NyaWJlTXNnLmJvZHkucmVzdW1lID0gY3JpdGVyaWEucmVzdW1lOwoKICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgdmFyIG11dHVhbEF1dGhlbnRpY2F0aW9uID0gY3JpdGVyaWEubXV0dWFsOwogICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsJykpIHN1YnNjcmliZU1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUgbWVzc2FnZTogJywgY3JpdGVyaWEsIHN1YnNjcmliZU1zZyk7CgogICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KICAgICAgICAvL1Byb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICAgICAgICAvL2ZvciBtb3JlIGluZm8gc2VlIHRoZSBEYXRhUHJvdmlzaW9uYWwgY2xhc3MgZG9jdW1lbnRhdGlvbi4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gc3Vic2NyaWJlLXJlc3VtZWQtcmVzcG9uc2U6ICcsIHJlcGx5KTsKCiAgICAgICAgICB2YXIgb2JqVVJMID0gcmVwbHkuYm9keS5yZXNvdXJjZTsKCiAgICAgICAgICB2YXIgbmV3UHJvdmlzaW9uYWwgPSBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF07CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwogICAgICAgICAgaWYgKG5ld1Byb3Zpc2lvbmFsKSBuZXdQcm92aXNpb25hbC5fcmVsZWFzZUxpc3RlbmVycygpOwoKICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPCAyMDApIHsKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSByZXN1bWUgbmV3IERhdGFQcm92aXNpb25hbDogJywgcmVwbHksIG9ialVSTCk7CiAgICAgICAgICAgIG5ld1Byb3Zpc2lvbmFsID0gbmV3IF9EYXRhUHJvdmlzaW9uYWwyLmRlZmF1bHQoX3RoaXMuX293bmVyLCBvYmpVUkwsIF90aGlzLl9idXMsIHJlcGx5LmJvZHkuY2hpbGRyZW5SZXNvdXJjZXMpOwogICAgICAgICAgICBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF0gPSBuZXdQcm92aXNpb25hbDsKICAgICAgICAgIH0gZWxzZSBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKCiAgICAgICAgICAgIHZhciBsaXN0T2ZPYnNlcnZlcnMgPSByZXBseS5ib2R5LnZhbHVlOwoKICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggaW4gbGlzdE9mT2JzZXJ2ZXJzKSB7CgogICAgICAgICAgICAgIHZhciBkYXRhT2JqZWN0ID0gbGlzdE9mT2JzZXJ2ZXJzW2luZGV4XTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gUmVzdW1lIE9iamVjdCBPYnNlcnZlcjogJywgcmVwbHksIGRhdGFPYmplY3QsIF90aGlzLl9wcm92aXNpb25hbHMpOwoKICAgICAgICAgICAgICB2YXIgc2NoZW1hID0gZGF0YU9iamVjdC5zY2hlbWE7CiAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IGRhdGFPYmplY3Quc3RhdHVzIHx8ICdvbic7CiAgICAgICAgICAgICAgdmFyIF9vYmpVUkwgPSBkYXRhT2JqZWN0LnJlc291cmNlOwogICAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gZGF0YU9iamVjdC52ZXJzaW9uIHx8IDA7CiAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuUmVzb3VyY2VzID0gZGF0YU9iamVjdC5jaGlsZHJlblJlc291cmNlczsKCiAgICAgICAgICAgICAgdmFyIGluaXRpYWxEYXRhID0ge307CiAgICAgICAgICAgICAgaW5pdGlhbERhdGEuY2hpbGRyZW5zID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGRhdGFPYmplY3QuY2hpbGRyZW5zKSB8fCB7fTsKICAgICAgICAgICAgICBpbml0aWFsRGF0YS5kYXRhID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGRhdGFPYmplY3QuZGF0YSkgfHwge307CgogICAgICAgICAgICAgIC8vVE9ETzogbXV0dWFsQXV0aGVudGljYXRpb24gRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSByZXN1bWUgc3Vic2NyaWJlXSAtIGNyZWF0ZSBuZXcgZGF0YU9iamVjdDogJywgc3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5SZXNvdXJjZXMsIHZlcnNpb24pOwogICAgICAgICAgICAgIHZhciBuZXdPYmogPSBuZXcgX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdChfdGhpcywgX29ialVSTCwgc2NoZW1hLCBzdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlblJlc291cmNlcywgdmVyc2lvbiwgbXV0dWFsQXV0aGVudGljYXRpb24sIHRydWUpOwoKICAgICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXJzW19vYmpVUkxdID0gbmV3T2JqOwoKICAgICAgICAgICAgICBfdGhpcy5fcHJvdmlzaW9uYWxzW19vYmpVUkxdLmFwcGx5KG5ld09iaik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuX29ic2VydmVycyk7CgogICAgICAgICAgICBpZiAoX3RoaXMzLl9vbk9ic2VydmVyc1Jlc3VtZSkgX3RoaXMzLl9vbk9ic2VydmVyc1Jlc3VtZShfdGhpcy5fb2JzZXJ2ZXJzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIGxvY2FsIHJ1bnRpbWUgUmVwb3J0ZXJPYmplY3QgLT4gX29uUmVtb3RlU3Vic2NyaWJlCgogIH0sIHsKICAgIGtleTogJ19vbkZvcndhcmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgcmVwb3J0ZXIgPSBfdGhpcy5fcmVwb3J0ZXJzW21zZy5ib2R5LnRvXTsKICAgICAgcmVwb3J0ZXIuX29uRm9yd2FyZChtc2cpOwogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIFN5bmNoZXIgLT4gY3JlYXRlICh0aGlzIGlzIGFjdHVhbGx5IGFuIGludml0YXRpb24gdG8gc3Vic2NyaWJlKQoKICB9LCB7CiAgICBrZXk6ICdfb25SZW1vdGVDcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlbW90ZUNyZWF0ZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vcmVtb3ZlICIvc3Vic2NyaXB0aW9uIiBmcm9tIHRoZSBVUkwKICAgICAgdmFyIHJlc291cmNlID0gbXNnLmZyb20uc2xpY2UoMCwgLTEzKTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICBmcm9tOiBtc2cuYm9keS5zb3VyY2UsCiAgICAgICAgdXJsOiByZXNvdXJjZSwKICAgICAgICBzY2hlbWE6IG1zZy5ib2R5LnNjaGVtYSwKICAgICAgICB2YWx1ZTogbXNnLmJvZHkudmFsdWUsCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICBhY2s6IGZ1bmN0aW9uIGFjayh0eXBlKSB7CiAgICAgICAgICB2YXIgbFR5cGUgPSAyMDA7CiAgICAgICAgICBpZiAodHlwZSkgewogICAgICAgICAgICBsVHlwZSA9IHR5cGU7CiAgICAgICAgICB9CgogICAgICAgICAgLy9zZW5kIGFjayByZXNwb25zZSBtZXNzYWdlCiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogbFR5cGUgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmluZm8oJ1tTeW5jaGVyXSBOT1RJRklDQVRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RSZXBvcnRlciAtPiBkZWxldGUKCiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlRGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVEZWxldGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5ib2R5LnJlc291cmNlOwoKICAgICAgdmFyIG9iamVjdCA9IF90aGlzLl9vYnNlcnZlcnNbcmVzb3VyY2VdOwogICAgICBpZiAob2JqZWN0KSB7CiAgICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgICB1cmw6IHJlc291cmNlLAogICAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICAgIGFjazogZnVuY3Rpb24gYWNrKHR5cGUpIHsKICAgICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgICBpZiAodHlwZSkgewogICAgICAgICAgICAgIGxUeXBlID0gdHlwZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9UT0RPOiBhbnkgb3RoZXIgZGlmZmVyZW50IG9wdGlvbnMgZm9yIHRoZSByZWxlYXNlIHByb2Nlc3MsIGxpa2UgYWNjZXB0IGJ1dCBub3IgcmVsZWFzZSBsb2NhbD8KICAgICAgICAgICAgaWYgKGxUeXBlID09PSAyMDApIHsKICAgICAgICAgICAgICBvYmplY3QuZGVsZXRlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlLCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgICBfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgIGJvZHk6IHsgY29kZTogNDA0LCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICAvKioNCiAgICAqIENhbGxiYWNrIHN5c3RlbSB0byB0cmlnZ2VyIHRoZSByZXN1bWVkIHJlcG9ydGVycw0KICAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIC0gZnVuY3Rpb24gY2FsbGJhY2sgd2hpY2ggd2lsbCBiZSBpbnZva2VkDQogICAgKiBAcmV0dXJuIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0UmVwb3J0ZXI+fSBSZXR1cm4gb25lIG9iamVjdCB3aXRoIGFsbCByZXN1bWVkIHJlcG9ydGVyczsNCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblJlcG9ydGVyc1Jlc3VtZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZXBvcnRlcnNSZXN1bWUoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZXBvcnRlcnNSZXN1bWUgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvKioNCiAgICAqIENhbGxiYWNrIHN5c3RlbSB0byB0cmlnZ2VyIHRoZSByZXN1bWVkIG9ic2VydmVycw0KICAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIC0gZnVuY3Rpb24gY2FsbGJhY2sgd2hpY2ggd2lsbCBiZSBpbnZva2VkDQogICAgKiBAcmV0dXJuIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0T2JzZXJ2ZXI+fSBSZXR1cm4gb25lIG9iamVjdCB3aXRoIGFsbCByZXN1bWVkIG9ic2VydmVyczsNCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbk9ic2VydmVyc1Jlc3VtZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25PYnNlcnZlcnNSZXN1bWUoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25PYnNlcnZlcnNSZXN1bWUgPSBjYWxsYmFjazsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdvd25lcicsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX293bmVyOwogICAgfQoKICAgIC8qKg0KICAgICogQWxsIG93bmVkIHJlcG9ydGVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBjcmVhdGUNCiAgICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0UmVwb3J0ZXI+fQ0KICAgICovCgogIH0sIHsKICAgIGtleTogJ3JlcG9ydGVycycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3JlcG9ydGVyczsKICAgIH0KCiAgICAvKioNCiAgICAqIEFsbCBvd25lZCBvYnNlcnZlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgbG9jYWwgc3Vic2NyaXB0aW9uDQogICAgKiBAdHlwZSB7T2JqZWN0PFVSTCwgRGF0YU9iamVjdE9ic2VydmVyPn0NCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvYnNlcnZlcnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9vYnNlcnZlcnM7CiAgICB9CiAgfV0pOwogIHJldHVybiBTeW5jaGVyOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBTeW5jaGVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMzQgKi8sCi8qIDEzNSAqLywKLyogMTM2ICovLAovKiAxMzcgKi8sCi8qIDEzOCAqLywKLyogMTM5ICovLAovKiAxNDAgKi8sCi8qIDE0MSAqLywKLyogMTQyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gZXhwb3J0cy5EYXRhT2JqZWN0UmVwb3J0ZXIgPSBleHBvcnRzLlN5bmNoZXIgPSB1bmRlZmluZWQ7Cgp2YXIgX1N5bmNoZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzMyk7Cgp2YXIgX1N5bmNoZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfU3luY2hlcik7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTIyKTsKCnZhciBfRGF0YU9iamVjdFJlcG9ydGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RSZXBvcnRlcik7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCnZhciBfRGF0YU9iamVjdE9ic2VydmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RPYnNlcnZlcik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5TeW5jaGVyID0gX1N5bmNoZXIyLmRlZmF1bHQ7CmV4cG9ydHMuRGF0YU9iamVjdFJlcG9ydGVyID0gX0RhdGFPYmplY3RSZXBvcnRlcjIuZGVmYXVsdDsKZXhwb3J0cy5EYXRhT2JqZWN0T2JzZXJ2ZXIgPSBfRGF0YU9iamVjdE9ic2VydmVyMi5kZWZhdWx0OwoKLyoqKi8gfSksCi8qIDE0MyAqLywKLyogMTQ0ICovLAovKiAxNDUgKi8sCi8qIDE0NiAqLywKLyogMTQ3ICovLAovKiAxNDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqDQoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQ0KKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRA0KKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wNCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBDQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcNCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElODQoqDQoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuDQoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KKg0KKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KKg0KKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KKiovCgovKioNCiAqIEBhY2Nlc3MgcHJpdmF0ZQ0KICogVGhpcyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgY29sbGVjdGluZyBkZWx0YSBjaGFuZ2VzIGluIHJlbW90ZSBvYmplY3RzLCBiZWZvcmUgdGhlIHJlc3BvbnNlIG9mIHN1YnNjcmlwdGlvbiByZWFjaCB0aGUgb2JzZXJ2ZXIuDQogKiBJdCdzIHVzZWQgaW4gU3luY2hlciAtPiBzdWJzY3JpYmUuIFRoZSBmbG93IGlzIGRlZmluZWQgYXM6DQogKiAxLiAob2JzZXJ2ZXIpIC0tc3Vic2NyaWJlLS0+IChyZXBvcnRlcikNCiAqIDIuIChvYnNlcnZlcikgPC0tZGVsdGEgdXBkYXRlcy0tIChyZXBvcnRlcikNCiAqIDMuIChvYnNlcnZlcikgPC0tc3Vic2NyaWJlIHJlc3BvbnNlLS0gKHJlcG9ydGVyKQ0KICogVGhpcyBtZWFucyB0aGF0IHRoZXJlIGNvdWxkIGJlIGRlbHRhIHVwZGF0ZXMgdHJhbnNmZXJyZWQgYmVmb3JlIHRoZSBzdWJzY3JpcHRpb24gY29uZmlybWF0aW9uLg0KICogU2luY2UgdGhlcmUgaXMgbm8gRGF0YU9iamVjdE9ic2VydmVyIGJlZm9yZSB0aGUgdWJzY3JpcHRpb24gY29uZmlybWF0aW9uLCB0aGVyZSBzaG91bGQgYmUgc29tZSBvdGhlciBvYmplY3QgY29sbGVjdGluZyB0aGUgdXBkYXRlcy4NCiAqIFByb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4NCiAqLwp2YXIgRGF0YVByb3Zpc2lvbmFsID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUNCiAgX2NoaWxkcmVuTGlzdGVuZXJzOiBbTXNnTGlzdGVuZXJdDQogIF9saXN0ZW5lcjogTXNnTGlzdGVuZXINCiAgICBfY2hhbmdlczogW10NCiAgKi8KCiAgZnVuY3Rpb24gRGF0YVByb3Zpc2lvbmFsKG93bmVyLCB1cmwsIGJ1cywgY2hpbGRyZW4pIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFQcm92aXNpb25hbCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl91cmwgPSB1cmw7CiAgICBfdGhpcy5fYnVzID0gYnVzOwogICAgX3RoaXMuX2NoaWxkcmVuID0gY2hpbGRyZW47CgogICAgX3RoaXMuX2NoYW5nZXMgPSBbXTsKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YVByb3Zpc2lvbmFsLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YVByb3Zpc2lvbmFsLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgX3RoaXMuX2NoYW5nZXMucHVzaChtc2cpOwogICAgICB9KTsKCiAgICAgIC8qDQogICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTsNCiAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW4pIHsNCiAgICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IHVybCArICcvY2hpbGRyZW4vJzsNCiAgICAgICAgX3RoaXMuX2NoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7DQogICAgICAgICAgbGV0IGNoaWxkVVJMID0gY2hpbGRCYXNlVVJMICsgY2hpbGQ7DQogICAgICAgICAgbGV0IGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgKG1zZykgPT4gew0KICAgICAgICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZg0KICAgICAgICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikgew0KICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KICAgICAgICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpOw0KICAgICAgICB9KTsNCiAgICAgIH0qLwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKCiAgICAgIC8qX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7DQogICAgICAgIGxpc3RlbmVyLnJlbW92ZSgpOw0KICAgICAgfSk7Ki8KICAgIH0KICB9LCB7CiAgICBrZXk6ICdhcHBseScsCiAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHkob2JzZXJ2ZXIpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgX3RoaXMuX2NoYW5nZXMuZm9yRWFjaChmdW5jdGlvbiAoY2hhbmdlKSB7CiAgICAgICAgb2JzZXJ2ZXIuX2NoYW5nZU9iamVjdChvYnNlcnZlci5fc3luY09iaiwgY2hhbmdlKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnY2hpbGRyZW4nLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbjsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFQcm92aXNpb25hbDsKfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YVByb3Zpc2lvbmFsOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxNDkgKi8sCi8qIDE1MCAqLywKLyogMTUxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oMTU4KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDE1MiAqLywKLyogMTUzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oMTYwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDE1NCAqLywKLyogMTU1ICovLAovKiAxNTYgKi8sCi8qIDE1NyAqLywKLyogMTU4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTY0KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5hc3NpZ247CgovKioqLyB9KSwKLyogMTU5ICovLAovKiAxNjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygxNjYpOwp2YXIgJE9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICByZXR1cm4gJE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSk7Cn07CgovKioqLyB9KSwKLyogMTYxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCi8vIDE5LjEuMi4xIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBzb3VyY2UsIC4uLikKdmFyIGdldEtleXMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkKICAsIGdPUFMgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OCkKICAsIHBJRSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkKICAsIHRvT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMikKICAsIElPYmplY3QgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NikKICAsICRhc3NpZ24gID0gT2JqZWN0LmFzc2lnbjsKCi8vIHNob3VsZCB3b3JrIHdpdGggc3ltYm9scyBhbmQgc2hvdWxkIGhhdmUgZGV0ZXJtaW5pc3RpYyBwcm9wZXJ0eSBvcmRlciAoVjggYnVnKQptb2R1bGUuZXhwb3J0cyA9ICEkYXNzaWduIHx8IF9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgdmFyIEEgPSB7fQogICAgLCBCID0ge30KICAgICwgUyA9IFN5bWJvbCgpCiAgICAsIEsgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3QnOwogIEFbU10gPSA3OwogIEsuc3BsaXQoJycpLmZvckVhY2goZnVuY3Rpb24oayl7IEJba10gPSBrOyB9KTsKICByZXR1cm4gJGFzc2lnbih7fSwgQSlbU10gIT0gNyB8fCBPYmplY3Qua2V5cygkYXNzaWduKHt9LCBCKSkuam9pbignJykgIT0gSzsKfSkgPyBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0LCBzb3VyY2UpeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzCiAgdmFyIFQgICAgID0gdG9PYmplY3QodGFyZ2V0KQogICAgLCBhTGVuICA9IGFyZ3VtZW50cy5sZW5ndGgKICAgICwgaW5kZXggPSAxCiAgICAsIGdldFN5bWJvbHMgPSBnT1BTLmYKICAgICwgaXNFbnVtICAgICA9IHBJRS5mOwogIHdoaWxlKGFMZW4gPiBpbmRleCl7CiAgICB2YXIgUyAgICAgID0gSU9iamVjdChhcmd1bWVudHNbaW5kZXgrK10pCiAgICAgICwga2V5cyAgID0gZ2V0U3ltYm9scyA/IGdldEtleXMoUykuY29uY2F0KGdldFN5bWJvbHMoUykpIDogZ2V0S2V5cyhTKQogICAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCiAgICAgICwgaiAgICAgID0gMAogICAgICAsIGtleTsKICAgIHdoaWxlKGxlbmd0aCA+IGopaWYoaXNFbnVtLmNhbGwoUywga2V5ID0ga2V5c1tqKytdKSlUW2tleV0gPSBTW2tleV07CiAgfSByZXR1cm4gVDsKfSA6ICRhc3NpZ247CgovKioqLyB9KSwKLyogMTYyICovLAovKiAxNjMgKi8sCi8qIDE2NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjMuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlKQp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiwgJ09iamVjdCcsIHthc3NpZ246IF9fd2VicGFja19yZXF1aXJlX18oMTYxKX0pOwoKLyoqKi8gfSksCi8qIDE2NSAqLywKLyogMTY2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkKdmFyIHRvSU9iamVjdCAgICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQogICwgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IF9fd2VicGFja19yZXF1aXJlX18oNTcpLmY7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KSgnZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yJywgZnVuY3Rpb24oKXsKICByZXR1cm4gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpewogICAgcmV0dXJuICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodG9JT2JqZWN0KGl0KSwga2V5KTsKICB9Owp9KTsKCi8qKiovIH0pCi8qKioqKiovIF0pOwp9KTsKCn0se31dLDk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewptb2R1bGUuZXhwb3J0cz17CiAgIl9hcmdzIjogWwogICAgWwogICAgICB7CiAgICAgICAgInJhdyI6ICJzaXAuanNAMC43LjUiLAogICAgICAgICJzY29wZSI6IG51bGwsCiAgICAgICAgImVzY2FwZWROYW1lIjogInNpcC5qcyIsCiAgICAgICAgIm5hbWUiOiAic2lwLmpzIiwKICAgICAgICAicmF3U3BlYyI6ICIwLjcuNSIsCiAgICAgICAgInNwZWMiOiAiMC43LjUiLAogICAgICAgICJ0eXBlIjogInZlcnNpb24iCiAgICAgIH0sCiAgICAgICIvVXNlcnMvZHZpbGNoZXovd29ya3NwYWNlL3JldGhpbmsvZGV2LXByb3Rvc3R1YnMvc3JjL3Byb3Rvc3R1Yi9pbXNfaXciCiAgICBdCiAgXSwKICAiX2Zyb20iOiAic2lwLmpzQDAuNy41IiwKICAiX2lkIjogInNpcC5qc0AwLjcuNSIsCiAgIl9pbkNhY2hlIjogdHJ1ZSwKICAiX2xvY2F0aW9uIjogIi9zaXAuanMiLAogICJfbm9kZVZlcnNpb24iOiAiNC40LjMiLAogICJfbnBtT3BlcmF0aW9uYWxJbnRlcm5hbCI6IHsKICAgICJob3N0IjogInBhY2thZ2VzLTEyLXdlc3QuaW50ZXJuYWwubnBtanMuY29tIiwKICAgICJ0bXAiOiAidG1wL3NpcC5qcy0wLjcuNS50Z3pfMTQ2MTU5NDQxODY5MF8wLjU4Mzk5MzMxMjQzNzA4NzMiCiAgfSwKICAiX25wbVVzZXIiOiB7CiAgICAibmFtZSI6ICJqb3NlcGhmcmF6aWVyIiwKICAgICJlbWFpbCI6ICIxMjEyanRyYWNldXJAZ21haWwuY29tIgogIH0sCiAgIl9ucG1WZXJzaW9uIjogIjIuMTUuMSIsCiAgIl9waGFudG9tQ2hpbGRyZW4iOiB7fSwKICAiX3JlcXVlc3RlZCI6IHsKICAgICJyYXciOiAic2lwLmpzQDAuNy41IiwKICAgICJzY29wZSI6IG51bGwsCiAgICAiZXNjYXBlZE5hbWUiOiAic2lwLmpzIiwKICAgICJuYW1lIjogInNpcC5qcyIsCiAgICAicmF3U3BlYyI6ICIwLjcuNSIsCiAgICAic3BlYyI6ICIwLjcuNSIsCiAgICAidHlwZSI6ICJ2ZXJzaW9uIgogIH0sCiAgIl9yZXF1aXJlZEJ5IjogWwogICAgIi8iCiAgXSwKICAiX3Jlc29sdmVkIjogImh0dHBzOi8vcmVnaXN0cnkubnBtanMub3JnL3NpcC5qcy8tL3NpcC5qcy0wLjcuNS50Z3oiLAogICJfc2hhc3VtIjogIjg2YWNlNzA1MTU5NGY5MWI0NTUxYmRiODEyMGExNmM0NDk2MmQzYTIiLAogICJfc2hyaW5rd3JhcCI6IG51bGwsCiAgIl9zcGVjIjogInNpcC5qc0AwLjcuNSIsCiAgIl93aGVyZSI6ICIvVXNlcnMvZHZpbGNoZXovd29ya3NwYWNlL3JldGhpbmsvZGV2LXByb3Rvc3R1YnMvc3JjL3Byb3Rvc3R1Yi9pbXNfaXciLAogICJhdXRob3IiOiB7CiAgICAibmFtZSI6ICJPblNJUCIsCiAgICAiZW1haWwiOiAiZGV2ZWxvcGVyQG9uc2lwLmNvbSIsCiAgICAidXJsIjogImh0dHA6Ly9zaXBqcy5jb20vYXV0aG9ycy8iCiAgfSwKICAiYnJvd3NlciI6IHsKICAgICIuL3NyYy9lbnZpcm9ubWVudC5qcyI6ICIuL3NyYy9lbnZpcm9ubWVudF9icm93c2VyLmpzIgogIH0sCiAgImJ1Z3MiOiB7CiAgICAidXJsIjogImh0dHBzOi8vZ2l0aHViLmNvbS9vbnNpcC9TSVAuanMvaXNzdWVzIgogIH0sCiAgImNvbnRyaWJ1dG9ycyI6IFsKICAgIHsKICAgICAgInVybCI6ICJodHRwczovL2dpdGh1Yi5jb20vb25zaXAvU0lQLmpzL2Jsb2IvbWFzdGVyL1RIQU5LUy5tZCIKICAgIH0KICBdLAogICJkZXBlbmRlbmNpZXMiOiB7CiAgICAicHJvbWlzY3VvdXMiOiAiXjAuNi4wIiwKICAgICJ3cyI6ICJeMC42LjQiCiAgfSwKICAiZGVzY3JpcHRpb24iOiAiQSBzaW1wbGUsIGludHVpdGl2ZSwgYW5kIHBvd2VyZnVsIEphdmFTY3JpcHQgc2lnbmFsaW5nIGxpYnJhcnkiLAogICJkZXZEZXBlbmRlbmNpZXMiOiB7CiAgICAiYmVlZnkiOiAiXjIuMS41IiwKICAgICJicm93c2VyaWZ5IjogIl40LjEuOCIsCiAgICAiZ3J1bnQiOiAifjAuNC4wIiwKICAgICJncnVudC1icm93c2VyaWZ5IjogIl40LjAuMSIsCiAgICAiZ3J1bnQtY2xpIjogIn4wLjEuNiIsCiAgICAiZ3J1bnQtY29udHJpYi1jb3B5IjogIl4wLjUuMCIsCiAgICAiZ3J1bnQtY29udHJpYi1qYXNtaW5lIjogIl4wLjkuMiIsCiAgICAiZ3J1bnQtY29udHJpYi1qc2hpbnQiOiAiPjAuNS4wIiwKICAgICJncnVudC1jb250cmliLXVnbGlmeSI6ICJ+MC4yLjAiLAogICAgImdydW50LXBlZyI6ICJ+MS4zLjEiLAogICAgImdydW50LXRyaW10cmFpbGluZ3NwYWNlcyI6ICJeMC40LjAiLAogICAgInBlZ2pzIjogIl4wLjguMCIKICB9LAogICJkaXJlY3RvcmllcyI6IHt9LAogICJkaXN0IjogewogICAgInNoYXN1bSI6ICI4NmFjZTcwNTE1OTRmOTFiNDU1MWJkYjgxMjBhMTZjNDQ5NjJkM2EyIiwKICAgICJ0YXJiYWxsIjogImh0dHBzOi8vcmVnaXN0cnkubnBtanMub3JnL3NpcC5qcy8tL3NpcC5qcy0wLjcuNS50Z3oiCiAgfSwKICAiZW5naW5lcyI6IHsKICAgICJub2RlIjogIj49MC44IgogIH0sCiAgImdpdEhlYWQiOiAiYmFlNDRiZDAzNTlmNGQ3MGRlZDMwOWEzMjM2MWYwNGEwNGU3OGQ2ZSIsCiAgImhvbWVwYWdlIjogImh0dHA6Ly9zaXBqcy5jb20iLAogICJrZXl3b3JkcyI6IFsKICAgICJzaXAiLAogICAgIndlYnNvY2tldCIsCiAgICAid2VicnRjIiwKICAgICJsaWJyYXJ5IiwKICAgICJqYXZhc2NyaXB0IgogIF0sCiAgImxpY2Vuc2UiOiAiTUlUIiwKICAibWFpbiI6ICJzcmMvaW5kZXguanMiLAogICJtYWludGFpbmVycyI6IFsKICAgIHsKICAgICAgIm5hbWUiOiAiZWdyZWVuX29uc2lwIiwKICAgICAgImVtYWlsIjogImVyaWMuZ3JlZW5Ab25zaXAuY29tIgogICAgfSwKICAgIHsKICAgICAgIm5hbWUiOiAiamFtZXMtY3Jpc2N1b2xvIiwKICAgICAgImVtYWlsIjogImphbWVzQG9uc2lwLmNvbSIKICAgIH0sCiAgICB7CiAgICAgICJuYW1lIjogImpvc2VwaGZyYXppZXIiLAogICAgICAiZW1haWwiOiAiMTIxMmp0cmFjZXVyQGdtYWlsLmNvbSIKICAgIH0KICBdLAogICJuYW1lIjogInNpcC5qcyIsCiAgIm9wdGlvbmFsRGVwZW5kZW5jaWVzIjogewogICAgInByb21pc2N1b3VzIjogIl4wLjYuMCIKICB9LAogICJyZWFkbWUiOiAiRVJST1I6IE5vIFJFQURNRSBkYXRhIGZvdW5kISIsCiAgInJlcG9zaXRvcnkiOiB7CiAgICAidHlwZSI6ICJnaXQiLAogICAgInVybCI6ICJnaXQraHR0cHM6Ly9naXRodWIuY29tL29uc2lwL1NJUC5qcy5naXQiCiAgfSwKICAic2NyaXB0cyI6IHsKICAgICJidWlsZCI6ICJncnVudCBidWlsZCIsCiAgICAicHJlcHVibGlzaCI6ICJjZCBzcmMvR3JhbW1hciAmJiBta2RpciAtcCBkaXN0ICYmIHBlZ2pzIC0tZXh0cmEtb3B0aW9ucy1maWxlIHBlZy5qc29uIHNyYy9HcmFtbWFyLnBlZ2pzIGRpc3QvR3JhbW1hci5qcyIsCiAgICAicmVwbCI6ICJiZWVmeSB0ZXN0L3JlcGwuanMgLS1vcGVuIiwKICAgICJ0ZXN0IjogImdydW50IHRyYXZpcyAtLXZlcmJvc2UiCiAgfSwKICAidGl0bGUiOiAiU0lQLmpzIiwKICAidmVyc2lvbiI6ICIwLjcuNSIKfQoKfSx7fV0sMTA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewp2YXIgQ2xpZW50Q29udGV4dDsKCkNsaWVudENvbnRleHQgPSBmdW5jdGlvbiAodWEsIG1ldGhvZCwgdGFyZ2V0LCBvcHRpb25zKSB7CiAgdmFyIG9yaWdpbmFsVGFyZ2V0ID0gdGFyZ2V0OwoKICAvLyBWYWxpZGF0ZSBhcmd1bWVudHMKICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ05vdCBlbm91Z2ggYXJndW1lbnRzJyk7CiAgfQoKICB0aGlzLnVhID0gdWE7CiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC5jbGllbnRjb250ZXh0Jyk7CiAgdGhpcy5tZXRob2QgPSBtZXRob2Q7CiAgdGFyZ2V0ID0gdWEubm9ybWFsaXplVGFyZ2V0KHRhcmdldCk7CiAgaWYgKCF0YXJnZXQpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgdGFyZ2V0OiAnICsgb3JpZ2luYWxUYXJnZXQpOwogIH0KCiAgLyogT3B0aW9ucwogICAqIC0gZXh0cmFIZWFkZXJzCiAgICogLSBwYXJhbXMKICAgKiAtIGNvbnRlbnRUeXBlCiAgICogLSBib2R5CiAgICovCiAgb3B0aW9ucyA9IE9iamVjdC5jcmVhdGUob3B0aW9ucyB8fCBPYmplY3QucHJvdG90eXBlKTsKICBvcHRpb25zLmV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKCiAgaWYgKG9wdGlvbnMuY29udGVudFR5cGUpIHsKICAgIHRoaXMuY29udGVudFR5cGUgPSBvcHRpb25zLmNvbnRlbnRUeXBlOwogICAgb3B0aW9ucy5leHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgdGhpcy5jb250ZW50VHlwZSk7CiAgfQoKICAvLyBCdWlsZCB0aGUgcmVxdWVzdAogIHRoaXMucmVxdWVzdCA9IG5ldyBTSVAuT3V0Z29pbmdSZXF1ZXN0KHRoaXMubWV0aG9kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMucGFyYW1zLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzKTsKICBpZiAob3B0aW9ucy5ib2R5KSB7CiAgICB0aGlzLmJvZHkgPSBvcHRpb25zLmJvZHk7CiAgICB0aGlzLnJlcXVlc3QuYm9keSA9IHRoaXMuYm9keTsKICB9CgogIC8qIFNldCBvdGhlciBwcm9wZXJ0aWVzIGZyb20gdGhlIHJlcXVlc3QgKi8KICB0aGlzLmxvY2FsSWRlbnRpdHkgPSB0aGlzLnJlcXVlc3QuZnJvbTsKICB0aGlzLnJlbW90ZUlkZW50aXR5ID0gdGhpcy5yZXF1ZXN0LnRvOwoKICB0aGlzLmRhdGEgPSB7fTsKfTsKQ2xpZW50Q29udGV4dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKCkNsaWVudENvbnRleHQucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAoKSB7CiAgKG5ldyBTSVAuUmVxdWVzdFNlbmRlcih0aGlzLCB0aGlzLnVhKSkuc2VuZCgpOwogIHJldHVybiB0aGlzOwp9OwoKQ2xpZW50Q29udGV4dC5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgdmFyIGNhbmNlbF9yZWFzb24gPSBTSVAuVXRpbHMuZ2V0Q2FuY2VsUmVhc29uKG9wdGlvbnMuc3RhdHVzX2NvZGUsIG9wdGlvbnMucmVhc29uX3BocmFzZSk7CiAgdGhpcy5yZXF1ZXN0LmNhbmNlbChjYW5jZWxfcmVhc29uKTsKCiAgdGhpcy5lbWl0KCdjYW5jZWwnKTsKfTsKCkNsaWVudENvbnRleHQucHJvdG90eXBlLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uIChyZXNwb25zZSkgewogIHZhciBjYXVzZSA9IFNJUC5VdGlscy5nZXRSZWFzb25QaHJhc2UocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOwoKICBzd2l0Y2godHJ1ZSkgewogICAgY2FzZSAvXjFbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UsIGNhdXNlKTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAvXjJbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICBpZih0aGlzLnVhLmFwcGxpY2FudHNbdGhpc10pIHsKICAgICAgICBkZWxldGUgdGhpcy51YS5hcHBsaWNhbnRzW3RoaXNdOwogICAgICB9CiAgICAgIHRoaXMuZW1pdCgnYWNjZXB0ZWQnLCByZXNwb25zZSwgY2F1c2UpOwogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgICBpZih0aGlzLnVhLmFwcGxpY2FudHNbdGhpc10pIHsKICAgICAgICBkZWxldGUgdGhpcy51YS5hcHBsaWNhbnRzW3RoaXNdOwogICAgICB9CiAgICAgIHRoaXMuZW1pdCgncmVqZWN0ZWQnLCByZXNwb25zZSwgY2F1c2UpOwogICAgICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgIGJyZWFrOwogIH0KCn07CgpDbGllbnRDb250ZXh0LnByb3RvdHlwZS5vblJlcXVlc3RUaW1lb3V0ID0gZnVuY3Rpb24gKCkgewogIHRoaXMuZW1pdCgnZmFpbGVkJywgbnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7Cn07CgpDbGllbnRDb250ZXh0LnByb3RvdHlwZS5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24gKCkgewogIHRoaXMuZW1pdCgnZmFpbGVkJywgbnVsbCwgU0lQLkMuY2F1c2VzLkNPTk5FQ1RJT05fRVJST1IpOwp9OwoKU0lQLkNsaWVudENvbnRleHQgPSBDbGllbnRDb250ZXh0Owp9OwoKfSx7fV0sMTE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IFNJUCBDb25zdGFudHMKICovCgovKioKICogU0lQIENvbnN0YW50cy4KICogQGF1Z21lbnRzIFNJUAogKi8KCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG5hbWUsIHZlcnNpb24pIHsKcmV0dXJuIHsKICBVU0VSX0FHRU5UOiBuYW1lICsnLycrIHZlcnNpb24sCgogIC8vIFNJUCBzY2hlbWUKICBTSVA6ICAnc2lwJywKICBTSVBTOiAnc2lwcycsCgogIC8vIEVuZCBhbmQgRmFpbHVyZSBjYXVzZXMKICBjYXVzZXM6IHsKICAgIC8vIEdlbmVyaWMgZXJyb3IgY2F1c2VzCiAgICBDT05ORUNUSU9OX0VSUk9SOiAgICAgICAgICdDb25uZWN0aW9uIEVycm9yJywKICAgIFJFUVVFU1RfVElNRU9VVDogICAgICAgICAgJ1JlcXVlc3QgVGltZW91dCcsCiAgICBTSVBfRkFJTFVSRV9DT0RFOiAgICAgICAgICdTSVAgRmFpbHVyZSBDb2RlJywKICAgIElOVEVSTkFMX0VSUk9SOiAgICAgICAgICAgJ0ludGVybmFsIEVycm9yJywKCiAgICAvLyBTSVAgZXJyb3IgY2F1c2VzCiAgICBCVVNZOiAgICAgICAgICAgICAgICAgICAgICdCdXN5JywKICAgIFJFSkVDVEVEOiAgICAgICAgICAgICAgICAgJ1JlamVjdGVkJywKICAgIFJFRElSRUNURUQ6ICAgICAgICAgICAgICAgJ1JlZGlyZWN0ZWQnLAogICAgVU5BVkFJTEFCTEU6ICAgICAgICAgICAgICAnVW5hdmFpbGFibGUnLAogICAgTk9UX0ZPVU5EOiAgICAgICAgICAgICAgICAnTm90IEZvdW5kJywKICAgIEFERFJFU1NfSU5DT01QTEVURTogICAgICAgJ0FkZHJlc3MgSW5jb21wbGV0ZScsCiAgICBJTkNPTVBBVElCTEVfU0RQOiAgICAgICAgICdJbmNvbXBhdGlibGUgU0RQJywKICAgIEFVVEhFTlRJQ0FUSU9OX0VSUk9SOiAgICAgJ0F1dGhlbnRpY2F0aW9uIEVycm9yJywKICAgIERJQUxPR19FUlJPUjogICAgICAgICAgICAgJ0RpYWxvZyBFcnJvcicsCgogICAgLy8gU2Vzc2lvbiBlcnJvciBjYXVzZXMKICAgIFdFQlJUQ19OT1RfU1VQUE9SVEVEOiAgICAgJ1dlYlJUQyBOb3QgU3VwcG9ydGVkJywKICAgIFdFQlJUQ19FUlJPUjogICAgICAgICAgICAgJ1dlYlJUQyBFcnJvcicsCiAgICBDQU5DRUxFRDogICAgICAgICAgICAgICAgICdDYW5jZWxlZCcsCiAgICBOT19BTlNXRVI6ICAgICAgICAgICAgICAgICdObyBBbnN3ZXInLAogICAgRVhQSVJFUzogICAgICAgICAgICAgICAgICAnRXhwaXJlcycsCiAgICBOT19BQ0s6ICAgICAgICAgICAgICAgICAgICdObyBBQ0snLAogICAgTk9fUFJBQ0s6ICAgICAgICAgICAgICAgICAnTm8gUFJBQ0snLAogICAgVVNFUl9ERU5JRURfTUVESUFfQUNDRVNTOiAnVXNlciBEZW5pZWQgTWVkaWEgQWNjZXNzJywKICAgIEJBRF9NRURJQV9ERVNDUklQVElPTjogICAgJ0JhZCBNZWRpYSBEZXNjcmlwdGlvbicsCiAgICBSVFBfVElNRU9VVDogICAgICAgICAgICAgICdSVFAgVGltZW91dCcKICB9LAoKICBzdXBwb3J0ZWQ6IHsKICAgIFVOU1VQUE9SVEVEOiAgICAgICAgJ25vbmUnLAogICAgU1VQUE9SVEVEOiAgICAgICAgICAnc3VwcG9ydGVkJywKICAgIFJFUVVJUkVEOiAgICAgICAgICAgJ3JlcXVpcmVkJwogIH0sCgogIFNJUF9FUlJPUl9DQVVTRVM6IHsKICAgIFJFRElSRUNURUQ6IFszMDAsMzAxLDMwMiwzMDUsMzgwXSwKICAgIEJVU1k6IFs0ODYsNjAwXSwKICAgIFJFSkVDVEVEOiBbNDAzLDYwM10sCiAgICBOT1RfRk9VTkQ6IFs0MDQsNjA0XSwKICAgIFVOQVZBSUxBQkxFOiBbNDgwLDQxMCw0MDgsNDMwXSwKICAgIEFERFJFU1NfSU5DT01QTEVURTogWzQ4NF0sCiAgICBJTkNPTVBBVElCTEVfU0RQOiBbNDg4LDYwNl0sCiAgICBBVVRIRU5USUNBVElPTl9FUlJPUjpbNDAxLDQwN10KICB9LAoKICAvLyBTSVAgTWV0aG9kcwogIEFDSzogICAgICAgICdBQ0snLAogIEJZRTogICAgICAgICdCWUUnLAogIENBTkNFTDogICAgICdDQU5DRUwnLAogIElORk86ICAgICAgICdJTkZPJywKICBJTlZJVEU6ICAgICAnSU5WSVRFJywKICBNRVNTQUdFOiAgICAnTUVTU0FHRScsCiAgTk9USUZZOiAgICAgJ05PVElGWScsCiAgT1BUSU9OUzogICAgJ09QVElPTlMnLAogIFJFR0lTVEVSOiAgICdSRUdJU1RFUicsCiAgVVBEQVRFOiAgICAgJ1VQREFURScsCiAgU1VCU0NSSUJFOiAgJ1NVQlNDUklCRScsCiAgUkVGRVI6ICAgICAgJ1JFRkVSJywKICBQUkFDSzogICAgICAnUFJBQ0snLAoKICAvKiBTSVAgUmVzcG9uc2UgUmVhc29ucwogICAqIERPQzogaHR0cDovL3d3dy5pYW5hLm9yZy9hc3NpZ25tZW50cy9zaXAtcGFyYW1ldGVycwogICAqIENvcGllZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS92ZXJzYXRpY2EvT3ZlclNJUC9ibG9iL21hc3Rlci9saWIvb3ZlcnNpcC9zaXAvY29uc3RhbnRzLnJiI0w3CiAgICovCiAgUkVBU09OX1BIUkFTRTogewogICAgMTAwOiAnVHJ5aW5nJywKICAgIDE4MDogJ1JpbmdpbmcnLAogICAgMTgxOiAnQ2FsbCBJcyBCZWluZyBGb3J3YXJkZWQnLAogICAgMTgyOiAnUXVldWVkJywKICAgIDE4MzogJ1Nlc3Npb24gUHJvZ3Jlc3MnLAogICAgMTk5OiAnRWFybHkgRGlhbG9nIFRlcm1pbmF0ZWQnLCAgLy8gZHJhZnQtaWV0Zi1zaXBjb3JlLTE5OQogICAgMjAwOiAnT0snLAogICAgMjAyOiAnQWNjZXB0ZWQnLCAgLy8gUkZDIDMyNjUKICAgIDIwNDogJ05vIE5vdGlmaWNhdGlvbicsICAvL1JGQyA1ODM5CiAgICAzMDA6ICdNdWx0aXBsZSBDaG9pY2VzJywKICAgIDMwMTogJ01vdmVkIFBlcm1hbmVudGx5JywKICAgIDMwMjogJ01vdmVkIFRlbXBvcmFyaWx5JywKICAgIDMwNTogJ1VzZSBQcm94eScsCiAgICAzODA6ICdBbHRlcm5hdGl2ZSBTZXJ2aWNlJywKICAgIDQwMDogJ0JhZCBSZXF1ZXN0JywKICAgIDQwMTogJ1VuYXV0aG9yaXplZCcsCiAgICA0MDI6ICdQYXltZW50IFJlcXVpcmVkJywKICAgIDQwMzogJ0ZvcmJpZGRlbicsCiAgICA0MDQ6ICdOb3QgRm91bmQnLAogICAgNDA1OiAnTWV0aG9kIE5vdCBBbGxvd2VkJywKICAgIDQwNjogJ05vdCBBY2NlcHRhYmxlJywKICAgIDQwNzogJ1Byb3h5IEF1dGhlbnRpY2F0aW9uIFJlcXVpcmVkJywKICAgIDQwODogJ1JlcXVlc3QgVGltZW91dCcsCiAgICA0MTA6ICdHb25lJywKICAgIDQxMjogJ0NvbmRpdGlvbmFsIFJlcXVlc3QgRmFpbGVkJywgIC8vIFJGQyAzOTAzCiAgICA0MTM6ICdSZXF1ZXN0IEVudGl0eSBUb28gTGFyZ2UnLAogICAgNDE0OiAnUmVxdWVzdC1VUkkgVG9vIExvbmcnLAogICAgNDE1OiAnVW5zdXBwb3J0ZWQgTWVkaWEgVHlwZScsCiAgICA0MTY6ICdVbnN1cHBvcnRlZCBVUkkgU2NoZW1lJywKICAgIDQxNzogJ1Vua25vd24gUmVzb3VyY2UtUHJpb3JpdHknLCAgLy8gUkZDIDQ0MTIKICAgIDQyMDogJ0JhZCBFeHRlbnNpb24nLAogICAgNDIxOiAnRXh0ZW5zaW9uIFJlcXVpcmVkJywKICAgIDQyMjogJ1Nlc3Npb24gSW50ZXJ2YWwgVG9vIFNtYWxsJywgIC8vIFJGQyA0MDI4CiAgICA0MjM6ICdJbnRlcnZhbCBUb28gQnJpZWYnLAogICAgNDI4OiAnVXNlIElkZW50aXR5IEhlYWRlcicsICAvLyBSRkMgNDQ3NAogICAgNDI5OiAnUHJvdmlkZSBSZWZlcnJlciBJZGVudGl0eScsICAvLyBSRkMgMzg5MgogICAgNDMwOiAnRmxvdyBGYWlsZWQnLCAgLy8gUkZDIDU2MjYKICAgIDQzMzogJ0Fub255bWl0eSBEaXNhbGxvd2VkJywgIC8vIFJGQyA1MDc5CiAgICA0MzY6ICdCYWQgSWRlbnRpdHktSW5mbycsICAvLyBSRkMgNDQ3NAogICAgNDM3OiAnVW5zdXBwb3J0ZWQgQ2VydGlmaWNhdGUnLCAgLy8gUkZDIDQ3NDQKICAgIDQzODogJ0ludmFsaWQgSWRlbnRpdHkgSGVhZGVyJywgIC8vIFJGQyA0NzQ0CiAgICA0Mzk6ICdGaXJzdCBIb3AgTGFja3MgT3V0Ym91bmQgU3VwcG9ydCcsICAvLyBSRkMgNTYyNgogICAgNDQwOiAnTWF4LUJyZWFkdGggRXhjZWVkZWQnLCAgLy8gUkZDIDUzOTMKICAgIDQ2OTogJ0JhZCBJbmZvIFBhY2thZ2UnLCAgLy8gZHJhZnQtaWV0Zi1zaXBjb3JlLWluZm8tZXZlbnRzCiAgICA0NzA6ICdDb25zZW50IE5lZWRlZCcsICAvLyBSRkMgNTM2MAogICAgNDc4OiAnVW5yZXNvbHZhYmxlIERlc3RpbmF0aW9uJywgIC8vIEN1c3RvbSBjb2RlIGNvcGllZCBmcm9tIEthbWFpbGlvLgogICAgNDgwOiAnVGVtcG9yYXJpbHkgVW5hdmFpbGFibGUnLAogICAgNDgxOiAnQ2FsbC9UcmFuc2FjdGlvbiBEb2VzIE5vdCBFeGlzdCcsCiAgICA0ODI6ICdMb29wIERldGVjdGVkJywKICAgIDQ4MzogJ1RvbyBNYW55IEhvcHMnLAogICAgNDg0OiAnQWRkcmVzcyBJbmNvbXBsZXRlJywKICAgIDQ4NTogJ0FtYmlndW91cycsCiAgICA0ODY6ICdCdXN5IEhlcmUnLAogICAgNDg3OiAnUmVxdWVzdCBUZXJtaW5hdGVkJywKICAgIDQ4ODogJ05vdCBBY2NlcHRhYmxlIEhlcmUnLAogICAgNDg5OiAnQmFkIEV2ZW50JywgIC8vIFJGQyAzMjY1CiAgICA0OTE6ICdSZXF1ZXN0IFBlbmRpbmcnLAogICAgNDkzOiAnVW5kZWNpcGhlcmFibGUnLAogICAgNDk0OiAnU2VjdXJpdHkgQWdyZWVtZW50IFJlcXVpcmVkJywgIC8vIFJGQyAzMzI5CiAgICA1MDA6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InLAogICAgNTAxOiAnTm90IEltcGxlbWVudGVkJywKICAgIDUwMjogJ0JhZCBHYXRld2F5JywKICAgIDUwMzogJ1NlcnZpY2UgVW5hdmFpbGFibGUnLAogICAgNTA0OiAnU2VydmVyIFRpbWUtb3V0JywKICAgIDUwNTogJ1ZlcnNpb24gTm90IFN1cHBvcnRlZCcsCiAgICA1MTM6ICdNZXNzYWdlIFRvbyBMYXJnZScsCiAgICA1ODA6ICdQcmVjb25kaXRpb24gRmFpbHVyZScsICAvLyBSRkMgMzMxMgogICAgNjAwOiAnQnVzeSBFdmVyeXdoZXJlJywKICAgIDYwMzogJ0RlY2xpbmUnLAogICAgNjA0OiAnRG9lcyBOb3QgRXhpc3QgQW55d2hlcmUnLAogICAgNjA2OiAnTm90IEFjY2VwdGFibGUnCiAgfSwKCiAgLyogU0lQIE9wdGlvbiBUYWdzCiAgICogRE9DOiBodHRwOi8vd3d3LmlhbmEub3JnL2Fzc2lnbm1lbnRzL3NpcC1wYXJhbWV0ZXJzL3NpcC1wYXJhbWV0ZXJzLnhodG1sI3NpcC1wYXJhbWV0ZXJzLTQKICAgKi8KICBPUFRJT05fVEFHUzogewogICAgJzEwMHJlbCc6ICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgMzI2MgogICAgMTk5OiAgICAgICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNjIyOAogICAgYW5zd2VybW9kZTogICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNTM3MwogICAgJ2Vhcmx5LXNlc3Npb24nOiAgICAgICAgICAgIHRydWUsICAvLyBSRkMgMzk1OQogICAgZXZlbnRsaXN0OiAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNDY2MgogICAgZXhwbGljaXRzdWI6ICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMtaWV0Zi1zaXBjb3JlLXJlZmVyLWV4cGxpY2l0LXN1YnNjcmlwdGlvbi0wMwogICAgJ2Zyb20tY2hhbmdlJzogICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNDkxNgogICAgJ2dlb2xvY2F0aW9uLWh0dHAnOiAgICAgICAgIHRydWUsICAvLyBSRkMgNjQ0MgogICAgJ2dlb2xvY2F0aW9uLXNpcCc6ICAgICAgICAgIHRydWUsICAvLyBSRkMgNjQ0MgogICAgZ2luOiAgICAgICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNjE0MAogICAgZ3J1dTogICAgICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNTYyNwogICAgaGlzdGluZm86ICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNzA0NAogICAgaWNlOiAgICAgICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNTc2OAogICAgam9pbjogICAgICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgMzkxMQogICAgJ211bHRpcGxlLXJlZmVyJzogICAgICAgICAgIHRydWUsICAvLyBSRkMgNTM2OAogICAgbm9yZWZlcnN1YjogICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNDQ4OAogICAgbm9zdWI6ICAgICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMtaWV0Zi1zaXBjb3JlLXJlZmVyLWV4cGxpY2l0LXN1YnNjcmlwdGlvbi0wMwogICAgb3V0Ym91bmQ6ICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNTYyNgogICAgcGF0aDogICAgICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgMzMyNwogICAgcG9saWN5OiAgICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNjc5NAogICAgcHJlY29uZGl0aW9uOiAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgMzMxMgogICAgcHJlZjogICAgICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgMzg0MAogICAgcHJpdmFjeTogICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgMzMyMwogICAgJ3JlY2lwaWVudC1saXN0LWludml0ZSc6ICAgIHRydWUsICAvLyBSRkMgNTM2NgogICAgJ3JlY2lwaWVudC1saXN0LW1lc3NhZ2UnOiAgIHRydWUsICAvLyBSRkMgNTM2NQogICAgJ3JlY2lwaWVudC1saXN0LXN1YnNjcmliZSc6IHRydWUsICAvLyBSRkMgNTM2NwogICAgcmVwbGFjZXM6ICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgMzg5MQogICAgJ3Jlc291cmNlLXByaW9yaXR5JzogICAgICAgIHRydWUsICAvLyBSRkMgNDQxMgogICAgJ3NkcC1hbmF0JzogICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNDA5MgogICAgJ3NlYy1hZ3JlZSc6ICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgMzMyOQogICAgdGRpYWxvZzogICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNDUzOAogICAgdGltZXI6ICAgICAgICAgICAgICAgICAgICAgIHRydWUsICAvLyBSRkMgNDAyOAogICAgdXVpOiAgICAgICAgICAgICAgICAgICAgICAgIHRydWUgICAvLyBSRkMgNzQzMwogIH0KfTsKfTsKCn0se31dLDEyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwoKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgSW4tRGlhbG9nIFJlcXVlc3QgU2VuZGVyCiAqLwoKLyoqCiAqIEBhdWdtZW50cyBTSVAuRGlhbG9nCiAqIEBjbGFzcyBDbGFzcyBjcmVhdGluZyBhbiBJbi1kaWFsb2cgcmVxdWVzdCBzZW5kZXIuCiAqIEBwYXJhbSB7U0lQLkRpYWxvZ30gZGlhbG9nCiAqIEBwYXJhbSB7T2JqZWN0fSBhcHBsaWNhbnQKICogQHBhcmFtIHtTSVAuT3V0Z29pbmdSZXF1ZXN0fSByZXF1ZXN0CiAqLwovKioKICogQGZpbGVvdmVydmlldyBpbi1EaWFsb2cgUmVxdWVzdCBTZW5kZXIKICovCgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyIFJlcXVlc3RTZW5kZXI7CgpSZXF1ZXN0U2VuZGVyID0gZnVuY3Rpb24oZGlhbG9nLCBhcHBsaWNhbnQsIHJlcXVlc3QpIHsKCiAgdGhpcy5kaWFsb2cgPSBkaWFsb2c7CiAgdGhpcy5hcHBsaWNhbnQgPSBhcHBsaWNhbnQ7CiAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDsKCiAgLy8gUkZDMzI2MSAxNC4xIE1vZGlmeWluZyBhbiBFeGlzdGluZyBTZXNzaW9uLiBVQUMgQmVoYXZpb3IuCiAgdGhpcy5yZWF0dGVtcHQgPSBmYWxzZTsKICB0aGlzLnJlYXR0ZW1wdFRpbWVyID0gbnVsbDsKfTsKClJlcXVlc3RTZW5kZXIucHJvdG90eXBlID0gewogIHNlbmQ6IGZ1bmN0aW9uKCkgewogICAgdmFyIHNlbGYgPSB0aGlzLAogICAgICByZXF1ZXN0X3NlbmRlciA9IG5ldyBTSVAuUmVxdWVzdFNlbmRlcih0aGlzLCB0aGlzLmRpYWxvZy5vd25lci51YSk7CgogICAgICByZXF1ZXN0X3NlbmRlci5zZW5kKCk7CgogICAgLy8gUkZDMzI2MSAxNC4yIE1vZGlmeWluZyBhbiBFeGlzdGluZyBTZXNzaW9uIC1VQUMgQkVIQVZJT1ItCiAgICBpZiAodGhpcy5yZXF1ZXN0Lm1ldGhvZCA9PT0gU0lQLkMuSU5WSVRFICYmIHJlcXVlc3Rfc2VuZGVyLmNsaWVudFRyYW5zYWN0aW9uLnN0YXRlICE9PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5kaWFsb2cudWFjX3BlbmRpbmdfcmVwbHkgPSB0cnVlOwogICAgICByZXF1ZXN0X3NlbmRlci5jbGllbnRUcmFuc2FjdGlvbi5vbignc3RhdGVDaGFuZ2VkJywgZnVuY3Rpb24gc3RhdGVDaGFuZ2VkKCl7CiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFNJUC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfQUNDRVBURUQgfHwKICAgICAgICAgICAgdGhpcy5zdGF0ZSA9PT0gU0lQLlRyYW5zYWN0aW9ucy5DLlNUQVRVU19DT01QTEVURUQgfHwKICAgICAgICAgICAgdGhpcy5zdGF0ZSA9PT0gU0lQLlRyYW5zYWN0aW9ucy5DLlNUQVRVU19URVJNSU5BVEVEKSB7CgogICAgICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcignc3RhdGVDaGFuZ2VkJywgc3RhdGVDaGFuZ2VkKTsKICAgICAgICAgIHNlbGYuZGlhbG9nLnVhY19wZW5kaW5nX3JlcGx5ID0gZmFsc2U7CgogICAgICAgICAgaWYgKHNlbGYuZGlhbG9nLnVhc19wZW5kaW5nX3JlcGx5ID09PSBmYWxzZSkgewogICAgICAgICAgICBzZWxmLmRpYWxvZy5vd25lci5vblJlYWR5VG9SZWludml0ZSgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKCiAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmFwcGxpY2FudC5vblJlcXVlc3RUaW1lb3V0KCk7CiAgfSwKCiAgb25UcmFuc3BvcnRFcnJvcjogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmFwcGxpY2FudC5vblRyYW5zcG9ydEVycm9yKCk7CiAgfSwKCiAgcmVjZWl2ZVJlc3BvbnNlOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgIC8vIFJGQzMyNjEgMTIuMi4xLjIgNDA4IG9yIDQ4MSBpcyByZWNlaXZlZCBmb3IgYSByZXF1ZXN0IHdpdGhpbiBhIGRpYWxvZy4KICAgIGlmIChyZXNwb25zZS5zdGF0dXNfY29kZSA9PT0gNDA4IHx8IHJlc3BvbnNlLnN0YXR1c19jb2RlID09PSA0ODEpIHsKICAgICAgdGhpcy5hcHBsaWNhbnQub25EaWFsb2dFcnJvcihyZXNwb25zZSk7CiAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLm1ldGhvZCA9PT0gU0lQLkMuSU5WSVRFICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09PSA0OTEpIHsKICAgICAgaWYgKHRoaXMucmVhdHRlbXB0KSB7CiAgICAgICAgdGhpcy5hcHBsaWNhbnQucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJlcXVlc3QuY3NlcS52YWx1ZSA9IHRoaXMuZGlhbG9nLmxvY2FsX3NlcW51bSArPSAxOwogICAgICAgIHRoaXMucmVhdHRlbXB0VGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgaWYgKHNlbGYuYXBwbGljYW50Lm93bmVyLnN0YXR1cyAhPT0gU0lQLlNlc3Npb24uQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICAgICAgICAgIHNlbGYucmVhdHRlbXB0ID0gdHJ1ZTsKICAgICAgICAgICAgICBzZWxmLnJlcXVlc3Rfc2VuZGVyLnNlbmQoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHRoaXMuZ2V0UmVhdHRlbXB0VGltZW91dCgpCiAgICAgICAgKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhpcy5hcHBsaWNhbnQucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgIH0KICB9Cn07CgpyZXR1cm4gUmVxdWVzdFNlbmRlcjsKfTsKCn0se31dLDEzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBTSVAgRGlhbG9nCiAqLwoKLyoqCiAqIEBhdWdtZW50cyBTSVAKICogQGNsYXNzIENsYXNzIGNyZWF0aW5nIGEgU0lQIGRpYWxvZy4KICogQHBhcmFtIHtTSVAuUlRDU2Vzc2lvbn0gb3duZXIKICogQHBhcmFtIHtTSVAuSW5jb21pbmdSZXF1ZXN0fFNJUC5JbmNvbWluZ1Jlc3BvbnNlfSBtZXNzYWdlCiAqIEBwYXJhbSB7RW51bX0gdHlwZSBVQUMgLyBVQVMKICogQHBhcmFtIHtFbnVtfSBzdGF0ZSBTSVAuRGlhbG9nLkMuU1RBVFVTX0VBUkxZIC8gU0lQLkRpYWxvZy5DLlNUQVRVU19DT05GSVJNRUQKICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewoKdmFyIFJlcXVlc3RTZW5kZXIgPSByZXF1aXJlKCcuL0RpYWxvZy9SZXF1ZXN0U2VuZGVyJykoU0lQKTsKCnZhciBEaWFsb2csCiAgQyA9IHsKICAgIC8vIERpYWxvZyBzdGF0ZXMKICAgIFNUQVRVU19FQVJMWTogICAgICAgMSwKICAgIFNUQVRVU19DT05GSVJNRUQ6ICAgMgogIH07CgovLyBSRkMgMzI2MSAxMi4xCkRpYWxvZyA9IGZ1bmN0aW9uKG93bmVyLCBtZXNzYWdlLCB0eXBlLCBzdGF0ZSkgewogIHZhciBjb250YWN0OwoKICB0aGlzLnVhY19wZW5kaW5nX3JlcGx5ID0gZmFsc2U7CiAgdGhpcy51YXNfcGVuZGluZ19yZXBseSA9IGZhbHNlOwoKICBpZighbWVzc2FnZS5oYXNIZWFkZXIoJ2NvbnRhY3QnKSkgewogICAgcmV0dXJuIHsKICAgICAgZXJyb3I6ICd1bmFibGUgdG8gY3JlYXRlIGEgRGlhbG9nIHdpdGhvdXQgQ29udGFjdCBoZWFkZXIgZmllbGQnCiAgICB9OwogIH0KCiAgaWYobWVzc2FnZSBpbnN0YW5jZW9mIFNJUC5JbmNvbWluZ1Jlc3BvbnNlKSB7CiAgICBzdGF0ZSA9IChtZXNzYWdlLnN0YXR1c19jb2RlIDwgMjAwKSA/IEMuU1RBVFVTX0VBUkxZIDogQy5TVEFUVVNfQ09ORklSTUVEOwogIH0gZWxzZSB7CiAgICAvLyBDcmVhdGUgY29uZmlybWVkIGRpYWxvZyBpZiBzdGF0ZSBpcyBub3QgZGVmaW5lZAogICAgc3RhdGUgPSBzdGF0ZSB8fCBDLlNUQVRVU19DT05GSVJNRUQ7CiAgfQoKICBjb250YWN0ID0gbWVzc2FnZS5wYXJzZUhlYWRlcignY29udGFjdCcpOwoKICAvLyBSRkMgMzI2MSAxMi4xLjEKICBpZih0eXBlID09PSAnVUFTJykgewogICAgdGhpcy5pZCA9IHsKICAgICAgY2FsbF9pZDogbWVzc2FnZS5jYWxsX2lkLAogICAgICBsb2NhbF90YWc6IG1lc3NhZ2UudG9fdGFnLAogICAgICByZW1vdGVfdGFnOiBtZXNzYWdlLmZyb21fdGFnLAogICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY2FsbF9pZCArIHRoaXMubG9jYWxfdGFnICsgdGhpcy5yZW1vdGVfdGFnOwogICAgICB9CiAgICB9OwogICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgdGhpcy5yZW1vdGVfc2VxbnVtID0gbWVzc2FnZS5jc2VxOwogICAgdGhpcy5sb2NhbF91cmkgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCd0bycpLnVyaTsKICAgIHRoaXMucmVtb3RlX3VyaSA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ2Zyb20nKS51cmk7CiAgICB0aGlzLnJlbW90ZV90YXJnZXQgPSBjb250YWN0LnVyaTsKICAgIHRoaXMucm91dGVfc2V0ID0gbWVzc2FnZS5nZXRIZWFkZXJzKCdyZWNvcmQtcm91dGUnKTsKICAgIHRoaXMuaW52aXRlX3NlcW51bSA9IG1lc3NhZ2UuY3NlcTsKICAgIHRoaXMubG9jYWxfc2VxbnVtID0gbWVzc2FnZS5jc2VxOwogIH0KICAvLyBSRkMgMzI2MSAxMi4xLjIKICBlbHNlIGlmKHR5cGUgPT09ICdVQUMnKSB7CiAgICB0aGlzLmlkID0gewogICAgICBjYWxsX2lkOiBtZXNzYWdlLmNhbGxfaWQsCiAgICAgIGxvY2FsX3RhZzogbWVzc2FnZS5mcm9tX3RhZywKICAgICAgcmVtb3RlX3RhZzogbWVzc2FnZS50b190YWcsCiAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gdGhpcy5jYWxsX2lkICsgdGhpcy5sb2NhbF90YWcgKyB0aGlzLnJlbW90ZV90YWc7CiAgICAgIH0KICAgIH07CiAgICB0aGlzLnN0YXRlID0gc3RhdGU7CiAgICB0aGlzLmludml0ZV9zZXFudW0gPSBtZXNzYWdlLmNzZXE7CiAgICB0aGlzLmxvY2FsX3NlcW51bSA9IG1lc3NhZ2UuY3NlcTsKICAgIHRoaXMubG9jYWxfdXJpID0gbWVzc2FnZS5wYXJzZUhlYWRlcignZnJvbScpLnVyaTsKICAgIHRoaXMucHJhY2tlZCA9IFtdOwogICAgdGhpcy5yZW1vdGVfdXJpID0gbWVzc2FnZS5wYXJzZUhlYWRlcigndG8nKS51cmk7CiAgICB0aGlzLnJlbW90ZV90YXJnZXQgPSBjb250YWN0LnVyaTsKICAgIHRoaXMucm91dGVfc2V0ID0gbWVzc2FnZS5nZXRIZWFkZXJzKCdyZWNvcmQtcm91dGUnKS5yZXZlcnNlKCk7CgogICAgLy9SRU5ERVJCT0RZCiAgICBpZiAodGhpcy5zdGF0ZSA9PT0gQy5TVEFUVVNfRUFSTFkgJiYgKCFvd25lci5oYXNPZmZlcikpIHsKICAgICAgdGhpcy5tZWRpYUhhbmRsZXIgPSBvd25lci5tZWRpYUhhbmRsZXJGYWN0b3J5KG93bmVyKTsKICAgIH0KICB9CgogIHRoaXMubG9nZ2VyID0gb3duZXIudWEuZ2V0TG9nZ2VyKCdzaXAuZGlhbG9nJywgdGhpcy5pZC50b1N0cmluZygpKTsKICB0aGlzLm93bmVyID0gb3duZXI7CiAgb3duZXIudWEuZGlhbG9nc1t0aGlzLmlkLnRvU3RyaW5nKCldID0gdGhpczsKICB0aGlzLmxvZ2dlci5sb2coJ25ldyAnICsgdHlwZSArICcgZGlhbG9nIGNyZWF0ZWQgd2l0aCBzdGF0dXMgJyArICh0aGlzLnN0YXRlID09PSBDLlNUQVRVU19FQVJMWSA/ICdFQVJMWSc6ICdDT05GSVJNRUQnKSk7CiAgb3duZXIuZW1pdCgnZGlhbG9nJywgdGhpcyk7Cn07CgpEaWFsb2cucHJvdG90eXBlID0gewogIC8qKgogICAqIEBwYXJhbSB7U0lQLkluY29taW5nTWVzc2FnZX0gbWVzc2FnZQogICAqIEBwYXJhbSB7RW51bX0gVUFDL1VBUwogICAqLwogIHVwZGF0ZTogZnVuY3Rpb24obWVzc2FnZSwgdHlwZSkgewogICAgdGhpcy5zdGF0ZSA9IEMuU1RBVFVTX0NPTkZJUk1FRDsKCiAgICB0aGlzLmxvZ2dlci5sb2coJ2RpYWxvZyAnKyB0aGlzLmlkLnRvU3RyaW5nKCkgKycgIGNoYW5nZWQgdG8gQ09ORklSTUVEIHN0YXRlJyk7CgogICAgaWYodHlwZSA9PT0gJ1VBQycpIHsKICAgICAgLy8gUkZDIDMyNjEgMTMuMi4yLjQKICAgICAgdGhpcy5yb3V0ZV9zZXQgPSBtZXNzYWdlLmdldEhlYWRlcnMoJ3JlY29yZC1yb3V0ZScpLnJldmVyc2UoKTsKICAgIH0KICB9LAoKICB0ZXJtaW5hdGU6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5sb2dnZXIubG9nKCdkaWFsb2cgJyArIHRoaXMuaWQudG9TdHJpbmcoKSArICcgZGVsZXRlZCcpOwogICAgaWYgKHRoaXMubWVkaWFIYW5kbGVyICYmIHRoaXMuc3RhdGUgIT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aGlzLm1lZGlhSGFuZGxlci5wZWVyQ29ubmVjdGlvbi5jbG9zZSgpOwogICAgfQogICAgZGVsZXRlIHRoaXMub3duZXIudWEuZGlhbG9nc1t0aGlzLmlkLnRvU3RyaW5nKCldOwogIH0sCgogIC8qKgogICogQHBhcmFtIHtTdHJpbmd9IG1ldGhvZCByZXF1ZXN0IG1ldGhvZAogICogQHBhcmFtIHtPYmplY3R9IGV4dHJhSGVhZGVycyBleHRyYSBoZWFkZXJzCiAgKiBAcmV0dXJucyB7U0lQLk91dGdvaW5nUmVxdWVzdH0KICAqLwoKICAvLyBSRkMgMzI2MSAxMi4yLjEuMQogIGNyZWF0ZVJlcXVlc3Q6IGZ1bmN0aW9uKG1ldGhvZCwgZXh0cmFIZWFkZXJzLCBib2R5KSB7CiAgICB2YXIgY3NlcSwgcmVxdWVzdDsKICAgIGV4dHJhSGVhZGVycyA9IChleHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCk7CgogICAgaWYoIXRoaXMubG9jYWxfc2VxbnVtKSB7IHRoaXMubG9jYWxfc2VxbnVtID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDApOyB9CgogICAgY3NlcSA9IChtZXRob2QgPT09IFNJUC5DLkNBTkNFTCB8fCBtZXRob2QgPT09IFNJUC5DLkFDSykgPyB0aGlzLmludml0ZV9zZXFudW0gOiB0aGlzLmxvY2FsX3NlcW51bSArPSAxOwoKICAgIHJlcXVlc3QgPSBuZXcgU0lQLk91dGdvaW5nUmVxdWVzdCgKICAgICAgbWV0aG9kLAogICAgICB0aGlzLnJlbW90ZV90YXJnZXQsCiAgICAgIHRoaXMub3duZXIudWEsIHsKICAgICAgICAnY3NlcSc6IGNzZXEsCiAgICAgICAgJ2NhbGxfaWQnOiB0aGlzLmlkLmNhbGxfaWQsCiAgICAgICAgJ2Zyb21fdXJpJzogdGhpcy5sb2NhbF91cmksCiAgICAgICAgJ2Zyb21fdGFnJzogdGhpcy5pZC5sb2NhbF90YWcsCiAgICAgICAgJ3RvX3VyaSc6IHRoaXMucmVtb3RlX3VyaSwKICAgICAgICAndG9fdGFnJzogdGhpcy5pZC5yZW1vdGVfdGFnLAogICAgICAgICdyb3V0ZV9zZXQnOiB0aGlzLnJvdXRlX3NldAogICAgICB9LCBleHRyYUhlYWRlcnMsIGJvZHkpOwoKICAgIHJlcXVlc3QuZGlhbG9nID0gdGhpczsKCiAgICByZXR1cm4gcmVxdWVzdDsKICB9LAoKICAvKioKICAqIEBwYXJhbSB7U0lQLkluY29taW5nUmVxdWVzdH0gcmVxdWVzdAogICogQHJldHVybnMge0Jvb2xlYW59CiAgKi8KCiAgLy8gUkZDIDMyNjEgMTIuMi4yCiAgY2hlY2tJbkRpYWxvZ1JlcXVlc3Q6IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICBpZighdGhpcy5yZW1vdGVfc2VxbnVtKSB7CiAgICAgIHRoaXMucmVtb3RlX3NlcW51bSA9IHJlcXVlc3QuY3NlcTsKICAgIH0gZWxzZSBpZihyZXF1ZXN0LmNzZXEgPCB0aGlzLnJlbW90ZV9zZXFudW0pIHsKICAgICAgICAvL0RvIG5vdCB0cnkgdG8gcmVwbHkgdG8gYW4gQUNLIHJlcXVlc3QuCiAgICAgICAgaWYgKHJlcXVlc3QubWV0aG9kICE9PSBTSVAuQy5BQ0spIHsKICAgICAgICAgIHJlcXVlc3QucmVwbHkoNTAwKTsKICAgICAgICB9CiAgICAgICAgaWYgKHJlcXVlc3QuY3NlcSA9PT0gdGhpcy5pbnZpdGVfc2VxbnVtKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSBlbHNlIGlmKHJlcXVlc3QuY3NlcSA+IHRoaXMucmVtb3RlX3NlcW51bSkgewogICAgICB0aGlzLnJlbW90ZV9zZXFudW0gPSByZXF1ZXN0LmNzZXE7CiAgICB9CgogICAgc3dpdGNoKHJlcXVlc3QubWV0aG9kKSB7CiAgICAgIC8vIFJGQzMyNjEgMTQuMiBNb2RpZnlpbmcgYW4gRXhpc3RpbmcgU2Vzc2lvbiAtVUFTIEJFSEFWSU9SLQogICAgICBjYXNlIFNJUC5DLklOVklURToKICAgICAgICBpZiAodGhpcy51YWNfcGVuZGluZ19yZXBseSA9PT0gdHJ1ZSkgewogICAgICAgICAgcmVxdWVzdC5yZXBseSg0OTEpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy51YXNfcGVuZGluZ19yZXBseSA9PT0gdHJ1ZSkgewogICAgICAgICAgdmFyIHJldHJ5QWZ0ZXIgPSAoTWF0aC5yYW5kb20oKSAqIDEwIHwgMCkgKyAxOwogICAgICAgICAgcmVxdWVzdC5yZXBseSg1MDAsIG51bGwsIFsnUmV0cnktQWZ0ZXI6JyArIHJldHJ5QWZ0ZXJdKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy51YXNfcGVuZGluZ19yZXBseSA9IHRydWU7CiAgICAgICAgICByZXF1ZXN0LnNlcnZlcl90cmFuc2FjdGlvbi5vbignc3RhdGVDaGFuZ2VkJywgZnVuY3Rpb24gc3RhdGVDaGFuZ2VkKCl7CiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX0FDQ0VQVEVEIHx8CiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlID09PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX0NPTVBMRVRFRCB8fAogICAgICAgICAgICAgICAgdGhpcy5zdGF0ZSA9PT0gU0lQLlRyYW5zYWN0aW9ucy5DLlNUQVRVU19URVJNSU5BVEVEKSB7CgogICAgICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIoJ3N0YXRlQ2hhbmdlZCcsIHN0YXRlQ2hhbmdlZCk7CiAgICAgICAgICAgICAgc2VsZi51YXNfcGVuZGluZ19yZXBseSA9IGZhbHNlOwoKICAgICAgICAgICAgICBpZiAoc2VsZi51YWNfcGVuZGluZ19yZXBseSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIHNlbGYub3duZXIub25SZWFkeVRvUmVpbnZpdGUoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLy8gUkZDMzI2MSAxMi4yLjIgUmVwbGFjZSB0aGUgZGlhbG9nYHMgcmVtb3RlIHRhcmdldCBVUkkgaWYgdGhlIHJlcXVlc3QgaXMgYWNjZXB0ZWQKICAgICAgICBpZihyZXF1ZXN0Lmhhc0hlYWRlcignY29udGFjdCcpKSB7CiAgICAgICAgICByZXF1ZXN0LnNlcnZlcl90cmFuc2FjdGlvbi5vbignc3RhdGVDaGFuZ2VkJywgZnVuY3Rpb24oKXsKICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFNJUC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfQUNDRVBURUQpIHsKICAgICAgICAgICAgICBzZWxmLnJlbW90ZV90YXJnZXQgPSByZXF1ZXN0LnBhcnNlSGVhZGVyKCdjb250YWN0JykudXJpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgU0lQLkMuTk9USUZZOgogICAgICAgIC8vIFJGQzY2NjUgMy4yIFJlcGxhY2UgdGhlIGRpYWxvZ2BzIHJlbW90ZSB0YXJnZXQgVVJJIGlmIHRoZSByZXF1ZXN0IGlzIGFjY2VwdGVkCiAgICAgICAgaWYocmVxdWVzdC5oYXNIZWFkZXIoJ2NvbnRhY3QnKSkgewogICAgICAgICAgcmVxdWVzdC5zZXJ2ZXJfdHJhbnNhY3Rpb24ub24oJ3N0YXRlQ2hhbmdlZCcsIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX0NPTVBMRVRFRCkgewogICAgICAgICAgICAgIHNlbGYucmVtb3RlX3RhcmdldCA9IHJlcXVlc3QucGFyc2VIZWFkZXIoJ2NvbnRhY3QnKS51cmk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9LAoKICBzZW5kUmVxdWVzdDogZnVuY3Rpb24oYXBwbGljYW50LCBtZXRob2QsIG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIHZhcgogICAgICBleHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCksCiAgICAgIGJvZHkgPSBvcHRpb25zLmJvZHkgfHwgbnVsbCwKICAgICAgcmVxdWVzdCA9IHRoaXMuY3JlYXRlUmVxdWVzdChtZXRob2QsIGV4dHJhSGVhZGVycywgYm9keSksCiAgICAgIHJlcXVlc3Rfc2VuZGVyID0gbmV3IFJlcXVlc3RTZW5kZXIodGhpcywgYXBwbGljYW50LCByZXF1ZXN0KTsKCiAgICByZXF1ZXN0X3NlbmRlci5zZW5kKCk7CgogICAgcmV0dXJuIHJlcXVlc3Q7CiAgfSwKCiAgLyoqCiAgKiBAcGFyYW0ge1NJUC5JbmNvbWluZ1JlcXVlc3R9IHJlcXVlc3QKICAqLwogIHJlY2VpdmVSZXF1ZXN0OiBmdW5jdGlvbihyZXF1ZXN0KSB7CiAgICAvL0NoZWNrIGluLWRpYWxvZyByZXF1ZXN0CiAgICBpZighdGhpcy5jaGVja0luRGlhbG9nUmVxdWVzdChyZXF1ZXN0KSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5vd25lci5yZWNlaXZlUmVxdWVzdChyZXF1ZXN0KTsKICB9Cn07CgpEaWFsb2cuQyA9IEM7ClNJUC5EaWFsb2cgPSBEaWFsb2c7Cn07Cgp9LHsiLi9EaWFsb2cvUmVxdWVzdFNlbmRlciI6MTJ9XSwxNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCi8qKgogKiBAZmlsZW92ZXJ2aWV3IFNJUCBEaWdlc3QgQXV0aGVudGljYXRpb24KICovCgovKioKICogU0lQIERpZ2VzdCBBdXRoZW50aWNhdGlvbi4KICogQGF1Z21lbnRzIFNJUC4KICogQGZ1bmN0aW9uIERpZ2VzdCBBdXRoZW50aWNhdGlvbgogKiBAcGFyYW0ge1NJUC5VQX0gdWEKICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFV0aWxzKSB7CnZhciBEaWdlc3RBdXRoZW50aWNhdGlvbjsKCkRpZ2VzdEF1dGhlbnRpY2F0aW9uID0gZnVuY3Rpb24odWEpIHsKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwanMuZGlnZXN0YXV0aGVudGljYXRpb24nKTsKICB0aGlzLnVzZXJuYW1lID0gdWEuY29uZmlndXJhdGlvbi5hdXRob3JpemF0aW9uVXNlcjsKICB0aGlzLnBhc3N3b3JkID0gdWEuY29uZmlndXJhdGlvbi5wYXNzd29yZDsKICB0aGlzLmNub25jZSA9IG51bGw7CiAgdGhpcy5uYyA9IDA7CiAgdGhpcy5uY0hleCA9ICcwMDAwMDAwMCc7CiAgdGhpcy5yZXNwb25zZSA9IG51bGw7Cn07CgoKLyoqCiogUGVyZm9ybXMgRGlnZXN0IGF1dGhlbnRpY2F0aW9uIGdpdmVuIGEgU0lQIHJlcXVlc3QgYW5kIHRoZSBjaGFsbGVuZ2UKKiByZWNlaXZlZCBpbiBhIHJlc3BvbnNlIHRvIHRoYXQgcmVxdWVzdC4KKiBSZXR1cm5zIHRydWUgaWYgY3JlZGVudGlhbHMgd2VyZSBzdWNjZXNzZnVsbHkgZ2VuZXJhdGVkLCBmYWxzZSBvdGhlcndpc2UuCioKKiBAcGFyYW0ge1NJUC5PdXRnb2luZ1JlcXVlc3R9IHJlcXVlc3QKKiBAcGFyYW0ge09iamVjdH0gY2hhbGxlbmdlCiovCkRpZ2VzdEF1dGhlbnRpY2F0aW9uLnByb3RvdHlwZS5hdXRoZW50aWNhdGUgPSBmdW5jdGlvbihyZXF1ZXN0LCBjaGFsbGVuZ2UpIHsKICAvLyBJbnNwZWN0IGFuZCB2YWxpZGF0ZSB0aGUgY2hhbGxlbmdlLgoKICB0aGlzLmFsZ29yaXRobSA9IGNoYWxsZW5nZS5hbGdvcml0aG07CiAgdGhpcy5yZWFsbSA9IGNoYWxsZW5nZS5yZWFsbTsKICB0aGlzLm5vbmNlID0gY2hhbGxlbmdlLm5vbmNlOwogIHRoaXMub3BhcXVlID0gY2hhbGxlbmdlLm9wYXF1ZTsKICB0aGlzLnN0YWxlID0gY2hhbGxlbmdlLnN0YWxlOwoKICBpZiAodGhpcy5hbGdvcml0aG0pIHsKICAgIGlmICh0aGlzLmFsZ29yaXRobSAhPT0gJ01ENScpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybignY2hhbGxlbmdlIHdpdGggRGlnZXN0IGFsZ29yaXRobSBkaWZmZXJlbnQgdGhhbiAiTUQ1IiwgYXV0aGVudGljYXRpb24gYWJvcnRlZCcpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSBlbHNlIHsKICAgIHRoaXMuYWxnb3JpdGhtID0gJ01ENSc7CiAgfQoKICBpZiAoISB0aGlzLnJlYWxtKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCdjaGFsbGVuZ2Ugd2l0aG91dCBEaWdlc3QgcmVhbG0sIGF1dGhlbnRpY2F0aW9uIGFib3J0ZWQnKTsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGlmICghIHRoaXMubm9uY2UpIHsKICAgIHRoaXMubG9nZ2VyLndhcm4oJ2NoYWxsZW5nZSB3aXRob3V0IERpZ2VzdCBub25jZSwgYXV0aGVudGljYXRpb24gYWJvcnRlZCcpOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgLy8gJ3FvcCcgY2FuIGNvbnRhaW4gYSBsaXN0IG9mIHZhbHVlcyAoQXJyYXkpLiBMZXQncyBjaG9vc2UganVzdCBvbmUuCiAgaWYgKGNoYWxsZW5nZS5xb3ApIHsKICAgIGlmIChjaGFsbGVuZ2UucW9wLmluZGV4T2YoJ2F1dGgnKSA+IC0xKSB7CiAgICAgIHRoaXMucW9wID0gJ2F1dGgnOwogICAgfSBlbHNlIGlmIChjaGFsbGVuZ2UucW9wLmluZGV4T2YoJ2F1dGgtaW50JykgPiAtMSkgewogICAgICB0aGlzLnFvcCA9ICdhdXRoLWludCc7CiAgICB9IGVsc2UgewogICAgICAvLyBPdGhlcndpc2UgJ3FvcCcgaXMgcHJlc2VudCBidXQgZG9lcyBub3QgY29udGFpbiAnYXV0aCcgb3IgJ2F1dGgtaW50Jywgc28gYWJvcnQgaGVyZS4KICAgICAgdGhpcy5sb2dnZXIud2FybignY2hhbGxlbmdlIHdpdGhvdXQgRGlnZXN0IHFvcCBkaWZmZXJlbnQgdGhhbiAiYXV0aCIgb3IgImF1dGgtaW50IiwgYXV0aGVudGljYXRpb24gYWJvcnRlZCcpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSBlbHNlIHsKICAgIHRoaXMucW9wID0gbnVsbDsKICB9CgogIC8vIEZpbGwgb3RoZXIgYXR0cmlidXRlcy4KCiAgdGhpcy5tZXRob2QgPSByZXF1ZXN0Lm1ldGhvZDsKICB0aGlzLnVyaSA9IHJlcXVlc3QucnVyaTsKICB0aGlzLmNub25jZSA9IFV0aWxzLmNyZWF0ZVJhbmRvbVRva2VuKDEyKTsKICB0aGlzLm5jICs9IDE7CiAgdGhpcy51cGRhdGVOY0hleCgpOwoKICAvLyBuYy12YWx1ZSA9IDhMSEVYLiBNYXggdmFsdWUgPSAnRkZGRkZGRkYnLgogIGlmICh0aGlzLm5jID09PSA0Mjk0OTY3Mjk2KSB7CiAgICB0aGlzLm5jID0gMTsKICAgIHRoaXMubmNIZXggPSAnMDAwMDAwMDEnOwogIH0KCiAgLy8gQ2FsY3VsYXRlIHRoZSBEaWdlc3QgInJlc3BvbnNlIiB2YWx1ZS4KICB0aGlzLmNhbGN1bGF0ZVJlc3BvbnNlKCk7CgogIHJldHVybiB0cnVlOwp9OwoKCi8qKgoqIEdlbmVyYXRlIERpZ2VzdCAncmVzcG9uc2UnIHZhbHVlLgoqIEBwcml2YXRlCiovCkRpZ2VzdEF1dGhlbnRpY2F0aW9uLnByb3RvdHlwZS5jYWxjdWxhdGVSZXNwb25zZSA9IGZ1bmN0aW9uKCkgewogIHZhciBoYTEsIGhhMjsKCiAgLy8gSEExID0gTUQ1KEExKSA9IE1ENSh1c2VybmFtZTpyZWFsbTpwYXNzd29yZCkKICBoYTEgPSBVdGlscy5jYWxjdWxhdGVNRDUodGhpcy51c2VybmFtZSArICI6IiArIHRoaXMucmVhbG0gKyAiOiIgKyB0aGlzLnBhc3N3b3JkKTsKCiAgaWYgKHRoaXMucW9wID09PSAnYXV0aCcpIHsKICAgIC8vIEhBMiA9IE1ENShBMikgPSBNRDUobWV0aG9kOmRpZ2VzdFVSSSkKICAgIGhhMiA9IFV0aWxzLmNhbGN1bGF0ZU1ENSh0aGlzLm1ldGhvZCArICI6IiArIHRoaXMudXJpKTsKICAgIC8vIHJlc3BvbnNlID0gTUQ1KEhBMTpub25jZTpub25jZUNvdW50OmNyZWRlbnRpYWxzTm9uY2U6cW9wOkhBMikKICAgIHRoaXMucmVzcG9uc2UgPSBVdGlscy5jYWxjdWxhdGVNRDUoaGExICsgIjoiICsgdGhpcy5ub25jZSArICI6IiArIHRoaXMubmNIZXggKyAiOiIgKyB0aGlzLmNub25jZSArICI6YXV0aDoiICsgaGEyKTsKCiAgfSBlbHNlIGlmICh0aGlzLnFvcCA9PT0gJ2F1dGgtaW50JykgewogICAgLy8gSEEyID0gTUQ1KEEyKSA9IE1ENShtZXRob2Q6ZGlnZXN0VVJJOk1ENShlbnRpdHlCb2R5KSkKICAgIGhhMiA9IFV0aWxzLmNhbGN1bGF0ZU1ENSh0aGlzLm1ldGhvZCArICI6IiArIHRoaXMudXJpICsgIjoiICsgVXRpbHMuY2FsY3VsYXRlTUQ1KHRoaXMuYm9keSA/IHRoaXMuYm9keSA6ICIiKSk7CiAgICAvLyByZXNwb25zZSA9IE1ENShIQTE6bm9uY2U6bm9uY2VDb3VudDpjcmVkZW50aWFsc05vbmNlOnFvcDpIQTIpCiAgICB0aGlzLnJlc3BvbnNlID0gVXRpbHMuY2FsY3VsYXRlTUQ1KGhhMSArICI6IiArIHRoaXMubm9uY2UgKyAiOiIgKyB0aGlzLm5jSGV4ICsgIjoiICsgdGhpcy5jbm9uY2UgKyAiOmF1dGgtaW50OiIgKyBoYTIpOwoKICB9IGVsc2UgaWYgKHRoaXMucW9wID09PSBudWxsKSB7CiAgICAvLyBIQTIgPSBNRDUoQTIpID0gTUQ1KG1ldGhvZDpkaWdlc3RVUkkpCiAgICBoYTIgPSBVdGlscy5jYWxjdWxhdGVNRDUodGhpcy5tZXRob2QgKyAiOiIgKyB0aGlzLnVyaSk7CiAgICAvLyByZXNwb25zZSA9IE1ENShIQTE6bm9uY2U6SEEyKQogICAgdGhpcy5yZXNwb25zZSA9IFV0aWxzLmNhbGN1bGF0ZU1ENShoYTEgKyAiOiIgKyB0aGlzLm5vbmNlICsgIjoiICsgaGEyKTsKICB9Cn07CgoKLyoqCiogUmV0dXJuIHRoZSBQcm94eS1BdXRob3JpemF0aW9uIG9yIFdXVy1BdXRob3JpemF0aW9uIGhlYWRlciB2YWx1ZS4KKi8KRGlnZXN0QXV0aGVudGljYXRpb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7CiAgdmFyIGF1dGhfcGFyYW1zID0gW107CgogIGlmICghIHRoaXMucmVzcG9uc2UpIHsKICAgIHRocm93IG5ldyBFcnJvcigncmVzcG9uc2UgZmllbGQgZG9lcyBub3QgZXhpc3QsIGNhbm5vdCBnZW5lcmF0ZSBBdXRob3JpemF0aW9uIGhlYWRlcicpOwogIH0KCiAgYXV0aF9wYXJhbXMucHVzaCgnYWxnb3JpdGhtPScgKyB0aGlzLmFsZ29yaXRobSk7CiAgYXV0aF9wYXJhbXMucHVzaCgndXNlcm5hbWU9IicgKyB0aGlzLnVzZXJuYW1lICsgJyInKTsKICBhdXRoX3BhcmFtcy5wdXNoKCdyZWFsbT0iJyArIHRoaXMucmVhbG0gKyAnIicpOwogIGF1dGhfcGFyYW1zLnB1c2goJ25vbmNlPSInICsgdGhpcy5ub25jZSArICciJyk7CiAgYXV0aF9wYXJhbXMucHVzaCgndXJpPSInICsgdGhpcy51cmkgKyAnIicpOwogIGF1dGhfcGFyYW1zLnB1c2goJ3Jlc3BvbnNlPSInICsgdGhpcy5yZXNwb25zZSArICciJyk7CiAgaWYgKHRoaXMub3BhcXVlKSB7CiAgICBhdXRoX3BhcmFtcy5wdXNoKCdvcGFxdWU9IicgKyB0aGlzLm9wYXF1ZSArICciJyk7CiAgfQogIGlmICh0aGlzLnFvcCkgewogICAgYXV0aF9wYXJhbXMucHVzaCgncW9wPScgKyB0aGlzLnFvcCk7CiAgICBhdXRoX3BhcmFtcy5wdXNoKCdjbm9uY2U9IicgKyB0aGlzLmNub25jZSArICciJyk7CiAgICBhdXRoX3BhcmFtcy5wdXNoKCduYz0nICsgdGhpcy5uY0hleCk7CiAgfQoKICByZXR1cm4gJ0RpZ2VzdCAnICsgYXV0aF9wYXJhbXMuam9pbignLCAnKTsKfTsKCgovKioKKiBHZW5lcmF0ZSB0aGUgJ25jJyB2YWx1ZSBhcyByZXF1aXJlZCBieSBEaWdlc3QgaW4gdGhpcy5uY0hleCBieSByZWFkaW5nIHRoaXMubmMuCiogQHByaXZhdGUKKi8KRGlnZXN0QXV0aGVudGljYXRpb24ucHJvdG90eXBlLnVwZGF0ZU5jSGV4ID0gZnVuY3Rpb24oKSB7CiAgdmFyIGhleCA9IE51bWJlcih0aGlzLm5jKS50b1N0cmluZygxNik7CiAgdGhpcy5uY0hleCA9ICcwMDAwMDAwMCcuc3Vic3RyKDAsIDgtaGV4Lmxlbmd0aCkgKyBoZXg7Cn07CgpyZXR1cm4gRGlnZXN0QXV0aGVudGljYXRpb247Cn07Cgp9LHt9XSwxNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKdmFyIE5vZGVFdmVudEVtaXR0ZXIgPSByZXF1aXJlKCdldmVudHMnKS5FdmVudEVtaXR0ZXI7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChjb25zb2xlKSB7CgovLyBEb24ndCB1c2UgYG5ldyBTSVAuRXZlbnRFbWl0dGVyKClgIGZvciBpbmhlcml0aW5nLgovLyBVc2UgT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdG95cGUpOwpmdW5jdGlvbiBFdmVudEVtaXR0ZXIgKCkgewogIE5vZGVFdmVudEVtaXR0ZXIuY2FsbCh0aGlzKTsKfQoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTm9kZUV2ZW50RW1pdHRlci5wcm90b3R5cGUsIHsKICBjb25zdHJ1Y3RvcjogewogICAgdmFsdWU6IEV2ZW50RW1pdHRlciwKICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgd3JpdGFibGU6IHRydWUsCiAgICBjb25maWd1cmFibGU6IHRydWUKICB9Cn0pOwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiBvZmYgKGV2ZW50TmFtZSwgbGlzdGVuZXIpIHsKICB2YXIgd2FybmluZyA9ICcnOwogIHdhcm5pbmcgKz0gJ1NJUC5FdmVudEVtaXR0ZXIjb2ZmIGlzIGRlcHJlY2F0ZWQgYW5kIG1heSBiZSByZW1vdmVkIGluIGZ1dHVyZSBTSVAuanMgdmVyc2lvbnMuXG4nOwogIHdhcm5pbmcgKz0gJ1BsZWFzZSB1c2UgcmVtb3ZlTGlzdGVuZXIgb3IgcmVtb3ZlQWxsTGlzdGVuZXJzIGluc3RlYWQuXG4nOwogIHdhcm5pbmcgKz0gJ1NlZSBoZXJlIGZvciBtb3JlIGRldGFpbHM6XG4nOwogIHdhcm5pbmcgKz0gJ2h0dHA6Ly9ub2RlanMub3JnL2FwaS9ldmVudHMuaHRtbCNldmVudHNfZW1pdHRlcl9yZW1vdmVsaXN0ZW5lcl9ldmVudF9saXN0ZW5lcic7CiAgY29uc29sZS53YXJuKHdhcm5pbmcpOwoKICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDIpIHsKICAgIHJldHVybiB0aGlzLnJlbW92ZUFsbExpc3RlbmVycy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdGhpcy5yZW1vdmVMaXN0ZW5lcihldmVudE5hbWUsIGxpc3RlbmVyKTsKICB9Cn07CgpyZXR1cm4gRXZlbnRFbWl0dGVyOwoKfTsKCn0seyJldmVudHMiOjF9XSwxNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgRXhjZXB0aW9ucwogKi8KCi8qKgogKiBTSVAgRXhjZXB0aW9ucy4KICogQGF1Z21lbnRzIFNJUAogKi8KbW9kdWxlLmV4cG9ydHMgPSB7CiAgQ29uZmlndXJhdGlvbkVycm9yOiAoZnVuY3Rpb24oKXsKICAgIHZhciBleGNlcHRpb24gPSBmdW5jdGlvbihwYXJhbWV0ZXIsIHZhbHVlKSB7CiAgICAgIHRoaXMuY29kZSA9IDE7CiAgICAgIHRoaXMubmFtZSA9ICdDT05GSUdVUkFUSU9OX0VSUk9SJzsKICAgICAgdGhpcy5wYXJhbWV0ZXIgPSBwYXJhbWV0ZXI7CiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKICAgICAgdGhpcy5tZXNzYWdlID0gKCF0aGlzLnZhbHVlKT8gJ01pc3NpbmcgcGFyYW1ldGVyOiAnKyB0aGlzLnBhcmFtZXRlciA6ICdJbnZhbGlkIHZhbHVlICcrIEpTT04uc3RyaW5naWZ5KHRoaXMudmFsdWUpICsnIGZvciBwYXJhbWV0ZXIgIicrIHRoaXMucGFyYW1ldGVyICsnIic7CiAgICB9OwogICAgZXhjZXB0aW9uLnByb3RvdHlwZSA9IG5ldyBFcnJvcigpOwogICAgcmV0dXJuIGV4Y2VwdGlvbjsKICB9KCkpLAoKICBJbnZhbGlkU3RhdGVFcnJvcjogKGZ1bmN0aW9uKCl7CiAgICB2YXIgZXhjZXB0aW9uID0gZnVuY3Rpb24oc3RhdHVzKSB7CiAgICAgIHRoaXMuY29kZSA9IDI7CiAgICAgIHRoaXMubmFtZSA9ICdJTlZBTElEX1NUQVRFX0VSUk9SJzsKICAgICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7CiAgICAgIHRoaXMubWVzc2FnZSA9ICdJbnZhbGlkIHN0YXR1czogJyArIHN0YXR1czsKICAgIH07CiAgICBleGNlcHRpb24ucHJvdG90eXBlID0gbmV3IEVycm9yKCk7CiAgICByZXR1cm4gZXhjZXB0aW9uOwogIH0oKSksCgogIE5vdFN1cHBvcnRlZEVycm9yOiAoZnVuY3Rpb24oKXsKICAgIHZhciBleGNlcHRpb24gPSBmdW5jdGlvbihtZXNzYWdlKSB7CiAgICAgIHRoaXMuY29kZSA9IDM7CiAgICAgIHRoaXMubmFtZSA9ICdOT1RfU1VQUE9SVEVEX0VSUk9SJzsKICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKICAgIH07CiAgICBleGNlcHRpb24ucHJvdG90eXBlID0gbmV3IEVycm9yKCk7CiAgICByZXR1cm4gZXhjZXB0aW9uOwogIH0oKSksCgogIEdldERlc2NyaXB0aW9uRXJyb3I6IChmdW5jdGlvbigpewogICAgdmFyIGV4Y2VwdGlvbiA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHsKICAgICAgdGhpcy5jb2RlID0gNDsKICAgICAgdGhpcy5uYW1lID0gJ0dFVF9ERVNDUklQVElPTl9FUlJPUic7CiAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7CiAgICB9OwogICAgZXhjZXB0aW9uLnByb3RvdHlwZSA9IG5ldyBFcnJvcigpOwogICAgcmV0dXJuIGV4Y2VwdGlvbjsKICB9KCkpCn07Cgp9LHt9XSwxNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKdmFyIEdyYW1tYXIgPSByZXF1aXJlKCcuL0dyYW1tYXIvZGlzdC9HcmFtbWFyJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKCnJldHVybiB7CiAgcGFyc2U6IGZ1bmN0aW9uIHBhcnNlQ3VzdG9tIChpbnB1dCwgc3RhcnRSdWxlKSB7CiAgICB2YXIgb3B0aW9ucyA9IHtzdGFydFJ1bGU6IHN0YXJ0UnVsZSwgU0lQOiBTSVB9OwogICAgdHJ5IHsKICAgICAgR3JhbW1hci5wYXJzZShpbnB1dCwgb3B0aW9ucyk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIG9wdGlvbnMuZGF0YSA9IC0xOwogICAgfQogICAgcmV0dXJuIG9wdGlvbnMuZGF0YTsKICB9Cn07Cgp9OwoKfSx7Ii4vR3JhbW1hci9kaXN0L0dyYW1tYXIiOjE4fV0sMTg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewptb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHsKICAvKgogICAqIEdlbmVyYXRlZCBieSBQRUcuanMgMC44LjAuCiAgICoKICAgKiBodHRwOi8vcGVnanMubWFqZGEuY3ovCiAgICovCgogIGZ1bmN0aW9uIHBlZyRzdWJjbGFzcyhjaGlsZCwgcGFyZW50KSB7CiAgICBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0KICAgIGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsKICAgIGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7CiAgfQoKICBmdW5jdGlvbiBTeW50YXhFcnJvcihtZXNzYWdlLCBleHBlY3RlZCwgZm91bmQsIG9mZnNldCwgbGluZSwgY29sdW1uKSB7CiAgICB0aGlzLm1lc3NhZ2UgID0gbWVzc2FnZTsKICAgIHRoaXMuZXhwZWN0ZWQgPSBleHBlY3RlZDsKICAgIHRoaXMuZm91bmQgICAgPSBmb3VuZDsKICAgIHRoaXMub2Zmc2V0ICAgPSBvZmZzZXQ7CiAgICB0aGlzLmxpbmUgICAgID0gbGluZTsKICAgIHRoaXMuY29sdW1uICAgPSBjb2x1bW47CgogICAgdGhpcy5uYW1lICAgICA9ICJTeW50YXhFcnJvciI7CiAgfQoKICBwZWckc3ViY2xhc3MoU3ludGF4RXJyb3IsIEVycm9yKTsKCiAgZnVuY3Rpb24gcGFyc2UoaW5wdXQpIHsKICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB7fSwKCiAgICAgICAgcGVnJEZBSUxFRCA9IHt9LAoKICAgICAgICBwZWckc3RhcnRSdWxlSW5kaWNlcyA9IHsgQ29udGFjdDogMTE4LCBOYW1lX0FkZHJfSGVhZGVyOiAxNTUsIFJlY29yZF9Sb3V0ZTogMTc1LCBSZXF1ZXN0X1Jlc3BvbnNlOiA4MSwgU0lQX1VSSTogNDUsIFN1YnNjcmlwdGlvbl9TdGF0ZTogMTg1LCBTdXBwb3J0ZWQ6IDE5MCwgUmVxdWlyZTogMTgxLCBWaWE6IDE5MywgYWJzb2x1dGVVUkk6IDg0LCBDYWxsX0lEOiAxMTcsIENvbnRlbnRfRGlzcG9zaXRpb246IDEyOSwgQ29udGVudF9MZW5ndGg6IDEzNCwgQ29udGVudF9UeXBlOiAxMzUsIENTZXE6IDE0NSwgZGlzcGxheU5hbWU6IDEyMSwgRXZlbnQ6IDE0OCwgRnJvbTogMTUwLCBob3N0OiA1MiwgTWF4X0ZvcndhcmRzOiAxNTMsIE1pbl9TRTogMjEyLCBQcm94eV9BdXRoZW50aWNhdGU6IDE1NiwgcXVvdGVkX3N0cmluZzogNDAsIFJlZmVyX1RvOiAxNzcsIFJlcGxhY2VzOiAxNzgsIFNlc3Npb25fRXhwaXJlczogMjA5LCBzdHVuX1VSSTogMjE2LCBUbzogMTkxLCB0dXJuX1VSSTogMjIzLCB1dWlkOiAyMjYsIFdXV19BdXRoZW50aWNhdGU6IDIwOCwgY2hhbGxlbmdlOiAxNTcgfSwKICAgICAgICBwZWckc3RhcnRSdWxlSW5kZXggICA9IDExOCwKCiAgICAgICAgcGVnJGNvbnN0cyA9IFsKICAgICAgICAgICJcclxuIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlxyXG4iLCBkZXNjcmlwdGlvbjogIlwiXFxyXFxuXCIiIH0sCiAgICAgICAgICAvXlswLTldLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbMC05XSIsIGRlc2NyaXB0aW9uOiAiWzAtOV0iIH0sCiAgICAgICAgICAvXlthLXpBLVpdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbYS16QS1aXSIsIGRlc2NyaXB0aW9uOiAiW2EtekEtWl0iIH0sCiAgICAgICAgICAvXlswLTlhLWZBLUZdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbMC05YS1mQS1GXSIsIGRlc2NyaXB0aW9uOiAiWzAtOWEtZkEtRl0iIH0sCiAgICAgICAgICAvXltcMC1ceEZGXS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW1xcMC1cXHhGRl0iLCBkZXNjcmlwdGlvbjogIltcXDAtXFx4RkZdIiB9LAogICAgICAgICAgL15bIl0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcIl0iLCBkZXNjcmlwdGlvbjogIltcIl0iIH0sCiAgICAgICAgICAiICIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIgIiwgZGVzY3JpcHRpb246ICJcIiBcIiIgfSwKICAgICAgICAgICJcdCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJcdCIsIGRlc2NyaXB0aW9uOiAiXCJcXHRcIiIgfSwKICAgICAgICAgIC9eW2EtekEtWjAtOV0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIlthLXpBLVowLTldIiwgZGVzY3JpcHRpb246ICJbYS16QS1aMC05XSIgfSwKICAgICAgICAgICI7IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIjsiLCBkZXNjcmlwdGlvbjogIlwiO1wiIiB9LAogICAgICAgICAgIi8iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiLyIsIGRlc2NyaXB0aW9uOiAiXCIvXCIiIH0sCiAgICAgICAgICAiPyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICI/IiwgZGVzY3JpcHRpb246ICJcIj9cIiIgfSwKICAgICAgICAgICI6IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIjoiLCBkZXNjcmlwdGlvbjogIlwiOlwiIiB9LAogICAgICAgICAgIkAiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiQCIsIGRlc2NyaXB0aW9uOiAiXCJAXCIiIH0sCiAgICAgICAgICAiJiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICImIiwgZGVzY3JpcHRpb246ICJcIiZcIiIgfSwKICAgICAgICAgICI9IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIj0iLCBkZXNjcmlwdGlvbjogIlwiPVwiIiB9LAogICAgICAgICAgIisiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiKyIsIGRlc2NyaXB0aW9uOiAiXCIrXCIiIH0sCiAgICAgICAgICAiJCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIkIiwgZGVzY3JpcHRpb246ICJcIiRcIiIgfSwKICAgICAgICAgICIsIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIiwiLCBkZXNjcmlwdGlvbjogIlwiLFwiIiB9LAogICAgICAgICAgIi0iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiLSIsIGRlc2NyaXB0aW9uOiAiXCItXCIiIH0sCiAgICAgICAgICAiXyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJfIiwgZGVzY3JpcHRpb246ICJcIl9cIiIgfSwKICAgICAgICAgICIuIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIi4iLCBkZXNjcmlwdGlvbjogIlwiLlwiIiB9LAogICAgICAgICAgIiEiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiISIsIGRlc2NyaXB0aW9uOiAiXCIhXCIiIH0sCiAgICAgICAgICAifiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ+IiwgZGVzY3JpcHRpb246ICJcIn5cIiIgfSwKICAgICAgICAgICIqIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIioiLCBkZXNjcmlwdGlvbjogIlwiKlwiIiB9LAogICAgICAgICAgIiciLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiJyIsIGRlc2NyaXB0aW9uOiAiXCInXCIiIH0sCiAgICAgICAgICAiKCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIoIiwgZGVzY3JpcHRpb246ICJcIihcIiIgfSwKICAgICAgICAgICIpIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIikiLCBkZXNjcmlwdGlvbjogIlwiKVwiIiB9LAogICAgICAgICAgcGVnJEZBSUxFRCwKICAgICAgICAgICIlIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIiUiLCBkZXNjcmlwdGlvbjogIlwiJVwiIiB9LAogICAgICAgICAgbnVsbCwKICAgICAgICAgIFtdLAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICIgIjsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAnOic7IH0sCiAgICAgICAgICAvXlshLX5dLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbIS1+XSIsIGRlc2NyaXB0aW9uOiAiWyEtfl0iIH0sCiAgICAgICAgICAvXltceDgwLVx1RkZGRl0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcXHg4MC1cXHVGRkZGXSIsIGRlc2NyaXB0aW9uOiAiW1xceDgwLVxcdUZGRkZdIiB9LAogICAgICAgICAgL15bXHg4MC1ceEJGXS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW1xceDgwLVxceEJGXSIsIGRlc2NyaXB0aW9uOiAiW1xceDgwLVxceEJGXSIgfSwKICAgICAgICAgIC9eW2EtZl0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIlthLWZdIiwgZGVzY3JpcHRpb246ICJbYS1mXSIgfSwKICAgICAgICAgICJgIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImAiLCBkZXNjcmlwdGlvbjogIlwiYFwiIiB9LAogICAgICAgICAgIjwiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiPCIsIGRlc2NyaXB0aW9uOiAiXCI8XCIiIH0sCiAgICAgICAgICAiPiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICI+IiwgZGVzY3JpcHRpb246ICJcIj5cIiIgfSwKICAgICAgICAgICJcXCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJcXCIsIGRlc2NyaXB0aW9uOiAiXCJcXFxcXCIiIH0sCiAgICAgICAgICAiWyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJbIiwgZGVzY3JpcHRpb246ICJcIltcIiIgfSwKICAgICAgICAgICJdIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIl0iLCBkZXNjcmlwdGlvbjogIlwiXVwiIiB9LAogICAgICAgICAgInsiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAieyIsIGRlc2NyaXB0aW9uOiAiXCJ7XCIiIH0sCiAgICAgICAgICAifSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ9IiwgZGVzY3JpcHRpb246ICJcIn1cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiKiI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIi8iOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICI9IjsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiKCI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIikiOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICI+IjsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiPCI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIiwiOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICI7IjsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiOiI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIlwiIjsgfSwKICAgICAgICAgIC9eWyEtJ10vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIlshLSddIiwgZGVzY3JpcHRpb246ICJbIS0nXSIgfSwKICAgICAgICAgIC9eWyotW10vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIlsqLVtdIiwgZGVzY3JpcHRpb246ICJbKi1bXSIgfSwKICAgICAgICAgIC9eW1xdLX5dLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbXFxdLX5dIiwgZGVzY3JpcHRpb246ICJbXFxdLX5dIiB9LAogICAgICAgICAgZnVuY3Rpb24oY29udGVudHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZW50czsgfSwKICAgICAgICAgIC9eWyMtW10vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIlsjLVtdIiwgZGVzY3JpcHRpb246ICJbIy1bXSIgfSwKICAgICAgICAgIC9eW1wwLVx0XS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW1xcMC1cXHRdIiwgZGVzY3JpcHRpb246ICJbXFwwLVxcdF0iIH0sCiAgICAgICAgICAvXltceDBCLVxmXS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW1xceDBCLVxcZl0iLCBkZXNjcmlwdGlvbjogIltcXHgwQi1cXGZdIiB9LAogICAgICAgICAgL15bXHgwRS1/XS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW1xceDBFLX9dIiwgZGVzY3JpcHRpb246ICJbXFx4MEUtf10iIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS51cmkgPSBuZXcgb3B0aW9ucy5TSVAuVVJJKG9wdGlvbnMuZGF0YS5zY2hlbWUsIG9wdGlvbnMuZGF0YS51c2VyLCBvcHRpb25zLmRhdGEuaG9zdCwgb3B0aW9ucy5kYXRhLnBvcnQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5zY2hlbWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnVzZXI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLmhvc3Q7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLmhvc3RfdHlwZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEucG9ydDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpID0gbmV3IG9wdGlvbnMuU0lQLlVSSShvcHRpb25zLmRhdGEuc2NoZW1lLCBvcHRpb25zLmRhdGEudXNlciwgb3B0aW9ucy5kYXRhLmhvc3QsIG9wdGlvbnMuZGF0YS5wb3J0LCBvcHRpb25zLmRhdGEudXJpX3BhcmFtcywgb3B0aW9ucy5kYXRhLnVyaV9oZWFkZXJzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEuc2NoZW1lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS51c2VyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5ob3N0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5ob3N0X3R5cGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnBvcnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXM7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3RhcnRSdWxlID09PSAnU0lQX1VSSScpIHsgb3B0aW9ucy5kYXRhID0gb3B0aW9ucy5kYXRhLnVyaTt9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICJzaXBzIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInNpcHMiLCBkZXNjcmlwdGlvbjogIlwic2lwc1wiIiB9LAogICAgICAgICAgInNpcCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJzaXAiLCBkZXNjcmlwdGlvbjogIlwic2lwXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbih1cmlfc2NoZW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5zY2hlbWUgPSB1cmlfc2NoZW1lOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS51c2VyID0gZGVjb2RlVVJJQ29tcG9uZW50KHRleHQoKS5zbGljZSgwLCAtMSkpO30sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnBhc3N3b3JkID0gdGV4dCgpOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5ob3N0ID0gdGV4dCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9ucy5kYXRhLmhvc3Q7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5ob3N0X3R5cGUgPSAnZG9tYWluJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0KCk7IH0sCiAgICAgICAgICAvXlthLXpBLVowLTlfXC1dLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbYS16QS1aMC05X1xcLV0iLCBkZXNjcmlwdGlvbjogIlthLXpBLVowLTlfXFwtXSIgfSwKICAgICAgICAgIC9eW2EtekEtWjAtOVwtXS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW2EtekEtWjAtOVxcLV0iLCBkZXNjcmlwdGlvbjogIlthLXpBLVowLTlcXC1dIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5ob3N0X3R5cGUgPSAnSVB2Nic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0KCk7IH0sCiAgICAgICAgICAiOjoiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiOjoiLCBkZXNjcmlwdGlvbjogIlwiOjpcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLmhvc3RfdHlwZSA9ICdJUHY2JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0KCk7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLmhvc3RfdHlwZSA9ICdJUHY0JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRleHQoKTsgfSwKICAgICAgICAgICIyNSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIyNSIsIGRlc2NyaXB0aW9uOiAiXCIyNVwiIiB9LAogICAgICAgICAgL15bMC01XS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiWzAtNV0iLCBkZXNjcmlwdGlvbjogIlswLTVdIiB9LAogICAgICAgICAgIjIiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiMiIsIGRlc2NyaXB0aW9uOiAiXCIyXCIiIH0sCiAgICAgICAgICAvXlswLTRdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbMC00XSIsIGRlc2NyaXB0aW9uOiAiWzAtNF0iIH0sCiAgICAgICAgICAiMSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIxIiwgZGVzY3JpcHRpb246ICJcIjFcIiIgfSwKICAgICAgICAgIC9eWzEtOV0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIlsxLTldIiwgZGVzY3JpcHRpb246ICJbMS05XSIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHBvcnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9ydCA9IHBhcnNlSW50KHBvcnQuam9pbignJykpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEucG9ydCA9IHBvcnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb3J0OyB9LAogICAgICAgICAgInRyYW5zcG9ydD0iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidHJhbnNwb3J0PSIsIGRlc2NyaXB0aW9uOiAiXCJ0cmFuc3BvcnQ9XCIiIH0sCiAgICAgICAgICAidWRwIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInVkcCIsIGRlc2NyaXB0aW9uOiAiXCJ1ZHBcIiIgfSwKICAgICAgICAgICJ0Y3AiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidGNwIiwgZGVzY3JpcHRpb246ICJcInRjcFwiIiB9LAogICAgICAgICAgInNjdHAiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAic2N0cCIsIGRlc2NyaXB0aW9uOiAiXCJzY3RwXCIiIH0sCiAgICAgICAgICAidGxzIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInRscyIsIGRlc2NyaXB0aW9uOiAiXCJ0bHNcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHRyYW5zcG9ydCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEudXJpX3BhcmFtcykgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXM9e307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXNbJ3RyYW5zcG9ydCddID0gdHJhbnNwb3J0LnRvTG93ZXJDYXNlKCk7IH0sCiAgICAgICAgICAidXNlcj0iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidXNlcj0iLCBkZXNjcmlwdGlvbjogIlwidXNlcj1cIiIgfSwKICAgICAgICAgICJwaG9uZSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJwaG9uZSIsIGRlc2NyaXB0aW9uOiAiXCJwaG9uZVwiIiB9LAogICAgICAgICAgImlwIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImlwIiwgZGVzY3JpcHRpb246ICJcImlwXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbih1c2VyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS51cmlfcGFyYW1zKSBvcHRpb25zLmRhdGEudXJpX3BhcmFtcz17fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpX3BhcmFtc1sndXNlciddID0gdXNlci50b0xvd2VyQ2FzZSgpOyB9LAogICAgICAgICAgIm1ldGhvZD0iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAibWV0aG9kPSIsIGRlc2NyaXB0aW9uOiAiXCJtZXRob2Q9XCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXMpIG9wdGlvbnMuZGF0YS51cmlfcGFyYW1zPXt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS51cmlfcGFyYW1zWydtZXRob2QnXSA9IG1ldGhvZDsgfSwKICAgICAgICAgICJ0dGw9IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInR0bD0iLCBkZXNjcmlwdGlvbjogIlwidHRsPVwiIiB9LAogICAgICAgICAgZnVuY3Rpb24odHRsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS5wYXJhbXMpIG9wdGlvbnMuZGF0YS5wYXJhbXM9e307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnBhcmFtc1sndHRsJ10gPSB0dGw7IH0sCiAgICAgICAgICAibWFkZHI9IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm1hZGRyPSIsIGRlc2NyaXB0aW9uOiAiXCJtYWRkcj1cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKG1hZGRyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS51cmlfcGFyYW1zKSBvcHRpb25zLmRhdGEudXJpX3BhcmFtcz17fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpX3BhcmFtc1snbWFkZHInXSA9IG1hZGRyOyB9LAogICAgICAgICAgImxyIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImxyIiwgZGVzY3JpcHRpb246ICJcImxyXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXMpIG9wdGlvbnMuZGF0YS51cmlfcGFyYW1zPXt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS51cmlfcGFyYW1zWydsciddID0gdW5kZWZpbmVkOyB9LAogICAgICAgICAgZnVuY3Rpb24ocGFyYW0sIHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS51cmlfcGFyYW1zKSBvcHRpb25zLmRhdGEudXJpX3BhcmFtcyA9IHt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlWzFdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpX3BhcmFtc1twYXJhbS50b0xvd2VyQ2FzZSgpXSA9IHZhbHVlICYmIHZhbHVlLnRvTG93ZXJDYXNlKCk7fSwKICAgICAgICAgIGZ1bmN0aW9uKGhuYW1lLCBodmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBobmFtZSA9IGhuYW1lLmpvaW4oJycpLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHZhbHVlID0gaHZhbHVlLmpvaW4oJycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEudXJpX2hlYWRlcnMpIG9wdGlvbnMuZGF0YS51cmlfaGVhZGVycyA9IHt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghb3B0aW9ucy5kYXRhLnVyaV9oZWFkZXJzW2huYW1lXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaV9oZWFkZXJzW2huYW1lXSA9IFtodmFsdWVdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpX2hlYWRlcnNbaG5hbWVdLnB1c2goaHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxvdHMgb2YgdGVzdHMgZmFpbCBpZiB0aGlzIGlzbid0IGd1YXJkZWQuLi4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5zdGFydFJ1bGUgPT09ICdSZWZlcl9UbycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS51cmkgPSBuZXcgb3B0aW9ucy5TSVAuVVJJKG9wdGlvbnMuZGF0YS5zY2hlbWUsIG9wdGlvbnMuZGF0YS51c2VyLCBvcHRpb25zLmRhdGEuaG9zdCwgb3B0aW9ucy5kYXRhLnBvcnQsIG9wdGlvbnMuZGF0YS51cmlfcGFyYW1zLCBvcHRpb25zLmRhdGEudXJpX2hlYWRlcnMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5zY2hlbWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnVzZXI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLmhvc3Q7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLmhvc3RfdHlwZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEucG9ydDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEudXJpX3BhcmFtczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAiLy8iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiLy8iLCBkZXNjcmlwdGlvbjogIlwiLy9cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuc2NoZW1lPSB0ZXh0KCk7IH0sCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJTSVAiLCBkZXNjcmlwdGlvbjogIlwiU0lQXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnNpcF92ZXJzaW9uID0gdGV4dCgpOyB9LAogICAgICAgICAgIklOVklURSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJJTlZJVEUiLCBkZXNjcmlwdGlvbjogIlwiSU5WSVRFXCIiIH0sCiAgICAgICAgICAiQUNLIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIkFDSyIsIGRlc2NyaXB0aW9uOiAiXCJBQ0tcIiIgfSwKICAgICAgICAgICJWWEFDSCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJWWEFDSCIsIGRlc2NyaXB0aW9uOiAiXCJWWEFDSFwiIiB9LAogICAgICAgICAgIk9QVElPTlMiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiT1BUSU9OUyIsIGRlc2NyaXB0aW9uOiAiXCJPUFRJT05TXCIiIH0sCiAgICAgICAgICAiQllFIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIkJZRSIsIGRlc2NyaXB0aW9uOiAiXCJCWUVcIiIgfSwKICAgICAgICAgICJDQU5DRUwiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiQ0FOQ0VMIiwgZGVzY3JpcHRpb246ICJcIkNBTkNFTFwiIiB9LAogICAgICAgICAgIlJFR0lTVEVSIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlJFR0lTVEVSIiwgZGVzY3JpcHRpb246ICJcIlJFR0lTVEVSXCIiIH0sCiAgICAgICAgICAiU1VCU0NSSUJFIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlNVQlNDUklCRSIsIGRlc2NyaXB0aW9uOiAiXCJTVUJTQ1JJQkVcIiIgfSwKICAgICAgICAgICJOT1RJRlkiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiTk9USUZZIiwgZGVzY3JpcHRpb246ICJcIk5PVElGWVwiIiB9LAogICAgICAgICAgIlJFRkVSIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlJFRkVSIiwgZGVzY3JpcHRpb246ICJcIlJFRkVSXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5tZXRob2QgPSB0ZXh0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcHRpb25zLmRhdGEubWV0aG9kOyB9LAogICAgICAgICAgZnVuY3Rpb24oc3RhdHVzX2NvZGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5zdGF0dXNfY29kZSA9IHBhcnNlSW50KHN0YXR1c19jb2RlLmpvaW4oJycpKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnJlYXNvbl9waHJhc2UgPSB0ZXh0KCk7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gdGV4dCgpOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4LCBsZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGggPSBvcHRpb25zLmRhdGEubXVsdGlfaGVhZGVyLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5kYXRhLm11bHRpX2hlYWRlcltpZHhdLnBhcnNlZCA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmRhdGEgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gb3B0aW9ucy5kYXRhLm11bHRpX2hlYWRlcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IC0xOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoZWFkZXI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighb3B0aW9ucy5kYXRhLm11bHRpX2hlYWRlcikgb3B0aW9ucy5kYXRhLm11bHRpX2hlYWRlciA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyID0gbmV3IG9wdGlvbnMuU0lQLk5hbWVBZGRySGVhZGVyKG9wdGlvbnMuZGF0YS51cmksIG9wdGlvbnMuZGF0YS5kaXNwbGF5TmFtZSwgb3B0aW9ucy5kYXRhLnBhcmFtcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEudXJpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLmRpc3BsYXlOYW1lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnBhcmFtczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2goZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXIgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLm11bHRpX2hlYWRlci5wdXNoKCB7ICdwb3NpdGlvbic6IHBlZyRjdXJyUG9zLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb2Zmc2V0Jzogb2Zmc2V0KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwYXJzZWQnOiBoZWFkZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO30sCiAgICAgICAgICBmdW5jdGlvbihkaXNwbGF5TmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWUgPSB0ZXh0KCkudHJpbSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRpc3BsYXlOYW1lWzBdID09PSAnXCInKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lID0gZGlzcGxheU5hbWUuc3Vic3RyaW5nKDEsIGRpc3BsYXlOYW1lLmxlbmd0aC0xKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5kaXNwbGF5TmFtZSA9IGRpc3BsYXlOYW1lOyB9LAogICAgICAgICAgInEiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicSIsIGRlc2NyaXB0aW9uOiAiXCJxXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighb3B0aW9ucy5kYXRhLnBhcmFtcykgb3B0aW9ucy5kYXRhLnBhcmFtcyA9IHt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnBhcmFtc1sncSddID0gcTsgfSwKICAgICAgICAgICJleHBpcmVzIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImV4cGlyZXMiLCBkZXNjcmlwdGlvbjogIlwiZXhwaXJlc1wiIiB9LAogICAgICAgICAgZnVuY3Rpb24oZXhwaXJlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS5wYXJhbXMpIG9wdGlvbnMuZGF0YS5wYXJhbXMgPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5wYXJhbXNbJ2V4cGlyZXMnXSA9IGV4cGlyZXM7IH0sCiAgICAgICAgICBmdW5jdGlvbihkZWx0YV9zZWNvbmRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoZGVsdGFfc2Vjb25kcy5qb2luKCcnKSk7IH0sCiAgICAgICAgICAiMCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIwIiwgZGVzY3JpcHRpb246ICJcIjBcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQodGV4dCgpKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKHBhcmFtLCB2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS5wYXJhbXMpIG9wdGlvbnMuZGF0YS5wYXJhbXMgPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVbMV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEucGFyYW1zW3BhcmFtLnRvTG93ZXJDYXNlKCldID0gdmFsdWU7fSwKICAgICAgICAgICJyZW5kZXIiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicmVuZGVyIiwgZGVzY3JpcHRpb246ICJcInJlbmRlclwiIiB9LAogICAgICAgICAgInNlc3Npb24iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAic2Vzc2lvbiIsIGRlc2NyaXB0aW9uOiAiXCJzZXNzaW9uXCIiIH0sCiAgICAgICAgICAiaWNvbiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJpY29uIiwgZGVzY3JpcHRpb246ICJcImljb25cIiIgfSwKICAgICAgICAgICJhbGVydCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJhbGVydCIsIGRlc2NyaXB0aW9uOiAiXCJhbGVydFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3RhcnRSdWxlID09PSAnQ29udGVudF9EaXNwb3NpdGlvbicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS50eXBlID0gdGV4dCgpLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgImhhbmRsaW5nIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImhhbmRsaW5nIiwgZGVzY3JpcHRpb246ICJcImhhbmRsaW5nXCIiIH0sCiAgICAgICAgICAib3B0aW9uYWwiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAib3B0aW9uYWwiLCBkZXNjcmlwdGlvbjogIlwib3B0aW9uYWxcIiIgfSwKICAgICAgICAgICJyZXF1aXJlZCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJyZXF1aXJlZCIsIGRlc2NyaXB0aW9uOiAiXCJyZXF1aXJlZFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24obGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBwYXJzZUludChsZW5ndGguam9pbignJykpOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSB0ZXh0KCk7IH0sCiAgICAgICAgICAidGV4dCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ0ZXh0IiwgZGVzY3JpcHRpb246ICJcInRleHRcIiIgfSwKICAgICAgICAgICJpbWFnZSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJpbWFnZSIsIGRlc2NyaXB0aW9uOiAiXCJpbWFnZVwiIiB9LAogICAgICAgICAgImF1ZGlvIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImF1ZGlvIiwgZGVzY3JpcHRpb246ICJcImF1ZGlvXCIiIH0sCiAgICAgICAgICAidmlkZW8iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidmlkZW8iLCBkZXNjcmlwdGlvbjogIlwidmlkZW9cIiIgfSwKICAgICAgICAgICJhcHBsaWNhdGlvbiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJhcHBsaWNhdGlvbiIsIGRlc2NyaXB0aW9uOiAiXCJhcHBsaWNhdGlvblwiIiB9LAogICAgICAgICAgIm1lc3NhZ2UiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAibWVzc2FnZSIsIGRlc2NyaXB0aW9uOiAiXCJtZXNzYWdlXCIiIH0sCiAgICAgICAgICAibXVsdGlwYXJ0IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm11bHRpcGFydCIsIGRlc2NyaXB0aW9uOiAiXCJtdWx0aXBhcnRcIiIgfSwKICAgICAgICAgICJ4LSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ4LSIsIGRlc2NyaXB0aW9uOiAiXCJ4LVwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oY3NlcV92YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnZhbHVlPXBhcnNlSW50KGNzZXFfdmFsdWUuam9pbignJykpOyB9LAogICAgICAgICAgZnVuY3Rpb24oZXhwaXJlcykge29wdGlvbnMuZGF0YSA9IGV4cGlyZXM7IH0sCiAgICAgICAgICBmdW5jdGlvbihldmVudF90eXBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5ldmVudCA9IGV2ZW50X3R5cGUudG9Mb3dlckNhc2UoKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWcgPSBvcHRpb25zLmRhdGEudGFnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gbmV3IG9wdGlvbnMuU0lQLk5hbWVBZGRySGVhZGVyKG9wdGlvbnMuZGF0YS51cmksIG9wdGlvbnMuZGF0YS5kaXNwbGF5TmFtZSwgb3B0aW9ucy5kYXRhLnBhcmFtcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFnKSB7b3B0aW9ucy5kYXRhLnNldFBhcmFtKCd0YWcnLHRhZyl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICJ0YWciLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidGFnIiwgZGVzY3JpcHRpb246ICJcInRhZ1wiIiB9LAogICAgICAgICAgZnVuY3Rpb24odGFnKSB7b3B0aW9ucy5kYXRhLnRhZyA9IHRhZzsgfSwKICAgICAgICAgIGZ1bmN0aW9uKGZvcndhcmRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBwYXJzZUludChmb3J3YXJkcy5qb2luKCcnKSk7IH0sCiAgICAgICAgICBmdW5jdGlvbihtaW5fZXhwaXJlcykge29wdGlvbnMuZGF0YSA9IG1pbl9leHBpcmVzOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBuZXcgb3B0aW9ucy5TSVAuTmFtZUFkZHJIZWFkZXIob3B0aW9ucy5kYXRhLnVyaSwgb3B0aW9ucy5kYXRhLmRpc3BsYXlOYW1lLCBvcHRpb25zLmRhdGEucGFyYW1zKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgImRpZ2VzdCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJEaWdlc3QiLCBkZXNjcmlwdGlvbjogIlwiRGlnZXN0XCIiIH0sCiAgICAgICAgICAicmVhbG0iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicmVhbG0iLCBkZXNjcmlwdGlvbjogIlwicmVhbG1cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHJlYWxtKSB7IG9wdGlvbnMuZGF0YS5yZWFsbSA9IHJlYWxtOyB9LAogICAgICAgICAgImRvbWFpbiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJkb21haW4iLCBkZXNjcmlwdGlvbjogIlwiZG9tYWluXCIiIH0sCiAgICAgICAgICAibm9uY2UiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAibm9uY2UiLCBkZXNjcmlwdGlvbjogIlwibm9uY2VcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKG5vbmNlKSB7IG9wdGlvbnMuZGF0YS5ub25jZT1ub25jZTsgfSwKICAgICAgICAgICJvcGFxdWUiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAib3BhcXVlIiwgZGVzY3JpcHRpb246ICJcIm9wYXF1ZVwiIiB9LAogICAgICAgICAgZnVuY3Rpb24ob3BhcXVlKSB7IG9wdGlvbnMuZGF0YS5vcGFxdWU9b3BhcXVlOyB9LAogICAgICAgICAgInN0YWxlIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInN0YWxlIiwgZGVzY3JpcHRpb246ICJcInN0YWxlXCIiIH0sCiAgICAgICAgICAidHJ1ZSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ0cnVlIiwgZGVzY3JpcHRpb246ICJcInRydWVcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgeyBvcHRpb25zLmRhdGEuc3RhbGU9dHJ1ZTsgfSwKICAgICAgICAgICJmYWxzZSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJmYWxzZSIsIGRlc2NyaXB0aW9uOiAiXCJmYWxzZVwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7IG9wdGlvbnMuZGF0YS5zdGFsZT1mYWxzZTsgfSwKICAgICAgICAgICJhbGdvcml0aG0iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiYWxnb3JpdGhtIiwgZGVzY3JpcHRpb246ICJcImFsZ29yaXRobVwiIiB9LAogICAgICAgICAgIm1kNSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJNRDUiLCBkZXNjcmlwdGlvbjogIlwiTUQ1XCIiIH0sCiAgICAgICAgICAibWQ1LXNlc3MiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiTUQ1LXNlc3MiLCBkZXNjcmlwdGlvbjogIlwiTUQ1LXNlc3NcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGFsZ29yaXRobSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5hbGdvcml0aG09YWxnb3JpdGhtLnRvVXBwZXJDYXNlKCk7IH0sCiAgICAgICAgICAicW9wIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInFvcCIsIGRlc2NyaXB0aW9uOiAiXCJxb3BcIiIgfSwKICAgICAgICAgICJhdXRoLWludCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJhdXRoLWludCIsIGRlc2NyaXB0aW9uOiAiXCJhdXRoLWludFwiIiB9LAogICAgICAgICAgImF1dGgiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiYXV0aCIsIGRlc2NyaXB0aW9uOiAiXCJhdXRoXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihxb3BfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5xb3AgfHwgKG9wdGlvbnMuZGF0YS5xb3A9W10pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnFvcC5wdXNoKHFvcF92YWx1ZS50b0xvd2VyQ2FzZSgpKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKHJhY2tfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS52YWx1ZT1wYXJzZUludChyYWNrX3ZhbHVlLmpvaW4oJycpKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCwgbGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoID0gb3B0aW9ucy5kYXRhLm11bHRpX2hlYWRlci5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXJbaWR4XS5wYXJzZWQgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5kYXRhICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSAtMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGVhZGVyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXIpIG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXIgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IG5ldyBvcHRpb25zLlNJUC5OYW1lQWRkckhlYWRlcihvcHRpb25zLmRhdGEudXJpLCBvcHRpb25zLmRhdGEuZGlzcGxheU5hbWUsIG9wdGlvbnMuZGF0YS5wYXJhbXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnVyaTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5kaXNwbGF5TmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5wYXJhbXM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXIucHVzaCggeyAncG9zaXRpb24nOiBwZWckY3VyclBvcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCc6IG9mZnNldCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncGFyc2VkJzogaGVhZGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTt9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IG5ldyBvcHRpb25zLlNJUC5OYW1lQWRkckhlYWRlcihvcHRpb25zLmRhdGEudXJpLCBvcHRpb25zLmRhdGEuZGlzcGxheU5hbWUsIG9wdGlvbnMuZGF0YS5wYXJhbXMpOwogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG9wdGlvbnMuZGF0YS5yZXBsYWNlc19mcm9tX3RhZyAmJiBvcHRpb25zLmRhdGEucmVwbGFjZXNfdG9fdGFnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gLTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbF9pZDogb3B0aW9ucy5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICJmcm9tLXRhZyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJmcm9tLXRhZyIsIGRlc2NyaXB0aW9uOiAiXCJmcm9tLXRhZ1wiIiB9LAogICAgICAgICAgZnVuY3Rpb24oZnJvbV90YWcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEucmVwbGFjZXNfZnJvbV90YWcgPSBmcm9tX3RhZzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICJ0by10YWciLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidG8tdGFnIiwgZGVzY3JpcHRpb246ICJcInRvLXRhZ1wiIiB9LAogICAgICAgICAgZnVuY3Rpb24odG9fdGFnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnJlcGxhY2VzX3RvX3RhZyA9IHRvX3RhZzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICJlYXJseS1vbmx5IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImVhcmx5LW9ubHkiLCBkZXNjcmlwdGlvbjogIlwiZWFybHktb25seVwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLmVhcmx5X29ubHkgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgZnVuY3Rpb24ocikge3JldHVybiByO30sCiAgICAgICAgICBmdW5jdGlvbihmaXJzdCwgcmVzdCkgeyByZXR1cm4gbGlzdChmaXJzdCwgcmVzdCk7IH0sCiAgICAgICAgICBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXJ0UnVsZSA9PT0gJ1JlcXVpcmUnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSB2YWx1ZSB8fCBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICBmdW5jdGlvbihyc2VxX3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudmFsdWU9cGFyc2VJbnQocnNlcV92YWx1ZS5qb2luKCcnKSk7IH0sCiAgICAgICAgICAiYWN0aXZlIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImFjdGl2ZSIsIGRlc2NyaXB0aW9uOiAiXCJhY3RpdmVcIiIgfSwKICAgICAgICAgICJwZW5kaW5nIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInBlbmRpbmciLCBkZXNjcmlwdGlvbjogIlwicGVuZGluZ1wiIiB9LAogICAgICAgICAgInRlcm1pbmF0ZWQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidGVybWluYXRlZCIsIGRlc2NyaXB0aW9uOiAiXCJ0ZXJtaW5hdGVkXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5zdGF0ZSA9IHRleHQoKTsgfSwKICAgICAgICAgICJyZWFzb24iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicmVhc29uIiwgZGVzY3JpcHRpb246ICJcInJlYXNvblwiIiB9LAogICAgICAgICAgZnVuY3Rpb24ocmVhc29uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlYXNvbiAhPT0gJ3VuZGVmaW5lZCcpIG9wdGlvbnMuZGF0YS5yZWFzb24gPSByZWFzb247IH0sCiAgICAgICAgICBmdW5jdGlvbihleHBpcmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGV4cGlyZXMgIT09ICd1bmRlZmluZWQnKSBvcHRpb25zLmRhdGEuZXhwaXJlcyA9IGV4cGlyZXM7IH0sCiAgICAgICAgICAicmV0cnlfYWZ0ZXIiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicmV0cnlfYWZ0ZXIiLCBkZXNjcmlwdGlvbjogIlwicmV0cnlfYWZ0ZXJcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHJldHJ5X2FmdGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJldHJ5X2FmdGVyICE9PSAndW5kZWZpbmVkJykgb3B0aW9ucy5kYXRhLnJldHJ5X2FmdGVyID0gcmV0cnlfYWZ0ZXI7IH0sCiAgICAgICAgICAiZGVhY3RpdmF0ZWQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiZGVhY3RpdmF0ZWQiLCBkZXNjcmlwdGlvbjogIlwiZGVhY3RpdmF0ZWRcIiIgfSwKICAgICAgICAgICJwcm9iYXRpb24iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicHJvYmF0aW9uIiwgZGVzY3JpcHRpb246ICJcInByb2JhdGlvblwiIiB9LAogICAgICAgICAgInJlamVjdGVkIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJlamVjdGVkIiwgZGVzY3JpcHRpb246ICJcInJlamVjdGVkXCIiIH0sCiAgICAgICAgICAidGltZW91dCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ0aW1lb3V0IiwgZGVzY3JpcHRpb246ICJcInRpbWVvdXRcIiIgfSwKICAgICAgICAgICJnaXZldXAiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiZ2l2ZXVwIiwgZGVzY3JpcHRpb246ICJcImdpdmV1cFwiIiB9LAogICAgICAgICAgIm5vcmVzb3VyY2UiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAibm9yZXNvdXJjZSIsIGRlc2NyaXB0aW9uOiAiXCJub3Jlc291cmNlXCIiIH0sCiAgICAgICAgICAiaW52YXJpYW50IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImludmFyaWFudCIsIGRlc2NyaXB0aW9uOiAiXCJpbnZhcmlhbnRcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3RhcnRSdWxlID09PSAnU3VwcG9ydGVkJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gdmFsdWUgfHwgW107CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWcgPSBvcHRpb25zLmRhdGEudGFnOwogICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IG5ldyBvcHRpb25zLlNJUC5OYW1lQWRkckhlYWRlcihvcHRpb25zLmRhdGEudXJpLCBvcHRpb25zLmRhdGEuZGlzcGxheU5hbWUsIG9wdGlvbnMuZGF0YS5wYXJhbXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWcpIHtvcHRpb25zLmRhdGEuc2V0UGFyYW0oJ3RhZycsdGFnKX0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICJ0dGwiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidHRsIiwgZGVzY3JpcHRpb246ICJcInR0bFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24odmlhX3R0bF92YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS50dGwgPSB2aWFfdHRsX3ZhbHVlOyB9LAogICAgICAgICAgIm1hZGRyIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm1hZGRyIiwgZGVzY3JpcHRpb246ICJcIm1hZGRyXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbih2aWFfbWFkZHIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEubWFkZHIgPSB2aWFfbWFkZHI7IH0sCiAgICAgICAgICAicmVjZWl2ZWQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicmVjZWl2ZWQiLCBkZXNjcmlwdGlvbjogIlwicmVjZWl2ZWRcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHZpYV9yZWNlaXZlZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5yZWNlaXZlZCA9IHZpYV9yZWNlaXZlZDsgfSwKICAgICAgICAgICJicmFuY2giLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiYnJhbmNoIiwgZGVzY3JpcHRpb246ICJcImJyYW5jaFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24odmlhX2JyYW5jaCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5icmFuY2ggPSB2aWFfYnJhbmNoOyB9LAogICAgICAgICAgInJwb3J0IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJwb3J0IiwgZGVzY3JpcHRpb246ICJcInJwb3J0XCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2YgcmVzcG9uc2VfcG9ydCAhPT0gJ3VuZGVmaW5lZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEucnBvcnQgPSByZXNwb25zZV9wb3J0LmpvaW4oJycpOyB9LAogICAgICAgICAgZnVuY3Rpb24odmlhX3Byb3RvY29sKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnByb3RvY29sID0gdmlhX3Byb3RvY29sOyB9LAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiVURQIiwgZGVzY3JpcHRpb246ICJcIlVEUFwiIiB9LAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiVENQIiwgZGVzY3JpcHRpb246ICJcIlRDUFwiIiB9LAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiVExTIiwgZGVzY3JpcHRpb246ICJcIlRMU1wiIiB9LAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiU0NUUCIsIGRlc2NyaXB0aW9uOiAiXCJTQ1RQXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbih2aWFfdHJhbnNwb3J0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnRyYW5zcG9ydCA9IHZpYV90cmFuc3BvcnQ7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuaG9zdCA9IHRleHQoKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKHZpYV9zZW50X2J5X3BvcnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEucG9ydCA9IHBhcnNlSW50KHZpYV9zZW50X2J5X3BvcnQuam9pbignJykpOyB9LAogICAgICAgICAgZnVuY3Rpb24odHRsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHR0bC5qb2luKCcnKSk7IH0sCiAgICAgICAgICBmdW5jdGlvbihkZWx0YVNlY29uZHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5zdGFydFJ1bGUgPT09ICdTZXNzaW9uX0V4cGlyZXMnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuZGVsdGFTZWNvbmRzID0gZGVsdGFTZWNvbmRzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICJyZWZyZXNoZXIiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicmVmcmVzaGVyIiwgZGVzY3JpcHRpb246ICJcInJlZnJlc2hlclwiIiB9LAogICAgICAgICAgInVhcyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ1YXMiLCBkZXNjcmlwdGlvbjogIlwidWFzXCIiIH0sCiAgICAgICAgICAidWFjIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInVhYyIsIGRlc2NyaXB0aW9uOiAiXCJ1YWNcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGVuZHBvaW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3RhcnRSdWxlID09PSAnU2Vzc2lvbl9FeHBpcmVzJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnJlZnJlc2hlciA9IGVuZHBvaW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKGRlbHRhU2Vjb25kcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXJ0UnVsZSA9PT0gJ01pbl9TRScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IGRlbHRhU2Vjb25kczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAic3R1bnMiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAic3R1bnMiLCBkZXNjcmlwdGlvbjogIlwic3R1bnNcIiIgfSwKICAgICAgICAgICJzdHVuIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInN0dW4iLCBkZXNjcmlwdGlvbjogIlwic3R1blwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oc2NoZW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnNjaGVtZSA9IHNjaGVtZTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKGhvc3QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuaG9zdCA9IGhvc3Q7IH0sCiAgICAgICAgICAiP3RyYW5zcG9ydD0iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiP3RyYW5zcG9ydD0iLCBkZXNjcmlwdGlvbjogIlwiP3RyYW5zcG9ydD1cIiIgfSwKICAgICAgICAgICJ0dXJucyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ0dXJucyIsIGRlc2NyaXB0aW9uOiAiXCJ0dXJuc1wiIiB9LAogICAgICAgICAgInR1cm4iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidHVybiIsIGRlc2NyaXB0aW9uOiAiXCJ0dXJuXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudHJhbnNwb3J0ID0gdHJhbnNwb3J0OyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSB0ZXh0KCk7IH0KICAgICAgICBdLAoKICAgICAgICBwZWckYnl0ZWNvZGUgPSBbCiAgICAgICAgICBwZWckZGVjb2RlKCIuIFwiXCIyIDMhIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIwXCJcIlwiMSEzIyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMCRcIlwiMSEzJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMCZcIlwiMSEzJyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiNycqIyBcIjcoIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIwKFwiXCIxITMpIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIwKlwiXCIxITMrIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIuLFwiXCIyLDMtIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIuLlwiXCIyLjMvIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIwMFwiXCIxITMxIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIuMlwiXCIyMjMzKlx4ODkgXCIuNFwiXCIyNDM1Kn0gXCIuNlwiXCIyNjM3KnEgXCIuOFwiXCIyODM5KmUgXCIuOlwiXCIyOjM7KlkgXCIuPFwiXCIyPDM9Kk0gXCIuPlwiXCIyPjM/KkEgXCIuQFwiXCIyQDNBKjUgXCIuQlwiXCIyQjNDKikgXCIuRFwiXCIyRDNFIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3KSojIFwiNywiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5GXCJcIjJGM0cqfSBcIi5IXCJcIjJIM0kqcSBcIi5KXCJcIjJKM0sqZSBcIi5MXCJcIjJMM00qWSBcIi5OXCJcIjJOM08qTSBcIi5QXCJcIjJQM1EqQSBcIi5SXCJcIjJSM1MqNSBcIi5UXCJcIjJUM1UqKSBcIi5WXCJcIjJWM1ciKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEhLllcIlwiMlkzWis3JDcjKy0lNyMrIyUnIyUkIyMgWCRcIiMgWFwiIyBYKyEgKCUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEhIFxcNyQsIyY3JFwiKy0kNyArIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK0AkIFxcNyQrJiQsIyY3JFwiXCJcIiBYKyclNFwiNl1cIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjcuKiMgXCIgWyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDcnKiMgXCI3KCwpJjcnKiMgXCI3KFwiK0EkLjhcIlwiMjgzOSsxJTcvKyclNCM2XiMgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEhIFxcNzIrJiQsIyY3MlwiXCJcIiBYK28kIFxcISBcXDcuLCMmNy5cIistJDcyKyMlJ1wiJSRcIiMgWFwiIyBYLEAmISBcXDcuLCMmNy5cIistJDcyKyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgrISAoJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMF9cIlwiMSEzYCojIFwiNzMiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjBhXCJcIjEhM2IiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjBjXCJcIjEhM2QiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjchKikgXCIwZVwiXCIxITNmIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNykqXHg5NSBcIi5GXCJcIjJGM0cqXHg4OSBcIi5KXCJcIjJKM0sqfSBcIi5MXCJcIjJMM00qcSBcIi5ZXCJcIjJZM1oqZSBcIi5QXCJcIjJQM1EqWSBcIi5IXCJcIjJIM0kqTSBcIi5AXCJcIjJAM0EqQSBcIi5nXCJcIjJnM2gqNSBcIi5SXCJcIjJSM1MqKSBcIi5OXCJcIjJOM08rXHg5RSQsXHg5QiY3KSpceDk1IFwiLkZcIlwiMkYzRypceDg5IFwiLkpcIlwiMkozSyp9IFwiLkxcIlwiMkwzTSpxIFwiLllcIlwiMlkzWiplIFwiLlBcIlwiMlAzUSpZIFwiLkhcIlwiMkgzSSpNIFwiLkBcIlwiMkAzQSpBIFwiLmdcIlwiMmczaCo1IFwiLlJcIlwiMlIzUyopIFwiLk5cIlwiMk4zT1wiXCJcIiBYKyEgKCUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3KSpceDg5IFwiLkZcIlwiMkYzRyp9IFwiLkxcIlwiMkwzTSpxIFwiLllcIlwiMlkzWiplIFwiLlBcIlwiMlAzUSpZIFwiLkhcIlwiMkgzSSpNIFwiLkBcIlwiMkAzQSpBIFwiLmdcIlwiMmczaCo1IFwiLlJcIlwiMlIzUyopIFwiLk5cIlwiMk4zTytceDkyJCxceDhGJjcpKlx4ODkgXCIuRlwiXCIyRjNHKn0gXCIuTFwiXCIyTDNNKnEgXCIuWVwiXCIyWTNaKmUgXCIuUFwiXCIyUDNRKlkgXCIuSFwiXCIySDNJKk0gXCIuQFwiXCIyQDNBKkEgXCIuZ1wiXCIyZzNoKjUgXCIuUlwiXCIyUjNTKikgXCIuTlwiXCIyTjNPXCJcIlwiIFgrISAoJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLlRcIlwiMlQzVSpceEUzIFwiLlZcIlwiMlYzVypceEQ3IFwiLmlcIlwiMmkzaipceENCIFwiLmtcIlwiMmszbCpceEJGIFwiLjpcIlwiMjozOypceEIzIFwiLkRcIlwiMkQzRSpceEE3IFwiLjJcIlwiMjIzMypceDlCIFwiLjhcIlwiMjgzOSpceDhGIFwiLm1cIlwiMm0zbipceDgzIFwiNyYqfSBcIi40XCJcIjI0MzUqcSBcIi5vXCJcIjJvM3AqZSBcIi5xXCJcIjJxM3IqWSBcIi42XCJcIjI2MzcqTSBcIi4+XCJcIjI+Mz8qQSBcIi5zXCJcIjJzM3QqNSBcIi51XCJcIjJ1M3YqKSBcIjcnKiMgXCI3KCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDcpKlx1MDEyQiBcIi5GXCJcIjJGM0cqXHUwMTFGIFwiLkpcIlwiMkozSypcdTAxMTMgXCIuTFwiXCIyTDNNKlx1MDEwNyBcIi5ZXCJcIjJZM1oqXHhGQiBcIi5QXCJcIjJQM1EqXHhFRiBcIi5IXCJcIjJIM0kqXHhFMyBcIi5AXCJcIjJAM0EqXHhENyBcIi5nXCJcIjJnM2gqXHhDQiBcIi5SXCJcIjJSM1MqXHhCRiBcIi5OXCJcIjJOM08qXHhCMyBcIi5UXCJcIjJUM1UqXHhBNyBcIi5WXCJcIjJWM1cqXHg5QiBcIi5pXCJcIjJpM2oqXHg4RiBcIi5rXCJcIjJrM2wqXHg4MyBcIi44XCJcIjI4MzkqdyBcIi5tXCJcIjJtM24qayBcIjcmKmUgXCIuNFwiXCIyNDM1KlkgXCIub1wiXCIybzNwKk0gXCIucVwiXCIycTNyKkEgXCIuNlwiXCIyNjM3KjUgXCIuc1wiXCIyczN0KikgXCIudVwiXCIydTN2K1x1MDEzNCQsXHUwMTMxJjcpKlx1MDEyQiBcIi5GXCJcIjJGM0cqXHUwMTFGIFwiLkpcIlwiMkozSypcdTAxMTMgXCIuTFwiXCIyTDNNKlx1MDEwNyBcIi5ZXCJcIjJZM1oqXHhGQiBcIi5QXCJcIjJQM1EqXHhFRiBcIi5IXCJcIjJIM0kqXHhFMyBcIi5AXCJcIjJAM0EqXHhENyBcIi5nXCJcIjJnM2gqXHhDQiBcIi5SXCJcIjJSM1MqXHhCRiBcIi5OXCJcIjJOM08qXHhCMyBcIi5UXCJcIjJUM1UqXHhBNyBcIi5WXCJcIjJWM1cqXHg5QiBcIi5pXCJcIjJpM2oqXHg4RiBcIi5rXCJcIjJrM2wqXHg4MyBcIi44XCJcIjI4MzkqdyBcIi5tXCJcIjJtM24qayBcIjcmKmUgXCIuNFwiXCIyNDM1KlkgXCIub1wiXCIybzNwKk0gXCIucVwiXCIycTNyKkEgXCIuNlwiXCIyNjM3KjUgXCIuc1wiXCIyczN0KikgXCIudVwiXCIydTN2XCJcIlwiIFgrISAoJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITcvK0EkLlBcIlwiMlAzUSsxJTcvKyclNCM2dyMgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LytBJC40XCJcIjI0MzUrMSU3LysnJTQjNngjICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rQSQuPlwiXCIyPjM/KzElNy8rJyU0IzZ5IyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITcvK0EkLlRcIlwiMlQzVSsxJTcvKyclNCM2eiMgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LytBJC5WXCJcIjJWM1crMSU3LysnJTQjNnsjICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhLmtcIlwiMmszbCsxJDcvKyclNFwiNnxcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3Lys3JC5pXCJcIjJpM2orJyU0XCI2fVwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITcvK0EkLkRcIlwiMkQzRSsxJTcvKyclNCM2fiMgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LytBJC4yXCJcIjIyMzMrMSU3LysnJTQjNn8jICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rQSQuOFwiXCIyODM5KzElNy8rJyU0IzZceDgwIyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITcvKzEkNyYrJyU0XCI2XHg4MVwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITcmKzEkNy8rJyU0XCI2XHg4MVwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc9K1ckIFxcN0cqKSBcIjdLKiMgXCI3RiwvJjdHKikgXCI3SyojIFwiN0ZcIistJTc+KyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMFx4ODJcIlwiMSEzXHg4MypBIFwiMFx4ODRcIlwiMSEzXHg4NSo1IFwiMFx4ODZcIlwiMSEzXHg4NyopIFwiNzMqIyBcIjcuIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhITcvK1UkNyYrSyUgXFw3SiojIFwiN0ssKSY3SiojIFwiN0tcIistJTcmKyMlJyQlJCQjIFgkIyMgWCRcIiMgWFwiIyBYKyEgKCUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LytgJDcmK1YlISBcXDdKKiMgXCI3SywpJjdKKiMgXCI3S1wiKyEgKCUrMiU3JisoJTQkNlx4ODgkISElJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3LipHIFwiLkxcIlwiMkwzTSo7IFwiMFx4ODlcIlwiMSEzXHg4QSovIFwiMFx4ODZcIlwiMSEzXHg4NyojIFwiNzMiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEubVwiXCIybTNuK0skMFx4OEJcIlwiMSEzXHg4Qyo1IFwiMFx4OERcIlwiMSEzXHg4RSopIFwiMFx4OEZcIlwiMSEzXHg5MCsjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdOK1EkLjhcIlwiMjgzOStBJTdPKiMgXCIgWysxJTdTKyclNCQ2XHg5MSQgJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdOK2skLjhcIlwiMjgzOStbJTdPKiMgXCIgWytLJTdTK0ElN18rNyU3bCojIFwiIFsrJyU0JjZceDkyJiAlJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceDkzXCJcIjEkM1x4OTQqKSBcIi9ceDk1XCJcIjEjM1x4OTYrJyA0ITZceDk3ISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdQK2IkIS44XCJcIjI4MzkrLSQ3UisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrNyUuOlwiXCIyOjM7KyclNCM2XHg5OCMgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiBcXDcrKikgXCI3LSojIFwiN1ErMiQsLyY3KyopIFwiNy0qIyBcIjdRXCJcIlwiIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi48XCJcIjI8Mz0qcSBcIi4+XCJcIjI+Mz8qZSBcIi5AXCJcIjJAM0EqWSBcIi5CXCJcIjJCM0MqTSBcIi5EXCJcIjJEM0UqQSBcIi4yXCJcIjIyMzMqNSBcIi42XCJcIjI2MzcqKSBcIi40XCJcIjI0MzUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3KypfIFwiNy0qWSBcIi48XCJcIjI8Mz0qTSBcIi4+XCJcIjI+Mz8qQSBcIi5AXCJcIjJAM0EqNSBcIi5CXCJcIjJCM0MqKSBcIi5EXCJcIjJEM0UsZSY3KypfIFwiNy0qWSBcIi48XCJcIjI8Mz0qTSBcIi4+XCJcIjI+Mz8qQSBcIi5AXCJcIjJAM0EqNSBcIi5CXCJcIjJCM0MqKSBcIi5EXCJcIjJEM0VcIismIDQhNlx4OTkhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3VCtOJCEuOFwiXCIyODM5Ky0kN14rIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1UqKSBcIjdcXCojIFwiN1grJiA0ITZceDlBISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcITdWKzMkLkpcIlwiMkozSysjJSdcIiUkXCIjIFhcIiMgWCw+JiE3ViszJC5KXCJcIjJKM0srIyUnXCIlJFwiIyBYXCIjIFhcIitHJDdXKz0lLkpcIlwiMkozSyojIFwiIFsrJyU0IzZceDlCIyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIFxcMFx4OUNcIlwiMSEzXHg5RCssJCwpJjBceDlDXCJcIjEhM1x4OURcIlwiXCIgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITAkXCJcIjEhMyUrQSQgXFwwXHg5RVwiXCIxITNceDlGLCkmMFx4OUVcIlwiMSEzXHg5RlwiKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhLm9cIlwiMm8zcCtBJDdZKzclLnFcIlwiMnEzcisnJTQjNlx4QTAjICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhITdaK1x4QkYkLjhcIlwiMjgzOStceEFGJTdaK1x4QTUlLjhcIlwiMjgzOStceDk1JTdaK1x4OEIlLjhcIlwiMjgzOSt7JTdaK3ElLjhcIlwiMjgzOSthJTdaK1clLjhcIlwiMjgzOStHJTdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJy0lJC0jIFgkLCMgWCQrIyBYJCojIFgkKSMgWCQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDgzOCBcIiEuXHhBMVwiXCIyXHhBMTNceEEyK1x4QUYkN1orXHhBNSUuOFwiXCIyODM5K1x4OTUlN1orXHg4QiUuOFwiXCIyODM5K3slN1orcSUuOFwiXCIyODM5K2ElN1orVyUuOFwiXCIyODM5K0clN1orPSUuOFwiXCIyODM5Ky0lN1srIyUnLCUkLCMgWCQrIyBYJCojIFgkKSMgWCQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDc5NSBcIiEuXHhBMVwiXCIyXHhBMTNceEEyK1x4OTUkN1orXHg4QiUuOFwiXCIyODM5K3slN1orcSUuOFwiXCIyODM5K2ElN1orVyUuOFwiXCIyODM5K0clN1orPSUuOFwiXCIyODM5Ky0lN1srIyUnKiUkKiMgWCQpIyBYJCgjIFgkJyMgWCQmIyBYJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgqXHUwNzBDIFwiIS5ceEExXCJcIjJceEExM1x4QTIreyQ3WitxJS44XCJcIjI4MzkrYSU3WitXJS44XCJcIjI4MzkrRyU3Wis9JS44XCJcIjI4MzkrLSU3WysjJScoJSQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDY5RCBcIiEuXHhBMVwiXCIyXHhBMTNceEEyK2EkN1orVyUuOFwiXCIyODM5K0clN1orPSUuOFwiXCIyODM5Ky0lN1srIyUnJiUkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDY0OCBcIiEuXHhBMVwiXCIyXHhBMTNceEEyK0ckN1orPSUuOFwiXCIyODM5Ky0lN1srIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgqXHUwNjBEIFwiIS5ceEExXCJcIjJceEExM1x4QTIrLSQ3WysjJSdcIiUkXCIjIFhcIiMgWCpcdTA1RUMgXCIhLlx4QTFcIlwiMlx4QTEzXHhBMistJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKlx1MDVDQiBcIiE3WitceEE1JC5ceEExXCJcIjJceEExM1x4QTIrXHg5NSU3WitceDhCJS44XCJcIjI4MzkreyU3WitxJS44XCJcIjI4MzkrYSU3WitXJS44XCJcIjI4MzkrRyU3Wis9JS44XCJcIjI4MzkrLSU3WysjJScrJSQrIyBYJCojIFgkKSMgWCQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDUzOCBcIiE3WitceEI2JCEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4OEIlLlx4QTFcIlwiMlx4QTEzXHhBMit7JTdaK3ElLjhcIlwiMjgzOSthJTdaK1clLjhcIlwiMjgzOStHJTdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJyolJCojIFgkKSMgWCQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDQ5NCBcIiE3WitceEM3JCEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4OUMlIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrcSUuXHhBMVwiXCIyXHhBMTNceEEyK2ElN1orVyUuOFwiXCIyODM5K0clN1orPSUuOFwiXCIyODM5Ky0lN1srIyUnKSUkKSMgWCQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDNERiBcIiE3WitceEQ4JCEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4QUQlIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrXHg4MiUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytXJS5ceEExXCJcIjJceEExM1x4QTIrRyU3Wis9JS44XCJcIjI4MzkrLSU3WysjJScoJSQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDMxOSBcIiE3WitceEU5JCEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4QkUlIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrXHg5MyUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytoJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKz0lLlx4QTFcIlwiMlx4QTEzXHhBMistJTdbKyMlJyclJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDI0MiBcIiE3WitcdTAxMTQkIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrXHhFOSUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceEJFJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4OTMlIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsraCUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWys9JS5ceEExXCJcIjJceEExM1x4QTIrLSU3WisjJScoJSQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDE0MCBcIiE3WitcdTAxMzUkIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrXHUwMTBBJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4REYlIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrXHhCNCUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceDg5JSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK14lIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrMyUuXHhBMVwiXCIyXHhBMTNceEEyKyMlJyglJCgjIFgkJyMgWCQmIyBYJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgrJiA0ITZceEEzISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNyMrUyQ3IyojIFwiIFsrQyU3IyojIFwiIFsrMyU3IyojIFwiIFsrIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3Wis9JC44XCJcIjI4MzkrLSU3WisjJScjJSQjIyBYJFwiIyBYXCIjIFgqIyBcIjdcXCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITddK3UkLkpcIlwiMkozSytlJTddK1slLkpcIlwiMkozSytLJTddK0ElLkpcIlwiMkozSysxJTddKyclNCc2XHhBNCcgJSQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS5ceEE1XCJcIjJceEE1M1x4QTYrMyQwXHhBN1wiXCIxITNceEE4KyMlJ1wiJSRcIiMgWFwiIyBYKlx4QTAgXCIhLlx4QTlcIlwiMlx4QTkzXHhBQSs9JDBceEFCXCJcIjEhM1x4QUMrLSU3ISsjJScjJSQjIyBYJFwiIyBYXCIjIFgqbyBcIiEuXHhBRFwiXCIyXHhBRDNceEFFKzckNyErLSU3ISsjJScjJSQjIyBYJFwiIyBYXCIjIFgqRCBcIiEwXHhBRlwiXCIxITNceEIwKy0kNyErIyUnXCIlJFwiIyBYXCIjIFgqIyBcIjchIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhITchKiMgXCIgWytjJDchKiMgXCIgWytTJTchKiMgXCIgWytDJTchKiMgXCIgWyszJTchKiMgXCIgWysjJSclJSQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKycgNCE2XHhCMSEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiBcXCEuMlwiXCIyMjMzKy0kN2ArIyUnXCIlJFwiIyBYXCIjIFgsPiYhLjJcIlwiMjIzMystJDdgKyMlJ1wiJSRcIiMgWFwiIyBYXCIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdhKkEgXCI3Yio7IFwiN2MqNSBcIjdkKi8gXCI3ZSopIFwiN2YqIyBcIjdnIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x4QjJcIlwiMSozXHhCMytiJC9ceEI0XCJcIjEjM1x4QjUqRyBcIi9ceEI2XCJcIjEjM1x4QjcqOyBcIi9ceEI4XCJcIjEkM1x4QjkqLyBcIi9ceEJBXCJcIjEjM1x4QkIqIyBcIjc2KyglNFwiNlx4QkNcIiEgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x4QkRcIlwiMSUzXHhCRStKJC9ceEJGXCJcIjElM1x4QzAqLyBcIi9ceEMxXCJcIjFcIjNceEMyKiMgXCI3NisoJTRcIjZceEMzXCIhICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceEM0XCJcIjEnM1x4QzUrMiQ3XHg4RisoJTRcIjZceEM2XCIhICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceEM3XCJcIjEkM1x4QzgrMiQ3XHhFRisoJTRcIjZceEM5XCIhICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceENBXCJcIjEmM1x4Q0IrMiQ3VCsoJTRcIjZceENDXCIhICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceENEXCJcIjFcIjNceENFK1IkIS4+XCJcIjI+Mz8rLSQ3NisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrJyU0XCI2XHhDRlwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdoK1QkIS4+XCJcIjI+Mz8rLSQ3aSsjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrKSU0XCI2XHhEMFwiXCIhICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDdqKyYkLCMmN2pcIlwiXCIgWCshICglIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcN2orJiQsIyY3alwiXCJcIiBYKyEgKCUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdrKikgXCI3KyojIFwiNy0iKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5vXCJcIjJvM3AqZSBcIi5xXCJcIjJxM3IqWSBcIi40XCJcIjI0MzUqTSBcIi44XCJcIjI4MzkqQSBcIi48XCJcIjI8Mz0qNSBcIi5AXCJcIjJAM0EqKSBcIi5CXCJcIjJCM0MiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEuNlwiXCIyNjM3K3UkN20rayUgXFwhLjxcIlwiMjwzPSstJDdtKyMlJ1wiJSRcIiMgWFwiIyBYLD4mIS48XCJcIjI8Mz0rLSQ3bSsjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITduK0MkLj5cIlwiMj4zPyszJTdvKyklNCM2XHhEMSNcIlwiICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3cCopIFwiNysqIyBcIjctKzIkLC8mN3AqKSBcIjcrKiMgXCI3LVwiXCJcIiBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3cCopIFwiNysqIyBcIjctLC8mN3AqKSBcIjcrKiMgXCI3LVwiIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIub1wiXCIybzNwKmUgXCIucVwiXCIycTNyKlkgXCIuNFwiXCIyNDM1Kk0gXCIuNlwiXCIyNjM3KkEgXCIuOFwiXCIyODM5KjUgXCIuQFwiXCIyQDNBKikgXCIuQlwiXCIyQjNDIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XHg5MCojIFwiN3IiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg4RitLJDcnK0ElN3MrNyU3JystJTdceDg0KyMlJyUlJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdNKiMgXCI3dCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITd/K0ckLjhcIlwiMjgzOSs3JTd1KiMgXCI3eCsnJTQjNlx4RDIjICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN3YqIyBcIjd3K04kIS42XCJcIjI2MzcrLSQ3XHg4MysjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEuXHhEM1wiXCIyXHhEMzNceEQ0Kz0kN1x4ODArMyU3dyojIFwiIFsrIyUnIyUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhLjRcIlwiMjQzNSstJDd7KyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN3orNSQgXFw3eSwjJjd5XCIrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjcqKikgXCI3KyojIFwiNy0iKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjcrKlx4OEYgXCI3LSpceDg5IFwiLjJcIlwiMjIzMyp9IFwiLjZcIlwiMjYzNypxIFwiLjhcIlwiMjgzOSplIFwiLjpcIlwiMjozOypZIFwiLjxcIlwiMjwzPSpNIFwiLj5cIlwiMj4zPypBIFwiLkBcIlwiMkAzQSo1IFwiLkJcIlwiMkIzQyopIFwiLkRcIlwiMkQzRSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITd8K2skIFxcIS40XCJcIjI0MzUrLSQ3fCsjJSdcIiUkXCIjIFhcIiMgWCw+JiEuNFwiXCIyNDM1Ky0kN3wrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDd+LCMmN35cIitrJCBcXCEuMlwiXCIyMjMzKy0kN30rIyUnXCIlJFwiIyBYXCIjIFgsPiYhLjJcIlwiMjIzMystJDd9KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiBcXDd+LCMmN35cIiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiNysqdyBcIjctKnEgXCIuOFwiXCIyODM5KmUgXCIuOlwiXCIyOjM7KlkgXCIuPFwiXCIyPDM9Kk0gXCIuPlwiXCIyPjM/KkEgXCIuQFwiXCIyQDNBKjUgXCIuQlwiXCIyQjNDKikgXCIuRFwiXCIyRDNFIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1wiK1x4OEQkIFxcN1wiKkcgXCI3ISpBIFwiLkBcIlwiMkAzQSo1IFwiLkZcIlwiMkYzRyopIFwiLkpcIlwiMkozSyxNJjdcIipHIFwiNyEqQSBcIi5AXCJcIjJAM0EqNSBcIi5GXCJcIjJGM0cqKSBcIi5KXCJcIjJKM0tcIisnJTRcIjZceEQ1XCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XHg4MSojIFwiN1x4ODIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEhN08rMyQuOlwiXCIyOjM7KyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWystJDdTKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIFxcNysqXHg4MyBcIjctKn0gXCIuQlwiXCIyQjNDKnEgXCIuRFwiXCIyRDNFKmUgXCIuMlwiXCIyMjMzKlkgXCIuOFwiXCIyODM5Kk0gXCIuOlwiXCIyOjM7KkEgXCIuPFwiXCIyPDM9KjUgXCIuPlwiXCIyPjM/KikgXCIuQFwiXCIyQDNBK1x4OEMkLFx4ODkmNysqXHg4MyBcIjctKn0gXCIuQlwiXCIyQjNDKnEgXCIuRFwiXCIyRDNFKmUgXCIuMlwiXCIyMjMzKlkgXCIuOFwiXCIyODM5Kk0gXCIuOlwiXCIyOjM7KkEgXCIuPFwiXCIyPDM9KjUgXCIuPlwiXCIyPjM/KikgXCIuQFwiXCIyQDNBXCJcIlwiIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiBcXDd5LCMmN3lcIiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceDk1XCJcIjEjM1x4RDYreSQuNFwiXCIyNDM1K2klIFxcNyErJiQsIyY3IVwiXCJcIiBYK1AlLkpcIlwiMkozSytAJSBcXDchKyYkLCMmNyFcIlwiXCIgWCsnJTQlNlx4RDclICUkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLlx4RDhcIlwiMlx4RDgzXHhEOSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLlx4REFcIlwiMlx4REEzXHhEQiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLlx4RENcIlwiMlx4REMzXHhERCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLlx4REVcIlwiMlx4REUzXHhERiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLlx4RTBcIlwiMlx4RTAzXHhFMSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLlx4RTJcIlwiMlx4RTIzXHhFMyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLlx4RTRcIlwiMlx4RTQzXHhFNSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLlx4RTZcIlwiMlx4RTYzXHhFNyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLlx4RThcIlwiMlx4RTgzXHhFOSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLlx4RUFcIlwiMlx4RUEzXHhFQiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDg1KlMgXCI3XHg4NipNIFwiN1x4ODgqRyBcIjdceDg5KkEgXCI3XHg4QSo7IFwiN1x4OEIqNSBcIjdceDhDKi8gXCI3XHg4RCopIFwiN1x4OEUqIyBcIjc2KyYgNCE2XHhFQyEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDg0K0skNycrQSU3XHg5MSs3JTcnKy0lN1x4OTMrIyUnJSUkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDkyKycgNCE2XHhFRCEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3ISs3JDchKy0lNyErIyUnIyUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNyoqQSBcIjcrKjsgXCI3LSo1IFwiNzMqLyBcIjc0KikgXCI3JyojIFwiNygsRyY3KipBIFwiNysqOyBcIjctKjUgXCI3MyovIFwiNzQqKSBcIjcnKiMgXCI3KFwiKyYgNCE2XHhFRSEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEI1K18kIFxcITdBKy0kN1x4QjUrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0ErLSQ3XHhCNSsjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNzkrUiQhLjpcIlwiMjozOystJDc5KyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWysnJTRcIjZceEVGXCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNzoqaiBcIiE3XHg5NytfJCBcXCE3QSstJDdceDk3KyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdBKy0kN1x4OTcrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCsmIDQhNlx4RjAhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3TCojIFwiN1x4OTgrYyQgXFwhN0IrLSQ3XHg5QSsjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceDlBKyMlJ1wiJSRcIiMgWFwiIyBYXCIrJyU0XCI2XHhGMVwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDk5KiMgXCIgWytBJDdAKzclN00rLSU3PysjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3NitfJCBcXCE3ListJDc2KyMlJ1wiJSRcIiMgWFwiIyBYLDgmITcuKy0kNzYrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCojIFwiN0grJyA0ITZceEYyISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4OUIqKSBcIjdceDlDKiMgXCI3XHg5RiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceEYzXCJcIjEhM1x4RjQrPCQ3PCsyJTdceDlFKyglNCM2XHhGNSMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x4RjZcIlwiMSczXHhGNys8JDc8KzIlN1x4OUQrKCU0IzZceEY4IyEgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3ISsmJCwjJjchXCJcIlwiIFgrJyA0ITZceEY5ISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS5ceEZBXCJcIjJceEZBM1x4RkIreCQhLkpcIlwiMkozSytTJDchKiMgXCIgWytDJTchKiMgXCIgWyszJTchKiMgXCIgWysjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCojIFwiIFsrJyU0XCI2XHhGQ1wiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc2K04kITc8Ky0kN1x4QTArIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKyklNFwiNlx4RkRcIlwiISAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjc2KikgXCI3VCojIFwiN0giKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhBMitfJCBcXCE3QistJDdceEEzKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4QTMrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceEZFXCJcIjEmM1x4RkYqRyBcIi9cdTAxMDBcIlwiMSczXHUwMTAxKjsgXCIvXHUwMTAyXCJcIjEkM1x1MDEwMyovIFwiL1x1MDEwNFwiXCIxJTNcdTAxMDUqIyBcIjc2KyYgNCE2XHUwMTA2ISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XHhBNCojIFwiN1x4OUYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTA3XCJcIjEoM1x1MDEwOCtPJDc8K0UlL1x1MDEwOVwiXCIxKDNcdTAxMEEqLyBcIi9cdTAxMEJcIlwiMSgzXHUwMTBDKiMgXCI3NisjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3NitfJCBcXCE3QSstJDc2KyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdBKy0kNzYrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDchKyYkLCMmNyFcIlwiXCIgWCsnIDQhNlx1MDEwRCEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhBOCsmIDQhNlx1MDEwRSEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEE5K3MkNzsraSU3XHhBRStfJSBcXCE3QistJDdceEFGKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4QUYrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4QUEqIyBcIjdceEFCIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIvXHUwMTBGXCJcIjEkM1x1MDExMCpTIFwiL1x1MDExMVwiXCIxJTNcdTAxMTIqRyBcIi9cdTAxMTNcIlwiMSUzXHUwMTE0KjsgXCIvXHUwMTE1XCJcIjElM1x1MDExNiovIFwiL1x1MDExN1wiXCIxKzNcdTAxMTgqIyBcIjdceEFDIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIvXHUwMTE5XCJcIjEnM1x1MDExQSovIFwiL1x1MDExQlwiXCIxKTNcdTAxMUMqIyBcIjdceEFDIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3NiojIFwiN1x4QUQiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTFEXCJcIjFcIjNcdTAxMUUrLSQ3NisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4QUMqIyBcIjc2IiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNzYrNyQ3PCstJTdceEIwKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiNzYqIyBcIjdIIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4QjIrNyQ3ListJTdceDhGKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDchKyYkLCMmNyFcIlwiXCIgWCsnIDQhNlx1MDExRiEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg5RCsnIDQhNlx1MDEyMCEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhCNStkJCBcXCE3QistJDdceDlGKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFhcIisoJTRcIjZcdTAxMjFcIiEhJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhITc3K2skIFxcIS5KXCJcIjJKM0srLSQ3NysjJSdcIiUkXCIjIFhcIiMgWCw+JiEuSlwiXCIySjNLKy0kNzcrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCshICglIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN0wqIyBcIjdceDk4K2MkIFxcITdCKy0kN1x4QjcrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHhCNysjJSdcIiUkXCIjIFhcIiMgWFwiKyclNFwiNlx1MDEyMlwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4QjgqIyBcIjdceDlGIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDEyM1wiXCIxIzNcdTAxMjQrPCQ3PCsyJTc2KyglNCM2XHUwMTI1IyEgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3ISsmJCwjJjchXCJcIlwiIFgrJyA0ITZcdTAxMjYhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4OUQrJyA0ITZcdTAxMjchISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcN1x4OTksIyY3XHg5OVwiK1x4ODEkN0ArdyU3TSttJTc/K2MlIFxcITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHg5RisjJSdcIiUkXCIjIFhcIiMgWFwiKyclNCU2XHUwMTI4JSAlJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceEJEIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDEyOVwiXCIxJjNcdTAxMkErcyQ3LitpJTdceEMwK18lIFxcITdBKy0kN1x4QzArIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0ErLSQ3XHhDMCsjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJyQlJCQjIFgkIyMgWCRcIiMgWFwiIyBYKiMgXCI3XHhCRSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc2K3MkNy4raSU3XHhCRitfJSBcXCE3QSstJDdceEJGKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdBKy0kN1x4QkYrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc2Kz0kNzwrMyU3NiojIFwiN0grIyUnIyUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XHhDMSpHIFwiN1x4QzMqQSBcIjdceEM1KjsgXCI3XHhDNyo1IFwiN1x4QzgqLyBcIjdceEM5KikgXCI3XHhDQSojIFwiN1x4QkYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTJCXCJcIjElM1x1MDEyQys3JDc8Ky0lN1x4QzIrIyUnIyUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN0krJyA0ITZcdTAxMkQhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDEyRVwiXCIxJjNcdTAxMkYrXHhBNSQ3PCtceDlCJTdEK1x4OTElN1x4QzQrXHg4NyUgXFwhIFxcNycrJiQsIyY3J1wiXCJcIiBYKy0kN1x4QzQrIyUnXCIlJFwiIyBYXCIjIFgsRyYhIFxcNycrJiQsIyY3J1wiXCJcIiBYKy0kN1x4QzQrIyUnXCIlJFwiIyBYXCIjIFhcIistJTdFKyMlJyYlJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN3QqIyBcIjd3IiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDEzMFwiXCIxJTNcdTAxMzErNyQ3PCstJTdceEM2KyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdJKycgNCE2XHUwMTMyISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxMzNcIlwiMSYzXHUwMTM0KzwkNzwrMiU3SSsoJTQjNlx1MDEzNSMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDEzNlwiXCIxJTNcdTAxMzcrXyQ3PCtVJSEvXHUwMTM4XCJcIjEkM1x1MDEzOSsmIDQhNlx1MDEzQSEgJSo0IFwiIS9cdTAxM0JcIlwiMSUzXHUwMTNDKyYgNCE2XHUwMTNEISAlKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxM0VcIlwiMSkzXHUwMTNGK1QkNzwrSiUvXHUwMTQwXCJcIjEjM1x1MDE0MSovIFwiL1x1MDE0MlwiXCIxKDNcdTAxNDMqIyBcIjc2KyglNCM2XHUwMTQ0IyEgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTQ1XCJcIjEjM1x1MDE0NitceDlFJDc8K1x4OTQlN0QrXHg4QSUhN1x4Q0IrayQgXFwhLkRcIlwiMkQzRSstJDdceENCKyMlJ1wiJSRcIiMgWFwiIyBYLD4mIS5EXCJcIjJEM0UrLSQ3XHhDQisjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJ1wiJSRcIiMgWFwiIyBYKy0lN0UrIyUnJSUkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxNDdcIlwiMSgzXHUwMTQ4Ki8gXCIvXHUwMTQ5XCJcIjEkM1x1MDE0QSojIFwiNzYrJyA0ITZcdTAxNEIhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNzYrXyQgXFwhN0ErLSQ3NisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QSstJDc2KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhDRStLJDcuK0ElN1x4Q0UrNyU3ListJTdceDhGKyMlJyUlJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3ISsmJCwjJjchXCJcIlwiIFgrJyA0ITZcdTAxNEMhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4RDArYyQgXFwhN0ErLSQ3XHhEMCsjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QSstJDdceEQwKyMlJ1wiJSRcIiMgWFwiIyBYXCIrJyU0XCI2XHUwMTREXCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4OTgrYyQgXFwhN0IrLSQ3XHg5RisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceDlGKyMlJ1wiJSRcIiMgWFwiIyBYXCIrJyU0XCI2XHUwMTRFXCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN0wqVCBcIjdceDk4Kk4gXCIhN0AqIyBcIiBbKz0kN3QrMyU3PyojIFwiIFsrIyUnIyUkIyMgWCRcIiMgWFwiIyBYK2MkIFxcITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHg5RisjJSdcIiUkXCIjIFhcIiMgWFwiKyclNFwiNlx1MDE0RlwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEQzK2MkIFxcITdCKy0kN1x4RDQrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHhENCsjJSdcIiUkXCIjIFhcIiMgWFwiKyclNFwiNlx1MDE1MFwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDk1KyYgNCE2XHUwMTUxISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDE1MlwiXCIxKDNcdTAxNTMrPCQ3PCsyJTc2KyglNCM2XHUwMTU0IyEgJSQjIyBYJFwiIyBYXCIjIFgqaiBcIiEvXHUwMTU1XCJcIjEmM1x1MDE1Nis8JDc8KzIlNzYrKCU0IzZcdTAxNTcjISAlJCMjIFgkXCIjIFhcIiMgWCo6IFwiIS9cdTAxNThcIlwiMSozXHUwMTU5KyYgNCE2XHUwMTVBISAlKiMgXCI3XHg5RiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3NitvJCBcXCE3QSsyJDc2KyglNFwiNlx1MDE1QlwiISAlJFwiIyBYXCIjIFgsPSYhN0ErMiQ3NisoJTRcIjZcdTAxNUJcIiEgJSRcIiMgWFwiIyBYXCIrKSU0XCI2XHUwMTVDXCJcIiEgJSRcIiMgWFwiIyBYKiMgXCIgWysnIDQhNlx1MDE1RCEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhENytfJCBcXCE3QSstJDdceEQ3KyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdBKy0kN1x4RDcrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDk4K18kIFxcITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHg5RisjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNyErJiQsIyY3IVwiXCJcIiBYKycgNCE2XHUwMTVFISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceERBK18kIFxcITdCKy0kN1x4REIrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHhEQisjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDE1RlwiXCIxJjNcdTAxNjAqOyBcIi9cdTAxNjFcIlwiMSczXHUwMTYyKi8gXCIvXHUwMTYzXCJcIjEqM1x1MDE2NCojIFwiNzYrJiA0ITZcdTAxNjUhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTY2XCJcIjEmM1x1MDE2Nys8JDc8KzIlN1x4REMrKCU0IzZcdTAxNjgjISAlJCMjIFgkXCIjIFhcIiMgWCpceDgzIFwiIS9ceEY2XCJcIjEnM1x4RjcrPCQ3PCsyJTdceDlEKyglNCM2XHUwMTY5IyEgJSQjIyBYJFwiIyBYXCIjIFgqUyBcIiEvXHUwMTZBXCJcIjErM1x1MDE2Qis8JDc8KzIlN1x4OUQrKCU0IzZcdTAxNkMjISAlJCMjIFgkXCIjIFhcIiMgWCojIFwiN1x4OUYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi9cdTAxNkRcIlwiMSszXHUwMTZFKmsgXCIvXHUwMTZGXCJcIjEpM1x1MDE3MCpfIFwiL1x1MDE3MVwiXCIxKDNcdTAxNzIqUyBcIi9cdTAxNzNcIlwiMSczXHUwMTc0KkcgXCIvXHUwMTc1XCJcIjEmM1x1MDE3Nio7IFwiL1x1MDE3N1wiXCIxKjNcdTAxNzgqLyBcIi9cdTAxNzlcIlwiMSkzXHUwMTdBKiMgXCI3NiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiNzEqIyBcIiBbIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhITc2K28kIFxcITdBKzIkNzYrKCU0XCI2XHUwMTVCXCIhICUkXCIjIFhcIiMgWCw9JiE3QSsyJDc2KyglNFwiNlx1MDE1QlwiISAlJFwiIyBYXCIjIFhcIispJTRcIjZcdTAxNUNcIlwiISAlJFwiIyBYXCIjIFgqIyBcIiBbKycgNCE2XHUwMTdCISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdMKiMgXCI3XHg5OCtjJCBcXCE3QistJDdceEUwKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4RTArIyUnXCIlJFwiIyBYXCIjIFhcIisnJTRcIjZcdTAxN0NcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceEI4KiMgXCI3XHg5RiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEUyK18kIFxcITdBKy0kN1x4RTIrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0ErLSQ3XHhFMisjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4RTkrcyQ3LitpJTdceEVDK18lIFxcITdCKy0kN1x4RTMrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHhFMysjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJyQlJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XHhFNCo7IFwiN1x4RTUqNSBcIjdceEU2Ki8gXCI3XHhFNyopIFwiN1x4RTgqIyBcIjdceDlGIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDE3RFwiXCIxIzNcdTAxN0UrPCQ3PCsyJTdceEVGKyglNCM2XHUwMTdGIyEgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTgwXCJcIjElM1x1MDE4MSs8JDc8KzIlN1QrKCU0IzZcdTAxODIjISAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxODNcIlwiMSgzXHUwMTg0K0IkNzwrOCU3XFwqIyBcIjdZKyglNCM2XHUwMTg1IyEgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTg2XCJcIjEmM1x1MDE4Nys8JDc8KzIlNzYrKCU0IzZcdTAxODgjISAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxODlcIlwiMSUzXHUwMThBK1QkITc8KzUkIFxcNyEsIyY3IVwiKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWysnJTRcIjZcdTAxOEJcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhFQStLJDc7K0ElNzYrNyU3OystJTdceEVCKyMlJyUlJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHg5NVwiXCIxIzNceEQ2KiMgXCI3NisnIDQhNlx1MDE4QyEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhCNFwiXCIxIzNcdTAxOEQqRyBcIi9ceEI2XCJcIjEjM1x1MDE4RSo7IFwiL1x4QkFcIlwiMSMzXHUwMThGKi8gXCIvXHhCOFwiXCIxJDNcdTAxOTAqIyBcIjc2KycgNCE2XHUwMTkxISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEVEK0gkITdDKy0kN1x4RUUrIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1UqKSBcIjdcXCojIFwiN1grJiA0ITZcdTAxOTIhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEhNyEqIyBcIiBbK2MkNyEqIyBcIiBbK1MlNyEqIyBcIiBbK0MlNyEqIyBcIiBbKzMlNyEqIyBcIiBbKyMlJyUlJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgrJyA0ITZcdTAxOTMhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhITchK0MkNyEqIyBcIiBbKzMlNyEqIyBcIiBbKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCsnIDQhNlx1MDE5NCEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceEJEIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4OUQrZCQgXFwhN0IrLSQ3XHhGMisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceEYyKyMlJ1wiJSRcIiMgWFwiIyBYXCIrKCU0XCI2XHUwMTk1XCIhISUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4RjMqIyBcIjdceDlGIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhLlx1MDE5NlwiXCIyXHUwMTk2M1x1MDE5NytOJDc8K0QlLlx1MDE5OFwiXCIyXHUwMTk4M1x1MDE5OSopIFwiLlx1MDE5QVwiXCIyXHUwMTlBM1x1MDE5QisoJTQjNlx1MDE5QyMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4OUQrZCQgXFwhN0IrLSQ3XHg5RisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceDlGKyMlJ1wiJSRcIiMgWFwiIyBYXCIrKCU0XCI2XHUwMTlEXCIhISUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc2KzckNzArLSU3XHhGNisjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiBcXDcyKikgXCI3NCojIFwiNy4sLyY3MiopIFwiNzQqIyBcIjcuXCIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiBcXDclLCMmNyVcIiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEY5Kz0kLjhcIlwiMjgzOSstJTdceEZBKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxOUVcIlwiMSUzXHUwMTlGKikgXCIvXHUwMUEwXCJcIjEkM1x1MDFBMSsnIDQhNlx1MDFBMiEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhGQitOJCEuOFwiXCIyODM5Ky0kN14rIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1xcKikgXCI3WCojIFwiN1x4ODIrJyA0ITZcdTAxQTMhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcN1x4RkQqKSBcIjctKiMgXCI3XHhGRSwvJjdceEZEKikgXCI3LSojIFwiN1x4RkVcIishICglIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XCIqUyBcIjchKk0gXCIuRlwiXCIyRjNHKkEgXCIuSlwiXCIySjNLKjUgXCIuSFwiXCIySDNJKikgXCIuTlwiXCIyTjNPIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIuTFwiXCIyTDNNKlx4OTUgXCIuQlwiXCIyQjNDKlx4ODkgXCIuPFwiXCIyPDM9Kn0gXCIuUlwiXCIyUjNTKnEgXCIuVFwiXCIyVDNVKmUgXCIuVlwiXCIyVjNXKlkgXCIuUFwiXCIyUDNRKk0gXCIuQFwiXCIyQDNBKkEgXCIuRFwiXCIyRDNFKjUgXCIuMlwiXCIyMjMzKikgXCIuPlwiXCIyPjM/IiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x1MDEwMCtoJC44XCJcIjI4MzkrWCU3XHhGQStOJSEuXHUwMUE0XCJcIjJcdTAxQTQzXHUwMUE1Ky0kN1x4RUIrIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKyMlJyQlJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDFBNlwiXCIxJTNcdTAxQTcqKSBcIi9cdTAxQThcIlwiMSQzXHUwMUE5KycgNCE2XHUwMUEyISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEVCK1EkL1x4QjRcIlwiMSMzXHhCNSo3IFwiL1x4QjZcIlwiMSMzXHhCNyorIFwiIFxcNyssIyY3K1wiKyclNFwiNlx1MDFBQVwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdcdTAxMDQrXHg4RiQuRlwiXCIyRjNHK38lN1x1MDEwMyt1JS5GXCJcIjJGM0crZSU3XHUwMTAzK1slLkZcIlwiMkYzRytLJTdcdTAxMDMrQSUuRlwiXCIyRjNHKzElN1x1MDEwNSsnJTQpNlx1MDFBQikgJSQpIyBYJCgjIFgkJyMgWCQmIyBYJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3IytBJDcjKzclNyMrLSU3IysjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdcdTAxMDMrLSQ3XHUwMTAzKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x1MDEwMys3JDdcdTAxMDMrLSU3XHUwMTAzKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpCiAgICAgICAgXSwKCiAgICAgICAgcGVnJGN1cnJQb3MgICAgICAgICAgPSAwLAogICAgICAgIHBlZyRyZXBvcnRlZFBvcyAgICAgID0gMCwKICAgICAgICBwZWckY2FjaGVkUG9zICAgICAgICA9IDAsCiAgICAgICAgcGVnJGNhY2hlZFBvc0RldGFpbHMgPSB7IGxpbmU6IDEsIGNvbHVtbjogMSwgc2VlbkNSOiBmYWxzZSB9LAogICAgICAgIHBlZyRtYXhGYWlsUG9zICAgICAgID0gMCwKICAgICAgICBwZWckbWF4RmFpbEV4cGVjdGVkICA9IFtdLAogICAgICAgIHBlZyRzaWxlbnRGYWlscyAgICAgID0gMCwKCiAgICAgICAgcGVnJHJlc3VsdDsKCiAgICBpZiAoInN0YXJ0UnVsZSIgaW4gb3B0aW9ucykgewogICAgICBpZiAoIShvcHRpb25zLnN0YXJ0UnVsZSBpbiBwZWckc3RhcnRSdWxlSW5kaWNlcykpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbid0IHN0YXJ0IHBhcnNpbmcgZnJvbSBydWxlIFwiIiArIG9wdGlvbnMuc3RhcnRSdWxlICsgIlwiLiIpOwogICAgICB9CgogICAgICBwZWckc3RhcnRSdWxlSW5kZXggPSBwZWckc3RhcnRSdWxlSW5kaWNlc1tvcHRpb25zLnN0YXJ0UnVsZV07CiAgICB9CgogICAgZnVuY3Rpb24gdGV4dCgpIHsKICAgICAgcmV0dXJuIGlucHV0LnN1YnN0cmluZyhwZWckcmVwb3J0ZWRQb3MsIHBlZyRjdXJyUG9zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvZmZzZXQoKSB7CiAgICAgIHJldHVybiBwZWckcmVwb3J0ZWRQb3M7CiAgICB9CgogICAgZnVuY3Rpb24gbGluZSgpIHsKICAgICAgcmV0dXJuIHBlZyRjb21wdXRlUG9zRGV0YWlscyhwZWckcmVwb3J0ZWRQb3MpLmxpbmU7CiAgICB9CgogICAgZnVuY3Rpb24gY29sdW1uKCkgewogICAgICByZXR1cm4gcGVnJGNvbXB1dGVQb3NEZXRhaWxzKHBlZyRyZXBvcnRlZFBvcykuY29sdW1uOwogICAgfQoKICAgIGZ1bmN0aW9uIGV4cGVjdGVkKGRlc2NyaXB0aW9uKSB7CiAgICAgIHRocm93IHBlZyRidWlsZEV4Y2VwdGlvbigKICAgICAgICBudWxsLAogICAgICAgIFt7IHR5cGU6ICJvdGhlciIsIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiB9XSwKICAgICAgICBwZWckcmVwb3J0ZWRQb3MKICAgICAgKTsKICAgIH0KCiAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlKSB7CiAgICAgIHRocm93IHBlZyRidWlsZEV4Y2VwdGlvbihtZXNzYWdlLCBudWxsLCBwZWckcmVwb3J0ZWRQb3MpOwogICAgfQoKICAgIGZ1bmN0aW9uIHBlZyRjb21wdXRlUG9zRGV0YWlscyhwb3MpIHsKICAgICAgZnVuY3Rpb24gYWR2YW5jZShkZXRhaWxzLCBzdGFydFBvcywgZW5kUG9zKSB7CiAgICAgICAgdmFyIHAsIGNoOwoKICAgICAgICBmb3IgKHAgPSBzdGFydFBvczsgcCA8IGVuZFBvczsgcCsrKSB7CiAgICAgICAgICBjaCA9IGlucHV0LmNoYXJBdChwKTsKICAgICAgICAgIGlmIChjaCA9PT0gIlxuIikgewogICAgICAgICAgICBpZiAoIWRldGFpbHMuc2VlbkNSKSB7IGRldGFpbHMubGluZSsrOyB9CiAgICAgICAgICAgIGRldGFpbHMuY29sdW1uID0gMTsKICAgICAgICAgICAgZGV0YWlscy5zZWVuQ1IgPSBmYWxzZTsKICAgICAgICAgIH0gZWxzZSBpZiAoY2ggPT09ICJcciIgfHwgY2ggPT09ICJcdTIwMjgiIHx8IGNoID09PSAiXHUyMDI5IikgewogICAgICAgICAgICBkZXRhaWxzLmxpbmUrKzsKICAgICAgICAgICAgZGV0YWlscy5jb2x1bW4gPSAxOwogICAgICAgICAgICBkZXRhaWxzLnNlZW5DUiA9IHRydWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZXRhaWxzLmNvbHVtbisrOwogICAgICAgICAgICBkZXRhaWxzLnNlZW5DUiA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHBlZyRjYWNoZWRQb3MgIT09IHBvcykgewogICAgICAgIGlmIChwZWckY2FjaGVkUG9zID4gcG9zKSB7CiAgICAgICAgICBwZWckY2FjaGVkUG9zID0gMDsKICAgICAgICAgIHBlZyRjYWNoZWRQb3NEZXRhaWxzID0geyBsaW5lOiAxLCBjb2x1bW46IDEsIHNlZW5DUjogZmFsc2UgfTsKICAgICAgICB9CiAgICAgICAgYWR2YW5jZShwZWckY2FjaGVkUG9zRGV0YWlscywgcGVnJGNhY2hlZFBvcywgcG9zKTsKICAgICAgICBwZWckY2FjaGVkUG9zID0gcG9zOwogICAgICB9CgogICAgICByZXR1cm4gcGVnJGNhY2hlZFBvc0RldGFpbHM7CiAgICB9CgogICAgZnVuY3Rpb24gcGVnJGZhaWwoZXhwZWN0ZWQpIHsKICAgICAgaWYgKHBlZyRjdXJyUG9zIDwgcGVnJG1heEZhaWxQb3MpIHsgcmV0dXJuOyB9CgogICAgICBpZiAocGVnJGN1cnJQb3MgPiBwZWckbWF4RmFpbFBvcykgewogICAgICAgIHBlZyRtYXhGYWlsUG9zID0gcGVnJGN1cnJQb3M7CiAgICAgICAgcGVnJG1heEZhaWxFeHBlY3RlZCA9IFtdOwogICAgICB9CgogICAgICBwZWckbWF4RmFpbEV4cGVjdGVkLnB1c2goZXhwZWN0ZWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIHBlZyRidWlsZEV4Y2VwdGlvbihtZXNzYWdlLCBleHBlY3RlZCwgcG9zKSB7CiAgICAgIGZ1bmN0aW9uIGNsZWFudXBFeHBlY3RlZChleHBlY3RlZCkgewogICAgICAgIHZhciBpID0gMTsKCiAgICAgICAgZXhwZWN0ZWQuc29ydChmdW5jdGlvbihhLCBiKSB7CiAgICAgICAgICBpZiAoYS5kZXNjcmlwdGlvbiA8IGIuZGVzY3JpcHRpb24pIHsKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgfSBlbHNlIGlmIChhLmRlc2NyaXB0aW9uID4gYi5kZXNjcmlwdGlvbikgewogICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICB3aGlsZSAoaSA8IGV4cGVjdGVkLmxlbmd0aCkgewogICAgICAgICAgaWYgKGV4cGVjdGVkW2kgLSAxXSA9PT0gZXhwZWN0ZWRbaV0pIHsKICAgICAgICAgICAgZXhwZWN0ZWQuc3BsaWNlKGksIDEpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaSsrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgZnVuY3Rpb24gYnVpbGRNZXNzYWdlKGV4cGVjdGVkLCBmb3VuZCkgewogICAgICAgIGZ1bmN0aW9uIHN0cmluZ0VzY2FwZShzKSB7CiAgICAgICAgICBmdW5jdGlvbiBoZXgoY2gpIHsgcmV0dXJuIGNoLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpLnRvVXBwZXJDYXNlKCk7IH0KCiAgICAgICAgICByZXR1cm4gcwogICAgICAgICAgICAucmVwbGFjZSgvXFwvZywgICAnXFxcXCcpCiAgICAgICAgICAgIC5yZXBsYWNlKC8iL2csICAgICdcXCInKQogICAgICAgICAgICAucmVwbGFjZSgvXHgwOC9nLCAnXFxiJykKICAgICAgICAgICAgLnJlcGxhY2UoL1x0L2csICAgJ1xcdCcpCiAgICAgICAgICAgIC5yZXBsYWNlKC9cbi9nLCAgICdcXG4nKQogICAgICAgICAgICAucmVwbGFjZSgvXGYvZywgICAnXFxmJykKICAgICAgICAgICAgLnJlcGxhY2UoL1xyL2csICAgJ1xccicpCiAgICAgICAgICAgIC5yZXBsYWNlKC9bXHgwMC1ceDA3XHgwQlx4MEVceDBGXS9nLCBmdW5jdGlvbihjaCkgeyByZXR1cm4gJ1xceDAnICsgaGV4KGNoKTsgfSkKICAgICAgICAgICAgLnJlcGxhY2UoL1tceDEwLVx4MUZceDgwLVx4RkZdL2csICAgIGZ1bmN0aW9uKGNoKSB7IHJldHVybiAnXFx4JyAgKyBoZXgoY2gpOyB9KQogICAgICAgICAgICAucmVwbGFjZSgvW1x1MDE4MC1cdTBGRkZdL2csICAgICAgICAgZnVuY3Rpb24oY2gpIHsgcmV0dXJuICdcXHUwJyArIGhleChjaCk7IH0pCiAgICAgICAgICAgIC5yZXBsYWNlKC9bXHUxMDgwLVx1RkZGRl0vZywgICAgICAgICBmdW5jdGlvbihjaCkgeyByZXR1cm4gJ1xcdScgICsgaGV4KGNoKTsgfSk7CiAgICAgICAgfQoKICAgICAgICB2YXIgZXhwZWN0ZWREZXNjcyA9IG5ldyBBcnJheShleHBlY3RlZC5sZW5ndGgpLAogICAgICAgICAgICBleHBlY3RlZERlc2MsIGZvdW5kRGVzYywgaTsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IGV4cGVjdGVkLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBleHBlY3RlZERlc2NzW2ldID0gZXhwZWN0ZWRbaV0uZGVzY3JpcHRpb247CiAgICAgICAgfQoKICAgICAgICBleHBlY3RlZERlc2MgPSBleHBlY3RlZC5sZW5ndGggPiAxCiAgICAgICAgICA/IGV4cGVjdGVkRGVzY3Muc2xpY2UoMCwgLTEpLmpvaW4oIiwgIikKICAgICAgICAgICAgICArICIgb3IgIgogICAgICAgICAgICAgICsgZXhwZWN0ZWREZXNjc1tleHBlY3RlZC5sZW5ndGggLSAxXQogICAgICAgICAgOiBleHBlY3RlZERlc2NzWzBdOwoKICAgICAgICBmb3VuZERlc2MgPSBmb3VuZCA/ICJcIiIgKyBzdHJpbmdFc2NhcGUoZm91bmQpICsgIlwiIiA6ICJlbmQgb2YgaW5wdXQiOwoKICAgICAgICByZXR1cm4gIkV4cGVjdGVkICIgKyBleHBlY3RlZERlc2MgKyAiIGJ1dCAiICsgZm91bmREZXNjICsgIiBmb3VuZC4iOwogICAgICB9CgogICAgICB2YXIgcG9zRGV0YWlscyA9IHBlZyRjb21wdXRlUG9zRGV0YWlscyhwb3MpLAogICAgICAgICAgZm91bmQgICAgICA9IHBvcyA8IGlucHV0Lmxlbmd0aCA/IGlucHV0LmNoYXJBdChwb3MpIDogbnVsbDsKCiAgICAgIGlmIChleHBlY3RlZCAhPT0gbnVsbCkgewogICAgICAgIGNsZWFudXBFeHBlY3RlZChleHBlY3RlZCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgU3ludGF4RXJyb3IoCiAgICAgICAgbWVzc2FnZSAhPT0gbnVsbCA/IG1lc3NhZ2UgOiBidWlsZE1lc3NhZ2UoZXhwZWN0ZWQsIGZvdW5kKSwKICAgICAgICBleHBlY3RlZCwKICAgICAgICBmb3VuZCwKICAgICAgICBwb3MsCiAgICAgICAgcG9zRGV0YWlscy5saW5lLAogICAgICAgIHBvc0RldGFpbHMuY29sdW1uCiAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gcGVnJGRlY29kZShzKSB7CiAgICAgIHZhciBiYyA9IG5ldyBBcnJheShzLmxlbmd0aCksIGk7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgcy5sZW5ndGg7IGkrKykgewogICAgICAgIGJjW2ldID0gcy5jaGFyQ29kZUF0KGkpIC0gMzI7CiAgICAgIH0KCiAgICAgIHJldHVybiBiYzsKICAgIH0KCiAgICBmdW5jdGlvbiBwZWckcGFyc2VSdWxlKGluZGV4KSB7CiAgICAgIHZhciBiYyAgICA9IHBlZyRieXRlY29kZVtpbmRleF0sCiAgICAgICAgICBpcCAgICA9IDAsCiAgICAgICAgICBpcHMgICA9IFtdLAogICAgICAgICAgZW5kICAgPSBiYy5sZW5ndGgsCiAgICAgICAgICBlbmRzICA9IFtdLAogICAgICAgICAgc3RhY2sgPSBbXSwKICAgICAgICAgIHBhcmFtcywgaTsKCiAgICAgIGZ1bmN0aW9uIHByb3RlY3Qob2JqZWN0KSB7CiAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuYXBwbHkob2JqZWN0KSA9PT0gIltvYmplY3QgQXJyYXldIiA/IFtdIDogb2JqZWN0OwogICAgICB9CgogICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgIHdoaWxlIChpcCA8IGVuZCkgewogICAgICAgICAgc3dpdGNoIChiY1tpcF0pIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHN0YWNrLnB1c2gocHJvdGVjdChwZWckY29uc3RzW2JjW2lwICsgMV1dKSk7CiAgICAgICAgICAgICAgaXAgKz0gMjsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICBzdGFjay5wdXNoKHBlZyRjdXJyUG9zKTsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHN0YWNrLnBvcCgpOwogICAgICAgICAgICAgIGlwKys7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgcGVnJGN1cnJQb3MgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHN0YWNrLmxlbmd0aCAtPSBiY1tpcCArIDFdOwogICAgICAgICAgICAgIGlwICs9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgc3RhY2suc3BsaWNlKC0yLCAxKTsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIHN0YWNrW3N0YWNrLmxlbmd0aCAtIDJdLnB1c2goc3RhY2sucG9wKCkpOwogICAgICAgICAgICAgIGlwKys7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgc3RhY2sucHVzaChzdGFjay5zcGxpY2Uoc3RhY2subGVuZ3RoIC0gYmNbaXAgKyAxXSwgYmNbaXAgKyAxXSkpOwogICAgICAgICAgICAgIGlwICs9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgc3RhY2sucG9wKCk7CiAgICAgICAgICAgICAgc3RhY2sucHVzaChpbnB1dC5zdWJzdHJpbmcoc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0sIHBlZyRjdXJyUG9zKSk7CiAgICAgICAgICAgICAgaXArKzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBlbmRzLnB1c2goZW5kKTsKICAgICAgICAgICAgICBpcHMucHVzaChpcCArIDMgKyBiY1tpcCArIDFdICsgYmNbaXAgKyAyXSk7CgogICAgICAgICAgICAgIGlmIChzdGFja1tzdGFjay5sZW5ndGggLSAxXSkgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyAzICsgYmNbaXAgKyAxXTsKICAgICAgICAgICAgICAgIGlwICs9IDM7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgMyArIGJjW2lwICsgMV0gKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgICAgaXAgKz0gMyArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgZW5kcy5wdXNoKGVuZCk7CiAgICAgICAgICAgICAgaXBzLnB1c2goaXAgKyAzICsgYmNbaXAgKyAxXSArIGJjW2lwICsgMl0pOwoKICAgICAgICAgICAgICBpZiAoc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0gPT09IHBlZyRGQUlMRUQpIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgMyArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgICBpcCArPSAzOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDMgKyBiY1tpcCArIDFdICsgYmNbaXAgKyAyXTsKICAgICAgICAgICAgICAgIGlwICs9IDMgKyBiY1tpcCArIDFdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIGVuZHMucHVzaChlbmQpOwogICAgICAgICAgICAgIGlwcy5wdXNoKGlwICsgMyArIGJjW2lwICsgMV0gKyBiY1tpcCArIDJdKTsKCiAgICAgICAgICAgICAgaWYgKHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdICE9PSBwZWckRkFJTEVEKSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDMgKyBiY1tpcCArIDFdOwogICAgICAgICAgICAgICAgaXAgKz0gMzsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyAzICsgYmNbaXAgKyAxXSArIGJjW2lwICsgMl07CiAgICAgICAgICAgICAgICBpcCArPSAzICsgYmNbaXAgKyAxXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICBpZiAoc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0gIT09IHBlZyRGQUlMRUQpIHsKICAgICAgICAgICAgICAgIGVuZHMucHVzaChlbmQpOwogICAgICAgICAgICAgICAgaXBzLnB1c2goaXApOwoKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgMiArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgICBpcCArPSAyOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpcCArPSAyICsgYmNbaXAgKyAxXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICBlbmRzLnB1c2goZW5kKTsKICAgICAgICAgICAgICBpcHMucHVzaChpcCArIDMgKyBiY1tpcCArIDFdICsgYmNbaXAgKyAyXSk7CgogICAgICAgICAgICAgIGlmIChpbnB1dC5sZW5ndGggPiBwZWckY3VyclBvcykgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyAzICsgYmNbaXAgKyAxXTsKICAgICAgICAgICAgICAgIGlwICs9IDM7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgMyArIGJjW2lwICsgMV0gKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgICAgaXAgKz0gMyArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgZW5kcy5wdXNoKGVuZCk7CiAgICAgICAgICAgICAgaXBzLnB1c2goaXAgKyA0ICsgYmNbaXAgKyAyXSArIGJjW2lwICsgM10pOwoKICAgICAgICAgICAgICBpZiAoaW5wdXQuc3Vic3RyKHBlZyRjdXJyUG9zLCBwZWckY29uc3RzW2JjW2lwICsgMV1dLmxlbmd0aCkgPT09IHBlZyRjb25zdHNbYmNbaXAgKyAxXV0pIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgNCArIGJjW2lwICsgMl07CiAgICAgICAgICAgICAgICBpcCArPSA0OwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDQgKyBiY1tpcCArIDJdICsgYmNbaXAgKyAzXTsKICAgICAgICAgICAgICAgIGlwICs9IDQgKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgIGVuZHMucHVzaChlbmQpOwogICAgICAgICAgICAgIGlwcy5wdXNoKGlwICsgNCArIGJjW2lwICsgMl0gKyBiY1tpcCArIDNdKTsKCiAgICAgICAgICAgICAgaWYgKGlucHV0LnN1YnN0cihwZWckY3VyclBvcywgcGVnJGNvbnN0c1tiY1tpcCArIDFdXS5sZW5ndGgpLnRvTG93ZXJDYXNlKCkgPT09IHBlZyRjb25zdHNbYmNbaXAgKyAxXV0pIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgNCArIGJjW2lwICsgMl07CiAgICAgICAgICAgICAgICBpcCArPSA0OwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDQgKyBiY1tpcCArIDJdICsgYmNbaXAgKyAzXTsKICAgICAgICAgICAgICAgIGlwICs9IDQgKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgIGVuZHMucHVzaChlbmQpOwogICAgICAgICAgICAgIGlwcy5wdXNoKGlwICsgNCArIGJjW2lwICsgMl0gKyBiY1tpcCArIDNdKTsKCiAgICAgICAgICAgICAgaWYgKHBlZyRjb25zdHNbYmNbaXAgKyAxXV0udGVzdChpbnB1dC5jaGFyQXQocGVnJGN1cnJQb3MpKSkgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyA0ICsgYmNbaXAgKyAyXTsKICAgICAgICAgICAgICAgIGlwICs9IDQ7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgNCArIGJjW2lwICsgMl0gKyBiY1tpcCArIDNdOwogICAgICAgICAgICAgICAgaXAgKz0gNCArIGJjW2lwICsgMl07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgc3RhY2sucHVzaChpbnB1dC5zdWJzdHIocGVnJGN1cnJQb3MsIGJjW2lwICsgMV0pKTsKICAgICAgICAgICAgICBwZWckY3VyclBvcyArPSBiY1tpcCArIDFdOwogICAgICAgICAgICAgIGlwICs9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgIHN0YWNrLnB1c2gocGVnJGNvbnN0c1tiY1tpcCArIDFdXSk7CiAgICAgICAgICAgICAgcGVnJGN1cnJQb3MgKz0gcGVnJGNvbnN0c1tiY1tpcCArIDFdXS5sZW5ndGg7CiAgICAgICAgICAgICAgaXAgKz0gMjsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgc3RhY2sucHVzaChwZWckRkFJTEVEKTsKICAgICAgICAgICAgICBpZiAocGVnJHNpbGVudEZhaWxzID09PSAwKSB7CiAgICAgICAgICAgICAgICBwZWckZmFpbChwZWckY29uc3RzW2JjW2lwICsgMV1dKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaXAgKz0gMjsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgcGVnJHJlcG9ydGVkUG9zID0gc3RhY2tbc3RhY2subGVuZ3RoIC0gMSAtIGJjW2lwICsgMV1dOwogICAgICAgICAgICAgIGlwICs9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgIHBlZyRyZXBvcnRlZFBvcyA9IHBlZyRjdXJyUG9zOwogICAgICAgICAgICAgIGlwKys7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgIHBhcmFtcyA9IGJjLnNsaWNlKGlwICsgNCwgaXAgKyA0ICsgYmNbaXAgKyAzXSk7CiAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGJjW2lwICsgM107IGkrKykgewogICAgICAgICAgICAgICAgcGFyYW1zW2ldID0gc3RhY2tbc3RhY2subGVuZ3RoIC0gMSAtIHBhcmFtc1tpXV07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzdGFjay5zcGxpY2UoCiAgICAgICAgICAgICAgICBzdGFjay5sZW5ndGggLSBiY1tpcCArIDJdLAogICAgICAgICAgICAgICAgYmNbaXAgKyAyXSwKICAgICAgICAgICAgICAgIHBlZyRjb25zdHNbYmNbaXAgKyAxXV0uYXBwbHkobnVsbCwgcGFyYW1zKQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgIGlwICs9IDQgKyBiY1tpcCArIDNdOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgICBzdGFjay5wdXNoKHBlZyRwYXJzZVJ1bGUoYmNbaXAgKyAxXSkpOwogICAgICAgICAgICAgIGlwICs9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgIHBlZyRzaWxlbnRGYWlscysrOwogICAgICAgICAgICAgIGlwKys7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgIHBlZyRzaWxlbnRGYWlscy0tOwogICAgICAgICAgICAgIGlwKys7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBvcGNvZGU6ICIgKyBiY1tpcF0gKyAiLiIpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVuZHMubGVuZ3RoID4gMCkgewogICAgICAgICAgZW5kID0gZW5kcy5wb3AoKTsKICAgICAgICAgIGlwID0gaXBzLnBvcCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBzdGFja1swXTsKICAgIH0KCgogICAgICBvcHRpb25zLmRhdGEgPSB7fTsgLy8gT2JqZWN0IHRvIHdoaWNoIGhlYWRlciBhdHRyaWJ1dGVzIHdpbGwgYmUgYXNzaWduZWQgZHVyaW5nIHBhcnNpbmcKCiAgICAgIGZ1bmN0aW9uIGxpc3QgKGZpcnN0LCByZXN0KSB7CiAgICAgICAgcmV0dXJuIFtmaXJzdF0uY29uY2F0KHJlc3QpOwogICAgICB9CgoKICAgIHBlZyRyZXN1bHQgPSBwZWckcGFyc2VSdWxlKHBlZyRzdGFydFJ1bGVJbmRleCk7CgogICAgaWYgKHBlZyRyZXN1bHQgIT09IHBlZyRGQUlMRUQgJiYgcGVnJGN1cnJQb3MgPT09IGlucHV0Lmxlbmd0aCkgewogICAgICByZXR1cm4gcGVnJHJlc3VsdDsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChwZWckcmVzdWx0ICE9PSBwZWckRkFJTEVEICYmIHBlZyRjdXJyUG9zIDwgaW5wdXQubGVuZ3RoKSB7CiAgICAgICAgcGVnJGZhaWwoeyB0eXBlOiAiZW5kIiwgZGVzY3JpcHRpb246ICJlbmQgb2YgaW5wdXQiIH0pOwogICAgICB9CgogICAgICB0aHJvdyBwZWckYnVpbGRFeGNlcHRpb24obnVsbCwgcGVnJG1heEZhaWxFeHBlY3RlZCwgcGVnJG1heEZhaWxQb3MpOwogICAgfQogIH0KCiAgcmV0dXJuIHsKICAgIFN5bnRheEVycm9yOiBTeW50YXhFcnJvciwKICAgIHBhcnNlOiAgICAgICBwYXJzZQogIH07Cn0pKCk7Cgp9LHt9XSwxOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgSGFja3MgLSBUaGlzIGZpbGUgY29udGFpbnMgYWxsIG9mIHRoZSB0aGluZ3Mgd2UKICogd2lzaCB3ZSBkaWRuJ3QgaGF2ZSB0byBkbywganVzdCBmb3IgaW50ZXJvcC4gIEl0IGlzIHNpbWlsYXIgdG8KICogVXRpbHMsIHdoaWNoIHByb3ZpZGVzIGFjdHVhbGx5IHVzZWZ1bCBhbmQgcmVsZXZhbnQgZnVuY3Rpb25zIGZvcgogKiBhIFNJUCBsaWJyYXJ5LiBNZXRob2RzIGluIHRoaXMgZmlsZSBhcmUgZ3JvdXBlZCBieSB2ZW5kb3IsIHNvCiAqIGFzIHRvIG1vc3QgZWFzaWx5IHRyYWNrIHdoZW4gcGFydGljdWxhciBoYWNrcyBtYXkgbm90IGJlIG5lY2Vzc2FyeSBhbnltb3JlLgogKi8KCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewoKLy9rZWVwIHRvIHF1aWV0IGpzaGludCwgYW5kIHJlbWFpbiBjb25zaXN0ZW50IHdpdGggb3RoZXIgZmlsZXMKU0lQID0gU0lQOwoKdmFyIEhhY2tzID0gewogIEFsbEJyb3dzZXJzOiB7CiAgICBtYXNrRHRsczogZnVuY3Rpb24gKG1lc3NhZ2UpIHsKICAgICAgaWYgKG1lc3NhZ2UuYm9keSkgewogICAgICAgIG1lc3NhZ2UuYm9keSA9IG1lc3NhZ2UuYm9keS5yZXBsYWNlKC8gVURQXC9UTFNcL1JUUFwvU0FWUC9nbWksICIgUlRQL1NBVlAiKTsKICAgICAgfQogICAgfSwKICAgIHVubWFza0R0bHM6IGZ1bmN0aW9uIChzZHApIHsKICAgICAgLyoqCiAgICAgICAqIENocm9tZSBkb2VzIG5vdCBoYW5kbGUgRFRMUyBjb3JyZWN0bHkgKENhbmFyYXkgZG9lcywgYnV0IG5vdCBwcm9kdWN0aW9uKQogICAgICAgKiBrZWVwaW5nIENocm9tZSBhcyBTREVTIHVudGlsIERUTFMgaXMgZml4ZWQgKGNvbW1lbnQgb3V0ICdpc19vcGVyYScgY29uZGl0aW9uKQogICAgICAgKgogICAgICAgKiBVUERBVEU6IE1heSAyMSwgMjAxNAogICAgICAgKiBDaHJvbWUgMzUgbm93IHByb3Blcmx5IGRlZmF1bHRzIHRvIERUTFMuICBPbmx5IE9wZXJhIHJlbWFpbnMgdXNpbmcgU0RFUwogICAgICAgKgogICAgICAgKiBVUERBVEU6IDIwMTQtMDktMjQKICAgICAgICogT3BlcmEgbm93IHN1cHBvcnRzIERUTFMgYnkgZGVmYXVsdCBhcyB3ZWxsLgogICAgICAgKgogICAgICAgKiovCiAgICAgIHJldHVybiBzZHAucmVwbGFjZSgvIFJUUFwvU0FWUC9nbWksICIgVURQL1RMUy9SVFAvU0FWUCIpOwogICAgfQogIH0sCiAgRmlyZWZveDogewogICAgLyogQ29uZGl0aW9uIHRvIGRldGVjdCBpZiBoYWNrcyBhcmUgYXBwbGljYWJsZSAqLwogICAgaXNGaXJlZm94OiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0eXBlb2YgbW96UlRDUGVlckNvbm5lY3Rpb24gIT09ICd1bmRlZmluZWQnOwogICAgfSwKCiAgICBjYW5ub3RIYW5kbGVFeHRyYVdoaXRlc3BhY2U6IGZ1bmN0aW9uIChtZXNzYWdlKSB7CiAgICAgIGlmICh0aGlzLmlzRmlyZWZveCgpICYmIG1lc3NhZ2UuYm9keSkgewogICAgICAgIG1lc3NhZ2UuYm9keSA9IG1lc3NhZ2UuYm9keS5yZXBsYWNlKC8gXHJcbi9nLCAiXHJcbiIpOwogICAgICB9CiAgICB9LAoKICAgIGhhc01pc3NpbmdDTGluZUluU0RQOiBmdW5jdGlvbiAoc2RwKSB7CiAgICAgIC8qCiAgICAgICAqIFRoaXMgaXMgYSBGaXJlZm94IGhhY2sgdG8gaW5zZXJ0IHZhbGlkIHNkcCB3aGVuIGdldERlc2NyaXB0aW9uIGlzCiAgICAgICAqIGNhbGxlZCB3aXRoIHRoZSBjb25zdHJhaW50IG9mZmVyVG9SZWNlaXZlVmlkZW8gPSBmYWxzZS4KICAgICAgICogV2Ugc2VhcmNoIGZvciBlaXRoZXIgYSBjLWxpbmUgYXQgdGhlIHRvcCBvZiB0aGUgc2RwIGFib3ZlIGFsbAogICAgICAgKiBtLWxpbmVzLiBJZiB0aGF0IGRvZXMgbm90IGV4aXN0IHRoZW4gd2Ugc2VhcmNoIGZvciBhIGMtbGluZQogICAgICAgKiBiZW5lYXRoIGVhY2ggbS1saW5lLiBJZiBpdCBpcyBtaXNzaW5nIGEgYy1saW5lLCB3ZSBpbnNlcnQKICAgICAgICogYSBmYWtlIGMtbGluZSB3aXRoIHRoZSBpcCBhZGRyZXNzIDAuMC4wLjAuIFRoaXMgaXMgdGhlbiB2YWxpZAogICAgICAgKiBzZHAgYW5kIG5vIG1lZGlhIHdpbGwgYmUgc2VudCBmb3IgdGhhdCBtLWxpbmUuCiAgICAgICAqCiAgICAgICAqIFZhbGlkIFNEUCBpczoKICAgICAgICogbT0KICAgICAgICogaT0KICAgICAgICogYz0KICAgICAgICovCiAgICAgIHZhciBpbnNlcnRBdCwgbWxpbmVzOwogICAgICBpZiAoc2RwLmluZGV4T2YoJ2M9JykgPiBzZHAuaW5kZXhPZignbT0nKSkgewoKICAgICAgICAvLyBGaW5kIGFsbCBtPSBsaW5lcwogICAgICAgIG1saW5lcyA9IHNkcC5tYXRjaCgvbT0uKlxyXG4uKi9nKTsKICAgICAgICBmb3IgKHZhciBpPTA7IGk8bWxpbmVzLmxlbmd0aDsgaSsrKSB7CgogICAgICAgICAgLy8gSWYgaXQgaGFzIGFuIGk9IGxpbmUsIGNoZWNrIGlmIHRoZSBuZXh0IGxpbmUgaXMgdGhlIGM9IGxpbmUKICAgICAgICAgIGlmIChtbGluZXNbaV0udG9TdHJpbmcoKS5zZWFyY2goL2k9LiovKSA+PSAwKSB7CiAgICAgICAgICAgIGluc2VydEF0ID0gc2RwLmluZGV4T2YobWxpbmVzW2ldLnRvU3RyaW5nKCkpK21saW5lc1tpXS50b1N0cmluZygpLmxlbmd0aDsKICAgICAgICAgICAgaWYgKHNkcC5zdWJzdHIoaW5zZXJ0QXQsMikhPT0nYz0nKSB7CiAgICAgICAgICAgICAgc2RwID0gc2RwLnN1YnN0cigwLGluc2VydEF0KSArICdcclxuYz1JTiBJUDQgMC4wLjAuMCcgKyBzZHAuc3Vic3RyKGluc2VydEF0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgIC8vIGVsc2UgYWRkIHRoZSBDIGxpbmUgaWYgaXQncyBtaXNzaW5nCiAgICAgICAgICB9IGVsc2UgaWYgKG1saW5lc1tpXS50b1N0cmluZygpLnNlYXJjaCgvYz0uKi8pIDwgMCkgewogICAgICAgICAgICBpbnNlcnRBdCA9IHNkcC5pbmRleE9mKG1saW5lc1tpXS50b1N0cmluZygpLm1hdGNoKC8uKi8pKSttbGluZXNbaV0udG9TdHJpbmcoKS5tYXRjaCgvLiovKS50b1N0cmluZygpLmxlbmd0aDsKICAgICAgICAgICAgc2RwID0gc2RwLnN1YnN0cigwLGluc2VydEF0KSArICdcclxuYz1JTiBJUDQgMC4wLjAuMCcgKyBzZHAuc3Vic3RyKGluc2VydEF0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHNkcDsKICAgIH0sCiAgfSwKCiAgQ2hyb21lOiB7CiAgICBuZWVkc0V4cGxpY2l0bHlJbmFjdGl2ZVNEUDogZnVuY3Rpb24gKHNkcCkgewogICAgICB2YXIgc3ViLCBpbmRleDsKCiAgICAgIGlmIChIYWNrcy5GaXJlZm94LmlzRmlyZWZveCgpKSB7IC8vIEZpeCB0aGlzIGluIEZpcmVmb3ggYmVmb3JlIHNlbmRpbmcKICAgICAgICBpbmRleCA9IHNkcC5pbmRleE9mKCdtPXZpZGVvIDAnKTsKICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgICAgICBzdWIgPSBzZHAuc3Vic3RyKGluZGV4KTsKICAgICAgICAgIHN1YiA9IHN1Yi5yZXBsYWNlKC9cclxuYz1JTiBJUDQuKlxyXG4kLywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdcclxuYz1JTiBJUDQgMC4wLjAuMFxyXG5hPWluYWN0aXZlXHJcbicpOwogICAgICAgICAgcmV0dXJuIHNkcC5zdWJzdHIoMCwgaW5kZXgpICsgc3ViOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gc2RwOwogICAgfSwKCiAgICBnZXRzQ29uZnVzZWRBYm91dEdVTTogZnVuY3Rpb24gKHNlc3Npb24pIHsKICAgICAgaWYgKHNlc3Npb24ubWVkaWFIYW5kbGVyKSB7CiAgICAgICAgc2Vzc2lvbi5tZWRpYUhhbmRsZXIuY2xvc2UoKTsKICAgICAgfQogICAgfQogIH0KfTsKcmV0dXJuIEhhY2tzOwp9Owp9LHt9XSwyMDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKdmFyIGxldmVscyA9IHsKICAnZXJyb3InOiAwLAogICd3YXJuJzogMSwKICAnbG9nJzogMiwKICAnZGVidWcnOiAzCn07Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChjb25zb2xlKSB7Cgp2YXIgTG9nZ2VyRmFjdG9yeSA9IGZ1bmN0aW9uICgpIHsKICB2YXIgbG9nZ2VyLAogICAgbGV2ZWwgPSAyLAogICAgYnVpbHRpbkVuYWJsZWQgPSB0cnVlLAogICAgY29ubmVjdG9yID0gbnVsbDsKCiAgICB0aGlzLmxvZ2dlcnMgPSB7fTsKCiAgICBsb2dnZXIgPSB0aGlzLmdldExvZ2dlcignc2lwLmxvZ2dlcmZhY3RvcnknKTsKCgogIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIHsKICAgIGJ1aWx0aW5FbmFibGVkOiB7CiAgICAgIGdldDogZnVuY3Rpb24oKXsgcmV0dXJuIGJ1aWx0aW5FbmFibGVkOyB9LAogICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKXsKICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHsKICAgICAgICAgIGJ1aWx0aW5FbmFibGVkID0gdmFsdWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGxvZ2dlci5lcnJvcignaW52YWxpZCAiYnVpbHRpbkVuYWJsZWQiIHBhcmFtZXRlciB2YWx1ZTogJysgSlNPTi5zdHJpbmdpZnkodmFsdWUpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgbGV2ZWw6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHtyZXR1cm4gbGV2ZWw7IH0sCiAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICBpZiAodmFsdWUgPj0gMCAmJiB2YWx1ZSA8PTMpIHsKICAgICAgICAgIGxldmVsID0gdmFsdWU7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+IDMpIHsKICAgICAgICAgIGxldmVsID0gMzsKICAgICAgICB9IGVsc2UgaWYgKGxldmVscy5oYXNPd25Qcm9wZXJ0eSh2YWx1ZSkpIHsKICAgICAgICAgIGxldmVsID0gbGV2ZWxzW3ZhbHVlXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbG9nZ2VyLmVycm9yKCdpbnZhbGlkICJsZXZlbCIgcGFyYW1ldGVyIHZhbHVlOiAnKyBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBjb25uZWN0b3I6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHtyZXR1cm4gY29ubmVjdG9yOyB9LAogICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKXsKICAgICAgICBpZih2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gIiIgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgY29ubmVjdG9yID0gbnVsbDsKICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgY29ubmVjdG9yID0gdmFsdWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGxvZ2dlci5lcnJvcignaW52YWxpZCAiY29ubmVjdG9yIiBwYXJhbWV0ZXIgdmFsdWU6ICcrIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7Cn07CgpMb2dnZXJGYWN0b3J5LnByb3RvdHlwZS5wcmludCA9IGZ1bmN0aW9uKHRhcmdldCwgY2F0ZWdvcnksIGxhYmVsLCBjb250ZW50KSB7CiAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykgewogICAgdmFyIHByZWZpeCA9IFtuZXcgRGF0ZSgpLCBjYXRlZ29yeV07CiAgICBpZiAobGFiZWwpIHsKICAgICAgcHJlZml4LnB1c2gobGFiZWwpOwogICAgfQogICAgY29udGVudCA9IHByZWZpeC5jb25jYXQoY29udGVudCkuam9pbignIHwgJyk7CiAgfQogIHRhcmdldC5jYWxsKGNvbnNvbGUsIGNvbnRlbnQpOwp9OwoKZnVuY3Rpb24gTG9nZ2VyIChsb2dnZXIsIGNhdGVnb3J5LCBsYWJlbCkgewogIHRoaXMubG9nZ2VyID0gbG9nZ2VyOwogIHRoaXMuY2F0ZWdvcnkgPSBjYXRlZ29yeTsKICB0aGlzLmxhYmVsID0gbGFiZWw7Cn0KCk9iamVjdC5rZXlzKGxldmVscykuZm9yRWFjaChmdW5jdGlvbiAodGFyZ2V0TmFtZSkgewogIExvZ2dlci5wcm90b3R5cGVbdGFyZ2V0TmFtZV0gPSBmdW5jdGlvbiAoY29udGVudCkgewogICAgdGhpcy5sb2dnZXJbdGFyZ2V0TmFtZV0odGhpcy5jYXRlZ29yeSwgdGhpcy5sYWJlbCwgY29udGVudCk7CiAgfTsKCiAgTG9nZ2VyRmFjdG9yeS5wcm90b3R5cGVbdGFyZ2V0TmFtZV0gPSBmdW5jdGlvbiAoY2F0ZWdvcnksIGxhYmVsLCBjb250ZW50KSB7CiAgICBpZiAodGhpcy5sZXZlbCA+PSBsZXZlbHNbdGFyZ2V0TmFtZV0pIHsKICAgICAgaWYgKHRoaXMuYnVpbHRpbkVuYWJsZWQpIHsKICAgICAgICB0aGlzLnByaW50KGNvbnNvbGVbdGFyZ2V0TmFtZV0sIGNhdGVnb3J5LCBsYWJlbCwgY29udGVudCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmNvbm5lY3RvcikgewogICAgICAgIHRoaXMuY29ubmVjdG9yKHRhcmdldE5hbWUsIGNhdGVnb3J5LCBsYWJlbCwgY29udGVudCk7CiAgICAgIH0KICAgIH0KICB9Owp9KTsKCkxvZ2dlckZhY3RvcnkucHJvdG90eXBlLmdldExvZ2dlciA9IGZ1bmN0aW9uKGNhdGVnb3J5LCBsYWJlbCkgewogIHZhciBsb2dnZXI7CgogIGlmIChsYWJlbCAmJiB0aGlzLmxldmVsID09PSAzKSB7CiAgICByZXR1cm4gbmV3IExvZ2dlcih0aGlzLCBjYXRlZ29yeSwgbGFiZWwpOwogIH0gZWxzZSBpZiAodGhpcy5sb2dnZXJzW2NhdGVnb3J5XSkgewogICAgcmV0dXJuIHRoaXMubG9nZ2Vyc1tjYXRlZ29yeV07CiAgfSBlbHNlIHsKICAgIGxvZ2dlciA9IG5ldyBMb2dnZXIodGhpcywgY2F0ZWdvcnkpOwogICAgdGhpcy5sb2dnZXJzW2NhdGVnb3J5XSA9IGxvZ2dlcjsKICAgIHJldHVybiBsb2dnZXI7CiAgfQp9OwoKcmV0dXJuIExvZ2dlckZhY3Rvcnk7Cn07Cgp9LHt9XSwyMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgTWVkaWFIYW5kbGVyCiAqLwoKLyogTWVkaWFIYW5kbGVyCiAqIEBjbGFzcyBQZWVyQ29ubmVjdGlvbiBoZWxwZXIgQ2xhc3MuCiAqIEBwYXJhbSB7U0lQLlNlc3Npb259IHNlc3Npb24KICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXQogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoRXZlbnRFbWl0dGVyKSB7CnZhciBNZWRpYUhhbmRsZXIgPSBmdW5jdGlvbihzZXNzaW9uLCBvcHRpb25zKSB7CiAgLy8ga2VlcCBqc2hpbnQgaGFwcHkKICBzZXNzaW9uID0gc2Vzc2lvbjsKICBvcHRpb25zID0gb3B0aW9uczsKfTsKCk1lZGlhSGFuZGxlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEV2ZW50RW1pdHRlci5wcm90b3R5cGUsIHsKICBpc1JlYWR5OiB7dmFsdWU6IGZ1bmN0aW9uIGlzUmVhZHkgKCkge319LAoKICBjbG9zZToge3ZhbHVlOiBmdW5jdGlvbiBjbG9zZSAoKSB7fX0sCgogIC8qKgogICAqIEBwYXJhbSB7T2JqZWN0fSBbbWVkaWFIaW50XSBBIGN1c3RvbSBvYmplY3QgZGVzY3JpYmluZyB0aGUgbWVkaWEgdG8gYmUgdXNlZCBkdXJpbmcgdGhpcyBzZXNzaW9uLgogICAqLwogIGdldERlc2NyaXB0aW9uOiB7dmFsdWU6IGZ1bmN0aW9uIGdldERlc2NyaXB0aW9uIChtZWRpYUhpbnQpIHsKICAgIC8vIGtlZXAganNoaW50IGhhcHB5CiAgICBtZWRpYUhpbnQgPSBtZWRpYUhpbnQ7CiAgfX0sCgogIC8qKgogICogTWVzc2FnZSByZWNlcHRpb24uCiAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZQogICogQHBhcmFtIHtTdHJpbmd9IGRlc2NyaXB0aW9uCiAgKi8KICBzZXREZXNjcmlwdGlvbjoge3ZhbHVlOiBmdW5jdGlvbiBzZXREZXNjcmlwdGlvbiAoZGVzY3JpcHRpb24pIHsKICAgIC8vIGtlZXAganNoaW50IGhhcHB5CiAgICBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uOwogIH19Cn0pOwoKcmV0dXJuIE1lZGlhSGFuZGxlcjsKfTsKCn0se31dLDIyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBTSVAgTmFtZUFkZHJIZWFkZXIKICovCgovKioKICogQGF1Z21lbnRzIFNJUAogKiBAY2xhc3MgQ2xhc3MgY3JlYXRpbmcgYSBOYW1lIEFkZHJlc3MgU0lQIGhlYWRlci4KICoKICogQHBhcmFtIHtTSVAuVVJJfSB1cmkKICogQHBhcmFtIHtTdHJpbmd9IFtkaXNwbGF5TmFtZV0KICogQHBhcmFtIHtPYmplY3R9IFtwYXJhbWV0ZXJzXQogKgogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CnZhciBOYW1lQWRkckhlYWRlcjsKCk5hbWVBZGRySGVhZGVyID0gZnVuY3Rpb24odXJpLCBkaXNwbGF5TmFtZSwgcGFyYW1ldGVycykgewogIHZhciBwYXJhbTsKCiAgLy8gQ2hlY2tzCiAgaWYoIXVyaSB8fCAhKHVyaSBpbnN0YW5jZW9mIFNJUC5VUkkpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdtaXNzaW5nIG9yIGludmFsaWQgInVyaSIgcGFyYW1ldGVyJyk7CiAgfQoKICAvLyBJbml0aWFsaXplIHBhcmFtZXRlcnMKICB0aGlzLnVyaSA9IHVyaTsKICB0aGlzLnBhcmFtZXRlcnMgPSB7fTsKCiAgZm9yIChwYXJhbSBpbiBwYXJhbWV0ZXJzKSB7CiAgICB0aGlzLnNldFBhcmFtKHBhcmFtLCBwYXJhbWV0ZXJzW3BhcmFtXSk7CiAgfQoKICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB7CiAgICBmcmllbmRseU5hbWU6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMuZGlzcGxheU5hbWUgfHwgdXJpLmFvcjsgfQogICAgfSwKCiAgICBkaXNwbGF5TmFtZTogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gZGlzcGxheU5hbWU7IH0sCiAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICBkaXNwbGF5TmFtZSA9ICh2YWx1ZSA9PT0gMCkgPyAnMCcgOiB2YWx1ZTsKICAgICAgfQogICAgfQogIH0pOwp9OwpOYW1lQWRkckhlYWRlci5wcm90b3R5cGUgPSB7CiAgc2V0UGFyYW06IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICBpZihrZXkpIHsKICAgICAgdGhpcy5wYXJhbWV0ZXJzW2tleS50b0xvd2VyQ2FzZSgpXSA9ICh0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnIHx8IHZhbHVlID09PSBudWxsKSA/IG51bGwgOiB2YWx1ZS50b1N0cmluZygpOwogICAgfQogIH0sCiAgZ2V0UGFyYW06IFNJUC5VUkkucHJvdG90eXBlLmdldFBhcmFtLAogIGhhc1BhcmFtOiBTSVAuVVJJLnByb3RvdHlwZS5oYXNQYXJhbSwKICBkZWxldGVQYXJhbTogU0lQLlVSSS5wcm90b3R5cGUuZGVsZXRlUGFyYW0sCiAgY2xlYXJQYXJhbXM6IFNJUC5VUkkucHJvdG90eXBlLmNsZWFyUGFyYW1zLAoKICBjbG9uZTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gbmV3IE5hbWVBZGRySGVhZGVyKAogICAgICB0aGlzLnVyaS5jbG9uZSgpLAogICAgICB0aGlzLmRpc3BsYXlOYW1lLAogICAgICBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMucGFyYW1ldGVycykpKTsKICB9LAoKICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICB2YXIgYm9keSwgcGFyYW1ldGVyOwoKICAgIGJvZHkgID0gKHRoaXMuZGlzcGxheU5hbWUgfHwgdGhpcy5kaXNwbGF5TmFtZSA9PT0gMCkgPyAnIicgKyB0aGlzLmRpc3BsYXlOYW1lICsgJyIgJyA6ICcnOwogICAgYm9keSArPSAnPCcgKyB0aGlzLnVyaS50b1N0cmluZygpICsgJz4nOwoKICAgIGZvciAocGFyYW1ldGVyIGluIHRoaXMucGFyYW1ldGVycykgewogICAgICBib2R5ICs9ICc7JyArIHBhcmFtZXRlcjsKCiAgICAgIGlmICh0aGlzLnBhcmFtZXRlcnNbcGFyYW1ldGVyXSAhPT0gbnVsbCkgewogICAgICAgIGJvZHkgKz0gJz0nKyB0aGlzLnBhcmFtZXRlcnNbcGFyYW1ldGVyXTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBib2R5OwogIH0KfTsKCgovKioKICAqIFBhcnNlIHRoZSBnaXZlbiBzdHJpbmcgYW5kIHJldHVybnMgYSBTSVAuTmFtZUFkZHJIZWFkZXIgaW5zdGFuY2Ugb3IgdW5kZWZpbmVkIGlmCiAgKiBpdCBpcyBhbiBpbnZhbGlkIE5hbWVBZGRySGVhZGVyLgogICogQHB1YmxpYwogICogQHBhcmFtIHtTdHJpbmd9IG5hbWVfYWRkcl9oZWFkZXIKICAqLwpOYW1lQWRkckhlYWRlci5wYXJzZSA9IGZ1bmN0aW9uKG5hbWVfYWRkcl9oZWFkZXIpIHsKICBuYW1lX2FkZHJfaGVhZGVyID0gU0lQLkdyYW1tYXIucGFyc2UobmFtZV9hZGRyX2hlYWRlciwnTmFtZV9BZGRyX0hlYWRlcicpOwoKICBpZiAobmFtZV9hZGRyX2hlYWRlciAhPT0gLTEpIHsKICAgIHJldHVybiBuYW1lX2FkZHJfaGVhZGVyOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KfTsKClNJUC5OYW1lQWRkckhlYWRlciA9IE5hbWVBZGRySGVhZGVyOwp9OwoKfSx7fV0sMjM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IFNJUCBNZXNzYWdlIFBhcnNlcgogKi8KCi8qKgogKiBFeHRyYWN0IGFuZCBwYXJzZSBldmVyeSBoZWFkZXIgb2YgYSBTSVAgbWVzc2FnZS4KICogQGF1Z21lbnRzIFNJUAogKiBAbmFtZXNwYWNlCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyIFBhcnNlcjsKCmZ1bmN0aW9uIGdldEhlYWRlcihkYXRhLCBoZWFkZXJTdGFydCkgewogIHZhcgogICAgLy8gJ3N0YXJ0JyBwb3NpdGlvbiBvZiB0aGUgaGVhZGVyLgogICAgc3RhcnQgPSBoZWFkZXJTdGFydCwKICAgIC8vICdlbmQnIHBvc2l0aW9uIG9mIHRoZSBoZWFkZXIuCiAgICBlbmQgPSAwLAogICAgLy8gJ3BhcnRpYWwgZW5kJyBwb3NpdGlvbiBvZiB0aGUgaGVhZGVyLgogICAgcGFydGlhbEVuZCA9IDA7CgogIC8vRW5kIG9mIG1lc3NhZ2UuCiAgaWYgKGRhdGEuc3Vic3RyaW5nKHN0YXJ0LCBzdGFydCArIDIpLm1hdGNoKC8oXlxyXG4pLykpIHsKICAgIHJldHVybiAtMjsKICB9CgogIHdoaWxlKGVuZCA9PT0gMCkgewogICAgLy8gUGFydGlhbCBFbmQgb2YgSGVhZGVyLgogICAgcGFydGlhbEVuZCA9IGRhdGEuaW5kZXhPZignXHJcbicsIHN0YXJ0KTsKCiAgICAvLyAnaW5kZXhPZicgcmV0dXJucyAtMSBpZiB0aGUgdmFsdWUgdG8gYmUgZm91bmQgbmV2ZXIgb2NjdXJzLgogICAgaWYgKHBhcnRpYWxFbmQgPT09IC0xKSB7CiAgICAgIHJldHVybiBwYXJ0aWFsRW5kOwogICAgfQoKICAgIGlmKCFkYXRhLnN1YnN0cmluZyhwYXJ0aWFsRW5kICsgMiwgcGFydGlhbEVuZCArIDQpLm1hdGNoKC8oXlxyXG4pLykgJiYgZGF0YS5jaGFyQXQocGFydGlhbEVuZCArIDIpLm1hdGNoKC8oXlxzKykvKSkgewogICAgICAvLyBOb3QgdGhlIGVuZCBvZiB0aGUgbWVzc2FnZS4gQ29udGludWUgZnJvbSB0aGUgbmV4dCBwb3NpdGlvbi4KICAgICAgc3RhcnQgPSBwYXJ0aWFsRW5kICsgMjsKICAgIH0gZWxzZSB7CiAgICAgIGVuZCA9IHBhcnRpYWxFbmQ7CiAgICB9CiAgfQoKICByZXR1cm4gZW5kOwp9CgpmdW5jdGlvbiBwYXJzZUhlYWRlcihtZXNzYWdlLCBkYXRhLCBoZWFkZXJTdGFydCwgaGVhZGVyRW5kKSB7CiAgdmFyIGhlYWRlciwgaWR4LCBsZW5ndGgsIHBhcnNlZCwKICAgIGhjb2xvbkluZGV4ID0gZGF0YS5pbmRleE9mKCc6JywgaGVhZGVyU3RhcnQpLAogICAgaGVhZGVyTmFtZSA9IGRhdGEuc3Vic3RyaW5nKGhlYWRlclN0YXJ0LCBoY29sb25JbmRleCkudHJpbSgpLAogICAgaGVhZGVyVmFsdWUgPSBkYXRhLnN1YnN0cmluZyhoY29sb25JbmRleCArIDEsIGhlYWRlckVuZCkudHJpbSgpOwoKICAvLyBJZiBoZWFkZXItZmllbGQgaXMgd2VsbC1rbm93biwgcGFyc2UgaXQuCiAgc3dpdGNoKGhlYWRlck5hbWUudG9Mb3dlckNhc2UoKSkgewogICAgY2FzZSAndmlhJzoKICAgIGNhc2UgJ3YnOgogICAgICBtZXNzYWdlLmFkZEhlYWRlcigndmlhJywgaGVhZGVyVmFsdWUpOwogICAgICBpZihtZXNzYWdlLmdldEhlYWRlcnMoJ3ZpYScpLmxlbmd0aCA9PT0gMSkgewogICAgICAgIHBhcnNlZCA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ1ZpYScpOwogICAgICAgIGlmKHBhcnNlZCkgewogICAgICAgICAgbWVzc2FnZS52aWEgPSBwYXJzZWQ7CiAgICAgICAgICBtZXNzYWdlLnZpYV9icmFuY2ggPSBwYXJzZWQuYnJhbmNoOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBwYXJzZWQgPSAwOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSAnZnJvbSc6CiAgICBjYXNlICdmJzoKICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoJ2Zyb20nLCBoZWFkZXJWYWx1ZSk7CiAgICAgIHBhcnNlZCA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ2Zyb20nKTsKICAgICAgaWYocGFyc2VkKSB7CiAgICAgICAgbWVzc2FnZS5mcm9tID0gcGFyc2VkOwogICAgICAgIG1lc3NhZ2UuZnJvbV90YWcgPSBwYXJzZWQuZ2V0UGFyYW0oJ3RhZycpOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSAndG8nOgogICAgY2FzZSAndCc6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCd0bycsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcigndG8nKTsKICAgICAgaWYocGFyc2VkKSB7CiAgICAgICAgbWVzc2FnZS50byA9IHBhcnNlZDsKICAgICAgICBtZXNzYWdlLnRvX3RhZyA9IHBhcnNlZC5nZXRQYXJhbSgndGFnJyk7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlICdyZWNvcmQtcm91dGUnOgogICAgICBwYXJzZWQgPSBTSVAuR3JhbW1hci5wYXJzZShoZWFkZXJWYWx1ZSwgJ1JlY29yZF9Sb3V0ZScpOwoKICAgICAgaWYgKHBhcnNlZCA9PT0gLTEpIHsKICAgICAgICBwYXJzZWQgPSB1bmRlZmluZWQ7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGxlbmd0aCA9IHBhcnNlZC5sZW5ndGg7CiAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICAgIGhlYWRlciA9IHBhcnNlZFtpZHhdOwogICAgICAgIG1lc3NhZ2UuYWRkSGVhZGVyKCdyZWNvcmQtcm91dGUnLCBoZWFkZXJWYWx1ZS5zdWJzdHJpbmcoaGVhZGVyLnBvc2l0aW9uLCBoZWFkZXIub2Zmc2V0KSk7CiAgICAgICAgbWVzc2FnZS5oZWFkZXJzWydSZWNvcmQtUm91dGUnXVttZXNzYWdlLmdldEhlYWRlcnMoJ3JlY29yZC1yb3V0ZScpLmxlbmd0aCAtIDFdLnBhcnNlZCA9IGhlYWRlci5wYXJzZWQ7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlICdjYWxsLWlkJzoKICAgIGNhc2UgJ2knOgogICAgICBtZXNzYWdlLnNldEhlYWRlcignY2FsbC1pZCcsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcignY2FsbC1pZCcpOwogICAgICBpZihwYXJzZWQpIHsKICAgICAgICBtZXNzYWdlLmNhbGxfaWQgPSBoZWFkZXJWYWx1ZTsKICAgICAgfQogICAgICBicmVhazsKICAgIGNhc2UgJ2NvbnRhY3QnOgogICAgY2FzZSAnbSc6CiAgICAgIHBhcnNlZCA9IFNJUC5HcmFtbWFyLnBhcnNlKGhlYWRlclZhbHVlLCAnQ29udGFjdCcpOwoKICAgICAgaWYgKHBhcnNlZCA9PT0gLTEpIHsKICAgICAgICBwYXJzZWQgPSB1bmRlZmluZWQ7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGxlbmd0aCA9IHBhcnNlZC5sZW5ndGg7CiAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICAgIGhlYWRlciA9IHBhcnNlZFtpZHhdOwogICAgICAgIG1lc3NhZ2UuYWRkSGVhZGVyKCdjb250YWN0JywgaGVhZGVyVmFsdWUuc3Vic3RyaW5nKGhlYWRlci5wb3NpdGlvbiwgaGVhZGVyLm9mZnNldCkpOwogICAgICAgIG1lc3NhZ2UuaGVhZGVyc1snQ29udGFjdCddW21lc3NhZ2UuZ2V0SGVhZGVycygnY29udGFjdCcpLmxlbmd0aCAtIDFdLnBhcnNlZCA9IGhlYWRlci5wYXJzZWQ7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlICdjb250ZW50LWxlbmd0aCc6CiAgICBjYXNlICdsJzoKICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoJ2NvbnRlbnQtbGVuZ3RoJywgaGVhZGVyVmFsdWUpOwogICAgICBwYXJzZWQgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCdjb250ZW50LWxlbmd0aCcpOwogICAgICBicmVhazsKICAgIGNhc2UgJ2NvbnRlbnQtdHlwZSc6CiAgICBjYXNlICdjJzoKICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoJ2NvbnRlbnQtdHlwZScsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcignY29udGVudC10eXBlJyk7CiAgICAgIGJyZWFrOwogICAgY2FzZSAnY3NlcSc6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCdjc2VxJywgaGVhZGVyVmFsdWUpOwogICAgICBwYXJzZWQgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCdjc2VxJyk7CiAgICAgIGlmKHBhcnNlZCkgewogICAgICAgIG1lc3NhZ2UuY3NlcSA9IHBhcnNlZC52YWx1ZTsKICAgICAgfQogICAgICBpZihtZXNzYWdlIGluc3RhbmNlb2YgU0lQLkluY29taW5nUmVzcG9uc2UpIHsKICAgICAgICBtZXNzYWdlLm1ldGhvZCA9IHBhcnNlZC5tZXRob2Q7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlICdtYXgtZm9yd2FyZHMnOgogICAgICBtZXNzYWdlLnNldEhlYWRlcignbWF4LWZvcndhcmRzJywgaGVhZGVyVmFsdWUpOwogICAgICBwYXJzZWQgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCdtYXgtZm9yd2FyZHMnKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICd3d3ctYXV0aGVudGljYXRlJzoKICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoJ3d3dy1hdXRoZW50aWNhdGUnLCBoZWFkZXJWYWx1ZSk7CiAgICAgIHBhcnNlZCA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ3d3dy1hdXRoZW50aWNhdGUnKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdwcm94eS1hdXRoZW50aWNhdGUnOgogICAgICBtZXNzYWdlLnNldEhlYWRlcigncHJveHktYXV0aGVudGljYXRlJywgaGVhZGVyVmFsdWUpOwogICAgICBwYXJzZWQgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCdwcm94eS1hdXRoZW50aWNhdGUnKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdyZWZlci10byc6CiAgICBjYXNlICdyJzoKICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoJ3JlZmVyLXRvJywgaGVhZGVyVmFsdWUpOwogICAgICBwYXJzZWQgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCdyZWZlci10bycpOwogICAgICBpZiAocGFyc2VkKSB7CiAgICAgICAgbWVzc2FnZS5yZWZlcl90byA9IHBhcnNlZDsKICAgICAgfQogICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgIC8vIERvIG5vdCBwYXJzZSB0aGlzIGhlYWRlci4KICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoaGVhZGVyTmFtZSwgaGVhZGVyVmFsdWUpOwogICAgICBwYXJzZWQgPSAwOwogIH0KCiAgaWYgKHBhcnNlZCA9PT0gdW5kZWZpbmVkKSB7CiAgICByZXR1cm4gewogICAgICBlcnJvcjogJ2Vycm9yIHBhcnNpbmcgaGVhZGVyICInKyBoZWFkZXJOYW1lICsnIicKICAgIH07CiAgfSBlbHNlIHsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKLyoqIFBhcnNlIFNJUCBNZXNzYWdlCiAqIEBmdW5jdGlvbgogKiBAcGFyYW0ge1N0cmluZ30gbWVzc2FnZSBTSVAgbWVzc2FnZS4KICogQHBhcmFtIHtPYmplY3R9IGxvZ2dlciBvYmplY3QuCiAqIEByZXR1cm5zIHtTSVAuSW5jb21pbmdSZXF1ZXN0fFNJUC5JbmNvbWluZ1Jlc3BvbnNlfHVuZGVmaW5lZH0KICovClBhcnNlciA9IHt9OwpQYXJzZXIucGFyc2VNZXNzYWdlID0gZnVuY3Rpb24oZGF0YSwgdWEpIHsKICB2YXIgbWVzc2FnZSwgZmlyc3RMaW5lLCBjb250ZW50TGVuZ3RoLCBib2R5U3RhcnQsIHBhcnNlZCwKICAgIGhlYWRlclN0YXJ0ID0gMCwKICAgIGhlYWRlckVuZCA9IGRhdGEuaW5kZXhPZignXHJcbicpLAogICAgbG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAucGFyc2VyJyk7CgogIGlmKGhlYWRlckVuZCA9PT0gLTEpIHsKICAgIGxvZ2dlci53YXJuKCdubyBDUkxGIGZvdW5kLCBub3QgYSBTSVAgbWVzc2FnZSwgZGlzY2FyZGVkJyk7CiAgICByZXR1cm47CiAgfQoKICAvLyBQYXJzZSBmaXJzdCBsaW5lLiBDaGVjayBpZiBpdCBpcyBhIFJlcXVlc3Qgb3IgYSBSZXBseS4KICBmaXJzdExpbmUgPSBkYXRhLnN1YnN0cmluZygwLCBoZWFkZXJFbmQpOwogIHBhcnNlZCA9IFNJUC5HcmFtbWFyLnBhcnNlKGZpcnN0TGluZSwgJ1JlcXVlc3RfUmVzcG9uc2UnKTsKCiAgaWYocGFyc2VkID09PSAtMSkgewogICAgbG9nZ2VyLndhcm4oJ2Vycm9yIHBhcnNpbmcgZmlyc3QgbGluZSBvZiBTSVAgbWVzc2FnZTogIicgKyBmaXJzdExpbmUgKyAnIicpOwogICAgcmV0dXJuOwogIH0gZWxzZSBpZighcGFyc2VkLnN0YXR1c19jb2RlKSB7CiAgICBtZXNzYWdlID0gbmV3IFNJUC5JbmNvbWluZ1JlcXVlc3QodWEpOwogICAgbWVzc2FnZS5tZXRob2QgPSBwYXJzZWQubWV0aG9kOwogICAgbWVzc2FnZS5ydXJpID0gcGFyc2VkLnVyaTsKICB9IGVsc2UgewogICAgbWVzc2FnZSA9IG5ldyBTSVAuSW5jb21pbmdSZXNwb25zZSh1YSk7CiAgICBtZXNzYWdlLnN0YXR1c19jb2RlID0gcGFyc2VkLnN0YXR1c19jb2RlOwogICAgbWVzc2FnZS5yZWFzb25fcGhyYXNlID0gcGFyc2VkLnJlYXNvbl9waHJhc2U7CiAgfQoKICBtZXNzYWdlLmRhdGEgPSBkYXRhOwogIGhlYWRlclN0YXJ0ID0gaGVhZGVyRW5kICsgMjsKCiAgLyogTG9vcCBvdmVyIGV2ZXJ5IGxpbmUgaW4gZGF0YS4gRGV0ZWN0IHRoZSBlbmQgb2YgZWFjaCBoZWFkZXIgYW5kIHBhcnNlCiAgKiBpdCBvciBzaW1wbHkgYWRkIHRvIHRoZSBoZWFkZXJzIGNvbGxlY3Rpb24uCiAgKi8KICB3aGlsZSh0cnVlKSB7CiAgICBoZWFkZXJFbmQgPSBnZXRIZWFkZXIoZGF0YSwgaGVhZGVyU3RhcnQpOwoKICAgIC8vIFRoZSBTSVAgbWVzc2FnZSBoYXMgbm9ybWFsbHkgZmluaXNoZWQuCiAgICBpZihoZWFkZXJFbmQgPT09IC0yKSB7CiAgICAgIGJvZHlTdGFydCA9IGhlYWRlclN0YXJ0ICsgMjsKICAgICAgYnJlYWs7CiAgICB9CiAgICAvLyBkYXRhLmluZGV4T2YgcmV0dXJuZWQgLTEgZHVlIHRvIGEgbWFsZm9ybWVkIG1lc3NhZ2UuCiAgICBlbHNlIGlmKGhlYWRlckVuZCA9PT0gLTEpIHsKICAgICAgbG9nZ2VyLmVycm9yKCdtYWxmb3JtZWQgbWVzc2FnZScpOwogICAgICByZXR1cm47CiAgICB9CgogICAgcGFyc2VkID0gcGFyc2VIZWFkZXIobWVzc2FnZSwgZGF0YSwgaGVhZGVyU3RhcnQsIGhlYWRlckVuZCk7CgogICAgaWYocGFyc2VkICE9PSB0cnVlKSB7CiAgICAgIGxvZ2dlci5lcnJvcihwYXJzZWQuZXJyb3IpOwogICAgICByZXR1cm47CiAgICB9CgogICAgaGVhZGVyU3RhcnQgPSBoZWFkZXJFbmQgKyAyOwogIH0KCiAgLyogUkZDMzI2MSAxOC4zLgogICAqIElmIHRoZXJlIGFyZSBhZGRpdGlvbmFsIGJ5dGVzIGluIHRoZSB0cmFuc3BvcnQgcGFja2V0CiAgICogYmV5b25kIHRoZSBlbmQgb2YgdGhlIGJvZHksIHRoZXkgTVVTVCBiZSBkaXNjYXJkZWQuCiAgICovCiAgaWYobWVzc2FnZS5oYXNIZWFkZXIoJ2NvbnRlbnQtbGVuZ3RoJykpIHsKICAgIGNvbnRlbnRMZW5ndGggPSBtZXNzYWdlLmdldEhlYWRlcignY29udGVudC1sZW5ndGgnKTsKICAgIG1lc3NhZ2UuYm9keSA9IGRhdGEuc3Vic3RyKGJvZHlTdGFydCwgY29udGVudExlbmd0aCk7CiAgfSBlbHNlIHsKICAgIG1lc3NhZ2UuYm9keSA9IGRhdGEuc3Vic3RyaW5nKGJvZHlTdGFydCk7CiAgfQoKICByZXR1cm4gbWVzc2FnZTsKfTsKClNJUC5QYXJzZXIgPSBQYXJzZXI7Cn07Cgp9LHt9XSwyNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7Cgp2YXIgUmVnaXN0ZXJDb250ZXh0OwoKUmVnaXN0ZXJDb250ZXh0ID0gZnVuY3Rpb24gKHVhKSB7CiAgdmFyIHBhcmFtcyA9IHt9LAogICAgICByZWdJZCA9IDE7CgogIHRoaXMucmVnaXN0cmFyID0gdWEuY29uZmlndXJhdGlvbi5yZWdpc3RyYXJTZXJ2ZXI7CiAgdGhpcy5leHBpcmVzID0gdWEuY29uZmlndXJhdGlvbi5yZWdpc3RlckV4cGlyZXM7CgoKICAvLyBDb250YWN0IGhlYWRlcgogIHRoaXMuY29udGFjdCA9IHVhLmNvbnRhY3QudG9TdHJpbmcoKTsKCiAgaWYocmVnSWQpIHsKICAgIHRoaXMuY29udGFjdCArPSAnO3JlZy1pZD0nKyByZWdJZDsKICAgIHRoaXMuY29udGFjdCArPSAnOytzaXAuaW5zdGFuY2U9Ijx1cm46dXVpZDonKyB1YS5jb25maWd1cmF0aW9uLmluc3RhbmNlSWQrJz4iJzsKICB9CgogIC8vIENhbGwtSUQgYW5kIENTZXEgdmFsdWVzIFJGQzMyNjEgMTAuMgogIHRoaXMuY2FsbF9pZCA9IFNJUC5VdGlscy5jcmVhdGVSYW5kb21Ub2tlbigyMik7CiAgdGhpcy5jc2VxID0gODA7CgogIHRoaXMudG9fdXJpID0gdWEuY29uZmlndXJhdGlvbi51cmk7CgogIHBhcmFtcy50b191cmkgPSB0aGlzLnRvX3VyaTsKICBwYXJhbXMudG9fZGlzcGxheU5hbWUgPSB1YS5jb25maWd1cmF0aW9uLmRpc3BsYXlOYW1lOwogIHBhcmFtcy5jYWxsX2lkID0gdGhpcy5jYWxsX2lkOwogIHBhcmFtcy5jc2VxID0gdGhpcy5jc2VxOwoKICAvLyBFeHRlbmRzIENsaWVudENvbnRleHQKICBTSVAuVXRpbHMuYXVnbWVudCh0aGlzLCBTSVAuQ2xpZW50Q29udGV4dCwgW3VhLCAnUkVHSVNURVInLCB0aGlzLnJlZ2lzdHJhciwge3BhcmFtczogcGFyYW1zfV0pOwoKICB0aGlzLnJlZ2lzdHJhdGlvblRpbWVyID0gbnVsbDsKICB0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lciA9IG51bGw7CgogIC8vIFNldCBzdGF0dXMKICB0aGlzLnJlZ2lzdGVyZWQgPSBmYWxzZTsKCiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC5yZWdpc3RlcmNvbnRleHQnKTsKfTsKClJlZ2lzdGVyQ29udGV4dC5wcm90b3R5cGUgPSB7CiAgcmVnaXN0ZXI6IGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsIGV4dHJhSGVhZGVyczsKCiAgICAvLyBIYW5kbGUgT3B0aW9ucwogICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgIGV4dHJhSGVhZGVycyA9ICh0aGlzLm9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpOwogICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcgKyB0aGlzLmNvbnRhY3QgKyAnO2V4cGlyZXM9JyArIHRoaXMuZXhwaXJlcyk7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnQWxsb3c6ICcgKyBTSVAuVUEuQy5BTExPV0VEX01FVEhPRFMudG9TdHJpbmcoKSk7CgogICAgLy8gU2F2ZSBvcmlnaW5hbCBleHRyYUhlYWRlcnMgdG8gYmUgdXNlZCBpbiAuY2xvc2UKICAgIHRoaXMuY2xvc2VIZWFkZXJzID0gdGhpcy5vcHRpb25zLmNsb3NlV2l0aEhlYWRlcnMgPwogICAgICAodGhpcy5vcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKSA6IFtdOwoKICAgIHRoaXMucmVjZWl2ZVJlc3BvbnNlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgdmFyIGNvbnRhY3QsIGV4cGlyZXMsCiAgICAgICAgY29udGFjdHMgPSByZXNwb25zZS5nZXRIZWFkZXJzKCdjb250YWN0JykubGVuZ3RoLAogICAgICAgIGNhdXNlOwoKICAgICAgLy8gRGlzY2FyZCByZXNwb25zZXMgdG8gb2xkZXIgUkVHSVNURVIvdW4tUkVHSVNURVIgcmVxdWVzdHMuCiAgICAgIGlmKHJlc3BvbnNlLmNzZXEgIT09IHRoaXMuY3NlcSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8gQ2xlYXIgcmVnaXN0cmF0aW9uIHRpbWVyCiAgICAgIGlmICh0aGlzLnJlZ2lzdHJhdGlvblRpbWVyICE9PSBudWxsKSB7CiAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5yZWdpc3RyYXRpb25UaW1lcik7CiAgICAgICAgdGhpcy5yZWdpc3RyYXRpb25UaW1lciA9IG51bGw7CiAgICAgIH0KCiAgICAgIHN3aXRjaCh0cnVlKSB7CiAgICAgICAgY2FzZSAvXjFbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgICAgdGhpcy5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgL14yWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgICAgIHRoaXMuZW1pdCgnYWNjZXB0ZWQnLCByZXNwb25zZSk7CgogICAgICAgICAgaWYocmVzcG9uc2UuaGFzSGVhZGVyKCdleHBpcmVzJykpIHsKICAgICAgICAgICAgZXhwaXJlcyA9IHJlc3BvbnNlLmdldEhlYWRlcignZXhwaXJlcycpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lciAhPT0gbnVsbCkgewogICAgICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lcik7CiAgICAgICAgICAgIHRoaXMucmVnaXN0cmF0aW9uRXhwaXJlZFRpbWVyID0gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBTZWFyY2ggdGhlIENvbnRhY3QgcG9pbnRpbmcgdG8gdXMgYW5kIHVwZGF0ZSB0aGUgZXhwaXJlcyB2YWx1ZSBhY2NvcmRpbmdseS4KICAgICAgICAgIGlmICghY29udGFjdHMpIHsKICAgICAgICAgICAgdGhpcy5sb2dnZXIud2Fybignbm8gQ29udGFjdCBoZWFkZXIgaW4gcmVzcG9uc2UgdG8gUkVHSVNURVIsIHJlc3BvbnNlIGlnbm9yZWQnKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgd2hpbGUoY29udGFjdHMtLSkgewogICAgICAgICAgICBjb250YWN0ID0gcmVzcG9uc2UucGFyc2VIZWFkZXIoJ2NvbnRhY3QnLCBjb250YWN0cyk7CiAgICAgICAgICAgIGlmKGNvbnRhY3QudXJpLnVzZXIgPT09IHRoaXMudWEuY29udGFjdC51cmkudXNlcikgewogICAgICAgICAgICAgIGV4cGlyZXMgPSBjb250YWN0LmdldFBhcmFtKCdleHBpcmVzJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29udGFjdCA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWNvbnRhY3QpIHsKICAgICAgICAgICAgdGhpcy5sb2dnZXIud2Fybignbm8gQ29udGFjdCBoZWFkZXIgcG9pbnRpbmcgdG8gdXMsIHJlc3BvbnNlIGlnbm9yZWQnKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgaWYoIWV4cGlyZXMpIHsKICAgICAgICAgICAgZXhwaXJlcyA9IHRoaXMuZXhwaXJlczsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBSZS1SZWdpc3RlciBiZWZvcmUgdGhlIGV4cGlyYXRpb24gaW50ZXJ2YWwgaGFzIGVsYXBzZWQuCiAgICAgICAgICAvLyBGb3IgdGhhdCwgZGVjcmVhc2UgdGhlIGV4cGlyZXMgdmFsdWUuIGllOiAzIHNlY29uZHMKICAgICAgICAgIHRoaXMucmVnaXN0cmF0aW9uVGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHNlbGYucmVnaXN0cmF0aW9uVGltZXIgPSBudWxsOwogICAgICAgICAgICBzZWxmLnJlZ2lzdGVyKHNlbGYub3B0aW9ucyk7CiAgICAgICAgICB9LCAoZXhwaXJlcyAqIDEwMDApIC0gMzAwMCk7CiAgICAgICAgICB0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lciA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHNlbGYubG9nZ2VyLndhcm4oJ3JlZ2lzdHJhdGlvbiBleHBpcmVkJyk7CiAgICAgICAgICAgIGlmIChzZWxmLnJlZ2lzdGVyZWQpIHsKICAgICAgICAgICAgICBzZWxmLnVucmVnaXN0ZXJlZChudWxsLCBTSVAuQy5jYXVzZXMuRVhQSVJFUyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIGV4cGlyZXMgKiAxMDAwKTsKCiAgICAgICAgICAvL1NhdmUgZ3J1dSB2YWx1ZXMKICAgICAgICAgIGlmIChjb250YWN0Lmhhc1BhcmFtKCd0ZW1wLWdydXUnKSkgewogICAgICAgICAgICB0aGlzLnVhLmNvbnRhY3QudGVtcF9ncnV1ID0gU0lQLlVSSS5wYXJzZShjb250YWN0LmdldFBhcmFtKCd0ZW1wLWdydXUnKS5yZXBsYWNlKC8iL2csJycpKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChjb250YWN0Lmhhc1BhcmFtKCdwdWItZ3J1dScpKSB7CiAgICAgICAgICAgIHRoaXMudWEuY29udGFjdC5wdWJfZ3J1dSA9IFNJUC5VUkkucGFyc2UoY29udGFjdC5nZXRQYXJhbSgncHViLWdydXUnKS5yZXBsYWNlKC8iL2csJycpKTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnJlZ2lzdGVyZWQgPSB0cnVlOwogICAgICAgICAgdGhpcy5lbWl0KCdyZWdpc3RlcmVkJywgcmVzcG9uc2UgfHwgbnVsbCk7CiAgICAgICAgICBicmVhazsKICAgICAgICAvLyBJbnRlcnZhbCB0b28gYnJpZWYgUkZDMzI2MSAxMC4yLjgKICAgICAgICBjYXNlIC9eNDIzJC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgICBpZihyZXNwb25zZS5oYXNIZWFkZXIoJ21pbi1leHBpcmVzJykpIHsKICAgICAgICAgICAgLy8gSW5jcmVhc2Ugb3VyIHJlZ2lzdHJhdGlvbiBpbnRlcnZhbCB0byB0aGUgc3VnZ2VzdGVkIG1pbmltdW0KICAgICAgICAgICAgdGhpcy5leHBpcmVzID0gcmVzcG9uc2UuZ2V0SGVhZGVyKCdtaW4tZXhwaXJlcycpOwogICAgICAgICAgICAvLyBBdHRlbXB0IHRoZSByZWdpc3RyYXRpb24gYWdhaW4gaW1tZWRpYXRlbHkKICAgICAgICAgICAgdGhpcy5yZWdpc3Rlcih0aGlzLm9wdGlvbnMpOwogICAgICAgICAgfSBlbHNlIHsgLy9UaGlzIHJlc3BvbnNlIE1VU1QgY29udGFpbiBhIE1pbi1FeHBpcmVzIGhlYWRlciBmaWVsZAogICAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCc0MjMgcmVzcG9uc2UgcmVjZWl2ZWQgZm9yIFJFR0lTVEVSIHdpdGhvdXQgTWluLUV4cGlyZXMnKTsKICAgICAgICAgICAgdGhpcy5yZWdpc3RyYXRpb25GYWlsdXJlKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuU0lQX0ZBSUxVUkVfQ09ERSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgY2F1c2UgPSBTSVAuVXRpbHMuc2lwRXJyb3JDYXVzZShyZXNwb25zZS5zdGF0dXNfY29kZSk7CiAgICAgICAgICB0aGlzLnJlZ2lzdHJhdGlvbkZhaWx1cmUocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgfQogICAgfTsKCiAgICB0aGlzLm9uUmVxdWVzdFRpbWVvdXQgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5yZWdpc3RyYXRpb25GYWlsdXJlKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfTsKCiAgICB0aGlzLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5yZWdpc3RyYXRpb25GYWlsdXJlKG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgIH07CgogICAgdGhpcy5jc2VxKys7CiAgICB0aGlzLnJlcXVlc3QuY3NlcSA9IHRoaXMuY3NlcTsKICAgIHRoaXMucmVxdWVzdC5zZXRIZWFkZXIoJ2NzZXEnLCB0aGlzLmNzZXEgKyAnIFJFR0lTVEVSJyk7CiAgICB0aGlzLnJlcXVlc3QuZXh0cmFIZWFkZXJzID0gZXh0cmFIZWFkZXJzOwogICAgdGhpcy5zZW5kKCk7CiAgfSwKCiAgcmVnaXN0cmF0aW9uRmFpbHVyZTogZnVuY3Rpb24gKHJlc3BvbnNlLCBjYXVzZSkgewogICAgdGhpcy5lbWl0KCdmYWlsZWQnLCByZXNwb25zZSB8fCBudWxsLCBjYXVzZSB8fCBudWxsKTsKICB9LAoKICBvblRyYW5zcG9ydENsb3NlZDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLnJlZ2lzdGVyZWRfYmVmb3JlID0gdGhpcy5yZWdpc3RlcmVkOwogICAgaWYgKHRoaXMucmVnaXN0cmF0aW9uVGltZXIgIT09IG51bGwpIHsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5yZWdpc3RyYXRpb25UaW1lcik7CiAgICAgIHRoaXMucmVnaXN0cmF0aW9uVGltZXIgPSBudWxsOwogICAgfQoKICAgIGlmICh0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lciAhPT0gbnVsbCkgewogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lcik7CiAgICAgIHRoaXMucmVnaXN0cmF0aW9uRXhwaXJlZFRpbWVyID0gbnVsbDsKICAgIH0KCiAgICBpZih0aGlzLnJlZ2lzdGVyZWQpIHsKICAgICAgdGhpcy51bnJlZ2lzdGVyZWQobnVsbCwgU0lQLkMuY2F1c2VzLkNPTk5FQ1RJT05fRVJST1IpOwogICAgfQogIH0sCgogIG9uVHJhbnNwb3J0Q29ubmVjdGVkOiBmdW5jdGlvbigpIHsKICAgIHRoaXMucmVnaXN0ZXIodGhpcy5vcHRpb25zKTsKICB9LAoKICBjbG9zZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgb3B0aW9ucyA9IHsKICAgICAgYWxsOiBmYWxzZSwKICAgICAgZXh0cmFIZWFkZXJzOiB0aGlzLmNsb3NlSGVhZGVycwogICAgfTsKCiAgICB0aGlzLnJlZ2lzdGVyZWRfYmVmb3JlID0gdGhpcy5yZWdpc3RlcmVkOwogICAgdGhpcy51bnJlZ2lzdGVyKG9wdGlvbnMpOwogIH0sCgogIHVucmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIHZhciBleHRyYUhlYWRlcnM7CgogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgogICAgaWYoIXRoaXMucmVnaXN0ZXJlZCAmJiAhb3B0aW9ucy5hbGwpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybignYWxyZWFkeSB1bnJlZ2lzdGVyZWQnKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKCiAgICB0aGlzLnJlZ2lzdGVyZWQgPSBmYWxzZTsKCiAgICAvLyBDbGVhciB0aGUgcmVnaXN0cmF0aW9uIHRpbWVyLgogICAgaWYgKHRoaXMucmVnaXN0cmF0aW9uVGltZXIgIT09IG51bGwpIHsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5yZWdpc3RyYXRpb25UaW1lcik7CiAgICAgIHRoaXMucmVnaXN0cmF0aW9uVGltZXIgPSBudWxsOwogICAgfQoKICAgIGlmKG9wdGlvbnMuYWxsKSB7CiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250YWN0OiAqJyk7CiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdFeHBpcmVzOiAwJyk7CiAgICB9IGVsc2UgewogICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJysgdGhpcy5jb250YWN0ICsgJztleHBpcmVzPTAnKTsKICAgIH0KCgogICAgdGhpcy5yZWNlaXZlUmVzcG9uc2UgPSBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICB2YXIgY2F1c2U7CgogICAgICBzd2l0Y2godHJ1ZSkgewogICAgICAgIGNhc2UgL14xWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIC9eMlswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgICB0aGlzLmVtaXQoJ2FjY2VwdGVkJywgcmVzcG9uc2UpOwogICAgICAgICAgaWYgKHRoaXMucmVnaXN0cmF0aW9uRXhwaXJlZFRpbWVyICE9PSBudWxsKSB7CiAgICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVnaXN0cmF0aW9uRXhwaXJlZFRpbWVyKTsKICAgICAgICAgICAgdGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIgPSBudWxsOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy51bnJlZ2lzdGVyZWQocmVzcG9uc2UpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGNhdXNlID0gU0lQLlV0aWxzLnNpcEVycm9yQ2F1c2UocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOwogICAgICAgICAgdGhpcy51bnJlZ2lzdGVyZWQocmVzcG9uc2UsY2F1c2UpOwogICAgICB9CiAgICB9OwoKICAgIHRoaXMub25SZXF1ZXN0VGltZW91dCA9IGZ1bmN0aW9uKCkgewogICAgICAvLyBOb3QgYWN0dWFsbHkgdW5yZWdpc3RlcmVkLi4uCiAgICAgIC8vdGhpcy51bnJlZ2lzdGVyZWQobnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICB9OwoKICAgIHRoaXMub25UcmFuc3BvcnRFcnJvciA9IGZ1bmN0aW9uKCkgewogICAgICAvLyBOb3QgYWN0dWFsbHkgdW5yZWdpc3RlcmVkLi4uCiAgICAgIC8vdGhpcy51bnJlZ2lzdGVyZWQobnVsbCwgU0lQLkMuY2F1c2VzLkNPTk5FQ1RJT05fRVJST1IpOwogICAgfTsKCiAgICB0aGlzLmNzZXErKzsKICAgIHRoaXMucmVxdWVzdC5jc2VxID0gdGhpcy5jc2VxOwogICAgdGhpcy5yZXF1ZXN0LnNldEhlYWRlcignY3NlcScsIHRoaXMuY3NlcSArICcgUkVHSVNURVInKTsKICAgIHRoaXMucmVxdWVzdC5leHRyYUhlYWRlcnMgPSBleHRyYUhlYWRlcnM7CgogICAgdGhpcy5zZW5kKCk7CiAgfSwKCiAgdW5yZWdpc3RlcmVkOiBmdW5jdGlvbihyZXNwb25zZSwgY2F1c2UpIHsKICAgIHRoaXMucmVnaXN0ZXJlZCA9IGZhbHNlOwogICAgdGhpcy5lbWl0KCd1bnJlZ2lzdGVyZWQnLCByZXNwb25zZSB8fCBudWxsLCBjYXVzZSB8fCBudWxsKTsKICB9Cgp9OwoKClNJUC5SZWdpc3RlckNvbnRleHQgPSBSZWdpc3RlckNvbnRleHQ7Cn07Cgp9LHt9XSwyNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCi8qKgogKiBAZmlsZW92ZXJ2aWV3IFJlcXVlc3QgU2VuZGVyCiAqLwoKLyoqCiAqIEBhdWdtZW50cyBTSVAKICogQGNsYXNzIENsYXNzIGNyZWF0aW5nIGEgcmVxdWVzdCBzZW5kZXIuCiAqIEBwYXJhbSB7T2JqZWN0fSBhcHBsaWNhbnQKICogQHBhcmFtIHtTSVAuVUF9IHVhCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyIFJlcXVlc3RTZW5kZXI7CgpSZXF1ZXN0U2VuZGVyID0gZnVuY3Rpb24oYXBwbGljYW50LCB1YSkgewogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAucmVxdWVzdHNlbmRlcicpOwogIHRoaXMudWEgPSB1YTsKICB0aGlzLmFwcGxpY2FudCA9IGFwcGxpY2FudDsKICB0aGlzLm1ldGhvZCA9IGFwcGxpY2FudC5yZXF1ZXN0Lm1ldGhvZDsKICB0aGlzLnJlcXVlc3QgPSBhcHBsaWNhbnQucmVxdWVzdDsKICB0aGlzLmNyZWRlbnRpYWxzID0gbnVsbDsKICB0aGlzLmNoYWxsZW5nZWQgPSBmYWxzZTsKICB0aGlzLnN0YWxlZCA9IGZhbHNlOwoKICAvLyBJZiB1YSBpcyBpbiBjbG9zaW5nIHByb2Nlc3Mgb3IgZXZlbiBjbG9zZWQganVzdCBhbGxvdyBzZW5kaW5nIEJ5ZSBhbmQgQUNLCiAgaWYgKHVhLnN0YXR1cyA9PT0gU0lQLlVBLkMuU1RBVFVTX1VTRVJfQ0xPU0VEICYmICh0aGlzLm1ldGhvZCAhPT0gU0lQLkMuQllFIHx8IHRoaXMubWV0aG9kICE9PSBTSVAuQy5BQ0spKSB7CiAgICB0aGlzLm9uVHJhbnNwb3J0RXJyb3IoKTsKICB9Cn07CgovKioKKiBDcmVhdGUgdGhlIGNsaWVudCB0cmFuc2FjdGlvbiBhbmQgc2VuZCB0aGUgbWVzc2FnZS4KKi8KUmVxdWVzdFNlbmRlci5wcm90b3R5cGUgPSB7CiAgc2VuZDogZnVuY3Rpb24oKSB7CiAgICBzd2l0Y2godGhpcy5tZXRob2QpIHsKICAgICAgY2FzZSAiSU5WSVRFIjoKICAgICAgICB0aGlzLmNsaWVudFRyYW5zYWN0aW9uID0gbmV3IFNJUC5UcmFuc2FjdGlvbnMuSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24odGhpcywgdGhpcy5yZXF1ZXN0LCB0aGlzLnVhLnRyYW5zcG9ydCk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgIkFDSyI6CiAgICAgICAgdGhpcy5jbGllbnRUcmFuc2FjdGlvbiA9IG5ldyBTSVAuVHJhbnNhY3Rpb25zLkFja0NsaWVudFRyYW5zYWN0aW9uKHRoaXMsIHRoaXMucmVxdWVzdCwgdGhpcy51YS50cmFuc3BvcnQpOwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIHRoaXMuY2xpZW50VHJhbnNhY3Rpb24gPSBuZXcgU0lQLlRyYW5zYWN0aW9ucy5Ob25JbnZpdGVDbGllbnRUcmFuc2FjdGlvbih0aGlzLCB0aGlzLnJlcXVlc3QsIHRoaXMudWEudHJhbnNwb3J0KTsKICAgIH0KICAgIHRoaXMuY2xpZW50VHJhbnNhY3Rpb24uc2VuZCgpOwoKICAgIHJldHVybiB0aGlzLmNsaWVudFRyYW5zYWN0aW9uOwogIH0sCgogIC8qKgogICogQ2FsbGJhY2sgZmlyZWQgd2hlbiByZWNlaXZpbmcgYSByZXF1ZXN0IHRpbWVvdXQgZXJyb3IgZnJvbSB0aGUgY2xpZW50IHRyYW5zYWN0aW9uLgogICogVG8gYmUgcmUtZGVmaW5lZCBieSB0aGUgYXBwbGljYW50LgogICogQGV2ZW50CiAgKi8KICBvblJlcXVlc3RUaW1lb3V0OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuYXBwbGljYW50Lm9uUmVxdWVzdFRpbWVvdXQoKTsKICB9LAoKICAvKioKICAqIENhbGxiYWNrIGZpcmVkIHdoZW4gcmVjZWl2aW5nIGEgdHJhbnNwb3J0IGVycm9yIGZyb20gdGhlIGNsaWVudCB0cmFuc2FjdGlvbi4KICAqIFRvIGJlIHJlLWRlZmluZWQgYnkgdGhlIGFwcGxpY2FudC4KICAqIEBldmVudAogICovCiAgb25UcmFuc3BvcnRFcnJvcjogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmFwcGxpY2FudC5vblRyYW5zcG9ydEVycm9yKCk7CiAgfSwKCiAgLyoqCiAgKiBDYWxsZWQgZnJvbSBjbGllbnQgdHJhbnNhY3Rpb24gd2hlbiByZWNlaXZpbmcgYSBjb3JyZWN0IHJlc3BvbnNlIHRvIHRoZSByZXF1ZXN0LgogICogQXV0aGVudGljYXRlIHJlcXVlc3QgaWYgbmVlZGVkIG9yIHBhc3MgdGhlIHJlc3BvbnNlIGJhY2sgdG8gdGhlIGFwcGxpY2FudC4KICAqIEBwYXJhbSB7U0lQLkluY29taW5nUmVzcG9uc2V9IHJlc3BvbnNlCiAgKi8KICByZWNlaXZlUmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICB2YXIgY3NlcSwgY2hhbGxlbmdlLCBhdXRob3JpemF0aW9uX2hlYWRlcl9uYW1lLAogICAgICBzdGF0dXNfY29kZSA9IHJlc3BvbnNlLnN0YXR1c19jb2RlOwoKICAgIC8qCiAgICAqIEF1dGhlbnRpY2F0aW9uCiAgICAqIEF1dGhlbnRpY2F0ZSBvbmNlLiBfY2hhbGxlbmdlZF8gZmxhZyB1c2VkIHRvIGF2b2lkIGluZmluaXRlIGF1dGhlbnRpY2F0aW9ucy4KICAgICovCiAgICBpZiAoc3RhdHVzX2NvZGUgPT09IDQwMSB8fCBzdGF0dXNfY29kZSA9PT0gNDA3KSB7CgogICAgICAvLyBHZXQgYW5kIHBhcnNlIHRoZSBhcHByb3ByaWF0ZSBXV1ctQXV0aGVudGljYXRlIG9yIFByb3h5LUF1dGhlbnRpY2F0ZSBoZWFkZXIuCiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNfY29kZSA9PT0gNDAxKSB7CiAgICAgICAgY2hhbGxlbmdlID0gcmVzcG9uc2UucGFyc2VIZWFkZXIoJ3d3dy1hdXRoZW50aWNhdGUnKTsKICAgICAgICBhdXRob3JpemF0aW9uX2hlYWRlcl9uYW1lID0gJ2F1dGhvcml6YXRpb24nOwogICAgICB9IGVsc2UgewogICAgICAgIGNoYWxsZW5nZSA9IHJlc3BvbnNlLnBhcnNlSGVhZGVyKCdwcm94eS1hdXRoZW50aWNhdGUnKTsKICAgICAgICBhdXRob3JpemF0aW9uX2hlYWRlcl9uYW1lID0gJ3Byb3h5LWF1dGhvcml6YXRpb24nOwogICAgICB9CgogICAgICAvLyBWZXJpZnkgaXQgc2VlbXMgYSB2YWxpZCBjaGFsbGVuZ2UuCiAgICAgIGlmICghIGNoYWxsZW5nZSkgewogICAgICAgIHRoaXMubG9nZ2VyLndhcm4ocmVzcG9uc2Uuc3RhdHVzX2NvZGUgKyAnIHdpdGggd3Jvbmcgb3IgbWlzc2luZyBjaGFsbGVuZ2UsIGNhbm5vdCBhdXRoZW50aWNhdGUnKTsKICAgICAgICB0aGlzLmFwcGxpY2FudC5yZWNlaXZlUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmNoYWxsZW5nZWQgfHwgKCF0aGlzLnN0YWxlZCAmJiBjaGFsbGVuZ2Uuc3RhbGUgPT09IHRydWUpKSB7CiAgICAgICAgaWYgKCF0aGlzLmNyZWRlbnRpYWxzKSB7CiAgICAgICAgICB0aGlzLmNyZWRlbnRpYWxzID0gdGhpcy51YS5jb25maWd1cmF0aW9uLmF1dGhlbnRpY2F0aW9uRmFjdG9yeSh0aGlzLnVhKTsKICAgICAgICB9CgogICAgICAgIC8vIFZlcmlmeSB0aGF0IHRoZSBjaGFsbGVuZ2UgaXMgcmVhbGx5IHZhbGlkLgogICAgICAgIGlmICghdGhpcy5jcmVkZW50aWFscy5hdXRoZW50aWNhdGUodGhpcy5yZXF1ZXN0LCBjaGFsbGVuZ2UpKSB7CiAgICAgICAgICB0aGlzLmFwcGxpY2FudC5yZWNlaXZlUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLmNoYWxsZW5nZWQgPSB0cnVlOwoKICAgICAgICBpZiAoY2hhbGxlbmdlLnN0YWxlKSB7CiAgICAgICAgICB0aGlzLnN0YWxlZCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAocmVzcG9uc2UubWV0aG9kID09PSBTSVAuQy5SRUdJU1RFUikgewogICAgICAgICAgY3NlcSA9IHRoaXMuYXBwbGljYW50LmNzZXEgKz0gMTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmVxdWVzdC5kaWFsb2cpewogICAgICAgICAgY3NlcSA9IHRoaXMucmVxdWVzdC5kaWFsb2cubG9jYWxfc2VxbnVtICs9IDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNzZXEgPSB0aGlzLnJlcXVlc3QuY3NlcSArIDE7CiAgICAgICAgICB0aGlzLnJlcXVlc3QuY3NlcSA9IGNzZXE7CiAgICAgICAgfQogICAgICAgIHRoaXMucmVxdWVzdC5zZXRIZWFkZXIoJ2NzZXEnLCBjc2VxICsnICcrIHRoaXMubWV0aG9kKTsKCiAgICAgICAgdGhpcy5yZXF1ZXN0LnNldEhlYWRlcihhdXRob3JpemF0aW9uX2hlYWRlcl9uYW1lLCB0aGlzLmNyZWRlbnRpYWxzLnRvU3RyaW5nKCkpOwogICAgICAgIHRoaXMuc2VuZCgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXBwbGljYW50LnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuYXBwbGljYW50LnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICB9CiAgfQp9OwoKU0lQLlJlcXVlc3RTZW5kZXIgPSBSZXF1ZXN0U2VuZGVyOwp9OwoKfSx7fV0sMjY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKioKICogQG5hbWUgU0lQCiAqIEBuYW1lc3BhY2UKICovCiJ1c2Ugc3RyaWN0IjsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGVudmlyb25tZW50KSB7Cgp2YXIgcGtnID0gcmVxdWlyZSgnLi4vcGFja2FnZS5qc29uJyk7Cgp2YXIgU0lQID0gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoe30sIHsKICB2ZXJzaW9uOiB7CiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBwa2cudmVyc2lvbjsgfQogIH0sCiAgbmFtZTogewogICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gcGtnLnRpdGxlOyB9CiAgfQp9KTsKCnJlcXVpcmUoJy4vVXRpbHMnKShTSVAsIGVudmlyb25tZW50KTsKU0lQLkxvZ2dlckZhY3RvcnkgPSByZXF1aXJlKCcuL0xvZ2dlckZhY3RvcnknKShlbnZpcm9ubWVudC5jb25zb2xlKTsKU0lQLkV2ZW50RW1pdHRlciA9IHJlcXVpcmUoJy4vRXZlbnRFbWl0dGVyJykoZW52aXJvbm1lbnQuY29uc29sZSk7ClNJUC5DID0gcmVxdWlyZSgnLi9Db25zdGFudHMnKShTSVAubmFtZSwgU0lQLnZlcnNpb24pOwpTSVAuRXhjZXB0aW9ucyA9IHJlcXVpcmUoJy4vRXhjZXB0aW9ucycpOwpTSVAuVGltZXJzID0gcmVxdWlyZSgnLi9UaW1lcnMnKShlbnZpcm9ubWVudC50aW1lcnMpOwpTSVAuVHJhbnNwb3J0ID0gZW52aXJvbm1lbnQuVHJhbnNwb3J0KFNJUCwgZW52aXJvbm1lbnQuV2ViU29ja2V0KTsKcmVxdWlyZSgnLi9QYXJzZXInKShTSVApOwpyZXF1aXJlKCcuL1NJUE1lc3NhZ2UnKShTSVApOwpyZXF1aXJlKCcuL1VSSScpKFNJUCk7CnJlcXVpcmUoJy4vTmFtZUFkZHJIZWFkZXInKShTSVApOwpyZXF1aXJlKCcuL1RyYW5zYWN0aW9ucycpKFNJUCk7CnJlcXVpcmUoJy4vRGlhbG9ncycpKFNJUCk7CnJlcXVpcmUoJy4vUmVxdWVzdFNlbmRlcicpKFNJUCk7CnJlcXVpcmUoJy4vUmVnaXN0ZXJDb250ZXh0JykoU0lQKTsKU0lQLk1lZGlhSGFuZGxlciA9IHJlcXVpcmUoJy4vTWVkaWFIYW5kbGVyJykoU0lQLkV2ZW50RW1pdHRlcik7CnJlcXVpcmUoJy4vQ2xpZW50Q29udGV4dCcpKFNJUCk7CnJlcXVpcmUoJy4vU2VydmVyQ29udGV4dCcpKFNJUCk7CnJlcXVpcmUoJy4vU2Vzc2lvbicpKFNJUCwgZW52aXJvbm1lbnQpOwpyZXF1aXJlKCcuL1N1YnNjcmlwdGlvbicpKFNJUCk7ClNJUC5XZWJSVEMgPSByZXF1aXJlKCcuL1dlYlJUQycpKFNJUCwgZW52aXJvbm1lbnQpOwpyZXF1aXJlKCcuL1VBJykoU0lQLCBlbnZpcm9ubWVudCk7ClNJUC5IYWNrcyA9IHJlcXVpcmUoJy4vSGFja3MnKShTSVApOwpyZXF1aXJlKCcuL1Nhbml0eUNoZWNrJykoU0lQKTsKU0lQLkRpZ2VzdEF1dGhlbnRpY2F0aW9uID0gcmVxdWlyZSgnLi9EaWdlc3RBdXRoZW50aWNhdGlvbicpKFNJUC5VdGlscyk7ClNJUC5HcmFtbWFyID0gcmVxdWlyZSgnLi9HcmFtbWFyJykoU0lQKTsKCnJldHVybiBTSVA7Cn07Cgp9LHsiLi4vcGFja2FnZS5qc29uIjo5LCIuL0NsaWVudENvbnRleHQiOjEwLCIuL0NvbnN0YW50cyI6MTEsIi4vRGlhbG9ncyI6MTMsIi4vRGlnZXN0QXV0aGVudGljYXRpb24iOjE0LCIuL0V2ZW50RW1pdHRlciI6MTUsIi4vRXhjZXB0aW9ucyI6MTYsIi4vR3JhbW1hciI6MTcsIi4vSGFja3MiOjE5LCIuL0xvZ2dlckZhY3RvcnkiOjIwLCIuL01lZGlhSGFuZGxlciI6MjEsIi4vTmFtZUFkZHJIZWFkZXIiOjIyLCIuL1BhcnNlciI6MjMsIi4vUmVnaXN0ZXJDb250ZXh0IjoyNCwiLi9SZXF1ZXN0U2VuZGVyIjoyNSwiLi9TSVBNZXNzYWdlIjoyNywiLi9TYW5pdHlDaGVjayI6MjgsIi4vU2VydmVyQ29udGV4dCI6MjksIi4vU2Vzc2lvbiI6MzAsIi4vU3Vic2NyaXB0aW9uIjozMiwiLi9UaW1lcnMiOjMzLCIuL1RyYW5zYWN0aW9ucyI6MzQsIi4vVUEiOjM2LCIuL1VSSSI6MzcsIi4vVXRpbHMiOjM4LCIuL1dlYlJUQyI6Mzl9XSwyNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgU0lQIE1lc3NhZ2UKICovCgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyCiAgT3V0Z29pbmdSZXF1ZXN0LAogIEluY29taW5nTWVzc2FnZSwKICBJbmNvbWluZ1JlcXVlc3QsCiAgSW5jb21pbmdSZXNwb25zZTsKCmZ1bmN0aW9uIGdldFN1cHBvcnRlZEhlYWRlciAocmVxdWVzdCkgewogIHZhciBhbGxvd1VucmVnaXN0ZXJlZCA9IHJlcXVlc3QudWEuY29uZmlndXJhdGlvbi5oYWNrQWxsb3dVbnJlZ2lzdGVyZWRPcHRpb25UYWdzOwogIHZhciBvcHRpb25UYWdzID0gW107CiAgdmFyIG9wdGlvblRhZ1NldCA9IHt9OwoKICBpZiAocmVxdWVzdC5tZXRob2QgPT09IFNJUC5DLlJFR0lTVEVSKSB7CiAgICBvcHRpb25UYWdzLnB1c2goJ3BhdGgnLCAnZ3J1dScpOwogIH0gZWxzZSBpZiAocmVxdWVzdC5tZXRob2QgPT09IFNJUC5DLklOVklURSAmJgogICAgICAgICAgICAgKHJlcXVlc3QudWEuY29udGFjdC5wdWJfZ3J1dSB8fCByZXF1ZXN0LnVhLmNvbnRhY3QudGVtcF9ncnV1KSkgewogICAgb3B0aW9uVGFncy5wdXNoKCdncnV1Jyk7CiAgfQoKICBpZiAocmVxdWVzdC51YS5jb25maWd1cmF0aW9uLnJlbDEwMCA9PT0gU0lQLkMuc3VwcG9ydGVkLlNVUFBPUlRFRCkgewogICAgb3B0aW9uVGFncy5wdXNoKCcxMDByZWwnKTsKICB9CiAgaWYgKHJlcXVlc3QudWEuY29uZmlndXJhdGlvbi5yZXBsYWNlcyA9PT0gU0lQLkMuc3VwcG9ydGVkLlNVUFBPUlRFRCkgewogICAgb3B0aW9uVGFncy5wdXNoKCdyZXBsYWNlcycpOwogIH0KCiAgb3B0aW9uVGFncy5wdXNoKCdvdXRib3VuZCcpOwoKICBvcHRpb25UYWdzID0gb3B0aW9uVGFncy5jb25jYXQocmVxdWVzdC51YS5jb25maWd1cmF0aW9uLmV4dHJhU3VwcG9ydGVkKTsKCiAgb3B0aW9uVGFncyA9IG9wdGlvblRhZ3MuZmlsdGVyKGZ1bmN0aW9uKG9wdGlvblRhZykgewogICAgdmFyIHJlZ2lzdGVyZWQgPSBTSVAuQy5PUFRJT05fVEFHU1tvcHRpb25UYWddOwogICAgdmFyIHVuaXF1ZSA9ICFvcHRpb25UYWdTZXRbb3B0aW9uVGFnXTsKICAgIG9wdGlvblRhZ1NldFtvcHRpb25UYWddID0gdHJ1ZTsKICAgIHJldHVybiAocmVnaXN0ZXJlZCB8fCBhbGxvd1VucmVnaXN0ZXJlZCkgJiYgdW5pcXVlOwogIH0pOwoKICByZXR1cm4gJ1N1cHBvcnRlZDogJyArIG9wdGlvblRhZ3Muam9pbignLCAnKSArICdcclxuJzsKfQoKLyoqCiAqIEBhdWdtZW50cyBTSVAKICogQGNsYXNzIENsYXNzIGZvciBvdXRnb2luZyBTSVAgcmVxdWVzdC4KICogQHBhcmFtIHtTdHJpbmd9IG1ldGhvZCByZXF1ZXN0IG1ldGhvZAogKiBAcGFyYW0ge1N0cmluZ30gcnVyaSByZXF1ZXN0IHVyaQogKiBAcGFyYW0ge1NJUC5VQX0gdWEKICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyBwYXJhbWV0ZXJzIHRoYXQgd2lsbCBoYXZlIHByaW9yaXR5IG92ZXIgdWEuY29uZmlndXJhdGlvbiBwYXJhbWV0ZXJzOgogKiA8YnI+CiAqICAtIGNzZXEsIGNhbGxfaWQsIGZyb21fdGFnLCBmcm9tX3VyaSwgZnJvbV9kaXNwbGF5TmFtZSwgdG9fdXJpLCB0b190YWcsIHJvdXRlX3NldAogKiBAcGFyYW0ge09iamVjdH0gW2hlYWRlcnNdIGV4dHJhIGhlYWRlcnMKICogQHBhcmFtIHtTdHJpbmd9IFtib2R5XQogKi8KT3V0Z29pbmdSZXF1ZXN0ID0gZnVuY3Rpb24obWV0aG9kLCBydXJpLCB1YSwgcGFyYW1zLCBleHRyYUhlYWRlcnMsIGJvZHkpIHsKICB2YXIKICAgIHRvLAogICAgZnJvbSwKICAgIGNhbGxfaWQsCiAgICBjc2VxLAogICAgdG9fdXJpLAogICAgZnJvbV91cmk7CgogIHBhcmFtcyA9IHBhcmFtcyB8fCB7fTsKCiAgLy8gTWFuZGF0b3J5IHBhcmFtZXRlcnMgY2hlY2sKICBpZighbWV0aG9kIHx8ICFydXJpIHx8ICF1YSkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnNpcG1lc3NhZ2UnKTsKICB0aGlzLnVhID0gdWE7CiAgdGhpcy5oZWFkZXJzID0ge307CiAgdGhpcy5tZXRob2QgPSBtZXRob2Q7CiAgdGhpcy5ydXJpID0gcnVyaTsKICB0aGlzLmJvZHkgPSBib2R5OwogIHRoaXMuZXh0cmFIZWFkZXJzID0gKGV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKICB0aGlzLnN0YXR1c0NvZGUgPSBwYXJhbXMuc3RhdHVzX2NvZGU7CiAgdGhpcy5yZWFzb25QaHJhc2UgPSBwYXJhbXMucmVhc29uX3BocmFzZTsKCiAgLy8gRmlsbCB0aGUgQ29tbW9uIFNJUCBSZXF1ZXN0IEhlYWRlcnMKCiAgLy8gUm91dGUKICBpZiAocGFyYW1zLnJvdXRlX3NldCkgewogICAgdGhpcy5zZXRIZWFkZXIoJ3JvdXRlJywgcGFyYW1zLnJvdXRlX3NldCk7CiAgfSBlbHNlIGlmICh1YS5jb25maWd1cmF0aW9uLnVzZVByZWxvYWRlZFJvdXRlKXsKICAgIHRoaXMuc2V0SGVhZGVyKCdyb3V0ZScsIHVhLnRyYW5zcG9ydC5zZXJ2ZXIuc2lwX3VyaSk7CiAgfQoKICAvLyBWaWEKICAvLyBFbXB0eSBWaWEgaGVhZGVyLiBXaWxsIGJlIGZpbGxlZCBieSB0aGUgY2xpZW50IHRyYW5zYWN0aW9uLgogIHRoaXMuc2V0SGVhZGVyKCd2aWEnLCAnJyk7CgogIC8vIE1heC1Gb3J3YXJkcwogIHRoaXMuc2V0SGVhZGVyKCdtYXgtZm9yd2FyZHMnLCBTSVAuVUEuQy5NQVhfRk9SV0FSRFMpOwoKICAvLyBUbwogIHRvX3VyaSA9IHBhcmFtcy50b191cmkgfHwgcnVyaTsKICB0byA9IChwYXJhbXMudG9fZGlzcGxheU5hbWUgfHwgcGFyYW1zLnRvX2Rpc3BsYXlOYW1lID09PSAwKSA/ICciJyArIHBhcmFtcy50b19kaXNwbGF5TmFtZSArICciICcgOiAnJzsKICB0byArPSAnPCcgKyAodG9fdXJpICYmIHRvX3VyaS50b1JhdyA/IHRvX3VyaS50b1JhdygpIDogdG9fdXJpKSArICc+JzsKICB0byArPSBwYXJhbXMudG9fdGFnID8gJzt0YWc9JyArIHBhcmFtcy50b190YWcgOiAnJzsKICB0aGlzLnRvID0gbmV3IFNJUC5OYW1lQWRkckhlYWRlci5wYXJzZSh0byk7CiAgdGhpcy5zZXRIZWFkZXIoJ3RvJywgdG8pOwoKICAvLyBGcm9tCiAgZnJvbV91cmkgPSBwYXJhbXMuZnJvbV91cmkgfHwgdWEuY29uZmlndXJhdGlvbi51cmk7CiAgaWYgKHBhcmFtcy5mcm9tX2Rpc3BsYXlOYW1lIHx8IHBhcmFtcy5mcm9tX2Rpc3BsYXlOYW1lID09PSAwKSB7CiAgICBmcm9tID0gJyInICsgcGFyYW1zLmZyb21fZGlzcGxheU5hbWUgKyAnIiAnOwogIH0gZWxzZSBpZiAodWEuY29uZmlndXJhdGlvbi5kaXNwbGF5TmFtZSkgewogICAgZnJvbSA9ICciJyArIHVhLmNvbmZpZ3VyYXRpb24uZGlzcGxheU5hbWUgKyAnIiAnOwogIH0gZWxzZSB7CiAgICBmcm9tID0gJyc7CiAgfQogIGZyb20gKz0gJzwnICsgKGZyb21fdXJpICYmIGZyb21fdXJpLnRvUmF3ID8gZnJvbV91cmkudG9SYXcoKSA6IGZyb21fdXJpKSArICc+O3RhZz0nOwogIGZyb20gKz0gcGFyYW1zLmZyb21fdGFnIHx8IFNJUC5VdGlscy5uZXdUYWcoKTsKICB0aGlzLmZyb20gPSBuZXcgU0lQLk5hbWVBZGRySGVhZGVyLnBhcnNlKGZyb20pOwogIHRoaXMuc2V0SGVhZGVyKCdmcm9tJywgZnJvbSk7CgogIC8vIENhbGwtSUQKICBjYWxsX2lkID0gcGFyYW1zLmNhbGxfaWQgfHwgKHVhLmNvbmZpZ3VyYXRpb24uc2lwanNJZCArIFNJUC5VdGlscy5jcmVhdGVSYW5kb21Ub2tlbigxNSkpOwogIHRoaXMuY2FsbF9pZCA9IGNhbGxfaWQ7CiAgdGhpcy5zZXRIZWFkZXIoJ2NhbGwtaWQnLCBjYWxsX2lkKTsKCiAgLy8gQ1NlcQogIGNzZXEgPSBwYXJhbXMuY3NlcSB8fCBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCk7CiAgdGhpcy5jc2VxID0gY3NlcTsKICB0aGlzLnNldEhlYWRlcignY3NlcScsIGNzZXEgKyAnICcgKyBtZXRob2QpOwp9OwoKT3V0Z29pbmdSZXF1ZXN0LnByb3RvdHlwZSA9IHsKICAvKioKICAgKiBSZXBsYWNlIHRoZSB0aGUgZ2l2ZW4gaGVhZGVyIGJ5IHRoZSBnaXZlbiB2YWx1ZS4KICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICAqIEBwYXJhbSB7U3RyaW5nIHwgQXJyYXl9IHZhbHVlIGhlYWRlciB2YWx1ZQogICAqLwogIHNldEhlYWRlcjogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHsKICAgIHRoaXMuaGVhZGVyc1tTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpXSA9ICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSA/IHZhbHVlIDogW3ZhbHVlXTsKICB9LAoKICAvKioKICAgKiBHZXQgdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBoZWFkZXIgbmFtZSBhdCB0aGUgZ2l2ZW4gcG9zaXRpb24uCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgaGVhZGVyIG5hbWUKICAgKiBAcmV0dXJucyB7U3RyaW5nfHVuZGVmaW5lZH0gUmV0dXJucyB0aGUgc3BlY2lmaWVkIGhlYWRlciwgdW5kZWZpbmVkIGlmIGhlYWRlciBkb2Vzbid0IGV4aXN0LgogICAqLwogIGdldEhlYWRlcjogZnVuY3Rpb24obmFtZSkgewogICAgdmFyIHJlZ2V4cCwgaWR4LAogICAgICBsZW5ndGggPSB0aGlzLmV4dHJhSGVhZGVycy5sZW5ndGgsCiAgICAgIGhlYWRlciA9IHRoaXMuaGVhZGVyc1tTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpXTsKCiAgICBpZihoZWFkZXIpIHsKICAgICAgaWYoaGVhZGVyWzBdKSB7CiAgICAgICAgcmV0dXJuIGhlYWRlclswXTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cCgnXlxccyonICsgbmFtZSArICdcXHMqOicsJ2knKTsKICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgaGVhZGVyID0gdGhpcy5leHRyYUhlYWRlcnNbaWR4XTsKICAgICAgICBpZiAocmVnZXhwLnRlc3QoaGVhZGVyKSkgewogICAgICAgICAgcmV0dXJuIGhlYWRlci5zdWJzdHJpbmcoaGVhZGVyLmluZGV4T2YoJzonKSsxKS50cmltKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuOwogIH0sCgogIC8qKgogICAqIEdldCB0aGUgaGVhZGVyL3Mgb2YgdGhlIGdpdmVuIG5hbWUuCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgaGVhZGVyIG5hbWUKICAgKiBAcmV0dXJucyB7QXJyYXl9IEFycmF5IHdpdGggYWxsIHRoZSBoZWFkZXJzIG9mIHRoZSBzcGVjaWZpZWQgbmFtZS4KICAgKi8KICBnZXRIZWFkZXJzOiBmdW5jdGlvbihuYW1lKSB7CiAgICB2YXIgaWR4LCBsZW5ndGgsIHJlZ2V4cCwKICAgICAgaGVhZGVyID0gdGhpcy5oZWFkZXJzW1NJUC5VdGlscy5oZWFkZXJpemUobmFtZSldLAogICAgICByZXN1bHQgPSBbXTsKCiAgICBpZihoZWFkZXIpIHsKICAgICAgbGVuZ3RoID0gaGVhZGVyLmxlbmd0aDsKICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgcmVzdWx0LnB1c2goaGVhZGVyW2lkeF0pOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9IGVsc2UgewogICAgICBsZW5ndGggPSB0aGlzLmV4dHJhSGVhZGVycy5sZW5ndGg7CiAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoJ15cXHMqJyArIG5hbWUgKyAnXFxzKjonLCdpJyk7CiAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICAgIGhlYWRlciA9IHRoaXMuZXh0cmFIZWFkZXJzW2lkeF07CiAgICAgICAgaWYgKHJlZ2V4cC50ZXN0KGhlYWRlcikpIHsKICAgICAgICAgIHJlc3VsdC5wdXNoKGhlYWRlci5zdWJzdHJpbmcoaGVhZGVyLmluZGV4T2YoJzonKSsxKS50cmltKCkpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0sCgogIC8qKgogICAqIFZlcmlmeSB0aGUgZXhpc3RlbmNlIG9mIHRoZSBnaXZlbiBoZWFkZXIuCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgaGVhZGVyIG5hbWUKICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpZiBoZWFkZXIgd2l0aCBnaXZlbiBuYW1lIGV4aXN0cywgZmFsc2Ugb3RoZXJ3aXNlCiAgICovCiAgaGFzSGVhZGVyOiBmdW5jdGlvbihuYW1lKSB7CiAgICB2YXIgcmVnZXhwLCBpZHgsCiAgICAgIGxlbmd0aCA9IHRoaXMuZXh0cmFIZWFkZXJzLmxlbmd0aDsKCiAgICBpZiAodGhpcy5oZWFkZXJzW1NJUC5VdGlscy5oZWFkZXJpemUobmFtZSldKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cCgnXlxccyonICsgbmFtZSArICdcXHMqOicsJ2knKTsKICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgaWYgKHJlZ2V4cC50ZXN0KHRoaXMuZXh0cmFIZWFkZXJzW2lkeF0pKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfSwKCiAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgdmFyIG1zZyA9ICcnLCBoZWFkZXIsIGxlbmd0aCwgaWR4OwoKICAgIG1zZyArPSB0aGlzLm1ldGhvZCArICcgJyArICh0aGlzLnJ1cmkudG9SYXcgPyB0aGlzLnJ1cmkudG9SYXcoKSA6IHRoaXMucnVyaSkgKyAnIFNJUC8yLjBcclxuJzsKCiAgICBmb3IgKGhlYWRlciBpbiB0aGlzLmhlYWRlcnMpIHsKICAgICAgbGVuZ3RoID0gdGhpcy5oZWFkZXJzW2hlYWRlcl0ubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBtc2cgKz0gaGVhZGVyICsgJzogJyArIHRoaXMuaGVhZGVyc1toZWFkZXJdW2lkeF0gKyAnXHJcbic7CiAgICAgIH0KICAgIH0KCiAgICBsZW5ndGggPSB0aGlzLmV4dHJhSGVhZGVycy5sZW5ndGg7CiAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgbXNnICs9IHRoaXMuZXh0cmFIZWFkZXJzW2lkeF0udHJpbSgpICsnXHJcbic7CiAgICB9CgogICAgbXNnICs9IGdldFN1cHBvcnRlZEhlYWRlcih0aGlzKTsKICAgIG1zZyArPSAnVXNlci1BZ2VudDogJyArIHRoaXMudWEuY29uZmlndXJhdGlvbi51c2VyQWdlbnRTdHJpbmcgKydcclxuJzsKCiAgICBpZih0aGlzLmJvZHkpIHsKICAgICAgbGVuZ3RoID0gU0lQLlV0aWxzLnN0cl91dGY4X2xlbmd0aCh0aGlzLmJvZHkpOwogICAgICBtc2cgKz0gJ0NvbnRlbnQtTGVuZ3RoOiAnICsgbGVuZ3RoICsgJ1xyXG5cclxuJzsKICAgICAgbXNnICs9IHRoaXMuYm9keTsKICAgIH0gZWxzZSB7CiAgICAgIG1zZyArPSAnQ29udGVudC1MZW5ndGg6IDBcclxuXHJcbic7CiAgICB9CgogICAgcmV0dXJuIG1zZzsKICB9Cn07CgovKioKICogQGF1Z21lbnRzIFNJUAogKiBAY2xhc3MgQ2xhc3MgZm9yIGluY29taW5nIFNJUCBtZXNzYWdlLgogKi8KSW5jb21pbmdNZXNzYWdlID0gZnVuY3Rpb24oKXsKICB0aGlzLmRhdGEgPSBudWxsOwogIHRoaXMuaGVhZGVycyA9IG51bGw7CiAgdGhpcy5tZXRob2QgPSAgbnVsbDsKICB0aGlzLnZpYSA9IG51bGw7CiAgdGhpcy52aWFfYnJhbmNoID0gbnVsbDsKICB0aGlzLmNhbGxfaWQgPSBudWxsOwogIHRoaXMuY3NlcSA9IG51bGw7CiAgdGhpcy5mcm9tID0gbnVsbDsKICB0aGlzLmZyb21fdGFnID0gbnVsbDsKICB0aGlzLnRvID0gbnVsbDsKICB0aGlzLnRvX3RhZyA9IG51bGw7CiAgdGhpcy5ib2R5ID0gbnVsbDsKfTsKCkluY29taW5nTWVzc2FnZS5wcm90b3R5cGUgPSB7CiAgLyoqCiAgKiBJbnNlcnQgYSBoZWFkZXIgb2YgdGhlIGdpdmVuIG5hbWUgYW5kIHZhbHVlIGludG8gdGhlIGxhc3QgcG9zaXRpb24gb2YgdGhlCiAgKiBoZWFkZXIgYXJyYXkuCiAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlIGhlYWRlciB2YWx1ZQogICovCiAgYWRkSGVhZGVyOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgdmFyIGhlYWRlciA9IHsgcmF3OiB2YWx1ZSB9OwoKICAgIG5hbWUgPSBTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpOwoKICAgIGlmKHRoaXMuaGVhZGVyc1tuYW1lXSkgewogICAgICB0aGlzLmhlYWRlcnNbbmFtZV0ucHVzaChoZWFkZXIpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5oZWFkZXJzW25hbWVdID0gW2hlYWRlcl07CiAgICB9CiAgfSwKCiAgLyoqCiAgICogR2V0IHRoZSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gaGVhZGVyIG5hbWUgYXQgdGhlIGdpdmVuIHBvc2l0aW9uLgogICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIGhlYWRlciBuYW1lCiAgICogQHJldHVybnMge1N0cmluZ3x1bmRlZmluZWR9IFJldHVybnMgdGhlIHNwZWNpZmllZCBoZWFkZXIsIG51bGwgaWYgaGVhZGVyIGRvZXNuJ3QgZXhpc3QuCiAgICovCiAgZ2V0SGVhZGVyOiBmdW5jdGlvbihuYW1lKSB7CiAgICB2YXIgaGVhZGVyID0gdGhpcy5oZWFkZXJzW1NJUC5VdGlscy5oZWFkZXJpemUobmFtZSldOwoKICAgIGlmKGhlYWRlcikgewogICAgICBpZihoZWFkZXJbMF0pIHsKICAgICAgICByZXR1cm4gaGVhZGVyWzBdLnJhdzsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuOwogICAgfQogIH0sCgogIC8qKgogICAqIEdldCB0aGUgaGVhZGVyL3Mgb2YgdGhlIGdpdmVuIG5hbWUuCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgaGVhZGVyIG5hbWUKICAgKiBAcmV0dXJucyB7QXJyYXl9IEFycmF5IHdpdGggYWxsIHRoZSBoZWFkZXJzIG9mIHRoZSBzcGVjaWZpZWQgbmFtZS4KICAgKi8KICBnZXRIZWFkZXJzOiBmdW5jdGlvbihuYW1lKSB7CiAgICB2YXIgaWR4LCBsZW5ndGgsCiAgICAgIGhlYWRlciA9IHRoaXMuaGVhZGVyc1tTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpXSwKICAgICAgcmVzdWx0ID0gW107CgogICAgaWYoIWhlYWRlcikgewogICAgICByZXR1cm4gW107CiAgICB9CgogICAgbGVuZ3RoID0gaGVhZGVyLmxlbmd0aDsKICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICByZXN1bHQucHVzaChoZWFkZXJbaWR4XS5yYXcpOwogICAgfQoKICAgIHJldHVybiByZXN1bHQ7CiAgfSwKCiAgLyoqCiAgICogVmVyaWZ5IHRoZSBleGlzdGVuY2Ugb2YgdGhlIGdpdmVuIGhlYWRlci4KICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlmIGhlYWRlciB3aXRoIGdpdmVuIG5hbWUgZXhpc3RzLCBmYWxzZSBvdGhlcndpc2UKICAgKi8KICBoYXNIZWFkZXI6IGZ1bmN0aW9uKG5hbWUpIHsKICAgIHJldHVybih0aGlzLmhlYWRlcnNbU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKV0pID8gdHJ1ZSA6IGZhbHNlOwogIH0sCgogIC8qKgogICogUGFyc2UgdGhlIGdpdmVuIGhlYWRlciBvbiB0aGUgZ2l2ZW4gaW5kZXguCiAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICogQHBhcmFtIHtOdW1iZXJ9IFtpZHg9MF0gaGVhZGVyIGluZGV4CiAgKiBAcmV0dXJucyB7T2JqZWN0fHVuZGVmaW5lZH0gUGFyc2VkIGhlYWRlciBvYmplY3QsIHVuZGVmaW5lZCBpZiB0aGUgaGVhZGVyIGlzIG5vdCBwcmVzZW50IG9yIGluIGNhc2Ugb2YgYSBwYXJzaW5nIGVycm9yLgogICovCiAgcGFyc2VIZWFkZXI6IGZ1bmN0aW9uKG5hbWUsIGlkeCkgewogICAgdmFyIGhlYWRlciwgdmFsdWUsIHBhcnNlZDsKCiAgICBuYW1lID0gU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKTsKCiAgICBpZHggPSBpZHggfHwgMDsKCiAgICBpZighdGhpcy5oZWFkZXJzW25hbWVdKSB7CiAgICAgIHRoaXMubG9nZ2VyLmxvZygnaGVhZGVyICInICsgbmFtZSArICciIG5vdCBwcmVzZW50Jyk7CiAgICAgIHJldHVybjsKICAgIH0gZWxzZSBpZihpZHggPj0gdGhpcy5oZWFkZXJzW25hbWVdLmxlbmd0aCkgewogICAgICB0aGlzLmxvZ2dlci5sb2coJ25vdCBzbyBtYW55ICInICsgbmFtZSArICciIGhlYWRlcnMgcHJlc2VudCcpOwogICAgICByZXR1cm47CiAgICB9CgogICAgaGVhZGVyID0gdGhpcy5oZWFkZXJzW25hbWVdW2lkeF07CiAgICB2YWx1ZSA9IGhlYWRlci5yYXc7CgogICAgaWYoaGVhZGVyLnBhcnNlZCkgewogICAgICByZXR1cm4gaGVhZGVyLnBhcnNlZDsKICAgIH0KCiAgICAvL3N1YnN0aXR1dGUgJy0nIGJ5ICdfJyBmb3IgZ3JhbW1hciBydWxlIG1hdGNoaW5nLgogICAgcGFyc2VkID0gU0lQLkdyYW1tYXIucGFyc2UodmFsdWUsIG5hbWUucmVwbGFjZSgvLS9nLCAnXycpKTsKCiAgICBpZihwYXJzZWQgPT09IC0xKSB7CiAgICAgIHRoaXMuaGVhZGVyc1tuYW1lXS5zcGxpY2UoaWR4LCAxKTsgLy9kZWxldGUgZnJvbSBoZWFkZXJzCiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ2Vycm9yIHBhcnNpbmcgIicgKyBuYW1lICsgJyIgaGVhZGVyIGZpZWxkIHdpdGggdmFsdWUgIicgKyB2YWx1ZSArICciJyk7CiAgICAgIHJldHVybjsKICAgIH0gZWxzZSB7CiAgICAgIGhlYWRlci5wYXJzZWQgPSBwYXJzZWQ7CiAgICAgIHJldHVybiBwYXJzZWQ7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogTWVzc2FnZSBIZWFkZXIgYXR0cmlidXRlIHNlbGVjdG9yLiBBbGlhcyBvZiBwYXJzZUhlYWRlci4KICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICAqIEBwYXJhbSB7TnVtYmVyfSBbaWR4PTBdIGhlYWRlciBpbmRleAogICAqIEByZXR1cm5zIHtPYmplY3R8dW5kZWZpbmVkfSBQYXJzZWQgaGVhZGVyIG9iamVjdCwgdW5kZWZpbmVkIGlmIHRoZSBoZWFkZXIgaXMgbm90IHByZXNlbnQgb3IgaW4gY2FzZSBvZiBhIHBhcnNpbmcgZXJyb3IuCiAgICoKICAgKiBAZXhhbXBsZQogICAqIG1lc3NhZ2UucygndmlhJywzKS5wb3J0CiAgICovCiAgczogZnVuY3Rpb24obmFtZSwgaWR4KSB7CiAgICByZXR1cm4gdGhpcy5wYXJzZUhlYWRlcihuYW1lLCBpZHgpOwogIH0sCgogIC8qKgogICogUmVwbGFjZSB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGhlYWRlciBieSB0aGUgdmFsdWUuCiAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlIGhlYWRlciB2YWx1ZQogICovCiAgc2V0SGVhZGVyOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgdmFyIGhlYWRlciA9IHsgcmF3OiB2YWx1ZSB9OwogICAgdGhpcy5oZWFkZXJzW1NJUC5VdGlscy5oZWFkZXJpemUobmFtZSldID0gW2hlYWRlcl07CiAgfSwKCiAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMuZGF0YTsKICB9Cn07CgovKioKICogQGF1Z21lbnRzIEluY29taW5nTWVzc2FnZQogKiBAY2xhc3MgQ2xhc3MgZm9yIGluY29taW5nIFNJUCByZXF1ZXN0LgogKi8KSW5jb21pbmdSZXF1ZXN0ID0gZnVuY3Rpb24odWEpIHsKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnNpcG1lc3NhZ2UnKTsKICB0aGlzLnVhID0gdWE7CiAgdGhpcy5oZWFkZXJzID0ge307CiAgdGhpcy5ydXJpID0gbnVsbDsKICB0aGlzLnRyYW5zcG9ydCA9IG51bGw7CiAgdGhpcy5zZXJ2ZXJfdHJhbnNhY3Rpb24gPSBudWxsOwp9OwpJbmNvbWluZ1JlcXVlc3QucHJvdG90eXBlID0gbmV3IEluY29taW5nTWVzc2FnZSgpOwoKLyoqCiogU3RhdGVmdWwgcmVwbHkuCiogQHBhcmFtIHtOdW1iZXJ9IGNvZGUgc3RhdHVzIGNvZGUKKiBAcGFyYW0ge1N0cmluZ30gcmVhc29uIHJlYXNvbiBwaHJhc2UKKiBAcGFyYW0ge09iamVjdH0gaGVhZGVycyBleHRyYSBoZWFkZXJzCiogQHBhcmFtIHtTdHJpbmd9IGJvZHkgYm9keQoqIEBwYXJhbSB7RnVuY3Rpb259IFtvblN1Y2Nlc3NdIG9uU3VjY2VzcyBjYWxsYmFjawoqIEBwYXJhbSB7RnVuY3Rpb259IFtvbkZhaWx1cmVdIG9uRmFpbHVyZSBjYWxsYmFjawoqLwpJbmNvbWluZ1JlcXVlc3QucHJvdG90eXBlLnJlcGx5ID0gZnVuY3Rpb24oY29kZSwgcmVhc29uLCBleHRyYUhlYWRlcnMsIGJvZHksIG9uU3VjY2Vzcywgb25GYWlsdXJlKSB7CiAgdmFyIHJyLCB2aWFzLCBsZW5ndGgsIGlkeCwgcmVzcG9uc2UsCiAgICB0byA9IHRoaXMuZ2V0SGVhZGVyKCdUbycpLAogICAgciA9IDAsCiAgICB2ID0gMDsKCiAgcmVzcG9uc2UgPSBTSVAuVXRpbHMuYnVpbGRTdGF0dXNMaW5lKGNvZGUsIHJlYXNvbik7CiAgZXh0cmFIZWFkZXJzID0gKGV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKCiAgaWYodGhpcy5tZXRob2QgPT09IFNJUC5DLklOVklURSAmJiBjb2RlID4gMTAwICYmIGNvZGUgPD0gMjAwKSB7CiAgICByciA9IHRoaXMuZ2V0SGVhZGVycygncmVjb3JkLXJvdXRlJyk7CiAgICBsZW5ndGggPSByci5sZW5ndGg7CgogICAgZm9yKHI7IHIgPCBsZW5ndGg7IHIrKykgewogICAgICByZXNwb25zZSArPSAnUmVjb3JkLVJvdXRlOiAnICsgcnJbcl0gKyAnXHJcbic7CiAgICB9CiAgfQoKICB2aWFzID0gdGhpcy5nZXRIZWFkZXJzKCd2aWEnKTsKICBsZW5ndGggPSB2aWFzLmxlbmd0aDsKCiAgZm9yKHY7IHYgPCBsZW5ndGg7IHYrKykgewogICAgcmVzcG9uc2UgKz0gJ1ZpYTogJyArIHZpYXNbdl0gKyAnXHJcbic7CiAgfQoKICBpZighdGhpcy50b190YWcgJiYgY29kZSA+IDEwMCkgewogICAgdG8gKz0gJzt0YWc9JyArIFNJUC5VdGlscy5uZXdUYWcoKTsKICB9IGVsc2UgaWYodGhpcy50b190YWcgJiYgIXRoaXMucygndG8nKS5oYXNQYXJhbSgndGFnJykpIHsKICAgIHRvICs9ICc7dGFnPScgKyB0aGlzLnRvX3RhZzsKICB9CgogIHJlc3BvbnNlICs9ICdUbzogJyArIHRvICsgJ1xyXG4nOwogIHJlc3BvbnNlICs9ICdGcm9tOiAnICsgdGhpcy5nZXRIZWFkZXIoJ0Zyb20nKSArICdcclxuJzsKICByZXNwb25zZSArPSAnQ2FsbC1JRDogJyArIHRoaXMuY2FsbF9pZCArICdcclxuJzsKICByZXNwb25zZSArPSAnQ1NlcTogJyArIHRoaXMuY3NlcSArICcgJyArIHRoaXMubWV0aG9kICsgJ1xyXG4nOwoKICBsZW5ndGggPSBleHRyYUhlYWRlcnMubGVuZ3RoOwogIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgcmVzcG9uc2UgKz0gZXh0cmFIZWFkZXJzW2lkeF0udHJpbSgpICsnXHJcbic7CiAgfQoKICByZXNwb25zZSArPSBnZXRTdXBwb3J0ZWRIZWFkZXIodGhpcyk7CiAgcmVzcG9uc2UgKz0gJ1VzZXItQWdlbnQ6ICcgKyB0aGlzLnVhLmNvbmZpZ3VyYXRpb24udXNlckFnZW50U3RyaW5nICsnXHJcbic7CgogIGlmKGJvZHkpIHsKICAgIGxlbmd0aCA9IFNJUC5VdGlscy5zdHJfdXRmOF9sZW5ndGgoYm9keSk7CiAgICByZXNwb25zZSArPSAnQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9zZHBcclxuJzsKICAgIHJlc3BvbnNlICs9ICdDb250ZW50LUxlbmd0aDogJyArIGxlbmd0aCArICdcclxuXHJcbic7CiAgICByZXNwb25zZSArPSBib2R5OwogIH0gZWxzZSB7CiAgICByZXNwb25zZSArPSAnQ29udGVudC1MZW5ndGg6ICcgKyAwICsgJ1xyXG5cclxuJzsKICB9CgogIHRoaXMuc2VydmVyX3RyYW5zYWN0aW9uLnJlY2VpdmVSZXNwb25zZShjb2RlLCByZXNwb25zZSkudGhlbihvblN1Y2Nlc3MsIG9uRmFpbHVyZSk7CgogIHJldHVybiByZXNwb25zZTsKfTsKCi8qKgoqIFN0YXRlbGVzcyByZXBseS4KKiBAcGFyYW0ge051bWJlcn0gY29kZSBzdGF0dXMgY29kZQoqIEBwYXJhbSB7U3RyaW5nfSByZWFzb24gcmVhc29uIHBocmFzZQoqLwpJbmNvbWluZ1JlcXVlc3QucHJvdG90eXBlLnJlcGx5X3NsID0gZnVuY3Rpb24oY29kZSwgcmVhc29uKSB7CiAgdmFyIHRvLCByZXNwb25zZSwKICAgIHYgPSAwLAogICAgdmlhcyA9IHRoaXMuZ2V0SGVhZGVycygndmlhJyksCiAgICBsZW5ndGggPSB2aWFzLmxlbmd0aDsKCiAgcmVzcG9uc2UgPSBTSVAuVXRpbHMuYnVpbGRTdGF0dXNMaW5lKGNvZGUsIHJlYXNvbik7CgogIGZvcih2OyB2IDwgbGVuZ3RoOyB2KyspIHsKICAgIHJlc3BvbnNlICs9ICdWaWE6ICcgKyB2aWFzW3ZdICsgJ1xyXG4nOwogIH0KCiAgdG8gPSB0aGlzLmdldEhlYWRlcignVG8nKTsKCiAgaWYoIXRoaXMudG9fdGFnICYmIGNvZGUgPiAxMDApIHsKICAgIHRvICs9ICc7dGFnPScgKyBTSVAuVXRpbHMubmV3VGFnKCk7CiAgfSBlbHNlIGlmKHRoaXMudG9fdGFnICYmICF0aGlzLnMoJ3RvJykuaGFzUGFyYW0oJ3RhZycpKSB7CiAgICB0byArPSAnO3RhZz0nICsgdGhpcy50b190YWc7CiAgfQoKICByZXNwb25zZSArPSAnVG86ICcgKyB0byArICdcclxuJzsKICByZXNwb25zZSArPSAnRnJvbTogJyArIHRoaXMuZ2V0SGVhZGVyKCdGcm9tJykgKyAnXHJcbic7CiAgcmVzcG9uc2UgKz0gJ0NhbGwtSUQ6ICcgKyB0aGlzLmNhbGxfaWQgKyAnXHJcbic7CiAgcmVzcG9uc2UgKz0gJ0NTZXE6ICcgKyB0aGlzLmNzZXEgKyAnICcgKyB0aGlzLm1ldGhvZCArICdcclxuJzsKICByZXNwb25zZSArPSAnVXNlci1BZ2VudDogJyArIHRoaXMudWEuY29uZmlndXJhdGlvbi51c2VyQWdlbnRTdHJpbmcgKydcclxuJzsKICByZXNwb25zZSArPSAnQ29udGVudC1MZW5ndGg6ICcgKyAwICsgJ1xyXG5cclxuJzsKCiAgdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSk7Cn07CgoKLyoqCiAqIEBhdWdtZW50cyBJbmNvbWluZ01lc3NhZ2UKICogQGNsYXNzIENsYXNzIGZvciBpbmNvbWluZyBTSVAgcmVzcG9uc2UuCiAqLwpJbmNvbWluZ1Jlc3BvbnNlID0gZnVuY3Rpb24odWEpIHsKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnNpcG1lc3NhZ2UnKTsKICB0aGlzLmhlYWRlcnMgPSB7fTsKICB0aGlzLnN0YXR1c19jb2RlID0gbnVsbDsKICB0aGlzLnJlYXNvbl9waHJhc2UgPSBudWxsOwp9OwpJbmNvbWluZ1Jlc3BvbnNlLnByb3RvdHlwZSA9IG5ldyBJbmNvbWluZ01lc3NhZ2UoKTsKClNJUC5PdXRnb2luZ1JlcXVlc3QgPSBPdXRnb2luZ1JlcXVlc3Q7ClNJUC5JbmNvbWluZ1JlcXVlc3QgPSBJbmNvbWluZ1JlcXVlc3Q7ClNJUC5JbmNvbWluZ1Jlc3BvbnNlID0gSW5jb21pbmdSZXNwb25zZTsKfTsKCn0se31dLDI4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBJbmNvbWluZyBTSVAgTWVzc2FnZSBTYW5pdHkgQ2hlY2sKICovCgovKioKICogU0lQIG1lc3NhZ2Ugc2FuaXR5IGNoZWNrLgogKiBAYXVnbWVudHMgU0lQCiAqIEBmdW5jdGlvbgogKiBAcGFyYW0ge1NJUC5JbmNvbWluZ01lc3NhZ2V9IG1lc3NhZ2UKICogQHBhcmFtIHtTSVAuVUF9IHVhCiAqIEBwYXJhbSB7U0lQLlRyYW5zcG9ydH0gdHJhbnNwb3J0CiAqIEByZXR1cm5zIHtCb29sZWFufQogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CnZhciBzYW5pdHlDaGVjaywKIGxvZ2dlciwKIG1lc3NhZ2UsIHVhLCB0cmFuc3BvcnQsCiByZXF1ZXN0cyA9IFtdLAogcmVzcG9uc2VzID0gW10sCiBhbGwgPSBbXTsKCi8vIFJlcGx5CmZ1bmN0aW9uIHJlcGx5KHN0YXR1c19jb2RlKSB7CiAgdmFyIHRvLAogICAgcmVzcG9uc2UgPSBTSVAuVXRpbHMuYnVpbGRTdGF0dXNMaW5lKHN0YXR1c19jb2RlKSwKICAgIHZpYXMgPSBtZXNzYWdlLmdldEhlYWRlcnMoJ3ZpYScpLAogICAgbGVuZ3RoID0gdmlhcy5sZW5ndGgsCiAgICBpZHggPSAwOwoKICBmb3IoaWR4OyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICByZXNwb25zZSArPSAiVmlhOiAiICsgdmlhc1tpZHhdICsgIlxyXG4iOwogIH0KCiAgdG8gPSBtZXNzYWdlLmdldEhlYWRlcignVG8nKTsKCiAgaWYoIW1lc3NhZ2UudG9fdGFnKSB7CiAgICB0byArPSAnO3RhZz0nICsgU0lQLlV0aWxzLm5ld1RhZygpOwogIH0KCiAgcmVzcG9uc2UgKz0gIlRvOiAiICsgdG8gKyAiXHJcbiI7CiAgcmVzcG9uc2UgKz0gIkZyb206ICIgKyBtZXNzYWdlLmdldEhlYWRlcignRnJvbScpICsgIlxyXG4iOwogIHJlc3BvbnNlICs9ICJDYWxsLUlEOiAiICsgbWVzc2FnZS5jYWxsX2lkICsgIlxyXG4iOwogIHJlc3BvbnNlICs9ICJDU2VxOiAiICsgbWVzc2FnZS5jc2VxICsgIiAiICsgbWVzc2FnZS5tZXRob2QgKyAiXHJcbiI7CiAgcmVzcG9uc2UgKz0gIlxyXG4iOwoKICB0cmFuc3BvcnQuc2VuZChyZXNwb25zZSk7Cn0KCi8qCiAqIFNhbml0eSBDaGVjayBmb3IgaW5jb21pbmcgTWVzc2FnZXMKICoKICogUmVxdWVzdHM6CiAqICAtIF9yZmMzMjYxXzhfMl8yXzFfIFJlY2VpdmUgYSBSZXF1ZXN0IHdpdGggYSBub24gc3VwcG9ydGVkIFVSSSBzY2hlbWUKICogIC0gX3JmYzMyNjFfMTZfM180XyBSZWNlaXZlIGEgUmVxdWVzdCBhbHJlYWR5IHNlbnQgYnkgdXMKICogICBEb2VzIG5vdCBsb29rIGF0IHZpYSBzZW50LWJ5IGJ1dCBhdCBzaXBqc0lkLCB3aGljaCBpcyBpbnNlcnRlZCBhcwogKiAgIGEgcHJlZml4IGluIGFsbCBpbml0aWFsIHJlcXVlc3RzIGdlbmVyYXRlZCBieSB0aGUgdWEKICogIC0gX3JmYzMyNjFfMThfM19yZXF1ZXN0XyBCb2R5IENvbnRlbnQtTGVuZ3RoCiAqICAtIF9yZmMzMjYxXzhfMl8yXzJfIE1lcmdlZCBSZXF1ZXN0cwogKgogKiBSZXNwb25zZXM6CiAqICAtIF9yZmMzMjYxXzhfMV8zXzNfIE11bHRpcGxlIFZpYSBoZWFkZXJzCiAqICAtIF9yZmMzMjYxXzE4XzFfMl8gc2VudC1ieSBtaXNtYXRjaAogKiAgLSBfcmZjMzI2MV8xOF8zX3Jlc3BvbnNlXyBCb2R5IENvbnRlbnQtTGVuZ3RoCiAqCiAqIEFsbDoKICogIC0gTWluaW11bSBoZWFkZXJzIGluIGEgU0lQIG1lc3NhZ2UKICovCgovLyBTYW5pdHkgQ2hlY2sgZnVuY3Rpb25zIGZvciByZXF1ZXN0cwpmdW5jdGlvbiByZmMzMjYxXzhfMl8yXzEoKSB7CiAgaWYoIW1lc3NhZ2UucnVyaSB8fCBtZXNzYWdlLnJ1cmkuc2NoZW1lICE9PSAnc2lwJykgewogICAgcmVwbHkoNDE2KTsKICAgIHJldHVybiBmYWxzZTsKICB9Cn0KCmZ1bmN0aW9uIHJmYzMyNjFfMTZfM180KCkgewogIGlmKCFtZXNzYWdlLnRvX3RhZykgewogICAgaWYobWVzc2FnZS5jYWxsX2lkLnN1YnN0cigwLCA1KSA9PT0gdWEuY29uZmlndXJhdGlvbi5zaXBqc0lkKSB7CiAgICAgIHJlcGx5KDQ4Mik7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIHJmYzMyNjFfMThfM19yZXF1ZXN0KCkgewogIHZhciBsZW4gPSBTSVAuVXRpbHMuc3RyX3V0ZjhfbGVuZ3RoKG1lc3NhZ2UuYm9keSksCiAgY29udGVudExlbmd0aCA9IG1lc3NhZ2UuZ2V0SGVhZGVyKCdjb250ZW50LWxlbmd0aCcpOwoKICBpZihsZW4gPCBjb250ZW50TGVuZ3RoKSB7CiAgICByZXBseSg0MDApOwogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gcmZjMzI2MV84XzJfMl8yKCkgewogIHZhciB0ciwgaWR4LAogICAgZnJvbVRhZyA9IG1lc3NhZ2UuZnJvbV90YWcsCiAgICBjYWxsX2lkID0gbWVzc2FnZS5jYWxsX2lkLAogICAgY3NlcSA9IG1lc3NhZ2UuY3NlcTsKCiAgaWYoIW1lc3NhZ2UudG9fdGFnKSB7CiAgICBpZihtZXNzYWdlLm1ldGhvZCA9PT0gU0lQLkMuSU5WSVRFKSB7CiAgICAgIHRyID0gdWEudHJhbnNhY3Rpb25zLmlzdFttZXNzYWdlLnZpYV9icmFuY2hdOwogICAgICBpZih0cikgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IoaWR4IGluIHVhLnRyYW5zYWN0aW9ucy5pc3QpIHsKICAgICAgICAgIHRyID0gdWEudHJhbnNhY3Rpb25zLmlzdFtpZHhdOwogICAgICAgICAgaWYodHIucmVxdWVzdC5mcm9tX3RhZyA9PT0gZnJvbVRhZyAmJiB0ci5yZXF1ZXN0LmNhbGxfaWQgPT09IGNhbGxfaWQgJiYgdHIucmVxdWVzdC5jc2VxID09PSBjc2VxKSB7CiAgICAgICAgICAgIHJlcGx5KDQ4Mik7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRyID0gdWEudHJhbnNhY3Rpb25zLm5pc3RbbWVzc2FnZS52aWFfYnJhbmNoXTsKICAgICAgaWYodHIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yKGlkeCBpbiB1YS50cmFuc2FjdGlvbnMubmlzdCkgewogICAgICAgICAgdHIgPSB1YS50cmFuc2FjdGlvbnMubmlzdFtpZHhdOwogICAgICAgICAgaWYodHIucmVxdWVzdC5mcm9tX3RhZyA9PT0gZnJvbVRhZyAmJiB0ci5yZXF1ZXN0LmNhbGxfaWQgPT09IGNhbGxfaWQgJiYgdHIucmVxdWVzdC5jc2VxID09PSBjc2VxKSB7CiAgICAgICAgICAgIHJlcGx5KDQ4Mik7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn0KCi8vIFNhbml0eSBDaGVjayBmdW5jdGlvbnMgZm9yIHJlc3BvbnNlcwpmdW5jdGlvbiByZmMzMjYxXzhfMV8zXzMoKSB7CiAgaWYobWVzc2FnZS5nZXRIZWFkZXJzKCd2aWEnKS5sZW5ndGggPiAxKSB7CiAgICBsb2dnZXIud2FybignTW9yZSB0aGFuIG9uZSBWaWEgaGVhZGVyIGZpZWxkIHByZXNlbnQgaW4gdGhlIHJlc3BvbnNlLiBEcm9wcGluZyB0aGUgcmVzcG9uc2UnKTsKICAgIHJldHVybiBmYWxzZTsKICB9Cn0KCmZ1bmN0aW9uIHJmYzMyNjFfMThfMV8yKCkgewogIHZhciB2aWFIb3N0ID0gdWEuY29uZmlndXJhdGlvbi52aWFIb3N0OwogIGlmKG1lc3NhZ2UudmlhLmhvc3QgIT09IHZpYUhvc3QgfHwgbWVzc2FnZS52aWEucG9ydCAhPT0gdW5kZWZpbmVkKSB7CiAgICBsb2dnZXIud2FybignVmlhIHNlbnQtYnkgaW4gdGhlIHJlc3BvbnNlIGRvZXMgbm90IG1hdGNoIFVBIFZpYSBob3N0IHZhbHVlLiBEcm9wcGluZyB0aGUgcmVzcG9uc2UnKTsKICAgIHJldHVybiBmYWxzZTsKICB9Cn0KCmZ1bmN0aW9uIHJmYzMyNjFfMThfM19yZXNwb25zZSgpIHsKICB2YXIKICAgIGxlbiA9IFNJUC5VdGlscy5zdHJfdXRmOF9sZW5ndGgobWVzc2FnZS5ib2R5KSwKICAgIGNvbnRlbnRMZW5ndGggPSBtZXNzYWdlLmdldEhlYWRlcignY29udGVudC1sZW5ndGgnKTsKCiAgICBpZihsZW4gPCBjb250ZW50TGVuZ3RoKSB7CiAgICAgIGxvZ2dlci53YXJuKCdNZXNzYWdlIGJvZHkgbGVuZ3RoIGlzIGxvd2VyIHRoYW4gdGhlIHZhbHVlIGluIENvbnRlbnQtTGVuZ3RoIGhlYWRlciBmaWVsZC4gRHJvcHBpbmcgdGhlIHJlc3BvbnNlJyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfQoKLy8gU2FuaXR5IENoZWNrIGZ1bmN0aW9ucyBmb3IgcmVxdWVzdHMgYW5kIHJlc3BvbnNlcwpmdW5jdGlvbiBtaW5pbXVtSGVhZGVycygpIHsKICB2YXIKICAgIG1hbmRhdG9yeUhlYWRlcnMgPSBbJ2Zyb20nLCAndG8nLCAnY2FsbF9pZCcsICdjc2VxJywgJ3ZpYSddLAogICAgaWR4ID0gbWFuZGF0b3J5SGVhZGVycy5sZW5ndGg7CgogIHdoaWxlKGlkeC0tKSB7CiAgICBpZighbWVzc2FnZS5oYXNIZWFkZXIobWFuZGF0b3J5SGVhZGVyc1tpZHhdKSkgewogICAgICBsb2dnZXIud2FybignTWlzc2luZyBtYW5kYXRvcnkgaGVhZGVyIGZpZWxkIDogJysgbWFuZGF0b3J5SGVhZGVyc1tpZHhdICsnLiBEcm9wcGluZyB0aGUgcmVzcG9uc2UnKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KfQoKcmVxdWVzdHMucHVzaChyZmMzMjYxXzhfMl8yXzEpOwpyZXF1ZXN0cy5wdXNoKHJmYzMyNjFfMTZfM180KTsKcmVxdWVzdHMucHVzaChyZmMzMjYxXzE4XzNfcmVxdWVzdCk7CnJlcXVlc3RzLnB1c2gocmZjMzI2MV84XzJfMl8yKTsKCnJlc3BvbnNlcy5wdXNoKHJmYzMyNjFfOF8xXzNfMyk7CnJlc3BvbnNlcy5wdXNoKHJmYzMyNjFfMThfMV8yKTsKcmVzcG9uc2VzLnB1c2gocmZjMzI2MV8xOF8zX3Jlc3BvbnNlKTsKCmFsbC5wdXNoKG1pbmltdW1IZWFkZXJzKTsKCnNhbml0eUNoZWNrID0gZnVuY3Rpb24obSwgdSwgdCkgewogIHZhciBsZW4sIHBhc3M7CgogIG1lc3NhZ2UgPSBtOwogIHVhID0gdTsKICB0cmFuc3BvcnQgPSB0OwoKICBsb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC5zYW5pdHljaGVjaycpOwoKICBsZW4gPSBhbGwubGVuZ3RoOwogIHdoaWxlKGxlbi0tKSB7CiAgICBwYXNzID0gYWxsW2xlbl0obWVzc2FnZSk7CiAgICBpZihwYXNzID09PSBmYWxzZSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQoKICBpZihtZXNzYWdlIGluc3RhbmNlb2YgU0lQLkluY29taW5nUmVxdWVzdCkgewogICAgbGVuID0gcmVxdWVzdHMubGVuZ3RoOwogICAgd2hpbGUobGVuLS0pIHsKICAgICAgcGFzcyA9IHJlcXVlc3RzW2xlbl0obWVzc2FnZSk7CiAgICAgIGlmKHBhc3MgPT09IGZhbHNlKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfQoKICBlbHNlIGlmKG1lc3NhZ2UgaW5zdGFuY2VvZiBTSVAuSW5jb21pbmdSZXNwb25zZSkgewogICAgbGVuID0gcmVzcG9uc2VzLmxlbmd0aDsKICAgIHdoaWxlKGxlbi0tKSB7CiAgICAgIHBhc3MgPSByZXNwb25zZXNbbGVuXShtZXNzYWdlKTsKICAgICAgaWYocGFzcyA9PT0gZmFsc2UpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9CgogIC8vRXZlcnl0aGluZyBpcyBPSwogIHJldHVybiB0cnVlOwp9OwoKU0lQLnNhbml0eUNoZWNrID0gc2FuaXR5Q2hlY2s7Cn07Cgp9LHt9XSwyOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CnZhciBTZXJ2ZXJDb250ZXh0OwoKU2VydmVyQ29udGV4dCA9IGZ1bmN0aW9uICh1YSwgcmVxdWVzdCkgewogIHRoaXMudWEgPSB1YTsKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnNlcnZlcmNvbnRleHQnKTsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwogIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gU0lQLkMuSU5WSVRFKSB7CiAgICB0aGlzLnRyYW5zYWN0aW9uID0gbmV3IFNJUC5UcmFuc2FjdGlvbnMuSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ocmVxdWVzdCwgdWEpOwogIH0gZWxzZSB7CiAgICB0aGlzLnRyYW5zYWN0aW9uID0gbmV3IFNJUC5UcmFuc2FjdGlvbnMuTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ocmVxdWVzdCwgdWEpOwogIH0KCiAgaWYgKHJlcXVlc3QuYm9keSkgewogICAgdGhpcy5ib2R5ID0gcmVxdWVzdC5ib2R5OwogIH0KICBpZiAocmVxdWVzdC5oYXNIZWFkZXIoJ0NvbnRlbnQtVHlwZScpKSB7CiAgICB0aGlzLmNvbnRlbnRUeXBlID0gcmVxdWVzdC5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpOwogIH0KICB0aGlzLm1ldGhvZCA9IHJlcXVlc3QubWV0aG9kOwoKICB0aGlzLmRhdGEgPSB7fTsKCiAgdGhpcy5sb2NhbElkZW50aXR5ID0gcmVxdWVzdC50bzsKICB0aGlzLnJlbW90ZUlkZW50aXR5ID0gcmVxdWVzdC5mcm9tOwp9OwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKClNlcnZlckNvbnRleHQucHJvdG90eXBlLnByb2dyZXNzID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zIHx8IE9iamVjdC5wcm90b3R5cGUpOwogIG9wdGlvbnMuc3RhdHVzQ29kZSB8fCAob3B0aW9ucy5zdGF0dXNDb2RlID0gMTgwKTsKICBvcHRpb25zLm1pbkNvZGUgPSAxMDA7CiAgb3B0aW9ucy5tYXhDb2RlID0gMTk5OwogIG9wdGlvbnMuZXZlbnRzID0gWydwcm9ncmVzcyddOwogIHJldHVybiB0aGlzLnJlcGx5KG9wdGlvbnMpOwp9OwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zIHx8IE9iamVjdC5wcm90b3R5cGUpOwogIG9wdGlvbnMuc3RhdHVzQ29kZSB8fCAob3B0aW9ucy5zdGF0dXNDb2RlID0gMjAwKTsKICBvcHRpb25zLm1pbkNvZGUgPSAyMDA7CiAgb3B0aW9ucy5tYXhDb2RlID0gMjk5OwogIG9wdGlvbnMuZXZlbnRzID0gWydhY2NlcHRlZCddOwogIHJldHVybiB0aGlzLnJlcGx5KG9wdGlvbnMpOwp9OwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUucmVqZWN0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zIHx8IE9iamVjdC5wcm90b3R5cGUpOwogIG9wdGlvbnMuc3RhdHVzQ29kZSB8fCAob3B0aW9ucy5zdGF0dXNDb2RlID0gNDgwKTsKICBvcHRpb25zLm1pbkNvZGUgPSAzMDA7CiAgb3B0aW9ucy5tYXhDb2RlID0gNjk5OwogIG9wdGlvbnMuZXZlbnRzID0gWydyZWplY3RlZCcsICdmYWlsZWQnXTsKICByZXR1cm4gdGhpcy5yZXBseShvcHRpb25zKTsKfTsKClNlcnZlckNvbnRleHQucHJvdG90eXBlLnJlcGx5ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsgLy8gVGhpcyBpcyBva2F5LCBzbyBsb25nIGFzIHdlIHRyZWF0IG9wdGlvbnMgYXMgcmVhZC1vbmx5IGluIHRoaXMgbWV0aG9kCiAgdmFyCiAgICBzdGF0dXNDb2RlID0gb3B0aW9ucy5zdGF0dXNDb2RlIHx8IDEwMCwKICAgIG1pbkNvZGUgPSBvcHRpb25zLm1pbkNvZGUgfHwgMTAwLAogICAgbWF4Q29kZSA9IG9wdGlvbnMubWF4Q29kZSB8fCA2OTksCiAgICByZWFzb25QaHJhc2UgPSBTSVAuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKHN0YXR1c0NvZGUsIG9wdGlvbnMucmVhc29uUGhyYXNlKSwKICAgIGV4dHJhSGVhZGVycyA9IG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdLAogICAgYm9keSA9IG9wdGlvbnMuYm9keSwKICAgIGV2ZW50cyA9IG9wdGlvbnMuZXZlbnRzIHx8IFtdLAogICAgcmVzcG9uc2U7CgogIGlmIChzdGF0dXNDb2RlIDwgbWluQ29kZSB8fCBzdGF0dXNDb2RlID4gbWF4Q29kZSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdGF0dXNDb2RlOiAnICsgc3RhdHVzQ29kZSk7CiAgfQogIHJlc3BvbnNlID0gdGhpcy5yZXF1ZXN0LnJlcGx5KHN0YXR1c0NvZGUsIHJlYXNvblBocmFzZSwgZXh0cmFIZWFkZXJzLCBib2R5KTsKICBldmVudHMuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHsKICAgIHRoaXMuZW1pdChldmVudCwgcmVzcG9uc2UsIHJlYXNvblBocmFzZSk7CiAgfSwgdGhpcyk7CgogIHJldHVybiB0aGlzOwp9OwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUub25SZXF1ZXN0VGltZW91dCA9IGZ1bmN0aW9uICgpIHsKICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwp9OwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUub25UcmFuc3BvcnRFcnJvciA9IGZ1bmN0aW9uICgpIHsKICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKfTsKClNJUC5TZXJ2ZXJDb250ZXh0ID0gU2VydmVyQ29udGV4dDsKfTsKCn0se31dLDMwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVAsIGVudmlyb25tZW50KSB7Cgp2YXIgRFRNRiA9IHJlcXVpcmUoJy4vU2Vzc2lvbi9EVE1GJykoU0lQKTsKCnZhciBTZXNzaW9uLCBJbnZpdGVTZXJ2ZXJDb250ZXh0LCBJbnZpdGVDbGllbnRDb250ZXh0LAogQyA9IHsKICAgIC8vU2Vzc2lvbiBzdGF0ZXMKICAgIFNUQVRVU19OVUxMOiAgICAgICAgICAgICAgICAgICAgICAgIDAsCiAgICBTVEFUVVNfSU5WSVRFX1NFTlQ6ICAgICAgICAgICAgICAgICAxLAogICAgU1RBVFVTXzFYWF9SRUNFSVZFRDogICAgICAgICAgICAgICAgMiwKICAgIFNUQVRVU19JTlZJVEVfUkVDRUlWRUQ6ICAgICAgICAgICAgIDMsCiAgICBTVEFUVVNfV0FJVElOR19GT1JfQU5TV0VSOiAgICAgICAgICA0LAogICAgU1RBVFVTX0FOU1dFUkVEOiAgICAgICAgICAgICAgICAgICAgNSwKICAgIFNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSzogICAgICAgICAgIDYsCiAgICBTVEFUVVNfV0FJVElOR19GT1JfQUNLOiAgICAgICAgICAgICA3LAogICAgU1RBVFVTX0NBTkNFTEVEOiAgICAgICAgICAgICAgICAgICAgOCwKICAgIFNUQVRVU19URVJNSU5BVEVEOiAgICAgICAgICAgICAgICAgIDksCiAgICBTVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0s6IDEwLAogICAgU1RBVFVTX0VBUkxZX01FRElBOiAgICAgICAgICAgICAgICAxMSwKICAgIFNUQVRVU19DT05GSVJNRUQ6ICAgICAgICAgICAgICAgICAgMTIKICB9OwoKLyoKICogQHBhcmFtIHtmdW5jdGlvbiByZXR1cm5pbmcgU0lQLk1lZGlhSGFuZGxlcn0gW21lZGlhSGFuZGxlckZhY3RvcnldCiAqICAgICAgICAoU2VlIHRoZSBkb2N1bWVudGF0aW9uIGZvciB0aGUgbWVkaWFIYW5kbGVyRmFjdG9yeSBhcmd1bWVudCBvZiB0aGUgVUEgY29uc3RydWN0b3IuKQogKi8KU2Vzc2lvbiA9IGZ1bmN0aW9uIChtZWRpYUhhbmRsZXJGYWN0b3J5KSB7CiAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19OVUxMOwogIHRoaXMuZGlhbG9nID0gbnVsbDsKICB0aGlzLmVhcmx5RGlhbG9ncyA9IHt9OwogIHRoaXMubWVkaWFIYW5kbGVyRmFjdG9yeSA9IG1lZGlhSGFuZGxlckZhY3RvcnkgfHwgU0lQLldlYlJUQy5NZWRpYUhhbmRsZXIuZGVmYXVsdEZhY3Rvcnk7CiAgLy8gdGhpcy5tZWRpYUhhbmRsZXIgZ2V0cyBzZXQgYnkgSUNDL0lTQyBjb25zdHJ1Y3RvcnMKICB0aGlzLmhhc09mZmVyID0gZmFsc2U7CiAgdGhpcy5oYXNBbnN3ZXIgPSBmYWxzZTsKCiAgLy8gU2Vzc2lvbiBUaW1lcnMKICB0aGlzLnRpbWVycyA9IHsKICAgIGFja1RpbWVyOiBudWxsLAogICAgZXhwaXJlc1RpbWVyOiBudWxsLAogICAgaW52aXRlMnh4VGltZXI6IG51bGwsCiAgICB1c2VyTm9BbnN3ZXJUaW1lcjogbnVsbCwKICAgIHJlbDF4eFRpbWVyOiBudWxsLAogICAgcHJhY2tUaW1lcjogbnVsbAogIH07CgogIC8vIFNlc3Npb24gaW5mbwogIHRoaXMuc3RhcnRUaW1lID0gbnVsbDsKICB0aGlzLmVuZFRpbWUgPSBudWxsOwogIHRoaXMudG9uZXMgPSBudWxsOwoKICAvLyBNdXRlL0hvbGQgc3RhdGUKICB0aGlzLmxvY2FsX2hvbGQgPSBmYWxzZTsKICB0aGlzLnJlbW90ZV9ob2xkID0gZmFsc2U7CgogIHRoaXMucGVuZGluZ19hY3Rpb25zID0gewogICAgYWN0aW9uczogW10sCgogICAgbGVuZ3RoOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuYWN0aW9ucy5sZW5ndGg7CiAgICB9LAoKICAgIGlzUGVuZGluZzogZnVuY3Rpb24obmFtZSl7CiAgICAgIHZhcgogICAgICBpZHggPSAwLAogICAgICBsZW5ndGggPSB0aGlzLmFjdGlvbnMubGVuZ3RoOwoKICAgICAgZm9yIChpZHg7IGlkeDxsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgaWYgKHRoaXMuYWN0aW9uc1tpZHhdLm5hbWUgPT09IG5hbWUpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAoKICAgIHNoaWZ0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuYWN0aW9ucy5zaGlmdCgpOwogICAgfSwKCiAgICBwdXNoOiBmdW5jdGlvbihuYW1lKSB7CiAgICAgIHRoaXMuYWN0aW9ucy5wdXNoKHsKICAgICAgICBuYW1lOiBuYW1lCiAgICAgIH0pOwogICAgfSwKCiAgICBwb3A6IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgdmFyCiAgICAgIGlkeCA9IDAsCiAgICAgIGxlbmd0aCA9IHRoaXMuYWN0aW9ucy5sZW5ndGg7CgogICAgICBmb3IgKGlkeDsgaWR4PGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBpZiAodGhpcy5hY3Rpb25zW2lkeF0ubmFtZSA9PT0gbmFtZSkgewogICAgICAgICAgdGhpcy5hY3Rpb25zLnNwbGljZShpZHgsMSk7CiAgICAgICAgICBsZW5ndGggLS07CiAgICAgICAgICBpZHgtLTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgfTsKCiAgdGhpcy5lYXJseV9zZHAgPSBudWxsOwogIHRoaXMucmVsMTAwID0gU0lQLkMuc3VwcG9ydGVkLlVOU1VQUE9SVEVEOwp9OwoKU2Vzc2lvbi5wcm90b3R5cGUgPSB7CiAgZHRtZjogZnVuY3Rpb24odG9uZXMsIG9wdGlvbnMpIHsKICAgIHZhciB0b25lLCBkdG1mcyA9IFtdLAogICAgICAgIHNlbGYgPSB0aGlzOwoKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIGlmICh0b25lcyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ05vdCBlbm91Z2ggYXJndW1lbnRzJyk7CiAgICB9CgogICAgLy8gQ2hlY2sgU2Vzc2lvbiBTdGF0dXMKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQ09ORklSTUVEICYmIHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0spIHsKICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICAvLyBDaGVjayB0b25lcwogICAgaWYgKCh0eXBlb2YgdG9uZXMgIT09ICdzdHJpbmcnICYmIHR5cGVvZiB0b25lcyAhPT0gJ251bWJlcicpIHx8ICF0b25lcy50b1N0cmluZygpLm1hdGNoKC9eWzAtOUEtRCMqLF0rJC9pKSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRvbmVzOiAnKyB0b25lcyk7CiAgICB9CgogICAgdG9uZXMgPSB0b25lcy50b1N0cmluZygpLnNwbGl0KCcnKTsKCiAgICB3aGlsZSAodG9uZXMubGVuZ3RoID4gMCkgeyBkdG1mcy5wdXNoKG5ldyBEVE1GKHRoaXMsIHRvbmVzLnNoaWZ0KCksIG9wdGlvbnMpKTsgfQoKICAgIGlmICh0aGlzLnRvbmVzKSB7CiAgICAgIC8vIFRvbmVzIGFyZSBhbHJlYWR5IHF1ZXVlZCwganVzdCBhZGQgdG8gdGhlIHF1ZXVlCiAgICAgIHRoaXMudG9uZXMgPSAgdGhpcy50b25lcy5jb25jYXQoZHRtZnMpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICB2YXIgc2VuZERUTUYgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBkdG1mLCB0aW1lb3V0OwoKICAgICAgaWYgKHNlbGYuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEIHx8ICFzZWxmLnRvbmVzIHx8IHNlbGYudG9uZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgLy8gU3RvcCBzZW5kaW5nIERUTUYKICAgICAgICBzZWxmLnRvbmVzID0gbnVsbDsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQoKICAgICAgZHRtZiA9IHNlbGYudG9uZXMuc2hpZnQoKTsKCiAgICAgIGlmICh0b25lID09PSAnLCcpIHsKICAgICAgICB0aW1lb3V0ID0gMjAwMDsKICAgICAgfSBlbHNlIHsKICAgICAgICBkdG1mLm9uKCdmYWlsZWQnLCBmdW5jdGlvbigpe3NlbGYudG9uZXMgPSBudWxsO30pOwogICAgICAgIGR0bWYuc2VuZChvcHRpb25zKTsKICAgICAgICB0aW1lb3V0ID0gZHRtZi5kdXJhdGlvbiArIGR0bWYuaW50ZXJUb25lR2FwOwogICAgICB9CgogICAgICAvLyBTZXQgdGltZW91dCBmb3IgdGhlIG5leHQgdG9uZQogICAgICBTSVAuVGltZXJzLnNldFRpbWVvdXQoc2VuZERUTUYsIHRpbWVvdXQpOwogICAgfTsKCiAgICB0aGlzLnRvbmVzID0gZHRtZnM7CiAgICBzZW5kRFRNRigpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgYnllOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zIHx8IE9iamVjdC5wcm90b3R5cGUpOwogICAgdmFyIHN0YXR1c0NvZGUgPSBvcHRpb25zLnN0YXR1c0NvZGU7CgogICAgLy8gQ2hlY2sgU2Vzc2lvbiBTdGF0dXMKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICB0aGlzLmxvZ2dlci5lcnJvcignRXJyb3I6IEF0dGVtcHRlZCB0byBzZW5kIEJZRSBpbiBhIHRlcm1pbmF0ZWQgc2Vzc2lvbi4nKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgdGhpcy5sb2dnZXIubG9nKCd0ZXJtaW5hdGluZyBTZXNzaW9uJyk7CgogICAgaWYgKHN0YXR1c0NvZGUgJiYgKHN0YXR1c0NvZGUgPCAyMDAgfHwgc3RhdHVzQ29kZSA+PSA3MDApKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgc3RhdHVzQ29kZTogJysgc3RhdHVzQ29kZSk7CiAgICB9CgogICAgb3B0aW9ucy5yZWNlaXZlUmVzcG9uc2UgPSBmdW5jdGlvbiAoKSB7fTsKCiAgICByZXR1cm4gdGhpcy4KICAgICAgc2VuZFJlcXVlc3QoU0lQLkMuQllFLCBvcHRpb25zKS4KICAgICAgdGVybWluYXRlZCgpOwogIH0sCgogIHJlZmVyOiBmdW5jdGlvbih0YXJnZXQsIG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogICAgdmFyIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKSwKICAgICAgICB3aXRoUmVwbGFjZXMgPQogICAgICAgICAgdGFyZ2V0IGluc3RhbmNlb2YgU0lQLkludml0ZVNlcnZlckNvbnRleHQgfHwKICAgICAgICAgIHRhcmdldCBpbnN0YW5jZW9mIFNJUC5JbnZpdGVDbGllbnRDb250ZXh0LAogICAgICAgIG9yaWdpbmFsVGFyZ2V0ID0gdGFyZ2V0OwoKICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdOb3QgZW5vdWdoIGFyZ3VtZW50cycpOwogICAgfQoKICAgIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgICBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogICAgfQoKICAgIC8vIHRyYW5zZm9ybSBgdGFyZ2V0YCBzbyB0aGF0IGl0IGNhbiBiZSBhIFJlZmVyLVRvIGhlYWRlciB2YWx1ZQogICAgaWYgKHdpdGhSZXBsYWNlcykgewogICAgICAvL0F0dGVuZGVkIFRyYW5zZmVyCiAgICAgIC8vIEIudHJhbnNmZXIoQykKICAgICAgdGFyZ2V0ID0gJyInICsgdGFyZ2V0LnJlbW90ZUlkZW50aXR5LmZyaWVuZGx5TmFtZSArICciICcgKwogICAgICAgICc8JyArIHRhcmdldC5kaWFsb2cucmVtb3RlX3RhcmdldC50b1N0cmluZygpICsKICAgICAgICAnP1JlcGxhY2VzPScgKyB0YXJnZXQuZGlhbG9nLmlkLmNhbGxfaWQgKwogICAgICAgICclM0J0by10YWclM0QnICsgdGFyZ2V0LmRpYWxvZy5pZC5yZW1vdGVfdGFnICsKICAgICAgICAnJTNCZnJvbS10YWclM0QnICsgdGFyZ2V0LmRpYWxvZy5pZC5sb2NhbF90YWcgKyAnPic7CiAgICB9IGVsc2UgewogICAgICAvL0JsaW5kIFRyYW5zZmVyCiAgICAgIC8vIG5vcm1hbGl6ZVRhcmdldCBhbGxvd3MgaW5zdGFuY2VzIG9mIFNJUC5VUkkgdG8gcGFzcyB0aHJvdWdoIHVuYWx0ZXJlZCwKICAgICAgLy8gc28gdHJ5IHRvIG1ha2Ugb25lIGFoZWFkIG9mIHRpbWUKICAgICAgdHJ5IHsKICAgICAgICB0YXJnZXQgPSBTSVAuR3JhbW1hci5wYXJzZSh0YXJnZXQsICdSZWZlcl9UbycpLnVyaSB8fCB0YXJnZXQ7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB0aGlzLmxvZ2dlci5kZWJ1ZygiLnJlZmVyKCkgY2Fubm90IHBhcnNlIFJlZmVyX1RvIGZyb20iLCB0YXJnZXQpOwogICAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKCIuLi5mYWxsaW5nIHRocm91Z2ggdG8gbm9ybWFsaXplVGFyZ2V0KCkiKTsKICAgICAgfQoKICAgICAgLy8gQ2hlY2sgdGFyZ2V0IHZhbGlkaXR5CiAgICAgIHRhcmdldCA9IHRoaXMudWEubm9ybWFsaXplVGFyZ2V0KHRhcmdldCk7CiAgICAgIGlmICghdGFyZ2V0KSB7CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB0YXJnZXQ6ICcgKyBvcmlnaW5hbFRhcmdldCk7CiAgICAgIH0KICAgIH0KCiAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJysgdGhpcy5jb250YWN0KTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdBbGxvdzogJysgU0lQLlVBLkMuQUxMT1dFRF9NRVRIT0RTLnRvU3RyaW5nKCkpOwogICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JlZmVyLVRvOiAnKyB0YXJnZXQpOwoKICAgIC8vIFNlbmQgdGhlIHJlcXVlc3QKICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuUkVGRVIsIHsKICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICAgIGJvZHk6IG9wdGlvbnMuYm9keSwKICAgICAgcmVjZWl2ZVJlc3BvbnNlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAoICEgL14yWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKSApIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gaGFuZyB1cCBvbmx5IGlmIHdlIHRyYW5zZmVycmVkIHRvIGEgU0lQIGFkZHJlc3MKICAgICAgICBpZiAod2l0aFJlcGxhY2VzIHx8ICh0YXJnZXQuc2NoZW1lICYmIHRhcmdldC5zY2hlbWUubWF0Y2goIl5zaXBzPyQiKSkpIHsKICAgICAgICAgIHRoaXMudGVybWluYXRlKCk7CiAgICAgICAgfQogICAgICB9LmJpbmQodGhpcykKICAgIH0pOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgZm9sbG93UmVmZXI6IGZ1bmN0aW9uIGZvbGxvd1JlZmVyIChjYWxsYmFjaykgewogICAgcmV0dXJuIGZ1bmN0aW9uIHJlZmVyTGlzdGVuZXIgKGNhbGxiYWNrLCByZXF1ZXN0KSB7CiAgICAgIC8vIG9wZW4gbm9uLVNJUCBVUklzIGlmIHBvc3NpYmxlIGFuZCBrZWVwIHNlc3Npb24gb3BlbgogICAgICB2YXIgcmVmZXJUbyA9IHJlcXVlc3QucGFyc2VIZWFkZXIoJ3JlZmVyLXRvJyk7CiAgICAgIHZhciB0YXJnZXQgPSByZWZlclRvLnVyaTsKICAgICAgaWYgKCF0YXJnZXQuc2NoZW1lLm1hdGNoKCJec2lwcz8kIikpIHsKICAgICAgICB2YXIgdGFyZ2V0U3RyaW5nID0gdGFyZ2V0LnRvU3RyaW5nKCk7CiAgICAgICAgaWYgKHR5cGVvZiBlbnZpcm9ubWVudC5vcGVuID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICBlbnZpcm9ubWVudC5vcGVuKHRhcmdldFN0cmluZyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oInJlZmVycmVkIHRvIG5vbi1TSVAgVVJJIGJ1dCBgb3BlbmAgaXNuJ3QgaW4gdGhlIGVudmlyb25tZW50OiAiICsgdGFyZ2V0U3RyaW5nKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgZXh0cmFIZWFkZXJzID0gW107CgogICAgICAvKiBDb3B5IHRoZSBSZXBsYWNlcyBxdWVyeSBpbnRvIGEgUmVwbGFjZXMgaGVhZGVyICovCiAgICAgIC8qIFRPRE8gLSBtYWtlIHN1cmUgd2UgZG9uJ3QgY29weSBhIHBvb3JseSBmb3JtYXR0ZWQgaGVhZGVyPyAqLwogICAgICB2YXIgcmVwbGFjZXMgPSB0YXJnZXQuZ2V0SGVhZGVyKCdSZXBsYWNlcycpOwogICAgICBpZiAocmVwbGFjZXMgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZXBsYWNlczogJyArIGRlY29kZVVSSUNvbXBvbmVudChyZXBsYWNlcykpOwogICAgICB9CgogICAgICAvLyBkb24ndCBlbWJlZCBoZWFkZXJzIGludG8gUmVxdWVzdC1VUkkgb2YgSU5WSVRFCiAgICAgIHRhcmdldC5jbGVhckhlYWRlcnMoKTsKCiAgICAgIC8qCiAgICAgICAgSGFybWxlc3MgcmFjZSBjb25kaXRpb24uICBCb3RoIHNpZGVzIG9mIFJFRkVSCiAgICAgICAgbWF5IHNlbmQgYSBCWUUsIGJ1dCBpbiB0aGUgZW5kIHRoZSBkaWFsb2dzIGFyZSBkZXN0cm95ZWQuCiAgICAgICovCiAgICAgIHZhciBnZXRSZWZlck1lZGlhID0gdGhpcy5tZWRpYUhhbmRsZXIuZ2V0UmVmZXJNZWRpYTsKICAgICAgdmFyIG1lZGlhSGludCA9IGdldFJlZmVyTWVkaWEgPyBnZXRSZWZlck1lZGlhLmNhbGwodGhpcy5tZWRpYUhhbmRsZXIpIDogdGhpcy5tZWRpYUhpbnQ7CgogICAgICBTSVAuSGFja3MuQ2hyb21lLmdldHNDb25mdXNlZEFib3V0R1VNKHRoaXMpOwoKICAgICAgdmFyIHJlZmVyU2Vzc2lvbiA9IHRoaXMudWEuaW52aXRlKHRhcmdldCwgewogICAgICAgIG1lZGlhOiBtZWRpYUhpbnQsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICB0b19kaXNwbGF5TmFtZTogcmVmZXJUby5mcmllbmRseU5hbWUKICAgICAgICB9LAogICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzCiAgICAgIH0pOwoKICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLCByZXF1ZXN0LCByZWZlclNlc3Npb24pOwoKICAgICAgdGhpcy50ZXJtaW5hdGUoKTsKICAgIH0uYmluZCh0aGlzLCBjYWxsYmFjayk7CiAgfSwKCiAgc2VuZFJlcXVlc3Q6IGZ1bmN0aW9uKG1ldGhvZCxvcHRpb25zKSB7CiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICB2YXIgcmVxdWVzdCA9IG5ldyBTSVAuT3V0Z29pbmdSZXF1ZXN0KAogICAgICBtZXRob2QsCiAgICAgIHRoaXMuZGlhbG9nLnJlbW90ZV90YXJnZXQsCiAgICAgIHRoaXMudWEsCiAgICAgIHsKICAgICAgICBjc2VxOiBvcHRpb25zLmNzZXEgfHwgKHRoaXMuZGlhbG9nLmxvY2FsX3NlcW51bSArPSAxKSwKICAgICAgICBjYWxsX2lkOiB0aGlzLmRpYWxvZy5pZC5jYWxsX2lkLAogICAgICAgIGZyb21fdXJpOiB0aGlzLmRpYWxvZy5sb2NhbF91cmksCiAgICAgICAgZnJvbV90YWc6IHRoaXMuZGlhbG9nLmlkLmxvY2FsX3RhZywKICAgICAgICB0b191cmk6IHRoaXMuZGlhbG9nLnJlbW90ZV91cmksCiAgICAgICAgdG9fdGFnOiB0aGlzLmRpYWxvZy5pZC5yZW1vdGVfdGFnLAogICAgICAgIHJvdXRlX3NldDogdGhpcy5kaWFsb2cucm91dGVfc2V0LAogICAgICAgIHN0YXR1c0NvZGU6IG9wdGlvbnMuc3RhdHVzQ29kZSwKICAgICAgICByZWFzb25QaHJhc2U6IG9wdGlvbnMucmVhc29uUGhyYXNlCiAgICAgIH0sCiAgICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdLAogICAgICBvcHRpb25zLmJvZHkKICAgICk7CgogICAgbmV3IFNJUC5SZXF1ZXN0U2VuZGVyKHsKICAgICAgcmVxdWVzdDogcmVxdWVzdCwKICAgICAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24oKSB7CiAgICAgICAgc2VsZi5vblJlcXVlc3RUaW1lb3V0KCk7CiAgICAgIH0sCiAgICAgIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uKCkgewogICAgICAgIHNlbGYub25UcmFuc3BvcnRFcnJvcigpOwogICAgICB9LAogICAgICByZWNlaXZlUmVzcG9uc2U6IG9wdGlvbnMucmVjZWl2ZVJlc3BvbnNlIHx8IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgc2VsZi5yZWNlaXZlTm9uSW52aXRlUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICB9CiAgICB9LCB0aGlzLnVhKS5zZW5kKCk7CgogICAgLy8gRW1pdCB0aGUgcmVxdWVzdCBldmVudAogICAgdGhpcy5lbWl0KG1ldGhvZC50b0xvd2VyQ2FzZSgpLCByZXF1ZXN0KTsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICBjbG9zZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgaWR4OwoKICAgIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHRoaXMubG9nZ2VyLmxvZygnY2xvc2luZyBJTlZJVEUgc2Vzc2lvbiAnICsgdGhpcy5pZCk7CgogICAgLy8gMXN0IFN0ZXAuIFRlcm1pbmF0ZSBtZWRpYS4KICAgIGlmICh0aGlzLm1lZGlhSGFuZGxlcil7CiAgICAgIHRoaXMubWVkaWFIYW5kbGVyLmNsb3NlKCk7CiAgICB9CgogICAgLy8gMm5kIFN0ZXAuIFRlcm1pbmF0ZSBzaWduYWxpbmcuCgogICAgLy8gQ2xlYXIgc2Vzc2lvbiB0aW1lcnMKICAgIGZvcihpZHggaW4gdGhpcy50aW1lcnMpIHsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnNbaWR4XSk7CiAgICB9CgogICAgLy8gVGVybWluYXRlIGRpYWxvZ3MKCiAgICAvLyBUZXJtaW5hdGUgY29uZmlybWVkIGRpYWxvZwogICAgaWYodGhpcy5kaWFsb2cpIHsKICAgICAgdGhpcy5kaWFsb2cudGVybWluYXRlKCk7CiAgICAgIGRlbGV0ZSB0aGlzLmRpYWxvZzsKICAgIH0KCiAgICAvLyBUZXJtaW5hdGUgZWFybHkgZGlhbG9ncwogICAgZm9yKGlkeCBpbiB0aGlzLmVhcmx5RGlhbG9ncykgewogICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZHhdLnRlcm1pbmF0ZSgpOwogICAgICBkZWxldGUgdGhpcy5lYXJseURpYWxvZ3NbaWR4XTsKICAgIH0KCiAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX1RFUk1JTkFURUQ7CgogICAgZGVsZXRlIHRoaXMudWEuc2Vzc2lvbnNbdGhpcy5pZF07CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBjcmVhdGVEaWFsb2c6IGZ1bmN0aW9uKG1lc3NhZ2UsIHR5cGUsIGVhcmx5KSB7CiAgICB2YXIgZGlhbG9nLCBlYXJseV9kaWFsb2csCiAgICAgIGxvY2FsX3RhZyA9IG1lc3NhZ2VbKHR5cGUgPT09ICdVQVMnKSA/ICd0b190YWcnIDogJ2Zyb21fdGFnJ10sCiAgICAgIHJlbW90ZV90YWcgPSBtZXNzYWdlWyh0eXBlID09PSAnVUFTJykgPyAnZnJvbV90YWcnIDogJ3RvX3RhZyddLAogICAgICBpZCA9IG1lc3NhZ2UuY2FsbF9pZCArIGxvY2FsX3RhZyArIHJlbW90ZV90YWc7CgogICAgZWFybHlfZGlhbG9nID0gdGhpcy5lYXJseURpYWxvZ3NbaWRdOwoKICAgIC8vIEVhcmx5IERpYWxvZwogICAgaWYgKGVhcmx5KSB7CiAgICAgIGlmIChlYXJseV9kaWFsb2cpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBlYXJseV9kaWFsb2cgPSBuZXcgU0lQLkRpYWxvZyh0aGlzLCBtZXNzYWdlLCB0eXBlLCBTSVAuRGlhbG9nLkMuU1RBVFVTX0VBUkxZKTsKCiAgICAgICAgLy8gRGlhbG9nIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBjcmVhdGVkLgogICAgICAgIGlmKGVhcmx5X2RpYWxvZy5lcnJvcikgewogICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoZWFybHlfZGlhbG9nLmVycm9yKTsKICAgICAgICAgIHRoaXMuZmFpbGVkKG1lc3NhZ2UsIFNJUC5DLmNhdXNlcy5JTlRFUk5BTF9FUlJPUik7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXSA9IGVhcmx5X2RpYWxvZzsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLy8gQ29uZmlybWVkIERpYWxvZwogICAgZWxzZSB7CiAgICAgIC8vIEluIGNhc2UgdGhlIGRpYWxvZyBpcyBpbiBfZWFybHlfIHN0YXRlLCB1cGRhdGUgaXQKICAgICAgaWYgKGVhcmx5X2RpYWxvZykgewogICAgICAgIGVhcmx5X2RpYWxvZy51cGRhdGUobWVzc2FnZSwgdHlwZSk7CiAgICAgICAgdGhpcy5kaWFsb2cgPSBlYXJseV9kaWFsb2c7CiAgICAgICAgZGVsZXRlIHRoaXMuZWFybHlEaWFsb2dzW2lkXTsKICAgICAgICBmb3IgKHZhciBkaWEgaW4gdGhpcy5lYXJseURpYWxvZ3MpIHsKICAgICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2RpYV0udGVybWluYXRlKCk7CiAgICAgICAgICBkZWxldGUgdGhpcy5lYXJseURpYWxvZ3NbZGlhXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIC8vIE90aGVyd2lzZSwgY3JlYXRlIGEgX2NvbmZpcm1lZF8gZGlhbG9nCiAgICAgIGRpYWxvZyA9IG5ldyBTSVAuRGlhbG9nKHRoaXMsIG1lc3NhZ2UsIHR5cGUpOwoKICAgICAgaWYoZGlhbG9nLmVycm9yKSB7CiAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoZGlhbG9nLmVycm9yKTsKICAgICAgICB0aGlzLmZhaWxlZChtZXNzYWdlLCBTSVAuQy5jYXVzZXMuSU5URVJOQUxfRVJST1IpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRvX3RhZyA9IG1lc3NhZ2UudG9fdGFnOwogICAgICAgIHRoaXMuZGlhbG9nID0gZGlhbG9nOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9CiAgfSwKCiAgLyoqCiAgKiBDaGVjayBpZiBTZXNzaW9uIGlzIHJlYWR5IGZvciBhIHJlLUlOVklURQogICoKICAqIEByZXR1cm5zIHtCb29sZWFufQogICovCiAgaXNSZWFkeVRvUmVpbnZpdGU6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMubWVkaWFIYW5kbGVyLmlzUmVhZHkoKSAmJgogICAgICAhdGhpcy5kaWFsb2cudWFjX3BlbmRpbmdfcmVwbHkgJiYKICAgICAgIXRoaXMuZGlhbG9nLnVhc19wZW5kaW5nX3JlcGx5OwogIH0sCgogIC8qKgogICAqIE11dGUKICAgKi8KICBtdXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICB2YXIgcmV0ID0gdGhpcy5tZWRpYUhhbmRsZXIubXV0ZShvcHRpb25zKTsKICAgIGlmIChyZXQpIHsKICAgICAgdGhpcy5vbm11dGUocmV0KTsKICAgIH0KICB9LAoKICAvKioKICAgKiBVbm11dGUKICAgKi8KICB1bm11dGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIHZhciByZXQgPSB0aGlzLm1lZGlhSGFuZGxlci51bm11dGUob3B0aW9ucyk7CiAgICBpZiAocmV0KSB7CiAgICAgIHRoaXMub251bm11dGUocmV0KTsKICAgIH0KICB9LAoKICAvKioKICAgKiBIb2xkCiAgICovCiAgaG9sZDogZnVuY3Rpb24ob3B0aW9ucykgewoKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLICYmIHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICB0aGlzLm1lZGlhSGFuZGxlci5ob2xkKCk7CgogICAgLy8gQ2hlY2sgaWYgUlRDU2Vzc2lvbiBpcyByZWFkeSB0byBzZW5kIGEgcmVJTlZJVEUKICAgIGlmICghdGhpcy5pc1JlYWR5VG9SZWludml0ZSgpKSB7CiAgICAgIC8qIElmIHRoZXJlIGlzIGEgcGVuZGluZyAndW5ob2xkJyBhY3Rpb24sIGNhbmNlbCBpdCBhbmQgZG9uJ3QgcXVldWUgdGhpcyBvbmUKICAgICAgICogRWxzZSwgaWYgdGhlcmUgaXNuJ3QgYW55ICdob2xkJyBhY3Rpb24sIGFkZCB0aGlzIG9uZSB0byB0aGUgcXVldWUKICAgICAgICogRWxzZSwgaWYgdGhlcmUgaXMgYWxyZWFkeSBhICdob2xkJyBhY3Rpb24sIHNraXAKICAgICAgICovCiAgICAgIGlmICh0aGlzLnBlbmRpbmdfYWN0aW9ucy5pc1BlbmRpbmcoJ3VuaG9sZCcpKSB7CiAgICAgICAgdGhpcy5wZW5kaW5nX2FjdGlvbnMucG9wKCd1bmhvbGQnKTsKICAgICAgfSBlbHNlIGlmICghdGhpcy5wZW5kaW5nX2FjdGlvbnMuaXNQZW5kaW5nKCdob2xkJykpIHsKICAgICAgICB0aGlzLnBlbmRpbmdfYWN0aW9ucy5wdXNoKCdob2xkJyk7CiAgICAgIH0KICAgICAgcmV0dXJuOwogICAgfSBlbHNlIGlmICh0aGlzLmxvY2FsX2hvbGQgPT09IHRydWUpIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5vbmhvbGQoJ2xvY2FsJyk7CgogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgICBvcHRpb25zLm1hbmdsZSA9IGZ1bmN0aW9uKGJvZHkpewoKICAgICAgLy8gRG9uJ3QgcmVjZWl2ZSBtZWRpYQogICAgICAvLyBUT0RPIC0gVGhpcyB3aWxsIGJyZWFrIGZvciBtZWRpYSBzdHJlYW1zIHdpdGggZGlmZmVyZW50IGRpcmVjdGlvbnMuCiAgICAgIGlmICghKC9hPShzZW5kcmVjdnxzZW5kb25seXxyZWN2b25seXxpbmFjdGl2ZSkvKS50ZXN0KGJvZHkpKSB7CiAgICAgICAgYm9keSA9IGJvZHkucmVwbGFjZSgvKG09W15ccl0qXHJcbikvZywgJyQxYT1zZW5kb25seVxyXG4nKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBib2R5ID0gYm9keS5yZXBsYWNlKC9hPXNlbmRyZWN2XHJcbi9nLCAnYT1zZW5kb25seVxyXG4nKTsKICAgICAgICBib2R5ID0gYm9keS5yZXBsYWNlKC9hPXJlY3Zvbmx5XHJcbi9nLCAnYT1pbmFjdGl2ZVxyXG4nKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGJvZHk7CiAgICB9OwoKICAgIHRoaXMuc2VuZFJlaW52aXRlKG9wdGlvbnMpOwogIH0sCgogIC8qKgogICAqIFVuaG9sZAogICAqLwogIHVuaG9sZDogZnVuY3Rpb24ob3B0aW9ucykgewoKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLICYmIHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICB0aGlzLm1lZGlhSGFuZGxlci51bmhvbGQoKTsKCiAgICBpZiAoIXRoaXMuaXNSZWFkeVRvUmVpbnZpdGUoKSkgewogICAgICAvKiBJZiB0aGVyZSBpcyBhIHBlbmRpbmcgJ2hvbGQnIGFjdGlvbiwgY2FuY2VsIGl0IGFuZCBkb24ndCBxdWV1ZSB0aGlzIG9uZQogICAgICAgKiBFbHNlLCBpZiB0aGVyZSBpc24ndCBhbnkgJ3VuaG9sZCcgYWN0aW9uLCBhZGQgdGhpcyBvbmUgdG8gdGhlIHF1ZXVlCiAgICAgICAqIEVsc2UsIGlmIHRoZXJlIGlzIGFscmVhZHkgYSAndW5ob2xkJyBhY3Rpb24sIHNraXAKICAgICAgICovCiAgICAgIGlmICh0aGlzLnBlbmRpbmdfYWN0aW9ucy5pc1BlbmRpbmcoJ2hvbGQnKSkgewogICAgICAgIHRoaXMucGVuZGluZ19hY3Rpb25zLnBvcCgnaG9sZCcpOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnBlbmRpbmdfYWN0aW9ucy5pc1BlbmRpbmcoJ3VuaG9sZCcpKSB7CiAgICAgICAgdGhpcy5wZW5kaW5nX2FjdGlvbnMucHVzaCgndW5ob2xkJyk7CiAgICAgIH0KICAgICAgcmV0dXJuOwogICAgfSBlbHNlIGlmICh0aGlzLmxvY2FsX2hvbGQgPT09IGZhbHNlKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLm9udW5ob2xkKCdsb2NhbCcpOwoKICAgIHRoaXMuc2VuZFJlaW52aXRlKG9wdGlvbnMpOwogIH0sCgogIC8qKgogICAqIGlzT25Ib2xkCiAgICovCiAgaXNPbkhvbGQ6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9jYWw6IHRoaXMubG9jYWxfaG9sZCwKICAgICAgcmVtb3RlOiB0aGlzLnJlbW90ZV9ob2xkCiAgICB9OwogIH0sCgogIC8qKgogICAqIEluIGRpYWxvZyBJTlZJVEUgUmVjZXB0aW9uCiAgICogQHByaXZhdGUKICAgKi8KICByZWNlaXZlUmVpbnZpdGU6IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICBpZiAoIXJlcXVlc3QuYm9keSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHJlcXVlc3QuZ2V0SGVhZGVyKCdDb250ZW50LVR5cGUnKSAhPT0gJ2FwcGxpY2F0aW9uL3NkcCcpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybignaW52YWxpZCBDb250ZW50LVR5cGUnKTsKICAgICAgcmVxdWVzdC5yZXBseSg0MTUpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5tZWRpYUhhbmRsZXIuc2V0RGVzY3JpcHRpb24ocmVxdWVzdC5ib2R5KQogICAgLnRoZW4odGhpcy5tZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24uYmluZCh0aGlzLm1lZGlhSGFuZGxlciwgdGhpcy5tZWRpYUhpbnQpKQogICAgLnRoZW4oZnVuY3Rpb24oYm9keSkgewogICAgICByZXF1ZXN0LnJlcGx5KDIwMCwgbnVsbCwgWydDb250YWN0OiAnICsgc2VsZi5jb250YWN0XSwgYm9keSwKICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgIHNlbGYuc3RhdHVzID0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLOwogICAgICAgICAgc2VsZi5zZXRJbnZpdGUyeHhUaW1lcihyZXF1ZXN0LCBib2R5KTsKICAgICAgICAgIHNlbGYuc2V0QUNLVGltZXIoKTsKCiAgICAgICAgICAvLyBBcmUgd2UgaG9sZGluZz8KICAgICAgICAgIHZhciBob2xkID0gKC9hPShzZW5kb25seXxpbmFjdGl2ZSkvKS50ZXN0KHJlcXVlc3QuYm9keSk7CgogICAgICAgICAgaWYgKHNlbGYucmVtb3RlX2hvbGQgJiYgIWhvbGQpIHsKICAgICAgICAgICAgc2VsZi5vbnVuaG9sZCgncmVtb3RlJyk7CiAgICAgICAgICB9IGVsc2UgaWYgKCFzZWxmLnJlbW90ZV9ob2xkICYmIGhvbGQpIHsKICAgICAgICAgICAgc2VsZi5vbmhvbGQoJ3JlbW90ZScpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSkKICAgIC5jYXRjaChmdW5jdGlvbiBvbkZhaWx1cmUgKGUpIHsKICAgICAgdmFyIHN0YXR1c0NvZGU7CiAgICAgIGlmIChlIGluc3RhbmNlb2YgU0lQLkV4Y2VwdGlvbnMuR2V0RGVzY3JpcHRpb25FcnJvcikgewogICAgICAgIHN0YXR1c0NvZGUgPSA1MDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2VsZi5sb2dnZXIuZXJyb3IoZSk7CiAgICAgICAgc3RhdHVzQ29kZSA9IDQ4ODsKICAgICAgfQogICAgICByZXF1ZXN0LnJlcGx5KHN0YXR1c0NvZGUpOwogICAgfSk7CiAgfSwKCiAgc2VuZFJlaW52aXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgICB2YXIKICAgICAgc2VsZiA9IHRoaXMsCiAgICAgIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKSwKICAgICAgZXZlbnRIYW5kbGVycyA9IG9wdGlvbnMuZXZlbnRIYW5kbGVycyB8fCB7fSwKICAgICAgbWFuZ2xlID0gb3B0aW9ucy5tYW5nbGUgfHwgbnVsbCwKICAgICAgc3VjY2VlZGVkOwoKICAgIGlmIChldmVudEhhbmRsZXJzLnN1Y2NlZWRlZCkgewogICAgICBzdWNjZWVkZWQgPSBldmVudEhhbmRsZXJzLnN1Y2NlZWRlZDsKICAgIH0KICAgIHRoaXMucmVpbnZpdGVTdWNjZWVkZWQgPSBmdW5jdGlvbigpewogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dChzZWxmLnRpbWVycy5hY2tUaW1lcik7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHNlbGYudGltZXJzLmludml0ZTJ4eFRpbWVyKTsKICAgICAgc2VsZi5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgIHN1Y2NlZWRlZCAmJiBzdWNjZWVkZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgICBpZiAoZXZlbnRIYW5kbGVycy5mYWlsZWQpIHsKICAgICAgdGhpcy5yZWludml0ZUZhaWxlZCA9IGV2ZW50SGFuZGxlcnMuZmFpbGVkOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5yZWludml0ZUZhaWxlZCA9IGZ1bmN0aW9uKCl7fTsKICAgIH0KCiAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJyArIHRoaXMuY29udGFjdCk7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnQWxsb3c6ICcrIFNJUC5VQS5DLkFMTE9XRURfTUVUSE9EUy50b1N0cmluZygpKTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3NkcCcpOwoKICAgIHRoaXMucmVjZWl2ZVJlc3BvbnNlID0gdGhpcy5yZWNlaXZlUmVpbnZpdGVSZXNwb25zZTsKICAgIC8vUkVWSVNJVAogICAgdGhpcy5tZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24oc2VsZi5tZWRpYUhpbnQpCiAgICAudGhlbihtYW5nbGUpCiAgICAudGhlbigKICAgICAgZnVuY3Rpb24oYm9keSl7CiAgICAgICAgc2VsZi5kaWFsb2cuc2VuZFJlcXVlc3Qoc2VsZiwgU0lQLkMuSU5WSVRFLCB7CiAgICAgICAgICBleHRyYUhlYWRlcnM6IGV4dHJhSGVhZGVycywKICAgICAgICAgIGJvZHk6IGJvZHkKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKHNlbGYuaXNSZWFkeVRvUmVpbnZpdGUoKSkgewogICAgICAgICAgc2VsZi5vblJlYWR5VG9SZWludml0ZSgpOwogICAgICAgIH0KICAgICAgICBzZWxmLnJlaW52aXRlRmFpbGVkKCk7CiAgICAgIH0KICAgICk7CiAgfSwKCiAgcmVjZWl2ZVJlcXVlc3Q6IGZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgICBzd2l0Y2ggKHJlcXVlc3QubWV0aG9kKSB7CiAgICAgIGNhc2UgU0lQLkMuQllFOgogICAgICAgIHJlcXVlc3QucmVwbHkoMjAwKTsKICAgICAgICBpZih0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgICAgICB0aGlzLmVtaXQoJ2J5ZScsIHJlcXVlc3QpOwogICAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5CWUUpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBTSVAuQy5JTlZJVEU6CiAgICAgICAgaWYodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICAgICAgdGhpcy5sb2dnZXIubG9nKCdyZS1JTlZJVEUgcmVjZWl2ZWQnKTsKICAgICAgICAgIHRoaXMucmVjZWl2ZVJlaW52aXRlKHJlcXVlc3QpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBTSVAuQy5JTkZPOgogICAgICAgIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSykgewogICAgICAgICAgdmFyIGJvZHksIHRvbmUsIGR1cmF0aW9uLAogICAgICAgICAgICAgIGNvbnRlbnRUeXBlID0gcmVxdWVzdC5nZXRIZWFkZXIoJ2NvbnRlbnQtdHlwZScpLAogICAgICAgICAgICAgIHJlZ190b25lID0gL14oU2lnbmFsXHMqPz1ccyo/KShbMC05QS1EIypdezF9KShccyk/LiovLAogICAgICAgICAgICAgIHJlZ19kdXJhdGlvbiA9IC9eKER1cmF0aW9uXHM/PVxzPykoWzAtOV17MSw0fSkoXHMpPy4qLzsKCiAgICAgICAgICBpZiAoY29udGVudFR5cGUpIHsKICAgICAgICAgICAgaWYgKGNvbnRlbnRUeXBlLm1hdGNoKC9eYXBwbGljYXRpb25cL2R0bWYtcmVsYXkvaSkpIHsKICAgICAgICAgICAgICBpZiAocmVxdWVzdC5ib2R5KSB7CiAgICAgICAgICAgICAgICBib2R5ID0gcmVxdWVzdC5ib2R5LnNwbGl0KCdcclxuJywgMik7CiAgICAgICAgICAgICAgICBpZiAoYm9keS5sZW5ndGggPT09IDIpIHsKICAgICAgICAgICAgICAgICAgaWYgKHJlZ190b25lLnRlc3QoYm9keVswXSkpIHsKICAgICAgICAgICAgICAgICAgICB0b25lID0gYm9keVswXS5yZXBsYWNlKHJlZ190b25lLCIkMiIpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmIChyZWdfZHVyYXRpb24udGVzdChib2R5WzFdKSkgewogICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gcGFyc2VJbnQoYm9keVsxXS5yZXBsYWNlKHJlZ19kdXJhdGlvbiwiJDIiKSwgMTApOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBuZXcgRFRNRih0aGlzLCB0b25lLCB7ZHVyYXRpb246IGR1cmF0aW9ufSkuaW5pdF9pbmNvbWluZyhyZXF1ZXN0KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXF1ZXN0LnJlcGx5KDQxNSwgbnVsbCwgWyJBY2NlcHQ6IGFwcGxpY2F0aW9uL2R0bWYtcmVsYXkiXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgU0lQLkMuUkVGRVI6CiAgICAgICAgaWYodGhpcy5zdGF0dXMgPT09ICBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLmxvZygnUkVGRVIgcmVjZWl2ZWQnKTsKICAgICAgICAgIHZhciBoYXNSZWZlckxpc3RlbmVyID0gdGhpcy5saXN0ZW5lcnMoJ3JlZmVyJykubGVuZ3RoLAogICAgICAgICAgICAgIG5vdGlmeUJvZHk7CgogICAgICAgICAgaWYgKGhhc1JlZmVyTGlzdGVuZXIpIHsKICAgICAgICAgICAgcmVxdWVzdC5yZXBseSgyMDIsICdBY2NlcHRlZCcpOwogICAgICAgICAgICBub3RpZnlCb2R5ID0gJ1NJUC8yLjAgMTAwIFRyeWluZyc7CgogICAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLk5PVElGWSwgewogICAgICAgICAgICAgIGV4dHJhSGVhZGVyczpbCiAgICAgICAgICAgICAgICAnRXZlbnQ6IHJlZmVyJywKICAgICAgICAgICAgICAgICdTdWJzY3JpcHRpb24tU3RhdGU6IHRlcm1pbmF0ZWQnLAogICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZTogbWVzc2FnZS9zaXBmcmFnJwogICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgYm9keTogbm90aWZ5Qm9keSwKICAgICAgICAgICAgICByZWNlaXZlUmVzcG9uc2U6IGZ1bmN0aW9uKCkge30KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICB0aGlzLmVtaXQoJ3JlZmVyJywgcmVxdWVzdCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBSRkMgMzUxNS4yLjQuMjogJ3RoZSBVQSBNQVkgZGVjbGluZSB0aGUgcmVxdWVzdC4nCiAgICAgICAgICAgIHJlcXVlc3QucmVwbHkoNjAzLCAnRGVjbGluZWQnKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgU0lQLkMuTk9USUZZOgogICAgICAgIHJlcXVlc3QucmVwbHkoMjAwLCAnT0snKTsKICAgICAgICB0aGlzLmVtaXQoJ25vdGlmeScsIHJlcXVlc3QpOwogICAgICAgIGJyZWFrOwogICAgfQogIH0sCgogIC8qKgogICAqIFJlY2VwdGlvbiBvZiBSZXNwb25zZSBmb3IgaW4tZGlhbG9nIElOVklURQogICAqIEBwcml2YXRlCiAgICovCiAgcmVjZWl2ZVJlaW52aXRlUmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgY29udGVudFR5cGUgPSByZXNwb25zZS5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpOwoKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgc3dpdGNoKHRydWUpIHsKICAgICAgY2FzZSAvXjFbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgIGJyZWFrOwogICAgICBjYXNlIC9eMlswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CgogICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuQUNLLHtjc2VxOnJlc3BvbnNlLmNzZXF9KTsKCiAgICAgICAgaWYoIXJlc3BvbnNlLmJvZHkpIHsKICAgICAgICAgIHRoaXMucmVpbnZpdGVGYWlsZWQoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0gZWxzZSBpZiAoY29udGVudFR5cGUgIT09ICdhcHBsaWNhdGlvbi9zZHAnKSB7CiAgICAgICAgICB0aGlzLnJlaW52aXRlRmFpbGVkKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIC8vUkVWSVNJVAogICAgICAgIHRoaXMubWVkaWFIYW5kbGVyLnNldERlc2NyaXB0aW9uKHJlc3BvbnNlLmJvZHkpCiAgICAgICAgLnRoZW4oCiAgICAgICAgICBmdW5jdGlvbiBvblN1Y2Nlc3MgKCkgewogICAgICAgICAgICBzZWxmLnJlaW52aXRlU3VjY2VlZGVkKCk7CiAgICAgICAgICB9LAogICAgICAgICAgZnVuY3Rpb24gb25GYWlsdXJlICgpIHsKICAgICAgICAgICAgc2VsZi5yZWludml0ZUZhaWxlZCgpOwogICAgICAgICAgfQogICAgICAgICk7CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhpcy5yZWludml0ZUZhaWxlZCgpOwogICAgfQogIH0sCgogIGFjY2VwdEFuZFRlcm1pbmF0ZTogZnVuY3Rpb24ocmVzcG9uc2UsIHN0YXR1c19jb2RlLCByZWFzb25fcGhyYXNlKSB7CiAgICB2YXIgZXh0cmFIZWFkZXJzID0gW107CgogICAgaWYgKHN0YXR1c19jb2RlKSB7CiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZWFzb246ICcgKyBTSVAuVXRpbHMuZ2V0UmVhc29uSGVhZGVyVmFsdWUoc3RhdHVzX2NvZGUsIHJlYXNvbl9waHJhc2UpKTsKICAgIH0KCiAgICAvLyBBbiBlcnJvciBvbiBkaWFsb2cgY3JlYXRpb24gd2lsbCBmaXJlICdmYWlsZWQnIGV2ZW50CiAgICBpZiAodGhpcy5kaWFsb2cgfHwgdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnKSkgewogICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLkFDSyx7Y3NlcTogcmVzcG9uc2UuY3NlcX0pOwogICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLkJZRSwgewogICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzCiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAqIFJGQzMyNjEgMTMuMy4xLjQKICAgKiBSZXNwb25zZSByZXRyYW5zbWlzc2lvbnMgY2Fubm90IGJlIGFjY29tcGxpc2hlZCBieSB0cmFuc2FjdGlvbiBsYXllcgogICAqICBzaW5jZSBpdCBpcyBkZXN0cm95ZWQgd2hlbiByZWNlaXZpbmcgdGhlIGZpcnN0IDJ4eCBhbnN3ZXIKICAgKi8KICBzZXRJbnZpdGUyeHhUaW1lcjogZnVuY3Rpb24ocmVxdWVzdCwgYm9keSkgewogICAgdmFyIHNlbGYgPSB0aGlzLAogICAgICAgIHRpbWVvdXQgPSBTSVAuVGltZXJzLlQxOwoKICAgIHRoaXMudGltZXJzLmludml0ZTJ4eFRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uIGludml0ZTJ4eFJldHJhbnNtaXNzaW9uKCkgewogICAgICBpZiAoc2VsZi5zdGF0dXMgIT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgc2VsZi5sb2dnZXIubG9nKCdubyBBQ0sgcmVjZWl2ZWQsIGF0dGVtcHRpbmcgdG8gcmV0cmFuc21pdCBPSycpOwoKICAgICAgcmVxdWVzdC5yZXBseSgyMDAsIG51bGwsIFsnQ29udGFjdDogJyArIHNlbGYuY29udGFjdF0sIGJvZHkpOwoKICAgICAgdGltZW91dCA9IE1hdGgubWluKHRpbWVvdXQgKiAyLCBTSVAuVGltZXJzLlQyKTsKCiAgICAgIHNlbGYudGltZXJzLmludml0ZTJ4eFRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGludml0ZTJ4eFJldHJhbnNtaXNzaW9uLCB0aW1lb3V0KTsKICAgIH0sIHRpbWVvdXQpOwogIH0sCgogIC8qKgogICAqIFJGQzMyNjEgMTQuMgogICAqIElmIGEgVUFTIGdlbmVyYXRlcyBhIDJ4eCByZXNwb25zZSBhbmQgbmV2ZXIgcmVjZWl2ZXMgYW4gQUNLLAogICAqICBpdCBTSE9VTEQgZ2VuZXJhdGUgYSBCWUUgdG8gdGVybWluYXRlIHRoZSBkaWFsb2cuCiAgICovCiAgc2V0QUNLVGltZXI6IGZ1bmN0aW9uKCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgIHRoaXMudGltZXJzLmFja1RpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICBpZihzZWxmLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLKSB7CiAgICAgICAgc2VsZi5sb2dnZXIubG9nKCdubyBBQ0sgcmVjZWl2ZWQgZm9yIGFuIGV4dGVuZGVkIHBlcmlvZCBvZiB0aW1lLCB0ZXJtaW5hdGluZyB0aGUgY2FsbCcpOwogICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHNlbGYudGltZXJzLmludml0ZTJ4eFRpbWVyKTsKICAgICAgICBzZWxmLnNlbmRSZXF1ZXN0KFNJUC5DLkJZRSk7CiAgICAgICAgc2VsZi50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5OT19BQ0spOwogICAgICB9CiAgICB9LCBTSVAuVGltZXJzLlRJTUVSX0gpOwogIH0sCgogIC8qCiAgICogQHByaXZhdGUKICAgKi8KICBvblJlYWR5VG9SZWludml0ZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgYWN0aW9uID0gdGhpcy5wZW5kaW5nX2FjdGlvbnMuc2hpZnQoKTsKCiAgICBpZiAoIWFjdGlvbiB8fCAhdGhpc1thY3Rpb24ubmFtZV0pIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXNbYWN0aW9uLm5hbWVdKCk7CiAgfSwKCiAgb25UcmFuc3BvcnRFcnJvcjogZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX0NPTkZJUk1FRCAmJiB0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICB0aGlzLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICB9CiAgfSwKCiAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICB9CiAgfSwKCiAgb25EaWFsb2dFcnJvcjogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRoaXMudGVybWluYXRlZChyZXNwb25zZSwgU0lQLkMuY2F1c2VzLkRJQUxPR19FUlJPUik7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuRElBTE9HX0VSUk9SKTsKICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuRElBTE9HX0VSUk9SKTsKICAgIH0KICB9LAoKICAvKioKICAgKiBAcHJpdmF0ZQogICAqLwogIG9uaG9sZDogZnVuY3Rpb24ob3JpZ2luYXRvcikgewogICAgdGhpc1tvcmlnaW5hdG9yID09PSAnbG9jYWwnID8gJ2xvY2FsX2hvbGQnIDogJ3JlbW90ZV9ob2xkJ10gPSB0cnVlOwogICAgdGhpcy5lbWl0KCdob2xkJywgeyBvcmlnaW5hdG9yOiBvcmlnaW5hdG9yIH0pOwogIH0sCgogIC8qKgogICAqIEBwcml2YXRlCiAgICovCiAgb251bmhvbGQ6IGZ1bmN0aW9uKG9yaWdpbmF0b3IpIHsKICAgIHRoaXNbb3JpZ2luYXRvciA9PT0gJ2xvY2FsJyA/ICdsb2NhbF9ob2xkJyA6ICdyZW1vdGVfaG9sZCddID0gZmFsc2U7CiAgICB0aGlzLmVtaXQoJ3VuaG9sZCcsIHsgb3JpZ2luYXRvcjogb3JpZ2luYXRvciB9KTsKICB9LAoKICAvKgogICAqIEBwcml2YXRlCiAgICovCiAgb25tdXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICB0aGlzLmVtaXQoJ211dGVkJywgewogICAgICBhdWRpbzogb3B0aW9ucy5hdWRpbywKICAgICAgdmlkZW86IG9wdGlvbnMudmlkZW8KICAgIH0pOwogIH0sCgogIC8qCiAgICogQHByaXZhdGUKICAgKi8KICBvbnVubXV0ZTogZnVuY3Rpb24ob3B0aW9ucykgewogICAgdGhpcy5lbWl0KCd1bm11dGVkJywgewogICAgICBhdWRpbzogb3B0aW9ucy5hdWRpbywKICAgICAgdmlkZW86IG9wdGlvbnMudmlkZW8KICAgIH0pOwogIH0sCgogIGZhaWxlZDogZnVuY3Rpb24ocmVzcG9uc2UsIGNhdXNlKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIHJlc3BvbnNlIHx8IG51bGwsIGNhdXNlIHx8IG51bGwpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgcmVqZWN0ZWQ6IGZ1bmN0aW9uKHJlc3BvbnNlLCBjYXVzZSkgewogICAgdGhpcy5lbWl0KCdyZWplY3RlZCcsCiAgICAgIHJlc3BvbnNlIHx8IG51bGwsCiAgICAgIGNhdXNlIHx8IG51bGwKICAgICk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBjYW5jZWxlZDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmVtaXQoJ2NhbmNlbCcpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgYWNjZXB0ZWQ6IGZ1bmN0aW9uKHJlc3BvbnNlLCBjYXVzZSkgewogICAgY2F1c2UgPSBTSVAuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlLCBjYXVzZSk7CgogICAgdGhpcy5zdGFydFRpbWUgPSBuZXcgRGF0ZSgpOwoKICAgIGlmICh0aGlzLnJlcGxhY2VlKSB7CiAgICAgIHRoaXMucmVwbGFjZWUuZW1pdCgncmVwbGFjZWQnLCB0aGlzKTsKICAgICAgdGhpcy5yZXBsYWNlZS50ZXJtaW5hdGUoKTsKICAgIH0KICAgIHRoaXMuZW1pdCgnYWNjZXB0ZWQnLCByZXNwb25zZSwgY2F1c2UpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgdGVybWluYXRlZDogZnVuY3Rpb24obWVzc2FnZSwgY2F1c2UpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICB0aGlzLmVuZFRpbWUgPSBuZXcgRGF0ZSgpOwoKICAgIHRoaXMuY2xvc2UoKTsKICAgIHRoaXMuZW1pdCgndGVybWluYXRlZCcsCiAgICAgIG1lc3NhZ2UgfHwgbnVsbCwKICAgICAgY2F1c2UgfHwgbnVsbAogICAgKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIGNvbm5lY3Rpbmc6IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICAgIHRoaXMuZW1pdCgnY29ubmVjdGluZycsIHsgcmVxdWVzdDogcmVxdWVzdCB9KTsKICAgIHJldHVybiB0aGlzOwogIH0KfTsKClNlc3Npb24uZGVzdWdhciA9IGZ1bmN0aW9uIGRlc3VnYXIob3B0aW9ucykgewogIGlmIChlbnZpcm9ubWVudC5IVE1MTWVkaWFFbGVtZW50ICYmIG9wdGlvbnMgaW5zdGFuY2VvZiBlbnZpcm9ubWVudC5IVE1MTWVkaWFFbGVtZW50KSB7CiAgICBvcHRpb25zID0gewogICAgICBtZWRpYTogewogICAgICAgIGNvbnN0cmFpbnRzOiB7CiAgICAgICAgICBhdWRpbzogdHJ1ZSwKICAgICAgICAgIHZpZGVvOiBvcHRpb25zLnRhZ05hbWUgPT09ICdWSURFTycKICAgICAgICB9LAogICAgICAgIHJlbmRlcjogewogICAgICAgICAgcmVtb3RlOiBvcHRpb25zCiAgICAgICAgfQogICAgICB9CiAgICB9OwogIH0KICByZXR1cm4gb3B0aW9ucyB8fCB7fTsKfTsKCgpTZXNzaW9uLkMgPSBDOwpTSVAuU2Vzc2lvbiA9IFNlc3Npb247CgoKSW52aXRlU2VydmVyQ29udGV4dCA9IGZ1bmN0aW9uKHVhLCByZXF1ZXN0KSB7CiAgdmFyIGV4cGlyZXMsCiAgICBzZWxmID0gdGhpcywKICAgIGNvbnRlbnRUeXBlID0gcmVxdWVzdC5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpLAogICAgY29udGVudERpc3AgPSByZXF1ZXN0LnBhcnNlSGVhZGVyKCdDb250ZW50LURpc3Bvc2l0aW9uJyk7CgogIC8vIENoZWNrIGJvZHkgYW5kIGNvbnRlbnQgdHlwZQogIGlmICgoIWNvbnRlbnREaXNwICYmIGNvbnRlbnRUeXBlICE9PSAnYXBwbGljYXRpb24vc2RwJykgfHwgKGNvbnRlbnREaXNwICYmIGNvbnRlbnREaXNwLnR5cGUgPT09ICdyZW5kZXInKSkgewogICAgdGhpcy5yZW5kZXJib2R5ID0gcmVxdWVzdC5ib2R5OwogICAgdGhpcy5yZW5kZXJ0eXBlID0gY29udGVudFR5cGU7CiAgfSBlbHNlIGlmIChjb250ZW50VHlwZSAhPT0gJ2FwcGxpY2F0aW9uL3NkcCcgJiYgKGNvbnRlbnREaXNwICYmIGNvbnRlbnREaXNwLnR5cGUgPT09ICdzZXNzaW9uJykpIHsKICAgIHJlcXVlc3QucmVwbHkoNDE1KTsKICAgIC8vVE9ETzogaW5zdGVhZCBvZiA0MTUsIHBhc3Mgb2ZmIHRvIHRoZSBtZWRpYSBoYW5kbGVyLCB3aG8gY2FuIHRoZW4gZGVjaWRlIGlmIHdlIGNhbiB1c2UgaXQKICAgIHJldHVybjsKICB9CgogIC8vVE9ETzogbW92ZSB0aGlzIGludG8gbWVkaWEgaGFuZGxlcgogIFNJUC5IYWNrcy5GaXJlZm94LmNhbm5vdEhhbmRsZUV4dHJhV2hpdGVzcGFjZShyZXF1ZXN0KTsKICBTSVAuSGFja3MuQWxsQnJvd3NlcnMubWFza0R0bHMocmVxdWVzdCk7CgogIFNJUC5VdGlscy5hdWdtZW50KHRoaXMsIFNJUC5TZXJ2ZXJDb250ZXh0LCBbdWEsIHJlcXVlc3RdKTsKICBTSVAuVXRpbHMuYXVnbWVudCh0aGlzLCBTSVAuU2Vzc2lvbiwgW3VhLmNvbmZpZ3VyYXRpb24ubWVkaWFIYW5kbGVyRmFjdG9yeV0pOwoKICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0lOVklURV9SRUNFSVZFRDsKICB0aGlzLmZyb21fdGFnID0gcmVxdWVzdC5mcm9tX3RhZzsKICB0aGlzLmlkID0gcmVxdWVzdC5jYWxsX2lkICsgdGhpcy5mcm9tX3RhZzsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwogIHRoaXMuY29udGFjdCA9IHRoaXMudWEuY29udGFjdC50b1N0cmluZygpOwoKICB0aGlzLnJlY2VpdmVOb25JbnZpdGVSZXNwb25zZSA9IGZ1bmN0aW9uICgpIHt9OyAvLyBpbnRlbnRpb25hbCBuby1vcAoKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLmludml0ZXNlcnZlcmNvbnRleHQnLCB0aGlzLmlkKTsKCiAgLy9TYXZlIHRoZSBzZXNzaW9uIGludG8gdGhlIHVhIHNlc3Npb25zIGNvbGxlY3Rpb24uCiAgdGhpcy51YS5zZXNzaW9uc1t0aGlzLmlkXSA9IHRoaXM7CgogIC8vR2V0IHRoZSBFeHBpcmVzIGhlYWRlciB2YWx1ZSBpZiBleGlzdHMKICBpZihyZXF1ZXN0Lmhhc0hlYWRlcignZXhwaXJlcycpKSB7CiAgICBleHBpcmVzID0gcmVxdWVzdC5nZXRIZWFkZXIoJ2V4cGlyZXMnKSAqIDEwMDA7CiAgfQoKICAvL1NldCAxMDByZWwgaWYgbmVjZXNzYXJ5CiAgZnVuY3Rpb24gc2V0MTAwcmVsKGgsYykgewogICAgaWYgKHJlcXVlc3QuaGFzSGVhZGVyKGgpICYmIHJlcXVlc3QuZ2V0SGVhZGVyKGgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZignMTAwcmVsJykgPj0gMCkgewogICAgICBzZWxmLnJlbDEwMCA9IGM7CiAgICB9CiAgfQogIHNldDEwMHJlbCgncmVxdWlyZScsIFNJUC5DLnN1cHBvcnRlZC5SRVFVSVJFRCk7CiAgc2V0MTAwcmVsKCdzdXBwb3J0ZWQnLCBTSVAuQy5zdXBwb3J0ZWQuU1VQUE9SVEVEKTsKCiAgLyogU2V0IHRoZSB0b190YWcgYmVmb3JlCiAgICogcmVwbHlpbmcgYSByZXNwb25zZSBjb2RlIHRoYXQgd2lsbCBjcmVhdGUgYSBkaWFsb2cuCiAgICovCiAgcmVxdWVzdC50b190YWcgPSBTSVAuVXRpbHMubmV3VGFnKCk7CgogIC8vIEFuIGVycm9yIG9uIGRpYWxvZyBjcmVhdGlvbiB3aWxsIGZpcmUgJ2ZhaWxlZCcgZXZlbnQKICBpZighdGhpcy5jcmVhdGVEaWFsb2cocmVxdWVzdCwgJ1VBUycsIHRydWUpKSB7CiAgICByZXF1ZXN0LnJlcGx5KDUwMCwgJ01pc3NpbmcgQ29udGFjdCBoZWFkZXIgZmllbGQnKTsKICAgIHJldHVybjsKICB9CgogIC8vSW5pdGlhbGl6ZSBNZWRpYSBTZXNzaW9uCiAgdGhpcy5tZWRpYUhhbmRsZXIgPSB0aGlzLm1lZGlhSGFuZGxlckZhY3RvcnkodGhpcywgewogICAgUlRDQ29uc3RyYWludHM6IHsib3B0aW9uYWwiOiBbeydEdGxzU3J0cEtleUFncmVlbWVudCc6ICd0cnVlJ31dfQogIH0pOwoKICBpZiAodGhpcy5tZWRpYUhhbmRsZXIgJiYgdGhpcy5tZWRpYUhhbmRsZXIuZ2V0UmVtb3RlU3RyZWFtcykgewogICAgdGhpcy5nZXRSZW1vdGVTdHJlYW1zID0gdGhpcy5tZWRpYUhhbmRsZXIuZ2V0UmVtb3RlU3RyZWFtcy5iaW5kKHRoaXMubWVkaWFIYW5kbGVyKTsKICAgIHRoaXMuZ2V0TG9jYWxTdHJlYW1zID0gdGhpcy5tZWRpYUhhbmRsZXIuZ2V0TG9jYWxTdHJlYW1zLmJpbmQodGhpcy5tZWRpYUhhbmRsZXIpOwogIH0KCiAgZnVuY3Rpb24gZmlyZU5ld1Nlc3Npb24oKSB7CiAgICB2YXIgb3B0aW9ucyA9IHtleHRyYUhlYWRlcnM6IFsnQ29udGFjdDogJyArIHNlbGYuY29udGFjdF19OwoKICAgIGlmIChzZWxmLnJlbDEwMCAhPT0gU0lQLkMuc3VwcG9ydGVkLlJFUVVJUkVEKSB7CiAgICAgIHNlbGYucHJvZ3Jlc3Mob3B0aW9ucyk7CiAgICB9CiAgICBzZWxmLnN0YXR1cyA9IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUjsKCiAgICAvLyBTZXQgdXNlck5vQW5zd2VyVGltZXIKICAgIHNlbGYudGltZXJzLnVzZXJOb0Fuc3dlclRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICByZXF1ZXN0LnJlcGx5KDQwOCk7CiAgICAgIHNlbGYuZmFpbGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5OT19BTlNXRVIpOwogICAgICBzZWxmLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLk5PX0FOU1dFUik7CiAgICB9LCBzZWxmLnVhLmNvbmZpZ3VyYXRpb24ubm9BbnN3ZXJUaW1lb3V0KTsKCiAgICAvKiBTZXQgZXhwaXJlc1RpbWVyCiAgICAgKiBSRkMzMjYxIDEzLjMuMQogICAgICovCiAgICBpZiAoZXhwaXJlcykgewogICAgICBzZWxmLnRpbWVycy5leHBpcmVzVGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgaWYoc2VsZi5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUikgewogICAgICAgICAgcmVxdWVzdC5yZXBseSg0ODcpOwogICAgICAgICAgc2VsZi5mYWlsZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkVYUElSRVMpOwogICAgICAgICAgc2VsZi50ZXJtaW5hdGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5FWFBJUkVTKTsKICAgICAgICB9CiAgICAgIH0sIGV4cGlyZXMpOwogICAgfQoKICAgIHNlbGYuZW1pdCgnaW52aXRlJyxyZXF1ZXN0KTsKICB9CgogIGlmICghcmVxdWVzdC5ib2R5IHx8IHRoaXMucmVuZGVyYm9keSkgewogICAgU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZpcmVOZXdTZXNzaW9uLCAwKTsKICB9IGVsc2UgewogICAgdGhpcy5oYXNPZmZlciA9IHRydWU7CiAgICB0aGlzLm1lZGlhSGFuZGxlci5zZXREZXNjcmlwdGlvbihyZXF1ZXN0LmJvZHkpCiAgICAudGhlbigKICAgICAgZmlyZU5ld1Nlc3Npb24sCiAgICAgIGZ1bmN0aW9uIG9uRmFpbHVyZSAoZSkgewogICAgICAgIHNlbGYubG9nZ2VyLndhcm4oJ2ludmFsaWQgU0RQJyk7CiAgICAgICAgc2VsZi5sb2dnZXIud2FybihlKTsKICAgICAgICByZXF1ZXN0LnJlcGx5KDQ4OCk7CiAgICAgIH0KICAgICk7CiAgfQp9OwoKSW52aXRlU2VydmVyQ29udGV4dC5wcm90b3R5cGUgPSB7CiAgcmVqZWN0OiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5JbnZhbGlkU3RhdGVFcnJvcih0aGlzLnN0YXR1cyk7CiAgICB9CgogICAgdGhpcy5sb2dnZXIubG9nKCdyZWplY3RpbmcgUlRDU2Vzc2lvbicpOwoKICAgIFNJUC5TZXJ2ZXJDb250ZXh0LnByb3RvdHlwZS5yZWplY3QuY2FsbCh0aGlzLCBvcHRpb25zKTsKICAgIHJldHVybiB0aGlzLnRlcm1pbmF0ZWQoKTsKICB9LAoKICB0ZXJtaW5hdGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIHZhcgogICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgYm9keSA9IG9wdGlvbnMuYm9keSwKICAgIGRpYWxvZywKICAgIHNlbGYgPSB0aGlzOwoKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLICYmCiAgICAgICB0aGlzLnJlcXVlc3Quc2VydmVyX3RyYW5zYWN0aW9uLnN0YXRlICE9PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgZGlhbG9nID0gdGhpcy5kaWFsb2c7CgogICAgICB0aGlzLnJlY2VpdmVSZXF1ZXN0ID0gZnVuY3Rpb24ocmVxdWVzdCkgewogICAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gU0lQLkMuQUNLKSB7CiAgICAgICAgICB0aGlzLnJlcXVlc3QoU0lQLkMuQllFLCB7CiAgICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzLAogICAgICAgICAgICBib2R5OiBib2R5CiAgICAgICAgICB9KTsKICAgICAgICAgIGRpYWxvZy50ZXJtaW5hdGUoKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICB0aGlzLnJlcXVlc3Quc2VydmVyX3RyYW5zYWN0aW9uLm9uKCdzdGF0ZUNoYW5nZWQnLCBmdW5jdGlvbigpewogICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgIHRoaXMucmVxdWVzdCA9IG5ldyBTSVAuT3V0Z29pbmdSZXF1ZXN0KAogICAgICAgICAgICBTSVAuQy5CWUUsCiAgICAgICAgICAgIHRoaXMuZGlhbG9nLnJlbW90ZV90YXJnZXQsCiAgICAgICAgICAgIHRoaXMudWEsCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAnY3NlcSc6IHRoaXMuZGlhbG9nLmxvY2FsX3NlcW51bSs9MSwKICAgICAgICAgICAgICAnY2FsbF9pZCc6IHRoaXMuZGlhbG9nLmlkLmNhbGxfaWQsCiAgICAgICAgICAgICAgJ2Zyb21fdXJpJzogdGhpcy5kaWFsb2cubG9jYWxfdXJpLAogICAgICAgICAgICAgICdmcm9tX3RhZyc6IHRoaXMuZGlhbG9nLmlkLmxvY2FsX3RhZywKICAgICAgICAgICAgICAndG9fdXJpJzogdGhpcy5kaWFsb2cucmVtb3RlX3VyaSwKICAgICAgICAgICAgICAndG9fdGFnJzogdGhpcy5kaWFsb2cuaWQucmVtb3RlX3RhZywKICAgICAgICAgICAgICAncm91dGVfc2V0JzogdGhpcy5kaWFsb2cucm91dGVfc2V0CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGV4dHJhSGVhZGVycywKICAgICAgICAgICAgYm9keQogICAgICAgICAgKTsKCiAgICAgICAgICBuZXcgU0lQLlJlcXVlc3RTZW5kZXIoCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICByZXF1ZXN0OiB0aGlzLnJlcXVlc3QsCiAgICAgICAgICAgICAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICBzZWxmLm9uUmVxdWVzdFRpbWVvdXQoKTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgc2VsZi5vblRyYW5zcG9ydEVycm9yKCk7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICByZWNlaXZlUmVzcG9uc2U6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgdGhpcy51YQogICAgICAgICAgKS5zZW5kKCk7CiAgICAgICAgICBkaWFsb2cudGVybWluYXRlKCk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIHRoaXMuZW1pdCgnYnllJywgdGhpcy5yZXF1ZXN0KTsKICAgICAgdGhpcy50ZXJtaW5hdGVkKCk7CgogICAgICAvLyBSZXN0b3JlIHRoZSBkaWFsb2cgaW50byAndGhpcycgaW4gb3JkZXIgdG8gYmUgYWJsZSB0byBzZW5kIHRoZSBpbi1kaWFsb2cgQllFIDotKQogICAgICB0aGlzLmRpYWxvZyA9IGRpYWxvZzsKCiAgICAgIC8vIFJlc3RvcmUgdGhlIGRpYWxvZyBpbnRvICd1YScgc28gdGhlIEFDSyBjYW4gcmVhY2ggJ3RoaXMnIHNlc3Npb24KICAgICAgdGhpcy51YS5kaWFsb2dzW2RpYWxvZy5pZC50b1N0cmluZygpXSA9IGRpYWxvZzsKCiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy5ieWUob3B0aW9ucyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnJlamVjdChvcHRpb25zKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKgogICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5tZWRpYV0gZ2V0cyBwYXNzZWQgdG8gU0lQLk1lZGlhSGFuZGxlci5nZXREZXNjcmlwdGlvbiBhcyBtZWRpYUhpbnQKICAgKi8KICBwcm9ncmVzczogZnVuY3Rpb24gKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogICAgdmFyCiAgICAgIHN0YXR1c0NvZGUgPSBvcHRpb25zLnN0YXR1c0NvZGUgfHwgMTgwLAogICAgICByZWFzb25QaHJhc2UgPSBvcHRpb25zLnJlYXNvblBocmFzZSwKICAgICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgICBpY2VTZXJ2ZXJzLAogICAgICBzdHVuU2VydmVycyA9IG9wdGlvbnMuc3R1blNlcnZlcnMgfHwgbnVsbCwKICAgICAgdHVyblNlcnZlcnMgPSBvcHRpb25zLnR1cm5TZXJ2ZXJzIHx8IG51bGwsCiAgICAgIGJvZHkgPSBvcHRpb25zLmJvZHksCiAgICAgIHJlc3BvbnNlOwoKICAgIGlmIChzdGF0dXNDb2RlIDwgMTAwIHx8IHN0YXR1c0NvZGUgPiAxOTkpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdGF0dXNDb2RlOiAnICsgc3RhdHVzQ29kZSk7CiAgICB9CgogICAgaWYgKHRoaXMuaXNDYW5jZWxlZCB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBpZiAoc3R1blNlcnZlcnMgfHwgdHVyblNlcnZlcnMpIHsKICAgICAgaWYgKHN0dW5TZXJ2ZXJzKSB7CiAgICAgICAgaWNlU2VydmVycyA9IFNJUC5VQS5jb25maWd1cmF0aW9uX2NoZWNrLm9wdGlvbmFsWydzdHVuU2VydmVycyddKHN0dW5TZXJ2ZXJzKTsKICAgICAgICBpZiAoIWljZVNlcnZlcnMpIHsKICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgc3R1blNlcnZlcnM6ICcrIHN0dW5TZXJ2ZXJzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5zdHVuU2VydmVycyA9IGljZVNlcnZlcnM7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodHVyblNlcnZlcnMpIHsKICAgICAgICBpY2VTZXJ2ZXJzID0gU0lQLlVBLmNvbmZpZ3VyYXRpb25fY2hlY2sub3B0aW9uYWxbJ3R1cm5TZXJ2ZXJzJ10odHVyblNlcnZlcnMpOwogICAgICAgIGlmICghaWNlU2VydmVycykgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB0dXJuU2VydmVyczogJysgdHVyblNlcnZlcnMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnR1cm5TZXJ2ZXJzID0gaWNlU2VydmVyczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMubWVkaWFIYW5kbGVyLnVwZGF0ZUljZVNlcnZlcnMoewogICAgICAgIHN0dW5TZXJ2ZXJzOiB0aGlzLnN0dW5TZXJ2ZXJzLAogICAgICAgIHR1cm5TZXJ2ZXJzOiB0aGlzLnR1cm5TZXJ2ZXJzCiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGRvMTAwcmVsKCkgewogICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovCiAgICAgIHN0YXR1c0NvZGUgPSBvcHRpb25zLnN0YXR1c0NvZGUgfHwgMTgzOwoKICAgICAgLy8gU2V0IHN0YXR1cyBhbmQgYWRkIGV4dHJhIGhlYWRlcnMKICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSzsKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcrIHRoaXMuY29udGFjdCk7CiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZXF1aXJlOiAxMDByZWwnKTsKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JTZXE6ICcgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCkpOwoKICAgICAgLy8gU2F2ZSBtZWRpYSBoaW50IGZvciBsYXRlciAocmVmZXJyZWQgc2Vzc2lvbnMpCiAgICAgIHRoaXMubWVkaWFIaW50ID0gb3B0aW9ucy5tZWRpYTsKCiAgICAgIC8vIEdldCB0aGUgc2Vzc2lvbiBkZXNjcmlwdGlvbiB0byBhZGQgdG8gcHJlYWNjZXB0IHdpdGgKICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24ob3B0aW9ucy5tZWRpYSkKICAgICAgLnRoZW4oCiAgICAgICAgZnVuY3Rpb24gb25TdWNjZXNzIChib2R5KSB7CiAgICAgICAgICBpZiAodGhpcy5pc0NhbmNlbGVkIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmVhcmx5X3NkcCA9IGJvZHk7CiAgICAgICAgICB0aGlzW3RoaXMuaGFzT2ZmZXIgPyAnaGFzQW5zd2VyJyA6ICdoYXNPZmZlciddID0gdHJ1ZTsKCiAgICAgICAgICAvLyBSZXRyYW5zbWl0IHVudGlsIHdlIGdldCBhIHJlc3BvbnNlIG9yIHdlIHRpbWUgb3V0IChzZWUgcHJhY2tUaW1lciBiZWxvdykKICAgICAgICAgIHZhciB0aW1lb3V0ID0gU0lQLlRpbWVycy5UMTsKICAgICAgICAgIHRoaXMudGltZXJzLnJlbDF4eFRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uIHJlbDF4eFJldHJhbnNtaXNzaW9uKCkgewogICAgICAgICAgICB0aGlzLnJlcXVlc3QucmVwbHkoc3RhdHVzQ29kZSwgbnVsbCwgZXh0cmFIZWFkZXJzLCBib2R5KTsKICAgICAgICAgICAgdGltZW91dCAqPSAyOwogICAgICAgICAgICB0aGlzLnRpbWVycy5yZWwxeHhUaW1lciA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChyZWwxeHhSZXRyYW5zbWlzc2lvbi5iaW5kKHRoaXMpLCB0aW1lb3V0KTsKICAgICAgICAgIH0uYmluZCh0aGlzKSwgdGltZW91dCk7CgogICAgICAgICAgLy8gVGltZW91dCBhbmQgcmVqZWN0IElOVklURSBpZiBubyByZXNwb25zZQogICAgICAgICAgdGhpcy50aW1lcnMucHJhY2tUaW1lciA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfV0FJVElOR19GT1JfUFJBQ0spIHsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmxvZygnbm8gUFJBQ0sgcmVjZWl2ZWQsIHJlamVjdGluZyB0aGUgY2FsbCcpOwogICAgICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5yZWwxeHhUaW1lcik7CiAgICAgICAgICAgIHRoaXMucmVxdWVzdC5yZXBseSg1MDQpOwogICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgU0lQLkMuY2F1c2VzLk5PX1BSQUNLKTsKICAgICAgICAgIH0uYmluZCh0aGlzKSwgU0lQLlRpbWVycy5UMSAqIDY0KTsKCiAgICAgICAgICAvLyBTZW5kIHRoZSBpbml0aWFsIHJlc3BvbnNlCiAgICAgICAgICByZXNwb25zZSA9IHRoaXMucmVxdWVzdC5yZXBseShzdGF0dXNDb2RlLCByZWFzb25QaHJhc2UsIGV4dHJhSGVhZGVycywgYm9keSk7CiAgICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UsIHJlYXNvblBocmFzZSk7CiAgICAgICAgfS5iaW5kKHRoaXMpLAoKICAgICAgICBmdW5jdGlvbiBvbkZhaWx1cmUgKCkgewogICAgICAgICAgdGhpcy5yZXF1ZXN0LnJlcGx5KDQ4MCk7CiAgICAgICAgICB0aGlzLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICB9LmJpbmQodGhpcykKICAgICAgKTsKICAgIH0gLy8gZW5kIGRvMTAwcmVsCgogICAgZnVuY3Rpb24gbm9ybWFsUmVwbHkoKSB7CiAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqLwogICAgICByZXNwb25zZSA9IHRoaXMucmVxdWVzdC5yZXBseShzdGF0dXNDb2RlLCByZWFzb25QaHJhc2UsIGV4dHJhSGVhZGVycywgYm9keSk7CiAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSwgcmVhc29uUGhyYXNlKTsKICAgIH0KCiAgICBpZiAob3B0aW9ucy5zdGF0dXNDb2RlICE9PSAxMDAgJiYKICAgICAgICAodGhpcy5yZWwxMDAgPT09IFNJUC5DLnN1cHBvcnRlZC5SRVFVSVJFRCB8fAogICAgICAgICAodGhpcy5yZWwxMDAgPT09IFNJUC5DLnN1cHBvcnRlZC5TVVBQT1JURUQgJiYgb3B0aW9ucy5yZWwxMDApIHx8CiAgICAgICAgICh0aGlzLnJlbDEwMCA9PT0gU0lQLkMuc3VwcG9ydGVkLlNVUFBPUlRFRCAmJiAodGhpcy51YS5jb25maWd1cmF0aW9uLnJlbDEwMCA9PT0gU0lQLkMuc3VwcG9ydGVkLlJFUVVJUkVEKSkpKSB7CiAgICAgIGRvMTAwcmVsLmFwcGx5KHRoaXMpOwogICAgfSBlbHNlIHsKICAgICAgbm9ybWFsUmVwbHkuYXBwbHkodGhpcyk7CiAgICB9CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKgogICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucy5tZWRpYV0gZ2V0cyBwYXNzZWQgdG8gU0lQLk1lZGlhSGFuZGxlci5nZXREZXNjcmlwdGlvbiBhcyBtZWRpYUhpbnQKICAgKi8KICBhY2NlcHQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKFNlc3Npb24uZGVzdWdhcihvcHRpb25zKSk7CiAgICBTSVAuVXRpbHMub3B0aW9uc092ZXJyaWRlKG9wdGlvbnMsICdtZWRpYScsICdtZWRpYUNvbnN0cmFpbnRzJywgdHJ1ZSwgdGhpcy5sb2dnZXIsIHRoaXMudWEuY29uZmlndXJhdGlvbi5tZWRpYSk7CiAgICB0aGlzLm1lZGlhSGludCA9IG9wdGlvbnMubWVkaWE7CgogICAgLy8gY29tbWVudGVkIG91dCBub3ctdW51c2VkIGhvbGQtcmVsYXRlZCB2YXJpYWJsZXMgZm9yIGpzaGludC4gU2VlIGJlbG93LiBKTUYgMjAxNC0xLTIxCiAgICB2YXIKICAgICAgLy9pZHgsIGxlbmd0aCwgaGFzQXVkaW8sIGhhc1ZpZGVvLAogICAgICBzZWxmID0gdGhpcywKICAgICAgcmVxdWVzdCA9IHRoaXMucmVxdWVzdCwKICAgICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgLy9tZWRpYVN0cmVhbSA9IG9wdGlvbnMubWVkaWFTdHJlYW0gfHwgbnVsbCwKICAgICAgaWNlU2VydmVycywKICAgICAgc3R1blNlcnZlcnMgPSBvcHRpb25zLnN0dW5TZXJ2ZXJzIHx8IG51bGwsCiAgICAgIHR1cm5TZXJ2ZXJzID0gb3B0aW9ucy50dXJuU2VydmVycyB8fCBudWxsLAogICAgICBzZHBDcmVhdGlvblN1Y2NlZWRlZCA9IGZ1bmN0aW9uKGJvZHkpIHsKICAgICAgICB2YXIKICAgICAgICAgIHJlc3BvbnNlLAogICAgICAgICAgLy8gcnVuIGZvciByZXBseSBzdWNjZXNzIGNhbGxiYWNrCiAgICAgICAgICByZXBseVN1Y2NlZWRlZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBzZWxmLnN0YXR1cyA9IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSzsKCiAgICAgICAgICAgIHNlbGYuc2V0SW52aXRlMnh4VGltZXIocmVxdWVzdCwgYm9keSk7CiAgICAgICAgICAgIHNlbGYuc2V0QUNLVGltZXIoKTsKICAgICAgICAgIH0sCgogICAgICAgICAgLy8gcnVuIGZvciByZXBseSBmYWlsdXJlIGNhbGxiYWNrCiAgICAgICAgICByZXBseUZhaWxlZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBzZWxmLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICAgICAgICAgIHNlbGYudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICAgICAgICB9OwoKICAgICAgICAvLyBDaHJvbWUgbWlnaHQgY2FsbCBvbmFkZHN0cmVhbSBiZWZvcmUgYWNjZXB0KCkgaXMgY2FsbGVkLCB3aGljaCBtZWFucwogICAgICAgIC8vIG1lZGlhSGFuZGxlci5yZW5kZXIoKSB3YXMgY2FsbGVkIHdpdGhvdXQgYSByZW5kZXJIaW50LCBzbyB3ZSBuZWVkIHRvCiAgICAgICAgLy8gcmUtcmVuZGVyIG5vdyB0aGF0IG1lZGlhSGludC5yZW5kZXIgaGFzIGJlZW4gc2V0LgogICAgICAgIC8vCiAgICAgICAgLy8gQ2hyb21lIHNlZW1zIHRvIGJlIGluIHRoZSByaWdodCByZWdhcmRpbmcgdGhpcywgc2VlCiAgICAgICAgLy8gaHR0cDovL2Rldi53My5vcmcvMjAxMS93ZWJydGMvZWRpdG9yL3dlYnJ0Yy5odG1sI3dpZGwtUlRDUGVlckNvbm5lY3Rpb24tb25hZGRzdHJlYW0KICAgICAgICBzZWxmLm1lZGlhSGFuZGxlci5yZW5kZXIoKTsKCiAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcgKyBzZWxmLmNvbnRhY3QpOwogICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdBbGxvdzogJyArIFNJUC5VQS5DLkFMTE9XRURfTUVUSE9EUy50b1N0cmluZygpKTsKCiAgICAgICAgaWYoIXNlbGYuaGFzT2ZmZXIpIHsKICAgICAgICAgIHNlbGYuaGFzT2ZmZXIgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWxmLmhhc0Fuc3dlciA9IHRydWU7CiAgICAgICAgfQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdC5yZXBseSgyMDAsIG51bGwsIGV4dHJhSGVhZGVycywKICAgICAgICAgICAgICAgICAgICAgIGJvZHksCiAgICAgICAgICAgICAgICAgICAgICByZXBseVN1Y2NlZWRlZCwKICAgICAgICAgICAgICAgICAgICAgIHJlcGx5RmFpbGVkCiAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgaWYgKHNlbGYuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7IC8vIERpZG4ndCBmYWlsCiAgICAgICAgICBzZWxmLmFjY2VwdGVkKHJlc3BvbnNlLCBTSVAuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKDIwMCkpOwogICAgICAgIH0KICAgICAgfSwKCiAgICAgIHNkcENyZWF0aW9uRmFpbGVkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKHNlbGYuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIC8vIFRPRE8gLSBmYWlsIG91dCBvbiBlcnJvcgogICAgICAgIHNlbGYucmVxdWVzdC5yZXBseSg0ODApOwogICAgICAgIC8vc2VsZi5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5VU0VSX0RFTklFRF9NRURJQV9BQ0NFU1MpOwogICAgICAgIHNlbGYuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5XRUJSVENfRVJST1IpOwogICAgICAgIHNlbGYudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgfTsKCiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0FOU1dFUkVEX1dBSVRJTkdfRk9SX1BSQUNLOwogICAgICByZXR1cm4gdGhpczsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUikgewogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0FOU1dFUkVEOwogICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfRUFSTFlfTUVESUEpIHsKICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICBpZiAoKHN0dW5TZXJ2ZXJzIHx8IHR1cm5TZXJ2ZXJzKSAmJgogICAgICAgICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfRUFSTFlfTUVESUEgJiYgdGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX0FOU1dFUkVEX1dBSVRJTkdfRk9SX1BSQUNLKSkgewogICAgICBpZiAoc3R1blNlcnZlcnMpIHsKICAgICAgICBpY2VTZXJ2ZXJzID0gU0lQLlVBLmNvbmZpZ3VyYXRpb25fY2hlY2sub3B0aW9uYWxbJ3N0dW5TZXJ2ZXJzJ10oc3R1blNlcnZlcnMpOwogICAgICAgIGlmICghaWNlU2VydmVycykgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdHVuU2VydmVyczogJysgc3R1blNlcnZlcnMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnN0dW5TZXJ2ZXJzID0gaWNlU2VydmVyczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0dXJuU2VydmVycykgewogICAgICAgIGljZVNlcnZlcnMgPSBTSVAuVUEuY29uZmlndXJhdGlvbl9jaGVjay5vcHRpb25hbFsndHVyblNlcnZlcnMnXSh0dXJuU2VydmVycyk7CiAgICAgICAgaWYgKCFpY2VTZXJ2ZXJzKSB7CiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHR1cm5TZXJ2ZXJzOiAnKyB0dXJuU2VydmVycyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudHVyblNlcnZlcnMgPSBpY2VTZXJ2ZXJzOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5tZWRpYUhhbmRsZXIudXBkYXRlSWNlU2VydmVycyh7CiAgICAgICAgc3R1blNlcnZlcnM6IHRoaXMuc3R1blNlcnZlcnMsCiAgICAgICAgdHVyblNlcnZlcnM6IHRoaXMudHVyblNlcnZlcnMKICAgICAgfSk7CiAgICB9CgogICAgLy8gQW4gZXJyb3Igb24gZGlhbG9nIGNyZWF0aW9uIHdpbGwgZmlyZSAnZmFpbGVkJyBldmVudAogICAgaWYoIXRoaXMuY3JlYXRlRGlhbG9nKHJlcXVlc3QsICdVQVMnKSkgewogICAgICByZXF1ZXN0LnJlcGx5KDUwMCwgJ01pc3NpbmcgQ29udGFjdCBoZWFkZXIgZmllbGQnKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMudXNlck5vQW5zd2VyVGltZXIpOwoKICAgIC8vIHRoaXMgaG9sZC1yZWxhdGVkIGNvZGUgYnJlYWtzIEZGIGFjY2VwdGluZyBuZXcgY2FsbHMgLSBKTUYgMjAxNC0xLTIxCiAgICAvKgogICAgbGVuZ3RoID0gdGhpcy5nZXRSZW1vdGVTdHJlYW1zKCkubGVuZ3RoOwoKICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICBpZiAodGhpcy5tZWRpYUhhbmRsZXIuZ2V0UmVtb3RlU3RyZWFtcygpW2lkeF0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGggPiAwKSB7CiAgICAgICAgaGFzVmlkZW8gPSB0cnVlOwogICAgICB9CiAgICAgIGlmICh0aGlzLm1lZGlhSGFuZGxlci5nZXRSZW1vdGVTdHJlYW1zKClbaWR4XS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICBoYXNBdWRpbyA9IHRydWU7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoIWhhc0F1ZGlvICYmIHRoaXMubWVkaWFDb25zdHJhaW50cy5hdWRpbyA9PT0gdHJ1ZSkgewogICAgICB0aGlzLm1lZGlhQ29uc3RyYWludHMuYXVkaW8gPSBmYWxzZTsKICAgICAgaWYgKG1lZGlhU3RyZWFtKSB7CiAgICAgICAgbGVuZ3RoID0gbWVkaWFTdHJlYW0uZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGg7CiAgICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgICBtZWRpYVN0cmVhbS5yZW1vdmVUcmFjayhtZWRpYVN0cmVhbS5nZXRBdWRpb1RyYWNrcygpW2lkeF0pOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmICghaGFzVmlkZW8gJiYgdGhpcy5tZWRpYUNvbnN0cmFpbnRzLnZpZGVvID09PSB0cnVlKSB7CiAgICAgIHRoaXMubWVkaWFDb25zdHJhaW50cy52aWRlbyA9IGZhbHNlOwogICAgICBpZiAobWVkaWFTdHJlYW0pIHsKICAgICAgICBsZW5ndGggPSBtZWRpYVN0cmVhbS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aDsKICAgICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICAgIG1lZGlhU3RyZWFtLnJlbW92ZVRyYWNrKG1lZGlhU3RyZWFtLmdldFZpZGVvVHJhY2tzKClbaWR4XSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAqLwoKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfRUFSTFlfTUVESUEpIHsKICAgICAgc2RwQ3JlYXRpb25TdWNjZWVkZWQoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMubWVkaWFIYW5kbGVyLmdldERlc2NyaXB0aW9uKHNlbGYubWVkaWFIaW50KQogICAgICAudGhlbigKICAgICAgICBzZHBDcmVhdGlvblN1Y2NlZWRlZCwKICAgICAgICBzZHBDcmVhdGlvbkZhaWxlZAogICAgICApOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIHJlY2VpdmVSZXF1ZXN0OiBmdW5jdGlvbihyZXF1ZXN0KSB7CgogICAgLy8gSVNDIFJFQ0VJVkUgUkVRVUVTVAoKICAgIGZ1bmN0aW9uIGNvbmZpcm1TZXNzaW9uKCkgewogICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi8KICAgICAgdmFyIGNvbnRlbnRUeXBlOwoKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuYWNrVGltZXIpOwogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5pbnZpdGUyeHhUaW1lcik7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICB0aGlzLnVubXV0ZSgpOwoKICAgICAgLy8gVE9ETyAtIHRoaXMgbG9naWMgYXNzdW1lcyBDb250ZW50LURpc3Bvc2l0aW9uIGRlZmF1bHRzCiAgICAgIGNvbnRlbnRUeXBlID0gcmVxdWVzdC5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpOwogICAgICBpZiAoY29udGVudFR5cGUgIT09ICdhcHBsaWNhdGlvbi9zZHAnKSB7CiAgICAgICAgdGhpcy5yZW5kZXJib2R5ID0gcmVxdWVzdC5ib2R5OwogICAgICAgIHRoaXMucmVuZGVydHlwZSA9IGNvbnRlbnRUeXBlOwogICAgICB9CiAgICB9CgogICAgc3dpdGNoKHJlcXVlc3QubWV0aG9kKSB7CiAgICBjYXNlIFNJUC5DLkNBTkNFTDoKICAgICAgLyogUkZDMzI2MSAxNSBTdGF0ZXMgdGhhdCBhIFVBUyBtYXkgaGF2ZSBhY2NlcHRlZCBhbiBpbnZpdGF0aW9uIHdoaWxlIGEgQ0FOQ0VMCiAgICAgICAqIHdhcyBpbiBwcm9ncmVzcyBhbmQgdGhhdCB0aGUgVUFDIE1BWSBjb250aW51ZSB3aXRoIHRoZSBzZXNzaW9uIGVzdGFibGlzaGVkIGJ5CiAgICAgICAqIGFueSAyeHggcmVzcG9uc2UsIG9yIE1BWSB0ZXJtaW5hdGUgd2l0aCBCWUUuIFNJUCBkb2VzIGNvbnRpbnVlIHdpdGggdGhlCiAgICAgICAqIGVzdGFibGlzaGVkIHNlc3Npb24uIFNvIHRoZSBDQU5DRUwgaXMgcHJvY2Vzc2VkIG9ubHkgaWYgdGhlIHNlc3Npb24gaXMgbm90IHlldAogICAgICAgKiBlc3RhYmxpc2hlZC4KICAgICAgICovCgogICAgICAvKgogICAgICAgKiBUZXJtaW5hdGUgdGhlIHdob2xlIHNlc3Npb24gaW4gY2FzZSB0aGUgdXNlciBkaWRuJ3QgYWNjZXB0IChvciB5ZXQgdG8gc2VuZCB0aGUgYW5zd2VyKSBub3IgcmVqZWN0IHRoZQogICAgICAgKnJlcXVlc3Qgb3BlbmluZyB0aGUgc2Vzc2lvbi4KICAgICAgICovCiAgICAgIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BTlNXRVIgfHwKICAgICAgICAgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLIHx8CiAgICAgICAgIHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSyB8fAogICAgICAgICB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfRUFSTFlfTUVESUEgfHwKICAgICAgICAgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0FOU1dFUkVEKSB7CgogICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ0FOQ0VMRUQ7CiAgICAgICAgdGhpcy5yZXF1ZXN0LnJlcGx5KDQ4Nyk7CiAgICAgICAgdGhpcy5jYW5jZWxlZChyZXF1ZXN0KTsKICAgICAgICB0aGlzLnJlamVjdGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5DQU5DRUxFRCk7CiAgICAgICAgdGhpcy5mYWlsZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkNBTkNFTEVEKTsKICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkNBTkNFTEVEKTsKICAgICAgfQogICAgICBicmVhazsKICAgIGNhc2UgU0lQLkMuQUNLOgogICAgICBpZih0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLKSB7CiAgICAgICAgaWYgKCF0aGlzLmhhc0Fuc3dlcikgewogICAgICAgICAgaWYocmVxdWVzdC5ib2R5ICYmIHJlcXVlc3QuZ2V0SGVhZGVyKCdjb250ZW50LXR5cGUnKSA9PT0gJ2FwcGxpY2F0aW9uL3NkcCcpIHsKICAgICAgICAgICAgLy8gQUNLIGNvbnRhaW5zIGFuc3dlciB0byBhbiBJTlZJVEUgdy9vIFNEUCBuZWdvdGlhdGlvbgogICAgICAgICAgICBTSVAuSGFja3MuRmlyZWZveC5jYW5ub3RIYW5kbGVFeHRyYVdoaXRlc3BhY2UocmVxdWVzdCk7CiAgICAgICAgICAgIFNJUC5IYWNrcy5BbGxCcm93c2Vycy5tYXNrRHRscyhyZXF1ZXN0KTsKCiAgICAgICAgICAgIHRoaXMuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuc2V0RGVzY3JpcHRpb24ocmVxdWVzdC5ib2R5KQogICAgICAgICAgICAudGhlbigKICAgICAgICAgICAgICBjb25maXJtU2Vzc2lvbi5iaW5kKHRoaXMpLAogICAgICAgICAgICAgIGZ1bmN0aW9uIG9uRmFpbHVyZSAoZSkgewogICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIud2FybihlKTsKICAgICAgICAgICAgICAgIHRoaXMudGVybWluYXRlKHsKICAgICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogJzQ4OCcsCiAgICAgICAgICAgICAgICAgIHJlYXNvblBocmFzZTogJ0JhZCBNZWRpYSBEZXNjcmlwdGlvbicKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGhpcy5mYWlsZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpCiAgICAgICAgICAgICk7CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZWFybHlfc2RwKSB7CiAgICAgICAgICAgIGNvbmZpcm1TZXNzaW9uLmFwcGx5KHRoaXMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy9UT0RPOiBQYXNzIHRvIG1lZGlhaGFuZGxlcgogICAgICAgICAgICB0aGlzLmZhaWxlZChyZXF1ZXN0LCBTSVAuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25maXJtU2Vzc2lvbi5hcHBseSh0aGlzKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlIFNJUC5DLlBSQUNLOgogICAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICAgIC8vbG9jYWxNZWRpYSA9IHNlc3Npb24ubWVkaWFIYW5kbGVyLmxvY2FsTWVkaWE7CiAgICAgICAgaWYoIXRoaXMuaGFzQW5zd2VyKSB7CiAgICAgICAgICBpZihyZXF1ZXN0LmJvZHkgJiYgcmVxdWVzdC5nZXRIZWFkZXIoJ2NvbnRlbnQtdHlwZScpID09PSAnYXBwbGljYXRpb24vc2RwJykgewogICAgICAgICAgICB0aGlzLmhhc0Fuc3dlciA9IHRydWU7CiAgICAgICAgICAgIHRoaXMubWVkaWFIYW5kbGVyLnNldERlc2NyaXB0aW9uKHJlcXVlc3QuYm9keSkKICAgICAgICAgICAgLnRoZW4oCiAgICAgICAgICAgICAgZnVuY3Rpb24gb25TdWNjZXNzICgpIHsKICAgICAgICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnJlbDF4eFRpbWVyKTsKICAgICAgICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnByYWNrVGltZXIpOwogICAgICAgICAgICAgICAgcmVxdWVzdC5yZXBseSgyMDApOwogICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0VBUkxZX01FRElBOwogICAgICAgICAgICAgICAgICB0aGlzLmFjY2VwdCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgICAgICAgIC8vUkVWSVNJVAogICAgICAgICAgICAgICAgdGhpcy5tdXRlKCk7CiAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLAogICAgICAgICAgICAgIGZ1bmN0aW9uIG9uRmFpbHVyZSAoZSkgewogICAgICAgICAgICAgICAgLy9UT0RPOiBTZW5kIHRvIG1lZGlhIGhhbmRsZXIKICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oZSk7CiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZSh7CiAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6ICc0ODgnLAogICAgICAgICAgICAgICAgICByZWFzb25QaHJhc2U6ICdCYWQgTWVkaWEgRGVzY3JpcHRpb24nCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRoaXMuZmFpbGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICAgIH0uYmluZCh0aGlzKQogICAgICAgICAgICApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGUoewogICAgICAgICAgICAgIHN0YXR1c0NvZGU6ICc0ODgnLAogICAgICAgICAgICAgIHJlYXNvblBocmFzZTogJ0JhZCBNZWRpYSBEZXNjcmlwdGlvbicKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuZmFpbGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnJlbDF4eFRpbWVyKTsKICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnByYWNrVGltZXIpOwogICAgICAgICAgcmVxdWVzdC5yZXBseSgyMDApOwoKICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0spIHsKICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgICAgdGhpcy5hY2NlcHQoKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfRUFSTFlfTUVESUE7CiAgICAgICAgICAvL1JFVklTSVQKICAgICAgICAgIHRoaXMubXV0ZSgpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19FQVJMWV9NRURJQSkgewogICAgICAgIHJlcXVlc3QucmVwbHkoMjAwKTsKICAgICAgfQogICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgIFNlc3Npb24ucHJvdG90eXBlLnJlY2VpdmVSZXF1ZXN0LmFwcGx5KHRoaXMsIFtyZXF1ZXN0XSk7CiAgICAgIGJyZWFrOwogICAgfQogIH0sCgogIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQgJiYgdGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5mYWlsZWQobnVsbCwgU0lQLkMuY2F1c2VzLkNPTk5FQ1RJT05fRVJST1IpOwogICAgfQogIH0sCgogIG9uUmVxdWVzdFRpbWVvdXQ6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICB0aGlzLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgICAgdGhpcy50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfQogIH0KCn07CgpTSVAuSW52aXRlU2VydmVyQ29udGV4dCA9IEludml0ZVNlcnZlckNvbnRleHQ7CgpJbnZpdGVDbGllbnRDb250ZXh0ID0gZnVuY3Rpb24odWEsIHRhcmdldCwgb3B0aW9ucykgewogIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKFNlc3Npb24uZGVzdWdhcihvcHRpb25zKSk7CiAgb3B0aW9ucy5wYXJhbXMgPSBPYmplY3QuY3JlYXRlKG9wdGlvbnMucGFyYW1zIHx8IE9iamVjdC5wcm90b3R5cGUpOwoKICB2YXIgaWNlU2VydmVycywKICAgIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKSwKICAgIHN0dW5TZXJ2ZXJzID0gb3B0aW9ucy5zdHVuU2VydmVycyB8fCBudWxsLAogICAgdHVyblNlcnZlcnMgPSBvcHRpb25zLnR1cm5TZXJ2ZXJzIHx8IG51bGwsCiAgICBtZWRpYUhhbmRsZXJGYWN0b3J5ID0gb3B0aW9ucy5tZWRpYUhhbmRsZXJGYWN0b3J5IHx8IHVhLmNvbmZpZ3VyYXRpb24ubWVkaWFIYW5kbGVyRmFjdG9yeSwKICAgIGlzTWVkaWFTdXBwb3J0ZWQgPSBtZWRpYUhhbmRsZXJGYWN0b3J5LmlzU3VwcG9ydGVkOwoKICAvLyBDaGVjayBXZWJSVEMgc3VwcG9ydAogIGlmIChpc01lZGlhU3VwcG9ydGVkICYmICFpc01lZGlhU3VwcG9ydGVkKCkpIHsKICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5Ob3RTdXBwb3J0ZWRFcnJvcignTWVkaWEgbm90IHN1cHBvcnRlZCcpOwogIH0KCiAgdGhpcy5SVENDb25zdHJhaW50cyA9IG9wdGlvbnMuUlRDQ29uc3RyYWludHMgfHwge307CiAgdGhpcy5pbnZpdGVXaXRob3V0U2RwID0gb3B0aW9ucy5pbnZpdGVXaXRob3V0U2RwIHx8IGZhbHNlOwoKICAvLyBTZXQgYW5vbnltb3VzIHByb3BlcnR5CiAgdGhpcy5hbm9ueW1vdXMgPSBvcHRpb25zLmFub255bW91cyB8fCBmYWxzZTsKCiAgLy8gQ3VzdG9tIGRhdGEgdG8gYmUgc2VudCBlaXRoZXIgaW4gSU5WSVRFIG9yIGluIEFDSwogIHRoaXMucmVuZGVyYm9keSA9IG9wdGlvbnMucmVuZGVyYm9keSB8fCBudWxsOwogIHRoaXMucmVuZGVydHlwZSA9IG9wdGlvbnMucmVuZGVydHlwZSB8fCAndGV4dC9wbGFpbic7CgogIG9wdGlvbnMucGFyYW1zLmZyb21fdGFnID0gdGhpcy5mcm9tX3RhZzsKCiAgLyogRG8gbm90IGFkZCA7b2IgaW4gaW5pdGlhbCBmb3JtaW5nIGRpYWxvZyByZXF1ZXN0cyBpZiB0aGUgcmVnaXN0cmF0aW9uIG92ZXIKICAgKiAgdGhlIGN1cnJlbnQgY29ubmVjdGlvbiBnb3QgYSBHUlVVIFVSSS4KICAgKi8KICB0aGlzLmNvbnRhY3QgPSB1YS5jb250YWN0LnRvU3RyaW5nKHsKICAgIGFub255bW91czogdGhpcy5hbm9ueW1vdXMsCiAgICBvdXRib3VuZDogdGhpcy5hbm9ueW1vdXMgPyAhdWEuY29udGFjdC50ZW1wX2dydXUgOiAhdWEuY29udGFjdC5wdWJfZ3J1dQogIH0pOwoKICBpZiAodGhpcy5hbm9ueW1vdXMpIHsKICAgIG9wdGlvbnMucGFyYW1zLmZyb21fZGlzcGxheU5hbWUgPSAnQW5vbnltb3VzJzsKICAgIG9wdGlvbnMucGFyYW1zLmZyb21fdXJpID0gJ3NpcDphbm9ueW1vdXNAYW5vbnltb3VzLmludmFsaWQnOwoKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdQLVByZWZlcnJlZC1JZGVudGl0eTogJysgdWEuY29uZmlndXJhdGlvbi51cmkudG9TdHJpbmcoKSk7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnUHJpdmFjeTogaWQnKTsKICB9CiAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcrIHRoaXMuY29udGFjdCk7CiAgZXh0cmFIZWFkZXJzLnB1c2goJ0FsbG93OiAnKyBTSVAuVUEuQy5BTExPV0VEX01FVEhPRFMudG9TdHJpbmcoKSk7CiAgaWYgKCF0aGlzLmludml0ZVdpdGhvdXRTZHApIHsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3NkcCcpOwogIH0gZWxzZSBpZiAodGhpcy5yZW5kZXJib2R5KSB7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgdGhpcy5yZW5kZXJ0eXBlKTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LURpc3Bvc2l0aW9uOiByZW5kZXI7aGFuZGxpbmc9b3B0aW9uYWwnKTsKICB9CgogIGlmICh1YS5jb25maWd1cmF0aW9uLnJlbDEwMCA9PT0gU0lQLkMuc3VwcG9ydGVkLlJFUVVJUkVEKSB7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnUmVxdWlyZTogMTAwcmVsJyk7CiAgfQogIGlmICh1YS5jb25maWd1cmF0aW9uLnJlcGxhY2VzID09PSBTSVAuQy5zdXBwb3J0ZWQuUkVRVUlSRUQpIHsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZXF1aXJlOiByZXBsYWNlcycpOwogIH0KCiAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSBleHRyYUhlYWRlcnM7CgogIFNJUC5VdGlscy5hdWdtZW50KHRoaXMsIFNJUC5DbGllbnRDb250ZXh0LCBbdWEsIFNJUC5DLklOVklURSwgdGFyZ2V0LCBvcHRpb25zXSk7CiAgU0lQLlV0aWxzLmF1Z21lbnQodGhpcywgU0lQLlNlc3Npb24sIFttZWRpYUhhbmRsZXJGYWN0b3J5XSk7CgogIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19OVUxMKSB7CiAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogIH0KCiAgLy8gU2Vzc2lvbiBwYXJhbWV0ZXIgaW5pdGlhbGl6YXRpb24KICB0aGlzLmZyb21fdGFnID0gU0lQLlV0aWxzLm5ld1RhZygpOwoKICAvLyBPdXRnb2luZ1Nlc3Npb24gc3BlY2lmaWMgcGFyYW1ldGVycwogIHRoaXMuaXNDYW5jZWxlZCA9IGZhbHNlOwogIHRoaXMucmVjZWl2ZWRfMTAwID0gZmFsc2U7CgogIHRoaXMubWV0aG9kID0gU0lQLkMuSU5WSVRFOwoKICB0aGlzLnJlY2VpdmVOb25JbnZpdGVSZXNwb25zZSA9IHRoaXMucmVjZWl2ZVJlc3BvbnNlOwogIHRoaXMucmVjZWl2ZVJlc3BvbnNlID0gdGhpcy5yZWNlaXZlSW52aXRlUmVzcG9uc2U7CgogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAuaW52aXRlY2xpZW50Y29udGV4dCcpOwoKICBpZiAoc3R1blNlcnZlcnMpIHsKICAgIGljZVNlcnZlcnMgPSBTSVAuVUEuY29uZmlndXJhdGlvbl9jaGVjay5vcHRpb25hbFsnc3R1blNlcnZlcnMnXShzdHVuU2VydmVycyk7CiAgICBpZiAoIWljZVNlcnZlcnMpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdHVuU2VydmVyczogJysgc3R1blNlcnZlcnMpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zdHVuU2VydmVycyA9IGljZVNlcnZlcnM7CiAgICB9CiAgfQoKICBpZiAodHVyblNlcnZlcnMpIHsKICAgIGljZVNlcnZlcnMgPSBTSVAuVUEuY29uZmlndXJhdGlvbl9jaGVjay5vcHRpb25hbFsndHVyblNlcnZlcnMnXSh0dXJuU2VydmVycyk7CiAgICBpZiAoIWljZVNlcnZlcnMpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB0dXJuU2VydmVyczogJysgdHVyblNlcnZlcnMpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy50dXJuU2VydmVycyA9IGljZVNlcnZlcnM7CiAgICB9CiAgfQoKICB1YS5hcHBsaWNhbnRzW3RoaXNdID0gdGhpczsKCiAgdGhpcy5pZCA9IHRoaXMucmVxdWVzdC5jYWxsX2lkICsgdGhpcy5mcm9tX3RhZzsKCiAgLy9Jbml0aWFsaXplIE1lZGlhIFNlc3Npb24KICB0aGlzLm1lZGlhSGFuZGxlciA9IHRoaXMubWVkaWFIYW5kbGVyRmFjdG9yeSh0aGlzLCB7CiAgICBSVENDb25zdHJhaW50czogdGhpcy5SVENDb25zdHJhaW50cywKICAgIHN0dW5TZXJ2ZXJzOiB0aGlzLnN0dW5TZXJ2ZXJzLAogICAgdHVyblNlcnZlcnM6IHRoaXMudHVyblNlcnZlcnMKICB9KTsKCiAgaWYgKHRoaXMubWVkaWFIYW5kbGVyICYmIHRoaXMubWVkaWFIYW5kbGVyLmdldFJlbW90ZVN0cmVhbXMpIHsKICAgIHRoaXMuZ2V0UmVtb3RlU3RyZWFtcyA9IHRoaXMubWVkaWFIYW5kbGVyLmdldFJlbW90ZVN0cmVhbXMuYmluZCh0aGlzLm1lZGlhSGFuZGxlcik7CiAgICB0aGlzLmdldExvY2FsU3RyZWFtcyA9IHRoaXMubWVkaWFIYW5kbGVyLmdldExvY2FsU3RyZWFtcy5iaW5kKHRoaXMubWVkaWFIYW5kbGVyKTsKICB9CgogIFNJUC5VdGlscy5vcHRpb25zT3ZlcnJpZGUob3B0aW9ucywgJ21lZGlhJywgJ21lZGlhQ29uc3RyYWludHMnLCB0cnVlLCB0aGlzLmxvZ2dlciwgdGhpcy51YS5jb25maWd1cmF0aW9uLm1lZGlhKTsKICB0aGlzLm1lZGlhSGludCA9IG9wdGlvbnMubWVkaWE7Cn07CgpJbnZpdGVDbGllbnRDb250ZXh0LnByb3RvdHlwZSA9IHsKICBpbnZpdGU6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAvL1NhdmUgdGhlIHNlc3Npb24gaW50byB0aGUgdWEgc2Vzc2lvbnMgY29sbGVjdGlvbi4KICAgIC8vTm90ZTogcGxhY2luZyBpbiBjb25zdHJ1Y3RvciBicmVha3MgY2FsbCB0byByZXF1ZXN0LmNhbmNlbCBvbiBjbG9zZS4uLiBVc2VyIGRvZXMgbm90IG5lZWQgdGhpcyBhbnl3YXkKICAgIHRoaXMudWEuc2Vzc2lvbnNbdGhpcy5pZF0gPSB0aGlzOwoKICAgIC8vTm90ZTogZHVlIHRvIHRoZSB3YXkgRmlyZWZveCBoYW5kbGVzIGdVTSBjYWxscywgaXQgaXMgcmVjb21tZW5kZWQgdG8gbWFrZSB0aGUgZ1VNIGNhbGwgYXQgdGhlIGFwcCBsZXZlbAogICAgLy8gYW5kIGhhbmQgc2lwLmpzIGEgc3RyZWFtIGFzIHRoZSBtZWRpYUhpbnQKICAgIGlmICh0aGlzLmludml0ZVdpdGhvdXRTZHApIHsKICAgICAgLy9qdXN0IHNlbmQgYW4gaW52aXRlIHdpdGggbm8gc2RwLi4uCiAgICAgIHRoaXMucmVxdWVzdC5ib2R5ID0gc2VsZi5yZW5kZXJib2R5OwogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0lOVklURV9TRU5UOwogICAgICB0aGlzLnNlbmQoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMubWVkaWFIYW5kbGVyLmdldERlc2NyaXB0aW9uKHNlbGYubWVkaWFIaW50KQogICAgICAudGhlbigKICAgICAgICBmdW5jdGlvbiBvblN1Y2Nlc3Mob2ZmZXIpIHsKICAgICAgICAgIGlmIChzZWxmLmlzQ2FuY2VsZWQgfHwgc2VsZi5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgc2VsZi5oYXNPZmZlciA9IHRydWU7CiAgICAgICAgICBzZWxmLnJlcXVlc3QuYm9keSA9IG9mZmVyOwogICAgICAgICAgc2VsZi5zdGF0dXMgPSBDLlNUQVRVU19JTlZJVEVfU0VOVDsKICAgICAgICAgIHNlbGYuc2VuZCgpOwogICAgICAgIH0sCiAgICAgICAgZnVuY3Rpb24gb25GYWlsdXJlKCkgewogICAgICAgICAgaWYgKHNlbGYuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIC8vIFRPRE8uLi5mYWlsIG91dAogICAgICAgICAgLy9zZWxmLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuVVNFUl9ERU5JRURfTUVESUFfQUNDRVNTKTsKICAgICAgICAgIC8vc2VsZi5mYWlsZWQobnVsbCwgU0lQLkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgICBzZWxmLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICAgIHNlbGYudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICB9CiAgICAgICk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgcmVjZWl2ZUludml0ZVJlc3BvbnNlOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgdmFyIGNhdXNlLCAvL2xvY2FsTWVkaWEsCiAgICAgIHNlc3Npb24gPSB0aGlzLAogICAgICBpZCA9IHJlc3BvbnNlLmNhbGxfaWQgKyByZXNwb25zZS5mcm9tX3RhZyArIHJlc3BvbnNlLnRvX3RhZywKICAgICAgZXh0cmFIZWFkZXJzID0gW10sCiAgICAgIG9wdGlvbnMgPSB7fTsKCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQgfHwgcmVzcG9uc2UubWV0aG9kICE9PSBTSVAuQy5JTlZJVEUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0aGlzLmRpYWxvZyAmJiAocmVzcG9uc2Uuc3RhdHVzX2NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlIDw9IDI5OSkpIHsKICAgICAgaWYgKGlkICE9PSB0aGlzLmRpYWxvZy5pZC50b1N0cmluZygpICkgewogICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnLCB0cnVlKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0uc2VuZFJlcXVlc3QodGhpcywgU0lQLkMuQUNLLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keTogU0lQLlV0aWxzLmdlbmVyYXRlRmFrZVNEUChyZXNwb25zZS5ib2R5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0uc2VuZFJlcXVlc3QodGhpcywgU0lQLkMuQllFKTsKCiAgICAgICAgLyogTk9URTogVGhpcyBmYWlscyBiZWNhdXNlIHRoZSBmb3JraW5nIHByb3h5IGRvZXMgbm90IHJlY29nbml6ZSB0aGF0IGFuIHVuYW5zd2VyYWJsZQogICAgICAgICAqIGxlZyAoZHVlIHRvIHBlZXJDb25uZWN0aW9uIGxpbWl0YXRpb25zKSBoYXMgYmVlbiBhbnN3ZXJlZCBmaXJzdC4gSWYgeW91ciBmb3JraW5nCiAgICAgICAgICogcHJveHkgZG9lcyBub3QgaGFuZyB1cCBhbGwgdW5hbnN3ZXJlZCBicmFuY2hlcyBvbiB0aGUgZmlyc3QgYnJhbmNoIGFuc3dlcmVkLCByZW1vdmUgdGhpcy4KICAgICAgICAgKi8KICAgICAgICBpZih0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgICAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgU0lQLkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5XRUJSVENfRVJST1IpOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuQUNLLHtjc2VxOiByZXNwb25zZS5jc2VxfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLmhhc0Fuc3dlcikgewogICAgICAgIC8vIGludml0ZSB3L28gc2RwIGlzIHdhaXRpbmcgZm9yIGNhbGxiYWNrCiAgICAgICAgLy9hbiBpbnZpdGUgd2l0aCBzZHAgbXVzdCBnbyBvbiwgYW5kIGhhc0Fuc3dlciBpcyB0cnVlCiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXMuZGlhbG9nICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlIDwgMjAwKSB7CiAgICAgIC8qCiAgICAgICAgRWFybHkgbWVkaWEgaGFzIGJlZW4gc2V0IHVwIHdpdGggYXQgbGVhc3Qgb25lIG90aGVyIGRpZmZlcmVudCBicmFuY2gsCiAgICAgICAgYnV0IGEgZmluYWwgMnh4IHJlc3BvbnNlIGhhc24ndCBiZWVuIHJlY2VpdmVkCiAgICAgICovCiAgICAgIGlmICh0aGlzLmRpYWxvZy5wcmFja2VkLmluZGV4T2YocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpICE9PSAtMSB8fAogICAgICAgICAgKHRoaXMuZGlhbG9nLnByYWNrZWRbdGhpcy5kaWFsb2cucHJhY2tlZC5sZW5ndGgtMV0gPj0gcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgJiYgdGhpcy5kaWFsb2cucHJhY2tlZC5sZW5ndGggPiAwKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmVhcmx5RGlhbG9nc1tpZF0gJiYgIXRoaXMuY3JlYXRlRGlhbG9nKHJlc3BvbnNlLCAnVUFDJywgdHJ1ZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5pbmRleE9mKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKSAhPT0gLTEgfHwKICAgICAgICAgICh0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZFt0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5sZW5ndGgtMV0gPj0gcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgJiYgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQubGVuZ3RoID4gMCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSQWNrOiAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgKyAnICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ2NzZXEnKSk7CiAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLnB1c2gocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpOwoKICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnNlbmRSZXF1ZXN0KHRoaXMsIFNJUC5DLlBSQUNLLCB7CiAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICAgICAgYm9keTogU0lQLlV0aWxzLmdlbmVyYXRlRmFrZVNEUChyZXNwb25zZS5ib2R5KQogICAgICB9KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIFByb2NlZWQgdG8gY2FuY2VsbGF0aW9uIGlmIHRoZSB1c2VyIHJlcXVlc3RlZC4KICAgIGlmKHRoaXMuaXNDYW5jZWxlZCkgewogICAgICBpZihyZXNwb25zZS5zdGF0dXNfY29kZSA+PSAxMDAgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPCAyMDApIHsKICAgICAgICB0aGlzLnJlcXVlc3QuY2FuY2VsKHRoaXMuY2FuY2VsUmVhc29uKTsKICAgICAgICB0aGlzLmNhbmNlbGVkKG51bGwpOwogICAgICB9IGVsc2UgaWYocmVzcG9uc2Uuc3RhdHVzX2NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlIDwgMjk5KSB7CiAgICAgICAgdGhpcy5hY2NlcHRBbmRUZXJtaW5hdGUocmVzcG9uc2UpOwogICAgICAgIHRoaXMuZW1pdCgnYnllJywgdGhpcy5yZXF1ZXN0KTsKICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXNfY29kZSA+PSAzMDApIHsKICAgICAgICBjYXVzZSA9IFNJUC5DLlJFQVNPTl9QSFJBU0VbcmVzcG9uc2Uuc3RhdHVzX2NvZGVdIHx8IFNJUC5DLmNhdXNlcy5DQU5DRUxFRDsKICAgICAgICB0aGlzLnJlamVjdGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgc3dpdGNoKHRydWUpIHsKICAgICAgY2FzZSAvXjEwMCQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgIHRoaXMucmVjZWl2ZWRfMTAwID0gdHJ1ZTsKICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICgvXjFbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpKToKICAgICAgICAvLyBEbyBub3RoaW5nIHdpdGggMXh4IHJlc3BvbnNlcyB3aXRob3V0IFRvIHRhZy4KICAgICAgICBpZighcmVzcG9uc2UudG9fdGFnKSB7CiAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCcxeHggcmVzcG9uc2UgcmVjZWl2ZWQgd2l0aG91dCB0byB0YWcnKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgLy8gQ3JlYXRlIEVhcmx5IERpYWxvZyBpZiAxWFggY29tZXMgd2l0aCBjb250YWN0CiAgICAgICAgaWYocmVzcG9uc2UuaGFzSGVhZGVyKCdjb250YWN0JykpIHsKICAgICAgICAgIC8vIEFuIGVycm9yIG9uIGRpYWxvZyBjcmVhdGlvbiB3aWxsIGZpcmUgJ2ZhaWxlZCcgZXZlbnQKICAgICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnLCB0cnVlKSkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfMVhYX1JFQ0VJVkVEOwoKICAgICAgICBpZihyZXNwb25zZS5oYXNIZWFkZXIoJ3JlcXVpcmUnKSAmJgogICAgICAgICAgIHJlc3BvbnNlLmdldEhlYWRlcigncmVxdWlyZScpLmluZGV4T2YoJzEwMHJlbCcpICE9PSAtMSkgewoKICAgICAgICAgIC8vIERvIG5vdGhpbmcgaWYgdGhpcy5kaWFsb2cgaXMgYWxyZWFkeSBjb25maXJtZWQKICAgICAgICAgIGlmICh0aGlzLmRpYWxvZyB8fCAhdGhpcy5lYXJseURpYWxvZ3NbaWRdKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5pbmRleE9mKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKSAhPT0gLTEgfHwKICAgICAgICAgICAgICAodGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWRbdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQubGVuZ3RoLTFdID49IHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpICYmIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLmxlbmd0aCA+IDApKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBTSVAuSGFja3MuRmlyZWZveC5jYW5ub3RIYW5kbGVFeHRyYVdoaXRlc3BhY2UocmVzcG9uc2UpOwogICAgICAgICAgU0lQLkhhY2tzLkFsbEJyb3dzZXJzLm1hc2tEdGxzKHJlc3BvbnNlKTsKCiAgICAgICAgICBpZiAoIXJlc3BvbnNlLmJvZHkpIHsKICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JBY2s6ICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSArICcgJyArIHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKTsKICAgICAgICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQucHVzaChyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSk7CiAgICAgICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5zZW5kUmVxdWVzdCh0aGlzLCBTSVAuQy5QUkFDSywgewogICAgICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwoKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5oYXNPZmZlcikgewogICAgICAgICAgICBpZiAoIXRoaXMuY3JlYXRlRGlhbG9nKHJlc3BvbnNlLCAnVUFDJykpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmhhc0Fuc3dlciA9IHRydWU7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nLnByYWNrZWQucHVzaChyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSk7CgogICAgICAgICAgICB0aGlzLm1lZGlhSGFuZGxlci5zZXREZXNjcmlwdGlvbihyZXNwb25zZS5ib2R5KQogICAgICAgICAgICAudGhlbigKICAgICAgICAgICAgICBmdW5jdGlvbiBvblN1Y2Nlc3MgKCkgewogICAgICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JBY2s6ICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSArICcgJyArIHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKTsKCiAgICAgICAgICAgICAgICBzZXNzaW9uLnNlbmRSZXF1ZXN0KFNJUC5DLlBSQUNLLCB7CiAgICAgICAgICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzLAogICAgICAgICAgICAgICAgICByZWNlaXZlUmVzcG9uc2U6IGZ1bmN0aW9uKCkge30KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgICAgICAgIHNlc3Npb24ubXV0ZSgpOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICBpZiAoc2Vzc2lvbi5zdGF0dXMgPT09IEMuU1RBVFVTX0VBUkxZX01FRElBKSB7CiAgICAgICAgICAgICAgICAgIGxvY2FsTWVkaWEgPSBzZXNzaW9uLm1lZGlhSGFuZGxlci5sb2NhbE1lZGlhOwogICAgICAgICAgICAgICAgICBpZiAobG9jYWxNZWRpYS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICBsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKClbMF0uZW5hYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKVswXS5lbmFibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0qLwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZnVuY3Rpb24gb25GYWlsdXJlIChlKSB7CiAgICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2dlci53YXJuKGUpOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5hY2NlcHRBbmRUZXJtaW5hdGUocmVzcG9uc2UsIDQ4OCwgJ05vdCBBY2NlcHRhYmxlIEhlcmUnKTsKICAgICAgICAgICAgICAgIHNlc3Npb24uZmFpbGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgZWFybHlEaWFsb2cgPSB0aGlzLmVhcmx5RGlhbG9nc1tpZF07CiAgICAgICAgICAgIHZhciBlYXJseU1lZGlhID0gZWFybHlEaWFsb2cubWVkaWFIYW5kbGVyOwoKICAgICAgICAgICAgZWFybHlEaWFsb2cucHJhY2tlZC5wdXNoKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKTsKCiAgICAgICAgICAgIGVhcmx5TWVkaWEuc2V0RGVzY3JpcHRpb24ocmVzcG9uc2UuYm9keSkKICAgICAgICAgICAgLnRoZW4oZWFybHlNZWRpYS5nZXREZXNjcmlwdGlvbi5iaW5kKGVhcmx5TWVkaWEsIHNlc3Npb24ubWVkaWFIaW50KSkKICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gb25TdWNjZXNzKHNkcCkgewogICAgICAgICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3NkcCcpOwogICAgICAgICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSQWNrOiAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgKyAnICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ2NzZXEnKSk7CiAgICAgICAgICAgICAgZWFybHlEaWFsb2cuc2VuZFJlcXVlc3Qoc2Vzc2lvbiwgU0lQLkMuUFJBQ0ssIHsKICAgICAgICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzLAogICAgICAgICAgICAgICAgYm9keTogc2RwCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgc2Vzc2lvbi5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgICAgICBzZXNzaW9uLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gb25GYWlsdXJlKGUpIHsKICAgICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFNJUC5FeGNlcHRpb25zLkdldERlc2NyaXB0aW9uRXJyb3IpIHsKICAgICAgICAgICAgICAgIGVhcmx5RGlhbG9nLnByYWNrZWQucHVzaChyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSk7CiAgICAgICAgICAgICAgICBpZiAoc2Vzc2lvbi5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gVE9ETyAtIGZhaWwgb3V0IG9uIGVycm9yCiAgICAgICAgICAgICAgICAvLyBzZXNzaW9uLmZhaWxlZChndW0gZXJyb3IpOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5mYWlsZWQobnVsbCwgU0lQLkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgICAgICAgICBzZXNzaW9uLnRlcm1pbmF0ZWQobnVsbCwgU0lQLkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVhcmx5RGlhbG9nLnByYWNrZWQuc3BsaWNlKGVhcmx5RGlhbG9nLnByYWNrZWQuaW5kZXhPZihyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSksIDEpOwogICAgICAgICAgICAgICAgLy8gQ291bGQgbm90IHNldCByZW1vdGUgZGVzY3JpcHRpb24KICAgICAgICAgICAgICAgIHNlc3Npb24ubG9nZ2VyLndhcm4oJ2ludmFsaWQgU0RQJyk7CiAgICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2dlci53YXJuKGUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIC9eMlswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgdmFyIGNzZXEgPSB0aGlzLnJlcXVlc3QuY3NlcSArICcgJyArIHRoaXMucmVxdWVzdC5tZXRob2Q7CiAgICAgICAgaWYgKGNzZXEgIT09IHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfRUFSTFlfTUVESUEgJiYgdGhpcy5kaWFsb2cpIHsKICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICAgICAgdGhpcy51bm11dGUoKTsKICAgICAgICAgIC8qbG9jYWxNZWRpYSA9IHRoaXMubWVkaWFIYW5kbGVyLmxvY2FsTWVkaWE7CiAgICAgICAgICBpZiAobG9jYWxNZWRpYS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgbG9jYWxNZWRpYS5nZXRBdWRpb1RyYWNrcygpWzBdLmVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKVswXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgICAgIH0qLwogICAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICAgICAgaWYgKHRoaXMucmVuZGVyYm9keSkgewogICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgdGhpcy5yZW5kZXJ0eXBlKTsKICAgICAgICAgICAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSBleHRyYUhlYWRlcnM7CiAgICAgICAgICAgIG9wdGlvbnMuYm9keSA9IHRoaXMucmVuZGVyYm9keTsKICAgICAgICAgIH0KICAgICAgICAgIG9wdGlvbnMuY3NlcSA9IHJlc3BvbnNlLmNzZXE7CiAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLkFDSywgb3B0aW9ucyk7CiAgICAgICAgICB0aGlzLmFjY2VwdGVkKHJlc3BvbnNlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICAvLyBEbyBub3RoaW5nIGlmIHRoaXMuZGlhbG9nIGlzIGFscmVhZHkgY29uZmlybWVkCiAgICAgICAgaWYgKHRoaXMuZGlhbG9nKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIFNJUC5IYWNrcy5GaXJlZm94LmNhbm5vdEhhbmRsZUV4dHJhV2hpdGVzcGFjZShyZXNwb25zZSk7CiAgICAgICAgU0lQLkhhY2tzLkFsbEJyb3dzZXJzLm1hc2tEdGxzKHJlc3BvbnNlKTsKCiAgICAgICAgLy8gVGhpcyBpcyBhbiBpbnZpdGUgd2l0aG91dCBzZHAKICAgICAgICBpZiAoIXRoaXMuaGFzT2ZmZXIpIHsKICAgICAgICAgIGlmICh0aGlzLmVhcmx5RGlhbG9nc1tpZF0gJiYgdGhpcy5lYXJseURpYWxvZ3NbaWRdLm1lZGlhSGFuZGxlci5sb2NhbE1lZGlhKSB7CiAgICAgICAgICAgIC8vUkVWSVNJVAogICAgICAgICAgICB0aGlzLmhhc09mZmVyID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5oYXNBbnN3ZXIgPSB0cnVlOwogICAgICAgICAgICB0aGlzLm1lZGlhSGFuZGxlciA9IHRoaXMuZWFybHlEaWFsb2dzW2lkXS5tZWRpYUhhbmRsZXI7CiAgICAgICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnKSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLkFDSywge2NzZXE6cmVzcG9uc2UuY3NlcX0pOwoKICAgICAgICAgICAgdGhpcy51bm11dGUoKTsKICAgICAgICAgICAgLyoKICAgICAgICAgICAgbG9jYWxNZWRpYSA9IHNlc3Npb24ubWVkaWFIYW5kbGVyLmxvY2FsTWVkaWE7CiAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0QXVkaW9UcmFja3MoKVswXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobG9jYWxNZWRpYS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICBsb2NhbE1lZGlhLmdldFZpZGVvVHJhY2tzKClbMF0uZW5hYmxlZCA9IHRydWU7CiAgICAgICAgICAgIH0qLwogICAgICAgICAgICB0aGlzLmFjY2VwdGVkKHJlc3BvbnNlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmKCFyZXNwb25zZS5ib2R5KSB7CiAgICAgICAgICAgICAgdGhpcy5hY2NlcHRBbmRUZXJtaW5hdGUocmVzcG9uc2UsIDQwMCwgJ01pc3Npbmcgc2Vzc2lvbiBkZXNjcmlwdGlvbicpOwogICAgICAgICAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXRoaXMuY3JlYXRlRGlhbG9nKHJlc3BvbnNlLCAnVUFDJykpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmhhc09mZmVyID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuc2V0RGVzY3JpcHRpb24ocmVzcG9uc2UuYm9keSkKICAgICAgICAgICAgLnRoZW4odGhpcy5tZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24uYmluZCh0aGlzLm1lZGlhSGFuZGxlciwgdGhpcy5tZWRpYUhpbnQpKQogICAgICAgICAgICAudGhlbihmdW5jdGlvbiBvblN1Y2Nlc3Moc2RwKSB7CiAgICAgICAgICAgICAgLy92YXIgbG9jYWxNZWRpYTsKICAgICAgICAgICAgICBpZihzZXNzaW9uLmlzQ2FuY2VsZWQgfHwgc2Vzc2lvbi5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNkcCA9IFNJUC5IYWNrcy5GaXJlZm94Lmhhc01pc3NpbmdDTGluZUluU0RQKHNkcCk7CgogICAgICAgICAgICAgIHNlc3Npb24uc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICAgICAgICAgIHNlc3Npb24uaGFzQW5zd2VyID0gdHJ1ZTsKCiAgICAgICAgICAgICAgc2Vzc2lvbi51bm11dGUoKTsKICAgICAgICAgICAgICAvKmxvY2FsTWVkaWEgPSBzZXNzaW9uLm1lZGlhSGFuZGxlci5sb2NhbE1lZGlhOwogICAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgbG9jYWxNZWRpYS5nZXRBdWRpb1RyYWNrcygpWzBdLmVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAobG9jYWxNZWRpYS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKVswXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICB9Ki8KICAgICAgICAgICAgICBzZXNzaW9uLnNlbmRSZXF1ZXN0KFNJUC5DLkFDSyx7CiAgICAgICAgICAgICAgICBib2R5OiBzZHAsCiAgICAgICAgICAgICAgICBleHRyYUhlYWRlcnM6WydDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3NkcCddLAogICAgICAgICAgICAgICAgY3NlcTpyZXNwb25zZS5jc2VxCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgc2Vzc2lvbi5hY2NlcHRlZChyZXNwb25zZSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiBvbkZhaWx1cmUoZSkgewogICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgU0lQLkV4Y2VwdGlvbnMuR2V0RGVzY3JpcHRpb25FcnJvcikgewogICAgICAgICAgICAgICAgLy8gVE9ETyBkbyBzb21ldGhpbmcgaGVyZQogICAgICAgICAgICAgICAgc2Vzc2lvbi5sb2dnZXIud2FybigidGhlcmUgd2FzIGEgcHJvYmxlbSIpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2dlci53YXJuKCdpbnZhbGlkIFNEUCcpOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5sb2dnZXIud2FybihlKTsKICAgICAgICAgICAgICAgIHJlc3BvbnNlLnJlcGx5KDQ4OCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaGFzQW5zd2VyKXsKICAgICAgICAgIGlmICh0aGlzLnJlbmRlcmJvZHkpIHsKICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRlbnQtVHlwZTogJyArIHNlc3Npb24ucmVuZGVydHlwZSk7CiAgICAgICAgICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzID0gZXh0cmFIZWFkZXJzOwogICAgICAgICAgICBvcHRpb25zLmJvZHkgPSB0aGlzLnJlbmRlcmJvZHk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KFNJUC5DLkFDSywgb3B0aW9ucyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmKCFyZXNwb25zZS5ib2R5KSB7CiAgICAgICAgICAgIHRoaXMuYWNjZXB0QW5kVGVybWluYXRlKHJlc3BvbnNlLCA0MDAsICdNaXNzaW5nIHNlc3Npb24gZGVzY3JpcHRpb24nKTsKICAgICAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnKSkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgICAgIHRoaXMubWVkaWFIYW5kbGVyLnNldERlc2NyaXB0aW9uKHJlc3BvbnNlLmJvZHkpCiAgICAgICAgICAudGhlbigKICAgICAgICAgICAgZnVuY3Rpb24gb25TdWNjZXNzICgpIHsKICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHt9Oy8vLGxvY2FsTWVkaWE7CiAgICAgICAgICAgICAgc2Vzc2lvbi5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgICAgICAgICAgc2Vzc2lvbi51bm11dGUoKTsKICAgICAgICAgICAgICAvKmxvY2FsTWVkaWEgPSBzZXNzaW9uLm1lZGlhSGFuZGxlci5sb2NhbE1lZGlhOwogICAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgbG9jYWxNZWRpYS5nZXRBdWRpb1RyYWNrcygpWzBdLmVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAobG9jYWxNZWRpYS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKVswXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICB9Ki8KICAgICAgICAgICAgICBpZiAoc2Vzc2lvbi5yZW5kZXJib2R5KSB7CiAgICAgICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgc2Vzc2lvbi5yZW5kZXJ0eXBlKTsKICAgICAgICAgICAgICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzID0gZXh0cmFIZWFkZXJzOwogICAgICAgICAgICAgICAgb3B0aW9ucy5ib2R5ID0gc2Vzc2lvbi5yZW5kZXJib2R5OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBvcHRpb25zLmNzZXEgPSByZXNwb25zZS5jc2VxOwogICAgICAgICAgICAgIHNlc3Npb24uc2VuZFJlcXVlc3QoU0lQLkMuQUNLLCBvcHRpb25zKTsKICAgICAgICAgICAgICBzZXNzaW9uLmFjY2VwdGVkKHJlc3BvbnNlKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZnVuY3Rpb24gb25GYWlsdXJlIChlKSB7CiAgICAgICAgICAgICAgc2Vzc2lvbi5sb2dnZXIud2FybihlKTsKICAgICAgICAgICAgICBzZXNzaW9uLmFjY2VwdEFuZFRlcm1pbmF0ZShyZXNwb25zZSwgNDg4LCAnTm90IEFjY2VwdGFibGUgSGVyZScpOwogICAgICAgICAgICAgIHNlc3Npb24uZmFpbGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgfQogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgY2F1c2UgPSBTSVAuVXRpbHMuc2lwRXJyb3JDYXVzZShyZXNwb25zZS5zdGF0dXNfY29kZSk7CiAgICAgICAgdGhpcy5yZWplY3RlZChyZXNwb25zZSwgY2F1c2UpOwogICAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICB9CiAgfSwKCiAgY2FuY2VsOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICB0aGlzLmxvZ2dlci5sb2coJ2NhbmNlbGluZyBSVENTZXNzaW9uJyk7CgogICAgdmFyIGNhbmNlbF9yZWFzb24gPSBTSVAuVXRpbHMuZ2V0Q2FuY2VsUmVhc29uKG9wdGlvbnMuc3RhdHVzX2NvZGUsIG9wdGlvbnMucmVhc29uX3BocmFzZSk7CgogICAgLy8gQ2hlY2sgU2Vzc2lvbiBTdGF0dXMKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfTlVMTCB8fAogICAgICAgICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfSU5WSVRFX1NFTlQgJiYgIXRoaXMucmVjZWl2ZWRfMTAwKSkgewogICAgICB0aGlzLmlzQ2FuY2VsZWQgPSB0cnVlOwogICAgICB0aGlzLmNhbmNlbFJlYXNvbiA9IGNhbmNlbF9yZWFzb247CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19JTlZJVEVfU0VOVCB8fAogICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfMVhYX1JFQ0VJVkVEIHx8CiAgICAgICAgICAgICAgIHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19FQVJMWV9NRURJQSkgewogICAgICB0aGlzLnJlcXVlc3QuY2FuY2VsKGNhbmNlbF9yZWFzb24pOwogICAgfQoKICAgIHJldHVybiB0aGlzLmNhbmNlbGVkKCk7CiAgfSwKCiAgdGVybWluYXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0sgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aGlzLmJ5ZShvcHRpb25zKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuY2FuY2VsKG9wdGlvbnMpOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIHJlY2VpdmVSZXF1ZXN0OiBmdW5jdGlvbihyZXF1ZXN0KSB7CiAgICAvLyBJQ0MgUkVDRUlWRSBSRVFVRVNUCgogICAgLy8gUmVqZWN0IENBTkNFTHMKICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gU0lQLkMuQ0FOQ0VMKSB7CiAgICAgIC8vIFRPRE87IG1ha2UgdGhpcyBhIHN3aXRjaCB3aGVuIGl0IGdldHMgYWRkZWQKICAgIH0KCiAgICBpZiAocmVxdWVzdC5tZXRob2QgPT09IFNJUC5DLkFDSyAmJiB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLKSB7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmFja1RpbWVyKTsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuaW52aXRlMnh4VGltZXIpOwogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0NPTkZJUk1FRDsKICAgICAgdGhpcy51bm11dGUoKTsKCiAgICAgIHRoaXMuYWNjZXB0ZWQoKTsKICAgIH0KCiAgICByZXR1cm4gU2Vzc2lvbi5wcm90b3R5cGUucmVjZWl2ZVJlcXVlc3QuYXBwbHkodGhpcywgW3JlcXVlc3RdKTsKICB9LAoKICBvblRyYW5zcG9ydEVycm9yOiBmdW5jdGlvbigpIHsKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQ09ORklSTUVEICYmIHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgIH0KICB9LAoKICBvblJlcXVlc3RUaW1lb3V0OiBmdW5jdGlvbigpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5mYWlsZWQobnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH0KICB9Cgp9OwoKU0lQLkludml0ZUNsaWVudENvbnRleHQgPSBJbnZpdGVDbGllbnRDb250ZXh0OwoKfTsKCn0seyIuL1Nlc3Npb24vRFRNRiI6MzF9XSwzMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgRFRNRgogKi8KCi8qKgogKiBAY2xhc3MgRFRNRgogKiBAcGFyYW0ge1NJUC5TZXNzaW9ufSBzZXNzaW9uCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKCnZhciBEVE1GLAogIEMgPSB7CiAgICBNSU5fRFVSQVRJT046ICAgICAgICAgICAgNzAsCiAgICBNQVhfRFVSQVRJT046ICAgICAgICAgICAgNjAwMCwKICAgIERFRkFVTFRfRFVSQVRJT046ICAgICAgICAxMDAsCiAgICBNSU5fSU5URVJfVE9ORV9HQVA6ICAgICAgNTAsCiAgICBERUZBVUxUX0lOVEVSX1RPTkVfR0FQOiAgNTAwCiAgfTsKCkRUTUYgPSBmdW5jdGlvbihzZXNzaW9uLCB0b25lLCBvcHRpb25zKSB7CiAgdmFyIGR1cmF0aW9uLCBpbnRlclRvbmVHYXA7CgogIGlmICh0b25lID09PSB1bmRlZmluZWQpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ05vdCBlbm91Z2ggYXJndW1lbnRzJyk7CiAgfQoKICB0aGlzLmxvZ2dlciA9IHNlc3Npb24udWEuZ2V0TG9nZ2VyKCdzaXAuaW52aXRlY29udGV4dC5kdG1mJywgc2Vzc2lvbi5pZCk7CiAgdGhpcy5vd25lciA9IHNlc3Npb247CiAgdGhpcy5kaXJlY3Rpb24gPSBudWxsOwoKICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICBkdXJhdGlvbiA9IG9wdGlvbnMuZHVyYXRpb24gfHwgbnVsbDsKICBpbnRlclRvbmVHYXAgPSBvcHRpb25zLmludGVyVG9uZUdhcCB8fCBudWxsOwoKICAvLyBDaGVjayB0b25lIHR5cGUKICBpZiAodHlwZW9mIHRvbmUgPT09ICdzdHJpbmcnICkgewogICAgdG9uZSA9IHRvbmUudG9VcHBlckNhc2UoKTsKICB9IGVsc2UgaWYgKHR5cGVvZiB0b25lID09PSAnbnVtYmVyJykgewogICAgdG9uZSA9IHRvbmUudG9TdHJpbmcoKTsKICB9IGVsc2UgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB0b25lOiAnKyB0b25lKTsKICB9CgogIC8vIENoZWNrIHRvbmUgdmFsdWUKICBpZiAoIXRvbmUubWF0Y2goL15bMC05QS1EIypdJC8pKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRvbmU6ICcrIHRvbmUpOwogIH0gZWxzZSB7CiAgICB0aGlzLnRvbmUgPSB0b25lOwogIH0KCiAgLy8gQ2hlY2sgZHVyYXRpb24KICBpZiAoZHVyYXRpb24gJiYgIVNJUC5VdGlscy5pc0RlY2ltYWwoZHVyYXRpb24pKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRvbmUgZHVyYXRpb246ICcrIGR1cmF0aW9uKTsKICB9IGVsc2UgaWYgKCFkdXJhdGlvbikgewogICAgZHVyYXRpb24gPSBEVE1GLkMuREVGQVVMVF9EVVJBVElPTjsKICB9IGVsc2UgaWYgKGR1cmF0aW9uIDwgRFRNRi5DLk1JTl9EVVJBVElPTikgewogICAgdGhpcy5sb2dnZXIud2FybignImR1cmF0aW9uIiB2YWx1ZSBpcyBsb3dlciB0aGFuIHRoZSBtaW5pbXVtIGFsbG93ZWQsIHNldHRpbmcgaXQgdG8gJysgRFRNRi5DLk1JTl9EVVJBVElPTisgJyBtaWxsaXNlY29uZHMnKTsKICAgIGR1cmF0aW9uID0gRFRNRi5DLk1JTl9EVVJBVElPTjsKICB9IGVsc2UgaWYgKGR1cmF0aW9uID4gRFRNRi5DLk1BWF9EVVJBVElPTikgewogICAgdGhpcy5sb2dnZXIud2FybignImR1cmF0aW9uIiB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gdGhlIG1heGltdW0gYWxsb3dlZCwgc2V0dGluZyBpdCB0byAnKyBEVE1GLkMuTUFYX0RVUkFUSU9OICsnIG1pbGxpc2Vjb25kcycpOwogICAgZHVyYXRpb24gPSBEVE1GLkMuTUFYX0RVUkFUSU9OOwogIH0gZWxzZSB7CiAgICBkdXJhdGlvbiA9IE1hdGguYWJzKGR1cmF0aW9uKTsKICB9CiAgdGhpcy5kdXJhdGlvbiA9IGR1cmF0aW9uOwoKICAvLyBDaGVjayBpbnRlclRvbmVHYXAKICBpZiAoaW50ZXJUb25lR2FwICYmICFTSVAuVXRpbHMuaXNEZWNpbWFsKGludGVyVG9uZUdhcCkpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgaW50ZXJUb25lR2FwOiAnKyBpbnRlclRvbmVHYXApOwogIH0gZWxzZSBpZiAoIWludGVyVG9uZUdhcCkgewogICAgaW50ZXJUb25lR2FwID0gRFRNRi5DLkRFRkFVTFRfSU5URVJfVE9ORV9HQVA7CiAgfSBlbHNlIGlmIChpbnRlclRvbmVHYXAgPCBEVE1GLkMuTUlOX0lOVEVSX1RPTkVfR0FQKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCciaW50ZXJUb25lR2FwIiB2YWx1ZSBpcyBsb3dlciB0aGFuIHRoZSBtaW5pbXVtIGFsbG93ZWQsIHNldHRpbmcgaXQgdG8gJysgRFRNRi5DLk1JTl9JTlRFUl9UT05FX0dBUCArJyBtaWxsaXNlY29uZHMnKTsKICAgIGludGVyVG9uZUdhcCA9IERUTUYuQy5NSU5fSU5URVJfVE9ORV9HQVA7CiAgfSBlbHNlIHsKICAgIGludGVyVG9uZUdhcCA9IE1hdGguYWJzKGludGVyVG9uZUdhcCk7CiAgfQogIHRoaXMuaW50ZXJUb25lR2FwID0gaW50ZXJUb25lR2FwOwp9OwpEVE1GLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU0lQLkV2ZW50RW1pdHRlci5wcm90b3R5cGUpOwoKCkRUTUYucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbihvcHRpb25zKSB7CiAgdmFyIGV4dHJhSGVhZGVycywgYm9keTsKCiAgdGhpcy5kaXJlY3Rpb24gPSAnb3V0Z29pbmcnOwoKICAvLyBDaGVjayBSVENTZXNzaW9uIFN0YXR1cwogIGlmICh0aGlzLm93bmVyLnN0YXR1cyAhPT0gU0lQLlNlc3Npb24uQy5TVEFUVVNfQ09ORklSTUVEICYmCiAgICB0aGlzLm93bmVyLnN0YXR1cyAhPT0gU0lQLlNlc3Npb24uQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLKSB7CiAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5vd25lci5zdGF0dXMpOwogIH0KCiAgLy8gR2V0IERUTUYgb3B0aW9ucwogIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogIGV4dHJhSGVhZGVycyA9IG9wdGlvbnMuZXh0cmFIZWFkZXJzID8gb3B0aW9ucy5leHRyYUhlYWRlcnMuc2xpY2UoKSA6IFtdOwoKICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9kdG1mLXJlbGF5Jyk7CgogIGJvZHkgPSAiU2lnbmFsPSAiICsgdGhpcy50b25lICsgIlxyXG4iOwogIGJvZHkgKz0gIkR1cmF0aW9uPSAiICsgdGhpcy5kdXJhdGlvbjsKCiAgdGhpcy5yZXF1ZXN0ID0gdGhpcy5vd25lci5kaWFsb2cuc2VuZFJlcXVlc3QodGhpcywgU0lQLkMuSU5GTywgewogICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICBib2R5OiBib2R5CiAgfSk7CgogIHRoaXMub3duZXIuZW1pdCgnZHRtZicsIHRoaXMucmVxdWVzdCwgdGhpcyk7Cn07CgovKioKICogQHByaXZhdGUKICovCkRUTUYucHJvdG90eXBlLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgdmFyIGNhdXNlOwoKICBzd2l0Y2godHJ1ZSkgewogICAgY2FzZSAvXjFbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAvLyBJZ25vcmUgcHJvdmlzaW9uYWwgcmVzcG9uc2VzLgogICAgICBicmVhazsKCiAgICBjYXNlIC9eMlswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgIHRoaXMuZW1pdCgnc3VjY2VlZGVkJywgewogICAgICAgIG9yaWdpbmF0b3I6ICdyZW1vdGUnLAogICAgICAgIHJlc3BvbnNlOiByZXNwb25zZQogICAgICB9KTsKICAgICAgYnJlYWs7CgogICAgZGVmYXVsdDoKICAgICAgY2F1c2UgPSBTSVAuVXRpbHMuc2lwRXJyb3JDYXVzZShyZXNwb25zZS5zdGF0dXNfY29kZSk7CiAgICAgIHRoaXMuZW1pdCgnZmFpbGVkJywgcmVzcG9uc2UsIGNhdXNlKTsKICAgICAgYnJlYWs7CiAgfQp9OwoKLyoqCiAqIEBwcml2YXRlCiAqLwpEVE1GLnByb3RvdHlwZS5vblJlcXVlc3RUaW1lb3V0ID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5lbWl0KCdmYWlsZWQnLCBudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICB0aGlzLm93bmVyLm9uUmVxdWVzdFRpbWVvdXQoKTsKfTsKCi8qKgogKiBAcHJpdmF0ZQogKi8KRFRNRi5wcm90b3R5cGUub25UcmFuc3BvcnRFcnJvciA9IGZ1bmN0aW9uKCkgewogIHRoaXMuZW1pdCgnZmFpbGVkJywgbnVsbCwgU0lQLkMuY2F1c2VzLkNPTk5FQ1RJT05fRVJST1IpOwogIHRoaXMub3duZXIub25UcmFuc3BvcnRFcnJvcigpOwp9OwoKLyoqCiAqIEBwcml2YXRlCiAqLwpEVE1GLnByb3RvdHlwZS5vbkRpYWxvZ0Vycm9yID0gZnVuY3Rpb24ocmVzcG9uc2UpIHsKICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuRElBTE9HX0VSUk9SKTsKICB0aGlzLm93bmVyLm9uRGlhbG9nRXJyb3IocmVzcG9uc2UpOwp9OwoKLyoqCiAqIEBwcml2YXRlCiAqLwpEVE1GLnByb3RvdHlwZS5pbml0X2luY29taW5nID0gZnVuY3Rpb24ocmVxdWVzdCkgewogIHRoaXMuZGlyZWN0aW9uID0gJ2luY29taW5nJzsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwoKICByZXF1ZXN0LnJlcGx5KDIwMCk7CgogIGlmICghdGhpcy50b25lIHx8ICF0aGlzLmR1cmF0aW9uKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCdpbnZhbGlkIElORk8gRFRNRiByZWNlaXZlZCwgZGlzY2FyZGVkJyk7CiAgfSBlbHNlIHsKICAgIHRoaXMub3duZXIuZW1pdCgnZHRtZicsIHJlcXVlc3QsIHRoaXMpOwogIH0KfTsKCkRUTUYuQyA9IEM7CnJldHVybiBEVE1GOwp9OwoKfSx7fV0sMzI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgovKioKICogQGZpbGVvdmVydmlldyBTSVAgU3Vic2NyaWJlciAoU0lQLVNwZWNpZmljIEV2ZW50IE5vdGlmaWNhdGlvbnMgUkZDNjY2NSkKICovCgovKioKICogQGF1Z21lbnRzIFNJUAogKiBAY2xhc3MgQ2xhc3MgY3JlYXRpbmcgYSBTSVAgU3Vic2NyaXB0aW9uLgogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7ClNJUC5TdWJzY3JpcHRpb24gPSBmdW5jdGlvbiAodWEsIHRhcmdldCwgZXZlbnQsIG9wdGlvbnMpIHsKICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zIHx8IE9iamVjdC5wcm90b3R5cGUpOwogIHRoaXMuZXh0cmFIZWFkZXJzID0gb3B0aW9ucy5leHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCk7CgogIHRoaXMuaWQgPSBudWxsOwogIHRoaXMuc3RhdGUgPSAnaW5pdCc7CgogIGlmICghZXZlbnQpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V2ZW50IG5lY2Vzc2FyeSB0byBjcmVhdGUgYSBzdWJzY3JpcHRpb24uJyk7CiAgfSBlbHNlIHsKICAgIC8vVE9ETzogY2hlY2sgZm9yIHZhbGlkIGV2ZW50cyBoZXJlIHByb2JhYmx5IG1ha2UgYSBsaXN0IGluIFNJUC5DOyBvciBsZWF2ZSBpdCB1cCB0byBhcHAgdG8gY2hlY2s/CiAgICAvL1RoZSBjaGVjayBtYXkgbmVlZCB0by9zaG91bGQgcHJvYmFibHkgb2NjdXIgb24gdGhlIG90aGVyIHNpZGUsCiAgICB0aGlzLmV2ZW50ID0gZXZlbnQ7CiAgfQoKICBpZih0eXBlb2Ygb3B0aW9ucy5leHBpcmVzICE9PSAnbnVtYmVyJyl7CiAgICB1YS5sb2dnZXIud2FybignZXhwaXJlcyBtdXN0IGJlIGEgbnVtYmVyLiBVc2luZyBkZWZhdWx0IG9mIDM2MDAuJyk7CiAgICB0aGlzLmV4cGlyZXMgPSAzNjAwOwogIH0gZWxzZSB7CiAgICB0aGlzLmV4cGlyZXMgPSBvcHRpb25zLmV4cGlyZXM7CiAgfQoKICBvcHRpb25zLmV4dHJhSGVhZGVycy5wdXNoKCdFdmVudDogJyArIHRoaXMuZXZlbnQpOwogIG9wdGlvbnMuZXh0cmFIZWFkZXJzLnB1c2goJ0V4cGlyZXM6ICcgKyB0aGlzLmV4cGlyZXMpOwoKICBpZiAob3B0aW9ucy5ib2R5KSB7CiAgICB0aGlzLmJvZHkgPSBvcHRpb25zLmJvZHk7CiAgfQoKICB0aGlzLmNvbnRhY3QgPSB1YS5jb250YWN0LnRvU3RyaW5nKCk7CgogIG9wdGlvbnMuZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcrIHRoaXMuY29udGFjdCk7CiAgb3B0aW9ucy5leHRyYUhlYWRlcnMucHVzaCgnQWxsb3c6ICcrIFNJUC5VQS5DLkFMTE9XRURfTUVUSE9EUy50b1N0cmluZygpKTsKCiAgU0lQLlV0aWxzLmF1Z21lbnQodGhpcywgU0lQLkNsaWVudENvbnRleHQsIFt1YSwgU0lQLkMuU1VCU0NSSUJFLCB0YXJnZXQsIG9wdGlvbnNdKTsKCiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC5zdWJzY3JpcHRpb24nKTsKCiAgdGhpcy5kaWFsb2cgPSBudWxsOwogIHRoaXMudGltZXJzID0ge046IG51bGwsIHN1Yl9kdXJhdGlvbjogbnVsbH07CiAgdGhpcy5lcnJvckNvZGVzICA9IFs0MDQsNDA1LDQxMCw0MTYsNDgwLDQ4MSw0ODIsNDgzLDQ4NCw0ODUsNDg5LDUwMSw2MDRdOwp9OwoKU0lQLlN1YnNjcmlwdGlvbi5wcm90b3R5cGUgPSB7CiAgc3Vic2NyaWJlOiBmdW5jdGlvbigpIHsKICAgIHZhciBzdWIgPSB0aGlzOwoKICAgICAvL3RoZXNlIHN0YXRlcyBwb2ludCB0byBhbiBleGlzdGluZyBzdWJzY3JpcHRpb24sIG5vIHN1YnNjcmliZSBpcyBuZWNlc3NhcnkKICAgIGlmICh0aGlzLnN0YXRlID09PSAnYWN0aXZlJykgewogICAgICB0aGlzLnJlZnJlc2goKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdGUgPT09ICdub3RpZnlfd2FpdCcpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuc3ViX2R1cmF0aW9uKTsKICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLk4pOwogICAgdGhpcy50aW1lcnMuTiA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChzdWIudGltZXJfZmlyZS5iaW5kKHN1YiksIFNJUC5UaW1lcnMuVElNRVJfTik7CgogICAgdGhpcy5zZW5kKCk7CgogICAgdGhpcy5zdGF0ZSA9ICdub3RpZnlfd2FpdCc7CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgcmVmcmVzaDogZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMuc3RhdGUgPT09ICd0ZXJtaW5hdGVkJyB8fCB0aGlzLnN0YXRlID09PSAncGVuZGluZycgfHwgdGhpcy5zdGF0ZSA9PT0gJ25vdGlmeV93YWl0JykgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5kaWFsb2cuc2VuZFJlcXVlc3QodGhpcywgU0lQLkMuU1VCU0NSSUJFLCB7CiAgICAgIGV4dHJhSGVhZGVyczogdGhpcy5leHRyYUhlYWRlcnMsCiAgICAgIGJvZHk6IHRoaXMuYm9keQogICAgfSk7CiAgfSwKCiAgcmVjZWl2ZVJlc3BvbnNlOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgdmFyIGV4cGlyZXMsIHN1YiA9IHRoaXMsCiAgICAgICAgY2F1c2UgPSBTSVAuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKHJlc3BvbnNlLnN0YXR1c19jb2RlKTsKCiAgICBpZiAoKHRoaXMuc3RhdGUgPT09ICdub3RpZnlfd2FpdCcgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPj0gMzAwKSB8fAogICAgICAgICh0aGlzLnN0YXRlICE9PSAnbm90aWZ5X3dhaXQnICYmIHRoaXMuZXJyb3JDb2Rlcy5pbmRleE9mKHJlc3BvbnNlLnN0YXR1c19jb2RlKSAhPT0gLTEpKSB7CiAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBudWxsKTsKICAgIH0gZWxzZSBpZiAoL14yWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKSl7CiAgICAgIGV4cGlyZXMgPSByZXNwb25zZS5nZXRIZWFkZXIoJ0V4cGlyZXMnKTsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuTik7CgogICAgICBpZiAodGhpcy5jcmVhdGVDb25maXJtZWREaWFsb2cocmVzcG9uc2UsJ1VBQycpKSB7CiAgICAgICAgdGhpcy5pZCA9IHRoaXMuZGlhbG9nLmlkLnRvU3RyaW5nKCk7CiAgICAgICAgdGhpcy51YS5zdWJzY3JpcHRpb25zW3RoaXMuaWRdID0gdGhpczsKICAgICAgICB0aGlzLmVtaXQoJ2FjY2VwdGVkJywgcmVzcG9uc2UsIGNhdXNlKTsKICAgICAgICAvLyBVUERBVEUgUk9VVEUgU0VUIFRPIEJFIEJBQ0tXQVJEUyBDT01QQVRJQkxFPwogICAgICB9CgogICAgICBpZiAoZXhwaXJlcyAmJiBleHBpcmVzIDw9IHRoaXMuZXhwaXJlcykgewogICAgICAgIC8vIFByZXNlcnZlIG5ldyBleHBpcmVzIHZhbHVlIGZvciBzdWJzZXF1ZW50IHJlcXVlc3RzCiAgICAgICAgdGhpcy5leHBpcmVzID0gZXhwaXJlczsKICAgICAgICB0aGlzLnRpbWVycy5zdWJfZHVyYXRpb24gPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoc3ViLnJlZnJlc2guYmluZChzdWIpLCBleHBpcmVzICogOTAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoIWV4cGlyZXMpIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ0V4cGlyZXMgaGVhZGVyIG1pc3NpbmcgaW4gYSAyMDAtY2xhc3MgcmVzcG9uc2UgdG8gU1VCU0NSSUJFJyk7CiAgICAgICAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgU0lQLkMuRVhQSVJFU19IRUFERVJfTUlTU0lORyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ0V4cGlyZXMgaGVhZGVyIGluIGEgMjAwLWNsYXNzIHJlc3BvbnNlIHRvIFNVQlNDUklCRSB3aXRoIGEgaGlnaGVyIHZhbHVlIHRoYW4gdGhlIG9uZSBpbiB0aGUgcmVxdWVzdCcpOwogICAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLklOVkFMSURfRVhQSVJFU19IRUFERVIpOwogICAgICAgIH0KICAgICAgfQogICAgfSAvL1VzZWQgdG8ganVzdCBpZ25vcmUgcHJvdmlzaW9uYWwgcmVzcG9uc2VzOyBub3cgaWdub3JlcyBldmVyeXRoaW5nIGV4Y2VwdCBlcnJvckNvZGVzIGFuZCAyeHgKICB9LAoKICB1bnN1YnNjcmliZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgZXh0cmFIZWFkZXJzID0gW10sIHN1YiA9IHRoaXM7CgogICAgdGhpcy5zdGF0ZSA9ICd0ZXJtaW5hdGVkJzsKCiAgICBleHRyYUhlYWRlcnMucHVzaCgnRXZlbnQ6ICcgKyB0aGlzLmV2ZW50KTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdFeHBpcmVzOiAwJyk7CgogICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcrIHRoaXMuY29udGFjdCk7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnQWxsb3c6ICcrIFNJUC5VQS5DLkFMTE9XRURfTUVUSE9EUy50b1N0cmluZygpKTsKCiAgICAvL21ha2VzIHN1cmUgZXhwaXJlcyBpc24ndCBzZXQsIGFuZCBvdGhlciB0eXBpY2FsIHJlc3Vic2NyaWJlIGJlaGF2aW9yCiAgICB0aGlzLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKCl7fTsKCiAgICB0aGlzLmRpYWxvZy5zZW5kUmVxdWVzdCh0aGlzLCB0aGlzLm1ldGhvZCwgewogICAgICBleHRyYUhlYWRlcnM6IGV4dHJhSGVhZGVycywKICAgICAgYm9keTogdGhpcy5ib2R5CiAgICB9KTsKCiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5zdWJfZHVyYXRpb24pOwogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuTik7CiAgICB0aGlzLnRpbWVycy5OID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KHN1Yi50aW1lcl9maXJlLmJpbmQoc3ViKSwgU0lQLlRpbWVycy5USU1FUl9OKTsKICB9LAoKICAvKioKICAqIEBwcml2YXRlCiAgKi8KICB0aW1lcl9maXJlOiBmdW5jdGlvbigpewogICAgaWYgKHRoaXMuc3RhdGUgPT09ICd0ZXJtaW5hdGVkJykgewogICAgICB0aGlzLnRlcm1pbmF0ZURpYWxvZygpOwogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5OKTsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuc3ViX2R1cmF0aW9uKTsKCiAgICAgIGRlbGV0ZSB0aGlzLnVhLnN1YnNjcmlwdGlvbnNbdGhpcy5pZF07CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdGUgPT09ICdwZW5kaW5nJyB8fCB0aGlzLnN0YXRlID09PSAnbm90aWZ5X3dhaXQnKSB7CiAgICAgIHRoaXMuY2xvc2UoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgfQogIH0sCgogIC8qKgogICogQHByaXZhdGUKICAqLwogIGNsb3NlOiBmdW5jdGlvbigpIHsKICAgIGlmKHRoaXMuc3RhdGUgIT09ICdub3RpZnlfd2FpdCcgJiYgdGhpcy5zdGF0ZSAhPT0gJ3Rlcm1pbmF0ZWQnKSB7CiAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTsKICAgIH0KICB9LAoKICAvKioKICAqIEBwcml2YXRlCiAgKi8KICBjcmVhdGVDb25maXJtZWREaWFsb2c6IGZ1bmN0aW9uKG1lc3NhZ2UsIHR5cGUpIHsKICAgIHZhciBkaWFsb2c7CgogICAgdGhpcy50ZXJtaW5hdGVEaWFsb2coKTsKICAgIGRpYWxvZyA9IG5ldyBTSVAuRGlhbG9nKHRoaXMsIG1lc3NhZ2UsIHR5cGUpOwoKICAgIGlmKCFkaWFsb2cuZXJyb3IpIHsKICAgICAgdGhpcy5kaWFsb2cgPSBkaWFsb2c7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLy8gRGlhbG9nIG5vdCBjcmVhdGVkIGR1ZSB0byBhbiBlcnJvcgogICAgZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LAoKICAvKioKICAqIEBwcml2YXRlCiAgKi8KICB0ZXJtaW5hdGVEaWFsb2c6IGZ1bmN0aW9uKCkgewogICAgaWYodGhpcy5kaWFsb2cpIHsKICAgICAgZGVsZXRlIHRoaXMudWEuc3Vic2NyaXB0aW9uc1t0aGlzLmlkXTsKICAgICAgdGhpcy5kaWFsb2cudGVybWluYXRlKCk7CiAgICAgIGRlbGV0ZSB0aGlzLmRpYWxvZzsKICAgIH0KICB9LAoKICAvKioKICAqIEBwcml2YXRlCiAgKi8KICByZWNlaXZlUmVxdWVzdDogZnVuY3Rpb24ocmVxdWVzdCkgewogICAgdmFyIHN1Yl9zdGF0ZSwgc3ViID0gdGhpczsKCiAgICBmdW5jdGlvbiBzZXRFeHBpcmVzVGltZW91dCgpIHsKICAgICAgaWYgKHN1Yl9zdGF0ZS5leHBpcmVzKSB7CiAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQoc3ViLnRpbWVycy5zdWJfZHVyYXRpb24pOwogICAgICAgIHN1Yl9zdGF0ZS5leHBpcmVzID0gTWF0aC5taW4oc3ViLmV4cGlyZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1heChzdWJfc3RhdGUuZXhwaXJlcywgMCkpOwogICAgICAgIHN1Yi50aW1lcnMuc3ViX2R1cmF0aW9uID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KHN1Yi5yZWZyZXNoLmJpbmQoc3ViKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Yl9zdGF0ZS5leHBpcmVzICogOTAwKTsKICAgICAgfQogICAgfQoKICAgIGlmICghdGhpcy5tYXRjaEV2ZW50KHJlcXVlc3QpKSB7IC8vY2hlY2tzIGV2ZW50IGFuZCBzdWJzY3JpcHRpb25fc3RhdGUgaGVhZGVycwogICAgICByZXF1ZXN0LnJlcGx5KDQ4OSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzdWJfc3RhdGUgPSByZXF1ZXN0LnBhcnNlSGVhZGVyKCdTdWJzY3JpcHRpb24tU3RhdGUnKTsKCiAgICByZXF1ZXN0LnJlcGx5KDIwMCwgU0lQLkMuUkVBU09OXzIwMCk7CgogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuTik7CgogICAgdGhpcy5lbWl0KCdub3RpZnknLCB7cmVxdWVzdDogcmVxdWVzdH0pOwoKICAgIC8vIGlmIHdlJ3ZlIHNldCBzdGF0ZSB0byB0ZXJtaW5hdGVkLCBubyBmdXJ0aGVyIHByb2Nlc3Npbmcgc2hvdWxkIHRha2UgcGxhY2UKICAgIC8vIGFuZCB3ZSBhcmUgb25seSBpbnRlcmVzdGVkIGluIGNsZWFuaW5nIHVwIGFmdGVyIHRoZSBhcHByb3ByaWF0ZSBOT1RJRlkKICAgIGlmICh0aGlzLnN0YXRlID09PSAndGVybWluYXRlZCcpIHsKICAgICAgaWYgKHN1Yl9zdGF0ZS5zdGF0ZSA9PT0gJ3Rlcm1pbmF0ZWQnKSB7CiAgICAgICAgdGhpcy50ZXJtaW5hdGVEaWFsb2coKTsKICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5OKTsKICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5zdWJfZHVyYXRpb24pOwoKICAgICAgICBkZWxldGUgdGhpcy51YS5zdWJzY3JpcHRpb25zW3RoaXMuaWRdOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzd2l0Y2ggKHN1Yl9zdGF0ZS5zdGF0ZSkgewogICAgICBjYXNlICdhY3RpdmUnOgogICAgICAgIHRoaXMuc3RhdGUgPSAnYWN0aXZlJzsKICAgICAgICBzZXRFeHBpcmVzVGltZW91dCgpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdwZW5kaW5nJzoKICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gJ25vdGlmeV93YWl0JykgewogICAgICAgICAgc2V0RXhwaXJlc1RpbWVvdXQoKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5zdGF0ZSA9ICdwZW5kaW5nJzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAndGVybWluYXRlZCc6CiAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuc3ViX2R1cmF0aW9uKTsKICAgICAgICBpZiAoc3ViX3N0YXRlLnJlYXNvbikgewogICAgICAgICAgdGhpcy5sb2dnZXIubG9nKCd0ZXJtaW5hdGluZyBzdWJzY3JpcHRpb24gd2l0aCByZWFzb24gJysgc3ViX3N0YXRlLnJlYXNvbik7CiAgICAgICAgICBzd2l0Y2ggKHN1Yl9zdGF0ZS5yZWFzb24pIHsKICAgICAgICAgICAgY2FzZSAnZGVhY3RpdmF0ZWQnOgogICAgICAgICAgICBjYXNlICd0aW1lb3V0JzoKICAgICAgICAgICAgICB0aGlzLnN1YnNjcmliZSgpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgY2FzZSAncHJvYmF0aW9uJzoKICAgICAgICAgICAgY2FzZSAnZ2l2ZXVwJzoKICAgICAgICAgICAgICBpZihzdWJfc3RhdGUucGFyYW1zICYmIHN1Yl9zdGF0ZS5wYXJhbXNbJ3JldHJ5LWFmdGVyJ10pIHsKICAgICAgICAgICAgICAgIHRoaXMudGltZXJzLnN1Yl9kdXJhdGlvbiA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChzdWIuc3Vic2NyaWJlLmJpbmQoc3ViKSwgc3ViX3N0YXRlLnBhcmFtc1sncmV0cnktYWZ0ZXInXSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgY2FzZSAncmVqZWN0ZWQnOgogICAgICAgICAgICBjYXNlICdub3Jlc291cmNlJzoKICAgICAgICAgICAgY2FzZSAnaW52YXJpYW50JzoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5jbG9zZSgpOwogICAgICAgIGJyZWFrOwogICAgfQogIH0sCgogIGZhaWxlZDogZnVuY3Rpb24ocmVzcG9uc2UsIGNhdXNlKSB7CiAgICB0aGlzLmNsb3NlKCk7CiAgICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIHJlc3BvbnNlLCBjYXVzZSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBvbkRpYWxvZ0Vycm9yOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5ESUFMT0dfRVJST1IpOwogIH0sCgogIC8qKgogICogQHByaXZhdGUKICAqLwogIG1hdGNoRXZlbnQ6IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICAgIHZhciBldmVudDsKCiAgICAvLyBDaGVjayBtYW5kYXRvcnkgaGVhZGVyIEV2ZW50CiAgICBpZiAoIXJlcXVlc3QuaGFzSGVhZGVyKCdFdmVudCcpKSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ21pc3NpbmcgRXZlbnQgaGVhZGVyJyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIC8vIENoZWNrIG1hbmRhdG9yeSBoZWFkZXIgU3Vic2NyaXB0aW9uLVN0YXRlCiAgICBpZiAoIXJlcXVlc3QuaGFzSGVhZGVyKCdTdWJzY3JpcHRpb24tU3RhdGUnKSkgewogICAgICB0aGlzLmxvZ2dlci53YXJuKCdtaXNzaW5nIFN1YnNjcmlwdGlvbi1TdGF0ZSBoZWFkZXInKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vIENoZWNrIHdoZXRoZXIgdGhlIGV2ZW50IGluIE5PVElGWSBtYXRjaGVzIHRoZSBldmVudCBpbiBTVUJTQ1JJQkUKICAgIGV2ZW50ID0gcmVxdWVzdC5wYXJzZUhlYWRlcignZXZlbnQnKS5ldmVudDsKCiAgICBpZiAodGhpcy5ldmVudCAhPT0gZXZlbnQpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybignZXZlbnQgbWF0Y2ggZmFpbGVkJyk7CiAgICAgIHJlcXVlc3QucmVwbHkoNDgxLCAnRXZlbnQgTWF0Y2ggRmFpbGVkJyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0KfTsKfTsKCn0se31dLDMzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBTSVAgVElNRVJTCiAqLwoKLyoqCiAqIEBhdWdtZW50cyBTSVAKICovCnZhcgogIFQxID0gNTAwLAogIFQyID0gNDAwMCwKICBUNCA9IDUwMDA7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHRpbWVycykgewogIHZhciBUaW1lcnMgPSB7CiAgICBUMTogVDEsCiAgICBUMjogVDIsCiAgICBUNDogVDQsCiAgICBUSU1FUl9COiA2NCAqIFQxLAogICAgVElNRVJfRDogMCAgKiBUMSwKICAgIFRJTUVSX0Y6IDY0ICogVDEsCiAgICBUSU1FUl9IOiA2NCAqIFQxLAogICAgVElNRVJfSTogMCAgKiBUMSwKICAgIFRJTUVSX0o6IDAgICogVDEsCiAgICBUSU1FUl9LOiAwICAqIFQ0LAogICAgVElNRVJfTDogNjQgKiBUMSwKICAgIFRJTUVSX006IDY0ICogVDEsCiAgICBUSU1FUl9OOiA2NCAqIFQxLAogICAgUFJPVklTSU9OQUxfUkVTUE9OU0VfSU5URVJWQUw6IDYwMDAwICAvLyBTZWUgUkZDIDMyNjEgU2VjdGlvbiAxMy4zLjEuMQogIH07CgogIFsnc2V0VGltZW91dCcsICdjbGVhclRpbWVvdXQnLCAnc2V0SW50ZXJ2YWwnLCAnY2xlYXJJbnRlcnZhbCddCiAgLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKICAgIC8vIGNhbid0IGp1c3QgdXNlIHRpbWVyc1tuYW1lXS5iaW5kKHRpbWVycykgc2luY2UgaXQgYnlwYXNzZXMgamFzbWluZSdzCiAgICAvLyBjbG9jay1tb2NraW5nCiAgICBUaW1lcnNbbmFtZV0gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aW1lcnNbbmFtZV0uYXBwbHkodGltZXJzLCBhcmd1bWVudHMpOwogICAgfTsKICB9KTsKCiAgcmV0dXJuIFRpbWVyczsKfTsKCn0se31dLDM0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBTSVAgVHJhbnNhY3Rpb25zCiAqLwoKLyoqCiAqIFNJUCBUcmFuc2FjdGlvbnMgbW9kdWxlLgogKiBAYXVnbWVudHMgU0lQCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyCiAgQyA9IHsKICAgIC8vIFRyYW5zYWN0aW9uIHN0YXRlcwogICAgU1RBVFVTX1RSWUlORzogICAgIDEsCiAgICBTVEFUVVNfUFJPQ0VFRElORzogMiwKICAgIFNUQVRVU19DQUxMSU5HOiAgICAzLAogICAgU1RBVFVTX0FDQ0VQVEVEOiAgIDQsCiAgICBTVEFUVVNfQ09NUExFVEVEOiAgNSwKICAgIFNUQVRVU19URVJNSU5BVEVEOiA2LAogICAgU1RBVFVTX0NPTkZJUk1FRDogIDcsCgogICAgLy8gVHJhbnNhY3Rpb24gdHlwZXMKICAgIE5PTl9JTlZJVEVfQ0xJRU5UOiAnbmljdCcsCiAgICBOT05fSU5WSVRFX1NFUlZFUjogJ25pc3QnLAogICAgSU5WSVRFX0NMSUVOVDogJ2ljdCcsCiAgICBJTlZJVEVfU0VSVkVSOiAnaXN0JwogIH07CgpmdW5jdGlvbiBidWlsZFZpYUhlYWRlciAocmVxdWVzdF9zZW5kZXIsIHRyYW5zcG9ydCwgaWQpIHsKICB2YXIgdmlhOwogIHZpYSA9ICdTSVAvMi4wLycgKyAocmVxdWVzdF9zZW5kZXIudWEuY29uZmlndXJhdGlvbi5oYWNrVmlhVGNwID8gJ1RDUCcgOiB0cmFuc3BvcnQuc2VydmVyLnNjaGVtZSk7CiAgdmlhICs9ICcgJyArIHJlcXVlc3Rfc2VuZGVyLnVhLmNvbmZpZ3VyYXRpb24udmlhSG9zdCArICc7YnJhbmNoPScgKyBpZDsKICBpZiAocmVxdWVzdF9zZW5kZXIudWEuY29uZmlndXJhdGlvbi5mb3JjZVJwb3J0KSB7CiAgICB2aWEgKz0gJztycG9ydCc7CiAgfQogIHJldHVybiB2aWE7Cn0KCi8qKgoqIEBhdWdtZW50cyBTSVAuVHJhbnNhY3Rpb25zCiogQGNsYXNzIE5vbiBJbnZpdGUgQ2xpZW50IFRyYW5zYWN0aW9uCiogQHBhcmFtIHtTSVAuUmVxdWVzdFNlbmRlcn0gcmVxdWVzdF9zZW5kZXIKKiBAcGFyYW0ge1NJUC5PdXRnb2luZ1JlcXVlc3R9IHJlcXVlc3QKKiBAcGFyYW0ge1NJUC5UcmFuc3BvcnR9IHRyYW5zcG9ydAoqLwp2YXIgTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24gPSBmdW5jdGlvbihyZXF1ZXN0X3NlbmRlciwgcmVxdWVzdCwgdHJhbnNwb3J0KSB7CiAgdmFyIHZpYTsKCiAgdGhpcy50eXBlID0gQy5OT05fSU5WSVRFX0NMSUVOVDsKICB0aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydDsKICB0aGlzLmlkID0gJ3o5aEc0YksnICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDAwMDApOwogIHRoaXMucmVxdWVzdF9zZW5kZXIgPSByZXF1ZXN0X3NlbmRlcjsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwoKICB0aGlzLmxvZ2dlciA9IHJlcXVlc3Rfc2VuZGVyLnVhLmdldExvZ2dlcignc2lwLnRyYW5zYWN0aW9uLm5pY3QnLCB0aGlzLmlkKTsKCiAgdmlhID0gYnVpbGRWaWFIZWFkZXIocmVxdWVzdF9zZW5kZXIsIHRyYW5zcG9ydCwgdGhpcy5pZCk7CiAgdGhpcy5yZXF1ZXN0LnNldEhlYWRlcigndmlhJywgdmlhKTsKCiAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5uZXdUcmFuc2FjdGlvbih0aGlzKTsKfTsKTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdHlwZSk7CgpOb25JbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUuc3RhdGVDaGFuZ2VkID0gZnVuY3Rpb24oc3RhdGUpIHsKICB0aGlzLnN0YXRlID0gc3RhdGU7CiAgdGhpcy5lbWl0KCdzdGF0ZUNoYW5nZWQnKTsKfTsKCk5vbkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24oKSB7CiAgdmFyIHRyID0gdGhpczsKCiAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVFJZSU5HKTsKICB0aGlzLkYgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQodHIudGltZXJfRi5iaW5kKHRyKSwgU0lQLlRpbWVycy5USU1FUl9GKTsKCiAgaWYoIXRoaXMudHJhbnNwb3J0LnNlbmQodGhpcy5yZXF1ZXN0KSkgewogICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgfQp9OwoKTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ3RyYW5zcG9ydCBlcnJvciBvY2N1cnJlZCwgZGVsZXRpbmcgbm9uLUlOVklURSBjbGllbnQgdHJhbnNhY3Rpb24gJyArIHRoaXMuaWQpOwogIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMuRik7CiAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5LKTsKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLm9uVHJhbnNwb3J0RXJyb3IoKTsKfTsKCk5vbkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS50aW1lcl9GID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5sb2dnZXIubG9nKCdUaW1lciBGIGV4cGlyZWQgZm9yIG5vbi1JTlZJVEUgY2xpZW50IHRyYW5zYWN0aW9uICcgKyB0aGlzLmlkKTsKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLm9uUmVxdWVzdFRpbWVvdXQoKTsKfTsKCk5vbkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS50aW1lcl9LID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7Cn07CgpOb25JbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUucmVjZWl2ZVJlc3BvbnNlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHsKICB2YXIKICAgIHRyID0gdGhpcywKICAgIHN0YXR1c19jb2RlID0gcmVzcG9uc2Uuc3RhdHVzX2NvZGU7CgogIGlmKHN0YXR1c19jb2RlIDwgMjAwKSB7CiAgICBzd2l0Y2godGhpcy5zdGF0ZSkgewogICAgICBjYXNlIEMuU1RBVFVTX1RSWUlORzoKICAgICAgY2FzZSBDLlNUQVRVU19QUk9DRUVESU5HOgogICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1BST0NFRURJTkcpOwogICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICBicmVhazsKICAgIH0KICB9IGVsc2UgewogICAgc3dpdGNoKHRoaXMuc3RhdGUpIHsKICAgICAgY2FzZSBDLlNUQVRVU19UUllJTkc6CiAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19DT01QTEVURUQpOwogICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMuRik7CgogICAgICAgIGlmKHN0YXR1c19jb2RlID09PSA0MDgpIHsKICAgICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIub25SZXF1ZXN0VGltZW91dCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLksgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQodHIudGltZXJfSy5iaW5kKHRyKSwgU0lQLlRpbWVycy5USU1FUl9LKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBDLlNUQVRVU19DT01QTEVURUQ6CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfQp9OwoKCgovKioKKiBAYXVnbWVudHMgU0lQLlRyYW5zYWN0aW9ucwoqIEBjbGFzcyBJbnZpdGUgQ2xpZW50IFRyYW5zYWN0aW9uCiogQHBhcmFtIHtTSVAuUmVxdWVzdFNlbmRlcn0gcmVxdWVzdF9zZW5kZXIKKiBAcGFyYW0ge1NJUC5PdXRnb2luZ1JlcXVlc3R9IHJlcXVlc3QKKiBAcGFyYW0ge1NJUC5UcmFuc3BvcnR9IHRyYW5zcG9ydAoqLwp2YXIgSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24gPSBmdW5jdGlvbihyZXF1ZXN0X3NlbmRlciwgcmVxdWVzdCwgdHJhbnNwb3J0KSB7CiAgdmFyIHZpYSwKICAgIHRyID0gdGhpczsKCiAgdGhpcy50eXBlID0gQy5JTlZJVEVfQ0xJRU5UOwogIHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0OwogIHRoaXMuaWQgPSAnejloRzRiSycgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMCk7CiAgdGhpcy5yZXF1ZXN0X3NlbmRlciA9IHJlcXVlc3Rfc2VuZGVyOwogIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7CgogIHRoaXMubG9nZ2VyID0gcmVxdWVzdF9zZW5kZXIudWEuZ2V0TG9nZ2VyKCdzaXAudHJhbnNhY3Rpb24uaWN0JywgdGhpcy5pZCk7CgogIHZpYSA9IGJ1aWxkVmlhSGVhZGVyKHJlcXVlc3Rfc2VuZGVyLCB0cmFuc3BvcnQsIHRoaXMuaWQpOwogIHRoaXMucmVxdWVzdC5zZXRIZWFkZXIoJ3ZpYScsIHZpYSk7CgogIHRoaXMucmVxdWVzdF9zZW5kZXIudWEubmV3VHJhbnNhY3Rpb24odGhpcyk7CgogIC8vIEFkZCB0aGUgY2FuY2VsIHByb3BlcnR5IHRvIHRoZSByZXF1ZXN0LgogIC8vV2lsbCBiZSBjYWxsZWQgZnJvbSB0aGUgcmVxdWVzdCBpbnN0YW5jZSwgbm90IHRoZSB0cmFuc2FjdGlvbiBpdHNlbGYuCiAgdGhpcy5yZXF1ZXN0LmNhbmNlbCA9IGZ1bmN0aW9uKHJlYXNvbikgewogICAgdHIuY2FuY2VsX3JlcXVlc3QodHIsIHJlYXNvbik7CiAgfTsKfTsKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdHlwZSk7CgpJbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUuc3RhdGVDaGFuZ2VkID0gZnVuY3Rpb24oc3RhdGUpIHsKICB0aGlzLnN0YXRlID0gc3RhdGU7CiAgdGhpcy5lbWl0KCdzdGF0ZUNoYW5nZWQnKTsKfTsKCkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24oKSB7CiAgdmFyIHRyID0gdGhpczsKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19DQUxMSU5HKTsKICB0aGlzLkIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQodHIudGltZXJfQi5iaW5kKHRyKSwgU0lQLlRpbWVycy5USU1FUl9CKTsKCiAgaWYoIXRoaXMudHJhbnNwb3J0LnNlbmQodGhpcy5yZXF1ZXN0KSkgewogICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgfQp9OwoKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ3RyYW5zcG9ydCBlcnJvciBvY2N1cnJlZCwgZGVsZXRpbmcgSU5WSVRFIGNsaWVudCB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CiAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5CKTsKICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLkQpOwogIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMuTSk7CiAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7CgogIGlmICh0aGlzLnN0YXRlICE9PSBDLlNUQVRVU19BQ0NFUFRFRCkgewogICAgdGhpcy5yZXF1ZXN0X3NlbmRlci5vblRyYW5zcG9ydEVycm9yKCk7CiAgfQp9OwoKLy8gUkZDIDYwMjYgNy4yCkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS50aW1lcl9NID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5sb2dnZXIubG9nKCdUaW1lciBNIGV4cGlyZWQgZm9yIElOVklURSBjbGllbnQgdHJhbnNhY3Rpb24gJyArIHRoaXMuaWQpOwoKICBpZih0aGlzLnN0YXRlID09PSBDLlNUQVRVU19BQ0NFUFRFRCkgewogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5CKTsKICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogICAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7CiAgfQp9OwoKLy8gUkZDIDMyNjEgMTcuMS4xCkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS50aW1lcl9CID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5sb2dnZXIubG9nKCdUaW1lciBCIGV4cGlyZWQgZm9yIElOVklURSBjbGllbnQgdHJhbnNhY3Rpb24gJyArIHRoaXMuaWQpOwogIGlmKHRoaXMuc3RhdGUgPT09IEMuU1RBVFVTX0NBTExJTkcpIHsKICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogICAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7CiAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLm9uUmVxdWVzdFRpbWVvdXQoKTsKICB9Cn07CgpJbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUudGltZXJfRCA9IGZ1bmN0aW9uKCkgewogIHRoaXMubG9nZ2VyLmxvZygnVGltZXIgRCBleHBpcmVkIGZvciBJTlZJVEUgY2xpZW50IHRyYW5zYWN0aW9uICcgKyB0aGlzLmlkKTsKICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLkIpOwogIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogIHRoaXMucmVxdWVzdF9zZW5kZXIudWEuZGVzdHJveVRyYW5zYWN0aW9uKHRoaXMpOwp9OwoKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLnNlbmRBQ0sgPSBmdW5jdGlvbihyZXNwb25zZSkgewogIHZhciB0ciA9IHRoaXM7CgogIHRoaXMuYWNrID0gJ0FDSyAnICsgdGhpcy5yZXF1ZXN0LnJ1cmkgKyAnIFNJUC8yLjBcclxuJzsKICB0aGlzLmFjayArPSAnVmlhOiAnICsgdGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ1ZpYSddLnRvU3RyaW5nKCkgKyAnXHJcbic7CgogIGlmKHRoaXMucmVxdWVzdC5oZWFkZXJzWydSb3V0ZSddKSB7CiAgICB0aGlzLmFjayArPSAnUm91dGU6ICcgKyB0aGlzLnJlcXVlc3QuaGVhZGVyc1snUm91dGUnXS50b1N0cmluZygpICsgJ1xyXG4nOwogIH0KCiAgdGhpcy5hY2sgKz0gJ1RvOiAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCd0bycpICsgJ1xyXG4nOwogIHRoaXMuYWNrICs9ICdGcm9tOiAnICsgdGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ0Zyb20nXS50b1N0cmluZygpICsgJ1xyXG4nOwogIHRoaXMuYWNrICs9ICdDYWxsLUlEOiAnICsgdGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ0NhbGwtSUQnXS50b1N0cmluZygpICsgJ1xyXG4nOwogIHRoaXMuYWNrICs9ICdDb250ZW50LUxlbmd0aDogMFxyXG4nOwogIHRoaXMuYWNrICs9ICdDU2VxOiAnICsgdGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ0NTZXEnXS50b1N0cmluZygpLnNwbGl0KCcgJylbMF07CiAgdGhpcy5hY2sgKz0gJyBBQ0tcclxuXHJcbic7CgogIHRoaXMuRCA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9ELmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX0QpOwoKICB0aGlzLnRyYW5zcG9ydC5zZW5kKHRoaXMuYWNrKTsKfTsKCkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5jYW5jZWxfcmVxdWVzdCA9IGZ1bmN0aW9uKHRyLCByZWFzb24pIHsKICB2YXIgcmVxdWVzdCA9IHRyLnJlcXVlc3Q7CgogIHRoaXMuY2FuY2VsID0gU0lQLkMuQ0FOQ0VMICsgJyAnICsgcmVxdWVzdC5ydXJpICsgJyBTSVAvMi4wXHJcbic7CiAgdGhpcy5jYW5jZWwgKz0gJ1ZpYTogJyArIHJlcXVlc3QuaGVhZGVyc1snVmlhJ10udG9TdHJpbmcoKSArICdcclxuJzsKCiAgaWYodGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ1JvdXRlJ10pIHsKICAgIHRoaXMuY2FuY2VsICs9ICdSb3V0ZTogJyArIHJlcXVlc3QuaGVhZGVyc1snUm91dGUnXS50b1N0cmluZygpICsgJ1xyXG4nOwogIH0KCiAgdGhpcy5jYW5jZWwgKz0gJ1RvOiAnICsgcmVxdWVzdC5oZWFkZXJzWydUbyddLnRvU3RyaW5nKCkgKyAnXHJcbic7CiAgdGhpcy5jYW5jZWwgKz0gJ0Zyb206ICcgKyByZXF1ZXN0LmhlYWRlcnNbJ0Zyb20nXS50b1N0cmluZygpICsgJ1xyXG4nOwogIHRoaXMuY2FuY2VsICs9ICdDYWxsLUlEOiAnICsgcmVxdWVzdC5oZWFkZXJzWydDYWxsLUlEJ10udG9TdHJpbmcoKSArICdcclxuJzsKICB0aGlzLmNhbmNlbCArPSAnQ1NlcTogJyArIHJlcXVlc3QuaGVhZGVyc1snQ1NlcSddLnRvU3RyaW5nKCkuc3BsaXQoJyAnKVswXSArCiAgJyBDQU5DRUxcclxuJzsKCiAgaWYocmVhc29uKSB7CiAgICB0aGlzLmNhbmNlbCArPSAnUmVhc29uOiAnICsgcmVhc29uICsgJ1xyXG4nOwogIH0KCiAgdGhpcy5jYW5jZWwgKz0gJ0NvbnRlbnQtTGVuZ3RoOiAwXHJcblxyXG4nOwoKICAvLyBTZW5kIG9ubHkgaWYgYSBwcm92aXNpb25hbCByZXNwb25zZSAoPjEwMCkgaGFzIGJlZW4gcmVjZWl2ZWQuCiAgaWYodGhpcy5zdGF0ZSA9PT0gQy5TVEFUVVNfUFJPQ0VFRElORykgewogICAgdGhpcy50cmFuc3BvcnQuc2VuZCh0aGlzLmNhbmNlbCk7CiAgfQp9OwoKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgdmFyCiAgdHIgPSB0aGlzLAogIHN0YXR1c19jb2RlID0gcmVzcG9uc2Uuc3RhdHVzX2NvZGU7CgogIGlmKHN0YXR1c19jb2RlID49IDEwMCAmJiBzdGF0dXNfY29kZSA8PSAxOTkpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfQ0FMTElORzoKICAgICAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19QUk9DRUVESU5HKTsKICAgICAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgICAgaWYodGhpcy5jYW5jZWwpIHsKICAgICAgICAgIHRoaXMudHJhbnNwb3J0LnNlbmQodGhpcy5jYW5jZWwpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBDLlNUQVRVU19QUk9DRUVESU5HOgogICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICBicmVhazsKICAgIH0KICB9IGVsc2UgaWYoc3RhdHVzX2NvZGUgPj0gMjAwICYmIHN0YXR1c19jb2RlIDw9IDI5OSkgewogICAgc3dpdGNoKHRoaXMuc3RhdGUpIHsKICAgICAgY2FzZSBDLlNUQVRVU19DQUxMSU5HOgogICAgICBjYXNlIEMuU1RBVFVTX1BST0NFRURJTkc6CiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfQUNDRVBURUQpOwogICAgICAgIHRoaXMuTSA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9NLmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX00pOwogICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBDLlNUQVRVU19BQ0NFUFRFRDoKICAgICAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfSBlbHNlIGlmKHN0YXR1c19jb2RlID49IDMwMCAmJiBzdGF0dXNfY29kZSA8PSA2OTkpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfQ0FMTElORzoKICAgICAgY2FzZSBDLlNUQVRVU19QUk9DRUVESU5HOgogICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX0NPTVBMRVRFRCk7CiAgICAgICAgdGhpcy5zZW5kQUNLKHJlc3BvbnNlKTsKICAgICAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgQy5TVEFUVVNfQ09NUExFVEVEOgogICAgICAgIHRoaXMuc2VuZEFDSyhyZXNwb25zZSk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfQp9OwoKCi8qKgogKiBAYXVnbWVudHMgU0lQLlRyYW5zYWN0aW9ucwogKiBAY2xhc3MgQUNLIENsaWVudCBUcmFuc2FjdGlvbgogKiBAcGFyYW0ge1NJUC5SZXF1ZXN0U2VuZGVyfSByZXF1ZXN0X3NlbmRlcgogKiBAcGFyYW0ge1NJUC5PdXRnb2luZ1JlcXVlc3R9IHJlcXVlc3QKICogQHBhcmFtIHtTSVAuVHJhbnNwb3J0fSB0cmFuc3BvcnQKICovCnZhciBBY2tDbGllbnRUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uKHJlcXVlc3Rfc2VuZGVyLCByZXF1ZXN0LCB0cmFuc3BvcnQpIHsKICB2YXIgdmlhOwoKICB0aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydDsKICB0aGlzLmlkID0gJ3o5aEc0YksnICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDAwMDApOwogIHRoaXMucmVxdWVzdF9zZW5kZXIgPSByZXF1ZXN0X3NlbmRlcjsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwoKICB0aGlzLmxvZ2dlciA9IHJlcXVlc3Rfc2VuZGVyLnVhLmdldExvZ2dlcignc2lwLnRyYW5zYWN0aW9uLm5pY3QnLCB0aGlzLmlkKTsKCiAgdmlhID0gYnVpbGRWaWFIZWFkZXIocmVxdWVzdF9zZW5kZXIsIHRyYW5zcG9ydCwgdGhpcy5pZCk7CiAgdGhpcy5yZXF1ZXN0LnNldEhlYWRlcigndmlhJywgdmlhKTsKfTsKQWNrQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdHlwZSk7CgpBY2tDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKCkgewogIGlmKCF0aGlzLnRyYW5zcG9ydC5zZW5kKHRoaXMucmVxdWVzdCkpIHsKICAgIHRoaXMub25UcmFuc3BvcnRFcnJvcigpOwogIH0KfTsKCkFja0NsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5sb2dnZXIubG9nKCd0cmFuc3BvcnQgZXJyb3Igb2NjdXJyZWQsIGZvciBhbiBBQ0sgY2xpZW50IHRyYW5zYWN0aW9uICcgKyB0aGlzLmlkKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLm9uVHJhbnNwb3J0RXJyb3IoKTsKfTsKCgovKioKKiBAYXVnbWVudHMgU0lQLlRyYW5zYWN0aW9ucwoqIEBjbGFzcyBOb24gSW52aXRlIFNlcnZlciBUcmFuc2FjdGlvbgoqIEBwYXJhbSB7U0lQLkluY29taW5nUmVxdWVzdH0gcmVxdWVzdAoqIEBwYXJhbSB7U0lQLlVBfSB1YQoqLwp2YXIgTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb24gPSBmdW5jdGlvbihyZXF1ZXN0LCB1YSkgewogIHRoaXMudHlwZSA9IEMuTk9OX0lOVklURV9TRVJWRVI7CiAgdGhpcy5pZCA9IHJlcXVlc3QudmlhX2JyYW5jaDsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwogIHRoaXMudHJhbnNwb3J0ID0gcmVxdWVzdC50cmFuc3BvcnQ7CiAgdGhpcy51YSA9IHVhOwogIHRoaXMubGFzdF9yZXNwb25zZSA9ICcnOwogIHJlcXVlc3Quc2VydmVyX3RyYW5zYWN0aW9uID0gdGhpczsKCiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC50cmFuc2FjdGlvbi5uaXN0JywgdGhpcy5pZCk7CgogIHRoaXMuc3RhdGUgPSBDLlNUQVRVU19UUllJTkc7CgogIHVhLm5ld1RyYW5zYWN0aW9uKHRoaXMpOwp9OwpOb25JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKCk5vbkludml0ZVNlcnZlclRyYW5zYWN0aW9uLnByb3RvdHlwZS5zdGF0ZUNoYW5nZWQgPSBmdW5jdGlvbihzdGF0ZSkgewogIHRoaXMuc3RhdGUgPSBzdGF0ZTsKICB0aGlzLmVtaXQoJ3N0YXRlQ2hhbmdlZCcpOwp9OwoKTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnRpbWVyX0ogPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ1RpbWVyIEogZXhwaXJlZCBmb3Igbm9uLUlOVklURSBzZXJ2ZXIgdHJhbnNhY3Rpb24gJyArIHRoaXMuaWQpOwogIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogIHRoaXMudWEuZGVzdHJveVRyYW5zYWN0aW9uKHRoaXMpOwp9OwoKTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICBpZiAoIXRoaXMudHJhbnNwb3J0RXJyb3IpIHsKICAgIHRoaXMudHJhbnNwb3J0RXJyb3IgPSB0cnVlOwoKICAgIHRoaXMubG9nZ2VyLmxvZygndHJhbnNwb3J0IGVycm9yIG9jY3VycmVkLCBkZWxldGluZyBub24tSU5WSVRFIHNlcnZlciB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CgogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5KKTsKICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogICAgdGhpcy51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7CiAgfQp9OwoKTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKHN0YXR1c19jb2RlLCByZXNwb25zZSkgewogIHZhciB0ciA9IHRoaXM7CiAgdmFyIGRlZmVycmVkID0gU0lQLlV0aWxzLmRlZmVyKCk7CgogIGlmKHN0YXR1c19jb2RlID09PSAxMDApIHsKICAgIC8qIFJGQyA0MzIwIDQuMQogICAgICogJ0EgU0lQIGVsZW1lbnQgTVVTVCBOT1QKICAgICAqIHNlbmQgYW55IHByb3Zpc2lvbmFsIHJlc3BvbnNlIHdpdGggYQogICAgICogU3RhdHVzLUNvZGUgb3RoZXIgdGhhbiAxMDAgdG8gYSBub24tSU5WSVRFIHJlcXVlc3QuJwogICAgICovCiAgICBzd2l0Y2godGhpcy5zdGF0ZSkgewogICAgICBjYXNlIEMuU1RBVFVTX1RSWUlORzoKICAgICAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19QUk9DRUVESU5HKTsKICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpICB7CiAgICAgICAgICB0aGlzLm9uVHJhbnNwb3J0RXJyb3IoKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICB0aGlzLmxhc3RfcmVzcG9uc2UgPSByZXNwb25zZTsKICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpIHsKICAgICAgICAgIHRoaXMub25UcmFuc3BvcnRFcnJvcigpOwogICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfSBlbHNlIGlmKHN0YXR1c19jb2RlID49IDIwMCAmJiBzdGF0dXNfY29kZSA8PSA2OTkpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfVFJZSU5HOgogICAgICBjYXNlIEMuU1RBVFVTX1BST0NFRURJTkc6CiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfQ09NUExFVEVEKTsKICAgICAgICB0aGlzLmxhc3RfcmVzcG9uc2UgPSByZXNwb25zZTsKICAgICAgICB0aGlzLkogPSBTSVAuVGltZXJzLnNldFRpbWVvdXQodHIudGltZXJfSi5iaW5kKHRyKSwgU0lQLlRpbWVycy5USU1FUl9KKTsKICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpIHsKICAgICAgICAgIHRoaXMub25UcmFuc3BvcnRFcnJvcigpOwogICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgQy5TVEFUVVNfQ09NUExFVEVEOgogICAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7Cn07CgovKioKKiBAYXVnbWVudHMgU0lQLlRyYW5zYWN0aW9ucwoqIEBjbGFzcyBJbnZpdGUgU2VydmVyIFRyYW5zYWN0aW9uCiogQHBhcmFtIHtTSVAuSW5jb21pbmdSZXF1ZXN0fSByZXF1ZXN0CiogQHBhcmFtIHtTSVAuVUF9IHVhCiovCnZhciBJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uKHJlcXVlc3QsIHVhKSB7CiAgdGhpcy50eXBlID0gQy5JTlZJVEVfU0VSVkVSOwogIHRoaXMuaWQgPSByZXF1ZXN0LnZpYV9icmFuY2g7CiAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDsKICB0aGlzLnRyYW5zcG9ydCA9IHJlcXVlc3QudHJhbnNwb3J0OwogIHRoaXMudWEgPSB1YTsKICB0aGlzLmxhc3RfcmVzcG9uc2UgPSAnJzsKICByZXF1ZXN0LnNlcnZlcl90cmFuc2FjdGlvbiA9IHRoaXM7CgogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAudHJhbnNhY3Rpb24uaXN0JywgdGhpcy5pZCk7CgogIHRoaXMuc3RhdGUgPSBDLlNUQVRVU19QUk9DRUVESU5HOwoKICB1YS5uZXdUcmFuc2FjdGlvbih0aGlzKTsKCiAgdGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyID0gbnVsbDsKCiAgcmVxdWVzdC5yZXBseSgxMDApOwp9OwpJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKCkludml0ZVNlcnZlclRyYW5zYWN0aW9uLnByb3RvdHlwZS5zdGF0ZUNoYW5nZWQgPSBmdW5jdGlvbihzdGF0ZSkgewogIHRoaXMuc3RhdGUgPSBzdGF0ZTsKICB0aGlzLmVtaXQoJ3N0YXRlQ2hhbmdlZCcpOwp9OwoKSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnRpbWVyX0ggPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ1RpbWVyIEggZXhwaXJlZCBmb3IgSU5WSVRFIHNlcnZlciB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CgogIGlmKHRoaXMuc3RhdGUgPT09IEMuU1RBVFVTX0NPTVBMRVRFRCkgewogICAgdGhpcy5sb2dnZXIud2FybigndHJhbnNhY3Rpb25zJywgJ0FDSyBmb3IgSU5WSVRFIHNlcnZlciB0cmFuc2FjdGlvbiB3YXMgbmV2ZXIgcmVjZWl2ZWQsIGNhbGwgd2lsbCBiZSB0ZXJtaW5hdGVkJyk7CiAgfQoKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICB0aGlzLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKfTsKCkludml0ZVNlcnZlclRyYW5zYWN0aW9uLnByb3RvdHlwZS50aW1lcl9JID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgdGhpcy51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7Cn07CgovLyBSRkMgNjAyNiA3LjEKSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnRpbWVyX0wgPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ1RpbWVyIEwgZXhwaXJlZCBmb3IgSU5WSVRFIHNlcnZlciB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CgogIGlmKHRoaXMuc3RhdGUgPT09IEMuU1RBVFVTX0FDQ0VQVEVEKSB7CiAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICAgIHRoaXMudWEuZGVzdHJveVRyYW5zYWN0aW9uKHRoaXMpOwogIH0KfTsKCkludml0ZVNlcnZlclRyYW5zYWN0aW9uLnByb3RvdHlwZS5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24oKSB7CiAgaWYgKCF0aGlzLnRyYW5zcG9ydEVycm9yKSB7CiAgICB0aGlzLnRyYW5zcG9ydEVycm9yID0gdHJ1ZTsKCiAgICB0aGlzLmxvZ2dlci5sb2coJ3RyYW5zcG9ydCBlcnJvciBvY2N1cnJlZCwgZGVsZXRpbmcgSU5WSVRFIHNlcnZlciB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CgogICAgaWYgKHRoaXMucmVzZW5kUHJvdmlzaW9uYWxUaW1lciAhPT0gbnVsbCkgewogICAgICBTSVAuVGltZXJzLmNsZWFySW50ZXJ2YWwodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyKTsKICAgICAgdGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyID0gbnVsbDsKICAgIH0KCiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLkwpOwogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5IKTsKICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMuSSk7CgogICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgICB0aGlzLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKICB9Cn07CgpJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUucmVzZW5kX3Byb3Zpc2lvbmFsID0gZnVuY3Rpb24oKSB7CiAgaWYoIXRoaXMudHJhbnNwb3J0LnNlbmQodGhpcy5sYXN0X3Jlc3BvbnNlKSkgewogICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgfQp9OwoKLy8gSU5WSVRFIFNlcnZlciBUcmFuc2FjdGlvbiBSRkMgMzI2MSAxNy4yLjEKSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKHN0YXR1c19jb2RlLCByZXNwb25zZSkgewogIHZhciB0ciA9IHRoaXM7CiAgdmFyIGRlZmVycmVkID0gU0lQLlV0aWxzLmRlZmVyKCk7CgogIGlmKHN0YXR1c19jb2RlID49IDEwMCAmJiBzdGF0dXNfY29kZSA8PSAxOTkpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpIHsKICAgICAgICAgIHRoaXMub25UcmFuc3BvcnRFcnJvcigpOwogICAgICAgIH0KICAgICAgICB0aGlzLmxhc3RfcmVzcG9uc2UgPSByZXNwb25zZTsKICAgICAgICBicmVhazsKICAgIH0KICB9CgogIGlmKHN0YXR1c19jb2RlID4gMTAwICYmIHN0YXR1c19jb2RlIDw9IDE5OSAmJiB0aGlzLnN0YXRlID09PSBDLlNUQVRVU19QUk9DRUVESU5HKSB7CiAgICAvLyBUcmlnZ2VyIHRoZSByZXNlbmRQcm92aXNpb25hbFRpbWVyIG9ubHkgZm9yIHRoZSBmaXJzdCBub24gMTAwIHByb3Zpc2lvbmFsIHJlc3BvbnNlLgogICAgaWYodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyID09PSBudWxsKSB7CiAgICAgIHRoaXMucmVzZW5kUHJvdmlzaW9uYWxUaW1lciA9IFNJUC5UaW1lcnMuc2V0SW50ZXJ2YWwodHIucmVzZW5kX3Byb3Zpc2lvbmFsLmJpbmQodHIpLAogICAgICAgIFNJUC5UaW1lcnMuUFJPVklTSU9OQUxfUkVTUE9OU0VfSU5URVJWQUwpOwogICAgfQogIH0gZWxzZSBpZihzdGF0dXNfY29kZSA+PSAyMDAgJiYgc3RhdHVzX2NvZGUgPD0gMjk5KSB7CiAgICBzd2l0Y2godGhpcy5zdGF0ZSkgewogICAgICBjYXNlIEMuU1RBVFVTX1BST0NFRURJTkc6CiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfQUNDRVBURUQpOwogICAgICAgIHRoaXMubGFzdF9yZXNwb25zZSA9IHJlc3BvbnNlOwogICAgICAgIHRoaXMuTCA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9MLmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX0wpOwoKICAgICAgICBpZiAodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyICE9PSBudWxsKSB7CiAgICAgICAgICBTSVAuVGltZXJzLmNsZWFySW50ZXJ2YWwodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyKTsKICAgICAgICAgIHRoaXMucmVzZW5kUHJvdmlzaW9uYWxUaW1lciA9IG51bGw7CiAgICAgICAgfQogICAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi8KICAgICAgICBjYXNlIEMuU1RBVFVTX0FDQ0VQVEVEOgogICAgICAgICAgLy8gTm90ZSB0aGF0IHRoaXMgcG9pbnQgd2lsbCBiZSByZWFjaGVkIGZvciBwcm9jZWVkaW5nIHRyLnN0YXRlIGFsc28uCiAgICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpIHsKICAgICAgICAgICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICB9CiAgfSBlbHNlIGlmKHN0YXR1c19jb2RlID49IDMwMCAmJiBzdGF0dXNfY29kZSA8PSA2OTkpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICBpZiAodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyICE9PSBudWxsKSB7CiAgICAgICAgICBTSVAuVGltZXJzLmNsZWFySW50ZXJ2YWwodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyKTsKICAgICAgICAgIHRoaXMucmVzZW5kUHJvdmlzaW9uYWxUaW1lciA9IG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZighdGhpcy50cmFuc3BvcnQuc2VuZChyZXNwb25zZSkpIHsKICAgICAgICAgIHRoaXMub25UcmFuc3BvcnRFcnJvcigpOwogICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX0NPTVBMRVRFRCk7CiAgICAgICAgICB0aGlzLkggPSBTSVAuVGltZXJzLnNldFRpbWVvdXQodHIudGltZXJfSC5iaW5kKHRyKSwgU0lQLlRpbWVycy5USU1FUl9IKTsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfQoKICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTsKfTsKCi8qKgogKiBAZnVuY3Rpb24KICogQHBhcmFtIHtTSVAuVUF9IHVhCiAqIEBwYXJhbSB7U0lQLkluY29taW5nUmVxdWVzdH0gcmVxdWVzdAogKgogKiBAcmV0dXJuIHtib29sZWFufQogKiBJTlZJVEU6CiAqICBfdHJ1ZV8gaWYgcmV0cmFuc21pc3Npb24KICogIF9mYWxzZV8gbmV3IHJlcXVlc3QKICoKICogQUNLOgogKiAgX3RydWVfICBBQ0sgdG8gbm9uMnh4IHJlc3BvbnNlCiAqICBfZmFsc2VfIEFDSyBtdXN0IGJlIHBhc3NlZCB0byBUVSAoYWNjZXB0ZWQgc3RhdGUpCiAqICAgICAgICAgIEFDSyB0byAyeHggcmVzcG9uc2UKICoKICogQ0FOQ0VMOgogKiAgX3RydWVfICBubyBtYXRjaGluZyBpbnZpdGUgdHJhbnNhY3Rpb24KICogIF9mYWxzZV8gbWF0Y2hpbmcgaW52aXRlIHRyYW5zYWN0aW9uIGFuZCBubyBmaW5hbCByZXNwb25zZSBzZW50CiAqCiAqIE9USEVSOgogKiAgX3RydWVfICByZXRyYW5zbWlzc2lvbgogKiAgX2ZhbHNlXyBuZXcgcmVxdWVzdAogKi8KdmFyIGNoZWNrVHJhbnNhY3Rpb24gPSBmdW5jdGlvbih1YSwgcmVxdWVzdCkgewogIHZhciB0cjsKCiAgc3dpdGNoKHJlcXVlc3QubWV0aG9kKSB7CiAgICBjYXNlIFNJUC5DLklOVklURToKICAgICAgdHIgPSB1YS50cmFuc2FjdGlvbnMuaXN0W3JlcXVlc3QudmlhX2JyYW5jaF07CiAgICAgIGlmKHRyKSB7CiAgICAgICAgc3dpdGNoKHRyLnN0YXRlKSB7CiAgICAgICAgICBjYXNlIEMuU1RBVFVTX1BST0NFRURJTkc6CiAgICAgICAgICAgIHRyLnRyYW5zcG9ydC5zZW5kKHRyLmxhc3RfcmVzcG9uc2UpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIC8vIFJGQyA2MDI2IDcuMSBJbnZpdGUgcmV0cmFuc21pc3Npb24KICAgICAgICAgICAgLy9yZWNlaXZlZCB3aGlsZSBpbiBDLlNUQVRVU19BQ0NFUFRFRCBzdGF0ZS4gQWJzb3JiIGl0LgogICAgICAgICAgY2FzZSBDLlNUQVRVU19BQ0NFUFRFRDoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSBTSVAuQy5BQ0s6CiAgICAgIHRyID0gdWEudHJhbnNhY3Rpb25zLmlzdFtyZXF1ZXN0LnZpYV9icmFuY2hdOwoKICAgICAgLy8gUkZDIDYwMjYgNy4xCiAgICAgIGlmKHRyKSB7CiAgICAgICAgaWYodHIuc3RhdGUgPT09IEMuU1RBVFVTX0FDQ0VQVEVEKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmKHRyLnN0YXRlID09PSBDLlNUQVRVU19DT01QTEVURUQpIHsKICAgICAgICAgIHRyLnN0YXRlID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICAgICAgdHIuSSA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9JLmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX0kpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBBQ0sgdG8gMlhYIFJlc3BvbnNlLgogICAgICBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlIFNJUC5DLkNBTkNFTDoKICAgICAgdHIgPSB1YS50cmFuc2FjdGlvbnMuaXN0W3JlcXVlc3QudmlhX2JyYW5jaF07CiAgICAgIGlmKHRyKSB7CiAgICAgICAgcmVxdWVzdC5yZXBseV9zbCgyMDApOwogICAgICAgIGlmKHRyLnN0YXRlID09PSBDLlNUQVRVU19QUk9DRUVESU5HKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXF1ZXN0LnJlcGx5X3NsKDQ4MSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgoKICAgICAgLy8gTm9uLUlOVklURSBTZXJ2ZXIgVHJhbnNhY3Rpb24gUkZDIDMyNjEgMTcuMi4yCiAgICAgIHRyID0gdWEudHJhbnNhY3Rpb25zLm5pc3RbcmVxdWVzdC52aWFfYnJhbmNoXTsKICAgICAgaWYodHIpIHsKICAgICAgICBzd2l0Y2godHIuc3RhdGUpIHsKICAgICAgICAgIGNhc2UgQy5TVEFUVVNfVFJZSU5HOgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICAgIGNhc2UgQy5TVEFUVVNfQ09NUExFVEVEOgogICAgICAgICAgICB0ci50cmFuc3BvcnQuc2VuZCh0ci5sYXN0X3Jlc3BvbnNlKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIGJyZWFrOwogIH0KfTsKClNJUC5UcmFuc2FjdGlvbnMgPSB7CiAgQzogQywKICBjaGVja1RyYW5zYWN0aW9uOiBjaGVja1RyYW5zYWN0aW9uLAogIE5vbkludml0ZUNsaWVudFRyYW5zYWN0aW9uOiBOb25JbnZpdGVDbGllbnRUcmFuc2FjdGlvbiwKICBJbnZpdGVDbGllbnRUcmFuc2FjdGlvbjogSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24sCiAgQWNrQ2xpZW50VHJhbnNhY3Rpb246IEFja0NsaWVudFRyYW5zYWN0aW9uLAogIE5vbkludml0ZVNlcnZlclRyYW5zYWN0aW9uOiBOb25JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbiwKICBJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbjogSW52aXRlU2VydmVyVHJhbnNhY3Rpb24KfTsKCn07Cgp9LHt9XSwzNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgVHJhbnNwb3J0CiAqLwoKLyoqCiAqIEBhdWdtZW50cyBTSVAKICogQGNsYXNzIFRyYW5zcG9ydAogKiBAcGFyYW0ge1NJUC5VQX0gdWEKICogQHBhcmFtIHtPYmplY3R9IHNlcnZlciB3c19zZXJ2ZXIgT2JqZWN0CiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVAsIFdlYlNvY2tldCkgewp2YXIgVHJhbnNwb3J0LAogIEMgPSB7CiAgICAvLyBUcmFuc3BvcnQgc3RhdHVzIGNvZGVzCiAgICBTVEFUVVNfUkVBRFk6ICAgICAgICAwLAogICAgU1RBVFVTX0RJU0NPTk5FQ1RFRDogMSwKICAgIFNUQVRVU19FUlJPUjogICAgICAgIDIKICB9OwoKLyoqCiAqIENvbXB1dGUgYW4gYW1vdW50IG9mIHRpbWUgaW4gc2Vjb25kcyB0byB3YWl0IGJlZm9yZSBzZW5kaW5nIGFub3RoZXIKICoga2VlcC1hbGl2ZS4KICogQHJldHVybnMge051bWJlcn0KICovCmZ1bmN0aW9uIGNvbXB1dGVLZWVwQWxpdmVUaW1lb3V0KHVwcGVyQm91bmQpIHsKICB2YXIgbG93ZXJCb3VuZCA9IHVwcGVyQm91bmQgKiAwLjg7CiAgcmV0dXJuIDEwMDAgKiAoTWF0aC5yYW5kb20oKSAqICh1cHBlckJvdW5kIC0gbG93ZXJCb3VuZCkgKyBsb3dlckJvdW5kKTsKfQoKVHJhbnNwb3J0ID0gZnVuY3Rpb24odWEsIHNlcnZlcikgewoKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnRyYW5zcG9ydCcpOwogIHRoaXMudWEgPSB1YTsKICB0aGlzLndzID0gbnVsbDsKICB0aGlzLnNlcnZlciA9IHNlcnZlcjsKICB0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyA9IDA7CiAgdGhpcy5jbG9zZWQgPSBmYWxzZTsKICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlOwogIHRoaXMucmVjb25uZWN0VGltZXIgPSBudWxsOwogIHRoaXMubGFzdFRyYW5zcG9ydEVycm9yID0ge307CgogIHRoaXMua2VlcEFsaXZlSW50ZXJ2YWwgPSB1YS5jb25maWd1cmF0aW9uLmtlZXBBbGl2ZUludGVydmFsOwogIHRoaXMua2VlcEFsaXZlVGltZW91dCA9IG51bGw7CiAgdGhpcy5rZWVwQWxpdmVUaW1lciA9IG51bGw7CgogIHRoaXMudWEudHJhbnNwb3J0ID0gdGhpczsKCiAgLy8gQ29ubmVjdAogIHRoaXMuY29ubmVjdCgpOwp9OwoKVHJhbnNwb3J0LnByb3RvdHlwZSA9IHsKICAvKioKICAgKiBTZW5kIGEgbWVzc2FnZS4KICAgKiBAcGFyYW0ge1NJUC5PdXRnb2luZ1JlcXVlc3R8U3RyaW5nfSBtc2cKICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0KICAgKi8KICBzZW5kOiBmdW5jdGlvbihtc2cpIHsKICAgIHZhciBtZXNzYWdlID0gbXNnLnRvU3RyaW5nKCk7CgogICAgaWYodGhpcy53cyAmJiB0aGlzLndzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7CiAgICAgIGlmICh0aGlzLnVhLmNvbmZpZ3VyYXRpb24udHJhY2VTaXAgPT09IHRydWUpIHsKICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ3NlbmRpbmcgV2ViU29ja2V0IG1lc3NhZ2U6XG5cbicgKyBtZXNzYWdlICsgJ1xuJyk7CiAgICAgIH0KICAgICAgdGhpcy53cy5zZW5kKG1lc3NhZ2UpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ3VuYWJsZSB0byBzZW5kIG1lc3NhZ2UsIFdlYlNvY2tldCBpcyBub3Qgb3BlbicpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogU2VuZCBhIGtlZXAtYWxpdmUgKGEgZG91YmxlLUNSTEYgc2VxdWVuY2UpLgogICAqIEBwcml2YXRlCiAgICogQHJldHVybnMge0Jvb2xlYW59CiAgICovCiAgc2VuZEtlZXBBbGl2ZTogZnVuY3Rpb24oKSB7CiAgICBpZih0aGlzLmtlZXBBbGl2ZVRpbWVvdXQpIHsgcmV0dXJuOyB9CgogICAgdGhpcy5rZWVwQWxpdmVUaW1lb3V0ID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnVhLmVtaXQoJ2tlZXBBbGl2ZVRpbWVvdXQnKTsKICAgIH0uYmluZCh0aGlzKSwgMTAwMDApOwoKICAgIHJldHVybiB0aGlzLnNlbmQoJ1xyXG5cclxuJyk7CiAgfSwKCiAgLyoqCiAgICogU3RhcnQgc2VuZGluZyBrZWVwLWFsaXZlcy4KICAgKiBAcHJpdmF0ZQogICAqLwogIHN0YXJ0U2VuZGluZ0tlZXBBbGl2ZXM6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMua2VlcEFsaXZlSW50ZXJ2YWwgJiYgIXRoaXMua2VlcEFsaXZlVGltZXIpIHsKICAgICAgdGhpcy5rZWVwQWxpdmVUaW1lciA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICB0aGlzLnNlbmRLZWVwQWxpdmUoKTsKICAgICAgICB0aGlzLmtlZXBBbGl2ZVRpbWVyID0gbnVsbDsKICAgICAgICB0aGlzLnN0YXJ0U2VuZGluZ0tlZXBBbGl2ZXMoKTsKICAgICAgfS5iaW5kKHRoaXMpLCBjb21wdXRlS2VlcEFsaXZlVGltZW91dCh0aGlzLmtlZXBBbGl2ZUludGVydmFsKSk7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogU3RvcCBzZW5kaW5nIGtlZXAtYWxpdmVzLgogICAqIEBwcml2YXRlCiAgICovCiAgc3RvcFNlbmRpbmdLZWVwQWxpdmVzOiBmdW5jdGlvbigpIHsKICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMua2VlcEFsaXZlVGltZXIpOwogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5rZWVwQWxpdmVUaW1lb3V0KTsKICAgIHRoaXMua2VlcEFsaXZlVGltZXIgPSBudWxsOwogICAgdGhpcy5rZWVwQWxpdmVUaW1lb3V0ID0gbnVsbDsKICB9LAoKICAvKioKICAqIERpc2Nvbm5lY3Qgc29ja2V0LgogICovCiAgZGlzY29ubmVjdDogZnVuY3Rpb24oKSB7CiAgICBpZih0aGlzLndzKSB7CiAgICAgIC8vIENsZWFyIHJlY29ubmVjdFRpbWVyCiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVjb25uZWN0VGltZXIpOwoKICAgICAgdGhpcy5zdG9wU2VuZGluZ0tlZXBBbGl2ZXMoKTsKCiAgICAgIHRoaXMuY2xvc2VkID0gdHJ1ZTsKICAgICAgdGhpcy5sb2dnZXIubG9nKCdjbG9zaW5nIFdlYlNvY2tldCAnICsgdGhpcy5zZXJ2ZXIud3NfdXJpKTsKICAgICAgdGhpcy53cy5jbG9zZSgpOwogICAgfQoKICAgIGlmICh0aGlzLnJlY29ubmVjdFRpbWVyICE9PSBudWxsKSB7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVjb25uZWN0VGltZXIpOwogICAgICB0aGlzLnJlY29ubmVjdFRpbWVyID0gbnVsbDsKICAgICAgdGhpcy51YS5lbWl0KCdkaXNjb25uZWN0ZWQnLCB7CiAgICAgICAgdHJhbnNwb3J0OiB0aGlzLAogICAgICAgIGNvZGU6IHRoaXMubGFzdFRyYW5zcG9ydEVycm9yLmNvZGUsCiAgICAgICAgcmVhc29uOiB0aGlzLmxhc3RUcmFuc3BvcnRFcnJvci5yZWFzb24KICAgICAgfSk7CiAgICB9CiAgfSwKCiAgLyoqCiAgKiBDb25uZWN0IHNvY2tldC4KICAqLwogIGNvbm5lY3Q6IGZ1bmN0aW9uKCkgewogICAgdmFyIHRyYW5zcG9ydCA9IHRoaXM7CgogICAgaWYodGhpcy53cyAmJiAodGhpcy53cy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTiB8fCB0aGlzLndzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5DT05ORUNUSU5HKSkgewogICAgICB0aGlzLmxvZ2dlci5sb2coJ1dlYlNvY2tldCAnICsgdGhpcy5zZXJ2ZXIud3NfdXJpICsgJyBpcyBhbHJlYWR5IGNvbm5lY3RlZCcpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYodGhpcy53cykgewogICAgICB0aGlzLndzLmNsb3NlKCk7CiAgICB9CgogICAgdGhpcy5sb2dnZXIubG9nKCdjb25uZWN0aW5nIHRvIFdlYlNvY2tldCAnICsgdGhpcy5zZXJ2ZXIud3NfdXJpKTsKICAgIHRoaXMudWEub25UcmFuc3BvcnRDb25uZWN0aW5nKHRoaXMsCiAgICAgICh0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyA9PT0gMCk/MTp0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyk7CgogICAgdHJ5IHsKICAgICAgdGhpcy53cyA9IG5ldyBXZWJTb2NrZXQodGhpcy5zZXJ2ZXIud3NfdXJpLCAnc2lwJyk7CiAgICB9IGNhdGNoKGUpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybignZXJyb3IgY29ubmVjdGluZyB0byBXZWJTb2NrZXQgJyArIHRoaXMuc2VydmVyLndzX3VyaSArICc6ICcgKyBlKTsKICAgIH0KCiAgICB0aGlzLndzLmJpbmFyeVR5cGUgPSAnYXJyYXlidWZmZXInOwoKICAgIHRoaXMud3Mub25vcGVuID0gZnVuY3Rpb24oKSB7CiAgICAgIHRyYW5zcG9ydC5vbk9wZW4oKTsKICAgIH07CgogICAgdGhpcy53cy5vbmNsb3NlID0gZnVuY3Rpb24oZSkgewogICAgICB0cmFuc3BvcnQub25DbG9zZShlKTsKICAgIH07CgogICAgdGhpcy53cy5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlKSB7CiAgICAgIHRyYW5zcG9ydC5vbk1lc3NhZ2UoZSk7CiAgICB9OwoKICAgIHRoaXMud3Mub25lcnJvciA9IGZ1bmN0aW9uKGUpIHsKICAgICAgdHJhbnNwb3J0Lm9uRXJyb3IoZSk7CiAgICB9OwogIH0sCgogIC8vIFRyYW5zcG9ydCBFdmVudCBIYW5kbGVycwoKICAvKioKICAqIEBldmVudAogICogQHBhcmFtIHtldmVudH0gZQogICovCiAgb25PcGVuOiBmdW5jdGlvbigpIHsKICAgIHRoaXMuY29ubmVjdGVkID0gdHJ1ZTsKCiAgICB0aGlzLmxvZ2dlci5sb2coJ1dlYlNvY2tldCAnICsgdGhpcy5zZXJ2ZXIud3NfdXJpICsgJyBjb25uZWN0ZWQnKTsKICAgIC8vIENsZWFyIHJlY29ubmVjdFRpbWVyIHNpbmNlIHdlIGFyZSBub3QgZGlzY29ubmVjdGVkCiAgICBpZiAodGhpcy5yZWNvbm5lY3RUaW1lciAhPT0gbnVsbCkgewogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnJlY29ubmVjdFRpbWVyKTsKICAgICAgdGhpcy5yZWNvbm5lY3RUaW1lciA9IG51bGw7CiAgICB9CiAgICAvLyBSZXNldCByZWNvbm5lY3Rpb25fYXR0ZW1wdHMKICAgIHRoaXMucmVjb25uZWN0aW9uX2F0dGVtcHRzID0gMDsKICAgIC8vIERpc2FibGUgY2xvc2VkCiAgICB0aGlzLmNsb3NlZCA9IGZhbHNlOwogICAgLy8gVHJpZ2dlciBvblRyYW5zcG9ydENvbm5lY3RlZCBjYWxsYmFjawogICAgdGhpcy51YS5vblRyYW5zcG9ydENvbm5lY3RlZCh0aGlzKTsKICAgIC8vIFN0YXJ0IHNlbmRpbmcga2VlcC1hbGl2ZXMKICAgIHRoaXMuc3RhcnRTZW5kaW5nS2VlcEFsaXZlcygpOwogIH0sCgogIC8qKgogICogQGV2ZW50CiAgKiBAcGFyYW0ge2V2ZW50fSBlCiAgKi8KICBvbkNsb3NlOiBmdW5jdGlvbihlKSB7CiAgICB2YXIgY29ubmVjdGVkX2JlZm9yZSA9IHRoaXMuY29ubmVjdGVkOwoKICAgIHRoaXMubGFzdFRyYW5zcG9ydEVycm9yLmNvZGUgPSBlLmNvZGU7CiAgICB0aGlzLmxhc3RUcmFuc3BvcnRFcnJvci5yZWFzb24gPSBlLnJlYXNvbjsKCiAgICB0aGlzLnN0b3BTZW5kaW5nS2VlcEFsaXZlcygpOwoKICAgIGlmICh0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyA+IDApIHsKICAgICAgdGhpcy5sb2dnZXIubG9nKCdSZWNvbm5lY3Rpb24gYXR0ZW1wdCAnICsgdGhpcy5yZWNvbm5lY3Rpb25fYXR0ZW1wdHMgKyAnIGZhaWxlZCAoY29kZTogJyArIGUuY29kZSArIChlLnJlYXNvbj8gJ3wgcmVhc29uOiAnICsgZS5yZWFzb24gOiAnJykgKycpJyk7CiAgICAgIHRoaXMucmVjb25uZWN0KCk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlOwogICAgICB0aGlzLmxvZ2dlci5sb2coJ1dlYlNvY2tldCBkaXNjb25uZWN0ZWQgKGNvZGU6ICcgKyBlLmNvZGUgKyAoZS5yZWFzb24/ICd8IHJlYXNvbjogJyArIGUucmVhc29uIDogJycpICsnKScpOwoKICAgICAgaWYoZS53YXNDbGVhbiA9PT0gZmFsc2UpIHsKICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCdXZWJTb2NrZXQgYWJydXB0IGRpc2Nvbm5lY3Rpb24nKTsKICAgICAgfQogICAgICAvLyBUcmFuc3BvcnQgd2FzIGNvbm5lY3RlZAogICAgICBpZihjb25uZWN0ZWRfYmVmb3JlID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy51YS5vblRyYW5zcG9ydENsb3NlZCh0aGlzKTsKICAgICAgICAvLyBDaGVjayB3aGV0aGVyIHRoZSB1c2VyIHJlcXVlc3RlZCB0byBjbG9zZS4KICAgICAgICBpZighdGhpcy5jbG9zZWQpIHsKICAgICAgICAgIHRoaXMucmVjb25uZWN0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudWEuZW1pdCgnZGlzY29ubmVjdGVkJywgewogICAgICAgICAgICB0cmFuc3BvcnQ6IHRoaXMsCiAgICAgICAgICAgIGNvZGU6IHRoaXMubGFzdFRyYW5zcG9ydEVycm9yLmNvZGUsCiAgICAgICAgICAgIHJlYXNvbjogdGhpcy5sYXN0VHJhbnNwb3J0RXJyb3IucmVhc29uCiAgICAgICAgICB9KTsKCiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IGNvbm5lY3Rpb24gYXR0ZW1wdAogICAgICAgIC8vTmV0d29yayBlcnJvcgogICAgICAgIHRoaXMudWEub25UcmFuc3BvcnRFcnJvcih0aGlzKTsKICAgICAgfQogICAgfQogIH0sCgogIC8qKgogICogQGV2ZW50CiAgKiBAcGFyYW0ge2V2ZW50fSBlCiAgKi8KICBvbk1lc3NhZ2U6IGZ1bmN0aW9uKGUpIHsKICAgIHZhciBtZXNzYWdlLCB0cmFuc2FjdGlvbiwKICAgICAgZGF0YSA9IGUuZGF0YTsKCiAgICAvLyBDUkxGIEtlZXAgQWxpdmUgcmVzcG9uc2UgZnJvbSBzZXJ2ZXIuIElnbm9yZSBpdC4KICAgIGlmKGRhdGEgPT09ICdcclxuJykgewogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLmtlZXBBbGl2ZVRpbWVvdXQpOwogICAgICB0aGlzLmtlZXBBbGl2ZVRpbWVvdXQgPSBudWxsOwoKICAgICAgaWYgKHRoaXMudWEuY29uZmlndXJhdGlvbi50cmFjZVNpcCA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMubG9nZ2VyLmxvZygncmVjZWl2ZWQgV2ViU29ja2V0IG1lc3NhZ2Ugd2l0aCBDUkxGIEtlZXAgQWxpdmUgcmVzcG9uc2UnKTsKICAgICAgfQoKICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIFdlYlNvY2tldCBiaW5hcnkgbWVzc2FnZS4KICAgIGVsc2UgaWYgKHR5cGVvZiBkYXRhICE9PSAnc3RyaW5nJykgewogICAgICB0cnkgewogICAgICAgIGRhdGEgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIG5ldyBVaW50OEFycmF5KGRhdGEpKTsKICAgICAgfSBjYXRjaChldnQpIHsKICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCdyZWNlaXZlZCBXZWJTb2NrZXQgYmluYXJ5IG1lc3NhZ2UgZmFpbGVkIHRvIGJlIGNvbnZlcnRlZCBpbnRvIHN0cmluZywgbWVzc2FnZSBkaXNjYXJkZWQnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnVhLmNvbmZpZ3VyYXRpb24udHJhY2VTaXAgPT09IHRydWUpIHsKICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ3JlY2VpdmVkIFdlYlNvY2tldCBiaW5hcnkgbWVzc2FnZTpcblxuJyArIGRhdGEgKyAnXG4nKTsKICAgICAgfQogICAgfQoKICAgIC8vIFdlYlNvY2tldCB0ZXh0IG1lc3NhZ2UuCiAgICBlbHNlIHsKICAgICAgaWYgKHRoaXMudWEuY29uZmlndXJhdGlvbi50cmFjZVNpcCA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMubG9nZ2VyLmxvZygncmVjZWl2ZWQgV2ViU29ja2V0IHRleHQgbWVzc2FnZTpcblxuJyArIGRhdGEgKyAnXG4nKTsKICAgICAgfQogICAgfQoKICAgIG1lc3NhZ2UgPSBTSVAuUGFyc2VyLnBhcnNlTWVzc2FnZShkYXRhLCB0aGlzLnVhKTsKCiAgICBpZiAoIW1lc3NhZ2UpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmKHRoaXMudWEuc3RhdHVzID09PSBTSVAuVUEuQy5TVEFUVVNfVVNFUl9DTE9TRUQgJiYgbWVzc2FnZSBpbnN0YW5jZW9mIFNJUC5JbmNvbWluZ1JlcXVlc3QpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIERvIHNvbWUgc2FuaXR5IGNoZWNrCiAgICBpZihTSVAuc2FuaXR5Q2hlY2sobWVzc2FnZSwgdGhpcy51YSwgdGhpcykpIHsKICAgICAgaWYobWVzc2FnZSBpbnN0YW5jZW9mIFNJUC5JbmNvbWluZ1JlcXVlc3QpIHsKICAgICAgICBtZXNzYWdlLnRyYW5zcG9ydCA9IHRoaXM7CiAgICAgICAgdGhpcy51YS5yZWNlaXZlUmVxdWVzdChtZXNzYWdlKTsKICAgICAgfSBlbHNlIGlmKG1lc3NhZ2UgaW5zdGFuY2VvZiBTSVAuSW5jb21pbmdSZXNwb25zZSkgewogICAgICAgIC8qIFVuaWtlIHN0YXRlZCBpbiAxOC4xLjIsIGlmIGEgcmVzcG9uc2UgZG9lcyBub3QgbWF0Y2gKICAgICAgICAqIGFueSB0cmFuc2FjdGlvbiwgaXQgaXMgZGlzY2FyZGVkIGhlcmUgYW5kIG5vIHBhc3NlZCB0byB0aGUgY29yZQogICAgICAgICogaW4gb3JkZXIgdG8gYmUgZGlzY2FyZGVkIHRoZXJlLgogICAgICAgICovCiAgICAgICAgc3dpdGNoKG1lc3NhZ2UubWV0aG9kKSB7CiAgICAgICAgICBjYXNlIFNJUC5DLklOVklURToKICAgICAgICAgICAgdHJhbnNhY3Rpb24gPSB0aGlzLnVhLnRyYW5zYWN0aW9ucy5pY3RbbWVzc2FnZS52aWFfYnJhbmNoXTsKICAgICAgICAgICAgaWYodHJhbnNhY3Rpb24pIHsKICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5yZWNlaXZlUmVzcG9uc2UobWVzc2FnZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIFNJUC5DLkFDSzoKICAgICAgICAgICAgLy8gSnVzdCBpbiBjYXNlIDstKQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIHRyYW5zYWN0aW9uID0gdGhpcy51YS50cmFuc2FjdGlvbnMubmljdFttZXNzYWdlLnZpYV9icmFuY2hdOwogICAgICAgICAgICBpZih0cmFuc2FjdGlvbikgewogICAgICAgICAgICAgIHRyYW5zYWN0aW9uLnJlY2VpdmVSZXNwb25zZShtZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAoKICAvKioKICAqIEBldmVudAogICogQHBhcmFtIHtldmVudH0gZQogICovCiAgb25FcnJvcjogZnVuY3Rpb24oZSkgewogICAgdGhpcy5sb2dnZXIud2FybignV2ViU29ja2V0IGNvbm5lY3Rpb24gZXJyb3I6ICcgKyBKU09OLnN0cmluZ2lmeShlKSk7CiAgfSwKCiAgLyoqCiAgKiBSZWNvbm5lY3Rpb24gYXR0ZW1wdCBsb2dpYy4KICAqIEBwcml2YXRlCiAgKi8KICByZWNvbm5lY3Q6IGZ1bmN0aW9uKCkgewogICAgdmFyIHRyYW5zcG9ydCA9IHRoaXM7CgogICAgdGhpcy5yZWNvbm5lY3Rpb25fYXR0ZW1wdHMgKz0gMTsKCiAgICBpZih0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyA+IHRoaXMudWEuY29uZmlndXJhdGlvbi53c1NlcnZlck1heFJlY29ubmVjdGlvbikgewogICAgICB0aGlzLmxvZ2dlci53YXJuKCdtYXhpbXVtIHJlY29ubmVjdGlvbiBhdHRlbXB0cyBmb3IgV2ViU29ja2V0ICcgKyB0aGlzLnNlcnZlci53c191cmkpOwogICAgICB0aGlzLnVhLm9uVHJhbnNwb3J0RXJyb3IodGhpcyk7CiAgICB9IGVsc2UgaWYgKHRoaXMucmVjb25uZWN0aW9uX2F0dGVtcHRzID09PSAxKSB7CiAgICAgIHRoaXMubG9nZ2VyLmxvZygnQ29ubmVjdGlvbiB0byBXZWJTb2NrZXQgJyArIHRoaXMuc2VydmVyLndzX3VyaSArICcgc2V2ZXJlZCwgYXR0ZW1wdGluZyBmaXJzdCByZWNvbm5lY3QnKTsKICAgICAgdHJhbnNwb3J0LmNvbm5lY3QoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMubG9nZ2VyLmxvZygndHJ5aW5nIHRvIHJlY29ubmVjdCB0byBXZWJTb2NrZXQgJyArIHRoaXMuc2VydmVyLndzX3VyaSArICcgKHJlY29ubmVjdGlvbiBhdHRlbXB0ICcgKyB0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyArICcpJyk7CgogICAgICB0aGlzLnJlY29ubmVjdFRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgIHRyYW5zcG9ydC5jb25uZWN0KCk7CiAgICAgICAgdHJhbnNwb3J0LnJlY29ubmVjdFRpbWVyID0gbnVsbDsKICAgICAgfSwgdGhpcy51YS5jb25maWd1cmF0aW9uLndzU2VydmVyUmVjb25uZWN0aW9uVGltZW91dCAqIDEwMDApOwogICAgfQogIH0KfTsKClRyYW5zcG9ydC5DID0gQzsKcmV0dXJuIFRyYW5zcG9ydDsKfTsKCn0se31dLDM2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKKGZ1bmN0aW9uIChnbG9iYWwpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAYXVnbWVudHMgU0lQCiAqIEBjbGFzcyBDbGFzcyBjcmVhdGluZyBhIFNJUCBVc2VyIEFnZW50LgogKiBAcGFyYW0ge2Z1bmN0aW9uIHJldHVybmluZyBTSVAuTWVkaWFIYW5kbGVyfSBbY29uZmlndXJhdGlvbi5tZWRpYUhhbmRsZXJGYWN0b3J5XQogKiAgICAgICAgQSBmdW5jdGlvbiB3aWxsIGJlIGludm9rZWQgYnkgZWFjaCBvZiB0aGUgVUEncyBTZXNzaW9ucyB0byBidWlsZCB0aGUgTWVkaWFIYW5kbGVyIGZvciB0aGF0IFNlc3Npb24uCiAqICAgICAgICBJZiBubyAob3IgYSBmYWxzeSkgdmFsdWUgaXMgcHJvdmlkZWQsIGVhY2ggU2Vzc2lvbiB3aWxsIHVzZSBhIGRlZmF1bHQgKFdlYlJUQykgTWVkaWFIYW5kbGVyLgogKgogKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZ3VyYXRpb24ubWVkaWFdIGdldHMgcGFzc2VkIHRvIFNJUC5NZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24gYXMgbWVkaWFIaW50CiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVAsIGVudmlyb25tZW50KSB7CnZhciBVQSwKICBDID0gewogICAgLy8gVUEgc3RhdHVzIGNvZGVzCiAgICBTVEFUVVNfSU5JVDogICAgICAgICAgICAgICAgMCwKICAgIFNUQVRVU19TVEFSVElORzogICAgICAgICAgICAxLAogICAgU1RBVFVTX1JFQURZOiAgICAgICAgICAgICAgIDIsCiAgICBTVEFUVVNfVVNFUl9DTE9TRUQ6ICAgICAgICAgMywKICAgIFNUQVRVU19OT1RfUkVBRFk6ICAgICAgICAgICA0LAoKICAgIC8vIFVBIGVycm9yIGNvZGVzCiAgICBDT05GSUdVUkFUSU9OX0VSUk9SOiAgMSwKICAgIE5FVFdPUktfRVJST1I6ICAgICAgICAyLAoKICAgIEFMTE9XRURfTUVUSE9EUzogWwogICAgICAnQUNLJywKICAgICAgJ0NBTkNFTCcsCiAgICAgICdJTlZJVEUnLAogICAgICAnTUVTU0FHRScsCiAgICAgICdCWUUnLAogICAgICAnT1BUSU9OUycsCiAgICAgICdJTkZPJywKICAgICAgJ05PVElGWScsCiAgICAgICdSRUZFUicKICAgIF0sCgogICAgQUNDRVBURURfQk9EWV9UWVBFUzogWwogICAgICAnYXBwbGljYXRpb24vc2RwJywKICAgICAgJ2FwcGxpY2F0aW9uL2R0bWYtcmVsYXknCiAgICBdLAoKICAgIE1BWF9GT1JXQVJEUzogNzAsCiAgICBUQUdfTEVOR1RIOiAxMAogIH07CgpVQSA9IGZ1bmN0aW9uKGNvbmZpZ3VyYXRpb24pIHsKICB2YXIgc2VsZiA9IHRoaXM7CgogIC8vIEhlbHBlciBmdW5jdGlvbiBmb3IgZm9yd2FyZGluZyBldmVudHMKICBmdW5jdGlvbiBzZWxmRW1pdCh0eXBlKSB7CiAgICAvL3JlZ2lzdHJhdGlvbkZhaWxlZCBoYW5kbGVyIGlzIGludm9rZWQgd2l0aCB0d28gYXJndW1lbnRzLiBBbGxvdyBldmVudCBoYW5kbGVycyB0byBiZSBpbnZva2VkIHdpdGggYSB2YXJpYWJsZSBuby4gb2YgYXJndW1lbnRzCiAgICByZXR1cm4gc2VsZi5lbWl0LmJpbmQoc2VsZiwgdHlwZSk7CiAgfQoKICAvLyBTZXQgQWNjZXB0ZWQgQm9keSBUeXBlcwogIEMuQUNDRVBURURfQk9EWV9UWVBFUyA9IEMuQUNDRVBURURfQk9EWV9UWVBFUy50b1N0cmluZygpOwoKICB0aGlzLmxvZyA9IG5ldyBTSVAuTG9nZ2VyRmFjdG9yeSgpOwogIHRoaXMubG9nZ2VyID0gdGhpcy5nZXRMb2dnZXIoJ3NpcC51YScpOwoKICB0aGlzLmNhY2hlID0gewogICAgY3JlZGVudGlhbHM6IHt9CiAgfTsKCiAgdGhpcy5jb25maWd1cmF0aW9uID0ge307CiAgdGhpcy5kaWFsb2dzID0ge307CgogIC8vVXNlciBhY3Rpb25zIG91dHNpZGUgYW55IHNlc3Npb24vZGlhbG9nIChNRVNTQUdFKQogIHRoaXMuYXBwbGljYW50cyA9IHt9OwoKICB0aGlzLmRhdGEgPSB7fTsKICB0aGlzLnNlc3Npb25zID0ge307CiAgdGhpcy5zdWJzY3JpcHRpb25zID0ge307CiAgdGhpcy50cmFuc3BvcnQgPSBudWxsOwogIHRoaXMuY29udGFjdCA9IG51bGw7CiAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19JTklUOwogIHRoaXMuZXJyb3IgPSBudWxsOwogIHRoaXMudHJhbnNhY3Rpb25zID0gewogICAgbmlzdDoge30sCiAgICBuaWN0OiB7fSwKICAgIGlzdDoge30sCiAgICBpY3Q6IHt9CiAgfTsKCiAgdGhpcy50cmFuc3BvcnRSZWNvdmVyQXR0ZW1wdHMgPSAwOwogIHRoaXMudHJhbnNwb3J0UmVjb3ZlcnlUaW1lciA9IG51bGw7CgogIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIHsKICAgIHRyYW5zYWN0aW9uc0NvdW50OiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHR5cGUsCiAgICAgICAgICB0cmFuc2FjdGlvbnMgPSBbJ25pc3QnLCduaWN0JywnaXN0JywnaWN0J10sCiAgICAgICAgICBjb3VudCA9IDA7CgogICAgICAgIGZvciAodHlwZSBpbiB0cmFuc2FjdGlvbnMpIHsKICAgICAgICAgIGNvdW50ICs9IE9iamVjdC5rZXlzKHRoaXMudHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uc1t0eXBlXV0pLmxlbmd0aDsKICAgICAgICB9CgogICAgICAgIHJldHVybiBjb3VudDsKICAgICAgfQogICAgfSwKCiAgICBuaWN0VHJhbnNhY3Rpb25zQ291bnQ6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy50cmFuc2FjdGlvbnNbJ25pY3QnXSkubGVuZ3RoOwogICAgICB9CiAgICB9LAoKICAgIG5pc3RUcmFuc2FjdGlvbnNDb3VudDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnRyYW5zYWN0aW9uc1snbmlzdCddKS5sZW5ndGg7CiAgICAgIH0KICAgIH0sCgogICAgaWN0VHJhbnNhY3Rpb25zQ291bnQ6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy50cmFuc2FjdGlvbnNbJ2ljdCddKS5sZW5ndGg7CiAgICAgIH0KICAgIH0sCgogICAgaXN0VHJhbnNhY3Rpb25zQ291bnQ6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy50cmFuc2FjdGlvbnNbJ2lzdCddKS5sZW5ndGg7CiAgICAgIH0KICAgIH0KICB9KTsKCiAgLyoqCiAgICogTG9hZCBjb25maWd1cmF0aW9uCiAgICoKICAgKiBAdGhyb3dzIHtTSVAuRXhjZXB0aW9ucy5Db25maWd1cmF0aW9uRXJyb3J9CiAgICogQHRocm93cyB7VHlwZUVycm9yfQogICAqLwoKICBpZihjb25maWd1cmF0aW9uID09PSB1bmRlZmluZWQpIHsKICAgIGNvbmZpZ3VyYXRpb24gPSB7fTsKICB9IGVsc2UgaWYgKHR5cGVvZiBjb25maWd1cmF0aW9uID09PSAnc3RyaW5nJyB8fCBjb25maWd1cmF0aW9uIGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICBjb25maWd1cmF0aW9uID0gewogICAgICB1cmk6IGNvbmZpZ3VyYXRpb24KICAgIH07CiAgfQoKICAvLyBBcHBseSBsb2cgY29uZmlndXJhdGlvbiBpZiBwcmVzZW50CiAgaWYgKGNvbmZpZ3VyYXRpb24ubG9nKSB7CiAgICBpZiAoY29uZmlndXJhdGlvbi5sb2cuaGFzT3duUHJvcGVydHkoJ2J1aWx0aW5FbmFibGVkJykpIHsKICAgICAgdGhpcy5sb2cuYnVpbHRpbkVuYWJsZWQgPSBjb25maWd1cmF0aW9uLmxvZy5idWlsdGluRW5hYmxlZDsKICAgIH0KCiAgICBpZiAoY29uZmlndXJhdGlvbi5sb2cuaGFzT3duUHJvcGVydHkoJ2xldmVsJykpIHsKICAgICAgdGhpcy5sb2cubGV2ZWwgPSBjb25maWd1cmF0aW9uLmxvZy5sZXZlbDsKICAgIH0KCiAgICBpZiAoY29uZmlndXJhdGlvbi5sb2cuaGFzT3duUHJvcGVydHkoJ2Nvbm5lY3RvcicpKSB7CiAgICAgIHRoaXMubG9nLmNvbm5lY3RvciA9IGNvbmZpZ3VyYXRpb24ubG9nLmNvbm5lY3RvcjsKICAgIH0KICB9CgogIHRyeSB7CiAgICB0aGlzLmxvYWRDb25maWcoY29uZmlndXJhdGlvbik7CiAgfSBjYXRjaChlKSB7CiAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX05PVF9SRUFEWTsKICAgIHRoaXMuZXJyb3IgPSBDLkNPTkZJR1VSQVRJT05fRVJST1I7CiAgICB0aHJvdyBlOwogIH0KCiAgLy8gSW5pdGlhbGl6ZSByZWdpc3RlckNvbnRleHQKICB0aGlzLnJlZ2lzdGVyQ29udGV4dCA9IG5ldyBTSVAuUmVnaXN0ZXJDb250ZXh0KHRoaXMpOwogIHRoaXMucmVnaXN0ZXJDb250ZXh0Lm9uKCdmYWlsZWQnLCBzZWxmRW1pdCgncmVnaXN0cmF0aW9uRmFpbGVkJykpOwogIHRoaXMucmVnaXN0ZXJDb250ZXh0Lm9uKCdyZWdpc3RlcmVkJywgc2VsZkVtaXQoJ3JlZ2lzdGVyZWQnKSk7CiAgdGhpcy5yZWdpc3RlckNvbnRleHQub24oJ3VucmVnaXN0ZXJlZCcsIHNlbGZFbWl0KCd1bnJlZ2lzdGVyZWQnKSk7CgogIGlmKHRoaXMuY29uZmlndXJhdGlvbi5hdXRvc3RhcnQpIHsKICAgIHRoaXMuc3RhcnQoKTsKICB9CgogIGlmICh0eXBlb2YgZW52aXJvbm1lbnQuYWRkRXZlbnRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJykgewogICAgLy8gR29vZ2xlIENocm9tZSBQYWNrYWdlZCBBcHBzIGRvbid0IGFsbG93ICd1bmxvYWQnIGxpc3RlbmVyczoKICAgIC8vIHVubG9hZCBpcyBub3QgYXZhaWxhYmxlIGluIHBhY2thZ2VkIGFwcHMKICAgIGlmICghKGdsb2JhbC5jaHJvbWUgJiYgZ2xvYmFsLmNocm9tZS5hcHAgJiYgZ2xvYmFsLmNocm9tZS5hcHAucnVudGltZSkpIHsKICAgICAgZW52aXJvbm1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndW5sb2FkJywgdGhpcy5zdG9wLmJpbmQodGhpcykpOwogICAgfQogIH0KfTsKVUEucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdHlwZSk7CgovLz09PT09PT09PT09PT09PT09Ci8vICBIaWdoIExldmVsIEFQSQovLz09PT09PT09PT09PT09PT09CgpVQS5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbihvcHRpb25zKSB7CiAgdGhpcy5jb25maWd1cmF0aW9uLnJlZ2lzdGVyID0gdHJ1ZTsKICB0aGlzLnJlZ2lzdGVyQ29udGV4dC5yZWdpc3RlcihvcHRpb25zKTsKCiAgcmV0dXJuIHRoaXM7Cn07CgovKioKICogVW5yZWdpc3Rlci4KICoKICogQHBhcmFtIHtCb29sZWFufSBbYWxsXSB1bnJlZ2lzdGVyIGFsbCB1c2VyIGJpbmRpbmdzLgogKgogKi8KVUEucHJvdG90eXBlLnVucmVnaXN0ZXIgPSBmdW5jdGlvbihvcHRpb25zKSB7CiAgdGhpcy5jb25maWd1cmF0aW9uLnJlZ2lzdGVyID0gZmFsc2U7CgogIHZhciBjb250ZXh0ID0gdGhpcy5yZWdpc3RlckNvbnRleHQ7CiAgdGhpcy5hZnRlckNvbm5lY3RlZChjb250ZXh0LnVucmVnaXN0ZXIuYmluZChjb250ZXh0LCBvcHRpb25zKSk7CgogIHJldHVybiB0aGlzOwp9OwoKVUEucHJvdG90eXBlLmlzUmVnaXN0ZXJlZCA9IGZ1bmN0aW9uKCkgewogIHJldHVybiB0aGlzLnJlZ2lzdGVyQ29udGV4dC5yZWdpc3RlcmVkOwp9OwoKLyoqCiAqIENvbm5lY3Rpb24gc3RhdGUuCiAqIEBwYXJhbSB7Qm9vbGVhbn0KICovClVBLnByb3RvdHlwZS5pc0Nvbm5lY3RlZCA9IGZ1bmN0aW9uKCkgewogIHJldHVybiB0aGlzLnRyYW5zcG9ydCA/IHRoaXMudHJhbnNwb3J0LmNvbm5lY3RlZCA6IGZhbHNlOwp9OwoKVUEucHJvdG90eXBlLmFmdGVyQ29ubmVjdGVkID0gZnVuY3Rpb24gYWZ0ZXJDb25uZWN0ZWQgKGNhbGxiYWNrKSB7CiAgaWYgKHRoaXMuaXNDb25uZWN0ZWQoKSkgewogICAgY2FsbGJhY2soKTsKICB9IGVsc2UgewogICAgdGhpcy5vbmNlKCdjb25uZWN0ZWQnLCBjYWxsYmFjayk7CiAgfQp9OwoKLyoqCiAqIE1ha2UgYW4gb3V0Z29pbmcgY2FsbC4KICoKICogQHBhcmFtIHtTdHJpbmd9IHRhcmdldAogKiBAcGFyYW0ge09iamVjdH0gdmlld3MKICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLm1lZGlhXSBnZXRzIHBhc3NlZCB0byBTSVAuTWVkaWFIYW5kbGVyLmdldERlc2NyaXB0aW9uIGFzIG1lZGlhSGludAogKgogKiBAdGhyb3dzIHtUeXBlRXJyb3J9CiAqCiAqLwpVQS5wcm90b3R5cGUuaW52aXRlID0gZnVuY3Rpb24odGFyZ2V0LCBvcHRpb25zKSB7CiAgdmFyIGNvbnRleHQgPSBuZXcgU0lQLkludml0ZUNsaWVudENvbnRleHQodGhpcywgdGFyZ2V0LCBvcHRpb25zKTsKCiAgdGhpcy5hZnRlckNvbm5lY3RlZChjb250ZXh0Lmludml0ZS5iaW5kKGNvbnRleHQpKTsKICByZXR1cm4gY29udGV4dDsKfTsKClVBLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbih0YXJnZXQsIGV2ZW50LCBvcHRpb25zKSB7CiAgdmFyIHN1YiA9IG5ldyBTSVAuU3Vic2NyaXB0aW9uKHRoaXMsIHRhcmdldCwgZXZlbnQsIG9wdGlvbnMpOwoKICB0aGlzLmFmdGVyQ29ubmVjdGVkKHN1Yi5zdWJzY3JpYmUuYmluZChzdWIpKTsKICByZXR1cm4gc3ViOwp9OwoKLyoqCiAqIFNlbmQgYSBtZXNzYWdlLgogKgogKiBAcGFyYW0ge1N0cmluZ30gdGFyZ2V0CiAqIEBwYXJhbSB7U3RyaW5nfSBib2R5CiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10KICoKICogQHRocm93cyB7VHlwZUVycm9yfQogKgogKi8KVUEucHJvdG90eXBlLm1lc3NhZ2UgPSBmdW5jdGlvbih0YXJnZXQsIGJvZHksIG9wdGlvbnMpIHsKICBpZiAoYm9keSA9PT0gdW5kZWZpbmVkKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdOb3QgZW5vdWdoIGFyZ3VtZW50cycpOwogIH0KCiAgLy8gVGhlcmUgaXMgbm8gTWVzc2FnZSBtb2R1bGUsIHNvIGl0IGlzIG9rYXkgdGhhdCB0aGUgVUEgaGFuZGxlcyBkZWZhdWx0cyBoZXJlLgogIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKG9wdGlvbnMgfHwgT2JqZWN0LnByb3RvdHlwZSk7CiAgb3B0aW9ucy5jb250ZW50VHlwZSB8fCAob3B0aW9ucy5jb250ZW50VHlwZSA9ICd0ZXh0L3BsYWluJyk7CiAgb3B0aW9ucy5ib2R5ID0gYm9keTsKCiAgcmV0dXJuIHRoaXMucmVxdWVzdChTSVAuQy5NRVNTQUdFLCB0YXJnZXQsIG9wdGlvbnMpOwp9OwoKVUEucHJvdG90eXBlLnJlcXVlc3QgPSBmdW5jdGlvbiAobWV0aG9kLCB0YXJnZXQsIG9wdGlvbnMpIHsKICB2YXIgcmVxID0gbmV3IFNJUC5DbGllbnRDb250ZXh0KHRoaXMsIG1ldGhvZCwgdGFyZ2V0LCBvcHRpb25zKTsKCiAgdGhpcy5hZnRlckNvbm5lY3RlZChyZXEuc2VuZC5iaW5kKHJlcSkpOwogIHJldHVybiByZXE7Cn07CgovKioKICogR3JhY2VmdWxseSBjbG9zZS4KICoKICovClVBLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNlc3Npb24sIHN1YnNjcmlwdGlvbiwgYXBwbGljYW50LAogICAgdWEgPSB0aGlzOwoKICBmdW5jdGlvbiB0cmFuc2FjdGlvbnNMaXN0ZW5lcigpIHsKICAgIGlmICh1YS5uaXN0VHJhbnNhY3Rpb25zQ291bnQgPT09IDAgJiYgdWEubmljdFRyYW5zYWN0aW9uc0NvdW50ID09PSAwKSB7CiAgICAgICAgdWEucmVtb3ZlTGlzdGVuZXIoJ3RyYW5zYWN0aW9uRGVzdHJveWVkJywgdHJhbnNhY3Rpb25zTGlzdGVuZXIpOwogICAgICAgIHVhLnRyYW5zcG9ydC5kaXNjb25uZWN0KCk7CiAgICB9CiAgfQoKICB0aGlzLmxvZ2dlci5sb2coJ3VzZXIgcmVxdWVzdGVkIGNsb3N1cmUuLi4nKTsKCiAgaWYodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1VTRVJfQ0xPU0VEKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCdVQSBhbHJlYWR5IGNsb3NlZCcpOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvLyBDbGVhciB0cmFuc3BvcnRSZWNvdmVyeVRpbWVyCiAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50cmFuc3BvcnRSZWNvdmVyeVRpbWVyKTsKCiAgLy8gQ2xvc2UgcmVnaXN0ZXJDb250ZXh0CiAgdGhpcy5sb2dnZXIubG9nKCdjbG9zaW5nIHJlZ2lzdGVyQ29udGV4dCcpOwogIHRoaXMucmVnaXN0ZXJDb250ZXh0LmNsb3NlKCk7CgogIC8vIFJ1biAgX3Rlcm1pbmF0ZV8gb24gZXZlcnkgU2Vzc2lvbgogIGZvcihzZXNzaW9uIGluIHRoaXMuc2Vzc2lvbnMpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygnY2xvc2luZyBzZXNzaW9uICcgKyBzZXNzaW9uKTsKICAgIHRoaXMuc2Vzc2lvbnNbc2Vzc2lvbl0udGVybWluYXRlKCk7CiAgfQoKICAvL1J1biBfY2xvc2VfIG9uIGV2ZXJ5IFN1YnNjcmlwdGlvbgogIGZvcihzdWJzY3JpcHRpb24gaW4gdGhpcy5zdWJzY3JpcHRpb25zKSB7CiAgICB0aGlzLmxvZ2dlci5sb2coJ3Vuc3Vic2NyaWJpbmcgZnJvbSBzdWJzY3JpcHRpb24gJyArIHN1YnNjcmlwdGlvbik7CiAgICB0aGlzLnN1YnNjcmlwdGlvbnNbc3Vic2NyaXB0aW9uXS5jbG9zZSgpOwogIH0KCiAgLy8gUnVuICBfY2xvc2VfIG9uIGV2ZXJ5IGFwcGxpY2FudAogIGZvcihhcHBsaWNhbnQgaW4gdGhpcy5hcHBsaWNhbnRzKSB7CiAgICB0aGlzLmFwcGxpY2FudHNbYXBwbGljYW50XS5jbG9zZSgpOwogIH0KCiAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19VU0VSX0NMT1NFRDsKCiAgLyoKICAgKiBJZiB0aGUgcmVtYWluaW5nIHRyYW5zYWN0aW9ucyBhcmUgYWxsIElOVklURSB0cmFuc2FjdGlvbnMsIHRoZXJlIGlzIG5vIG5lZWQgdG8KICAgKiB3YWl0IGFueW1vcmUgYmVjYXVzZSBldmVyeSBzZXNzaW9uIGhhcyBhbHJlYWR5IGJlZW4gY2xvc2VkIGJ5IHRoaXMgbWV0aG9kLgogICAqIC0gbG9jYWxseSBvcmlnaW5hdGVkIHNlc3Npb25zIHdoZXJlIHRlcm1pbmF0ZWQgKENBTkNFTCBvciBCWUUpCiAgICogLSByZW1vdGVseSBvcmlnaW5hdGVkIHNlc3Npb25zIHdoZXJlIHJlamVjdGVkICg0WFgpIG9yIHRlcm1pbmF0ZWQgKEJZRSkKICAgKiBSZW1haW5pbmcgSU5WSVRFIHRyYW5zYWN0aW9ucyBiZWxvbmcgdGhvIHNlc3Npb25zIHRoYXQgd2hlcmUgYW5zd2VyZWQuIFRoaXMgYXJlIGluCiAgICogJ2FjY2VwdGVkJyBzdGF0ZSBkdWUgdG8gdGltZXJzICdMJyBhbmQgJ00nIGRlZmluZWQgaW4gW1JGQyA2MDI2XQogICAqLwogIGlmICh0aGlzLm5pc3RUcmFuc2FjdGlvbnNDb3VudCA9PT0gMCAmJiB0aGlzLm5pY3RUcmFuc2FjdGlvbnNDb3VudCA9PT0gMCkgewogICAgdGhpcy50cmFuc3BvcnQuZGlzY29ubmVjdCgpOwogIH0gZWxzZSB7CiAgICB0aGlzLm9uKCd0cmFuc2FjdGlvbkRlc3Ryb3llZCcsIHRyYW5zYWN0aW9uc0xpc3RlbmVyKTsKICB9CgogIHJldHVybiB0aGlzOwp9OwoKLyoqCiAqIENvbm5lY3QgdG8gdGhlIFdTIHNlcnZlciBpZiBzdGF0dXMgPSBTVEFUVVNfSU5JVC4KICogUmVzdW1lIFVBIGFmdGVyIGJlaW5nIGNsb3NlZC4KICoKICovClVBLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKCkgewogIHZhciBzZXJ2ZXI7CgogIHRoaXMubG9nZ2VyLmxvZygndXNlciByZXF1ZXN0ZWQgc3RhcnR1cC4uLicpOwogIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfSU5JVCkgewogICAgc2VydmVyID0gdGhpcy5nZXROZXh0V3NTZXJ2ZXIoKTsKICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfU1RBUlRJTkc7CiAgICBuZXcgU0lQLlRyYW5zcG9ydCh0aGlzLCBzZXJ2ZXIpOwogIH0gZWxzZSBpZih0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVVNFUl9DTE9TRUQpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygncmVzdW1pbmcnKTsKICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfUkVBRFk7CiAgICB0aGlzLnRyYW5zcG9ydC5jb25uZWN0KCk7CiAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfU1RBUlRJTkcpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygnVUEgaXMgaW4gU1RBUlRJTkcgc3RhdHVzLCBub3Qgb3BlbmluZyBuZXcgY29ubmVjdGlvbicpOwogIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1JFQURZKSB7CiAgICB0aGlzLmxvZ2dlci5sb2coJ1VBIGlzIGluIFJFQURZIHN0YXR1cywgbm90IHJlc3VtaW5nJyk7CiAgfSBlbHNlIHsKICAgIHRoaXMubG9nZ2VyLmVycm9yKCdDb25uZWN0aW9uIGlzIGRvd24uIEF1dG8tUmVjb3Zlcnkgc3lzdGVtIGlzIHRyeWluZyB0byBjb25uZWN0Jyk7CiAgfQoKICByZXR1cm4gdGhpczsKfTsKCi8qKgogKiBOb3JtYWxpemUgYSBzdHJpbmcgaW50byBhIHZhbGlkIFNJUCByZXF1ZXN0IFVSSQogKgogKiBAcGFyYW0ge1N0cmluZ30gdGFyZ2V0CiAqCiAqIEByZXR1cm5zIHtTSVAuVVJJfHVuZGVmaW5lZH0KICovClVBLnByb3RvdHlwZS5ub3JtYWxpemVUYXJnZXQgPSBmdW5jdGlvbih0YXJnZXQpIHsKICByZXR1cm4gU0lQLlV0aWxzLm5vcm1hbGl6ZVRhcmdldCh0YXJnZXQsIHRoaXMuY29uZmlndXJhdGlvbi5ob3N0cG9ydFBhcmFtcyk7Cn07CgoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vICBQcml2YXRlIChGb3IgaW50ZXJuYWwgdXNlKQovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KClVBLnByb3RvdHlwZS5zYXZlQ3JlZGVudGlhbHMgPSBmdW5jdGlvbihjcmVkZW50aWFscykgewogIHRoaXMuY2FjaGUuY3JlZGVudGlhbHNbY3JlZGVudGlhbHMucmVhbG1dID0gdGhpcy5jYWNoZS5jcmVkZW50aWFsc1tjcmVkZW50aWFscy5yZWFsbV0gfHwge307CiAgdGhpcy5jYWNoZS5jcmVkZW50aWFsc1tjcmVkZW50aWFscy5yZWFsbV1bY3JlZGVudGlhbHMudXJpXSA9IGNyZWRlbnRpYWxzOwoKICByZXR1cm4gdGhpczsKfTsKClVBLnByb3RvdHlwZS5nZXRDcmVkZW50aWFscyA9IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICB2YXIgcmVhbG0sIGNyZWRlbnRpYWxzOwoKICByZWFsbSA9IHJlcXVlc3QucnVyaS5ob3N0OwoKICBpZiAodGhpcy5jYWNoZS5jcmVkZW50aWFsc1tyZWFsbV0gJiYgdGhpcy5jYWNoZS5jcmVkZW50aWFsc1tyZWFsbV1bcmVxdWVzdC5ydXJpXSkgewogICAgY3JlZGVudGlhbHMgPSB0aGlzLmNhY2hlLmNyZWRlbnRpYWxzW3JlYWxtXVtyZXF1ZXN0LnJ1cmldOwogICAgY3JlZGVudGlhbHMubWV0aG9kID0gcmVxdWVzdC5tZXRob2Q7CiAgfQoKICByZXR1cm4gY3JlZGVudGlhbHM7Cn07CgpVQS5wcm90b3R5cGUuZ2V0TG9nZ2VyID0gZnVuY3Rpb24oY2F0ZWdvcnksIGxhYmVsKSB7CiAgcmV0dXJuIHRoaXMubG9nLmdldExvZ2dlcihjYXRlZ29yeSwgbGFiZWwpOwp9OwoKCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIEV2ZW50IEhhbmRsZXJzCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgovKioKICogVHJhbnNwb3J0IENsb3NlIGV2ZW50CiAqIEBwcml2YXRlCiAqIEBldmVudAogKiBAcGFyYW0ge1NJUC5UcmFuc3BvcnR9IHRyYW5zcG9ydC4KICovClVBLnByb3RvdHlwZS5vblRyYW5zcG9ydENsb3NlZCA9IGZ1bmN0aW9uKHRyYW5zcG9ydCkgewogIC8vIFJ1biBfb25UcmFuc3BvcnRFcnJvcl8gY2FsbGJhY2sgb24gZXZlcnkgY2xpZW50IHRyYW5zYWN0aW9uIHVzaW5nIF90cmFuc3BvcnRfCiAgdmFyIHR5cGUsIGlkeCwgbGVuZ3RoLAogICAgY2xpZW50X3RyYW5zYWN0aW9ucyA9IFsnbmljdCcsICdpY3QnLCAnbmlzdCcsICdpc3QnXTsKCiAgdHJhbnNwb3J0LnNlcnZlci5zdGF0dXMgPSBTSVAuVHJhbnNwb3J0LkMuU1RBVFVTX0RJU0NPTk5FQ1RFRDsKICB0aGlzLmxvZ2dlci5sb2coJ2Nvbm5lY3Rpb24gc3RhdGUgc2V0IHRvICcrIFNJUC5UcmFuc3BvcnQuQy5TVEFUVVNfRElTQ09OTkVDVEVEKTsKCiAgbGVuZ3RoID0gY2xpZW50X3RyYW5zYWN0aW9ucy5sZW5ndGg7CiAgZm9yICh0eXBlID0gMDsgdHlwZSA8IGxlbmd0aDsgdHlwZSsrKSB7CiAgICBmb3IoaWR4IGluIHRoaXMudHJhbnNhY3Rpb25zW2NsaWVudF90cmFuc2FjdGlvbnNbdHlwZV1dKSB7CiAgICAgIHRoaXMudHJhbnNhY3Rpb25zW2NsaWVudF90cmFuc2FjdGlvbnNbdHlwZV1dW2lkeF0ub25UcmFuc3BvcnRFcnJvcigpOwogICAgfQogIH0KCiAgLy8gQ2xvc2Ugc2Vzc2lvbnMgaWYgR1JVVSBpcyBub3QgYmVpbmcgdXNlZAogIGlmICghdGhpcy5jb250YWN0LnB1Yl9ncnV1KSB7CiAgICB0aGlzLmNsb3NlU2Vzc2lvbnNPblRyYW5zcG9ydEVycm9yKCk7CiAgfQoKfTsKCi8qKgogKiBVbnJlY292ZXJhYmxlIHRyYW5zcG9ydCBldmVudC4KICogQ29ubmVjdGlvbiByZWF0dGVtcHQgbG9naWMgaGFzIGJlZW4gZG9uZSBhbmQgZGlkbid0IHN1Y2Nlc3MuCiAqIEBwcml2YXRlCiAqIEBldmVudAogKiBAcGFyYW0ge1NJUC5UcmFuc3BvcnR9IHRyYW5zcG9ydC4KICovClVBLnByb3RvdHlwZS5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24odHJhbnNwb3J0KSB7CiAgdmFyIHNlcnZlcjsKCiAgdGhpcy5sb2dnZXIubG9nKCd0cmFuc3BvcnQgJyArIHRyYW5zcG9ydC5zZXJ2ZXIud3NfdXJpICsgJyBmYWlsZWQgfCBjb25uZWN0aW9uIHN0YXRlIHNldCB0byAnKyBTSVAuVHJhbnNwb3J0LkMuU1RBVFVTX0VSUk9SKTsKCiAgLy8gQ2xvc2Ugc2Vzc2lvbnMuCiAgLy9NYXJrIHRoaXMgdHJhbnNwb3J0IGFzICdkb3duJwogIHRyYW5zcG9ydC5zZXJ2ZXIuc3RhdHVzID0gU0lQLlRyYW5zcG9ydC5DLlNUQVRVU19FUlJPUjsKCiAgdGhpcy5lbWl0KCdkaXNjb25uZWN0ZWQnLCB7CiAgICB0cmFuc3BvcnQ6IHRyYW5zcG9ydAogIH0pOwoKICAvLyB0cnkgdGhlIG5leHQgdHJhbnNwb3J0IGlmIHRoZSBVQSBpc24ndCBjbG9zZWQKICBpZih0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVVNFUl9DTE9TRUQpIHsKICAgIHJldHVybjsKICB9CgogIHNlcnZlciA9IHRoaXMuZ2V0TmV4dFdzU2VydmVyKCk7CgogIGlmKHNlcnZlcikgewogICAgbmV3IFNJUC5UcmFuc3BvcnQodGhpcywgc2VydmVyKTsKICB9ZWxzZSB7CiAgICB0aGlzLmNsb3NlU2Vzc2lvbnNPblRyYW5zcG9ydEVycm9yKCk7CiAgICBpZiAoIXRoaXMuZXJyb3IgfHwgdGhpcy5lcnJvciAhPT0gQy5ORVRXT1JLX0VSUk9SKSB7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfTk9UX1JFQURZOwogICAgICB0aGlzLmVycm9yID0gQy5ORVRXT1JLX0VSUk9SOwogICAgfQogICAgLy8gVHJhbnNwb3J0IFJlY292ZXJ5IHByb2Nlc3MKICAgIHRoaXMucmVjb3ZlclRyYW5zcG9ydCgpOwogIH0KfTsKCi8qKgogKiBUcmFuc3BvcnQgY29ubmVjdGlvbiBldmVudC4KICogQHByaXZhdGUKICogQGV2ZW50CiAqIEBwYXJhbSB7U0lQLlRyYW5zcG9ydH0gdHJhbnNwb3J0LgogKi8KVUEucHJvdG90eXBlLm9uVHJhbnNwb3J0Q29ubmVjdGVkID0gZnVuY3Rpb24odHJhbnNwb3J0KSB7CiAgdGhpcy50cmFuc3BvcnQgPSB0cmFuc3BvcnQ7CgogIC8vIFJlc2V0IHRyYW5zcG9ydCByZWNvdmVyeSBjb3VudGVyCiAgdGhpcy50cmFuc3BvcnRSZWNvdmVyQXR0ZW1wdHMgPSAwOwoKICB0cmFuc3BvcnQuc2VydmVyLnN0YXR1cyA9IFNJUC5UcmFuc3BvcnQuQy5TVEFUVVNfUkVBRFk7CiAgdGhpcy5sb2dnZXIubG9nKCdjb25uZWN0aW9uIHN0YXRlIHNldCB0byAnKyBTSVAuVHJhbnNwb3J0LkMuU1RBVFVTX1JFQURZKTsKCiAgaWYodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1VTRVJfQ0xPU0VEKSB7CiAgICByZXR1cm47CiAgfQoKICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX1JFQURZOwogIHRoaXMuZXJyb3IgPSBudWxsOwoKICBpZih0aGlzLmNvbmZpZ3VyYXRpb24ucmVnaXN0ZXIpIHsKICAgIHRoaXMuY29uZmlndXJhdGlvbi5hdXRoZW50aWNhdGlvbkZhY3RvcnkuaW5pdGlhbGl6ZSgpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnJlZ2lzdGVyQ29udGV4dC5vblRyYW5zcG9ydENvbm5lY3RlZCgpOwogICAgfS5iaW5kKHRoaXMpKTsKICB9CgogIHRoaXMuZW1pdCgnY29ubmVjdGVkJywgewogICAgdHJhbnNwb3J0OiB0cmFuc3BvcnQKICB9KTsKfTsKCgovKioKICogVHJhbnNwb3J0IGNvbm5lY3RpbmcgZXZlbnQKICogQHByaXZhdGUKICogQHBhcmFtIHtTSVAuVHJhbnNwb3J0fSB0cmFuc3BvcnQuCiAqICNwYXJhbSB7SW50ZWdlcn0gYXR0ZW1wdHMuCiAqLwogIFVBLnByb3RvdHlwZS5vblRyYW5zcG9ydENvbm5lY3RpbmcgPSBmdW5jdGlvbih0cmFuc3BvcnQsIGF0dGVtcHRzKSB7CiAgICB0aGlzLmVtaXQoJ2Nvbm5lY3RpbmcnLCB7CiAgICAgIHRyYW5zcG9ydDogdHJhbnNwb3J0LAogICAgICBhdHRlbXB0czogYXR0ZW1wdHMKICAgIH0pOwogIH07CgoKLyoqCiAqIG5ldyBUcmFuc2FjdGlvbgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge1NJUC5UcmFuc2FjdGlvbn0gdHJhbnNhY3Rpb24uCiAqLwpVQS5wcm90b3R5cGUubmV3VHJhbnNhY3Rpb24gPSBmdW5jdGlvbih0cmFuc2FjdGlvbikgewogIHRoaXMudHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uLnR5cGVdW3RyYW5zYWN0aW9uLmlkXSA9IHRyYW5zYWN0aW9uOwogIHRoaXMuZW1pdCgnbmV3VHJhbnNhY3Rpb24nLCB7dHJhbnNhY3Rpb246IHRyYW5zYWN0aW9ufSk7Cn07CgoKLyoqCiAqIGRlc3Ryb3kgVHJhbnNhY3Rpb24KICogQHByaXZhdGUKICogQHBhcmFtIHtTSVAuVHJhbnNhY3Rpb259IHRyYW5zYWN0aW9uLgogKi8KVUEucHJvdG90eXBlLmRlc3Ryb3lUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uKHRyYW5zYWN0aW9uKSB7CiAgZGVsZXRlIHRoaXMudHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uLnR5cGVdW3RyYW5zYWN0aW9uLmlkXTsKICB0aGlzLmVtaXQoJ3RyYW5zYWN0aW9uRGVzdHJveWVkJywgewogICAgdHJhbnNhY3Rpb246IHRyYW5zYWN0aW9uCiAgfSk7Cn07CgoKLy89PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIHJlY2VpdmVSZXF1ZXN0Ci8vPT09PT09PT09PT09PT09PT09PT09PT09PQoKLyoqCiAqIFJlcXVlc3QgcmVjZXB0aW9uCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7U0lQLkluY29taW5nUmVxdWVzdH0gcmVxdWVzdC4KICovClVBLnByb3RvdHlwZS5yZWNlaXZlUmVxdWVzdCA9IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICB2YXIgZGlhbG9nLCBzZXNzaW9uLCBtZXNzYWdlLAogICAgbWV0aG9kID0gcmVxdWVzdC5tZXRob2QsCiAgICB0cmFuc2FjdGlvbiwKICAgIHJlcGxhY2VzLAogICAgcmVwbGFjZWREaWFsb2csCiAgICBzZWxmID0gdGhpczsKCiAgZnVuY3Rpb24gcnVyaU1hdGNoZXMgKHVyaSkgewogICAgcmV0dXJuIHVyaSAmJiB1cmkudXNlciA9PT0gcmVxdWVzdC5ydXJpLnVzZXI7CiAgfQoKICAvLyBDaGVjayB0aGF0IHJlcXVlc3QgVVJJIHBvaW50cyB0byB1cwogIGlmKCEocnVyaU1hdGNoZXModGhpcy5jb25maWd1cmF0aW9uLnVyaSkgfHwKICAgICAgIHJ1cmlNYXRjaGVzKHRoaXMuY29udGFjdC51cmkpIHx8CiAgICAgICBydXJpTWF0Y2hlcyh0aGlzLmNvbnRhY3QucHViX2dydXUpIHx8CiAgICAgICBydXJpTWF0Y2hlcyh0aGlzLmNvbnRhY3QudGVtcF9ncnV1KSkpIHsKICAgIHRoaXMubG9nZ2VyLndhcm4oJ1JlcXVlc3QtVVJJIGRvZXMgbm90IHBvaW50IHRvIHVzJyk7CiAgICBpZiAocmVxdWVzdC5tZXRob2QgIT09IFNJUC5DLkFDSykgewogICAgICByZXF1ZXN0LnJlcGx5X3NsKDQwNCk7CiAgICB9CiAgICByZXR1cm47CiAgfQoKICAvLyBDaGVjayByZXF1ZXN0IFVSSSBzY2hlbWUKICBpZihyZXF1ZXN0LnJ1cmkuc2NoZW1lID09PSBTSVAuQy5TSVBTKSB7CiAgICByZXF1ZXN0LnJlcGx5X3NsKDQxNik7CiAgICByZXR1cm47CiAgfQoKICAvLyBDaGVjayB0cmFuc2FjdGlvbgogIGlmKFNJUC5UcmFuc2FjdGlvbnMuY2hlY2tUcmFuc2FjdGlvbih0aGlzLCByZXF1ZXN0KSkgewogICAgcmV0dXJuOwogIH0KCiAgLyogUkZDMzI2MSAxMi4yLjIKICAgKiBSZXF1ZXN0cyB0aGF0IGRvIG5vdCBjaGFuZ2UgaW4gYW55IHdheSB0aGUgc3RhdGUgb2YgYSBkaWFsb2cgbWF5IGJlCiAgICogcmVjZWl2ZWQgd2l0aGluIGEgZGlhbG9nIChmb3IgZXhhbXBsZSwgYW4gT1BUSU9OUyByZXF1ZXN0KS4KICAgKiBUaGV5IGFyZSBwcm9jZXNzZWQgYXMgaWYgdGhleSBoYWQgYmVlbiByZWNlaXZlZCBvdXRzaWRlIHRoZSBkaWFsb2cuCiAgICovCiAgaWYobWV0aG9kID09PSBTSVAuQy5PUFRJT05TKSB7CiAgICBuZXcgU0lQLlRyYW5zYWN0aW9ucy5Ob25JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbihyZXF1ZXN0LCB0aGlzKTsKICAgIHJlcXVlc3QucmVwbHkoMjAwLCBudWxsLCBbCiAgICAgICdBbGxvdzogJysgU0lQLlVBLkMuQUxMT1dFRF9NRVRIT0RTLnRvU3RyaW5nKCksCiAgICAgICdBY2NlcHQ6ICcrIEMuQUNDRVBURURfQk9EWV9UWVBFUwogICAgXSk7CiAgfSBlbHNlIGlmIChtZXRob2QgPT09IFNJUC5DLk1FU1NBR0UpIHsKICAgIG1lc3NhZ2UgPSBuZXcgU0lQLlNlcnZlckNvbnRleHQodGhpcywgcmVxdWVzdCk7CiAgICBtZXNzYWdlLmJvZHkgPSByZXF1ZXN0LmJvZHk7CiAgICBtZXNzYWdlLmNvbnRlbnRfdHlwZSA9IHJlcXVlc3QuZ2V0SGVhZGVyKCdDb250ZW50LVR5cGUnKSB8fCAndGV4dC9wbGFpbic7CgogICAgcmVxdWVzdC5yZXBseSgyMDAsIG51bGwpOwogICAgdGhpcy5lbWl0KCdtZXNzYWdlJywgbWVzc2FnZSk7CiAgfSBlbHNlIGlmIChtZXRob2QgIT09IFNJUC5DLklOVklURSAmJgogICAgICAgICAgICAgbWV0aG9kICE9PSBTSVAuQy5BQ0spIHsKICAgIC8vIExldCB0aG9zZSBtZXRob2RzIHBhc3MgdGhyb3VnaCB0byBub3JtYWwgcHJvY2Vzc2luZyBmb3Igbm93LgogICAgdHJhbnNhY3Rpb24gPSBuZXcgU0lQLlNlcnZlckNvbnRleHQodGhpcywgcmVxdWVzdCk7CiAgfQoKICAvLyBJbml0aWFsIFJlcXVlc3QKICBpZighcmVxdWVzdC50b190YWcpIHsKICAgIHN3aXRjaChtZXRob2QpIHsKICAgICAgY2FzZSBTSVAuQy5JTlZJVEU6CiAgICAgICAgcmVwbGFjZXMgPQogICAgICAgICAgdGhpcy5jb25maWd1cmF0aW9uLnJlcGxhY2VzICE9PSBTSVAuQy5zdXBwb3J0ZWQuVU5TVVBQT1JURUQgJiYKICAgICAgICAgIHJlcXVlc3QucGFyc2VIZWFkZXIoJ3JlcGxhY2VzJyk7CgogICAgICAgIGlmIChyZXBsYWNlcykgewogICAgICAgICAgcmVwbGFjZWREaWFsb2cgPSB0aGlzLmRpYWxvZ3NbcmVwbGFjZXMuY2FsbF9pZCArIHJlcGxhY2VzLnJlcGxhY2VzX3RvX3RhZyArIHJlcGxhY2VzLnJlcGxhY2VzX2Zyb21fdGFnXTsKCiAgICAgICAgICBpZiAoIXJlcGxhY2VkRGlhbG9nKSB7CiAgICAgICAgICAgIC8vUmVwbGFjZWQgaGVhZGVyIHdpdGhvdXQgYSBtYXRjaGluZyBkaWFsb2csIHJlamVjdAogICAgICAgICAgICByZXF1ZXN0LnJlcGx5X3NsKDQ4MSwgbnVsbCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gZWxzZSBpZiAocmVwbGFjZWREaWFsb2cub3duZXIuc3RhdHVzID09PSBTSVAuU2Vzc2lvbi5DLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgICAgICAgIHJlcXVlc3QucmVwbHlfc2woNjAzLCBudWxsKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSBlbHNlIGlmIChyZXBsYWNlZERpYWxvZy5zdGF0ZSA9PT0gU0lQLkRpYWxvZy5DLlNUQVRVU19DT05GSVJNRUQgJiYgcmVwbGFjZXMuZWFybHlfb25seSkgewogICAgICAgICAgICByZXF1ZXN0LnJlcGx5X3NsKDQ4NiwgbnVsbCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZhciBpc01lZGlhU3VwcG9ydGVkID0gdGhpcy5jb25maWd1cmF0aW9uLm1lZGlhSGFuZGxlckZhY3RvcnkuaXNTdXBwb3J0ZWQ7CiAgICAgICAgaWYoIWlzTWVkaWFTdXBwb3J0ZWQgfHwgaXNNZWRpYVN1cHBvcnRlZCgpKSB7CiAgICAgICAgICBzZXNzaW9uID0gbmV3IFNJUC5JbnZpdGVTZXJ2ZXJDb250ZXh0KHRoaXMsIHJlcXVlc3QpOwogICAgICAgICAgc2Vzc2lvbi5yZXBsYWNlZSA9IHJlcGxhY2VkRGlhbG9nICYmIHJlcGxhY2VkRGlhbG9nLm93bmVyOwogICAgICAgICAgc2Vzc2lvbi5vbignaW52aXRlJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHNlbGYuZW1pdCgnaW52aXRlJywgdGhpcyk7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5sb2dnZXIud2FybignSU5WSVRFIHJlY2VpdmVkIGJ1dCBXZWJSVEMgaXMgbm90IHN1cHBvcnRlZCcpOwogICAgICAgICAgcmVxdWVzdC5yZXBseSg0ODgpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBTSVAuQy5CWUU6CiAgICAgICAgLy8gT3V0IG9mIGRpYWxvZyBCWUUgcmVjZWl2ZWQKICAgICAgICByZXF1ZXN0LnJlcGx5KDQ4MSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgU0lQLkMuQ0FOQ0VMOgogICAgICAgIHNlc3Npb24gPSB0aGlzLmZpbmRTZXNzaW9uKHJlcXVlc3QpOwogICAgICAgIGlmKHNlc3Npb24pIHsKICAgICAgICAgIHNlc3Npb24ucmVjZWl2ZVJlcXVlc3QocmVxdWVzdCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ3JlY2VpdmVkIENBTkNFTCByZXF1ZXN0IGZvciBhIG5vbiBleGlzdGVudCBzZXNzaW9uJyk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIFNJUC5DLkFDSzoKICAgICAgICAvKiBBYnNvcmIgaXQuCiAgICAgICAgICogQUNLIHJlcXVlc3Qgd2l0aG91dCBhIGNvcnJlc3BvbmRpbmcgSW52aXRlIFRyYW5zYWN0aW9uCiAgICAgICAgICogYW5kIHdpdGhvdXQgVG8gdGFnLgogICAgICAgICAqLwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIHJlcXVlc3QucmVwbHkoNDA1KTsKICAgICAgICBicmVhazsKICAgIH0KICB9CiAgLy8gSW4tZGlhbG9nIHJlcXVlc3QKICBlbHNlIHsKICAgIGRpYWxvZyA9IHRoaXMuZmluZERpYWxvZyhyZXF1ZXN0KTsKCiAgICBpZihkaWFsb2cpIHsKICAgICAgaWYgKG1ldGhvZCA9PT0gU0lQLkMuSU5WSVRFKSB7CiAgICAgICAgbmV3IFNJUC5UcmFuc2FjdGlvbnMuSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ocmVxdWVzdCwgdGhpcyk7CiAgICAgIH0KICAgICAgZGlhbG9nLnJlY2VpdmVSZXF1ZXN0KHJlcXVlc3QpOwogICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFNJUC5DLk5PVElGWSkgewogICAgICBzZXNzaW9uID0gdGhpcy5maW5kU2Vzc2lvbihyZXF1ZXN0KTsKICAgICAgaWYoc2Vzc2lvbikgewogICAgICAgIHNlc3Npb24ucmVjZWl2ZVJlcXVlc3QocmVxdWVzdCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5sb2dnZXIud2FybigncmVjZWl2ZWQgTk9USUZZIHJlcXVlc3QgZm9yIGEgbm9uIGV4aXN0ZW50IHNlc3Npb24nKTsKICAgICAgICByZXF1ZXN0LnJlcGx5KDQ4MSwgJ1N1YnNjcmlwdGlvbiBkb2VzIG5vdCBleGlzdCcpOwogICAgICB9CiAgICB9CiAgICAvKiBSRkMzMjYxIDEyLjIuMgogICAgICogUmVxdWVzdCB3aXRoIHRvIHRhZywgYnV0IG5vIG1hdGNoaW5nIGRpYWxvZyBmb3VuZC4KICAgICAqIEV4Y2VwdGlvbjogQUNLIGZvciBhbiBJbnZpdGUgcmVxdWVzdCBmb3Igd2hpY2ggYSBkaWFsb2cgaGFzIG5vdAogICAgICogYmVlbiBjcmVhdGVkLgogICAgICovCiAgICBlbHNlIHsKICAgICAgaWYobWV0aG9kICE9PSBTSVAuQy5BQ0spIHsKICAgICAgICByZXF1ZXN0LnJlcGx5KDQ4MSk7CiAgICAgIH0KICAgIH0KICB9Cn07CgovLz09PT09PT09PT09PT09PT09Ci8vIFV0aWxzCi8vPT09PT09PT09PT09PT09PT0KCi8qKgogKiBHZXQgdGhlIHNlc3Npb24gdG8gd2hpY2ggdGhlIHJlcXVlc3QgYmVsb25ncyB0bywgaWYgYW55LgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge1NJUC5JbmNvbWluZ1JlcXVlc3R9IHJlcXVlc3QuCiAqIEByZXR1cm5zIHtTSVAuT3V0Z29pbmdTZXNzaW9ufFNJUC5JbmNvbWluZ1Nlc3Npb258bnVsbH0KICovClVBLnByb3RvdHlwZS5maW5kU2Vzc2lvbiA9IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICByZXR1cm4gdGhpcy5zZXNzaW9uc1tyZXF1ZXN0LmNhbGxfaWQgKyByZXF1ZXN0LmZyb21fdGFnXSB8fAogICAgICAgICAgdGhpcy5zZXNzaW9uc1tyZXF1ZXN0LmNhbGxfaWQgKyByZXF1ZXN0LnRvX3RhZ10gfHwKICAgICAgICAgIG51bGw7Cn07CgovKioKICogR2V0IHRoZSBkaWFsb2cgdG8gd2hpY2ggdGhlIHJlcXVlc3QgYmVsb25ncyB0bywgaWYgYW55LgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge1NJUC5JbmNvbWluZ1JlcXVlc3R9CiAqIEByZXR1cm5zIHtTSVAuRGlhbG9nfG51bGx9CiAqLwpVQS5wcm90b3R5cGUuZmluZERpYWxvZyA9IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICByZXR1cm4gdGhpcy5kaWFsb2dzW3JlcXVlc3QuY2FsbF9pZCArIHJlcXVlc3QuZnJvbV90YWcgKyByZXF1ZXN0LnRvX3RhZ10gfHwKICAgICAgICAgIHRoaXMuZGlhbG9nc1tyZXF1ZXN0LmNhbGxfaWQgKyByZXF1ZXN0LnRvX3RhZyArIHJlcXVlc3QuZnJvbV90YWddIHx8CiAgICAgICAgICBudWxsOwp9OwoKLyoqCiAqIFJldHJpZXZlIHRoZSBuZXh0IHNlcnZlciB0byB3aGljaCBjb25uZWN0LgogKiBAcHJpdmF0ZQogKiBAcmV0dXJucyB7T2JqZWN0fSB3c19zZXJ2ZXIKICovClVBLnByb3RvdHlwZS5nZXROZXh0V3NTZXJ2ZXIgPSBmdW5jdGlvbigpIHsKICAvLyBPcmRlciBzZXJ2ZXJzIGJ5IHdlaWdodAogIHZhciBpZHgsIGxlbmd0aCwgd3Nfc2VydmVyLAogICAgY2FuZGlkYXRlcyA9IFtdOwoKICBsZW5ndGggPSB0aGlzLmNvbmZpZ3VyYXRpb24ud3NTZXJ2ZXJzLmxlbmd0aDsKICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgIHdzX3NlcnZlciA9IHRoaXMuY29uZmlndXJhdGlvbi53c1NlcnZlcnNbaWR4XTsKCiAgICBpZiAod3Nfc2VydmVyLnN0YXR1cyA9PT0gU0lQLlRyYW5zcG9ydC5DLlNUQVRVU19FUlJPUikgewogICAgICBjb250aW51ZTsKICAgIH0gZWxzZSBpZiAoY2FuZGlkYXRlcy5sZW5ndGggPT09IDApIHsKICAgICAgY2FuZGlkYXRlcy5wdXNoKHdzX3NlcnZlcik7CiAgICB9IGVsc2UgaWYgKHdzX3NlcnZlci53ZWlnaHQgPiBjYW5kaWRhdGVzWzBdLndlaWdodCkgewogICAgICBjYW5kaWRhdGVzID0gW3dzX3NlcnZlcl07CiAgICB9IGVsc2UgaWYgKHdzX3NlcnZlci53ZWlnaHQgPT09IGNhbmRpZGF0ZXNbMF0ud2VpZ2h0KSB7CiAgICAgIGNhbmRpZGF0ZXMucHVzaCh3c19zZXJ2ZXIpOwogICAgfQogIH0KCiAgaWR4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2FuZGlkYXRlcy5sZW5ndGgpOwoKICByZXR1cm4gY2FuZGlkYXRlc1tpZHhdOwp9OwoKLyoqCiAqIENsb3NlIGFsbCBzZXNzaW9ucyBvbiB0cmFuc3BvcnQgZXJyb3IuCiAqIEBwcml2YXRlCiAqLwpVQS5wcm90b3R5cGUuY2xvc2VTZXNzaW9uc09uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICB2YXIgaWR4OwoKICAvLyBSdW4gX3RyYW5zcG9ydEVycm9yXyBmb3IgZXZlcnkgU2Vzc2lvbgogIGZvcihpZHggaW4gdGhpcy5zZXNzaW9ucykgewogICAgdGhpcy5zZXNzaW9uc1tpZHhdLm9uVHJhbnNwb3J0RXJyb3IoKTsKICB9CiAgLy8gQ2FsbCByZWdpc3RlckNvbnRleHQgX29uVHJhbnNwb3J0Q2xvc2VkXwogIHRoaXMucmVnaXN0ZXJDb250ZXh0Lm9uVHJhbnNwb3J0Q2xvc2VkKCk7Cn07CgpVQS5wcm90b3R5cGUucmVjb3ZlclRyYW5zcG9ydCA9IGZ1bmN0aW9uKHVhKSB7CiAgdmFyIGlkeCwgbGVuZ3RoLCBrLCBuZXh0UmV0cnksIGNvdW50LCBzZXJ2ZXI7CgogIHVhID0gdWEgfHwgdGhpczsKICBjb3VudCA9IHVhLnRyYW5zcG9ydFJlY292ZXJBdHRlbXB0czsKCiAgbGVuZ3RoID0gdWEuY29uZmlndXJhdGlvbi53c1NlcnZlcnMubGVuZ3RoOwogIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgdWEuY29uZmlndXJhdGlvbi53c1NlcnZlcnNbaWR4XS5zdGF0dXMgPSAwOwogIH0KCiAgc2VydmVyID0gdWEuZ2V0TmV4dFdzU2VydmVyKCk7CgogIGsgPSBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpICogTWF0aC5wb3coMixjb3VudCkpICsxKTsKICBuZXh0UmV0cnkgPSBrICogdWEuY29uZmlndXJhdGlvbi5jb25uZWN0aW9uUmVjb3ZlcnlNaW5JbnRlcnZhbDsKCiAgaWYgKG5leHRSZXRyeSA+IHVhLmNvbmZpZ3VyYXRpb24uY29ubmVjdGlvblJlY292ZXJ5TWF4SW50ZXJ2YWwpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygndGltZSBmb3IgbmV4dCBjb25uZWN0aW9uIGF0dGVtcHQgZXhjZWVkcyBjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbCwgcmVzZXR0aW5nIGNvdW50ZXInKTsKICAgIG5leHRSZXRyeSA9IHVhLmNvbmZpZ3VyYXRpb24uY29ubmVjdGlvblJlY292ZXJ5TWluSW50ZXJ2YWw7CiAgICBjb3VudCA9IDA7CiAgfQoKICB0aGlzLmxvZ2dlci5sb2coJ25leHQgY29ubmVjdGlvbiBhdHRlbXB0IGluICcrIG5leHRSZXRyeSArJyBzZWNvbmRzJyk7CgogIHRoaXMudHJhbnNwb3J0UmVjb3ZlcnlUaW1lciA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCgKICAgIGZ1bmN0aW9uKCl7CiAgICAgIHVhLnRyYW5zcG9ydFJlY292ZXJBdHRlbXB0cyA9IGNvdW50ICsgMTsKICAgICAgbmV3IFNJUC5UcmFuc3BvcnQodWEsIHNlcnZlcik7CiAgICB9LCBuZXh0UmV0cnkgKiAxMDAwKTsKfTsKCmZ1bmN0aW9uIGNoZWNrQXV0aGVudGljYXRpb25GYWN0b3J5IChhdXRoZW50aWNhdGlvbkZhY3RvcnkpIHsKICBpZiAoIShhdXRoZW50aWNhdGlvbkZhY3RvcnkgaW5zdGFuY2VvZiBGdW5jdGlvbikpIHsKICAgIHJldHVybjsKICB9CiAgaWYgKCFhdXRoZW50aWNhdGlvbkZhY3RvcnkuaW5pdGlhbGl6ZSkgewogICAgYXV0aGVudGljYXRpb25GYWN0b3J5LmluaXRpYWxpemUgPSBmdW5jdGlvbiBpbml0aWFsaXplICgpIHsKICAgICAgcmV0dXJuIFNJUC5VdGlscy5Qcm9taXNlLnJlc29sdmUoKTsKICAgIH07CiAgfQogIHJldHVybiBhdXRoZW50aWNhdGlvbkZhY3Rvcnk7Cn0KCi8qKgogKiBDb25maWd1cmF0aW9uIGxvYWQuCiAqIEBwcml2YXRlCiAqIHJldHVybnMge0Jvb2xlYW59CiAqLwpVQS5wcm90b3R5cGUubG9hZENvbmZpZyA9IGZ1bmN0aW9uKGNvbmZpZ3VyYXRpb24pIHsKICAvLyBTZXR0aW5ncyBhbmQgZGVmYXVsdCB2YWx1ZXMKICB2YXIgcGFyYW1ldGVyLCB2YWx1ZSwgY2hlY2tlZF92YWx1ZSwgaG9zdHBvcnRQYXJhbXMsIHJlZ2lzdHJhclNlcnZlciwKICAgIHNldHRpbmdzID0gewogICAgICAvKiBIb3N0IGFkZHJlc3MKICAgICAgKiBWYWx1ZSB0byBiZSBzZXQgaW4gVmlhIHNlbnRfYnkgYW5kIGhvc3QgcGFydCBvZiBDb250YWN0IEZRRE4KICAgICAgKi8KICAgICAgdmlhSG9zdDogU0lQLlV0aWxzLmNyZWF0ZVJhbmRvbVRva2VuKDEyKSArICcuaW52YWxpZCcsCgogICAgICB1cmk6IG5ldyBTSVAuVVJJKCdzaXAnLCAnYW5vbnltb3VzLicgKyBTSVAuVXRpbHMuY3JlYXRlUmFuZG9tVG9rZW4oNiksICdhbm9ueW1vdXMuaW52YWxpZCcsIG51bGwsIG51bGwpLAogICAgICB3c1NlcnZlcnM6IFt7CiAgICAgICAgc2NoZW1lOiAnV1NTJywKICAgICAgICBzaXBfdXJpOiAnPHNpcDplZGdlLnNpcC5vbnNpcC5jb207dHJhbnNwb3J0PXdzO2xyPicsCiAgICAgICAgc3RhdHVzOiAwLAogICAgICAgIHdlaWdodDogMCwKICAgICAgICB3c191cmk6ICd3c3M6Ly9lZGdlLnNpcC5vbnNpcC5jb20nCiAgICAgIH1dLAoKICAgICAgLy8gUGFzc3dvcmQKICAgICAgcGFzc3dvcmQ6IG51bGwsCgogICAgICAvLyBSZWdpc3RyYXRpb24gcGFyYW1ldGVycwogICAgICByZWdpc3RlckV4cGlyZXM6IDYwMCwKICAgICAgcmVnaXN0ZXI6IHRydWUsCiAgICAgIHJlZ2lzdHJhclNlcnZlcjogbnVsbCwKCiAgICAgIC8vIFRyYW5zcG9ydCByZWxhdGVkIHBhcmFtZXRlcnMKICAgICAgd3NTZXJ2ZXJNYXhSZWNvbm5lY3Rpb246IDMsCiAgICAgIHdzU2VydmVyUmVjb25uZWN0aW9uVGltZW91dDogNCwKCiAgICAgIGNvbm5lY3Rpb25SZWNvdmVyeU1pbkludGVydmFsOiAyLAogICAgICBjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbDogMzAsCgogICAgICBrZWVwQWxpdmVJbnRlcnZhbDogMCwKCiAgICAgIGV4dHJhU3VwcG9ydGVkOiBbXSwKCiAgICAgIHVzZVByZWxvYWRlZFJvdXRlOiBmYWxzZSwKCiAgICAgIC8vc3RyaW5nIHRvIGJlIGluc2VydGVkIGludG8gVXNlci1BZ2VudCByZXF1ZXN0IGhlYWRlcgogICAgICB1c2VyQWdlbnRTdHJpbmc6IFNJUC5DLlVTRVJfQUdFTlQsCgogICAgICAvLyBTZXNzaW9uIHBhcmFtZXRlcnMKICAgICAgaWNlQ2hlY2tpbmdUaW1lb3V0OiA1MDAwLAogICAgICBub0Fuc3dlclRpbWVvdXQ6IDYwLAogICAgICBzdHVuU2VydmVyczogWydzdHVuOnN0dW4ubC5nb29nbGUuY29tOjE5MzAyJ10sCiAgICAgIHR1cm5TZXJ2ZXJzOiBbXSwKCiAgICAgIC8vIExvZ2dpbmcgcGFyYW1ldGVycwogICAgICB0cmFjZVNpcDogZmFsc2UsCgogICAgICAvLyBIYWNrcwogICAgICBoYWNrVmlhVGNwOiBmYWxzZSwKICAgICAgaGFja0lwSW5Db250YWN0OiBmYWxzZSwKICAgICAgaGFja1dzc0luVHJhbnNwb3J0OiBmYWxzZSwKICAgICAgaGFja0FsbG93VW5yZWdpc3RlcmVkT3B0aW9uVGFnczogZmFsc2UsCgogICAgICBjb250YWN0VHJhbnNwb3J0OiAnd3MnLAogICAgICBmb3JjZVJwb3J0OiBmYWxzZSwKCiAgICAgIC8vYXV0b3N0YXJ0aW5nCiAgICAgIGF1dG9zdGFydDogdHJ1ZSwKCiAgICAgIC8vUmVsaWFibGUgUHJvdmlzaW9uYWwgUmVzcG9uc2VzCiAgICAgIHJlbDEwMDogU0lQLkMuc3VwcG9ydGVkLlVOU1VQUE9SVEVELAoKICAgICAgLy8gUmVwbGFjZXMgaGVhZGVyIChSRkMgMzg5MSkKICAgICAgLy8gaHR0cDovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzg5MQogICAgICByZXBsYWNlczogU0lQLkMuc3VwcG9ydGVkLlVOU1VQUE9SVEVELAoKICAgICAgbWVkaWFIYW5kbGVyRmFjdG9yeTogU0lQLldlYlJUQy5NZWRpYUhhbmRsZXIuZGVmYXVsdEZhY3RvcnksCgogICAgICBhdXRoZW50aWNhdGlvbkZhY3Rvcnk6IGNoZWNrQXV0aGVudGljYXRpb25GYWN0b3J5KGZ1bmN0aW9uIGF1dGhlbnRpY2F0aW9uRmFjdG9yeSAodWEpIHsKICAgICAgICByZXR1cm4gbmV3IFNJUC5EaWdlc3RBdXRoZW50aWNhdGlvbih1YSk7CiAgICAgIH0pCiAgICB9OwoKICAvLyBQcmUtQ29uZmlndXJhdGlvbgogIGZ1bmN0aW9uIGFsaWFzVW5kZXJzY29yZWQgKHBhcmFtZXRlciwgbG9nZ2VyKSB7CiAgICB2YXIgdW5kZXJzY29yZWQgPSBwYXJhbWV0ZXIucmVwbGFjZSgvKFthLXpdW0EtWl0pL2csIGZ1bmN0aW9uIChtKSB7CiAgICAgIHJldHVybiBtWzBdICsgJ18nICsgbVsxXS50b0xvd2VyQ2FzZSgpOwogICAgfSk7CgogICAgaWYgKHBhcmFtZXRlciA9PT0gdW5kZXJzY29yZWQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBoYXNQYXJhbWV0ZXIgPSBjb25maWd1cmF0aW9uLmhhc093blByb3BlcnR5KHBhcmFtZXRlcik7CiAgICBpZiAoY29uZmlndXJhdGlvbi5oYXNPd25Qcm9wZXJ0eSh1bmRlcnNjb3JlZCkpIHsKICAgICAgbG9nZ2VyLndhcm4odW5kZXJzY29yZWQgKyAnIGlzIGRlcHJlY2F0ZWQsIHBsZWFzZSB1c2UgJyArIHBhcmFtZXRlcik7CiAgICAgIGlmIChoYXNQYXJhbWV0ZXIpIHsKICAgICAgICBsb2dnZXIud2FybihwYXJhbWV0ZXIgKyAnIG92ZXJyaWRpbmcgJyArIHVuZGVyc2NvcmVkKTsKICAgICAgfQogICAgfQoKICAgIGNvbmZpZ3VyYXRpb25bcGFyYW1ldGVyXSA9IGhhc1BhcmFtZXRlciA/IGNvbmZpZ3VyYXRpb25bcGFyYW1ldGVyXSA6IGNvbmZpZ3VyYXRpb25bdW5kZXJzY29yZWRdOwogIH0KCiAgLy8gQ2hlY2sgTWFuZGF0b3J5IHBhcmFtZXRlcnMKICBmb3IocGFyYW1ldGVyIGluIFVBLmNvbmZpZ3VyYXRpb25fY2hlY2subWFuZGF0b3J5KSB7CiAgICBhbGlhc1VuZGVyc2NvcmVkKHBhcmFtZXRlciwgdGhpcy5sb2dnZXIpOwogICAgaWYoIWNvbmZpZ3VyYXRpb24uaGFzT3duUHJvcGVydHkocGFyYW1ldGVyKSkgewogICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuQ29uZmlndXJhdGlvbkVycm9yKHBhcmFtZXRlcik7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZSA9IGNvbmZpZ3VyYXRpb25bcGFyYW1ldGVyXTsKICAgICAgY2hlY2tlZF92YWx1ZSA9IFVBLmNvbmZpZ3VyYXRpb25fY2hlY2subWFuZGF0b3J5W3BhcmFtZXRlcl0odmFsdWUpOwogICAgICBpZiAoY2hlY2tlZF92YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgc2V0dGluZ3NbcGFyYW1ldGVyXSA9IGNoZWNrZWRfdmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkNvbmZpZ3VyYXRpb25FcnJvcihwYXJhbWV0ZXIsIHZhbHVlKTsKICAgICAgfQogICAgfQogIH0KCiAgU0lQLlV0aWxzLm9wdGlvbnNPdmVycmlkZShjb25maWd1cmF0aW9uLCAncmVsMTAwJywgJ3JlbGlhYmxlJywgdHJ1ZSwgdGhpcy5sb2dnZXIsIFNJUC5DLnN1cHBvcnRlZC5VTlNVUFBPUlRFRCk7CgogIHZhciBlbXB0eUFycmF5c0FsbG93ZWQgPSBbJ3N0dW5TZXJ2ZXJzJywgJ3R1cm5TZXJ2ZXJzJ107CgogIC8vIENoZWNrIE9wdGlvbmFsIHBhcmFtZXRlcnMKICBmb3IocGFyYW1ldGVyIGluIFVBLmNvbmZpZ3VyYXRpb25fY2hlY2sub3B0aW9uYWwpIHsKICAgIGFsaWFzVW5kZXJzY29yZWQocGFyYW1ldGVyLCB0aGlzLmxvZ2dlcik7CiAgICBpZihjb25maWd1cmF0aW9uLmhhc093blByb3BlcnR5KHBhcmFtZXRlcikpIHsKICAgICAgdmFsdWUgPSBjb25maWd1cmF0aW9uW3BhcmFtZXRlcl07CgogICAgICAvLyBJZiB0aGUgcGFyYW1ldGVyIHZhbHVlIGlzIGFuIGVtcHR5IGFycmF5LCBidXQgc2hvdWxkbid0IGJlLCBhcHBseSBpdHMgZGVmYXVsdCB2YWx1ZS4KICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkgJiYgdmFsdWUubGVuZ3RoID09PSAwICYmIGVtcHR5QXJyYXlzQWxsb3dlZC5pbmRleE9mKHBhcmFtZXRlcikgPCAwKSB7IGNvbnRpbnVlOyB9CgogICAgICAvLyBJZiB0aGUgcGFyYW1ldGVyIHZhbHVlIGlzIG51bGwsIGVtcHR5IHN0cmluZywgb3IgdW5kZWZpbmVkIHRoZW4gYXBwbHkgaXRzIGRlZmF1bHQgdmFsdWUuCiAgICAgIGlmKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSAiIiB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7IGNvbnRpbnVlOyB9CiAgICAgIC8vIElmIGl0J3MgYSBudW1iZXIgd2l0aCBOYU4gdmFsdWUgdGhlbiBhbHNvIGFwcGx5IGl0cyBkZWZhdWx0IHZhbHVlLgogICAgICAvLyBOT1RFOiBKUyBkb2VzIG5vdCBhbGxvdyAidmFsdWUgPT09IE5hTiIsIHRoZSBmb2xsb3dpbmcgZG9lcyB0aGUgd29yazoKICAgICAgZWxzZSBpZih0eXBlb2YodmFsdWUpID09PSAnbnVtYmVyJyAmJiBpc05hTih2YWx1ZSkpIHsgY29udGludWU7IH0KCiAgICAgIGNoZWNrZWRfdmFsdWUgPSBVQS5jb25maWd1cmF0aW9uX2NoZWNrLm9wdGlvbmFsW3BhcmFtZXRlcl0odmFsdWUpOwogICAgICBpZiAoY2hlY2tlZF92YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgc2V0dGluZ3NbcGFyYW1ldGVyXSA9IGNoZWNrZWRfdmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkNvbmZpZ3VyYXRpb25FcnJvcihwYXJhbWV0ZXIsIHZhbHVlKTsKICAgICAgfQogICAgfQogIH0KCiAgLy8gU2FuaXR5IENoZWNrcwoKICAvLyBDb25uZWN0aW9uIHJlY292ZXJ5IGludGVydmFscwogIGlmKHNldHRpbmdzLmNvbm5lY3Rpb25SZWNvdmVyeU1heEludGVydmFsIDwgc2V0dGluZ3MuY29ubmVjdGlvblJlY292ZXJ5TWluSW50ZXJ2YWwpIHsKICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5Db25maWd1cmF0aW9uRXJyb3IoJ2Nvbm5lY3Rpb25SZWNvdmVyeU1heEludGVydmFsJywgc2V0dGluZ3MuY29ubmVjdGlvblJlY292ZXJ5TWF4SW50ZXJ2YWwpOwogIH0KCiAgLy8gUG9zdCBDb25maWd1cmF0aW9uIFByb2Nlc3MKCiAgLy8gQWxsb3cgcGFzc2luZyAwIG51bWJlciBhcyBkaXNwbGF5TmFtZS4KICBpZiAoc2V0dGluZ3MuZGlzcGxheU5hbWUgPT09IDApIHsKICAgIHNldHRpbmdzLmRpc3BsYXlOYW1lID0gJzAnOwogIH0KCiAgLy8gSW5zdGFuY2UtaWQgZm9yIEdSVVUKICBpZiAoIXNldHRpbmdzLmluc3RhbmNlSWQpIHsKICAgIHNldHRpbmdzLmluc3RhbmNlSWQgPSBTSVAuVXRpbHMubmV3VVVJRCgpOwogIH0KCiAgLy8gc2lwanNJZCBpbnN0YW5jZSBwYXJhbWV0ZXIuIFN0YXRpYyByYW5kb20gdGFnIG9mIGxlbmd0aCA1CiAgc2V0dGluZ3Muc2lwanNJZCA9IFNJUC5VdGlscy5jcmVhdGVSYW5kb21Ub2tlbig1KTsKCiAgLy8gU3RyaW5nIGNvbnRhaW5pbmcgc2V0dGluZ3MudXJpIHdpdGhvdXQgc2NoZW1lIGFuZCB1c2VyLgogIGhvc3Rwb3J0UGFyYW1zID0gc2V0dGluZ3MudXJpLmNsb25lKCk7CiAgaG9zdHBvcnRQYXJhbXMudXNlciA9IG51bGw7CiAgc2V0dGluZ3MuaG9zdHBvcnRQYXJhbXMgPSBob3N0cG9ydFBhcmFtcy50b1JhdygpLnJlcGxhY2UoL15zaXA6L2ksICcnKTsKCiAgLyogQ2hlY2sgd2hldGhlciBhdXRob3JpemF0aW9uVXNlciBpcyBleHBsaWNpdGx5IGRlZmluZWQuCiAgICogVGFrZSAnc2V0dGluZ3MudXJpLnVzZXInIHZhbHVlIGlmIG5vdC4KICAgKi8KICBpZiAoIXNldHRpbmdzLmF1dGhvcml6YXRpb25Vc2VyKSB7CiAgICBzZXR0aW5ncy5hdXRob3JpemF0aW9uVXNlciA9IHNldHRpbmdzLnVyaS51c2VyOwogIH0KCiAgLyogSWYgbm8gJ3JlZ2lzdHJhclNlcnZlcicgaXMgc2V0IHVzZSB0aGUgJ3VyaScgdmFsdWUgd2l0aG91dCB1c2VyIHBvcnRpb24uICovCiAgaWYgKCFzZXR0aW5ncy5yZWdpc3RyYXJTZXJ2ZXIpIHsKICAgIHJlZ2lzdHJhclNlcnZlciA9IHNldHRpbmdzLnVyaS5jbG9uZSgpOwogICAgcmVnaXN0cmFyU2VydmVyLnVzZXIgPSBudWxsOwogICAgc2V0dGluZ3MucmVnaXN0cmFyU2VydmVyID0gcmVnaXN0cmFyU2VydmVyOwogIH0KCiAgLy8gVXNlciBub0Fuc3dlclRpbWVvdXQKICBzZXR0aW5ncy5ub0Fuc3dlclRpbWVvdXQgPSBzZXR0aW5ncy5ub0Fuc3dlclRpbWVvdXQgKiAxMDAwOwoKICAvLyBWaWEgSG9zdAogIGlmIChzZXR0aW5ncy5oYWNrSXBJbkNvbnRhY3QpIHsKICAgIGlmICh0eXBlb2Ygc2V0dGluZ3MuaGFja0lwSW5Db250YWN0ID09PSAnYm9vbGVhbicpIHsKICAgICAgc2V0dGluZ3MudmlhSG9zdCA9IFNJUC5VdGlscy5nZXRSYW5kb21UZXN0TmV0SVAoKTsKICAgIH0KICAgIGVsc2UgaWYgKHR5cGVvZiBzZXR0aW5ncy5oYWNrSXBJbkNvbnRhY3QgPT09ICdzdHJpbmcnKSB7CiAgICAgIHNldHRpbmdzLnZpYUhvc3QgPSBzZXR0aW5ncy5oYWNrSXBJbkNvbnRhY3Q7CiAgICB9CiAgfQoKICAvLyBDb250YWN0IHRyYW5zcG9ydCBwYXJhbWV0ZXIKICBpZiAoc2V0dGluZ3MuaGFja1dzc0luVHJhbnNwb3J0KSB7CiAgICBzZXR0aW5ncy5jb250YWN0VHJhbnNwb3J0ID0gJ3dzcyc7CiAgfQoKICB0aGlzLmNvbnRhY3QgPSB7CiAgICBwdWJfZ3J1dTogbnVsbCwKICAgIHRlbXBfZ3J1dTogbnVsbCwKICAgIHVyaTogbmV3IFNJUC5VUkkoJ3NpcCcsIFNJUC5VdGlscy5jcmVhdGVSYW5kb21Ub2tlbig4KSwgc2V0dGluZ3MudmlhSG9zdCwgbnVsbCwge3RyYW5zcG9ydDogc2V0dGluZ3MuY29udGFjdFRyYW5zcG9ydH0pLAogICAgdG9TdHJpbmc6IGZ1bmN0aW9uKG9wdGlvbnMpewogICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgICAgIHZhcgogICAgICAgIGFub255bW91cyA9IG9wdGlvbnMuYW5vbnltb3VzIHx8IG51bGwsCiAgICAgICAgb3V0Ym91bmQgPSBvcHRpb25zLm91dGJvdW5kIHx8IG51bGwsCiAgICAgICAgY29udGFjdCA9ICc8JzsKCiAgICAgIGlmIChhbm9ueW1vdXMpIHsKICAgICAgICBjb250YWN0ICs9ICh0aGlzLnRlbXBfZ3J1dSB8fCAoJ3NpcDphbm9ueW1vdXNAYW5vbnltb3VzLmludmFsaWQ7dHJhbnNwb3J0PScrc2V0dGluZ3MuY29udGFjdFRyYW5zcG9ydCkpLnRvU3RyaW5nKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGFjdCArPSAodGhpcy5wdWJfZ3J1dSB8fCB0aGlzLnVyaSkudG9TdHJpbmcoKTsKICAgICAgfQoKICAgICAgaWYgKG91dGJvdW5kKSB7CiAgICAgICAgY29udGFjdCArPSAnO29iJzsKICAgICAgfQoKICAgICAgY29udGFjdCArPSAnPic7CgogICAgICByZXR1cm4gY29udGFjdDsKICAgIH0KICB9OwoKICAvLyBtZWRpYSBvdmVycmlkZXMgbWVkaWFDb25zdHJhaW50cwogIFNJUC5VdGlscy5vcHRpb25zT3ZlcnJpZGUoc2V0dGluZ3MsICdtZWRpYScsICdtZWRpYUNvbnN0cmFpbnRzJywgdHJ1ZSwgdGhpcy5sb2dnZXIpOwoKICAvLyBGaWxsIHRoZSB2YWx1ZSBvZiB0aGUgY29uZmlndXJhdGlvbl9za2VsZXRvbgogIGZvcihwYXJhbWV0ZXIgaW4gc2V0dGluZ3MpIHsKICAgIFVBLmNvbmZpZ3VyYXRpb25fc2tlbGV0b25bcGFyYW1ldGVyXS52YWx1ZSA9IHNldHRpbmdzW3BhcmFtZXRlcl07CiAgfQoKICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLmNvbmZpZ3VyYXRpb24sIFVBLmNvbmZpZ3VyYXRpb25fc2tlbGV0b24pOwoKICAvLyBDbGVhbiBVQS5jb25maWd1cmF0aW9uX3NrZWxldG9uCiAgZm9yKHBhcmFtZXRlciBpbiBzZXR0aW5ncykgewogICAgVUEuY29uZmlndXJhdGlvbl9za2VsZXRvbltwYXJhbWV0ZXJdLnZhbHVlID0gJyc7CiAgfQoKICB0aGlzLmxvZ2dlci5sb2coJ2NvbmZpZ3VyYXRpb24gcGFyYW1ldGVycyBhZnRlciB2YWxpZGF0aW9uOicpOwogIGZvcihwYXJhbWV0ZXIgaW4gc2V0dGluZ3MpIHsKICAgIHN3aXRjaChwYXJhbWV0ZXIpIHsKICAgICAgY2FzZSAndXJpJzoKICAgICAgY2FzZSAncmVnaXN0cmFyU2VydmVyJzoKICAgICAgY2FzZSAnbWVkaWFIYW5kbGVyRmFjdG9yeSc6CiAgICAgICAgdGhpcy5sb2dnZXIubG9nKCfCtyAnICsgcGFyYW1ldGVyICsgJzogJyArIHNldHRpbmdzW3BhcmFtZXRlcl0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdwYXNzd29yZCc6CiAgICAgICAgdGhpcy5sb2dnZXIubG9nKCfCtyAnICsgcGFyYW1ldGVyICsgJzogJyArICdOT1QgU0hPV04nKTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ8K3ICcgKyBwYXJhbWV0ZXIgKyAnOiAnICsgSlNPTi5zdHJpbmdpZnkoc2V0dGluZ3NbcGFyYW1ldGVyXSkpOwogICAgfQogIH0KCiAgcmV0dXJuOwp9OwoKLyoqCiAqIENvbmZpZ3VyYXRpb24gT2JqZWN0IHNrZWxldG9uLgogKiBAcHJpdmF0ZQogKi8KVUEuY29uZmlndXJhdGlvbl9za2VsZXRvbiA9IChmdW5jdGlvbigpIHsKICB2YXIgaWR4LCAgcGFyYW1ldGVyLAogICAgc2tlbGV0b24gPSB7fSwKICAgIHBhcmFtZXRlcnMgPSBbCiAgICAgIC8vIEludGVybmFsIHBhcmFtZXRlcnMKICAgICAgInNpcGpzSWQiLAogICAgICAiaG9zdHBvcnRQYXJhbXMiLAoKICAgICAgLy8gT3B0aW9uYWwgdXNlciBjb25maWd1cmFibGUgcGFyYW1ldGVycwogICAgICAidXJpIiwKICAgICAgIndzU2VydmVycyIsCiAgICAgICJhdXRob3JpemF0aW9uVXNlciIsCiAgICAgICJjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbCIsCiAgICAgICJjb25uZWN0aW9uUmVjb3ZlcnlNaW5JbnRlcnZhbCIsCiAgICAgICJrZWVwQWxpdmVJbnRlcnZhbCIsCiAgICAgICJleHRyYVN1cHBvcnRlZCIsCiAgICAgICJkaXNwbGF5TmFtZSIsCiAgICAgICJoYWNrVmlhVGNwIiwgLy8gZmFsc2UuCiAgICAgICJoYWNrSXBJbkNvbnRhY3QiLCAvL2ZhbHNlCiAgICAgICJoYWNrV3NzSW5UcmFuc3BvcnQiLCAvL2ZhbHNlCiAgICAgICJoYWNrQWxsb3dVbnJlZ2lzdGVyZWRPcHRpb25UYWdzIiwgLy9mYWxzZQogICAgICAiY29udGFjdFRyYW5zcG9ydCIsIC8vICd3cycKICAgICAgImZvcmNlUnBvcnQiLCAvLyBmYWxzZQogICAgICAiaWNlQ2hlY2tpbmdUaW1lb3V0IiwKICAgICAgImluc3RhbmNlSWQiLAogICAgICAibm9BbnN3ZXJUaW1lb3V0IiwgLy8gMzAgc2Vjb25kcy4KICAgICAgInBhc3N3b3JkIiwKICAgICAgInJlZ2lzdGVyRXhwaXJlcyIsIC8vIDYwMCBzZWNvbmRzLgogICAgICAicmVnaXN0cmFyU2VydmVyIiwKICAgICAgInJlbGlhYmxlIiwKICAgICAgInJlbDEwMCIsCiAgICAgICJyZXBsYWNlcyIsCiAgICAgICJ1c2VyQWdlbnRTdHJpbmciLCAvL1NJUC5DLlVTRVJfQUdFTlQKICAgICAgImF1dG9zdGFydCIsCiAgICAgICJzdHVuU2VydmVycyIsCiAgICAgICJ0cmFjZVNpcCIsCiAgICAgICJ0dXJuU2VydmVycyIsCiAgICAgICJ1c2VQcmVsb2FkZWRSb3V0ZSIsCiAgICAgICJ3c1NlcnZlck1heFJlY29ubmVjdGlvbiIsCiAgICAgICJ3c1NlcnZlclJlY29ubmVjdGlvblRpbWVvdXQiLAogICAgICAibWVkaWFIYW5kbGVyRmFjdG9yeSIsCiAgICAgICJtZWRpYSIsCiAgICAgICJtZWRpYUNvbnN0cmFpbnRzIiwKICAgICAgImF1dGhlbnRpY2F0aW9uRmFjdG9yeSIsCgogICAgICAvLyBQb3N0LWNvbmZpZ3VyYXRpb24gZ2VuZXJhdGVkIHBhcmFtZXRlcnMKICAgICAgInZpYV9jb3JlX3ZhbHVlIiwKICAgICAgInZpYUhvc3QiCiAgICBdOwoKICBmb3IoaWR4IGluIHBhcmFtZXRlcnMpIHsKICAgIHBhcmFtZXRlciA9IHBhcmFtZXRlcnNbaWR4XTsKICAgIHNrZWxldG9uW3BhcmFtZXRlcl0gPSB7CiAgICAgIHZhbHVlOiAnJywKICAgICAgd3JpdGFibGU6IGZhbHNlLAogICAgICBjb25maWd1cmFibGU6IGZhbHNlCiAgICB9OwogIH0KCiAgc2tlbGV0b25bJ3JlZ2lzdGVyJ10gPSB7CiAgICB2YWx1ZTogJycsCiAgICB3cml0YWJsZTogdHJ1ZSwKICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UKICB9OwoKICByZXR1cm4gc2tlbGV0b247Cn0oKSk7CgovKioKICogQ29uZmlndXJhdGlvbiBjaGVja2VyLgogKiBAcHJpdmF0ZQogKiBAcmV0dXJuIHtCb29sZWFufQogKi8KVUEuY29uZmlndXJhdGlvbl9jaGVjayA9IHsKICBtYW5kYXRvcnk6IHsKICB9LAoKICBvcHRpb25hbDogewoKICAgIHVyaTogZnVuY3Rpb24odXJpKSB7CiAgICAgIHZhciBwYXJzZWQ7CgogICAgICBpZiAoISgvXnNpcDovaSkudGVzdCh1cmkpKSB7CiAgICAgICAgdXJpID0gU0lQLkMuU0lQICsgJzonICsgdXJpOwogICAgICB9CiAgICAgIHBhcnNlZCA9IFNJUC5VUkkucGFyc2UodXJpKTsKCiAgICAgIGlmKCFwYXJzZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZighcGFyc2VkLnVzZXIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHBhcnNlZDsKICAgICAgfQogICAgfSwKCiAgICAvL05vdGU6IHRoaXMgZnVuY3Rpb24gdXNlZCB0byBjYWxsICd0aGlzLmxvZ2dlci5lcnJvcicgYnV0IGNhbGxpbmcgJ3RoaXMnIHdpdGggYW55dGhpbmcgaGVyZSBpcyBpbnZhbGlkCiAgICB3c1NlcnZlcnM6IGZ1bmN0aW9uKHdzU2VydmVycykgewogICAgICB2YXIgaWR4LCBsZW5ndGgsIHVybDsKCiAgICAgIC8qIEFsbG93IGRlZmluaW5nIHdzU2VydmVycyBwYXJhbWV0ZXIgYXM6CiAgICAgICAqICBTdHJpbmc6ICJob3N0IgogICAgICAgKiAgQXJyYXkgb2YgU3RyaW5nczogWyJob3N0MSIsICJob3N0MiJdCiAgICAgICAqICBBcnJheSBvZiBPYmplY3RzOiBbe3dzX3VyaToiaG9zdDEiLCB3ZWlnaHQ6MX0sIHt3c191cmk6Imhvc3QyIiwgd2VpZ2h0OjB9XQogICAgICAgKiAgQXJyYXkgb2YgT2JqZWN0cyBhbmQgU3RyaW5nczogW3t3c191cmk6Imhvc3QxIn0sICJob3N0MiJdCiAgICAgICAqLwogICAgICBpZiAodHlwZW9mIHdzU2VydmVycyA9PT0gJ3N0cmluZycpIHsKICAgICAgICB3c1NlcnZlcnMgPSBbe3dzX3VyaTogd3NTZXJ2ZXJzfV07CiAgICAgIH0gZWxzZSBpZiAod3NTZXJ2ZXJzIGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgICBsZW5ndGggPSB3c1NlcnZlcnMubGVuZ3RoOwogICAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICAgICAgaWYgKHR5cGVvZiB3c1NlcnZlcnNbaWR4XSA9PT0gJ3N0cmluZycpewogICAgICAgICAgICB3c1NlcnZlcnNbaWR4XSA9IHt3c191cmk6IHdzU2VydmVyc1tpZHhdfTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAod3NTZXJ2ZXJzLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgbGVuZ3RoID0gd3NTZXJ2ZXJzLmxlbmd0aDsKICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgaWYgKCF3c1NlcnZlcnNbaWR4XS53c191cmkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKHdzU2VydmVyc1tpZHhdLndlaWdodCAmJiAhTnVtYmVyKHdzU2VydmVyc1tpZHhdLndlaWdodCkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHVybCA9IFNJUC5HcmFtbWFyLnBhcnNlKHdzU2VydmVyc1tpZHhdLndzX3VyaSwgJ2Fic29sdXRlVVJJJyk7CgogICAgICAgIGlmKHVybCA9PT0gLTEpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgaWYoWyd3c3MnLCAnd3MnLCAndWRwJ10uaW5kZXhPZih1cmwuc2NoZW1lKSA8IDApIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgd3NTZXJ2ZXJzW2lkeF0uc2lwX3VyaSA9ICc8c2lwOicgKyB1cmwuaG9zdCArICh1cmwucG9ydCA/ICc6JyArIHVybC5wb3J0IDogJycpICsgJzt0cmFuc3BvcnQ9JyArIHVybC5zY2hlbWUucmVwbGFjZSgvXndzcyQvaSwgJ3dzJykgKyAnO2xyPic7CgogICAgICAgICAgaWYgKCF3c1NlcnZlcnNbaWR4XS53ZWlnaHQpIHsKICAgICAgICAgICAgd3NTZXJ2ZXJzW2lkeF0ud2VpZ2h0ID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICB3c1NlcnZlcnNbaWR4XS5zdGF0dXMgPSAwOwogICAgICAgICAgd3NTZXJ2ZXJzW2lkeF0uc2NoZW1lID0gdXJsLnNjaGVtZS50b1VwcGVyQ2FzZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gd3NTZXJ2ZXJzOwogICAgfSwKCiAgICBhdXRob3JpemF0aW9uVXNlcjogZnVuY3Rpb24oYXV0aG9yaXphdGlvblVzZXIpIHsKICAgICAgaWYoU0lQLkdyYW1tYXIucGFyc2UoJyInKyBhdXRob3JpemF0aW9uVXNlciArJyInLCAncXVvdGVkX3N0cmluZycpID09PSAtMSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYXV0aG9yaXphdGlvblVzZXI7CiAgICAgIH0KICAgIH0sCgogICAgY29ubmVjdGlvblJlY292ZXJ5TWF4SW50ZXJ2YWw6IGZ1bmN0aW9uKGNvbm5lY3Rpb25SZWNvdmVyeU1heEludGVydmFsKSB7CiAgICAgIHZhciB2YWx1ZTsKICAgICAgaWYoU0lQLlV0aWxzLmlzRGVjaW1hbChjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbCkpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcihjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbCk7CiAgICAgICAgaWYodmFsdWUgPiAwKSB7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIGNvbm5lY3Rpb25SZWNvdmVyeU1pbkludGVydmFsOiBmdW5jdGlvbihjb25uZWN0aW9uUmVjb3ZlcnlNaW5JbnRlcnZhbCkgewogICAgICB2YXIgdmFsdWU7CiAgICAgIGlmKFNJUC5VdGlscy5pc0RlY2ltYWwoY29ubmVjdGlvblJlY292ZXJ5TWluSW50ZXJ2YWwpKSB7CiAgICAgICAgdmFsdWUgPSBOdW1iZXIoY29ubmVjdGlvblJlY292ZXJ5TWluSW50ZXJ2YWwpOwogICAgICAgIGlmKHZhbHVlID4gMCkgewogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBkaXNwbGF5TmFtZTogZnVuY3Rpb24oZGlzcGxheU5hbWUpIHsKICAgICAgaWYoU0lQLkdyYW1tYXIucGFyc2UoJyInICsgZGlzcGxheU5hbWUgKyAnIicsICdkaXNwbGF5TmFtZScpID09PSAtMSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZGlzcGxheU5hbWU7CiAgICAgIH0KICAgIH0sCgogICAgaGFja1ZpYVRjcDogZnVuY3Rpb24oaGFja1ZpYVRjcCkgewogICAgICBpZiAodHlwZW9mIGhhY2tWaWFUY3AgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiBoYWNrVmlhVGNwOwogICAgICB9CiAgICB9LAoKICAgIGhhY2tJcEluQ29udGFjdDogZnVuY3Rpb24oaGFja0lwSW5Db250YWN0KSB7CiAgICAgIGlmICh0eXBlb2YgaGFja0lwSW5Db250YWN0ID09PSAnYm9vbGVhbicpIHsKICAgICAgICByZXR1cm4gaGFja0lwSW5Db250YWN0OwogICAgICB9CiAgICAgIGVsc2UgaWYgKHR5cGVvZiBoYWNrSXBJbkNvbnRhY3QgPT09ICdzdHJpbmcnICYmIFNJUC5HcmFtbWFyLnBhcnNlKGhhY2tJcEluQ29udGFjdCwgJ2hvc3QnKSAhPT0gLTEpIHsKICAgICAgICByZXR1cm4gaGFja0lwSW5Db250YWN0OwogICAgICB9CiAgICB9LAoKICAgIGljZUNoZWNraW5nVGltZW91dDogZnVuY3Rpb24oaWNlQ2hlY2tpbmdUaW1lb3V0KSB7CiAgICAgIGlmKFNJUC5VdGlscy5pc0RlY2ltYWwoaWNlQ2hlY2tpbmdUaW1lb3V0KSkgewogICAgICAgIHJldHVybiBNYXRoLm1heCg1MDAsIGljZUNoZWNraW5nVGltZW91dCk7CiAgICAgIH0KICAgIH0sCgogICAgaGFja1dzc0luVHJhbnNwb3J0OiBmdW5jdGlvbihoYWNrV3NzSW5UcmFuc3BvcnQpIHsKICAgICAgaWYgKHR5cGVvZiBoYWNrV3NzSW5UcmFuc3BvcnQgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiBoYWNrV3NzSW5UcmFuc3BvcnQ7CiAgICAgIH0KICAgIH0sCgogICAgaGFja0FsbG93VW5yZWdpc3RlcmVkT3B0aW9uVGFnczogZnVuY3Rpb24oaGFja0FsbG93VW5yZWdpc3RlcmVkT3B0aW9uVGFncykgewogICAgICBpZiAodHlwZW9mIGhhY2tBbGxvd1VucmVnaXN0ZXJlZE9wdGlvblRhZ3MgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiBoYWNrQWxsb3dVbnJlZ2lzdGVyZWRPcHRpb25UYWdzOwogICAgICB9CiAgICB9LAoKICAgIGNvbnRhY3RUcmFuc3BvcnQ6IGZ1bmN0aW9uKGNvbnRhY3RUcmFuc3BvcnQpIHsKICAgICAgaWYgKHR5cGVvZiBjb250YWN0VHJhbnNwb3J0ID09PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybiBjb250YWN0VHJhbnNwb3J0OwogICAgICB9CiAgICB9LAoKICAgIGZvcmNlUnBvcnQ6IGZ1bmN0aW9uKGZvcmNlUnBvcnQpIHsKICAgICAgaWYgKHR5cGVvZiBmb3JjZVJwb3J0ID09PSAnYm9vbGVhbicpIHsKICAgICAgICByZXR1cm4gZm9yY2VScG9ydDsKICAgICAgfQogICAgfSwKCiAgICBpbnN0YW5jZUlkOiBmdW5jdGlvbihpbnN0YW5jZUlkKSB7CiAgICAgIGlmKHR5cGVvZiBpbnN0YW5jZUlkICE9PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCgvXnV1aWQ6L2kudGVzdChpbnN0YW5jZUlkKSkpIHsKICAgICAgICBpbnN0YW5jZUlkID0gaW5zdGFuY2VJZC5zdWJzdHIoNSk7CiAgICAgIH0KCiAgICAgIGlmKFNJUC5HcmFtbWFyLnBhcnNlKGluc3RhbmNlSWQsICd1dWlkJykgPT09IC0xKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBpbnN0YW5jZUlkOwogICAgICB9CiAgICB9LAoKICAgIGtlZXBBbGl2ZUludGVydmFsOiBmdW5jdGlvbihrZWVwQWxpdmVJbnRlcnZhbCkgewogICAgICB2YXIgdmFsdWU7CiAgICAgIGlmIChTSVAuVXRpbHMuaXNEZWNpbWFsKGtlZXBBbGl2ZUludGVydmFsKSkgewogICAgICAgIHZhbHVlID0gTnVtYmVyKGtlZXBBbGl2ZUludGVydmFsKTsKICAgICAgICBpZiAodmFsdWUgPiAwKSB7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIGV4dHJhU3VwcG9ydGVkOiBmdW5jdGlvbihvcHRpb25UYWdzKSB7CiAgICAgIHZhciBpZHgsIGxlbmd0aDsKCiAgICAgIGlmICghKG9wdGlvblRhZ3MgaW5zdGFuY2VvZiBBcnJheSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGxlbmd0aCA9IG9wdGlvblRhZ3MubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBpZiAodHlwZW9mIG9wdGlvblRhZ3NbaWR4XSAhPT0gJ3N0cmluZycpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBvcHRpb25UYWdzOwogICAgfSwKCiAgICBub0Fuc3dlclRpbWVvdXQ6IGZ1bmN0aW9uKG5vQW5zd2VyVGltZW91dCkgewogICAgICB2YXIgdmFsdWU7CiAgICAgIGlmIChTSVAuVXRpbHMuaXNEZWNpbWFsKG5vQW5zd2VyVGltZW91dCkpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcihub0Fuc3dlclRpbWVvdXQpOwogICAgICAgIGlmICh2YWx1ZSA+IDApIHsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgcGFzc3dvcmQ6IGZ1bmN0aW9uKHBhc3N3b3JkKSB7CiAgICAgIHJldHVybiBTdHJpbmcocGFzc3dvcmQpOwogICAgfSwKCiAgICByZWwxMDA6IGZ1bmN0aW9uKHJlbDEwMCkgewogICAgICBpZihyZWwxMDAgPT09IFNJUC5DLnN1cHBvcnRlZC5SRVFVSVJFRCkgewogICAgICAgIHJldHVybiBTSVAuQy5zdXBwb3J0ZWQuUkVRVUlSRUQ7CiAgICAgIH0gZWxzZSBpZiAocmVsMTAwID09PSBTSVAuQy5zdXBwb3J0ZWQuU1VQUE9SVEVEKSB7CiAgICAgICAgcmV0dXJuIFNJUC5DLnN1cHBvcnRlZC5TVVBQT1JURUQ7CiAgICAgIH0gZWxzZSAgewogICAgICAgIHJldHVybiBTSVAuQy5zdXBwb3J0ZWQuVU5TVVBQT1JURUQ7CiAgICAgIH0KICAgIH0sCgogICAgcmVwbGFjZXM6IGZ1bmN0aW9uKHJlcGxhY2VzKSB7CiAgICAgIGlmKHJlcGxhY2VzID09PSBTSVAuQy5zdXBwb3J0ZWQuUkVRVUlSRUQpIHsKICAgICAgICByZXR1cm4gU0lQLkMuc3VwcG9ydGVkLlJFUVVJUkVEOwogICAgICB9IGVsc2UgaWYgKHJlcGxhY2VzID09PSBTSVAuQy5zdXBwb3J0ZWQuU1VQUE9SVEVEKSB7CiAgICAgICAgcmV0dXJuIFNJUC5DLnN1cHBvcnRlZC5TVVBQT1JURUQ7CiAgICAgIH0gZWxzZSAgewogICAgICAgIHJldHVybiBTSVAuQy5zdXBwb3J0ZWQuVU5TVVBQT1JURUQ7CiAgICAgIH0KICAgIH0sCgogICAgcmVnaXN0ZXI6IGZ1bmN0aW9uKHJlZ2lzdGVyKSB7CiAgICAgIGlmICh0eXBlb2YgcmVnaXN0ZXIgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiByZWdpc3RlcjsKICAgICAgfQogICAgfSwKCiAgICByZWdpc3RlckV4cGlyZXM6IGZ1bmN0aW9uKHJlZ2lzdGVyRXhwaXJlcykgewogICAgICB2YXIgdmFsdWU7CiAgICAgIGlmIChTSVAuVXRpbHMuaXNEZWNpbWFsKHJlZ2lzdGVyRXhwaXJlcykpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcihyZWdpc3RlckV4cGlyZXMpOwogICAgICAgIGlmICh2YWx1ZSA+IDApIHsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgcmVnaXN0cmFyU2VydmVyOiBmdW5jdGlvbihyZWdpc3RyYXJTZXJ2ZXIpIHsKICAgICAgdmFyIHBhcnNlZDsKCiAgICAgIGlmKHR5cGVvZiByZWdpc3RyYXJTZXJ2ZXIgIT09ICdzdHJpbmcnKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIS9ec2lwOi9pLnRlc3QocmVnaXN0cmFyU2VydmVyKSkgewogICAgICAgIHJlZ2lzdHJhclNlcnZlciA9IFNJUC5DLlNJUCArICc6JyArIHJlZ2lzdHJhclNlcnZlcjsKICAgICAgfQogICAgICBwYXJzZWQgPSBTSVAuVVJJLnBhcnNlKHJlZ2lzdHJhclNlcnZlcik7CgogICAgICBpZighcGFyc2VkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYocGFyc2VkLnVzZXIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHBhcnNlZDsKICAgICAgfQogICAgfSwKCiAgICBzdHVuU2VydmVyczogZnVuY3Rpb24oc3R1blNlcnZlcnMpIHsKICAgICAgdmFyIGlkeCwgbGVuZ3RoLCBzdHVuX3NlcnZlcjsKCiAgICAgIGlmICh0eXBlb2Ygc3R1blNlcnZlcnMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgc3R1blNlcnZlcnMgPSBbc3R1blNlcnZlcnNdOwogICAgICB9IGVsc2UgaWYgKCEoc3R1blNlcnZlcnMgaW5zdGFuY2VvZiBBcnJheSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGxlbmd0aCA9IHN0dW5TZXJ2ZXJzLmxlbmd0aDsKICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgc3R1bl9zZXJ2ZXIgPSBzdHVuU2VydmVyc1tpZHhdOwogICAgICAgIGlmICghKC9ec3R1bnM/Oi8udGVzdChzdHVuX3NlcnZlcikpKSB7CiAgICAgICAgICBzdHVuX3NlcnZlciA9ICdzdHVuOicgKyBzdHVuX3NlcnZlcjsKICAgICAgICB9CgogICAgICAgIGlmKFNJUC5HcmFtbWFyLnBhcnNlKHN0dW5fc2VydmVyLCAnc3R1bl9VUkknKSA9PT0gLTEpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3R1blNlcnZlcnNbaWR4XSA9IHN0dW5fc2VydmVyOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gc3R1blNlcnZlcnM7CiAgICB9LAoKICAgIHRyYWNlU2lwOiBmdW5jdGlvbih0cmFjZVNpcCkgewogICAgICBpZiAodHlwZW9mIHRyYWNlU2lwID09PSAnYm9vbGVhbicpIHsKICAgICAgICByZXR1cm4gdHJhY2VTaXA7CiAgICAgIH0KICAgIH0sCgogICAgdHVyblNlcnZlcnM6IGZ1bmN0aW9uKHR1cm5TZXJ2ZXJzKSB7CiAgICAgIHZhciBpZHgsIGpkeCwgbGVuZ3RoLCB0dXJuX3NlcnZlciwgbnVtX3R1cm5fc2VydmVyX3VybHMsIHVybDsKCiAgICAgIGlmICh0dXJuU2VydmVycyBpbnN0YW5jZW9mIEFycmF5KSB7CiAgICAgICAgLy8gRG8gbm90aGluZwogICAgICB9IGVsc2UgewogICAgICAgIHR1cm5TZXJ2ZXJzID0gW3R1cm5TZXJ2ZXJzXTsKICAgICAgfQoKICAgICAgbGVuZ3RoID0gdHVyblNlcnZlcnMubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICB0dXJuX3NlcnZlciA9IHR1cm5TZXJ2ZXJzW2lkeF07CiAgICAgICAgLy9CYWNrd2FyZHMgY29tcGF0aWJpbGl0eTogQWxsb3cgZGVmaW5pbmcgdGhlIHR1cm5fc2VydmVyIHVybCB3aXRoIHRoZSAnc2VydmVyJyBwcm9wZXJ0eS4KICAgICAgICBpZiAodHVybl9zZXJ2ZXIuc2VydmVyKSB7CiAgICAgICAgICB0dXJuX3NlcnZlci51cmxzID0gW3R1cm5fc2VydmVyLnNlcnZlcl07CiAgICAgICAgfQoKICAgICAgICBpZiAoIXR1cm5fc2VydmVyLnVybHMgfHwgIXR1cm5fc2VydmVyLnVzZXJuYW1lIHx8ICF0dXJuX3NlcnZlci5wYXNzd29yZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKHR1cm5fc2VydmVyLnVybHMgaW5zdGFuY2VvZiBBcnJheSkgewogICAgICAgICAgbnVtX3R1cm5fc2VydmVyX3VybHMgPSB0dXJuX3NlcnZlci51cmxzLmxlbmd0aDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdHVybl9zZXJ2ZXIudXJscyA9IFt0dXJuX3NlcnZlci51cmxzXTsKICAgICAgICAgIG51bV90dXJuX3NlcnZlcl91cmxzID0gMTsKICAgICAgICB9CgogICAgICAgIGZvciAoamR4ID0gMDsgamR4IDwgbnVtX3R1cm5fc2VydmVyX3VybHM7IGpkeCsrKSB7CiAgICAgICAgICB1cmwgPSB0dXJuX3NlcnZlci51cmxzW2pkeF07CgogICAgICAgICAgaWYgKCEoL150dXJucz86Ly50ZXN0KHVybCkpKSB7CiAgICAgICAgICAgIHVybCA9ICd0dXJuOicgKyB1cmw7CiAgICAgICAgICB9CgogICAgICAgICAgaWYoU0lQLkdyYW1tYXIucGFyc2UodXJsLCAndHVybl9VUkknKSA9PT0gLTEpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdHVyblNlcnZlcnM7CiAgICB9LAoKICAgIHVzZXJBZ2VudFN0cmluZzogZnVuY3Rpb24odXNlckFnZW50U3RyaW5nKSB7CiAgICAgIGlmICh0eXBlb2YgdXNlckFnZW50U3RyaW5nID09PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybiB1c2VyQWdlbnRTdHJpbmc7CiAgICAgIH0KICAgIH0sCgogICAgdXNlUHJlbG9hZGVkUm91dGU6IGZ1bmN0aW9uKHVzZVByZWxvYWRlZFJvdXRlKSB7CiAgICAgIGlmICh0eXBlb2YgdXNlUHJlbG9hZGVkUm91dGUgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiB1c2VQcmVsb2FkZWRSb3V0ZTsKICAgICAgfQogICAgfSwKCiAgICB3c1NlcnZlck1heFJlY29ubmVjdGlvbjogZnVuY3Rpb24od3NTZXJ2ZXJNYXhSZWNvbm5lY3Rpb24pIHsKICAgICAgdmFyIHZhbHVlOwogICAgICBpZiAoU0lQLlV0aWxzLmlzRGVjaW1hbCh3c1NlcnZlck1heFJlY29ubmVjdGlvbikpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcih3c1NlcnZlck1heFJlY29ubmVjdGlvbik7CiAgICAgICAgaWYgKHZhbHVlID4gMCkgewogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICB3c1NlcnZlclJlY29ubmVjdGlvblRpbWVvdXQ6IGZ1bmN0aW9uKHdzU2VydmVyUmVjb25uZWN0aW9uVGltZW91dCkgewogICAgICB2YXIgdmFsdWU7CiAgICAgIGlmIChTSVAuVXRpbHMuaXNEZWNpbWFsKHdzU2VydmVyUmVjb25uZWN0aW9uVGltZW91dCkpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcih3c1NlcnZlclJlY29ubmVjdGlvblRpbWVvdXQpOwogICAgICAgIGlmICh2YWx1ZSA+IDApIHsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgYXV0b3N0YXJ0OiBmdW5jdGlvbihhdXRvc3RhcnQpIHsKICAgICAgaWYgKHR5cGVvZiBhdXRvc3RhcnQgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiBhdXRvc3RhcnQ7CiAgICAgIH0KICAgIH0sCgogICAgbWVkaWFIYW5kbGVyRmFjdG9yeTogZnVuY3Rpb24obWVkaWFIYW5kbGVyRmFjdG9yeSkgewogICAgICBpZiAobWVkaWFIYW5kbGVyRmFjdG9yeSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgICAgdmFyIHByb21pc2lmaWVkRmFjdG9yeSA9IGZ1bmN0aW9uIHByb21pc2lmaWVkRmFjdG9yeSAoKSB7CiAgICAgICAgICB2YXIgbWVkaWFIYW5kbGVyID0gbWVkaWFIYW5kbGVyRmFjdG9yeS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoKICAgICAgICAgIGZ1bmN0aW9uIHBhdGNoTWV0aG9kIChtZXRob2ROYW1lKSB7CiAgICAgICAgICAgIHZhciBtZXRob2QgPSBtZWRpYUhhbmRsZXJbbWV0aG9kTmFtZV07CiAgICAgICAgICAgIGlmIChtZXRob2QubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgIHZhciBjYWxsYmFja3NGaXJzdCA9IG1ldGhvZE5hbWUgPT09ICdnZXREZXNjcmlwdGlvbic7CiAgICAgICAgICAgICAgbWVkaWFIYW5kbGVyW21ldGhvZE5hbWVdID0gU0lQLlV0aWxzLnByb21pc2lmeShtZWRpYUhhbmRsZXIsIG1ldGhvZE5hbWUsIGNhbGxiYWNrc0ZpcnN0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHBhdGNoTWV0aG9kKCdnZXREZXNjcmlwdGlvbicpOwogICAgICAgICAgcGF0Y2hNZXRob2QoJ3NldERlc2NyaXB0aW9uJyk7CgogICAgICAgICAgcmV0dXJuIG1lZGlhSGFuZGxlcjsKICAgICAgICB9OwoKICAgICAgICBwcm9taXNpZmllZEZhY3RvcnkuaXNTdXBwb3J0ZWQgPSBtZWRpYUhhbmRsZXJGYWN0b3J5LmlzU3VwcG9ydGVkOwogICAgICAgIHJldHVybiBwcm9taXNpZmllZEZhY3Rvcnk7CiAgICAgIH0KICAgIH0sCgogICAgYXV0aGVudGljYXRpb25GYWN0b3J5OiBjaGVja0F1dGhlbnRpY2F0aW9uRmFjdG9yeQogIH0KfTsKClVBLkMgPSBDOwpTSVAuVUEgPSBVQTsKfTsKCn0pLmNhbGwodGhpcyx0eXBlb2YgZ2xvYmFsICE9PSAidW5kZWZpbmVkIiA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSAidW5kZWZpbmVkIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSAidW5kZWZpbmVkIiA/IHdpbmRvdyA6IHt9KQp9LHt9XSwzNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgU0lQIFVSSQogKi8KCi8qKgogKiBAYXVnbWVudHMgU0lQCiAqIEBjbGFzcyBDbGFzcyBjcmVhdGluZyBhIFNJUCBVUkkuCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSBbc2NoZW1lXQogKiBAcGFyYW0ge1N0cmluZ30gW3VzZXJdCiAqIEBwYXJhbSB7U3RyaW5nfSBob3N0CiAqIEBwYXJhbSB7U3RyaW5nfSBbcG9ydF0KICogQHBhcmFtIHtPYmplY3R9IFtwYXJhbWV0ZXJzXQogKiBAcGFyYW0ge09iamVjdH0gW2hlYWRlcnNdCiAqCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyIFVSSTsKClVSSSA9IGZ1bmN0aW9uKHNjaGVtZSwgdXNlciwgaG9zdCwgcG9ydCwgcGFyYW1ldGVycywgaGVhZGVycykgewogIHZhciBwYXJhbSwgaGVhZGVyLCByYXcsIG5vcm1hbDsKCiAgLy8gQ2hlY2tzCiAgaWYoIWhvc3QpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ21pc3Npbmcgb3IgaW52YWxpZCAiaG9zdCIgcGFyYW1ldGVyJyk7CiAgfQoKICAvLyBJbml0aWFsaXplIHBhcmFtZXRlcnMKICBzY2hlbWUgPSBzY2hlbWUgfHwgU0lQLkMuU0lQOwogIHRoaXMucGFyYW1ldGVycyA9IHt9OwogIHRoaXMuaGVhZGVycyA9IHt9OwoKICBmb3IgKHBhcmFtIGluIHBhcmFtZXRlcnMpIHsKICAgIHRoaXMuc2V0UGFyYW0ocGFyYW0sIHBhcmFtZXRlcnNbcGFyYW1dKTsKICB9CgogIGZvciAoaGVhZGVyIGluIGhlYWRlcnMpIHsKICAgIHRoaXMuc2V0SGVhZGVyKGhlYWRlciwgaGVhZGVyc1toZWFkZXJdKTsKICB9CgogIC8vIFJhdyBVUkkKICByYXcgPSB7CiAgICBzY2hlbWU6IHNjaGVtZSwKICAgIHVzZXI6IHVzZXIsCiAgICBob3N0OiBob3N0LAogICAgcG9ydDogcG9ydAogIH07CgogIC8vIE5vcm1hbGl6ZWQgVVJJCiAgbm9ybWFsID0gewogICAgc2NoZW1lOiBzY2hlbWUudG9Mb3dlckNhc2UoKSwKICAgIHVzZXI6IHVzZXIsCiAgICBob3N0OiBob3N0LnRvTG93ZXJDYXNlKCksCiAgICBwb3J0OiBwb3J0CiAgfTsKCiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywgewogICAgX25vcm1hbDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbm9ybWFsOyB9CiAgICB9LAoKICAgIF9yYXc6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIHJhdzsgfQogICAgfSwKCiAgICBzY2hlbWU6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG5vcm1hbC5zY2hlbWU7IH0sCiAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICByYXcuc2NoZW1lID0gdmFsdWU7CiAgICAgICAgbm9ybWFsLnNjaGVtZSA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7CiAgICAgIH0KICAgIH0sCgogICAgdXNlcjogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbm9ybWFsLnVzZXI7IH0sCiAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICBub3JtYWwudXNlciA9IHJhdy51c2VyID0gdmFsdWU7CiAgICAgIH0KICAgIH0sCgogICAgaG9zdDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbm9ybWFsLmhvc3Q7IH0sCiAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICByYXcuaG9zdCA9IHZhbHVlOwogICAgICAgIG5vcm1hbC5ob3N0ID0gdmFsdWUudG9Mb3dlckNhc2UoKTsKICAgICAgfQogICAgfSwKCiAgICBhb3I6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG5vcm1hbC51c2VyICsgJ0AnICsgbm9ybWFsLmhvc3Q7IH0KICAgIH0sCgogICAgcG9ydDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbm9ybWFsLnBvcnQ7IH0sCiAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICBub3JtYWwucG9ydCA9IHJhdy5wb3J0ID0gdmFsdWUgPT09IDAgPyB2YWx1ZSA6IChwYXJzZUludCh2YWx1ZSwxMCkgfHwgbnVsbCk7CiAgICAgIH0KICAgIH0KICB9KTsKfTsKClVSSS5wcm90b3R5cGUgPSB7CiAgc2V0UGFyYW06IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgIGlmKGtleSkgewogICAgICB0aGlzLnBhcmFtZXRlcnNba2V5LnRvTG93ZXJDYXNlKCldID0gKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgfHwgdmFsdWUgPT09IG51bGwpID8gbnVsbCA6IHZhbHVlLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKTsKICAgIH0KICB9LAoKICBnZXRQYXJhbTogZnVuY3Rpb24oa2V5KSB7CiAgICBpZihrZXkpIHsKICAgICAgcmV0dXJuIHRoaXMucGFyYW1ldGVyc1trZXkudG9Mb3dlckNhc2UoKV07CiAgICB9CiAgfSwKCiAgaGFzUGFyYW06IGZ1bmN0aW9uKGtleSkgewogICAgaWYoa2V5KSB7CiAgICAgIHJldHVybiAodGhpcy5wYXJhbWV0ZXJzLmhhc093blByb3BlcnR5KGtleS50b0xvd2VyQ2FzZSgpKSAmJiB0cnVlKSB8fCBmYWxzZTsKICAgIH0KICB9LAoKICBkZWxldGVQYXJhbTogZnVuY3Rpb24ocGFyYW1ldGVyKSB7CiAgICB2YXIgdmFsdWU7CiAgICBwYXJhbWV0ZXIgPSBwYXJhbWV0ZXIudG9Mb3dlckNhc2UoKTsKICAgIGlmICh0aGlzLnBhcmFtZXRlcnMuaGFzT3duUHJvcGVydHkocGFyYW1ldGVyKSkgewogICAgICB2YWx1ZSA9IHRoaXMucGFyYW1ldGVyc1twYXJhbWV0ZXJdOwogICAgICBkZWxldGUgdGhpcy5wYXJhbWV0ZXJzW3BhcmFtZXRlcl07CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICB9LAoKICBjbGVhclBhcmFtczogZnVuY3Rpb24oKSB7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSB7fTsKICB9LAoKICBzZXRIZWFkZXI6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7CiAgICB0aGlzLmhlYWRlcnNbU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKV0gPSAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkgPyB2YWx1ZSA6IFt2YWx1ZV07CiAgfSwKCiAgZ2V0SGVhZGVyOiBmdW5jdGlvbihuYW1lKSB7CiAgICBpZihuYW1lKSB7CiAgICAgIHJldHVybiB0aGlzLmhlYWRlcnNbU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKV07CiAgICB9CiAgfSwKCiAgaGFzSGVhZGVyOiBmdW5jdGlvbihuYW1lKSB7CiAgICBpZihuYW1lKSB7CiAgICAgIHJldHVybiAodGhpcy5oZWFkZXJzLmhhc093blByb3BlcnR5KFNJUC5VdGlscy5oZWFkZXJpemUobmFtZSkpICYmIHRydWUpIHx8IGZhbHNlOwogICAgfQogIH0sCgogIGRlbGV0ZUhlYWRlcjogZnVuY3Rpb24oaGVhZGVyKSB7CiAgICB2YXIgdmFsdWU7CiAgICBoZWFkZXIgPSBTSVAuVXRpbHMuaGVhZGVyaXplKGhlYWRlcik7CiAgICBpZih0aGlzLmhlYWRlcnMuaGFzT3duUHJvcGVydHkoaGVhZGVyKSkgewogICAgICB2YWx1ZSA9IHRoaXMuaGVhZGVyc1toZWFkZXJdOwogICAgICBkZWxldGUgdGhpcy5oZWFkZXJzW2hlYWRlcl07CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICB9LAoKICBjbGVhckhlYWRlcnM6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5oZWFkZXJzID0ge307CiAgfSwKCiAgY2xvbmU6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIG5ldyBVUkkoCiAgICAgIHRoaXMuX3Jhdy5zY2hlbWUsCiAgICAgIHRoaXMuX3Jhdy51c2VyLAogICAgICB0aGlzLl9yYXcuaG9zdCwKICAgICAgdGhpcy5fcmF3LnBvcnQsCiAgICAgIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5wYXJhbWV0ZXJzKSksCiAgICAgIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5oZWFkZXJzKSkpOwogIH0sCgogIHRvUmF3OiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0aGlzLl90b1N0cmluZyh0aGlzLl9yYXcpOwogIH0sCgogIHRvU3RyaW5nOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0aGlzLl90b1N0cmluZyh0aGlzLl9ub3JtYWwpOwogIH0sCgogIF90b1N0cmluZzogZnVuY3Rpb24odXJpKSB7CiAgICB2YXIgaGVhZGVyLCBwYXJhbWV0ZXIsIGlkeCwgdXJpU3RyaW5nLCBoZWFkZXJzID0gW107CgogICAgdXJpU3RyaW5nICA9IHVyaS5zY2hlbWUgKyAnOic7CiAgICAvLyBhZGQgc2xhc2hlcyBpZiBpdCdzIG5vdCBhIHNpcChzKSBVUkkKICAgIGlmICghdXJpLnNjaGVtZS50b0xvd2VyQ2FzZSgpLm1hdGNoKCJec2lwcz8kIikpIHsKICAgICAgdXJpU3RyaW5nICs9ICIvLyI7CiAgICB9CiAgICBpZiAodXJpLnVzZXIpIHsKICAgICAgdXJpU3RyaW5nICs9IFNJUC5VdGlscy5lc2NhcGVVc2VyKHVyaS51c2VyKSArICdAJzsKICAgIH0KICAgIHVyaVN0cmluZyArPSB1cmkuaG9zdDsKICAgIGlmICh1cmkucG9ydCB8fCB1cmkucG9ydCA9PT0gMCkgewogICAgICB1cmlTdHJpbmcgKz0gJzonICsgdXJpLnBvcnQ7CiAgICB9CgogICAgZm9yIChwYXJhbWV0ZXIgaW4gdGhpcy5wYXJhbWV0ZXJzKSB7CiAgICAgIHVyaVN0cmluZyArPSAnOycgKyBwYXJhbWV0ZXI7CgogICAgICBpZiAodGhpcy5wYXJhbWV0ZXJzW3BhcmFtZXRlcl0gIT09IG51bGwpIHsKICAgICAgICB1cmlTdHJpbmcgKz0gJz0nKyB0aGlzLnBhcmFtZXRlcnNbcGFyYW1ldGVyXTsKICAgICAgfQogICAgfQoKICAgIGZvcihoZWFkZXIgaW4gdGhpcy5oZWFkZXJzKSB7CiAgICAgIGZvcihpZHggaW4gdGhpcy5oZWFkZXJzW2hlYWRlcl0pIHsKICAgICAgICBoZWFkZXJzLnB1c2goaGVhZGVyICsgJz0nICsgdGhpcy5oZWFkZXJzW2hlYWRlcl1baWR4XSk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoaGVhZGVycy5sZW5ndGggPiAwKSB7CiAgICAgIHVyaVN0cmluZyArPSAnPycgKyBoZWFkZXJzLmpvaW4oJyYnKTsKICAgIH0KCiAgICByZXR1cm4gdXJpU3RyaW5nOwogIH0KfTsKCgovKioKICAqIFBhcnNlIHRoZSBnaXZlbiBzdHJpbmcgYW5kIHJldHVybnMgYSBTSVAuVVJJIGluc3RhbmNlIG9yIHVuZGVmaW5lZCBpZgogICogaXQgaXMgYW4gaW52YWxpZCBVUkkuCiAgKiBAcHVibGljCiAgKiBAcGFyYW0ge1N0cmluZ30gdXJpCiAgKi8KVVJJLnBhcnNlID0gZnVuY3Rpb24odXJpKSB7CiAgdXJpID0gU0lQLkdyYW1tYXIucGFyc2UodXJpLCdTSVBfVVJJJyk7CgogIGlmICh1cmkgIT09IC0xKSB7CiAgICByZXR1cm4gdXJpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KfTsKClNJUC5VUkkgPSBVUkk7Cn07Cgp9LHt9XSwzODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgVXRpbHMKICovCgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVAsIGVudmlyb25tZW50KSB7CnZhciBVdGlsczsKClV0aWxzPSB7CgogIFByb21pc2U6IGVudmlyb25tZW50LlByb21pc2UsCgogIGRlZmVyOiBmdW5jdGlvbiBkZWZlciAoKSB7CiAgICB2YXIgZGVmZXJyZWQgPSB7fTsKICAgIGRlZmVycmVkLnByb21pc2UgPSBuZXcgVXRpbHMuUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGRlZmVycmVkLnJlc29sdmUgPSByZXNvbHZlOwogICAgICBkZWZlcnJlZC5yZWplY3QgPSByZWplY3Q7CiAgICB9KTsKICAgIHJldHVybiBkZWZlcnJlZDsKICB9LAoKICBwcm9taXNpZnk6IGZ1bmN0aW9uIHByb21pc2lmeSAob2JqZWN0LCBtZXRob2ROYW1lLCBjYWxsYmFja3NGaXJzdCkgewogICAgdmFyIG9sZE1ldGhvZCA9IG9iamVjdFttZXRob2ROYW1lXTsKICAgIHJldHVybiBmdW5jdGlvbiBwcm9taXNpZmllZE1ldGhvZCAoYXJnLCBvblN1Y2Nlc3MsIG9uRmFpbHVyZSkgewogICAgICByZXR1cm4gbmV3IFV0aWxzLlByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciBvbGRBcmdzID0gW2FyZywgcmVzb2x2ZSwgcmVqZWN0XTsKICAgICAgICBpZiAoY2FsbGJhY2tzRmlyc3QpIHsKICAgICAgICAgIG9sZEFyZ3MgPSBbcmVzb2x2ZSwgcmVqZWN0LCBhcmddOwogICAgICAgIH0KICAgICAgICBvbGRNZXRob2QuYXBwbHkob2JqZWN0LCBvbGRBcmdzKTsKICAgICAgfSkudGhlbihvblN1Y2Nlc3MsIG9uRmFpbHVyZSk7CiAgICB9OwogIH0sCgogIGF1Z21lbnQ6IGZ1bmN0aW9uIChvYmplY3QsIGNvbnN0cnVjdG9yLCBhcmdzLCBvdmVycmlkZSkgewogICAgdmFyIGlkeCwgcHJvdG87CgogICAgLy8gQWRkIHB1YmxpYyBwcm9wZXJ0aWVzIGZyb20gY29uc3RydWN0b3IncyBwcm90b3R5cGUgb250byBvYmplY3QKICAgIHByb3RvID0gY29uc3RydWN0b3IucHJvdG90eXBlOwogICAgZm9yIChpZHggaW4gcHJvdG8pIHsKICAgICAgaWYgKG92ZXJyaWRlIHx8IG9iamVjdFtpZHhdID09PSB1bmRlZmluZWQpIHsKICAgICAgICBvYmplY3RbaWR4XSA9IHByb3RvW2lkeF07CiAgICAgIH0KICAgIH0KCiAgICAvLyBDb25zdHJ1Y3QgdGhlIG9iamVjdCBhcyB0aG91Z2ggaXQgd2VyZSBqdXN0IGNyZWF0ZWQgYnkgY29uc3RydWN0b3IKICAgIGNvbnN0cnVjdG9yLmFwcGx5KG9iamVjdCwgYXJncyk7CiAgfSwKCiAgb3B0aW9uc092ZXJyaWRlOiBmdW5jdGlvbiAob3B0aW9ucywgd2lubmVyLCBsb3NlciwgaXNEZXByZWNhdGVkLCBsb2dnZXIsIGRlZmF1bHRWYWx1ZSkgewogICAgaWYgKGlzRGVwcmVjYXRlZCAmJiBvcHRpb25zW2xvc2VyXSkgewogICAgICBsb2dnZXIud2Fybihsb3NlciArICcgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHVzZSAnICsgd2lubmVyICsgJyBpbnN0ZWFkJyk7CiAgICB9CgogICAgaWYgKG9wdGlvbnNbd2lubmVyXSAmJiBvcHRpb25zW2xvc2VyXSkgewogICAgICBsb2dnZXIud2Fybih3aW5uZXIgKyAnIG92ZXJyaWRpbmcgJyArIGxvc2VyKTsKICAgIH0KCiAgICBvcHRpb25zW3dpbm5lcl0gPSBvcHRpb25zW3dpbm5lcl0gfHwgb3B0aW9uc1tsb3Nlcl0gfHwgZGVmYXVsdFZhbHVlOwogIH0sCgogIHN0cl91dGY4X2xlbmd0aDogZnVuY3Rpb24oc3RyaW5nKSB7CiAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZykucmVwbGFjZSgvJVtBLUZcZF17Mn0vZywgJ1UnKS5sZW5ndGg7CiAgfSwKCiAgZ2VuZXJhdGVGYWtlU0RQOiBmdW5jdGlvbihib2R5KSB7CiAgICBpZiAoIWJvZHkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBzdGFydCA9IGJvZHkuaW5kZXhPZignbz0nKTsKICAgIHZhciBlbmQgPSBib2R5LmluZGV4T2YoJ1xyXG4nLCBzdGFydCk7CgogICAgcmV0dXJuICd2PTBcclxuJyArIGJvZHkuc2xpY2Uoc3RhcnQsIGVuZCkgKyAnXHJcbnM9LVxyXG50PTAgMFxyXG5jPUlOIElQNCAwLjAuMC4wJzsKICB9LAoKICBpc0Z1bmN0aW9uOiBmdW5jdGlvbihmbikgewogICAgaWYgKGZuICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChmbikgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwKCiAgaXNEZWNpbWFsOiBmdW5jdGlvbiAobnVtKSB7CiAgICByZXR1cm4gIWlzTmFOKG51bSkgJiYgKHBhcnNlRmxvYXQobnVtKSA9PT0gcGFyc2VJbnQobnVtLDEwKSk7CiAgfSwKCiAgY3JlYXRlUmFuZG9tVG9rZW46IGZ1bmN0aW9uKHNpemUsIGJhc2UpIHsKICAgIHZhciBpLCByLAogICAgICB0b2tlbiA9ICcnOwoKICAgIGJhc2UgPSBiYXNlIHx8IDMyOwoKICAgIGZvciggaT0wOyBpIDwgc2l6ZTsgaSsrICkgewogICAgICByID0gTWF0aC5yYW5kb20oKSAqIGJhc2V8MDsKICAgICAgdG9rZW4gKz0gci50b1N0cmluZyhiYXNlKTsKICAgIH0KCiAgICByZXR1cm4gdG9rZW47CiAgfSwKCiAgbmV3VGFnOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiBTSVAuVXRpbHMuY3JlYXRlUmFuZG9tVG9rZW4oU0lQLlVBLkMuVEFHX0xFTkdUSCk7CiAgfSwKCiAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3VzZXJzLzEwOTUzOC9icm9vZmEKICBuZXdVVUlEOiBmdW5jdGlvbigpIHsKICAgIHZhciBVVUlEID0gICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24oYykgewogICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkqMTZ8MCwgdiA9IGMgPT09ICd4JyA/IHIgOiAociYweDN8MHg4KTsKICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpOwogICAgfSk7CgogICAgcmV0dXJuIFVVSUQ7CiAgfSwKCiAgaG9zdFR5cGU6IGZ1bmN0aW9uKGhvc3QpIHsKICAgIGlmICghaG9zdCkgewogICAgICByZXR1cm47CiAgICB9IGVsc2UgewogICAgICBob3N0ID0gU0lQLkdyYW1tYXIucGFyc2UoaG9zdCwnaG9zdCcpOwogICAgICBpZiAoaG9zdCAhPT0gLTEpIHsKICAgICAgICByZXR1cm4gaG9zdC5ob3N0X3R5cGU7CiAgICAgIH0KICAgIH0KICB9LAoKICAvKioKICAqIE5vcm1hbGl6ZSBTSVAgVVJJLgogICogTk9URTogSXQgZG9lcyBub3QgYWxsb3cgYSBTSVAgVVJJIHdpdGhvdXQgdXNlcm5hbWUuCiAgKiBBY2NlcHRzICdzaXAnLCAnc2lwcycgYW5kICd0ZWwnIFVSSXMgYW5kIGNvbnZlcnQgdGhlbSBpbnRvICdzaXAnLgogICogRGV0ZWN0cyB0aGUgZG9tYWluIHBhcnQgKGlmIGdpdmVuKSBhbmQgcHJvcGVybHkgaGV4LWVzY2FwZXMgdGhlIHVzZXIgcG9ydGlvbi4KICAqIElmIHRoZSB1c2VyIHBvcnRpb24gaGFzIG9ubHkgJ3RlbCcgbnVtYmVyIHN5bWJvbHMgdGhlIHVzZXIgcG9ydGlvbiBpcyBjbGVhbiBvZiAndGVsJyB2aXN1YWwgc2VwYXJhdG9ycy4KICAqIEBwcml2YXRlCiAgKiBAcGFyYW0ge1N0cmluZ30gdGFyZ2V0CiAgKiBAcGFyYW0ge1N0cmluZ30gW2RvbWFpbl0KICAqLwogIG5vcm1hbGl6ZVRhcmdldDogZnVuY3Rpb24odGFyZ2V0LCBkb21haW4pIHsKICAgIHZhciB1cmksIHRhcmdldF9hcnJheSwgdGFyZ2V0X3VzZXIsIHRhcmdldF9kb21haW47CgogICAgLy8gSWYgbm8gdGFyZ2V0IGlzIGdpdmVuIHRoZW4gcmFpc2UgYW4gZXJyb3IuCiAgICBpZiAoIXRhcmdldCkgewogICAgICByZXR1cm47CiAgICAvLyBJZiBhIFNJUC5VUkkgaW5zdGFuY2UgaXMgZ2l2ZW4gdGhlbiByZXR1cm4gaXQuCiAgICB9IGVsc2UgaWYgKHRhcmdldCBpbnN0YW5jZW9mIFNJUC5VUkkpIHsKICAgICAgcmV0dXJuIHRhcmdldDsKCiAgICAvLyBJZiBhIHN0cmluZyBpcyBnaXZlbiBzcGxpdCBpdCBieSAnQCc6CiAgICAvLyAtIExhc3QgZnJhZ21lbnQgaXMgdGhlIGRlc2lyZWQgZG9tYWluLgogICAgLy8gLSBPdGhlcndpc2UgYXBwZW5kIHRoZSBnaXZlbiBkb21haW4gYXJndW1lbnQuCiAgICB9IGVsc2UgaWYgKHR5cGVvZiB0YXJnZXQgPT09ICdzdHJpbmcnKSB7CiAgICAgIHRhcmdldF9hcnJheSA9IHRhcmdldC5zcGxpdCgnQCcpOwoKICAgICAgc3dpdGNoKHRhcmdldF9hcnJheS5sZW5ndGgpIHsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBpZiAoIWRvbWFpbikgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICB0YXJnZXRfdXNlciA9IHRhcmdldDsKICAgICAgICAgIHRhcmdldF9kb21haW4gPSBkb21haW47CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICB0YXJnZXRfdXNlciA9IHRhcmdldF9hcnJheVswXTsKICAgICAgICAgIHRhcmdldF9kb21haW4gPSB0YXJnZXRfYXJyYXlbMV07CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGFyZ2V0X3VzZXIgPSB0YXJnZXRfYXJyYXkuc2xpY2UoMCwgdGFyZ2V0X2FycmF5Lmxlbmd0aC0xKS5qb2luKCdAJyk7CiAgICAgICAgICB0YXJnZXRfZG9tYWluID0gdGFyZ2V0X2FycmF5W3RhcmdldF9hcnJheS5sZW5ndGgtMV07CiAgICAgIH0KCiAgICAgIC8vIFJlbW92ZSB0aGUgVVJJIHNjaGVtZSAoaWYgcHJlc2VudCkuCiAgICAgIHRhcmdldF91c2VyID0gdGFyZ2V0X3VzZXIucmVwbGFjZSgvXihzaXBzP3x0ZWwpOi9pLCAnJyk7CgogICAgICAvLyBSZW1vdmUgJ3RlbCcgdmlzdWFsIHNlcGFyYXRvcnMgaWYgdGhlIHVzZXIgcG9ydGlvbiBqdXN0IGNvbnRhaW5zICd0ZWwnIG51bWJlciBzeW1ib2xzLgogICAgICBpZiAoL15bXC1cLlwoXCldKlwrP1swLTlcLVwuXChcKV0rJC8udGVzdCh0YXJnZXRfdXNlcikpIHsKICAgICAgICB0YXJnZXRfdXNlciA9IHRhcmdldF91c2VyLnJlcGxhY2UoL1tcLVwuXChcKV0vZywgJycpOwogICAgICB9CgogICAgICAvLyBCdWlsZCB0aGUgY29tcGxldGUgU0lQIFVSSS4KICAgICAgdGFyZ2V0ID0gU0lQLkMuU0lQICsgJzonICsgU0lQLlV0aWxzLmVzY2FwZVVzZXIodGFyZ2V0X3VzZXIpICsgJ0AnICsgdGFyZ2V0X2RvbWFpbjsKCiAgICAgIC8vIEZpbmFsbHkgcGFyc2UgdGhlIHJlc3VsdGluZyBVUkkuCiAgICAgIGlmICh1cmkgPSBTSVAuVVJJLnBhcnNlKHRhcmdldCkpIHsKICAgICAgICByZXR1cm4gdXJpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuOwogICAgfQogIH0sCgogIC8qKgogICogSGV4LWVzY2FwZSBhIFNJUCBVUkkgdXNlci4KICAqIEBwcml2YXRlCiAgKiBAcGFyYW0ge1N0cmluZ30gdXNlcgogICovCiAgZXNjYXBlVXNlcjogZnVuY3Rpb24odXNlcikgewogICAgLy8gRG9uJ3QgaGV4LWVzY2FwZSAnOicgKCUzQSksICcrJyAoJTJCKSwgJz8nICglM0YiKSwgJy8nICglMkYpLgogICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChkZWNvZGVVUklDb21wb25lbnQodXNlcikpLnJlcGxhY2UoLyUzQS9pZywgJzonKS5yZXBsYWNlKC8lMkIvaWcsICcrJykucmVwbGFjZSgvJTNGL2lnLCAnPycpLnJlcGxhY2UoLyUyRi9pZywgJy8nKTsKICB9LAoKICBoZWFkZXJpemU6IGZ1bmN0aW9uKHN0cmluZykgewogICAgdmFyIGV4Y2VwdGlvbnMgPSB7CiAgICAgICdDYWxsLUlkJzogJ0NhbGwtSUQnLAogICAgICAnQ3NlcSc6ICdDU2VxJywKICAgICAgJ01pbi1TZSc6ICdNaW4tU0UnLAogICAgICAnUmFjayc6ICdSQWNrJywKICAgICAgJ1JzZXEnOiAnUlNlcScsCiAgICAgICdXd3ctQXV0aGVudGljYXRlJzogJ1dXVy1BdXRoZW50aWNhdGUnCiAgICAgIH0sCiAgICAgIG5hbWUgPSBzdHJpbmcudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9fL2csJy0nKS5zcGxpdCgnLScpLAogICAgICBobmFtZSA9ICcnLAogICAgICBwYXJ0cyA9IG5hbWUubGVuZ3RoLCBwYXJ0OwoKICAgIGZvciAocGFydCA9IDA7IHBhcnQgPCBwYXJ0czsgcGFydCsrKSB7CiAgICAgIGlmIChwYXJ0ICE9PSAwKSB7CiAgICAgICAgaG5hbWUgKz0nLSc7CiAgICAgIH0KICAgICAgaG5hbWUgKz0gbmFtZVtwYXJ0XS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStuYW1lW3BhcnRdLnN1YnN0cmluZygxKTsKICAgIH0KICAgIGlmIChleGNlcHRpb25zW2huYW1lXSkgewogICAgICBobmFtZSA9IGV4Y2VwdGlvbnNbaG5hbWVdOwogICAgfQogICAgcmV0dXJuIGhuYW1lOwogIH0sCgogIHNpcEVycm9yQ2F1c2U6IGZ1bmN0aW9uKHN0YXR1c19jb2RlKSB7CiAgICB2YXIgY2F1c2U7CgogICAgZm9yIChjYXVzZSBpbiBTSVAuQy5TSVBfRVJST1JfQ0FVU0VTKSB7CiAgICAgIGlmIChTSVAuQy5TSVBfRVJST1JfQ0FVU0VTW2NhdXNlXS5pbmRleE9mKHN0YXR1c19jb2RlKSAhPT0gLTEpIHsKICAgICAgICByZXR1cm4gU0lQLkMuY2F1c2VzW2NhdXNlXTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBTSVAuQy5jYXVzZXMuU0lQX0ZBSUxVUkVfQ09ERTsKICB9LAoKICBnZXRSZWFzb25QaHJhc2U6IGZ1bmN0aW9uIGdldFJlYXNvblBocmFzZSAoY29kZSwgc3BlY2lmaWMpIHsKICAgIHJldHVybiBzcGVjaWZpYyB8fCBTSVAuQy5SRUFTT05fUEhSQVNFW2NvZGVdIHx8ICcnOwogIH0sCgogIGdldFJlYXNvbkhlYWRlclZhbHVlOiBmdW5jdGlvbiBnZXRSZWFzb25IZWFkZXJWYWx1ZSAoY29kZSwgcmVhc29uKSB7CiAgICByZWFzb24gPSBTSVAuVXRpbHMuZ2V0UmVhc29uUGhyYXNlKGNvZGUsIHJlYXNvbik7CiAgICByZXR1cm4gJ1NJUCA7Y2F1c2U9JyArIGNvZGUgKyAnIDt0ZXh0PSInICsgcmVhc29uICsgJyInOwogIH0sCgogIGdldENhbmNlbFJlYXNvbjogZnVuY3Rpb24gZ2V0Q2FuY2VsUmVhc29uIChjb2RlLCByZWFzb24pIHsKICAgIGlmIChjb2RlICYmIGNvZGUgPCAyMDAgfHwgY29kZSA+IDY5OSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHN0YXR1c19jb2RlOiAnICsgY29kZSk7CiAgICB9IGVsc2UgaWYgKGNvZGUpIHsKICAgICAgcmV0dXJuIFNJUC5VdGlscy5nZXRSZWFzb25IZWFkZXJWYWx1ZShjb2RlLCByZWFzb24pOwogICAgfQogIH0sCgogIGJ1aWxkU3RhdHVzTGluZTogZnVuY3Rpb24gYnVpbGRTdGF0dXNMaW5lIChjb2RlLCByZWFzb24pIHsKICAgIGNvZGUgPSBjb2RlIHx8IG51bGw7CiAgICByZWFzb24gPSByZWFzb24gfHwgbnVsbDsKCiAgICAvLyBWYWxpZGF0ZSBjb2RlIGFuZCByZWFzb24gdmFsdWVzCiAgICBpZiAoIWNvZGUgfHwgKGNvZGUgPCAxMDAgfHwgY29kZSA+IDY5OSkpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdGF0dXNfY29kZTogJysgY29kZSk7CiAgICB9IGVsc2UgaWYgKHJlYXNvbiAmJiB0eXBlb2YgcmVhc29uICE9PSAnc3RyaW5nJyAmJiAhKHJlYXNvbiBpbnN0YW5jZW9mIFN0cmluZykpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCByZWFzb25fcGhyYXNlOiAnKyByZWFzb24pOwogICAgfQoKICAgIHJlYXNvbiA9IFV0aWxzLmdldFJlYXNvblBocmFzZShjb2RlLCByZWFzb24pOwoKICAgIHJldHVybiAnU0lQLzIuMCAnICsgY29kZSArICcgJyArIHJlYXNvbiArICdcclxuJzsKICB9LAoKICAvKioKICAqIEdlbmVyYXRlIGEgcmFuZG9tIFRlc3QtTmV0IElQIChodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM1NzM1KQogICogQHByaXZhdGUKICAqLwogIGdldFJhbmRvbVRlc3ROZXRJUDogZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBnZXRPY3RldChmcm9tLHRvKSB7CiAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKHRvLWZyb20rMSkrZnJvbSk7CiAgICB9CiAgICByZXR1cm4gJzE5Mi4wLjIuJyArIGdldE9jdGV0KDEsIDI1NCk7CiAgfSwKCiAgLy8gTUQ1IChNZXNzYWdlLURpZ2VzdCBBbGdvcml0aG0pIGh0dHA6Ly93d3cud2VidG9vbGtpdC5pbmZvCiAgY2FsY3VsYXRlTUQ1OiBmdW5jdGlvbihzdHJpbmcpIHsKICAgIGZ1bmN0aW9uIFJvdGF0ZUxlZnQobFZhbHVlLCBpU2hpZnRCaXRzKSB7CiAgICAgIHJldHVybiAobFZhbHVlPDxpU2hpZnRCaXRzKSB8IChsVmFsdWU+Pj4oMzItaVNoaWZ0Qml0cykpOwogICAgfQoKICAgIGZ1bmN0aW9uIEFkZFVuc2lnbmVkKGxYLGxZKSB7CiAgICAgIHZhciBsWDQsbFk0LGxYOCxsWTgsbFJlc3VsdDsKICAgICAgbFg4ID0gKGxYICYgMHg4MDAwMDAwMCk7CiAgICAgIGxZOCA9IChsWSAmIDB4ODAwMDAwMDApOwogICAgICBsWDQgPSAobFggJiAweDQwMDAwMDAwKTsKICAgICAgbFk0ID0gKGxZICYgMHg0MDAwMDAwMCk7CiAgICAgIGxSZXN1bHQgPSAobFggJiAweDNGRkZGRkZGKSsobFkgJiAweDNGRkZGRkZGKTsKICAgICAgaWYgKGxYNCAmIGxZNCkgewogICAgICAgIHJldHVybiAobFJlc3VsdCBeIDB4ODAwMDAwMDAgXiBsWDggXiBsWTgpOwogICAgICB9CiAgICAgIGlmIChsWDQgfCBsWTQpIHsKICAgICAgICBpZiAobFJlc3VsdCAmIDB4NDAwMDAwMDApIHsKICAgICAgICAgIHJldHVybiAobFJlc3VsdCBeIDB4QzAwMDAwMDAgXiBsWDggXiBsWTgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gKGxSZXN1bHQgXiAweDQwMDAwMDAwIF4gbFg4IF4gbFk4KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIChsUmVzdWx0IF4gbFg4IF4gbFk4KTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIEYoeCx5LHopIHsKICAgICAgcmV0dXJuICh4ICYgeSkgfCAoKH54KSAmIHopOwogICAgfQoKICAgIGZ1bmN0aW9uIEcoeCx5LHopIHsKICAgICAgcmV0dXJuICh4ICYgeikgfCAoeSAmICh+eikpOwogICAgfQoKICAgIGZ1bmN0aW9uIEgoeCx5LHopIHsKICAgICAgcmV0dXJuICh4IF4geSBeIHopOwogICAgfQoKICAgIGZ1bmN0aW9uIEkoeCx5LHopIHsKICAgICAgcmV0dXJuICh5IF4gKHggfCAofnopKSk7CiAgICB9CgogICAgZnVuY3Rpb24gRkYoYSxiLGMsZCx4LHMsYWMpIHsKICAgICAgYSA9IEFkZFVuc2lnbmVkKGEsIEFkZFVuc2lnbmVkKEFkZFVuc2lnbmVkKEYoYiwgYywgZCksIHgpLCBhYykpOwogICAgICByZXR1cm4gQWRkVW5zaWduZWQoUm90YXRlTGVmdChhLCBzKSwgYik7CiAgICB9CgogICAgZnVuY3Rpb24gR0coYSxiLGMsZCx4LHMsYWMpIHsKICAgICAgYSA9IEFkZFVuc2lnbmVkKGEsIEFkZFVuc2lnbmVkKEFkZFVuc2lnbmVkKEcoYiwgYywgZCksIHgpLCBhYykpOwogICAgICByZXR1cm4gQWRkVW5zaWduZWQoUm90YXRlTGVmdChhLCBzKSwgYik7CiAgICB9CgogICAgZnVuY3Rpb24gSEgoYSxiLGMsZCx4LHMsYWMpIHsKICAgICAgYSA9IEFkZFVuc2lnbmVkKGEsIEFkZFVuc2lnbmVkKEFkZFVuc2lnbmVkKEgoYiwgYywgZCksIHgpLCBhYykpOwogICAgICByZXR1cm4gQWRkVW5zaWduZWQoUm90YXRlTGVmdChhLCBzKSwgYik7CiAgICB9CgogICAgZnVuY3Rpb24gSUkoYSxiLGMsZCx4LHMsYWMpIHsKICAgICAgYSA9IEFkZFVuc2lnbmVkKGEsIEFkZFVuc2lnbmVkKEFkZFVuc2lnbmVkKEkoYiwgYywgZCksIHgpLCBhYykpOwogICAgICByZXR1cm4gQWRkVW5zaWduZWQoUm90YXRlTGVmdChhLCBzKSwgYik7CiAgICB9CgogICAgZnVuY3Rpb24gQ29udmVydFRvV29yZEFycmF5KHN0cmluZykgewogICAgICB2YXIgbFdvcmRDb3VudDsKICAgICAgdmFyIGxNZXNzYWdlTGVuZ3RoID0gc3RyaW5nLmxlbmd0aDsKICAgICAgdmFyIGxOdW1iZXJPZldvcmRzX3RlbXAxPWxNZXNzYWdlTGVuZ3RoICsgODsKICAgICAgdmFyIGxOdW1iZXJPZldvcmRzX3RlbXAyPShsTnVtYmVyT2ZXb3Jkc190ZW1wMS0obE51bWJlck9mV29yZHNfdGVtcDEgJSA2NCkpLzY0OwogICAgICB2YXIgbE51bWJlck9mV29yZHMgPSAobE51bWJlck9mV29yZHNfdGVtcDIrMSkqMTY7CiAgICAgIHZhciBsV29yZEFycmF5PUFycmF5KGxOdW1iZXJPZldvcmRzLTEpOwogICAgICB2YXIgbEJ5dGVQb3NpdGlvbiA9IDA7CiAgICAgIHZhciBsQnl0ZUNvdW50ID0gMDsKICAgICAgd2hpbGUgKCBsQnl0ZUNvdW50IDwgbE1lc3NhZ2VMZW5ndGggKSB7CiAgICAgICAgbFdvcmRDb3VudCA9IChsQnl0ZUNvdW50LShsQnl0ZUNvdW50ICUgNCkpLzQ7CiAgICAgICAgbEJ5dGVQb3NpdGlvbiA9IChsQnl0ZUNvdW50ICUgNCkqODsKICAgICAgICBsV29yZEFycmF5W2xXb3JkQ291bnRdID0gKGxXb3JkQXJyYXlbbFdvcmRDb3VudF0gfCAoc3RyaW5nLmNoYXJDb2RlQXQobEJ5dGVDb3VudCk8PGxCeXRlUG9zaXRpb24pKTsKICAgICAgICBsQnl0ZUNvdW50Kys7CiAgICAgIH0KICAgICAgbFdvcmRDb3VudCA9IChsQnl0ZUNvdW50LShsQnl0ZUNvdW50ICUgNCkpLzQ7CiAgICAgIGxCeXRlUG9zaXRpb24gPSAobEJ5dGVDb3VudCAlIDQpKjg7CiAgICAgIGxXb3JkQXJyYXlbbFdvcmRDb3VudF0gPSBsV29yZEFycmF5W2xXb3JkQ291bnRdIHwgKDB4ODA8PGxCeXRlUG9zaXRpb24pOwogICAgICBsV29yZEFycmF5W2xOdW1iZXJPZldvcmRzLTJdID0gbE1lc3NhZ2VMZW5ndGg8PDM7CiAgICAgIGxXb3JkQXJyYXlbbE51bWJlck9mV29yZHMtMV0gPSBsTWVzc2FnZUxlbmd0aD4+PjI5OwogICAgICByZXR1cm4gbFdvcmRBcnJheTsKICAgIH0KCiAgICBmdW5jdGlvbiBXb3JkVG9IZXgobFZhbHVlKSB7CiAgICAgIHZhciBXb3JkVG9IZXhWYWx1ZT0iIixXb3JkVG9IZXhWYWx1ZV90ZW1wPSIiLGxCeXRlLGxDb3VudDsKICAgICAgZm9yIChsQ291bnQgPSAwO2xDb3VudDw9MztsQ291bnQrKykgewogICAgICAgIGxCeXRlID0gKGxWYWx1ZT4+PihsQ291bnQqOCkpICYgMjU1OwogICAgICAgIFdvcmRUb0hleFZhbHVlX3RlbXAgPSAiMCIgKyBsQnl0ZS50b1N0cmluZygxNik7CiAgICAgICAgV29yZFRvSGV4VmFsdWUgPSBXb3JkVG9IZXhWYWx1ZSArIFdvcmRUb0hleFZhbHVlX3RlbXAuc3Vic3RyKFdvcmRUb0hleFZhbHVlX3RlbXAubGVuZ3RoLTIsMik7CiAgICAgIH0KICAgICAgcmV0dXJuIFdvcmRUb0hleFZhbHVlOwogICAgfQoKICAgIGZ1bmN0aW9uIFV0ZjhFbmNvZGUoc3RyaW5nKSB7CiAgICAgIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9cclxuL2csIlxuIik7CiAgICAgIHZhciB1dGZ0ZXh0ID0gIiI7CgogICAgICBmb3IgKHZhciBuID0gMDsgbiA8IHN0cmluZy5sZW5ndGg7IG4rKykgewogICAgICAgIHZhciBjID0gc3RyaW5nLmNoYXJDb2RlQXQobik7CgogICAgICAgIGlmIChjIDwgMTI4KSB7CiAgICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYyk7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYoKGMgPiAxMjcpICYmIChjIDwgMjA0OCkpIHsKICAgICAgICAgIHV0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYyA+PiA2KSB8IDE5Mik7CiAgICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgIHV0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYyA+PiAxMikgfCAyMjQpOwogICAgICAgICAgdXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYyA+PiA2KSAmIDYzKSB8IDEyOCk7CiAgICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdXRmdGV4dDsKICAgIH0KCiAgICB2YXIgeD1bXTsKICAgIHZhciBrLEFBLEJCLENDLERELGEsYixjLGQ7CiAgICB2YXIgUzExPTcsIFMxMj0xMiwgUzEzPTE3LCBTMTQ9MjI7CiAgICB2YXIgUzIxPTUsIFMyMj05ICwgUzIzPTE0LCBTMjQ9MjA7CiAgICB2YXIgUzMxPTQsIFMzMj0xMSwgUzMzPTE2LCBTMzQ9MjM7CiAgICB2YXIgUzQxPTYsIFM0Mj0xMCwgUzQzPTE1LCBTNDQ9MjE7CgogICAgc3RyaW5nID0gVXRmOEVuY29kZShzdHJpbmcpOwoKICAgIHggPSBDb252ZXJ0VG9Xb3JkQXJyYXkoc3RyaW5nKTsKCiAgICBhID0gMHg2NzQ1MjMwMTsgYiA9IDB4RUZDREFCODk7IGMgPSAweDk4QkFEQ0ZFOyBkID0gMHgxMDMyNTQ3NjsKCiAgICBmb3IgKGs9MDtrPHgubGVuZ3RoO2srPTE2KSB7CiAgICAgIEFBPWE7IEJCPWI7IENDPWM7IEREPWQ7CiAgICAgIGE9RkYoYSxiLGMsZCx4W2srMF0sIFMxMSwweEQ3NkFBNDc4KTsKICAgICAgZD1GRihkLGEsYixjLHhbaysxXSwgUzEyLDB4RThDN0I3NTYpOwogICAgICBjPUZGKGMsZCxhLGIseFtrKzJdLCBTMTMsMHgyNDIwNzBEQik7CiAgICAgIGI9RkYoYixjLGQsYSx4W2srM10sIFMxNCwweEMxQkRDRUVFKTsKICAgICAgYT1GRihhLGIsYyxkLHhbays0XSwgUzExLDB4RjU3QzBGQUYpOwogICAgICBkPUZGKGQsYSxiLGMseFtrKzVdLCBTMTIsMHg0Nzg3QzYyQSk7CiAgICAgIGM9RkYoYyxkLGEsYix4W2srNl0sIFMxMywweEE4MzA0NjEzKTsKICAgICAgYj1GRihiLGMsZCxhLHhbays3XSwgUzE0LDB4RkQ0Njk1MDEpOwogICAgICBhPUZGKGEsYixjLGQseFtrKzhdLCBTMTEsMHg2OTgwOThEOCk7CiAgICAgIGQ9RkYoZCxhLGIsYyx4W2srOV0sIFMxMiwweDhCNDRGN0FGKTsKICAgICAgYz1GRihjLGQsYSxiLHhbaysxMF0sUzEzLDB4RkZGRjVCQjEpOwogICAgICBiPUZGKGIsYyxkLGEseFtrKzExXSxTMTQsMHg4OTVDRDdCRSk7CiAgICAgIGE9RkYoYSxiLGMsZCx4W2srMTJdLFMxMSwweDZCOTAxMTIyKTsKICAgICAgZD1GRihkLGEsYixjLHhbaysxM10sUzEyLDB4RkQ5ODcxOTMpOwogICAgICBjPUZGKGMsZCxhLGIseFtrKzE0XSxTMTMsMHhBNjc5NDM4RSk7CiAgICAgIGI9RkYoYixjLGQsYSx4W2srMTVdLFMxNCwweDQ5QjQwODIxKTsKICAgICAgYT1HRyhhLGIsYyxkLHhbaysxXSwgUzIxLDB4RjYxRTI1NjIpOwogICAgICBkPUdHKGQsYSxiLGMseFtrKzZdLCBTMjIsMHhDMDQwQjM0MCk7CiAgICAgIGM9R0coYyxkLGEsYix4W2srMTFdLFMyMywweDI2NUU1QTUxKTsKICAgICAgYj1HRyhiLGMsZCxhLHhbayswXSwgUzI0LDB4RTlCNkM3QUEpOwogICAgICBhPUdHKGEsYixjLGQseFtrKzVdLCBTMjEsMHhENjJGMTA1RCk7CiAgICAgIGQ9R0coZCxhLGIsYyx4W2srMTBdLFMyMiwweDI0NDE0NTMpOwogICAgICBjPUdHKGMsZCxhLGIseFtrKzE1XSxTMjMsMHhEOEExRTY4MSk7CiAgICAgIGI9R0coYixjLGQsYSx4W2srNF0sIFMyNCwweEU3RDNGQkM4KTsKICAgICAgYT1HRyhhLGIsYyxkLHhbays5XSwgUzIxLDB4MjFFMUNERTYpOwogICAgICBkPUdHKGQsYSxiLGMseFtrKzE0XSxTMjIsMHhDMzM3MDdENik7CiAgICAgIGM9R0coYyxkLGEsYix4W2srM10sIFMyMywweEY0RDUwRDg3KTsKICAgICAgYj1HRyhiLGMsZCxhLHhbays4XSwgUzI0LDB4NDU1QTE0RUQpOwogICAgICBhPUdHKGEsYixjLGQseFtrKzEzXSxTMjEsMHhBOUUzRTkwNSk7CiAgICAgIGQ9R0coZCxhLGIsYyx4W2srMl0sIFMyMiwweEZDRUZBM0Y4KTsKICAgICAgYz1HRyhjLGQsYSxiLHhbays3XSwgUzIzLDB4Njc2RjAyRDkpOwogICAgICBiPUdHKGIsYyxkLGEseFtrKzEyXSxTMjQsMHg4RDJBNEM4QSk7CiAgICAgIGE9SEgoYSxiLGMsZCx4W2srNV0sIFMzMSwweEZGRkEzOTQyKTsKICAgICAgZD1ISChkLGEsYixjLHhbays4XSwgUzMyLDB4ODc3MUY2ODEpOwogICAgICBjPUhIKGMsZCxhLGIseFtrKzExXSxTMzMsMHg2RDlENjEyMik7CiAgICAgIGI9SEgoYixjLGQsYSx4W2srMTRdLFMzNCwweEZERTUzODBDKTsKICAgICAgYT1ISChhLGIsYyxkLHhbaysxXSwgUzMxLDB4QTRCRUVBNDQpOwogICAgICBkPUhIKGQsYSxiLGMseFtrKzRdLCBTMzIsMHg0QkRFQ0ZBOSk7CiAgICAgIGM9SEgoYyxkLGEsYix4W2srN10sIFMzMywweEY2QkI0QjYwKTsKICAgICAgYj1ISChiLGMsZCxhLHhbaysxMF0sUzM0LDB4QkVCRkJDNzApOwogICAgICBhPUhIKGEsYixjLGQseFtrKzEzXSxTMzEsMHgyODlCN0VDNik7CiAgICAgIGQ9SEgoZCxhLGIsYyx4W2srMF0sIFMzMiwweEVBQTEyN0ZBKTsKICAgICAgYz1ISChjLGQsYSxiLHhbayszXSwgUzMzLDB4RDRFRjMwODUpOwogICAgICBiPUhIKGIsYyxkLGEseFtrKzZdLCBTMzQsMHg0ODgxRDA1KTsKICAgICAgYT1ISChhLGIsYyxkLHhbays5XSwgUzMxLDB4RDlENEQwMzkpOwogICAgICBkPUhIKGQsYSxiLGMseFtrKzEyXSxTMzIsMHhFNkRCOTlFNSk7CiAgICAgIGM9SEgoYyxkLGEsYix4W2srMTVdLFMzMywweDFGQTI3Q0Y4KTsKICAgICAgYj1ISChiLGMsZCxhLHhbaysyXSwgUzM0LDB4QzRBQzU2NjUpOwogICAgICBhPUlJKGEsYixjLGQseFtrKzBdLCBTNDEsMHhGNDI5MjI0NCk7CiAgICAgIGQ9SUkoZCxhLGIsYyx4W2srN10sIFM0MiwweDQzMkFGRjk3KTsKICAgICAgYz1JSShjLGQsYSxiLHhbaysxNF0sUzQzLDB4QUI5NDIzQTcpOwogICAgICBiPUlJKGIsYyxkLGEseFtrKzVdLCBTNDQsMHhGQzkzQTAzOSk7CiAgICAgIGE9SUkoYSxiLGMsZCx4W2srMTJdLFM0MSwweDY1NUI1OUMzKTsKICAgICAgZD1JSShkLGEsYixjLHhbayszXSwgUzQyLDB4OEYwQ0NDOTIpOwogICAgICBjPUlJKGMsZCxhLGIseFtrKzEwXSxTNDMsMHhGRkVGRjQ3RCk7CiAgICAgIGI9SUkoYixjLGQsYSx4W2srMV0sIFM0NCwweDg1ODQ1REQxKTsKICAgICAgYT1JSShhLGIsYyxkLHhbays4XSwgUzQxLDB4NkZBODdFNEYpOwogICAgICBkPUlJKGQsYSxiLGMseFtrKzE1XSxTNDIsMHhGRTJDRTZFMCk7CiAgICAgIGM9SUkoYyxkLGEsYix4W2srNl0sIFM0MywweEEzMDE0MzE0KTsKICAgICAgYj1JSShiLGMsZCxhLHhbaysxM10sUzQ0LDB4NEUwODExQTEpOwogICAgICBhPUlJKGEsYixjLGQseFtrKzRdLCBTNDEsMHhGNzUzN0U4Mik7CiAgICAgIGQ9SUkoZCxhLGIsYyx4W2srMTFdLFM0MiwweEJEM0FGMjM1KTsKICAgICAgYz1JSShjLGQsYSxiLHhbaysyXSwgUzQzLDB4MkFEN0QyQkIpOwogICAgICBiPUlJKGIsYyxkLGEseFtrKzldLCBTNDQsMHhFQjg2RDM5MSk7CiAgICAgIGE9QWRkVW5zaWduZWQoYSxBQSk7CiAgICAgIGI9QWRkVW5zaWduZWQoYixCQik7CiAgICAgIGM9QWRkVW5zaWduZWQoYyxDQyk7CiAgICAgIGQ9QWRkVW5zaWduZWQoZCxERCk7CiAgICB9CgogICAgdmFyIHRlbXAgPSBXb3JkVG9IZXgoYSkrV29yZFRvSGV4KGIpK1dvcmRUb0hleChjKStXb3JkVG9IZXgoZCk7CgogICAgcmV0dXJuIHRlbXAudG9Mb3dlckNhc2UoKTsKICB9Cn07CgpTSVAuVXRpbHMgPSBVdGlsczsKfTsKCn0se31dLDM5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBXZWJSVEMKICovCgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVAsIGVudmlyb25tZW50KSB7CnZhciBXZWJSVEM7CgpXZWJSVEMgPSB7fTsKCldlYlJUQy5NZWRpYUhhbmRsZXIgPSByZXF1aXJlKCcuL1dlYlJUQy9NZWRpYUhhbmRsZXInKShTSVApOwpXZWJSVEMuTWVkaWFTdHJlYW1NYW5hZ2VyID0gcmVxdWlyZSgnLi9XZWJSVEMvTWVkaWFTdHJlYW1NYW5hZ2VyJykoU0lQLCBlbnZpcm9ubWVudCk7Cgp2YXIgX2lzU3VwcG9ydGVkOwoKV2ViUlRDLmlzU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewogIGlmIChfaXNTdXBwb3J0ZWQgIT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuIF9pc1N1cHBvcnRlZDsKICB9CgogIFdlYlJUQy5NZWRpYVN0cmVhbSA9IGVudmlyb25tZW50Lk1lZGlhU3RyZWFtOwogIFdlYlJUQy5nZXRVc2VyTWVkaWEgPSBlbnZpcm9ubWVudC5nZXRVc2VyTWVkaWE7CiAgV2ViUlRDLlJUQ1BlZXJDb25uZWN0aW9uID0gZW52aXJvbm1lbnQuUlRDUGVlckNvbm5lY3Rpb247CiAgV2ViUlRDLlJUQ1Nlc3Npb25EZXNjcmlwdGlvbiA9IGVudmlyb25tZW50LlJUQ1Nlc3Npb25EZXNjcmlwdGlvbjsKCiAgaWYgKFdlYlJUQy5SVENQZWVyQ29ubmVjdGlvbiAmJiBXZWJSVEMuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKSB7CiAgICBpZiAoV2ViUlRDLmdldFVzZXJNZWRpYSkgewogICAgICBXZWJSVEMuZ2V0VXNlck1lZGlhID0gU0lQLlV0aWxzLnByb21pc2lmeShlbnZpcm9ubWVudCwgJ2dldFVzZXJNZWRpYScpOwogICAgfQogICAgX2lzU3VwcG9ydGVkID0gdHJ1ZTsKICB9CiAgZWxzZSB7CiAgICBfaXNTdXBwb3J0ZWQgPSBmYWxzZTsKICB9CiAgcmV0dXJuIF9pc1N1cHBvcnRlZDsKfTsKCnJldHVybiBXZWJSVEM7Cn07Cgp9LHsiLi9XZWJSVEMvTWVkaWFIYW5kbGVyIjo0MCwiLi9XZWJSVEMvTWVkaWFTdHJlYW1NYW5hZ2VyIjo0MX1dLDQwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBNZWRpYUhhbmRsZXIKICovCgovKiBNZWRpYUhhbmRsZXIKICogQGNsYXNzIFBlZXJDb25uZWN0aW9uIGhlbHBlciBDbGFzcy4KICogQHBhcmFtIHtTSVAuU2Vzc2lvbn0gc2Vzc2lvbgogKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdCiAqIEBwYXJhbSB7U0lQLldlYlJUQy5NZWRpYVN0cmVhbU1hbmFnZXJ9IFtvcHRpb25zLm1lZGlhU3RyZWFtTWFuYWdlcl0KICogICAgICAgIFRoZSBNZWRpYVN0cmVhbU1hbmFnZXIgdG8gYWNxdWlyZS9yZWxlYXNlIHN0cmVhbXMgZnJvbS90by4KICogICAgICAgIElmIG5vdCBwcm92aWRlZCwgYSBkZWZhdWx0IE1lZGlhU3RyZWFtTWFuYWdlciB3aWxsIGJlIHVzZWQuCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKCnZhciBNZWRpYUhhbmRsZXIgPSBmdW5jdGlvbihzZXNzaW9uLCBvcHRpb25zKSB7CiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgogIHRoaXMubG9nZ2VyID0gc2Vzc2lvbi51YS5nZXRMb2dnZXIoJ3NpcC5pbnZpdGVjb250ZXh0Lm1lZGlhaGFuZGxlcicsIHNlc3Npb24uaWQpOwogIHRoaXMuc2Vzc2lvbiA9IHNlc3Npb247CiAgdGhpcy5sb2NhbE1lZGlhID0gbnVsbDsKICB0aGlzLnJlYWR5ID0gdHJ1ZTsKICB0aGlzLm1lZGlhU3RyZWFtTWFuYWdlciA9IG9wdGlvbnMubWVkaWFTdHJlYW1NYW5hZ2VyIHx8IG5ldyBTSVAuV2ViUlRDLk1lZGlhU3RyZWFtTWFuYWdlcih0aGlzLmxvZ2dlcik7CiAgdGhpcy5hdWRpb011dGVkID0gZmFsc2U7CiAgdGhpcy52aWRlb011dGVkID0gZmFsc2U7CgogIC8vIG9sZCBpbml0KCkgZnJvbSBoZXJlIG9uCiAgdmFyIHNlcnZlcnMgPSB0aGlzLnByZXBhcmVJY2VTZXJ2ZXJzKG9wdGlvbnMuc3R1blNlcnZlcnMsIG9wdGlvbnMudHVyblNlcnZlcnMpOwogIHRoaXMuUlRDQ29uc3RyYWludHMgPSBvcHRpb25zLlJUQ0NvbnN0cmFpbnRzIHx8IHt9OwoKICB0aGlzLmluaXRQZWVyQ29ubmVjdGlvbihzZXJ2ZXJzLCB0aGlzLlJUQ0NvbnN0cmFpbnRzKTsKCiAgZnVuY3Rpb24gc2VsZkVtaXQobWgsIGV2ZW50KSB7CiAgICBpZiAobWgubWVkaWFTdHJlYW1NYW5hZ2VyLm9uKSB7CiAgICAgIG1oLm1lZGlhU3RyZWFtTWFuYWdlci5vbihldmVudCwgZnVuY3Rpb24gKCkgewogICAgICAgIG1oLmVtaXQuYXBwbHkobWgsIFtldmVudF0uY29uY2F0KEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICBzZWxmRW1pdCh0aGlzLCAndXNlck1lZGlhUmVxdWVzdCcpOwogIHNlbGZFbWl0KHRoaXMsICd1c2VyTWVkaWEnKTsKICBzZWxmRW1pdCh0aGlzLCAndXNlck1lZGlhRmFpbGVkJyk7Cn07CgpNZWRpYUhhbmRsZXIuZGVmYXVsdEZhY3RvcnkgPSBmdW5jdGlvbiBkZWZhdWx0RmFjdG9yeSAoc2Vzc2lvbiwgb3B0aW9ucykgewogIHJldHVybiBuZXcgTWVkaWFIYW5kbGVyKHNlc3Npb24sIG9wdGlvbnMpOwp9OwpNZWRpYUhhbmRsZXIuZGVmYXVsdEZhY3RvcnkuaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIFNJUC5XZWJSVEMuaXNTdXBwb3J0ZWQoKTsKfTsKCk1lZGlhSGFuZGxlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5NZWRpYUhhbmRsZXIucHJvdG90eXBlLCB7Ci8vIEZ1bmN0aW9ucyB0aGUgc2Vzc2lvbiBjYW4gdXNlCiAgaXNSZWFkeToge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gaXNSZWFkeSAoKSB7CiAgICByZXR1cm4gdGhpcy5yZWFkeTsKICB9fSwKCiAgY2xvc2U6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGNsb3NlICgpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygnY2xvc2luZyBQZWVyQ29ubmVjdGlvbicpOwogICAgdGhpcy5fcmVtb3RlU3RyZWFtcyA9IFtdOwogICAgLy8gaGF2ZSB0byBjaGVjayBzaWduYWxpbmdTdGF0ZSBzaW5jZSB0aGlzLmNsb3NlKCkgZ2V0cyBjYWxsZWQgbXVsdGlwbGUgdGltZXMKICAgIC8vIFRPRE8gZmlndXJlIG91dCB3aHkgdGhhdCBoYXBwZW5zCiAgICBpZih0aGlzLnBlZXJDb25uZWN0aW9uICYmIHRoaXMucGVlckNvbm5lY3Rpb24uc2lnbmFsaW5nU3RhdGUgIT09ICdjbG9zZWQnKSB7CiAgICAgIHRoaXMucGVlckNvbm5lY3Rpb24uY2xvc2UoKTsKCiAgICAgIGlmKHRoaXMubG9jYWxNZWRpYSkgewogICAgICAgIHRoaXMubWVkaWFTdHJlYW1NYW5hZ2VyLnJlbGVhc2UodGhpcy5sb2NhbE1lZGlhKTsKICAgICAgfQogICAgfQogIH19LAoKICAvKioKICAgKiBAcGFyYW0ge1NJUC5XZWJSVEMuTWVkaWFTdHJlYW0gfCAoZ2V0VXNlck1lZGlhIGNvbnN0cmFpbnRzKX0gW21lZGlhSGludF0KICAgKiAgICAgICAgdGhlIE1lZGlhU3RyZWFtIChvciB0aGUgY29uc3RyYWludHMgZGVzY3JpYmluZyBpdCkgdG8gYmUgdXNlZCBmb3IgdGhlIHNlc3Npb24KICAgKi8KICBnZXREZXNjcmlwdGlvbjoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gZ2V0RGVzY3JpcHRpb24gKG1lZGlhSGludCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgdmFyIGFjcXVpcmUgPSBzZWxmLm1lZGlhU3RyZWFtTWFuYWdlci5hY3F1aXJlOwogICAgaWYgKGFjcXVpcmUubGVuZ3RoID4gMSkgewogICAgICBhY3F1aXJlID0gU0lQLlV0aWxzLnByb21pc2lmeSh0aGlzLm1lZGlhU3RyZWFtTWFuYWdlciwgJ2FjcXVpcmUnLCB0cnVlKTsKICAgIH0KICAgIG1lZGlhSGludCA9IG1lZGlhSGludCB8fCB7fTsKICAgIGlmIChtZWRpYUhpbnQuZGF0YUNoYW5uZWwgPT09IHRydWUpIHsKICAgICAgbWVkaWFIaW50LmRhdGFDaGFubmVsID0ge307CiAgICB9CiAgICB0aGlzLm1lZGlhSGludCA9IG1lZGlhSGludDsKCiAgICAvKgogICAgICogMS4gYWNxdWlyZSBzdHJlYW1zIChza2lwIGlmIE1lZGlhU3RyZWFtcyBwYXNzZWQgaW4pCiAgICAgKiAyLiBhZGRTdHJlYW1zCiAgICAgKiAzLiBjcmVhdGVPZmZlci9jcmVhdGVBbnN3ZXIKICAgICAqLwoKICAgIHZhciBzdHJlYW1Qcm9taXNlOwogICAgaWYgKHNlbGYubG9jYWxNZWRpYSkgewogICAgICBzZWxmLmxvZ2dlci5sb2coJ2FscmVhZHkgaGF2ZSBsb2NhbCBtZWRpYScpOwogICAgICBzdHJlYW1Qcm9taXNlID0gU0lQLlV0aWxzLlByb21pc2UucmVzb2x2ZShzZWxmLmxvY2FsTWVkaWEpOwogICAgfQogICAgZWxzZSB7CiAgICAgIHNlbGYubG9nZ2VyLmxvZygnYWNxdWlyaW5nIGxvY2FsIG1lZGlhJyk7CiAgICAgIHN0cmVhbVByb21pc2UgPSBhY3F1aXJlLmNhbGwoc2VsZi5tZWRpYVN0cmVhbU1hbmFnZXIsIG1lZGlhSGludCkKICAgICAgICAudGhlbihmdW5jdGlvbiBhY3F1aXJlU3VjY2VlZGVkKHN0cmVhbXMpIHsKICAgICAgICAgIHNlbGYubG9nZ2VyLmxvZygnYWNxdWlyZWQgbG9jYWwgbWVkaWEgc3RyZWFtcycpOwogICAgICAgICAgc2VsZi5sb2NhbE1lZGlhID0gc3RyZWFtczsKICAgICAgICAgIHNlbGYuc2Vzc2lvbi5jb25uZWN0aW5nKCk7CiAgICAgICAgICByZXR1cm4gc3RyZWFtczsKICAgICAgICB9LCBmdW5jdGlvbiBhY3F1aXJlRmFpbGVkKGVycikgewogICAgICAgICAgc2VsZi5sb2dnZXIuZXJyb3IoJ3VuYWJsZSB0byBhY3F1aXJlIHN0cmVhbXMnKTsKICAgICAgICAgIHNlbGYubG9nZ2VyLmVycm9yKGVycik7CiAgICAgICAgICBzZWxmLnNlc3Npb24uY29ubmVjdGluZygpOwogICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgIH0pCiAgICAgICAgLnRoZW4odGhpcy5hZGRTdHJlYW1zLmJpbmQodGhpcykpCiAgICAgIDsKICAgIH0KCiAgICByZXR1cm4gc3RyZWFtUHJvbWlzZQogICAgICAudGhlbihmdW5jdGlvbiBzdHJlYW1BZGRpdGlvblN1Y2NlZWRlZCgpIHsKICAgICAgICBpZiAoc2VsZi5oYXNPZmZlcigncmVtb3RlJykpIHsKICAgICAgICAgIHNlbGYucGVlckNvbm5lY3Rpb24ub25kYXRhY2hhbm5lbCA9IGZ1bmN0aW9uIChldnQpIHsKICAgICAgICAgICAgc2VsZi5kYXRhQ2hhbm5lbCA9IGV2dC5jaGFubmVsOwogICAgICAgICAgICBzZWxmLmVtaXQoJ2RhdGFDaGFubmVsJywgc2VsZi5kYXRhQ2hhbm5lbCk7CiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSBpZiAobWVkaWFIaW50LmRhdGFDaGFubmVsICYmCiAgICAgICAgICAgICAgICAgICBzZWxmLnBlZXJDb25uZWN0aW9uLmNyZWF0ZURhdGFDaGFubmVsKSB7CiAgICAgICAgICBzZWxmLmRhdGFDaGFubmVsID0gc2VsZi5wZWVyQ29ubmVjdGlvbi5jcmVhdGVEYXRhQ2hhbm5lbCgKICAgICAgICAgICAgJ3NpcGpzJywKICAgICAgICAgICAgbWVkaWFIaW50LmRhdGFDaGFubmVsCiAgICAgICAgICApOwogICAgICAgICAgc2VsZi5lbWl0KCdkYXRhQ2hhbm5lbCcsIHNlbGYuZGF0YUNoYW5uZWwpOwogICAgICAgIH0KCiAgICAgICAgc2VsZi5yZW5kZXIoKTsKICAgICAgICByZXR1cm4gc2VsZi5jcmVhdGVPZmZlck9yQW5zd2VyKHNlbGYuUlRDQ29uc3RyYWludHMpOwogICAgICB9KQogICAgOwogIH19LAoKICAvKioKICAqIE1lc3NhZ2UgcmVjZXB0aW9uLgogICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKICAqIEBwYXJhbSB7U3RyaW5nfSBzZHAKICAqLwogIHNldERlc2NyaXB0aW9uOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBzZXREZXNjcmlwdGlvbiAoc2RwKSB7CiAgICB2YXIgcmF3RGVzY3JpcHRpb24gPSB7CiAgICAgIHR5cGU6IHRoaXMuaGFzT2ZmZXIoJ2xvY2FsJykgPyAnYW5zd2VyJyA6ICdvZmZlcicsCiAgICAgIHNkcDogc2RwCiAgICB9OwoKICAgIHRoaXMuZW1pdCgnc2V0RGVzY3JpcHRpb24nLCByYXdEZXNjcmlwdGlvbik7CgogICAgdmFyIGRlc2NyaXB0aW9uID0gbmV3IFNJUC5XZWJSVEMuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHJhd0Rlc2NyaXB0aW9uKTsKICAgIHJldHVybiBTSVAuVXRpbHMucHJvbWlzaWZ5KHRoaXMucGVlckNvbm5lY3Rpb24sICdzZXRSZW1vdGVEZXNjcmlwdGlvbicpKGRlc2NyaXB0aW9uKTsKICB9fSwKCiAgLyoqCiAgICogSWYgdGhlIFNlc3Npb24gYXNzb2NpYXRlZCB3aXRoIHRoaXMgTWVkaWFIYW5kbGVyIHdlcmUgdG8gYmUgcmVmZXJyZWQsCiAgICogd2hhdCBtZWRpYUhpbnQgc2hvdWxkIGJlIHByb3ZpZGVkIHRvIHRoZSBVQSdzIGludml0ZSBtZXRob2Q/CiAgICovCiAgZ2V0UmVmZXJNZWRpYToge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVmZXJNZWRpYSAoKSB7CiAgICBmdW5jdGlvbiBoYXNUcmFja3MgKHRyYWNrR2V0dGVyLCBzdHJlYW0pIHsKICAgICAgcmV0dXJuIHN0cmVhbVt0cmFja0dldHRlcl0oKS5sZW5ndGggPiAwOwogICAgfQoKICAgIGZ1bmN0aW9uIGJvdGhIYXZlVHJhY2tzICh0cmFja0dldHRlcikgewogICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi8KICAgICAgcmV0dXJuIHRoaXMuZ2V0TG9jYWxTdHJlYW1zKCkuc29tZShoYXNUcmFja3MuYmluZChudWxsLCB0cmFja0dldHRlcikpICYmCiAgICAgICAgICAgICB0aGlzLmdldFJlbW90ZVN0cmVhbXMoKS5zb21lKGhhc1RyYWNrcy5iaW5kKG51bGwsIHRyYWNrR2V0dGVyKSk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgY29uc3RyYWludHM6IHsKICAgICAgICBhdWRpbzogYm90aEhhdmVUcmFja3MuY2FsbCh0aGlzLCAnZ2V0QXVkaW9UcmFja3MnKSwKICAgICAgICB2aWRlbzogYm90aEhhdmVUcmFja3MuY2FsbCh0aGlzLCAnZ2V0VmlkZW9UcmFja3MnKQogICAgICB9CiAgICB9OwogIH19LAoKICB1cGRhdGVJY2VTZXJ2ZXJzOiB7d3JpdGVhYmxlOnRydWUsIHZhbHVlOiBmdW5jdGlvbiAob3B0aW9ucykgewogICAgdmFyIHNlcnZlcnMgPSB0aGlzLnByZXBhcmVJY2VTZXJ2ZXJzKG9wdGlvbnMuc3R1blNlcnZlcnMsIG9wdGlvbnMudHVyblNlcnZlcnMpOwogICAgdGhpcy5SVENDb25zdHJhaW50cyA9IG9wdGlvbnMuUlRDQ29uc3RyYWludHMgfHwgdGhpcy5SVENDb25zdHJhaW50czsKCiAgICB0aGlzLmluaXRQZWVyQ29ubmVjdGlvbihzZXJ2ZXJzLCB0aGlzLlJUQ0NvbnN0cmFpbnRzKTsKCiAgICAvKiBvbmNlIHVwZGF0ZUljZSBpcyBpbXBsZW1lbnRlZCBjb3JyZWN0bHksIHRoaXMgaXMgYmV0dGVyIHRoYW4gYWJvdmUKICAgIC8vbm8gb3AgaWYgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IHRoaXMKICAgIGlmICghdGhpcy5wZWVyQ29ubmVjdGlvbi51cGRhdGVJY2UpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMucGVlckNvbm5lY3Rpb24udXBkYXRlSWNlKHsnaWNlU2VydmVycyc6IHNlcnZlcnN9LCB0aGlzLlJUQ0NvbnN0cmFpbnRzKTsKICAgICovCiAgfX0sCgovLyBGdW5jdGlvbnMgdGhlIHNlc3Npb24gY2FuIHVzZSwgYnV0IG9ubHkgYmVjYXVzZSBpdCdzIGNvbnZlbmllbnQgZm9yIHRoZSBhcHBsaWNhdGlvbgogIGlzTXV0ZWQ6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGlzTXV0ZWQgKCkgewogICAgcmV0dXJuIHsKICAgICAgYXVkaW86IHRoaXMuYXVkaW9NdXRlZCwKICAgICAgdmlkZW86IHRoaXMudmlkZW9NdXRlZAogICAgfTsKICB9fSwKCiAgbXV0ZToge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gbXV0ZSAob3B0aW9ucykgewogICAgaWYgKHRoaXMuZ2V0TG9jYWxTdHJlYW1zKCkubGVuZ3RoID09PSAwKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7CiAgICAgIGF1ZGlvOiB0aGlzLmdldExvY2FsU3RyZWFtcygpWzBdLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCwKICAgICAgdmlkZW86IHRoaXMuZ2V0TG9jYWxTdHJlYW1zKClbMF0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGggPiAwCiAgICB9OwoKICAgIHZhciBhdWRpb011dGVkID0gZmFsc2UsCiAgICAgICAgdmlkZW9NdXRlZCA9IGZhbHNlOwoKICAgIGlmIChvcHRpb25zLmF1ZGlvICYmICF0aGlzLmF1ZGlvTXV0ZWQpIHsKICAgICAgYXVkaW9NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMuYXVkaW9NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMudG9nZ2xlTXV0ZUF1ZGlvKHRydWUpOwogICAgfQoKICAgIGlmIChvcHRpb25zLnZpZGVvICYmICF0aGlzLnZpZGVvTXV0ZWQpIHsKICAgICAgdmlkZW9NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMudmlkZW9NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMudG9nZ2xlTXV0ZVZpZGVvKHRydWUpOwogICAgfQoKICAgIC8vUkVWSVNJVAogICAgaWYgKGF1ZGlvTXV0ZWQgfHwgdmlkZW9NdXRlZCkgewogICAgICByZXR1cm4gewogICAgICAgIGF1ZGlvOiBhdWRpb011dGVkLAogICAgICAgIHZpZGVvOiB2aWRlb011dGVkCiAgICAgIH07CiAgICAgIC8qdGhpcy5zZXNzaW9uLm9ubXV0ZSh7CiAgICAgICAgYXVkaW86IGF1ZGlvTXV0ZWQsCiAgICAgICAgdmlkZW86IHZpZGVvTXV0ZWQKICAgICAgfSk7Ki8KICAgIH0KICB9fSwKCiAgdW5tdXRlOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiB1bm11dGUgKG9wdGlvbnMpIHsKICAgIGlmICh0aGlzLmdldExvY2FsU3RyZWFtcygpLmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwgewogICAgICBhdWRpbzogdGhpcy5nZXRMb2NhbFN0cmVhbXMoKVswXS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCA+IDAsCiAgICAgIHZpZGVvOiB0aGlzLmdldExvY2FsU3RyZWFtcygpWzBdLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoID4gMAogICAgfTsKCiAgICB2YXIgYXVkaW9Vbk11dGVkID0gZmFsc2UsCiAgICAgICAgdmlkZW9Vbk11dGVkID0gZmFsc2U7CgogICAgaWYgKG9wdGlvbnMuYXVkaW8gJiYgdGhpcy5hdWRpb011dGVkKSB7CiAgICAgIGF1ZGlvVW5NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMuYXVkaW9NdXRlZCA9IGZhbHNlOwogICAgICB0aGlzLnRvZ2dsZU11dGVBdWRpbyhmYWxzZSk7CiAgICB9CgogICAgaWYgKG9wdGlvbnMudmlkZW8gJiYgdGhpcy52aWRlb011dGVkKSB7CiAgICAgIHZpZGVvVW5NdXRlZCA9IHRydWU7CiAgICAgIHRoaXMudmlkZW9NdXRlZCA9IGZhbHNlOwogICAgICB0aGlzLnRvZ2dsZU11dGVWaWRlbyhmYWxzZSk7CiAgICB9CgogICAgLy9SRVZJU0lUCiAgICBpZiAoYXVkaW9Vbk11dGVkIHx8IHZpZGVvVW5NdXRlZCkgewogICAgICByZXR1cm4gewogICAgICAgIGF1ZGlvOiBhdWRpb1VuTXV0ZWQsCiAgICAgICAgdmlkZW86IHZpZGVvVW5NdXRlZAogICAgICB9OwogICAgICAvKnRoaXMuc2Vzc2lvbi5vbnVubXV0ZSh7CiAgICAgICAgYXVkaW86IGF1ZGlvVW5NdXRlZCwKICAgICAgICB2aWRlbzogdmlkZW9Vbk11dGVkCiAgICAgIH0pOyovCiAgICB9CiAgfX0sCgogIGhvbGQ6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGhvbGQgKCkgewogICAgdGhpcy50b2dnbGVNdXRlQXVkaW8odHJ1ZSk7CiAgICB0aGlzLnRvZ2dsZU11dGVWaWRlbyh0cnVlKTsKICB9fSwKCiAgdW5ob2xkOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiB1bmhvbGQgKCkgewogICAgaWYgKCF0aGlzLmF1ZGlvTXV0ZWQpIHsKICAgICAgdGhpcy50b2dnbGVNdXRlQXVkaW8oZmFsc2UpOwogICAgfQoKICAgIGlmICghdGhpcy52aWRlb011dGVkKSB7CiAgICAgIHRoaXMudG9nZ2xlTXV0ZVZpZGVvKGZhbHNlKTsKICAgIH0KICB9fSwKCi8vIEZ1bmN0aW9ucyB0aGUgYXBwbGljYXRpb24gY2FuIHVzZSwgYnV0IG5vdCB0aGUgc2Vzc2lvbgogIGdldExvY2FsU3RyZWFtczoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gZ2V0TG9jYWxTdHJlYW1zICgpIHsKICAgIHZhciBwYyA9IHRoaXMucGVlckNvbm5lY3Rpb247CiAgICBpZiAocGMgJiYgcGMuc2lnbmFsaW5nU3RhdGUgPT09ICdjbG9zZWQnKSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ3BlZXJDb25uZWN0aW9uIGlzIGNsb3NlZCwgZ2V0TG9jYWxTdHJlYW1zIHJldHVybmluZyBbXScpOwogICAgICByZXR1cm4gW107CiAgICB9CiAgICByZXR1cm4gKHBjLmdldExvY2FsU3RyZWFtcyAmJiBwYy5nZXRMb2NhbFN0cmVhbXMoKSkgfHwKICAgICAgcGMubG9jYWxTdHJlYW1zIHx8IFtdOwogIH19LAoKICBnZXRSZW1vdGVTdHJlYW1zOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBnZXRSZW1vdGVTdHJlYW1zICgpIHsKICAgIHZhciBwYyA9IHRoaXMucGVlckNvbm5lY3Rpb247CiAgICBpZiAocGMgJiYgcGMuc2lnbmFsaW5nU3RhdGUgPT09ICdjbG9zZWQnKSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ3BlZXJDb25uZWN0aW9uIGlzIGNsb3NlZCwgZ2V0UmVtb3RlU3RyZWFtcyByZXR1cm5pbmcgdGhpcy5fcmVtb3RlU3RyZWFtcycpOwogICAgICByZXR1cm4gdGhpcy5fcmVtb3RlU3RyZWFtczsKICAgIH0KICAgIHJldHVybihwYy5nZXRSZW1vdGVTdHJlYW1zICYmIHBjLmdldFJlbW90ZVN0cmVhbXMoKSkgfHwKICAgICAgcGMucmVtb3RlU3RyZWFtcyB8fCBbXTsKICB9fSwKCiAgcmVuZGVyOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIgKHJlbmRlckhpbnQpIHsKICAgIHJlbmRlckhpbnQgPSByZW5kZXJIaW50IHx8ICh0aGlzLm1lZGlhSGludCAmJiB0aGlzLm1lZGlhSGludC5yZW5kZXIpOwogICAgaWYgKCFyZW5kZXJIaW50KSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHZhciBzdHJlYW1HZXR0ZXJzID0gewogICAgICBsb2NhbDogJ2dldExvY2FsU3RyZWFtcycsCiAgICAgIHJlbW90ZTogJ2dldFJlbW90ZVN0cmVhbXMnCiAgICB9OwogICAgT2JqZWN0LmtleXMoc3RyZWFtR2V0dGVycykuZm9yRWFjaChmdW5jdGlvbiAobG9jKSB7CiAgICAgIHZhciBzdHJlYW1HZXR0ZXIgPSBzdHJlYW1HZXR0ZXJzW2xvY107CiAgICAgIHZhciBzdHJlYW1zID0gdGhpc1tzdHJlYW1HZXR0ZXJdKCk7CiAgICAgIFNJUC5XZWJSVEMuTWVkaWFTdHJlYW1NYW5hZ2VyLnJlbmRlcihzdHJlYW1zLCByZW5kZXJIaW50W2xvY10pOwogICAgfS5iaW5kKHRoaXMpKTsKICB9fSwKCi8vIEludGVybmFsIGZ1bmN0aW9ucwogIGhhc09mZmVyOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBoYXNPZmZlciAod2hlcmUpIHsKICAgIHZhciBvZmZlclN0YXRlID0gJ2hhdmUtJyArIHdoZXJlICsgJy1vZmZlcic7CiAgICByZXR1cm4gdGhpcy5wZWVyQ29ubmVjdGlvbi5zaWduYWxpbmdTdGF0ZSA9PT0gb2ZmZXJTdGF0ZTsKICAgIC8vIFRPRE8gY29uc2lkZXIgc2lnbmFsaW5nU3RhdGVzIHdpdGggJ3ByYW5zd2VyJz8KICB9fSwKCiAgcHJlcGFyZUljZVNlcnZlcnM6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIHByZXBhcmVJY2VTZXJ2ZXJzIChzdHVuU2VydmVycywgdHVyblNlcnZlcnMpIHsKICAgIHZhciBzZXJ2ZXJzID0gW10sCiAgICAgIGNvbmZpZyA9IHRoaXMuc2Vzc2lvbi51YS5jb25maWd1cmF0aW9uOwoKICAgIHN0dW5TZXJ2ZXJzID0gc3R1blNlcnZlcnMgfHwgY29uZmlnLnN0dW5TZXJ2ZXJzOwogICAgdHVyblNlcnZlcnMgPSB0dXJuU2VydmVycyB8fCBjb25maWcudHVyblNlcnZlcnM7CgogICAgW10uY29uY2F0KHN0dW5TZXJ2ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChzZXJ2ZXIpIHsKICAgICAgc2VydmVycy5wdXNoKHsndXJscyc6IHNlcnZlcn0pOwogICAgfSk7CgogICAgW10uY29uY2F0KHR1cm5TZXJ2ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChzZXJ2ZXIpIHsKICAgICAgc2VydmVycy5wdXNoKHsKICAgICAgICAndXJscyc6IHNlcnZlci51cmxzLAogICAgICAgICd1c2VybmFtZSc6IHNlcnZlci51c2VybmFtZSwKICAgICAgICAnY3JlZGVudGlhbCc6IHNlcnZlci5wYXNzd29yZAogICAgICB9KTsKICAgIH0pOwoKICAgIHJldHVybiBzZXJ2ZXJzOwogIH19LAoKICBpbml0UGVlckNvbm5lY3Rpb246IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGluaXRQZWVyQ29ubmVjdGlvbihzZXJ2ZXJzLCBSVENDb25zdHJhaW50cykgewogICAgdmFyIHNlbGYgPSB0aGlzLAogICAgICBjb25maWcgPSB0aGlzLnNlc3Npb24udWEuY29uZmlndXJhdGlvbjsKCiAgICB0aGlzLm9uSWNlQ29tcGxldGVkID0gU0lQLlV0aWxzLmRlZmVyKCk7CiAgICB0aGlzLm9uSWNlQ29tcGxldGVkLnByb21pc2UudGhlbihmdW5jdGlvbihwYykgewogICAgICBzZWxmLmVtaXQoJ2ljZUdhdGhlcmluZ0NvbXBsZXRlJywgcGMpOwogICAgICBpZiAoc2VsZi5pY2VDaGVja2luZ1RpbWVyKSB7CiAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQoc2VsZi5pY2VDaGVja2luZ1RpbWVyKTsKICAgICAgICBzZWxmLmljZUNoZWNraW5nVGltZXIgPSBudWxsOwogICAgICB9CiAgICB9KTsKCiAgICBpZiAodGhpcy5wZWVyQ29ubmVjdGlvbikgewogICAgICB0aGlzLnBlZXJDb25uZWN0aW9uLmNsb3NlKCk7CiAgICB9CgogICAgdGhpcy5wZWVyQ29ubmVjdGlvbiA9IG5ldyBTSVAuV2ViUlRDLlJUQ1BlZXJDb25uZWN0aW9uKHsnaWNlU2VydmVycyc6IHNlcnZlcnN9LCBSVENDb25zdHJhaW50cyk7CgogICAgLy8gRmlyZWZveCAoMzUuMC4xKSBzb21ldGltZXMgdGhyb3dzIG9uIGNhbGxzIHRvIHBlZXJDb25uZWN0aW9uLmdldFJlbW90ZVN0cmVhbXMKICAgIC8vIGV2ZW4gaWYgcGVlckNvbm5lY3Rpb24ub25hZGRzdHJlYW0gd2FzIGp1c3QgY2FsbGVkLiBJbiBvcmRlciB0byBtYWtlCiAgICAvLyBNZWRpYUhhbmRsZXIucHJvdG90eXBlLmdldFJlbW90ZVN0cmVhbXMgd29yaywga2VlcCB0cmFjayBvZiB0aGVtIG1hbnVhbGx5CiAgICB0aGlzLl9yZW1vdGVTdHJlYW1zID0gW107CgogICAgdGhpcy5wZWVyQ29ubmVjdGlvbi5vbmFkZHN0cmVhbSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgc2VsZi5sb2dnZXIubG9nKCdzdHJlYW0gYWRkZWQ6ICcrIGUuc3RyZWFtLmlkKTsKICAgICAgc2VsZi5fcmVtb3RlU3RyZWFtcy5wdXNoKGUuc3RyZWFtKTsKICAgICAgc2VsZi5yZW5kZXIoKTsKICAgICAgc2VsZi5lbWl0KCdhZGRTdHJlYW0nLCBlKTsKICAgIH07CgogICAgdGhpcy5wZWVyQ29ubmVjdGlvbi5vbnJlbW92ZXN0cmVhbSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgc2VsZi5sb2dnZXIubG9nKCdzdHJlYW0gcmVtb3ZlZDogJysgZS5zdHJlYW0uaWQpOwogICAgfTsKCiAgICB0aGlzLnN0YXJ0SWNlQ2hlY2tpbmdUaW1lciA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFzZWxmLmljZUNoZWNraW5nVGltZXIpIHsKICAgICAgICBzZWxmLmljZUNoZWNraW5nVGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICBzZWxmLmxvZ2dlci5sb2coJ1JUQ0ljZUNoZWNraW5nIFRpbWVvdXQgVHJpZ2dlcmVkIGFmdGVyICcrY29uZmlnLmljZUNoZWNraW5nVGltZW91dCsnIG1pbGxpc2Vjb25kcycpOwogICAgICAgICAgc2VsZi5vbkljZUNvbXBsZXRlZC5yZXNvbHZlKHRoaXMpOwogICAgICAgIH0uYmluZCh0aGlzLnBlZXJDb25uZWN0aW9uKSwgY29uZmlnLmljZUNoZWNraW5nVGltZW91dCk7CiAgICAgIH0KICAgIH07CgogICAgdGhpcy5wZWVyQ29ubmVjdGlvbi5vbmljZWNhbmRpZGF0ZSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgc2VsZi5lbWl0KCdpY2VDYW5kaWRhdGUnLCBlKTsKICAgICAgaWYgKGUuY2FuZGlkYXRlKSB7CiAgICAgICAgc2VsZi5sb2dnZXIubG9nKCdJQ0UgY2FuZGlkYXRlIHJlY2VpdmVkOiAnKyAoZS5jYW5kaWRhdGUuY2FuZGlkYXRlID09PSBudWxsID8gbnVsbCA6IGUuY2FuZGlkYXRlLmNhbmRpZGF0ZS50cmltKCkpKTsKICAgICAgICBzZWxmLnN0YXJ0SWNlQ2hlY2tpbmdUaW1lcigpOwogICAgICB9IGVsc2UgewogICAgICAgIHNlbGYub25JY2VDb21wbGV0ZWQucmVzb2x2ZSh0aGlzKTsKICAgICAgfQogICAgfTsKCiAgICB0aGlzLnBlZXJDb25uZWN0aW9uLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHNlbGYubG9nZ2VyLmxvZygnUlRDSWNlR2F0aGVyaW5nU3RhdGUgY2hhbmdlZDogJyArIHRoaXMuaWNlR2F0aGVyaW5nU3RhdGUpOwogICAgICBpZiAodGhpcy5pY2VHYXRoZXJpbmdTdGF0ZSA9PT0gJ2dhdGhlcmluZycpIHsKICAgICAgICBzZWxmLmVtaXQoJ2ljZUdhdGhlcmluZycsIHRoaXMpOwogICAgICB9CiAgICAgIGlmICh0aGlzLmljZUdhdGhlcmluZ1N0YXRlID09PSAnY29tcGxldGUnKSB7CiAgICAgICAgc2VsZi5vbkljZUNvbXBsZXRlZC5yZXNvbHZlKHRoaXMpOwogICAgICB9CiAgICB9OwoKICAgIHRoaXMucGVlckNvbm5lY3Rpb24ub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsgIC8vbmVlZCBlIGZvciBjb21tZW50ZWQgb3V0IGNhc2UKICAgICAgdmFyIHN0YXRlRXZlbnQ7CgogICAgICBpZiAodGhpcy5pY2VDb25uZWN0aW9uU3RhdGUgPT09ICdjaGVja2luZycpIHsKICAgICAgICBzZWxmLnN0YXJ0SWNlQ2hlY2tpbmdUaW1lcigpOwogICAgICB9CgogICAgICBzd2l0Y2ggKHRoaXMuaWNlQ29ubmVjdGlvblN0YXRlKSB7CiAgICAgIGNhc2UgJ25ldyc6CiAgICAgICAgc3RhdGVFdmVudCA9ICdpY2VDb25uZWN0aW9uJzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnY2hlY2tpbmcnOgogICAgICAgIHN0YXRlRXZlbnQgPSAnaWNlQ29ubmVjdGlvbkNoZWNraW5nJzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnY29ubmVjdGVkJzoKICAgICAgICBzdGF0ZUV2ZW50ID0gJ2ljZUNvbm5lY3Rpb25Db25uZWN0ZWQnOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdjb21wbGV0ZWQnOgogICAgICAgIHN0YXRlRXZlbnQgPSAnaWNlQ29ubmVjdGlvbkNvbXBsZXRlZCc7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2ZhaWxlZCc6CiAgICAgICAgc3RhdGVFdmVudCA9ICdpY2VDb25uZWN0aW9uRmFpbGVkJzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZGlzY29ubmVjdGVkJzoKICAgICAgICBzdGF0ZUV2ZW50ID0gJ2ljZUNvbm5lY3Rpb25EaXNjb25uZWN0ZWQnOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdjbG9zZWQnOgogICAgICAgIHN0YXRlRXZlbnQgPSAnaWNlQ29ubmVjdGlvbkNsb3NlZCc7CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgc2VsZi5sb2dnZXIud2FybignVW5rbm93biBpY2VDb25uZWN0aW9uIHN0YXRlOicsIHRoaXMuaWNlQ29ubmVjdGlvblN0YXRlKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgc2VsZi5lbWl0KHN0YXRlRXZlbnQsIHRoaXMpOwoKICAgICAgLy9CcmlhIHN0YXRlIGNoYW5nZXMgYXJlIGFsd2F5cyBjb25uZWN0ZWQgLT4gZGlzY29ubmVjdGVkIC0+IGNvbm5lY3RlZCBvbiBhY2NlcHQsIHNvIHNlc3Npb24gZ2V0cyB0ZXJtaW5hdGVkCiAgICAgIC8vbm9ybWFsIGNhbGxzIHN3aXRjaCBmcm9tIGZhaWxlZCB0byBjb25uZWN0ZWQgaW4gc29tZSBjYXNlcywgc28gY2hlY2tpbmcgZm9yIGZhaWxlZCBhbmQgdGVybWluYXRlZAogICAgICAvKmlmICh0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSA9PT0gJ2ZhaWxlZCcpIHsKICAgICAgICBzZWxmLnNlc3Npb24udGVybWluYXRlKHsKICAgICAgICBjYXVzZTogU0lQLkMuY2F1c2VzLlJUUF9USU1FT1VULAogICAgICAgIHN0YXR1c19jb2RlOiAyMDAsCiAgICAgICAgcmVhc29uX3BocmFzZTogU0lQLkMuY2F1c2VzLlJUUF9USU1FT1VUCiAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGUuY3VycmVudFRhcmdldC5pY2VHYXRoZXJpbmdTdGF0ZSA9PT0gJ2NvbXBsZXRlJyAmJiB0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSAhPT0gJ2Nsb3NlZCcpIHsKICAgICAgc2VsZi5vbkljZUNvbXBsZXRlZCh0aGlzKTsKICAgICAgfSovCiAgICB9OwoKICAgIHRoaXMucGVlckNvbm5lY3Rpb24ub25zdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICBzZWxmLmxvZ2dlci5sb2coJ1BlZXJDb25uZWN0aW9uIHN0YXRlIGNoYW5nZWQgdG8gIicrIHRoaXMucmVhZHlTdGF0ZSArJyInKTsKICAgIH07CiAgfX0sCgogIGNyZWF0ZU9mZmVyT3JBbnN3ZXI6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZU9mZmVyT3JBbnN3ZXIgKGNvbnN0cmFpbnRzKSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICB2YXIgbWV0aG9kTmFtZTsKICAgIHZhciBwYyA9IHNlbGYucGVlckNvbm5lY3Rpb247CgogICAgc2VsZi5yZWFkeSA9IGZhbHNlOwogICAgbWV0aG9kTmFtZSA9IHNlbGYuaGFzT2ZmZXIoJ3JlbW90ZScpID8gJ2NyZWF0ZUFuc3dlcicgOiAnY3JlYXRlT2ZmZXInOwoKICAgIHJldHVybiBTSVAuVXRpbHMucHJvbWlzaWZ5KHBjLCBtZXRob2ROYW1lLCB0cnVlKShjb25zdHJhaW50cykKICAgICAgLnRoZW4oU0lQLlV0aWxzLnByb21pc2lmeShwYywgJ3NldExvY2FsRGVzY3JpcHRpb24nKSkKICAgICAgLnRoZW4oZnVuY3Rpb24gb25TZXRMb2NhbERlc2NyaXB0aW9uU3VjY2VzcygpIHsKICAgICAgICB2YXIgZGVmZXJyZWQgPSBTSVAuVXRpbHMuZGVmZXIoKTsKICAgICAgICBpZiAocGMuaWNlR2F0aGVyaW5nU3RhdGUgPT09ICdjb21wbGV0ZScgJiYgKHBjLmljZUNvbm5lY3Rpb25TdGF0ZSA9PT0gJ2Nvbm5lY3RlZCcgfHwgcGMuaWNlQ29ubmVjdGlvblN0YXRlID09PSAnY29tcGxldGVkJykpIHsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2VsZi5vbkljZUNvbXBsZXRlZC5wcm9taXNlLnRoZW4oZGVmZXJyZWQucmVzb2x2ZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlOwogICAgICB9KQogICAgICAudGhlbihmdW5jdGlvbiByZWFkeVN1Y2Nlc3MgKCkgewogICAgICAgIHZhciBzZHAgPSBwYy5sb2NhbERlc2NyaXB0aW9uLnNkcDsKCiAgICAgICAgc2RwID0gU0lQLkhhY2tzLkNocm9tZS5uZWVkc0V4cGxpY2l0bHlJbmFjdGl2ZVNEUChzZHApOwogICAgICAgIHNkcCA9IFNJUC5IYWNrcy5BbGxCcm93c2Vycy51bm1hc2tEdGxzKHNkcCk7CgogICAgICAgIHZhciBzZHBXcmFwcGVyID0gewogICAgICAgICAgdHlwZTogbWV0aG9kTmFtZSA9PT0gJ2NyZWF0ZU9mZmVyJyA/ICdvZmZlcicgOiAnYW5zd2VyJywKICAgICAgICAgIHNkcDogc2RwCiAgICAgICAgfTsKCiAgICAgICAgc2VsZi5lbWl0KCdnZXREZXNjcmlwdGlvbicsIHNkcFdyYXBwZXIpOwoKICAgICAgICBzZWxmLnJlYWR5ID0gdHJ1ZTsKICAgICAgICByZXR1cm4gc2RwV3JhcHBlci5zZHA7CiAgICAgIH0pCiAgICAgIC5jYXRjaChmdW5jdGlvbiBtZXRob2RGYWlsZWQgKGUpIHsKICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcihlKTsKICAgICAgICBzZWxmLnJlYWR5ID0gdHJ1ZTsKICAgICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuR2V0RGVzY3JpcHRpb25FcnJvcihlKTsKICAgICAgfSkKICAgIDsKICB9fSwKCiAgYWRkU3RyZWFtczoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gYWRkU3RyZWFtcyAoc3RyZWFtcykgewogICAgdHJ5IHsKICAgICAgc3RyZWFtcyA9IFtdLmNvbmNhdChzdHJlYW1zKTsKICAgICAgc3RyZWFtcy5mb3JFYWNoKGZ1bmN0aW9uIChzdHJlYW0pIHsKICAgICAgICB0aGlzLnBlZXJDb25uZWN0aW9uLmFkZFN0cmVhbShzdHJlYW0pOwogICAgICB9LCB0aGlzKTsKICAgIH0gY2F0Y2goZSkgewogICAgICB0aGlzLmxvZ2dlci5lcnJvcignZXJyb3IgYWRkaW5nIHN0cmVhbScpOwogICAgICB0aGlzLmxvZ2dlci5lcnJvcihlKTsKICAgICAgcmV0dXJuIFNJUC5VdGlscy5Qcm9taXNlLnJlamVjdChlKTsKICAgIH0KCiAgICByZXR1cm4gU0lQLlV0aWxzLlByb21pc2UucmVzb2x2ZSgpOwogIH19LAoKICB0b2dnbGVNdXRlSGVscGVyOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiB0b2dnbGVNdXRlSGVscGVyICh0cmFja0dldHRlciwgbXV0ZSkgewogICAgdGhpcy5nZXRMb2NhbFN0cmVhbXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChzdHJlYW0pIHsKICAgICAgc3RyZWFtW3RyYWNrR2V0dGVyXSgpLmZvckVhY2goZnVuY3Rpb24gKHRyYWNrKSB7CiAgICAgICAgdHJhY2suZW5hYmxlZCA9ICFtdXRlOwogICAgICB9KTsKICAgIH0pOwogIH19LAoKICB0b2dnbGVNdXRlQXVkaW86IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIHRvZ2dsZU11dGVBdWRpbyAobXV0ZSkgewogICAgdGhpcy50b2dnbGVNdXRlSGVscGVyKCdnZXRBdWRpb1RyYWNrcycsIG11dGUpOwogIH19LAoKICB0b2dnbGVNdXRlVmlkZW86IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIHRvZ2dsZU11dGVWaWRlbyAobXV0ZSkgewogICAgdGhpcy50b2dnbGVNdXRlSGVscGVyKCdnZXRWaWRlb1RyYWNrcycsIG11dGUpOwogIH19Cn0pOwoKLy8gUmV0dXJuIHNpbmNlIGl0IHdpbGwgYmUgYXNzaWduZWQgdG8gYSB2YXJpYWJsZS4KcmV0dXJuIE1lZGlhSGFuZGxlcjsKfTsKCn0se31dLDQxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBNZWRpYVN0cmVhbU1hbmFnZXIKICovCgovKiBNZWRpYVN0cmVhbU1hbmFnZXIKICogQGNsYXNzIE1hbmFnZXMgdGhlIGFjcXVpc2l0aW9uIGFuZCByZWxlYXNlIG9mIE1lZGlhU3RyZWFtcy4KICogQHBhcmFtIHttZWRpYUhpbnR9IFtkZWZhdWx0TWVkaWFIaW50XSBUaGUgbWVkaWFIaW50IHRvIHVzZSBpZiBub25lIGlzIHByb3ZpZGVkIHRvIGFjcXVpcmUoKQogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQLCBlbnZpcm9ubWVudCkgewoKLy8gRGVmYXVsdCBNZWRpYVN0cmVhbU1hbmFnZXIgcHJvdmlkZXMgc2luZ2xlLXVzZSBzdHJlYW1zIGNyZWF0ZWQgd2l0aCBnZXRVc2VyTWVkaWEKdmFyIE1lZGlhU3RyZWFtTWFuYWdlciA9IGZ1bmN0aW9uIE1lZGlhU3RyZWFtTWFuYWdlciAobG9nZ2VyLCBkZWZhdWx0TWVkaWFIaW50KSB7CiAgaWYgKCFTSVAuV2ViUlRDLmlzU3VwcG9ydGVkKCkpIHsKICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5Ob3RTdXBwb3J0ZWRFcnJvcignTWVkaWEgbm90IHN1cHBvcnRlZCcpOwogIH0KCiAgdGhpcy5tZWRpYUhpbnQgPSBkZWZhdWx0TWVkaWFIaW50IHx8IHsKICAgIGNvbnN0cmFpbnRzOiB7YXVkaW86IHRydWUsIHZpZGVvOiB0cnVlfQogIH07CgogIC8vIG1hcCBvZiBzdHJlYW1zIHRvIGFjcXVpc2l0aW9uIG1hbm5lcjoKICAvLyB0cnVlIC0+IHBhc3NlZCBpbiBhcyBtZWRpYUhpbnQuc3RyZWFtCiAgLy8gZmFsc2UgLT4gZ2V0VXNlck1lZGlhCiAgdGhpcy5hY3F1aXNpdGlvbnMgPSB7fTsKfTsKTWVkaWFTdHJlYW1NYW5hZ2VyLnN0cmVhbUlkID0gZnVuY3Rpb24gKHN0cmVhbSkgewogIHJldHVybiBzdHJlYW0uZ2V0QXVkaW9UcmFja3MoKS5jb25jYXQoc3RyZWFtLmdldFZpZGVvVHJhY2tzKCkpCiAgICAubWFwKGZ1bmN0aW9uIHRyYWNrSWQgKHRyYWNrKSB7CiAgICAgIHJldHVybiB0cmFjay5pZDsKICAgIH0pCiAgICAuam9pbignJyk7Cn07CgovKioKICogQHBhcmFtIHsoQXJyYXkgb2YpIE1lZGlhU3RyZWFtfSBzdHJlYW1zIC0gVGhlIHN0cmVhbXMgdG8gcmVuZGVyCiAqCiAqIEBwYXJhbSB7KEFycmF5IG9mKSBIVE1MTWVkaWFFbGVtZW50fSBlbGVtZW50cwogKiAgICAgICAgLSBUaGUgPGF1ZGlvPi88dmlkZW8+IGVsZW1lbnQocykgdGhhdCBzaG91bGQgcmVuZGVyIHRoZSBzdHJlYW1zCiAqCiAqIEVhY2ggc3RyZWFtIGluIHN0cmVhbXMgcmVuZGVycyB0byB0aGUgY29ycmVzcG9uZGluZyBlbGVtZW50IGluIGVsZW1lbnRzLAogKiB3cmFwcGluZyBhcm91bmQgZWxlbWVudHMgaWYgbmVlZGVkLgogKi8KTWVkaWFTdHJlYW1NYW5hZ2VyLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlciAoc3RyZWFtcywgZWxlbWVudHMpIHsKICBpZiAoIWVsZW1lbnRzKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIGlmIChBcnJheS5pc0FycmF5KGVsZW1lbnRzKSAmJiAhZWxlbWVudHMubGVuZ3RoKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdlbGVtZW50cyBtdXN0IG5vdCBiZSBlbXB0eScpOwogIH0KCiAgZnVuY3Rpb24gYXR0YWNoTWVkaWFTdHJlYW0oZWxlbWVudCwgc3RyZWFtKSB7CiAgICBpZiAodHlwZW9mIGVsZW1lbnQuc3JjICE9PSAndW5kZWZpbmVkJykgewogICAgICBlbnZpcm9ubWVudC5yZXZva2VPYmplY3RVUkwoZWxlbWVudC5zcmMpOwogICAgICBlbGVtZW50LnNyYyA9IGVudmlyb25tZW50LmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pOwogICAgfSBlbHNlIGlmICh0eXBlb2YgKGVsZW1lbnQuc3JjT2JqZWN0IHx8IGVsZW1lbnQubW96U3JjT2JqZWN0KSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgZWxlbWVudC5zcmNPYmplY3QgPSBlbGVtZW50Lm1velNyY09iamVjdCA9IHN0cmVhbTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGZ1bmN0aW9uIGVuc3VyZU1lZGlhUGxheWluZyAobWVkaWFFbGVtZW50KSB7CiAgICB2YXIgaW50ZXJ2YWwgPSAxMDA7CiAgICBtZWRpYUVsZW1lbnQuZW5zdXJlUGxheWluZ0ludGVydmFsSWQgPSBTSVAuVGltZXJzLnNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKG1lZGlhRWxlbWVudC5wYXVzZWQpIHsKICAgICAgICBtZWRpYUVsZW1lbnQucGxheSgpOwogICAgICB9CiAgICAgIGVsc2UgewogICAgICAgIFNJUC5UaW1lcnMuY2xlYXJJbnRlcnZhbChtZWRpYUVsZW1lbnQuZW5zdXJlUGxheWluZ0ludGVydmFsSWQpOwogICAgICB9CiAgICB9LCBpbnRlcnZhbCk7CiAgfQoKICBmdW5jdGlvbiBhdHRhY2hBbmRQbGF5IChlbGVtZW50cywgc3RyZWFtLCBpbmRleCkgewogICAgaWYgKHR5cGVvZiBlbGVtZW50cyA9PT0gJ2Z1bmN0aW9uJykgewogICAgICBlbGVtZW50cyA9IGVsZW1lbnRzKCk7CiAgICB9CiAgICB2YXIgZWxlbWVudCA9IGVsZW1lbnRzW2luZGV4ICUgZWxlbWVudHMubGVuZ3RoXTsKICAgIChlbnZpcm9ubWVudC5hdHRhY2hNZWRpYVN0cmVhbSB8fCBhdHRhY2hNZWRpYVN0cmVhbSkoZWxlbWVudCwgc3RyZWFtKTsKICAgIGVuc3VyZU1lZGlhUGxheWluZyhlbGVtZW50KTsKICB9CgogIC8vIFtdLmNvbmNhdCAiY2FzdHMiIGBlbGVtZW50c2AgaW50byBhbiBhcnJheQogIC8vIHNvIGZvckVhY2ggd29ya3MgZXZlbiBpZiBgZWxlbWVudHNgIHdhcyBhIHNpbmdsZSBlbGVtZW50CiAgZWxlbWVudHMgPSBbXS5jb25jYXQoZWxlbWVudHMpOwogIFtdLmNvbmNhdChzdHJlYW1zKS5mb3JFYWNoKGF0dGFjaEFuZFBsYXkuYmluZChudWxsLCBlbGVtZW50cykpOwp9OwoKTWVkaWFTdHJlYW1NYW5hZ2VyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU0lQLkV2ZW50RW1pdHRlci5wcm90b3R5cGUsIHsKICAnYWNxdWlyZSc6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGFjcXVpcmUgKG1lZGlhSGludCkgewogICAgbWVkaWFIaW50ID0gT2JqZWN0LmtleXMobWVkaWFIaW50IHx8IHt9KS5sZW5ndGggPyBtZWRpYUhpbnQgOiB0aGlzLm1lZGlhSGludDsKCiAgICB2YXIgc2F2ZVN1Y2Nlc3MgPSBmdW5jdGlvbiAoaXNIaW50U3RyZWFtLCBzdHJlYW1zKSB7CiAgICAgIHN0cmVhbXMgPSBbXS5jb25jYXQoc3RyZWFtcyk7CiAgICAgIHN0cmVhbXMuZm9yRWFjaChmdW5jdGlvbiAoc3RyZWFtKSB7CiAgICAgICAgdmFyIHN0cmVhbUlkID0gTWVkaWFTdHJlYW1NYW5hZ2VyLnN0cmVhbUlkKHN0cmVhbSk7CiAgICAgICAgdGhpcy5hY3F1aXNpdGlvbnNbc3RyZWFtSWRdID0gISFpc0hpbnRTdHJlYW07CiAgICAgIH0sIHRoaXMpOwogICAgICByZXR1cm4gU0lQLlV0aWxzLlByb21pc2UucmVzb2x2ZShzdHJlYW1zKTsKICAgIH0uYmluZCh0aGlzKTsKCiAgICBpZiAobWVkaWFIaW50LnN0cmVhbSkgewogICAgICByZXR1cm4gc2F2ZVN1Y2Nlc3ModHJ1ZSwgbWVkaWFIaW50LnN0cmVhbSk7CiAgICB9IGVsc2UgewogICAgICAvLyBGYWxsYmFjayB0byBhdWRpby92aWRlbyBlbmFibGVkIGlmIG5vIG1lZGlhSGludCBjYW4gYmUgZm91bmQuCiAgICAgIHZhciBjb25zdHJhaW50cyA9IG1lZGlhSGludC5jb25zdHJhaW50cyB8fAogICAgICAgICh0aGlzLm1lZGlhSGludCAmJiB0aGlzLm1lZGlhSGludC5jb25zdHJhaW50cykgfHwKICAgICAgICB7YXVkaW86IHRydWUsIHZpZGVvOiB0cnVlfTsKCiAgICAgIHZhciBkZWZlcnJlZCA9IFNJUC5VdGlscy5kZWZlcigpOwoKICAgICAgLyoKICAgICAgICogTWFrZSB0aGUgY2FsbCBhc3luY2hyb25vdXMsIHNvIHRoYXQgSUNDcyBoYXZlIGEgY2hhbmNlCiAgICAgICAqIHRvIGRlZmluZSBjYWxsYmFja3MgdG8gYHVzZXJNZWRpYVJlcXVlc3RgCiAgICAgICAqLwogICAgICBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMuZW1pdCgndXNlck1lZGlhUmVxdWVzdCcsIGNvbnN0cmFpbnRzKTsKCiAgICAgICAgdmFyIGVtaXRUaGVuQ2FsbCA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGNhbGxiYWNrKSB7CiAgICAgICAgICB2YXIgY2FsbGJhY2tBcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKICAgICAgICAgIC8vIEVtaXQgd2l0aCBhbGwgb2YgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSByZWFsIGNhbGxiYWNrLgogICAgICAgICAgdmFyIG5ld0FyZ3MgPSBbZXZlbnROYW1lXS5jb25jYXQoY2FsbGJhY2tBcmdzKTsKCiAgICAgICAgICB0aGlzLmVtaXQuYXBwbHkodGhpcywgbmV3QXJncyk7CgogICAgICAgICAgcmV0dXJuIGNhbGxiYWNrLmFwcGx5KG51bGwsIGNhbGxiYWNrQXJncyk7CiAgICAgICAgfS5iaW5kKHRoaXMpOwoKICAgICAgICBpZiAoY29uc3RyYWludHMuYXVkaW8gfHwgY29uc3RyYWludHMudmlkZW8pIHsKICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoCiAgICAgICAgICAgIFNJUC5XZWJSVEMuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKQogICAgICAgICAgICAudGhlbigKICAgICAgICAgICAgICBlbWl0VGhlbkNhbGwuYmluZCh0aGlzLCAndXNlck1lZGlhJywgc2F2ZVN1Y2Nlc3MuYmluZChudWxsLCBmYWxzZSkpLAogICAgICAgICAgICAgIGVtaXRUaGVuQ2FsbC5iaW5kKHRoaXMsICd1c2VyTWVkaWFGYWlsZWQnLCBmdW5jdGlvbihlKXt0aHJvdyBlO30pCiAgICAgICAgICAgICkKICAgICAgICAgICk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIExvY2FsIHN0cmVhbXMgd2VyZSBleHBsaWNpdGx5IGV4Y2x1ZGVkLgogICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShbXSk7CiAgICAgICAgfQogICAgICB9LmJpbmQodGhpcyksIDApOwoKICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7CiAgICB9CiAgfX0sCgogICdyZWxlYXNlJzoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gcmVsZWFzZSAoc3RyZWFtcykgewogICAgc3RyZWFtcyA9IFtdLmNvbmNhdChzdHJlYW1zKTsKICAgIHN0cmVhbXMuZm9yRWFjaChmdW5jdGlvbiAoc3RyZWFtKSB7CiAgICAgIHZhciBzdHJlYW1JZCA9IE1lZGlhU3RyZWFtTWFuYWdlci5zdHJlYW1JZChzdHJlYW0pOwogICAgICBpZiAodGhpcy5hY3F1aXNpdGlvbnNbc3RyZWFtSWRdID09PSBmYWxzZSkgewogICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uICh0cmFjaykgewogICAgICAgICAgdHJhY2suc3RvcCgpOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIGRlbGV0ZSB0aGlzLmFjcXVpc2l0aW9uc1tzdHJlYW1JZF07CiAgICB9LCB0aGlzKTsKICB9fSwKfSk7CgovLyBSZXR1cm4gc2luY2UgaXQgd2lsbCBiZSBhc3NpZ25lZCB0byBhIHZhcmlhYmxlLgpyZXR1cm4gTWVkaWFTdHJlYW1NYW5hZ2VyOwp9OwoKfSx7fV0sNDI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewooZnVuY3Rpb24gKGdsb2JhbCl7CiJ1c2Ugc3RyaWN0IjsKCnZhciB0b3BsZXZlbCA9IGdsb2JhbC53aW5kb3cgfHwgZ2xvYmFsOwoKZnVuY3Rpb24gZ2V0UHJlZml4ZWRQcm9wZXJ0eSAob2JqZWN0LCBuYW1lKSB7CiAgaWYgKG9iamVjdCA9PSBudWxsKSB7CiAgICByZXR1cm47CiAgfQogIHZhciBjYXBpdGFsaXplZE5hbWUgPSBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTsKICB2YXIgcHJlZml4ZWROYW1lcyA9IFtuYW1lLCAnd2Via2l0JyArIGNhcGl0YWxpemVkTmFtZSwgJ21veicgKyBjYXBpdGFsaXplZE5hbWVdOwogIGZvciAodmFyIGkgaW4gcHJlZml4ZWROYW1lcykgewogICAgdmFyIHByb3BlcnR5ID0gb2JqZWN0W3ByZWZpeGVkTmFtZXNbaV1dOwogICAgaWYgKHByb3BlcnR5KSB7CiAgICAgIHJldHVybiBwcm9wZXJ0eS5iaW5kKG9iamVjdCk7CiAgICB9CiAgfQp9Cgptb2R1bGUuZXhwb3J0cyA9IHsKICBXZWJTb2NrZXQ6IHRvcGxldmVsLldlYlNvY2tldCwKICBUcmFuc3BvcnQ6IHJlcXVpcmUoJy4vVHJhbnNwb3J0JyksCiAgb3BlbjogdG9wbGV2ZWwub3BlbiwKICBQcm9taXNlOiB0b3BsZXZlbC5Qcm9taXNlLAogIHRpbWVyczogdG9wbGV2ZWwsCgogIC8vIENvbnNvbGUgaXMgbm90IGRlZmluZWQgaW4gRUNNQVNjcmlwdCwgc28ganVzdCBpbiBjYXNlLi4uCiAgY29uc29sZTogdG9wbGV2ZWwuY29uc29sZSB8fCB7CiAgICBkZWJ1ZzogZnVuY3Rpb24gKCkge30sCiAgICBsb2c6IGZ1bmN0aW9uICgpIHt9LAogICAgd2FybjogZnVuY3Rpb24gKCkge30sCiAgICBlcnJvcjogZnVuY3Rpb24gKCkge30KICB9LAoKICBNZWRpYVN0cmVhbTogZ2V0UHJlZml4ZWRQcm9wZXJ0eSh0b3BsZXZlbCwgJ01lZGlhU3RyZWFtJyksCiAgZ2V0VXNlck1lZGlhOiBnZXRQcmVmaXhlZFByb3BlcnR5KHRvcGxldmVsLm5hdmlnYXRvciwgJ2dldFVzZXJNZWRpYScpLAogIFJUQ1BlZXJDb25uZWN0aW9uOiBnZXRQcmVmaXhlZFByb3BlcnR5KHRvcGxldmVsLCAnUlRDUGVlckNvbm5lY3Rpb24nKSwKICBSVENTZXNzaW9uRGVzY3JpcHRpb246IGdldFByZWZpeGVkUHJvcGVydHkodG9wbGV2ZWwsICdSVENTZXNzaW9uRGVzY3JpcHRpb24nKSwKCiAgYWRkRXZlbnRMaXN0ZW5lcjogZ2V0UHJlZml4ZWRQcm9wZXJ0eSh0b3BsZXZlbCwgJ2FkZEV2ZW50TGlzdGVuZXInKSwKICBIVE1MTWVkaWFFbGVtZW50OiB0b3BsZXZlbC5IVE1MTWVkaWFFbGVtZW50LAoKICBhdHRhY2hNZWRpYVN0cmVhbTogdG9wbGV2ZWwuYXR0YWNoTWVkaWFTdHJlYW0sCiAgY3JlYXRlT2JqZWN0VVJMOiB0b3BsZXZlbC5VUkwgJiYgdG9wbGV2ZWwuVVJMLmNyZWF0ZU9iamVjdFVSTCwKICByZXZva2VPYmplY3RVUkw6IHRvcGxldmVsLlVSTCAmJiB0b3BsZXZlbC5VUkwucmV2b2tlT2JqZWN0VVJMCn07Cgp9KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gInVuZGVmaW5lZCIgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gInVuZGVmaW5lZCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB7fSkKfSx7Ii4vVHJhbnNwb3J0IjozNX1dLDQzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwptb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vU0lQJykocmVxdWlyZSgnLi9lbnZpcm9ubWVudCcpKTsKCn0seyIuL1NJUCI6MjYsIi4vZW52aXJvbm1lbnQiOjQyfV0sNDQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7Cgl2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCgp2YXIgX3NpcCA9IHJlcXVpcmUoJ3NpcC5qcycpOwoKdmFyIF9zaXAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2lwKTsKCnZhciBfSW52aXRlQ2xpZW50Q29udGV4dCA9IHJlcXVpcmUoJy4vSW52aXRlQ2xpZW50Q29udGV4dCcpOwoKdmFyIF9JbnZpdGVDbGllbnRDb250ZXh0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0ludml0ZUNsaWVudENvbnRleHQpOwoKdmFyIF9JbnZpdGVTZXJ2ZXJDb250ZXh0ID0gcmVxdWlyZSgnLi9JbnZpdGVTZXJ2ZXJDb250ZXh0Jyk7Cgp2YXIgX0ludml0ZVNlcnZlckNvbnRleHQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfSW52aXRlU2VydmVyQ29udGV4dCk7Cgp2YXIgX1NJUFV0aWxzID0gcmVxdWlyZSgnLi9TSVBVdGlscycpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKdmFyIENvbm5lY3Rpb25Db250cm9sbGVyID0gZnVuY3Rpb24gKCkgewoJZnVuY3Rpb24gQ29ubmVjdGlvbkNvbnRyb2xsZXIoY29uZmlndXJhdGlvbiwgb25DYWxsLCBvbkRpc2Nvbm5lY3QpIHsKCQlfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29ubmVjdGlvbkNvbnRyb2xsZXIpOwoKCQlpZiAoIWNvbmZpZ3VyYXRpb24pIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZ3VyYXRpb24gaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CgoJCV9zaXAyLmRlZmF1bHQuSW52aXRlU2VydmVyQ29udGV4dCA9IF9JbnZpdGVTZXJ2ZXJDb250ZXh0Mi5kZWZhdWx0OwoJCXRoaXMuY29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247CgkJdGhpcy5vbkRpc2Nvbm5lY3QgPSBvbkRpc2Nvbm5lY3Q7CgkJdGhpcy5vbkNhbGwgPSBvbkNhbGw7Cgl9CgoJX2NyZWF0ZUNsYXNzKENvbm5lY3Rpb25Db250cm9sbGVyLCBbewoJCWtleTogJ2Nvbm5lY3QnLAoJCXZhbHVlOiBmdW5jdGlvbiBjb25uZWN0KGFjY2Vzc1Rva2VuKSB7CgkJCXZhciBfdGhpcyA9IHRoaXM7CgoJCQlyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoJCQkJaWYgKF90aGlzLnVzZXJBZ2VudCkgcmV0dXJuIHJlc29sdmUoKTsKCgkJCQlmZXRjaChfdGhpcy5jb25maWd1cmF0aW9uLmNyZWRlbnRpYWxfc2VydmVyLCB7IG1ldGhvZDogJ0dFVCcsIGhlYWRlcnM6IHsgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyOiAnICsgYWNjZXNzVG9rZW4gfSB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKCQkJCQlyZXMuanNvbigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHsKCQkJCQkJX3RoaXMudXNlckFnZW50ID0gbmV3IF9zaXAyLmRlZmF1bHQuVUEoewoJCQkJCQkJdXJpOiB1c2VyLnVzZXJuYW1lLAoJCQkJCQkJd3NTZXJ2ZXJzOiB1c2VyLnVyaXMsCgkJCQkJCQlwYXNzd29yZDogdXNlci5wYXNzd29yZAoJCQkJCQl9KTsKCQkJCQkJX3RoaXMudXNlckFnZW50Lm9uKCdpbnZpdGUnLCBmdW5jdGlvbiAoY29udGV4dCkgewoJCQkJCQkJaWYgKF90aGlzLmNvbnRleHQpIHJldHVybjsKCgkJCQkJCQljb250ZXh0Lm9uKCdieWUnLCBmdW5jdGlvbiAoKSB7CgkJCQkJCQkJZGVsZXRlIF90aGlzLmNvbnRleHQ7CgkJCQkJCQkJX3RoaXMub25EaXNjb25uZWN0KCk7CgkJCQkJCQl9KTsKCQkJCQkJCWNvbnRleHQub24oJ2ZhaWxlZCcsIGNvbnNvbGUubG9nKTsKCQkJCQkJCWNvbnRleHQub24oJ3JlamVjdGVkJywgY29uc29sZS5sb2cpOwoJCQkJCQkJX3RoaXMuY29udGV4dCA9IGNvbnRleHQ7CgkJCQkJCQlfdGhpcy5vbkNhbGwoY29udGV4dC5yZXF1ZXN0LnRvLmZyaWVuZGx5TmFtZSwgY29udGV4dC5ib2R5KTsKCQkJCQkJfSk7CgkJCQkJCXJlc29sdmUoKTsKCQkJCQl9KTsKCQkJCX0pLmNhdGNoKHJlamVjdCk7CgkJCX0pOwoJCX0KCX0sIHsKCQlrZXk6ICdhY2NlcHQnLAoJCXZhbHVlOiBmdW5jdGlvbiBhY2NlcHQoZGF0YU9iamVjdE9ic2VydmVyKSB7CgkJCXRoaXMuY29udGV4dC5hY2NlcHQoewoJCQkJc2RwOiAoMCwgX1NJUFV0aWxzLmFkZENhbmRpZGF0ZXNUb1NEUCkoZGF0YU9iamVjdE9ic2VydmVyLmRhdGEuY29ubmVjdGlvbkRlc2NyaXB0aW9uLnNkcCwgZGF0YU9iamVjdE9ic2VydmVyLmRhdGEuaWNlQ2FuZGlkYXRlcykKCQkJfSk7CgkJfQoJfSwgewoJCWtleTogJ2ludml0ZScsCgkJdmFsdWU6IGZ1bmN0aW9uIGludml0ZSh0bywgZGF0YU9iamVjdE9ic2VydmVyKSB7CgkJCXZhciBfdGhpczIgPSB0aGlzOwoKCQkJdmFyIG9wdGlvbnMgPSB7CgkJCQlzZHA6ICgwLCBfU0lQVXRpbHMuYWRkQ2FuZGlkYXRlc1RvU0RQKShkYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YS5jb25uZWN0aW9uRGVzY3JpcHRpb24uc2RwLCBkYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YS5pY2VDYW5kaWRhdGVzKQoJCQl9OwoKCQkJcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCQkJCWlmIChfdGhpczIuY29udGV4dCkgcmVqZWN0KG5ldyBFcnJvcignUHJldmlvdXMgY29udGV4dCcsIF90aGlzMi5jb250ZXh0KSk7CgoJCQkJdmFyIGNvbnRleHQgPSBuZXcgX0ludml0ZUNsaWVudENvbnRleHQyLmRlZmF1bHQoX3RoaXMyLnVzZXJBZ2VudCwgdG8ucmVwbGFjZSgnLy8nLCAnJyksIG9wdGlvbnMpOwoJCQkJX3RoaXMyLnVzZXJBZ2VudC5hZnRlckNvbm5lY3RlZChjb250ZXh0Lmludml0ZS5iaW5kKGNvbnRleHQpKTsKCQkJCWNvbnRleHQub24oJ2J5ZScsIGZ1bmN0aW9uICgpIHsKCQkJCQlkZWxldGUgX3RoaXMyLmNvbnRleHQ7CgkJCQkJX3RoaXMyLm9uRGlzY29ubmVjdCgpOwoJCQkJfSk7CgkJCQljb250ZXh0Lm9uKCdhY2NlcHRlZCcsIHJlc29sdmUpOwoJCQkJY29udGV4dC5vbignZmFpbGVkJywgcmVqZWN0KTsKCQkJCWNvbnRleHQub24oJ3JlamVjdGVkJywgcmVqZWN0KTsKCgkJCQlfdGhpczIuY29udGV4dCA9IGNvbnRleHQ7CgkJCX0pOwoJCX0KCX0sIHsKCQlrZXk6ICdkaXNjb25uZWN0JywKCQl2YWx1ZTogZnVuY3Rpb24gZGlzY29ubmVjdCgpIHsKCQkJY29uc29sZS5sb2coJ2Rpc2Nvbm5lY3RpbmcgZnJvbSBpbXMnKTsKCQkJaWYgKHRoaXMuY29udGV4dCAmJiAhdGhpcy5jb250ZXh0LmVuZFRpbWUpIHsKCQkJCXRoaXMuY29udGV4dC5ieWUoKTsKCQkJCWRlbGV0ZSB0aGlzLmNvbnRleHQ7CgkJCX0KCQl9Cgl9XSk7CgoJcmV0dXJuIENvbm5lY3Rpb25Db250cm9sbGVyOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBDb25uZWN0aW9uQ29udHJvbGxlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi9JbnZpdGVDbGllbnRDb250ZXh0Ijo0NiwiLi9JbnZpdGVTZXJ2ZXJDb250ZXh0Ijo0NywiLi9TSVBVdGlscyI6NDgsInNpcC5qcyI6NDN9XSw0NTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gYWN0aXZhdGU7Cgp2YXIgX1N5bmNoZXIgPSByZXF1aXJlKCdzZXJ2aWNlLWZyYW1ld29yay9kaXN0L1N5bmNoZXInKTsKCnZhciBfRGlzY292ZXJ5ID0gcmVxdWlyZSgnc2VydmljZS1mcmFtZXdvcmsvZGlzdC9EaXNjb3ZlcnknKTsKCnZhciBfRGlzY292ZXJ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0Rpc2NvdmVyeSk7Cgp2YXIgX0Nvbm5lY3Rpb25Db250cm9sbGVyID0gcmVxdWlyZSgnLi9Db25uZWN0aW9uQ29udHJvbGxlcicpOwoKdmFyIF9Db25uZWN0aW9uQ29udHJvbGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Db25uZWN0aW9uQ29udHJvbGxlcik7Cgp2YXIgX0lkZW50aXR5RmFjdG9yeSA9IHJlcXVpcmUoJ3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvSWRlbnRpdHlGYWN0b3J5Jyk7Cgp2YXIgX0lkZW50aXR5RmFjdG9yeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9JZGVudGl0eUZhY3RvcnkpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfSAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqLwoKdmFyIENvbm5lY3Rpb24gPSBmdW5jdGlvbiBDb25uZWN0aW9uKGRhdGFPYmplY3RVcmwpIHsKICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29ubmVjdGlvbik7CgogIHRoaXMubmFtZSA9ICdDb25uZWN0aW9uJzsKICB0aGlzLnN0YXR1cyA9ICcnOwogIHRoaXMub3duZXIgPSBkYXRhT2JqZWN0VXJsOwogIHRoaXMuY29ubmVjdGlvbkRlc2NyaXB0aW9uID0ge307CiAgdGhpcy5pY2VDYW5kaWRhdGVzID0gW107Cn07CgovKioKICogUHJvdG9TdHViIEludGVyZmFjZQogKi8KCgp2YXIgSU1TSVdQcm90b1N0dWIgPSBmdW5jdGlvbiAoKSB7CgogIC8qKgogICAqIEluaXRpYWxpc2UgdGhlIHByb3RvY29sIHN0dWIgaW5jbHVkaW5nIGFzIGlucHV0IHBhcmFtZXRlcnMgaXRzIGFsbG9jYXRlZAogICAqIGNvbXBvbmVudCBydW50aW1lIHVybCwgdGhlIHJ1bnRpbWUgQlVTIHBvc3RNZXNzYWdlIGZ1bmN0aW9uIHRvIGJlIGludm9rZWQKICAgKiBvbiBtZXNzYWdlcyByZWNlaXZlZCBieSB0aGUgcHJvdG9jb2wgc3R1YiBhbmQgcmVxdWlyZWQgY29uZmlndXJhdGlvbiByZXRyaWV2ZWQgZnJvbSBwcm90b2NvbFN0dWIgZGVzY3JpcHRvci4KICAgKiBAcGFyYW0gIHtVUkwucnVudGltZVByb3RvU3R1YlVSTH0gICAgICAgICAgICAgICAgICAgcnVudGltZVByb3RvU3R1YlVSTCBydW50aW1lUHJvdG9TdWJVUkwKICAgKiBAcGFyYW0gIHtNZXNzYWdlLk1lc3NhZ2V9ICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVzUG9zdE1lc3NhZ2UgICAgIGNvbmZpZ3VyYXRpb24KICAgKiBAcGFyYW0gIHtQcm90b1N0dWJEZXNjcmlwdG9yLkNvbmZpZ3VyYXRpb25EYXRhTGlzdH0gY29uZmlndXJhdGlvbiAgICAgIGNvbmZpZ3VyYXRpb24KICAgKi8KICBmdW5jdGlvbiBJTVNJV1Byb3RvU3R1YihydW50aW1lUHJvdG9TdHViVVJMLCBtaW5pQnVzLCBjb25maWd1cmF0aW9uKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSU1TSVdQcm90b1N0dWIpOwoKICAgIGlmICghcnVudGltZVByb3RvU3R1YlVSTCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgcnVudGltZVByb3RvU3R1YlVSTCBpcyBhIHJlcXVpcmVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFtaW5pQnVzKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBidXMgaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKICAgIGlmICghY29uZmlndXJhdGlvbikgdGhyb3cgbmV3IEVycm9yKCdUaGUgY29uZmlndXJhdGlvbiBpcyBhIHJlcXVpcmVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFjb25maWd1cmF0aW9uLmRvbWFpbikgdGhyb3cgbmV3IEVycm9yKCdUaGUgZG9tYWluIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyJyk7CgogICAgdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCA9IHJ1bnRpbWVQcm90b1N0dWJVUkw7CiAgICB0aGlzLl9kaXNjb3ZlcnkgPSBuZXcgX0Rpc2NvdmVyeTIuZGVmYXVsdChydW50aW1lUHJvdG9TdHViVVJMLCBtaW5pQnVzKTsKICAgIHRoaXMuc2NoZW1hID0gJ2h5cGVydHktY2F0YWxvZ3VlOi8vY2F0YWxvZ3VlLicgKyBjb25maWd1cmF0aW9uLmRvbWFpbiArICcvLndlbGwta25vd24vZGF0YXNjaGVtYS9Db25uZWN0aW9uJzsKICAgIHRoaXMuX2Nvbm5lY3Rpb24gPSBuZXcgX0Nvbm5lY3Rpb25Db250cm9sbGVyMi5kZWZhdWx0KGNvbmZpZ3VyYXRpb24sIGZ1bmN0aW9uICh0bywgb2ZmZXIpIHsKICAgICAgX3RoaXMyLl9yZXR1cm5TRFAob2ZmZXIsIF90aGlzMi5fcnVudGltZVByb3RvU3R1YlVSTCwgX3RoaXMyLnNjaGVtYSwgX3RoaXMyLnNvdXJjZSwgJ29mZmVyJyk7CiAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzMi5kYXRhT2JqZWN0T2JzZXJ2ZXIuZGVsZXRlKCk7CiAgICAgIF90aGlzMi5kYXRhT2JqZWN0UmVwb3J0ZXIuZGVsZXRlKCk7CiAgICB9KTsKICAgIHRoaXMuX2J1cyA9IG1pbmlCdXM7CiAgICB0aGlzLl9zeW5jaGVyID0gbmV3IF9TeW5jaGVyLlN5bmNoZXIodGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCwgbWluaUJ1cywgY29uZmlndXJhdGlvbik7CgogICAgbWluaUJ1cy5hZGRMaXN0ZW5lcignKicsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgY29uc29sZS5sb2coJ05FVyBNU0cgLT4nLCBtc2cpOwogICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CiAgICAgICAgY2FzZSAnY3JlYXRlJzoKICAgICAgICAgIGlmIChfdGhpczIuX2ZpbHRlcihtc2cpICYmIG1zZy5ib2R5LnNjaGVtYSkgewogICAgICAgICAgICBfdGhpczIuX3N1YnNjcmliZShtc2cpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnaW5pdCc6CiAgICAgICAgICBfdGhpczIuX2lkZW50aXR5ID0gbmV3IF9JZGVudGl0eUZhY3RvcnkyLmRlZmF1bHQoJ2FudG9uJywgJ3NpcDovL3JldGhpbmstcHJvamVjdC5ldS9hbnRvbkByZXRoaW5rLXByb2plY3QuZXUnLCAnJywgJ2FudG9uJywgJycsICdyZXRoaW5rLXByb2plY3QuZXUnKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCdteWlkZW50aXR5JywgX3RoaXMyLl9pZGVudGl0eSk7CiAgICAgICAgICBfdGhpczIuX2Nvbm5lY3Rpb24uY29ubmVjdChtc2cuYm9keS5pZGVudGl0eS5hY2Nlc3NfdG9rZW4pOwogICAgICAgICAgX3RoaXMyLnNvdXJjZSA9IG1zZy5ib2R5LnNvdXJjZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICBfdGhpczIuX2Nvbm5lY3Rpb24uZGlzY29ubmVjdCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0pOwogICAgdGhpcy5fc2VuZFN0YXR1cygnY3JlYXRlZCcpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKElNU0lXUHJvdG9TdHViLCBbewogICAga2V5OiAnX3NlbmRTdGF0dXMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kU3RhdHVzKHZhbHVlLCByZWFzb24pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGNvbnNvbGUubG9nKCdbSU1TSVdQcm90b3N0dWIgc3RhdHVzIGNoYW5nZWRdIHRvICcsIHZhbHVlKTsKCiAgICAgIF90aGlzLl9zdGF0ZSA9IHZhbHVlOwoKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICB0eXBlOiAndXBkYXRlJywKICAgICAgICBmcm9tOiBfdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCwKICAgICAgICB0bzogX3RoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgKyAnL3N0YXR1cycsCiAgICAgICAgYm9keTogewogICAgICAgICAgdmFsdWU6IHZhbHVlCiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKHJlYXNvbikgewogICAgICAgIG1zZy5ib2R5LmRlc2MgPSByZWFzb247CiAgICAgIH0KCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfc3Vic2NyaWJlKG1zZykgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBkYXRhT2JqZWN0VXJsID0gbXNnLmZyb20uc3Vic3RyaW5nKDAsIG1zZy5mcm9tLmxhc3RJbmRleE9mKCcvJykpOwoKICAgICAgdGhpcy5fc3luY2hlci5zdWJzY3JpYmUodGhpcy5zY2hlbWEsIGRhdGFPYmplY3RVcmwpLnRoZW4oZnVuY3Rpb24gKGRhdGFPYmplY3RPYnNlcnZlcikgewogICAgICAgIF90aGlzMy5kYXRhT2JqZWN0T2JzZXJ2ZXIgPSBkYXRhT2JqZWN0T2JzZXJ2ZXI7CiAgICAgICAgZGF0YU9iamVjdE9ic2VydmVyLm9uQ2hhbmdlKCcqJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMzLl9vbkNhbGwoZGF0YU9iamVjdE9ic2VydmVyLCBkYXRhT2JqZWN0VXJsLCBfdGhpczMuc2NoZW1hLCBtc2cpOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiBkYXRhT2JqZWN0T2JzZXJ2ZXI7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGFPYmplY3RPYnNlcnZlcikgewogICAgICAgIHJldHVybiBfdGhpczMuX29uQ2FsbChkYXRhT2JqZWN0T2JzZXJ2ZXIsIGRhdGFPYmplY3RVcmwsIF90aGlzMy5zY2hlbWEsIG1zZyk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkNhbGwnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNhbGwoZGF0YU9iamVjdE9ic2VydmVyLCBkYXRhT2JqZWN0VXJsLCBzY2hlbWEsIG1zZykgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIGNvbnNvbGUubG9nKCdfb25DYWxsJywgZGF0YU9iamVjdE9ic2VydmVyKTsKICAgICAgaWYgKGRhdGFPYmplY3RPYnNlcnZlci5kYXRhLmNvbm5lY3Rpb25EZXNjcmlwdGlvbikgewogICAgICAgIGlmIChkYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YS5jb25uZWN0aW9uRGVzY3JpcHRpb24udHlwZSA9PT0gJ29mZmVyJykgewogICAgICAgICAgY29uc29sZS5sb2coJ19vbkNhbGxVcGRhdGUgb2ZmZXInKTsKICAgICAgICAgIHRoaXMuX2Nvbm5lY3Rpb24uY29ubmVjdChtc2cuYm9keS5pZGVudGl0eS5hY2Nlc3NfdG9rZW4pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygnc2FkJywgbXNnKTsKICAgICAgICAgICAgX3RoaXM0Ll9jb25uZWN0aW9uLmludml0ZShtc2cudG8sIGRhdGFPYmplY3RPYnNlcnZlcikudGhlbihmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHJldHVybiBfdGhpczQuX3JldHVyblNEUChlLmJvZHksIGRhdGFPYmplY3RVcmwsIHNjaGVtYSwgbXNnLmJvZHkuc291cmNlLCAnYW5zd2VyJyk7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZhaWwnLCBlKTtfdGhpczQuZGF0YU9iamVjdE9ic2VydmVyLmRlbGV0ZSgpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAoZGF0YU9iamVjdE9ic2VydmVyLmRhdGEuY29ubmVjdGlvbkRlc2NyaXB0aW9uLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnX29uQ2FsbFVwZGF0ZSBvZmZlcicpOwogICAgICAgICAgdGhpcy5fY29ubmVjdGlvbi5hY2NlcHQoZGF0YU9iamVjdE9ic2VydmVyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmV0dXJuU0RQJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmV0dXJuU0RQKG9mZmVyLCBkYXRhT2JqZWN0VXJsLCBzY2hlbWEsIHNvdXJjZSwgdHlwZSkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHZhciBkYXRhT2JqZWN0ID0gbmV3IENvbm5lY3Rpb24oZGF0YU9iamVjdFVybCk7CgogICAgICB0aGlzLl9zeW5jaGVyLmNyZWF0ZShzY2hlbWEsIFtzb3VyY2VdLCBkYXRhT2JqZWN0LCBmYWxzZSwgZmFsc2UsIHRoaXMuX2lkZW50aXR5KS50aGVuKGZ1bmN0aW9uIChvYmpSZXBvcnRlcikgewogICAgICAgIF90aGlzNS5kYXRhT2JqZWN0UmVwb3J0ZXIgPSBvYmpSZXBvcnRlcjsKICAgICAgICBvYmpSZXBvcnRlci5vblN1YnNjcmlwdGlvbihmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIGNvbnNvbGUuaW5mbygnLS0tLS0tLS0gUmVjZWl2ZXIgcmVjZWl2ZWQgc3Vic2NyaXB0aW9uIHJlcXVlc3QgLS0tLS0tLS0tIFxuJyk7CiAgICAgICAgICBldmVudC5hY2NlcHQoKTsKICAgICAgICB9KTsKICAgICAgICBvYmpSZXBvcnRlci5kYXRhLmNvbm5lY3Rpb25EZXNjcmlwdGlvbiA9IHsgdHlwZTogdHlwZSwgc2RwOiBvZmZlciB9OwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmlsdGVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlsdGVyKG1zZykgewogICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkudmlhID09PSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMKSByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIElNU0lXUHJvdG9TdHViOwp9KCk7CgpmdW5jdGlvbiBhY3RpdmF0ZSh1cmwsIGJ1cywgY29uZmlnKSB7CiAgcmV0dXJuIHsKICAgIG5hbWU6ICdJTVNJV1Byb3RvU3R1YicsCiAgICBpbnN0YW5jZTogbmV3IElNU0lXUHJvdG9TdHViKHVybCwgYnVzLCBjb25maWcpCiAgfTsKfQptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuL0Nvbm5lY3Rpb25Db250cm9sbGVyIjo0NCwic2VydmljZS1mcmFtZXdvcmsvZGlzdC9EaXNjb3ZlcnkiOjYsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvSWRlbnRpdHlGYWN0b3J5Ijo3LCJzZXJ2aWNlLWZyYW1ld29yay9kaXN0L1N5bmNoZXIiOjh9XSw0NjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfc2lwID0gcmVxdWlyZSgnc2lwLmpzJyk7Cgp2YXIgX3NpcDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zaXApOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBTZXNzaW9uID0gX3NpcDIuZGVmYXVsdC5TZXNzaW9uOwp2YXIgQyA9IHsKICBTVEFUVVNfTlVMTDogMCwKICBTVEFUVVNfSU5WSVRFX1NFTlQ6IDEsCiAgU1RBVFVTXzFYWF9SRUNFSVZFRDogMiwKICBTVEFUVVNfSU5WSVRFX1JFQ0VJVkVEOiAzLAogIFNUQVRVU19XQUlUSU5HX0ZPUl9BTlNXRVI6IDQsCiAgU1RBVFVTX0FOU1dFUkVEOiA1LAogIFNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSzogNiwKICBTVEFUVVNfV0FJVElOR19GT1JfQUNLOiA3LAogIFNUQVRVU19DQU5DRUxFRDogOCwKICBTVEFUVVNfVEVSTUlOQVRFRDogOSwKICBTVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0s6IDEwLAogIFNUQVRVU19FQVJMWV9NRURJQTogMTEsCiAgU1RBVFVTX0NPTkZJUk1FRDogMTIKfTsKCnZhciBJbnZpdGVDbGllbnRDb250ZXh0ID0gZnVuY3Rpb24gSW52aXRlQ2xpZW50Q29udGV4dCh1YSwgdGFyZ2V0LCBvcHRpb25zKSB7CiAgb3B0aW9ucyA9IE9iamVjdC5jcmVhdGUoU2Vzc2lvbi5kZXN1Z2FyKG9wdGlvbnMpKTsKICBvcHRpb25zLnBhcmFtcyA9IE9iamVjdC5jcmVhdGUob3B0aW9ucy5wYXJhbXMgfHwgT2JqZWN0LnByb3RvdHlwZSk7CgogIHZhciBleHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCk7CgogIC8vIEN1c3RvbSBkYXRhIHRvIGJlIHNlbnQgZWl0aGVyIGluIElOVklURSBvciBpbiBBQ0sKICB0aGlzLnJlbmRlcmJvZHkgPSBvcHRpb25zLnJlbmRlcmJvZHkgfHwgbnVsbDsKICB0aGlzLnJlbmRlcnR5cGUgPSBvcHRpb25zLnJlbmRlcnR5cGUgfHwgJ3RleHQvcGxhaW4nOwoKICB0aGlzLnNkcCA9IG9wdGlvbnMuc2RwOwogIG9wdGlvbnMucGFyYW1zLmZyb21fdGFnID0gdGhpcy5mcm9tX3RhZzsKCiAgLyogRG8gbm90IGFkZCA7b2IgaW4gaW5pdGlhbCBmb3JtaW5nIGRpYWxvZyByZXF1ZXN0cyBpZiB0aGUgcmVnaXN0cmF0aW9uIG92ZXIKICAgKiAgdGhlIGN1cnJlbnQgY29ubmVjdGlvbiBnb3QgYSBHUlVVIFVSSS4KICAgKi8KICB0aGlzLmNvbnRhY3QgPSB1YS5jb250YWN0LnRvU3RyaW5nKHsKICAgIGFub255bW91czogdGhpcy5hbm9ueW1vdXMsCiAgICBvdXRib3VuZDogdGhpcy5hbm9ueW1vdXMgPyAhdWEuY29udGFjdC50ZW1wX2dydXUgOiAhdWEuY29udGFjdC5wdWJfZ3J1dQogIH0pOwoKICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJyArIHRoaXMuY29udGFjdCk7CiAgZXh0cmFIZWFkZXJzLnB1c2goJ0FsbG93OiAnICsgX3NpcDIuZGVmYXVsdC5VQS5DLkFMTE9XRURfTUVUSE9EUy50b1N0cmluZygpKTsKCiAgaWYgKHVhLmNvbmZpZ3VyYXRpb24ucmVsMTAwID09PSBfc2lwMi5kZWZhdWx0LkMuc3VwcG9ydGVkLlJFUVVJUkVEKSB7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnUmVxdWlyZTogMTAwcmVsJyk7CiAgfQogIGlmICh1YS5jb25maWd1cmF0aW9uLnJlcGxhY2VzID09PSBfc2lwMi5kZWZhdWx0LkMuc3VwcG9ydGVkLlJFUVVJUkVEKSB7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnUmVxdWlyZTogcmVwbGFjZXMnKTsKICB9CiAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vc2RwJyk7CiAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSBleHRyYUhlYWRlcnM7CgogIF9zaXAyLmRlZmF1bHQuVXRpbHMuYXVnbWVudCh0aGlzLCBfc2lwMi5kZWZhdWx0LkNsaWVudENvbnRleHQsIFt1YSwgX3NpcDIuZGVmYXVsdC5DLklOVklURSwgdGFyZ2V0LCBvcHRpb25zXSk7CiAgX3NpcDIuZGVmYXVsdC5VdGlscy5hdWdtZW50KHRoaXMsIF9zaXAyLmRlZmF1bHQuU2Vzc2lvbiwgW10pOwoKICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfTlVMTCkgewogICAgdGhyb3cgbmV3IF9zaXAyLmRlZmF1bHQuRXhjZXB0aW9ucy5JbnZhbGlkU3RhdGVFcnJvcih0aGlzLnN0YXR1cyk7CiAgfQoKICAvLyBTZXNzaW9uIHBhcmFtZXRlciBpbml0aWFsaXphdGlvbgogIHRoaXMuZnJvbV90YWcgPSBfc2lwMi5kZWZhdWx0LlV0aWxzLm5ld1RhZygpOwoKICAvLyBPdXRnb2luZ1Nlc3Npb24gc3BlY2lmaWMgcGFyYW1ldGVycwogIHRoaXMuaXNDYW5jZWxlZCA9IGZhbHNlOwogIHRoaXMucmVjZWl2ZWRfMTAwID0gZmFsc2U7CgogIHRoaXMubWV0aG9kID0gX3NpcDIuZGVmYXVsdC5DLklOVklURTsKCiAgdGhpcy5yZWNlaXZlTm9uSW52aXRlUmVzcG9uc2UgPSB0aGlzLnJlY2VpdmVSZXNwb25zZTsKICB0aGlzLnJlY2VpdmVSZXNwb25zZSA9IHRoaXMucmVjZWl2ZUludml0ZVJlc3BvbnNlOwoKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLmludml0ZWNsaWVudGNvbnRleHQnKTsKCiAgdGhpcy5vbkluZm8gPSBvcHRpb25zLm9uSW5mbzsKfTsKCkludml0ZUNsaWVudENvbnRleHQucHJvdG90eXBlID0gewogIGludml0ZTogZnVuY3Rpb24gaW52aXRlKCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgIC8vU2F2ZSB0aGUgc2Vzc2lvbiBpbnRvIHRoZSB1YSBzZXNzaW9ucyBjb2xsZWN0aW9uLgogICAgLy9Ob3RlOiBwbGFjaW5nIGluIGNvbnN0cnVjdG9yIGJyZWFrcyBjYWxsIHRvIHJlcXVlc3QuY2FuY2VsIG9uIGNsb3NlLi4uIFVzZXIgZG9lcyBub3QgbmVlZCB0aGlzIGFueXdheQogICAgdGhpcy51YS5zZXNzaW9uc1t0aGlzLmlkXSA9IHRoaXM7CgogICAgLy9Ob3RlOiBkdWUgdG8gdGhlIHdheSBGaXJlZm94IGhhbmRsZXMgZ1VNIGNhbGxzLCBpdCBpcyByZWNvbW1lbmRlZCB0byBtYWtlIHRoZSBnVU0gY2FsbCBhdCB0aGUgYXBwIGxldmVsCiAgICAvLyBhbmQgaGFuZCBzaXAuanMgYSBzdHJlYW0gYXMgdGhlIG1lZGlhSGludAogICAgaWYgKHNlbGYuaXNDYW5jZWxlZCB8fCBzZWxmLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICByZXR1cm47CiAgICB9CiAgICBzZWxmLmhhc09mZmVyID0gdHJ1ZTsKICAgIHNlbGYucmVxdWVzdC5ib2R5ID0gdGhpcy5zZHA7CiAgICBzZWxmLnN0YXR1cyA9IEMuU1RBVFVTX0lOVklURV9TRU5UOwogICAgc2VsZi5zZW5kKCk7CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgaGFzRGVzY3JpcHRpb246IGZ1bmN0aW9uIGhhc0Rlc2NyaXB0aW9uKG1lc3NhZ2UpIHsKICAgIHJldHVybiBtZXNzYWdlLmdldEhlYWRlcignQ29udGVudC1UeXBlJykgPT09ICdhcHBsaWNhdGlvbi9zZHAnICYmICEhbWVzc2FnZS5ib2R5OwogIH0sCgogIHJlY2VpdmVJbnZpdGVSZXNwb25zZTogZnVuY3Rpb24gcmVjZWl2ZUludml0ZVJlc3BvbnNlKHJlc3BvbnNlKSB7CiAgICB2YXIgY2F1c2UsCiAgICAgICAgLy9sb2NhbE1lZGlhLAogICAgc2Vzc2lvbiA9IHRoaXMsCiAgICAgICAgaWQgPSByZXNwb25zZS5jYWxsX2lkICsgcmVzcG9uc2UuZnJvbV90YWcgKyByZXNwb25zZS50b190YWcsCiAgICAgICAgZXh0cmFIZWFkZXJzID0gW10sCiAgICAgICAgb3B0aW9ucyA9IHt9OwoKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCB8fCByZXNwb25zZS5tZXRob2QgIT09IF9zaXAyLmRlZmF1bHQuQy5JTlZJVEUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0aGlzLmRpYWxvZyAmJiByZXNwb25zZS5zdGF0dXNfY29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPD0gMjk5KSB7CiAgICAgIGlmIChpZCAhPT0gdGhpcy5kaWFsb2cuaWQudG9TdHJpbmcoKSkgewogICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnLCB0cnVlKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0uc2VuZFJlcXVlc3QodGhpcywgX3NpcDIuZGVmYXVsdC5DLkFDSywgewogICAgICAgICAgYm9keTogX3NpcDIuZGVmYXVsdC5VdGlscy5nZW5lcmF0ZUZha2VTRFAocmVzcG9uc2UuYm9keSkKICAgICAgICB9KTsKICAgICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0uc2VuZFJlcXVlc3QodGhpcywgX3NpcDIuZGVmYXVsdC5DLkJZRSk7CgogICAgICAgIC8qIE5PVEU6IFRoaXMgZmFpbHMgYmVjYXVzZSB0aGUgZm9ya2luZyBwcm94eSBkb2VzIG5vdCByZWNvZ25pemUgdGhhdCBhbiB1bmFuc3dlcmFibGUKICAgICAgICAgKiBsZWcgKGR1ZSB0byBwZWVyQ29ubmVjdGlvbiBsaW1pdGF0aW9ucykgaGFzIGJlZW4gYW5zd2VyZWQgZmlyc3QuIElmIHlvdXIgZm9ya2luZwogICAgICAgICAqIHByb3h5IGRvZXMgbm90IGhhbmcgdXAgYWxsIHVuYW5zd2VyZWQgYnJhbmNoZXMgb24gdGhlIGZpcnN0IGJyYW5jaCBhbnN3ZXJlZCwgcmVtb3ZlIHRoaXMuCiAgICAgICAgICovCiAgICAgICAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVzcG9uc2UsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KF9zaXAyLmRlZmF1bHQuQy5BQ0ssIHsgY3NlcTogcmVzcG9uc2UuY3NlcSB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuaGFzQW5zd2VyKSB7CiAgICAgICAgLy8gaW52aXRlIHcvbyBzZHAgaXMgd2FpdGluZyBmb3IgY2FsbGJhY2sKICAgICAgICAvL2FuIGludml0ZSB3aXRoIHNkcCBtdXN0IGdvIG9uLCBhbmQgaGFzQW5zd2VyIGlzIHRydWUKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5kaWFsb2cgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPCAyMDApIHsKICAgICAgLyoKICAgICAgICBFYXJseSBtZWRpYSBoYXMgYmVlbiBzZXQgdXAgd2l0aCBhdCBsZWFzdCBvbmUgb3RoZXIgZGlmZmVyZW50IGJyYW5jaCwKICAgICAgICBidXQgYSBmaW5hbCAyeHggcmVzcG9uc2UgaGFzbid0IGJlZW4gcmVjZWl2ZWQKICAgICAgKi8KICAgICAgaWYgKHRoaXMuZGlhbG9nLnByYWNrZWQuaW5kZXhPZihyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSkgIT09IC0xIHx8IHRoaXMuZGlhbG9nLnByYWNrZWRbdGhpcy5kaWFsb2cucHJhY2tlZC5sZW5ndGggLSAxXSA+PSByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSAmJiB0aGlzLmRpYWxvZy5wcmFja2VkLmxlbmd0aCA+IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5lYXJseURpYWxvZ3NbaWRdICYmICF0aGlzLmNyZWF0ZURpYWxvZyhyZXNwb25zZSwgJ1VBQycsIHRydWUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQuaW5kZXhPZihyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSkgIT09IC0xIHx8IHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkW3RoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLmxlbmd0aCAtIDFdID49IHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpICYmIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLmxlbmd0aCA+IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSQWNrOiAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgKyAnICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ2NzZXEnKSk7CiAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLnB1c2gocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpOwoKICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnNlbmRSZXF1ZXN0KHRoaXMsIF9zaXAyLmRlZmF1bHQuQy5QUkFDSywgewogICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzLAogICAgICAgIGJvZHk6IF9zaXAyLmRlZmF1bHQuVXRpbHMuZ2VuZXJhdGVGYWtlU0RQKHJlc3BvbnNlLmJvZHkpCiAgICAgIH0pOwogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gUHJvY2VlZCB0byBjYW5jZWxsYXRpb24gaWYgdGhlIHVzZXIgcmVxdWVzdGVkLgogICAgaWYgKHRoaXMuaXNDYW5jZWxlZCkgewogICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzX2NvZGUgPj0gMTAwICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlIDwgMjAwKSB7CiAgICAgICAgdGhpcy5yZXF1ZXN0LmNhbmNlbCh0aGlzLmNhbmNlbFJlYXNvbiwgZXh0cmFIZWFkZXJzKTsKICAgICAgICB0aGlzLmNhbmNlbGVkKG51bGwpOwogICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLnN0YXR1c19jb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNfY29kZSA8IDI5OSkgewogICAgICAgIHRoaXMuYWNjZXB0QW5kVGVybWluYXRlKHJlc3BvbnNlKTsKICAgICAgICB0aGlzLmVtaXQoJ2J5ZScsIHRoaXMucmVxdWVzdCk7CiAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzX2NvZGUgPj0gMzAwKSB7CiAgICAgICAgY2F1c2UgPSBfc2lwMi5kZWZhdWx0LkMuUkVBU09OX1BIUkFTRVtyZXNwb25zZS5zdGF0dXNfY29kZV0gfHwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5DQU5DRUxFRDsKICAgICAgICB0aGlzLnJlamVjdGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgc3dpdGNoICh0cnVlKSB7CiAgICAgIGNhc2UgL14xMDAkLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgICB0aGlzLnJlY2VpdmVkXzEwMCA9IHRydWU7CiAgICAgICAgdGhpcy5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAvXjFbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgIC8vIERvIG5vdGhpbmcgd2l0aCAxeHggcmVzcG9uc2VzIHdpdGhvdXQgVG8gdGFnLgogICAgICAgIGlmICghcmVzcG9uc2UudG9fdGFnKSB7CiAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCcxeHggcmVzcG9uc2UgcmVjZWl2ZWQgd2l0aG91dCB0byB0YWcnKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgLy8gQ3JlYXRlIEVhcmx5IERpYWxvZyBpZiAxWFggY29tZXMgd2l0aCBjb250YWN0CiAgICAgICAgaWYgKHJlc3BvbnNlLmhhc0hlYWRlcignY29udGFjdCcpKSB7CiAgICAgICAgICAvLyBBbiBlcnJvciBvbiBkaWFsb2cgY3JlYXRpb24gd2lsbCBmaXJlICdmYWlsZWQnIGV2ZW50CiAgICAgICAgICBpZiAoIXRoaXMuY3JlYXRlRGlhbG9nKHJlc3BvbnNlLCAnVUFDJywgdHJ1ZSkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTXzFYWF9SRUNFSVZFRDsKCiAgICAgICAgaWYgKHJlc3BvbnNlLmhhc0hlYWRlcigncmVxdWlyZScpICYmIHJlc3BvbnNlLmdldEhlYWRlcigncmVxdWlyZScpLmluZGV4T2YoJzEwMHJlbCcpICE9PSAtMSkgewoKICAgICAgICAgIC8vIERvIG5vdGhpbmcgaWYgdGhpcy5kaWFsb2cgaXMgYWxyZWFkeSBjb25maXJtZWQKICAgICAgICAgIGlmICh0aGlzLmRpYWxvZyB8fCAhdGhpcy5lYXJseURpYWxvZ3NbaWRdKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5pbmRleE9mKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKSAhPT0gLTEgfHwgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWRbdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQubGVuZ3RoIC0gMV0gPj0gcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgJiYgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQubGVuZ3RoID4gMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCF0aGlzLmhhc0Rlc2NyaXB0aW9uKHJlc3BvbnNlKSkgewogICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnUkFjazogJyArIHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpICsgJyAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdjc2VxJykpOwogICAgICAgICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5wdXNoKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKTsKICAgICAgICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnNlbmRSZXF1ZXN0KHRoaXMsIF9zaXAyLmRlZmF1bHQuQy5QUkFDSywgewogICAgICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmhhc09mZmVyKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnKSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5kaWFsb2cucHJhY2tlZC5wdXNoKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKTsKCiAgICAgICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSQWNrOiAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgKyAnICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ2NzZXEnKSk7CgogICAgICAgICAgICBzZXNzaW9uLnNlbmRSZXF1ZXN0KF9zaXAyLmRlZmF1bHQuQy5QUkFDSywgewogICAgICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzLAogICAgICAgICAgICAgIHJlY2VpdmVSZXNwb25zZTogZnVuY3Rpb24gcmVjZWl2ZVJlc3BvbnNlKCkge30KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHNlc3Npb24uc3RhdHVzID0gQy5TVEFUVVNfRUFSTFlfTUVESUE7CiAgICAgICAgICAgIHNlc3Npb24uZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIC9eMlswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgdmFyIGNzZXEgPSB0aGlzLnJlcXVlc3QuY3NlcSArICcgJyArIHRoaXMucmVxdWVzdC5tZXRob2Q7CiAgICAgICAgaWYgKGNzZXEgIT09IHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfRUFSTFlfTUVESUEgJiYgdGhpcy5kaWFsb2cpIHsKICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICAgICAgb3B0aW9ucyA9IHt9OwogICAgICAgICAgaWYgKHRoaXMucmVuZGVyYm9keSkgewogICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgdGhpcy5yZW5kZXJ0eXBlKTsKICAgICAgICAgICAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSBleHRyYUhlYWRlcnM7CiAgICAgICAgICAgIG9wdGlvbnMuYm9keSA9IHRoaXMucmVuZGVyYm9keTsKICAgICAgICAgIH0KICAgICAgICAgIG9wdGlvbnMuY3NlcSA9IHJlc3BvbnNlLmNzZXE7CiAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KF9zaXAyLmRlZmF1bHQuQy5BQ0ssIG9wdGlvbnMpOwogICAgICAgICAgdGhpcy5hY2NlcHRlZChyZXNwb25zZSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgLy8gRG8gbm90aGluZyBpZiB0aGlzLmRpYWxvZyBpcyBhbHJlYWR5IGNvbmZpcm1lZAogICAgICAgIGlmICh0aGlzLmRpYWxvZykgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5oYXNBbnN3ZXIpIHsKICAgICAgICAgIGlmICh0aGlzLnJlbmRlcmJvZHkpIHsKICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRlbnQtVHlwZTogJyArIHNlc3Npb24ucmVuZGVydHlwZSk7CiAgICAgICAgICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzID0gZXh0cmFIZWFkZXJzOwogICAgICAgICAgICBvcHRpb25zLmJvZHkgPSB0aGlzLnJlbmRlcmJvZHk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KF9zaXAyLmRlZmF1bHQuQy5BQ0ssIG9wdGlvbnMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoIXRoaXMuaGFzRGVzY3JpcHRpb24ocmVzcG9uc2UpKSB7CiAgICAgICAgICAgIHRoaXMuYWNjZXB0QW5kVGVybWluYXRlKHJlc3BvbnNlLCA0MDAsICdNaXNzaW5nIHNlc3Npb24gZGVzY3JpcHRpb24nKTsKICAgICAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIXRoaXMuY3JlYXRlRGlhbG9nKHJlc3BvbnNlLCAnVUFDJykpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmhhc0Fuc3dlciA9IHRydWU7CiAgICAgICAgICB2YXIgb3B0aW9ucyA9IHt9OyAvLyxsb2NhbE1lZGlhOwogICAgICAgICAgc2Vzc2lvbi5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgICAgICBpZiAoc2Vzc2lvbi5yZW5kZXJib2R5KSB7CiAgICAgICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6ICcgKyBzZXNzaW9uLnJlbmRlcnR5cGUpOwogICAgICAgICAgICBvcHRpb25zLmV4dHJhSGVhZGVycyA9IGV4dHJhSGVhZGVyczsKICAgICAgICAgICAgb3B0aW9ucy5ib2R5ID0gc2Vzc2lvbi5yZW5kZXJib2R5OwogICAgICAgICAgfQogICAgICAgICAgb3B0aW9ucy5jc2VxID0gcmVzcG9uc2UuY3NlcTsKICAgICAgICAgIHNlc3Npb24uc2VuZFJlcXVlc3QoX3NpcDIuZGVmYXVsdC5DLkFDSywgb3B0aW9ucyk7CiAgICAgICAgICBzZXNzaW9uLmFjY2VwdGVkKHJlc3BvbnNlKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgY2F1c2UgPSBfc2lwMi5kZWZhdWx0LlV0aWxzLnNpcEVycm9yQ2F1c2UocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOwogICAgICAgIHRoaXMucmVqZWN0ZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgY2F1c2UpOwogICAgICAgIHRoaXMudGVybWluYXRlZChyZXNwb25zZSwgY2F1c2UpOwogICAgfQogIH0sCgogIGNhbmNlbDogZnVuY3Rpb24gY2FuY2VsKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpOwoKICAgIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aHJvdyBuZXcgX3NpcDIuZGVmYXVsdC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICB0aGlzLmxvZ2dlci5sb2coJ2NhbmNlbGluZyBSVENTZXNzaW9uJyk7CgogICAgdmFyIGNhbmNlbF9yZWFzb24gPSBfc2lwMi5kZWZhdWx0LlV0aWxzLmdldENhbmNlbFJlYXNvbihvcHRpb25zLnN0YXR1c19jb2RlLCBvcHRpb25zLnJlYXNvbl9waHJhc2UpOwoKICAgIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX05VTEwgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0lOVklURV9TRU5UICYmICF0aGlzLnJlY2VpdmVkXzEwMCkgewogICAgICB0aGlzLmlzQ2FuY2VsZWQgPSB0cnVlOwogICAgICB0aGlzLmNhbmNlbFJlYXNvbiA9IGNhbmNlbF9yZWFzb247CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19JTlZJVEVfU0VOVCB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfMVhYX1JFQ0VJVkVEIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19FQVJMWV9NRURJQSkgewogICAgICB0aGlzLnJlcXVlc3QuY2FuY2VsKGNhbmNlbF9yZWFzb24sIG9wdGlvbnMuZXh0cmFIZWFkZXJzKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5jYW5jZWxlZCgpOwogIH0sCgogIHRlcm1pbmF0ZTogZnVuY3Rpb24gdGVybWluYXRlKG9wdGlvbnMpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSyB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRoaXMuYnllKG9wdGlvbnMpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jYW5jZWwob3B0aW9ucyk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgcmVjZWl2ZVJlcXVlc3Q6IGZ1bmN0aW9uIHJlY2VpdmVSZXF1ZXN0KHJlcXVlc3QpIHsKICAgIC8vIElDQyBSRUNFSVZFIFJFUVVFU1QKCiAgICAvLyBSZWplY3QgQ0FOQ0VMcwogICAgaWYgKHJlcXVlc3QubWV0aG9kID09PSBfc2lwMi5kZWZhdWx0LkMuQ0FOQ0VMKSB7CiAgICAgIC8vIFRPRE87IG1ha2UgdGhpcyBhIHN3aXRjaCB3aGVuIGl0IGdldHMgYWRkZWQKICAgIH0KCiAgICBpZiAocmVxdWVzdC5tZXRob2QgPT09IF9zaXAyLmRlZmF1bHQuQy5BQ0sgJiYgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSykgewogICAgICBfc2lwMi5kZWZhdWx0LlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuYWNrVGltZXIpOwogICAgICBfc2lwMi5kZWZhdWx0LlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuaW52aXRlMnh4VGltZXIpOwogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0NPTkZJUk1FRDsKCiAgICAgIHRoaXMuYWNjZXB0ZWQoKTsKICAgIH0KCiAgICByZXR1cm4gU2Vzc2lvbi5wcm90b3R5cGUucmVjZWl2ZVJlcXVlc3QuYXBwbHkodGhpcywgW3JlcXVlc3RdKTsKICB9LAoKICBvblRyYW5zcG9ydEVycm9yOiBmdW5jdGlvbiBvblRyYW5zcG9ydEVycm9yKCkgewogICAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQgJiYgdGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5mYWlsZWQobnVsbCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgIH0KICB9LAoKICBvblJlcXVlc3RUaW1lb3V0OiBmdW5jdGlvbiBvblJlcXVlc3RUaW1lb3V0KCkgewogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy50ZXJtaW5hdGVkKG51bGwsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5mYWlsZWQobnVsbCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfQogIH0KCn07CgpleHBvcnRzLmRlZmF1bHQgPSBJbnZpdGVDbGllbnRDb250ZXh0Owptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyJzaXAuanMiOjQzfV0sNDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX3NpcCA9IHJlcXVpcmUoJ3NpcC5qcycpOwoKdmFyIF9zaXAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2lwKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9Cgp2YXIgU2Vzc2lvbiA9IF9zaXAyLmRlZmF1bHQuU2Vzc2lvbjsKdmFyIEMgPSB7CiAgU1RBVFVTX05VTEw6IDAsCiAgU1RBVFVTX0lOVklURV9TRU5UOiAxLAogIFNUQVRVU18xWFhfUkVDRUlWRUQ6IDIsCiAgU1RBVFVTX0lOVklURV9SRUNFSVZFRDogMywKICBTVEFUVVNfV0FJVElOR19GT1JfQU5TV0VSOiA0LAogIFNUQVRVU19BTlNXRVJFRDogNSwKICBTVEFUVVNfV0FJVElOR19GT1JfUFJBQ0s6IDYsCiAgU1RBVFVTX1dBSVRJTkdfRk9SX0FDSzogNywKICBTVEFUVVNfQ0FOQ0VMRUQ6IDgsCiAgU1RBVFVTX1RFUk1JTkFURUQ6IDksCiAgU1RBVFVTX0FOU1dFUkVEX1dBSVRJTkdfRk9SX1BSQUNLOiAxMCwKICBTVEFUVVNfRUFSTFlfTUVESUE6IDExLAogIFNUQVRVU19DT05GSVJNRUQ6IDEyCn07Cgp2YXIgaGFzRGVzY3JpcHRpb24gPSBmdW5jdGlvbiBoYXNEZXNjcmlwdGlvbihtZXNzYWdlKSB7CiAgcmV0dXJuIG1lc3NhZ2UuZ2V0SGVhZGVyKCdDb250ZW50LVR5cGUnKSA9PT0gJ2FwcGxpY2F0aW9uL3NkcCcgJiYgISFtZXNzYWdlLmJvZHk7Cn07Cgp2YXIgSW52aXRlU2VydmVyQ29udGV4dCA9IGZ1bmN0aW9uIEludml0ZVNlcnZlckNvbnRleHQodWEsIHJlcXVlc3QpIHsKICB2YXIgZXhwaXJlcywKICAgICAgc2VsZiA9IHRoaXMsCiAgICAgIGNvbnRlbnRUeXBlID0gcmVxdWVzdC5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpLAogICAgICBjb250ZW50RGlzcCA9IHJlcXVlc3QucGFyc2VIZWFkZXIoJ0NvbnRlbnQtRGlzcG9zaXRpb24nKTsKCiAgX3NpcDIuZGVmYXVsdC5VdGlscy5hdWdtZW50KHRoaXMsIF9zaXAyLmRlZmF1bHQuU2VydmVyQ29udGV4dCwgW3VhLCByZXF1ZXN0XSk7CiAgX3NpcDIuZGVmYXVsdC5VdGlscy5hdWdtZW50KHRoaXMsIF9zaXAyLmRlZmF1bHQuU2Vzc2lvbiwgW3VhLmNvbmZpZ3VyYXRpb24ubWVkaWFIYW5kbGVyRmFjdG9yeV0pOwoKICAvL0luaXRpYWxpemUgTWVkaWEgU2Vzc2lvbgogIHRoaXMubWVkaWFIYW5kbGVyID0gdGhpcy5tZWRpYUhhbmRsZXJGYWN0b3J5KHRoaXMsIHsKICAgIFJUQ0NvbnN0cmFpbnRzOiB7ICJvcHRpb25hbCI6IFt7ICdEdGxzU3J0cEtleUFncmVlbWVudCc6ICd0cnVlJyB9XSB9CiAgfSk7CgogIC8vIENoZWNrIGJvZHkgYW5kIGNvbnRlbnQgdHlwZQogIGlmICghY29udGVudERpc3AgJiYgIWhhc0Rlc2NyaXB0aW9uKHJlcXVlc3QpIHx8IGNvbnRlbnREaXNwICYmIGNvbnRlbnREaXNwLnR5cGUgPT09ICdyZW5kZXInKSB7CiAgICB0aGlzLnJlbmRlcmJvZHkgPSByZXF1ZXN0LmJvZHk7CiAgICB0aGlzLnJlbmRlcnR5cGUgPSBjb250ZW50VHlwZTsKICB9IGVsc2UgaWYgKCFoYXNEZXNjcmlwdGlvbihyZXF1ZXN0KSAmJiBjb250ZW50RGlzcCAmJiBjb250ZW50RGlzcC50eXBlID09PSAnc2Vzc2lvbicpIHsKICAgIHJlcXVlc3QucmVwbHkoNDE1KTsKICAgIC8vVE9ETzogaW5zdGVhZCBvZiA0MTUsIHBhc3Mgb2ZmIHRvIHRoZSBtZWRpYSBoYW5kbGVyLCB3aG8gY2FuIHRoZW4gZGVjaWRlIGlmIHdlIGNhbiB1c2UgaXQKICAgIHJldHVybjsKICB9CgogIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfSU5WSVRFX1JFQ0VJVkVEOwogIHRoaXMuZnJvbV90YWcgPSByZXF1ZXN0LmZyb21fdGFnOwogIHRoaXMuaWQgPSByZXF1ZXN0LmNhbGxfaWQgKyB0aGlzLmZyb21fdGFnOwogIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7CiAgdGhpcy5jb250YWN0ID0gdGhpcy51YS5jb250YWN0LnRvU3RyaW5nKCk7CgogIHRoaXMucmVjZWl2ZU5vbkludml0ZVJlc3BvbnNlID0gZnVuY3Rpb24gKCkge307IC8vIGludGVudGlvbmFsIG5vLW9wCgogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAuaW52aXRlc2VydmVyY29udGV4dCcsIHRoaXMuaWQpOwoKICAvL1NhdmUgdGhlIHNlc3Npb24gaW50byB0aGUgdWEgc2Vzc2lvbnMgY29sbGVjdGlvbi4KICB0aGlzLnVhLnNlc3Npb25zW3RoaXMuaWRdID0gdGhpczsKCiAgLy9HZXQgdGhlIEV4cGlyZXMgaGVhZGVyIHZhbHVlIGlmIGV4aXN0cwogIGlmIChyZXF1ZXN0Lmhhc0hlYWRlcignZXhwaXJlcycpKSB7CiAgICBleHBpcmVzID0gcmVxdWVzdC5nZXRIZWFkZXIoJ2V4cGlyZXMnKSAqIDEwMDA7CiAgfQoKICAvL1NldCAxMDByZWwgaWYgbmVjZXNzYXJ5CiAgZnVuY3Rpb24gc2V0MTAwcmVsKGgsIGMpIHsKICAgIGlmIChyZXF1ZXN0Lmhhc0hlYWRlcihoKSAmJiByZXF1ZXN0LmdldEhlYWRlcihoKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJzEwMHJlbCcpID49IDApIHsKICAgICAgc2VsZi5yZWwxMDAgPSBjOwogICAgfQogIH0KICBzZXQxMDByZWwoJ3JlcXVpcmUnLCBfc2lwMi5kZWZhdWx0LkMuc3VwcG9ydGVkLlJFUVVJUkVEKTsKICBzZXQxMDByZWwoJ3N1cHBvcnRlZCcsIF9zaXAyLmRlZmF1bHQuQy5zdXBwb3J0ZWQuU1VQUE9SVEVEKTsKCiAgLyogU2V0IHRoZSB0b190YWcgYmVmb3JlCiAgICogcmVwbHlpbmcgYSByZXNwb25zZSBjb2RlIHRoYXQgd2lsbCBjcmVhdGUgYSBkaWFsb2cuCiAgICovCiAgcmVxdWVzdC50b190YWcgPSBfc2lwMi5kZWZhdWx0LlV0aWxzLm5ld1RhZygpOwoKICAvLyBBbiBlcnJvciBvbiBkaWFsb2cgY3JlYXRpb24gd2lsbCBmaXJlICdmYWlsZWQnIGV2ZW50CiAgaWYgKCF0aGlzLmNyZWF0ZURpYWxvZyhyZXF1ZXN0LCAnVUFTJywgdHJ1ZSkpIHsKICAgIHJlcXVlc3QucmVwbHkoNTAwLCAnTWlzc2luZyBDb250YWN0IGhlYWRlciBmaWVsZCcpOwogICAgcmV0dXJuOwogIH0KCiAgZnVuY3Rpb24gZmlyZU5ld1Nlc3Npb24oKSB7CiAgICB2YXIgb3B0aW9ucyA9IHsgZXh0cmFIZWFkZXJzOiBbJ0NvbnRhY3Q6ICcgKyBzZWxmLmNvbnRhY3RdIH07CgogICAgaWYgKHNlbGYucmVsMTAwICE9PSBfc2lwMi5kZWZhdWx0LkMuc3VwcG9ydGVkLlJFUVVJUkVEKSB7CiAgICAgIHNlbGYucHJvZ3Jlc3Mob3B0aW9ucyk7CiAgICB9CiAgICBzZWxmLnN0YXR1cyA9IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUjsKCiAgICAvLyBTZXQgdXNlck5vQW5zd2VyVGltZXIKICAgIHNlbGYudGltZXJzLnVzZXJOb0Fuc3dlclRpbWVyID0gX3NpcDIuZGVmYXVsdC5UaW1lcnMuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIHJlcXVlc3QucmVwbHkoNDA4KTsKICAgICAgc2VsZi5mYWlsZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5OT19BTlNXRVIpOwogICAgICBzZWxmLnRlcm1pbmF0ZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5OT19BTlNXRVIpOwogICAgfSwgc2VsZi51YS5jb25maWd1cmF0aW9uLm5vQW5zd2VyVGltZW91dCk7CgogICAgLyogU2V0IGV4cGlyZXNUaW1lcgogICAgICogUkZDMzI2MSAxMy4zLjEKICAgICAqLwogICAgaWYgKGV4cGlyZXMpIHsKICAgICAgc2VsZi50aW1lcnMuZXhwaXJlc1RpbWVyID0gX3NpcDIuZGVmYXVsdC5UaW1lcnMuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHNlbGYuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BTlNXRVIpIHsKICAgICAgICAgIHJlcXVlc3QucmVwbHkoNDg3KTsKICAgICAgICAgIHNlbGYuZmFpbGVkKHJlcXVlc3QsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuRVhQSVJFUyk7CiAgICAgICAgICBzZWxmLnRlcm1pbmF0ZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5FWFBJUkVTKTsKICAgICAgICB9CiAgICAgIH0sIGV4cGlyZXMpOwogICAgfQoKICAgIHNlbGYuZW1pdCgnaW52aXRlJywgcmVxdWVzdCk7CiAgfQoKICBpZiAoIWhhc0Rlc2NyaXB0aW9uKHJlcXVlc3QpIHx8IHRoaXMucmVuZGVyYm9keSkgewogICAgX3NpcDIuZGVmYXVsdC5UaW1lcnMuc2V0VGltZW91dChmaXJlTmV3U2Vzc2lvbiwgMCk7CiAgfSBlbHNlIHsKICAgIHRoaXMuaGFzT2ZmZXIgPSB0cnVlOwogICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIGZpcmVOZXdTZXNzaW9uKCk7CiAgICB9LCA1MDApOwogIH0KfTsKCkludml0ZVNlcnZlckNvbnRleHQucHJvdG90eXBlID0gewoKICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChvcHRpb25zKSB7CiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRocm93IG5ldyBfc2lwMi5kZWZhdWx0LkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogICAgfQoKICAgIHRoaXMubG9nZ2VyLmxvZygncmVqZWN0aW5nIFJUQ1Nlc3Npb24nKTsKCiAgICBfc2lwMi5kZWZhdWx0LlNlcnZlckNvbnRleHQucHJvdG90eXBlLnJlamVjdC5jYWxsKHRoaXMsIG9wdGlvbnMpOwogICAgcmV0dXJuIHRoaXMudGVybWluYXRlZCgpOwogIH0sCgogIHRlcm1pbmF0ZTogZnVuY3Rpb24gdGVybWluYXRlKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIHZhciBleHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCksCiAgICAgICAgYm9keSA9IG9wdGlvbnMuYm9keSwKICAgICAgICBkaWFsb2csCiAgICAgICAgc2VsZiA9IHRoaXM7CgogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0sgJiYgdGhpcy5yZXF1ZXN0LnNlcnZlcl90cmFuc2FjdGlvbi5zdGF0ZSAhPT0gX3NpcDIuZGVmYXVsdC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICBkaWFsb2cgPSB0aGlzLmRpYWxvZzsKCiAgICAgIHRoaXMucmVjZWl2ZVJlcXVlc3QgPSBmdW5jdGlvbiAocmVxdWVzdCkgewogICAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gX3NpcDIuZGVmYXVsdC5DLkFDSykgewogICAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChfc2lwMi5kZWZhdWx0LkMuQllFLCB7CiAgICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzLAogICAgICAgICAgICBib2R5OiBib2R5CiAgICAgICAgICB9KTsKICAgICAgICAgIGRpYWxvZy50ZXJtaW5hdGUoKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICB0aGlzLnJlcXVlc3Quc2VydmVyX3RyYW5zYWN0aW9uLm9uKCdzdGF0ZUNoYW5nZWQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IF9zaXAyLmRlZmF1bHQuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX1RFUk1JTkFURUQgJiYgdGhpcy5kaWFsb2cpIHsKICAgICAgICAgIHRoaXMucmVxdWVzdCA9IG5ldyBfc2lwMi5kZWZhdWx0Lk91dGdvaW5nUmVxdWVzdChfc2lwMi5kZWZhdWx0LkMuQllFLCB0aGlzLmRpYWxvZy5yZW1vdGVfdGFyZ2V0LCB0aGlzLnVhLCB7CiAgICAgICAgICAgICdjc2VxJzogdGhpcy5kaWFsb2cubG9jYWxfc2VxbnVtICs9IDEsCiAgICAgICAgICAgICdjYWxsX2lkJzogdGhpcy5kaWFsb2cuaWQuY2FsbF9pZCwKICAgICAgICAgICAgJ2Zyb21fdXJpJzogdGhpcy5kaWFsb2cubG9jYWxfdXJpLAogICAgICAgICAgICAnZnJvbV90YWcnOiB0aGlzLmRpYWxvZy5pZC5sb2NhbF90YWcsCiAgICAgICAgICAgICd0b191cmknOiB0aGlzLmRpYWxvZy5yZW1vdGVfdXJpLAogICAgICAgICAgICAndG9fdGFnJzogdGhpcy5kaWFsb2cuaWQucmVtb3RlX3RhZywKICAgICAgICAgICAgJ3JvdXRlX3NldCc6IHRoaXMuZGlhbG9nLnJvdXRlX3NldAogICAgICAgICAgfSwgZXh0cmFIZWFkZXJzLCBib2R5KTsKCiAgICAgICAgICBuZXcgX3NpcDIuZGVmYXVsdC5SZXF1ZXN0U2VuZGVyKHsKICAgICAgICAgICAgcmVxdWVzdDogdGhpcy5yZXF1ZXN0LAogICAgICAgICAgICBvblJlcXVlc3RUaW1lb3V0OiBmdW5jdGlvbiBvblJlcXVlc3RUaW1lb3V0KCkgewogICAgICAgICAgICAgIHNlbGYub25SZXF1ZXN0VGltZW91dCgpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBvblRyYW5zcG9ydEVycm9yOiBmdW5jdGlvbiBvblRyYW5zcG9ydEVycm9yKCkgewogICAgICAgICAgICAgIHNlbGYub25UcmFuc3BvcnRFcnJvcigpOwogICAgICAgICAgICB9LAogICAgICAgICAgICByZWNlaXZlUmVzcG9uc2U6IGZ1bmN0aW9uIHJlY2VpdmVSZXNwb25zZSgpIHsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIHRoaXMudWEpLnNlbmQoKTsKICAgICAgICAgIGRpYWxvZy50ZXJtaW5hdGUoKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgdGhpcy5lbWl0KCdieWUnLCB0aGlzLnJlcXVlc3QpOwogICAgICB0aGlzLnRlcm1pbmF0ZWQoKTsKCiAgICAgIC8vIFJlc3RvcmUgdGhlIGRpYWxvZyBpbnRvICd0aGlzJyBpbiBvcmRlciB0byBiZSBhYmxlIHRvIHNlbmQgdGhlIGluLWRpYWxvZyBCWUUgOi0pCiAgICAgIHRoaXMuZGlhbG9nID0gZGlhbG9nOwoKICAgICAgLy8gUmVzdG9yZSB0aGUgZGlhbG9nIGludG8gJ3VhJyBzbyB0aGUgQUNLIGNhbiByZWFjaCAndGhpcycgc2Vzc2lvbgogICAgICB0aGlzLnVhLmRpYWxvZ3NbZGlhbG9nLmlkLnRvU3RyaW5nKCldID0gZGlhbG9nOwogICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRoaXMuYnllKG9wdGlvbnMpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5yZWplY3Qob3B0aW9ucyk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoKICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMubWVkaWFdIGdldHMgcGFzc2VkIHRvIFNJUC5NZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24gYXMgbWVkaWFIaW50CiAgICovCiAgcHJvZ3Jlc3M6IGZ1bmN0aW9uIHByb2dyZXNzKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogICAgdmFyIHN0YXR1c0NvZGUgPSBvcHRpb25zLnN0YXR1c0NvZGUgfHwgMTgwLAogICAgICAgIHJlYXNvblBocmFzZSA9IG9wdGlvbnMucmVhc29uUGhyYXNlLAogICAgICAgIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKSwKICAgICAgICBpY2VTZXJ2ZXJzLAogICAgICAgIHN0dW5TZXJ2ZXJzID0gb3B0aW9ucy5zdHVuU2VydmVycyB8fCBudWxsLAogICAgICAgIHR1cm5TZXJ2ZXJzID0gb3B0aW9ucy50dXJuU2VydmVycyB8fCBudWxsLAogICAgICAgIGJvZHkgPSBvcHRpb25zLmJvZHksCiAgICAgICAgcmVzcG9uc2U7CgogICAgaWYgKHN0YXR1c0NvZGUgPCAxMDAgfHwgc3RhdHVzQ29kZSA+IDE5OSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHN0YXR1c0NvZGU6ICcgKyBzdGF0dXNDb2RlKTsKICAgIH0KCiAgICBpZiAodGhpcy5pc0NhbmNlbGVkIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIGZ1bmN0aW9uIGRvMTAwcmVsKCkgewogICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovCiAgICAgIHN0YXR1c0NvZGUgPSBvcHRpb25zLnN0YXR1c0NvZGUgfHwgMTgzOwoKICAgICAgLy8gU2V0IHN0YXR1cyBhbmQgYWRkIGV4dHJhIGhlYWRlcnMKICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSzsKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcgKyB0aGlzLmNvbnRhY3QpOwogICAgICBleHRyYUhlYWRlcnMucHVzaCgnUmVxdWlyZTogMTAwcmVsJyk7CiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSU2VxOiAnICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDApKTsKCiAgICAgIC8vIEdldCB0aGUgc2Vzc2lvbiBkZXNjcmlwdGlvbiB0byBhZGQgdG8gcHJlYWNjZXB0IHdpdGgKICAgICAgaWYgKHRoaXMuaXNDYW5jZWxlZCB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpc1t0aGlzLmhhc09mZmVyID8gJ2hhc0Fuc3dlcicgOiAnaGFzT2ZmZXInXSA9IHRydWU7CgogICAgICAvLyBSZXRyYW5zbWl0IHVudGlsIHdlIGdldCBhIHJlc3BvbnNlIG9yIHdlIHRpbWUgb3V0IChzZWUgcHJhY2tUaW1lciBiZWxvdykKICAgICAgdmFyIHRpbWVvdXQgPSBfc2lwMi5kZWZhdWx0LlRpbWVycy5UMTsKICAgICAgdGhpcy50aW1lcnMucmVsMXh4VGltZXIgPSBfc2lwMi5kZWZhdWx0LlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uIHJlbDF4eFJldHJhbnNtaXNzaW9uKCkgewogICAgICAgIHRoaXMucmVxdWVzdC5yZXBseShzdGF0dXNDb2RlLCBudWxsLCBleHRyYUhlYWRlcnMsIGRlc2NyaXB0aW9uKTsKICAgICAgICB0aW1lb3V0ICo9IDI7CiAgICAgICAgdGhpcy50aW1lcnMucmVsMXh4VGltZXIgPSBfc2lwMi5kZWZhdWx0LlRpbWVycy5zZXRUaW1lb3V0KHJlbDF4eFJldHJhbnNtaXNzaW9uLmJpbmQodGhpcyksIHRpbWVvdXQpOwogICAgICB9LmJpbmQodGhpcyksIHRpbWVvdXQpOwoKICAgICAgLy8gVGltZW91dCBhbmQgcmVqZWN0IElOVklURSBpZiBubyByZXNwb25zZQogICAgICB0aGlzLnRpbWVycy5wcmFja1RpbWVyID0gX3NpcDIuZGVmYXVsdC5UaW1lcnMuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5sb2dnZXIubG9nKCdubyBQUkFDSyByZWNlaXZlZCwgcmVqZWN0aW5nIHRoZSBjYWxsJyk7CiAgICAgICAgX3NpcDIuZGVmYXVsdC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnJlbDF4eFRpbWVyKTsKICAgICAgICB0aGlzLnJlcXVlc3QucmVwbHkoNTA0KTsKICAgICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5OT19QUkFDSyk7CiAgICAgIH0uYmluZCh0aGlzKSwgX3NpcDIuZGVmYXVsdC5UaW1lcnMuVDEgKiA2NCk7CgogICAgICAvLyBTZW5kIHRoZSBpbml0aWFsIHJlc3BvbnNlCiAgICAgIHJlc3BvbnNlID0gdGhpcy5yZXF1ZXN0LnJlcGx5KHN0YXR1c0NvZGUsIHJlYXNvblBocmFzZSwgZXh0cmFIZWFkZXJzLCBkZXNjcmlwdGlvbik7CiAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSwgcmVhc29uUGhyYXNlKTsKICAgIH0gLy8gZW5kIGRvMTAwcmVsCgogICAgZnVuY3Rpb24gbm9ybWFsUmVwbHkoKSB7CiAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqLwogICAgICByZXNwb25zZSA9IHRoaXMucmVxdWVzdC5yZXBseShzdGF0dXNDb2RlLCByZWFzb25QaHJhc2UsIGV4dHJhSGVhZGVycywgYm9keSk7CiAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSwgcmVhc29uUGhyYXNlKTsKICAgIH0KCiAgICBpZiAob3B0aW9ucy5zdGF0dXNDb2RlICE9PSAxMDAgJiYgKHRoaXMucmVsMTAwID09PSBfc2lwMi5kZWZhdWx0LkMuc3VwcG9ydGVkLlJFUVVJUkVEIHx8IHRoaXMucmVsMTAwID09PSBfc2lwMi5kZWZhdWx0LkMuc3VwcG9ydGVkLlNVUFBPUlRFRCAmJiBvcHRpb25zLnJlbDEwMCB8fCB0aGlzLnJlbDEwMCA9PT0gX3NpcDIuZGVmYXVsdC5DLnN1cHBvcnRlZC5TVVBQT1JURUQgJiYgdGhpcy51YS5jb25maWd1cmF0aW9uLnJlbDEwMCA9PT0gX3NpcDIuZGVmYXVsdC5DLnN1cHBvcnRlZC5SRVFVSVJFRCkpIHsKICAgICAgZG8xMDByZWwuYXBwbHkodGhpcyk7CiAgICB9IGVsc2UgewogICAgICBub3JtYWxSZXBseS5hcHBseSh0aGlzKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qCiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLm1lZGlhXSBnZXRzIHBhc3NlZCB0byBTSVAuTWVkaWFIYW5kbGVyLmdldERlc2NyaXB0aW9uIGFzIG1lZGlhSGludAogICAqLwogIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKFNlc3Npb24uZGVzdWdhcihvcHRpb25zKSk7CiAgICB0aGlzLm9uSW5mbyA9IG9wdGlvbnMub25JbmZvOwoKICAgIC8vIGNvbW1lbnRlZCBvdXQgbm93LXVudXNlZCBob2xkLXJlbGF0ZWQgdmFyaWFibGVzIGZvciBqc2hpbnQuIFNlZSBiZWxvdy4gSk1GIDIwMTQtMS0yMQogICAgdmFyCiAgICAvL2lkeCwgbGVuZ3RoLCBoYXNBdWRpbywgaGFzVmlkZW8sCiAgICBzZWxmID0gdGhpcywKICAgICAgICByZXF1ZXN0ID0gdGhpcy5yZXF1ZXN0LAogICAgICAgIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKSwKICAgICAgICBkZXNjcmlwdGlvbkNyZWF0aW9uU3VjY2VlZGVkID0gZnVuY3Rpb24gZGVzY3JpcHRpb25DcmVhdGlvblN1Y2NlZWRlZChkZXNjcmlwdGlvbikgewogICAgICB2YXIgcmVzcG9uc2UsCgogICAgICAvLyBydW4gZm9yIHJlcGx5IHN1Y2Nlc3MgY2FsbGJhY2sKICAgICAgcmVwbHlTdWNjZWVkZWQgPSBmdW5jdGlvbiByZXBseVN1Y2NlZWRlZCgpIHsKICAgICAgICBzZWxmLnN0YXR1cyA9IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSzsKCiAgICAgICAgc2VsZi5zZXRJbnZpdGUyeHhUaW1lcihyZXF1ZXN0LCBkZXNjcmlwdGlvbik7CiAgICAgICAgc2VsZi5zZXRBQ0tUaW1lcigpOwogICAgICB9LAoKCiAgICAgIC8vIHJ1biBmb3IgcmVwbHkgZmFpbHVyZSBjYWxsYmFjawogICAgICByZXBseUZhaWxlZCA9IGZ1bmN0aW9uIHJlcGx5RmFpbGVkKCkgewogICAgICAgIHNlbGYuZmFpbGVkKG51bGwsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICAgICAgc2VsZi50ZXJtaW5hdGVkKG51bGwsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICAgIH07CgogICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJyArIHNlbGYuY29udGFjdCk7CiAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdBbGxvdzogJyArIF9zaXAyLmRlZmF1bHQuVUEuQy5BTExPV0VEX01FVEhPRFMudG9TdHJpbmcoKSk7CgogICAgICBpZiAoIXNlbGYuaGFzT2ZmZXIpIHsKICAgICAgICBzZWxmLmhhc09mZmVyID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzZWxmLmhhc0Fuc3dlciA9IHRydWU7CiAgICAgIH0KICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0LnJlcGx5KDIwMCwgbnVsbCwgZXh0cmFIZWFkZXJzLCBkZXNjcmlwdGlvbiwgcmVwbHlTdWNjZWVkZWQsIHJlcGx5RmFpbGVkKTsKICAgICAgaWYgKHNlbGYuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgICAgLy8gRGlkbid0IGZhaWwKICAgICAgICBzZWxmLmFjY2VwdGVkKHJlc3BvbnNlLCBfc2lwMi5kZWZhdWx0LlV0aWxzLmdldFJlYXNvblBocmFzZSgyMDApKTsKICAgICAgfQogICAgfTsKCiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0FOU1dFUkVEX1dBSVRJTkdfRk9SX1BSQUNLOwogICAgICByZXR1cm4gdGhpczsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUikgewogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0FOU1dFUkVEOwogICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfRUFSTFlfTUVESUEpIHsKICAgICAgdGhyb3cgbmV3IF9zaXAyLmRlZmF1bHQuRXhjZXB0aW9ucy5JbnZhbGlkU3RhdGVFcnJvcih0aGlzLnN0YXR1cyk7CiAgICB9CgogICAgLy8gQW4gZXJyb3Igb24gZGlhbG9nIGNyZWF0aW9uIHdpbGwgZmlyZSAnZmFpbGVkJyBldmVudAogICAgaWYgKCF0aGlzLmNyZWF0ZURpYWxvZyhyZXF1ZXN0LCAnVUFTJykpIHsKICAgICAgcmVxdWVzdC5yZXBseSg1MDAsICdNaXNzaW5nIENvbnRhY3QgaGVhZGVyIGZpZWxkJyk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgY29uc29sZS5sb2coJ3JlcXVlc3QnLCByZXF1ZXN0KTsKICAgIF9zaXAyLmRlZmF1bHQuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy51c2VyTm9BbnN3ZXJUaW1lcik7CgogICAgZGVzY3JpcHRpb25DcmVhdGlvblN1Y2NlZWRlZChvcHRpb25zLnNkcCk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICByZWNlaXZlUmVxdWVzdDogZnVuY3Rpb24gcmVjZWl2ZVJlcXVlc3QocmVxdWVzdCkgewoKICAgIC8vIElTQyBSRUNFSVZFIFJFUVVFU1QKCiAgICBmdW5jdGlvbiBjb25maXJtU2Vzc2lvbigpIHsKICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovCiAgICAgIHZhciBjb250ZW50VHlwZTsKCiAgICAgIF9zaXAyLmRlZmF1bHQuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5hY2tUaW1lcik7CiAgICAgIF9zaXAyLmRlZmF1bHQuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5pbnZpdGUyeHhUaW1lcik7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICB0aGlzLnVubXV0ZSgpOwoKICAgICAgLy8gVE9ETyAtIHRoaXMgbG9naWMgYXNzdW1lcyBDb250ZW50LURpc3Bvc2l0aW9uIGRlZmF1bHRzCiAgICAgIGNvbnRlbnRUeXBlID0gcmVxdWVzdC5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpOwogICAgICBpZiAoIWhhc0Rlc2NyaXB0aW9uKHJlcXVlc3QpKSB7CiAgICAgICAgdGhpcy5yZW5kZXJib2R5ID0gcmVxdWVzdC5ib2R5OwogICAgICAgIHRoaXMucmVuZGVydHlwZSA9IGNvbnRlbnRUeXBlOwogICAgICB9CgogICAgICB0aGlzLmVtaXQoJ2NvbmZpcm1lZCcsIHJlcXVlc3QpOwogICAgfQoKICAgIHN3aXRjaCAocmVxdWVzdC5tZXRob2QpIHsKICAgICAgY2FzZSBfc2lwMi5kZWZhdWx0LkMuQ0FOQ0VMOgogICAgICAgIC8qIFJGQzMyNjEgMTUgU3RhdGVzIHRoYXQgYSBVQVMgbWF5IGhhdmUgYWNjZXB0ZWQgYW4gaW52aXRhdGlvbiB3aGlsZSBhIENBTkNFTAogICAgICAgICAqIHdhcyBpbiBwcm9ncmVzcyBhbmQgdGhhdCB0aGUgVUFDIE1BWSBjb250aW51ZSB3aXRoIHRoZSBzZXNzaW9uIGVzdGFibGlzaGVkIGJ5CiAgICAgICAgICogYW55IDJ4eCByZXNwb25zZSwgb3IgTUFZIHRlcm1pbmF0ZSB3aXRoIEJZRS4gU0lQIGRvZXMgY29udGludWUgd2l0aCB0aGUKICAgICAgICAgKiBlc3RhYmxpc2hlZCBzZXNzaW9uLiBTbyB0aGUgQ0FOQ0VMIGlzIHByb2Nlc3NlZCBvbmx5IGlmIHRoZSBzZXNzaW9uIGlzIG5vdCB5ZXQKICAgICAgICAgKiBlc3RhYmxpc2hlZC4KICAgICAgICAgKi8KCiAgICAgICAgLyoKICAgICAgICAgKiBUZXJtaW5hdGUgdGhlIHdob2xlIHNlc3Npb24gaW4gY2FzZSB0aGUgdXNlciBkaWRuJ3QgYWNjZXB0IChvciB5ZXQgdG8gc2VuZCB0aGUgYW5zd2VyKSBub3IgcmVqZWN0IHRoZQogICAgICAgICAqcmVxdWVzdCBvcGVuaW5nIHRoZSBzZXNzaW9uLgogICAgICAgICAqLwogICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQU5TV0VSIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSyB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0sgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0VBUkxZX01FRElBIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19BTlNXRVJFRCkgewoKICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ0FOQ0VMRUQ7CiAgICAgICAgICB0aGlzLnJlcXVlc3QucmVwbHkoNDg3KTsKICAgICAgICAgIHRoaXMuY2FuY2VsZWQocmVxdWVzdCk7CiAgICAgICAgICB0aGlzLnJlamVjdGVkKHJlcXVlc3QsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuQ0FOQ0VMRUQpOwogICAgICAgICAgdGhpcy5mYWlsZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5DQU5DRUxFRCk7CiAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5DQU5DRUxFRCk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIF9zaXAyLmRlZmF1bHQuQy5BQ0s6CiAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0spIHsKICAgICAgICAgIGlmICghdGhpcy5oYXNBbnN3ZXIpIHsKICAgICAgICAgICAgaWYgKGhhc0Rlc2NyaXB0aW9uKHJlcXVlc3QpKSB7CiAgICAgICAgICAgICAgLy8gQUNLIGNvbnRhaW5zIGFuc3dlciB0byBhbiBJTlZJVEUgdy9vIFNEUCBuZWdvdGlhdGlvbgogICAgICAgICAgICAgIHRoaXMuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgICAgICAgICB0aGlzLm1lZGlhSGFuZGxlci5zZXREZXNjcmlwdGlvbihyZXF1ZXN0KS50aGVuKGNvbmZpcm1TZXNzaW9uLmJpbmQodGhpcyksIGZ1bmN0aW9uIG9uRmFpbHVyZShlKSB7CiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKGUpOwogICAgICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGUoewogICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiAnNDg4JywKICAgICAgICAgICAgICAgICAgcmVhc29uUGhyYXNlOiAnQmFkIE1lZGlhIERlc2NyaXB0aW9uJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB0aGlzLmZhaWxlZChyZXF1ZXN0LCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5lYXJseV9zZHApIHsKICAgICAgICAgICAgICBjb25maXJtU2Vzc2lvbi5hcHBseSh0aGlzKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvL1RPRE86IFBhc3MgdG8gbWVkaWFoYW5kbGVyCiAgICAgICAgICAgICAgdGhpcy5mYWlsZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICAgIHRoaXMudGVybWluYXRlZChyZXF1ZXN0LCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbmZpcm1TZXNzaW9uLmFwcGx5KHRoaXMpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBfc2lwMi5kZWZhdWx0LkMuUFJBQ0s6CiAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSyB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0spIHsKICAgICAgICAgIC8vbG9jYWxNZWRpYSA9IHNlc3Npb24ubWVkaWFIYW5kbGVyLmxvY2FsTWVkaWE7CiAgICAgICAgICBpZiAoIXRoaXMuaGFzQW5zd2VyKSB7CiAgICAgICAgICAgIGlmIChoYXNEZXNjcmlwdGlvbihyZXF1ZXN0KSkgewogICAgICAgICAgICAgIHRoaXMuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgICAgICAgICB0aGlzLm1lZGlhSGFuZGxlci5zZXREZXNjcmlwdGlvbihyZXF1ZXN0KS50aGVuKGZ1bmN0aW9uIG9uU3VjY2VzcygpIHsKICAgICAgICAgICAgICAgIF9zaXAyLmRlZmF1bHQuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5yZWwxeHhUaW1lcik7CiAgICAgICAgICAgICAgICBfc2lwMi5kZWZhdWx0LlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMucHJhY2tUaW1lcik7CiAgICAgICAgICAgICAgICByZXF1ZXN0LnJlcGx5KDIwMCk7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0FOU1dFUkVEX1dBSVRJTkdfRk9SX1BSQUNLKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfRUFSTFlfTUVESUE7CiAgICAgICAgICAgICAgICAgIHRoaXMuYWNjZXB0KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0VBUkxZX01FRElBOwogICAgICAgICAgICAgICAgLy9SRVZJU0lUCiAgICAgICAgICAgICAgICB0aGlzLm11dGUoKTsKICAgICAgICAgICAgICB9LmJpbmQodGhpcyksIGZ1bmN0aW9uIG9uRmFpbHVyZShlKSB7CiAgICAgICAgICAgICAgICAvL1RPRE86IFNlbmQgdG8gbWVkaWEgaGFuZGxlcgogICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIud2FybihlKTsKICAgICAgICAgICAgICAgIHRoaXMudGVybWluYXRlKHsKICAgICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogJzQ4OCcsCiAgICAgICAgICAgICAgICAgIHJlYXNvblBocmFzZTogJ0JhZCBNZWRpYSBEZXNjcmlwdGlvbicKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGhpcy5mYWlsZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlcXVlc3QsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgICB9LmJpbmQodGhpcykpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMudGVybWluYXRlKHsKICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6ICc0ODgnLAogICAgICAgICAgICAgICAgcmVhc29uUGhyYXNlOiAnQmFkIE1lZGlhIERlc2NyaXB0aW9uJwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHRoaXMuZmFpbGVkKHJlcXVlc3QsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfc2lwMi5kZWZhdWx0LlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMucmVsMXh4VGltZXIpOwogICAgICAgICAgICBfc2lwMi5kZWZhdWx0LlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMucHJhY2tUaW1lcik7CiAgICAgICAgICAgIHJlcXVlc3QucmVwbHkoMjAwKTsKCiAgICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0spIHsKICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0VBUkxZX01FRElBOwogICAgICAgICAgICAgIHRoaXMuYWNjZXB0KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgICAgLy9SRVZJU0lUCiAgICAgICAgICAgIHRoaXMubXV0ZSgpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0VBUkxZX01FRElBKSB7CiAgICAgICAgICByZXF1ZXN0LnJlcGx5KDIwMCk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIFNlc3Npb24ucHJvdG90eXBlLnJlY2VpdmVSZXF1ZXN0LmFwcGx5KHRoaXMsIFtyZXF1ZXN0XSk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfSwKCiAgb25UcmFuc3BvcnRFcnJvcjogZnVuY3Rpb24gb25UcmFuc3BvcnRFcnJvcigpIHsKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQ09ORklSTUVEICYmIHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKG51bGwsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICB9CiAgfSwKCiAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24gb25SZXF1ZXN0VGltZW91dCgpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKG51bGwsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgICAgdGhpcy50ZXJtaW5hdGVkKG51bGwsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH0KICB9Cgp9OwoKZXhwb3J0cy5kZWZhdWx0ID0gSW52aXRlU2VydmVyQ29udGV4dDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsic2lwLmpzIjo0M31dLDQ4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuYWRkQ2FuZGlkYXRlc1RvU0RQID0gYWRkQ2FuZGlkYXRlc1RvU0RQOwoKdmFyIF9zZHBUcmFuc2Zvcm0gPSByZXF1aXJlKCdzZHAtdHJhbnNmb3JtJyk7Cgp2YXIgX3NkcFRyYW5zZm9ybTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZHBUcmFuc2Zvcm0pOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIGFkZENhbmRpZGF0ZXNUb1NEUCh0eHRTZHAsIGNhbmRpZGF0ZXMpIHsKCXZhciBzZHAgPSBfc2RwVHJhbnNmb3JtMi5kZWZhdWx0LnBhcnNlKHR4dFNkcCk7CglzZHAubWVkaWFbMF0uY2FuZGlkYXRlcyA9IFtdOwoJaWYgKHNkcC5tZWRpYS5sZW5ndGggPiAxKSBzZHAubWVkaWFbMV0uY2FuZGlkYXRlcyA9IFtdOwoJY2FuZGlkYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYW5kaWRhdGUpIHsKCQl2YXIgcGFydHMgPSBjYW5kaWRhdGUuY2FuZGlkYXRlLnN1YnN0cmluZygxMCkuc3BsaXQoJyAnKTsKCQl2YXIgYyA9IHsKCQkJZm91bmRhdGlvbjogcGFydHNbMF0sCgkJCWNvbXBvbmVudDogcGFydHNbMV0sCgkJCXRyYW5zcG9ydDogcGFydHNbMl0udG9Mb3dlckNhc2UoKSwKCQkJcHJpb3JpdHk6IHBhcnRzWzNdLAoJCQlpcDogcGFydHNbNF0sCgkJCXBvcnQ6IHBhcnRzWzVdLAoJCQl0eXBlOiBwYXJ0c1s3XSwKCQkJZ2VuZXJhdGlvbjogJzAnCgkJfTsKCQlmb3IgKHZhciBpID0gODsgaSA8IHBhcnRzLmxlbmd0aDsgaSArPSAyKSB7CgkJCWlmIChwYXJ0c1tpXSA9PT0gJ3JhZGRyJykgewoJCQkJYy5yYWRkciA9IHBhcnRzW2kgKyAxXTsKCQkJfSBlbHNlIGlmIChwYXJ0c1tpXSA9PT0gJ3Jwb3J0JykgewoJCQkJYy5ycG9ydCA9IHBhcnRzW2kgKyAxXTsKCQkJfSBlbHNlIGlmIChwYXJ0c1tpXSA9PT0gJ2dlbmVyYXRpb24nKSB7CgkJCQljLmdlbmVyYXRpb24gPSBwYXJ0c1tpICsgMV07CgkJCX0gZWxzZSBpZiAocGFydHNbaV0gPT09ICd0Y3B0eXBlJykgewoJCQkJYy50Y3B0eXBlID0gcGFydHNbaSArIDFdOwoJCQl9IGVsc2UgaWYgKHBhcnRzW2ldID09PSAnbmV0d29yay1pZCcpIHsKCQkJCWNbJ25ldHdvcmstaWQnXSA9IHBhcnRzW2kgKyAxXTsKCQkJfSBlbHNlIGlmIChwYXJ0c1tpXSA9PT0gJ25ldHdvcmstY29zdCcpIHsKCQkJCWNbJ25ldHdvcmstY29zdCddID0gcGFydHNbaSArIDFdOwoJCQl9CgkJfQoJCXNkcC5tZWRpYS5maWx0ZXIoZnVuY3Rpb24gKG0pIHsKCQkJcmV0dXJuIG0udHlwZSA9PT0gY2FuZGlkYXRlLnNkcE1pZDsKCQl9KVswXS5jYW5kaWRhdGVzLnB1c2goYyk7Cgl9KTsKCglyZXR1cm4gX3NkcFRyYW5zZm9ybTIuZGVmYXVsdC53cml0ZShzZHApOwp9Cgp9LHsic2RwLXRyYW5zZm9ybSI6M31dfSx7fSxbNDVdKSg0NSkKfSk7",
      "sourceCodeClassname": "IMSIWProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-38b3da70-28d4-8082-38f1-b1709f6ee7695",
    "version": 1.9000000000000006,
    "description": "Description of IMSIWProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "sip.rethink-project.eu",
    "configuration": {
      "credential_server": "https://ims.rethink-project.eu/credential",
      "domain": "localhost"
    },
    "messageSchemas": "",
    "dataObjects": [
      "hyperty-catalogue://catalogue.localhost/.well-known/dataschema/Connection"
    ],
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": {
      "browser": true
    },
    "interworking": true
  }
}