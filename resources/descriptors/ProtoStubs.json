{
  "default": {
    "cguid": "4-63d99d6b-5450-81d4-ac0d-2455628f08d30",
    "type": "ProtoStubs",
    "version": 0.7,
    "sourcePackageURL": "/sourcePackage",
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTsKCmV4cG9ydHNbJ2RlZmF1bHQnXSA9IGFjdGl2YXRlOwoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9Cgp2YXIgVmVydHhQcm90b1N0dWIgPSAoZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgIF9jb250aW51b3VzT3BlbjogYm9vbGVhbgogICAgIF9ydW50aW1lUHJvdG9TdHViVVJMOiBzdHJpbmcKICAgIF9idXM6IE1pbmlCdXMKICAgIF9tc2dDYWxsYmFjazogKE1lc3NhZ2UpID0+IHZvaWQKICAgIF9jb25maWc6IHsgdXJsLCBydW50aW1lVVJMIH0KICAgICBfc29jazogKFdlYlNvY2tldCB8IFNvY2tKUykKICAgIF9yZU9wZW46IGJvb2xlYW4KICAqLwoKICAvKioKICAgKiBWZXJ0eCBQcm90b1N0dWIgY3JlYXRpb24KICAgKiBAcGFyYW0gIHtzdHJpbmd9IHJ1bnRpbWVQcm90b1N0dWJVUkwgLSBVUkwgdXNlZCBpbnRlcm5hbGx5IGZvciBtZXNzYWdlIGRlbGl2ZXJ5IHBvaW50LiBOb3QgdXNlZCBmb3IgTWVzc2FnZU5vZGUgZGVsaXZlci4KICAgKiBAcGFyYW0gIHtNaW5pQnVzfSBidXMgLSBNaW5pQnVzIHVzZWQgdG8gc2VuZC9yZWNlaXZlIG1lc3NhZ2VzLiBOb3JtYWxseSBjb25uZWN0ZWQgdG8gdGhlIE1lc3NhZ2VCdXMuCiAgICogQHBhcmFtICB7T2JqZWN0fSBjb25maWcgLSBNYW5kYXRvcnkgZmllbGRzIGFyZTogInVybCIgb2YgdGhlIE1lc3NhZ2VOb2RlIGFkZHJlc3MgYW5kICJydW50aW1lVVJMIi4KICAgKiBAcmV0dXJuIHtWZXJ0eFByb3RvU3R1Yn0KICAgKi8KCiAgZnVuY3Rpb24gVmVydHhQcm90b1N0dWIocnVudGltZVByb3RvU3R1YlVSTCwgYnVzLCBjb25maWcpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWZXJ0eFByb3RvU3R1Yik7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB0aGlzLl9pZCA9IDA7CiAgICB0aGlzLl9jb250aW51b3VzT3BlbiA9IHRydWU7CgogICAgdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCA9IHJ1bnRpbWVQcm90b1N0dWJVUkw7CiAgICB0aGlzLl9idXMgPSBidXM7CiAgICB0aGlzLl9jb25maWcgPSBjb25maWc7CgogICAgdGhpcy5fcnVudGltZVNlc3Npb25VUkwgPSBjb25maWcucnVudGltZVVSTDsKICAgIHRoaXMuX3JlT3BlbiA9IGZhbHNlOwoKICAgIGJ1cy5hZGRMaXN0ZW5lcignKicsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgX3RoaXMuX29wZW4oZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChfdGhpcy5fZmlsdGVyKG1zZykpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbVmVydHhQcm90b1N0dWI6IFByb3RvU3R1YiAtPiBNTl0nLCBtc2cpOwogICAgICAgICAgX3RoaXMuX3NvY2suc2VuZChKU09OLnN0cmluZ2lmeShtc2cpKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIGNvbmZpZ3VyYXRpb24gZm9yIHRoaXMgUHJvdG9TdHViCiAgICogQHJldHVybiB7T2JqZWN0fSAtIE1hbmRhdG9yeSBmaWVsZHMgYXJlOiAidXJsIiBvZiB0aGUgTWVzc2FnZU5vZGUgYWRkcmVzcyBhbmQgInJ1bnRpbWVVUkwiLgogICAqLwoKICBfY3JlYXRlQ2xhc3MoVmVydHhQcm90b1N0dWIsIFt7CiAgICBrZXk6ICdjb25uZWN0JywKCiAgICAvKioKICAgICAqIFRyeSB0byBvcGVuIHRoZSBjb25uZWN0aW9uIHRvIHRoZSBNZXNzYWdlTm9kZS4gQ29ubmVjdGlvbiBpcyBhdXRvIG1hbmFnZWQsIHRoZXJlIGlzIG5vIG5lZWQgdG8gY2FsbCB0aGlzIGV4cGxpY2l0bHkuCiAgICAgKiBIb3dldmVyLCBpZiAiZGlzY29ubmVjdCgpIiBpcyBjYWxsZWQsIGl0J3MgbmVjZXNzYXJ5IHRvIGNhbGwgdGhpcyB0byBlbmFibGUgY29ubmVjdGlvbnMgYWdhaW4uCiAgICAgKiBBIHN0YXR1cyBtZXNzYWdlIGlzIHNlbnQgdG8gInJ1bnRpbWVQcm90b1N0dWJVUkwvc3RhdHVzIiwgY29udGFpbmluZyB0aGUgdmFsdWUgImNvbm5lY3RlZCIgaWYgc3VjY2Vzc2Z1bCwgb3IgImRpc2Nvbm5lY3RlZCIgaWYgc29tZSBlcnJvciBvY2N1cnMuCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBjb25uZWN0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2NvbnRpbnVvdXNPcGVuID0gdHJ1ZTsKICAgICAgX3RoaXMuX29wZW4oZnVuY3Rpb24gKCkge30pOwogICAgfQoKICAgIC8qKgogICAgICogSXQgd2lsbCBkaXNjb25uZWN0IGFuZCBvcmRlciB0byBzdGF5IGRpc2Nvbm5lY3RlZC4gUmVjb25uZWN0aW9uIHRyaWVzLCB3aWxsIG5vdCBiZSBhdHRlbXB0ZWQsIHVubGVzcyAiY29ubmVjdCgpIiBpcyBjYWxsZWQuCiAgICAgKiBBIHN0YXR1cyBtZXNzYWdlIGlzIHNlbnQgdG8gInJ1bnRpbWVQcm90b1N0dWJVUkwvc3RhdHVzIiB3aXRoIHZhbHVlICJkaXNjb25uZWN0ZWQiLgogICAgICovCiAgfSwgewogICAga2V5OiAnZGlzY29ubmVjdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY29ubmVjdCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9jb250aW51b3VzT3BlbiA9IGZhbHNlOwogICAgICBpZiAoX3RoaXMuX3NvY2spIHsKICAgICAgICBfdGhpcy5fc2VuZENsb3NlKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc2VuZE9wZW4nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kT3BlbihjYWxsYmFjaykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2lkKys7CiAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgaWQ6IF90aGlzLl9pZCwgdHlwZTogJ29wZW4nLCBmcm9tOiBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwsIHRvOiAnbW46L3Nlc3Npb24nCiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX3JlT3BlbikgewogICAgICAgIG1zZy50eXBlID0gJ3JlLW9wZW4nOwogICAgICB9CgogICAgICAvL3JlZ2lzdGVyIGFuZCB3YWl0IGZvciBvcGVuIHJlcGx5Li4uCiAgICAgIHZhciBoYXNSZXNwb25zZSA9IGZhbHNlOwogICAgICBfdGhpcy5fc2Vzc2lvbkNhbGxiYWNrID0gZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgaWYgKHJlcGx5LnR5cGUgPT09ICdyZXNwb25zZScgJiByZXBseS5pZCA9PT0gbXNnLmlkKSB7CiAgICAgICAgICBoYXNSZXNwb25zZSA9IHRydWU7CiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgaWYgKHJlcGx5LmJvZHkucnVudGltZVRva2VuKSB7CiAgICAgICAgICAgICAgLy9zZXR1cCBydW50aW1lU2Vzc2lvbgogICAgICAgICAgICAgIF90aGlzLl9yZU9wZW4gPSB0cnVlOwogICAgICAgICAgICAgIF90aGlzLl9ydW50aW1lU2Vzc2lvblVSTCA9IF90aGlzLl9jb25maWcucnVudGltZVVSTCArICcvJyArIHJlcGx5LmJvZHkucnVudGltZVRva2VuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygnY29ubmVjdGVkJyk7CiAgICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygnZGlzY29ubmVjdGVkJywgcmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CgogICAgICBfdGhpcy5fc29jay5zZW5kKEpTT04uc3RyaW5naWZ5KG1zZykpOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWhhc1Jlc3BvbnNlKSB7CiAgICAgICAgICAvL25vIHJlc3BvbnNlIGFmdGVyIHggc2Vjb25kcy4uLgogICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2Rpc2Nvbm5lY3RlZCcsICdUaW1lb3V0IGZyb20gbW46L3Nlc3Npb24nKTsKICAgICAgICB9CiAgICAgIH0sIDMwMDApOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZW5kQ2xvc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kQ2xvc2UoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5faWQrKzsKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICBpZDogX3RoaXMuX2lkLCB0eXBlOiAnY2xvc2UnLCBmcm9tOiBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwsIHRvOiAnbW46L3Nlc3Npb24nCiAgICAgIH07CgogICAgICAvL2ludmFsaWRhdGUgcnVudGltZVNlc3Npb24KICAgICAgX3RoaXMuX3JlT3BlbiA9IGZhbHNlOwogICAgICBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwgPSBfdGhpcy5fY29uZmlnLl9ydW50aW1lVVJMOwoKICAgICAgX3RoaXMuX3NvY2suc2VuZChKU09OLnN0cmluZ2lmeShtc2cpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc2VuZFN0YXR1cycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRTdGF0dXModmFsdWUsIHJlYXNvbikgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIG1zZyA9IHsKICAgICAgICB0eXBlOiAndXBkYXRlJywKICAgICAgICBmcm9tOiBfdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCwKICAgICAgICB0bzogX3RoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgKyAnL3N0YXR1cycsCiAgICAgICAgYm9keTogewogICAgICAgICAgdmFsdWU6IHZhbHVlCiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKHJlYXNvbikgewogICAgICAgIG1zZy5ib2R5LmRlc2MgPSByZWFzb247CiAgICAgIH0KCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfd2FpdFJlYWR5JywKICAgIHZhbHVlOiBmdW5jdGlvbiBfd2FpdFJlYWR5KGNhbGxiYWNrKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoX3RoaXMuX3NvY2sucmVhZHlTdGF0ZSA9PT0gMSkgewogICAgICAgIGNhbGxiYWNrKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5fd2FpdFJlYWR5KGNhbGxiYWNrKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19maWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maWx0ZXIobXNnKSB7CiAgICAgIGlmIChtc2cuYm9keSAmJiBtc2cuYm9keS52aWEgPT09IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwpIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2RlbGl2ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxpdmVyKG1zZykgewogICAgICBpZiAoIW1zZy5ib2R5KSBtc2cuYm9keSA9IHt9OwoKICAgICAgbXNnLmJvZHkudmlhID0gdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTDsKICAgICAgY29uc29sZS5sb2coJ1tWZXJ0eFByb3RvU3R1YjogTU4gLT4gUHJvdG9TdHViXScsIG1zZyk7CiAgICAgIHRoaXMuX2J1cy5wb3N0TWVzc2FnZShtc2cpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vcGVuJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb3BlbihjYWxsYmFjaykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLl9jb250aW51b3VzT3BlbikgewogICAgICAgIC8vVE9ETzogc2VuZCBzdGF0dXMgKHNlbnQgbWVzc2FnZSBlcnJvciAtIGRpc2Nvbm5lY3RlZCkKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghX3RoaXMuX3NvY2spIHsKICAgICAgICBpZiAoX3RoaXMuX2NvbmZpZy51cmwuc3Vic3RyaW5nKDAsIDIpID09PSAnd3MnKSB7CiAgICAgICAgICBfdGhpcy5fc29jayA9IG5ldyBXZWJTb2NrZXQoX3RoaXMuX2NvbmZpZy51cmwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpcy5fc29jayA9IG5ldyBTb2NrSlMoX3RoaXMuX2NvbmZpZy51cmwpOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMuX3NvY2sub25vcGVuID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMuX3NlbmRPcGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICAgIH0pOwogICAgICAgIH07CgogICAgICAgIF90aGlzLl9zb2NrLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICB2YXIgbXNnID0gSlNPTi5wYXJzZShlLmRhdGEpOwoKICAgICAgICAgIGNvbnNvbGUubG9nKCdbVmVydHhQcm90b1N0dWI6IE1OIC0+IFNPQ0tFVCBPTiBNRVNTQUdFXScsIG1zZyk7CgogICAgICAgICAgaWYgKG1zZy5mcm9tID09PSAnbW46L3Nlc3Npb24nKSB7CiAgICAgICAgICAgIGlmIChfdGhpcy5fc2Vzc2lvbkNhbGxiYWNrKSB7CiAgICAgICAgICAgICAgX3RoaXMuX3Nlc3Npb25DYWxsYmFjayhtc2cpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdGhpcy5fZGVsaXZlcihtc2cpOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIF90aGlzLl9zb2NrLm9uY2xvc2UgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIHZhciByZWFzb24gPSB1bmRlZmluZWQ7CgogICAgICAgICAgLy9TZWUgaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzY0NTUjc2VjdGlvbi03LjQKICAgICAgICAgIGlmIChldmVudC5jb2RlID09PSAxMDAwKSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdOb3JtYWwgY2xvc3VyZSwgbWVhbmluZyB0aGF0IHRoZSBwdXJwb3NlIGZvciB3aGljaCB0aGUgY29ubmVjdGlvbiB3YXMgZXN0YWJsaXNoZWQgaGFzIGJlZW4gZnVsZmlsbGVkLic7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDEpIHsKICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIFwnZ29pbmcgYXdheVwnLCBzdWNoIGFzIGEgc2VydmVyIGdvaW5nIGRvd24gb3IgYSBicm93c2VyIGhhdmluZyBuYXZpZ2F0ZWQgYXdheSBmcm9tIGEgcGFnZS4nOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDAyKSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBkdWUgdG8gYSBwcm90b2NvbCBlcnJvcic7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDMpIHsKICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgaGFzIHJlY2VpdmVkIGEgdHlwZSBvZiBkYXRhIGl0IGNhbm5vdCBhY2NlcHQgKGUuZy4sIGFuIGVuZHBvaW50IHRoYXQgdW5kZXJzdGFuZHMgb25seSB0ZXh0IGRhdGEgTUFZIHNlbmQgdGhpcyBpZiBpdCByZWNlaXZlcyBhIGJpbmFyeSBtZXNzYWdlKS4nOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA0KSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdSZXNlcnZlZC4gVGhlIHNwZWNpZmljIG1lYW5pbmcgbWlnaHQgYmUgZGVmaW5lZCBpbiB0aGUgZnV0dXJlLic7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDUpIHsKICAgICAgICAgICAgcmVhc29uID0gJ05vIHN0YXR1cyBjb2RlIHdhcyBhY3R1YWxseSBwcmVzZW50Lic7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDYpIHsKICAgICAgICAgICAgcmVhc29uID0gJ1RoZSBjb25uZWN0aW9uIHdhcyBjbG9zZWQgYWJub3JtYWxseSwgZS5nLiwgd2l0aG91dCBzZW5kaW5nIG9yIHJlY2VpdmluZyBhIENsb3NlIGNvbnRyb2wgZnJhbWUnOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA3KSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGhhcyByZWNlaXZlZCBkYXRhIHdpdGhpbiBhIG1lc3NhZ2UgdGhhdCB3YXMgbm90IGNvbnNpc3RlbnQgd2l0aCB0aGUgdHlwZSBvZiB0aGUgbWVzc2FnZSAoZS5nLiwgbm9uLVVURi04IFtodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzNjI5XSBkYXRhIHdpdGhpbiBhIHRleHQgbWVzc2FnZSkuJzsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwOCkgewogICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBoYXMgcmVjZWl2ZWQgYSBtZXNzYWdlIHRoYXQgInZpb2xhdGVzIGl0cyBwb2xpY3kiLiBUaGlzIHJlYXNvbiBpcyBnaXZlbiBlaXRoZXIgaWYgdGhlcmUgaXMgbm8gb3RoZXIgc3V0aWJsZSByZWFzb24sIG9yIGlmIHRoZXJlIGlzIGEgbmVlZCB0byBoaWRlIHNwZWNpZmljIGRldGFpbHMgYWJvdXQgdGhlIHBvbGljeS4nOwogICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA5KSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGhhcyByZWNlaXZlZCBhIG1lc3NhZ2UgdGhhdCBpcyB0b28gYmlnIGZvciBpdCB0byBwcm9jZXNzLic7CiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMTApIHsKICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IChjbGllbnQpIGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgaGFzIGV4cGVjdGVkIHRoZSBzZXJ2ZXIgdG8gbmVnb3RpYXRlIG9uZSBvciBtb3JlIGV4dGVuc2lvbiwgYnV0IHRoZSBzZXJ2ZXIgZGlkblwndCByZXR1cm4gdGhlbSBpbiB0aGUgcmVzcG9uc2UgbWVzc2FnZSBvZiB0aGUgV2ViU29ja2V0IGhhbmRzaGFrZS4gPGJyIC8+IFNwZWNpZmljYWxseSwgdGhlIGV4dGVuc2lvbnMgdGhhdCBhcmUgbmVlZGVkIGFyZTogJyArIGV2ZW50LnJlYXNvbjsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAxMSkgewogICAgICAgICAgICByZWFzb24gPSAnQSBzZXJ2ZXIgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBlbmNvdW50ZXJlZCBhbiB1bmV4cGVjdGVkIGNvbmRpdGlvbiB0aGF0IHByZXZlbnRlZCBpdCBmcm9tIGZ1bGZpbGxpbmcgdGhlIHJlcXVlc3QuJzsKICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAxNSkgewogICAgICAgICAgICByZWFzb24gPSAnVGhlIGNvbm5lY3Rpb24gd2FzIGNsb3NlZCBkdWUgdG8gYSBmYWlsdXJlIHRvIHBlcmZvcm0gYSBUTFMgaGFuZHNoYWtlIChlLmcuLCB0aGUgc2VydmVyIGNlcnRpZmljYXRlIGNhblwndCBiZSB2ZXJpZmllZCkuJzsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlYXNvbiA9ICdVbmtub3duIHJlYXNvbic7CiAgICAgICAgICB9CgogICAgICAgICAgZGVsZXRlIF90aGlzLl9zb2NrOwogICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2Rpc2Nvbm5lY3RlZCcsIHJlYXNvbik7CiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpcy5fd2FpdFJlYWR5KGNhbGxiYWNrKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ2NvbmZpZycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdydW50aW1lU2Vzc2lvbicsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3J1bnRpbWVTZXNzaW9uVVJMOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFZlcnR4UHJvdG9TdHViOwp9KSgpOwoKZnVuY3Rpb24gYWN0aXZhdGUodXJsLCBidXMsIGNvbmZpZykgewogIHJldHVybiB7CiAgICBuYW1lOiAnVmVydHhQcm90b1N0dWInLAogICAgaW5zdGFuY2U6IG5ldyBWZXJ0eFByb3RvU3R1Yih1cmwsIGJ1cywgY29uZmlnKQogIH07Cn0KCi8qKgoqIENhbGxiYWNrIHVzZWQgdG8gc2VuZCBtZXNzYWdlcwoqIEBjYWxsYmFjayBQb3N0TWVzc2FnZQoqIEBwYXJhbSB7TWVzc2FnZX0gbXNnIC0gTWVzc2FnZSB0byBzZW5kCiovCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7fV19LHt9LFsxXSkoMSkKfSk7Cg==",
      "sourceCodeClassname": "VertxProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "language": "javascript",
    "signature": "",
    "messageSchemas": "",
    "configuration": {
      "url": "wss://msg-node.localhost:9090/ws"
    },
    "constraints": "",
    "hypertyCapabilities": "",
    "protocolCapabilities": "",
    "policies": "",
    "dataObjects": [],
    "interworking": false,
    "description": "Description of VertxProtoStub",
    "objectName": "VertxProtoStub",
    "accessControlPolicy": "somePolicy"
  },
  "VertxProtoStubNode": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiYWN0aXZhdGUiLCBbXSwgZmFjdG9yeSk7CgllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JykKCQlleHBvcnRzWyJhY3RpdmF0ZSJdID0gZmFjdG9yeSgpOwoJZWxzZQoJCXJvb3RbImFjdGl2YXRlIl0gPSBmYWN0b3J5KCk7Cn0pKHRoaXMsIGZ1bmN0aW9uKCkgewpyZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsKCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewoKLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7CgovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewovKioqKioqLyAJCQlleHBvcnRzOiB7fSwKLyoqKioqKi8gCQkJaWQ6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsb2FkZWQ6IGZhbHNlCi8qKioqKiovIAkJfTsKCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7CgovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubG9hZGVkID0gdHJ1ZTsKCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9CgoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwoKLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwovKioqKioqLyB9KQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAoWwovKiAwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLyoqCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovCgoJZXhwb3J0cy5kZWZhdWx0ID0gYWN0aXZhdGU7CgoJX193ZWJwYWNrX3JlcXVpcmVfXyghKGZ1bmN0aW9uIHdlYnBhY2tNaXNzaW5nTW9kdWxlKCkgeyB2YXIgZSA9IG5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlIFwiZnNcIiIpOyBlLmNvZGUgPSAnTU9EVUxFX05PVF9GT1VORCc7IHRocm93IGU7IH0oKSkpOwoKCXZhciBfd3MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpOwoKCXZhciBfd3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfd3MpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgoJdmFyIFZlcnR4UHJvdG9TdHViID0gZnVuY3Rpb24gKCkgewoJICAvKiBwcml2YXRlCgkgICAgX2NvbnRpbnVvdXNPcGVuOiBib29sZWFuCgkgICAgIF9ydW50aW1lUHJvdG9TdHViVVJMOiBzdHJpbmcKCSAgICBfYnVzOiBNaW5pQnVzCgkgICAgX21zZ0NhbGxiYWNrOiAoTWVzc2FnZSkgPT4gdm9pZAoJICAgIF9jb25maWc6IHsgdXJsLCBydW50aW1lVVJMIH0KCSAgICAgX3NvY2s6IChXZWJTb2NrZXQgfCBTb2NrSlMpCgkgICAgX3JlT3BlbjogYm9vbGVhbgoJICAqLwoKCSAgLyoqCgkgICAqIFZlcnR4IFByb3RvU3R1YiBjcmVhdGlvbgoJICAgKiBAcGFyYW0gIHtzdHJpbmd9IHJ1bnRpbWVQcm90b1N0dWJVUkwgLSBVUkwgdXNlZCBpbnRlcm5hbGx5IGZvciBtZXNzYWdlIGRlbGl2ZXJ5IHBvaW50LiBOb3QgdXNlZCBmb3IgTWVzc2FnZU5vZGUgZGVsaXZlci4KCSAgICogQHBhcmFtICB7TWluaUJ1c30gYnVzIC0gTWluaUJ1cyB1c2VkIHRvIHNlbmQvcmVjZWl2ZSBtZXNzYWdlcy4gTm9ybWFsbHkgY29ubmVjdGVkIHRvIHRoZSBNZXNzYWdlQnVzLgoJICAgKiBAcGFyYW0gIHtPYmplY3R9IGNvbmZpZyAtIE1hbmRhdG9yeSBmaWVsZHMgYXJlOiAidXJsIiBvZiB0aGUgTWVzc2FnZU5vZGUgYWRkcmVzcyBhbmQgInJ1bnRpbWVVUkwiLgoJICAgKiBAcmV0dXJuIHtWZXJ0eFByb3RvU3R1Yn0KCSAgICovCgkgIGZ1bmN0aW9uIFZlcnR4UHJvdG9TdHViKHJ1bnRpbWVQcm90b1N0dWJVUkwsIGJ1cywgY29uZmlnKSB7CgkgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZlcnR4UHJvdG9TdHViKTsKCgkgICAgaWYgKCFydW50aW1lUHJvdG9TdHViVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBydW50aW1lUHJvdG9TdHViVVJMIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoJICAgIGlmICghYnVzKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBidXMgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CgkgICAgaWYgKCFjb25maWcpIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZyBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCgkgICAgaWYgKCFjb25maWcudXJsKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWcudXJsIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoJICAgIGlmICghY29uZmlnLnJ1bnRpbWVVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZy5ydW50aW1lVVJMIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoKCSAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICB0aGlzLl9pZCA9IDA7CgkgICAgdGhpcy5fY29udGludW91c09wZW4gPSB0cnVlOwoKCSAgICB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMID0gcnVudGltZVByb3RvU3R1YlVSTDsKCSAgICB0aGlzLl9idXMgPSBidXM7CgkgICAgdGhpcy5fY29uZmlnID0gY29uZmlnOwoKCSAgICB0aGlzLl9ydW50aW1lU2Vzc2lvblVSTCA9IGNvbmZpZy5ydW50aW1lVVJMOwoJICAgIHRoaXMuX3JlT3BlbiA9IGZhbHNlOwoKCSAgICBidXMuYWRkTGlzdGVuZXIoJyonLCBmdW5jdGlvbiAobXNnKSB7CgkgICAgICBfdGhpcy5fb3BlbihmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmIChfdGhpcy5fZmlsdGVyKG1zZykpIHsKCSAgICAgICAgICBfdGhpcy5fc29jay5zZW5kKEpTT04uc3RyaW5naWZ5KG1zZykpOwoJICAgICAgICB9CgkgICAgICB9KTsKCSAgICB9KTsKCSAgfQoKCSAgLyoqCgkgICAqIEdldCB0aGUgY29uZmlndXJhdGlvbiBmb3IgdGhpcyBQcm90b1N0dWIKCSAgICogQHJldHVybiB7T2JqZWN0fSAtIE1hbmRhdG9yeSBmaWVsZHMgYXJlOiAidXJsIiBvZiB0aGUgTWVzc2FnZU5vZGUgYWRkcmVzcyBhbmQgInJ1bnRpbWVVUkwiLgoJICAgKi8KCgoJICBfY3JlYXRlQ2xhc3MoVmVydHhQcm90b1N0dWIsIFt7CgkgICAga2V5OiAnY29ubmVjdCcsCgoKCSAgICAvKioKCSAgICAgKiBUcnkgdG8gb3BlbiB0aGUgY29ubmVjdGlvbiB0byB0aGUgTWVzc2FnZU5vZGUuIENvbm5lY3Rpb24gaXMgYXV0byBtYW5hZ2VkLCB0aGVyZSBpcyBubyBuZWVkIHRvIGNhbGwgdGhpcyBleHBsaWNpdGx5LgoJICAgICAqIEhvd2V2ZXIsIGlmICJkaXNjb25uZWN0KCkiIGlzIGNhbGxlZCwgaXQncyBuZWNlc3NhcnkgdG8gY2FsbCB0aGlzIHRvIGVuYWJsZSBjb25uZWN0aW9ucyBhZ2Fpbi4KCSAgICAgKiBBIHN0YXR1cyBtZXNzYWdlIGlzIHNlbnQgdG8gInJ1bnRpbWVQcm90b1N0dWJVUkwvc3RhdHVzIiwgY29udGFpbmluZyB0aGUgdmFsdWUgImNvbm5lY3RlZCIgaWYgc3VjY2Vzc2Z1bCwgb3IgImRpc2Nvbm5lY3RlZCIgaWYgc29tZSBlcnJvciBvY2N1cnMuCgkgICAgICovCgkgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbm5lY3QoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9jb250aW51b3VzT3BlbiA9IHRydWU7CgkgICAgICBfdGhpcy5fb3BlbihmdW5jdGlvbiAoKSB7fSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBJdCB3aWxsIGRpc2Nvbm5lY3QgYW5kIG9yZGVyIHRvIHN0YXkgZGlzY29ubmVjdGVkLiBSZWNvbm5lY3Rpb24gdHJpZXMsIHdpbGwgbm90IGJlIGF0dGVtcHRlZCwgdW5sZXNzICJjb25uZWN0KCkiIGlzIGNhbGxlZC4KCSAgICAgKiBBIHN0YXR1cyBtZXNzYWdlIGlzIHNlbnQgdG8gInJ1bnRpbWVQcm90b1N0dWJVUkwvc3RhdHVzIiB3aXRoIHZhbHVlICJkaXNjb25uZWN0ZWQiLgoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ2Rpc2Nvbm5lY3QnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb25uZWN0KCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBfdGhpcy5fY29udGludW91c09wZW4gPSBmYWxzZTsKCSAgICAgIGlmIChfdGhpcy5fc29jaykgewoJICAgICAgICBfdGhpcy5fc2VuZENsb3NlKCk7CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3NlbmRPcGVuJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRPcGVuKGNhbGxiYWNrKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9pZCsrOwoJICAgICAgdmFyIG1zZyA9IHsKCSAgICAgICAgaWQ6IF90aGlzLl9pZCwgdHlwZTogJ29wZW4nLCBmcm9tOiBfdGhpcy5fcnVudGltZVNlc3Npb25VUkwsIHRvOiAnbW46L3Nlc3Npb24nCgkgICAgICB9OwoKCSAgICAgIGlmIChfdGhpcy5fcmVPcGVuKSB7CgkgICAgICAgIG1zZy50eXBlID0gJ3JlLW9wZW4nOwoJICAgICAgfQoKCSAgICAgIC8vcmVnaXN0ZXIgYW5kIHdhaXQgZm9yIG9wZW4gcmVwbHkuLi4KCSAgICAgIHZhciBoYXNSZXNwb25zZSA9IGZhbHNlOwoJICAgICAgX3RoaXMuX3Nlc3Npb25DYWxsYmFjayA9IGZ1bmN0aW9uIChyZXBseSkgewoJICAgICAgICBpZiAocmVwbHkudHlwZSA9PT0gJ3Jlc3BvbnNlJyAmIHJlcGx5LmlkID09PSBtc2cuaWQpIHsKCSAgICAgICAgICBoYXNSZXNwb25zZSA9IHRydWU7CgkgICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CgkgICAgICAgICAgICBpZiAocmVwbHkuYm9keS5ydW50aW1lVG9rZW4pIHsKCSAgICAgICAgICAgICAgLy9zZXR1cCBydW50aW1lU2Vzc2lvbgoJICAgICAgICAgICAgICBfdGhpcy5fcmVPcGVuID0gdHJ1ZTsKCSAgICAgICAgICAgICAgX3RoaXMuX3J1bnRpbWVTZXNzaW9uVVJMID0gX3RoaXMuX2NvbmZpZy5ydW50aW1lVVJMICsgJy8nICsgcmVwbHkuYm9keS5ydW50aW1lVG9rZW47CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2Nvbm5lY3RlZCcpOwoJICAgICAgICAgICAgY2FsbGJhY2soKTsKCSAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2Rpc2Nvbm5lY3RlZCcsIHJlcGx5LmJvZHkuZGVzYyk7CgkgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICB9OwoKCSAgICAgIF90aGlzLl9zb2NrLnNlbmQoSlNPTi5zdHJpbmdpZnkobXNnKSk7CgkgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKCFoYXNSZXNwb25zZSkgewoJICAgICAgICAgIC8vbm8gcmVzcG9uc2UgYWZ0ZXIgeCBzZWNvbmRzLi4uCgkgICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2Rpc2Nvbm5lY3RlZCcsICdUaW1lb3V0IGZyb20gbW46L3Nlc3Npb24nKTsKCSAgICAgICAgfQoJICAgICAgfSwgMzAwMCk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3NlbmRDbG9zZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kQ2xvc2UoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9pZCsrOwoJICAgICAgdmFyIG1zZyA9IHsKCSAgICAgICAgaWQ6IF90aGlzLl9pZCwgdHlwZTogJ2Nsb3NlJywgZnJvbTogX3RoaXMuX3J1bnRpbWVTZXNzaW9uVVJMLCB0bzogJ21uOi9zZXNzaW9uJwoJICAgICAgfTsKCgkgICAgICAvL2ludmFsaWRhdGUgcnVudGltZVNlc3Npb24KCSAgICAgIF90aGlzLl9yZU9wZW4gPSBmYWxzZTsKCSAgICAgIF90aGlzLl9ydW50aW1lU2Vzc2lvblVSTCA9IF90aGlzLl9jb25maWcuX3J1bnRpbWVVUkw7CgoJICAgICAgX3RoaXMuX3NvY2suc2VuZChKU09OLnN0cmluZ2lmeShtc2cpKTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfc2VuZFN0YXR1cycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kU3RhdHVzKHZhbHVlLCByZWFzb24pIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgdmFyIG1zZyA9IHsKCSAgICAgICAgdHlwZTogJ3VwZGF0ZScsCgkgICAgICAgIGZyb206IF90aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMLAoJICAgICAgICB0bzogX3RoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgKyAnL3N0YXR1cycsCgkgICAgICAgIGJvZHk6IHsKCSAgICAgICAgICB2YWx1ZTogdmFsdWUKCSAgICAgICAgfQoJICAgICAgfTsKCgkgICAgICBpZiAocmVhc29uKSB7CgkgICAgICAgIG1zZy5ib2R5LmRlc2MgPSByZWFzb247CgkgICAgICB9CgoJICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShtc2cpOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ193YWl0UmVhZHknLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfd2FpdFJlYWR5KGNhbGxiYWNrKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGlmIChfdGhpcy5fc29jay5yZWFkeVN0YXRlID09PSAxKSB7CgkgICAgICAgIGNhbGxiYWNrKCk7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICBfdGhpcy5fd2FpdFJlYWR5KGNhbGxiYWNrKTsKCSAgICAgICAgfSk7CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2ZpbHRlcicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9maWx0ZXIobXNnKSB7CgkgICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkudmlhID09PSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMKSByZXR1cm4gZmFsc2U7CgkgICAgICByZXR1cm4gdHJ1ZTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfZGVsaXZlcicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxpdmVyKG1zZykgewoJICAgICAgaWYgKCFtc2cuYm9keSkgbXNnLmJvZHkgPSB7fTsKCgkgICAgICBtc2cuYm9keS52aWEgPSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMOwoJICAgICAgdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1zZyk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX29wZW4nLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb3BlbihjYWxsYmFjaykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBpZiAoIXRoaXMuX2NvbnRpbnVvdXNPcGVuKSB7CgkgICAgICAgIC8vVE9ETzogc2VuZCBzdGF0dXMgKHNlbnQgbWVzc2FnZSBlcnJvciAtIGRpc2Nvbm5lY3RlZCkKCSAgICAgICAgcmV0dXJuOwoJICAgICAgfQoKCSAgICAgIGlmICghX3RoaXMuX3NvY2spIHsKCSAgICAgICAgaWYgKF90aGlzLl9jb25maWcudXJsLnN1YnN0cmluZygwLCAyKSA9PT0gJ3dzJykgewoJICAgICAgICAgIGNvbnNvbGUubG9nKF93czIuZGVmYXVsdCk7CgoJICAgICAgICAgIF90aGlzLl9zb2NrID0gbmV3IF93czIuZGVmYXVsdChfdGhpcy5fY29uZmlnLnVybCk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgX3RoaXMuX3NvY2sgPSBuZXcgU29ja0pTKF90aGlzLl9jb25maWcudXJsKTsKCSAgICAgICAgfQoKCSAgICAgICAgX3RoaXMuX3NvY2sub25vcGVuID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAgIF90aGlzLl9zZW5kT3BlbihmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBjYWxsYmFjaygpOwoJICAgICAgICAgIH0pOwoJICAgICAgICB9OwoKCSAgICAgICAgX3RoaXMuX3NvY2sub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICB2YXIgbXNnID0gSlNPTi5wYXJzZShlLmRhdGEpOwoJICAgICAgICAgIGlmIChtc2cuZnJvbSA9PT0gJ21uOi9zZXNzaW9uJykgewoJICAgICAgICAgICAgaWYgKF90aGlzLl9zZXNzaW9uQ2FsbGJhY2spIHsKCSAgICAgICAgICAgICAgX3RoaXMuX3Nlc3Npb25DYWxsYmFjayhtc2cpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBfdGhpcy5fZGVsaXZlcihtc2cpOwoJICAgICAgICAgIH0KCSAgICAgICAgfTsKCgkgICAgICAgIF90aGlzLl9zb2NrLm9uY2xvc2UgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCSAgICAgICAgICB2YXIgcmVhc29uID0gdm9pZCAwOwoKCSAgICAgICAgICAvL1NlZSBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjNjQ1NSNzZWN0aW9uLTcuNAoJICAgICAgICAgIGlmIChldmVudC5jb2RlID09PSAxMDAwKSB7CgkgICAgICAgICAgICByZWFzb24gPSAnTm9ybWFsIGNsb3N1cmUsIG1lYW5pbmcgdGhhdCB0aGUgcHVycG9zZSBmb3Igd2hpY2ggdGhlIGNvbm5lY3Rpb24gd2FzIGVzdGFibGlzaGVkIGhhcyBiZWVuIGZ1bGZpbGxlZC4nOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwMSkgewoJICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIFwnZ29pbmcgYXdheVwnLCBzdWNoIGFzIGEgc2VydmVyIGdvaW5nIGRvd24gb3IgYSBicm93c2VyIGhhdmluZyBuYXZpZ2F0ZWQgYXdheSBmcm9tIGEgcGFnZS4nOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAwMikgewoJICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGR1ZSB0byBhIHByb3RvY29sIGVycm9yJzsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDMpIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGhhcyByZWNlaXZlZCBhIHR5cGUgb2YgZGF0YSBpdCBjYW5ub3QgYWNjZXB0IChlLmcuLCBhbiBlbmRwb2ludCB0aGF0IHVuZGVyc3RhbmRzIG9ubHkgdGV4dCBkYXRhIE1BWSBzZW5kIHRoaXMgaWYgaXQgcmVjZWl2ZXMgYSBiaW5hcnkgbWVzc2FnZSkuJzsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDQpIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdSZXNlcnZlZC4gVGhlIHNwZWNpZmljIG1lYW5pbmcgbWlnaHQgYmUgZGVmaW5lZCBpbiB0aGUgZnV0dXJlLic7CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA1KSB7CgkgICAgICAgICAgICByZWFzb24gPSAnTm8gc3RhdHVzIGNvZGUgd2FzIGFjdHVhbGx5IHByZXNlbnQuJzsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDYpIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdUaGUgY29ubmVjdGlvbiB3YXMgY2xvc2VkIGFibm9ybWFsbHksIGUuZy4sIHdpdGhvdXQgc2VuZGluZyBvciByZWNlaXZpbmcgYSBDbG9zZSBjb250cm9sIGZyYW1lJzsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDcpIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGhhcyByZWNlaXZlZCBkYXRhIHdpdGhpbiBhIG1lc3NhZ2UgdGhhdCB3YXMgbm90IGNvbnNpc3RlbnQgd2l0aCB0aGUgdHlwZSBvZiB0aGUgbWVzc2FnZSAoZS5nLiwgbm9uLVVURi04IFtodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzNjI5XSBkYXRhIHdpdGhpbiBhIHRleHQgbWVzc2FnZSkuJzsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMDgpIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdBbiBlbmRwb2ludCBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGhhcyByZWNlaXZlZCBhIG1lc3NhZ2UgdGhhdCAidmlvbGF0ZXMgaXRzIHBvbGljeSIuIFRoaXMgcmVhc29uIGlzIGdpdmVuIGVpdGhlciBpZiB0aGVyZSBpcyBubyBvdGhlciBzdXRpYmxlIHJlYXNvbiwgb3IgaWYgdGhlcmUgaXMgYSBuZWVkIHRvIGhpZGUgc3BlY2lmaWMgZGV0YWlscyBhYm91dCB0aGUgcG9saWN5Lic7CgkgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAxMDA5KSB7CgkgICAgICAgICAgICByZWFzb24gPSAnQW4gZW5kcG9pbnQgaXMgdGVybWluYXRpbmcgdGhlIGNvbm5lY3Rpb24gYmVjYXVzZSBpdCBoYXMgcmVjZWl2ZWQgYSBtZXNzYWdlIHRoYXQgaXMgdG9vIGJpZyBmb3IgaXQgdG8gcHJvY2Vzcy4nOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAxMCkgewoJICAgICAgICAgICAgcmVhc29uID0gJ0FuIGVuZHBvaW50IChjbGllbnQpIGlzIHRlcm1pbmF0aW5nIHRoZSBjb25uZWN0aW9uIGJlY2F1c2UgaXQgaGFzIGV4cGVjdGVkIHRoZSBzZXJ2ZXIgdG8gbmVnb3RpYXRlIG9uZSBvciBtb3JlIGV4dGVuc2lvbiwgYnV0IHRoZSBzZXJ2ZXIgZGlkblwndCByZXR1cm4gdGhlbSBpbiB0aGUgcmVzcG9uc2UgbWVzc2FnZSBvZiB0aGUgV2ViU29ja2V0IGhhbmRzaGFrZS4gPGJyIC8+IFNwZWNpZmljYWxseSwgdGhlIGV4dGVuc2lvbnMgdGhhdCBhcmUgbmVlZGVkIGFyZTogJyArIGV2ZW50LnJlYXNvbjsKCSAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmNvZGUgPT09IDEwMTEpIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdBIHNlcnZlciBpcyB0ZXJtaW5hdGluZyB0aGUgY29ubmVjdGlvbiBiZWNhdXNlIGl0IGVuY291bnRlcmVkIGFuIHVuZXhwZWN0ZWQgY29uZGl0aW9uIHRoYXQgcHJldmVudGVkIGl0IGZyb20gZnVsZmlsbGluZyB0aGUgcmVxdWVzdC4nOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gMTAxNSkgewoJICAgICAgICAgICAgcmVhc29uID0gJ1RoZSBjb25uZWN0aW9uIHdhcyBjbG9zZWQgZHVlIHRvIGEgZmFpbHVyZSB0byBwZXJmb3JtIGEgVExTIGhhbmRzaGFrZSAoZS5nLiwgdGhlIHNlcnZlciBjZXJ0aWZpY2F0ZSBjYW5cJ3QgYmUgdmVyaWZpZWQpLic7CgkgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIHJlYXNvbiA9ICdVbmtub3duIHJlYXNvbic7CgkgICAgICAgICAgfQoKCSAgICAgICAgICBkZWxldGUgX3RoaXMuX3NvY2s7CgkgICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoJ2Rpc2Nvbm5lY3RlZCcsIHJlYXNvbik7CgkgICAgICAgIH07CgkgICAgICB9IGVsc2UgewoJICAgICAgICBfdGhpcy5fd2FpdFJlYWR5KGNhbGxiYWNrKTsKCSAgICAgIH0KCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdjb25maWcnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZzsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdydW50aW1lU2Vzc2lvbicsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fcnVudGltZVNlc3Npb25VUkw7CgkgICAgfQoJICB9XSk7CgoJICByZXR1cm4gVmVydHhQcm90b1N0dWI7Cgl9KCk7CgoJZnVuY3Rpb24gYWN0aXZhdGUodXJsLCBidXMsIGNvbmZpZykgewoJICByZXR1cm4gewoJICAgIG5hbWU6ICdWZXJ0eFByb3RvU3R1YicsCgkgICAgaW5zdGFuY2U6IG5ldyBWZXJ0eFByb3RvU3R1Yih1cmwsIGJ1cywgY29uZmlnKQoJICB9OwoJfQoKCS8qKgoJKiBDYWxsYmFjayB1c2VkIHRvIHNlbmQgbWVzc2FnZXMKCSogQGNhbGxiYWNrIFBvc3RNZXNzYWdlCgkqIEBwYXJhbSB7TWVzc2FnZX0gbXNnIC0gTWVzc2FnZSB0byBzZW5kCgkqLwoKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiEKCSAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudAoJICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+CgkgKiBNSVQgTGljZW5zZWQKCSAqLwoKCSd1c2Ugc3RyaWN0JzsKCgljb25zdCBXZWJTb2NrZXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpOwoKCVdlYlNvY2tldC5TZXJ2ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExMSk7CglXZWJTb2NrZXQuUmVjZWl2ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk1KTsKCVdlYlNvY2tldC5TZW5kZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExMCk7CgoJbW9kdWxlLmV4cG9ydHMgPSBXZWJTb2NrZXQ7CgoKLyoqKi8gfSwKLyogMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiEKCSAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudAoJICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+CgkgKiBNSVQgTGljZW5zZWQKCSAqLwoKCSd1c2Ugc3RyaWN0JzsKCgljb25zdCBFdmVudEVtaXR0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoJY29uc3QgY3J5cHRvID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsKCWNvbnN0IFVsdHJvbiA9IF9fd2VicGFja19yZXF1aXJlX18oNjIpOwoJY29uc3QgaHR0cHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYzKTsKCWNvbnN0IGh0dHAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY0KTsKCWNvbnN0IHVybCA9IF9fd2VicGFja19yZXF1aXJlX18oNzEpOwoKCWNvbnN0IFBlck1lc3NhZ2VEZWZsYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3OCk7Cgljb25zdCBFdmVudFRhcmdldCA9IF9fd2VicGFja19yZXF1aXJlX18oOTMpOwoJY29uc3QgRXh0ZW5zaW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oOTQpOwoJY29uc3QgUmVjZWl2ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk1KTsKCWNvbnN0IFNlbmRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTEwKTsKCgljb25zdCBHVUlEID0gJzI1OEVBRkE1LUU5MTQtNDdEQS05NUNBLUM1QUIwREM4NUIxMSc7Cgljb25zdCBjbG9zZVRpbWVvdXQgPSAzMCAqIDEwMDA7IC8vIEFsbG93IDMwIHNlY29uZHMgdG8gdGVybWluYXRlIHRoZSBjb25uZWN0aW9uIGNsZWFubHkuCgljb25zdCBwcm90b2NvbFZlcnNpb24gPSAxMzsKCWNvbnN0IG5vb3AgPSAoKSA9PiB7fTsKCgkvKioKCSAqIENsYXNzIHJlcHJlc2VudGluZyBhIFdlYlNvY2tldC4KCSAqCgkgKiBAZXh0ZW5kcyBFdmVudEVtaXR0ZXIKCSAqLwoJY2xhc3MgV2ViU29ja2V0IGV4dGVuZHMgRXZlbnRFbWl0dGVyIHsKCSAgLyoqCgkgICAqIENyZWF0ZSBhIG5ldyBgV2ViU29ja2V0YC4KCSAgICoKCSAgICogQHBhcmFtIHtTdHJpbmd9IGFkZHJlc3MgVGhlIFVSTCB0byB3aGljaCB0byBjb25uZWN0CgkgICAqIEBwYXJhbSB7KFN0cmluZ3xTdHJpbmdbXSl9IHByb3RvY29scyBUaGUgc3VicHJvdG9jb2xzCgkgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIENvbm5lY3Rpb24gb3B0aW9ucwoJICAgKi8KCSAgY29uc3RydWN0b3IgKGFkZHJlc3MsIHByb3RvY29scywgb3B0aW9ucykgewoJICAgIHN1cGVyKCk7CgoJICAgIGlmICh0eXBlb2YgcHJvdG9jb2xzID09PSAnb2JqZWN0JyAmJiAhQXJyYXkuaXNBcnJheShwcm90b2NvbHMpKSB7CgkgICAgICBvcHRpb25zID0gcHJvdG9jb2xzOwoJICAgICAgcHJvdG9jb2xzID0gbnVsbDsKCSAgICB9CgoJICAgIGlmICh0eXBlb2YgcHJvdG9jb2xzID09PSAnc3RyaW5nJykgcHJvdG9jb2xzID0gW3Byb3RvY29sc107CgkgICAgaWYgKCFBcnJheS5pc0FycmF5KHByb3RvY29scykpIHByb3RvY29scyA9IFtdOwoKCSAgICB0aGlzLnJlYWR5U3RhdGUgPSBXZWJTb2NrZXQuQ09OTkVDVElORzsKCSAgICB0aGlzLmJ5dGVzUmVjZWl2ZWQgPSAwOwoJICAgIHRoaXMuZXh0ZW5zaW9ucyA9IHt9OwoJICAgIHRoaXMucHJvdG9jb2wgPSAnJzsKCgkgICAgdGhpcy5fZmluYWxpemUgPSB0aGlzLmZpbmFsaXplLmJpbmQodGhpcyk7CgkgICAgdGhpcy5fYmluYXJ5VHlwZSA9ICdub2RlYnVmZmVyJzsKCSAgICB0aGlzLl9maW5hbGl6ZUNhbGxlZCA9IGZhbHNlOwoJICAgIHRoaXMuX2Nsb3NlTWVzc2FnZSA9IG51bGw7CgkgICAgdGhpcy5fY2xvc2VUaW1lciA9IG51bGw7CgkgICAgdGhpcy5fY2xvc2VDb2RlID0gbnVsbDsKCSAgICB0aGlzLl9yZWNlaXZlciA9IG51bGw7CgkgICAgdGhpcy5fc2VuZGVyID0gbnVsbDsKCSAgICB0aGlzLl9zb2NrZXQgPSBudWxsOwoJICAgIHRoaXMuX3VsdHJvbiA9IG51bGw7CgoJICAgIGlmIChBcnJheS5pc0FycmF5KGFkZHJlc3MpKSB7CgkgICAgICBpbml0QXNTZXJ2ZXJDbGllbnQuY2FsbCh0aGlzLCBhZGRyZXNzWzBdLCBhZGRyZXNzWzFdLCBhZGRyZXNzWzJdLCBvcHRpb25zKTsKCSAgICB9IGVsc2UgewoJICAgICAgaW5pdEFzQ2xpZW50LmNhbGwodGhpcywgYWRkcmVzcywgcHJvdG9jb2xzLCBvcHRpb25zKTsKCSAgICB9CgkgIH0KCgkgIGdldCBDT05ORUNUSU5HICgpIHsgcmV0dXJuIFdlYlNvY2tldC5DT05ORUNUSU5HOyB9CgkgIGdldCBDTE9TSU5HICgpIHsgcmV0dXJuIFdlYlNvY2tldC5DTE9TSU5HOyB9CgkgIGdldCBDTE9TRUQgKCkgeyByZXR1cm4gV2ViU29ja2V0LkNMT1NFRDsgfQoJICBnZXQgT1BFTiAoKSB7IHJldHVybiBXZWJTb2NrZXQuT1BFTjsgfQoKCSAgLyoqCgkgICAqIEB0eXBlIHtOdW1iZXJ9CgkgICAqLwoJICBnZXQgYnVmZmVyZWRBbW91bnQgKCkgewoJICAgIHZhciBhbW91bnQgPSAwOwoKCSAgICBpZiAodGhpcy5fc29ja2V0KSB7CgkgICAgICBhbW91bnQgPSB0aGlzLl9zb2NrZXQuYnVmZmVyU2l6ZSArIHRoaXMuX3NlbmRlci5idWZmZXJlZEJ5dGVzOwoJICAgIH0KCSAgICByZXR1cm4gYW1vdW50OwoJICB9CgoJICAvKioKCSAgICogVGhpcyBkZXZpYXRlcyBmcm9tIHRoZSBXSEFUV0cgaW50ZXJmYWNlIHNpbmNlIHdzIGRvZXNuJ3Qgc3VwcG9ydCB0aGUgcmVxdWlyZWQKCSAgICogZGVmYXVsdCAiYmxvYiIgdHlwZSAoaW5zdGVhZCB3ZSBkZWZpbmUgYSBjdXN0b20gIm5vZGVidWZmZXIiIHR5cGUpLgoJICAgKgoJICAgKiBAdHlwZSB7U3RyaW5nfQoJICAgKi8KCSAgZ2V0IGJpbmFyeVR5cGUgKCkgewoJICAgIHJldHVybiB0aGlzLl9iaW5hcnlUeXBlOwoJICB9CgoJICBzZXQgYmluYXJ5VHlwZSAodHlwZSkgewoJICAgIGlmICh0eXBlID09PSAnYXJyYXlidWZmZXInIHx8IHR5cGUgPT09ICdub2RlYnVmZmVyJykgewoJICAgICAgdGhpcy5fYmluYXJ5VHlwZSA9IHR5cGU7CgkgICAgfSBlbHNlIHsKCSAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcigndW5zdXBwb3J0ZWQgYmluYXJ5VHlwZTogbXVzdCBiZSBlaXRoZXIgIm5vZGVidWZmZXIiIG9yICJhcnJheWJ1ZmZlciInKTsKCSAgICB9CgkgIH0KCgkgIC8qKgoJICAgKiBTZXQgdXAgdGhlIHNvY2tldCBhbmQgdGhlIGludGVybmFsIHJlc291cmNlcy4KCSAgICoKCSAgICogQHBhcmFtIHtuZXQuU29ja2V0fSBzb2NrZXQgVGhlIG5ldHdvcmsgc29ja2V0IGJldHdlZW4gdGhlIHNlcnZlciBhbmQgY2xpZW50CgkgICAqIEBwYXJhbSB7QnVmZmVyfSBoZWFkIFRoZSBmaXJzdCBwYWNrZXQgb2YgdGhlIHVwZ3JhZGVkIHN0cmVhbQoJICAgKiBAcHJpdmF0ZQoJICAgKi8KCSAgc2V0U29ja2V0IChzb2NrZXQsIGhlYWQpIHsKCSAgICBzb2NrZXQuc2V0VGltZW91dCgwKTsKCSAgICBzb2NrZXQuc2V0Tm9EZWxheSgpOwoKCSAgICB0aGlzLl9yZWNlaXZlciA9IG5ldyBSZWNlaXZlcih0aGlzLmV4dGVuc2lvbnMsIHRoaXMubWF4UGF5bG9hZCk7CgkgICAgdGhpcy5fc2VuZGVyID0gbmV3IFNlbmRlcihzb2NrZXQsIHRoaXMuZXh0ZW5zaW9ucyk7CgkgICAgdGhpcy5fdWx0cm9uID0gbmV3IFVsdHJvbihzb2NrZXQpOwoJICAgIHRoaXMuX3NvY2tldCA9IHNvY2tldDsKCgkgICAgLy8gc29ja2V0IGNsZWFudXAgaGFuZGxlcnMKCSAgICB0aGlzLl91bHRyb24ub24oJ2Nsb3NlJywgdGhpcy5fZmluYWxpemUpOwoJICAgIHRoaXMuX3VsdHJvbi5vbignZXJyb3InLCB0aGlzLl9maW5hbGl6ZSk7CgkgICAgdGhpcy5fdWx0cm9uLm9uKCdlbmQnLCB0aGlzLl9maW5hbGl6ZSk7CgoJICAgIC8vIGVuc3VyZSB0aGF0IHRoZSBoZWFkIGlzIGFkZGVkIHRvIHRoZSByZWNlaXZlcgoJICAgIGlmIChoZWFkICYmIGhlYWQubGVuZ3RoID4gMCkgewoJICAgICAgc29ja2V0LnVuc2hpZnQoaGVhZCk7CgkgICAgICBoZWFkID0gbnVsbDsKCSAgICB9CgoJICAgIC8vIHN1YnNlcXVlbnQgcGFja2V0cyBhcmUgcHVzaGVkIHRvIHRoZSByZWNlaXZlcgoJICAgIHRoaXMuX3VsdHJvbi5vbignZGF0YScsIChkYXRhKSA9PiB7CgkgICAgICB0aGlzLmJ5dGVzUmVjZWl2ZWQgKz0gZGF0YS5sZW5ndGg7CgkgICAgICB0aGlzLl9yZWNlaXZlci5hZGQoZGF0YSk7CgkgICAgfSk7CgoJICAgIC8vIHJlY2VpdmVyIGV2ZW50IGhhbmRsZXJzCgkgICAgdGhpcy5fcmVjZWl2ZXIub25tZXNzYWdlID0gKGRhdGEsIGZsYWdzKSA9PiB0aGlzLmVtaXQoJ21lc3NhZ2UnLCBkYXRhLCBmbGFncyk7CgkgICAgdGhpcy5fcmVjZWl2ZXIub25waW5nID0gKGRhdGEsIGZsYWdzKSA9PiB7CgkgICAgICB0aGlzLnBvbmcoZGF0YSwgIXRoaXMuX2lzU2VydmVyLCB0cnVlKTsKCSAgICAgIHRoaXMuZW1pdCgncGluZycsIGRhdGEsIGZsYWdzKTsKCSAgICB9OwoJICAgIHRoaXMuX3JlY2VpdmVyLm9ucG9uZyA9IChkYXRhLCBmbGFncykgPT4gdGhpcy5lbWl0KCdwb25nJywgZGF0YSwgZmxhZ3MpOwoJICAgIHRoaXMuX3JlY2VpdmVyLm9uY2xvc2UgPSAoY29kZSwgcmVhc29uKSA9PiB7CgkgICAgICB0aGlzLl9jbG9zZU1lc3NhZ2UgPSByZWFzb247CgkgICAgICB0aGlzLl9jbG9zZUNvZGUgPSBjb2RlOwoJICAgICAgdGhpcy5jbG9zZShjb2RlLCByZWFzb24pOwoJICAgIH07CgkgICAgdGhpcy5fcmVjZWl2ZXIub25lcnJvciA9IChlcnJvciwgY29kZSkgPT4gewoJICAgICAgLy8gY2xvc2UgdGhlIGNvbm5lY3Rpb24gd2hlbiB0aGUgcmVjZWl2ZXIgcmVwb3J0cyBhIEh5QmkgZXJyb3IgY29kZQoJICAgICAgdGhpcy5jbG9zZShjb2RlLCAnJyk7CgkgICAgICB0aGlzLmVtaXQoJ2Vycm9yJywgZXJyb3IpOwoJICAgIH07CgoJICAgIC8vIHNlbmRlciBldmVudCBoYW5kbGVycwoJICAgIHRoaXMuX3NlbmRlci5vbmVycm9yID0gKGVycm9yKSA9PiB7CgkgICAgICB0aGlzLmNsb3NlKDEwMDIsICcnKTsKCSAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBlcnJvcik7CgkgICAgfTsKCgkgICAgdGhpcy5yZWFkeVN0YXRlID0gV2ViU29ja2V0Lk9QRU47CgkgICAgdGhpcy5lbWl0KCdvcGVuJyk7CgkgIH0KCgkgIC8qKgoJICAgKiBDbGVhbiB1cCBhbmQgcmVsZWFzZSBpbnRlcm5hbCByZXNvdXJjZXMuCgkgICAqCgkgICAqIEBwYXJhbSB7KEJvb2xlYW58RXJyb3IpfSBJbmRpY2F0ZXMgd2hldGhlciBvciBub3QgYW4gZXJyb3Igb2NjdXJyZWQKCSAgICogQHByaXZhdGUKCSAgICovCgkgIGZpbmFsaXplIChlcnJvcikgewoJICAgIGlmICh0aGlzLl9maW5hbGl6ZUNhbGxlZCkgcmV0dXJuOwoKCSAgICB0aGlzLnJlYWR5U3RhdGUgPSBXZWJTb2NrZXQuQ0xPU0lORzsKCSAgICB0aGlzLl9maW5hbGl6ZUNhbGxlZCA9IHRydWU7CgoJICAgIGNsZWFyVGltZW91dCh0aGlzLl9jbG9zZVRpbWVyKTsKCSAgICB0aGlzLl9jbG9zZVRpbWVyID0gbnVsbDsKCgkgICAgLy8KCSAgICAvLyBJZiB0aGUgY29ubmVjdGlvbiB3YXMgY2xvc2VkIGFibm9ybWFsbHkgKHdpdGggYW4gZXJyb3IpLCBvciBpZiB0aGUgY2xvc2UKCSAgICAvLyBjb250cm9sIGZyYW1lIHdhcyBtYWxmb3JtZWQgb3Igbm90IHJlY2VpdmVkIHRoZW4gdGhlIGNsb3NlIGNvZGUgbXVzdCBiZQoJICAgIC8vIDEwMDYuCgkgICAgLy8KCSAgICBpZiAoZXJyb3IpIHRoaXMuX2Nsb3NlQ29kZSA9IDEwMDY7CgoJICAgIGlmICh0aGlzLl9zb2NrZXQpIHsKCSAgICAgIHRoaXMuX3VsdHJvbi5kZXN0cm95KCk7CgkgICAgICB0aGlzLl9zb2NrZXQub24oJ2Vycm9yJywgZnVuY3Rpb24gb25lcnJvciAoKSB7CgkgICAgICAgIHRoaXMuZGVzdHJveSgpOwoJICAgICAgfSk7CgoJICAgICAgaWYgKCFlcnJvcikgdGhpcy5fc29ja2V0LmVuZCgpOwoJICAgICAgZWxzZSB0aGlzLl9zb2NrZXQuZGVzdHJveSgpOwoKCSAgICAgIHRoaXMuX3NvY2tldCA9IG51bGw7CgkgICAgICB0aGlzLl91bHRyb24gPSBudWxsOwoJICAgIH0KCgkgICAgaWYgKHRoaXMuX3NlbmRlcikgewoJICAgICAgdGhpcy5fc2VuZGVyID0gdGhpcy5fc2VuZGVyLm9uZXJyb3IgPSBudWxsOwoJICAgIH0KCgkgICAgaWYgKHRoaXMuX3JlY2VpdmVyKSB7CgkgICAgICB0aGlzLl9yZWNlaXZlci5jbGVhbnVwKCgpID0+IHRoaXMuZW1pdENsb3NlKCkpOwoJICAgICAgdGhpcy5fcmVjZWl2ZXIgPSBudWxsOwoJICAgIH0gZWxzZSB7CgkgICAgICB0aGlzLmVtaXRDbG9zZSgpOwoJICAgIH0KCSAgfQoKCSAgLyoqCgkgICAqIEVtaXQgdGhlIGBjbG9zZWAgZXZlbnQuCgkgICAqCgkgICAqIEBwcml2YXRlCgkgICAqLwoJICBlbWl0Q2xvc2UgKCkgewoJICAgIHRoaXMucmVhZHlTdGF0ZSA9IFdlYlNvY2tldC5DTE9TRUQ7CgkgICAgdGhpcy5lbWl0KCdjbG9zZScsIHRoaXMuX2Nsb3NlQ29kZSB8fCAxMDA2LCB0aGlzLl9jbG9zZU1lc3NhZ2UgfHwgJycpOwoKCSAgICBpZiAodGhpcy5leHRlbnNpb25zW1Blck1lc3NhZ2VEZWZsYXRlLmV4dGVuc2lvbk5hbWVdKSB7CgkgICAgICB0aGlzLmV4dGVuc2lvbnNbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0uY2xlYW51cCgpOwoJICAgIH0KCgkgICAgdGhpcy5leHRlbnNpb25zID0gbnVsbDsKCgkgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoKTsKCSAgICB0aGlzLm9uKCdlcnJvcicsIG5vb3ApOyAvLyBDYXRjaCBhbGwgZXJyb3JzIGFmdGVyIHRoaXMuCgkgIH0KCgkgIC8qKgoJICAgKiBQYXVzZSB0aGUgc29ja2V0IHN0cmVhbS4KCSAgICoKCSAgICogQHB1YmxpYwoJICAgKi8KCSAgcGF1c2UgKCkgewoJICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgIT09IFdlYlNvY2tldC5PUEVOKSB0aHJvdyBuZXcgRXJyb3IoJ25vdCBvcGVuZWQnKTsKCgkgICAgdGhpcy5fc29ja2V0LnBhdXNlKCk7CgkgIH0KCgkgIC8qKgoJICAgKiBSZXN1bWUgdGhlIHNvY2tldCBzdHJlYW0KCSAgICoKCSAgICogQHB1YmxpYwoJICAgKi8KCSAgcmVzdW1lICgpIHsKCSAgICBpZiAodGhpcy5yZWFkeVN0YXRlICE9PSBXZWJTb2NrZXQuT1BFTikgdGhyb3cgbmV3IEVycm9yKCdub3Qgb3BlbmVkJyk7CgoJICAgIHRoaXMuX3NvY2tldC5yZXN1bWUoKTsKCSAgfQoKCSAgLyoqCgkgICAqIFN0YXJ0IGEgY2xvc2luZyBoYW5kc2hha2UuCgkgICAqCgkgICAqIEBwYXJhbSB7TnVtYmVyfSBjb2RlIFN0YXR1cyBjb2RlIGV4cGxhaW5pbmcgd2h5IHRoZSBjb25uZWN0aW9uIGlzIGNsb3NpbmcKCSAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGEgQSBzdHJpbmcgZXhwbGFpbmluZyB3aHkgdGhlIGNvbm5lY3Rpb24gaXMgY2xvc2luZwoJICAgKiBAcHVibGljCgkgICAqLwoJICBjbG9zZSAoY29kZSwgZGF0YSkgewoJICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5DTE9TRUQpIHJldHVybjsKCSAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuQ09OTkVDVElORykgewoJICAgICAgaWYgKHRoaXMuX3JlcSAmJiAhdGhpcy5fcmVxLmFib3J0ZWQpIHsKCSAgICAgICAgdGhpcy5fcmVxLmFib3J0KCk7CgkgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ2Nsb3NlZCBiZWZvcmUgdGhlIGNvbm5lY3Rpb24gaXMgZXN0YWJsaXNoZWQnKSk7CgkgICAgICAgIHRoaXMuZmluYWxpemUodHJ1ZSk7CgkgICAgICB9CgkgICAgICByZXR1cm47CgkgICAgfQoKCSAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuQ0xPU0lORykgewoJICAgICAgaWYgKHRoaXMuX2Nsb3NlQ29kZSkgdGhpcy50ZXJtaW5hdGUoKTsKCSAgICAgIHJldHVybjsKCSAgICB9CgoJICAgIHRoaXMucmVhZHlTdGF0ZSA9IFdlYlNvY2tldC5DTE9TSU5HOwoJICAgIHRoaXMuX3NlbmRlci5jbG9zZShjb2RlLCBkYXRhLCAhdGhpcy5faXNTZXJ2ZXIsIChlcnIpID0+IHsKCSAgICAgIGlmIChlcnIpIHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpOwoKCSAgICAgIGlmICh0aGlzLl9jbG9zZUNvZGUpIHsKCSAgICAgICAgdGhpcy50ZXJtaW5hdGUoKTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIC8vCgkgICAgICAgIC8vIEVuc3VyZSB0aGF0IHRoZSBjb25uZWN0aW9uIGlzIGNsZWFuZWQgdXAgZXZlbiB3aGVuIHRoZSBjbG9zaW5nCgkgICAgICAgIC8vIGhhbmRzaGFrZSBmYWlscy4KCSAgICAgICAgLy8KCSAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX2Nsb3NlVGltZXIpOwoJICAgICAgICB0aGlzLl9jbG9zZVRpbWVyID0gc2V0VGltZW91dCh0aGlzLl9maW5hbGl6ZSwgY2xvc2VUaW1lb3V0LCB0cnVlKTsKCSAgICAgIH0KCSAgICB9KTsKCSAgfQoKCSAgLyoqCgkgICAqIFNlbmQgYSBwaW5nIG1lc3NhZ2UuCgkgICAqCgkgICAqIEBwYXJhbSB7Kn0gZGF0YSBUaGUgbWVzc2FnZSB0byBzZW5kCgkgICAqIEBwYXJhbSB7Qm9vbGVhbn0gbWFzayBJbmRpY2F0ZXMgd2hldGhlciBvciBub3QgdG8gbWFzayBgZGF0YWAKCSAgICogQHBhcmFtIHtCb29sZWFufSBmYWlsU2lsZW50bHkgSW5kaWNhdGVzIHdoZXRoZXIgb3Igbm90IHRvIHRocm93IGlmIGByZWFkeVN0YXRlYCBpc24ndCBgT1BFTmAKCSAgICogQHB1YmxpYwoJICAgKi8KCSAgcGluZyAoZGF0YSwgbWFzaywgZmFpbFNpbGVudGx5KSB7CgkgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSAhPT0gV2ViU29ja2V0Lk9QRU4pIHsKCSAgICAgIGlmIChmYWlsU2lsZW50bHkpIHJldHVybjsKCSAgICAgIHRocm93IG5ldyBFcnJvcignbm90IG9wZW5lZCcpOwoJICAgIH0KCgkgICAgaWYgKHR5cGVvZiBkYXRhID09PSAnbnVtYmVyJykgZGF0YSA9IGRhdGEudG9TdHJpbmcoKTsKCSAgICBpZiAobWFzayA9PT0gdW5kZWZpbmVkKSBtYXNrID0gIXRoaXMuX2lzU2VydmVyOwoJICAgIHRoaXMuX3NlbmRlci5waW5nKGRhdGEsIG1hc2spOwoJICB9CgoJICAvKioKCSAgICogU2VuZCBhIHBvbmcgbWVzc2FnZS4KCSAgICoKCSAgICogQHBhcmFtIHsqfSBkYXRhIFRoZSBtZXNzYWdlIHRvIHNlbmQKCSAgICogQHBhcmFtIHtCb29sZWFufSBtYXNrIEluZGljYXRlcyB3aGV0aGVyIG9yIG5vdCB0byBtYXNrIGBkYXRhYAoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IGZhaWxTaWxlbnRseSBJbmRpY2F0ZXMgd2hldGhlciBvciBub3QgdG8gdGhyb3cgaWYgYHJlYWR5U3RhdGVgIGlzbid0IGBPUEVOYAoJICAgKiBAcHVibGljCgkgICAqLwoJICBwb25nIChkYXRhLCBtYXNrLCBmYWlsU2lsZW50bHkpIHsKCSAgICBpZiAodGhpcy5yZWFkeVN0YXRlICE9PSBXZWJTb2NrZXQuT1BFTikgewoJICAgICAgaWYgKGZhaWxTaWxlbnRseSkgcmV0dXJuOwoJICAgICAgdGhyb3cgbmV3IEVycm9yKCdub3Qgb3BlbmVkJyk7CgkgICAgfQoKCSAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdudW1iZXInKSBkYXRhID0gZGF0YS50b1N0cmluZygpOwoJICAgIGlmIChtYXNrID09PSB1bmRlZmluZWQpIG1hc2sgPSAhdGhpcy5faXNTZXJ2ZXI7CgkgICAgdGhpcy5fc2VuZGVyLnBvbmcoZGF0YSwgbWFzayk7CgkgIH0KCgkgIC8qKgoJICAgKiBTZW5kIGEgZGF0YSBtZXNzYWdlLgoJICAgKgoJICAgKiBAcGFyYW0geyp9IGRhdGEgVGhlIG1lc3NhZ2UgdG8gc2VuZAoJICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBPcHRpb25zIG9iamVjdAoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMuY29tcHJlc3MgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIGNvbXByZXNzIGBkYXRhYAoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMuYmluYXJ5IFNwZWNpZmllcyB3aGV0aGVyIGBkYXRhYCBpcyBiaW5hcnkgb3IgdGV4dAoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMuZmluIFNwZWNpZmllcyB3aGV0aGVyIHRoZSBmcmFnbWVudCBpcyB0aGUgbGFzdCBvbmUKCSAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLm1hc2sgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIG1hc2sgYGRhdGFgCgkgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIENhbGxiYWNrIHdoaWNoIGlzIGV4ZWN1dGVkIHdoZW4gZGF0YSBpcyB3cml0dGVuIG91dAoJICAgKiBAcHVibGljCgkgICAqLwoJICBzZW5kIChkYXRhLCBvcHRpb25zLCBjYikgewoJICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykgewoJICAgICAgY2IgPSBvcHRpb25zOwoJICAgICAgb3B0aW9ucyA9IHt9OwoJICAgIH0KCgkgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSAhPT0gV2ViU29ja2V0Lk9QRU4pIHsKCSAgICAgIGlmIChjYikgY2IobmV3IEVycm9yKCdub3Qgb3BlbmVkJykpOwoJICAgICAgZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ25vdCBvcGVuZWQnKTsKCSAgICAgIHJldHVybjsKCSAgICB9CgoJICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ251bWJlcicpIGRhdGEgPSBkYXRhLnRvU3RyaW5nKCk7CgkgICAgZWxzZSBpZiAoIWRhdGEpIGRhdGEgPSAnJzsKCgkgICAgY29uc3Qgb3B0cyA9IE9iamVjdC5hc3NpZ24oewoJICAgICAgZmluOiB0cnVlLAoJICAgICAgYmluYXJ5OiB0eXBlb2YgZGF0YSAhPT0gJ3N0cmluZycsCgkgICAgICBtYXNrOiAhdGhpcy5faXNTZXJ2ZXIsCgkgICAgICBjb21wcmVzczogdHJ1ZQoJICAgIH0sIG9wdGlvbnMpOwoKCSAgICBpZiAoIXRoaXMuZXh0ZW5zaW9uc1tQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXSkgewoJICAgICAgb3B0cy5jb21wcmVzcyA9IGZhbHNlOwoJICAgIH0KCgkgICAgdGhpcy5fc2VuZGVyLnNlbmQoZGF0YSwgb3B0cywgY2IpOwoJICB9CgoJICAvKioKCSAgICogSGFsZi1jbG9zZSB0aGUgc29ja2V0IHNlbmRpbmcgYSBGSU4gcGFja2V0LgoJICAgKgoJICAgKiBAcHVibGljCgkgICAqLwoJICB0ZXJtaW5hdGUgKCkgewoJICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5DTE9TRUQpIHJldHVybjsKCSAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuQ09OTkVDVElORykgewoJICAgICAgaWYgKHRoaXMuX3JlcSAmJiAhdGhpcy5fcmVxLmFib3J0ZWQpIHsKCSAgICAgICAgdGhpcy5fcmVxLmFib3J0KCk7CgkgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ2Nsb3NlZCBiZWZvcmUgdGhlIGNvbm5lY3Rpb24gaXMgZXN0YWJsaXNoZWQnKSk7CgkgICAgICAgIHRoaXMuZmluYWxpemUodHJ1ZSk7CgkgICAgICB9CgkgICAgICByZXR1cm47CgkgICAgfQoKCSAgICBpZiAodGhpcy5fc29ja2V0KSB7CgkgICAgICB0aGlzLnJlYWR5U3RhdGUgPSBXZWJTb2NrZXQuQ0xPU0lORzsKCSAgICAgIHRoaXMuX3NvY2tldC5lbmQoKTsKCgkgICAgICAvLwoJICAgICAgLy8gQWRkIGEgdGltZW91dCB0byBlbnN1cmUgdGhhdCB0aGUgY29ubmVjdGlvbiBpcyBjb21wbGV0ZWx5IGNsZWFuZWQgdXAKCSAgICAgIC8vIHdpdGhpbiAzMCBzZWNvbmRzLCBldmVuIGlmIHRoZSBvdGhlciBwZWVyIGRvZXMgbm90IHNlbmQgYSBGSU4gcGFja2V0LgoJICAgICAgLy8KCSAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9jbG9zZVRpbWVyKTsKCSAgICAgIHRoaXMuX2Nsb3NlVGltZXIgPSBzZXRUaW1lb3V0KHRoaXMuX2ZpbmFsaXplLCBjbG9zZVRpbWVvdXQsIHRydWUpOwoJICAgIH0KCSAgfQoJfQoKCVdlYlNvY2tldC5DT05ORUNUSU5HID0gMDsKCVdlYlNvY2tldC5PUEVOID0gMTsKCVdlYlNvY2tldC5DTE9TSU5HID0gMjsKCVdlYlNvY2tldC5DTE9TRUQgPSAzOwoKCS8vCgkvLyBBZGQgdGhlIGBvbm9wZW5gLCBgb25lcnJvcmAsIGBvbmNsb3NlYCwgYW5kIGBvbm1lc3NhZ2VgIGF0dHJpYnV0ZXMuCgkvLyBTZWUgaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvY29tbXMuaHRtbCN0aGUtd2Vic29ja2V0LWludGVyZmFjZQoJLy8KCVsnb3BlbicsICdlcnJvcicsICdjbG9zZScsICdtZXNzYWdlJ10uZm9yRWFjaCgobWV0aG9kKSA9PiB7CgkgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXZWJTb2NrZXQucHJvdG90eXBlLCBgb24ke21ldGhvZH1gLCB7CgkgICAgLyoqCgkgICAgICogUmV0dXJuIHRoZSBsaXN0ZW5lciBvZiB0aGUgZXZlbnQuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHsoRnVuY3Rpb258dW5kZWZpbmVkKX0gVGhlIGV2ZW50IGxpc3RlbmVyIG9yIGB1bmRlZmluZWRgCgkgICAgICogQHB1YmxpYwoJICAgICAqLwoJICAgIGdldCAoKSB7CgkgICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVycyhtZXRob2QpOwoJICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0ZW5lcnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgaWYgKGxpc3RlbmVyc1tpXS5fbGlzdGVuZXIpIHJldHVybiBsaXN0ZW5lcnNbaV0uX2xpc3RlbmVyOwoJICAgICAgfQoJICAgIH0sCgkgICAgLyoqCgkgICAgICogQWRkIGEgbGlzdGVuZXIgZm9yIHRoZSBldmVudC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIFRoZSBsaXN0ZW5lciB0byBhZGQKCSAgICAgKiBAcHVibGljCgkgICAgICovCgkgICAgc2V0IChsaXN0ZW5lcikgewoJICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5saXN0ZW5lcnMobWV0aG9kKTsKCSAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIC8vCgkgICAgICAgIC8vIFJlbW92ZSBvbmx5IHRoZSBsaXN0ZW5lcnMgYWRkZWQgdmlhIGBhZGRFdmVudExpc3RlbmVyYC4KCSAgICAgICAgLy8KCSAgICAgICAgaWYgKGxpc3RlbmVyc1tpXS5fbGlzdGVuZXIpIHRoaXMucmVtb3ZlTGlzdGVuZXIobWV0aG9kLCBsaXN0ZW5lcnNbaV0pOwoJICAgICAgfQoJICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKG1ldGhvZCwgbGlzdGVuZXIpOwoJICAgIH0KCSAgfSk7Cgl9KTsKCglXZWJTb2NrZXQucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBFdmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyOwoJV2ViU29ja2V0LnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gRXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcjsKCgltb2R1bGUuZXhwb3J0cyA9IFdlYlNvY2tldDsKCgkvKioKCSAqIEluaXRpYWxpemUgYSBXZWJTb2NrZXQgc2VydmVyIGNsaWVudC4KCSAqCgkgKiBAcGFyYW0ge2h0dHAuSW5jb21pbmdNZXNzYWdlfSByZXEgVGhlIHJlcXVlc3Qgb2JqZWN0CgkgKiBAcGFyYW0ge25ldC5Tb2NrZXR9IHNvY2tldCBUaGUgbmV0d29yayBzb2NrZXQgYmV0d2VlbiB0aGUgc2VydmVyIGFuZCBjbGllbnQKCSAqIEBwYXJhbSB7QnVmZmVyfSBoZWFkIFRoZSBmaXJzdCBwYWNrZXQgb2YgdGhlIHVwZ3JhZGVkIHN0cmVhbQoJICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgV2ViU29ja2V0IGF0dHJpYnV0ZXMKCSAqIEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLnByb3RvY29sVmVyc2lvbiBUaGUgV2ViU29ja2V0IHByb3RvY29sIHZlcnNpb24KCSAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLmV4dGVuc2lvbnMgVGhlIG5lZ290aWF0ZWQgZXh0ZW5zaW9ucwoJICogQHBhcmFtIHtOdW1iZXJ9IG9wdGlvbnMubWF4UGF5bG9hZCBUaGUgbWF4aW11bSBhbGxvd2VkIG1lc3NhZ2Ugc2l6ZQoJICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMucHJvdG9jb2wgVGhlIGNob3NlbiBzdWJwcm90b2NvbAoJICogQHByaXZhdGUKCSAqLwoJZnVuY3Rpb24gaW5pdEFzU2VydmVyQ2xpZW50IChyZXEsIHNvY2tldCwgaGVhZCwgb3B0aW9ucykgewoJICB0aGlzLnByb3RvY29sVmVyc2lvbiA9IG9wdGlvbnMucHJvdG9jb2xWZXJzaW9uOwoJICB0aGlzLmV4dGVuc2lvbnMgPSBvcHRpb25zLmV4dGVuc2lvbnM7CgkgIHRoaXMubWF4UGF5bG9hZCA9IG9wdGlvbnMubWF4UGF5bG9hZDsKCSAgdGhpcy5wcm90b2NvbCA9IG9wdGlvbnMucHJvdG9jb2w7CgoJICB0aGlzLnVwZ3JhZGVSZXEgPSByZXE7CgkgIHRoaXMuX2lzU2VydmVyID0gdHJ1ZTsKCgkgIHRoaXMuc2V0U29ja2V0KHNvY2tldCwgaGVhZCk7Cgl9CgoJLyoqCgkgKiBJbml0aWFsaXplIGEgV2ViU29ja2V0IGNsaWVudC4KCSAqCgkgKiBAcGFyYW0ge1N0cmluZ30gYWRkcmVzcyBUaGUgVVJMIHRvIHdoaWNoIHRvIGNvbm5lY3QKCSAqIEBwYXJhbSB7U3RyaW5nW119IHByb3RvY29scyBUaGUgbGlzdCBvZiBzdWJwcm90b2NvbHMKCSAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIENvbm5lY3Rpb24gb3B0aW9ucwoJICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMucHJvdG9jb2wgVmFsdWUgb2YgdGhlIGBTZWMtV2ViU29ja2V0LVByb3RvY29sYCBoZWFkZXIKCSAqIEBwYXJhbSB7KEJvb2xlYW58T2JqZWN0KX0gb3B0aW9ucy5wZXJNZXNzYWdlRGVmbGF0ZSBFbmFibGUvZGlzYWJsZSBwZXJtZXNzYWdlLWRlZmxhdGUKCSAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLmxvY2FsQWRkcmVzcyBMb2NhbCBpbnRlcmZhY2UgdG8gYmluZCBmb3IgbmV0d29yayBjb25uZWN0aW9ucwoJICogQHBhcmFtIHtOdW1iZXJ9IG9wdGlvbnMucHJvdG9jb2xWZXJzaW9uIFZhbHVlIG9mIHRoZSBgU2VjLVdlYlNvY2tldC1WZXJzaW9uYCBoZWFkZXIKCSAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLmhlYWRlcnMgQW4gb2JqZWN0IGNvbnRhaW5pbmcgcmVxdWVzdCBoZWFkZXJzCgkgKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy5vcmlnaW4gVmFsdWUgb2YgdGhlIGBPcmlnaW5gIG9yIGBTZWMtV2ViU29ja2V0LU9yaWdpbmAgaGVhZGVyCgkgKiBAcGFyYW0ge2h0dHAuQWdlbnR9IG9wdGlvbnMuYWdlbnQgVXNlIHRoZSBzcGVjaWZpZWQgQWdlbnQKCSAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLmhvc3QgVmFsdWUgb2YgdGhlIGBIb3N0YCBoZWFkZXIKCSAqIEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLmZhbWlseSBJUCBhZGRyZXNzIGZhbWlseSB0byB1c2UgZHVyaW5nIGhvc3RuYW1lIGxvb2t1cCAoNCBvciA2KS4KCSAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMuY2hlY2tTZXJ2ZXJJZGVudGl0eSBBIGZ1bmN0aW9uIHRvIHZhbGlkYXRlIHRoZSBzZXJ2ZXIgaG9zdG5hbWUKCSAqIEBwYXJhbSB7Qm9vbGVhbn0gb3B0aW9ucy5yZWplY3RVbmF1dGhvcml6ZWQgVmVyaWZ5IG9yIG5vdCB0aGUgc2VydmVyIGNlcnRpZmljYXRlCgkgKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy5wYXNzcGhyYXNlIFRoZSBwYXNzcGhyYXNlIGZvciB0aGUgcHJpdmF0ZSBrZXkgb3IgcGZ4CgkgKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy5jaXBoZXJzIFRoZSBjaXBoZXJzIHRvIHVzZSBvciBleGNsdWRlCgkgKiBAcGFyYW0geyhTdHJpbmd8U3RyaW5nW118QnVmZmVyfEJ1ZmZlcltdKX0gb3B0aW9ucy5jZXJ0IFRoZSBjZXJ0aWZpY2F0ZSBrZXkKCSAqIEBwYXJhbSB7KFN0cmluZ3xTdHJpbmdbXXxCdWZmZXJ8QnVmZmVyW10pfSBvcHRpb25zLmtleSBUaGUgcHJpdmF0ZSBrZXkKCSAqIEBwYXJhbSB7KFN0cmluZ3xCdWZmZXIpfSBvcHRpb25zLnBmeCBUaGUgcHJpdmF0ZSBrZXksIGNlcnRpZmljYXRlLCBhbmQgQ0EgY2VydHMKCSAqIEBwYXJhbSB7KFN0cmluZ3xTdHJpbmdbXXxCdWZmZXJ8QnVmZmVyW10pfSBvcHRpb25zLmNhIFRydXN0ZWQgY2VydGlmaWNhdGVzCgkgKiBAcHJpdmF0ZQoJICovCglmdW5jdGlvbiBpbml0QXNDbGllbnQgKGFkZHJlc3MsIHByb3RvY29scywgb3B0aW9ucykgewoJICBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7CgkgICAgcHJvdG9jb2w6IHByb3RvY29scy5qb2luKCcsJyksCgkgICAgcGVyTWVzc2FnZURlZmxhdGU6IHRydWUsCgkgICAgbG9jYWxBZGRyZXNzOiBudWxsLAoJICAgIHByb3RvY29sVmVyc2lvbiwKCSAgICBoZWFkZXJzOiBudWxsLAoJICAgIG9yaWdpbjogbnVsbCwKCSAgICBhZ2VudDogbnVsbCwKCSAgICBob3N0OiBudWxsLAoJICAgIGZhbWlseTogbnVsbCwKCgkgICAgLy8KCSAgICAvLyBTU0wgb3B0aW9ucy4KCSAgICAvLwoJICAgIGNoZWNrU2VydmVySWRlbnRpdHk6IG51bGwsCgkgICAgcmVqZWN0VW5hdXRob3JpemVkOiBudWxsLAoJICAgIHBhc3NwaHJhc2U6IG51bGwsCgkgICAgY2lwaGVyczogbnVsbCwKCSAgICBjZXJ0OiBudWxsLAoJICAgIGtleTogbnVsbCwKCSAgICBwZng6IG51bGwsCgkgICAgY2E6IG51bGwKCSAgfSwgb3B0aW9ucyk7CgoJICBpZiAob3B0aW9ucy5wcm90b2NvbFZlcnNpb24gIT09IDggJiYgb3B0aW9ucy5wcm90b2NvbFZlcnNpb24gIT09IDEzKSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKCd1bnN1cHBvcnRlZCBwcm90b2NvbCB2ZXJzaW9uJyk7CgkgIH0KCgkgIHRoaXMucHJvdG9jb2xWZXJzaW9uID0gb3B0aW9ucy5wcm90b2NvbFZlcnNpb247CgkgIHRoaXMuX2lzU2VydmVyID0gZmFsc2U7CgkgIHRoaXMudXJsID0gYWRkcmVzczsKCgkgIGNvbnN0IHNlcnZlclVybCA9IHVybC5wYXJzZShhZGRyZXNzKTsKCSAgY29uc3QgaXNVbml4U29ja2V0ID0gc2VydmVyVXJsLnByb3RvY29sID09PSAnd3MrdW5peDonOwoKCSAgaWYgKCFzZXJ2ZXJVcmwuaG9zdCAmJiAoIWlzVW5peFNvY2tldCB8fCAhc2VydmVyVXJsLnBhdGgpKSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIHVybCcpOwoJICB9CgoJICBjb25zdCBpc1NlY3VyZSA9IHNlcnZlclVybC5wcm90b2NvbCA9PT0gJ3dzczonIHx8IHNlcnZlclVybC5wcm90b2NvbCA9PT0gJ2h0dHBzOic7CgkgIGNvbnN0IGtleSA9IGNyeXB0by5yYW5kb21CeXRlcygxNikudG9TdHJpbmcoJ2Jhc2U2NCcpOwoJICBjb25zdCBodHRwT2JqID0gaXNTZWN1cmUgPyBodHRwcyA6IGh0dHA7CgoJICAvLwoJICAvLyBQcmVwYXJlIGV4dGVuc2lvbnMuCgkgIC8vCgkgIGNvbnN0IGV4dGVuc2lvbnNPZmZlciA9IHt9OwoJICB2YXIgcGVyTWVzc2FnZURlZmxhdGU7CgoJICBpZiAob3B0aW9ucy5wZXJNZXNzYWdlRGVmbGF0ZSkgewoJICAgIHBlck1lc3NhZ2VEZWZsYXRlID0gbmV3IFBlck1lc3NhZ2VEZWZsYXRlKAoJICAgICAgb3B0aW9ucy5wZXJNZXNzYWdlRGVmbGF0ZSAhPT0gdHJ1ZSA/IG9wdGlvbnMucGVyTWVzc2FnZURlZmxhdGUgOiB7fSwKCSAgICAgIGZhbHNlCgkgICAgKTsKCSAgICBleHRlbnNpb25zT2ZmZXJbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0gPSBwZXJNZXNzYWdlRGVmbGF0ZS5vZmZlcigpOwoJICB9CgoJICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IHsKCSAgICBwb3J0OiBzZXJ2ZXJVcmwucG9ydCB8fCAoaXNTZWN1cmUgPyA0NDMgOiA4MCksCgkgICAgaG9zdDogc2VydmVyVXJsLmhvc3RuYW1lLAoJICAgIHBhdGg6ICcvJywKCSAgICBoZWFkZXJzOiB7CgkgICAgICAnU2VjLVdlYlNvY2tldC1WZXJzaW9uJzogb3B0aW9ucy5wcm90b2NvbFZlcnNpb24sCgkgICAgICAnU2VjLVdlYlNvY2tldC1LZXknOiBrZXksCgkgICAgICAnQ29ubmVjdGlvbic6ICdVcGdyYWRlJywKCSAgICAgICdVcGdyYWRlJzogJ3dlYnNvY2tldCcKCSAgICB9CgkgIH07CgoJICBpZiAob3B0aW9ucy5oZWFkZXJzKSBPYmplY3QuYXNzaWduKHJlcXVlc3RPcHRpb25zLmhlYWRlcnMsIG9wdGlvbnMuaGVhZGVycyk7CgkgIGlmIChPYmplY3Qua2V5cyhleHRlbnNpb25zT2ZmZXIpLmxlbmd0aCkgewoJICAgIHJlcXVlc3RPcHRpb25zLmhlYWRlcnNbJ1NlYy1XZWJTb2NrZXQtRXh0ZW5zaW9ucyddID0gRXh0ZW5zaW9ucy5mb3JtYXQoZXh0ZW5zaW9uc09mZmVyKTsKCSAgfQoJICBpZiAob3B0aW9ucy5wcm90b2NvbCkgewoJICAgIHJlcXVlc3RPcHRpb25zLmhlYWRlcnNbJ1NlYy1XZWJTb2NrZXQtUHJvdG9jb2wnXSA9IG9wdGlvbnMucHJvdG9jb2w7CgkgIH0KCSAgaWYgKG9wdGlvbnMub3JpZ2luKSB7CgkgICAgaWYgKG9wdGlvbnMucHJvdG9jb2xWZXJzaW9uIDwgMTMpIHsKCSAgICAgIHJlcXVlc3RPcHRpb25zLmhlYWRlcnNbJ1NlYy1XZWJTb2NrZXQtT3JpZ2luJ10gPSBvcHRpb25zLm9yaWdpbjsKCSAgICB9IGVsc2UgewoJICAgICAgcmVxdWVzdE9wdGlvbnMuaGVhZGVycy5PcmlnaW4gPSBvcHRpb25zLm9yaWdpbjsKCSAgICB9CgkgIH0KCSAgaWYgKG9wdGlvbnMuaG9zdCkgcmVxdWVzdE9wdGlvbnMuaGVhZGVycy5Ib3N0ID0gb3B0aW9ucy5ob3N0OwoJICBpZiAoc2VydmVyVXJsLmF1dGgpIHJlcXVlc3RPcHRpb25zLmF1dGggPSBzZXJ2ZXJVcmwuYXV0aDsKCgkgIGlmIChvcHRpb25zLmxvY2FsQWRkcmVzcykgcmVxdWVzdE9wdGlvbnMubG9jYWxBZGRyZXNzID0gb3B0aW9ucy5sb2NhbEFkZHJlc3M7CgkgIGlmIChvcHRpb25zLmZhbWlseSkgcmVxdWVzdE9wdGlvbnMuZmFtaWx5ID0gb3B0aW9ucy5mYW1pbHk7CgoJICBpZiAoaXNVbml4U29ja2V0KSB7CgkgICAgY29uc3QgcGFydHMgPSBzZXJ2ZXJVcmwucGF0aC5zcGxpdCgnOicpOwoKCSAgICByZXF1ZXN0T3B0aW9ucy5zb2NrZXRQYXRoID0gcGFydHNbMF07CgkgICAgcmVxdWVzdE9wdGlvbnMucGF0aCA9IHBhcnRzWzFdOwoJICB9IGVsc2UgaWYgKHNlcnZlclVybC5wYXRoKSB7CgkgICAgLy8KCSAgICAvLyBNYWtlIHN1cmUgdGhhdCBwYXRoIHN0YXJ0cyB3aXRoIGAvYC4KCSAgICAvLwoJICAgIGlmIChzZXJ2ZXJVcmwucGF0aC5jaGFyQXQoMCkgIT09ICcvJykgewoJICAgICAgcmVxdWVzdE9wdGlvbnMucGF0aCA9IGAvJHtzZXJ2ZXJVcmwucGF0aH1gOwoJICAgIH0gZWxzZSB7CgkgICAgICByZXF1ZXN0T3B0aW9ucy5wYXRoID0gc2VydmVyVXJsLnBhdGg7CgkgICAgfQoJICB9CgoJICB2YXIgYWdlbnQgPSBvcHRpb25zLmFnZW50OwoKCSAgLy8KCSAgLy8gQSBjdXN0b20gYWdlbnQgaXMgcmVxdWlyZWQgZm9yIHRoZXNlIG9wdGlvbnMuCgkgIC8vCgkgIGlmICgKCSAgICBvcHRpb25zLnJlamVjdFVuYXV0aG9yaXplZCAhPSBudWxsIHx8CgkgICAgb3B0aW9ucy5jaGVja1NlcnZlcklkZW50aXR5IHx8CgkgICAgb3B0aW9ucy5wYXNzcGhyYXNlIHx8CgkgICAgb3B0aW9ucy5jaXBoZXJzIHx8CgkgICAgb3B0aW9ucy5jZXJ0IHx8CgkgICAgb3B0aW9ucy5rZXkgfHwKCSAgICBvcHRpb25zLnBmeCB8fAoJICAgIG9wdGlvbnMuY2EKCSAgKSB7CgkgICAgaWYgKG9wdGlvbnMucGFzc3BocmFzZSkgcmVxdWVzdE9wdGlvbnMucGFzc3BocmFzZSA9IG9wdGlvbnMucGFzc3BocmFzZTsKCSAgICBpZiAob3B0aW9ucy5jaXBoZXJzKSByZXF1ZXN0T3B0aW9ucy5jaXBoZXJzID0gb3B0aW9ucy5jaXBoZXJzOwoJICAgIGlmIChvcHRpb25zLmNlcnQpIHJlcXVlc3RPcHRpb25zLmNlcnQgPSBvcHRpb25zLmNlcnQ7CgkgICAgaWYgKG9wdGlvbnMua2V5KSByZXF1ZXN0T3B0aW9ucy5rZXkgPSBvcHRpb25zLmtleTsKCSAgICBpZiAob3B0aW9ucy5wZngpIHJlcXVlc3RPcHRpb25zLnBmeCA9IG9wdGlvbnMucGZ4OwoJICAgIGlmIChvcHRpb25zLmNhKSByZXF1ZXN0T3B0aW9ucy5jYSA9IG9wdGlvbnMuY2E7CgkgICAgaWYgKG9wdGlvbnMuY2hlY2tTZXJ2ZXJJZGVudGl0eSkgewoJICAgICAgcmVxdWVzdE9wdGlvbnMuY2hlY2tTZXJ2ZXJJZGVudGl0eSA9IG9wdGlvbnMuY2hlY2tTZXJ2ZXJJZGVudGl0eTsKCSAgICB9CgkgICAgaWYgKG9wdGlvbnMucmVqZWN0VW5hdXRob3JpemVkICE9IG51bGwpIHsKCSAgICAgIHJlcXVlc3RPcHRpb25zLnJlamVjdFVuYXV0aG9yaXplZCA9IG9wdGlvbnMucmVqZWN0VW5hdXRob3JpemVkOwoJICAgIH0KCgkgICAgaWYgKCFhZ2VudCkgYWdlbnQgPSBuZXcgaHR0cE9iai5BZ2VudChyZXF1ZXN0T3B0aW9ucyk7CgkgIH0KCgkgIGlmIChhZ2VudCkgcmVxdWVzdE9wdGlvbnMuYWdlbnQgPSBhZ2VudDsKCgkgIHRoaXMuX3JlcSA9IGh0dHBPYmouZ2V0KHJlcXVlc3RPcHRpb25zKTsKCgkgIHRoaXMuX3JlcS5vbignZXJyb3InLCAoZXJyb3IpID0+IHsKCSAgICBpZiAodGhpcy5fcmVxLmFib3J0ZWQpIHJldHVybjsKCgkgICAgdGhpcy5fcmVxID0gbnVsbDsKCSAgICB0aGlzLmVtaXQoJ2Vycm9yJywgZXJyb3IpOwoJICAgIHRoaXMuZmluYWxpemUodHJ1ZSk7CgkgIH0pOwoKCSAgdGhpcy5fcmVxLm9uKCdyZXNwb25zZScsIChyZXMpID0+IHsKCSAgICBpZiAoIXRoaXMuZW1pdCgndW5leHBlY3RlZC1yZXNwb25zZScsIHRoaXMuX3JlcSwgcmVzKSkgewoJICAgICAgdGhpcy5fcmVxLmFib3J0KCk7CgkgICAgICB0aGlzLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKGB1bmV4cGVjdGVkIHNlcnZlciByZXNwb25zZSAoJHtyZXMuc3RhdHVzQ29kZX0pYCkpOwoJICAgICAgdGhpcy5maW5hbGl6ZSh0cnVlKTsKCSAgICB9CgkgIH0pOwoKCSAgdGhpcy5fcmVxLm9uKCd1cGdyYWRlJywgKHJlcywgc29ja2V0LCBoZWFkKSA9PiB7CgkgICAgdGhpcy5fcmVxID0gbnVsbDsKCgkgICAgY29uc3QgZGlnZXN0ID0gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTEnKQoJICAgICAgLnVwZGF0ZShrZXkgKyBHVUlELCAnYmluYXJ5JykKCSAgICAgIC5kaWdlc3QoJ2Jhc2U2NCcpOwoKCSAgICBpZiAocmVzLmhlYWRlcnNbJ3NlYy13ZWJzb2NrZXQtYWNjZXB0J10gIT09IGRpZ2VzdCkgewoJICAgICAgc29ja2V0LmRlc3Ryb3koKTsKCSAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ2ludmFsaWQgc2VydmVyIGtleScpKTsKCSAgICAgIHJldHVybiB0aGlzLmZpbmFsaXplKHRydWUpOwoJICAgIH0KCgkgICAgY29uc3Qgc2VydmVyUHJvdCA9IHJlcy5oZWFkZXJzWydzZWMtd2Vic29ja2V0LXByb3RvY29sJ107CgkgICAgY29uc3QgcHJvdExpc3QgPSAob3B0aW9ucy5wcm90b2NvbCB8fCAnJykuc3BsaXQoLywgKi8pOwoJICAgIHZhciBwcm90RXJyb3I7CgoJICAgIGlmICghb3B0aW9ucy5wcm90b2NvbCAmJiBzZXJ2ZXJQcm90KSB7CgkgICAgICBwcm90RXJyb3IgPSAnc2VydmVyIHNlbnQgYSBzdWJwcm90b2NvbCBldmVuIHRob3VnaCBub25lIHJlcXVlc3RlZCc7CgkgICAgfSBlbHNlIGlmIChvcHRpb25zLnByb3RvY29sICYmICFzZXJ2ZXJQcm90KSB7CgkgICAgICBwcm90RXJyb3IgPSAnc2VydmVyIHNlbnQgbm8gc3VicHJvdG9jb2wgZXZlbiB0aG91Z2ggcmVxdWVzdGVkJzsKCSAgICB9IGVsc2UgaWYgKHNlcnZlclByb3QgJiYgcHJvdExpc3QuaW5kZXhPZihzZXJ2ZXJQcm90KSA9PT0gLTEpIHsKCSAgICAgIHByb3RFcnJvciA9ICdzZXJ2ZXIgcmVzcG9uZGVkIHdpdGggYW4gaW52YWxpZCBwcm90b2NvbCc7CgkgICAgfQoKCSAgICBpZiAocHJvdEVycm9yKSB7CgkgICAgICBzb2NrZXQuZGVzdHJveSgpOwoJICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcihwcm90RXJyb3IpKTsKCSAgICAgIHJldHVybiB0aGlzLmZpbmFsaXplKHRydWUpOwoJICAgIH0KCgkgICAgaWYgKHNlcnZlclByb3QpIHRoaXMucHJvdG9jb2wgPSBzZXJ2ZXJQcm90OwoKCSAgICBjb25zdCBzZXJ2ZXJFeHRlbnNpb25zID0gRXh0ZW5zaW9ucy5wYXJzZShyZXMuaGVhZGVyc1snc2VjLXdlYnNvY2tldC1leHRlbnNpb25zJ10pOwoKCSAgICBpZiAocGVyTWVzc2FnZURlZmxhdGUgJiYgc2VydmVyRXh0ZW5zaW9uc1tQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXSkgewoJICAgICAgdHJ5IHsKCSAgICAgICAgcGVyTWVzc2FnZURlZmxhdGUuYWNjZXB0KHNlcnZlckV4dGVuc2lvbnNbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0pOwoJICAgICAgfSBjYXRjaCAoZXJyKSB7CgkgICAgICAgIHNvY2tldC5kZXN0cm95KCk7CgkgICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ2ludmFsaWQgZXh0ZW5zaW9uIHBhcmFtZXRlcicpKTsKCSAgICAgICAgcmV0dXJuIHRoaXMuZmluYWxpemUodHJ1ZSk7CgkgICAgICB9CgoJICAgICAgdGhpcy5leHRlbnNpb25zW1Blck1lc3NhZ2VEZWZsYXRlLmV4dGVuc2lvbk5hbWVdID0gcGVyTWVzc2FnZURlZmxhdGU7CgkgICAgfQoKCSAgICB0aGlzLnNldFNvY2tldChzb2NrZXQsIGhlYWQpOwoJICB9KTsKCX0KCgovKioqLyB9LAovKiAzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLgoJLy8KCS8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCgkvLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCgkvLyAiU29mdHdhcmUiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nCgkvLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCgkvLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0CgkvLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUKCS8vIGZvbGxvd2luZyBjb25kaXRpb25zOgoJLy8KCS8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkCgkvLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCS8vCgkvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUwoJLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgoJLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTgoJLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sCgkvLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKCS8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUKCS8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCgoJZnVuY3Rpb24gRXZlbnRFbWl0dGVyKCkgewoJICB0aGlzLl9ldmVudHMgPSB0aGlzLl9ldmVudHMgfHwge307CgkgIHRoaXMuX21heExpc3RlbmVycyA9IHRoaXMuX21heExpc3RlbmVycyB8fCB1bmRlZmluZWQ7Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IEV2ZW50RW1pdHRlcjsKCgkvLyBCYWNrd2FyZHMtY29tcGF0IHdpdGggbm9kZSAwLjEwLngKCUV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7CgoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fZXZlbnRzID0gdW5kZWZpbmVkOwoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fbWF4TGlzdGVuZXJzID0gdW5kZWZpbmVkOwoKCS8vIEJ5IGRlZmF1bHQgRXZlbnRFbWl0dGVycyB3aWxsIHByaW50IGEgd2FybmluZyBpZiBtb3JlIHRoYW4gMTAgbGlzdGVuZXJzIGFyZQoJLy8gYWRkZWQgdG8gaXQuIFRoaXMgaXMgYSB1c2VmdWwgZGVmYXVsdCB3aGljaCBoZWxwcyBmaW5kaW5nIG1lbW9yeSBsZWFrcy4KCUV2ZW50RW1pdHRlci5kZWZhdWx0TWF4TGlzdGVuZXJzID0gMTA7CgoJLy8gT2J2aW91c2x5IG5vdCBhbGwgRW1pdHRlcnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gMTAuIFRoaXMgZnVuY3Rpb24gYWxsb3dzCgkvLyB0aGF0IHRvIGJlIGluY3JlYXNlZC4gU2V0IHRvIHplcm8gZm9yIHVubGltaXRlZC4KCUV2ZW50RW1pdHRlci5wcm90b3R5cGUuc2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24obikgewoJICBpZiAoIWlzTnVtYmVyKG4pIHx8IG4gPCAwIHx8IGlzTmFOKG4pKQoJICAgIHRocm93IFR5cGVFcnJvcignbiBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyJyk7CgkgIHRoaXMuX21heExpc3RlbmVycyA9IG47CgkgIHJldHVybiB0aGlzOwoJfTsKCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbih0eXBlKSB7CgkgIHZhciBlciwgaGFuZGxlciwgbGVuLCBhcmdzLCBpLCBsaXN0ZW5lcnM7CgoJICBpZiAoIXRoaXMuX2V2ZW50cykKCSAgICB0aGlzLl9ldmVudHMgPSB7fTsKCgkgIC8vIElmIHRoZXJlIGlzIG5vICdlcnJvcicgZXZlbnQgbGlzdGVuZXIgdGhlbiB0aHJvdy4KCSAgaWYgKHR5cGUgPT09ICdlcnJvcicpIHsKCSAgICBpZiAoIXRoaXMuX2V2ZW50cy5lcnJvciB8fAoJICAgICAgICAoaXNPYmplY3QodGhpcy5fZXZlbnRzLmVycm9yKSAmJiAhdGhpcy5fZXZlbnRzLmVycm9yLmxlbmd0aCkpIHsKCSAgICAgIGVyID0gYXJndW1lbnRzWzFdOwoJICAgICAgaWYgKGVyIGluc3RhbmNlb2YgRXJyb3IpIHsKCSAgICAgICAgdGhyb3cgZXI7IC8vIFVuaGFuZGxlZCAnZXJyb3InIGV2ZW50CgkgICAgICB9IGVsc2UgewoJICAgICAgICAvLyBBdCBsZWFzdCBnaXZlIHNvbWUga2luZCBvZiBjb250ZXh0IHRvIHRoZSB1c2VyCgkgICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoJ1VuY2F1Z2h0LCB1bnNwZWNpZmllZCAiZXJyb3IiIGV2ZW50LiAoJyArIGVyICsgJyknKTsKCSAgICAgICAgZXJyLmNvbnRleHQgPSBlcjsKCSAgICAgICAgdGhyb3cgZXJyOwoJICAgICAgfQoJICAgIH0KCSAgfQoKCSAgaGFuZGxlciA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCgkgIGlmIChpc1VuZGVmaW5lZChoYW5kbGVyKSkKCSAgICByZXR1cm4gZmFsc2U7CgoJICBpZiAoaXNGdW5jdGlvbihoYW5kbGVyKSkgewoJICAgIHN3aXRjaCAoYXJndW1lbnRzLmxlbmd0aCkgewoJICAgICAgLy8gZmFzdCBjYXNlcwoJICAgICAgY2FzZSAxOgoJICAgICAgICBoYW5kbGVyLmNhbGwodGhpcyk7CgkgICAgICAgIGJyZWFrOwoJICAgICAgY2FzZSAyOgoJICAgICAgICBoYW5kbGVyLmNhbGwodGhpcywgYXJndW1lbnRzWzFdKTsKCSAgICAgICAgYnJlYWs7CgkgICAgICBjYXNlIDM6CgkgICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSk7CgkgICAgICAgIGJyZWFrOwoJICAgICAgLy8gc2xvd2VyCgkgICAgICBkZWZhdWx0OgoJICAgICAgICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKCSAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICB9CgkgIH0gZWxzZSBpZiAoaXNPYmplY3QoaGFuZGxlcikpIHsKCSAgICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKCSAgICBsaXN0ZW5lcnMgPSBoYW5kbGVyLnNsaWNlKCk7CgkgICAgbGVuID0gbGlzdGVuZXJzLmxlbmd0aDsKCSAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspCgkgICAgICBsaXN0ZW5lcnNbaV0uYXBwbHkodGhpcywgYXJncyk7CgkgIH0KCgkgIHJldHVybiB0cnVlOwoJfTsKCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHsKCSAgdmFyIG07CgoJICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKQoJICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7CgoJICBpZiAoIXRoaXMuX2V2ZW50cykKCSAgICB0aGlzLl9ldmVudHMgPSB7fTsKCgkgIC8vIFRvIGF2b2lkIHJlY3Vyc2lvbiBpbiB0aGUgY2FzZSB0aGF0IHR5cGUgPT09ICJuZXdMaXN0ZW5lciIhIEJlZm9yZQoJICAvLyBhZGRpbmcgaXQgdG8gdGhlIGxpc3RlbmVycywgZmlyc3QgZW1pdCAibmV3TGlzdGVuZXIiLgoJICBpZiAodGhpcy5fZXZlbnRzLm5ld0xpc3RlbmVyKQoJICAgIHRoaXMuZW1pdCgnbmV3TGlzdGVuZXInLCB0eXBlLAoJICAgICAgICAgICAgICBpc0Z1bmN0aW9uKGxpc3RlbmVyLmxpc3RlbmVyKSA/CgkgICAgICAgICAgICAgIGxpc3RlbmVyLmxpc3RlbmVyIDogbGlzdGVuZXIpOwoKCSAgaWYgKCF0aGlzLl9ldmVudHNbdHlwZV0pCgkgICAgLy8gT3B0aW1pemUgdGhlIGNhc2Ugb2Ygb25lIGxpc3RlbmVyLiBEb24ndCBuZWVkIHRoZSBleHRyYSBhcnJheSBvYmplY3QuCgkgICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gbGlzdGVuZXI7CgkgIGVsc2UgaWYgKGlzT2JqZWN0KHRoaXMuX2V2ZW50c1t0eXBlXSkpCgkgICAgLy8gSWYgd2UndmUgYWxyZWFkeSBnb3QgYW4gYXJyYXksIGp1c3QgYXBwZW5kLgoJICAgIHRoaXMuX2V2ZW50c1t0eXBlXS5wdXNoKGxpc3RlbmVyKTsKCSAgZWxzZQoJICAgIC8vIEFkZGluZyB0aGUgc2Vjb25kIGVsZW1lbnQsIG5lZWQgdG8gY2hhbmdlIHRvIGFycmF5LgoJICAgIHRoaXMuX2V2ZW50c1t0eXBlXSA9IFt0aGlzLl9ldmVudHNbdHlwZV0sIGxpc3RlbmVyXTsKCgkgIC8vIENoZWNrIGZvciBsaXN0ZW5lciBsZWFrCgkgIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pICYmICF0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkKSB7CgkgICAgaWYgKCFpc1VuZGVmaW5lZCh0aGlzLl9tYXhMaXN0ZW5lcnMpKSB7CgkgICAgICBtID0gdGhpcy5fbWF4TGlzdGVuZXJzOwoJICAgIH0gZWxzZSB7CgkgICAgICBtID0gRXZlbnRFbWl0dGVyLmRlZmF1bHRNYXhMaXN0ZW5lcnM7CgkgICAgfQoKCSAgICBpZiAobSAmJiBtID4gMCAmJiB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoID4gbSkgewoJICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLndhcm5lZCA9IHRydWU7CgkgICAgICBjb25zb2xlLmVycm9yKCcobm9kZSkgd2FybmluZzogcG9zc2libGUgRXZlbnRFbWl0dGVyIG1lbW9yeSAnICsKCSAgICAgICAgICAgICAgICAgICAgJ2xlYWsgZGV0ZWN0ZWQuICVkIGxpc3RlbmVycyBhZGRlZC4gJyArCgkgICAgICAgICAgICAgICAgICAgICdVc2UgZW1pdHRlci5zZXRNYXhMaXN0ZW5lcnMoKSB0byBpbmNyZWFzZSBsaW1pdC4nLAoJICAgICAgICAgICAgICAgICAgICB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoKTsKCSAgICAgIGlmICh0eXBlb2YgY29uc29sZS50cmFjZSA9PT0gJ2Z1bmN0aW9uJykgewoJICAgICAgICAvLyBub3Qgc3VwcG9ydGVkIGluIElFIDEwCgkgICAgICAgIGNvbnNvbGUudHJhY2UoKTsKCSAgICAgIH0KCSAgICB9CgkgIH0KCgkgIHJldHVybiB0aGlzOwoJfTsKCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uID0gRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lcjsKCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikgewoJICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKQoJICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7CgoJICB2YXIgZmlyZWQgPSBmYWxzZTsKCgkgIGZ1bmN0aW9uIGcoKSB7CgkgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBnKTsKCgkgICAgaWYgKCFmaXJlZCkgewoJICAgICAgZmlyZWQgPSB0cnVlOwoJICAgICAgbGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCSAgICB9CgkgIH0KCgkgIGcubGlzdGVuZXIgPSBsaXN0ZW5lcjsKCSAgdGhpcy5vbih0eXBlLCBnKTsKCgkgIHJldHVybiB0aGlzOwoJfTsKCgkvLyBlbWl0cyBhICdyZW1vdmVMaXN0ZW5lcicgZXZlbnQgaWZmIHRoZSBsaXN0ZW5lciB3YXMgcmVtb3ZlZAoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lciA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7CgkgIHZhciBsaXN0LCBwb3NpdGlvbiwgbGVuZ3RoLCBpOwoKCSAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSkKCSAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpOwoKCSAgaWYgKCF0aGlzLl9ldmVudHMgfHwgIXRoaXMuX2V2ZW50c1t0eXBlXSkKCSAgICByZXR1cm4gdGhpczsKCgkgIGxpc3QgPSB0aGlzLl9ldmVudHNbdHlwZV07CgkgIGxlbmd0aCA9IGxpc3QubGVuZ3RoOwoJICBwb3NpdGlvbiA9IC0xOwoKCSAgaWYgKGxpc3QgPT09IGxpc3RlbmVyIHx8CgkgICAgICAoaXNGdW5jdGlvbihsaXN0Lmxpc3RlbmVyKSAmJiBsaXN0Lmxpc3RlbmVyID09PSBsaXN0ZW5lcikpIHsKCSAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdOwoJICAgIGlmICh0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpCgkgICAgICB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgbGlzdGVuZXIpOwoKCSAgfSBlbHNlIGlmIChpc09iamVjdChsaXN0KSkgewoJICAgIGZvciAoaSA9IGxlbmd0aDsgaS0tID4gMDspIHsKCSAgICAgIGlmIChsaXN0W2ldID09PSBsaXN0ZW5lciB8fAoJICAgICAgICAgIChsaXN0W2ldLmxpc3RlbmVyICYmIGxpc3RbaV0ubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkgewoJICAgICAgICBwb3NpdGlvbiA9IGk7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgIH0KCgkgICAgaWYgKHBvc2l0aW9uIDwgMCkKCSAgICAgIHJldHVybiB0aGlzOwoKCSAgICBpZiAobGlzdC5sZW5ndGggPT09IDEpIHsKCSAgICAgIGxpc3QubGVuZ3RoID0gMDsKCSAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07CgkgICAgfSBlbHNlIHsKCSAgICAgIGxpc3Quc3BsaWNlKHBvc2l0aW9uLCAxKTsKCSAgICB9CgoJICAgIGlmICh0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpCgkgICAgICB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgbGlzdGVuZXIpOwoJICB9CgoJICByZXR1cm4gdGhpczsKCX07CgoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbih0eXBlKSB7CgkgIHZhciBrZXksIGxpc3RlbmVyczsKCgkgIGlmICghdGhpcy5fZXZlbnRzKQoJICAgIHJldHVybiB0aGlzOwoKCSAgLy8gbm90IGxpc3RlbmluZyBmb3IgcmVtb3ZlTGlzdGVuZXIsIG5vIG5lZWQgdG8gZW1pdAoJICBpZiAoIXRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikgewoJICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKQoJICAgICAgdGhpcy5fZXZlbnRzID0ge307CgkgICAgZWxzZSBpZiAodGhpcy5fZXZlbnRzW3R5cGVdKQoJICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTsKCSAgICByZXR1cm4gdGhpczsKCSAgfQoKCSAgLy8gZW1pdCByZW1vdmVMaXN0ZW5lciBmb3IgYWxsIGxpc3RlbmVycyBvbiBhbGwgZXZlbnRzCgkgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7CgkgICAgZm9yIChrZXkgaW4gdGhpcy5fZXZlbnRzKSB7CgkgICAgICBpZiAoa2V5ID09PSAncmVtb3ZlTGlzdGVuZXInKSBjb250aW51ZTsKCSAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKGtleSk7CgkgICAgfQoJICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCdyZW1vdmVMaXN0ZW5lcicpOwoJICAgIHRoaXMuX2V2ZW50cyA9IHt9OwoJICAgIHJldHVybiB0aGlzOwoJICB9CgoJICBsaXN0ZW5lcnMgPSB0aGlzLl9ldmVudHNbdHlwZV07CgoJICBpZiAoaXNGdW5jdGlvbihsaXN0ZW5lcnMpKSB7CgkgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpOwoJICB9IGVsc2UgaWYgKGxpc3RlbmVycykgewoJICAgIC8vIExJRk8gb3JkZXIKCSAgICB3aGlsZSAobGlzdGVuZXJzLmxlbmd0aCkKCSAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzW2xpc3RlbmVycy5sZW5ndGggLSAxXSk7CgkgIH0KCSAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTsKCgkgIHJldHVybiB0aGlzOwoJfTsKCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uKHR5cGUpIHsKCSAgdmFyIHJldDsKCSAgaWYgKCF0aGlzLl9ldmVudHMgfHwgIXRoaXMuX2V2ZW50c1t0eXBlXSkKCSAgICByZXQgPSBbXTsKCSAgZWxzZSBpZiAoaXNGdW5jdGlvbih0aGlzLl9ldmVudHNbdHlwZV0pKQoJICAgIHJldCA9IFt0aGlzLl9ldmVudHNbdHlwZV1dOwoJICBlbHNlCgkgICAgcmV0ID0gdGhpcy5fZXZlbnRzW3R5cGVdLnNsaWNlKCk7CgkgIHJldHVybiByZXQ7Cgl9OwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKHR5cGUpIHsKCSAgaWYgKHRoaXMuX2V2ZW50cykgewoJICAgIHZhciBldmxpc3RlbmVyID0gdGhpcy5fZXZlbnRzW3R5cGVdOwoKCSAgICBpZiAoaXNGdW5jdGlvbihldmxpc3RlbmVyKSkKCSAgICAgIHJldHVybiAxOwoJICAgIGVsc2UgaWYgKGV2bGlzdGVuZXIpCgkgICAgICByZXR1cm4gZXZsaXN0ZW5lci5sZW5ndGg7CgkgIH0KCSAgcmV0dXJuIDA7Cgl9OwoKCUV2ZW50RW1pdHRlci5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24oZW1pdHRlciwgdHlwZSkgewoJICByZXR1cm4gZW1pdHRlci5saXN0ZW5lckNvdW50KHR5cGUpOwoJfTsKCglmdW5jdGlvbiBpc0Z1bmN0aW9uKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Z1bmN0aW9uJzsKCX0KCglmdW5jdGlvbiBpc051bWJlcihhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdudW1iZXInOwoJfQoKCWZ1bmN0aW9uIGlzT2JqZWN0KGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsOwoJfQoKCWZ1bmN0aW9uIGlzVW5kZWZpbmVkKGFyZykgewoJICByZXR1cm4gYXJnID09PSB2b2lkIDA7Cgl9CgoKLyoqKi8gfSwKLyogNCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oQnVmZmVyKSB7dmFyIHJuZyA9IF9fd2VicGFja19yZXF1aXJlX18oOSkKCglmdW5jdGlvbiBlcnJvciAoKSB7CgkgIHZhciBtID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMpLmpvaW4oJyAnKQoJICB0aHJvdyBuZXcgRXJyb3IoWwoJICAgIG0sCgkgICAgJ3dlIGFjY2VwdCBwdWxsIHJlcXVlc3RzJywKCSAgICAnaHR0cDovL2dpdGh1Yi5jb20vZG9taW5pY3RhcnIvY3J5cHRvLWJyb3dzZXJpZnknCgkgICAgXS5qb2luKCdcbicpKQoJfQoKCWV4cG9ydHMuY3JlYXRlSGFzaCA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpCgoJZXhwb3J0cy5jcmVhdGVIbWFjID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCkKCglleHBvcnRzLnJhbmRvbUJ5dGVzID0gZnVuY3Rpb24oc2l6ZSwgY2FsbGJhY2spIHsKCSAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrLmNhbGwpIHsKCSAgICB0cnkgewoJICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLCB1bmRlZmluZWQsIG5ldyBCdWZmZXIocm5nKHNpemUpKSkKCSAgICB9IGNhdGNoIChlcnIpIHsgY2FsbGJhY2soZXJyKSB9CgkgIH0gZWxzZSB7CgkgICAgcmV0dXJuIG5ldyBCdWZmZXIocm5nKHNpemUpKQoJICB9Cgl9CgoJZnVuY3Rpb24gZWFjaChhLCBmKSB7CgkgIGZvcih2YXIgaSBpbiBhKQoJICAgIGYoYVtpXSwgaSkKCX0KCglleHBvcnRzLmdldEhhc2hlcyA9IGZ1bmN0aW9uICgpIHsKCSAgcmV0dXJuIFsnc2hhMScsICdzaGEyNTYnLCAnc2hhNTEyJywgJ21kNScsICdybWQxNjAnXQoJfQoKCXZhciBwID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkoZXhwb3J0cykKCWV4cG9ydHMucGJrZGYyID0gcC5wYmtkZjIKCWV4cG9ydHMucGJrZGYyU3luYyA9IHAucGJrZGYyU3luYwoJX193ZWJwYWNrX3JlcXVpcmVfXygyNykoZXhwb3J0cywgbW9kdWxlLmV4cG9ydHMpOwoKCS8vIHRoZSBsZWFzdCBJIGNhbiBkbyBpcyBtYWtlIGVycm9yIG1lc3NhZ2VzIGZvciB0aGUgcmVzdCBvZiB0aGUgbm9kZS5qcy9jcnlwdG8gYXBpLgoJZWFjaChbJ2NyZWF0ZUNyZWRlbnRpYWxzJwoJLCAnY3JlYXRlU2lnbicKCSwgJ2NyZWF0ZVZlcmlmeScKCSwgJ2NyZWF0ZURpZmZpZUhlbGxtYW4nCgldLCBmdW5jdGlvbiAobmFtZSkgewoJICBleHBvcnRzW25hbWVdID0gZnVuY3Rpb24gKCkgewoJICAgIGVycm9yKCdzb3JyeSwnLCBuYW1lLCAnaXMgbm90IGltcGxlbWVudGVkIHlldCcpCgkgIH0KCX0pCgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oNSkuQnVmZmVyKSkKCi8qKiovIH0sCi8qIDUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCkgey8qIQoJICogVGhlIGJ1ZmZlciBtb2R1bGUgZnJvbSBub2RlLmpzLCBmb3IgdGhlIGJyb3dzZXIuCgkgKgoJICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGZlcm9zc0BmZXJvc3Mub3JnPiA8aHR0cDovL2Zlcm9zcy5vcmc+CgkgKiBAbGljZW5zZSAgTUlUCgkgKi8KCS8qIGVzbGludC1kaXNhYmxlIG5vLXByb3RvICovCgoJJ3VzZSBzdHJpY3QnCgoJdmFyIGJhc2U2NCA9IF9fd2VicGFja19yZXF1aXJlX18oNikKCXZhciBpZWVlNzU0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KQoJdmFyIGlzQXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCgoJZXhwb3J0cy5CdWZmZXIgPSBCdWZmZXIKCWV4cG9ydHMuU2xvd0J1ZmZlciA9IFNsb3dCdWZmZXIKCWV4cG9ydHMuSU5TUEVDVF9NQVhfQllURVMgPSA1MAoKCS8qKgoJICogSWYgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYDoKCSAqICAgPT09IHRydWUgICAgVXNlIFVpbnQ4QXJyYXkgaW1wbGVtZW50YXRpb24gKGZhc3Rlc3QpCgkgKiAgID09PSBmYWxzZSAgIFVzZSBPYmplY3QgaW1wbGVtZW50YXRpb24gKG1vc3QgY29tcGF0aWJsZSwgZXZlbiBJRTYpCgkgKgoJICogQnJvd3NlcnMgdGhhdCBzdXBwb3J0IHR5cGVkIGFycmF5cyBhcmUgSUUgMTArLCBGaXJlZm94IDQrLCBDaHJvbWUgNyssIFNhZmFyaSA1LjErLAoJICogT3BlcmEgMTEuNissIGlPUyA0LjIrLgoJICoKCSAqIER1ZSB0byB2YXJpb3VzIGJyb3dzZXIgYnVncywgc29tZXRpbWVzIHRoZSBPYmplY3QgaW1wbGVtZW50YXRpb24gd2lsbCBiZSB1c2VkIGV2ZW4KCSAqIHdoZW4gdGhlIGJyb3dzZXIgc3VwcG9ydHMgdHlwZWQgYXJyYXlzLgoJICoKCSAqIE5vdGU6CgkgKgoJICogICAtIEZpcmVmb3ggNC0yOSBsYWNrcyBzdXBwb3J0IGZvciBhZGRpbmcgbmV3IHByb3BlcnRpZXMgdG8gYFVpbnQ4QXJyYXlgIGluc3RhbmNlcywKCSAqICAgICBTZWU6IGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY5NTQzOC4KCSAqCgkgKiAgIC0gQ2hyb21lIDktMTAgaXMgbWlzc2luZyB0aGUgYFR5cGVkQXJyYXkucHJvdG90eXBlLnN1YmFycmF5YCBmdW5jdGlvbi4KCSAqCgkgKiAgIC0gSUUxMCBoYXMgYSBicm9rZW4gYFR5cGVkQXJyYXkucHJvdG90eXBlLnN1YmFycmF5YCBmdW5jdGlvbiB3aGljaCByZXR1cm5zIGFycmF5cyBvZgoJICogICAgIGluY29ycmVjdCBsZW5ndGggaW4gc29tZSBzaXR1YXRpb25zLgoKCSAqIFdlIGRldGVjdCB0aGVzZSBidWdneSBicm93c2VycyBhbmQgc2V0IGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGAgdG8gYGZhbHNlYCBzbyB0aGV5CgkgKiBnZXQgdGhlIE9iamVjdCBpbXBsZW1lbnRhdGlvbiwgd2hpY2ggaXMgc2xvd2VyIGJ1dCBiZWhhdmVzIGNvcnJlY3RseS4KCSAqLwoJQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgPSBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVCAhPT0gdW5kZWZpbmVkCgkgID8gZ2xvYmFsLlRZUEVEX0FSUkFZX1NVUFBPUlQKCSAgOiB0eXBlZEFycmF5U3VwcG9ydCgpCgoJLyoKCSAqIEV4cG9ydCBrTWF4TGVuZ3RoIGFmdGVyIHR5cGVkIGFycmF5IHN1cHBvcnQgaXMgZGV0ZXJtaW5lZC4KCSAqLwoJZXhwb3J0cy5rTWF4TGVuZ3RoID0ga01heExlbmd0aCgpCgoJZnVuY3Rpb24gdHlwZWRBcnJheVN1cHBvcnQgKCkgewoJICB0cnkgewoJICAgIHZhciBhcnIgPSBuZXcgVWludDhBcnJheSgxKQoJICAgIGFyci5fX3Byb3RvX18gPSB7X19wcm90b19fOiBVaW50OEFycmF5LnByb3RvdHlwZSwgZm9vOiBmdW5jdGlvbiAoKSB7IHJldHVybiA0MiB9fQoJICAgIHJldHVybiBhcnIuZm9vKCkgPT09IDQyICYmIC8vIHR5cGVkIGFycmF5IGluc3RhbmNlcyBjYW4gYmUgYXVnbWVudGVkCgkgICAgICAgIHR5cGVvZiBhcnIuc3ViYXJyYXkgPT09ICdmdW5jdGlvbicgJiYgLy8gY2hyb21lIDktMTAgbGFjayBgc3ViYXJyYXlgCgkgICAgICAgIGFyci5zdWJhcnJheSgxLCAxKS5ieXRlTGVuZ3RoID09PSAwIC8vIGllMTAgaGFzIGJyb2tlbiBgc3ViYXJyYXlgCgkgIH0gY2F0Y2ggKGUpIHsKCSAgICByZXR1cm4gZmFsc2UKCSAgfQoJfQoKCWZ1bmN0aW9uIGtNYXhMZW5ndGggKCkgewoJICByZXR1cm4gQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQKCSAgICA/IDB4N2ZmZmZmZmYKCSAgICA6IDB4M2ZmZmZmZmYKCX0KCglmdW5jdGlvbiBjcmVhdGVCdWZmZXIgKHRoYXQsIGxlbmd0aCkgewoJICBpZiAoa01heExlbmd0aCgpIDwgbGVuZ3RoKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgdHlwZWQgYXJyYXkgbGVuZ3RoJykKCSAgfQoJICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2UKCSAgICB0aGF0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKQoJICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZQoJICB9IGVsc2UgewoJICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3MKCSAgICBpZiAodGhhdCA9PT0gbnVsbCkgewoJICAgICAgdGhhdCA9IG5ldyBCdWZmZXIobGVuZ3RoKQoJICAgIH0KCSAgICB0aGF0Lmxlbmd0aCA9IGxlbmd0aAoJICB9CgoJICByZXR1cm4gdGhhdAoJfQoKCS8qKgoJICogVGhlIEJ1ZmZlciBjb25zdHJ1Y3RvciByZXR1cm5zIGluc3RhbmNlcyBvZiBgVWludDhBcnJheWAgdGhhdCBoYXZlIHRoZWlyCgkgKiBwcm90b3R5cGUgY2hhbmdlZCB0byBgQnVmZmVyLnByb3RvdHlwZWAuIEZ1cnRoZXJtb3JlLCBgQnVmZmVyYCBpcyBhIHN1YmNsYXNzIG9mCgkgKiBgVWludDhBcnJheWAsIHNvIHRoZSByZXR1cm5lZCBpbnN0YW5jZXMgd2lsbCBoYXZlIGFsbCB0aGUgbm9kZSBgQnVmZmVyYCBtZXRob2RzCgkgKiBhbmQgdGhlIGBVaW50OEFycmF5YCBtZXRob2RzLiBTcXVhcmUgYnJhY2tldCBub3RhdGlvbiB3b3JrcyBhcyBleHBlY3RlZCAtLSBpdAoJICogcmV0dXJucyBhIHNpbmdsZSBvY3RldC4KCSAqCgkgKiBUaGUgYFVpbnQ4QXJyYXlgIHByb3RvdHlwZSByZW1haW5zIHVubW9kaWZpZWQuCgkgKi8KCglmdW5jdGlvbiBCdWZmZXIgKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7CgkgIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgJiYgISh0aGlzIGluc3RhbmNlb2YgQnVmZmVyKSkgewoJICAgIHJldHVybiBuZXcgQnVmZmVyKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKQoJICB9CgoJICAvLyBDb21tb24gY2FzZS4KCSAgaWYgKHR5cGVvZiBhcmcgPT09ICdudW1iZXInKSB7CgkgICAgaWYgKHR5cGVvZiBlbmNvZGluZ09yT2Zmc2V0ID09PSAnc3RyaW5nJykgewoJICAgICAgdGhyb3cgbmV3IEVycm9yKAoJICAgICAgICAnSWYgZW5jb2RpbmcgaXMgc3BlY2lmaWVkIHRoZW4gdGhlIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcnCgkgICAgICApCgkgICAgfQoJICAgIHJldHVybiBhbGxvY1Vuc2FmZSh0aGlzLCBhcmcpCgkgIH0KCSAgcmV0dXJuIGZyb20odGhpcywgYXJnLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpCgl9CgoJQnVmZmVyLnBvb2xTaXplID0gODE5MiAvLyBub3QgdXNlZCBieSB0aGlzIGltcGxlbWVudGF0aW9uCgoJLy8gVE9ETzogTGVnYWN5LCBub3QgbmVlZGVkIGFueW1vcmUuIFJlbW92ZSBpbiBuZXh0IG1ham9yIHZlcnNpb24uCglCdWZmZXIuX2F1Z21lbnQgPSBmdW5jdGlvbiAoYXJyKSB7CgkgIGFyci5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlCgkgIHJldHVybiBhcnIKCX0KCglmdW5jdGlvbiBmcm9tICh0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7CgkgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignInZhbHVlIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpCgkgIH0KCgkgIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIHZhbHVlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsKCSAgICByZXR1cm4gZnJvbUFycmF5QnVmZmVyKHRoYXQsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpCgkgIH0KCgkgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7CgkgICAgcmV0dXJuIGZyb21TdHJpbmcodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQpCgkgIH0KCgkgIHJldHVybiBmcm9tT2JqZWN0KHRoYXQsIHZhbHVlKQoJfQoKCS8qKgoJICogRnVuY3Rpb25hbGx5IGVxdWl2YWxlbnQgdG8gQnVmZmVyKGFyZywgZW5jb2RpbmcpIGJ1dCB0aHJvd3MgYSBUeXBlRXJyb3IKCSAqIGlmIHZhbHVlIGlzIGEgbnVtYmVyLgoJICogQnVmZmVyLmZyb20oc3RyWywgZW5jb2RpbmddKQoJICogQnVmZmVyLmZyb20oYXJyYXkpCgkgKiBCdWZmZXIuZnJvbShidWZmZXIpCgkgKiBCdWZmZXIuZnJvbShhcnJheUJ1ZmZlclssIGJ5dGVPZmZzZXRbLCBsZW5ndGhdXSkKCSAqKi8KCUJ1ZmZlci5mcm9tID0gZnVuY3Rpb24gKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHsKCSAgcmV0dXJuIGZyb20obnVsbCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkKCX0KCglpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgQnVmZmVyLnByb3RvdHlwZS5fX3Byb3RvX18gPSBVaW50OEFycmF5LnByb3RvdHlwZQoJICBCdWZmZXIuX19wcm90b19fID0gVWludDhBcnJheQoJICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnNwZWNpZXMgJiYKCSAgICAgIEJ1ZmZlcltTeW1ib2wuc3BlY2llc10gPT09IEJ1ZmZlcikgewoJICAgIC8vIEZpeCBzdWJhcnJheSgpIGluIEVTMjAxNi4gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZmVyb3NzL2J1ZmZlci9wdWxsLzk3CgkgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1ZmZlciwgU3ltYm9sLnNwZWNpZXMsIHsKCSAgICAgIHZhbHVlOiBudWxsLAoJICAgICAgY29uZmlndXJhYmxlOiB0cnVlCgkgICAgfSkKCSAgfQoJfQoKCWZ1bmN0aW9uIGFzc2VydFNpemUgKHNpemUpIHsKCSAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyJzaXplIiBhcmd1bWVudCBtdXN0IGJlIGEgbnVtYmVyJykKCSAgfSBlbHNlIGlmIChzaXplIDwgMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCcic2l6ZSIgYXJndW1lbnQgbXVzdCBub3QgYmUgbmVnYXRpdmUnKQoJICB9Cgl9CgoJZnVuY3Rpb24gYWxsb2MgKHRoYXQsIHNpemUsIGZpbGwsIGVuY29kaW5nKSB7CgkgIGFzc2VydFNpemUoc2l6ZSkKCSAgaWYgKHNpemUgPD0gMCkgewoJICAgIHJldHVybiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkKCSAgfQoJICBpZiAoZmlsbCAhPT0gdW5kZWZpbmVkKSB7CgkgICAgLy8gT25seSBwYXkgYXR0ZW50aW9uIHRvIGVuY29kaW5nIGlmIGl0J3MgYSBzdHJpbmcuIFRoaXMKCSAgICAvLyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgc2VuZGluZyBpbiBhIG51bWJlciB0aGF0IHdvdWxkCgkgICAgLy8gYmUgaW50ZXJwcmV0dGVkIGFzIGEgc3RhcnQgb2Zmc2V0LgoJICAgIHJldHVybiB0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnCgkgICAgICA/IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKS5maWxsKGZpbGwsIGVuY29kaW5nKQoJICAgICAgOiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkuZmlsbChmaWxsKQoJICB9CgkgIHJldHVybiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkKCX0KCgkvKioKCSAqIENyZWF0ZXMgYSBuZXcgZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS4KCSAqIGFsbG9jKHNpemVbLCBmaWxsWywgZW5jb2RpbmddXSkKCSAqKi8KCUJ1ZmZlci5hbGxvYyA9IGZ1bmN0aW9uIChzaXplLCBmaWxsLCBlbmNvZGluZykgewoJICByZXR1cm4gYWxsb2MobnVsbCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpCgl9CgoJZnVuY3Rpb24gYWxsb2NVbnNhZmUgKHRoYXQsIHNpemUpIHsKCSAgYXNzZXJ0U2l6ZShzaXplKQoJICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUgPCAwID8gMCA6IGNoZWNrZWQoc2l6ZSkgfCAwKQoJICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyArK2kpIHsKCSAgICAgIHRoYXRbaV0gPSAwCgkgICAgfQoJICB9CgkgIHJldHVybiB0aGF0Cgl9CgoJLyoqCgkgKiBFcXVpdmFsZW50IHRvIEJ1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLgoJICogKi8KCUJ1ZmZlci5hbGxvY1Vuc2FmZSA9IGZ1bmN0aW9uIChzaXplKSB7CgkgIHJldHVybiBhbGxvY1Vuc2FmZShudWxsLCBzaXplKQoJfQoJLyoqCgkgKiBFcXVpdmFsZW50IHRvIFNsb3dCdWZmZXIobnVtKSwgYnkgZGVmYXVsdCBjcmVhdGVzIGEgbm9uLXplcm8tZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS4KCSAqLwoJQnVmZmVyLmFsbG9jVW5zYWZlU2xvdyA9IGZ1bmN0aW9uIChzaXplKSB7CgkgIHJldHVybiBhbGxvY1Vuc2FmZShudWxsLCBzaXplKQoJfQoKCWZ1bmN0aW9uIGZyb21TdHJpbmcgKHRoYXQsIHN0cmluZywgZW5jb2RpbmcpIHsKCSAgaWYgKHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycgfHwgZW5jb2RpbmcgPT09ICcnKSB7CgkgICAgZW5jb2RpbmcgPSAndXRmOCcKCSAgfQoKCSAgaWYgKCFCdWZmZXIuaXNFbmNvZGluZyhlbmNvZGluZykpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCciZW5jb2RpbmciIG11c3QgYmUgYSB2YWxpZCBzdHJpbmcgZW5jb2RpbmcnKQoJICB9CgoJICB2YXIgbGVuZ3RoID0gYnl0ZUxlbmd0aChzdHJpbmcsIGVuY29kaW5nKSB8IDAKCSAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBsZW5ndGgpCgoJICB2YXIgYWN0dWFsID0gdGhhdC53cml0ZShzdHJpbmcsIGVuY29kaW5nKQoKCSAgaWYgKGFjdHVhbCAhPT0gbGVuZ3RoKSB7CgkgICAgLy8gV3JpdGluZyBhIGhleCBzdHJpbmcsIGZvciBleGFtcGxlLCB0aGF0IGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycyB3aWxsCgkgICAgLy8gY2F1c2UgZXZlcnl0aGluZyBhZnRlciB0aGUgZmlyc3QgaW52YWxpZCBjaGFyYWN0ZXIgdG8gYmUgaWdub3JlZC4gKGUuZy4KCSAgICAvLyAnYWJ4eGNkJyB3aWxsIGJlIHRyZWF0ZWQgYXMgJ2FiJykKCSAgICB0aGF0ID0gdGhhdC5zbGljZSgwLCBhY3R1YWwpCgkgIH0KCgkgIHJldHVybiB0aGF0Cgl9CgoJZnVuY3Rpb24gZnJvbUFycmF5TGlrZSAodGhhdCwgYXJyYXkpIHsKCSAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aCA8IDAgPyAwIDogY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMAoJICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbmd0aCkKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkgewoJICAgIHRoYXRbaV0gPSBhcnJheVtpXSAmIDI1NQoJICB9CgkgIHJldHVybiB0aGF0Cgl9CgoJZnVuY3Rpb24gZnJvbUFycmF5QnVmZmVyICh0aGF0LCBhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKSB7CgkgIGFycmF5LmJ5dGVMZW5ndGggLy8gdGhpcyB0aHJvd3MgaWYgYGFycmF5YCBpcyBub3QgYSB2YWxpZCBBcnJheUJ1ZmZlcgoKCSAgaWYgKGJ5dGVPZmZzZXQgPCAwIHx8IGFycmF5LmJ5dGVMZW5ndGggPCBieXRlT2Zmc2V0KSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wnb2Zmc2V0XCcgaXMgb3V0IG9mIGJvdW5kcycpCgkgIH0KCgkgIGlmIChhcnJheS5ieXRlTGVuZ3RoIDwgYnl0ZU9mZnNldCArIChsZW5ndGggfHwgMCkpIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXCdsZW5ndGhcJyBpcyBvdXQgb2YgYm91bmRzJykKCSAgfQoKCSAgaWYgKGJ5dGVPZmZzZXQgPT09IHVuZGVmaW5lZCAmJiBsZW5ndGggPT09IHVuZGVmaW5lZCkgewoJICAgIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXkpCgkgIH0gZWxzZSBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIHsKCSAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0KQoJICB9IGVsc2UgewoJICAgIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXksIGJ5dGVPZmZzZXQsIGxlbmd0aCkKCSAgfQoKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlCgkgICAgdGhhdCA9IGFycmF5CgkgICAgdGhhdC5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlCgkgIH0gZWxzZSB7CgkgICAgLy8gRmFsbGJhY2s6IFJldHVybiBhbiBvYmplY3QgaW5zdGFuY2Ugb2YgdGhlIEJ1ZmZlciBjbGFzcwoJICAgIHRoYXQgPSBmcm9tQXJyYXlMaWtlKHRoYXQsIGFycmF5KQoJICB9CgkgIHJldHVybiB0aGF0Cgl9CgoJZnVuY3Rpb24gZnJvbU9iamVjdCAodGhhdCwgb2JqKSB7CgkgIGlmIChCdWZmZXIuaXNCdWZmZXIob2JqKSkgewoJICAgIHZhciBsZW4gPSBjaGVja2VkKG9iai5sZW5ndGgpIHwgMAoJICAgIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuKQoKCSAgICBpZiAodGhhdC5sZW5ndGggPT09IDApIHsKCSAgICAgIHJldHVybiB0aGF0CgkgICAgfQoKCSAgICBvYmouY29weSh0aGF0LCAwLCAwLCBsZW4pCgkgICAgcmV0dXJuIHRoYXQKCSAgfQoKCSAgaWYgKG9iaikgewoJICAgIGlmICgodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJgoJICAgICAgICBvYmouYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHx8ICdsZW5ndGgnIGluIG9iaikgewoJICAgICAgaWYgKHR5cGVvZiBvYmoubGVuZ3RoICE9PSAnbnVtYmVyJyB8fCBpc25hbihvYmoubGVuZ3RoKSkgewoJICAgICAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIDApCgkgICAgICB9CgkgICAgICByZXR1cm4gZnJvbUFycmF5TGlrZSh0aGF0LCBvYmopCgkgICAgfQoKCSAgICBpZiAob2JqLnR5cGUgPT09ICdCdWZmZXInICYmIGlzQXJyYXkob2JqLmRhdGEpKSB7CgkgICAgICByZXR1cm4gZnJvbUFycmF5TGlrZSh0aGF0LCBvYmouZGF0YSkKCSAgICB9CgkgIH0KCgkgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgQXJyYXlCdWZmZXIsIEFycmF5LCBvciBhcnJheS1saWtlIG9iamVjdC4nKQoJfQoKCWZ1bmN0aW9uIGNoZWNrZWQgKGxlbmd0aCkgewoJICAvLyBOb3RlOiBjYW5ub3QgdXNlIGBsZW5ndGggPCBrTWF4TGVuZ3RoKClgIGhlcmUgYmVjYXVzZSB0aGF0IGZhaWxzIHdoZW4KCSAgLy8gbGVuZ3RoIGlzIE5hTiAod2hpY2ggaXMgb3RoZXJ3aXNlIGNvZXJjZWQgdG8gemVyby4pCgkgIGlmIChsZW5ndGggPj0ga01heExlbmd0aCgpKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gYWxsb2NhdGUgQnVmZmVyIGxhcmdlciB0aGFuIG1heGltdW0gJyArCgkgICAgICAgICAgICAgICAgICAgICAgICAgJ3NpemU6IDB4JyArIGtNYXhMZW5ndGgoKS50b1N0cmluZygxNikgKyAnIGJ5dGVzJykKCSAgfQoJICByZXR1cm4gbGVuZ3RoIHwgMAoJfQoKCWZ1bmN0aW9uIFNsb3dCdWZmZXIgKGxlbmd0aCkgewoJICBpZiAoK2xlbmd0aCAhPSBsZW5ndGgpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBlcWVxZXEKCSAgICBsZW5ndGggPSAwCgkgIH0KCSAgcmV0dXJuIEJ1ZmZlci5hbGxvYygrbGVuZ3RoKQoJfQoKCUJ1ZmZlci5pc0J1ZmZlciA9IGZ1bmN0aW9uIGlzQnVmZmVyIChiKSB7CgkgIHJldHVybiAhIShiICE9IG51bGwgJiYgYi5faXNCdWZmZXIpCgl9CgoJQnVmZmVyLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlIChhLCBiKSB7CgkgIGlmICghQnVmZmVyLmlzQnVmZmVyKGEpIHx8ICFCdWZmZXIuaXNCdWZmZXIoYikpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzJykKCSAgfQoKCSAgaWYgKGEgPT09IGIpIHJldHVybiAwCgoJICB2YXIgeCA9IGEubGVuZ3RoCgkgIHZhciB5ID0gYi5sZW5ndGgKCgkgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBNYXRoLm1pbih4LCB5KTsgaSA8IGxlbjsgKytpKSB7CgkgICAgaWYgKGFbaV0gIT09IGJbaV0pIHsKCSAgICAgIHggPSBhW2ldCgkgICAgICB5ID0gYltpXQoJICAgICAgYnJlYWsKCSAgICB9CgkgIH0KCgkgIGlmICh4IDwgeSkgcmV0dXJuIC0xCgkgIGlmICh5IDwgeCkgcmV0dXJuIDEKCSAgcmV0dXJuIDAKCX0KCglCdWZmZXIuaXNFbmNvZGluZyA9IGZ1bmN0aW9uIGlzRW5jb2RpbmcgKGVuY29kaW5nKSB7CgkgIHN3aXRjaCAoU3RyaW5nKGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpKSB7CgkgICAgY2FzZSAnaGV4JzoKCSAgICBjYXNlICd1dGY4JzoKCSAgICBjYXNlICd1dGYtOCc6CgkgICAgY2FzZSAnYXNjaWknOgoJICAgIGNhc2UgJ2xhdGluMSc6CgkgICAgY2FzZSAnYmluYXJ5JzoKCSAgICBjYXNlICdiYXNlNjQnOgoJICAgIGNhc2UgJ3VjczInOgoJICAgIGNhc2UgJ3Vjcy0yJzoKCSAgICBjYXNlICd1dGYxNmxlJzoKCSAgICBjYXNlICd1dGYtMTZsZSc6CgkgICAgICByZXR1cm4gdHJ1ZQoJICAgIGRlZmF1bHQ6CgkgICAgICByZXR1cm4gZmFsc2UKCSAgfQoJfQoKCUJ1ZmZlci5jb25jYXQgPSBmdW5jdGlvbiBjb25jYXQgKGxpc3QsIGxlbmd0aCkgewoJICBpZiAoIWlzQXJyYXkobGlzdCkpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcibGlzdCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJykKCSAgfQoKCSAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7CgkgICAgcmV0dXJuIEJ1ZmZlci5hbGxvYygwKQoJICB9CgoJICB2YXIgaQoJICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIHsKCSAgICBsZW5ndGggPSAwCgkgICAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyArK2kpIHsKCSAgICAgIGxlbmd0aCArPSBsaXN0W2ldLmxlbmd0aAoJICAgIH0KCSAgfQoKCSAgdmFyIGJ1ZmZlciA9IEJ1ZmZlci5hbGxvY1Vuc2FmZShsZW5ndGgpCgkgIHZhciBwb3MgPSAwCgkgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7CgkgICAgdmFyIGJ1ZiA9IGxpc3RbaV0KCSAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB7CgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcibGlzdCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJykKCSAgICB9CgkgICAgYnVmLmNvcHkoYnVmZmVyLCBwb3MpCgkgICAgcG9zICs9IGJ1Zi5sZW5ndGgKCSAgfQoJICByZXR1cm4gYnVmZmVyCgl9CgoJZnVuY3Rpb24gYnl0ZUxlbmd0aCAoc3RyaW5nLCBlbmNvZGluZykgewoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKHN0cmluZykpIHsKCSAgICByZXR1cm4gc3RyaW5nLmxlbmd0aAoJICB9CgkgIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBBcnJheUJ1ZmZlci5pc1ZpZXcgPT09ICdmdW5jdGlvbicgJiYKCSAgICAgIChBcnJheUJ1ZmZlci5pc1ZpZXcoc3RyaW5nKSB8fCBzdHJpbmcgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikpIHsKCSAgICByZXR1cm4gc3RyaW5nLmJ5dGVMZW5ndGgKCSAgfQoJICBpZiAodHlwZW9mIHN0cmluZyAhPT0gJ3N0cmluZycpIHsKCSAgICBzdHJpbmcgPSAnJyArIHN0cmluZwoJICB9CgoJICB2YXIgbGVuID0gc3RyaW5nLmxlbmd0aAoJICBpZiAobGVuID09PSAwKSByZXR1cm4gMAoKCSAgLy8gVXNlIGEgZm9yIGxvb3AgdG8gYXZvaWQgcmVjdXJzaW9uCgkgIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlCgkgIGZvciAoOzspIHsKCSAgICBzd2l0Y2ggKGVuY29kaW5nKSB7CgkgICAgICBjYXNlICdhc2NpaSc6CgkgICAgICBjYXNlICdsYXRpbjEnOgoJICAgICAgY2FzZSAnYmluYXJ5JzoKCSAgICAgICAgcmV0dXJuIGxlbgoJICAgICAgY2FzZSAndXRmOCc6CgkgICAgICBjYXNlICd1dGYtOCc6CgkgICAgICBjYXNlIHVuZGVmaW5lZDoKCSAgICAgICAgcmV0dXJuIHV0ZjhUb0J5dGVzKHN0cmluZykubGVuZ3RoCgkgICAgICBjYXNlICd1Y3MyJzoKCSAgICAgIGNhc2UgJ3Vjcy0yJzoKCSAgICAgIGNhc2UgJ3V0ZjE2bGUnOgoJICAgICAgY2FzZSAndXRmLTE2bGUnOgoJICAgICAgICByZXR1cm4gbGVuICogMgoJICAgICAgY2FzZSAnaGV4JzoKCSAgICAgICAgcmV0dXJuIGxlbiA+Pj4gMQoJICAgICAgY2FzZSAnYmFzZTY0JzoKCSAgICAgICAgcmV0dXJuIGJhc2U2NFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGgKCSAgICAgIGRlZmF1bHQ6CgkgICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgcmV0dXJuIHV0ZjhUb0J5dGVzKHN0cmluZykubGVuZ3RoIC8vIGFzc3VtZSB1dGY4CgkgICAgICAgIGVuY29kaW5nID0gKCcnICsgZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkKCSAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlCgkgICAgfQoJICB9Cgl9CglCdWZmZXIuYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGgKCglmdW5jdGlvbiBzbG93VG9TdHJpbmcgKGVuY29kaW5nLCBzdGFydCwgZW5kKSB7CgkgIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlCgoJICAvLyBObyBuZWVkIHRvIHZlcmlmeSB0aGF0ICJ0aGlzLmxlbmd0aCA8PSBNQVhfVUlOVDMyIiBzaW5jZSBpdCdzIGEgcmVhZC1vbmx5CgkgIC8vIHByb3BlcnR5IG9mIGEgdHlwZWQgYXJyYXkuCgoJICAvLyBUaGlzIGJlaGF2ZXMgbmVpdGhlciBsaWtlIFN0cmluZyBub3IgVWludDhBcnJheSBpbiB0aGF0IHdlIHNldCBzdGFydC9lbmQKCSAgLy8gdG8gdGhlaXIgdXBwZXIvbG93ZXIgYm91bmRzIGlmIHRoZSB2YWx1ZSBwYXNzZWQgaXMgb3V0IG9mIHJhbmdlLgoJICAvLyB1bmRlZmluZWQgaXMgaGFuZGxlZCBzcGVjaWFsbHkgYXMgcGVyIEVDTUEtMjYyIDZ0aCBFZGl0aW9uLAoJICAvLyBTZWN0aW9uIDEzLjMuMy43IFJ1bnRpbWUgU2VtYW50aWNzOiBLZXllZEJpbmRpbmdJbml0aWFsaXphdGlvbi4KCSAgaWYgKHN0YXJ0ID09PSB1bmRlZmluZWQgfHwgc3RhcnQgPCAwKSB7CgkgICAgc3RhcnQgPSAwCgkgIH0KCSAgLy8gUmV0dXJuIGVhcmx5IGlmIHN0YXJ0ID4gdGhpcy5sZW5ndGguIERvbmUgaGVyZSB0byBwcmV2ZW50IHBvdGVudGlhbCB1aW50MzIKCSAgLy8gY29lcmNpb24gZmFpbCBiZWxvdy4KCSAgaWYgKHN0YXJ0ID4gdGhpcy5sZW5ndGgpIHsKCSAgICByZXR1cm4gJycKCSAgfQoKCSAgaWYgKGVuZCA9PT0gdW5kZWZpbmVkIHx8IGVuZCA+IHRoaXMubGVuZ3RoKSB7CgkgICAgZW5kID0gdGhpcy5sZW5ndGgKCSAgfQoKCSAgaWYgKGVuZCA8PSAwKSB7CgkgICAgcmV0dXJuICcnCgkgIH0KCgkgIC8vIEZvcmNlIGNvZXJzaW9uIHRvIHVpbnQzMi4gVGhpcyB3aWxsIGFsc28gY29lcmNlIGZhbHNleS9OYU4gdmFsdWVzIHRvIDAuCgkgIGVuZCA+Pj49IDAKCSAgc3RhcnQgPj4+PSAwCgoJICBpZiAoZW5kIDw9IHN0YXJ0KSB7CgkgICAgcmV0dXJuICcnCgkgIH0KCgkgIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnCgoJICB3aGlsZSAodHJ1ZSkgewoJICAgIHN3aXRjaCAoZW5jb2RpbmcpIHsKCSAgICAgIGNhc2UgJ2hleCc6CgkgICAgICAgIHJldHVybiBoZXhTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGNhc2UgJ3V0ZjgnOgoJICAgICAgY2FzZSAndXRmLTgnOgoJICAgICAgICByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgY2FzZSAnYXNjaWknOgoJICAgICAgICByZXR1cm4gYXNjaWlTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGNhc2UgJ2xhdGluMSc6CgkgICAgICBjYXNlICdiaW5hcnknOgoJICAgICAgICByZXR1cm4gbGF0aW4xU2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICdiYXNlNjQnOgoJICAgICAgICByZXR1cm4gYmFzZTY0U2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICd1Y3MyJzoKCSAgICAgIGNhc2UgJ3Vjcy0yJzoKCSAgICAgIGNhc2UgJ3V0ZjE2bGUnOgoJICAgICAgY2FzZSAndXRmLTE2bGUnOgoJICAgICAgICByZXR1cm4gdXRmMTZsZVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgZGVmYXVsdDoKCSAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpCgkgICAgICAgIGVuY29kaW5nID0gKGVuY29kaW5nICsgJycpLnRvTG93ZXJDYXNlKCkKCSAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlCgkgICAgfQoJICB9Cgl9CgoJLy8gVGhlIHByb3BlcnR5IGlzIHVzZWQgYnkgYEJ1ZmZlci5pc0J1ZmZlcmAgYW5kIGBpcy1idWZmZXJgIChpbiBTYWZhcmkgNS03KSB0byBkZXRlY3QKCS8vIEJ1ZmZlciBpbnN0YW5jZXMuCglCdWZmZXIucHJvdG90eXBlLl9pc0J1ZmZlciA9IHRydWUKCglmdW5jdGlvbiBzd2FwIChiLCBuLCBtKSB7CgkgIHZhciBpID0gYltuXQoJICBiW25dID0gYlttXQoJICBiW21dID0gaQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuc3dhcDE2ID0gZnVuY3Rpb24gc3dhcDE2ICgpIHsKCSAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoCgkgIGlmIChsZW4gJSAyICE9PSAwKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAxNi1iaXRzJykKCSAgfQoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7CgkgICAgc3dhcCh0aGlzLCBpLCBpICsgMSkKCSAgfQoJICByZXR1cm4gdGhpcwoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuc3dhcDMyID0gZnVuY3Rpb24gc3dhcDMyICgpIHsKCSAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoCgkgIGlmIChsZW4gJSA0ICE9PSAwKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAzMi1iaXRzJykKCSAgfQoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSA0KSB7CgkgICAgc3dhcCh0aGlzLCBpLCBpICsgMykKCSAgICBzd2FwKHRoaXMsIGkgKyAxLCBpICsgMikKCSAgfQoJICByZXR1cm4gdGhpcwoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuc3dhcDY0ID0gZnVuY3Rpb24gc3dhcDY0ICgpIHsKCSAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoCgkgIGlmIChsZW4gJSA4ICE9PSAwKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA2NC1iaXRzJykKCSAgfQoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSA4KSB7CgkgICAgc3dhcCh0aGlzLCBpLCBpICsgNykKCSAgICBzd2FwKHRoaXMsIGkgKyAxLCBpICsgNikKCSAgICBzd2FwKHRoaXMsIGkgKyAyLCBpICsgNSkKCSAgICBzd2FwKHRoaXMsIGkgKyAzLCBpICsgNCkKCSAgfQoJICByZXR1cm4gdGhpcwoJfQoKCUJ1ZmZlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZyAoKSB7CgkgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCB8IDAKCSAgaWYgKGxlbmd0aCA9PT0gMCkgcmV0dXJuICcnCgkgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIDAsIGxlbmd0aCkKCSAgcmV0dXJuIHNsb3dUb1N0cmluZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiBlcXVhbHMgKGIpIHsKCSAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYikpIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKQoJICBpZiAodGhpcyA9PT0gYikgcmV0dXJuIHRydWUKCSAgcmV0dXJuIEJ1ZmZlci5jb21wYXJlKHRoaXMsIGIpID09PSAwCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5pbnNwZWN0ID0gZnVuY3Rpb24gaW5zcGVjdCAoKSB7CgkgIHZhciBzdHIgPSAnJwoJICB2YXIgbWF4ID0gZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFUwoJICBpZiAodGhpcy5sZW5ndGggPiAwKSB7CgkgICAgc3RyID0gdGhpcy50b1N0cmluZygnaGV4JywgMCwgbWF4KS5tYXRjaCgvLnsyfS9nKS5qb2luKCcgJykKCSAgICBpZiAodGhpcy5sZW5ndGggPiBtYXgpIHN0ciArPSAnIC4uLiAnCgkgIH0KCSAgcmV0dXJuICc8QnVmZmVyICcgKyBzdHIgKyAnPicKCX0KCglCdWZmZXIucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlICh0YXJnZXQsIHN0YXJ0LCBlbmQsIHRoaXNTdGFydCwgdGhpc0VuZCkgewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcih0YXJnZXQpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpCgkgIH0KCgkgIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgc3RhcnQgPSAwCgkgIH0KCSAgaWYgKGVuZCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgZW5kID0gdGFyZ2V0ID8gdGFyZ2V0Lmxlbmd0aCA6IDAKCSAgfQoJICBpZiAodGhpc1N0YXJ0ID09PSB1bmRlZmluZWQpIHsKCSAgICB0aGlzU3RhcnQgPSAwCgkgIH0KCSAgaWYgKHRoaXNFbmQgPT09IHVuZGVmaW5lZCkgewoJICAgIHRoaXNFbmQgPSB0aGlzLmxlbmd0aAoJICB9CgoJICBpZiAoc3RhcnQgPCAwIHx8IGVuZCA+IHRhcmdldC5sZW5ndGggfHwgdGhpc1N0YXJ0IDwgMCB8fCB0aGlzRW5kID4gdGhpcy5sZW5ndGgpIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignb3V0IG9mIHJhbmdlIGluZGV4JykKCSAgfQoKCSAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kICYmIHN0YXJ0ID49IGVuZCkgewoJICAgIHJldHVybiAwCgkgIH0KCSAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kKSB7CgkgICAgcmV0dXJuIC0xCgkgIH0KCSAgaWYgKHN0YXJ0ID49IGVuZCkgewoJICAgIHJldHVybiAxCgkgIH0KCgkgIHN0YXJ0ID4+Pj0gMAoJICBlbmQgPj4+PSAwCgkgIHRoaXNTdGFydCA+Pj49IDAKCSAgdGhpc0VuZCA+Pj49IDAKCgkgIGlmICh0aGlzID09PSB0YXJnZXQpIHJldHVybiAwCgoJICB2YXIgeCA9IHRoaXNFbmQgLSB0aGlzU3RhcnQKCSAgdmFyIHkgPSBlbmQgLSBzdGFydAoJICB2YXIgbGVuID0gTWF0aC5taW4oeCwgeSkKCgkgIHZhciB0aGlzQ29weSA9IHRoaXMuc2xpY2UodGhpc1N0YXJ0LCB0aGlzRW5kKQoJICB2YXIgdGFyZ2V0Q29weSA9IHRhcmdldC5zbGljZShzdGFydCwgZW5kKQoKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkgewoJICAgIGlmICh0aGlzQ29weVtpXSAhPT0gdGFyZ2V0Q29weVtpXSkgewoJICAgICAgeCA9IHRoaXNDb3B5W2ldCgkgICAgICB5ID0gdGFyZ2V0Q29weVtpXQoJICAgICAgYnJlYWsKCSAgICB9CgkgIH0KCgkgIGlmICh4IDwgeSkgcmV0dXJuIC0xCgkgIGlmICh5IDwgeCkgcmV0dXJuIDEKCSAgcmV0dXJuIDAKCX0KCgkvLyBGaW5kcyBlaXRoZXIgdGhlIGZpcnN0IGluZGV4IG9mIGB2YWxgIGluIGBidWZmZXJgIGF0IG9mZnNldCA+PSBgYnl0ZU9mZnNldGAsCgkvLyBPUiB0aGUgbGFzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPD0gYGJ5dGVPZmZzZXRgLgoJLy8KCS8vIEFyZ3VtZW50czoKCS8vIC0gYnVmZmVyIC0gYSBCdWZmZXIgdG8gc2VhcmNoCgkvLyAtIHZhbCAtIGEgc3RyaW5nLCBCdWZmZXIsIG9yIG51bWJlcgoJLy8gLSBieXRlT2Zmc2V0IC0gYW4gaW5kZXggaW50byBgYnVmZmVyYDsgd2lsbCBiZSBjbGFtcGVkIHRvIGFuIGludDMyCgkvLyAtIGVuY29kaW5nIC0gYW4gb3B0aW9uYWwgZW5jb2RpbmcsIHJlbGV2YW50IGlzIHZhbCBpcyBhIHN0cmluZwoJLy8gLSBkaXIgLSB0cnVlIGZvciBpbmRleE9mLCBmYWxzZSBmb3IgbGFzdEluZGV4T2YKCWZ1bmN0aW9uIGJpZGlyZWN0aW9uYWxJbmRleE9mIChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikgewoJICAvLyBFbXB0eSBidWZmZXIgbWVhbnMgbm8gbWF0Y2gKCSAgaWYgKGJ1ZmZlci5sZW5ndGggPT09IDApIHJldHVybiAtMQoKCSAgLy8gTm9ybWFsaXplIGJ5dGVPZmZzZXQKCSAgaWYgKHR5cGVvZiBieXRlT2Zmc2V0ID09PSAnc3RyaW5nJykgewoJICAgIGVuY29kaW5nID0gYnl0ZU9mZnNldAoJICAgIGJ5dGVPZmZzZXQgPSAwCgkgIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA+IDB4N2ZmZmZmZmYpIHsKCSAgICBieXRlT2Zmc2V0ID0gMHg3ZmZmZmZmZgoJICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAtMHg4MDAwMDAwMCkgewoJICAgIGJ5dGVPZmZzZXQgPSAtMHg4MDAwMDAwMAoJICB9CgkgIGJ5dGVPZmZzZXQgPSArYnl0ZU9mZnNldCAgLy8gQ29lcmNlIHRvIE51bWJlci4KCSAgaWYgKGlzTmFOKGJ5dGVPZmZzZXQpKSB7CgkgICAgLy8gYnl0ZU9mZnNldDogaXQgaXQncyB1bmRlZmluZWQsIG51bGwsIE5hTiwgImZvbyIsIGV0Yywgc2VhcmNoIHdob2xlIGJ1ZmZlcgoJICAgIGJ5dGVPZmZzZXQgPSBkaXIgPyAwIDogKGJ1ZmZlci5sZW5ndGggLSAxKQoJICB9CgoJICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldDogbmVnYXRpdmUgb2Zmc2V0cyBzdGFydCBmcm9tIHRoZSBlbmQgb2YgdGhlIGJ1ZmZlcgoJICBpZiAoYnl0ZU9mZnNldCA8IDApIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoICsgYnl0ZU9mZnNldAoJICBpZiAoYnl0ZU9mZnNldCA+PSBidWZmZXIubGVuZ3RoKSB7CgkgICAgaWYgKGRpcikgcmV0dXJuIC0xCgkgICAgZWxzZSBieXRlT2Zmc2V0ID0gYnVmZmVyLmxlbmd0aCAtIDEKCSAgfSBlbHNlIGlmIChieXRlT2Zmc2V0IDwgMCkgewoJICAgIGlmIChkaXIpIGJ5dGVPZmZzZXQgPSAwCgkgICAgZWxzZSByZXR1cm4gLTEKCSAgfQoKCSAgLy8gTm9ybWFsaXplIHZhbAoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHsKCSAgICB2YWwgPSBCdWZmZXIuZnJvbSh2YWwsIGVuY29kaW5nKQoJICB9CgoJICAvLyBGaW5hbGx5LCBzZWFyY2ggZWl0aGVyIGluZGV4T2YgKGlmIGRpciBpcyB0cnVlKSBvciBsYXN0SW5kZXhPZgoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKHZhbCkpIHsKCSAgICAvLyBTcGVjaWFsIGNhc2U6IGxvb2tpbmcgZm9yIGVtcHR5IHN0cmluZy9idWZmZXIgYWx3YXlzIGZhaWxzCgkgICAgaWYgKHZhbC5sZW5ndGggPT09IDApIHsKCSAgICAgIHJldHVybiAtMQoJICAgIH0KCSAgICByZXR1cm4gYXJyYXlJbmRleE9mKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKQoJICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7CgkgICAgdmFsID0gdmFsICYgMHhGRiAvLyBTZWFyY2ggZm9yIGEgYnl0ZSB2YWx1ZSBbMC0yNTVdCgkgICAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmCgkgICAgICAgIHR5cGVvZiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICBpZiAoZGlyKSB7CgkgICAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpCgkgICAgICB9IGVsc2UgewoJICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUubGFzdEluZGV4T2YuY2FsbChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCkKCSAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIFsgdmFsIF0sIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpCgkgIH0KCgkgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ZhbCBtdXN0IGJlIHN0cmluZywgbnVtYmVyIG9yIEJ1ZmZlcicpCgl9CgoJZnVuY3Rpb24gYXJyYXlJbmRleE9mIChhcnIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikgewoJICB2YXIgaW5kZXhTaXplID0gMQoJICB2YXIgYXJyTGVuZ3RoID0gYXJyLmxlbmd0aAoJICB2YXIgdmFsTGVuZ3RoID0gdmFsLmxlbmd0aAoKCSAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQpIHsKCSAgICBlbmNvZGluZyA9IFN0cmluZyhlbmNvZGluZykudG9Mb3dlckNhc2UoKQoJICAgIGlmIChlbmNvZGluZyA9PT0gJ3VjczInIHx8IGVuY29kaW5nID09PSAndWNzLTInIHx8CgkgICAgICAgIGVuY29kaW5nID09PSAndXRmMTZsZScgfHwgZW5jb2RpbmcgPT09ICd1dGYtMTZsZScpIHsKCSAgICAgIGlmIChhcnIubGVuZ3RoIDwgMiB8fCB2YWwubGVuZ3RoIDwgMikgewoJICAgICAgICByZXR1cm4gLTEKCSAgICAgIH0KCSAgICAgIGluZGV4U2l6ZSA9IDIKCSAgICAgIGFyckxlbmd0aCAvPSAyCgkgICAgICB2YWxMZW5ndGggLz0gMgoJICAgICAgYnl0ZU9mZnNldCAvPSAyCgkgICAgfQoJICB9CgoJICBmdW5jdGlvbiByZWFkIChidWYsIGkpIHsKCSAgICBpZiAoaW5kZXhTaXplID09PSAxKSB7CgkgICAgICByZXR1cm4gYnVmW2ldCgkgICAgfSBlbHNlIHsKCSAgICAgIHJldHVybiBidWYucmVhZFVJbnQxNkJFKGkgKiBpbmRleFNpemUpCgkgICAgfQoJICB9CgoJICB2YXIgaQoJICBpZiAoZGlyKSB7CgkgICAgdmFyIGZvdW5kSW5kZXggPSAtMQoJICAgIGZvciAoaSA9IGJ5dGVPZmZzZXQ7IGkgPCBhcnJMZW5ndGg7IGkrKykgewoJICAgICAgaWYgKHJlYWQoYXJyLCBpKSA9PT0gcmVhZCh2YWwsIGZvdW5kSW5kZXggPT09IC0xID8gMCA6IGkgLSBmb3VuZEluZGV4KSkgewoJICAgICAgICBpZiAoZm91bmRJbmRleCA9PT0gLTEpIGZvdW5kSW5kZXggPSBpCgkgICAgICAgIGlmIChpIC0gZm91bmRJbmRleCArIDEgPT09IHZhbExlbmd0aCkgcmV0dXJuIGZvdW5kSW5kZXggKiBpbmRleFNpemUKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGlmIChmb3VuZEluZGV4ICE9PSAtMSkgaSAtPSBpIC0gZm91bmRJbmRleAoJICAgICAgICBmb3VuZEluZGV4ID0gLTEKCSAgICAgIH0KCSAgICB9CgkgIH0gZWxzZSB7CgkgICAgaWYgKGJ5dGVPZmZzZXQgKyB2YWxMZW5ndGggPiBhcnJMZW5ndGgpIGJ5dGVPZmZzZXQgPSBhcnJMZW5ndGggLSB2YWxMZW5ndGgKCSAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpID49IDA7IGktLSkgewoJICAgICAgdmFyIGZvdW5kID0gdHJ1ZQoJICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB2YWxMZW5ndGg7IGorKykgewoJICAgICAgICBpZiAocmVhZChhcnIsIGkgKyBqKSAhPT0gcmVhZCh2YWwsIGopKSB7CgkgICAgICAgICAgZm91bmQgPSBmYWxzZQoJICAgICAgICAgIGJyZWFrCgkgICAgICAgIH0KCSAgICAgIH0KCSAgICAgIGlmIChmb3VuZCkgcmV0dXJuIGkKCSAgICB9CgkgIH0KCgkgIHJldHVybiAtMQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuaW5jbHVkZXMgPSBmdW5jdGlvbiBpbmNsdWRlcyAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgewoJICByZXR1cm4gdGhpcy5pbmRleE9mKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpICE9PSAtMQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHsKCSAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIHRydWUpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5sYXN0SW5kZXhPZiA9IGZ1bmN0aW9uIGxhc3RJbmRleE9mICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7CgkgIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBmYWxzZSkKCX0KCglmdW5jdGlvbiBoZXhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIG9mZnNldCA9IE51bWJlcihvZmZzZXQpIHx8IDAKCSAgdmFyIHJlbWFpbmluZyA9IGJ1Zi5sZW5ndGggLSBvZmZzZXQKCSAgaWYgKCFsZW5ndGgpIHsKCSAgICBsZW5ndGggPSByZW1haW5pbmcKCSAgfSBlbHNlIHsKCSAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKQoJICAgIGlmIChsZW5ndGggPiByZW1haW5pbmcpIHsKCSAgICAgIGxlbmd0aCA9IHJlbWFpbmluZwoJICAgIH0KCSAgfQoKCSAgLy8gbXVzdCBiZSBhbiBldmVuIG51bWJlciBvZiBkaWdpdHMKCSAgdmFyIHN0ckxlbiA9IHN0cmluZy5sZW5ndGgKCSAgaWYgKHN0ckxlbiAlIDIgIT09IDApIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpCgoJICBpZiAobGVuZ3RoID4gc3RyTGVuIC8gMikgewoJICAgIGxlbmd0aCA9IHN0ckxlbiAvIDIKCSAgfQoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CgkgICAgdmFyIHBhcnNlZCA9IHBhcnNlSW50KHN0cmluZy5zdWJzdHIoaSAqIDIsIDIpLCAxNikKCSAgICBpZiAoaXNOYU4ocGFyc2VkKSkgcmV0dXJuIGkKCSAgICBidWZbb2Zmc2V0ICsgaV0gPSBwYXJzZWQKCSAgfQoJICByZXR1cm4gaQoJfQoKCWZ1bmN0aW9uIHV0ZjhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKHV0ZjhUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpCgl9CgoJZnVuY3Rpb24gYXNjaWlXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKGFzY2lpVG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIGxhdGluMVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHsKCSAgcmV0dXJuIGFzY2lpV3JpdGUoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIGJhc2U2NFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHsKCSAgcmV0dXJuIGJsaXRCdWZmZXIoYmFzZTY0VG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIHVjczJXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKHV0ZjE2bGVUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIHdyaXRlIChzdHJpbmcsIG9mZnNldCwgbGVuZ3RoLCBlbmNvZGluZykgewoJICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nKQoJICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIHsKCSAgICBlbmNvZGluZyA9ICd1dGY4JwoJICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoCgkgICAgb2Zmc2V0ID0gMAoJICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBlbmNvZGluZykKCSAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygb2Zmc2V0ID09PSAnc3RyaW5nJykgewoJICAgIGVuY29kaW5nID0gb2Zmc2V0CgkgICAgbGVuZ3RoID0gdGhpcy5sZW5ndGgKCSAgICBvZmZzZXQgPSAwCgkgIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcsIG9mZnNldFssIGxlbmd0aF1bLCBlbmNvZGluZ10pCgkgIH0gZWxzZSBpZiAoaXNGaW5pdGUob2Zmc2V0KSkgewoJICAgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgICBpZiAoaXNGaW5pdGUobGVuZ3RoKSkgewoJICAgICAgbGVuZ3RoID0gbGVuZ3RoIHwgMAoJICAgICAgaWYgKGVuY29kaW5nID09PSB1bmRlZmluZWQpIGVuY29kaW5nID0gJ3V0ZjgnCgkgICAgfSBlbHNlIHsKCSAgICAgIGVuY29kaW5nID0gbGVuZ3RoCgkgICAgICBsZW5ndGggPSB1bmRlZmluZWQKCSAgICB9CgkgIC8vIGxlZ2FjeSB3cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXQsIGxlbmd0aCkgLSByZW1vdmUgaW4gdjAuMTMKCSAgfSBlbHNlIHsKCSAgICB0aHJvdyBuZXcgRXJyb3IoCgkgICAgICAnQnVmZmVyLndyaXRlKHN0cmluZywgZW5jb2RpbmcsIG9mZnNldFssIGxlbmd0aF0pIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQnCgkgICAgKQoJICB9CgoJICB2YXIgcmVtYWluaW5nID0gdGhpcy5sZW5ndGggLSBvZmZzZXQKCSAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkIHx8IGxlbmd0aCA+IHJlbWFpbmluZykgbGVuZ3RoID0gcmVtYWluaW5nCgoJICBpZiAoKHN0cmluZy5sZW5ndGggPiAwICYmIChsZW5ndGggPCAwIHx8IG9mZnNldCA8IDApKSB8fCBvZmZzZXQgPiB0aGlzLmxlbmd0aCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIHdyaXRlIG91dHNpZGUgYnVmZmVyIGJvdW5kcycpCgkgIH0KCgkgIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnCgoJICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZQoJICBmb3IgKDs7KSB7CgkgICAgc3dpdGNoIChlbmNvZGluZykgewoJICAgICAgY2FzZSAnaGV4JzoKCSAgICAgICAgcmV0dXJuIGhleFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgY2FzZSAndXRmOCc6CgkgICAgICBjYXNlICd1dGYtOCc6CgkgICAgICAgIHJldHVybiB1dGY4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBjYXNlICdhc2NpaSc6CgkgICAgICAgIHJldHVybiBhc2NpaVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgY2FzZSAnbGF0aW4xJzoKCSAgICAgIGNhc2UgJ2JpbmFyeSc6CgkgICAgICAgIHJldHVybiBsYXRpbjFXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGNhc2UgJ2Jhc2U2NCc6CgkgICAgICAgIC8vIFdhcm5pbmc6IG1heExlbmd0aCBub3QgdGFrZW4gaW50byBhY2NvdW50IGluIGJhc2U2NFdyaXRlCgkgICAgICAgIHJldHVybiBiYXNlNjRXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGNhc2UgJ3VjczInOgoJICAgICAgY2FzZSAndWNzLTInOgoJICAgICAgY2FzZSAndXRmMTZsZSc6CgkgICAgICBjYXNlICd1dGYtMTZsZSc6CgkgICAgICAgIHJldHVybiB1Y3MyV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBkZWZhdWx0OgoJICAgICAgICBpZiAobG93ZXJlZENhc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZykKCSAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKQoJICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWUKCSAgICB9CgkgIH0KCX0KCglCdWZmZXIucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIHRvSlNPTiAoKSB7CgkgIHJldHVybiB7CgkgICAgdHlwZTogJ0J1ZmZlcicsCgkgICAgZGF0YTogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5fYXJyIHx8IHRoaXMsIDApCgkgIH0KCX0KCglmdW5jdGlvbiBiYXNlNjRTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIGlmIChzdGFydCA9PT0gMCAmJiBlbmQgPT09IGJ1Zi5sZW5ndGgpIHsKCSAgICByZXR1cm4gYmFzZTY0LmZyb21CeXRlQXJyYXkoYnVmKQoJICB9IGVsc2UgewoJICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYuc2xpY2Uoc3RhcnQsIGVuZCkpCgkgIH0KCX0KCglmdW5jdGlvbiB1dGY4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpCgkgIHZhciByZXMgPSBbXQoKCSAgdmFyIGkgPSBzdGFydAoJICB3aGlsZSAoaSA8IGVuZCkgewoJICAgIHZhciBmaXJzdEJ5dGUgPSBidWZbaV0KCSAgICB2YXIgY29kZVBvaW50ID0gbnVsbAoJICAgIHZhciBieXRlc1BlclNlcXVlbmNlID0gKGZpcnN0Qnl0ZSA+IDB4RUYpID8gNAoJICAgICAgOiAoZmlyc3RCeXRlID4gMHhERikgPyAzCgkgICAgICA6IChmaXJzdEJ5dGUgPiAweEJGKSA/IDIKCSAgICAgIDogMQoKCSAgICBpZiAoaSArIGJ5dGVzUGVyU2VxdWVuY2UgPD0gZW5kKSB7CgkgICAgICB2YXIgc2Vjb25kQnl0ZSwgdGhpcmRCeXRlLCBmb3VydGhCeXRlLCB0ZW1wQ29kZVBvaW50CgoJICAgICAgc3dpdGNoIChieXRlc1BlclNlcXVlbmNlKSB7CgkgICAgICAgIGNhc2UgMToKCSAgICAgICAgICBpZiAoZmlyc3RCeXRlIDwgMHg4MCkgewoJICAgICAgICAgICAgY29kZVBvaW50ID0gZmlyc3RCeXRlCgkgICAgICAgICAgfQoJICAgICAgICAgIGJyZWFrCgkgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXQoJICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4MUYpIDw8IDB4NiB8IChzZWNvbmRCeXRlICYgMHgzRikKCSAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3RikgewoJICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfQoJICAgICAgICAgIGJyZWFrCgkgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXQoJICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl0KCSAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAodGhpcmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHsKCSAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweEMgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpIDw8IDB4NiB8ICh0aGlyZEJ5dGUgJiAweDNGKQoJICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGRiAmJiAodGVtcENvZGVQb2ludCA8IDB4RDgwMCB8fCB0ZW1wQ29kZVBvaW50ID4gMHhERkZGKSkgewoJICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfQoJICAgICAgICAgIGJyZWFrCgkgICAgICAgIGNhc2UgNDoKCSAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXQoJICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl0KCSAgICAgICAgICBmb3VydGhCeXRlID0gYnVmW2kgKyAzXQoJICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAoZm91cnRoQnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHgxMiB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHhDIHwgKHRoaXJkQnl0ZSAmIDB4M0YpIDw8IDB4NiB8IChmb3VydGhCeXRlICYgMHgzRikKCSAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHhGRkZGICYmIHRlbXBDb2RlUG9pbnQgPCAweDExMDAwMCkgewoJICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfQoJICAgICAgfQoJICAgIH0KCgkgICAgaWYgKGNvZGVQb2ludCA9PT0gbnVsbCkgewoJICAgICAgLy8gd2UgZGlkIG5vdCBnZW5lcmF0ZSBhIHZhbGlkIGNvZGVQb2ludCBzbyBpbnNlcnQgYQoJICAgICAgLy8gcmVwbGFjZW1lbnQgY2hhciAoVStGRkZEKSBhbmQgYWR2YW5jZSBvbmx5IDEgYnl0ZQoJICAgICAgY29kZVBvaW50ID0gMHhGRkZECgkgICAgICBieXRlc1BlclNlcXVlbmNlID0gMQoJICAgIH0gZWxzZSBpZiAoY29kZVBvaW50ID4gMHhGRkZGKSB7CgkgICAgICAvLyBlbmNvZGUgdG8gdXRmMTYgKHN1cnJvZ2F0ZSBwYWlyIGRhbmNlKQoJICAgICAgY29kZVBvaW50IC09IDB4MTAwMDAKCSAgICAgIHJlcy5wdXNoKGNvZGVQb2ludCA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMCkKCSAgICAgIGNvZGVQb2ludCA9IDB4REMwMCB8IGNvZGVQb2ludCAmIDB4M0ZGCgkgICAgfQoKCSAgICByZXMucHVzaChjb2RlUG9pbnQpCgkgICAgaSArPSBieXRlc1BlclNlcXVlbmNlCgkgIH0KCgkgIHJldHVybiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkocmVzKQoJfQoKCS8vIEJhc2VkIG9uIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIyNzQ3MjcyLzY4MDc0MiwgdGhlIGJyb3dzZXIgd2l0aAoJLy8gdGhlIGxvd2VzdCBsaW1pdCBpcyBDaHJvbWUsIHdpdGggMHgxMDAwMCBhcmdzLgoJLy8gV2UgZ28gMSBtYWduaXR1ZGUgbGVzcywgZm9yIHNhZmV0eQoJdmFyIE1BWF9BUkdVTUVOVFNfTEVOR1RIID0gMHgxMDAwCgoJZnVuY3Rpb24gZGVjb2RlQ29kZVBvaW50c0FycmF5IChjb2RlUG9pbnRzKSB7CgkgIHZhciBsZW4gPSBjb2RlUG9pbnRzLmxlbmd0aAoJICBpZiAobGVuIDw9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKSB7CgkgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLCBjb2RlUG9pbnRzKSAvLyBhdm9pZCBleHRyYSBzbGljZSgpCgkgIH0KCgkgIC8vIERlY29kZSBpbiBjaHVua3MgdG8gYXZvaWQgImNhbGwgc3RhY2sgc2l6ZSBleGNlZWRlZCIuCgkgIHZhciByZXMgPSAnJwoJICB2YXIgaSA9IDAKCSAgd2hpbGUgKGkgPCBsZW4pIHsKCSAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseSgKCSAgICAgIFN0cmluZywKCSAgICAgIGNvZGVQb2ludHMuc2xpY2UoaSwgaSArPSBNQVhfQVJHVU1FTlRTX0xFTkdUSCkKCSAgICApCgkgIH0KCSAgcmV0dXJuIHJlcwoJfQoKCWZ1bmN0aW9uIGFzY2lpU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICB2YXIgcmV0ID0gJycKCSAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKQoKCSAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHsKCSAgICByZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZbaV0gJiAweDdGKQoJICB9CgkgIHJldHVybiByZXQKCX0KCglmdW5jdGlvbiBsYXRpbjFTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIHZhciByZXQgPSAnJwoJICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpCgoJICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkgewoJICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSkKCSAgfQoJICByZXR1cm4gcmV0Cgl9CgoJZnVuY3Rpb24gaGV4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICB2YXIgbGVuID0gYnVmLmxlbmd0aAoKCSAgaWYgKCFzdGFydCB8fCBzdGFydCA8IDApIHN0YXJ0ID0gMAoJICBpZiAoIWVuZCB8fCBlbmQgPCAwIHx8IGVuZCA+IGxlbikgZW5kID0gbGVuCgoJICB2YXIgb3V0ID0gJycKCSAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHsKCSAgICBvdXQgKz0gdG9IZXgoYnVmW2ldKQoJICB9CgkgIHJldHVybiBvdXQKCX0KCglmdW5jdGlvbiB1dGYxNmxlU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICB2YXIgYnl0ZXMgPSBidWYuc2xpY2Uoc3RhcnQsIGVuZCkKCSAgdmFyIHJlcyA9ICcnCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpICs9IDIpIHsKCSAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1tpXSArIGJ5dGVzW2kgKyAxXSAqIDI1NikKCSAgfQoJICByZXR1cm4gcmVzCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5zbGljZSA9IGZ1bmN0aW9uIHNsaWNlIChzdGFydCwgZW5kKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBzdGFydCA9IH5+c3RhcnQKCSAgZW5kID0gZW5kID09PSB1bmRlZmluZWQgPyBsZW4gOiB+fmVuZAoKCSAgaWYgKHN0YXJ0IDwgMCkgewoJICAgIHN0YXJ0ICs9IGxlbgoJICAgIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMAoJICB9IGVsc2UgaWYgKHN0YXJ0ID4gbGVuKSB7CgkgICAgc3RhcnQgPSBsZW4KCSAgfQoKCSAgaWYgKGVuZCA8IDApIHsKCSAgICBlbmQgKz0gbGVuCgkgICAgaWYgKGVuZCA8IDApIGVuZCA9IDAKCSAgfSBlbHNlIGlmIChlbmQgPiBsZW4pIHsKCSAgICBlbmQgPSBsZW4KCSAgfQoKCSAgaWYgKGVuZCA8IHN0YXJ0KSBlbmQgPSBzdGFydAoKCSAgdmFyIG5ld0J1ZgoJICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgICBuZXdCdWYgPSB0aGlzLnN1YmFycmF5KHN0YXJ0LCBlbmQpCgkgICAgbmV3QnVmLl9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGUKCSAgfSBlbHNlIHsKCSAgICB2YXIgc2xpY2VMZW4gPSBlbmQgLSBzdGFydAoJICAgIG5ld0J1ZiA9IG5ldyBCdWZmZXIoc2xpY2VMZW4sIHVuZGVmaW5lZCkKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNsaWNlTGVuOyArK2kpIHsKCSAgICAgIG5ld0J1ZltpXSA9IHRoaXNbaSArIHN0YXJ0XQoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIG5ld0J1ZgoJfQoKCS8qCgkgKiBOZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IGJ1ZmZlciBpc24ndCB0cnlpbmcgdG8gd3JpdGUgb3V0IG9mIGJvdW5kcy4KCSAqLwoJZnVuY3Rpb24gY2hlY2tPZmZzZXQgKG9mZnNldCwgZXh0LCBsZW5ndGgpIHsKCSAgaWYgKChvZmZzZXQgJSAxKSAhPT0gMCB8fCBvZmZzZXQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignb2Zmc2V0IGlzIG5vdCB1aW50JykKCSAgaWYgKG9mZnNldCArIGV4dCA+IGxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RyeWluZyB0byBhY2Nlc3MgYmV5b25kIGJ1ZmZlciBsZW5ndGgnKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRMRSA9IGZ1bmN0aW9uIHJlYWRVSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCkKCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldF0KCSAgdmFyIG11bCA9IDEKCSAgdmFyIGkgPSAwCgkgIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWwKCSAgfQoKCSAgcmV0dXJuIHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRCRSA9IGZ1bmN0aW9uIHJlYWRVSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpCgkgIH0KCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0KCSAgdmFyIG11bCA9IDEKCSAgd2hpbGUgKGJ5dGVMZW5ndGggPiAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXSAqIG11bAoJICB9CgoJICByZXR1cm4gdmFsCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiByZWFkVUludDggKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aCkKCSAgcmV0dXJuIHRoaXNbb2Zmc2V0XQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkxFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiB0aGlzW29mZnNldF0gfCAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkJFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDgpIHwgdGhpc1tvZmZzZXQgKyAxXQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgoJICByZXR1cm4gKCh0aGlzW29mZnNldF0pIHwKCSAgICAgICh0aGlzW29mZnNldCArIDFdIDw8IDgpIHwKCSAgICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSkgKwoJICAgICAgKHRoaXNbb2Zmc2V0ICsgM10gKiAweDEwMDAwMDApCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDMyQkUgPSBmdW5jdGlvbiByZWFkVUludDMyQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aCkKCgkgIHJldHVybiAodGhpc1tvZmZzZXRdICogMHgxMDAwMDAwKSArCgkgICAgKCh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfAoJICAgIHRoaXNbb2Zmc2V0ICsgM10pCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50TEUgPSBmdW5jdGlvbiByZWFkSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCkKCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldF0KCSAgdmFyIG11bCA9IDEKCSAgdmFyIGkgPSAwCgkgIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWwKCSAgfQoJICBtdWwgKj0gMHg4MAoKCSAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkKCgkgIHJldHVybiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnRCRSA9IGZ1bmN0aW9uIHJlYWRJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKQoKCSAgdmFyIGkgPSBieXRlTGVuZ3RoCgkgIHZhciBtdWwgPSAxCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0taV0KCSAgd2hpbGUgKGkgPiAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1pXSAqIG11bAoJICB9CgkgIG11bCAqPSAweDgwCgoJICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKQoKCSAgcmV0dXJuIHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDggPSBmdW5jdGlvbiByZWFkSW50OCAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKQoJICBpZiAoISh0aGlzW29mZnNldF0gJiAweDgwKSkgcmV0dXJuICh0aGlzW29mZnNldF0pCgkgIHJldHVybiAoKDB4ZmYgLSB0aGlzW29mZnNldF0gKyAxKSAqIC0xKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2TEUgPSBmdW5jdGlvbiByZWFkSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKQoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkKCSAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2QkUgPSBmdW5jdGlvbiByZWFkSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKQoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAxXSB8ICh0aGlzW29mZnNldF0gPDwgOCkKCSAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyTEUgPSBmdW5jdGlvbiByZWFkSW50MzJMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoKCSAgcmV0dXJuICh0aGlzW29mZnNldF0pIHwKCSAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgMTYpIHwKCSAgICAodGhpc1tvZmZzZXQgKyAzXSA8PCAyNCkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkJFID0gZnVuY3Rpb24gcmVhZEludDMyQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aCkKCgkgIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDI0KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHwKCSAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgM10pCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRMRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdExFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCAyMywgNCkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRGbG9hdEJFID0gZnVuY3Rpb24gcmVhZEZsb2F0QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aCkKCSAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIGZhbHNlLCAyMywgNCkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVMRSA9IGZ1bmN0aW9uIHJlYWREb3VibGVMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDgsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgNTIsIDgpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlQkUgPSBmdW5jdGlvbiByZWFkRG91YmxlQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aCkKCSAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIGZhbHNlLCA1MiwgOCkKCX0KCglmdW5jdGlvbiBjaGVja0ludCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBleHQsIG1heCwgbWluKSB7CgkgIGlmICghQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHRocm93IG5ldyBUeXBlRXJyb3IoJyJidWZmZXIiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKQoJICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHRocm93IG5ldyBSYW5nZUVycm9yKCcidmFsdWUiIGFyZ3VtZW50IGlzIG91dCBvZiBib3VuZHMnKQoJICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlVUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMQoJICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKQoJICB9CgoJICB2YXIgbXVsID0gMQoJICB2YXIgaSA9IDAKCSAgdGhpc1tvZmZzZXRdID0gdmFsdWUgJiAweEZGCgkgIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGCgkgIH0KCgkgIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlVUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMQoJICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKQoJICB9CgoJICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxCgkgIHZhciBtdWwgPSAxCgkgIHRoaXNbb2Zmc2V0ICsgaV0gPSB2YWx1ZSAmIDB4RkYKCSAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGCgkgIH0KCgkgIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVVSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweGZmLCAwKQoJICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpCgkgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgIHJldHVybiBvZmZzZXQgKyAxCgl9CgoJZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MTYgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7CgkgIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmICsgdmFsdWUgKyAxCgkgIGZvciAodmFyIGkgPSAwLCBqID0gTWF0aC5taW4oYnVmLmxlbmd0aCAtIG9mZnNldCwgMik7IGkgPCBqOyArK2kpIHsKCSAgICBidWZbb2Zmc2V0ICsgaV0gPSAodmFsdWUgJiAoMHhmZiA8PCAoOCAqIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpKSkpID4+PgoJICAgICAgKGxpdHRsZUVuZGlhbiA/IGkgOiAxIC0gaSkgKiA4CgkgIH0KCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpCgkgIH0KCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KQoJICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKQoJICB9CgkgIHJldHVybiBvZmZzZXQgKyAyCgl9CgoJZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MzIgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7CgkgIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMQoJICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDQpOyBpIDwgajsgKytpKSB7CgkgICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlID4+PiAobGl0dGxlRW5kaWFuID8gaSA6IDMgLSBpKSAqIDgpICYgMHhmZgoJICB9Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKQoJICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlID4+PiAyNCkKCSAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiAxNikKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KQoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgIH0gZWxzZSB7CgkgICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgNAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiAyNCkKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiAxNikKCSAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KQoJICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgJiAweGZmKQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKQoJICB9CgkgIHJldHVybiBvZmZzZXQgKyA0Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUludExFID0gZnVuY3Rpb24gd3JpdGVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgdmFyIGxpbWl0ID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGggLSAxKQoKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdCkKCSAgfQoKCSAgdmFyIGkgPSAwCgkgIHZhciBtdWwgPSAxCgkgIHZhciBzdWIgPSAwCgkgIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRgoJICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSAtIDFdICE9PSAwKSB7CgkgICAgICBzdWIgPSAxCgkgICAgfQoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50QkUgPSBmdW5jdGlvbiB3cml0ZUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICB2YXIgbGltaXQgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCAtIDEpCgoJICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KQoJICB9CgoJICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxCgkgIHZhciBtdWwgPSAxCgkgIHZhciBzdWIgPSAwCgkgIHRoaXNbb2Zmc2V0ICsgaV0gPSB2YWx1ZSAmIDB4RkYKCSAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgaWYgKHZhbHVlIDwgMCAmJiBzdWIgPT09IDAgJiYgdGhpc1tvZmZzZXQgKyBpICsgMV0gIT09IDApIHsKCSAgICAgIHN1YiA9IDEKCSAgICB9CgkgICAgdGhpc1tvZmZzZXQgKyBpXSA9ICgodmFsdWUgLyBtdWwpID4+IDApIC0gc3ViICYgMHhGRgoJICB9CgoJICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVJbnQ4ICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4N2YsIC0weDgwKQoJICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpCgkgIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZiArIHZhbHVlICsgMQoJICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKQoJICByZXR1cm4gb2Zmc2V0ICsgMQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVJbnQxNkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpCgkgIH0KCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOCkKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZikKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgMgoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKQoJICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKQoJICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpCgkgICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpCgkgICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpCgkgIH0gZWxzZSB7CgkgICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgNAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkJFID0gZnVuY3Rpb24gd3JpdGVJbnQzMkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKQoJICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZmZmZmYgKyB2YWx1ZSArIDEKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiAyNCkKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiAxNikKCSAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KQoJICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgJiAweGZmKQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKQoJICB9CgkgIHJldHVybiBvZmZzZXQgKyA0Cgl9CgoJZnVuY3Rpb24gY2hlY2tJRUVFNzU0IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHsKCSAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKQoJICBpZiAob2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpCgl9CgoJZnVuY3Rpb24gd3JpdGVGbG9hdCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA0LCAzLjQwMjgyMzQ2NjM4NTI4ODZlKzM4LCAtMy40MDI4MjM0NjYzODUyODg2ZSszOCkKCSAgfQoJICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCAyMywgNCkKCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRMRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0QkUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydCkKCX0KCglmdW5jdGlvbiB3cml0ZURvdWJsZSAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA4LCAxLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCwgLTEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4KQoJICB9CgkgIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDUyLCA4KQoJICByZXR1cm4gb2Zmc2V0ICsgOAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVMRSA9IGZ1bmN0aW9uIHdyaXRlRG91YmxlTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlLCBub0Fzc2VydCkKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlQkUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KQoJfQoKCS8vIGNvcHkodGFyZ2V0QnVmZmVyLCB0YXJnZXRTdGFydD0wLCBzb3VyY2VTdGFydD0wLCBzb3VyY2VFbmQ9YnVmZmVyLmxlbmd0aCkKCUJ1ZmZlci5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIGNvcHkgKHRhcmdldCwgdGFyZ2V0U3RhcnQsIHN0YXJ0LCBlbmQpIHsKCSAgaWYgKCFzdGFydCkgc3RhcnQgPSAwCgkgIGlmICghZW5kICYmIGVuZCAhPT0gMCkgZW5kID0gdGhpcy5sZW5ndGgKCSAgaWYgKHRhcmdldFN0YXJ0ID49IHRhcmdldC5sZW5ndGgpIHRhcmdldFN0YXJ0ID0gdGFyZ2V0Lmxlbmd0aAoJICBpZiAoIXRhcmdldFN0YXJ0KSB0YXJnZXRTdGFydCA9IDAKCSAgaWYgKGVuZCA+IDAgJiYgZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0CgoJICAvLyBDb3B5IDAgYnl0ZXM7IHdlJ3JlIGRvbmUKCSAgaWYgKGVuZCA9PT0gc3RhcnQpIHJldHVybiAwCgkgIGlmICh0YXJnZXQubGVuZ3RoID09PSAwIHx8IHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm4gMAoKCSAgLy8gRmF0YWwgZXJyb3IgY29uZGl0aW9ucwoJICBpZiAodGFyZ2V0U3RhcnQgPCAwKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3RhcmdldFN0YXJ0IG91dCBvZiBib3VuZHMnKQoJICB9CgkgIGlmIChzdGFydCA8IDAgfHwgc3RhcnQgPj0gdGhpcy5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdzb3VyY2VTdGFydCBvdXQgb2YgYm91bmRzJykKCSAgaWYgKGVuZCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdzb3VyY2VFbmQgb3V0IG9mIGJvdW5kcycpCgoJICAvLyBBcmUgd2Ugb29iPwoJICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpIGVuZCA9IHRoaXMubGVuZ3RoCgkgIGlmICh0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgPCBlbmQgLSBzdGFydCkgewoJICAgIGVuZCA9IHRhcmdldC5sZW5ndGggLSB0YXJnZXRTdGFydCArIHN0YXJ0CgkgIH0KCgkgIHZhciBsZW4gPSBlbmQgLSBzdGFydAoJICB2YXIgaQoKCSAgaWYgKHRoaXMgPT09IHRhcmdldCAmJiBzdGFydCA8IHRhcmdldFN0YXJ0ICYmIHRhcmdldFN0YXJ0IDwgZW5kKSB7CgkgICAgLy8gZGVzY2VuZGluZyBjb3B5IGZyb20gZW5kCgkgICAgZm9yIChpID0gbGVuIC0gMTsgaSA+PSAwOyAtLWkpIHsKCSAgICAgIHRhcmdldFtpICsgdGFyZ2V0U3RhcnRdID0gdGhpc1tpICsgc3RhcnRdCgkgICAgfQoJICB9IGVsc2UgaWYgKGxlbiA8IDEwMDAgfHwgIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgLy8gYXNjZW5kaW5nIGNvcHkgZnJvbSBzdGFydAoJICAgIGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSkgewoJICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF0KCSAgICB9CgkgIH0gZWxzZSB7CgkgICAgVWludDhBcnJheS5wcm90b3R5cGUuc2V0LmNhbGwoCgkgICAgICB0YXJnZXQsCgkgICAgICB0aGlzLnN1YmFycmF5KHN0YXJ0LCBzdGFydCArIGxlbiksCgkgICAgICB0YXJnZXRTdGFydAoJICAgICkKCSAgfQoKCSAgcmV0dXJuIGxlbgoJfQoKCS8vIFVzYWdlOgoJLy8gICAgYnVmZmVyLmZpbGwobnVtYmVyWywgb2Zmc2V0WywgZW5kXV0pCgkvLyAgICBidWZmZXIuZmlsbChidWZmZXJbLCBvZmZzZXRbLCBlbmRdXSkKCS8vICAgIGJ1ZmZlci5maWxsKHN0cmluZ1ssIG9mZnNldFssIGVuZF1dWywgZW5jb2RpbmddKQoJQnVmZmVyLnByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gZmlsbCAodmFsLCBzdGFydCwgZW5kLCBlbmNvZGluZykgewoJICAvLyBIYW5kbGUgc3RyaW5nIGNhc2VzOgoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHsKCSAgICBpZiAodHlwZW9mIHN0YXJ0ID09PSAnc3RyaW5nJykgewoJICAgICAgZW5jb2RpbmcgPSBzdGFydAoJICAgICAgc3RhcnQgPSAwCgkgICAgICBlbmQgPSB0aGlzLmxlbmd0aAoJICAgIH0gZWxzZSBpZiAodHlwZW9mIGVuZCA9PT0gJ3N0cmluZycpIHsKCSAgICAgIGVuY29kaW5nID0gZW5kCgkgICAgICBlbmQgPSB0aGlzLmxlbmd0aAoJICAgIH0KCSAgICBpZiAodmFsLmxlbmd0aCA9PT0gMSkgewoJICAgICAgdmFyIGNvZGUgPSB2YWwuY2hhckNvZGVBdCgwKQoJICAgICAgaWYgKGNvZGUgPCAyNTYpIHsKCSAgICAgICAgdmFsID0gY29kZQoJICAgICAgfQoJICAgIH0KCSAgICBpZiAoZW5jb2RpbmcgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnKSB7CgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdlbmNvZGluZyBtdXN0IGJlIGEgc3RyaW5nJykKCSAgICB9CgkgICAgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycgJiYgIUJ1ZmZlci5pc0VuY29kaW5nKGVuY29kaW5nKSkgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKQoJICAgIH0KCSAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykgewoJICAgIHZhbCA9IHZhbCAmIDI1NQoJICB9CgoJICAvLyBJbnZhbGlkIHJhbmdlcyBhcmUgbm90IHNldCB0byBhIGRlZmF1bHQsIHNvIGNhbiByYW5nZSBjaGVjayBlYXJseS4KCSAgaWYgKHN0YXJ0IDwgMCB8fCB0aGlzLmxlbmd0aCA8IHN0YXJ0IHx8IHRoaXMubGVuZ3RoIDwgZW5kKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ091dCBvZiByYW5nZSBpbmRleCcpCgkgIH0KCgkgIGlmIChlbmQgPD0gc3RhcnQpIHsKCSAgICByZXR1cm4gdGhpcwoJICB9CgoJICBzdGFydCA9IHN0YXJ0ID4+PiAwCgkgIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gdGhpcy5sZW5ndGggOiBlbmQgPj4+IDAKCgkgIGlmICghdmFsKSB2YWwgPSAwCgoJICB2YXIgaQoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHsKCSAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7CgkgICAgICB0aGlzW2ldID0gdmFsCgkgICAgfQoJICB9IGVsc2UgewoJICAgIHZhciBieXRlcyA9IEJ1ZmZlci5pc0J1ZmZlcih2YWwpCgkgICAgICA/IHZhbAoJICAgICAgOiB1dGY4VG9CeXRlcyhuZXcgQnVmZmVyKHZhbCwgZW5jb2RpbmcpLnRvU3RyaW5nKCkpCgkgICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aAoJICAgIGZvciAoaSA9IDA7IGkgPCBlbmQgLSBzdGFydDsgKytpKSB7CgkgICAgICB0aGlzW2kgKyBzdGFydF0gPSBieXRlc1tpICUgbGVuXQoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIHRoaXMKCX0KCgkvLyBIRUxQRVIgRlVOQ1RJT05TCgkvLyA9PT09PT09PT09PT09PT09CgoJdmFyIElOVkFMSURfQkFTRTY0X1JFID0gL1teK1wvMC05QS1aYS16LV9dL2cKCglmdW5jdGlvbiBiYXNlNjRjbGVhbiAoc3RyKSB7CgkgIC8vIE5vZGUgc3RyaXBzIG91dCBpbnZhbGlkIGNoYXJhY3RlcnMgbGlrZSBcbiBhbmQgXHQgZnJvbSB0aGUgc3RyaW5nLCBiYXNlNjQtanMgZG9lcyBub3QKCSAgc3RyID0gc3RyaW5ndHJpbShzdHIpLnJlcGxhY2UoSU5WQUxJRF9CQVNFNjRfUkUsICcnKQoJICAvLyBOb2RlIGNvbnZlcnRzIHN0cmluZ3Mgd2l0aCBsZW5ndGggPCAyIHRvICcnCgkgIGlmIChzdHIubGVuZ3RoIDwgMikgcmV0dXJuICcnCgkgIC8vIE5vZGUgYWxsb3dzIGZvciBub24tcGFkZGVkIGJhc2U2NCBzdHJpbmdzIChtaXNzaW5nIHRyYWlsaW5nID09PSksIGJhc2U2NC1qcyBkb2VzIG5vdAoJICB3aGlsZSAoc3RyLmxlbmd0aCAlIDQgIT09IDApIHsKCSAgICBzdHIgPSBzdHIgKyAnPScKCSAgfQoJICByZXR1cm4gc3RyCgl9CgoJZnVuY3Rpb24gc3RyaW5ndHJpbSAoc3RyKSB7CgkgIGlmIChzdHIudHJpbSkgcmV0dXJuIHN0ci50cmltKCkKCSAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXHMrfFxzKyQvZywgJycpCgl9CgoJZnVuY3Rpb24gdG9IZXggKG4pIHsKCSAgaWYgKG4gPCAxNikgcmV0dXJuICcwJyArIG4udG9TdHJpbmcoMTYpCgkgIHJldHVybiBuLnRvU3RyaW5nKDE2KQoJfQoKCWZ1bmN0aW9uIHV0ZjhUb0J5dGVzIChzdHJpbmcsIHVuaXRzKSB7CgkgIHVuaXRzID0gdW5pdHMgfHwgSW5maW5pdHkKCSAgdmFyIGNvZGVQb2ludAoJICB2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aAoJICB2YXIgbGVhZFN1cnJvZ2F0ZSA9IG51bGwKCSAgdmFyIGJ5dGVzID0gW10KCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKCSAgICBjb2RlUG9pbnQgPSBzdHJpbmcuY2hhckNvZGVBdChpKQoKCSAgICAvLyBpcyBzdXJyb2dhdGUgY29tcG9uZW50CgkgICAgaWYgKGNvZGVQb2ludCA+IDB4RDdGRiAmJiBjb2RlUG9pbnQgPCAweEUwMDApIHsKCSAgICAgIC8vIGxhc3QgY2hhciB3YXMgYSBsZWFkCgkgICAgICBpZiAoIWxlYWRTdXJyb2dhdGUpIHsKCSAgICAgICAgLy8gbm8gbGVhZCB5ZXQKCSAgICAgICAgaWYgKGNvZGVQb2ludCA+IDB4REJGRikgewoJICAgICAgICAgIC8vIHVuZXhwZWN0ZWQgdHJhaWwKCSAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRCkKCSAgICAgICAgICBjb250aW51ZQoJICAgICAgICB9IGVsc2UgaWYgKGkgKyAxID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAvLyB1bnBhaXJlZCBsZWFkCgkgICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpCgkgICAgICAgICAgY29udGludWUKCSAgICAgICAgfQoKCSAgICAgICAgLy8gdmFsaWQgbGVhZAoJICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50CgoJICAgICAgICBjb250aW51ZQoJICAgICAgfQoKCSAgICAgIC8vIDIgbGVhZHMgaW4gYSByb3cKCSAgICAgIGlmIChjb2RlUG9pbnQgPCAweERDMDApIHsKCSAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpCgkgICAgICAgIGxlYWRTdXJyb2dhdGUgPSBjb2RlUG9pbnQKCSAgICAgICAgY29udGludWUKCSAgICAgIH0KCgkgICAgICAvLyB2YWxpZCBzdXJyb2dhdGUgcGFpcgoJICAgICAgY29kZVBvaW50ID0gKGxlYWRTdXJyb2dhdGUgLSAweEQ4MDAgPDwgMTAgfCBjb2RlUG9pbnQgLSAweERDMDApICsgMHgxMDAwMAoJICAgIH0gZWxzZSBpZiAobGVhZFN1cnJvZ2F0ZSkgewoJICAgICAgLy8gdmFsaWQgYm1wIGNoYXIsIGJ1dCBsYXN0IGNoYXIgd2FzIGEgbGVhZAoJICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpCgkgICAgfQoKCSAgICBsZWFkU3Vycm9nYXRlID0gbnVsbAoKCSAgICAvLyBlbmNvZGUgdXRmOAoJICAgIGlmIChjb2RlUG9pbnQgPCAweDgwKSB7CgkgICAgICBpZiAoKHVuaXRzIC09IDEpIDwgMCkgYnJlYWsKCSAgICAgIGJ5dGVzLnB1c2goY29kZVBvaW50KQoJICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHg4MDApIHsKCSAgICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVhawoJICAgICAgYnl0ZXMucHVzaCgKCSAgICAgICAgY29kZVBvaW50ID4+IDB4NiB8IDB4QzAsCgkgICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwCgkgICAgICApCgkgICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDEwMDAwKSB7CgkgICAgICBpZiAoKHVuaXRzIC09IDMpIDwgMCkgYnJlYWsKCSAgICAgIGJ5dGVzLnB1c2goCgkgICAgICAgIGNvZGVQb2ludCA+PiAweEMgfCAweEUwLAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsCgkgICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwCgkgICAgICApCgkgICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDExMDAwMCkgewoJICAgICAgaWYgKCh1bml0cyAtPSA0KSA8IDApIGJyZWFrCgkgICAgICBieXRlcy5wdXNoKAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHgxMiB8IDB4RjAsCgkgICAgICAgIGNvZGVQb2ludCA+PiAweEMgJiAweDNGIHwgMHg4MCwKCSAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLAoJICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MAoJICAgICAgKQoJICAgIH0gZWxzZSB7CgkgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY29kZSBwb2ludCcpCgkgICAgfQoJICB9CgoJICByZXR1cm4gYnl0ZXMKCX0KCglmdW5jdGlvbiBhc2NpaVRvQnl0ZXMgKHN0cikgewoJICB2YXIgYnl0ZUFycmF5ID0gW10KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyArK2kpIHsKCSAgICAvLyBOb2RlJ3MgY29kZSBzZWVtcyB0byBiZSBkb2luZyB0aGlzIGFuZCBub3QgJiAweDdGLi4KCSAgICBieXRlQXJyYXkucHVzaChzdHIuY2hhckNvZGVBdChpKSAmIDB4RkYpCgkgIH0KCSAgcmV0dXJuIGJ5dGVBcnJheQoJfQoKCWZ1bmN0aW9uIHV0ZjE2bGVUb0J5dGVzIChzdHIsIHVuaXRzKSB7CgkgIHZhciBjLCBoaSwgbG8KCSAgdmFyIGJ5dGVBcnJheSA9IFtdCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7CgkgICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrCgoJICAgIGMgPSBzdHIuY2hhckNvZGVBdChpKQoJICAgIGhpID0gYyA+PiA4CgkgICAgbG8gPSBjICUgMjU2CgkgICAgYnl0ZUFycmF5LnB1c2gobG8pCgkgICAgYnl0ZUFycmF5LnB1c2goaGkpCgkgIH0KCgkgIHJldHVybiBieXRlQXJyYXkKCX0KCglmdW5jdGlvbiBiYXNlNjRUb0J5dGVzIChzdHIpIHsKCSAgcmV0dXJuIGJhc2U2NC50b0J5dGVBcnJheShiYXNlNjRjbGVhbihzdHIpKQoJfQoKCWZ1bmN0aW9uIGJsaXRCdWZmZXIgKHNyYywgZHN0LCBvZmZzZXQsIGxlbmd0aCkgewoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CgkgICAgaWYgKChpICsgb2Zmc2V0ID49IGRzdC5sZW5ndGgpIHx8IChpID49IHNyYy5sZW5ndGgpKSBicmVhawoJICAgIGRzdFtpICsgb2Zmc2V0XSA9IHNyY1tpXQoJICB9CgkgIHJldHVybiBpCgl9CgoJZnVuY3Rpb24gaXNuYW4gKHZhbCkgewoJICByZXR1cm4gdmFsICE9PSB2YWwgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zZWxmLWNvbXBhcmUKCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpCgovKioqLyB9LAovKiA2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JwoKCWV4cG9ydHMuYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGgKCWV4cG9ydHMudG9CeXRlQXJyYXkgPSB0b0J5dGVBcnJheQoJZXhwb3J0cy5mcm9tQnl0ZUFycmF5ID0gZnJvbUJ5dGVBcnJheQoKCXZhciBsb29rdXAgPSBbXQoJdmFyIHJldkxvb2t1cCA9IFtdCgl2YXIgQXJyID0gdHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnID8gVWludDhBcnJheSA6IEFycmF5CgoJdmFyIGNvZGUgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLycKCWZvciAodmFyIGkgPSAwLCBsZW4gPSBjb2RlLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7CgkgIGxvb2t1cFtpXSA9IGNvZGVbaV0KCSAgcmV2TG9va3VwW2NvZGUuY2hhckNvZGVBdChpKV0gPSBpCgl9CgoJcmV2TG9va3VwWyctJy5jaGFyQ29kZUF0KDApXSA9IDYyCglyZXZMb29rdXBbJ18nLmNoYXJDb2RlQXQoMCldID0gNjMKCglmdW5jdGlvbiBwbGFjZUhvbGRlcnNDb3VudCAoYjY0KSB7CgkgIHZhciBsZW4gPSBiNjQubGVuZ3RoCgkgIGlmIChsZW4gJSA0ID4gMCkgewoJICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdHJpbmcuIExlbmd0aCBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNCcpCgkgIH0KCgkgIC8vIHRoZSBudW1iZXIgb2YgZXF1YWwgc2lnbnMgKHBsYWNlIGhvbGRlcnMpCgkgIC8vIGlmIHRoZXJlIGFyZSB0d28gcGxhY2Vob2xkZXJzLCB0aGFuIHRoZSB0d28gY2hhcmFjdGVycyBiZWZvcmUgaXQKCSAgLy8gcmVwcmVzZW50IG9uZSBieXRlCgkgIC8vIGlmIHRoZXJlIGlzIG9ubHkgb25lLCB0aGVuIHRoZSB0aHJlZSBjaGFyYWN0ZXJzIGJlZm9yZSBpdCByZXByZXNlbnQgMiBieXRlcwoJICAvLyB0aGlzIGlzIGp1c3QgYSBjaGVhcCBoYWNrIHRvIG5vdCBkbyBpbmRleE9mIHR3aWNlCgkgIHJldHVybiBiNjRbbGVuIC0gMl0gPT09ICc9JyA/IDIgOiBiNjRbbGVuIC0gMV0gPT09ICc9JyA/IDEgOiAwCgl9CgoJZnVuY3Rpb24gYnl0ZUxlbmd0aCAoYjY0KSB7CgkgIC8vIGJhc2U2NCBpcyA0LzMgKyB1cCB0byB0d28gY2hhcmFjdGVycyBvZiB0aGUgb3JpZ2luYWwgZGF0YQoJICByZXR1cm4gYjY0Lmxlbmd0aCAqIDMgLyA0IC0gcGxhY2VIb2xkZXJzQ291bnQoYjY0KQoJfQoKCWZ1bmN0aW9uIHRvQnl0ZUFycmF5IChiNjQpIHsKCSAgdmFyIGksIGosIGwsIHRtcCwgcGxhY2VIb2xkZXJzLCBhcnIKCSAgdmFyIGxlbiA9IGI2NC5sZW5ndGgKCSAgcGxhY2VIb2xkZXJzID0gcGxhY2VIb2xkZXJzQ291bnQoYjY0KQoKCSAgYXJyID0gbmV3IEFycihsZW4gKiAzIC8gNCAtIHBsYWNlSG9sZGVycykKCgkgIC8vIGlmIHRoZXJlIGFyZSBwbGFjZWhvbGRlcnMsIG9ubHkgZ2V0IHVwIHRvIHRoZSBsYXN0IGNvbXBsZXRlIDQgY2hhcnMKCSAgbCA9IHBsYWNlSG9sZGVycyA+IDAgPyBsZW4gLSA0IDogbGVuCgoJICB2YXIgTCA9IDAKCgkgIGZvciAoaSA9IDAsIGogPSAwOyBpIDwgbDsgaSArPSA0LCBqICs9IDMpIHsKCSAgICB0bXAgPSAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAxOCkgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPDwgMTIpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMildIDw8IDYpIHwgcmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAzKV0KCSAgICBhcnJbTCsrXSA9ICh0bXAgPj4gMTYpICYgMHhGRgoJICAgIGFycltMKytdID0gKHRtcCA+PiA4KSAmIDB4RkYKCSAgICBhcnJbTCsrXSA9IHRtcCAmIDB4RkYKCSAgfQoKCSAgaWYgKHBsYWNlSG9sZGVycyA9PT0gMikgewoJICAgIHRtcCA9IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDIpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldID4+IDQpCgkgICAgYXJyW0wrK10gPSB0bXAgJiAweEZGCgkgIH0gZWxzZSBpZiAocGxhY2VIb2xkZXJzID09PSAxKSB7CgkgICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMTApIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDQpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMildID4+IDIpCgkgICAgYXJyW0wrK10gPSAodG1wID4+IDgpICYgMHhGRgoJICAgIGFycltMKytdID0gdG1wICYgMHhGRgoJICB9CgoJICByZXR1cm4gYXJyCgl9CgoJZnVuY3Rpb24gdHJpcGxldFRvQmFzZTY0IChudW0pIHsKCSAgcmV0dXJuIGxvb2t1cFtudW0gPj4gMTggJiAweDNGXSArIGxvb2t1cFtudW0gPj4gMTIgJiAweDNGXSArIGxvb2t1cFtudW0gPj4gNiAmIDB4M0ZdICsgbG9va3VwW251bSAmIDB4M0ZdCgl9CgoJZnVuY3Rpb24gZW5jb2RlQ2h1bmsgKHVpbnQ4LCBzdGFydCwgZW5kKSB7CgkgIHZhciB0bXAKCSAgdmFyIG91dHB1dCA9IFtdCgkgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSArPSAzKSB7CgkgICAgdG1wID0gKHVpbnQ4W2ldIDw8IDE2KSArICh1aW50OFtpICsgMV0gPDwgOCkgKyAodWludDhbaSArIDJdKQoJICAgIG91dHB1dC5wdXNoKHRyaXBsZXRUb0Jhc2U2NCh0bXApKQoJICB9CgkgIHJldHVybiBvdXRwdXQuam9pbignJykKCX0KCglmdW5jdGlvbiBmcm9tQnl0ZUFycmF5ICh1aW50OCkgewoJICB2YXIgdG1wCgkgIHZhciBsZW4gPSB1aW50OC5sZW5ndGgKCSAgdmFyIGV4dHJhQnl0ZXMgPSBsZW4gJSAzIC8vIGlmIHdlIGhhdmUgMSBieXRlIGxlZnQsIHBhZCAyIGJ5dGVzCgkgIHZhciBvdXRwdXQgPSAnJwoJICB2YXIgcGFydHMgPSBbXQoJICB2YXIgbWF4Q2h1bmtMZW5ndGggPSAxNjM4MyAvLyBtdXN0IGJlIG11bHRpcGxlIG9mIDMKCgkgIC8vIGdvIHRocm91Z2ggdGhlIGFycmF5IGV2ZXJ5IHRocmVlIGJ5dGVzLCB3ZSdsbCBkZWFsIHdpdGggdHJhaWxpbmcgc3R1ZmYgbGF0ZXIKCSAgZm9yICh2YXIgaSA9IDAsIGxlbjIgPSBsZW4gLSBleHRyYUJ5dGVzOyBpIDwgbGVuMjsgaSArPSBtYXhDaHVua0xlbmd0aCkgewoJICAgIHBhcnRzLnB1c2goZW5jb2RlQ2h1bmsodWludDgsIGksIChpICsgbWF4Q2h1bmtMZW5ndGgpID4gbGVuMiA/IGxlbjIgOiAoaSArIG1heENodW5rTGVuZ3RoKSkpCgkgIH0KCgkgIC8vIHBhZCB0aGUgZW5kIHdpdGggemVyb3MsIGJ1dCBtYWtlIHN1cmUgdG8gbm90IGZvcmdldCB0aGUgZXh0cmEgYnl0ZXMKCSAgaWYgKGV4dHJhQnl0ZXMgPT09IDEpIHsKCSAgICB0bXAgPSB1aW50OFtsZW4gLSAxXQoJICAgIG91dHB1dCArPSBsb29rdXBbdG1wID4+IDJdCgkgICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wIDw8IDQpICYgMHgzRl0KCSAgICBvdXRwdXQgKz0gJz09JwoJICB9IGVsc2UgaWYgKGV4dHJhQnl0ZXMgPT09IDIpIHsKCSAgICB0bXAgPSAodWludDhbbGVuIC0gMl0gPDwgOCkgKyAodWludDhbbGVuIC0gMV0pCgkgICAgb3V0cHV0ICs9IGxvb2t1cFt0bXAgPj4gMTBdCgkgICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wID4+IDQpICYgMHgzRl0KCSAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPDwgMikgJiAweDNGXQoJICAgIG91dHB1dCArPSAnPScKCSAgfQoKCSAgcGFydHMucHVzaChvdXRwdXQpCgoJICByZXR1cm4gcGFydHMuam9pbignJykKCX0KCgovKioqLyB9LAovKiA3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCWV4cG9ydHMucmVhZCA9IGZ1bmN0aW9uIChidWZmZXIsIG9mZnNldCwgaXNMRSwgbUxlbiwgbkJ5dGVzKSB7CgkgIHZhciBlLCBtCgkgIHZhciBlTGVuID0gbkJ5dGVzICogOCAtIG1MZW4gLSAxCgkgIHZhciBlTWF4ID0gKDEgPDwgZUxlbikgLSAxCgkgIHZhciBlQmlhcyA9IGVNYXggPj4gMQoJICB2YXIgbkJpdHMgPSAtNwoJICB2YXIgaSA9IGlzTEUgPyAobkJ5dGVzIC0gMSkgOiAwCgkgIHZhciBkID0gaXNMRSA/IC0xIDogMQoJICB2YXIgcyA9IGJ1ZmZlcltvZmZzZXQgKyBpXQoKCSAgaSArPSBkCgoJICBlID0gcyAmICgoMSA8PCAoLW5CaXRzKSkgLSAxKQoJICBzID4+PSAoLW5CaXRzKQoJICBuQml0cyArPSBlTGVuCgkgIGZvciAoOyBuQml0cyA+IDA7IGUgPSBlICogMjU2ICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpIHt9CgoJICBtID0gZSAmICgoMSA8PCAoLW5CaXRzKSkgLSAxKQoJICBlID4+PSAoLW5CaXRzKQoJICBuQml0cyArPSBtTGVuCgkgIGZvciAoOyBuQml0cyA+IDA7IG0gPSBtICogMjU2ICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpIHt9CgoJICBpZiAoZSA9PT0gMCkgewoJICAgIGUgPSAxIC0gZUJpYXMKCSAgfSBlbHNlIGlmIChlID09PSBlTWF4KSB7CgkgICAgcmV0dXJuIG0gPyBOYU4gOiAoKHMgPyAtMSA6IDEpICogSW5maW5pdHkpCgkgIH0gZWxzZSB7CgkgICAgbSA9IG0gKyBNYXRoLnBvdygyLCBtTGVuKQoJICAgIGUgPSBlIC0gZUJpYXMKCSAgfQoJICByZXR1cm4gKHMgPyAtMSA6IDEpICogbSAqIE1hdGgucG93KDIsIGUgLSBtTGVuKQoJfQoKCWV4cG9ydHMud3JpdGUgPSBmdW5jdGlvbiAoYnVmZmVyLCB2YWx1ZSwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHsKCSAgdmFyIGUsIG0sIGMKCSAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDEKCSAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDEKCSAgdmFyIGVCaWFzID0gZU1heCA+PiAxCgkgIHZhciBydCA9IChtTGVuID09PSAyMyA/IE1hdGgucG93KDIsIC0yNCkgLSBNYXRoLnBvdygyLCAtNzcpIDogMCkKCSAgdmFyIGkgPSBpc0xFID8gMCA6IChuQnl0ZXMgLSAxKQoJICB2YXIgZCA9IGlzTEUgPyAxIDogLTEKCSAgdmFyIHMgPSB2YWx1ZSA8IDAgfHwgKHZhbHVlID09PSAwICYmIDEgLyB2YWx1ZSA8IDApID8gMSA6IDAKCgkgIHZhbHVlID0gTWF0aC5hYnModmFsdWUpCgoJICBpZiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlID09PSBJbmZpbml0eSkgewoJICAgIG0gPSBpc05hTih2YWx1ZSkgPyAxIDogMAoJICAgIGUgPSBlTWF4CgkgIH0gZWxzZSB7CgkgICAgZSA9IE1hdGguZmxvb3IoTWF0aC5sb2codmFsdWUpIC8gTWF0aC5MTjIpCgkgICAgaWYgKHZhbHVlICogKGMgPSBNYXRoLnBvdygyLCAtZSkpIDwgMSkgewoJICAgICAgZS0tCgkgICAgICBjICo9IDIKCSAgICB9CgkgICAgaWYgKGUgKyBlQmlhcyA+PSAxKSB7CgkgICAgICB2YWx1ZSArPSBydCAvIGMKCSAgICB9IGVsc2UgewoJICAgICAgdmFsdWUgKz0gcnQgKiBNYXRoLnBvdygyLCAxIC0gZUJpYXMpCgkgICAgfQoJICAgIGlmICh2YWx1ZSAqIGMgPj0gMikgewoJICAgICAgZSsrCgkgICAgICBjIC89IDIKCSAgICB9CgoJICAgIGlmIChlICsgZUJpYXMgPj0gZU1heCkgewoJICAgICAgbSA9IDAKCSAgICAgIGUgPSBlTWF4CgkgICAgfSBlbHNlIGlmIChlICsgZUJpYXMgPj0gMSkgewoJICAgICAgbSA9ICh2YWx1ZSAqIGMgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pCgkgICAgICBlID0gZSArIGVCaWFzCgkgICAgfSBlbHNlIHsKCSAgICAgIG0gPSB2YWx1ZSAqIE1hdGgucG93KDIsIGVCaWFzIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKQoJICAgICAgZSA9IDAKCSAgICB9CgkgIH0KCgkgIGZvciAoOyBtTGVuID49IDg7IGJ1ZmZlcltvZmZzZXQgKyBpXSA9IG0gJiAweGZmLCBpICs9IGQsIG0gLz0gMjU2LCBtTGVuIC09IDgpIHt9CgoJICBlID0gKGUgPDwgbUxlbikgfCBtCgkgIGVMZW4gKz0gbUxlbgoJICBmb3IgKDsgZUxlbiA+IDA7IGJ1ZmZlcltvZmZzZXQgKyBpXSA9IGUgJiAweGZmLCBpICs9IGQsIGUgLz0gMjU2LCBlTGVuIC09IDgpIHt9CgoJICBidWZmZXJbb2Zmc2V0ICsgaSAtIGRdIHw9IHMgKiAxMjgKCX0KCgovKioqLyB9LAovKiA4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCXZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nOwoKCW1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoYXJyKSB7CgkgIHJldHVybiB0b1N0cmluZy5jYWxsKGFycikgPT0gJ1tvYmplY3QgQXJyYXldJzsKCX07CgoKLyoqKi8gfSwKLyogOSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsLCBCdWZmZXIpIHsoZnVuY3Rpb24oKSB7CgkgIHZhciBnID0gKCd1bmRlZmluZWQnID09PSB0eXBlb2Ygd2luZG93ID8gZ2xvYmFsIDogd2luZG93KSB8fCB7fQoJICBfY3J5cHRvID0gKAoJICAgIGcuY3J5cHRvIHx8IGcubXNDcnlwdG8gfHwgX193ZWJwYWNrX3JlcXVpcmVfXygxMCkKCSAgKQoJICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHNpemUpIHsKCSAgICAvLyBNb2Rlcm4gQnJvd3NlcnMKCSAgICBpZihfY3J5cHRvLmdldFJhbmRvbVZhbHVlcykgewoJICAgICAgdmFyIGJ5dGVzID0gbmV3IEJ1ZmZlcihzaXplKTsgLy9pbiBicm93c2VyaWZ5LCB0aGlzIGlzIGFuIGV4dGVuZGVkIFVpbnQ4QXJyYXkKCSAgICAgIC8qIFRoaXMgd2lsbCBub3Qgd29yayBpbiBvbGRlciBicm93c2Vycy4KCSAgICAgICAqIFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvd2luZG93LmNyeXB0by5nZXRSYW5kb21WYWx1ZXMKCSAgICAgICAqLwoJICAgIAoJICAgICAgX2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoYnl0ZXMpOwoJICAgICAgcmV0dXJuIGJ5dGVzOwoJICAgIH0KCSAgICBlbHNlIGlmIChfY3J5cHRvLnJhbmRvbUJ5dGVzKSB7CgkgICAgICByZXR1cm4gX2NyeXB0by5yYW5kb21CeXRlcyhzaXplKQoJICAgIH0KCSAgICBlbHNlCgkgICAgICB0aHJvdyBuZXcgRXJyb3IoCgkgICAgICAgICdzZWN1cmUgcmFuZG9tIG51bWJlciBnZW5lcmF0aW9uIG5vdCBzdXBwb3J0ZWQgYnkgdGhpcyBicm93c2VyXG4nKwoJICAgICAgICAndXNlIGNocm9tZSwgRmlyZUZveCBvciBJbnRlcm5ldCBFeHBsb3JlciAxMScKCSAgICAgICkKCSAgfQoJfSgpKQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcikpCgovKioqLyB9LAovKiAxMCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvKiAoaWdub3JlZCkgKi8KCi8qKiovIH0sCi8qIDExICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIpIHt2YXIgY3JlYXRlSGFzaCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCgoJdmFyIG1kNSA9IHRvQ29uc3RydWN0b3IoX193ZWJwYWNrX3JlcXVpcmVfXygyMSkpCgl2YXIgcm1kMTYwID0gdG9Db25zdHJ1Y3RvcihfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKSkKCglmdW5jdGlvbiB0b0NvbnN0cnVjdG9yIChmbikgewoJICByZXR1cm4gZnVuY3Rpb24gKCkgewoJICAgIHZhciBidWZmZXJzID0gW10KCSAgICB2YXIgbT0gewoJICAgICAgdXBkYXRlOiBmdW5jdGlvbiAoZGF0YSwgZW5jKSB7CgkgICAgICAgIGlmKCFCdWZmZXIuaXNCdWZmZXIoZGF0YSkpIGRhdGEgPSBuZXcgQnVmZmVyKGRhdGEsIGVuYykKCSAgICAgICAgYnVmZmVycy5wdXNoKGRhdGEpCgkgICAgICAgIHJldHVybiB0aGlzCgkgICAgICB9LAoJICAgICAgZGlnZXN0OiBmdW5jdGlvbiAoZW5jKSB7CgkgICAgICAgIHZhciBidWYgPSBCdWZmZXIuY29uY2F0KGJ1ZmZlcnMpCgkgICAgICAgIHZhciByID0gZm4oYnVmKQoJICAgICAgICBidWZmZXJzID0gbnVsbAoJICAgICAgICByZXR1cm4gZW5jID8gci50b1N0cmluZyhlbmMpIDogcgoJICAgICAgfQoJICAgIH0KCSAgICByZXR1cm4gbQoJICB9Cgl9CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYWxnKSB7CgkgIGlmKCdtZDUnID09PSBhbGcpIHJldHVybiBuZXcgbWQ1KCkKCSAgaWYoJ3JtZDE2MCcgPT09IGFsZykgcmV0dXJuIG5ldyBybWQxNjAoKQoJICByZXR1cm4gY3JlYXRlSGFzaChhbGcpCgl9CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oNSkuQnVmZmVyKSkKCi8qKiovIH0sCi8qIDEyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYWxnKSB7CgkgIHZhciBBbGcgPSBleHBvcnRzW2FsZ10KCSAgaWYoIUFsZykgdGhyb3cgbmV3IEVycm9yKGFsZyArICcgaXMgbm90IHN1cHBvcnRlZCAod2UgYWNjZXB0IHB1bGwgcmVxdWVzdHMpJykKCSAgcmV0dXJuIG5ldyBBbGcoKQoJfQoKCXZhciBCdWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcgoJdmFyIEhhc2ggICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpKEJ1ZmZlcikKCglleHBvcnRzLnNoYTEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KShCdWZmZXIsIEhhc2gpCglleHBvcnRzLnNoYTI1NiA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpKEJ1ZmZlciwgSGFzaCkKCWV4cG9ydHMuc2hhNTEyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCkoQnVmZmVyLCBIYXNoKQoKCi8qKiovIH0sCi8qIDEzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEJ1ZmZlcikgewoKCSAgLy9wcm90b3R5cGUgY2xhc3MgZm9yIGhhc2ggZnVuY3Rpb25zCgkgIGZ1bmN0aW9uIEhhc2ggKGJsb2NrU2l6ZSwgZmluYWxTaXplKSB7CgkgICAgdGhpcy5fYmxvY2sgPSBuZXcgQnVmZmVyKGJsb2NrU2l6ZSkgLy9uZXcgVWludDMyQXJyYXkoYmxvY2tTaXplLzQpCgkgICAgdGhpcy5fZmluYWxTaXplID0gZmluYWxTaXplCgkgICAgdGhpcy5fYmxvY2tTaXplID0gYmxvY2tTaXplCgkgICAgdGhpcy5fbGVuID0gMAoJICAgIHRoaXMuX3MgPSAwCgkgIH0KCgkgIEhhc2gucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7CgkgICAgdGhpcy5fcyA9IDAKCSAgICB0aGlzLl9sZW4gPSAwCgkgIH0KCgkgIEhhc2gucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkYXRhLCBlbmMpIHsKCSAgICBpZiAoInN0cmluZyIgPT09IHR5cGVvZiBkYXRhKSB7CgkgICAgICBlbmMgPSBlbmMgfHwgInV0ZjgiCgkgICAgICBkYXRhID0gbmV3IEJ1ZmZlcihkYXRhLCBlbmMpCgkgICAgfQoKCSAgICB2YXIgbCA9IHRoaXMuX2xlbiArPSBkYXRhLmxlbmd0aAoJICAgIHZhciBzID0gdGhpcy5fcyA9ICh0aGlzLl9zIHx8IDApCgkgICAgdmFyIGYgPSAwCgkgICAgdmFyIGJ1ZmZlciA9IHRoaXMuX2Jsb2NrCgoJICAgIHdoaWxlIChzIDwgbCkgewoJICAgICAgdmFyIHQgPSBNYXRoLm1pbihkYXRhLmxlbmd0aCwgZiArIHRoaXMuX2Jsb2NrU2l6ZSAtIChzICUgdGhpcy5fYmxvY2tTaXplKSkKCSAgICAgIHZhciBjaCA9ICh0IC0gZikKCgkgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoOyBpKyspIHsKCSAgICAgICAgYnVmZmVyWyhzICUgdGhpcy5fYmxvY2tTaXplKSArIGldID0gZGF0YVtpICsgZl0KCSAgICAgIH0KCgkgICAgICBzICs9IGNoCgkgICAgICBmICs9IGNoCgoJICAgICAgaWYgKChzICUgdGhpcy5fYmxvY2tTaXplKSA9PT0gMCkgewoJICAgICAgICB0aGlzLl91cGRhdGUoYnVmZmVyKQoJICAgICAgfQoJICAgIH0KCSAgICB0aGlzLl9zID0gcwoKCSAgICByZXR1cm4gdGhpcwoJICB9CgoJICBIYXNoLnByb3RvdHlwZS5kaWdlc3QgPSBmdW5jdGlvbiAoZW5jKSB7CgkgICAgLy8gU3VwcG9zZSB0aGUgbGVuZ3RoIG9mIHRoZSBtZXNzYWdlIE0sIGluIGJpdHMsIGlzIGwKCSAgICB2YXIgbCA9IHRoaXMuX2xlbiAqIDgKCgkgICAgLy8gQXBwZW5kIHRoZSBiaXQgMSB0byB0aGUgZW5kIG9mIHRoZSBtZXNzYWdlCgkgICAgdGhpcy5fYmxvY2tbdGhpcy5fbGVuICUgdGhpcy5fYmxvY2tTaXplXSA9IDB4ODAKCgkgICAgLy8gYW5kIHRoZW4gayB6ZXJvIGJpdHMsIHdoZXJlIGsgaXMgdGhlIHNtYWxsZXN0IG5vbi1uZWdhdGl2ZSBzb2x1dGlvbiB0byB0aGUgZXF1YXRpb24gKGwgKyAxICsgaykgPT09IGZpbmFsU2l6ZSBtb2QgYmxvY2tTaXplCgkgICAgdGhpcy5fYmxvY2suZmlsbCgwLCB0aGlzLl9sZW4gJSB0aGlzLl9ibG9ja1NpemUgKyAxKQoKCSAgICBpZiAobCAlICh0aGlzLl9ibG9ja1NpemUgKiA4KSA+PSB0aGlzLl9maW5hbFNpemUgKiA4KSB7CgkgICAgICB0aGlzLl91cGRhdGUodGhpcy5fYmxvY2spCgkgICAgICB0aGlzLl9ibG9jay5maWxsKDApCgkgICAgfQoKCSAgICAvLyB0byB0aGlzIGFwcGVuZCB0aGUgYmxvY2sgd2hpY2ggaXMgZXF1YWwgdG8gdGhlIG51bWJlciBsIHdyaXR0ZW4gaW4gYmluYXJ5CgkgICAgLy8gVE9ETzogaGFuZGxlIGNhc2Ugd2hlcmUgbCBpcyA+IE1hdGgucG93KDIsIDI5KQoJICAgIHRoaXMuX2Jsb2NrLndyaXRlSW50MzJCRShsLCB0aGlzLl9ibG9ja1NpemUgLSA0KQoKCSAgICB2YXIgaGFzaCA9IHRoaXMuX3VwZGF0ZSh0aGlzLl9ibG9jaykgfHwgdGhpcy5faGFzaCgpCgoJICAgIHJldHVybiBlbmMgPyBoYXNoLnRvU3RyaW5nKGVuYykgOiBoYXNoCgkgIH0KCgkgIEhhc2gucHJvdG90eXBlLl91cGRhdGUgPSBmdW5jdGlvbiAoKSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKCdfdXBkYXRlIG11c3QgYmUgaW1wbGVtZW50ZWQgYnkgc3ViY2xhc3MnKQoJICB9CgoJICByZXR1cm4gSGFzaAoJfQoKCi8qKiovIH0sCi8qIDE0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qCgkgKiBBIEphdmFTY3JpcHQgaW1wbGVtZW50YXRpb24gb2YgdGhlIFNlY3VyZSBIYXNoIEFsZ29yaXRobSwgU0hBLTEsIGFzIGRlZmluZWQKCSAqIGluIEZJUFMgUFVCIDE4MC0xCgkgKiBWZXJzaW9uIDIuMWEgQ29weXJpZ2h0IFBhdWwgSm9obnN0b24gMjAwMCAtIDIwMDIuCgkgKiBPdGhlciBjb250cmlidXRvcnM6IEdyZWcgSG9sdCwgQW5kcmV3IEtlcGVydCwgWWRuYXIsIExvc3RpbmV0CgkgKiBEaXN0cmlidXRlZCB1bmRlciB0aGUgQlNEIExpY2Vuc2UKCSAqIFNlZSBodHRwOi8vcGFqaG9tZS5vcmcudWsvY3J5cHQvbWQ1IGZvciBkZXRhaWxzLgoJICovCgoJdmFyIGluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkuaW5oZXJpdHMKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChCdWZmZXIsIEhhc2gpIHsKCgkgIHZhciBBID0gMHwwCgkgIHZhciBCID0gNHwwCgkgIHZhciBDID0gOHwwCgkgIHZhciBEID0gMTJ8MAoJICB2YXIgRSA9IDE2fDAKCgkgIHZhciBXID0gbmV3ICh0eXBlb2YgSW50MzJBcnJheSA9PT0gJ3VuZGVmaW5lZCcgPyBBcnJheSA6IEludDMyQXJyYXkpKDgwKQoKCSAgdmFyIFBPT0wgPSBbXQoKCSAgZnVuY3Rpb24gU2hhMSAoKSB7CgkgICAgaWYoUE9PTC5sZW5ndGgpCgkgICAgICByZXR1cm4gUE9PTC5wb3AoKS5pbml0KCkKCgkgICAgaWYoISh0aGlzIGluc3RhbmNlb2YgU2hhMSkpIHJldHVybiBuZXcgU2hhMSgpCgkgICAgdGhpcy5fdyA9IFcKCSAgICBIYXNoLmNhbGwodGhpcywgMTYqNCwgMTQqNCkKCgkgICAgdGhpcy5faCA9IG51bGwKCSAgICB0aGlzLmluaXQoKQoJICB9CgoJICBpbmhlcml0cyhTaGExLCBIYXNoKQoKCSAgU2hhMS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHsKCSAgICB0aGlzLl9hID0gMHg2NzQ1MjMwMQoJICAgIHRoaXMuX2IgPSAweGVmY2RhYjg5CgkgICAgdGhpcy5fYyA9IDB4OThiYWRjZmUKCSAgICB0aGlzLl9kID0gMHgxMDMyNTQ3NgoJICAgIHRoaXMuX2UgPSAweGMzZDJlMWYwCgoJICAgIEhhc2gucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzKQoJICAgIHJldHVybiB0aGlzCgkgIH0KCgkgIFNoYTEucHJvdG90eXBlLl9QT09MID0gUE9PTAoJICBTaGExLnByb3RvdHlwZS5fdXBkYXRlID0gZnVuY3Rpb24gKFgpIHsKCgkgICAgdmFyIGEsIGIsIGMsIGQsIGUsIF9hLCBfYiwgX2MsIF9kLCBfZQoKCSAgICBhID0gX2EgPSB0aGlzLl9hCgkgICAgYiA9IF9iID0gdGhpcy5fYgoJICAgIGMgPSBfYyA9IHRoaXMuX2MKCSAgICBkID0gX2QgPSB0aGlzLl9kCgkgICAgZSA9IF9lID0gdGhpcy5fZQoKCSAgICB2YXIgdyA9IHRoaXMuX3cKCgkgICAgZm9yKHZhciBqID0gMDsgaiA8IDgwOyBqKyspIHsKCSAgICAgIHZhciBXID0gd1tqXSA9IGogPCAxNiA/IFgucmVhZEludDMyQkUoaio0KQoJICAgICAgICA6IHJvbCh3W2ogLSAzXSBeIHdbaiAtICA4XSBeIHdbaiAtIDE0XSBeIHdbaiAtIDE2XSwgMSkKCgkgICAgICB2YXIgdCA9IGFkZCgKCSAgICAgICAgYWRkKHJvbChhLCA1KSwgc2hhMV9mdChqLCBiLCBjLCBkKSksCgkgICAgICAgIGFkZChhZGQoZSwgVyksIHNoYTFfa3QoaikpCgkgICAgICApCgoJICAgICAgZSA9IGQKCSAgICAgIGQgPSBjCgkgICAgICBjID0gcm9sKGIsIDMwKQoJICAgICAgYiA9IGEKCSAgICAgIGEgPSB0CgkgICAgfQoKCSAgICB0aGlzLl9hID0gYWRkKGEsIF9hKQoJICAgIHRoaXMuX2IgPSBhZGQoYiwgX2IpCgkgICAgdGhpcy5fYyA9IGFkZChjLCBfYykKCSAgICB0aGlzLl9kID0gYWRkKGQsIF9kKQoJICAgIHRoaXMuX2UgPSBhZGQoZSwgX2UpCgkgIH0KCgkgIFNoYTEucHJvdG90eXBlLl9oYXNoID0gZnVuY3Rpb24gKCkgewoJICAgIGlmKFBPT0wubGVuZ3RoIDwgMTAwKSBQT09MLnB1c2godGhpcykKCSAgICB2YXIgSCA9IG5ldyBCdWZmZXIoMjApCgkgICAgLy9jb25zb2xlLmxvZyh0aGlzLl9hfDAsIHRoaXMuX2J8MCwgdGhpcy5fY3wwLCB0aGlzLl9kfDAsIHRoaXMuX2V8MCkKCSAgICBILndyaXRlSW50MzJCRSh0aGlzLl9hfDAsIEEpCgkgICAgSC53cml0ZUludDMyQkUodGhpcy5fYnwwLCBCKQoJICAgIEgud3JpdGVJbnQzMkJFKHRoaXMuX2N8MCwgQykKCSAgICBILndyaXRlSW50MzJCRSh0aGlzLl9kfDAsIEQpCgkgICAgSC53cml0ZUludDMyQkUodGhpcy5fZXwwLCBFKQoJICAgIHJldHVybiBICgkgIH0KCgkgIC8qCgkgICAqIFBlcmZvcm0gdGhlIGFwcHJvcHJpYXRlIHRyaXBsZXQgY29tYmluYXRpb24gZnVuY3Rpb24gZm9yIHRoZSBjdXJyZW50CgkgICAqIGl0ZXJhdGlvbgoJICAgKi8KCSAgZnVuY3Rpb24gc2hhMV9mdCh0LCBiLCBjLCBkKSB7CgkgICAgaWYodCA8IDIwKSByZXR1cm4gKGIgJiBjKSB8ICgofmIpICYgZCk7CgkgICAgaWYodCA8IDQwKSByZXR1cm4gYiBeIGMgXiBkOwoJICAgIGlmKHQgPCA2MCkgcmV0dXJuIChiICYgYykgfCAoYiAmIGQpIHwgKGMgJiBkKTsKCSAgICByZXR1cm4gYiBeIGMgXiBkOwoJICB9CgoJICAvKgoJICAgKiBEZXRlcm1pbmUgdGhlIGFwcHJvcHJpYXRlIGFkZGl0aXZlIGNvbnN0YW50IGZvciB0aGUgY3VycmVudCBpdGVyYXRpb24KCSAgICovCgkgIGZ1bmN0aW9uIHNoYTFfa3QodCkgewoJICAgIHJldHVybiAodCA8IDIwKSA/ICAxNTE4NTAwMjQ5IDogKHQgPCA0MCkgPyAgMTg1OTc3NTM5MyA6CgkgICAgICAgICAgICh0IDwgNjApID8gLTE4OTQwMDc1ODggOiAtODk5NDk3NTE0OwoJICB9CgoJICAvKgoJICAgKiBBZGQgaW50ZWdlcnMsIHdyYXBwaW5nIGF0IDJeMzIuIFRoaXMgdXNlcyAxNi1iaXQgb3BlcmF0aW9ucyBpbnRlcm5hbGx5CgkgICAqIHRvIHdvcmsgYXJvdW5kIGJ1Z3MgaW4gc29tZSBKUyBpbnRlcnByZXRlcnMuCgkgICAqIC8vZG9taW5pY3RhcnI6IHRoaXMgaXMgMTAgeWVhcnMgb2xkLCBzbyBtYXliZSB0aGlzIGNhbiBiZSBkcm9wcGVkPykKCSAgICoKCSAgICovCgkgIGZ1bmN0aW9uIGFkZCh4LCB5KSB7CgkgICAgcmV0dXJuICh4ICsgeSApIHwgMAoJICAvL2xldHMgc2VlIGhvdyB0aGlzIGdvZXMgb24gdGVzdGxpbmcuCgkgIC8vICB2YXIgbHN3ID0gKHggJiAweEZGRkYpICsgKHkgJiAweEZGRkYpOwoJICAvLyAgdmFyIG1zdyA9ICh4ID4+IDE2KSArICh5ID4+IDE2KSArIChsc3cgPj4gMTYpOwoJICAvLyAgcmV0dXJuIChtc3cgPDwgMTYpIHwgKGxzdyAmIDB4RkZGRik7CgkgIH0KCgkgIC8qCgkgICAqIEJpdHdpc2Ugcm90YXRlIGEgMzItYml0IG51bWJlciB0byB0aGUgbGVmdC4KCSAgICovCgkgIGZ1bmN0aW9uIHJvbChudW0sIGNudCkgewoJICAgIHJldHVybiAobnVtIDw8IGNudCkgfCAobnVtID4+PiAoMzIgLSBjbnQpKTsKCSAgfQoKCSAgcmV0dXJuIFNoYTEKCX0KCgovKioqLyB9LAovKiAxNSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsLCBwcm9jZXNzKSB7Ly8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuCgkvLwoJLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKCS8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKCS8vICJTb2Z0d2FyZSIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcKCS8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwKCS8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQKCS8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZQoJLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6CgkvLwoJLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQKCS8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgoJLy8KCS8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTCgkvLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GCgkvLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOCgkvLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwKCS8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUgoJLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRQoJLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KCgl2YXIgZm9ybWF0UmVnRXhwID0gLyVbc2RqJV0vZzsKCWV4cG9ydHMuZm9ybWF0ID0gZnVuY3Rpb24oZikgewoJICBpZiAoIWlzU3RyaW5nKGYpKSB7CgkgICAgdmFyIG9iamVjdHMgPSBbXTsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewoJICAgICAgb2JqZWN0cy5wdXNoKGluc3BlY3QoYXJndW1lbnRzW2ldKSk7CgkgICAgfQoJICAgIHJldHVybiBvYmplY3RzLmpvaW4oJyAnKTsKCSAgfQoKCSAgdmFyIGkgPSAxOwoJICB2YXIgYXJncyA9IGFyZ3VtZW50czsKCSAgdmFyIGxlbiA9IGFyZ3MubGVuZ3RoOwoJICB2YXIgc3RyID0gU3RyaW5nKGYpLnJlcGxhY2UoZm9ybWF0UmVnRXhwLCBmdW5jdGlvbih4KSB7CgkgICAgaWYgKHggPT09ICclJScpIHJldHVybiAnJSc7CgkgICAgaWYgKGkgPj0gbGVuKSByZXR1cm4geDsKCSAgICBzd2l0Y2ggKHgpIHsKCSAgICAgIGNhc2UgJyVzJzogcmV0dXJuIFN0cmluZyhhcmdzW2krK10pOwoJICAgICAgY2FzZSAnJWQnOiByZXR1cm4gTnVtYmVyKGFyZ3NbaSsrXSk7CgkgICAgICBjYXNlICclaic6CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGFyZ3NbaSsrXSk7CgkgICAgICAgIH0gY2F0Y2ggKF8pIHsKCSAgICAgICAgICByZXR1cm4gJ1tDaXJjdWxhcl0nOwoJICAgICAgICB9CgkgICAgICBkZWZhdWx0OgoJICAgICAgICByZXR1cm4geDsKCSAgICB9CgkgIH0pOwoJICBmb3IgKHZhciB4ID0gYXJnc1tpXTsgaSA8IGxlbjsgeCA9IGFyZ3NbKytpXSkgewoJICAgIGlmIChpc051bGwoeCkgfHwgIWlzT2JqZWN0KHgpKSB7CgkgICAgICBzdHIgKz0gJyAnICsgeDsKCSAgICB9IGVsc2UgewoJICAgICAgc3RyICs9ICcgJyArIGluc3BlY3QoeCk7CgkgICAgfQoJICB9CgkgIHJldHVybiBzdHI7Cgl9OwoKCgkvLyBNYXJrIHRoYXQgYSBtZXRob2Qgc2hvdWxkIG5vdCBiZSB1c2VkLgoJLy8gUmV0dXJucyBhIG1vZGlmaWVkIGZ1bmN0aW9uIHdoaWNoIHdhcm5zIG9uY2UgYnkgZGVmYXVsdC4KCS8vIElmIC0tbm8tZGVwcmVjYXRpb24gaXMgc2V0LCB0aGVuIGl0IGlzIGEgbm8tb3AuCglleHBvcnRzLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uKGZuLCBtc2cpIHsKCSAgLy8gQWxsb3cgZm9yIGRlcHJlY2F0aW5nIHRoaW5ncyBpbiB0aGUgcHJvY2VzcyBvZiBzdGFydGluZyB1cC4KCSAgaWYgKGlzVW5kZWZpbmVkKGdsb2JhbC5wcm9jZXNzKSkgewoJICAgIHJldHVybiBmdW5jdGlvbigpIHsKCSAgICAgIHJldHVybiBleHBvcnRzLmRlcHJlY2F0ZShmbiwgbXNnKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICAgIH07CgkgIH0KCgkgIGlmIChwcm9jZXNzLm5vRGVwcmVjYXRpb24gPT09IHRydWUpIHsKCSAgICByZXR1cm4gZm47CgkgIH0KCgkgIHZhciB3YXJuZWQgPSBmYWxzZTsKCSAgZnVuY3Rpb24gZGVwcmVjYXRlZCgpIHsKCSAgICBpZiAoIXdhcm5lZCkgewoJICAgICAgaWYgKHByb2Nlc3MudGhyb3dEZXByZWNhdGlvbikgewoJICAgICAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTsKCSAgICAgIH0gZWxzZSBpZiAocHJvY2Vzcy50cmFjZURlcHJlY2F0aW9uKSB7CgkgICAgICAgIGNvbnNvbGUudHJhY2UobXNnKTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGNvbnNvbGUuZXJyb3IobXNnKTsKCSAgICAgIH0KCSAgICAgIHdhcm5lZCA9IHRydWU7CgkgICAgfQoJICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICB9CgoJICByZXR1cm4gZGVwcmVjYXRlZDsKCX07CgoKCXZhciBkZWJ1Z3MgPSB7fTsKCXZhciBkZWJ1Z0Vudmlyb247CglleHBvcnRzLmRlYnVnbG9nID0gZnVuY3Rpb24oc2V0KSB7CgkgIGlmIChpc1VuZGVmaW5lZChkZWJ1Z0Vudmlyb24pKQoJICAgIGRlYnVnRW52aXJvbiA9IHByb2Nlc3MuZW52Lk5PREVfREVCVUcgfHwgJyc7CgkgIHNldCA9IHNldC50b1VwcGVyQ2FzZSgpOwoJICBpZiAoIWRlYnVnc1tzZXRdKSB7CgkgICAgaWYgKG5ldyBSZWdFeHAoJ1xcYicgKyBzZXQgKyAnXFxiJywgJ2knKS50ZXN0KGRlYnVnRW52aXJvbikpIHsKCSAgICAgIHZhciBwaWQgPSBwcm9jZXNzLnBpZDsKCSAgICAgIGRlYnVnc1tzZXRdID0gZnVuY3Rpb24oKSB7CgkgICAgICAgIHZhciBtc2cgPSBleHBvcnRzLmZvcm1hdC5hcHBseShleHBvcnRzLCBhcmd1bWVudHMpOwoJICAgICAgICBjb25zb2xlLmVycm9yKCclcyAlZDogJXMnLCBzZXQsIHBpZCwgbXNnKTsKCSAgICAgIH07CgkgICAgfSBlbHNlIHsKCSAgICAgIGRlYnVnc1tzZXRdID0gZnVuY3Rpb24oKSB7fTsKCSAgICB9CgkgIH0KCSAgcmV0dXJuIGRlYnVnc1tzZXRdOwoJfTsKCgoJLyoqCgkgKiBFY2hvcyB0aGUgdmFsdWUgb2YgYSB2YWx1ZS4gVHJ5cyB0byBwcmludCB0aGUgdmFsdWUgb3V0CgkgKiBpbiB0aGUgYmVzdCB3YXkgcG9zc2libGUgZ2l2ZW4gdGhlIGRpZmZlcmVudCB0eXBlcy4KCSAqCgkgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gcHJpbnQgb3V0LgoJICogQHBhcmFtIHtPYmplY3R9IG9wdHMgT3B0aW9uYWwgb3B0aW9ucyBvYmplY3QgdGhhdCBhbHRlcnMgdGhlIG91dHB1dC4KCSAqLwoJLyogbGVnYWN5OiBvYmosIHNob3dIaWRkZW4sIGRlcHRoLCBjb2xvcnMqLwoJZnVuY3Rpb24gaW5zcGVjdChvYmosIG9wdHMpIHsKCSAgLy8gZGVmYXVsdCBvcHRpb25zCgkgIHZhciBjdHggPSB7CgkgICAgc2VlbjogW10sCgkgICAgc3R5bGl6ZTogc3R5bGl6ZU5vQ29sb3IKCSAgfTsKCSAgLy8gbGVnYWN5Li4uCgkgIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDMpIGN0eC5kZXB0aCA9IGFyZ3VtZW50c1syXTsKCSAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gNCkgY3R4LmNvbG9ycyA9IGFyZ3VtZW50c1szXTsKCSAgaWYgKGlzQm9vbGVhbihvcHRzKSkgewoJICAgIC8vIGxlZ2FjeS4uLgoJICAgIGN0eC5zaG93SGlkZGVuID0gb3B0czsKCSAgfSBlbHNlIGlmIChvcHRzKSB7CgkgICAgLy8gZ290IGFuICJvcHRpb25zIiBvYmplY3QKCSAgICBleHBvcnRzLl9leHRlbmQoY3R4LCBvcHRzKTsKCSAgfQoJICAvLyBzZXQgZGVmYXVsdCBvcHRpb25zCgkgIGlmIChpc1VuZGVmaW5lZChjdHguc2hvd0hpZGRlbikpIGN0eC5zaG93SGlkZGVuID0gZmFsc2U7CgkgIGlmIChpc1VuZGVmaW5lZChjdHguZGVwdGgpKSBjdHguZGVwdGggPSAyOwoJICBpZiAoaXNVbmRlZmluZWQoY3R4LmNvbG9ycykpIGN0eC5jb2xvcnMgPSBmYWxzZTsKCSAgaWYgKGlzVW5kZWZpbmVkKGN0eC5jdXN0b21JbnNwZWN0KSkgY3R4LmN1c3RvbUluc3BlY3QgPSB0cnVlOwoJICBpZiAoY3R4LmNvbG9ycykgY3R4LnN0eWxpemUgPSBzdHlsaXplV2l0aENvbG9yOwoJICByZXR1cm4gZm9ybWF0VmFsdWUoY3R4LCBvYmosIGN0eC5kZXB0aCk7Cgl9CglleHBvcnRzLmluc3BlY3QgPSBpbnNwZWN0OwoKCgkvLyBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0FOU0lfZXNjYXBlX2NvZGUjZ3JhcGhpY3MKCWluc3BlY3QuY29sb3JzID0gewoJICAnYm9sZCcgOiBbMSwgMjJdLAoJICAnaXRhbGljJyA6IFszLCAyM10sCgkgICd1bmRlcmxpbmUnIDogWzQsIDI0XSwKCSAgJ2ludmVyc2UnIDogWzcsIDI3XSwKCSAgJ3doaXRlJyA6IFszNywgMzldLAoJICAnZ3JleScgOiBbOTAsIDM5XSwKCSAgJ2JsYWNrJyA6IFszMCwgMzldLAoJICAnYmx1ZScgOiBbMzQsIDM5XSwKCSAgJ2N5YW4nIDogWzM2LCAzOV0sCgkgICdncmVlbicgOiBbMzIsIDM5XSwKCSAgJ21hZ2VudGEnIDogWzM1LCAzOV0sCgkgICdyZWQnIDogWzMxLCAzOV0sCgkgICd5ZWxsb3cnIDogWzMzLCAzOV0KCX07CgoJLy8gRG9uJ3QgdXNlICdibHVlJyBub3QgdmlzaWJsZSBvbiBjbWQuZXhlCglpbnNwZWN0LnN0eWxlcyA9IHsKCSAgJ3NwZWNpYWwnOiAnY3lhbicsCgkgICdudW1iZXInOiAneWVsbG93JywKCSAgJ2Jvb2xlYW4nOiAneWVsbG93JywKCSAgJ3VuZGVmaW5lZCc6ICdncmV5JywKCSAgJ251bGwnOiAnYm9sZCcsCgkgICdzdHJpbmcnOiAnZ3JlZW4nLAoJICAnZGF0ZSc6ICdtYWdlbnRhJywKCSAgLy8gIm5hbWUiOiBpbnRlbnRpb25hbGx5IG5vdCBzdHlsaW5nCgkgICdyZWdleHAnOiAncmVkJwoJfTsKCgoJZnVuY3Rpb24gc3R5bGl6ZVdpdGhDb2xvcihzdHIsIHN0eWxlVHlwZSkgewoJICB2YXIgc3R5bGUgPSBpbnNwZWN0LnN0eWxlc1tzdHlsZVR5cGVdOwoKCSAgaWYgKHN0eWxlKSB7CgkgICAgcmV0dXJuICdcdTAwMWJbJyArIGluc3BlY3QuY29sb3JzW3N0eWxlXVswXSArICdtJyArIHN0ciArCgkgICAgICAgICAgICdcdTAwMWJbJyArIGluc3BlY3QuY29sb3JzW3N0eWxlXVsxXSArICdtJzsKCSAgfSBlbHNlIHsKCSAgICByZXR1cm4gc3RyOwoJICB9Cgl9CgoKCWZ1bmN0aW9uIHN0eWxpemVOb0NvbG9yKHN0ciwgc3R5bGVUeXBlKSB7CgkgIHJldHVybiBzdHI7Cgl9CgoKCWZ1bmN0aW9uIGFycmF5VG9IYXNoKGFycmF5KSB7CgkgIHZhciBoYXNoID0ge307CgoJICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKHZhbCwgaWR4KSB7CgkgICAgaGFzaFt2YWxdID0gdHJ1ZTsKCSAgfSk7CgoJICByZXR1cm4gaGFzaDsKCX0KCgoJZnVuY3Rpb24gZm9ybWF0VmFsdWUoY3R4LCB2YWx1ZSwgcmVjdXJzZVRpbWVzKSB7CgkgIC8vIFByb3ZpZGUgYSBob29rIGZvciB1c2VyLXNwZWNpZmllZCBpbnNwZWN0IGZ1bmN0aW9ucy4KCSAgLy8gQ2hlY2sgdGhhdCB2YWx1ZSBpcyBhbiBvYmplY3Qgd2l0aCBhbiBpbnNwZWN0IGZ1bmN0aW9uIG9uIGl0CgkgIGlmIChjdHguY3VzdG9tSW5zcGVjdCAmJgoJICAgICAgdmFsdWUgJiYKCSAgICAgIGlzRnVuY3Rpb24odmFsdWUuaW5zcGVjdCkgJiYKCSAgICAgIC8vIEZpbHRlciBvdXQgdGhlIHV0aWwgbW9kdWxlLCBpdCdzIGluc3BlY3QgZnVuY3Rpb24gaXMgc3BlY2lhbAoJICAgICAgdmFsdWUuaW5zcGVjdCAhPT0gZXhwb3J0cy5pbnNwZWN0ICYmCgkgICAgICAvLyBBbHNvIGZpbHRlciBvdXQgYW55IHByb3RvdHlwZSBvYmplY3RzIHVzaW5nIHRoZSBjaXJjdWxhciBjaGVjay4KCSAgICAgICEodmFsdWUuY29uc3RydWN0b3IgJiYgdmFsdWUuY29uc3RydWN0b3IucHJvdG90eXBlID09PSB2YWx1ZSkpIHsKCSAgICB2YXIgcmV0ID0gdmFsdWUuaW5zcGVjdChyZWN1cnNlVGltZXMsIGN0eCk7CgkgICAgaWYgKCFpc1N0cmluZyhyZXQpKSB7CgkgICAgICByZXQgPSBmb3JtYXRWYWx1ZShjdHgsIHJldCwgcmVjdXJzZVRpbWVzKTsKCSAgICB9CgkgICAgcmV0dXJuIHJldDsKCSAgfQoKCSAgLy8gUHJpbWl0aXZlIHR5cGVzIGNhbm5vdCBoYXZlIHByb3BlcnRpZXMKCSAgdmFyIHByaW1pdGl2ZSA9IGZvcm1hdFByaW1pdGl2ZShjdHgsIHZhbHVlKTsKCSAgaWYgKHByaW1pdGl2ZSkgewoJICAgIHJldHVybiBwcmltaXRpdmU7CgkgIH0KCgkgIC8vIExvb2sgdXAgdGhlIGtleXMgb2YgdGhlIG9iamVjdC4KCSAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyh2YWx1ZSk7CgkgIHZhciB2aXNpYmxlS2V5cyA9IGFycmF5VG9IYXNoKGtleXMpOwoKCSAgaWYgKGN0eC5zaG93SGlkZGVuKSB7CgkgICAga2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHZhbHVlKTsKCSAgfQoKCSAgLy8gSUUgZG9lc24ndCBtYWtlIGVycm9yIGZpZWxkcyBub24tZW51bWVyYWJsZQoJICAvLyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvaWUvZHd3NTJzYnQodj12cy45NCkuYXNweAoJICBpZiAoaXNFcnJvcih2YWx1ZSkKCSAgICAgICYmIChrZXlzLmluZGV4T2YoJ21lc3NhZ2UnKSA+PSAwIHx8IGtleXMuaW5kZXhPZignZGVzY3JpcHRpb24nKSA+PSAwKSkgewoJICAgIHJldHVybiBmb3JtYXRFcnJvcih2YWx1ZSk7CgkgIH0KCgkgIC8vIFNvbWUgdHlwZSBvZiBvYmplY3Qgd2l0aG91dCBwcm9wZXJ0aWVzIGNhbiBiZSBzaG9ydGN1dHRlZC4KCSAgaWYgKGtleXMubGVuZ3RoID09PSAwKSB7CgkgICAgaWYgKGlzRnVuY3Rpb24odmFsdWUpKSB7CgkgICAgICB2YXIgbmFtZSA9IHZhbHVlLm5hbWUgPyAnOiAnICsgdmFsdWUubmFtZSA6ICcnOwoJICAgICAgcmV0dXJuIGN0eC5zdHlsaXplKCdbRnVuY3Rpb24nICsgbmFtZSArICddJywgJ3NwZWNpYWwnKTsKCSAgICB9CgkgICAgaWYgKGlzUmVnRXhwKHZhbHVlKSkgewoJICAgICAgcmV0dXJuIGN0eC5zdHlsaXplKFJlZ0V4cC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSksICdyZWdleHAnKTsKCSAgICB9CgkgICAgaWYgKGlzRGF0ZSh2YWx1ZSkpIHsKCSAgICAgIHJldHVybiBjdHguc3R5bGl6ZShEYXRlLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSwgJ2RhdGUnKTsKCSAgICB9CgkgICAgaWYgKGlzRXJyb3IodmFsdWUpKSB7CgkgICAgICByZXR1cm4gZm9ybWF0RXJyb3IodmFsdWUpOwoJICAgIH0KCSAgfQoKCSAgdmFyIGJhc2UgPSAnJywgYXJyYXkgPSBmYWxzZSwgYnJhY2VzID0gWyd7JywgJ30nXTsKCgkgIC8vIE1ha2UgQXJyYXkgc2F5IHRoYXQgdGhleSBhcmUgQXJyYXkKCSAgaWYgKGlzQXJyYXkodmFsdWUpKSB7CgkgICAgYXJyYXkgPSB0cnVlOwoJICAgIGJyYWNlcyA9IFsnWycsICddJ107CgkgIH0KCgkgIC8vIE1ha2UgZnVuY3Rpb25zIHNheSB0aGF0IHRoZXkgYXJlIGZ1bmN0aW9ucwoJICBpZiAoaXNGdW5jdGlvbih2YWx1ZSkpIHsKCSAgICB2YXIgbiA9IHZhbHVlLm5hbWUgPyAnOiAnICsgdmFsdWUubmFtZSA6ICcnOwoJICAgIGJhc2UgPSAnIFtGdW5jdGlvbicgKyBuICsgJ10nOwoJICB9CgoJICAvLyBNYWtlIFJlZ0V4cHMgc2F5IHRoYXQgdGhleSBhcmUgUmVnRXhwcwoJICBpZiAoaXNSZWdFeHAodmFsdWUpKSB7CgkgICAgYmFzZSA9ICcgJyArIFJlZ0V4cC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSk7CgkgIH0KCgkgIC8vIE1ha2UgZGF0ZXMgd2l0aCBwcm9wZXJ0aWVzIGZpcnN0IHNheSB0aGUgZGF0ZQoJICBpZiAoaXNEYXRlKHZhbHVlKSkgewoJICAgIGJhc2UgPSAnICcgKyBEYXRlLnByb3RvdHlwZS50b1VUQ1N0cmluZy5jYWxsKHZhbHVlKTsKCSAgfQoKCSAgLy8gTWFrZSBlcnJvciB3aXRoIG1lc3NhZ2UgZmlyc3Qgc2F5IHRoZSBlcnJvcgoJICBpZiAoaXNFcnJvcih2YWx1ZSkpIHsKCSAgICBiYXNlID0gJyAnICsgZm9ybWF0RXJyb3IodmFsdWUpOwoJICB9CgoJICBpZiAoa2V5cy5sZW5ndGggPT09IDAgJiYgKCFhcnJheSB8fCB2YWx1ZS5sZW5ndGggPT0gMCkpIHsKCSAgICByZXR1cm4gYnJhY2VzWzBdICsgYmFzZSArIGJyYWNlc1sxXTsKCSAgfQoKCSAgaWYgKHJlY3Vyc2VUaW1lcyA8IDApIHsKCSAgICBpZiAoaXNSZWdFeHAodmFsdWUpKSB7CgkgICAgICByZXR1cm4gY3R4LnN0eWxpemUoUmVnRXhwLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSwgJ3JlZ2V4cCcpOwoJICAgIH0gZWxzZSB7CgkgICAgICByZXR1cm4gY3R4LnN0eWxpemUoJ1tPYmplY3RdJywgJ3NwZWNpYWwnKTsKCSAgICB9CgkgIH0KCgkgIGN0eC5zZWVuLnB1c2godmFsdWUpOwoKCSAgdmFyIG91dHB1dDsKCSAgaWYgKGFycmF5KSB7CgkgICAgb3V0cHV0ID0gZm9ybWF0QXJyYXkoY3R4LCB2YWx1ZSwgcmVjdXJzZVRpbWVzLCB2aXNpYmxlS2V5cywga2V5cyk7CgkgIH0gZWxzZSB7CgkgICAgb3V0cHV0ID0ga2V5cy5tYXAoZnVuY3Rpb24oa2V5KSB7CgkgICAgICByZXR1cm4gZm9ybWF0UHJvcGVydHkoY3R4LCB2YWx1ZSwgcmVjdXJzZVRpbWVzLCB2aXNpYmxlS2V5cywga2V5LCBhcnJheSk7CgkgICAgfSk7CgkgIH0KCgkgIGN0eC5zZWVuLnBvcCgpOwoKCSAgcmV0dXJuIHJlZHVjZVRvU2luZ2xlU3RyaW5nKG91dHB1dCwgYmFzZSwgYnJhY2VzKTsKCX0KCgoJZnVuY3Rpb24gZm9ybWF0UHJpbWl0aXZlKGN0eCwgdmFsdWUpIHsKCSAgaWYgKGlzVW5kZWZpbmVkKHZhbHVlKSkKCSAgICByZXR1cm4gY3R4LnN0eWxpemUoJ3VuZGVmaW5lZCcsICd1bmRlZmluZWQnKTsKCSAgaWYgKGlzU3RyaW5nKHZhbHVlKSkgewoJICAgIHZhciBzaW1wbGUgPSAnXCcnICsgSlNPTi5zdHJpbmdpZnkodmFsdWUpLnJlcGxhY2UoL14ifCIkL2csICcnKQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLycvZywgIlxcJyIpCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwiL2csICciJykgKyAnXCcnOwoJICAgIHJldHVybiBjdHguc3R5bGl6ZShzaW1wbGUsICdzdHJpbmcnKTsKCSAgfQoJICBpZiAoaXNOdW1iZXIodmFsdWUpKQoJICAgIHJldHVybiBjdHguc3R5bGl6ZSgnJyArIHZhbHVlLCAnbnVtYmVyJyk7CgkgIGlmIChpc0Jvb2xlYW4odmFsdWUpKQoJICAgIHJldHVybiBjdHguc3R5bGl6ZSgnJyArIHZhbHVlLCAnYm9vbGVhbicpOwoJICAvLyBGb3Igc29tZSByZWFzb24gdHlwZW9mIG51bGwgaXMgIm9iamVjdCIsIHNvIHNwZWNpYWwgY2FzZSBoZXJlLgoJICBpZiAoaXNOdWxsKHZhbHVlKSkKCSAgICByZXR1cm4gY3R4LnN0eWxpemUoJ251bGwnLCAnbnVsbCcpOwoJfQoKCglmdW5jdGlvbiBmb3JtYXRFcnJvcih2YWx1ZSkgewoJICByZXR1cm4gJ1snICsgRXJyb3IucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpICsgJ10nOwoJfQoKCglmdW5jdGlvbiBmb3JtYXRBcnJheShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMsIHZpc2libGVLZXlzLCBrZXlzKSB7CgkgIHZhciBvdXRwdXQgPSBbXTsKCSAgZm9yICh2YXIgaSA9IDAsIGwgPSB2YWx1ZS5sZW5ndGg7IGkgPCBsOyArK2kpIHsKCSAgICBpZiAoaGFzT3duUHJvcGVydHkodmFsdWUsIFN0cmluZyhpKSkpIHsKCSAgICAgIG91dHB1dC5wdXNoKGZvcm1hdFByb3BlcnR5KGN0eCwgdmFsdWUsIHJlY3Vyc2VUaW1lcywgdmlzaWJsZUtleXMsCgkgICAgICAgICAgU3RyaW5nKGkpLCB0cnVlKSk7CgkgICAgfSBlbHNlIHsKCSAgICAgIG91dHB1dC5wdXNoKCcnKTsKCSAgICB9CgkgIH0KCSAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJICAgIGlmICgha2V5Lm1hdGNoKC9eXGQrJC8pKSB7CgkgICAgICBvdXRwdXQucHVzaChmb3JtYXRQcm9wZXJ0eShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMsIHZpc2libGVLZXlzLAoJICAgICAgICAgIGtleSwgdHJ1ZSkpOwoJICAgIH0KCSAgfSk7CgkgIHJldHVybiBvdXRwdXQ7Cgl9CgoKCWZ1bmN0aW9uIGZvcm1hdFByb3BlcnR5KGN0eCwgdmFsdWUsIHJlY3Vyc2VUaW1lcywgdmlzaWJsZUtleXMsIGtleSwgYXJyYXkpIHsKCSAgdmFyIG5hbWUsIHN0ciwgZGVzYzsKCSAgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodmFsdWUsIGtleSkgfHwgeyB2YWx1ZTogdmFsdWVba2V5XSB9OwoJICBpZiAoZGVzYy5nZXQpIHsKCSAgICBpZiAoZGVzYy5zZXQpIHsKCSAgICAgIHN0ciA9IGN0eC5zdHlsaXplKCdbR2V0dGVyL1NldHRlcl0nLCAnc3BlY2lhbCcpOwoJICAgIH0gZWxzZSB7CgkgICAgICBzdHIgPSBjdHguc3R5bGl6ZSgnW0dldHRlcl0nLCAnc3BlY2lhbCcpOwoJICAgIH0KCSAgfSBlbHNlIHsKCSAgICBpZiAoZGVzYy5zZXQpIHsKCSAgICAgIHN0ciA9IGN0eC5zdHlsaXplKCdbU2V0dGVyXScsICdzcGVjaWFsJyk7CgkgICAgfQoJICB9CgkgIGlmICghaGFzT3duUHJvcGVydHkodmlzaWJsZUtleXMsIGtleSkpIHsKCSAgICBuYW1lID0gJ1snICsga2V5ICsgJ10nOwoJICB9CgkgIGlmICghc3RyKSB7CgkgICAgaWYgKGN0eC5zZWVuLmluZGV4T2YoZGVzYy52YWx1ZSkgPCAwKSB7CgkgICAgICBpZiAoaXNOdWxsKHJlY3Vyc2VUaW1lcykpIHsKCSAgICAgICAgc3RyID0gZm9ybWF0VmFsdWUoY3R4LCBkZXNjLnZhbHVlLCBudWxsKTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIHN0ciA9IGZvcm1hdFZhbHVlKGN0eCwgZGVzYy52YWx1ZSwgcmVjdXJzZVRpbWVzIC0gMSk7CgkgICAgICB9CgkgICAgICBpZiAoc3RyLmluZGV4T2YoJ1xuJykgPiAtMSkgewoJICAgICAgICBpZiAoYXJyYXkpIHsKCSAgICAgICAgICBzdHIgPSBzdHIuc3BsaXQoJ1xuJykubWFwKGZ1bmN0aW9uKGxpbmUpIHsKCSAgICAgICAgICAgIHJldHVybiAnICAnICsgbGluZTsKCSAgICAgICAgICB9KS5qb2luKCdcbicpLnN1YnN0cigyKTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICBzdHIgPSAnXG4nICsgc3RyLnNwbGl0KCdcbicpLm1hcChmdW5jdGlvbihsaW5lKSB7CgkgICAgICAgICAgICByZXR1cm4gJyAgICcgKyBsaW5lOwoJICAgICAgICAgIH0pLmpvaW4oJ1xuJyk7CgkgICAgICAgIH0KCSAgICAgIH0KCSAgICB9IGVsc2UgewoJICAgICAgc3RyID0gY3R4LnN0eWxpemUoJ1tDaXJjdWxhcl0nLCAnc3BlY2lhbCcpOwoJICAgIH0KCSAgfQoJICBpZiAoaXNVbmRlZmluZWQobmFtZSkpIHsKCSAgICBpZiAoYXJyYXkgJiYga2V5Lm1hdGNoKC9eXGQrJC8pKSB7CgkgICAgICByZXR1cm4gc3RyOwoJICAgIH0KCSAgICBuYW1lID0gSlNPTi5zdHJpbmdpZnkoJycgKyBrZXkpOwoJICAgIGlmIChuYW1lLm1hdGNoKC9eIihbYS16QS1aX11bYS16QS1aXzAtOV0qKSIkLykpIHsKCSAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cigxLCBuYW1lLmxlbmd0aCAtIDIpOwoJICAgICAgbmFtZSA9IGN0eC5zdHlsaXplKG5hbWUsICduYW1lJyk7CgkgICAgfSBlbHNlIHsKCSAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoLycvZywgIlxcJyIpCgkgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXCIvZywgJyInKQoJICAgICAgICAgICAgICAgICAucmVwbGFjZSgvKF4ifCIkKS9nLCAiJyIpOwoJICAgICAgbmFtZSA9IGN0eC5zdHlsaXplKG5hbWUsICdzdHJpbmcnKTsKCSAgICB9CgkgIH0KCgkgIHJldHVybiBuYW1lICsgJzogJyArIHN0cjsKCX0KCgoJZnVuY3Rpb24gcmVkdWNlVG9TaW5nbGVTdHJpbmcob3V0cHV0LCBiYXNlLCBicmFjZXMpIHsKCSAgdmFyIG51bUxpbmVzRXN0ID0gMDsKCSAgdmFyIGxlbmd0aCA9IG91dHB1dC5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgY3VyKSB7CgkgICAgbnVtTGluZXNFc3QrKzsKCSAgICBpZiAoY3VyLmluZGV4T2YoJ1xuJykgPj0gMCkgbnVtTGluZXNFc3QrKzsKCSAgICByZXR1cm4gcHJldiArIGN1ci5yZXBsYWNlKC9cdTAwMWJcW1xkXGQ/bS9nLCAnJykubGVuZ3RoICsgMTsKCSAgfSwgMCk7CgoJICBpZiAobGVuZ3RoID4gNjApIHsKCSAgICByZXR1cm4gYnJhY2VzWzBdICsKCSAgICAgICAgICAgKGJhc2UgPT09ICcnID8gJycgOiBiYXNlICsgJ1xuICcpICsKCSAgICAgICAgICAgJyAnICsKCSAgICAgICAgICAgb3V0cHV0LmpvaW4oJyxcbiAgJykgKwoJICAgICAgICAgICAnICcgKwoJICAgICAgICAgICBicmFjZXNbMV07CgkgIH0KCgkgIHJldHVybiBicmFjZXNbMF0gKyBiYXNlICsgJyAnICsgb3V0cHV0LmpvaW4oJywgJykgKyAnICcgKyBicmFjZXNbMV07Cgl9CgoKCS8vIE5PVEU6IFRoZXNlIHR5cGUgY2hlY2tpbmcgZnVuY3Rpb25zIGludGVudGlvbmFsbHkgZG9uJ3QgdXNlIGBpbnN0YW5jZW9mYAoJLy8gYmVjYXVzZSBpdCBpcyBmcmFnaWxlIGFuZCBjYW4gYmUgZWFzaWx5IGZha2VkIHdpdGggYE9iamVjdC5jcmVhdGUoKWAuCglmdW5jdGlvbiBpc0FycmF5KGFyKSB7CgkgIHJldHVybiBBcnJheS5pc0FycmF5KGFyKTsKCX0KCWV4cG9ydHMuaXNBcnJheSA9IGlzQXJyYXk7CgoJZnVuY3Rpb24gaXNCb29sZWFuKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Jvb2xlYW4nOwoJfQoJZXhwb3J0cy5pc0Jvb2xlYW4gPSBpc0Jvb2xlYW47CgoJZnVuY3Rpb24gaXNOdWxsKGFyZykgewoJICByZXR1cm4gYXJnID09PSBudWxsOwoJfQoJZXhwb3J0cy5pc051bGwgPSBpc051bGw7CgoJZnVuY3Rpb24gaXNOdWxsT3JVbmRlZmluZWQoYXJnKSB7CgkgIHJldHVybiBhcmcgPT0gbnVsbDsKCX0KCWV4cG9ydHMuaXNOdWxsT3JVbmRlZmluZWQgPSBpc051bGxPclVuZGVmaW5lZDsKCglmdW5jdGlvbiBpc051bWJlcihhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdudW1iZXInOwoJfQoJZXhwb3J0cy5pc051bWJlciA9IGlzTnVtYmVyOwoKCWZ1bmN0aW9uIGlzU3RyaW5nKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ3N0cmluZyc7Cgl9CglleHBvcnRzLmlzU3RyaW5nID0gaXNTdHJpbmc7CgoJZnVuY3Rpb24gaXNTeW1ib2woYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnc3ltYm9sJzsKCX0KCWV4cG9ydHMuaXNTeW1ib2wgPSBpc1N5bWJvbDsKCglmdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHsKCSAgcmV0dXJuIGFyZyA9PT0gdm9pZCAwOwoJfQoJZXhwb3J0cy5pc1VuZGVmaW5lZCA9IGlzVW5kZWZpbmVkOwoKCWZ1bmN0aW9uIGlzUmVnRXhwKHJlKSB7CgkgIHJldHVybiBpc09iamVjdChyZSkgJiYgb2JqZWN0VG9TdHJpbmcocmUpID09PSAnW29iamVjdCBSZWdFeHBdJzsKCX0KCWV4cG9ydHMuaXNSZWdFeHAgPSBpc1JlZ0V4cDsKCglmdW5jdGlvbiBpc09iamVjdChhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdvYmplY3QnICYmIGFyZyAhPT0gbnVsbDsKCX0KCWV4cG9ydHMuaXNPYmplY3QgPSBpc09iamVjdDsKCglmdW5jdGlvbiBpc0RhdGUoZCkgewoJICByZXR1cm4gaXNPYmplY3QoZCkgJiYgb2JqZWN0VG9TdHJpbmcoZCkgPT09ICdbb2JqZWN0IERhdGVdJzsKCX0KCWV4cG9ydHMuaXNEYXRlID0gaXNEYXRlOwoKCWZ1bmN0aW9uIGlzRXJyb3IoZSkgewoJICByZXR1cm4gaXNPYmplY3QoZSkgJiYKCSAgICAgIChvYmplY3RUb1N0cmluZyhlKSA9PT0gJ1tvYmplY3QgRXJyb3JdJyB8fCBlIGluc3RhbmNlb2YgRXJyb3IpOwoJfQoJZXhwb3J0cy5pc0Vycm9yID0gaXNFcnJvcjsKCglmdW5jdGlvbiBpc0Z1bmN0aW9uKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Z1bmN0aW9uJzsKCX0KCWV4cG9ydHMuaXNGdW5jdGlvbiA9IGlzRnVuY3Rpb247CgoJZnVuY3Rpb24gaXNQcmltaXRpdmUoYXJnKSB7CgkgIHJldHVybiBhcmcgPT09IG51bGwgfHwKCSAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdib29sZWFuJyB8fAoJICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ251bWJlcicgfHwKCSAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnIHx8CgkgICAgICAgICB0eXBlb2YgYXJnID09PSAnc3ltYm9sJyB8fCAgLy8gRVM2IHN5bWJvbAoJICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ3VuZGVmaW5lZCc7Cgl9CglleHBvcnRzLmlzUHJpbWl0aXZlID0gaXNQcmltaXRpdmU7CgoJZXhwb3J0cy5pc0J1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpOwoKCWZ1bmN0aW9uIG9iamVjdFRvU3RyaW5nKG8pIHsKCSAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKTsKCX0KCgoJZnVuY3Rpb24gcGFkKG4pIHsKCSAgcmV0dXJuIG4gPCAxMCA/ICcwJyArIG4udG9TdHJpbmcoMTApIDogbi50b1N0cmluZygxMCk7Cgl9CgoKCXZhciBtb250aHMgPSBbJ0phbicsICdGZWInLCAnTWFyJywgJ0FwcicsICdNYXknLCAnSnVuJywgJ0p1bCcsICdBdWcnLCAnU2VwJywKCSAgICAgICAgICAgICAgJ09jdCcsICdOb3YnLCAnRGVjJ107CgoJLy8gMjYgRmViIDE2OjE5OjM0CglmdW5jdGlvbiB0aW1lc3RhbXAoKSB7CgkgIHZhciBkID0gbmV3IERhdGUoKTsKCSAgdmFyIHRpbWUgPSBbcGFkKGQuZ2V0SG91cnMoKSksCgkgICAgICAgICAgICAgIHBhZChkLmdldE1pbnV0ZXMoKSksCgkgICAgICAgICAgICAgIHBhZChkLmdldFNlY29uZHMoKSldLmpvaW4oJzonKTsKCSAgcmV0dXJuIFtkLmdldERhdGUoKSwgbW9udGhzW2QuZ2V0TW9udGgoKV0sIHRpbWVdLmpvaW4oJyAnKTsKCX0KCgoJLy8gbG9nIGlzIGp1c3QgYSB0aGluIHdyYXBwZXIgdG8gY29uc29sZS5sb2cgdGhhdCBwcmVwZW5kcyBhIHRpbWVzdGFtcAoJZXhwb3J0cy5sb2cgPSBmdW5jdGlvbigpIHsKCSAgY29uc29sZS5sb2coJyVzIC0gJXMnLCB0aW1lc3RhbXAoKSwgZXhwb3J0cy5mb3JtYXQuYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKSk7Cgl9OwoKCgkvKioKCSAqIEluaGVyaXQgdGhlIHByb3RvdHlwZSBtZXRob2RzIGZyb20gb25lIGNvbnN0cnVjdG9yIGludG8gYW5vdGhlci4KCSAqCgkgKiBUaGUgRnVuY3Rpb24ucHJvdG90eXBlLmluaGVyaXRzIGZyb20gbGFuZy5qcyByZXdyaXR0ZW4gYXMgYSBzdGFuZGFsb25lCgkgKiBmdW5jdGlvbiAobm90IG9uIEZ1bmN0aW9uLnByb3RvdHlwZSkuIE5PVEU6IElmIHRoaXMgZmlsZSBpcyB0byBiZSBsb2FkZWQKCSAqIGR1cmluZyBib290c3RyYXBwaW5nIHRoaXMgZnVuY3Rpb24gbmVlZHMgdG8gYmUgcmV3cml0dGVuIHVzaW5nIHNvbWUgbmF0aXZlCgkgKiBmdW5jdGlvbnMgYXMgcHJvdG90eXBlIHNldHVwIHVzaW5nIG5vcm1hbCBKYXZhU2NyaXB0IGRvZXMgbm90IHdvcmsgYXMKCSAqIGV4cGVjdGVkIGR1cmluZyBib290c3RyYXBwaW5nIChzZWUgbWlycm9yLmpzIGluIHIxMTQ5MDMpLgoJICoKCSAqIEBwYXJhbSB7ZnVuY3Rpb259IGN0b3IgQ29uc3RydWN0b3IgZnVuY3Rpb24gd2hpY2ggbmVlZHMgdG8gaW5oZXJpdCB0aGUKCSAqICAgICBwcm90b3R5cGUuCgkgKiBAcGFyYW0ge2Z1bmN0aW9ufSBzdXBlckN0b3IgQ29uc3RydWN0b3IgZnVuY3Rpb24gdG8gaW5oZXJpdCBwcm90b3R5cGUgZnJvbS4KCSAqLwoJZXhwb3J0cy5pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpOwoKCWV4cG9ydHMuX2V4dGVuZCA9IGZ1bmN0aW9uKG9yaWdpbiwgYWRkKSB7CgkgIC8vIERvbid0IGRvIGFueXRoaW5nIGlmIGFkZCBpc24ndCBhbiBvYmplY3QKCSAgaWYgKCFhZGQgfHwgIWlzT2JqZWN0KGFkZCkpIHJldHVybiBvcmlnaW47CgoJICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGFkZCk7CgkgIHZhciBpID0ga2V5cy5sZW5ndGg7CgkgIHdoaWxlIChpLS0pIHsKCSAgICBvcmlnaW5ba2V5c1tpXV0gPSBhZGRba2V5c1tpXV07CgkgIH0KCSAgcmV0dXJuIG9yaWdpbjsKCX07CgoJZnVuY3Rpb24gaGFzT3duUHJvcGVydHkob2JqLCBwcm9wKSB7CgkgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsKCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSwgX193ZWJwYWNrX3JlcXVpcmVfXygxNikpKQoKLyoqKi8gfSwKLyogMTYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyCgl2YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307CgoJLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0CgkvLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXMKCS8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGEKCS8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuCgoJdmFyIGNhY2hlZFNldFRpbWVvdXQ7Cgl2YXIgY2FjaGVkQ2xlYXJUaW1lb3V0OwoKCWZ1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKCdzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7Cgl9CglmdW5jdGlvbiBkZWZhdWx0Q2xlYXJUaW1lb3V0ICgpIHsKCSAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpOwoJfQoJKGZ1bmN0aW9uICgpIHsKCSAgICB0cnkgewoJICAgICAgICBpZiAodHlwZW9mIHNldFRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHsKCSAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0OwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7CgkgICAgICAgIH0KCSAgICB9IGNhdGNoIChlKSB7CgkgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0OwoJICAgIH0KCSAgICB0cnkgewoJICAgICAgICBpZiAodHlwZW9mIGNsZWFyVGltZW91dCA9PT0gJ2Z1bmN0aW9uJykgewoJICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0OwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDsKCSAgICAgICAgfQoJICAgIH0gY2F0Y2ggKGUpIHsKCSAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDsKCSAgICB9Cgl9ICgpKQoJZnVuY3Rpb24gcnVuVGltZW91dChmdW4pIHsKCSAgICBpZiAoY2FjaGVkU2V0VGltZW91dCA9PT0gc2V0VGltZW91dCkgewoJICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnMKCSAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTsKCSAgICB9CgkgICAgLy8gaWYgc2V0VGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWQKCSAgICBpZiAoKGNhY2hlZFNldFRpbWVvdXQgPT09IGRlZmF1bHRTZXRUaW1vdXQgfHwgIWNhY2hlZFNldFRpbWVvdXQpICYmIHNldFRpbWVvdXQpIHsKCSAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7CgkgICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7CgkgICAgfQoJICAgIHRyeSB7CgkgICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3MKCSAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQoZnVuLCAwKTsKCSAgICB9IGNhdGNoKGUpewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0IHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5CgkgICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKG51bGwsIGZ1biwgMCk7CgkgICAgICAgIH0gY2F0Y2goZSl7CgkgICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvcgoJICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbCh0aGlzLCBmdW4sIDApOwoJICAgICAgICB9CgkgICAgfQoKCgl9CglmdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7CgkgICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7CgkgICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9ucwoJICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7CgkgICAgfQoJICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWQKCSAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHsKCSAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0OwoJICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7CgkgICAgfQoJICAgIHRyeSB7CgkgICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3MKCSAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpOwoJICAgIH0gY2F0Y2ggKGUpewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseQoJICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7CgkgICAgICAgIH0gY2F0Y2ggKGUpewoJICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuCgkgICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0CgkgICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTsKCSAgICAgICAgfQoJICAgIH0KCgoKCX0KCXZhciBxdWV1ZSA9IFtdOwoJdmFyIGRyYWluaW5nID0gZmFsc2U7Cgl2YXIgY3VycmVudFF1ZXVlOwoJdmFyIHF1ZXVlSW5kZXggPSAtMTsKCglmdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7CgkgICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7CgkgICAgICAgIHJldHVybjsKCSAgICB9CgkgICAgZHJhaW5pbmcgPSBmYWxzZTsKCSAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkgewoJICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpOwoJICAgIH0gZWxzZSB7CgkgICAgICAgIHF1ZXVlSW5kZXggPSAtMTsKCSAgICB9CgkgICAgaWYgKHF1ZXVlLmxlbmd0aCkgewoJICAgICAgICBkcmFpblF1ZXVlKCk7CgkgICAgfQoJfQoKCWZ1bmN0aW9uIGRyYWluUXVldWUoKSB7CgkgICAgaWYgKGRyYWluaW5nKSB7CgkgICAgICAgIHJldHVybjsKCSAgICB9CgkgICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7CgkgICAgZHJhaW5pbmcgPSB0cnVlOwoKCSAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoOwoJICAgIHdoaWxlKGxlbikgewoJICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTsKCSAgICAgICAgcXVldWUgPSBbXTsKCSAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikgewoJICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkgewoJICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBxdWV1ZUluZGV4ID0gLTE7CgkgICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDsKCSAgICB9CgkgICAgY3VycmVudFF1ZXVlID0gbnVsbDsKCSAgICBkcmFpbmluZyA9IGZhbHNlOwoJICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTsKCX0KCglwcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikgewoJICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTsKCSAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldOwoJICAgICAgICB9CgkgICAgfQoJICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7CgkgICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHsKCSAgICAgICAgcnVuVGltZW91dChkcmFpblF1ZXVlKTsKCSAgICB9Cgl9OwoKCS8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHMKCWZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkgewoJICAgIHRoaXMuZnVuID0gZnVuOwoJICAgIHRoaXMuYXJyYXkgPSBhcnJheTsKCX0KCUl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHsKCSAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTsKCX07Cglwcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInOwoJcHJvY2Vzcy5icm93c2VyID0gdHJ1ZTsKCXByb2Nlc3MuZW52ID0ge307Cglwcm9jZXNzLmFyZ3YgPSBbXTsKCXByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3VlcwoJcHJvY2Vzcy52ZXJzaW9ucyA9IHt9OwoKCWZ1bmN0aW9uIG5vb3AoKSB7fQoKCXByb2Nlc3Mub24gPSBub29wOwoJcHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7Cglwcm9jZXNzLm9uY2UgPSBub29wOwoJcHJvY2Vzcy5vZmYgPSBub29wOwoJcHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7Cglwcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7Cglwcm9jZXNzLmVtaXQgPSBub29wOwoKCXByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpOwoJfTsKCglwcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9OwoJcHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHsKCSAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpOwoJfTsKCXByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07CgoKLyoqKi8gfSwKLyogMTcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpc0J1ZmZlcihhcmcpIHsKCSAgcmV0dXJuIGFyZyAmJiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JwoJICAgICYmIHR5cGVvZiBhcmcuY29weSA9PT0gJ2Z1bmN0aW9uJwoJICAgICYmIHR5cGVvZiBhcmcuZmlsbCA9PT0gJ2Z1bmN0aW9uJwoJICAgICYmIHR5cGVvZiBhcmcucmVhZFVJbnQ4ID09PSAnZnVuY3Rpb24nOwoJfQoKLyoqKi8gfSwKLyogMTggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJaWYgKHR5cGVvZiBPYmplY3QuY3JlYXRlID09PSAnZnVuY3Rpb24nKSB7CgkgIC8vIGltcGxlbWVudGF0aW9uIGZyb20gc3RhbmRhcmQgbm9kZS5qcyAndXRpbCcgbW9kdWxlCgkgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaW5oZXJpdHMoY3Rvciwgc3VwZXJDdG9yKSB7CgkgICAgY3Rvci5zdXBlcl8gPSBzdXBlckN0b3IKCSAgICBjdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDdG9yLnByb3RvdHlwZSwgewoJICAgICAgY29uc3RydWN0b3I6IHsKCSAgICAgICAgdmFsdWU6IGN0b3IsCgkgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLAoJICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlCgkgICAgICB9CgkgICAgfSk7CgkgIH07Cgl9IGVsc2UgewoJICAvLyBvbGQgc2Nob29sIHNoaW0gZm9yIG9sZCBicm93c2VycwoJICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluaGVyaXRzKGN0b3IsIHN1cGVyQ3RvcikgewoJICAgIGN0b3Iuc3VwZXJfID0gc3VwZXJDdG9yCgkgICAgdmFyIFRlbXBDdG9yID0gZnVuY3Rpb24gKCkge30KCSAgICBUZW1wQ3Rvci5wcm90b3R5cGUgPSBzdXBlckN0b3IucHJvdG90eXBlCgkgICAgY3Rvci5wcm90b3R5cGUgPSBuZXcgVGVtcEN0b3IoKQoJICAgIGN0b3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gY3RvcgoJICB9Cgl9CgoKLyoqKi8gfSwKLyogMTkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJCgkvKioKCSAqIEEgSmF2YVNjcmlwdCBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgU2VjdXJlIEhhc2ggQWxnb3JpdGhtLCBTSEEtMjU2LCBhcyBkZWZpbmVkCgkgKiBpbiBGSVBTIDE4MC0yCgkgKiBWZXJzaW9uIDIuMi1iZXRhIENvcHlyaWdodCBBbmdlbCBNYXJpbiwgUGF1bCBKb2huc3RvbiAyMDAwIC0gMjAwOS4KCSAqIE90aGVyIGNvbnRyaWJ1dG9yczogR3JlZyBIb2x0LCBBbmRyZXcgS2VwZXJ0LCBZZG5hciwgTG9zdGluZXQKCSAqCgkgKi8KCgl2YXIgaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KS5pbmhlcml0cwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEJ1ZmZlciwgSGFzaCkgewoKCSAgdmFyIEsgPSBbCgkgICAgICAweDQyOEEyRjk4LCAweDcxMzc0NDkxLCAweEI1QzBGQkNGLCAweEU5QjVEQkE1LAoJICAgICAgMHgzOTU2QzI1QiwgMHg1OUYxMTFGMSwgMHg5MjNGODJBNCwgMHhBQjFDNUVENSwKCSAgICAgIDB4RDgwN0FBOTgsIDB4MTI4MzVCMDEsIDB4MjQzMTg1QkUsIDB4NTUwQzdEQzMsCgkgICAgICAweDcyQkU1RDc0LCAweDgwREVCMUZFLCAweDlCREMwNkE3LCAweEMxOUJGMTc0LAoJICAgICAgMHhFNDlCNjlDMSwgMHhFRkJFNDc4NiwgMHgwRkMxOURDNiwgMHgyNDBDQTFDQywKCSAgICAgIDB4MkRFOTJDNkYsIDB4NEE3NDg0QUEsIDB4NUNCMEE5REMsIDB4NzZGOTg4REEsCgkgICAgICAweDk4M0U1MTUyLCAweEE4MzFDNjZELCAweEIwMDMyN0M4LCAweEJGNTk3RkM3LAoJICAgICAgMHhDNkUwMEJGMywgMHhENUE3OTE0NywgMHgwNkNBNjM1MSwgMHgxNDI5Mjk2NywKCSAgICAgIDB4MjdCNzBBODUsIDB4MkUxQjIxMzgsIDB4NEQyQzZERkMsIDB4NTMzODBEMTMsCgkgICAgICAweDY1MEE3MzU0LCAweDc2NkEwQUJCLCAweDgxQzJDOTJFLCAweDkyNzIyQzg1LAoJICAgICAgMHhBMkJGRThBMSwgMHhBODFBNjY0QiwgMHhDMjRCOEI3MCwgMHhDNzZDNTFBMywKCSAgICAgIDB4RDE5MkU4MTksIDB4RDY5OTA2MjQsIDB4RjQwRTM1ODUsIDB4MTA2QUEwNzAsCgkgICAgICAweDE5QTRDMTE2LCAweDFFMzc2QzA4LCAweDI3NDg3NzRDLCAweDM0QjBCQ0I1LAoJICAgICAgMHgzOTFDMENCMywgMHg0RUQ4QUE0QSwgMHg1QjlDQ0E0RiwgMHg2ODJFNkZGMywKCSAgICAgIDB4NzQ4RjgyRUUsIDB4NzhBNTYzNkYsIDB4ODRDODc4MTQsIDB4OENDNzAyMDgsCgkgICAgICAweDkwQkVGRkZBLCAweEE0NTA2Q0VCLCAweEJFRjlBM0Y3LCAweEM2NzE3OEYyCgkgICAgXQoKCSAgdmFyIFcgPSBuZXcgQXJyYXkoNjQpCgoJICBmdW5jdGlvbiBTaGEyNTYoKSB7CgkgICAgdGhpcy5pbml0KCkKCgkgICAgdGhpcy5fdyA9IFcgLy9uZXcgQXJyYXkoNjQpCgoJICAgIEhhc2guY2FsbCh0aGlzLCAxNio0LCAxNCo0KQoJICB9CgoJICBpbmhlcml0cyhTaGEyNTYsIEhhc2gpCgoJICBTaGEyNTYucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7CgoJICAgIHRoaXMuX2EgPSAweDZhMDllNjY3fDAKCSAgICB0aGlzLl9iID0gMHhiYjY3YWU4NXwwCgkgICAgdGhpcy5fYyA9IDB4M2M2ZWYzNzJ8MAoJICAgIHRoaXMuX2QgPSAweGE1NGZmNTNhfDAKCSAgICB0aGlzLl9lID0gMHg1MTBlNTI3ZnwwCgkgICAgdGhpcy5fZiA9IDB4OWIwNTY4OGN8MAoJICAgIHRoaXMuX2cgPSAweDFmODNkOWFifDAKCSAgICB0aGlzLl9oID0gMHg1YmUwY2QxOXwwCgoJICAgIHRoaXMuX2xlbiA9IHRoaXMuX3MgPSAwCgoJICAgIHJldHVybiB0aGlzCgkgIH0KCgkgIGZ1bmN0aW9uIFMgKFgsIG4pIHsKCSAgICByZXR1cm4gKFggPj4+IG4pIHwgKFggPDwgKDMyIC0gbikpOwoJICB9CgoJICBmdW5jdGlvbiBSIChYLCBuKSB7CgkgICAgcmV0dXJuIChYID4+PiBuKTsKCSAgfQoKCSAgZnVuY3Rpb24gQ2ggKHgsIHksIHopIHsKCSAgICByZXR1cm4gKCh4ICYgeSkgXiAoKH54KSAmIHopKTsKCSAgfQoKCSAgZnVuY3Rpb24gTWFqICh4LCB5LCB6KSB7CgkgICAgcmV0dXJuICgoeCAmIHkpIF4gKHggJiB6KSBeICh5ICYgeikpOwoJICB9CgoJICBmdW5jdGlvbiBTaWdtYTAyNTYgKHgpIHsKCSAgICByZXR1cm4gKFMoeCwgMikgXiBTKHgsIDEzKSBeIFMoeCwgMjIpKTsKCSAgfQoKCSAgZnVuY3Rpb24gU2lnbWExMjU2ICh4KSB7CgkgICAgcmV0dXJuIChTKHgsIDYpIF4gUyh4LCAxMSkgXiBTKHgsIDI1KSk7CgkgIH0KCgkgIGZ1bmN0aW9uIEdhbW1hMDI1NiAoeCkgewoJICAgIHJldHVybiAoUyh4LCA3KSBeIFMoeCwgMTgpIF4gUih4LCAzKSk7CgkgIH0KCgkgIGZ1bmN0aW9uIEdhbW1hMTI1NiAoeCkgewoJICAgIHJldHVybiAoUyh4LCAxNykgXiBTKHgsIDE5KSBeIFIoeCwgMTApKTsKCSAgfQoKCSAgU2hhMjU2LnByb3RvdHlwZS5fdXBkYXRlID0gZnVuY3Rpb24oTSkgewoKCSAgICB2YXIgVyA9IHRoaXMuX3cKCSAgICB2YXIgYSwgYiwgYywgZCwgZSwgZiwgZywgaAoJICAgIHZhciBUMSwgVDIKCgkgICAgYSA9IHRoaXMuX2EgfCAwCgkgICAgYiA9IHRoaXMuX2IgfCAwCgkgICAgYyA9IHRoaXMuX2MgfCAwCgkgICAgZCA9IHRoaXMuX2QgfCAwCgkgICAgZSA9IHRoaXMuX2UgfCAwCgkgICAgZiA9IHRoaXMuX2YgfCAwCgkgICAgZyA9IHRoaXMuX2cgfCAwCgkgICAgaCA9IHRoaXMuX2ggfCAwCgoJICAgIGZvciAodmFyIGogPSAwOyBqIDwgNjQ7IGorKykgewoJICAgICAgdmFyIHcgPSBXW2pdID0gaiA8IDE2CgkgICAgICAgID8gTS5yZWFkSW50MzJCRShqICogNCkKCSAgICAgICAgOiBHYW1tYTEyNTYoV1tqIC0gMl0pICsgV1tqIC0gN10gKyBHYW1tYTAyNTYoV1tqIC0gMTVdKSArIFdbaiAtIDE2XQoKCSAgICAgIFQxID0gaCArIFNpZ21hMTI1NihlKSArIENoKGUsIGYsIGcpICsgS1tqXSArIHcKCgkgICAgICBUMiA9IFNpZ21hMDI1NihhKSArIE1haihhLCBiLCBjKTsKCSAgICAgIGggPSBnOyBnID0gZjsgZiA9IGU7IGUgPSBkICsgVDE7IGQgPSBjOyBjID0gYjsgYiA9IGE7IGEgPSBUMSArIFQyOwoJICAgIH0KCgkgICAgdGhpcy5fYSA9IChhICsgdGhpcy5fYSkgfCAwCgkgICAgdGhpcy5fYiA9IChiICsgdGhpcy5fYikgfCAwCgkgICAgdGhpcy5fYyA9IChjICsgdGhpcy5fYykgfCAwCgkgICAgdGhpcy5fZCA9IChkICsgdGhpcy5fZCkgfCAwCgkgICAgdGhpcy5fZSA9IChlICsgdGhpcy5fZSkgfCAwCgkgICAgdGhpcy5fZiA9IChmICsgdGhpcy5fZikgfCAwCgkgICAgdGhpcy5fZyA9IChnICsgdGhpcy5fZykgfCAwCgkgICAgdGhpcy5faCA9IChoICsgdGhpcy5faCkgfCAwCgoJICB9OwoKCSAgU2hhMjU2LnByb3RvdHlwZS5faGFzaCA9IGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgSCA9IG5ldyBCdWZmZXIoMzIpCgoJICAgIEgud3JpdGVJbnQzMkJFKHRoaXMuX2EsICAwKQoJICAgIEgud3JpdGVJbnQzMkJFKHRoaXMuX2IsICA0KQoJICAgIEgud3JpdGVJbnQzMkJFKHRoaXMuX2MsICA4KQoJICAgIEgud3JpdGVJbnQzMkJFKHRoaXMuX2QsIDEyKQoJICAgIEgud3JpdGVJbnQzMkJFKHRoaXMuX2UsIDE2KQoJICAgIEgud3JpdGVJbnQzMkJFKHRoaXMuX2YsIDIwKQoJICAgIEgud3JpdGVJbnQzMkJFKHRoaXMuX2csIDI0KQoJICAgIEgud3JpdGVJbnQzMkJFKHRoaXMuX2gsIDI4KQoKCSAgICByZXR1cm4gSAoJICB9CgoJICByZXR1cm4gU2hhMjU2CgoJfQoKCi8qKiovIH0sCi8qIDIwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBpbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpLmluaGVyaXRzCgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoQnVmZmVyLCBIYXNoKSB7CgkgIHZhciBLID0gWwoJICAgIDB4NDI4YTJmOTgsIDB4ZDcyOGFlMjIsIDB4NzEzNzQ0OTEsIDB4MjNlZjY1Y2QsCgkgICAgMHhiNWMwZmJjZiwgMHhlYzRkM2IyZiwgMHhlOWI1ZGJhNSwgMHg4MTg5ZGJiYywKCSAgICAweDM5NTZjMjViLCAweGYzNDhiNTM4LCAweDU5ZjExMWYxLCAweGI2MDVkMDE5LAoJICAgIDB4OTIzZjgyYTQsIDB4YWYxOTRmOWIsIDB4YWIxYzVlZDUsIDB4ZGE2ZDgxMTgsCgkgICAgMHhkODA3YWE5OCwgMHhhMzAzMDI0MiwgMHgxMjgzNWIwMSwgMHg0NTcwNmZiZSwKCSAgICAweDI0MzE4NWJlLCAweDRlZTRiMjhjLCAweDU1MGM3ZGMzLCAweGQ1ZmZiNGUyLAoJICAgIDB4NzJiZTVkNzQsIDB4ZjI3Yjg5NmYsIDB4ODBkZWIxZmUsIDB4M2IxNjk2YjEsCgkgICAgMHg5YmRjMDZhNywgMHgyNWM3MTIzNSwgMHhjMTliZjE3NCwgMHhjZjY5MjY5NCwKCSAgICAweGU0OWI2OWMxLCAweDllZjE0YWQyLCAweGVmYmU0Nzg2LCAweDM4NGYyNWUzLAoJICAgIDB4MGZjMTlkYzYsIDB4OGI4Y2Q1YjUsIDB4MjQwY2ExY2MsIDB4NzdhYzljNjUsCgkgICAgMHgyZGU5MmM2ZiwgMHg1OTJiMDI3NSwgMHg0YTc0ODRhYSwgMHg2ZWE2ZTQ4MywKCSAgICAweDVjYjBhOWRjLCAweGJkNDFmYmQ0LCAweDc2Zjk4OGRhLCAweDgzMTE1M2I1LAoJICAgIDB4OTgzZTUxNTIsIDB4ZWU2NmRmYWIsIDB4YTgzMWM2NmQsIDB4MmRiNDMyMTAsCgkgICAgMHhiMDAzMjdjOCwgMHg5OGZiMjEzZiwgMHhiZjU5N2ZjNywgMHhiZWVmMGVlNCwKCSAgICAweGM2ZTAwYmYzLCAweDNkYTg4ZmMyLCAweGQ1YTc5MTQ3LCAweDkzMGFhNzI1LAoJICAgIDB4MDZjYTYzNTEsIDB4ZTAwMzgyNmYsIDB4MTQyOTI5NjcsIDB4MGEwZTZlNzAsCgkgICAgMHgyN2I3MGE4NSwgMHg0NmQyMmZmYywgMHgyZTFiMjEzOCwgMHg1YzI2YzkyNiwKCSAgICAweDRkMmM2ZGZjLCAweDVhYzQyYWVkLCAweDUzMzgwZDEzLCAweDlkOTViM2RmLAoJICAgIDB4NjUwYTczNTQsIDB4OGJhZjYzZGUsIDB4NzY2YTBhYmIsIDB4M2M3N2IyYTgsCgkgICAgMHg4MWMyYzkyZSwgMHg0N2VkYWVlNiwgMHg5MjcyMmM4NSwgMHgxNDgyMzUzYiwKCSAgICAweGEyYmZlOGExLCAweDRjZjEwMzY0LCAweGE4MWE2NjRiLCAweGJjNDIzMDAxLAoJICAgIDB4YzI0YjhiNzAsIDB4ZDBmODk3OTEsIDB4Yzc2YzUxYTMsIDB4MDY1NGJlMzAsCgkgICAgMHhkMTkyZTgxOSwgMHhkNmVmNTIxOCwgMHhkNjk5MDYyNCwgMHg1NTY1YTkxMCwKCSAgICAweGY0MGUzNTg1LCAweDU3NzEyMDJhLCAweDEwNmFhMDcwLCAweDMyYmJkMWI4LAoJICAgIDB4MTlhNGMxMTYsIDB4YjhkMmQwYzgsIDB4MWUzNzZjMDgsIDB4NTE0MWFiNTMsCgkgICAgMHgyNzQ4Nzc0YywgMHhkZjhlZWI5OSwgMHgzNGIwYmNiNSwgMHhlMTliNDhhOCwKCSAgICAweDM5MWMwY2IzLCAweGM1Yzk1YTYzLCAweDRlZDhhYTRhLCAweGUzNDE4YWNiLAoJICAgIDB4NWI5Y2NhNGYsIDB4Nzc2M2UzNzMsIDB4NjgyZTZmZjMsIDB4ZDZiMmI4YTMsCgkgICAgMHg3NDhmODJlZSwgMHg1ZGVmYjJmYywgMHg3OGE1NjM2ZiwgMHg0MzE3MmY2MCwKCSAgICAweDg0Yzg3ODE0LCAweGExZjBhYjcyLCAweDhjYzcwMjA4LCAweDFhNjQzOWVjLAoJICAgIDB4OTBiZWZmZmEsIDB4MjM2MzFlMjgsIDB4YTQ1MDZjZWIsIDB4ZGU4MmJkZTksCgkgICAgMHhiZWY5YTNmNywgMHhiMmM2NzkxNSwgMHhjNjcxNzhmMiwgMHhlMzcyNTMyYiwKCSAgICAweGNhMjczZWNlLCAweGVhMjY2MTljLCAweGQxODZiOGM3LCAweDIxYzBjMjA3LAoJICAgIDB4ZWFkYTdkZDYsIDB4Y2RlMGViMWUsIDB4ZjU3ZDRmN2YsIDB4ZWU2ZWQxNzgsCgkgICAgMHgwNmYwNjdhYSwgMHg3MjE3NmZiYSwgMHgwYTYzN2RjNSwgMHhhMmM4OThhNiwKCSAgICAweDExM2Y5ODA0LCAweGJlZjkwZGFlLCAweDFiNzEwYjM1LCAweDEzMWM0NzFiLAoJICAgIDB4MjhkYjc3ZjUsIDB4MjMwNDdkODQsIDB4MzJjYWFiN2IsIDB4NDBjNzI0OTMsCgkgICAgMHgzYzllYmUwYSwgMHgxNWM5YmViYywgMHg0MzFkNjdjNCwgMHg5YzEwMGQ0YywKCSAgICAweDRjYzVkNGJlLCAweGNiM2U0MmI2LCAweDU5N2YyOTljLCAweGZjNjU3ZTJhLAoJICAgIDB4NWZjYjZmYWIsIDB4M2FkNmZhZWMsIDB4NmM0NDE5OGMsIDB4NGE0NzU4MTcKCSAgXQoKCSAgdmFyIFcgPSBuZXcgQXJyYXkoMTYwKQoKCSAgZnVuY3Rpb24gU2hhNTEyKCkgewoJICAgIHRoaXMuaW5pdCgpCgkgICAgdGhpcy5fdyA9IFcKCgkgICAgSGFzaC5jYWxsKHRoaXMsIDEyOCwgMTEyKQoJICB9CgoJICBpbmhlcml0cyhTaGE1MTIsIEhhc2gpCgoJICBTaGE1MTIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7CgoJICAgIHRoaXMuX2EgPSAweDZhMDllNjY3fDAKCSAgICB0aGlzLl9iID0gMHhiYjY3YWU4NXwwCgkgICAgdGhpcy5fYyA9IDB4M2M2ZWYzNzJ8MAoJICAgIHRoaXMuX2QgPSAweGE1NGZmNTNhfDAKCSAgICB0aGlzLl9lID0gMHg1MTBlNTI3ZnwwCgkgICAgdGhpcy5fZiA9IDB4OWIwNTY4OGN8MAoJICAgIHRoaXMuX2cgPSAweDFmODNkOWFifDAKCSAgICB0aGlzLl9oID0gMHg1YmUwY2QxOXwwCgoJICAgIHRoaXMuX2FsID0gMHhmM2JjYzkwOHwwCgkgICAgdGhpcy5fYmwgPSAweDg0Y2FhNzNifDAKCSAgICB0aGlzLl9jbCA9IDB4ZmU5NGY4MmJ8MAoJICAgIHRoaXMuX2RsID0gMHg1ZjFkMzZmMXwwCgkgICAgdGhpcy5fZWwgPSAweGFkZTY4MmQxfDAKCSAgICB0aGlzLl9mbCA9IDB4MmIzZTZjMWZ8MAoJICAgIHRoaXMuX2dsID0gMHhmYjQxYmQ2YnwwCgkgICAgdGhpcy5faGwgPSAweDEzN2UyMTc5fDAKCgkgICAgdGhpcy5fbGVuID0gdGhpcy5fcyA9IDAKCgkgICAgcmV0dXJuIHRoaXMKCSAgfQoKCSAgZnVuY3Rpb24gUyAoWCwgWGwsIG4pIHsKCSAgICByZXR1cm4gKFggPj4+IG4pIHwgKFhsIDw8ICgzMiAtIG4pKQoJICB9CgoJICBmdW5jdGlvbiBDaCAoeCwgeSwgeikgewoJICAgIHJldHVybiAoKHggJiB5KSBeICgofngpICYgeikpOwoJICB9CgoJICBmdW5jdGlvbiBNYWogKHgsIHksIHopIHsKCSAgICByZXR1cm4gKCh4ICYgeSkgXiAoeCAmIHopIF4gKHkgJiB6KSk7CgkgIH0KCgkgIFNoYTUxMi5wcm90b3R5cGUuX3VwZGF0ZSA9IGZ1bmN0aW9uKE0pIHsKCgkgICAgdmFyIFcgPSB0aGlzLl93CgkgICAgdmFyIGEsIGIsIGMsIGQsIGUsIGYsIGcsIGgKCSAgICB2YXIgYWwsIGJsLCBjbCwgZGwsIGVsLCBmbCwgZ2wsIGhsCgoJICAgIGEgPSB0aGlzLl9hIHwgMAoJICAgIGIgPSB0aGlzLl9iIHwgMAoJICAgIGMgPSB0aGlzLl9jIHwgMAoJICAgIGQgPSB0aGlzLl9kIHwgMAoJICAgIGUgPSB0aGlzLl9lIHwgMAoJICAgIGYgPSB0aGlzLl9mIHwgMAoJICAgIGcgPSB0aGlzLl9nIHwgMAoJICAgIGggPSB0aGlzLl9oIHwgMAoKCSAgICBhbCA9IHRoaXMuX2FsIHwgMAoJICAgIGJsID0gdGhpcy5fYmwgfCAwCgkgICAgY2wgPSB0aGlzLl9jbCB8IDAKCSAgICBkbCA9IHRoaXMuX2RsIHwgMAoJICAgIGVsID0gdGhpcy5fZWwgfCAwCgkgICAgZmwgPSB0aGlzLl9mbCB8IDAKCSAgICBnbCA9IHRoaXMuX2dsIHwgMAoJICAgIGhsID0gdGhpcy5faGwgfCAwCgoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgODA7IGkrKykgewoJICAgICAgdmFyIGogPSBpICogMgoKCSAgICAgIHZhciBXaSwgV2lsCgoJICAgICAgaWYgKGkgPCAxNikgewoJICAgICAgICBXaSA9IFdbal0gPSBNLnJlYWRJbnQzMkJFKGogKiA0KQoJICAgICAgICBXaWwgPSBXW2ogKyAxXSA9IE0ucmVhZEludDMyQkUoaiAqIDQgKyA0KQoKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIHZhciB4ICA9IFdbaiAtIDE1KjJdCgkgICAgICAgIHZhciB4bCA9IFdbaiAtIDE1KjIgKyAxXQoJICAgICAgICB2YXIgZ2FtbWEwICA9IFMoeCwgeGwsIDEpIF4gUyh4LCB4bCwgOCkgXiAoeCA+Pj4gNykKCSAgICAgICAgdmFyIGdhbW1hMGwgPSBTKHhsLCB4LCAxKSBeIFMoeGwsIHgsIDgpIF4gUyh4bCwgeCwgNykKCgkgICAgICAgIHggID0gV1tqIC0gMioyXQoJICAgICAgICB4bCA9IFdbaiAtIDIqMiArIDFdCgkgICAgICAgIHZhciBnYW1tYTEgID0gUyh4LCB4bCwgMTkpIF4gUyh4bCwgeCwgMjkpIF4gKHggPj4+IDYpCgkgICAgICAgIHZhciBnYW1tYTFsID0gUyh4bCwgeCwgMTkpIF4gUyh4LCB4bCwgMjkpIF4gUyh4bCwgeCwgNikKCgkgICAgICAgIC8vIFdbaV0gPSBnYW1tYTAgKyBXW2kgLSA3XSArIGdhbW1hMSArIFdbaSAtIDE2XQoJICAgICAgICB2YXIgV2k3ICA9IFdbaiAtIDcqMl0KCSAgICAgICAgdmFyIFdpN2wgPSBXW2ogLSA3KjIgKyAxXQoKCSAgICAgICAgdmFyIFdpMTYgID0gV1tqIC0gMTYqMl0KCSAgICAgICAgdmFyIFdpMTZsID0gV1tqIC0gMTYqMiArIDFdCgoJICAgICAgICBXaWwgPSBnYW1tYTBsICsgV2k3bAoJICAgICAgICBXaSAgPSBnYW1tYTAgICsgV2k3ICsgKChXaWwgPj4+IDApIDwgKGdhbW1hMGwgPj4+IDApID8gMSA6IDApCgkgICAgICAgIFdpbCA9IFdpbCArIGdhbW1hMWwKCSAgICAgICAgV2kgID0gV2kgICsgZ2FtbWExICArICgoV2lsID4+PiAwKSA8IChnYW1tYTFsID4+PiAwKSA/IDEgOiAwKQoJICAgICAgICBXaWwgPSBXaWwgKyBXaTE2bAoJICAgICAgICBXaSAgPSBXaSAgKyBXaTE2ICsgKChXaWwgPj4+IDApIDwgKFdpMTZsID4+PiAwKSA/IDEgOiAwKQoKCSAgICAgICAgV1tqXSA9IFdpCgkgICAgICAgIFdbaiArIDFdID0gV2lsCgkgICAgICB9CgoJICAgICAgdmFyIG1haiA9IE1haihhLCBiLCBjKQoJICAgICAgdmFyIG1hamwgPSBNYWooYWwsIGJsLCBjbCkKCgkgICAgICB2YXIgc2lnbWEwaCA9IFMoYSwgYWwsIDI4KSBeIFMoYWwsIGEsIDIpIF4gUyhhbCwgYSwgNykKCSAgICAgIHZhciBzaWdtYTBsID0gUyhhbCwgYSwgMjgpIF4gUyhhLCBhbCwgMikgXiBTKGEsIGFsLCA3KQoJICAgICAgdmFyIHNpZ21hMWggPSBTKGUsIGVsLCAxNCkgXiBTKGUsIGVsLCAxOCkgXiBTKGVsLCBlLCA5KQoJICAgICAgdmFyIHNpZ21hMWwgPSBTKGVsLCBlLCAxNCkgXiBTKGVsLCBlLCAxOCkgXiBTKGUsIGVsLCA5KQoKCSAgICAgIC8vIHQxID0gaCArIHNpZ21hMSArIGNoICsgS1tpXSArIFdbaV0KCSAgICAgIHZhciBLaSA9IEtbal0KCSAgICAgIHZhciBLaWwgPSBLW2ogKyAxXQoKCSAgICAgIHZhciBjaCA9IENoKGUsIGYsIGcpCgkgICAgICB2YXIgY2hsID0gQ2goZWwsIGZsLCBnbCkKCgkgICAgICB2YXIgdDFsID0gaGwgKyBzaWdtYTFsCgkgICAgICB2YXIgdDEgPSBoICsgc2lnbWExaCArICgodDFsID4+PiAwKSA8IChobCA+Pj4gMCkgPyAxIDogMCkKCSAgICAgIHQxbCA9IHQxbCArIGNobAoJICAgICAgdDEgPSB0MSArIGNoICsgKCh0MWwgPj4+IDApIDwgKGNobCA+Pj4gMCkgPyAxIDogMCkKCSAgICAgIHQxbCA9IHQxbCArIEtpbAoJICAgICAgdDEgPSB0MSArIEtpICsgKCh0MWwgPj4+IDApIDwgKEtpbCA+Pj4gMCkgPyAxIDogMCkKCSAgICAgIHQxbCA9IHQxbCArIFdpbAoJICAgICAgdDEgPSB0MSArIFdpICsgKCh0MWwgPj4+IDApIDwgKFdpbCA+Pj4gMCkgPyAxIDogMCkKCgkgICAgICAvLyB0MiA9IHNpZ21hMCArIG1hagoJICAgICAgdmFyIHQybCA9IHNpZ21hMGwgKyBtYWpsCgkgICAgICB2YXIgdDIgPSBzaWdtYTBoICsgbWFqICsgKCh0MmwgPj4+IDApIDwgKHNpZ21hMGwgPj4+IDApID8gMSA6IDApCgoJICAgICAgaCAgPSBnCgkgICAgICBobCA9IGdsCgkgICAgICBnICA9IGYKCSAgICAgIGdsID0gZmwKCSAgICAgIGYgID0gZQoJICAgICAgZmwgPSBlbAoJICAgICAgZWwgPSAoZGwgKyB0MWwpIHwgMAoJICAgICAgZSAgPSAoZCArIHQxICsgKChlbCA+Pj4gMCkgPCAoZGwgPj4+IDApID8gMSA6IDApKSB8IDAKCSAgICAgIGQgID0gYwoJICAgICAgZGwgPSBjbAoJICAgICAgYyAgPSBiCgkgICAgICBjbCA9IGJsCgkgICAgICBiICA9IGEKCSAgICAgIGJsID0gYWwKCSAgICAgIGFsID0gKHQxbCArIHQybCkgfCAwCgkgICAgICBhICA9ICh0MSArIHQyICsgKChhbCA+Pj4gMCkgPCAodDFsID4+PiAwKSA/IDEgOiAwKSkgfCAwCgkgICAgfQoKCSAgICB0aGlzLl9hbCA9ICh0aGlzLl9hbCArIGFsKSB8IDAKCSAgICB0aGlzLl9ibCA9ICh0aGlzLl9ibCArIGJsKSB8IDAKCSAgICB0aGlzLl9jbCA9ICh0aGlzLl9jbCArIGNsKSB8IDAKCSAgICB0aGlzLl9kbCA9ICh0aGlzLl9kbCArIGRsKSB8IDAKCSAgICB0aGlzLl9lbCA9ICh0aGlzLl9lbCArIGVsKSB8IDAKCSAgICB0aGlzLl9mbCA9ICh0aGlzLl9mbCArIGZsKSB8IDAKCSAgICB0aGlzLl9nbCA9ICh0aGlzLl9nbCArIGdsKSB8IDAKCSAgICB0aGlzLl9obCA9ICh0aGlzLl9obCArIGhsKSB8IDAKCgkgICAgdGhpcy5fYSA9ICh0aGlzLl9hICsgYSArICgodGhpcy5fYWwgPj4+IDApIDwgKGFsID4+PiAwKSA/IDEgOiAwKSkgfCAwCgkgICAgdGhpcy5fYiA9ICh0aGlzLl9iICsgYiArICgodGhpcy5fYmwgPj4+IDApIDwgKGJsID4+PiAwKSA/IDEgOiAwKSkgfCAwCgkgICAgdGhpcy5fYyA9ICh0aGlzLl9jICsgYyArICgodGhpcy5fY2wgPj4+IDApIDwgKGNsID4+PiAwKSA/IDEgOiAwKSkgfCAwCgkgICAgdGhpcy5fZCA9ICh0aGlzLl9kICsgZCArICgodGhpcy5fZGwgPj4+IDApIDwgKGRsID4+PiAwKSA/IDEgOiAwKSkgfCAwCgkgICAgdGhpcy5fZSA9ICh0aGlzLl9lICsgZSArICgodGhpcy5fZWwgPj4+IDApIDwgKGVsID4+PiAwKSA/IDEgOiAwKSkgfCAwCgkgICAgdGhpcy5fZiA9ICh0aGlzLl9mICsgZiArICgodGhpcy5fZmwgPj4+IDApIDwgKGZsID4+PiAwKSA/IDEgOiAwKSkgfCAwCgkgICAgdGhpcy5fZyA9ICh0aGlzLl9nICsgZyArICgodGhpcy5fZ2wgPj4+IDApIDwgKGdsID4+PiAwKSA/IDEgOiAwKSkgfCAwCgkgICAgdGhpcy5faCA9ICh0aGlzLl9oICsgaCArICgodGhpcy5faGwgPj4+IDApIDwgKGhsID4+PiAwKSA/IDEgOiAwKSkgfCAwCgkgIH0KCgkgIFNoYTUxMi5wcm90b3R5cGUuX2hhc2ggPSBmdW5jdGlvbiAoKSB7CgkgICAgdmFyIEggPSBuZXcgQnVmZmVyKDY0KQoKCSAgICBmdW5jdGlvbiB3cml0ZUludDY0QkUoaCwgbCwgb2Zmc2V0KSB7CgkgICAgICBILndyaXRlSW50MzJCRShoLCBvZmZzZXQpCgkgICAgICBILndyaXRlSW50MzJCRShsLCBvZmZzZXQgKyA0KQoJICAgIH0KCgkgICAgd3JpdGVJbnQ2NEJFKHRoaXMuX2EsIHRoaXMuX2FsLCAwKQoJICAgIHdyaXRlSW50NjRCRSh0aGlzLl9iLCB0aGlzLl9ibCwgOCkKCSAgICB3cml0ZUludDY0QkUodGhpcy5fYywgdGhpcy5fY2wsIDE2KQoJICAgIHdyaXRlSW50NjRCRSh0aGlzLl9kLCB0aGlzLl9kbCwgMjQpCgkgICAgd3JpdGVJbnQ2NEJFKHRoaXMuX2UsIHRoaXMuX2VsLCAzMikKCSAgICB3cml0ZUludDY0QkUodGhpcy5fZiwgdGhpcy5fZmwsIDQwKQoJICAgIHdyaXRlSW50NjRCRSh0aGlzLl9nLCB0aGlzLl9nbCwgNDgpCgkgICAgd3JpdGVJbnQ2NEJFKHRoaXMuX2gsIHRoaXMuX2hsLCA1NikKCgkgICAgcmV0dXJuIEgKCSAgfQoKCSAgcmV0dXJuIFNoYTUxMgoKCX0KCgovKioqLyB9LAovKiAyMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKgoJICogQSBKYXZhU2NyaXB0IGltcGxlbWVudGF0aW9uIG9mIHRoZSBSU0EgRGF0YSBTZWN1cml0eSwgSW5jLiBNRDUgTWVzc2FnZQoJICogRGlnZXN0IEFsZ29yaXRobSwgYXMgZGVmaW5lZCBpbiBSRkMgMTMyMS4KCSAqIFZlcnNpb24gMi4xIENvcHlyaWdodCAoQykgUGF1bCBKb2huc3RvbiAxOTk5IC0gMjAwMi4KCSAqIE90aGVyIGNvbnRyaWJ1dG9yczogR3JlZyBIb2x0LCBBbmRyZXcgS2VwZXJ0LCBZZG5hciwgTG9zdGluZXQKCSAqIERpc3RyaWJ1dGVkIHVuZGVyIHRoZSBCU0QgTGljZW5zZQoJICogU2VlIGh0dHA6Ly9wYWpob21lLm9yZy51ay9jcnlwdC9tZDUgZm9yIG1vcmUgaW5mby4KCSAqLwoKCXZhciBoZWxwZXJzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMik7CgoJLyoKCSAqIENhbGN1bGF0ZSB0aGUgTUQ1IG9mIGFuIGFycmF5IG9mIGxpdHRsZS1lbmRpYW4gd29yZHMsIGFuZCBhIGJpdCBsZW5ndGgKCSAqLwoJZnVuY3Rpb24gY29yZV9tZDUoeCwgbGVuKQoJewoJICAvKiBhcHBlbmQgcGFkZGluZyAqLwoJICB4W2xlbiA+PiA1XSB8PSAweDgwIDw8ICgobGVuKSAlIDMyKTsKCSAgeFsoKChsZW4gKyA2NCkgPj4+IDkpIDw8IDQpICsgMTRdID0gbGVuOwoKCSAgdmFyIGEgPSAgMTczMjU4NDE5MzsKCSAgdmFyIGIgPSAtMjcxNzMzODc5OwoJICB2YXIgYyA9IC0xNzMyNTg0MTk0OwoJICB2YXIgZCA9ICAyNzE3MzM4Nzg7CgoJICBmb3IodmFyIGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkgKz0gMTYpCgkgIHsKCSAgICB2YXIgb2xkYSA9IGE7CgkgICAgdmFyIG9sZGIgPSBiOwoJICAgIHZhciBvbGRjID0gYzsKCSAgICB2YXIgb2xkZCA9IGQ7CgoJICAgIGEgPSBtZDVfZmYoYSwgYiwgYywgZCwgeFtpKyAwXSwgNyAsIC02ODA4NzY5MzYpOwoJICAgIGQgPSBtZDVfZmYoZCwgYSwgYiwgYywgeFtpKyAxXSwgMTIsIC0zODk1NjQ1ODYpOwoJICAgIGMgPSBtZDVfZmYoYywgZCwgYSwgYiwgeFtpKyAyXSwgMTcsICA2MDYxMDU4MTkpOwoJICAgIGIgPSBtZDVfZmYoYiwgYywgZCwgYSwgeFtpKyAzXSwgMjIsIC0xMDQ0NTI1MzMwKTsKCSAgICBhID0gbWQ1X2ZmKGEsIGIsIGMsIGQsIHhbaSsgNF0sIDcgLCAtMTc2NDE4ODk3KTsKCSAgICBkID0gbWQ1X2ZmKGQsIGEsIGIsIGMsIHhbaSsgNV0sIDEyLCAgMTIwMDA4MDQyNik7CgkgICAgYyA9IG1kNV9mZihjLCBkLCBhLCBiLCB4W2krIDZdLCAxNywgLTE0NzMyMzEzNDEpOwoJICAgIGIgPSBtZDVfZmYoYiwgYywgZCwgYSwgeFtpKyA3XSwgMjIsIC00NTcwNTk4Myk7CgkgICAgYSA9IG1kNV9mZihhLCBiLCBjLCBkLCB4W2krIDhdLCA3ICwgIDE3NzAwMzU0MTYpOwoJICAgIGQgPSBtZDVfZmYoZCwgYSwgYiwgYywgeFtpKyA5XSwgMTIsIC0xOTU4NDE0NDE3KTsKCSAgICBjID0gbWQ1X2ZmKGMsIGQsIGEsIGIsIHhbaSsxMF0sIDE3LCAtNDIwNjMpOwoJICAgIGIgPSBtZDVfZmYoYiwgYywgZCwgYSwgeFtpKzExXSwgMjIsIC0xOTkwNDA0MTYyKTsKCSAgICBhID0gbWQ1X2ZmKGEsIGIsIGMsIGQsIHhbaSsxMl0sIDcgLCAgMTgwNDYwMzY4Mik7CgkgICAgZCA9IG1kNV9mZihkLCBhLCBiLCBjLCB4W2krMTNdLCAxMiwgLTQwMzQxMTAxKTsKCSAgICBjID0gbWQ1X2ZmKGMsIGQsIGEsIGIsIHhbaSsxNF0sIDE3LCAtMTUwMjAwMjI5MCk7CgkgICAgYiA9IG1kNV9mZihiLCBjLCBkLCBhLCB4W2krMTVdLCAyMiwgIDEyMzY1MzUzMjkpOwoKCSAgICBhID0gbWQ1X2dnKGEsIGIsIGMsIGQsIHhbaSsgMV0sIDUgLCAtMTY1Nzk2NTEwKTsKCSAgICBkID0gbWQ1X2dnKGQsIGEsIGIsIGMsIHhbaSsgNl0sIDkgLCAtMTA2OTUwMTYzMik7CgkgICAgYyA9IG1kNV9nZyhjLCBkLCBhLCBiLCB4W2krMTFdLCAxNCwgIDY0MzcxNzcxMyk7CgkgICAgYiA9IG1kNV9nZyhiLCBjLCBkLCBhLCB4W2krIDBdLCAyMCwgLTM3Mzg5NzMwMik7CgkgICAgYSA9IG1kNV9nZyhhLCBiLCBjLCBkLCB4W2krIDVdLCA1ICwgLTcwMTU1ODY5MSk7CgkgICAgZCA9IG1kNV9nZyhkLCBhLCBiLCBjLCB4W2krMTBdLCA5ICwgIDM4MDE2MDgzKTsKCSAgICBjID0gbWQ1X2dnKGMsIGQsIGEsIGIsIHhbaSsxNV0sIDE0LCAtNjYwNDc4MzM1KTsKCSAgICBiID0gbWQ1X2dnKGIsIGMsIGQsIGEsIHhbaSsgNF0sIDIwLCAtNDA1NTM3ODQ4KTsKCSAgICBhID0gbWQ1X2dnKGEsIGIsIGMsIGQsIHhbaSsgOV0sIDUgLCAgNTY4NDQ2NDM4KTsKCSAgICBkID0gbWQ1X2dnKGQsIGEsIGIsIGMsIHhbaSsxNF0sIDkgLCAtMTAxOTgwMzY5MCk7CgkgICAgYyA9IG1kNV9nZyhjLCBkLCBhLCBiLCB4W2krIDNdLCAxNCwgLTE4NzM2Mzk2MSk7CgkgICAgYiA9IG1kNV9nZyhiLCBjLCBkLCBhLCB4W2krIDhdLCAyMCwgIDExNjM1MzE1MDEpOwoJICAgIGEgPSBtZDVfZ2coYSwgYiwgYywgZCwgeFtpKzEzXSwgNSAsIC0xNDQ0NjgxNDY3KTsKCSAgICBkID0gbWQ1X2dnKGQsIGEsIGIsIGMsIHhbaSsgMl0sIDkgLCAtNTE0MDM3ODQpOwoJICAgIGMgPSBtZDVfZ2coYywgZCwgYSwgYiwgeFtpKyA3XSwgMTQsICAxNzM1MzI4NDczKTsKCSAgICBiID0gbWQ1X2dnKGIsIGMsIGQsIGEsIHhbaSsxMl0sIDIwLCAtMTkyNjYwNzczNCk7CgoJICAgIGEgPSBtZDVfaGgoYSwgYiwgYywgZCwgeFtpKyA1XSwgNCAsIC0zNzg1NTgpOwoJICAgIGQgPSBtZDVfaGgoZCwgYSwgYiwgYywgeFtpKyA4XSwgMTEsIC0yMDIyNTc0NDYzKTsKCSAgICBjID0gbWQ1X2hoKGMsIGQsIGEsIGIsIHhbaSsxMV0sIDE2LCAgMTgzOTAzMDU2Mik7CgkgICAgYiA9IG1kNV9oaChiLCBjLCBkLCBhLCB4W2krMTRdLCAyMywgLTM1MzA5NTU2KTsKCSAgICBhID0gbWQ1X2hoKGEsIGIsIGMsIGQsIHhbaSsgMV0sIDQgLCAtMTUzMDk5MjA2MCk7CgkgICAgZCA9IG1kNV9oaChkLCBhLCBiLCBjLCB4W2krIDRdLCAxMSwgIDEyNzI4OTMzNTMpOwoJICAgIGMgPSBtZDVfaGgoYywgZCwgYSwgYiwgeFtpKyA3XSwgMTYsIC0xNTU0OTc2MzIpOwoJICAgIGIgPSBtZDVfaGgoYiwgYywgZCwgYSwgeFtpKzEwXSwgMjMsIC0xMDk0NzMwNjQwKTsKCSAgICBhID0gbWQ1X2hoKGEsIGIsIGMsIGQsIHhbaSsxM10sIDQgLCAgNjgxMjc5MTc0KTsKCSAgICBkID0gbWQ1X2hoKGQsIGEsIGIsIGMsIHhbaSsgMF0sIDExLCAtMzU4NTM3MjIyKTsKCSAgICBjID0gbWQ1X2hoKGMsIGQsIGEsIGIsIHhbaSsgM10sIDE2LCAtNzIyNTIxOTc5KTsKCSAgICBiID0gbWQ1X2hoKGIsIGMsIGQsIGEsIHhbaSsgNl0sIDIzLCAgNzYwMjkxODkpOwoJICAgIGEgPSBtZDVfaGgoYSwgYiwgYywgZCwgeFtpKyA5XSwgNCAsIC02NDAzNjQ0ODcpOwoJICAgIGQgPSBtZDVfaGgoZCwgYSwgYiwgYywgeFtpKzEyXSwgMTEsIC00MjE4MTU4MzUpOwoJICAgIGMgPSBtZDVfaGgoYywgZCwgYSwgYiwgeFtpKzE1XSwgMTYsICA1MzA3NDI1MjApOwoJICAgIGIgPSBtZDVfaGgoYiwgYywgZCwgYSwgeFtpKyAyXSwgMjMsIC05OTUzMzg2NTEpOwoKCSAgICBhID0gbWQ1X2lpKGEsIGIsIGMsIGQsIHhbaSsgMF0sIDYgLCAtMTk4NjMwODQ0KTsKCSAgICBkID0gbWQ1X2lpKGQsIGEsIGIsIGMsIHhbaSsgN10sIDEwLCAgMTEyNjg5MTQxNSk7CgkgICAgYyA9IG1kNV9paShjLCBkLCBhLCBiLCB4W2krMTRdLCAxNSwgLTE0MTYzNTQ5MDUpOwoJICAgIGIgPSBtZDVfaWkoYiwgYywgZCwgYSwgeFtpKyA1XSwgMjEsIC01NzQzNDA1NSk7CgkgICAgYSA9IG1kNV9paShhLCBiLCBjLCBkLCB4W2krMTJdLCA2ICwgIDE3MDA0ODU1NzEpOwoJICAgIGQgPSBtZDVfaWkoZCwgYSwgYiwgYywgeFtpKyAzXSwgMTAsIC0xODk0OTg2NjA2KTsKCSAgICBjID0gbWQ1X2lpKGMsIGQsIGEsIGIsIHhbaSsxMF0sIDE1LCAtMTA1MTUyMyk7CgkgICAgYiA9IG1kNV9paShiLCBjLCBkLCBhLCB4W2krIDFdLCAyMSwgLTIwNTQ5MjI3OTkpOwoJICAgIGEgPSBtZDVfaWkoYSwgYiwgYywgZCwgeFtpKyA4XSwgNiAsICAxODczMzEzMzU5KTsKCSAgICBkID0gbWQ1X2lpKGQsIGEsIGIsIGMsIHhbaSsxNV0sIDEwLCAtMzA2MTE3NDQpOwoJICAgIGMgPSBtZDVfaWkoYywgZCwgYSwgYiwgeFtpKyA2XSwgMTUsIC0xNTYwMTk4MzgwKTsKCSAgICBiID0gbWQ1X2lpKGIsIGMsIGQsIGEsIHhbaSsxM10sIDIxLCAgMTMwOTE1MTY0OSk7CgkgICAgYSA9IG1kNV9paShhLCBiLCBjLCBkLCB4W2krIDRdLCA2ICwgLTE0NTUyMzA3MCk7CgkgICAgZCA9IG1kNV9paShkLCBhLCBiLCBjLCB4W2krMTFdLCAxMCwgLTExMjAyMTAzNzkpOwoJICAgIGMgPSBtZDVfaWkoYywgZCwgYSwgYiwgeFtpKyAyXSwgMTUsICA3MTg3ODcyNTkpOwoJICAgIGIgPSBtZDVfaWkoYiwgYywgZCwgYSwgeFtpKyA5XSwgMjEsIC0zNDM0ODU1NTEpOwoKCSAgICBhID0gc2FmZV9hZGQoYSwgb2xkYSk7CgkgICAgYiA9IHNhZmVfYWRkKGIsIG9sZGIpOwoJICAgIGMgPSBzYWZlX2FkZChjLCBvbGRjKTsKCSAgICBkID0gc2FmZV9hZGQoZCwgb2xkZCk7CgkgIH0KCSAgcmV0dXJuIEFycmF5KGEsIGIsIGMsIGQpOwoKCX0KCgkvKgoJICogVGhlc2UgZnVuY3Rpb25zIGltcGxlbWVudCB0aGUgZm91ciBiYXNpYyBvcGVyYXRpb25zIHRoZSBhbGdvcml0aG0gdXNlcy4KCSAqLwoJZnVuY3Rpb24gbWQ1X2NtbihxLCBhLCBiLCB4LCBzLCB0KQoJewoJICByZXR1cm4gc2FmZV9hZGQoYml0X3JvbChzYWZlX2FkZChzYWZlX2FkZChhLCBxKSwgc2FmZV9hZGQoeCwgdCkpLCBzKSxiKTsKCX0KCWZ1bmN0aW9uIG1kNV9mZihhLCBiLCBjLCBkLCB4LCBzLCB0KQoJewoJICByZXR1cm4gbWQ1X2NtbigoYiAmIGMpIHwgKCh+YikgJiBkKSwgYSwgYiwgeCwgcywgdCk7Cgl9CglmdW5jdGlvbiBtZDVfZ2coYSwgYiwgYywgZCwgeCwgcywgdCkKCXsKCSAgcmV0dXJuIG1kNV9jbW4oKGIgJiBkKSB8IChjICYgKH5kKSksIGEsIGIsIHgsIHMsIHQpOwoJfQoJZnVuY3Rpb24gbWQ1X2hoKGEsIGIsIGMsIGQsIHgsIHMsIHQpCgl7CgkgIHJldHVybiBtZDVfY21uKGIgXiBjIF4gZCwgYSwgYiwgeCwgcywgdCk7Cgl9CglmdW5jdGlvbiBtZDVfaWkoYSwgYiwgYywgZCwgeCwgcywgdCkKCXsKCSAgcmV0dXJuIG1kNV9jbW4oYyBeIChiIHwgKH5kKSksIGEsIGIsIHgsIHMsIHQpOwoJfQoKCS8qCgkgKiBBZGQgaW50ZWdlcnMsIHdyYXBwaW5nIGF0IDJeMzIuIFRoaXMgdXNlcyAxNi1iaXQgb3BlcmF0aW9ucyBpbnRlcm5hbGx5CgkgKiB0byB3b3JrIGFyb3VuZCBidWdzIGluIHNvbWUgSlMgaW50ZXJwcmV0ZXJzLgoJICovCglmdW5jdGlvbiBzYWZlX2FkZCh4LCB5KQoJewoJICB2YXIgbHN3ID0gKHggJiAweEZGRkYpICsgKHkgJiAweEZGRkYpOwoJICB2YXIgbXN3ID0gKHggPj4gMTYpICsgKHkgPj4gMTYpICsgKGxzdyA+PiAxNik7CgkgIHJldHVybiAobXN3IDw8IDE2KSB8IChsc3cgJiAweEZGRkYpOwoJfQoKCS8qCgkgKiBCaXR3aXNlIHJvdGF0ZSBhIDMyLWJpdCBudW1iZXIgdG8gdGhlIGxlZnQuCgkgKi8KCWZ1bmN0aW9uIGJpdF9yb2wobnVtLCBjbnQpCgl7CgkgIHJldHVybiAobnVtIDw8IGNudCkgfCAobnVtID4+PiAoMzIgLSBjbnQpKTsKCX0KCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIG1kNShidWYpIHsKCSAgcmV0dXJuIGhlbHBlcnMuaGFzaChidWYsIGNvcmVfbWQ1LCAxNik7Cgl9OwoKCi8qKiovIH0sCi8qIDIyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIpIHt2YXIgaW50U2l6ZSA9IDQ7Cgl2YXIgemVyb0J1ZmZlciA9IG5ldyBCdWZmZXIoaW50U2l6ZSk7IHplcm9CdWZmZXIuZmlsbCgwKTsKCXZhciBjaHJzeiA9IDg7CgoJZnVuY3Rpb24gdG9BcnJheShidWYsIGJpZ0VuZGlhbikgewoJICBpZiAoKGJ1Zi5sZW5ndGggJSBpbnRTaXplKSAhPT0gMCkgewoJICAgIHZhciBsZW4gPSBidWYubGVuZ3RoICsgKGludFNpemUgLSAoYnVmLmxlbmd0aCAlIGludFNpemUpKTsKCSAgICBidWYgPSBCdWZmZXIuY29uY2F0KFtidWYsIHplcm9CdWZmZXJdLCBsZW4pOwoJICB9CgoJICB2YXIgYXJyID0gW107CgkgIHZhciBmbiA9IGJpZ0VuZGlhbiA/IGJ1Zi5yZWFkSW50MzJCRSA6IGJ1Zi5yZWFkSW50MzJMRTsKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBidWYubGVuZ3RoOyBpICs9IGludFNpemUpIHsKCSAgICBhcnIucHVzaChmbi5jYWxsKGJ1ZiwgaSkpOwoJICB9CgkgIHJldHVybiBhcnI7Cgl9CgoJZnVuY3Rpb24gdG9CdWZmZXIoYXJyLCBzaXplLCBiaWdFbmRpYW4pIHsKCSAgdmFyIGJ1ZiA9IG5ldyBCdWZmZXIoc2l6ZSk7CgkgIHZhciBmbiA9IGJpZ0VuZGlhbiA/IGJ1Zi53cml0ZUludDMyQkUgOiBidWYud3JpdGVJbnQzMkxFOwoJICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykgewoJICAgIGZuLmNhbGwoYnVmLCBhcnJbaV0sIGkgKiA0LCB0cnVlKTsKCSAgfQoJICByZXR1cm4gYnVmOwoJfQoKCWZ1bmN0aW9uIGhhc2goYnVmLCBmbiwgaGFzaFNpemUsIGJpZ0VuZGlhbikgewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSBidWYgPSBuZXcgQnVmZmVyKGJ1Zik7CgkgIHZhciBhcnIgPSBmbih0b0FycmF5KGJ1ZiwgYmlnRW5kaWFuKSwgYnVmLmxlbmd0aCAqIGNocnN6KTsKCSAgcmV0dXJuIHRvQnVmZmVyKGFyciwgaGFzaFNpemUsIGJpZ0VuZGlhbik7Cgl9CgoJbW9kdWxlLmV4cG9ydHMgPSB7IGhhc2g6IGhhc2ggfTsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5CdWZmZXIpKQoKLyoqKi8gfSwKLyogMjMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKEJ1ZmZlcikgewoJbW9kdWxlLmV4cG9ydHMgPSByaXBlbWQxNjAKCgoKCS8qCglDcnlwdG9KUyB2My4xLjIKCWNvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcwoJKGMpIDIwMDktMjAxMyBieSBKZWZmIE1vdHQuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCgljb2RlLmdvb2dsZS5jb20vcC9jcnlwdG8tanMvd2lraS9MaWNlbnNlCgkqLwoJLyoqIEBwcmVzZXJ2ZQoJKGMpIDIwMTIgYnkgQ8OpZHJpYyBNZXNuaWwuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCgoJUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0IG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OgoKCSAgICAtIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4KCSAgICAtIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi4KCglUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTICJBUyBJUyIgQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkUgRElTQ0xBSU1FRC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIENPUFlSSUdIVCBIT0xERVIgT1IgQ09OVFJJQlVUT1JTIEJFIExJQUJMRSBGT1IgQU5ZIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUyBPRiBVU0UsIERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRiBUSElTIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLgoJKi8KCgkvLyBDb25zdGFudHMgdGFibGUKCXZhciB6bCA9IFsKCSAgICAwLCAgMSwgIDIsICAzLCAgNCwgIDUsICA2LCAgNywgIDgsICA5LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1LAoJICAgIDcsICA0LCAxMywgIDEsIDEwLCAgNiwgMTUsICAzLCAxMiwgIDAsICA5LCAgNSwgIDIsIDE0LCAxMSwgIDgsCgkgICAgMywgMTAsIDE0LCAgNCwgIDksIDE1LCAgOCwgIDEsICAyLCAgNywgIDAsICA2LCAxMywgMTEsICA1LCAxMiwKCSAgICAxLCAgOSwgMTEsIDEwLCAgMCwgIDgsIDEyLCAgNCwgMTMsICAzLCAgNywgMTUsIDE0LCAgNSwgIDYsICAyLAoJICAgIDQsICAwLCAgNSwgIDksICA3LCAxMiwgIDIsIDEwLCAxNCwgIDEsICAzLCAgOCwgMTEsICA2LCAxNSwgMTNdOwoJdmFyIHpyID0gWwoJICAgIDUsIDE0LCAgNywgIDAsICA5LCAgMiwgMTEsICA0LCAxMywgIDYsIDE1LCAgOCwgIDEsIDEwLCAgMywgMTIsCgkgICAgNiwgMTEsICAzLCAgNywgIDAsIDEzLCAgNSwgMTAsIDE0LCAxNSwgIDgsIDEyLCAgNCwgIDksICAxLCAgMiwKCSAgICAxNSwgIDUsICAxLCAgMywgIDcsIDE0LCAgNiwgIDksIDExLCAgOCwgMTIsICAyLCAxMCwgIDAsICA0LCAxMywKCSAgICA4LCAgNiwgIDQsICAxLCAgMywgMTEsIDE1LCAgMCwgIDUsIDEyLCAgMiwgMTMsICA5LCAgNywgMTAsIDE0LAoJICAgIDEyLCAxNSwgMTAsICA0LCAgMSwgIDUsICA4LCAgNywgIDYsICAyLCAxMywgMTQsICAwLCAgMywgIDksIDExXTsKCXZhciBzbCA9IFsKCSAgICAgMTEsIDE0LCAxNSwgMTIsICA1LCAgOCwgIDcsICA5LCAxMSwgMTMsIDE0LCAxNSwgIDYsICA3LCAgOSwgIDgsCgkgICAgNywgNiwgICA4LCAxMywgMTEsICA5LCAgNywgMTUsICA3LCAxMiwgMTUsICA5LCAxMSwgIDcsIDEzLCAxMiwKCSAgICAxMSwgMTMsICA2LCAgNywgMTQsICA5LCAxMywgMTUsIDE0LCAgOCwgMTMsICA2LCAgNSwgMTIsICA3LCAgNSwKCSAgICAgIDExLCAxMiwgMTQsIDE1LCAxNCwgMTUsICA5LCAgOCwgIDksIDE0LCAgNSwgIDYsICA4LCAgNiwgIDUsIDEyLAoJICAgIDksIDE1LCAgNSwgMTEsICA2LCAgOCwgMTMsIDEyLCAgNSwgMTIsIDEzLCAxNCwgMTEsICA4LCAgNSwgIDYgXTsKCXZhciBzciA9IFsKCSAgICA4LCAgOSwgIDksIDExLCAxMywgMTUsIDE1LCAgNSwgIDcsICA3LCAgOCwgMTEsIDE0LCAxNCwgMTIsICA2LAoJICAgIDksIDEzLCAxNSwgIDcsIDEyLCAgOCwgIDksIDExLCAgNywgIDcsIDEyLCAgNywgIDYsIDE1LCAxMywgMTEsCgkgICAgOSwgIDcsIDE1LCAxMSwgIDgsICA2LCAgNiwgMTQsIDEyLCAxMywgIDUsIDE0LCAxMywgMTMsICA3LCAgNSwKCSAgICAxNSwgIDUsICA4LCAxMSwgMTQsIDE0LCAgNiwgMTQsICA2LCAgOSwgMTIsICA5LCAxMiwgIDUsIDE1LCAgOCwKCSAgICA4LCAgNSwgMTIsICA5LCAxMiwgIDUsIDE0LCAgNiwgIDgsIDEzLCAgNiwgIDUsIDE1LCAxMywgMTEsIDExIF07CgoJdmFyIGhsID0gIFsgMHgwMDAwMDAwMCwgMHg1QTgyNzk5OSwgMHg2RUQ5RUJBMSwgMHg4RjFCQkNEQywgMHhBOTUzRkQ0RV07Cgl2YXIgaHIgPSAgWyAweDUwQTI4QkU2LCAweDVDNEREMTI0LCAweDZENzAzRUYzLCAweDdBNkQ3NkU5LCAweDAwMDAwMDAwXTsKCgl2YXIgYnl0ZXNUb1dvcmRzID0gZnVuY3Rpb24gKGJ5dGVzKSB7CgkgIHZhciB3b3JkcyA9IFtdOwoJICBmb3IgKHZhciBpID0gMCwgYiA9IDA7IGkgPCBieXRlcy5sZW5ndGg7IGkrKywgYiArPSA4KSB7CgkgICAgd29yZHNbYiA+Pj4gNV0gfD0gYnl0ZXNbaV0gPDwgKDI0IC0gYiAlIDMyKTsKCSAgfQoJICByZXR1cm4gd29yZHM7Cgl9OwoKCXZhciB3b3Jkc1RvQnl0ZXMgPSBmdW5jdGlvbiAod29yZHMpIHsKCSAgdmFyIGJ5dGVzID0gW107CgkgIGZvciAodmFyIGIgPSAwOyBiIDwgd29yZHMubGVuZ3RoICogMzI7IGIgKz0gOCkgewoJICAgIGJ5dGVzLnB1c2goKHdvcmRzW2IgPj4+IDVdID4+PiAoMjQgLSBiICUgMzIpKSAmIDB4RkYpOwoJICB9CgkgIHJldHVybiBieXRlczsKCX07CgoJdmFyIHByb2Nlc3NCbG9jayA9IGZ1bmN0aW9uIChILCBNLCBvZmZzZXQpIHsKCgkgIC8vIFN3YXAgZW5kaWFuCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykgewoJICAgIHZhciBvZmZzZXRfaSA9IG9mZnNldCArIGk7CgkgICAgdmFyIE1fb2Zmc2V0X2kgPSBNW29mZnNldF9pXTsKCgkgICAgLy8gU3dhcAoJICAgIE1bb2Zmc2V0X2ldID0gKAoJICAgICAgICAoKChNX29mZnNldF9pIDw8IDgpICB8IChNX29mZnNldF9pID4+PiAyNCkpICYgMHgwMGZmMDBmZikgfAoJICAgICAgICAoKChNX29mZnNldF9pIDw8IDI0KSB8IChNX29mZnNldF9pID4+PiA4KSkgICYgMHhmZjAwZmYwMCkKCSAgICApOwoJICB9CgoJICAvLyBXb3JraW5nIHZhcmlhYmxlcwoJICB2YXIgYWwsIGJsLCBjbCwgZGwsIGVsOwoJICB2YXIgYXIsIGJyLCBjciwgZHIsIGVyOwoKCSAgYXIgPSBhbCA9IEhbMF07CgkgIGJyID0gYmwgPSBIWzFdOwoJICBjciA9IGNsID0gSFsyXTsKCSAgZHIgPSBkbCA9IEhbM107CgkgIGVyID0gZWwgPSBIWzRdOwoJICAvLyBDb21wdXRhdGlvbgoJICB2YXIgdDsKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCA4MDsgaSArPSAxKSB7CgkgICAgdCA9IChhbCArICBNW29mZnNldCt6bFtpXV0pfDA7CgkgICAgaWYgKGk8MTYpewoJICAgICAgICB0ICs9ICBmMShibCxjbCxkbCkgKyBobFswXTsKCSAgICB9IGVsc2UgaWYgKGk8MzIpIHsKCSAgICAgICAgdCArPSAgZjIoYmwsY2wsZGwpICsgaGxbMV07CgkgICAgfSBlbHNlIGlmIChpPDQ4KSB7CgkgICAgICAgIHQgKz0gIGYzKGJsLGNsLGRsKSArIGhsWzJdOwoJICAgIH0gZWxzZSBpZiAoaTw2NCkgewoJICAgICAgICB0ICs9ICBmNChibCxjbCxkbCkgKyBobFszXTsKCSAgICB9IGVsc2Ugey8vIGlmIChpPDgwKSB7CgkgICAgICAgIHQgKz0gIGY1KGJsLGNsLGRsKSArIGhsWzRdOwoJICAgIH0KCSAgICB0ID0gdHwwOwoJICAgIHQgPSAgcm90bCh0LHNsW2ldKTsKCSAgICB0ID0gKHQrZWwpfDA7CgkgICAgYWwgPSBlbDsKCSAgICBlbCA9IGRsOwoJICAgIGRsID0gcm90bChjbCwgMTApOwoJICAgIGNsID0gYmw7CgkgICAgYmwgPSB0OwoKCSAgICB0ID0gKGFyICsgTVtvZmZzZXQrenJbaV1dKXwwOwoJICAgIGlmIChpPDE2KXsKCSAgICAgICAgdCArPSAgZjUoYnIsY3IsZHIpICsgaHJbMF07CgkgICAgfSBlbHNlIGlmIChpPDMyKSB7CgkgICAgICAgIHQgKz0gIGY0KGJyLGNyLGRyKSArIGhyWzFdOwoJICAgIH0gZWxzZSBpZiAoaTw0OCkgewoJICAgICAgICB0ICs9ICBmMyhicixjcixkcikgKyBoclsyXTsKCSAgICB9IGVsc2UgaWYgKGk8NjQpIHsKCSAgICAgICAgdCArPSAgZjIoYnIsY3IsZHIpICsgaHJbM107CgkgICAgfSBlbHNlIHsvLyBpZiAoaTw4MCkgewoJICAgICAgICB0ICs9ICBmMShicixjcixkcikgKyBocls0XTsKCSAgICB9CgkgICAgdCA9IHR8MDsKCSAgICB0ID0gIHJvdGwodCxzcltpXSkgOwoJICAgIHQgPSAodCtlcil8MDsKCSAgICBhciA9IGVyOwoJICAgIGVyID0gZHI7CgkgICAgZHIgPSByb3RsKGNyLCAxMCk7CgkgICAgY3IgPSBicjsKCSAgICBiciA9IHQ7CgkgIH0KCSAgLy8gSW50ZXJtZWRpYXRlIGhhc2ggdmFsdWUKCSAgdCAgICA9IChIWzFdICsgY2wgKyBkcil8MDsKCSAgSFsxXSA9IChIWzJdICsgZGwgKyBlcil8MDsKCSAgSFsyXSA9IChIWzNdICsgZWwgKyBhcil8MDsKCSAgSFszXSA9IChIWzRdICsgYWwgKyBicil8MDsKCSAgSFs0XSA9IChIWzBdICsgYmwgKyBjcil8MDsKCSAgSFswXSA9ICB0OwoJfTsKCglmdW5jdGlvbiBmMSh4LCB5LCB6KSB7CgkgIHJldHVybiAoKHgpIF4gKHkpIF4gKHopKTsKCX0KCglmdW5jdGlvbiBmMih4LCB5LCB6KSB7CgkgIHJldHVybiAoKCh4KSYoeSkpIHwgKCh+eCkmKHopKSk7Cgl9CgoJZnVuY3Rpb24gZjMoeCwgeSwgeikgewoJICByZXR1cm4gKCgoeCkgfCAofih5KSkpIF4gKHopKTsKCX0KCglmdW5jdGlvbiBmNCh4LCB5LCB6KSB7CgkgIHJldHVybiAoKCh4KSAmICh6KSkgfCAoKHkpJih+KHopKSkpOwoJfQoKCWZ1bmN0aW9uIGY1KHgsIHksIHopIHsKCSAgcmV0dXJuICgoeCkgXiAoKHkpIHwofih6KSkpKTsKCX0KCglmdW5jdGlvbiByb3RsKHgsbikgewoJICByZXR1cm4gKHg8PG4pIHwgKHg+Pj4oMzItbikpOwoJfQoKCWZ1bmN0aW9uIHJpcGVtZDE2MChtZXNzYWdlKSB7CgkgIHZhciBIID0gWzB4Njc0NTIzMDEsIDB4RUZDREFCODksIDB4OThCQURDRkUsIDB4MTAzMjU0NzYsIDB4QzNEMkUxRjBdOwoKCSAgaWYgKHR5cGVvZiBtZXNzYWdlID09ICdzdHJpbmcnKQoJICAgIG1lc3NhZ2UgPSBuZXcgQnVmZmVyKG1lc3NhZ2UsICd1dGY4Jyk7CgoJICB2YXIgbSA9IGJ5dGVzVG9Xb3JkcyhtZXNzYWdlKTsKCgkgIHZhciBuQml0c0xlZnQgPSBtZXNzYWdlLmxlbmd0aCAqIDg7CgkgIHZhciBuQml0c1RvdGFsID0gbWVzc2FnZS5sZW5ndGggKiA4OwoKCSAgLy8gQWRkIHBhZGRpbmcKCSAgbVtuQml0c0xlZnQgPj4+IDVdIHw9IDB4ODAgPDwgKDI0IC0gbkJpdHNMZWZ0ICUgMzIpOwoJICBtWygoKG5CaXRzTGVmdCArIDY0KSA+Pj4gOSkgPDwgNCkgKyAxNF0gPSAoCgkgICAgICAoKChuQml0c1RvdGFsIDw8IDgpICB8IChuQml0c1RvdGFsID4+PiAyNCkpICYgMHgwMGZmMDBmZikgfAoJICAgICAgKCgobkJpdHNUb3RhbCA8PCAyNCkgfCAobkJpdHNUb3RhbCA+Pj4gOCkpICAmIDB4ZmYwMGZmMDApCgkgICk7CgoJICBmb3IgKHZhciBpPTAgOyBpPG0ubGVuZ3RoOyBpICs9IDE2KSB7CgkgICAgcHJvY2Vzc0Jsb2NrKEgsIG0sIGkpOwoJICB9CgoJICAvLyBTd2FwIGVuZGlhbgoJICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykgewoJICAgICAgLy8gU2hvcnRjdXQKCSAgICB2YXIgSF9pID0gSFtpXTsKCgkgICAgLy8gU3dhcAoJICAgIEhbaV0gPSAoKChIX2kgPDwgOCkgIHwgKEhfaSA+Pj4gMjQpKSAmIDB4MDBmZjAwZmYpIHwKCSAgICAgICAgICAoKChIX2kgPDwgMjQpIHwgKEhfaSA+Pj4gOCkpICAmIDB4ZmYwMGZmMDApOwoJICB9CgoJICB2YXIgZGlnZXN0Ynl0ZXMgPSB3b3Jkc1RvQnl0ZXMoSCk7CgkgIHJldHVybiBuZXcgQnVmZmVyKGRpZ2VzdGJ5dGVzKTsKCX0KCgoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcikpCgovKioqLyB9LAovKiAyNCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oQnVmZmVyKSB7dmFyIGNyZWF0ZUhhc2ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKQoKCXZhciB6ZXJvQnVmZmVyID0gbmV3IEJ1ZmZlcigxMjgpCgl6ZXJvQnVmZmVyLmZpbGwoMCkKCgltb2R1bGUuZXhwb3J0cyA9IEhtYWMKCglmdW5jdGlvbiBIbWFjIChhbGcsIGtleSkgewoJICBpZighKHRoaXMgaW5zdGFuY2VvZiBIbWFjKSkgcmV0dXJuIG5ldyBIbWFjKGFsZywga2V5KQoJICB0aGlzLl9vcGFkID0gb3BhZAoJICB0aGlzLl9hbGcgPSBhbGcKCgkgIHZhciBibG9ja3NpemUgPSAoYWxnID09PSAnc2hhNTEyJykgPyAxMjggOiA2NAoKCSAga2V5ID0gdGhpcy5fa2V5ID0gIUJ1ZmZlci5pc0J1ZmZlcihrZXkpID8gbmV3IEJ1ZmZlcihrZXkpIDoga2V5CgoJICBpZihrZXkubGVuZ3RoID4gYmxvY2tzaXplKSB7CgkgICAga2V5ID0gY3JlYXRlSGFzaChhbGcpLnVwZGF0ZShrZXkpLmRpZ2VzdCgpCgkgIH0gZWxzZSBpZihrZXkubGVuZ3RoIDwgYmxvY2tzaXplKSB7CgkgICAga2V5ID0gQnVmZmVyLmNvbmNhdChba2V5LCB6ZXJvQnVmZmVyXSwgYmxvY2tzaXplKQoJICB9CgoJICB2YXIgaXBhZCA9IHRoaXMuX2lwYWQgPSBuZXcgQnVmZmVyKGJsb2Nrc2l6ZSkKCSAgdmFyIG9wYWQgPSB0aGlzLl9vcGFkID0gbmV3IEJ1ZmZlcihibG9ja3NpemUpCgoJICBmb3IodmFyIGkgPSAwOyBpIDwgYmxvY2tzaXplOyBpKyspIHsKCSAgICBpcGFkW2ldID0ga2V5W2ldIF4gMHgzNgoJICAgIG9wYWRbaV0gPSBrZXlbaV0gXiAweDVDCgkgIH0KCgkgIHRoaXMuX2hhc2ggPSBjcmVhdGVIYXNoKGFsZykudXBkYXRlKGlwYWQpCgl9CgoJSG1hYy5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGRhdGEsIGVuYykgewoJICB0aGlzLl9oYXNoLnVwZGF0ZShkYXRhLCBlbmMpCgkgIHJldHVybiB0aGlzCgl9CgoJSG1hYy5wcm90b3R5cGUuZGlnZXN0ID0gZnVuY3Rpb24gKGVuYykgewoJICB2YXIgaCA9IHRoaXMuX2hhc2guZGlnZXN0KCkKCSAgcmV0dXJuIGNyZWF0ZUhhc2godGhpcy5fYWxnKS51cGRhdGUodGhpcy5fb3BhZCkudXBkYXRlKGgpLmRpZ2VzdChlbmMpCgl9CgoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcikpCgovKioqLyB9LAovKiAyNSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgcGJrZGYyRXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNikKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChjcnlwdG8sIGV4cG9ydHMpIHsKCSAgZXhwb3J0cyA9IGV4cG9ydHMgfHwge30KCgkgIHZhciBleHBvcnRlZCA9IHBia2RmMkV4cG9ydChjcnlwdG8pCgoJICBleHBvcnRzLnBia2RmMiA9IGV4cG9ydGVkLnBia2RmMgoJICBleHBvcnRzLnBia2RmMlN5bmMgPSBleHBvcnRlZC5wYmtkZjJTeW5jCgoJICByZXR1cm4gZXhwb3J0cwoJfQoKCi8qKiovIH0sCi8qIDI2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIpIHttb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGNyeXB0bykgewoJICBmdW5jdGlvbiBwYmtkZjIocGFzc3dvcmQsIHNhbHQsIGl0ZXJhdGlvbnMsIGtleWxlbiwgZGlnZXN0LCBjYWxsYmFjaykgewoJICAgIGlmICgnZnVuY3Rpb24nID09PSB0eXBlb2YgZGlnZXN0KSB7CgkgICAgICBjYWxsYmFjayA9IGRpZ2VzdAoJICAgICAgZGlnZXN0ID0gdW5kZWZpbmVkCgkgICAgfQoKCSAgICBpZiAoJ2Z1bmN0aW9uJyAhPT0gdHlwZW9mIGNhbGxiYWNrKQoJICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBjYWxsYmFjayBwcm92aWRlZCB0byBwYmtkZjInKQoKCSAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewoJICAgICAgdmFyIHJlc3VsdAoKCSAgICAgIHRyeSB7CgkgICAgICAgIHJlc3VsdCA9IHBia2RmMlN5bmMocGFzc3dvcmQsIHNhbHQsIGl0ZXJhdGlvbnMsIGtleWxlbiwgZGlnZXN0KQoJICAgICAgfSBjYXRjaCAoZSkgewoJICAgICAgICByZXR1cm4gY2FsbGJhY2soZSkKCSAgICAgIH0KCgkgICAgICBjYWxsYmFjayh1bmRlZmluZWQsIHJlc3VsdCkKCSAgICB9KQoJICB9CgoJICBmdW5jdGlvbiBwYmtkZjJTeW5jKHBhc3N3b3JkLCBzYWx0LCBpdGVyYXRpb25zLCBrZXlsZW4sIGRpZ2VzdCkgewoJICAgIGlmICgnbnVtYmVyJyAhPT0gdHlwZW9mIGl0ZXJhdGlvbnMpCgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJdGVyYXRpb25zIG5vdCBhIG51bWJlcicpCgoJICAgIGlmIChpdGVyYXRpb25zIDwgMCkKCSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0JhZCBpdGVyYXRpb25zJykKCgkgICAgaWYgKCdudW1iZXInICE9PSB0eXBlb2Yga2V5bGVuKQoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignS2V5IGxlbmd0aCBub3QgYSBudW1iZXInKQoKCSAgICBpZiAoa2V5bGVuIDwgMCkKCSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0JhZCBrZXkgbGVuZ3RoJykKCgkgICAgZGlnZXN0ID0gZGlnZXN0IHx8ICdzaGExJwoKCSAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihwYXNzd29yZCkpIHBhc3N3b3JkID0gbmV3IEJ1ZmZlcihwYXNzd29yZCkKCSAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihzYWx0KSkgc2FsdCA9IG5ldyBCdWZmZXIoc2FsdCkKCgkgICAgdmFyIGhMZW4sIGwgPSAxLCByLCBUCgkgICAgdmFyIERLID0gbmV3IEJ1ZmZlcihrZXlsZW4pCgkgICAgdmFyIGJsb2NrMSA9IG5ldyBCdWZmZXIoc2FsdC5sZW5ndGggKyA0KQoJICAgIHNhbHQuY29weShibG9jazEsIDAsIDAsIHNhbHQubGVuZ3RoKQoKCSAgICBmb3IgKHZhciBpID0gMTsgaSA8PSBsOyBpKyspIHsKCSAgICAgIGJsb2NrMS53cml0ZVVJbnQzMkJFKGksIHNhbHQubGVuZ3RoKQoKCSAgICAgIHZhciBVID0gY3J5cHRvLmNyZWF0ZUhtYWMoZGlnZXN0LCBwYXNzd29yZCkudXBkYXRlKGJsb2NrMSkuZGlnZXN0KCkKCgkgICAgICBpZiAoIWhMZW4pIHsKCSAgICAgICAgaExlbiA9IFUubGVuZ3RoCgkgICAgICAgIFQgPSBuZXcgQnVmZmVyKGhMZW4pCgkgICAgICAgIGwgPSBNYXRoLmNlaWwoa2V5bGVuIC8gaExlbikKCSAgICAgICAgciA9IGtleWxlbiAtIChsIC0gMSkgKiBoTGVuCgoJICAgICAgICBpZiAoa2V5bGVuID4gKE1hdGgucG93KDIsIDMyKSAtIDEpICogaExlbikKCSAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdrZXlsZW4gZXhjZWVkcyBtYXhpbXVtIGxlbmd0aCcpCgkgICAgICB9CgoJICAgICAgVS5jb3B5KFQsIDAsIDAsIGhMZW4pCgoJICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBpdGVyYXRpb25zOyBqKyspIHsKCSAgICAgICAgVSA9IGNyeXB0by5jcmVhdGVIbWFjKGRpZ2VzdCwgcGFzc3dvcmQpLnVwZGF0ZShVKS5kaWdlc3QoKQoKCSAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBoTGVuOyBrKyspIHsKCSAgICAgICAgICBUW2tdIF49IFVba10KCSAgICAgICAgfQoJICAgICAgfQoKCSAgICAgIHZhciBkZXN0UG9zID0gKGkgLSAxKSAqIGhMZW4KCSAgICAgIHZhciBsZW4gPSAoaSA9PSBsID8gciA6IGhMZW4pCgkgICAgICBULmNvcHkoREssIGRlc3RQb3MsIDAsIGxlbikKCSAgICB9CgoJICAgIHJldHVybiBESwoJICB9CgoJICByZXR1cm4gewoJICAgIHBia2RmMjogcGJrZGYyLAoJICAgIHBia2RmMlN5bmM6IHBia2RmMlN5bmMKCSAgfQoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcikpCgovKioqLyB9LAovKiAyNyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChjcnlwdG8sIGV4cG9ydHMpIHsKCSAgZXhwb3J0cyA9IGV4cG9ydHMgfHwge307CgkgIHZhciBjaXBoZXJzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkoY3J5cHRvKTsKCSAgZXhwb3J0cy5jcmVhdGVDaXBoZXIgPSBjaXBoZXJzLmNyZWF0ZUNpcGhlcjsKCSAgZXhwb3J0cy5jcmVhdGVDaXBoZXJpdiA9IGNpcGhlcnMuY3JlYXRlQ2lwaGVyaXY7CgkgIHZhciBkZWNpcGhlcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKShjcnlwdG8pOwoJICBleHBvcnRzLmNyZWF0ZURlY2lwaGVyID0gZGVjaXBoZXJzLmNyZWF0ZURlY2lwaGVyOwoJICBleHBvcnRzLmNyZWF0ZURlY2lwaGVyaXYgPSBkZWNpcGhlcnMuY3JlYXRlRGVjaXBoZXJpdjsKCSAgdmFyIG1vZGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1Mik7CgkgIGZ1bmN0aW9uIGxpc3RDaXBoZXJzICgpIHsKCSAgICByZXR1cm4gT2JqZWN0LmtleXMobW9kZXMpOwoJICB9CgkgIGV4cG9ydHMubGlzdENpcGhlcnMgPSBsaXN0Q2lwaGVyczsKCX07CgoKCi8qKiovIH0sCi8qIDI4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIpIHt2YXIgYWVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSk7Cgl2YXIgVHJhbnNmb3JtID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCk7Cgl2YXIgaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKTsKCXZhciBtb2RlcyA9IF9fd2VicGFja19yZXF1aXJlX18oNTIpOwoJdmFyIGVidGsgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUzKTsKCXZhciBTdHJlYW1DaXBoZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KTsKCWluaGVyaXRzKENpcGhlciwgVHJhbnNmb3JtKTsKCWZ1bmN0aW9uIENpcGhlcihtb2RlLCBrZXksIGl2KSB7CgkgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBDaXBoZXIpKSB7CgkgICAgcmV0dXJuIG5ldyBDaXBoZXIobW9kZSwga2V5LCBpdik7CgkgIH0KCSAgVHJhbnNmb3JtLmNhbGwodGhpcyk7CgkgIHRoaXMuX2NhY2hlID0gbmV3IFNwbGl0dGVyKCk7CgkgIHRoaXMuX2NpcGhlciA9IG5ldyBhZXMuQUVTKGtleSk7CgkgIHRoaXMuX3ByZXYgPSBuZXcgQnVmZmVyKGl2Lmxlbmd0aCk7CgkgIGl2LmNvcHkodGhpcy5fcHJldik7CgkgIHRoaXMuX21vZGUgPSBtb2RlOwoJfQoJQ2lwaGVyLnByb3RvdHlwZS5fdHJhbnNmb3JtID0gZnVuY3Rpb24gKGRhdGEsIF8sIG5leHQpIHsKCSAgdGhpcy5fY2FjaGUuYWRkKGRhdGEpOwoJICB2YXIgY2h1bms7CgkgIHZhciB0aGluZzsKCSAgd2hpbGUgKChjaHVuayA9IHRoaXMuX2NhY2hlLmdldCgpKSkgewoJICAgIHRoaW5nID0gdGhpcy5fbW9kZS5lbmNyeXB0KHRoaXMsIGNodW5rKTsKCSAgICB0aGlzLnB1c2godGhpbmcpOwoJICB9CgkgIG5leHQoKTsKCX07CglDaXBoZXIucHJvdG90eXBlLl9mbHVzaCA9IGZ1bmN0aW9uIChuZXh0KSB7CgkgIHZhciBjaHVuayA9IHRoaXMuX2NhY2hlLmZsdXNoKCk7CgkgIHRoaXMucHVzaCh0aGlzLl9tb2RlLmVuY3J5cHQodGhpcywgY2h1bmspKTsKCSAgdGhpcy5fY2lwaGVyLnNjcnViKCk7CgkgIG5leHQoKTsKCX07CgoKCWZ1bmN0aW9uIFNwbGl0dGVyKCkgewoJICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFNwbGl0dGVyKSkgewoJICAgIHJldHVybiBuZXcgU3BsaXR0ZXIoKTsKCSAgfQoJICB0aGlzLmNhY2hlID0gbmV3IEJ1ZmZlcignJyk7Cgl9CglTcGxpdHRlci5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGRhdGEpIHsKCSAgdGhpcy5jYWNoZSA9IEJ1ZmZlci5jb25jYXQoW3RoaXMuY2FjaGUsIGRhdGFdKTsKCX07CgoJU3BsaXR0ZXIucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICgpIHsKCSAgaWYgKHRoaXMuY2FjaGUubGVuZ3RoID4gMTUpIHsKCSAgICB2YXIgb3V0ID0gdGhpcy5jYWNoZS5zbGljZSgwLCAxNik7CgkgICAgdGhpcy5jYWNoZSA9IHRoaXMuY2FjaGUuc2xpY2UoMTYpOwoJICAgIHJldHVybiBvdXQ7CgkgIH0KCSAgcmV0dXJuIG51bGw7Cgl9OwoJU3BsaXR0ZXIucHJvdG90eXBlLmZsdXNoID0gZnVuY3Rpb24gKCkgewoJICB2YXIgbGVuID0gMTYgLSB0aGlzLmNhY2hlLmxlbmd0aDsKCSAgdmFyIHBhZEJ1ZmYgPSBuZXcgQnVmZmVyKGxlbik7CgoJICB2YXIgaSA9IC0xOwoJICB3aGlsZSAoKytpIDwgbGVuKSB7CgkgICAgcGFkQnVmZi53cml0ZVVJbnQ4KGxlbiwgaSk7CgkgIH0KCSAgdmFyIG91dCA9IEJ1ZmZlci5jb25jYXQoW3RoaXMuY2FjaGUsIHBhZEJ1ZmZdKTsKCSAgcmV0dXJuIG91dDsKCX07Cgl2YXIgbW9kZWxpc3QgPSB7CgkgIEVDQjogX193ZWJwYWNrX3JlcXVpcmVfXyg1NSksCgkgIENCQzogX193ZWJwYWNrX3JlcXVpcmVfXyg1NiksCgkgIENGQjogX193ZWJwYWNrX3JlcXVpcmVfXyg1OCksCgkgIE9GQjogX193ZWJwYWNrX3JlcXVpcmVfXyg1OSksCgkgIENUUjogX193ZWJwYWNrX3JlcXVpcmVfXyg2MCkKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChjcnlwdG8pIHsKCSAgZnVuY3Rpb24gY3JlYXRlQ2lwaGVyaXYoc3VpdGUsIHBhc3N3b3JkLCBpdikgewoJICAgIHZhciBjb25maWcgPSBtb2Rlc1tzdWl0ZV07CgkgICAgaWYgKCFjb25maWcpIHsKCSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2ludmFsaWQgc3VpdGUgdHlwZScpOwoJICAgIH0KCSAgICBpZiAodHlwZW9mIGl2ID09PSAnc3RyaW5nJykgewoJICAgICAgaXYgPSBuZXcgQnVmZmVyKGl2KTsKCSAgICB9CgkgICAgaWYgKHR5cGVvZiBwYXNzd29yZCA9PT0gJ3N0cmluZycpIHsKCSAgICAgIHBhc3N3b3JkID0gbmV3IEJ1ZmZlcihwYXNzd29yZCk7CgkgICAgfQoJICAgIGlmIChwYXNzd29yZC5sZW5ndGggIT09IGNvbmZpZy5rZXkvOCkgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaW52YWxpZCBrZXkgbGVuZ3RoICcgKyBwYXNzd29yZC5sZW5ndGgpOwoJICAgIH0KCSAgICBpZiAoaXYubGVuZ3RoICE9PSBjb25maWcuaXYpIHsKCSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2ludmFsaWQgaXYgbGVuZ3RoICcgKyBpdi5sZW5ndGgpOwoJICAgIH0KCSAgICBpZiAoY29uZmlnLnR5cGUgPT09ICdzdHJlYW0nKSB7CgkgICAgICByZXR1cm4gbmV3IFN0cmVhbUNpcGhlcihtb2RlbGlzdFtjb25maWcubW9kZV0sIHBhc3N3b3JkLCBpdik7CgkgICAgfQoJICAgIHJldHVybiBuZXcgQ2lwaGVyKG1vZGVsaXN0W2NvbmZpZy5tb2RlXSwgcGFzc3dvcmQsIGl2KTsKCSAgfQoJICBmdW5jdGlvbiBjcmVhdGVDaXBoZXIgKHN1aXRlLCBwYXNzd29yZCkgewoJICAgIHZhciBjb25maWcgPSBtb2Rlc1tzdWl0ZV07CgkgICAgaWYgKCFjb25maWcpIHsKCSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2ludmFsaWQgc3VpdGUgdHlwZScpOwoJICAgIH0KCSAgICB2YXIga2V5cyA9IGVidGsoY3J5cHRvLCBwYXNzd29yZCwgY29uZmlnLmtleSwgY29uZmlnLml2KTsKCSAgICByZXR1cm4gY3JlYXRlQ2lwaGVyaXYoc3VpdGUsIGtleXMua2V5LCBrZXlzLml2KTsKCSAgfQoJICByZXR1cm4gewoJICAgIGNyZWF0ZUNpcGhlcjogY3JlYXRlQ2lwaGVyLAoJICAgIGNyZWF0ZUNpcGhlcml2OiBjcmVhdGVDaXBoZXJpdgoJICB9OwoJfTsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5CdWZmZXIpKQoKLyoqKi8gfSwKLyogMjkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKEJ1ZmZlcikge3ZhciB1aW50X21heCA9IE1hdGgucG93KDIsIDMyKTsKCWZ1bmN0aW9uIGZpeHVwX3VpbnQzMih4KSB7CgkgICAgdmFyIHJldCwgeF9wb3M7CgkgICAgcmV0ID0geCA+IHVpbnRfbWF4IHx8IHggPCAwID8gKHhfcG9zID0gTWF0aC5hYnMoeCkgJSB1aW50X21heCwgeCA8IDAgPyB1aW50X21heCAtIHhfcG9zIDogeF9wb3MpIDogeDsKCSAgICByZXR1cm4gcmV0OwoJfQoJZnVuY3Rpb24gc2NydWJfdmVjKHYpIHsKCSAgdmFyIGksIF9pLCBfcmVmOwoJICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSB2Lmxlbmd0aDsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKCSAgICB2W2ldID0gMDsKCSAgfQoJICByZXR1cm4gZmFsc2U7Cgl9CgoJZnVuY3Rpb24gR2xvYmFsKCkgewoJICB2YXIgaTsKCSAgdGhpcy5TQk9YID0gW107CgkgIHRoaXMuSU5WX1NCT1ggPSBbXTsKCSAgdGhpcy5TVUJfTUlYID0gKGZ1bmN0aW9uKCkgewoJICAgIHZhciBfaSwgX3Jlc3VsdHM7CgkgICAgX3Jlc3VsdHMgPSBbXTsKCSAgICBmb3IgKGkgPSBfaSA9IDA7IF9pIDwgNDsgaSA9ICsrX2kpIHsKCSAgICAgIF9yZXN1bHRzLnB1c2goW10pOwoJICAgIH0KCSAgICByZXR1cm4gX3Jlc3VsdHM7CgkgIH0pKCk7CgkgIHRoaXMuSU5WX1NVQl9NSVggPSAoZnVuY3Rpb24oKSB7CgkgICAgdmFyIF9pLCBfcmVzdWx0czsKCSAgICBfcmVzdWx0cyA9IFtdOwoJICAgIGZvciAoaSA9IF9pID0gMDsgX2kgPCA0OyBpID0gKytfaSkgewoJICAgICAgX3Jlc3VsdHMucHVzaChbXSk7CgkgICAgfQoJICAgIHJldHVybiBfcmVzdWx0czsKCSAgfSkoKTsKCSAgdGhpcy5pbml0KCk7CgkgIHRoaXMuUkNPTiA9IFsweDAwLCAweDAxLCAweDAyLCAweDA0LCAweDA4LCAweDEwLCAweDIwLCAweDQwLCAweDgwLCAweDFiLCAweDM2XTsKCX0KCglHbG9iYWwucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHsKCSAgdmFyIGQsIGksIHN4LCB0LCB4LCB4MiwgeDQsIHg4LCB4aSwgX2k7CgkgIGQgPSAoZnVuY3Rpb24oKSB7CgkgICAgdmFyIF9pLCBfcmVzdWx0czsKCSAgICBfcmVzdWx0cyA9IFtdOwoJICAgIGZvciAoaSA9IF9pID0gMDsgX2kgPCAyNTY7IGkgPSArK19pKSB7CgkgICAgICBpZiAoaSA8IDEyOCkgewoJICAgICAgICBfcmVzdWx0cy5wdXNoKGkgPDwgMSk7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBfcmVzdWx0cy5wdXNoKChpIDw8IDEpIF4gMHgxMWIpOwoJICAgICAgfQoJICAgIH0KCSAgICByZXR1cm4gX3Jlc3VsdHM7CgkgIH0pKCk7CgkgIHggPSAwOwoJICB4aSA9IDA7CgkgIGZvciAoaSA9IF9pID0gMDsgX2kgPCAyNTY7IGkgPSArK19pKSB7CgkgICAgc3ggPSB4aSBeICh4aSA8PCAxKSBeICh4aSA8PCAyKSBeICh4aSA8PCAzKSBeICh4aSA8PCA0KTsKCSAgICBzeCA9IChzeCA+Pj4gOCkgXiAoc3ggJiAweGZmKSBeIDB4NjM7CgkgICAgdGhpcy5TQk9YW3hdID0gc3g7CgkgICAgdGhpcy5JTlZfU0JPWFtzeF0gPSB4OwoJICAgIHgyID0gZFt4XTsKCSAgICB4NCA9IGRbeDJdOwoJICAgIHg4ID0gZFt4NF07CgkgICAgdCA9IChkW3N4XSAqIDB4MTAxKSBeIChzeCAqIDB4MTAxMDEwMCk7CgkgICAgdGhpcy5TVUJfTUlYWzBdW3hdID0gKHQgPDwgMjQpIHwgKHQgPj4+IDgpOwoJICAgIHRoaXMuU1VCX01JWFsxXVt4XSA9ICh0IDw8IDE2KSB8ICh0ID4+PiAxNik7CgkgICAgdGhpcy5TVUJfTUlYWzJdW3hdID0gKHQgPDwgOCkgfCAodCA+Pj4gMjQpOwoJICAgIHRoaXMuU1VCX01JWFszXVt4XSA9IHQ7CgkgICAgdCA9ICh4OCAqIDB4MTAxMDEwMSkgXiAoeDQgKiAweDEwMDAxKSBeICh4MiAqIDB4MTAxKSBeICh4ICogMHgxMDEwMTAwKTsKCSAgICB0aGlzLklOVl9TVUJfTUlYWzBdW3N4XSA9ICh0IDw8IDI0KSB8ICh0ID4+PiA4KTsKCSAgICB0aGlzLklOVl9TVUJfTUlYWzFdW3N4XSA9ICh0IDw8IDE2KSB8ICh0ID4+PiAxNik7CgkgICAgdGhpcy5JTlZfU1VCX01JWFsyXVtzeF0gPSAodCA8PCA4KSB8ICh0ID4+PiAyNCk7CgkgICAgdGhpcy5JTlZfU1VCX01JWFszXVtzeF0gPSB0OwoJICAgIGlmICh4ID09PSAwKSB7CgkgICAgICB4ID0geGkgPSAxOwoJICAgIH0gZWxzZSB7CgkgICAgICB4ID0geDIgXiBkW2RbZFt4OCBeIHgyXV1dOwoJICAgICAgeGkgXj0gZFtkW3hpXV07CgkgICAgfQoJICB9CgkgIHJldHVybiB0cnVlOwoJfTsKCgl2YXIgRyA9IG5ldyBHbG9iYWwoKTsKCgoJQUVTLmJsb2NrU2l6ZSA9IDQgKiA0OwoKCUFFUy5wcm90b3R5cGUuYmxvY2tTaXplID0gQUVTLmJsb2NrU2l6ZTsKCglBRVMua2V5U2l6ZSA9IDI1NiAvIDg7CgoJQUVTLnByb3RvdHlwZS5rZXlTaXplID0gQUVTLmtleVNpemU7CgoJQUVTLml2U2l6ZSA9IEFFUy5ibG9ja1NpemU7CgoJQUVTLnByb3RvdHlwZS5pdlNpemUgPSBBRVMuaXZTaXplOwoKCSBmdW5jdGlvbiBidWZmZXJUb0FycmF5KGJ1ZikgewoJICB2YXIgbGVuID0gYnVmLmxlbmd0aC80OwoJICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbik7CgkgIHZhciBpID0gLTE7CgkgIHdoaWxlICgrK2kgPCBsZW4pIHsKCSAgICBvdXRbaV0gPSBidWYucmVhZFVJbnQzMkJFKGkgKiA0KTsKCSAgfQoJICByZXR1cm4gb3V0OwoJIH0KCWZ1bmN0aW9uIEFFUyhrZXkpIHsKCSAgdGhpcy5fa2V5ID0gYnVmZmVyVG9BcnJheShrZXkpOwoJICB0aGlzLl9kb1Jlc2V0KCk7Cgl9CgoJQUVTLnByb3RvdHlwZS5fZG9SZXNldCA9IGZ1bmN0aW9uKCkgewoJICB2YXIgaW52S3NSb3csIGtleVNpemUsIGtleVdvcmRzLCBrc1Jvdywga3NSb3dzLCB0LCBfaSwgX2o7CgkgIGtleVdvcmRzID0gdGhpcy5fa2V5OwoJICBrZXlTaXplID0ga2V5V29yZHMubGVuZ3RoOwoJICB0aGlzLl9uUm91bmRzID0ga2V5U2l6ZSArIDY7CgkgIGtzUm93cyA9ICh0aGlzLl9uUm91bmRzICsgMSkgKiA0OwoJICB0aGlzLl9rZXlTY2hlZHVsZSA9IFtdOwoJICBmb3IgKGtzUm93ID0gX2kgPSAwOyAwIDw9IGtzUm93cyA/IF9pIDwga3NSb3dzIDogX2kgPiBrc1Jvd3M7IGtzUm93ID0gMCA8PSBrc1Jvd3MgPyArK19pIDogLS1faSkgewoJICAgIHRoaXMuX2tleVNjaGVkdWxlW2tzUm93XSA9IGtzUm93IDwga2V5U2l6ZSA/IGtleVdvcmRzW2tzUm93XSA6ICh0ID0gdGhpcy5fa2V5U2NoZWR1bGVba3NSb3cgLSAxXSwgKGtzUm93ICUga2V5U2l6ZSkgPT09IDAgPyAodCA9ICh0IDw8IDgpIHwgKHQgPj4+IDI0KSwgdCA9IChHLlNCT1hbdCA+Pj4gMjRdIDw8IDI0KSB8IChHLlNCT1hbKHQgPj4+IDE2KSAmIDB4ZmZdIDw8IDE2KSB8IChHLlNCT1hbKHQgPj4+IDgpICYgMHhmZl0gPDwgOCkgfCBHLlNCT1hbdCAmIDB4ZmZdLCB0IF49IEcuUkNPTlsoa3NSb3cgLyBrZXlTaXplKSB8IDBdIDw8IDI0KSA6IGtleVNpemUgPiA2ICYmIGtzUm93ICUga2V5U2l6ZSA9PT0gNCA/IHQgPSAoRy5TQk9YW3QgPj4+IDI0XSA8PCAyNCkgfCAoRy5TQk9YWyh0ID4+PiAxNikgJiAweGZmXSA8PCAxNikgfCAoRy5TQk9YWyh0ID4+PiA4KSAmIDB4ZmZdIDw8IDgpIHwgRy5TQk9YW3QgJiAweGZmXSA6IHZvaWQgMCwgdGhpcy5fa2V5U2NoZWR1bGVba3NSb3cgLSBrZXlTaXplXSBeIHQpOwoJICB9CgkgIHRoaXMuX2ludktleVNjaGVkdWxlID0gW107CgkgIGZvciAoaW52S3NSb3cgPSBfaiA9IDA7IDAgPD0ga3NSb3dzID8gX2ogPCBrc1Jvd3MgOiBfaiA+IGtzUm93czsgaW52S3NSb3cgPSAwIDw9IGtzUm93cyA/ICsrX2ogOiAtLV9qKSB7CgkgICAga3NSb3cgPSBrc1Jvd3MgLSBpbnZLc1JvdzsKCSAgICB0ID0gdGhpcy5fa2V5U2NoZWR1bGVba3NSb3cgLSAoaW52S3NSb3cgJSA0ID8gMCA6IDQpXTsKCSAgICB0aGlzLl9pbnZLZXlTY2hlZHVsZVtpbnZLc1Jvd10gPSBpbnZLc1JvdyA8IDQgfHwga3NSb3cgPD0gNCA/IHQgOiBHLklOVl9TVUJfTUlYWzBdW0cuU0JPWFt0ID4+PiAyNF1dIF4gRy5JTlZfU1VCX01JWFsxXVtHLlNCT1hbKHQgPj4+IDE2KSAmIDB4ZmZdXSBeIEcuSU5WX1NVQl9NSVhbMl1bRy5TQk9YWyh0ID4+PiA4KSAmIDB4ZmZdXSBeIEcuSU5WX1NVQl9NSVhbM11bRy5TQk9YW3QgJiAweGZmXV07CgkgIH0KCSAgcmV0dXJuIHRydWU7Cgl9OwoKCUFFUy5wcm90b3R5cGUuZW5jcnlwdEJsb2NrID0gZnVuY3Rpb24oTSkgewoJICBNID0gYnVmZmVyVG9BcnJheShuZXcgQnVmZmVyKE0pKTsKCSAgdmFyIG91dCA9IHRoaXMuX2RvQ3J5cHRCbG9jayhNLCB0aGlzLl9rZXlTY2hlZHVsZSwgRy5TVUJfTUlYLCBHLlNCT1gpOwoJICB2YXIgYnVmID0gbmV3IEJ1ZmZlcigxNik7CgkgIGJ1Zi53cml0ZVVJbnQzMkJFKG91dFswXSwgMCk7CgkgIGJ1Zi53cml0ZVVJbnQzMkJFKG91dFsxXSwgNCk7CgkgIGJ1Zi53cml0ZVVJbnQzMkJFKG91dFsyXSwgOCk7CgkgIGJ1Zi53cml0ZVVJbnQzMkJFKG91dFszXSwgMTIpOwoJICByZXR1cm4gYnVmOwoJfTsKCglBRVMucHJvdG90eXBlLmRlY3J5cHRCbG9jayA9IGZ1bmN0aW9uKE0pIHsKCSAgTSA9IGJ1ZmZlclRvQXJyYXkobmV3IEJ1ZmZlcihNKSk7CgkgIHZhciB0ZW1wID0gW01bM10sIE1bMV1dOwoJICBNWzFdID0gdGVtcFswXTsKCSAgTVszXSA9IHRlbXBbMV07CgkgIHZhciBvdXQgPSB0aGlzLl9kb0NyeXB0QmxvY2soTSwgdGhpcy5faW52S2V5U2NoZWR1bGUsIEcuSU5WX1NVQl9NSVgsIEcuSU5WX1NCT1gpOwoJICB2YXIgYnVmID0gbmV3IEJ1ZmZlcigxNik7CgkgIGJ1Zi53cml0ZVVJbnQzMkJFKG91dFswXSwgMCk7CgkgIGJ1Zi53cml0ZVVJbnQzMkJFKG91dFszXSwgNCk7CgkgIGJ1Zi53cml0ZVVJbnQzMkJFKG91dFsyXSwgOCk7CgkgIGJ1Zi53cml0ZVVJbnQzMkJFKG91dFsxXSwgMTIpOwoJICByZXR1cm4gYnVmOwoJfTsKCglBRVMucHJvdG90eXBlLnNjcnViID0gZnVuY3Rpb24oKSB7CgkgIHNjcnViX3ZlYyh0aGlzLl9rZXlTY2hlZHVsZSk7CgkgIHNjcnViX3ZlYyh0aGlzLl9pbnZLZXlTY2hlZHVsZSk7CgkgIHNjcnViX3ZlYyh0aGlzLl9rZXkpOwoJfTsKCglBRVMucHJvdG90eXBlLl9kb0NyeXB0QmxvY2sgPSBmdW5jdGlvbihNLCBrZXlTY2hlZHVsZSwgU1VCX01JWCwgU0JPWCkgewoJICB2YXIga3NSb3csIHJvdW5kLCBzMCwgczEsIHMyLCBzMywgdDAsIHQxLCB0MiwgdDMsIF9pLCBfcmVmOwoKCSAgczAgPSBNWzBdIF4ga2V5U2NoZWR1bGVbMF07CgkgIHMxID0gTVsxXSBeIGtleVNjaGVkdWxlWzFdOwoJICBzMiA9IE1bMl0gXiBrZXlTY2hlZHVsZVsyXTsKCSAgczMgPSBNWzNdIF4ga2V5U2NoZWR1bGVbM107CgkgIGtzUm93ID0gNDsKCSAgZm9yIChyb3VuZCA9IF9pID0gMSwgX3JlZiA9IHRoaXMuX25Sb3VuZHM7IDEgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgcm91bmQgPSAxIDw9IF9yZWYgPyArK19pIDogLS1faSkgewoJICAgIHQwID0gU1VCX01JWFswXVtzMCA+Pj4gMjRdIF4gU1VCX01JWFsxXVsoczEgPj4+IDE2KSAmIDB4ZmZdIF4gU1VCX01JWFsyXVsoczIgPj4+IDgpICYgMHhmZl0gXiBTVUJfTUlYWzNdW3MzICYgMHhmZl0gXiBrZXlTY2hlZHVsZVtrc1JvdysrXTsKCSAgICB0MSA9IFNVQl9NSVhbMF1bczEgPj4+IDI0XSBeIFNVQl9NSVhbMV1bKHMyID4+PiAxNikgJiAweGZmXSBeIFNVQl9NSVhbMl1bKHMzID4+PiA4KSAmIDB4ZmZdIF4gU1VCX01JWFszXVtzMCAmIDB4ZmZdIF4ga2V5U2NoZWR1bGVba3NSb3crK107CgkgICAgdDIgPSBTVUJfTUlYWzBdW3MyID4+PiAyNF0gXiBTVUJfTUlYWzFdWyhzMyA+Pj4gMTYpICYgMHhmZl0gXiBTVUJfTUlYWzJdWyhzMCA+Pj4gOCkgJiAweGZmXSBeIFNVQl9NSVhbM11bczEgJiAweGZmXSBeIGtleVNjaGVkdWxlW2tzUm93KytdOwoJICAgIHQzID0gU1VCX01JWFswXVtzMyA+Pj4gMjRdIF4gU1VCX01JWFsxXVsoczAgPj4+IDE2KSAmIDB4ZmZdIF4gU1VCX01JWFsyXVsoczEgPj4+IDgpICYgMHhmZl0gXiBTVUJfTUlYWzNdW3MyICYgMHhmZl0gXiBrZXlTY2hlZHVsZVtrc1JvdysrXTsKCSAgICBzMCA9IHQwOwoJICAgIHMxID0gdDE7CgkgICAgczIgPSB0MjsKCSAgICBzMyA9IHQzOwoJICB9CgkgIHQwID0gKChTQk9YW3MwID4+PiAyNF0gPDwgMjQpIHwgKFNCT1hbKHMxID4+PiAxNikgJiAweGZmXSA8PCAxNikgfCAoU0JPWFsoczIgPj4+IDgpICYgMHhmZl0gPDwgOCkgfCBTQk9YW3MzICYgMHhmZl0pIF4ga2V5U2NoZWR1bGVba3NSb3crK107CgkgIHQxID0gKChTQk9YW3MxID4+PiAyNF0gPDwgMjQpIHwgKFNCT1hbKHMyID4+PiAxNikgJiAweGZmXSA8PCAxNikgfCAoU0JPWFsoczMgPj4+IDgpICYgMHhmZl0gPDwgOCkgfCBTQk9YW3MwICYgMHhmZl0pIF4ga2V5U2NoZWR1bGVba3NSb3crK107CgkgIHQyID0gKChTQk9YW3MyID4+PiAyNF0gPDwgMjQpIHwgKFNCT1hbKHMzID4+PiAxNikgJiAweGZmXSA8PCAxNikgfCAoU0JPWFsoczAgPj4+IDgpICYgMHhmZl0gPDwgOCkgfCBTQk9YW3MxICYgMHhmZl0pIF4ga2V5U2NoZWR1bGVba3NSb3crK107CgkgIHQzID0gKChTQk9YW3MzID4+PiAyNF0gPDwgMjQpIHwgKFNCT1hbKHMwID4+PiAxNikgJiAweGZmXSA8PCAxNikgfCAoU0JPWFsoczEgPj4+IDgpICYgMHhmZl0gPDwgOCkgfCBTQk9YW3MyICYgMHhmZl0pIF4ga2V5U2NoZWR1bGVba3NSb3crK107CgkgIHJldHVybiBbCgkgICAgZml4dXBfdWludDMyKHQwKSwKCSAgICBmaXh1cF91aW50MzIodDEpLAoJICAgIGZpeHVwX3VpbnQzMih0MiksCgkgICAgZml4dXBfdWludDMyKHQzKQoJICBdOwoKCX07CgoKCgoJICBleHBvcnRzLkFFUyA9IEFFUzsKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcikpCgovKioqLyB9LAovKiAzMCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oQnVmZmVyKSB7dmFyIFRyYW5zZm9ybSA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpLlRyYW5zZm9ybTsKCXZhciBpbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpOwoKCW1vZHVsZS5leHBvcnRzID0gQ2lwaGVyQmFzZTsKCWluaGVyaXRzKENpcGhlckJhc2UsIFRyYW5zZm9ybSk7CglmdW5jdGlvbiBDaXBoZXJCYXNlKCkgewoJICBUcmFuc2Zvcm0uY2FsbCh0aGlzKTsKCX0KCUNpcGhlckJhc2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkYXRhLCBpbnB1dEVuZCwgb3V0cHV0RW5jKSB7CgkgIHRoaXMud3JpdGUoZGF0YSwgaW5wdXRFbmQpOwoJICB2YXIgb3V0RGF0YSA9IG5ldyBCdWZmZXIoJycpOwoJICB2YXIgY2h1bms7CgkgIHdoaWxlICgoY2h1bmsgPSB0aGlzLnJlYWQoKSkpIHsKCSAgICBvdXREYXRhID0gQnVmZmVyLmNvbmNhdChbb3V0RGF0YSwgY2h1bmtdKTsKCSAgfQoJICBpZiAob3V0cHV0RW5jKSB7CgkgICAgb3V0RGF0YSA9IG91dERhdGEudG9TdHJpbmcob3V0cHV0RW5jKTsKCSAgfQoJICByZXR1cm4gb3V0RGF0YTsKCX07CglDaXBoZXJCYXNlLnByb3RvdHlwZS5maW5hbCA9IGZ1bmN0aW9uIChvdXRwdXRFbmMpIHsKCSAgdGhpcy5lbmQoKTsKCSAgdmFyIG91dERhdGEgPSBuZXcgQnVmZmVyKCcnKTsKCSAgdmFyIGNodW5rOwoJICB3aGlsZSAoKGNodW5rID0gdGhpcy5yZWFkKCkpKSB7CgkgICAgb3V0RGF0YSA9IEJ1ZmZlci5jb25jYXQoW291dERhdGEsIGNodW5rXSk7CgkgIH0KCSAgaWYgKG91dHB1dEVuYykgewoJICAgIG91dERhdGEgPSBvdXREYXRhLnRvU3RyaW5nKG91dHB1dEVuYyk7CgkgIH0KCSAgcmV0dXJuIG91dERhdGE7Cgl9OwoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oNSkuQnVmZmVyKSkKCi8qKiovIH0sCi8qIDMxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLgoJLy8KCS8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCgkvLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCgkvLyAiU29mdHdhcmUiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nCgkvLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCgkvLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0CgkvLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUKCS8vIGZvbGxvd2luZyBjb25kaXRpb25zOgoJLy8KCS8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkCgkvLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCS8vCgkvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUwoJLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgoJLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTgoJLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sCgkvLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKCS8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUKCS8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCgoJbW9kdWxlLmV4cG9ydHMgPSBTdHJlYW07CgoJdmFyIEVFID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKS5FdmVudEVtaXR0ZXI7Cgl2YXIgaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKTsKCglpbmhlcml0cyhTdHJlYW0sIEVFKTsKCVN0cmVhbS5SZWFkYWJsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMzMpOwoJU3RyZWFtLldyaXRhYmxlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OCk7CglTdHJlYW0uRHVwbGV4ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CglTdHJlYW0uVHJhbnNmb3JtID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7CglTdHJlYW0uUGFzc1Rocm91Z2ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKCgkvLyBCYWNrd2FyZHMtY29tcGF0IHdpdGggbm9kZSAwLjQueAoJU3RyZWFtLlN0cmVhbSA9IFN0cmVhbTsKCgoKCS8vIG9sZC1zdHlsZSBzdHJlYW1zLiAgTm90ZSB0aGF0IHRoZSBwaXBlIG1ldGhvZCAodGhlIG9ubHkgcmVsZXZhbnQKCS8vIHBhcnQgb2YgdGhpcyBjbGFzcykgaXMgb3ZlcnJpZGRlbiBpbiB0aGUgUmVhZGFibGUgY2xhc3MuCgoJZnVuY3Rpb24gU3RyZWFtKCkgewoJICBFRS5jYWxsKHRoaXMpOwoJfQoKCVN0cmVhbS5wcm90b3R5cGUucGlwZSA9IGZ1bmN0aW9uKGRlc3QsIG9wdGlvbnMpIHsKCSAgdmFyIHNvdXJjZSA9IHRoaXM7CgoJICBmdW5jdGlvbiBvbmRhdGEoY2h1bmspIHsKCSAgICBpZiAoZGVzdC53cml0YWJsZSkgewoJICAgICAgaWYgKGZhbHNlID09PSBkZXN0LndyaXRlKGNodW5rKSAmJiBzb3VyY2UucGF1c2UpIHsKCSAgICAgICAgc291cmNlLnBhdXNlKCk7CgkgICAgICB9CgkgICAgfQoJICB9CgoJICBzb3VyY2Uub24oJ2RhdGEnLCBvbmRhdGEpOwoKCSAgZnVuY3Rpb24gb25kcmFpbigpIHsKCSAgICBpZiAoc291cmNlLnJlYWRhYmxlICYmIHNvdXJjZS5yZXN1bWUpIHsKCSAgICAgIHNvdXJjZS5yZXN1bWUoKTsKCSAgICB9CgkgIH0KCgkgIGRlc3Qub24oJ2RyYWluJywgb25kcmFpbik7CgoJICAvLyBJZiB0aGUgJ2VuZCcgb3B0aW9uIGlzIG5vdCBzdXBwbGllZCwgZGVzdC5lbmQoKSB3aWxsIGJlIGNhbGxlZCB3aGVuCgkgIC8vIHNvdXJjZSBnZXRzIHRoZSAnZW5kJyBvciAnY2xvc2UnIGV2ZW50cy4gIE9ubHkgZGVzdC5lbmQoKSBvbmNlLgoJICBpZiAoIWRlc3QuX2lzU3RkaW8gJiYgKCFvcHRpb25zIHx8IG9wdGlvbnMuZW5kICE9PSBmYWxzZSkpIHsKCSAgICBzb3VyY2Uub24oJ2VuZCcsIG9uZW5kKTsKCSAgICBzb3VyY2Uub24oJ2Nsb3NlJywgb25jbG9zZSk7CgkgIH0KCgkgIHZhciBkaWRPbkVuZCA9IGZhbHNlOwoJICBmdW5jdGlvbiBvbmVuZCgpIHsKCSAgICBpZiAoZGlkT25FbmQpIHJldHVybjsKCSAgICBkaWRPbkVuZCA9IHRydWU7CgoJICAgIGRlc3QuZW5kKCk7CgkgIH0KCgoJICBmdW5jdGlvbiBvbmNsb3NlKCkgewoJICAgIGlmIChkaWRPbkVuZCkgcmV0dXJuOwoJICAgIGRpZE9uRW5kID0gdHJ1ZTsKCgkgICAgaWYgKHR5cGVvZiBkZXN0LmRlc3Ryb3kgPT09ICdmdW5jdGlvbicpIGRlc3QuZGVzdHJveSgpOwoJICB9CgoJICAvLyBkb24ndCBsZWF2ZSBkYW5nbGluZyBwaXBlcyB3aGVuIHRoZXJlIGFyZSBlcnJvcnMuCgkgIGZ1bmN0aW9uIG9uZXJyb3IoZXIpIHsKCSAgICBjbGVhbnVwKCk7CgkgICAgaWYgKEVFLmxpc3RlbmVyQ291bnQodGhpcywgJ2Vycm9yJykgPT09IDApIHsKCSAgICAgIHRocm93IGVyOyAvLyBVbmhhbmRsZWQgc3RyZWFtIGVycm9yIGluIHBpcGUuCgkgICAgfQoJICB9CgoJICBzb3VyY2Uub24oJ2Vycm9yJywgb25lcnJvcik7CgkgIGRlc3Qub24oJ2Vycm9yJywgb25lcnJvcik7CgoJICAvLyByZW1vdmUgYWxsIHRoZSBldmVudCBsaXN0ZW5lcnMgdGhhdCB3ZXJlIGFkZGVkLgoJICBmdW5jdGlvbiBjbGVhbnVwKCkgewoJICAgIHNvdXJjZS5yZW1vdmVMaXN0ZW5lcignZGF0YScsIG9uZGF0YSk7CgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignZHJhaW4nLCBvbmRyYWluKTsKCgkgICAgc291cmNlLnJlbW92ZUxpc3RlbmVyKCdlbmQnLCBvbmVuZCk7CgkgICAgc291cmNlLnJlbW92ZUxpc3RlbmVyKCdjbG9zZScsIG9uY2xvc2UpOwoKCSAgICBzb3VyY2UucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25lcnJvcik7CgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBvbmVycm9yKTsKCgkgICAgc291cmNlLnJlbW92ZUxpc3RlbmVyKCdlbmQnLCBjbGVhbnVwKTsKCSAgICBzb3VyY2UucmVtb3ZlTGlzdGVuZXIoJ2Nsb3NlJywgY2xlYW51cCk7CgoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2Nsb3NlJywgY2xlYW51cCk7CgkgIH0KCgkgIHNvdXJjZS5vbignZW5kJywgY2xlYW51cCk7CgkgIHNvdXJjZS5vbignY2xvc2UnLCBjbGVhbnVwKTsKCgkgIGRlc3Qub24oJ2Nsb3NlJywgY2xlYW51cCk7CgoJICBkZXN0LmVtaXQoJ3BpcGUnLCBzb3VyY2UpOwoKCSAgLy8gQWxsb3cgZm9yIHVuaXgtbGlrZSB1c2FnZTogQS5waXBlKEIpLnBpcGUoQykKCSAgcmV0dXJuIGRlc3Q7Cgl9OwoKCi8qKiovIH0sCi8qIDMyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCWlmICh0eXBlb2YgT2JqZWN0LmNyZWF0ZSA9PT0gJ2Z1bmN0aW9uJykgewoJICAvLyBpbXBsZW1lbnRhdGlvbiBmcm9tIHN0YW5kYXJkIG5vZGUuanMgJ3V0aWwnIG1vZHVsZQoJICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluaGVyaXRzKGN0b3IsIHN1cGVyQ3RvcikgewoJICAgIGN0b3Iuc3VwZXJfID0gc3VwZXJDdG9yCgkgICAgY3Rvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ3Rvci5wcm90b3R5cGUsIHsKCSAgICAgIGNvbnN0cnVjdG9yOiB7CgkgICAgICAgIHZhbHVlOiBjdG9yLAoJICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKCSAgICAgICAgd3JpdGFibGU6IHRydWUsCgkgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQoJICAgICAgfQoJICAgIH0pOwoJICB9OwoJfSBlbHNlIHsKCSAgLy8gb2xkIHNjaG9vbCBzaGltIGZvciBvbGQgYnJvd3NlcnMKCSAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpbmhlcml0cyhjdG9yLCBzdXBlckN0b3IpIHsKCSAgICBjdG9yLnN1cGVyXyA9IHN1cGVyQ3RvcgoJICAgIHZhciBUZW1wQ3RvciA9IGZ1bmN0aW9uICgpIHt9CgkgICAgVGVtcEN0b3IucHJvdG90eXBlID0gc3VwZXJDdG9yLnByb3RvdHlwZQoJICAgIGN0b3IucHJvdG90eXBlID0gbmV3IFRlbXBDdG9yKCkKCSAgICBjdG9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGN0b3IKCSAgfQoJfQoKCi8qKiovIH0sCi8qIDMzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihwcm9jZXNzKSB7dmFyIFN0cmVhbSA9IChmdW5jdGlvbiAoKXsKCSAgdHJ5IHsKCSAgICByZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygzMSk7IC8vIGhhY2sgdG8gZml4IGEgY2lyY3VsYXIgZGVwZW5kZW5jeSBpc3N1ZSB3aGVuIHVzZWQgd2l0aCBicm93c2VyaWZ5CgkgIH0gY2F0Y2goXyl7fQoJfSgpKTsKCWV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpOwoJZXhwb3J0cy5TdHJlYW0gPSBTdHJlYW0gfHwgZXhwb3J0czsKCWV4cG9ydHMuUmVhZGFibGUgPSBleHBvcnRzOwoJZXhwb3J0cy5Xcml0YWJsZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpOwoJZXhwb3J0cy5EdXBsZXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCWV4cG9ydHMuVHJhbnNmb3JtID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nik7CglleHBvcnRzLlBhc3NUaHJvdWdoID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Nyk7CgoJaWYgKCFwcm9jZXNzLmJyb3dzZXIgJiYgcHJvY2Vzcy5lbnYuUkVBREFCTEVfU1RSRUFNID09PSAnZGlzYWJsZScgJiYgU3RyZWFtKSB7CgkgIG1vZHVsZS5leHBvcnRzID0gU3RyZWFtOwoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KSkpCgovKioqLyB9LAovKiAzNCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24ocHJvY2Vzcykgeyd1c2Ugc3RyaWN0JzsKCgltb2R1bGUuZXhwb3J0cyA9IFJlYWRhYmxlOwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgcHJvY2Vzc05leHRUaWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIGlzQXJyYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBEdXBsZXg7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCglSZWFkYWJsZS5SZWFkYWJsZVN0YXRlID0gUmVhZGFibGVTdGF0ZTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIEVFID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKS5FdmVudEVtaXR0ZXI7CgoJdmFyIEVFbGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uIChlbWl0dGVyLCB0eXBlKSB7CgkgIHJldHVybiBlbWl0dGVyLmxpc3RlbmVycyh0eXBlKS5sZW5ndGg7Cgl9OwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBTdHJlYW07CgkoZnVuY3Rpb24gKCkgewoJICB0cnkgewoJICAgIFN0cmVhbSA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoJICB9IGNhdGNoIChfKSB7fSBmaW5hbGx5IHsKCSAgICBpZiAoIVN0cmVhbSkgU3RyZWFtID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKS5FdmVudEVtaXR0ZXI7CgkgIH0KCX0pKCk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl2YXIgQnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5CdWZmZXI7CgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIGJ1ZmZlclNoaW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM2KTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgdXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oMzcpOwoJdXRpbC5pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBkZWJ1Z1V0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KTsKCXZhciBkZWJ1ZyA9IHZvaWQgMDsKCWlmIChkZWJ1Z1V0aWwgJiYgZGVidWdVdGlsLmRlYnVnbG9nKSB7CgkgIGRlYnVnID0gZGVidWdVdGlsLmRlYnVnbG9nKCdzdHJlYW0nKTsKCX0gZWxzZSB7CgkgIGRlYnVnID0gZnVuY3Rpb24gKCkge307Cgl9CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl2YXIgQnVmZmVyTGlzdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzkpOwoJdmFyIFN0cmluZ0RlY29kZXI7CgoJdXRpbC5pbmhlcml0cyhSZWFkYWJsZSwgU3RyZWFtKTsKCglmdW5jdGlvbiBwcmVwZW5kTGlzdGVuZXIoZW1pdHRlciwgZXZlbnQsIGZuKSB7CgkgIC8vIFNhZGx5IHRoaXMgaXMgbm90IGNhY2hlYWJsZSBhcyBzb21lIGxpYnJhcmllcyBidW5kbGUgdGhlaXIgb3duCgkgIC8vIGV2ZW50IGVtaXR0ZXIgaW1wbGVtZW50YXRpb24gd2l0aCB0aGVtLgoJICBpZiAodHlwZW9mIGVtaXR0ZXIucHJlcGVuZExpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7CgkgICAgcmV0dXJuIGVtaXR0ZXIucHJlcGVuZExpc3RlbmVyKGV2ZW50LCBmbik7CgkgIH0gZWxzZSB7CgkgICAgLy8gVGhpcyBpcyBhIGhhY2sgdG8gbWFrZSBzdXJlIHRoYXQgb3VyIGVycm9yIGhhbmRsZXIgaXMgYXR0YWNoZWQgYmVmb3JlIGFueQoJICAgIC8vIHVzZXJsYW5kIG9uZXMuICBORVZFUiBETyBUSElTLiBUaGlzIGlzIGhlcmUgb25seSBiZWNhdXNlIHRoaXMgY29kZSBuZWVkcwoJICAgIC8vIHRvIGNvbnRpbnVlIHRvIHdvcmsgd2l0aCBvbGRlciB2ZXJzaW9ucyBvZiBOb2RlLmpzIHRoYXQgZG8gbm90IGluY2x1ZGUKCSAgICAvLyB0aGUgcHJlcGVuZExpc3RlbmVyKCkgbWV0aG9kLiBUaGUgZ29hbCBpcyB0byBldmVudHVhbGx5IHJlbW92ZSB0aGlzIGhhY2suCgkgICAgaWYgKCFlbWl0dGVyLl9ldmVudHMgfHwgIWVtaXR0ZXIuX2V2ZW50c1tldmVudF0pIGVtaXR0ZXIub24oZXZlbnQsIGZuKTtlbHNlIGlmIChpc0FycmF5KGVtaXR0ZXIuX2V2ZW50c1tldmVudF0pKSBlbWl0dGVyLl9ldmVudHNbZXZlbnRdLnVuc2hpZnQoZm4pO2Vsc2UgZW1pdHRlci5fZXZlbnRzW2V2ZW50XSA9IFtmbiwgZW1pdHRlci5fZXZlbnRzW2V2ZW50XV07CgkgIH0KCX0KCglmdW5jdGlvbiBSZWFkYWJsZVN0YXRlKG9wdGlvbnMsIHN0cmVhbSkgewoJICBEdXBsZXggPSBEdXBsZXggfHwgX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7CgoJICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCgkgIC8vIG9iamVjdCBzdHJlYW0gZmxhZy4gVXNlZCB0byBtYWtlIHJlYWQobikgaWdub3JlIG4gYW5kIHRvCgkgIC8vIG1ha2UgYWxsIHRoZSBidWZmZXIgbWVyZ2luZyBhbmQgbGVuZ3RoIGNoZWNrcyBnbyBhd2F5CgkgIHRoaXMub2JqZWN0TW9kZSA9ICEhb3B0aW9ucy5vYmplY3RNb2RlOwoKCSAgaWYgKHN0cmVhbSBpbnN0YW5jZW9mIER1cGxleCkgdGhpcy5vYmplY3RNb2RlID0gdGhpcy5vYmplY3RNb2RlIHx8ICEhb3B0aW9ucy5yZWFkYWJsZU9iamVjdE1vZGU7CgoJICAvLyB0aGUgcG9pbnQgYXQgd2hpY2ggaXQgc3RvcHMgY2FsbGluZyBfcmVhZCgpIHRvIGZpbGwgdGhlIGJ1ZmZlcgoJICAvLyBOb3RlOiAwIGlzIGEgdmFsaWQgdmFsdWUsIG1lYW5zICJkb24ndCBjYWxsIF9yZWFkIHByZWVtcHRpdmVseSBldmVyIgoJICB2YXIgaHdtID0gb3B0aW9ucy5oaWdoV2F0ZXJNYXJrOwoJICB2YXIgZGVmYXVsdEh3bSA9IHRoaXMub2JqZWN0TW9kZSA/IDE2IDogMTYgKiAxMDI0OwoJICB0aGlzLmhpZ2hXYXRlck1hcmsgPSBod20gfHwgaHdtID09PSAwID8gaHdtIDogZGVmYXVsdEh3bTsKCgkgIC8vIGNhc3QgdG8gaW50cy4KCSAgdGhpcy5oaWdoV2F0ZXJNYXJrID0gfiB+dGhpcy5oaWdoV2F0ZXJNYXJrOwoKCSAgLy8gQSBsaW5rZWQgbGlzdCBpcyB1c2VkIHRvIHN0b3JlIGRhdGEgY2h1bmtzIGluc3RlYWQgb2YgYW4gYXJyYXkgYmVjYXVzZSB0aGUKCSAgLy8gbGlua2VkIGxpc3QgY2FuIHJlbW92ZSBlbGVtZW50cyBmcm9tIHRoZSBiZWdpbm5pbmcgZmFzdGVyIHRoYW4KCSAgLy8gYXJyYXkuc2hpZnQoKQoJICB0aGlzLmJ1ZmZlciA9IG5ldyBCdWZmZXJMaXN0KCk7CgkgIHRoaXMubGVuZ3RoID0gMDsKCSAgdGhpcy5waXBlcyA9IG51bGw7CgkgIHRoaXMucGlwZXNDb3VudCA9IDA7CgkgIHRoaXMuZmxvd2luZyA9IG51bGw7CgkgIHRoaXMuZW5kZWQgPSBmYWxzZTsKCSAgdGhpcy5lbmRFbWl0dGVkID0gZmFsc2U7CgkgIHRoaXMucmVhZGluZyA9IGZhbHNlOwoKCSAgLy8gYSBmbGFnIHRvIGJlIGFibGUgdG8gdGVsbCBpZiB0aGUgb253cml0ZSBjYiBpcyBjYWxsZWQgaW1tZWRpYXRlbHksCgkgIC8vIG9yIG9uIGEgbGF0ZXIgdGljay4gIFdlIHNldCB0aGlzIHRvIHRydWUgYXQgZmlyc3QsIGJlY2F1c2UgYW55CgkgIC8vIGFjdGlvbnMgdGhhdCBzaG91bGRuJ3QgaGFwcGVuIHVudGlsICJsYXRlciIgc2hvdWxkIGdlbmVyYWxseSBhbHNvCgkgIC8vIG5vdCBoYXBwZW4gYmVmb3JlIHRoZSBmaXJzdCB3cml0ZSBjYWxsLgoJICB0aGlzLnN5bmMgPSB0cnVlOwoKCSAgLy8gd2hlbmV2ZXIgd2UgcmV0dXJuIG51bGwsIHRoZW4gd2Ugc2V0IGEgZmxhZyB0byBzYXkKCSAgLy8gdGhhdCB3ZSdyZSBhd2FpdGluZyBhICdyZWFkYWJsZScgZXZlbnQgZW1pc3Npb24uCgkgIHRoaXMubmVlZFJlYWRhYmxlID0gZmFsc2U7CgkgIHRoaXMuZW1pdHRlZFJlYWRhYmxlID0gZmFsc2U7CgkgIHRoaXMucmVhZGFibGVMaXN0ZW5pbmcgPSBmYWxzZTsKCSAgdGhpcy5yZXN1bWVTY2hlZHVsZWQgPSBmYWxzZTsKCgkgIC8vIENyeXB0byBpcyBraW5kIG9mIG9sZCBhbmQgY3J1c3R5LiAgSGlzdG9yaWNhbGx5LCBpdHMgZGVmYXVsdCBzdHJpbmcKCSAgLy8gZW5jb2RpbmcgaXMgJ2JpbmFyeScgc28gd2UgaGF2ZSB0byBtYWtlIHRoaXMgY29uZmlndXJhYmxlLgoJICAvLyBFdmVyeXRoaW5nIGVsc2UgaW4gdGhlIHVuaXZlcnNlIHVzZXMgJ3V0ZjgnLCB0aG91Z2guCgkgIHRoaXMuZGVmYXVsdEVuY29kaW5nID0gb3B0aW9ucy5kZWZhdWx0RW5jb2RpbmcgfHwgJ3V0ZjgnOwoKCSAgLy8gd2hlbiBwaXBpbmcsIHdlIG9ubHkgY2FyZSBhYm91dCAncmVhZGFibGUnIGV2ZW50cyB0aGF0IGhhcHBlbgoJICAvLyBhZnRlciByZWFkKClpbmcgYWxsIHRoZSBieXRlcyBhbmQgbm90IGdldHRpbmcgYW55IHB1c2hiYWNrLgoJICB0aGlzLnJhbk91dCA9IGZhbHNlOwoKCSAgLy8gdGhlIG51bWJlciBvZiB3cml0ZXJzIHRoYXQgYXJlIGF3YWl0aW5nIGEgZHJhaW4gZXZlbnQgaW4gLnBpcGUoKXMKCSAgdGhpcy5hd2FpdERyYWluID0gMDsKCgkgIC8vIGlmIHRydWUsIGEgbWF5YmVSZWFkTW9yZSBoYXMgYmVlbiBzY2hlZHVsZWQKCSAgdGhpcy5yZWFkaW5nTW9yZSA9IGZhbHNlOwoKCSAgdGhpcy5kZWNvZGVyID0gbnVsbDsKCSAgdGhpcy5lbmNvZGluZyA9IG51bGw7CgkgIGlmIChvcHRpb25zLmVuY29kaW5nKSB7CgkgICAgaWYgKCFTdHJpbmdEZWNvZGVyKSBTdHJpbmdEZWNvZGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkuU3RyaW5nRGVjb2RlcjsKCSAgICB0aGlzLmRlY29kZXIgPSBuZXcgU3RyaW5nRGVjb2RlcihvcHRpb25zLmVuY29kaW5nKTsKCSAgICB0aGlzLmVuY29kaW5nID0gb3B0aW9ucy5lbmNvZGluZzsKCSAgfQoJfQoKCWZ1bmN0aW9uIFJlYWRhYmxlKG9wdGlvbnMpIHsKCSAgRHVwbGV4ID0gRHVwbGV4IHx8IF9fd2VicGFja19yZXF1aXJlX18oNDApOwoKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFJlYWRhYmxlKSkgcmV0dXJuIG5ldyBSZWFkYWJsZShvcHRpb25zKTsKCgkgIHRoaXMuX3JlYWRhYmxlU3RhdGUgPSBuZXcgUmVhZGFibGVTdGF0ZShvcHRpb25zLCB0aGlzKTsKCgkgIC8vIGxlZ2FjeQoJICB0aGlzLnJlYWRhYmxlID0gdHJ1ZTsKCgkgIGlmIChvcHRpb25zICYmIHR5cGVvZiBvcHRpb25zLnJlYWQgPT09ICdmdW5jdGlvbicpIHRoaXMuX3JlYWQgPSBvcHRpb25zLnJlYWQ7CgoJICBTdHJlYW0uY2FsbCh0aGlzKTsKCX0KCgkvLyBNYW51YWxseSBzaG92ZSBzb21ldGhpbmcgaW50byB0aGUgcmVhZCgpIGJ1ZmZlci4KCS8vIFRoaXMgcmV0dXJucyB0cnVlIGlmIHRoZSBoaWdoV2F0ZXJNYXJrIGhhcyBub3QgYmVlbiBoaXQgeWV0LAoJLy8gc2ltaWxhciB0byBob3cgV3JpdGFibGUud3JpdGUoKSByZXR1cm5zIHRydWUgaWYgeW91IHNob3VsZAoJLy8gd3JpdGUoKSBzb21lIG1vcmUuCglSZWFkYWJsZS5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcpIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsKCgkgIGlmICghc3RhdGUub2JqZWN0TW9kZSAmJiB0eXBlb2YgY2h1bmsgPT09ICdzdHJpbmcnKSB7CgkgICAgZW5jb2RpbmcgPSBlbmNvZGluZyB8fCBzdGF0ZS5kZWZhdWx0RW5jb2Rpbmc7CgkgICAgaWYgKGVuY29kaW5nICE9PSBzdGF0ZS5lbmNvZGluZykgewoJICAgICAgY2h1bmsgPSBidWZmZXJTaGltLmZyb20oY2h1bmssIGVuY29kaW5nKTsKCSAgICAgIGVuY29kaW5nID0gJyc7CgkgICAgfQoJICB9CgoJICByZXR1cm4gcmVhZGFibGVBZGRDaHVuayh0aGlzLCBzdGF0ZSwgY2h1bmssIGVuY29kaW5nLCBmYWxzZSk7Cgl9OwoKCS8vIFVuc2hpZnQgc2hvdWxkICphbHdheXMqIGJlIHNvbWV0aGluZyBkaXJlY3RseSBvdXQgb2YgcmVhZCgpCglSZWFkYWJsZS5wcm90b3R5cGUudW5zaGlmdCA9IGZ1bmN0aW9uIChjaHVuaykgewoJICB2YXIgc3RhdGUgPSB0aGlzLl9yZWFkYWJsZVN0YXRlOwoJICByZXR1cm4gcmVhZGFibGVBZGRDaHVuayh0aGlzLCBzdGF0ZSwgY2h1bmssICcnLCB0cnVlKTsKCX07CgoJUmVhZGFibGUucHJvdG90eXBlLmlzUGF1c2VkID0gZnVuY3Rpb24gKCkgewoJICByZXR1cm4gdGhpcy5fcmVhZGFibGVTdGF0ZS5mbG93aW5nID09PSBmYWxzZTsKCX07CgoJZnVuY3Rpb24gcmVhZGFibGVBZGRDaHVuayhzdHJlYW0sIHN0YXRlLCBjaHVuaywgZW5jb2RpbmcsIGFkZFRvRnJvbnQpIHsKCSAgdmFyIGVyID0gY2h1bmtJbnZhbGlkKHN0YXRlLCBjaHVuayk7CgkgIGlmIChlcikgewoJICAgIHN0cmVhbS5lbWl0KCdlcnJvcicsIGVyKTsKCSAgfSBlbHNlIGlmIChjaHVuayA9PT0gbnVsbCkgewoJICAgIHN0YXRlLnJlYWRpbmcgPSBmYWxzZTsKCSAgICBvbkVvZkNodW5rKHN0cmVhbSwgc3RhdGUpOwoJICB9IGVsc2UgaWYgKHN0YXRlLm9iamVjdE1vZGUgfHwgY2h1bmsgJiYgY2h1bmsubGVuZ3RoID4gMCkgewoJICAgIGlmIChzdGF0ZS5lbmRlZCAmJiAhYWRkVG9Gcm9udCkgewoJICAgICAgdmFyIGUgPSBuZXcgRXJyb3IoJ3N0cmVhbS5wdXNoKCkgYWZ0ZXIgRU9GJyk7CgkgICAgICBzdHJlYW0uZW1pdCgnZXJyb3InLCBlKTsKCSAgICB9IGVsc2UgaWYgKHN0YXRlLmVuZEVtaXR0ZWQgJiYgYWRkVG9Gcm9udCkgewoJICAgICAgdmFyIF9lID0gbmV3IEVycm9yKCdzdHJlYW0udW5zaGlmdCgpIGFmdGVyIGVuZCBldmVudCcpOwoJICAgICAgc3RyZWFtLmVtaXQoJ2Vycm9yJywgX2UpOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgc2tpcEFkZDsKCSAgICAgIGlmIChzdGF0ZS5kZWNvZGVyICYmICFhZGRUb0Zyb250ICYmICFlbmNvZGluZykgewoJICAgICAgICBjaHVuayA9IHN0YXRlLmRlY29kZXIud3JpdGUoY2h1bmspOwoJICAgICAgICBza2lwQWRkID0gIXN0YXRlLm9iamVjdE1vZGUgJiYgY2h1bmsubGVuZ3RoID09PSAwOwoJICAgICAgfQoKCSAgICAgIGlmICghYWRkVG9Gcm9udCkgc3RhdGUucmVhZGluZyA9IGZhbHNlOwoKCSAgICAgIC8vIERvbid0IGFkZCB0byB0aGUgYnVmZmVyIGlmIHdlJ3ZlIGRlY29kZWQgdG8gYW4gZW1wdHkgc3RyaW5nIGNodW5rIGFuZAoJICAgICAgLy8gd2UncmUgbm90IGluIG9iamVjdCBtb2RlCgkgICAgICBpZiAoIXNraXBBZGQpIHsKCSAgICAgICAgLy8gaWYgd2Ugd2FudCB0aGUgZGF0YSBub3csIGp1c3QgZW1pdCBpdC4KCSAgICAgICAgaWYgKHN0YXRlLmZsb3dpbmcgJiYgc3RhdGUubGVuZ3RoID09PSAwICYmICFzdGF0ZS5zeW5jKSB7CgkgICAgICAgICAgc3RyZWFtLmVtaXQoJ2RhdGEnLCBjaHVuayk7CgkgICAgICAgICAgc3RyZWFtLnJlYWQoMCk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgLy8gdXBkYXRlIHRoZSBidWZmZXIgaW5mby4KCSAgICAgICAgICBzdGF0ZS5sZW5ndGggKz0gc3RhdGUub2JqZWN0TW9kZSA/IDEgOiBjaHVuay5sZW5ndGg7CgkgICAgICAgICAgaWYgKGFkZFRvRnJvbnQpIHN0YXRlLmJ1ZmZlci51bnNoaWZ0KGNodW5rKTtlbHNlIHN0YXRlLmJ1ZmZlci5wdXNoKGNodW5rKTsKCgkgICAgICAgICAgaWYgKHN0YXRlLm5lZWRSZWFkYWJsZSkgZW1pdFJlYWRhYmxlKHN0cmVhbSk7CgkgICAgICAgIH0KCSAgICAgIH0KCgkgICAgICBtYXliZVJlYWRNb3JlKHN0cmVhbSwgc3RhdGUpOwoJICAgIH0KCSAgfSBlbHNlIGlmICghYWRkVG9Gcm9udCkgewoJICAgIHN0YXRlLnJlYWRpbmcgPSBmYWxzZTsKCSAgfQoKCSAgcmV0dXJuIG5lZWRNb3JlRGF0YShzdGF0ZSk7Cgl9CgoJLy8gaWYgaXQncyBwYXN0IHRoZSBoaWdoIHdhdGVyIG1hcmssIHdlIGNhbiBwdXNoIGluIHNvbWUgbW9yZS4KCS8vIEFsc28sIGlmIHdlIGhhdmUgbm8gZGF0YSB5ZXQsIHdlIGNhbiBzdGFuZCBzb21lCgkvLyBtb3JlIGJ5dGVzLiAgVGhpcyBpcyB0byB3b3JrIGFyb3VuZCBjYXNlcyB3aGVyZSBod209MCwKCS8vIHN1Y2ggYXMgdGhlIHJlcGwuICBBbHNvLCBpZiB0aGUgcHVzaCgpIHRyaWdnZXJlZCBhCgkvLyByZWFkYWJsZSBldmVudCwgYW5kIHRoZSB1c2VyIGNhbGxlZCByZWFkKGxhcmdlTnVtYmVyKSBzdWNoIHRoYXQKCS8vIG5lZWRSZWFkYWJsZSB3YXMgc2V0LCB0aGVuIHdlIG91Z2h0IHRvIHB1c2ggbW9yZSwgc28gdGhhdCBhbm90aGVyCgkvLyAncmVhZGFibGUnIGV2ZW50IHdpbGwgYmUgdHJpZ2dlcmVkLgoJZnVuY3Rpb24gbmVlZE1vcmVEYXRhKHN0YXRlKSB7CgkgIHJldHVybiAhc3RhdGUuZW5kZWQgJiYgKHN0YXRlLm5lZWRSZWFkYWJsZSB8fCBzdGF0ZS5sZW5ndGggPCBzdGF0ZS5oaWdoV2F0ZXJNYXJrIHx8IHN0YXRlLmxlbmd0aCA9PT0gMCk7Cgl9CgoJLy8gYmFja3dhcmRzIGNvbXBhdGliaWxpdHkuCglSZWFkYWJsZS5wcm90b3R5cGUuc2V0RW5jb2RpbmcgPSBmdW5jdGlvbiAoZW5jKSB7CgkgIGlmICghU3RyaW5nRGVjb2RlcikgU3RyaW5nRGVjb2RlciA9IF9fd2VicGFja19yZXF1aXJlX18oNDUpLlN0cmluZ0RlY29kZXI7CgkgIHRoaXMuX3JlYWRhYmxlU3RhdGUuZGVjb2RlciA9IG5ldyBTdHJpbmdEZWNvZGVyKGVuYyk7CgkgIHRoaXMuX3JlYWRhYmxlU3RhdGUuZW5jb2RpbmcgPSBlbmM7CgkgIHJldHVybiB0aGlzOwoJfTsKCgkvLyBEb24ndCByYWlzZSB0aGUgaHdtID4gOE1CCgl2YXIgTUFYX0hXTSA9IDB4ODAwMDAwOwoJZnVuY3Rpb24gY29tcHV0ZU5ld0hpZ2hXYXRlck1hcmsobikgewoJICBpZiAobiA+PSBNQVhfSFdNKSB7CgkgICAgbiA9IE1BWF9IV007CgkgIH0gZWxzZSB7CgkgICAgLy8gR2V0IHRoZSBuZXh0IGhpZ2hlc3QgcG93ZXIgb2YgMiB0byBwcmV2ZW50IGluY3JlYXNpbmcgaHdtIGV4Y2Vzc2l2ZWx5IGluCgkgICAgLy8gdGlueSBhbW91bnRzCgkgICAgbi0tOwoJICAgIG4gfD0gbiA+Pj4gMTsKCSAgICBuIHw9IG4gPj4+IDI7CgkgICAgbiB8PSBuID4+PiA0OwoJICAgIG4gfD0gbiA+Pj4gODsKCSAgICBuIHw9IG4gPj4+IDE2OwoJICAgIG4rKzsKCSAgfQoJICByZXR1cm4gbjsKCX0KCgkvLyBUaGlzIGZ1bmN0aW9uIGlzIGRlc2lnbmVkIHRvIGJlIGlubGluYWJsZSwgc28gcGxlYXNlIHRha2UgY2FyZSB3aGVuIG1ha2luZwoJLy8gY2hhbmdlcyB0byB0aGUgZnVuY3Rpb24gYm9keS4KCWZ1bmN0aW9uIGhvd011Y2hUb1JlYWQobiwgc3RhdGUpIHsKCSAgaWYgKG4gPD0gMCB8fCBzdGF0ZS5sZW5ndGggPT09IDAgJiYgc3RhdGUuZW5kZWQpIHJldHVybiAwOwoJICBpZiAoc3RhdGUub2JqZWN0TW9kZSkgcmV0dXJuIDE7CgkgIGlmIChuICE9PSBuKSB7CgkgICAgLy8gT25seSBmbG93IG9uZSBidWZmZXIgYXQgYSB0aW1lCgkgICAgaWYgKHN0YXRlLmZsb3dpbmcgJiYgc3RhdGUubGVuZ3RoKSByZXR1cm4gc3RhdGUuYnVmZmVyLmhlYWQuZGF0YS5sZW5ndGg7ZWxzZSByZXR1cm4gc3RhdGUubGVuZ3RoOwoJICB9CgkgIC8vIElmIHdlJ3JlIGFza2luZyBmb3IgbW9yZSB0aGFuIHRoZSBjdXJyZW50IGh3bSwgdGhlbiByYWlzZSB0aGUgaHdtLgoJICBpZiAobiA+IHN0YXRlLmhpZ2hXYXRlck1hcmspIHN0YXRlLmhpZ2hXYXRlck1hcmsgPSBjb21wdXRlTmV3SGlnaFdhdGVyTWFyayhuKTsKCSAgaWYgKG4gPD0gc3RhdGUubGVuZ3RoKSByZXR1cm4gbjsKCSAgLy8gRG9uJ3QgaGF2ZSBlbm91Z2gKCSAgaWYgKCFzdGF0ZS5lbmRlZCkgewoJICAgIHN0YXRlLm5lZWRSZWFkYWJsZSA9IHRydWU7CgkgICAgcmV0dXJuIDA7CgkgIH0KCSAgcmV0dXJuIHN0YXRlLmxlbmd0aDsKCX0KCgkvLyB5b3UgY2FuIG92ZXJyaWRlIGVpdGhlciB0aGlzIG1ldGhvZCwgb3IgdGhlIGFzeW5jIF9yZWFkKG4pIGJlbG93LgoJUmVhZGFibGUucHJvdG90eXBlLnJlYWQgPSBmdW5jdGlvbiAobikgewoJICBkZWJ1ZygncmVhZCcsIG4pOwoJICBuID0gcGFyc2VJbnQobiwgMTApOwoJICB2YXIgc3RhdGUgPSB0aGlzLl9yZWFkYWJsZVN0YXRlOwoJICB2YXIgbk9yaWcgPSBuOwoKCSAgaWYgKG4gIT09IDApIHN0YXRlLmVtaXR0ZWRSZWFkYWJsZSA9IGZhbHNlOwoKCSAgLy8gaWYgd2UncmUgZG9pbmcgcmVhZCgwKSB0byB0cmlnZ2VyIGEgcmVhZGFibGUgZXZlbnQsIGJ1dCB3ZQoJICAvLyBhbHJlYWR5IGhhdmUgYSBidW5jaCBvZiBkYXRhIGluIHRoZSBidWZmZXIsIHRoZW4ganVzdCB0cmlnZ2VyCgkgIC8vIHRoZSAncmVhZGFibGUnIGV2ZW50IGFuZCBtb3ZlIG9uLgoJICBpZiAobiA9PT0gMCAmJiBzdGF0ZS5uZWVkUmVhZGFibGUgJiYgKHN0YXRlLmxlbmd0aCA+PSBzdGF0ZS5oaWdoV2F0ZXJNYXJrIHx8IHN0YXRlLmVuZGVkKSkgewoJICAgIGRlYnVnKCdyZWFkOiBlbWl0UmVhZGFibGUnLCBzdGF0ZS5sZW5ndGgsIHN0YXRlLmVuZGVkKTsKCSAgICBpZiAoc3RhdGUubGVuZ3RoID09PSAwICYmIHN0YXRlLmVuZGVkKSBlbmRSZWFkYWJsZSh0aGlzKTtlbHNlIGVtaXRSZWFkYWJsZSh0aGlzKTsKCSAgICByZXR1cm4gbnVsbDsKCSAgfQoKCSAgbiA9IGhvd011Y2hUb1JlYWQobiwgc3RhdGUpOwoKCSAgLy8gaWYgd2UndmUgZW5kZWQsIGFuZCB3ZSdyZSBub3cgY2xlYXIsIHRoZW4gZmluaXNoIGl0IHVwLgoJICBpZiAobiA9PT0gMCAmJiBzdGF0ZS5lbmRlZCkgewoJICAgIGlmIChzdGF0ZS5sZW5ndGggPT09IDApIGVuZFJlYWRhYmxlKHRoaXMpOwoJICAgIHJldHVybiBudWxsOwoJICB9CgoJICAvLyBBbGwgdGhlIGFjdHVhbCBjaHVuayBnZW5lcmF0aW9uIGxvZ2ljIG5lZWRzIHRvIGJlCgkgIC8vICpiZWxvdyogdGhlIGNhbGwgdG8gX3JlYWQuICBUaGUgcmVhc29uIGlzIHRoYXQgaW4gY2VydGFpbgoJICAvLyBzeW50aGV0aWMgc3RyZWFtIGNhc2VzLCBzdWNoIGFzIHBhc3N0aHJvdWdoIHN0cmVhbXMsIF9yZWFkCgkgIC8vIG1heSBiZSBhIGNvbXBsZXRlbHkgc3luY2hyb25vdXMgb3BlcmF0aW9uIHdoaWNoIG1heSBjaGFuZ2UKCSAgLy8gdGhlIHN0YXRlIG9mIHRoZSByZWFkIGJ1ZmZlciwgcHJvdmlkaW5nIGVub3VnaCBkYXRhIHdoZW4KCSAgLy8gYmVmb3JlIHRoZXJlIHdhcyAqbm90KiBlbm91Z2guCgkgIC8vCgkgIC8vIFNvLCB0aGUgc3RlcHMgYXJlOgoJICAvLyAxLiBGaWd1cmUgb3V0IHdoYXQgdGhlIHN0YXRlIG9mIHRoaW5ncyB3aWxsIGJlIGFmdGVyIHdlIGRvCgkgIC8vIGEgcmVhZCBmcm9tIHRoZSBidWZmZXIuCgkgIC8vCgkgIC8vIDIuIElmIHRoYXQgcmVzdWx0aW5nIHN0YXRlIHdpbGwgdHJpZ2dlciBhIF9yZWFkLCB0aGVuIGNhbGwgX3JlYWQuCgkgIC8vIE5vdGUgdGhhdCB0aGlzIG1heSBiZSBhc3luY2hyb25vdXMsIG9yIHN5bmNocm9ub3VzLiAgWWVzLCBpdCBpcwoJICAvLyBkZWVwbHkgdWdseSB0byB3cml0ZSBBUElzIHRoaXMgd2F5LCBidXQgdGhhdCBzdGlsbCBkb2Vzbid0IG1lYW4KCSAgLy8gdGhhdCB0aGUgUmVhZGFibGUgY2xhc3Mgc2hvdWxkIGJlaGF2ZSBpbXByb3Blcmx5LCBhcyBzdHJlYW1zIGFyZQoJICAvLyBkZXNpZ25lZCB0byBiZSBzeW5jL2FzeW5jIGFnbm9zdGljLgoJICAvLyBUYWtlIG5vdGUgaWYgdGhlIF9yZWFkIGNhbGwgaXMgc3luYyBvciBhc3luYyAoaWUsIGlmIHRoZSByZWFkIGNhbGwKCSAgLy8gaGFzIHJldHVybmVkIHlldCksIHNvIHRoYXQgd2Uga25vdyB3aGV0aGVyIG9yIG5vdCBpdCdzIHNhZmUgdG8gZW1pdAoJICAvLyAncmVhZGFibGUnIGV0Yy4KCSAgLy8KCSAgLy8gMy4gQWN0dWFsbHkgcHVsbCB0aGUgcmVxdWVzdGVkIGNodW5rcyBvdXQgb2YgdGhlIGJ1ZmZlciBhbmQgcmV0dXJuLgoKCSAgLy8gaWYgd2UgbmVlZCBhIHJlYWRhYmxlIGV2ZW50LCB0aGVuIHdlIG5lZWQgdG8gZG8gc29tZSByZWFkaW5nLgoJICB2YXIgZG9SZWFkID0gc3RhdGUubmVlZFJlYWRhYmxlOwoJICBkZWJ1ZygnbmVlZCByZWFkYWJsZScsIGRvUmVhZCk7CgoJICAvLyBpZiB3ZSBjdXJyZW50bHkgaGF2ZSBsZXNzIHRoYW4gdGhlIGhpZ2hXYXRlck1hcmssIHRoZW4gYWxzbyByZWFkIHNvbWUKCSAgaWYgKHN0YXRlLmxlbmd0aCA9PT0gMCB8fCBzdGF0ZS5sZW5ndGggLSBuIDwgc3RhdGUuaGlnaFdhdGVyTWFyaykgewoJICAgIGRvUmVhZCA9IHRydWU7CgkgICAgZGVidWcoJ2xlbmd0aCBsZXNzIHRoYW4gd2F0ZXJtYXJrJywgZG9SZWFkKTsKCSAgfQoKCSAgLy8gaG93ZXZlciwgaWYgd2UndmUgZW5kZWQsIHRoZW4gdGhlcmUncyBubyBwb2ludCwgYW5kIGlmIHdlJ3JlIGFscmVhZHkKCSAgLy8gcmVhZGluZywgdGhlbiBpdCdzIHVubmVjZXNzYXJ5LgoJICBpZiAoc3RhdGUuZW5kZWQgfHwgc3RhdGUucmVhZGluZykgewoJICAgIGRvUmVhZCA9IGZhbHNlOwoJICAgIGRlYnVnKCdyZWFkaW5nIG9yIGVuZGVkJywgZG9SZWFkKTsKCSAgfSBlbHNlIGlmIChkb1JlYWQpIHsKCSAgICBkZWJ1ZygnZG8gcmVhZCcpOwoJICAgIHN0YXRlLnJlYWRpbmcgPSB0cnVlOwoJICAgIHN0YXRlLnN5bmMgPSB0cnVlOwoJICAgIC8vIGlmIHRoZSBsZW5ndGggaXMgY3VycmVudGx5IHplcm8sIHRoZW4gd2UgKm5lZWQqIGEgcmVhZGFibGUgZXZlbnQuCgkgICAgaWYgKHN0YXRlLmxlbmd0aCA9PT0gMCkgc3RhdGUubmVlZFJlYWRhYmxlID0gdHJ1ZTsKCSAgICAvLyBjYWxsIGludGVybmFsIHJlYWQgbWV0aG9kCgkgICAgdGhpcy5fcmVhZChzdGF0ZS5oaWdoV2F0ZXJNYXJrKTsKCSAgICBzdGF0ZS5zeW5jID0gZmFsc2U7CgkgICAgLy8gSWYgX3JlYWQgcHVzaGVkIGRhdGEgc3luY2hyb25vdXNseSwgdGhlbiBgcmVhZGluZ2Agd2lsbCBiZSBmYWxzZSwKCSAgICAvLyBhbmQgd2UgbmVlZCB0byByZS1ldmFsdWF0ZSBob3cgbXVjaCBkYXRhIHdlIGNhbiByZXR1cm4gdG8gdGhlIHVzZXIuCgkgICAgaWYgKCFzdGF0ZS5yZWFkaW5nKSBuID0gaG93TXVjaFRvUmVhZChuT3JpZywgc3RhdGUpOwoJICB9CgoJICB2YXIgcmV0OwoJICBpZiAobiA+IDApIHJldCA9IGZyb21MaXN0KG4sIHN0YXRlKTtlbHNlIHJldCA9IG51bGw7CgoJICBpZiAocmV0ID09PSBudWxsKSB7CgkgICAgc3RhdGUubmVlZFJlYWRhYmxlID0gdHJ1ZTsKCSAgICBuID0gMDsKCSAgfSBlbHNlIHsKCSAgICBzdGF0ZS5sZW5ndGggLT0gbjsKCSAgfQoKCSAgaWYgKHN0YXRlLmxlbmd0aCA9PT0gMCkgewoJICAgIC8vIElmIHdlIGhhdmUgbm90aGluZyBpbiB0aGUgYnVmZmVyLCB0aGVuIHdlIHdhbnQgdG8ga25vdwoJICAgIC8vIGFzIHNvb24gYXMgd2UgKmRvKiBnZXQgc29tZXRoaW5nIGludG8gdGhlIGJ1ZmZlci4KCSAgICBpZiAoIXN0YXRlLmVuZGVkKSBzdGF0ZS5uZWVkUmVhZGFibGUgPSB0cnVlOwoKCSAgICAvLyBJZiB3ZSB0cmllZCB0byByZWFkKCkgcGFzdCB0aGUgRU9GLCB0aGVuIGVtaXQgZW5kIG9uIHRoZSBuZXh0IHRpY2suCgkgICAgaWYgKG5PcmlnICE9PSBuICYmIHN0YXRlLmVuZGVkKSBlbmRSZWFkYWJsZSh0aGlzKTsKCSAgfQoKCSAgaWYgKHJldCAhPT0gbnVsbCkgdGhpcy5lbWl0KCdkYXRhJywgcmV0KTsKCgkgIHJldHVybiByZXQ7Cgl9OwoKCWZ1bmN0aW9uIGNodW5rSW52YWxpZChzdGF0ZSwgY2h1bmspIHsKCSAgdmFyIGVyID0gbnVsbDsKCSAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoY2h1bmspICYmIHR5cGVvZiBjaHVuayAhPT0gJ3N0cmluZycgJiYgY2h1bmsgIT09IG51bGwgJiYgY2h1bmsgIT09IHVuZGVmaW5lZCAmJiAhc3RhdGUub2JqZWN0TW9kZSkgewoJICAgIGVyID0gbmV3IFR5cGVFcnJvcignSW52YWxpZCBub24tc3RyaW5nL2J1ZmZlciBjaHVuaycpOwoJICB9CgkgIHJldHVybiBlcjsKCX0KCglmdW5jdGlvbiBvbkVvZkNodW5rKHN0cmVhbSwgc3RhdGUpIHsKCSAgaWYgKHN0YXRlLmVuZGVkKSByZXR1cm47CgkgIGlmIChzdGF0ZS5kZWNvZGVyKSB7CgkgICAgdmFyIGNodW5rID0gc3RhdGUuZGVjb2Rlci5lbmQoKTsKCSAgICBpZiAoY2h1bmsgJiYgY2h1bmsubGVuZ3RoKSB7CgkgICAgICBzdGF0ZS5idWZmZXIucHVzaChjaHVuayk7CgkgICAgICBzdGF0ZS5sZW5ndGggKz0gc3RhdGUub2JqZWN0TW9kZSA/IDEgOiBjaHVuay5sZW5ndGg7CgkgICAgfQoJICB9CgkgIHN0YXRlLmVuZGVkID0gdHJ1ZTsKCgkgIC8vIGVtaXQgJ3JlYWRhYmxlJyBub3cgdG8gbWFrZSBzdXJlIGl0IGdldHMgcGlja2VkIHVwLgoJICBlbWl0UmVhZGFibGUoc3RyZWFtKTsKCX0KCgkvLyBEb24ndCBlbWl0IHJlYWRhYmxlIHJpZ2h0IGF3YXkgaW4gc3luYyBtb2RlLCBiZWNhdXNlIHRoaXMgY2FuIHRyaWdnZXIKCS8vIGFub3RoZXIgcmVhZCgpIGNhbGwgPT4gc3RhY2sgb3ZlcmZsb3cuICBUaGlzIHdheSwgaXQgbWlnaHQgdHJpZ2dlcgoJLy8gYSBuZXh0VGljayByZWN1cnNpb24gd2FybmluZywgYnV0IHRoYXQncyBub3Qgc28gYmFkLgoJZnVuY3Rpb24gZW1pdFJlYWRhYmxlKHN0cmVhbSkgewoJICB2YXIgc3RhdGUgPSBzdHJlYW0uX3JlYWRhYmxlU3RhdGU7CgkgIHN0YXRlLm5lZWRSZWFkYWJsZSA9IGZhbHNlOwoJICBpZiAoIXN0YXRlLmVtaXR0ZWRSZWFkYWJsZSkgewoJICAgIGRlYnVnKCdlbWl0UmVhZGFibGUnLCBzdGF0ZS5mbG93aW5nKTsKCSAgICBzdGF0ZS5lbWl0dGVkUmVhZGFibGUgPSB0cnVlOwoJICAgIGlmIChzdGF0ZS5zeW5jKSBwcm9jZXNzTmV4dFRpY2soZW1pdFJlYWRhYmxlXywgc3RyZWFtKTtlbHNlIGVtaXRSZWFkYWJsZV8oc3RyZWFtKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIGVtaXRSZWFkYWJsZV8oc3RyZWFtKSB7CgkgIGRlYnVnKCdlbWl0IHJlYWRhYmxlJyk7CgkgIHN0cmVhbS5lbWl0KCdyZWFkYWJsZScpOwoJICBmbG93KHN0cmVhbSk7Cgl9CgoJLy8gYXQgdGhpcyBwb2ludCwgdGhlIHVzZXIgaGFzIHByZXN1bWFibHkgc2VlbiB0aGUgJ3JlYWRhYmxlJyBldmVudCwKCS8vIGFuZCBjYWxsZWQgcmVhZCgpIHRvIGNvbnN1bWUgc29tZSBkYXRhLiAgdGhhdCBtYXkgaGF2ZSB0cmlnZ2VyZWQKCS8vIGluIHR1cm4gYW5vdGhlciBfcmVhZChuKSBjYWxsLCBpbiB3aGljaCBjYXNlIHJlYWRpbmcgPSB0cnVlIGlmCgkvLyBpdCdzIGluIHByb2dyZXNzLgoJLy8gSG93ZXZlciwgaWYgd2UncmUgbm90IGVuZGVkLCBvciByZWFkaW5nLCBhbmQgdGhlIGxlbmd0aCA8IGh3bSwKCS8vIHRoZW4gZ28gYWhlYWQgYW5kIHRyeSB0byByZWFkIHNvbWUgbW9yZSBwcmVlbXB0aXZlbHkuCglmdW5jdGlvbiBtYXliZVJlYWRNb3JlKHN0cmVhbSwgc3RhdGUpIHsKCSAgaWYgKCFzdGF0ZS5yZWFkaW5nTW9yZSkgewoJICAgIHN0YXRlLnJlYWRpbmdNb3JlID0gdHJ1ZTsKCSAgICBwcm9jZXNzTmV4dFRpY2sobWF5YmVSZWFkTW9yZV8sIHN0cmVhbSwgc3RhdGUpOwoJICB9Cgl9CgoJZnVuY3Rpb24gbWF5YmVSZWFkTW9yZV8oc3RyZWFtLCBzdGF0ZSkgewoJICB2YXIgbGVuID0gc3RhdGUubGVuZ3RoOwoJICB3aGlsZSAoIXN0YXRlLnJlYWRpbmcgJiYgIXN0YXRlLmZsb3dpbmcgJiYgIXN0YXRlLmVuZGVkICYmIHN0YXRlLmxlbmd0aCA8IHN0YXRlLmhpZ2hXYXRlck1hcmspIHsKCSAgICBkZWJ1ZygnbWF5YmVSZWFkTW9yZSByZWFkIDAnKTsKCSAgICBzdHJlYW0ucmVhZCgwKTsKCSAgICBpZiAobGVuID09PSBzdGF0ZS5sZW5ndGgpCgkgICAgICAvLyBkaWRuJ3QgZ2V0IGFueSBkYXRhLCBzdG9wIHNwaW5uaW5nLgoJICAgICAgYnJlYWs7ZWxzZSBsZW4gPSBzdGF0ZS5sZW5ndGg7CgkgIH0KCSAgc3RhdGUucmVhZGluZ01vcmUgPSBmYWxzZTsKCX0KCgkvLyBhYnN0cmFjdCBtZXRob2QuICB0byBiZSBvdmVycmlkZGVuIGluIHNwZWNpZmljIGltcGxlbWVudGF0aW9uIGNsYXNzZXMuCgkvLyBjYWxsIGNiKGVyLCBkYXRhKSB3aGVyZSBkYXRhIGlzIDw9IG4gaW4gbGVuZ3RoLgoJLy8gZm9yIHZpcnR1YWwgKG5vbi1zdHJpbmcsIG5vbi1idWZmZXIpIHN0cmVhbXMsICJsZW5ndGgiIGlzIHNvbWV3aGF0CgkvLyBhcmJpdHJhcnksIGFuZCBwZXJoYXBzIG5vdCB2ZXJ5IG1lYW5pbmdmdWwuCglSZWFkYWJsZS5wcm90b3R5cGUuX3JlYWQgPSBmdW5jdGlvbiAobikgewoJICB0aGlzLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdfcmVhZCgpIGlzIG5vdCBpbXBsZW1lbnRlZCcpKTsKCX07CgoJUmVhZGFibGUucHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbiAoZGVzdCwgcGlwZU9wdHMpIHsKCSAgdmFyIHNyYyA9IHRoaXM7CgkgIHZhciBzdGF0ZSA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgoJICBzd2l0Y2ggKHN0YXRlLnBpcGVzQ291bnQpIHsKCSAgICBjYXNlIDA6CgkgICAgICBzdGF0ZS5waXBlcyA9IGRlc3Q7CgkgICAgICBicmVhazsKCSAgICBjYXNlIDE6CgkgICAgICBzdGF0ZS5waXBlcyA9IFtzdGF0ZS5waXBlcywgZGVzdF07CgkgICAgICBicmVhazsKCSAgICBkZWZhdWx0OgoJICAgICAgc3RhdGUucGlwZXMucHVzaChkZXN0KTsKCSAgICAgIGJyZWFrOwoJICB9CgkgIHN0YXRlLnBpcGVzQ291bnQgKz0gMTsKCSAgZGVidWcoJ3BpcGUgY291bnQ9JWQgb3B0cz0laicsIHN0YXRlLnBpcGVzQ291bnQsIHBpcGVPcHRzKTsKCgkgIHZhciBkb0VuZCA9ICghcGlwZU9wdHMgfHwgcGlwZU9wdHMuZW5kICE9PSBmYWxzZSkgJiYgZGVzdCAhPT0gcHJvY2Vzcy5zdGRvdXQgJiYgZGVzdCAhPT0gcHJvY2Vzcy5zdGRlcnI7CgoJICB2YXIgZW5kRm4gPSBkb0VuZCA/IG9uZW5kIDogY2xlYW51cDsKCSAgaWYgKHN0YXRlLmVuZEVtaXR0ZWQpIHByb2Nlc3NOZXh0VGljayhlbmRGbik7ZWxzZSBzcmMub25jZSgnZW5kJywgZW5kRm4pOwoKCSAgZGVzdC5vbigndW5waXBlJywgb251bnBpcGUpOwoJICBmdW5jdGlvbiBvbnVucGlwZShyZWFkYWJsZSkgewoJICAgIGRlYnVnKCdvbnVucGlwZScpOwoJICAgIGlmIChyZWFkYWJsZSA9PT0gc3JjKSB7CgkgICAgICBjbGVhbnVwKCk7CgkgICAgfQoJICB9CgoJICBmdW5jdGlvbiBvbmVuZCgpIHsKCSAgICBkZWJ1Zygnb25lbmQnKTsKCSAgICBkZXN0LmVuZCgpOwoJICB9CgoJICAvLyB3aGVuIHRoZSBkZXN0IGRyYWlucywgaXQgcmVkdWNlcyB0aGUgYXdhaXREcmFpbiBjb3VudGVyCgkgIC8vIG9uIHRoZSBzb3VyY2UuICBUaGlzIHdvdWxkIGJlIG1vcmUgZWxlZ2FudCB3aXRoIGEgLm9uY2UoKQoJICAvLyBoYW5kbGVyIGluIGZsb3coKSwgYnV0IGFkZGluZyBhbmQgcmVtb3ZpbmcgcmVwZWF0ZWRseSBpcwoJICAvLyB0b28gc2xvdy4KCSAgdmFyIG9uZHJhaW4gPSBwaXBlT25EcmFpbihzcmMpOwoJICBkZXN0Lm9uKCdkcmFpbicsIG9uZHJhaW4pOwoKCSAgdmFyIGNsZWFuZWRVcCA9IGZhbHNlOwoJICBmdW5jdGlvbiBjbGVhbnVwKCkgewoJICAgIGRlYnVnKCdjbGVhbnVwJyk7CgkgICAgLy8gY2xlYW51cCBldmVudCBoYW5kbGVycyBvbmNlIHRoZSBwaXBlIGlzIGJyb2tlbgoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2Nsb3NlJywgb25jbG9zZSk7CgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignZmluaXNoJywgb25maW5pc2gpOwoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2RyYWluJywgb25kcmFpbik7CgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBvbmVycm9yKTsKCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCd1bnBpcGUnLCBvbnVucGlwZSk7CgkgICAgc3JjLnJlbW92ZUxpc3RlbmVyKCdlbmQnLCBvbmVuZCk7CgkgICAgc3JjLnJlbW92ZUxpc3RlbmVyKCdlbmQnLCBjbGVhbnVwKTsKCSAgICBzcmMucmVtb3ZlTGlzdGVuZXIoJ2RhdGEnLCBvbmRhdGEpOwoKCSAgICBjbGVhbmVkVXAgPSB0cnVlOwoKCSAgICAvLyBpZiB0aGUgcmVhZGVyIGlzIHdhaXRpbmcgZm9yIGEgZHJhaW4gZXZlbnQgZnJvbSB0aGlzCgkgICAgLy8gc3BlY2lmaWMgd3JpdGVyLCB0aGVuIGl0IHdvdWxkIGNhdXNlIGl0IHRvIG5ldmVyIHN0YXJ0CgkgICAgLy8gZmxvd2luZyBhZ2Fpbi4KCSAgICAvLyBTbywgaWYgdGhpcyBpcyBhd2FpdGluZyBhIGRyYWluLCB0aGVuIHdlIGp1c3QgY2FsbCBpdCBub3cuCgkgICAgLy8gSWYgd2UgZG9uJ3Qga25vdywgdGhlbiBhc3N1bWUgdGhhdCB3ZSBhcmUgd2FpdGluZyBmb3Igb25lLgoJICAgIGlmIChzdGF0ZS5hd2FpdERyYWluICYmICghZGVzdC5fd3JpdGFibGVTdGF0ZSB8fCBkZXN0Ll93cml0YWJsZVN0YXRlLm5lZWREcmFpbikpIG9uZHJhaW4oKTsKCSAgfQoKCSAgLy8gSWYgdGhlIHVzZXIgcHVzaGVzIG1vcmUgZGF0YSB3aGlsZSB3ZSdyZSB3cml0aW5nIHRvIGRlc3QgdGhlbiB3ZSdsbCBlbmQgdXAKCSAgLy8gaW4gb25kYXRhIGFnYWluLiBIb3dldmVyLCB3ZSBvbmx5IHdhbnQgdG8gaW5jcmVhc2UgYXdhaXREcmFpbiBvbmNlIGJlY2F1c2UKCSAgLy8gZGVzdCB3aWxsIG9ubHkgZW1pdCBvbmUgJ2RyYWluJyBldmVudCBmb3IgdGhlIG11bHRpcGxlIHdyaXRlcy4KCSAgLy8gPT4gSW50cm9kdWNlIGEgZ3VhcmQgb24gaW5jcmVhc2luZyBhd2FpdERyYWluLgoJICB2YXIgaW5jcmVhc2VkQXdhaXREcmFpbiA9IGZhbHNlOwoJICBzcmMub24oJ2RhdGEnLCBvbmRhdGEpOwoJICBmdW5jdGlvbiBvbmRhdGEoY2h1bmspIHsKCSAgICBkZWJ1Zygnb25kYXRhJyk7CgkgICAgaW5jcmVhc2VkQXdhaXREcmFpbiA9IGZhbHNlOwoJICAgIHZhciByZXQgPSBkZXN0LndyaXRlKGNodW5rKTsKCSAgICBpZiAoZmFsc2UgPT09IHJldCAmJiAhaW5jcmVhc2VkQXdhaXREcmFpbikgewoJICAgICAgLy8gSWYgdGhlIHVzZXIgdW5waXBlZCBkdXJpbmcgYGRlc3Qud3JpdGUoKWAsIGl0IGlzIHBvc3NpYmxlCgkgICAgICAvLyB0byBnZXQgc3R1Y2sgaW4gYSBwZXJtYW5lbnRseSBwYXVzZWQgc3RhdGUgaWYgdGhhdCB3cml0ZQoJICAgICAgLy8gYWxzbyByZXR1cm5lZCBmYWxzZS4KCSAgICAgIC8vID0+IENoZWNrIHdoZXRoZXIgYGRlc3RgIGlzIHN0aWxsIGEgcGlwaW5nIGRlc3RpbmF0aW9uLgoJICAgICAgaWYgKChzdGF0ZS5waXBlc0NvdW50ID09PSAxICYmIHN0YXRlLnBpcGVzID09PSBkZXN0IHx8IHN0YXRlLnBpcGVzQ291bnQgPiAxICYmIGluZGV4T2Yoc3RhdGUucGlwZXMsIGRlc3QpICE9PSAtMSkgJiYgIWNsZWFuZWRVcCkgewoJICAgICAgICBkZWJ1ZygnZmFsc2Ugd3JpdGUgcmVzcG9uc2UsIHBhdXNlJywgc3JjLl9yZWFkYWJsZVN0YXRlLmF3YWl0RHJhaW4pOwoJICAgICAgICBzcmMuX3JlYWRhYmxlU3RhdGUuYXdhaXREcmFpbisrOwoJICAgICAgICBpbmNyZWFzZWRBd2FpdERyYWluID0gdHJ1ZTsKCSAgICAgIH0KCSAgICAgIHNyYy5wYXVzZSgpOwoJICAgIH0KCSAgfQoKCSAgLy8gaWYgdGhlIGRlc3QgaGFzIGFuIGVycm9yLCB0aGVuIHN0b3AgcGlwaW5nIGludG8gaXQuCgkgIC8vIGhvd2V2ZXIsIGRvbid0IHN1cHByZXNzIHRoZSB0aHJvd2luZyBiZWhhdmlvciBmb3IgdGhpcy4KCSAgZnVuY3Rpb24gb25lcnJvcihlcikgewoJICAgIGRlYnVnKCdvbmVycm9yJywgZXIpOwoJICAgIHVucGlwZSgpOwoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25lcnJvcik7CgkgICAgaWYgKEVFbGlzdGVuZXJDb3VudChkZXN0LCAnZXJyb3InKSA9PT0gMCkgZGVzdC5lbWl0KCdlcnJvcicsIGVyKTsKCSAgfQoKCSAgLy8gTWFrZSBzdXJlIG91ciBlcnJvciBoYW5kbGVyIGlzIGF0dGFjaGVkIGJlZm9yZSB1c2VybGFuZCBvbmVzLgoJICBwcmVwZW5kTGlzdGVuZXIoZGVzdCwgJ2Vycm9yJywgb25lcnJvcik7CgoJICAvLyBCb3RoIGNsb3NlIGFuZCBmaW5pc2ggc2hvdWxkIHRyaWdnZXIgdW5waXBlLCBidXQgb25seSBvbmNlLgoJICBmdW5jdGlvbiBvbmNsb3NlKCkgewoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2ZpbmlzaCcsIG9uZmluaXNoKTsKCSAgICB1bnBpcGUoKTsKCSAgfQoJICBkZXN0Lm9uY2UoJ2Nsb3NlJywgb25jbG9zZSk7CgkgIGZ1bmN0aW9uIG9uZmluaXNoKCkgewoJICAgIGRlYnVnKCdvbmZpbmlzaCcpOwoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2Nsb3NlJywgb25jbG9zZSk7CgkgICAgdW5waXBlKCk7CgkgIH0KCSAgZGVzdC5vbmNlKCdmaW5pc2gnLCBvbmZpbmlzaCk7CgoJICBmdW5jdGlvbiB1bnBpcGUoKSB7CgkgICAgZGVidWcoJ3VucGlwZScpOwoJICAgIHNyYy51bnBpcGUoZGVzdCk7CgkgIH0KCgkgIC8vIHRlbGwgdGhlIGRlc3QgdGhhdCBpdCdzIGJlaW5nIHBpcGVkIHRvCgkgIGRlc3QuZW1pdCgncGlwZScsIHNyYyk7CgoJICAvLyBzdGFydCB0aGUgZmxvdyBpZiBpdCBoYXNuJ3QgYmVlbiBzdGFydGVkIGFscmVhZHkuCgkgIGlmICghc3RhdGUuZmxvd2luZykgewoJICAgIGRlYnVnKCdwaXBlIHJlc3VtZScpOwoJICAgIHNyYy5yZXN1bWUoKTsKCSAgfQoKCSAgcmV0dXJuIGRlc3Q7Cgl9OwoKCWZ1bmN0aW9uIHBpcGVPbkRyYWluKHNyYykgewoJICByZXR1cm4gZnVuY3Rpb24gKCkgewoJICAgIHZhciBzdGF0ZSA9IHNyYy5fcmVhZGFibGVTdGF0ZTsKCSAgICBkZWJ1ZygncGlwZU9uRHJhaW4nLCBzdGF0ZS5hd2FpdERyYWluKTsKCSAgICBpZiAoc3RhdGUuYXdhaXREcmFpbikgc3RhdGUuYXdhaXREcmFpbi0tOwoJICAgIGlmIChzdGF0ZS5hd2FpdERyYWluID09PSAwICYmIEVFbGlzdGVuZXJDb3VudChzcmMsICdkYXRhJykpIHsKCSAgICAgIHN0YXRlLmZsb3dpbmcgPSB0cnVlOwoJICAgICAgZmxvdyhzcmMpOwoJICAgIH0KCSAgfTsKCX0KCglSZWFkYWJsZS5wcm90b3R5cGUudW5waXBlID0gZnVuY3Rpb24gKGRlc3QpIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsKCgkgIC8vIGlmIHdlJ3JlIG5vdCBwaXBpbmcgYW55d2hlcmUsIHRoZW4gZG8gbm90aGluZy4KCSAgaWYgKHN0YXRlLnBpcGVzQ291bnQgPT09IDApIHJldHVybiB0aGlzOwoKCSAgLy8ganVzdCBvbmUgZGVzdGluYXRpb24uICBtb3N0IGNvbW1vbiBjYXNlLgoJICBpZiAoc3RhdGUucGlwZXNDb3VudCA9PT0gMSkgewoJICAgIC8vIHBhc3NlZCBpbiBvbmUsIGJ1dCBpdCdzIG5vdCB0aGUgcmlnaHQgb25lLgoJICAgIGlmIChkZXN0ICYmIGRlc3QgIT09IHN0YXRlLnBpcGVzKSByZXR1cm4gdGhpczsKCgkgICAgaWYgKCFkZXN0KSBkZXN0ID0gc3RhdGUucGlwZXM7CgoJICAgIC8vIGdvdCBhIG1hdGNoLgoJICAgIHN0YXRlLnBpcGVzID0gbnVsbDsKCSAgICBzdGF0ZS5waXBlc0NvdW50ID0gMDsKCSAgICBzdGF0ZS5mbG93aW5nID0gZmFsc2U7CgkgICAgaWYgKGRlc3QpIGRlc3QuZW1pdCgndW5waXBlJywgdGhpcyk7CgkgICAgcmV0dXJuIHRoaXM7CgkgIH0KCgkgIC8vIHNsb3cgY2FzZS4gbXVsdGlwbGUgcGlwZSBkZXN0aW5hdGlvbnMuCgoJICBpZiAoIWRlc3QpIHsKCSAgICAvLyByZW1vdmUgYWxsLgoJICAgIHZhciBkZXN0cyA9IHN0YXRlLnBpcGVzOwoJICAgIHZhciBsZW4gPSBzdGF0ZS5waXBlc0NvdW50OwoJICAgIHN0YXRlLnBpcGVzID0gbnVsbDsKCSAgICBzdGF0ZS5waXBlc0NvdW50ID0gMDsKCSAgICBzdGF0ZS5mbG93aW5nID0gZmFsc2U7CgoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKCSAgICAgIGRlc3RzW2ldLmVtaXQoJ3VucGlwZScsIHRoaXMpOwoJICAgIH1yZXR1cm4gdGhpczsKCSAgfQoKCSAgLy8gdHJ5IHRvIGZpbmQgdGhlIHJpZ2h0IG9uZS4KCSAgdmFyIGluZGV4ID0gaW5kZXhPZihzdGF0ZS5waXBlcywgZGVzdCk7CgkgIGlmIChpbmRleCA9PT0gLTEpIHJldHVybiB0aGlzOwoKCSAgc3RhdGUucGlwZXMuc3BsaWNlKGluZGV4LCAxKTsKCSAgc3RhdGUucGlwZXNDb3VudCAtPSAxOwoJICBpZiAoc3RhdGUucGlwZXNDb3VudCA9PT0gMSkgc3RhdGUucGlwZXMgPSBzdGF0ZS5waXBlc1swXTsKCgkgIGRlc3QuZW1pdCgndW5waXBlJywgdGhpcyk7CgoJICByZXR1cm4gdGhpczsKCX07CgoJLy8gc2V0IHVwIGRhdGEgZXZlbnRzIGlmIHRoZXkgYXJlIGFza2VkIGZvcgoJLy8gRW5zdXJlIHJlYWRhYmxlIGxpc3RlbmVycyBldmVudHVhbGx5IGdldCBzb21ldGhpbmcKCVJlYWRhYmxlLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldiwgZm4pIHsKCSAgdmFyIHJlcyA9IFN0cmVhbS5wcm90b3R5cGUub24uY2FsbCh0aGlzLCBldiwgZm4pOwoKCSAgaWYgKGV2ID09PSAnZGF0YScpIHsKCSAgICAvLyBTdGFydCBmbG93aW5nIG9uIG5leHQgdGljayBpZiBzdHJlYW0gaXNuJ3QgZXhwbGljaXRseSBwYXVzZWQKCSAgICBpZiAodGhpcy5fcmVhZGFibGVTdGF0ZS5mbG93aW5nICE9PSBmYWxzZSkgdGhpcy5yZXN1bWUoKTsKCSAgfSBlbHNlIGlmIChldiA9PT0gJ3JlYWRhYmxlJykgewoJICAgIHZhciBzdGF0ZSA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgkgICAgaWYgKCFzdGF0ZS5lbmRFbWl0dGVkICYmICFzdGF0ZS5yZWFkYWJsZUxpc3RlbmluZykgewoJICAgICAgc3RhdGUucmVhZGFibGVMaXN0ZW5pbmcgPSBzdGF0ZS5uZWVkUmVhZGFibGUgPSB0cnVlOwoJICAgICAgc3RhdGUuZW1pdHRlZFJlYWRhYmxlID0gZmFsc2U7CgkgICAgICBpZiAoIXN0YXRlLnJlYWRpbmcpIHsKCSAgICAgICAgcHJvY2Vzc05leHRUaWNrKG5SZWFkaW5nTmV4dFRpY2ssIHRoaXMpOwoJICAgICAgfSBlbHNlIGlmIChzdGF0ZS5sZW5ndGgpIHsKCSAgICAgICAgZW1pdFJlYWRhYmxlKHRoaXMsIHN0YXRlKTsKCSAgICAgIH0KCSAgICB9CgkgIH0KCgkgIHJldHVybiByZXM7Cgl9OwoJUmVhZGFibGUucHJvdG90eXBlLmFkZExpc3RlbmVyID0gUmVhZGFibGUucHJvdG90eXBlLm9uOwoKCWZ1bmN0aW9uIG5SZWFkaW5nTmV4dFRpY2soc2VsZikgewoJICBkZWJ1ZygncmVhZGFibGUgbmV4dHRpY2sgcmVhZCAwJyk7CgkgIHNlbGYucmVhZCgwKTsKCX0KCgkvLyBwYXVzZSgpIGFuZCByZXN1bWUoKSBhcmUgcmVtbmFudHMgb2YgdGhlIGxlZ2FjeSByZWFkYWJsZSBzdHJlYW0gQVBJCgkvLyBJZiB0aGUgdXNlciB1c2VzIHRoZW0sIHRoZW4gc3dpdGNoIGludG8gb2xkIG1vZGUuCglSZWFkYWJsZS5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkgewoJICB2YXIgc3RhdGUgPSB0aGlzLl9yZWFkYWJsZVN0YXRlOwoJICBpZiAoIXN0YXRlLmZsb3dpbmcpIHsKCSAgICBkZWJ1ZygncmVzdW1lJyk7CgkgICAgc3RhdGUuZmxvd2luZyA9IHRydWU7CgkgICAgcmVzdW1lKHRoaXMsIHN0YXRlKTsKCSAgfQoJICByZXR1cm4gdGhpczsKCX07CgoJZnVuY3Rpb24gcmVzdW1lKHN0cmVhbSwgc3RhdGUpIHsKCSAgaWYgKCFzdGF0ZS5yZXN1bWVTY2hlZHVsZWQpIHsKCSAgICBzdGF0ZS5yZXN1bWVTY2hlZHVsZWQgPSB0cnVlOwoJICAgIHByb2Nlc3NOZXh0VGljayhyZXN1bWVfLCBzdHJlYW0sIHN0YXRlKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIHJlc3VtZV8oc3RyZWFtLCBzdGF0ZSkgewoJICBpZiAoIXN0YXRlLnJlYWRpbmcpIHsKCSAgICBkZWJ1ZygncmVzdW1lIHJlYWQgMCcpOwoJICAgIHN0cmVhbS5yZWFkKDApOwoJICB9CgoJICBzdGF0ZS5yZXN1bWVTY2hlZHVsZWQgPSBmYWxzZTsKCSAgc3RhdGUuYXdhaXREcmFpbiA9IDA7CgkgIHN0cmVhbS5lbWl0KCdyZXN1bWUnKTsKCSAgZmxvdyhzdHJlYW0pOwoJICBpZiAoc3RhdGUuZmxvd2luZyAmJiAhc3RhdGUucmVhZGluZykgc3RyZWFtLnJlYWQoMCk7Cgl9CgoJUmVhZGFibGUucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKCkgewoJICBkZWJ1ZygnY2FsbCBwYXVzZSBmbG93aW5nPSVqJywgdGhpcy5fcmVhZGFibGVTdGF0ZS5mbG93aW5nKTsKCSAgaWYgKGZhbHNlICE9PSB0aGlzLl9yZWFkYWJsZVN0YXRlLmZsb3dpbmcpIHsKCSAgICBkZWJ1ZygncGF1c2UnKTsKCSAgICB0aGlzLl9yZWFkYWJsZVN0YXRlLmZsb3dpbmcgPSBmYWxzZTsKCSAgICB0aGlzLmVtaXQoJ3BhdXNlJyk7CgkgIH0KCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCWZ1bmN0aW9uIGZsb3coc3RyZWFtKSB7CgkgIHZhciBzdGF0ZSA9IHN0cmVhbS5fcmVhZGFibGVTdGF0ZTsKCSAgZGVidWcoJ2Zsb3cnLCBzdGF0ZS5mbG93aW5nKTsKCSAgd2hpbGUgKHN0YXRlLmZsb3dpbmcgJiYgc3RyZWFtLnJlYWQoKSAhPT0gbnVsbCkge30KCX0KCgkvLyB3cmFwIGFuIG9sZC1zdHlsZSBzdHJlYW0gYXMgdGhlIGFzeW5jIGRhdGEgc291cmNlLgoJLy8gVGhpcyBpcyAqbm90KiBwYXJ0IG9mIHRoZSByZWFkYWJsZSBzdHJlYW0gaW50ZXJmYWNlLgoJLy8gSXQgaXMgYW4gdWdseSB1bmZvcnR1bmF0ZSBtZXNzIG9mIGhpc3RvcnkuCglSZWFkYWJsZS5wcm90b3R5cGUud3JhcCA9IGZ1bmN0aW9uIChzdHJlYW0pIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsKCSAgdmFyIHBhdXNlZCA9IGZhbHNlOwoKCSAgdmFyIHNlbGYgPSB0aGlzOwoJICBzdHJlYW0ub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsKCSAgICBkZWJ1Zygnd3JhcHBlZCBlbmQnKTsKCSAgICBpZiAoc3RhdGUuZGVjb2RlciAmJiAhc3RhdGUuZW5kZWQpIHsKCSAgICAgIHZhciBjaHVuayA9IHN0YXRlLmRlY29kZXIuZW5kKCk7CgkgICAgICBpZiAoY2h1bmsgJiYgY2h1bmsubGVuZ3RoKSBzZWxmLnB1c2goY2h1bmspOwoJICAgIH0KCgkgICAgc2VsZi5wdXNoKG51bGwpOwoJICB9KTsKCgkgIHN0cmVhbS5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykgewoJICAgIGRlYnVnKCd3cmFwcGVkIGRhdGEnKTsKCSAgICBpZiAoc3RhdGUuZGVjb2RlcikgY2h1bmsgPSBzdGF0ZS5kZWNvZGVyLndyaXRlKGNodW5rKTsKCgkgICAgLy8gZG9uJ3Qgc2tpcCBvdmVyIGZhbHN5IHZhbHVlcyBpbiBvYmplY3RNb2RlCgkgICAgaWYgKHN0YXRlLm9iamVjdE1vZGUgJiYgKGNodW5rID09PSBudWxsIHx8IGNodW5rID09PSB1bmRlZmluZWQpKSByZXR1cm47ZWxzZSBpZiAoIXN0YXRlLm9iamVjdE1vZGUgJiYgKCFjaHVuayB8fCAhY2h1bmsubGVuZ3RoKSkgcmV0dXJuOwoKCSAgICB2YXIgcmV0ID0gc2VsZi5wdXNoKGNodW5rKTsKCSAgICBpZiAoIXJldCkgewoJICAgICAgcGF1c2VkID0gdHJ1ZTsKCSAgICAgIHN0cmVhbS5wYXVzZSgpOwoJICAgIH0KCSAgfSk7CgoJICAvLyBwcm94eSBhbGwgdGhlIG90aGVyIG1ldGhvZHMuCgkgIC8vIGltcG9ydGFudCB3aGVuIHdyYXBwaW5nIGZpbHRlcnMgYW5kIGR1cGxleGVzLgoJICBmb3IgKHZhciBpIGluIHN0cmVhbSkgewoJICAgIGlmICh0aGlzW2ldID09PSB1bmRlZmluZWQgJiYgdHlwZW9mIHN0cmVhbVtpXSA9PT0gJ2Z1bmN0aW9uJykgewoJICAgICAgdGhpc1tpXSA9IGZ1bmN0aW9uIChtZXRob2QpIHsKCSAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICByZXR1cm4gc3RyZWFtW21ldGhvZF0uYXBwbHkoc3RyZWFtLCBhcmd1bWVudHMpOwoJICAgICAgICB9OwoJICAgICAgfShpKTsKCSAgICB9CgkgIH0KCgkgIC8vIHByb3h5IGNlcnRhaW4gaW1wb3J0YW50IGV2ZW50cy4KCSAgdmFyIGV2ZW50cyA9IFsnZXJyb3InLCAnY2xvc2UnLCAnZGVzdHJveScsICdwYXVzZScsICdyZXN1bWUnXTsKCSAgZm9yRWFjaChldmVudHMsIGZ1bmN0aW9uIChldikgewoJICAgIHN0cmVhbS5vbihldiwgc2VsZi5lbWl0LmJpbmQoc2VsZiwgZXYpKTsKCSAgfSk7CgoJICAvLyB3aGVuIHdlIHRyeSB0byBjb25zdW1lIHNvbWUgbW9yZSBieXRlcywgc2ltcGx5IHVucGF1c2UgdGhlCgkgIC8vIHVuZGVybHlpbmcgc3RyZWFtLgoJICBzZWxmLl9yZWFkID0gZnVuY3Rpb24gKG4pIHsKCSAgICBkZWJ1Zygnd3JhcHBlZCBfcmVhZCcsIG4pOwoJICAgIGlmIChwYXVzZWQpIHsKCSAgICAgIHBhdXNlZCA9IGZhbHNlOwoJICAgICAgc3RyZWFtLnJlc3VtZSgpOwoJICAgIH0KCSAgfTsKCgkgIHJldHVybiBzZWxmOwoJfTsKCgkvLyBleHBvc2VkIGZvciB0ZXN0aW5nIHB1cnBvc2VzIG9ubHkuCglSZWFkYWJsZS5fZnJvbUxpc3QgPSBmcm9tTGlzdDsKCgkvLyBQbHVjayBvZmYgbiBieXRlcyBmcm9tIGFuIGFycmF5IG9mIGJ1ZmZlcnMuCgkvLyBMZW5ndGggaXMgdGhlIGNvbWJpbmVkIGxlbmd0aHMgb2YgYWxsIHRoZSBidWZmZXJzIGluIHRoZSBsaXN0LgoJLy8gVGhpcyBmdW5jdGlvbiBpcyBkZXNpZ25lZCB0byBiZSBpbmxpbmFibGUsIHNvIHBsZWFzZSB0YWtlIGNhcmUgd2hlbiBtYWtpbmcKCS8vIGNoYW5nZXMgdG8gdGhlIGZ1bmN0aW9uIGJvZHkuCglmdW5jdGlvbiBmcm9tTGlzdChuLCBzdGF0ZSkgewoJICAvLyBub3RoaW5nIGJ1ZmZlcmVkCgkgIGlmIChzdGF0ZS5sZW5ndGggPT09IDApIHJldHVybiBudWxsOwoKCSAgdmFyIHJldDsKCSAgaWYgKHN0YXRlLm9iamVjdE1vZGUpIHJldCA9IHN0YXRlLmJ1ZmZlci5zaGlmdCgpO2Vsc2UgaWYgKCFuIHx8IG4gPj0gc3RhdGUubGVuZ3RoKSB7CgkgICAgLy8gcmVhZCBpdCBhbGwsIHRydW5jYXRlIHRoZSBsaXN0CgkgICAgaWYgKHN0YXRlLmRlY29kZXIpIHJldCA9IHN0YXRlLmJ1ZmZlci5qb2luKCcnKTtlbHNlIGlmIChzdGF0ZS5idWZmZXIubGVuZ3RoID09PSAxKSByZXQgPSBzdGF0ZS5idWZmZXIuaGVhZC5kYXRhO2Vsc2UgcmV0ID0gc3RhdGUuYnVmZmVyLmNvbmNhdChzdGF0ZS5sZW5ndGgpOwoJICAgIHN0YXRlLmJ1ZmZlci5jbGVhcigpOwoJICB9IGVsc2UgewoJICAgIC8vIHJlYWQgcGFydCBvZiBsaXN0CgkgICAgcmV0ID0gZnJvbUxpc3RQYXJ0aWFsKG4sIHN0YXRlLmJ1ZmZlciwgc3RhdGUuZGVjb2Rlcik7CgkgIH0KCgkgIHJldHVybiByZXQ7Cgl9CgoJLy8gRXh0cmFjdHMgb25seSBlbm91Z2ggYnVmZmVyZWQgZGF0YSB0byBzYXRpc2Z5IHRoZSBhbW91bnQgcmVxdWVzdGVkLgoJLy8gVGhpcyBmdW5jdGlvbiBpcyBkZXNpZ25lZCB0byBiZSBpbmxpbmFibGUsIHNvIHBsZWFzZSB0YWtlIGNhcmUgd2hlbiBtYWtpbmcKCS8vIGNoYW5nZXMgdG8gdGhlIGZ1bmN0aW9uIGJvZHkuCglmdW5jdGlvbiBmcm9tTGlzdFBhcnRpYWwobiwgbGlzdCwgaGFzU3RyaW5ncykgewoJICB2YXIgcmV0OwoJICBpZiAobiA8IGxpc3QuaGVhZC5kYXRhLmxlbmd0aCkgewoJICAgIC8vIHNsaWNlIGlzIHRoZSBzYW1lIGZvciBidWZmZXJzIGFuZCBzdHJpbmdzCgkgICAgcmV0ID0gbGlzdC5oZWFkLmRhdGEuc2xpY2UoMCwgbik7CgkgICAgbGlzdC5oZWFkLmRhdGEgPSBsaXN0LmhlYWQuZGF0YS5zbGljZShuKTsKCSAgfSBlbHNlIGlmIChuID09PSBsaXN0LmhlYWQuZGF0YS5sZW5ndGgpIHsKCSAgICAvLyBmaXJzdCBjaHVuayBpcyBhIHBlcmZlY3QgbWF0Y2gKCSAgICByZXQgPSBsaXN0LnNoaWZ0KCk7CgkgIH0gZWxzZSB7CgkgICAgLy8gcmVzdWx0IHNwYW5zIG1vcmUgdGhhbiBvbmUgYnVmZmVyCgkgICAgcmV0ID0gaGFzU3RyaW5ncyA/IGNvcHlGcm9tQnVmZmVyU3RyaW5nKG4sIGxpc3QpIDogY29weUZyb21CdWZmZXIobiwgbGlzdCk7CgkgIH0KCSAgcmV0dXJuIHJldDsKCX0KCgkvLyBDb3BpZXMgYSBzcGVjaWZpZWQgYW1vdW50IG9mIGNoYXJhY3RlcnMgZnJvbSB0aGUgbGlzdCBvZiBidWZmZXJlZCBkYXRhCgkvLyBjaHVua3MuCgkvLyBUaGlzIGZ1bmN0aW9uIGlzIGRlc2lnbmVkIHRvIGJlIGlubGluYWJsZSwgc28gcGxlYXNlIHRha2UgY2FyZSB3aGVuIG1ha2luZwoJLy8gY2hhbmdlcyB0byB0aGUgZnVuY3Rpb24gYm9keS4KCWZ1bmN0aW9uIGNvcHlGcm9tQnVmZmVyU3RyaW5nKG4sIGxpc3QpIHsKCSAgdmFyIHAgPSBsaXN0LmhlYWQ7CgkgIHZhciBjID0gMTsKCSAgdmFyIHJldCA9IHAuZGF0YTsKCSAgbiAtPSByZXQubGVuZ3RoOwoJICB3aGlsZSAocCA9IHAubmV4dCkgewoJICAgIHZhciBzdHIgPSBwLmRhdGE7CgkgICAgdmFyIG5iID0gbiA+IHN0ci5sZW5ndGggPyBzdHIubGVuZ3RoIDogbjsKCSAgICBpZiAobmIgPT09IHN0ci5sZW5ndGgpIHJldCArPSBzdHI7ZWxzZSByZXQgKz0gc3RyLnNsaWNlKDAsIG4pOwoJICAgIG4gLT0gbmI7CgkgICAgaWYgKG4gPT09IDApIHsKCSAgICAgIGlmIChuYiA9PT0gc3RyLmxlbmd0aCkgewoJICAgICAgICArK2M7CgkgICAgICAgIGlmIChwLm5leHQpIGxpc3QuaGVhZCA9IHAubmV4dDtlbHNlIGxpc3QuaGVhZCA9IGxpc3QudGFpbCA9IG51bGw7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBsaXN0LmhlYWQgPSBwOwoJICAgICAgICBwLmRhdGEgPSBzdHIuc2xpY2UobmIpOwoJICAgICAgfQoJICAgICAgYnJlYWs7CgkgICAgfQoJICAgICsrYzsKCSAgfQoJICBsaXN0Lmxlbmd0aCAtPSBjOwoJICByZXR1cm4gcmV0OwoJfQoKCS8vIENvcGllcyBhIHNwZWNpZmllZCBhbW91bnQgb2YgYnl0ZXMgZnJvbSB0aGUgbGlzdCBvZiBidWZmZXJlZCBkYXRhIGNodW5rcy4KCS8vIFRoaXMgZnVuY3Rpb24gaXMgZGVzaWduZWQgdG8gYmUgaW5saW5hYmxlLCBzbyBwbGVhc2UgdGFrZSBjYXJlIHdoZW4gbWFraW5nCgkvLyBjaGFuZ2VzIHRvIHRoZSBmdW5jdGlvbiBib2R5LgoJZnVuY3Rpb24gY29weUZyb21CdWZmZXIobiwgbGlzdCkgewoJICB2YXIgcmV0ID0gYnVmZmVyU2hpbS5hbGxvY1Vuc2FmZShuKTsKCSAgdmFyIHAgPSBsaXN0LmhlYWQ7CgkgIHZhciBjID0gMTsKCSAgcC5kYXRhLmNvcHkocmV0KTsKCSAgbiAtPSBwLmRhdGEubGVuZ3RoOwoJICB3aGlsZSAocCA9IHAubmV4dCkgewoJICAgIHZhciBidWYgPSBwLmRhdGE7CgkgICAgdmFyIG5iID0gbiA+IGJ1Zi5sZW5ndGggPyBidWYubGVuZ3RoIDogbjsKCSAgICBidWYuY29weShyZXQsIHJldC5sZW5ndGggLSBuLCAwLCBuYik7CgkgICAgbiAtPSBuYjsKCSAgICBpZiAobiA9PT0gMCkgewoJICAgICAgaWYgKG5iID09PSBidWYubGVuZ3RoKSB7CgkgICAgICAgICsrYzsKCSAgICAgICAgaWYgKHAubmV4dCkgbGlzdC5oZWFkID0gcC5uZXh0O2Vsc2UgbGlzdC5oZWFkID0gbGlzdC50YWlsID0gbnVsbDsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGxpc3QuaGVhZCA9IHA7CgkgICAgICAgIHAuZGF0YSA9IGJ1Zi5zbGljZShuYik7CgkgICAgICB9CgkgICAgICBicmVhazsKCSAgICB9CgkgICAgKytjOwoJICB9CgkgIGxpc3QubGVuZ3RoIC09IGM7CgkgIHJldHVybiByZXQ7Cgl9CgoJZnVuY3Rpb24gZW5kUmVhZGFibGUoc3RyZWFtKSB7CgkgIHZhciBzdGF0ZSA9IHN0cmVhbS5fcmVhZGFibGVTdGF0ZTsKCgkgIC8vIElmIHdlIGdldCBoZXJlIGJlZm9yZSBjb25zdW1pbmcgYWxsIHRoZSBieXRlcywgdGhlbiB0aGF0IGlzIGEKCSAgLy8gYnVnIGluIG5vZGUuICBTaG91bGQgbmV2ZXIgaGFwcGVuLgoJICBpZiAoc3RhdGUubGVuZ3RoID4gMCkgdGhyb3cgbmV3IEVycm9yKCciZW5kUmVhZGFibGUoKSIgY2FsbGVkIG9uIG5vbi1lbXB0eSBzdHJlYW0nKTsKCgkgIGlmICghc3RhdGUuZW5kRW1pdHRlZCkgewoJICAgIHN0YXRlLmVuZGVkID0gdHJ1ZTsKCSAgICBwcm9jZXNzTmV4dFRpY2soZW5kUmVhZGFibGVOVCwgc3RhdGUsIHN0cmVhbSk7CgkgIH0KCX0KCglmdW5jdGlvbiBlbmRSZWFkYWJsZU5UKHN0YXRlLCBzdHJlYW0pIHsKCSAgLy8gQ2hlY2sgdGhhdCB3ZSBkaWRuJ3QgZ2V0IG9uZSBsYXN0IHVuc2hpZnQuCgkgIGlmICghc3RhdGUuZW5kRW1pdHRlZCAmJiBzdGF0ZS5sZW5ndGggPT09IDApIHsKCSAgICBzdGF0ZS5lbmRFbWl0dGVkID0gdHJ1ZTsKCSAgICBzdHJlYW0ucmVhZGFibGUgPSBmYWxzZTsKCSAgICBzdHJlYW0uZW1pdCgnZW5kJyk7CgkgIH0KCX0KCglmdW5jdGlvbiBmb3JFYWNoKHhzLCBmKSB7CgkgIGZvciAodmFyIGkgPSAwLCBsID0geHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgZih4c1tpXSwgaSk7CgkgIH0KCX0KCglmdW5jdGlvbiBpbmRleE9mKHhzLCB4KSB7CgkgIGZvciAodmFyIGkgPSAwLCBsID0geHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgaWYgKHhzW2ldID09PSB4KSByZXR1cm4gaTsKCSAgfQoJICByZXR1cm4gLTE7Cgl9CgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygxNikpKQoKLyoqKi8gfSwKLyogMzUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKHByb2Nlc3MpIHsndXNlIHN0cmljdCc7CgoJaWYgKCFwcm9jZXNzLnZlcnNpb24gfHwKCSAgICBwcm9jZXNzLnZlcnNpb24uaW5kZXhPZigndjAuJykgPT09IDAgfHwKCSAgICBwcm9jZXNzLnZlcnNpb24uaW5kZXhPZigndjEuJykgPT09IDAgJiYgcHJvY2Vzcy52ZXJzaW9uLmluZGV4T2YoJ3YxLjguJykgIT09IDApIHsKCSAgbW9kdWxlLmV4cG9ydHMgPSBuZXh0VGljazsKCX0gZWxzZSB7CgkgIG1vZHVsZS5leHBvcnRzID0gcHJvY2Vzcy5uZXh0VGljazsKCX0KCglmdW5jdGlvbiBuZXh0VGljayhmbiwgYXJnMSwgYXJnMiwgYXJnMykgewoJICBpZiAodHlwZW9mIGZuICE9PSAnZnVuY3Rpb24nKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignImNhbGxiYWNrIiBhcmd1bWVudCBtdXN0IGJlIGEgZnVuY3Rpb24nKTsKCSAgfQoJICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsKCSAgdmFyIGFyZ3MsIGk7CgkgIHN3aXRjaCAobGVuKSB7CgkgIGNhc2UgMDoKCSAgY2FzZSAxOgoJICAgIHJldHVybiBwcm9jZXNzLm5leHRUaWNrKGZuKTsKCSAgY2FzZSAyOgoJICAgIHJldHVybiBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uIGFmdGVyVGlja09uZSgpIHsKCSAgICAgIGZuLmNhbGwobnVsbCwgYXJnMSk7CgkgICAgfSk7CgkgIGNhc2UgMzoKCSAgICByZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiBhZnRlclRpY2tUd28oKSB7CgkgICAgICBmbi5jYWxsKG51bGwsIGFyZzEsIGFyZzIpOwoJICAgIH0pOwoJICBjYXNlIDQ6CgkgICAgcmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gYWZ0ZXJUaWNrVGhyZWUoKSB7CgkgICAgICBmbi5jYWxsKG51bGwsIGFyZzEsIGFyZzIsIGFyZzMpOwoJICAgIH0pOwoJICBkZWZhdWx0OgoJICAgIGFyZ3MgPSBuZXcgQXJyYXkobGVuIC0gMSk7CgkgICAgaSA9IDA7CgkgICAgd2hpbGUgKGkgPCBhcmdzLmxlbmd0aCkgewoJICAgICAgYXJnc1tpKytdID0gYXJndW1lbnRzW2ldOwoJICAgIH0KCSAgICByZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiBhZnRlclRpY2soKSB7CgkgICAgICBmbi5hcHBseShudWxsLCBhcmdzKTsKCSAgICB9KTsKCSAgfQoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KSkpCgovKioqLyB9LAovKiAzNiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7J3VzZSBzdHJpY3QnOwoKCXZhciBidWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwoJdmFyIEJ1ZmZlciA9IGJ1ZmZlci5CdWZmZXI7Cgl2YXIgU2xvd0J1ZmZlciA9IGJ1ZmZlci5TbG93QnVmZmVyOwoJdmFyIE1BWF9MRU4gPSBidWZmZXIua01heExlbmd0aCB8fCAyMTQ3NDgzNjQ3OwoJZXhwb3J0cy5hbGxvYyA9IGZ1bmN0aW9uIGFsbG9jKHNpemUsIGZpbGwsIGVuY29kaW5nKSB7CgkgIGlmICh0eXBlb2YgQnVmZmVyLmFsbG9jID09PSAnZnVuY3Rpb24nKSB7CgkgICAgcmV0dXJuIEJ1ZmZlci5hbGxvYyhzaXplLCBmaWxsLCBlbmNvZGluZyk7CgkgIH0KCSAgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gJ251bWJlcicpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdlbmNvZGluZyBtdXN0IG5vdCBiZSBudW1iZXInKTsKCSAgfQoJICBpZiAodHlwZW9mIHNpemUgIT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignc2l6ZSBtdXN0IGJlIGEgbnVtYmVyJyk7CgkgIH0KCSAgaWYgKHNpemUgPiBNQVhfTEVOKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NpemUgaXMgdG9vIGxhcmdlJyk7CgkgIH0KCSAgdmFyIGVuYyA9IGVuY29kaW5nOwoJICB2YXIgX2ZpbGwgPSBmaWxsOwoJICBpZiAoX2ZpbGwgPT09IHVuZGVmaW5lZCkgewoJICAgIGVuYyA9IHVuZGVmaW5lZDsKCSAgICBfZmlsbCA9IDA7CgkgIH0KCSAgdmFyIGJ1ZiA9IG5ldyBCdWZmZXIoc2l6ZSk7CgkgIGlmICh0eXBlb2YgX2ZpbGwgPT09ICdzdHJpbmcnKSB7CgkgICAgdmFyIGZpbGxCdWYgPSBuZXcgQnVmZmVyKF9maWxsLCBlbmMpOwoJICAgIHZhciBmbGVuID0gZmlsbEJ1Zi5sZW5ndGg7CgkgICAgdmFyIGkgPSAtMTsKCSAgICB3aGlsZSAoKytpIDwgc2l6ZSkgewoJICAgICAgYnVmW2ldID0gZmlsbEJ1ZltpICUgZmxlbl07CgkgICAgfQoJICB9IGVsc2UgewoJICAgIGJ1Zi5maWxsKF9maWxsKTsKCSAgfQoJICByZXR1cm4gYnVmOwoJfQoJZXhwb3J0cy5hbGxvY1Vuc2FmZSA9IGZ1bmN0aW9uIGFsbG9jVW5zYWZlKHNpemUpIHsKCSAgaWYgKHR5cGVvZiBCdWZmZXIuYWxsb2NVbnNhZmUgPT09ICdmdW5jdGlvbicpIHsKCSAgICByZXR1cm4gQnVmZmVyLmFsbG9jVW5zYWZlKHNpemUpOwoJICB9CgkgIGlmICh0eXBlb2Ygc2l6ZSAhPT0gJ251bWJlcicpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdzaXplIG11c3QgYmUgYSBudW1iZXInKTsKCSAgfQoJICBpZiAoc2l6ZSA+IE1BWF9MRU4pIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc2l6ZSBpcyB0b28gbGFyZ2UnKTsKCSAgfQoJICByZXR1cm4gbmV3IEJ1ZmZlcihzaXplKTsKCX0KCWV4cG9ydHMuZnJvbSA9IGZ1bmN0aW9uIGZyb20odmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkgewoJICBpZiAodHlwZW9mIEJ1ZmZlci5mcm9tID09PSAnZnVuY3Rpb24nICYmICghZ2xvYmFsLlVpbnQ4QXJyYXkgfHwgVWludDhBcnJheS5mcm9tICE9PSBCdWZmZXIuZnJvbSkpIHsKCSAgICByZXR1cm4gQnVmZmVyLmZyb20odmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCk7CgkgIH0KCSAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcidmFsdWUiIGFyZ3VtZW50IG11c3Qgbm90IGJlIGEgbnVtYmVyJyk7CgkgIH0KCSAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHsKCSAgICByZXR1cm4gbmV3IEJ1ZmZlcih2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCk7CgkgIH0KCSAgaWYgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgewoJICAgIHZhciBvZmZzZXQgPSBlbmNvZGluZ09yT2Zmc2V0OwoJICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7CgkgICAgICByZXR1cm4gbmV3IEJ1ZmZlcih2YWx1ZSk7CgkgICAgfQoJICAgIGlmICh0eXBlb2Ygb2Zmc2V0ID09PSAndW5kZWZpbmVkJykgewoJICAgICAgb2Zmc2V0ID0gMDsKCSAgICB9CgkgICAgdmFyIGxlbiA9IGxlbmd0aDsKCSAgICBpZiAodHlwZW9mIGxlbiA9PT0gJ3VuZGVmaW5lZCcpIHsKCSAgICAgIGxlbiA9IHZhbHVlLmJ5dGVMZW5ndGggLSBvZmZzZXQ7CgkgICAgfQoJICAgIGlmIChvZmZzZXQgPj0gdmFsdWUuYnl0ZUxlbmd0aCkgewoJICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wnb2Zmc2V0XCcgaXMgb3V0IG9mIGJvdW5kcycpOwoJICAgIH0KCSAgICBpZiAobGVuID4gdmFsdWUuYnl0ZUxlbmd0aCAtIG9mZnNldCkgewoJICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wnbGVuZ3RoXCcgaXMgb3V0IG9mIGJvdW5kcycpOwoJICAgIH0KCSAgICByZXR1cm4gbmV3IEJ1ZmZlcih2YWx1ZS5zbGljZShvZmZzZXQsIG9mZnNldCArIGxlbikpOwoJICB9CgkgIGlmIChCdWZmZXIuaXNCdWZmZXIodmFsdWUpKSB7CgkgICAgdmFyIG91dCA9IG5ldyBCdWZmZXIodmFsdWUubGVuZ3RoKTsKCSAgICB2YWx1ZS5jb3B5KG91dCwgMCwgMCwgdmFsdWUubGVuZ3RoKTsKCSAgICByZXR1cm4gb3V0OwoJICB9CgkgIGlmICh2YWx1ZSkgewoJICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSB8fCAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZS5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgfHwgJ2xlbmd0aCcgaW4gdmFsdWUpIHsKCSAgICAgIHJldHVybiBuZXcgQnVmZmVyKHZhbHVlKTsKCSAgICB9CgkgICAgaWYgKHZhbHVlLnR5cGUgPT09ICdCdWZmZXInICYmIEFycmF5LmlzQXJyYXkodmFsdWUuZGF0YSkpIHsKCSAgICAgIHJldHVybiBuZXcgQnVmZmVyKHZhbHVlLmRhdGEpOwoJICAgIH0KCSAgfQoKCSAgdGhyb3cgbmV3IFR5cGVFcnJvcignRmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZywgQnVmZmVyLCAnICsgJ0FycmF5QnVmZmVyLCBBcnJheSwgb3IgYXJyYXktbGlrZSBvYmplY3QuJyk7Cgl9CglleHBvcnRzLmFsbG9jVW5zYWZlU2xvdyA9IGZ1bmN0aW9uIGFsbG9jVW5zYWZlU2xvdyhzaXplKSB7CgkgIGlmICh0eXBlb2YgQnVmZmVyLmFsbG9jVW5zYWZlU2xvdyA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIHJldHVybiBCdWZmZXIuYWxsb2NVbnNhZmVTbG93KHNpemUpOwoJICB9CgkgIGlmICh0eXBlb2Ygc2l6ZSAhPT0gJ251bWJlcicpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdzaXplIG11c3QgYmUgYSBudW1iZXInKTsKCSAgfQoJICBpZiAoc2l6ZSA+PSBNQVhfTEVOKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NpemUgaXMgdG9vIGxhcmdlJyk7CgkgIH0KCSAgcmV0dXJuIG5ldyBTbG93QnVmZmVyKHNpemUpOwoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSkKCi8qKiovIH0sCi8qIDM3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIpIHsvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCS8vIE5PVEU6IFRoZXNlIHR5cGUgY2hlY2tpbmcgZnVuY3Rpb25zIGludGVudGlvbmFsbHkgZG9uJ3QgdXNlIGBpbnN0YW5jZW9mYAoJLy8gYmVjYXVzZSBpdCBpcyBmcmFnaWxlIGFuZCBjYW4gYmUgZWFzaWx5IGZha2VkIHdpdGggYE9iamVjdC5jcmVhdGUoKWAuCgoJZnVuY3Rpb24gaXNBcnJheShhcmcpIHsKCSAgaWYgKEFycmF5LmlzQXJyYXkpIHsKCSAgICByZXR1cm4gQXJyYXkuaXNBcnJheShhcmcpOwoJICB9CgkgIHJldHVybiBvYmplY3RUb1N0cmluZyhhcmcpID09PSAnW29iamVjdCBBcnJheV0nOwoJfQoJZXhwb3J0cy5pc0FycmF5ID0gaXNBcnJheTsKCglmdW5jdGlvbiBpc0Jvb2xlYW4oYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnYm9vbGVhbic7Cgl9CglleHBvcnRzLmlzQm9vbGVhbiA9IGlzQm9vbGVhbjsKCglmdW5jdGlvbiBpc051bGwoYXJnKSB7CgkgIHJldHVybiBhcmcgPT09IG51bGw7Cgl9CglleHBvcnRzLmlzTnVsbCA9IGlzTnVsbDsKCglmdW5jdGlvbiBpc051bGxPclVuZGVmaW5lZChhcmcpIHsKCSAgcmV0dXJuIGFyZyA9PSBudWxsOwoJfQoJZXhwb3J0cy5pc051bGxPclVuZGVmaW5lZCA9IGlzTnVsbE9yVW5kZWZpbmVkOwoKCWZ1bmN0aW9uIGlzTnVtYmVyKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ251bWJlcic7Cgl9CglleHBvcnRzLmlzTnVtYmVyID0gaXNOdW1iZXI7CgoJZnVuY3Rpb24gaXNTdHJpbmcoYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnc3RyaW5nJzsKCX0KCWV4cG9ydHMuaXNTdHJpbmcgPSBpc1N0cmluZzsKCglmdW5jdGlvbiBpc1N5bWJvbChhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdzeW1ib2wnOwoJfQoJZXhwb3J0cy5pc1N5bWJvbCA9IGlzU3ltYm9sOwoKCWZ1bmN0aW9uIGlzVW5kZWZpbmVkKGFyZykgewoJICByZXR1cm4gYXJnID09PSB2b2lkIDA7Cgl9CglleHBvcnRzLmlzVW5kZWZpbmVkID0gaXNVbmRlZmluZWQ7CgoJZnVuY3Rpb24gaXNSZWdFeHAocmUpIHsKCSAgcmV0dXJuIG9iamVjdFRvU3RyaW5nKHJlKSA9PT0gJ1tvYmplY3QgUmVnRXhwXSc7Cgl9CglleHBvcnRzLmlzUmVnRXhwID0gaXNSZWdFeHA7CgoJZnVuY3Rpb24gaXNPYmplY3QoYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiBhcmcgIT09IG51bGw7Cgl9CglleHBvcnRzLmlzT2JqZWN0ID0gaXNPYmplY3Q7CgoJZnVuY3Rpb24gaXNEYXRlKGQpIHsKCSAgcmV0dXJuIG9iamVjdFRvU3RyaW5nKGQpID09PSAnW29iamVjdCBEYXRlXSc7Cgl9CglleHBvcnRzLmlzRGF0ZSA9IGlzRGF0ZTsKCglmdW5jdGlvbiBpc0Vycm9yKGUpIHsKCSAgcmV0dXJuIChvYmplY3RUb1N0cmluZyhlKSA9PT0gJ1tvYmplY3QgRXJyb3JdJyB8fCBlIGluc3RhbmNlb2YgRXJyb3IpOwoJfQoJZXhwb3J0cy5pc0Vycm9yID0gaXNFcnJvcjsKCglmdW5jdGlvbiBpc0Z1bmN0aW9uKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Z1bmN0aW9uJzsKCX0KCWV4cG9ydHMuaXNGdW5jdGlvbiA9IGlzRnVuY3Rpb247CgoJZnVuY3Rpb24gaXNQcmltaXRpdmUoYXJnKSB7CgkgIHJldHVybiBhcmcgPT09IG51bGwgfHwKCSAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdib29sZWFuJyB8fAoJICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ251bWJlcicgfHwKCSAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnIHx8CgkgICAgICAgICB0eXBlb2YgYXJnID09PSAnc3ltYm9sJyB8fCAgLy8gRVM2IHN5bWJvbAoJICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ3VuZGVmaW5lZCc7Cgl9CglleHBvcnRzLmlzUHJpbWl0aXZlID0gaXNQcmltaXRpdmU7CgoJZXhwb3J0cy5pc0J1ZmZlciA9IEJ1ZmZlci5pc0J1ZmZlcjsKCglmdW5jdGlvbiBvYmplY3RUb1N0cmluZyhvKSB7CgkgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobyk7Cgl9CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oNSkuQnVmZmVyKSkKCi8qKiovIH0sCi8qIDM4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8qIChpZ25vcmVkKSAqLwoKLyoqKi8gfSwKLyogMzkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCXZhciBCdWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcjsKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgYnVmZmVyU2hpbSA9IF9fd2VicGFja19yZXF1aXJlX18oMzYpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJbW9kdWxlLmV4cG9ydHMgPSBCdWZmZXJMaXN0OwoKCWZ1bmN0aW9uIEJ1ZmZlckxpc3QoKSB7CgkgIHRoaXMuaGVhZCA9IG51bGw7CgkgIHRoaXMudGFpbCA9IG51bGw7CgkgIHRoaXMubGVuZ3RoID0gMDsKCX0KCglCdWZmZXJMaXN0LnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKHYpIHsKCSAgdmFyIGVudHJ5ID0geyBkYXRhOiB2LCBuZXh0OiBudWxsIH07CgkgIGlmICh0aGlzLmxlbmd0aCA+IDApIHRoaXMudGFpbC5uZXh0ID0gZW50cnk7ZWxzZSB0aGlzLmhlYWQgPSBlbnRyeTsKCSAgdGhpcy50YWlsID0gZW50cnk7CgkgICsrdGhpcy5sZW5ndGg7Cgl9OwoKCUJ1ZmZlckxpc3QucHJvdG90eXBlLnVuc2hpZnQgPSBmdW5jdGlvbiAodikgewoJICB2YXIgZW50cnkgPSB7IGRhdGE6IHYsIG5leHQ6IHRoaXMuaGVhZCB9OwoJICBpZiAodGhpcy5sZW5ndGggPT09IDApIHRoaXMudGFpbCA9IGVudHJ5OwoJICB0aGlzLmhlYWQgPSBlbnRyeTsKCSAgKyt0aGlzLmxlbmd0aDsKCX07CgoJQnVmZmVyTGlzdC5wcm90b3R5cGUuc2hpZnQgPSBmdW5jdGlvbiAoKSB7CgkgIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuOwoJICB2YXIgcmV0ID0gdGhpcy5oZWFkLmRhdGE7CgkgIGlmICh0aGlzLmxlbmd0aCA9PT0gMSkgdGhpcy5oZWFkID0gdGhpcy50YWlsID0gbnVsbDtlbHNlIHRoaXMuaGVhZCA9IHRoaXMuaGVhZC5uZXh0OwoJICAtLXRoaXMubGVuZ3RoOwoJICByZXR1cm4gcmV0OwoJfTsKCglCdWZmZXJMaXN0LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgdGhpcy5oZWFkID0gdGhpcy50YWlsID0gbnVsbDsKCSAgdGhpcy5sZW5ndGggPSAwOwoJfTsKCglCdWZmZXJMaXN0LnByb3RvdHlwZS5qb2luID0gZnVuY3Rpb24gKHMpIHsKCSAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm4gJyc7CgkgIHZhciBwID0gdGhpcy5oZWFkOwoJICB2YXIgcmV0ID0gJycgKyBwLmRhdGE7CgkgIHdoaWxlIChwID0gcC5uZXh0KSB7CgkgICAgcmV0ICs9IHMgKyBwLmRhdGE7CgkgIH1yZXR1cm4gcmV0OwoJfTsKCglCdWZmZXJMaXN0LnByb3RvdHlwZS5jb25jYXQgPSBmdW5jdGlvbiAobikgewoJICBpZiAodGhpcy5sZW5ndGggPT09IDApIHJldHVybiBidWZmZXJTaGltLmFsbG9jKDApOwoJICBpZiAodGhpcy5sZW5ndGggPT09IDEpIHJldHVybiB0aGlzLmhlYWQuZGF0YTsKCSAgdmFyIHJldCA9IGJ1ZmZlclNoaW0uYWxsb2NVbnNhZmUobiA+Pj4gMCk7CgkgIHZhciBwID0gdGhpcy5oZWFkOwoJICB2YXIgaSA9IDA7CgkgIHdoaWxlIChwKSB7CgkgICAgcC5kYXRhLmNvcHkocmV0LCBpKTsKCSAgICBpICs9IHAuZGF0YS5sZW5ndGg7CgkgICAgcCA9IHAubmV4dDsKCSAgfQoJICByZXR1cm4gcmV0OwoJfTsKCi8qKiovIH0sCi8qIDQwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGEgZHVwbGV4IHN0cmVhbSBpcyBqdXN0IGEgc3RyZWFtIHRoYXQgaXMgYm90aCByZWFkYWJsZSBhbmQgd3JpdGFibGUuCgkvLyBTaW5jZSBKUyBkb2Vzbid0IGhhdmUgbXVsdGlwbGUgcHJvdG90eXBhbCBpbmhlcml0YW5jZSwgdGhpcyBjbGFzcwoJLy8gcHJvdG90eXBhbGx5IGluaGVyaXRzIGZyb20gUmVhZGFibGUsIGFuZCB0aGVuIHBhcmFzaXRpY2FsbHkgZnJvbQoJLy8gV3JpdGFibGUuCgoJJ3VzZSBzdHJpY3QnOwoKCS8qPHJlcGxhY2VtZW50PiovCgoJdmFyIG9iamVjdEtleXMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiAob2JqKSB7CgkgIHZhciBrZXlzID0gW107CgkgIGZvciAodmFyIGtleSBpbiBvYmopIHsKCSAgICBrZXlzLnB1c2goa2V5KTsKCSAgfXJldHVybiBrZXlzOwoJfTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCW1vZHVsZS5leHBvcnRzID0gRHVwbGV4OwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgcHJvY2Vzc05leHRUaWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM3KTsKCXV0aWwuaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXZhciBSZWFkYWJsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpOwoJdmFyIFdyaXRhYmxlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSk7CgoJdXRpbC5pbmhlcml0cyhEdXBsZXgsIFJlYWRhYmxlKTsKCgl2YXIga2V5cyA9IG9iamVjdEtleXMoV3JpdGFibGUucHJvdG90eXBlKTsKCWZvciAodmFyIHYgPSAwOyB2IDwga2V5cy5sZW5ndGg7IHYrKykgewoJICB2YXIgbWV0aG9kID0ga2V5c1t2XTsKCSAgaWYgKCFEdXBsZXgucHJvdG90eXBlW21ldGhvZF0pIER1cGxleC5wcm90b3R5cGVbbWV0aG9kXSA9IFdyaXRhYmxlLnByb3RvdHlwZVttZXRob2RdOwoJfQoKCWZ1bmN0aW9uIER1cGxleChvcHRpb25zKSB7CgkgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBEdXBsZXgpKSByZXR1cm4gbmV3IER1cGxleChvcHRpb25zKTsKCgkgIFJlYWRhYmxlLmNhbGwodGhpcywgb3B0aW9ucyk7CgkgIFdyaXRhYmxlLmNhbGwodGhpcywgb3B0aW9ucyk7CgoJICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnJlYWRhYmxlID09PSBmYWxzZSkgdGhpcy5yZWFkYWJsZSA9IGZhbHNlOwoKCSAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy53cml0YWJsZSA9PT0gZmFsc2UpIHRoaXMud3JpdGFibGUgPSBmYWxzZTsKCgkgIHRoaXMuYWxsb3dIYWxmT3BlbiA9IHRydWU7CgkgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuYWxsb3dIYWxmT3BlbiA9PT0gZmFsc2UpIHRoaXMuYWxsb3dIYWxmT3BlbiA9IGZhbHNlOwoKCSAgdGhpcy5vbmNlKCdlbmQnLCBvbmVuZCk7Cgl9CgoJLy8gdGhlIG5vLWhhbGYtb3BlbiBlbmZvcmNlcgoJZnVuY3Rpb24gb25lbmQoKSB7CgkgIC8vIGlmIHdlIGFsbG93IGhhbGYtb3BlbiBzdGF0ZSwgb3IgaWYgdGhlIHdyaXRhYmxlIHNpZGUgZW5kZWQsCgkgIC8vIHRoZW4gd2UncmUgb2suCgkgIGlmICh0aGlzLmFsbG93SGFsZk9wZW4gfHwgdGhpcy5fd3JpdGFibGVTdGF0ZS5lbmRlZCkgcmV0dXJuOwoKCSAgLy8gbm8gbW9yZSBkYXRhIGNhbiBiZSB3cml0dGVuLgoJICAvLyBCdXQgYWxsb3cgbW9yZSB3cml0ZXMgdG8gaGFwcGVuIGluIHRoaXMgdGljay4KCSAgcHJvY2Vzc05leHRUaWNrKG9uRW5kTlQsIHRoaXMpOwoJfQoKCWZ1bmN0aW9uIG9uRW5kTlQoc2VsZikgewoJICBzZWxmLmVuZCgpOwoJfQoKCWZ1bmN0aW9uIGZvckVhY2goeHMsIGYpIHsKCSAgZm9yICh2YXIgaSA9IDAsIGwgPSB4cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKCSAgICBmKHhzW2ldLCBpKTsKCSAgfQoJfQoKLyoqKi8gfSwKLyogNDEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKHByb2Nlc3MsIHNldEltbWVkaWF0ZSkgey8vIEEgYml0IHNpbXBsZXIgdGhhbiByZWFkYWJsZSBzdHJlYW1zLgoJLy8gSW1wbGVtZW50IGFuIGFzeW5jIC5fd3JpdGUoY2h1bmssIGVuY29kaW5nLCBjYiksIGFuZCBpdCdsbCBoYW5kbGUgYWxsCgkvLyB0aGUgZHJhaW4gZXZlbnQgZW1pc3Npb24gYW5kIGJ1ZmZlcmluZy4KCgkndXNlIHN0cmljdCc7CgoJbW9kdWxlLmV4cG9ydHMgPSBXcml0YWJsZTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHByb2Nlc3NOZXh0VGljayA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBhc3luY1dyaXRlID0gIXByb2Nlc3MuYnJvd3NlciAmJiBbJ3YwLjEwJywgJ3YwLjkuJ10uaW5kZXhPZihwcm9jZXNzLnZlcnNpb24uc2xpY2UoMCwgNSkpID4gLTEgPyBzZXRJbW1lZGlhdGUgOiBwcm9jZXNzTmV4dFRpY2s7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIER1cGxleDsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCVdyaXRhYmxlLldyaXRhYmxlU3RhdGUgPSBXcml0YWJsZVN0YXRlOwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgdXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oMzcpOwoJdXRpbC5pbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBpbnRlcm5hbFV0aWwgPSB7CgkgIGRlcHJlY2F0ZTogX193ZWJwYWNrX3JlcXVpcmVfXyg0NCkKCX07CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIFN0cmVhbTsKCShmdW5jdGlvbiAoKSB7CgkgIHRyeSB7CgkgICAgU3RyZWFtID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMSk7CgkgIH0gY2F0Y2ggKF8pIHt9IGZpbmFsbHkgewoJICAgIGlmICghU3RyZWFtKSBTdHJlYW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpLkV2ZW50RW1pdHRlcjsKCSAgfQoJfSkoKTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXZhciBCdWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcjsKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgYnVmZmVyU2hpbSA9IF9fd2VicGFja19yZXF1aXJlX18oMzYpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJdXRpbC5pbmhlcml0cyhXcml0YWJsZSwgU3RyZWFtKTsKCglmdW5jdGlvbiBub3AoKSB7fQoKCWZ1bmN0aW9uIFdyaXRlUmVxKGNodW5rLCBlbmNvZGluZywgY2IpIHsKCSAgdGhpcy5jaHVuayA9IGNodW5rOwoJICB0aGlzLmVuY29kaW5nID0gZW5jb2Rpbmc7CgkgIHRoaXMuY2FsbGJhY2sgPSBjYjsKCSAgdGhpcy5uZXh0ID0gbnVsbDsKCX0KCglmdW5jdGlvbiBXcml0YWJsZVN0YXRlKG9wdGlvbnMsIHN0cmVhbSkgewoJICBEdXBsZXggPSBEdXBsZXggfHwgX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7CgoJICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCgkgIC8vIG9iamVjdCBzdHJlYW0gZmxhZyB0byBpbmRpY2F0ZSB3aGV0aGVyIG9yIG5vdCB0aGlzIHN0cmVhbQoJICAvLyBjb250YWlucyBidWZmZXJzIG9yIG9iamVjdHMuCgkgIHRoaXMub2JqZWN0TW9kZSA9ICEhb3B0aW9ucy5vYmplY3RNb2RlOwoKCSAgaWYgKHN0cmVhbSBpbnN0YW5jZW9mIER1cGxleCkgdGhpcy5vYmplY3RNb2RlID0gdGhpcy5vYmplY3RNb2RlIHx8ICEhb3B0aW9ucy53cml0YWJsZU9iamVjdE1vZGU7CgoJICAvLyB0aGUgcG9pbnQgYXQgd2hpY2ggd3JpdGUoKSBzdGFydHMgcmV0dXJuaW5nIGZhbHNlCgkgIC8vIE5vdGU6IDAgaXMgYSB2YWxpZCB2YWx1ZSwgbWVhbnMgdGhhdCB3ZSBhbHdheXMgcmV0dXJuIGZhbHNlIGlmCgkgIC8vIHRoZSBlbnRpcmUgYnVmZmVyIGlzIG5vdCBmbHVzaGVkIGltbWVkaWF0ZWx5IG9uIHdyaXRlKCkKCSAgdmFyIGh3bSA9IG9wdGlvbnMuaGlnaFdhdGVyTWFyazsKCSAgdmFyIGRlZmF1bHRId20gPSB0aGlzLm9iamVjdE1vZGUgPyAxNiA6IDE2ICogMTAyNDsKCSAgdGhpcy5oaWdoV2F0ZXJNYXJrID0gaHdtIHx8IGh3bSA9PT0gMCA/IGh3bSA6IGRlZmF1bHRId207CgoJICAvLyBjYXN0IHRvIGludHMuCgkgIHRoaXMuaGlnaFdhdGVyTWFyayA9IH4gfnRoaXMuaGlnaFdhdGVyTWFyazsKCgkgIC8vIGRyYWluIGV2ZW50IGZsYWcuCgkgIHRoaXMubmVlZERyYWluID0gZmFsc2U7CgkgIC8vIGF0IHRoZSBzdGFydCBvZiBjYWxsaW5nIGVuZCgpCgkgIHRoaXMuZW5kaW5nID0gZmFsc2U7CgkgIC8vIHdoZW4gZW5kKCkgaGFzIGJlZW4gY2FsbGVkLCBhbmQgcmV0dXJuZWQKCSAgdGhpcy5lbmRlZCA9IGZhbHNlOwoJICAvLyB3aGVuICdmaW5pc2gnIGlzIGVtaXR0ZWQKCSAgdGhpcy5maW5pc2hlZCA9IGZhbHNlOwoKCSAgLy8gc2hvdWxkIHdlIGRlY29kZSBzdHJpbmdzIGludG8gYnVmZmVycyBiZWZvcmUgcGFzc2luZyB0byBfd3JpdGU/CgkgIC8vIHRoaXMgaXMgaGVyZSBzbyB0aGF0IHNvbWUgbm9kZS1jb3JlIHN0cmVhbXMgY2FuIG9wdGltaXplIHN0cmluZwoJICAvLyBoYW5kbGluZyBhdCBhIGxvd2VyIGxldmVsLgoJICB2YXIgbm9EZWNvZGUgPSBvcHRpb25zLmRlY29kZVN0cmluZ3MgPT09IGZhbHNlOwoJICB0aGlzLmRlY29kZVN0cmluZ3MgPSAhbm9EZWNvZGU7CgoJICAvLyBDcnlwdG8gaXMga2luZCBvZiBvbGQgYW5kIGNydXN0eS4gIEhpc3RvcmljYWxseSwgaXRzIGRlZmF1bHQgc3RyaW5nCgkgIC8vIGVuY29kaW5nIGlzICdiaW5hcnknIHNvIHdlIGhhdmUgdG8gbWFrZSB0aGlzIGNvbmZpZ3VyYWJsZS4KCSAgLy8gRXZlcnl0aGluZyBlbHNlIGluIHRoZSB1bml2ZXJzZSB1c2VzICd1dGY4JywgdGhvdWdoLgoJICB0aGlzLmRlZmF1bHRFbmNvZGluZyA9IG9wdGlvbnMuZGVmYXVsdEVuY29kaW5nIHx8ICd1dGY4JzsKCgkgIC8vIG5vdCBhbiBhY3R1YWwgYnVmZmVyIHdlIGtlZXAgdHJhY2sgb2YsIGJ1dCBhIG1lYXN1cmVtZW50CgkgIC8vIG9mIGhvdyBtdWNoIHdlJ3JlIHdhaXRpbmcgdG8gZ2V0IHB1c2hlZCB0byBzb21lIHVuZGVybHlpbmcKCSAgLy8gc29ja2V0IG9yIGZpbGUuCgkgIHRoaXMubGVuZ3RoID0gMDsKCgkgIC8vIGEgZmxhZyB0byBzZWUgd2hlbiB3ZSdyZSBpbiB0aGUgbWlkZGxlIG9mIGEgd3JpdGUuCgkgIHRoaXMud3JpdGluZyA9IGZhbHNlOwoKCSAgLy8gd2hlbiB0cnVlIGFsbCB3cml0ZXMgd2lsbCBiZSBidWZmZXJlZCB1bnRpbCAudW5jb3JrKCkgY2FsbAoJICB0aGlzLmNvcmtlZCA9IDA7CgoJICAvLyBhIGZsYWcgdG8gYmUgYWJsZSB0byB0ZWxsIGlmIHRoZSBvbndyaXRlIGNiIGlzIGNhbGxlZCBpbW1lZGlhdGVseSwKCSAgLy8gb3Igb24gYSBsYXRlciB0aWNrLiAgV2Ugc2V0IHRoaXMgdG8gdHJ1ZSBhdCBmaXJzdCwgYmVjYXVzZSBhbnkKCSAgLy8gYWN0aW9ucyB0aGF0IHNob3VsZG4ndCBoYXBwZW4gdW50aWwgImxhdGVyIiBzaG91bGQgZ2VuZXJhbGx5IGFsc28KCSAgLy8gbm90IGhhcHBlbiBiZWZvcmUgdGhlIGZpcnN0IHdyaXRlIGNhbGwuCgkgIHRoaXMuc3luYyA9IHRydWU7CgoJICAvLyBhIGZsYWcgdG8ga25vdyBpZiB3ZSdyZSBwcm9jZXNzaW5nIHByZXZpb3VzbHkgYnVmZmVyZWQgaXRlbXMsIHdoaWNoCgkgIC8vIG1heSBjYWxsIHRoZSBfd3JpdGUoKSBjYWxsYmFjayBpbiB0aGUgc2FtZSB0aWNrLCBzbyB0aGF0IHdlIGRvbid0CgkgIC8vIGVuZCB1cCBpbiBhbiBvdmVybGFwcGVkIG9ud3JpdGUgc2l0dWF0aW9uLgoJICB0aGlzLmJ1ZmZlclByb2Nlc3NpbmcgPSBmYWxzZTsKCgkgIC8vIHRoZSBjYWxsYmFjayB0aGF0J3MgcGFzc2VkIHRvIF93cml0ZShjaHVuayxjYikKCSAgdGhpcy5vbndyaXRlID0gZnVuY3Rpb24gKGVyKSB7CgkgICAgb253cml0ZShzdHJlYW0sIGVyKTsKCSAgfTsKCgkgIC8vIHRoZSBjYWxsYmFjayB0aGF0IHRoZSB1c2VyIHN1cHBsaWVzIHRvIHdyaXRlKGNodW5rLGVuY29kaW5nLGNiKQoJICB0aGlzLndyaXRlY2IgPSBudWxsOwoKCSAgLy8gdGhlIGFtb3VudCB0aGF0IGlzIGJlaW5nIHdyaXR0ZW4gd2hlbiBfd3JpdGUgaXMgY2FsbGVkLgoJICB0aGlzLndyaXRlbGVuID0gMDsKCgkgIHRoaXMuYnVmZmVyZWRSZXF1ZXN0ID0gbnVsbDsKCSAgdGhpcy5sYXN0QnVmZmVyZWRSZXF1ZXN0ID0gbnVsbDsKCgkgIC8vIG51bWJlciBvZiBwZW5kaW5nIHVzZXItc3VwcGxpZWQgd3JpdGUgY2FsbGJhY2tzCgkgIC8vIHRoaXMgbXVzdCBiZSAwIGJlZm9yZSAnZmluaXNoJyBjYW4gYmUgZW1pdHRlZAoJICB0aGlzLnBlbmRpbmdjYiA9IDA7CgoJICAvLyBlbWl0IHByZWZpbmlzaCBpZiB0aGUgb25seSB0aGluZyB3ZSdyZSB3YWl0aW5nIGZvciBpcyBfd3JpdGUgY2JzCgkgIC8vIFRoaXMgaXMgcmVsZXZhbnQgZm9yIHN5bmNocm9ub3VzIFRyYW5zZm9ybSBzdHJlYW1zCgkgIHRoaXMucHJlZmluaXNoZWQgPSBmYWxzZTsKCgkgIC8vIFRydWUgaWYgdGhlIGVycm9yIHdhcyBhbHJlYWR5IGVtaXR0ZWQgYW5kIHNob3VsZCBub3QgYmUgdGhyb3duIGFnYWluCgkgIHRoaXMuZXJyb3JFbWl0dGVkID0gZmFsc2U7CgoJICAvLyBjb3VudCBidWZmZXJlZCByZXF1ZXN0cwoJICB0aGlzLmJ1ZmZlcmVkUmVxdWVzdENvdW50ID0gMDsKCgkgIC8vIGFsbG9jYXRlIHRoZSBmaXJzdCBDb3JrZWRSZXF1ZXN0LCB0aGVyZSBpcyBhbHdheXMKCSAgLy8gb25lIGFsbG9jYXRlZCBhbmQgZnJlZSB0byB1c2UsIGFuZCB3ZSBtYWludGFpbiBhdCBtb3N0IHR3bwoJICB0aGlzLmNvcmtlZFJlcXVlc3RzRnJlZSA9IG5ldyBDb3JrZWRSZXF1ZXN0KHRoaXMpOwoJfQoKCVdyaXRhYmxlU3RhdGUucHJvdG90eXBlLmdldEJ1ZmZlciA9IGZ1bmN0aW9uIGdldEJ1ZmZlcigpIHsKCSAgdmFyIGN1cnJlbnQgPSB0aGlzLmJ1ZmZlcmVkUmVxdWVzdDsKCSAgdmFyIG91dCA9IFtdOwoJICB3aGlsZSAoY3VycmVudCkgewoJICAgIG91dC5wdXNoKGN1cnJlbnQpOwoJICAgIGN1cnJlbnQgPSBjdXJyZW50Lm5leHQ7CgkgIH0KCSAgcmV0dXJuIG91dDsKCX07CgoJKGZ1bmN0aW9uICgpIHsKCSAgdHJ5IHsKCSAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV3JpdGFibGVTdGF0ZS5wcm90b3R5cGUsICdidWZmZXInLCB7CgkgICAgICBnZXQ6IGludGVybmFsVXRpbC5kZXByZWNhdGUoZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5nZXRCdWZmZXIoKTsKCSAgICAgIH0sICdfd3JpdGFibGVTdGF0ZS5idWZmZXIgaXMgZGVwcmVjYXRlZC4gVXNlIF93cml0YWJsZVN0YXRlLmdldEJ1ZmZlciAnICsgJ2luc3RlYWQuJykKCSAgICB9KTsKCSAgfSBjYXRjaCAoXykge30KCX0pKCk7CgoJLy8gVGVzdCBfd3JpdGFibGVTdGF0ZSBmb3IgaW5oZXJpdGFuY2UgdG8gYWNjb3VudCBmb3IgRHVwbGV4IHN0cmVhbXMsCgkvLyB3aG9zZSBwcm90b3R5cGUgY2hhaW4gb25seSBwb2ludHMgdG8gUmVhZGFibGUuCgl2YXIgcmVhbEhhc0luc3RhbmNlOwoJaWYgKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgU3ltYm9sLmhhc0luc3RhbmNlICYmIHR5cGVvZiBGdW5jdGlvbi5wcm90b3R5cGVbU3ltYm9sLmhhc0luc3RhbmNlXSA9PT0gJ2Z1bmN0aW9uJykgewoJICByZWFsSGFzSW5zdGFuY2UgPSBGdW5jdGlvbi5wcm90b3R5cGVbU3ltYm9sLmhhc0luc3RhbmNlXTsKCSAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFdyaXRhYmxlLCBTeW1ib2wuaGFzSW5zdGFuY2UsIHsKCSAgICB2YWx1ZTogZnVuY3Rpb24gKG9iamVjdCkgewoJICAgICAgaWYgKHJlYWxIYXNJbnN0YW5jZS5jYWxsKHRoaXMsIG9iamVjdCkpIHJldHVybiB0cnVlOwoKCSAgICAgIHJldHVybiBvYmplY3QgJiYgb2JqZWN0Ll93cml0YWJsZVN0YXRlIGluc3RhbmNlb2YgV3JpdGFibGVTdGF0ZTsKCSAgICB9CgkgIH0pOwoJfSBlbHNlIHsKCSAgcmVhbEhhc0luc3RhbmNlID0gZnVuY3Rpb24gKG9iamVjdCkgewoJICAgIHJldHVybiBvYmplY3QgaW5zdGFuY2VvZiB0aGlzOwoJICB9OwoJfQoKCWZ1bmN0aW9uIFdyaXRhYmxlKG9wdGlvbnMpIHsKCSAgRHVwbGV4ID0gRHVwbGV4IHx8IF9fd2VicGFja19yZXF1aXJlX18oNDApOwoKCSAgLy8gV3JpdGFibGUgY3RvciBpcyBhcHBsaWVkIHRvIER1cGxleGVzLCB0b28uCgkgIC8vIGByZWFsSGFzSW5zdGFuY2VgIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHVzaW5nIHBsYWluIGBpbnN0YW5jZW9mYAoJICAvLyB3b3VsZCByZXR1cm4gZmFsc2UsIGFzIG5vIGBfd3JpdGFibGVTdGF0ZWAgcHJvcGVydHkgaXMgYXR0YWNoZWQuCgoJICAvLyBUcnlpbmcgdG8gdXNlIHRoZSBjdXN0b20gYGluc3RhbmNlb2ZgIGZvciBXcml0YWJsZSBoZXJlIHdpbGwgYWxzbyBicmVhayB0aGUKCSAgLy8gTm9kZS5qcyBMYXp5VHJhbnNmb3JtIGltcGxlbWVudGF0aW9uLCB3aGljaCBoYXMgYSBub24tdHJpdmlhbCBnZXR0ZXIgZm9yCgkgIC8vIGBfd3JpdGFibGVTdGF0ZWAgdGhhdCB3b3VsZCBsZWFkIHRvIGluZmluaXRlIHJlY3Vyc2lvbi4KCSAgaWYgKCFyZWFsSGFzSW5zdGFuY2UuY2FsbChXcml0YWJsZSwgdGhpcykgJiYgISh0aGlzIGluc3RhbmNlb2YgRHVwbGV4KSkgewoJICAgIHJldHVybiBuZXcgV3JpdGFibGUob3B0aW9ucyk7CgkgIH0KCgkgIHRoaXMuX3dyaXRhYmxlU3RhdGUgPSBuZXcgV3JpdGFibGVTdGF0ZShvcHRpb25zLCB0aGlzKTsKCgkgIC8vIGxlZ2FjeS4KCSAgdGhpcy53cml0YWJsZSA9IHRydWU7CgoJICBpZiAob3B0aW9ucykgewoJICAgIGlmICh0eXBlb2Ygb3B0aW9ucy53cml0ZSA9PT0gJ2Z1bmN0aW9uJykgdGhpcy5fd3JpdGUgPSBvcHRpb25zLndyaXRlOwoKCSAgICBpZiAodHlwZW9mIG9wdGlvbnMud3JpdGV2ID09PSAnZnVuY3Rpb24nKSB0aGlzLl93cml0ZXYgPSBvcHRpb25zLndyaXRldjsKCSAgfQoKCSAgU3RyZWFtLmNhbGwodGhpcyk7Cgl9CgoJLy8gT3RoZXJ3aXNlIHBlb3BsZSBjYW4gcGlwZSBXcml0YWJsZSBzdHJlYW1zLCB3aGljaCBpcyBqdXN0IHdyb25nLgoJV3JpdGFibGUucHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbiAoKSB7CgkgIHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ0Nhbm5vdCBwaXBlLCBub3QgcmVhZGFibGUnKSk7Cgl9OwoKCWZ1bmN0aW9uIHdyaXRlQWZ0ZXJFbmQoc3RyZWFtLCBjYikgewoJICB2YXIgZXIgPSBuZXcgRXJyb3IoJ3dyaXRlIGFmdGVyIGVuZCcpOwoJICAvLyBUT0RPOiBkZWZlciBlcnJvciBldmVudHMgY29uc2lzdGVudGx5IGV2ZXJ5d2hlcmUsIG5vdCBqdXN0IHRoZSBjYgoJICBzdHJlYW0uZW1pdCgnZXJyb3InLCBlcik7CgkgIHByb2Nlc3NOZXh0VGljayhjYiwgZXIpOwoJfQoKCS8vIElmIHdlIGdldCBzb21ldGhpbmcgdGhhdCBpcyBub3QgYSBidWZmZXIsIHN0cmluZywgbnVsbCwgb3IgdW5kZWZpbmVkLAoJLy8gYW5kIHdlJ3JlIG5vdCBpbiBvYmplY3RNb2RlLCB0aGVuIHRoYXQncyBhbiBlcnJvci4KCS8vIE90aGVyd2lzZSBzdHJlYW0gY2h1bmtzIGFyZSBhbGwgY29uc2lkZXJlZCB0byBiZSBvZiBsZW5ndGg9MSwgYW5kIHRoZQoJLy8gd2F0ZXJtYXJrcyBkZXRlcm1pbmUgaG93IG1hbnkgb2JqZWN0cyB0byBrZWVwIGluIHRoZSBidWZmZXIsIHJhdGhlciB0aGFuCgkvLyBob3cgbWFueSBieXRlcyBvciBjaGFyYWN0ZXJzLgoJZnVuY3Rpb24gdmFsaWRDaHVuayhzdHJlYW0sIHN0YXRlLCBjaHVuaywgY2IpIHsKCSAgdmFyIHZhbGlkID0gdHJ1ZTsKCSAgdmFyIGVyID0gZmFsc2U7CgkgIC8vIEFsd2F5cyB0aHJvdyBlcnJvciBpZiBhIG51bGwgaXMgd3JpdHRlbgoJICAvLyBpZiB3ZSBhcmUgbm90IGluIG9iamVjdCBtb2RlIHRoZW4gdGhyb3cKCSAgLy8gaWYgaXQgaXMgbm90IGEgYnVmZmVyLCBzdHJpbmcsIG9yIHVuZGVmaW5lZC4KCSAgaWYgKGNodW5rID09PSBudWxsKSB7CgkgICAgZXIgPSBuZXcgVHlwZUVycm9yKCdNYXkgbm90IHdyaXRlIG51bGwgdmFsdWVzIHRvIHN0cmVhbScpOwoJICB9IGVsc2UgaWYgKCFCdWZmZXIuaXNCdWZmZXIoY2h1bmspICYmIHR5cGVvZiBjaHVuayAhPT0gJ3N0cmluZycgJiYgY2h1bmsgIT09IHVuZGVmaW5lZCAmJiAhc3RhdGUub2JqZWN0TW9kZSkgewoJICAgIGVyID0gbmV3IFR5cGVFcnJvcignSW52YWxpZCBub24tc3RyaW5nL2J1ZmZlciBjaHVuaycpOwoJICB9CgkgIGlmIChlcikgewoJICAgIHN0cmVhbS5lbWl0KCdlcnJvcicsIGVyKTsKCSAgICBwcm9jZXNzTmV4dFRpY2soY2IsIGVyKTsKCSAgICB2YWxpZCA9IGZhbHNlOwoJICB9CgkgIHJldHVybiB2YWxpZDsKCX0KCglXcml0YWJsZS5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiAoY2h1bmssIGVuY29kaW5nLCBjYikgewoJICB2YXIgc3RhdGUgPSB0aGlzLl93cml0YWJsZVN0YXRlOwoJICB2YXIgcmV0ID0gZmFsc2U7CgoJICBpZiAodHlwZW9mIGVuY29kaW5nID09PSAnZnVuY3Rpb24nKSB7CgkgICAgY2IgPSBlbmNvZGluZzsKCSAgICBlbmNvZGluZyA9IG51bGw7CgkgIH0KCgkgIGlmIChCdWZmZXIuaXNCdWZmZXIoY2h1bmspKSBlbmNvZGluZyA9ICdidWZmZXInO2Vsc2UgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSBzdGF0ZS5kZWZhdWx0RW5jb2Rpbmc7CgoJICBpZiAodHlwZW9mIGNiICE9PSAnZnVuY3Rpb24nKSBjYiA9IG5vcDsKCgkgIGlmIChzdGF0ZS5lbmRlZCkgd3JpdGVBZnRlckVuZCh0aGlzLCBjYik7ZWxzZSBpZiAodmFsaWRDaHVuayh0aGlzLCBzdGF0ZSwgY2h1bmssIGNiKSkgewoJICAgIHN0YXRlLnBlbmRpbmdjYisrOwoJICAgIHJldCA9IHdyaXRlT3JCdWZmZXIodGhpcywgc3RhdGUsIGNodW5rLCBlbmNvZGluZywgY2IpOwoJICB9CgoJICByZXR1cm4gcmV0OwoJfTsKCglXcml0YWJsZS5wcm90b3R5cGUuY29yayA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fd3JpdGFibGVTdGF0ZTsKCgkgIHN0YXRlLmNvcmtlZCsrOwoJfTsKCglXcml0YWJsZS5wcm90b3R5cGUudW5jb3JrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgc3RhdGUgPSB0aGlzLl93cml0YWJsZVN0YXRlOwoKCSAgaWYgKHN0YXRlLmNvcmtlZCkgewoJICAgIHN0YXRlLmNvcmtlZC0tOwoKCSAgICBpZiAoIXN0YXRlLndyaXRpbmcgJiYgIXN0YXRlLmNvcmtlZCAmJiAhc3RhdGUuZmluaXNoZWQgJiYgIXN0YXRlLmJ1ZmZlclByb2Nlc3NpbmcgJiYgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0KSBjbGVhckJ1ZmZlcih0aGlzLCBzdGF0ZSk7CgkgIH0KCX07CgoJV3JpdGFibGUucHJvdG90eXBlLnNldERlZmF1bHRFbmNvZGluZyA9IGZ1bmN0aW9uIHNldERlZmF1bHRFbmNvZGluZyhlbmNvZGluZykgewoJICAvLyBub2RlOjpQYXJzZUVuY29kaW5nKCkgcmVxdWlyZXMgbG93ZXIgY2FzZS4KCSAgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycpIGVuY29kaW5nID0gZW5jb2RpbmcudG9Mb3dlckNhc2UoKTsKCSAgaWYgKCEoWydoZXgnLCAndXRmOCcsICd1dGYtOCcsICdhc2NpaScsICdiaW5hcnknLCAnYmFzZTY0JywgJ3VjczInLCAndWNzLTInLCAndXRmMTZsZScsICd1dGYtMTZsZScsICdyYXcnXS5pbmRleE9mKChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpKSA+IC0xKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKTsKCSAgdGhpcy5fd3JpdGFibGVTdGF0ZS5kZWZhdWx0RW5jb2RpbmcgPSBlbmNvZGluZzsKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCWZ1bmN0aW9uIGRlY29kZUNodW5rKHN0YXRlLCBjaHVuaywgZW5jb2RpbmcpIHsKCSAgaWYgKCFzdGF0ZS5vYmplY3RNb2RlICYmIHN0YXRlLmRlY29kZVN0cmluZ3MgIT09IGZhbHNlICYmIHR5cGVvZiBjaHVuayA9PT0gJ3N0cmluZycpIHsKCSAgICBjaHVuayA9IGJ1ZmZlclNoaW0uZnJvbShjaHVuaywgZW5jb2RpbmcpOwoJICB9CgkgIHJldHVybiBjaHVuazsKCX0KCgkvLyBpZiB3ZSdyZSBhbHJlYWR5IHdyaXRpbmcgc29tZXRoaW5nLCB0aGVuIGp1c3QgcHV0IHRoaXMKCS8vIGluIHRoZSBxdWV1ZSwgYW5kIHdhaXQgb3VyIHR1cm4uICBPdGhlcndpc2UsIGNhbGwgX3dyaXRlCgkvLyBJZiB3ZSByZXR1cm4gZmFsc2UsIHRoZW4gd2UgbmVlZCBhIGRyYWluIGV2ZW50LCBzbyBzZXQgdGhhdCBmbGFnLgoJZnVuY3Rpb24gd3JpdGVPckJ1ZmZlcihzdHJlYW0sIHN0YXRlLCBjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIGNodW5rID0gZGVjb2RlQ2h1bmsoc3RhdGUsIGNodW5rLCBlbmNvZGluZyk7CgoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKGNodW5rKSkgZW5jb2RpbmcgPSAnYnVmZmVyJzsKCSAgdmFyIGxlbiA9IHN0YXRlLm9iamVjdE1vZGUgPyAxIDogY2h1bmsubGVuZ3RoOwoKCSAgc3RhdGUubGVuZ3RoICs9IGxlbjsKCgkgIHZhciByZXQgPSBzdGF0ZS5sZW5ndGggPCBzdGF0ZS5oaWdoV2F0ZXJNYXJrOwoJICAvLyB3ZSBtdXN0IGVuc3VyZSB0aGF0IHByZXZpb3VzIG5lZWREcmFpbiB3aWxsIG5vdCBiZSByZXNldCB0byBmYWxzZS4KCSAgaWYgKCFyZXQpIHN0YXRlLm5lZWREcmFpbiA9IHRydWU7CgoJICBpZiAoc3RhdGUud3JpdGluZyB8fCBzdGF0ZS5jb3JrZWQpIHsKCSAgICB2YXIgbGFzdCA9IHN0YXRlLmxhc3RCdWZmZXJlZFJlcXVlc3Q7CgkgICAgc3RhdGUubGFzdEJ1ZmZlcmVkUmVxdWVzdCA9IG5ldyBXcml0ZVJlcShjaHVuaywgZW5jb2RpbmcsIGNiKTsKCSAgICBpZiAobGFzdCkgewoJICAgICAgbGFzdC5uZXh0ID0gc3RhdGUubGFzdEJ1ZmZlcmVkUmVxdWVzdDsKCSAgICB9IGVsc2UgewoJICAgICAgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0ID0gc3RhdGUubGFzdEJ1ZmZlcmVkUmVxdWVzdDsKCSAgICB9CgkgICAgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0Q291bnQgKz0gMTsKCSAgfSBlbHNlIHsKCSAgICBkb1dyaXRlKHN0cmVhbSwgc3RhdGUsIGZhbHNlLCBsZW4sIGNodW5rLCBlbmNvZGluZywgY2IpOwoJICB9CgoJICByZXR1cm4gcmV0OwoJfQoKCWZ1bmN0aW9uIGRvV3JpdGUoc3RyZWFtLCBzdGF0ZSwgd3JpdGV2LCBsZW4sIGNodW5rLCBlbmNvZGluZywgY2IpIHsKCSAgc3RhdGUud3JpdGVsZW4gPSBsZW47CgkgIHN0YXRlLndyaXRlY2IgPSBjYjsKCSAgc3RhdGUud3JpdGluZyA9IHRydWU7CgkgIHN0YXRlLnN5bmMgPSB0cnVlOwoJICBpZiAod3JpdGV2KSBzdHJlYW0uX3dyaXRldihjaHVuaywgc3RhdGUub253cml0ZSk7ZWxzZSBzdHJlYW0uX3dyaXRlKGNodW5rLCBlbmNvZGluZywgc3RhdGUub253cml0ZSk7CgkgIHN0YXRlLnN5bmMgPSBmYWxzZTsKCX0KCglmdW5jdGlvbiBvbndyaXRlRXJyb3Ioc3RyZWFtLCBzdGF0ZSwgc3luYywgZXIsIGNiKSB7CgkgIC0tc3RhdGUucGVuZGluZ2NiOwoJICBpZiAoc3luYykgcHJvY2Vzc05leHRUaWNrKGNiLCBlcik7ZWxzZSBjYihlcik7CgoJICBzdHJlYW0uX3dyaXRhYmxlU3RhdGUuZXJyb3JFbWl0dGVkID0gdHJ1ZTsKCSAgc3RyZWFtLmVtaXQoJ2Vycm9yJywgZXIpOwoJfQoKCWZ1bmN0aW9uIG9ud3JpdGVTdGF0ZVVwZGF0ZShzdGF0ZSkgewoJICBzdGF0ZS53cml0aW5nID0gZmFsc2U7CgkgIHN0YXRlLndyaXRlY2IgPSBudWxsOwoJICBzdGF0ZS5sZW5ndGggLT0gc3RhdGUud3JpdGVsZW47CgkgIHN0YXRlLndyaXRlbGVuID0gMDsKCX0KCglmdW5jdGlvbiBvbndyaXRlKHN0cmVhbSwgZXIpIHsKCSAgdmFyIHN0YXRlID0gc3RyZWFtLl93cml0YWJsZVN0YXRlOwoJICB2YXIgc3luYyA9IHN0YXRlLnN5bmM7CgkgIHZhciBjYiA9IHN0YXRlLndyaXRlY2I7CgoJICBvbndyaXRlU3RhdGVVcGRhdGUoc3RhdGUpOwoKCSAgaWYgKGVyKSBvbndyaXRlRXJyb3Ioc3RyZWFtLCBzdGF0ZSwgc3luYywgZXIsIGNiKTtlbHNlIHsKCSAgICAvLyBDaGVjayBpZiB3ZSdyZSBhY3R1YWxseSByZWFkeSB0byBmaW5pc2gsIGJ1dCBkb24ndCBlbWl0IHlldAoJICAgIHZhciBmaW5pc2hlZCA9IG5lZWRGaW5pc2goc3RhdGUpOwoKCSAgICBpZiAoIWZpbmlzaGVkICYmICFzdGF0ZS5jb3JrZWQgJiYgIXN0YXRlLmJ1ZmZlclByb2Nlc3NpbmcgJiYgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0KSB7CgkgICAgICBjbGVhckJ1ZmZlcihzdHJlYW0sIHN0YXRlKTsKCSAgICB9CgoJICAgIGlmIChzeW5jKSB7CgkgICAgICAvKjxyZXBsYWNlbWVudD4qLwoJICAgICAgYXN5bmNXcml0ZShhZnRlcldyaXRlLCBzdHJlYW0sIHN0YXRlLCBmaW5pc2hlZCwgY2IpOwoJICAgICAgLyo8L3JlcGxhY2VtZW50PiovCgkgICAgfSBlbHNlIHsKCSAgICAgICAgYWZ0ZXJXcml0ZShzdHJlYW0sIHN0YXRlLCBmaW5pc2hlZCwgY2IpOwoJICAgICAgfQoJICB9Cgl9CgoJZnVuY3Rpb24gYWZ0ZXJXcml0ZShzdHJlYW0sIHN0YXRlLCBmaW5pc2hlZCwgY2IpIHsKCSAgaWYgKCFmaW5pc2hlZCkgb253cml0ZURyYWluKHN0cmVhbSwgc3RhdGUpOwoJICBzdGF0ZS5wZW5kaW5nY2ItLTsKCSAgY2IoKTsKCSAgZmluaXNoTWF5YmUoc3RyZWFtLCBzdGF0ZSk7Cgl9CgoJLy8gTXVzdCBmb3JjZSBjYWxsYmFjayB0byBiZSBjYWxsZWQgb24gbmV4dFRpY2ssIHNvIHRoYXQgd2UgZG9uJ3QKCS8vIGVtaXQgJ2RyYWluJyBiZWZvcmUgdGhlIHdyaXRlKCkgY29uc3VtZXIgZ2V0cyB0aGUgJ2ZhbHNlJyByZXR1cm4KCS8vIHZhbHVlLCBhbmQgaGFzIGEgY2hhbmNlIHRvIGF0dGFjaCBhICdkcmFpbicgbGlzdGVuZXIuCglmdW5jdGlvbiBvbndyaXRlRHJhaW4oc3RyZWFtLCBzdGF0ZSkgewoJICBpZiAoc3RhdGUubGVuZ3RoID09PSAwICYmIHN0YXRlLm5lZWREcmFpbikgewoJICAgIHN0YXRlLm5lZWREcmFpbiA9IGZhbHNlOwoJICAgIHN0cmVhbS5lbWl0KCdkcmFpbicpOwoJICB9Cgl9CgoJLy8gaWYgdGhlcmUncyBzb21ldGhpbmcgaW4gdGhlIGJ1ZmZlciB3YWl0aW5nLCB0aGVuIHByb2Nlc3MgaXQKCWZ1bmN0aW9uIGNsZWFyQnVmZmVyKHN0cmVhbSwgc3RhdGUpIHsKCSAgc3RhdGUuYnVmZmVyUHJvY2Vzc2luZyA9IHRydWU7CgkgIHZhciBlbnRyeSA9IHN0YXRlLmJ1ZmZlcmVkUmVxdWVzdDsKCgkgIGlmIChzdHJlYW0uX3dyaXRldiAmJiBlbnRyeSAmJiBlbnRyeS5uZXh0KSB7CgkgICAgLy8gRmFzdCBjYXNlLCB3cml0ZSBldmVyeXRoaW5nIHVzaW5nIF93cml0ZXYoKQoJICAgIHZhciBsID0gc3RhdGUuYnVmZmVyZWRSZXF1ZXN0Q291bnQ7CgkgICAgdmFyIGJ1ZmZlciA9IG5ldyBBcnJheShsKTsKCSAgICB2YXIgaG9sZGVyID0gc3RhdGUuY29ya2VkUmVxdWVzdHNGcmVlOwoJICAgIGhvbGRlci5lbnRyeSA9IGVudHJ5OwoKCSAgICB2YXIgY291bnQgPSAwOwoJICAgIHdoaWxlIChlbnRyeSkgewoJICAgICAgYnVmZmVyW2NvdW50XSA9IGVudHJ5OwoJICAgICAgZW50cnkgPSBlbnRyeS5uZXh0OwoJICAgICAgY291bnQgKz0gMTsKCSAgICB9CgoJICAgIGRvV3JpdGUoc3RyZWFtLCBzdGF0ZSwgdHJ1ZSwgc3RhdGUubGVuZ3RoLCBidWZmZXIsICcnLCBob2xkZXIuZmluaXNoKTsKCgkgICAgLy8gZG9Xcml0ZSBpcyBhbG1vc3QgYWx3YXlzIGFzeW5jLCBkZWZlciB0aGVzZSB0byBzYXZlIGEgYml0IG9mIHRpbWUKCSAgICAvLyBhcyB0aGUgaG90IHBhdGggZW5kcyB3aXRoIGRvV3JpdGUKCSAgICBzdGF0ZS5wZW5kaW5nY2IrKzsKCSAgICBzdGF0ZS5sYXN0QnVmZmVyZWRSZXF1ZXN0ID0gbnVsbDsKCSAgICBpZiAoaG9sZGVyLm5leHQpIHsKCSAgICAgIHN0YXRlLmNvcmtlZFJlcXVlc3RzRnJlZSA9IGhvbGRlci5uZXh0OwoJICAgICAgaG9sZGVyLm5leHQgPSBudWxsOwoJICAgIH0gZWxzZSB7CgkgICAgICBzdGF0ZS5jb3JrZWRSZXF1ZXN0c0ZyZWUgPSBuZXcgQ29ya2VkUmVxdWVzdChzdGF0ZSk7CgkgICAgfQoJICB9IGVsc2UgewoJICAgIC8vIFNsb3cgY2FzZSwgd3JpdGUgY2h1bmtzIG9uZS1ieS1vbmUKCSAgICB3aGlsZSAoZW50cnkpIHsKCSAgICAgIHZhciBjaHVuayA9IGVudHJ5LmNodW5rOwoJICAgICAgdmFyIGVuY29kaW5nID0gZW50cnkuZW5jb2Rpbmc7CgkgICAgICB2YXIgY2IgPSBlbnRyeS5jYWxsYmFjazsKCSAgICAgIHZhciBsZW4gPSBzdGF0ZS5vYmplY3RNb2RlID8gMSA6IGNodW5rLmxlbmd0aDsKCgkgICAgICBkb1dyaXRlKHN0cmVhbSwgc3RhdGUsIGZhbHNlLCBsZW4sIGNodW5rLCBlbmNvZGluZywgY2IpOwoJICAgICAgZW50cnkgPSBlbnRyeS5uZXh0OwoJICAgICAgLy8gaWYgd2UgZGlkbid0IGNhbGwgdGhlIG9ud3JpdGUgaW1tZWRpYXRlbHksIHRoZW4KCSAgICAgIC8vIGl0IG1lYW5zIHRoYXQgd2UgbmVlZCB0byB3YWl0IHVudGlsIGl0IGRvZXMuCgkgICAgICAvLyBhbHNvLCB0aGF0IG1lYW5zIHRoYXQgdGhlIGNodW5rIGFuZCBjYiBhcmUgY3VycmVudGx5CgkgICAgICAvLyBiZWluZyBwcm9jZXNzZWQsIHNvIG1vdmUgdGhlIGJ1ZmZlciBjb3VudGVyIHBhc3QgdGhlbS4KCSAgICAgIGlmIChzdGF0ZS53cml0aW5nKSB7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgIH0KCgkgICAgaWYgKGVudHJ5ID09PSBudWxsKSBzdGF0ZS5sYXN0QnVmZmVyZWRSZXF1ZXN0ID0gbnVsbDsKCSAgfQoKCSAgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0Q291bnQgPSAwOwoJICBzdGF0ZS5idWZmZXJlZFJlcXVlc3QgPSBlbnRyeTsKCSAgc3RhdGUuYnVmZmVyUHJvY2Vzc2luZyA9IGZhbHNlOwoJfQoKCVdyaXRhYmxlLnByb3RvdHlwZS5fd3JpdGUgPSBmdW5jdGlvbiAoY2h1bmssIGVuY29kaW5nLCBjYikgewoJICBjYihuZXcgRXJyb3IoJ193cml0ZSgpIGlzIG5vdCBpbXBsZW1lbnRlZCcpKTsKCX07CgoJV3JpdGFibGUucHJvdG90eXBlLl93cml0ZXYgPSBudWxsOwoKCVdyaXRhYmxlLnByb3RvdHlwZS5lbmQgPSBmdW5jdGlvbiAoY2h1bmssIGVuY29kaW5nLCBjYikgewoJICB2YXIgc3RhdGUgPSB0aGlzLl93cml0YWJsZVN0YXRlOwoKCSAgaWYgKHR5cGVvZiBjaHVuayA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIGNiID0gY2h1bms7CgkgICAgY2h1bmsgPSBudWxsOwoJICAgIGVuY29kaW5nID0gbnVsbDsKCSAgfSBlbHNlIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdmdW5jdGlvbicpIHsKCSAgICBjYiA9IGVuY29kaW5nOwoJICAgIGVuY29kaW5nID0gbnVsbDsKCSAgfQoKCSAgaWYgKGNodW5rICE9PSBudWxsICYmIGNodW5rICE9PSB1bmRlZmluZWQpIHRoaXMud3JpdGUoY2h1bmssIGVuY29kaW5nKTsKCgkgIC8vIC5lbmQoKSBmdWxseSB1bmNvcmtzCgkgIGlmIChzdGF0ZS5jb3JrZWQpIHsKCSAgICBzdGF0ZS5jb3JrZWQgPSAxOwoJICAgIHRoaXMudW5jb3JrKCk7CgkgIH0KCgkgIC8vIGlnbm9yZSB1bm5lY2Vzc2FyeSBlbmQoKSBjYWxscy4KCSAgaWYgKCFzdGF0ZS5lbmRpbmcgJiYgIXN0YXRlLmZpbmlzaGVkKSBlbmRXcml0YWJsZSh0aGlzLCBzdGF0ZSwgY2IpOwoJfTsKCglmdW5jdGlvbiBuZWVkRmluaXNoKHN0YXRlKSB7CgkgIHJldHVybiBzdGF0ZS5lbmRpbmcgJiYgc3RhdGUubGVuZ3RoID09PSAwICYmIHN0YXRlLmJ1ZmZlcmVkUmVxdWVzdCA9PT0gbnVsbCAmJiAhc3RhdGUuZmluaXNoZWQgJiYgIXN0YXRlLndyaXRpbmc7Cgl9CgoJZnVuY3Rpb24gcHJlZmluaXNoKHN0cmVhbSwgc3RhdGUpIHsKCSAgaWYgKCFzdGF0ZS5wcmVmaW5pc2hlZCkgewoJICAgIHN0YXRlLnByZWZpbmlzaGVkID0gdHJ1ZTsKCSAgICBzdHJlYW0uZW1pdCgncHJlZmluaXNoJyk7CgkgIH0KCX0KCglmdW5jdGlvbiBmaW5pc2hNYXliZShzdHJlYW0sIHN0YXRlKSB7CgkgIHZhciBuZWVkID0gbmVlZEZpbmlzaChzdGF0ZSk7CgkgIGlmIChuZWVkKSB7CgkgICAgaWYgKHN0YXRlLnBlbmRpbmdjYiA9PT0gMCkgewoJICAgICAgcHJlZmluaXNoKHN0cmVhbSwgc3RhdGUpOwoJICAgICAgc3RhdGUuZmluaXNoZWQgPSB0cnVlOwoJICAgICAgc3RyZWFtLmVtaXQoJ2ZpbmlzaCcpOwoJICAgIH0gZWxzZSB7CgkgICAgICBwcmVmaW5pc2goc3RyZWFtLCBzdGF0ZSk7CgkgICAgfQoJICB9CgkgIHJldHVybiBuZWVkOwoJfQoKCWZ1bmN0aW9uIGVuZFdyaXRhYmxlKHN0cmVhbSwgc3RhdGUsIGNiKSB7CgkgIHN0YXRlLmVuZGluZyA9IHRydWU7CgkgIGZpbmlzaE1heWJlKHN0cmVhbSwgc3RhdGUpOwoJICBpZiAoY2IpIHsKCSAgICBpZiAoc3RhdGUuZmluaXNoZWQpIHByb2Nlc3NOZXh0VGljayhjYik7ZWxzZSBzdHJlYW0ub25jZSgnZmluaXNoJywgY2IpOwoJICB9CgkgIHN0YXRlLmVuZGVkID0gdHJ1ZTsKCSAgc3RyZWFtLndyaXRhYmxlID0gZmFsc2U7Cgl9CgoJLy8gSXQgc2VlbXMgYSBsaW5rZWQgbGlzdCBidXQgaXQgaXMgbm90CgkvLyB0aGVyZSB3aWxsIGJlIG9ubHkgMiBvZiB0aGVzZSBmb3IgZWFjaCBzdHJlYW0KCWZ1bmN0aW9uIENvcmtlZFJlcXVlc3Qoc3RhdGUpIHsKCSAgdmFyIF90aGlzID0gdGhpczsKCgkgIHRoaXMubmV4dCA9IG51bGw7CgkgIHRoaXMuZW50cnkgPSBudWxsOwoKCSAgdGhpcy5maW5pc2ggPSBmdW5jdGlvbiAoZXJyKSB7CgkgICAgdmFyIGVudHJ5ID0gX3RoaXMuZW50cnk7CgkgICAgX3RoaXMuZW50cnkgPSBudWxsOwoJICAgIHdoaWxlIChlbnRyeSkgewoJICAgICAgdmFyIGNiID0gZW50cnkuY2FsbGJhY2s7CgkgICAgICBzdGF0ZS5wZW5kaW5nY2ItLTsKCSAgICAgIGNiKGVycik7CgkgICAgICBlbnRyeSA9IGVudHJ5Lm5leHQ7CgkgICAgfQoJICAgIGlmIChzdGF0ZS5jb3JrZWRSZXF1ZXN0c0ZyZWUpIHsKCSAgICAgIHN0YXRlLmNvcmtlZFJlcXVlc3RzRnJlZS5uZXh0ID0gX3RoaXM7CgkgICAgfSBlbHNlIHsKCSAgICAgIHN0YXRlLmNvcmtlZFJlcXVlc3RzRnJlZSA9IF90aGlzOwoJICAgIH0KCSAgfTsKCX0KCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KSwgX193ZWJwYWNrX3JlcXVpcmVfXyg0Mikuc2V0SW1tZWRpYXRlKSkKCi8qKiovIH0sCi8qIDQyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBhcHBseSA9IEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseTsKCgkvLyBET00gQVBJcywgZm9yIGNvbXBsZXRlbmVzcwoKCWV4cG9ydHMuc2V0VGltZW91dCA9IGZ1bmN0aW9uKCkgewoJICByZXR1cm4gbmV3IFRpbWVvdXQoYXBwbHkuY2FsbChzZXRUaW1lb3V0LCB3aW5kb3csIGFyZ3VtZW50cyksIGNsZWFyVGltZW91dCk7Cgl9OwoJZXhwb3J0cy5zZXRJbnRlcnZhbCA9IGZ1bmN0aW9uKCkgewoJICByZXR1cm4gbmV3IFRpbWVvdXQoYXBwbHkuY2FsbChzZXRJbnRlcnZhbCwgd2luZG93LCBhcmd1bWVudHMpLCBjbGVhckludGVydmFsKTsKCX07CglleHBvcnRzLmNsZWFyVGltZW91dCA9CglleHBvcnRzLmNsZWFySW50ZXJ2YWwgPSBmdW5jdGlvbih0aW1lb3V0KSB7CgkgIGlmICh0aW1lb3V0KSB7CgkgICAgdGltZW91dC5jbG9zZSgpOwoJICB9Cgl9OwoKCWZ1bmN0aW9uIFRpbWVvdXQoaWQsIGNsZWFyRm4pIHsKCSAgdGhpcy5faWQgPSBpZDsKCSAgdGhpcy5fY2xlYXJGbiA9IGNsZWFyRm47Cgl9CglUaW1lb3V0LnByb3RvdHlwZS51bnJlZiA9IFRpbWVvdXQucHJvdG90eXBlLnJlZiA9IGZ1bmN0aW9uKCkge307CglUaW1lb3V0LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkgewoJICB0aGlzLl9jbGVhckZuLmNhbGwod2luZG93LCB0aGlzLl9pZCk7Cgl9OwoKCS8vIERvZXMgbm90IHN0YXJ0IHRoZSB0aW1lLCBqdXN0IHNldHMgdXAgdGhlIG1lbWJlcnMgbmVlZGVkLgoJZXhwb3J0cy5lbnJvbGwgPSBmdW5jdGlvbihpdGVtLCBtc2VjcykgewoJICBjbGVhclRpbWVvdXQoaXRlbS5faWRsZVRpbWVvdXRJZCk7CgkgIGl0ZW0uX2lkbGVUaW1lb3V0ID0gbXNlY3M7Cgl9OwoKCWV4cG9ydHMudW5lbnJvbGwgPSBmdW5jdGlvbihpdGVtKSB7CgkgIGNsZWFyVGltZW91dChpdGVtLl9pZGxlVGltZW91dElkKTsKCSAgaXRlbS5faWRsZVRpbWVvdXQgPSAtMTsKCX07CgoJZXhwb3J0cy5fdW5yZWZBY3RpdmUgPSBleHBvcnRzLmFjdGl2ZSA9IGZ1bmN0aW9uKGl0ZW0pIHsKCSAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpOwoKCSAgdmFyIG1zZWNzID0gaXRlbS5faWRsZVRpbWVvdXQ7CgkgIGlmIChtc2VjcyA+PSAwKSB7CgkgICAgaXRlbS5faWRsZVRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gb25UaW1lb3V0KCkgewoJICAgICAgaWYgKGl0ZW0uX29uVGltZW91dCkKCSAgICAgICAgaXRlbS5fb25UaW1lb3V0KCk7CgkgICAgfSwgbXNlY3MpOwoJICB9Cgl9OwoKCS8vIHNldGltbWVkaWF0ZSBhdHRhY2hlcyBpdHNlbGYgdG8gdGhlIGdsb2JhbCBvYmplY3QKCV9fd2VicGFja19yZXF1aXJlX18oNDMpOwoJZXhwb3J0cy5zZXRJbW1lZGlhdGUgPSBzZXRJbW1lZGlhdGU7CglleHBvcnRzLmNsZWFySW1tZWRpYXRlID0gY2xlYXJJbW1lZGlhdGU7CgoKLyoqKi8gfSwKLyogNDMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCwgcHJvY2VzcykgeyhmdW5jdGlvbiAoZ2xvYmFsLCB1bmRlZmluZWQpIHsKCSAgICAidXNlIHN0cmljdCI7CgoJICAgIGlmIChnbG9iYWwuc2V0SW1tZWRpYXRlKSB7CgkgICAgICAgIHJldHVybjsKCSAgICB9CgoJICAgIHZhciBuZXh0SGFuZGxlID0gMTsgLy8gU3BlYyBzYXlzIGdyZWF0ZXIgdGhhbiB6ZXJvCgkgICAgdmFyIHRhc2tzQnlIYW5kbGUgPSB7fTsKCSAgICB2YXIgY3VycmVudGx5UnVubmluZ0FUYXNrID0gZmFsc2U7CgkgICAgdmFyIGRvYyA9IGdsb2JhbC5kb2N1bWVudDsKCSAgICB2YXIgcmVnaXN0ZXJJbW1lZGlhdGU7CgoJICAgIGZ1bmN0aW9uIHNldEltbWVkaWF0ZShjYWxsYmFjaykgewoJICAgICAgLy8gQ2FsbGJhY2sgY2FuIGVpdGhlciBiZSBhIGZ1bmN0aW9uIG9yIGEgc3RyaW5nCgkgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSAiZnVuY3Rpb24iKSB7CgkgICAgICAgIGNhbGxiYWNrID0gbmV3IEZ1bmN0aW9uKCIiICsgY2FsbGJhY2spOwoJICAgICAgfQoJICAgICAgLy8gQ29weSBmdW5jdGlvbiBhcmd1bWVudHMKCSAgICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTsKCSAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykgewoJICAgICAgICAgIGFyZ3NbaV0gPSBhcmd1bWVudHNbaSArIDFdOwoJICAgICAgfQoJICAgICAgLy8gU3RvcmUgYW5kIHJlZ2lzdGVyIHRoZSB0YXNrCgkgICAgICB2YXIgdGFzayA9IHsgY2FsbGJhY2s6IGNhbGxiYWNrLCBhcmdzOiBhcmdzIH07CgkgICAgICB0YXNrc0J5SGFuZGxlW25leHRIYW5kbGVdID0gdGFzazsKCSAgICAgIHJlZ2lzdGVySW1tZWRpYXRlKG5leHRIYW5kbGUpOwoJICAgICAgcmV0dXJuIG5leHRIYW5kbGUrKzsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGNsZWFySW1tZWRpYXRlKGhhbmRsZSkgewoJICAgICAgICBkZWxldGUgdGFza3NCeUhhbmRsZVtoYW5kbGVdOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gcnVuKHRhc2spIHsKCSAgICAgICAgdmFyIGNhbGxiYWNrID0gdGFzay5jYWxsYmFjazsKCSAgICAgICAgdmFyIGFyZ3MgPSB0YXNrLmFyZ3M7CgkgICAgICAgIHN3aXRjaCAoYXJncy5sZW5ndGgpIHsKCSAgICAgICAgY2FzZSAwOgoJICAgICAgICAgICAgY2FsbGJhY2soKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBjYXNlIDE6CgkgICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBjYXNlIDI6CgkgICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBjYXNlIDM6CgkgICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodW5kZWZpbmVkLCBhcmdzKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBmdW5jdGlvbiBydW5JZlByZXNlbnQoaGFuZGxlKSB7CgkgICAgICAgIC8vIEZyb20gdGhlIHNwZWM6ICJXYWl0IHVudGlsIGFueSBpbnZvY2F0aW9ucyBvZiB0aGlzIGFsZ29yaXRobSBzdGFydGVkIGJlZm9yZSB0aGlzIG9uZSBoYXZlIGNvbXBsZXRlZC4iCgkgICAgICAgIC8vIFNvIGlmIHdlJ3JlIGN1cnJlbnRseSBydW5uaW5nIGEgdGFzaywgd2UnbGwgbmVlZCB0byBkZWxheSB0aGlzIGludm9jYXRpb24uCgkgICAgICAgIGlmIChjdXJyZW50bHlSdW5uaW5nQVRhc2spIHsKCSAgICAgICAgICAgIC8vIERlbGF5IGJ5IGRvaW5nIGEgc2V0VGltZW91dC4gc2V0SW1tZWRpYXRlIHdhcyB0cmllZCBpbnN0ZWFkLCBidXQgaW4gRmlyZWZveCA3IGl0IGdlbmVyYXRlZCBhCgkgICAgICAgICAgICAvLyAidG9vIG11Y2ggcmVjdXJzaW9uIiBlcnJvci4KCSAgICAgICAgICAgIHNldFRpbWVvdXQocnVuSWZQcmVzZW50LCAwLCBoYW5kbGUpOwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgdmFyIHRhc2sgPSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07CgkgICAgICAgICAgICBpZiAodGFzaykgewoJICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IHRydWU7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgcnVuKHRhc2spOwoJICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CgkgICAgICAgICAgICAgICAgICAgIGNsZWFySW1tZWRpYXRlKGhhbmRsZSk7CgkgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCgkgICAgZnVuY3Rpb24gaW5zdGFsbE5leHRUaWNrSW1wbGVtZW50YXRpb24oKSB7CgkgICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7CgkgICAgICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsgcnVuSWZQcmVzZW50KGhhbmRsZSk7IH0pOwoJICAgICAgICB9OwoJICAgIH0KCgkgICAgZnVuY3Rpb24gY2FuVXNlUG9zdE1lc3NhZ2UoKSB7CgkgICAgICAgIC8vIFRoZSB0ZXN0IGFnYWluc3QgYGltcG9ydFNjcmlwdHNgIHByZXZlbnRzIHRoaXMgaW1wbGVtZW50YXRpb24gZnJvbSBiZWluZyBpbnN0YWxsZWQgaW5zaWRlIGEgd2ViIHdvcmtlciwKCSAgICAgICAgLy8gd2hlcmUgYGdsb2JhbC5wb3N0TWVzc2FnZWAgbWVhbnMgc29tZXRoaW5nIGNvbXBsZXRlbHkgZGlmZmVyZW50IGFuZCBjYW4ndCBiZSB1c2VkIGZvciB0aGlzIHB1cnBvc2UuCgkgICAgICAgIGlmIChnbG9iYWwucG9zdE1lc3NhZ2UgJiYgIWdsb2JhbC5pbXBvcnRTY3JpcHRzKSB7CgkgICAgICAgICAgICB2YXIgcG9zdE1lc3NhZ2VJc0FzeW5jaHJvbm91cyA9IHRydWU7CgkgICAgICAgICAgICB2YXIgb2xkT25NZXNzYWdlID0gZ2xvYmFsLm9ubWVzc2FnZTsKCSAgICAgICAgICAgIGdsb2JhbC5vbm1lc3NhZ2UgPSBmdW5jdGlvbigpIHsKCSAgICAgICAgICAgICAgICBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzID0gZmFsc2U7CgkgICAgICAgICAgICB9OwoJICAgICAgICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKCIiLCAiKiIpOwoJICAgICAgICAgICAgZ2xvYmFsLm9ubWVzc2FnZSA9IG9sZE9uTWVzc2FnZTsKCSAgICAgICAgICAgIHJldHVybiBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBmdW5jdGlvbiBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpIHsKCSAgICAgICAgLy8gSW5zdGFsbHMgYW4gZXZlbnQgaGFuZGxlciBvbiBgZ2xvYmFsYCBmb3IgdGhlIGBtZXNzYWdlYCBldmVudDogc2VlCgkgICAgICAgIC8vICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vRE9NL3dpbmRvdy5wb3N0TWVzc2FnZQoJICAgICAgICAvLyAqIGh0dHA6Ly93d3cud2hhdHdnLm9yZy9zcGVjcy93ZWItYXBwcy9jdXJyZW50LXdvcmsvbXVsdGlwYWdlL2NvbW1zLmh0bWwjY3Jvc3NEb2N1bWVudE1lc3NhZ2VzCgoJICAgICAgICB2YXIgbWVzc2FnZVByZWZpeCA9ICJzZXRJbW1lZGlhdGUkIiArIE1hdGgucmFuZG9tKCkgKyAiJCI7CgkgICAgICAgIHZhciBvbkdsb2JhbE1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkgewoJICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gZ2xvYmFsICYmCgkgICAgICAgICAgICAgICAgdHlwZW9mIGV2ZW50LmRhdGEgPT09ICJzdHJpbmciICYmCgkgICAgICAgICAgICAgICAgZXZlbnQuZGF0YS5pbmRleE9mKG1lc3NhZ2VQcmVmaXgpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcnVuSWZQcmVzZW50KCtldmVudC5kYXRhLnNsaWNlKG1lc3NhZ2VQcmVmaXgubGVuZ3RoKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH07CgoJICAgICAgICBpZiAoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIpIHsKCSAgICAgICAgICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgb25HbG9iYWxNZXNzYWdlLCBmYWxzZSk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBnbG9iYWwuYXR0YWNoRXZlbnQoIm9ubWVzc2FnZSIsIG9uR2xvYmFsTWVzc2FnZSk7CgkgICAgICAgIH0KCgkgICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7CgkgICAgICAgICAgICBnbG9iYWwucG9zdE1lc3NhZ2UobWVzc2FnZVByZWZpeCArIGhhbmRsZSwgIioiKTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGluc3RhbGxNZXNzYWdlQ2hhbm5lbEltcGxlbWVudGF0aW9uKCkgewoJICAgICAgICB2YXIgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpOwoJICAgICAgICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkgICAgICAgICAgICB2YXIgaGFuZGxlID0gZXZlbnQuZGF0YTsKCSAgICAgICAgICAgIHJ1bklmUHJlc2VudChoYW5kbGUpOwoJICAgICAgICB9OwoKCSAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHsKCSAgICAgICAgICAgIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoaGFuZGxlKTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGluc3RhbGxSZWFkeVN0YXRlQ2hhbmdlSW1wbGVtZW50YXRpb24oKSB7CgkgICAgICAgIHZhciBodG1sID0gZG9jLmRvY3VtZW50RWxlbWVudDsKCSAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHsKCSAgICAgICAgICAgIC8vIENyZWF0ZSBhIDxzY3JpcHQ+IGVsZW1lbnQ7IGl0cyByZWFkeXN0YXRlY2hhbmdlIGV2ZW50IHdpbGwgYmUgZmlyZWQgYXN5bmNocm9ub3VzbHkgb25jZSBpdCBpcyBpbnNlcnRlZAoJICAgICAgICAgICAgLy8gaW50byB0aGUgZG9jdW1lbnQuIERvIHNvLCB0aHVzIHF1ZXVpbmcgdXAgdGhlIHRhc2suIFJlbWVtYmVyIHRvIGNsZWFuIHVwIG9uY2UgaXQncyBiZWVuIGNhbGxlZC4KCSAgICAgICAgICAgIHZhciBzY3JpcHQgPSBkb2MuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CgkgICAgICAgICAgICBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgICAgIHJ1bklmUHJlc2VudChoYW5kbGUpOwoJICAgICAgICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsOwoJICAgICAgICAgICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQoc2NyaXB0KTsKCSAgICAgICAgICAgICAgICBzY3JpcHQgPSBudWxsOwoJICAgICAgICAgICAgfTsKCSAgICAgICAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoc2NyaXB0KTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGluc3RhbGxTZXRUaW1lb3V0SW1wbGVtZW50YXRpb24oKSB7CgkgICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7CgkgICAgICAgICAgICBzZXRUaW1lb3V0KHJ1bklmUHJlc2VudCwgMCwgaGFuZGxlKTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIC8vIElmIHN1cHBvcnRlZCwgd2Ugc2hvdWxkIGF0dGFjaCB0byB0aGUgcHJvdG90eXBlIG9mIGdsb2JhbCwgc2luY2UgdGhhdCBpcyB3aGVyZSBzZXRUaW1lb3V0IGV0IGFsLiBsaXZlLgoJICAgIHZhciBhdHRhY2hUbyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiAmJiBPYmplY3QuZ2V0UHJvdG90eXBlT2YoZ2xvYmFsKTsKCSAgICBhdHRhY2hUbyA9IGF0dGFjaFRvICYmIGF0dGFjaFRvLnNldFRpbWVvdXQgPyBhdHRhY2hUbyA6IGdsb2JhbDsKCgkgICAgLy8gRG9uJ3QgZ2V0IGZvb2xlZCBieSBlLmcuIGJyb3dzZXJpZnkgZW52aXJvbm1lbnRzLgoJICAgIGlmICh7fS50b1N0cmluZy5jYWxsKGdsb2JhbC5wcm9jZXNzKSA9PT0gIltvYmplY3QgcHJvY2Vzc10iKSB7CgkgICAgICAgIC8vIEZvciBOb2RlLmpzIGJlZm9yZSAwLjkKCSAgICAgICAgaW5zdGFsbE5leHRUaWNrSW1wbGVtZW50YXRpb24oKTsKCgkgICAgfSBlbHNlIGlmIChjYW5Vc2VQb3N0TWVzc2FnZSgpKSB7CgkgICAgICAgIC8vIEZvciBub24tSUUxMCBtb2Rlcm4gYnJvd3NlcnMKCSAgICAgICAgaW5zdGFsbFBvc3RNZXNzYWdlSW1wbGVtZW50YXRpb24oKTsKCgkgICAgfSBlbHNlIGlmIChnbG9iYWwuTWVzc2FnZUNoYW5uZWwpIHsKCSAgICAgICAgLy8gRm9yIHdlYiB3b3JrZXJzLCB3aGVyZSBzdXBwb3J0ZWQKCSAgICAgICAgaW5zdGFsbE1lc3NhZ2VDaGFubmVsSW1wbGVtZW50YXRpb24oKTsKCgkgICAgfSBlbHNlIGlmIChkb2MgJiYgIm9ucmVhZHlzdGF0ZWNoYW5nZSIgaW4gZG9jLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpKSB7CgkgICAgICAgIC8vIEZvciBJRSA24oCTOAoJICAgICAgICBpbnN0YWxsUmVhZHlTdGF0ZUNoYW5nZUltcGxlbWVudGF0aW9uKCk7CgoJICAgIH0gZWxzZSB7CgkgICAgICAgIC8vIEZvciBvbGRlciBicm93c2VycwoJICAgICAgICBpbnN0YWxsU2V0VGltZW91dEltcGxlbWVudGF0aW9uKCk7CgkgICAgfQoKCSAgICBhdHRhY2hUby5zZXRJbW1lZGlhdGUgPSBzZXRJbW1lZGlhdGU7CgkgICAgYXR0YWNoVG8uY2xlYXJJbW1lZGlhdGUgPSBjbGVhckltbWVkaWF0ZTsKCX0odHlwZW9mIHNlbGYgPT09ICJ1bmRlZmluZWQiID8gdHlwZW9mIGdsb2JhbCA9PT0gInVuZGVmaW5lZCIgPyB0aGlzIDogZ2xvYmFsIDogc2VsZikpOwoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KSkpCgovKioqLyB9LAovKiA0NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7CgkvKioKCSAqIE1vZHVsZSBleHBvcnRzLgoJICovCgoJbW9kdWxlLmV4cG9ydHMgPSBkZXByZWNhdGU7CgoJLyoqCgkgKiBNYXJrIHRoYXQgYSBtZXRob2Qgc2hvdWxkIG5vdCBiZSB1c2VkLgoJICogUmV0dXJucyBhIG1vZGlmaWVkIGZ1bmN0aW9uIHdoaWNoIHdhcm5zIG9uY2UgYnkgZGVmYXVsdC4KCSAqCgkgKiBJZiBgbG9jYWxTdG9yYWdlLm5vRGVwcmVjYXRpb24gPSB0cnVlYCBpcyBzZXQsIHRoZW4gaXQgaXMgYSBuby1vcC4KCSAqCgkgKiBJZiBgbG9jYWxTdG9yYWdlLnRocm93RGVwcmVjYXRpb24gPSB0cnVlYCBpcyBzZXQsIHRoZW4gZGVwcmVjYXRlZCBmdW5jdGlvbnMKCSAqIHdpbGwgdGhyb3cgYW4gRXJyb3Igd2hlbiBpbnZva2VkLgoJICoKCSAqIElmIGBsb2NhbFN0b3JhZ2UudHJhY2VEZXByZWNhdGlvbiA9IHRydWVgIGlzIHNldCwgdGhlbiBkZXByZWNhdGVkIGZ1bmN0aW9ucwoJICogd2lsbCBpbnZva2UgYGNvbnNvbGUudHJhY2UoKWAgaW5zdGVhZCBvZiBgY29uc29sZS5lcnJvcigpYC4KCSAqCgkgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIHRoZSBmdW5jdGlvbiB0byBkZXByZWNhdGUKCSAqIEBwYXJhbSB7U3RyaW5nfSBtc2cgLSB0aGUgc3RyaW5nIHRvIHByaW50IHRvIHRoZSBjb25zb2xlIHdoZW4gYGZuYCBpcyBpbnZva2VkCgkgKiBAcmV0dXJucyB7RnVuY3Rpb259IGEgbmV3ICJkZXByZWNhdGVkIiB2ZXJzaW9uIG9mIGBmbmAKCSAqIEBhcGkgcHVibGljCgkgKi8KCglmdW5jdGlvbiBkZXByZWNhdGUgKGZuLCBtc2cpIHsKCSAgaWYgKGNvbmZpZygnbm9EZXByZWNhdGlvbicpKSB7CgkgICAgcmV0dXJuIGZuOwoJICB9CgoJICB2YXIgd2FybmVkID0gZmFsc2U7CgkgIGZ1bmN0aW9uIGRlcHJlY2F0ZWQoKSB7CgkgICAgaWYgKCF3YXJuZWQpIHsKCSAgICAgIGlmIChjb25maWcoJ3Rocm93RGVwcmVjYXRpb24nKSkgewoJICAgICAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTsKCSAgICAgIH0gZWxzZSBpZiAoY29uZmlnKCd0cmFjZURlcHJlY2F0aW9uJykpIHsKCSAgICAgICAgY29uc29sZS50cmFjZShtc2cpOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgY29uc29sZS53YXJuKG1zZyk7CgkgICAgICB9CgkgICAgICB3YXJuZWQgPSB0cnVlOwoJICAgIH0KCSAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCSAgfQoKCSAgcmV0dXJuIGRlcHJlY2F0ZWQ7Cgl9CgoJLyoqCgkgKiBDaGVja3MgYGxvY2FsU3RvcmFnZWAgZm9yIGJvb2xlYW4gdmFsdWVzIGZvciB0aGUgZ2l2ZW4gYG5hbWVgLgoJICoKCSAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lCgkgKiBAcmV0dXJucyB7Qm9vbGVhbn0KCSAqIEBhcGkgcHJpdmF0ZQoJICovCgoJZnVuY3Rpb24gY29uZmlnIChuYW1lKSB7CgkgIC8vIGFjY2Vzc2luZyBnbG9iYWwubG9jYWxTdG9yYWdlIGNhbiB0cmlnZ2VyIGEgRE9NRXhjZXB0aW9uIGluIHNhbmRib3hlZCBpZnJhbWVzCgkgIHRyeSB7CgkgICAgaWYgKCFnbG9iYWwubG9jYWxTdG9yYWdlKSByZXR1cm4gZmFsc2U7CgkgIH0gY2F0Y2ggKF8pIHsKCSAgICByZXR1cm4gZmFsc2U7CgkgIH0KCSAgdmFyIHZhbCA9IGdsb2JhbC5sb2NhbFN0b3JhZ2VbbmFtZV07CgkgIGlmIChudWxsID09IHZhbCkgcmV0dXJuIGZhbHNlOwoJICByZXR1cm4gU3RyaW5nKHZhbCkudG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnOwoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSkKCi8qKiovIH0sCi8qIDQ1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLgoJLy8KCS8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCgkvLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCgkvLyAiU29mdHdhcmUiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nCgkvLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCgkvLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0CgkvLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUKCS8vIGZvbGxvd2luZyBjb25kaXRpb25zOgoJLy8KCS8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkCgkvLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCS8vCgkvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUwoJLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgoJLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTgoJLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sCgkvLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKCS8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUKCS8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCgoJdmFyIEJ1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oNSkuQnVmZmVyOwoKCXZhciBpc0J1ZmZlckVuY29kaW5nID0gQnVmZmVyLmlzRW5jb2RpbmcKCSAgfHwgZnVuY3Rpb24oZW5jb2RpbmcpIHsKCSAgICAgICBzd2l0Y2ggKGVuY29kaW5nICYmIGVuY29kaW5nLnRvTG93ZXJDYXNlKCkpIHsKCSAgICAgICAgIGNhc2UgJ2hleCc6IGNhc2UgJ3V0ZjgnOiBjYXNlICd1dGYtOCc6IGNhc2UgJ2FzY2lpJzogY2FzZSAnYmluYXJ5JzogY2FzZSAnYmFzZTY0JzogY2FzZSAndWNzMic6IGNhc2UgJ3Vjcy0yJzogY2FzZSAndXRmMTZsZSc6IGNhc2UgJ3V0Zi0xNmxlJzogY2FzZSAncmF3JzogcmV0dXJuIHRydWU7CgkgICAgICAgICBkZWZhdWx0OiByZXR1cm4gZmFsc2U7CgkgICAgICAgfQoJICAgICB9CgoKCWZ1bmN0aW9uIGFzc2VydEVuY29kaW5nKGVuY29kaW5nKSB7CgkgIGlmIChlbmNvZGluZyAmJiAhaXNCdWZmZXJFbmNvZGluZyhlbmNvZGluZykpIHsKCSAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZyk7CgkgIH0KCX0KCgkvLyBTdHJpbmdEZWNvZGVyIHByb3ZpZGVzIGFuIGludGVyZmFjZSBmb3IgZWZmaWNpZW50bHkgc3BsaXR0aW5nIGEgc2VyaWVzIG9mCgkvLyBidWZmZXJzIGludG8gYSBzZXJpZXMgb2YgSlMgc3RyaW5ncyB3aXRob3V0IGJyZWFraW5nIGFwYXJ0IG11bHRpLWJ5dGUKCS8vIGNoYXJhY3RlcnMuIENFU1UtOCBpcyBoYW5kbGVkIGFzIHBhcnQgb2YgdGhlIFVURi04IGVuY29kaW5nLgoJLy8KCS8vIEBUT0RPIEhhbmRsaW5nIGFsbCBlbmNvZGluZ3MgaW5zaWRlIGEgc2luZ2xlIG9iamVjdCBtYWtlcyBpdCB2ZXJ5IGRpZmZpY3VsdAoJLy8gdG8gcmVhc29uIGFib3V0IHRoaXMgY29kZSwgc28gaXQgc2hvdWxkIGJlIHNwbGl0IHVwIGluIHRoZSBmdXR1cmUuCgkvLyBAVE9ETyBUaGVyZSBzaG91bGQgYmUgYSB1dGY4LXN0cmljdCBlbmNvZGluZyB0aGF0IHJlamVjdHMgaW52YWxpZCBVVEYtOCBjb2RlCgkvLyBwb2ludHMgYXMgdXNlZCBieSBDRVNVLTguCgl2YXIgU3RyaW5nRGVjb2RlciA9IGV4cG9ydHMuU3RyaW5nRGVjb2RlciA9IGZ1bmN0aW9uKGVuY29kaW5nKSB7CgkgIHRoaXMuZW5jb2RpbmcgPSAoZW5jb2RpbmcgfHwgJ3V0ZjgnKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1stX10vLCAnJyk7CgkgIGFzc2VydEVuY29kaW5nKGVuY29kaW5nKTsKCSAgc3dpdGNoICh0aGlzLmVuY29kaW5nKSB7CgkgICAgY2FzZSAndXRmOCc6CgkgICAgICAvLyBDRVNVLTggcmVwcmVzZW50cyBlYWNoIG9mIFN1cnJvZ2F0ZSBQYWlyIGJ5IDMtYnl0ZXMKCSAgICAgIHRoaXMuc3Vycm9nYXRlU2l6ZSA9IDM7CgkgICAgICBicmVhazsKCSAgICBjYXNlICd1Y3MyJzoKCSAgICBjYXNlICd1dGYxNmxlJzoKCSAgICAgIC8vIFVURi0xNiByZXByZXNlbnRzIGVhY2ggb2YgU3Vycm9nYXRlIFBhaXIgYnkgMi1ieXRlcwoJICAgICAgdGhpcy5zdXJyb2dhdGVTaXplID0gMjsKCSAgICAgIHRoaXMuZGV0ZWN0SW5jb21wbGV0ZUNoYXIgPSB1dGYxNkRldGVjdEluY29tcGxldGVDaGFyOwoJICAgICAgYnJlYWs7CgkgICAgY2FzZSAnYmFzZTY0JzoKCSAgICAgIC8vIEJhc2UtNjQgc3RvcmVzIDMgYnl0ZXMgaW4gNCBjaGFycywgYW5kIHBhZHMgdGhlIHJlbWFpbmRlci4KCSAgICAgIHRoaXMuc3Vycm9nYXRlU2l6ZSA9IDM7CgkgICAgICB0aGlzLmRldGVjdEluY29tcGxldGVDaGFyID0gYmFzZTY0RGV0ZWN0SW5jb21wbGV0ZUNoYXI7CgkgICAgICBicmVhazsKCSAgICBkZWZhdWx0OgoJICAgICAgdGhpcy53cml0ZSA9IHBhc3NUaHJvdWdoV3JpdGU7CgkgICAgICByZXR1cm47CgkgIH0KCgkgIC8vIEVub3VnaCBzcGFjZSB0byBzdG9yZSBhbGwgYnl0ZXMgb2YgYSBzaW5nbGUgY2hhcmFjdGVyLiBVVEYtOCBuZWVkcyA0CgkgIC8vIGJ5dGVzLCBidXQgQ0VTVS04IG1heSByZXF1aXJlIHVwIHRvIDYgKDMgYnl0ZXMgcGVyIHN1cnJvZ2F0ZSkuCgkgIHRoaXMuY2hhckJ1ZmZlciA9IG5ldyBCdWZmZXIoNik7CgkgIC8vIE51bWJlciBvZiBieXRlcyByZWNlaXZlZCBmb3IgdGhlIGN1cnJlbnQgaW5jb21wbGV0ZSBtdWx0aS1ieXRlIGNoYXJhY3Rlci4KCSAgdGhpcy5jaGFyUmVjZWl2ZWQgPSAwOwoJICAvLyBOdW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgZm9yIHRoZSBjdXJyZW50IGluY29tcGxldGUgbXVsdGktYnl0ZSBjaGFyYWN0ZXIuCgkgIHRoaXMuY2hhckxlbmd0aCA9IDA7Cgl9OwoKCgkvLyB3cml0ZSBkZWNvZGVzIHRoZSBnaXZlbiBidWZmZXIgYW5kIHJldHVybnMgaXQgYXMgSlMgc3RyaW5nIHRoYXQgaXMKCS8vIGd1YXJhbnRlZWQgdG8gbm90IGNvbnRhaW4gYW55IHBhcnRpYWwgbXVsdGktYnl0ZSBjaGFyYWN0ZXJzLiBBbnkgcGFydGlhbAoJLy8gY2hhcmFjdGVyIGZvdW5kIGF0IHRoZSBlbmQgb2YgdGhlIGJ1ZmZlciBpcyBidWZmZXJlZCB1cCwgYW5kIHdpbGwgYmUKCS8vIHJldHVybmVkIHdoZW4gY2FsbGluZyB3cml0ZSBhZ2FpbiB3aXRoIHRoZSByZW1haW5pbmcgYnl0ZXMuCgkvLwoJLy8gTm90ZTogQ29udmVydGluZyBhIEJ1ZmZlciBjb250YWluaW5nIGFuIG9ycGhhbiBzdXJyb2dhdGUgdG8gYSBTdHJpbmcKCS8vIGN1cnJlbnRseSB3b3JrcywgYnV0IGNvbnZlcnRpbmcgYSBTdHJpbmcgdG8gYSBCdWZmZXIgKHZpYSBgbmV3IEJ1ZmZlcmAsIG9yCgkvLyBCdWZmZXIjd3JpdGUpIHdpbGwgcmVwbGFjZSBpbmNvbXBsZXRlIHN1cnJvZ2F0ZXMgd2l0aCB0aGUgdW5pY29kZQoJLy8gcmVwbGFjZW1lbnQgY2hhcmFjdGVyLiBTZWUgaHR0cHM6Ly9jb2RlcmV2aWV3LmNocm9taXVtLm9yZy8xMjExNzMwMDkvIC4KCVN0cmluZ0RlY29kZXIucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24oYnVmZmVyKSB7CgkgIHZhciBjaGFyU3RyID0gJyc7CgkgIC8vIGlmIG91ciBsYXN0IHdyaXRlIGVuZGVkIHdpdGggYW4gaW5jb21wbGV0ZSBtdWx0aWJ5dGUgY2hhcmFjdGVyCgkgIHdoaWxlICh0aGlzLmNoYXJMZW5ndGgpIHsKCSAgICAvLyBkZXRlcm1pbmUgaG93IG1hbnkgcmVtYWluaW5nIGJ5dGVzIHRoaXMgYnVmZmVyIGhhcyB0byBvZmZlciBmb3IgdGhpcyBjaGFyCgkgICAgdmFyIGF2YWlsYWJsZSA9IChidWZmZXIubGVuZ3RoID49IHRoaXMuY2hhckxlbmd0aCAtIHRoaXMuY2hhclJlY2VpdmVkKSA/CgkgICAgICAgIHRoaXMuY2hhckxlbmd0aCAtIHRoaXMuY2hhclJlY2VpdmVkIDoKCSAgICAgICAgYnVmZmVyLmxlbmd0aDsKCgkgICAgLy8gYWRkIHRoZSBuZXcgYnl0ZXMgdG8gdGhlIGNoYXIgYnVmZmVyCgkgICAgYnVmZmVyLmNvcHkodGhpcy5jaGFyQnVmZmVyLCB0aGlzLmNoYXJSZWNlaXZlZCwgMCwgYXZhaWxhYmxlKTsKCSAgICB0aGlzLmNoYXJSZWNlaXZlZCArPSBhdmFpbGFibGU7CgoJICAgIGlmICh0aGlzLmNoYXJSZWNlaXZlZCA8IHRoaXMuY2hhckxlbmd0aCkgewoJICAgICAgLy8gc3RpbGwgbm90IGVub3VnaCBjaGFycyBpbiB0aGlzIGJ1ZmZlcj8gd2FpdCBmb3IgbW9yZSAuLi4KCSAgICAgIHJldHVybiAnJzsKCSAgICB9CgoJICAgIC8vIHJlbW92ZSBieXRlcyBiZWxvbmdpbmcgdG8gdGhlIGN1cnJlbnQgY2hhcmFjdGVyIGZyb20gdGhlIGJ1ZmZlcgoJICAgIGJ1ZmZlciA9IGJ1ZmZlci5zbGljZShhdmFpbGFibGUsIGJ1ZmZlci5sZW5ndGgpOwoKCSAgICAvLyBnZXQgdGhlIGNoYXJhY3RlciB0aGF0IHdhcyBzcGxpdAoJICAgIGNoYXJTdHIgPSB0aGlzLmNoYXJCdWZmZXIuc2xpY2UoMCwgdGhpcy5jaGFyTGVuZ3RoKS50b1N0cmluZyh0aGlzLmVuY29kaW5nKTsKCgkgICAgLy8gQ0VTVS04OiBsZWFkIHN1cnJvZ2F0ZSAoRDgwMC1EQkZGKSBpcyBhbHNvIHRoZSBpbmNvbXBsZXRlIGNoYXJhY3RlcgoJICAgIHZhciBjaGFyQ29kZSA9IGNoYXJTdHIuY2hhckNvZGVBdChjaGFyU3RyLmxlbmd0aCAtIDEpOwoJICAgIGlmIChjaGFyQ29kZSA+PSAweEQ4MDAgJiYgY2hhckNvZGUgPD0gMHhEQkZGKSB7CgkgICAgICB0aGlzLmNoYXJMZW5ndGggKz0gdGhpcy5zdXJyb2dhdGVTaXplOwoJICAgICAgY2hhclN0ciA9ICcnOwoJICAgICAgY29udGludWU7CgkgICAgfQoJICAgIHRoaXMuY2hhclJlY2VpdmVkID0gdGhpcy5jaGFyTGVuZ3RoID0gMDsKCgkgICAgLy8gaWYgdGhlcmUgYXJlIG5vIG1vcmUgYnl0ZXMgaW4gdGhpcyBidWZmZXIsIGp1c3QgZW1pdCBvdXIgY2hhcgoJICAgIGlmIChidWZmZXIubGVuZ3RoID09PSAwKSB7CgkgICAgICByZXR1cm4gY2hhclN0cjsKCSAgICB9CgkgICAgYnJlYWs7CgkgIH0KCgkgIC8vIGRldGVybWluZSBhbmQgc2V0IGNoYXJMZW5ndGggLyBjaGFyUmVjZWl2ZWQKCSAgdGhpcy5kZXRlY3RJbmNvbXBsZXRlQ2hhcihidWZmZXIpOwoKCSAgdmFyIGVuZCA9IGJ1ZmZlci5sZW5ndGg7CgkgIGlmICh0aGlzLmNoYXJMZW5ndGgpIHsKCSAgICAvLyBidWZmZXIgdGhlIGluY29tcGxldGUgY2hhcmFjdGVyIGJ5dGVzIHdlIGdvdAoJICAgIGJ1ZmZlci5jb3B5KHRoaXMuY2hhckJ1ZmZlciwgMCwgYnVmZmVyLmxlbmd0aCAtIHRoaXMuY2hhclJlY2VpdmVkLCBlbmQpOwoJICAgIGVuZCAtPSB0aGlzLmNoYXJSZWNlaXZlZDsKCSAgfQoKCSAgY2hhclN0ciArPSBidWZmZXIudG9TdHJpbmcodGhpcy5lbmNvZGluZywgMCwgZW5kKTsKCgkgIHZhciBlbmQgPSBjaGFyU3RyLmxlbmd0aCAtIDE7CgkgIHZhciBjaGFyQ29kZSA9IGNoYXJTdHIuY2hhckNvZGVBdChlbmQpOwoJICAvLyBDRVNVLTg6IGxlYWQgc3Vycm9nYXRlIChEODAwLURCRkYpIGlzIGFsc28gdGhlIGluY29tcGxldGUgY2hhcmFjdGVyCgkgIGlmIChjaGFyQ29kZSA+PSAweEQ4MDAgJiYgY2hhckNvZGUgPD0gMHhEQkZGKSB7CgkgICAgdmFyIHNpemUgPSB0aGlzLnN1cnJvZ2F0ZVNpemU7CgkgICAgdGhpcy5jaGFyTGVuZ3RoICs9IHNpemU7CgkgICAgdGhpcy5jaGFyUmVjZWl2ZWQgKz0gc2l6ZTsKCSAgICB0aGlzLmNoYXJCdWZmZXIuY29weSh0aGlzLmNoYXJCdWZmZXIsIHNpemUsIDAsIHNpemUpOwoJICAgIGJ1ZmZlci5jb3B5KHRoaXMuY2hhckJ1ZmZlciwgMCwgMCwgc2l6ZSk7CgkgICAgcmV0dXJuIGNoYXJTdHIuc3Vic3RyaW5nKDAsIGVuZCk7CgkgIH0KCgkgIC8vIG9yIGp1c3QgZW1pdCB0aGUgY2hhclN0cgoJICByZXR1cm4gY2hhclN0cjsKCX07CgoJLy8gZGV0ZWN0SW5jb21wbGV0ZUNoYXIgZGV0ZXJtaW5lcyBpZiB0aGVyZSBpcyBhbiBpbmNvbXBsZXRlIFVURi04IGNoYXJhY3RlciBhdAoJLy8gdGhlIGVuZCBvZiB0aGUgZ2l2ZW4gYnVmZmVyLiBJZiBzbywgaXQgc2V0cyB0aGlzLmNoYXJMZW5ndGggdG8gdGhlIGJ5dGUKCS8vIGxlbmd0aCB0aGF0IGNoYXJhY3RlciwgYW5kIHNldHMgdGhpcy5jaGFyUmVjZWl2ZWQgdG8gdGhlIG51bWJlciBvZiBieXRlcwoJLy8gdGhhdCBhcmUgYXZhaWxhYmxlIGZvciB0aGlzIGNoYXJhY3Rlci4KCVN0cmluZ0RlY29kZXIucHJvdG90eXBlLmRldGVjdEluY29tcGxldGVDaGFyID0gZnVuY3Rpb24oYnVmZmVyKSB7CgkgIC8vIGRldGVybWluZSBob3cgbWFueSBieXRlcyB3ZSBoYXZlIHRvIGNoZWNrIGF0IHRoZSBlbmQgb2YgdGhpcyBidWZmZXIKCSAgdmFyIGkgPSAoYnVmZmVyLmxlbmd0aCA+PSAzKSA/IDMgOiBidWZmZXIubGVuZ3RoOwoKCSAgLy8gRmlndXJlIG91dCBpZiBvbmUgb2YgdGhlIGxhc3QgaSBieXRlcyBvZiBvdXIgYnVmZmVyIGFubm91bmNlcyBhbgoJICAvLyBpbmNvbXBsZXRlIGNoYXIuCgkgIGZvciAoOyBpID4gMDsgaS0tKSB7CgkgICAgdmFyIGMgPSBidWZmZXJbYnVmZmVyLmxlbmd0aCAtIGldOwoKCSAgICAvLyBTZWUgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9VVEYtOCNEZXNjcmlwdGlvbgoKCSAgICAvLyAxMTBYWFhYWAoJICAgIGlmIChpID09IDEgJiYgYyA+PiA1ID09IDB4MDYpIHsKCSAgICAgIHRoaXMuY2hhckxlbmd0aCA9IDI7CgkgICAgICBicmVhazsKCSAgICB9CgoJICAgIC8vIDExMTBYWFhYCgkgICAgaWYgKGkgPD0gMiAmJiBjID4+IDQgPT0gMHgwRSkgewoJICAgICAgdGhpcy5jaGFyTGVuZ3RoID0gMzsKCSAgICAgIGJyZWFrOwoJICAgIH0KCgkgICAgLy8gMTExMTBYWFgKCSAgICBpZiAoaSA8PSAzICYmIGMgPj4gMyA9PSAweDFFKSB7CgkgICAgICB0aGlzLmNoYXJMZW5ndGggPSA0OwoJICAgICAgYnJlYWs7CgkgICAgfQoJICB9CgkgIHRoaXMuY2hhclJlY2VpdmVkID0gaTsKCX07CgoJU3RyaW5nRGVjb2Rlci5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24oYnVmZmVyKSB7CgkgIHZhciByZXMgPSAnJzsKCSAgaWYgKGJ1ZmZlciAmJiBidWZmZXIubGVuZ3RoKQoJICAgIHJlcyA9IHRoaXMud3JpdGUoYnVmZmVyKTsKCgkgIGlmICh0aGlzLmNoYXJSZWNlaXZlZCkgewoJICAgIHZhciBjciA9IHRoaXMuY2hhclJlY2VpdmVkOwoJICAgIHZhciBidWYgPSB0aGlzLmNoYXJCdWZmZXI7CgkgICAgdmFyIGVuYyA9IHRoaXMuZW5jb2Rpbmc7CgkgICAgcmVzICs9IGJ1Zi5zbGljZSgwLCBjcikudG9TdHJpbmcoZW5jKTsKCSAgfQoKCSAgcmV0dXJuIHJlczsKCX07CgoJZnVuY3Rpb24gcGFzc1Rocm91Z2hXcml0ZShidWZmZXIpIHsKCSAgcmV0dXJuIGJ1ZmZlci50b1N0cmluZyh0aGlzLmVuY29kaW5nKTsKCX0KCglmdW5jdGlvbiB1dGYxNkRldGVjdEluY29tcGxldGVDaGFyKGJ1ZmZlcikgewoJICB0aGlzLmNoYXJSZWNlaXZlZCA9IGJ1ZmZlci5sZW5ndGggJSAyOwoJICB0aGlzLmNoYXJMZW5ndGggPSB0aGlzLmNoYXJSZWNlaXZlZCA/IDIgOiAwOwoJfQoKCWZ1bmN0aW9uIGJhc2U2NERldGVjdEluY29tcGxldGVDaGFyKGJ1ZmZlcikgewoJICB0aGlzLmNoYXJSZWNlaXZlZCA9IGJ1ZmZlci5sZW5ndGggJSAzOwoJICB0aGlzLmNoYXJMZW5ndGggPSB0aGlzLmNoYXJSZWNlaXZlZCA/IDMgOiAwOwoJfQoKCi8qKiovIH0sCi8qIDQ2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGEgdHJhbnNmb3JtIHN0cmVhbSBpcyBhIHJlYWRhYmxlL3dyaXRhYmxlIHN0cmVhbSB3aGVyZSB5b3UgZG8KCS8vIHNvbWV0aGluZyB3aXRoIHRoZSBkYXRhLiAgU29tZXRpbWVzIGl0J3MgY2FsbGVkIGEgImZpbHRlciIsCgkvLyBidXQgdGhhdCdzIG5vdCBhIGdyZWF0IG5hbWUgZm9yIGl0LCBzaW5jZSB0aGF0IGltcGxpZXMgYSB0aGluZyB3aGVyZQoJLy8gc29tZSBiaXRzIHBhc3MgdGhyb3VnaCwgYW5kIG90aGVycyBhcmUgc2ltcGx5IGlnbm9yZWQuICAoVGhhdCB3b3VsZAoJLy8gYmUgYSB2YWxpZCBleGFtcGxlIG9mIGEgdHJhbnNmb3JtLCBvZiBjb3Vyc2UuKQoJLy8KCS8vIFdoaWxlIHRoZSBvdXRwdXQgaXMgY2F1c2FsbHkgcmVsYXRlZCB0byB0aGUgaW5wdXQsIGl0J3Mgbm90IGEKCS8vIG5lY2Vzc2FyaWx5IHN5bW1ldHJpYyBvciBzeW5jaHJvbm91cyB0cmFuc2Zvcm1hdGlvbi4gIEZvciBleGFtcGxlLAoJLy8gYSB6bGliIHN0cmVhbSBtaWdodCB0YWtlIG11bHRpcGxlIHBsYWluLXRleHQgd3JpdGVzKCksIGFuZCB0aGVuCgkvLyBlbWl0IGEgc2luZ2xlIGNvbXByZXNzZWQgY2h1bmsgc29tZSB0aW1lIGluIHRoZSBmdXR1cmUuCgkvLwoJLy8gSGVyZSdzIGhvdyB0aGlzIHdvcmtzOgoJLy8KCS8vIFRoZSBUcmFuc2Zvcm0gc3RyZWFtIGhhcyBhbGwgdGhlIGFzcGVjdHMgb2YgdGhlIHJlYWRhYmxlIGFuZCB3cml0YWJsZQoJLy8gc3RyZWFtIGNsYXNzZXMuICBXaGVuIHlvdSB3cml0ZShjaHVuayksIHRoYXQgY2FsbHMgX3dyaXRlKGNodW5rLGNiKQoJLy8gaW50ZXJuYWxseSwgYW5kIHJldHVybnMgZmFsc2UgaWYgdGhlcmUncyBhIGxvdCBvZiBwZW5kaW5nIHdyaXRlcwoJLy8gYnVmZmVyZWQgdXAuICBXaGVuIHlvdSBjYWxsIHJlYWQoKSwgdGhhdCBjYWxscyBfcmVhZChuKSB1bnRpbAoJLy8gdGhlcmUncyBlbm91Z2ggcGVuZGluZyByZWFkYWJsZSBkYXRhIGJ1ZmZlcmVkIHVwLgoJLy8KCS8vIEluIGEgdHJhbnNmb3JtIHN0cmVhbSwgdGhlIHdyaXR0ZW4gZGF0YSBpcyBwbGFjZWQgaW4gYSBidWZmZXIuICBXaGVuCgkvLyBfcmVhZChuKSBpcyBjYWxsZWQsIGl0IHRyYW5zZm9ybXMgdGhlIHF1ZXVlZCB1cCBkYXRhLCBjYWxsaW5nIHRoZQoJLy8gYnVmZmVyZWQgX3dyaXRlIGNiJ3MgYXMgaXQgY29uc3VtZXMgY2h1bmtzLiAgSWYgY29uc3VtaW5nIGEgc2luZ2xlCgkvLyB3cml0dGVuIGNodW5rIHdvdWxkIHJlc3VsdCBpbiBtdWx0aXBsZSBvdXRwdXQgY2h1bmtzLCB0aGVuIHRoZSBmaXJzdAoJLy8gb3V0cHV0dGVkIGJpdCBjYWxscyB0aGUgcmVhZGNiLCBhbmQgc3Vic2VxdWVudCBjaHVua3MganVzdCBnbyBpbnRvCgkvLyB0aGUgcmVhZCBidWZmZXIsIGFuZCB3aWxsIGNhdXNlIGl0IHRvIGVtaXQgJ3JlYWRhYmxlJyBpZiBuZWNlc3NhcnkuCgkvLwoJLy8gVGhpcyB3YXksIGJhY2stcHJlc3N1cmUgaXMgYWN0dWFsbHkgZGV0ZXJtaW5lZCBieSB0aGUgcmVhZGluZyBzaWRlLAoJLy8gc2luY2UgX3JlYWQgaGFzIHRvIGJlIGNhbGxlZCB0byBzdGFydCBwcm9jZXNzaW5nIGEgbmV3IGNodW5rLiAgSG93ZXZlciwKCS8vIGEgcGF0aG9sb2dpY2FsIGluZmxhdGUgdHlwZSBvZiB0cmFuc2Zvcm0gY2FuIGNhdXNlIGV4Y2Vzc2l2ZSBidWZmZXJpbmcKCS8vIGhlcmUuICBGb3IgZXhhbXBsZSwgaW1hZ2luZSBhIHN0cmVhbSB3aGVyZSBldmVyeSBieXRlIG9mIGlucHV0IGlzCgkvLyBpbnRlcnByZXRlZCBhcyBhbiBpbnRlZ2VyIGZyb20gMC0yNTUsIGFuZCB0aGVuIHJlc3VsdHMgaW4gdGhhdCBtYW55CgkvLyBieXRlcyBvZiBvdXRwdXQuICBXcml0aW5nIHRoZSA0IGJ5dGVzIHtmZixmZixmZixmZn0gd291bGQgcmVzdWx0IGluCgkvLyAxa2Igb2YgZGF0YSBiZWluZyBvdXRwdXQuICBJbiB0aGlzIGNhc2UsIHlvdSBjb3VsZCB3cml0ZSBhIHZlcnkgc21hbGwKCS8vIGFtb3VudCBvZiBpbnB1dCwgYW5kIGVuZCB1cCB3aXRoIGEgdmVyeSBsYXJnZSBhbW91bnQgb2Ygb3V0cHV0LiAgSW4KCS8vIHN1Y2ggYSBwYXRob2xvZ2ljYWwgaW5mbGF0aW5nIG1lY2hhbmlzbSwgdGhlcmUnZCBiZSBubyB3YXkgdG8gdGVsbAoJLy8gdGhlIHN5c3RlbSB0byBzdG9wIGRvaW5nIHRoZSB0cmFuc2Zvcm0uICBBIHNpbmdsZSA0TUIgd3JpdGUgY291bGQKCS8vIGNhdXNlIHRoZSBzeXN0ZW0gdG8gcnVuIG91dCBvZiBtZW1vcnkuCgkvLwoJLy8gSG93ZXZlciwgZXZlbiBpbiBzdWNoIGEgcGF0aG9sb2dpY2FsIGNhc2UsIG9ubHkgYSBzaW5nbGUgd3JpdHRlbiBjaHVuawoJLy8gd291bGQgYmUgY29uc3VtZWQsIGFuZCB0aGVuIHRoZSByZXN0IHdvdWxkIHdhaXQgKHVuLXRyYW5zZm9ybWVkKSB1bnRpbAoJLy8gdGhlIHJlc3VsdHMgb2YgdGhlIHByZXZpb3VzIHRyYW5zZm9ybWVkIGNodW5rIHdlcmUgY29uc3VtZWQuCgoJJ3VzZSBzdHJpY3QnOwoKCW1vZHVsZS5leHBvcnRzID0gVHJhbnNmb3JtOwoKCXZhciBEdXBsZXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM3KTsKCXV0aWwuaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXV0aWwuaW5oZXJpdHMoVHJhbnNmb3JtLCBEdXBsZXgpOwoKCWZ1bmN0aW9uIFRyYW5zZm9ybVN0YXRlKHN0cmVhbSkgewoJICB0aGlzLmFmdGVyVHJhbnNmb3JtID0gZnVuY3Rpb24gKGVyLCBkYXRhKSB7CgkgICAgcmV0dXJuIGFmdGVyVHJhbnNmb3JtKHN0cmVhbSwgZXIsIGRhdGEpOwoJICB9OwoKCSAgdGhpcy5uZWVkVHJhbnNmb3JtID0gZmFsc2U7CgkgIHRoaXMudHJhbnNmb3JtaW5nID0gZmFsc2U7CgkgIHRoaXMud3JpdGVjYiA9IG51bGw7CgkgIHRoaXMud3JpdGVjaHVuayA9IG51bGw7CgkgIHRoaXMud3JpdGVlbmNvZGluZyA9IG51bGw7Cgl9CgoJZnVuY3Rpb24gYWZ0ZXJUcmFuc2Zvcm0oc3RyZWFtLCBlciwgZGF0YSkgewoJICB2YXIgdHMgPSBzdHJlYW0uX3RyYW5zZm9ybVN0YXRlOwoJICB0cy50cmFuc2Zvcm1pbmcgPSBmYWxzZTsKCgkgIHZhciBjYiA9IHRzLndyaXRlY2I7CgoJICBpZiAoIWNiKSByZXR1cm4gc3RyZWFtLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdubyB3cml0ZWNiIGluIFRyYW5zZm9ybSBjbGFzcycpKTsKCgkgIHRzLndyaXRlY2h1bmsgPSBudWxsOwoJICB0cy53cml0ZWNiID0gbnVsbDsKCgkgIGlmIChkYXRhICE9PSBudWxsICYmIGRhdGEgIT09IHVuZGVmaW5lZCkgc3RyZWFtLnB1c2goZGF0YSk7CgoJICBjYihlcik7CgoJICB2YXIgcnMgPSBzdHJlYW0uX3JlYWRhYmxlU3RhdGU7CgkgIHJzLnJlYWRpbmcgPSBmYWxzZTsKCSAgaWYgKHJzLm5lZWRSZWFkYWJsZSB8fCBycy5sZW5ndGggPCBycy5oaWdoV2F0ZXJNYXJrKSB7CgkgICAgc3RyZWFtLl9yZWFkKHJzLmhpZ2hXYXRlck1hcmspOwoJICB9Cgl9CgoJZnVuY3Rpb24gVHJhbnNmb3JtKG9wdGlvbnMpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFRyYW5zZm9ybSkpIHJldHVybiBuZXcgVHJhbnNmb3JtKG9wdGlvbnMpOwoKCSAgRHVwbGV4LmNhbGwodGhpcywgb3B0aW9ucyk7CgoJICB0aGlzLl90cmFuc2Zvcm1TdGF0ZSA9IG5ldyBUcmFuc2Zvcm1TdGF0ZSh0aGlzKTsKCgkgIHZhciBzdHJlYW0gPSB0aGlzOwoKCSAgLy8gc3RhcnQgb3V0IGFza2luZyBmb3IgYSByZWFkYWJsZSBldmVudCBvbmNlIGRhdGEgaXMgdHJhbnNmb3JtZWQuCgkgIHRoaXMuX3JlYWRhYmxlU3RhdGUubmVlZFJlYWRhYmxlID0gdHJ1ZTsKCgkgIC8vIHdlIGhhdmUgaW1wbGVtZW50ZWQgdGhlIF9yZWFkIG1ldGhvZCwgYW5kIGRvbmUgdGhlIG90aGVyIHRoaW5ncwoJICAvLyB0aGF0IFJlYWRhYmxlIHdhbnRzIGJlZm9yZSB0aGUgZmlyc3QgX3JlYWQgY2FsbCwgc28gdW5zZXQgdGhlCgkgIC8vIHN5bmMgZ3VhcmQgZmxhZy4KCSAgdGhpcy5fcmVhZGFibGVTdGF0ZS5zeW5jID0gZmFsc2U7CgoJICBpZiAob3B0aW9ucykgewoJICAgIGlmICh0eXBlb2Ygb3B0aW9ucy50cmFuc2Zvcm0gPT09ICdmdW5jdGlvbicpIHRoaXMuX3RyYW5zZm9ybSA9IG9wdGlvbnMudHJhbnNmb3JtOwoKCSAgICBpZiAodHlwZW9mIG9wdGlvbnMuZmx1c2ggPT09ICdmdW5jdGlvbicpIHRoaXMuX2ZsdXNoID0gb3B0aW9ucy5mbHVzaDsKCSAgfQoKCSAgLy8gV2hlbiB0aGUgd3JpdGFibGUgc2lkZSBmaW5pc2hlcywgdGhlbiBmbHVzaCBvdXQgYW55dGhpbmcgcmVtYWluaW5nLgoJICB0aGlzLm9uY2UoJ3ByZWZpbmlzaCcsIGZ1bmN0aW9uICgpIHsKCSAgICBpZiAodHlwZW9mIHRoaXMuX2ZsdXNoID09PSAnZnVuY3Rpb24nKSB0aGlzLl9mbHVzaChmdW5jdGlvbiAoZXIsIGRhdGEpIHsKCSAgICAgIGRvbmUoc3RyZWFtLCBlciwgZGF0YSk7CgkgICAgfSk7ZWxzZSBkb25lKHN0cmVhbSk7CgkgIH0pOwoJfQoKCVRyYW5zZm9ybS5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcpIHsKCSAgdGhpcy5fdHJhbnNmb3JtU3RhdGUubmVlZFRyYW5zZm9ybSA9IGZhbHNlOwoJICByZXR1cm4gRHVwbGV4LnByb3RvdHlwZS5wdXNoLmNhbGwodGhpcywgY2h1bmssIGVuY29kaW5nKTsKCX07CgoJLy8gVGhpcyBpcyB0aGUgcGFydCB3aGVyZSB5b3UgZG8gc3R1ZmYhCgkvLyBvdmVycmlkZSB0aGlzIGZ1bmN0aW9uIGluIGltcGxlbWVudGF0aW9uIGNsYXNzZXMuCgkvLyAnY2h1bmsnIGlzIGFuIGlucHV0IGNodW5rLgoJLy8KCS8vIENhbGwgYHB1c2gobmV3Q2h1bmspYCB0byBwYXNzIGFsb25nIHRyYW5zZm9ybWVkIG91dHB1dAoJLy8gdG8gdGhlIHJlYWRhYmxlIHNpZGUuICBZb3UgbWF5IGNhbGwgJ3B1c2gnIHplcm8gb3IgbW9yZSB0aW1lcy4KCS8vCgkvLyBDYWxsIGBjYihlcnIpYCB3aGVuIHlvdSBhcmUgZG9uZSB3aXRoIHRoaXMgY2h1bmsuICBJZiB5b3UgcGFzcwoJLy8gYW4gZXJyb3IsIHRoZW4gdGhhdCdsbCBwdXQgdGhlIGh1cnQgb24gdGhlIHdob2xlIG9wZXJhdGlvbi4gIElmIHlvdQoJLy8gbmV2ZXIgY2FsbCBjYigpLCB0aGVuIHlvdSdsbCBuZXZlciBnZXQgYW5vdGhlciBjaHVuay4KCVRyYW5zZm9ybS5wcm90b3R5cGUuX3RyYW5zZm9ybSA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIHRocm93IG5ldyBFcnJvcignX3RyYW5zZm9ybSgpIGlzIG5vdCBpbXBsZW1lbnRlZCcpOwoJfTsKCglUcmFuc2Zvcm0ucHJvdG90eXBlLl93cml0ZSA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIHZhciB0cyA9IHRoaXMuX3RyYW5zZm9ybVN0YXRlOwoJICB0cy53cml0ZWNiID0gY2I7CgkgIHRzLndyaXRlY2h1bmsgPSBjaHVuazsKCSAgdHMud3JpdGVlbmNvZGluZyA9IGVuY29kaW5nOwoJICBpZiAoIXRzLnRyYW5zZm9ybWluZykgewoJICAgIHZhciBycyA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgkgICAgaWYgKHRzLm5lZWRUcmFuc2Zvcm0gfHwgcnMubmVlZFJlYWRhYmxlIHx8IHJzLmxlbmd0aCA8IHJzLmhpZ2hXYXRlck1hcmspIHRoaXMuX3JlYWQocnMuaGlnaFdhdGVyTWFyayk7CgkgIH0KCX07CgoJLy8gRG9lc24ndCBtYXR0ZXIgd2hhdCB0aGUgYXJncyBhcmUgaGVyZS4KCS8vIF90cmFuc2Zvcm0gZG9lcyBhbGwgdGhlIHdvcmsuCgkvLyBUaGF0IHdlIGdvdCBoZXJlIG1lYW5zIHRoYXQgdGhlIHJlYWRhYmxlIHNpZGUgd2FudHMgbW9yZSBkYXRhLgoJVHJhbnNmb3JtLnByb3RvdHlwZS5fcmVhZCA9IGZ1bmN0aW9uIChuKSB7CgkgIHZhciB0cyA9IHRoaXMuX3RyYW5zZm9ybVN0YXRlOwoKCSAgaWYgKHRzLndyaXRlY2h1bmsgIT09IG51bGwgJiYgdHMud3JpdGVjYiAmJiAhdHMudHJhbnNmb3JtaW5nKSB7CgkgICAgdHMudHJhbnNmb3JtaW5nID0gdHJ1ZTsKCSAgICB0aGlzLl90cmFuc2Zvcm0odHMud3JpdGVjaHVuaywgdHMud3JpdGVlbmNvZGluZywgdHMuYWZ0ZXJUcmFuc2Zvcm0pOwoJICB9IGVsc2UgewoJICAgIC8vIG1hcmsgdGhhdCB3ZSBuZWVkIGEgdHJhbnNmb3JtLCBzbyB0aGF0IGFueSBkYXRhIHRoYXQgY29tZXMgaW4KCSAgICAvLyB3aWxsIGdldCBwcm9jZXNzZWQsIG5vdyB0aGF0IHdlJ3ZlIGFza2VkIGZvciBpdC4KCSAgICB0cy5uZWVkVHJhbnNmb3JtID0gdHJ1ZTsKCSAgfQoJfTsKCglmdW5jdGlvbiBkb25lKHN0cmVhbSwgZXIsIGRhdGEpIHsKCSAgaWYgKGVyKSByZXR1cm4gc3RyZWFtLmVtaXQoJ2Vycm9yJywgZXIpOwoKCSAgaWYgKGRhdGEgIT09IG51bGwgJiYgZGF0YSAhPT0gdW5kZWZpbmVkKSBzdHJlYW0ucHVzaChkYXRhKTsKCgkgIC8vIGlmIHRoZXJlJ3Mgbm90aGluZyBpbiB0aGUgd3JpdGUgYnVmZmVyLCB0aGVuIHRoYXQgbWVhbnMKCSAgLy8gdGhhdCBub3RoaW5nIG1vcmUgd2lsbCBldmVyIGJlIHByb3ZpZGVkCgkgIHZhciB3cyA9IHN0cmVhbS5fd3JpdGFibGVTdGF0ZTsKCSAgdmFyIHRzID0gc3RyZWFtLl90cmFuc2Zvcm1TdGF0ZTsKCgkgIGlmICh3cy5sZW5ndGgpIHRocm93IG5ldyBFcnJvcignQ2FsbGluZyB0cmFuc2Zvcm0gZG9uZSB3aGVuIHdzLmxlbmd0aCAhPSAwJyk7CgoJICBpZiAodHMudHJhbnNmb3JtaW5nKSB0aHJvdyBuZXcgRXJyb3IoJ0NhbGxpbmcgdHJhbnNmb3JtIGRvbmUgd2hlbiBzdGlsbCB0cmFuc2Zvcm1pbmcnKTsKCgkgIHJldHVybiBzdHJlYW0ucHVzaChudWxsKTsKCX0KCi8qKiovIH0sCi8qIDQ3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGEgcGFzc3Rocm91Z2ggc3RyZWFtLgoJLy8gYmFzaWNhbGx5IGp1c3QgdGhlIG1vc3QgbWluaW1hbCBzb3J0IG9mIFRyYW5zZm9ybSBzdHJlYW0uCgkvLyBFdmVyeSB3cml0dGVuIGNodW5rIGdldHMgb3V0cHV0IGFzLWlzLgoKCSd1c2Ugc3RyaWN0JzsKCgltb2R1bGUuZXhwb3J0cyA9IFBhc3NUaHJvdWdoOwoKCXZhciBUcmFuc2Zvcm0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ2KTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM3KTsKCXV0aWwuaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXV0aWwuaW5oZXJpdHMoUGFzc1Rocm91Z2gsIFRyYW5zZm9ybSk7CgoJZnVuY3Rpb24gUGFzc1Rocm91Z2gob3B0aW9ucykgewoJICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUGFzc1Rocm91Z2gpKSByZXR1cm4gbmV3IFBhc3NUaHJvdWdoKG9wdGlvbnMpOwoKCSAgVHJhbnNmb3JtLmNhbGwodGhpcywgb3B0aW9ucyk7Cgl9CgoJUGFzc1Rocm91Z2gucHJvdG90eXBlLl90cmFuc2Zvcm0gPSBmdW5jdGlvbiAoY2h1bmssIGVuY29kaW5nLCBjYikgewoJICBjYihudWxsLCBjaHVuayk7Cgl9OwoKLyoqKi8gfSwKLyogNDggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQxKQoKCi8qKiovIH0sCi8qIDQ5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCkKCgovKioqLyB9LAovKiA1MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCgoKLyoqKi8gfSwKLyogNTEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ3KQoKCi8qKiovIH0sCi8qIDUyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCWV4cG9ydHNbJ2Flcy0xMjgtZWNiJ10gPSB7CgkgIGNpcGhlcjogJ0FFUycsCgkgIGtleTogMTI4LAoJICBpdjogMCwKCSAgbW9kZTogJ0VDQicsCgkgIHR5cGU6ICdibG9jaycKCX07CglleHBvcnRzWydhZXMtMTkyLWVjYiddID0gewoJICBjaXBoZXI6ICdBRVMnLAoJICBrZXk6IDE5MiwKCSAgaXY6IDAsCgkgIG1vZGU6ICdFQ0InLAoJICB0eXBlOiAnYmxvY2snCgl9OwoJZXhwb3J0c1snYWVzLTI1Ni1lY2InXSA9IHsKCSAgY2lwaGVyOiAnQUVTJywKCSAga2V5OiAyNTYsCgkgIGl2OiAwLAoJICBtb2RlOiAnRUNCJywKCSAgdHlwZTogJ2Jsb2NrJwoJfTsKCWV4cG9ydHNbJ2Flcy0xMjgtY2JjJ10gPSB7CgkgIGNpcGhlcjogJ0FFUycsCgkgIGtleTogMTI4LAoJICBpdjogMTYsCgkgIG1vZGU6ICdDQkMnLAoJICB0eXBlOiAnYmxvY2snCgl9OwoJZXhwb3J0c1snYWVzLTE5Mi1jYmMnXSA9IHsKCSAgY2lwaGVyOiAnQUVTJywKCSAga2V5OiAxOTIsCgkgIGl2OiAxNiwKCSAgbW9kZTogJ0NCQycsCgkgIHR5cGU6ICdibG9jaycKCX07CglleHBvcnRzWydhZXMtMjU2LWNiYyddID0gewoJICBjaXBoZXI6ICdBRVMnLAoJICBrZXk6IDI1NiwKCSAgaXY6IDE2LAoJICBtb2RlOiAnQ0JDJywKCSAgdHlwZTogJ2Jsb2NrJwoJfTsKCWV4cG9ydHNbJ2FlczEyOCddID0gZXhwb3J0c1snYWVzLTEyOC1jYmMnXTsKCWV4cG9ydHNbJ2FlczE5MiddID0gZXhwb3J0c1snYWVzLTE5Mi1jYmMnXTsKCWV4cG9ydHNbJ2FlczI1NiddID0gZXhwb3J0c1snYWVzLTI1Ni1jYmMnXTsKCWV4cG9ydHNbJ2Flcy0xMjgtY2ZiJ10gPSB7CgkgIGNpcGhlcjogJ0FFUycsCgkgIGtleTogMTI4LAoJICBpdjogMTYsCgkgIG1vZGU6ICdDRkInLAoJICB0eXBlOiAnc3RyZWFtJwoJfTsKCWV4cG9ydHNbJ2Flcy0xOTItY2ZiJ10gPSB7CgkgIGNpcGhlcjogJ0FFUycsCgkgIGtleTogMTkyLAoJICBpdjogMTYsCgkgIG1vZGU6ICdDRkInLAoJICB0eXBlOiAnc3RyZWFtJwoJfTsKCWV4cG9ydHNbJ2Flcy0yNTYtY2ZiJ10gPSB7CgkgIGNpcGhlcjogJ0FFUycsCgkgIGtleTogMjU2LAoJICBpdjogMTYsCgkgIG1vZGU6ICdDRkInLAoJICB0eXBlOiAnc3RyZWFtJwoJfTsKCWV4cG9ydHNbJ2Flcy0xMjgtb2ZiJ10gPSB7CgkgIGNpcGhlcjogJ0FFUycsCgkgIGtleTogMTI4LAoJICBpdjogMTYsCgkgIG1vZGU6ICdPRkInLAoJICB0eXBlOiAnc3RyZWFtJwoJfTsKCWV4cG9ydHNbJ2Flcy0xOTItb2ZiJ10gPSB7CgkgIGNpcGhlcjogJ0FFUycsCgkgIGtleTogMTkyLAoJICBpdjogMTYsCgkgIG1vZGU6ICdPRkInLAoJICB0eXBlOiAnc3RyZWFtJwoJfTsKCWV4cG9ydHNbJ2Flcy0yNTYtb2ZiJ10gPSB7CgkgIGNpcGhlcjogJ0FFUycsCgkgIGtleTogMjU2LAoJICBpdjogMTYsCgkgIG1vZGU6ICdPRkInLAoJICB0eXBlOiAnc3RyZWFtJwoJfTsKCWV4cG9ydHNbJ2Flcy0xMjgtY3RyJ10gPSB7CgkgIGNpcGhlcjogJ0FFUycsCgkgIGtleTogMTI4LAoJICBpdjogMTYsCgkgIG1vZGU6ICdDVFInLAoJICB0eXBlOiAnc3RyZWFtJwoJfTsKCWV4cG9ydHNbJ2Flcy0xOTItY3RyJ10gPSB7CgkgIGNpcGhlcjogJ0FFUycsCgkgIGtleTogMTkyLAoJICBpdjogMTYsCgkgIG1vZGU6ICdDVFInLAoJICB0eXBlOiAnc3RyZWFtJwoJfTsKCWV4cG9ydHNbJ2Flcy0yNTYtY3RyJ10gPSB7CgkgIGNpcGhlcjogJ0FFUycsCgkgIGtleTogMjU2LAoJICBpdjogMTYsCgkgIG1vZGU6ICdDVFInLAoJICB0eXBlOiAnc3RyZWFtJwoJfTsKCi8qKiovIH0sCi8qIDUzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIpIHsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGNyeXB0bywgcGFzc3dvcmQsIGtleUxlbiwgaXZMZW4pIHsKCSAga2V5TGVuID0ga2V5TGVuLzg7CgkgIGl2TGVuID0gaXZMZW4gfHwgMDsKCSAgdmFyIGtpID0gMDsKCSAgdmFyIGlpID0gMDsKCSAgdmFyIGtleSA9IG5ldyBCdWZmZXIoa2V5TGVuKTsKCSAgdmFyIGl2ID0gbmV3IEJ1ZmZlcihpdkxlbik7CgkgIHZhciBhZGRtZCA9IDA7CgkgIHZhciBtZCwgbWRfYnVmOwoJICB2YXIgaTsKCSAgd2hpbGUgKHRydWUpIHsKCSAgICBtZCA9IGNyeXB0by5jcmVhdGVIYXNoKCdtZDUnKTsKCSAgICBpZihhZGRtZCsrID4gMCkgewoJICAgICAgIG1kLnVwZGF0ZShtZF9idWYpOwoJICAgIH0KCSAgICBtZC51cGRhdGUocGFzc3dvcmQpOwoJICAgIG1kX2J1ZiA9IG1kLmRpZ2VzdCgpOwoJICAgIGkgPSAwOwoJICAgIGlmKGtleUxlbiA+IDApIHsKCSAgICAgIHdoaWxlKHRydWUpIHsKCSAgICAgICAgaWYoa2V5TGVuID09PSAwKSB7CgkgICAgICAgICAgYnJlYWs7CgkgICAgICAgIH0KCSAgICAgICAgaWYoaSA9PT0gbWRfYnVmLmxlbmd0aCkgewoJICAgICAgICAgIGJyZWFrOwoJICAgICAgICB9CgkgICAgICAgIGtleVtraSsrXSA9IG1kX2J1ZltpXTsKCSAgICAgICAga2V5TGVuLS07CgkgICAgICAgIGkrKzsKCSAgICAgICB9CgkgICAgfQoJICAgIGlmKGl2TGVuID4gMCAmJiBpICE9PSBtZF9idWYubGVuZ3RoKSB7CgkgICAgICB3aGlsZSh0cnVlKSB7CgkgICAgICAgIGlmKGl2TGVuID09PSAwKSB7CgkgICAgICAgICAgYnJlYWs7CgkgICAgICAgIH0KCSAgICAgICAgaWYoaSA9PT0gbWRfYnVmLmxlbmd0aCkgewoJICAgICAgICAgIGJyZWFrOwoJICAgICAgICB9CgkgICAgICAgaXZbaWkrK10gPSBtZF9idWZbaV07CgkgICAgICAgaXZMZW4tLTsKCSAgICAgICBpKys7CgkgICAgIH0KCSAgIH0KCSAgIGlmKGtleUxlbiA9PT0gMCAmJiBpdkxlbiA9PT0gMCkgewoJICAgICAgYnJlYWs7CgkgICAgfQoJICB9CgkgIGZvcihpPTA7aTxtZF9idWYubGVuZ3RoO2krKykgewoJICAgIG1kX2J1ZltpXSA9IDA7CgkgIH0KCSAgcmV0dXJuIHsKCSAgICBrZXk6IGtleSwKCSAgICBpdjogaXYKCSAgfTsKCX07CgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5CdWZmZXIpKQoKLyoqKi8gfSwKLyogNTQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKEJ1ZmZlcikge3ZhciBhZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KTsKCXZhciBUcmFuc2Zvcm0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKTsKCXZhciBpbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpOwoKCWluaGVyaXRzKFN0cmVhbUNpcGhlciwgVHJhbnNmb3JtKTsKCW1vZHVsZS5leHBvcnRzID0gU3RyZWFtQ2lwaGVyOwoJZnVuY3Rpb24gU3RyZWFtQ2lwaGVyKG1vZGUsIGtleSwgaXYsIGRlY3J5cHQpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFN0cmVhbUNpcGhlcikpIHsKCSAgICByZXR1cm4gbmV3IFN0cmVhbUNpcGhlcihtb2RlLCBrZXksIGl2KTsKCSAgfQoJICBUcmFuc2Zvcm0uY2FsbCh0aGlzKTsKCSAgdGhpcy5fY2lwaGVyID0gbmV3IGFlcy5BRVMoa2V5KTsKCSAgdGhpcy5fcHJldiA9IG5ldyBCdWZmZXIoaXYubGVuZ3RoKTsKCSAgdGhpcy5fY2FjaGUgPSBuZXcgQnVmZmVyKCcnKTsKCSAgdGhpcy5fc2VjQ2FjaGUgPSBuZXcgQnVmZmVyKCcnKTsKCSAgdGhpcy5fZGVjcnlwdCA9IGRlY3J5cHQ7CgkgIGl2LmNvcHkodGhpcy5fcHJldik7CgkgIHRoaXMuX21vZGUgPSBtb2RlOwoJfQoJU3RyZWFtQ2lwaGVyLnByb3RvdHlwZS5fdHJhbnNmb3JtID0gZnVuY3Rpb24gKGNodW5rLCBfLCBuZXh0KSB7CgkgIG5leHQobnVsbCwgdGhpcy5fbW9kZS5lbmNyeXB0KHRoaXMsIGNodW5rLCB0aGlzLl9kZWNyeXB0KSk7Cgl9OwoJU3RyZWFtQ2lwaGVyLnByb3RvdHlwZS5fZmx1c2ggPSBmdW5jdGlvbiAobmV4dCkgewoJICB0aGlzLl9jaXBoZXIuc2NydWIoKTsKCSAgbmV4dCgpOwoJfTsKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcikpCgovKioqLyB9LAovKiA1NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCglleHBvcnRzLmVuY3J5cHQgPSBmdW5jdGlvbiAoc2VsZiwgYmxvY2spIHsKCSAgcmV0dXJuIHNlbGYuX2NpcGhlci5lbmNyeXB0QmxvY2soYmxvY2spOwoJfTsKCWV4cG9ydHMuZGVjcnlwdCA9IGZ1bmN0aW9uIChzZWxmLCBibG9jaykgewoJICByZXR1cm4gc2VsZi5fY2lwaGVyLmRlY3J5cHRCbG9jayhibG9jayk7Cgl9OwoKLyoqKi8gfSwKLyogNTYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIHhvciA9IF9fd2VicGFja19yZXF1aXJlX18oNTcpOwoJZXhwb3J0cy5lbmNyeXB0ID0gZnVuY3Rpb24gKHNlbGYsIGJsb2NrKSB7CgkgIHZhciBkYXRhID0geG9yKGJsb2NrLCBzZWxmLl9wcmV2KTsKCSAgc2VsZi5fcHJldiA9IHNlbGYuX2NpcGhlci5lbmNyeXB0QmxvY2soZGF0YSk7CgkgIHJldHVybiBzZWxmLl9wcmV2OwoJfTsKCWV4cG9ydHMuZGVjcnlwdCA9IGZ1bmN0aW9uIChzZWxmLCBibG9jaykgewoJICB2YXIgcGFkID0gc2VsZi5fcHJldjsKCSAgc2VsZi5fcHJldiA9IGJsb2NrOwoJICB2YXIgb3V0ID0gc2VsZi5fY2lwaGVyLmRlY3J5cHRCbG9jayhibG9jayk7CgkgIHJldHVybiB4b3Iob3V0LCBwYWQpOwoJfTsKCi8qKiovIH0sCi8qIDU3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIpIHttb2R1bGUuZXhwb3J0cyA9IHhvcjsKCWZ1bmN0aW9uIHhvcihhLCBiKSB7CgkgIHZhciBsZW4gPSBNYXRoLm1pbihhLmxlbmd0aCwgYi5sZW5ndGgpOwoJICB2YXIgb3V0ID0gbmV3IEJ1ZmZlcihsZW4pOwoJICB2YXIgaSA9IC0xOwoJICB3aGlsZSAoKytpIDwgbGVuKSB7CgkgICAgb3V0LndyaXRlVUludDgoYVtpXSBeIGJbaV0sIGkpOwoJICB9CgkgIHJldHVybiBvdXQ7Cgl9CgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5CdWZmZXIpKQoKLyoqKi8gfSwKLyogNTggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKEJ1ZmZlcikge3ZhciB4b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KTsKCWV4cG9ydHMuZW5jcnlwdCA9IGZ1bmN0aW9uIChzZWxmLCBkYXRhLCBkZWNyeXB0KSB7CgkgIHZhciBvdXQgPSBuZXcgQnVmZmVyKCcnKTsKCSAgdmFyIGxlbjsKCSAgd2hpbGUgKGRhdGEubGVuZ3RoKSB7CgkgICAgaWYgKHNlbGYuX2NhY2hlLmxlbmd0aCA9PT0gMCkgewoJICAgICAgc2VsZi5fY2FjaGUgPSBzZWxmLl9jaXBoZXIuZW5jcnlwdEJsb2NrKHNlbGYuX3ByZXYpOwoJICAgICAgc2VsZi5fcHJldiA9IG5ldyBCdWZmZXIoJycpOwoJICAgIH0KCSAgICBpZiAoc2VsZi5fY2FjaGUubGVuZ3RoIDw9IGRhdGEubGVuZ3RoKSB7CgkgICAgICBsZW4gPSBzZWxmLl9jYWNoZS5sZW5ndGg7CgkgICAgICBvdXQgPSBCdWZmZXIuY29uY2F0KFtvdXQsIGVuY3J5cHRTdGFydChzZWxmLCBkYXRhLnNsaWNlKDAsIGxlbiksIGRlY3J5cHQpXSk7CgkgICAgICBkYXRhID0gZGF0YS5zbGljZShsZW4pOwoJICAgIH0gZWxzZSB7CgkgICAgICBvdXQgPSBCdWZmZXIuY29uY2F0KFtvdXQsIGVuY3J5cHRTdGFydChzZWxmLCBkYXRhLCBkZWNyeXB0KV0pOwoJICAgICAgYnJlYWs7CgkgICAgfQoJICB9CgkgIHJldHVybiBvdXQ7Cgl9OwoJZnVuY3Rpb24gZW5jcnlwdFN0YXJ0KHNlbGYsIGRhdGEsIGRlY3J5cHQpIHsKCSAgdmFyIGxlbiA9IGRhdGEubGVuZ3RoOwoJICB2YXIgb3V0ID0geG9yKGRhdGEsIHNlbGYuX2NhY2hlKTsKCSAgc2VsZi5fY2FjaGUgPSBzZWxmLl9jYWNoZS5zbGljZShsZW4pOwoJICBzZWxmLl9wcmV2ID0gQnVmZmVyLmNvbmNhdChbc2VsZi5fcHJldiwgZGVjcnlwdD9kYXRhOm91dF0pOwoJICByZXR1cm4gb3V0OwoJfQoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oNSkuQnVmZmVyKSkKCi8qKiovIH0sCi8qIDU5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIpIHt2YXIgeG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1Nyk7CglmdW5jdGlvbiBnZXRCbG9jayhzZWxmKSB7CgkgIHNlbGYuX3ByZXYgPSBzZWxmLl9jaXBoZXIuZW5jcnlwdEJsb2NrKHNlbGYuX3ByZXYpOwoJICByZXR1cm4gc2VsZi5fcHJldjsKCX0KCWV4cG9ydHMuZW5jcnlwdCA9IGZ1bmN0aW9uIChzZWxmLCBjaHVuaykgewoJICB3aGlsZSAoc2VsZi5fY2FjaGUubGVuZ3RoIDwgY2h1bmsubGVuZ3RoKSB7CgkgICAgc2VsZi5fY2FjaGUgPSBCdWZmZXIuY29uY2F0KFtzZWxmLl9jYWNoZSwgZ2V0QmxvY2soc2VsZildKTsKCSAgfQoJICB2YXIgcGFkID0gc2VsZi5fY2FjaGUuc2xpY2UoMCwgY2h1bmsubGVuZ3RoKTsKCSAgc2VsZi5fY2FjaGUgPSBzZWxmLl9jYWNoZS5zbGljZShjaHVuay5sZW5ndGgpOwoJICByZXR1cm4geG9yKGNodW5rLCBwYWQpOwoJfTsKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcikpCgovKioqLyB9LAovKiA2MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oQnVmZmVyKSB7dmFyIHhvciA9IF9fd2VicGFja19yZXF1aXJlX18oNTcpOwoJZnVuY3Rpb24gZ2V0QmxvY2soc2VsZikgewoJICB2YXIgb3V0ID0gc2VsZi5fY2lwaGVyLmVuY3J5cHRCbG9jayhzZWxmLl9wcmV2KTsKCSAgaW5jcjMyKHNlbGYuX3ByZXYpOwoJICByZXR1cm4gb3V0OwoJfQoJZXhwb3J0cy5lbmNyeXB0ID0gZnVuY3Rpb24gKHNlbGYsIGNodW5rKSB7CgkgIHdoaWxlIChzZWxmLl9jYWNoZS5sZW5ndGggPCBjaHVuay5sZW5ndGgpIHsKCSAgICBzZWxmLl9jYWNoZSA9IEJ1ZmZlci5jb25jYXQoW3NlbGYuX2NhY2hlLCBnZXRCbG9jayhzZWxmKV0pOwoJICB9CgkgIHZhciBwYWQgPSBzZWxmLl9jYWNoZS5zbGljZSgwLCBjaHVuay5sZW5ndGgpOwoJICBzZWxmLl9jYWNoZSA9IHNlbGYuX2NhY2hlLnNsaWNlKGNodW5rLmxlbmd0aCk7CgkgIHJldHVybiB4b3IoY2h1bmssIHBhZCk7Cgl9OwoJZnVuY3Rpb24gaW5jcjMyKGl2KSB7CgkgIHZhciBsZW4gPSBpdi5sZW5ndGg7CgkgIHZhciBpdGVtOwoJICB3aGlsZSAobGVuLS0pIHsKCSAgICBpdGVtID0gaXYucmVhZFVJbnQ4KGxlbik7CgkgICAgaWYgKGl0ZW0gPT09IDI1NSkgewoJICAgICAgaXYud3JpdGVVSW50OCgwLCBsZW4pOwoJICAgIH0gZWxzZSB7CgkgICAgICBpdGVtKys7CgkgICAgICBpdi53cml0ZVVJbnQ4KGl0ZW0sIGxlbik7CgkgICAgICBicmVhazsKCSAgICB9CgkgIH0KCX0KCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcikpCgovKioqLyB9LAovKiA2MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oQnVmZmVyKSB7dmFyIGFlcyA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpOwoJdmFyIFRyYW5zZm9ybSA9IF9fd2VicGFja19yZXF1aXJlX18oMzApOwoJdmFyIGluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMik7Cgl2YXIgbW9kZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUyKTsKCXZhciBTdHJlYW1DaXBoZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KTsKCXZhciBlYnRrID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1Myk7CgoJaW5oZXJpdHMoRGVjaXBoZXIsIFRyYW5zZm9ybSk7CglmdW5jdGlvbiBEZWNpcGhlcihtb2RlLCBrZXksIGl2KSB7CgkgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBEZWNpcGhlcikpIHsKCSAgICByZXR1cm4gbmV3IERlY2lwaGVyKG1vZGUsIGtleSwgaXYpOwoJICB9CgkgIFRyYW5zZm9ybS5jYWxsKHRoaXMpOwoJICB0aGlzLl9jYWNoZSA9IG5ldyBTcGxpdHRlcigpOwoJICB0aGlzLl9sYXN0ID0gdm9pZCAwOwoJICB0aGlzLl9jaXBoZXIgPSBuZXcgYWVzLkFFUyhrZXkpOwoJICB0aGlzLl9wcmV2ID0gbmV3IEJ1ZmZlcihpdi5sZW5ndGgpOwoJICBpdi5jb3B5KHRoaXMuX3ByZXYpOwoJICB0aGlzLl9tb2RlID0gbW9kZTsKCX0KCURlY2lwaGVyLnByb3RvdHlwZS5fdHJhbnNmb3JtID0gZnVuY3Rpb24gKGRhdGEsIF8sIG5leHQpIHsKCSAgdGhpcy5fY2FjaGUuYWRkKGRhdGEpOwoJICB2YXIgY2h1bms7CgkgIHZhciB0aGluZzsKCSAgd2hpbGUgKChjaHVuayA9IHRoaXMuX2NhY2hlLmdldCgpKSkgewoJICAgIHRoaW5nID0gdGhpcy5fbW9kZS5kZWNyeXB0KHRoaXMsIGNodW5rKTsKCSAgICB0aGlzLnB1c2godGhpbmcpOwoJICB9CgkgIG5leHQoKTsKCX07CglEZWNpcGhlci5wcm90b3R5cGUuX2ZsdXNoID0gZnVuY3Rpb24gKG5leHQpIHsKCSAgdmFyIGNodW5rID0gdGhpcy5fY2FjaGUuZmx1c2goKTsKCSAgaWYgKCFjaHVuaykgewoJICAgIHJldHVybiBuZXh0OwoJICB9CgoJICB0aGlzLnB1c2godW5wYWQodGhpcy5fbW9kZS5kZWNyeXB0KHRoaXMsIGNodW5rKSkpOwoKCSAgbmV4dCgpOwoJfTsKCglmdW5jdGlvbiBTcGxpdHRlcigpIHsKCSAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBTcGxpdHRlcikpIHsKCSAgICByZXR1cm4gbmV3IFNwbGl0dGVyKCk7CgkgIH0KCSAgdGhpcy5jYWNoZSA9IG5ldyBCdWZmZXIoJycpOwoJfQoJU3BsaXR0ZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChkYXRhKSB7CgkgIHRoaXMuY2FjaGUgPSBCdWZmZXIuY29uY2F0KFt0aGlzLmNhY2hlLCBkYXRhXSk7Cgl9OwoKCVNwbGl0dGVyLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoKSB7CgkgIGlmICh0aGlzLmNhY2hlLmxlbmd0aCA+IDE2KSB7CgkgICAgdmFyIG91dCA9IHRoaXMuY2FjaGUuc2xpY2UoMCwgMTYpOwoJICAgIHRoaXMuY2FjaGUgPSB0aGlzLmNhY2hlLnNsaWNlKDE2KTsKCSAgICByZXR1cm4gb3V0OwoJICB9CgkgIHJldHVybiBudWxsOwoJfTsKCVNwbGl0dGVyLnByb3RvdHlwZS5mbHVzaCA9IGZ1bmN0aW9uICgpIHsKCSAgaWYgKHRoaXMuY2FjaGUubGVuZ3RoKSB7CgkgICAgcmV0dXJuIHRoaXMuY2FjaGU7CgkgIH0KCX07CglmdW5jdGlvbiB1bnBhZChsYXN0KSB7CgkgIHZhciBwYWRkZWQgPSBsYXN0WzE1XTsKCSAgaWYgKHBhZGRlZCA9PT0gMTYpIHsKCSAgICByZXR1cm47CgkgIH0KCSAgcmV0dXJuIGxhc3Quc2xpY2UoMCwgMTYgLSBwYWRkZWQpOwoJfQoKCXZhciBtb2RlbGlzdCA9IHsKCSAgRUNCOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KSwKCSAgQ0JDOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDU2KSwKCSAgQ0ZCOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDU4KSwKCSAgT0ZCOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KSwKCSAgQ1RSOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDYwKQoJfTsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChjcnlwdG8pIHsKCSAgZnVuY3Rpb24gY3JlYXRlRGVjaXBoZXJpdihzdWl0ZSwgcGFzc3dvcmQsIGl2KSB7CgkgICAgdmFyIGNvbmZpZyA9IG1vZGVzW3N1aXRlXTsKCSAgICBpZiAoIWNvbmZpZykgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaW52YWxpZCBzdWl0ZSB0eXBlJyk7CgkgICAgfQoJICAgIGlmICh0eXBlb2YgaXYgPT09ICdzdHJpbmcnKSB7CgkgICAgICBpdiA9IG5ldyBCdWZmZXIoaXYpOwoJICAgIH0KCSAgICBpZiAodHlwZW9mIHBhc3N3b3JkID09PSAnc3RyaW5nJykgewoJICAgICAgcGFzc3dvcmQgPSBuZXcgQnVmZmVyKHBhc3N3b3JkKTsKCSAgICB9CgkgICAgaWYgKHBhc3N3b3JkLmxlbmd0aCAhPT0gY29uZmlnLmtleS84KSB7CgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnZhbGlkIGtleSBsZW5ndGggJyArIHBhc3N3b3JkLmxlbmd0aCk7CgkgICAgfQoJICAgIGlmIChpdi5sZW5ndGggIT09IGNvbmZpZy5pdikgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaW52YWxpZCBpdiBsZW5ndGggJyArIGl2Lmxlbmd0aCk7CgkgICAgfQoJICAgIGlmIChjb25maWcudHlwZSA9PT0gJ3N0cmVhbScpIHsKCSAgICAgIHJldHVybiBuZXcgU3RyZWFtQ2lwaGVyKG1vZGVsaXN0W2NvbmZpZy5tb2RlXSwgcGFzc3dvcmQsIGl2LCB0cnVlKTsKCSAgICB9CgkgICAgcmV0dXJuIG5ldyBEZWNpcGhlcihtb2RlbGlzdFtjb25maWcubW9kZV0sIHBhc3N3b3JkLCBpdik7CgkgIH0KCgkgIGZ1bmN0aW9uIGNyZWF0ZURlY2lwaGVyIChzdWl0ZSwgcGFzc3dvcmQpIHsKCSAgICB2YXIgY29uZmlnID0gbW9kZXNbc3VpdGVdOwoJICAgIGlmICghY29uZmlnKSB7CgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnZhbGlkIHN1aXRlIHR5cGUnKTsKCSAgICB9CgkgICAgdmFyIGtleXMgPSBlYnRrKGNyeXB0bywgcGFzc3dvcmQsIGNvbmZpZy5rZXksIGNvbmZpZy5pdik7CgkgICAgcmV0dXJuIGNyZWF0ZURlY2lwaGVyaXYoc3VpdGUsIGtleXMua2V5LCBrZXlzLml2KTsKCSAgfQoJICByZXR1cm4gewoJICAgIGNyZWF0ZURlY2lwaGVyOiBjcmVhdGVEZWNpcGhlciwKCSAgICBjcmVhdGVEZWNpcGhlcml2OiBjcmVhdGVEZWNpcGhlcml2CgkgIH07Cgl9OwoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcikpCgovKioqLyB9LAovKiA2MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkndXNlIHN0cmljdCc7CgoJdmFyIGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7CgoJLyoqCgkgKiBBbiBhdXRvIGluY3JlbWVudGluZyBpZCB3aGljaCB3ZSBjYW4gdXNlIHRvIGNyZWF0ZSAidW5pcXVlIiBVbHRyb24gaW5zdGFuY2VzCgkgKiBzbyB3ZSBjYW4gdHJhY2sgdGhlIGV2ZW50IGVtaXR0ZXJzIHRoYXQgYXJlIGFkZGVkIHRocm91Z2ggdGhlIFVsdHJvbgoJICogaW50ZXJmYWNlLgoJICoKCSAqIEB0eXBlIHtOdW1iZXJ9CgkgKiBAcHJpdmF0ZQoJICovCgl2YXIgaWQgPSAwOwoKCS8qKgoJICogVWx0cm9uIGlzIGhpZ2gtaW50ZWxsaWdlbmNlIHJvYm90LiBJdCBnYXRoZXJzIGludGVsbGlnZW5jZSBzbyBpdCBjYW4gc3RhcnQgaW1wcm92aW5nCgkgKiB1cG9uIGhpcyBydWRpbWVudGFyeSBkZXNpZ24uIEl0IHdpbGwgbGVhcm4gZnJvbSB5b3VyIEV2ZW50RW1pdHRpbmcgcGF0dGVybnMKCSAqIGFuZCBleHRlcm1pbmF0ZSB0aGVtLgoJICoKCSAqIEBjb25zdHJ1Y3RvcgoJICogQHBhcmFtIHtFdmVudEVtaXR0ZXJ9IGVlIEV2ZW50RW1pdHRlciBpbnN0YW5jZSB3ZSBuZWVkIHRvIHdyYXAuCgkgKiBAYXBpIHB1YmxpYwoJICovCglmdW5jdGlvbiBVbHRyb24oZWUpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFVsdHJvbikpIHJldHVybiBuZXcgVWx0cm9uKGVlKTsKCgkgIHRoaXMuaWQgPSBpZCsrOwoJICB0aGlzLmVlID0gZWU7Cgl9CgoJLyoqCgkgKiBSZWdpc3RlciBhIG5ldyBFdmVudExpc3RlbmVyIGZvciB0aGUgZ2l2ZW4gZXZlbnQuCgkgKgoJICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50IE5hbWUgb2YgdGhlIGV2ZW50LgoJICogQHBhcmFtIHtGdW5jdG9ufSBmbiBDYWxsYmFjayBmdW5jdGlvbi4KCSAqIEBwYXJhbSB7TWl4ZWR9IGNvbnRleHQgVGhlIGNvbnRleHQgb2YgdGhlIGZ1bmN0aW9uLgoJICogQHJldHVybnMge1VsdHJvbn0KCSAqIEBhcGkgcHVibGljCgkgKi8KCVVsdHJvbi5wcm90b3R5cGUub24gPSBmdW5jdGlvbiBvbihldmVudCwgZm4sIGNvbnRleHQpIHsKCSAgZm4uX191bHRyb24gPSB0aGlzLmlkOwoJICB0aGlzLmVlLm9uKGV2ZW50LCBmbiwgY29udGV4dCk7CgoJICByZXR1cm4gdGhpczsKCX07CgkvKioKCSAqIEFkZCBhbiBFdmVudExpc3RlbmVyIHRoYXQncyBvbmx5IGNhbGxlZCBvbmNlLgoJICoKCSAqIEBwYXJhbSB7U3RyaW5nfSBldmVudCBOYW1lIG9mIHRoZSBldmVudC4KCSAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIENhbGxiYWNrIGZ1bmN0aW9uLgoJICogQHBhcmFtIHtNaXhlZH0gY29udGV4dCBUaGUgY29udGV4dCBvZiB0aGUgZnVuY3Rpb24uCgkgKiBAcmV0dXJucyB7VWx0cm9ufQoJICogQGFwaSBwdWJsaWMKCSAqLwoJVWx0cm9uLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24gb25jZShldmVudCwgZm4sIGNvbnRleHQpIHsKCSAgZm4uX191bHRyb24gPSB0aGlzLmlkOwoJICB0aGlzLmVlLm9uY2UoZXZlbnQsIGZuLCBjb250ZXh0KTsKCgkgIHJldHVybiB0aGlzOwoJfTsKCgkvKioKCSAqIFJlbW92ZSB0aGUgbGlzdGVuZXJzIHdlIGFzc2lnbmVkIGZvciB0aGUgZ2l2ZW4gZXZlbnQuCgkgKgoJICogQHJldHVybnMge1VsdHJvbn0KCSAqIEBhcGkgcHVibGljCgkgKi8KCVVsdHJvbi5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKCkgewoJICB2YXIgYXJncyA9IGFyZ3VtZW50cwoJICAgICwgZWUgPSB0aGlzLmVlCgkgICAgLCBldmVudDsKCgkgIC8vCgkgIC8vIFdoZW4gbm8gZXZlbnQgbmFtZXMgYXJlIHByb3ZpZGVkIHdlIGFzc3VtZSB0aGF0IHdlIG5lZWQgdG8gY2xlYXIgYWxsIHRoZQoJICAvLyBldmVudHMgdGhhdCB3ZXJlIGFzc2lnbmVkIHRocm91Z2ggdXMuCgkgIC8vCgkgIGlmIChhcmdzLmxlbmd0aCA9PT0gMSAmJiAnc3RyaW5nJyA9PT0gdHlwZW9mIGFyZ3NbMF0pIHsKCSAgICBhcmdzID0gYXJnc1swXS5zcGxpdCgvWywgXSsvKTsKCSAgfSBlbHNlIGlmICghYXJncy5sZW5ndGgpIHsKCSAgICBpZiAoZWUuZXZlbnROYW1lcykgewoJICAgICAgYXJncyA9IGVlLmV2ZW50TmFtZXMoKTsKCSAgICB9IGVsc2UgaWYgKGVlLl9ldmVudHMpIHsKCSAgICAgIGFyZ3MgPSBbXTsKCgkgICAgICBmb3IgKGV2ZW50IGluIGVlLl9ldmVudHMpIHsKCSAgICAgICAgaWYgKGhhcy5jYWxsKGVlLl9ldmVudHMsIGV2ZW50KSkgYXJncy5wdXNoKGV2ZW50KTsKCSAgICAgIH0KCgkgICAgICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewoJICAgICAgICBhcmdzID0gYXJncy5jb25jYXQoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlZS5fZXZlbnRzKSk7CgkgICAgICB9CgkgICAgfQoJICB9CgoJICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHsKCSAgICB2YXIgbGlzdGVuZXJzID0gZWUubGlzdGVuZXJzKGFyZ3NbaV0pOwoKCSAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxpc3RlbmVycy5sZW5ndGg7IGorKykgewoJICAgICAgZXZlbnQgPSBsaXN0ZW5lcnNbal07CgoJICAgICAgLy8KCSAgICAgIC8vIE9uY2UgbGlzdGVuZXJzIGhhdmUgYSBgbGlzdGVuZXJgIHByb3BlcnR5IHRoYXQgc3RvcmVzIHRoZSByZWFsIGxpc3RlbmVyCgkgICAgICAvLyBpbiB0aGUgRXZlbnRFbWl0dGVyIHRoYXQgc2hpcHMgd2l0aCBOb2RlLmpzLgoJICAgICAgLy8KCSAgICAgIGlmIChldmVudC5saXN0ZW5lcikgewoJICAgICAgICBpZiAoZXZlbnQubGlzdGVuZXIuX191bHRyb24gIT09IHRoaXMuaWQpIGNvbnRpbnVlOwoJICAgICAgICBkZWxldGUgZXZlbnQubGlzdGVuZXIuX191bHRyb247CgkgICAgICB9IGVsc2UgewoJICAgICAgICBpZiAoZXZlbnQuX191bHRyb24gIT09IHRoaXMuaWQpIGNvbnRpbnVlOwoJICAgICAgICBkZWxldGUgZXZlbnQuX191bHRyb247CgkgICAgICB9CgoJICAgICAgZWUucmVtb3ZlTGlzdGVuZXIoYXJnc1tpXSwgZXZlbnQpOwoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCS8qKgoJICogRGVzdHJveSB0aGUgVWx0cm9uIGluc3RhbmNlLCByZW1vdmUgYWxsIGxpc3RlbmVycyBhbmQgcmVsZWFzZSBhbGwgcmVmZXJlbmNlcy4KCSAqCgkgKiBAcmV0dXJucyB7Qm9vbGVhbn0KCSAqIEBhcGkgcHVibGljCgkgKi8KCVVsdHJvbi5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uIGRlc3Ryb3koKSB7CgkgIGlmICghdGhpcy5lZSkgcmV0dXJuIGZhbHNlOwoKCSAgdGhpcy5yZW1vdmUoKTsKCSAgdGhpcy5lZSA9IG51bGw7CgoJICByZXR1cm4gdHJ1ZTsKCX07CgoJLy8KCS8vIEV4cG9zZSB0aGUgbW9kdWxlLgoJLy8KCW1vZHVsZS5leHBvcnRzID0gVWx0cm9uOwoKCi8qKiovIH0sCi8qIDYzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBodHRwID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2NCk7CgoJdmFyIGh0dHBzID0gbW9kdWxlLmV4cG9ydHM7CgoJZm9yICh2YXIga2V5IGluIGh0dHApIHsKCSAgICBpZiAoaHR0cC5oYXNPd25Qcm9wZXJ0eShrZXkpKSBodHRwc1trZXldID0gaHR0cFtrZXldOwoJfTsKCglodHRwcy5yZXF1ZXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2IpIHsKCSAgICBpZiAoIXBhcmFtcykgcGFyYW1zID0ge307CgkgICAgcGFyYW1zLnNjaGVtZSA9ICdodHRwcyc7CgkgICAgcGFyYW1zLnByb3RvY29sID0gJ2h0dHBzOic7CgkgICAgcmV0dXJuIGh0dHAucmVxdWVzdC5jYWxsKHRoaXMsIHBhcmFtcywgY2IpOwoJfQoKCi8qKiovIH0sCi8qIDY0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHt2YXIgQ2xpZW50UmVxdWVzdCA9IF9fd2VicGFja19yZXF1aXJlX18oNjUpCgl2YXIgZXh0ZW5kID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OSkKCXZhciBzdGF0dXNDb2RlcyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApCgl2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSkKCgl2YXIgaHR0cCA9IGV4cG9ydHMKCglodHRwLnJlcXVlc3QgPSBmdW5jdGlvbiAob3B0cywgY2IpIHsKCQlpZiAodHlwZW9mIG9wdHMgPT09ICdzdHJpbmcnKQoJCQlvcHRzID0gdXJsLnBhcnNlKG9wdHMpCgkJZWxzZQoJCQlvcHRzID0gZXh0ZW5kKG9wdHMpCgoJCS8vIE5vcm1hbGx5LCB0aGUgcGFnZSBpcyBsb2FkZWQgZnJvbSBodHRwIG9yIGh0dHBzLCBzbyBub3Qgc3BlY2lmeWluZyBhIHByb3RvY29sCgkJLy8gd2lsbCByZXN1bHQgaW4gYSAodmFsaWQpIHByb3RvY29sLXJlbGF0aXZlIHVybC4gSG93ZXZlciwgdGhpcyB3b24ndCB3b3JrIGlmCgkJLy8gdGhlIHByb3RvY29sIGlzIHNvbWV0aGluZyBlbHNlLCBsaWtlICdmaWxlOicKCQl2YXIgZGVmYXVsdFByb3RvY29sID0gZ2xvYmFsLmxvY2F0aW9uLnByb3RvY29sLnNlYXJjaCgvXmh0dHBzPzokLykgPT09IC0xID8gJ2h0dHA6JyA6ICcnCgoJCXZhciBwcm90b2NvbCA9IG9wdHMucHJvdG9jb2wgfHwgZGVmYXVsdFByb3RvY29sCgkJdmFyIGhvc3QgPSBvcHRzLmhvc3RuYW1lIHx8IG9wdHMuaG9zdAoJCXZhciBwb3J0ID0gb3B0cy5wb3J0CgkJdmFyIHBhdGggPSBvcHRzLnBhdGggfHwgJy8nCgoJCS8vIE5lY2Vzc2FyeSBmb3IgSVB2NiBhZGRyZXNzZXMKCQlpZiAoaG9zdCAmJiBob3N0LmluZGV4T2YoJzonKSAhPT0gLTEpCgkJCWhvc3QgPSAnWycgKyBob3N0ICsgJ10nCgoJCS8vIFRoaXMgbWF5IGJlIGEgcmVsYXRpdmUgdXJsLiBUaGUgYnJvd3NlciBzaG91bGQgYWx3YXlzIGJlIGFibGUgdG8gaW50ZXJwcmV0IGl0IGNvcnJlY3RseS4KCQlvcHRzLnVybCA9IChob3N0ID8gKHByb3RvY29sICsgJy8vJyArIGhvc3QpIDogJycpICsgKHBvcnQgPyAnOicgKyBwb3J0IDogJycpICsgcGF0aAoJCW9wdHMubWV0aG9kID0gKG9wdHMubWV0aG9kIHx8ICdHRVQnKS50b1VwcGVyQ2FzZSgpCgkJb3B0cy5oZWFkZXJzID0gb3B0cy5oZWFkZXJzIHx8IHt9CgoJCS8vIEFsc28gdmFsaWQgb3B0cy5hdXRoLCBvcHRzLm1vZGUKCgkJdmFyIHJlcSA9IG5ldyBDbGllbnRSZXF1ZXN0KG9wdHMpCgkJaWYgKGNiKQoJCQlyZXEub24oJ3Jlc3BvbnNlJywgY2IpCgkJcmV0dXJuIHJlcQoJfQoKCWh0dHAuZ2V0ID0gZnVuY3Rpb24gZ2V0IChvcHRzLCBjYikgewoJCXZhciByZXEgPSBodHRwLnJlcXVlc3Qob3B0cywgY2IpCgkJcmVxLmVuZCgpCgkJcmV0dXJuIHJlcQoJfQoKCWh0dHAuQWdlbnQgPSBmdW5jdGlvbiAoKSB7fQoJaHR0cC5BZ2VudC5kZWZhdWx0TWF4U29ja2V0cyA9IDQKCglodHRwLlNUQVRVU19DT0RFUyA9IHN0YXR1c0NvZGVzCgoJaHR0cC5NRVRIT0RTID0gWwoJCSdDSEVDS09VVCcsCgkJJ0NPTk5FQ1QnLAoJCSdDT1BZJywKCQknREVMRVRFJywKCQknR0VUJywKCQknSEVBRCcsCgkJJ0xPQ0snLAoJCSdNLVNFQVJDSCcsCgkJJ01FUkdFJywKCQknTUtBQ1RJVklUWScsCgkJJ01LQ09MJywKCQknTU9WRScsCgkJJ05PVElGWScsCgkJJ09QVElPTlMnLAoJCSdQQVRDSCcsCgkJJ1BPU1QnLAoJCSdQUk9QRklORCcsCgkJJ1BST1BQQVRDSCcsCgkJJ1BVUkdFJywKCQknUFVUJywKCQknUkVQT1JUJywKCQknU0VBUkNIJywKCQknU1VCU0NSSUJFJywKCQknVFJBQ0UnLAoJCSdVTkxPQ0snLAoJCSdVTlNVQlNDUklCRScKCV0KCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSkKCi8qKiovIH0sCi8qIDY1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIsIGdsb2JhbCwgcHJvY2Vzcykge3ZhciBjYXBhYmlsaXR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2NikKCXZhciBpbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCgl2YXIgcmVzcG9uc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KQoJdmFyIHN0cmVhbSA9IF9fd2VicGFja19yZXF1aXJlX18oMzMpCgl2YXIgdG9BcnJheUJ1ZmZlciA9IF9fd2VicGFja19yZXF1aXJlX18oNjgpCgoJdmFyIEluY29taW5nTWVzc2FnZSA9IHJlc3BvbnNlLkluY29taW5nTWVzc2FnZQoJdmFyIHJTdGF0ZXMgPSByZXNwb25zZS5yZWFkeVN0YXRlcwoKCWZ1bmN0aW9uIGRlY2lkZU1vZGUgKHByZWZlckJpbmFyeSwgdXNlRmV0Y2gpIHsKCQlpZiAoY2FwYWJpbGl0eS5mZXRjaCAmJiB1c2VGZXRjaCkgewoJCQlyZXR1cm4gJ2ZldGNoJwoJCX0gZWxzZSBpZiAoY2FwYWJpbGl0eS5tb3pjaHVua2VkYXJyYXlidWZmZXIpIHsKCQkJcmV0dXJuICdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcicKCQl9IGVsc2UgaWYgKGNhcGFiaWxpdHkubXNzdHJlYW0pIHsKCQkJcmV0dXJuICdtcy1zdHJlYW0nCgkJfSBlbHNlIGlmIChjYXBhYmlsaXR5LmFycmF5YnVmZmVyICYmIHByZWZlckJpbmFyeSkgewoJCQlyZXR1cm4gJ2FycmF5YnVmZmVyJwoJCX0gZWxzZSBpZiAoY2FwYWJpbGl0eS52YkFycmF5ICYmIHByZWZlckJpbmFyeSkgewoJCQlyZXR1cm4gJ3RleHQ6dmJhcnJheScKCQl9IGVsc2UgewoJCQlyZXR1cm4gJ3RleHQnCgkJfQoJfQoKCXZhciBDbGllbnRSZXF1ZXN0ID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob3B0cykgewoJCXZhciBzZWxmID0gdGhpcwoJCXN0cmVhbS5Xcml0YWJsZS5jYWxsKHNlbGYpCgoJCXNlbGYuX29wdHMgPSBvcHRzCgkJc2VsZi5fYm9keSA9IFtdCgkJc2VsZi5faGVhZGVycyA9IHt9CgkJaWYgKG9wdHMuYXV0aCkKCQkJc2VsZi5zZXRIZWFkZXIoJ0F1dGhvcml6YXRpb24nLCAnQmFzaWMgJyArIG5ldyBCdWZmZXIob3B0cy5hdXRoKS50b1N0cmluZygnYmFzZTY0JykpCgkJT2JqZWN0LmtleXMob3B0cy5oZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CgkJCXNlbGYuc2V0SGVhZGVyKG5hbWUsIG9wdHMuaGVhZGVyc1tuYW1lXSkKCQl9KQoKCQl2YXIgcHJlZmVyQmluYXJ5CgkJdmFyIHVzZUZldGNoID0gdHJ1ZQoJCWlmIChvcHRzLm1vZGUgPT09ICdkaXNhYmxlLWZldGNoJyB8fCAndGltZW91dCcgaW4gb3B0cykgewoJCQkvLyBJZiB0aGUgdXNlIG9mIFhIUiBzaG91bGQgYmUgcHJlZmVycmVkIGFuZCBpbmNsdWRlcyBwcmVzZXJ2aW5nIHRoZSAnY29udGVudC10eXBlJyBoZWFkZXIuCgkJCS8vIEZvcmNlIFhIUiB0byBiZSB1c2VkIHNpbmNlIHRoZSBGZXRjaCBBUEkgZG9lcyBub3QgeWV0IHN1cHBvcnQgdGltZW91dHMuCgkJCXVzZUZldGNoID0gZmFsc2UKCQkJcHJlZmVyQmluYXJ5ID0gdHJ1ZQoJCX0gZWxzZSBpZiAob3B0cy5tb2RlID09PSAncHJlZmVyLXN0cmVhbWluZycpIHsKCQkJLy8gSWYgc3RyZWFtaW5nIGlzIGEgaGlnaCBwcmlvcml0eSBidXQgYmluYXJ5IGNvbXBhdGliaWxpdHkgYW5kCgkJCS8vIHRoZSBhY2N1cmFjeSBvZiB0aGUgJ2NvbnRlbnQtdHlwZScgaGVhZGVyIGFyZW4ndAoJCQlwcmVmZXJCaW5hcnkgPSBmYWxzZQoJCX0gZWxzZSBpZiAob3B0cy5tb2RlID09PSAnYWxsb3ctd3JvbmctY29udGVudC10eXBlJykgewoJCQkvLyBJZiBzdHJlYW1pbmcgaXMgbW9yZSBpbXBvcnRhbnQgdGhhbiBwcmVzZXJ2aW5nIHRoZSAnY29udGVudC10eXBlJyBoZWFkZXIKCQkJcHJlZmVyQmluYXJ5ID0gIWNhcGFiaWxpdHkub3ZlcnJpZGVNaW1lVHlwZQoJCX0gZWxzZSBpZiAoIW9wdHMubW9kZSB8fCBvcHRzLm1vZGUgPT09ICdkZWZhdWx0JyB8fCBvcHRzLm1vZGUgPT09ICdwcmVmZXItZmFzdCcpIHsKCQkJLy8gVXNlIGJpbmFyeSBpZiB0ZXh0IHN0cmVhbWluZyBtYXkgY29ycnVwdCBkYXRhIG9yIHRoZSBjb250ZW50LXR5cGUgaGVhZGVyLCBvciBmb3Igc3BlZWQKCQkJcHJlZmVyQmluYXJ5ID0gdHJ1ZQoJCX0gZWxzZSB7CgkJCXRocm93IG5ldyBFcnJvcignSW52YWxpZCB2YWx1ZSBmb3Igb3B0cy5tb2RlJykKCQl9CgkJc2VsZi5fbW9kZSA9IGRlY2lkZU1vZGUocHJlZmVyQmluYXJ5LCB1c2VGZXRjaCkKCgkJc2VsZi5vbignZmluaXNoJywgZnVuY3Rpb24gKCkgewoJCQlzZWxmLl9vbkZpbmlzaCgpCgkJfSkKCX0KCglpbmhlcml0cyhDbGllbnRSZXF1ZXN0LCBzdHJlYW0uV3JpdGFibGUpCgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuc2V0SGVhZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJdmFyIGxvd2VyTmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKQoJCS8vIFRoaXMgY2hlY2sgaXMgbm90IG5lY2Vzc2FyeSwgYnV0IGl0IHByZXZlbnRzIHdhcm5pbmdzIGZyb20gYnJvd3NlcnMgYWJvdXQgc2V0dGluZyB1bnNhZmUKCQkvLyBoZWFkZXJzLiBUbyBiZSBob25lc3QgSSdtIG5vdCBlbnRpcmVseSBzdXJlIGhpZGluZyB0aGVzZSB3YXJuaW5ncyBpcyBhIGdvb2QgdGhpbmcsIGJ1dAoJCS8vIGh0dHAtYnJvd3NlcmlmeSBkaWQgaXQsIHNvIEkgd2lsbCB0b28uCgkJaWYgKHVuc2FmZUhlYWRlcnMuaW5kZXhPZihsb3dlck5hbWUpICE9PSAtMSkKCQkJcmV0dXJuCgoJCXNlbGYuX2hlYWRlcnNbbG93ZXJOYW1lXSA9IHsKCQkJbmFtZTogbmFtZSwKCQkJdmFsdWU6IHZhbHVlCgkJfQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLmdldEhlYWRlciA9IGZ1bmN0aW9uIChuYW1lKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJcmV0dXJuIHNlbGYuX2hlYWRlcnNbbmFtZS50b0xvd2VyQ2FzZSgpXS52YWx1ZQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLnJlbW92ZUhlYWRlciA9IGZ1bmN0aW9uIChuYW1lKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJZGVsZXRlIHNlbGYuX2hlYWRlcnNbbmFtZS50b0xvd2VyQ2FzZSgpXQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLl9vbkZpbmlzaCA9IGZ1bmN0aW9uICgpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCgkJaWYgKHNlbGYuX2Rlc3Ryb3llZCkKCQkJcmV0dXJuCgkJdmFyIG9wdHMgPSBzZWxmLl9vcHRzCgoJCXZhciBoZWFkZXJzT2JqID0gc2VsZi5faGVhZGVycwoJCXZhciBib2R5ID0gbnVsbAoJCWlmIChvcHRzLm1ldGhvZCA9PT0gJ1BPU1QnIHx8IG9wdHMubWV0aG9kID09PSAnUFVUJyB8fCBvcHRzLm1ldGhvZCA9PT0gJ1BBVENIJyB8fCBvcHRzLm1ldGhvZCA9PT0gJ01FUkdFJykgewoJCQlpZiAoY2FwYWJpbGl0eS5ibG9iQ29uc3RydWN0b3IpIHsKCQkJCWJvZHkgPSBuZXcgZ2xvYmFsLkJsb2Ioc2VsZi5fYm9keS5tYXAoZnVuY3Rpb24gKGJ1ZmZlcikgewoJCQkJCXJldHVybiB0b0FycmF5QnVmZmVyKGJ1ZmZlcikKCQkJCX0pLCB7CgkJCQkJdHlwZTogKGhlYWRlcnNPYmpbJ2NvbnRlbnQtdHlwZSddIHx8IHt9KS52YWx1ZSB8fCAnJwoJCQkJfSkKCQkJfSBlbHNlIHsKCQkJCS8vIGdldCB1dGY4IHN0cmluZwoJCQkJYm9keSA9IEJ1ZmZlci5jb25jYXQoc2VsZi5fYm9keSkudG9TdHJpbmcoKQoJCQl9CgkJfQoKCQlpZiAoc2VsZi5fbW9kZSA9PT0gJ2ZldGNoJykgewoJCQl2YXIgaGVhZGVycyA9IE9iamVjdC5rZXlzKGhlYWRlcnNPYmopLm1hcChmdW5jdGlvbiAobmFtZSkgewoJCQkJcmV0dXJuIFtoZWFkZXJzT2JqW25hbWVdLm5hbWUsIGhlYWRlcnNPYmpbbmFtZV0udmFsdWVdCgkJCX0pCgoJCQlnbG9iYWwuZmV0Y2goc2VsZi5fb3B0cy51cmwsIHsKCQkJCW1ldGhvZDogc2VsZi5fb3B0cy5tZXRob2QsCgkJCQloZWFkZXJzOiBoZWFkZXJzLAoJCQkJYm9keTogYm9keSB8fCB1bmRlZmluZWQsCgkJCQltb2RlOiAnY29ycycsCgkJCQljcmVkZW50aWFsczogb3B0cy53aXRoQ3JlZGVudGlhbHMgPyAnaW5jbHVkZScgOiAnc2FtZS1vcmlnaW4nCgkJCX0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CgkJCQlzZWxmLl9mZXRjaFJlc3BvbnNlID0gcmVzcG9uc2UKCQkJCXNlbGYuX2Nvbm5lY3QoKQoJCQl9LCBmdW5jdGlvbiAocmVhc29uKSB7CgkJCQlzZWxmLmVtaXQoJ2Vycm9yJywgcmVhc29uKQoJCQl9KQoJCX0gZWxzZSB7CgkJCXZhciB4aHIgPSBzZWxmLl94aHIgPSBuZXcgZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0KCkKCQkJdHJ5IHsKCQkJCXhoci5vcGVuKHNlbGYuX29wdHMubWV0aG9kLCBzZWxmLl9vcHRzLnVybCwgdHJ1ZSkKCQkJfSBjYXRjaCAoZXJyKSB7CgkJCQlwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsKCQkJCQlzZWxmLmVtaXQoJ2Vycm9yJywgZXJyKQoJCQkJfSkKCQkJCXJldHVybgoJCQl9CgoJCQkvLyBDYW4ndCBzZXQgcmVzcG9uc2VUeXBlIG9uIHJlYWxseSBvbGQgYnJvd3NlcnMKCQkJaWYgKCdyZXNwb25zZVR5cGUnIGluIHhocikKCQkJCXhoci5yZXNwb25zZVR5cGUgPSBzZWxmLl9tb2RlLnNwbGl0KCc6JylbMF0KCgkJCWlmICgnd2l0aENyZWRlbnRpYWxzJyBpbiB4aHIpCgkJCQl4aHIud2l0aENyZWRlbnRpYWxzID0gISFvcHRzLndpdGhDcmVkZW50aWFscwoKCQkJaWYgKHNlbGYuX21vZGUgPT09ICd0ZXh0JyAmJiAnb3ZlcnJpZGVNaW1lVHlwZScgaW4geGhyKQoJCQkJeGhyLm92ZXJyaWRlTWltZVR5cGUoJ3RleHQvcGxhaW47IGNoYXJzZXQ9eC11c2VyLWRlZmluZWQnKQoKCQkJaWYgKCd0aW1lb3V0JyBpbiBvcHRzKSB7CgkJCQl4aHIudGltZW91dCA9IG9wdHMudGltZW91dAoJCQkJeGhyLm9udGltZW91dCA9IGZ1bmN0aW9uICgpIHsKCQkJCQlzZWxmLmVtaXQoJ3RpbWVvdXQnKQoJCQkJfQoJCQl9CgoJCQlPYmplY3Qua2V5cyhoZWFkZXJzT2JqKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CgkJCQl4aHIuc2V0UmVxdWVzdEhlYWRlcihoZWFkZXJzT2JqW25hbWVdLm5hbWUsIGhlYWRlcnNPYmpbbmFtZV0udmFsdWUpCgkJCX0pCgoJCQlzZWxmLl9yZXNwb25zZSA9IG51bGwKCQkJeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKCQkJCXN3aXRjaCAoeGhyLnJlYWR5U3RhdGUpIHsKCQkJCQljYXNlIHJTdGF0ZXMuTE9BRElORzoKCQkJCQljYXNlIHJTdGF0ZXMuRE9ORToKCQkJCQkJc2VsZi5fb25YSFJQcm9ncmVzcygpCgkJCQkJCWJyZWFrCgkJCQl9CgkJCX0KCQkJLy8gTmVjZXNzYXJ5IGZvciBzdHJlYW1pbmcgaW4gRmlyZWZveCwgc2luY2UgeGhyLnJlc3BvbnNlIGlzIE9OTFkgZGVmaW5lZAoJCQkvLyBpbiBvbnByb2dyZXNzLCBub3QgaW4gb25yZWFkeXN0YXRlY2hhbmdlIHdpdGggeGhyLnJlYWR5U3RhdGUgPSAzCgkJCWlmIChzZWxmLl9tb2RlID09PSAnbW96LWNodW5rZWQtYXJyYXlidWZmZXInKSB7CgkJCQl4aHIub25wcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHsKCQkJCQlzZWxmLl9vblhIUlByb2dyZXNzKCkKCQkJCX0KCQkJfQoKCQkJeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7CgkJCQlpZiAoc2VsZi5fZGVzdHJveWVkKQoJCQkJCXJldHVybgoJCQkJc2VsZi5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignWEhSIGVycm9yJykpCgkJCX0KCgkJCXRyeSB7CgkJCQl4aHIuc2VuZChib2R5KQoJCQl9IGNhdGNoIChlcnIpIHsKCQkJCXByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gKCkgewoJCQkJCXNlbGYuZW1pdCgnZXJyb3InLCBlcnIpCgkJCQl9KQoJCQkJcmV0dXJuCgkJCX0KCQl9Cgl9CgoJLyoqCgkgKiBDaGVja3MgaWYgeGhyLnN0YXR1cyBpcyByZWFkYWJsZSBhbmQgbm9uLXplcm8sIGluZGljYXRpbmcgbm8gZXJyb3IuCgkgKiBFdmVuIHRob3VnaCB0aGUgc3BlYyBzYXlzIGl0IHNob3VsZCBiZSBhdmFpbGFibGUgaW4gcmVhZHlTdGF0ZSAzLAoJICogYWNjZXNzaW5nIGl0IHRocm93cyBhbiBleGNlcHRpb24gaW4gSUU4CgkgKi8KCWZ1bmN0aW9uIHN0YXR1c1ZhbGlkICh4aHIpIHsKCQl0cnkgewoJCQl2YXIgc3RhdHVzID0geGhyLnN0YXR1cwoJCQlyZXR1cm4gKHN0YXR1cyAhPT0gbnVsbCAmJiBzdGF0dXMgIT09IDApCgkJfSBjYXRjaCAoZSkgewoJCQlyZXR1cm4gZmFsc2UKCQl9Cgl9CgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuX29uWEhSUHJvZ3Jlc3MgPSBmdW5jdGlvbiAoKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgoJCWlmICghc3RhdHVzVmFsaWQoc2VsZi5feGhyKSB8fCBzZWxmLl9kZXN0cm95ZWQpCgkJCXJldHVybgoKCQlpZiAoIXNlbGYuX3Jlc3BvbnNlKQoJCQlzZWxmLl9jb25uZWN0KCkKCgkJc2VsZi5fcmVzcG9uc2UuX29uWEhSUHJvZ3Jlc3MoKQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLl9jb25uZWN0ID0gZnVuY3Rpb24gKCkgewoJCXZhciBzZWxmID0gdGhpcwoKCQlpZiAoc2VsZi5fZGVzdHJveWVkKQoJCQlyZXR1cm4KCgkJc2VsZi5fcmVzcG9uc2UgPSBuZXcgSW5jb21pbmdNZXNzYWdlKHNlbGYuX3hociwgc2VsZi5fZmV0Y2hSZXNwb25zZSwgc2VsZi5fbW9kZSkKCQlzZWxmLl9yZXNwb25zZS5vbignZXJyb3InLCBmdW5jdGlvbihlcnIpIHsKCQkJc2VsZi5lbWl0KCdlcnJvcicsIGVycikKCQl9KQoKCQlzZWxmLmVtaXQoJ3Jlc3BvbnNlJywgc2VsZi5fcmVzcG9uc2UpCgl9CgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuX3dyaXRlID0gZnVuY3Rpb24gKGNodW5rLCBlbmNvZGluZywgY2IpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCgkJc2VsZi5fYm9keS5wdXNoKGNodW5rKQoJCWNiKCkKCX0KCglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5hYm9ydCA9IENsaWVudFJlcXVlc3QucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJc2VsZi5fZGVzdHJveWVkID0gdHJ1ZQoJCWlmIChzZWxmLl9yZXNwb25zZSkKCQkJc2VsZi5fcmVzcG9uc2UuX2Rlc3Ryb3llZCA9IHRydWUKCQlpZiAoc2VsZi5feGhyKQoJCQlzZWxmLl94aHIuYWJvcnQoKQoJCS8vIEN1cnJlbnRseSwgdGhlcmUgaXNuJ3QgYSB3YXkgdG8gdHJ1bHkgYWJvcnQgYSBmZXRjaC4KCQkvLyBJZiB5b3UgbGlrZSBiaWtlc2hlZGRpbmcsIHNlZSBodHRwczovL2dpdGh1Yi5jb20vd2hhdHdnL2ZldGNoL2lzc3Vlcy8yNwoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uIChkYXRhLCBlbmNvZGluZywgY2IpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCQlpZiAodHlwZW9mIGRhdGEgPT09ICdmdW5jdGlvbicpIHsKCQkJY2IgPSBkYXRhCgkJCWRhdGEgPSB1bmRlZmluZWQKCQl9CgoJCXN0cmVhbS5Xcml0YWJsZS5wcm90b3R5cGUuZW5kLmNhbGwoc2VsZiwgZGF0YSwgZW5jb2RpbmcsIGNiKQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLmZsdXNoSGVhZGVycyA9IGZ1bmN0aW9uICgpIHt9CglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5zZXRUaW1lb3V0ID0gZnVuY3Rpb24gKCkge30KCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLnNldE5vRGVsYXkgPSBmdW5jdGlvbiAoKSB7fQoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuc2V0U29ja2V0S2VlcEFsaXZlID0gZnVuY3Rpb24gKCkge30KCgkvLyBUYWtlbiBmcm9tIGh0dHA6Ly93d3cudzMub3JnL1RSL1hNTEh0dHBSZXF1ZXN0LyN0aGUtc2V0cmVxdWVzdGhlYWRlciUyOCUyOS1tZXRob2QKCXZhciB1bnNhZmVIZWFkZXJzID0gWwoJCSdhY2NlcHQtY2hhcnNldCcsCgkJJ2FjY2VwdC1lbmNvZGluZycsCgkJJ2FjY2Vzcy1jb250cm9sLXJlcXVlc3QtaGVhZGVycycsCgkJJ2FjY2Vzcy1jb250cm9sLXJlcXVlc3QtbWV0aG9kJywKCQknY29ubmVjdGlvbicsCgkJJ2NvbnRlbnQtbGVuZ3RoJywKCQknY29va2llJywKCQknY29va2llMicsCgkJJ2RhdGUnLAoJCSdkbnQnLAoJCSdleHBlY3QnLAoJCSdob3N0JywKCQkna2VlcC1hbGl2ZScsCgkJJ29yaWdpbicsCgkJJ3JlZmVyZXInLAoJCSd0ZScsCgkJJ3RyYWlsZXInLAoJCSd0cmFuc2Zlci1lbmNvZGluZycsCgkJJ3VwZ3JhZGUnLAoJCSd1c2VyLWFnZW50JywKCQkndmlhJwoJXQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlciwgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSwgX193ZWJwYWNrX3JlcXVpcmVfXygxNikpKQoKLyoqKi8gfSwKLyogNjYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCkge2V4cG9ydHMuZmV0Y2ggPSBpc0Z1bmN0aW9uKGdsb2JhbC5mZXRjaCkgJiYgaXNGdW5jdGlvbihnbG9iYWwuUmVhZGFibGVTdHJlYW0pCgoJZXhwb3J0cy5ibG9iQ29uc3RydWN0b3IgPSBmYWxzZQoJdHJ5IHsKCQluZXcgQmxvYihbbmV3IEFycmF5QnVmZmVyKDEpXSkKCQlleHBvcnRzLmJsb2JDb25zdHJ1Y3RvciA9IHRydWUKCX0gY2F0Y2ggKGUpIHt9CgoJLy8gVGhlIHhociByZXF1ZXN0IHRvIGV4YW1wbGUuY29tIG1heSB2aW9sYXRlIHNvbWUgcmVzdHJpY3RpdmUgQ1NQIGNvbmZpZ3VyYXRpb25zLAoJLy8gc28gaWYgd2UncmUgcnVubmluZyBpbiBhIGJyb3dzZXIgdGhhdCBzdXBwb3J0cyBgZmV0Y2hgLCBhdm9pZCBjYWxsaW5nIGdldFhIUigpCgkvLyBhbmQgYXNzdW1lIHN1cHBvcnQgZm9yIGNlcnRhaW4gZmVhdHVyZXMgYmVsb3cuCgl2YXIgeGhyCglmdW5jdGlvbiBnZXRYSFIgKCkgewoJCS8vIENhY2hlIHRoZSB4aHIgdmFsdWUKCQlpZiAoeGhyICE9PSB1bmRlZmluZWQpIHJldHVybiB4aHIKCgkJaWYgKGdsb2JhbC5YTUxIdHRwUmVxdWVzdCkgewoJCQl4aHIgPSBuZXcgZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0KCkKCQkJLy8gSWYgWERvbWFpblJlcXVlc3QgaXMgYXZhaWxhYmxlIChpZSBvbmx5LCB3aGVyZSB4aHIgbWlnaHQgbm90IHdvcmsKCQkJLy8gY3Jvc3MgZG9tYWluKSwgdXNlIHRoZSBwYWdlIGxvY2F0aW9uLiBPdGhlcndpc2UgdXNlIGV4YW1wbGUuY29tCgkJCS8vIE5vdGU6IHRoaXMgZG9lc24ndCBhY3R1YWxseSBtYWtlIGFuIGh0dHAgcmVxdWVzdC4KCQkJdHJ5IHsKCQkJCXhoci5vcGVuKCdHRVQnLCBnbG9iYWwuWERvbWFpblJlcXVlc3QgPyAnLycgOiAnaHR0cHM6Ly9leGFtcGxlLmNvbScpCgkJCX0gY2F0Y2goZSkgewoJCQkJeGhyID0gbnVsbAoJCQl9CgkJfSBlbHNlIHsKCQkJLy8gU2VydmljZSB3b3JrZXJzIGRvbid0IGhhdmUgWEhSCgkJCXhociA9IG51bGwKCQl9CgkJcmV0dXJuIHhocgoJfQoKCWZ1bmN0aW9uIGNoZWNrVHlwZVN1cHBvcnQgKHR5cGUpIHsKCQl2YXIgeGhyID0gZ2V0WEhSKCkKCQlpZiAoIXhocikgcmV0dXJuIGZhbHNlCgkJdHJ5IHsKCQkJeGhyLnJlc3BvbnNlVHlwZSA9IHR5cGUKCQkJcmV0dXJuIHhoci5yZXNwb25zZVR5cGUgPT09IHR5cGUKCQl9IGNhdGNoIChlKSB7fQoJCXJldHVybiBmYWxzZQoJfQoKCS8vIEZvciBzb21lIHN0cmFuZ2UgcmVhc29uLCBTYWZhcmkgNy4wIHJlcG9ydHMgdHlwZW9mIGdsb2JhbC5BcnJheUJ1ZmZlciA9PT0gJ29iamVjdCcuCgkvLyBTYWZhcmkgNy4xIGFwcGVhcnMgdG8gaGF2ZSBmaXhlZCB0aGlzIGJ1Zy4KCXZhciBoYXZlQXJyYXlCdWZmZXIgPSB0eXBlb2YgZ2xvYmFsLkFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJwoJdmFyIGhhdmVTbGljZSA9IGhhdmVBcnJheUJ1ZmZlciAmJiBpc0Z1bmN0aW9uKGdsb2JhbC5BcnJheUJ1ZmZlci5wcm90b3R5cGUuc2xpY2UpCgoJLy8gSWYgZmV0Y2ggaXMgc3VwcG9ydGVkLCB0aGVuIGFycmF5YnVmZmVyIHdpbGwgYmUgc3VwcG9ydGVkIHRvby4gU2tpcCBjYWxsaW5nCgkvLyBjaGVja1R5cGVTdXBwb3J0KCksIHNpbmNlIHRoYXQgY2FsbHMgZ2V0WEhSKCkuCglleHBvcnRzLmFycmF5YnVmZmVyID0gZXhwb3J0cy5mZXRjaCB8fCAoaGF2ZUFycmF5QnVmZmVyICYmIGNoZWNrVHlwZVN1cHBvcnQoJ2FycmF5YnVmZmVyJykpCgoJLy8gVGhlc2UgbmV4dCB0d28gdGVzdHMgdW5hdm9pZGFibHkgc2hvdyB3YXJuaW5ncyBpbiBDaHJvbWUuIFNpbmNlIGZldGNoIHdpbGwgYWx3YXlzCgkvLyBiZSB1c2VkIGlmIGl0J3MgYXZhaWxhYmxlLCBqdXN0IHJldHVybiBmYWxzZSBmb3IgdGhlc2UgdG8gYXZvaWQgdGhlIHdhcm5pbmdzLgoJZXhwb3J0cy5tc3N0cmVhbSA9ICFleHBvcnRzLmZldGNoICYmIGhhdmVTbGljZSAmJiBjaGVja1R5cGVTdXBwb3J0KCdtcy1zdHJlYW0nKQoJZXhwb3J0cy5tb3pjaHVua2VkYXJyYXlidWZmZXIgPSAhZXhwb3J0cy5mZXRjaCAmJiBoYXZlQXJyYXlCdWZmZXIgJiYKCQljaGVja1R5cGVTdXBwb3J0KCdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcicpCgoJLy8gSWYgZmV0Y2ggaXMgc3VwcG9ydGVkLCB0aGVuIG92ZXJyaWRlTWltZVR5cGUgd2lsbCBiZSBzdXBwb3J0ZWQgdG9vLiBTa2lwIGNhbGxpbmcKCS8vIGdldFhIUigpLgoJZXhwb3J0cy5vdmVycmlkZU1pbWVUeXBlID0gZXhwb3J0cy5mZXRjaCB8fCAoZ2V0WEhSKCkgPyBpc0Z1bmN0aW9uKGdldFhIUigpLm92ZXJyaWRlTWltZVR5cGUpIDogZmFsc2UpCgoJZXhwb3J0cy52YkFycmF5ID0gaXNGdW5jdGlvbihnbG9iYWwuVkJBcnJheSkKCglmdW5jdGlvbiBpc0Z1bmN0aW9uICh2YWx1ZSkgewoJCXJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicKCX0KCgl4aHIgPSBudWxsIC8vIEhlbHAgZ2MKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpCgovKioqLyB9LAovKiA2NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24ocHJvY2VzcywgQnVmZmVyLCBnbG9iYWwpIHt2YXIgY2FwYWJpbGl0eSA9IF9fd2VicGFja19yZXF1aXJlX18oNjYpCgl2YXIgaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQoJdmFyIHN0cmVhbSA9IF9fd2VicGFja19yZXF1aXJlX18oMzMpCgoJdmFyIHJTdGF0ZXMgPSBleHBvcnRzLnJlYWR5U3RhdGVzID0gewoJCVVOU0VOVDogMCwKCQlPUEVORUQ6IDEsCgkJSEVBREVSU19SRUNFSVZFRDogMiwKCQlMT0FESU5HOiAzLAoJCURPTkU6IDQKCX0KCgl2YXIgSW5jb21pbmdNZXNzYWdlID0gZXhwb3J0cy5JbmNvbWluZ01lc3NhZ2UgPSBmdW5jdGlvbiAoeGhyLCByZXNwb25zZSwgbW9kZSkgewoJCXZhciBzZWxmID0gdGhpcwoJCXN0cmVhbS5SZWFkYWJsZS5jYWxsKHNlbGYpCgoJCXNlbGYuX21vZGUgPSBtb2RlCgkJc2VsZi5oZWFkZXJzID0ge30KCQlzZWxmLnJhd0hlYWRlcnMgPSBbXQoJCXNlbGYudHJhaWxlcnMgPSB7fQoJCXNlbGYucmF3VHJhaWxlcnMgPSBbXQoKCQkvLyBGYWtlIHRoZSAnY2xvc2UnIGV2ZW50LCBidXQgb25seSBvbmNlICdlbmQnIGZpcmVzCgkJc2VsZi5vbignZW5kJywgZnVuY3Rpb24gKCkgewoJCQkvLyBUaGUgbmV4dFRpY2sgaXMgbmVjZXNzYXJ5IHRvIHByZXZlbnQgdGhlICdyZXF1ZXN0JyBtb2R1bGUgZnJvbSBjYXVzaW5nIGFuIGluZmluaXRlIGxvb3AKCQkJcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7CgkJCQlzZWxmLmVtaXQoJ2Nsb3NlJykKCQkJfSkKCQl9KQoKCQlpZiAobW9kZSA9PT0gJ2ZldGNoJykgewoJCQlzZWxmLl9mZXRjaFJlc3BvbnNlID0gcmVzcG9uc2UKCgkJCXNlbGYudXJsID0gcmVzcG9uc2UudXJsCgkJCXNlbGYuc3RhdHVzQ29kZSA9IHJlc3BvbnNlLnN0YXR1cwoJCQlzZWxmLnN0YXR1c01lc3NhZ2UgPSByZXNwb25zZS5zdGF0dXNUZXh0CgkJCQoJCQlyZXNwb25zZS5oZWFkZXJzLmZvckVhY2goZnVuY3Rpb24oaGVhZGVyLCBrZXkpewoJCQkJc2VsZi5oZWFkZXJzW2tleS50b0xvd2VyQ2FzZSgpXSA9IGhlYWRlcgoJCQkJc2VsZi5yYXdIZWFkZXJzLnB1c2goa2V5LCBoZWFkZXIpCgkJCX0pCgoKCQkJLy8gVE9ETzogdGhpcyBkb2Vzbid0IHJlc3BlY3QgYmFja3ByZXNzdXJlLiBPbmNlIFdyaXRhYmxlU3RyZWFtIGlzIGF2YWlsYWJsZSwgdGhpcyBjYW4gYmUgZml4ZWQKCQkJdmFyIHJlYWRlciA9IHJlc3BvbnNlLmJvZHkuZ2V0UmVhZGVyKCkKCQkJZnVuY3Rpb24gcmVhZCAoKSB7CgkJCQlyZWFkZXIucmVhZCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewoJCQkJCWlmIChzZWxmLl9kZXN0cm95ZWQpCgkJCQkJCXJldHVybgoJCQkJCWlmIChyZXN1bHQuZG9uZSkgewoJCQkJCQlzZWxmLnB1c2gobnVsbCkKCQkJCQkJcmV0dXJuCgkJCQkJfQoJCQkJCXNlbGYucHVzaChuZXcgQnVmZmVyKHJlc3VsdC52YWx1ZSkpCgkJCQkJcmVhZCgpCgkJCQl9KS5jYXRjaChmdW5jdGlvbihlcnIpIHsKCQkJCQlzZWxmLmVtaXQoJ2Vycm9yJywgZXJyKQoJCQkJfSkKCQkJfQoJCQlyZWFkKCkKCgkJfSBlbHNlIHsKCQkJc2VsZi5feGhyID0geGhyCgkJCXNlbGYuX3BvcyA9IDAKCgkJCXNlbGYudXJsID0geGhyLnJlc3BvbnNlVVJMCgkJCXNlbGYuc3RhdHVzQ29kZSA9IHhoci5zdGF0dXMKCQkJc2VsZi5zdGF0dXNNZXNzYWdlID0geGhyLnN0YXR1c1RleHQKCQkJdmFyIGhlYWRlcnMgPSB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkuc3BsaXQoL1xyP1xuLykKCQkJaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHsKCQkJCXZhciBtYXRjaGVzID0gaGVhZGVyLm1hdGNoKC9eKFteOl0rKTpccyooLiopLykKCQkJCWlmIChtYXRjaGVzKSB7CgkJCQkJdmFyIGtleSA9IG1hdGNoZXNbMV0udG9Mb3dlckNhc2UoKQoJCQkJCWlmIChrZXkgPT09ICdzZXQtY29va2llJykgewoJCQkJCQlpZiAoc2VsZi5oZWFkZXJzW2tleV0gPT09IHVuZGVmaW5lZCkgewoJCQkJCQkJc2VsZi5oZWFkZXJzW2tleV0gPSBbXQoJCQkJCQl9CgkJCQkJCXNlbGYuaGVhZGVyc1trZXldLnB1c2gobWF0Y2hlc1syXSkKCQkJCQl9IGVsc2UgaWYgKHNlbGYuaGVhZGVyc1trZXldICE9PSB1bmRlZmluZWQpIHsKCQkJCQkJc2VsZi5oZWFkZXJzW2tleV0gKz0gJywgJyArIG1hdGNoZXNbMl0KCQkJCQl9IGVsc2UgewoJCQkJCQlzZWxmLmhlYWRlcnNba2V5XSA9IG1hdGNoZXNbMl0KCQkJCQl9CgkJCQkJc2VsZi5yYXdIZWFkZXJzLnB1c2gobWF0Y2hlc1sxXSwgbWF0Y2hlc1syXSkKCQkJCX0KCQkJfSkKCgkJCXNlbGYuX2NoYXJzZXQgPSAneC11c2VyLWRlZmluZWQnCgkJCWlmICghY2FwYWJpbGl0eS5vdmVycmlkZU1pbWVUeXBlKSB7CgkJCQl2YXIgbWltZVR5cGUgPSBzZWxmLnJhd0hlYWRlcnNbJ21pbWUtdHlwZSddCgkJCQlpZiAobWltZVR5cGUpIHsKCQkJCQl2YXIgY2hhcnNldE1hdGNoID0gbWltZVR5cGUubWF0Y2goLztccypjaGFyc2V0PShbXjtdKSg7fCQpLykKCQkJCQlpZiAoY2hhcnNldE1hdGNoKSB7CgkJCQkJCXNlbGYuX2NoYXJzZXQgPSBjaGFyc2V0TWF0Y2hbMV0udG9Mb3dlckNhc2UoKQoJCQkJCX0KCQkJCX0KCQkJCWlmICghc2VsZi5fY2hhcnNldCkKCQkJCQlzZWxmLl9jaGFyc2V0ID0gJ3V0Zi04JyAvLyBiZXN0IGd1ZXNzCgkJCX0KCQl9Cgl9CgoJaW5oZXJpdHMoSW5jb21pbmdNZXNzYWdlLCBzdHJlYW0uUmVhZGFibGUpCgoJSW5jb21pbmdNZXNzYWdlLnByb3RvdHlwZS5fcmVhZCA9IGZ1bmN0aW9uICgpIHt9CgoJSW5jb21pbmdNZXNzYWdlLnByb3RvdHlwZS5fb25YSFJQcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCgkJdmFyIHhociA9IHNlbGYuX3hocgoKCQl2YXIgcmVzcG9uc2UgPSBudWxsCgkJc3dpdGNoIChzZWxmLl9tb2RlKSB7CgkJCWNhc2UgJ3RleHQ6dmJhcnJheSc6IC8vIEZvciBJRTkKCQkJCWlmICh4aHIucmVhZHlTdGF0ZSAhPT0gclN0YXRlcy5ET05FKQoJCQkJCWJyZWFrCgkJCQl0cnkgewoJCQkJCS8vIFRoaXMgZmFpbHMgaW4gSUU4CgkJCQkJcmVzcG9uc2UgPSBuZXcgZ2xvYmFsLlZCQXJyYXkoeGhyLnJlc3BvbnNlQm9keSkudG9BcnJheSgpCgkJCQl9IGNhdGNoIChlKSB7fQoJCQkJaWYgKHJlc3BvbnNlICE9PSBudWxsKSB7CgkJCQkJc2VsZi5wdXNoKG5ldyBCdWZmZXIocmVzcG9uc2UpKQoJCQkJCWJyZWFrCgkJCQl9CgkJCQkvLyBGYWxscyB0aHJvdWdoIGluIElFOAkKCQkJY2FzZSAndGV4dCc6CgkJCQl0cnkgeyAvLyBUaGlzIHdpbGwgZmFpbCB3aGVuIHJlYWR5U3RhdGUgPSAzIGluIElFOS4gU3dpdGNoIG1vZGUgYW5kIHdhaXQgZm9yIHJlYWR5U3RhdGUgPSA0CgkJCQkJcmVzcG9uc2UgPSB4aHIucmVzcG9uc2VUZXh0CgkJCQl9IGNhdGNoIChlKSB7CgkJCQkJc2VsZi5fbW9kZSA9ICd0ZXh0OnZiYXJyYXknCgkJCQkJYnJlYWsKCQkJCX0KCQkJCWlmIChyZXNwb25zZS5sZW5ndGggPiBzZWxmLl9wb3MpIHsKCQkJCQl2YXIgbmV3RGF0YSA9IHJlc3BvbnNlLnN1YnN0cihzZWxmLl9wb3MpCgkJCQkJaWYgKHNlbGYuX2NoYXJzZXQgPT09ICd4LXVzZXItZGVmaW5lZCcpIHsKCQkJCQkJdmFyIGJ1ZmZlciA9IG5ldyBCdWZmZXIobmV3RGF0YS5sZW5ndGgpCgkJCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgbmV3RGF0YS5sZW5ndGg7IGkrKykKCQkJCQkJCWJ1ZmZlcltpXSA9IG5ld0RhdGEuY2hhckNvZGVBdChpKSAmIDB4ZmYKCgkJCQkJCXNlbGYucHVzaChidWZmZXIpCgkJCQkJfSBlbHNlIHsKCQkJCQkJc2VsZi5wdXNoKG5ld0RhdGEsIHNlbGYuX2NoYXJzZXQpCgkJCQkJfQoJCQkJCXNlbGYuX3BvcyA9IHJlc3BvbnNlLmxlbmd0aAoJCQkJfQoJCQkJYnJlYWsKCQkJY2FzZSAnYXJyYXlidWZmZXInOgoJCQkJaWYgKHhoci5yZWFkeVN0YXRlICE9PSByU3RhdGVzLkRPTkUgfHwgIXhoci5yZXNwb25zZSkKCQkJCQlicmVhawoJCQkJcmVzcG9uc2UgPSB4aHIucmVzcG9uc2UKCQkJCXNlbGYucHVzaChuZXcgQnVmZmVyKG5ldyBVaW50OEFycmF5KHJlc3BvbnNlKSkpCgkJCQlicmVhawoJCQljYXNlICdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcic6IC8vIHRha2Ugd2hvbGUKCQkJCXJlc3BvbnNlID0geGhyLnJlc3BvbnNlCgkJCQlpZiAoeGhyLnJlYWR5U3RhdGUgIT09IHJTdGF0ZXMuTE9BRElORyB8fCAhcmVzcG9uc2UpCgkJCQkJYnJlYWsKCQkJCXNlbGYucHVzaChuZXcgQnVmZmVyKG5ldyBVaW50OEFycmF5KHJlc3BvbnNlKSkpCgkJCQlicmVhawoJCQljYXNlICdtcy1zdHJlYW0nOgoJCQkJcmVzcG9uc2UgPSB4aHIucmVzcG9uc2UKCQkJCWlmICh4aHIucmVhZHlTdGF0ZSAhPT0gclN0YXRlcy5MT0FESU5HKQoJCQkJCWJyZWFrCgkJCQl2YXIgcmVhZGVyID0gbmV3IGdsb2JhbC5NU1N0cmVhbVJlYWRlcigpCgkJCQlyZWFkZXIub25wcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHsKCQkJCQlpZiAocmVhZGVyLnJlc3VsdC5ieXRlTGVuZ3RoID4gc2VsZi5fcG9zKSB7CgkJCQkJCXNlbGYucHVzaChuZXcgQnVmZmVyKG5ldyBVaW50OEFycmF5KHJlYWRlci5yZXN1bHQuc2xpY2Uoc2VsZi5fcG9zKSkpKQoJCQkJCQlzZWxmLl9wb3MgPSByZWFkZXIucmVzdWx0LmJ5dGVMZW5ndGgKCQkJCQl9CgkJCQl9CgkJCQlyZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkgewoJCQkJCXNlbGYucHVzaChudWxsKQoJCQkJfQoJCQkJLy8gcmVhZGVyLm9uZXJyb3IgPSA/Pz8gLy8gVE9ETzogdGhpcwoJCQkJcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKHJlc3BvbnNlKQoJCQkJYnJlYWsKCQl9CgoJCS8vIFRoZSBtcy1zdHJlYW0gY2FzZSBoYW5kbGVzIGVuZCBzZXBhcmF0ZWx5IGluIHJlYWRlci5vbmxvYWQoKQoJCWlmIChzZWxmLl94aHIucmVhZHlTdGF0ZSA9PT0gclN0YXRlcy5ET05FICYmIHNlbGYuX21vZGUgIT09ICdtcy1zdHJlYW0nKSB7CgkJCXNlbGYucHVzaChudWxsKQoJCX0KCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygxNiksIF9fd2VicGFja19yZXF1aXJlX18oNSkuQnVmZmVyLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSkKCi8qKiovIH0sCi8qIDY4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBCdWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLkJ1ZmZlcgoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGJ1ZikgewoJCS8vIElmIHRoZSBidWZmZXIgaXMgYmFja2VkIGJ5IGEgVWludDhBcnJheSwgYSBmYXN0ZXIgdmVyc2lvbiB3aWxsIHdvcmsKCQlpZiAoYnVmIGluc3RhbmNlb2YgVWludDhBcnJheSkgewoJCQkvLyBJZiB0aGUgYnVmZmVyIGlzbid0IGEgc3ViYXJyYXksIHJldHVybiB0aGUgdW5kZXJseWluZyBBcnJheUJ1ZmZlcgoJCQlpZiAoYnVmLmJ5dGVPZmZzZXQgPT09IDAgJiYgYnVmLmJ5dGVMZW5ndGggPT09IGJ1Zi5idWZmZXIuYnl0ZUxlbmd0aCkgewoJCQkJcmV0dXJuIGJ1Zi5idWZmZXIKCQkJfSBlbHNlIGlmICh0eXBlb2YgYnVmLmJ1ZmZlci5zbGljZSA9PT0gJ2Z1bmN0aW9uJykgewoJCQkJLy8gT3RoZXJ3aXNlIHdlIG5lZWQgdG8gZ2V0IGEgcHJvcGVyIGNvcHkKCQkJCXJldHVybiBidWYuYnVmZmVyLnNsaWNlKGJ1Zi5ieXRlT2Zmc2V0LCBidWYuYnl0ZU9mZnNldCArIGJ1Zi5ieXRlTGVuZ3RoKQoJCQl9CgkJfQoKCQlpZiAoQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHsKCQkJLy8gVGhpcyBpcyB0aGUgc2xvdyB2ZXJzaW9uIHRoYXQgd2lsbCB3b3JrIHdpdGggYW55IEJ1ZmZlcgoJCQkvLyBpbXBsZW1lbnRhdGlvbiAoZXZlbiBpbiBvbGQgYnJvd3NlcnMpCgkJCXZhciBhcnJheUNvcHkgPSBuZXcgVWludDhBcnJheShidWYubGVuZ3RoKQoJCQl2YXIgbGVuID0gYnVmLmxlbmd0aAoJCQlmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CgkJCQlhcnJheUNvcHlbaV0gPSBidWZbaV0KCQkJfQoJCQlyZXR1cm4gYXJyYXlDb3B5LmJ1ZmZlcgoJCX0gZWxzZSB7CgkJCXRocm93IG5ldyBFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpCgkJfQoJfQoKCi8qKiovIH0sCi8qIDY5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZXh0ZW5kCgoJdmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKCglmdW5jdGlvbiBleHRlbmQoKSB7CgkgICAgdmFyIHRhcmdldCA9IHt9CgoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0KCgkgICAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsKCSAgICAgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgewoJICAgICAgICAgICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCgkgICAgcmV0dXJuIHRhcmdldAoJfQoKCi8qKiovIH0sCi8qIDcwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gewoJICAiMTAwIjogIkNvbnRpbnVlIiwKCSAgIjEwMSI6ICJTd2l0Y2hpbmcgUHJvdG9jb2xzIiwKCSAgIjEwMiI6ICJQcm9jZXNzaW5nIiwKCSAgIjIwMCI6ICJPSyIsCgkgICIyMDEiOiAiQ3JlYXRlZCIsCgkgICIyMDIiOiAiQWNjZXB0ZWQiLAoJICAiMjAzIjogIk5vbi1BdXRob3JpdGF0aXZlIEluZm9ybWF0aW9uIiwKCSAgIjIwNCI6ICJObyBDb250ZW50IiwKCSAgIjIwNSI6ICJSZXNldCBDb250ZW50IiwKCSAgIjIwNiI6ICJQYXJ0aWFsIENvbnRlbnQiLAoJICAiMjA3IjogIk11bHRpLVN0YXR1cyIsCgkgICIyMDgiOiAiQWxyZWFkeSBSZXBvcnRlZCIsCgkgICIyMjYiOiAiSU0gVXNlZCIsCgkgICIzMDAiOiAiTXVsdGlwbGUgQ2hvaWNlcyIsCgkgICIzMDEiOiAiTW92ZWQgUGVybWFuZW50bHkiLAoJICAiMzAyIjogIkZvdW5kIiwKCSAgIjMwMyI6ICJTZWUgT3RoZXIiLAoJICAiMzA0IjogIk5vdCBNb2RpZmllZCIsCgkgICIzMDUiOiAiVXNlIFByb3h5IiwKCSAgIjMwNyI6ICJUZW1wb3JhcnkgUmVkaXJlY3QiLAoJICAiMzA4IjogIlBlcm1hbmVudCBSZWRpcmVjdCIsCgkgICI0MDAiOiAiQmFkIFJlcXVlc3QiLAoJICAiNDAxIjogIlVuYXV0aG9yaXplZCIsCgkgICI0MDIiOiAiUGF5bWVudCBSZXF1aXJlZCIsCgkgICI0MDMiOiAiRm9yYmlkZGVuIiwKCSAgIjQwNCI6ICJOb3QgRm91bmQiLAoJICAiNDA1IjogIk1ldGhvZCBOb3QgQWxsb3dlZCIsCgkgICI0MDYiOiAiTm90IEFjY2VwdGFibGUiLAoJICAiNDA3IjogIlByb3h5IEF1dGhlbnRpY2F0aW9uIFJlcXVpcmVkIiwKCSAgIjQwOCI6ICJSZXF1ZXN0IFRpbWVvdXQiLAoJICAiNDA5IjogIkNvbmZsaWN0IiwKCSAgIjQxMCI6ICJHb25lIiwKCSAgIjQxMSI6ICJMZW5ndGggUmVxdWlyZWQiLAoJICAiNDEyIjogIlByZWNvbmRpdGlvbiBGYWlsZWQiLAoJICAiNDEzIjogIlBheWxvYWQgVG9vIExhcmdlIiwKCSAgIjQxNCI6ICJVUkkgVG9vIExvbmciLAoJICAiNDE1IjogIlVuc3VwcG9ydGVkIE1lZGlhIFR5cGUiLAoJICAiNDE2IjogIlJhbmdlIE5vdCBTYXRpc2ZpYWJsZSIsCgkgICI0MTciOiAiRXhwZWN0YXRpb24gRmFpbGVkIiwKCSAgIjQxOCI6ICJJJ20gYSB0ZWFwb3QiLAoJICAiNDIxIjogIk1pc2RpcmVjdGVkIFJlcXVlc3QiLAoJICAiNDIyIjogIlVucHJvY2Vzc2FibGUgRW50aXR5IiwKCSAgIjQyMyI6ICJMb2NrZWQiLAoJICAiNDI0IjogIkZhaWxlZCBEZXBlbmRlbmN5IiwKCSAgIjQyNSI6ICJVbm9yZGVyZWQgQ29sbGVjdGlvbiIsCgkgICI0MjYiOiAiVXBncmFkZSBSZXF1aXJlZCIsCgkgICI0MjgiOiAiUHJlY29uZGl0aW9uIFJlcXVpcmVkIiwKCSAgIjQyOSI6ICJUb28gTWFueSBSZXF1ZXN0cyIsCgkgICI0MzEiOiAiUmVxdWVzdCBIZWFkZXIgRmllbGRzIFRvbyBMYXJnZSIsCgkgICI0NTEiOiAiVW5hdmFpbGFibGUgRm9yIExlZ2FsIFJlYXNvbnMiLAoJICAiNTAwIjogIkludGVybmFsIFNlcnZlciBFcnJvciIsCgkgICI1MDEiOiAiTm90IEltcGxlbWVudGVkIiwKCSAgIjUwMiI6ICJCYWQgR2F0ZXdheSIsCgkgICI1MDMiOiAiU2VydmljZSBVbmF2YWlsYWJsZSIsCgkgICI1MDQiOiAiR2F0ZXdheSBUaW1lb3V0IiwKCSAgIjUwNSI6ICJIVFRQIFZlcnNpb24gTm90IFN1cHBvcnRlZCIsCgkgICI1MDYiOiAiVmFyaWFudCBBbHNvIE5lZ290aWF0ZXMiLAoJICAiNTA3IjogIkluc3VmZmljaWVudCBTdG9yYWdlIiwKCSAgIjUwOCI6ICJMb29wIERldGVjdGVkIiwKCSAgIjUwOSI6ICJCYW5kd2lkdGggTGltaXQgRXhjZWVkZWQiLAoJICAiNTEwIjogIk5vdCBFeHRlbmRlZCIsCgkgICI1MTEiOiAiTmV0d29yayBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCIKCX0KCgovKioqLyB9LAovKiA3MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCSd1c2Ugc3RyaWN0JzsKCgl2YXIgcHVueWNvZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcyKTsKCXZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3NCk7CgoJZXhwb3J0cy5wYXJzZSA9IHVybFBhcnNlOwoJZXhwb3J0cy5yZXNvbHZlID0gdXJsUmVzb2x2ZTsKCWV4cG9ydHMucmVzb2x2ZU9iamVjdCA9IHVybFJlc29sdmVPYmplY3Q7CglleHBvcnRzLmZvcm1hdCA9IHVybEZvcm1hdDsKCglleHBvcnRzLlVybCA9IFVybDsKCglmdW5jdGlvbiBVcmwoKSB7CgkgIHRoaXMucHJvdG9jb2wgPSBudWxsOwoJICB0aGlzLnNsYXNoZXMgPSBudWxsOwoJICB0aGlzLmF1dGggPSBudWxsOwoJICB0aGlzLmhvc3QgPSBudWxsOwoJICB0aGlzLnBvcnQgPSBudWxsOwoJICB0aGlzLmhvc3RuYW1lID0gbnVsbDsKCSAgdGhpcy5oYXNoID0gbnVsbDsKCSAgdGhpcy5zZWFyY2ggPSBudWxsOwoJICB0aGlzLnF1ZXJ5ID0gbnVsbDsKCSAgdGhpcy5wYXRobmFtZSA9IG51bGw7CgkgIHRoaXMucGF0aCA9IG51bGw7CgkgIHRoaXMuaHJlZiA9IG51bGw7Cgl9CgoJLy8gUmVmZXJlbmNlOiBSRkMgMzk4NiwgUkZDIDE4MDgsIFJGQyAyMzk2CgoJLy8gZGVmaW5lIHRoZXNlIGhlcmUgc28gYXQgbGVhc3QgdGhleSBvbmx5IGhhdmUgdG8gYmUKCS8vIGNvbXBpbGVkIG9uY2Ugb24gdGhlIGZpcnN0IG1vZHVsZSBsb2FkLgoJdmFyIHByb3RvY29sUGF0dGVybiA9IC9eKFthLXowLTkuKy1dKzopL2ksCgkgICAgcG9ydFBhdHRlcm4gPSAvOlswLTldKiQvLAoKCSAgICAvLyBTcGVjaWFsIGNhc2UgZm9yIGEgc2ltcGxlIHBhdGggVVJMCgkgICAgc2ltcGxlUGF0aFBhdHRlcm4gPSAvXihcL1wvPyg/IVwvKVteXD9cc10qKShcP1teXHNdKik/JC8sCgoJICAgIC8vIFJGQyAyMzk2OiBjaGFyYWN0ZXJzIHJlc2VydmVkIGZvciBkZWxpbWl0aW5nIFVSTHMuCgkgICAgLy8gV2UgYWN0dWFsbHkganVzdCBhdXRvLWVzY2FwZSB0aGVzZS4KCSAgICBkZWxpbXMgPSBbJzwnLCAnPicsICciJywgJ2AnLCAnICcsICdccicsICdcbicsICdcdCddLAoKCSAgICAvLyBSRkMgMjM5NjogY2hhcmFjdGVycyBub3QgYWxsb3dlZCBmb3IgdmFyaW91cyByZWFzb25zLgoJICAgIHVud2lzZSA9IFsneycsICd9JywgJ3wnLCAnXFwnLCAnXicsICdgJ10uY29uY2F0KGRlbGltcyksCgoJICAgIC8vIEFsbG93ZWQgYnkgUkZDcywgYnV0IGNhdXNlIG9mIFhTUyBhdHRhY2tzLiAgQWx3YXlzIGVzY2FwZSB0aGVzZS4KCSAgICBhdXRvRXNjYXBlID0gWydcJyddLmNvbmNhdCh1bndpc2UpLAoJICAgIC8vIENoYXJhY3RlcnMgdGhhdCBhcmUgbmV2ZXIgZXZlciBhbGxvd2VkIGluIGEgaG9zdG5hbWUuCgkgICAgLy8gTm90ZSB0aGF0IGFueSBpbnZhbGlkIGNoYXJzIGFyZSBhbHNvIGhhbmRsZWQsIGJ1dCB0aGVzZQoJICAgIC8vIGFyZSB0aGUgb25lcyB0aGF0IGFyZSAqZXhwZWN0ZWQqIHRvIGJlIHNlZW4sIHNvIHdlIGZhc3QtcGF0aAoJICAgIC8vIHRoZW0uCgkgICAgbm9uSG9zdENoYXJzID0gWyclJywgJy8nLCAnPycsICc7JywgJyMnXS5jb25jYXQoYXV0b0VzY2FwZSksCgkgICAgaG9zdEVuZGluZ0NoYXJzID0gWycvJywgJz8nLCAnIyddLAoJICAgIGhvc3RuYW1lTWF4TGVuID0gMjU1LAoJICAgIGhvc3RuYW1lUGFydFBhdHRlcm4gPSAvXlsrYS16MC05QS1aXy1dezAsNjN9JC8sCgkgICAgaG9zdG5hbWVQYXJ0U3RhcnQgPSAvXihbK2EtejAtOUEtWl8tXXswLDYzfSkoLiopJC8sCgkgICAgLy8gcHJvdG9jb2xzIHRoYXQgY2FuIGFsbG93ICJ1bnNhZmUiIGFuZCAidW53aXNlIiBjaGFycy4KCSAgICB1bnNhZmVQcm90b2NvbCA9IHsKCSAgICAgICdqYXZhc2NyaXB0JzogdHJ1ZSwKCSAgICAgICdqYXZhc2NyaXB0Oic6IHRydWUKCSAgICB9LAoJICAgIC8vIHByb3RvY29scyB0aGF0IG5ldmVyIGhhdmUgYSBob3N0bmFtZS4KCSAgICBob3N0bGVzc1Byb3RvY29sID0gewoJICAgICAgJ2phdmFzY3JpcHQnOiB0cnVlLAoJICAgICAgJ2phdmFzY3JpcHQ6JzogdHJ1ZQoJICAgIH0sCgkgICAgLy8gcHJvdG9jb2xzIHRoYXQgYWx3YXlzIGNvbnRhaW4gYSAvLyBiaXQuCgkgICAgc2xhc2hlZFByb3RvY29sID0gewoJICAgICAgJ2h0dHAnOiB0cnVlLAoJICAgICAgJ2h0dHBzJzogdHJ1ZSwKCSAgICAgICdmdHAnOiB0cnVlLAoJICAgICAgJ2dvcGhlcic6IHRydWUsCgkgICAgICAnZmlsZSc6IHRydWUsCgkgICAgICAnaHR0cDonOiB0cnVlLAoJICAgICAgJ2h0dHBzOic6IHRydWUsCgkgICAgICAnZnRwOic6IHRydWUsCgkgICAgICAnZ29waGVyOic6IHRydWUsCgkgICAgICAnZmlsZTonOiB0cnVlCgkgICAgfSwKCSAgICBxdWVyeXN0cmluZyA9IF9fd2VicGFja19yZXF1aXJlX18oNzUpOwoKCWZ1bmN0aW9uIHVybFBhcnNlKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpIHsKCSAgaWYgKHVybCAmJiB1dGlsLmlzT2JqZWN0KHVybCkgJiYgdXJsIGluc3RhbmNlb2YgVXJsKSByZXR1cm4gdXJsOwoKCSAgdmFyIHUgPSBuZXcgVXJsOwoJICB1LnBhcnNlKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpOwoJICByZXR1cm4gdTsKCX0KCglVcmwucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24odXJsLCBwYXJzZVF1ZXJ5U3RyaW5nLCBzbGFzaGVzRGVub3RlSG9zdCkgewoJICBpZiAoIXV0aWwuaXNTdHJpbmcodXJsKSkgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlBhcmFtZXRlciAndXJsJyBtdXN0IGJlIGEgc3RyaW5nLCBub3QgIiArIHR5cGVvZiB1cmwpOwoJICB9CgoJICAvLyBDb3B5IGNocm9tZSwgSUUsIG9wZXJhIGJhY2tzbGFzaC1oYW5kbGluZyBiZWhhdmlvci4KCSAgLy8gQmFjayBzbGFzaGVzIGJlZm9yZSB0aGUgcXVlcnkgc3RyaW5nIGdldCBjb252ZXJ0ZWQgdG8gZm9yd2FyZCBzbGFzaGVzCgkgIC8vIFNlZTogaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTI1OTE2CgkgIHZhciBxdWVyeUluZGV4ID0gdXJsLmluZGV4T2YoJz8nKSwKCSAgICAgIHNwbGl0dGVyID0KCSAgICAgICAgICAocXVlcnlJbmRleCAhPT0gLTEgJiYgcXVlcnlJbmRleCA8IHVybC5pbmRleE9mKCcjJykpID8gJz8nIDogJyMnLAoJICAgICAgdVNwbGl0ID0gdXJsLnNwbGl0KHNwbGl0dGVyKSwKCSAgICAgIHNsYXNoUmVnZXggPSAvXFwvZzsKCSAgdVNwbGl0WzBdID0gdVNwbGl0WzBdLnJlcGxhY2Uoc2xhc2hSZWdleCwgJy8nKTsKCSAgdXJsID0gdVNwbGl0LmpvaW4oc3BsaXR0ZXIpOwoKCSAgdmFyIHJlc3QgPSB1cmw7CgoJICAvLyB0cmltIGJlZm9yZSBwcm9jZWVkaW5nLgoJICAvLyBUaGlzIGlzIHRvIHN1cHBvcnQgcGFyc2Ugc3R1ZmYgbGlrZSAiICBodHRwOi8vZm9vLmNvbSAgXG4iCgkgIHJlc3QgPSByZXN0LnRyaW0oKTsKCgkgIGlmICghc2xhc2hlc0Rlbm90ZUhvc3QgJiYgdXJsLnNwbGl0KCcjJykubGVuZ3RoID09PSAxKSB7CgkgICAgLy8gVHJ5IGZhc3QgcGF0aCByZWdleHAKCSAgICB2YXIgc2ltcGxlUGF0aCA9IHNpbXBsZVBhdGhQYXR0ZXJuLmV4ZWMocmVzdCk7CgkgICAgaWYgKHNpbXBsZVBhdGgpIHsKCSAgICAgIHRoaXMucGF0aCA9IHJlc3Q7CgkgICAgICB0aGlzLmhyZWYgPSByZXN0OwoJICAgICAgdGhpcy5wYXRobmFtZSA9IHNpbXBsZVBhdGhbMV07CgkgICAgICBpZiAoc2ltcGxlUGF0aFsyXSkgewoJICAgICAgICB0aGlzLnNlYXJjaCA9IHNpbXBsZVBhdGhbMl07CgkgICAgICAgIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7CgkgICAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5c3RyaW5nLnBhcnNlKHRoaXMuc2VhcmNoLnN1YnN0cigxKSk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgdGhpcy5xdWVyeSA9IHRoaXMuc2VhcmNoLnN1YnN0cigxKTsKCSAgICAgICAgfQoJICAgICAgfSBlbHNlIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7CgkgICAgICAgIHRoaXMuc2VhcmNoID0gJyc7CgkgICAgICAgIHRoaXMucXVlcnkgPSB7fTsKCSAgICAgIH0KCSAgICAgIHJldHVybiB0aGlzOwoJICAgIH0KCSAgfQoKCSAgdmFyIHByb3RvID0gcHJvdG9jb2xQYXR0ZXJuLmV4ZWMocmVzdCk7CgkgIGlmIChwcm90bykgewoJICAgIHByb3RvID0gcHJvdG9bMF07CgkgICAgdmFyIGxvd2VyUHJvdG8gPSBwcm90by50b0xvd2VyQ2FzZSgpOwoJICAgIHRoaXMucHJvdG9jb2wgPSBsb3dlclByb3RvOwoJICAgIHJlc3QgPSByZXN0LnN1YnN0cihwcm90by5sZW5ndGgpOwoJICB9CgoJICAvLyBmaWd1cmUgb3V0IGlmIGl0J3MgZ290IGEgaG9zdAoJICAvLyB1c2VyQHNlcnZlciBpcyAqYWx3YXlzKiBpbnRlcnByZXRlZCBhcyBhIGhvc3RuYW1lLCBhbmQgdXJsCgkgIC8vIHJlc29sdXRpb24gd2lsbCB0cmVhdCAvL2Zvby9iYXIgYXMgaG9zdD1mb28scGF0aD1iYXIgYmVjYXVzZSB0aGF0J3MKCSAgLy8gaG93IHRoZSBicm93c2VyIHJlc29sdmVzIHJlbGF0aXZlIFVSTHMuCgkgIGlmIChzbGFzaGVzRGVub3RlSG9zdCB8fCBwcm90byB8fCByZXN0Lm1hdGNoKC9eXC9cL1teQFwvXStAW15AXC9dKy8pKSB7CgkgICAgdmFyIHNsYXNoZXMgPSByZXN0LnN1YnN0cigwLCAyKSA9PT0gJy8vJzsKCSAgICBpZiAoc2xhc2hlcyAmJiAhKHByb3RvICYmIGhvc3RsZXNzUHJvdG9jb2xbcHJvdG9dKSkgewoJICAgICAgcmVzdCA9IHJlc3Quc3Vic3RyKDIpOwoJICAgICAgdGhpcy5zbGFzaGVzID0gdHJ1ZTsKCSAgICB9CgkgIH0KCgkgIGlmICghaG9zdGxlc3NQcm90b2NvbFtwcm90b10gJiYKCSAgICAgIChzbGFzaGVzIHx8IChwcm90byAmJiAhc2xhc2hlZFByb3RvY29sW3Byb3RvXSkpKSB7CgoJICAgIC8vIHRoZXJlJ3MgYSBob3N0bmFtZS4KCSAgICAvLyB0aGUgZmlyc3QgaW5zdGFuY2Ugb2YgLywgPywgOywgb3IgIyBlbmRzIHRoZSBob3N0LgoJICAgIC8vCgkgICAgLy8gSWYgdGhlcmUgaXMgYW4gQCBpbiB0aGUgaG9zdG5hbWUsIHRoZW4gbm9uLWhvc3QgY2hhcnMgKmFyZSogYWxsb3dlZAoJICAgIC8vIHRvIHRoZSBsZWZ0IG9mIHRoZSBsYXN0IEAgc2lnbiwgdW5sZXNzIHNvbWUgaG9zdC1lbmRpbmcgY2hhcmFjdGVyCgkgICAgLy8gY29tZXMgKmJlZm9yZSogdGhlIEAtc2lnbi4KCSAgICAvLyBVUkxzIGFyZSBvYm5veGlvdXMuCgkgICAgLy8KCSAgICAvLyBleDoKCSAgICAvLyBodHRwOi8vYUBiQGMvID0+IHVzZXI6YUBiIGhvc3Q6YwoJICAgIC8vIGh0dHA6Ly9hQGI/QGMgPT4gdXNlcjphIGhvc3Q6YyBwYXRoOi8/QGMKCgkgICAgLy8gdjAuMTIgVE9ETyhpc2FhY3MpOiBUaGlzIGlzIG5vdCBxdWl0ZSBob3cgQ2hyb21lIGRvZXMgdGhpbmdzLgoJICAgIC8vIFJldmlldyBvdXIgdGVzdCBjYXNlIGFnYWluc3QgYnJvd3NlcnMgbW9yZSBjb21wcmVoZW5zaXZlbHkuCgoJICAgIC8vIGZpbmQgdGhlIGZpcnN0IGluc3RhbmNlIG9mIGFueSBob3N0RW5kaW5nQ2hhcnMKCSAgICB2YXIgaG9zdEVuZCA9IC0xOwoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaG9zdEVuZGluZ0NoYXJzLmxlbmd0aDsgaSsrKSB7CgkgICAgICB2YXIgaGVjID0gcmVzdC5pbmRleE9mKGhvc3RFbmRpbmdDaGFyc1tpXSk7CgkgICAgICBpZiAoaGVjICE9PSAtMSAmJiAoaG9zdEVuZCA9PT0gLTEgfHwgaGVjIDwgaG9zdEVuZCkpCgkgICAgICAgIGhvc3RFbmQgPSBoZWM7CgkgICAgfQoKCSAgICAvLyBhdCB0aGlzIHBvaW50LCBlaXRoZXIgd2UgaGF2ZSBhbiBleHBsaWNpdCBwb2ludCB3aGVyZSB0aGUKCSAgICAvLyBhdXRoIHBvcnRpb24gY2Fubm90IGdvIHBhc3QsIG9yIHRoZSBsYXN0IEAgY2hhciBpcyB0aGUgZGVjaWRlci4KCSAgICB2YXIgYXV0aCwgYXRTaWduOwoJICAgIGlmIChob3N0RW5kID09PSAtMSkgewoJICAgICAgLy8gYXRTaWduIGNhbiBiZSBhbnl3aGVyZS4KCSAgICAgIGF0U2lnbiA9IHJlc3QubGFzdEluZGV4T2YoJ0AnKTsKCSAgICB9IGVsc2UgewoJICAgICAgLy8gYXRTaWduIG11c3QgYmUgaW4gYXV0aCBwb3J0aW9uLgoJICAgICAgLy8gaHR0cDovL2FAYi9jQGQgPT4gaG9zdDpiIGF1dGg6YSBwYXRoOi9jQGQKCSAgICAgIGF0U2lnbiA9IHJlc3QubGFzdEluZGV4T2YoJ0AnLCBob3N0RW5kKTsKCSAgICB9CgoJICAgIC8vIE5vdyB3ZSBoYXZlIGEgcG9ydGlvbiB3aGljaCBpcyBkZWZpbml0ZWx5IHRoZSBhdXRoLgoJICAgIC8vIFB1bGwgdGhhdCBvZmYuCgkgICAgaWYgKGF0U2lnbiAhPT0gLTEpIHsKCSAgICAgIGF1dGggPSByZXN0LnNsaWNlKDAsIGF0U2lnbik7CgkgICAgICByZXN0ID0gcmVzdC5zbGljZShhdFNpZ24gKyAxKTsKCSAgICAgIHRoaXMuYXV0aCA9IGRlY29kZVVSSUNvbXBvbmVudChhdXRoKTsKCSAgICB9CgoJICAgIC8vIHRoZSBob3N0IGlzIHRoZSByZW1haW5pbmcgdG8gdGhlIGxlZnQgb2YgdGhlIGZpcnN0IG5vbi1ob3N0IGNoYXIKCSAgICBob3N0RW5kID0gLTE7CgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub25Ib3N0Q2hhcnMubGVuZ3RoOyBpKyspIHsKCSAgICAgIHZhciBoZWMgPSByZXN0LmluZGV4T2Yobm9uSG9zdENoYXJzW2ldKTsKCSAgICAgIGlmIChoZWMgIT09IC0xICYmIChob3N0RW5kID09PSAtMSB8fCBoZWMgPCBob3N0RW5kKSkKCSAgICAgICAgaG9zdEVuZCA9IGhlYzsKCSAgICB9CgkgICAgLy8gaWYgd2Ugc3RpbGwgaGF2ZSBub3QgaGl0IGl0LCB0aGVuIHRoZSBlbnRpcmUgdGhpbmcgaXMgYSBob3N0LgoJICAgIGlmIChob3N0RW5kID09PSAtMSkKCSAgICAgIGhvc3RFbmQgPSByZXN0Lmxlbmd0aDsKCgkgICAgdGhpcy5ob3N0ID0gcmVzdC5zbGljZSgwLCBob3N0RW5kKTsKCSAgICByZXN0ID0gcmVzdC5zbGljZShob3N0RW5kKTsKCgkgICAgLy8gcHVsbCBvdXQgcG9ydC4KCSAgICB0aGlzLnBhcnNlSG9zdCgpOwoKCSAgICAvLyB3ZSd2ZSBpbmRpY2F0ZWQgdGhhdCB0aGVyZSBpcyBhIGhvc3RuYW1lLAoJICAgIC8vIHNvIGV2ZW4gaWYgaXQncyBlbXB0eSwgaXQgaGFzIHRvIGJlIHByZXNlbnQuCgkgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUgfHwgJyc7CgoJICAgIC8vIGlmIGhvc3RuYW1lIGJlZ2lucyB3aXRoIFsgYW5kIGVuZHMgd2l0aCBdCgkgICAgLy8gYXNzdW1lIHRoYXQgaXQncyBhbiBJUHY2IGFkZHJlc3MuCgkgICAgdmFyIGlwdjZIb3N0bmFtZSA9IHRoaXMuaG9zdG5hbWVbMF0gPT09ICdbJyAmJgoJICAgICAgICB0aGlzLmhvc3RuYW1lW3RoaXMuaG9zdG5hbWUubGVuZ3RoIC0gMV0gPT09ICddJzsKCgkgICAgLy8gdmFsaWRhdGUgYSBsaXR0bGUuCgkgICAgaWYgKCFpcHY2SG9zdG5hbWUpIHsKCSAgICAgIHZhciBob3N0cGFydHMgPSB0aGlzLmhvc3RuYW1lLnNwbGl0KC9cLi8pOwoJICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBob3N0cGFydHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgICAgIHZhciBwYXJ0ID0gaG9zdHBhcnRzW2ldOwoJICAgICAgICBpZiAoIXBhcnQpIGNvbnRpbnVlOwoJICAgICAgICBpZiAoIXBhcnQubWF0Y2goaG9zdG5hbWVQYXJ0UGF0dGVybikpIHsKCSAgICAgICAgICB2YXIgbmV3cGFydCA9ICcnOwoJICAgICAgICAgIGZvciAodmFyIGogPSAwLCBrID0gcGFydC5sZW5ndGg7IGogPCBrOyBqKyspIHsKCSAgICAgICAgICAgIGlmIChwYXJ0LmNoYXJDb2RlQXQoaikgPiAxMjcpIHsKCSAgICAgICAgICAgICAgLy8gd2UgcmVwbGFjZSBub24tQVNDSUkgY2hhciB3aXRoIGEgdGVtcG9yYXJ5IHBsYWNlaG9sZGVyCgkgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdGhpcyB0byBtYWtlIHN1cmUgc2l6ZSBvZiBob3N0bmFtZSBpcyBub3QKCSAgICAgICAgICAgICAgLy8gYnJva2VuIGJ5IHJlcGxhY2luZyBub24tQVNDSUkgYnkgbm90aGluZwoJICAgICAgICAgICAgICBuZXdwYXJ0ICs9ICd4JzsKCSAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgIG5ld3BhcnQgKz0gcGFydFtqXTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgICAgLy8gd2UgdGVzdCBhZ2FpbiB3aXRoIEFTQ0lJIGNoYXIgb25seQoJICAgICAgICAgIGlmICghbmV3cGFydC5tYXRjaChob3N0bmFtZVBhcnRQYXR0ZXJuKSkgewoJICAgICAgICAgICAgdmFyIHZhbGlkUGFydHMgPSBob3N0cGFydHMuc2xpY2UoMCwgaSk7CgkgICAgICAgICAgICB2YXIgbm90SG9zdCA9IGhvc3RwYXJ0cy5zbGljZShpICsgMSk7CgkgICAgICAgICAgICB2YXIgYml0ID0gcGFydC5tYXRjaChob3N0bmFtZVBhcnRTdGFydCk7CgkgICAgICAgICAgICBpZiAoYml0KSB7CgkgICAgICAgICAgICAgIHZhbGlkUGFydHMucHVzaChiaXRbMV0pOwoJICAgICAgICAgICAgICBub3RIb3N0LnVuc2hpZnQoYml0WzJdKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChub3RIb3N0Lmxlbmd0aCkgewoJICAgICAgICAgICAgICByZXN0ID0gJy8nICsgbm90SG9zdC5qb2luKCcuJykgKyByZXN0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdGhpcy5ob3N0bmFtZSA9IHZhbGlkUGFydHMuam9pbignLicpOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICB9CgkgICAgfQoKCSAgICBpZiAodGhpcy5ob3N0bmFtZS5sZW5ndGggPiBob3N0bmFtZU1heExlbikgewoJICAgICAgdGhpcy5ob3N0bmFtZSA9ICcnOwoJICAgIH0gZWxzZSB7CgkgICAgICAvLyBob3N0bmFtZXMgYXJlIGFsd2F5cyBsb3dlciBjYXNlLgoJICAgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTsKCSAgICB9CgoJICAgIGlmICghaXB2Nkhvc3RuYW1lKSB7CgkgICAgICAvLyBJRE5BIFN1cHBvcnQ6IFJldHVybnMgYSBwdW55Y29kZWQgcmVwcmVzZW50YXRpb24gb2YgImRvbWFpbiIuCgkgICAgICAvLyBJdCBvbmx5IGNvbnZlcnRzIHBhcnRzIG9mIHRoZSBkb21haW4gbmFtZSB0aGF0CgkgICAgICAvLyBoYXZlIG5vbi1BU0NJSSBjaGFyYWN0ZXJzLCBpLmUuIGl0IGRvZXNuJ3QgbWF0dGVyIGlmCgkgICAgICAvLyB5b3UgY2FsbCBpdCB3aXRoIGEgZG9tYWluIHRoYXQgYWxyZWFkeSBpcyBBU0NJSS1vbmx5LgoJICAgICAgdGhpcy5ob3N0bmFtZSA9IHB1bnljb2RlLnRvQVNDSUkodGhpcy5ob3N0bmFtZSk7CgkgICAgfQoKCSAgICB2YXIgcCA9IHRoaXMucG9ydCA/ICc6JyArIHRoaXMucG9ydCA6ICcnOwoJICAgIHZhciBoID0gdGhpcy5ob3N0bmFtZSB8fCAnJzsKCSAgICB0aGlzLmhvc3QgPSBoICsgcDsKCSAgICB0aGlzLmhyZWYgKz0gdGhpcy5ob3N0OwoKCSAgICAvLyBzdHJpcCBbIGFuZCBdIGZyb20gdGhlIGhvc3RuYW1lCgkgICAgLy8gdGhlIGhvc3QgZmllbGQgc3RpbGwgcmV0YWlucyB0aGVtLCB0aG91Z2gKCSAgICBpZiAoaXB2Nkhvc3RuYW1lKSB7CgkgICAgICB0aGlzLmhvc3RuYW1lID0gdGhpcy5ob3N0bmFtZS5zdWJzdHIoMSwgdGhpcy5ob3N0bmFtZS5sZW5ndGggLSAyKTsKCSAgICAgIGlmIChyZXN0WzBdICE9PSAnLycpIHsKCSAgICAgICAgcmVzdCA9ICcvJyArIHJlc3Q7CgkgICAgICB9CgkgICAgfQoJICB9CgoJICAvLyBub3cgcmVzdCBpcyBzZXQgdG8gdGhlIHBvc3QtaG9zdCBzdHVmZi4KCSAgLy8gY2hvcCBvZmYgYW55IGRlbGltIGNoYXJzLgoJICBpZiAoIXVuc2FmZVByb3RvY29sW2xvd2VyUHJvdG9dKSB7CgoJICAgIC8vIEZpcnN0LCBtYWtlIDEwMCUgc3VyZSB0aGF0IGFueSAiYXV0b0VzY2FwZSIgY2hhcnMgZ2V0CgkgICAgLy8gZXNjYXBlZCwgZXZlbiBpZiBlbmNvZGVVUklDb21wb25lbnQgZG9lc24ndCB0aGluayB0aGV5CgkgICAgLy8gbmVlZCB0byBiZS4KCSAgICBmb3IgKHZhciBpID0gMCwgbCA9IGF1dG9Fc2NhcGUubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgICB2YXIgYWUgPSBhdXRvRXNjYXBlW2ldOwoJICAgICAgaWYgKHJlc3QuaW5kZXhPZihhZSkgPT09IC0xKQoJICAgICAgICBjb250aW51ZTsKCSAgICAgIHZhciBlc2MgPSBlbmNvZGVVUklDb21wb25lbnQoYWUpOwoJICAgICAgaWYgKGVzYyA9PT0gYWUpIHsKCSAgICAgICAgZXNjID0gZXNjYXBlKGFlKTsKCSAgICAgIH0KCSAgICAgIHJlc3QgPSByZXN0LnNwbGl0KGFlKS5qb2luKGVzYyk7CgkgICAgfQoJICB9CgoKCSAgLy8gY2hvcCBvZmYgZnJvbSB0aGUgdGFpbCBmaXJzdC4KCSAgdmFyIGhhc2ggPSByZXN0LmluZGV4T2YoJyMnKTsKCSAgaWYgKGhhc2ggIT09IC0xKSB7CgkgICAgLy8gZ290IGEgZnJhZ21lbnQgc3RyaW5nLgoJICAgIHRoaXMuaGFzaCA9IHJlc3Quc3Vic3RyKGhhc2gpOwoJICAgIHJlc3QgPSByZXN0LnNsaWNlKDAsIGhhc2gpOwoJICB9CgkgIHZhciBxbSA9IHJlc3QuaW5kZXhPZignPycpOwoJICBpZiAocW0gIT09IC0xKSB7CgkgICAgdGhpcy5zZWFyY2ggPSByZXN0LnN1YnN0cihxbSk7CgkgICAgdGhpcy5xdWVyeSA9IHJlc3Quc3Vic3RyKHFtICsgMSk7CgkgICAgaWYgKHBhcnNlUXVlcnlTdHJpbmcpIHsKCSAgICAgIHRoaXMucXVlcnkgPSBxdWVyeXN0cmluZy5wYXJzZSh0aGlzLnF1ZXJ5KTsKCSAgICB9CgkgICAgcmVzdCA9IHJlc3Quc2xpY2UoMCwgcW0pOwoJICB9IGVsc2UgaWYgKHBhcnNlUXVlcnlTdHJpbmcpIHsKCSAgICAvLyBubyBxdWVyeSBzdHJpbmcsIGJ1dCBwYXJzZVF1ZXJ5U3RyaW5nIHN0aWxsIHJlcXVlc3RlZAoJICAgIHRoaXMuc2VhcmNoID0gJyc7CgkgICAgdGhpcy5xdWVyeSA9IHt9OwoJICB9CgkgIGlmIChyZXN0KSB0aGlzLnBhdGhuYW1lID0gcmVzdDsKCSAgaWYgKHNsYXNoZWRQcm90b2NvbFtsb3dlclByb3RvXSAmJgoJICAgICAgdGhpcy5ob3N0bmFtZSAmJiAhdGhpcy5wYXRobmFtZSkgewoJICAgIHRoaXMucGF0aG5hbWUgPSAnLyc7CgkgIH0KCgkgIC8vdG8gc3VwcG9ydCBodHRwLnJlcXVlc3QKCSAgaWYgKHRoaXMucGF0aG5hbWUgfHwgdGhpcy5zZWFyY2gpIHsKCSAgICB2YXIgcCA9IHRoaXMucGF0aG5hbWUgfHwgJyc7CgkgICAgdmFyIHMgPSB0aGlzLnNlYXJjaCB8fCAnJzsKCSAgICB0aGlzLnBhdGggPSBwICsgczsKCSAgfQoKCSAgLy8gZmluYWxseSwgcmVjb25zdHJ1Y3QgdGhlIGhyZWYgYmFzZWQgb24gd2hhdCBoYXMgYmVlbiB2YWxpZGF0ZWQuCgkgIHRoaXMuaHJlZiA9IHRoaXMuZm9ybWF0KCk7CgkgIHJldHVybiB0aGlzOwoJfTsKCgkvLyBmb3JtYXQgYSBwYXJzZWQgb2JqZWN0IGludG8gYSB1cmwgc3RyaW5nCglmdW5jdGlvbiB1cmxGb3JtYXQob2JqKSB7CgkgIC8vIGVuc3VyZSBpdCdzIGFuIG9iamVjdCwgYW5kIG5vdCBhIHN0cmluZyB1cmwuCgkgIC8vIElmIGl0J3MgYW4gb2JqLCB0aGlzIGlzIGEgbm8tb3AuCgkgIC8vIHRoaXMgd2F5LCB5b3UgY2FuIGNhbGwgdXJsX2Zvcm1hdCgpIG9uIHN0cmluZ3MKCSAgLy8gdG8gY2xlYW4gdXAgcG90ZW50aWFsbHkgd29ua3kgdXJscy4KCSAgaWYgKHV0aWwuaXNTdHJpbmcob2JqKSkgb2JqID0gdXJsUGFyc2Uob2JqKTsKCSAgaWYgKCEob2JqIGluc3RhbmNlb2YgVXJsKSkgcmV0dXJuIFVybC5wcm90b3R5cGUuZm9ybWF0LmNhbGwob2JqKTsKCSAgcmV0dXJuIG9iai5mb3JtYXQoKTsKCX0KCglVcmwucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uKCkgewoJICB2YXIgYXV0aCA9IHRoaXMuYXV0aCB8fCAnJzsKCSAgaWYgKGF1dGgpIHsKCSAgICBhdXRoID0gZW5jb2RlVVJJQ29tcG9uZW50KGF1dGgpOwoJICAgIGF1dGggPSBhdXRoLnJlcGxhY2UoLyUzQS9pLCAnOicpOwoJICAgIGF1dGggKz0gJ0AnOwoJICB9CgoJICB2YXIgcHJvdG9jb2wgPSB0aGlzLnByb3RvY29sIHx8ICcnLAoJICAgICAgcGF0aG5hbWUgPSB0aGlzLnBhdGhuYW1lIHx8ICcnLAoJICAgICAgaGFzaCA9IHRoaXMuaGFzaCB8fCAnJywKCSAgICAgIGhvc3QgPSBmYWxzZSwKCSAgICAgIHF1ZXJ5ID0gJyc7CgoJICBpZiAodGhpcy5ob3N0KSB7CgkgICAgaG9zdCA9IGF1dGggKyB0aGlzLmhvc3Q7CgkgIH0gZWxzZSBpZiAodGhpcy5ob3N0bmFtZSkgewoJICAgIGhvc3QgPSBhdXRoICsgKHRoaXMuaG9zdG5hbWUuaW5kZXhPZignOicpID09PSAtMSA/CgkgICAgICAgIHRoaXMuaG9zdG5hbWUgOgoJICAgICAgICAnWycgKyB0aGlzLmhvc3RuYW1lICsgJ10nKTsKCSAgICBpZiAodGhpcy5wb3J0KSB7CgkgICAgICBob3N0ICs9ICc6JyArIHRoaXMucG9ydDsKCSAgICB9CgkgIH0KCgkgIGlmICh0aGlzLnF1ZXJ5ICYmCgkgICAgICB1dGlsLmlzT2JqZWN0KHRoaXMucXVlcnkpICYmCgkgICAgICBPYmplY3Qua2V5cyh0aGlzLnF1ZXJ5KS5sZW5ndGgpIHsKCSAgICBxdWVyeSA9IHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeSh0aGlzLnF1ZXJ5KTsKCSAgfQoKCSAgdmFyIHNlYXJjaCA9IHRoaXMuc2VhcmNoIHx8IChxdWVyeSAmJiAoJz8nICsgcXVlcnkpKSB8fCAnJzsKCgkgIGlmIChwcm90b2NvbCAmJiBwcm90b2NvbC5zdWJzdHIoLTEpICE9PSAnOicpIHByb3RvY29sICs9ICc6JzsKCgkgIC8vIG9ubHkgdGhlIHNsYXNoZWRQcm90b2NvbHMgZ2V0IHRoZSAvLy4gIE5vdCBtYWlsdG86LCB4bXBwOiwgZXRjLgoJICAvLyB1bmxlc3MgdGhleSBoYWQgdGhlbSB0byBiZWdpbiB3aXRoLgoJICBpZiAodGhpcy5zbGFzaGVzIHx8CgkgICAgICAoIXByb3RvY29sIHx8IHNsYXNoZWRQcm90b2NvbFtwcm90b2NvbF0pICYmIGhvc3QgIT09IGZhbHNlKSB7CgkgICAgaG9zdCA9ICcvLycgKyAoaG9zdCB8fCAnJyk7CgkgICAgaWYgKHBhdGhuYW1lICYmIHBhdGhuYW1lLmNoYXJBdCgwKSAhPT0gJy8nKSBwYXRobmFtZSA9ICcvJyArIHBhdGhuYW1lOwoJICB9IGVsc2UgaWYgKCFob3N0KSB7CgkgICAgaG9zdCA9ICcnOwoJICB9CgoJICBpZiAoaGFzaCAmJiBoYXNoLmNoYXJBdCgwKSAhPT0gJyMnKSBoYXNoID0gJyMnICsgaGFzaDsKCSAgaWYgKHNlYXJjaCAmJiBzZWFyY2guY2hhckF0KDApICE9PSAnPycpIHNlYXJjaCA9ICc/JyArIHNlYXJjaDsKCgkgIHBhdGhuYW1lID0gcGF0aG5hbWUucmVwbGFjZSgvWz8jXS9nLCBmdW5jdGlvbihtYXRjaCkgewoJICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQobWF0Y2gpOwoJICB9KTsKCSAgc2VhcmNoID0gc2VhcmNoLnJlcGxhY2UoJyMnLCAnJTIzJyk7CgoJICByZXR1cm4gcHJvdG9jb2wgKyBob3N0ICsgcGF0aG5hbWUgKyBzZWFyY2ggKyBoYXNoOwoJfTsKCglmdW5jdGlvbiB1cmxSZXNvbHZlKHNvdXJjZSwgcmVsYXRpdmUpIHsKCSAgcmV0dXJuIHVybFBhcnNlKHNvdXJjZSwgZmFsc2UsIHRydWUpLnJlc29sdmUocmVsYXRpdmUpOwoJfQoKCVVybC5wcm90b3R5cGUucmVzb2x2ZSA9IGZ1bmN0aW9uKHJlbGF0aXZlKSB7CgkgIHJldHVybiB0aGlzLnJlc29sdmVPYmplY3QodXJsUGFyc2UocmVsYXRpdmUsIGZhbHNlLCB0cnVlKSkuZm9ybWF0KCk7Cgl9OwoKCWZ1bmN0aW9uIHVybFJlc29sdmVPYmplY3Qoc291cmNlLCByZWxhdGl2ZSkgewoJICBpZiAoIXNvdXJjZSkgcmV0dXJuIHJlbGF0aXZlOwoJICByZXR1cm4gdXJsUGFyc2Uoc291cmNlLCBmYWxzZSwgdHJ1ZSkucmVzb2x2ZU9iamVjdChyZWxhdGl2ZSk7Cgl9CgoJVXJsLnByb3RvdHlwZS5yZXNvbHZlT2JqZWN0ID0gZnVuY3Rpb24ocmVsYXRpdmUpIHsKCSAgaWYgKHV0aWwuaXNTdHJpbmcocmVsYXRpdmUpKSB7CgkgICAgdmFyIHJlbCA9IG5ldyBVcmwoKTsKCSAgICByZWwucGFyc2UocmVsYXRpdmUsIGZhbHNlLCB0cnVlKTsKCSAgICByZWxhdGl2ZSA9IHJlbDsKCSAgfQoKCSAgdmFyIHJlc3VsdCA9IG5ldyBVcmwoKTsKCSAgdmFyIHRrZXlzID0gT2JqZWN0LmtleXModGhpcyk7CgkgIGZvciAodmFyIHRrID0gMDsgdGsgPCB0a2V5cy5sZW5ndGg7IHRrKyspIHsKCSAgICB2YXIgdGtleSA9IHRrZXlzW3RrXTsKCSAgICByZXN1bHRbdGtleV0gPSB0aGlzW3RrZXldOwoJICB9CgoJICAvLyBoYXNoIGlzIGFsd2F5cyBvdmVycmlkZGVuLCBubyBtYXR0ZXIgd2hhdC4KCSAgLy8gZXZlbiBocmVmPSIiIHdpbGwgcmVtb3ZlIGl0LgoJICByZXN1bHQuaGFzaCA9IHJlbGF0aXZlLmhhc2g7CgoJICAvLyBpZiB0aGUgcmVsYXRpdmUgdXJsIGlzIGVtcHR5LCB0aGVuIHRoZXJlJ3Mgbm90aGluZyBsZWZ0IHRvIGRvIGhlcmUuCgkgIGlmIChyZWxhdGl2ZS5ocmVmID09PSAnJykgewoJICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpOwoJICAgIHJldHVybiByZXN1bHQ7CgkgIH0KCgkgIC8vIGhyZWZzIGxpa2UgLy9mb28vYmFyIGFsd2F5cyBjdXQgdG8gdGhlIHByb3RvY29sLgoJICBpZiAocmVsYXRpdmUuc2xhc2hlcyAmJiAhcmVsYXRpdmUucHJvdG9jb2wpIHsKCSAgICAvLyB0YWtlIGV2ZXJ5dGhpbmcgZXhjZXB0IHRoZSBwcm90b2NvbCBmcm9tIHJlbGF0aXZlCgkgICAgdmFyIHJrZXlzID0gT2JqZWN0LmtleXMocmVsYXRpdmUpOwoJICAgIGZvciAodmFyIHJrID0gMDsgcmsgPCBya2V5cy5sZW5ndGg7IHJrKyspIHsKCSAgICAgIHZhciBya2V5ID0gcmtleXNbcmtdOwoJICAgICAgaWYgKHJrZXkgIT09ICdwcm90b2NvbCcpCgkgICAgICAgIHJlc3VsdFtya2V5XSA9IHJlbGF0aXZlW3JrZXldOwoJICAgIH0KCgkgICAgLy91cmxQYXJzZSBhcHBlbmRzIHRyYWlsaW5nIC8gdG8gdXJscyBsaWtlIGh0dHA6Ly93d3cuZXhhbXBsZS5jb20KCSAgICBpZiAoc2xhc2hlZFByb3RvY29sW3Jlc3VsdC5wcm90b2NvbF0gJiYKCSAgICAgICAgcmVzdWx0Lmhvc3RuYW1lICYmICFyZXN1bHQucGF0aG5hbWUpIHsKCSAgICAgIHJlc3VsdC5wYXRoID0gcmVzdWx0LnBhdGhuYW1lID0gJy8nOwoJICAgIH0KCgkgICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7CgkgICAgcmV0dXJuIHJlc3VsdDsKCSAgfQoKCSAgaWYgKHJlbGF0aXZlLnByb3RvY29sICYmIHJlbGF0aXZlLnByb3RvY29sICE9PSByZXN1bHQucHJvdG9jb2wpIHsKCSAgICAvLyBpZiBpdCdzIGEga25vd24gdXJsIHByb3RvY29sLCB0aGVuIGNoYW5naW5nCgkgICAgLy8gdGhlIHByb3RvY29sIGRvZXMgd2VpcmQgdGhpbmdzCgkgICAgLy8gZmlyc3QsIGlmIGl0J3Mgbm90IGZpbGU6LCB0aGVuIHdlIE1VU1QgaGF2ZSBhIGhvc3QsCgkgICAgLy8gYW5kIGlmIHRoZXJlIHdhcyBhIHBhdGgKCSAgICAvLyB0byBiZWdpbiB3aXRoLCB0aGVuIHdlIE1VU1QgaGF2ZSBhIHBhdGguCgkgICAgLy8gaWYgaXQgaXMgZmlsZTosIHRoZW4gdGhlIGhvc3QgaXMgZHJvcHBlZCwKCSAgICAvLyBiZWNhdXNlIHRoYXQncyBrbm93biB0byBiZSBob3N0bGVzcy4KCSAgICAvLyBhbnl0aGluZyBlbHNlIGlzIGFzc3VtZWQgdG8gYmUgYWJzb2x1dGUuCgkgICAgaWYgKCFzbGFzaGVkUHJvdG9jb2xbcmVsYXRpdmUucHJvdG9jb2xdKSB7CgkgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHJlbGF0aXZlKTsKCSAgICAgIGZvciAodmFyIHYgPSAwOyB2IDwga2V5cy5sZW5ndGg7IHYrKykgewoJICAgICAgICB2YXIgayA9IGtleXNbdl07CgkgICAgICAgIHJlc3VsdFtrXSA9IHJlbGF0aXZlW2tdOwoJICAgICAgfQoJICAgICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7CgkgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH0KCgkgICAgcmVzdWx0LnByb3RvY29sID0gcmVsYXRpdmUucHJvdG9jb2w7CgkgICAgaWYgKCFyZWxhdGl2ZS5ob3N0ICYmICFob3N0bGVzc1Byb3RvY29sW3JlbGF0aXZlLnByb3RvY29sXSkgewoJICAgICAgdmFyIHJlbFBhdGggPSAocmVsYXRpdmUucGF0aG5hbWUgfHwgJycpLnNwbGl0KCcvJyk7CgkgICAgICB3aGlsZSAocmVsUGF0aC5sZW5ndGggJiYgIShyZWxhdGl2ZS5ob3N0ID0gcmVsUGF0aC5zaGlmdCgpKSk7CgkgICAgICBpZiAoIXJlbGF0aXZlLmhvc3QpIHJlbGF0aXZlLmhvc3QgPSAnJzsKCSAgICAgIGlmICghcmVsYXRpdmUuaG9zdG5hbWUpIHJlbGF0aXZlLmhvc3RuYW1lID0gJyc7CgkgICAgICBpZiAocmVsUGF0aFswXSAhPT0gJycpIHJlbFBhdGgudW5zaGlmdCgnJyk7CgkgICAgICBpZiAocmVsUGF0aC5sZW5ndGggPCAyKSByZWxQYXRoLnVuc2hpZnQoJycpOwoJICAgICAgcmVzdWx0LnBhdGhuYW1lID0gcmVsUGF0aC5qb2luKCcvJyk7CgkgICAgfSBlbHNlIHsKCSAgICAgIHJlc3VsdC5wYXRobmFtZSA9IHJlbGF0aXZlLnBhdGhuYW1lOwoJICAgIH0KCSAgICByZXN1bHQuc2VhcmNoID0gcmVsYXRpdmUuc2VhcmNoOwoJICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5OwoJICAgIHJlc3VsdC5ob3N0ID0gcmVsYXRpdmUuaG9zdCB8fCAnJzsKCSAgICByZXN1bHQuYXV0aCA9IHJlbGF0aXZlLmF1dGg7CgkgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVsYXRpdmUuaG9zdG5hbWUgfHwgcmVsYXRpdmUuaG9zdDsKCSAgICByZXN1bHQucG9ydCA9IHJlbGF0aXZlLnBvcnQ7CgkgICAgLy8gdG8gc3VwcG9ydCBodHRwLnJlcXVlc3QKCSAgICBpZiAocmVzdWx0LnBhdGhuYW1lIHx8IHJlc3VsdC5zZWFyY2gpIHsKCSAgICAgIHZhciBwID0gcmVzdWx0LnBhdGhuYW1lIHx8ICcnOwoJICAgICAgdmFyIHMgPSByZXN1bHQuc2VhcmNoIHx8ICcnOwoJICAgICAgcmVzdWx0LnBhdGggPSBwICsgczsKCSAgICB9CgkgICAgcmVzdWx0LnNsYXNoZXMgPSByZXN1bHQuc2xhc2hlcyB8fCByZWxhdGl2ZS5zbGFzaGVzOwoJICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpOwoJICAgIHJldHVybiByZXN1bHQ7CgkgIH0KCgkgIHZhciBpc1NvdXJjZUFicyA9IChyZXN1bHQucGF0aG5hbWUgJiYgcmVzdWx0LnBhdGhuYW1lLmNoYXJBdCgwKSA9PT0gJy8nKSwKCSAgICAgIGlzUmVsQWJzID0gKAoJICAgICAgICAgIHJlbGF0aXZlLmhvc3QgfHwKCSAgICAgICAgICByZWxhdGl2ZS5wYXRobmFtZSAmJiByZWxhdGl2ZS5wYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJwoJICAgICAgKSwKCSAgICAgIG11c3RFbmRBYnMgPSAoaXNSZWxBYnMgfHwgaXNTb3VyY2VBYnMgfHwKCSAgICAgICAgICAgICAgICAgICAgKHJlc3VsdC5ob3N0ICYmIHJlbGF0aXZlLnBhdGhuYW1lKSksCgkgICAgICByZW1vdmVBbGxEb3RzID0gbXVzdEVuZEFicywKCSAgICAgIHNyY1BhdGggPSByZXN1bHQucGF0aG5hbWUgJiYgcmVzdWx0LnBhdGhuYW1lLnNwbGl0KCcvJykgfHwgW10sCgkgICAgICByZWxQYXRoID0gcmVsYXRpdmUucGF0aG5hbWUgJiYgcmVsYXRpdmUucGF0aG5hbWUuc3BsaXQoJy8nKSB8fCBbXSwKCSAgICAgIHBzeWNob3RpYyA9IHJlc3VsdC5wcm90b2NvbCAmJiAhc2xhc2hlZFByb3RvY29sW3Jlc3VsdC5wcm90b2NvbF07CgoJICAvLyBpZiB0aGUgdXJsIGlzIGEgbm9uLXNsYXNoZWQgdXJsLCB0aGVuIHJlbGF0aXZlCgkgIC8vIGxpbmtzIGxpa2UgLi4vLi4gc2hvdWxkIGJlIGFibGUKCSAgLy8gdG8gY3Jhd2wgdXAgdG8gdGhlIGhvc3RuYW1lLCBhcyB3ZWxsLiAgVGhpcyBpcyBzdHJhbmdlLgoJICAvLyByZXN1bHQucHJvdG9jb2wgaGFzIGFscmVhZHkgYmVlbiBzZXQgYnkgbm93LgoJICAvLyBMYXRlciBvbiwgcHV0IHRoZSBmaXJzdCBwYXRoIHBhcnQgaW50byB0aGUgaG9zdCBmaWVsZC4KCSAgaWYgKHBzeWNob3RpYykgewoJICAgIHJlc3VsdC5ob3N0bmFtZSA9ICcnOwoJICAgIHJlc3VsdC5wb3J0ID0gbnVsbDsKCSAgICBpZiAocmVzdWx0Lmhvc3QpIHsKCSAgICAgIGlmIChzcmNQYXRoWzBdID09PSAnJykgc3JjUGF0aFswXSA9IHJlc3VsdC5ob3N0OwoJICAgICAgZWxzZSBzcmNQYXRoLnVuc2hpZnQocmVzdWx0Lmhvc3QpOwoJICAgIH0KCSAgICByZXN1bHQuaG9zdCA9ICcnOwoJICAgIGlmIChyZWxhdGl2ZS5wcm90b2NvbCkgewoJICAgICAgcmVsYXRpdmUuaG9zdG5hbWUgPSBudWxsOwoJICAgICAgcmVsYXRpdmUucG9ydCA9IG51bGw7CgkgICAgICBpZiAocmVsYXRpdmUuaG9zdCkgewoJICAgICAgICBpZiAocmVsUGF0aFswXSA9PT0gJycpIHJlbFBhdGhbMF0gPSByZWxhdGl2ZS5ob3N0OwoJICAgICAgICBlbHNlIHJlbFBhdGgudW5zaGlmdChyZWxhdGl2ZS5ob3N0KTsKCSAgICAgIH0KCSAgICAgIHJlbGF0aXZlLmhvc3QgPSBudWxsOwoJICAgIH0KCSAgICBtdXN0RW5kQWJzID0gbXVzdEVuZEFicyAmJiAocmVsUGF0aFswXSA9PT0gJycgfHwgc3JjUGF0aFswXSA9PT0gJycpOwoJICB9CgoJICBpZiAoaXNSZWxBYnMpIHsKCSAgICAvLyBpdCdzIGFic29sdXRlLgoJICAgIHJlc3VsdC5ob3N0ID0gKHJlbGF0aXZlLmhvc3QgfHwgcmVsYXRpdmUuaG9zdCA9PT0gJycpID8KCSAgICAgICAgICAgICAgICAgIHJlbGF0aXZlLmhvc3QgOiByZXN1bHQuaG9zdDsKCSAgICByZXN1bHQuaG9zdG5hbWUgPSAocmVsYXRpdmUuaG9zdG5hbWUgfHwgcmVsYXRpdmUuaG9zdG5hbWUgPT09ICcnKSA/CgkgICAgICAgICAgICAgICAgICAgICAgcmVsYXRpdmUuaG9zdG5hbWUgOiByZXN1bHQuaG9zdG5hbWU7CgkgICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDsKCSAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTsKCSAgICBzcmNQYXRoID0gcmVsUGF0aDsKCSAgICAvLyBmYWxsIHRocm91Z2ggdG8gdGhlIGRvdC1oYW5kbGluZyBiZWxvdy4KCSAgfSBlbHNlIGlmIChyZWxQYXRoLmxlbmd0aCkgewoJICAgIC8vIGl0J3MgcmVsYXRpdmUKCSAgICAvLyB0aHJvdyBhd2F5IHRoZSBleGlzdGluZyBmaWxlLCBhbmQgdGFrZSB0aGUgbmV3IHBhdGggaW5zdGVhZC4KCSAgICBpZiAoIXNyY1BhdGgpIHNyY1BhdGggPSBbXTsKCSAgICBzcmNQYXRoLnBvcCgpOwoJICAgIHNyY1BhdGggPSBzcmNQYXRoLmNvbmNhdChyZWxQYXRoKTsKCSAgICByZXN1bHQuc2VhcmNoID0gcmVsYXRpdmUuc2VhcmNoOwoJICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5OwoJICB9IGVsc2UgaWYgKCF1dGlsLmlzTnVsbE9yVW5kZWZpbmVkKHJlbGF0aXZlLnNlYXJjaCkpIHsKCSAgICAvLyBqdXN0IHB1bGwgb3V0IHRoZSBzZWFyY2guCgkgICAgLy8gbGlrZSBocmVmPSc/Zm9vJy4KCSAgICAvLyBQdXQgdGhpcyBhZnRlciB0aGUgb3RoZXIgdHdvIGNhc2VzIGJlY2F1c2UgaXQgc2ltcGxpZmllcyB0aGUgYm9vbGVhbnMKCSAgICBpZiAocHN5Y2hvdGljKSB7CgkgICAgICByZXN1bHQuaG9zdG5hbWUgPSByZXN1bHQuaG9zdCA9IHNyY1BhdGguc2hpZnQoKTsKCSAgICAgIC8vb2NjYXRpb25hbHkgdGhlIGF1dGggY2FuIGdldCBzdHVjayBvbmx5IGluIGhvc3QKCSAgICAgIC8vdGhpcyBlc3BlY2lhbGx5IGhhcHBlbnMgaW4gY2FzZXMgbGlrZQoJICAgICAgLy91cmwucmVzb2x2ZU9iamVjdCgnbWFpbHRvOmxvY2FsMUBkb21haW4xJywgJ2xvY2FsMkBkb21haW4yJykKCSAgICAgIHZhciBhdXRoSW5Ib3N0ID0gcmVzdWx0Lmhvc3QgJiYgcmVzdWx0Lmhvc3QuaW5kZXhPZignQCcpID4gMCA/CgkgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ob3N0LnNwbGl0KCdAJykgOiBmYWxzZTsKCSAgICAgIGlmIChhdXRoSW5Ib3N0KSB7CgkgICAgICAgIHJlc3VsdC5hdXRoID0gYXV0aEluSG9zdC5zaGlmdCgpOwoJICAgICAgICByZXN1bHQuaG9zdCA9IHJlc3VsdC5ob3N0bmFtZSA9IGF1dGhJbkhvc3Quc2hpZnQoKTsKCSAgICAgIH0KCSAgICB9CgkgICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDsKCSAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTsKCSAgICAvL3RvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0CgkgICAgaWYgKCF1dGlsLmlzTnVsbChyZXN1bHQucGF0aG5hbWUpIHx8ICF1dGlsLmlzTnVsbChyZXN1bHQuc2VhcmNoKSkgewoJICAgICAgcmVzdWx0LnBhdGggPSAocmVzdWx0LnBhdGhuYW1lID8gcmVzdWx0LnBhdGhuYW1lIDogJycpICsKCSAgICAgICAgICAgICAgICAgICAgKHJlc3VsdC5zZWFyY2ggPyByZXN1bHQuc2VhcmNoIDogJycpOwoJICAgIH0KCSAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTsKCSAgICByZXR1cm4gcmVzdWx0OwoJICB9CgoJICBpZiAoIXNyY1BhdGgubGVuZ3RoKSB7CgkgICAgLy8gbm8gcGF0aCBhdCBhbGwuICBlYXN5LgoJICAgIC8vIHdlJ3ZlIGFscmVhZHkgaGFuZGxlZCB0aGUgb3RoZXIgc3R1ZmYgYWJvdmUuCgkgICAgcmVzdWx0LnBhdGhuYW1lID0gbnVsbDsKCSAgICAvL3RvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0CgkgICAgaWYgKHJlc3VsdC5zZWFyY2gpIHsKCSAgICAgIHJlc3VsdC5wYXRoID0gJy8nICsgcmVzdWx0LnNlYXJjaDsKCSAgICB9IGVsc2UgewoJICAgICAgcmVzdWx0LnBhdGggPSBudWxsOwoJICAgIH0KCSAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTsKCSAgICByZXR1cm4gcmVzdWx0OwoJICB9CgoJICAvLyBpZiBhIHVybCBFTkRzIGluIC4gb3IgLi4sIHRoZW4gaXQgbXVzdCBnZXQgYSB0cmFpbGluZyBzbGFzaC4KCSAgLy8gaG93ZXZlciwgaWYgaXQgZW5kcyBpbiBhbnl0aGluZyBlbHNlIG5vbi1zbGFzaHksCgkgIC8vIHRoZW4gaXQgbXVzdCBOT1QgZ2V0IGEgdHJhaWxpbmcgc2xhc2guCgkgIHZhciBsYXN0ID0gc3JjUGF0aC5zbGljZSgtMSlbMF07CgkgIHZhciBoYXNUcmFpbGluZ1NsYXNoID0gKAoJICAgICAgKHJlc3VsdC5ob3N0IHx8IHJlbGF0aXZlLmhvc3QgfHwgc3JjUGF0aC5sZW5ndGggPiAxKSAmJgoJICAgICAgKGxhc3QgPT09ICcuJyB8fCBsYXN0ID09PSAnLi4nKSB8fCBsYXN0ID09PSAnJyk7CgoJICAvLyBzdHJpcCBzaW5nbGUgZG90cywgcmVzb2x2ZSBkb3VibGUgZG90cyB0byBwYXJlbnQgZGlyCgkgIC8vIGlmIHRoZSBwYXRoIHRyaWVzIHRvIGdvIGFib3ZlIHRoZSByb290LCBgdXBgIGVuZHMgdXAgPiAwCgkgIHZhciB1cCA9IDA7CgkgIGZvciAodmFyIGkgPSBzcmNQYXRoLmxlbmd0aDsgaSA+PSAwOyBpLS0pIHsKCSAgICBsYXN0ID0gc3JjUGF0aFtpXTsKCSAgICBpZiAobGFzdCA9PT0gJy4nKSB7CgkgICAgICBzcmNQYXRoLnNwbGljZShpLCAxKTsKCSAgICB9IGVsc2UgaWYgKGxhc3QgPT09ICcuLicpIHsKCSAgICAgIHNyY1BhdGguc3BsaWNlKGksIDEpOwoJICAgICAgdXArKzsKCSAgICB9IGVsc2UgaWYgKHVwKSB7CgkgICAgICBzcmNQYXRoLnNwbGljZShpLCAxKTsKCSAgICAgIHVwLS07CgkgICAgfQoJICB9CgoJICAvLyBpZiB0aGUgcGF0aCBpcyBhbGxvd2VkIHRvIGdvIGFib3ZlIHRoZSByb290LCByZXN0b3JlIGxlYWRpbmcgLi5zCgkgIGlmICghbXVzdEVuZEFicyAmJiAhcmVtb3ZlQWxsRG90cykgewoJICAgIGZvciAoOyB1cC0tOyB1cCkgewoJICAgICAgc3JjUGF0aC51bnNoaWZ0KCcuLicpOwoJICAgIH0KCSAgfQoKCSAgaWYgKG11c3RFbmRBYnMgJiYgc3JjUGF0aFswXSAhPT0gJycgJiYKCSAgICAgICghc3JjUGF0aFswXSB8fCBzcmNQYXRoWzBdLmNoYXJBdCgwKSAhPT0gJy8nKSkgewoJICAgIHNyY1BhdGgudW5zaGlmdCgnJyk7CgkgIH0KCgkgIGlmIChoYXNUcmFpbGluZ1NsYXNoICYmIChzcmNQYXRoLmpvaW4oJy8nKS5zdWJzdHIoLTEpICE9PSAnLycpKSB7CgkgICAgc3JjUGF0aC5wdXNoKCcnKTsKCSAgfQoKCSAgdmFyIGlzQWJzb2x1dGUgPSBzcmNQYXRoWzBdID09PSAnJyB8fAoJICAgICAgKHNyY1BhdGhbMF0gJiYgc3JjUGF0aFswXS5jaGFyQXQoMCkgPT09ICcvJyk7CgoJICAvLyBwdXQgdGhlIGhvc3QgYmFjawoJICBpZiAocHN5Y2hvdGljKSB7CgkgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVzdWx0Lmhvc3QgPSBpc0Fic29sdXRlID8gJycgOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjUGF0aC5sZW5ndGggPyBzcmNQYXRoLnNoaWZ0KCkgOiAnJzsKCSAgICAvL29jY2F0aW9uYWx5IHRoZSBhdXRoIGNhbiBnZXQgc3R1Y2sgb25seSBpbiBob3N0CgkgICAgLy90aGlzIGVzcGVjaWFsbHkgaGFwcGVucyBpbiBjYXNlcyBsaWtlCgkgICAgLy91cmwucmVzb2x2ZU9iamVjdCgnbWFpbHRvOmxvY2FsMUBkb21haW4xJywgJ2xvY2FsMkBkb21haW4yJykKCSAgICB2YXIgYXV0aEluSG9zdCA9IHJlc3VsdC5ob3N0ICYmIHJlc3VsdC5ob3N0LmluZGV4T2YoJ0AnKSA+IDAgPwoJICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3Quc3BsaXQoJ0AnKSA6IGZhbHNlOwoJICAgIGlmIChhdXRoSW5Ib3N0KSB7CgkgICAgICByZXN1bHQuYXV0aCA9IGF1dGhJbkhvc3Quc2hpZnQoKTsKCSAgICAgIHJlc3VsdC5ob3N0ID0gcmVzdWx0Lmhvc3RuYW1lID0gYXV0aEluSG9zdC5zaGlmdCgpOwoJICAgIH0KCSAgfQoKCSAgbXVzdEVuZEFicyA9IG11c3RFbmRBYnMgfHwgKHJlc3VsdC5ob3N0ICYmIHNyY1BhdGgubGVuZ3RoKTsKCgkgIGlmIChtdXN0RW5kQWJzICYmICFpc0Fic29sdXRlKSB7CgkgICAgc3JjUGF0aC51bnNoaWZ0KCcnKTsKCSAgfQoKCSAgaWYgKCFzcmNQYXRoLmxlbmd0aCkgewoJICAgIHJlc3VsdC5wYXRobmFtZSA9IG51bGw7CgkgICAgcmVzdWx0LnBhdGggPSBudWxsOwoJICB9IGVsc2UgewoJICAgIHJlc3VsdC5wYXRobmFtZSA9IHNyY1BhdGguam9pbignLycpOwoJICB9CgoJICAvL3RvIHN1cHBvcnQgcmVxdWVzdC5odHRwCgkgIGlmICghdXRpbC5pc051bGwocmVzdWx0LnBhdGhuYW1lKSB8fCAhdXRpbC5pc051bGwocmVzdWx0LnNlYXJjaCkpIHsKCSAgICByZXN1bHQucGF0aCA9IChyZXN1bHQucGF0aG5hbWUgPyByZXN1bHQucGF0aG5hbWUgOiAnJykgKwoJICAgICAgICAgICAgICAgICAgKHJlc3VsdC5zZWFyY2ggPyByZXN1bHQuc2VhcmNoIDogJycpOwoJICB9CgkgIHJlc3VsdC5hdXRoID0gcmVsYXRpdmUuYXV0aCB8fCByZXN1bHQuYXV0aDsKCSAgcmVzdWx0LnNsYXNoZXMgPSByZXN1bHQuc2xhc2hlcyB8fCByZWxhdGl2ZS5zbGFzaGVzOwoJICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTsKCSAgcmV0dXJuIHJlc3VsdDsKCX07CgoJVXJsLnByb3RvdHlwZS5wYXJzZUhvc3QgPSBmdW5jdGlvbigpIHsKCSAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7CgkgIHZhciBwb3J0ID0gcG9ydFBhdHRlcm4uZXhlYyhob3N0KTsKCSAgaWYgKHBvcnQpIHsKCSAgICBwb3J0ID0gcG9ydFswXTsKCSAgICBpZiAocG9ydCAhPT0gJzonKSB7CgkgICAgICB0aGlzLnBvcnQgPSBwb3J0LnN1YnN0cigxKTsKCSAgICB9CgkgICAgaG9zdCA9IGhvc3Quc3Vic3RyKDAsIGhvc3QubGVuZ3RoIC0gcG9ydC5sZW5ndGgpOwoJICB9CgkgIGlmIChob3N0KSB0aGlzLmhvc3RuYW1lID0gaG9zdDsKCX07CgoKLyoqKi8gfSwKLyogNzIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihtb2R1bGUsIGdsb2JhbCkgey8qISBodHRwczovL210aHMuYmUvcHVueWNvZGUgdjEuMy4yIGJ5IEBtYXRoaWFzICovCgk7KGZ1bmN0aW9uKHJvb3QpIHsKCgkJLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlcyAqLwoJCXZhciBmcmVlRXhwb3J0cyA9IHR5cGVvZiBleHBvcnRzID09ICdvYmplY3QnICYmIGV4cG9ydHMgJiYKCQkJIWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0czsKCQl2YXIgZnJlZU1vZHVsZSA9IHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlICYmCgkJCSFtb2R1bGUubm9kZVR5cGUgJiYgbW9kdWxlOwoJCXZhciBmcmVlR2xvYmFsID0gdHlwZW9mIGdsb2JhbCA9PSAnb2JqZWN0JyAmJiBnbG9iYWw7CgkJaWYgKAoJCQlmcmVlR2xvYmFsLmdsb2JhbCA9PT0gZnJlZUdsb2JhbCB8fAoJCQlmcmVlR2xvYmFsLndpbmRvdyA9PT0gZnJlZUdsb2JhbCB8fAoJCQlmcmVlR2xvYmFsLnNlbGYgPT09IGZyZWVHbG9iYWwKCQkpIHsKCQkJcm9vdCA9IGZyZWVHbG9iYWw7CgkJfQoKCQkvKioKCQkgKiBUaGUgYHB1bnljb2RlYCBvYmplY3QuCgkJICogQG5hbWUgcHVueWNvZGUKCQkgKiBAdHlwZSBPYmplY3QKCQkgKi8KCQl2YXIgcHVueWNvZGUsCgoJCS8qKiBIaWdoZXN0IHBvc2l0aXZlIHNpZ25lZCAzMi1iaXQgZmxvYXQgdmFsdWUgKi8KCQltYXhJbnQgPSAyMTQ3NDgzNjQ3LCAvLyBha2EuIDB4N0ZGRkZGRkYgb3IgMl4zMS0xCgoJCS8qKiBCb290c3RyaW5nIHBhcmFtZXRlcnMgKi8KCQliYXNlID0gMzYsCgkJdE1pbiA9IDEsCgkJdE1heCA9IDI2LAoJCXNrZXcgPSAzOCwKCQlkYW1wID0gNzAwLAoJCWluaXRpYWxCaWFzID0gNzIsCgkJaW5pdGlhbE4gPSAxMjgsIC8vIDB4ODAKCQlkZWxpbWl0ZXIgPSAnLScsIC8vICdceDJEJwoKCQkvKiogUmVndWxhciBleHByZXNzaW9ucyAqLwoJCXJlZ2V4UHVueWNvZGUgPSAvXnhuLS0vLAoJCXJlZ2V4Tm9uQVNDSUkgPSAvW15ceDIwLVx4N0VdLywgLy8gdW5wcmludGFibGUgQVNDSUkgY2hhcnMgKyBub24tQVNDSUkgY2hhcnMKCQlyZWdleFNlcGFyYXRvcnMgPSAvW1x4MkVcdTMwMDJcdUZGMEVcdUZGNjFdL2csIC8vIFJGQyAzNDkwIHNlcGFyYXRvcnMKCgkJLyoqIEVycm9yIG1lc3NhZ2VzICovCgkJZXJyb3JzID0gewoJCQknb3ZlcmZsb3cnOiAnT3ZlcmZsb3c6IGlucHV0IG5lZWRzIHdpZGVyIGludGVnZXJzIHRvIHByb2Nlc3MnLAoJCQknbm90LWJhc2ljJzogJ0lsbGVnYWwgaW5wdXQgPj0gMHg4MCAobm90IGEgYmFzaWMgY29kZSBwb2ludCknLAoJCQknaW52YWxpZC1pbnB1dCc6ICdJbnZhbGlkIGlucHV0JwoJCX0sCgoJCS8qKiBDb252ZW5pZW5jZSBzaG9ydGN1dHMgKi8KCQliYXNlTWludXNUTWluID0gYmFzZSAtIHRNaW4sCgkJZmxvb3IgPSBNYXRoLmZsb29yLAoJCXN0cmluZ0Zyb21DaGFyQ29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGUsCgoJCS8qKiBUZW1wb3JhcnkgdmFyaWFibGUgKi8KCQlrZXk7CgoJCS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKCQkvKioKCQkgKiBBIGdlbmVyaWMgZXJyb3IgdXRpbGl0eSBmdW5jdGlvbi4KCQkgKiBAcHJpdmF0ZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIFRoZSBlcnJvciB0eXBlLgoJCSAqIEByZXR1cm5zIHtFcnJvcn0gVGhyb3dzIGEgYFJhbmdlRXJyb3JgIHdpdGggdGhlIGFwcGxpY2FibGUgZXJyb3IgbWVzc2FnZS4KCQkgKi8KCQlmdW5jdGlvbiBlcnJvcih0eXBlKSB7CgkJCXRocm93IFJhbmdlRXJyb3IoZXJyb3JzW3R5cGVdKTsKCQl9CgoJCS8qKgoJCSAqIEEgZ2VuZXJpYyBgQXJyYXkjbWFwYCB1dGlsaXR5IGZ1bmN0aW9uLgoJCSAqIEBwcml2YXRlCgkJICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci4KCQkgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCBmb3IgZXZlcnkgYXJyYXkKCQkgKiBpdGVtLgoJCSAqIEByZXR1cm5zIHtBcnJheX0gQSBuZXcgYXJyYXkgb2YgdmFsdWVzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFjayBmdW5jdGlvbi4KCQkgKi8KCQlmdW5jdGlvbiBtYXAoYXJyYXksIGZuKSB7CgkJCXZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7CgkJCXZhciByZXN1bHQgPSBbXTsKCQkJd2hpbGUgKGxlbmd0aC0tKSB7CgkJCQlyZXN1bHRbbGVuZ3RoXSA9IGZuKGFycmF5W2xlbmd0aF0pOwoJCQl9CgkJCXJldHVybiByZXN1bHQ7CgkJfQoKCQkvKioKCQkgKiBBIHNpbXBsZSBgQXJyYXkjbWFwYC1saWtlIHdyYXBwZXIgdG8gd29yayB3aXRoIGRvbWFpbiBuYW1lIHN0cmluZ3Mgb3IgZW1haWwKCQkgKiBhZGRyZXNzZXMuCgkJICogQHByaXZhdGUKCQkgKiBAcGFyYW0ge1N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzLgoJCSAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIGZvciBldmVyeQoJCSAqIGNoYXJhY3Rlci4KCQkgKiBAcmV0dXJucyB7QXJyYXl9IEEgbmV3IHN0cmluZyBvZiBjaGFyYWN0ZXJzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFjawoJCSAqIGZ1bmN0aW9uLgoJCSAqLwoJCWZ1bmN0aW9uIG1hcERvbWFpbihzdHJpbmcsIGZuKSB7CgkJCXZhciBwYXJ0cyA9IHN0cmluZy5zcGxpdCgnQCcpOwoJCQl2YXIgcmVzdWx0ID0gJyc7CgkJCWlmIChwYXJ0cy5sZW5ndGggPiAxKSB7CgkJCQkvLyBJbiBlbWFpbCBhZGRyZXNzZXMsIG9ubHkgdGhlIGRvbWFpbiBuYW1lIHNob3VsZCBiZSBwdW55Y29kZWQuIExlYXZlCgkJCQkvLyB0aGUgbG9jYWwgcGFydCAoaS5lLiBldmVyeXRoaW5nIHVwIHRvIGBAYCkgaW50YWN0LgoJCQkJcmVzdWx0ID0gcGFydHNbMF0gKyAnQCc7CgkJCQlzdHJpbmcgPSBwYXJ0c1sxXTsKCQkJfQoJCQkvLyBBdm9pZCBgc3BsaXQocmVnZXgpYCBmb3IgSUU4IGNvbXBhdGliaWxpdHkuIFNlZSAjMTcuCgkJCXN0cmluZyA9IHN0cmluZy5yZXBsYWNlKHJlZ2V4U2VwYXJhdG9ycywgJ1x4MkUnKTsKCQkJdmFyIGxhYmVscyA9IHN0cmluZy5zcGxpdCgnLicpOwoJCQl2YXIgZW5jb2RlZCA9IG1hcChsYWJlbHMsIGZuKS5qb2luKCcuJyk7CgkJCXJldHVybiByZXN1bHQgKyBlbmNvZGVkOwoJCX0KCgkJLyoqCgkJICogQ3JlYXRlcyBhbiBhcnJheSBjb250YWluaW5nIHRoZSBudW1lcmljIGNvZGUgcG9pbnRzIG9mIGVhY2ggVW5pY29kZQoJCSAqIGNoYXJhY3RlciBpbiB0aGUgc3RyaW5nLiBXaGlsZSBKYXZhU2NyaXB0IHVzZXMgVUNTLTIgaW50ZXJuYWxseSwKCQkgKiB0aGlzIGZ1bmN0aW9uIHdpbGwgY29udmVydCBhIHBhaXIgb2Ygc3Vycm9nYXRlIGhhbHZlcyAoZWFjaCBvZiB3aGljaAoJCSAqIFVDUy0yIGV4cG9zZXMgYXMgc2VwYXJhdGUgY2hhcmFjdGVycykgaW50byBhIHNpbmdsZSBjb2RlIHBvaW50LAoJCSAqIG1hdGNoaW5nIFVURi0xNi4KCQkgKiBAc2VlIGBwdW55Y29kZS51Y3MyLmVuY29kZWAKCQkgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz4KCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUudWNzMgoJCSAqIEBuYW1lIGRlY29kZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSBzdHJpbmcgVGhlIFVuaWNvZGUgaW5wdXQgc3RyaW5nIChVQ1MtMikuCgkJICogQHJldHVybnMge0FycmF5fSBUaGUgbmV3IGFycmF5IG9mIGNvZGUgcG9pbnRzLgoJCSAqLwoJCWZ1bmN0aW9uIHVjczJkZWNvZGUoc3RyaW5nKSB7CgkJCXZhciBvdXRwdXQgPSBbXSwKCQkJICAgIGNvdW50ZXIgPSAwLAoJCQkgICAgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aCwKCQkJICAgIHZhbHVlLAoJCQkgICAgZXh0cmE7CgkJCXdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7CgkJCQl2YWx1ZSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7CgkJCQlpZiAodmFsdWUgPj0gMHhEODAwICYmIHZhbHVlIDw9IDB4REJGRiAmJiBjb3VudGVyIDwgbGVuZ3RoKSB7CgkJCQkJLy8gaGlnaCBzdXJyb2dhdGUsIGFuZCB0aGVyZSBpcyBhIG5leHQgY2hhcmFjdGVyCgkJCQkJZXh0cmEgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspOwoJCQkJCWlmICgoZXh0cmEgJiAweEZDMDApID09IDB4REMwMCkgeyAvLyBsb3cgc3Vycm9nYXRlCgkJCQkJCW91dHB1dC5wdXNoKCgodmFsdWUgJiAweDNGRikgPDwgMTApICsgKGV4dHJhICYgMHgzRkYpICsgMHgxMDAwMCk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJLy8gdW5tYXRjaGVkIHN1cnJvZ2F0ZTsgb25seSBhcHBlbmQgdGhpcyBjb2RlIHVuaXQsIGluIGNhc2UgdGhlIG5leHQKCQkJCQkJLy8gY29kZSB1bml0IGlzIHRoZSBoaWdoIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyCgkJCQkJCW91dHB1dC5wdXNoKHZhbHVlKTsKCQkJCQkJY291bnRlci0tOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJb3V0cHV0LnB1c2godmFsdWUpOwoJCQkJfQoJCQl9CgkJCXJldHVybiBvdXRwdXQ7CgkJfQoKCQkvKioKCQkgKiBDcmVhdGVzIGEgc3RyaW5nIGJhc2VkIG9uIGFuIGFycmF5IG9mIG51bWVyaWMgY29kZSBwb2ludHMuCgkJICogQHNlZSBgcHVueWNvZGUudWNzMi5kZWNvZGVgCgkJICogQG1lbWJlck9mIHB1bnljb2RlLnVjczIKCQkgKiBAbmFtZSBlbmNvZGUKCQkgKiBAcGFyYW0ge0FycmF5fSBjb2RlUG9pbnRzIFRoZSBhcnJheSBvZiBudW1lcmljIGNvZGUgcG9pbnRzLgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBuZXcgVW5pY29kZSBzdHJpbmcgKFVDUy0yKS4KCQkgKi8KCQlmdW5jdGlvbiB1Y3MyZW5jb2RlKGFycmF5KSB7CgkJCXJldHVybiBtYXAoYXJyYXksIGZ1bmN0aW9uKHZhbHVlKSB7CgkJCQl2YXIgb3V0cHV0ID0gJyc7CgkJCQlpZiAodmFsdWUgPiAweEZGRkYpIHsKCQkJCQl2YWx1ZSAtPSAweDEwMDAwOwoJCQkJCW91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApOwoJCQkJCXZhbHVlID0gMHhEQzAwIHwgdmFsdWUgJiAweDNGRjsKCQkJCX0KCQkJCW91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUpOwoJCQkJcmV0dXJuIG91dHB1dDsKCQkJfSkuam9pbignJyk7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIGJhc2ljIGNvZGUgcG9pbnQgaW50byBhIGRpZ2l0L2ludGVnZXIuCgkJICogQHNlZSBgZGlnaXRUb0Jhc2ljKClgCgkJICogQHByaXZhdGUKCQkgKiBAcGFyYW0ge051bWJlcn0gY29kZVBvaW50IFRoZSBiYXNpYyBudW1lcmljIGNvZGUgcG9pbnQgdmFsdWUuCgkJICogQHJldHVybnMge051bWJlcn0gVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50IChmb3IgdXNlIGluCgkJICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpbiB0aGUgcmFuZ2UgYDBgIHRvIGBiYXNlIC0gMWAsIG9yIGBiYXNlYCBpZgoJCSAqIHRoZSBjb2RlIHBvaW50IGRvZXMgbm90IHJlcHJlc2VudCBhIHZhbHVlLgoJCSAqLwoJCWZ1bmN0aW9uIGJhc2ljVG9EaWdpdChjb2RlUG9pbnQpIHsKCQkJaWYgKGNvZGVQb2ludCAtIDQ4IDwgMTApIHsKCQkJCXJldHVybiBjb2RlUG9pbnQgLSAyMjsKCQkJfQoJCQlpZiAoY29kZVBvaW50IC0gNjUgPCAyNikgewoJCQkJcmV0dXJuIGNvZGVQb2ludCAtIDY1OwoJCQl9CgkJCWlmIChjb2RlUG9pbnQgLSA5NyA8IDI2KSB7CgkJCQlyZXR1cm4gY29kZVBvaW50IC0gOTc7CgkJCX0KCQkJcmV0dXJuIGJhc2U7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIGRpZ2l0L2ludGVnZXIgaW50byBhIGJhc2ljIGNvZGUgcG9pbnQuCgkJICogQHNlZSBgYmFzaWNUb0RpZ2l0KClgCgkJICogQHByaXZhdGUKCQkgKiBAcGFyYW0ge051bWJlcn0gZGlnaXQgVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50LgoJCSAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBiYXNpYyBjb2RlIHBvaW50IHdob3NlIHZhbHVlICh3aGVuIHVzZWQgZm9yCgkJICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpcyBgZGlnaXRgLCB3aGljaCBuZWVkcyB0byBiZSBpbiB0aGUgcmFuZ2UKCQkgKiBgMGAgdG8gYGJhc2UgLSAxYC4gSWYgYGZsYWdgIGlzIG5vbi16ZXJvLCB0aGUgdXBwZXJjYXNlIGZvcm0gaXMKCQkgKiB1c2VkOyBlbHNlLCB0aGUgbG93ZXJjYXNlIGZvcm0gaXMgdXNlZC4gVGhlIGJlaGF2aW9yIGlzIHVuZGVmaW5lZAoJCSAqIGlmIGBmbGFnYCBpcyBub24temVybyBhbmQgYGRpZ2l0YCBoYXMgbm8gdXBwZXJjYXNlIGZvcm0uCgkJICovCgkJZnVuY3Rpb24gZGlnaXRUb0Jhc2ljKGRpZ2l0LCBmbGFnKSB7CgkJCS8vICAwLi4yNSBtYXAgdG8gQVNDSUkgYS4ueiBvciBBLi5aCgkJCS8vIDI2Li4zNSBtYXAgdG8gQVNDSUkgMC4uOQoJCQlyZXR1cm4gZGlnaXQgKyAyMiArIDc1ICogKGRpZ2l0IDwgMjYpIC0gKChmbGFnICE9IDApIDw8IDUpOwoJCX0KCgkJLyoqCgkJICogQmlhcyBhZGFwdGF0aW9uIGZ1bmN0aW9uIGFzIHBlciBzZWN0aW9uIDMuNCBvZiBSRkMgMzQ5Mi4KCQkgKiBodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzNDkyI3NlY3Rpb24tMy40CgkJICogQHByaXZhdGUKCQkgKi8KCQlmdW5jdGlvbiBhZGFwdChkZWx0YSwgbnVtUG9pbnRzLCBmaXJzdFRpbWUpIHsKCQkJdmFyIGsgPSAwOwoJCQlkZWx0YSA9IGZpcnN0VGltZSA/IGZsb29yKGRlbHRhIC8gZGFtcCkgOiBkZWx0YSA+PiAxOwoJCQlkZWx0YSArPSBmbG9vcihkZWx0YSAvIG51bVBvaW50cyk7CgkJCWZvciAoLyogbm8gaW5pdGlhbGl6YXRpb24gKi87IGRlbHRhID4gYmFzZU1pbnVzVE1pbiAqIHRNYXggPj4gMTsgayArPSBiYXNlKSB7CgkJCQlkZWx0YSA9IGZsb29yKGRlbHRhIC8gYmFzZU1pbnVzVE1pbik7CgkJCX0KCQkJcmV0dXJuIGZsb29yKGsgKyAoYmFzZU1pbnVzVE1pbiArIDEpICogZGVsdGEgLyAoZGVsdGEgKyBza2V3KSk7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMgdG8gYSBzdHJpbmcgb2YgVW5pY29kZQoJCSAqIHN5bWJvbHMuCgkJICogQG1lbWJlck9mIHB1bnljb2RlCgkJICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSByZXN1bHRpbmcgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scy4KCQkgKi8KCQlmdW5jdGlvbiBkZWNvZGUoaW5wdXQpIHsKCQkJLy8gRG9uJ3QgdXNlIFVDUy0yCgkJCXZhciBvdXRwdXQgPSBbXSwKCQkJICAgIGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoLAoJCQkgICAgb3V0LAoJCQkgICAgaSA9IDAsCgkJCSAgICBuID0gaW5pdGlhbE4sCgkJCSAgICBiaWFzID0gaW5pdGlhbEJpYXMsCgkJCSAgICBiYXNpYywKCQkJICAgIGosCgkJCSAgICBpbmRleCwKCQkJICAgIG9sZGksCgkJCSAgICB3LAoJCQkgICAgaywKCQkJICAgIGRpZ2l0LAoJCQkgICAgdCwKCQkJICAgIC8qKiBDYWNoZWQgY2FsY3VsYXRpb24gcmVzdWx0cyAqLwoJCQkgICAgYmFzZU1pbnVzVDsKCgkJCS8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHM6IGxldCBgYmFzaWNgIGJlIHRoZSBudW1iZXIgb2YgaW5wdXQgY29kZQoJCQkvLyBwb2ludHMgYmVmb3JlIHRoZSBsYXN0IGRlbGltaXRlciwgb3IgYDBgIGlmIHRoZXJlIGlzIG5vbmUsIHRoZW4gY29weQoJCQkvLyB0aGUgZmlyc3QgYmFzaWMgY29kZSBwb2ludHMgdG8gdGhlIG91dHB1dC4KCgkJCWJhc2ljID0gaW5wdXQubGFzdEluZGV4T2YoZGVsaW1pdGVyKTsKCQkJaWYgKGJhc2ljIDwgMCkgewoJCQkJYmFzaWMgPSAwOwoJCQl9CgoJCQlmb3IgKGogPSAwOyBqIDwgYmFzaWM7ICsraikgewoJCQkJLy8gaWYgaXQncyBub3QgYSBiYXNpYyBjb2RlIHBvaW50CgkJCQlpZiAoaW5wdXQuY2hhckNvZGVBdChqKSA+PSAweDgwKSB7CgkJCQkJZXJyb3IoJ25vdC1iYXNpYycpOwoJCQkJfQoJCQkJb3V0cHV0LnB1c2goaW5wdXQuY2hhckNvZGVBdChqKSk7CgkJCX0KCgkJCS8vIE1haW4gZGVjb2RpbmcgbG9vcDogc3RhcnQganVzdCBhZnRlciB0aGUgbGFzdCBkZWxpbWl0ZXIgaWYgYW55IGJhc2ljIGNvZGUKCQkJLy8gcG9pbnRzIHdlcmUgY29waWVkOyBzdGFydCBhdCB0aGUgYmVnaW5uaW5nIG90aGVyd2lzZS4KCgkJCWZvciAoaW5kZXggPSBiYXNpYyA+IDAgPyBiYXNpYyArIDEgOiAwOyBpbmRleCA8IGlucHV0TGVuZ3RoOyAvKiBubyBmaW5hbCBleHByZXNzaW9uICovKSB7CgoJCQkJLy8gYGluZGV4YCBpcyB0aGUgaW5kZXggb2YgdGhlIG5leHQgY2hhcmFjdGVyIHRvIGJlIGNvbnN1bWVkLgoJCQkJLy8gRGVjb2RlIGEgZ2VuZXJhbGl6ZWQgdmFyaWFibGUtbGVuZ3RoIGludGVnZXIgaW50byBgZGVsdGFgLAoJCQkJLy8gd2hpY2ggZ2V0cyBhZGRlZCB0byBgaWAuIFRoZSBvdmVyZmxvdyBjaGVja2luZyBpcyBlYXNpZXIKCQkJCS8vIGlmIHdlIGluY3JlYXNlIGBpYCBhcyB3ZSBnbywgdGhlbiBzdWJ0cmFjdCBvZmYgaXRzIHN0YXJ0aW5nCgkJCQkvLyB2YWx1ZSBhdCB0aGUgZW5kIHRvIG9idGFpbiBgZGVsdGFgLgoJCQkJZm9yIChvbGRpID0gaSwgdyA9IDEsIGsgPSBiYXNlOyAvKiBubyBjb25kaXRpb24gKi87IGsgKz0gYmFzZSkgewoKCQkJCQlpZiAoaW5kZXggPj0gaW5wdXRMZW5ndGgpIHsKCQkJCQkJZXJyb3IoJ2ludmFsaWQtaW5wdXQnKTsKCQkJCQl9CgoJCQkJCWRpZ2l0ID0gYmFzaWNUb0RpZ2l0KGlucHV0LmNoYXJDb2RlQXQoaW5kZXgrKykpOwoKCQkJCQlpZiAoZGlnaXQgPj0gYmFzZSB8fCBkaWdpdCA+IGZsb29yKChtYXhJbnQgLSBpKSAvIHcpKSB7CgkJCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQkJCX0KCgkJCQkJaSArPSBkaWdpdCAqIHc7CgkJCQkJdCA9IGsgPD0gYmlhcyA/IHRNaW4gOiAoayA+PSBiaWFzICsgdE1heCA/IHRNYXggOiBrIC0gYmlhcyk7CgoJCQkJCWlmIChkaWdpdCA8IHQpIHsKCQkJCQkJYnJlYWs7CgkJCQkJfQoKCQkJCQliYXNlTWludXNUID0gYmFzZSAtIHQ7CgkJCQkJaWYgKHcgPiBmbG9vcihtYXhJbnQgLyBiYXNlTWludXNUKSkgewoJCQkJCQllcnJvcignb3ZlcmZsb3cnKTsKCQkJCQl9CgoJCQkJCXcgKj0gYmFzZU1pbnVzVDsKCgkJCQl9CgoJCQkJb3V0ID0gb3V0cHV0Lmxlbmd0aCArIDE7CgkJCQliaWFzID0gYWRhcHQoaSAtIG9sZGksIG91dCwgb2xkaSA9PSAwKTsKCgkJCQkvLyBgaWAgd2FzIHN1cHBvc2VkIHRvIHdyYXAgYXJvdW5kIGZyb20gYG91dGAgdG8gYDBgLAoJCQkJLy8gaW5jcmVtZW50aW5nIGBuYCBlYWNoIHRpbWUsIHNvIHdlJ2xsIGZpeCB0aGF0IG5vdzoKCQkJCWlmIChmbG9vcihpIC8gb3V0KSA+IG1heEludCAtIG4pIHsKCQkJCQllcnJvcignb3ZlcmZsb3cnKTsKCQkJCX0KCgkJCQluICs9IGZsb29yKGkgLyBvdXQpOwoJCQkJaSAlPSBvdXQ7CgoJCQkJLy8gSW5zZXJ0IGBuYCBhdCBwb3NpdGlvbiBgaWAgb2YgdGhlIG91dHB1dAoJCQkJb3V0cHV0LnNwbGljZShpKyssIDAsIG4pOwoKCQkJfQoKCQkJcmV0dXJuIHVjczJlbmNvZGUob3V0cHV0KTsKCQl9CgoJCS8qKgoJCSAqIENvbnZlcnRzIGEgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scyAoZS5nLiBhIGRvbWFpbiBuYW1lIGxhYmVsKSB0byBhCgkJICogUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy4KCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUKCQkgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMuCgkJICogQHJldHVybnMge1N0cmluZ30gVGhlIHJlc3VsdGluZyBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLgoJCSAqLwoJCWZ1bmN0aW9uIGVuY29kZShpbnB1dCkgewoJCQl2YXIgbiwKCQkJICAgIGRlbHRhLAoJCQkgICAgaGFuZGxlZENQQ291bnQsCgkJCSAgICBiYXNpY0xlbmd0aCwKCQkJICAgIGJpYXMsCgkJCSAgICBqLAoJCQkgICAgbSwKCQkJICAgIHEsCgkJCSAgICBrLAoJCQkgICAgdCwKCQkJICAgIGN1cnJlbnRWYWx1ZSwKCQkJICAgIG91dHB1dCA9IFtdLAoJCQkgICAgLyoqIGBpbnB1dExlbmd0aGAgd2lsbCBob2xkIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgaW4gYGlucHV0YC4gKi8KCQkJICAgIGlucHV0TGVuZ3RoLAoJCQkgICAgLyoqIENhY2hlZCBjYWxjdWxhdGlvbiByZXN1bHRzICovCgkJCSAgICBoYW5kbGVkQ1BDb3VudFBsdXNPbmUsCgkJCSAgICBiYXNlTWludXNULAoJCQkgICAgcU1pbnVzVDsKCgkJCS8vIENvbnZlcnQgdGhlIGlucHV0IGluIFVDUy0yIHRvIFVuaWNvZGUKCQkJaW5wdXQgPSB1Y3MyZGVjb2RlKGlucHV0KTsKCgkJCS8vIENhY2hlIHRoZSBsZW5ndGgKCQkJaW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGg7CgoJCQkvLyBJbml0aWFsaXplIHRoZSBzdGF0ZQoJCQluID0gaW5pdGlhbE47CgkJCWRlbHRhID0gMDsKCQkJYmlhcyA9IGluaXRpYWxCaWFzOwoKCQkJLy8gSGFuZGxlIHRoZSBiYXNpYyBjb2RlIHBvaW50cwoJCQlmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikgewoJCQkJY3VycmVudFZhbHVlID0gaW5wdXRbal07CgkJCQlpZiAoY3VycmVudFZhbHVlIDwgMHg4MCkgewoJCQkJCW91dHB1dC5wdXNoKHN0cmluZ0Zyb21DaGFyQ29kZShjdXJyZW50VmFsdWUpKTsKCQkJCX0KCQkJfQoKCQkJaGFuZGxlZENQQ291bnQgPSBiYXNpY0xlbmd0aCA9IG91dHB1dC5sZW5ndGg7CgoJCQkvLyBgaGFuZGxlZENQQ291bnRgIGlzIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgdGhhdCBoYXZlIGJlZW4gaGFuZGxlZDsKCQkJLy8gYGJhc2ljTGVuZ3RoYCBpcyB0aGUgbnVtYmVyIG9mIGJhc2ljIGNvZGUgcG9pbnRzLgoKCQkJLy8gRmluaXNoIHRoZSBiYXNpYyBzdHJpbmcgLSBpZiBpdCBpcyBub3QgZW1wdHkgLSB3aXRoIGEgZGVsaW1pdGVyCgkJCWlmIChiYXNpY0xlbmd0aCkgewoJCQkJb3V0cHV0LnB1c2goZGVsaW1pdGVyKTsKCQkJfQoKCQkJLy8gTWFpbiBlbmNvZGluZyBsb29wOgoJCQl3aGlsZSAoaGFuZGxlZENQQ291bnQgPCBpbnB1dExlbmd0aCkgewoKCQkJCS8vIEFsbCBub24tYmFzaWMgY29kZSBwb2ludHMgPCBuIGhhdmUgYmVlbiBoYW5kbGVkIGFscmVhZHkuIEZpbmQgdGhlIG5leHQKCQkJCS8vIGxhcmdlciBvbmU6CgkJCQlmb3IgKG0gPSBtYXhJbnQsIGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikgewoJCQkJCWN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdOwoJCQkJCWlmIChjdXJyZW50VmFsdWUgPj0gbiAmJiBjdXJyZW50VmFsdWUgPCBtKSB7CgkJCQkJCW0gPSBjdXJyZW50VmFsdWU7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIEluY3JlYXNlIGBkZWx0YWAgZW5vdWdoIHRvIGFkdmFuY2UgdGhlIGRlY29kZXIncyA8bixpPiBzdGF0ZSB0byA8bSwwPiwKCQkJCS8vIGJ1dCBndWFyZCBhZ2FpbnN0IG92ZXJmbG93CgkJCQloYW5kbGVkQ1BDb3VudFBsdXNPbmUgPSBoYW5kbGVkQ1BDb3VudCArIDE7CgkJCQlpZiAobSAtIG4gPiBmbG9vcigobWF4SW50IC0gZGVsdGEpIC8gaGFuZGxlZENQQ291bnRQbHVzT25lKSkgewoJCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQkJfQoKCQkJCWRlbHRhICs9IChtIC0gbikgKiBoYW5kbGVkQ1BDb3VudFBsdXNPbmU7CgkJCQluID0gbTsKCgkJCQlmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikgewoJCQkJCWN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdOwoKCQkJCQlpZiAoY3VycmVudFZhbHVlIDwgbiAmJiArK2RlbHRhID4gbWF4SW50KSB7CgkJCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQkJCX0KCgkJCQkJaWYgKGN1cnJlbnRWYWx1ZSA9PSBuKSB7CgkJCQkJCS8vIFJlcHJlc2VudCBkZWx0YSBhcyBhIGdlbmVyYWxpemVkIHZhcmlhYmxlLWxlbmd0aCBpbnRlZ2VyCgkJCQkJCWZvciAocSA9IGRlbHRhLCBrID0gYmFzZTsgLyogbm8gY29uZGl0aW9uICovOyBrICs9IGJhc2UpIHsKCQkJCQkJCXQgPSBrIDw9IGJpYXMgPyB0TWluIDogKGsgPj0gYmlhcyArIHRNYXggPyB0TWF4IDogayAtIGJpYXMpOwoJCQkJCQkJaWYgKHEgPCB0KSB7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQl9CgkJCQkJCQlxTWludXNUID0gcSAtIHQ7CgkJCQkJCQliYXNlTWludXNUID0gYmFzZSAtIHQ7CgkJCQkJCQlvdXRwdXQucHVzaCgKCQkJCQkJCQlzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHQgKyBxTWludXNUICUgYmFzZU1pbnVzVCwgMCkpCgkJCQkJCQkpOwoJCQkJCQkJcSA9IGZsb29yKHFNaW51c1QgLyBiYXNlTWludXNUKTsKCQkJCQkJfQoKCQkJCQkJb3V0cHV0LnB1c2goc3RyaW5nRnJvbUNoYXJDb2RlKGRpZ2l0VG9CYXNpYyhxLCAwKSkpOwoJCQkJCQliaWFzID0gYWRhcHQoZGVsdGEsIGhhbmRsZWRDUENvdW50UGx1c09uZSwgaGFuZGxlZENQQ291bnQgPT0gYmFzaWNMZW5ndGgpOwoJCQkJCQlkZWx0YSA9IDA7CgkJCQkJCSsraGFuZGxlZENQQ291bnQ7CgkJCQkJfQoJCQkJfQoKCQkJCSsrZGVsdGE7CgkJCQkrK247CgoJCQl9CgkJCXJldHVybiBvdXRwdXQuam9pbignJyk7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSBvciBhbiBlbWFpbCBhZGRyZXNzCgkJICogdG8gVW5pY29kZS4gT25seSB0aGUgUHVueWNvZGVkIHBhcnRzIG9mIHRoZSBpbnB1dCB3aWxsIGJlIGNvbnZlcnRlZCwgaS5lLgoJCSAqIGl0IGRvZXNuJ3QgbWF0dGVyIGlmIHlvdSBjYWxsIGl0IG9uIGEgc3RyaW5nIHRoYXQgaGFzIGFscmVhZHkgYmVlbgoJCSAqIGNvbnZlcnRlZCB0byBVbmljb2RlLgoJCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgUHVueWNvZGVkIGRvbWFpbiBuYW1lIG9yIGVtYWlsIGFkZHJlc3MgdG8KCQkgKiBjb252ZXJ0IHRvIFVuaWNvZGUuCgkJICogQHJldHVybnMge1N0cmluZ30gVGhlIFVuaWNvZGUgcmVwcmVzZW50YXRpb24gb2YgdGhlIGdpdmVuIFB1bnljb2RlCgkJICogc3RyaW5nLgoJCSAqLwoJCWZ1bmN0aW9uIHRvVW5pY29kZShpbnB1dCkgewoJCQlyZXR1cm4gbWFwRG9tYWluKGlucHV0LCBmdW5jdGlvbihzdHJpbmcpIHsKCQkJCXJldHVybiByZWdleFB1bnljb2RlLnRlc3Qoc3RyaW5nKQoJCQkJCT8gZGVjb2RlKHN0cmluZy5zbGljZSg0KS50b0xvd2VyQ2FzZSgpKQoJCQkJCTogc3RyaW5nOwoJCQl9KTsKCQl9CgoJCS8qKgoJCSAqIENvbnZlcnRzIGEgVW5pY29kZSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgZG9tYWluIG5hbWUgb3IgYW4gZW1haWwgYWRkcmVzcyB0bwoJCSAqIFB1bnljb2RlLiBPbmx5IHRoZSBub24tQVNDSUkgcGFydHMgb2YgdGhlIGRvbWFpbiBuYW1lIHdpbGwgYmUgY29udmVydGVkLAoJCSAqIGkuZS4gaXQgZG9lc24ndCBtYXR0ZXIgaWYgeW91IGNhbGwgaXQgd2l0aCBhIGRvbWFpbiB0aGF0J3MgYWxyZWFkeSBpbgoJCSAqIEFTQ0lJLgoJCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcyB0byBjb252ZXJ0LCBhcyBhCgkJICogVW5pY29kZSBzdHJpbmcuCgkJICogQHJldHVybnMge1N0cmluZ30gVGhlIFB1bnljb2RlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBkb21haW4gbmFtZSBvcgoJCSAqIGVtYWlsIGFkZHJlc3MuCgkJICovCgkJZnVuY3Rpb24gdG9BU0NJSShpbnB1dCkgewoJCQlyZXR1cm4gbWFwRG9tYWluKGlucHV0LCBmdW5jdGlvbihzdHJpbmcpIHsKCQkJCXJldHVybiByZWdleE5vbkFTQ0lJLnRlc3Qoc3RyaW5nKQoJCQkJCT8gJ3huLS0nICsgZW5jb2RlKHN0cmluZykKCQkJCQk6IHN0cmluZzsKCQkJfSk7CgkJfQoKCQkvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCgkJLyoqIERlZmluZSB0aGUgcHVibGljIEFQSSAqLwoJCXB1bnljb2RlID0gewoJCQkvKioKCQkJICogQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBjdXJyZW50IFB1bnljb2RlLmpzIHZlcnNpb24gbnVtYmVyLgoJCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUKCQkJICogQHR5cGUgU3RyaW5nCgkJCSAqLwoJCQkndmVyc2lvbic6ICcxLjMuMicsCgkJCS8qKgoJCQkgKiBBbiBvYmplY3Qgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGZyb20gSmF2YVNjcmlwdCdzIGludGVybmFsIGNoYXJhY3RlcgoJCQkgKiByZXByZXNlbnRhdGlvbiAoVUNTLTIpIHRvIFVuaWNvZGUgY29kZSBwb2ludHMsIGFuZCBiYWNrLgoJCQkgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz4KCQkJICogQG1lbWJlck9mIHB1bnljb2RlCgkJCSAqIEB0eXBlIE9iamVjdAoJCQkgKi8KCQkJJ3VjczInOiB7CgkJCQknZGVjb2RlJzogdWNzMmRlY29kZSwKCQkJCSdlbmNvZGUnOiB1Y3MyZW5jb2RlCgkJCX0sCgkJCSdkZWNvZGUnOiBkZWNvZGUsCgkJCSdlbmNvZGUnOiBlbmNvZGUsCgkJCSd0b0FTQ0lJJzogdG9BU0NJSSwKCQkJJ3RvVW5pY29kZSc6IHRvVW5pY29kZQoJCX07CgoJCS8qKiBFeHBvc2UgYHB1bnljb2RlYCAqLwoJCS8vIFNvbWUgQU1EIGJ1aWxkIG9wdGltaXplcnMsIGxpa2Ugci5qcywgY2hlY2sgZm9yIHNwZWNpZmljIGNvbmRpdGlvbiBwYXR0ZXJucwoJCS8vIGxpa2UgdGhlIGZvbGxvd2luZzoKCQlpZiAoCgkJCXRydWUKCQkpIHsKCQkJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCkgewoJCQkJcmV0dXJuIHB1bnljb2RlOwoJCQl9LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXywgZXhwb3J0cywgbW9kdWxlKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpOwoJCX0gZWxzZSBpZiAoZnJlZUV4cG9ydHMgJiYgZnJlZU1vZHVsZSkgewoJCQlpZiAobW9kdWxlLmV4cG9ydHMgPT0gZnJlZUV4cG9ydHMpIHsgLy8gaW4gTm9kZS5qcyBvciBSaW5nb0pTIHYwLjguMCsKCQkJCWZyZWVNb2R1bGUuZXhwb3J0cyA9IHB1bnljb2RlOwoJCQl9IGVsc2UgeyAvLyBpbiBOYXJ3aGFsIG9yIFJpbmdvSlMgdjAuNy4wLQoJCQkJZm9yIChrZXkgaW4gcHVueWNvZGUpIHsKCQkJCQlwdW55Y29kZS5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIChmcmVlRXhwb3J0c1trZXldID0gcHVueWNvZGVba2V5XSk7CgkJCQl9CgkJCX0KCQl9IGVsc2UgeyAvLyBpbiBSaGlubyBvciBhIHdlYiBicm93c2VyCgkJCXJvb3QucHVueWNvZGUgPSBwdW55Y29kZTsKCQl9CgoJfSh0aGlzKSk7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oNzMpKG1vZHVsZSksIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKQoKLyoqKi8gfSwKLyogNzMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtb2R1bGUpIHsNCgkJaWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHsNCgkJCW1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9Ow0KCQkJbW9kdWxlLnBhdGhzID0gW107DQoJCQkvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHQNCgkJCW1vZHVsZS5jaGlsZHJlbiA9IFtdOw0KCQkJbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7DQoJCX0NCgkJcmV0dXJuIG1vZHVsZTsNCgl9DQoKCi8qKiovIH0sCi8qIDc0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JzsKCgltb2R1bGUuZXhwb3J0cyA9IHsKCSAgaXNTdHJpbmc6IGZ1bmN0aW9uKGFyZykgewoJICAgIHJldHVybiB0eXBlb2YoYXJnKSA9PT0gJ3N0cmluZyc7CgkgIH0sCgkgIGlzT2JqZWN0OiBmdW5jdGlvbihhcmcpIHsKCSAgICByZXR1cm4gdHlwZW9mKGFyZykgPT09ICdvYmplY3QnICYmIGFyZyAhPT0gbnVsbDsKCSAgfSwKCSAgaXNOdWxsOiBmdW5jdGlvbihhcmcpIHsKCSAgICByZXR1cm4gYXJnID09PSBudWxsOwoJICB9LAoJICBpc051bGxPclVuZGVmaW5lZDogZnVuY3Rpb24oYXJnKSB7CgkgICAgcmV0dXJuIGFyZyA9PSBudWxsOwoJICB9Cgl9OwoKCi8qKiovIH0sCi8qIDc1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglleHBvcnRzLmRlY29kZSA9IGV4cG9ydHMucGFyc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc2KTsKCWV4cG9ydHMuZW5jb2RlID0gZXhwb3J0cy5zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc3KTsKCgovKioqLyB9LAovKiA3NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCSd1c2Ugc3RyaWN0JzsKCgkvLyBJZiBvYmouaGFzT3duUHJvcGVydHkgaGFzIGJlZW4gb3ZlcnJpZGRlbiwgdGhlbiBjYWxsaW5nCgkvLyBvYmouaGFzT3duUHJvcGVydHkocHJvcCkgd2lsbCBicmVhay4KCS8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2pveWVudC9ub2RlL2lzc3Vlcy8xNzA3CglmdW5jdGlvbiBoYXNPd25Qcm9wZXJ0eShvYmosIHByb3ApIHsKCSAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApOwoJfQoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocXMsIHNlcCwgZXEsIG9wdGlvbnMpIHsKCSAgc2VwID0gc2VwIHx8ICcmJzsKCSAgZXEgPSBlcSB8fCAnPSc7CgkgIHZhciBvYmogPSB7fTsKCgkgIGlmICh0eXBlb2YgcXMgIT09ICdzdHJpbmcnIHx8IHFzLmxlbmd0aCA9PT0gMCkgewoJICAgIHJldHVybiBvYmo7CgkgIH0KCgkgIHZhciByZWdleHAgPSAvXCsvZzsKCSAgcXMgPSBxcy5zcGxpdChzZXApOwoKCSAgdmFyIG1heEtleXMgPSAxMDAwOwoJICBpZiAob3B0aW9ucyAmJiB0eXBlb2Ygb3B0aW9ucy5tYXhLZXlzID09PSAnbnVtYmVyJykgewoJICAgIG1heEtleXMgPSBvcHRpb25zLm1heEtleXM7CgkgIH0KCgkgIHZhciBsZW4gPSBxcy5sZW5ndGg7CgkgIC8vIG1heEtleXMgPD0gMCBtZWFucyB0aGF0IHdlIHNob3VsZCBub3QgbGltaXQga2V5cyBjb3VudAoJICBpZiAobWF4S2V5cyA+IDAgJiYgbGVuID4gbWF4S2V5cykgewoJICAgIGxlbiA9IG1heEtleXM7CgkgIH0KCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHsKCSAgICB2YXIgeCA9IHFzW2ldLnJlcGxhY2UocmVnZXhwLCAnJTIwJyksCgkgICAgICAgIGlkeCA9IHguaW5kZXhPZihlcSksCgkgICAgICAgIGtzdHIsIHZzdHIsIGssIHY7CgoJICAgIGlmIChpZHggPj0gMCkgewoJICAgICAga3N0ciA9IHguc3Vic3RyKDAsIGlkeCk7CgkgICAgICB2c3RyID0geC5zdWJzdHIoaWR4ICsgMSk7CgkgICAgfSBlbHNlIHsKCSAgICAgIGtzdHIgPSB4OwoJICAgICAgdnN0ciA9ICcnOwoJICAgIH0KCgkgICAgayA9IGRlY29kZVVSSUNvbXBvbmVudChrc3RyKTsKCSAgICB2ID0gZGVjb2RlVVJJQ29tcG9uZW50KHZzdHIpOwoKCSAgICBpZiAoIWhhc093blByb3BlcnR5KG9iaiwgaykpIHsKCSAgICAgIG9ialtrXSA9IHY7CgkgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KG9ialtrXSkpIHsKCSAgICAgIG9ialtrXS5wdXNoKHYpOwoJICAgIH0gZWxzZSB7CgkgICAgICBvYmpba10gPSBbb2JqW2tdLCB2XTsKCSAgICB9CgkgIH0KCgkgIHJldHVybiBvYmo7Cgl9OwoKCi8qKiovIH0sCi8qIDc3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLgoJLy8KCS8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCgkvLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCgkvLyAiU29mdHdhcmUiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nCgkvLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCgkvLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0CgkvLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUKCS8vIGZvbGxvd2luZyBjb25kaXRpb25zOgoJLy8KCS8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkCgkvLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCS8vCgkvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUwoJLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgoJLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTgoJLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sCgkvLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKCS8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUKCS8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCgoJJ3VzZSBzdHJpY3QnOwoKCXZhciBzdHJpbmdpZnlQcmltaXRpdmUgPSBmdW5jdGlvbih2KSB7CgkgIHN3aXRjaCAodHlwZW9mIHYpIHsKCSAgICBjYXNlICdzdHJpbmcnOgoJICAgICAgcmV0dXJuIHY7CgoJICAgIGNhc2UgJ2Jvb2xlYW4nOgoJICAgICAgcmV0dXJuIHYgPyAndHJ1ZScgOiAnZmFsc2UnOwoKCSAgICBjYXNlICdudW1iZXInOgoJICAgICAgcmV0dXJuIGlzRmluaXRlKHYpID8gdiA6ICcnOwoKCSAgICBkZWZhdWx0OgoJICAgICAgcmV0dXJuICcnOwoJICB9Cgl9OwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqLCBzZXAsIGVxLCBuYW1lKSB7CgkgIHNlcCA9IHNlcCB8fCAnJic7CgkgIGVxID0gZXEgfHwgJz0nOwoJICBpZiAob2JqID09PSBudWxsKSB7CgkgICAgb2JqID0gdW5kZWZpbmVkOwoJICB9CgoJICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHsKCSAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5tYXAoZnVuY3Rpb24oaykgewoJICAgICAgdmFyIGtzID0gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShrKSkgKyBlcTsKCSAgICAgIGlmIChBcnJheS5pc0FycmF5KG9ialtrXSkpIHsKCSAgICAgICAgcmV0dXJuIG9ialtrXS5tYXAoZnVuY3Rpb24odikgewoJICAgICAgICAgIHJldHVybiBrcyArIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUodikpOwoJICAgICAgICB9KS5qb2luKHNlcCk7CgkgICAgICB9IGVsc2UgewoJICAgICAgICByZXR1cm4ga3MgKyBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG9ialtrXSkpOwoJICAgICAgfQoJICAgIH0pLmpvaW4oc2VwKTsKCgkgIH0KCgkgIGlmICghbmFtZSkgcmV0dXJuICcnOwoJICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShuYW1lKSkgKyBlcSArCgkgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG9iaikpOwoJfTsKCgovKioqLyB9LAovKiA3OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oQnVmZmVyLCBwcm9jZXNzKSB7J3VzZSBzdHJpY3QnOwoKCWNvbnN0IHpsaWIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc5KTsKCgljb25zdCBBVkFJTEFCTEVfV0lORE9XX0JJVFMgPSBbOCwgOSwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNV07Cgljb25zdCBERUZBVUxUX1dJTkRPV19CSVRTID0gMTU7Cgljb25zdCBERUZBVUxUX01FTV9MRVZFTCA9IDg7Cgljb25zdCBUUkFJTEVSID0gQnVmZmVyLmZyb20oWzB4MDAsIDB4MDAsIDB4ZmYsIDB4ZmZdKTsKCWNvbnN0IEVNUFRZX0JMT0NLID0gQnVmZmVyLmZyb20oWzB4MDBdKTsKCgkvKioKCSAqIFBlci1tZXNzYWdlIENvbXByZXNzaW9uIEV4dGVuc2lvbnMgaW1wbGVtZW50YXRpb24KCSAqLwoJY2xhc3MgUGVyTWVzc2FnZURlZmxhdGUgewoJICBjb25zdHJ1Y3RvciAob3B0aW9ucywgaXNTZXJ2ZXIsIG1heFBheWxvYWQpIHsKCSAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCSAgICB0aGlzLl9pc1NlcnZlciA9ICEhaXNTZXJ2ZXI7CgkgICAgdGhpcy5faW5mbGF0ZSA9IG51bGw7CgkgICAgdGhpcy5fZGVmbGF0ZSA9IG51bGw7CgkgICAgdGhpcy5wYXJhbXMgPSBudWxsOwoJICAgIHRoaXMuX21heFBheWxvYWQgPSBtYXhQYXlsb2FkIHx8IDA7CgkgICAgdGhpcy50aHJlc2hvbGQgPSB0aGlzLl9vcHRpb25zLnRocmVzaG9sZCA9PT0gdW5kZWZpbmVkID8gMTAyNCA6IHRoaXMuX29wdGlvbnMudGhyZXNob2xkOwoJICB9CgoJICAvKioKCSAgICogQ3JlYXRlIGV4dGVuc2lvbiBwYXJhbWV0ZXJzIG9mZmVyCgkgICAqCgkgICAqIEBhcGkgcHVibGljCgkgICAqLwoKCSAgb2ZmZXIgKCkgewoJICAgIHZhciBwYXJhbXMgPSB7fTsKCSAgICBpZiAodGhpcy5fb3B0aW9ucy5zZXJ2ZXJOb0NvbnRleHRUYWtlb3ZlcikgewoJICAgICAgcGFyYW1zLnNlcnZlcl9ub19jb250ZXh0X3Rha2VvdmVyID0gdHJ1ZTsKCSAgICB9CgkgICAgaWYgKHRoaXMuX29wdGlvbnMuY2xpZW50Tm9Db250ZXh0VGFrZW92ZXIpIHsKCSAgICAgIHBhcmFtcy5jbGllbnRfbm9fY29udGV4dF90YWtlb3ZlciA9IHRydWU7CgkgICAgfQoJICAgIGlmICh0aGlzLl9vcHRpb25zLnNlcnZlck1heFdpbmRvd0JpdHMpIHsKCSAgICAgIHBhcmFtcy5zZXJ2ZXJfbWF4X3dpbmRvd19iaXRzID0gdGhpcy5fb3B0aW9ucy5zZXJ2ZXJNYXhXaW5kb3dCaXRzOwoJICAgIH0KCSAgICBpZiAodGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzKSB7CgkgICAgICBwYXJhbXMuY2xpZW50X21heF93aW5kb3dfYml0cyA9IHRoaXMuX29wdGlvbnMuY2xpZW50TWF4V2luZG93Qml0czsKCSAgICB9IGVsc2UgaWYgKHRoaXMuX29wdGlvbnMuY2xpZW50TWF4V2luZG93Qml0cyA9PSBudWxsKSB7CgkgICAgICBwYXJhbXMuY2xpZW50X21heF93aW5kb3dfYml0cyA9IHRydWU7CgkgICAgfQoJICAgIHJldHVybiBwYXJhbXM7CgkgIH0KCgkgIC8qKgoJICAgKiBBY2NlcHQgZXh0ZW5zaW9uIG9mZmVyCgkgICAqCgkgICAqIEBhcGkgcHVibGljCgkgICAqLwoJICBhY2NlcHQgKHBhcmFtc0xpc3QpIHsKCSAgICBwYXJhbXNMaXN0ID0gdGhpcy5ub3JtYWxpemVQYXJhbXMocGFyYW1zTGlzdCk7CgoJICAgIHZhciBwYXJhbXM7CgkgICAgaWYgKHRoaXMuX2lzU2VydmVyKSB7CgkgICAgICBwYXJhbXMgPSB0aGlzLmFjY2VwdEFzU2VydmVyKHBhcmFtc0xpc3QpOwoJICAgIH0gZWxzZSB7CgkgICAgICBwYXJhbXMgPSB0aGlzLmFjY2VwdEFzQ2xpZW50KHBhcmFtc0xpc3QpOwoJICAgIH0KCgkgICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7CgkgICAgcmV0dXJuIHBhcmFtczsKCSAgfQoKCSAgLyoqCgkgICAqIFJlbGVhc2VzIGFsbCByZXNvdXJjZXMgdXNlZCBieSB0aGUgZXh0ZW5zaW9uCgkgICAqCgkgICAqIEBhcGkgcHVibGljCgkgICAqLwoJICBjbGVhbnVwICgpIHsKCSAgICBpZiAodGhpcy5faW5mbGF0ZSkgewoJICAgICAgaWYgKHRoaXMuX2luZmxhdGUud3JpdGVJblByb2dyZXNzKSB7CgkgICAgICAgIHRoaXMuX2luZmxhdGUucGVuZGluZ0Nsb3NlID0gdHJ1ZTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIHRoaXMuX2luZmxhdGUuY2xvc2UoKTsKCSAgICAgICAgdGhpcy5faW5mbGF0ZSA9IG51bGw7CgkgICAgICB9CgkgICAgfQoJICAgIGlmICh0aGlzLl9kZWZsYXRlKSB7CgkgICAgICBpZiAodGhpcy5fZGVmbGF0ZS53cml0ZUluUHJvZ3Jlc3MpIHsKCSAgICAgICAgdGhpcy5fZGVmbGF0ZS5wZW5kaW5nQ2xvc2UgPSB0cnVlOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgdGhpcy5fZGVmbGF0ZS5jbG9zZSgpOwoJICAgICAgICB0aGlzLl9kZWZsYXRlID0gbnVsbDsKCSAgICAgIH0KCSAgICB9CgkgIH0KCgkgIC8qKgoJICAgKiBBY2NlcHQgZXh0ZW5zaW9uIG9mZmVyIGZyb20gY2xpZW50CgkgICAqCgkgICAqIEBhcGkgcHJpdmF0ZQoJICAgKi8KCgkgIGFjY2VwdEFzU2VydmVyIChwYXJhbXNMaXN0KSB7CgkgICAgdmFyIGFjY2VwdGVkID0ge307CgkgICAgdmFyIHJlc3VsdCA9IHBhcmFtc0xpc3Quc29tZSgocGFyYW1zKSA9PiB7CgkgICAgICBhY2NlcHRlZCA9IHt9OwoJICAgICAgaWYgKHRoaXMuX29wdGlvbnMuc2VydmVyTm9Db250ZXh0VGFrZW92ZXIgPT09IGZhbHNlICYmIHBhcmFtcy5zZXJ2ZXJfbm9fY29udGV4dF90YWtlb3ZlcikgewoJICAgICAgICByZXR1cm47CgkgICAgICB9CgkgICAgICBpZiAodGhpcy5fb3B0aW9ucy5zZXJ2ZXJNYXhXaW5kb3dCaXRzID09PSBmYWxzZSAmJiBwYXJhbXMuc2VydmVyX21heF93aW5kb3dfYml0cykgewoJICAgICAgICByZXR1cm47CgkgICAgICB9CgkgICAgICBpZiAodHlwZW9mIHRoaXMuX29wdGlvbnMuc2VydmVyTWF4V2luZG93Qml0cyA9PT0gJ251bWJlcicgJiYKCSAgICAgICAgICB0eXBlb2YgcGFyYW1zLnNlcnZlcl9tYXhfd2luZG93X2JpdHMgPT09ICdudW1iZXInICYmCgkgICAgICAgICAgdGhpcy5fb3B0aW9ucy5zZXJ2ZXJNYXhXaW5kb3dCaXRzID4gcGFyYW1zLnNlcnZlcl9tYXhfd2luZG93X2JpdHMpIHsKCSAgICAgICAgcmV0dXJuOwoJICAgICAgfQoJICAgICAgaWYgKHR5cGVvZiB0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHMgPT09ICdudW1iZXInICYmICFwYXJhbXMuY2xpZW50X21heF93aW5kb3dfYml0cykgewoJICAgICAgICByZXR1cm47CgkgICAgICB9CgoJICAgICAgaWYgKHRoaXMuX29wdGlvbnMuc2VydmVyTm9Db250ZXh0VGFrZW92ZXIgfHwgcGFyYW1zLnNlcnZlcl9ub19jb250ZXh0X3Rha2VvdmVyKSB7CgkgICAgICAgIGFjY2VwdGVkLnNlcnZlcl9ub19jb250ZXh0X3Rha2VvdmVyID0gdHJ1ZTsKCSAgICAgIH0KCSAgICAgIGlmICh0aGlzLl9vcHRpb25zLmNsaWVudE5vQ29udGV4dFRha2VvdmVyKSB7CgkgICAgICAgIGFjY2VwdGVkLmNsaWVudF9ub19jb250ZXh0X3Rha2VvdmVyID0gdHJ1ZTsKCSAgICAgIH0KCSAgICAgIGlmICh0aGlzLl9vcHRpb25zLmNsaWVudE5vQ29udGV4dFRha2VvdmVyICE9PSBmYWxzZSAmJiBwYXJhbXMuY2xpZW50X25vX2NvbnRleHRfdGFrZW92ZXIpIHsKCSAgICAgICAgYWNjZXB0ZWQuY2xpZW50X25vX2NvbnRleHRfdGFrZW92ZXIgPSB0cnVlOwoJICAgICAgfQoJICAgICAgaWYgKHR5cGVvZiB0aGlzLl9vcHRpb25zLnNlcnZlck1heFdpbmRvd0JpdHMgPT09ICdudW1iZXInKSB7CgkgICAgICAgIGFjY2VwdGVkLnNlcnZlcl9tYXhfd2luZG93X2JpdHMgPSB0aGlzLl9vcHRpb25zLnNlcnZlck1heFdpbmRvd0JpdHM7CgkgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBwYXJhbXMuc2VydmVyX21heF93aW5kb3dfYml0cyA9PT0gJ251bWJlcicpIHsKCSAgICAgICAgYWNjZXB0ZWQuc2VydmVyX21heF93aW5kb3dfYml0cyA9IHBhcmFtcy5zZXJ2ZXJfbWF4X3dpbmRvd19iaXRzOwoJICAgICAgfQoJICAgICAgaWYgKHR5cGVvZiB0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHMgPT09ICdudW1iZXInKSB7CgkgICAgICAgIGFjY2VwdGVkLmNsaWVudF9tYXhfd2luZG93X2JpdHMgPSB0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHM7CgkgICAgICB9IGVsc2UgaWYgKHRoaXMuX29wdGlvbnMuY2xpZW50TWF4V2luZG93Qml0cyAhPT0gZmFsc2UgJiYgdHlwZW9mIHBhcmFtcy5jbGllbnRfbWF4X3dpbmRvd19iaXRzID09PSAnbnVtYmVyJykgewoJICAgICAgICBhY2NlcHRlZC5jbGllbnRfbWF4X3dpbmRvd19iaXRzID0gcGFyYW1zLmNsaWVudF9tYXhfd2luZG93X2JpdHM7CgkgICAgICB9CgkgICAgICByZXR1cm4gdHJ1ZTsKCSAgICB9KTsKCgkgICAgaWYgKCFyZXN1bHQpIHsKCSAgICAgIHRocm93IG5ldyBFcnJvcihgRG9lc24ndCBzdXBwb3J0IHRoZSBvZmZlcmVkIGNvbmZpZ3VyYXRpb25gKTsKCSAgICB9CgoJICAgIHJldHVybiBhY2NlcHRlZDsKCSAgfQoKCSAgLyoqCgkgICAqIEFjY2VwdCBleHRlbnNpb24gcmVzcG9uc2UgZnJvbSBzZXJ2ZXIKCSAgICoKCSAgICogQGFwaSBwcml2YXllCgkgICAqLwoKCSAgYWNjZXB0QXNDbGllbnQgKHBhcmFtc0xpc3QpIHsKCSAgICB2YXIgcGFyYW1zID0gcGFyYW1zTGlzdFswXTsKCSAgICBpZiAodGhpcy5fb3B0aW9ucy5jbGllbnROb0NvbnRleHRUYWtlb3ZlciAhPSBudWxsKSB7CgkgICAgICBpZiAodGhpcy5fb3B0aW9ucy5jbGllbnROb0NvbnRleHRUYWtlb3ZlciA9PT0gZmFsc2UgJiYgcGFyYW1zLmNsaWVudF9ub19jb250ZXh0X3Rha2VvdmVyKSB7CgkgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB2YWx1ZSBmb3IgImNsaWVudF9ub19jb250ZXh0X3Rha2VvdmVyIicpOwoJICAgICAgfQoJICAgIH0KCSAgICBpZiAodGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzICE9IG51bGwpIHsKCSAgICAgIGlmICh0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHMgPT09IGZhbHNlICYmIHBhcmFtcy5jbGllbnRfbWF4X3dpbmRvd19iaXRzKSB7CgkgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB2YWx1ZSBmb3IgImNsaWVudF9tYXhfd2luZG93X2JpdHMiJyk7CgkgICAgICB9CgkgICAgICBpZiAodHlwZW9mIHRoaXMuX29wdGlvbnMuY2xpZW50TWF4V2luZG93Qml0cyA9PT0gJ251bWJlcicgJiYKCSAgICAgICAgICAoIXBhcmFtcy5jbGllbnRfbWF4X3dpbmRvd19iaXRzIHx8IHBhcmFtcy5jbGllbnRfbWF4X3dpbmRvd19iaXRzID4gdGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzKSkgewoJICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdmFsdWUgZm9yICJjbGllbnRfbWF4X3dpbmRvd19iaXRzIicpOwoJICAgICAgfQoJICAgIH0KCSAgICByZXR1cm4gcGFyYW1zOwoJICB9CgoJICAvKioKCSAgICogTm9ybWFsaXplIGV4dGVuc2lvbnMgcGFyYW1ldGVycwoJICAgKgoJICAgKiBAYXBpIHByaXZhdGUKCSAgICovCgoJICBub3JtYWxpemVQYXJhbXMgKHBhcmFtc0xpc3QpIHsKCSAgICByZXR1cm4gcGFyYW1zTGlzdC5tYXAoKHBhcmFtcykgPT4gewoJICAgICAgT2JqZWN0LmtleXMocGFyYW1zKS5mb3JFYWNoKChrZXkpID0+IHsKCSAgICAgICAgdmFyIHZhbHVlID0gcGFyYW1zW2tleV07CgkgICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAxKSB7CgkgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNdWx0aXBsZSBleHRlbnNpb24gcGFyYW1ldGVycyBmb3IgJyArIGtleSk7CgkgICAgICAgIH0KCgkgICAgICAgIHZhbHVlID0gdmFsdWVbMF07CgoJICAgICAgICBzd2l0Y2ggKGtleSkgewoJICAgICAgICAgIGNhc2UgJ3NlcnZlcl9ub19jb250ZXh0X3Rha2VvdmVyJzoKCSAgICAgICAgICBjYXNlICdjbGllbnRfbm9fY29udGV4dF90YWtlb3Zlcic6CgkgICAgICAgICAgICBpZiAodmFsdWUgIT09IHRydWUpIHsKCSAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIGV4dGVuc2lvbiBwYXJhbWV0ZXIgdmFsdWUgZm9yICR7a2V5fSAoJHt2YWx1ZX0pYCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBwYXJhbXNba2V5XSA9IHRydWU7CgkgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICBjYXNlICdzZXJ2ZXJfbWF4X3dpbmRvd19iaXRzJzoKCSAgICAgICAgICBjYXNlICdjbGllbnRfbWF4X3dpbmRvd19iaXRzJzoKCSAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7CgkgICAgICAgICAgICAgIHZhbHVlID0gcGFyc2VJbnQodmFsdWUsIDEwKTsKCSAgICAgICAgICAgICAgaWYgKCF+QVZBSUxBQkxFX1dJTkRPV19CSVRTLmluZGV4T2YodmFsdWUpKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIGV4dGVuc2lvbiBwYXJhbWV0ZXIgdmFsdWUgZm9yICR7a2V5fSAoJHt2YWx1ZX0pYCk7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICghdGhpcy5faXNTZXJ2ZXIgJiYgdmFsdWUgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIGV4dGVuc2lvbiBwYXJhbWV0ZXIgdmFsdWUgZm9yICR7a2V5fWApOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcGFyYW1zW2tleV0gPSB2YWx1ZTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgIGRlZmF1bHQ6CgkgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vdCBkZWZpbmVkIGV4dGVuc2lvbiBwYXJhbWV0ZXIgKCR7a2V5fSlgKTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgICByZXR1cm4gcGFyYW1zOwoJICAgIH0pOwoJICB9CgoJICAvKioKCSAgICogRGVjb21wcmVzcyBkYXRhLgoJICAgKgoJICAgKiBAcGFyYW0ge0J1ZmZlcn0gZGF0YSBDb21wcmVzc2VkIGRhdGEKCSAgICogQHBhcmFtIHtCb29sZWFufSBmaW4gU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRoaXMgaXMgdGhlIGxhc3QgZnJhZ21lbnQKCSAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgQ2FsbGJhY2sKCSAgICogQHB1YmxpYwoJICAgKi8KCSAgZGVjb21wcmVzcyAoZGF0YSwgZmluLCBjYWxsYmFjaykgewoJICAgIGNvbnN0IGVuZHBvaW50ID0gdGhpcy5faXNTZXJ2ZXIgPyAnY2xpZW50JyA6ICdzZXJ2ZXInOwoKCSAgICBpZiAoIXRoaXMuX2luZmxhdGUpIHsKCSAgICAgIGNvbnN0IG1heFdpbmRvd0JpdHMgPSB0aGlzLnBhcmFtc1tgJHtlbmRwb2ludH1fbWF4X3dpbmRvd19iaXRzYF07CgkgICAgICB0aGlzLl9pbmZsYXRlID0gemxpYi5jcmVhdGVJbmZsYXRlUmF3KHsKCSAgICAgICAgd2luZG93Qml0czogdHlwZW9mIG1heFdpbmRvd0JpdHMgPT09ICdudW1iZXInID8gbWF4V2luZG93Qml0cyA6IERFRkFVTFRfV0lORE9XX0JJVFMKCSAgICAgIH0pOwoJICAgIH0KCSAgICB0aGlzLl9pbmZsYXRlLndyaXRlSW5Qcm9ncmVzcyA9IHRydWU7CgoJICAgIHZhciB0b3RhbExlbmd0aCA9IDA7CgkgICAgY29uc3QgYnVmZmVycyA9IFtdOwoJICAgIHZhciBlcnI7CgoJICAgIGNvbnN0IG9uRGF0YSA9IChkYXRhKSA9PiB7CgkgICAgICB0b3RhbExlbmd0aCArPSBkYXRhLmxlbmd0aDsKCSAgICAgIGlmICh0aGlzLl9tYXhQYXlsb2FkIDwgMSB8fCB0b3RhbExlbmd0aCA8PSB0aGlzLl9tYXhQYXlsb2FkKSB7CgkgICAgICAgIHJldHVybiBidWZmZXJzLnB1c2goZGF0YSk7CgkgICAgICB9CgoJICAgICAgZXJyID0gbmV3IEVycm9yKCdtYXggcGF5bG9hZCBzaXplIGV4Y2VlZGVkJyk7CgkgICAgICBlcnIuY2xvc2VDb2RlID0gMTAwOTsKCSAgICAgIHRoaXMuX2luZmxhdGUucmVzZXQoKTsKCSAgICB9OwoKCSAgICBjb25zdCBvbkVycm9yID0gKGVycikgPT4gewoJICAgICAgY2xlYW51cCgpOwoJICAgICAgY2FsbGJhY2soZXJyKTsKCSAgICB9OwoKCSAgICBjb25zdCBjbGVhbnVwID0gKCkgPT4gewoJICAgICAgaWYgKCF0aGlzLl9pbmZsYXRlKSByZXR1cm47CgoJICAgICAgdGhpcy5faW5mbGF0ZS5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBvbkVycm9yKTsKCSAgICAgIHRoaXMuX2luZmxhdGUucmVtb3ZlTGlzdGVuZXIoJ2RhdGEnLCBvbkRhdGEpOwoJICAgICAgdGhpcy5faW5mbGF0ZS53cml0ZUluUHJvZ3Jlc3MgPSBmYWxzZTsKCgkgICAgICBpZiAoCgkgICAgICAgIGZpbiAmJiB0aGlzLnBhcmFtc1tgJHtlbmRwb2ludH1fbm9fY29udGV4dF90YWtlb3ZlcmBdIHx8CgkgICAgICAgIHRoaXMuX2luZmxhdGUucGVuZGluZ0Nsb3NlCgkgICAgICApIHsKCSAgICAgICAgdGhpcy5faW5mbGF0ZS5jbG9zZSgpOwoJICAgICAgICB0aGlzLl9pbmZsYXRlID0gbnVsbDsKCSAgICAgIH0KCSAgICB9OwoKCSAgICB0aGlzLl9pbmZsYXRlLm9uKCdlcnJvcicsIG9uRXJyb3IpLm9uKCdkYXRhJywgb25EYXRhKTsKCSAgICB0aGlzLl9pbmZsYXRlLndyaXRlKGRhdGEpOwoJICAgIGlmIChmaW4pIHRoaXMuX2luZmxhdGUud3JpdGUoVFJBSUxFUik7CgoJICAgIHRoaXMuX2luZmxhdGUuZmx1c2goKCkgPT4gewoJICAgICAgY2xlYW51cCgpOwoJICAgICAgaWYgKGVycikgY2FsbGJhY2soZXJyKTsKCSAgICAgIGVsc2UgY2FsbGJhY2sobnVsbCwgQnVmZmVyLmNvbmNhdChidWZmZXJzLCB0b3RhbExlbmd0aCkpOwoJICAgIH0pOwoJICB9CgoJICAvKioKCSAgICogQ29tcHJlc3MgbWVzc2FnZQoJICAgKgoJICAgKiBAYXBpIHB1YmxpYwoJICAgKi8KCgkgIGNvbXByZXNzIChkYXRhLCBmaW4sIGNhbGxiYWNrKSB7CgkgICAgaWYgKCFkYXRhIHx8IGRhdGEubGVuZ3RoID09PSAwKSB7CgkgICAgICBwcm9jZXNzLm5leHRUaWNrKGNhbGxiYWNrLCBudWxsLCBFTVBUWV9CTE9DSyk7CgkgICAgICByZXR1cm47CgkgICAgfQoKCSAgICB2YXIgZW5kcG9pbnQgPSB0aGlzLl9pc1NlcnZlciA/ICdzZXJ2ZXInIDogJ2NsaWVudCc7CgoJICAgIGlmICghdGhpcy5fZGVmbGF0ZSkgewoJICAgICAgdmFyIG1heFdpbmRvd0JpdHMgPSB0aGlzLnBhcmFtc1tlbmRwb2ludCArICdfbWF4X3dpbmRvd19iaXRzJ107CgkgICAgICB0aGlzLl9kZWZsYXRlID0gemxpYi5jcmVhdGVEZWZsYXRlUmF3KHsKCSAgICAgICAgZmx1c2g6IHpsaWIuWl9TWU5DX0ZMVVNILAoJICAgICAgICB3aW5kb3dCaXRzOiB0eXBlb2YgbWF4V2luZG93Qml0cyA9PT0gJ251bWJlcicgPyBtYXhXaW5kb3dCaXRzIDogREVGQVVMVF9XSU5ET1dfQklUUywKCSAgICAgICAgbWVtTGV2ZWw6IHRoaXMuX29wdGlvbnMubWVtTGV2ZWwgfHwgREVGQVVMVF9NRU1fTEVWRUwKCSAgICAgIH0pOwoJICAgIH0KCSAgICB0aGlzLl9kZWZsYXRlLndyaXRlSW5Qcm9ncmVzcyA9IHRydWU7CgoJICAgIGNvbnN0IGJ1ZmZlcnMgPSBbXTsKCgkgICAgY29uc3Qgb25EYXRhID0gKGRhdGEpID0+IGJ1ZmZlcnMucHVzaChkYXRhKTsKCSAgICBjb25zdCBvbkVycm9yID0gKGVycikgPT4gewoJICAgICAgY2xlYW51cCgpOwoJICAgICAgY2FsbGJhY2soZXJyKTsKCSAgICB9OwoJICAgIGNvbnN0IGNsZWFudXAgPSAoKSA9PiB7CgkgICAgICBpZiAoIXRoaXMuX2RlZmxhdGUpIHJldHVybjsKCSAgICAgIHRoaXMuX2RlZmxhdGUucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25FcnJvcik7CgkgICAgICB0aGlzLl9kZWZsYXRlLnJlbW92ZUxpc3RlbmVyKCdkYXRhJywgb25EYXRhKTsKCSAgICAgIHRoaXMuX2RlZmxhdGUud3JpdGVJblByb2dyZXNzID0gZmFsc2U7CgkgICAgICBpZiAoKGZpbiAmJiB0aGlzLnBhcmFtc1tlbmRwb2ludCArICdfbm9fY29udGV4dF90YWtlb3ZlciddKSB8fCB0aGlzLl9kZWZsYXRlLnBlbmRpbmdDbG9zZSkgewoJICAgICAgICB0aGlzLl9kZWZsYXRlLmNsb3NlKCk7CgkgICAgICAgIHRoaXMuX2RlZmxhdGUgPSBudWxsOwoJICAgICAgfQoJICAgIH07CgoJICAgIHRoaXMuX2RlZmxhdGUub24oJ2Vycm9yJywgb25FcnJvcikub24oJ2RhdGEnLCBvbkRhdGEpOwoJICAgIHRoaXMuX2RlZmxhdGUud3JpdGUoZGF0YSk7CgkgICAgdGhpcy5fZGVmbGF0ZS5mbHVzaCh6bGliLlpfU1lOQ19GTFVTSCwgKCkgPT4gewoJICAgICAgY2xlYW51cCgpOwoJICAgICAgdmFyIGRhdGEgPSBCdWZmZXIuY29uY2F0KGJ1ZmZlcnMpOwoJICAgICAgaWYgKGZpbikgewoJICAgICAgICBkYXRhID0gZGF0YS5zbGljZSgwLCBkYXRhLmxlbmd0aCAtIDQpOwoJICAgICAgfQoJICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSk7CgkgICAgfSk7CgkgIH0KCX0KCglQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lID0gJ3Blcm1lc3NhZ2UtZGVmbGF0ZSc7CgoJbW9kdWxlLmV4cG9ydHMgPSBQZXJNZXNzYWdlRGVmbGF0ZTsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5CdWZmZXIsIF9fd2VicGFja19yZXF1aXJlX18oMTYpKSkKCi8qKiovIH0sCi8qIDc5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIsIHByb2Nlc3MpIHsvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCXZhciBUcmFuc2Zvcm0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCgl2YXIgYmluZGluZyA9IF9fd2VicGFja19yZXF1aXJlX18oODApOwoJdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTsKCXZhciBhc3NlcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkyKS5vazsKCgkvLyB6bGliIGRvZXNuJ3QgcHJvdmlkZSB0aGVzZSwgc28ga2x1ZGdlIHRoZW0gaW4gZm9sbG93aW5nIHRoZSBzYW1lCgkvLyBjb25zdCBuYW1pbmcgc2NoZW1lIHpsaWIgdXNlcy4KCWJpbmRpbmcuWl9NSU5fV0lORE9XQklUUyA9IDg7CgliaW5kaW5nLlpfTUFYX1dJTkRPV0JJVFMgPSAxNTsKCWJpbmRpbmcuWl9ERUZBVUxUX1dJTkRPV0JJVFMgPSAxNTsKCgkvLyBmZXdlciB0aGFuIDY0IGJ5dGVzIHBlciBjaHVuayBpcyBzdHVwaWQuCgkvLyB0ZWNobmljYWxseSBpdCBjb3VsZCB3b3JrIHdpdGggYXMgZmV3IGFzIDgsIGJ1dCBldmVuIDY0IGJ5dGVzCgkvLyBpcyBhYnN1cmRseSBsb3cuICBVc3VhbGx5IGEgTUIgb3IgbW9yZSBpcyBiZXN0LgoJYmluZGluZy5aX01JTl9DSFVOSyA9IDY0OwoJYmluZGluZy5aX01BWF9DSFVOSyA9IEluZmluaXR5OwoJYmluZGluZy5aX0RFRkFVTFRfQ0hVTksgPSAoMTYgKiAxMDI0KTsKCgliaW5kaW5nLlpfTUlOX01FTUxFVkVMID0gMTsKCWJpbmRpbmcuWl9NQVhfTUVNTEVWRUwgPSA5OwoJYmluZGluZy5aX0RFRkFVTFRfTUVNTEVWRUwgPSA4OwoKCWJpbmRpbmcuWl9NSU5fTEVWRUwgPSAtMTsKCWJpbmRpbmcuWl9NQVhfTEVWRUwgPSA5OwoJYmluZGluZy5aX0RFRkFVTFRfTEVWRUwgPSBiaW5kaW5nLlpfREVGQVVMVF9DT01QUkVTU0lPTjsKCgkvLyBleHBvc2UgYWxsIHRoZSB6bGliIGNvbnN0YW50cwoJT2JqZWN0LmtleXMoYmluZGluZykuZm9yRWFjaChmdW5jdGlvbihrKSB7CgkgIGlmIChrLm1hdGNoKC9eWi8pKSBleHBvcnRzW2tdID0gYmluZGluZ1trXTsKCX0pOwoKCS8vIHRyYW5zbGF0aW9uIHRhYmxlIGZvciByZXR1cm4gY29kZXMuCglleHBvcnRzLmNvZGVzID0gewoJICBaX09LOiBiaW5kaW5nLlpfT0ssCgkgIFpfU1RSRUFNX0VORDogYmluZGluZy5aX1NUUkVBTV9FTkQsCgkgIFpfTkVFRF9ESUNUOiBiaW5kaW5nLlpfTkVFRF9ESUNULAoJICBaX0VSUk5POiBiaW5kaW5nLlpfRVJSTk8sCgkgIFpfU1RSRUFNX0VSUk9SOiBiaW5kaW5nLlpfU1RSRUFNX0VSUk9SLAoJICBaX0RBVEFfRVJST1I6IGJpbmRpbmcuWl9EQVRBX0VSUk9SLAoJICBaX01FTV9FUlJPUjogYmluZGluZy5aX01FTV9FUlJPUiwKCSAgWl9CVUZfRVJST1I6IGJpbmRpbmcuWl9CVUZfRVJST1IsCgkgIFpfVkVSU0lPTl9FUlJPUjogYmluZGluZy5aX1ZFUlNJT05fRVJST1IKCX07CgoJT2JqZWN0LmtleXMoZXhwb3J0cy5jb2RlcykuZm9yRWFjaChmdW5jdGlvbihrKSB7CgkgIGV4cG9ydHMuY29kZXNbZXhwb3J0cy5jb2Rlc1trXV0gPSBrOwoJfSk7CgoJZXhwb3J0cy5EZWZsYXRlID0gRGVmbGF0ZTsKCWV4cG9ydHMuSW5mbGF0ZSA9IEluZmxhdGU7CglleHBvcnRzLkd6aXAgPSBHemlwOwoJZXhwb3J0cy5HdW56aXAgPSBHdW56aXA7CglleHBvcnRzLkRlZmxhdGVSYXcgPSBEZWZsYXRlUmF3OwoJZXhwb3J0cy5JbmZsYXRlUmF3ID0gSW5mbGF0ZVJhdzsKCWV4cG9ydHMuVW56aXAgPSBVbnppcDsKCglleHBvcnRzLmNyZWF0ZURlZmxhdGUgPSBmdW5jdGlvbihvKSB7CgkgIHJldHVybiBuZXcgRGVmbGF0ZShvKTsKCX07CgoJZXhwb3J0cy5jcmVhdGVJbmZsYXRlID0gZnVuY3Rpb24obykgewoJICByZXR1cm4gbmV3IEluZmxhdGUobyk7Cgl9OwoKCWV4cG9ydHMuY3JlYXRlRGVmbGF0ZVJhdyA9IGZ1bmN0aW9uKG8pIHsKCSAgcmV0dXJuIG5ldyBEZWZsYXRlUmF3KG8pOwoJfTsKCglleHBvcnRzLmNyZWF0ZUluZmxhdGVSYXcgPSBmdW5jdGlvbihvKSB7CgkgIHJldHVybiBuZXcgSW5mbGF0ZVJhdyhvKTsKCX07CgoJZXhwb3J0cy5jcmVhdGVHemlwID0gZnVuY3Rpb24obykgewoJICByZXR1cm4gbmV3IEd6aXAobyk7Cgl9OwoKCWV4cG9ydHMuY3JlYXRlR3VuemlwID0gZnVuY3Rpb24obykgewoJICByZXR1cm4gbmV3IEd1bnppcChvKTsKCX07CgoJZXhwb3J0cy5jcmVhdGVVbnppcCA9IGZ1bmN0aW9uKG8pIHsKCSAgcmV0dXJuIG5ldyBVbnppcChvKTsKCX07CgoKCS8vIENvbnZlbmllbmNlIG1ldGhvZHMuCgkvLyBjb21wcmVzcy9kZWNvbXByZXNzIGEgc3RyaW5nIG9yIGJ1ZmZlciBpbiBvbmUgc3RlcC4KCWV4cG9ydHMuZGVmbGF0ZSA9IGZ1bmN0aW9uKGJ1ZmZlciwgb3B0cywgY2FsbGJhY2spIHsKCSAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nKSB7CgkgICAgY2FsbGJhY2sgPSBvcHRzOwoJICAgIG9wdHMgPSB7fTsKCSAgfQoJICByZXR1cm4gemxpYkJ1ZmZlcihuZXcgRGVmbGF0ZShvcHRzKSwgYnVmZmVyLCBjYWxsYmFjayk7Cgl9OwoKCWV4cG9ydHMuZGVmbGF0ZVN5bmMgPSBmdW5jdGlvbihidWZmZXIsIG9wdHMpIHsKCSAgcmV0dXJuIHpsaWJCdWZmZXJTeW5jKG5ldyBEZWZsYXRlKG9wdHMpLCBidWZmZXIpOwoJfTsKCglleHBvcnRzLmd6aXAgPSBmdW5jdGlvbihidWZmZXIsIG9wdHMsIGNhbGxiYWNrKSB7CgkgIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIGNhbGxiYWNrID0gb3B0czsKCSAgICBvcHRzID0ge307CgkgIH0KCSAgcmV0dXJuIHpsaWJCdWZmZXIobmV3IEd6aXAob3B0cyksIGJ1ZmZlciwgY2FsbGJhY2spOwoJfTsKCglleHBvcnRzLmd6aXBTeW5jID0gZnVuY3Rpb24oYnVmZmVyLCBvcHRzKSB7CgkgIHJldHVybiB6bGliQnVmZmVyU3luYyhuZXcgR3ppcChvcHRzKSwgYnVmZmVyKTsKCX07CgoJZXhwb3J0cy5kZWZsYXRlUmF3ID0gZnVuY3Rpb24oYnVmZmVyLCBvcHRzLCBjYWxsYmFjaykgewoJICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicpIHsKCSAgICBjYWxsYmFjayA9IG9wdHM7CgkgICAgb3B0cyA9IHt9OwoJICB9CgkgIHJldHVybiB6bGliQnVmZmVyKG5ldyBEZWZsYXRlUmF3KG9wdHMpLCBidWZmZXIsIGNhbGxiYWNrKTsKCX07CgoJZXhwb3J0cy5kZWZsYXRlUmF3U3luYyA9IGZ1bmN0aW9uKGJ1ZmZlciwgb3B0cykgewoJICByZXR1cm4gemxpYkJ1ZmZlclN5bmMobmV3IERlZmxhdGVSYXcob3B0cyksIGJ1ZmZlcik7Cgl9OwoKCWV4cG9ydHMudW56aXAgPSBmdW5jdGlvbihidWZmZXIsIG9wdHMsIGNhbGxiYWNrKSB7CgkgIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIGNhbGxiYWNrID0gb3B0czsKCSAgICBvcHRzID0ge307CgkgIH0KCSAgcmV0dXJuIHpsaWJCdWZmZXIobmV3IFVuemlwKG9wdHMpLCBidWZmZXIsIGNhbGxiYWNrKTsKCX07CgoJZXhwb3J0cy51bnppcFN5bmMgPSBmdW5jdGlvbihidWZmZXIsIG9wdHMpIHsKCSAgcmV0dXJuIHpsaWJCdWZmZXJTeW5jKG5ldyBVbnppcChvcHRzKSwgYnVmZmVyKTsKCX07CgoJZXhwb3J0cy5pbmZsYXRlID0gZnVuY3Rpb24oYnVmZmVyLCBvcHRzLCBjYWxsYmFjaykgewoJICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicpIHsKCSAgICBjYWxsYmFjayA9IG9wdHM7CgkgICAgb3B0cyA9IHt9OwoJICB9CgkgIHJldHVybiB6bGliQnVmZmVyKG5ldyBJbmZsYXRlKG9wdHMpLCBidWZmZXIsIGNhbGxiYWNrKTsKCX07CgoJZXhwb3J0cy5pbmZsYXRlU3luYyA9IGZ1bmN0aW9uKGJ1ZmZlciwgb3B0cykgewoJICByZXR1cm4gemxpYkJ1ZmZlclN5bmMobmV3IEluZmxhdGUob3B0cyksIGJ1ZmZlcik7Cgl9OwoKCWV4cG9ydHMuZ3VuemlwID0gZnVuY3Rpb24oYnVmZmVyLCBvcHRzLCBjYWxsYmFjaykgewoJICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicpIHsKCSAgICBjYWxsYmFjayA9IG9wdHM7CgkgICAgb3B0cyA9IHt9OwoJICB9CgkgIHJldHVybiB6bGliQnVmZmVyKG5ldyBHdW56aXAob3B0cyksIGJ1ZmZlciwgY2FsbGJhY2spOwoJfTsKCglleHBvcnRzLmd1bnppcFN5bmMgPSBmdW5jdGlvbihidWZmZXIsIG9wdHMpIHsKCSAgcmV0dXJuIHpsaWJCdWZmZXJTeW5jKG5ldyBHdW56aXAob3B0cyksIGJ1ZmZlcik7Cgl9OwoKCWV4cG9ydHMuaW5mbGF0ZVJhdyA9IGZ1bmN0aW9uKGJ1ZmZlciwgb3B0cywgY2FsbGJhY2spIHsKCSAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nKSB7CgkgICAgY2FsbGJhY2sgPSBvcHRzOwoJICAgIG9wdHMgPSB7fTsKCSAgfQoJICByZXR1cm4gemxpYkJ1ZmZlcihuZXcgSW5mbGF0ZVJhdyhvcHRzKSwgYnVmZmVyLCBjYWxsYmFjayk7Cgl9OwoKCWV4cG9ydHMuaW5mbGF0ZVJhd1N5bmMgPSBmdW5jdGlvbihidWZmZXIsIG9wdHMpIHsKCSAgcmV0dXJuIHpsaWJCdWZmZXJTeW5jKG5ldyBJbmZsYXRlUmF3KG9wdHMpLCBidWZmZXIpOwoJfTsKCglmdW5jdGlvbiB6bGliQnVmZmVyKGVuZ2luZSwgYnVmZmVyLCBjYWxsYmFjaykgewoJICB2YXIgYnVmZmVycyA9IFtdOwoJICB2YXIgbnJlYWQgPSAwOwoKCSAgZW5naW5lLm9uKCdlcnJvcicsIG9uRXJyb3IpOwoJICBlbmdpbmUub24oJ2VuZCcsIG9uRW5kKTsKCgkgIGVuZ2luZS5lbmQoYnVmZmVyKTsKCSAgZmxvdygpOwoKCSAgZnVuY3Rpb24gZmxvdygpIHsKCSAgICB2YXIgY2h1bms7CgkgICAgd2hpbGUgKG51bGwgIT09IChjaHVuayA9IGVuZ2luZS5yZWFkKCkpKSB7CgkgICAgICBidWZmZXJzLnB1c2goY2h1bmspOwoJICAgICAgbnJlYWQgKz0gY2h1bmsubGVuZ3RoOwoJICAgIH0KCSAgICBlbmdpbmUub25jZSgncmVhZGFibGUnLCBmbG93KTsKCSAgfQoKCSAgZnVuY3Rpb24gb25FcnJvcihlcnIpIHsKCSAgICBlbmdpbmUucmVtb3ZlTGlzdGVuZXIoJ2VuZCcsIG9uRW5kKTsKCSAgICBlbmdpbmUucmVtb3ZlTGlzdGVuZXIoJ3JlYWRhYmxlJywgZmxvdyk7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfQoKCSAgZnVuY3Rpb24gb25FbmQoKSB7CgkgICAgdmFyIGJ1ZiA9IEJ1ZmZlci5jb25jYXQoYnVmZmVycywgbnJlYWQpOwoJICAgIGJ1ZmZlcnMgPSBbXTsKCSAgICBjYWxsYmFjayhudWxsLCBidWYpOwoJICAgIGVuZ2luZS5jbG9zZSgpOwoJICB9Cgl9CgoJZnVuY3Rpb24gemxpYkJ1ZmZlclN5bmMoZW5naW5lLCBidWZmZXIpIHsKCSAgaWYgKHR5cGVvZiBidWZmZXIgPT09ICdzdHJpbmcnKQoJICAgIGJ1ZmZlciA9IG5ldyBCdWZmZXIoYnVmZmVyKTsKCSAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmZmVyKSkKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdOb3QgYSBzdHJpbmcgb3IgYnVmZmVyJyk7CgoJICB2YXIgZmx1c2hGbGFnID0gYmluZGluZy5aX0ZJTklTSDsKCgkgIHJldHVybiBlbmdpbmUuX3Byb2Nlc3NDaHVuayhidWZmZXIsIGZsdXNoRmxhZyk7Cgl9CgoJLy8gZ2VuZXJpYyB6bGliCgkvLyBtaW5pbWFsIDItYnl0ZSBoZWFkZXIKCWZ1bmN0aW9uIERlZmxhdGUob3B0cykgewoJICBpZiAoISh0aGlzIGluc3RhbmNlb2YgRGVmbGF0ZSkpIHJldHVybiBuZXcgRGVmbGF0ZShvcHRzKTsKCSAgWmxpYi5jYWxsKHRoaXMsIG9wdHMsIGJpbmRpbmcuREVGTEFURSk7Cgl9CgoJZnVuY3Rpb24gSW5mbGF0ZShvcHRzKSB7CgkgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBJbmZsYXRlKSkgcmV0dXJuIG5ldyBJbmZsYXRlKG9wdHMpOwoJICBabGliLmNhbGwodGhpcywgb3B0cywgYmluZGluZy5JTkZMQVRFKTsKCX0KCgoKCS8vIGd6aXAgLSBiaWdnZXIgaGVhZGVyLCBzYW1lIGRlZmxhdGUgY29tcHJlc3Npb24KCWZ1bmN0aW9uIEd6aXAob3B0cykgewoJICBpZiAoISh0aGlzIGluc3RhbmNlb2YgR3ppcCkpIHJldHVybiBuZXcgR3ppcChvcHRzKTsKCSAgWmxpYi5jYWxsKHRoaXMsIG9wdHMsIGJpbmRpbmcuR1pJUCk7Cgl9CgoJZnVuY3Rpb24gR3VuemlwKG9wdHMpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEd1bnppcCkpIHJldHVybiBuZXcgR3VuemlwKG9wdHMpOwoJICBabGliLmNhbGwodGhpcywgb3B0cywgYmluZGluZy5HVU5aSVApOwoJfQoKCgoJLy8gcmF3IC0gbm8gaGVhZGVyCglmdW5jdGlvbiBEZWZsYXRlUmF3KG9wdHMpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIERlZmxhdGVSYXcpKSByZXR1cm4gbmV3IERlZmxhdGVSYXcob3B0cyk7CgkgIFpsaWIuY2FsbCh0aGlzLCBvcHRzLCBiaW5kaW5nLkRFRkxBVEVSQVcpOwoJfQoKCWZ1bmN0aW9uIEluZmxhdGVSYXcob3B0cykgewoJICBpZiAoISh0aGlzIGluc3RhbmNlb2YgSW5mbGF0ZVJhdykpIHJldHVybiBuZXcgSW5mbGF0ZVJhdyhvcHRzKTsKCSAgWmxpYi5jYWxsKHRoaXMsIG9wdHMsIGJpbmRpbmcuSU5GTEFURVJBVyk7Cgl9CgoKCS8vIGF1dG8tZGV0ZWN0IGhlYWRlci4KCWZ1bmN0aW9uIFVuemlwKG9wdHMpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFVuemlwKSkgcmV0dXJuIG5ldyBVbnppcChvcHRzKTsKCSAgWmxpYi5jYWxsKHRoaXMsIG9wdHMsIGJpbmRpbmcuVU5aSVApOwoJfQoKCgkvLyB0aGUgWmxpYiBjbGFzcyB0aGV5IGFsbCBpbmhlcml0IGZyb20KCS8vIFRoaXMgdGhpbmcgbWFuYWdlcyB0aGUgcXVldWUgb2YgcmVxdWVzdHMsIGFuZCByZXR1cm5zCgkvLyB0cnVlIG9yIGZhbHNlIGlmIHRoZXJlIGlzIGFueXRoaW5nIGluIHRoZSBxdWV1ZSB3aGVuCgkvLyB5b3UgY2FsbCB0aGUgLndyaXRlKCkgbWV0aG9kLgoKCWZ1bmN0aW9uIFpsaWIob3B0cywgbW9kZSkgewoJICB0aGlzLl9vcHRzID0gb3B0cyA9IG9wdHMgfHwge307CgkgIHRoaXMuX2NodW5rU2l6ZSA9IG9wdHMuY2h1bmtTaXplIHx8IGV4cG9ydHMuWl9ERUZBVUxUX0NIVU5LOwoKCSAgVHJhbnNmb3JtLmNhbGwodGhpcywgb3B0cyk7CgoJICBpZiAob3B0cy5mbHVzaCkgewoJICAgIGlmIChvcHRzLmZsdXNoICE9PSBiaW5kaW5nLlpfTk9fRkxVU0ggJiYKCSAgICAgICAgb3B0cy5mbHVzaCAhPT0gYmluZGluZy5aX1BBUlRJQUxfRkxVU0ggJiYKCSAgICAgICAgb3B0cy5mbHVzaCAhPT0gYmluZGluZy5aX1NZTkNfRkxVU0ggJiYKCSAgICAgICAgb3B0cy5mbHVzaCAhPT0gYmluZGluZy5aX0ZVTExfRkxVU0ggJiYKCSAgICAgICAgb3B0cy5mbHVzaCAhPT0gYmluZGluZy5aX0ZJTklTSCAmJgoJICAgICAgICBvcHRzLmZsdXNoICE9PSBiaW5kaW5nLlpfQkxPQ0spIHsKCSAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBmbHVzaCBmbGFnOiAnICsgb3B0cy5mbHVzaCk7CgkgICAgfQoJICB9CgkgIHRoaXMuX2ZsdXNoRmxhZyA9IG9wdHMuZmx1c2ggfHwgYmluZGluZy5aX05PX0ZMVVNIOwoKCSAgaWYgKG9wdHMuY2h1bmtTaXplKSB7CgkgICAgaWYgKG9wdHMuY2h1bmtTaXplIDwgZXhwb3J0cy5aX01JTl9DSFVOSyB8fAoJICAgICAgICBvcHRzLmNodW5rU2l6ZSA+IGV4cG9ydHMuWl9NQVhfQ0hVTkspIHsKCSAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjaHVuayBzaXplOiAnICsgb3B0cy5jaHVua1NpemUpOwoJICAgIH0KCSAgfQoKCSAgaWYgKG9wdHMud2luZG93Qml0cykgewoJICAgIGlmIChvcHRzLndpbmRvd0JpdHMgPCBleHBvcnRzLlpfTUlOX1dJTkRPV0JJVFMgfHwKCSAgICAgICAgb3B0cy53aW5kb3dCaXRzID4gZXhwb3J0cy5aX01BWF9XSU5ET1dCSVRTKSB7CgkgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgd2luZG93Qml0czogJyArIG9wdHMud2luZG93Qml0cyk7CgkgICAgfQoJICB9CgoJICBpZiAob3B0cy5sZXZlbCkgewoJICAgIGlmIChvcHRzLmxldmVsIDwgZXhwb3J0cy5aX01JTl9MRVZFTCB8fAoJICAgICAgICBvcHRzLmxldmVsID4gZXhwb3J0cy5aX01BWF9MRVZFTCkgewoJICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNvbXByZXNzaW9uIGxldmVsOiAnICsgb3B0cy5sZXZlbCk7CgkgICAgfQoJICB9CgoJICBpZiAob3B0cy5tZW1MZXZlbCkgewoJICAgIGlmIChvcHRzLm1lbUxldmVsIDwgZXhwb3J0cy5aX01JTl9NRU1MRVZFTCB8fAoJICAgICAgICBvcHRzLm1lbUxldmVsID4gZXhwb3J0cy5aX01BWF9NRU1MRVZFTCkgewoJICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIG1lbUxldmVsOiAnICsgb3B0cy5tZW1MZXZlbCk7CgkgICAgfQoJICB9CgoJICBpZiAob3B0cy5zdHJhdGVneSkgewoJICAgIGlmIChvcHRzLnN0cmF0ZWd5ICE9IGV4cG9ydHMuWl9GSUxURVJFRCAmJgoJICAgICAgICBvcHRzLnN0cmF0ZWd5ICE9IGV4cG9ydHMuWl9IVUZGTUFOX09OTFkgJiYKCSAgICAgICAgb3B0cy5zdHJhdGVneSAhPSBleHBvcnRzLlpfUkxFICYmCgkgICAgICAgIG9wdHMuc3RyYXRlZ3kgIT0gZXhwb3J0cy5aX0ZJWEVEICYmCgkgICAgICAgIG9wdHMuc3RyYXRlZ3kgIT0gZXhwb3J0cy5aX0RFRkFVTFRfU1RSQVRFR1kpIHsKCSAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdHJhdGVneTogJyArIG9wdHMuc3RyYXRlZ3kpOwoJICAgIH0KCSAgfQoKCSAgaWYgKG9wdHMuZGljdGlvbmFyeSkgewoJICAgIGlmICghQnVmZmVyLmlzQnVmZmVyKG9wdHMuZGljdGlvbmFyeSkpIHsKCSAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBkaWN0aW9uYXJ5OiBpdCBzaG91bGQgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKTsKCSAgICB9CgkgIH0KCgkgIHRoaXMuX2JpbmRpbmcgPSBuZXcgYmluZGluZy5abGliKG1vZGUpOwoKCSAgdmFyIHNlbGYgPSB0aGlzOwoJICB0aGlzLl9oYWRFcnJvciA9IGZhbHNlOwoJICB0aGlzLl9iaW5kaW5nLm9uZXJyb3IgPSBmdW5jdGlvbihtZXNzYWdlLCBlcnJubykgewoJICAgIC8vIHRoZXJlIGlzIG5vIHdheSB0byBjbGVhbmx5IHJlY292ZXIuCgkgICAgLy8gY29udGludWluZyBvbmx5IG9ic2N1cmVzIHByb2JsZW1zLgoJICAgIHNlbGYuX2JpbmRpbmcgPSBudWxsOwoJICAgIHNlbGYuX2hhZEVycm9yID0gdHJ1ZTsKCgkgICAgdmFyIGVycm9yID0gbmV3IEVycm9yKG1lc3NhZ2UpOwoJICAgIGVycm9yLmVycm5vID0gZXJybm87CgkgICAgZXJyb3IuY29kZSA9IGV4cG9ydHMuY29kZXNbZXJybm9dOwoJICAgIHNlbGYuZW1pdCgnZXJyb3InLCBlcnJvcik7CgkgIH07CgoJICB2YXIgbGV2ZWwgPSBleHBvcnRzLlpfREVGQVVMVF9DT01QUkVTU0lPTjsKCSAgaWYgKHR5cGVvZiBvcHRzLmxldmVsID09PSAnbnVtYmVyJykgbGV2ZWwgPSBvcHRzLmxldmVsOwoKCSAgdmFyIHN0cmF0ZWd5ID0gZXhwb3J0cy5aX0RFRkFVTFRfU1RSQVRFR1k7CgkgIGlmICh0eXBlb2Ygb3B0cy5zdHJhdGVneSA9PT0gJ251bWJlcicpIHN0cmF0ZWd5ID0gb3B0cy5zdHJhdGVneTsKCgkgIHRoaXMuX2JpbmRpbmcuaW5pdChvcHRzLndpbmRvd0JpdHMgfHwgZXhwb3J0cy5aX0RFRkFVTFRfV0lORE9XQklUUywKCSAgICAgICAgICAgICAgICAgICAgIGxldmVsLAoJICAgICAgICAgICAgICAgICAgICAgb3B0cy5tZW1MZXZlbCB8fCBleHBvcnRzLlpfREVGQVVMVF9NRU1MRVZFTCwKCSAgICAgICAgICAgICAgICAgICAgIHN0cmF0ZWd5LAoJICAgICAgICAgICAgICAgICAgICAgb3B0cy5kaWN0aW9uYXJ5KTsKCgkgIHRoaXMuX2J1ZmZlciA9IG5ldyBCdWZmZXIodGhpcy5fY2h1bmtTaXplKTsKCSAgdGhpcy5fb2Zmc2V0ID0gMDsKCSAgdGhpcy5fY2xvc2VkID0gZmFsc2U7CgkgIHRoaXMuX2xldmVsID0gbGV2ZWw7CgkgIHRoaXMuX3N0cmF0ZWd5ID0gc3RyYXRlZ3k7CgoJICB0aGlzLm9uY2UoJ2VuZCcsIHRoaXMuY2xvc2UpOwoJfQoKCXV0aWwuaW5oZXJpdHMoWmxpYiwgVHJhbnNmb3JtKTsKCglabGliLnByb3RvdHlwZS5wYXJhbXMgPSBmdW5jdGlvbihsZXZlbCwgc3RyYXRlZ3ksIGNhbGxiYWNrKSB7CgkgIGlmIChsZXZlbCA8IGV4cG9ydHMuWl9NSU5fTEVWRUwgfHwKCSAgICAgIGxldmVsID4gZXhwb3J0cy5aX01BWF9MRVZFTCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIGNvbXByZXNzaW9uIGxldmVsOiAnICsgbGV2ZWwpOwoJICB9CgkgIGlmIChzdHJhdGVneSAhPSBleHBvcnRzLlpfRklMVEVSRUQgJiYKCSAgICAgIHN0cmF0ZWd5ICE9IGV4cG9ydHMuWl9IVUZGTUFOX09OTFkgJiYKCSAgICAgIHN0cmF0ZWd5ICE9IGV4cG9ydHMuWl9STEUgJiYKCSAgICAgIHN0cmF0ZWd5ICE9IGV4cG9ydHMuWl9GSVhFRCAmJgoJICAgICAgc3RyYXRlZ3kgIT0gZXhwb3J0cy5aX0RFRkFVTFRfU1RSQVRFR1kpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHN0cmF0ZWd5OiAnICsgc3RyYXRlZ3kpOwoJICB9CgoJICBpZiAodGhpcy5fbGV2ZWwgIT09IGxldmVsIHx8IHRoaXMuX3N0cmF0ZWd5ICE9PSBzdHJhdGVneSkgewoJICAgIHZhciBzZWxmID0gdGhpczsKCSAgICB0aGlzLmZsdXNoKGJpbmRpbmcuWl9TWU5DX0ZMVVNILCBmdW5jdGlvbigpIHsKCSAgICAgIHNlbGYuX2JpbmRpbmcucGFyYW1zKGxldmVsLCBzdHJhdGVneSk7CgkgICAgICBpZiAoIXNlbGYuX2hhZEVycm9yKSB7CgkgICAgICAgIHNlbGYuX2xldmVsID0gbGV2ZWw7CgkgICAgICAgIHNlbGYuX3N0cmF0ZWd5ID0gc3RyYXRlZ3k7CgkgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTsKCSAgICAgIH0KCSAgICB9KTsKCSAgfSBlbHNlIHsKCSAgICBwcm9jZXNzLm5leHRUaWNrKGNhbGxiYWNrKTsKCSAgfQoJfTsKCglabGliLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKCkgewoJICByZXR1cm4gdGhpcy5fYmluZGluZy5yZXNldCgpOwoJfTsKCgkvLyBUaGlzIGlzIHRoZSBfZmx1c2ggZnVuY3Rpb24gY2FsbGVkIGJ5IHRoZSB0cmFuc2Zvcm0gY2xhc3MsCgkvLyBpbnRlcm5hbGx5LCB3aGVuIHRoZSBsYXN0IGNodW5rIGhhcyBiZWVuIHdyaXR0ZW4uCglabGliLnByb3RvdHlwZS5fZmx1c2ggPSBmdW5jdGlvbihjYWxsYmFjaykgewoJICB0aGlzLl90cmFuc2Zvcm0obmV3IEJ1ZmZlcigwKSwgJycsIGNhbGxiYWNrKTsKCX07CgoJWmxpYi5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbihraW5kLCBjYWxsYmFjaykgewoJICB2YXIgd3MgPSB0aGlzLl93cml0YWJsZVN0YXRlOwoKCSAgaWYgKHR5cGVvZiBraW5kID09PSAnZnVuY3Rpb24nIHx8IChraW5kID09PSB2b2lkIDAgJiYgIWNhbGxiYWNrKSkgewoJICAgIGNhbGxiYWNrID0ga2luZDsKCSAgICBraW5kID0gYmluZGluZy5aX0ZVTExfRkxVU0g7CgkgIH0KCgkgIGlmICh3cy5lbmRlZCkgewoJICAgIGlmIChjYWxsYmFjaykKCSAgICAgIHByb2Nlc3MubmV4dFRpY2soY2FsbGJhY2spOwoJICB9IGVsc2UgaWYgKHdzLmVuZGluZykgewoJICAgIGlmIChjYWxsYmFjaykKCSAgICAgIHRoaXMub25jZSgnZW5kJywgY2FsbGJhY2spOwoJICB9IGVsc2UgaWYgKHdzLm5lZWREcmFpbikgewoJICAgIHZhciBzZWxmID0gdGhpczsKCSAgICB0aGlzLm9uY2UoJ2RyYWluJywgZnVuY3Rpb24oKSB7CgkgICAgICBzZWxmLmZsdXNoKGNhbGxiYWNrKTsKCSAgICB9KTsKCSAgfSBlbHNlIHsKCSAgICB0aGlzLl9mbHVzaEZsYWcgPSBraW5kOwoJICAgIHRoaXMud3JpdGUobmV3IEJ1ZmZlcigwKSwgJycsIGNhbGxiYWNrKTsKCSAgfQoJfTsKCglabGliLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7CgkgIGlmIChjYWxsYmFjaykKCSAgICBwcm9jZXNzLm5leHRUaWNrKGNhbGxiYWNrKTsKCgkgIGlmICh0aGlzLl9jbG9zZWQpCgkgICAgcmV0dXJuOwoKCSAgdGhpcy5fY2xvc2VkID0gdHJ1ZTsKCgkgIHRoaXMuX2JpbmRpbmcuY2xvc2UoKTsKCgkgIHZhciBzZWxmID0gdGhpczsKCSAgcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbigpIHsKCSAgICBzZWxmLmVtaXQoJ2Nsb3NlJyk7CgkgIH0pOwoJfTsKCglabGliLnByb3RvdHlwZS5fdHJhbnNmb3JtID0gZnVuY3Rpb24oY2h1bmssIGVuY29kaW5nLCBjYikgewoJICB2YXIgZmx1c2hGbGFnOwoJICB2YXIgd3MgPSB0aGlzLl93cml0YWJsZVN0YXRlOwoJICB2YXIgZW5kaW5nID0gd3MuZW5kaW5nIHx8IHdzLmVuZGVkOwoJICB2YXIgbGFzdCA9IGVuZGluZyAmJiAoIWNodW5rIHx8IHdzLmxlbmd0aCA9PT0gY2h1bmsubGVuZ3RoKTsKCgkgIGlmICghY2h1bmsgPT09IG51bGwgJiYgIUJ1ZmZlci5pc0J1ZmZlcihjaHVuaykpCgkgICAgcmV0dXJuIGNiKG5ldyBFcnJvcignaW52YWxpZCBpbnB1dCcpKTsKCgkgIC8vIElmIGl0J3MgdGhlIGxhc3QgY2h1bmssIG9yIGEgZmluYWwgZmx1c2gsIHdlIHVzZSB0aGUgWl9GSU5JU0ggZmx1c2ggZmxhZy4KCSAgLy8gSWYgaXQncyBleHBsaWNpdGx5IGZsdXNoaW5nIGF0IHNvbWUgb3RoZXIgdGltZSwgdGhlbiB3ZSB1c2UKCSAgLy8gWl9GVUxMX0ZMVVNILiBPdGhlcndpc2UsIHVzZSBaX05PX0ZMVVNIIGZvciBtYXhpbXVtIGNvbXByZXNzaW9uCgkgIC8vIGdvb2RuZXNzLgoJICBpZiAobGFzdCkKCSAgICBmbHVzaEZsYWcgPSBiaW5kaW5nLlpfRklOSVNIOwoJICBlbHNlIHsKCSAgICBmbHVzaEZsYWcgPSB0aGlzLl9mbHVzaEZsYWc7CgkgICAgLy8gb25jZSB3ZSd2ZSBmbHVzaGVkIHRoZSBsYXN0IG9mIHRoZSBxdWV1ZSwgc3RvcCBmbHVzaGluZyBhbmQKCSAgICAvLyBnbyBiYWNrIHRvIHRoZSBub3JtYWwgYmVoYXZpb3IuCgkgICAgaWYgKGNodW5rLmxlbmd0aCA+PSB3cy5sZW5ndGgpIHsKCSAgICAgIHRoaXMuX2ZsdXNoRmxhZyA9IHRoaXMuX29wdHMuZmx1c2ggfHwgYmluZGluZy5aX05PX0ZMVVNIOwoJICAgIH0KCSAgfQoKCSAgdmFyIHNlbGYgPSB0aGlzOwoJICB0aGlzLl9wcm9jZXNzQ2h1bmsoY2h1bmssIGZsdXNoRmxhZywgY2IpOwoJfTsKCglabGliLnByb3RvdHlwZS5fcHJvY2Vzc0NodW5rID0gZnVuY3Rpb24oY2h1bmssIGZsdXNoRmxhZywgY2IpIHsKCSAgdmFyIGF2YWlsSW5CZWZvcmUgPSBjaHVuayAmJiBjaHVuay5sZW5ndGg7CgkgIHZhciBhdmFpbE91dEJlZm9yZSA9IHRoaXMuX2NodW5rU2l6ZSAtIHRoaXMuX29mZnNldDsKCSAgdmFyIGluT2ZmID0gMDsKCgkgIHZhciBzZWxmID0gdGhpczsKCgkgIHZhciBhc3luYyA9IHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJzsKCgkgIGlmICghYXN5bmMpIHsKCSAgICB2YXIgYnVmZmVycyA9IFtdOwoJICAgIHZhciBucmVhZCA9IDA7CgoJICAgIHZhciBlcnJvcjsKCSAgICB0aGlzLm9uKCdlcnJvcicsIGZ1bmN0aW9uKGVyKSB7CgkgICAgICBlcnJvciA9IGVyOwoJICAgIH0pOwoKCSAgICBkbyB7CgkgICAgICB2YXIgcmVzID0gdGhpcy5fYmluZGluZy53cml0ZVN5bmMoZmx1c2hGbGFnLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rLCAvLyBpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluT2ZmLCAvLyBpbl9vZmYKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdmFpbEluQmVmb3JlLCAvLyBpbl9sZW4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9idWZmZXIsIC8vIG91dAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29mZnNldCwgLy9vdXRfb2ZmCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZhaWxPdXRCZWZvcmUpOyAvLyBvdXRfbGVuCgkgICAgfSB3aGlsZSAoIXRoaXMuX2hhZEVycm9yICYmIGNhbGxiYWNrKHJlc1swXSwgcmVzWzFdKSk7CgoJICAgIGlmICh0aGlzLl9oYWRFcnJvcikgewoJICAgICAgdGhyb3cgZXJyb3I7CgkgICAgfQoKCSAgICB2YXIgYnVmID0gQnVmZmVyLmNvbmNhdChidWZmZXJzLCBucmVhZCk7CgkgICAgdGhpcy5jbG9zZSgpOwoKCSAgICByZXR1cm4gYnVmOwoJICB9CgoJICB2YXIgcmVxID0gdGhpcy5fYmluZGluZy53cml0ZShmbHVzaEZsYWcsCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rLCAvLyBpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbk9mZiwgLy8gaW5fb2ZmCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2YWlsSW5CZWZvcmUsIC8vIGluX2xlbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9idWZmZXIsIC8vIG91dAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vZmZzZXQsIC8vb3V0X29mZgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdmFpbE91dEJlZm9yZSk7IC8vIG91dF9sZW4KCgkgIHJlcS5idWZmZXIgPSBjaHVuazsKCSAgcmVxLmNhbGxiYWNrID0gY2FsbGJhY2s7CgoJICBmdW5jdGlvbiBjYWxsYmFjayhhdmFpbEluQWZ0ZXIsIGF2YWlsT3V0QWZ0ZXIpIHsKCSAgICBpZiAoc2VsZi5faGFkRXJyb3IpCgkgICAgICByZXR1cm47CgoJICAgIHZhciBoYXZlID0gYXZhaWxPdXRCZWZvcmUgLSBhdmFpbE91dEFmdGVyOwoJICAgIGFzc2VydChoYXZlID49IDAsICdoYXZlIHNob3VsZCBub3QgZ28gZG93bicpOwoKCSAgICBpZiAoaGF2ZSA+IDApIHsKCSAgICAgIHZhciBvdXQgPSBzZWxmLl9idWZmZXIuc2xpY2Uoc2VsZi5fb2Zmc2V0LCBzZWxmLl9vZmZzZXQgKyBoYXZlKTsKCSAgICAgIHNlbGYuX29mZnNldCArPSBoYXZlOwoJICAgICAgLy8gc2VydmUgc29tZSBvdXRwdXQgdG8gdGhlIGNvbnN1bWVyLgoJICAgICAgaWYgKGFzeW5jKSB7CgkgICAgICAgIHNlbGYucHVzaChvdXQpOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgYnVmZmVycy5wdXNoKG91dCk7CgkgICAgICAgIG5yZWFkICs9IG91dC5sZW5ndGg7CgkgICAgICB9CgkgICAgfQoKCSAgICAvLyBleGhhdXN0ZWQgdGhlIG91dHB1dCBidWZmZXIsIG9yIHVzZWQgYWxsIHRoZSBpbnB1dCBjcmVhdGUgYSBuZXcgb25lLgoJICAgIGlmIChhdmFpbE91dEFmdGVyID09PSAwIHx8IHNlbGYuX29mZnNldCA+PSBzZWxmLl9jaHVua1NpemUpIHsKCSAgICAgIGF2YWlsT3V0QmVmb3JlID0gc2VsZi5fY2h1bmtTaXplOwoJICAgICAgc2VsZi5fb2Zmc2V0ID0gMDsKCSAgICAgIHNlbGYuX2J1ZmZlciA9IG5ldyBCdWZmZXIoc2VsZi5fY2h1bmtTaXplKTsKCSAgICB9CgoJICAgIGlmIChhdmFpbE91dEFmdGVyID09PSAwKSB7CgkgICAgICAvLyBOb3QgYWN0dWFsbHkgZG9uZS4gIE5lZWQgdG8gcmVwcm9jZXNzLgoJICAgICAgLy8gQWxzbywgdXBkYXRlIHRoZSBhdmFpbEluQmVmb3JlIHRvIHRoZSBhdmFpbEluQWZ0ZXIgdmFsdWUsCgkgICAgICAvLyBzbyB0aGF0IGlmIHdlIGhhdmUgdG8gaGl0IGl0IGEgdGhpcmQgKGZvdXJ0aCwgZXRjLikgdGltZSwKCSAgICAgIC8vIGl0J2xsIGhhdmUgdGhlIGNvcnJlY3QgYnl0ZSBjb3VudHMuCgkgICAgICBpbk9mZiArPSAoYXZhaWxJbkJlZm9yZSAtIGF2YWlsSW5BZnRlcik7CgkgICAgICBhdmFpbEluQmVmb3JlID0gYXZhaWxJbkFmdGVyOwoKCSAgICAgIGlmICghYXN5bmMpCgkgICAgICAgIHJldHVybiB0cnVlOwoKCSAgICAgIHZhciBuZXdSZXEgPSBzZWxmLl9iaW5kaW5nLndyaXRlKGZsdXNoRmxhZywKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5PZmYsCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdmFpbEluQmVmb3JlLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fYnVmZmVyLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fb2Zmc2V0LAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fY2h1bmtTaXplKTsKCSAgICAgIG5ld1JlcS5jYWxsYmFjayA9IGNhbGxiYWNrOyAvLyB0aGlzIHNhbWUgZnVuY3Rpb24KCSAgICAgIG5ld1JlcS5idWZmZXIgPSBjaHVuazsKCSAgICAgIHJldHVybjsKCSAgICB9CgoJICAgIGlmICghYXN5bmMpCgkgICAgICByZXR1cm4gZmFsc2U7CgoJICAgIC8vIGZpbmlzaGVkIHdpdGggdGhlIGNodW5rLgoJICAgIGNiKCk7CgkgIH0KCX07CgoJdXRpbC5pbmhlcml0cyhEZWZsYXRlLCBabGliKTsKCXV0aWwuaW5oZXJpdHMoSW5mbGF0ZSwgWmxpYik7Cgl1dGlsLmluaGVyaXRzKEd6aXAsIFpsaWIpOwoJdXRpbC5pbmhlcml0cyhHdW56aXAsIFpsaWIpOwoJdXRpbC5pbmhlcml0cyhEZWZsYXRlUmF3LCBabGliKTsKCXV0aWwuaW5oZXJpdHMoSW5mbGF0ZVJhdywgWmxpYik7Cgl1dGlsLmluaGVyaXRzKFVuemlwLCBabGliKTsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5CdWZmZXIsIF9fd2VicGFja19yZXF1aXJlX18oMTYpKSkKCi8qKiovIH0sCi8qIDgwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihwcm9jZXNzLCBCdWZmZXIpIHt2YXIgbXNnID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4MSk7Cgl2YXIgenN0cmVhbSA9IF9fd2VicGFja19yZXF1aXJlX18oODIpOwoJdmFyIHpsaWJfZGVmbGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oODMpOwoJdmFyIHpsaWJfaW5mbGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oODgpOwoJdmFyIGNvbnN0YW50cyA9IF9fd2VicGFja19yZXF1aXJlX18oOTEpOwoKCWZvciAodmFyIGtleSBpbiBjb25zdGFudHMpIHsKCSAgZXhwb3J0c1trZXldID0gY29uc3RhbnRzW2tleV07Cgl9CgoJLy8gemxpYiBtb2RlcwoJZXhwb3J0cy5OT05FID0gMDsKCWV4cG9ydHMuREVGTEFURSA9IDE7CglleHBvcnRzLklORkxBVEUgPSAyOwoJZXhwb3J0cy5HWklQID0gMzsKCWV4cG9ydHMuR1VOWklQID0gNDsKCWV4cG9ydHMuREVGTEFURVJBVyA9IDU7CglleHBvcnRzLklORkxBVEVSQVcgPSA2OwoJZXhwb3J0cy5VTlpJUCA9IDc7CgoJLyoqCgkgKiBFbXVsYXRlIE5vZGUncyB6bGliIEMrKyBsYXllciBmb3IgdXNlIGJ5IHRoZSBKUyBsYXllciBpbiBpbmRleC5qcwoJICovCglmdW5jdGlvbiBabGliKG1vZGUpIHsKCSAgaWYgKG1vZGUgPCBleHBvcnRzLkRFRkxBVEUgfHwgbW9kZSA+IGV4cG9ydHMuVU5aSVApCgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQmFkIGFyZ3VtZW50Iik7CgkgICAgCgkgIHRoaXMubW9kZSA9IG1vZGU7CgkgIHRoaXMuaW5pdF9kb25lID0gZmFsc2U7CgkgIHRoaXMud3JpdGVfaW5fcHJvZ3Jlc3MgPSBmYWxzZTsKCSAgdGhpcy5wZW5kaW5nX2Nsb3NlID0gZmFsc2U7CgkgIHRoaXMud2luZG93Qml0cyA9IDA7CgkgIHRoaXMubGV2ZWwgPSAwOwoJICB0aGlzLm1lbUxldmVsID0gMDsKCSAgdGhpcy5zdHJhdGVneSA9IDA7CgkgIHRoaXMuZGljdGlvbmFyeSA9IG51bGw7Cgl9CgoJWmxpYi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKHdpbmRvd0JpdHMsIGxldmVsLCBtZW1MZXZlbCwgc3RyYXRlZ3ksIGRpY3Rpb25hcnkpIHsKCSAgdGhpcy53aW5kb3dCaXRzID0gd2luZG93Qml0czsKCSAgdGhpcy5sZXZlbCA9IGxldmVsOwoJICB0aGlzLm1lbUxldmVsID0gbWVtTGV2ZWw7CgkgIHRoaXMuc3RyYXRlZ3kgPSBzdHJhdGVneTsKCSAgLy8gZGljdGlvbmFyeSBub3Qgc3VwcG9ydGVkLgoJICAKCSAgaWYgKHRoaXMubW9kZSA9PT0gZXhwb3J0cy5HWklQIHx8IHRoaXMubW9kZSA9PT0gZXhwb3J0cy5HVU5aSVApCgkgICAgdGhpcy53aW5kb3dCaXRzICs9IDE2OwoJICAgIAoJICBpZiAodGhpcy5tb2RlID09PSBleHBvcnRzLlVOWklQKQoJICAgIHRoaXMud2luZG93Qml0cyArPSAzMjsKCSAgICAKCSAgaWYgKHRoaXMubW9kZSA9PT0gZXhwb3J0cy5ERUZMQVRFUkFXIHx8IHRoaXMubW9kZSA9PT0gZXhwb3J0cy5JTkZMQVRFUkFXKQoJICAgIHRoaXMud2luZG93Qml0cyA9IC10aGlzLndpbmRvd0JpdHM7CgkgICAgCgkgIHRoaXMuc3RybSA9IG5ldyB6c3RyZWFtKCk7CgkgIAoJICBzd2l0Y2ggKHRoaXMubW9kZSkgewoJICAgIGNhc2UgZXhwb3J0cy5ERUZMQVRFOgoJICAgIGNhc2UgZXhwb3J0cy5HWklQOgoJICAgIGNhc2UgZXhwb3J0cy5ERUZMQVRFUkFXOgoJICAgICAgdmFyIHN0YXR1cyA9IHpsaWJfZGVmbGF0ZS5kZWZsYXRlSW5pdDIoCgkgICAgICAgIHRoaXMuc3RybSwKCSAgICAgICAgdGhpcy5sZXZlbCwKCSAgICAgICAgZXhwb3J0cy5aX0RFRkxBVEVELAoJICAgICAgICB0aGlzLndpbmRvd0JpdHMsCgkgICAgICAgIHRoaXMubWVtTGV2ZWwsCgkgICAgICAgIHRoaXMuc3RyYXRlZ3kKCSAgICAgICk7CgkgICAgICBicmVhazsKCSAgICBjYXNlIGV4cG9ydHMuSU5GTEFURToKCSAgICBjYXNlIGV4cG9ydHMuR1VOWklQOgoJICAgIGNhc2UgZXhwb3J0cy5JTkZMQVRFUkFXOgoJICAgIGNhc2UgZXhwb3J0cy5VTlpJUDoKCSAgICAgIHZhciBzdGF0dXMgID0gemxpYl9pbmZsYXRlLmluZmxhdGVJbml0MigKCSAgICAgICAgdGhpcy5zdHJtLAoJICAgICAgICB0aGlzLndpbmRvd0JpdHMKCSAgICAgICk7CgkgICAgICBicmVhazsKCSAgICBkZWZhdWx0OgoJICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmtub3duIG1vZGUgIiArIHRoaXMubW9kZSk7CgkgIH0KCSAgCgkgIGlmIChzdGF0dXMgIT09IGV4cG9ydHMuWl9PSykgewoJICAgIHRoaXMuX2Vycm9yKHN0YXR1cyk7CgkgICAgcmV0dXJuOwoJICB9CgkgIAoJICB0aGlzLndyaXRlX2luX3Byb2dyZXNzID0gZmFsc2U7CgkgIHRoaXMuaW5pdF9kb25lID0gdHJ1ZTsKCX07CgoJWmxpYi5wcm90b3R5cGUucGFyYW1zID0gZnVuY3Rpb24oKSB7CgkgIHRocm93IG5ldyBFcnJvcigiZGVmbGF0ZVBhcmFtcyBOb3Qgc3VwcG9ydGVkIik7Cgl9OwoKCVpsaWIucHJvdG90eXBlLl93cml0ZUNoZWNrID0gZnVuY3Rpb24oKSB7CgkgIGlmICghdGhpcy5pbml0X2RvbmUpCgkgICAgdGhyb3cgbmV3IEVycm9yKCJ3cml0ZSBiZWZvcmUgaW5pdCIpOwoJICAgIAoJICBpZiAodGhpcy5tb2RlID09PSBleHBvcnRzLk5PTkUpCgkgICAgdGhyb3cgbmV3IEVycm9yKCJhbHJlYWR5IGZpbmFsaXplZCIpOwoJICAgIAoJICBpZiAodGhpcy53cml0ZV9pbl9wcm9ncmVzcykKCSAgICB0aHJvdyBuZXcgRXJyb3IoIndyaXRlIGFscmVhZHkgaW4gcHJvZ3Jlc3MiKTsKCSAgICAKCSAgaWYgKHRoaXMucGVuZGluZ19jbG9zZSkKCSAgICB0aHJvdyBuZXcgRXJyb3IoImNsb3NlIGlzIHBlbmRpbmciKTsKCX07CgoJWmxpYi5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbihmbHVzaCwgaW5wdXQsIGluX29mZiwgaW5fbGVuLCBvdXQsIG91dF9vZmYsIG91dF9sZW4pIHsgICAgCgkgIHRoaXMuX3dyaXRlQ2hlY2soKTsKCSAgdGhpcy53cml0ZV9pbl9wcm9ncmVzcyA9IHRydWU7CgkgIAoJICB2YXIgc2VsZiA9IHRoaXM7CgkgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24oKSB7CgkgICAgc2VsZi53cml0ZV9pbl9wcm9ncmVzcyA9IGZhbHNlOwoJICAgIHZhciByZXMgPSBzZWxmLl93cml0ZShmbHVzaCwgaW5wdXQsIGluX29mZiwgaW5fbGVuLCBvdXQsIG91dF9vZmYsIG91dF9sZW4pOwoJICAgIHNlbGYuY2FsbGJhY2socmVzWzBdLCByZXNbMV0pOwoJICAgIAoJICAgIGlmIChzZWxmLnBlbmRpbmdfY2xvc2UpCgkgICAgICBzZWxmLmNsb3NlKCk7CgkgIH0pOwoJICAKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCS8vIHNldCBtZXRob2QgZm9yIE5vZGUgYnVmZmVycywgdXNlZCBieSBwYWtvCglmdW5jdGlvbiBidWZmZXJTZXQoZGF0YSwgb2Zmc2V0KSB7CgkgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgewoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSBkYXRhW2ldOwoJICB9Cgl9CgoJWmxpYi5wcm90b3R5cGUud3JpdGVTeW5jID0gZnVuY3Rpb24oZmx1c2gsIGlucHV0LCBpbl9vZmYsIGluX2xlbiwgb3V0LCBvdXRfb2ZmLCBvdXRfbGVuKSB7CgkgIHRoaXMuX3dyaXRlQ2hlY2soKTsKCSAgcmV0dXJuIHRoaXMuX3dyaXRlKGZsdXNoLCBpbnB1dCwgaW5fb2ZmLCBpbl9sZW4sIG91dCwgb3V0X29mZiwgb3V0X2xlbik7Cgl9OwoKCVpsaWIucHJvdG90eXBlLl93cml0ZSA9IGZ1bmN0aW9uKGZsdXNoLCBpbnB1dCwgaW5fb2ZmLCBpbl9sZW4sIG91dCwgb3V0X29mZiwgb3V0X2xlbikgewoJICB0aGlzLndyaXRlX2luX3Byb2dyZXNzID0gdHJ1ZTsKCSAgCgkgIGlmIChmbHVzaCAhPT0gZXhwb3J0cy5aX05PX0ZMVVNIICYmCgkgICAgICBmbHVzaCAhPT0gZXhwb3J0cy5aX1BBUlRJQUxfRkxVU0ggJiYKCSAgICAgIGZsdXNoICE9PSBleHBvcnRzLlpfU1lOQ19GTFVTSCAmJgoJICAgICAgZmx1c2ggIT09IGV4cG9ydHMuWl9GVUxMX0ZMVVNIICYmCgkgICAgICBmbHVzaCAhPT0gZXhwb3J0cy5aX0ZJTklTSCAmJgoJICAgICAgZmx1c2ggIT09IGV4cG9ydHMuWl9CTE9DSykgewoJICAgIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBmbHVzaCB2YWx1ZSIpOwoJICB9CgkgIAoJICBpZiAoaW5wdXQgPT0gbnVsbCkgewoJICAgIGlucHV0ID0gbmV3IEJ1ZmZlcigwKTsKCSAgICBpbl9sZW4gPSAwOwoJICAgIGluX29mZiA9IDA7CgkgIH0KCSAgCgkgIGlmIChvdXQuX3NldCkKCSAgICBvdXQuc2V0ID0gb3V0Ll9zZXQ7CgkgIGVsc2UKCSAgICBvdXQuc2V0ID0gYnVmZmVyU2V0OwoJICAKCSAgdmFyIHN0cm0gPSB0aGlzLnN0cm07CgkgIHN0cm0uYXZhaWxfaW4gPSBpbl9sZW47CgkgIHN0cm0uaW5wdXQgPSBpbnB1dDsKCSAgc3RybS5uZXh0X2luID0gaW5fb2ZmOwoJICBzdHJtLmF2YWlsX291dCA9IG91dF9sZW47CgkgIHN0cm0ub3V0cHV0ID0gb3V0OwoJICBzdHJtLm5leHRfb3V0ID0gb3V0X29mZjsKCSAgCgkgIHN3aXRjaCAodGhpcy5tb2RlKSB7CgkgICAgY2FzZSBleHBvcnRzLkRFRkxBVEU6CgkgICAgY2FzZSBleHBvcnRzLkdaSVA6CgkgICAgY2FzZSBleHBvcnRzLkRFRkxBVEVSQVc6CgkgICAgICB2YXIgc3RhdHVzID0gemxpYl9kZWZsYXRlLmRlZmxhdGUoc3RybSwgZmx1c2gpOwoJICAgICAgYnJlYWs7CgkgICAgY2FzZSBleHBvcnRzLlVOWklQOgoJICAgIGNhc2UgZXhwb3J0cy5JTkZMQVRFOgoJICAgIGNhc2UgZXhwb3J0cy5HVU5aSVA6CgkgICAgY2FzZSBleHBvcnRzLklORkxBVEVSQVc6CgkgICAgICB2YXIgc3RhdHVzID0gemxpYl9pbmZsYXRlLmluZmxhdGUoc3RybSwgZmx1c2gpOwoJICAgICAgYnJlYWs7CgkgICAgZGVmYXVsdDoKCSAgICAgIHRocm93IG5ldyBFcnJvcigiVW5rbm93biBtb2RlICIgKyB0aGlzLm1vZGUpOwoJICB9CgkgIAoJICBpZiAoc3RhdHVzICE9PSBleHBvcnRzLlpfU1RSRUFNX0VORCAmJiBzdGF0dXMgIT09IGV4cG9ydHMuWl9PSykgewoJICAgIHRoaXMuX2Vycm9yKHN0YXR1cyk7CgkgIH0KCSAgCgkgIHRoaXMud3JpdGVfaW5fcHJvZ3Jlc3MgPSBmYWxzZTsKCSAgcmV0dXJuIFtzdHJtLmF2YWlsX2luLCBzdHJtLmF2YWlsX291dF07Cgl9OwoKCVpsaWIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oKSB7CgkgIGlmICh0aGlzLndyaXRlX2luX3Byb2dyZXNzKSB7CgkgICAgdGhpcy5wZW5kaW5nX2Nsb3NlID0gdHJ1ZTsKCSAgICByZXR1cm47CgkgIH0KCSAgCgkgIHRoaXMucGVuZGluZ19jbG9zZSA9IGZhbHNlOwoJICAKCSAgaWYgKHRoaXMubW9kZSA9PT0gZXhwb3J0cy5ERUZMQVRFIHx8IHRoaXMubW9kZSA9PT0gZXhwb3J0cy5HWklQIHx8IHRoaXMubW9kZSA9PT0gZXhwb3J0cy5ERUZMQVRFUkFXKSB7CgkgICAgemxpYl9kZWZsYXRlLmRlZmxhdGVFbmQodGhpcy5zdHJtKTsKCSAgfSBlbHNlIHsKCSAgICB6bGliX2luZmxhdGUuaW5mbGF0ZUVuZCh0aGlzLnN0cm0pOwoJICB9CgkgIAoJICB0aGlzLm1vZGUgPSBleHBvcnRzLk5PTkU7Cgl9OwoKCVpsaWIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7CgkgIHN3aXRjaCAodGhpcy5tb2RlKSB7CgkgICAgY2FzZSBleHBvcnRzLkRFRkxBVEU6CgkgICAgY2FzZSBleHBvcnRzLkRFRkxBVEVSQVc6CgkgICAgICB2YXIgc3RhdHVzID0gemxpYl9kZWZsYXRlLmRlZmxhdGVSZXNldCh0aGlzLnN0cm0pOwoJICAgICAgYnJlYWs7CgkgICAgY2FzZSBleHBvcnRzLklORkxBVEU6CgkgICAgY2FzZSBleHBvcnRzLklORkxBVEVSQVc6CgkgICAgICB2YXIgc3RhdHVzID0gemxpYl9pbmZsYXRlLmluZmxhdGVSZXNldCh0aGlzLnN0cm0pOwoJICAgICAgYnJlYWs7CgkgIH0KCSAgCgkgIGlmIChzdGF0dXMgIT09IGV4cG9ydHMuWl9PSykgewoJICAgIHRoaXMuX2Vycm9yKHN0YXR1cyk7CgkgIH0KCX07CgoJWmxpYi5wcm90b3R5cGUuX2Vycm9yID0gZnVuY3Rpb24oc3RhdHVzKSB7CgkgIHRoaXMub25lcnJvcihtc2dbc3RhdHVzXSArICc6ICcgKyB0aGlzLnN0cm0ubXNnLCBzdGF0dXMpOwoJICAKCSAgdGhpcy53cml0ZV9pbl9wcm9ncmVzcyA9IGZhbHNlOwoJICBpZiAodGhpcy5wZW5kaW5nX2Nsb3NlKQoJICAgIHRoaXMuY2xvc2UoKTsKCX07CgoJZXhwb3J0cy5abGliID0gWmxpYjsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygxNiksIF9fd2VicGFja19yZXF1aXJlX18oNSkuQnVmZmVyKSkKCi8qKiovIH0sCi8qIDgxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JzsKCgltb2R1bGUuZXhwb3J0cyA9IHsKCSAgMjogICAgICAnbmVlZCBkaWN0aW9uYXJ5JywgICAgIC8qIFpfTkVFRF9ESUNUICAgICAgIDIgICovCgkgIDE6ICAgICAgJ3N0cmVhbSBlbmQnLCAgICAgICAgICAvKiBaX1NUUkVBTV9FTkQgICAgICAxICAqLwoJICAwOiAgICAgICcnLCAgICAgICAgICAgICAgICAgICAgLyogWl9PSyAgICAgICAgICAgICAgMCAgKi8KCSAgJy0xJzogICAnZmlsZSBlcnJvcicsICAgICAgICAgIC8qIFpfRVJSTk8gICAgICAgICAoLTEpICovCgkgICctMic6ICAgJ3N0cmVhbSBlcnJvcicsICAgICAgICAvKiBaX1NUUkVBTV9FUlJPUiAgKC0yKSAqLwoJICAnLTMnOiAgICdkYXRhIGVycm9yJywgICAgICAgICAgLyogWl9EQVRBX0VSUk9SICAgICgtMykgKi8KCSAgJy00JzogICAnaW5zdWZmaWNpZW50IG1lbW9yeScsIC8qIFpfTUVNX0VSUk9SICAgICAoLTQpICovCgkgICctNSc6ICAgJ2J1ZmZlciBlcnJvcicsICAgICAgICAvKiBaX0JVRl9FUlJPUiAgICAgKC01KSAqLwoJICAnLTYnOiAgICdpbmNvbXBhdGlibGUgdmVyc2lvbicgLyogWl9WRVJTSU9OX0VSUk9SICgtNikgKi8KCX07CgoKLyoqKi8gfSwKLyogODIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCglmdW5jdGlvbiBaU3RyZWFtKCkgewoJICAvKiBuZXh0IGlucHV0IGJ5dGUgKi8KCSAgdGhpcy5pbnB1dCA9IG51bGw7IC8vIEpTIHNwZWNpZmljLCBiZWNhdXNlIHdlIGhhdmUgbm8gcG9pbnRlcnMKCSAgdGhpcy5uZXh0X2luID0gMDsKCSAgLyogbnVtYmVyIG9mIGJ5dGVzIGF2YWlsYWJsZSBhdCBpbnB1dCAqLwoJICB0aGlzLmF2YWlsX2luID0gMDsKCSAgLyogdG90YWwgbnVtYmVyIG9mIGlucHV0IGJ5dGVzIHJlYWQgc28gZmFyICovCgkgIHRoaXMudG90YWxfaW4gPSAwOwoJICAvKiBuZXh0IG91dHB1dCBieXRlIHNob3VsZCBiZSBwdXQgdGhlcmUgKi8KCSAgdGhpcy5vdXRwdXQgPSBudWxsOyAvLyBKUyBzcGVjaWZpYywgYmVjYXVzZSB3ZSBoYXZlIG5vIHBvaW50ZXJzCgkgIHRoaXMubmV4dF9vdXQgPSAwOwoJICAvKiByZW1haW5pbmcgZnJlZSBzcGFjZSBhdCBvdXRwdXQgKi8KCSAgdGhpcy5hdmFpbF9vdXQgPSAwOwoJICAvKiB0b3RhbCBudW1iZXIgb2YgYnl0ZXMgb3V0cHV0IHNvIGZhciAqLwoJICB0aGlzLnRvdGFsX291dCA9IDA7CgkgIC8qIGxhc3QgZXJyb3IgbWVzc2FnZSwgTlVMTCBpZiBubyBlcnJvciAqLwoJICB0aGlzLm1zZyA9ICcnLypaX05VTEwqLzsKCSAgLyogbm90IHZpc2libGUgYnkgYXBwbGljYXRpb25zICovCgkgIHRoaXMuc3RhdGUgPSBudWxsOwoJICAvKiBiZXN0IGd1ZXNzIGFib3V0IHRoZSBkYXRhIHR5cGU6IGJpbmFyeSBvciB0ZXh0ICovCgkgIHRoaXMuZGF0YV90eXBlID0gMi8qWl9VTktOT1dOKi87CgkgIC8qIGFkbGVyMzIgdmFsdWUgb2YgdGhlIHVuY29tcHJlc3NlZCBkYXRhICovCgkgIHRoaXMuYWRsZXIgPSAwOwoJfQoKCW1vZHVsZS5leHBvcnRzID0gWlN0cmVhbTsKCgovKioqLyB9LAovKiA4MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJdmFyIHV0aWxzICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg0KTsKCXZhciB0cmVlcyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NSk7Cgl2YXIgYWRsZXIzMiA9IF9fd2VicGFja19yZXF1aXJlX18oODYpOwoJdmFyIGNyYzMyICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg3KTsKCXZhciBtc2cgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4MSk7CgoJLyogUHVibGljIGNvbnN0YW50cyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgoKCS8qIEFsbG93ZWQgZmx1c2ggdmFsdWVzOyBzZWUgZGVmbGF0ZSgpIGFuZCBpbmZsYXRlKCkgYmVsb3cgZm9yIGRldGFpbHMgKi8KCXZhciBaX05PX0ZMVVNIICAgICAgPSAwOwoJdmFyIFpfUEFSVElBTF9GTFVTSCA9IDE7CgkvL3ZhciBaX1NZTkNfRkxVU0ggICAgPSAyOwoJdmFyIFpfRlVMTF9GTFVTSCAgICA9IDM7Cgl2YXIgWl9GSU5JU0ggICAgICAgID0gNDsKCXZhciBaX0JMT0NLICAgICAgICAgPSA1OwoJLy92YXIgWl9UUkVFUyAgICAgICAgID0gNjsKCgoJLyogUmV0dXJuIGNvZGVzIGZvciB0aGUgY29tcHJlc3Npb24vZGVjb21wcmVzc2lvbiBmdW5jdGlvbnMuIE5lZ2F0aXZlIHZhbHVlcwoJICogYXJlIGVycm9ycywgcG9zaXRpdmUgdmFsdWVzIGFyZSB1c2VkIGZvciBzcGVjaWFsIGJ1dCBub3JtYWwgZXZlbnRzLgoJICovCgl2YXIgWl9PSyAgICAgICAgICAgID0gMDsKCXZhciBaX1NUUkVBTV9FTkQgICAgPSAxOwoJLy92YXIgWl9ORUVEX0RJQ1QgICAgID0gMjsKCS8vdmFyIFpfRVJSTk8gICAgICAgICA9IC0xOwoJdmFyIFpfU1RSRUFNX0VSUk9SICA9IC0yOwoJdmFyIFpfREFUQV9FUlJPUiAgICA9IC0zOwoJLy92YXIgWl9NRU1fRVJST1IgICAgID0gLTQ7Cgl2YXIgWl9CVUZfRVJST1IgICAgID0gLTU7CgkvL3ZhciBaX1ZFUlNJT05fRVJST1IgPSAtNjsKCgoJLyogY29tcHJlc3Npb24gbGV2ZWxzICovCgkvL3ZhciBaX05PX0NPTVBSRVNTSU9OICAgICAgPSAwOwoJLy92YXIgWl9CRVNUX1NQRUVEICAgICAgICAgID0gMTsKCS8vdmFyIFpfQkVTVF9DT01QUkVTU0lPTiAgICA9IDk7Cgl2YXIgWl9ERUZBVUxUX0NPTVBSRVNTSU9OID0gLTE7CgoKCXZhciBaX0ZJTFRFUkVEICAgICAgICAgICAgPSAxOwoJdmFyIFpfSFVGRk1BTl9PTkxZICAgICAgICA9IDI7Cgl2YXIgWl9STEUgICAgICAgICAgICAgICAgID0gMzsKCXZhciBaX0ZJWEVEICAgICAgICAgICAgICAgPSA0OwoJdmFyIFpfREVGQVVMVF9TVFJBVEVHWSAgICA9IDA7CgoJLyogUG9zc2libGUgdmFsdWVzIG9mIHRoZSBkYXRhX3R5cGUgZmllbGQgKHRob3VnaCBzZWUgaW5mbGF0ZSgpKSAqLwoJLy92YXIgWl9CSU5BUlkgICAgICAgICAgICAgID0gMDsKCS8vdmFyIFpfVEVYVCAgICAgICAgICAgICAgICA9IDE7CgkvL3ZhciBaX0FTQ0lJICAgICAgICAgICAgICAgPSAxOyAvLyA9IFpfVEVYVAoJdmFyIFpfVU5LTk9XTiAgICAgICAgICAgICA9IDI7CgoKCS8qIFRoZSBkZWZsYXRlIGNvbXByZXNzaW9uIG1ldGhvZCAqLwoJdmFyIFpfREVGTEFURUQgID0gODsKCgkvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwoKCgl2YXIgTUFYX01FTV9MRVZFTCA9IDk7CgkvKiBNYXhpbXVtIHZhbHVlIGZvciBtZW1MZXZlbCBpbiBkZWZsYXRlSW5pdDIgKi8KCXZhciBNQVhfV0JJVFMgPSAxNTsKCS8qIDMySyBMWjc3IHdpbmRvdyAqLwoJdmFyIERFRl9NRU1fTEVWRUwgPSA4OwoKCgl2YXIgTEVOR1RIX0NPREVTICA9IDI5OwoJLyogbnVtYmVyIG9mIGxlbmd0aCBjb2Rlcywgbm90IGNvdW50aW5nIHRoZSBzcGVjaWFsIEVORF9CTE9DSyBjb2RlICovCgl2YXIgTElURVJBTFMgICAgICA9IDI1NjsKCS8qIG51bWJlciBvZiBsaXRlcmFsIGJ5dGVzIDAuLjI1NSAqLwoJdmFyIExfQ09ERVMgICAgICAgPSBMSVRFUkFMUyArIDEgKyBMRU5HVEhfQ09ERVM7CgkvKiBudW1iZXIgb2YgTGl0ZXJhbCBvciBMZW5ndGggY29kZXMsIGluY2x1ZGluZyB0aGUgRU5EX0JMT0NLIGNvZGUgKi8KCXZhciBEX0NPREVTICAgICAgID0gMzA7CgkvKiBudW1iZXIgb2YgZGlzdGFuY2UgY29kZXMgKi8KCXZhciBCTF9DT0RFUyAgICAgID0gMTk7CgkvKiBudW1iZXIgb2YgY29kZXMgdXNlZCB0byB0cmFuc2ZlciB0aGUgYml0IGxlbmd0aHMgKi8KCXZhciBIRUFQX1NJWkUgICAgID0gMiAqIExfQ09ERVMgKyAxOwoJLyogbWF4aW11bSBoZWFwIHNpemUgKi8KCXZhciBNQVhfQklUUyAgPSAxNTsKCS8qIEFsbCBjb2RlcyBtdXN0IG5vdCBleGNlZWQgTUFYX0JJVFMgYml0cyAqLwoKCXZhciBNSU5fTUFUQ0ggPSAzOwoJdmFyIE1BWF9NQVRDSCA9IDI1ODsKCXZhciBNSU5fTE9PS0FIRUFEID0gKE1BWF9NQVRDSCArIE1JTl9NQVRDSCArIDEpOwoKCXZhciBQUkVTRVRfRElDVCA9IDB4MjA7CgoJdmFyIElOSVRfU1RBVEUgPSA0MjsKCXZhciBFWFRSQV9TVEFURSA9IDY5OwoJdmFyIE5BTUVfU1RBVEUgPSA3MzsKCXZhciBDT01NRU5UX1NUQVRFID0gOTE7Cgl2YXIgSENSQ19TVEFURSA9IDEwMzsKCXZhciBCVVNZX1NUQVRFID0gMTEzOwoJdmFyIEZJTklTSF9TVEFURSA9IDY2NjsKCgl2YXIgQlNfTkVFRF9NT1JFICAgICAgPSAxOyAvKiBibG9jayBub3QgY29tcGxldGVkLCBuZWVkIG1vcmUgaW5wdXQgb3IgbW9yZSBvdXRwdXQgKi8KCXZhciBCU19CTE9DS19ET05FICAgICA9IDI7IC8qIGJsb2NrIGZsdXNoIHBlcmZvcm1lZCAqLwoJdmFyIEJTX0ZJTklTSF9TVEFSVEVEID0gMzsgLyogZmluaXNoIHN0YXJ0ZWQsIG5lZWQgb25seSBtb3JlIG91dHB1dCBhdCBuZXh0IGRlZmxhdGUgKi8KCXZhciBCU19GSU5JU0hfRE9ORSAgICA9IDQ7IC8qIGZpbmlzaCBkb25lLCBhY2NlcHQgbm8gbW9yZSBpbnB1dCBvciBvdXRwdXQgKi8KCgl2YXIgT1NfQ09ERSA9IDB4MDM7IC8vIFVuaXggOikgLiBEb24ndCBkZXRlY3QsIHVzZSB0aGlzIGRlZmF1bHQuCgoJZnVuY3Rpb24gZXJyKHN0cm0sIGVycm9yQ29kZSkgewoJICBzdHJtLm1zZyA9IG1zZ1tlcnJvckNvZGVdOwoJICByZXR1cm4gZXJyb3JDb2RlOwoJfQoKCWZ1bmN0aW9uIHJhbmsoZikgewoJICByZXR1cm4gKChmKSA8PCAxKSAtICgoZikgPiA0ID8gOSA6IDApOwoJfQoKCWZ1bmN0aW9uIHplcm8oYnVmKSB7IHZhciBsZW4gPSBidWYubGVuZ3RoOyB3aGlsZSAoLS1sZW4gPj0gMCkgeyBidWZbbGVuXSA9IDA7IH0gfQoKCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBGbHVzaCBhcyBtdWNoIHBlbmRpbmcgb3V0cHV0IGFzIHBvc3NpYmxlLiBBbGwgZGVmbGF0ZSgpIG91dHB1dCBnb2VzCgkgKiB0aHJvdWdoIHRoaXMgZnVuY3Rpb24gc28gc29tZSBhcHBsaWNhdGlvbnMgbWF5IHdpc2ggdG8gbW9kaWZ5IGl0CgkgKiB0byBhdm9pZCBhbGxvY2F0aW5nIGEgbGFyZ2Ugc3RybS0+b3V0cHV0IGJ1ZmZlciBhbmQgY29weWluZyBpbnRvIGl0LgoJICogKFNlZSBhbHNvIHJlYWRfYnVmKCkpLgoJICovCglmdW5jdGlvbiBmbHVzaF9wZW5kaW5nKHN0cm0pIHsKCSAgdmFyIHMgPSBzdHJtLnN0YXRlOwoKCSAgLy9fdHJfZmx1c2hfYml0cyhzKTsKCSAgdmFyIGxlbiA9IHMucGVuZGluZzsKCSAgaWYgKGxlbiA+IHN0cm0uYXZhaWxfb3V0KSB7CgkgICAgbGVuID0gc3RybS5hdmFpbF9vdXQ7CgkgIH0KCSAgaWYgKGxlbiA9PT0gMCkgeyByZXR1cm47IH0KCgkgIHV0aWxzLmFycmF5U2V0KHN0cm0ub3V0cHV0LCBzLnBlbmRpbmdfYnVmLCBzLnBlbmRpbmdfb3V0LCBsZW4sIHN0cm0ubmV4dF9vdXQpOwoJICBzdHJtLm5leHRfb3V0ICs9IGxlbjsKCSAgcy5wZW5kaW5nX291dCArPSBsZW47CgkgIHN0cm0udG90YWxfb3V0ICs9IGxlbjsKCSAgc3RybS5hdmFpbF9vdXQgLT0gbGVuOwoJICBzLnBlbmRpbmcgLT0gbGVuOwoJICBpZiAocy5wZW5kaW5nID09PSAwKSB7CgkgICAgcy5wZW5kaW5nX291dCA9IDA7CgkgIH0KCX0KCgoJZnVuY3Rpb24gZmx1c2hfYmxvY2tfb25seShzLCBsYXN0KSB7CgkgIHRyZWVzLl90cl9mbHVzaF9ibG9jayhzLCAocy5ibG9ja19zdGFydCA+PSAwID8gcy5ibG9ja19zdGFydCA6IC0xKSwgcy5zdHJzdGFydCAtIHMuYmxvY2tfc3RhcnQsIGxhc3QpOwoJICBzLmJsb2NrX3N0YXJ0ID0gcy5zdHJzdGFydDsKCSAgZmx1c2hfcGVuZGluZyhzLnN0cm0pOwoJfQoKCglmdW5jdGlvbiBwdXRfYnl0ZShzLCBiKSB7CgkgIHMucGVuZGluZ19idWZbcy5wZW5kaW5nKytdID0gYjsKCX0KCgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogUHV0IGEgc2hvcnQgaW4gdGhlIHBlbmRpbmcgYnVmZmVyLiBUaGUgMTYtYml0IHZhbHVlIGlzIHB1dCBpbiBNU0Igb3JkZXIuCgkgKiBJTiBhc3NlcnRpb246IHRoZSBzdHJlYW0gc3RhdGUgaXMgY29ycmVjdCBhbmQgdGhlcmUgaXMgZW5vdWdoIHJvb20gaW4KCSAqIHBlbmRpbmdfYnVmLgoJICovCglmdW5jdGlvbiBwdXRTaG9ydE1TQihzLCBiKSB7CgkvLyAgcHV0X2J5dGUocywgKEJ5dGUpKGIgPj4gOCkpOwoJLy8gIHB1dF9ieXRlKHMsIChCeXRlKShiICYgMHhmZikpOwoJICBzLnBlbmRpbmdfYnVmW3MucGVuZGluZysrXSA9IChiID4+PiA4KSAmIDB4ZmY7CgkgIHMucGVuZGluZ19idWZbcy5wZW5kaW5nKytdID0gYiAmIDB4ZmY7Cgl9CgoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogUmVhZCBhIG5ldyBidWZmZXIgZnJvbSB0aGUgY3VycmVudCBpbnB1dCBzdHJlYW0sIHVwZGF0ZSB0aGUgYWRsZXIzMgoJICogYW5kIHRvdGFsIG51bWJlciBvZiBieXRlcyByZWFkLiAgQWxsIGRlZmxhdGUoKSBpbnB1dCBnb2VzIHRocm91Z2gKCSAqIHRoaXMgZnVuY3Rpb24gc28gc29tZSBhcHBsaWNhdGlvbnMgbWF5IHdpc2ggdG8gbW9kaWZ5IGl0IHRvIGF2b2lkCgkgKiBhbGxvY2F0aW5nIGEgbGFyZ2Ugc3RybS0+aW5wdXQgYnVmZmVyIGFuZCBjb3B5aW5nIGZyb20gaXQuCgkgKiAoU2VlIGFsc28gZmx1c2hfcGVuZGluZygpKS4KCSAqLwoJZnVuY3Rpb24gcmVhZF9idWYoc3RybSwgYnVmLCBzdGFydCwgc2l6ZSkgewoJICB2YXIgbGVuID0gc3RybS5hdmFpbF9pbjsKCgkgIGlmIChsZW4gPiBzaXplKSB7IGxlbiA9IHNpemU7IH0KCSAgaWYgKGxlbiA9PT0gMCkgeyByZXR1cm4gMDsgfQoKCSAgc3RybS5hdmFpbF9pbiAtPSBsZW47CgoJICAvLyB6bWVtY3B5KGJ1Ziwgc3RybS0+bmV4dF9pbiwgbGVuKTsKCSAgdXRpbHMuYXJyYXlTZXQoYnVmLCBzdHJtLmlucHV0LCBzdHJtLm5leHRfaW4sIGxlbiwgc3RhcnQpOwoJICBpZiAoc3RybS5zdGF0ZS53cmFwID09PSAxKSB7CgkgICAgc3RybS5hZGxlciA9IGFkbGVyMzIoc3RybS5hZGxlciwgYnVmLCBsZW4sIHN0YXJ0KTsKCSAgfQoKCSAgZWxzZSBpZiAoc3RybS5zdGF0ZS53cmFwID09PSAyKSB7CgkgICAgc3RybS5hZGxlciA9IGNyYzMyKHN0cm0uYWRsZXIsIGJ1ZiwgbGVuLCBzdGFydCk7CgkgIH0KCgkgIHN0cm0ubmV4dF9pbiArPSBsZW47CgkgIHN0cm0udG90YWxfaW4gKz0gbGVuOwoKCSAgcmV0dXJuIGxlbjsKCX0KCgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBTZXQgbWF0Y2hfc3RhcnQgdG8gdGhlIGxvbmdlc3QgbWF0Y2ggc3RhcnRpbmcgYXQgdGhlIGdpdmVuIHN0cmluZyBhbmQKCSAqIHJldHVybiBpdHMgbGVuZ3RoLiBNYXRjaGVzIHNob3J0ZXIgb3IgZXF1YWwgdG8gcHJldl9sZW5ndGggYXJlIGRpc2NhcmRlZCwKCSAqIGluIHdoaWNoIGNhc2UgdGhlIHJlc3VsdCBpcyBlcXVhbCB0byBwcmV2X2xlbmd0aCBhbmQgbWF0Y2hfc3RhcnQgaXMKCSAqIGdhcmJhZ2UuCgkgKiBJTiBhc3NlcnRpb25zOiBjdXJfbWF0Y2ggaXMgdGhlIGhlYWQgb2YgdGhlIGhhc2ggY2hhaW4gZm9yIHRoZSBjdXJyZW50CgkgKiAgIHN0cmluZyAoc3Ryc3RhcnQpIGFuZCBpdHMgZGlzdGFuY2UgaXMgPD0gTUFYX0RJU1QsIGFuZCBwcmV2X2xlbmd0aCA+PSAxCgkgKiBPVVQgYXNzZXJ0aW9uOiB0aGUgbWF0Y2ggbGVuZ3RoIGlzIG5vdCBncmVhdGVyIHRoYW4gcy0+bG9va2FoZWFkLgoJICovCglmdW5jdGlvbiBsb25nZXN0X21hdGNoKHMsIGN1cl9tYXRjaCkgewoJICB2YXIgY2hhaW5fbGVuZ3RoID0gcy5tYXhfY2hhaW5fbGVuZ3RoOyAgICAgIC8qIG1heCBoYXNoIGNoYWluIGxlbmd0aCAqLwoJICB2YXIgc2NhbiA9IHMuc3Ryc3RhcnQ7IC8qIGN1cnJlbnQgc3RyaW5nICovCgkgIHZhciBtYXRjaDsgICAgICAgICAgICAgICAgICAgICAgIC8qIG1hdGNoZWQgc3RyaW5nICovCgkgIHZhciBsZW47ICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogbGVuZ3RoIG9mIGN1cnJlbnQgbWF0Y2ggKi8KCSAgdmFyIGJlc3RfbGVuID0gcy5wcmV2X2xlbmd0aDsgICAgICAgICAgICAgIC8qIGJlc3QgbWF0Y2ggbGVuZ3RoIHNvIGZhciAqLwoJICB2YXIgbmljZV9tYXRjaCA9IHMubmljZV9tYXRjaDsgICAgICAgICAgICAgLyogc3RvcCBpZiBtYXRjaCBsb25nIGVub3VnaCAqLwoJICB2YXIgbGltaXQgPSAocy5zdHJzdGFydCA+IChzLndfc2l6ZSAtIE1JTl9MT09LQUhFQUQpKSA/CgkgICAgICBzLnN0cnN0YXJ0IC0gKHMud19zaXplIC0gTUlOX0xPT0tBSEVBRCkgOiAwLypOSUwqLzsKCgkgIHZhciBfd2luID0gcy53aW5kb3c7IC8vIHNob3J0Y3V0CgoJICB2YXIgd21hc2sgPSBzLndfbWFzazsKCSAgdmFyIHByZXYgID0gcy5wcmV2OwoKCSAgLyogU3RvcCB3aGVuIGN1cl9tYXRjaCBiZWNvbWVzIDw9IGxpbWl0LiBUbyBzaW1wbGlmeSB0aGUgY29kZSwKCSAgICogd2UgcHJldmVudCBtYXRjaGVzIHdpdGggdGhlIHN0cmluZyBvZiB3aW5kb3cgaW5kZXggMC4KCSAgICovCgoJICB2YXIgc3RyZW5kID0gcy5zdHJzdGFydCArIE1BWF9NQVRDSDsKCSAgdmFyIHNjYW5fZW5kMSAgPSBfd2luW3NjYW4gKyBiZXN0X2xlbiAtIDFdOwoJICB2YXIgc2Nhbl9lbmQgICA9IF93aW5bc2NhbiArIGJlc3RfbGVuXTsKCgkgIC8qIFRoZSBjb2RlIGlzIG9wdGltaXplZCBmb3IgSEFTSF9CSVRTID49IDggYW5kIE1BWF9NQVRDSC0yIG11bHRpcGxlIG9mIDE2LgoJICAgKiBJdCBpcyBlYXN5IHRvIGdldCByaWQgb2YgdGhpcyBvcHRpbWl6YXRpb24gaWYgbmVjZXNzYXJ5LgoJICAgKi8KCSAgLy8gQXNzZXJ0KHMtPmhhc2hfYml0cyA+PSA4ICYmIE1BWF9NQVRDSCA9PSAyNTgsICJDb2RlIHRvbyBjbGV2ZXIiKTsKCgkgIC8qIERvIG5vdCB3YXN0ZSB0b28gbXVjaCB0aW1lIGlmIHdlIGFscmVhZHkgaGF2ZSBhIGdvb2QgbWF0Y2g6ICovCgkgIGlmIChzLnByZXZfbGVuZ3RoID49IHMuZ29vZF9tYXRjaCkgewoJICAgIGNoYWluX2xlbmd0aCA+Pj0gMjsKCSAgfQoJICAvKiBEbyBub3QgbG9vayBmb3IgbWF0Y2hlcyBiZXlvbmQgdGhlIGVuZCBvZiB0aGUgaW5wdXQuIFRoaXMgaXMgbmVjZXNzYXJ5CgkgICAqIHRvIG1ha2UgZGVmbGF0ZSBkZXRlcm1pbmlzdGljLgoJICAgKi8KCSAgaWYgKG5pY2VfbWF0Y2ggPiBzLmxvb2thaGVhZCkgeyBuaWNlX21hdGNoID0gcy5sb29rYWhlYWQ7IH0KCgkgIC8vIEFzc2VydCgodWxnKXMtPnN0cnN0YXJ0IDw9IHMtPndpbmRvd19zaXplLU1JTl9MT09LQUhFQUQsICJuZWVkIGxvb2thaGVhZCIpOwoKCSAgZG8gewoJICAgIC8vIEFzc2VydChjdXJfbWF0Y2ggPCBzLT5zdHJzdGFydCwgIm5vIGZ1dHVyZSIpOwoJICAgIG1hdGNoID0gY3VyX21hdGNoOwoKCSAgICAvKiBTa2lwIHRvIG5leHQgbWF0Y2ggaWYgdGhlIG1hdGNoIGxlbmd0aCBjYW5ub3QgaW5jcmVhc2UKCSAgICAgKiBvciBpZiB0aGUgbWF0Y2ggbGVuZ3RoIGlzIGxlc3MgdGhhbiAyLiAgTm90ZSB0aGF0IHRoZSBjaGVja3MgYmVsb3cKCSAgICAgKiBmb3IgaW5zdWZmaWNpZW50IGxvb2thaGVhZCBvbmx5IG9jY3VyIG9jY2FzaW9uYWxseSBmb3IgcGVyZm9ybWFuY2UKCSAgICAgKiByZWFzb25zLiAgVGhlcmVmb3JlIHVuaW5pdGlhbGl6ZWQgbWVtb3J5IHdpbGwgYmUgYWNjZXNzZWQsIGFuZAoJICAgICAqIGNvbmRpdGlvbmFsIGp1bXBzIHdpbGwgYmUgbWFkZSB0aGF0IGRlcGVuZCBvbiB0aG9zZSB2YWx1ZXMuCgkgICAgICogSG93ZXZlciB0aGUgbGVuZ3RoIG9mIHRoZSBtYXRjaCBpcyBsaW1pdGVkIHRvIHRoZSBsb29rYWhlYWQsIHNvCgkgICAgICogdGhlIG91dHB1dCBvZiBkZWZsYXRlIGlzIG5vdCBhZmZlY3RlZCBieSB0aGUgdW5pbml0aWFsaXplZCB2YWx1ZXMuCgkgICAgICovCgoJICAgIGlmIChfd2luW21hdGNoICsgYmVzdF9sZW5dICAgICAhPT0gc2Nhbl9lbmQgIHx8CgkgICAgICAgIF93aW5bbWF0Y2ggKyBiZXN0X2xlbiAtIDFdICE9PSBzY2FuX2VuZDEgfHwKCSAgICAgICAgX3dpblttYXRjaF0gICAgICAgICAgICAgICAgIT09IF93aW5bc2Nhbl0gfHwKCSAgICAgICAgX3dpblsrK21hdGNoXSAgICAgICAgICAgICAgIT09IF93aW5bc2NhbiArIDFdKSB7CgkgICAgICBjb250aW51ZTsKCSAgICB9CgoJICAgIC8qIFRoZSBjaGVjayBhdCBiZXN0X2xlbi0xIGNhbiBiZSByZW1vdmVkIGJlY2F1c2UgaXQgd2lsbCBiZSBtYWRlCgkgICAgICogYWdhaW4gbGF0ZXIuIChUaGlzIGhldXJpc3RpYyBpcyBub3QgYWx3YXlzIGEgd2luLikKCSAgICAgKiBJdCBpcyBub3QgbmVjZXNzYXJ5IHRvIGNvbXBhcmUgc2NhblsyXSBhbmQgbWF0Y2hbMl0gc2luY2UgdGhleQoJICAgICAqIGFyZSBhbHdheXMgZXF1YWwgd2hlbiB0aGUgb3RoZXIgYnl0ZXMgbWF0Y2gsIGdpdmVuIHRoYXQKCSAgICAgKiB0aGUgaGFzaCBrZXlzIGFyZSBlcXVhbCBhbmQgdGhhdCBIQVNIX0JJVFMgPj0gOC4KCSAgICAgKi8KCSAgICBzY2FuICs9IDI7CgkgICAgbWF0Y2grKzsKCSAgICAvLyBBc3NlcnQoKnNjYW4gPT0gKm1hdGNoLCAibWF0Y2hbMl0/Iik7CgoJICAgIC8qIFdlIGNoZWNrIGZvciBpbnN1ZmZpY2llbnQgbG9va2FoZWFkIG9ubHkgZXZlcnkgOHRoIGNvbXBhcmlzb247CgkgICAgICogdGhlIDI1NnRoIGNoZWNrIHdpbGwgYmUgbWFkZSBhdCBzdHJzdGFydCsyNTguCgkgICAgICovCgkgICAgZG8gewoJICAgICAgLypqc2hpbnQgbm9lbXB0eTpmYWxzZSovCgkgICAgfSB3aGlsZSAoX3dpblsrK3NjYW5dID09PSBfd2luWysrbWF0Y2hdICYmIF93aW5bKytzY2FuXSA9PT0gX3dpblsrK21hdGNoXSAmJgoJICAgICAgICAgICAgIF93aW5bKytzY2FuXSA9PT0gX3dpblsrK21hdGNoXSAmJiBfd2luWysrc2Nhbl0gPT09IF93aW5bKyttYXRjaF0gJiYKCSAgICAgICAgICAgICBfd2luWysrc2Nhbl0gPT09IF93aW5bKyttYXRjaF0gJiYgX3dpblsrK3NjYW5dID09PSBfd2luWysrbWF0Y2hdICYmCgkgICAgICAgICAgICAgX3dpblsrK3NjYW5dID09PSBfd2luWysrbWF0Y2hdICYmIF93aW5bKytzY2FuXSA9PT0gX3dpblsrK21hdGNoXSAmJgoJICAgICAgICAgICAgIHNjYW4gPCBzdHJlbmQpOwoKCSAgICAvLyBBc3NlcnQoc2NhbiA8PSBzLT53aW5kb3crKHVuc2lnbmVkKShzLT53aW5kb3dfc2l6ZS0xKSwgIndpbGQgc2NhbiIpOwoKCSAgICBsZW4gPSBNQVhfTUFUQ0ggLSAoc3RyZW5kIC0gc2Nhbik7CgkgICAgc2NhbiA9IHN0cmVuZCAtIE1BWF9NQVRDSDsKCgkgICAgaWYgKGxlbiA+IGJlc3RfbGVuKSB7CgkgICAgICBzLm1hdGNoX3N0YXJ0ID0gY3VyX21hdGNoOwoJICAgICAgYmVzdF9sZW4gPSBsZW47CgkgICAgICBpZiAobGVuID49IG5pY2VfbWF0Y2gpIHsKCSAgICAgICAgYnJlYWs7CgkgICAgICB9CgkgICAgICBzY2FuX2VuZDEgID0gX3dpbltzY2FuICsgYmVzdF9sZW4gLSAxXTsKCSAgICAgIHNjYW5fZW5kICAgPSBfd2luW3NjYW4gKyBiZXN0X2xlbl07CgkgICAgfQoJICB9IHdoaWxlICgoY3VyX21hdGNoID0gcHJldltjdXJfbWF0Y2ggJiB3bWFza10pID4gbGltaXQgJiYgLS1jaGFpbl9sZW5ndGggIT09IDApOwoKCSAgaWYgKGJlc3RfbGVuIDw9IHMubG9va2FoZWFkKSB7CgkgICAgcmV0dXJuIGJlc3RfbGVuOwoJICB9CgkgIHJldHVybiBzLmxvb2thaGVhZDsKCX0KCgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBGaWxsIHRoZSB3aW5kb3cgd2hlbiB0aGUgbG9va2FoZWFkIGJlY29tZXMgaW5zdWZmaWNpZW50LgoJICogVXBkYXRlcyBzdHJzdGFydCBhbmQgbG9va2FoZWFkLgoJICoKCSAqIElOIGFzc2VydGlvbjogbG9va2FoZWFkIDwgTUlOX0xPT0tBSEVBRAoJICogT1VUIGFzc2VydGlvbnM6IHN0cnN0YXJ0IDw9IHdpbmRvd19zaXplLU1JTl9MT09LQUhFQUQKCSAqICAgIEF0IGxlYXN0IG9uZSBieXRlIGhhcyBiZWVuIHJlYWQsIG9yIGF2YWlsX2luID09IDA7IHJlYWRzIGFyZQoJICogICAgcGVyZm9ybWVkIGZvciBhdCBsZWFzdCB0d28gYnl0ZXMgKHJlcXVpcmVkIGZvciB0aGUgemlwIHRyYW5zbGF0ZV9lb2wKCSAqICAgIG9wdGlvbiAtLSBub3Qgc3VwcG9ydGVkIGhlcmUpLgoJICovCglmdW5jdGlvbiBmaWxsX3dpbmRvdyhzKSB7CgkgIHZhciBfd19zaXplID0gcy53X3NpemU7CgkgIHZhciBwLCBuLCBtLCBtb3JlLCBzdHI7CgoJICAvL0Fzc2VydChzLT5sb29rYWhlYWQgPCBNSU5fTE9PS0FIRUFELCAiYWxyZWFkeSBlbm91Z2ggbG9va2FoZWFkIik7CgoJICBkbyB7CgkgICAgbW9yZSA9IHMud2luZG93X3NpemUgLSBzLmxvb2thaGVhZCAtIHMuc3Ryc3RhcnQ7CgoJICAgIC8vIEpTIGludHMgaGF2ZSAzMiBiaXQsIGJsb2NrIGJlbG93IG5vdCBuZWVkZWQKCSAgICAvKiBEZWFsIHdpdGggIUAjJCUgNjRLIGxpbWl0OiAqLwoJICAgIC8vaWYgKHNpemVvZihpbnQpIDw9IDIpIHsKCSAgICAvLyAgICBpZiAobW9yZSA9PSAwICYmIHMtPnN0cnN0YXJ0ID09IDAgJiYgcy0+bG9va2FoZWFkID09IDApIHsKCSAgICAvLyAgICAgICAgbW9yZSA9IHdzaXplOwoJICAgIC8vCgkgICAgLy8gIH0gZWxzZSBpZiAobW9yZSA9PSAodW5zaWduZWQpKC0xKSkgewoJICAgIC8vICAgICAgICAvKiBWZXJ5IHVubGlrZWx5LCBidXQgcG9zc2libGUgb24gMTYgYml0IG1hY2hpbmUgaWYKCSAgICAvLyAgICAgICAgICogc3Ryc3RhcnQgPT0gMCAmJiBsb29rYWhlYWQgPT0gMSAoaW5wdXQgZG9uZSBhIGJ5dGUgYXQgdGltZSkKCSAgICAvLyAgICAgICAgICovCgkgICAgLy8gICAgICAgIG1vcmUtLTsKCSAgICAvLyAgICB9CgkgICAgLy99CgoKCSAgICAvKiBJZiB0aGUgd2luZG93IGlzIGFsbW9zdCBmdWxsIGFuZCB0aGVyZSBpcyBpbnN1ZmZpY2llbnQgbG9va2FoZWFkLAoJICAgICAqIG1vdmUgdGhlIHVwcGVyIGhhbGYgdG8gdGhlIGxvd2VyIG9uZSB0byBtYWtlIHJvb20gaW4gdGhlIHVwcGVyIGhhbGYuCgkgICAgICovCgkgICAgaWYgKHMuc3Ryc3RhcnQgPj0gX3dfc2l6ZSArIChfd19zaXplIC0gTUlOX0xPT0tBSEVBRCkpIHsKCgkgICAgICB1dGlscy5hcnJheVNldChzLndpbmRvdywgcy53aW5kb3csIF93X3NpemUsIF93X3NpemUsIDApOwoJICAgICAgcy5tYXRjaF9zdGFydCAtPSBfd19zaXplOwoJICAgICAgcy5zdHJzdGFydCAtPSBfd19zaXplOwoJICAgICAgLyogd2Ugbm93IGhhdmUgc3Ryc3RhcnQgPj0gTUFYX0RJU1QgKi8KCSAgICAgIHMuYmxvY2tfc3RhcnQgLT0gX3dfc2l6ZTsKCgkgICAgICAvKiBTbGlkZSB0aGUgaGFzaCB0YWJsZSAoY291bGQgYmUgYXZvaWRlZCB3aXRoIDMyIGJpdCB2YWx1ZXMKCSAgICAgICBhdCB0aGUgZXhwZW5zZSBvZiBtZW1vcnkgdXNhZ2UpLiBXZSBzbGlkZSBldmVuIHdoZW4gbGV2ZWwgPT0gMAoJICAgICAgIHRvIGtlZXAgdGhlIGhhc2ggdGFibGUgY29uc2lzdGVudCBpZiB3ZSBzd2l0Y2ggYmFjayB0byBsZXZlbCA+IDAKCSAgICAgICBsYXRlci4gKFVzaW5nIGxldmVsIDAgcGVybWFuZW50bHkgaXMgbm90IGFuIG9wdGltYWwgdXNhZ2Ugb2YKCSAgICAgICB6bGliLCBzbyB3ZSBkb24ndCBjYXJlIGFib3V0IHRoaXMgcGF0aG9sb2dpY2FsIGNhc2UuKQoJICAgICAgICovCgoJICAgICAgbiA9IHMuaGFzaF9zaXplOwoJICAgICAgcCA9IG47CgkgICAgICBkbyB7CgkgICAgICAgIG0gPSBzLmhlYWRbLS1wXTsKCSAgICAgICAgcy5oZWFkW3BdID0gKG0gPj0gX3dfc2l6ZSA/IG0gLSBfd19zaXplIDogMCk7CgkgICAgICB9IHdoaWxlICgtLW4pOwoKCSAgICAgIG4gPSBfd19zaXplOwoJICAgICAgcCA9IG47CgkgICAgICBkbyB7CgkgICAgICAgIG0gPSBzLnByZXZbLS1wXTsKCSAgICAgICAgcy5wcmV2W3BdID0gKG0gPj0gX3dfc2l6ZSA/IG0gLSBfd19zaXplIDogMCk7CgkgICAgICAgIC8qIElmIG4gaXMgbm90IG9uIGFueSBoYXNoIGNoYWluLCBwcmV2W25dIGlzIGdhcmJhZ2UgYnV0CgkgICAgICAgICAqIGl0cyB2YWx1ZSB3aWxsIG5ldmVyIGJlIHVzZWQuCgkgICAgICAgICAqLwoJICAgICAgfSB3aGlsZSAoLS1uKTsKCgkgICAgICBtb3JlICs9IF93X3NpemU7CgkgICAgfQoJICAgIGlmIChzLnN0cm0uYXZhaWxfaW4gPT09IDApIHsKCSAgICAgIGJyZWFrOwoJICAgIH0KCgkgICAgLyogSWYgdGhlcmUgd2FzIG5vIHNsaWRpbmc6CgkgICAgICogICAgc3Ryc3RhcnQgPD0gV1NJWkUrTUFYX0RJU1QtMSAmJiBsb29rYWhlYWQgPD0gTUlOX0xPT0tBSEVBRCAtIDEgJiYKCSAgICAgKiAgICBtb3JlID09IHdpbmRvd19zaXplIC0gbG9va2FoZWFkIC0gc3Ryc3RhcnQKCSAgICAgKiA9PiBtb3JlID49IHdpbmRvd19zaXplIC0gKE1JTl9MT09LQUhFQUQtMSArIFdTSVpFICsgTUFYX0RJU1QtMSkKCSAgICAgKiA9PiBtb3JlID49IHdpbmRvd19zaXplIC0gMipXU0laRSArIDIKCSAgICAgKiBJbiB0aGUgQklHX01FTSBvciBNTUFQIGNhc2UgKG5vdCB5ZXQgc3VwcG9ydGVkKSwKCSAgICAgKiAgIHdpbmRvd19zaXplID09IGlucHV0X3NpemUgKyBNSU5fTE9PS0FIRUFEICAmJgoJICAgICAqICAgc3Ryc3RhcnQgKyBzLT5sb29rYWhlYWQgPD0gaW5wdXRfc2l6ZSA9PiBtb3JlID49IE1JTl9MT09LQUhFQUQuCgkgICAgICogT3RoZXJ3aXNlLCB3aW5kb3dfc2l6ZSA9PSAyKldTSVpFIHNvIG1vcmUgPj0gMi4KCSAgICAgKiBJZiB0aGVyZSB3YXMgc2xpZGluZywgbW9yZSA+PSBXU0laRS4gU28gaW4gYWxsIGNhc2VzLCBtb3JlID49IDIuCgkgICAgICovCgkgICAgLy9Bc3NlcnQobW9yZSA+PSAyLCAibW9yZSA8IDIiKTsKCSAgICBuID0gcmVhZF9idWYocy5zdHJtLCBzLndpbmRvdywgcy5zdHJzdGFydCArIHMubG9va2FoZWFkLCBtb3JlKTsKCSAgICBzLmxvb2thaGVhZCArPSBuOwoKCSAgICAvKiBJbml0aWFsaXplIHRoZSBoYXNoIHZhbHVlIG5vdyB0aGF0IHdlIGhhdmUgc29tZSBpbnB1dDogKi8KCSAgICBpZiAocy5sb29rYWhlYWQgKyBzLmluc2VydCA+PSBNSU5fTUFUQ0gpIHsKCSAgICAgIHN0ciA9IHMuc3Ryc3RhcnQgLSBzLmluc2VydDsKCSAgICAgIHMuaW5zX2ggPSBzLndpbmRvd1tzdHJdOwoKCSAgICAgIC8qIFVQREFURV9IQVNIKHMsIHMtPmluc19oLCBzLT53aW5kb3dbc3RyICsgMV0pOyAqLwoJICAgICAgcy5pbnNfaCA9ICgocy5pbnNfaCA8PCBzLmhhc2hfc2hpZnQpIF4gcy53aW5kb3dbc3RyICsgMV0pICYgcy5oYXNoX21hc2s7CgkvLyNpZiBNSU5fTUFUQ0ggIT0gMwoJLy8gICAgICAgIENhbGwgdXBkYXRlX2hhc2goKSBNSU5fTUFUQ0gtMyBtb3JlIHRpbWVzCgkvLyNlbmRpZgoJICAgICAgd2hpbGUgKHMuaW5zZXJ0KSB7CgkgICAgICAgIC8qIFVQREFURV9IQVNIKHMsIHMtPmluc19oLCBzLT53aW5kb3dbc3RyICsgTUlOX01BVENILTFdKTsgKi8KCSAgICAgICAgcy5pbnNfaCA9ICgocy5pbnNfaCA8PCBzLmhhc2hfc2hpZnQpIF4gcy53aW5kb3dbc3RyICsgTUlOX01BVENIIC0gMV0pICYgcy5oYXNoX21hc2s7CgoJICAgICAgICBzLnByZXZbc3RyICYgcy53X21hc2tdID0gcy5oZWFkW3MuaW5zX2hdOwoJICAgICAgICBzLmhlYWRbcy5pbnNfaF0gPSBzdHI7CgkgICAgICAgIHN0cisrOwoJICAgICAgICBzLmluc2VydC0tOwoJICAgICAgICBpZiAocy5sb29rYWhlYWQgKyBzLmluc2VydCA8IE1JTl9NQVRDSCkgewoJICAgICAgICAgIGJyZWFrOwoJICAgICAgICB9CgkgICAgICB9CgkgICAgfQoJICAgIC8qIElmIHRoZSB3aG9sZSBpbnB1dCBoYXMgbGVzcyB0aGFuIE1JTl9NQVRDSCBieXRlcywgaW5zX2ggaXMgZ2FyYmFnZSwKCSAgICAgKiBidXQgdGhpcyBpcyBub3QgaW1wb3J0YW50IHNpbmNlIG9ubHkgbGl0ZXJhbCBieXRlcyB3aWxsIGJlIGVtaXR0ZWQuCgkgICAgICovCgoJICB9IHdoaWxlIChzLmxvb2thaGVhZCA8IE1JTl9MT09LQUhFQUQgJiYgcy5zdHJtLmF2YWlsX2luICE9PSAwKTsKCgkgIC8qIElmIHRoZSBXSU5fSU5JVCBieXRlcyBhZnRlciB0aGUgZW5kIG9mIHRoZSBjdXJyZW50IGRhdGEgaGF2ZSBuZXZlciBiZWVuCgkgICAqIHdyaXR0ZW4sIHRoZW4gemVybyB0aG9zZSBieXRlcyBpbiBvcmRlciB0byBhdm9pZCBtZW1vcnkgY2hlY2sgcmVwb3J0cyBvZgoJICAgKiB0aGUgdXNlIG9mIHVuaW5pdGlhbGl6ZWQgKG9yIHVuaW5pdGlhbGlzZWQgYXMgSnVsaWFuIHdyaXRlcykgYnl0ZXMgYnkKCSAgICogdGhlIGxvbmdlc3QgbWF0Y2ggcm91dGluZXMuICBVcGRhdGUgdGhlIGhpZ2ggd2F0ZXIgbWFyayBmb3IgdGhlIG5leHQKCSAgICogdGltZSB0aHJvdWdoIGhlcmUuICBXSU5fSU5JVCBpcyBzZXQgdG8gTUFYX01BVENIIHNpbmNlIHRoZSBsb25nZXN0IG1hdGNoCgkgICAqIHJvdXRpbmVzIGFsbG93IHNjYW5uaW5nIHRvIHN0cnN0YXJ0ICsgTUFYX01BVENILCBpZ25vcmluZyBsb29rYWhlYWQuCgkgICAqLwoJLy8gIGlmIChzLmhpZ2hfd2F0ZXIgPCBzLndpbmRvd19zaXplKSB7CgkvLyAgICB2YXIgY3VyciA9IHMuc3Ryc3RhcnQgKyBzLmxvb2thaGVhZDsKCS8vICAgIHZhciBpbml0ID0gMDsKCS8vCgkvLyAgICBpZiAocy5oaWdoX3dhdGVyIDwgY3VycikgewoJLy8gICAgICAvKiBQcmV2aW91cyBoaWdoIHdhdGVyIG1hcmsgYmVsb3cgY3VycmVudCBkYXRhIC0tIHplcm8gV0lOX0lOSVQKCS8vICAgICAgICogYnl0ZXMgb3IgdXAgdG8gZW5kIG9mIHdpbmRvdywgd2hpY2hldmVyIGlzIGxlc3MuCgkvLyAgICAgICAqLwoJLy8gICAgICBpbml0ID0gcy53aW5kb3dfc2l6ZSAtIGN1cnI7CgkvLyAgICAgIGlmIChpbml0ID4gV0lOX0lOSVQpCgkvLyAgICAgICAgaW5pdCA9IFdJTl9JTklUOwoJLy8gICAgICB6bWVtemVybyhzLT53aW5kb3cgKyBjdXJyLCAodW5zaWduZWQpaW5pdCk7CgkvLyAgICAgIHMtPmhpZ2hfd2F0ZXIgPSBjdXJyICsgaW5pdDsKCS8vICAgIH0KCS8vICAgIGVsc2UgaWYgKHMtPmhpZ2hfd2F0ZXIgPCAodWxnKWN1cnIgKyBXSU5fSU5JVCkgewoJLy8gICAgICAvKiBIaWdoIHdhdGVyIG1hcmsgYXQgb3IgYWJvdmUgY3VycmVudCBkYXRhLCBidXQgYmVsb3cgY3VycmVudCBkYXRhCgkvLyAgICAgICAqIHBsdXMgV0lOX0lOSVQgLS0gemVybyBvdXQgdG8gY3VycmVudCBkYXRhIHBsdXMgV0lOX0lOSVQsIG9yIHVwCgkvLyAgICAgICAqIHRvIGVuZCBvZiB3aW5kb3csIHdoaWNoZXZlciBpcyBsZXNzLgoJLy8gICAgICAgKi8KCS8vICAgICAgaW5pdCA9ICh1bGcpY3VyciArIFdJTl9JTklUIC0gcy0+aGlnaF93YXRlcjsKCS8vICAgICAgaWYgKGluaXQgPiBzLT53aW5kb3dfc2l6ZSAtIHMtPmhpZ2hfd2F0ZXIpCgkvLyAgICAgICAgaW5pdCA9IHMtPndpbmRvd19zaXplIC0gcy0+aGlnaF93YXRlcjsKCS8vICAgICAgem1lbXplcm8ocy0+d2luZG93ICsgcy0+aGlnaF93YXRlciwgKHVuc2lnbmVkKWluaXQpOwoJLy8gICAgICBzLT5oaWdoX3dhdGVyICs9IGluaXQ7CgkvLyAgICB9CgkvLyAgfQoJLy8KCS8vICBBc3NlcnQoKHVsZylzLT5zdHJzdGFydCA8PSBzLT53aW5kb3dfc2l6ZSAtIE1JTl9MT09LQUhFQUQsCgkvLyAgICAibm90IGVub3VnaCByb29tIGZvciBzZWFyY2giKTsKCX0KCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAqIENvcHkgd2l0aG91dCBjb21wcmVzc2lvbiBhcyBtdWNoIGFzIHBvc3NpYmxlIGZyb20gdGhlIGlucHV0IHN0cmVhbSwgcmV0dXJuCgkgKiB0aGUgY3VycmVudCBibG9jayBzdGF0ZS4KCSAqIFRoaXMgZnVuY3Rpb24gZG9lcyBub3QgaW5zZXJ0IG5ldyBzdHJpbmdzIGluIHRoZSBkaWN0aW9uYXJ5IHNpbmNlCgkgKiB1bmNvbXByZXNzaWJsZSBkYXRhIGlzIHByb2JhYmx5IG5vdCB1c2VmdWwuIFRoaXMgZnVuY3Rpb24gaXMgdXNlZAoJICogb25seSBmb3IgdGhlIGxldmVsPTAgY29tcHJlc3Npb24gb3B0aW9uLgoJICogTk9URTogdGhpcyBmdW5jdGlvbiBzaG91bGQgYmUgb3B0aW1pemVkIHRvIGF2b2lkIGV4dHJhIGNvcHlpbmcgZnJvbQoJICogd2luZG93IHRvIHBlbmRpbmdfYnVmLgoJICovCglmdW5jdGlvbiBkZWZsYXRlX3N0b3JlZChzLCBmbHVzaCkgewoJICAvKiBTdG9yZWQgYmxvY2tzIGFyZSBsaW1pdGVkIHRvIDB4ZmZmZiBieXRlcywgcGVuZGluZ19idWYgaXMgbGltaXRlZAoJICAgKiB0byBwZW5kaW5nX2J1Zl9zaXplLCBhbmQgZWFjaCBzdG9yZWQgYmxvY2sgaGFzIGEgNSBieXRlIGhlYWRlcjoKCSAgICovCgkgIHZhciBtYXhfYmxvY2tfc2l6ZSA9IDB4ZmZmZjsKCgkgIGlmIChtYXhfYmxvY2tfc2l6ZSA+IHMucGVuZGluZ19idWZfc2l6ZSAtIDUpIHsKCSAgICBtYXhfYmxvY2tfc2l6ZSA9IHMucGVuZGluZ19idWZfc2l6ZSAtIDU7CgkgIH0KCgkgIC8qIENvcHkgYXMgbXVjaCBhcyBwb3NzaWJsZSBmcm9tIGlucHV0IHRvIG91dHB1dDogKi8KCSAgZm9yICg7OykgewoJICAgIC8qIEZpbGwgdGhlIHdpbmRvdyBhcyBtdWNoIGFzIHBvc3NpYmxlOiAqLwoJICAgIGlmIChzLmxvb2thaGVhZCA8PSAxKSB7CgoJICAgICAgLy9Bc3NlcnQocy0+c3Ryc3RhcnQgPCBzLT53X3NpemUrTUFYX0RJU1QocykgfHwKCSAgICAgIC8vICBzLT5ibG9ja19zdGFydCA+PSAobG9uZylzLT53X3NpemUsICJzbGlkZSB0b28gbGF0ZSIpOwoJLy8gICAgICBpZiAoIShzLnN0cnN0YXJ0IDwgcy53X3NpemUgKyAocy53X3NpemUgLSBNSU5fTE9PS0FIRUFEKSB8fAoJLy8gICAgICAgIHMuYmxvY2tfc3RhcnQgPj0gcy53X3NpemUpKSB7CgkvLyAgICAgICAgdGhyb3cgIG5ldyBFcnJvcigic2xpZGUgdG9vIGxhdGUiKTsKCS8vICAgICAgfQoKCSAgICAgIGZpbGxfd2luZG93KHMpOwoJICAgICAgaWYgKHMubG9va2FoZWFkID09PSAwICYmIGZsdXNoID09PSBaX05PX0ZMVVNIKSB7CgkgICAgICAgIHJldHVybiBCU19ORUVEX01PUkU7CgkgICAgICB9CgoJICAgICAgaWYgKHMubG9va2FoZWFkID09PSAwKSB7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgICAgLyogZmx1c2ggdGhlIGN1cnJlbnQgYmxvY2sgKi8KCSAgICB9CgkgICAgLy9Bc3NlcnQocy0+YmxvY2tfc3RhcnQgPj0gMEwsICJibG9jayBnb25lIik7CgkvLyAgICBpZiAocy5ibG9ja19zdGFydCA8IDApIHRocm93IG5ldyBFcnJvcigiYmxvY2sgZ29uZSIpOwoKCSAgICBzLnN0cnN0YXJ0ICs9IHMubG9va2FoZWFkOwoJICAgIHMubG9va2FoZWFkID0gMDsKCgkgICAgLyogRW1pdCBhIHN0b3JlZCBibG9jayBpZiBwZW5kaW5nX2J1ZiB3aWxsIGJlIGZ1bGw6ICovCgkgICAgdmFyIG1heF9zdGFydCA9IHMuYmxvY2tfc3RhcnQgKyBtYXhfYmxvY2tfc2l6ZTsKCgkgICAgaWYgKHMuc3Ryc3RhcnQgPT09IDAgfHwgcy5zdHJzdGFydCA+PSBtYXhfc3RhcnQpIHsKCSAgICAgIC8qIHN0cnN0YXJ0ID09IDAgaXMgcG9zc2libGUgd2hlbiB3cmFwYXJvdW5kIG9uIDE2LWJpdCBtYWNoaW5lICovCgkgICAgICBzLmxvb2thaGVhZCA9IHMuc3Ryc3RhcnQgLSBtYXhfc3RhcnQ7CgkgICAgICBzLnN0cnN0YXJ0ID0gbWF4X3N0YXJ0OwoJICAgICAgLyoqKiBGTFVTSF9CTE9DSyhzLCAwKTsgKioqLwoJICAgICAgZmx1c2hfYmxvY2tfb25seShzLCBmYWxzZSk7CgkgICAgICBpZiAocy5zdHJtLmF2YWlsX291dCA9PT0gMCkgewoJICAgICAgICByZXR1cm4gQlNfTkVFRF9NT1JFOwoJICAgICAgfQoJICAgICAgLyoqKi8KCgoJICAgIH0KCSAgICAvKiBGbHVzaCBpZiB3ZSBtYXkgaGF2ZSB0byBzbGlkZSwgb3RoZXJ3aXNlIGJsb2NrX3N0YXJ0IG1heSBiZWNvbWUKCSAgICAgKiBuZWdhdGl2ZSBhbmQgdGhlIGRhdGEgd2lsbCBiZSBnb25lOgoJICAgICAqLwoJICAgIGlmIChzLnN0cnN0YXJ0IC0gcy5ibG9ja19zdGFydCA+PSAocy53X3NpemUgLSBNSU5fTE9PS0FIRUFEKSkgewoJICAgICAgLyoqKiBGTFVTSF9CTE9DSyhzLCAwKTsgKioqLwoJICAgICAgZmx1c2hfYmxvY2tfb25seShzLCBmYWxzZSk7CgkgICAgICBpZiAocy5zdHJtLmF2YWlsX291dCA9PT0gMCkgewoJICAgICAgICByZXR1cm4gQlNfTkVFRF9NT1JFOwoJICAgICAgfQoJICAgICAgLyoqKi8KCSAgICB9CgkgIH0KCgkgIHMuaW5zZXJ0ID0gMDsKCgkgIGlmIChmbHVzaCA9PT0gWl9GSU5JU0gpIHsKCSAgICAvKioqIEZMVVNIX0JMT0NLKHMsIDEpOyAqKiovCgkgICAgZmx1c2hfYmxvY2tfb25seShzLCB0cnVlKTsKCSAgICBpZiAocy5zdHJtLmF2YWlsX291dCA9PT0gMCkgewoJICAgICAgcmV0dXJuIEJTX0ZJTklTSF9TVEFSVEVEOwoJICAgIH0KCSAgICAvKioqLwoJICAgIHJldHVybiBCU19GSU5JU0hfRE9ORTsKCSAgfQoKCSAgaWYgKHMuc3Ryc3RhcnQgPiBzLmJsb2NrX3N0YXJ0KSB7CgkgICAgLyoqKiBGTFVTSF9CTE9DSyhzLCAwKTsgKioqLwoJICAgIGZsdXNoX2Jsb2NrX29ubHkocywgZmFsc2UpOwoJICAgIGlmIChzLnN0cm0uYXZhaWxfb3V0ID09PSAwKSB7CgkgICAgICByZXR1cm4gQlNfTkVFRF9NT1JFOwoJICAgIH0KCSAgICAvKioqLwoJICB9CgoJICByZXR1cm4gQlNfTkVFRF9NT1JFOwoJfQoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogQ29tcHJlc3MgYXMgbXVjaCBhcyBwb3NzaWJsZSBmcm9tIHRoZSBpbnB1dCBzdHJlYW0sIHJldHVybiB0aGUgY3VycmVudAoJICogYmxvY2sgc3RhdGUuCgkgKiBUaGlzIGZ1bmN0aW9uIGRvZXMgbm90IHBlcmZvcm0gbGF6eSBldmFsdWF0aW9uIG9mIG1hdGNoZXMgYW5kIGluc2VydHMKCSAqIG5ldyBzdHJpbmdzIGluIHRoZSBkaWN0aW9uYXJ5IG9ubHkgZm9yIHVubWF0Y2hlZCBzdHJpbmdzIG9yIGZvciBzaG9ydAoJICogbWF0Y2hlcy4gSXQgaXMgdXNlZCBvbmx5IGZvciB0aGUgZmFzdCBjb21wcmVzc2lvbiBvcHRpb25zLgoJICovCglmdW5jdGlvbiBkZWZsYXRlX2Zhc3QocywgZmx1c2gpIHsKCSAgdmFyIGhhc2hfaGVhZDsgICAgICAgIC8qIGhlYWQgb2YgdGhlIGhhc2ggY2hhaW4gKi8KCSAgdmFyIGJmbHVzaDsgICAgICAgICAgIC8qIHNldCBpZiBjdXJyZW50IGJsb2NrIG11c3QgYmUgZmx1c2hlZCAqLwoKCSAgZm9yICg7OykgewoJICAgIC8qIE1ha2Ugc3VyZSB0aGF0IHdlIGFsd2F5cyBoYXZlIGVub3VnaCBsb29rYWhlYWQsIGV4Y2VwdAoJICAgICAqIGF0IHRoZSBlbmQgb2YgdGhlIGlucHV0IGZpbGUuIFdlIG5lZWQgTUFYX01BVENIIGJ5dGVzCgkgICAgICogZm9yIHRoZSBuZXh0IG1hdGNoLCBwbHVzIE1JTl9NQVRDSCBieXRlcyB0byBpbnNlcnQgdGhlCgkgICAgICogc3RyaW5nIGZvbGxvd2luZyB0aGUgbmV4dCBtYXRjaC4KCSAgICAgKi8KCSAgICBpZiAocy5sb29rYWhlYWQgPCBNSU5fTE9PS0FIRUFEKSB7CgkgICAgICBmaWxsX3dpbmRvdyhzKTsKCSAgICAgIGlmIChzLmxvb2thaGVhZCA8IE1JTl9MT09LQUhFQUQgJiYgZmx1c2ggPT09IFpfTk9fRkxVU0gpIHsKCSAgICAgICAgcmV0dXJuIEJTX05FRURfTU9SRTsKCSAgICAgIH0KCSAgICAgIGlmIChzLmxvb2thaGVhZCA9PT0gMCkgewoJICAgICAgICBicmVhazsgLyogZmx1c2ggdGhlIGN1cnJlbnQgYmxvY2sgKi8KCSAgICAgIH0KCSAgICB9CgoJICAgIC8qIEluc2VydCB0aGUgc3RyaW5nIHdpbmRvd1tzdHJzdGFydCAuLiBzdHJzdGFydCsyXSBpbiB0aGUKCSAgICAgKiBkaWN0aW9uYXJ5LCBhbmQgc2V0IGhhc2hfaGVhZCB0byB0aGUgaGVhZCBvZiB0aGUgaGFzaCBjaGFpbjoKCSAgICAgKi8KCSAgICBoYXNoX2hlYWQgPSAwLypOSUwqLzsKCSAgICBpZiAocy5sb29rYWhlYWQgPj0gTUlOX01BVENIKSB7CgkgICAgICAvKioqIElOU0VSVF9TVFJJTkcocywgcy5zdHJzdGFydCwgaGFzaF9oZWFkKTsgKioqLwoJICAgICAgcy5pbnNfaCA9ICgocy5pbnNfaCA8PCBzLmhhc2hfc2hpZnQpIF4gcy53aW5kb3dbcy5zdHJzdGFydCArIE1JTl9NQVRDSCAtIDFdKSAmIHMuaGFzaF9tYXNrOwoJICAgICAgaGFzaF9oZWFkID0gcy5wcmV2W3Muc3Ryc3RhcnQgJiBzLndfbWFza10gPSBzLmhlYWRbcy5pbnNfaF07CgkgICAgICBzLmhlYWRbcy5pbnNfaF0gPSBzLnN0cnN0YXJ0OwoJICAgICAgLyoqKi8KCSAgICB9CgoJICAgIC8qIEZpbmQgdGhlIGxvbmdlc3QgbWF0Y2gsIGRpc2NhcmRpbmcgdGhvc2UgPD0gcHJldl9sZW5ndGguCgkgICAgICogQXQgdGhpcyBwb2ludCB3ZSBoYXZlIGFsd2F5cyBtYXRjaF9sZW5ndGggPCBNSU5fTUFUQ0gKCSAgICAgKi8KCSAgICBpZiAoaGFzaF9oZWFkICE9PSAwLypOSUwqLyAmJiAoKHMuc3Ryc3RhcnQgLSBoYXNoX2hlYWQpIDw9IChzLndfc2l6ZSAtIE1JTl9MT09LQUhFQUQpKSkgewoJICAgICAgLyogVG8gc2ltcGxpZnkgdGhlIGNvZGUsIHdlIHByZXZlbnQgbWF0Y2hlcyB3aXRoIHRoZSBzdHJpbmcKCSAgICAgICAqIG9mIHdpbmRvdyBpbmRleCAwIChpbiBwYXJ0aWN1bGFyIHdlIGhhdmUgdG8gYXZvaWQgYSBtYXRjaAoJICAgICAgICogb2YgdGhlIHN0cmluZyB3aXRoIGl0c2VsZiBhdCB0aGUgc3RhcnQgb2YgdGhlIGlucHV0IGZpbGUpLgoJICAgICAgICovCgkgICAgICBzLm1hdGNoX2xlbmd0aCA9IGxvbmdlc3RfbWF0Y2gocywgaGFzaF9oZWFkKTsKCSAgICAgIC8qIGxvbmdlc3RfbWF0Y2goKSBzZXRzIG1hdGNoX3N0YXJ0ICovCgkgICAgfQoJICAgIGlmIChzLm1hdGNoX2xlbmd0aCA+PSBNSU5fTUFUQ0gpIHsKCSAgICAgIC8vIGNoZWNrX21hdGNoKHMsIHMuc3Ryc3RhcnQsIHMubWF0Y2hfc3RhcnQsIHMubWF0Y2hfbGVuZ3RoKTsgLy8gZm9yIGRlYnVnIG9ubHkKCgkgICAgICAvKioqIF90cl90YWxseV9kaXN0KHMsIHMuc3Ryc3RhcnQgLSBzLm1hdGNoX3N0YXJ0LAoJICAgICAgICAgICAgICAgICAgICAgcy5tYXRjaF9sZW5ndGggLSBNSU5fTUFUQ0gsIGJmbHVzaCk7ICoqKi8KCSAgICAgIGJmbHVzaCA9IHRyZWVzLl90cl90YWxseShzLCBzLnN0cnN0YXJ0IC0gcy5tYXRjaF9zdGFydCwgcy5tYXRjaF9sZW5ndGggLSBNSU5fTUFUQ0gpOwoKCSAgICAgIHMubG9va2FoZWFkIC09IHMubWF0Y2hfbGVuZ3RoOwoKCSAgICAgIC8qIEluc2VydCBuZXcgc3RyaW5ncyBpbiB0aGUgaGFzaCB0YWJsZSBvbmx5IGlmIHRoZSBtYXRjaCBsZW5ndGgKCSAgICAgICAqIGlzIG5vdCB0b28gbGFyZ2UuIFRoaXMgc2F2ZXMgdGltZSBidXQgZGVncmFkZXMgY29tcHJlc3Npb24uCgkgICAgICAgKi8KCSAgICAgIGlmIChzLm1hdGNoX2xlbmd0aCA8PSBzLm1heF9sYXp5X21hdGNoLyptYXhfaW5zZXJ0X2xlbmd0aCovICYmIHMubG9va2FoZWFkID49IE1JTl9NQVRDSCkgewoJICAgICAgICBzLm1hdGNoX2xlbmd0aC0tOyAvKiBzdHJpbmcgYXQgc3Ryc3RhcnQgYWxyZWFkeSBpbiB0YWJsZSAqLwoJICAgICAgICBkbyB7CgkgICAgICAgICAgcy5zdHJzdGFydCsrOwoJICAgICAgICAgIC8qKiogSU5TRVJUX1NUUklORyhzLCBzLnN0cnN0YXJ0LCBoYXNoX2hlYWQpOyAqKiovCgkgICAgICAgICAgcy5pbnNfaCA9ICgocy5pbnNfaCA8PCBzLmhhc2hfc2hpZnQpIF4gcy53aW5kb3dbcy5zdHJzdGFydCArIE1JTl9NQVRDSCAtIDFdKSAmIHMuaGFzaF9tYXNrOwoJICAgICAgICAgIGhhc2hfaGVhZCA9IHMucHJldltzLnN0cnN0YXJ0ICYgcy53X21hc2tdID0gcy5oZWFkW3MuaW5zX2hdOwoJICAgICAgICAgIHMuaGVhZFtzLmluc19oXSA9IHMuc3Ryc3RhcnQ7CgkgICAgICAgICAgLyoqKi8KCSAgICAgICAgICAvKiBzdHJzdGFydCBuZXZlciBleGNlZWRzIFdTSVpFLU1BWF9NQVRDSCwgc28gdGhlcmUgYXJlCgkgICAgICAgICAgICogYWx3YXlzIE1JTl9NQVRDSCBieXRlcyBhaGVhZC4KCSAgICAgICAgICAgKi8KCSAgICAgICAgfSB3aGlsZSAoLS1zLm1hdGNoX2xlbmd0aCAhPT0gMCk7CgkgICAgICAgIHMuc3Ryc3RhcnQrKzsKCSAgICAgIH0gZWxzZQoJICAgICAgewoJICAgICAgICBzLnN0cnN0YXJ0ICs9IHMubWF0Y2hfbGVuZ3RoOwoJICAgICAgICBzLm1hdGNoX2xlbmd0aCA9IDA7CgkgICAgICAgIHMuaW5zX2ggPSBzLndpbmRvd1tzLnN0cnN0YXJ0XTsKCSAgICAgICAgLyogVVBEQVRFX0hBU0gocywgcy5pbnNfaCwgcy53aW5kb3dbcy5zdHJzdGFydCsxXSk7ICovCgkgICAgICAgIHMuaW5zX2ggPSAoKHMuaW5zX2ggPDwgcy5oYXNoX3NoaWZ0KSBeIHMud2luZG93W3Muc3Ryc3RhcnQgKyAxXSkgJiBzLmhhc2hfbWFzazsKCgkvLyNpZiBNSU5fTUFUQ0ggIT0gMwoJLy8gICAgICAgICAgICAgICAgQ2FsbCBVUERBVEVfSEFTSCgpIE1JTl9NQVRDSC0zIG1vcmUgdGltZXMKCS8vI2VuZGlmCgkgICAgICAgIC8qIElmIGxvb2thaGVhZCA8IE1JTl9NQVRDSCwgaW5zX2ggaXMgZ2FyYmFnZSwgYnV0IGl0IGRvZXMgbm90CgkgICAgICAgICAqIG1hdHRlciBzaW5jZSBpdCB3aWxsIGJlIHJlY29tcHV0ZWQgYXQgbmV4dCBkZWZsYXRlIGNhbGwuCgkgICAgICAgICAqLwoJICAgICAgfQoJICAgIH0gZWxzZSB7CgkgICAgICAvKiBObyBtYXRjaCwgb3V0cHV0IGEgbGl0ZXJhbCBieXRlICovCgkgICAgICAvL1RyYWNldnYoKHN0ZGVyciwiJWMiLCBzLndpbmRvd1tzLnN0cnN0YXJ0XSkpOwoJICAgICAgLyoqKiBfdHJfdGFsbHlfbGl0KHMsIHMud2luZG93W3Muc3Ryc3RhcnRdLCBiZmx1c2gpOyAqKiovCgkgICAgICBiZmx1c2ggPSB0cmVlcy5fdHJfdGFsbHkocywgMCwgcy53aW5kb3dbcy5zdHJzdGFydF0pOwoKCSAgICAgIHMubG9va2FoZWFkLS07CgkgICAgICBzLnN0cnN0YXJ0Kys7CgkgICAgfQoJICAgIGlmIChiZmx1c2gpIHsKCSAgICAgIC8qKiogRkxVU0hfQkxPQ0socywgMCk7ICoqKi8KCSAgICAgIGZsdXNoX2Jsb2NrX29ubHkocywgZmFsc2UpOwoJICAgICAgaWYgKHMuc3RybS5hdmFpbF9vdXQgPT09IDApIHsKCSAgICAgICAgcmV0dXJuIEJTX05FRURfTU9SRTsKCSAgICAgIH0KCSAgICAgIC8qKiovCgkgICAgfQoJICB9CgkgIHMuaW5zZXJ0ID0gKChzLnN0cnN0YXJ0IDwgKE1JTl9NQVRDSCAtIDEpKSA/IHMuc3Ryc3RhcnQgOiBNSU5fTUFUQ0ggLSAxKTsKCSAgaWYgKGZsdXNoID09PSBaX0ZJTklTSCkgewoJICAgIC8qKiogRkxVU0hfQkxPQ0socywgMSk7ICoqKi8KCSAgICBmbHVzaF9ibG9ja19vbmx5KHMsIHRydWUpOwoJICAgIGlmIChzLnN0cm0uYXZhaWxfb3V0ID09PSAwKSB7CgkgICAgICByZXR1cm4gQlNfRklOSVNIX1NUQVJURUQ7CgkgICAgfQoJICAgIC8qKiovCgkgICAgcmV0dXJuIEJTX0ZJTklTSF9ET05FOwoJICB9CgkgIGlmIChzLmxhc3RfbGl0KSB7CgkgICAgLyoqKiBGTFVTSF9CTE9DSyhzLCAwKTsgKioqLwoJICAgIGZsdXNoX2Jsb2NrX29ubHkocywgZmFsc2UpOwoJICAgIGlmIChzLnN0cm0uYXZhaWxfb3V0ID09PSAwKSB7CgkgICAgICByZXR1cm4gQlNfTkVFRF9NT1JFOwoJICAgIH0KCSAgICAvKioqLwoJICB9CgkgIHJldHVybiBCU19CTE9DS19ET05FOwoJfQoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogU2FtZSBhcyBhYm92ZSwgYnV0IGFjaGlldmVzIGJldHRlciBjb21wcmVzc2lvbi4gV2UgdXNlIGEgbGF6eQoJICogZXZhbHVhdGlvbiBmb3IgbWF0Y2hlczogYSBtYXRjaCBpcyBmaW5hbGx5IGFkb3B0ZWQgb25seSBpZiB0aGVyZSBpcwoJICogbm8gYmV0dGVyIG1hdGNoIGF0IHRoZSBuZXh0IHdpbmRvdyBwb3NpdGlvbi4KCSAqLwoJZnVuY3Rpb24gZGVmbGF0ZV9zbG93KHMsIGZsdXNoKSB7CgkgIHZhciBoYXNoX2hlYWQ7ICAgICAgICAgIC8qIGhlYWQgb2YgaGFzaCBjaGFpbiAqLwoJICB2YXIgYmZsdXNoOyAgICAgICAgICAgICAgLyogc2V0IGlmIGN1cnJlbnQgYmxvY2sgbXVzdCBiZSBmbHVzaGVkICovCgoJICB2YXIgbWF4X2luc2VydDsKCgkgIC8qIFByb2Nlc3MgdGhlIGlucHV0IGJsb2NrLiAqLwoJICBmb3IgKDs7KSB7CgkgICAgLyogTWFrZSBzdXJlIHRoYXQgd2UgYWx3YXlzIGhhdmUgZW5vdWdoIGxvb2thaGVhZCwgZXhjZXB0CgkgICAgICogYXQgdGhlIGVuZCBvZiB0aGUgaW5wdXQgZmlsZS4gV2UgbmVlZCBNQVhfTUFUQ0ggYnl0ZXMKCSAgICAgKiBmb3IgdGhlIG5leHQgbWF0Y2gsIHBsdXMgTUlOX01BVENIIGJ5dGVzIHRvIGluc2VydCB0aGUKCSAgICAgKiBzdHJpbmcgZm9sbG93aW5nIHRoZSBuZXh0IG1hdGNoLgoJICAgICAqLwoJICAgIGlmIChzLmxvb2thaGVhZCA8IE1JTl9MT09LQUhFQUQpIHsKCSAgICAgIGZpbGxfd2luZG93KHMpOwoJICAgICAgaWYgKHMubG9va2FoZWFkIDwgTUlOX0xPT0tBSEVBRCAmJiBmbHVzaCA9PT0gWl9OT19GTFVTSCkgewoJICAgICAgICByZXR1cm4gQlNfTkVFRF9NT1JFOwoJICAgICAgfQoJICAgICAgaWYgKHMubG9va2FoZWFkID09PSAwKSB7IGJyZWFrOyB9IC8qIGZsdXNoIHRoZSBjdXJyZW50IGJsb2NrICovCgkgICAgfQoKCSAgICAvKiBJbnNlcnQgdGhlIHN0cmluZyB3aW5kb3dbc3Ryc3RhcnQgLi4gc3Ryc3RhcnQrMl0gaW4gdGhlCgkgICAgICogZGljdGlvbmFyeSwgYW5kIHNldCBoYXNoX2hlYWQgdG8gdGhlIGhlYWQgb2YgdGhlIGhhc2ggY2hhaW46CgkgICAgICovCgkgICAgaGFzaF9oZWFkID0gMC8qTklMKi87CgkgICAgaWYgKHMubG9va2FoZWFkID49IE1JTl9NQVRDSCkgewoJICAgICAgLyoqKiBJTlNFUlRfU1RSSU5HKHMsIHMuc3Ryc3RhcnQsIGhhc2hfaGVhZCk7ICoqKi8KCSAgICAgIHMuaW5zX2ggPSAoKHMuaW5zX2ggPDwgcy5oYXNoX3NoaWZ0KSBeIHMud2luZG93W3Muc3Ryc3RhcnQgKyBNSU5fTUFUQ0ggLSAxXSkgJiBzLmhhc2hfbWFzazsKCSAgICAgIGhhc2hfaGVhZCA9IHMucHJldltzLnN0cnN0YXJ0ICYgcy53X21hc2tdID0gcy5oZWFkW3MuaW5zX2hdOwoJICAgICAgcy5oZWFkW3MuaW5zX2hdID0gcy5zdHJzdGFydDsKCSAgICAgIC8qKiovCgkgICAgfQoKCSAgICAvKiBGaW5kIHRoZSBsb25nZXN0IG1hdGNoLCBkaXNjYXJkaW5nIHRob3NlIDw9IHByZXZfbGVuZ3RoLgoJICAgICAqLwoJICAgIHMucHJldl9sZW5ndGggPSBzLm1hdGNoX2xlbmd0aDsKCSAgICBzLnByZXZfbWF0Y2ggPSBzLm1hdGNoX3N0YXJ0OwoJICAgIHMubWF0Y2hfbGVuZ3RoID0gTUlOX01BVENIIC0gMTsKCgkgICAgaWYgKGhhc2hfaGVhZCAhPT0gMC8qTklMKi8gJiYgcy5wcmV2X2xlbmd0aCA8IHMubWF4X2xhenlfbWF0Y2ggJiYKCSAgICAgICAgcy5zdHJzdGFydCAtIGhhc2hfaGVhZCA8PSAocy53X3NpemUgLSBNSU5fTE9PS0FIRUFEKS8qTUFYX0RJU1QocykqLykgewoJICAgICAgLyogVG8gc2ltcGxpZnkgdGhlIGNvZGUsIHdlIHByZXZlbnQgbWF0Y2hlcyB3aXRoIHRoZSBzdHJpbmcKCSAgICAgICAqIG9mIHdpbmRvdyBpbmRleCAwIChpbiBwYXJ0aWN1bGFyIHdlIGhhdmUgdG8gYXZvaWQgYSBtYXRjaAoJICAgICAgICogb2YgdGhlIHN0cmluZyB3aXRoIGl0c2VsZiBhdCB0aGUgc3RhcnQgb2YgdGhlIGlucHV0IGZpbGUpLgoJICAgICAgICovCgkgICAgICBzLm1hdGNoX2xlbmd0aCA9IGxvbmdlc3RfbWF0Y2gocywgaGFzaF9oZWFkKTsKCSAgICAgIC8qIGxvbmdlc3RfbWF0Y2goKSBzZXRzIG1hdGNoX3N0YXJ0ICovCgoJICAgICAgaWYgKHMubWF0Y2hfbGVuZ3RoIDw9IDUgJiYKCSAgICAgICAgIChzLnN0cmF0ZWd5ID09PSBaX0ZJTFRFUkVEIHx8IChzLm1hdGNoX2xlbmd0aCA9PT0gTUlOX01BVENIICYmIHMuc3Ryc3RhcnQgLSBzLm1hdGNoX3N0YXJ0ID4gNDA5Ni8qVE9PX0ZBUiovKSkpIHsKCgkgICAgICAgIC8qIElmIHByZXZfbWF0Y2ggaXMgYWxzbyBNSU5fTUFUQ0gsIG1hdGNoX3N0YXJ0IGlzIGdhcmJhZ2UKCSAgICAgICAgICogYnV0IHdlIHdpbGwgaWdub3JlIHRoZSBjdXJyZW50IG1hdGNoIGFueXdheS4KCSAgICAgICAgICovCgkgICAgICAgIHMubWF0Y2hfbGVuZ3RoID0gTUlOX01BVENIIC0gMTsKCSAgICAgIH0KCSAgICB9CgkgICAgLyogSWYgdGhlcmUgd2FzIGEgbWF0Y2ggYXQgdGhlIHByZXZpb3VzIHN0ZXAgYW5kIHRoZSBjdXJyZW50CgkgICAgICogbWF0Y2ggaXMgbm90IGJldHRlciwgb3V0cHV0IHRoZSBwcmV2aW91cyBtYXRjaDoKCSAgICAgKi8KCSAgICBpZiAocy5wcmV2X2xlbmd0aCA+PSBNSU5fTUFUQ0ggJiYgcy5tYXRjaF9sZW5ndGggPD0gcy5wcmV2X2xlbmd0aCkgewoJICAgICAgbWF4X2luc2VydCA9IHMuc3Ryc3RhcnQgKyBzLmxvb2thaGVhZCAtIE1JTl9NQVRDSDsKCSAgICAgIC8qIERvIG5vdCBpbnNlcnQgc3RyaW5ncyBpbiBoYXNoIHRhYmxlIGJleW9uZCB0aGlzLiAqLwoKCSAgICAgIC8vY2hlY2tfbWF0Y2gocywgcy5zdHJzdGFydC0xLCBzLnByZXZfbWF0Y2gsIHMucHJldl9sZW5ndGgpOwoKCSAgICAgIC8qKipfdHJfdGFsbHlfZGlzdChzLCBzLnN0cnN0YXJ0IC0gMSAtIHMucHJldl9tYXRjaCwKCSAgICAgICAgICAgICAgICAgICAgIHMucHJldl9sZW5ndGggLSBNSU5fTUFUQ0gsIGJmbHVzaCk7KioqLwoJICAgICAgYmZsdXNoID0gdHJlZXMuX3RyX3RhbGx5KHMsIHMuc3Ryc3RhcnQgLSAxIC0gcy5wcmV2X21hdGNoLCBzLnByZXZfbGVuZ3RoIC0gTUlOX01BVENIKTsKCSAgICAgIC8qIEluc2VydCBpbiBoYXNoIHRhYmxlIGFsbCBzdHJpbmdzIHVwIHRvIHRoZSBlbmQgb2YgdGhlIG1hdGNoLgoJICAgICAgICogc3Ryc3RhcnQtMSBhbmQgc3Ryc3RhcnQgYXJlIGFscmVhZHkgaW5zZXJ0ZWQuIElmIHRoZXJlIGlzIG5vdAoJICAgICAgICogZW5vdWdoIGxvb2thaGVhZCwgdGhlIGxhc3QgdHdvIHN0cmluZ3MgYXJlIG5vdCBpbnNlcnRlZCBpbgoJICAgICAgICogdGhlIGhhc2ggdGFibGUuCgkgICAgICAgKi8KCSAgICAgIHMubG9va2FoZWFkIC09IHMucHJldl9sZW5ndGggLSAxOwoJICAgICAgcy5wcmV2X2xlbmd0aCAtPSAyOwoJICAgICAgZG8gewoJICAgICAgICBpZiAoKytzLnN0cnN0YXJ0IDw9IG1heF9pbnNlcnQpIHsKCSAgICAgICAgICAvKioqIElOU0VSVF9TVFJJTkcocywgcy5zdHJzdGFydCwgaGFzaF9oZWFkKTsgKioqLwoJICAgICAgICAgIHMuaW5zX2ggPSAoKHMuaW5zX2ggPDwgcy5oYXNoX3NoaWZ0KSBeIHMud2luZG93W3Muc3Ryc3RhcnQgKyBNSU5fTUFUQ0ggLSAxXSkgJiBzLmhhc2hfbWFzazsKCSAgICAgICAgICBoYXNoX2hlYWQgPSBzLnByZXZbcy5zdHJzdGFydCAmIHMud19tYXNrXSA9IHMuaGVhZFtzLmluc19oXTsKCSAgICAgICAgICBzLmhlYWRbcy5pbnNfaF0gPSBzLnN0cnN0YXJ0OwoJICAgICAgICAgIC8qKiovCgkgICAgICAgIH0KCSAgICAgIH0gd2hpbGUgKC0tcy5wcmV2X2xlbmd0aCAhPT0gMCk7CgkgICAgICBzLm1hdGNoX2F2YWlsYWJsZSA9IDA7CgkgICAgICBzLm1hdGNoX2xlbmd0aCA9IE1JTl9NQVRDSCAtIDE7CgkgICAgICBzLnN0cnN0YXJ0Kys7CgoJICAgICAgaWYgKGJmbHVzaCkgewoJICAgICAgICAvKioqIEZMVVNIX0JMT0NLKHMsIDApOyAqKiovCgkgICAgICAgIGZsdXNoX2Jsb2NrX29ubHkocywgZmFsc2UpOwoJICAgICAgICBpZiAocy5zdHJtLmF2YWlsX291dCA9PT0gMCkgewoJICAgICAgICAgIHJldHVybiBCU19ORUVEX01PUkU7CgkgICAgICAgIH0KCSAgICAgICAgLyoqKi8KCSAgICAgIH0KCgkgICAgfSBlbHNlIGlmIChzLm1hdGNoX2F2YWlsYWJsZSkgewoJICAgICAgLyogSWYgdGhlcmUgd2FzIG5vIG1hdGNoIGF0IHRoZSBwcmV2aW91cyBwb3NpdGlvbiwgb3V0cHV0IGEKCSAgICAgICAqIHNpbmdsZSBsaXRlcmFsLiBJZiB0aGVyZSB3YXMgYSBtYXRjaCBidXQgdGhlIGN1cnJlbnQgbWF0Y2gKCSAgICAgICAqIGlzIGxvbmdlciwgdHJ1bmNhdGUgdGhlIHByZXZpb3VzIG1hdGNoIHRvIGEgc2luZ2xlIGxpdGVyYWwuCgkgICAgICAgKi8KCSAgICAgIC8vVHJhY2V2digoc3RkZXJyLCIlYyIsIHMtPndpbmRvd1tzLT5zdHJzdGFydC0xXSkpOwoJICAgICAgLyoqKiBfdHJfdGFsbHlfbGl0KHMsIHMud2luZG93W3Muc3Ryc3RhcnQtMV0sIGJmbHVzaCk7ICoqKi8KCSAgICAgIGJmbHVzaCA9IHRyZWVzLl90cl90YWxseShzLCAwLCBzLndpbmRvd1tzLnN0cnN0YXJ0IC0gMV0pOwoKCSAgICAgIGlmIChiZmx1c2gpIHsKCSAgICAgICAgLyoqKiBGTFVTSF9CTE9DS19PTkxZKHMsIDApICoqKi8KCSAgICAgICAgZmx1c2hfYmxvY2tfb25seShzLCBmYWxzZSk7CgkgICAgICAgIC8qKiovCgkgICAgICB9CgkgICAgICBzLnN0cnN0YXJ0Kys7CgkgICAgICBzLmxvb2thaGVhZC0tOwoJICAgICAgaWYgKHMuc3RybS5hdmFpbF9vdXQgPT09IDApIHsKCSAgICAgICAgcmV0dXJuIEJTX05FRURfTU9SRTsKCSAgICAgIH0KCSAgICB9IGVsc2UgewoJICAgICAgLyogVGhlcmUgaXMgbm8gcHJldmlvdXMgbWF0Y2ggdG8gY29tcGFyZSB3aXRoLCB3YWl0IGZvcgoJICAgICAgICogdGhlIG5leHQgc3RlcCB0byBkZWNpZGUuCgkgICAgICAgKi8KCSAgICAgIHMubWF0Y2hfYXZhaWxhYmxlID0gMTsKCSAgICAgIHMuc3Ryc3RhcnQrKzsKCSAgICAgIHMubG9va2FoZWFkLS07CgkgICAgfQoJICB9CgkgIC8vQXNzZXJ0IChmbHVzaCAhPSBaX05PX0ZMVVNILCAibm8gZmx1c2g/Iik7CgkgIGlmIChzLm1hdGNoX2F2YWlsYWJsZSkgewoJICAgIC8vVHJhY2V2digoc3RkZXJyLCIlYyIsIHMtPndpbmRvd1tzLT5zdHJzdGFydC0xXSkpOwoJICAgIC8qKiogX3RyX3RhbGx5X2xpdChzLCBzLndpbmRvd1tzLnN0cnN0YXJ0LTFdLCBiZmx1c2gpOyAqKiovCgkgICAgYmZsdXNoID0gdHJlZXMuX3RyX3RhbGx5KHMsIDAsIHMud2luZG93W3Muc3Ryc3RhcnQgLSAxXSk7CgoJICAgIHMubWF0Y2hfYXZhaWxhYmxlID0gMDsKCSAgfQoJICBzLmluc2VydCA9IHMuc3Ryc3RhcnQgPCBNSU5fTUFUQ0ggLSAxID8gcy5zdHJzdGFydCA6IE1JTl9NQVRDSCAtIDE7CgkgIGlmIChmbHVzaCA9PT0gWl9GSU5JU0gpIHsKCSAgICAvKioqIEZMVVNIX0JMT0NLKHMsIDEpOyAqKiovCgkgICAgZmx1c2hfYmxvY2tfb25seShzLCB0cnVlKTsKCSAgICBpZiAocy5zdHJtLmF2YWlsX291dCA9PT0gMCkgewoJICAgICAgcmV0dXJuIEJTX0ZJTklTSF9TVEFSVEVEOwoJICAgIH0KCSAgICAvKioqLwoJICAgIHJldHVybiBCU19GSU5JU0hfRE9ORTsKCSAgfQoJICBpZiAocy5sYXN0X2xpdCkgewoJICAgIC8qKiogRkxVU0hfQkxPQ0socywgMCk7ICoqKi8KCSAgICBmbHVzaF9ibG9ja19vbmx5KHMsIGZhbHNlKTsKCSAgICBpZiAocy5zdHJtLmF2YWlsX291dCA9PT0gMCkgewoJICAgICAgcmV0dXJuIEJTX05FRURfTU9SRTsKCSAgICB9CgkgICAgLyoqKi8KCSAgfQoKCSAgcmV0dXJuIEJTX0JMT0NLX0RPTkU7Cgl9CgoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogRm9yIFpfUkxFLCBzaW1wbHkgbG9vayBmb3IgcnVucyBvZiBieXRlcywgZ2VuZXJhdGUgbWF0Y2hlcyBvbmx5IG9mIGRpc3RhbmNlCgkgKiBvbmUuICBEbyBub3QgbWFpbnRhaW4gYSBoYXNoIHRhYmxlLiAgKEl0IHdpbGwgYmUgcmVnZW5lcmF0ZWQgaWYgdGhpcyBydW4gb2YKCSAqIGRlZmxhdGUgc3dpdGNoZXMgYXdheSBmcm9tIFpfUkxFLikKCSAqLwoJZnVuY3Rpb24gZGVmbGF0ZV9ybGUocywgZmx1c2gpIHsKCSAgdmFyIGJmbHVzaDsgICAgICAgICAgICAvKiBzZXQgaWYgY3VycmVudCBibG9jayBtdXN0IGJlIGZsdXNoZWQgKi8KCSAgdmFyIHByZXY7ICAgICAgICAgICAgICAvKiBieXRlIGF0IGRpc3RhbmNlIG9uZSB0byBtYXRjaCAqLwoJICB2YXIgc2Nhbiwgc3RyZW5kOyAgICAgIC8qIHNjYW4gZ29lcyB1cCB0byBzdHJlbmQgZm9yIGxlbmd0aCBvZiBydW4gKi8KCgkgIHZhciBfd2luID0gcy53aW5kb3c7CgoJICBmb3IgKDs7KSB7CgkgICAgLyogTWFrZSBzdXJlIHRoYXQgd2UgYWx3YXlzIGhhdmUgZW5vdWdoIGxvb2thaGVhZCwgZXhjZXB0CgkgICAgICogYXQgdGhlIGVuZCBvZiB0aGUgaW5wdXQgZmlsZS4gV2UgbmVlZCBNQVhfTUFUQ0ggYnl0ZXMKCSAgICAgKiBmb3IgdGhlIGxvbmdlc3QgcnVuLCBwbHVzIG9uZSBmb3IgdGhlIHVucm9sbGVkIGxvb3AuCgkgICAgICovCgkgICAgaWYgKHMubG9va2FoZWFkIDw9IE1BWF9NQVRDSCkgewoJICAgICAgZmlsbF93aW5kb3cocyk7CgkgICAgICBpZiAocy5sb29rYWhlYWQgPD0gTUFYX01BVENIICYmIGZsdXNoID09PSBaX05PX0ZMVVNIKSB7CgkgICAgICAgIHJldHVybiBCU19ORUVEX01PUkU7CgkgICAgICB9CgkgICAgICBpZiAocy5sb29rYWhlYWQgPT09IDApIHsgYnJlYWs7IH0gLyogZmx1c2ggdGhlIGN1cnJlbnQgYmxvY2sgKi8KCSAgICB9CgoJICAgIC8qIFNlZSBob3cgbWFueSB0aW1lcyB0aGUgcHJldmlvdXMgYnl0ZSByZXBlYXRzICovCgkgICAgcy5tYXRjaF9sZW5ndGggPSAwOwoJICAgIGlmIChzLmxvb2thaGVhZCA+PSBNSU5fTUFUQ0ggJiYgcy5zdHJzdGFydCA+IDApIHsKCSAgICAgIHNjYW4gPSBzLnN0cnN0YXJ0IC0gMTsKCSAgICAgIHByZXYgPSBfd2luW3NjYW5dOwoJICAgICAgaWYgKHByZXYgPT09IF93aW5bKytzY2FuXSAmJiBwcmV2ID09PSBfd2luWysrc2Nhbl0gJiYgcHJldiA9PT0gX3dpblsrK3NjYW5dKSB7CgkgICAgICAgIHN0cmVuZCA9IHMuc3Ryc3RhcnQgKyBNQVhfTUFUQ0g7CgkgICAgICAgIGRvIHsKCSAgICAgICAgICAvKmpzaGludCBub2VtcHR5OmZhbHNlKi8KCSAgICAgICAgfSB3aGlsZSAocHJldiA9PT0gX3dpblsrK3NjYW5dICYmIHByZXYgPT09IF93aW5bKytzY2FuXSAmJgoJICAgICAgICAgICAgICAgICBwcmV2ID09PSBfd2luWysrc2Nhbl0gJiYgcHJldiA9PT0gX3dpblsrK3NjYW5dICYmCgkgICAgICAgICAgICAgICAgIHByZXYgPT09IF93aW5bKytzY2FuXSAmJiBwcmV2ID09PSBfd2luWysrc2Nhbl0gJiYKCSAgICAgICAgICAgICAgICAgcHJldiA9PT0gX3dpblsrK3NjYW5dICYmIHByZXYgPT09IF93aW5bKytzY2FuXSAmJgoJICAgICAgICAgICAgICAgICBzY2FuIDwgc3RyZW5kKTsKCSAgICAgICAgcy5tYXRjaF9sZW5ndGggPSBNQVhfTUFUQ0ggLSAoc3RyZW5kIC0gc2Nhbik7CgkgICAgICAgIGlmIChzLm1hdGNoX2xlbmd0aCA+IHMubG9va2FoZWFkKSB7CgkgICAgICAgICAgcy5tYXRjaF9sZW5ndGggPSBzLmxvb2thaGVhZDsKCSAgICAgICAgfQoJICAgICAgfQoJICAgICAgLy9Bc3NlcnQoc2NhbiA8PSBzLT53aW5kb3crKHVJbnQpKHMtPndpbmRvd19zaXplLTEpLCAid2lsZCBzY2FuIik7CgkgICAgfQoKCSAgICAvKiBFbWl0IG1hdGNoIGlmIGhhdmUgcnVuIG9mIE1JTl9NQVRDSCBvciBsb25nZXIsIGVsc2UgZW1pdCBsaXRlcmFsICovCgkgICAgaWYgKHMubWF0Y2hfbGVuZ3RoID49IE1JTl9NQVRDSCkgewoJICAgICAgLy9jaGVja19tYXRjaChzLCBzLnN0cnN0YXJ0LCBzLnN0cnN0YXJ0IC0gMSwgcy5tYXRjaF9sZW5ndGgpOwoKCSAgICAgIC8qKiogX3RyX3RhbGx5X2Rpc3QocywgMSwgcy5tYXRjaF9sZW5ndGggLSBNSU5fTUFUQ0gsIGJmbHVzaCk7ICoqKi8KCSAgICAgIGJmbHVzaCA9IHRyZWVzLl90cl90YWxseShzLCAxLCBzLm1hdGNoX2xlbmd0aCAtIE1JTl9NQVRDSCk7CgoJICAgICAgcy5sb29rYWhlYWQgLT0gcy5tYXRjaF9sZW5ndGg7CgkgICAgICBzLnN0cnN0YXJ0ICs9IHMubWF0Y2hfbGVuZ3RoOwoJICAgICAgcy5tYXRjaF9sZW5ndGggPSAwOwoJICAgIH0gZWxzZSB7CgkgICAgICAvKiBObyBtYXRjaCwgb3V0cHV0IGEgbGl0ZXJhbCBieXRlICovCgkgICAgICAvL1RyYWNldnYoKHN0ZGVyciwiJWMiLCBzLT53aW5kb3dbcy0+c3Ryc3RhcnRdKSk7CgkgICAgICAvKioqIF90cl90YWxseV9saXQocywgcy53aW5kb3dbcy5zdHJzdGFydF0sIGJmbHVzaCk7ICoqKi8KCSAgICAgIGJmbHVzaCA9IHRyZWVzLl90cl90YWxseShzLCAwLCBzLndpbmRvd1tzLnN0cnN0YXJ0XSk7CgoJICAgICAgcy5sb29rYWhlYWQtLTsKCSAgICAgIHMuc3Ryc3RhcnQrKzsKCSAgICB9CgkgICAgaWYgKGJmbHVzaCkgewoJICAgICAgLyoqKiBGTFVTSF9CTE9DSyhzLCAwKTsgKioqLwoJICAgICAgZmx1c2hfYmxvY2tfb25seShzLCBmYWxzZSk7CgkgICAgICBpZiAocy5zdHJtLmF2YWlsX291dCA9PT0gMCkgewoJICAgICAgICByZXR1cm4gQlNfTkVFRF9NT1JFOwoJICAgICAgfQoJICAgICAgLyoqKi8KCSAgICB9CgkgIH0KCSAgcy5pbnNlcnQgPSAwOwoJICBpZiAoZmx1c2ggPT09IFpfRklOSVNIKSB7CgkgICAgLyoqKiBGTFVTSF9CTE9DSyhzLCAxKTsgKioqLwoJICAgIGZsdXNoX2Jsb2NrX29ubHkocywgdHJ1ZSk7CgkgICAgaWYgKHMuc3RybS5hdmFpbF9vdXQgPT09IDApIHsKCSAgICAgIHJldHVybiBCU19GSU5JU0hfU1RBUlRFRDsKCSAgICB9CgkgICAgLyoqKi8KCSAgICByZXR1cm4gQlNfRklOSVNIX0RPTkU7CgkgIH0KCSAgaWYgKHMubGFzdF9saXQpIHsKCSAgICAvKioqIEZMVVNIX0JMT0NLKHMsIDApOyAqKiovCgkgICAgZmx1c2hfYmxvY2tfb25seShzLCBmYWxzZSk7CgkgICAgaWYgKHMuc3RybS5hdmFpbF9vdXQgPT09IDApIHsKCSAgICAgIHJldHVybiBCU19ORUVEX01PUkU7CgkgICAgfQoJICAgIC8qKiovCgkgIH0KCSAgcmV0dXJuIEJTX0JMT0NLX0RPTkU7Cgl9CgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBGb3IgWl9IVUZGTUFOX09OTFksIGRvIG5vdCBsb29rIGZvciBtYXRjaGVzLiAgRG8gbm90IG1haW50YWluIGEgaGFzaCB0YWJsZS4KCSAqIChJdCB3aWxsIGJlIHJlZ2VuZXJhdGVkIGlmIHRoaXMgcnVuIG9mIGRlZmxhdGUgc3dpdGNoZXMgYXdheSBmcm9tIEh1ZmZtYW4uKQoJICovCglmdW5jdGlvbiBkZWZsYXRlX2h1ZmYocywgZmx1c2gpIHsKCSAgdmFyIGJmbHVzaDsgICAgICAgICAgICAgLyogc2V0IGlmIGN1cnJlbnQgYmxvY2sgbXVzdCBiZSBmbHVzaGVkICovCgoJICBmb3IgKDs7KSB7CgkgICAgLyogTWFrZSBzdXJlIHRoYXQgd2UgaGF2ZSBhIGxpdGVyYWwgdG8gd3JpdGUuICovCgkgICAgaWYgKHMubG9va2FoZWFkID09PSAwKSB7CgkgICAgICBmaWxsX3dpbmRvdyhzKTsKCSAgICAgIGlmIChzLmxvb2thaGVhZCA9PT0gMCkgewoJICAgICAgICBpZiAoZmx1c2ggPT09IFpfTk9fRkxVU0gpIHsKCSAgICAgICAgICByZXR1cm4gQlNfTkVFRF9NT1JFOwoJICAgICAgICB9CgkgICAgICAgIGJyZWFrOyAgICAgIC8qIGZsdXNoIHRoZSBjdXJyZW50IGJsb2NrICovCgkgICAgICB9CgkgICAgfQoKCSAgICAvKiBPdXRwdXQgYSBsaXRlcmFsIGJ5dGUgKi8KCSAgICBzLm1hdGNoX2xlbmd0aCA9IDA7CgkgICAgLy9UcmFjZXZ2KChzdGRlcnIsIiVjIiwgcy0+d2luZG93W3MtPnN0cnN0YXJ0XSkpOwoJICAgIC8qKiogX3RyX3RhbGx5X2xpdChzLCBzLndpbmRvd1tzLnN0cnN0YXJ0XSwgYmZsdXNoKTsgKioqLwoJICAgIGJmbHVzaCA9IHRyZWVzLl90cl90YWxseShzLCAwLCBzLndpbmRvd1tzLnN0cnN0YXJ0XSk7CgkgICAgcy5sb29rYWhlYWQtLTsKCSAgICBzLnN0cnN0YXJ0Kys7CgkgICAgaWYgKGJmbHVzaCkgewoJICAgICAgLyoqKiBGTFVTSF9CTE9DSyhzLCAwKTsgKioqLwoJICAgICAgZmx1c2hfYmxvY2tfb25seShzLCBmYWxzZSk7CgkgICAgICBpZiAocy5zdHJtLmF2YWlsX291dCA9PT0gMCkgewoJICAgICAgICByZXR1cm4gQlNfTkVFRF9NT1JFOwoJICAgICAgfQoJICAgICAgLyoqKi8KCSAgICB9CgkgIH0KCSAgcy5pbnNlcnQgPSAwOwoJICBpZiAoZmx1c2ggPT09IFpfRklOSVNIKSB7CgkgICAgLyoqKiBGTFVTSF9CTE9DSyhzLCAxKTsgKioqLwoJICAgIGZsdXNoX2Jsb2NrX29ubHkocywgdHJ1ZSk7CgkgICAgaWYgKHMuc3RybS5hdmFpbF9vdXQgPT09IDApIHsKCSAgICAgIHJldHVybiBCU19GSU5JU0hfU1RBUlRFRDsKCSAgICB9CgkgICAgLyoqKi8KCSAgICByZXR1cm4gQlNfRklOSVNIX0RPTkU7CgkgIH0KCSAgaWYgKHMubGFzdF9saXQpIHsKCSAgICAvKioqIEZMVVNIX0JMT0NLKHMsIDApOyAqKiovCgkgICAgZmx1c2hfYmxvY2tfb25seShzLCBmYWxzZSk7CgkgICAgaWYgKHMuc3RybS5hdmFpbF9vdXQgPT09IDApIHsKCSAgICAgIHJldHVybiBCU19ORUVEX01PUkU7CgkgICAgfQoJICAgIC8qKiovCgkgIH0KCSAgcmV0dXJuIEJTX0JMT0NLX0RPTkU7Cgl9CgoJLyogVmFsdWVzIGZvciBtYXhfbGF6eV9tYXRjaCwgZ29vZF9tYXRjaCBhbmQgbWF4X2NoYWluX2xlbmd0aCwgZGVwZW5kaW5nIG9uCgkgKiB0aGUgZGVzaXJlZCBwYWNrIGxldmVsICgwLi45KS4gVGhlIHZhbHVlcyBnaXZlbiBiZWxvdyBoYXZlIGJlZW4gdHVuZWQgdG8KCSAqIGV4Y2x1ZGUgd29yc3QgY2FzZSBwZXJmb3JtYW5jZSBmb3IgcGF0aG9sb2dpY2FsIGZpbGVzLiBCZXR0ZXIgdmFsdWVzIG1heSBiZQoJICogZm91bmQgZm9yIHNwZWNpZmljIGZpbGVzLgoJICovCglmdW5jdGlvbiBDb25maWcoZ29vZF9sZW5ndGgsIG1heF9sYXp5LCBuaWNlX2xlbmd0aCwgbWF4X2NoYWluLCBmdW5jKSB7CgkgIHRoaXMuZ29vZF9sZW5ndGggPSBnb29kX2xlbmd0aDsKCSAgdGhpcy5tYXhfbGF6eSA9IG1heF9sYXp5OwoJICB0aGlzLm5pY2VfbGVuZ3RoID0gbmljZV9sZW5ndGg7CgkgIHRoaXMubWF4X2NoYWluID0gbWF4X2NoYWluOwoJICB0aGlzLmZ1bmMgPSBmdW5jOwoJfQoKCXZhciBjb25maWd1cmF0aW9uX3RhYmxlOwoKCWNvbmZpZ3VyYXRpb25fdGFibGUgPSBbCgkgIC8qICAgICAgZ29vZCBsYXp5IG5pY2UgY2hhaW4gKi8KCSAgbmV3IENvbmZpZygwLCAwLCAwLCAwLCBkZWZsYXRlX3N0b3JlZCksICAgICAgICAgIC8qIDAgc3RvcmUgb25seSAqLwoJICBuZXcgQ29uZmlnKDQsIDQsIDgsIDQsIGRlZmxhdGVfZmFzdCksICAgICAgICAgICAgLyogMSBtYXggc3BlZWQsIG5vIGxhenkgbWF0Y2hlcyAqLwoJICBuZXcgQ29uZmlnKDQsIDUsIDE2LCA4LCBkZWZsYXRlX2Zhc3QpLCAgICAgICAgICAgLyogMiAqLwoJICBuZXcgQ29uZmlnKDQsIDYsIDMyLCAzMiwgZGVmbGF0ZV9mYXN0KSwgICAgICAgICAgLyogMyAqLwoKCSAgbmV3IENvbmZpZyg0LCA0LCAxNiwgMTYsIGRlZmxhdGVfc2xvdyksICAgICAgICAgIC8qIDQgbGF6eSBtYXRjaGVzICovCgkgIG5ldyBDb25maWcoOCwgMTYsIDMyLCAzMiwgZGVmbGF0ZV9zbG93KSwgICAgICAgICAvKiA1ICovCgkgIG5ldyBDb25maWcoOCwgMTYsIDEyOCwgMTI4LCBkZWZsYXRlX3Nsb3cpLCAgICAgICAvKiA2ICovCgkgIG5ldyBDb25maWcoOCwgMzIsIDEyOCwgMjU2LCBkZWZsYXRlX3Nsb3cpLCAgICAgICAvKiA3ICovCgkgIG5ldyBDb25maWcoMzIsIDEyOCwgMjU4LCAxMDI0LCBkZWZsYXRlX3Nsb3cpLCAgICAvKiA4ICovCgkgIG5ldyBDb25maWcoMzIsIDI1OCwgMjU4LCA0MDk2LCBkZWZsYXRlX3Nsb3cpICAgICAvKiA5IG1heCBjb21wcmVzc2lvbiAqLwoJXTsKCgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBJbml0aWFsaXplIHRoZSAibG9uZ2VzdCBtYXRjaCIgcm91dGluZXMgZm9yIGEgbmV3IHpsaWIgc3RyZWFtCgkgKi8KCWZ1bmN0aW9uIGxtX2luaXQocykgewoJICBzLndpbmRvd19zaXplID0gMiAqIHMud19zaXplOwoKCSAgLyoqKiBDTEVBUl9IQVNIKHMpOyAqKiovCgkgIHplcm8ocy5oZWFkKTsgLy8gRmlsbCB3aXRoIE5JTCAoPSAwKTsKCgkgIC8qIFNldCB0aGUgZGVmYXVsdCBjb25maWd1cmF0aW9uIHBhcmFtZXRlcnM6CgkgICAqLwoJICBzLm1heF9sYXp5X21hdGNoID0gY29uZmlndXJhdGlvbl90YWJsZVtzLmxldmVsXS5tYXhfbGF6eTsKCSAgcy5nb29kX21hdGNoID0gY29uZmlndXJhdGlvbl90YWJsZVtzLmxldmVsXS5nb29kX2xlbmd0aDsKCSAgcy5uaWNlX21hdGNoID0gY29uZmlndXJhdGlvbl90YWJsZVtzLmxldmVsXS5uaWNlX2xlbmd0aDsKCSAgcy5tYXhfY2hhaW5fbGVuZ3RoID0gY29uZmlndXJhdGlvbl90YWJsZVtzLmxldmVsXS5tYXhfY2hhaW47CgoJICBzLnN0cnN0YXJ0ID0gMDsKCSAgcy5ibG9ja19zdGFydCA9IDA7CgkgIHMubG9va2FoZWFkID0gMDsKCSAgcy5pbnNlcnQgPSAwOwoJICBzLm1hdGNoX2xlbmd0aCA9IHMucHJldl9sZW5ndGggPSBNSU5fTUFUQ0ggLSAxOwoJICBzLm1hdGNoX2F2YWlsYWJsZSA9IDA7CgkgIHMuaW5zX2ggPSAwOwoJfQoKCglmdW5jdGlvbiBEZWZsYXRlU3RhdGUoKSB7CgkgIHRoaXMuc3RybSA9IG51bGw7ICAgICAgICAgICAgLyogcG9pbnRlciBiYWNrIHRvIHRoaXMgemxpYiBzdHJlYW0gKi8KCSAgdGhpcy5zdGF0dXMgPSAwOyAgICAgICAgICAgIC8qIGFzIHRoZSBuYW1lIGltcGxpZXMgKi8KCSAgdGhpcy5wZW5kaW5nX2J1ZiA9IG51bGw7ICAgICAgLyogb3V0cHV0IHN0aWxsIHBlbmRpbmcgKi8KCSAgdGhpcy5wZW5kaW5nX2J1Zl9zaXplID0gMDsgIC8qIHNpemUgb2YgcGVuZGluZ19idWYgKi8KCSAgdGhpcy5wZW5kaW5nX291dCA9IDA7ICAgICAgIC8qIG5leHQgcGVuZGluZyBieXRlIHRvIG91dHB1dCB0byB0aGUgc3RyZWFtICovCgkgIHRoaXMucGVuZGluZyA9IDA7ICAgICAgICAgICAvKiBuYiBvZiBieXRlcyBpbiB0aGUgcGVuZGluZyBidWZmZXIgKi8KCSAgdGhpcy53cmFwID0gMDsgICAgICAgICAgICAgIC8qIGJpdCAwIHRydWUgZm9yIHpsaWIsIGJpdCAxIHRydWUgZm9yIGd6aXAgKi8KCSAgdGhpcy5nemhlYWQgPSBudWxsOyAgICAgICAgIC8qIGd6aXAgaGVhZGVyIGluZm9ybWF0aW9uIHRvIHdyaXRlICovCgkgIHRoaXMuZ3ppbmRleCA9IDA7ICAgICAgICAgICAvKiB3aGVyZSBpbiBleHRyYSwgbmFtZSwgb3IgY29tbWVudCAqLwoJICB0aGlzLm1ldGhvZCA9IFpfREVGTEFURUQ7IC8qIGNhbiBvbmx5IGJlIERFRkxBVEVEICovCgkgIHRoaXMubGFzdF9mbHVzaCA9IC0xOyAgIC8qIHZhbHVlIG9mIGZsdXNoIHBhcmFtIGZvciBwcmV2aW91cyBkZWZsYXRlIGNhbGwgKi8KCgkgIHRoaXMud19zaXplID0gMDsgIC8qIExaNzcgd2luZG93IHNpemUgKDMySyBieSBkZWZhdWx0KSAqLwoJICB0aGlzLndfYml0cyA9IDA7ICAvKiBsb2cyKHdfc2l6ZSkgICg4Li4xNikgKi8KCSAgdGhpcy53X21hc2sgPSAwOyAgLyogd19zaXplIC0gMSAqLwoKCSAgdGhpcy53aW5kb3cgPSBudWxsOwoJICAvKiBTbGlkaW5nIHdpbmRvdy4gSW5wdXQgYnl0ZXMgYXJlIHJlYWQgaW50byB0aGUgc2Vjb25kIGhhbGYgb2YgdGhlIHdpbmRvdywKCSAgICogYW5kIG1vdmUgdG8gdGhlIGZpcnN0IGhhbGYgbGF0ZXIgdG8ga2VlcCBhIGRpY3Rpb25hcnkgb2YgYXQgbGVhc3Qgd1NpemUKCSAgICogYnl0ZXMuIFdpdGggdGhpcyBvcmdhbml6YXRpb24sIG1hdGNoZXMgYXJlIGxpbWl0ZWQgdG8gYSBkaXN0YW5jZSBvZgoJICAgKiB3U2l6ZS1NQVhfTUFUQ0ggYnl0ZXMsIGJ1dCB0aGlzIGVuc3VyZXMgdGhhdCBJTyBpcyBhbHdheXMKCSAgICogcGVyZm9ybWVkIHdpdGggYSBsZW5ndGggbXVsdGlwbGUgb2YgdGhlIGJsb2NrIHNpemUuCgkgICAqLwoKCSAgdGhpcy53aW5kb3dfc2l6ZSA9IDA7CgkgIC8qIEFjdHVhbCBzaXplIG9mIHdpbmRvdzogMip3U2l6ZSwgZXhjZXB0IHdoZW4gdGhlIHVzZXIgaW5wdXQgYnVmZmVyCgkgICAqIGlzIGRpcmVjdGx5IHVzZWQgYXMgc2xpZGluZyB3aW5kb3cuCgkgICAqLwoKCSAgdGhpcy5wcmV2ID0gbnVsbDsKCSAgLyogTGluayB0byBvbGRlciBzdHJpbmcgd2l0aCBzYW1lIGhhc2ggaW5kZXguIFRvIGxpbWl0IHRoZSBzaXplIG9mIHRoaXMKCSAgICogYXJyYXkgdG8gNjRLLCB0aGlzIGxpbmsgaXMgbWFpbnRhaW5lZCBvbmx5IGZvciB0aGUgbGFzdCAzMksgc3RyaW5ncy4KCSAgICogQW4gaW5kZXggaW4gdGhpcyBhcnJheSBpcyB0aHVzIGEgd2luZG93IGluZGV4IG1vZHVsbyAzMksuCgkgICAqLwoKCSAgdGhpcy5oZWFkID0gbnVsbDsgICAvKiBIZWFkcyBvZiB0aGUgaGFzaCBjaGFpbnMgb3IgTklMLiAqLwoKCSAgdGhpcy5pbnNfaCA9IDA7ICAgICAgIC8qIGhhc2ggaW5kZXggb2Ygc3RyaW5nIHRvIGJlIGluc2VydGVkICovCgkgIHRoaXMuaGFzaF9zaXplID0gMDsgICAvKiBudW1iZXIgb2YgZWxlbWVudHMgaW4gaGFzaCB0YWJsZSAqLwoJICB0aGlzLmhhc2hfYml0cyA9IDA7ICAgLyogbG9nMihoYXNoX3NpemUpICovCgkgIHRoaXMuaGFzaF9tYXNrID0gMDsgICAvKiBoYXNoX3NpemUtMSAqLwoKCSAgdGhpcy5oYXNoX3NoaWZ0ID0gMDsKCSAgLyogTnVtYmVyIG9mIGJpdHMgYnkgd2hpY2ggaW5zX2ggbXVzdCBiZSBzaGlmdGVkIGF0IGVhY2ggaW5wdXQKCSAgICogc3RlcC4gSXQgbXVzdCBiZSBzdWNoIHRoYXQgYWZ0ZXIgTUlOX01BVENIIHN0ZXBzLCB0aGUgb2xkZXN0CgkgICAqIGJ5dGUgbm8gbG9uZ2VyIHRha2VzIHBhcnQgaW4gdGhlIGhhc2gga2V5LCB0aGF0IGlzOgoJICAgKiAgIGhhc2hfc2hpZnQgKiBNSU5fTUFUQ0ggPj0gaGFzaF9iaXRzCgkgICAqLwoKCSAgdGhpcy5ibG9ja19zdGFydCA9IDA7CgkgIC8qIFdpbmRvdyBwb3NpdGlvbiBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBjdXJyZW50IG91dHB1dCBibG9jay4gR2V0cwoJICAgKiBuZWdhdGl2ZSB3aGVuIHRoZSB3aW5kb3cgaXMgbW92ZWQgYmFja3dhcmRzLgoJICAgKi8KCgkgIHRoaXMubWF0Y2hfbGVuZ3RoID0gMDsgICAgICAvKiBsZW5ndGggb2YgYmVzdCBtYXRjaCAqLwoJICB0aGlzLnByZXZfbWF0Y2ggPSAwOyAgICAgICAgLyogcHJldmlvdXMgbWF0Y2ggKi8KCSAgdGhpcy5tYXRjaF9hdmFpbGFibGUgPSAwOyAgIC8qIHNldCBpZiBwcmV2aW91cyBtYXRjaCBleGlzdHMgKi8KCSAgdGhpcy5zdHJzdGFydCA9IDA7ICAgICAgICAgIC8qIHN0YXJ0IG9mIHN0cmluZyB0byBpbnNlcnQgKi8KCSAgdGhpcy5tYXRjaF9zdGFydCA9IDA7ICAgICAgIC8qIHN0YXJ0IG9mIG1hdGNoaW5nIHN0cmluZyAqLwoJICB0aGlzLmxvb2thaGVhZCA9IDA7ICAgICAgICAgLyogbnVtYmVyIG9mIHZhbGlkIGJ5dGVzIGFoZWFkIGluIHdpbmRvdyAqLwoKCSAgdGhpcy5wcmV2X2xlbmd0aCA9IDA7CgkgIC8qIExlbmd0aCBvZiB0aGUgYmVzdCBtYXRjaCBhdCBwcmV2aW91cyBzdGVwLiBNYXRjaGVzIG5vdCBncmVhdGVyIHRoYW4gdGhpcwoJICAgKiBhcmUgZGlzY2FyZGVkLiBUaGlzIGlzIHVzZWQgaW4gdGhlIGxhenkgbWF0Y2ggZXZhbHVhdGlvbi4KCSAgICovCgoJICB0aGlzLm1heF9jaGFpbl9sZW5ndGggPSAwOwoJICAvKiBUbyBzcGVlZCB1cCBkZWZsYXRpb24sIGhhc2ggY2hhaW5zIGFyZSBuZXZlciBzZWFyY2hlZCBiZXlvbmQgdGhpcwoJICAgKiBsZW5ndGguICBBIGhpZ2hlciBsaW1pdCBpbXByb3ZlcyBjb21wcmVzc2lvbiByYXRpbyBidXQgZGVncmFkZXMgdGhlCgkgICAqIHNwZWVkLgoJICAgKi8KCgkgIHRoaXMubWF4X2xhenlfbWF0Y2ggPSAwOwoJICAvKiBBdHRlbXB0IHRvIGZpbmQgYSBiZXR0ZXIgbWF0Y2ggb25seSB3aGVuIHRoZSBjdXJyZW50IG1hdGNoIGlzIHN0cmljdGx5CgkgICAqIHNtYWxsZXIgdGhhbiB0aGlzIHZhbHVlLiBUaGlzIG1lY2hhbmlzbSBpcyB1c2VkIG9ubHkgZm9yIGNvbXByZXNzaW9uCgkgICAqIGxldmVscyA+PSA0LgoJICAgKi8KCSAgLy8gVGhhdCdzIGFsaWFzIHRvIG1heF9sYXp5X21hdGNoLCBkb24ndCB1c2UgZGlyZWN0bHkKCSAgLy90aGlzLm1heF9pbnNlcnRfbGVuZ3RoID0gMDsKCSAgLyogSW5zZXJ0IG5ldyBzdHJpbmdzIGluIHRoZSBoYXNoIHRhYmxlIG9ubHkgaWYgdGhlIG1hdGNoIGxlbmd0aCBpcyBub3QKCSAgICogZ3JlYXRlciB0aGFuIHRoaXMgbGVuZ3RoLiBUaGlzIHNhdmVzIHRpbWUgYnV0IGRlZ3JhZGVzIGNvbXByZXNzaW9uLgoJICAgKiBtYXhfaW5zZXJ0X2xlbmd0aCBpcyB1c2VkIG9ubHkgZm9yIGNvbXByZXNzaW9uIGxldmVscyA8PSAzLgoJICAgKi8KCgkgIHRoaXMubGV2ZWwgPSAwOyAgICAgLyogY29tcHJlc3Npb24gbGV2ZWwgKDEuLjkpICovCgkgIHRoaXMuc3RyYXRlZ3kgPSAwOyAgLyogZmF2b3Igb3IgZm9yY2UgSHVmZm1hbiBjb2RpbmcqLwoKCSAgdGhpcy5nb29kX21hdGNoID0gMDsKCSAgLyogVXNlIGEgZmFzdGVyIHNlYXJjaCB3aGVuIHRoZSBwcmV2aW91cyBtYXRjaCBpcyBsb25nZXIgdGhhbiB0aGlzICovCgoJICB0aGlzLm5pY2VfbWF0Y2ggPSAwOyAvKiBTdG9wIHNlYXJjaGluZyB3aGVuIGN1cnJlbnQgbWF0Y2ggZXhjZWVkcyB0aGlzICovCgoJICAgICAgICAgICAgICAvKiB1c2VkIGJ5IHRyZWVzLmM6ICovCgoJICAvKiBEaWRuJ3QgdXNlIGN0X2RhdGEgdHlwZWRlZiBiZWxvdyB0byBzdXBwcmVzcyBjb21waWxlciB3YXJuaW5nICovCgoJICAvLyBzdHJ1Y3QgY3RfZGF0YV9zIGR5bl9sdHJlZVtIRUFQX1NJWkVdOyAgIC8qIGxpdGVyYWwgYW5kIGxlbmd0aCB0cmVlICovCgkgIC8vIHN0cnVjdCBjdF9kYXRhX3MgZHluX2R0cmVlWzIqRF9DT0RFUysxXTsgLyogZGlzdGFuY2UgdHJlZSAqLwoJICAvLyBzdHJ1Y3QgY3RfZGF0YV9zIGJsX3RyZWVbMipCTF9DT0RFUysxXTsgIC8qIEh1ZmZtYW4gdHJlZSBmb3IgYml0IGxlbmd0aHMgKi8KCgkgIC8vIFVzZSBmbGF0IGFycmF5IG9mIERPVUJMRSBzaXplLCB3aXRoIGludGVybGVhdmVkIGZhdGEsCgkgIC8vIGJlY2F1c2UgSlMgZG9lcyBub3Qgc3VwcG9ydCBlZmZlY3RpdmUKCSAgdGhpcy5keW5fbHRyZWUgID0gbmV3IHV0aWxzLkJ1ZjE2KEhFQVBfU0laRSAqIDIpOwoJICB0aGlzLmR5bl9kdHJlZSAgPSBuZXcgdXRpbHMuQnVmMTYoKDIgKiBEX0NPREVTICsgMSkgKiAyKTsKCSAgdGhpcy5ibF90cmVlICAgID0gbmV3IHV0aWxzLkJ1ZjE2KCgyICogQkxfQ09ERVMgKyAxKSAqIDIpOwoJICB6ZXJvKHRoaXMuZHluX2x0cmVlKTsKCSAgemVybyh0aGlzLmR5bl9kdHJlZSk7CgkgIHplcm8odGhpcy5ibF90cmVlKTsKCgkgIHRoaXMubF9kZXNjICAgPSBudWxsOyAgICAgICAgIC8qIGRlc2MuIGZvciBsaXRlcmFsIHRyZWUgKi8KCSAgdGhpcy5kX2Rlc2MgICA9IG51bGw7ICAgICAgICAgLyogZGVzYy4gZm9yIGRpc3RhbmNlIHRyZWUgKi8KCSAgdGhpcy5ibF9kZXNjICA9IG51bGw7ICAgICAgICAgLyogZGVzYy4gZm9yIGJpdCBsZW5ndGggdHJlZSAqLwoKCSAgLy91c2ggYmxfY291bnRbTUFYX0JJVFMrMV07CgkgIHRoaXMuYmxfY291bnQgPSBuZXcgdXRpbHMuQnVmMTYoTUFYX0JJVFMgKyAxKTsKCSAgLyogbnVtYmVyIG9mIGNvZGVzIGF0IGVhY2ggYml0IGxlbmd0aCBmb3IgYW4gb3B0aW1hbCB0cmVlICovCgoJICAvL2ludCBoZWFwWzIqTF9DT0RFUysxXTsgICAgICAvKiBoZWFwIHVzZWQgdG8gYnVpbGQgdGhlIEh1ZmZtYW4gdHJlZXMgKi8KCSAgdGhpcy5oZWFwID0gbmV3IHV0aWxzLkJ1ZjE2KDIgKiBMX0NPREVTICsgMSk7ICAvKiBoZWFwIHVzZWQgdG8gYnVpbGQgdGhlIEh1ZmZtYW4gdHJlZXMgKi8KCSAgemVybyh0aGlzLmhlYXApOwoKCSAgdGhpcy5oZWFwX2xlbiA9IDA7ICAgICAgICAgICAgICAgLyogbnVtYmVyIG9mIGVsZW1lbnRzIGluIHRoZSBoZWFwICovCgkgIHRoaXMuaGVhcF9tYXggPSAwOyAgICAgICAgICAgICAgIC8qIGVsZW1lbnQgb2YgbGFyZ2VzdCBmcmVxdWVuY3kgKi8KCSAgLyogVGhlIHNvbnMgb2YgaGVhcFtuXSBhcmUgaGVhcFsyKm5dIGFuZCBoZWFwWzIqbisxXS4gaGVhcFswXSBpcyBub3QgdXNlZC4KCSAgICogVGhlIHNhbWUgaGVhcCBhcnJheSBpcyB1c2VkIHRvIGJ1aWxkIGFsbCB0cmVlcy4KCSAgICovCgoJICB0aGlzLmRlcHRoID0gbmV3IHV0aWxzLkJ1ZjE2KDIgKiBMX0NPREVTICsgMSk7IC8vdWNoIGRlcHRoWzIqTF9DT0RFUysxXTsKCSAgemVybyh0aGlzLmRlcHRoKTsKCSAgLyogRGVwdGggb2YgZWFjaCBzdWJ0cmVlIHVzZWQgYXMgdGllIGJyZWFrZXIgZm9yIHRyZWVzIG9mIGVxdWFsIGZyZXF1ZW5jeQoJICAgKi8KCgkgIHRoaXMubF9idWYgPSAwOyAgICAgICAgICAvKiBidWZmZXIgaW5kZXggZm9yIGxpdGVyYWxzIG9yIGxlbmd0aHMgKi8KCgkgIHRoaXMubGl0X2J1ZnNpemUgPSAwOwoJICAvKiBTaXplIG9mIG1hdGNoIGJ1ZmZlciBmb3IgbGl0ZXJhbHMvbGVuZ3Rocy4gIFRoZXJlIGFyZSA0IHJlYXNvbnMgZm9yCgkgICAqIGxpbWl0aW5nIGxpdF9idWZzaXplIHRvIDY0SzoKCSAgICogICAtIGZyZXF1ZW5jaWVzIGNhbiBiZSBrZXB0IGluIDE2IGJpdCBjb3VudGVycwoJICAgKiAgIC0gaWYgY29tcHJlc3Npb24gaXMgbm90IHN1Y2Nlc3NmdWwgZm9yIHRoZSBmaXJzdCBibG9jaywgYWxsIGlucHV0CgkgICAqICAgICBkYXRhIGlzIHN0aWxsIGluIHRoZSB3aW5kb3cgc28gd2UgY2FuIHN0aWxsIGVtaXQgYSBzdG9yZWQgYmxvY2sgZXZlbgoJICAgKiAgICAgd2hlbiBpbnB1dCBjb21lcyBmcm9tIHN0YW5kYXJkIGlucHV0LiAgKFRoaXMgY2FuIGFsc28gYmUgZG9uZSBmb3IKCSAgICogICAgIGFsbCBibG9ja3MgaWYgbGl0X2J1ZnNpemUgaXMgbm90IGdyZWF0ZXIgdGhhbiAzMksuKQoJICAgKiAgIC0gaWYgY29tcHJlc3Npb24gaXMgbm90IHN1Y2Nlc3NmdWwgZm9yIGEgZmlsZSBzbWFsbGVyIHRoYW4gNjRLLCB3ZSBjYW4KCSAgICogICAgIGV2ZW4gZW1pdCBhIHN0b3JlZCBmaWxlIGluc3RlYWQgb2YgYSBzdG9yZWQgYmxvY2sgKHNhdmluZyA1IGJ5dGVzKS4KCSAgICogICAgIFRoaXMgaXMgYXBwbGljYWJsZSBvbmx5IGZvciB6aXAgKG5vdCBnemlwIG9yIHpsaWIpLgoJICAgKiAgIC0gY3JlYXRpbmcgbmV3IEh1ZmZtYW4gdHJlZXMgbGVzcyBmcmVxdWVudGx5IG1heSBub3QgcHJvdmlkZSBmYXN0CgkgICAqICAgICBhZGFwdGF0aW9uIHRvIGNoYW5nZXMgaW4gdGhlIGlucHV0IGRhdGEgc3RhdGlzdGljcy4gKFRha2UgZm9yCgkgICAqICAgICBleGFtcGxlIGEgYmluYXJ5IGZpbGUgd2l0aCBwb29ybHkgY29tcHJlc3NpYmxlIGNvZGUgZm9sbG93ZWQgYnkKCSAgICogICAgIGEgaGlnaGx5IGNvbXByZXNzaWJsZSBzdHJpbmcgdGFibGUuKSBTbWFsbGVyIGJ1ZmZlciBzaXplcyBnaXZlCgkgICAqICAgICBmYXN0IGFkYXB0YXRpb24gYnV0IGhhdmUgb2YgY291cnNlIHRoZSBvdmVyaGVhZCBvZiB0cmFuc21pdHRpbmcKCSAgICogICAgIHRyZWVzIG1vcmUgZnJlcXVlbnRseS4KCSAgICogICAtIEkgY2FuJ3QgY291bnQgYWJvdmUgNAoJICAgKi8KCgkgIHRoaXMubGFzdF9saXQgPSAwOyAgICAgIC8qIHJ1bm5pbmcgaW5kZXggaW4gbF9idWYgKi8KCgkgIHRoaXMuZF9idWYgPSAwOwoJICAvKiBCdWZmZXIgaW5kZXggZm9yIGRpc3RhbmNlcy4gVG8gc2ltcGxpZnkgdGhlIGNvZGUsIGRfYnVmIGFuZCBsX2J1ZiBoYXZlCgkgICAqIHRoZSBzYW1lIG51bWJlciBvZiBlbGVtZW50cy4gVG8gdXNlIGRpZmZlcmVudCBsZW5ndGhzLCBhbiBleHRyYSBmbGFnCgkgICAqIGFycmF5IHdvdWxkIGJlIG5lY2Vzc2FyeS4KCSAgICovCgoJICB0aGlzLm9wdF9sZW4gPSAwOyAgICAgICAvKiBiaXQgbGVuZ3RoIG9mIGN1cnJlbnQgYmxvY2sgd2l0aCBvcHRpbWFsIHRyZWVzICovCgkgIHRoaXMuc3RhdGljX2xlbiA9IDA7ICAgIC8qIGJpdCBsZW5ndGggb2YgY3VycmVudCBibG9jayB3aXRoIHN0YXRpYyB0cmVlcyAqLwoJICB0aGlzLm1hdGNoZXMgPSAwOyAgICAgICAvKiBudW1iZXIgb2Ygc3RyaW5nIG1hdGNoZXMgaW4gY3VycmVudCBibG9jayAqLwoJICB0aGlzLmluc2VydCA9IDA7ICAgICAgICAvKiBieXRlcyBhdCBlbmQgb2Ygd2luZG93IGxlZnQgdG8gaW5zZXJ0ICovCgoKCSAgdGhpcy5iaV9idWYgPSAwOwoJICAvKiBPdXRwdXQgYnVmZmVyLiBiaXRzIGFyZSBpbnNlcnRlZCBzdGFydGluZyBhdCB0aGUgYm90dG9tIChsZWFzdAoJICAgKiBzaWduaWZpY2FudCBiaXRzKS4KCSAgICovCgkgIHRoaXMuYmlfdmFsaWQgPSAwOwoJICAvKiBOdW1iZXIgb2YgdmFsaWQgYml0cyBpbiBiaV9idWYuICBBbGwgYml0cyBhYm92ZSB0aGUgbGFzdCB2YWxpZCBiaXQKCSAgICogYXJlIGFsd2F5cyB6ZXJvLgoJICAgKi8KCgkgIC8vIFVzZWQgZm9yIHdpbmRvdyBtZW1vcnkgaW5pdC4gV2Ugc2FmZWx5IGlnbm9yZSBpdCBmb3IgSlMuIFRoYXQgbWFrZXMKCSAgLy8gc2Vuc2Ugb25seSBmb3IgcG9pbnRlcnMgYW5kIG1lbW9yeSBjaGVjayB0b29scy4KCSAgLy90aGlzLmhpZ2hfd2F0ZXIgPSAwOwoJICAvKiBIaWdoIHdhdGVyIG1hcmsgb2Zmc2V0IGluIHdpbmRvdyBmb3IgaW5pdGlhbGl6ZWQgYnl0ZXMgLS0gYnl0ZXMgYWJvdmUKCSAgICogdGhpcyBhcmUgc2V0IHRvIHplcm8gaW4gb3JkZXIgdG8gYXZvaWQgbWVtb3J5IGNoZWNrIHdhcm5pbmdzIHdoZW4KCSAgICogbG9uZ2VzdCBtYXRjaCByb3V0aW5lcyBhY2Nlc3MgYnl0ZXMgcGFzdCB0aGUgaW5wdXQuICBUaGlzIGlzIHRoZW4KCSAgICogdXBkYXRlZCB0byB0aGUgbmV3IGhpZ2ggd2F0ZXIgbWFyay4KCSAgICovCgl9CgoKCWZ1bmN0aW9uIGRlZmxhdGVSZXNldEtlZXAoc3RybSkgewoJICB2YXIgczsKCgkgIGlmICghc3RybSB8fCAhc3RybS5zdGF0ZSkgewoJICAgIHJldHVybiBlcnIoc3RybSwgWl9TVFJFQU1fRVJST1IpOwoJICB9CgoJICBzdHJtLnRvdGFsX2luID0gc3RybS50b3RhbF9vdXQgPSAwOwoJICBzdHJtLmRhdGFfdHlwZSA9IFpfVU5LTk9XTjsKCgkgIHMgPSBzdHJtLnN0YXRlOwoJICBzLnBlbmRpbmcgPSAwOwoJICBzLnBlbmRpbmdfb3V0ID0gMDsKCgkgIGlmIChzLndyYXAgPCAwKSB7CgkgICAgcy53cmFwID0gLXMud3JhcDsKCSAgICAvKiB3YXMgbWFkZSBuZWdhdGl2ZSBieSBkZWZsYXRlKC4uLiwgWl9GSU5JU0gpOyAqLwoJICB9CgkgIHMuc3RhdHVzID0gKHMud3JhcCA/IElOSVRfU1RBVEUgOiBCVVNZX1NUQVRFKTsKCSAgc3RybS5hZGxlciA9IChzLndyYXAgPT09IDIpID8KCSAgICAwICAvLyBjcmMzMigwLCBaX05VTEwsIDApCgkgIDoKCSAgICAxOyAvLyBhZGxlcjMyKDAsIFpfTlVMTCwgMCkKCSAgcy5sYXN0X2ZsdXNoID0gWl9OT19GTFVTSDsKCSAgdHJlZXMuX3RyX2luaXQocyk7CgkgIHJldHVybiBaX09LOwoJfQoKCglmdW5jdGlvbiBkZWZsYXRlUmVzZXQoc3RybSkgewoJICB2YXIgcmV0ID0gZGVmbGF0ZVJlc2V0S2VlcChzdHJtKTsKCSAgaWYgKHJldCA9PT0gWl9PSykgewoJICAgIGxtX2luaXQoc3RybS5zdGF0ZSk7CgkgIH0KCSAgcmV0dXJuIHJldDsKCX0KCgoJZnVuY3Rpb24gZGVmbGF0ZVNldEhlYWRlcihzdHJtLCBoZWFkKSB7CgkgIGlmICghc3RybSB8fCAhc3RybS5zdGF0ZSkgeyByZXR1cm4gWl9TVFJFQU1fRVJST1I7IH0KCSAgaWYgKHN0cm0uc3RhdGUud3JhcCAhPT0gMikgeyByZXR1cm4gWl9TVFJFQU1fRVJST1I7IH0KCSAgc3RybS5zdGF0ZS5nemhlYWQgPSBoZWFkOwoJICByZXR1cm4gWl9PSzsKCX0KCgoJZnVuY3Rpb24gZGVmbGF0ZUluaXQyKHN0cm0sIGxldmVsLCBtZXRob2QsIHdpbmRvd0JpdHMsIG1lbUxldmVsLCBzdHJhdGVneSkgewoJICBpZiAoIXN0cm0pIHsgLy8gPT09IFpfTlVMTAoJICAgIHJldHVybiBaX1NUUkVBTV9FUlJPUjsKCSAgfQoJICB2YXIgd3JhcCA9IDE7CgoJICBpZiAobGV2ZWwgPT09IFpfREVGQVVMVF9DT01QUkVTU0lPTikgewoJICAgIGxldmVsID0gNjsKCSAgfQoKCSAgaWYgKHdpbmRvd0JpdHMgPCAwKSB7IC8qIHN1cHByZXNzIHpsaWIgd3JhcHBlciAqLwoJICAgIHdyYXAgPSAwOwoJICAgIHdpbmRvd0JpdHMgPSAtd2luZG93Qml0czsKCSAgfQoKCSAgZWxzZSBpZiAod2luZG93Qml0cyA+IDE1KSB7CgkgICAgd3JhcCA9IDI7ICAgICAgICAgICAvKiB3cml0ZSBnemlwIHdyYXBwZXIgaW5zdGVhZCAqLwoJICAgIHdpbmRvd0JpdHMgLT0gMTY7CgkgIH0KCgoJICBpZiAobWVtTGV2ZWwgPCAxIHx8IG1lbUxldmVsID4gTUFYX01FTV9MRVZFTCB8fCBtZXRob2QgIT09IFpfREVGTEFURUQgfHwKCSAgICB3aW5kb3dCaXRzIDwgOCB8fCB3aW5kb3dCaXRzID4gMTUgfHwgbGV2ZWwgPCAwIHx8IGxldmVsID4gOSB8fAoJICAgIHN0cmF0ZWd5IDwgMCB8fCBzdHJhdGVneSA+IFpfRklYRUQpIHsKCSAgICByZXR1cm4gZXJyKHN0cm0sIFpfU1RSRUFNX0VSUk9SKTsKCSAgfQoKCgkgIGlmICh3aW5kb3dCaXRzID09PSA4KSB7CgkgICAgd2luZG93Qml0cyA9IDk7CgkgIH0KCSAgLyogdW50aWwgMjU2LWJ5dGUgd2luZG93IGJ1ZyBmaXhlZCAqLwoKCSAgdmFyIHMgPSBuZXcgRGVmbGF0ZVN0YXRlKCk7CgoJICBzdHJtLnN0YXRlID0gczsKCSAgcy5zdHJtID0gc3RybTsKCgkgIHMud3JhcCA9IHdyYXA7CgkgIHMuZ3poZWFkID0gbnVsbDsKCSAgcy53X2JpdHMgPSB3aW5kb3dCaXRzOwoJICBzLndfc2l6ZSA9IDEgPDwgcy53X2JpdHM7CgkgIHMud19tYXNrID0gcy53X3NpemUgLSAxOwoKCSAgcy5oYXNoX2JpdHMgPSBtZW1MZXZlbCArIDc7CgkgIHMuaGFzaF9zaXplID0gMSA8PCBzLmhhc2hfYml0czsKCSAgcy5oYXNoX21hc2sgPSBzLmhhc2hfc2l6ZSAtIDE7CgkgIHMuaGFzaF9zaGlmdCA9IH5+KChzLmhhc2hfYml0cyArIE1JTl9NQVRDSCAtIDEpIC8gTUlOX01BVENIKTsKCgkgIHMud2luZG93ID0gbmV3IHV0aWxzLkJ1Zjgocy53X3NpemUgKiAyKTsKCSAgcy5oZWFkID0gbmV3IHV0aWxzLkJ1ZjE2KHMuaGFzaF9zaXplKTsKCSAgcy5wcmV2ID0gbmV3IHV0aWxzLkJ1ZjE2KHMud19zaXplKTsKCgkgIC8vIERvbid0IG5lZWQgbWVtIGluaXQgbWFnaWMgZm9yIEpTLgoJICAvL3MuaGlnaF93YXRlciA9IDA7ICAvKiBub3RoaW5nIHdyaXR0ZW4gdG8gcy0+d2luZG93IHlldCAqLwoKCSAgcy5saXRfYnVmc2l6ZSA9IDEgPDwgKG1lbUxldmVsICsgNik7IC8qIDE2SyBlbGVtZW50cyBieSBkZWZhdWx0ICovCgoJICBzLnBlbmRpbmdfYnVmX3NpemUgPSBzLmxpdF9idWZzaXplICogNDsKCgkgIC8vb3ZlcmxheSA9ICh1c2hmICopIFpBTExPQyhzdHJtLCBzLT5saXRfYnVmc2l6ZSwgc2l6ZW9mKHVzaCkrMik7CgkgIC8vcy0+cGVuZGluZ19idWYgPSAodWNoZiAqKSBvdmVybGF5OwoJICBzLnBlbmRpbmdfYnVmID0gbmV3IHV0aWxzLkJ1Zjgocy5wZW5kaW5nX2J1Zl9zaXplKTsKCgkgIC8vIEl0IGlzIG9mZnNldCBmcm9tIGBzLnBlbmRpbmdfYnVmYCAoc2l6ZSBpcyBgcy5saXRfYnVmc2l6ZSAqIDJgKQoJICAvL3MtPmRfYnVmID0gb3ZlcmxheSArIHMtPmxpdF9idWZzaXplL3NpemVvZih1c2gpOwoJICBzLmRfYnVmID0gMSAqIHMubGl0X2J1ZnNpemU7CgoJICAvL3MtPmxfYnVmID0gcy0+cGVuZGluZ19idWYgKyAoMStzaXplb2YodXNoKSkqcy0+bGl0X2J1ZnNpemU7CgkgIHMubF9idWYgPSAoMSArIDIpICogcy5saXRfYnVmc2l6ZTsKCgkgIHMubGV2ZWwgPSBsZXZlbDsKCSAgcy5zdHJhdGVneSA9IHN0cmF0ZWd5OwoJICBzLm1ldGhvZCA9IG1ldGhvZDsKCgkgIHJldHVybiBkZWZsYXRlUmVzZXQoc3RybSk7Cgl9CgoJZnVuY3Rpb24gZGVmbGF0ZUluaXQoc3RybSwgbGV2ZWwpIHsKCSAgcmV0dXJuIGRlZmxhdGVJbml0MihzdHJtLCBsZXZlbCwgWl9ERUZMQVRFRCwgTUFYX1dCSVRTLCBERUZfTUVNX0xFVkVMLCBaX0RFRkFVTFRfU1RSQVRFR1kpOwoJfQoKCglmdW5jdGlvbiBkZWZsYXRlKHN0cm0sIGZsdXNoKSB7CgkgIHZhciBvbGRfZmx1c2gsIHM7CgkgIHZhciBiZWcsIHZhbDsgLy8gZm9yIGd6aXAgaGVhZGVyIHdyaXRlIG9ubHkKCgkgIGlmICghc3RybSB8fCAhc3RybS5zdGF0ZSB8fAoJICAgIGZsdXNoID4gWl9CTE9DSyB8fCBmbHVzaCA8IDApIHsKCSAgICByZXR1cm4gc3RybSA/IGVycihzdHJtLCBaX1NUUkVBTV9FUlJPUikgOiBaX1NUUkVBTV9FUlJPUjsKCSAgfQoKCSAgcyA9IHN0cm0uc3RhdGU7CgoJICBpZiAoIXN0cm0ub3V0cHV0IHx8CgkgICAgICAoIXN0cm0uaW5wdXQgJiYgc3RybS5hdmFpbF9pbiAhPT0gMCkgfHwKCSAgICAgIChzLnN0YXR1cyA9PT0gRklOSVNIX1NUQVRFICYmIGZsdXNoICE9PSBaX0ZJTklTSCkpIHsKCSAgICByZXR1cm4gZXJyKHN0cm0sIChzdHJtLmF2YWlsX291dCA9PT0gMCkgPyBaX0JVRl9FUlJPUiA6IFpfU1RSRUFNX0VSUk9SKTsKCSAgfQoKCSAgcy5zdHJtID0gc3RybTsgLyoganVzdCBpbiBjYXNlICovCgkgIG9sZF9mbHVzaCA9IHMubGFzdF9mbHVzaDsKCSAgcy5sYXN0X2ZsdXNoID0gZmx1c2g7CgoJICAvKiBXcml0ZSB0aGUgaGVhZGVyICovCgkgIGlmIChzLnN0YXR1cyA9PT0gSU5JVF9TVEFURSkgewoKCSAgICBpZiAocy53cmFwID09PSAyKSB7IC8vIEdaSVAgaGVhZGVyCgkgICAgICBzdHJtLmFkbGVyID0gMDsgIC8vY3JjMzIoMEwsIFpfTlVMTCwgMCk7CgkgICAgICBwdXRfYnl0ZShzLCAzMSk7CgkgICAgICBwdXRfYnl0ZShzLCAxMzkpOwoJICAgICAgcHV0X2J5dGUocywgOCk7CgkgICAgICBpZiAoIXMuZ3poZWFkKSB7IC8vIHMtPmd6aGVhZCA9PSBaX05VTEwKCSAgICAgICAgcHV0X2J5dGUocywgMCk7CgkgICAgICAgIHB1dF9ieXRlKHMsIDApOwoJICAgICAgICBwdXRfYnl0ZShzLCAwKTsKCSAgICAgICAgcHV0X2J5dGUocywgMCk7CgkgICAgICAgIHB1dF9ieXRlKHMsIDApOwoJICAgICAgICBwdXRfYnl0ZShzLCBzLmxldmVsID09PSA5ID8gMiA6CgkgICAgICAgICAgICAgICAgICAgIChzLnN0cmF0ZWd5ID49IFpfSFVGRk1BTl9PTkxZIHx8IHMubGV2ZWwgPCAyID8KCSAgICAgICAgICAgICAgICAgICAgIDQgOiAwKSk7CgkgICAgICAgIHB1dF9ieXRlKHMsIE9TX0NPREUpOwoJICAgICAgICBzLnN0YXR1cyA9IEJVU1lfU1RBVEU7CgkgICAgICB9CgkgICAgICBlbHNlIHsKCSAgICAgICAgcHV0X2J5dGUocywgKHMuZ3poZWFkLnRleHQgPyAxIDogMCkgKwoJICAgICAgICAgICAgICAgICAgICAocy5nemhlYWQuaGNyYyA/IDIgOiAwKSArCgkgICAgICAgICAgICAgICAgICAgICghcy5nemhlYWQuZXh0cmEgPyAwIDogNCkgKwoJICAgICAgICAgICAgICAgICAgICAoIXMuZ3poZWFkLm5hbWUgPyAwIDogOCkgKwoJICAgICAgICAgICAgICAgICAgICAoIXMuZ3poZWFkLmNvbW1lbnQgPyAwIDogMTYpCgkgICAgICAgICAgICAgICAgKTsKCSAgICAgICAgcHV0X2J5dGUocywgcy5nemhlYWQudGltZSAmIDB4ZmYpOwoJICAgICAgICBwdXRfYnl0ZShzLCAocy5nemhlYWQudGltZSA+PiA4KSAmIDB4ZmYpOwoJICAgICAgICBwdXRfYnl0ZShzLCAocy5nemhlYWQudGltZSA+PiAxNikgJiAweGZmKTsKCSAgICAgICAgcHV0X2J5dGUocywgKHMuZ3poZWFkLnRpbWUgPj4gMjQpICYgMHhmZik7CgkgICAgICAgIHB1dF9ieXRlKHMsIHMubGV2ZWwgPT09IDkgPyAyIDoKCSAgICAgICAgICAgICAgICAgICAgKHMuc3RyYXRlZ3kgPj0gWl9IVUZGTUFOX09OTFkgfHwgcy5sZXZlbCA8IDIgPwoJICAgICAgICAgICAgICAgICAgICAgNCA6IDApKTsKCSAgICAgICAgcHV0X2J5dGUocywgcy5nemhlYWQub3MgJiAweGZmKTsKCSAgICAgICAgaWYgKHMuZ3poZWFkLmV4dHJhICYmIHMuZ3poZWFkLmV4dHJhLmxlbmd0aCkgewoJICAgICAgICAgIHB1dF9ieXRlKHMsIHMuZ3poZWFkLmV4dHJhLmxlbmd0aCAmIDB4ZmYpOwoJICAgICAgICAgIHB1dF9ieXRlKHMsIChzLmd6aGVhZC5leHRyYS5sZW5ndGggPj4gOCkgJiAweGZmKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAocy5nemhlYWQuaGNyYykgewoJICAgICAgICAgIHN0cm0uYWRsZXIgPSBjcmMzMihzdHJtLmFkbGVyLCBzLnBlbmRpbmdfYnVmLCBzLnBlbmRpbmcsIDApOwoJICAgICAgICB9CgkgICAgICAgIHMuZ3ppbmRleCA9IDA7CgkgICAgICAgIHMuc3RhdHVzID0gRVhUUkFfU1RBVEU7CgkgICAgICB9CgkgICAgfQoJICAgIGVsc2UgLy8gREVGTEFURSBoZWFkZXIKCSAgICB7CgkgICAgICB2YXIgaGVhZGVyID0gKFpfREVGTEFURUQgKyAoKHMud19iaXRzIC0gOCkgPDwgNCkpIDw8IDg7CgkgICAgICB2YXIgbGV2ZWxfZmxhZ3MgPSAtMTsKCgkgICAgICBpZiAocy5zdHJhdGVneSA+PSBaX0hVRkZNQU5fT05MWSB8fCBzLmxldmVsIDwgMikgewoJICAgICAgICBsZXZlbF9mbGFncyA9IDA7CgkgICAgICB9IGVsc2UgaWYgKHMubGV2ZWwgPCA2KSB7CgkgICAgICAgIGxldmVsX2ZsYWdzID0gMTsKCSAgICAgIH0gZWxzZSBpZiAocy5sZXZlbCA9PT0gNikgewoJICAgICAgICBsZXZlbF9mbGFncyA9IDI7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBsZXZlbF9mbGFncyA9IDM7CgkgICAgICB9CgkgICAgICBoZWFkZXIgfD0gKGxldmVsX2ZsYWdzIDw8IDYpOwoJICAgICAgaWYgKHMuc3Ryc3RhcnQgIT09IDApIHsgaGVhZGVyIHw9IFBSRVNFVF9ESUNUOyB9CgkgICAgICBoZWFkZXIgKz0gMzEgLSAoaGVhZGVyICUgMzEpOwoKCSAgICAgIHMuc3RhdHVzID0gQlVTWV9TVEFURTsKCSAgICAgIHB1dFNob3J0TVNCKHMsIGhlYWRlcik7CgoJICAgICAgLyogU2F2ZSB0aGUgYWRsZXIzMiBvZiB0aGUgcHJlc2V0IGRpY3Rpb25hcnk6ICovCgkgICAgICBpZiAocy5zdHJzdGFydCAhPT0gMCkgewoJICAgICAgICBwdXRTaG9ydE1TQihzLCBzdHJtLmFkbGVyID4+PiAxNik7CgkgICAgICAgIHB1dFNob3J0TVNCKHMsIHN0cm0uYWRsZXIgJiAweGZmZmYpOwoJICAgICAgfQoJICAgICAgc3RybS5hZGxlciA9IDE7IC8vIGFkbGVyMzIoMEwsIFpfTlVMTCwgMCk7CgkgICAgfQoJICB9CgoJLy8jaWZkZWYgR1pJUAoJICBpZiAocy5zdGF0dXMgPT09IEVYVFJBX1NUQVRFKSB7CgkgICAgaWYgKHMuZ3poZWFkLmV4dHJhLyogIT0gWl9OVUxMKi8pIHsKCSAgICAgIGJlZyA9IHMucGVuZGluZzsgIC8qIHN0YXJ0IG9mIGJ5dGVzIHRvIHVwZGF0ZSBjcmMgKi8KCgkgICAgICB3aGlsZSAocy5nemluZGV4IDwgKHMuZ3poZWFkLmV4dHJhLmxlbmd0aCAmIDB4ZmZmZikpIHsKCSAgICAgICAgaWYgKHMucGVuZGluZyA9PT0gcy5wZW5kaW5nX2J1Zl9zaXplKSB7CgkgICAgICAgICAgaWYgKHMuZ3poZWFkLmhjcmMgJiYgcy5wZW5kaW5nID4gYmVnKSB7CgkgICAgICAgICAgICBzdHJtLmFkbGVyID0gY3JjMzIoc3RybS5hZGxlciwgcy5wZW5kaW5nX2J1Ziwgcy5wZW5kaW5nIC0gYmVnLCBiZWcpOwoJICAgICAgICAgIH0KCSAgICAgICAgICBmbHVzaF9wZW5kaW5nKHN0cm0pOwoJICAgICAgICAgIGJlZyA9IHMucGVuZGluZzsKCSAgICAgICAgICBpZiAocy5wZW5kaW5nID09PSBzLnBlbmRpbmdfYnVmX3NpemUpIHsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBwdXRfYnl0ZShzLCBzLmd6aGVhZC5leHRyYVtzLmd6aW5kZXhdICYgMHhmZik7CgkgICAgICAgIHMuZ3ppbmRleCsrOwoJICAgICAgfQoJICAgICAgaWYgKHMuZ3poZWFkLmhjcmMgJiYgcy5wZW5kaW5nID4gYmVnKSB7CgkgICAgICAgIHN0cm0uYWRsZXIgPSBjcmMzMihzdHJtLmFkbGVyLCBzLnBlbmRpbmdfYnVmLCBzLnBlbmRpbmcgLSBiZWcsIGJlZyk7CgkgICAgICB9CgkgICAgICBpZiAocy5nemluZGV4ID09PSBzLmd6aGVhZC5leHRyYS5sZW5ndGgpIHsKCSAgICAgICAgcy5nemluZGV4ID0gMDsKCSAgICAgICAgcy5zdGF0dXMgPSBOQU1FX1NUQVRFOwoJICAgICAgfQoJICAgIH0KCSAgICBlbHNlIHsKCSAgICAgIHMuc3RhdHVzID0gTkFNRV9TVEFURTsKCSAgICB9CgkgIH0KCSAgaWYgKHMuc3RhdHVzID09PSBOQU1FX1NUQVRFKSB7CgkgICAgaWYgKHMuZ3poZWFkLm5hbWUvKiAhPSBaX05VTEwqLykgewoJICAgICAgYmVnID0gcy5wZW5kaW5nOyAgLyogc3RhcnQgb2YgYnl0ZXMgdG8gdXBkYXRlIGNyYyAqLwoJICAgICAgLy9pbnQgdmFsOwoKCSAgICAgIGRvIHsKCSAgICAgICAgaWYgKHMucGVuZGluZyA9PT0gcy5wZW5kaW5nX2J1Zl9zaXplKSB7CgkgICAgICAgICAgaWYgKHMuZ3poZWFkLmhjcmMgJiYgcy5wZW5kaW5nID4gYmVnKSB7CgkgICAgICAgICAgICBzdHJtLmFkbGVyID0gY3JjMzIoc3RybS5hZGxlciwgcy5wZW5kaW5nX2J1Ziwgcy5wZW5kaW5nIC0gYmVnLCBiZWcpOwoJICAgICAgICAgIH0KCSAgICAgICAgICBmbHVzaF9wZW5kaW5nKHN0cm0pOwoJICAgICAgICAgIGJlZyA9IHMucGVuZGluZzsKCSAgICAgICAgICBpZiAocy5wZW5kaW5nID09PSBzLnBlbmRpbmdfYnVmX3NpemUpIHsKCSAgICAgICAgICAgIHZhbCA9IDE7CgkgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSlMgc3BlY2lmaWM6IGxpdHRsZSBtYWdpYyB0byBhZGQgemVybyB0ZXJtaW5hdG9yIHRvIGVuZCBvZiBzdHJpbmcKCSAgICAgICAgaWYgKHMuZ3ppbmRleCA8IHMuZ3poZWFkLm5hbWUubGVuZ3RoKSB7CgkgICAgICAgICAgdmFsID0gcy5nemhlYWQubmFtZS5jaGFyQ29kZUF0KHMuZ3ppbmRleCsrKSAmIDB4ZmY7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgdmFsID0gMDsKCSAgICAgICAgfQoJICAgICAgICBwdXRfYnl0ZShzLCB2YWwpOwoJICAgICAgfSB3aGlsZSAodmFsICE9PSAwKTsKCgkgICAgICBpZiAocy5nemhlYWQuaGNyYyAmJiBzLnBlbmRpbmcgPiBiZWcpIHsKCSAgICAgICAgc3RybS5hZGxlciA9IGNyYzMyKHN0cm0uYWRsZXIsIHMucGVuZGluZ19idWYsIHMucGVuZGluZyAtIGJlZywgYmVnKTsKCSAgICAgIH0KCSAgICAgIGlmICh2YWwgPT09IDApIHsKCSAgICAgICAgcy5nemluZGV4ID0gMDsKCSAgICAgICAgcy5zdGF0dXMgPSBDT01NRU5UX1NUQVRFOwoJICAgICAgfQoJICAgIH0KCSAgICBlbHNlIHsKCSAgICAgIHMuc3RhdHVzID0gQ09NTUVOVF9TVEFURTsKCSAgICB9CgkgIH0KCSAgaWYgKHMuc3RhdHVzID09PSBDT01NRU5UX1NUQVRFKSB7CgkgICAgaWYgKHMuZ3poZWFkLmNvbW1lbnQvKiAhPSBaX05VTEwqLykgewoJICAgICAgYmVnID0gcy5wZW5kaW5nOyAgLyogc3RhcnQgb2YgYnl0ZXMgdG8gdXBkYXRlIGNyYyAqLwoJICAgICAgLy9pbnQgdmFsOwoKCSAgICAgIGRvIHsKCSAgICAgICAgaWYgKHMucGVuZGluZyA9PT0gcy5wZW5kaW5nX2J1Zl9zaXplKSB7CgkgICAgICAgICAgaWYgKHMuZ3poZWFkLmhjcmMgJiYgcy5wZW5kaW5nID4gYmVnKSB7CgkgICAgICAgICAgICBzdHJtLmFkbGVyID0gY3JjMzIoc3RybS5hZGxlciwgcy5wZW5kaW5nX2J1Ziwgcy5wZW5kaW5nIC0gYmVnLCBiZWcpOwoJICAgICAgICAgIH0KCSAgICAgICAgICBmbHVzaF9wZW5kaW5nKHN0cm0pOwoJICAgICAgICAgIGJlZyA9IHMucGVuZGluZzsKCSAgICAgICAgICBpZiAocy5wZW5kaW5nID09PSBzLnBlbmRpbmdfYnVmX3NpemUpIHsKCSAgICAgICAgICAgIHZhbCA9IDE7CgkgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSlMgc3BlY2lmaWM6IGxpdHRsZSBtYWdpYyB0byBhZGQgemVybyB0ZXJtaW5hdG9yIHRvIGVuZCBvZiBzdHJpbmcKCSAgICAgICAgaWYgKHMuZ3ppbmRleCA8IHMuZ3poZWFkLmNvbW1lbnQubGVuZ3RoKSB7CgkgICAgICAgICAgdmFsID0gcy5nemhlYWQuY29tbWVudC5jaGFyQ29kZUF0KHMuZ3ppbmRleCsrKSAmIDB4ZmY7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgdmFsID0gMDsKCSAgICAgICAgfQoJICAgICAgICBwdXRfYnl0ZShzLCB2YWwpOwoJICAgICAgfSB3aGlsZSAodmFsICE9PSAwKTsKCgkgICAgICBpZiAocy5nemhlYWQuaGNyYyAmJiBzLnBlbmRpbmcgPiBiZWcpIHsKCSAgICAgICAgc3RybS5hZGxlciA9IGNyYzMyKHN0cm0uYWRsZXIsIHMucGVuZGluZ19idWYsIHMucGVuZGluZyAtIGJlZywgYmVnKTsKCSAgICAgIH0KCSAgICAgIGlmICh2YWwgPT09IDApIHsKCSAgICAgICAgcy5zdGF0dXMgPSBIQ1JDX1NUQVRFOwoJICAgICAgfQoJICAgIH0KCSAgICBlbHNlIHsKCSAgICAgIHMuc3RhdHVzID0gSENSQ19TVEFURTsKCSAgICB9CgkgIH0KCSAgaWYgKHMuc3RhdHVzID09PSBIQ1JDX1NUQVRFKSB7CgkgICAgaWYgKHMuZ3poZWFkLmhjcmMpIHsKCSAgICAgIGlmIChzLnBlbmRpbmcgKyAyID4gcy5wZW5kaW5nX2J1Zl9zaXplKSB7CgkgICAgICAgIGZsdXNoX3BlbmRpbmcoc3RybSk7CgkgICAgICB9CgkgICAgICBpZiAocy5wZW5kaW5nICsgMiA8PSBzLnBlbmRpbmdfYnVmX3NpemUpIHsKCSAgICAgICAgcHV0X2J5dGUocywgc3RybS5hZGxlciAmIDB4ZmYpOwoJICAgICAgICBwdXRfYnl0ZShzLCAoc3RybS5hZGxlciA+PiA4KSAmIDB4ZmYpOwoJICAgICAgICBzdHJtLmFkbGVyID0gMDsgLy9jcmMzMigwTCwgWl9OVUxMLCAwKTsKCSAgICAgICAgcy5zdGF0dXMgPSBCVVNZX1NUQVRFOwoJICAgICAgfQoJICAgIH0KCSAgICBlbHNlIHsKCSAgICAgIHMuc3RhdHVzID0gQlVTWV9TVEFURTsKCSAgICB9CgkgIH0KCS8vI2VuZGlmCgoJICAvKiBGbHVzaCBhcyBtdWNoIHBlbmRpbmcgb3V0cHV0IGFzIHBvc3NpYmxlICovCgkgIGlmIChzLnBlbmRpbmcgIT09IDApIHsKCSAgICBmbHVzaF9wZW5kaW5nKHN0cm0pOwoJICAgIGlmIChzdHJtLmF2YWlsX291dCA9PT0gMCkgewoJICAgICAgLyogU2luY2UgYXZhaWxfb3V0IGlzIDAsIGRlZmxhdGUgd2lsbCBiZSBjYWxsZWQgYWdhaW4gd2l0aAoJICAgICAgICogbW9yZSBvdXRwdXQgc3BhY2UsIGJ1dCBwb3NzaWJseSB3aXRoIGJvdGggcGVuZGluZyBhbmQKCSAgICAgICAqIGF2YWlsX2luIGVxdWFsIHRvIHplcm8uIFRoZXJlIHdvbid0IGJlIGFueXRoaW5nIHRvIGRvLAoJICAgICAgICogYnV0IHRoaXMgaXMgbm90IGFuIGVycm9yIHNpdHVhdGlvbiBzbyBtYWtlIHN1cmUgd2UKCSAgICAgICAqIHJldHVybiBPSyBpbnN0ZWFkIG9mIEJVRl9FUlJPUiBhdCBuZXh0IGNhbGwgb2YgZGVmbGF0ZToKCSAgICAgICAqLwoJICAgICAgcy5sYXN0X2ZsdXNoID0gLTE7CgkgICAgICByZXR1cm4gWl9PSzsKCSAgICB9CgoJICAgIC8qIE1ha2Ugc3VyZSB0aGVyZSBpcyBzb21ldGhpbmcgdG8gZG8gYW5kIGF2b2lkIGR1cGxpY2F0ZSBjb25zZWN1dGl2ZQoJICAgICAqIGZsdXNoZXMuIEZvciByZXBlYXRlZCBhbmQgdXNlbGVzcyBjYWxscyB3aXRoIFpfRklOSVNILCB3ZSBrZWVwCgkgICAgICogcmV0dXJuaW5nIFpfU1RSRUFNX0VORCBpbnN0ZWFkIG9mIFpfQlVGX0VSUk9SLgoJICAgICAqLwoJICB9IGVsc2UgaWYgKHN0cm0uYXZhaWxfaW4gPT09IDAgJiYgcmFuayhmbHVzaCkgPD0gcmFuayhvbGRfZmx1c2gpICYmCgkgICAgZmx1c2ggIT09IFpfRklOSVNIKSB7CgkgICAgcmV0dXJuIGVycihzdHJtLCBaX0JVRl9FUlJPUik7CgkgIH0KCgkgIC8qIFVzZXIgbXVzdCBub3QgcHJvdmlkZSBtb3JlIGlucHV0IGFmdGVyIHRoZSBmaXJzdCBGSU5JU0g6ICovCgkgIGlmIChzLnN0YXR1cyA9PT0gRklOSVNIX1NUQVRFICYmIHN0cm0uYXZhaWxfaW4gIT09IDApIHsKCSAgICByZXR1cm4gZXJyKHN0cm0sIFpfQlVGX0VSUk9SKTsKCSAgfQoKCSAgLyogU3RhcnQgYSBuZXcgYmxvY2sgb3IgY29udGludWUgdGhlIGN1cnJlbnQgb25lLgoJICAgKi8KCSAgaWYgKHN0cm0uYXZhaWxfaW4gIT09IDAgfHwgcy5sb29rYWhlYWQgIT09IDAgfHwKCSAgICAoZmx1c2ggIT09IFpfTk9fRkxVU0ggJiYgcy5zdGF0dXMgIT09IEZJTklTSF9TVEFURSkpIHsKCSAgICB2YXIgYnN0YXRlID0gKHMuc3RyYXRlZ3kgPT09IFpfSFVGRk1BTl9PTkxZKSA/IGRlZmxhdGVfaHVmZihzLCBmbHVzaCkgOgoJICAgICAgKHMuc3RyYXRlZ3kgPT09IFpfUkxFID8gZGVmbGF0ZV9ybGUocywgZmx1c2gpIDoKCSAgICAgICAgY29uZmlndXJhdGlvbl90YWJsZVtzLmxldmVsXS5mdW5jKHMsIGZsdXNoKSk7CgoJICAgIGlmIChic3RhdGUgPT09IEJTX0ZJTklTSF9TVEFSVEVEIHx8IGJzdGF0ZSA9PT0gQlNfRklOSVNIX0RPTkUpIHsKCSAgICAgIHMuc3RhdHVzID0gRklOSVNIX1NUQVRFOwoJICAgIH0KCSAgICBpZiAoYnN0YXRlID09PSBCU19ORUVEX01PUkUgfHwgYnN0YXRlID09PSBCU19GSU5JU0hfU1RBUlRFRCkgewoJICAgICAgaWYgKHN0cm0uYXZhaWxfb3V0ID09PSAwKSB7CgkgICAgICAgIHMubGFzdF9mbHVzaCA9IC0xOwoJICAgICAgICAvKiBhdm9pZCBCVUZfRVJST1IgbmV4dCBjYWxsLCBzZWUgYWJvdmUgKi8KCSAgICAgIH0KCSAgICAgIHJldHVybiBaX09LOwoJICAgICAgLyogSWYgZmx1c2ggIT0gWl9OT19GTFVTSCAmJiBhdmFpbF9vdXQgPT0gMCwgdGhlIG5leHQgY2FsbAoJICAgICAgICogb2YgZGVmbGF0ZSBzaG91bGQgdXNlIHRoZSBzYW1lIGZsdXNoIHBhcmFtZXRlciB0byBtYWtlIHN1cmUKCSAgICAgICAqIHRoYXQgdGhlIGZsdXNoIGlzIGNvbXBsZXRlLiBTbyB3ZSBkb24ndCBoYXZlIHRvIG91dHB1dCBhbgoJICAgICAgICogZW1wdHkgYmxvY2sgaGVyZSwgdGhpcyB3aWxsIGJlIGRvbmUgYXQgbmV4dCBjYWxsLiBUaGlzIGFsc28KCSAgICAgICAqIGVuc3VyZXMgdGhhdCBmb3IgYSB2ZXJ5IHNtYWxsIG91dHB1dCBidWZmZXIsIHdlIGVtaXQgYXQgbW9zdAoJICAgICAgICogb25lIGVtcHR5IGJsb2NrLgoJICAgICAgICovCgkgICAgfQoJICAgIGlmIChic3RhdGUgPT09IEJTX0JMT0NLX0RPTkUpIHsKCSAgICAgIGlmIChmbHVzaCA9PT0gWl9QQVJUSUFMX0ZMVVNIKSB7CgkgICAgICAgIHRyZWVzLl90cl9hbGlnbihzKTsKCSAgICAgIH0KCSAgICAgIGVsc2UgaWYgKGZsdXNoICE9PSBaX0JMT0NLKSB7IC8qIEZVTExfRkxVU0ggb3IgU1lOQ19GTFVTSCAqLwoKCSAgICAgICAgdHJlZXMuX3RyX3N0b3JlZF9ibG9jayhzLCAwLCAwLCBmYWxzZSk7CgkgICAgICAgIC8qIEZvciBhIGZ1bGwgZmx1c2gsIHRoaXMgZW1wdHkgYmxvY2sgd2lsbCBiZSByZWNvZ25pemVkCgkgICAgICAgICAqIGFzIGEgc3BlY2lhbCBtYXJrZXIgYnkgaW5mbGF0ZV9zeW5jKCkuCgkgICAgICAgICAqLwoJICAgICAgICBpZiAoZmx1c2ggPT09IFpfRlVMTF9GTFVTSCkgewoJICAgICAgICAgIC8qKiogQ0xFQVJfSEFTSChzKTsgKioqLyAgICAgICAgICAgICAvKiBmb3JnZXQgaGlzdG9yeSAqLwoJICAgICAgICAgIHplcm8ocy5oZWFkKTsgLy8gRmlsbCB3aXRoIE5JTCAoPSAwKTsKCgkgICAgICAgICAgaWYgKHMubG9va2FoZWFkID09PSAwKSB7CgkgICAgICAgICAgICBzLnN0cnN0YXJ0ID0gMDsKCSAgICAgICAgICAgIHMuYmxvY2tfc3RhcnQgPSAwOwoJICAgICAgICAgICAgcy5pbnNlcnQgPSAwOwoJICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgfQoJICAgICAgZmx1c2hfcGVuZGluZyhzdHJtKTsKCSAgICAgIGlmIChzdHJtLmF2YWlsX291dCA9PT0gMCkgewoJICAgICAgICBzLmxhc3RfZmx1c2ggPSAtMTsgLyogYXZvaWQgQlVGX0VSUk9SIGF0IG5leHQgY2FsbCwgc2VlIGFib3ZlICovCgkgICAgICAgIHJldHVybiBaX09LOwoJICAgICAgfQoJICAgIH0KCSAgfQoJICAvL0Fzc2VydChzdHJtLT5hdmFpbF9vdXQgPiAwLCAiYnVnMiIpOwoJICAvL2lmIChzdHJtLmF2YWlsX291dCA8PSAwKSB7IHRocm93IG5ldyBFcnJvcigiYnVnMiIpO30KCgkgIGlmIChmbHVzaCAhPT0gWl9GSU5JU0gpIHsgcmV0dXJuIFpfT0s7IH0KCSAgaWYgKHMud3JhcCA8PSAwKSB7IHJldHVybiBaX1NUUkVBTV9FTkQ7IH0KCgkgIC8qIFdyaXRlIHRoZSB0cmFpbGVyICovCgkgIGlmIChzLndyYXAgPT09IDIpIHsKCSAgICBwdXRfYnl0ZShzLCBzdHJtLmFkbGVyICYgMHhmZik7CgkgICAgcHV0X2J5dGUocywgKHN0cm0uYWRsZXIgPj4gOCkgJiAweGZmKTsKCSAgICBwdXRfYnl0ZShzLCAoc3RybS5hZGxlciA+PiAxNikgJiAweGZmKTsKCSAgICBwdXRfYnl0ZShzLCAoc3RybS5hZGxlciA+PiAyNCkgJiAweGZmKTsKCSAgICBwdXRfYnl0ZShzLCBzdHJtLnRvdGFsX2luICYgMHhmZik7CgkgICAgcHV0X2J5dGUocywgKHN0cm0udG90YWxfaW4gPj4gOCkgJiAweGZmKTsKCSAgICBwdXRfYnl0ZShzLCAoc3RybS50b3RhbF9pbiA+PiAxNikgJiAweGZmKTsKCSAgICBwdXRfYnl0ZShzLCAoc3RybS50b3RhbF9pbiA+PiAyNCkgJiAweGZmKTsKCSAgfQoJICBlbHNlCgkgIHsKCSAgICBwdXRTaG9ydE1TQihzLCBzdHJtLmFkbGVyID4+PiAxNik7CgkgICAgcHV0U2hvcnRNU0Iocywgc3RybS5hZGxlciAmIDB4ZmZmZik7CgkgIH0KCgkgIGZsdXNoX3BlbmRpbmcoc3RybSk7CgkgIC8qIElmIGF2YWlsX291dCBpcyB6ZXJvLCB0aGUgYXBwbGljYXRpb24gd2lsbCBjYWxsIGRlZmxhdGUgYWdhaW4KCSAgICogdG8gZmx1c2ggdGhlIHJlc3QuCgkgICAqLwoJICBpZiAocy53cmFwID4gMCkgeyBzLndyYXAgPSAtcy53cmFwOyB9CgkgIC8qIHdyaXRlIHRoZSB0cmFpbGVyIG9ubHkgb25jZSEgKi8KCSAgcmV0dXJuIHMucGVuZGluZyAhPT0gMCA/IFpfT0sgOiBaX1NUUkVBTV9FTkQ7Cgl9CgoJZnVuY3Rpb24gZGVmbGF0ZUVuZChzdHJtKSB7CgkgIHZhciBzdGF0dXM7CgoJICBpZiAoIXN0cm0vKj09IFpfTlVMTCovIHx8ICFzdHJtLnN0YXRlLyo9PSBaX05VTEwqLykgewoJICAgIHJldHVybiBaX1NUUkVBTV9FUlJPUjsKCSAgfQoKCSAgc3RhdHVzID0gc3RybS5zdGF0ZS5zdGF0dXM7CgkgIGlmIChzdGF0dXMgIT09IElOSVRfU1RBVEUgJiYKCSAgICBzdGF0dXMgIT09IEVYVFJBX1NUQVRFICYmCgkgICAgc3RhdHVzICE9PSBOQU1FX1NUQVRFICYmCgkgICAgc3RhdHVzICE9PSBDT01NRU5UX1NUQVRFICYmCgkgICAgc3RhdHVzICE9PSBIQ1JDX1NUQVRFICYmCgkgICAgc3RhdHVzICE9PSBCVVNZX1NUQVRFICYmCgkgICAgc3RhdHVzICE9PSBGSU5JU0hfU1RBVEUKCSAgKSB7CgkgICAgcmV0dXJuIGVycihzdHJtLCBaX1NUUkVBTV9FUlJPUik7CgkgIH0KCgkgIHN0cm0uc3RhdGUgPSBudWxsOwoKCSAgcmV0dXJuIHN0YXR1cyA9PT0gQlVTWV9TVEFURSA/IGVycihzdHJtLCBaX0RBVEFfRVJST1IpIDogWl9PSzsKCX0KCgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogSW5pdGlhbGl6ZXMgdGhlIGNvbXByZXNzaW9uIGRpY3Rpb25hcnkgZnJvbSB0aGUgZ2l2ZW4gYnl0ZQoJICogc2VxdWVuY2Ugd2l0aG91dCBwcm9kdWNpbmcgYW55IGNvbXByZXNzZWQgb3V0cHV0LgoJICovCglmdW5jdGlvbiBkZWZsYXRlU2V0RGljdGlvbmFyeShzdHJtLCBkaWN0aW9uYXJ5KSB7CgkgIHZhciBkaWN0TGVuZ3RoID0gZGljdGlvbmFyeS5sZW5ndGg7CgoJICB2YXIgczsKCSAgdmFyIHN0ciwgbjsKCSAgdmFyIHdyYXA7CgkgIHZhciBhdmFpbDsKCSAgdmFyIG5leHQ7CgkgIHZhciBpbnB1dDsKCSAgdmFyIHRtcERpY3Q7CgoJICBpZiAoIXN0cm0vKj09IFpfTlVMTCovIHx8ICFzdHJtLnN0YXRlLyo9PSBaX05VTEwqLykgewoJICAgIHJldHVybiBaX1NUUkVBTV9FUlJPUjsKCSAgfQoKCSAgcyA9IHN0cm0uc3RhdGU7CgkgIHdyYXAgPSBzLndyYXA7CgoJICBpZiAod3JhcCA9PT0gMiB8fCAod3JhcCA9PT0gMSAmJiBzLnN0YXR1cyAhPT0gSU5JVF9TVEFURSkgfHwgcy5sb29rYWhlYWQpIHsKCSAgICByZXR1cm4gWl9TVFJFQU1fRVJST1I7CgkgIH0KCgkgIC8qIHdoZW4gdXNpbmcgemxpYiB3cmFwcGVycywgY29tcHV0ZSBBZGxlci0zMiBmb3IgcHJvdmlkZWQgZGljdGlvbmFyeSAqLwoJICBpZiAod3JhcCA9PT0gMSkgewoJICAgIC8qIGFkbGVyMzIoc3RybS0+YWRsZXIsIGRpY3Rpb25hcnksIGRpY3RMZW5ndGgpOyAqLwoJICAgIHN0cm0uYWRsZXIgPSBhZGxlcjMyKHN0cm0uYWRsZXIsIGRpY3Rpb25hcnksIGRpY3RMZW5ndGgsIDApOwoJICB9CgoJICBzLndyYXAgPSAwOyAgIC8qIGF2b2lkIGNvbXB1dGluZyBBZGxlci0zMiBpbiByZWFkX2J1ZiAqLwoKCSAgLyogaWYgZGljdGlvbmFyeSB3b3VsZCBmaWxsIHdpbmRvdywganVzdCByZXBsYWNlIHRoZSBoaXN0b3J5ICovCgkgIGlmIChkaWN0TGVuZ3RoID49IHMud19zaXplKSB7CgkgICAgaWYgKHdyYXAgPT09IDApIHsgICAgICAgICAgICAvKiBhbHJlYWR5IGVtcHR5IG90aGVyd2lzZSAqLwoJICAgICAgLyoqKiBDTEVBUl9IQVNIKHMpOyAqKiovCgkgICAgICB6ZXJvKHMuaGVhZCk7IC8vIEZpbGwgd2l0aCBOSUwgKD0gMCk7CgkgICAgICBzLnN0cnN0YXJ0ID0gMDsKCSAgICAgIHMuYmxvY2tfc3RhcnQgPSAwOwoJICAgICAgcy5pbnNlcnQgPSAwOwoJICAgIH0KCSAgICAvKiB1c2UgdGhlIHRhaWwgKi8KCSAgICAvLyBkaWN0aW9uYXJ5ID0gZGljdGlvbmFyeS5zbGljZShkaWN0TGVuZ3RoIC0gcy53X3NpemUpOwoJICAgIHRtcERpY3QgPSBuZXcgdXRpbHMuQnVmOChzLndfc2l6ZSk7CgkgICAgdXRpbHMuYXJyYXlTZXQodG1wRGljdCwgZGljdGlvbmFyeSwgZGljdExlbmd0aCAtIHMud19zaXplLCBzLndfc2l6ZSwgMCk7CgkgICAgZGljdGlvbmFyeSA9IHRtcERpY3Q7CgkgICAgZGljdExlbmd0aCA9IHMud19zaXplOwoJICB9CgkgIC8qIGluc2VydCBkaWN0aW9uYXJ5IGludG8gd2luZG93IGFuZCBoYXNoICovCgkgIGF2YWlsID0gc3RybS5hdmFpbF9pbjsKCSAgbmV4dCA9IHN0cm0ubmV4dF9pbjsKCSAgaW5wdXQgPSBzdHJtLmlucHV0OwoJICBzdHJtLmF2YWlsX2luID0gZGljdExlbmd0aDsKCSAgc3RybS5uZXh0X2luID0gMDsKCSAgc3RybS5pbnB1dCA9IGRpY3Rpb25hcnk7CgkgIGZpbGxfd2luZG93KHMpOwoJICB3aGlsZSAocy5sb29rYWhlYWQgPj0gTUlOX01BVENIKSB7CgkgICAgc3RyID0gcy5zdHJzdGFydDsKCSAgICBuID0gcy5sb29rYWhlYWQgLSAoTUlOX01BVENIIC0gMSk7CgkgICAgZG8gewoJICAgICAgLyogVVBEQVRFX0hBU0gocywgcy0+aW5zX2gsIHMtPndpbmRvd1tzdHIgKyBNSU5fTUFUQ0gtMV0pOyAqLwoJICAgICAgcy5pbnNfaCA9ICgocy5pbnNfaCA8PCBzLmhhc2hfc2hpZnQpIF4gcy53aW5kb3dbc3RyICsgTUlOX01BVENIIC0gMV0pICYgcy5oYXNoX21hc2s7CgoJICAgICAgcy5wcmV2W3N0ciAmIHMud19tYXNrXSA9IHMuaGVhZFtzLmluc19oXTsKCgkgICAgICBzLmhlYWRbcy5pbnNfaF0gPSBzdHI7CgkgICAgICBzdHIrKzsKCSAgICB9IHdoaWxlICgtLW4pOwoJICAgIHMuc3Ryc3RhcnQgPSBzdHI7CgkgICAgcy5sb29rYWhlYWQgPSBNSU5fTUFUQ0ggLSAxOwoJICAgIGZpbGxfd2luZG93KHMpOwoJICB9CgkgIHMuc3Ryc3RhcnQgKz0gcy5sb29rYWhlYWQ7CgkgIHMuYmxvY2tfc3RhcnQgPSBzLnN0cnN0YXJ0OwoJICBzLmluc2VydCA9IHMubG9va2FoZWFkOwoJICBzLmxvb2thaGVhZCA9IDA7CgkgIHMubWF0Y2hfbGVuZ3RoID0gcy5wcmV2X2xlbmd0aCA9IE1JTl9NQVRDSCAtIDE7CgkgIHMubWF0Y2hfYXZhaWxhYmxlID0gMDsKCSAgc3RybS5uZXh0X2luID0gbmV4dDsKCSAgc3RybS5pbnB1dCA9IGlucHV0OwoJICBzdHJtLmF2YWlsX2luID0gYXZhaWw7CgkgIHMud3JhcCA9IHdyYXA7CgkgIHJldHVybiBaX09LOwoJfQoKCglleHBvcnRzLmRlZmxhdGVJbml0ID0gZGVmbGF0ZUluaXQ7CglleHBvcnRzLmRlZmxhdGVJbml0MiA9IGRlZmxhdGVJbml0MjsKCWV4cG9ydHMuZGVmbGF0ZVJlc2V0ID0gZGVmbGF0ZVJlc2V0OwoJZXhwb3J0cy5kZWZsYXRlUmVzZXRLZWVwID0gZGVmbGF0ZVJlc2V0S2VlcDsKCWV4cG9ydHMuZGVmbGF0ZVNldEhlYWRlciA9IGRlZmxhdGVTZXRIZWFkZXI7CglleHBvcnRzLmRlZmxhdGUgPSBkZWZsYXRlOwoJZXhwb3J0cy5kZWZsYXRlRW5kID0gZGVmbGF0ZUVuZDsKCWV4cG9ydHMuZGVmbGF0ZVNldERpY3Rpb25hcnkgPSBkZWZsYXRlU2V0RGljdGlvbmFyeTsKCWV4cG9ydHMuZGVmbGF0ZUluZm8gPSAncGFrbyBkZWZsYXRlIChmcm9tIE5vZGVjYSBwcm9qZWN0KSc7CgoJLyogTm90IGltcGxlbWVudGVkCglleHBvcnRzLmRlZmxhdGVCb3VuZCA9IGRlZmxhdGVCb3VuZDsKCWV4cG9ydHMuZGVmbGF0ZUNvcHkgPSBkZWZsYXRlQ29weTsKCWV4cG9ydHMuZGVmbGF0ZVBhcmFtcyA9IGRlZmxhdGVQYXJhbXM7CglleHBvcnRzLmRlZmxhdGVQZW5kaW5nID0gZGVmbGF0ZVBlbmRpbmc7CglleHBvcnRzLmRlZmxhdGVQcmltZSA9IGRlZmxhdGVQcmltZTsKCWV4cG9ydHMuZGVmbGF0ZVR1bmUgPSBkZWZsYXRlVHVuZTsKCSovCgoKLyoqKi8gfSwKLyogODQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCgl2YXIgVFlQRURfT0sgPSAgKHR5cGVvZiBVaW50OEFycmF5ICE9PSAndW5kZWZpbmVkJykgJiYKCSAgICAgICAgICAgICAgICAodHlwZW9mIFVpbnQxNkFycmF5ICE9PSAndW5kZWZpbmVkJykgJiYKCSAgICAgICAgICAgICAgICAodHlwZW9mIEludDMyQXJyYXkgIT09ICd1bmRlZmluZWQnKTsKCgoJZXhwb3J0cy5hc3NpZ24gPSBmdW5jdGlvbiAob2JqIC8qZnJvbTEsIGZyb20yLCBmcm9tMywgLi4uKi8pIHsKCSAgdmFyIHNvdXJjZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOwoJICB3aGlsZSAoc291cmNlcy5sZW5ndGgpIHsKCSAgICB2YXIgc291cmNlID0gc291cmNlcy5zaGlmdCgpOwoJICAgIGlmICghc291cmNlKSB7IGNvbnRpbnVlOyB9CgoJICAgIGlmICh0eXBlb2Ygc291cmNlICE9PSAnb2JqZWN0JykgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzb3VyY2UgKyAnbXVzdCBiZSBub24tb2JqZWN0Jyk7CgkgICAgfQoKCSAgICBmb3IgKHZhciBwIGluIHNvdXJjZSkgewoJICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwKSkgewoJICAgICAgICBvYmpbcF0gPSBzb3VyY2VbcF07CgkgICAgICB9CgkgICAgfQoJICB9CgoJICByZXR1cm4gb2JqOwoJfTsKCgoJLy8gcmVkdWNlIGJ1ZmZlciBzaXplLCBhdm9pZGluZyBtZW0gY29weQoJZXhwb3J0cy5zaHJpbmtCdWYgPSBmdW5jdGlvbiAoYnVmLCBzaXplKSB7CgkgIGlmIChidWYubGVuZ3RoID09PSBzaXplKSB7IHJldHVybiBidWY7IH0KCSAgaWYgKGJ1Zi5zdWJhcnJheSkgeyByZXR1cm4gYnVmLnN1YmFycmF5KDAsIHNpemUpOyB9CgkgIGJ1Zi5sZW5ndGggPSBzaXplOwoJICByZXR1cm4gYnVmOwoJfTsKCgoJdmFyIGZuVHlwZWQgPSB7CgkgIGFycmF5U2V0OiBmdW5jdGlvbiAoZGVzdCwgc3JjLCBzcmNfb2ZmcywgbGVuLCBkZXN0X29mZnMpIHsKCSAgICBpZiAoc3JjLnN1YmFycmF5ICYmIGRlc3Quc3ViYXJyYXkpIHsKCSAgICAgIGRlc3Quc2V0KHNyYy5zdWJhcnJheShzcmNfb2Zmcywgc3JjX29mZnMgKyBsZW4pLCBkZXN0X29mZnMpOwoJICAgICAgcmV0dXJuOwoJICAgIH0KCSAgICAvLyBGYWxsYmFjayB0byBvcmRpbmFyeSBhcnJheQoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKCSAgICAgIGRlc3RbZGVzdF9vZmZzICsgaV0gPSBzcmNbc3JjX29mZnMgKyBpXTsKCSAgICB9CgkgIH0sCgkgIC8vIEpvaW4gYXJyYXkgb2YgY2h1bmtzIHRvIHNpbmdsZSBhcnJheS4KCSAgZmxhdHRlbkNodW5rczogZnVuY3Rpb24gKGNodW5rcykgewoJICAgIHZhciBpLCBsLCBsZW4sIHBvcywgY2h1bmssIHJlc3VsdDsKCgkgICAgLy8gY2FsY3VsYXRlIGRhdGEgbGVuZ3RoCgkgICAgbGVuID0gMDsKCSAgICBmb3IgKGkgPSAwLCBsID0gY2h1bmtzLmxlbmd0aDsgaSA8IGw7IGkrKykgewoJICAgICAgbGVuICs9IGNodW5rc1tpXS5sZW5ndGg7CgkgICAgfQoKCSAgICAvLyBqb2luIGNodW5rcwoJICAgIHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KGxlbik7CgkgICAgcG9zID0gMDsKCSAgICBmb3IgKGkgPSAwLCBsID0gY2h1bmtzLmxlbmd0aDsgaSA8IGw7IGkrKykgewoJICAgICAgY2h1bmsgPSBjaHVua3NbaV07CgkgICAgICByZXN1bHQuc2V0KGNodW5rLCBwb3MpOwoJICAgICAgcG9zICs9IGNodW5rLmxlbmd0aDsKCSAgICB9CgoJICAgIHJldHVybiByZXN1bHQ7CgkgIH0KCX07CgoJdmFyIGZuVW50eXBlZCA9IHsKCSAgYXJyYXlTZXQ6IGZ1bmN0aW9uIChkZXN0LCBzcmMsIHNyY19vZmZzLCBsZW4sIGRlc3Rfb2ZmcykgewoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKCSAgICAgIGRlc3RbZGVzdF9vZmZzICsgaV0gPSBzcmNbc3JjX29mZnMgKyBpXTsKCSAgICB9CgkgIH0sCgkgIC8vIEpvaW4gYXJyYXkgb2YgY2h1bmtzIHRvIHNpbmdsZSBhcnJheS4KCSAgZmxhdHRlbkNodW5rczogZnVuY3Rpb24gKGNodW5rcykgewoJICAgIHJldHVybiBbXS5jb25jYXQuYXBwbHkoW10sIGNodW5rcyk7CgkgIH0KCX07CgoKCS8vIEVuYWJsZS9EaXNhYmxlIHR5cGVkIGFycmF5cyB1c2UsIGZvciB0ZXN0aW5nCgkvLwoJZXhwb3J0cy5zZXRUeXBlZCA9IGZ1bmN0aW9uIChvbikgewoJICBpZiAob24pIHsKCSAgICBleHBvcnRzLkJ1ZjggID0gVWludDhBcnJheTsKCSAgICBleHBvcnRzLkJ1ZjE2ID0gVWludDE2QXJyYXk7CgkgICAgZXhwb3J0cy5CdWYzMiA9IEludDMyQXJyYXk7CgkgICAgZXhwb3J0cy5hc3NpZ24oZXhwb3J0cywgZm5UeXBlZCk7CgkgIH0gZWxzZSB7CgkgICAgZXhwb3J0cy5CdWY4ICA9IEFycmF5OwoJICAgIGV4cG9ydHMuQnVmMTYgPSBBcnJheTsKCSAgICBleHBvcnRzLkJ1ZjMyID0gQXJyYXk7CgkgICAgZXhwb3J0cy5hc3NpZ24oZXhwb3J0cywgZm5VbnR5cGVkKTsKCSAgfQoJfTsKCglleHBvcnRzLnNldFR5cGVkKFRZUEVEX09LKTsKCgovKioqLyB9LAovKiA4NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoKCXZhciB1dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oODQpOwoKCS8qIFB1YmxpYyBjb25zdGFudHMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwoKCgkvL3ZhciBaX0ZJTFRFUkVEICAgICAgICAgID0gMTsKCS8vdmFyIFpfSFVGRk1BTl9PTkxZICAgICAgPSAyOwoJLy92YXIgWl9STEUgICAgICAgICAgICAgICA9IDM7Cgl2YXIgWl9GSVhFRCAgICAgICAgICAgICAgID0gNDsKCS8vdmFyIFpfREVGQVVMVF9TVFJBVEVHWSAgPSAwOwoKCS8qIFBvc3NpYmxlIHZhbHVlcyBvZiB0aGUgZGF0YV90eXBlIGZpZWxkICh0aG91Z2ggc2VlIGluZmxhdGUoKSkgKi8KCXZhciBaX0JJTkFSWSAgICAgICAgICAgICAgPSAwOwoJdmFyIFpfVEVYVCAgICAgICAgICAgICAgICA9IDE7CgkvL3ZhciBaX0FTQ0lJICAgICAgICAgICAgID0gMTsgLy8gPSBaX1RFWFQKCXZhciBaX1VOS05PV04gICAgICAgICAgICAgPSAyOwoKCS8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgoKCWZ1bmN0aW9uIHplcm8oYnVmKSB7IHZhciBsZW4gPSBidWYubGVuZ3RoOyB3aGlsZSAoLS1sZW4gPj0gMCkgeyBidWZbbGVuXSA9IDA7IH0gfQoKCS8vIEZyb20genV0aWwuaAoKCXZhciBTVE9SRURfQkxPQ0sgPSAwOwoJdmFyIFNUQVRJQ19UUkVFUyA9IDE7Cgl2YXIgRFlOX1RSRUVTICAgID0gMjsKCS8qIFRoZSB0aHJlZSBraW5kcyBvZiBibG9jayB0eXBlICovCgoJdmFyIE1JTl9NQVRDSCAgICA9IDM7Cgl2YXIgTUFYX01BVENIICAgID0gMjU4OwoJLyogVGhlIG1pbmltdW0gYW5kIG1heGltdW0gbWF0Y2ggbGVuZ3RocyAqLwoKCS8vIEZyb20gZGVmbGF0ZS5oCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAqIEludGVybmFsIGNvbXByZXNzaW9uIHN0YXRlLgoJICovCgoJdmFyIExFTkdUSF9DT0RFUyAgPSAyOTsKCS8qIG51bWJlciBvZiBsZW5ndGggY29kZXMsIG5vdCBjb3VudGluZyB0aGUgc3BlY2lhbCBFTkRfQkxPQ0sgY29kZSAqLwoKCXZhciBMSVRFUkFMUyAgICAgID0gMjU2OwoJLyogbnVtYmVyIG9mIGxpdGVyYWwgYnl0ZXMgMC4uMjU1ICovCgoJdmFyIExfQ09ERVMgICAgICAgPSBMSVRFUkFMUyArIDEgKyBMRU5HVEhfQ09ERVM7CgkvKiBudW1iZXIgb2YgTGl0ZXJhbCBvciBMZW5ndGggY29kZXMsIGluY2x1ZGluZyB0aGUgRU5EX0JMT0NLIGNvZGUgKi8KCgl2YXIgRF9DT0RFUyAgICAgICA9IDMwOwoJLyogbnVtYmVyIG9mIGRpc3RhbmNlIGNvZGVzICovCgoJdmFyIEJMX0NPREVTICAgICAgPSAxOTsKCS8qIG51bWJlciBvZiBjb2RlcyB1c2VkIHRvIHRyYW5zZmVyIHRoZSBiaXQgbGVuZ3RocyAqLwoKCXZhciBIRUFQX1NJWkUgICAgID0gMiAqIExfQ09ERVMgKyAxOwoJLyogbWF4aW11bSBoZWFwIHNpemUgKi8KCgl2YXIgTUFYX0JJVFMgICAgICA9IDE1OwoJLyogQWxsIGNvZGVzIG11c3Qgbm90IGV4Y2VlZCBNQVhfQklUUyBiaXRzICovCgoJdmFyIEJ1Zl9zaXplICAgICAgPSAxNjsKCS8qIHNpemUgb2YgYml0IGJ1ZmZlciBpbiBiaV9idWYgKi8KCgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBDb25zdGFudHMKCSAqLwoKCXZhciBNQVhfQkxfQklUUyA9IDc7CgkvKiBCaXQgbGVuZ3RoIGNvZGVzIG11c3Qgbm90IGV4Y2VlZCBNQVhfQkxfQklUUyBiaXRzICovCgoJdmFyIEVORF9CTE9DSyAgID0gMjU2OwoJLyogZW5kIG9mIGJsb2NrIGxpdGVyYWwgY29kZSAqLwoKCXZhciBSRVBfM182ICAgICA9IDE2OwoJLyogcmVwZWF0IHByZXZpb3VzIGJpdCBsZW5ndGggMy02IHRpbWVzICgyIGJpdHMgb2YgcmVwZWF0IGNvdW50KSAqLwoKCXZhciBSRVBaXzNfMTAgICA9IDE3OwoJLyogcmVwZWF0IGEgemVybyBsZW5ndGggMy0xMCB0aW1lcyAgKDMgYml0cyBvZiByZXBlYXQgY291bnQpICovCgoJdmFyIFJFUFpfMTFfMTM4ID0gMTg7CgkvKiByZXBlYXQgYSB6ZXJvIGxlbmd0aCAxMS0xMzggdGltZXMgICg3IGJpdHMgb2YgcmVwZWF0IGNvdW50KSAqLwoKCS8qIGVzbGludC1kaXNhYmxlIGNvbW1hLXNwYWNpbmcsYXJyYXktYnJhY2tldC1zcGFjaW5nICovCgl2YXIgZXh0cmFfbGJpdHMgPSAgIC8qIGV4dHJhIGJpdHMgZm9yIGVhY2ggbGVuZ3RoIGNvZGUgKi8KCSAgWzAsMCwwLDAsMCwwLDAsMCwxLDEsMSwxLDIsMiwyLDIsMywzLDMsMyw0LDQsNCw0LDUsNSw1LDUsMF07CgoJdmFyIGV4dHJhX2RiaXRzID0gICAvKiBleHRyYSBiaXRzIGZvciBlYWNoIGRpc3RhbmNlIGNvZGUgKi8KCSAgWzAsMCwwLDAsMSwxLDIsMiwzLDMsNCw0LDUsNSw2LDYsNyw3LDgsOCw5LDksMTAsMTAsMTEsMTEsMTIsMTIsMTMsMTNdOwoKCXZhciBleHRyYV9ibGJpdHMgPSAgLyogZXh0cmEgYml0cyBmb3IgZWFjaCBiaXQgbGVuZ3RoIGNvZGUgKi8KCSAgWzAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMiwzLDddOwoKCXZhciBibF9vcmRlciA9CgkgIFsxNiwxNywxOCwwLDgsNyw5LDYsMTAsNSwxMSw0LDEyLDMsMTMsMiwxNCwxLDE1XTsKCS8qIGVzbGludC1lbmFibGUgY29tbWEtc3BhY2luZyxhcnJheS1icmFja2V0LXNwYWNpbmcgKi8KCgkvKiBUaGUgbGVuZ3RocyBvZiB0aGUgYml0IGxlbmd0aCBjb2RlcyBhcmUgc2VudCBpbiBvcmRlciBvZiBkZWNyZWFzaW5nCgkgKiBwcm9iYWJpbGl0eSwgdG8gYXZvaWQgdHJhbnNtaXR0aW5nIHRoZSBsZW5ndGhzIGZvciB1bnVzZWQgYml0IGxlbmd0aCBjb2Rlcy4KCSAqLwoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogTG9jYWwgZGF0YS4gVGhlc2UgYXJlIGluaXRpYWxpemVkIG9ubHkgb25jZS4KCSAqLwoKCS8vIFdlIHByZS1maWxsIGFycmF5cyB3aXRoIDAgdG8gYXZvaWQgdW5pbml0aWFsaXplZCBnYXBzCgoJdmFyIERJU1RfQ09ERV9MRU4gPSA1MTI7IC8qIHNlZSBkZWZpbml0aW9uIG9mIGFycmF5IGRpc3RfY29kZSBiZWxvdyAqLwoKCS8vICEhISEgVXNlIGZsYXQgYXJyYXkgaW5zZGVhZCBvZiBzdHJ1Y3R1cmUsIEZyZXEgPSBpKjIsIExlbiA9IGkqMisxCgl2YXIgc3RhdGljX2x0cmVlICA9IG5ldyBBcnJheSgoTF9DT0RFUyArIDIpICogMik7Cgl6ZXJvKHN0YXRpY19sdHJlZSk7CgkvKiBUaGUgc3RhdGljIGxpdGVyYWwgdHJlZS4gU2luY2UgdGhlIGJpdCBsZW5ndGhzIGFyZSBpbXBvc2VkLCB0aGVyZSBpcyBubwoJICogbmVlZCBmb3IgdGhlIExfQ09ERVMgZXh0cmEgY29kZXMgdXNlZCBkdXJpbmcgaGVhcCBjb25zdHJ1Y3Rpb24uIEhvd2V2ZXIKCSAqIFRoZSBjb2RlcyAyODYgYW5kIDI4NyBhcmUgbmVlZGVkIHRvIGJ1aWxkIGEgY2Fub25pY2FsIHRyZWUgKHNlZSBfdHJfaW5pdAoJICogYmVsb3cpLgoJICovCgoJdmFyIHN0YXRpY19kdHJlZSAgPSBuZXcgQXJyYXkoRF9DT0RFUyAqIDIpOwoJemVybyhzdGF0aWNfZHRyZWUpOwoJLyogVGhlIHN0YXRpYyBkaXN0YW5jZSB0cmVlLiAoQWN0dWFsbHkgYSB0cml2aWFsIHRyZWUgc2luY2UgYWxsIGNvZGVzIHVzZQoJICogNSBiaXRzLikKCSAqLwoKCXZhciBfZGlzdF9jb2RlICAgID0gbmV3IEFycmF5KERJU1RfQ09ERV9MRU4pOwoJemVybyhfZGlzdF9jb2RlKTsKCS8qIERpc3RhbmNlIGNvZGVzLiBUaGUgZmlyc3QgMjU2IHZhbHVlcyBjb3JyZXNwb25kIHRvIHRoZSBkaXN0YW5jZXMKCSAqIDMgLi4gMjU4LCB0aGUgbGFzdCAyNTYgdmFsdWVzIGNvcnJlc3BvbmQgdG8gdGhlIHRvcCA4IGJpdHMgb2YKCSAqIHRoZSAxNSBiaXQgZGlzdGFuY2VzLgoJICovCgoJdmFyIF9sZW5ndGhfY29kZSAgPSBuZXcgQXJyYXkoTUFYX01BVENIIC0gTUlOX01BVENIICsgMSk7Cgl6ZXJvKF9sZW5ndGhfY29kZSk7CgkvKiBsZW5ndGggY29kZSBmb3IgZWFjaCBub3JtYWxpemVkIG1hdGNoIGxlbmd0aCAoMCA9PSBNSU5fTUFUQ0gpICovCgoJdmFyIGJhc2VfbGVuZ3RoICAgPSBuZXcgQXJyYXkoTEVOR1RIX0NPREVTKTsKCXplcm8oYmFzZV9sZW5ndGgpOwoJLyogRmlyc3Qgbm9ybWFsaXplZCBsZW5ndGggZm9yIGVhY2ggY29kZSAoMCA9IE1JTl9NQVRDSCkgKi8KCgl2YXIgYmFzZV9kaXN0ICAgICA9IG5ldyBBcnJheShEX0NPREVTKTsKCXplcm8oYmFzZV9kaXN0KTsKCS8qIEZpcnN0IG5vcm1hbGl6ZWQgZGlzdGFuY2UgZm9yIGVhY2ggY29kZSAoMCA9IGRpc3RhbmNlIG9mIDEpICovCgoKCWZ1bmN0aW9uIFN0YXRpY1RyZWVEZXNjKHN0YXRpY190cmVlLCBleHRyYV9iaXRzLCBleHRyYV9iYXNlLCBlbGVtcywgbWF4X2xlbmd0aCkgewoKCSAgdGhpcy5zdGF0aWNfdHJlZSAgPSBzdGF0aWNfdHJlZTsgIC8qIHN0YXRpYyB0cmVlIG9yIE5VTEwgKi8KCSAgdGhpcy5leHRyYV9iaXRzICAgPSBleHRyYV9iaXRzOyAgIC8qIGV4dHJhIGJpdHMgZm9yIGVhY2ggY29kZSBvciBOVUxMICovCgkgIHRoaXMuZXh0cmFfYmFzZSAgID0gZXh0cmFfYmFzZTsgICAvKiBiYXNlIGluZGV4IGZvciBleHRyYV9iaXRzICovCgkgIHRoaXMuZWxlbXMgICAgICAgID0gZWxlbXM7ICAgICAgICAvKiBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGluIHRoZSB0cmVlICovCgkgIHRoaXMubWF4X2xlbmd0aCAgID0gbWF4X2xlbmd0aDsgICAvKiBtYXggYml0IGxlbmd0aCBmb3IgdGhlIGNvZGVzICovCgoJICAvLyBzaG93IGlmIGBzdGF0aWNfdHJlZWAgaGFzIGRhdGEgb3IgZHVtbXkgLSBuZWVkZWQgZm9yIG1vbm9tb3JwaGljIG9iamVjdHMKCSAgdGhpcy5oYXNfc3RyZWUgICAgPSBzdGF0aWNfdHJlZSAmJiBzdGF0aWNfdHJlZS5sZW5ndGg7Cgl9CgoKCXZhciBzdGF0aWNfbF9kZXNjOwoJdmFyIHN0YXRpY19kX2Rlc2M7Cgl2YXIgc3RhdGljX2JsX2Rlc2M7CgoKCWZ1bmN0aW9uIFRyZWVEZXNjKGR5bl90cmVlLCBzdGF0X2Rlc2MpIHsKCSAgdGhpcy5keW5fdHJlZSA9IGR5bl90cmVlOyAgICAgLyogdGhlIGR5bmFtaWMgdHJlZSAqLwoJICB0aGlzLm1heF9jb2RlID0gMDsgICAgICAgICAgICAvKiBsYXJnZXN0IGNvZGUgd2l0aCBub24gemVybyBmcmVxdWVuY3kgKi8KCSAgdGhpcy5zdGF0X2Rlc2MgPSBzdGF0X2Rlc2M7ICAgLyogdGhlIGNvcnJlc3BvbmRpbmcgc3RhdGljIHRyZWUgKi8KCX0KCgoKCWZ1bmN0aW9uIGRfY29kZShkaXN0KSB7CgkgIHJldHVybiBkaXN0IDwgMjU2ID8gX2Rpc3RfY29kZVtkaXN0XSA6IF9kaXN0X2NvZGVbMjU2ICsgKGRpc3QgPj4+IDcpXTsKCX0KCgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBPdXRwdXQgYSBzaG9ydCBMU0IgZmlyc3Qgb24gdGhlIHN0cmVhbS4KCSAqIElOIGFzc2VydGlvbjogdGhlcmUgaXMgZW5vdWdoIHJvb20gaW4gcGVuZGluZ0J1Zi4KCSAqLwoJZnVuY3Rpb24gcHV0X3Nob3J0KHMsIHcpIHsKCS8vICAgIHB1dF9ieXRlKHMsICh1Y2gpKCh3KSAmIDB4ZmYpKTsKCS8vICAgIHB1dF9ieXRlKHMsICh1Y2gpKCh1c2gpKHcpID4+IDgpKTsKCSAgcy5wZW5kaW5nX2J1ZltzLnBlbmRpbmcrK10gPSAodykgJiAweGZmOwoJICBzLnBlbmRpbmdfYnVmW3MucGVuZGluZysrXSA9ICh3ID4+PiA4KSAmIDB4ZmY7Cgl9CgoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogU2VuZCBhIHZhbHVlIG9uIGEgZ2l2ZW4gbnVtYmVyIG9mIGJpdHMuCgkgKiBJTiBhc3NlcnRpb246IGxlbmd0aCA8PSAxNiBhbmQgdmFsdWUgZml0cyBpbiBsZW5ndGggYml0cy4KCSAqLwoJZnVuY3Rpb24gc2VuZF9iaXRzKHMsIHZhbHVlLCBsZW5ndGgpIHsKCSAgaWYgKHMuYmlfdmFsaWQgPiAoQnVmX3NpemUgLSBsZW5ndGgpKSB7CgkgICAgcy5iaV9idWYgfD0gKHZhbHVlIDw8IHMuYmlfdmFsaWQpICYgMHhmZmZmOwoJICAgIHB1dF9zaG9ydChzLCBzLmJpX2J1Zik7CgkgICAgcy5iaV9idWYgPSB2YWx1ZSA+PiAoQnVmX3NpemUgLSBzLmJpX3ZhbGlkKTsKCSAgICBzLmJpX3ZhbGlkICs9IGxlbmd0aCAtIEJ1Zl9zaXplOwoJICB9IGVsc2UgewoJICAgIHMuYmlfYnVmIHw9ICh2YWx1ZSA8PCBzLmJpX3ZhbGlkKSAmIDB4ZmZmZjsKCSAgICBzLmJpX3ZhbGlkICs9IGxlbmd0aDsKCSAgfQoJfQoKCglmdW5jdGlvbiBzZW5kX2NvZGUocywgYywgdHJlZSkgewoJICBzZW5kX2JpdHMocywgdHJlZVtjICogMl0vKi5Db2RlKi8sIHRyZWVbYyAqIDIgKyAxXS8qLkxlbiovKTsKCX0KCgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBSZXZlcnNlIHRoZSBmaXJzdCBsZW4gYml0cyBvZiBhIGNvZGUsIHVzaW5nIHN0cmFpZ2h0Zm9yd2FyZCBjb2RlIChhIGZhc3RlcgoJICogbWV0aG9kIHdvdWxkIHVzZSBhIHRhYmxlKQoJICogSU4gYXNzZXJ0aW9uOiAxIDw9IGxlbiA8PSAxNQoJICovCglmdW5jdGlvbiBiaV9yZXZlcnNlKGNvZGUsIGxlbikgewoJICB2YXIgcmVzID0gMDsKCSAgZG8gewoJICAgIHJlcyB8PSBjb2RlICYgMTsKCSAgICBjb2RlID4+Pj0gMTsKCSAgICByZXMgPDw9IDE7CgkgIH0gd2hpbGUgKC0tbGVuID4gMCk7CgkgIHJldHVybiByZXMgPj4+IDE7Cgl9CgoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogRmx1c2ggdGhlIGJpdCBidWZmZXIsIGtlZXBpbmcgYXQgbW9zdCA3IGJpdHMgaW4gaXQuCgkgKi8KCWZ1bmN0aW9uIGJpX2ZsdXNoKHMpIHsKCSAgaWYgKHMuYmlfdmFsaWQgPT09IDE2KSB7CgkgICAgcHV0X3Nob3J0KHMsIHMuYmlfYnVmKTsKCSAgICBzLmJpX2J1ZiA9IDA7CgkgICAgcy5iaV92YWxpZCA9IDA7CgoJICB9IGVsc2UgaWYgKHMuYmlfdmFsaWQgPj0gOCkgewoJICAgIHMucGVuZGluZ19idWZbcy5wZW5kaW5nKytdID0gcy5iaV9idWYgJiAweGZmOwoJICAgIHMuYmlfYnVmID4+PSA4OwoJICAgIHMuYmlfdmFsaWQgLT0gODsKCSAgfQoJfQoKCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAqIENvbXB1dGUgdGhlIG9wdGltYWwgYml0IGxlbmd0aHMgZm9yIGEgdHJlZSBhbmQgdXBkYXRlIHRoZSB0b3RhbCBiaXQgbGVuZ3RoCgkgKiBmb3IgdGhlIGN1cnJlbnQgYmxvY2suCgkgKiBJTiBhc3NlcnRpb246IHRoZSBmaWVsZHMgZnJlcSBhbmQgZGFkIGFyZSBzZXQsIGhlYXBbaGVhcF9tYXhdIGFuZAoJICogICAgYWJvdmUgYXJlIHRoZSB0cmVlIG5vZGVzIHNvcnRlZCBieSBpbmNyZWFzaW5nIGZyZXF1ZW5jeS4KCSAqIE9VVCBhc3NlcnRpb25zOiB0aGUgZmllbGQgbGVuIGlzIHNldCB0byB0aGUgb3B0aW1hbCBiaXQgbGVuZ3RoLCB0aGUKCSAqICAgICBhcnJheSBibF9jb3VudCBjb250YWlucyB0aGUgZnJlcXVlbmNpZXMgZm9yIGVhY2ggYml0IGxlbmd0aC4KCSAqICAgICBUaGUgbGVuZ3RoIG9wdF9sZW4gaXMgdXBkYXRlZDsgc3RhdGljX2xlbiBpcyBhbHNvIHVwZGF0ZWQgaWYgc3RyZWUgaXMKCSAqICAgICBub3QgbnVsbC4KCSAqLwoJZnVuY3Rpb24gZ2VuX2JpdGxlbihzLCBkZXNjKQoJLy8gICAgZGVmbGF0ZV9zdGF0ZSAqczsKCS8vICAgIHRyZWVfZGVzYyAqZGVzYzsgICAgLyogdGhlIHRyZWUgZGVzY3JpcHRvciAqLwoJewoJICB2YXIgdHJlZSAgICAgICAgICAgID0gZGVzYy5keW5fdHJlZTsKCSAgdmFyIG1heF9jb2RlICAgICAgICA9IGRlc2MubWF4X2NvZGU7CgkgIHZhciBzdHJlZSAgICAgICAgICAgPSBkZXNjLnN0YXRfZGVzYy5zdGF0aWNfdHJlZTsKCSAgdmFyIGhhc19zdHJlZSAgICAgICA9IGRlc2Muc3RhdF9kZXNjLmhhc19zdHJlZTsKCSAgdmFyIGV4dHJhICAgICAgICAgICA9IGRlc2Muc3RhdF9kZXNjLmV4dHJhX2JpdHM7CgkgIHZhciBiYXNlICAgICAgICAgICAgPSBkZXNjLnN0YXRfZGVzYy5leHRyYV9iYXNlOwoJICB2YXIgbWF4X2xlbmd0aCAgICAgID0gZGVzYy5zdGF0X2Rlc2MubWF4X2xlbmd0aDsKCSAgdmFyIGg7ICAgICAgICAgICAgICAvKiBoZWFwIGluZGV4ICovCgkgIHZhciBuLCBtOyAgICAgICAgICAgLyogaXRlcmF0ZSBvdmVyIHRoZSB0cmVlIGVsZW1lbnRzICovCgkgIHZhciBiaXRzOyAgICAgICAgICAgLyogYml0IGxlbmd0aCAqLwoJICB2YXIgeGJpdHM7ICAgICAgICAgIC8qIGV4dHJhIGJpdHMgKi8KCSAgdmFyIGY7ICAgICAgICAgICAgICAvKiBmcmVxdWVuY3kgKi8KCSAgdmFyIG92ZXJmbG93ID0gMDsgICAvKiBudW1iZXIgb2YgZWxlbWVudHMgd2l0aCBiaXQgbGVuZ3RoIHRvbyBsYXJnZSAqLwoKCSAgZm9yIChiaXRzID0gMDsgYml0cyA8PSBNQVhfQklUUzsgYml0cysrKSB7CgkgICAgcy5ibF9jb3VudFtiaXRzXSA9IDA7CgkgIH0KCgkgIC8qIEluIGEgZmlyc3QgcGFzcywgY29tcHV0ZSB0aGUgb3B0aW1hbCBiaXQgbGVuZ3RocyAod2hpY2ggbWF5CgkgICAqIG92ZXJmbG93IGluIHRoZSBjYXNlIG9mIHRoZSBiaXQgbGVuZ3RoIHRyZWUpLgoJICAgKi8KCSAgdHJlZVtzLmhlYXBbcy5oZWFwX21heF0gKiAyICsgMV0vKi5MZW4qLyA9IDA7IC8qIHJvb3Qgb2YgdGhlIGhlYXAgKi8KCgkgIGZvciAoaCA9IHMuaGVhcF9tYXggKyAxOyBoIDwgSEVBUF9TSVpFOyBoKyspIHsKCSAgICBuID0gcy5oZWFwW2hdOwoJICAgIGJpdHMgPSB0cmVlW3RyZWVbbiAqIDIgKyAxXS8qLkRhZCovICogMiArIDFdLyouTGVuKi8gKyAxOwoJICAgIGlmIChiaXRzID4gbWF4X2xlbmd0aCkgewoJICAgICAgYml0cyA9IG1heF9sZW5ndGg7CgkgICAgICBvdmVyZmxvdysrOwoJICAgIH0KCSAgICB0cmVlW24gKiAyICsgMV0vKi5MZW4qLyA9IGJpdHM7CgkgICAgLyogV2Ugb3ZlcndyaXRlIHRyZWVbbl0uRGFkIHdoaWNoIGlzIG5vIGxvbmdlciBuZWVkZWQgKi8KCgkgICAgaWYgKG4gPiBtYXhfY29kZSkgeyBjb250aW51ZTsgfSAvKiBub3QgYSBsZWFmIG5vZGUgKi8KCgkgICAgcy5ibF9jb3VudFtiaXRzXSsrOwoJICAgIHhiaXRzID0gMDsKCSAgICBpZiAobiA+PSBiYXNlKSB7CgkgICAgICB4Yml0cyA9IGV4dHJhW24gLSBiYXNlXTsKCSAgICB9CgkgICAgZiA9IHRyZWVbbiAqIDJdLyouRnJlcSovOwoJICAgIHMub3B0X2xlbiArPSBmICogKGJpdHMgKyB4Yml0cyk7CgkgICAgaWYgKGhhc19zdHJlZSkgewoJICAgICAgcy5zdGF0aWNfbGVuICs9IGYgKiAoc3RyZWVbbiAqIDIgKyAxXS8qLkxlbiovICsgeGJpdHMpOwoJICAgIH0KCSAgfQoJICBpZiAob3ZlcmZsb3cgPT09IDApIHsgcmV0dXJuOyB9CgoJICAvLyBUcmFjZSgoc3RkZXJyLCJcbmJpdCBsZW5ndGggb3ZlcmZsb3dcbiIpKTsKCSAgLyogVGhpcyBoYXBwZW5zIGZvciBleGFtcGxlIG9uIG9iajIgYW5kIHBpYyBvZiB0aGUgQ2FsZ2FyeSBjb3JwdXMgKi8KCgkgIC8qIEZpbmQgdGhlIGZpcnN0IGJpdCBsZW5ndGggd2hpY2ggY291bGQgaW5jcmVhc2U6ICovCgkgIGRvIHsKCSAgICBiaXRzID0gbWF4X2xlbmd0aCAtIDE7CgkgICAgd2hpbGUgKHMuYmxfY291bnRbYml0c10gPT09IDApIHsgYml0cy0tOyB9CgkgICAgcy5ibF9jb3VudFtiaXRzXS0tOyAgICAgIC8qIG1vdmUgb25lIGxlYWYgZG93biB0aGUgdHJlZSAqLwoJICAgIHMuYmxfY291bnRbYml0cyArIDFdICs9IDI7IC8qIG1vdmUgb25lIG92ZXJmbG93IGl0ZW0gYXMgaXRzIGJyb3RoZXIgKi8KCSAgICBzLmJsX2NvdW50W21heF9sZW5ndGhdLS07CgkgICAgLyogVGhlIGJyb3RoZXIgb2YgdGhlIG92ZXJmbG93IGl0ZW0gYWxzbyBtb3ZlcyBvbmUgc3RlcCB1cCwKCSAgICAgKiBidXQgdGhpcyBkb2VzIG5vdCBhZmZlY3QgYmxfY291bnRbbWF4X2xlbmd0aF0KCSAgICAgKi8KCSAgICBvdmVyZmxvdyAtPSAyOwoJICB9IHdoaWxlIChvdmVyZmxvdyA+IDApOwoKCSAgLyogTm93IHJlY29tcHV0ZSBhbGwgYml0IGxlbmd0aHMsIHNjYW5uaW5nIGluIGluY3JlYXNpbmcgZnJlcXVlbmN5LgoJICAgKiBoIGlzIHN0aWxsIGVxdWFsIHRvIEhFQVBfU0laRS4gKEl0IGlzIHNpbXBsZXIgdG8gcmVjb25zdHJ1Y3QgYWxsCgkgICAqIGxlbmd0aHMgaW5zdGVhZCBvZiBmaXhpbmcgb25seSB0aGUgd3Jvbmcgb25lcy4gVGhpcyBpZGVhIGlzIHRha2VuCgkgICAqIGZyb20gJ2FyJyB3cml0dGVuIGJ5IEhhcnVoaWtvIE9rdW11cmEuKQoJICAgKi8KCSAgZm9yIChiaXRzID0gbWF4X2xlbmd0aDsgYml0cyAhPT0gMDsgYml0cy0tKSB7CgkgICAgbiA9IHMuYmxfY291bnRbYml0c107CgkgICAgd2hpbGUgKG4gIT09IDApIHsKCSAgICAgIG0gPSBzLmhlYXBbLS1oXTsKCSAgICAgIGlmIChtID4gbWF4X2NvZGUpIHsgY29udGludWU7IH0KCSAgICAgIGlmICh0cmVlW20gKiAyICsgMV0vKi5MZW4qLyAhPT0gYml0cykgewoJICAgICAgICAvLyBUcmFjZSgoc3RkZXJyLCJjb2RlICVkIGJpdHMgJWQtPiVkXG4iLCBtLCB0cmVlW21dLkxlbiwgYml0cykpOwoJICAgICAgICBzLm9wdF9sZW4gKz0gKGJpdHMgLSB0cmVlW20gKiAyICsgMV0vKi5MZW4qLykgKiB0cmVlW20gKiAyXS8qLkZyZXEqLzsKCSAgICAgICAgdHJlZVttICogMiArIDFdLyouTGVuKi8gPSBiaXRzOwoJICAgICAgfQoJICAgICAgbi0tOwoJICAgIH0KCSAgfQoJfQoKCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAqIEdlbmVyYXRlIHRoZSBjb2RlcyBmb3IgYSBnaXZlbiB0cmVlIGFuZCBiaXQgY291bnRzICh3aGljaCBuZWVkIG5vdCBiZQoJICogb3B0aW1hbCkuCgkgKiBJTiBhc3NlcnRpb246IHRoZSBhcnJheSBibF9jb3VudCBjb250YWlucyB0aGUgYml0IGxlbmd0aCBzdGF0aXN0aWNzIGZvcgoJICogdGhlIGdpdmVuIHRyZWUgYW5kIHRoZSBmaWVsZCBsZW4gaXMgc2V0IGZvciBhbGwgdHJlZSBlbGVtZW50cy4KCSAqIE9VVCBhc3NlcnRpb246IHRoZSBmaWVsZCBjb2RlIGlzIHNldCBmb3IgYWxsIHRyZWUgZWxlbWVudHMgb2Ygbm9uCgkgKiAgICAgemVybyBjb2RlIGxlbmd0aC4KCSAqLwoJZnVuY3Rpb24gZ2VuX2NvZGVzKHRyZWUsIG1heF9jb2RlLCBibF9jb3VudCkKCS8vICAgIGN0X2RhdGEgKnRyZWU7ICAgICAgICAgICAgIC8qIHRoZSB0cmVlIHRvIGRlY29yYXRlICovCgkvLyAgICBpbnQgbWF4X2NvZGU7ICAgICAgICAgICAgICAvKiBsYXJnZXN0IGNvZGUgd2l0aCBub24gemVybyBmcmVxdWVuY3kgKi8KCS8vICAgIHVzaGYgKmJsX2NvdW50OyAgICAgICAgICAgIC8qIG51bWJlciBvZiBjb2RlcyBhdCBlYWNoIGJpdCBsZW5ndGggKi8KCXsKCSAgdmFyIG5leHRfY29kZSA9IG5ldyBBcnJheShNQVhfQklUUyArIDEpOyAvKiBuZXh0IGNvZGUgdmFsdWUgZm9yIGVhY2ggYml0IGxlbmd0aCAqLwoJICB2YXIgY29kZSA9IDA7ICAgICAgICAgICAgICAvKiBydW5uaW5nIGNvZGUgdmFsdWUgKi8KCSAgdmFyIGJpdHM7ICAgICAgICAgICAgICAgICAgLyogYml0IGluZGV4ICovCgkgIHZhciBuOyAgICAgICAgICAgICAgICAgICAgIC8qIGNvZGUgaW5kZXggKi8KCgkgIC8qIFRoZSBkaXN0cmlidXRpb24gY291bnRzIGFyZSBmaXJzdCB1c2VkIHRvIGdlbmVyYXRlIHRoZSBjb2RlIHZhbHVlcwoJICAgKiB3aXRob3V0IGJpdCByZXZlcnNhbC4KCSAgICovCgkgIGZvciAoYml0cyA9IDE7IGJpdHMgPD0gTUFYX0JJVFM7IGJpdHMrKykgewoJICAgIG5leHRfY29kZVtiaXRzXSA9IGNvZGUgPSAoY29kZSArIGJsX2NvdW50W2JpdHMgLSAxXSkgPDwgMTsKCSAgfQoJICAvKiBDaGVjayB0aGF0IHRoZSBiaXQgY291bnRzIGluIGJsX2NvdW50IGFyZSBjb25zaXN0ZW50LiBUaGUgbGFzdCBjb2RlCgkgICAqIG11c3QgYmUgYWxsIG9uZXMuCgkgICAqLwoJICAvL0Fzc2VydCAoY29kZSArIGJsX2NvdW50W01BWF9CSVRTXS0xID09ICgxPDxNQVhfQklUUyktMSwKCSAgLy8gICAgICAgICJpbmNvbnNpc3RlbnQgYml0IGNvdW50cyIpOwoJICAvL1RyYWNldigoc3RkZXJyLCJcbmdlbl9jb2RlczogbWF4X2NvZGUgJWQgIiwgbWF4X2NvZGUpKTsKCgkgIGZvciAobiA9IDA7ICBuIDw9IG1heF9jb2RlOyBuKyspIHsKCSAgICB2YXIgbGVuID0gdHJlZVtuICogMiArIDFdLyouTGVuKi87CgkgICAgaWYgKGxlbiA9PT0gMCkgeyBjb250aW51ZTsgfQoJICAgIC8qIE5vdyByZXZlcnNlIHRoZSBiaXRzICovCgkgICAgdHJlZVtuICogMl0vKi5Db2RlKi8gPSBiaV9yZXZlcnNlKG5leHRfY29kZVtsZW5dKyssIGxlbik7CgoJICAgIC8vVHJhY2Vjdih0cmVlICE9IHN0YXRpY19sdHJlZSwgKHN0ZGVyciwiXG5uICUzZCAlYyBsICUyZCBjICU0eCAoJXgpICIsCgkgICAgLy8gICAgIG4sIChpc2dyYXBoKG4pID8gbiA6ICcgJyksIGxlbiwgdHJlZVtuXS5Db2RlLCBuZXh0X2NvZGVbbGVuXS0xKSk7CgkgIH0KCX0KCgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBJbml0aWFsaXplIHRoZSB2YXJpb3VzICdjb25zdGFudCcgdGFibGVzLgoJICovCglmdW5jdGlvbiB0cl9zdGF0aWNfaW5pdCgpIHsKCSAgdmFyIG47ICAgICAgICAvKiBpdGVyYXRlcyBvdmVyIHRyZWUgZWxlbWVudHMgKi8KCSAgdmFyIGJpdHM7ICAgICAvKiBiaXQgY291bnRlciAqLwoJICB2YXIgbGVuZ3RoOyAgIC8qIGxlbmd0aCB2YWx1ZSAqLwoJICB2YXIgY29kZTsgICAgIC8qIGNvZGUgdmFsdWUgKi8KCSAgdmFyIGRpc3Q7ICAgICAvKiBkaXN0YW5jZSBpbmRleCAqLwoJICB2YXIgYmxfY291bnQgPSBuZXcgQXJyYXkoTUFYX0JJVFMgKyAxKTsKCSAgLyogbnVtYmVyIG9mIGNvZGVzIGF0IGVhY2ggYml0IGxlbmd0aCBmb3IgYW4gb3B0aW1hbCB0cmVlICovCgoJICAvLyBkbyBjaGVjayBpbiBfdHJfaW5pdCgpCgkgIC8vaWYgKHN0YXRpY19pbml0X2RvbmUpIHJldHVybjsKCgkgIC8qIEZvciBzb21lIGVtYmVkZGVkIHRhcmdldHMsIGdsb2JhbCB2YXJpYWJsZXMgYXJlIG5vdCBpbml0aWFsaXplZDogKi8KCS8qI2lmZGVmIE5PX0lOSVRfR0xPQkFMX1BPSU5URVJTCgkgIHN0YXRpY19sX2Rlc2Muc3RhdGljX3RyZWUgPSBzdGF0aWNfbHRyZWU7CgkgIHN0YXRpY19sX2Rlc2MuZXh0cmFfYml0cyA9IGV4dHJhX2xiaXRzOwoJICBzdGF0aWNfZF9kZXNjLnN0YXRpY190cmVlID0gc3RhdGljX2R0cmVlOwoJICBzdGF0aWNfZF9kZXNjLmV4dHJhX2JpdHMgPSBleHRyYV9kYml0czsKCSAgc3RhdGljX2JsX2Rlc2MuZXh0cmFfYml0cyA9IGV4dHJhX2JsYml0czsKCSNlbmRpZiovCgoJICAvKiBJbml0aWFsaXplIHRoZSBtYXBwaW5nIGxlbmd0aCAoMC4uMjU1KSAtPiBsZW5ndGggY29kZSAoMC4uMjgpICovCgkgIGxlbmd0aCA9IDA7CgkgIGZvciAoY29kZSA9IDA7IGNvZGUgPCBMRU5HVEhfQ09ERVMgLSAxOyBjb2RlKyspIHsKCSAgICBiYXNlX2xlbmd0aFtjb2RlXSA9IGxlbmd0aDsKCSAgICBmb3IgKG4gPSAwOyBuIDwgKDEgPDwgZXh0cmFfbGJpdHNbY29kZV0pOyBuKyspIHsKCSAgICAgIF9sZW5ndGhfY29kZVtsZW5ndGgrK10gPSBjb2RlOwoJICAgIH0KCSAgfQoJICAvL0Fzc2VydCAobGVuZ3RoID09IDI1NiwgInRyX3N0YXRpY19pbml0OiBsZW5ndGggIT0gMjU2Iik7CgkgIC8qIE5vdGUgdGhhdCB0aGUgbGVuZ3RoIDI1NSAobWF0Y2ggbGVuZ3RoIDI1OCkgY2FuIGJlIHJlcHJlc2VudGVkCgkgICAqIGluIHR3byBkaWZmZXJlbnQgd2F5czogY29kZSAyODQgKyA1IGJpdHMgb3IgY29kZSAyODUsIHNvIHdlCgkgICAqIG92ZXJ3cml0ZSBsZW5ndGhfY29kZVsyNTVdIHRvIHVzZSB0aGUgYmVzdCBlbmNvZGluZzoKCSAgICovCgkgIF9sZW5ndGhfY29kZVtsZW5ndGggLSAxXSA9IGNvZGU7CgoJICAvKiBJbml0aWFsaXplIHRoZSBtYXBwaW5nIGRpc3QgKDAuLjMySykgLT4gZGlzdCBjb2RlICgwLi4yOSkgKi8KCSAgZGlzdCA9IDA7CgkgIGZvciAoY29kZSA9IDA7IGNvZGUgPCAxNjsgY29kZSsrKSB7CgkgICAgYmFzZV9kaXN0W2NvZGVdID0gZGlzdDsKCSAgICBmb3IgKG4gPSAwOyBuIDwgKDEgPDwgZXh0cmFfZGJpdHNbY29kZV0pOyBuKyspIHsKCSAgICAgIF9kaXN0X2NvZGVbZGlzdCsrXSA9IGNvZGU7CgkgICAgfQoJICB9CgkgIC8vQXNzZXJ0IChkaXN0ID09IDI1NiwgInRyX3N0YXRpY19pbml0OiBkaXN0ICE9IDI1NiIpOwoJICBkaXN0ID4+PSA3OyAvKiBmcm9tIG5vdyBvbiwgYWxsIGRpc3RhbmNlcyBhcmUgZGl2aWRlZCBieSAxMjggKi8KCSAgZm9yICg7IGNvZGUgPCBEX0NPREVTOyBjb2RlKyspIHsKCSAgICBiYXNlX2Rpc3RbY29kZV0gPSBkaXN0IDw8IDc7CgkgICAgZm9yIChuID0gMDsgbiA8ICgxIDw8IChleHRyYV9kYml0c1tjb2RlXSAtIDcpKTsgbisrKSB7CgkgICAgICBfZGlzdF9jb2RlWzI1NiArIGRpc3QrK10gPSBjb2RlOwoJICAgIH0KCSAgfQoJICAvL0Fzc2VydCAoZGlzdCA9PSAyNTYsICJ0cl9zdGF0aWNfaW5pdDogMjU2K2Rpc3QgIT0gNTEyIik7CgoJICAvKiBDb25zdHJ1Y3QgdGhlIGNvZGVzIG9mIHRoZSBzdGF0aWMgbGl0ZXJhbCB0cmVlICovCgkgIGZvciAoYml0cyA9IDA7IGJpdHMgPD0gTUFYX0JJVFM7IGJpdHMrKykgewoJICAgIGJsX2NvdW50W2JpdHNdID0gMDsKCSAgfQoKCSAgbiA9IDA7CgkgIHdoaWxlIChuIDw9IDE0MykgewoJICAgIHN0YXRpY19sdHJlZVtuICogMiArIDFdLyouTGVuKi8gPSA4OwoJICAgIG4rKzsKCSAgICBibF9jb3VudFs4XSsrOwoJICB9CgkgIHdoaWxlIChuIDw9IDI1NSkgewoJICAgIHN0YXRpY19sdHJlZVtuICogMiArIDFdLyouTGVuKi8gPSA5OwoJICAgIG4rKzsKCSAgICBibF9jb3VudFs5XSsrOwoJICB9CgkgIHdoaWxlIChuIDw9IDI3OSkgewoJICAgIHN0YXRpY19sdHJlZVtuICogMiArIDFdLyouTGVuKi8gPSA3OwoJICAgIG4rKzsKCSAgICBibF9jb3VudFs3XSsrOwoJICB9CgkgIHdoaWxlIChuIDw9IDI4NykgewoJICAgIHN0YXRpY19sdHJlZVtuICogMiArIDFdLyouTGVuKi8gPSA4OwoJICAgIG4rKzsKCSAgICBibF9jb3VudFs4XSsrOwoJICB9CgkgIC8qIENvZGVzIDI4NiBhbmQgMjg3IGRvIG5vdCBleGlzdCwgYnV0IHdlIG11c3QgaW5jbHVkZSB0aGVtIGluIHRoZQoJICAgKiB0cmVlIGNvbnN0cnVjdGlvbiB0byBnZXQgYSBjYW5vbmljYWwgSHVmZm1hbiB0cmVlIChsb25nZXN0IGNvZGUKCSAgICogYWxsIG9uZXMpCgkgICAqLwoJICBnZW5fY29kZXMoc3RhdGljX2x0cmVlLCBMX0NPREVTICsgMSwgYmxfY291bnQpOwoKCSAgLyogVGhlIHN0YXRpYyBkaXN0YW5jZSB0cmVlIGlzIHRyaXZpYWw6ICovCgkgIGZvciAobiA9IDA7IG4gPCBEX0NPREVTOyBuKyspIHsKCSAgICBzdGF0aWNfZHRyZWVbbiAqIDIgKyAxXS8qLkxlbiovID0gNTsKCSAgICBzdGF0aWNfZHRyZWVbbiAqIDJdLyouQ29kZSovID0gYmlfcmV2ZXJzZShuLCA1KTsKCSAgfQoKCSAgLy8gTm93IGRhdGEgcmVhZHkgYW5kIHdlIGNhbiBpbml0IHN0YXRpYyB0cmVlcwoJICBzdGF0aWNfbF9kZXNjID0gbmV3IFN0YXRpY1RyZWVEZXNjKHN0YXRpY19sdHJlZSwgZXh0cmFfbGJpdHMsIExJVEVSQUxTICsgMSwgTF9DT0RFUywgTUFYX0JJVFMpOwoJICBzdGF0aWNfZF9kZXNjID0gbmV3IFN0YXRpY1RyZWVEZXNjKHN0YXRpY19kdHJlZSwgZXh0cmFfZGJpdHMsIDAsICAgICAgICAgIERfQ09ERVMsIE1BWF9CSVRTKTsKCSAgc3RhdGljX2JsX2Rlc2MgPSBuZXcgU3RhdGljVHJlZURlc2MobmV3IEFycmF5KDApLCBleHRyYV9ibGJpdHMsIDAsICAgICAgICAgQkxfQ09ERVMsIE1BWF9CTF9CSVRTKTsKCgkgIC8vc3RhdGljX2luaXRfZG9uZSA9IHRydWU7Cgl9CgoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogSW5pdGlhbGl6ZSBhIG5ldyBibG9jay4KCSAqLwoJZnVuY3Rpb24gaW5pdF9ibG9jayhzKSB7CgkgIHZhciBuOyAvKiBpdGVyYXRlcyBvdmVyIHRyZWUgZWxlbWVudHMgKi8KCgkgIC8qIEluaXRpYWxpemUgdGhlIHRyZWVzLiAqLwoJICBmb3IgKG4gPSAwOyBuIDwgTF9DT0RFUzsgIG4rKykgeyBzLmR5bl9sdHJlZVtuICogMl0vKi5GcmVxKi8gPSAwOyB9CgkgIGZvciAobiA9IDA7IG4gPCBEX0NPREVTOyAgbisrKSB7IHMuZHluX2R0cmVlW24gKiAyXS8qLkZyZXEqLyA9IDA7IH0KCSAgZm9yIChuID0gMDsgbiA8IEJMX0NPREVTOyBuKyspIHsgcy5ibF90cmVlW24gKiAyXS8qLkZyZXEqLyA9IDA7IH0KCgkgIHMuZHluX2x0cmVlW0VORF9CTE9DSyAqIDJdLyouRnJlcSovID0gMTsKCSAgcy5vcHRfbGVuID0gcy5zdGF0aWNfbGVuID0gMDsKCSAgcy5sYXN0X2xpdCA9IHMubWF0Y2hlcyA9IDA7Cgl9CgoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogRmx1c2ggdGhlIGJpdCBidWZmZXIgYW5kIGFsaWduIHRoZSBvdXRwdXQgb24gYSBieXRlIGJvdW5kYXJ5CgkgKi8KCWZ1bmN0aW9uIGJpX3dpbmR1cChzKQoJewoJICBpZiAocy5iaV92YWxpZCA+IDgpIHsKCSAgICBwdXRfc2hvcnQocywgcy5iaV9idWYpOwoJICB9IGVsc2UgaWYgKHMuYmlfdmFsaWQgPiAwKSB7CgkgICAgLy9wdXRfYnl0ZShzLCAoQnl0ZSlzLT5iaV9idWYpOwoJICAgIHMucGVuZGluZ19idWZbcy5wZW5kaW5nKytdID0gcy5iaV9idWY7CgkgIH0KCSAgcy5iaV9idWYgPSAwOwoJICBzLmJpX3ZhbGlkID0gMDsKCX0KCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAqIENvcHkgYSBzdG9yZWQgYmxvY2ssIHN0b3JpbmcgZmlyc3QgdGhlIGxlbmd0aCBhbmQgaXRzCgkgKiBvbmUncyBjb21wbGVtZW50IGlmIHJlcXVlc3RlZC4KCSAqLwoJZnVuY3Rpb24gY29weV9ibG9jayhzLCBidWYsIGxlbiwgaGVhZGVyKQoJLy9EZWZsYXRlU3RhdGUgKnM7CgkvL2NoYXJmICAgICpidWY7ICAgIC8qIHRoZSBpbnB1dCBkYXRhICovCgkvL3Vuc2lnbmVkIGxlbjsgICAgIC8qIGl0cyBsZW5ndGggKi8KCS8vaW50ICAgICAgaGVhZGVyOyAgLyogdHJ1ZSBpZiBibG9jayBoZWFkZXIgbXVzdCBiZSB3cml0dGVuICovCgl7CgkgIGJpX3dpbmR1cChzKTsgICAgICAgIC8qIGFsaWduIG9uIGJ5dGUgYm91bmRhcnkgKi8KCgkgIGlmIChoZWFkZXIpIHsKCSAgICBwdXRfc2hvcnQocywgbGVuKTsKCSAgICBwdXRfc2hvcnQocywgfmxlbik7CgkgIH0KCS8vICB3aGlsZSAobGVuLS0pIHsKCS8vICAgIHB1dF9ieXRlKHMsICpidWYrKyk7CgkvLyAgfQoJICB1dGlscy5hcnJheVNldChzLnBlbmRpbmdfYnVmLCBzLndpbmRvdywgYnVmLCBsZW4sIHMucGVuZGluZyk7CgkgIHMucGVuZGluZyArPSBsZW47Cgl9CgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBDb21wYXJlcyB0byBzdWJ0cmVlcywgdXNpbmcgdGhlIHRyZWUgZGVwdGggYXMgdGllIGJyZWFrZXIgd2hlbgoJICogdGhlIHN1YnRyZWVzIGhhdmUgZXF1YWwgZnJlcXVlbmN5LiBUaGlzIG1pbmltaXplcyB0aGUgd29yc3QgY2FzZSBsZW5ndGguCgkgKi8KCWZ1bmN0aW9uIHNtYWxsZXIodHJlZSwgbiwgbSwgZGVwdGgpIHsKCSAgdmFyIF9uMiA9IG4gKiAyOwoJICB2YXIgX20yID0gbSAqIDI7CgkgIHJldHVybiAodHJlZVtfbjJdLyouRnJlcSovIDwgdHJlZVtfbTJdLyouRnJlcSovIHx8CgkgICAgICAgICAodHJlZVtfbjJdLyouRnJlcSovID09PSB0cmVlW19tMl0vKi5GcmVxKi8gJiYgZGVwdGhbbl0gPD0gZGVwdGhbbV0pKTsKCX0KCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAqIFJlc3RvcmUgdGhlIGhlYXAgcHJvcGVydHkgYnkgbW92aW5nIGRvd24gdGhlIHRyZWUgc3RhcnRpbmcgYXQgbm9kZSBrLAoJICogZXhjaGFuZ2luZyBhIG5vZGUgd2l0aCB0aGUgc21hbGxlc3Qgb2YgaXRzIHR3byBzb25zIGlmIG5lY2Vzc2FyeSwgc3RvcHBpbmcKCSAqIHdoZW4gdGhlIGhlYXAgcHJvcGVydHkgaXMgcmUtZXN0YWJsaXNoZWQgKGVhY2ggZmF0aGVyIHNtYWxsZXIgdGhhbiBpdHMKCSAqIHR3byBzb25zKS4KCSAqLwoJZnVuY3Rpb24gcHFkb3duaGVhcChzLCB0cmVlLCBrKQoJLy8gICAgZGVmbGF0ZV9zdGF0ZSAqczsKCS8vICAgIGN0X2RhdGEgKnRyZWU7ICAvKiB0aGUgdHJlZSB0byByZXN0b3JlICovCgkvLyAgICBpbnQgazsgICAgICAgICAgICAgICAvKiBub2RlIHRvIG1vdmUgZG93biAqLwoJewoJICB2YXIgdiA9IHMuaGVhcFtrXTsKCSAgdmFyIGogPSBrIDw8IDE7ICAvKiBsZWZ0IHNvbiBvZiBrICovCgkgIHdoaWxlIChqIDw9IHMuaGVhcF9sZW4pIHsKCSAgICAvKiBTZXQgaiB0byB0aGUgc21hbGxlc3Qgb2YgdGhlIHR3byBzb25zOiAqLwoJICAgIGlmIChqIDwgcy5oZWFwX2xlbiAmJgoJICAgICAgc21hbGxlcih0cmVlLCBzLmhlYXBbaiArIDFdLCBzLmhlYXBbal0sIHMuZGVwdGgpKSB7CgkgICAgICBqKys7CgkgICAgfQoJICAgIC8qIEV4aXQgaWYgdiBpcyBzbWFsbGVyIHRoYW4gYm90aCBzb25zICovCgkgICAgaWYgKHNtYWxsZXIodHJlZSwgdiwgcy5oZWFwW2pdLCBzLmRlcHRoKSkgeyBicmVhazsgfQoKCSAgICAvKiBFeGNoYW5nZSB2IHdpdGggdGhlIHNtYWxsZXN0IHNvbiAqLwoJICAgIHMuaGVhcFtrXSA9IHMuaGVhcFtqXTsKCSAgICBrID0gajsKCgkgICAgLyogQW5kIGNvbnRpbnVlIGRvd24gdGhlIHRyZWUsIHNldHRpbmcgaiB0byB0aGUgbGVmdCBzb24gb2YgayAqLwoJICAgIGogPDw9IDE7CgkgIH0KCSAgcy5oZWFwW2tdID0gdjsKCX0KCgoJLy8gaW5saW5lZCBtYW51YWxseQoJLy8gdmFyIFNNQUxMRVNUID0gMTsKCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAqIFNlbmQgdGhlIGJsb2NrIGRhdGEgY29tcHJlc3NlZCB1c2luZyB0aGUgZ2l2ZW4gSHVmZm1hbiB0cmVlcwoJICovCglmdW5jdGlvbiBjb21wcmVzc19ibG9jayhzLCBsdHJlZSwgZHRyZWUpCgkvLyAgICBkZWZsYXRlX3N0YXRlICpzOwoJLy8gICAgY29uc3QgY3RfZGF0YSAqbHRyZWU7IC8qIGxpdGVyYWwgdHJlZSAqLwoJLy8gICAgY29uc3QgY3RfZGF0YSAqZHRyZWU7IC8qIGRpc3RhbmNlIHRyZWUgKi8KCXsKCSAgdmFyIGRpc3Q7ICAgICAgICAgICAvKiBkaXN0YW5jZSBvZiBtYXRjaGVkIHN0cmluZyAqLwoJICB2YXIgbGM7ICAgICAgICAgICAgIC8qIG1hdGNoIGxlbmd0aCBvciB1bm1hdGNoZWQgY2hhciAoaWYgZGlzdCA9PSAwKSAqLwoJICB2YXIgbHggPSAwOyAgICAgICAgIC8qIHJ1bm5pbmcgaW5kZXggaW4gbF9idWYgKi8KCSAgdmFyIGNvZGU7ICAgICAgICAgICAvKiB0aGUgY29kZSB0byBzZW5kICovCgkgIHZhciBleHRyYTsgICAgICAgICAgLyogbnVtYmVyIG9mIGV4dHJhIGJpdHMgdG8gc2VuZCAqLwoKCSAgaWYgKHMubGFzdF9saXQgIT09IDApIHsKCSAgICBkbyB7CgkgICAgICBkaXN0ID0gKHMucGVuZGluZ19idWZbcy5kX2J1ZiArIGx4ICogMl0gPDwgOCkgfCAocy5wZW5kaW5nX2J1ZltzLmRfYnVmICsgbHggKiAyICsgMV0pOwoJICAgICAgbGMgPSBzLnBlbmRpbmdfYnVmW3MubF9idWYgKyBseF07CgkgICAgICBseCsrOwoKCSAgICAgIGlmIChkaXN0ID09PSAwKSB7CgkgICAgICAgIHNlbmRfY29kZShzLCBsYywgbHRyZWUpOyAvKiBzZW5kIGEgbGl0ZXJhbCBieXRlICovCgkgICAgICAgIC8vVHJhY2Vjdihpc2dyYXBoKGxjKSwgKHN0ZGVyciwiICclYycgIiwgbGMpKTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIC8qIEhlcmUsIGxjIGlzIHRoZSBtYXRjaCBsZW5ndGggLSBNSU5fTUFUQ0ggKi8KCSAgICAgICAgY29kZSA9IF9sZW5ndGhfY29kZVtsY107CgkgICAgICAgIHNlbmRfY29kZShzLCBjb2RlICsgTElURVJBTFMgKyAxLCBsdHJlZSk7IC8qIHNlbmQgdGhlIGxlbmd0aCBjb2RlICovCgkgICAgICAgIGV4dHJhID0gZXh0cmFfbGJpdHNbY29kZV07CgkgICAgICAgIGlmIChleHRyYSAhPT0gMCkgewoJICAgICAgICAgIGxjIC09IGJhc2VfbGVuZ3RoW2NvZGVdOwoJICAgICAgICAgIHNlbmRfYml0cyhzLCBsYywgZXh0cmEpOyAgICAgICAvKiBzZW5kIHRoZSBleHRyYSBsZW5ndGggYml0cyAqLwoJICAgICAgICB9CgkgICAgICAgIGRpc3QtLTsgLyogZGlzdCBpcyBub3cgdGhlIG1hdGNoIGRpc3RhbmNlIC0gMSAqLwoJICAgICAgICBjb2RlID0gZF9jb2RlKGRpc3QpOwoJICAgICAgICAvL0Fzc2VydCAoY29kZSA8IERfQ09ERVMsICJiYWQgZF9jb2RlIik7CgoJICAgICAgICBzZW5kX2NvZGUocywgY29kZSwgZHRyZWUpOyAgICAgICAvKiBzZW5kIHRoZSBkaXN0YW5jZSBjb2RlICovCgkgICAgICAgIGV4dHJhID0gZXh0cmFfZGJpdHNbY29kZV07CgkgICAgICAgIGlmIChleHRyYSAhPT0gMCkgewoJICAgICAgICAgIGRpc3QgLT0gYmFzZV9kaXN0W2NvZGVdOwoJICAgICAgICAgIHNlbmRfYml0cyhzLCBkaXN0LCBleHRyYSk7ICAgLyogc2VuZCB0aGUgZXh0cmEgZGlzdGFuY2UgYml0cyAqLwoJICAgICAgICB9CgkgICAgICB9IC8qIGxpdGVyYWwgb3IgbWF0Y2ggcGFpciA/ICovCgoJICAgICAgLyogQ2hlY2sgdGhhdCB0aGUgb3ZlcmxheSBiZXR3ZWVuIHBlbmRpbmdfYnVmIGFuZCBkX2J1ZitsX2J1ZiBpcyBvazogKi8KCSAgICAgIC8vQXNzZXJ0KCh1SW50KShzLT5wZW5kaW5nKSA8IHMtPmxpdF9idWZzaXplICsgMipseCwKCSAgICAgIC8vICAgICAgICJwZW5kaW5nQnVmIG92ZXJmbG93Iik7CgoJICAgIH0gd2hpbGUgKGx4IDwgcy5sYXN0X2xpdCk7CgkgIH0KCgkgIHNlbmRfY29kZShzLCBFTkRfQkxPQ0ssIGx0cmVlKTsKCX0KCgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBDb25zdHJ1Y3Qgb25lIEh1ZmZtYW4gdHJlZSBhbmQgYXNzaWducyB0aGUgY29kZSBiaXQgc3RyaW5ncyBhbmQgbGVuZ3Rocy4KCSAqIFVwZGF0ZSB0aGUgdG90YWwgYml0IGxlbmd0aCBmb3IgdGhlIGN1cnJlbnQgYmxvY2suCgkgKiBJTiBhc3NlcnRpb246IHRoZSBmaWVsZCBmcmVxIGlzIHNldCBmb3IgYWxsIHRyZWUgZWxlbWVudHMuCgkgKiBPVVQgYXNzZXJ0aW9uczogdGhlIGZpZWxkcyBsZW4gYW5kIGNvZGUgYXJlIHNldCB0byB0aGUgb3B0aW1hbCBiaXQgbGVuZ3RoCgkgKiAgICAgYW5kIGNvcnJlc3BvbmRpbmcgY29kZS4gVGhlIGxlbmd0aCBvcHRfbGVuIGlzIHVwZGF0ZWQ7IHN0YXRpY19sZW4gaXMKCSAqICAgICBhbHNvIHVwZGF0ZWQgaWYgc3RyZWUgaXMgbm90IG51bGwuIFRoZSBmaWVsZCBtYXhfY29kZSBpcyBzZXQuCgkgKi8KCWZ1bmN0aW9uIGJ1aWxkX3RyZWUocywgZGVzYykKCS8vICAgIGRlZmxhdGVfc3RhdGUgKnM7CgkvLyAgICB0cmVlX2Rlc2MgKmRlc2M7IC8qIHRoZSB0cmVlIGRlc2NyaXB0b3IgKi8KCXsKCSAgdmFyIHRyZWUgICAgID0gZGVzYy5keW5fdHJlZTsKCSAgdmFyIHN0cmVlICAgID0gZGVzYy5zdGF0X2Rlc2Muc3RhdGljX3RyZWU7CgkgIHZhciBoYXNfc3RyZWUgPSBkZXNjLnN0YXRfZGVzYy5oYXNfc3RyZWU7CgkgIHZhciBlbGVtcyAgICA9IGRlc2Muc3RhdF9kZXNjLmVsZW1zOwoJICB2YXIgbiwgbTsgICAgICAgICAgLyogaXRlcmF0ZSBvdmVyIGhlYXAgZWxlbWVudHMgKi8KCSAgdmFyIG1heF9jb2RlID0gLTE7IC8qIGxhcmdlc3QgY29kZSB3aXRoIG5vbiB6ZXJvIGZyZXF1ZW5jeSAqLwoJICB2YXIgbm9kZTsgICAgICAgICAgLyogbmV3IG5vZGUgYmVpbmcgY3JlYXRlZCAqLwoKCSAgLyogQ29uc3RydWN0IHRoZSBpbml0aWFsIGhlYXAsIHdpdGggbGVhc3QgZnJlcXVlbnQgZWxlbWVudCBpbgoJICAgKiBoZWFwW1NNQUxMRVNUXS4gVGhlIHNvbnMgb2YgaGVhcFtuXSBhcmUgaGVhcFsyKm5dIGFuZCBoZWFwWzIqbisxXS4KCSAgICogaGVhcFswXSBpcyBub3QgdXNlZC4KCSAgICovCgkgIHMuaGVhcF9sZW4gPSAwOwoJICBzLmhlYXBfbWF4ID0gSEVBUF9TSVpFOwoKCSAgZm9yIChuID0gMDsgbiA8IGVsZW1zOyBuKyspIHsKCSAgICBpZiAodHJlZVtuICogMl0vKi5GcmVxKi8gIT09IDApIHsKCSAgICAgIHMuaGVhcFsrK3MuaGVhcF9sZW5dID0gbWF4X2NvZGUgPSBuOwoJICAgICAgcy5kZXB0aFtuXSA9IDA7CgoJICAgIH0gZWxzZSB7CgkgICAgICB0cmVlW24gKiAyICsgMV0vKi5MZW4qLyA9IDA7CgkgICAgfQoJICB9CgoJICAvKiBUaGUgcGt6aXAgZm9ybWF0IHJlcXVpcmVzIHRoYXQgYXQgbGVhc3Qgb25lIGRpc3RhbmNlIGNvZGUgZXhpc3RzLAoJICAgKiBhbmQgdGhhdCBhdCBsZWFzdCBvbmUgYml0IHNob3VsZCBiZSBzZW50IGV2ZW4gaWYgdGhlcmUgaXMgb25seSBvbmUKCSAgICogcG9zc2libGUgY29kZS4gU28gdG8gYXZvaWQgc3BlY2lhbCBjaGVja3MgbGF0ZXIgb24gd2UgZm9yY2UgYXQgbGVhc3QKCSAgICogdHdvIGNvZGVzIG9mIG5vbiB6ZXJvIGZyZXF1ZW5jeS4KCSAgICovCgkgIHdoaWxlIChzLmhlYXBfbGVuIDwgMikgewoJICAgIG5vZGUgPSBzLmhlYXBbKytzLmhlYXBfbGVuXSA9IChtYXhfY29kZSA8IDIgPyArK21heF9jb2RlIDogMCk7CgkgICAgdHJlZVtub2RlICogMl0vKi5GcmVxKi8gPSAxOwoJICAgIHMuZGVwdGhbbm9kZV0gPSAwOwoJICAgIHMub3B0X2xlbi0tOwoKCSAgICBpZiAoaGFzX3N0cmVlKSB7CgkgICAgICBzLnN0YXRpY19sZW4gLT0gc3RyZWVbbm9kZSAqIDIgKyAxXS8qLkxlbiovOwoJICAgIH0KCSAgICAvKiBub2RlIGlzIDAgb3IgMSBzbyBpdCBkb2VzIG5vdCBoYXZlIGV4dHJhIGJpdHMgKi8KCSAgfQoJICBkZXNjLm1heF9jb2RlID0gbWF4X2NvZGU7CgoJICAvKiBUaGUgZWxlbWVudHMgaGVhcFtoZWFwX2xlbi8yKzEgLi4gaGVhcF9sZW5dIGFyZSBsZWF2ZXMgb2YgdGhlIHRyZWUsCgkgICAqIGVzdGFibGlzaCBzdWItaGVhcHMgb2YgaW5jcmVhc2luZyBsZW5ndGhzOgoJICAgKi8KCSAgZm9yIChuID0gKHMuaGVhcF9sZW4gPj4gMS8qaW50IC8yKi8pOyBuID49IDE7IG4tLSkgeyBwcWRvd25oZWFwKHMsIHRyZWUsIG4pOyB9CgoJICAvKiBDb25zdHJ1Y3QgdGhlIEh1ZmZtYW4gdHJlZSBieSByZXBlYXRlZGx5IGNvbWJpbmluZyB0aGUgbGVhc3QgdHdvCgkgICAqIGZyZXF1ZW50IG5vZGVzLgoJICAgKi8KCSAgbm9kZSA9IGVsZW1zOyAgICAgICAgICAgICAgLyogbmV4dCBpbnRlcm5hbCBub2RlIG9mIHRoZSB0cmVlICovCgkgIGRvIHsKCSAgICAvL3BxcmVtb3ZlKHMsIHRyZWUsIG4pOyAgLyogbiA9IG5vZGUgb2YgbGVhc3QgZnJlcXVlbmN5ICovCgkgICAgLyoqKiBwcXJlbW92ZSAqKiovCgkgICAgbiA9IHMuaGVhcFsxLypTTUFMTEVTVCovXTsKCSAgICBzLmhlYXBbMS8qU01BTExFU1QqL10gPSBzLmhlYXBbcy5oZWFwX2xlbi0tXTsKCSAgICBwcWRvd25oZWFwKHMsIHRyZWUsIDEvKlNNQUxMRVNUKi8pOwoJICAgIC8qKiovCgoJICAgIG0gPSBzLmhlYXBbMS8qU01BTExFU1QqL107IC8qIG0gPSBub2RlIG9mIG5leHQgbGVhc3QgZnJlcXVlbmN5ICovCgoJICAgIHMuaGVhcFstLXMuaGVhcF9tYXhdID0gbjsgLyoga2VlcCB0aGUgbm9kZXMgc29ydGVkIGJ5IGZyZXF1ZW5jeSAqLwoJICAgIHMuaGVhcFstLXMuaGVhcF9tYXhdID0gbTsKCgkgICAgLyogQ3JlYXRlIGEgbmV3IG5vZGUgZmF0aGVyIG9mIG4gYW5kIG0gKi8KCSAgICB0cmVlW25vZGUgKiAyXS8qLkZyZXEqLyA9IHRyZWVbbiAqIDJdLyouRnJlcSovICsgdHJlZVttICogMl0vKi5GcmVxKi87CgkgICAgcy5kZXB0aFtub2RlXSA9IChzLmRlcHRoW25dID49IHMuZGVwdGhbbV0gPyBzLmRlcHRoW25dIDogcy5kZXB0aFttXSkgKyAxOwoJICAgIHRyZWVbbiAqIDIgKyAxXS8qLkRhZCovID0gdHJlZVttICogMiArIDFdLyouRGFkKi8gPSBub2RlOwoKCSAgICAvKiBhbmQgaW5zZXJ0IHRoZSBuZXcgbm9kZSBpbiB0aGUgaGVhcCAqLwoJICAgIHMuaGVhcFsxLypTTUFMTEVTVCovXSA9IG5vZGUrKzsKCSAgICBwcWRvd25oZWFwKHMsIHRyZWUsIDEvKlNNQUxMRVNUKi8pOwoKCSAgfSB3aGlsZSAocy5oZWFwX2xlbiA+PSAyKTsKCgkgIHMuaGVhcFstLXMuaGVhcF9tYXhdID0gcy5oZWFwWzEvKlNNQUxMRVNUKi9dOwoKCSAgLyogQXQgdGhpcyBwb2ludCwgdGhlIGZpZWxkcyBmcmVxIGFuZCBkYWQgYXJlIHNldC4gV2UgY2FuIG5vdwoJICAgKiBnZW5lcmF0ZSB0aGUgYml0IGxlbmd0aHMuCgkgICAqLwoJICBnZW5fYml0bGVuKHMsIGRlc2MpOwoKCSAgLyogVGhlIGZpZWxkIGxlbiBpcyBub3cgc2V0LCB3ZSBjYW4gZ2VuZXJhdGUgdGhlIGJpdCBjb2RlcyAqLwoJICBnZW5fY29kZXModHJlZSwgbWF4X2NvZGUsIHMuYmxfY291bnQpOwoJfQoKCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAqIFNjYW4gYSBsaXRlcmFsIG9yIGRpc3RhbmNlIHRyZWUgdG8gZGV0ZXJtaW5lIHRoZSBmcmVxdWVuY2llcyBvZiB0aGUgY29kZXMKCSAqIGluIHRoZSBiaXQgbGVuZ3RoIHRyZWUuCgkgKi8KCWZ1bmN0aW9uIHNjYW5fdHJlZShzLCB0cmVlLCBtYXhfY29kZSkKCS8vICAgIGRlZmxhdGVfc3RhdGUgKnM7CgkvLyAgICBjdF9kYXRhICp0cmVlOyAgIC8qIHRoZSB0cmVlIHRvIGJlIHNjYW5uZWQgKi8KCS8vICAgIGludCBtYXhfY29kZTsgICAgLyogYW5kIGl0cyBsYXJnZXN0IGNvZGUgb2Ygbm9uIHplcm8gZnJlcXVlbmN5ICovCgl7CgkgIHZhciBuOyAgICAgICAgICAgICAgICAgICAgIC8qIGl0ZXJhdGVzIG92ZXIgYWxsIHRyZWUgZWxlbWVudHMgKi8KCSAgdmFyIHByZXZsZW4gPSAtMTsgICAgICAgICAgLyogbGFzdCBlbWl0dGVkIGxlbmd0aCAqLwoJICB2YXIgY3VybGVuOyAgICAgICAgICAgICAgICAvKiBsZW5ndGggb2YgY3VycmVudCBjb2RlICovCgoJICB2YXIgbmV4dGxlbiA9IHRyZWVbMCAqIDIgKyAxXS8qLkxlbiovOyAvKiBsZW5ndGggb2YgbmV4dCBjb2RlICovCgoJICB2YXIgY291bnQgPSAwOyAgICAgICAgICAgICAvKiByZXBlYXQgY291bnQgb2YgdGhlIGN1cnJlbnQgY29kZSAqLwoJICB2YXIgbWF4X2NvdW50ID0gNzsgICAgICAgICAvKiBtYXggcmVwZWF0IGNvdW50ICovCgkgIHZhciBtaW5fY291bnQgPSA0OyAgICAgICAgIC8qIG1pbiByZXBlYXQgY291bnQgKi8KCgkgIGlmIChuZXh0bGVuID09PSAwKSB7CgkgICAgbWF4X2NvdW50ID0gMTM4OwoJICAgIG1pbl9jb3VudCA9IDM7CgkgIH0KCSAgdHJlZVsobWF4X2NvZGUgKyAxKSAqIDIgKyAxXS8qLkxlbiovID0gMHhmZmZmOyAvKiBndWFyZCAqLwoKCSAgZm9yIChuID0gMDsgbiA8PSBtYXhfY29kZTsgbisrKSB7CgkgICAgY3VybGVuID0gbmV4dGxlbjsKCSAgICBuZXh0bGVuID0gdHJlZVsobiArIDEpICogMiArIDFdLyouTGVuKi87CgoJICAgIGlmICgrK2NvdW50IDwgbWF4X2NvdW50ICYmIGN1cmxlbiA9PT0gbmV4dGxlbikgewoJICAgICAgY29udGludWU7CgoJICAgIH0gZWxzZSBpZiAoY291bnQgPCBtaW5fY291bnQpIHsKCSAgICAgIHMuYmxfdHJlZVtjdXJsZW4gKiAyXS8qLkZyZXEqLyArPSBjb3VudDsKCgkgICAgfSBlbHNlIGlmIChjdXJsZW4gIT09IDApIHsKCgkgICAgICBpZiAoY3VybGVuICE9PSBwcmV2bGVuKSB7IHMuYmxfdHJlZVtjdXJsZW4gKiAyXS8qLkZyZXEqLysrOyB9CgkgICAgICBzLmJsX3RyZWVbUkVQXzNfNiAqIDJdLyouRnJlcSovKys7CgoJICAgIH0gZWxzZSBpZiAoY291bnQgPD0gMTApIHsKCSAgICAgIHMuYmxfdHJlZVtSRVBaXzNfMTAgKiAyXS8qLkZyZXEqLysrOwoKCSAgICB9IGVsc2UgewoJICAgICAgcy5ibF90cmVlW1JFUFpfMTFfMTM4ICogMl0vKi5GcmVxKi8rKzsKCSAgICB9CgoJICAgIGNvdW50ID0gMDsKCSAgICBwcmV2bGVuID0gY3VybGVuOwoKCSAgICBpZiAobmV4dGxlbiA9PT0gMCkgewoJICAgICAgbWF4X2NvdW50ID0gMTM4OwoJICAgICAgbWluX2NvdW50ID0gMzsKCgkgICAgfSBlbHNlIGlmIChjdXJsZW4gPT09IG5leHRsZW4pIHsKCSAgICAgIG1heF9jb3VudCA9IDY7CgkgICAgICBtaW5fY291bnQgPSAzOwoKCSAgICB9IGVsc2UgewoJICAgICAgbWF4X2NvdW50ID0gNzsKCSAgICAgIG1pbl9jb3VudCA9IDQ7CgkgICAgfQoJICB9Cgl9CgoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogU2VuZCBhIGxpdGVyYWwgb3IgZGlzdGFuY2UgdHJlZSBpbiBjb21wcmVzc2VkIGZvcm0sIHVzaW5nIHRoZSBjb2RlcyBpbgoJICogYmxfdHJlZS4KCSAqLwoJZnVuY3Rpb24gc2VuZF90cmVlKHMsIHRyZWUsIG1heF9jb2RlKQoJLy8gICAgZGVmbGF0ZV9zdGF0ZSAqczsKCS8vICAgIGN0X2RhdGEgKnRyZWU7IC8qIHRoZSB0cmVlIHRvIGJlIHNjYW5uZWQgKi8KCS8vICAgIGludCBtYXhfY29kZTsgICAgICAgLyogYW5kIGl0cyBsYXJnZXN0IGNvZGUgb2Ygbm9uIHplcm8gZnJlcXVlbmN5ICovCgl7CgkgIHZhciBuOyAgICAgICAgICAgICAgICAgICAgIC8qIGl0ZXJhdGVzIG92ZXIgYWxsIHRyZWUgZWxlbWVudHMgKi8KCSAgdmFyIHByZXZsZW4gPSAtMTsgICAgICAgICAgLyogbGFzdCBlbWl0dGVkIGxlbmd0aCAqLwoJICB2YXIgY3VybGVuOyAgICAgICAgICAgICAgICAvKiBsZW5ndGggb2YgY3VycmVudCBjb2RlICovCgoJICB2YXIgbmV4dGxlbiA9IHRyZWVbMCAqIDIgKyAxXS8qLkxlbiovOyAvKiBsZW5ndGggb2YgbmV4dCBjb2RlICovCgoJICB2YXIgY291bnQgPSAwOyAgICAgICAgICAgICAvKiByZXBlYXQgY291bnQgb2YgdGhlIGN1cnJlbnQgY29kZSAqLwoJICB2YXIgbWF4X2NvdW50ID0gNzsgICAgICAgICAvKiBtYXggcmVwZWF0IGNvdW50ICovCgkgIHZhciBtaW5fY291bnQgPSA0OyAgICAgICAgIC8qIG1pbiByZXBlYXQgY291bnQgKi8KCgkgIC8qIHRyZWVbbWF4X2NvZGUrMV0uTGVuID0gLTE7ICovICAvKiBndWFyZCBhbHJlYWR5IHNldCAqLwoJICBpZiAobmV4dGxlbiA9PT0gMCkgewoJICAgIG1heF9jb3VudCA9IDEzODsKCSAgICBtaW5fY291bnQgPSAzOwoJICB9CgoJICBmb3IgKG4gPSAwOyBuIDw9IG1heF9jb2RlOyBuKyspIHsKCSAgICBjdXJsZW4gPSBuZXh0bGVuOwoJICAgIG5leHRsZW4gPSB0cmVlWyhuICsgMSkgKiAyICsgMV0vKi5MZW4qLzsKCgkgICAgaWYgKCsrY291bnQgPCBtYXhfY291bnQgJiYgY3VybGVuID09PSBuZXh0bGVuKSB7CgkgICAgICBjb250aW51ZTsKCgkgICAgfSBlbHNlIGlmIChjb3VudCA8IG1pbl9jb3VudCkgewoJICAgICAgZG8geyBzZW5kX2NvZGUocywgY3VybGVuLCBzLmJsX3RyZWUpOyB9IHdoaWxlICgtLWNvdW50ICE9PSAwKTsKCgkgICAgfSBlbHNlIGlmIChjdXJsZW4gIT09IDApIHsKCSAgICAgIGlmIChjdXJsZW4gIT09IHByZXZsZW4pIHsKCSAgICAgICAgc2VuZF9jb2RlKHMsIGN1cmxlbiwgcy5ibF90cmVlKTsKCSAgICAgICAgY291bnQtLTsKCSAgICAgIH0KCSAgICAgIC8vQXNzZXJ0KGNvdW50ID49IDMgJiYgY291bnQgPD0gNiwgIiAzXzY/Iik7CgkgICAgICBzZW5kX2NvZGUocywgUkVQXzNfNiwgcy5ibF90cmVlKTsKCSAgICAgIHNlbmRfYml0cyhzLCBjb3VudCAtIDMsIDIpOwoKCSAgICB9IGVsc2UgaWYgKGNvdW50IDw9IDEwKSB7CgkgICAgICBzZW5kX2NvZGUocywgUkVQWl8zXzEwLCBzLmJsX3RyZWUpOwoJICAgICAgc2VuZF9iaXRzKHMsIGNvdW50IC0gMywgMyk7CgoJICAgIH0gZWxzZSB7CgkgICAgICBzZW5kX2NvZGUocywgUkVQWl8xMV8xMzgsIHMuYmxfdHJlZSk7CgkgICAgICBzZW5kX2JpdHMocywgY291bnQgLSAxMSwgNyk7CgkgICAgfQoKCSAgICBjb3VudCA9IDA7CgkgICAgcHJldmxlbiA9IGN1cmxlbjsKCSAgICBpZiAobmV4dGxlbiA9PT0gMCkgewoJICAgICAgbWF4X2NvdW50ID0gMTM4OwoJICAgICAgbWluX2NvdW50ID0gMzsKCgkgICAgfSBlbHNlIGlmIChjdXJsZW4gPT09IG5leHRsZW4pIHsKCSAgICAgIG1heF9jb3VudCA9IDY7CgkgICAgICBtaW5fY291bnQgPSAzOwoKCSAgICB9IGVsc2UgewoJICAgICAgbWF4X2NvdW50ID0gNzsKCSAgICAgIG1pbl9jb3VudCA9IDQ7CgkgICAgfQoJICB9Cgl9CgoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogQ29uc3RydWN0IHRoZSBIdWZmbWFuIHRyZWUgZm9yIHRoZSBiaXQgbGVuZ3RocyBhbmQgcmV0dXJuIHRoZSBpbmRleCBpbgoJICogYmxfb3JkZXIgb2YgdGhlIGxhc3QgYml0IGxlbmd0aCBjb2RlIHRvIHNlbmQuCgkgKi8KCWZ1bmN0aW9uIGJ1aWxkX2JsX3RyZWUocykgewoJICB2YXIgbWF4X2JsaW5kZXg7ICAvKiBpbmRleCBvZiBsYXN0IGJpdCBsZW5ndGggY29kZSBvZiBub24gemVybyBmcmVxICovCgoJICAvKiBEZXRlcm1pbmUgdGhlIGJpdCBsZW5ndGggZnJlcXVlbmNpZXMgZm9yIGxpdGVyYWwgYW5kIGRpc3RhbmNlIHRyZWVzICovCgkgIHNjYW5fdHJlZShzLCBzLmR5bl9sdHJlZSwgcy5sX2Rlc2MubWF4X2NvZGUpOwoJICBzY2FuX3RyZWUocywgcy5keW5fZHRyZWUsIHMuZF9kZXNjLm1heF9jb2RlKTsKCgkgIC8qIEJ1aWxkIHRoZSBiaXQgbGVuZ3RoIHRyZWU6ICovCgkgIGJ1aWxkX3RyZWUocywgcy5ibF9kZXNjKTsKCSAgLyogb3B0X2xlbiBub3cgaW5jbHVkZXMgdGhlIGxlbmd0aCBvZiB0aGUgdHJlZSByZXByZXNlbnRhdGlvbnMsIGV4Y2VwdAoJICAgKiB0aGUgbGVuZ3RocyBvZiB0aGUgYml0IGxlbmd0aHMgY29kZXMgYW5kIHRoZSA1KzUrNCBiaXRzIGZvciB0aGUgY291bnRzLgoJICAgKi8KCgkgIC8qIERldGVybWluZSB0aGUgbnVtYmVyIG9mIGJpdCBsZW5ndGggY29kZXMgdG8gc2VuZC4gVGhlIHBremlwIGZvcm1hdAoJICAgKiByZXF1aXJlcyB0aGF0IGF0IGxlYXN0IDQgYml0IGxlbmd0aCBjb2RlcyBiZSBzZW50LiAoYXBwbm90ZS50eHQgc2F5cwoJICAgKiAzIGJ1dCB0aGUgYWN0dWFsIHZhbHVlIHVzZWQgaXMgNC4pCgkgICAqLwoJICBmb3IgKG1heF9ibGluZGV4ID0gQkxfQ09ERVMgLSAxOyBtYXhfYmxpbmRleCA+PSAzOyBtYXhfYmxpbmRleC0tKSB7CgkgICAgaWYgKHMuYmxfdHJlZVtibF9vcmRlclttYXhfYmxpbmRleF0gKiAyICsgMV0vKi5MZW4qLyAhPT0gMCkgewoJICAgICAgYnJlYWs7CgkgICAgfQoJICB9CgkgIC8qIFVwZGF0ZSBvcHRfbGVuIHRvIGluY2x1ZGUgdGhlIGJpdCBsZW5ndGggdHJlZSBhbmQgY291bnRzICovCgkgIHMub3B0X2xlbiArPSAzICogKG1heF9ibGluZGV4ICsgMSkgKyA1ICsgNSArIDQ7CgkgIC8vVHJhY2V2KChzdGRlcnIsICJcbmR5biB0cmVlczogZHluICVsZCwgc3RhdCAlbGQiLAoJICAvLyAgICAgICAgcy0+b3B0X2xlbiwgcy0+c3RhdGljX2xlbikpOwoKCSAgcmV0dXJuIG1heF9ibGluZGV4OwoJfQoKCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAqIFNlbmQgdGhlIGhlYWRlciBmb3IgYSBibG9jayB1c2luZyBkeW5hbWljIEh1ZmZtYW4gdHJlZXM6IHRoZSBjb3VudHMsIHRoZQoJICogbGVuZ3RocyBvZiB0aGUgYml0IGxlbmd0aCBjb2RlcywgdGhlIGxpdGVyYWwgdHJlZSBhbmQgdGhlIGRpc3RhbmNlIHRyZWUuCgkgKiBJTiBhc3NlcnRpb246IGxjb2RlcyA+PSAyNTcsIGRjb2RlcyA+PSAxLCBibGNvZGVzID49IDQuCgkgKi8KCWZ1bmN0aW9uIHNlbmRfYWxsX3RyZWVzKHMsIGxjb2RlcywgZGNvZGVzLCBibGNvZGVzKQoJLy8gICAgZGVmbGF0ZV9zdGF0ZSAqczsKCS8vICAgIGludCBsY29kZXMsIGRjb2RlcywgYmxjb2RlczsgLyogbnVtYmVyIG9mIGNvZGVzIGZvciBlYWNoIHRyZWUgKi8KCXsKCSAgdmFyIHJhbms7ICAgICAgICAgICAgICAgICAgICAvKiBpbmRleCBpbiBibF9vcmRlciAqLwoKCSAgLy9Bc3NlcnQgKGxjb2RlcyA+PSAyNTcgJiYgZGNvZGVzID49IDEgJiYgYmxjb2RlcyA+PSA0LCAibm90IGVub3VnaCBjb2RlcyIpOwoJICAvL0Fzc2VydCAobGNvZGVzIDw9IExfQ09ERVMgJiYgZGNvZGVzIDw9IERfQ09ERVMgJiYgYmxjb2RlcyA8PSBCTF9DT0RFUywKCSAgLy8gICAgICAgICJ0b28gbWFueSBjb2RlcyIpOwoJICAvL1RyYWNldigoc3RkZXJyLCAiXG5ibCBjb3VudHM6ICIpKTsKCSAgc2VuZF9iaXRzKHMsIGxjb2RlcyAtIDI1NywgNSk7IC8qIG5vdCArMjU1IGFzIHN0YXRlZCBpbiBhcHBub3RlLnR4dCAqLwoJICBzZW5kX2JpdHMocywgZGNvZGVzIC0gMSwgICA1KTsKCSAgc2VuZF9iaXRzKHMsIGJsY29kZXMgLSA0LCAgNCk7IC8qIG5vdCAtMyBhcyBzdGF0ZWQgaW4gYXBwbm90ZS50eHQgKi8KCSAgZm9yIChyYW5rID0gMDsgcmFuayA8IGJsY29kZXM7IHJhbmsrKykgewoJICAgIC8vVHJhY2V2KChzdGRlcnIsICJcbmJsIGNvZGUgJTJkICIsIGJsX29yZGVyW3JhbmtdKSk7CgkgICAgc2VuZF9iaXRzKHMsIHMuYmxfdHJlZVtibF9vcmRlcltyYW5rXSAqIDIgKyAxXS8qLkxlbiovLCAzKTsKCSAgfQoJICAvL1RyYWNldigoc3RkZXJyLCAiXG5ibCB0cmVlOiBzZW50ICVsZCIsIHMtPmJpdHNfc2VudCkpOwoKCSAgc2VuZF90cmVlKHMsIHMuZHluX2x0cmVlLCBsY29kZXMgLSAxKTsgLyogbGl0ZXJhbCB0cmVlICovCgkgIC8vVHJhY2V2KChzdGRlcnIsICJcbmxpdCB0cmVlOiBzZW50ICVsZCIsIHMtPmJpdHNfc2VudCkpOwoKCSAgc2VuZF90cmVlKHMsIHMuZHluX2R0cmVlLCBkY29kZXMgLSAxKTsgLyogZGlzdGFuY2UgdHJlZSAqLwoJICAvL1RyYWNldigoc3RkZXJyLCAiXG5kaXN0IHRyZWU6IHNlbnQgJWxkIiwgcy0+Yml0c19zZW50KSk7Cgl9CgoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogQ2hlY2sgaWYgdGhlIGRhdGEgdHlwZSBpcyBURVhUIG9yIEJJTkFSWSwgdXNpbmcgdGhlIGZvbGxvd2luZyBhbGdvcml0aG06CgkgKiAtIFRFWFQgaWYgdGhlIHR3byBjb25kaXRpb25zIGJlbG93IGFyZSBzYXRpc2ZpZWQ6CgkgKiAgICBhKSBUaGVyZSBhcmUgbm8gbm9uLXBvcnRhYmxlIGNvbnRyb2wgY2hhcmFjdGVycyBiZWxvbmdpbmcgdG8gdGhlCgkgKiAgICAgICAiYmxhY2sgbGlzdCIgKDAuLjYsIDE0Li4yNSwgMjguLjMxKS4KCSAqICAgIGIpIFRoZXJlIGlzIGF0IGxlYXN0IG9uZSBwcmludGFibGUgY2hhcmFjdGVyIGJlbG9uZ2luZyB0byB0aGUKCSAqICAgICAgICJ3aGl0ZSBsaXN0IiAoOSB7VEFCfSwgMTAge0xGfSwgMTMge0NSfSwgMzIuLjI1NSkuCgkgKiAtIEJJTkFSWSBvdGhlcndpc2UuCgkgKiAtIFRoZSBmb2xsb3dpbmcgcGFydGlhbGx5LXBvcnRhYmxlIGNvbnRyb2wgY2hhcmFjdGVycyBmb3JtIGEKCSAqICAgImdyYXkgbGlzdCIgdGhhdCBpcyBpZ25vcmVkIGluIHRoaXMgZGV0ZWN0aW9uIGFsZ29yaXRobToKCSAqICAgKDcge0JFTH0sIDgge0JTfSwgMTEge1ZUfSwgMTIge0ZGfSwgMjYge1NVQn0sIDI3IHtFU0N9KS4KCSAqIElOIGFzc2VydGlvbjogdGhlIGZpZWxkcyBGcmVxIG9mIGR5bl9sdHJlZSBhcmUgc2V0LgoJICovCglmdW5jdGlvbiBkZXRlY3RfZGF0YV90eXBlKHMpIHsKCSAgLyogYmxhY2tfbWFzayBpcyB0aGUgYml0IG1hc2sgb2YgYmxhY2stbGlzdGVkIGJ5dGVzCgkgICAqIHNldCBiaXRzIDAuLjYsIDE0Li4yNSwgYW5kIDI4Li4zMQoJICAgKiAweGYzZmZjMDdmID0gYmluYXJ5IDExMTEwMDExMTExMTExMTExMTAwMDAwMDAxMTExMTExCgkgICAqLwoJICB2YXIgYmxhY2tfbWFzayA9IDB4ZjNmZmMwN2Y7CgkgIHZhciBuOwoKCSAgLyogQ2hlY2sgZm9yIG5vbi10ZXh0dWFsICgiYmxhY2stbGlzdGVkIikgYnl0ZXMuICovCgkgIGZvciAobiA9IDA7IG4gPD0gMzE7IG4rKywgYmxhY2tfbWFzayA+Pj49IDEpIHsKCSAgICBpZiAoKGJsYWNrX21hc2sgJiAxKSAmJiAocy5keW5fbHRyZWVbbiAqIDJdLyouRnJlcSovICE9PSAwKSkgewoJICAgICAgcmV0dXJuIFpfQklOQVJZOwoJICAgIH0KCSAgfQoKCSAgLyogQ2hlY2sgZm9yIHRleHR1YWwgKCJ3aGl0ZS1saXN0ZWQiKSBieXRlcy4gKi8KCSAgaWYgKHMuZHluX2x0cmVlWzkgKiAyXS8qLkZyZXEqLyAhPT0gMCB8fCBzLmR5bl9sdHJlZVsxMCAqIDJdLyouRnJlcSovICE9PSAwIHx8CgkgICAgICBzLmR5bl9sdHJlZVsxMyAqIDJdLyouRnJlcSovICE9PSAwKSB7CgkgICAgcmV0dXJuIFpfVEVYVDsKCSAgfQoJICBmb3IgKG4gPSAzMjsgbiA8IExJVEVSQUxTOyBuKyspIHsKCSAgICBpZiAocy5keW5fbHRyZWVbbiAqIDJdLyouRnJlcSovICE9PSAwKSB7CgkgICAgICByZXR1cm4gWl9URVhUOwoJICAgIH0KCSAgfQoKCSAgLyogVGhlcmUgYXJlIG5vICJibGFjay1saXN0ZWQiIG9yICJ3aGl0ZS1saXN0ZWQiIGJ5dGVzOgoJICAgKiB0aGlzIHN0cmVhbSBlaXRoZXIgaXMgZW1wdHkgb3IgaGFzIHRvbGVyYXRlZCAoImdyYXktbGlzdGVkIikgYnl0ZXMgb25seS4KCSAgICovCgkgIHJldHVybiBaX0JJTkFSWTsKCX0KCgoJdmFyIHN0YXRpY19pbml0X2RvbmUgPSBmYWxzZTsKCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAqIEluaXRpYWxpemUgdGhlIHRyZWUgZGF0YSBzdHJ1Y3R1cmVzIGZvciBhIG5ldyB6bGliIHN0cmVhbS4KCSAqLwoJZnVuY3Rpb24gX3RyX2luaXQocykKCXsKCgkgIGlmICghc3RhdGljX2luaXRfZG9uZSkgewoJICAgIHRyX3N0YXRpY19pbml0KCk7CgkgICAgc3RhdGljX2luaXRfZG9uZSA9IHRydWU7CgkgIH0KCgkgIHMubF9kZXNjICA9IG5ldyBUcmVlRGVzYyhzLmR5bl9sdHJlZSwgc3RhdGljX2xfZGVzYyk7CgkgIHMuZF9kZXNjICA9IG5ldyBUcmVlRGVzYyhzLmR5bl9kdHJlZSwgc3RhdGljX2RfZGVzYyk7CgkgIHMuYmxfZGVzYyA9IG5ldyBUcmVlRGVzYyhzLmJsX3RyZWUsIHN0YXRpY19ibF9kZXNjKTsKCgkgIHMuYmlfYnVmID0gMDsKCSAgcy5iaV92YWxpZCA9IDA7CgoJICAvKiBJbml0aWFsaXplIHRoZSBmaXJzdCBibG9jayBvZiB0aGUgZmlyc3QgZmlsZTogKi8KCSAgaW5pdF9ibG9jayhzKTsKCX0KCgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBTZW5kIGEgc3RvcmVkIGJsb2NrCgkgKi8KCWZ1bmN0aW9uIF90cl9zdG9yZWRfYmxvY2socywgYnVmLCBzdG9yZWRfbGVuLCBsYXN0KQoJLy9EZWZsYXRlU3RhdGUgKnM7CgkvL2NoYXJmICpidWY7ICAgICAgIC8qIGlucHV0IGJsb2NrICovCgkvL3VsZyBzdG9yZWRfbGVuOyAgIC8qIGxlbmd0aCBvZiBpbnB1dCBibG9jayAqLwoJLy9pbnQgbGFzdDsgICAgICAgICAvKiBvbmUgaWYgdGhpcyBpcyB0aGUgbGFzdCBibG9jayBmb3IgYSBmaWxlICovCgl7CgkgIHNlbmRfYml0cyhzLCAoU1RPUkVEX0JMT0NLIDw8IDEpICsgKGxhc3QgPyAxIDogMCksIDMpOyAgICAvKiBzZW5kIGJsb2NrIHR5cGUgKi8KCSAgY29weV9ibG9jayhzLCBidWYsIHN0b3JlZF9sZW4sIHRydWUpOyAvKiB3aXRoIGhlYWRlciAqLwoJfQoKCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCSAqIFNlbmQgb25lIGVtcHR5IHN0YXRpYyBibG9jayB0byBnaXZlIGVub3VnaCBsb29rYWhlYWQgZm9yIGluZmxhdGUuCgkgKiBUaGlzIHRha2VzIDEwIGJpdHMsIG9mIHdoaWNoIDcgbWF5IHJlbWFpbiBpbiB0aGUgYml0IGJ1ZmZlci4KCSAqLwoJZnVuY3Rpb24gX3RyX2FsaWduKHMpIHsKCSAgc2VuZF9iaXRzKHMsIFNUQVRJQ19UUkVFUyA8PCAxLCAzKTsKCSAgc2VuZF9jb2RlKHMsIEVORF9CTE9DSywgc3RhdGljX2x0cmVlKTsKCSAgYmlfZmx1c2gocyk7Cgl9CgoKCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoJICogRGV0ZXJtaW5lIHRoZSBiZXN0IGVuY29kaW5nIGZvciB0aGUgY3VycmVudCBibG9jazogZHluYW1pYyB0cmVlcywgc3RhdGljCgkgKiB0cmVlcyBvciBzdG9yZSwgYW5kIG91dHB1dCB0aGUgZW5jb2RlZCBibG9jayB0byB0aGUgemlwIGZpbGUuCgkgKi8KCWZ1bmN0aW9uIF90cl9mbHVzaF9ibG9jayhzLCBidWYsIHN0b3JlZF9sZW4sIGxhc3QpCgkvL0RlZmxhdGVTdGF0ZSAqczsKCS8vY2hhcmYgKmJ1ZjsgICAgICAgLyogaW5wdXQgYmxvY2ssIG9yIE5VTEwgaWYgdG9vIG9sZCAqLwoJLy91bGcgc3RvcmVkX2xlbjsgICAvKiBsZW5ndGggb2YgaW5wdXQgYmxvY2sgKi8KCS8vaW50IGxhc3Q7ICAgICAgICAgLyogb25lIGlmIHRoaXMgaXMgdGhlIGxhc3QgYmxvY2sgZm9yIGEgZmlsZSAqLwoJewoJICB2YXIgb3B0X2xlbmIsIHN0YXRpY19sZW5iOyAgLyogb3B0X2xlbiBhbmQgc3RhdGljX2xlbiBpbiBieXRlcyAqLwoJICB2YXIgbWF4X2JsaW5kZXggPSAwOyAgICAgICAgLyogaW5kZXggb2YgbGFzdCBiaXQgbGVuZ3RoIGNvZGUgb2Ygbm9uIHplcm8gZnJlcSAqLwoKCSAgLyogQnVpbGQgdGhlIEh1ZmZtYW4gdHJlZXMgdW5sZXNzIGEgc3RvcmVkIGJsb2NrIGlzIGZvcmNlZCAqLwoJICBpZiAocy5sZXZlbCA+IDApIHsKCgkgICAgLyogQ2hlY2sgaWYgdGhlIGZpbGUgaXMgYmluYXJ5IG9yIHRleHQgKi8KCSAgICBpZiAocy5zdHJtLmRhdGFfdHlwZSA9PT0gWl9VTktOT1dOKSB7CgkgICAgICBzLnN0cm0uZGF0YV90eXBlID0gZGV0ZWN0X2RhdGFfdHlwZShzKTsKCSAgICB9CgoJICAgIC8qIENvbnN0cnVjdCB0aGUgbGl0ZXJhbCBhbmQgZGlzdGFuY2UgdHJlZXMgKi8KCSAgICBidWlsZF90cmVlKHMsIHMubF9kZXNjKTsKCSAgICAvLyBUcmFjZXYoKHN0ZGVyciwgIlxubGl0IGRhdGE6IGR5biAlbGQsIHN0YXQgJWxkIiwgcy0+b3B0X2xlbiwKCSAgICAvLyAgICAgICAgcy0+c3RhdGljX2xlbikpOwoKCSAgICBidWlsZF90cmVlKHMsIHMuZF9kZXNjKTsKCSAgICAvLyBUcmFjZXYoKHN0ZGVyciwgIlxuZGlzdCBkYXRhOiBkeW4gJWxkLCBzdGF0ICVsZCIsIHMtPm9wdF9sZW4sCgkgICAgLy8gICAgICAgIHMtPnN0YXRpY19sZW4pKTsKCSAgICAvKiBBdCB0aGlzIHBvaW50LCBvcHRfbGVuIGFuZCBzdGF0aWNfbGVuIGFyZSB0aGUgdG90YWwgYml0IGxlbmd0aHMgb2YKCSAgICAgKiB0aGUgY29tcHJlc3NlZCBibG9jayBkYXRhLCBleGNsdWRpbmcgdGhlIHRyZWUgcmVwcmVzZW50YXRpb25zLgoJICAgICAqLwoKCSAgICAvKiBCdWlsZCB0aGUgYml0IGxlbmd0aCB0cmVlIGZvciB0aGUgYWJvdmUgdHdvIHRyZWVzLCBhbmQgZ2V0IHRoZSBpbmRleAoJICAgICAqIGluIGJsX29yZGVyIG9mIHRoZSBsYXN0IGJpdCBsZW5ndGggY29kZSB0byBzZW5kLgoJICAgICAqLwoJICAgIG1heF9ibGluZGV4ID0gYnVpbGRfYmxfdHJlZShzKTsKCgkgICAgLyogRGV0ZXJtaW5lIHRoZSBiZXN0IGVuY29kaW5nLiBDb21wdXRlIHRoZSBibG9jayBsZW5ndGhzIGluIGJ5dGVzLiAqLwoJICAgIG9wdF9sZW5iID0gKHMub3B0X2xlbiArIDMgKyA3KSA+Pj4gMzsKCSAgICBzdGF0aWNfbGVuYiA9IChzLnN0YXRpY19sZW4gKyAzICsgNykgPj4+IDM7CgoJICAgIC8vIFRyYWNldigoc3RkZXJyLCAiXG5vcHQgJWx1KCVsdSkgc3RhdCAlbHUoJWx1KSBzdG9yZWQgJWx1IGxpdCAldSAiLAoJICAgIC8vICAgICAgICBvcHRfbGVuYiwgcy0+b3B0X2xlbiwgc3RhdGljX2xlbmIsIHMtPnN0YXRpY19sZW4sIHN0b3JlZF9sZW4sCgkgICAgLy8gICAgICAgIHMtPmxhc3RfbGl0KSk7CgoJICAgIGlmIChzdGF0aWNfbGVuYiA8PSBvcHRfbGVuYikgeyBvcHRfbGVuYiA9IHN0YXRpY19sZW5iOyB9CgoJICB9IGVsc2UgewoJICAgIC8vIEFzc2VydChidWYgIT0gKGNoYXIqKTAsICJsb3N0IGJ1ZiIpOwoJICAgIG9wdF9sZW5iID0gc3RhdGljX2xlbmIgPSBzdG9yZWRfbGVuICsgNTsgLyogZm9yY2UgYSBzdG9yZWQgYmxvY2sgKi8KCSAgfQoKCSAgaWYgKChzdG9yZWRfbGVuICsgNCA8PSBvcHRfbGVuYikgJiYgKGJ1ZiAhPT0gLTEpKSB7CgkgICAgLyogNDogdHdvIHdvcmRzIGZvciB0aGUgbGVuZ3RocyAqLwoKCSAgICAvKiBUaGUgdGVzdCBidWYgIT0gTlVMTCBpcyBvbmx5IG5lY2Vzc2FyeSBpZiBMSVRfQlVGU0laRSA+IFdTSVpFLgoJICAgICAqIE90aGVyd2lzZSB3ZSBjYW4ndCBoYXZlIHByb2Nlc3NlZCBtb3JlIHRoYW4gV1NJWkUgaW5wdXQgYnl0ZXMgc2luY2UKCSAgICAgKiB0aGUgbGFzdCBibG9jayBmbHVzaCwgYmVjYXVzZSBjb21wcmVzc2lvbiB3b3VsZCBoYXZlIGJlZW4KCSAgICAgKiBzdWNjZXNzZnVsLiBJZiBMSVRfQlVGU0laRSA8PSBXU0laRSwgaXQgaXMgbmV2ZXIgdG9vIGxhdGUgdG8KCSAgICAgKiB0cmFuc2Zvcm0gYSBibG9jayBpbnRvIGEgc3RvcmVkIGJsb2NrLgoJICAgICAqLwoJICAgIF90cl9zdG9yZWRfYmxvY2socywgYnVmLCBzdG9yZWRfbGVuLCBsYXN0KTsKCgkgIH0gZWxzZSBpZiAocy5zdHJhdGVneSA9PT0gWl9GSVhFRCB8fCBzdGF0aWNfbGVuYiA9PT0gb3B0X2xlbmIpIHsKCgkgICAgc2VuZF9iaXRzKHMsIChTVEFUSUNfVFJFRVMgPDwgMSkgKyAobGFzdCA/IDEgOiAwKSwgMyk7CgkgICAgY29tcHJlc3NfYmxvY2socywgc3RhdGljX2x0cmVlLCBzdGF0aWNfZHRyZWUpOwoKCSAgfSBlbHNlIHsKCSAgICBzZW5kX2JpdHMocywgKERZTl9UUkVFUyA8PCAxKSArIChsYXN0ID8gMSA6IDApLCAzKTsKCSAgICBzZW5kX2FsbF90cmVlcyhzLCBzLmxfZGVzYy5tYXhfY29kZSArIDEsIHMuZF9kZXNjLm1heF9jb2RlICsgMSwgbWF4X2JsaW5kZXggKyAxKTsKCSAgICBjb21wcmVzc19ibG9jayhzLCBzLmR5bl9sdHJlZSwgcy5keW5fZHRyZWUpOwoJICB9CgkgIC8vIEFzc2VydCAocy0+Y29tcHJlc3NlZF9sZW4gPT0gcy0+Yml0c19zZW50LCAiYmFkIGNvbXByZXNzZWQgc2l6ZSIpOwoJICAvKiBUaGUgYWJvdmUgY2hlY2sgaXMgbWFkZSBtb2QgMl4zMiwgZm9yIGZpbGVzIGxhcmdlciB0aGFuIDUxMiBNQgoJICAgKiBhbmQgdUxvbmcgaW1wbGVtZW50ZWQgb24gMzIgYml0cy4KCSAgICovCgkgIGluaXRfYmxvY2socyk7CgoJICBpZiAobGFzdCkgewoJICAgIGJpX3dpbmR1cChzKTsKCSAgfQoJICAvLyBUcmFjZXYoKHN0ZGVyciwiXG5jb21wcmxlbiAlbHUoJWx1KSAiLCBzLT5jb21wcmVzc2VkX2xlbj4+MywKCSAgLy8gICAgICAgcy0+Y29tcHJlc3NlZF9sZW4tNypsYXN0KSk7Cgl9CgoJLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgkgKiBTYXZlIHRoZSBtYXRjaCBpbmZvIGFuZCB0YWxseSB0aGUgZnJlcXVlbmN5IGNvdW50cy4gUmV0dXJuIHRydWUgaWYKCSAqIHRoZSBjdXJyZW50IGJsb2NrIG11c3QgYmUgZmx1c2hlZC4KCSAqLwoJZnVuY3Rpb24gX3RyX3RhbGx5KHMsIGRpc3QsIGxjKQoJLy8gICAgZGVmbGF0ZV9zdGF0ZSAqczsKCS8vICAgIHVuc2lnbmVkIGRpc3Q7ICAvKiBkaXN0YW5jZSBvZiBtYXRjaGVkIHN0cmluZyAqLwoJLy8gICAgdW5zaWduZWQgbGM7ICAgIC8qIG1hdGNoIGxlbmd0aC1NSU5fTUFUQ0ggb3IgdW5tYXRjaGVkIGNoYXIgKGlmIGRpc3Q9PTApICovCgl7CgkgIC8vdmFyIG91dF9sZW5ndGgsIGluX2xlbmd0aCwgZGNvZGU7CgoJICBzLnBlbmRpbmdfYnVmW3MuZF9idWYgKyBzLmxhc3RfbGl0ICogMl0gICAgID0gKGRpc3QgPj4+IDgpICYgMHhmZjsKCSAgcy5wZW5kaW5nX2J1ZltzLmRfYnVmICsgcy5sYXN0X2xpdCAqIDIgKyAxXSA9IGRpc3QgJiAweGZmOwoKCSAgcy5wZW5kaW5nX2J1ZltzLmxfYnVmICsgcy5sYXN0X2xpdF0gPSBsYyAmIDB4ZmY7CgkgIHMubGFzdF9saXQrKzsKCgkgIGlmIChkaXN0ID09PSAwKSB7CgkgICAgLyogbGMgaXMgdGhlIHVubWF0Y2hlZCBjaGFyICovCgkgICAgcy5keW5fbHRyZWVbbGMgKiAyXS8qLkZyZXEqLysrOwoJICB9IGVsc2UgewoJICAgIHMubWF0Y2hlcysrOwoJICAgIC8qIEhlcmUsIGxjIGlzIHRoZSBtYXRjaCBsZW5ndGggLSBNSU5fTUFUQ0ggKi8KCSAgICBkaXN0LS07ICAgICAgICAgICAgIC8qIGRpc3QgPSBtYXRjaCBkaXN0YW5jZSAtIDEgKi8KCSAgICAvL0Fzc2VydCgodXNoKWRpc3QgPCAodXNoKU1BWF9ESVNUKHMpICYmCgkgICAgLy8gICAgICAgKHVzaClsYyA8PSAodXNoKShNQVhfTUFUQ0gtTUlOX01BVENIKSAmJgoJICAgIC8vICAgICAgICh1c2gpZF9jb2RlKGRpc3QpIDwgKHVzaClEX0NPREVTLCAgIl90cl90YWxseTogYmFkIG1hdGNoIik7CgoJICAgIHMuZHluX2x0cmVlWyhfbGVuZ3RoX2NvZGVbbGNdICsgTElURVJBTFMgKyAxKSAqIDJdLyouRnJlcSovKys7CgkgICAgcy5keW5fZHRyZWVbZF9jb2RlKGRpc3QpICogMl0vKi5GcmVxKi8rKzsKCSAgfQoKCS8vICghKSBUaGlzIGJsb2NrIGlzIGRpc2FibGVkIGluIHpsaWIgZGVmYWlsdHMsCgkvLyBkb24ndCBlbmFibGUgaXQgZm9yIGJpbmFyeSBjb21wYXRpYmlsaXR5CgoJLy8jaWZkZWYgVFJVTkNBVEVfQkxPQ0sKCS8vICAvKiBUcnkgdG8gZ3Vlc3MgaWYgaXQgaXMgcHJvZml0YWJsZSB0byBzdG9wIHRoZSBjdXJyZW50IGJsb2NrIGhlcmUgKi8KCS8vICBpZiAoKHMubGFzdF9saXQgJiAweDFmZmYpID09PSAwICYmIHMubGV2ZWwgPiAyKSB7CgkvLyAgICAvKiBDb21wdXRlIGFuIHVwcGVyIGJvdW5kIGZvciB0aGUgY29tcHJlc3NlZCBsZW5ndGggKi8KCS8vICAgIG91dF9sZW5ndGggPSBzLmxhc3RfbGl0Kjg7CgkvLyAgICBpbl9sZW5ndGggPSBzLnN0cnN0YXJ0IC0gcy5ibG9ja19zdGFydDsKCS8vCgkvLyAgICBmb3IgKGRjb2RlID0gMDsgZGNvZGUgPCBEX0NPREVTOyBkY29kZSsrKSB7CgkvLyAgICAgIG91dF9sZW5ndGggKz0gcy5keW5fZHRyZWVbZGNvZGUqMl0vKi5GcmVxKi8gKiAoNSArIGV4dHJhX2RiaXRzW2Rjb2RlXSk7CgkvLyAgICB9CgkvLyAgICBvdXRfbGVuZ3RoID4+Pj0gMzsKCS8vICAgIC8vVHJhY2V2KChzdGRlcnIsIlxubGFzdF9saXQgJXUsIGluICVsZCwgb3V0IH4lbGQoJWxkJSUpICIsCgkvLyAgICAvLyAgICAgICBzLT5sYXN0X2xpdCwgaW5fbGVuZ3RoLCBvdXRfbGVuZ3RoLAoJLy8gICAgLy8gICAgICAgMTAwTCAtIG91dF9sZW5ndGgqMTAwTC9pbl9sZW5ndGgpKTsKCS8vICAgIGlmIChzLm1hdGNoZXMgPCAocy5sYXN0X2xpdD4+MSkvKmludCAvMiovICYmIG91dF9sZW5ndGggPCAoaW5fbGVuZ3RoPj4xKS8qaW50IC8yKi8pIHsKCS8vICAgICAgcmV0dXJuIHRydWU7CgkvLyAgICB9CgkvLyAgfQoJLy8jZW5kaWYKCgkgIHJldHVybiAocy5sYXN0X2xpdCA9PT0gcy5saXRfYnVmc2l6ZSAtIDEpOwoJICAvKiBXZSBhdm9pZCBlcXVhbGl0eSB3aXRoIGxpdF9idWZzaXplIGJlY2F1c2Ugb2Ygd3JhcGFyb3VuZCBhdCA2NEsKCSAgICogb24gMTYgYml0IG1hY2hpbmVzIGFuZCBiZWNhdXNlIHN0b3JlZCBibG9ja3MgYXJlIHJlc3RyaWN0ZWQgdG8KCSAgICogNjRLLTEgYnl0ZXMuCgkgICAqLwoJfQoKCWV4cG9ydHMuX3RyX2luaXQgID0gX3RyX2luaXQ7CglleHBvcnRzLl90cl9zdG9yZWRfYmxvY2sgPSBfdHJfc3RvcmVkX2Jsb2NrOwoJZXhwb3J0cy5fdHJfZmx1c2hfYmxvY2sgID0gX3RyX2ZsdXNoX2Jsb2NrOwoJZXhwb3J0cy5fdHJfdGFsbHkgPSBfdHJfdGFsbHk7CglleHBvcnRzLl90cl9hbGlnbiA9IF90cl9hbGlnbjsKCgovKioqLyB9LAovKiA4NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkndXNlIHN0cmljdCc7CgoJLy8gTm90ZTogYWRsZXIzMiB0YWtlcyAxMiUgZm9yIGxldmVsIDAgYW5kIDIlIGZvciBsZXZlbCA2LgoJLy8gSXQgZG9lc24ndCB3b3J0aCB0byBtYWtlIGFkZGl0aW9uYWwgb3B0aW1pemF0aW9uYSBhcyBpbiBvcmlnaW5hbC4KCS8vIFNtYWxsIHNpemUgaXMgcHJlZmVyYWJsZS4KCglmdW5jdGlvbiBhZGxlcjMyKGFkbGVyLCBidWYsIGxlbiwgcG9zKSB7CgkgIHZhciBzMSA9IChhZGxlciAmIDB4ZmZmZikgfDAsCgkgICAgICBzMiA9ICgoYWRsZXIgPj4+IDE2KSAmIDB4ZmZmZikgfDAsCgkgICAgICBuID0gMDsKCgkgIHdoaWxlIChsZW4gIT09IDApIHsKCSAgICAvLyBTZXQgbGltaXQgfiB0d2ljZSBsZXNzIHRoYW4gNTU1MiwgdG8ga2VlcAoJICAgIC8vIHMyIGluIDMxLWJpdHMsIGJlY2F1c2Ugd2UgZm9yY2Ugc2lnbmVkIGludHMuCgkgICAgLy8gaW4gb3RoZXIgY2FzZSAlPSB3aWxsIGZhaWwuCgkgICAgbiA9IGxlbiA+IDIwMDAgPyAyMDAwIDogbGVuOwoJICAgIGxlbiAtPSBuOwoKCSAgICBkbyB7CgkgICAgICBzMSA9IChzMSArIGJ1Zltwb3MrK10pIHwwOwoJICAgICAgczIgPSAoczIgKyBzMSkgfDA7CgkgICAgfSB3aGlsZSAoLS1uKTsKCgkgICAgczEgJT0gNjU1MjE7CgkgICAgczIgJT0gNjU1MjE7CgkgIH0KCgkgIHJldHVybiAoczEgfCAoczIgPDwgMTYpKSB8MDsKCX0KCgoJbW9kdWxlLmV4cG9ydHMgPSBhZGxlcjMyOwoKCi8qKiovIH0sCi8qIDg3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JzsKCgkvLyBOb3RlOiB3ZSBjYW4ndCBnZXQgc2lnbmlmaWNhbnQgc3BlZWQgYm9vc3QgaGVyZS4KCS8vIFNvIHdyaXRlIGNvZGUgdG8gbWluaW1pemUgc2l6ZSAtIG5vIHByZWdlbmVyYXRlZCB0YWJsZXMKCS8vIGFuZCBhcnJheSB0b29scyBkZXBlbmRlbmNpZXMuCgoKCS8vIFVzZSBvcmRpbmFyeSBhcnJheSwgc2luY2UgdW50eXBlZCBtYWtlcyBubyBib29zdCBoZXJlCglmdW5jdGlvbiBtYWtlVGFibGUoKSB7CgkgIHZhciBjLCB0YWJsZSA9IFtdOwoKCSAgZm9yICh2YXIgbiA9IDA7IG4gPCAyNTY7IG4rKykgewoJICAgIGMgPSBuOwoJICAgIGZvciAodmFyIGsgPSAwOyBrIDwgODsgaysrKSB7CgkgICAgICBjID0gKChjICYgMSkgPyAoMHhFREI4ODMyMCBeIChjID4+PiAxKSkgOiAoYyA+Pj4gMSkpOwoJICAgIH0KCSAgICB0YWJsZVtuXSA9IGM7CgkgIH0KCgkgIHJldHVybiB0YWJsZTsKCX0KCgkvLyBDcmVhdGUgdGFibGUgb24gbG9hZC4gSnVzdCAyNTUgc2lnbmVkIGxvbmdzLiBOb3QgYSBwcm9ibGVtLgoJdmFyIGNyY1RhYmxlID0gbWFrZVRhYmxlKCk7CgoKCWZ1bmN0aW9uIGNyYzMyKGNyYywgYnVmLCBsZW4sIHBvcykgewoJICB2YXIgdCA9IGNyY1RhYmxlLAoJICAgICAgZW5kID0gcG9zICsgbGVuOwoKCSAgY3JjIF49IC0xOwoKCSAgZm9yICh2YXIgaSA9IHBvczsgaSA8IGVuZDsgaSsrKSB7CgkgICAgY3JjID0gKGNyYyA+Pj4gOCkgXiB0WyhjcmMgXiBidWZbaV0pICYgMHhGRl07CgkgIH0KCgkgIHJldHVybiAoY3JjIF4gKC0xKSk7IC8vID4+PiAwOwoJfQoKCgltb2R1bGUuZXhwb3J0cyA9IGNyYzMyOwoKCi8qKiovIH0sCi8qIDg4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCgoJdmFyIHV0aWxzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg0KTsKCXZhciBhZGxlcjMyICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4Nik7Cgl2YXIgY3JjMzIgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODcpOwoJdmFyIGluZmxhdGVfZmFzdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg5KTsKCXZhciBpbmZsYXRlX3RhYmxlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MCk7CgoJdmFyIENPREVTID0gMDsKCXZhciBMRU5TID0gMTsKCXZhciBESVNUUyA9IDI7CgoJLyogUHVibGljIGNvbnN0YW50cyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KCS8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgoKCS8qIEFsbG93ZWQgZmx1c2ggdmFsdWVzOyBzZWUgZGVmbGF0ZSgpIGFuZCBpbmZsYXRlKCkgYmVsb3cgZm9yIGRldGFpbHMgKi8KCS8vdmFyIFpfTk9fRkxVU0ggICAgICA9IDA7CgkvL3ZhciBaX1BBUlRJQUxfRkxVU0ggPSAxOwoJLy92YXIgWl9TWU5DX0ZMVVNIICAgID0gMjsKCS8vdmFyIFpfRlVMTF9GTFVTSCAgICA9IDM7Cgl2YXIgWl9GSU5JU0ggICAgICAgID0gNDsKCXZhciBaX0JMT0NLICAgICAgICAgPSA1OwoJdmFyIFpfVFJFRVMgICAgICAgICA9IDY7CgoKCS8qIFJldHVybiBjb2RlcyBmb3IgdGhlIGNvbXByZXNzaW9uL2RlY29tcHJlc3Npb24gZnVuY3Rpb25zLiBOZWdhdGl2ZSB2YWx1ZXMKCSAqIGFyZSBlcnJvcnMsIHBvc2l0aXZlIHZhbHVlcyBhcmUgdXNlZCBmb3Igc3BlY2lhbCBidXQgbm9ybWFsIGV2ZW50cy4KCSAqLwoJdmFyIFpfT0sgICAgICAgICAgICA9IDA7Cgl2YXIgWl9TVFJFQU1fRU5EICAgID0gMTsKCXZhciBaX05FRURfRElDVCAgICAgPSAyOwoJLy92YXIgWl9FUlJOTyAgICAgICAgID0gLTE7Cgl2YXIgWl9TVFJFQU1fRVJST1IgID0gLTI7Cgl2YXIgWl9EQVRBX0VSUk9SICAgID0gLTM7Cgl2YXIgWl9NRU1fRVJST1IgICAgID0gLTQ7Cgl2YXIgWl9CVUZfRVJST1IgICAgID0gLTU7CgkvL3ZhciBaX1ZFUlNJT05fRVJST1IgPSAtNjsKCgkvKiBUaGUgZGVmbGF0ZSBjb21wcmVzc2lvbiBtZXRob2QgKi8KCXZhciBaX0RFRkxBVEVEICA9IDg7CgoKCS8qIFNUQVRFUyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwoKCgl2YXIgICAgSEVBRCA9IDE7ICAgICAgIC8qIGk6IHdhaXRpbmcgZm9yIG1hZ2ljIGhlYWRlciAqLwoJdmFyICAgIEZMQUdTID0gMjsgICAgICAvKiBpOiB3YWl0aW5nIGZvciBtZXRob2QgYW5kIGZsYWdzIChnemlwKSAqLwoJdmFyICAgIFRJTUUgPSAzOyAgICAgICAvKiBpOiB3YWl0aW5nIGZvciBtb2RpZmljYXRpb24gdGltZSAoZ3ppcCkgKi8KCXZhciAgICBPUyA9IDQ7ICAgICAgICAgLyogaTogd2FpdGluZyBmb3IgZXh0cmEgZmxhZ3MgYW5kIG9wZXJhdGluZyBzeXN0ZW0gKGd6aXApICovCgl2YXIgICAgRVhMRU4gPSA1OyAgICAgIC8qIGk6IHdhaXRpbmcgZm9yIGV4dHJhIGxlbmd0aCAoZ3ppcCkgKi8KCXZhciAgICBFWFRSQSA9IDY7ICAgICAgLyogaTogd2FpdGluZyBmb3IgZXh0cmEgYnl0ZXMgKGd6aXApICovCgl2YXIgICAgTkFNRSA9IDc7ICAgICAgIC8qIGk6IHdhaXRpbmcgZm9yIGVuZCBvZiBmaWxlIG5hbWUgKGd6aXApICovCgl2YXIgICAgQ09NTUVOVCA9IDg7ICAgIC8qIGk6IHdhaXRpbmcgZm9yIGVuZCBvZiBjb21tZW50IChnemlwKSAqLwoJdmFyICAgIEhDUkMgPSA5OyAgICAgICAvKiBpOiB3YWl0aW5nIGZvciBoZWFkZXIgY3JjIChnemlwKSAqLwoJdmFyICAgIERJQ1RJRCA9IDEwOyAgICAvKiBpOiB3YWl0aW5nIGZvciBkaWN0aW9uYXJ5IGNoZWNrIHZhbHVlICovCgl2YXIgICAgRElDVCA9IDExOyAgICAgIC8qIHdhaXRpbmcgZm9yIGluZmxhdGVTZXREaWN0aW9uYXJ5KCkgY2FsbCAqLwoJdmFyICAgICAgICBUWVBFID0gMTI7ICAgICAgLyogaTogd2FpdGluZyBmb3IgdHlwZSBiaXRzLCBpbmNsdWRpbmcgbGFzdC1mbGFnIGJpdCAqLwoJdmFyICAgICAgICBUWVBFRE8gPSAxMzsgICAgLyogaTogc2FtZSwgYnV0IHNraXAgY2hlY2sgdG8gZXhpdCBpbmZsYXRlIG9uIG5ldyBibG9jayAqLwoJdmFyICAgICAgICBTVE9SRUQgPSAxNDsgICAgLyogaTogd2FpdGluZyBmb3Igc3RvcmVkIHNpemUgKGxlbmd0aCBhbmQgY29tcGxlbWVudCkgKi8KCXZhciAgICAgICAgQ09QWV8gPSAxNTsgICAgIC8qIGkvbzogc2FtZSBhcyBDT1BZIGJlbG93LCBidXQgb25seSBmaXJzdCB0aW1lIGluICovCgl2YXIgICAgICAgIENPUFkgPSAxNjsgICAgICAvKiBpL286IHdhaXRpbmcgZm9yIGlucHV0IG9yIG91dHB1dCB0byBjb3B5IHN0b3JlZCBibG9jayAqLwoJdmFyICAgICAgICBUQUJMRSA9IDE3OyAgICAgLyogaTogd2FpdGluZyBmb3IgZHluYW1pYyBibG9jayB0YWJsZSBsZW5ndGhzICovCgl2YXIgICAgICAgIExFTkxFTlMgPSAxODsgICAvKiBpOiB3YWl0aW5nIGZvciBjb2RlIGxlbmd0aCBjb2RlIGxlbmd0aHMgKi8KCXZhciAgICAgICAgQ09ERUxFTlMgPSAxOTsgIC8qIGk6IHdhaXRpbmcgZm9yIGxlbmd0aC9saXQgYW5kIGRpc3RhbmNlIGNvZGUgbGVuZ3RocyAqLwoJdmFyICAgICAgICAgICAgTEVOXyA9IDIwOyAgICAgIC8qIGk6IHNhbWUgYXMgTEVOIGJlbG93LCBidXQgb25seSBmaXJzdCB0aW1lIGluICovCgl2YXIgICAgICAgICAgICBMRU4gPSAyMTsgICAgICAgLyogaTogd2FpdGluZyBmb3IgbGVuZ3RoL2xpdC9lb2IgY29kZSAqLwoJdmFyICAgICAgICAgICAgTEVORVhUID0gMjI7ICAgIC8qIGk6IHdhaXRpbmcgZm9yIGxlbmd0aCBleHRyYSBiaXRzICovCgl2YXIgICAgICAgICAgICBESVNUID0gMjM7ICAgICAgLyogaTogd2FpdGluZyBmb3IgZGlzdGFuY2UgY29kZSAqLwoJdmFyICAgICAgICAgICAgRElTVEVYVCA9IDI0OyAgIC8qIGk6IHdhaXRpbmcgZm9yIGRpc3RhbmNlIGV4dHJhIGJpdHMgKi8KCXZhciAgICAgICAgICAgIE1BVENIID0gMjU7ICAgICAvKiBvOiB3YWl0aW5nIGZvciBvdXRwdXQgc3BhY2UgdG8gY29weSBzdHJpbmcgKi8KCXZhciAgICAgICAgICAgIExJVCA9IDI2OyAgICAgICAvKiBvOiB3YWl0aW5nIGZvciBvdXRwdXQgc3BhY2UgdG8gd3JpdGUgbGl0ZXJhbCAqLwoJdmFyICAgIENIRUNLID0gMjc7ICAgICAvKiBpOiB3YWl0aW5nIGZvciAzMi1iaXQgY2hlY2sgdmFsdWUgKi8KCXZhciAgICBMRU5HVEggPSAyODsgICAgLyogaTogd2FpdGluZyBmb3IgMzItYml0IGxlbmd0aCAoZ3ppcCkgKi8KCXZhciAgICBET05FID0gMjk7ICAgICAgLyogZmluaXNoZWQgY2hlY2ssIGRvbmUgLS0gcmVtYWluIGhlcmUgdW50aWwgcmVzZXQgKi8KCXZhciAgICBCQUQgPSAzMDsgICAgICAgLyogZ290IGEgZGF0YSBlcnJvciAtLSByZW1haW4gaGVyZSB1bnRpbCByZXNldCAqLwoJdmFyICAgIE1FTSA9IDMxOyAgICAgICAvKiBnb3QgYW4gaW5mbGF0ZSgpIG1lbW9yeSBlcnJvciAtLSByZW1haW4gaGVyZSB1bnRpbCByZXNldCAqLwoJdmFyICAgIFNZTkMgPSAzMjsgICAgICAvKiBsb29raW5nIGZvciBzeW5jaHJvbml6YXRpb24gYnl0ZXMgdG8gcmVzdGFydCBpbmZsYXRlKCkgKi8KCgkvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLwoKCgoJdmFyIEVOT1VHSF9MRU5TID0gODUyOwoJdmFyIEVOT1VHSF9ESVNUUyA9IDU5MjsKCS8vdmFyIEVOT1VHSCA9ICAoRU5PVUdIX0xFTlMrRU5PVUdIX0RJU1RTKTsKCgl2YXIgTUFYX1dCSVRTID0gMTU7CgkvKiAzMksgTFo3NyB3aW5kb3cgKi8KCXZhciBERUZfV0JJVFMgPSBNQVhfV0JJVFM7CgoKCWZ1bmN0aW9uIHpzd2FwMzIocSkgewoJICByZXR1cm4gICgoKHEgPj4+IDI0KSAmIDB4ZmYpICsKCSAgICAgICAgICAoKHEgPj4+IDgpICYgMHhmZjAwKSArCgkgICAgICAgICAgKChxICYgMHhmZjAwKSA8PCA4KSArCgkgICAgICAgICAgKChxICYgMHhmZikgPDwgMjQpKTsKCX0KCgoJZnVuY3Rpb24gSW5mbGF0ZVN0YXRlKCkgewoJICB0aGlzLm1vZGUgPSAwOyAgICAgICAgICAgICAvKiBjdXJyZW50IGluZmxhdGUgbW9kZSAqLwoJICB0aGlzLmxhc3QgPSBmYWxzZTsgICAgICAgICAgLyogdHJ1ZSBpZiBwcm9jZXNzaW5nIGxhc3QgYmxvY2sgKi8KCSAgdGhpcy53cmFwID0gMDsgICAgICAgICAgICAgIC8qIGJpdCAwIHRydWUgZm9yIHpsaWIsIGJpdCAxIHRydWUgZm9yIGd6aXAgKi8KCSAgdGhpcy5oYXZlZGljdCA9IGZhbHNlOyAgICAgIC8qIHRydWUgaWYgZGljdGlvbmFyeSBwcm92aWRlZCAqLwoJICB0aGlzLmZsYWdzID0gMDsgICAgICAgICAgICAgLyogZ3ppcCBoZWFkZXIgbWV0aG9kIGFuZCBmbGFncyAoMCBpZiB6bGliKSAqLwoJICB0aGlzLmRtYXggPSAwOyAgICAgICAgICAgICAgLyogemxpYiBoZWFkZXIgbWF4IGRpc3RhbmNlIChJTkZMQVRFX1NUUklDVCkgKi8KCSAgdGhpcy5jaGVjayA9IDA7ICAgICAgICAgICAgIC8qIHByb3RlY3RlZCBjb3B5IG9mIGNoZWNrIHZhbHVlICovCgkgIHRoaXMudG90YWwgPSAwOyAgICAgICAgICAgICAvKiBwcm90ZWN0ZWQgY29weSBvZiBvdXRwdXQgY291bnQgKi8KCSAgLy8gVE9ETzogbWF5IGJlIHt9CgkgIHRoaXMuaGVhZCA9IG51bGw7ICAgICAgICAgICAvKiB3aGVyZSB0byBzYXZlIGd6aXAgaGVhZGVyIGluZm9ybWF0aW9uICovCgoJICAvKiBzbGlkaW5nIHdpbmRvdyAqLwoJICB0aGlzLndiaXRzID0gMDsgICAgICAgICAgICAgLyogbG9nIGJhc2UgMiBvZiByZXF1ZXN0ZWQgd2luZG93IHNpemUgKi8KCSAgdGhpcy53c2l6ZSA9IDA7ICAgICAgICAgICAgIC8qIHdpbmRvdyBzaXplIG9yIHplcm8gaWYgbm90IHVzaW5nIHdpbmRvdyAqLwoJICB0aGlzLndoYXZlID0gMDsgICAgICAgICAgICAgLyogdmFsaWQgYnl0ZXMgaW4gdGhlIHdpbmRvdyAqLwoJICB0aGlzLnduZXh0ID0gMDsgICAgICAgICAgICAgLyogd2luZG93IHdyaXRlIGluZGV4ICovCgkgIHRoaXMud2luZG93ID0gbnVsbDsgICAgICAgICAvKiBhbGxvY2F0ZWQgc2xpZGluZyB3aW5kb3csIGlmIG5lZWRlZCAqLwoKCSAgLyogYml0IGFjY3VtdWxhdG9yICovCgkgIHRoaXMuaG9sZCA9IDA7ICAgICAgICAgICAgICAvKiBpbnB1dCBiaXQgYWNjdW11bGF0b3IgKi8KCSAgdGhpcy5iaXRzID0gMDsgICAgICAgICAgICAgIC8qIG51bWJlciBvZiBiaXRzIGluICJpbiIgKi8KCgkgIC8qIGZvciBzdHJpbmcgYW5kIHN0b3JlZCBibG9jayBjb3B5aW5nICovCgkgIHRoaXMubGVuZ3RoID0gMDsgICAgICAgICAgICAvKiBsaXRlcmFsIG9yIGxlbmd0aCBvZiBkYXRhIHRvIGNvcHkgKi8KCSAgdGhpcy5vZmZzZXQgPSAwOyAgICAgICAgICAgIC8qIGRpc3RhbmNlIGJhY2sgdG8gY29weSBzdHJpbmcgZnJvbSAqLwoKCSAgLyogZm9yIHRhYmxlIGFuZCBjb2RlIGRlY29kaW5nICovCgkgIHRoaXMuZXh0cmEgPSAwOyAgICAgICAgICAgICAvKiBleHRyYSBiaXRzIG5lZWRlZCAqLwoKCSAgLyogZml4ZWQgYW5kIGR5bmFtaWMgY29kZSB0YWJsZXMgKi8KCSAgdGhpcy5sZW5jb2RlID0gbnVsbDsgICAgICAgICAgLyogc3RhcnRpbmcgdGFibGUgZm9yIGxlbmd0aC9saXRlcmFsIGNvZGVzICovCgkgIHRoaXMuZGlzdGNvZGUgPSBudWxsOyAgICAgICAgIC8qIHN0YXJ0aW5nIHRhYmxlIGZvciBkaXN0YW5jZSBjb2RlcyAqLwoJICB0aGlzLmxlbmJpdHMgPSAwOyAgICAgICAgICAgLyogaW5kZXggYml0cyBmb3IgbGVuY29kZSAqLwoJICB0aGlzLmRpc3RiaXRzID0gMDsgICAgICAgICAgLyogaW5kZXggYml0cyBmb3IgZGlzdGNvZGUgKi8KCgkgIC8qIGR5bmFtaWMgdGFibGUgYnVpbGRpbmcgKi8KCSAgdGhpcy5uY29kZSA9IDA7ICAgICAgICAgICAgIC8qIG51bWJlciBvZiBjb2RlIGxlbmd0aCBjb2RlIGxlbmd0aHMgKi8KCSAgdGhpcy5ubGVuID0gMDsgICAgICAgICAgICAgIC8qIG51bWJlciBvZiBsZW5ndGggY29kZSBsZW5ndGhzICovCgkgIHRoaXMubmRpc3QgPSAwOyAgICAgICAgICAgICAvKiBudW1iZXIgb2YgZGlzdGFuY2UgY29kZSBsZW5ndGhzICovCgkgIHRoaXMuaGF2ZSA9IDA7ICAgICAgICAgICAgICAvKiBudW1iZXIgb2YgY29kZSBsZW5ndGhzIGluIGxlbnNbXSAqLwoJICB0aGlzLm5leHQgPSBudWxsOyAgICAgICAgICAgICAgLyogbmV4dCBhdmFpbGFibGUgc3BhY2UgaW4gY29kZXNbXSAqLwoKCSAgdGhpcy5sZW5zID0gbmV3IHV0aWxzLkJ1ZjE2KDMyMCk7IC8qIHRlbXBvcmFyeSBzdG9yYWdlIGZvciBjb2RlIGxlbmd0aHMgKi8KCSAgdGhpcy53b3JrID0gbmV3IHV0aWxzLkJ1ZjE2KDI4OCk7IC8qIHdvcmsgYXJlYSBmb3IgY29kZSB0YWJsZSBidWlsZGluZyAqLwoKCSAgLyoKCSAgIGJlY2F1c2Ugd2UgZG9uJ3QgaGF2ZSBwb2ludGVycyBpbiBqcywgd2UgdXNlIGxlbmNvZGUgYW5kIGRpc3Rjb2RlIGRpcmVjdGx5CgkgICBhcyBidWZmZXJzIHNvIHdlIGRvbid0IG5lZWQgY29kZXMKCSAgKi8KCSAgLy90aGlzLmNvZGVzID0gbmV3IHV0aWxzLkJ1ZjMyKEVOT1VHSCk7ICAgICAgIC8qIHNwYWNlIGZvciBjb2RlIHRhYmxlcyAqLwoJICB0aGlzLmxlbmR5biA9IG51bGw7ICAgICAgICAgICAgICAvKiBkeW5hbWljIHRhYmxlIGZvciBsZW5ndGgvbGl0ZXJhbCBjb2RlcyAoSlMgc3BlY2lmaWMpICovCgkgIHRoaXMuZGlzdGR5biA9IG51bGw7ICAgICAgICAgICAgIC8qIGR5bmFtaWMgdGFibGUgZm9yIGRpc3RhbmNlIGNvZGVzIChKUyBzcGVjaWZpYykgKi8KCSAgdGhpcy5zYW5lID0gMDsgICAgICAgICAgICAgICAgICAgLyogaWYgZmFsc2UsIGFsbG93IGludmFsaWQgZGlzdGFuY2UgdG9vIGZhciAqLwoJICB0aGlzLmJhY2sgPSAwOyAgICAgICAgICAgICAgICAgICAvKiBiaXRzIGJhY2sgb2YgbGFzdCB1bnByb2Nlc3NlZCBsZW5ndGgvbGl0ICovCgkgIHRoaXMud2FzID0gMDsgICAgICAgICAgICAgICAgICAgIC8qIGluaXRpYWwgbGVuZ3RoIG9mIG1hdGNoICovCgl9CgoJZnVuY3Rpb24gaW5mbGF0ZVJlc2V0S2VlcChzdHJtKSB7CgkgIHZhciBzdGF0ZTsKCgkgIGlmICghc3RybSB8fCAhc3RybS5zdGF0ZSkgeyByZXR1cm4gWl9TVFJFQU1fRVJST1I7IH0KCSAgc3RhdGUgPSBzdHJtLnN0YXRlOwoJICBzdHJtLnRvdGFsX2luID0gc3RybS50b3RhbF9vdXQgPSBzdGF0ZS50b3RhbCA9IDA7CgkgIHN0cm0ubXNnID0gJyc7IC8qWl9OVUxMKi8KCSAgaWYgKHN0YXRlLndyYXApIHsgICAgICAgLyogdG8gc3VwcG9ydCBpbGwtY29uY2VpdmVkIEphdmEgdGVzdCBzdWl0ZSAqLwoJICAgIHN0cm0uYWRsZXIgPSBzdGF0ZS53cmFwICYgMTsKCSAgfQoJICBzdGF0ZS5tb2RlID0gSEVBRDsKCSAgc3RhdGUubGFzdCA9IDA7CgkgIHN0YXRlLmhhdmVkaWN0ID0gMDsKCSAgc3RhdGUuZG1heCA9IDMyNzY4OwoJICBzdGF0ZS5oZWFkID0gbnVsbC8qWl9OVUxMKi87CgkgIHN0YXRlLmhvbGQgPSAwOwoJICBzdGF0ZS5iaXRzID0gMDsKCSAgLy9zdGF0ZS5sZW5jb2RlID0gc3RhdGUuZGlzdGNvZGUgPSBzdGF0ZS5uZXh0ID0gc3RhdGUuY29kZXM7CgkgIHN0YXRlLmxlbmNvZGUgPSBzdGF0ZS5sZW5keW4gPSBuZXcgdXRpbHMuQnVmMzIoRU5PVUdIX0xFTlMpOwoJICBzdGF0ZS5kaXN0Y29kZSA9IHN0YXRlLmRpc3RkeW4gPSBuZXcgdXRpbHMuQnVmMzIoRU5PVUdIX0RJU1RTKTsKCgkgIHN0YXRlLnNhbmUgPSAxOwoJICBzdGF0ZS5iYWNrID0gLTE7CgkgIC8vVHJhY2V2KChzdGRlcnIsICJpbmZsYXRlOiByZXNldFxuIikpOwoJICByZXR1cm4gWl9PSzsKCX0KCglmdW5jdGlvbiBpbmZsYXRlUmVzZXQoc3RybSkgewoJICB2YXIgc3RhdGU7CgoJICBpZiAoIXN0cm0gfHwgIXN0cm0uc3RhdGUpIHsgcmV0dXJuIFpfU1RSRUFNX0VSUk9SOyB9CgkgIHN0YXRlID0gc3RybS5zdGF0ZTsKCSAgc3RhdGUud3NpemUgPSAwOwoJICBzdGF0ZS53aGF2ZSA9IDA7CgkgIHN0YXRlLnduZXh0ID0gMDsKCSAgcmV0dXJuIGluZmxhdGVSZXNldEtlZXAoc3RybSk7CgoJfQoKCWZ1bmN0aW9uIGluZmxhdGVSZXNldDIoc3RybSwgd2luZG93Qml0cykgewoJICB2YXIgd3JhcDsKCSAgdmFyIHN0YXRlOwoKCSAgLyogZ2V0IHRoZSBzdGF0ZSAqLwoJICBpZiAoIXN0cm0gfHwgIXN0cm0uc3RhdGUpIHsgcmV0dXJuIFpfU1RSRUFNX0VSUk9SOyB9CgkgIHN0YXRlID0gc3RybS5zdGF0ZTsKCgkgIC8qIGV4dHJhY3Qgd3JhcCByZXF1ZXN0IGZyb20gd2luZG93Qml0cyBwYXJhbWV0ZXIgKi8KCSAgaWYgKHdpbmRvd0JpdHMgPCAwKSB7CgkgICAgd3JhcCA9IDA7CgkgICAgd2luZG93Qml0cyA9IC13aW5kb3dCaXRzOwoJICB9CgkgIGVsc2UgewoJICAgIHdyYXAgPSAod2luZG93Qml0cyA+PiA0KSArIDE7CgkgICAgaWYgKHdpbmRvd0JpdHMgPCA0OCkgewoJICAgICAgd2luZG93Qml0cyAmPSAxNTsKCSAgICB9CgkgIH0KCgkgIC8qIHNldCBudW1iZXIgb2Ygd2luZG93IGJpdHMsIGZyZWUgd2luZG93IGlmIGRpZmZlcmVudCAqLwoJICBpZiAod2luZG93Qml0cyAmJiAod2luZG93Qml0cyA8IDggfHwgd2luZG93Qml0cyA+IDE1KSkgewoJICAgIHJldHVybiBaX1NUUkVBTV9FUlJPUjsKCSAgfQoJICBpZiAoc3RhdGUud2luZG93ICE9PSBudWxsICYmIHN0YXRlLndiaXRzICE9PSB3aW5kb3dCaXRzKSB7CgkgICAgc3RhdGUud2luZG93ID0gbnVsbDsKCSAgfQoKCSAgLyogdXBkYXRlIHN0YXRlIGFuZCByZXNldCB0aGUgcmVzdCBvZiBpdCAqLwoJICBzdGF0ZS53cmFwID0gd3JhcDsKCSAgc3RhdGUud2JpdHMgPSB3aW5kb3dCaXRzOwoJICByZXR1cm4gaW5mbGF0ZVJlc2V0KHN0cm0pOwoJfQoKCWZ1bmN0aW9uIGluZmxhdGVJbml0MihzdHJtLCB3aW5kb3dCaXRzKSB7CgkgIHZhciByZXQ7CgkgIHZhciBzdGF0ZTsKCgkgIGlmICghc3RybSkgeyByZXR1cm4gWl9TVFJFQU1fRVJST1I7IH0KCSAgLy9zdHJtLm1zZyA9IFpfTlVMTDsgICAgICAgICAgICAgICAgIC8qIGluIGNhc2Ugd2UgcmV0dXJuIGFuIGVycm9yICovCgoJICBzdGF0ZSA9IG5ldyBJbmZsYXRlU3RhdGUoKTsKCgkgIC8vaWYgKHN0YXRlID09PSBaX05VTEwpIHJldHVybiBaX01FTV9FUlJPUjsKCSAgLy9UcmFjZXYoKHN0ZGVyciwgImluZmxhdGU6IGFsbG9jYXRlZFxuIikpOwoJICBzdHJtLnN0YXRlID0gc3RhdGU7CgkgIHN0YXRlLndpbmRvdyA9IG51bGwvKlpfTlVMTCovOwoJICByZXQgPSBpbmZsYXRlUmVzZXQyKHN0cm0sIHdpbmRvd0JpdHMpOwoJICBpZiAocmV0ICE9PSBaX09LKSB7CgkgICAgc3RybS5zdGF0ZSA9IG51bGwvKlpfTlVMTCovOwoJICB9CgkgIHJldHVybiByZXQ7Cgl9CgoJZnVuY3Rpb24gaW5mbGF0ZUluaXQoc3RybSkgewoJICByZXR1cm4gaW5mbGF0ZUluaXQyKHN0cm0sIERFRl9XQklUUyk7Cgl9CgoKCS8qCgkgUmV0dXJuIHN0YXRlIHdpdGggbGVuZ3RoIGFuZCBkaXN0YW5jZSBkZWNvZGluZyB0YWJsZXMgYW5kIGluZGV4IHNpemVzIHNldCB0bwoJIGZpeGVkIGNvZGUgZGVjb2RpbmcuICBOb3JtYWxseSB0aGlzIHJldHVybnMgZml4ZWQgdGFibGVzIGZyb20gaW5mZml4ZWQuaC4KCSBJZiBCVUlMREZJWEVEIGlzIGRlZmluZWQsIHRoZW4gaW5zdGVhZCB0aGlzIHJvdXRpbmUgYnVpbGRzIHRoZSB0YWJsZXMgdGhlCgkgZmlyc3QgdGltZSBpdCdzIGNhbGxlZCwgYW5kIHJldHVybnMgdGhvc2UgdGFibGVzIHRoZSBmaXJzdCB0aW1lIGFuZAoJIHRoZXJlYWZ0ZXIuICBUaGlzIHJlZHVjZXMgdGhlIHNpemUgb2YgdGhlIGNvZGUgYnkgYWJvdXQgMksgYnl0ZXMsIGluCgkgZXhjaGFuZ2UgZm9yIGEgbGl0dGxlIGV4ZWN1dGlvbiB0aW1lLiAgSG93ZXZlciwgQlVJTERGSVhFRCBzaG91bGQgbm90IGJlCgkgdXNlZCBmb3IgdGhyZWFkZWQgYXBwbGljYXRpb25zLCBzaW5jZSB0aGUgcmV3cml0aW5nIG9mIHRoZSB0YWJsZXMgYW5kIHZpcmdpbgoJIG1heSBub3QgYmUgdGhyZWFkLXNhZmUuCgkgKi8KCXZhciB2aXJnaW4gPSB0cnVlOwoKCXZhciBsZW5maXgsIGRpc3RmaXg7IC8vIFdlIGhhdmUgbm8gcG9pbnRlcnMgaW4gSlMsIHNvIGtlZXAgdGFibGVzIHNlcGFyYXRlCgoJZnVuY3Rpb24gZml4ZWR0YWJsZXMoc3RhdGUpIHsKCSAgLyogYnVpbGQgZml4ZWQgaHVmZm1hbiB0YWJsZXMgaWYgZmlyc3QgY2FsbCAobWF5IG5vdCBiZSB0aHJlYWQgc2FmZSkgKi8KCSAgaWYgKHZpcmdpbikgewoJICAgIHZhciBzeW07CgoJICAgIGxlbmZpeCA9IG5ldyB1dGlscy5CdWYzMig1MTIpOwoJICAgIGRpc3RmaXggPSBuZXcgdXRpbHMuQnVmMzIoMzIpOwoKCSAgICAvKiBsaXRlcmFsL2xlbmd0aCB0YWJsZSAqLwoJICAgIHN5bSA9IDA7CgkgICAgd2hpbGUgKHN5bSA8IDE0NCkgeyBzdGF0ZS5sZW5zW3N5bSsrXSA9IDg7IH0KCSAgICB3aGlsZSAoc3ltIDwgMjU2KSB7IHN0YXRlLmxlbnNbc3ltKytdID0gOTsgfQoJICAgIHdoaWxlIChzeW0gPCAyODApIHsgc3RhdGUubGVuc1tzeW0rK10gPSA3OyB9CgkgICAgd2hpbGUgKHN5bSA8IDI4OCkgeyBzdGF0ZS5sZW5zW3N5bSsrXSA9IDg7IH0KCgkgICAgaW5mbGF0ZV90YWJsZShMRU5TLCAgc3RhdGUubGVucywgMCwgMjg4LCBsZW5maXgsICAgMCwgc3RhdGUud29yaywgeyBiaXRzOiA5IH0pOwoKCSAgICAvKiBkaXN0YW5jZSB0YWJsZSAqLwoJICAgIHN5bSA9IDA7CgkgICAgd2hpbGUgKHN5bSA8IDMyKSB7IHN0YXRlLmxlbnNbc3ltKytdID0gNTsgfQoKCSAgICBpbmZsYXRlX3RhYmxlKERJU1RTLCBzdGF0ZS5sZW5zLCAwLCAzMiwgICBkaXN0Zml4LCAwLCBzdGF0ZS53b3JrLCB7IGJpdHM6IDUgfSk7CgoJICAgIC8qIGRvIHRoaXMganVzdCBvbmNlICovCgkgICAgdmlyZ2luID0gZmFsc2U7CgkgIH0KCgkgIHN0YXRlLmxlbmNvZGUgPSBsZW5maXg7CgkgIHN0YXRlLmxlbmJpdHMgPSA5OwoJICBzdGF0ZS5kaXN0Y29kZSA9IGRpc3RmaXg7CgkgIHN0YXRlLmRpc3RiaXRzID0gNTsKCX0KCgoJLyoKCSBVcGRhdGUgdGhlIHdpbmRvdyB3aXRoIHRoZSBsYXN0IHdzaXplIChub3JtYWxseSAzMkspIGJ5dGVzIHdyaXR0ZW4gYmVmb3JlCgkgcmV0dXJuaW5nLiAgSWYgd2luZG93IGRvZXMgbm90IGV4aXN0IHlldCwgY3JlYXRlIGl0LiAgVGhpcyBpcyBvbmx5IGNhbGxlZAoJIHdoZW4gYSB3aW5kb3cgaXMgYWxyZWFkeSBpbiB1c2UsIG9yIHdoZW4gb3V0cHV0IGhhcyBiZWVuIHdyaXR0ZW4gZHVyaW5nIHRoaXMKCSBpbmZsYXRlIGNhbGwsIGJ1dCB0aGUgZW5kIG9mIHRoZSBkZWZsYXRlIHN0cmVhbSBoYXMgbm90IGJlZW4gcmVhY2hlZCB5ZXQuCgkgSXQgaXMgYWxzbyBjYWxsZWQgdG8gY3JlYXRlIGEgd2luZG93IGZvciBkaWN0aW9uYXJ5IGRhdGEgd2hlbiBhIGRpY3Rpb25hcnkKCSBpcyBsb2FkZWQuCgoJIFByb3ZpZGluZyBvdXRwdXQgYnVmZmVycyBsYXJnZXIgdGhhbiAzMksgdG8gaW5mbGF0ZSgpIHNob3VsZCBwcm92aWRlIGEgc3BlZWQKCSBhZHZhbnRhZ2UsIHNpbmNlIG9ubHkgdGhlIGxhc3QgMzJLIG9mIG91dHB1dCBpcyBjb3BpZWQgdG8gdGhlIHNsaWRpbmcgd2luZG93CgkgdXBvbiByZXR1cm4gZnJvbSBpbmZsYXRlKCksIGFuZCBzaW5jZSBhbGwgZGlzdGFuY2VzIGFmdGVyIHRoZSBmaXJzdCAzMksgb2YKCSBvdXRwdXQgd2lsbCBmYWxsIGluIHRoZSBvdXRwdXQgZGF0YSwgbWFraW5nIG1hdGNoIGNvcGllcyBzaW1wbGVyIGFuZCBmYXN0ZXIuCgkgVGhlIGFkdmFudGFnZSBtYXkgYmUgZGVwZW5kZW50IG9uIHRoZSBzaXplIG9mIHRoZSBwcm9jZXNzb3IncyBkYXRhIGNhY2hlcy4KCSAqLwoJZnVuY3Rpb24gdXBkYXRld2luZG93KHN0cm0sIHNyYywgZW5kLCBjb3B5KSB7CgkgIHZhciBkaXN0OwoJICB2YXIgc3RhdGUgPSBzdHJtLnN0YXRlOwoKCSAgLyogaWYgaXQgaGFzbid0IGJlZW4gZG9uZSBhbHJlYWR5LCBhbGxvY2F0ZSBzcGFjZSBmb3IgdGhlIHdpbmRvdyAqLwoJICBpZiAoc3RhdGUud2luZG93ID09PSBudWxsKSB7CgkgICAgc3RhdGUud3NpemUgPSAxIDw8IHN0YXRlLndiaXRzOwoJICAgIHN0YXRlLnduZXh0ID0gMDsKCSAgICBzdGF0ZS53aGF2ZSA9IDA7CgoJICAgIHN0YXRlLndpbmRvdyA9IG5ldyB1dGlscy5CdWY4KHN0YXRlLndzaXplKTsKCSAgfQoKCSAgLyogY29weSBzdGF0ZS0+d3NpemUgb3IgbGVzcyBvdXRwdXQgYnl0ZXMgaW50byB0aGUgY2lyY3VsYXIgd2luZG93ICovCgkgIGlmIChjb3B5ID49IHN0YXRlLndzaXplKSB7CgkgICAgdXRpbHMuYXJyYXlTZXQoc3RhdGUud2luZG93LCBzcmMsIGVuZCAtIHN0YXRlLndzaXplLCBzdGF0ZS53c2l6ZSwgMCk7CgkgICAgc3RhdGUud25leHQgPSAwOwoJICAgIHN0YXRlLndoYXZlID0gc3RhdGUud3NpemU7CgkgIH0KCSAgZWxzZSB7CgkgICAgZGlzdCA9IHN0YXRlLndzaXplIC0gc3RhdGUud25leHQ7CgkgICAgaWYgKGRpc3QgPiBjb3B5KSB7CgkgICAgICBkaXN0ID0gY29weTsKCSAgICB9CgkgICAgLy96bWVtY3B5KHN0YXRlLT53aW5kb3cgKyBzdGF0ZS0+d25leHQsIGVuZCAtIGNvcHksIGRpc3QpOwoJICAgIHV0aWxzLmFycmF5U2V0KHN0YXRlLndpbmRvdywgc3JjLCBlbmQgLSBjb3B5LCBkaXN0LCBzdGF0ZS53bmV4dCk7CgkgICAgY29weSAtPSBkaXN0OwoJICAgIGlmIChjb3B5KSB7CgkgICAgICAvL3ptZW1jcHkoc3RhdGUtPndpbmRvdywgZW5kIC0gY29weSwgY29weSk7CgkgICAgICB1dGlscy5hcnJheVNldChzdGF0ZS53aW5kb3csIHNyYywgZW5kIC0gY29weSwgY29weSwgMCk7CgkgICAgICBzdGF0ZS53bmV4dCA9IGNvcHk7CgkgICAgICBzdGF0ZS53aGF2ZSA9IHN0YXRlLndzaXplOwoJICAgIH0KCSAgICBlbHNlIHsKCSAgICAgIHN0YXRlLnduZXh0ICs9IGRpc3Q7CgkgICAgICBpZiAoc3RhdGUud25leHQgPT09IHN0YXRlLndzaXplKSB7IHN0YXRlLnduZXh0ID0gMDsgfQoJICAgICAgaWYgKHN0YXRlLndoYXZlIDwgc3RhdGUud3NpemUpIHsgc3RhdGUud2hhdmUgKz0gZGlzdDsgfQoJICAgIH0KCSAgfQoJICByZXR1cm4gMDsKCX0KCglmdW5jdGlvbiBpbmZsYXRlKHN0cm0sIGZsdXNoKSB7CgkgIHZhciBzdGF0ZTsKCSAgdmFyIGlucHV0LCBvdXRwdXQ7ICAgICAgICAgIC8vIGlucHV0L291dHB1dCBidWZmZXJzCgkgIHZhciBuZXh0OyAgICAgICAgICAgICAgICAgICAvKiBuZXh0IGlucHV0IElOREVYICovCgkgIHZhciBwdXQ7ICAgICAgICAgICAgICAgICAgICAvKiBuZXh0IG91dHB1dCBJTkRFWCAqLwoJICB2YXIgaGF2ZSwgbGVmdDsgICAgICAgICAgICAgLyogYXZhaWxhYmxlIGlucHV0IGFuZCBvdXRwdXQgKi8KCSAgdmFyIGhvbGQ7ICAgICAgICAgICAgICAgICAgIC8qIGJpdCBidWZmZXIgKi8KCSAgdmFyIGJpdHM7ICAgICAgICAgICAgICAgICAgIC8qIGJpdHMgaW4gYml0IGJ1ZmZlciAqLwoJICB2YXIgX2luLCBfb3V0OyAgICAgICAgICAgICAgLyogc2F2ZSBzdGFydGluZyBhdmFpbGFibGUgaW5wdXQgYW5kIG91dHB1dCAqLwoJICB2YXIgY29weTsgICAgICAgICAgICAgICAgICAgLyogbnVtYmVyIG9mIHN0b3JlZCBvciBtYXRjaCBieXRlcyB0byBjb3B5ICovCgkgIHZhciBmcm9tOyAgICAgICAgICAgICAgICAgICAvKiB3aGVyZSB0byBjb3B5IG1hdGNoIGJ5dGVzIGZyb20gKi8KCSAgdmFyIGZyb21fc291cmNlOwoJICB2YXIgaGVyZSA9IDA7ICAgICAgICAgICAgICAgLyogY3VycmVudCBkZWNvZGluZyB0YWJsZSBlbnRyeSAqLwoJICB2YXIgaGVyZV9iaXRzLCBoZXJlX29wLCBoZXJlX3ZhbDsgLy8gcGFrZWQgImhlcmUiIGRlbm9ybWFsaXplZCAoSlMgc3BlY2lmaWMpCgkgIC8vdmFyIGxhc3Q7ICAgICAgICAgICAgICAgICAgIC8qIHBhcmVudCB0YWJsZSBlbnRyeSAqLwoJICB2YXIgbGFzdF9iaXRzLCBsYXN0X29wLCBsYXN0X3ZhbDsgLy8gcGFrZWQgImxhc3QiIGRlbm9ybWFsaXplZCAoSlMgc3BlY2lmaWMpCgkgIHZhciBsZW47ICAgICAgICAgICAgICAgICAgICAvKiBsZW5ndGggdG8gY29weSBmb3IgcmVwZWF0cywgYml0cyB0byBkcm9wICovCgkgIHZhciByZXQ7ICAgICAgICAgICAgICAgICAgICAvKiByZXR1cm4gY29kZSAqLwoJICB2YXIgaGJ1ZiA9IG5ldyB1dGlscy5CdWY4KDQpOyAgICAvKiBidWZmZXIgZm9yIGd6aXAgaGVhZGVyIGNyYyBjYWxjdWxhdGlvbiAqLwoJICB2YXIgb3B0czsKCgkgIHZhciBuOyAvLyB0ZW1wb3JhcnkgdmFyIGZvciBORUVEX0JJVFMKCgkgIHZhciBvcmRlciA9IC8qIHBlcm11dGF0aW9uIG9mIGNvZGUgbGVuZ3RocyAqLwoJICAgIFsgMTYsIDE3LCAxOCwgMCwgOCwgNywgOSwgNiwgMTAsIDUsIDExLCA0LCAxMiwgMywgMTMsIDIsIDE0LCAxLCAxNSBdOwoKCgkgIGlmICghc3RybSB8fCAhc3RybS5zdGF0ZSB8fCAhc3RybS5vdXRwdXQgfHwKCSAgICAgICghc3RybS5pbnB1dCAmJiBzdHJtLmF2YWlsX2luICE9PSAwKSkgewoJICAgIHJldHVybiBaX1NUUkVBTV9FUlJPUjsKCSAgfQoKCSAgc3RhdGUgPSBzdHJtLnN0YXRlOwoJICBpZiAoc3RhdGUubW9kZSA9PT0gVFlQRSkgeyBzdGF0ZS5tb2RlID0gVFlQRURPOyB9ICAgIC8qIHNraXAgY2hlY2sgKi8KCgoJICAvLy0tLSBMT0FEKCkgLS0tCgkgIHB1dCA9IHN0cm0ubmV4dF9vdXQ7CgkgIG91dHB1dCA9IHN0cm0ub3V0cHV0OwoJICBsZWZ0ID0gc3RybS5hdmFpbF9vdXQ7CgkgIG5leHQgPSBzdHJtLm5leHRfaW47CgkgIGlucHV0ID0gc3RybS5pbnB1dDsKCSAgaGF2ZSA9IHN0cm0uYXZhaWxfaW47CgkgIGhvbGQgPSBzdGF0ZS5ob2xkOwoJICBiaXRzID0gc3RhdGUuYml0czsKCSAgLy8tLS0KCgkgIF9pbiA9IGhhdmU7CgkgIF9vdXQgPSBsZWZ0OwoJICByZXQgPSBaX09LOwoKCSAgaW5mX2xlYXZlOiAvLyBnb3RvIGVtdWxhdGlvbgoJICBmb3IgKDs7KSB7CgkgICAgc3dpdGNoIChzdGF0ZS5tb2RlKSB7CgkgICAgY2FzZSBIRUFEOgoJICAgICAgaWYgKHN0YXRlLndyYXAgPT09IDApIHsKCSAgICAgICAgc3RhdGUubW9kZSA9IFRZUEVETzsKCSAgICAgICAgYnJlYWs7CgkgICAgICB9CgkgICAgICAvLz09PSBORUVEQklUUygxNik7CgkgICAgICB3aGlsZSAoYml0cyA8IDE2KSB7CgkgICAgICAgIGlmIChoYXZlID09PSAwKSB7IGJyZWFrIGluZl9sZWF2ZTsgfQoJICAgICAgICBoYXZlLS07CgkgICAgICAgIGhvbGQgKz0gaW5wdXRbbmV4dCsrXSA8PCBiaXRzOwoJICAgICAgICBiaXRzICs9IDg7CgkgICAgICB9CgkgICAgICAvLz09PS8vCgkgICAgICBpZiAoKHN0YXRlLndyYXAgJiAyKSAmJiBob2xkID09PSAweDhiMWYpIHsgIC8qIGd6aXAgaGVhZGVyICovCgkgICAgICAgIHN0YXRlLmNoZWNrID0gMC8qY3JjMzIoMEwsIFpfTlVMTCwgMCkqLzsKCSAgICAgICAgLy89PT0gQ1JDMihzdGF0ZS5jaGVjaywgaG9sZCk7CgkgICAgICAgIGhidWZbMF0gPSBob2xkICYgMHhmZjsKCSAgICAgICAgaGJ1ZlsxXSA9IChob2xkID4+PiA4KSAmIDB4ZmY7CgkgICAgICAgIHN0YXRlLmNoZWNrID0gY3JjMzIoc3RhdGUuY2hlY2ssIGhidWYsIDIsIDApOwoJICAgICAgICAvLz09PS8vCgoJICAgICAgICAvLz09PSBJTklUQklUUygpOwoJICAgICAgICBob2xkID0gMDsKCSAgICAgICAgYml0cyA9IDA7CgkgICAgICAgIC8vPT09Ly8KCSAgICAgICAgc3RhdGUubW9kZSA9IEZMQUdTOwoJICAgICAgICBicmVhazsKCSAgICAgIH0KCSAgICAgIHN0YXRlLmZsYWdzID0gMDsgICAgICAgICAgIC8qIGV4cGVjdCB6bGliIGhlYWRlciAqLwoJICAgICAgaWYgKHN0YXRlLmhlYWQpIHsKCSAgICAgICAgc3RhdGUuaGVhZC5kb25lID0gZmFsc2U7CgkgICAgICB9CgkgICAgICBpZiAoIShzdGF0ZS53cmFwICYgMSkgfHwgICAvKiBjaGVjayBpZiB6bGliIGhlYWRlciBhbGxvd2VkICovCgkgICAgICAgICgoKGhvbGQgJiAweGZmKS8qQklUUyg4KSovIDw8IDgpICsgKGhvbGQgPj4gOCkpICUgMzEpIHsKCSAgICAgICAgc3RybS5tc2cgPSAnaW5jb3JyZWN0IGhlYWRlciBjaGVjayc7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgICAgaWYgKChob2xkICYgMHgwZikvKkJJVFMoNCkqLyAhPT0gWl9ERUZMQVRFRCkgewoJICAgICAgICBzdHJtLm1zZyA9ICd1bmtub3duIGNvbXByZXNzaW9uIG1ldGhvZCc7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgICAgLy8tLS0gRFJPUEJJVFMoNCkgLS0tLy8KCSAgICAgIGhvbGQgPj4+PSA0OwoJICAgICAgYml0cyAtPSA0OwoJICAgICAgLy8tLS0vLwoJICAgICAgbGVuID0gKGhvbGQgJiAweDBmKS8qQklUUyg0KSovICsgODsKCSAgICAgIGlmIChzdGF0ZS53Yml0cyA9PT0gMCkgewoJICAgICAgICBzdGF0ZS53Yml0cyA9IGxlbjsKCSAgICAgIH0KCSAgICAgIGVsc2UgaWYgKGxlbiA+IHN0YXRlLndiaXRzKSB7CgkgICAgICAgIHN0cm0ubXNnID0gJ2ludmFsaWQgd2luZG93IHNpemUnOwoJICAgICAgICBzdGF0ZS5tb2RlID0gQkFEOwoJICAgICAgICBicmVhazsKCSAgICAgIH0KCSAgICAgIHN0YXRlLmRtYXggPSAxIDw8IGxlbjsKCSAgICAgIC8vVHJhY2V2KChzdGRlcnIsICJpbmZsYXRlOiAgIHpsaWIgaGVhZGVyIG9rXG4iKSk7CgkgICAgICBzdHJtLmFkbGVyID0gc3RhdGUuY2hlY2sgPSAxLyphZGxlcjMyKDBMLCBaX05VTEwsIDApKi87CgkgICAgICBzdGF0ZS5tb2RlID0gaG9sZCAmIDB4MjAwID8gRElDVElEIDogVFlQRTsKCSAgICAgIC8vPT09IElOSVRCSVRTKCk7CgkgICAgICBob2xkID0gMDsKCSAgICAgIGJpdHMgPSAwOwoJICAgICAgLy89PT0vLwoJICAgICAgYnJlYWs7CgkgICAgY2FzZSBGTEFHUzoKCSAgICAgIC8vPT09IE5FRURCSVRTKDE2KTsgKi8KCSAgICAgIHdoaWxlIChiaXRzIDwgMTYpIHsKCSAgICAgICAgaWYgKGhhdmUgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgIGhhdmUtLTsKCSAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgIGJpdHMgKz0gODsKCSAgICAgIH0KCSAgICAgIC8vPT09Ly8KCSAgICAgIHN0YXRlLmZsYWdzID0gaG9sZDsKCSAgICAgIGlmICgoc3RhdGUuZmxhZ3MgJiAweGZmKSAhPT0gWl9ERUZMQVRFRCkgewoJICAgICAgICBzdHJtLm1zZyA9ICd1bmtub3duIGNvbXByZXNzaW9uIG1ldGhvZCc7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgICAgaWYgKHN0YXRlLmZsYWdzICYgMHhlMDAwKSB7CgkgICAgICAgIHN0cm0ubXNnID0gJ3Vua25vd24gaGVhZGVyIGZsYWdzIHNldCc7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgICAgaWYgKHN0YXRlLmhlYWQpIHsKCSAgICAgICAgc3RhdGUuaGVhZC50ZXh0ID0gKChob2xkID4+IDgpICYgMSk7CgkgICAgICB9CgkgICAgICBpZiAoc3RhdGUuZmxhZ3MgJiAweDAyMDApIHsKCSAgICAgICAgLy89PT0gQ1JDMihzdGF0ZS5jaGVjaywgaG9sZCk7CgkgICAgICAgIGhidWZbMF0gPSBob2xkICYgMHhmZjsKCSAgICAgICAgaGJ1ZlsxXSA9IChob2xkID4+PiA4KSAmIDB4ZmY7CgkgICAgICAgIHN0YXRlLmNoZWNrID0gY3JjMzIoc3RhdGUuY2hlY2ssIGhidWYsIDIsIDApOwoJICAgICAgICAvLz09PS8vCgkgICAgICB9CgkgICAgICAvLz09PSBJTklUQklUUygpOwoJICAgICAgaG9sZCA9IDA7CgkgICAgICBiaXRzID0gMDsKCSAgICAgIC8vPT09Ly8KCSAgICAgIHN0YXRlLm1vZGUgPSBUSU1FOwoJICAgICAgLyogZmFsbHMgdGhyb3VnaCAqLwoJICAgIGNhc2UgVElNRToKCSAgICAgIC8vPT09IE5FRURCSVRTKDMyKTsgKi8KCSAgICAgIHdoaWxlIChiaXRzIDwgMzIpIHsKCSAgICAgICAgaWYgKGhhdmUgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgIGhhdmUtLTsKCSAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgIGJpdHMgKz0gODsKCSAgICAgIH0KCSAgICAgIC8vPT09Ly8KCSAgICAgIGlmIChzdGF0ZS5oZWFkKSB7CgkgICAgICAgIHN0YXRlLmhlYWQudGltZSA9IGhvbGQ7CgkgICAgICB9CgkgICAgICBpZiAoc3RhdGUuZmxhZ3MgJiAweDAyMDApIHsKCSAgICAgICAgLy89PT0gQ1JDNChzdGF0ZS5jaGVjaywgaG9sZCkKCSAgICAgICAgaGJ1ZlswXSA9IGhvbGQgJiAweGZmOwoJICAgICAgICBoYnVmWzFdID0gKGhvbGQgPj4+IDgpICYgMHhmZjsKCSAgICAgICAgaGJ1ZlsyXSA9IChob2xkID4+PiAxNikgJiAweGZmOwoJICAgICAgICBoYnVmWzNdID0gKGhvbGQgPj4+IDI0KSAmIDB4ZmY7CgkgICAgICAgIHN0YXRlLmNoZWNrID0gY3JjMzIoc3RhdGUuY2hlY2ssIGhidWYsIDQsIDApOwoJICAgICAgICAvLz09PQoJICAgICAgfQoJICAgICAgLy89PT0gSU5JVEJJVFMoKTsKCSAgICAgIGhvbGQgPSAwOwoJICAgICAgYml0cyA9IDA7CgkgICAgICAvLz09PS8vCgkgICAgICBzdGF0ZS5tb2RlID0gT1M7CgkgICAgICAvKiBmYWxscyB0aHJvdWdoICovCgkgICAgY2FzZSBPUzoKCSAgICAgIC8vPT09IE5FRURCSVRTKDE2KTsgKi8KCSAgICAgIHdoaWxlIChiaXRzIDwgMTYpIHsKCSAgICAgICAgaWYgKGhhdmUgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgIGhhdmUtLTsKCSAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgIGJpdHMgKz0gODsKCSAgICAgIH0KCSAgICAgIC8vPT09Ly8KCSAgICAgIGlmIChzdGF0ZS5oZWFkKSB7CgkgICAgICAgIHN0YXRlLmhlYWQueGZsYWdzID0gKGhvbGQgJiAweGZmKTsKCSAgICAgICAgc3RhdGUuaGVhZC5vcyA9IChob2xkID4+IDgpOwoJICAgICAgfQoJICAgICAgaWYgKHN0YXRlLmZsYWdzICYgMHgwMjAwKSB7CgkgICAgICAgIC8vPT09IENSQzIoc3RhdGUuY2hlY2ssIGhvbGQpOwoJICAgICAgICBoYnVmWzBdID0gaG9sZCAmIDB4ZmY7CgkgICAgICAgIGhidWZbMV0gPSAoaG9sZCA+Pj4gOCkgJiAweGZmOwoJICAgICAgICBzdGF0ZS5jaGVjayA9IGNyYzMyKHN0YXRlLmNoZWNrLCBoYnVmLCAyLCAwKTsKCSAgICAgICAgLy89PT0vLwoJICAgICAgfQoJICAgICAgLy89PT0gSU5JVEJJVFMoKTsKCSAgICAgIGhvbGQgPSAwOwoJICAgICAgYml0cyA9IDA7CgkgICAgICAvLz09PS8vCgkgICAgICBzdGF0ZS5tb2RlID0gRVhMRU47CgkgICAgICAvKiBmYWxscyB0aHJvdWdoICovCgkgICAgY2FzZSBFWExFTjoKCSAgICAgIGlmIChzdGF0ZS5mbGFncyAmIDB4MDQwMCkgewoJICAgICAgICAvLz09PSBORUVEQklUUygxNik7ICovCgkgICAgICAgIHdoaWxlIChiaXRzIDwgMTYpIHsKCSAgICAgICAgICBpZiAoaGF2ZSA9PT0gMCkgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgICAgICBoYXZlLS07CgkgICAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgICAgYml0cyArPSA4OwoJICAgICAgICB9CgkgICAgICAgIC8vPT09Ly8KCSAgICAgICAgc3RhdGUubGVuZ3RoID0gaG9sZDsKCSAgICAgICAgaWYgKHN0YXRlLmhlYWQpIHsKCSAgICAgICAgICBzdGF0ZS5oZWFkLmV4dHJhX2xlbiA9IGhvbGQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlLmZsYWdzICYgMHgwMjAwKSB7CgkgICAgICAgICAgLy89PT0gQ1JDMihzdGF0ZS5jaGVjaywgaG9sZCk7CgkgICAgICAgICAgaGJ1ZlswXSA9IGhvbGQgJiAweGZmOwoJICAgICAgICAgIGhidWZbMV0gPSAoaG9sZCA+Pj4gOCkgJiAweGZmOwoJICAgICAgICAgIHN0YXRlLmNoZWNrID0gY3JjMzIoc3RhdGUuY2hlY2ssIGhidWYsIDIsIDApOwoJICAgICAgICAgIC8vPT09Ly8KCSAgICAgICAgfQoJICAgICAgICAvLz09PSBJTklUQklUUygpOwoJICAgICAgICBob2xkID0gMDsKCSAgICAgICAgYml0cyA9IDA7CgkgICAgICAgIC8vPT09Ly8KCSAgICAgIH0KCSAgICAgIGVsc2UgaWYgKHN0YXRlLmhlYWQpIHsKCSAgICAgICAgc3RhdGUuaGVhZC5leHRyYSA9IG51bGwvKlpfTlVMTCovOwoJICAgICAgfQoJICAgICAgc3RhdGUubW9kZSA9IEVYVFJBOwoJICAgICAgLyogZmFsbHMgdGhyb3VnaCAqLwoJICAgIGNhc2UgRVhUUkE6CgkgICAgICBpZiAoc3RhdGUuZmxhZ3MgJiAweDA0MDApIHsKCSAgICAgICAgY29weSA9IHN0YXRlLmxlbmd0aDsKCSAgICAgICAgaWYgKGNvcHkgPiBoYXZlKSB7IGNvcHkgPSBoYXZlOyB9CgkgICAgICAgIGlmIChjb3B5KSB7CgkgICAgICAgICAgaWYgKHN0YXRlLmhlYWQpIHsKCSAgICAgICAgICAgIGxlbiA9IHN0YXRlLmhlYWQuZXh0cmFfbGVuIC0gc3RhdGUubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKCFzdGF0ZS5oZWFkLmV4dHJhKSB7CgkgICAgICAgICAgICAgIC8vIFVzZSB1bnR5cGVkIGFycmF5IGZvciBtb3JlIGNvbnZlbmllbmQgcHJvY2Vzc2luZyBsYXRlcgoJICAgICAgICAgICAgICBzdGF0ZS5oZWFkLmV4dHJhID0gbmV3IEFycmF5KHN0YXRlLmhlYWQuZXh0cmFfbGVuKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHV0aWxzLmFycmF5U2V0KAoJICAgICAgICAgICAgICBzdGF0ZS5oZWFkLmV4dHJhLAoJICAgICAgICAgICAgICBpbnB1dCwKCSAgICAgICAgICAgICAgbmV4dCwKCSAgICAgICAgICAgICAgLy8gZXh0cmEgZmllbGQgaXMgbGltaXRlZCB0byA2NTUzNiBieXRlcwoJICAgICAgICAgICAgICAvLyAtIG5vIG5lZWQgZm9yIGFkZGl0aW9uYWwgc2l6ZSBjaGVjawoJICAgICAgICAgICAgICBjb3B5LAoJICAgICAgICAgICAgICAvKmxlbiArIGNvcHkgPiBzdGF0ZS5oZWFkLmV4dHJhX21heCAtIGxlbiA/IHN0YXRlLmhlYWQuZXh0cmFfbWF4IDogY29weSwqLwoJICAgICAgICAgICAgICBsZW4KCSAgICAgICAgICAgICk7CgkgICAgICAgICAgICAvL3ptZW1jcHkoc3RhdGUuaGVhZC5leHRyYSArIGxlbiwgbmV4dCwKCSAgICAgICAgICAgIC8vICAgICAgICBsZW4gKyBjb3B5ID4gc3RhdGUuaGVhZC5leHRyYV9tYXggPwoJICAgICAgICAgICAgLy8gICAgICAgIHN0YXRlLmhlYWQuZXh0cmFfbWF4IC0gbGVuIDogY29weSk7CgkgICAgICAgICAgfQoJICAgICAgICAgIGlmIChzdGF0ZS5mbGFncyAmIDB4MDIwMCkgewoJICAgICAgICAgICAgc3RhdGUuY2hlY2sgPSBjcmMzMihzdGF0ZS5jaGVjaywgaW5wdXQsIGNvcHksIG5leHQpOwoJICAgICAgICAgIH0KCSAgICAgICAgICBoYXZlIC09IGNvcHk7CgkgICAgICAgICAgbmV4dCArPSBjb3B5OwoJICAgICAgICAgIHN0YXRlLmxlbmd0aCAtPSBjb3B5OwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZS5sZW5ndGgpIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICB9CgkgICAgICBzdGF0ZS5sZW5ndGggPSAwOwoJICAgICAgc3RhdGUubW9kZSA9IE5BTUU7CgkgICAgICAvKiBmYWxscyB0aHJvdWdoICovCgkgICAgY2FzZSBOQU1FOgoJICAgICAgaWYgKHN0YXRlLmZsYWdzICYgMHgwODAwKSB7CgkgICAgICAgIGlmIChoYXZlID09PSAwKSB7IGJyZWFrIGluZl9sZWF2ZTsgfQoJICAgICAgICBjb3B5ID0gMDsKCSAgICAgICAgZG8gewoJICAgICAgICAgIC8vIFRPRE86IDIgb3IgMSBieXRlcz8KCSAgICAgICAgICBsZW4gPSBpbnB1dFtuZXh0ICsgY29weSsrXTsKCSAgICAgICAgICAvKiB1c2UgY29uc3RhbnQgbGltaXQgYmVjYXVzZSBpbiBqcyB3ZSBzaG91bGQgbm90IHByZWFsbG9jYXRlIG1lbW9yeSAqLwoJICAgICAgICAgIGlmIChzdGF0ZS5oZWFkICYmIGxlbiAmJgoJICAgICAgICAgICAgICAoc3RhdGUubGVuZ3RoIDwgNjU1MzYgLypzdGF0ZS5oZWFkLm5hbWVfbWF4Ki8pKSB7CgkgICAgICAgICAgICBzdGF0ZS5oZWFkLm5hbWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShsZW4pOwoJICAgICAgICAgIH0KCSAgICAgICAgfSB3aGlsZSAobGVuICYmIGNvcHkgPCBoYXZlKTsKCgkgICAgICAgIGlmIChzdGF0ZS5mbGFncyAmIDB4MDIwMCkgewoJICAgICAgICAgIHN0YXRlLmNoZWNrID0gY3JjMzIoc3RhdGUuY2hlY2ssIGlucHV0LCBjb3B5LCBuZXh0KTsKCSAgICAgICAgfQoJICAgICAgICBoYXZlIC09IGNvcHk7CgkgICAgICAgIG5leHQgKz0gY29weTsKCSAgICAgICAgaWYgKGxlbikgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgIH0KCSAgICAgIGVsc2UgaWYgKHN0YXRlLmhlYWQpIHsKCSAgICAgICAgc3RhdGUuaGVhZC5uYW1lID0gbnVsbDsKCSAgICAgIH0KCSAgICAgIHN0YXRlLmxlbmd0aCA9IDA7CgkgICAgICBzdGF0ZS5tb2RlID0gQ09NTUVOVDsKCSAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi8KCSAgICBjYXNlIENPTU1FTlQ6CgkgICAgICBpZiAoc3RhdGUuZmxhZ3MgJiAweDEwMDApIHsKCSAgICAgICAgaWYgKGhhdmUgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgIGNvcHkgPSAwOwoJICAgICAgICBkbyB7CgkgICAgICAgICAgbGVuID0gaW5wdXRbbmV4dCArIGNvcHkrK107CgkgICAgICAgICAgLyogdXNlIGNvbnN0YW50IGxpbWl0IGJlY2F1c2UgaW4ganMgd2Ugc2hvdWxkIG5vdCBwcmVhbGxvY2F0ZSBtZW1vcnkgKi8KCSAgICAgICAgICBpZiAoc3RhdGUuaGVhZCAmJiBsZW4gJiYKCSAgICAgICAgICAgICAgKHN0YXRlLmxlbmd0aCA8IDY1NTM2IC8qc3RhdGUuaGVhZC5jb21tX21heCovKSkgewoJICAgICAgICAgICAgc3RhdGUuaGVhZC5jb21tZW50ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUobGVuKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0gd2hpbGUgKGxlbiAmJiBjb3B5IDwgaGF2ZSk7CgkgICAgICAgIGlmIChzdGF0ZS5mbGFncyAmIDB4MDIwMCkgewoJICAgICAgICAgIHN0YXRlLmNoZWNrID0gY3JjMzIoc3RhdGUuY2hlY2ssIGlucHV0LCBjb3B5LCBuZXh0KTsKCSAgICAgICAgfQoJICAgICAgICBoYXZlIC09IGNvcHk7CgkgICAgICAgIG5leHQgKz0gY29weTsKCSAgICAgICAgaWYgKGxlbikgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgIH0KCSAgICAgIGVsc2UgaWYgKHN0YXRlLmhlYWQpIHsKCSAgICAgICAgc3RhdGUuaGVhZC5jb21tZW50ID0gbnVsbDsKCSAgICAgIH0KCSAgICAgIHN0YXRlLm1vZGUgPSBIQ1JDOwoJICAgICAgLyogZmFsbHMgdGhyb3VnaCAqLwoJICAgIGNhc2UgSENSQzoKCSAgICAgIGlmIChzdGF0ZS5mbGFncyAmIDB4MDIwMCkgewoJICAgICAgICAvLz09PSBORUVEQklUUygxNik7ICovCgkgICAgICAgIHdoaWxlIChiaXRzIDwgMTYpIHsKCSAgICAgICAgICBpZiAoaGF2ZSA9PT0gMCkgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgICAgICBoYXZlLS07CgkgICAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgICAgYml0cyArPSA4OwoJICAgICAgICB9CgkgICAgICAgIC8vPT09Ly8KCSAgICAgICAgaWYgKGhvbGQgIT09IChzdGF0ZS5jaGVjayAmIDB4ZmZmZikpIHsKCSAgICAgICAgICBzdHJtLm1zZyA9ICdoZWFkZXIgY3JjIG1pc21hdGNoJzsKCSAgICAgICAgICBzdGF0ZS5tb2RlID0gQkFEOwoJICAgICAgICAgIGJyZWFrOwoJICAgICAgICB9CgkgICAgICAgIC8vPT09IElOSVRCSVRTKCk7CgkgICAgICAgIGhvbGQgPSAwOwoJICAgICAgICBiaXRzID0gMDsKCSAgICAgICAgLy89PT0vLwoJICAgICAgfQoJICAgICAgaWYgKHN0YXRlLmhlYWQpIHsKCSAgICAgICAgc3RhdGUuaGVhZC5oY3JjID0gKChzdGF0ZS5mbGFncyA+PiA5KSAmIDEpOwoJICAgICAgICBzdGF0ZS5oZWFkLmRvbmUgPSB0cnVlOwoJICAgICAgfQoJICAgICAgc3RybS5hZGxlciA9IHN0YXRlLmNoZWNrID0gMDsKCSAgICAgIHN0YXRlLm1vZGUgPSBUWVBFOwoJICAgICAgYnJlYWs7CgkgICAgY2FzZSBESUNUSUQ6CgkgICAgICAvLz09PSBORUVEQklUUygzMik7ICovCgkgICAgICB3aGlsZSAoYml0cyA8IDMyKSB7CgkgICAgICAgIGlmIChoYXZlID09PSAwKSB7IGJyZWFrIGluZl9sZWF2ZTsgfQoJICAgICAgICBoYXZlLS07CgkgICAgICAgIGhvbGQgKz0gaW5wdXRbbmV4dCsrXSA8PCBiaXRzOwoJICAgICAgICBiaXRzICs9IDg7CgkgICAgICB9CgkgICAgICAvLz09PS8vCgkgICAgICBzdHJtLmFkbGVyID0gc3RhdGUuY2hlY2sgPSB6c3dhcDMyKGhvbGQpOwoJICAgICAgLy89PT0gSU5JVEJJVFMoKTsKCSAgICAgIGhvbGQgPSAwOwoJICAgICAgYml0cyA9IDA7CgkgICAgICAvLz09PS8vCgkgICAgICBzdGF0ZS5tb2RlID0gRElDVDsKCSAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi8KCSAgICBjYXNlIERJQ1Q6CgkgICAgICBpZiAoc3RhdGUuaGF2ZWRpY3QgPT09IDApIHsKCSAgICAgICAgLy8tLS0gUkVTVE9SRSgpIC0tLQoJICAgICAgICBzdHJtLm5leHRfb3V0ID0gcHV0OwoJICAgICAgICBzdHJtLmF2YWlsX291dCA9IGxlZnQ7CgkgICAgICAgIHN0cm0ubmV4dF9pbiA9IG5leHQ7CgkgICAgICAgIHN0cm0uYXZhaWxfaW4gPSBoYXZlOwoJICAgICAgICBzdGF0ZS5ob2xkID0gaG9sZDsKCSAgICAgICAgc3RhdGUuYml0cyA9IGJpdHM7CgkgICAgICAgIC8vLS0tCgkgICAgICAgIHJldHVybiBaX05FRURfRElDVDsKCSAgICAgIH0KCSAgICAgIHN0cm0uYWRsZXIgPSBzdGF0ZS5jaGVjayA9IDEvKmFkbGVyMzIoMEwsIFpfTlVMTCwgMCkqLzsKCSAgICAgIHN0YXRlLm1vZGUgPSBUWVBFOwoJICAgICAgLyogZmFsbHMgdGhyb3VnaCAqLwoJICAgIGNhc2UgVFlQRToKCSAgICAgIGlmIChmbHVzaCA9PT0gWl9CTE9DSyB8fCBmbHVzaCA9PT0gWl9UUkVFUykgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi8KCSAgICBjYXNlIFRZUEVETzoKCSAgICAgIGlmIChzdGF0ZS5sYXN0KSB7CgkgICAgICAgIC8vLS0tIEJZVEVCSVRTKCkgLS0tLy8KCSAgICAgICAgaG9sZCA+Pj49IGJpdHMgJiA3OwoJICAgICAgICBiaXRzIC09IGJpdHMgJiA3OwoJICAgICAgICAvLy0tLS8vCgkgICAgICAgIHN0YXRlLm1vZGUgPSBDSEVDSzsKCSAgICAgICAgYnJlYWs7CgkgICAgICB9CgkgICAgICAvLz09PSBORUVEQklUUygzKTsgKi8KCSAgICAgIHdoaWxlIChiaXRzIDwgMykgewoJICAgICAgICBpZiAoaGF2ZSA9PT0gMCkgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgICAgaGF2ZS0tOwoJICAgICAgICBob2xkICs9IGlucHV0W25leHQrK10gPDwgYml0czsKCSAgICAgICAgYml0cyArPSA4OwoJICAgICAgfQoJICAgICAgLy89PT0vLwoJICAgICAgc3RhdGUubGFzdCA9IChob2xkICYgMHgwMSkvKkJJVFMoMSkqLzsKCSAgICAgIC8vLS0tIERST1BCSVRTKDEpIC0tLS8vCgkgICAgICBob2xkID4+Pj0gMTsKCSAgICAgIGJpdHMgLT0gMTsKCSAgICAgIC8vLS0tLy8KCgkgICAgICBzd2l0Y2ggKChob2xkICYgMHgwMykvKkJJVFMoMikqLykgewoJICAgICAgY2FzZSAwOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogc3RvcmVkIGJsb2NrICovCgkgICAgICAgIC8vVHJhY2V2KChzdGRlcnIsICJpbmZsYXRlOiAgICAgc3RvcmVkIGJsb2NrJXNcbiIsCgkgICAgICAgIC8vICAgICAgICBzdGF0ZS5sYXN0ID8gIiAobGFzdCkiIDogIiIpKTsKCSAgICAgICAgc3RhdGUubW9kZSA9IFNUT1JFRDsKCSAgICAgICAgYnJlYWs7CgkgICAgICBjYXNlIDE6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBmaXhlZCBibG9jayAqLwoJICAgICAgICBmaXhlZHRhYmxlcyhzdGF0ZSk7CgkgICAgICAgIC8vVHJhY2V2KChzdGRlcnIsICJpbmZsYXRlOiAgICAgZml4ZWQgY29kZXMgYmxvY2slc1xuIiwKCSAgICAgICAgLy8gICAgICAgIHN0YXRlLmxhc3QgPyAiIChsYXN0KSIgOiAiIikpOwoJICAgICAgICBzdGF0ZS5tb2RlID0gTEVOXzsgICAgICAgICAgICAgLyogZGVjb2RlIGNvZGVzICovCgkgICAgICAgIGlmIChmbHVzaCA9PT0gWl9UUkVFUykgewoJICAgICAgICAgIC8vLS0tIERST1BCSVRTKDIpIC0tLS8vCgkgICAgICAgICAgaG9sZCA+Pj49IDI7CgkgICAgICAgICAgYml0cyAtPSAyOwoJICAgICAgICAgIC8vLS0tLy8KCSAgICAgICAgICBicmVhayBpbmZfbGVhdmU7CgkgICAgICAgIH0KCSAgICAgICAgYnJlYWs7CgkgICAgICBjYXNlIDI6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBkeW5hbWljIGJsb2NrICovCgkgICAgICAgIC8vVHJhY2V2KChzdGRlcnIsICJpbmZsYXRlOiAgICAgZHluYW1pYyBjb2RlcyBibG9jayVzXG4iLAoJICAgICAgICAvLyAgICAgICAgc3RhdGUubGFzdCA/ICIgKGxhc3QpIiA6ICIiKSk7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBUQUJMRTsKCSAgICAgICAgYnJlYWs7CgkgICAgICBjYXNlIDM6CgkgICAgICAgIHN0cm0ubXNnID0gJ2ludmFsaWQgYmxvY2sgdHlwZSc7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICB9CgkgICAgICAvLy0tLSBEUk9QQklUUygyKSAtLS0vLwoJICAgICAgaG9sZCA+Pj49IDI7CgkgICAgICBiaXRzIC09IDI7CgkgICAgICAvLy0tLS8vCgkgICAgICBicmVhazsKCSAgICBjYXNlIFNUT1JFRDoKCSAgICAgIC8vLS0tIEJZVEVCSVRTKCkgLS0tLy8gLyogZ28gdG8gYnl0ZSBib3VuZGFyeSAqLwoJICAgICAgaG9sZCA+Pj49IGJpdHMgJiA3OwoJICAgICAgYml0cyAtPSBiaXRzICYgNzsKCSAgICAgIC8vLS0tLy8KCSAgICAgIC8vPT09IE5FRURCSVRTKDMyKTsgKi8KCSAgICAgIHdoaWxlIChiaXRzIDwgMzIpIHsKCSAgICAgICAgaWYgKGhhdmUgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgIGhhdmUtLTsKCSAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgIGJpdHMgKz0gODsKCSAgICAgIH0KCSAgICAgIC8vPT09Ly8KCSAgICAgIGlmICgoaG9sZCAmIDB4ZmZmZikgIT09ICgoaG9sZCA+Pj4gMTYpIF4gMHhmZmZmKSkgewoJICAgICAgICBzdHJtLm1zZyA9ICdpbnZhbGlkIHN0b3JlZCBibG9jayBsZW5ndGhzJzsKCSAgICAgICAgc3RhdGUubW9kZSA9IEJBRDsKCSAgICAgICAgYnJlYWs7CgkgICAgICB9CgkgICAgICBzdGF0ZS5sZW5ndGggPSBob2xkICYgMHhmZmZmOwoJICAgICAgLy9UcmFjZXYoKHN0ZGVyciwgImluZmxhdGU6ICAgICAgIHN0b3JlZCBsZW5ndGggJXVcbiIsCgkgICAgICAvLyAgICAgICAgc3RhdGUubGVuZ3RoKSk7CgkgICAgICAvLz09PSBJTklUQklUUygpOwoJICAgICAgaG9sZCA9IDA7CgkgICAgICBiaXRzID0gMDsKCSAgICAgIC8vPT09Ly8KCSAgICAgIHN0YXRlLm1vZGUgPSBDT1BZXzsKCSAgICAgIGlmIChmbHVzaCA9PT0gWl9UUkVFUykgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi8KCSAgICBjYXNlIENPUFlfOgoJICAgICAgc3RhdGUubW9kZSA9IENPUFk7CgkgICAgICAvKiBmYWxscyB0aHJvdWdoICovCgkgICAgY2FzZSBDT1BZOgoJICAgICAgY29weSA9IHN0YXRlLmxlbmd0aDsKCSAgICAgIGlmIChjb3B5KSB7CgkgICAgICAgIGlmIChjb3B5ID4gaGF2ZSkgeyBjb3B5ID0gaGF2ZTsgfQoJICAgICAgICBpZiAoY29weSA+IGxlZnQpIHsgY29weSA9IGxlZnQ7IH0KCSAgICAgICAgaWYgKGNvcHkgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgIC8vLS0tIHptZW1jcHkocHV0LCBuZXh0LCBjb3B5KTsgLS0tCgkgICAgICAgIHV0aWxzLmFycmF5U2V0KG91dHB1dCwgaW5wdXQsIG5leHQsIGNvcHksIHB1dCk7CgkgICAgICAgIC8vLS0tLy8KCSAgICAgICAgaGF2ZSAtPSBjb3B5OwoJICAgICAgICBuZXh0ICs9IGNvcHk7CgkgICAgICAgIGxlZnQgLT0gY29weTsKCSAgICAgICAgcHV0ICs9IGNvcHk7CgkgICAgICAgIHN0YXRlLmxlbmd0aCAtPSBjb3B5OwoJICAgICAgICBicmVhazsKCSAgICAgIH0KCSAgICAgIC8vVHJhY2V2KChzdGRlcnIsICJpbmZsYXRlOiAgICAgICBzdG9yZWQgZW5kXG4iKSk7CgkgICAgICBzdGF0ZS5tb2RlID0gVFlQRTsKCSAgICAgIGJyZWFrOwoJICAgIGNhc2UgVEFCTEU6CgkgICAgICAvLz09PSBORUVEQklUUygxNCk7ICovCgkgICAgICB3aGlsZSAoYml0cyA8IDE0KSB7CgkgICAgICAgIGlmIChoYXZlID09PSAwKSB7IGJyZWFrIGluZl9sZWF2ZTsgfQoJICAgICAgICBoYXZlLS07CgkgICAgICAgIGhvbGQgKz0gaW5wdXRbbmV4dCsrXSA8PCBiaXRzOwoJICAgICAgICBiaXRzICs9IDg7CgkgICAgICB9CgkgICAgICAvLz09PS8vCgkgICAgICBzdGF0ZS5ubGVuID0gKGhvbGQgJiAweDFmKS8qQklUUyg1KSovICsgMjU3OwoJICAgICAgLy8tLS0gRFJPUEJJVFMoNSkgLS0tLy8KCSAgICAgIGhvbGQgPj4+PSA1OwoJICAgICAgYml0cyAtPSA1OwoJICAgICAgLy8tLS0vLwoJICAgICAgc3RhdGUubmRpc3QgPSAoaG9sZCAmIDB4MWYpLypCSVRTKDUpKi8gKyAxOwoJICAgICAgLy8tLS0gRFJPUEJJVFMoNSkgLS0tLy8KCSAgICAgIGhvbGQgPj4+PSA1OwoJICAgICAgYml0cyAtPSA1OwoJICAgICAgLy8tLS0vLwoJICAgICAgc3RhdGUubmNvZGUgPSAoaG9sZCAmIDB4MGYpLypCSVRTKDQpKi8gKyA0OwoJICAgICAgLy8tLS0gRFJPUEJJVFMoNCkgLS0tLy8KCSAgICAgIGhvbGQgPj4+PSA0OwoJICAgICAgYml0cyAtPSA0OwoJICAgICAgLy8tLS0vLwoJLy8jaWZuZGVmIFBLWklQX0JVR19XT1JLQVJPVU5ECgkgICAgICBpZiAoc3RhdGUubmxlbiA+IDI4NiB8fCBzdGF0ZS5uZGlzdCA+IDMwKSB7CgkgICAgICAgIHN0cm0ubXNnID0gJ3RvbyBtYW55IGxlbmd0aCBvciBkaXN0YW5jZSBzeW1ib2xzJzsKCSAgICAgICAgc3RhdGUubW9kZSA9IEJBRDsKCSAgICAgICAgYnJlYWs7CgkgICAgICB9CgkvLyNlbmRpZgoJICAgICAgLy9UcmFjZXYoKHN0ZGVyciwgImluZmxhdGU6ICAgICAgIHRhYmxlIHNpemVzIG9rXG4iKSk7CgkgICAgICBzdGF0ZS5oYXZlID0gMDsKCSAgICAgIHN0YXRlLm1vZGUgPSBMRU5MRU5TOwoJICAgICAgLyogZmFsbHMgdGhyb3VnaCAqLwoJICAgIGNhc2UgTEVOTEVOUzoKCSAgICAgIHdoaWxlIChzdGF0ZS5oYXZlIDwgc3RhdGUubmNvZGUpIHsKCSAgICAgICAgLy89PT0gTkVFREJJVFMoMyk7CgkgICAgICAgIHdoaWxlIChiaXRzIDwgMykgewoJICAgICAgICAgIGlmIChoYXZlID09PSAwKSB7IGJyZWFrIGluZl9sZWF2ZTsgfQoJICAgICAgICAgIGhhdmUtLTsKCSAgICAgICAgICBob2xkICs9IGlucHV0W25leHQrK10gPDwgYml0czsKCSAgICAgICAgICBiaXRzICs9IDg7CgkgICAgICAgIH0KCSAgICAgICAgLy89PT0vLwoJICAgICAgICBzdGF0ZS5sZW5zW29yZGVyW3N0YXRlLmhhdmUrK11dID0gKGhvbGQgJiAweDA3KTsvL0JJVFMoMyk7CgkgICAgICAgIC8vLS0tIERST1BCSVRTKDMpIC0tLS8vCgkgICAgICAgIGhvbGQgPj4+PSAzOwoJICAgICAgICBiaXRzIC09IDM7CgkgICAgICAgIC8vLS0tLy8KCSAgICAgIH0KCSAgICAgIHdoaWxlIChzdGF0ZS5oYXZlIDwgMTkpIHsKCSAgICAgICAgc3RhdGUubGVuc1tvcmRlcltzdGF0ZS5oYXZlKytdXSA9IDA7CgkgICAgICB9CgkgICAgICAvLyBXZSBoYXZlIHNlcGFyYXRlIHRhYmxlcyAmIG5vIHBvaW50ZXJzLiAyIGNvbW1lbnRlZCBsaW5lcyBiZWxvdyBub3QgbmVlZGVkLgoJICAgICAgLy9zdGF0ZS5uZXh0ID0gc3RhdGUuY29kZXM7CgkgICAgICAvL3N0YXRlLmxlbmNvZGUgPSBzdGF0ZS5uZXh0OwoJICAgICAgLy8gU3dpdGNoIHRvIHVzZSBkeW5hbWljIHRhYmxlCgkgICAgICBzdGF0ZS5sZW5jb2RlID0gc3RhdGUubGVuZHluOwoJICAgICAgc3RhdGUubGVuYml0cyA9IDc7CgoJICAgICAgb3B0cyA9IHsgYml0czogc3RhdGUubGVuYml0cyB9OwoJICAgICAgcmV0ID0gaW5mbGF0ZV90YWJsZShDT0RFUywgc3RhdGUubGVucywgMCwgMTksIHN0YXRlLmxlbmNvZGUsIDAsIHN0YXRlLndvcmssIG9wdHMpOwoJICAgICAgc3RhdGUubGVuYml0cyA9IG9wdHMuYml0czsKCgkgICAgICBpZiAocmV0KSB7CgkgICAgICAgIHN0cm0ubXNnID0gJ2ludmFsaWQgY29kZSBsZW5ndGhzIHNldCc7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgICAgLy9UcmFjZXYoKHN0ZGVyciwgImluZmxhdGU6ICAgICAgIGNvZGUgbGVuZ3RocyBva1xuIikpOwoJICAgICAgc3RhdGUuaGF2ZSA9IDA7CgkgICAgICBzdGF0ZS5tb2RlID0gQ09ERUxFTlM7CgkgICAgICAvKiBmYWxscyB0aHJvdWdoICovCgkgICAgY2FzZSBDT0RFTEVOUzoKCSAgICAgIHdoaWxlIChzdGF0ZS5oYXZlIDwgc3RhdGUubmxlbiArIHN0YXRlLm5kaXN0KSB7CgkgICAgICAgIGZvciAoOzspIHsKCSAgICAgICAgICBoZXJlID0gc3RhdGUubGVuY29kZVtob2xkICYgKCgxIDw8IHN0YXRlLmxlbmJpdHMpIC0gMSldOy8qQklUUyhzdGF0ZS5sZW5iaXRzKSovCgkgICAgICAgICAgaGVyZV9iaXRzID0gaGVyZSA+Pj4gMjQ7CgkgICAgICAgICAgaGVyZV9vcCA9IChoZXJlID4+PiAxNikgJiAweGZmOwoJICAgICAgICAgIGhlcmVfdmFsID0gaGVyZSAmIDB4ZmZmZjsKCgkgICAgICAgICAgaWYgKChoZXJlX2JpdHMpIDw9IGJpdHMpIHsgYnJlYWs7IH0KCSAgICAgICAgICAvLy0tLSBQVUxMQllURSgpIC0tLS8vCgkgICAgICAgICAgaWYgKGhhdmUgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgICAgaGF2ZS0tOwoJICAgICAgICAgIGhvbGQgKz0gaW5wdXRbbmV4dCsrXSA8PCBiaXRzOwoJICAgICAgICAgIGJpdHMgKz0gODsKCSAgICAgICAgICAvLy0tLS8vCgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlcmVfdmFsIDwgMTYpIHsKCSAgICAgICAgICAvLy0tLSBEUk9QQklUUyhoZXJlLmJpdHMpIC0tLS8vCgkgICAgICAgICAgaG9sZCA+Pj49IGhlcmVfYml0czsKCSAgICAgICAgICBiaXRzIC09IGhlcmVfYml0czsKCSAgICAgICAgICAvLy0tLS8vCgkgICAgICAgICAgc3RhdGUubGVuc1tzdGF0ZS5oYXZlKytdID0gaGVyZV92YWw7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgaWYgKGhlcmVfdmFsID09PSAxNikgewoJICAgICAgICAgICAgLy89PT0gTkVFREJJVFMoaGVyZS5iaXRzICsgMik7CgkgICAgICAgICAgICBuID0gaGVyZV9iaXRzICsgMjsKCSAgICAgICAgICAgIHdoaWxlIChiaXRzIDwgbikgewoJICAgICAgICAgICAgICBpZiAoaGF2ZSA9PT0gMCkgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgICAgICAgICAgaGF2ZS0tOwoJICAgICAgICAgICAgICBob2xkICs9IGlucHV0W25leHQrK10gPDwgYml0czsKCSAgICAgICAgICAgICAgYml0cyArPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy89PT0vLwoJICAgICAgICAgICAgLy8tLS0gRFJPUEJJVFMoaGVyZS5iaXRzKSAtLS0vLwoJICAgICAgICAgICAgaG9sZCA+Pj49IGhlcmVfYml0czsKCSAgICAgICAgICAgIGJpdHMgLT0gaGVyZV9iaXRzOwoJICAgICAgICAgICAgLy8tLS0vLwoJICAgICAgICAgICAgaWYgKHN0YXRlLmhhdmUgPT09IDApIHsKCSAgICAgICAgICAgICAgc3RybS5tc2cgPSAnaW52YWxpZCBiaXQgbGVuZ3RoIHJlcGVhdCc7CgkgICAgICAgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbGVuID0gc3RhdGUubGVuc1tzdGF0ZS5oYXZlIC0gMV07CgkgICAgICAgICAgICBjb3B5ID0gMyArIChob2xkICYgMHgwMyk7Ly9CSVRTKDIpOwoJICAgICAgICAgICAgLy8tLS0gRFJPUEJJVFMoMikgLS0tLy8KCSAgICAgICAgICAgIGhvbGQgPj4+PSAyOwoJICAgICAgICAgICAgYml0cyAtPSAyOwoJICAgICAgICAgICAgLy8tLS0vLwoJICAgICAgICAgIH0KCSAgICAgICAgICBlbHNlIGlmIChoZXJlX3ZhbCA9PT0gMTcpIHsKCSAgICAgICAgICAgIC8vPT09IE5FRURCSVRTKGhlcmUuYml0cyArIDMpOwoJICAgICAgICAgICAgbiA9IGhlcmVfYml0cyArIDM7CgkgICAgICAgICAgICB3aGlsZSAoYml0cyA8IG4pIHsKCSAgICAgICAgICAgICAgaWYgKGhhdmUgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgICAgICAgIGhhdmUtLTsKCSAgICAgICAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgICAgICAgIGJpdHMgKz0gODsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vPT09Ly8KCSAgICAgICAgICAgIC8vLS0tIERST1BCSVRTKGhlcmUuYml0cykgLS0tLy8KCSAgICAgICAgICAgIGhvbGQgPj4+PSBoZXJlX2JpdHM7CgkgICAgICAgICAgICBiaXRzIC09IGhlcmVfYml0czsKCSAgICAgICAgICAgIC8vLS0tLy8KCSAgICAgICAgICAgIGxlbiA9IDA7CgkgICAgICAgICAgICBjb3B5ID0gMyArIChob2xkICYgMHgwNyk7Ly9CSVRTKDMpOwoJICAgICAgICAgICAgLy8tLS0gRFJPUEJJVFMoMykgLS0tLy8KCSAgICAgICAgICAgIGhvbGQgPj4+PSAzOwoJICAgICAgICAgICAgYml0cyAtPSAzOwoJICAgICAgICAgICAgLy8tLS0vLwoJICAgICAgICAgIH0KCSAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIC8vPT09IE5FRURCSVRTKGhlcmUuYml0cyArIDcpOwoJICAgICAgICAgICAgbiA9IGhlcmVfYml0cyArIDc7CgkgICAgICAgICAgICB3aGlsZSAoYml0cyA8IG4pIHsKCSAgICAgICAgICAgICAgaWYgKGhhdmUgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgICAgICAgIGhhdmUtLTsKCSAgICAgICAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgICAgICAgIGJpdHMgKz0gODsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vPT09Ly8KCSAgICAgICAgICAgIC8vLS0tIERST1BCSVRTKGhlcmUuYml0cykgLS0tLy8KCSAgICAgICAgICAgIGhvbGQgPj4+PSBoZXJlX2JpdHM7CgkgICAgICAgICAgICBiaXRzIC09IGhlcmVfYml0czsKCSAgICAgICAgICAgIC8vLS0tLy8KCSAgICAgICAgICAgIGxlbiA9IDA7CgkgICAgICAgICAgICBjb3B5ID0gMTEgKyAoaG9sZCAmIDB4N2YpOy8vQklUUyg3KTsKCSAgICAgICAgICAgIC8vLS0tIERST1BCSVRTKDcpIC0tLS8vCgkgICAgICAgICAgICBob2xkID4+Pj0gNzsKCSAgICAgICAgICAgIGJpdHMgLT0gNzsKCSAgICAgICAgICAgIC8vLS0tLy8KCSAgICAgICAgICB9CgkgICAgICAgICAgaWYgKHN0YXRlLmhhdmUgKyBjb3B5ID4gc3RhdGUubmxlbiArIHN0YXRlLm5kaXN0KSB7CgkgICAgICAgICAgICBzdHJtLm1zZyA9ICdpbnZhbGlkIGJpdCBsZW5ndGggcmVwZWF0JzsKCSAgICAgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICB9CgkgICAgICAgICAgd2hpbGUgKGNvcHktLSkgewoJICAgICAgICAgICAgc3RhdGUubGVuc1tzdGF0ZS5oYXZlKytdID0gbGVuOwoJICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgfQoKCSAgICAgIC8qIGhhbmRsZSBlcnJvciBicmVha3MgaW4gd2hpbGUgKi8KCSAgICAgIGlmIChzdGF0ZS5tb2RlID09PSBCQUQpIHsgYnJlYWs7IH0KCgkgICAgICAvKiBjaGVjayBmb3IgZW5kLW9mLWJsb2NrIGNvZGUgKGJldHRlciBoYXZlIG9uZSkgKi8KCSAgICAgIGlmIChzdGF0ZS5sZW5zWzI1Nl0gPT09IDApIHsKCSAgICAgICAgc3RybS5tc2cgPSAnaW52YWxpZCBjb2RlIC0tIG1pc3NpbmcgZW5kLW9mLWJsb2NrJzsKCSAgICAgICAgc3RhdGUubW9kZSA9IEJBRDsKCSAgICAgICAgYnJlYWs7CgkgICAgICB9CgoJICAgICAgLyogYnVpbGQgY29kZSB0YWJsZXMgLS0gbm90ZTogZG8gbm90IGNoYW5nZSB0aGUgbGVuYml0cyBvciBkaXN0Yml0cwoJICAgICAgICAgdmFsdWVzIGhlcmUgKDkgYW5kIDYpIHdpdGhvdXQgcmVhZGluZyB0aGUgY29tbWVudHMgaW4gaW5mdHJlZXMuaAoJICAgICAgICAgY29uY2VybmluZyB0aGUgRU5PVUdIIGNvbnN0YW50cywgd2hpY2ggZGVwZW5kIG9uIHRob3NlIHZhbHVlcyAqLwoJICAgICAgc3RhdGUubGVuYml0cyA9IDk7CgoJICAgICAgb3B0cyA9IHsgYml0czogc3RhdGUubGVuYml0cyB9OwoJICAgICAgcmV0ID0gaW5mbGF0ZV90YWJsZShMRU5TLCBzdGF0ZS5sZW5zLCAwLCBzdGF0ZS5ubGVuLCBzdGF0ZS5sZW5jb2RlLCAwLCBzdGF0ZS53b3JrLCBvcHRzKTsKCSAgICAgIC8vIFdlIGhhdmUgc2VwYXJhdGUgdGFibGVzICYgbm8gcG9pbnRlcnMuIDIgY29tbWVudGVkIGxpbmVzIGJlbG93IG5vdCBuZWVkZWQuCgkgICAgICAvLyBzdGF0ZS5uZXh0X2luZGV4ID0gb3B0cy50YWJsZV9pbmRleDsKCSAgICAgIHN0YXRlLmxlbmJpdHMgPSBvcHRzLmJpdHM7CgkgICAgICAvLyBzdGF0ZS5sZW5jb2RlID0gc3RhdGUubmV4dDsKCgkgICAgICBpZiAocmV0KSB7CgkgICAgICAgIHN0cm0ubXNnID0gJ2ludmFsaWQgbGl0ZXJhbC9sZW5ndGhzIHNldCc7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoKCSAgICAgIHN0YXRlLmRpc3RiaXRzID0gNjsKCSAgICAgIC8vc3RhdGUuZGlzdGNvZGUuY29weShzdGF0ZS5jb2Rlcyk7CgkgICAgICAvLyBTd2l0Y2ggdG8gdXNlIGR5bmFtaWMgdGFibGUKCSAgICAgIHN0YXRlLmRpc3Rjb2RlID0gc3RhdGUuZGlzdGR5bjsKCSAgICAgIG9wdHMgPSB7IGJpdHM6IHN0YXRlLmRpc3RiaXRzIH07CgkgICAgICByZXQgPSBpbmZsYXRlX3RhYmxlKERJU1RTLCBzdGF0ZS5sZW5zLCBzdGF0ZS5ubGVuLCBzdGF0ZS5uZGlzdCwgc3RhdGUuZGlzdGNvZGUsIDAsIHN0YXRlLndvcmssIG9wdHMpOwoJICAgICAgLy8gV2UgaGF2ZSBzZXBhcmF0ZSB0YWJsZXMgJiBubyBwb2ludGVycy4gMiBjb21tZW50ZWQgbGluZXMgYmVsb3cgbm90IG5lZWRlZC4KCSAgICAgIC8vIHN0YXRlLm5leHRfaW5kZXggPSBvcHRzLnRhYmxlX2luZGV4OwoJICAgICAgc3RhdGUuZGlzdGJpdHMgPSBvcHRzLmJpdHM7CgkgICAgICAvLyBzdGF0ZS5kaXN0Y29kZSA9IHN0YXRlLm5leHQ7CgoJICAgICAgaWYgKHJldCkgewoJICAgICAgICBzdHJtLm1zZyA9ICdpbnZhbGlkIGRpc3RhbmNlcyBzZXQnOwoJICAgICAgICBzdGF0ZS5tb2RlID0gQkFEOwoJICAgICAgICBicmVhazsKCSAgICAgIH0KCSAgICAgIC8vVHJhY2V2KChzdGRlcnIsICdpbmZsYXRlOiAgICAgICBjb2RlcyBva1xuJykpOwoJICAgICAgc3RhdGUubW9kZSA9IExFTl87CgkgICAgICBpZiAoZmx1c2ggPT09IFpfVFJFRVMpIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAvKiBmYWxscyB0aHJvdWdoICovCgkgICAgY2FzZSBMRU5fOgoJICAgICAgc3RhdGUubW9kZSA9IExFTjsKCSAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi8KCSAgICBjYXNlIExFTjoKCSAgICAgIGlmIChoYXZlID49IDYgJiYgbGVmdCA+PSAyNTgpIHsKCSAgICAgICAgLy8tLS0gUkVTVE9SRSgpIC0tLQoJICAgICAgICBzdHJtLm5leHRfb3V0ID0gcHV0OwoJICAgICAgICBzdHJtLmF2YWlsX291dCA9IGxlZnQ7CgkgICAgICAgIHN0cm0ubmV4dF9pbiA9IG5leHQ7CgkgICAgICAgIHN0cm0uYXZhaWxfaW4gPSBoYXZlOwoJICAgICAgICBzdGF0ZS5ob2xkID0gaG9sZDsKCSAgICAgICAgc3RhdGUuYml0cyA9IGJpdHM7CgkgICAgICAgIC8vLS0tCgkgICAgICAgIGluZmxhdGVfZmFzdChzdHJtLCBfb3V0KTsKCSAgICAgICAgLy8tLS0gTE9BRCgpIC0tLQoJICAgICAgICBwdXQgPSBzdHJtLm5leHRfb3V0OwoJICAgICAgICBvdXRwdXQgPSBzdHJtLm91dHB1dDsKCSAgICAgICAgbGVmdCA9IHN0cm0uYXZhaWxfb3V0OwoJICAgICAgICBuZXh0ID0gc3RybS5uZXh0X2luOwoJICAgICAgICBpbnB1dCA9IHN0cm0uaW5wdXQ7CgkgICAgICAgIGhhdmUgPSBzdHJtLmF2YWlsX2luOwoJICAgICAgICBob2xkID0gc3RhdGUuaG9sZDsKCSAgICAgICAgYml0cyA9IHN0YXRlLmJpdHM7CgkgICAgICAgIC8vLS0tCgoJICAgICAgICBpZiAoc3RhdGUubW9kZSA9PT0gVFlQRSkgewoJICAgICAgICAgIHN0YXRlLmJhY2sgPSAtMTsKCSAgICAgICAgfQoJICAgICAgICBicmVhazsKCSAgICAgIH0KCSAgICAgIHN0YXRlLmJhY2sgPSAwOwoJICAgICAgZm9yICg7OykgewoJICAgICAgICBoZXJlID0gc3RhdGUubGVuY29kZVtob2xkICYgKCgxIDw8IHN0YXRlLmxlbmJpdHMpIC0gMSldOyAgLypCSVRTKHN0YXRlLmxlbmJpdHMpKi8KCSAgICAgICAgaGVyZV9iaXRzID0gaGVyZSA+Pj4gMjQ7CgkgICAgICAgIGhlcmVfb3AgPSAoaGVyZSA+Pj4gMTYpICYgMHhmZjsKCSAgICAgICAgaGVyZV92YWwgPSBoZXJlICYgMHhmZmZmOwoKCSAgICAgICAgaWYgKGhlcmVfYml0cyA8PSBiaXRzKSB7IGJyZWFrOyB9CgkgICAgICAgIC8vLS0tIFBVTExCWVRFKCkgLS0tLy8KCSAgICAgICAgaWYgKGhhdmUgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgIGhhdmUtLTsKCSAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgIGJpdHMgKz0gODsKCSAgICAgICAgLy8tLS0vLwoJICAgICAgfQoJICAgICAgaWYgKGhlcmVfb3AgJiYgKGhlcmVfb3AgJiAweGYwKSA9PT0gMCkgewoJICAgICAgICBsYXN0X2JpdHMgPSBoZXJlX2JpdHM7CgkgICAgICAgIGxhc3Rfb3AgPSBoZXJlX29wOwoJICAgICAgICBsYXN0X3ZhbCA9IGhlcmVfdmFsOwoJICAgICAgICBmb3IgKDs7KSB7CgkgICAgICAgICAgaGVyZSA9IHN0YXRlLmxlbmNvZGVbbGFzdF92YWwgKwoJICAgICAgICAgICAgICAgICAgKChob2xkICYgKCgxIDw8IChsYXN0X2JpdHMgKyBsYXN0X29wKSkgLSAxKSkvKkJJVFMobGFzdC5iaXRzICsgbGFzdC5vcCkqLyA+PiBsYXN0X2JpdHMpXTsKCSAgICAgICAgICBoZXJlX2JpdHMgPSBoZXJlID4+PiAyNDsKCSAgICAgICAgICBoZXJlX29wID0gKGhlcmUgPj4+IDE2KSAmIDB4ZmY7CgkgICAgICAgICAgaGVyZV92YWwgPSBoZXJlICYgMHhmZmZmOwoKCSAgICAgICAgICBpZiAoKGxhc3RfYml0cyArIGhlcmVfYml0cykgPD0gYml0cykgeyBicmVhazsgfQoJICAgICAgICAgIC8vLS0tIFBVTExCWVRFKCkgLS0tLy8KCSAgICAgICAgICBpZiAoaGF2ZSA9PT0gMCkgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgICAgICBoYXZlLS07CgkgICAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgICAgYml0cyArPSA4OwoJICAgICAgICAgIC8vLS0tLy8KCSAgICAgICAgfQoJICAgICAgICAvLy0tLSBEUk9QQklUUyhsYXN0LmJpdHMpIC0tLS8vCgkgICAgICAgIGhvbGQgPj4+PSBsYXN0X2JpdHM7CgkgICAgICAgIGJpdHMgLT0gbGFzdF9iaXRzOwoJICAgICAgICAvLy0tLS8vCgkgICAgICAgIHN0YXRlLmJhY2sgKz0gbGFzdF9iaXRzOwoJICAgICAgfQoJICAgICAgLy8tLS0gRFJPUEJJVFMoaGVyZS5iaXRzKSAtLS0vLwoJICAgICAgaG9sZCA+Pj49IGhlcmVfYml0czsKCSAgICAgIGJpdHMgLT0gaGVyZV9iaXRzOwoJICAgICAgLy8tLS0vLwoJICAgICAgc3RhdGUuYmFjayArPSBoZXJlX2JpdHM7CgkgICAgICBzdGF0ZS5sZW5ndGggPSBoZXJlX3ZhbDsKCSAgICAgIGlmIChoZXJlX29wID09PSAwKSB7CgkgICAgICAgIC8vVHJhY2V2digoc3RkZXJyLCBoZXJlLnZhbCA+PSAweDIwICYmIGhlcmUudmFsIDwgMHg3ZiA/CgkgICAgICAgIC8vICAgICAgICAiaW5mbGF0ZTogICAgICAgICBsaXRlcmFsICclYydcbiIgOgoJICAgICAgICAvLyAgICAgICAgImluZmxhdGU6ICAgICAgICAgbGl0ZXJhbCAweCUwMnhcbiIsIGhlcmUudmFsKSk7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBMSVQ7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgICAgaWYgKGhlcmVfb3AgJiAzMikgewoJICAgICAgICAvL1RyYWNldnYoKHN0ZGVyciwgImluZmxhdGU6ICAgICAgICAgZW5kIG9mIGJsb2NrXG4iKSk7CgkgICAgICAgIHN0YXRlLmJhY2sgPSAtMTsKCSAgICAgICAgc3RhdGUubW9kZSA9IFRZUEU7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgICAgaWYgKGhlcmVfb3AgJiA2NCkgewoJICAgICAgICBzdHJtLm1zZyA9ICdpbnZhbGlkIGxpdGVyYWwvbGVuZ3RoIGNvZGUnOwoJICAgICAgICBzdGF0ZS5tb2RlID0gQkFEOwoJICAgICAgICBicmVhazsKCSAgICAgIH0KCSAgICAgIHN0YXRlLmV4dHJhID0gaGVyZV9vcCAmIDE1OwoJICAgICAgc3RhdGUubW9kZSA9IExFTkVYVDsKCSAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi8KCSAgICBjYXNlIExFTkVYVDoKCSAgICAgIGlmIChzdGF0ZS5leHRyYSkgewoJICAgICAgICAvLz09PSBORUVEQklUUyhzdGF0ZS5leHRyYSk7CgkgICAgICAgIG4gPSBzdGF0ZS5leHRyYTsKCSAgICAgICAgd2hpbGUgKGJpdHMgPCBuKSB7CgkgICAgICAgICAgaWYgKGhhdmUgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgICAgaGF2ZS0tOwoJICAgICAgICAgIGhvbGQgKz0gaW5wdXRbbmV4dCsrXSA8PCBiaXRzOwoJICAgICAgICAgIGJpdHMgKz0gODsKCSAgICAgICAgfQoJICAgICAgICAvLz09PS8vCgkgICAgICAgIHN0YXRlLmxlbmd0aCArPSBob2xkICYgKCgxIDw8IHN0YXRlLmV4dHJhKSAtIDEpLypCSVRTKHN0YXRlLmV4dHJhKSovOwoJICAgICAgICAvLy0tLSBEUk9QQklUUyhzdGF0ZS5leHRyYSkgLS0tLy8KCSAgICAgICAgaG9sZCA+Pj49IHN0YXRlLmV4dHJhOwoJICAgICAgICBiaXRzIC09IHN0YXRlLmV4dHJhOwoJICAgICAgICAvLy0tLS8vCgkgICAgICAgIHN0YXRlLmJhY2sgKz0gc3RhdGUuZXh0cmE7CgkgICAgICB9CgkgICAgICAvL1RyYWNldnYoKHN0ZGVyciwgImluZmxhdGU6ICAgICAgICAgbGVuZ3RoICV1XG4iLCBzdGF0ZS5sZW5ndGgpKTsKCSAgICAgIHN0YXRlLndhcyA9IHN0YXRlLmxlbmd0aDsKCSAgICAgIHN0YXRlLm1vZGUgPSBESVNUOwoJICAgICAgLyogZmFsbHMgdGhyb3VnaCAqLwoJICAgIGNhc2UgRElTVDoKCSAgICAgIGZvciAoOzspIHsKCSAgICAgICAgaGVyZSA9IHN0YXRlLmRpc3Rjb2RlW2hvbGQgJiAoKDEgPDwgc3RhdGUuZGlzdGJpdHMpIC0gMSldOy8qQklUUyhzdGF0ZS5kaXN0Yml0cykqLwoJICAgICAgICBoZXJlX2JpdHMgPSBoZXJlID4+PiAyNDsKCSAgICAgICAgaGVyZV9vcCA9IChoZXJlID4+PiAxNikgJiAweGZmOwoJICAgICAgICBoZXJlX3ZhbCA9IGhlcmUgJiAweGZmZmY7CgoJICAgICAgICBpZiAoKGhlcmVfYml0cykgPD0gYml0cykgeyBicmVhazsgfQoJICAgICAgICAvLy0tLSBQVUxMQllURSgpIC0tLS8vCgkgICAgICAgIGlmIChoYXZlID09PSAwKSB7IGJyZWFrIGluZl9sZWF2ZTsgfQoJICAgICAgICBoYXZlLS07CgkgICAgICAgIGhvbGQgKz0gaW5wdXRbbmV4dCsrXSA8PCBiaXRzOwoJICAgICAgICBiaXRzICs9IDg7CgkgICAgICAgIC8vLS0tLy8KCSAgICAgIH0KCSAgICAgIGlmICgoaGVyZV9vcCAmIDB4ZjApID09PSAwKSB7CgkgICAgICAgIGxhc3RfYml0cyA9IGhlcmVfYml0czsKCSAgICAgICAgbGFzdF9vcCA9IGhlcmVfb3A7CgkgICAgICAgIGxhc3RfdmFsID0gaGVyZV92YWw7CgkgICAgICAgIGZvciAoOzspIHsKCSAgICAgICAgICBoZXJlID0gc3RhdGUuZGlzdGNvZGVbbGFzdF92YWwgKwoJICAgICAgICAgICAgICAgICAgKChob2xkICYgKCgxIDw8IChsYXN0X2JpdHMgKyBsYXN0X29wKSkgLSAxKSkvKkJJVFMobGFzdC5iaXRzICsgbGFzdC5vcCkqLyA+PiBsYXN0X2JpdHMpXTsKCSAgICAgICAgICBoZXJlX2JpdHMgPSBoZXJlID4+PiAyNDsKCSAgICAgICAgICBoZXJlX29wID0gKGhlcmUgPj4+IDE2KSAmIDB4ZmY7CgkgICAgICAgICAgaGVyZV92YWwgPSBoZXJlICYgMHhmZmZmOwoKCSAgICAgICAgICBpZiAoKGxhc3RfYml0cyArIGhlcmVfYml0cykgPD0gYml0cykgeyBicmVhazsgfQoJICAgICAgICAgIC8vLS0tIFBVTExCWVRFKCkgLS0tLy8KCSAgICAgICAgICBpZiAoaGF2ZSA9PT0gMCkgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgICAgICBoYXZlLS07CgkgICAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgICAgYml0cyArPSA4OwoJICAgICAgICAgIC8vLS0tLy8KCSAgICAgICAgfQoJICAgICAgICAvLy0tLSBEUk9QQklUUyhsYXN0LmJpdHMpIC0tLS8vCgkgICAgICAgIGhvbGQgPj4+PSBsYXN0X2JpdHM7CgkgICAgICAgIGJpdHMgLT0gbGFzdF9iaXRzOwoJICAgICAgICAvLy0tLS8vCgkgICAgICAgIHN0YXRlLmJhY2sgKz0gbGFzdF9iaXRzOwoJICAgICAgfQoJICAgICAgLy8tLS0gRFJPUEJJVFMoaGVyZS5iaXRzKSAtLS0vLwoJICAgICAgaG9sZCA+Pj49IGhlcmVfYml0czsKCSAgICAgIGJpdHMgLT0gaGVyZV9iaXRzOwoJICAgICAgLy8tLS0vLwoJICAgICAgc3RhdGUuYmFjayArPSBoZXJlX2JpdHM7CgkgICAgICBpZiAoaGVyZV9vcCAmIDY0KSB7CgkgICAgICAgIHN0cm0ubXNnID0gJ2ludmFsaWQgZGlzdGFuY2UgY29kZSc7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgICAgc3RhdGUub2Zmc2V0ID0gaGVyZV92YWw7CgkgICAgICBzdGF0ZS5leHRyYSA9IChoZXJlX29wKSAmIDE1OwoJICAgICAgc3RhdGUubW9kZSA9IERJU1RFWFQ7CgkgICAgICAvKiBmYWxscyB0aHJvdWdoICovCgkgICAgY2FzZSBESVNURVhUOgoJICAgICAgaWYgKHN0YXRlLmV4dHJhKSB7CgkgICAgICAgIC8vPT09IE5FRURCSVRTKHN0YXRlLmV4dHJhKTsKCSAgICAgICAgbiA9IHN0YXRlLmV4dHJhOwoJICAgICAgICB3aGlsZSAoYml0cyA8IG4pIHsKCSAgICAgICAgICBpZiAoaGF2ZSA9PT0gMCkgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgICAgICBoYXZlLS07CgkgICAgICAgICAgaG9sZCArPSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgICAgYml0cyArPSA4OwoJICAgICAgICB9CgkgICAgICAgIC8vPT09Ly8KCSAgICAgICAgc3RhdGUub2Zmc2V0ICs9IGhvbGQgJiAoKDEgPDwgc3RhdGUuZXh0cmEpIC0gMSkvKkJJVFMoc3RhdGUuZXh0cmEpKi87CgkgICAgICAgIC8vLS0tIERST1BCSVRTKHN0YXRlLmV4dHJhKSAtLS0vLwoJICAgICAgICBob2xkID4+Pj0gc3RhdGUuZXh0cmE7CgkgICAgICAgIGJpdHMgLT0gc3RhdGUuZXh0cmE7CgkgICAgICAgIC8vLS0tLy8KCSAgICAgICAgc3RhdGUuYmFjayArPSBzdGF0ZS5leHRyYTsKCSAgICAgIH0KCS8vI2lmZGVmIElORkxBVEVfU1RSSUNUCgkgICAgICBpZiAoc3RhdGUub2Zmc2V0ID4gc3RhdGUuZG1heCkgewoJICAgICAgICBzdHJtLm1zZyA9ICdpbnZhbGlkIGRpc3RhbmNlIHRvbyBmYXIgYmFjayc7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJLy8jZW5kaWYKCSAgICAgIC8vVHJhY2V2digoc3RkZXJyLCAiaW5mbGF0ZTogICAgICAgICBkaXN0YW5jZSAldVxuIiwgc3RhdGUub2Zmc2V0KSk7CgkgICAgICBzdGF0ZS5tb2RlID0gTUFUQ0g7CgkgICAgICAvKiBmYWxscyB0aHJvdWdoICovCgkgICAgY2FzZSBNQVRDSDoKCSAgICAgIGlmIChsZWZ0ID09PSAwKSB7IGJyZWFrIGluZl9sZWF2ZTsgfQoJICAgICAgY29weSA9IF9vdXQgLSBsZWZ0OwoJICAgICAgaWYgKHN0YXRlLm9mZnNldCA+IGNvcHkpIHsgICAgICAgICAvKiBjb3B5IGZyb20gd2luZG93ICovCgkgICAgICAgIGNvcHkgPSBzdGF0ZS5vZmZzZXQgLSBjb3B5OwoJICAgICAgICBpZiAoY29weSA+IHN0YXRlLndoYXZlKSB7CgkgICAgICAgICAgaWYgKHN0YXRlLnNhbmUpIHsKCSAgICAgICAgICAgIHN0cm0ubXNnID0gJ2ludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrJzsKCSAgICAgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICB9CgkvLyAoISkgVGhpcyBibG9jayBpcyBkaXNhYmxlZCBpbiB6bGliIGRlZmFpbHRzLAoJLy8gZG9uJ3QgZW5hYmxlIGl0IGZvciBiaW5hcnkgY29tcGF0aWJpbGl0eQoJLy8jaWZkZWYgSU5GTEFURV9BTExPV19JTlZBTElEX0RJU1RBTkNFX1RPT0ZBUl9BUlJSCgkvLyAgICAgICAgICBUcmFjZSgoc3RkZXJyLCAiaW5mbGF0ZS5jIHRvbyBmYXJcbiIpKTsKCS8vICAgICAgICAgIGNvcHkgLT0gc3RhdGUud2hhdmU7CgkvLyAgICAgICAgICBpZiAoY29weSA+IHN0YXRlLmxlbmd0aCkgeyBjb3B5ID0gc3RhdGUubGVuZ3RoOyB9CgkvLyAgICAgICAgICBpZiAoY29weSA+IGxlZnQpIHsgY29weSA9IGxlZnQ7IH0KCS8vICAgICAgICAgIGxlZnQgLT0gY29weTsKCS8vICAgICAgICAgIHN0YXRlLmxlbmd0aCAtPSBjb3B5OwoJLy8gICAgICAgICAgZG8gewoJLy8gICAgICAgICAgICBvdXRwdXRbcHV0KytdID0gMDsKCS8vICAgICAgICAgIH0gd2hpbGUgKC0tY29weSk7CgkvLyAgICAgICAgICBpZiAoc3RhdGUubGVuZ3RoID09PSAwKSB7IHN0YXRlLm1vZGUgPSBMRU47IH0KCS8vICAgICAgICAgIGJyZWFrOwoJLy8jZW5kaWYKCSAgICAgICAgfQoJICAgICAgICBpZiAoY29weSA+IHN0YXRlLnduZXh0KSB7CgkgICAgICAgICAgY29weSAtPSBzdGF0ZS53bmV4dDsKCSAgICAgICAgICBmcm9tID0gc3RhdGUud3NpemUgLSBjb3B5OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgIGZyb20gPSBzdGF0ZS53bmV4dCAtIGNvcHk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvcHkgPiBzdGF0ZS5sZW5ndGgpIHsgY29weSA9IHN0YXRlLmxlbmd0aDsgfQoJICAgICAgICBmcm9tX3NvdXJjZSA9IHN0YXRlLndpbmRvdzsKCSAgICAgIH0KCSAgICAgIGVsc2UgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGNvcHkgZnJvbSBvdXRwdXQgKi8KCSAgICAgICAgZnJvbV9zb3VyY2UgPSBvdXRwdXQ7CgkgICAgICAgIGZyb20gPSBwdXQgLSBzdGF0ZS5vZmZzZXQ7CgkgICAgICAgIGNvcHkgPSBzdGF0ZS5sZW5ndGg7CgkgICAgICB9CgkgICAgICBpZiAoY29weSA+IGxlZnQpIHsgY29weSA9IGxlZnQ7IH0KCSAgICAgIGxlZnQgLT0gY29weTsKCSAgICAgIHN0YXRlLmxlbmd0aCAtPSBjb3B5OwoJICAgICAgZG8gewoJICAgICAgICBvdXRwdXRbcHV0KytdID0gZnJvbV9zb3VyY2VbZnJvbSsrXTsKCSAgICAgIH0gd2hpbGUgKC0tY29weSk7CgkgICAgICBpZiAoc3RhdGUubGVuZ3RoID09PSAwKSB7IHN0YXRlLm1vZGUgPSBMRU47IH0KCSAgICAgIGJyZWFrOwoJICAgIGNhc2UgTElUOgoJICAgICAgaWYgKGxlZnQgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICBvdXRwdXRbcHV0KytdID0gc3RhdGUubGVuZ3RoOwoJICAgICAgbGVmdC0tOwoJICAgICAgc3RhdGUubW9kZSA9IExFTjsKCSAgICAgIGJyZWFrOwoJICAgIGNhc2UgQ0hFQ0s6CgkgICAgICBpZiAoc3RhdGUud3JhcCkgewoJICAgICAgICAvLz09PSBORUVEQklUUygzMik7CgkgICAgICAgIHdoaWxlIChiaXRzIDwgMzIpIHsKCSAgICAgICAgICBpZiAoaGF2ZSA9PT0gMCkgeyBicmVhayBpbmZfbGVhdmU7IH0KCSAgICAgICAgICBoYXZlLS07CgkgICAgICAgICAgLy8gVXNlICd8JyBpbnNkZWFkIG9mICcrJyB0byBtYWtlIHN1cmUgdGhhdCByZXN1bHQgaXMgc2lnbmVkCgkgICAgICAgICAgaG9sZCB8PSBpbnB1dFtuZXh0KytdIDw8IGJpdHM7CgkgICAgICAgICAgYml0cyArPSA4OwoJICAgICAgICB9CgkgICAgICAgIC8vPT09Ly8KCSAgICAgICAgX291dCAtPSBsZWZ0OwoJICAgICAgICBzdHJtLnRvdGFsX291dCArPSBfb3V0OwoJICAgICAgICBzdGF0ZS50b3RhbCArPSBfb3V0OwoJICAgICAgICBpZiAoX291dCkgewoJICAgICAgICAgIHN0cm0uYWRsZXIgPSBzdGF0ZS5jaGVjayA9CgkgICAgICAgICAgICAgIC8qVVBEQVRFKHN0YXRlLmNoZWNrLCBwdXQgLSBfb3V0LCBfb3V0KTsqLwoJICAgICAgICAgICAgICAoc3RhdGUuZmxhZ3MgPyBjcmMzMihzdGF0ZS5jaGVjaywgb3V0cHV0LCBfb3V0LCBwdXQgLSBfb3V0KSA6IGFkbGVyMzIoc3RhdGUuY2hlY2ssIG91dHB1dCwgX291dCwgcHV0IC0gX291dCkpOwoKCSAgICAgICAgfQoJICAgICAgICBfb3V0ID0gbGVmdDsKCSAgICAgICAgLy8gTkI6IGNyYzMyIHN0b3JlZCBhcyBzaWduZWQgMzItYml0IGludCwgenN3YXAzMiByZXR1cm5zIHNpZ25lZCB0b28KCSAgICAgICAgaWYgKChzdGF0ZS5mbGFncyA/IGhvbGQgOiB6c3dhcDMyKGhvbGQpKSAhPT0gc3RhdGUuY2hlY2spIHsKCSAgICAgICAgICBzdHJtLm1zZyA9ICdpbmNvcnJlY3QgZGF0YSBjaGVjayc7CgkgICAgICAgICAgc3RhdGUubW9kZSA9IEJBRDsKCSAgICAgICAgICBicmVhazsKCSAgICAgICAgfQoJICAgICAgICAvLz09PSBJTklUQklUUygpOwoJICAgICAgICBob2xkID0gMDsKCSAgICAgICAgYml0cyA9IDA7CgkgICAgICAgIC8vPT09Ly8KCSAgICAgICAgLy9UcmFjZXYoKHN0ZGVyciwgImluZmxhdGU6ICAgY2hlY2sgbWF0Y2hlcyB0cmFpbGVyXG4iKSk7CgkgICAgICB9CgkgICAgICBzdGF0ZS5tb2RlID0gTEVOR1RIOwoJICAgICAgLyogZmFsbHMgdGhyb3VnaCAqLwoJICAgIGNhc2UgTEVOR1RIOgoJICAgICAgaWYgKHN0YXRlLndyYXAgJiYgc3RhdGUuZmxhZ3MpIHsKCSAgICAgICAgLy89PT0gTkVFREJJVFMoMzIpOwoJICAgICAgICB3aGlsZSAoYml0cyA8IDMyKSB7CgkgICAgICAgICAgaWYgKGhhdmUgPT09IDApIHsgYnJlYWsgaW5mX2xlYXZlOyB9CgkgICAgICAgICAgaGF2ZS0tOwoJICAgICAgICAgIGhvbGQgKz0gaW5wdXRbbmV4dCsrXSA8PCBiaXRzOwoJICAgICAgICAgIGJpdHMgKz0gODsKCSAgICAgICAgfQoJICAgICAgICAvLz09PS8vCgkgICAgICAgIGlmIChob2xkICE9PSAoc3RhdGUudG90YWwgJiAweGZmZmZmZmZmKSkgewoJICAgICAgICAgIHN0cm0ubXNnID0gJ2luY29ycmVjdCBsZW5ndGggY2hlY2snOwoJICAgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgICAgYnJlYWs7CgkgICAgICAgIH0KCSAgICAgICAgLy89PT0gSU5JVEJJVFMoKTsKCSAgICAgICAgaG9sZCA9IDA7CgkgICAgICAgIGJpdHMgPSAwOwoJICAgICAgICAvLz09PS8vCgkgICAgICAgIC8vVHJhY2V2KChzdGRlcnIsICJpbmZsYXRlOiAgIGxlbmd0aCBtYXRjaGVzIHRyYWlsZXJcbiIpKTsKCSAgICAgIH0KCSAgICAgIHN0YXRlLm1vZGUgPSBET05FOwoJICAgICAgLyogZmFsbHMgdGhyb3VnaCAqLwoJICAgIGNhc2UgRE9ORToKCSAgICAgIHJldCA9IFpfU1RSRUFNX0VORDsKCSAgICAgIGJyZWFrIGluZl9sZWF2ZTsKCSAgICBjYXNlIEJBRDoKCSAgICAgIHJldCA9IFpfREFUQV9FUlJPUjsKCSAgICAgIGJyZWFrIGluZl9sZWF2ZTsKCSAgICBjYXNlIE1FTToKCSAgICAgIHJldHVybiBaX01FTV9FUlJPUjsKCSAgICBjYXNlIFNZTkM6CgkgICAgICAvKiBmYWxscyB0aHJvdWdoICovCgkgICAgZGVmYXVsdDoKCSAgICAgIHJldHVybiBaX1NUUkVBTV9FUlJPUjsKCSAgICB9CgkgIH0KCgkgIC8vIGluZl9sZWF2ZSA8LSBoZXJlIGlzIHJlYWwgcGxhY2UgZm9yICJnb3RvIGluZl9sZWF2ZSIsIGVtdWxhdGVkIHZpYSAiYnJlYWsgaW5mX2xlYXZlIgoKCSAgLyoKCSAgICAgUmV0dXJuIGZyb20gaW5mbGF0ZSgpLCB1cGRhdGluZyB0aGUgdG90YWwgY291bnRzIGFuZCB0aGUgY2hlY2sgdmFsdWUuCgkgICAgIElmIHRoZXJlIHdhcyBubyBwcm9ncmVzcyBkdXJpbmcgdGhlIGluZmxhdGUoKSBjYWxsLCByZXR1cm4gYSBidWZmZXIKCSAgICAgZXJyb3IuICBDYWxsIHVwZGF0ZXdpbmRvdygpIHRvIGNyZWF0ZSBhbmQvb3IgdXBkYXRlIHRoZSB3aW5kb3cgc3RhdGUuCgkgICAgIE5vdGU6IGEgbWVtb3J5IGVycm9yIGZyb20gaW5mbGF0ZSgpIGlzIG5vbi1yZWNvdmVyYWJsZS4KCSAgICovCgoJICAvLy0tLSBSRVNUT1JFKCkgLS0tCgkgIHN0cm0ubmV4dF9vdXQgPSBwdXQ7CgkgIHN0cm0uYXZhaWxfb3V0ID0gbGVmdDsKCSAgc3RybS5uZXh0X2luID0gbmV4dDsKCSAgc3RybS5hdmFpbF9pbiA9IGhhdmU7CgkgIHN0YXRlLmhvbGQgPSBob2xkOwoJICBzdGF0ZS5iaXRzID0gYml0czsKCSAgLy8tLS0KCgkgIGlmIChzdGF0ZS53c2l6ZSB8fCAoX291dCAhPT0gc3RybS5hdmFpbF9vdXQgJiYgc3RhdGUubW9kZSA8IEJBRCAmJgoJICAgICAgICAgICAgICAgICAgICAgIChzdGF0ZS5tb2RlIDwgQ0hFQ0sgfHwgZmx1c2ggIT09IFpfRklOSVNIKSkpIHsKCSAgICBpZiAodXBkYXRld2luZG93KHN0cm0sIHN0cm0ub3V0cHV0LCBzdHJtLm5leHRfb3V0LCBfb3V0IC0gc3RybS5hdmFpbF9vdXQpKSB7CgkgICAgICBzdGF0ZS5tb2RlID0gTUVNOwoJICAgICAgcmV0dXJuIFpfTUVNX0VSUk9SOwoJICAgIH0KCSAgfQoJICBfaW4gLT0gc3RybS5hdmFpbF9pbjsKCSAgX291dCAtPSBzdHJtLmF2YWlsX291dDsKCSAgc3RybS50b3RhbF9pbiArPSBfaW47CgkgIHN0cm0udG90YWxfb3V0ICs9IF9vdXQ7CgkgIHN0YXRlLnRvdGFsICs9IF9vdXQ7CgkgIGlmIChzdGF0ZS53cmFwICYmIF9vdXQpIHsKCSAgICBzdHJtLmFkbGVyID0gc3RhdGUuY2hlY2sgPSAvKlVQREFURShzdGF0ZS5jaGVjaywgc3RybS5uZXh0X291dCAtIF9vdXQsIF9vdXQpOyovCgkgICAgICAoc3RhdGUuZmxhZ3MgPyBjcmMzMihzdGF0ZS5jaGVjaywgb3V0cHV0LCBfb3V0LCBzdHJtLm5leHRfb3V0IC0gX291dCkgOiBhZGxlcjMyKHN0YXRlLmNoZWNrLCBvdXRwdXQsIF9vdXQsIHN0cm0ubmV4dF9vdXQgLSBfb3V0KSk7CgkgIH0KCSAgc3RybS5kYXRhX3R5cGUgPSBzdGF0ZS5iaXRzICsgKHN0YXRlLmxhc3QgPyA2NCA6IDApICsKCSAgICAgICAgICAgICAgICAgICAgKHN0YXRlLm1vZGUgPT09IFRZUEUgPyAxMjggOiAwKSArCgkgICAgICAgICAgICAgICAgICAgIChzdGF0ZS5tb2RlID09PSBMRU5fIHx8IHN0YXRlLm1vZGUgPT09IENPUFlfID8gMjU2IDogMCk7CgkgIGlmICgoKF9pbiA9PT0gMCAmJiBfb3V0ID09PSAwKSB8fCBmbHVzaCA9PT0gWl9GSU5JU0gpICYmIHJldCA9PT0gWl9PSykgewoJICAgIHJldCA9IFpfQlVGX0VSUk9SOwoJICB9CgkgIHJldHVybiByZXQ7Cgl9CgoJZnVuY3Rpb24gaW5mbGF0ZUVuZChzdHJtKSB7CgoJICBpZiAoIXN0cm0gfHwgIXN0cm0uc3RhdGUgLyp8fCBzdHJtLT56ZnJlZSA9PSAoZnJlZV9mdW5jKTAqLykgewoJICAgIHJldHVybiBaX1NUUkVBTV9FUlJPUjsKCSAgfQoKCSAgdmFyIHN0YXRlID0gc3RybS5zdGF0ZTsKCSAgaWYgKHN0YXRlLndpbmRvdykgewoJICAgIHN0YXRlLndpbmRvdyA9IG51bGw7CgkgIH0KCSAgc3RybS5zdGF0ZSA9IG51bGw7CgkgIHJldHVybiBaX09LOwoJfQoKCWZ1bmN0aW9uIGluZmxhdGVHZXRIZWFkZXIoc3RybSwgaGVhZCkgewoJICB2YXIgc3RhdGU7CgoJICAvKiBjaGVjayBzdGF0ZSAqLwoJICBpZiAoIXN0cm0gfHwgIXN0cm0uc3RhdGUpIHsgcmV0dXJuIFpfU1RSRUFNX0VSUk9SOyB9CgkgIHN0YXRlID0gc3RybS5zdGF0ZTsKCSAgaWYgKChzdGF0ZS53cmFwICYgMikgPT09IDApIHsgcmV0dXJuIFpfU1RSRUFNX0VSUk9SOyB9CgoJICAvKiBzYXZlIGhlYWRlciBzdHJ1Y3R1cmUgKi8KCSAgc3RhdGUuaGVhZCA9IGhlYWQ7CgkgIGhlYWQuZG9uZSA9IGZhbHNlOwoJICByZXR1cm4gWl9PSzsKCX0KCglmdW5jdGlvbiBpbmZsYXRlU2V0RGljdGlvbmFyeShzdHJtLCBkaWN0aW9uYXJ5KSB7CgkgIHZhciBkaWN0TGVuZ3RoID0gZGljdGlvbmFyeS5sZW5ndGg7CgoJICB2YXIgc3RhdGU7CgkgIHZhciBkaWN0aWQ7CgkgIHZhciByZXQ7CgoJICAvKiBjaGVjayBzdGF0ZSAqLwoJICBpZiAoIXN0cm0gLyogPT0gWl9OVUxMICovIHx8ICFzdHJtLnN0YXRlIC8qID09IFpfTlVMTCAqLykgeyByZXR1cm4gWl9TVFJFQU1fRVJST1I7IH0KCSAgc3RhdGUgPSBzdHJtLnN0YXRlOwoKCSAgaWYgKHN0YXRlLndyYXAgIT09IDAgJiYgc3RhdGUubW9kZSAhPT0gRElDVCkgewoJICAgIHJldHVybiBaX1NUUkVBTV9FUlJPUjsKCSAgfQoKCSAgLyogY2hlY2sgZm9yIGNvcnJlY3QgZGljdGlvbmFyeSBpZGVudGlmaWVyICovCgkgIGlmIChzdGF0ZS5tb2RlID09PSBESUNUKSB7CgkgICAgZGljdGlkID0gMTsgLyogYWRsZXIzMigwLCBudWxsLCAwKSovCgkgICAgLyogZGljdGlkID0gYWRsZXIzMihkaWN0aWQsIGRpY3Rpb25hcnksIGRpY3RMZW5ndGgpOyAqLwoJICAgIGRpY3RpZCA9IGFkbGVyMzIoZGljdGlkLCBkaWN0aW9uYXJ5LCBkaWN0TGVuZ3RoLCAwKTsKCSAgICBpZiAoZGljdGlkICE9PSBzdGF0ZS5jaGVjaykgewoJICAgICAgcmV0dXJuIFpfREFUQV9FUlJPUjsKCSAgICB9CgkgIH0KCSAgLyogY29weSBkaWN0aW9uYXJ5IHRvIHdpbmRvdyB1c2luZyB1cGRhdGV3aW5kb3coKSwgd2hpY2ggd2lsbCBhbWVuZCB0aGUKCSAgIGV4aXN0aW5nIGRpY3Rpb25hcnkgaWYgYXBwcm9wcmlhdGUgKi8KCSAgcmV0ID0gdXBkYXRld2luZG93KHN0cm0sIGRpY3Rpb25hcnksIGRpY3RMZW5ndGgsIGRpY3RMZW5ndGgpOwoJICBpZiAocmV0KSB7CgkgICAgc3RhdGUubW9kZSA9IE1FTTsKCSAgICByZXR1cm4gWl9NRU1fRVJST1I7CgkgIH0KCSAgc3RhdGUuaGF2ZWRpY3QgPSAxOwoJICAvLyBUcmFjZXYoKHN0ZGVyciwgImluZmxhdGU6ICAgZGljdGlvbmFyeSBzZXRcbiIpKTsKCSAgcmV0dXJuIFpfT0s7Cgl9CgoJZXhwb3J0cy5pbmZsYXRlUmVzZXQgPSBpbmZsYXRlUmVzZXQ7CglleHBvcnRzLmluZmxhdGVSZXNldDIgPSBpbmZsYXRlUmVzZXQyOwoJZXhwb3J0cy5pbmZsYXRlUmVzZXRLZWVwID0gaW5mbGF0ZVJlc2V0S2VlcDsKCWV4cG9ydHMuaW5mbGF0ZUluaXQgPSBpbmZsYXRlSW5pdDsKCWV4cG9ydHMuaW5mbGF0ZUluaXQyID0gaW5mbGF0ZUluaXQyOwoJZXhwb3J0cy5pbmZsYXRlID0gaW5mbGF0ZTsKCWV4cG9ydHMuaW5mbGF0ZUVuZCA9IGluZmxhdGVFbmQ7CglleHBvcnRzLmluZmxhdGVHZXRIZWFkZXIgPSBpbmZsYXRlR2V0SGVhZGVyOwoJZXhwb3J0cy5pbmZsYXRlU2V0RGljdGlvbmFyeSA9IGluZmxhdGVTZXREaWN0aW9uYXJ5OwoJZXhwb3J0cy5pbmZsYXRlSW5mbyA9ICdwYWtvIGluZmxhdGUgKGZyb20gTm9kZWNhIHByb2plY3QpJzsKCgkvKiBOb3QgaW1wbGVtZW50ZWQKCWV4cG9ydHMuaW5mbGF0ZUNvcHkgPSBpbmZsYXRlQ29weTsKCWV4cG9ydHMuaW5mbGF0ZUdldERpY3Rpb25hcnkgPSBpbmZsYXRlR2V0RGljdGlvbmFyeTsKCWV4cG9ydHMuaW5mbGF0ZU1hcmsgPSBpbmZsYXRlTWFyazsKCWV4cG9ydHMuaW5mbGF0ZVByaW1lID0gaW5mbGF0ZVByaW1lOwoJZXhwb3J0cy5pbmZsYXRlU3luYyA9IGluZmxhdGVTeW5jOwoJZXhwb3J0cy5pbmZsYXRlU3luY1BvaW50ID0gaW5mbGF0ZVN5bmNQb2ludDsKCWV4cG9ydHMuaW5mbGF0ZVVuZGVybWluZSA9IGluZmxhdGVVbmRlcm1pbmU7CgkqLwoKCi8qKiovIH0sCi8qIDg5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JzsKCgkvLyBTZWUgc3RhdGUgZGVmcyBmcm9tIGluZmxhdGUuanMKCXZhciBCQUQgPSAzMDsgICAgICAgLyogZ290IGEgZGF0YSBlcnJvciAtLSByZW1haW4gaGVyZSB1bnRpbCByZXNldCAqLwoJdmFyIFRZUEUgPSAxMjsgICAgICAvKiBpOiB3YWl0aW5nIGZvciB0eXBlIGJpdHMsIGluY2x1ZGluZyBsYXN0LWZsYWcgYml0ICovCgoJLyoKCSAgIERlY29kZSBsaXRlcmFsLCBsZW5ndGgsIGFuZCBkaXN0YW5jZSBjb2RlcyBhbmQgd3JpdGUgb3V0IHRoZSByZXN1bHRpbmcKCSAgIGxpdGVyYWwgYW5kIG1hdGNoIGJ5dGVzIHVudGlsIGVpdGhlciBub3QgZW5vdWdoIGlucHV0IG9yIG91dHB1dCBpcwoJICAgYXZhaWxhYmxlLCBhbiBlbmQtb2YtYmxvY2sgaXMgZW5jb3VudGVyZWQsIG9yIGEgZGF0YSBlcnJvciBpcyBlbmNvdW50ZXJlZC4KCSAgIFdoZW4gbGFyZ2UgZW5vdWdoIGlucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBhcmUgc3VwcGxpZWQgdG8gaW5mbGF0ZSgpLCBmb3IKCSAgIGV4YW1wbGUsIGEgMTZLIGlucHV0IGJ1ZmZlciBhbmQgYSA2NEsgb3V0cHV0IGJ1ZmZlciwgbW9yZSB0aGFuIDk1JSBvZiB0aGUKCSAgIGluZmxhdGUgZXhlY3V0aW9uIHRpbWUgaXMgc3BlbnQgaW4gdGhpcyByb3V0aW5lLgoKCSAgIEVudHJ5IGFzc3VtcHRpb25zOgoKCSAgICAgICAgc3RhdGUubW9kZSA9PT0gTEVOCgkgICAgICAgIHN0cm0uYXZhaWxfaW4gPj0gNgoJICAgICAgICBzdHJtLmF2YWlsX291dCA+PSAyNTgKCSAgICAgICAgc3RhcnQgPj0gc3RybS5hdmFpbF9vdXQKCSAgICAgICAgc3RhdGUuYml0cyA8IDgKCgkgICBPbiByZXR1cm4sIHN0YXRlLm1vZGUgaXMgb25lIG9mOgoKCSAgICAgICAgTEVOIC0tIHJhbiBvdXQgb2YgZW5vdWdoIG91dHB1dCBzcGFjZSBvciBlbm91Z2ggYXZhaWxhYmxlIGlucHV0CgkgICAgICAgIFRZUEUgLS0gcmVhY2hlZCBlbmQgb2YgYmxvY2sgY29kZSwgaW5mbGF0ZSgpIHRvIGludGVycHJldCBuZXh0IGJsb2NrCgkgICAgICAgIEJBRCAtLSBlcnJvciBpbiBibG9jayBkYXRhCgoJICAgTm90ZXM6CgoJICAgIC0gVGhlIG1heGltdW0gaW5wdXQgYml0cyB1c2VkIGJ5IGEgbGVuZ3RoL2Rpc3RhbmNlIHBhaXIgaXMgMTUgYml0cyBmb3IgdGhlCgkgICAgICBsZW5ndGggY29kZSwgNSBiaXRzIGZvciB0aGUgbGVuZ3RoIGV4dHJhLCAxNSBiaXRzIGZvciB0aGUgZGlzdGFuY2UgY29kZSwKCSAgICAgIGFuZCAxMyBiaXRzIGZvciB0aGUgZGlzdGFuY2UgZXh0cmEuICBUaGlzIHRvdGFscyA0OCBiaXRzLCBvciBzaXggYnl0ZXMuCgkgICAgICBUaGVyZWZvcmUgaWYgc3RybS5hdmFpbF9pbiA+PSA2LCB0aGVuIHRoZXJlIGlzIGVub3VnaCBpbnB1dCB0byBhdm9pZAoJICAgICAgY2hlY2tpbmcgZm9yIGF2YWlsYWJsZSBpbnB1dCB3aGlsZSBkZWNvZGluZy4KCgkgICAgLSBUaGUgbWF4aW11bSBieXRlcyB0aGF0IGEgc2luZ2xlIGxlbmd0aC9kaXN0YW5jZSBwYWlyIGNhbiBvdXRwdXQgaXMgMjU4CgkgICAgICBieXRlcywgd2hpY2ggaXMgdGhlIG1heGltdW0gbGVuZ3RoIHRoYXQgY2FuIGJlIGNvZGVkLiAgaW5mbGF0ZV9mYXN0KCkKCSAgICAgIHJlcXVpcmVzIHN0cm0uYXZhaWxfb3V0ID49IDI1OCBmb3IgZWFjaCBsb29wIHRvIGF2b2lkIGNoZWNraW5nIGZvcgoJICAgICAgb3V0cHV0IHNwYWNlLgoJICovCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluZmxhdGVfZmFzdChzdHJtLCBzdGFydCkgewoJICB2YXIgc3RhdGU7CgkgIHZhciBfaW47ICAgICAgICAgICAgICAgICAgICAvKiBsb2NhbCBzdHJtLmlucHV0ICovCgkgIHZhciBsYXN0OyAgICAgICAgICAgICAgICAgICAvKiBoYXZlIGVub3VnaCBpbnB1dCB3aGlsZSBpbiA8IGxhc3QgKi8KCSAgdmFyIF9vdXQ7ICAgICAgICAgICAgICAgICAgIC8qIGxvY2FsIHN0cm0ub3V0cHV0ICovCgkgIHZhciBiZWc7ICAgICAgICAgICAgICAgICAgICAvKiBpbmZsYXRlKCkncyBpbml0aWFsIHN0cm0ub3V0cHV0ICovCgkgIHZhciBlbmQ7ICAgICAgICAgICAgICAgICAgICAvKiB3aGlsZSBvdXQgPCBlbmQsIGVub3VnaCBzcGFjZSBhdmFpbGFibGUgKi8KCS8vI2lmZGVmIElORkxBVEVfU1RSSUNUCgkgIHZhciBkbWF4OyAgICAgICAgICAgICAgICAgICAvKiBtYXhpbXVtIGRpc3RhbmNlIGZyb20gemxpYiBoZWFkZXIgKi8KCS8vI2VuZGlmCgkgIHZhciB3c2l6ZTsgICAgICAgICAgICAgICAgICAvKiB3aW5kb3cgc2l6ZSBvciB6ZXJvIGlmIG5vdCB1c2luZyB3aW5kb3cgKi8KCSAgdmFyIHdoYXZlOyAgICAgICAgICAgICAgICAgIC8qIHZhbGlkIGJ5dGVzIGluIHRoZSB3aW5kb3cgKi8KCSAgdmFyIHduZXh0OyAgICAgICAgICAgICAgICAgIC8qIHdpbmRvdyB3cml0ZSBpbmRleCAqLwoJICAvLyBVc2UgYHNfd2luZG93YCBpbnN0ZWFkIGB3aW5kb3dgLCBhdm9pZCBjb25mbGljdCB3aXRoIGluc3RydW1lbnRhdGlvbiB0b29scwoJICB2YXIgc193aW5kb3c7ICAgICAgICAgICAgICAgLyogYWxsb2NhdGVkIHNsaWRpbmcgd2luZG93LCBpZiB3c2l6ZSAhPSAwICovCgkgIHZhciBob2xkOyAgICAgICAgICAgICAgICAgICAvKiBsb2NhbCBzdHJtLmhvbGQgKi8KCSAgdmFyIGJpdHM7ICAgICAgICAgICAgICAgICAgIC8qIGxvY2FsIHN0cm0uYml0cyAqLwoJICB2YXIgbGNvZGU7ICAgICAgICAgICAgICAgICAgLyogbG9jYWwgc3RybS5sZW5jb2RlICovCgkgIHZhciBkY29kZTsgICAgICAgICAgICAgICAgICAvKiBsb2NhbCBzdHJtLmRpc3Rjb2RlICovCgkgIHZhciBsbWFzazsgICAgICAgICAgICAgICAgICAvKiBtYXNrIGZvciBmaXJzdCBsZXZlbCBvZiBsZW5ndGggY29kZXMgKi8KCSAgdmFyIGRtYXNrOyAgICAgICAgICAgICAgICAgIC8qIG1hc2sgZm9yIGZpcnN0IGxldmVsIG9mIGRpc3RhbmNlIGNvZGVzICovCgkgIHZhciBoZXJlOyAgICAgICAgICAgICAgICAgICAvKiByZXRyaWV2ZWQgdGFibGUgZW50cnkgKi8KCSAgdmFyIG9wOyAgICAgICAgICAgICAgICAgICAgIC8qIGNvZGUgYml0cywgb3BlcmF0aW9uLCBleHRyYSBiaXRzLCBvciAqLwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIHdpbmRvdyBwb3NpdGlvbiwgd2luZG93IGJ5dGVzIHRvIGNvcHkgKi8KCSAgdmFyIGxlbjsgICAgICAgICAgICAgICAgICAgIC8qIG1hdGNoIGxlbmd0aCwgdW51c2VkIGJ5dGVzICovCgkgIHZhciBkaXN0OyAgICAgICAgICAgICAgICAgICAvKiBtYXRjaCBkaXN0YW5jZSAqLwoJICB2YXIgZnJvbTsgICAgICAgICAgICAgICAgICAgLyogd2hlcmUgdG8gY29weSBtYXRjaCBmcm9tICovCgkgIHZhciBmcm9tX3NvdXJjZTsKCgoJICB2YXIgaW5wdXQsIG91dHB1dDsgLy8gSlMgc3BlY2lmaWMsIGJlY2F1c2Ugd2UgaGF2ZSBubyBwb2ludGVycwoKCSAgLyogY29weSBzdGF0ZSB0byBsb2NhbCB2YXJpYWJsZXMgKi8KCSAgc3RhdGUgPSBzdHJtLnN0YXRlOwoJICAvL2hlcmUgPSBzdGF0ZS5oZXJlOwoJICBfaW4gPSBzdHJtLm5leHRfaW47CgkgIGlucHV0ID0gc3RybS5pbnB1dDsKCSAgbGFzdCA9IF9pbiArIChzdHJtLmF2YWlsX2luIC0gNSk7CgkgIF9vdXQgPSBzdHJtLm5leHRfb3V0OwoJICBvdXRwdXQgPSBzdHJtLm91dHB1dDsKCSAgYmVnID0gX291dCAtIChzdGFydCAtIHN0cm0uYXZhaWxfb3V0KTsKCSAgZW5kID0gX291dCArIChzdHJtLmF2YWlsX291dCAtIDI1Nyk7CgkvLyNpZmRlZiBJTkZMQVRFX1NUUklDVAoJICBkbWF4ID0gc3RhdGUuZG1heDsKCS8vI2VuZGlmCgkgIHdzaXplID0gc3RhdGUud3NpemU7CgkgIHdoYXZlID0gc3RhdGUud2hhdmU7CgkgIHduZXh0ID0gc3RhdGUud25leHQ7CgkgIHNfd2luZG93ID0gc3RhdGUud2luZG93OwoJICBob2xkID0gc3RhdGUuaG9sZDsKCSAgYml0cyA9IHN0YXRlLmJpdHM7CgkgIGxjb2RlID0gc3RhdGUubGVuY29kZTsKCSAgZGNvZGUgPSBzdGF0ZS5kaXN0Y29kZTsKCSAgbG1hc2sgPSAoMSA8PCBzdGF0ZS5sZW5iaXRzKSAtIDE7CgkgIGRtYXNrID0gKDEgPDwgc3RhdGUuZGlzdGJpdHMpIC0gMTsKCgoJICAvKiBkZWNvZGUgbGl0ZXJhbHMgYW5kIGxlbmd0aC9kaXN0YW5jZXMgdW50aWwgZW5kLW9mLWJsb2NrIG9yIG5vdCBlbm91Z2gKCSAgICAgaW5wdXQgZGF0YSBvciBvdXRwdXQgc3BhY2UgKi8KCgkgIHRvcDoKCSAgZG8gewoJICAgIGlmIChiaXRzIDwgMTUpIHsKCSAgICAgIGhvbGQgKz0gaW5wdXRbX2luKytdIDw8IGJpdHM7CgkgICAgICBiaXRzICs9IDg7CgkgICAgICBob2xkICs9IGlucHV0W19pbisrXSA8PCBiaXRzOwoJICAgICAgYml0cyArPSA4OwoJICAgIH0KCgkgICAgaGVyZSA9IGxjb2RlW2hvbGQgJiBsbWFza107CgoJICAgIGRvbGVuOgoJICAgIGZvciAoOzspIHsgLy8gR290byBlbXVsYXRpb24KCSAgICAgIG9wID0gaGVyZSA+Pj4gMjQvKmhlcmUuYml0cyovOwoJICAgICAgaG9sZCA+Pj49IG9wOwoJICAgICAgYml0cyAtPSBvcDsKCSAgICAgIG9wID0gKGhlcmUgPj4+IDE2KSAmIDB4ZmYvKmhlcmUub3AqLzsKCSAgICAgIGlmIChvcCA9PT0gMCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgLyogbGl0ZXJhbCAqLwoJICAgICAgICAvL1RyYWNldnYoKHN0ZGVyciwgaGVyZS52YWwgPj0gMHgyMCAmJiBoZXJlLnZhbCA8IDB4N2YgPwoJICAgICAgICAvLyAgICAgICAgImluZmxhdGU6ICAgICAgICAgbGl0ZXJhbCAnJWMnXG4iIDoKCSAgICAgICAgLy8gICAgICAgICJpbmZsYXRlOiAgICAgICAgIGxpdGVyYWwgMHglMDJ4XG4iLCBoZXJlLnZhbCkpOwoJICAgICAgICBvdXRwdXRbX291dCsrXSA9IGhlcmUgJiAweGZmZmYvKmhlcmUudmFsKi87CgkgICAgICB9CgkgICAgICBlbHNlIGlmIChvcCAmIDE2KSB7ICAgICAgICAgICAgICAgICAgICAgLyogbGVuZ3RoIGJhc2UgKi8KCSAgICAgICAgbGVuID0gaGVyZSAmIDB4ZmZmZi8qaGVyZS52YWwqLzsKCSAgICAgICAgb3AgJj0gMTU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogbnVtYmVyIG9mIGV4dHJhIGJpdHMgKi8KCSAgICAgICAgaWYgKG9wKSB7CgkgICAgICAgICAgaWYgKGJpdHMgPCBvcCkgewoJICAgICAgICAgICAgaG9sZCArPSBpbnB1dFtfaW4rK10gPDwgYml0czsKCSAgICAgICAgICAgIGJpdHMgKz0gODsKCSAgICAgICAgICB9CgkgICAgICAgICAgbGVuICs9IGhvbGQgJiAoKDEgPDwgb3ApIC0gMSk7CgkgICAgICAgICAgaG9sZCA+Pj49IG9wOwoJICAgICAgICAgIGJpdHMgLT0gb3A7CgkgICAgICAgIH0KCSAgICAgICAgLy9UcmFjZXZ2KChzdGRlcnIsICJpbmZsYXRlOiAgICAgICAgIGxlbmd0aCAldVxuIiwgbGVuKSk7CgkgICAgICAgIGlmIChiaXRzIDwgMTUpIHsKCSAgICAgICAgICBob2xkICs9IGlucHV0W19pbisrXSA8PCBiaXRzOwoJICAgICAgICAgIGJpdHMgKz0gODsKCSAgICAgICAgICBob2xkICs9IGlucHV0W19pbisrXSA8PCBiaXRzOwoJICAgICAgICAgIGJpdHMgKz0gODsKCSAgICAgICAgfQoJICAgICAgICBoZXJlID0gZGNvZGVbaG9sZCAmIGRtYXNrXTsKCgkgICAgICAgIGRvZGlzdDoKCSAgICAgICAgZm9yICg7OykgeyAvLyBnb3RvIGVtdWxhdGlvbgoJICAgICAgICAgIG9wID0gaGVyZSA+Pj4gMjQvKmhlcmUuYml0cyovOwoJICAgICAgICAgIGhvbGQgPj4+PSBvcDsKCSAgICAgICAgICBiaXRzIC09IG9wOwoJICAgICAgICAgIG9wID0gKGhlcmUgPj4+IDE2KSAmIDB4ZmYvKmhlcmUub3AqLzsKCgkgICAgICAgICAgaWYgKG9wICYgMTYpIHsgICAgICAgICAgICAgICAgICAgICAgLyogZGlzdGFuY2UgYmFzZSAqLwoJICAgICAgICAgICAgZGlzdCA9IGhlcmUgJiAweGZmZmYvKmhlcmUudmFsKi87CgkgICAgICAgICAgICBvcCAmPSAxNTsgICAgICAgICAgICAgICAgICAgICAgIC8qIG51bWJlciBvZiBleHRyYSBiaXRzICovCgkgICAgICAgICAgICBpZiAoYml0cyA8IG9wKSB7CgkgICAgICAgICAgICAgIGhvbGQgKz0gaW5wdXRbX2luKytdIDw8IGJpdHM7CgkgICAgICAgICAgICAgIGJpdHMgKz0gODsKCSAgICAgICAgICAgICAgaWYgKGJpdHMgPCBvcCkgewoJICAgICAgICAgICAgICAgIGhvbGQgKz0gaW5wdXRbX2luKytdIDw8IGJpdHM7CgkgICAgICAgICAgICAgICAgYml0cyArPSA4OwoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBkaXN0ICs9IGhvbGQgJiAoKDEgPDwgb3ApIC0gMSk7CgkvLyNpZmRlZiBJTkZMQVRFX1NUUklDVAoJICAgICAgICAgICAgaWYgKGRpc3QgPiBkbWF4KSB7CgkgICAgICAgICAgICAgIHN0cm0ubXNnID0gJ2ludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrJzsKCSAgICAgICAgICAgICAgc3RhdGUubW9kZSA9IEJBRDsKCSAgICAgICAgICAgICAgYnJlYWsgdG9wOwoJICAgICAgICAgICAgfQoJLy8jZW5kaWYKCSAgICAgICAgICAgIGhvbGQgPj4+PSBvcDsKCSAgICAgICAgICAgIGJpdHMgLT0gb3A7CgkgICAgICAgICAgICAvL1RyYWNldnYoKHN0ZGVyciwgImluZmxhdGU6ICAgICAgICAgZGlzdGFuY2UgJXVcbiIsIGRpc3QpKTsKCSAgICAgICAgICAgIG9wID0gX291dCAtIGJlZzsgICAgICAgICAgICAgICAgLyogbWF4IGRpc3RhbmNlIGluIG91dHB1dCAqLwoJICAgICAgICAgICAgaWYgKGRpc3QgPiBvcCkgeyAgICAgICAgICAgICAgICAvKiBzZWUgaWYgY29weSBmcm9tIHdpbmRvdyAqLwoJICAgICAgICAgICAgICBvcCA9IGRpc3QgLSBvcDsgICAgICAgICAgICAgICAvKiBkaXN0YW5jZSBiYWNrIGluIHdpbmRvdyAqLwoJICAgICAgICAgICAgICBpZiAob3AgPiB3aGF2ZSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zYW5lKSB7CgkgICAgICAgICAgICAgICAgICBzdHJtLm1zZyA9ICdpbnZhbGlkIGRpc3RhbmNlIHRvbyBmYXIgYmFjayc7CgkgICAgICAgICAgICAgICAgICBzdGF0ZS5tb2RlID0gQkFEOwoJICAgICAgICAgICAgICAgICAgYnJlYWsgdG9wOwoJICAgICAgICAgICAgICAgIH0KCgkvLyAoISkgVGhpcyBibG9jayBpcyBkaXNhYmxlZCBpbiB6bGliIGRlZmFpbHRzLAoJLy8gZG9uJ3QgZW5hYmxlIGl0IGZvciBiaW5hcnkgY29tcGF0aWJpbGl0eQoJLy8jaWZkZWYgSU5GTEFURV9BTExPV19JTlZBTElEX0RJU1RBTkNFX1RPT0ZBUl9BUlJSCgkvLyAgICAgICAgICAgICAgICBpZiAobGVuIDw9IG9wIC0gd2hhdmUpIHsKCS8vICAgICAgICAgICAgICAgICAgZG8gewoJLy8gICAgICAgICAgICAgICAgICAgIG91dHB1dFtfb3V0KytdID0gMDsKCS8vICAgICAgICAgICAgICAgICAgfSB3aGlsZSAoLS1sZW4pOwoJLy8gICAgICAgICAgICAgICAgICBjb250aW51ZSB0b3A7CgkvLyAgICAgICAgICAgICAgICB9CgkvLyAgICAgICAgICAgICAgICBsZW4gLT0gb3AgLSB3aGF2ZTsKCS8vICAgICAgICAgICAgICAgIGRvIHsKCS8vICAgICAgICAgICAgICAgICAgb3V0cHV0W19vdXQrK10gPSAwOwoJLy8gICAgICAgICAgICAgICAgfSB3aGlsZSAoLS1vcCA+IHdoYXZlKTsKCS8vICAgICAgICAgICAgICAgIGlmIChvcCA9PT0gMCkgewoJLy8gICAgICAgICAgICAgICAgICBmcm9tID0gX291dCAtIGRpc3Q7CgkvLyAgICAgICAgICAgICAgICAgIGRvIHsKCS8vICAgICAgICAgICAgICAgICAgICBvdXRwdXRbX291dCsrXSA9IG91dHB1dFtmcm9tKytdOwoJLy8gICAgICAgICAgICAgICAgICB9IHdoaWxlICgtLWxlbik7CgkvLyAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIHRvcDsKCS8vICAgICAgICAgICAgICAgIH0KCS8vI2VuZGlmCgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgZnJvbSA9IDA7IC8vIHdpbmRvdyBpbmRleAoJICAgICAgICAgICAgICBmcm9tX3NvdXJjZSA9IHNfd2luZG93OwoJICAgICAgICAgICAgICBpZiAod25leHQgPT09IDApIHsgICAgICAgICAgIC8qIHZlcnkgY29tbW9uIGNhc2UgKi8KCSAgICAgICAgICAgICAgICBmcm9tICs9IHdzaXplIC0gb3A7CgkgICAgICAgICAgICAgICAgaWYgKG9wIDwgbGVuKSB7ICAgICAgICAgLyogc29tZSBmcm9tIHdpbmRvdyAqLwoJICAgICAgICAgICAgICAgICAgbGVuIC09IG9wOwoJICAgICAgICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgICAgICBvdXRwdXRbX291dCsrXSA9IHNfd2luZG93W2Zyb20rK107CgkgICAgICAgICAgICAgICAgICB9IHdoaWxlICgtLW9wKTsKCSAgICAgICAgICAgICAgICAgIGZyb20gPSBfb3V0IC0gZGlzdDsgIC8qIHJlc3QgZnJvbSBvdXRwdXQgKi8KCSAgICAgICAgICAgICAgICAgIGZyb21fc291cmNlID0gb3V0cHV0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICBlbHNlIGlmICh3bmV4dCA8IG9wKSB7ICAgICAgLyogd3JhcCBhcm91bmQgd2luZG93ICovCgkgICAgICAgICAgICAgICAgZnJvbSArPSB3c2l6ZSArIHduZXh0IC0gb3A7CgkgICAgICAgICAgICAgICAgb3AgLT0gd25leHQ7CgkgICAgICAgICAgICAgICAgaWYgKG9wIDwgbGVuKSB7ICAgICAgICAgLyogc29tZSBmcm9tIGVuZCBvZiB3aW5kb3cgKi8KCSAgICAgICAgICAgICAgICAgIGxlbiAtPSBvcDsKCSAgICAgICAgICAgICAgICAgIGRvIHsKCSAgICAgICAgICAgICAgICAgICAgb3V0cHV0W19vdXQrK10gPSBzX3dpbmRvd1tmcm9tKytdOwoJICAgICAgICAgICAgICAgICAgfSB3aGlsZSAoLS1vcCk7CgkgICAgICAgICAgICAgICAgICBmcm9tID0gMDsKCSAgICAgICAgICAgICAgICAgIGlmICh3bmV4dCA8IGxlbikgeyAgLyogc29tZSBmcm9tIHN0YXJ0IG9mIHdpbmRvdyAqLwoJICAgICAgICAgICAgICAgICAgICBvcCA9IHduZXh0OwoJICAgICAgICAgICAgICAgICAgICBsZW4gLT0gb3A7CgkgICAgICAgICAgICAgICAgICAgIGRvIHsKCSAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRbX291dCsrXSA9IHNfd2luZG93W2Zyb20rK107CgkgICAgICAgICAgICAgICAgICAgIH0gd2hpbGUgKC0tb3ApOwoJICAgICAgICAgICAgICAgICAgICBmcm9tID0gX291dCAtIGRpc3Q7ICAgICAgLyogcmVzdCBmcm9tIG91dHB1dCAqLwoJICAgICAgICAgICAgICAgICAgICBmcm9tX3NvdXJjZSA9IG91dHB1dDsKCSAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgZWxzZSB7ICAgICAgICAgICAgICAgICAgICAgIC8qIGNvbnRpZ3VvdXMgaW4gd2luZG93ICovCgkgICAgICAgICAgICAgICAgZnJvbSArPSB3bmV4dCAtIG9wOwoJICAgICAgICAgICAgICAgIGlmIChvcCA8IGxlbikgeyAgICAgICAgIC8qIHNvbWUgZnJvbSB3aW5kb3cgKi8KCSAgICAgICAgICAgICAgICAgIGxlbiAtPSBvcDsKCSAgICAgICAgICAgICAgICAgIGRvIHsKCSAgICAgICAgICAgICAgICAgICAgb3V0cHV0W19vdXQrK10gPSBzX3dpbmRvd1tmcm9tKytdOwoJICAgICAgICAgICAgICAgICAgfSB3aGlsZSAoLS1vcCk7CgkgICAgICAgICAgICAgICAgICBmcm9tID0gX291dCAtIGRpc3Q7ICAvKiByZXN0IGZyb20gb3V0cHV0ICovCgkgICAgICAgICAgICAgICAgICBmcm9tX3NvdXJjZSA9IG91dHB1dDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgd2hpbGUgKGxlbiA+IDIpIHsKCSAgICAgICAgICAgICAgICBvdXRwdXRbX291dCsrXSA9IGZyb21fc291cmNlW2Zyb20rK107CgkgICAgICAgICAgICAgICAgb3V0cHV0W19vdXQrK10gPSBmcm9tX3NvdXJjZVtmcm9tKytdOwoJICAgICAgICAgICAgICAgIG91dHB1dFtfb3V0KytdID0gZnJvbV9zb3VyY2VbZnJvbSsrXTsKCSAgICAgICAgICAgICAgICBsZW4gLT0gMzsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICBpZiAobGVuKSB7CgkgICAgICAgICAgICAgICAgb3V0cHV0W19vdXQrK10gPSBmcm9tX3NvdXJjZVtmcm9tKytdOwoJICAgICAgICAgICAgICAgIGlmIChsZW4gPiAxKSB7CgkgICAgICAgICAgICAgICAgICBvdXRwdXRbX291dCsrXSA9IGZyb21fc291cmNlW2Zyb20rK107CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgZnJvbSA9IF9vdXQgLSBkaXN0OyAgICAgICAgICAvKiBjb3B5IGRpcmVjdCBmcm9tIG91dHB1dCAqLwoJICAgICAgICAgICAgICBkbyB7ICAgICAgICAgICAgICAgICAgICAgICAgLyogbWluaW11bSBsZW5ndGggaXMgdGhyZWUgKi8KCSAgICAgICAgICAgICAgICBvdXRwdXRbX291dCsrXSA9IG91dHB1dFtmcm9tKytdOwoJICAgICAgICAgICAgICAgIG91dHB1dFtfb3V0KytdID0gb3V0cHV0W2Zyb20rK107CgkgICAgICAgICAgICAgICAgb3V0cHV0W19vdXQrK10gPSBvdXRwdXRbZnJvbSsrXTsKCSAgICAgICAgICAgICAgICBsZW4gLT0gMzsKCSAgICAgICAgICAgICAgfSB3aGlsZSAobGVuID4gMik7CgkgICAgICAgICAgICAgIGlmIChsZW4pIHsKCSAgICAgICAgICAgICAgICBvdXRwdXRbX291dCsrXSA9IG91dHB1dFtmcm9tKytdOwoJICAgICAgICAgICAgICAgIGlmIChsZW4gPiAxKSB7CgkgICAgICAgICAgICAgICAgICBvdXRwdXRbX291dCsrXSA9IG91dHB1dFtmcm9tKytdOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0KCSAgICAgICAgICBlbHNlIGlmICgob3AgJiA2NCkgPT09IDApIHsgICAgICAgICAgLyogMm5kIGxldmVsIGRpc3RhbmNlIGNvZGUgKi8KCSAgICAgICAgICAgIGhlcmUgPSBkY29kZVsoaGVyZSAmIDB4ZmZmZikvKmhlcmUudmFsKi8gKyAoaG9sZCAmICgoMSA8PCBvcCkgLSAxKSldOwoJICAgICAgICAgICAgY29udGludWUgZG9kaXN0OwoJICAgICAgICAgIH0KCSAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHN0cm0ubXNnID0gJ2ludmFsaWQgZGlzdGFuY2UgY29kZSc7CgkgICAgICAgICAgICBzdGF0ZS5tb2RlID0gQkFEOwoJICAgICAgICAgICAgYnJlYWsgdG9wOwoJICAgICAgICAgIH0KCgkgICAgICAgICAgYnJlYWs7IC8vIG5lZWQgdG8gZW11bGF0ZSBnb3RvIHZpYSAiY29udGludWUiCgkgICAgICAgIH0KCSAgICAgIH0KCSAgICAgIGVsc2UgaWYgKChvcCAmIDY0KSA9PT0gMCkgeyAgICAgICAgICAgICAgLyogMm5kIGxldmVsIGxlbmd0aCBjb2RlICovCgkgICAgICAgIGhlcmUgPSBsY29kZVsoaGVyZSAmIDB4ZmZmZikvKmhlcmUudmFsKi8gKyAoaG9sZCAmICgoMSA8PCBvcCkgLSAxKSldOwoJICAgICAgICBjb250aW51ZSBkb2xlbjsKCSAgICAgIH0KCSAgICAgIGVsc2UgaWYgKG9wICYgMzIpIHsgICAgICAgICAgICAgICAgICAgICAvKiBlbmQtb2YtYmxvY2sgKi8KCSAgICAgICAgLy9UcmFjZXZ2KChzdGRlcnIsICJpbmZsYXRlOiAgICAgICAgIGVuZCBvZiBibG9ja1xuIikpOwoJICAgICAgICBzdGF0ZS5tb2RlID0gVFlQRTsKCSAgICAgICAgYnJlYWsgdG9wOwoJICAgICAgfQoJICAgICAgZWxzZSB7CgkgICAgICAgIHN0cm0ubXNnID0gJ2ludmFsaWQgbGl0ZXJhbC9sZW5ndGggY29kZSc7CgkgICAgICAgIHN0YXRlLm1vZGUgPSBCQUQ7CgkgICAgICAgIGJyZWFrIHRvcDsKCSAgICAgIH0KCgkgICAgICBicmVhazsgLy8gbmVlZCB0byBlbXVsYXRlIGdvdG8gdmlhICJjb250aW51ZSIKCSAgICB9CgkgIH0gd2hpbGUgKF9pbiA8IGxhc3QgJiYgX291dCA8IGVuZCk7CgoJICAvKiByZXR1cm4gdW51c2VkIGJ5dGVzIChvbiBlbnRyeSwgYml0cyA8IDgsIHNvIGluIHdvbid0IGdvIHRvbyBmYXIgYmFjaykgKi8KCSAgbGVuID0gYml0cyA+PiAzOwoJICBfaW4gLT0gbGVuOwoJICBiaXRzIC09IGxlbiA8PCAzOwoJICBob2xkICY9ICgxIDw8IGJpdHMpIC0gMTsKCgkgIC8qIHVwZGF0ZSBzdGF0ZSBhbmQgcmV0dXJuICovCgkgIHN0cm0ubmV4dF9pbiA9IF9pbjsKCSAgc3RybS5uZXh0X291dCA9IF9vdXQ7CgkgIHN0cm0uYXZhaWxfaW4gPSAoX2luIDwgbGFzdCA/IDUgKyAobGFzdCAtIF9pbikgOiA1IC0gKF9pbiAtIGxhc3QpKTsKCSAgc3RybS5hdmFpbF9vdXQgPSAoX291dCA8IGVuZCA/IDI1NyArIChlbmQgLSBfb3V0KSA6IDI1NyAtIChfb3V0IC0gZW5kKSk7CgkgIHN0YXRlLmhvbGQgPSBob2xkOwoJICBzdGF0ZS5iaXRzID0gYml0czsKCSAgcmV0dXJuOwoJfTsKCgovKioqLyB9LAovKiA5MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoKCXZhciB1dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oODQpOwoKCXZhciBNQVhCSVRTID0gMTU7Cgl2YXIgRU5PVUdIX0xFTlMgPSA4NTI7Cgl2YXIgRU5PVUdIX0RJU1RTID0gNTkyOwoJLy92YXIgRU5PVUdIID0gKEVOT1VHSF9MRU5TK0VOT1VHSF9ESVNUUyk7CgoJdmFyIENPREVTID0gMDsKCXZhciBMRU5TID0gMTsKCXZhciBESVNUUyA9IDI7CgoJdmFyIGxiYXNlID0gWyAvKiBMZW5ndGggY29kZXMgMjU3Li4yODUgYmFzZSAqLwoJICAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDEzLCAxNSwgMTcsIDE5LCAyMywgMjcsIDMxLAoJICAzNSwgNDMsIDUxLCA1OSwgNjcsIDgzLCA5OSwgMTE1LCAxMzEsIDE2MywgMTk1LCAyMjcsIDI1OCwgMCwgMAoJXTsKCgl2YXIgbGV4dCA9IFsgLyogTGVuZ3RoIGNvZGVzIDI1Ny4uMjg1IGV4dHJhICovCgkgIDE2LCAxNiwgMTYsIDE2LCAxNiwgMTYsIDE2LCAxNiwgMTcsIDE3LCAxNywgMTcsIDE4LCAxOCwgMTgsIDE4LAoJICAxOSwgMTksIDE5LCAxOSwgMjAsIDIwLCAyMCwgMjAsIDIxLCAyMSwgMjEsIDIxLCAxNiwgNzIsIDc4CgldOwoKCXZhciBkYmFzZSA9IFsgLyogRGlzdGFuY2UgY29kZXMgMC4uMjkgYmFzZSAqLwoJICAxLCAyLCAzLCA0LCA1LCA3LCA5LCAxMywgMTcsIDI1LCAzMywgNDksIDY1LCA5NywgMTI5LCAxOTMsCgkgIDI1NywgMzg1LCA1MTMsIDc2OSwgMTAyNSwgMTUzNywgMjA0OSwgMzA3MywgNDA5NywgNjE0NSwKCSAgODE5MywgMTIyODksIDE2Mzg1LCAyNDU3NywgMCwgMAoJXTsKCgl2YXIgZGV4dCA9IFsgLyogRGlzdGFuY2UgY29kZXMgMC4uMjkgZXh0cmEgKi8KCSAgMTYsIDE2LCAxNiwgMTYsIDE3LCAxNywgMTgsIDE4LCAxOSwgMTksIDIwLCAyMCwgMjEsIDIxLCAyMiwgMjIsCgkgIDIzLCAyMywgMjQsIDI0LCAyNSwgMjUsIDI2LCAyNiwgMjcsIDI3LAoJICAyOCwgMjgsIDI5LCAyOSwgNjQsIDY0CgldOwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaW5mbGF0ZV90YWJsZSh0eXBlLCBsZW5zLCBsZW5zX2luZGV4LCBjb2RlcywgdGFibGUsIHRhYmxlX2luZGV4LCB3b3JrLCBvcHRzKQoJewoJICB2YXIgYml0cyA9IG9wdHMuYml0czsKCSAgICAgIC8vaGVyZSA9IG9wdHMuaGVyZTsgLyogdGFibGUgZW50cnkgZm9yIGR1cGxpY2F0aW9uICovCgoJICB2YXIgbGVuID0gMDsgICAgICAgICAgICAgICAvKiBhIGNvZGUncyBsZW5ndGggaW4gYml0cyAqLwoJICB2YXIgc3ltID0gMDsgICAgICAgICAgICAgICAvKiBpbmRleCBvZiBjb2RlIHN5bWJvbHMgKi8KCSAgdmFyIG1pbiA9IDAsIG1heCA9IDA7ICAgICAgICAgIC8qIG1pbmltdW0gYW5kIG1heGltdW0gY29kZSBsZW5ndGhzICovCgkgIHZhciByb290ID0gMDsgICAgICAgICAgICAgIC8qIG51bWJlciBvZiBpbmRleCBiaXRzIGZvciByb290IHRhYmxlICovCgkgIHZhciBjdXJyID0gMDsgICAgICAgICAgICAgIC8qIG51bWJlciBvZiBpbmRleCBiaXRzIGZvciBjdXJyZW50IHRhYmxlICovCgkgIHZhciBkcm9wID0gMDsgICAgICAgICAgICAgIC8qIGNvZGUgYml0cyB0byBkcm9wIGZvciBzdWItdGFibGUgKi8KCSAgdmFyIGxlZnQgPSAwOyAgICAgICAgICAgICAgICAgICAvKiBudW1iZXIgb2YgcHJlZml4IGNvZGVzIGF2YWlsYWJsZSAqLwoJICB2YXIgdXNlZCA9IDA7ICAgICAgICAgICAgICAvKiBjb2RlIGVudHJpZXMgaW4gdGFibGUgdXNlZCAqLwoJICB2YXIgaHVmZiA9IDA7ICAgICAgICAgICAgICAvKiBIdWZmbWFuIGNvZGUgKi8KCSAgdmFyIGluY3I7ICAgICAgICAgICAgICAvKiBmb3IgaW5jcmVtZW50aW5nIGNvZGUsIGluZGV4ICovCgkgIHZhciBmaWxsOyAgICAgICAgICAgICAgLyogaW5kZXggZm9yIHJlcGxpY2F0aW5nIGVudHJpZXMgKi8KCSAgdmFyIGxvdzsgICAgICAgICAgICAgICAvKiBsb3cgYml0cyBmb3IgY3VycmVudCByb290IGVudHJ5ICovCgkgIHZhciBtYXNrOyAgICAgICAgICAgICAgLyogbWFzayBmb3IgbG93IHJvb3QgYml0cyAqLwoJICB2YXIgbmV4dDsgICAgICAgICAgICAgLyogbmV4dCBhdmFpbGFibGUgc3BhY2UgaW4gdGFibGUgKi8KCSAgdmFyIGJhc2UgPSBudWxsOyAgICAgLyogYmFzZSB2YWx1ZSB0YWJsZSB0byB1c2UgKi8KCSAgdmFyIGJhc2VfaW5kZXggPSAwOwoJLy8gIHZhciBzaG9leHRyYTsgICAgLyogZXh0cmEgYml0cyB0YWJsZSB0byB1c2UgKi8KCSAgdmFyIGVuZDsgICAgICAgICAgICAgICAgICAgIC8qIHVzZSBiYXNlIGFuZCBleHRyYSBmb3Igc3ltYm9sID4gZW5kICovCgkgIHZhciBjb3VudCA9IG5ldyB1dGlscy5CdWYxNihNQVhCSVRTICsgMSk7IC8vW01BWEJJVFMrMV07ICAgIC8qIG51bWJlciBvZiBjb2RlcyBvZiBlYWNoIGxlbmd0aCAqLwoJICB2YXIgb2ZmcyA9IG5ldyB1dGlscy5CdWYxNihNQVhCSVRTICsgMSk7IC8vW01BWEJJVFMrMV07ICAgICAvKiBvZmZzZXRzIGluIHRhYmxlIGZvciBlYWNoIGxlbmd0aCAqLwoJICB2YXIgZXh0cmEgPSBudWxsOwoJICB2YXIgZXh0cmFfaW5kZXggPSAwOwoKCSAgdmFyIGhlcmVfYml0cywgaGVyZV9vcCwgaGVyZV92YWw7CgoJICAvKgoJICAgUHJvY2VzcyBhIHNldCBvZiBjb2RlIGxlbmd0aHMgdG8gY3JlYXRlIGEgY2Fub25pY2FsIEh1ZmZtYW4gY29kZS4gIFRoZQoJICAgY29kZSBsZW5ndGhzIGFyZSBsZW5zWzAuLmNvZGVzLTFdLiAgRWFjaCBsZW5ndGggY29ycmVzcG9uZHMgdG8gdGhlCgkgICBzeW1ib2xzIDAuLmNvZGVzLTEuICBUaGUgSHVmZm1hbiBjb2RlIGlzIGdlbmVyYXRlZCBieSBmaXJzdCBzb3J0aW5nIHRoZQoJICAgc3ltYm9scyBieSBsZW5ndGggZnJvbSBzaG9ydCB0byBsb25nLCBhbmQgcmV0YWluaW5nIHRoZSBzeW1ib2wgb3JkZXIKCSAgIGZvciBjb2RlcyB3aXRoIGVxdWFsIGxlbmd0aHMuICBUaGVuIHRoZSBjb2RlIHN0YXJ0cyB3aXRoIGFsbCB6ZXJvIGJpdHMKCSAgIGZvciB0aGUgZmlyc3QgY29kZSBvZiB0aGUgc2hvcnRlc3QgbGVuZ3RoLCBhbmQgdGhlIGNvZGVzIGFyZSBpbnRlZ2VyCgkgICBpbmNyZW1lbnRzIGZvciB0aGUgc2FtZSBsZW5ndGgsIGFuZCB6ZXJvcyBhcmUgYXBwZW5kZWQgYXMgdGhlIGxlbmd0aAoJICAgaW5jcmVhc2VzLiAgRm9yIHRoZSBkZWZsYXRlIGZvcm1hdCwgdGhlc2UgYml0cyBhcmUgc3RvcmVkIGJhY2t3YXJkcwoJICAgZnJvbSB0aGVpciBtb3JlIG5hdHVyYWwgaW50ZWdlciBpbmNyZW1lbnQgb3JkZXJpbmcsIGFuZCBzbyB3aGVuIHRoZQoJICAgZGVjb2RpbmcgdGFibGVzIGFyZSBidWlsdCBpbiB0aGUgbGFyZ2UgbG9vcCBiZWxvdywgdGhlIGludGVnZXIgY29kZXMKCSAgIGFyZSBpbmNyZW1lbnRlZCBiYWNrd2FyZHMuCgoJICAgVGhpcyByb3V0aW5lIGFzc3VtZXMsIGJ1dCBkb2VzIG5vdCBjaGVjaywgdGhhdCBhbGwgb2YgdGhlIGVudHJpZXMgaW4KCSAgIGxlbnNbXSBhcmUgaW4gdGhlIHJhbmdlIDAuLk1BWEJJVFMuICBUaGUgY2FsbGVyIG11c3QgYXNzdXJlIHRoaXMuCgkgICAxLi5NQVhCSVRTIGlzIGludGVycHJldGVkIGFzIHRoYXQgY29kZSBsZW5ndGguICB6ZXJvIG1lYW5zIHRoYXQgdGhhdAoJICAgc3ltYm9sIGRvZXMgbm90IG9jY3VyIGluIHRoaXMgY29kZS4KCgkgICBUaGUgY29kZXMgYXJlIHNvcnRlZCBieSBjb21wdXRpbmcgYSBjb3VudCBvZiBjb2RlcyBmb3IgZWFjaCBsZW5ndGgsCgkgICBjcmVhdGluZyBmcm9tIHRoYXQgYSB0YWJsZSBvZiBzdGFydGluZyBpbmRpY2VzIGZvciBlYWNoIGxlbmd0aCBpbiB0aGUKCSAgIHNvcnRlZCB0YWJsZSwgYW5kIHRoZW4gZW50ZXJpbmcgdGhlIHN5bWJvbHMgaW4gb3JkZXIgaW4gdGhlIHNvcnRlZAoJICAgdGFibGUuICBUaGUgc29ydGVkIHRhYmxlIGlzIHdvcmtbXSwgd2l0aCB0aGF0IHNwYWNlIGJlaW5nIHByb3ZpZGVkIGJ5CgkgICB0aGUgY2FsbGVyLgoKCSAgIFRoZSBsZW5ndGggY291bnRzIGFyZSB1c2VkIGZvciBvdGhlciBwdXJwb3NlcyBhcyB3ZWxsLCBpLmUuIGZpbmRpbmcKCSAgIHRoZSBtaW5pbXVtIGFuZCBtYXhpbXVtIGxlbmd0aCBjb2RlcywgZGV0ZXJtaW5pbmcgaWYgdGhlcmUgYXJlIGFueQoJICAgY29kZXMgYXQgYWxsLCBjaGVja2luZyBmb3IgYSB2YWxpZCBzZXQgb2YgbGVuZ3RocywgYW5kIGxvb2tpbmcgYWhlYWQKCSAgIGF0IGxlbmd0aCBjb3VudHMgdG8gZGV0ZXJtaW5lIHN1Yi10YWJsZSBzaXplcyB3aGVuIGJ1aWxkaW5nIHRoZQoJICAgZGVjb2RpbmcgdGFibGVzLgoJICAgKi8KCgkgIC8qIGFjY3VtdWxhdGUgbGVuZ3RocyBmb3IgY29kZXMgKGFzc3VtZXMgbGVuc1tdIGFsbCBpbiAwLi5NQVhCSVRTKSAqLwoJICBmb3IgKGxlbiA9IDA7IGxlbiA8PSBNQVhCSVRTOyBsZW4rKykgewoJICAgIGNvdW50W2xlbl0gPSAwOwoJICB9CgkgIGZvciAoc3ltID0gMDsgc3ltIDwgY29kZXM7IHN5bSsrKSB7CgkgICAgY291bnRbbGVuc1tsZW5zX2luZGV4ICsgc3ltXV0rKzsKCSAgfQoKCSAgLyogYm91bmQgY29kZSBsZW5ndGhzLCBmb3JjZSByb290IHRvIGJlIHdpdGhpbiBjb2RlIGxlbmd0aHMgKi8KCSAgcm9vdCA9IGJpdHM7CgkgIGZvciAobWF4ID0gTUFYQklUUzsgbWF4ID49IDE7IG1heC0tKSB7CgkgICAgaWYgKGNvdW50W21heF0gIT09IDApIHsgYnJlYWs7IH0KCSAgfQoJICBpZiAocm9vdCA+IG1heCkgewoJICAgIHJvb3QgPSBtYXg7CgkgIH0KCSAgaWYgKG1heCA9PT0gMCkgeyAgICAgICAgICAgICAgICAgICAgIC8qIG5vIHN5bWJvbHMgdG8gY29kZSBhdCBhbGwgKi8KCSAgICAvL3RhYmxlLm9wW29wdHMudGFibGVfaW5kZXhdID0gNjQ7ICAvL2hlcmUub3AgPSAodmFyIGNoYXIpNjQ7ICAgIC8qIGludmFsaWQgY29kZSBtYXJrZXIgKi8KCSAgICAvL3RhYmxlLmJpdHNbb3B0cy50YWJsZV9pbmRleF0gPSAxOyAgIC8vaGVyZS5iaXRzID0gKHZhciBjaGFyKTE7CgkgICAgLy90YWJsZS52YWxbb3B0cy50YWJsZV9pbmRleCsrXSA9IDA7ICAgLy9oZXJlLnZhbCA9ICh2YXIgc2hvcnQpMDsKCSAgICB0YWJsZVt0YWJsZV9pbmRleCsrXSA9ICgxIDw8IDI0KSB8ICg2NCA8PCAxNikgfCAwOwoKCgkgICAgLy90YWJsZS5vcFtvcHRzLnRhYmxlX2luZGV4XSA9IDY0OwoJICAgIC8vdGFibGUuYml0c1tvcHRzLnRhYmxlX2luZGV4XSA9IDE7CgkgICAgLy90YWJsZS52YWxbb3B0cy50YWJsZV9pbmRleCsrXSA9IDA7CgkgICAgdGFibGVbdGFibGVfaW5kZXgrK10gPSAoMSA8PCAyNCkgfCAoNjQgPDwgMTYpIHwgMDsKCgkgICAgb3B0cy5iaXRzID0gMTsKCSAgICByZXR1cm4gMDsgICAgIC8qIG5vIHN5bWJvbHMsIGJ1dCB3YWl0IGZvciBkZWNvZGluZyB0byByZXBvcnQgZXJyb3IgKi8KCSAgfQoJICBmb3IgKG1pbiA9IDE7IG1pbiA8IG1heDsgbWluKyspIHsKCSAgICBpZiAoY291bnRbbWluXSAhPT0gMCkgeyBicmVhazsgfQoJICB9CgkgIGlmIChyb290IDwgbWluKSB7CgkgICAgcm9vdCA9IG1pbjsKCSAgfQoKCSAgLyogY2hlY2sgZm9yIGFuIG92ZXItc3Vic2NyaWJlZCBvciBpbmNvbXBsZXRlIHNldCBvZiBsZW5ndGhzICovCgkgIGxlZnQgPSAxOwoJICBmb3IgKGxlbiA9IDE7IGxlbiA8PSBNQVhCSVRTOyBsZW4rKykgewoJICAgIGxlZnQgPDw9IDE7CgkgICAgbGVmdCAtPSBjb3VudFtsZW5dOwoJICAgIGlmIChsZWZ0IDwgMCkgewoJICAgICAgcmV0dXJuIC0xOwoJICAgIH0gICAgICAgIC8qIG92ZXItc3Vic2NyaWJlZCAqLwoJICB9CgkgIGlmIChsZWZ0ID4gMCAmJiAodHlwZSA9PT0gQ09ERVMgfHwgbWF4ICE9PSAxKSkgewoJICAgIHJldHVybiAtMTsgICAgICAgICAgICAgICAgICAgICAgLyogaW5jb21wbGV0ZSBzZXQgKi8KCSAgfQoKCSAgLyogZ2VuZXJhdGUgb2Zmc2V0cyBpbnRvIHN5bWJvbCB0YWJsZSBmb3IgZWFjaCBsZW5ndGggZm9yIHNvcnRpbmcgKi8KCSAgb2Zmc1sxXSA9IDA7CgkgIGZvciAobGVuID0gMTsgbGVuIDwgTUFYQklUUzsgbGVuKyspIHsKCSAgICBvZmZzW2xlbiArIDFdID0gb2Zmc1tsZW5dICsgY291bnRbbGVuXTsKCSAgfQoKCSAgLyogc29ydCBzeW1ib2xzIGJ5IGxlbmd0aCwgYnkgc3ltYm9sIG9yZGVyIHdpdGhpbiBlYWNoIGxlbmd0aCAqLwoJICBmb3IgKHN5bSA9IDA7IHN5bSA8IGNvZGVzOyBzeW0rKykgewoJICAgIGlmIChsZW5zW2xlbnNfaW5kZXggKyBzeW1dICE9PSAwKSB7CgkgICAgICB3b3JrW29mZnNbbGVuc1tsZW5zX2luZGV4ICsgc3ltXV0rK10gPSBzeW07CgkgICAgfQoJICB9CgoJICAvKgoJICAgQ3JlYXRlIGFuZCBmaWxsIGluIGRlY29kaW5nIHRhYmxlcy4gIEluIHRoaXMgbG9vcCwgdGhlIHRhYmxlIGJlaW5nCgkgICBmaWxsZWQgaXMgYXQgbmV4dCBhbmQgaGFzIGN1cnIgaW5kZXggYml0cy4gIFRoZSBjb2RlIGJlaW5nIHVzZWQgaXMgaHVmZgoJICAgd2l0aCBsZW5ndGggbGVuLiAgVGhhdCBjb2RlIGlzIGNvbnZlcnRlZCB0byBhbiBpbmRleCBieSBkcm9wcGluZyBkcm9wCgkgICBiaXRzIG9mZiBvZiB0aGUgYm90dG9tLiAgRm9yIGNvZGVzIHdoZXJlIGxlbiBpcyBsZXNzIHRoYW4gZHJvcCArIGN1cnIsCgkgICB0aG9zZSB0b3AgZHJvcCArIGN1cnIgLSBsZW4gYml0cyBhcmUgaW5jcmVtZW50ZWQgdGhyb3VnaCBhbGwgdmFsdWVzIHRvCgkgICBmaWxsIHRoZSB0YWJsZSB3aXRoIHJlcGxpY2F0ZWQgZW50cmllcy4KCgkgICByb290IGlzIHRoZSBudW1iZXIgb2YgaW5kZXggYml0cyBmb3IgdGhlIHJvb3QgdGFibGUuICBXaGVuIGxlbiBleGNlZWRzCgkgICByb290LCBzdWItdGFibGVzIGFyZSBjcmVhdGVkIHBvaW50ZWQgdG8gYnkgdGhlIHJvb3QgZW50cnkgd2l0aCBhbiBpbmRleAoJICAgb2YgdGhlIGxvdyByb290IGJpdHMgb2YgaHVmZi4gIFRoaXMgaXMgc2F2ZWQgaW4gbG93IHRvIGNoZWNrIGZvciB3aGVuIGEKCSAgIG5ldyBzdWItdGFibGUgc2hvdWxkIGJlIHN0YXJ0ZWQuICBkcm9wIGlzIHplcm8gd2hlbiB0aGUgcm9vdCB0YWJsZSBpcwoJICAgYmVpbmcgZmlsbGVkLCBhbmQgZHJvcCBpcyByb290IHdoZW4gc3ViLXRhYmxlcyBhcmUgYmVpbmcgZmlsbGVkLgoKCSAgIFdoZW4gYSBuZXcgc3ViLXRhYmxlIGlzIG5lZWRlZCwgaXQgaXMgbmVjZXNzYXJ5IHRvIGxvb2sgYWhlYWQgaW4gdGhlCgkgICBjb2RlIGxlbmd0aHMgdG8gZGV0ZXJtaW5lIHdoYXQgc2l6ZSBzdWItdGFibGUgaXMgbmVlZGVkLiAgVGhlIGxlbmd0aAoJICAgY291bnRzIGFyZSB1c2VkIGZvciB0aGlzLCBhbmQgc28gY291bnRbXSBpcyBkZWNyZW1lbnRlZCBhcyBjb2RlcyBhcmUKCSAgIGVudGVyZWQgaW4gdGhlIHRhYmxlcy4KCgkgICB1c2VkIGtlZXBzIHRyYWNrIG9mIGhvdyBtYW55IHRhYmxlIGVudHJpZXMgaGF2ZSBiZWVuIGFsbG9jYXRlZCBmcm9tIHRoZQoJICAgcHJvdmlkZWQgKnRhYmxlIHNwYWNlLiAgSXQgaXMgY2hlY2tlZCBmb3IgTEVOUyBhbmQgRElTVCB0YWJsZXMgYWdhaW5zdAoJICAgdGhlIGNvbnN0YW50cyBFTk9VR0hfTEVOUyBhbmQgRU5PVUdIX0RJU1RTIHRvIGd1YXJkIGFnYWluc3QgY2hhbmdlcyBpbgoJICAgdGhlIGluaXRpYWwgcm9vdCB0YWJsZSBzaXplIGNvbnN0YW50cy4gIFNlZSB0aGUgY29tbWVudHMgaW4gaW5mdHJlZXMuaAoJICAgZm9yIG1vcmUgaW5mb3JtYXRpb24uCgoJICAgc3ltIGluY3JlbWVudHMgdGhyb3VnaCBhbGwgc3ltYm9scywgYW5kIHRoZSBsb29wIHRlcm1pbmF0ZXMgd2hlbgoJICAgYWxsIGNvZGVzIG9mIGxlbmd0aCBtYXgsIGkuZS4gYWxsIGNvZGVzLCBoYXZlIGJlZW4gcHJvY2Vzc2VkLiAgVGhpcwoJICAgcm91dGluZSBwZXJtaXRzIGluY29tcGxldGUgY29kZXMsIHNvIGFub3RoZXIgbG9vcCBhZnRlciB0aGlzIG9uZSBmaWxscwoJICAgaW4gdGhlIHJlc3Qgb2YgdGhlIGRlY29kaW5nIHRhYmxlcyB3aXRoIGludmFsaWQgY29kZSBtYXJrZXJzLgoJICAgKi8KCgkgIC8qIHNldCB1cCBmb3IgY29kZSB0eXBlICovCgkgIC8vIHBvb3IgbWFuIG9wdGltaXphdGlvbiAtIHVzZSBpZi1lbHNlIGluc3RlYWQgb2Ygc3dpdGNoLAoJICAvLyB0byBhdm9pZCBkZW9wdHMgaW4gb2xkIHY4CgkgIGlmICh0eXBlID09PSBDT0RFUykgewoJICAgIGJhc2UgPSBleHRyYSA9IHdvcms7ICAgIC8qIGR1bW15IHZhbHVlLS1ub3QgdXNlZCAqLwoJICAgIGVuZCA9IDE5OwoKCSAgfSBlbHNlIGlmICh0eXBlID09PSBMRU5TKSB7CgkgICAgYmFzZSA9IGxiYXNlOwoJICAgIGJhc2VfaW5kZXggLT0gMjU3OwoJICAgIGV4dHJhID0gbGV4dDsKCSAgICBleHRyYV9pbmRleCAtPSAyNTc7CgkgICAgZW5kID0gMjU2OwoKCSAgfSBlbHNlIHsgICAgICAgICAgICAgICAgICAgIC8qIERJU1RTICovCgkgICAgYmFzZSA9IGRiYXNlOwoJICAgIGV4dHJhID0gZGV4dDsKCSAgICBlbmQgPSAtMTsKCSAgfQoKCSAgLyogaW5pdGlhbGl6ZSBvcHRzIGZvciBsb29wICovCgkgIGh1ZmYgPSAwOyAgICAgICAgICAgICAgICAgICAvKiBzdGFydGluZyBjb2RlICovCgkgIHN5bSA9IDA7ICAgICAgICAgICAgICAgICAgICAvKiBzdGFydGluZyBjb2RlIHN5bWJvbCAqLwoJICBsZW4gPSBtaW47ICAgICAgICAgICAgICAgICAgLyogc3RhcnRpbmcgY29kZSBsZW5ndGggKi8KCSAgbmV4dCA9IHRhYmxlX2luZGV4OyAgICAgICAgICAgICAgLyogY3VycmVudCB0YWJsZSB0byBmaWxsIGluICovCgkgIGN1cnIgPSByb290OyAgICAgICAgICAgICAgICAvKiBjdXJyZW50IHRhYmxlIGluZGV4IGJpdHMgKi8KCSAgZHJvcCA9IDA7ICAgICAgICAgICAgICAgICAgIC8qIGN1cnJlbnQgYml0cyB0byBkcm9wIGZyb20gY29kZSBmb3IgaW5kZXggKi8KCSAgbG93ID0gLTE7ICAgICAgICAgICAgICAgICAgIC8qIHRyaWdnZXIgbmV3IHN1Yi10YWJsZSB3aGVuIGxlbiA+IHJvb3QgKi8KCSAgdXNlZCA9IDEgPDwgcm9vdDsgICAgICAgICAgLyogdXNlIHJvb3QgdGFibGUgZW50cmllcyAqLwoJICBtYXNrID0gdXNlZCAtIDE7ICAgICAgICAgICAgLyogbWFzayBmb3IgY29tcGFyaW5nIGxvdyAqLwoKCSAgLyogY2hlY2sgYXZhaWxhYmxlIHRhYmxlIHNwYWNlICovCgkgIGlmICgodHlwZSA9PT0gTEVOUyAmJiB1c2VkID4gRU5PVUdIX0xFTlMpIHx8CgkgICAgKHR5cGUgPT09IERJU1RTICYmIHVzZWQgPiBFTk9VR0hfRElTVFMpKSB7CgkgICAgcmV0dXJuIDE7CgkgIH0KCgkgIHZhciBpID0gMDsKCSAgLyogcHJvY2VzcyBhbGwgY29kZXMgYW5kIG1ha2UgdGFibGUgZW50cmllcyAqLwoJICBmb3IgKDs7KSB7CgkgICAgaSsrOwoJICAgIC8qIGNyZWF0ZSB0YWJsZSBlbnRyeSAqLwoJICAgIGhlcmVfYml0cyA9IGxlbiAtIGRyb3A7CgkgICAgaWYgKHdvcmtbc3ltXSA8IGVuZCkgewoJICAgICAgaGVyZV9vcCA9IDA7CgkgICAgICBoZXJlX3ZhbCA9IHdvcmtbc3ltXTsKCSAgICB9CgkgICAgZWxzZSBpZiAod29ya1tzeW1dID4gZW5kKSB7CgkgICAgICBoZXJlX29wID0gZXh0cmFbZXh0cmFfaW5kZXggKyB3b3JrW3N5bV1dOwoJICAgICAgaGVyZV92YWwgPSBiYXNlW2Jhc2VfaW5kZXggKyB3b3JrW3N5bV1dOwoJICAgIH0KCSAgICBlbHNlIHsKCSAgICAgIGhlcmVfb3AgPSAzMiArIDY0OyAgICAgICAgIC8qIGVuZCBvZiBibG9jayAqLwoJICAgICAgaGVyZV92YWwgPSAwOwoJICAgIH0KCgkgICAgLyogcmVwbGljYXRlIGZvciB0aG9zZSBpbmRpY2VzIHdpdGggbG93IGxlbiBiaXRzIGVxdWFsIHRvIGh1ZmYgKi8KCSAgICBpbmNyID0gMSA8PCAobGVuIC0gZHJvcCk7CgkgICAgZmlsbCA9IDEgPDwgY3VycjsKCSAgICBtaW4gPSBmaWxsOyAgICAgICAgICAgICAgICAgLyogc2F2ZSBvZmZzZXQgdG8gbmV4dCB0YWJsZSAqLwoJICAgIGRvIHsKCSAgICAgIGZpbGwgLT0gaW5jcjsKCSAgICAgIHRhYmxlW25leHQgKyAoaHVmZiA+PiBkcm9wKSArIGZpbGxdID0gKGhlcmVfYml0cyA8PCAyNCkgfCAoaGVyZV9vcCA8PCAxNikgfCBoZXJlX3ZhbCB8MDsKCSAgICB9IHdoaWxlIChmaWxsICE9PSAwKTsKCgkgICAgLyogYmFja3dhcmRzIGluY3JlbWVudCB0aGUgbGVuLWJpdCBjb2RlIGh1ZmYgKi8KCSAgICBpbmNyID0gMSA8PCAobGVuIC0gMSk7CgkgICAgd2hpbGUgKGh1ZmYgJiBpbmNyKSB7CgkgICAgICBpbmNyID4+PSAxOwoJICAgIH0KCSAgICBpZiAoaW5jciAhPT0gMCkgewoJICAgICAgaHVmZiAmPSBpbmNyIC0gMTsKCSAgICAgIGh1ZmYgKz0gaW5jcjsKCSAgICB9IGVsc2UgewoJICAgICAgaHVmZiA9IDA7CgkgICAgfQoKCSAgICAvKiBnbyB0byBuZXh0IHN5bWJvbCwgdXBkYXRlIGNvdW50LCBsZW4gKi8KCSAgICBzeW0rKzsKCSAgICBpZiAoLS1jb3VudFtsZW5dID09PSAwKSB7CgkgICAgICBpZiAobGVuID09PSBtYXgpIHsgYnJlYWs7IH0KCSAgICAgIGxlbiA9IGxlbnNbbGVuc19pbmRleCArIHdvcmtbc3ltXV07CgkgICAgfQoKCSAgICAvKiBjcmVhdGUgbmV3IHN1Yi10YWJsZSBpZiBuZWVkZWQgKi8KCSAgICBpZiAobGVuID4gcm9vdCAmJiAoaHVmZiAmIG1hc2spICE9PSBsb3cpIHsKCSAgICAgIC8qIGlmIGZpcnN0IHRpbWUsIHRyYW5zaXRpb24gdG8gc3ViLXRhYmxlcyAqLwoJICAgICAgaWYgKGRyb3AgPT09IDApIHsKCSAgICAgICAgZHJvcCA9IHJvb3Q7CgkgICAgICB9CgoJICAgICAgLyogaW5jcmVtZW50IHBhc3QgbGFzdCB0YWJsZSAqLwoJICAgICAgbmV4dCArPSBtaW47ICAgICAgICAgICAgLyogaGVyZSBtaW4gaXMgMSA8PCBjdXJyICovCgoJICAgICAgLyogZGV0ZXJtaW5lIGxlbmd0aCBvZiBuZXh0IHRhYmxlICovCgkgICAgICBjdXJyID0gbGVuIC0gZHJvcDsKCSAgICAgIGxlZnQgPSAxIDw8IGN1cnI7CgkgICAgICB3aGlsZSAoY3VyciArIGRyb3AgPCBtYXgpIHsKCSAgICAgICAgbGVmdCAtPSBjb3VudFtjdXJyICsgZHJvcF07CgkgICAgICAgIGlmIChsZWZ0IDw9IDApIHsgYnJlYWs7IH0KCSAgICAgICAgY3VycisrOwoJICAgICAgICBsZWZ0IDw8PSAxOwoJICAgICAgfQoKCSAgICAgIC8qIGNoZWNrIGZvciBlbm91Z2ggc3BhY2UgKi8KCSAgICAgIHVzZWQgKz0gMSA8PCBjdXJyOwoJICAgICAgaWYgKCh0eXBlID09PSBMRU5TICYmIHVzZWQgPiBFTk9VR0hfTEVOUykgfHwKCSAgICAgICAgKHR5cGUgPT09IERJU1RTICYmIHVzZWQgPiBFTk9VR0hfRElTVFMpKSB7CgkgICAgICAgIHJldHVybiAxOwoJICAgICAgfQoKCSAgICAgIC8qIHBvaW50IGVudHJ5IGluIHJvb3QgdGFibGUgdG8gc3ViLXRhYmxlICovCgkgICAgICBsb3cgPSBodWZmICYgbWFzazsKCSAgICAgIC8qdGFibGUub3BbbG93XSA9IGN1cnI7CgkgICAgICB0YWJsZS5iaXRzW2xvd10gPSByb290OwoJICAgICAgdGFibGUudmFsW2xvd10gPSBuZXh0IC0gb3B0cy50YWJsZV9pbmRleDsqLwoJICAgICAgdGFibGVbbG93XSA9IChyb290IDw8IDI0KSB8IChjdXJyIDw8IDE2KSB8IChuZXh0IC0gdGFibGVfaW5kZXgpIHwwOwoJICAgIH0KCSAgfQoKCSAgLyogZmlsbCBpbiByZW1haW5pbmcgdGFibGUgZW50cnkgaWYgY29kZSBpcyBpbmNvbXBsZXRlIChndWFyYW50ZWVkIHRvIGhhdmUKCSAgIGF0IG1vc3Qgb25lIHJlbWFpbmluZyBlbnRyeSwgc2luY2UgaWYgdGhlIGNvZGUgaXMgaW5jb21wbGV0ZSwgdGhlCgkgICBtYXhpbXVtIGNvZGUgbGVuZ3RoIHRoYXQgd2FzIGFsbG93ZWQgdG8gZ2V0IHRoaXMgZmFyIGlzIG9uZSBiaXQpICovCgkgIGlmIChodWZmICE9PSAwKSB7CgkgICAgLy90YWJsZS5vcFtuZXh0ICsgaHVmZl0gPSA2NDsgICAgICAgICAgICAvKiBpbnZhbGlkIGNvZGUgbWFya2VyICovCgkgICAgLy90YWJsZS5iaXRzW25leHQgKyBodWZmXSA9IGxlbiAtIGRyb3A7CgkgICAgLy90YWJsZS52YWxbbmV4dCArIGh1ZmZdID0gMDsKCSAgICB0YWJsZVtuZXh0ICsgaHVmZl0gPSAoKGxlbiAtIGRyb3ApIDw8IDI0KSB8ICg2NCA8PCAxNikgfDA7CgkgIH0KCgkgIC8qIHNldCByZXR1cm4gcGFyYW1ldGVycyAqLwoJICAvL29wdHMudGFibGVfaW5kZXggKz0gdXNlZDsKCSAgb3B0cy5iaXRzID0gcm9vdDsKCSAgcmV0dXJuIDA7Cgl9OwoKCi8qKiovIH0sCi8qIDkxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JzsKCgoJbW9kdWxlLmV4cG9ydHMgPSB7CgoJICAvKiBBbGxvd2VkIGZsdXNoIHZhbHVlczsgc2VlIGRlZmxhdGUoKSBhbmQgaW5mbGF0ZSgpIGJlbG93IGZvciBkZXRhaWxzICovCgkgIFpfTk9fRkxVU0g6ICAgICAgICAgMCwKCSAgWl9QQVJUSUFMX0ZMVVNIOiAgICAxLAoJICBaX1NZTkNfRkxVU0g6ICAgICAgIDIsCgkgIFpfRlVMTF9GTFVTSDogICAgICAgMywKCSAgWl9GSU5JU0g6ICAgICAgICAgICA0LAoJICBaX0JMT0NLOiAgICAgICAgICAgIDUsCgkgIFpfVFJFRVM6ICAgICAgICAgICAgNiwKCgkgIC8qIFJldHVybiBjb2RlcyBmb3IgdGhlIGNvbXByZXNzaW9uL2RlY29tcHJlc3Npb24gZnVuY3Rpb25zLiBOZWdhdGl2ZSB2YWx1ZXMKCSAgKiBhcmUgZXJyb3JzLCBwb3NpdGl2ZSB2YWx1ZXMgYXJlIHVzZWQgZm9yIHNwZWNpYWwgYnV0IG5vcm1hbCBldmVudHMuCgkgICovCgkgIFpfT0s6ICAgICAgICAgICAgICAgMCwKCSAgWl9TVFJFQU1fRU5EOiAgICAgICAxLAoJICBaX05FRURfRElDVDogICAgICAgIDIsCgkgIFpfRVJSTk86ICAgICAgICAgICAtMSwKCSAgWl9TVFJFQU1fRVJST1I6ICAgIC0yLAoJICBaX0RBVEFfRVJST1I6ICAgICAgLTMsCgkgIC8vWl9NRU1fRVJST1I6ICAgICAtNCwKCSAgWl9CVUZfRVJST1I6ICAgICAgIC01LAoJICAvL1pfVkVSU0lPTl9FUlJPUjogLTYsCgoJICAvKiBjb21wcmVzc2lvbiBsZXZlbHMgKi8KCSAgWl9OT19DT01QUkVTU0lPTjogICAgICAgICAwLAoJICBaX0JFU1RfU1BFRUQ6ICAgICAgICAgICAgIDEsCgkgIFpfQkVTVF9DT01QUkVTU0lPTjogICAgICAgOSwKCSAgWl9ERUZBVUxUX0NPTVBSRVNTSU9OOiAgIC0xLAoKCgkgIFpfRklMVEVSRUQ6ICAgICAgICAgICAgICAgMSwKCSAgWl9IVUZGTUFOX09OTFk6ICAgICAgICAgICAyLAoJICBaX1JMRTogICAgICAgICAgICAgICAgICAgIDMsCgkgIFpfRklYRUQ6ICAgICAgICAgICAgICAgICAgNCwKCSAgWl9ERUZBVUxUX1NUUkFURUdZOiAgICAgICAwLAoKCSAgLyogUG9zc2libGUgdmFsdWVzIG9mIHRoZSBkYXRhX3R5cGUgZmllbGQgKHRob3VnaCBzZWUgaW5mbGF0ZSgpKSAqLwoJICBaX0JJTkFSWTogICAgICAgICAgICAgICAgIDAsCgkgIFpfVEVYVDogICAgICAgICAgICAgICAgICAgMSwKCSAgLy9aX0FTQ0lJOiAgICAgICAgICAgICAgICAxLCAvLyA9IFpfVEVYVCAoZGVwcmVjYXRlZCkKCSAgWl9VTktOT1dOOiAgICAgICAgICAgICAgICAyLAoKCSAgLyogVGhlIGRlZmxhdGUgY29tcHJlc3Npb24gbWV0aG9kICovCgkgIFpfREVGTEFURUQ6ICAgICAgICAgICAgICAgOAoJICAvL1pfTlVMTDogICAgICAgICAgICAgICAgIG51bGwgLy8gVXNlIC0xIG9yIG51bGwgaW5saW5lLCBkZXBlbmRpbmcgb24gdmFyIHR5cGUKCX07CgoKLyoqKi8gfSwKLyogOTIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCkgeyd1c2Ugc3RyaWN0JzsKCgkvLyBjb21wYXJlIGFuZCBpc0J1ZmZlciB0YWtlbiBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9mZXJvc3MvYnVmZmVyL2Jsb2IvNjgwZTllNWU0ODhmMjJhYWMyNzU5OWE1N2RjODQ0YTYzMTU5MjhkZC9pbmRleC5qcwoJLy8gb3JpZ2luYWwgbm90aWNlOgoKCS8qIQoJICogVGhlIGJ1ZmZlciBtb2R1bGUgZnJvbSBub2RlLmpzLCBmb3IgdGhlIGJyb3dzZXIuCgkgKgoJICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGZlcm9zc0BmZXJvc3Mub3JnPiA8aHR0cDovL2Zlcm9zcy5vcmc+CgkgKiBAbGljZW5zZSAgTUlUCgkgKi8KCWZ1bmN0aW9uIGNvbXBhcmUoYSwgYikgewoJICBpZiAoYSA9PT0gYikgewoJICAgIHJldHVybiAwOwoJICB9CgoJICB2YXIgeCA9IGEubGVuZ3RoOwoJICB2YXIgeSA9IGIubGVuZ3RoOwoKCSAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IE1hdGgubWluKHgsIHkpOyBpIDwgbGVuOyArK2kpIHsKCSAgICBpZiAoYVtpXSAhPT0gYltpXSkgewoJICAgICAgeCA9IGFbaV07CgkgICAgICB5ID0gYltpXTsKCSAgICAgIGJyZWFrOwoJICAgIH0KCSAgfQoKCSAgaWYgKHggPCB5KSB7CgkgICAgcmV0dXJuIC0xOwoJICB9CgkgIGlmICh5IDwgeCkgewoJICAgIHJldHVybiAxOwoJICB9CgkgIHJldHVybiAwOwoJfQoJZnVuY3Rpb24gaXNCdWZmZXIoYikgewoJICBpZiAoZ2xvYmFsLkJ1ZmZlciAmJiB0eXBlb2YgZ2xvYmFsLkJ1ZmZlci5pc0J1ZmZlciA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIHJldHVybiBnbG9iYWwuQnVmZmVyLmlzQnVmZmVyKGIpOwoJICB9CgkgIHJldHVybiAhIShiICE9IG51bGwgJiYgYi5faXNCdWZmZXIpOwoJfQoKCS8vIGJhc2VkIG9uIG5vZGUgYXNzZXJ0LCBvcmlnaW5hbCBub3RpY2U6CgoJLy8gaHR0cDovL3dpa2kuY29tbW9uanMub3JnL3dpa2kvVW5pdF9UZXN0aW5nLzEuMAoJLy8KCS8vIFRISVMgSVMgTk9UIFRFU1RFRCBOT1IgTElLRUxZIFRPIFdPUksgT1VUU0lERSBWOCEKCS8vCgkvLyBPcmlnaW5hbGx5IGZyb20gbmFyd2hhbC5qcyAoaHR0cDovL25hcndoYWxqcy5vcmcpCgkvLyBDb3B5cmlnaHQgKGMpIDIwMDkgVGhvbWFzIFJvYmluc29uIDwyODBub3J0aC5jb20+CgkvLwoJLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weQoJLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgJ1NvZnR3YXJlJyksIHRvCgkvLyBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZQoJLy8gcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yCgkvLyBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcwoJLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgoJLy8gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICdBUyBJUycsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKCS8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAoJLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFCgkvLyBBVVRIT1JTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTgoJLy8gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTgoJLy8gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCgoJdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTsKCXZhciBoYXNPd24gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5OwoJdmFyIHBTbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTsKCXZhciBmdW5jdGlvbnNIYXZlTmFtZXMgPSAoZnVuY3Rpb24gKCkgewoJICByZXR1cm4gZnVuY3Rpb24gZm9vKCkge30ubmFtZSA9PT0gJ2Zvbyc7Cgl9KCkpOwoJZnVuY3Rpb24gcFRvU3RyaW5nIChvYmopIHsKCSAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopOwoJfQoJZnVuY3Rpb24gaXNWaWV3KGFycmJ1ZikgewoJICBpZiAoaXNCdWZmZXIoYXJyYnVmKSkgewoJICAgIHJldHVybiBmYWxzZTsKCSAgfQoJICBpZiAodHlwZW9mIGdsb2JhbC5BcnJheUJ1ZmZlciAhPT0gJ2Z1bmN0aW9uJykgewoJICAgIHJldHVybiBmYWxzZTsKCSAgfQoJICBpZiAodHlwZW9mIEFycmF5QnVmZmVyLmlzVmlldyA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIHJldHVybiBBcnJheUJ1ZmZlci5pc1ZpZXcoYXJyYnVmKTsKCSAgfQoJICBpZiAoIWFycmJ1ZikgewoJICAgIHJldHVybiBmYWxzZTsKCSAgfQoJICBpZiAoYXJyYnVmIGluc3RhbmNlb2YgRGF0YVZpZXcpIHsKCSAgICByZXR1cm4gdHJ1ZTsKCSAgfQoJICBpZiAoYXJyYnVmLmJ1ZmZlciAmJiBhcnJidWYuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsKCSAgICByZXR1cm4gdHJ1ZTsKCSAgfQoJICByZXR1cm4gZmFsc2U7Cgl9CgkvLyAxLiBUaGUgYXNzZXJ0IG1vZHVsZSBwcm92aWRlcyBmdW5jdGlvbnMgdGhhdCB0aHJvdwoJLy8gQXNzZXJ0aW9uRXJyb3IncyB3aGVuIHBhcnRpY3VsYXIgY29uZGl0aW9ucyBhcmUgbm90IG1ldC4gVGhlCgkvLyBhc3NlcnQgbW9kdWxlIG11c3QgY29uZm9ybSB0byB0aGUgZm9sbG93aW5nIGludGVyZmFjZS4KCgl2YXIgYXNzZXJ0ID0gbW9kdWxlLmV4cG9ydHMgPSBvazsKCgkvLyAyLiBUaGUgQXNzZXJ0aW9uRXJyb3IgaXMgZGVmaW5lZCBpbiBhc3NlcnQuCgkvLyBuZXcgYXNzZXJ0LkFzc2VydGlvbkVycm9yKHsgbWVzc2FnZTogbWVzc2FnZSwKCS8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3R1YWw6IGFjdHVhbCwKCS8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWQgfSkKCgl2YXIgcmVnZXggPSAvXHMqZnVuY3Rpb25ccysoW15cKFxzXSopXHMqLzsKCS8vIGJhc2VkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS9samhhcmIvZnVuY3Rpb24ucHJvdG90eXBlLm5hbWUvYmxvYi9hZGVlZWVjOGJmY2M2MDY4YjE4N2Q3ZDlmYjNkNWJiMWQzYTMwODk5L2ltcGxlbWVudGF0aW9uLmpzCglmdW5jdGlvbiBnZXROYW1lKGZ1bmMpIHsKCSAgaWYgKCF1dGlsLmlzRnVuY3Rpb24oZnVuYykpIHsKCSAgICByZXR1cm47CgkgIH0KCSAgaWYgKGZ1bmN0aW9uc0hhdmVOYW1lcykgewoJICAgIHJldHVybiBmdW5jLm5hbWU7CgkgIH0KCSAgdmFyIHN0ciA9IGZ1bmMudG9TdHJpbmcoKTsKCSAgdmFyIG1hdGNoID0gc3RyLm1hdGNoKHJlZ2V4KTsKCSAgcmV0dXJuIG1hdGNoICYmIG1hdGNoWzFdOwoJfQoJYXNzZXJ0LkFzc2VydGlvbkVycm9yID0gZnVuY3Rpb24gQXNzZXJ0aW9uRXJyb3Iob3B0aW9ucykgewoJICB0aGlzLm5hbWUgPSAnQXNzZXJ0aW9uRXJyb3InOwoJICB0aGlzLmFjdHVhbCA9IG9wdGlvbnMuYWN0dWFsOwoJICB0aGlzLmV4cGVjdGVkID0gb3B0aW9ucy5leHBlY3RlZDsKCSAgdGhpcy5vcGVyYXRvciA9IG9wdGlvbnMub3BlcmF0b3I7CgkgIGlmIChvcHRpb25zLm1lc3NhZ2UpIHsKCSAgICB0aGlzLm1lc3NhZ2UgPSBvcHRpb25zLm1lc3NhZ2U7CgkgICAgdGhpcy5nZW5lcmF0ZWRNZXNzYWdlID0gZmFsc2U7CgkgIH0gZWxzZSB7CgkgICAgdGhpcy5tZXNzYWdlID0gZ2V0TWVzc2FnZSh0aGlzKTsKCSAgICB0aGlzLmdlbmVyYXRlZE1lc3NhZ2UgPSB0cnVlOwoJICB9CgkgIHZhciBzdGFja1N0YXJ0RnVuY3Rpb24gPSBvcHRpb25zLnN0YWNrU3RhcnRGdW5jdGlvbiB8fCBmYWlsOwoJICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHsKCSAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBzdGFja1N0YXJ0RnVuY3Rpb24pOwoJICB9IGVsc2UgewoJICAgIC8vIG5vbiB2OCBicm93c2VycyBzbyB3ZSBjYW4gaGF2ZSBhIHN0YWNrdHJhY2UKCSAgICB2YXIgZXJyID0gbmV3IEVycm9yKCk7CgkgICAgaWYgKGVyci5zdGFjaykgewoJICAgICAgdmFyIG91dCA9IGVyci5zdGFjazsKCgkgICAgICAvLyB0cnkgdG8gc3RyaXAgdXNlbGVzcyBmcmFtZXMKCSAgICAgIHZhciBmbl9uYW1lID0gZ2V0TmFtZShzdGFja1N0YXJ0RnVuY3Rpb24pOwoJICAgICAgdmFyIGlkeCA9IG91dC5pbmRleE9mKCdcbicgKyBmbl9uYW1lKTsKCSAgICAgIGlmIChpZHggPj0gMCkgewoJICAgICAgICAvLyBvbmNlIHdlIGhhdmUgbG9jYXRlZCB0aGUgZnVuY3Rpb24gZnJhbWUKCSAgICAgICAgLy8gd2UgbmVlZCB0byBzdHJpcCBvdXQgZXZlcnl0aGluZyBiZWZvcmUgaXQgKGFuZCBpdHMgbGluZSkKCSAgICAgICAgdmFyIG5leHRfbGluZSA9IG91dC5pbmRleE9mKCdcbicsIGlkeCArIDEpOwoJICAgICAgICBvdXQgPSBvdXQuc3Vic3RyaW5nKG5leHRfbGluZSArIDEpOwoJICAgICAgfQoKCSAgICAgIHRoaXMuc3RhY2sgPSBvdXQ7CgkgICAgfQoJICB9Cgl9OwoKCS8vIGFzc2VydC5Bc3NlcnRpb25FcnJvciBpbnN0YW5jZW9mIEVycm9yCgl1dGlsLmluaGVyaXRzKGFzc2VydC5Bc3NlcnRpb25FcnJvciwgRXJyb3IpOwoKCWZ1bmN0aW9uIHRydW5jYXRlKHMsIG4pIHsKCSAgaWYgKHR5cGVvZiBzID09PSAnc3RyaW5nJykgewoJICAgIHJldHVybiBzLmxlbmd0aCA8IG4gPyBzIDogcy5zbGljZSgwLCBuKTsKCSAgfSBlbHNlIHsKCSAgICByZXR1cm4gczsKCSAgfQoJfQoJZnVuY3Rpb24gaW5zcGVjdChzb21ldGhpbmcpIHsKCSAgaWYgKGZ1bmN0aW9uc0hhdmVOYW1lcyB8fCAhdXRpbC5pc0Z1bmN0aW9uKHNvbWV0aGluZykpIHsKCSAgICByZXR1cm4gdXRpbC5pbnNwZWN0KHNvbWV0aGluZyk7CgkgIH0KCSAgdmFyIHJhd25hbWUgPSBnZXROYW1lKHNvbWV0aGluZyk7CgkgIHZhciBuYW1lID0gcmF3bmFtZSA/ICc6ICcgKyByYXduYW1lIDogJyc7CgkgIHJldHVybiAnW0Z1bmN0aW9uJyArICBuYW1lICsgJ10nOwoJfQoJZnVuY3Rpb24gZ2V0TWVzc2FnZShzZWxmKSB7CgkgIHJldHVybiB0cnVuY2F0ZShpbnNwZWN0KHNlbGYuYWN0dWFsKSwgMTI4KSArICcgJyArCgkgICAgICAgICBzZWxmLm9wZXJhdG9yICsgJyAnICsKCSAgICAgICAgIHRydW5jYXRlKGluc3BlY3Qoc2VsZi5leHBlY3RlZCksIDEyOCk7Cgl9CgoJLy8gQXQgcHJlc2VudCBvbmx5IHRoZSB0aHJlZSBrZXlzIG1lbnRpb25lZCBhYm92ZSBhcmUgdXNlZCBhbmQKCS8vIHVuZGVyc3Rvb2QgYnkgdGhlIHNwZWMuIEltcGxlbWVudGF0aW9ucyBvciBzdWIgbW9kdWxlcyBjYW4gcGFzcwoJLy8gb3RoZXIga2V5cyB0byB0aGUgQXNzZXJ0aW9uRXJyb3IncyBjb25zdHJ1Y3RvciAtIHRoZXkgd2lsbCBiZQoJLy8gaWdub3JlZC4KCgkvLyAzLiBBbGwgb2YgdGhlIGZvbGxvd2luZyBmdW5jdGlvbnMgbXVzdCB0aHJvdyBhbiBBc3NlcnRpb25FcnJvcgoJLy8gd2hlbiBhIGNvcnJlc3BvbmRpbmcgY29uZGl0aW9uIGlzIG5vdCBtZXQsIHdpdGggYSBtZXNzYWdlIHRoYXQKCS8vIG1heSBiZSB1bmRlZmluZWQgaWYgbm90IHByb3ZpZGVkLiAgQWxsIGFzc2VydGlvbiBtZXRob2RzIHByb3ZpZGUKCS8vIGJvdGggdGhlIGFjdHVhbCBhbmQgZXhwZWN0ZWQgdmFsdWVzIHRvIHRoZSBhc3NlcnRpb24gZXJyb3IgZm9yCgkvLyBkaXNwbGF5IHB1cnBvc2VzLgoKCWZ1bmN0aW9uIGZhaWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSwgb3BlcmF0b3IsIHN0YWNrU3RhcnRGdW5jdGlvbikgewoJICB0aHJvdyBuZXcgYXNzZXJ0LkFzc2VydGlvbkVycm9yKHsKCSAgICBtZXNzYWdlOiBtZXNzYWdlLAoJICAgIGFjdHVhbDogYWN0dWFsLAoJICAgIGV4cGVjdGVkOiBleHBlY3RlZCwKCSAgICBvcGVyYXRvcjogb3BlcmF0b3IsCgkgICAgc3RhY2tTdGFydEZ1bmN0aW9uOiBzdGFja1N0YXJ0RnVuY3Rpb24KCSAgfSk7Cgl9CgoJLy8gRVhURU5TSU9OISBhbGxvd3MgZm9yIHdlbGwgYmVoYXZlZCBlcnJvcnMgZGVmaW5lZCBlbHNld2hlcmUuCglhc3NlcnQuZmFpbCA9IGZhaWw7CgoJLy8gNC4gUHVyZSBhc3NlcnRpb24gdGVzdHMgd2hldGhlciBhIHZhbHVlIGlzIHRydXRoeSwgYXMgZGV0ZXJtaW5lZAoJLy8gYnkgISFndWFyZC4KCS8vIGFzc2VydC5vayhndWFyZCwgbWVzc2FnZV9vcHQpOwoJLy8gVGhpcyBzdGF0ZW1lbnQgaXMgZXF1aXZhbGVudCB0byBhc3NlcnQuZXF1YWwodHJ1ZSwgISFndWFyZCwKCS8vIG1lc3NhZ2Vfb3B0KTsuIFRvIHRlc3Qgc3RyaWN0bHkgZm9yIHRoZSB2YWx1ZSB0cnVlLCB1c2UKCS8vIGFzc2VydC5zdHJpY3RFcXVhbCh0cnVlLCBndWFyZCwgbWVzc2FnZV9vcHQpOy4KCglmdW5jdGlvbiBvayh2YWx1ZSwgbWVzc2FnZSkgewoJICBpZiAoIXZhbHVlKSBmYWlsKHZhbHVlLCB0cnVlLCBtZXNzYWdlLCAnPT0nLCBhc3NlcnQub2spOwoJfQoJYXNzZXJ0Lm9rID0gb2s7CgoJLy8gNS4gVGhlIGVxdWFsaXR5IGFzc2VydGlvbiB0ZXN0cyBzaGFsbG93LCBjb2VyY2l2ZSBlcXVhbGl0eSB3aXRoCgkvLyA9PS4KCS8vIGFzc2VydC5lcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlX29wdCk7CgoJYXNzZXJ0LmVxdWFsID0gZnVuY3Rpb24gZXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkgewoJICBpZiAoYWN0dWFsICE9IGV4cGVjdGVkKSBmYWlsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UsICc9PScsIGFzc2VydC5lcXVhbCk7Cgl9OwoKCS8vIDYuIFRoZSBub24tZXF1YWxpdHkgYXNzZXJ0aW9uIHRlc3RzIGZvciB3aGV0aGVyIHR3byBvYmplY3RzIGFyZSBub3QgZXF1YWwKCS8vIHdpdGggIT0gYXNzZXJ0Lm5vdEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2Vfb3B0KTsKCglhc3NlcnQubm90RXF1YWwgPSBmdW5jdGlvbiBub3RFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7CgkgIGlmIChhY3R1YWwgPT0gZXhwZWN0ZWQpIHsKCSAgICBmYWlsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UsICchPScsIGFzc2VydC5ub3RFcXVhbCk7CgkgIH0KCX07CgoJLy8gNy4gVGhlIGVxdWl2YWxlbmNlIGFzc2VydGlvbiB0ZXN0cyBhIGRlZXAgZXF1YWxpdHkgcmVsYXRpb24uCgkvLyBhc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2Vfb3B0KTsKCglhc3NlcnQuZGVlcEVxdWFsID0gZnVuY3Rpb24gZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UpIHsKCSAgaWYgKCFfZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIGZhbHNlKSkgewoJICAgIGZhaWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSwgJ2RlZXBFcXVhbCcsIGFzc2VydC5kZWVwRXF1YWwpOwoJICB9Cgl9OwoKCWFzc2VydC5kZWVwU3RyaWN0RXF1YWwgPSBmdW5jdGlvbiBkZWVwU3RyaWN0RXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkgewoJICBpZiAoIV9kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgdHJ1ZSkpIHsKCSAgICBmYWlsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UsICdkZWVwU3RyaWN0RXF1YWwnLCBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKTsKCSAgfQoJfTsKCglmdW5jdGlvbiBfZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIHN0cmljdCwgbWVtb3MpIHsKCSAgLy8gNy4xLiBBbGwgaWRlbnRpY2FsIHZhbHVlcyBhcmUgZXF1aXZhbGVudCwgYXMgZGV0ZXJtaW5lZCBieSA9PT0uCgkgIGlmIChhY3R1YWwgPT09IGV4cGVjdGVkKSB7CgkgICAgcmV0dXJuIHRydWU7CgkgIH0gZWxzZSBpZiAoaXNCdWZmZXIoYWN0dWFsKSAmJiBpc0J1ZmZlcihleHBlY3RlZCkpIHsKCSAgICByZXR1cm4gY29tcGFyZShhY3R1YWwsIGV4cGVjdGVkKSA9PT0gMDsKCgkgIC8vIDcuMi4gSWYgdGhlIGV4cGVjdGVkIHZhbHVlIGlzIGEgRGF0ZSBvYmplY3QsIHRoZSBhY3R1YWwgdmFsdWUgaXMKCSAgLy8gZXF1aXZhbGVudCBpZiBpdCBpcyBhbHNvIGEgRGF0ZSBvYmplY3QgdGhhdCByZWZlcnMgdG8gdGhlIHNhbWUgdGltZS4KCSAgfSBlbHNlIGlmICh1dGlsLmlzRGF0ZShhY3R1YWwpICYmIHV0aWwuaXNEYXRlKGV4cGVjdGVkKSkgewoJICAgIHJldHVybiBhY3R1YWwuZ2V0VGltZSgpID09PSBleHBlY3RlZC5nZXRUaW1lKCk7CgoJICAvLyA3LjMgSWYgdGhlIGV4cGVjdGVkIHZhbHVlIGlzIGEgUmVnRXhwIG9iamVjdCwgdGhlIGFjdHVhbCB2YWx1ZSBpcwoJICAvLyBlcXVpdmFsZW50IGlmIGl0IGlzIGFsc28gYSBSZWdFeHAgb2JqZWN0IHdpdGggdGhlIHNhbWUgc291cmNlIGFuZAoJICAvLyBwcm9wZXJ0aWVzIChgZ2xvYmFsYCwgYG11bHRpbGluZWAsIGBsYXN0SW5kZXhgLCBgaWdub3JlQ2FzZWApLgoJICB9IGVsc2UgaWYgKHV0aWwuaXNSZWdFeHAoYWN0dWFsKSAmJiB1dGlsLmlzUmVnRXhwKGV4cGVjdGVkKSkgewoJICAgIHJldHVybiBhY3R1YWwuc291cmNlID09PSBleHBlY3RlZC5zb3VyY2UgJiYKCSAgICAgICAgICAgYWN0dWFsLmdsb2JhbCA9PT0gZXhwZWN0ZWQuZ2xvYmFsICYmCgkgICAgICAgICAgIGFjdHVhbC5tdWx0aWxpbmUgPT09IGV4cGVjdGVkLm11bHRpbGluZSAmJgoJICAgICAgICAgICBhY3R1YWwubGFzdEluZGV4ID09PSBleHBlY3RlZC5sYXN0SW5kZXggJiYKCSAgICAgICAgICAgYWN0dWFsLmlnbm9yZUNhc2UgPT09IGV4cGVjdGVkLmlnbm9yZUNhc2U7CgoJICAvLyA3LjQuIE90aGVyIHBhaXJzIHRoYXQgZG8gbm90IGJvdGggcGFzcyB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcsCgkgIC8vIGVxdWl2YWxlbmNlIGlzIGRldGVybWluZWQgYnkgPT0uCgkgIH0gZWxzZSBpZiAoKGFjdHVhbCA9PT0gbnVsbCB8fCB0eXBlb2YgYWN0dWFsICE9PSAnb2JqZWN0JykgJiYKCSAgICAgICAgICAgICAoZXhwZWN0ZWQgPT09IG51bGwgfHwgdHlwZW9mIGV4cGVjdGVkICE9PSAnb2JqZWN0JykpIHsKCSAgICByZXR1cm4gc3RyaWN0ID8gYWN0dWFsID09PSBleHBlY3RlZCA6IGFjdHVhbCA9PSBleHBlY3RlZDsKCgkgIC8vIElmIGJvdGggdmFsdWVzIGFyZSBpbnN0YW5jZXMgb2YgdHlwZWQgYXJyYXlzLCB3cmFwIHRoZWlyIHVuZGVybHlpbmcKCSAgLy8gQXJyYXlCdWZmZXJzIGluIGEgQnVmZmVyIGVhY2ggdG8gaW5jcmVhc2UgcGVyZm9ybWFuY2UKCSAgLy8gVGhpcyBvcHRpbWl6YXRpb24gcmVxdWlyZXMgdGhlIGFycmF5cyB0byBoYXZlIHRoZSBzYW1lIHR5cGUgYXMgY2hlY2tlZCBieQoJICAvLyBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nIChha2EgcFRvU3RyaW5nKS4gTmV2ZXIgcGVyZm9ybSBiaW5hcnkKCSAgLy8gY29tcGFyaXNvbnMgZm9yIEZsb2F0KkFycmF5cywgdGhvdWdoLCBzaW5jZSBlLmcuICswID09PSAtMCBidXQgdGhlaXIKCSAgLy8gYml0IHBhdHRlcm5zIGFyZSBub3QgaWRlbnRpY2FsLgoJICB9IGVsc2UgaWYgKGlzVmlldyhhY3R1YWwpICYmIGlzVmlldyhleHBlY3RlZCkgJiYKCSAgICAgICAgICAgICBwVG9TdHJpbmcoYWN0dWFsKSA9PT0gcFRvU3RyaW5nKGV4cGVjdGVkKSAmJgoJICAgICAgICAgICAgICEoYWN0dWFsIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5IHx8CgkgICAgICAgICAgICAgICBhY3R1YWwgaW5zdGFuY2VvZiBGbG9hdDY0QXJyYXkpKSB7CgkgICAgcmV0dXJuIGNvbXBhcmUobmV3IFVpbnQ4QXJyYXkoYWN0dWFsLmJ1ZmZlciksCgkgICAgICAgICAgICAgICAgICAgbmV3IFVpbnQ4QXJyYXkoZXhwZWN0ZWQuYnVmZmVyKSkgPT09IDA7CgoJICAvLyA3LjUgRm9yIGFsbCBvdGhlciBPYmplY3QgcGFpcnMsIGluY2x1ZGluZyBBcnJheSBvYmplY3RzLCBlcXVpdmFsZW5jZSBpcwoJICAvLyBkZXRlcm1pbmVkIGJ5IGhhdmluZyB0aGUgc2FtZSBudW1iZXIgb2Ygb3duZWQgcHJvcGVydGllcyAoYXMgdmVyaWZpZWQKCSAgLy8gd2l0aCBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwpLCB0aGUgc2FtZSBzZXQgb2Yga2V5cwoJICAvLyAoYWx0aG91Z2ggbm90IG5lY2Vzc2FyaWx5IHRoZSBzYW1lIG9yZGVyKSwgZXF1aXZhbGVudCB2YWx1ZXMgZm9yIGV2ZXJ5CgkgIC8vIGNvcnJlc3BvbmRpbmcga2V5LCBhbmQgYW4gaWRlbnRpY2FsICdwcm90b3R5cGUnIHByb3BlcnR5LiBOb3RlOiB0aGlzCgkgIC8vIGFjY291bnRzIGZvciBib3RoIG5hbWVkIGFuZCBpbmRleGVkIHByb3BlcnRpZXMgb24gQXJyYXlzLgoJICB9IGVsc2UgaWYgKGlzQnVmZmVyKGFjdHVhbCkgIT09IGlzQnVmZmVyKGV4cGVjdGVkKSkgewoJICAgIHJldHVybiBmYWxzZTsKCSAgfSBlbHNlIHsKCSAgICBtZW1vcyA9IG1lbW9zIHx8IHthY3R1YWw6IFtdLCBleHBlY3RlZDogW119OwoKCSAgICB2YXIgYWN0dWFsSW5kZXggPSBtZW1vcy5hY3R1YWwuaW5kZXhPZihhY3R1YWwpOwoJICAgIGlmIChhY3R1YWxJbmRleCAhPT0gLTEpIHsKCSAgICAgIGlmIChhY3R1YWxJbmRleCA9PT0gbWVtb3MuZXhwZWN0ZWQuaW5kZXhPZihleHBlY3RlZCkpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICB9CgkgICAgfQoKCSAgICBtZW1vcy5hY3R1YWwucHVzaChhY3R1YWwpOwoJICAgIG1lbW9zLmV4cGVjdGVkLnB1c2goZXhwZWN0ZWQpOwoKCSAgICByZXR1cm4gb2JqRXF1aXYoYWN0dWFsLCBleHBlY3RlZCwgc3RyaWN0LCBtZW1vcyk7CgkgIH0KCX0KCglmdW5jdGlvbiBpc0FyZ3VtZW50cyhvYmplY3QpIHsKCSAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmplY3QpID09ICdbb2JqZWN0IEFyZ3VtZW50c10nOwoJfQoKCWZ1bmN0aW9uIG9iakVxdWl2KGEsIGIsIHN0cmljdCwgYWN0dWFsVmlzaXRlZE9iamVjdHMpIHsKCSAgaWYgKGEgPT09IG51bGwgfHwgYSA9PT0gdW5kZWZpbmVkIHx8IGIgPT09IG51bGwgfHwgYiA9PT0gdW5kZWZpbmVkKQoJICAgIHJldHVybiBmYWxzZTsKCSAgLy8gaWYgb25lIGlzIGEgcHJpbWl0aXZlLCB0aGUgb3RoZXIgbXVzdCBiZSBzYW1lCgkgIGlmICh1dGlsLmlzUHJpbWl0aXZlKGEpIHx8IHV0aWwuaXNQcmltaXRpdmUoYikpCgkgICAgcmV0dXJuIGEgPT09IGI7CgkgIGlmIChzdHJpY3QgJiYgT2JqZWN0LmdldFByb3RvdHlwZU9mKGEpICE9PSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoYikpCgkgICAgcmV0dXJuIGZhbHNlOwoJICB2YXIgYUlzQXJncyA9IGlzQXJndW1lbnRzKGEpOwoJICB2YXIgYklzQXJncyA9IGlzQXJndW1lbnRzKGIpOwoJICBpZiAoKGFJc0FyZ3MgJiYgIWJJc0FyZ3MpIHx8ICghYUlzQXJncyAmJiBiSXNBcmdzKSkKCSAgICByZXR1cm4gZmFsc2U7CgkgIGlmIChhSXNBcmdzKSB7CgkgICAgYSA9IHBTbGljZS5jYWxsKGEpOwoJICAgIGIgPSBwU2xpY2UuY2FsbChiKTsKCSAgICByZXR1cm4gX2RlZXBFcXVhbChhLCBiLCBzdHJpY3QpOwoJICB9CgkgIHZhciBrYSA9IG9iamVjdEtleXMoYSk7CgkgIHZhciBrYiA9IG9iamVjdEtleXMoYik7CgkgIHZhciBrZXksIGk7CgkgIC8vIGhhdmluZyB0aGUgc2FtZSBudW1iZXIgb2Ygb3duZWQgcHJvcGVydGllcyAoa2V5cyBpbmNvcnBvcmF0ZXMKCSAgLy8gaGFzT3duUHJvcGVydHkpCgkgIGlmIChrYS5sZW5ndGggIT09IGtiLmxlbmd0aCkKCSAgICByZXR1cm4gZmFsc2U7CgkgIC8vdGhlIHNhbWUgc2V0IG9mIGtleXMgKGFsdGhvdWdoIG5vdCBuZWNlc3NhcmlseSB0aGUgc2FtZSBvcmRlciksCgkgIGthLnNvcnQoKTsKCSAga2Iuc29ydCgpOwoJICAvL35+fmNoZWFwIGtleSB0ZXN0CgkgIGZvciAoaSA9IGthLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CgkgICAgaWYgKGthW2ldICE9PSBrYltpXSkKCSAgICAgIHJldHVybiBmYWxzZTsKCSAgfQoJICAvL2VxdWl2YWxlbnQgdmFsdWVzIGZvciBldmVyeSBjb3JyZXNwb25kaW5nIGtleSwgYW5kCgkgIC8vfn5+cG9zc2libHkgZXhwZW5zaXZlIGRlZXAgdGVzdAoJICBmb3IgKGkgPSBrYS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewoJICAgIGtleSA9IGthW2ldOwoJICAgIGlmICghX2RlZXBFcXVhbChhW2tleV0sIGJba2V5XSwgc3RyaWN0LCBhY3R1YWxWaXNpdGVkT2JqZWN0cykpCgkgICAgICByZXR1cm4gZmFsc2U7CgkgIH0KCSAgcmV0dXJuIHRydWU7Cgl9CgoJLy8gOC4gVGhlIG5vbi1lcXVpdmFsZW5jZSBhc3NlcnRpb24gdGVzdHMgZm9yIGFueSBkZWVwIGluZXF1YWxpdHkuCgkvLyBhc3NlcnQubm90RGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2Vfb3B0KTsKCglhc3NlcnQubm90RGVlcEVxdWFsID0gZnVuY3Rpb24gbm90RGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UpIHsKCSAgaWYgKF9kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgZmFsc2UpKSB7CgkgICAgZmFpbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlLCAnbm90RGVlcEVxdWFsJywgYXNzZXJ0Lm5vdERlZXBFcXVhbCk7CgkgIH0KCX07CgoJYXNzZXJ0Lm5vdERlZXBTdHJpY3RFcXVhbCA9IG5vdERlZXBTdHJpY3RFcXVhbDsKCWZ1bmN0aW9uIG5vdERlZXBTdHJpY3RFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7CgkgIGlmIChfZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIHRydWUpKSB7CgkgICAgZmFpbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlLCAnbm90RGVlcFN0cmljdEVxdWFsJywgbm90RGVlcFN0cmljdEVxdWFsKTsKCSAgfQoJfQoKCgkvLyA5LiBUaGUgc3RyaWN0IGVxdWFsaXR5IGFzc2VydGlvbiB0ZXN0cyBzdHJpY3QgZXF1YWxpdHksIGFzIGRldGVybWluZWQgYnkgPT09LgoJLy8gYXNzZXJ0LnN0cmljdEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2Vfb3B0KTsKCglhc3NlcnQuc3RyaWN0RXF1YWwgPSBmdW5jdGlvbiBzdHJpY3RFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7CgkgIGlmIChhY3R1YWwgIT09IGV4cGVjdGVkKSB7CgkgICAgZmFpbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlLCAnPT09JywgYXNzZXJ0LnN0cmljdEVxdWFsKTsKCSAgfQoJfTsKCgkvLyAxMC4gVGhlIHN0cmljdCBub24tZXF1YWxpdHkgYXNzZXJ0aW9uIHRlc3RzIGZvciBzdHJpY3QgaW5lcXVhbGl0eSwgYXMKCS8vIGRldGVybWluZWQgYnkgIT09LiAgYXNzZXJ0Lm5vdFN0cmljdEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2Vfb3B0KTsKCglhc3NlcnQubm90U3RyaWN0RXF1YWwgPSBmdW5jdGlvbiBub3RTdHJpY3RFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7CgkgIGlmIChhY3R1YWwgPT09IGV4cGVjdGVkKSB7CgkgICAgZmFpbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlLCAnIT09JywgYXNzZXJ0Lm5vdFN0cmljdEVxdWFsKTsKCSAgfQoJfTsKCglmdW5jdGlvbiBleHBlY3RlZEV4Y2VwdGlvbihhY3R1YWwsIGV4cGVjdGVkKSB7CgkgIGlmICghYWN0dWFsIHx8ICFleHBlY3RlZCkgewoJICAgIHJldHVybiBmYWxzZTsKCSAgfQoKCSAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChleHBlY3RlZCkgPT0gJ1tvYmplY3QgUmVnRXhwXScpIHsKCSAgICByZXR1cm4gZXhwZWN0ZWQudGVzdChhY3R1YWwpOwoJICB9CgoJICB0cnkgewoJICAgIGlmIChhY3R1YWwgaW5zdGFuY2VvZiBleHBlY3RlZCkgewoJICAgICAgcmV0dXJuIHRydWU7CgkgICAgfQoJICB9IGNhdGNoIChlKSB7CgkgICAgLy8gSWdub3JlLiAgVGhlIGluc3RhbmNlb2YgY2hlY2sgZG9lc24ndCB3b3JrIGZvciBhcnJvdyBmdW5jdGlvbnMuCgkgIH0KCgkgIGlmIChFcnJvci5pc1Byb3RvdHlwZU9mKGV4cGVjdGVkKSkgewoJICAgIHJldHVybiBmYWxzZTsKCSAgfQoKCSAgcmV0dXJuIGV4cGVjdGVkLmNhbGwoe30sIGFjdHVhbCkgPT09IHRydWU7Cgl9CgoJZnVuY3Rpb24gX3RyeUJsb2NrKGJsb2NrKSB7CgkgIHZhciBlcnJvcjsKCSAgdHJ5IHsKCSAgICBibG9jaygpOwoJICB9IGNhdGNoIChlKSB7CgkgICAgZXJyb3IgPSBlOwoJICB9CgkgIHJldHVybiBlcnJvcjsKCX0KCglmdW5jdGlvbiBfdGhyb3dzKHNob3VsZFRocm93LCBibG9jaywgZXhwZWN0ZWQsIG1lc3NhZ2UpIHsKCSAgdmFyIGFjdHVhbDsKCgkgIGlmICh0eXBlb2YgYmxvY2sgIT09ICdmdW5jdGlvbicpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCciYmxvY2siIGFyZ3VtZW50IG11c3QgYmUgYSBmdW5jdGlvbicpOwoJICB9CgoJICBpZiAodHlwZW9mIGV4cGVjdGVkID09PSAnc3RyaW5nJykgewoJICAgIG1lc3NhZ2UgPSBleHBlY3RlZDsKCSAgICBleHBlY3RlZCA9IG51bGw7CgkgIH0KCgkgIGFjdHVhbCA9IF90cnlCbG9jayhibG9jayk7CgoJICBtZXNzYWdlID0gKGV4cGVjdGVkICYmIGV4cGVjdGVkLm5hbWUgPyAnICgnICsgZXhwZWN0ZWQubmFtZSArICcpLicgOiAnLicpICsKCSAgICAgICAgICAgIChtZXNzYWdlID8gJyAnICsgbWVzc2FnZSA6ICcuJyk7CgoJICBpZiAoc2hvdWxkVGhyb3cgJiYgIWFjdHVhbCkgewoJICAgIGZhaWwoYWN0dWFsLCBleHBlY3RlZCwgJ01pc3NpbmcgZXhwZWN0ZWQgZXhjZXB0aW9uJyArIG1lc3NhZ2UpOwoJICB9CgoJICB2YXIgdXNlclByb3ZpZGVkTWVzc2FnZSA9IHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJzsKCSAgdmFyIGlzVW53YW50ZWRFeGNlcHRpb24gPSAhc2hvdWxkVGhyb3cgJiYgdXRpbC5pc0Vycm9yKGFjdHVhbCk7CgkgIHZhciBpc1VuZXhwZWN0ZWRFeGNlcHRpb24gPSAhc2hvdWxkVGhyb3cgJiYgYWN0dWFsICYmICFleHBlY3RlZDsKCgkgIGlmICgoaXNVbndhbnRlZEV4Y2VwdGlvbiAmJgoJICAgICAgdXNlclByb3ZpZGVkTWVzc2FnZSAmJgoJICAgICAgZXhwZWN0ZWRFeGNlcHRpb24oYWN0dWFsLCBleHBlY3RlZCkpIHx8CgkgICAgICBpc1VuZXhwZWN0ZWRFeGNlcHRpb24pIHsKCSAgICBmYWlsKGFjdHVhbCwgZXhwZWN0ZWQsICdHb3QgdW53YW50ZWQgZXhjZXB0aW9uJyArIG1lc3NhZ2UpOwoJICB9CgoJICBpZiAoKHNob3VsZFRocm93ICYmIGFjdHVhbCAmJiBleHBlY3RlZCAmJgoJICAgICAgIWV4cGVjdGVkRXhjZXB0aW9uKGFjdHVhbCwgZXhwZWN0ZWQpKSB8fCAoIXNob3VsZFRocm93ICYmIGFjdHVhbCkpIHsKCSAgICB0aHJvdyBhY3R1YWw7CgkgIH0KCX0KCgkvLyAxMS4gRXhwZWN0ZWQgdG8gdGhyb3cgYW4gZXJyb3I6CgkvLyBhc3NlcnQudGhyb3dzKGJsb2NrLCBFcnJvcl9vcHQsIG1lc3NhZ2Vfb3B0KTsKCglhc3NlcnQudGhyb3dzID0gZnVuY3Rpb24oYmxvY2ssIC8qb3B0aW9uYWwqL2Vycm9yLCAvKm9wdGlvbmFsKi9tZXNzYWdlKSB7CgkgIF90aHJvd3ModHJ1ZSwgYmxvY2ssIGVycm9yLCBtZXNzYWdlKTsKCX07CgoJLy8gRVhURU5TSU9OISBUaGlzIGlzIGFubm95aW5nIHRvIHdyaXRlIG91dHNpZGUgdGhpcyBtb2R1bGUuCglhc3NlcnQuZG9lc05vdFRocm93ID0gZnVuY3Rpb24oYmxvY2ssIC8qb3B0aW9uYWwqL2Vycm9yLCAvKm9wdGlvbmFsKi9tZXNzYWdlKSB7CgkgIF90aHJvd3MoZmFsc2UsIGJsb2NrLCBlcnJvciwgbWVzc2FnZSk7Cgl9OwoKCWFzc2VydC5pZkVycm9yID0gZnVuY3Rpb24oZXJyKSB7IGlmIChlcnIpIHRocm93IGVycjsgfTsKCgl2YXIgb2JqZWN0S2V5cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIChvYmopIHsKCSAgdmFyIGtleXMgPSBbXTsKCSAgZm9yICh2YXIga2V5IGluIG9iaikgewoJICAgIGlmIChoYXNPd24uY2FsbChvYmosIGtleSkpIGtleXMucHVzaChrZXkpOwoJICB9CgkgIHJldHVybiBrZXlzOwoJfTsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpCgovKioqLyB9LAovKiA5MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkndXNlIHN0cmljdCc7CgoJLyoqCgkgKiBDbGFzcyByZXByZXNlbnRpbmcgYW4gZXZlbnQuCgkgKgoJICogQHByaXZhdGUKCSAqLwoJY2xhc3MgRXZlbnQgewoJICAvKioKCSAgICogQ3JlYXRlIGEgbmV3IGBFdmVudGAuCgkgICAqCgkgICAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIFRoZSBuYW1lIG9mIHRoZSBldmVudAoJICAgKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0IEEgcmVmZXJlbmNlIHRvIHRoZSB0YXJnZXQgdG8gd2hpY2ggdGhlIGV2ZW50IHdhcyBkaXNwYXRjaGVkCgkgICAqLwoJICBjb25zdHJ1Y3RvciAodHlwZSwgdGFyZ2V0KSB7CgkgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7CgkgICAgdGhpcy50eXBlID0gdHlwZTsKCSAgfQoJfQoKCS8qKgoJICogQ2xhc3MgcmVwcmVzZW50aW5nIGEgbWVzc2FnZSBldmVudC4KCSAqCgkgKiBAZXh0ZW5kcyBFdmVudAoJICogQHByaXZhdGUKCSAqLwoJY2xhc3MgTWVzc2FnZUV2ZW50IGV4dGVuZHMgRXZlbnQgewoJICAvKioKCSAgICogQ3JlYXRlIGEgbmV3IGBNZXNzYWdlRXZlbnRgLgoJICAgKgoJICAgKiBAcGFyYW0geyhTdHJpbmd8QnVmZmVyfEFycmF5QnVmZmVyKX0gZGF0YSBUaGUgcmVjZWl2ZWQgZGF0YQoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlzQmluYXJ5IFNwZWNpZmllcyBpZiBgZGF0YWAgaXMgYmluYXJ5CgkgICAqIEBwYXJhbSB7V2ViU29ja2V0fSB0YXJnZXQgQSByZWZlcmVuY2UgdG8gdGhlIHRhcmdldCB0byB3aGljaCB0aGUgZXZlbnQgd2FzIGRpc3BhdGNoZWQKCSAgICovCgkgIGNvbnN0cnVjdG9yIChkYXRhLCBpc0JpbmFyeSwgdGFyZ2V0KSB7CgkgICAgc3VwZXIoJ21lc3NhZ2UnLCB0YXJnZXQpOwoKCSAgICB0aGlzLmJpbmFyeSA9IGlzQmluYXJ5OyAvLyBub24tc3RhbmRhcmQuCgkgICAgdGhpcy5kYXRhID0gZGF0YTsKCSAgfQoJfQoKCS8qKgoJICogQ2xhc3MgcmVwcmVzZW50aW5nIGEgY2xvc2UgZXZlbnQuCgkgKgoJICogQGV4dGVuZHMgRXZlbnQKCSAqIEBwcml2YXRlCgkgKi8KCWNsYXNzIENsb3NlRXZlbnQgZXh0ZW5kcyBFdmVudCB7CgkgIC8qKgoJICAgKiBDcmVhdGUgYSBuZXcgYENsb3NlRXZlbnRgLgoJICAgKgoJICAgKiBAcGFyYW0ge051bWJlcn0gY29kZSBUaGUgc3RhdHVzIGNvZGUgZXhwbGFpbmluZyB3aHkgdGhlIGNvbm5lY3Rpb24gaXMgYmVpbmcgY2xvc2VkCgkgICAqIEBwYXJhbSB7U3RyaW5nfSByZWFzb24gQSBodW1hbi1yZWFkYWJsZSBzdHJpbmcgZXhwbGFpbmluZyB3aHkgdGhlIGNvbm5lY3Rpb24gaXMgY2xvc2luZwoJICAgKiBAcGFyYW0ge1dlYlNvY2tldH0gdGFyZ2V0IEEgcmVmZXJlbmNlIHRvIHRoZSB0YXJnZXQgdG8gd2hpY2ggdGhlIGV2ZW50IHdhcyBkaXNwYXRjaGVkCgkgICAqLwoJICBjb25zdHJ1Y3RvciAoY29kZSwgcmVhc29uLCB0YXJnZXQpIHsKCSAgICBzdXBlcignY2xvc2UnLCB0YXJnZXQpOwoKCSAgICB0aGlzLndhc0NsZWFuID0gY29kZSA9PT0gdW5kZWZpbmVkIHx8IGNvZGUgPT09IDEwMDA7CgkgICAgdGhpcy5yZWFzb24gPSByZWFzb247CgkgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7CgkgICAgdGhpcy50eXBlID0gJ2Nsb3NlJzsKCSAgICB0aGlzLmNvZGUgPSBjb2RlOwoJICB9Cgl9CgoJLyoqCgkgKiBDbGFzcyByZXByZXNlbnRpbmcgYW4gb3BlbiBldmVudC4KCSAqCgkgKiBAZXh0ZW5kcyBFdmVudAoJICogQHByaXZhdGUKCSAqLwoJY2xhc3MgT3BlbkV2ZW50IGV4dGVuZHMgRXZlbnQgewoJICAvKioKCSAgICogQ3JlYXRlIGEgbmV3IGBPcGVuRXZlbnRgLgoJICAgKgoJICAgKiBAcGFyYW0ge1dlYlNvY2tldH0gdGFyZ2V0IEEgcmVmZXJlbmNlIHRvIHRoZSB0YXJnZXQgdG8gd2hpY2ggdGhlIGV2ZW50IHdhcyBkaXNwYXRjaGVkCgkgICAqLwoJICBjb25zdHJ1Y3RvciAodGFyZ2V0KSB7CgkgICAgc3VwZXIoJ29wZW4nLCB0YXJnZXQpOwoJICB9Cgl9CgoJLyoqCgkgKiBUaGlzIHByb3ZpZGVzIG1ldGhvZHMgZm9yIGVtdWxhdGluZyB0aGUgYEV2ZW50VGFyZ2V0YCBpbnRlcmZhY2UuIEl0J3Mgbm90CgkgKiBtZWFudCB0byBiZSB1c2VkIGRpcmVjdGx5LgoJICoKCSAqIEBtaXhpbgoJICovCgljb25zdCBFdmVudFRhcmdldCA9IHsKCSAgLyoqCgkgICAqIFJlZ2lzdGVyIGFuIGV2ZW50IGxpc3RlbmVyLgoJICAgKgoJICAgKiBAcGFyYW0ge1N0cmluZ30gbWV0aG9kIEEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgZXZlbnQgdHlwZSB0byBsaXN0ZW4gZm9yCgkgICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIFRoZSBsaXN0ZW5lciB0byBhZGQKCSAgICogQHB1YmxpYwoJICAgKi8KCSAgYWRkRXZlbnRMaXN0ZW5lciAobWV0aG9kLCBsaXN0ZW5lcikgewoJICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09ICdmdW5jdGlvbicpIHJldHVybjsKCgkgICAgZnVuY3Rpb24gb25NZXNzYWdlIChkYXRhLCBmbGFncykgewoJICAgICAgaWYgKGZsYWdzLmJpbmFyeSAmJiB0aGlzLmJpbmFyeVR5cGUgPT09ICdhcnJheWJ1ZmZlcicpIHsKCSAgICAgICAgZGF0YSA9IG5ldyBVaW50OEFycmF5KGRhdGEpLmJ1ZmZlcjsKCSAgICAgIH0KCSAgICAgIGxpc3RlbmVyLmNhbGwodGhpcywgbmV3IE1lc3NhZ2VFdmVudChkYXRhLCAhIWZsYWdzLmJpbmFyeSwgdGhpcykpOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gb25DbG9zZSAoY29kZSwgbWVzc2FnZSkgewoJICAgICAgbGlzdGVuZXIuY2FsbCh0aGlzLCBuZXcgQ2xvc2VFdmVudChjb2RlLCBtZXNzYWdlLCB0aGlzKSk7CgkgICAgfQoKCSAgICBmdW5jdGlvbiBvbkVycm9yIChldmVudCkgewoJICAgICAgZXZlbnQudHlwZSA9ICdlcnJvcic7CgkgICAgICBldmVudC50YXJnZXQgPSB0aGlzOwoJICAgICAgbGlzdGVuZXIuY2FsbCh0aGlzLCBldmVudCk7CgkgICAgfQoKCSAgICBmdW5jdGlvbiBvbk9wZW4gKCkgewoJICAgICAgbGlzdGVuZXIuY2FsbCh0aGlzLCBuZXcgT3BlbkV2ZW50KHRoaXMpKTsKCSAgICB9CgoJICAgIGlmIChtZXRob2QgPT09ICdtZXNzYWdlJykgewoJICAgICAgb25NZXNzYWdlLl9saXN0ZW5lciA9IGxpc3RlbmVyOwoJICAgICAgdGhpcy5vbihtZXRob2QsIG9uTWVzc2FnZSk7CgkgICAgfSBlbHNlIGlmIChtZXRob2QgPT09ICdjbG9zZScpIHsKCSAgICAgIG9uQ2xvc2UuX2xpc3RlbmVyID0gbGlzdGVuZXI7CgkgICAgICB0aGlzLm9uKG1ldGhvZCwgb25DbG9zZSk7CgkgICAgfSBlbHNlIGlmIChtZXRob2QgPT09ICdlcnJvcicpIHsKCSAgICAgIG9uRXJyb3IuX2xpc3RlbmVyID0gbGlzdGVuZXI7CgkgICAgICB0aGlzLm9uKG1ldGhvZCwgb25FcnJvcik7CgkgICAgfSBlbHNlIGlmIChtZXRob2QgPT09ICdvcGVuJykgewoJICAgICAgb25PcGVuLl9saXN0ZW5lciA9IGxpc3RlbmVyOwoJICAgICAgdGhpcy5vbihtZXRob2QsIG9uT3Blbik7CgkgICAgfSBlbHNlIHsKCSAgICAgIHRoaXMub24obWV0aG9kLCBsaXN0ZW5lcik7CgkgICAgfQoJICB9LAoKCSAgLyoqCgkgICAqIFJlbW92ZSBhbiBldmVudCBsaXN0ZW5lci4KCSAgICoKCSAgICogQHBhcmFtIHtTdHJpbmd9IG1ldGhvZCBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGV2ZW50IHR5cGUgdG8gcmVtb3ZlCgkgICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIFRoZSBsaXN0ZW5lciB0byByZW1vdmUKCSAgICogQHB1YmxpYwoJICAgKi8KCSAgcmVtb3ZlRXZlbnRMaXN0ZW5lciAobWV0aG9kLCBsaXN0ZW5lcikgewoJICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzKG1ldGhvZCk7CgoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7CgkgICAgICBpZiAobGlzdGVuZXJzW2ldID09PSBsaXN0ZW5lciB8fCBsaXN0ZW5lcnNbaV0uX2xpc3RlbmVyID09PSBsaXN0ZW5lcikgewoJICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKG1ldGhvZCwgbGlzdGVuZXJzW2ldKTsKCSAgICAgIH0KCSAgICB9CgkgIH0KCX07CgoJbW9kdWxlLmV4cG9ydHMgPSBFdmVudFRhcmdldDsKCgovKioqLyB9LAovKiA5NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkndXNlIHN0cmljdCc7CgoJLyoqCgkgKiBNb2R1bGUgZXhwb3J0cy4KCSAqLwoKCWV4cG9ydHMucGFyc2UgPSBwYXJzZTsKCWV4cG9ydHMuZm9ybWF0ID0gZm9ybWF0OwoKCS8qKgoJICogUGFyc2UgZXh0ZW5zaW9ucyBoZWFkZXIgdmFsdWUKCSAqLwoKCWZ1bmN0aW9uIHBhcnNlICh2YWx1ZSkgewoJICB2YWx1ZSA9IHZhbHVlIHx8ICcnOwoKCSAgdmFyIGV4dGVuc2lvbnMgPSB7fTsKCgkgIHZhbHVlLnNwbGl0KCcsJykuZm9yRWFjaChmdW5jdGlvbiAodikgewoJICAgIHZhciBwYXJhbXMgPSB2LnNwbGl0KCc7Jyk7CgkgICAgdmFyIHRva2VuID0gcGFyYW1zLnNoaWZ0KCkudHJpbSgpOwoJICAgIHZhciBwYXJhbXNMaXN0ID0gZXh0ZW5zaW9uc1t0b2tlbl0gPSBleHRlbnNpb25zW3Rva2VuXSB8fCBbXTsKCSAgICB2YXIgcGFyc2VkUGFyYW1zID0ge307CgoJICAgIHBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uIChwYXJhbSkgewoJICAgICAgdmFyIHBhcnRzID0gcGFyYW0udHJpbSgpLnNwbGl0KCc9Jyk7CgkgICAgICB2YXIga2V5ID0gcGFydHNbMF07CgkgICAgICB2YXIgdmFsdWUgPSBwYXJ0c1sxXTsKCSAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7CgkgICAgICAgIHZhbHVlID0gdHJ1ZTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIC8vIHVucXVvdGUgdmFsdWUKCSAgICAgICAgaWYgKHZhbHVlWzBdID09PSAnIicpIHsKCSAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDEpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh2YWx1ZVt2YWx1ZS5sZW5ndGggLSAxXSA9PT0gJyInKSB7CgkgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5zbGljZSgwLCB2YWx1ZS5sZW5ndGggLSAxKTsKCSAgICAgICAgfQoJICAgICAgfQoJICAgICAgKHBhcnNlZFBhcmFtc1trZXldID0gcGFyc2VkUGFyYW1zW2tleV0gfHwgW10pLnB1c2godmFsdWUpOwoJICAgIH0pOwoKCSAgICBwYXJhbXNMaXN0LnB1c2gocGFyc2VkUGFyYW1zKTsKCSAgfSk7CgoJICByZXR1cm4gZXh0ZW5zaW9uczsKCX0KCgkvKioKCSAqIEZvcm1hdCBleHRlbnNpb25zIGhlYWRlciB2YWx1ZQoJICovCgoJZnVuY3Rpb24gZm9ybWF0ICh2YWx1ZSkgewoJICByZXR1cm4gT2JqZWN0LmtleXModmFsdWUpLm1hcChmdW5jdGlvbiAodG9rZW4pIHsKCSAgICB2YXIgcGFyYW1zTGlzdCA9IHZhbHVlW3Rva2VuXTsKCSAgICBpZiAoIUFycmF5LmlzQXJyYXkocGFyYW1zTGlzdCkpIHsKCSAgICAgIHBhcmFtc0xpc3QgPSBbcGFyYW1zTGlzdF07CgkgICAgfQoJICAgIHJldHVybiBwYXJhbXNMaXN0Lm1hcChmdW5jdGlvbiAocGFyYW1zKSB7CgkgICAgICByZXR1cm4gW3Rva2VuXS5jb25jYXQoT2JqZWN0LmtleXMocGFyYW1zKS5tYXAoZnVuY3Rpb24gKGspIHsKCSAgICAgICAgdmFyIHAgPSBwYXJhbXNba107CgkgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShwKSkgcCA9IFtwXTsKCSAgICAgICAgcmV0dXJuIHAubWFwKGZ1bmN0aW9uICh2KSB7CgkgICAgICAgICAgcmV0dXJuIHYgPT09IHRydWUgPyBrIDogayArICc9JyArIHY7CgkgICAgICAgIH0pLmpvaW4oJzsgJyk7CgkgICAgICB9KSkuam9pbignOyAnKTsKCSAgICB9KS5qb2luKCcsICcpOwoJICB9KS5qb2luKCcsICcpOwoJfQoKCi8qKiovIH0sCi8qIDk1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIpIHsvKiEKCSAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudAoJICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+CgkgKiBNSVQgTGljZW5zZWQKCSAqLwoKCSd1c2Ugc3RyaWN0JzsKCgljb25zdCBQZXJNZXNzYWdlRGVmbGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNzgpOwoJY29uc3QgaXNWYWxpZFVURjggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KTsKCWNvbnN0IGJ1ZmZlclV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNSk7Cgljb25zdCBFcnJvckNvZGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpOwoKCWNvbnN0IEVNUFRZX0JVRkZFUiA9IEJ1ZmZlci5hbGxvYygwKTsKCgljb25zdCBHRVRfSU5GTyA9IDA7Cgljb25zdCBHRVRfUEFZTE9BRF9MRU5HVEhfMTYgPSAxOwoJY29uc3QgR0VUX1BBWUxPQURfTEVOR1RIXzY0ID0gMjsKCWNvbnN0IEdFVF9NQVNLID0gMzsKCWNvbnN0IEdFVF9EQVRBID0gNDsKCWNvbnN0IElORkxBVElORyA9IDU7CgoJLyoqCgkgKiBIeUJpIFJlY2VpdmVyIGltcGxlbWVudGF0aW9uLgoJICovCgljbGFzcyBSZWNlaXZlciB7CgkgIC8qKgoJICAgKiBDcmVhdGVzIGEgUmVjZWl2ZXIgaW5zdGFuY2UuCgkgICAqCgkgICAqIEBwYXJhbSB7T2JqZWN0fSBleHRlbnNpb25zIEFuIG9iamVjdCBjb250YWluaW5nIHRoZSBuZWdvdGlhdGVkIGV4dGVuc2lvbnMKCSAgICogQHBhcmFtIHtOdW1iZXJ9IG1heFBheWxvYWQgVGhlIG1heGltdW0gYWxsb3dlZCBtZXNzYWdlIGxlbmd0aAoJICAgKi8KCSAgY29uc3RydWN0b3IgKGV4dGVuc2lvbnMsIG1heFBheWxvYWQpIHsKCSAgICB0aGlzLmV4dGVuc2lvbnMgPSBleHRlbnNpb25zIHx8IHt9OwoJICAgIHRoaXMubWF4UGF5bG9hZCA9IG1heFBheWxvYWQgfCAwOwoKCSAgICB0aGlzLmJ1ZmZlcmVkQnl0ZXMgPSAwOwoJICAgIHRoaXMuYnVmZmVycyA9IFtdOwoKCSAgICB0aGlzLmNvbXByZXNzZWQgPSBmYWxzZTsKCSAgICB0aGlzLnBheWxvYWRMZW5ndGggPSAwOwoJICAgIHRoaXMuZnJhZ21lbnRlZCA9IDA7CgkgICAgdGhpcy5tYXNrZWQgPSBmYWxzZTsKCSAgICB0aGlzLmZpbiA9IGZhbHNlOwoJICAgIHRoaXMubWFzayA9IG51bGw7CgkgICAgdGhpcy5vcGNvZGUgPSAwOwoKCSAgICB0aGlzLnRvdGFsUGF5bG9hZExlbmd0aCA9IDA7CgkgICAgdGhpcy5tZXNzYWdlTGVuZ3RoID0gMDsKCSAgICB0aGlzLmZyYWdtZW50cyA9IFtdOwoKCSAgICB0aGlzLmNsZWFudXBDYWxsYmFjayA9IG51bGw7CgkgICAgdGhpcy5oYWRFcnJvciA9IGZhbHNlOwoJICAgIHRoaXMuZGVhZCA9IGZhbHNlOwoJICAgIHRoaXMubG9vcCA9IGZhbHNlOwoKCSAgICB0aGlzLm9ubWVzc2FnZSA9IG51bGw7CgkgICAgdGhpcy5vbmNsb3NlID0gbnVsbDsKCSAgICB0aGlzLm9uZXJyb3IgPSBudWxsOwoJICAgIHRoaXMub25waW5nID0gbnVsbDsKCSAgICB0aGlzLm9ucG9uZyA9IG51bGw7CgoJICAgIHRoaXMuc3RhdGUgPSBHRVRfSU5GTzsKCSAgfQoKCSAgLyoqCgkgICAqIENvbnN1bWVzIGJ5dGVzIGZyb20gdGhlIGF2YWlsYWJsZSBidWZmZXJlZCBkYXRhLgoJICAgKgoJICAgKiBAcGFyYW0ge051bWJlcn0gYnl0ZXMgVGhlIG51bWJlciBvZiBieXRlcyB0byBjb25zdW1lCgkgICAqIEByZXR1cm4ge0J1ZmZlcn0gQ29uc3VtZWQgYnl0ZXMKCSAgICogQHByaXZhdGUKCSAgICovCgkgIHJlYWRCdWZmZXIgKGJ5dGVzKSB7CgkgICAgdmFyIG9mZnNldCA9IDA7CgkgICAgdmFyIGRzdDsKCSAgICB2YXIgbDsKCgkgICAgdGhpcy5idWZmZXJlZEJ5dGVzIC09IGJ5dGVzOwoKCSAgICBpZiAoYnl0ZXMgPT09IHRoaXMuYnVmZmVyc1swXS5sZW5ndGgpIHJldHVybiB0aGlzLmJ1ZmZlcnMuc2hpZnQoKTsKCgkgICAgaWYgKGJ5dGVzIDwgdGhpcy5idWZmZXJzWzBdLmxlbmd0aCkgewoJICAgICAgZHN0ID0gdGhpcy5idWZmZXJzWzBdLnNsaWNlKDAsIGJ5dGVzKTsKCSAgICAgIHRoaXMuYnVmZmVyc1swXSA9IHRoaXMuYnVmZmVyc1swXS5zbGljZShieXRlcyk7CgkgICAgICByZXR1cm4gZHN0OwoJICAgIH0KCgkgICAgZHN0ID0gbmV3IEJ1ZmZlcihieXRlcyk7CgoJICAgIHdoaWxlIChieXRlcyA+IDApIHsKCSAgICAgIGwgPSB0aGlzLmJ1ZmZlcnNbMF0ubGVuZ3RoOwoKCSAgICAgIGlmIChieXRlcyA+PSBsKSB7CgkgICAgICAgIHRoaXMuYnVmZmVyc1swXS5jb3B5KGRzdCwgb2Zmc2V0KTsKCSAgICAgICAgb2Zmc2V0ICs9IGw7CgkgICAgICAgIHRoaXMuYnVmZmVycy5zaGlmdCgpOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgdGhpcy5idWZmZXJzWzBdLmNvcHkoZHN0LCBvZmZzZXQsIDAsIGJ5dGVzKTsKCSAgICAgICAgdGhpcy5idWZmZXJzWzBdID0gdGhpcy5idWZmZXJzWzBdLnNsaWNlKGJ5dGVzKTsKCSAgICAgIH0KCgkgICAgICBieXRlcyAtPSBsOwoJICAgIH0KCgkgICAgcmV0dXJuIGRzdDsKCSAgfQoKCSAgLyoqCgkgICAqIENoZWNrcyBpZiB0aGUgbnVtYmVyIG9mIGJ1ZmZlcmVkIGJ5dGVzIGlzIGJpZ2dlciBvciBlcXVhbCB0aGFuIGBuYCBhbmQKCSAgICogY2FsbHMgYGNsZWFudXBgIGlmIG5lY2Vzc2FyeS4KCSAgICoKCSAgICogQHBhcmFtIHtOdW1iZXJ9IG4gVGhlIG51bWJlciBvZiBieXRlcyB0byBjaGVjayBhZ2FpbnN0CgkgICAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiBgYnVmZmVyZWRCeXRlcyA+PSBuYCwgZWxzZSBgZmFsc2VgCgkgICAqIEBwcml2YXRlCgkgICAqLwoJICBoYXNCdWZmZXJlZEJ5dGVzIChuKSB7CgkgICAgaWYgKHRoaXMuYnVmZmVyZWRCeXRlcyA+PSBuKSByZXR1cm4gdHJ1ZTsKCgkgICAgdGhpcy5sb29wID0gZmFsc2U7CgkgICAgaWYgKHRoaXMuZGVhZCkgdGhpcy5jbGVhbnVwKHRoaXMuY2xlYW51cENhbGxiYWNrKTsKCSAgICByZXR1cm4gZmFsc2U7CgkgIH0KCgkgIC8qKgoJICAgKiBBZGRzIG5ldyBkYXRhIHRvIHRoZSBwYXJzZXIuCgkgICAqCgkgICAqIEBwdWJsaWMKCSAgICovCgkgIGFkZCAoZGF0YSkgewoJICAgIGlmICh0aGlzLmRlYWQpIHJldHVybjsKCgkgICAgdGhpcy5idWZmZXJlZEJ5dGVzICs9IGRhdGEubGVuZ3RoOwoJICAgIHRoaXMuYnVmZmVycy5wdXNoKGRhdGEpOwoJICAgIHRoaXMuc3RhcnRMb29wKCk7CgkgIH0KCgkgIC8qKgoJICAgKiBTdGFydHMgdGhlIHBhcnNpbmcgbG9vcC4KCSAgICoKCSAgICogQHByaXZhdGUKCSAgICovCgkgIHN0YXJ0TG9vcCAoKSB7CgkgICAgdGhpcy5sb29wID0gdHJ1ZTsKCgkgICAgd2hpbGUgKHRoaXMubG9vcCkgewoJICAgICAgc3dpdGNoICh0aGlzLnN0YXRlKSB7CgkgICAgICAgIGNhc2UgR0VUX0lORk86CgkgICAgICAgICAgdGhpcy5nZXRJbmZvKCk7CgkgICAgICAgICAgYnJlYWs7CgkgICAgICAgIGNhc2UgR0VUX1BBWUxPQURfTEVOR1RIXzE2OgoJICAgICAgICAgIHRoaXMuZ2V0UGF5bG9hZExlbmd0aDE2KCk7CgkgICAgICAgICAgYnJlYWs7CgkgICAgICAgIGNhc2UgR0VUX1BBWUxPQURfTEVOR1RIXzY0OgoJICAgICAgICAgIHRoaXMuZ2V0UGF5bG9hZExlbmd0aDY0KCk7CgkgICAgICAgICAgYnJlYWs7CgkgICAgICAgIGNhc2UgR0VUX01BU0s6CgkgICAgICAgICAgdGhpcy5nZXRNYXNrKCk7CgkgICAgICAgICAgYnJlYWs7CgkgICAgICAgIGNhc2UgR0VUX0RBVEE6CgkgICAgICAgICAgdGhpcy5nZXREYXRhKCk7CgkgICAgICAgICAgYnJlYWs7CgkgICAgICAgIGRlZmF1bHQ6IC8vIGBJTkZMQVRJTkdgCgkgICAgICAgICAgdGhpcy5sb29wID0gZmFsc2U7CgkgICAgICB9CgkgICAgfQoJICB9CgoJICAvKioKCSAgICogUmVhZHMgdGhlIGZpcnN0IHR3byBieXRlcyBvZiBhIGZyYW1lLgoJICAgKgoJICAgKiBAcHJpdmF0ZQoJICAgKi8KCSAgZ2V0SW5mbyAoKSB7CgkgICAgaWYgKCF0aGlzLmhhc0J1ZmZlcmVkQnl0ZXMoMikpIHJldHVybjsKCgkgICAgY29uc3QgYnVmID0gdGhpcy5yZWFkQnVmZmVyKDIpOwoKCSAgICBpZiAoKGJ1ZlswXSAmIDB4MzApICE9PSAweDAwKSB7CgkgICAgICB0aGlzLmVycm9yKG5ldyBFcnJvcignUlNWMiBhbmQgUlNWMyBtdXN0IGJlIGNsZWFyJyksIDEwMDIpOwoJICAgICAgcmV0dXJuOwoJICAgIH0KCgkgICAgY29uc3QgY29tcHJlc3NlZCA9IChidWZbMF0gJiAweDQwKSA9PT0gMHg0MDsKCgkgICAgaWYgKGNvbXByZXNzZWQgJiYgIXRoaXMuZXh0ZW5zaW9uc1tQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXSkgewoJICAgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoJ1JTVjEgbXVzdCBiZSBjbGVhcicpLCAxMDAyKTsKCSAgICAgIHJldHVybjsKCSAgICB9CgoJICAgIHRoaXMuZmluID0gKGJ1ZlswXSAmIDB4ODApID09PSAweDgwOwoJICAgIHRoaXMub3Bjb2RlID0gYnVmWzBdICYgMHgwZjsKCSAgICB0aGlzLnBheWxvYWRMZW5ndGggPSBidWZbMV0gJiAweDdmOwoKCSAgICBpZiAodGhpcy5vcGNvZGUgPT09IDB4MDApIHsKCSAgICAgIGlmIChjb21wcmVzc2VkKSB7CgkgICAgICAgIHRoaXMuZXJyb3IobmV3IEVycm9yKCdSU1YxIG11c3QgYmUgY2xlYXInKSwgMTAwMik7CgkgICAgICAgIHJldHVybjsKCSAgICAgIH0KCgkgICAgICBpZiAoIXRoaXMuZnJhZ21lbnRlZCkgewoJICAgICAgICB0aGlzLmVycm9yKG5ldyBFcnJvcihgaW52YWxpZCBvcGNvZGU6ICR7dGhpcy5vcGNvZGV9YCksIDEwMDIpOwoJICAgICAgICByZXR1cm47CgkgICAgICB9IGVsc2UgewoJICAgICAgICB0aGlzLm9wY29kZSA9IHRoaXMuZnJhZ21lbnRlZDsKCSAgICAgIH0KCSAgICB9IGVsc2UgaWYgKHRoaXMub3Bjb2RlID09PSAweDAxIHx8IHRoaXMub3Bjb2RlID09PSAweDAyKSB7CgkgICAgICBpZiAodGhpcy5mcmFnbWVudGVkKSB7CgkgICAgICAgIHRoaXMuZXJyb3IobmV3IEVycm9yKGBpbnZhbGlkIG9wY29kZTogJHt0aGlzLm9wY29kZX1gKSwgMTAwMik7CgkgICAgICAgIHJldHVybjsKCSAgICAgIH0KCgkgICAgICB0aGlzLmNvbXByZXNzZWQgPSBjb21wcmVzc2VkOwoJICAgIH0gZWxzZSBpZiAodGhpcy5vcGNvZGUgPiAweDA3ICYmIHRoaXMub3Bjb2RlIDwgMHgwYikgewoJICAgICAgaWYgKCF0aGlzLmZpbikgewoJICAgICAgICB0aGlzLmVycm9yKG5ldyBFcnJvcignRklOIG11c3QgYmUgc2V0JyksIDEwMDIpOwoJICAgICAgICByZXR1cm47CgkgICAgICB9CgoJICAgICAgaWYgKGNvbXByZXNzZWQpIHsKCSAgICAgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoJ1JTVjEgbXVzdCBiZSBjbGVhcicpLCAxMDAyKTsKCSAgICAgICAgcmV0dXJuOwoJICAgICAgfQoKCSAgICAgIGlmICh0aGlzLnBheWxvYWRMZW5ndGggPiAweDdkKSB7CgkgICAgICAgIHRoaXMuZXJyb3IobmV3IEVycm9yKCdpbnZhbGlkIHBheWxvYWQgbGVuZ3RoJyksIDEwMDIpOwoJICAgICAgICByZXR1cm47CgkgICAgICB9CgkgICAgfSBlbHNlIHsKCSAgICAgIHRoaXMuZXJyb3IobmV3IEVycm9yKGBpbnZhbGlkIG9wY29kZTogJHt0aGlzLm9wY29kZX1gKSwgMTAwMik7CgkgICAgICByZXR1cm47CgkgICAgfQoKCSAgICBpZiAoIXRoaXMuZmluICYmICF0aGlzLmZyYWdtZW50ZWQpIHRoaXMuZnJhZ21lbnRlZCA9IHRoaXMub3Bjb2RlOwoKCSAgICB0aGlzLm1hc2tlZCA9IChidWZbMV0gJiAweDgwKSA9PT0gMHg4MDsKCgkgICAgaWYgKHRoaXMucGF5bG9hZExlbmd0aCA9PT0gMTI2KSB0aGlzLnN0YXRlID0gR0VUX1BBWUxPQURfTEVOR1RIXzE2OwoJICAgIGVsc2UgaWYgKHRoaXMucGF5bG9hZExlbmd0aCA9PT0gMTI3KSB0aGlzLnN0YXRlID0gR0VUX1BBWUxPQURfTEVOR1RIXzY0OwoJICAgIGVsc2UgdGhpcy5oYXZlTGVuZ3RoKCk7CgkgIH0KCgkgIC8qKgoJICAgKiBHZXRzIGV4dGVuZGVkIHBheWxvYWQgbGVuZ3RoICg3KzE2KS4KCSAgICoKCSAgICogQHByaXZhdGUKCSAgICovCgkgIGdldFBheWxvYWRMZW5ndGgxNiAoKSB7CgkgICAgaWYgKCF0aGlzLmhhc0J1ZmZlcmVkQnl0ZXMoMikpIHJldHVybjsKCgkgICAgdGhpcy5wYXlsb2FkTGVuZ3RoID0gdGhpcy5yZWFkQnVmZmVyKDIpLnJlYWRVSW50MTZCRSgwLCB0cnVlKTsKCSAgICB0aGlzLmhhdmVMZW5ndGgoKTsKCSAgfQoKCSAgLyoqCgkgICAqIEdldHMgZXh0ZW5kZWQgcGF5bG9hZCBsZW5ndGggKDcrNjQpLgoJICAgKgoJICAgKiBAcHJpdmF0ZQoJICAgKi8KCSAgZ2V0UGF5bG9hZExlbmd0aDY0ICgpIHsKCSAgICBpZiAoIXRoaXMuaGFzQnVmZmVyZWRCeXRlcyg4KSkgcmV0dXJuOwoKCSAgICBjb25zdCBidWYgPSB0aGlzLnJlYWRCdWZmZXIoOCk7CgkgICAgY29uc3QgbnVtID0gYnVmLnJlYWRVSW50MzJCRSgwLCB0cnVlKTsKCgkgICAgLy8KCSAgICAvLyBUaGUgbWF4aW11bSBzYWZlIGludGVnZXIgaW4gSmF2YVNjcmlwdCBpcyAyXjUzIC0gMS4gQW4gZXJyb3IgaXMgcmV0dXJuZWQKCSAgICAvLyBpZiBwYXlsb2FkIGxlbmd0aCBpcyBncmVhdGVyIHRoYW4gdGhpcyBudW1iZXIuCgkgICAgLy8KCSAgICBpZiAobnVtID4gTWF0aC5wb3coMiwgNTMgLSAzMikgLSAxKSB7CgkgICAgICB0aGlzLmVycm9yKG5ldyBFcnJvcignbWF4IHBheWxvYWQgc2l6ZSBleGNlZWRlZCcpLCAxMDA5KTsKCSAgICAgIHJldHVybjsKCSAgICB9CgoJICAgIHRoaXMucGF5bG9hZExlbmd0aCA9IG51bSAqIE1hdGgucG93KDIsIDMyKSArIGJ1Zi5yZWFkVUludDMyQkUoNCwgdHJ1ZSk7CgkgICAgdGhpcy5oYXZlTGVuZ3RoKCk7CgkgIH0KCgkgIC8qKgoJICAgKiBQYXlsb2FkIGxlbmd0aCBoYXMgYmVlbiByZWFkLgoJICAgKgoJICAgKiBAcHJpdmF0ZQoJICAgKi8KCSAgaGF2ZUxlbmd0aCAoKSB7CgkgICAgaWYgKHRoaXMub3Bjb2RlIDwgMHgwOCAmJiB0aGlzLm1heFBheWxvYWRFeGNlZWRlZCh0aGlzLnBheWxvYWRMZW5ndGgpKSB7CgkgICAgICByZXR1cm47CgkgICAgfQoKCSAgICBpZiAodGhpcy5tYXNrZWQpIHRoaXMuc3RhdGUgPSBHRVRfTUFTSzsKCSAgICBlbHNlIHRoaXMuc3RhdGUgPSBHRVRfREFUQTsKCSAgfQoKCSAgLyoqCgkgICAqIFJlYWRzIG1hc2sgYnl0ZXMuCgkgICAqCgkgICAqIEBwcml2YXRlCgkgICAqLwoJICBnZXRNYXNrICgpIHsKCSAgICBpZiAoIXRoaXMuaGFzQnVmZmVyZWRCeXRlcyg0KSkgcmV0dXJuOwoKCSAgICB0aGlzLm1hc2sgPSB0aGlzLnJlYWRCdWZmZXIoNCk7CgkgICAgdGhpcy5zdGF0ZSA9IEdFVF9EQVRBOwoJICB9CgoJICAvKioKCSAgICogUmVhZHMgZGF0YSBieXRlcy4KCSAgICoKCSAgICogQHByaXZhdGUKCSAgICovCgkgIGdldERhdGEgKCkgewoJICAgIHZhciBkYXRhID0gRU1QVFlfQlVGRkVSOwoKCSAgICBpZiAodGhpcy5wYXlsb2FkTGVuZ3RoKSB7CgkgICAgICBpZiAoIXRoaXMuaGFzQnVmZmVyZWRCeXRlcyh0aGlzLnBheWxvYWRMZW5ndGgpKSByZXR1cm47CgoJICAgICAgZGF0YSA9IHRoaXMucmVhZEJ1ZmZlcih0aGlzLnBheWxvYWRMZW5ndGgpOwoJICAgICAgaWYgKHRoaXMubWFza2VkKSBidWZmZXJVdGlsLnVubWFzayhkYXRhLCB0aGlzLm1hc2spOwoJICAgIH0KCgkgICAgaWYgKHRoaXMub3Bjb2RlID4gMHgwNykgewoJICAgICAgdGhpcy5jb250cm9sTWVzc2FnZShkYXRhKTsKCSAgICB9IGVsc2UgaWYgKHRoaXMuY29tcHJlc3NlZCkgewoJICAgICAgdGhpcy5zdGF0ZSA9IElORkxBVElORzsKCSAgICAgIHRoaXMuZGVjb21wcmVzcyhkYXRhKTsKCSAgICB9IGVsc2UgaWYgKHRoaXMucHVzaEZyYWdtZW50KGRhdGEpKSB7CgkgICAgICB0aGlzLmRhdGFNZXNzYWdlKCk7CgkgICAgfQoJICB9CgoJICAvKioKCSAgICogRGVjb21wcmVzc2VzIGRhdGEuCgkgICAqCgkgICAqIEBwYXJhbSB7QnVmZmVyfSBkYXRhIENvbXByZXNzZWQgZGF0YQoJICAgKiBAcHJpdmF0ZQoJICAgKi8KCSAgZGVjb21wcmVzcyAoZGF0YSkgewoJICAgIGNvbnN0IGV4dGVuc2lvbiA9IHRoaXMuZXh0ZW5zaW9uc1tQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXTsKCgkgICAgZXh0ZW5zaW9uLmRlY29tcHJlc3MoZGF0YSwgdGhpcy5maW4sIChlcnIsIGJ1ZikgPT4gewoJICAgICAgaWYgKGVycikgewoJICAgICAgICB0aGlzLmVycm9yKGVyciwgZXJyLmNsb3NlQ29kZSA9PT0gMTAwOSA/IDEwMDkgOiAxMDA3KTsKCSAgICAgICAgcmV0dXJuOwoJICAgICAgfQoKCSAgICAgIGlmICh0aGlzLnB1c2hGcmFnbWVudChidWYpKSB0aGlzLmRhdGFNZXNzYWdlKCk7CgkgICAgICB0aGlzLnN0YXJ0TG9vcCgpOwoJICAgIH0pOwoJICB9CgoJICAvKioKCSAgICogSGFuZGxlcyBhIGRhdGEgbWVzc2FnZS4KCSAgICoKCSAgICogQHByaXZhdGUKCSAgICovCgkgIGRhdGFNZXNzYWdlICgpIHsKCSAgICBpZiAodGhpcy5maW4pIHsKCSAgICAgIGNvbnN0IGJ1ZiA9IHRoaXMuZnJhZ21lbnRzLmxlbmd0aCA+IDEKCSAgICAgICAgPyBCdWZmZXIuY29uY2F0KHRoaXMuZnJhZ21lbnRzLCB0aGlzLm1lc3NhZ2VMZW5ndGgpCgkgICAgICAgIDogdGhpcy5mcmFnbWVudHMubGVuZ3RoID09PSAxCgkgICAgICAgICAgPyB0aGlzLmZyYWdtZW50c1swXQoJICAgICAgICAgIDogRU1QVFlfQlVGRkVSOwoKCSAgICAgIHRoaXMudG90YWxQYXlsb2FkTGVuZ3RoID0gMDsKCSAgICAgIHRoaXMuZnJhZ21lbnRzLmxlbmd0aCA9IDA7CgkgICAgICB0aGlzLm1lc3NhZ2VMZW5ndGggPSAwOwoJICAgICAgdGhpcy5mcmFnbWVudGVkID0gMDsKCgkgICAgICBpZiAodGhpcy5vcGNvZGUgPT09IDIpIHsKCSAgICAgICAgdGhpcy5vbm1lc3NhZ2UoYnVmLCB7IG1hc2tlZDogdGhpcy5tYXNrZWQsIGJpbmFyeTogdHJ1ZSB9KTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGlmICghaXNWYWxpZFVURjgoYnVmKSkgewoJICAgICAgICAgIHRoaXMuZXJyb3IobmV3IEVycm9yKCdpbnZhbGlkIHV0Zjggc2VxdWVuY2UnKSwgMTAwNyk7CgkgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgoJICAgICAgICB0aGlzLm9ubWVzc2FnZShidWYudG9TdHJpbmcoKSwgeyBtYXNrZWQ6IHRoaXMubWFza2VkIH0pOwoJICAgICAgfQoJICAgIH0KCgkgICAgdGhpcy5zdGF0ZSA9IEdFVF9JTkZPOwoJICB9CgoJICAvKioKCSAgICogSGFuZGxlcyBhIGNvbnRyb2wgbWVzc2FnZS4KCSAgICoKCSAgICogQHBhcmFtIHtCdWZmZXJ9IGRhdGEgRGF0YSB0byBoYW5kbGUKCSAgICogQHByaXZhdGUKCSAgICovCgkgIGNvbnRyb2xNZXNzYWdlIChkYXRhKSB7CgkgICAgaWYgKHRoaXMub3Bjb2RlID09PSAweDA4KSB7CgkgICAgICBpZiAoZGF0YS5sZW5ndGggPT09IDApIHsKCSAgICAgICAgdGhpcy5vbmNsb3NlKDEwMDAsICcnLCB7IG1hc2tlZDogdGhpcy5tYXNrZWQgfSk7CgkgICAgICAgIHRoaXMubG9vcCA9IGZhbHNlOwoJICAgICAgICB0aGlzLmNsZWFudXAodGhpcy5jbGVhbnVwQ2FsbGJhY2spOwoJICAgICAgfSBlbHNlIGlmIChkYXRhLmxlbmd0aCA9PT0gMSkgewoJICAgICAgICB0aGlzLmVycm9yKG5ldyBFcnJvcignaW52YWxpZCBwYXlsb2FkIGxlbmd0aCcpLCAxMDAyKTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGNvbnN0IGNvZGUgPSBkYXRhLnJlYWRVSW50MTZCRSgwLCB0cnVlKTsKCgkgICAgICAgIGlmICghRXJyb3JDb2Rlcy5pc1ZhbGlkRXJyb3JDb2RlKGNvZGUpKSB7CgkgICAgICAgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoYGludmFsaWQgc3RhdHVzIGNvZGU6ICR7Y29kZX1gKSwgMTAwMik7CgkgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgoJICAgICAgICBjb25zdCBidWYgPSBkYXRhLnNsaWNlKDIpOwoKCSAgICAgICAgaWYgKCFpc1ZhbGlkVVRGOChidWYpKSB7CgkgICAgICAgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoJ2ludmFsaWQgdXRmOCBzZXF1ZW5jZScpLCAxMDA3KTsKCSAgICAgICAgICByZXR1cm47CgkgICAgICAgIH0KCgkgICAgICAgIHRoaXMub25jbG9zZShjb2RlLCBidWYudG9TdHJpbmcoKSwgeyBtYXNrZWQ6IHRoaXMubWFza2VkIH0pOwoJICAgICAgICB0aGlzLmxvb3AgPSBmYWxzZTsKCSAgICAgICAgdGhpcy5jbGVhbnVwKHRoaXMuY2xlYW51cENhbGxiYWNrKTsKCSAgICAgIH0KCgkgICAgICByZXR1cm47CgkgICAgfQoKCSAgICBjb25zdCBmbGFncyA9IHsgbWFza2VkOiB0aGlzLm1hc2tlZCwgYmluYXJ5OiB0cnVlIH07CgoJICAgIGlmICh0aGlzLm9wY29kZSA9PT0gMHgwOSkgdGhpcy5vbnBpbmcoZGF0YSwgZmxhZ3MpOwoJICAgIGVsc2UgdGhpcy5vbnBvbmcoZGF0YSwgZmxhZ3MpOwoKCSAgICB0aGlzLnN0YXRlID0gR0VUX0lORk87CgkgIH0KCgkgIC8qKgoJICAgKiBIYW5kbGVzIGFuIGVycm9yLgoJICAgKgoJICAgKiBAcGFyYW0ge0Vycm9yfSBlcnIgVGhlIGVycm9yCgkgICAqIEBwYXJhbSB7TnVtYmVyfSBjb2RlIENsb3NlIGNvZGUKCSAgICogQHByaXZhdGUKCSAgICovCgkgIGVycm9yIChlcnIsIGNvZGUpIHsKCSAgICB0aGlzLm9uZXJyb3IoZXJyLCBjb2RlKTsKCSAgICB0aGlzLmhhZEVycm9yID0gdHJ1ZTsKCSAgICB0aGlzLmxvb3AgPSBmYWxzZTsKCSAgICB0aGlzLmNsZWFudXAodGhpcy5jbGVhbnVwQ2FsbGJhY2spOwoJICB9CgoJICAvKioKCSAgICogQ2hlY2tzIHBheWxvYWQgc2l6ZSwgZGlzY29ubmVjdHMgc29ja2V0IHdoZW4gaXQgZXhjZWVkcyBgbWF4UGF5bG9hZGAuCgkgICAqCgkgICAqIEBwYXJhbSB7TnVtYmVyfSBsZW5ndGggUGF5bG9hZCBsZW5ndGgKCSAgICogQHByaXZhdGUKCSAgICovCgkgIG1heFBheWxvYWRFeGNlZWRlZCAobGVuZ3RoKSB7CgkgICAgaWYgKGxlbmd0aCA9PT0gMCB8fCB0aGlzLm1heFBheWxvYWQgPCAxKSByZXR1cm4gZmFsc2U7CgoJICAgIGNvbnN0IGZ1bGxMZW5ndGggPSB0aGlzLnRvdGFsUGF5bG9hZExlbmd0aCArIGxlbmd0aDsKCgkgICAgaWYgKGZ1bGxMZW5ndGggPD0gdGhpcy5tYXhQYXlsb2FkKSB7CgkgICAgICB0aGlzLnRvdGFsUGF5bG9hZExlbmd0aCA9IGZ1bGxMZW5ndGg7CgkgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfQoKCSAgICB0aGlzLmVycm9yKG5ldyBFcnJvcignbWF4IHBheWxvYWQgc2l6ZSBleGNlZWRlZCcpLCAxMDA5KTsKCSAgICByZXR1cm4gdHJ1ZTsKCSAgfQoKCSAgLyoqCgkgICAqIEFwcGVuZHMgYSBmcmFnbWVudCBpbiB0aGUgZnJhZ21lbnRzIGFycmF5IGFmdGVyIGNoZWNraW5nIHRoYXQgdGhlIHN1bSBvZgoJICAgKiBmcmFnbWVudCBsZW5ndGhzIGRvZXMgbm90IGV4Y2VlZCBgbWF4UGF5bG9hZGAuCgkgICAqCgkgICAqIEBwYXJhbSB7QnVmZmVyfSBmcmFnbWVudCBUaGUgZnJhZ21lbnQgdG8gYWRkCgkgICAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiBgbWF4UGF5bG9hZGAgaXMgbm90IGV4Y2VlZGVkLCBlbHNlIGBmYWxzZWAKCSAgICogQHByaXZhdGUKCSAgICovCgkgIHB1c2hGcmFnbWVudCAoZnJhZ21lbnQpIHsKCSAgICBpZiAoZnJhZ21lbnQubGVuZ3RoID09PSAwKSByZXR1cm4gdHJ1ZTsKCgkgICAgY29uc3QgdG90YWxMZW5ndGggPSB0aGlzLm1lc3NhZ2VMZW5ndGggKyBmcmFnbWVudC5sZW5ndGg7CgoJICAgIGlmICh0aGlzLm1heFBheWxvYWQgPCAxIHx8IHRvdGFsTGVuZ3RoIDw9IHRoaXMubWF4UGF5bG9hZCkgewoJICAgICAgdGhpcy5tZXNzYWdlTGVuZ3RoID0gdG90YWxMZW5ndGg7CgkgICAgICB0aGlzLmZyYWdtZW50cy5wdXNoKGZyYWdtZW50KTsKCSAgICAgIHJldHVybiB0cnVlOwoJICAgIH0KCgkgICAgdGhpcy5lcnJvcihuZXcgRXJyb3IoJ21heCBwYXlsb2FkIHNpemUgZXhjZWVkZWQnKSwgMTAwOSk7CgkgICAgcmV0dXJuIGZhbHNlOwoJICB9CgoJICAvKioKCSAgICogUmVsZWFzZXMgcmVzb3VyY2VzIHVzZWQgYnkgdGhlIHJlY2VpdmVyLgoJICAgKgoJICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYiBDYWxsYmFjawoJICAgKiBAcHVibGljCgkgICAqLwoJICBjbGVhbnVwIChjYikgewoJICAgIHRoaXMuZGVhZCA9IHRydWU7CgoJICAgIGlmICghdGhpcy5oYWRFcnJvciAmJiAodGhpcy5sb29wIHx8IHRoaXMuc3RhdGUgPT09IElORkxBVElORykpIHsKCSAgICAgIHRoaXMuY2xlYW51cENhbGxiYWNrID0gY2I7CgkgICAgfSBlbHNlIHsKCSAgICAgIHRoaXMuZXh0ZW5zaW9ucyA9IG51bGw7CgkgICAgICB0aGlzLmZyYWdtZW50cyA9IG51bGw7CgkgICAgICB0aGlzLmJ1ZmZlcnMgPSBudWxsOwoJICAgICAgdGhpcy5tYXNrID0gbnVsbDsKCgkgICAgICB0aGlzLmNsZWFudXBDYWxsYmFjayA9IG51bGw7CgkgICAgICB0aGlzLm9ubWVzc2FnZSA9IG51bGw7CgkgICAgICB0aGlzLm9uY2xvc2UgPSBudWxsOwoJICAgICAgdGhpcy5vbmVycm9yID0gbnVsbDsKCSAgICAgIHRoaXMub25waW5nID0gbnVsbDsKCSAgICAgIHRoaXMub25wb25nID0gbnVsbDsKCgkgICAgICBpZiAoY2IpIGNiKCk7CgkgICAgfQoJICB9Cgl9CgoJbW9kdWxlLmV4cG9ydHMgPSBSZWNlaXZlcjsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5CdWZmZXIpKQoKLyoqKi8gfSwKLyogOTYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyohCgkgKiB3czogYSBub2RlLmpzIHdlYnNvY2tldCBjbGllbnQKCSAqIENvcHlyaWdodChjKSAyMDExIEVpbmFyIE90dG8gU3Rhbmd2aWsgPGVpbmFyb3NAZ21haWwuY29tPgoJICogTUlUIExpY2Vuc2VkCgkgKi8KCgkndXNlIHN0cmljdCc7CgoJdHJ5IHsKCSAgY29uc3QgaXNWYWxpZFVURjggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk3KTsKCgkgIG1vZHVsZS5leHBvcnRzID0gdHlwZW9mIGlzVmFsaWRVVEY4ID09PSAnb2JqZWN0JwoJICAgID8gaXNWYWxpZFVURjguVmFsaWRhdGlvbi5pc1ZhbGlkVVRGOCAgLy8gdXRmLTgtdmFsaWRhdGVAPDMuMC4wCgkgICAgOiBpc1ZhbGlkVVRGODsKCX0gY2F0Y2ggKGUpIHsKCSAgbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNCk7Cgl9CgoKLyoqKi8gfSwKLyogOTcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCXRyeSB7CgkgIG1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5OCkoJ3ZhbGlkYXRpb24nKTsKCX0gY2F0Y2ggKGUpIHsKCSAgbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMyk7Cgl9CgoKLyoqKi8gfSwKLyogOTggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKHByb2Nlc3MsIF9fZmlsZW5hbWUpIHsKCS8qKgoJICogTW9kdWxlIGRlcGVuZGVuY2llcy4KCSAqLwoKCXZhciBmcyA9IF9fd2VicGFja19yZXF1aXJlX18oIShmdW5jdGlvbiB3ZWJwYWNrTWlzc2luZ01vZHVsZSgpIHsgdmFyIGUgPSBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSBcImZzXCIiKTsgZS5jb2RlID0gJ01PRFVMRV9OT1RfRk9VTkQnOyB0aHJvdyBlOyB9KCkpKQoJICAsIHBhdGggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KQoJICAsIGpvaW4gPSBwYXRoLmpvaW4KCSAgLCBkaXJuYW1lID0gcGF0aC5kaXJuYW1lCgkgICwgZXhpc3RzID0gZnMuZXhpc3RzU3luYyB8fCBwYXRoLmV4aXN0c1N5bmMKCSAgLCBkZWZhdWx0cyA9IHsKCSAgICAgICAgYXJyb3c6IHByb2Nlc3MuZW52Lk5PREVfQklORElOR1NfQVJST1cgfHwgJyDihpIgJwoJICAgICAgLCBjb21waWxlZDogcHJvY2Vzcy5lbnYuTk9ERV9CSU5ESU5HU19DT01QSUxFRF9ESVIgfHwgJ2NvbXBpbGVkJwoJICAgICAgLCBwbGF0Zm9ybTogcHJvY2Vzcy5wbGF0Zm9ybQoJICAgICAgLCBhcmNoOiBwcm9jZXNzLmFyY2gKCSAgICAgICwgdmVyc2lvbjogcHJvY2Vzcy52ZXJzaW9ucy5ub2RlCgkgICAgICAsIGJpbmRpbmdzOiAnYmluZGluZ3Mubm9kZScKCSAgICAgICwgdHJ5OiBbCgkgICAgICAgICAgLy8gbm9kZS1neXAncyBsaW5rZWQgdmVyc2lvbiBpbiB0aGUgImJ1aWxkIiBkaXIKCSAgICAgICAgICBbICdtb2R1bGVfcm9vdCcsICdidWlsZCcsICdiaW5kaW5ncycgXQoJICAgICAgICAgIC8vIG5vZGUtd2FmIGFuZCBneXBfYWRkb24gKGEuay5hIG5vZGUtZ3lwKQoJICAgICAgICAsIFsgJ21vZHVsZV9yb290JywgJ2J1aWxkJywgJ0RlYnVnJywgJ2JpbmRpbmdzJyBdCgkgICAgICAgICwgWyAnbW9kdWxlX3Jvb3QnLCAnYnVpbGQnLCAnUmVsZWFzZScsICdiaW5kaW5ncycgXQoJICAgICAgICAgIC8vIERlYnVnIGZpbGVzLCBmb3IgZGV2ZWxvcG1lbnQgKGxlZ2FjeSBiZWhhdmlvciwgcmVtb3ZlIGZvciBub2RlIHYwLjkpCgkgICAgICAgICwgWyAnbW9kdWxlX3Jvb3QnLCAnb3V0JywgJ0RlYnVnJywgJ2JpbmRpbmdzJyBdCgkgICAgICAgICwgWyAnbW9kdWxlX3Jvb3QnLCAnRGVidWcnLCAnYmluZGluZ3MnIF0KCSAgICAgICAgICAvLyBSZWxlYXNlIGZpbGVzLCBidXQgbWFudWFsbHkgY29tcGlsZWQgKGxlZ2FjeSBiZWhhdmlvciwgcmVtb3ZlIGZvciBub2RlIHYwLjkpCgkgICAgICAgICwgWyAnbW9kdWxlX3Jvb3QnLCAnb3V0JywgJ1JlbGVhc2UnLCAnYmluZGluZ3MnIF0KCSAgICAgICAgLCBbICdtb2R1bGVfcm9vdCcsICdSZWxlYXNlJywgJ2JpbmRpbmdzJyBdCgkgICAgICAgICAgLy8gTGVnYWN5IGZyb20gbm9kZS13YWYsIG5vZGUgPD0gMC40LngKCSAgICAgICAgLCBbICdtb2R1bGVfcm9vdCcsICdidWlsZCcsICdkZWZhdWx0JywgJ2JpbmRpbmdzJyBdCgkgICAgICAgICAgLy8gUHJvZHVjdGlvbiAiUmVsZWFzZSIgYnVpbGR0eXBlIGJpbmFyeSAobWVoLi4uKQoJICAgICAgICAsIFsgJ21vZHVsZV9yb290JywgJ2NvbXBpbGVkJywgJ3ZlcnNpb24nLCAncGxhdGZvcm0nLCAnYXJjaCcsICdiaW5kaW5ncycgXQoJICAgICAgICBdCgkgICAgfQoKCS8qKgoJICogVGhlIG1haW4gYGJpbmRpbmdzKClgIGZ1bmN0aW9uIGxvYWRzIHRoZSBjb21waWxlZCBiaW5kaW5ncyBmb3IgYSBnaXZlbiBtb2R1bGUuCgkgKiBJdCB1c2VzIFY4J3MgRXJyb3IgQVBJIHRvIGRldGVybWluZSB0aGUgcGFyZW50IGZpbGVuYW1lIHRoYXQgdGhpcyBmdW5jdGlvbiBpcwoJICogYmVpbmcgaW52b2tlZCBmcm9tLCB3aGljaCBpcyB0aGVuIHVzZWQgdG8gZmluZCB0aGUgcm9vdCBkaXJlY3RvcnkuCgkgKi8KCglmdW5jdGlvbiBiaW5kaW5ncyAob3B0cykgewoKCSAgLy8gQXJndW1lbnQgc3VyZ2VyeQoJICBpZiAodHlwZW9mIG9wdHMgPT0gJ3N0cmluZycpIHsKCSAgICBvcHRzID0geyBiaW5kaW5nczogb3B0cyB9CgkgIH0gZWxzZSBpZiAoIW9wdHMpIHsKCSAgICBvcHRzID0ge30KCSAgfQoJICBvcHRzLl9fcHJvdG9fXyA9IGRlZmF1bHRzCgoJICAvLyBHZXQgdGhlIG1vZHVsZSByb290CgkgIGlmICghb3B0cy5tb2R1bGVfcm9vdCkgewoJICAgIG9wdHMubW9kdWxlX3Jvb3QgPSBleHBvcnRzLmdldFJvb3QoZXhwb3J0cy5nZXRGaWxlTmFtZSgpKQoJICB9CgoJICAvLyBFbnN1cmUgdGhlIGdpdmVuIGJpbmRpbmdzIG5hbWUgZW5kcyB3aXRoIC5ub2RlCgkgIGlmIChwYXRoLmV4dG5hbWUob3B0cy5iaW5kaW5ncykgIT0gJy5ub2RlJykgewoJICAgIG9wdHMuYmluZGluZ3MgKz0gJy5ub2RlJwoJICB9CgoJICB2YXIgdHJpZXMgPSBbXQoJICAgICwgaSA9IDAKCSAgICAsIGwgPSBvcHRzLnRyeS5sZW5ndGgKCSAgICAsIG4KCSAgICAsIGIKCSAgICAsIGVycgoKCSAgZm9yICg7IGk8bDsgaSsrKSB7CgkgICAgbiA9IGpvaW4uYXBwbHkobnVsbCwgb3B0cy50cnlbaV0ubWFwKGZ1bmN0aW9uIChwKSB7CgkgICAgICByZXR1cm4gb3B0c1twXSB8fCBwCgkgICAgfSkpCgkgICAgdHJpZXMucHVzaChuKQoJICAgIHRyeSB7CgkgICAgICBiID0gb3B0cy5wYXRoID8gLypyZXF1aXJlLnJlc29sdmUqLyhfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMCkucmVzb2x2ZShuKSkgOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMCkobikKCSAgICAgIGlmICghb3B0cy5wYXRoKSB7CgkgICAgICAgIGIucGF0aCA9IG4KCSAgICAgIH0KCSAgICAgIHJldHVybiBiCgkgICAgfSBjYXRjaCAoZSkgewoJICAgICAgaWYgKCEvbm90IGZpbmQvaS50ZXN0KGUubWVzc2FnZSkpIHsKCSAgICAgICAgdGhyb3cgZQoJICAgICAgfQoJICAgIH0KCSAgfQoKCSAgZXJyID0gbmV3IEVycm9yKCdDb3VsZCBub3QgbG9jYXRlIHRoZSBiaW5kaW5ncyBmaWxlLiBUcmllZDpcbicKCSAgICArIHRyaWVzLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gb3B0cy5hcnJvdyArIGEgfSkuam9pbignXG4nKSkKCSAgZXJyLnRyaWVzID0gdHJpZXMKCSAgdGhyb3cgZXJyCgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHMgPSBiaW5kaW5ncwoKCgkvKioKCSAqIEdldHMgdGhlIGZpbGVuYW1lIG9mIHRoZSBKYXZhU2NyaXB0IGZpbGUgdGhhdCBpbnZva2VzIHRoaXMgZnVuY3Rpb24uCgkgKiBVc2VkIHRvIGhlbHAgZmluZCB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgYSBtb2R1bGUuCgkgKiBPcHRpb25hbGx5IGFjY2VwdHMgYW4gZmlsZW5hbWUgYXJndW1lbnQgdG8gc2tpcCB3aGVuIHNlYXJjaGluZyBmb3IgdGhlIGludm9raW5nIGZpbGVuYW1lCgkgKi8KCglleHBvcnRzLmdldEZpbGVOYW1lID0gZnVuY3Rpb24gZ2V0RmlsZU5hbWUgKGNhbGxpbmdfZmlsZSkgewoJICB2YXIgb3JpZ1BTVCA9IEVycm9yLnByZXBhcmVTdGFja1RyYWNlCgkgICAgLCBvcmlnU1RMID0gRXJyb3Iuc3RhY2tUcmFjZUxpbWl0CgkgICAgLCBkdW1teSA9IHt9CgkgICAgLCBmaWxlTmFtZQoKCSAgRXJyb3Iuc3RhY2tUcmFjZUxpbWl0ID0gMTAKCgkgIEVycm9yLnByZXBhcmVTdGFja1RyYWNlID0gZnVuY3Rpb24gKGUsIHN0KSB7CgkgICAgZm9yICh2YXIgaT0wLCBsPXN0Lmxlbmd0aDsgaTxsOyBpKyspIHsKCSAgICAgIGZpbGVOYW1lID0gc3RbaV0uZ2V0RmlsZU5hbWUoKQoJICAgICAgaWYgKGZpbGVOYW1lICE9PSBfX2ZpbGVuYW1lKSB7CgkgICAgICAgIGlmIChjYWxsaW5nX2ZpbGUpIHsKCSAgICAgICAgICAgIGlmIChmaWxlTmFtZSAhPT0gY2FsbGluZ19maWxlKSB7CgkgICAgICAgICAgICAgIHJldHVybgoJICAgICAgICAgICAgfQoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgIHJldHVybgoJICAgICAgICB9CgkgICAgICB9CgkgICAgfQoJICB9CgoJICAvLyBydW4gdGhlICdwcmVwYXJlU3RhY2tUcmFjZScgZnVuY3Rpb24gYWJvdmUKCSAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoZHVtbXkpCgkgIGR1bW15LnN0YWNrCgoJICAvLyBjbGVhbnVwCgkgIEVycm9yLnByZXBhcmVTdGFja1RyYWNlID0gb3JpZ1BTVAoJICBFcnJvci5zdGFja1RyYWNlTGltaXQgPSBvcmlnU1RMCgoJICByZXR1cm4gZmlsZU5hbWUKCX0KCgkvKioKCSAqIEdldHMgdGhlIHJvb3QgZGlyZWN0b3J5IG9mIGEgbW9kdWxlLCBnaXZlbiBhbiBhcmJpdHJhcnkgZmlsZW5hbWUKCSAqIHNvbWV3aGVyZSBpbiB0aGUgbW9kdWxlIHRyZWUuIFRoZSAicm9vdCBkaXJlY3RvcnkiIGlzIHRoZSBkaXJlY3RvcnkKCSAqIGNvbnRhaW5pbmcgdGhlIGBwYWNrYWdlLmpzb25gIGZpbGUuCgkgKgoJICogICBJbjogIC9ob21lL25hdGUvbm9kZS1uYXRpdmUtbW9kdWxlL2xpYi9pbmRleC5qcwoJICogICBPdXQ6IC9ob21lL25hdGUvbm9kZS1uYXRpdmUtbW9kdWxlCgkgKi8KCglleHBvcnRzLmdldFJvb3QgPSBmdW5jdGlvbiBnZXRSb290IChmaWxlKSB7CgkgIHZhciBkaXIgPSBkaXJuYW1lKGZpbGUpCgkgICAgLCBwcmV2CgkgIHdoaWxlICh0cnVlKSB7CgkgICAgaWYgKGRpciA9PT0gJy4nKSB7CgkgICAgICAvLyBBdm9pZHMgYW4gaW5maW5pdGUgbG9vcCBpbiByYXJlIGNhc2VzLCBsaWtlIHRoZSBSRVBMCgkgICAgICBkaXIgPSBwcm9jZXNzLmN3ZCgpCgkgICAgfQoJICAgIGlmIChleGlzdHMoam9pbihkaXIsICdwYWNrYWdlLmpzb24nKSkgfHwgZXhpc3RzKGpvaW4oZGlyLCAnbm9kZV9tb2R1bGVzJykpKSB7CgkgICAgICAvLyBGb3VuZCB0aGUgJ3BhY2thZ2UuanNvbicgZmlsZSBvciAnbm9kZV9tb2R1bGVzJyBkaXI7IHdlJ3JlIGRvbmUKCSAgICAgIHJldHVybiBkaXIKCSAgICB9CgkgICAgaWYgKHByZXYgPT09IGRpcikgewoJICAgICAgLy8gR290IHRvIHRoZSB0b3AKCSAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgbW9kdWxlIHJvb3QgZ2l2ZW4gZmlsZTogIicgKyBmaWxlCgkgICAgICAgICAgICAgICAgICAgICsgJyIuIERvIHlvdSBoYXZlIGEgYHBhY2thZ2UuanNvbmAgZmlsZT8gJykKCSAgICB9CgkgICAgLy8gVHJ5IHRoZSBwYXJlbnQgZGlyIG5leHQKCSAgICBwcmV2ID0gZGlyCgkgICAgZGlyID0gam9pbihkaXIsICcuLicpCgkgIH0KCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygxNiksICIvaW5kZXguanMiKSkKCi8qKiovIH0sCi8qIDk5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihwcm9jZXNzKSB7Ly8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuCgkvLwoJLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEKCS8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKCS8vICJTb2Z0d2FyZSIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcKCS8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwKCS8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQKCS8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZQoJLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6CgkvLwoJLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQKCS8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgoJLy8KCS8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTCgkvLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GCgkvLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOCgkvLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwKCS8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUgoJLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRQoJLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KCgkvLyByZXNvbHZlcyAuIGFuZCAuLiBlbGVtZW50cyBpbiBhIHBhdGggYXJyYXkgd2l0aCBkaXJlY3RvcnkgbmFtZXMgdGhlcmUKCS8vIG11c3QgYmUgbm8gc2xhc2hlcywgZW1wdHkgZWxlbWVudHMsIG9yIGRldmljZSBuYW1lcyAoYzpcKSBpbiB0aGUgYXJyYXkKCS8vIChzbyBhbHNvIG5vIGxlYWRpbmcgYW5kIHRyYWlsaW5nIHNsYXNoZXMgLSBpdCBkb2VzIG5vdCBkaXN0aW5ndWlzaAoJLy8gcmVsYXRpdmUgYW5kIGFic29sdXRlIHBhdGhzKQoJZnVuY3Rpb24gbm9ybWFsaXplQXJyYXkocGFydHMsIGFsbG93QWJvdmVSb290KSB7CgkgIC8vIGlmIHRoZSBwYXRoIHRyaWVzIHRvIGdvIGFib3ZlIHRoZSByb290LCBgdXBgIGVuZHMgdXAgPiAwCgkgIHZhciB1cCA9IDA7CgkgIGZvciAodmFyIGkgPSBwYXJ0cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewoJICAgIHZhciBsYXN0ID0gcGFydHNbaV07CgkgICAgaWYgKGxhc3QgPT09ICcuJykgewoJICAgICAgcGFydHMuc3BsaWNlKGksIDEpOwoJICAgIH0gZWxzZSBpZiAobGFzdCA9PT0gJy4uJykgewoJICAgICAgcGFydHMuc3BsaWNlKGksIDEpOwoJICAgICAgdXArKzsKCSAgICB9IGVsc2UgaWYgKHVwKSB7CgkgICAgICBwYXJ0cy5zcGxpY2UoaSwgMSk7CgkgICAgICB1cC0tOwoJICAgIH0KCSAgfQoKCSAgLy8gaWYgdGhlIHBhdGggaXMgYWxsb3dlZCB0byBnbyBhYm92ZSB0aGUgcm9vdCwgcmVzdG9yZSBsZWFkaW5nIC4ucwoJICBpZiAoYWxsb3dBYm92ZVJvb3QpIHsKCSAgICBmb3IgKDsgdXAtLTsgdXApIHsKCSAgICAgIHBhcnRzLnVuc2hpZnQoJy4uJyk7CgkgICAgfQoJICB9CgoJICByZXR1cm4gcGFydHM7Cgl9CgoJLy8gU3BsaXQgYSBmaWxlbmFtZSBpbnRvIFtyb290LCBkaXIsIGJhc2VuYW1lLCBleHRdLCB1bml4IHZlcnNpb24KCS8vICdyb290JyBpcyBqdXN0IGEgc2xhc2gsIG9yIG5vdGhpbmcuCgl2YXIgc3BsaXRQYXRoUmUgPQoJICAgIC9eKFwvP3wpKFtcc1xTXSo/KSgoPzpcLnsxLDJ9fFteXC9dKz98KShcLlteLlwvXSp8KSkoPzpbXC9dKikkLzsKCXZhciBzcGxpdFBhdGggPSBmdW5jdGlvbihmaWxlbmFtZSkgewoJICByZXR1cm4gc3BsaXRQYXRoUmUuZXhlYyhmaWxlbmFtZSkuc2xpY2UoMSk7Cgl9OwoKCS8vIHBhdGgucmVzb2x2ZShbZnJvbSAuLi5dLCB0bykKCS8vIHBvc2l4IHZlcnNpb24KCWV4cG9ydHMucmVzb2x2ZSA9IGZ1bmN0aW9uKCkgewoJICB2YXIgcmVzb2x2ZWRQYXRoID0gJycsCgkgICAgICByZXNvbHZlZEFic29sdXRlID0gZmFsc2U7CgoJICBmb3IgKHZhciBpID0gYXJndW1lbnRzLmxlbmd0aCAtIDE7IGkgPj0gLTEgJiYgIXJlc29sdmVkQWJzb2x1dGU7IGktLSkgewoJICAgIHZhciBwYXRoID0gKGkgPj0gMCkgPyBhcmd1bWVudHNbaV0gOiBwcm9jZXNzLmN3ZCgpOwoKCSAgICAvLyBTa2lwIGVtcHR5IGFuZCBpbnZhbGlkIGVudHJpZXMKCSAgICBpZiAodHlwZW9mIHBhdGggIT09ICdzdHJpbmcnKSB7CgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgdG8gcGF0aC5yZXNvbHZlIG11c3QgYmUgc3RyaW5ncycpOwoJICAgIH0gZWxzZSBpZiAoIXBhdGgpIHsKCSAgICAgIGNvbnRpbnVlOwoJICAgIH0KCgkgICAgcmVzb2x2ZWRQYXRoID0gcGF0aCArICcvJyArIHJlc29sdmVkUGF0aDsKCSAgICByZXNvbHZlZEFic29sdXRlID0gcGF0aC5jaGFyQXQoMCkgPT09ICcvJzsKCSAgfQoKCSAgLy8gQXQgdGhpcyBwb2ludCB0aGUgcGF0aCBzaG91bGQgYmUgcmVzb2x2ZWQgdG8gYSBmdWxsIGFic29sdXRlIHBhdGgsIGJ1dAoJICAvLyBoYW5kbGUgcmVsYXRpdmUgcGF0aHMgdG8gYmUgc2FmZSAobWlnaHQgaGFwcGVuIHdoZW4gcHJvY2Vzcy5jd2QoKSBmYWlscykKCgkgIC8vIE5vcm1hbGl6ZSB0aGUgcGF0aAoJICByZXNvbHZlZFBhdGggPSBub3JtYWxpemVBcnJheShmaWx0ZXIocmVzb2x2ZWRQYXRoLnNwbGl0KCcvJyksIGZ1bmN0aW9uKHApIHsKCSAgICByZXR1cm4gISFwOwoJICB9KSwgIXJlc29sdmVkQWJzb2x1dGUpLmpvaW4oJy8nKTsKCgkgIHJldHVybiAoKHJlc29sdmVkQWJzb2x1dGUgPyAnLycgOiAnJykgKyByZXNvbHZlZFBhdGgpIHx8ICcuJzsKCX07CgoJLy8gcGF0aC5ub3JtYWxpemUocGF0aCkKCS8vIHBvc2l4IHZlcnNpb24KCWV4cG9ydHMubm9ybWFsaXplID0gZnVuY3Rpb24ocGF0aCkgewoJICB2YXIgaXNBYnNvbHV0ZSA9IGV4cG9ydHMuaXNBYnNvbHV0ZShwYXRoKSwKCSAgICAgIHRyYWlsaW5nU2xhc2ggPSBzdWJzdHIocGF0aCwgLTEpID09PSAnLyc7CgoJICAvLyBOb3JtYWxpemUgdGhlIHBhdGgKCSAgcGF0aCA9IG5vcm1hbGl6ZUFycmF5KGZpbHRlcihwYXRoLnNwbGl0KCcvJyksIGZ1bmN0aW9uKHApIHsKCSAgICByZXR1cm4gISFwOwoJICB9KSwgIWlzQWJzb2x1dGUpLmpvaW4oJy8nKTsKCgkgIGlmICghcGF0aCAmJiAhaXNBYnNvbHV0ZSkgewoJICAgIHBhdGggPSAnLic7CgkgIH0KCSAgaWYgKHBhdGggJiYgdHJhaWxpbmdTbGFzaCkgewoJICAgIHBhdGggKz0gJy8nOwoJICB9CgoJICByZXR1cm4gKGlzQWJzb2x1dGUgPyAnLycgOiAnJykgKyBwYXRoOwoJfTsKCgkvLyBwb3NpeCB2ZXJzaW9uCglleHBvcnRzLmlzQWJzb2x1dGUgPSBmdW5jdGlvbihwYXRoKSB7CgkgIHJldHVybiBwYXRoLmNoYXJBdCgwKSA9PT0gJy8nOwoJfTsKCgkvLyBwb3NpeCB2ZXJzaW9uCglleHBvcnRzLmpvaW4gPSBmdW5jdGlvbigpIHsKCSAgdmFyIHBhdGhzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKTsKCSAgcmV0dXJuIGV4cG9ydHMubm9ybWFsaXplKGZpbHRlcihwYXRocywgZnVuY3Rpb24ocCwgaW5kZXgpIHsKCSAgICBpZiAodHlwZW9mIHAgIT09ICdzdHJpbmcnKSB7CgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgdG8gcGF0aC5qb2luIG11c3QgYmUgc3RyaW5ncycpOwoJICAgIH0KCSAgICByZXR1cm4gcDsKCSAgfSkuam9pbignLycpKTsKCX07CgoKCS8vIHBhdGgucmVsYXRpdmUoZnJvbSwgdG8pCgkvLyBwb3NpeCB2ZXJzaW9uCglleHBvcnRzLnJlbGF0aXZlID0gZnVuY3Rpb24oZnJvbSwgdG8pIHsKCSAgZnJvbSA9IGV4cG9ydHMucmVzb2x2ZShmcm9tKS5zdWJzdHIoMSk7CgkgIHRvID0gZXhwb3J0cy5yZXNvbHZlKHRvKS5zdWJzdHIoMSk7CgoJICBmdW5jdGlvbiB0cmltKGFycikgewoJICAgIHZhciBzdGFydCA9IDA7CgkgICAgZm9yICg7IHN0YXJ0IDwgYXJyLmxlbmd0aDsgc3RhcnQrKykgewoJICAgICAgaWYgKGFycltzdGFydF0gIT09ICcnKSBicmVhazsKCSAgICB9CgoJICAgIHZhciBlbmQgPSBhcnIubGVuZ3RoIC0gMTsKCSAgICBmb3IgKDsgZW5kID49IDA7IGVuZC0tKSB7CgkgICAgICBpZiAoYXJyW2VuZF0gIT09ICcnKSBicmVhazsKCSAgICB9CgoJICAgIGlmIChzdGFydCA+IGVuZCkgcmV0dXJuIFtdOwoJICAgIHJldHVybiBhcnIuc2xpY2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsgMSk7CgkgIH0KCgkgIHZhciBmcm9tUGFydHMgPSB0cmltKGZyb20uc3BsaXQoJy8nKSk7CgkgIHZhciB0b1BhcnRzID0gdHJpbSh0by5zcGxpdCgnLycpKTsKCgkgIHZhciBsZW5ndGggPSBNYXRoLm1pbihmcm9tUGFydHMubGVuZ3RoLCB0b1BhcnRzLmxlbmd0aCk7CgkgIHZhciBzYW1lUGFydHNMZW5ndGggPSBsZW5ndGg7CgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICBpZiAoZnJvbVBhcnRzW2ldICE9PSB0b1BhcnRzW2ldKSB7CgkgICAgICBzYW1lUGFydHNMZW5ndGggPSBpOwoJICAgICAgYnJlYWs7CgkgICAgfQoJICB9CgoJICB2YXIgb3V0cHV0UGFydHMgPSBbXTsKCSAgZm9yICh2YXIgaSA9IHNhbWVQYXJ0c0xlbmd0aDsgaSA8IGZyb21QYXJ0cy5sZW5ndGg7IGkrKykgewoJICAgIG91dHB1dFBhcnRzLnB1c2goJy4uJyk7CgkgIH0KCgkgIG91dHB1dFBhcnRzID0gb3V0cHV0UGFydHMuY29uY2F0KHRvUGFydHMuc2xpY2Uoc2FtZVBhcnRzTGVuZ3RoKSk7CgoJICByZXR1cm4gb3V0cHV0UGFydHMuam9pbignLycpOwoJfTsKCglleHBvcnRzLnNlcCA9ICcvJzsKCWV4cG9ydHMuZGVsaW1pdGVyID0gJzonOwoKCWV4cG9ydHMuZGlybmFtZSA9IGZ1bmN0aW9uKHBhdGgpIHsKCSAgdmFyIHJlc3VsdCA9IHNwbGl0UGF0aChwYXRoKSwKCSAgICAgIHJvb3QgPSByZXN1bHRbMF0sCgkgICAgICBkaXIgPSByZXN1bHRbMV07CgoJICBpZiAoIXJvb3QgJiYgIWRpcikgewoJICAgIC8vIE5vIGRpcm5hbWUgd2hhdHNvZXZlcgoJICAgIHJldHVybiAnLic7CgkgIH0KCgkgIGlmIChkaXIpIHsKCSAgICAvLyBJdCBoYXMgYSBkaXJuYW1lLCBzdHJpcCB0cmFpbGluZyBzbGFzaAoJICAgIGRpciA9IGRpci5zdWJzdHIoMCwgZGlyLmxlbmd0aCAtIDEpOwoJICB9CgoJICByZXR1cm4gcm9vdCArIGRpcjsKCX07CgoKCWV4cG9ydHMuYmFzZW5hbWUgPSBmdW5jdGlvbihwYXRoLCBleHQpIHsKCSAgdmFyIGYgPSBzcGxpdFBhdGgocGF0aClbMl07CgkgIC8vIFRPRE86IG1ha2UgdGhpcyBjb21wYXJpc29uIGNhc2UtaW5zZW5zaXRpdmUgb24gd2luZG93cz8KCSAgaWYgKGV4dCAmJiBmLnN1YnN0cigtMSAqIGV4dC5sZW5ndGgpID09PSBleHQpIHsKCSAgICBmID0gZi5zdWJzdHIoMCwgZi5sZW5ndGggLSBleHQubGVuZ3RoKTsKCSAgfQoJICByZXR1cm4gZjsKCX07CgoKCWV4cG9ydHMuZXh0bmFtZSA9IGZ1bmN0aW9uKHBhdGgpIHsKCSAgcmV0dXJuIHNwbGl0UGF0aChwYXRoKVszXTsKCX07CgoJZnVuY3Rpb24gZmlsdGVyICh4cywgZikgewoJICAgIGlmICh4cy5maWx0ZXIpIHJldHVybiB4cy5maWx0ZXIoZik7CgkgICAgdmFyIHJlcyA9IFtdOwoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgeHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgaWYgKGYoeHNbaV0sIGksIHhzKSkgcmVzLnB1c2goeHNbaV0pOwoJICAgIH0KCSAgICByZXR1cm4gcmVzOwoJfQoKCS8vIFN0cmluZy5wcm90b3R5cGUuc3Vic3RyIC0gbmVnYXRpdmUgaW5kZXggZG9uJ3Qgd29yayBpbiBJRTgKCXZhciBzdWJzdHIgPSAnYWInLnN1YnN0cigtMSkgPT09ICdiJwoJICAgID8gZnVuY3Rpb24gKHN0ciwgc3RhcnQsIGxlbikgeyByZXR1cm4gc3RyLnN1YnN0cihzdGFydCwgbGVuKSB9CgkgICAgOiBmdW5jdGlvbiAoc3RyLCBzdGFydCwgbGVuKSB7CgkgICAgICAgIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gc3RyLmxlbmd0aCArIHN0YXJ0OwoJICAgICAgICByZXR1cm4gc3RyLnN1YnN0cihzdGFydCwgbGVuKTsKCSAgICB9Cgk7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMTYpKSkKCi8qKiovIH0sCi8qIDEwMCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgbWFwID0gewoJCSIuL2JpbmRpbmdzIjogOTgsCgkJIi4vYmluZGluZ3MuanMiOiA5OCwKCQkiLi9wYWNrYWdlIjogMTAyLAoJCSIuL3BhY2thZ2UuanNvbiI6IDEwMgoJfTsKCWZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkgewoJCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpKTsKCX07CglmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSB7CgkJcmV0dXJuIG1hcFtyZXFdIHx8IChmdW5jdGlvbigpIHsgdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIgKyByZXEgKyAiJy4iKSB9KCkpOwoJfTsKCXdlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7CgkJcmV0dXJuIE9iamVjdC5rZXlzKG1hcCk7Cgl9OwoJd2VicGFja0NvbnRleHQucmVzb2x2ZSA9IHdlYnBhY2tDb250ZXh0UmVzb2x2ZTsKCW1vZHVsZS5leHBvcnRzID0gd2VicGFja0NvbnRleHQ7Cgl3ZWJwYWNrQ29udGV4dC5pZCA9IDEwMDsKCgovKioqLyB9LAovKiAxMDEgKi8sCi8qIDEwMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsKCQkiX2FyZ3MiOiBbCgkJCVsKCQkJCXsKCQkJCQkicmF3IjogImJpbmRpbmdzQH4xLjIuMSIsCgkJCQkJInNjb3BlIjogbnVsbCwKCQkJCQkiZXNjYXBlZE5hbWUiOiAiYmluZGluZ3MiLAoJCQkJCSJuYW1lIjogImJpbmRpbmdzIiwKCQkJCQkicmF3U3BlYyI6ICJ+MS4yLjEiLAoJCQkJCSJzcGVjIjogIj49MS4yLjEgPDEuMy4wIiwKCQkJCQkidHlwZSI6ICJyYW5nZSIKCQkJCX0sCgkJCQkiL2hvbWUvdnNpbHZhL3B0LWlub3ZhY2FvL3JldGhpbmstcHJvamVjdC9kZXYtaHlwZXJ0eS10b29sa2l0L25vZGVfbW9kdWxlcy9idWZmZXJ1dGlsIgoJCQldCgkJXSwKCQkiX2Zyb20iOiAiYmluZGluZ3NAPj0xLjIuMSA8MS4zLjAiLAoJCSJfaWQiOiAiYmluZGluZ3NAMS4yLjEiLAoJCSJfaW5DYWNoZSI6IHRydWUsCgkJIl9sb2NhdGlvbiI6ICIvYmluZGluZ3MiLAoJCSJfbnBtVXNlciI6IHsKCQkJIm5hbWUiOiAidG9vdGFsbG5hdGUiLAoJCQkiZW1haWwiOiAibmF0aGFuQHRvb3RhbGxuYXRlLm5ldCIKCQl9LAoJCSJfbnBtVmVyc2lvbiI6ICIxLjQuMTQiLAoJCSJfcGhhbnRvbUNoaWxkcmVuIjoge30sCgkJIl9yZXF1ZXN0ZWQiOiB7CgkJCSJyYXciOiAiYmluZGluZ3NAfjEuMi4xIiwKCQkJInNjb3BlIjogbnVsbCwKCQkJImVzY2FwZWROYW1lIjogImJpbmRpbmdzIiwKCQkJIm5hbWUiOiAiYmluZGluZ3MiLAoJCQkicmF3U3BlYyI6ICJ+MS4yLjEiLAoJCQkic3BlYyI6ICI+PTEuMi4xIDwxLjMuMCIsCgkJCSJ0eXBlIjogInJhbmdlIgoJCX0sCgkJIl9yZXF1aXJlZEJ5IjogWwoJCQkiL2J1ZmZlcnV0aWwiLAoJCQkiL3V0Zi04LXZhbGlkYXRlIgoJCV0sCgkJIl9yZXNvbHZlZCI6ICJodHRwczovL3JlZ2lzdHJ5Lm5wbWpzLm9yZy9iaW5kaW5ncy8tL2JpbmRpbmdzLTEuMi4xLnRneiIsCgkJIl9zaGFzdW0iOiAiMTRhZDYxMTM4MTJkMmQzN2Q3MmU2N2I0Y2FjYjRiYjcyNjUwNWYxMSIsCgkJIl9zaHJpbmt3cmFwIjogbnVsbCwKCQkiX3NwZWMiOiAiYmluZGluZ3NAfjEuMi4xIiwKCQkiX3doZXJlIjogIi9ob21lL3ZzaWx2YS9wdC1pbm92YWNhby9yZXRoaW5rLXByb2plY3QvZGV2LWh5cGVydHktdG9vbGtpdC9ub2RlX21vZHVsZXMvYnVmZmVydXRpbCIsCgkJImF1dGhvciI6IHsKCQkJIm5hbWUiOiAiTmF0aGFuIFJhamxpY2giLAoJCQkiZW1haWwiOiAibmF0aGFuQHRvb3RhbGxuYXRlLm5ldCIsCgkJCSJ1cmwiOiAiaHR0cDovL3Rvb3RhbGxuYXRlLm5ldCIKCQl9LAoJCSJidWdzIjogewoJCQkidXJsIjogImh0dHBzOi8vZ2l0aHViLmNvbS9Ub29UYWxsTmF0ZS9ub2RlLWJpbmRpbmdzL2lzc3VlcyIKCQl9LAoJCSJkZXBlbmRlbmNpZXMiOiB7fSwKCQkiZGVzY3JpcHRpb24iOiAiSGVscGVyIG1vZHVsZSBmb3IgbG9hZGluZyB5b3VyIG5hdGl2ZSBtb2R1bGUncyAubm9kZSBmaWxlIiwKCQkiZGV2RGVwZW5kZW5jaWVzIjoge30sCgkJImRpcmVjdG9yaWVzIjoge30sCgkJImRpc3QiOiB7CgkJCSJzaGFzdW0iOiAiMTRhZDYxMTM4MTJkMmQzN2Q3MmU2N2I0Y2FjYjRiYjcyNjUwNWYxMSIsCgkJCSJ0YXJiYWxsIjogImh0dHBzOi8vcmVnaXN0cnkubnBtanMub3JnL2JpbmRpbmdzLy0vYmluZGluZ3MtMS4yLjEudGd6IgoJCX0sCgkJImdpdEhlYWQiOiAiZTQwNDE1MmVlMjdmODQ3OGNjYmM3MTIyZWUwNTEyNDZlOGU1ZWMwMiIsCgkJImhvbWVwYWdlIjogImh0dHBzOi8vZ2l0aHViLmNvbS9Ub29UYWxsTmF0ZS9ub2RlLWJpbmRpbmdzIiwKCQkia2V5d29yZHMiOiBbCgkJCSJuYXRpdmUiLAoJCQkiYWRkb24iLAoJCQkiYmluZGluZ3MiLAoJCQkiZ3lwIiwKCQkJIndhZiIsCgkJCSJjIiwKCQkJImMrKyIKCQldLAoJCSJsaWNlbnNlIjogIk1JVCIsCgkJIm1haW4iOiAiLi9iaW5kaW5ncy5qcyIsCgkJIm1haW50YWluZXJzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJUb29UYWxsTmF0ZSIsCgkJCQkiZW1haWwiOiAibmF0aGFuQHRvb3RhbGxuYXRlLm5ldCIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidG9vdGFsbG5hdGUiLAoJCQkJImVtYWlsIjogIm5hdGhhbkB0b290YWxsbmF0ZS5uZXQiCgkJCX0KCQldLAoJCSJuYW1lIjogImJpbmRpbmdzIiwKCQkib3B0aW9uYWxEZXBlbmRlbmNpZXMiOiB7fSwKCQkicmVhZG1lIjogIkVSUk9SOiBObyBSRUFETUUgZGF0YSBmb3VuZCEiLAoJCSJyZXBvc2l0b3J5IjogewoJCQkidHlwZSI6ICJnaXQiLAoJCQkidXJsIjogImdpdDovL2dpdGh1Yi5jb20vVG9vVGFsbE5hdGUvbm9kZS1iaW5kaW5ncy5naXQiCgkJfSwKCQkic2NyaXB0cyI6IHt9LAoJCSJ2ZXJzaW9uIjogIjEuMi4xIgoJfTsKCi8qKiovIH0sCi8qIDEwMyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oQnVmZmVyKSB7LyohCgkgKiBVVEYtOCB2YWxpZGF0ZTogVVRGLTggdmFsaWRhdGlvbiBmb3IgV2ViU29ja2V0cy4KCSAqIENvcHlyaWdodChjKSAyMDE1IEVpbmFyIE90dG8gU3Rhbmd2aWsgPGVpbmFyb3NAZ21haWwuY29tPgoJICogTUlUIExpY2Vuc2VkCgkgKi8KCgkndXNlIHN0cmljdCc7CgoJLyoqCgkgKiBDaGVja3MgaWYgYSBnaXZlbiBidWZmZXIgY29udGFpbnMgb25seSBjb3JyZWN0IFVURi04LgoJICogUG9ydGVkIGZyb20gaHR0cHM6Ly93d3cuY2wuY2FtLmFjLnVrLyU3RW1nazI1L3Vjcy91dGY4X2NoZWNrLmMgYnkKCSAqIE1hcmt1cyBLdWhuLgoJICoKCSAqIEBwYXJhbSB7QnVmZmVyfSBidWYgVGhlIGJ1ZmZlciB0byBjaGVjawoJICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIGBidWZgIGNvbnRhaW5zIG9ubHkgY29ycmVjdCBVVEYtOCwgZWxzZSBgZmFsc2VgCgkgKiBAcHVibGljCgkgKi8KCWNvbnN0IGlzVmFsaWRVVEY4ID0gKGJ1ZikgPT4gewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRmlyc3QgYXJndW1lbnQgbmVlZHMgdG8gYmUgYSBidWZmZXInKTsKCSAgfQoKCSAgdmFyIGxlbiA9IGJ1Zi5sZW5ndGg7CgkgIHZhciBpID0gMDsKCgkgIHdoaWxlIChpIDwgbGVuKSB7CgkgICAgaWYgKGJ1ZltpXSA8IDB4ODApIHsgIC8vIDB4eHh4eHh4CgkgICAgICBpKys7CgkgICAgfSBlbHNlIGlmICgoYnVmW2ldICYgMHhlMCkgPT09IDB4YzApIHsgIC8vIDExMHh4eHh4IDEweHh4eHh4CgkgICAgICBpZiAoCgkgICAgICAgIGkgKyAxID09PSBsZW4gfHwKCSAgICAgICAgKGJ1ZltpICsgMV0gJiAweGMwKSAhPT0gMHg4MCB8fAoJICAgICAgICAoYnVmW2ldICYgMHhmZSkgPT09IDB4YzAgIC8vIG92ZXJsb25nCgkgICAgICApIHsKCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgaSArPSAyOwoJICAgICAgfQoJICAgIH0gZWxzZSBpZiAoKGJ1ZltpXSAmIDB4ZjApID09PSAweGUwKSB7ICAvLyAxMTEweHh4eCAxMHh4eHh4eCAxMHh4eHh4eAoJICAgICAgaWYgKAoJICAgICAgICBpICsgMiA+PSBsZW4gfHwKCSAgICAgICAgKGJ1ZltpICsgMV0gJiAweGMwKSAhPT0gMHg4MCB8fAoJICAgICAgICAoYnVmW2kgKyAyXSAmIDB4YzApICE9PSAweDgwIHx8CgkgICAgICAgIGJ1ZltpXSA9PT0gMHhlMCAmJiAoYnVmW2kgKyAxXSAmIDB4ZTApID09PSAweDgwIHx8ICAvLyBvdmVybG9uZwoJICAgICAgICBidWZbaV0gPT09IDB4ZWQgJiYgKGJ1ZltpICsgMV0gJiAweGUwKSA9PT0gMHhhMCAgICAgLy8gc3Vycm9nYXRlIChVK0Q4MDAgLSBVK0RGRkYpCgkgICAgICApIHsKCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgaSArPSAzOwoJICAgICAgfQoJICAgIH0gZWxzZSBpZiAoKGJ1ZltpXSAmIDB4ZjgpID09PSAweGYwKSB7ICAvLyAxMTExMHh4eCAxMHh4eHh4eCAxMHh4eHh4eCAxMHh4eHh4eAoJICAgICAgaWYgKAoJICAgICAgICBpICsgMyA+PSBsZW4gfHwKCSAgICAgICAgKGJ1ZltpICsgMV0gJiAweGMwKSAhPT0gMHg4MCB8fAoJICAgICAgICAoYnVmW2kgKyAyXSAmIDB4YzApICE9PSAweDgwIHx8CgkgICAgICAgIChidWZbaSArIDNdICYgMHhjMCkgIT09IDB4ODAgfHwKCSAgICAgICAgYnVmW2ldID09PSAweGYwICYmIChidWZbaSArIDFdICYgMHhmMCkgPT09IDB4ODAgfHwgIC8vIG92ZXJsb25nCgkgICAgICAgIGJ1ZltpXSA9PT0gMHhmNCAmJiBidWZbaSArIDFdID4gMHg4ZiB8fCBidWZbaV0gPiAweGY0ICAvLyA+IFUrMTBGRkZGCgkgICAgICApIHsKCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgaSArPSA0OwoJICAgICAgfQoJICAgIH0gZWxzZSB7CgkgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfQoJICB9CgoJICByZXR1cm4gdHJ1ZTsKCX07CgoJbW9kdWxlLmV4cG9ydHMgPSBpc1ZhbGlkVVRGODsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5CdWZmZXIpKQoKLyoqKi8gfSwKLyogMTA0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8qIQoJICogd3M6IGEgbm9kZS5qcyB3ZWJzb2NrZXQgY2xpZW50CgkgKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT4KCSAqIE1JVCBMaWNlbnNlZAoJICovCgoJJ3VzZSBzdHJpY3QnOwoKCW1vZHVsZS5leHBvcnRzID0gKCkgPT4gdHJ1ZTsKCgovKioqLyB9LAovKiAxMDUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCS8qIQoJICogd3M6IGEgbm9kZS5qcyB3ZWJzb2NrZXQgY2xpZW50CgkgKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT4KCSAqIE1JVCBMaWNlbnNlZAoJICovCgoJdHJ5IHsKCSAgY29uc3QgYnVmZmVyVXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oMTA2KTsKCgkgIG1vZHVsZS5leHBvcnRzID0gYnVmZmVyVXRpbC5CdWZmZXJVdGlsIHx8IGJ1ZmZlclV0aWw7Cgl9IGNhdGNoIChlKSB7CgkgIG1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDgpOwoJfQoKCi8qKiovIH0sCi8qIDEwNiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJdHJ5IHsKCSAgbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk4KSgnYnVmZmVydXRpbCcpOwoJfSBjYXRjaCAoZSkgewoJICBtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA3KTsKCX0KCgovKioqLyB9LAovKiAxMDcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLyohCgkgKiBidWZmZXJ1dGlsOiBXZWJTb2NrZXQgYnVmZmVyIHV0aWxzCgkgKiBDb3B5cmlnaHQoYykgMjAxNSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT4KCSAqIE1JVCBMaWNlbnNlZAoJICovCgoJJ3VzZSBzdHJpY3QnOwoKCS8qKgoJICogTWVyZ2VzIGFuIGFycmF5IG9mIGJ1ZmZlcnMgaW50byBhIHRhcmdldCBidWZmZXIuCgkgKgoJICogQHBhcmFtIHtCdWZmZXJ9IHRhcmdldCBUaGUgdGFyZ2V0IGJ1ZmZlcgoJICogQHBhcmFtIHtCdWZmZXJbXX0gYnVmZmVycyBUaGUgYXJyYXkgb2YgYnVmZmVycyB0byBtZXJnZQoJICogQHB1YmxpYwoJICovCgljb25zdCBtZXJnZSA9ICh0YXJnZXQsIGJ1ZmZlcnMpID0+IHsKCSAgdmFyIG9mZnNldCA9IDA7CgkgIGZvciAodmFyIGkgPSAwOyBpIDwgYnVmZmVycy5sZW5ndGg7IGkrKykgewoJICAgIGNvbnN0IGJ1ZiA9IGJ1ZmZlcnNbaV07CgkgICAgYnVmLmNvcHkodGFyZ2V0LCBvZmZzZXQpOwoJICAgIG9mZnNldCArPSBidWYubGVuZ3RoOwoJICB9Cgl9OwoKCS8qKgoJICogTWFza3MgYSBidWZmZXIgdXNpbmcgdGhlIGdpdmVuIG1hc2suCgkgKgoJICogQHBhcmFtIHtCdWZmZXJ9IHNvdXJjZSBUaGUgYnVmZmVyIHRvIG1hc2sKCSAqIEBwYXJhbSB7QnVmZmVyfSBtYXNrIFRoZSBtYXNrIHRvIHVzZQoJICogQHBhcmFtIHtCdWZmZXJ9IG91dHB1dCBUaGUgYnVmZmVyIHdoZXJlIHRvIHN0b3JlIHRoZSByZXN1bHQKCSAqIEBwYXJhbSB7TnVtYmVyfSBvZmZzZXQgVGhlIG9mZnNldCBhdCB3aGljaCB0byBzdGFydCB3cml0aW5nCgkgKiBAcGFyYW0ge051bWJlcn0gbGVuZ3RoIFRoZSBudW1iZXIgb2YgYnl0ZXMgdG8gbWFzay4KCSAqIEBwdWJsaWMKCSAqLwoJY29uc3QgbWFzayA9IChzb3VyY2UsIG1hc2ssIG91dHB1dCwgb2Zmc2V0LCBsZW5ndGgpID0+IHsKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgIG91dHB1dFtvZmZzZXQgKyBpXSA9IHNvdXJjZVtpXSBeIG1hc2tbaSAmIDNdOwoJICB9Cgl9OwoKCS8qKgoJICogVW5tYXNrcyBhIGJ1ZmZlciB1c2luZyB0aGUgZ2l2ZW4gbWFzay4KCSAqCgkgKiBAcGFyYW0ge0J1ZmZlcn0gYnVmZmVyIFRoZSBidWZmZXIgdG8gdW5tYXNrCgkgKiBAcGFyYW0ge0J1ZmZlcn0gbWFzayBUaGUgbWFzayB0byB1c2UKCSAqIEBwdWJsaWMKCSAqLwoJY29uc3QgdW5tYXNrID0gKGJ1ZmZlciwgbWFzaykgPT4gewoJICAvLyBSZXF1aXJlZCB1bnRpbCBodHRwczovL2dpdGh1Yi5jb20vbm9kZWpzL25vZGUvaXNzdWVzLzkwMDYgaXMgcmVzb2x2ZWQuCgkgIGNvbnN0IGxlbmd0aCA9IGJ1ZmZlci5sZW5ndGg7CgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKCSAgICBidWZmZXJbaV0gXj0gbWFza1tpICYgM107CgkgIH0KCX07CgoJbW9kdWxlLmV4cG9ydHMgPSB7IG1lcmdlLCBtYXNrLCB1bm1hc2sgfTsKCgovKioqLyB9LAovKiAxMDggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLyohCgkgKiB3czogYSBub2RlLmpzIHdlYnNvY2tldCBjbGllbnQKCSAqIENvcHlyaWdodChjKSAyMDExIEVpbmFyIE90dG8gU3Rhbmd2aWsgPGVpbmFyb3NAZ21haWwuY29tPgoJICogTUlUIExpY2Vuc2VkCgkgKi8KCgkndXNlIHN0cmljdCc7CgoJLyoqCgkgKiBNZXJnZXMgYW4gYXJyYXkgb2YgYnVmZmVycyBpbnRvIGEgdGFyZ2V0IGJ1ZmZlci4KCSAqCgkgKiBAcGFyYW0ge0J1ZmZlcn0gdGFyZ2V0IFRoZSB0YXJnZXQgYnVmZmVyCgkgKiBAcGFyYW0ge0J1ZmZlcltdfSBidWZmZXJzIFRoZSBhcnJheSBvZiBidWZmZXJzIHRvIG1lcmdlCgkgKiBAcHVibGljCgkgKi8KCWNvbnN0IG1lcmdlID0gKHRhcmdldCwgYnVmZmVycykgPT4gewoJICB2YXIgb2Zmc2V0ID0gMDsKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBidWZmZXJzLmxlbmd0aDsgaSsrKSB7CgkgICAgY29uc3QgYnVmID0gYnVmZmVyc1tpXTsKCSAgICBidWYuY29weSh0YXJnZXQsIG9mZnNldCk7CgkgICAgb2Zmc2V0ICs9IGJ1Zi5sZW5ndGg7CgkgIH0KCX07CgoJLyoqCgkgKiBNYXNrcyBhIGJ1ZmZlciB1c2luZyB0aGUgZ2l2ZW4gbWFzay4KCSAqCgkgKiBAcGFyYW0ge0J1ZmZlcn0gc291cmNlIFRoZSBidWZmZXIgdG8gbWFzawoJICogQHBhcmFtIHtCdWZmZXJ9IG1hc2sgVGhlIG1hc2sgdG8gdXNlCgkgKiBAcGFyYW0ge0J1ZmZlcn0gb3V0cHV0IFRoZSBidWZmZXIgd2hlcmUgdG8gc3RvcmUgdGhlIHJlc3VsdAoJICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldCBUaGUgb2Zmc2V0IGF0IHdoaWNoIHRvIHN0YXJ0IHdyaXRpbmcKCSAqIEBwYXJhbSB7TnVtYmVyfSBsZW5ndGggVGhlIG51bWJlciBvZiBieXRlcyB0byBtYXNrLgoJICogQHB1YmxpYwoJICovCgljb25zdCBtYXNrID0gKHNvdXJjZSwgbWFzaywgb3V0cHV0LCBvZmZzZXQsIGxlbmd0aCkgPT4gewoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CgkgICAgb3V0cHV0W29mZnNldCArIGldID0gc291cmNlW2ldIF4gbWFza1tpICYgM107CgkgIH0KCX07CgoJLyoqCgkgKiBVbm1hc2tzIGEgYnVmZmVyIHVzaW5nIHRoZSBnaXZlbiBtYXNrLgoJICoKCSAqIEBwYXJhbSB7QnVmZmVyfSBidWZmZXIgVGhlIGJ1ZmZlciB0byB1bm1hc2sKCSAqIEBwYXJhbSB7QnVmZmVyfSBtYXNrIFRoZSBtYXNrIHRvIHVzZQoJICogQHB1YmxpYwoJICovCgljb25zdCB1bm1hc2sgPSAoYnVmZmVyLCBtYXNrKSA9PiB7CgkgIC8vIFJlcXVpcmVkIHVudGlsIGh0dHBzOi8vZ2l0aHViLmNvbS9ub2RlanMvbm9kZS9pc3N1ZXMvOTAwNiBpcyByZXNvbHZlZC4KCSAgY29uc3QgbGVuZ3RoID0gYnVmZmVyLmxlbmd0aDsKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgIGJ1ZmZlcltpXSBePSBtYXNrW2kgJiAzXTsKCSAgfQoJfTsKCgltb2R1bGUuZXhwb3J0cyA9IHsgbWVyZ2UsIG1hc2ssIHVubWFzayB9OwoKCi8qKiovIH0sCi8qIDEwOSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvKiEKCSAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudAoJICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+CgkgKiBNSVQgTGljZW5zZWQKCSAqLwoKCSd1c2Ugc3RyaWN0JzsKCgltb2R1bGUuZXhwb3J0cyA9IHsKCSAgaXNWYWxpZEVycm9yQ29kZTogZnVuY3Rpb24gKGNvZGUpIHsKCSAgICByZXR1cm4gKGNvZGUgPj0gMTAwMCAmJiBjb2RlIDw9IDEwMTMgJiYgY29kZSAhPT0gMTAwNCAmJiBjb2RlICE9PSAxMDA1ICYmIGNvZGUgIT09IDEwMDYpIHx8CgkgICAgICAoY29kZSA+PSAzMDAwICYmIGNvZGUgPD0gNDk5OSk7CgkgIH0sCgkgIDEwMDA6ICdub3JtYWwnLAoJICAxMDAxOiAnZ29pbmcgYXdheScsCgkgIDEwMDI6ICdwcm90b2NvbCBlcnJvcicsCgkgIDEwMDM6ICd1bnN1cHBvcnRlZCBkYXRhJywKCSAgMTAwNDogJ3Jlc2VydmVkJywKCSAgMTAwNTogJ3Jlc2VydmVkIGZvciBleHRlbnNpb25zJywKCSAgMTAwNjogJ3Jlc2VydmVkIGZvciBleHRlbnNpb25zJywKCSAgMTAwNzogJ2luY29uc2lzdGVudCBvciBpbnZhbGlkIGRhdGEnLAoJICAxMDA4OiAncG9saWN5IHZpb2xhdGlvbicsCgkgIDEwMDk6ICdtZXNzYWdlIHRvbyBiaWcnLAoJICAxMDEwOiAnZXh0ZW5zaW9uIGhhbmRzaGFrZSBtaXNzaW5nJywKCSAgMTAxMTogJ2FuIHVuZXhwZWN0ZWQgY29uZGl0aW9uIHByZXZlbnRlZCB0aGUgcmVxdWVzdCBmcm9tIGJlaW5nIGZ1bGZpbGxlZCcsCgkgIDEwMTI6ICdzZXJ2aWNlIHJlc3RhcnQnLAoJICAxMDEzOiAndHJ5IGFnYWluIGxhdGVyJwoJfTsKCgovKioqLyB9LAovKiAxMTAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKEJ1ZmZlcikgey8qIQoJICogd3M6IGEgbm9kZS5qcyB3ZWJzb2NrZXQgY2xpZW50CgkgKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT4KCSAqIE1JVCBMaWNlbnNlZAoJICovCgoJJ3VzZSBzdHJpY3QnOwoKCWNvbnN0IGNyeXB0byA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7CgoJY29uc3QgUGVyTWVzc2FnZURlZmxhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc4KTsKCWNvbnN0IGJ1ZmZlclV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNSk7Cgljb25zdCBFcnJvckNvZGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpOwoKCS8qKgoJICogSHlCaSBTZW5kZXIgaW1wbGVtZW50YXRpb24uCgkgKi8KCWNsYXNzIFNlbmRlciB7CgkgIC8qKgoJICAgKiBDcmVhdGVzIGEgU2VuZGVyIGluc3RhbmNlLgoJICAgKgoJICAgKiBAcGFyYW0ge25ldC5Tb2NrZXR9IHNvY2tldCBUaGUgY29ubmVjdGlvbiBzb2NrZXQKCSAgICogQHBhcmFtIHtPYmplY3R9IGV4dGVuc2lvbnMgQW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIG5lZ290aWF0ZWQgZXh0ZW5zaW9ucwoJICAgKi8KCSAgY29uc3RydWN0b3IgKHNvY2tldCwgZXh0ZW5zaW9ucykgewoJICAgIHRoaXMucGVyTWVzc2FnZURlZmxhdGUgPSAoZXh0ZW5zaW9ucyB8fCB7fSlbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV07CgkgICAgdGhpcy5fc29ja2V0ID0gc29ja2V0OwoKCSAgICB0aGlzLmZpcnN0RnJhZ21lbnQgPSB0cnVlOwoJICAgIHRoaXMuY29tcHJlc3MgPSBmYWxzZTsKCgkgICAgdGhpcy5idWZmZXJlZEJ5dGVzID0gMDsKCSAgICB0aGlzLmRlZmxhdGluZyA9IGZhbHNlOwoJICAgIHRoaXMucXVldWUgPSBbXTsKCgkgICAgdGhpcy5vbmVycm9yID0gbnVsbDsKCSAgfQoKCSAgLyoqCgkgICAqIFNlbmRzIGEgY2xvc2UgbWVzc2FnZSB0byB0aGUgb3RoZXIgcGVlci4KCSAgICoKCSAgICogQHBhcmFtIHsoTnVtYmVyfHVuZGVmaW5lZCl9IGNvZGUgVGhlIHN0YXR1cyBjb2RlIGNvbXBvbmVudCBvZiB0aGUgYm9keQoJICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YSBUaGUgbWVzc2FnZSBjb21wb25lbnQgb2YgdGhlIGJvZHkKCSAgICogQHBhcmFtIHtCb29sZWFufSBtYXNrIFNwZWNpZmllcyB3aGV0aGVyIG9yIG5vdCB0byBtYXNrIHRoZSBtZXNzYWdlCgkgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIENhbGxiYWNrCgkgICAqIEBwdWJsaWMKCSAgICovCgkgIGNsb3NlIChjb2RlLCBkYXRhLCBtYXNrLCBjYikgewoJICAgIGlmIChjb2RlICE9PSB1bmRlZmluZWQgJiYgKHR5cGVvZiBjb2RlICE9PSAnbnVtYmVyJyB8fCAhRXJyb3JDb2Rlcy5pc1ZhbGlkRXJyb3JDb2RlKGNvZGUpKSkgewoJICAgICAgdGhyb3cgbmV3IEVycm9yKCdmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgdmFsaWQgZXJyb3IgY29kZSBudW1iZXInKTsKCSAgICB9CgoJICAgIGNvbnN0IGJ1ZiA9IEJ1ZmZlci5hbGxvY1Vuc2FmZSgyICsgKGRhdGEgPyBCdWZmZXIuYnl0ZUxlbmd0aChkYXRhKSA6IDApKTsKCgkgICAgYnVmLndyaXRlVUludDE2QkUoY29kZSB8fCAxMDAwLCAwLCB0cnVlKTsKCSAgICBpZiAoYnVmLmxlbmd0aCA+IDIpIGJ1Zi53cml0ZShkYXRhLCAyKTsKCgkgICAgaWYgKHRoaXMuZGVmbGF0aW5nKSB7CgkgICAgICB0aGlzLmVucXVldWUoW3RoaXMuZG9DbG9zZSwgYnVmLCBtYXNrLCBjYl0pOwoJICAgIH0gZWxzZSB7CgkgICAgICB0aGlzLmRvQ2xvc2UoYnVmLCBtYXNrLCBjYik7CgkgICAgfQoJICB9CgoJICAvKioKCSAgICogRnJhbWVzIGFuZCBzZW5kcyBhIGNsb3NlIG1lc3NhZ2UuCgkgICAqCgkgICAqIEBwYXJhbSB7QnVmZmVyfSBkYXRhIFRoZSBtZXNzYWdlIHRvIHNlbmQKCSAgICogQHBhcmFtIHtCb29sZWFufSBtYXNrIFNwZWNpZmllcyB3aGV0aGVyIG9yIG5vdCB0byBtYXNrIGBkYXRhYAoJICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYiBDYWxsYmFjawoJICAgKiBAcHJpdmF0ZQoJICAgKi8KCSAgZG9DbG9zZSAoZGF0YSwgbWFzaywgY2IpIHsKCSAgICB0aGlzLmZyYW1lQW5kU2VuZChkYXRhLCB7CgkgICAgICByZWFkT25seTogZmFsc2UsCgkgICAgICBvcGNvZGU6IDB4MDgsCgkgICAgICByc3YxOiBmYWxzZSwKCSAgICAgIGZpbjogdHJ1ZSwKCSAgICAgIG1hc2sKCSAgICB9LCBjYik7CgkgIH0KCgkgIC8qKgoJICAgKiBTZW5kcyBhIHBpbmcgbWVzc2FnZSB0byB0aGUgb3RoZXIgcGVlci4KCSAgICoKCSAgICogQHBhcmFtIHsqfSBkYXRhIFRoZSBtZXNzYWdlIHRvIHNlbmQKCSAgICogQHBhcmFtIHtCb29sZWFufSBtYXNrIFNwZWNpZmllcyB3aGV0aGVyIG9yIG5vdCB0byBtYXNrIGBkYXRhYAoJICAgKiBAcHVibGljCgkgICAqLwoJICBwaW5nIChkYXRhLCBtYXNrKSB7CgkgICAgdmFyIHJlYWRPbmx5ID0gdHJ1ZTsKCgkgICAgaWYgKGRhdGEgJiYgIUJ1ZmZlci5pc0J1ZmZlcihkYXRhKSkgewoJICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgewoJICAgICAgICBkYXRhID0gQnVmZmVyLmZyb20oZGF0YSk7CgkgICAgICB9IGVsc2UgaWYgKEFycmF5QnVmZmVyLmlzVmlldyhkYXRhKSkgewoJICAgICAgICBkYXRhID0gdmlld1RvQnVmZmVyKGRhdGEpOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgZGF0YSA9IEJ1ZmZlci5mcm9tKGRhdGEpOwoJICAgICAgICByZWFkT25seSA9IGZhbHNlOwoJICAgICAgfQoJICAgIH0KCgkgICAgaWYgKHRoaXMuZGVmbGF0aW5nKSB7CgkgICAgICB0aGlzLmVucXVldWUoW3RoaXMuZG9QaW5nLCBkYXRhLCBtYXNrLCByZWFkT25seV0pOwoJICAgIH0gZWxzZSB7CgkgICAgICB0aGlzLmRvUGluZyhkYXRhLCBtYXNrLCByZWFkT25seSk7CgkgICAgfQoJICB9CgoJICAvKioKCSAgICogRnJhbWVzIGFuZCBzZW5kcyBhIHBpbmcgbWVzc2FnZS4KCSAgICoKCSAgICogQHBhcmFtIHsqfSBkYXRhIFRoZSBtZXNzYWdlIHRvIHNlbmQKCSAgICogQHBhcmFtIHtCb29sZWFufSBtYXNrIFNwZWNpZmllcyB3aGV0aGVyIG9yIG5vdCB0byBtYXNrIGBkYXRhYAoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IHJlYWRPbmx5IFNwZWNpZmllcyB3aGV0aGVyIGBkYXRhYCBjYW4gYmUgbW9kaWZpZWQKCSAgICogQHByaXZhdGUKCSAgICovCgkgIGRvUGluZyAoZGF0YSwgbWFzaywgcmVhZE9ubHkpIHsKCSAgICB0aGlzLmZyYW1lQW5kU2VuZChkYXRhLCB7CgkgICAgICBvcGNvZGU6IDB4MDksCgkgICAgICByc3YxOiBmYWxzZSwKCSAgICAgIGZpbjogdHJ1ZSwKCSAgICAgIHJlYWRPbmx5LAoJICAgICAgbWFzawoJICAgIH0pOwoJICB9CgoJICAvKioKCSAgICogU2VuZHMgYSBwb25nIG1lc3NhZ2UgdG8gdGhlIG90aGVyIHBlZXIuCgkgICAqCgkgICAqIEBwYXJhbSB7Kn0gZGF0YSBUaGUgbWVzc2FnZSB0byBzZW5kCgkgICAqIEBwYXJhbSB7Qm9vbGVhbn0gbWFzayBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gbWFzayBgZGF0YWAKCSAgICogQHB1YmxpYwoJICAgKi8KCSAgcG9uZyAoZGF0YSwgbWFzaykgewoJICAgIHZhciByZWFkT25seSA9IHRydWU7CgoJICAgIGlmIChkYXRhICYmICFCdWZmZXIuaXNCdWZmZXIoZGF0YSkpIHsKCSAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsKCSAgICAgICAgZGF0YSA9IEJ1ZmZlci5mcm9tKGRhdGEpOwoJICAgICAgfSBlbHNlIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcoZGF0YSkpIHsKCSAgICAgICAgZGF0YSA9IHZpZXdUb0J1ZmZlcihkYXRhKTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGRhdGEgPSBCdWZmZXIuZnJvbShkYXRhKTsKCSAgICAgICAgcmVhZE9ubHkgPSBmYWxzZTsKCSAgICAgIH0KCSAgICB9CgoJICAgIGlmICh0aGlzLmRlZmxhdGluZykgewoJICAgICAgdGhpcy5lbnF1ZXVlKFt0aGlzLmRvUG9uZywgZGF0YSwgbWFzaywgcmVhZE9ubHldKTsKCSAgICB9IGVsc2UgewoJICAgICAgdGhpcy5kb1BvbmcoZGF0YSwgbWFzaywgcmVhZE9ubHkpOwoJICAgIH0KCSAgfQoKCSAgLyoqCgkgICAqIEZyYW1lcyBhbmQgc2VuZHMgYSBwb25nIG1lc3NhZ2UuCgkgICAqCgkgICAqIEBwYXJhbSB7Kn0gZGF0YSBUaGUgbWVzc2FnZSB0byBzZW5kCgkgICAqIEBwYXJhbSB7Qm9vbGVhbn0gbWFzayBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gbWFzayBgZGF0YWAKCSAgICogQHBhcmFtIHtCb29sZWFufSByZWFkT25seSBTcGVjaWZpZXMgd2hldGhlciBgZGF0YWAgY2FuIGJlIG1vZGlmaWVkCgkgICAqIEBwcml2YXRlCgkgICAqLwoJICBkb1BvbmcgKGRhdGEsIG1hc2ssIHJlYWRPbmx5KSB7CgkgICAgdGhpcy5mcmFtZUFuZFNlbmQoZGF0YSwgewoJICAgICAgb3Bjb2RlOiAweDBhLAoJICAgICAgcnN2MTogZmFsc2UsCgkgICAgICBmaW46IHRydWUsCgkgICAgICByZWFkT25seSwKCSAgICAgIG1hc2sKCSAgICB9KTsKCSAgfQoKCSAgLyoqCgkgICAqIFNlbmRzIGEgZGF0YSBtZXNzYWdlIHRvIHRoZSBvdGhlciBwZWVyLgoJICAgKgoJICAgKiBAcGFyYW0geyp9IGRhdGEgVGhlIG1lc3NhZ2UgdG8gc2VuZAoJICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBPcHRpb25zIG9iamVjdAoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMuY29tcHJlc3MgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIGNvbXByZXNzIGBkYXRhYAoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMuYmluYXJ5IFNwZWNpZmllcyB3aGV0aGVyIGBkYXRhYCBpcyBiaW5hcnkgb3IgdGV4dAoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMuZmluIFNwZWNpZmllcyB3aGV0aGVyIHRoZSBmcmFnbWVudCBpcyB0aGUgbGFzdCBvbmUKCSAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLm1hc2sgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIG1hc2sgYGRhdGFgCgkgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIENhbGxiYWNrCgkgICAqIEBwdWJsaWMKCSAgICovCgkgIHNlbmQgKGRhdGEsIG9wdGlvbnMsIGNiKSB7CgkgICAgdmFyIG9wY29kZSA9IG9wdGlvbnMuYmluYXJ5ID8gMiA6IDE7CgkgICAgdmFyIHJzdjEgPSBvcHRpb25zLmNvbXByZXNzOwoJICAgIHZhciByZWFkT25seSA9IHRydWU7CgoJICAgIGlmIChkYXRhICYmICFCdWZmZXIuaXNCdWZmZXIoZGF0YSkpIHsKCSAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsKCSAgICAgICAgZGF0YSA9IEJ1ZmZlci5mcm9tKGRhdGEpOwoJICAgICAgfSBlbHNlIGlmIChBcnJheUJ1ZmZlci5pc1ZpZXcoZGF0YSkpIHsKCSAgICAgICAgZGF0YSA9IHZpZXdUb0J1ZmZlcihkYXRhKTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGRhdGEgPSBCdWZmZXIuZnJvbShkYXRhKTsKCSAgICAgICAgcmVhZE9ubHkgPSBmYWxzZTsKCSAgICAgIH0KCSAgICB9CgoJICAgIGlmICh0aGlzLmZpcnN0RnJhZ21lbnQpIHsKCSAgICAgIHRoaXMuZmlyc3RGcmFnbWVudCA9IGZhbHNlOwoJICAgICAgaWYgKHJzdjEgJiYgZGF0YSAmJiB0aGlzLnBlck1lc3NhZ2VEZWZsYXRlKSB7CgkgICAgICAgIHJzdjEgPSBkYXRhLmxlbmd0aCA+PSB0aGlzLnBlck1lc3NhZ2VEZWZsYXRlLnRocmVzaG9sZDsKCSAgICAgIH0KCSAgICAgIHRoaXMuY29tcHJlc3MgPSByc3YxOwoJICAgIH0gZWxzZSB7CgkgICAgICByc3YxID0gZmFsc2U7CgkgICAgICBvcGNvZGUgPSAwOwoJICAgIH0KCgkgICAgaWYgKG9wdGlvbnMuZmluKSB0aGlzLmZpcnN0RnJhZ21lbnQgPSB0cnVlOwoKCSAgICBpZiAodGhpcy5wZXJNZXNzYWdlRGVmbGF0ZSkgewoJICAgICAgY29uc3Qgb3B0cyA9IHsKCSAgICAgICAgY29tcHJlc3M6IHRoaXMuY29tcHJlc3MsCgkgICAgICAgIG1hc2s6IG9wdGlvbnMubWFzaywKCSAgICAgICAgZmluOiBvcHRpb25zLmZpbiwKCSAgICAgICAgcmVhZE9ubHksCgkgICAgICAgIG9wY29kZSwKCSAgICAgICAgcnN2MQoJICAgICAgfTsKCgkgICAgICBpZiAodGhpcy5kZWZsYXRpbmcpIHsKCSAgICAgICAgdGhpcy5lbnF1ZXVlKFt0aGlzLmRpc3BhdGNoLCBkYXRhLCBvcHRzLCBjYl0pOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgdGhpcy5kaXNwYXRjaChkYXRhLCBvcHRzLCBjYik7CgkgICAgICB9CgkgICAgfSBlbHNlIHsKCSAgICAgIHRoaXMuZnJhbWVBbmRTZW5kKGRhdGEsIHsKCSAgICAgICAgbWFzazogb3B0aW9ucy5tYXNrLAoJICAgICAgICBmaW46IG9wdGlvbnMuZmluLAoJICAgICAgICByc3YxOiBmYWxzZSwKCSAgICAgICAgcmVhZE9ubHksCgkgICAgICAgIG9wY29kZQoJICAgICAgfSwgY2IpOwoJICAgIH0KCSAgfQoKCSAgLyoqCgkgICAqIERpc3BhdGNoZXMgYSBkYXRhIG1lc3NhZ2UuCgkgICAqCgkgICAqIEBwYXJhbSB7QnVmZmVyfSBkYXRhIFRoZSBtZXNzYWdlIHRvIHNlbmQKCSAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgT3B0aW9ucyBvYmplY3QKCSAgICogQHBhcmFtIHtOdW1iZXJ9IG9wdGlvbnMub3Bjb2RlIFRoZSBvcGNvZGUKCSAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLnJlYWRPbmx5IFNwZWNpZmllcyB3aGV0aGVyIGBkYXRhYCBjYW4gYmUgbW9kaWZpZWQKCSAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLmZpbiBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gc2V0IHRoZSBGSU4gYml0CgkgICAqIEBwYXJhbSB7Qm9vbGVhbn0gb3B0aW9ucy5jb21wcmVzcyBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gY29tcHJlc3MgYGRhdGFgCgkgICAqIEBwYXJhbSB7Qm9vbGVhbn0gb3B0aW9ucy5tYXNrIFNwZWNpZmllcyB3aGV0aGVyIG9yIG5vdCB0byBtYXNrIGBkYXRhYAoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMucnN2MSBTcGVjaWZpZXMgd2hldGhlciBvciBub3QgdG8gc2V0IHRoZSBSU1YxIGJpdAoJICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYiBDYWxsYmFjawoJICAgKiBAcHJpdmF0ZQoJICAgKi8KCSAgZGlzcGF0Y2ggKGRhdGEsIG9wdGlvbnMsIGNiKSB7CgkgICAgaWYgKCFvcHRpb25zLmNvbXByZXNzKSB7CgkgICAgICB0aGlzLmZyYW1lQW5kU2VuZChkYXRhLCBvcHRpb25zLCBjYik7CgkgICAgICByZXR1cm47CgkgICAgfQoKCSAgICB0aGlzLmRlZmxhdGluZyA9IHRydWU7CgkgICAgdGhpcy5wZXJNZXNzYWdlRGVmbGF0ZS5jb21wcmVzcyhkYXRhLCBvcHRpb25zLmZpbiwgKGVyciwgYnVmKSA9PiB7CgkgICAgICBpZiAoZXJyKSB7CgkgICAgICAgIGlmIChjYikgY2IoZXJyKTsKCSAgICAgICAgZWxzZSB0aGlzLm9uZXJyb3IoZXJyKTsKCSAgICAgICAgcmV0dXJuOwoJICAgICAgfQoKCSAgICAgIG9wdGlvbnMucmVhZE9ubHkgPSBmYWxzZTsKCSAgICAgIHRoaXMuZnJhbWVBbmRTZW5kKGJ1Ziwgb3B0aW9ucywgY2IpOwoJICAgICAgdGhpcy5kZWZsYXRpbmcgPSBmYWxzZTsKCSAgICAgIHRoaXMuZGVxdWV1ZSgpOwoJICAgIH0pOwoJICB9CgoJICAvKioKCSAgICogRnJhbWVzIGFuZCBzZW5kcyBhIHBpZWNlIG9mIGRhdGEgYWNjb3JkaW5nIHRvIHRoZSBIeUJpIFdlYlNvY2tldCBwcm90b2NvbC4KCSAgICoKCSAgICogQHBhcmFtIHtCdWZmZXJ9IGRhdGEgVGhlIGRhdGEgdG8gc2VuZAoJICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBPcHRpb25zIG9iamVjdAoJICAgKiBAcGFyYW0ge051bWJlcn0gb3B0aW9ucy5vcGNvZGUgVGhlIG9wY29kZQoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMucmVhZE9ubHkgU3BlY2lmaWVzIHdoZXRoZXIgYGRhdGFgIGNhbiBiZSBtb2RpZmllZAoJICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9wdGlvbnMuZmluIFNwZWNpZmllcyB3aGV0aGVyIG9yIG5vdCB0byBzZXQgdGhlIEZJTiBiaXQKCSAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLm1hc2sgU3BlY2lmaWVzIHdoZXRoZXIgb3Igbm90IHRvIG1hc2sgYGRhdGFgCgkgICAqIEBwYXJhbSB7Qm9vbGVhbn0gb3B0aW9ucy5yc3YxIFNwZWNpZmllcyB3aGV0aGVyIG9yIG5vdCB0byBzZXQgdGhlIFJTVjEgYml0CgkgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIENhbGxiYWNrCgkgICAqIEBwcml2YXRlCgkgICAqLwoJICBmcmFtZUFuZFNlbmQgKGRhdGEsIG9wdGlvbnMsIGNiKSB7CgkgICAgaWYgKCFkYXRhKSB7CgkgICAgICBjb25zdCBieXRlcyA9IFtvcHRpb25zLm9wY29kZSwgMF07CgoJICAgICAgaWYgKG9wdGlvbnMuZmluKSBieXRlc1swXSB8PSAweDgwOwoJICAgICAgaWYgKG9wdGlvbnMubWFzaykgewoJICAgICAgICBieXRlc1sxXSB8PSAweDgwOwoJICAgICAgICBieXRlcy5wdXNoKDAsIDAsIDAsIDApOwoJICAgICAgfQoKCSAgICAgIHNlbmRGcmFtZWREYXRhKHRoaXMsIEJ1ZmZlci5mcm9tKGJ5dGVzKSwgbnVsbCwgY2IpOwoJICAgICAgcmV0dXJuOwoJICAgIH0KCgkgICAgY29uc3QgbWVyZ2VCdWZmZXJzID0gZGF0YS5sZW5ndGggPCAxMDI0IHx8IG9wdGlvbnMubWFzayAmJiBvcHRpb25zLnJlYWRPbmx5OwoJICAgIHZhciBkYXRhT2Zmc2V0ID0gb3B0aW9ucy5tYXNrID8gNiA6IDI7CgkgICAgdmFyIHBheWxvYWRMZW5ndGggPSBkYXRhLmxlbmd0aDsKCgkgICAgaWYgKGRhdGEubGVuZ3RoID49IDY1NTM2KSB7CgkgICAgICBkYXRhT2Zmc2V0ICs9IDg7CgkgICAgICBwYXlsb2FkTGVuZ3RoID0gMTI3OwoJICAgIH0gZWxzZSBpZiAoZGF0YS5sZW5ndGggPiAxMjUpIHsKCSAgICAgIGRhdGFPZmZzZXQgKz0gMjsKCSAgICAgIHBheWxvYWRMZW5ndGggPSAxMjY7CgkgICAgfQoKCSAgICBjb25zdCBvdXRwdXRCdWZmZXIgPSBCdWZmZXIuYWxsb2NVbnNhZmUoCgkgICAgICBtZXJnZUJ1ZmZlcnMgPyBkYXRhLmxlbmd0aCArIGRhdGFPZmZzZXQgOiBkYXRhT2Zmc2V0CgkgICAgKTsKCgkgICAgb3V0cHV0QnVmZmVyWzBdID0gb3B0aW9ucy5maW4gPyBvcHRpb25zLm9wY29kZSB8IDB4ODAgOiBvcHRpb25zLm9wY29kZTsKCSAgICBpZiAob3B0aW9ucy5yc3YxKSBvdXRwdXRCdWZmZXJbMF0gfD0gMHg0MDsKCgkgICAgaWYgKHBheWxvYWRMZW5ndGggPT09IDEyNikgewoJICAgICAgb3V0cHV0QnVmZmVyLndyaXRlVUludDE2QkUoZGF0YS5sZW5ndGgsIDIsIHRydWUpOwoJICAgIH0gZWxzZSBpZiAocGF5bG9hZExlbmd0aCA9PT0gMTI3KSB7CgkgICAgICBvdXRwdXRCdWZmZXIud3JpdGVVSW50MzJCRSgwLCAyLCB0cnVlKTsKCSAgICAgIG91dHB1dEJ1ZmZlci53cml0ZVVJbnQzMkJFKGRhdGEubGVuZ3RoLCA2LCB0cnVlKTsKCSAgICB9CgoJICAgIGlmIChvcHRpb25zLm1hc2spIHsKCSAgICAgIGNvbnN0IG1hc2sgPSBnZXRSYW5kb21NYXNrKCk7CgoJICAgICAgb3V0cHV0QnVmZmVyWzFdID0gcGF5bG9hZExlbmd0aCB8IDB4ODA7CgkgICAgICBvdXRwdXRCdWZmZXJbZGF0YU9mZnNldCAtIDRdID0gbWFza1swXTsKCSAgICAgIG91dHB1dEJ1ZmZlcltkYXRhT2Zmc2V0IC0gM10gPSBtYXNrWzFdOwoJICAgICAgb3V0cHV0QnVmZmVyW2RhdGFPZmZzZXQgLSAyXSA9IG1hc2tbMl07CgkgICAgICBvdXRwdXRCdWZmZXJbZGF0YU9mZnNldCAtIDFdID0gbWFza1szXTsKCgkgICAgICBpZiAobWVyZ2VCdWZmZXJzKSB7CgkgICAgICAgIGJ1ZmZlclV0aWwubWFzayhkYXRhLCBtYXNrLCBvdXRwdXRCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGEubGVuZ3RoKTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGJ1ZmZlclV0aWwubWFzayhkYXRhLCBtYXNrLCBkYXRhLCAwLCBkYXRhLmxlbmd0aCk7CgkgICAgICB9CgkgICAgfSBlbHNlIHsKCSAgICAgIG91dHB1dEJ1ZmZlclsxXSA9IHBheWxvYWRMZW5ndGg7CgkgICAgICBpZiAobWVyZ2VCdWZmZXJzKSBkYXRhLmNvcHkob3V0cHV0QnVmZmVyLCBkYXRhT2Zmc2V0KTsKCSAgICB9CgoJICAgIHNlbmRGcmFtZWREYXRhKHRoaXMsIG91dHB1dEJ1ZmZlciwgbWVyZ2VCdWZmZXJzID8gbnVsbCA6IGRhdGEsIGNiKTsKCSAgfQoKCSAgLyoqCgkgICAqIEV4ZWN1dGVzIHF1ZXVlZCBzZW5kIG9wZXJhdGlvbnMuCgkgICAqCgkgICAqIEBwcml2YXRlCgkgICAqLwoJICBkZXF1ZXVlICgpIHsKCSAgICB3aGlsZSAoIXRoaXMuZGVmbGF0aW5nICYmIHRoaXMucXVldWUubGVuZ3RoKSB7CgkgICAgICBjb25zdCBwYXJhbXMgPSB0aGlzLnF1ZXVlLnNoaWZ0KCk7CgoJICAgICAgaWYgKHBhcmFtc1sxXSkgdGhpcy5idWZmZXJlZEJ5dGVzIC09IHBhcmFtc1sxXS5sZW5ndGg7CgkgICAgICBwYXJhbXNbMF0uYXBwbHkodGhpcywgcGFyYW1zLnNsaWNlKDEpKTsKCSAgICB9CgkgIH0KCgkgIC8qKgoJICAgKiBFbnF1ZXVlcyBhIHNlbmQgb3BlcmF0aW9uLgoJICAgKgoJICAgKiBAcGFyYW0ge0FycmF5fSBwYXJhbXMgU2VuZCBvcGVyYXRpb24gcGFyYW1ldGVycy4KCSAgICogQHByaXZhdGUKCSAgICovCgkgIGVucXVldWUgKHBhcmFtcykgewoJICAgIGlmIChwYXJhbXNbMV0pIHRoaXMuYnVmZmVyZWRCeXRlcyArPSBwYXJhbXNbMV0ubGVuZ3RoOwoJICAgIHRoaXMucXVldWUucHVzaChwYXJhbXMpOwoJICB9Cgl9CgoJbW9kdWxlLmV4cG9ydHMgPSBTZW5kZXI7CgoJLyoqCgkgKiBDb252ZXJ0cyBhbiBgQXJyYXlCdWZmZXJgIHZpZXcgaW50byBhIGJ1ZmZlci4KCSAqCgkgKiBAcGFyYW0geyhEYXRhVmlld3xUeXBlZEFycmF5KX0gdmlldyBUaGUgdmlldyB0byBjb252ZXJ0CgkgKiBAcmV0dXJuIHtCdWZmZXJ9IENvbnZlcnRlZCB2aWV3CgkgKiBAcHJpdmF0ZQoJICovCglmdW5jdGlvbiB2aWV3VG9CdWZmZXIgKHZpZXcpIHsKCSAgY29uc3QgYnVmID0gQnVmZmVyLmZyb20odmlldy5idWZmZXIpOwoKCSAgaWYgKHZpZXcuYnl0ZUxlbmd0aCAhPT0gdmlldy5idWZmZXIuYnl0ZUxlbmd0aCkgewoJICAgIHJldHVybiBidWYuc2xpY2Uodmlldy5ieXRlT2Zmc2V0LCB2aWV3LmJ5dGVPZmZzZXQgKyB2aWV3LmJ5dGVMZW5ndGgpOwoJICB9CgoJICByZXR1cm4gYnVmOwoJfQoKCS8qKgoJICogR2VuZXJhdGVzIGEgcmFuZG9tIG1hc2suCgkgKgoJICogQHJldHVybiB7QnVmZmVyfSBUaGUgbWFzawoJICogQHByaXZhdGUKCSAqLwoJZnVuY3Rpb24gZ2V0UmFuZG9tTWFzayAoKSB7CgkgIHJldHVybiBjcnlwdG8ucmFuZG9tQnl0ZXMoNCk7Cgl9CgoJLyoqCgkgKiBTZW5kcyBhIGZyYW1lLgoJICoKCSAqIEBwYXJhbSB7U2VuZGVyfSBzZW5kZXIgU2VuZGVyIGluc3RhbmNlCgkgKiBAcGFyYW0ge0J1ZmZlcn0gb3V0cHV0QnVmZmVyIFRoZSBkYXRhIHRvIHNlbmQKCSAqIEBwYXJhbSB7QnVmZmVyfSBkYXRhIEFkZGl0aW9uYWwgZGF0YSB0byBzZW5kIGlmIGZyYW1lIGlzIHNwbGl0IGludG8gdHdvIGJ1ZmZlcnMKCSAqIEBwYXJhbSB7RnVuY3Rpb259IGNiIENhbGxiYWNrCgkgKiBAcHJpdmF0ZQoJICovCglmdW5jdGlvbiBzZW5kRnJhbWVkRGF0YSAoc2VuZGVyLCBvdXRwdXRCdWZmZXIsIGRhdGEsIGNiKSB7CgkgIGlmIChkYXRhKSB7CgkgICAgc2VuZGVyLl9zb2NrZXQud3JpdGUob3V0cHV0QnVmZmVyKTsKCSAgICBzZW5kZXIuX3NvY2tldC53cml0ZShkYXRhLCBjYik7CgkgIH0gZWxzZSB7CgkgICAgc2VuZGVyLl9zb2NrZXQud3JpdGUob3V0cHV0QnVmZmVyLCBjYik7CgkgIH0KCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5CdWZmZXIpKQoKLyoqKi8gfSwKLyogMTExICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIpIHsvKiEKCSAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudAoJICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+CgkgKiBNSVQgTGljZW5zZWQKCSAqLwoKCSd1c2Ugc3RyaWN0JzsKCgljb25zdCBFdmVudEVtaXR0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoJY29uc3QgY3J5cHRvID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsKCWNvbnN0IFVsdHJvbiA9IF9fd2VicGFja19yZXF1aXJlX18oNjIpOwoJY29uc3QgaHR0cCA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpOwoJY29uc3QgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7CgoJY29uc3QgUGVyTWVzc2FnZURlZmxhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc4KTsKCWNvbnN0IEV4dGVuc2lvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk0KTsKCWNvbnN0IFdlYlNvY2tldCA9IF9fd2VicGFja19yZXF1aXJlX18oMik7CgoJY29uc3QgR1VJRCA9ICcyNThFQUZBNS1FOTE0LTQ3REEtOTVDQS1DNUFCMERDODVCMTEnOwoKCS8qKgoJICogQ2xhc3MgcmVwcmVzZW50aW5nIGEgV2ViU29ja2V0IHNlcnZlci4KCSAqCgkgKiBAZXh0ZW5kcyBFdmVudEVtaXR0ZXIKCSAqLwoJY2xhc3MgV2ViU29ja2V0U2VydmVyIGV4dGVuZHMgRXZlbnRFbWl0dGVyIHsKCSAgLyoqCgkgICAqIENyZWF0ZSBhIGBXZWJTb2NrZXRTZXJ2ZXJgIGluc3RhbmNlLgoJICAgKgoJICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBDb25maWd1cmF0aW9uIG9wdGlvbnMKCSAgICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMuaG9zdCBUaGUgaG9zdG5hbWUgd2hlcmUgdG8gYmluZCB0aGUgc2VydmVyCgkgICAqIEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLnBvcnQgVGhlIHBvcnQgd2hlcmUgdG8gYmluZCB0aGUgc2VydmVyCgkgICAqIEBwYXJhbSB7aHR0cC5TZXJ2ZXJ9IG9wdGlvbnMuc2VydmVyIEEgcHJlLWNyZWF0ZWQgSFRUUC9TIHNlcnZlciB0byB1c2UKCSAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy52ZXJpZnlDbGllbnQgQW4gaG9vayB0byByZWplY3QgY29ubmVjdGlvbnMKCSAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5oYW5kbGVQcm90b2NvbHMgQW4gaG9vayB0byBoYW5kbGUgcHJvdG9jb2xzCgkgICAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLnBhdGggQWNjZXB0IG9ubHkgY29ubmVjdGlvbnMgbWF0Y2hpbmcgdGhpcyBwYXRoCgkgICAqIEBwYXJhbSB7Qm9vbGVhbn0gb3B0aW9ucy5ub1NlcnZlciBFbmFibGUgbm8gc2VydmVyIG1vZGUKCSAgICogQHBhcmFtIHtCb29sZWFufSBvcHRpb25zLmNsaWVudFRyYWNraW5nIFNwZWNpZmllcyB3aGV0aGVyIG9yIG5vdCB0byB0cmFjayBjbGllbnRzCgkgICAqIEBwYXJhbSB7KEJvb2xlYW58T2JqZWN0KX0gb3B0aW9ucy5wZXJNZXNzYWdlRGVmbGF0ZSBFbmFibGUvZGlzYWJsZSBwZXJtZXNzYWdlLWRlZmxhdGUKCSAgICogQHBhcmFtIHtOdW1iZXJ9IG9wdGlvbnMubWF4UGF5bG9hZCBUaGUgbWF4aW11bSBhbGxvd2VkIG1lc3NhZ2Ugc2l6ZQoJICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBBIGxpc3RlbmVyIGZvciB0aGUgYGxpc3RlbmluZ2AgZXZlbnQKCSAgICovCgkgIGNvbnN0cnVjdG9yIChvcHRpb25zLCBjYWxsYmFjaykgewoJICAgIHN1cGVyKCk7CgoJICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsKCSAgICAgIG1heFBheWxvYWQ6IDEwMCAqIDEwMjQgKiAxMDI0LAoJICAgICAgcGVyTWVzc2FnZURlZmxhdGU6IHRydWUsCgkgICAgICBoYW5kbGVQcm90b2NvbHM6IG51bGwsCgkgICAgICBjbGllbnRUcmFja2luZzogdHJ1ZSwKCSAgICAgIHZlcmlmeUNsaWVudDogbnVsbCwKCSAgICAgIG5vU2VydmVyOiBmYWxzZSwKCSAgICAgIGJhY2tsb2c6IG51bGwsIC8vIHVzZSBkZWZhdWx0ICg1MTEgYXMgaW1wbGVtZW50ZWQgaW4gbmV0LmpzKQoJICAgICAgc2VydmVyOiBudWxsLAoJICAgICAgaG9zdDogbnVsbCwKCSAgICAgIHBhdGg6IG51bGwsCgkgICAgICBwb3J0OiBudWxsCgkgICAgfSwgb3B0aW9ucyk7CgoJICAgIGlmIChvcHRpb25zLnBvcnQgPT0gbnVsbCAmJiAhb3B0aW9ucy5zZXJ2ZXIgJiYgIW9wdGlvbnMubm9TZXJ2ZXIpIHsKCSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ21pc3Npbmcgb3IgaW52YWxpZCBvcHRpb25zJyk7CgkgICAgfQoKCSAgICBpZiAob3B0aW9ucy5wb3J0ICE9IG51bGwpIHsKCSAgICAgIHRoaXMuX3NlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKChyZXEsIHJlcykgPT4gewoJICAgICAgICBjb25zdCBib2R5ID0gaHR0cC5TVEFUVVNfQ09ERVNbNDI2XTsKCgkgICAgICAgIHJlcy53cml0ZUhlYWQoNDI2LCB7CgkgICAgICAgICAgJ0NvbnRlbnQtTGVuZ3RoJzogYm9keS5sZW5ndGgsCgkgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3BsYWluJwoJICAgICAgICB9KTsKCSAgICAgICAgcmVzLmVuZChib2R5KTsKCSAgICAgIH0pOwoJICAgICAgdGhpcy5fc2VydmVyLmFsbG93SGFsZk9wZW4gPSBmYWxzZTsKCSAgICAgIHRoaXMuX3NlcnZlci5saXN0ZW4ob3B0aW9ucy5wb3J0LCBvcHRpb25zLmhvc3QsIG9wdGlvbnMuYmFja2xvZywgY2FsbGJhY2spOwoJICAgIH0gZWxzZSBpZiAob3B0aW9ucy5zZXJ2ZXIpIHsKCSAgICAgIHRoaXMuX3NlcnZlciA9IG9wdGlvbnMuc2VydmVyOwoJICAgIH0KCgkgICAgaWYgKHRoaXMuX3NlcnZlcikgewoJICAgICAgdGhpcy5fdWx0cm9uID0gbmV3IFVsdHJvbih0aGlzLl9zZXJ2ZXIpOwoJICAgICAgdGhpcy5fdWx0cm9uLm9uKCdsaXN0ZW5pbmcnLCAoKSA9PiB0aGlzLmVtaXQoJ2xpc3RlbmluZycpKTsKCSAgICAgIHRoaXMuX3VsdHJvbi5vbignZXJyb3InLCAoZXJyKSA9PiB0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKSk7CgkgICAgICB0aGlzLl91bHRyb24ub24oJ3VwZ3JhZGUnLCAocmVxLCBzb2NrZXQsIGhlYWQpID0+IHsKCSAgICAgICAgdGhpcy5oYW5kbGVVcGdyYWRlKHJlcSwgc29ja2V0LCBoZWFkLCAoY2xpZW50KSA9PiB7CgkgICAgICAgICAgdGhpcy5lbWl0KGBjb25uZWN0aW9uJHtyZXEudXJsfWAsIGNsaWVudCk7CgkgICAgICAgICAgdGhpcy5lbWl0KCdjb25uZWN0aW9uJywgY2xpZW50KTsKCSAgICAgICAgfSk7CgkgICAgICB9KTsKCSAgICB9CgoJICAgIGlmIChvcHRpb25zLmNsaWVudFRyYWNraW5nKSB0aGlzLmNsaWVudHMgPSBuZXcgU2V0KCk7CgkgICAgdGhpcy5vcHRpb25zID0gb3B0aW9uczsKCSAgICB0aGlzLnBhdGggPSBvcHRpb25zLnBhdGg7CgkgIH0KCgkgIC8qKgoJICAgKiBDbG9zZSB0aGUgc2VydmVyLgoJICAgKgoJICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYiBDYWxsYmFjawoJICAgKiBAcHVibGljCgkgICAqLwoJICBjbG9zZSAoY2IpIHsKCSAgICAvLwoJICAgIC8vIFRlcm1pbmF0ZSBhbGwgYXNzb2NpYXRlZCBjbGllbnRzLgoJICAgIC8vCgkgICAgaWYgKHRoaXMuY2xpZW50cykgewoJICAgICAgZm9yIChjb25zdCBjbGllbnQgb2YgdGhpcy5jbGllbnRzKSBjbGllbnQudGVybWluYXRlKCk7CgkgICAgfQoKCSAgICBjb25zdCBzZXJ2ZXIgPSB0aGlzLl9zZXJ2ZXI7CgoJICAgIGlmIChzZXJ2ZXIpIHsKCSAgICAgIHRoaXMuX3VsdHJvbi5kZXN0cm95KCk7CgkgICAgICB0aGlzLl91bHRyb24gPSB0aGlzLl9zZXJ2ZXIgPSBudWxsOwoKCSAgICAgIC8vCgkgICAgICAvLyBDbG9zZSB0aGUgaHR0cCBzZXJ2ZXIgaWYgaXQgd2FzIGludGVybmFsbHkgY3JlYXRlZC4KCSAgICAgIC8vCgkgICAgICBpZiAodGhpcy5vcHRpb25zLnBvcnQgIT0gbnVsbCkgcmV0dXJuIHNlcnZlci5jbG9zZShjYik7CgkgICAgfQoKCSAgICBpZiAoY2IpIGNiKCk7CgkgIH0KCgkgIC8qKgoJICAgKiBTZWUgaWYgYSBnaXZlbiByZXF1ZXN0IHNob3VsZCBiZSBoYW5kbGVkIGJ5IHRoaXMgc2VydmVyIGluc3RhbmNlLgoJICAgKgoJICAgKiBAcGFyYW0ge2h0dHAuSW5jb21pbmdNZXNzYWdlfSByZXEgUmVxdWVzdCBvYmplY3QgdG8gaW5zcGVjdAoJICAgKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgdGhlIHJlcXVlc3QgaXMgdmFsaWQsIGVsc2UgYGZhbHNlYAoJICAgKiBAcHVibGljCgkgICAqLwoJICBzaG91bGRIYW5kbGUgKHJlcSkgewoJICAgIGlmICh0aGlzLm9wdGlvbnMucGF0aCAmJiB1cmwucGFyc2UocmVxLnVybCkucGF0aG5hbWUgIT09IHRoaXMub3B0aW9ucy5wYXRoKSB7CgkgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfQoKCSAgICByZXR1cm4gdHJ1ZTsKCSAgfQoKCSAgLyoqCgkgICAqIEhhbmRsZSBhIEhUVFAgVXBncmFkZSByZXF1ZXN0LgoJICAgKgoJICAgKiBAcGFyYW0ge2h0dHAuSW5jb21pbmdNZXNzYWdlfSByZXEgVGhlIHJlcXVlc3Qgb2JqZWN0CgkgICAqIEBwYXJhbSB7bmV0LlNvY2tldH0gc29ja2V0IFRoZSBuZXR3b3JrIHNvY2tldCBiZXR3ZWVuIHRoZSBzZXJ2ZXIgYW5kIGNsaWVudAoJICAgKiBAcGFyYW0ge0J1ZmZlcn0gaGVhZCBUaGUgZmlyc3QgcGFja2V0IG9mIHRoZSB1cGdyYWRlZCBzdHJlYW0KCSAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2IgQ2FsbGJhY2sKCSAgICogQHB1YmxpYwoJICAgKi8KCSAgaGFuZGxlVXBncmFkZSAocmVxLCBzb2NrZXQsIGhlYWQsIGNiKSB7CgkgICAgc29ja2V0Lm9uKCdlcnJvcicsIHNvY2tldEVycm9yKTsKCgkgICAgY29uc3QgdmVyc2lvbiA9ICtyZXEuaGVhZGVyc1snc2VjLXdlYnNvY2tldC12ZXJzaW9uJ107CgoJICAgIGlmICgKCSAgICAgIHJlcS5tZXRob2QgIT09ICdHRVQnIHx8IHJlcS5oZWFkZXJzLnVwZ3JhZGUudG9Mb3dlckNhc2UoKSAhPT0gJ3dlYnNvY2tldCcgfHwKCSAgICAgICFyZXEuaGVhZGVyc1snc2VjLXdlYnNvY2tldC1rZXknXSB8fCB2ZXJzaW9uICE9PSA4ICYmIHZlcnNpb24gIT09IDEzIHx8CgkgICAgICAhdGhpcy5zaG91bGRIYW5kbGUocmVxKQoJICAgICkgewoJICAgICAgcmV0dXJuIGFib3J0Q29ubmVjdGlvbihzb2NrZXQsIDQwMCk7CgkgICAgfQoKCSAgICB2YXIgcHJvdG9jb2wgPSAocmVxLmhlYWRlcnNbJ3NlYy13ZWJzb2NrZXQtcHJvdG9jb2wnXSB8fCAnJykuc3BsaXQoLywgKi8pOwoKCSAgICAvLwoJICAgIC8vIE9wdGlvbmFsbHkgY2FsbCBleHRlcm5hbCBwcm90b2NvbCBzZWxlY3Rpb24gaGFuZGxlci4KCSAgICAvLwoJICAgIGlmICh0aGlzLm9wdGlvbnMuaGFuZGxlUHJvdG9jb2xzKSB7CgkgICAgICBwcm90b2NvbCA9IHRoaXMub3B0aW9ucy5oYW5kbGVQcm90b2NvbHMocHJvdG9jb2wpOwoJICAgICAgaWYgKHByb3RvY29sID09PSBmYWxzZSkgcmV0dXJuIGFib3J0Q29ubmVjdGlvbihzb2NrZXQsIDQwMSk7CgkgICAgfSBlbHNlIHsKCSAgICAgIHByb3RvY29sID0gcHJvdG9jb2xbMF07CgkgICAgfQoKCSAgICAvLwoJICAgIC8vIE9wdGlvbmFsbHkgY2FsbCBleHRlcm5hbCBjbGllbnQgdmVyaWZpY2F0aW9uIGhhbmRsZXIuCgkgICAgLy8KCSAgICBpZiAodGhpcy5vcHRpb25zLnZlcmlmeUNsaWVudCkgewoJICAgICAgY29uc3QgaW5mbyA9IHsKCSAgICAgICAgb3JpZ2luOiByZXEuaGVhZGVyc1tgJHt2ZXJzaW9uID09PSA4ID8gJ3NlYy13ZWJzb2NrZXQtb3JpZ2luJyA6ICdvcmlnaW4nfWBdLAoJICAgICAgICBzZWN1cmU6ICEhKHJlcS5jb25uZWN0aW9uLmF1dGhvcml6ZWQgfHwgcmVxLmNvbm5lY3Rpb24uZW5jcnlwdGVkKSwKCSAgICAgICAgcmVxCgkgICAgICB9OwoKCSAgICAgIGlmICh0aGlzLm9wdGlvbnMudmVyaWZ5Q2xpZW50Lmxlbmd0aCA9PT0gMikgewoJICAgICAgICB0aGlzLm9wdGlvbnMudmVyaWZ5Q2xpZW50KGluZm8sICh2ZXJpZmllZCwgY29kZSwgbWVzc2FnZSkgPT4gewoJICAgICAgICAgIGlmICghdmVyaWZpZWQpIHJldHVybiBhYm9ydENvbm5lY3Rpb24oc29ja2V0LCBjb2RlIHx8IDQwMSwgbWVzc2FnZSk7CgoJICAgICAgICAgIHRoaXMuY29tcGxldGVVcGdyYWRlKHByb3RvY29sLCB2ZXJzaW9uLCByZXEsIHNvY2tldCwgaGVhZCwgY2IpOwoJICAgICAgICB9KTsKCSAgICAgICAgcmV0dXJuOwoJICAgICAgfSBlbHNlIGlmICghdGhpcy5vcHRpb25zLnZlcmlmeUNsaWVudChpbmZvKSkgewoJICAgICAgICByZXR1cm4gYWJvcnRDb25uZWN0aW9uKHNvY2tldCwgNDAxKTsKCSAgICAgIH0KCSAgICB9CgoJICAgIHRoaXMuY29tcGxldGVVcGdyYWRlKHByb3RvY29sLCB2ZXJzaW9uLCByZXEsIHNvY2tldCwgaGVhZCwgY2IpOwoJICB9CgoJICAvKioKCSAgICogVXBncmFkZSB0aGUgY29ubmVjdGlvbiB0byBXZWJTb2NrZXQuCgkgICAqCgkgICAqIEBwYXJhbSB7U3RyaW5nfSBwcm90b2NvbCBUaGUgY2hvc2VuIHN1YnByb3RvY29sCgkgICAqIEBwYXJhbSB7TnVtYmVyfSB2ZXJzaW9uIFRoZSBXZWJTb2NrZXQgcHJvdG9jb2wgdmVyc2lvbgoJICAgKiBAcGFyYW0ge2h0dHAuSW5jb21pbmdNZXNzYWdlfSByZXEgVGhlIHJlcXVlc3Qgb2JqZWN0CgkgICAqIEBwYXJhbSB7bmV0LlNvY2tldH0gc29ja2V0IFRoZSBuZXR3b3JrIHNvY2tldCBiZXR3ZWVuIHRoZSBzZXJ2ZXIgYW5kIGNsaWVudAoJICAgKiBAcGFyYW0ge0J1ZmZlcn0gaGVhZCBUaGUgZmlyc3QgcGFja2V0IG9mIHRoZSB1cGdyYWRlZCBzdHJlYW0KCSAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2IgQ2FsbGJhY2sKCSAgICogQHByaXZhdGUKCSAgICovCgkgIGNvbXBsZXRlVXBncmFkZSAocHJvdG9jb2wsIHZlcnNpb24sIHJlcSwgc29ja2V0LCBoZWFkLCBjYikgewoJICAgIC8vCgkgICAgLy8gRGVzdHJveSB0aGUgc29ja2V0IGlmIHRoZSBjbGllbnQgaGFzIGFscmVhZHkgc2VudCBhIEZJTiBwYWNrZXQuCgkgICAgLy8KCSAgICBpZiAoIXNvY2tldC5yZWFkYWJsZSB8fCAhc29ja2V0LndyaXRhYmxlKSByZXR1cm4gc29ja2V0LmRlc3Ryb3koKTsKCgkgICAgY29uc3Qga2V5ID0gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTEnKQoJICAgICAgLnVwZGF0ZShyZXEuaGVhZGVyc1snc2VjLXdlYnNvY2tldC1rZXknXSArIEdVSUQsICdiaW5hcnknKQoJICAgICAgLmRpZ2VzdCgnYmFzZTY0Jyk7CgoJICAgIGNvbnN0IGhlYWRlcnMgPSBbCgkgICAgICAnSFRUUC8xLjEgMTAxIFN3aXRjaGluZyBQcm90b2NvbHMnLAoJICAgICAgJ1VwZ3JhZGU6IHdlYnNvY2tldCcsCgkgICAgICAnQ29ubmVjdGlvbjogVXBncmFkZScsCgkgICAgICBgU2VjLVdlYlNvY2tldC1BY2NlcHQ6ICR7a2V5fWAKCSAgICBdOwoKCSAgICBpZiAocHJvdG9jb2wpIGhlYWRlcnMucHVzaChgU2VjLVdlYlNvY2tldC1Qcm90b2NvbDogJHtwcm90b2NvbH1gKTsKCgkgICAgY29uc3Qgb2ZmZXIgPSBFeHRlbnNpb25zLnBhcnNlKHJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LWV4dGVuc2lvbnMnXSk7CgkgICAgdmFyIGV4dGVuc2lvbnM7CgoJICAgIHRyeSB7CgkgICAgICBleHRlbnNpb25zID0gYWNjZXB0RXh0ZW5zaW9ucyh0aGlzLm9wdGlvbnMsIG9mZmVyKTsKCSAgICB9IGNhdGNoIChlcnIpIHsKCSAgICAgIHJldHVybiBhYm9ydENvbm5lY3Rpb24oc29ja2V0LCA0MDApOwoJICAgIH0KCgkgICAgY29uc3QgcHJvcHMgPSBPYmplY3Qua2V5cyhleHRlbnNpb25zKTsKCgkgICAgaWYgKHByb3BzLmxlbmd0aCkgewoJICAgICAgY29uc3Qgc2VydmVyRXh0ZW5zaW9ucyA9IHByb3BzLnJlZHVjZSgob2JqLCBrZXkpID0+IHsKCSAgICAgICAgb2JqW2tleV0gPSBbZXh0ZW5zaW9uc1trZXldLnBhcmFtc107CgkgICAgICAgIHJldHVybiBvYmo7CgkgICAgICB9LCB7fSk7CgoJICAgICAgaGVhZGVycy5wdXNoKGBTZWMtV2ViU29ja2V0LUV4dGVuc2lvbnM6ICR7RXh0ZW5zaW9ucy5mb3JtYXQoc2VydmVyRXh0ZW5zaW9ucyl9YCk7CgkgICAgfQoKCSAgICAvLwoJICAgIC8vIEFsbG93IGV4dGVybmFsIG1vZGlmaWNhdGlvbi9pbnNwZWN0aW9uIG9mIGhhbmRzaGFrZSBoZWFkZXJzLgoJICAgIC8vCgkgICAgdGhpcy5lbWl0KCdoZWFkZXJzJywgaGVhZGVycyk7CgoJICAgIHNvY2tldC53cml0ZShoZWFkZXJzLmNvbmNhdCgnJywgJycpLmpvaW4oJ1xyXG4nKSk7CgoJICAgIGNvbnN0IGNsaWVudCA9IG5ldyBXZWJTb2NrZXQoW3JlcSwgc29ja2V0LCBoZWFkXSwgewoJICAgICAgbWF4UGF5bG9hZDogdGhpcy5vcHRpb25zLm1heFBheWxvYWQsCgkgICAgICBwcm90b2NvbFZlcnNpb246IHZlcnNpb24sCgkgICAgICBleHRlbnNpb25zLAoJICAgICAgcHJvdG9jb2wKCSAgICB9KTsKCgkgICAgaWYgKHRoaXMuY2xpZW50cykgewoJICAgICAgdGhpcy5jbGllbnRzLmFkZChjbGllbnQpOwoJICAgICAgY2xpZW50Lm9uKCdjbG9zZScsICgpID0+IHRoaXMuY2xpZW50cy5kZWxldGUoY2xpZW50KSk7CgkgICAgfQoKCSAgICBzb2NrZXQucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgc29ja2V0RXJyb3IpOwoJICAgIGNiKGNsaWVudCk7CgkgIH0KCX0KCgltb2R1bGUuZXhwb3J0cyA9IFdlYlNvY2tldFNlcnZlcjsKCgkvKioKCSAqIEhhbmRsZSBwcmVtYXR1cmUgc29ja2V0IGVycm9ycy4KCSAqCgkgKiBAcHJpdmF0ZQoJICovCglmdW5jdGlvbiBzb2NrZXRFcnJvciAoKSB7CgkgIHRoaXMuZGVzdHJveSgpOwoJfQoKCS8qKgoJICogQWNjZXB0IFdlYlNvY2tldCBleHRlbnNpb25zLgoJICoKCSAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIFRoZSBgV2ViU29ja2V0U2VydmVyYCBjb25maWd1cmF0aW9uIG9wdGlvbnMKCSAqIEBwYXJhbSB7T2JqZWN0fSBvZmZlciBUaGUgcGFyc2VkIHZhbHVlIG9mIHRoZSBgc2VjLXdlYnNvY2tldC1leHRlbnNpb25zYCBoZWFkZXIKCSAqIEByZXR1cm4ge09iamVjdH0gQWNjZXB0ZWQgZXh0ZW5zaW9ucwoJICogQHByaXZhdGUKCSAqLwoJZnVuY3Rpb24gYWNjZXB0RXh0ZW5zaW9ucyAob3B0aW9ucywgb2ZmZXIpIHsKCSAgY29uc3QgcG1kID0gb3B0aW9ucy5wZXJNZXNzYWdlRGVmbGF0ZTsKCSAgY29uc3QgZXh0ZW5zaW9ucyA9IHt9OwoKCSAgaWYgKHBtZCAmJiBvZmZlcltQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXSkgewoJICAgIGNvbnN0IHBlck1lc3NhZ2VEZWZsYXRlID0gbmV3IFBlck1lc3NhZ2VEZWZsYXRlKAoJICAgICAgcG1kICE9PSB0cnVlID8gcG1kIDoge30sCgkgICAgICB0cnVlLAoJICAgICAgb3B0aW9ucy5tYXhQYXlsb2FkCgkgICAgKTsKCgkgICAgcGVyTWVzc2FnZURlZmxhdGUuYWNjZXB0KG9mZmVyW1Blck1lc3NhZ2VEZWZsYXRlLmV4dGVuc2lvbk5hbWVdKTsKCSAgICBleHRlbnNpb25zW1Blck1lc3NhZ2VEZWZsYXRlLmV4dGVuc2lvbk5hbWVdID0gcGVyTWVzc2FnZURlZmxhdGU7CgkgIH0KCgkgIHJldHVybiBleHRlbnNpb25zOwoJfQoKCS8qKgoJICogQ2xvc2UgdGhlIGNvbm5lY3Rpb24gd2hlbiBwcmVjb25kaXRpb25zIGFyZSBub3QgZnVsZmlsbGVkLgoJICoKCSAqIEBwYXJhbSB7bmV0LlNvY2tldH0gc29ja2V0IFRoZSBzb2NrZXQgb2YgdGhlIHVwZ3JhZGUgcmVxdWVzdAoJICogQHBhcmFtIHtOdW1iZXJ9IGNvZGUgVGhlIEhUVFAgcmVzcG9uc2Ugc3RhdHVzIGNvZGUKCSAqIEBwYXJhbSB7U3RyaW5nfSBbbWVzc2FnZV0gVGhlIEhUVFAgcmVzcG9uc2UgYm9keQoJICogQHByaXZhdGUKCSAqLwoJZnVuY3Rpb24gYWJvcnRDb25uZWN0aW9uIChzb2NrZXQsIGNvZGUsIG1lc3NhZ2UpIHsKCSAgaWYgKHNvY2tldC53cml0YWJsZSkgewoJICAgIG1lc3NhZ2UgPSBtZXNzYWdlIHx8IGh0dHAuU1RBVFVTX0NPREVTW2NvZGVdOwoJICAgIHNvY2tldC53cml0ZSgKCSAgICAgIGBIVFRQLzEuMSAke2NvZGV9ICR7aHR0cC5TVEFUVVNfQ09ERVNbY29kZV19XHJcbmAgKwoJICAgICAgJ0Nvbm5lY3Rpb246IGNsb3NlXHJcbicgKwoJICAgICAgJ0NvbnRlbnQtdHlwZTogdGV4dC9odG1sXHJcbicgKwoJICAgICAgYENvbnRlbnQtTGVuZ3RoOiAke0J1ZmZlci5ieXRlTGVuZ3RoKG1lc3NhZ2UpfVxyXG5gICsKCSAgICAgICdcclxuJyArCgkgICAgICBtZXNzYWdlCgkgICAgKTsKCSAgfQoKCSAgc29ja2V0LnJlbW92ZUxpc3RlbmVyKCdlcnJvcicsIHNvY2tldEVycm9yKTsKCSAgc29ja2V0LmRlc3Ryb3koKTsKCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5CdWZmZXIpKQoKLyoqKi8gfQovKioqKioqLyBdKQp9KTsKOw==",
      "sourceCodeClassname": "VertxProtoStubNode",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-63d99d6b-5450-81d4-ac0d-2455628f08d31",
    "version": 1.0999999999999999,
    "description": "Description of VertxProtoStubNode",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "VertxProtoStubNode",
    "configuration": {
      "url": "wss://msg-node.localhost:9090/ws"
    },
    "messageSchemas": "",
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": {},
    "dataObjects": [],
    "interworking": false
  },
  "P2PHandlerProtoStub": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBTRFAgaGVscGVycy4KdmFyIFNEUFV0aWxzID0ge307CgovLyBHZW5lcmF0ZSBhbiBhbHBoYW51bWVyaWMgaWRlbnRpZmllciBmb3IgY25hbWUgb3IgbWlkcy4KLy8gVE9ETzogdXNlIFVVSURzIGluc3RlYWQ/IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2plZC85ODI4ODMKU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCAxMCk7Cn07CgovLyBUaGUgUlRDUCBDTkFNRSB1c2VkIGJ5IGFsbCBwZWVyY29ubmVjdGlvbnMgZnJvbSB0aGUgc2FtZSBKUy4KU0RQVXRpbHMubG9jYWxDTmFtZSA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwoKLy8gU3BsaXRzIFNEUCBpbnRvIGxpbmVzLCBkZWFsaW5nIHdpdGggYm90aCBDUkxGIGFuZCBMRi4KU0RQVXRpbHMuc3BsaXRMaW5lcyA9IGZ1bmN0aW9uKGJsb2IpIHsKICByZXR1cm4gYmxvYi50cmltKCkuc3BsaXQoJ1xuJykubWFwKGZ1bmN0aW9uKGxpbmUpIHsKICAgIHJldHVybiBsaW5lLnRyaW0oKTsKICB9KTsKfTsKLy8gU3BsaXRzIFNEUCBpbnRvIHNlc3Npb25wYXJ0IGFuZCBtZWRpYXNlY3Rpb25zLiBFbnN1cmVzIENSTEYuClNEUFV0aWxzLnNwbGl0U2VjdGlvbnMgPSBmdW5jdGlvbihibG9iKSB7CiAgdmFyIHBhcnRzID0gYmxvYi5zcGxpdCgnXG5tPScpOwogIHJldHVybiBwYXJ0cy5tYXAoZnVuY3Rpb24ocGFydCwgaW5kZXgpIHsKICAgIHJldHVybiAoaW5kZXggPiAwID8gJ209JyArIHBhcnQgOiBwYXJ0KS50cmltKCkgKyAnXHJcbic7CiAgfSk7Cn07CgovLyBSZXR1cm5zIGxpbmVzIHRoYXQgc3RhcnQgd2l0aCBhIGNlcnRhaW4gcHJlZml4LgpTRFBVdGlscy5tYXRjaFByZWZpeCA9IGZ1bmN0aW9uKGJsb2IsIHByZWZpeCkgewogIHJldHVybiBTRFBVdGlscy5zcGxpdExpbmVzKGJsb2IpLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gbGluZS5pbmRleE9mKHByZWZpeCkgPT09IDA7CiAgfSk7Cn07CgovLyBQYXJzZXMgYW4gSUNFIGNhbmRpZGF0ZSBsaW5lLiBTYW1wbGUgaW5wdXQ6Ci8vIGNhbmRpZGF0ZTo3MDI3ODYzNTAgMiB1ZHAgNDE4MTk5MDIgOC44LjguOCA2MDc2OSB0eXAgcmVsYXkgcmFkZHIgOC44LjguOAovLyBycG9ydCA1NTk5NiIKU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzOwogIC8vIFBhcnNlIGJvdGggdmFyaWFudHMuCiAgaWYgKGxpbmUuaW5kZXhPZignYT1jYW5kaWRhdGU6JykgPT09IDApIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTIpLnNwbGl0KCcgJyk7CiAgfSBlbHNlIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTApLnNwbGl0KCcgJyk7CiAgfQoKICB2YXIgY2FuZGlkYXRlID0gewogICAgZm91bmRhdGlvbjogcGFydHNbMF0sCiAgICBjb21wb25lbnQ6IHBhcnRzWzFdLAogICAgcHJvdG9jb2w6IHBhcnRzWzJdLnRvTG93ZXJDYXNlKCksCiAgICBwcmlvcml0eTogcGFyc2VJbnQocGFydHNbM10sIDEwKSwKICAgIGlwOiBwYXJ0c1s0XSwKICAgIHBvcnQ6IHBhcnNlSW50KHBhcnRzWzVdLCAxMCksCiAgICAvLyBza2lwIHBhcnRzWzZdID09ICd0eXAnCiAgICB0eXBlOiBwYXJ0c1s3XQogIH07CgogIGZvciAodmFyIGkgPSA4OyBpIDwgcGFydHMubGVuZ3RoOyBpICs9IDIpIHsKICAgIHN3aXRjaCAocGFydHNbaV0pIHsKICAgICAgY2FzZSAncmFkZHInOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAncnBvcnQnOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCA9IHBhcnNlSW50KHBhcnRzW2kgKyAxXSwgMTApOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICd0Y3B0eXBlJzoKICAgICAgICBjYW5kaWRhdGUudGNwVHlwZSA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDogLy8gVW5rbm93biBleHRlbnNpb25zIGFyZSBzaWxlbnRseSBpZ25vcmVkLgogICAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gY2FuZGlkYXRlOwp9OwoKLy8gVHJhbnNsYXRlcyBhIGNhbmRpZGF0ZSBvYmplY3QgaW50byBTRFAgY2FuZGlkYXRlIGF0dHJpYnV0ZS4KU0RQVXRpbHMud3JpdGVDYW5kaWRhdGUgPSBmdW5jdGlvbihjYW5kaWRhdGUpIHsKICB2YXIgc2RwID0gW107CiAgc2RwLnB1c2goY2FuZGlkYXRlLmZvdW5kYXRpb24pOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5jb21wb25lbnQpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5wcm90b2NvbC50b1VwcGVyQ2FzZSgpKTsKICBzZHAucHVzaChjYW5kaWRhdGUucHJpb3JpdHkpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5pcCk7CiAgc2RwLnB1c2goY2FuZGlkYXRlLnBvcnQpOwoKICB2YXIgdHlwZSA9IGNhbmRpZGF0ZS50eXBlOwogIHNkcC5wdXNoKCd0eXAnKTsKICBzZHAucHVzaCh0eXBlKTsKICBpZiAodHlwZSAhPT0gJ2hvc3QnICYmIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyAmJgogICAgICBjYW5kaWRhdGUucmVsYXRlZFBvcnQpIHsKICAgIHNkcC5wdXNoKCdyYWRkcicpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnJlbGF0ZWRBZGRyZXNzKTsgLy8gd2FzOiByZWxBZGRyCiAgICBzZHAucHVzaCgncnBvcnQnKTsKICAgIHNkcC5wdXNoKGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCk7IC8vIHdhczogcmVsUG9ydAogIH0KICBpZiAoY2FuZGlkYXRlLnRjcFR5cGUgJiYgY2FuZGlkYXRlLnByb3RvY29sLnRvTG93ZXJDYXNlKCkgPT09ICd0Y3AnKSB7CiAgICBzZHAucHVzaCgndGNwdHlwZScpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnRjcFR5cGUpOwogIH0KICByZXR1cm4gJ2NhbmRpZGF0ZTonICsgc2RwLmpvaW4oJyAnKTsKfTsKCi8vIFBhcnNlcyBhbiBydHBtYXAgbGluZSwgcmV0dXJucyBSVENSdHBDb2RkZWNQYXJhbWV0ZXJzLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9cnRwbWFwOjExMSBvcHVzLzQ4MDAwLzIKU0RQVXRpbHMucGFyc2VSdHBNYXAgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIoOSkuc3BsaXQoJyAnKTsKICB2YXIgcGFyc2VkID0gewogICAgcGF5bG9hZFR5cGU6IHBhcnNlSW50KHBhcnRzLnNoaWZ0KCksIDEwKSAvLyB3YXM6IGlkCiAgfTsKCiAgcGFydHMgPSBwYXJ0c1swXS5zcGxpdCgnLycpOwoKICBwYXJzZWQubmFtZSA9IHBhcnRzWzBdOwogIHBhcnNlZC5jbG9ja1JhdGUgPSBwYXJzZUludChwYXJ0c1sxXSwgMTApOyAvLyB3YXM6IGNsb2NrcmF0ZQogIC8vIHdhczogY2hhbm5lbHMKICBwYXJzZWQubnVtQ2hhbm5lbHMgPSBwYXJ0cy5sZW5ndGggPT09IDMgPyBwYXJzZUludChwYXJ0c1syXSwgMTApIDogMTsKICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGUgYW4gYT1ydHBtYXAgbGluZSBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvcgovLyBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRwTWFwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgcmV0dXJuICdhPXJ0cG1hcDonICsgcHQgKyAnICcgKyBjb2RlYy5uYW1lICsgJy8nICsgY29kZWMuY2xvY2tSYXRlICsKICAgICAgKGNvZGVjLm51bUNoYW5uZWxzICE9PSAxID8gJy8nICsgY29kZWMubnVtQ2hhbm5lbHMgOiAnJykgKyAnXHJcbic7Cn07CgovLyBQYXJzZXMgYW4gYT1leHRtYXAgbGluZSAoaGVhZGVyZXh0ZW5zaW9uIGZyb20gUkZDIDUyODUpLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9ZXh0bWFwOjIgdXJuOmlldGY6cGFyYW1zOnJ0cC1oZHJleHQ6dG9mZnNldApTRFBVdGlscy5wYXJzZUV4dG1hcCA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cig5KS5zcGxpdCgnICcpOwogIHJldHVybiB7CiAgICBpZDogcGFyc2VJbnQocGFydHNbMF0sIDEwKSwKICAgIHVyaTogcGFydHNbMV0KICB9Owp9OwoKLy8gR2VuZXJhdGVzIGE9ZXh0bWFwIGxpbmUgZnJvbSBSVENSdHBIZWFkZXJFeHRlbnNpb25QYXJhbWV0ZXJzIG9yCi8vIFJUQ1J0cEhlYWRlckV4dGVuc2lvbi4KU0RQVXRpbHMud3JpdGVFeHRtYXAgPSBmdW5jdGlvbihoZWFkZXJFeHRlbnNpb24pIHsKICByZXR1cm4gJ2E9ZXh0bWFwOicgKyAoaGVhZGVyRXh0ZW5zaW9uLmlkIHx8IGhlYWRlckV4dGVuc2lvbi5wcmVmZXJyZWRJZCkgKwogICAgICAgJyAnICsgaGVhZGVyRXh0ZW5zaW9uLnVyaSArICdcclxuJzsKfTsKCi8vIFBhcnNlcyBhbiBmdG1wIGxpbmUsIHJldHVybnMgZGljdGlvbmFyeS4gU2FtcGxlIGlucHV0OgovLyBhPWZtdHA6OTYgdmJyPW9uO2NuZz1vbgovLyBBbHNvIGRlYWxzIHdpdGggdmJyPW9uOyBjbmc9b24KU0RQVXRpbHMucGFyc2VGbXRwID0gZnVuY3Rpb24obGluZSkgewogIHZhciBwYXJzZWQgPSB7fTsKICB2YXIga3Y7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIobGluZS5pbmRleE9mKCcgJykgKyAxKS5zcGxpdCgnOycpOwogIGZvciAodmFyIGogPSAwOyBqIDwgcGFydHMubGVuZ3RoOyBqKyspIHsKICAgIGt2ID0gcGFydHNbal0udHJpbSgpLnNwbGl0KCc9Jyk7CiAgICBwYXJzZWRba3ZbMF0udHJpbSgpXSA9IGt2WzFdOwogIH0KICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGVzIGFuIGE9ZnRtcCBsaW5lIGZyb20gUlRDUnRwQ29kZWNDYXBhYmlsaXR5IG9yIFJUQ1J0cENvZGVjUGFyYW1ldGVycy4KU0RQVXRpbHMud3JpdGVGbXRwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZSA9ICcnOwogIHZhciBwdCA9IGNvZGVjLnBheWxvYWRUeXBlOwogIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICBwdCA9IGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlOwogIH0KICBpZiAoY29kZWMucGFyYW1ldGVycyAmJiBPYmplY3Qua2V5cyhjb2RlYy5wYXJhbWV0ZXJzKS5sZW5ndGgpIHsKICAgIHZhciBwYXJhbXMgPSBbXTsKICAgIE9iamVjdC5rZXlzKGNvZGVjLnBhcmFtZXRlcnMpLmZvckVhY2goZnVuY3Rpb24ocGFyYW0pIHsKICAgICAgcGFyYW1zLnB1c2gocGFyYW0gKyAnPScgKyBjb2RlYy5wYXJhbWV0ZXJzW3BhcmFtXSk7CiAgICB9KTsKICAgIGxpbmUgKz0gJ2E9Zm10cDonICsgcHQgKyAnICcgKyBwYXJhbXMuam9pbignOycpICsgJ1xyXG4nOwogIH0KICByZXR1cm4gbGluZTsKfTsKCi8vIFBhcnNlcyBhbiBydGNwLWZiIGxpbmUsIHJldHVybnMgUlRDUFJ0Y3BGZWVkYmFjayBvYmplY3QuIFNhbXBsZSBpbnB1dDoKLy8gYT1ydGNwLWZiOjk4IG5hY2sgcnBzaQpTRFBVdGlscy5wYXJzZVJ0Y3BGYiA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cihsaW5lLmluZGV4T2YoJyAnKSArIDEpLnNwbGl0KCcgJyk7CiAgcmV0dXJuIHsKICAgIHR5cGU6IHBhcnRzLnNoaWZ0KCksCiAgICBwYXJhbWV0ZXI6IHBhcnRzLmpvaW4oJyAnKQogIH07Cn07Ci8vIEdlbmVyYXRlIGE9cnRjcC1mYiBsaW5lcyBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvciBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRjcEZiID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZXMgPSAnJzsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgaWYgKGNvZGVjLnJ0Y3BGZWVkYmFjayAmJiBjb2RlYy5ydGNwRmVlZGJhY2subGVuZ3RoKSB7CiAgICAvLyBGSVhNRTogc3BlY2lhbCBoYW5kbGluZyBmb3IgdHJyLWludD8KICAgIGNvZGVjLnJ0Y3BGZWVkYmFjay5mb3JFYWNoKGZ1bmN0aW9uKGZiKSB7CiAgICAgIGxpbmVzICs9ICdhPXJ0Y3AtZmI6JyArIHB0ICsgJyAnICsgZmIudHlwZSArCiAgICAgIChmYi5wYXJhbWV0ZXIgJiYgZmIucGFyYW1ldGVyLmxlbmd0aCA/ICcgJyArIGZiLnBhcmFtZXRlciA6ICcnKSArCiAgICAgICAgICAnXHJcbic7CiAgICB9KTsKICB9CiAgcmV0dXJuIGxpbmVzOwp9OwoKLy8gUGFyc2VzIGFuIFJGQyA1NTc2IHNzcmMgbWVkaWEgYXR0cmlidXRlLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9c3NyYzozNzM1OTI4NTU5IGNuYW1lOnNvbWV0aGluZwpTRFBVdGlscy5wYXJzZVNzcmNNZWRpYSA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgc3AgPSBsaW5lLmluZGV4T2YoJyAnKTsKICB2YXIgcGFydHMgPSB7CiAgICBzc3JjOiBwYXJzZUludChsaW5lLnN1YnN0cig3LCBzcCAtIDcpLCAxMCkKICB9OwogIHZhciBjb2xvbiA9IGxpbmUuaW5kZXhPZignOicsIHNwKTsKICBpZiAoY29sb24gPiAtMSkgewogICAgcGFydHMuYXR0cmlidXRlID0gbGluZS5zdWJzdHIoc3AgKyAxLCBjb2xvbiAtIHNwIC0gMSk7CiAgICBwYXJ0cy52YWx1ZSA9IGxpbmUuc3Vic3RyKGNvbG9uICsgMSk7CiAgfSBlbHNlIHsKICAgIHBhcnRzLmF0dHJpYnV0ZSA9IGxpbmUuc3Vic3RyKHNwICsgMSk7CiAgfQogIHJldHVybiBwYXJ0czsKfTsKCi8vIEV4dHJhY3RzIERUTFMgcGFyYW1ldGVycyBmcm9tIFNEUCBtZWRpYSBzZWN0aW9uIG9yIHNlc3Npb25wYXJ0LgovLyBGSVhNRTogZm9yIGNvbnNpc3RlbmN5IHdpdGggb3RoZXIgZnVuY3Rpb25zIHRoaXMgc2hvdWxkIG9ubHkKLy8gICBnZXQgdGhlIGZpbmdlcnByaW50IGxpbmUgYXMgaW5wdXQuIFNlZSBhbHNvIGdldEljZVBhcmFtZXRlcnMuClNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBmcExpbmUgPSBsaW5lcy5maWx0ZXIoZnVuY3Rpb24obGluZSkgewogICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1maW5nZXJwcmludDonKSA9PT0gMDsKICB9KVswXS5zdWJzdHIoMTQpOwogIC8vIE5vdGU6IGE9c2V0dXAgbGluZSBpcyBpZ25vcmVkIHNpbmNlIHdlIHVzZSB0aGUgJ2F1dG8nIHJvbGUuCiAgdmFyIGR0bHNQYXJhbWV0ZXJzID0gewogICAgcm9sZTogJ2F1dG8nLAogICAgZmluZ2VycHJpbnRzOiBbewogICAgICBhbGdvcml0aG06IGZwTGluZS5zcGxpdCgnICcpWzBdLAogICAgICB2YWx1ZTogZnBMaW5lLnNwbGl0KCcgJylbMV0KICAgIH1dCiAgfTsKICByZXR1cm4gZHRsc1BhcmFtZXRlcnM7Cn07CgovLyBTZXJpYWxpemVzIERUTFMgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMgPSBmdW5jdGlvbihwYXJhbXMsIHNldHVwVHlwZSkgewogIHZhciBzZHAgPSAnYT1zZXR1cDonICsgc2V0dXBUeXBlICsgJ1xyXG4nOwogIHBhcmFtcy5maW5nZXJwcmludHMuZm9yRWFjaChmdW5jdGlvbihmcCkgewogICAgc2RwICs9ICdhPWZpbmdlcnByaW50OicgKyBmcC5hbGdvcml0aG0gKyAnICcgKyBmcC52YWx1ZSArICdcclxuJzsKICB9KTsKICByZXR1cm4gc2RwOwp9OwovLyBQYXJzZXMgSUNFIGluZm9ybWF0aW9uIGZyb20gU0RQIG1lZGlhIHNlY3Rpb24gb3Igc2Vzc2lvbnBhcnQuCi8vIEZJWE1FOiBmb3IgY29uc2lzdGVuY3kgd2l0aCBvdGhlciBmdW5jdGlvbnMgdGhpcyBzaG91bGQgb25seQovLyAgIGdldCB0aGUgaWNlLXVmcmFnIGFuZCBpY2UtcHdkIGxpbmVzIGFzIGlucHV0LgpTRFBVdGlscy5nZXRJY2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBpY2VQYXJhbWV0ZXJzID0gewogICAgdXNlcm5hbWVGcmFnbWVudDogbGluZXMuZmlsdGVyKGZ1bmN0aW9uKGxpbmUpIHsKICAgICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1pY2UtdWZyYWc6JykgPT09IDA7CiAgICB9KVswXS5zdWJzdHIoMTIpLAogICAgcGFzc3dvcmQ6IGxpbmVzLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICAgIHJldHVybiBsaW5lLmluZGV4T2YoJ2E9aWNlLXB3ZDonKSA9PT0gMDsKICAgIH0pWzBdLnN1YnN0cigxMCkKICB9OwogIHJldHVybiBpY2VQYXJhbWV0ZXJzOwp9OwoKLy8gU2VyaWFsaXplcyBJQ0UgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlSWNlUGFyYW1ldGVycyA9IGZ1bmN0aW9uKHBhcmFtcykgewogIHJldHVybiAnYT1pY2UtdWZyYWc6JyArIHBhcmFtcy51c2VybmFtZUZyYWdtZW50ICsgJ1xyXG4nICsKICAgICAgJ2E9aWNlLXB3ZDonICsgcGFyYW1zLnBhc3N3b3JkICsgJ1xyXG4nOwp9OwoKLy8gUGFyc2VzIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBhbmQgcmV0dXJucyBSVENSdHBQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHsKICB2YXIgZGVzY3JpcHRpb24gPSB7CiAgICBjb2RlY3M6IFtdLAogICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICBmZWNNZWNoYW5pc21zOiBbXSwKICAgIHJ0Y3A6IFtdCiAgfTsKICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7CiAgdmFyIG1saW5lID0gbGluZXNbMF0uc3BsaXQoJyAnKTsKICBmb3IgKHZhciBpID0gMzsgaSA8IG1saW5lLmxlbmd0aDsgaSsrKSB7IC8vIGZpbmQgYWxsIGNvZGVjcyBmcm9tIG1saW5lWzMuLl0KICAgIHZhciBwdCA9IG1saW5lW2ldOwogICAgdmFyIHJ0cG1hcGxpbmUgPSBTRFBVdGlscy5tYXRjaFByZWZpeCgKICAgICAgICBtZWRpYVNlY3Rpb24sICdhPXJ0cG1hcDonICsgcHQgKyAnICcpWzBdOwogICAgaWYgKHJ0cG1hcGxpbmUpIHsKICAgICAgdmFyIGNvZGVjID0gU0RQVXRpbHMucGFyc2VSdHBNYXAocnRwbWFwbGluZSk7CiAgICAgIHZhciBmbXRwcyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1mbXRwOicgKyBwdCArICcgJyk7CiAgICAgIC8vIE9ubHkgdGhlIGZpcnN0IGE9Zm10cDo8cHQ+IGlzIGNvbnNpZGVyZWQuCiAgICAgIGNvZGVjLnBhcmFtZXRlcnMgPSBmbXRwcy5sZW5ndGggPyBTRFBVdGlscy5wYXJzZUZtdHAoZm10cHNbMF0pIDoge307CiAgICAgIGNvZGVjLnJ0Y3BGZWVkYmFjayA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1ydGNwLWZiOicgKyBwdCArICcgJykKICAgICAgICAubWFwKFNEUFV0aWxzLnBhcnNlUnRjcEZiKTsKICAgICAgZGVzY3JpcHRpb24uY29kZWNzLnB1c2goY29kZWMpOwogICAgICAvLyBwYXJzZSBGRUMgbWVjaGFuaXNtcyBmcm9tIHJ0cG1hcCBsaW5lcy4KICAgICAgc3dpdGNoIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkpIHsKICAgICAgICBjYXNlICdSRUQnOgogICAgICAgIGNhc2UgJ1VMUEZFQyc6CiAgICAgICAgICBkZXNjcmlwdGlvbi5mZWNNZWNoYW5pc21zLnB1c2goY29kZWMubmFtZS50b1VwcGVyQ2FzZSgpKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IC8vIG9ubHkgUkVEIGFuZCBVTFBGRUMgYXJlIHJlY29nbml6ZWQgYXMgRkVDIG1lY2hhbmlzbXMuCiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0KICBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPWV4dG1hcDonKS5mb3JFYWNoKGZ1bmN0aW9uKGxpbmUpIHsKICAgIGRlc2NyaXB0aW9uLmhlYWRlckV4dGVuc2lvbnMucHVzaChTRFBVdGlscy5wYXJzZUV4dG1hcChsaW5lKSk7CiAgfSk7CiAgLy8gRklYTUU6IHBhcnNlIHJ0Y3AuCiAgcmV0dXJuIGRlc2NyaXB0aW9uOwp9OwoKLy8gR2VuZXJhdGVzIHBhcnRzIG9mIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBkZXNjcmliaW5nIHRoZSBjYXBhYmlsaXRpZXMgLwovLyBwYXJhbWV0ZXJzLgpTRFBVdGlscy53cml0ZVJ0cERlc2NyaXB0aW9uID0gZnVuY3Rpb24oa2luZCwgY2FwcykgewogIHZhciBzZHAgPSAnJzsKCiAgLy8gQnVpbGQgdGhlIG1saW5lLgogIHNkcCArPSAnbT0nICsga2luZCArICcgJzsKICBzZHAgKz0gY2Fwcy5jb2RlY3MubGVuZ3RoID4gMCA/ICc5JyA6ICcwJzsgLy8gcmVqZWN0IGlmIG5vIGNvZGVjcy4KICBzZHAgKz0gJyBVRFAvVExTL1JUUC9TQVZQRiAnOwogIHNkcCArPSBjYXBzLmNvZGVjcy5tYXAoZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICAgIH0KICAgIHJldHVybiBjb2RlYy5wYXlsb2FkVHlwZTsKICB9KS5qb2luKCcgJykgKyAnXHJcbic7CgogIHNkcCArPSAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nOwogIHNkcCArPSAnYT1ydGNwOjkgSU4gSVA0IDAuMC4wLjBcclxuJzsKCiAgLy8gQWRkIGE9cnRwbWFwIGxpbmVzIGZvciBlYWNoIGNvZGVjLiBBbHNvIGZtdHAgYW5kIHJ0Y3AtZmIuCiAgY2Fwcy5jb2RlY3MuZm9yRWFjaChmdW5jdGlvbihjb2RlYykgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRwTWFwKGNvZGVjKTsKICAgIHNkcCArPSBTRFBVdGlscy53cml0ZUZtdHAoY29kZWMpOwogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRjcEZiKGNvZGVjKTsKICB9KTsKICB2YXIgbWF4cHRpbWUgPSAwOwogIGNhcHMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5tYXhwdGltZSA+IG1heHB0aW1lKSB7CiAgICAgIG1heHB0aW1lID0gY29kZWMubWF4cHRpbWU7CiAgICB9CiAgfSk7CiAgaWYgKG1heHB0aW1lID4gMCkgewogICAgc2RwICs9ICdhPW1heHB0aW1lOicgKyBtYXhwdGltZSArICdcclxuJzsKICB9CiAgc2RwICs9ICdhPXJ0Y3AtbXV4XHJcbic7CgogIGNhcHMuaGVhZGVyRXh0ZW5zaW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGV4dGVuc2lvbikgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlRXh0bWFwKGV4dGVuc2lvbik7CiAgfSk7CiAgLy8gRklYTUU6IHdyaXRlIGZlY01lY2hhbmlzbXMuCiAgcmV0dXJuIHNkcDsKfTsKCi8vIFBhcnNlcyB0aGUgU0RQIG1lZGlhIHNlY3Rpb24gYW5kIHJldHVybnMgYW4gYXJyYXkgb2YKLy8gUlRDUnRwRW5jb2RpbmdQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cEVuY29kaW5nUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikgewogIHZhciBlbmNvZGluZ1BhcmFtZXRlcnMgPSBbXTsKICB2YXIgZGVzY3JpcHRpb24gPSBTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMobWVkaWFTZWN0aW9uKTsKICB2YXIgaGFzUmVkID0gZGVzY3JpcHRpb24uZmVjTWVjaGFuaXNtcy5pbmRleE9mKCdSRUQnKSAhPT0gLTE7CiAgdmFyIGhhc1VscGZlYyA9IGRlc2NyaXB0aW9uLmZlY01lY2hhbmlzbXMuaW5kZXhPZignVUxQRkVDJykgIT09IC0xOwoKICAvLyBmaWx0ZXIgYT1zc3JjOi4uLiBjbmFtZTosIGlnbm9yZSBQbGFuQi1tc2lkCiAgdmFyIHNzcmNzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjOicpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgfSkKICAuZmlsdGVyKGZ1bmN0aW9uKHBhcnRzKSB7CiAgICByZXR1cm4gcGFydHMuYXR0cmlidXRlID09PSAnY25hbWUnOwogIH0pOwogIHZhciBwcmltYXJ5U3NyYyA9IHNzcmNzLmxlbmd0aCA+IDAgJiYgc3NyY3NbMF0uc3NyYzsKICB2YXIgc2Vjb25kYXJ5U3NyYzsKCiAgdmFyIGZsb3dzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjLWdyb3VwOkZJRCcpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICB2YXIgcGFydHMgPSBsaW5lLnNwbGl0KCcgJyk7CiAgICBwYXJ0cy5zaGlmdCgpOwogICAgcmV0dXJuIHBhcnRzLm1hcChmdW5jdGlvbihwYXJ0KSB7CiAgICAgIHJldHVybiBwYXJzZUludChwYXJ0LCAxMCk7CiAgICB9KTsKICB9KTsKICBpZiAoZmxvd3MubGVuZ3RoID4gMCAmJiBmbG93c1swXS5sZW5ndGggPiAxICYmIGZsb3dzWzBdWzBdID09PSBwcmltYXJ5U3NyYykgewogICAgc2Vjb25kYXJ5U3NyYyA9IGZsb3dzWzBdWzFdOwogIH0KCiAgZGVzY3JpcHRpb24uY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkgPT09ICdSVFgnICYmIGNvZGVjLnBhcmFtZXRlcnMuYXB0KSB7CiAgICAgIHZhciBlbmNQYXJhbSA9IHsKICAgICAgICBzc3JjOiBwcmltYXJ5U3NyYywKICAgICAgICBjb2RlY1BheWxvYWRUeXBlOiBwYXJzZUludChjb2RlYy5wYXJhbWV0ZXJzLmFwdCwgMTApLAogICAgICAgIHJ0eDogewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYwogICAgICAgIH0KICAgICAgfTsKICAgICAgZW5jb2RpbmdQYXJhbWV0ZXJzLnB1c2goZW5jUGFyYW0pOwogICAgICBpZiAoaGFzUmVkKSB7CiAgICAgICAgZW5jUGFyYW0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVuY1BhcmFtKSk7CiAgICAgICAgZW5jUGFyYW0uZmVjID0gewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYywKICAgICAgICAgIG1lY2hhbmlzbTogaGFzVWxwZmVjID8gJ3JlZCt1bHBmZWMnIDogJ3JlZCcKICAgICAgICB9OwogICAgICAgIGVuY29kaW5nUGFyYW1ldGVycy5wdXNoKGVuY1BhcmFtKTsKICAgICAgfQogICAgfQogIH0pOwogIGlmIChlbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoID09PSAwICYmIHByaW1hcnlTc3JjKSB7CiAgICBlbmNvZGluZ1BhcmFtZXRlcnMucHVzaCh7CiAgICAgIHNzcmM6IHByaW1hcnlTc3JjCiAgICB9KTsKICB9CgogIC8vIHdlIHN1cHBvcnQgYm90aCBiPUFTIGFuZCBiPVRJQVMgYnV0IGludGVycHJldCBBUyBhcyBUSUFTLgogIHZhciBiYW5kd2lkdGggPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdiPScpOwogIGlmIChiYW5kd2lkdGgubGVuZ3RoKSB7CiAgICBpZiAoYmFuZHdpZHRoWzBdLmluZGV4T2YoJ2I9VElBUzonKSA9PT0gMCkgewogICAgICBiYW5kd2lkdGggPSBwYXJzZUludChiYW5kd2lkdGhbMF0uc3Vic3RyKDcpLCAxMCk7CiAgICB9IGVsc2UgaWYgKGJhbmR3aWR0aFswXS5pbmRleE9mKCdiPUFTOicpID09PSAwKSB7CiAgICAgIGJhbmR3aWR0aCA9IHBhcnNlSW50KGJhbmR3aWR0aFswXS5zdWJzdHIoNSksIDEwKTsKICAgIH0KICAgIGVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtcykgewogICAgICBwYXJhbXMubWF4Qml0cmF0ZSA9IGJhbmR3aWR0aDsKICAgIH0pOwogIH0KICByZXR1cm4gZW5jb2RpbmdQYXJhbWV0ZXJzOwp9OwoKU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUgPSBmdW5jdGlvbigpIHsKICAvLyBGSVhNRTogc2Vzcy1pZCBzaG91bGQgYmUgYW4gTlRQIHRpbWVzdGFtcC4KICByZXR1cm4gJ3Y9MFxyXG4nICsKICAgICAgJ289dGhpc2lzYWRhcHRlcm9ydGMgODE2OTYzOTkxNTY0Njk0MzEzNyAyIElOIElQNCAxMjcuMC4wLjFcclxuJyArCiAgICAgICdzPS1cclxuJyArCiAgICAgICd0PTAgMFxyXG4nOwp9OwoKU0RQVXRpbHMud3JpdGVNZWRpYVNlY3Rpb24gPSBmdW5jdGlvbih0cmFuc2NlaXZlciwgY2FwcywgdHlwZSwgc3RyZWFtKSB7CiAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlUnRwRGVzY3JpcHRpb24odHJhbnNjZWl2ZXIua2luZCwgY2Fwcyk7CgogIC8vIE1hcCBJQ0UgcGFyYW1ldGVycyAodWZyYWcsIHB3ZCkgdG8gU0RQLgogIHNkcCArPSBTRFBVdGlscy53cml0ZUljZVBhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmdldExvY2FsUGFyYW1ldGVycygpKTsKCiAgLy8gTWFwIERUTFMgcGFyYW1ldGVycyB0byBTRFAuCiAgc2RwICs9IFNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuZ2V0TG9jYWxQYXJhbWV0ZXJzKCksCiAgICAgIHR5cGUgPT09ICdvZmZlcicgPyAnYWN0cGFzcycgOiAnYWN0aXZlJyk7CgogIHNkcCArPSAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlciAmJiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcikgewogICAgc2RwICs9ICdhPXNlbmRyZWN2XHJcbic7CiAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHsKICAgIHNkcCArPSAnYT1zZW5kb25seVxyXG4nOwogIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgIHNkcCArPSAnYT1yZWN2b25seVxyXG4nOwogIH0gZWxzZSB7CiAgICBzZHAgKz0gJ2E9aW5hY3RpdmVcclxuJzsKICB9CgogIC8vIEZJWE1FOiBmb3IgUlRYIHRoZXJlIG1pZ2h0IGJlIG11bHRpcGxlIFNTUkNzLiBOb3QgaW1wbGVtZW50ZWQgaW4gRWRnZSB5ZXQuCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlcikgewogICAgdmFyIG1zaWQgPSAnbXNpZDonICsgc3RyZWFtLmlkICsgJyAnICsKICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIudHJhY2suaWQgKyAnXHJcbic7CiAgICBzZHAgKz0gJ2E9JyArIG1zaWQ7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgICAnICcgKyBtc2lkOwogICAgaWYgKHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICAgIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICcgJyArIG1zaWQ7CiAgICAgIHNkcCArPSAnYT1zc3JjLWdyb3VwOkZJRCAnICsKICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYyArICcgJyArCiAgICAgICAgICB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICdcclxuJzsKICAgIH0KICB9CiAgLy8gRklYTUU6IHRoaXMgc2hvdWxkIGJlIHdyaXR0ZW4gYnkgd3JpdGVSdHBEZXNjcmlwdGlvbi4KICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHguc3NyYyArCiAgICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICB9CiAgcmV0dXJuIHNkcDsKfTsKCi8vIEdldHMgdGhlIGRpcmVjdGlvbiBmcm9tIHRoZSBtZWRpYVNlY3Rpb24gb3IgdGhlIHNlc3Npb25wYXJ0LgpTRFBVdGlscy5nZXREaXJlY3Rpb24gPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KSB7CiAgLy8gTG9vayBmb3Igc2VuZHJlY3YsIHNlbmRvbmx5LCByZWN2b25seSwgaW5hY3RpdmUsIGRlZmF1bHQgdG8gc2VuZHJlY3YuCiAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHsKICAgIHN3aXRjaCAobGluZXNbaV0pIHsKICAgICAgY2FzZSAnYT1zZW5kcmVjdic6CiAgICAgIGNhc2UgJ2E9c2VuZG9ubHknOgogICAgICBjYXNlICdhPXJlY3Zvbmx5JzoKICAgICAgY2FzZSAnYT1pbmFjdGl2ZSc6CiAgICAgICAgcmV0dXJuIGxpbmVzW2ldLnN1YnN0cigyKTsKICAgICAgZGVmYXVsdDoKICAgICAgICAvLyBGSVhNRTogV2hhdCBzaG91bGQgaGFwcGVuIGhlcmU/CiAgICB9CiAgfQogIGlmIChzZXNzaW9ucGFydCkgewogICAgcmV0dXJuIFNEUFV0aWxzLmdldERpcmVjdGlvbihzZXNzaW9ucGFydCk7CiAgfQogIHJldHVybiAnc2VuZHJlY3YnOwp9OwoKLy8gRXhwb3NlIHB1YmxpYyBtZXRob2RzLgptb2R1bGUuZXhwb3J0cyA9IFNEUFV0aWxzOwoKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8vIHZlcnNpb246IDAuNS4xCi8vIGRhdGU6IFR1ZSBGZWIgMDcgMjAxNyAxNjowMDozOSBHTVQrMDAwMCAoV0VUKQovLyBsaWNlbmNlOiAKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgoKKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiU3luY2hlciIsIFtdLCBmYWN0b3J5KTsKCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCWV4cG9ydHNbIlN5bmNoZXIiXSA9IGZhY3RvcnkoKTsKCWVsc2UKCQlyb290WyIiXSA9IHJvb3RbIiJdIHx8IHt9LCByb290WyIiXVsiU3luY2hlciJdID0gZmFjdG9yeSgpOwp9KSh0aGlzLCBmdW5jdGlvbigpIHsKcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXAKLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCXZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307Ci8qKioqKiovCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLwovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQovKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJaTogbW9kdWxlSWQsCi8qKioqKiovIAkJCWw6IGZhbHNlLAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAovKioqKioqLyAJCW1vZHVsZS5sID0gdHJ1ZTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8KLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7Ci8qKioqKiovCi8qKioqKiovIAkvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0Ci8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHMKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikgewovKioqKioqLyAJCWlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKLyoqKioqKi8gCQkJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsKLyoqKioqKi8gCQkJCWNvbmZpZ3VyYWJsZTogZmFsc2UsCi8qKioqKiovIAkJCQllbnVtZXJhYmxlOiB0cnVlLAovKioqKioqLyAJCQkJZ2V0OiBnZXR0ZXIKLyoqKioqKi8gCQkJfSk7Ci8qKioqKiovIAkJfQovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHsKLyoqKioqKi8gCQl2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID8KLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTsKLyoqKioqKi8gCQlfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7Ci8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKLyoqKioqKi8KLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMTYyKTsKLyoqKioqKi8gfSkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gKFsKLyogMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0ge3ZlcnNpb246ICcyLjQuMCd9OwppZih0eXBlb2YgX19lID09ICdudW1iZXInKV9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy84NiNpc3N1ZWNvbW1lbnQtMTE1NzU5MDI4CnZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aAogID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsKaWYodHlwZW9mIF9fZyA9PSAnbnVtYmVyJylfX2cgPSBnbG9iYWw7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzdG9yZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ3drcycpCiAgLCB1aWQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykKICAsIFN5bWJvbCAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLlN5bWJvbAogICwgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJzsKCnZhciAkZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obmFtZSl7CiAgcmV0dXJuIHN0b3JlW25hbWVdIHx8IChzdG9yZVtuYW1lXSA9CiAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IHVpZCkoJ1N5bWJvbC4nICsgbmFtZSkpOwp9OwoKJGV4cG9ydHMuc3RvcmUgPSBzdG9yZTsKCi8qKiovIH0pLAovKiAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHkKbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGRQICAgICAgICAgICAgID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpewogIGFuT2JqZWN0KE8pOwogIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKICBhbk9iamVjdChBdHRyaWJ1dGVzKTsKICBpZihJRThfRE9NX0RFRklORSl0cnkgewogICAgcmV0dXJuIGRQKE8sIFAsIEF0dHJpYnV0ZXMpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICBpZignZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpdGhyb3cgVHlwZUVycm9yKCdBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEnKTsKICBpZigndmFsdWUnIGluIEF0dHJpYnV0ZXMpT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZighaXNPYmplY3QoaXQpKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKICAsIGNyZWF0ZURlc2MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpID8gZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICByZXR1cm4gZFAuZihvYmplY3QsIGtleSwgY3JlYXRlRGVzYygxLCB2YWx1ZSkpOwp9IDogZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICBvYmplY3Rba2V5XSA9IHZhbHVlOwogIHJldHVybiBvYmplY3Q7Cn07CgovKioqLyB9KSwKLyogNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nOwp9OwoKLyoqKi8gfSksCi8qIDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGNvcmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGN0eCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCiAgLCBoaWRlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCiAgLCBQUk9UT1RZUEUgPSAncHJvdG90eXBlJzsKCnZhciAkZXhwb3J0ID0gZnVuY3Rpb24odHlwZSwgbmFtZSwgc291cmNlKXsKICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRgogICAgLCBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HCiAgICAsIElTX1NUQVRJQyA9IHR5cGUgJiAkZXhwb3J0LlMKICAgICwgSVNfUFJPVE8gID0gdHlwZSAmICRleHBvcnQuUAogICAgLCBJU19CSU5EICAgPSB0eXBlICYgJGV4cG9ydC5CCiAgICAsIElTX1dSQVAgICA9IHR5cGUgJiAkZXhwb3J0LlcKICAgICwgZXhwb3J0cyAgID0gSVNfR0xPQkFMID8gY29yZSA6IGNvcmVbbmFtZV0gfHwgKGNvcmVbbmFtZV0gPSB7fSkKICAgICwgZXhwUHJvdG8gID0gZXhwb3J0c1tQUk9UT1RZUEVdCiAgICAsIHRhcmdldCAgICA9IElTX0dMT0JBTCA/IGdsb2JhbCA6IElTX1NUQVRJQyA/IGdsb2JhbFtuYW1lXSA6IChnbG9iYWxbbmFtZV0gfHwge30pW1BST1RPVFlQRV0KICAgICwga2V5LCBvd24sIG91dDsKICBpZihJU19HTE9CQUwpc291cmNlID0gbmFtZTsKICBmb3Ioa2V5IGluIHNvdXJjZSl7CiAgICAvLyBjb250YWlucyBpbiBuYXRpdmUKICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIHRhcmdldFtrZXldICE9PSB1bmRlZmluZWQ7CiAgICBpZihvd24gJiYga2V5IGluIGV4cG9ydHMpY29udGludWU7CiAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZAogICAgb3V0ID0gb3duID8gdGFyZ2V0W2tleV0gOiBzb3VyY2Vba2V5XTsKICAgIC8vIHByZXZlbnQgZ2xvYmFsIHBvbGx1dGlvbiBmb3IgbmFtZXNwYWNlcwogICAgZXhwb3J0c1trZXldID0gSVNfR0xPQkFMICYmIHR5cGVvZiB0YXJnZXRba2V5XSAhPSAnZnVuY3Rpb24nID8gc291cmNlW2tleV0KICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0CiAgICA6IElTX0JJTkQgJiYgb3duID8gY3R4KG91dCwgZ2xvYmFsKQogICAgLy8gd3JhcCBnbG9iYWwgY29uc3RydWN0b3JzIGZvciBwcmV2ZW50IGNoYW5nZSB0aGVtIGluIGxpYnJhcnkKICAgIDogSVNfV1JBUCAmJiB0YXJnZXRba2V5XSA9PSBvdXQgPyAoZnVuY3Rpb24oQyl7CiAgICAgIHZhciBGID0gZnVuY3Rpb24oYSwgYiwgYyl7CiAgICAgICAgaWYodGhpcyBpbnN0YW5jZW9mIEMpewogICAgICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpewogICAgICAgICAgICBjYXNlIDA6IHJldHVybiBuZXcgQzsKICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gbmV3IEMoYSk7CiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBDKGEsIGIpOwogICAgICAgICAgfSByZXR1cm4gbmV3IEMoYSwgYiwgYyk7CiAgICAgICAgfSByZXR1cm4gQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgICBGW1BST1RPVFlQRV0gPSBDW1BST1RPVFlQRV07CiAgICAgIHJldHVybiBGOwogICAgLy8gbWFrZSBzdGF0aWMgdmVyc2lvbnMgZm9yIHByb3RvdHlwZSBtZXRob2RzCiAgICB9KShvdXQpIDogSVNfUFJPVE8gJiYgdHlwZW9mIG91dCA9PSAnZnVuY3Rpb24nID8gY3R4KEZ1bmN0aW9uLmNhbGwsIG91dCkgOiBvdXQ7CiAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUubWV0aG9kcy4lTkFNRSUKICAgIGlmKElTX1BST1RPKXsKICAgICAgKGV4cG9ydHMudmlydHVhbCB8fCAoZXhwb3J0cy52aXJ0dWFsID0ge30pKVtrZXldID0gb3V0OwogICAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUucHJvdG90eXBlLiVOQU1FJQogICAgICBpZih0eXBlICYgJGV4cG9ydC5SICYmIGV4cFByb3RvICYmICFleHBQcm90b1trZXldKWhpZGUoZXhwUHJvdG8sIGtleSwgb3V0KTsKICAgIH0KICB9Cn07Ci8vIHR5cGUgYml0bWFwCiRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkCiRleHBvcnQuRyA9IDI7ICAgLy8gZ2xvYmFsCiRleHBvcnQuUyA9IDQ7ICAgLy8gc3RhdGljCiRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG8KJGV4cG9ydC5CID0gMTY7ICAvLyBiaW5kCiRleHBvcnQuVyA9IDMyOyAgLy8gd3JhcAokZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmUKJGV4cG9ydC5SID0gMTI4OyAvLyByZWFsIHByb3RvIG1ldGhvZCBmb3IgYGxpYnJhcnlgIAptb2R1bGUuZXhwb3J0cyA9ICRleHBvcnQ7CgovKioqLyB9KSwKLyogOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDEwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMzYpOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZWZpbmVQcm9wZXJ0eSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICAgICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogICAgfQogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICAgIHJldHVybiBDb25zdHJ1Y3RvcjsKICB9Owp9KCk7CgovKioqLyB9KSwKLyogMTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjKXsKICB0cnkgewogICAgcmV0dXJuICEhZXhlYygpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn07CgovKioqLyB9KSwKLyogMTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGhhc093blByb3BlcnR5ID0ge30uaGFzT3duUHJvcGVydHk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIGtleSl7CiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoaXQsIGtleSk7Cn07CgovKioqLyB9KSwKLyogMTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzCnZhciBJT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NikKICAsIGRlZmluZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpOwp9OwoKLyoqKi8gfSksCi8qIDE0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZwp2YXIgYUZ1bmN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIHRoYXQsIGxlbmd0aCl7CiAgYUZ1bmN0aW9uKGZuKTsKICBpZih0aGF0ID09PSB1bmRlZmluZWQpcmV0dXJuIGZuOwogIHN3aXRjaChsZW5ndGgpewogICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpOwogICAgfTsKICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTsKICAgIH07CiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7CiAgICB9OwogIH0KICByZXR1cm4gZnVuY3Rpb24oLyogLi4uYXJncyAqLyl7CiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDE1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0ge307CgovKioqLyB9KSwKLyogMTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiaXRtYXAsIHZhbHVlKXsKICByZXR1cm4gewogICAgZW51bWVyYWJsZSAgOiAhKGJpdG1hcCAmIDEpLAogICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLAogICAgd3JpdGFibGUgICAgOiAhKGJpdG1hcCAmIDQpLAogICAgdmFsdWUgICAgICAgOiB2YWx1ZQogIH07Cn07CgovKioqLyB9KSwKLyogMTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjE0IC8gMTUuMi4zLjE0IE9iamVjdC5rZXlzKE8pCnZhciAka2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpOwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pewogIHJldHVybiAka2V5cyhPLCBlbnVtQnVnS2V5cyk7Cn07CgovKioqLyB9KSwKLyogMTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpOwp9OwoKLyoqKi8gfSksCi8qIDE5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5kb2N1bWVudAogIC8vIGluIG9sZCBJRSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JwogICwgaXMgPSBpc09iamVjdChkb2N1bWVudCkgJiYgaXNPYmplY3QoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307Cn07CgovKioqLyB9KSwKLyogMjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRlZiA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaGFzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIFRBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3RvU3RyaW5nVGFnJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCB0YWcsIHN0YXQpewogIGlmKGl0ICYmICFoYXMoaXQgPSBzdGF0ID8gaXQgOiBpdC5wcm90b3R5cGUsIFRBRykpZGVmKGl0LCBUQUcsIHtjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiB0YWd9KTsKfTsKCi8qKiovIH0pLAovKiAyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSkKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2UKLy8gYW5kIHRoZSBzZWNvbmQgYXJndW1lbnQgLSBmbGFnIC0gcHJlZmVycmVkIHR5cGUgaXMgYSBzdHJpbmcKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgUyl7CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gaXQ7CiAgdmFyIGZuLCB2YWw7CiAgaWYoUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIGlmKHR5cGVvZiAoZm4gPSBpdC52YWx1ZU9mKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICBpZighUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIHRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlIik7Cn07CgovKioqLyB9KSwKLyogMjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGlkID0gMAogICwgcHggPSBNYXRoLnJhbmRvbSgpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7CiAgcmV0dXJuICdTeW1ib2woJy5jb25jYXQoa2V5ID09PSB1bmRlZmluZWQgPyAnJyA6IGtleSwgJylfJywgKCsraWQgKyBweCkudG9TdHJpbmcoMzYpKTsKfTsKCi8qKiovIH0pLAovKiAyNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyA3LjIuMSBSZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGFyZ3VtZW50KQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIiArIGl0KTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSB0cnVlOwoKLyoqKi8gfSksCi8qIDI2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzaGFyZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKSgna2V5cycpCiAgLCB1aWQgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzaGFyZWRba2V5XSB8fCAoc2hhcmVkW2tleV0gPSB1aWQoa2V5KSk7Cn07CgovKioqLyB9KSwKLyogMjcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gNy4xLjQgVG9JbnRlZ2VyCnZhciBjZWlsICA9IE1hdGguY2VpbAogICwgZmxvb3IgPSBNYXRoLmZsb29yOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXNOYU4oaXQgPSAraXQpID8gMCA6IChpdCA+IDAgPyBmbG9vciA6IGNlaWwpKGl0KTsKfTsKCi8qKiovIH0pLAovKiAyOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzCm1vZHVsZS5leHBvcnRzID0gKAogICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnCikuc3BsaXQoJywnKTsKCi8qKiovIH0pLAovKiAyOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDMpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoX193ZWJwYWNrX3JlcXVpcmVfXygxOSkoJ2RpdicpLCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiAzMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXycKICAsIHN0b3JlICA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzdG9yZVtrZXldIHx8IChzdG9yZVtrZXldID0ge30pOwp9OwoKLyoqKi8gfSksCi8qIDMxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNzkpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogMzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KQp2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gT2JqZWN0KGRlZmluZWQoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAzMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfc2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc1KTsKCnZhciBfc2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jcmVhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc0KTsKCnZhciBfY3JlYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZSk7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHN1cGVyQ2xhc3MgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoc3VwZXJDbGFzcykpKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9ICgwLCBfY3JlYXRlMi5kZWZhdWx0KShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZjIuZGVmYXVsdCA/ICgwLCBfc2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7Cn07CgovKioqLyB9KSwKLyogMzQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzZWxmLCBjYWxsKSB7CiAgaWYgKCFzZWxmKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIGNhbGwgJiYgKCh0eXBlb2YgY2FsbCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6ICgwLCBfdHlwZW9mMy5kZWZhdWx0KShjYWxsKSkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOwp9OwoKLyoqKi8gfSksCi8qIDM1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQp2YXIgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBkUHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBFbXB0eSAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KICAsIFBST1RPVFlQRSAgID0gJ3Byb3RvdHlwZSc7CgovLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlCnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24oKXsKICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1ZwogIHZhciBpZnJhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KSgnaWZyYW1lJykKICAgICwgaSAgICAgID0gZW51bUJ1Z0tleXMubGVuZ3RoCiAgICAsIGx0ICAgICA9ICc8JwogICAgLCBndCAgICAgPSAnPicKICAgICwgaWZyYW1lRG9jdW1lbnQ7CiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg0MikuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsCiAgLy8gY3JlYXRlRGljdCA9IGlmcmFtZS5jb250ZW50V2luZG93Lk9iamVjdDsKICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7CiAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKICBpZnJhbWVEb2N1bWVudC5vcGVuKCk7CiAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpOwogIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7CiAgY3JlYXRlRGljdCA9IGlmcmFtZURvY3VtZW50LkY7CiAgd2hpbGUoaS0tKWRlbGV0ZSBjcmVhdGVEaWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbaV1dOwogIHJldHVybiBjcmVhdGVEaWN0KCk7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpewogIHZhciByZXN1bHQ7CiAgaWYoTyAhPT0gbnVsbCl7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7CiAgICByZXN1bHQgPSBuZXcgRW1wdHk7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gbnVsbDsKICAgIC8vIGFkZCAiX19wcm90b19fIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsCiAgICByZXN1bHRbSUVfUFJPVE9dID0gTzsKICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpOwogIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkUHMocmVzdWx0LCBQcm9wZXJ0aWVzKTsKfTsKCgovKioqLyB9KSwKLyogMzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygzNyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAzNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKXsKICByZXR1cm4gJE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKTsKfTsKCi8qKiovIH0pLAovKiAzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgTElCUkFSWSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBoaWRlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIEl0ZXJhdG9ycyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsICRpdGVyQ3JlYXRlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MikKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MykKICAsIElURVJBVE9SICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgQlVHR1kgICAgICAgICAgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSkgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YAogICwgRkZfSVRFUkFUT1IgICAgPSAnQEBpdGVyYXRvcicKICAsIEtFWVMgICAgICAgICAgID0gJ2tleXMnCiAgLCBWQUxVRVMgICAgICAgICA9ICd2YWx1ZXMnOwoKdmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKXsKICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7CiAgdmFyIGdldE1ldGhvZCA9IGZ1bmN0aW9uKGtpbmQpewogICAgaWYoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pcmV0dXJuIHByb3RvW2tpbmRdOwogICAgc3dpdGNoKGtpbmQpewogICAgICBjYXNlIEtFWVM6IHJldHVybiBmdW5jdGlvbiBrZXlzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgfTsKICB2YXIgVEFHICAgICAgICA9IE5BTUUgKyAnIEl0ZXJhdG9yJwogICAgLCBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVMKICAgICwgVkFMVUVTX0JVRyA9IGZhbHNlCiAgICAsIHByb3RvICAgICAgPSBCYXNlLnByb3RvdHlwZQogICAgLCAkbmF0aXZlICAgID0gcHJvdG9bSVRFUkFUT1JdIHx8IHByb3RvW0ZGX0lURVJBVE9SXSB8fCBERUZBVUxUICYmIHByb3RvW0RFRkFVTFRdCiAgICAsICRkZWZhdWx0ICAgPSAkbmF0aXZlIHx8IGdldE1ldGhvZChERUZBVUxUKQogICAgLCAkZW50cmllcyAgID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZAogICAgLCAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZQogICAgLCBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlOwogIC8vIEZpeCBuYXRpdmUKICBpZigkYW55TmF0aXZlKXsKICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoJGFueU5hdGl2ZS5jYWxsKG5ldyBCYXNlKSk7CiAgICBpZihJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSl7CiAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnMKICAgICAgc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JQcm90b3R5cGUsIFRBRywgdHJ1ZSk7CiAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lcwogICAgICBpZighTElCUkFSWSAmJiAhaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikpaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwogICAgfQogIH0KICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGCiAgaWYoREVGX1ZBTFVFUyAmJiAkbmF0aXZlICYmICRuYXRpdmUubmFtZSAhPT0gVkFMVUVTKXsKICAgIFZBTFVFU19CVUcgPSB0cnVlOwogICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTsKICB9CiAgLy8gRGVmaW5lIGl0ZXJhdG9yCiAgaWYoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpewogICAgaGlkZShwcm90bywgSVRFUkFUT1IsICRkZWZhdWx0KTsKICB9CiAgLy8gUGx1ZyBmb3IgbGlicmFyeQogIEl0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0OwogIEl0ZXJhdG9yc1tUQUddICA9IHJldHVyblRoaXM7CiAgaWYoREVGQVVMVCl7CiAgICBtZXRob2RzID0gewogICAgICB2YWx1ZXM6ICBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSwKICAgICAga2V5czogICAgSVNfU0VUICAgICA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLAogICAgICBlbnRyaWVzOiAkZW50cmllcwogICAgfTsKICAgIGlmKEZPUkNFRClmb3Ioa2V5IGluIG1ldGhvZHMpewogICAgICBpZighKGtleSBpbiBwcm90bykpcmVkZWZpbmUocHJvdG8sIGtleSwgbWV0aG9kc1trZXldKTsKICAgIH0gZWxzZSAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7CiAgfQogIHJldHVybiBtZXRob2RzOwp9OwoKLyoqKi8gfSksCi8qIDM5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKLy8gMTkuMS4yLjQgLyAxNS4yLjMuNiBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhX193ZWJwYWNrX3JlcXVpcmVfXygzKSwgJ09iamVjdCcsIHtkZWZpbmVQcm9wZXJ0eTogX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mfSk7CgovKioqLyB9KSwKLyogNDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg1MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA0MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTsKCi8qKiovIH0pLAovKiA0MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZG9jdW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKLyoqKi8gfSksCi8qIDQzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi45IC8gMTUuMi4zLjIgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciBoYXMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCB0b09iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBPYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihPKXsKICBPID0gdG9PYmplY3QoTyk7CiAgaWYoaGFzKE8sIElFX1BST1RPKSlyZXR1cm4gT1tJRV9QUk9UT107CiAgaWYodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcil7CiAgICByZXR1cm4gTy5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7CiAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvIDogbnVsbDsKfTsKCi8qKiovIH0pLAovKiA0NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaGFzICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIHRvSU9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCBhcnJheUluZGV4T2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKShmYWxzZSkKICAsIElFX1BST1RPICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIG5hbWVzKXsKICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKICAgICwgaSAgICAgID0gMAogICAgLCByZXN1bHQgPSBbXQogICAgLCBrZXk7CiAgZm9yKGtleSBpbiBPKWlmKGtleSAhPSBJRV9QUk9UTyloYXMoTywga2V5KSAmJiByZXN1bHQucHVzaChrZXkpOwogIC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXMKICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKWlmKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSl7CiAgICB+YXJyYXlJbmRleE9mKHJlc3VsdCwga2V5KSB8fCByZXN1bHQucHVzaChrZXkpOwogIH0KICByZXR1cm4gcmVzdWx0Owp9OwoKLyoqKi8gfSksCi8qIDQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG1vc3QgT2JqZWN0IG1ldGhvZHMgYnkgRVM2IHNob3VsZCBhY2NlcHQgcHJpbWl0aXZlcwp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKICAsIGNvcmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBmYWlscyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBleGVjKXsKICB2YXIgZm4gID0gKGNvcmUuT2JqZWN0IHx8IHt9KVtLRVldIHx8IE9iamVjdFtLRVldCiAgICAsIGV4cCA9IHt9OwogIGV4cFtLRVldID0gZXhlYyhmbik7CiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbigpeyBmbigxKTsgfSksICdPYmplY3QnLCBleHApOwp9OwoKLyoqKi8gfSksCi8qIDQ2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCi8qKiovIH0pLAovKiA0NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMTUgVG9MZW5ndGgKdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpCiAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ID4gMCA/IG1pbih0b0ludGVnZXIoaXQpLCAweDFmZmZmZmZmZmZmZmZmKSA6IDA7IC8vIHBvdygyLCA1MykgLSAxID09IDkwMDcxOTkyNTQ3NDA5OTEKfTsKCi8qKiovIH0pLAovKiA0OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIExJQlJBUlkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKICAsIHdrc0V4dCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkKICAsIGRlZmluZVByb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewogIHZhciAkU3ltYm9sID0gY29yZS5TeW1ib2wgfHwgKGNvcmUuU3ltYm9sID0gTElCUkFSWSA/IHt9IDogZ2xvYmFsLlN5bWJvbCB8fCB7fSk7CiAgaWYobmFtZS5jaGFyQXQoMCkgIT0gJ18nICYmICEobmFtZSBpbiAkU3ltYm9sKSlkZWZpbmVQcm9wZXJ0eSgkU3ltYm9sLCBuYW1lLCB7dmFsdWU6IHdrc0V4dC5mKG5hbWUpfSk7Cn07CgovKioqLyB9KSwKLyogNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTsKCi8qKiovIH0pLAovKiA1MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgJGF0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNjYpKHRydWUpOwoKLy8gMjEuMS4zLjI3IFN0cmluZy5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQpfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KShTdHJpbmcsICdTdHJpbmcnLCBmdW5jdGlvbihpdGVyYXRlZCl7CiAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4Ci8vIDIxLjEuNS4yLjEgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKfSwgZnVuY3Rpb24oKXsKICB2YXIgTyAgICAgPSB0aGlzLl90CiAgICAsIGluZGV4ID0gdGhpcy5faQogICAgLCBwb2ludDsKICBpZihpbmRleCA+PSBPLmxlbmd0aClyZXR1cm4ge3ZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWV9OwogIHBvaW50ID0gJGF0KE8sIGluZGV4KTsKICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDsKICByZXR1cm4ge3ZhbHVlOiBwb2ludCwgZG9uZTogZmFsc2V9Owp9KTsKCi8qKiovIH0pLAovKiA1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDY5KTsKdmFyIGdsb2JhbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBoaWRlICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgSXRlcmF0b3JzICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCBUT19TVFJJTkdfVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKTsKCmZvcih2YXIgY29sbGVjdGlvbnMgPSBbJ05vZGVMaXN0JywgJ0RPTVRva2VuTGlzdCcsICdNZWRpYUxpc3QnLCAnU3R5bGVTaGVldExpc3QnLCAnQ1NTUnVsZUxpc3QnXSwgaSA9IDA7IGkgPCA1OyBpKyspewogIHZhciBOQU1FICAgICAgID0gY29sbGVjdGlvbnNbaV0KICAgICwgQ29sbGVjdGlvbiA9IGdsb2JhbFtOQU1FXQogICAgLCBwcm90byAgICAgID0gQ29sbGVjdGlvbiAmJiBDb2xsZWN0aW9uLnByb3RvdHlwZTsKICBpZihwcm90byAmJiAhcHJvdG9bVE9fU1RSSU5HX1RBR10paGlkZShwcm90bywgVE9fU1RSSU5HX1RBRywgTkFNRSk7CiAgSXRlcmF0b3JzW05BTUVdID0gSXRlcmF0b3JzLkFycmF5Owp9CgovKioqLyB9KSwKLyogNTIgKi8sCi8qIDUzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjb3JlICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsICRKU09OID0gY29yZS5KU09OIHx8IChjb3JlLkpTT04gPSB7c3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeX0pOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICByZXR1cm4gJEpTT04uc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmd1bWVudHMpOwp9OwoKLyoqKi8gfSksCi8qIDU0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgoKLyoqKi8gfSksCi8qIDU1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGdldHRpbmcgdGFnIGZyb20gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KQogICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKQogIC8vIEVTMyB3cm9uZyBoZXJlCiAgLCBBUkcgPSBjb2YoZnVuY3Rpb24oKXsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJzsKCi8vIGZhbGxiYWNrIGZvciBJRTExIFNjcmlwdCBBY2Nlc3MgRGVuaWVkIGVycm9yCnZhciB0cnlHZXQgPSBmdW5jdGlvbihpdCwga2V5KXsKICB0cnkgewogICAgcmV0dXJuIGl0W2tleV07CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgdmFyIE8sIFQsIEI7CiAgcmV0dXJuIGl0ID09PSB1bmRlZmluZWQgPyAnVW5kZWZpbmVkJyA6IGl0ID09PSBudWxsID8gJ051bGwnCiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2UKICAgIDogdHlwZW9mIChUID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUQUcpKSA9PSAnc3RyaW5nJyA/IFQKICAgIC8vIGJ1aWx0aW5UYWcgY2FzZQogICAgOiBBUkcgPyBjb2YoTykKICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2sKICAgIDogKEIgPSBjb2YoTykpID09ICdPYmplY3QnICYmIHR5cGVvZiBPLmNhbGxlZSA9PSAnZnVuY3Rpb24nID8gJ0FyZ3VtZW50cycgOiBCOwp9OwoKLyoqKi8gfSksCi8qIDU2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gY29mKGl0KSA9PSAnU3RyaW5nJyA/IGl0LnNwbGl0KCcnKSA6IE9iamVjdChpdCk7Cn07CgovKioqLyB9KSwKLyogNTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHBJRSAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIGdPUEQgICAgICAgICAgID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKCmV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBnT1BEIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApewogIE8gPSB0b0lPYmplY3QoTyk7CiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwogIGlmKElFOF9ET01fREVGSU5FKXRyeSB7CiAgICByZXR1cm4gZ09QRChPLCBQKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgaWYoaGFzKE8sIFApKXJldHVybiBjcmVhdGVEZXNjKCFwSUUuZi5jYWxsKE8sIFApLCBPW1BdKTsKfTsKCi8qKiovIH0pLAovKiA1OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKLyoqKi8gfSksCi8qIDU5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9pdGVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oNzcpOwoKdmFyIF9pdGVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pdGVyYXRvcik7Cgp2YXIgX3N5bWJvbCA9IF9fd2VicGFja19yZXF1aXJlX18oNzYpOwoKdmFyIF9zeW1ib2wyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3ltYm9sKTsKCnZhciBfdHlwZW9mID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIF9pdGVyYXRvcjIuZGVmYXVsdCA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YoX2l0ZXJhdG9yMi5kZWZhdWx0KSA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG9iaik7Cn0gOiBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IF9zeW1ib2wyLmRlZmF1bHQgJiYgb2JqICE9PSBfc3ltYm9sMi5kZWZhdWx0LnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iaiA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yob2JqKTsKfTsKCi8qKiovIH0pLAovKiA2MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH07CgovKioqLyB9KSwKLyogNjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsc2UgLT4gQXJyYXkjaW5kZXhPZgovLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlcwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvTGVuZ3RoICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCB0b0luZGV4ICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY4KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihJU19JTkNMVURFUyl7CiAgcmV0dXJuIGZ1bmN0aW9uKCR0aGlzLCBlbCwgZnJvbUluZGV4KXsKICAgIHZhciBPICAgICAgPSB0b0lPYmplY3QoJHRoaXMpCiAgICAgICwgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpCiAgICAgICwgaW5kZXggID0gdG9JbmRleChmcm9tSW5kZXgsIGxlbmd0aCkKICAgICAgLCB2YWx1ZTsKICAgIC8vIEFycmF5I2luY2x1ZGVzIHVzZXMgU2FtZVZhbHVlWmVybyBlcXVhbGl0eSBhbGdvcml0aG0KICAgIGlmKElTX0lOQ0xVREVTICYmIGVsICE9IGVsKXdoaWxlKGxlbmd0aCA+IGluZGV4KXsKICAgICAgdmFsdWUgPSBPW2luZGV4KytdOwogICAgICBpZih2YWx1ZSAhPSB2YWx1ZSlyZXR1cm4gdHJ1ZTsKICAgIC8vIEFycmF5I3RvSW5kZXggaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3QKICAgIH0gZWxzZSBmb3IoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKWlmKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pewogICAgICBpZihPW2luZGV4XSA9PT0gZWwpcmV0dXJuIElTX0lOQ0xVREVTIHx8IGluZGV4IHx8IDA7CiAgICB9IHJldHVybiAhSVNfSU5DTFVERVMgJiYgLTE7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgY3JlYXRlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KQogICwgZGVzY3JpcHRvciAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTsKCi8vIDI1LjEuMi4xLjEgJUl0ZXJhdG9yUHJvdG90eXBlJVtAQGl0ZXJhdG9yXSgpCl9fd2VicGFja19yZXF1aXJlX18oNikoSXRlcmF0b3JQcm90b3R5cGUsIF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJyksIGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9KTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpewogIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwge25leHQ6IGRlc2NyaXB0b3IoMSwgbmV4dCl9KTsKICBzZXRUb1N0cmluZ1RhZyhDb25zdHJ1Y3RvciwgTkFNRSArICcgSXRlcmF0b3InKTsKfTsKCi8qKiovIH0pLAovKiA2MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGRvbmUsIHZhbHVlKXsKICByZXR1cm4ge3ZhbHVlOiB2YWx1ZSwgZG9uZTogISFkb25lfTsKfTsKCi8qKiovIH0pLAovKiA2NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIGdldEtleXMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcyl7CiAgYW5PYmplY3QoTyk7CiAgdmFyIGtleXMgICA9IGdldEtleXMoUHJvcGVydGllcykKICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgKICAgICwgaSA9IDAKICAgICwgUDsKICB3aGlsZShsZW5ndGggPiBpKWRQLmYoTywgUCA9IGtleXNbaSsrXSwgUHJvcGVydGllc1tQXSk7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjcgLyAxNS4yLjMuNCBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKQp2YXIgJGtleXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBoaWRkZW5LZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKE8pewogIHJldHVybiAka2V5cyhPLCBoaWRkZW5LZXlzKTsKfTsKCi8qKiovIH0pLAovKiA2NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykKICAsIGRlZmluZWQgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwovLyB0cnVlICAtPiBTdHJpbmcjYXQKLy8gZmFsc2UgLT4gU3RyaW5nI2NvZGVQb2ludEF0Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oVE9fU1RSSU5HKXsKICByZXR1cm4gZnVuY3Rpb24odGhhdCwgcG9zKXsKICAgIHZhciBzID0gU3RyaW5nKGRlZmluZWQodGhhdCkpCiAgICAgICwgaSA9IHRvSW50ZWdlcihwb3MpCiAgICAgICwgbCA9IHMubGVuZ3RoCiAgICAgICwgYSwgYjsKICAgIGlmKGkgPCAwIHx8IGkgPj0gbClyZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7CiAgICBhID0gcy5jaGFyQ29kZUF0KGkpOwogICAgcmV0dXJuIGEgPCAweGQ4MDAgfHwgYSA+IDB4ZGJmZiB8fCBpICsgMSA9PT0gbCB8fCAoYiA9IHMuY2hhckNvZGVBdChpICsgMSkpIDwgMHhkYzAwIHx8IGIgPiAweGRmZmYKICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGEKICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGludm9rZSAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODgpCiAgLCBodG1sICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKQogICwgY2VsICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSkKICAsIGdsb2JhbCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBzZXRUYXNrICAgICAgICAgICAgPSBnbG9iYWwuc2V0SW1tZWRpYXRlCiAgLCBjbGVhclRhc2sgICAgICAgICAgPSBnbG9iYWwuY2xlYXJJbW1lZGlhdGUKICAsIE1lc3NhZ2VDaGFubmVsICAgICA9IGdsb2JhbC5NZXNzYWdlQ2hhbm5lbAogICwgY291bnRlciAgICAgICAgICAgID0gMAogICwgcXVldWUgICAgICAgICAgICAgID0ge30KICAsIE9OUkVBRFlTVEFURUNIQU5HRSA9ICdvbnJlYWR5c3RhdGVjaGFuZ2UnCiAgLCBkZWZlciwgY2hhbm5lbCwgcG9ydDsKdmFyIHJ1biA9IGZ1bmN0aW9uKCl7CiAgdmFyIGlkID0gK3RoaXM7CiAgaWYocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKXsKICAgIHZhciBmbiA9IHF1ZXVlW2lkXTsKICAgIGRlbGV0ZSBxdWV1ZVtpZF07CiAgICBmbigpOwogIH0KfTsKdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpewogIHJ1bi5jYWxsKGV2ZW50LmRhdGEpOwp9OwovLyBOb2RlLmpzIDAuOSsgJiBJRTEwKyBoYXMgc2V0SW1tZWRpYXRlLCBvdGhlcndpc2U6CmlmKCFzZXRUYXNrIHx8ICFjbGVhclRhc2spewogIHNldFRhc2sgPSBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoZm4pewogICAgdmFyIGFyZ3MgPSBbXSwgaSA9IDE7CiAgICB3aGlsZShhcmd1bWVudHMubGVuZ3RoID4gaSlhcmdzLnB1c2goYXJndW1lbnRzW2krK10pOwogICAgcXVldWVbKytjb3VudGVyXSA9IGZ1bmN0aW9uKCl7CiAgICAgIGludm9rZSh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pLCBhcmdzKTsKICAgIH07CiAgICBkZWZlcihjb3VudGVyKTsKICAgIHJldHVybiBjb3VudGVyOwogIH07CiAgY2xlYXJUYXNrID0gZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaWQpewogICAgZGVsZXRlIHF1ZXVlW2lkXTsKICB9OwogIC8vIE5vZGUuanMgMC44LQogIGlmKF9fd2VicGFja19yZXF1aXJlX18oMTgpKHByb2Nlc3MpID09ICdwcm9jZXNzJyl7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgcHJvY2Vzcy5uZXh0VGljayhjdHgocnVuLCBpZCwgMSkpOwogICAgfTsKICAvLyBCcm93c2VycyB3aXRoIE1lc3NhZ2VDaGFubmVsLCBpbmNsdWRlcyBXZWJXb3JrZXJzCiAgfSBlbHNlIGlmKE1lc3NhZ2VDaGFubmVsKXsKICAgIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWw7CiAgICBwb3J0ICAgID0gY2hhbm5lbC5wb3J0MjsKICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gbGlzdGVuZXI7CiAgICBkZWZlciA9IGN0eChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTsKICAvLyBCcm93c2VycyB3aXRoIHBvc3RNZXNzYWdlLCBza2lwIFdlYldvcmtlcnMKICAvLyBJRTggaGFzIHBvc3RNZXNzYWdlLCBidXQgaXQncyBzeW5jICYgdHlwZW9mIGl0cyBwb3N0TWVzc2FnZSBpcyAnb2JqZWN0JwogIH0gZWxzZSBpZihnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lciAmJiB0eXBlb2YgcG9zdE1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJyAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShpZCArICcnLCAnKicpOwogICAgfTsKICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbGlzdGVuZXIsIGZhbHNlKTsKICAvLyBJRTgtCiAgfSBlbHNlIGlmKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKXsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBodG1sLmFwcGVuZENoaWxkKGNlbCgnc2NyaXB0JykpW09OUkVBRFlTVEFURUNIQU5HRV0gPSBmdW5jdGlvbigpewogICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7CiAgICAgICAgcnVuLmNhbGwoaWQpOwogICAgICB9OwogICAgfTsKICAvLyBSZXN0IG9sZCBicm93c2VycwogIH0gZWxzZSB7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgc2V0VGltZW91dChjdHgocnVuLCBpZCwgMSksIDApOwogICAgfTsKICB9Cn0KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2V0OiAgIHNldFRhc2ssCiAgY2xlYXI6IGNsZWFyVGFzawp9OwoKLyoqKi8gfSksCi8qIDY4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KQogICwgbWF4ICAgICAgID0gTWF0aC5tYXgKICAsIG1pbiAgICAgICA9IE1hdGgubWluOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGluZGV4LCBsZW5ndGgpewogIGluZGV4ID0gdG9JbnRlZ2VyKGluZGV4KTsKICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbihpbmRleCwgbGVuZ3RoKTsKfTsKCi8qKiovIH0pLAovKiA2OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgYWRkVG9VbnNjb3BhYmxlcyA9IF9fd2VicGFja19yZXF1aXJlX18oNjApCiAgLCBzdGVwICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MykKICAsIEl0ZXJhdG9ycyAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQogICwgdG9JT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwoKLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKQovLyAyMi4xLjMuMTMgQXJyYXkucHJvdG90eXBlLmtleXMoKQovLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpCi8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzgpKEFycmF5LCAnQXJyYXknLCBmdW5jdGlvbihpdGVyYXRlZCwga2luZCl7CiAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4CiAgdGhpcy5fayA9IGtpbmQ7ICAgICAgICAgICAgICAgIC8vIGtpbmQKLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpCn0sIGZ1bmN0aW9uKCl7CiAgdmFyIE8gICAgID0gdGhpcy5fdAogICAgLCBraW5kICA9IHRoaXMuX2sKICAgICwgaW5kZXggPSB0aGlzLl9pKys7CiAgaWYoIU8gfHwgaW5kZXggPj0gTy5sZW5ndGgpewogICAgdGhpcy5fdCA9IHVuZGVmaW5lZDsKICAgIHJldHVybiBzdGVwKDEpOwogIH0KICBpZihraW5kID09ICdrZXlzJyAgKXJldHVybiBzdGVwKDAsIGluZGV4KTsKICBpZihraW5kID09ICd2YWx1ZXMnKXJldHVybiBzdGVwKDAsIE9baW5kZXhdKTsKICByZXR1cm4gc3RlcCgwLCBbaW5kZXgsIE9baW5kZXhdXSk7Cn0sICd2YWx1ZXMnKTsKCi8vIGFyZ3VtZW50c0xpc3RbQEBpdGVyYXRvcl0gaXMgJUFycmF5UHJvdG9fdmFsdWVzJSAoOS40LjQuNiwgOS40LjQuNykKSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTsKCmFkZFRvVW5zY29wYWJsZXMoJ2tleXMnKTsKYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7CmFkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTsKCi8qKiovIH0pLAovKiA3MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDcxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODIpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIE1FVEEgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykoJ21ldGEnKQogICwgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBoYXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBzZXREZXNjICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaWQgICAgICAgPSAwOwp2YXIgaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZSB8fCBmdW5jdGlvbigpewogIHJldHVybiB0cnVlOwp9Owp2YXIgRlJFRVpFID0gIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGlzRXh0ZW5zaWJsZShPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe30pKTsKfSk7CnZhciBzZXRNZXRhID0gZnVuY3Rpb24oaXQpewogIHNldERlc2MoaXQsIE1FVEEsIHt2YWx1ZTogewogICAgaTogJ08nICsgKytpZCwgLy8gb2JqZWN0IElECiAgICB3OiB7fSAgICAgICAgICAvLyB3ZWFrIGNvbGxlY3Rpb25zIElEcwogIH19KTsKfTsKdmFyIGZhc3RLZXkgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICAvLyByZXR1cm4gcHJpbWl0aXZlIHdpdGggcHJlZml4CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnID8gaXQgOiAodHlwZW9mIGl0ID09ICdzdHJpbmcnID8gJ1MnIDogJ1AnKSArIGl0OwogIGlmKCFoYXMoaXQsIE1FVEEpKXsKICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0CiAgICBpZighaXNFeHRlbnNpYmxlKGl0KSlyZXR1cm4gJ0YnOwogICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGEKICAgIGlmKCFjcmVhdGUpcmV0dXJuICdFJzsKICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhCiAgICBzZXRNZXRhKGl0KTsKICAvLyByZXR1cm4gb2JqZWN0IElECiAgfSByZXR1cm4gaXRbTUVUQV0uaTsKfTsKdmFyIGdldFdlYWsgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICBpZighaGFzKGl0LCBNRVRBKSl7CiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdAogICAgaWYoIWlzRXh0ZW5zaWJsZShpdCkpcmV0dXJuIHRydWU7CiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YQogICAgaWYoIWNyZWF0ZSlyZXR1cm4gZmFsc2U7CiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YQogICAgc2V0TWV0YShpdCk7CiAgLy8gcmV0dXJuIGhhc2ggd2VhayBjb2xsZWN0aW9ucyBJRHMKICB9IHJldHVybiBpdFtNRVRBXS53Owp9OwovLyBhZGQgbWV0YWRhdGEgb24gZnJlZXplLWZhbWlseSBtZXRob2RzIGNhbGxpbmcKdmFyIG9uRnJlZXplID0gZnVuY3Rpb24oaXQpewogIGlmKEZSRUVaRSAmJiBtZXRhLk5FRUQgJiYgaXNFeHRlbnNpYmxlKGl0KSAmJiAhaGFzKGl0LCBNRVRBKSlzZXRNZXRhKGl0KTsKICByZXR1cm4gaXQ7Cn07CnZhciBtZXRhID0gbW9kdWxlLmV4cG9ydHMgPSB7CiAgS0VZOiAgICAgIE1FVEEsCiAgTkVFRDogICAgIGZhbHNlLAogIGZhc3RLZXk6ICBmYXN0S2V5LAogIGdldFdlYWs6ICBnZXRXZWFrLAogIG9uRnJlZXplOiBvbkZyZWV6ZQp9OwoKLyoqKi8gfSksCi8qIDczICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjbGFzc29mICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KQogICwgSVRFUkFUT1IgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgSXRlcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCAhPSB1bmRlZmluZWQpcmV0dXJuIGl0W0lURVJBVE9SXQogICAgfHwgaXRbJ0BAaXRlcmF0b3InXQogICAgfHwgSXRlcmF0b3JzW2NsYXNzb2YoaXQpXTsKfTsKCi8qKiovIH0pLAovKiA3NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDc4KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODEpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDg0KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAwKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGUoUCwgRCl7CiAgcmV0dXJuICRPYmplY3QuY3JlYXRlKFAsIEQpOwp9OwoKLyoqKi8gfSksCi8qIDc5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAxKTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5nZXRQcm90b3R5cGVPZjsKCi8qKiovIH0pLAovKiA4MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMik7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Qua2V5czsKCi8qKiovIH0pLAovKiA4MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMyk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Quc2V0UHJvdG90eXBlT2Y7CgovKioqLyB9KSwKLyogODIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg1NCk7Cl9fd2VicGFja19yZXF1aXJlX18oNTApOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKX193ZWJwYWNrX3JlcXVpcmVfXygxMDQpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuUHJvbWlzZTsKCi8qKiovIH0pLAovKiA4MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNSk7Cl9fd2VicGFja19yZXF1aXJlX18oNTQpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNik7Cl9fd2VicGFja19yZXF1aXJlX18oMTA3KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLlN5bWJvbDsKCi8qKiovIH0pLAovKiA4NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkuZignaXRlcmF0b3InKTsKCi8qKiovIH0pLAovKiA4NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSwgZm9yYmlkZGVuRmllbGQpewogIGlmKCEoaXQgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikgfHwgKGZvcmJpZGRlbkZpZWxkICE9PSB1bmRlZmluZWQgJiYgZm9yYmlkZGVuRmllbGQgaW4gaXQpKXsKICAgIHRocm93IFR5cGVFcnJvcihuYW1lICsgJzogaW5jb3JyZWN0IGludm9jYXRpb24hJyk7CiAgfSByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogODYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gYWxsIGVudW1lcmFibGUgb2JqZWN0IGtleXMsIGluY2x1ZGVzIHN5bWJvbHMKdmFyIGdldEtleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QUyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHZhciByZXN1bHQgICAgID0gZ2V0S2V5cyhpdCkKICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZjsKICBpZihnZXRTeW1ib2xzKXsKICAgIHZhciBzeW1ib2xzID0gZ2V0U3ltYm9scyhpdCkKICAgICAgLCBpc0VudW0gID0gcElFLmYKICAgICAgLCBpICAgICAgID0gMAogICAgICAsIGtleTsKICAgIHdoaWxlKHN5bWJvbHMubGVuZ3RoID4gaSlpZihpc0VudW0uY2FsbChpdCwga2V5ID0gc3ltYm9sc1tpKytdKSlyZXN1bHQucHVzaChrZXkpOwogIH0gcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiA4NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgY2FsbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkxKQogICwgaXNBcnJheUl0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg5KQogICwgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCB0b0xlbmd0aCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCBnZXRJdGVyRm4gICA9IF9fd2VicGFja19yZXF1aXJlX18oNzMpCiAgLCBCUkVBSyAgICAgICA9IHt9CiAgLCBSRVRVUk4gICAgICA9IHt9Owp2YXIgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXRlcmFibGUsIGVudHJpZXMsIGZuLCB0aGF0LCBJVEVSQVRPUil7CiAgdmFyIGl0ZXJGbiA9IElURVJBVE9SID8gZnVuY3Rpb24oKXsgcmV0dXJuIGl0ZXJhYmxlOyB9IDogZ2V0SXRlckZuKGl0ZXJhYmxlKQogICAgLCBmICAgICAgPSBjdHgoZm4sIHRoYXQsIGVudHJpZXMgPyAyIDogMSkKICAgICwgaW5kZXggID0gMAogICAgLCBsZW5ndGgsIHN0ZXAsIGl0ZXJhdG9yLCByZXN1bHQ7CiAgaWYodHlwZW9mIGl0ZXJGbiAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdGVyYWJsZSArICcgaXMgbm90IGl0ZXJhYmxlIScpOwogIC8vIGZhc3QgY2FzZSBmb3IgYXJyYXlzIHdpdGggZGVmYXVsdCBpdGVyYXRvcgogIGlmKGlzQXJyYXlJdGVyKGl0ZXJGbikpZm9yKGxlbmd0aCA9IHRvTGVuZ3RoKGl0ZXJhYmxlLmxlbmd0aCk7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKXsKICAgIHJlc3VsdCA9IGVudHJpZXMgPyBmKGFuT2JqZWN0KHN0ZXAgPSBpdGVyYWJsZVtpbmRleF0pWzBdLCBzdGVwWzFdKSA6IGYoaXRlcmFibGVbaW5kZXhdKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9IGVsc2UgZm9yKGl0ZXJhdG9yID0gaXRlckZuLmNhbGwoaXRlcmFibGUpOyAhKHN0ZXAgPSBpdGVyYXRvci5uZXh0KCkpLmRvbmU7ICl7CiAgICByZXN1bHQgPSBjYWxsKGl0ZXJhdG9yLCBmLCBzdGVwLnZhbHVlLCBlbnRyaWVzKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9Cn07CmV4cG9ydHMuQlJFQUsgID0gQlJFQUs7CmV4cG9ydHMuUkVUVVJOID0gUkVUVVJOOwoKLyoqKi8gfSksCi8qIDg4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGZhc3QgYXBwbHksIGh0dHA6Ly9qc3BlcmYubG5raXQuY29tL2Zhc3QtYXBwbHkvNQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCBhcmdzLCB0aGF0KXsKICB2YXIgdW4gPSB0aGF0ID09PSB1bmRlZmluZWQ7CiAgc3dpdGNoKGFyZ3MubGVuZ3RoKXsKICAgIGNhc2UgMDogcmV0dXJuIHVuID8gZm4oKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQpOwogICAgY2FzZSAxOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0pOwogICAgY2FzZSAyOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0pOwogICAgY2FzZSAzOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pOwogICAgY2FzZSA0OiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pOwogIH0gcmV0dXJuICAgICAgICAgICAgICBmbi5hcHBseSh0aGF0LCBhcmdzKTsKfTsKCi8qKiovIH0pLAovKiA4OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBjaGVjayBvbiBkZWZhdWx0IEFycmF5IGl0ZXJhdG9yCnZhciBJdGVyYXRvcnMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsIElURVJBVE9SICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpCiAgLCBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b1tJVEVSQVRPUl0gPT09IGl0KTsKfTsKCi8qKiovIH0pLAovKiA5MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjIuMiBJc0FycmF5KGFyZ3VtZW50KQp2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7Cm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5KGFyZyl7CiAgcmV0dXJuIGNvZihhcmcpID09ICdBcnJheSc7Cn07CgovKioqLyB9KSwKLyogOTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gY2FsbCBzb21ldGhpbmcgb24gaXRlcmF0b3Igc3RlcCB3aXRoIHNhZmUgY2xvc2luZyBvbiBlcnJvcgp2YXIgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhdG9yLCBmbiwgdmFsdWUsIGVudHJpZXMpewogIHRyeSB7CiAgICByZXR1cm4gZW50cmllcyA/IGZuKGFuT2JqZWN0KHZhbHVlKVswXSwgdmFsdWVbMV0pIDogZm4odmFsdWUpOwogIC8vIDcuNC42IEl0ZXJhdG9yQ2xvc2UoaXRlcmF0b3IsIGNvbXBsZXRpb24pCiAgfSBjYXRjaChlKXsKICAgIHZhciByZXQgPSBpdGVyYXRvclsncmV0dXJuJ107CiAgICBpZihyZXQgIT09IHVuZGVmaW5lZClhbk9iamVjdChyZXQuY2FsbChpdGVyYXRvcikpOwogICAgdGhyb3cgZTsKICB9Cn07CgovKioqLyB9KSwKLyogOTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIElURVJBVE9SICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJykKICAsIFNBRkVfQ0xPU0lORyA9IGZhbHNlOwoKdHJ5IHsKICB2YXIgcml0ZXIgPSBbN11bSVRFUkFUT1JdKCk7CiAgcml0ZXJbJ3JldHVybiddID0gZnVuY3Rpb24oKXsgU0FGRV9DTE9TSU5HID0gdHJ1ZTsgfTsKICBBcnJheS5mcm9tKHJpdGVyLCBmdW5jdGlvbigpeyB0aHJvdyAyOyB9KTsKfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjLCBza2lwQ2xvc2luZyl7CiAgaWYoIXNraXBDbG9zaW5nICYmICFTQUZFX0NMT1NJTkcpcmV0dXJuIGZhbHNlOwogIHZhciBzYWZlID0gZmFsc2U7CiAgdHJ5IHsKICAgIHZhciBhcnIgID0gWzddCiAgICAgICwgaXRlciA9IGFycltJVEVSQVRPUl0oKTsKICAgIGl0ZXIubmV4dCA9IGZ1bmN0aW9uKCl7IHJldHVybiB7ZG9uZTogc2FmZSA9IHRydWV9OyB9OwogICAgYXJyW0lURVJBVE9SXSA9IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyOyB9OwogICAgZXhlYyhhcnIpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICByZXR1cm4gc2FmZTsKfTsKCi8qKiovIH0pLAovKiA5MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2V0S2V5cyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykKICAsIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgZWwpewogIHZhciBPICAgICAgPSB0b0lPYmplY3Qob2JqZWN0KQogICAgLCBrZXlzICAgPSBnZXRLZXlzKE8pCiAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCiAgICAsIGluZGV4ICA9IDAKICAgICwga2V5OwogIHdoaWxlKGxlbmd0aCA+IGluZGV4KWlmKE9ba2V5ID0ga2V5c1tpbmRleCsrXV0gPT09IGVsKXJldHVybiBrZXk7Cn07CgovKioqLyB9KSwKLyogOTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIG1hY3JvdGFzayA9IF9fd2VicGFja19yZXF1aXJlX18oNjcpLnNldAogICwgT2JzZXJ2ZXIgID0gZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIKICAsIHByb2Nlc3MgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBQcm9taXNlICAgPSBnbG9iYWwuUHJvbWlzZQogICwgaXNOb2RlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkocHJvY2VzcykgPT0gJ3Byb2Nlc3MnOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpewogIHZhciBoZWFkLCBsYXN0LCBub3RpZnk7CgogIHZhciBmbHVzaCA9IGZ1bmN0aW9uKCl7CiAgICB2YXIgcGFyZW50LCBmbjsKICAgIGlmKGlzTm9kZSAmJiAocGFyZW50ID0gcHJvY2Vzcy5kb21haW4pKXBhcmVudC5leGl0KCk7CiAgICB3aGlsZShoZWFkKXsKICAgICAgZm4gICA9IGhlYWQuZm47CiAgICAgIGhlYWQgPSBoZWFkLm5leHQ7CiAgICAgIHRyeSB7CiAgICAgICAgZm4oKTsKICAgICAgfSBjYXRjaChlKXsKICAgICAgICBpZihoZWFkKW5vdGlmeSgpOwogICAgICAgIGVsc2UgbGFzdCA9IHVuZGVmaW5lZDsKICAgICAgICB0aHJvdyBlOwogICAgICB9CiAgICB9IGxhc3QgPSB1bmRlZmluZWQ7CiAgICBpZihwYXJlbnQpcGFyZW50LmVudGVyKCk7CiAgfTsKCiAgLy8gTm9kZS5qcwogIGlmKGlzTm9kZSl7CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBwcm9jZXNzLm5leHRUaWNrKGZsdXNoKTsKICAgIH07CiAgLy8gYnJvd3NlcnMgd2l0aCBNdXRhdGlvbk9ic2VydmVyCiAgfSBlbHNlIGlmKE9ic2VydmVyKXsKICAgIHZhciB0b2dnbGUgPSB0cnVlCiAgICAgICwgbm9kZSAgID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpOwogICAgbmV3IE9ic2VydmVyKGZsdXNoKS5vYnNlcnZlKG5vZGUsIHtjaGFyYWN0ZXJEYXRhOiB0cnVlfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBub2RlLmRhdGEgPSB0b2dnbGUgPSAhdG9nZ2xlOwogICAgfTsKICAvLyBlbnZpcm9ubWVudHMgd2l0aCBtYXliZSBub24tY29tcGxldGVseSBjb3JyZWN0LCBidXQgZXhpc3RlbnQgUHJvbWlzZQogIH0gZWxzZSBpZihQcm9taXNlICYmIFByb21pc2UucmVzb2x2ZSl7CiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpOwogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgcHJvbWlzZS50aGVuKGZsdXNoKTsKICAgIH07CiAgLy8gZm9yIG90aGVyIGVudmlyb25tZW50cyAtIG1hY3JvdGFzayBiYXNlZCBvbjoKICAvLyAtIHNldEltbWVkaWF0ZQogIC8vIC0gTWVzc2FnZUNoYW5uZWwKICAvLyAtIHdpbmRvdy5wb3N0TWVzc2FnCiAgLy8gLSBvbnJlYWR5c3RhdGVjaGFuZ2UKICAvLyAtIHNldFRpbWVvdXQKICB9IGVsc2UgewogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgLy8gc3RyYW5nZSBJRSArIHdlYnBhY2sgZGV2IHNlcnZlciBidWcgLSB1c2UgLmNhbGwoZ2xvYmFsKQogICAgICBtYWNyb3Rhc2suY2FsbChnbG9iYWwsIGZsdXNoKTsKICAgIH07CiAgfQoKICByZXR1cm4gZnVuY3Rpb24oZm4pewogICAgdmFyIHRhc2sgPSB7Zm46IGZuLCBuZXh0OiB1bmRlZmluZWR9OwogICAgaWYobGFzdClsYXN0Lm5leHQgPSB0YXNrOwogICAgaWYoIWhlYWQpewogICAgICBoZWFkID0gdGFzazsKICAgICAgbm90aWZ5KCk7CiAgICB9IGxhc3QgPSB0YXNrOwogIH07Cn07CgovKioqLyB9KSwKLyogOTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsbGJhY2sgZm9yIElFMTEgYnVnZ3kgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgd2l0aCBpZnJhbWUgYW5kIHdpbmRvdwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIGdPUE4gICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjUpLmYKICAsIHRvU3RyaW5nICA9IHt9LnRvU3RyaW5nOwoKdmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMKICA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdykgOiBbXTsKCnZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uKGl0KXsKICB0cnkgewogICAgcmV0dXJuIGdPUE4oaXQpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gd2luZG93TmFtZXMuc2xpY2UoKTsKICB9Cn07Cgptb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCl7CiAgcmV0dXJuIHdpbmRvd05hbWVzICYmIHRvU3RyaW5nLmNhbGwoaXQpID09ICdbb2JqZWN0IFdpbmRvd10nID8gZ2V0V2luZG93TmFtZXMoaXQpIDogZ09QTih0b0lPYmplY3QoaXQpKTsKfTsKCgovKioqLyB9KSwKLyogOTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGhpZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHRhcmdldCwgc3JjLCBzYWZlKXsKICBmb3IodmFyIGtleSBpbiBzcmMpewogICAgaWYoc2FmZSAmJiB0YXJnZXRba2V5XSl0YXJnZXRba2V5XSA9IHNyY1trZXldOwogICAgZWxzZSBoaWRlKHRhcmdldCwga2V5LCBzcmNba2V5XSk7CiAgfSByZXR1cm4gdGFyZ2V0Owp9OwoKLyoqKi8gfSksCi8qIDk3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFdvcmtzIHdpdGggX19wcm90b19fIG9ubHkuIE9sZCB2OCBjYW4ndCB3b3JrIHdpdGggbnVsbCBwcm90byBvYmplY3RzLgovKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqLwp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CnZhciBjaGVjayA9IGZ1bmN0aW9uKE8sIHByb3RvKXsKICBhbk9iamVjdChPKTsKICBpZighaXNPYmplY3QocHJvdG8pICYmIHByb3RvICE9PSBudWxsKXRocm93IFR5cGVFcnJvcihwcm90byArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7Cn07Cm1vZHVsZS5leHBvcnRzID0gewogIHNldDogT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8ICgnX19wcm90b19fJyBpbiB7fSA/IC8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAgIGZ1bmN0aW9uKHRlc3QsIGJ1Z2d5LCBzZXQpewogICAgICB0cnkgewogICAgICAgIHNldCA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpKEZ1bmN0aW9uLmNhbGwsIF9fd2VicGFja19yZXF1aXJlX18oNTcpLmYoT2JqZWN0LnByb3RvdHlwZSwgJ19fcHJvdG9fXycpLnNldCwgMik7CiAgICAgICAgc2V0KHRlc3QsIFtdKTsKICAgICAgICBidWdneSA9ICEodGVzdCBpbnN0YW5jZW9mIEFycmF5KTsKICAgICAgfSBjYXRjaChlKXsgYnVnZ3kgPSB0cnVlOyB9CiAgICAgIHJldHVybiBmdW5jdGlvbiBzZXRQcm90b3R5cGVPZihPLCBwcm90byl7CiAgICAgICAgY2hlY2soTywgcHJvdG8pOwogICAgICAgIGlmKGJ1Z2d5KU8uX19wcm90b19fID0gcHJvdG87CiAgICAgICAgZWxzZSBzZXQoTywgcHJvdG8pOwogICAgICAgIHJldHVybiBPOwogICAgICB9OwogICAgfSh7fSwgZmFsc2UpIDogdW5kZWZpbmVkKSwKICBjaGVjazogY2hlY2sKfTsKCi8qKiovIH0pLAovKiA5OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZ2xvYmFsICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGRQICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgREVTQ1JJUFRPUlMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpCiAgLCBTUEVDSUVTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZKXsKICB2YXIgQyA9IHR5cGVvZiBjb3JlW0tFWV0gPT0gJ2Z1bmN0aW9uJyA/IGNvcmVbS0VZXSA6IGdsb2JhbFtLRVldOwogIGlmKERFU0NSSVBUT1JTICYmIEMgJiYgIUNbU1BFQ0lFU10pZFAuZihDLCBTUEVDSUVTLCB7CiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9CiAgfSk7Cn07CgovKioqLyB9KSwKLyogOTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpCnZhciBhbk9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBhRnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgU1BFQ0lFUyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnc3BlY2llcycpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE8sIEQpewogIHZhciBDID0gYW5PYmplY3QoTykuY29uc3RydWN0b3IsIFM7CiAgcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBEIDogYUZ1bmN0aW9uKFMpOwp9OwoKLyoqKi8gfSksCi8qIDEwMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0Jywge2NyZWF0ZTogX193ZWJwYWNrX3JlcXVpcmVfXygzNSl9KTsKCi8qKiovIH0pLAovKiAxMDEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjkgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciB0b09iamVjdCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Myk7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KSgnZ2V0UHJvdG90eXBlT2YnLCBmdW5jdGlvbigpewogIHJldHVybiBmdW5jdGlvbiBnZXRQcm90b3R5cGVPZihpdCl7CiAgICByZXR1cm4gJGdldFByb3RvdHlwZU9mKHRvT2JqZWN0KGl0KSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4xNCBPYmplY3Qua2V5cyhPKQp2YXIgdG9PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGtleXMgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCl9fd2VicGFja19yZXF1aXJlX18oNDUpKCdrZXlzJywgZnVuY3Rpb24oKXsKICByZXR1cm4gZnVuY3Rpb24ga2V5cyhpdCl7CiAgICByZXR1cm4gJGtleXModG9PYmplY3QoaXQpKTsKICB9Owp9KTsKCi8qKiovIH0pLAovKiAxMDMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjE5IE9iamVjdC5zZXRQcm90b3R5cGVPZihPLCBwcm90bykKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwokZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtzZXRQcm90b3R5cGVPZjogX193ZWJwYWNrX3JlcXVpcmVfXyg5Nykuc2V0fSk7CgovKioqLyB9KSwKLyogMTA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBMSUJSQVJZICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgZ2xvYmFsICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGNsYXNzb2YgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTUpCiAgLCAkZXhwb3J0ICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCBpc09iamVjdCAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhRnVuY3Rpb24gICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgYW5JbnN0YW5jZSAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NSkKICAsIGZvck9mICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODcpCiAgLCBzcGVjaWVzQ29uc3RydWN0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KQogICwgdGFzayAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Nykuc2V0CiAgLCBtaWNyb3Rhc2sgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk0KSgpCiAgLCBQUk9NSVNFICAgICAgICAgICAgPSAnUHJvbWlzZScKICAsIFR5cGVFcnJvciAgICAgICAgICA9IGdsb2JhbC5UeXBlRXJyb3IKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCAkUHJvbWlzZSAgICAgICAgICAgPSBnbG9iYWxbUFJPTUlTRV0KICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBpc05vZGUgICAgICAgICAgICAgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJwogICwgZW1wdHkgICAgICAgICAgICAgID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfQogICwgSW50ZXJuYWwsIEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSwgV3JhcHBlcjsKCnZhciBVU0VfTkFUSVZFID0gISFmdW5jdGlvbigpewogIHRyeSB7CiAgICAvLyBjb3JyZWN0IHN1YmNsYXNzaW5nIHdpdGggQEBzcGVjaWVzIHN1cHBvcnQKICAgIHZhciBwcm9taXNlICAgICA9ICRQcm9taXNlLnJlc29sdmUoMSkKICAgICAgLCBGYWtlUHJvbWlzZSA9IChwcm9taXNlLmNvbnN0cnVjdG9yID0ge30pW19fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKV0gPSBmdW5jdGlvbihleGVjKXsgZXhlYyhlbXB0eSwgZW1wdHkpOyB9OwogICAgLy8gdW5oYW5kbGVkIHJlamVjdGlvbnMgdHJhY2tpbmcgc3VwcG9ydCwgTm9kZUpTIFByb21pc2Ugd2l0aG91dCBpdCBmYWlscyBAQHNwZWNpZXMgdGVzdAogICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKSAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2U7CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9KCk7CgovLyBoZWxwZXJzCnZhciBzYW1lQ29uc3RydWN0b3IgPSBmdW5jdGlvbihhLCBiKXsKICAvLyB3aXRoIGxpYnJhcnkgd3JhcHBlciBzcGVjaWFsIGNhc2UKICByZXR1cm4gYSA9PT0gYiB8fCBhID09PSAkUHJvbWlzZSAmJiBiID09PSBXcmFwcGVyOwp9Owp2YXIgaXNUaGVuYWJsZSA9IGZ1bmN0aW9uKGl0KXsKICB2YXIgdGhlbjsKICByZXR1cm4gaXNPYmplY3QoaXQpICYmIHR5cGVvZiAodGhlbiA9IGl0LnRoZW4pID09ICdmdW5jdGlvbicgPyB0aGVuIDogZmFsc2U7Cn07CnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewogIHJldHVybiBzYW1lQ29uc3RydWN0b3IoJFByb21pc2UsIEMpCiAgICA/IG5ldyBQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgOiBuZXcgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5KEMpOwp9Owp2YXIgUHJvbWlzZUNhcGFiaWxpdHkgPSBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbihDKXsKICB2YXIgcmVzb2x2ZSwgcmVqZWN0OwogIHRoaXMucHJvbWlzZSA9IG5ldyBDKGZ1bmN0aW9uKCQkcmVzb2x2ZSwgJCRyZWplY3QpewogICAgaWYocmVzb2x2ZSAhPT0gdW5kZWZpbmVkIHx8IHJlamVjdCAhPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcignQmFkIFByb21pc2UgY29uc3RydWN0b3InKTsKICAgIHJlc29sdmUgPSAkJHJlc29sdmU7CiAgICByZWplY3QgID0gJCRyZWplY3Q7CiAgfSk7CiAgdGhpcy5yZXNvbHZlID0gYUZ1bmN0aW9uKHJlc29sdmUpOwogIHRoaXMucmVqZWN0ICA9IGFGdW5jdGlvbihyZWplY3QpOwp9Owp2YXIgcGVyZm9ybSA9IGZ1bmN0aW9uKGV4ZWMpewogIHRyeSB7CiAgICBleGVjKCk7CiAgfSBjYXRjaChlKXsKICAgIHJldHVybiB7ZXJyb3I6IGV9OwogIH0KfTsKdmFyIG5vdGlmeSA9IGZ1bmN0aW9uKHByb21pc2UsIGlzUmVqZWN0KXsKICBpZihwcm9taXNlLl9uKXJldHVybjsKICBwcm9taXNlLl9uID0gdHJ1ZTsKICB2YXIgY2hhaW4gPSBwcm9taXNlLl9jOwogIG1pY3JvdGFzayhmdW5jdGlvbigpewogICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgogICAgICAsIG9rICAgID0gcHJvbWlzZS5fcyA9PSAxCiAgICAgICwgaSAgICAgPSAwOwogICAgdmFyIHJ1biA9IGZ1bmN0aW9uKHJlYWN0aW9uKXsKICAgICAgdmFyIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbAogICAgICAgICwgcmVzb2x2ZSA9IHJlYWN0aW9uLnJlc29sdmUKICAgICAgICAsIHJlamVjdCAgPSByZWFjdGlvbi5yZWplY3QKICAgICAgICAsIGRvbWFpbiAgPSByZWFjdGlvbi5kb21haW4KICAgICAgICAsIHJlc3VsdCwgdGhlbjsKICAgICAgdHJ5IHsKICAgICAgICBpZihoYW5kbGVyKXsKICAgICAgICAgIGlmKCFvayl7CiAgICAgICAgICAgIGlmKHByb21pc2UuX2ggPT0gMilvbkhhbmRsZVVuaGFuZGxlZChwcm9taXNlKTsKICAgICAgICAgICAgcHJvbWlzZS5faCA9IDE7CiAgICAgICAgICB9CiAgICAgICAgICBpZihoYW5kbGVyID09PSB0cnVlKXJlc3VsdCA9IHZhbHVlOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZW50ZXIoKTsKICAgICAgICAgICAgcmVzdWx0ID0gaGFuZGxlcih2YWx1ZSk7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZXhpdCgpOwogICAgICAgICAgfQogICAgICAgICAgaWYocmVzdWx0ID09PSByZWFjdGlvbi5wcm9taXNlKXsKICAgICAgICAgICAgcmVqZWN0KFR5cGVFcnJvcignUHJvbWlzZS1jaGFpbiBjeWNsZScpKTsKICAgICAgICAgIH0gZWxzZSBpZih0aGVuID0gaXNUaGVuYWJsZShyZXN1bHQpKXsKICAgICAgICAgICAgdGhlbi5jYWxsKHJlc3VsdCwgcmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgICAgIH0gZWxzZSByZXNvbHZlKHJlc3VsdCk7CiAgICAgICAgfSBlbHNlIHJlamVjdCh2YWx1ZSk7CiAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgcmVqZWN0KGUpOwogICAgICB9CiAgICB9OwogICAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSlydW4oY2hhaW5baSsrXSk7IC8vIHZhcmlhYmxlIGxlbmd0aCAtIGNhbid0IHVzZSBmb3JFYWNoCiAgICBwcm9taXNlLl9jID0gW107CiAgICBwcm9taXNlLl9uID0gZmFsc2U7CiAgICBpZihpc1JlamVjdCAmJiAhcHJvbWlzZS5faClvblVuaGFuZGxlZChwcm9taXNlKTsKICB9KTsKfTsKdmFyIG9uVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YKICAgICAgLCBhYnJ1cHQsIGhhbmRsZXIsIGNvbnNvbGU7CiAgICBpZihpc1VuaGFuZGxlZChwcm9taXNlKSl7CiAgICAgIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgICBpZihpc05vZGUpewogICAgICAgICAgcHJvY2Vzcy5lbWl0KCd1bmhhbmRsZWRSZWplY3Rpb24nLCB2YWx1ZSwgcHJvbWlzZSk7CiAgICAgICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub251bmhhbmRsZWRyZWplY3Rpb24pewogICAgICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiB2YWx1ZX0pOwogICAgICAgIH0gZWxzZSBpZigoY29uc29sZSA9IGdsb2JhbC5jb25zb2xlKSAmJiBjb25zb2xlLmVycm9yKXsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbicsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBCcm93c2VycyBzaG91bGQgbm90IHRyaWdnZXIgYHJlamVjdGlvbkhhbmRsZWRgIGV2ZW50IGlmIGl0IHdhcyBoYW5kbGVkIGhlcmUsIE5vZGVKUyAtIHNob3VsZAogICAgICBwcm9taXNlLl9oID0gaXNOb2RlIHx8IGlzVW5oYW5kbGVkKHByb21pc2UpID8gMiA6IDE7CiAgICB9IHByb21pc2UuX2EgPSB1bmRlZmluZWQ7CiAgICBpZihhYnJ1cHQpdGhyb3cgYWJydXB0LmVycm9yOwogIH0pOwp9Owp2YXIgaXNVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKICBpZihwcm9taXNlLl9oID09IDEpcmV0dXJuIGZhbHNlOwogIHZhciBjaGFpbiA9IHByb21pc2UuX2EgfHwgcHJvbWlzZS5fYwogICAgLCBpICAgICA9IDAKICAgICwgcmVhY3Rpb247CiAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSl7CiAgICByZWFjdGlvbiA9IGNoYWluW2krK107CiAgICBpZihyZWFjdGlvbi5mYWlsIHx8ICFpc1VuaGFuZGxlZChyZWFjdGlvbi5wcm9taXNlKSlyZXR1cm4gZmFsc2U7CiAgfSByZXR1cm4gdHJ1ZTsKfTsKdmFyIG9uSGFuZGxlVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciBoYW5kbGVyOwogICAgaWYoaXNOb2RlKXsKICAgICAgcHJvY2Vzcy5lbWl0KCdyZWplY3Rpb25IYW5kbGVkJywgcHJvbWlzZSk7CiAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnJlamVjdGlvbmhhbmRsZWQpewogICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHByb21pc2UuX3Z9KTsKICAgIH0KICB9KTsKfTsKdmFyICRyZWplY3QgPSBmdW5jdGlvbih2YWx1ZSl7CiAgdmFyIHByb21pc2UgPSB0aGlzOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHByb21pc2UuX3YgPSB2YWx1ZTsKICBwcm9taXNlLl9zID0gMjsKICBpZighcHJvbWlzZS5fYSlwcm9taXNlLl9hID0gcHJvbWlzZS5fYy5zbGljZSgpOwogIG5vdGlmeShwcm9taXNlLCB0cnVlKTsKfTsKdmFyICRyZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpewogIHZhciBwcm9taXNlID0gdGhpcwogICAgLCB0aGVuOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHRyeSB7CiAgICBpZihwcm9taXNlID09PSB2YWx1ZSl0aHJvdyBUeXBlRXJyb3IoIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmIik7CiAgICBpZih0aGVuID0gaXNUaGVuYWJsZSh2YWx1ZSkpewogICAgICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKICAgICAgICB2YXIgd3JhcHBlciA9IHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfTsgLy8gd3JhcAogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGVuLmNhbGwodmFsdWUsIGN0eCgkcmVzb2x2ZSwgd3JhcHBlciwgMSksIGN0eCgkcmVqZWN0LCB3cmFwcGVyLCAxKSk7CiAgICAgICAgfSBjYXRjaChlKXsKICAgICAgICAgICRyZWplY3QuY2FsbCh3cmFwcGVyLCBlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgcHJvbWlzZS5fdiA9IHZhbHVlOwogICAgICBwcm9taXNlLl9zID0gMTsKICAgICAgbm90aWZ5KHByb21pc2UsIGZhbHNlKTsKICAgIH0KICB9IGNhdGNoKGUpewogICAgJHJlamVjdC5jYWxsKHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfSwgZSk7IC8vIHdyYXAKICB9Cn07CgovLyBjb25zdHJ1Y3RvciBwb2x5ZmlsbAppZighVVNFX05BVElWRSl7CiAgLy8gMjUuNC4zLjEgUHJvbWlzZShleGVjdXRvcikKICAkUHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpewogICAgYW5JbnN0YW5jZSh0aGlzLCAkUHJvbWlzZSwgUFJPTUlTRSwgJ19oJyk7CiAgICBhRnVuY3Rpb24oZXhlY3V0b3IpOwogICAgSW50ZXJuYWwuY2FsbCh0aGlzKTsKICAgIHRyeSB7CiAgICAgIGV4ZWN1dG9yKGN0eCgkcmVzb2x2ZSwgdGhpcywgMSksIGN0eCgkcmVqZWN0LCB0aGlzLCAxKSk7CiAgICB9IGNhdGNoKGVycil7CiAgICAgICRyZWplY3QuY2FsbCh0aGlzLCBlcnIpOwogICAgfQogIH07CiAgSW50ZXJuYWwgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKICAgIHRoaXMuX2MgPSBbXTsgICAgICAgICAgICAgLy8gPC0gYXdhaXRpbmcgcmVhY3Rpb25zCiAgICB0aGlzLl9hID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIGNoZWNrZWQgaW4gaXNVbmhhbmRsZWQgcmVhY3Rpb25zCiAgICB0aGlzLl9zID0gMDsgICAgICAgICAgICAgIC8vIDwtIHN0YXRlCiAgICB0aGlzLl9kID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIGRvbmUKICAgIHRoaXMuX3YgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gdmFsdWUKICAgIHRoaXMuX2ggPSAwOyAgICAgICAgICAgICAgLy8gPC0gcmVqZWN0aW9uIHN0YXRlLCAwIC0gZGVmYXVsdCwgMSAtIGhhbmRsZWQsIDIgLSB1bmhhbmRsZWQKICAgIHRoaXMuX24gPSBmYWxzZTsgICAgICAgICAgLy8gPC0gbm90aWZ5CiAgfTsKICBJbnRlcm5hbC5wcm90b3R5cGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KSgkUHJvbWlzZS5wcm90b3R5cGUsIHsKICAgIC8vIDI1LjQuNS4zIFByb21pc2UucHJvdG90eXBlLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpCiAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKXsKICAgICAgdmFyIHJlYWN0aW9uICAgID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsICRQcm9taXNlKSk7CiAgICAgIHJlYWN0aW9uLm9rICAgICA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PSAnZnVuY3Rpb24nID8gb25GdWxmaWxsZWQgOiB0cnVlOwogICAgICByZWFjdGlvbi5mYWlsICAgPSB0eXBlb2Ygb25SZWplY3RlZCA9PSAnZnVuY3Rpb24nICYmIG9uUmVqZWN0ZWQ7CiAgICAgIHJlYWN0aW9uLmRvbWFpbiA9IGlzTm9kZSA/IHByb2Nlc3MuZG9tYWluIDogdW5kZWZpbmVkOwogICAgICB0aGlzLl9jLnB1c2gocmVhY3Rpb24pOwogICAgICBpZih0aGlzLl9hKXRoaXMuX2EucHVzaChyZWFjdGlvbik7CiAgICAgIGlmKHRoaXMuX3Mpbm90aWZ5KHRoaXMsIGZhbHNlKTsKICAgICAgcmV0dXJuIHJlYWN0aW9uLnByb21pc2U7CiAgICB9LAogICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2gob25SZWplY3RlZCkKICAgICdjYXRjaCc6IGZ1bmN0aW9uKG9uUmVqZWN0ZWQpewogICAgICByZXR1cm4gdGhpcy50aGVuKHVuZGVmaW5lZCwgb25SZWplY3RlZCk7CiAgICB9CiAgfSk7CiAgUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbigpewogICAgdmFyIHByb21pc2UgID0gbmV3IEludGVybmFsOwogICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTsKICAgIHRoaXMucmVzb2x2ZSA9IGN0eCgkcmVzb2x2ZSwgcHJvbWlzZSwgMSk7CiAgICB0aGlzLnJlamVjdCAgPSBjdHgoJHJlamVjdCwgcHJvbWlzZSwgMSk7CiAgfTsKfQoKJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1Byb21pc2U6ICRQcm9taXNlfSk7Cl9fd2VicGFja19yZXF1aXJlX18oMjEpKCRQcm9taXNlLCBQUk9NSVNFKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg5OCkoUFJPTUlTRSk7CldyYXBwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApW1BST01JU0VdOwoKLy8gc3RhdGljcwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCBQUk9NSVNFLCB7CiAgLy8gMjUuNC40LjUgUHJvbWlzZS5yZWplY3QocikKICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyKXsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlamVjdCAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgICAkJHJlamVjdChyKTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQp9KTsKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoTElCUkFSWSB8fCAhVVNFX05BVElWRSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuNiBQcm9taXNlLnJlc29sdmUoeCkKICByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKHgpewogICAgLy8gaW5zdGFuY2VvZiBpbnN0ZWFkIG9mIGludGVybmFsIHNsb3QgY2hlY2sgYmVjYXVzZSB3ZSBzaG91bGQgZml4IGl0IHdpdGhvdXQgcmVwbGFjZW1lbnQgbmF0aXZlIFByb21pc2UgY29yZQogICAgaWYoeCBpbnN0YW5jZW9mICRQcm9taXNlICYmIHNhbWVDb25zdHJ1Y3Rvcih4LmNvbnN0cnVjdG9yLCB0aGlzKSlyZXR1cm4geDsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlc29sdmUgID0gY2FwYWJpbGl0eS5yZXNvbHZlOwogICAgJCRyZXNvbHZlKHgpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoVVNFX05BVElWRSAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fKDkyKShmdW5jdGlvbihpdGVyKXsKICAkUHJvbWlzZS5hbGwoaXRlcilbJ2NhdGNoJ10oZW1wdHkpOwp9KSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuMSBQcm9taXNlLmFsbChpdGVyYWJsZSkKICBhbGw6IGZ1bmN0aW9uIGFsbChpdGVyYWJsZSl7CiAgICB2YXIgQyAgICAgICAgICA9IHRoaXMKICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKICAgICAgLCByZXNvbHZlICAgID0gY2FwYWJpbGl0eS5yZXNvbHZlCiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwogICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgdmFyIHZhbHVlcyAgICA9IFtdCiAgICAgICAgLCBpbmRleCAgICAgPSAwCiAgICAgICAgLCByZW1haW5pbmcgPSAxOwogICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2UpewogICAgICAgIHZhciAkaW5kZXggICAgICAgID0gaW5kZXgrKwogICAgICAgICAgLCBhbHJlYWR5Q2FsbGVkID0gZmFsc2U7CiAgICAgICAgdmFsdWVzLnB1c2godW5kZWZpbmVkKTsKICAgICAgICByZW1haW5pbmcrKzsKICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgICBpZihhbHJlYWR5Q2FsbGVkKXJldHVybjsKICAgICAgICAgIGFscmVhZHlDYWxsZWQgID0gdHJ1ZTsKICAgICAgICAgIHZhbHVlc1skaW5kZXhdID0gdmFsdWU7CiAgICAgICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgfSk7CiAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9LAogIC8vIDI1LjQuNC40IFByb21pc2UucmFjZShpdGVyYWJsZSkKICByYWNlOiBmdW5jdGlvbiByYWNlKGl0ZXJhYmxlKXsKICAgIHZhciBDICAgICAgICAgID0gdGhpcwogICAgICAsIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgICAsIHJlamVjdCAgICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oY2FwYWJpbGl0eS5yZXNvbHZlLCByZWplY3QpOwogICAgICB9KTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwoKLyoqKi8gfSksCi8qIDEwNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyBFQ01BU2NyaXB0IDYgc3ltYm9scyBzaGltCnZhciBnbG9iYWwgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIERFU0NSSVBUT1JTICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBNRVRBICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpLktFWQogICwgJGZhaWxzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKQogICwgc2hhcmVkICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgdWlkICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKQogICwgd2tzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpCiAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCiAgLCB3a3NEZWZpbmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDgpCiAgLCBrZXlPZiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTMpCiAgLCBlbnVtS2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODYpCiAgLCBpc0FycmF5ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTApCiAgLCBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIF9jcmVhdGUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSkKICAsIGdPUE5FeHQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NSkKICAsICRHT1BEICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NykKICAsICREUCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgJGtleXMgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QRCAgICAgICAgICAgPSAkR09QRC5mCiAgLCBkUCAgICAgICAgICAgICA9ICREUC5mCiAgLCBnT1BOICAgICAgICAgICA9IGdPUE5FeHQuZgogICwgJFN5bWJvbCAgICAgICAgPSBnbG9iYWwuU3ltYm9sCiAgLCAkSlNPTiAgICAgICAgICA9IGdsb2JhbC5KU09OCiAgLCBfc3RyaW5naWZ5ICAgICA9ICRKU09OICYmICRKU09OLnN0cmluZ2lmeQogICwgUFJPVE9UWVBFICAgICAgPSAncHJvdG90eXBlJwogICwgSElEREVOICAgICAgICAgPSB3a3MoJ19oaWRkZW4nKQogICwgVE9fUFJJTUlUSVZFICAgPSB3a3MoJ3RvUHJpbWl0aXZlJykKICAsIGlzRW51bSAgICAgICAgID0ge30ucHJvcGVydHlJc0VudW1lcmFibGUKICAsIFN5bWJvbFJlZ2lzdHJ5ID0gc2hhcmVkKCdzeW1ib2wtcmVnaXN0cnknKQogICwgQWxsU3ltYm9scyAgICAgPSBzaGFyZWQoJ3N5bWJvbHMnKQogICwgT1BTeW1ib2xzICAgICAgPSBzaGFyZWQoJ29wLXN5bWJvbHMnKQogICwgT2JqZWN0UHJvdG8gICAgPSBPYmplY3RbUFJPVE9UWVBFXQogICwgVVNFX05BVElWRSAgICAgPSB0eXBlb2YgJFN5bWJvbCA9PSAnZnVuY3Rpb24nCiAgLCBRT2JqZWN0ICAgICAgICA9IGdsb2JhbC5RT2JqZWN0OwovLyBEb24ndCB1c2Ugc2V0dGVycyBpbiBRdCBTY3JpcHQsIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8xNzMKdmFyIHNldHRlciA9ICFRT2JqZWN0IHx8ICFRT2JqZWN0W1BST1RPVFlQRV0gfHwgIVFPYmplY3RbUFJPVE9UWVBFXS5maW5kQ2hpbGQ7CgovLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODcKdmFyIHNldFN5bWJvbERlc2MgPSBERVNDUklQVE9SUyAmJiAkZmFpbHMoZnVuY3Rpb24oKXsKICByZXR1cm4gX2NyZWF0ZShkUCh7fSwgJ2EnLCB7CiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBkUCh0aGlzLCAnYScsIHt2YWx1ZTogN30pLmE7IH0KICB9KSkuYSAhPSA3Owp9KSA/IGZ1bmN0aW9uKGl0LCBrZXksIEQpewogIHZhciBwcm90b0Rlc2MgPSBnT1BEKE9iamVjdFByb3RvLCBrZXkpOwogIGlmKHByb3RvRGVzYylkZWxldGUgT2JqZWN0UHJvdG9ba2V5XTsKICBkUChpdCwga2V5LCBEKTsKICBpZihwcm90b0Rlc2MgJiYgaXQgIT09IE9iamVjdFByb3RvKWRQKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7Cn0gOiBkUDsKCnZhciB3cmFwID0gZnVuY3Rpb24odGFnKXsKICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pOwogIHN5bS5fayA9IHRhZzsKICByZXR1cm4gc3ltOwp9OwoKdmFyIGlzU3ltYm9sID0gVVNFX05BVElWRSAmJiB0eXBlb2YgJFN5bWJvbC5pdGVyYXRvciA9PSAnc3ltYm9sJyA/IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnOwp9IDogZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCBpbnN0YW5jZW9mICRTeW1ib2w7Cn07Cgp2YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCl7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvKSRkZWZpbmVQcm9wZXJ0eShPUFN5bWJvbHMsIGtleSwgRCk7CiAgYW5PYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgYW5PYmplY3QoRCk7CiAgaWYoaGFzKEFsbFN5bWJvbHMsIGtleSkpewogICAgaWYoIUQuZW51bWVyYWJsZSl7CiAgICAgIGlmKCFoYXMoaXQsIEhJRERFTikpZFAoaXQsIEhJRERFTiwgY3JlYXRlRGVzYygxLCB7fSkpOwogICAgICBpdFtISURERU5dW2tleV0gPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgaWYoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSlpdFtISURERU5dW2tleV0gPSBmYWxzZTsKICAgICAgRCA9IF9jcmVhdGUoRCwge2VudW1lcmFibGU6IGNyZWF0ZURlc2MoMCwgZmFsc2UpfSk7CiAgICB9IHJldHVybiBzZXRTeW1ib2xEZXNjKGl0LCBrZXksIEQpOwogIH0gcmV0dXJuIGRQKGl0LCBrZXksIEQpOwp9Owp2YXIgJGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKGl0LCBQKXsKICBhbk9iamVjdChpdCk7CiAgdmFyIGtleXMgPSBlbnVtS2V5cyhQID0gdG9JT2JqZWN0KFApKQogICAgLCBpICAgID0gMAogICAgLCBsID0ga2V5cy5sZW5ndGgKICAgICwga2V5OwogIHdoaWxlKGwgPiBpKSRkZWZpbmVQcm9wZXJ0eShpdCwga2V5ID0ga2V5c1tpKytdLCBQW2tleV0pOwogIHJldHVybiBpdDsKfTsKdmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaXQsIFApewogIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfY3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9jcmVhdGUoaXQpLCBQKTsKfTsKdmFyICRwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IGZ1bmN0aW9uIHByb3BlcnR5SXNFbnVtZXJhYmxlKGtleSl7CiAgdmFyIEUgPSBpc0VudW0uY2FsbCh0aGlzLCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKTsKICBpZih0aGlzID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSlyZXR1cm4gZmFsc2U7CiAgcmV0dXJuIEUgfHwgIWhhcyh0aGlzLCBrZXkpIHx8ICFoYXMoQWxsU3ltYm9scywga2V5KSB8fCBoYXModGhpcywgSElEREVOKSAmJiB0aGlzW0hJRERFTl1ba2V5XSA/IEUgOiB0cnVlOwp9Owp2YXIgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICBpdCAgPSB0b0lPYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKXJldHVybjsKICB2YXIgRCA9IGdPUEQoaXQsIGtleSk7CiAgaWYoRCAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKUQuZW51bWVyYWJsZSA9IHRydWU7CiAgcmV0dXJuIEQ7Cn07CnZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpewogIHZhciBuYW1lcyAgPSBnT1BOKHRvSU9iamVjdChpdCkpCiAgICAsIHJlc3VsdCA9IFtdCiAgICAsIGkgICAgICA9IDAKICAgICwga2V5OwogIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewogICAgaWYoIWhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiBrZXkgIT0gSElEREVOICYmIGtleSAhPSBNRVRBKXJlc3VsdC5wdXNoKGtleSk7CiAgfSByZXR1cm4gcmVzdWx0Owp9Owp2YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCl7CiAgdmFyIElTX09QICA9IGl0ID09PSBPYmplY3RQcm90bwogICAgLCBuYW1lcyAgPSBnT1BOKElTX09QID8gT1BTeW1ib2xzIDogdG9JT2JqZWN0KGl0KSkKICAgICwgcmVzdWx0ID0gW10KICAgICwgaSAgICAgID0gMAogICAgLCBrZXk7CiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7CiAgICBpZihoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYgKElTX09QID8gaGFzKE9iamVjdFByb3RvLCBrZXkpIDogdHJ1ZSkpcmVzdWx0LnB1c2goQWxsU3ltYm9sc1trZXldKTsKICB9IHJldHVybiByZXN1bHQ7Cn07CgovLyAxOS40LjEuMSBTeW1ib2woW2Rlc2NyaXB0aW9uXSkKaWYoIVVTRV9OQVRJVkUpewogICRTeW1ib2wgPSBmdW5jdGlvbiBTeW1ib2woKXsKICAgIGlmKHRoaXMgaW5zdGFuY2VvZiAkU3ltYm9sKXRocm93IFR5cGVFcnJvcignU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIScpOwogICAgdmFyIHRhZyA9IHVpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7CiAgICB2YXIgJHNldCA9IGZ1bmN0aW9uKHZhbHVlKXsKICAgICAgaWYodGhpcyA9PT0gT2JqZWN0UHJvdG8pJHNldC5jYWxsKE9QU3ltYm9scywgdmFsdWUpOwogICAgICBpZihoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKXRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7CiAgICAgIHNldFN5bWJvbERlc2ModGhpcywgdGFnLCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7CiAgICB9OwogICAgaWYoREVTQ1JJUFRPUlMgJiYgc2V0dGVyKXNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0fSk7CiAgICByZXR1cm4gd3JhcCh0YWcpOwogIH07CiAgcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEVdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpewogICAgcmV0dXJuIHRoaXMuX2s7CiAgfSk7CgogICRHT1BELmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwogICREUC5mICAgPSAkZGVmaW5lUHJvcGVydHk7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg2NSkuZiA9IGdPUE5FeHQuZiA9ICRnZXRPd25Qcm9wZXJ0eU5hbWVzOwogIF9fd2VicGFja19yZXF1aXJlX18oNDEpLmYgID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlOwogIF9fd2VicGFja19yZXF1aXJlX18oNTgpLmYgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKICBpZihERVNDUklQVE9SUyAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygyNSkpewogICAgcmVkZWZpbmUoT2JqZWN0UHJvdG8sICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsICRwcm9wZXJ0eUlzRW51bWVyYWJsZSwgdHJ1ZSk7CiAgfQoKICB3a3NFeHQuZiA9IGZ1bmN0aW9uKG5hbWUpewogICAgcmV0dXJuIHdyYXAod2tzKG5hbWUpKTsKICB9Cn0KCiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtTeW1ib2w6ICRTeW1ib2x9KTsKCmZvcih2YXIgc3ltYm9scyA9ICgKICAvLyAxOS40LjIuMiwgMTkuNC4yLjMsIDE5LjQuMi40LCAxOS40LjIuNiwgMTkuNC4yLjgsIDE5LjQuMi45LCAxOS40LjIuMTAsIDE5LjQuMi4xMSwgMTkuNC4yLjEyLCAxOS40LjIuMTMsIDE5LjQuMi4xNAogICdoYXNJbnN0YW5jZSxpc0NvbmNhdFNwcmVhZGFibGUsaXRlcmF0b3IsbWF0Y2gscmVwbGFjZSxzZWFyY2gsc3BlY2llcyxzcGxpdCx0b1ByaW1pdGl2ZSx0b1N0cmluZ1RhZyx1bnNjb3BhYmxlcycKKS5zcGxpdCgnLCcpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzKHN5bWJvbHNbaSsrXSk7Cgpmb3IodmFyIHN5bWJvbHMgPSAka2V5cyh3a3Muc3RvcmUpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzRGVmaW5lKHN5bWJvbHNbaSsrXSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywgewogIC8vIDE5LjQuMi4xIFN5bWJvbC5mb3Ioa2V5KQogICdmb3InOiBmdW5jdGlvbihrZXkpewogICAgcmV0dXJuIGhhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKQogICAgICA/IFN5bWJvbFJlZ2lzdHJ5W2tleV0KICAgICAgOiBTeW1ib2xSZWdpc3RyeVtrZXldID0gJFN5bWJvbChrZXkpOwogIH0sCiAgLy8gMTkuNC4yLjUgU3ltYm9sLmtleUZvcihzeW0pCiAga2V5Rm9yOiBmdW5jdGlvbiBrZXlGb3Ioa2V5KXsKICAgIGlmKGlzU3ltYm9sKGtleSkpcmV0dXJuIGtleU9mKFN5bWJvbFJlZ2lzdHJ5LCBrZXkpOwogICAgdGhyb3cgVHlwZUVycm9yKGtleSArICcgaXMgbm90IGEgc3ltYm9sIScpOwogIH0sCiAgdXNlU2V0dGVyOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSB0cnVlOyB9LAogIHVzZVNpbXBsZTogZnVuY3Rpb24oKXsgc2V0dGVyID0gZmFsc2U7IH0KfSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnT2JqZWN0JywgewogIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKICBjcmVhdGU6ICRjcmVhdGUsCiAgLy8gMTkuMS4yLjQgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCiAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSwKICAvLyAxOS4xLjIuMyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKQogIGRlZmluZVByb3BlcnRpZXM6ICRkZWZpbmVQcm9wZXJ0aWVzLAogIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkKICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsCiAgLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcywKICAvLyAxOS4xLjIuOCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKE8pCiAgZ2V0T3duUHJvcGVydHlTeW1ib2xzOiAkZ2V0T3duUHJvcGVydHlTeW1ib2xzCn0pOwoKLy8gMjQuMy4yIEpTT04uc3RyaW5naWZ5KHZhbHVlIFssIHJlcGxhY2VyIFssIHNwYWNlXV0pCiRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbigpewogIHZhciBTID0gJFN5bWJvbCgpOwogIC8vIE1TIEVkZ2UgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIHt9CiAgLy8gV2ViS2l0IGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyBudWxsCiAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHMKICByZXR1cm4gX3N0cmluZ2lmeShbU10pICE9ICdbbnVsbF0nIHx8IF9zdHJpbmdpZnkoe2E6IFN9KSAhPSAne30nIHx8IF9zdHJpbmdpZnkoT2JqZWN0KFMpKSAhPSAne30nOwp9KSksICdKU09OJywgewogIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXsKICAgIGlmKGl0ID09PSB1bmRlZmluZWQgfHwgaXNTeW1ib2woaXQpKXJldHVybjsgLy8gSUU4IHJldHVybnMgc3RyaW5nIG9uIHVuZGVmaW5lZAogICAgdmFyIGFyZ3MgPSBbaXRdCiAgICAgICwgaSAgICA9IDEKICAgICAgLCByZXBsYWNlciwgJHJlcGxhY2VyOwogICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKICAgIHJlcGxhY2VyID0gYXJnc1sxXTsKICAgIGlmKHR5cGVvZiByZXBsYWNlciA9PSAnZnVuY3Rpb24nKSRyZXBsYWNlciA9IHJlcGxhY2VyOwogICAgaWYoJHJlcGxhY2VyIHx8ICFpc0FycmF5KHJlcGxhY2VyKSlyZXBsYWNlciA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpewogICAgICBpZigkcmVwbGFjZXIpdmFsdWUgPSAkcmVwbGFjZXIuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTsKICAgICAgaWYoIWlzU3ltYm9sKHZhbHVlKSlyZXR1cm4gdmFsdWU7CiAgICB9OwogICAgYXJnc1sxXSA9IHJlcGxhY2VyOwogICAgcmV0dXJuIF9zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3MpOwogIH0KfSk7CgovLyAxOS40LjMuNCBTeW1ib2wucHJvdG90eXBlW0BAdG9QcmltaXRpdmVdKGhpbnQpCiRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IF9fd2VicGFja19yZXF1aXJlX18oNikoJFN5bWJvbFtQUk9UT1RZUEVdLCBUT19QUklNSVRJVkUsICRTeW1ib2xbUFJPVE9UWVBFXS52YWx1ZU9mKTsKLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXQpzZXRUb1N0cmluZ1RhZygkU3ltYm9sLCAnU3ltYm9sJyk7Ci8vIDIwLjIuMS45IE1hdGhbQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTsKLy8gMjQuMy4zIEpTT05bQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoZ2xvYmFsLkpTT04sICdKU09OJywgdHJ1ZSk7CgovKioqLyB9KSwKLyogMTA2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdhc3luY0l0ZXJhdG9yJyk7CgovKioqLyB9KSwKLyogMTA3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdvYnNlcnZhYmxlJyk7CgovKioqLyB9KSwKLyogMTA4ICovLAovKiAxMDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfc3RyaW5naWZ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7Cgp2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKZXhwb3J0cy5kaXZpZGVFbWFpbCA9IGRpdmlkZUVtYWlsOwpleHBvcnRzLmVtcHR5T2JqZWN0ID0gZW1wdHlPYmplY3Q7CmV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwpleHBvcnRzLmdldFVzZXJVUkxGcm9tRW1haWwgPSBnZXRVc2VyVVJMRnJvbUVtYWlsOwpleHBvcnRzLmdldFVzZXJFbWFpbEZyb21VUkwgPSBnZXRVc2VyRW1haWxGcm9tVVJMOwpleHBvcnRzLmNvbnZlcnRUb1VzZXJVUkwgPSBjb252ZXJ0VG9Vc2VyVVJMOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwovKioKICogU3VwcG9ydCBtb2R1bGUgd2l0aCBzb21lIGZ1bmN0aW9ucyB3aWxsIGJlIHVzZWZ1bAogKiBAbW9kdWxlIHV0aWxzCiAqLwoKLyoqCiAqIEB0eXBlZGVmIGRpdmlkZVVSTAogKiBAdHlwZSBPYmplY3QKICogQHByb3BlcnR5IHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgVVJMCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkb21haW4gVGhlIGRvbWFpbiBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiBVUkwKICovCgovKioKICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5CiAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAqIEByZXR1cm4ge2RpdmlkZVVSTH0gdGhlIHJlc3VsdCBvZiBkaXZpZGVVUkwKICovCmZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHsKCiAgaWYgKCF1cmwpIHRocm93IEVycm9yKCdVUkwgaXMgbmVlZGVkIHRvIHNwbGl0Jyk7CgogIGZ1bmN0aW9uIHJlY3Vyc2UodmFsdWUpIHsKICAgIHZhciByZWdleCA9IC8oW2EtekEtWi1dKikoOlwvXC8oPzpcLik/fDopKFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTsKICAgIHZhciBzdWJzdCA9ICckMSwkMywkNCc7CiAgICB2YXIgcGFydHMgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBzdWJzdCkuc3BsaXQoJywnKTsKICAgIHJldHVybiBwYXJ0czsKICB9CgogIHZhciBwYXJ0cyA9IHJlY3Vyc2UodXJsKTsKCiAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lCiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgIXBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKCiAgICB2YXIgX3Jlc3VsdCA9IHsKICAgICAgdHlwZTogIiIsCiAgICAgIGRvbWFpbjogdXJsLAogICAgICBpZGVudGl0eTogIiIKICAgIH07CgogICAgY29uc29sZS5lcnJvcignW0RpdmlkZVVSTF0gRGl2aWRlVVJMIGRvblwndCBzdXBwb3J0IHVybCB3aXRob3V0IHNjaGVtZS4gUGxlYXNlIHJldmlldyB5b3VyIHVybCBhZGRyZXNzJywgdXJsKTsKCiAgICByZXR1cm4gX3Jlc3VsdDsKICB9CgogIC8vIGNoZWNrIGlmIHRoZSB1cmwgaGFzIHRoZSBzY2hlbWUgYW5kIGluY2x1ZGVzIGFuIEAKICBpZiAocGFydHNbMF0gPT09IHVybCAmJiBwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CiAgICB2YXIgc2NoZW1lID0gcGFydHNbMF0gPT09IHVybCA/ICdzbXRwJyA6IHBhcnRzWzBdOwogICAgcGFydHMgPSByZWN1cnNlKHNjaGVtZSArICc6Ly8nICsgcGFydHNbMF0pOwogIH0KCiAgLy8gaWYgdGhlIGRvbWFpbiBpbmNsdWRlcyBhbiBALCBkaXZpZGUgaXQgdG8gZG9tYWluIGFuZCBpZGVudGl0eSByZXNwZWN0aXZlbHkKICBpZiAocGFydHNbMV0uaW5jbHVkZXMoJ0AnKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1swXSArICc6Ly8nICsgcGFydHNbMV07CiAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdLnN1YnN0cihwYXJ0c1sxXS5pbmRleE9mKCdAJykgKyAxKTsKICB9IC8qZWxzZSBpZiAocGFydHNbMl0uaW5jbHVkZXMoJy8nKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1syXS5zdWJzdHIocGFydHNbMl0ubGFzdEluZGV4T2YoJy8nKSsxKTsKICAgIH0qLwoKICB2YXIgcmVzdWx0ID0gewogICAgdHlwZTogcGFydHNbMF0sCiAgICBkb21haW46IHBhcnRzWzFdLAogICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgfTsKCiAgcmV0dXJuIHJlc3VsdDsKfQoKZnVuY3Rpb24gZGl2aWRlRW1haWwoZW1haWwpIHsKICB2YXIgaW5kZXhPZkF0ID0gZW1haWwuaW5kZXhPZignQCcpOwoKICB2YXIgcmVzdWx0ID0gewogICAgdXNlcm5hbWU6IGVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpLAogICAgZG9tYWluOiBlbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgZW1haWwubGVuZ3RoKQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBDaGVjayBpZiBhbiBPYmplY3QgaXMgZW1wdHkKICogQHBhcmFtICB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IHRvIGJlIGNoZWNrZWQKICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgc3RhdHVzIG9mIE9iamVjdCwgZW1wdHkgb3Igbm90ICh0cnVlfGZhbHNlKTsKICovCmZ1bmN0aW9uIGVtcHR5T2JqZWN0KG9iamVjdCkgewogIHJldHVybiAoMCwgX2tleXMyLmRlZmF1bHQpKG9iamVjdCkubGVuZ3RoID4gMCA/IGZhbHNlIDogdHJ1ZTsKfQoKLyoqCiAqIE1ha2UgYSBDT1BZIG9mIHRoZSBvcmlnaW5hbCBkYXRhCiAqIEBwYXJhbSAge09iamVjdH0gIG9iaiAtIG9iamVjdCB0byBiZSBjbG9uZWQKICogQHJldHVybiB7T2JqZWN0fQogKi8KZnVuY3Rpb24gZGVlcENsb25lKG9iaikgewogIC8vVE9ETzogc2ltcGxlIGJ1dCBpbmVmZmljaWVudCBKU09OIGRlZXAgY2xvbmUuLi4KICBpZiAob2JqKSByZXR1cm4gSlNPTi5wYXJzZSgoMCwgX3N0cmluZ2lmeTIuZGVmYXVsdCkob2JqKSk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIFVSTCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gZW1haWwKICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICogQHJldHVybiB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICovCmZ1bmN0aW9uIGdldFVzZXJVUkxGcm9tRW1haWwodXNlckVtYWlsKSB7CiAgdmFyIGluZGV4T2ZBdCA9IHVzZXJFbWFpbC5pbmRleE9mKCdAJyk7CiAgcmV0dXJuICd1c2VyOi8vJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgdXNlckVtYWlsLmxlbmd0aCkgKyAnLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIGVtYWlsIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBVUkwKICogQHBhcmFtICB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICogQHJldHVybiB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICovCmZ1bmN0aW9uIGdldFVzZXJFbWFpbEZyb21VUkwodXNlclVSTCkgewogIHZhciB1cmwgPSBkaXZpZGVVUkwodXNlclVSTCk7CiAgcmV0dXJuIHVybC5pZGVudGl0eS5yZXBsYWNlKCcvJywgJycpICsgJ0AnICsgdXJsLmRvbWFpbjsgLy8gaWRlbnRpdHkgZmllbGQgaGFzICcvZXhhbXBsZUlEJyBpbnN0ZWFkIG9mICdleGFtcGxlSUQnCn0KCi8qKgogKiBDaGVjayBpZiB0aGUgdXNlciBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIFVSTCBmb3JtYXQsIGlmIG5vdCwgY29udmVydCB0byBVUkwgZm9ybWF0CiAqIEBwYXJhbSAge3N0cmluZ30gICBpZGVudGlmaWVyICB1c2VyIGlkZW50aWZpZXIKICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMCiAqLwpmdW5jdGlvbiBjb252ZXJ0VG9Vc2VyVVJMKGlkZW50aWZpZXIpIHsKCiAgLy8gY2hlY2sgaWYgdGhlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgdXJsIGZvcm1hdAogIGlmIChpZGVudGlmaWVyLnN1YnN0cmluZygwLCA3KSA9PT0gJ3VzZXI6Ly8nKSB7CiAgICB2YXIgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChpZGVudGlmaWVyKTsKCiAgICAvL2NoZWNrIGlmIHRoZSB1cmwgaXMgd2VsbCBmb3JtYXRlZAogICAgaWYgKGRpdmlkZWRVUkwuZG9tYWluICYmIGRpdmlkZWRVUkwuaWRlbnRpdHkpIHsKICAgICAgcmV0dXJuIGlkZW50aWZpZXI7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyAndXNlclVSTCB3aXRoIHdyb25nIGZvcm1hdCc7CiAgICB9CgogICAgLy9pZiBub3QsIGNvbnZlcnQgdGhlIHVzZXIgZW1haWwgdG8gVVJMIGZvcm1hdAogIH0gZWxzZSB7CiAgICByZXR1cm4gZ2V0VXNlclVSTEZyb21FbWFpbChpZGVudGlmaWVyKTsKICB9Cn0KCi8qKiovIH0pLAovKiAxMTAgKi8sCi8qIDExMSAqLywKLyogMTEyICovLAovKiAxMTMgKi8sCi8qIDExNCAqLywKLyogMTE1ICovLAovKiAxMTYgKi8sCi8qIDExNyAqLywKLyogMTE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMik7Cgp2YXIgX2dldDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMyk7Cgp2YXIgX2dldDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXQyKTsKCnZhciBfaW5oZXJpdHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMyk7Cgp2YXIgX2luaGVyaXRzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2luaGVyaXRzMik7Cgp2YXIgX0RhdGFPYmplY3QyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjApOwoKdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCnZhciBfRGF0YU9iamVjdENoaWxkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjEpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdENoaWxkKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBGaWx0ZXJUeXBlID0geyBBTlk6ICdhbnknLCBTVEFSVDogJ3N0YXJ0JywgRVhBQ1Q6ICdleGFjdCcgfTsKCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBzdWJzY3JpYmUgY2FsbC4KICogVG8gYmUgdXNlZCBhcyBhbiBvYnNlcnZhdGlvbiBwb2ludCBmcm9tIGEgRGF0YU9iamVjdFJlcG9ydGVyIGNoYW5nZS4KICovCgp2YXIgRGF0YU9iamVjdE9ic2VydmVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CiAgKDAsIF9pbmhlcml0czMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBfRGF0YU9iamVjdCk7CgogIC8qIHByaXZhdGUKICBfY2hhbmdlTGlzdGVuZXI6IE1zZ0xpc3RlbmVyCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfZmlsdGVyczogezxmaWx0ZXI+OiB7dHlwZTogPHN0YXJ0LCBleGFjdD4sIGNhbGxiYWNrOiA8ZnVuY3Rpb24+fSB9CiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyLnN1YnNjcmliZSBtZXRob2QKICAgKi8KCiAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogIGZ1bmN0aW9uIERhdGFPYmplY3RPYnNlcnZlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucywgaW5pdGlhbFZlcnNpb24sIG11dHVhbCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdE9ic2VydmVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdE9ic2VydmVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YS5kYXRhLCBjaGlsZHJlbnMsIG11dHVhbCkpOwoKICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IGluaXRpYWxWZXJzaW9uOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewogICAgICBfdGhpcy5fb25GaWx0ZXIoZXZlbnQpOwogICAgfSk7CgogICAgLy9zZXR1cCBjaGlsZHJlbnMgZGF0YSBmcm9tIHN1YnNjcmlwdGlvbgogICAgKDAsIF9rZXlzMi5kZWZhdWx0KShpbml0aWFsRGF0YS5jaGlsZHJlbnMpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkSWQpIHsKICAgICAgdmFyIGNoaWxkRGF0YSA9IGluaXRpYWxEYXRhLmNoaWxkcmVuc1tjaGlsZElkXTsKICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBjaGlsZElkLCBjaGlsZERhdGEpOwogICAgfSk7CgogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwgKyAnL2NoYW5nZXMnLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgaWYgKG1zZy50eXBlID09PSAndXBkYXRlJykgewogICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwogICAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChfdGhpcy5fc3luY09iaiwgbXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICd1bnN1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsVW5TdWJzY3JpYmUKICAgICAgdmFyIHVuU3Vic2NyaWJlTXNnID0gewogICAgICAgIHR5cGU6ICd1bnN1YnNjcmliZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHVuU3Vic2NyaWJlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdE9ic2VydmVyLVVOU1VCU0NSSUJFOiAnLCByZXBseSk7CiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsdGVyIC0gRmlsdGVyIHRoYXQgaWRlbnRpZmllcyB0aGUgZmllbGQgKHNlcGFyYXRlZCBkb3QgcGF0aCkuIEFjY2VwdHMgKiBhdCB0aGUgZW5kIGZvciBhIG1vcmUgdW5yZXN0cmljdGVkIGZpbHRlcmluZy4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkNoYW5nZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2UoZmlsdGVyLCBjYWxsYmFjaykgewogICAgICB2YXIga2V5ID0gZmlsdGVyOwogICAgICB2YXIgZmlsdGVyT2JqID0gewogICAgICAgIHR5cGU6IEZpbHRlclR5cGUuRVhBQ1QsCiAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrCiAgICAgIH07CgogICAgICB2YXIgaWR4ID0gZmlsdGVyLmluZGV4T2YoJyonKTsKICAgICAgaWYgKGlkeCA9PT0gZmlsdGVyLmxlbmd0aCAtIDEpIHsKICAgICAgICBpZiAoaWR4ID09PSAwKSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuQU5ZOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuU1RBUlQ7CiAgICAgICAgICBrZXkgPSBmaWx0ZXIuc3Vic3RyKDAsIGZpbHRlci5sZW5ndGggLSAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuX2ZpbHRlcnNba2V5XSA9IGZpbHRlck9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25GaWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZpbHRlcihldmVudCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fZmlsdGVycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdmFyIGZpbHRlciA9IF90aGlzLl9maWx0ZXJzW2tleV07CiAgICAgICAgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLkFOWSkgewogICAgICAgICAgLy9tYXRjaCBhbnl0aGluZwogICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKICAgICAgICB9IGVsc2UgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLlNUQVJUKSB7CiAgICAgICAgICAvL2lmIHN0YXJ0cyB3aXRoIGZpbHRlci4uLgogICAgICAgICAgaWYgKGV2ZW50LmZpZWxkLmluZGV4T2Yoa2V5KSA9PT0gMCkgewogICAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuRVhBQ1QpIHsKICAgICAgICAgIC8vZXhhY3QgbWF0Y2gKICAgICAgICAgIGlmIChldmVudC5maWVsZCA9PT0ga2V5KSB7CiAgICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFPYmplY3RPYnNlcnZlcjsKfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdE9ic2VydmVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKdmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yKTsKCnZhciBfZ2V0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCnZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKdmFyIF9pbmhlcml0czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTsKCnZhciBfaW5oZXJpdHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5oZXJpdHMyKTsKCnZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCk7Cgp2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgY3JlYXRlIGNhbGwuCiAqIFRvIGJlIHVzZWQgYXMgYSByZXBvcnRlciBwb2ludCwgY2hhbmdlcyB3aWxsIGJlIHN1Ym1pdGVkIHRvIERhdGFPYmplY3RPYnNlcnZlciBpbnN0YW5jZXMuCiAqLwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBEYXRhT2JqZWN0UmVwb3J0ZXIgPSBmdW5jdGlvbiAoX0RhdGFPYmplY3QpIHsKICAoMCwgX2luaGVyaXRzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIF9EYXRhT2JqZWN0KTsKCiAgLyogcHJpdmF0ZQogIF9zdWJzY3JpcHRpb25zOiA8aHlwZXJ0eVVybDogeyBzdGF0dXM6IHN0cmluZyB9IH0+CiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25TdWJzY3JpcHRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICBfb25SZXNwb25zZUhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlYWRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuY3JlYXRlIG1ldGhvZAogICAqLwogIGZ1bmN0aW9uIERhdGFPYmplY3RSZXBvcnRlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdFJlcG9ydGVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdFJlcG9ydGVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSk7CgogICAgdmFyIF90aGlzID0gX3RoaXMyOwoKICAgIF90aGlzLl9zdWJzY3JpcHRpb25zID0ge307CgogICAgX3RoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci0nICsgdXJsICsgJy1TRU5EOiAnLCBldmVudCk7CiAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCk7CiAgICB9KTsKCiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgIHJldHVybiBfdGhpczI7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX2FsbG9jYXRlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9vYmplY3RMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgewogICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0LScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewogICAgICAgICAgY2FzZSAncmVzcG9uc2UnOgogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpO2JyZWFrOwogICAgICAgICAgY2FzZSAncmVhZCc6CiAgICAgICAgICAgIF90aGlzLl9vblJlYWQobXNnKTticmVhazsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX29iamVjdExpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogU2VuZCBpbnZpdGF0aW9ucyAoY3JlYXRlIG1lc3NhZ2VzKSB0byBoeXBlcnRpZXMsIG9ic2VydmVycyBsaXN0LgogICAgICogQHBhcmFtICB7SHlwZXJ0eVVSTFtdfSBvYnNlcnZlcnMgTGlzdCBvZiBIeXBlcnR5IFVSTCdzCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnaW52aXRlT2JzZXJ2ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnZpdGVPYnNlcnZlcnMob2JzZXJ2ZXJzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkNyZWF0ZQogICAgICB2YXIgaW52aXRlTXNnID0gewogICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fc3luY2hlci5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAogICAgICAgIGJvZHk6IHsgcmVzdW1lOiBmYWxzZSwgcmVzb3VyY2U6IF90aGlzLl91cmwsIHNjaGVtYTogX3RoaXMuX3NjaGVtYSwgdmFsdWU6IF90aGlzLl9zeW5jT2JqLmRhdGEsIGF1dGhvcmlzZTogb2JzZXJ2ZXJzIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoaW52aXRlTXNnKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uRGVsZXRlCiAgICAgIHZhciBkZWxldGVNc2cgPSB7CiAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGRlbGV0ZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1ERUxFVEU6ICcsIHJlcGx5KTsKICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX3JlcG9ydGVyc1tfdGhpcy5fdXJsXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU3Vic2NyaXB0aW9ucyByZXF1ZXN0ZWQgYW5kIGFjY2VwdGVkIHRvIHRoaXMgcmVwb3J0ZXIKICAgICAqIEB0eXBlIHtPYmplY3Q8SHlwZXJ0eVVSTCwgU3luY1N1YnNjcmlwdGlvbj59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25TdWJzY3JpcHRpb24nLAoKCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHN1YnNjcmliZSBhbmQgdW5zdWJzY3JpYmUgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TdWJzY3JpcHRpb24oY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZXNwb25zZSBub3RpZmljYXRpb25zIG9mIHRoZSBjcmVhdGUncwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlYWQgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVhZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZWFkKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVhZEhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBwYXJlbnQgU3luY2hlciAtPiBfb25Gb3J3YXJkCgogIH0sIHsKICAgIGtleTogJ19vbkZvcndhcmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLVJDVjogJywgbXNnKTsKICAgICAgc3dpdGNoIChtc2cuYm9keS50eXBlKSB7CiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblN1YnNjcmliZShtc2cpO2JyZWFrOwogICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGlzIC0+IF9vbkZvcndhcmQ6IGVtaXR0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBzdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uU3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdWJzY3JpYmUobXNnKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwogICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RSZXBvcnRlci5fb25TdWJzY3JpYmVdJywgbXNnKTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIC8vY3JlYXRlIG5ldyBzdWJzY3JpcHRpb24KICAgICAgICAgIHZhciBzdWIgPSB7IHVybDogaHlwZXJ0eVVybCwgc3RhdHVzOiAnb24nIH07CiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjsKCiAgICAgICAgICAvL3Byb2Nlc3MgYW5kIHNlbmQgY2hpbGRyZW5zIGRhdGEKICAgICAgICAgIHZhciBjaGlsZHJlblZhbHVlcyA9IHt9OwogICAgICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CiAgICAgICAgICAgIHZhciBjaGlsZERhdGEgPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLmRhdGE7CiAgICAgICAgICAgIGNoaWxkcmVuVmFsdWVzW2NoaWxkSWRdID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGNoaWxkRGF0YSk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgc2VuZE1zZyA9IHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoX3RoaXMuZGF0YSksIGNoaWxkcmVuczogY2hpbGRyZW5WYWx1ZXMgfSB9CiAgICAgICAgICB9OwoKICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsQXV0aGVudGljYXRpb24nKSAmJiAhbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24pIHsKICAgICAgICAgICAgc2VuZE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbjsKICAgICAgICAgICAgX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBvayByZXNwb25zZSBtZXNzYWdlCiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHNlbmRNc2cpOwoKICAgICAgICAgIHJldHVybiBzdWI7CiAgICAgICAgfSwKCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7CiAgICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdTVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoaXMgLT4gX29uRm9yd2FyZDogZW1pdHRlZCBieSBhIHJlbW90ZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgLT4gdW5zdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uVW5TdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblVuU3Vic2NyaWJlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgaHlwZXJ0eVVybCA9IG1zZy5ib2R5LmZyb207CgogICAgICB2YXIgc3ViID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CiAgICAgIGRlbGV0ZSBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKICAgICAgICBvYmplY3Q6IHN1YgogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBSZXBvcnRlclVSTCBhZGRyZXNzOiBlbWl0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBfb25SZW1vdGVDcmVhdGUgLT4gZXZlbnQuYWNrCgogIH0sIHsKICAgIGtleTogJ19vblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZXNwb25zZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICB1cmw6IG1zZy5mcm9tLAogICAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGUKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVTUE9OU0UtRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gcmVhZAoKICB9LCB7CiAgICBrZXk6ICdfb25SZWFkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWFkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmZyb20sCgogICAgICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgdmFsdWU6ICgwLCBfdXRpbHMuZGVlcENsb25lKShfdGhpcy5kYXRhKSB9CiAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDEsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uUmVhZEhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVBRC1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblJlYWRIYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3N1YnNjcmlwdGlvbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdFJlcG9ydGVyOwp9KF9EYXRhT2JqZWN0My5kZWZhdWx0IC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0UmVwb3J0ZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEyMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9wcm9taXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7Cgp2YXIgX3Byb21pc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvbWlzZSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX1Byb3h5T2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKdmFyIF9Qcm94eU9iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Qcm94eU9iamVjdCk7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCnZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7Cgp2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBNYWluIGV4dGVuc2lvbiBjbGFzcyBmb3Igb2JzZXJ2ZXJzIGFuZCByZXBvcnRlcnMsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIG1ldGhvZHMuCiAqIENoaWxkcmVuIG1hbmFnZW1lbnQgaXMgY29tbW9uIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycy4KICovCnZhciBEYXRhT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICBfdmVyc2lvbjogbnVtYmVyCiAgIF9vd25lcjogSHlwZXJ0eVVSTAogIF91cmw6IE9iamVjdFVSTAogIF9zY2hlbWE6IFNjaGVtYQogIF9idXM6IE1pbmlCdXMKICBfc3RhdHVzOiBvbiB8IHBhdXNlZAogIF9zeW5jT2JqOiBTeW5jRGF0YQogICBfY2hpbGRyZW46IHsgaWQ6IERhdGFPYmplY3RDaGlsZCB9CiAgX2NoaWxkcmVuTGlzdGVuZXJzOiBbTXNnTGlzdGVuZXJdCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25BZGRDaGlsZEhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogICovCgogIC8qKgogICAqIEBpZ25vcmUKICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlciBjcmVhdGUgb3Igc3Vic2NyaWJlIG1ldGhvZCdzCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdChzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgdmFyIG11dHVhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDogdHJ1ZTsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX3N5bmNoZXIgPSBzeW5jaGVyOwogICAgX3RoaXMuX3VybCA9IHVybDsKICAgIF90aGlzLl9zY2hlbWEgPSBzY2hlbWE7CiAgICBfdGhpcy5fc3RhdHVzID0gaW5pdGlhbFN0YXR1czsKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CiAgICBfdGhpcy5fY2hpbGRyZW5zID0gY2hpbGRyZW5zOwoKICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgIF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbDsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IDA7CiAgICBfdGhpcy5fY2hpbGRJZCA9IDA7CiAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzID0ge307CiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTsKCiAgICBfdGhpcy5fb3duZXIgPSBzeW5jaGVyLl9vd25lcjsKICAgIF90aGlzLl9idXMgPSBzeW5jaGVyLl9idXM7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0LCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBjaGlsZEJhc2VVUkwgPSBfdGhpcy5fdXJsICsgJy9jaGlsZHJlbi8nOwogICAgICBjb25zb2xlLmxvZygnW0RhdGEgT2JqZWN0IC0gQWxsb2NhdGVMaXN0ZW5lcnNdIC0gJywgX3RoaXMuX2NoaWxkcmVucyk7CiAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW5zKSB7CiAgICAgICAgX3RoaXMuX2NoaWxkcmVucy5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkgewogICAgICAgICAgdmFyIGNoaWxkVVJMID0gY2hpbGRCYXNlVVJMICsgY2hpbGQ7CiAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgICAgICAgaWYgKG1zZy5mcm9tICE9PSBfdGhpczIuX293bmVyKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3QtQ2hpbGRyZW4tUkNWOiAnLCBtc2cpOwogICAgICAgICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6CiAgICAgICAgICAgICAgICAgIF90aGlzLl9vbkNoaWxkQ3JlYXRlKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOgogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO2JyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgX3RoaXMuX2NoYW5nZUNoaWxkcmVuKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHsKICAgICAgICBsaXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfSk7CgogICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNba2V5XS5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBVUkwgb2YgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIKICAgICAqIEB0eXBlIHtPYmplY3RVUkx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncGF1c2UnLAoKCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkgewogICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CiAgICB9CgogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncmVzdW1lJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7CiAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdG9wJywKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICAvL1RPRE86IHNob3VsZCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBhbmQgc2VuZCBtZXNzYWdlIHVuc3Vic2NyaWJlPwogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgYWRkIGEgRGF0YU9iamVjdENoaWxkIHRvIGEgY2hpbGRyZW4gY29sbGVjdGlvbi4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGlsZHJlbiAtIENoaWxkcmVuIG5hbWUgd2hlcmUgdGhlIGNoaWxkIGlzIGFkZGVkLgogICAgICogQHBhcmFtIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgY2hpbGQKICAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdENoaWxkPn0gLSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBEYXRhT2JqZWN0Q2hpbGQuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnYWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENoaWxkKGNoaWxkcmVuLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9jcmVhdGUgbmV3IGNoaWxkIHVuaXF1ZSBJRCwgYmFzZWQgb24gaHlwZXJ0eVVSTAogICAgICBfdGhpcy5fY2hpbGRJZCsrOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IF90aGlzLl9vd25lciArICcjJyArIF90aGlzLl9jaGlsZElkOwogICAgICB2YXIgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJyArIGNoaWxkcmVuOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoaWxkIGFkZHJlc3M6IE1lc3NhZ2VCdXMKICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IG1zZ0NoaWxkUGF0aCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBtc2dDaGlsZElkLCB2YWx1ZTogaW5pdGlhbERhdGEgfQogICAgICB9OwoKICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgcmVxdWVzdE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uOwoKICAgICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbAogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgdmFyIG1zZ0lkID0gX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXF1ZXN0TXNnKTsKCiAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZS1yZXBvcnRlci1jaGlsZCggJyArIF90aGlzLl9vd25lciArICcgKTogJywgcmVxdWVzdE1zZyk7CiAgICAgICAgdmFyIG5ld0NoaWxkID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIG1zZ0NoaWxkSWQsIGluaXRpYWxEYXRhLCBfdGhpcy5fb3duZXIsIG1zZ0lkKTsKICAgICAgICBuZXdDaGlsZC5vbkNoYW5nZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCwgeyBwYXRoOiBtc2dDaGlsZFBhdGgsIGNoaWxkSWQ6IG1zZ0NoaWxkSWQgfSk7CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgICAgcmVzb2x2ZShuZXdDaGlsZCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgY3JlYXRlIGFuZCBkZWxldGUgb2YgY2hpbGRyZW5zLgogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uQWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQWRkQ2hpbGQoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IGFkZENoaWxkCgogIH0sIHsKICAgIGtleTogJ19vbkNoaWxkQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGlsZENyZWF0ZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIG1zZ0NoaWxkSWQgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUtb2JzZXJ2ZXItY2hpbGQoICcgKyBfdGhpcy5fb3duZXIgKyAnICk6ICcsIG1zZyk7CiAgICAgIHZhciBuZXdDaGlsZCA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBtc2dDaGlsZElkLCBtc2cuYm9keS52YWx1ZSk7CiAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIC8vRkxPVy1PVVQ6IHdpbGwgZmxvdyB0byBEYXRhT2JqZWN0Q2hpbGQgLT4gX29uUmVzcG9uc2UKICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHNvdXJjZTogX3RoaXMuX293bmVyIH0KICAgICAgICB9KTsKICAgICAgfSk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmZyb20sCiAgICAgICAgdXJsOiBtc2cudG8sCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGNoaWxkSWQ6IG1zZ0NoaWxkSWQsCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ0FERC1DSElMRFJFTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL3NlbmQgZGVsdGEgbWVzc2FnZXMgdG8gc3Vic2NyaXB0aW9ucwoKICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoYW5nZShldmVudCwgY2hpbGRJbmZvKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fdmVyc2lvbisrOwoKICAgICAgaWYgKF90aGlzLl9zdGF0dXMgPT09ICdvbicpIHsKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIGEgcmVzb3VyY2UgY2hhbmdlcyBhZGRyZXNzOiBNZXNzYWdlQnVzCiAgICAgICAgdmFyIGNoYW5nZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogX3RoaXMuX3VybCArICcvY2hhbmdlcycsCiAgICAgICAgICBib2R5OiB7IHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCBzb3VyY2U6IF90aGlzLl9vd25lciwgYXR0cmlidXRlOiBldmVudC5maWVsZCB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0IC0gX29uQ2hhbmdlXSAtICcsIGV2ZW50LCBjaGlsZEluZm8sIGNoYW5nZU1zZyk7CgogICAgICAgIGlmIChldmVudC5vVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuT0JKRUNUKSB7CiAgICAgICAgICBpZiAoZXZlbnQuY1R5cGUgIT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPSBldmVudC5vVHlwZTsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKICAgICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuVVBEQVRFKSB7CiAgICAgICAgICAgIGNoYW5nZU1zZy5ib2R5Lm9wZXJhdGlvbiA9IGV2ZW50LmNUeXBlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy9jaGlsZEluZm8gbXVzdCBoYXZlIChwYXRoLCBjaGlsZElkKQogICAgICAgIGlmIChjaGlsZEluZm8pIHsKICAgICAgICAgIGNoYW5nZU1zZy50byA9IGNoaWxkSW5mby5wYXRoOwogICAgICAgICAgY2hhbmdlTXNnLmJvZHkucmVzb3VyY2UgPSBjaGlsZEluZm8uY2hpbGRJZDsKICAgICAgICB9CgogICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgY2hhbmdlTXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoY2hhbmdlTXNnKTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogZGVsdGEgbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RSZXBvcnRlciBvciBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VPYmplY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VPYmplY3Qoc3luY09iaiwgbXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL1RPRE86IHVwZGF0ZSB2ZXJzaW9uID8KICAgICAgLy9ob3cgdG8gaGFuZGxlIGFuIGluY29ycmVjdCB2ZXJzaW9uID8gRXhhbXBsZTogcmVjZWl2ZSBhIHZlcnNpb24gMyB3aGVuIHRoZSBvYnNlcnZlciBpcyBpbiB2ZXJzaW9uIDEsIHdoZXJlIGlzIHRoZSB2ZXJzaW9uIDIgPwogICAgICAvL3dpbGwgd2UgbmVlZCB0byBjb25maXJtIHRoZSByZWNlcHRpb24gPwogICAgICBpZiAoX3RoaXMuX3ZlcnNpb24gKyAxID09PSBtc2cuYm9keS52ZXJzaW9uKSB7CiAgICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKICAgICAgICB2YXIgcGF0aCA9IG1zZy5ib2R5LmF0dHJpYnV0ZTsKICAgICAgICB2YXIgdmFsdWUgPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkobXNnLmJvZHkudmFsdWUpOwogICAgICAgIHZhciBmaW5kUmVzdWx0ID0gc3luY09iai5maW5kQmVmb3JlKHBhdGgpOwoKICAgICAgICBpZiAobXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuQVJSQVkpIHsKICAgICAgICAgIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLkFERCkgewogICAgICAgICAgICB2YXIgYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBpbmRleCA9IGZpbmRSZXN1bHQubGFzdDsKICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShhcnIsIFtpbmRleCwgMF0uY29uY2F0KHZhbHVlKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CiAgICAgICAgICAgIHZhciBfYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBfaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIF9hcnIuc3BsaWNlKF9pbmRleCwgdmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XSA9IHZhbHVlOyAvLyBVUERBVEUKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKG1zZy5ib2R5LnZhbHVlKSB7CiAgICAgICAgICAgIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF0gPSB2YWx1ZTsgLy8gVVBEQVRFIG9yIEFERAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVsZXRlIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF07IC8vIFJFTU9WRQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvL1RPRE86IGhvdyB0byBoYW5kbGUgdW5zeW5jaHJvbml6ZWQgdmVyc2lvbnM/CiAgICAgICAgY29uc29sZS5sb2coJ1VOU1lOQ0hST05JWkVEIFZFUlNJT046IChkYXRhID0+ICcgKyBfdGhpcy5fdmVyc2lvbiArICcsIG1zZyA9PiAnICsgbXNnLmJvZHkudmVyc2lvbiArICcpJyk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VDaGlsZHJlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NoYW5nZUNoaWxkcmVuKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBjb25zb2xlLmxvZygnQ2hhbmdlIGNoaWxkcmVuOiAnLCBfdGhpcy5fb3duZXIsIG1zZyk7CgogICAgICB2YXIgY2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlOwogICAgICB2YXIgY2hpbGRyZW4gPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdOwoKICAgICAgaWYgKGNoaWxkcmVuKSB7CiAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChjaGlsZHJlbi5fc3luY09iaiwgbXNnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygnTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAnLCBjaGlsZElkKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3VybCcsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3VybDsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBzY2hlbWEgVVJMICh0aGlzIGZpZWxkIGlzIG5vdCB5ZXQgc3RhYmxlLCBhbmQgaXMgc3Vic2plY3QgdG8gY2hhbmdlKQogICAgICogQHR5cGUge1NjaGVtYVVSTH0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzY2hlbWEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zY2hlbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdGF0dXMgb2YgdGhlIHJlcG9ydGVyIG9yIG9ic2VydmVyIGNvbm5lY3Rpb24gKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpCiAgICAgKiBAdHlwZSB7U3RhdHVzfSAtIEVudW0gb2Y6IG9uIHwgcGF1c2VkCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnc3RhdHVzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3RhdHVzOwogICAgfQoKICAgIC8qKgogICAgICogRGF0YSBzdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLgogICAgICogQHR5cGUge0pTT059IC0gSlNPTiBzdHJ1Y3R1cmUgdGhhdCBzaG91bGQgZm9sbG93IHRoZSBkZWZpbmVkIHNjaGVtYSwgaWYgYW55LgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RhdGEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGwgY3JlYXRlZCBjaGlsZHJlbidzIHNpbmNlIHRoZSBzdWJzY3JpcHRpb24sIGRvZXNuJ3QgY29udGFpbiBhbGwgY2hpbGRyZW4ncyBzaW5jZSByZXBvcnRlciBjcmVhdGlvbi4KICAgICAqIEB0eXBlIHtPYmplY3Q8Q2hpbGRJZCwgRGF0YU9iamVjdENoaWxkPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdjaGlsZHJlbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhT2JqZWN0Owp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTIxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIyKTsKCnZhciBfUHJveHlPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUHJveHlPYmplY3QpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgRGF0YU9iamVjdCBhZGRDaGlsZHJlbiBjYWxsIG9yIGZyb20gb25BZGRDaGlsZHJlbiBpZiByZW1vdGVseSBjcmVhdGVkLgogKiBDaGlsZHJlbiBvYmplY3Qgc3luY2hyb25pemF0aW9uIGlzIGEgYSBmYXN0IGZvcndhcmQgbWVjaGFuaXNtLCBubyBuZWVkIGZvciBkaXJlY3Qgc3Vic2NyaXB0aW9ucywgaXQgdXNlcyB0aGUgYWxyZWFkeSBhdXRob3JpemVkIHN1YnNjcmlwdGlvbiBmcm9tIHRoZSBwYXJlbnQgRGF0YU9iamVjdC4KICovCnZhciBEYXRhT2JqZWN0Q2hpbGQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBEYXRhT2JqZWN0LmFkZENoaWxkcmVuCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdENoaWxkKHBhcmVudCwgY2hpbGRJZCwgaW5pdGlhbERhdGEsIG93bmVyLCBtc2dJZCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdENoaWxkKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9wYXJlbnQgPSBwYXJlbnQ7CiAgICBfdGhpcy5fY2hpbGRJZCA9IGNoaWxkSWQ7CiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl9tc2dJZCA9IG1zZ0lkOwoKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CgogICAgX3RoaXMuX2J1cyA9IHBhcmVudC5fYnVzOwogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0Q2hpbGQsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vdGhpcyBpcyBvbmx5IG5lZWRlZCBmb3IgY2hpbGRyZW4gcmVwb3J0ZXJzCiAgICAgIGlmIChfdGhpcy5fb3duZXIpIHsKICAgICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl9vd25lciwgZnVuY3Rpb24gKG1zZykgewogICAgICAgICAgaWYgKG1zZy50eXBlID09PSAncmVzcG9uc2UnICYmIG1zZy5pZCA9PT0gX3RoaXMuX21zZ0lkKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZTonLCBtc2cpOwogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKF90aGlzLl9saXN0ZW5lcikgewogICAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgZGVsZXRlIF90aGlzLl9wYXJlbnQuX2NoaWxkcmVuW190aGlzLl9jaGlsZElkXTsKCiAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgogICAgICAvL1RPRE86IHNlbmQgZGVsZXRlIG1lc3NhZ2UgPwogICAgfQoKICAgIC8qKgogICAgICogQ2hpbGRyZW4gSUQgZ2VuZXJhdGVkIG9uIGFkZENoaWxkcmVuLiBVbmlxdWUgaWRlbnRpZmllcgogICAgICogQHR5cGUge1VSTH0gLSBVUkwgb2YgdGhlIGZvcm1hdCA8SHlwZXJ0eVVSTD4jPG51bWVyaWMtc2VxdWVuY2U+CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25DaGFuZ2UnLAoKCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyIGNoaWxkCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZShjYWxsYmFjaykgewogICAgICB0aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlc3BvbnNlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIGNyZWF0ZXMKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlc3BvbnNlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVzcG9uc2VIYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdCAtPiBfb25DaGlsZENyZWF0ZQoKICB9LCB7CiAgICBrZXk6ICdfb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVzcG9uc2UobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgdXJsOiBtc2cuYm9keS5zb3VyY2UsCiAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdjaGlsZElkJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKICAgIH0KCiAgICAvKioKICAgICAqIERhdGEgU3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC4KICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdENoaWxkOwp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdENoaWxkOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5PYmplY3RUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0gdW5kZWZpbmVkOwoKdmFyIF9zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCnZhciBfc3RyaW5naWZ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmeSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKX193ZWJwYWNrX3JlcXVpcmVfXygxNTMpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBvYmplY3RUeXBlID0geyBBUlJBWTogJ1tvYmplY3QgQXJyYXldJywgT0JKRUNUOiAnW29iamVjdCBPYmplY3RdJyB9OwoKLyoqCiAqIEBhY2Nlc3MgcHJpdmF0ZQogKiBNYWluIGNsYXNzIHRoYXQgbWFpbnRhaW5zIGEgSlNPTiBvYmplY3QsIGFuZCBvYnNlcnZlcyBjaGFuZ2VzIGluIHRoaXMgb2JqZWN0LCByZWN1cnNpdmVseS4KICogSW50ZXJuYWwgb2JqZWN0cyBhbmQgYXJyYXlzIGFyZSBhbHNvIG9ic2VydmVkLgogKi8KCnZhciBTeW5jT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFN5bmNPYmplY3QoaW5pdGlhbERhdGEpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFN5bmNPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX29ic2VydmVycyA9IFtdOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICB0aGlzLl9kYXRhID0gaW5pdGlhbERhdGEgfHwge307CgogICAgdGhpcy5faW50ZXJuYWxPYnNlcnZlKHRoaXMuX2RhdGEpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoU3luY09iamVjdCwgW3sKICAgIGtleTogJ29ic2VydmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnB1c2goY2FsbGJhY2spOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmQocGF0aCkgewogICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCiAgICAgIHJldHVybiB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmRCZWZvcmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRCZWZvcmUocGF0aCkgewogICAgICB2YXIgcmVzdWx0ID0ge307CiAgICAgIHZhciBsaXN0ID0gcGF0aC5zcGxpdCgnLicpOwogICAgICByZXN1bHQubGFzdCA9IGxpc3QucG9wKCk7CiAgICAgIHJlc3VsdC5vYmogPSB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmluZFdpdGhTcGxpdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbmRXaXRoU3BsaXQobGlzdCkgewogICAgICB2YXIgb2JqID0gdGhpcy5fZGF0YTsKICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIG9iaiA9IG9ialt2YWx1ZV07CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIG9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfaXNPYnNlcnZhYmxlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNPYnNlcnZhYmxlKG9iaikgewogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBPYmplY3QgfHwgb2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2ludGVybmFsT2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsT2JzZXJ2ZShvYmplY3QpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoY2hhbmdlc2V0KSB7CgogICAgICAgIGNoYW5nZXNldC5ldmVyeShmdW5jdGlvbiAoY2hhbmdlKSB7CiAgICAgICAgICBfdGhpczIuX29uQ2hhbmdlcyhjaGFuZ2UpOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgdGhpcy5fZGF0YSA9IE9iamVjdC5kZWVwT2JzZXJ2ZShvYmplY3QsIGhhbmRsZXIpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19maXJlRXZlbnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maXJlRXZlbnQoZXZlbnQpIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2VzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2VzKGNoYW5nZSkgewoKICAgICAgdmFyIG9iaiA9IGNoYW5nZS5vYmplY3Q7CiAgICAgIHZhciBvYmpUeXBlID0gdm9pZCAwOwoKICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuT0JKRUNUOwogICAgICB9CgogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIG9ialR5cGUgPSBPYmplY3RUeXBlLkFSUkFZOwogICAgICB9CgogICAgICB2YXIgZmllbGRTdHJpbmcgPSBjaGFuZ2Uua2V5cGF0aDsKCiAgICAgIC8vIGNvbnNvbGUubG9nKCdGaWVsZDonLCBmaWVsZFN0cmluZyk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCd0eXBlOicsIGNoYW5nZS50eXBlKTsKCiAgICAgIC8vbGV0IG9sZFZhbHVlID0gY2hhbmdlLm9sZFZhbHVlOwogICAgICB2YXIgbmV3VmFsdWUgPSBvYmpbY2hhbmdlLm5hbWVdOwoKICAgICAgY29uc29sZS5pbmZvKGNoYW5nZS50eXBlICsgJyB8IEZpZWxkOiAnICsgZmllbGRTdHJpbmcgKyAnIHwgTmV3IFZhbHVlOicsICgwLCBfc3RyaW5naWZ5Mi5kZWZhdWx0KShuZXdWYWx1ZSkpOwoKICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAndXBkYXRlJykgewogICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5VUERBVEUsCiAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZywKICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2FkZCcpIHsKICAgICAgICB0aGlzLl9maXJlRXZlbnQoewogICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuQURELAogICAgICAgICAgb1R5cGU6IG9ialR5cGUsCiAgICAgICAgICBmaWVsZDogZmllbGRTdHJpbmcsCiAgICAgICAgICBkYXRhOiBuZXdWYWx1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdkZWxldGUnKSB7CiAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLlJFTU9WRSwKICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fZGF0YTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFN5bmNPYmplY3Q7Cn0oKTsKCnZhciBDaGFuZ2VUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0geyBVUERBVEU6ICd1cGRhdGUnLCBBREQ6ICdhZGQnLCBSRU1PVkU6ICdyZW1vdmUnIH07CnZhciBPYmplY3RUeXBlID0gZXhwb3J0cy5PYmplY3RUeXBlID0geyBPQkpFQ1Q6ICdvYmplY3QnLCBBUlJBWTogJ2FycmF5JyB9OwpleHBvcnRzLmRlZmF1bHQgPSBTeW5jT2JqZWN0OwoKLyoqKi8gfSksCi8qIDEyMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzOCk7Cgp2YXIgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgewogIGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsKICB2YXIgZGVzYyA9ICgwLCBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMi5kZWZhdWx0KShvYmplY3QsIHByb3BlcnR5KTsKCiAgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgewogICAgdmFyIHBhcmVudCA9ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKG9iamVjdCk7CgogICAgaWYgKHBhcmVudCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7CiAgICB9CiAgfSBlbHNlIGlmICgidmFsdWUiIGluIGRlc2MpIHsKICAgIHJldHVybiBkZXNjLnZhbHVlOwogIH0gZWxzZSB7CiAgICB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7CgogICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsKICB9Cn07CgovKioqLyB9KSwKLyogMTI0ICovLAovKiAxMjUgKi8sCi8qIDEyNiAqLywKLyogMTI3ICovLAovKiAxMjggKi8sCi8qIDEyOSAqLywKLyogMTMwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX3Byb21pc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCnZhciBfYXNzaWduID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzYpOwoKdmFyIF9hc3NpZ24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXNzaWduKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE5KTsKCnZhciBfRGF0YU9iamVjdFJlcG9ydGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RSZXBvcnRlcik7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE4KTsKCnZhciBfRGF0YU9iamVjdE9ic2VydmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RPYnNlcnZlcik7Cgp2YXIgX0RhdGFQcm92aXNpb25hbCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMzKTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFQcm92aXNpb25hbCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogVGhlIG1haW4gY2xhc3MgZm9yIHRoZSBzeW5jaGVyIHBhY2thZ2UuCiogVGhlIFN5bmNoZXIgaXMgYSBzaW5nbGV0b24gY2xhc3MgcGVyIEh5cGVydHkvVVJMIGFuZCBpdCBpcyB0aGUgb3duZXIgb2YgYWxsIGNyZWF0ZWQgRGF0YSBTeW5jIE9iamVjdHMgYWNjb3JkaW5nIHRvIHRoZSBSZXBvcnRlciAtIE9ic2VydmVyIHBhdHRlcm4uCiogTWFpbiBmdW5jdGlvbmFsaXR5IGlzIHRvIGNyZWF0ZSByZXBvcnRlcnMgYW5kIHRvIHN1YnNjcmliZSB0byBleGlzdGluZyBvbmVzLgoqLwp2YXIgU3luY2hlciA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgX293bmVyOiBVUkwKICBfYnVzOiBNaW5pQnVzCiAgIF9zdWJVUkw6IFVSTAogICBfcmVwb3J0ZXJzOiA8dXJsOiBEYXRhT2JqZWN0UmVwb3J0ZXI+CiAgX29ic2VydmVyczogPHVybDogRGF0YU9iamVjdE9ic2VydmVyPgogIF9wcm92aXNpb25hbHM6IDx1cmw6IERhdGFQcm92aXNpb25hbD4KICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vbk5vdGlmaWNhdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlc3VtZTogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgKiBDb25zdHJ1Y3RvciB0aGF0IHNob3VsZCBiZSB1c2VkIGJ5IHRoZSBIeXBlcnR5IG93bmVyCiAgKiBAcGFyYW0ge0h5cGVydHlVUkx9IG93bmVyIC0gSHlwZXJ0eSBVUkwgb3duZXIuIEFuIFVSTCBhbGxvY2F0ZWQgYnkgdGhlIHJ1bnRpbWUgdGhhdCB1bmlxdWVseSBpZGVudGlmaWVzIHRoZSBIeXBlcnR5LgogICogQHBhcmFtIHtNaW5pQnVzfSBidXMgLSBBbiBpbnN0YW5jZSBvZiB0aGUgTWluaUJ1cyBwcm92aWRlZCBpbiB0aGUgc2FuZGJveC4gV2hlbiBhbiBvYmplY3QgKFJlcG9ydGVyIG9yIE9ic2VydmVkKSBpcyBjcmVhdGVkLCB0aGUgU3luY2hlck1hbmFnZXIgd2lsbCBhZGQgYSBsaXN0ZW5lciBpbiB0aGUgTWluaUJ1cyB0byByZWNlaXZlL3NlbmQgTWVzc2FnZXMgb2YgdGhhdCBvYmplY3QuCiAgKiBAcGFyYW0ge0pTT059IGNvbmZpZyAtIENvbmZpZ3VyYXRpb24gZGF0YS4gVGhlIG9ubHkgcmVxdWlyZWQgZmllbGQgZm9yIG5vdyBpcyB0aGUgcnVudGltZVVSTC4KICAqLwogIGZ1bmN0aW9uIFN5bmNoZXIob3duZXIsIGJ1cywgY29uZmlnKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBTeW5jaGVyKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX2J1cyA9IGJ1czsKCiAgICBfdGhpcy5fc3ViVVJMID0gY29uZmlnLnJ1bnRpbWVVUkwgKyAnL3NtJzsKCiAgICBfdGhpcy5fcmVwb3J0ZXJzID0ge307CiAgICBfdGhpcy5fb2JzZXJ2ZXJzID0ge307CiAgICBfdGhpcy5fcHJvdmlzaW9uYWxzID0ge307CgogICAgYnVzLmFkZExpc3RlbmVyKG93bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikgewogICAgICAgIGNvbnNvbGUuaW5mbygnW1N5bmNoZXJdIFN5bmNoZXItUkNWOiAnLCBtc2cpOwogICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgIGNhc2UgJ2ZvcndhcmQnOgogICAgICAgICAgICBfdGhpcy5fb25Gb3J3YXJkKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdjcmVhdGUnOgogICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVDcmVhdGUobXNnKTticmVhazsKICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAgIF90aGlzLl9vblJlbW90ZURlbGV0ZShtc2cpO2JyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQoKICAvKioKICAqIFRoZSBvd25lciBvZiB0aGUgU3luY2hlciBhbmQgYWxsIGNyZWF0ZWQgcmVwb3J0ZXJzLgogICogQHR5cGUge0h5cGVydHlVUkx9CiAgKi8KCgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKFN5bmNoZXIsIFt7CiAgICBrZXk6ICdjcmVhdGUnLAoKCiAgICAvKioKICAgICogUmVxdWVzdCBhIERhdGFPYmplY3RSZXBvcnRlciBjcmVhdGlvbi4gVGhlIFVSTCB3aWxsIGJlIGJlIHJlcXVlc3RlZCBieSB0aGUgYWxsb2NhdGlvbiBtZWNoYW5pc20uCiAgICAqIEBwYXJhbSAge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hCiAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIC0gTGlzdCBvZiBoeXBlcnRpZXMgdGhhdCBhcmUgcHJlLWF1dGhvcml6ZWQgZm9yIHN1YnNjcmlwdGlvbgogICAgKiBAcGFyYW0gIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICogQHBhcmFtICB7c3RyaW5nfSBvYmplY3RVUkwgLSByZXVzYWJsZSBkYXRhT2JqZWN0IFVSTAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IFJlcG9ydGVyLiBUaGUgcmVwb3J0ZXIgY2FuIGJlIGFjY2VwdGVkIG9yIHJlamVjdGVkIGJ5IHRoZSBQRVAKICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKHNjaGVtYSwgb2JzZXJ2ZXJzLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgc3RvcmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgcDJwID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiBmYWxzZTsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBjcml0ZXJpYSA9IHt9OwoKICAgICAgY3JpdGVyaWEucDJwID0gcDJwOwogICAgICBjcml0ZXJpYS5zdG9yZSA9IHN0b3JlOwogICAgICBjcml0ZXJpYS5zY2hlbWEgPSBzY2hlbWE7CiAgICAgIGNyaXRlcmlhLm9ic2VydmVycyA9IG9ic2VydmVyczsKICAgICAgY3JpdGVyaWEuaW5pdGlhbERhdGEgPSBpbml0aWFsRGF0YTsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUgUmVwb3J0ZXIgLSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogZmFsc2UgfSk7CgogICAgICByZXR1cm4gX3RoaXMuX2NyZWF0ZShjcml0ZXJpYSk7CiAgICB9CiAgfSwgewogICAga2V5OiAncmVzdW1lUmVwb3J0ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVSZXBvcnRlcnMoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBSZXBvcnRlciAtIGNyaXRlcmlhOiAnLCBjcml0ZXJpYSk7CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiB0cnVlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9jcmVhdGUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtTY2hlbWFVUkx9IHNjaGVtYSAtIEh5cGVydHkgQ2F0YWxvZ3VlIFVSTCBhZGRyZXNzIHRoYXQgY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIEpTT04tU2NoZW1hIGRlc2NyaWJpbmcgdGhlIERhdGEgT2JqZWN0IHNjaGVtYQogICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gQWRkcmVzcyBvZiB0aGUgZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIG9ic2VydmVkCiAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3N0b3JlPWZhbHNlXSAtIFNhdmUgdGhlIHN1YnNjcmlwdGlvbiBvbiB0aGUgU3luY2hlciBNYW5hZ2VyIGZvciBmdXJ0aGVyIHJlc3VtZSAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbcDJwPWZhbHNlXSAtIEluZm8gYWJvdXQgaWYgc2hvdWxkIHVzZSBwMnAgY29ubmVjdGlvbiAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbbXV0dWFsPXRydWVdIC0gSW5mbyBhYm91dCBpZiBtZXNzYWdlcyBvZiB0aGlzIG9iamVjdCBzaG91bGQgYmUgZW5jcnlwdGVkIChEZWZhdWx0IGlzIHRydWUpCiAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdE9ic2VydmVyPn0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgb2JzZXJ2ZXIuIEl0J3MgYXNzb2NpYXRlZCB3aXRoIHRoZSByZXBvcnRlci4KICAgICovCgogIH0sIHsKICAgIGtleTogJ3N1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3Vic2NyaWJlKHNjaGVtYSwgb2JqVVJMKSB7CiAgICAgIHZhciBzdG9yZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgIHZhciBwMnAgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgbXV0dWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB0cnVlOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGNyaXRlcmlhID0ge307CgogICAgICBjcml0ZXJpYS5wMnAgPSBwMnA7CiAgICAgIGNyaXRlcmlhLnN0b3JlID0gc3RvcmU7CiAgICAgIGNyaXRlcmlhLnNjaGVtYSA9IHNjaGVtYTsKICAgICAgY3JpdGVyaWEucmVzb3VyY2UgPSBvYmpVUkw7CgogICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgIGNyaXRlcmlhLm11dHVhbCA9IG11dHVhbDsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIHN1YnNjcmliZV0gLSBzdWJzY3JpYmUgY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCiAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShjcml0ZXJpYSwgeyByZXN1bWU6IGZhbHNlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9zdWJzY3JpYmUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtjcml0ZXJpYX0gY3JpdGVyaWEgLSBJbmZvcm1hdGlvbiB0byBkaXNjb3ZlcnkgdGhlIG9ic2VydmVyIG9iamVjdAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXN1bWVPYnNlcnZlcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZU9ic2VydmVycyhjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgX2NyaXRlcmlhID0gY3JpdGVyaWEgfHwge307CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoX2NyaXRlcmlhLCB7IHJlc3VtZTogdHJ1ZSB9KTsKCiAgICAgIHJldHVybiBfdGhpcy5fc3Vic2NyaWJlKF9jcml0ZXJpYSk7CiAgICB9CgogICAgLyoqCiAgICAqIFJlcXVlc3QgYSByZWFkIGFjdGlvbiBvbiB0aGUgcmVwb3J0ZXIgb2JqZWN0CiAgICAqIEBwYXJhbSB7T2JqZWN0VVJMfSBvYmpVUkwgLSBVUkwgb2YgdGhlIHJlcG9ydGVyIG9iamVjdCB0byBiZSByZWFkCiAgICAqIEByZXR1cm4ge1Byb21pc2U8T2JqZWN0Pn0gUmV0dXJuIFByb21pc2UgdG8gbGFzdCBhdmFpbGFibGUgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICovCgogIH0sIHsKICAgIGtleTogJ3JlYWQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWQob2JqVVJMKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIHJlcG9ydGVyIG9iamVjdCAobWF5YmUgdGhlcmUgaXMgbm8gbGlzdGVuZXIgYXZhaWxhYmxlLCBzbyBpdCB3aWxsIGJlIHJlc29sdmVkIHdpdGggTWVzc2FnZUJ1cyAtPiByZXNvbHZlKQogICAgICAvL3dpbGwgcmVhY2ggdGhlIHJlbW90ZSBvYmplY3QgaW4gRGF0YU9iamVjdFJlcG9ydGVyIC0+IF9vblJlYWQKICAgICAgdmFyIHJlYWRNc2cgPSB7CiAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBvYmpVUkwKICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVhZE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygncmVhZC1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIGV2ZW50cyBvZiByZW1vdmUgUmVwb3J0ZXIgb2JqZWN0cy4KICAgICogVGhpcyBpcyByZWxlYXRlZCB0byB0aGUgbWVzc2FnZW5zIHNlbnQgYnkgY3JlYXRlIHRvIHRoZSBvYnNlcnZlcnMgSHlwZXJ0eSBhcnJheS4KICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgKi8KCiAgfSwgewogICAga2V5OiAnb25Ob3RpZmljYXRpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uTm90aWZpY2F0aW9uKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ19jcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciByZXN1bWUgPSBjcml0ZXJpYS5yZXN1bWU7CiAgICAgICAgdmFyIGluaXRpYWxEYXRhID0gY3JpdGVyaWEuaW5pdGlhbERhdGEgfHwge307CiAgICAgICAgdmFyIHNjaGVtYSA9IHZvaWQgMDsKCiAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKICAgICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keTogeyByZXN1bWU6IHJlc3VtZSB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXTogJywgY3JpdGVyaWEsIHJlcXVlc3RNc2cpOwoKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUgPSBpbml0aWFsRGF0YTsKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUucmVwb3J0ZXIgPSBfdGhpcy5fb3duZXI7CgogICAgICAgIGlmIChjcml0ZXJpYS5zY2hlbWEpIHsKICAgICAgICAgIHNjaGVtYSA9IGNyaXRlcmlhLnNjaGVtYTsKICAgICAgICAgIHJlcXVlc3RNc2cuYm9keS5zY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CiAgICAgICAgfQoKICAgICAgICBpZiAoY3JpdGVyaWEucDJwKSByZXF1ZXN0TXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgIGlmIChjcml0ZXJpYS5zdG9yZSkgcmVxdWVzdE1zZy5ib2R5LnN0b3JlID0gY3JpdGVyaWEuc3RvcmU7CiAgICAgICAgaWYgKGNyaXRlcmlhLm9ic2VydmVycykgcmVxdWVzdE1zZy5ib2R5LmF1dGhvcmlzZSA9IGNyaXRlcmlhLm9ic2VydmVyczsKCiAgICAgICAgaWYgKHJlc3VtZSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9CgogICAgICAgIC8vcmVxdWVzdCBjcmVhdGUgdG8gdGhlIGFsbG9jYXRpb24gc3lzdGVtLiBDYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIFBvbGljeUVuZ2luZS4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gYWNjZXB0ZWQKICAgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgICBpZiAocmVzdW1lKSB7CiAgICAgICAgICAgICAgc2NoZW1hID0gcmVwbHkuYm9keS5zY2hlbWE7CiAgICAgICAgICAgICAgaW5pdGlhbERhdGEgPSByZXBseS5ib2R5LnZhbHVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgc2NoZW1hLCAnb24nLCBpbml0aWFsRGF0YSwgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CiAgICAgICAgICAgIF90aGlzLl9yZXBvcnRlcnNbb2JqVVJMXSA9IG5ld09iajsKCiAgICAgICAgICAgIHJlc29sdmUobmV3T2JqKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gcmVqZWN0ZWQKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zdWJzY3JpYmUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsU3Vic2NyaWJlCiAgICAgICAgdmFyIHN1YnNjcmliZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keToge30KICAgICAgICB9OwoKICAgICAgICAvLyBIeXBlcnR5IHJlcXVlc3QgdG8gYmUgYW4gT2JzZXJ2ZXIKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNoeXBlcnR5LXJlcXVlc3QtdG8tYmUtYW4tb2JzZXJ2ZXIKCiAgICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIHRoZSBzYW1lIEh5cGVydHkgVVJMCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLXRoZS1zYW1lLWh5cGVydHktdXJsCgogICAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciBhIGNlcnRhaW4gdXNlciBhbmQgZGF0YSBzY2hlbWEgaW5kZXBlbmRlbnRseSBvZiB0aGUgSHlwZXJ0eSBVUkwuCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLWEtY2VydGFpbi11c2VyLWFuZC1kYXRhLXNjaGVtYS1pbmRlcGVuZGVudGx5LW9mLXRoZS1oeXBlcnR5LXVybAogICAgICAgIGlmIChjcml0ZXJpYSkgewogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdwMnAnKSkgc3Vic2NyaWJlTXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzdG9yZScpKSBzdWJzY3JpYmVNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzY2hlbWEnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdpZGVudGl0eScpKSBzdWJzY3JpYmVNc2cuYm9keS5pZGVudGl0eSA9IGNyaXRlcmlhLmlkZW50aXR5OwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZScpKSBzdWJzY3JpYmVNc2cuYm9keS5yZXNvdXJjZSA9IGNyaXRlcmlhLnJlc291cmNlOwogICAgICAgIH0KCiAgICAgICAgc3Vic2NyaWJlTXNnLmJvZHkucmVzdW1lID0gY3JpdGVyaWEucmVzdW1lOwoKICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgdmFyIG11dHVhbEF1dGhlbnRpY2F0aW9uID0gY3JpdGVyaWEubXV0dWFsOwogICAgICAgIGlmICghbXV0dWFsQXV0aGVudGljYXRpb24pIHN1YnNjcmliZU1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUgbWVzc2FnZTogJywgY3JpdGVyaWEsIHN1YnNjcmliZU1zZyk7CgogICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KICAgICAgICAvL1Byb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICAgICAgICAvL2ZvciBtb3JlIGluZm8gc2VlIHRoZSBEYXRhUHJvdmlzaW9uYWwgY2xhc3MgZG9jdW1lbnRhdGlvbi4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gc3Vic2NyaWJlLXJlc3BvbnNlOiAnLCByZXBseSk7CgogICAgICAgICAgdmFyIHNjaGVtYSA9IHJlcGx5LmJvZHkuc2NoZW1hOwogICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgdmFyIG5ld1Byb3Zpc2lvbmFsID0gX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKICAgICAgICAgIGlmIChuZXdQcm92aXNpb25hbCkgbmV3UHJvdmlzaW9uYWwuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlIDwgMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YVByb3Zpc2lvbmFsOiAnLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzLCBvYmpVUkwpOwogICAgICAgICAgICBuZXdQcm92aXNpb25hbCA9IG5ldyBfRGF0YVByb3Zpc2lvbmFsMi5kZWZhdWx0KF90aGlzLl9vd25lciwgb2JqVVJMLCBfdGhpcy5fYnVzLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKICAgICAgICAgICAgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdID0gbmV3UHJvdmlzaW9uYWw7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YSBPYmplY3QgT2JzZXJ2ZXI6ICcsIHJlcGx5LCBfdGhpcy5fcHJvdmlzaW9uYWxzKTsKCiAgICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgICAgdmFyIG5ld09iaiA9IG5ldyBfRGF0YU9iamVjdE9ic2VydmVyMi5kZWZhdWx0KF90aGlzLCBvYmpVUkwsIHNjaGVtYSwgJ29uJywgcmVwbHkuYm9keS52YWx1ZSwgbmV3UHJvdmlzaW9uYWwuY2hpbGRyZW4sIHJlcGx5LmJvZHkudmVyc2lvbiwgbXV0dWFsQXV0aGVudGljYXRpb24pOwogICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF0gPSBuZXdPYmo7CgogICAgICAgICAgICByZXNvbHZlKG5ld09iaik7CiAgICAgICAgICAgIG5ld1Byb3Zpc2lvbmFsLmFwcGx5KG5ld09iaik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSBsb2NhbCBydW50aW1lIFJlcG9ydGVyT2JqZWN0IC0+IF9vblJlbW90ZVN1YnNjcmliZQoKICB9LCB7CiAgICBrZXk6ICdfb25Gb3J3YXJkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Gb3J3YXJkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHJlcG9ydGVyID0gX3RoaXMuX3JlcG9ydGVyc1ttc2cuYm9keS50b107CiAgICAgIHJlcG9ydGVyLl9vbkZvcndhcmQobXNnKTsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBTeW5jaGVyIC0+IGNyZWF0ZSAodGhpcyBpcyBhY3R1YWxseSBhbiBpbnZpdGF0aW9uIHRvIHN1YnNjcmliZSkKCiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVDcmVhdGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5mcm9tLnNsaWNlKDAsIC0xMyk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmJvZHkuc291cmNlLAogICAgICAgIHVybDogcmVzb3VyY2UsCiAgICAgICAgc2NoZW1hOiBtc2cuYm9keS5zY2hlbWEsCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgYWNrOiBmdW5jdGlvbiBhY2sodHlwZSkgewogICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgbFR5cGUgPSB0eXBlOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbU3luY2hlcl0gTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gZGVsZXRlCgogIH0sIHsKICAgIGtleTogJ19vblJlbW90ZURlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVtb3RlRGVsZXRlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9yZW1vdmUgIi9zdWJzY3JpcHRpb24iIGZyb20gdGhlIFVSTAogICAgICB2YXIgcmVzb3VyY2UgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIHZhciBvYmplY3QgPSBfdGhpcy5fb2JzZXJ2ZXJzW3Jlc291cmNlXTsKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIHZhciBldmVudCA9IHsKICAgICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgICAgdXJsOiByZXNvdXJjZSwKICAgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgICBhY2s6IGZ1bmN0aW9uIGFjayh0eXBlKSB7CiAgICAgICAgICAgIHZhciBsVHlwZSA9IDIwMDsKICAgICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgICBsVHlwZSA9IHR5cGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vVE9ETzogYW55IG90aGVyIGRpZmZlcmVudCBvcHRpb25zIGZvciB0aGUgcmVsZWFzZSBwcm9jZXNzLCBsaWtlIGFjY2VwdCBidXQgbm9yIHJlbGVhc2UgbG9jYWw/CiAgICAgICAgICAgIGlmIChsVHlwZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgb2JqZWN0LmRlbGV0ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL3NlbmQgYWNrIHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgICAgYm9keTogeyBjb2RlOiBsVHlwZSwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBpZiAoX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcikgewogICAgICAgICAgY29uc29sZS5sb2coJ05PVElGSUNBVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwNCwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnb3duZXInLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9vd25lcjsKICAgIH0KCiAgICAvKioKICAgICogQWxsIG93bmVkIHJlcG9ydGVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBjcmVhdGUKICAgICogQHR5cGUge09iamVjdDxVUkwsIERhdGFPYmplY3RSZXBvcnRlcj59CiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnRlcnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9yZXBvcnRlcnM7CiAgICB9CgogICAgLyoqCiAgICAqIEFsbCBvd25lZCBvYnNlcnZlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgbG9jYWwgc3Vic2NyaXB0aW9uCiAgICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0T2JzZXJ2ZXI+fQogICAgKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZXJzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fb2JzZXJ2ZXJzOwogICAgfQogIH1dKTsKICByZXR1cm4gU3luY2hlcjsKfSgpOyAvKioKICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICoKICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgKgogICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAqCiAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IFN5bmNoZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEzMSAqLywKLyogMTMyICovLAovKiAxMzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovKioKICogQGFjY2VzcyBwcml2YXRlCiAqIFRoaXMgY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIGNvbGxlY3RpbmcgZGVsdGEgY2hhbmdlcyBpbiByZW1vdGUgb2JqZWN0cywgYmVmb3JlIHRoZSByZXNwb25zZSBvZiBzdWJzY3JpcHRpb24gcmVhY2ggdGhlIG9ic2VydmVyLgogKiBJdCdzIHVzZWQgaW4gU3luY2hlciAtPiBzdWJzY3JpYmUuIFRoZSBmbG93IGlzIGRlZmluZWQgYXM6CiAqIDEuIChvYnNlcnZlcikgLS1zdWJzY3JpYmUtLT4gKHJlcG9ydGVyKQogKiAyLiAob2JzZXJ2ZXIpIDwtLWRlbHRhIHVwZGF0ZXMtLSAocmVwb3J0ZXIpCiAqIDMuIChvYnNlcnZlcikgPC0tc3Vic2NyaWJlIHJlc3BvbnNlLS0gKHJlcG9ydGVyKQogKiBUaGlzIG1lYW5zIHRoYXQgdGhlcmUgY291bGQgYmUgZGVsdGEgdXBkYXRlcyB0cmFuc2ZlcnJlZCBiZWZvcmUgdGhlIHN1YnNjcmlwdGlvbiBjb25maXJtYXRpb24uCiAqIFNpbmNlIHRoZXJlIGlzIG5vIERhdGFPYmplY3RPYnNlcnZlciBiZWZvcmUgdGhlIHVic2NyaXB0aW9uIGNvbmZpcm1hdGlvbiwgdGhlcmUgc2hvdWxkIGJlIHNvbWUgb3RoZXIgb2JqZWN0IGNvbGxlY3RpbmcgdGhlIHVwZGF0ZXMuCiAqIFByb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICovCnZhciBEYXRhUHJvdmlzaW9uYWwgPSBmdW5jdGlvbiAoKSB7CiAgLyogcHJpdmF0ZQogIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXQogIF9saXN0ZW5lcjogTXNnTGlzdGVuZXIKICAgX2NoYW5nZXM6IFtdCiAgKi8KCiAgZnVuY3Rpb24gRGF0YVByb3Zpc2lvbmFsKG93bmVyLCB1cmwsIGJ1cywgY2hpbGRyZW4pIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFQcm92aXNpb25hbCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl91cmwgPSB1cmw7CiAgICBfdGhpcy5fYnVzID0gYnVzOwogICAgX3RoaXMuX2NoaWxkcmVuID0gY2hpbGRyZW47CgogICAgX3RoaXMuX2NoYW5nZXMgPSBbXTsKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YVByb3Zpc2lvbmFsLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YVByb3Zpc2lvbmFsLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgX3RoaXMuX2NoYW5nZXMucHVzaChtc2cpOwogICAgICB9KTsKCiAgICAgIC8qCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwogICAgICBpZiAoX3RoaXMuX2NoaWxkcmVuKSB7CiAgICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IHVybCArICcvY2hpbGRyZW4vJzsKICAgICAgICBfdGhpcy5fY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHsKICAgICAgICAgIGxldCBjaGlsZFVSTCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOwogICAgICAgICAgbGV0IGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgKG1zZykgPT4gewogICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCiAgICAgICAgICAgIGlmIChtc2cuZnJvbSAhPT0gb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0qLwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKCiAgICAgIC8qX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7CiAgICAgICAgbGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgIH0pOyovCiAgICB9CiAgfSwgewogICAga2V5OiAnYXBwbHknLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5KG9ic2VydmVyKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIF90aGlzLl9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZSkgewogICAgICAgIG9ic2VydmVyLl9jaGFuZ2VPYmplY3Qob2JzZXJ2ZXIuX3N5bmNPYmosIGNoYW5nZSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ2NoaWxkcmVuJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW47CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhUHJvdmlzaW9uYWw7Cn0oKTsKCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFQcm92aXNpb25hbDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTM0ICovLAovKiAxMzUgKi8sCi8qIDEzNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzcgKi8sCi8qIDEzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0NSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzkgKi8sCi8qIDE0MCAqLywKLyogMTQxICovLAovKiAxNDIgKi8sCi8qIDE0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDE0OSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3QuYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NCAqLywKLyogMTQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTUxKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7CiAgcmV0dXJuICRPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpOwp9OwoKLyoqKi8gfSksCi8qIDE0NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyAxOS4xLjIuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlLCAuLi4pCnZhciBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpCiAgLCBnT1BTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCiAgLCB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJT2JqZWN0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpCiAgLCAkYXNzaWduICA9IE9iamVjdC5hc3NpZ247CgovLyBzaG91bGQgd29yayB3aXRoIHN5bWJvbHMgYW5kIHNob3VsZCBoYXZlIGRldGVybWluaXN0aWMgcHJvcGVydHkgb3JkZXIgKFY4IGJ1ZykKbW9kdWxlLmV4cG9ydHMgPSAhJGFzc2lnbiB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHZhciBBID0ge30KICAgICwgQiA9IHt9CiAgICAsIFMgPSBTeW1ib2woKQogICAgLCBLID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0JzsKICBBW1NdID0gNzsKICBLLnNwbGl0KCcnKS5mb3JFYWNoKGZ1bmN0aW9uKGspeyBCW2tdID0gazsgfSk7CiAgcmV0dXJuICRhc3NpZ24oe30sIEEpW1NdICE9IDcgfHwgT2JqZWN0LmtleXMoJGFzc2lnbih7fSwgQikpLmpvaW4oJycpICE9IEs7Cn0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycwogIHZhciBUICAgICA9IHRvT2JqZWN0KHRhcmdldCkKICAgICwgYUxlbiAgPSBhcmd1bWVudHMubGVuZ3RoCiAgICAsIGluZGV4ID0gMQogICAgLCBnZXRTeW1ib2xzID0gZ09QUy5mCiAgICAsIGlzRW51bSAgICAgPSBwSUUuZjsKICB3aGlsZShhTGVuID4gaW5kZXgpewogICAgdmFyIFMgICAgICA9IElPYmplY3QoYXJndW1lbnRzW2luZGV4KytdKQogICAgICAsIGtleXMgICA9IGdldFN5bWJvbHMgPyBnZXRLZXlzKFMpLmNvbmNhdChnZXRTeW1ib2xzKFMpKSA6IGdldEtleXMoUykKICAgICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAogICAgICAsIGogICAgICA9IDAKICAgICAgLCBrZXk7CiAgICB3aGlsZShsZW5ndGggPiBqKWlmKGlzRW51bS5jYWxsKFMsIGtleSA9IGtleXNbaisrXSkpVFtrZXldID0gU1trZXldOwogIH0gcmV0dXJuIFQ7Cn0gOiAkYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NyAqLywKLyogMTQ4ICovLAovKiAxNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSkKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYsICdPYmplY3QnLCB7YXNzaWduOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Nil9KTsKCi8qKiovIH0pLAovKiAxNTAgKi8sCi8qIDE1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApCnZhciB0b0lPYmplY3QgICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KS5mOwoKX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2dldE93blByb3BlcnR5RGVzY3JpcHRvcicsIGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICAgIHJldHVybiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRvSU9iamVjdChpdCksIGtleSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTUyICovLAovKiAxNTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gICAgIHByb3h5LW9ic2VydmUgdjAuMC4xOAovLyAgICAgQ29weXJpZ2h0IChjKSAyMDE1LCAyMDE2IFNpbW9uIFkuIEJsYWNrd2VsbCwgQW55V2hpY2hXYXkKLy8gICAgIE1JVCBMaWNlbnNlIC0gaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocAooZnVuY3Rpb24oKSB7CgkidXNlIHN0cmljdCI7CgkvLyBDcmVhdGVzIGFuZCByZXR1cm5zIGEgUHJveHkgd3JhcHBpbmcgYSB0YXJnZXQgc28gdGhhdCBhbGwgY2hhbmdlcyBjYW4gYmUgdHJhcHBlZCBhbmQgZm9yd2FyZGVkIHRvCgkvLyBhIGNhbGxiYWNrLiBUaGUgY2FsbGJhY2sgdGFrZXMgYW4gYXJyYXkgb2YgY2hhbmdlcyBqdXN0IGxpa2UgdGhlIHRyYWRpdGlvbmFsIG9yaWdpbmFsIENocm9tZSBPYmplY3Qub2JzZXJ2ZQoJLy8ge29iamVjdDo8b2JqZWN0IGNoYW5nZWQ+LG5hbWU6PGZpZWxkIGNoYW5nZWQ+LHR5cGU6YWRkfHVwZGF0ZXxkZWxldGV8cmVjb25maWd1cmV8cHJldmVudEV4dGVuc2lvbnN8c2V0UHJvdG90eXBlLG9sZFZhbHVlOjxvbGQgdmFsdWUgaWYgdXBkYXRlIHwgZGVsZXRlPn0KCS8vIFRoZSBhY2NlcHRsaXN0IGNhbiBiZSBhZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUuCgkvLyB2IDAuMC4xMCB0byBzdXBwb3J0IHBhdXNpbmcgYW5kIHJlc3RhcnRpbmcgb2JzZXJ2YXRpb24gdHdvIGFkZGl0aW9uYWwgY29uc3RydWN0b3IgYXJndW1lbnRzIGFyZSBhdmFpbGFibGUgdG8gT2JqZWN0Lm9ic2VydmU6CgkvLyBwYXVzYWJsZSAtIGNyZWF0ZSB0aGUgT2JzZXJ2ZXIgc28gaXQgY2FuIGJlIHBhdXNlZAoJLy8gcGF1c2UgLSBjcmVhdGUgb2JzZXJ2ZXIgaW4gcGF1c2VkIHN0YXRlCgkvLyBpZiBwYXVzYWJsZSBpcyB0cnVlIHRoZW4gYW4gYWRkaXRpb25hbCBtZXRob2QgZGVsaXZlcihpZ25vcmVQcmV2aW91cykgaXMgYXZhaWxhYmxlIHRvIHN0YXJ0IGRlbGl2ZXJ5CgkvLyB0byBwYXVzZSBkZWxpdmVyeSBzZXQgYSBwcm9wZXJ0eSBjYWxsZWQgcGF1c2Ugb24gdGhlIGZ1bmN0aW9uIGRlbGl2ZXIgdG8gdHJ1ZQoJLy8gcGF1c2FibGUgaXMgb3B0aW9uYWwgdG8gcmVkdWNlIHRoZSBjaGFuY2Ugb2Ygc2hhZG93aW5nIGEgcHJvcGVydHkgb3IgbWV0aG9kIG9uIGFueSBleGlzdGluZyBjb2RlIGNhbGxlZCBkZWxpdmVyCglpZighT2JqZWN0Lm9ic2VydmUgJiYgdHlwZW9mKFByb3h5KT09PSJmdW5jdGlvbiIpIHsKCQlmdW5jdGlvbiBPYnNlcnZlcih0YXJnZXQsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgewoJICAgIAl2YXIgbWUgPSB0aGlzLCBwcm94eTsKCSAgICAJZnVuY3Rpb24gZGVsaXZlcihpZ25vcmVQcmV2aW91cyxkZWxheSkgewoJICAgIAkJZGVsaXZlci5kZWxheSA9IGRlbGF5OwoJICAgIAkJaWYoIWRlbGl2ZXIucGF1c2UpIHsKCSAgICAgICAgCQlpZihtZS5jaGFuZ2VzZXQubGVuZ3RoPjApIHsKCSAgICAgICAgCQkJaWYoIWlnbm9yZVByZXZpb3VzKSB7CgkJICAgIAkgICAgCQl2YXIgY2hhbmdlcyA9IG1lLmNoYW5nZXNldC5maWx0ZXIoZnVuY3Rpb24oY2hhbmdlKSB7IHJldHVybiAhYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wOyB9KTsKCQkgICAgICAgIAkJCWlmKGNoYW5nZXMubGVuZ3RoPjApIHsKCQkgICAgICAgIAkJCQljYWxsYmFjayhjaGFuZ2VzKTsKCQkgICAgICAgIAkJCX0KCSAgICAgICAgCQkJfQoJICAgICAgICAJCQltZS5jaGFuZ2VzZXQgPSBbXTsKCSAgICAgICAgCQl9CgkgICAgCQl9CgkgICAgCX0KCSAgICAJZGVsaXZlci5wYXVzZSA9IHBhdXNlOwoJICAgIAlkZWxpdmVyLmRlbGF5ID0gZGVsYXk7CgkJICAgIG1lLmdldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCQkgICAgCWlmKHByb3BlcnR5PT09Il9fb2JzZXJ2ZXJfXyIpIHsKCQkgICAgCQlyZXR1cm4gbWU7CgkJICAgIAl9CgkJICAgIAlpZihwcm9wZXJ0eT09PSJ1bm9ic2VydmUiKSB7CgkJICAgIAkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCSAgICAJCQlPYmplY3QudW5vYnNlcnZlKHRhcmdldCk7CgkJICAgIAkJCXJldHVybiB0YXJnZXQ7CgkJICAgIAkJfTsKCQkgICAgCX0KCQkgICAgCWlmKHByb3BlcnR5PT09ImRlbGl2ZXIiKSB7CgkJICAgIAkJcmV0dXJuIGRlbGl2ZXI7CgkJICAgIAl9CgkJICAgIAlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCQkgICAgfQoJICAgIAltZS50YXJnZXQgPSB0YXJnZXQ7CgkgICAgCW1lLmNoYW5nZXNldCA9IFtdOwoJICAgIAlpZighbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXykgewoJICAgIAkJLy8gX19vYnNlcnZlckNhbGxiYWNrc19fIGlzIHVzZWQgYXMgYW4gaW5kZXggdG8gZ2V0IGF0IHRoZSBwcm94eSB3aGljaCBpcyB0aGUgb2JzZXJ2ZXIsIHNvIHdlIGNhbiB1bm9ic2VydmUKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJDYWxsYmFja3NfXyIse2VudW1lcmFibGU6ZmFsc2UsY29uZmlndXJhYmxlOnRydWUsd3JpdGFibGU6ZmFsc2UsdmFsdWU6W119KTsKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJzX18iLHtlbnVtZXJhYmxlOmZhbHNlLGNvbmZpZ3VyYWJsZTp0cnVlLHdyaXRhYmxlOmZhbHNlLHZhbHVlOltdfSk7CgkgICAgCX0KCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5wdXNoKGNhbGxiYWNrKTsKCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJzX18ucHVzaCh0aGlzKTsKCSAgICAJcHJveHkgPSBuZXcgUHJveHkodGFyZ2V0LG1lKTsKCSAgICAJZGVsaXZlcihmYWxzZSxkZWxheSk7CgkgICAgCXJldHVybiBwcm94eTsKCSAgICB9CgkJT2JzZXJ2ZXIucHJvdG90eXBlLmRlbGl2ZXIgPSBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMuZ2V0KG51bGwsImRlbGl2ZXIiKTsKCQl9CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIHZhbHVlKSB7IC8vICwgcmVjZWl2ZXIKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJdmFyIHR5cGUgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKTsKCSAgICAJdGFyZ2V0W3Byb3BlcnR5XSA9IHZhbHVlOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICghdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKHR5cGUpPj0wKSkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZTp0eXBlfSwKCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAgICAgCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAlpZih0eXBlPT09InVwZGF0ZSIpIHsKCSAgICAgICAgCQljaGFuZ2Uub2xkVmFsdWUgPSBvbGR2YWx1ZTsKCSAgICAgICAgCX0KCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWxldGVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJLy9pZih0eXBlb2Yob2xkdmFsdWUpIT09InVuZGVmaW5lZCIpIHsKCQkgICAgCWRlbGV0ZSB0YXJnZXRbcHJvcGVydHldOwoJCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJkZWxldGUiKT49MCkgewoJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6ImRlbGV0ZSIsb2xkVmFsdWU6b2xkdmFsdWV9LAoJCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCQkgICAgICAgIAkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCQkgICAgICAgIAlpZihzdGFydCkgewoJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJCSAgICAgICAgCX0KCQkgICAgCX0KCSAgICAJLy99CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcikgewoJICAgIAlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcik7CgkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigicmVjb25maWd1cmUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZToicmVjb25maWd1cmUifSwKICAgICAgICAJCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKICAgICAgICAJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7CgkgICAgICAgIAlpZihzdGFydCkgewoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7CgkgICAgICAgIAl9CgkgICAgCX0KCSAgICAJcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBPYnNlcnZlci5wcm90b3R5cGUuc2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbih0YXJnZXQsIHByb3RvdHlwZSkgewoJICAgIAl2YXIgb2xkdmFsdWUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KTsKCSAgICAJT2JqZWN0LnNldFByb3RvdHlwZU9mKHRhcmdldCwgcHJvdG90eXBlKTsKCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJzZXRQcm90b3R5cGUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6Il9fcHJvdG9fXyIsdHlwZToic2V0UHJvdG90eXBlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sCiAgICAJCQkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsCiAgICAJCQkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgICAgICAJaWYoc3RhcnQpIHsKCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgICAgICAJfQoJICAgIAl9CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnByZXZlbnRFeHRlbnNpb25zID0gZnVuY3Rpb24odGFyZ2V0KSB7CgkgICAgICAgIE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh0YXJnZXQpOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInByZXZlbnRFeHRlbnNpb25zIik+PTApIHsKCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCx0eXBlOiJwcmV2ZW50RXh0ZW5zaW9ucyJ9LAoJCQkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLAoJCQkJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsKCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9iamVjdC5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJcmV0dXJuIG5ldyBPYnNlcnZlcihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSk7CgkgICAgfTsKCSAgICBPYmplY3QudW5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrKSB7CgkgICAgCWlmKG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsKCSAgICAJCWlmKCFjYWxsYmFjaykgewoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uc3BsaWNlKDAsb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5sZW5ndGgpOwoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZSgwLG9iamVjdC5fX29ic2VydmVyc19fLmxlbmd0aCk7CgkgICAgCQkJcmV0dXJuOwoJICAgIAkJfQoJICAgIAkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5mb3JFYWNoKGZ1bmN0aW9uKG9ic2VydmVyY2FsbGJhY2ssaSkgewoJICAgIAkJCWlmKGNhbGxiYWNrPT09b2JzZXJ2ZXJjYWxsYmFjaykgewoJICAgIAkJCQlvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLnNwbGljZShpLDEpOwoJICAgIAkJCQlkZWxldGUgb2JqZWN0Ll9fb2JzZXJ2ZXJzX19baV0uY2FsbGJhY2s7CgkgICAgCQkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZShpLDEpOwoJICAgIAkJCX0KCSAgICAJCX0pOwoJICAgIAl9CgkgICAgfTsKCSAgICBBcnJheS5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJaWYoIShvYmplY3QgaW5zdGFuY2VvZiBBcnJheSkgJiYgIUFycmF5LmlzQXJyYXkob2JqZWN0KSkgewoJICAgIAkJdGhyb3cgbmV3IFR5cGVFcnJvcigiRmlyc3QgYXJndW1lbnQgdG8gQXJyYXkub2JzZXJ2ZXIgaXMgbm90IGFuIEFycmF5Iik7CgkgICAgCX0KICAgICAgICAgICAgCWFjY2VwdGxpc3QgPSBhY2NlcHRsaXN0IHx8IFsiYWRkIiwgInVwZGF0ZSIsICJkZWxldGUiLCAic3BsaWNlIl07CgkgICAgCXZhciBhcnJheXByb3h5ID0gbmV3IFByb3h5KG9iamVjdCx7Z2V0OiBmdW5jdGlvbih0YXJnZXQscHJvcGVydHkpIHsKCSAgICAJCWlmKHByb3BlcnR5PT09InVub2JzZXJ2ZSIpIHsKCQkgICAgCQlyZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2spIHsKCQkgICAgCQkJaWYoY2FsbGJhY2spIHsKCQkgICAgCQkJCXJldHVybiBPYmplY3QudW5vYnNlcnZlKHRhcmdldCxjYWxsYmFjayk7CgkJICAgIAkJCX0KCQkgICAgCQkJcmV0dXJuIHRhcmdldC51bm9ic2VydmUoKTsKCQkgICAgCQl9OwoJCSAgICAJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic3BsaWNlIikgewoJICAgIAkJCXJldHVybiBmdW5jdGlvbihzdGFydCxlbmQpIHsKCSAgICAJCQkJaWYodHlwZW9mKHN0YXJ0KSE9PSJudW1iZXIiIHx8IHR5cGVvZihlbmQpIT09Im51bWJlciIpIHsKCSAgICAJCQkJCXRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IHR3byBhcmd1bWVudHMgdG8gQXJyYXkgc3BsaWNlIGFyZSBub3QgbnVtYmVyLCBudW1iZXIiKTsKCSAgICAJCQkJfQoJICAgIAkgICAgCQl2YXIgcmVtb3ZlZCA9IHRoaXMuc2xpY2Uoc3RhcnQsc3RhcnQrZW5kKSwKCSAgICAJICAgIAkJCWFkZGVkQ291bnQgPSAoYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHMubGVuZ3RoLTIgOiAwKSwKCSAgICAJICAgIAkJCWNoYW5nZSA9ICB7b2JqZWN0Om9iamVjdCx0eXBlOiJzcGxpY2UiLGluZGV4OnN0YXJ0LHJlbW92ZWQ6cmVtb3ZlZCxhZGRlZENvdW50OmFkZGVkQ291bnR9OwoJICAgIAkgICAgCQl0YXJnZXQuc3BsaWNlLmFwcGx5KHRhcmdldCxhcmd1bWVudHMpOwoJICAgIAkgICAgCQlpZihhY2NlcHRsaXN0LmluZGV4T2YoInNwbGljZSIpPj0wKSB7CgkgICAgCSAgICAJCQl2YXIgc3RhcnQgPSBwcm94eS5fX29ic2VydmVyX18uY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAJICAgICAgICAJCQlkZWxpdmVyID0gcHJveHkuX19vYnNlcnZlcl9fLmRlbGl2ZXIoKTsKCSAgICAJICAgIAkJCXByb3h5Ll9fb2JzZXJ2ZXJfXy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgIAkgICAgCQkJaWYoc3RhcnQpIHsKCSAgICAJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgIAkJICAgICAgICAJfQoJICAgIAkgICAgCQl9CgkgICAgCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icHVzaCIpIHsKCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHsKCSAgICAJCSAgICAJcmV0dXJuIHRoaXMuc3BsaWNlKHRoaXMubGVuZ3RoLDAsaXRlbSk7CgkgICAgCQkgICAgfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icG9wIikgewoJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oKSB7CgkgICAgCQkgICAgCXJldHVybiB0aGlzLnNwbGljZSh0aGlzLmxlbmd0aC0xLDEpOwoJICAgIAkJICAgIH0KCSAgICAJCX0KCSAgICAJCWlmKHByb3BlcnR5PT09InVuc2hpZnQiKSB7CgkgICAgCQkJIHJldHVybiBmdW5jdGlvbihpdGVtKSB7CiAgICAJCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDAsaXRlbSk7CiAgICAJCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic2hpZnQiKSB7CgkgICAgCQkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJICAgIAkgICAgCQlyZXR1cm4gdGhpcy5zcGxpY2UoMCwxKTsKCSAgICAJICAgIAl9CgkgICAgCQl9CgkgICAgCQlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJfX0pOwoJICAgIAl2YXIgcHJveHkgPSBPYmplY3Qub2JzZXJ2ZShhcnJheXByb3h5LGZ1bmN0aW9uKGNoYW5nZXNldCkgeyAKCSAgICAJCXZhciBjaGFuZ2VzID0gY2hhbmdlc2V0LmZpbHRlcihmdW5jdGlvbihjaGFuZ2UpIHsgcmV0dXJuIGNoYW5nZS5uYW1lIT09Imxlbmd0aCIgJiYgY2hhbmdlLm5hbWUhPT0iYWRkIiAmJiAoIWFjY2VwdGxpc3QgfHwgYWNjZXB0bGlzdC5pbmRleE9mKGNoYW5nZS50eXBlKT49MCk7IH0pOwoJICAgIAkJaWYoY2hhbmdlcy5sZW5ndGg+MCkgewoJICAgIAkJCWNhbGxiYWNrKGNoYW5nZXMpOwoJICAgIAkJfQoJICAgIAl9LGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpOwoJICAgIAlyZXR1cm4gcHJveHk7CgkgICAgfTsKCSAgICBBcnJheS51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsKCQkgIHJldHVybiBvYmplY3QudW5vYnNlcnZlKGNhbGxiYWNrKTsKCSAgICB9Cgl9CglPYmplY3QuZGVlcE9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2sscGFydHMpIHsKCgkJcGFydHMgPSAocGFydHMgPyBwYXJ0cyA6IFtdKTsKCgkJdmFyIHRvVHlwZU5hbWUgPSBmdW5jdGlvbihvYmopIHsKCQkJcmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvYmopLm1hdGNoKC9ccyhbYS16QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKQoJCX0KCgkJZnVuY3Rpb24gcmVvYnNlcnZlKHZhbHVlLCBwYXJ0cykgewoJCQl2YXIga2V5cyA9IE9iamVjdC5rZXlzKHZhbHVlKTsKCQkJa2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJaWYoKHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdvYmplY3QnIHx8IHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdhcnJheScpICYmICF2YWx1ZVtrZXldLmhhc093blByb3BlcnR5KCdfX29ic2VydmVyc19fJykpIHsKCQkJCQl2YXIgbmV3cGFydHMgPSBwYXJ0cy5zbGljZSgwKTsKCQkJCQluZXdwYXJ0cy5wdXNoKGtleSk7CgkJCQkJdmFsdWVba2V5XSA9IE9iamVjdC5kZWVwT2JzZXJ2ZSh2YWx1ZVtrZXldLGNhbGxiYWNrLG5ld3BhcnRzKTsKCQkJCX0KCQkJfSk7CgkJfQoKCQlyZW9ic2VydmUob2JqZWN0LCBwYXJ0cyk7CgoJCXZhciBvYnNlcnZlZCA9IE9iamVjdC5vYnNlcnZlKG9iamVjdCxmdW5jdGlvbihjaGFuZ2VzZXQpIHsKCQkJdmFyIGNoYW5nZXMgPSBbXTsKCQkJZnVuY3Rpb24gcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0LG5ld09iamVjdCxwYXRoKSB7CgkJCQlpZihuZXdPYmplY3QgaW5zdGFuY2VvZiBPYmplY3QpIHsKCQkJCQl2YXIgbmV3a2V5cyA9IE9iamVjdC5rZXlzKG5ld09iamVjdCk7CgkJCQkJbmV3a2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJCQlpZighb2xkT2JqZWN0IHx8IChvbGRPYmplY3Rba2V5XSE9PW5ld09iamVjdFtrZXldKSkgewoJCQkJCQkJdmFyIG9sZHZhbHVlID0gKG9sZE9iamVjdCAmJiBvbGRPYmplY3Rba2V5XSE9PXVuZGVmaW5lZCA/IG9sZE9iamVjdFtrZXldIDogdW5kZWZpbmVkKSwKCQkJCQkJCQljaGFuZ2UgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKSwKCQkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCgkJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGR2YWx1ZSxuZXdWYWx1ZTpuZXdPYmplY3Rba2V5XSxrZXlwYXRoOmtleXBhdGh9KTsKCQkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZHZhbHVlLG5ld09iamVjdFtrZXldLGtleXBhdGgpOwoJCQkJCQl9CgkJCQkJfSk7CgkJCQl9IGVsc2UgaWYob2xkT2JqZWN0IGluc3RhbmNlb2YgT2JqZWN0KSB7CgkJCQkJdmFyIG9sZGtleXMgPSBPYmplY3Qua2V5cyhvbGRPYmplY3QpOwoJCQkJCW9sZGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsKCQkJCQkJdmFyIGNoYW5nZSA9IChuZXdPYmplY3Q9PT1udWxsID8gInVwZGF0ZSIgOiAiZGVsZXRlIiksCgkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCQkJCQkJCQoJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGRPYmplY3Rba2V5XSxuZXdWYWx1ZTpuZXdPYmplY3Qsa2V5cGF0aDprZXlwYXRofSk7CgkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZE9iamVjdFtrZXldLHVuZGVmaW5lZCxrZXlwYXRoKTsKCQkJCQl9KTsKCQkJCX0KCQkJfQoJCQljaGFuZ2VzZXQuZm9yRWFjaChmdW5jdGlvbihjaGFuZ2UpIHsKCQkJCXZhciBrZXlwYXRoID0gKHBhcnRzLmxlbmd0aD4wID8gcGFydHMuam9pbigiLiIpICsgIi4iIDogIiIpICsgY2hhbmdlLm5hbWU7CgoJCQkJaWYgKGNoYW5nZS50eXBlID09PSAidXBkYXRlIiB8fCBjaGFuZ2UudHlwZSA9PT0gImFkZCIpIHsgCgkJCQkJcmVvYnNlcnZlKGNoYW5nZS5vYmplY3QsIHBhcnRzKTsKCQkJCX0KCgkJCQljaGFuZ2VzLnB1c2goe25hbWU6Y2hhbmdlLm5hbWUsb2JqZWN0OmNoYW5nZS5vYmplY3QsdHlwZTpjaGFuZ2UudHlwZSxvbGRWYWx1ZTpjaGFuZ2Uub2xkVmFsdWUsbmV3VmFsdWU6Y2hhbmdlLm9iamVjdFtjaGFuZ2UubmFtZV0sa2V5cGF0aDprZXlwYXRofSk7CgkJCQlyZWN1cnNlKGNoYW5nZS5uYW1lLGNoYW5nZS5vYmplY3QsY2hhbmdlLm9sZFZhbHVlLGNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGgpOwoJCQl9KTsKCQkJY2FsbGJhY2soY2hhbmdlcyk7CgkJfSk7CgkJcmV0dXJuIG9ic2VydmVkOwoJfTsKfSkoKTsKCgovKioqLyB9KSwKLyogMTU0ICovLAovKiAxNTUgKi8sCi8qIDE1NiAqLywKLyogMTU3ICovLAovKiAxNTggKi8sCi8qIDE1OSAqLywKLyogMTYwICovLAovKiAxNjEgKi8sCi8qIDE2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkRhdGFPYmplY3RPYnNlcnZlciA9IGV4cG9ydHMuRGF0YU9iamVjdFJlcG9ydGVyID0gZXhwb3J0cy5TeW5jaGVyID0gdW5kZWZpbmVkOwoKdmFyIF9TeW5jaGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzApOwoKdmFyIF9TeW5jaGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1N5bmNoZXIpOwoKdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOSk7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuU3luY2hlciA9IF9TeW5jaGVyMi5kZWZhdWx0OwpleHBvcnRzLkRhdGFPYmplY3RSZXBvcnRlciA9IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQ7CmV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdDsKCi8qKiovIH0pCi8qKioqKiovIF0pOwp9KTsKCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwoKJ3VzZSBzdHJpY3QnOwoKLy8gU2hpbW1pbmcgc3RhcnRzIGhlcmUuCihmdW5jdGlvbigpIHsKICAvLyBVdGlscy4KICB2YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7CiAgdmFyIGxvZ2dpbmcgPSB1dGlscy5sb2c7CiAgdmFyIGJyb3dzZXJEZXRhaWxzID0gdXRpbHMuYnJvd3NlckRldGFpbHM7CiAgLy8gRXhwb3J0IHRvIHRoZSBhZGFwdGVyIGdsb2JhbCBvYmplY3QgdmlzaWJsZSBpbiB0aGUgYnJvd3Nlci4KICBtb2R1bGUuZXhwb3J0cy5icm93c2VyRGV0YWlscyA9IGJyb3dzZXJEZXRhaWxzOwogIG1vZHVsZS5leHBvcnRzLmV4dHJhY3RWZXJzaW9uID0gdXRpbHMuZXh0cmFjdFZlcnNpb247CiAgbW9kdWxlLmV4cG9ydHMuZGlzYWJsZUxvZyA9IHV0aWxzLmRpc2FibGVMb2c7CgogIC8vIFVuY29tbWVudCB0aGUgbGluZSBiZWxvdyBpZiB5b3Ugd2FudCBsb2dnaW5nIHRvIG9jY3VyLCBpbmNsdWRpbmcgbG9nZ2luZwogIC8vIGZvciB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdy4gQ2FuIGFsc28gYmUgdHVybmVkIG9uIGluIHRoZSBicm93c2VyIHZpYQogIC8vIGFkYXB0ZXIuZGlzYWJsZUxvZyhmYWxzZSksIGJ1dCB0aGVuIGxvZ2dpbmcgZnJvbSB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdwogIC8vIHdpbGwgbm90IGFwcGVhci4KICAvLyByZXF1aXJlKCcuL3V0aWxzJykuZGlzYWJsZUxvZyhmYWxzZSk7CgogIC8vIEJyb3dzZXIgc2hpbXMuCiAgdmFyIGNocm9tZVNoaW0gPSByZXF1aXJlKCcuL2Nocm9tZS9jaHJvbWVfc2hpbScpIHx8IG51bGw7CiAgdmFyIGVkZ2VTaGltID0gcmVxdWlyZSgnLi9lZGdlL2VkZ2Vfc2hpbScpIHx8IG51bGw7CiAgdmFyIGZpcmVmb3hTaGltID0gcmVxdWlyZSgnLi9maXJlZm94L2ZpcmVmb3hfc2hpbScpIHx8IG51bGw7CiAgdmFyIHNhZmFyaVNoaW0gPSByZXF1aXJlKCcuL3NhZmFyaS9zYWZhcmlfc2hpbScpIHx8IG51bGw7CgogIC8vIFNoaW0gYnJvd3NlciBpZiBmb3VuZC4KICBzd2l0Y2ggKGJyb3dzZXJEZXRhaWxzLmJyb3dzZXIpIHsKICAgIGNhc2UgJ2Nocm9tZSc6CiAgICAgIGlmICghY2hyb21lU2hpbSB8fCAhY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdDaHJvbWUgc2hpbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhpcyBhZGFwdGVyIHJlbGVhc2UuJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGxvZ2dpbmcoJ2FkYXB0ZXIuanMgc2hpbW1pbmcgY2hyb21lLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGNocm9tZVNoaW07CgogICAgICBjaHJvbWVTaGltLnNoaW1HZXRVc2VyTWVkaWEoKTsKICAgICAgY2hyb21lU2hpbS5zaGltTWVkaWFTdHJlYW0oKTsKICAgICAgdXRpbHMuc2hpbUNyZWF0ZU9iamVjdFVSTCgpOwogICAgICBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QoKTsKICAgICAgY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgY2hyb21lU2hpbS5zaGltT25UcmFjaygpOwogICAgICBicmVhazsKICAgIGNhc2UgJ2ZpcmVmb3gnOgogICAgICBpZiAoIWZpcmVmb3hTaGltIHx8ICFmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdGaXJlZm94IHNoaW0gaXMgbm90IGluY2x1ZGVkIGluIHRoaXMgYWRhcHRlciByZWxlYXNlLicpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBsb2dnaW5nKCdhZGFwdGVyLmpzIHNoaW1taW5nIGZpcmVmb3guJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gZmlyZWZveFNoaW07CgogICAgICBmaXJlZm94U2hpbS5zaGltR2V0VXNlck1lZGlhKCk7CiAgICAgIHV0aWxzLnNoaW1DcmVhdGVPYmplY3RVUkwoKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbVNvdXJjZU9iamVjdCgpOwogICAgICBmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbU9uVHJhY2soKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdlZGdlJzoKICAgICAgaWYgKCFlZGdlU2hpbSB8fCAhZWRnZVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uKSB7CiAgICAgICAgbG9nZ2luZygnTVMgZWRnZSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBlZGdlLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGVkZ2VTaGltOwoKICAgICAgZWRnZVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMKCk7CiAgICAgIGVkZ2VTaGltLnNoaW1QZWVyQ29ubmVjdGlvbigpOwogICAgICBicmVhazsKICAgIGNhc2UgJ3NhZmFyaSc6CiAgICAgIGlmICghc2FmYXJpU2hpbSkgewogICAgICAgIGxvZ2dpbmcoJ1NhZmFyaSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBzYWZhcmkuJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gc2FmYXJpU2hpbTsKCiAgICAgIHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgIGxvZ2dpbmcoJ1Vuc3VwcG9ydGVkIGJyb3dzZXIhJyk7CiAgfQp9KSgpOwoKfSx7Ii4vY2hyb21lL2Nocm9tZV9zaGltIjo0LCIuL2VkZ2UvZWRnZV9zaGltIjo2LCIuL2ZpcmVmb3gvZmlyZWZveF9zaGltIjo4LCIuL3NhZmFyaS9zYWZhcmlfc2hpbSI6MTAsIi4vdXRpbHMiOjExfV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CgovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzLmpzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgY2hyb21lU2hpbSA9IHsKICBzaGltTWVkaWFTdHJlYW06IGZ1bmN0aW9uKCkgewogICAgd2luZG93Lk1lZGlhU3RyZWFtID0gd2luZG93Lk1lZGlhU3RyZWFtIHx8IHdpbmRvdy53ZWJraXRNZWRpYVN0cmVhbTsKICB9LAoKICBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmICEoJ29udHJhY2snIGluCiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUsICdvbnRyYWNrJywgewogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5fb250cmFjazsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24oZikgewogICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgaWYgKHRoaXMuX29udHJhY2spIHsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFjaycsIHRoaXMuX29udHJhY2spOwogICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5KTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrID0gZik7CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5ID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAvLyBvbmFkZHN0cmVhbSBkb2VzIG5vdCBmaXJlIHdoZW4gYSB0cmFjayBpcyBhZGRlZCB0byBhbiBleGlzdGluZwogICAgICAgICAgICAvLyBzdHJlYW0uIEJ1dCBzdHJlYW0ub25hZGR0cmFjayBpcyBpbXBsZW1lbnRlZCBzbyB3ZSB1c2UgdGhhdC4KICAgICAgICAgICAgZS5zdHJlYW0uYWRkRXZlbnRMaXN0ZW5lcignYWRkdHJhY2snLCBmdW5jdGlvbih0ZSkgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRlLnRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0ZS50cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGUuc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHsKICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ3RyYWNrJyk7CiAgICAgICAgICAgICAgZXZlbnQudHJhY2sgPSB0cmFjazsKICAgICAgICAgICAgICBldmVudC5yZWNlaXZlciA9IHt0cmFjazogdHJhY2t9OwogICAgICAgICAgICAgIGV2ZW50LnN0cmVhbXMgPSBbZS5zdHJlYW1dOwogICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgICB9LmJpbmQodGhpcykpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKCiAgc2hpbVNvdXJjZU9iamVjdDogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHsKICAgICAgaWYgKHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50ICYmCiAgICAgICAgISgnc3JjT2JqZWN0JyBpbiB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUpKSB7CiAgICAgICAgLy8gU2hpbSB0aGUgc3JjT2JqZWN0IHByb3BlcnR5LCBvbmNlLCB3aGVuIEhUTUxNZWRpYUVsZW1lbnQgaXMgZm91bmQuCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyY09iamVjdCcsIHsKICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zcmNPYmplY3Q7CiAgICAgICAgICB9LAogICAgICAgICAgc2V0OiBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgICAvLyBVc2UgX3NyY09iamVjdCBhcyBhIHByaXZhdGUgcHJvcGVydHkgZm9yIHRoaXMgc2hpbQogICAgICAgICAgICB0aGlzLl9zcmNPYmplY3QgPSBzdHJlYW07CiAgICAgICAgICAgIGlmICh0aGlzLnNyYykgewogICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5zcmMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIXN0cmVhbSkgewogICAgICAgICAgICAgIHRoaXMuc3JjID0gJyc7CiAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTsKICAgICAgICAgICAgLy8gV2UgbmVlZCB0byByZWNyZWF0ZSB0aGUgYmxvYiB1cmwgd2hlbiBhIHRyYWNrIGlzIGFkZGVkIG9yCiAgICAgICAgICAgIC8vIHJlbW92ZWQuIERvaW5nIGl0IG1hbnVhbGx5IHNpbmNlIHdlIHdhbnQgdG8gYXZvaWQgYSByZWN1cnNpb24uCiAgICAgICAgICAgIHN0cmVhbS5hZGRFdmVudExpc3RlbmVyKCdhZGR0cmFjaycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIGlmIChzZWxmLnNyYykgewogICAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChzZWxmLnNyYyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHNlbGYuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc3RyZWFtLmFkZEV2ZW50TGlzdGVuZXIoJ3JlbW92ZXRyYWNrJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgaWYgKHNlbGYuc3JjKSB7CiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHNlbGYuc3JjKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgc2VsZi5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIC8vIFRoZSBSVENQZWVyQ29ubmVjdGlvbiBvYmplY3QuCiAgICBpZiAoIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikgewogICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gPSBmdW5jdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cykgewogICAgICAgIC8vIFRyYW5zbGF0ZSBpY2VUcmFuc3BvcnRQb2xpY3kgdG8gaWNlVHJhbnNwb3J0cywKICAgICAgICAvLyBzZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD00ODY5CiAgICAgICAgLy8gdGhpcyB3YXMgZml4ZWQgaW4gTTU2IGFsb25nIHdpdGggdW5wcmVmaXhpbmcgUlRDUGVlckNvbm5lY3Rpb24uCiAgICAgICAgbG9nZ2luZygnUGVlckNvbm5lY3Rpb24nKTsKICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5KSB7CiAgICAgICAgICBwY0NvbmZpZy5pY2VUcmFuc3BvcnRzID0gcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CiAgICAgIC8vIHdyYXAgc3RhdGljIG1ldGhvZHMuIEN1cnJlbnRseSBqdXN0IGdlbmVyYXRlQ2VydGlmaWNhdGUuCiAgICAgIGlmICh3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5nZW5lcmF0ZUNlcnRpZmljYXRlKSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiwgJ2dlbmVyYXRlQ2VydGlmaWNhdGUnLCB7CiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gd2Via2l0UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIHZhciBvcmlnR2V0U3RhdHMgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHM7CiAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbihzZWxlY3RvciwKICAgICAgICBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgYXJncyA9IGFyZ3VtZW50czsKCiAgICAgIC8vIElmIHNlbGVjdG9yIGlzIGEgZnVuY3Rpb24gdGhlbiB3ZSBhcmUgaW4gdGhlIG9sZCBzdHlsZSBzdGF0cyBzbyBqdXN0CiAgICAgIC8vIHBhc3MgYmFjayB0aGUgb3JpZ2luYWwgZ2V0U3RhdHMgZm9ybWF0IHRvIGF2b2lkIGJyZWFraW5nIG9sZCB1c2Vycy4KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHJldHVybiBvcmlnR2V0U3RhdHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgLy8gV2hlbiBzcGVjLXN0eWxlIGdldFN0YXRzIGlzIHN1cHBvcnRlZCwgcmV0dXJuIHRob3NlIHdoZW4gY2FsbGVkIHdpdGgKICAgICAgLy8gZWl0aGVyIG5vIGFyZ3VtZW50cyBvciB0aGUgc2VsZWN0b3IgYXJndW1lbnQgaXMgbnVsbC4KICAgICAgaWYgKG9yaWdHZXRTdGF0cy5sZW5ndGggPT09IDAgJiYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHwKICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpKSB7CiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbXSk7CiAgICAgIH0KCiAgICAgIHZhciBmaXhDaHJvbWVTdGF0c18gPSBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgIHZhciBzdGFuZGFyZFJlcG9ydCA9IHt9OwogICAgICAgIHZhciByZXBvcnRzID0gcmVzcG9uc2UucmVzdWx0KCk7CiAgICAgICAgcmVwb3J0cy5mb3JFYWNoKGZ1bmN0aW9uKHJlcG9ydCkgewogICAgICAgICAgdmFyIHN0YW5kYXJkU3RhdHMgPSB7CiAgICAgICAgICAgIGlkOiByZXBvcnQuaWQsCiAgICAgICAgICAgIHRpbWVzdGFtcDogcmVwb3J0LnRpbWVzdGFtcCwKICAgICAgICAgICAgdHlwZTogewogICAgICAgICAgICAgIGxvY2FsY2FuZGlkYXRlOiAnbG9jYWwtY2FuZGlkYXRlJywKICAgICAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgICAgICB9W3JlcG9ydC50eXBlXSB8fCByZXBvcnQudHlwZQogICAgICAgICAgfTsKICAgICAgICAgIHJlcG9ydC5uYW1lcygpLmZvckVhY2goZnVuY3Rpb24obmFtZSkgewogICAgICAgICAgICBzdGFuZGFyZFN0YXRzW25hbWVdID0gcmVwb3J0LnN0YXQobmFtZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHN0YW5kYXJkUmVwb3J0W3N0YW5kYXJkU3RhdHMuaWRdID0gc3RhbmRhcmRTdGF0czsKICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIHN0YW5kYXJkUmVwb3J0OwogICAgICB9OwoKICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICB2YXIgbWFrZU1hcFN0YXRzID0gZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICByZXR1cm4gbmV3IE1hcChPYmplY3Qua2V5cyhzdGF0cykubWFwKGZ1bmN0aW9uKGtleSkgewogICAgICAgICAgcmV0dXJuW2tleSwgc3RhdHNba2V5XV07CiAgICAgICAgfSkpOwogICAgICB9OwoKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMikgewogICAgICAgIHZhciBzdWNjZXNzQ2FsbGJhY2tXcmFwcGVyXyA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICBhcmdzWzFdKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgfTsKCiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbc3VjY2Vzc0NhbGxiYWNrV3JhcHBlcl8sCiAgICAgICAgICAgIGFyZ3VtZW50c1swXV0pOwogICAgICB9CgogICAgICAvLyBwcm9taXNlLXN1cHBvcnQKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIG9yaWdHZXRTdGF0cy5hcHBseShzZWxmLCBbCiAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICByZXNvbHZlKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgICB9LCByZWplY3RdKTsKICAgICAgfSkudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spOwogICAgfTsKCiAgICAvLyBhZGQgcHJvbWlzZSBzdXBwb3J0IC0tIG5hdGl2ZWx5IGF2YWlsYWJsZSBpbiBDaHJvbWUgNTEKICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNTEpIHsKICAgICAgWydzZXRMb2NhbERlc2NyaXB0aW9uJywgJ3NldFJlbW90ZURlc2NyaXB0aW9uJywgJ2FkZEljZUNhbmRpZGF0ZSddCiAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzOwogICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFthcmdzWzBdLCByZXNvbHZlLCByZWplY3RdKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGFyZ3NbMV0uYXBwbHkobnVsbCwgW10pOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZnVuY3Rpb24oZXJyKSB7CiAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPj0gMykgewogICAgICAgICAgICAgICAgICBhcmdzWzJdLmFwcGx5KG51bGwsIFtlcnJdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgfQoKICAgIC8vIHByb21pc2Ugc3VwcG9ydCBmb3IgY3JlYXRlT2ZmZXIgYW5kIGNyZWF0ZUFuc3dlci4gQXZhaWxhYmxlICh3aXRob3V0CiAgICAvLyBidWdzKSBzaW5jZSBNNTI6IGNyYnVnLzYxOTI4OQogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MikgewogICAgICBbJ2NyZWF0ZU9mZmVyJywgJ2NyZWF0ZUFuc3dlciddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDEgfHwgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYKICAgICAgICAgICAgICB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnb2JqZWN0JykpIHsKICAgICAgICAgICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkOwogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFtyZXNvbHZlLCByZWplY3QsIG9wdHNdKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CgogICAgLy8gc2hpbSBpbXBsaWNpdCBjcmVhdGlvbiBvZiBSVENTZXNzaW9uRGVzY3JpcHRpb24vUlRDSWNlQ2FuZGlkYXRlCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfQp9OwoKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbU1lZGlhU3RyZWFtOiBjaHJvbWVTaGltLnNoaW1NZWRpYVN0cmVhbSwKICBzaGltT25UcmFjazogY2hyb21lU2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QsCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBjaHJvbWVTaGltLnNoaW1QZWVyQ29ubmVjdGlvbiwKICBzaGltR2V0VXNlck1lZGlhOiByZXF1aXJlKCcuL2dldHVzZXJtZWRpYScpCn07Cgp9LHsiLi4vdXRpbHMuanMiOjExLCIuL2dldHVzZXJtZWRpYSI6NX1dLDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIGNvbnN0cmFpbnRzVG9DaHJvbWVfID0gZnVuY3Rpb24oYykgewogICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLm1hbmRhdG9yeSB8fCBjLm9wdGlvbmFsKSB7CiAgICAgIHJldHVybiBjOwogICAgfQogICAgdmFyIGNjID0ge307CiAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICBpZiAoa2V5ID09PSAncmVxdWlyZScgfHwga2V5ID09PSAnYWR2YW5jZWQnIHx8IGtleSA9PT0gJ21lZGlhU291cmNlJykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgciA9ICh0eXBlb2YgY1trZXldID09PSAnb2JqZWN0JykgPyBjW2tleV0gOiB7aWRlYWw6IGNba2V5XX07CiAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHIuZXhhY3QgPT09ICdudW1iZXInKSB7CiAgICAgICAgci5taW4gPSByLm1heCA9IHIuZXhhY3Q7CiAgICAgIH0KICAgICAgdmFyIG9sZG5hbWVfID0gZnVuY3Rpb24ocHJlZml4LCBuYW1lKSB7CiAgICAgICAgaWYgKHByZWZpeCkgewogICAgICAgICAgcmV0dXJuIHByZWZpeCArIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gKG5hbWUgPT09ICdkZXZpY2VJZCcpID8gJ3NvdXJjZUlkJyA6IG5hbWU7CiAgICAgIH07CiAgICAgIGlmIChyLmlkZWFsICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjYy5vcHRpb25hbCA9IGNjLm9wdGlvbmFsIHx8IFtdOwogICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgIGlmICh0eXBlb2Ygci5pZGVhbCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCdtaW4nLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICAgIG9jID0ge307CiAgICAgICAgICBvY1tvbGRuYW1lXygnbWF4Jywga2V5KV0gPSByLmlkZWFsOwogICAgICAgICAgY2Mub3B0aW9uYWwucHVzaChvYyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHIuZXhhY3QgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygci5leGFjdCAhPT0gJ251bWJlcicpIHsKICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgY2MubWFuZGF0b3J5W29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuZXhhY3Q7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgWydtaW4nLCAnbWF4J10uZm9yRWFjaChmdW5jdGlvbihtaXgpIHsKICAgICAgICAgIGlmIChyW21peF0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgICAgIGNjLm1hbmRhdG9yeVtvbGRuYW1lXyhtaXgsIGtleSldID0gclttaXhdOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICAgIGlmIChjLmFkdmFuY2VkKSB7CiAgICAgIGNjLm9wdGlvbmFsID0gKGNjLm9wdGlvbmFsIHx8IFtdKS5jb25jYXQoYy5hZHZhbmNlZCk7CiAgICB9CiAgICByZXR1cm4gY2M7CiAgfTsKCiAgdmFyIHNoaW1Db25zdHJhaW50c18gPSBmdW5jdGlvbihjb25zdHJhaW50cywgZnVuYykgewogICAgY29uc3RyYWludHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7CiAgICBpZiAoY29uc3RyYWludHMgJiYgY29uc3RyYWludHMuYXVkaW8pIHsKICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy5hdWRpbyk7CiAgICB9CiAgICBpZiAoY29uc3RyYWludHMgJiYgdHlwZW9mIGNvbnN0cmFpbnRzLnZpZGVvID09PSAnb2JqZWN0JykgewogICAgICAvLyBTaGltIGZhY2luZ01vZGUgZm9yIG1vYmlsZSwgd2hlcmUgaXQgZGVmYXVsdHMgdG8gInVzZXIiLgogICAgICB2YXIgZmFjZSA9IGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgIGZhY2UgPSBmYWNlICYmICgodHlwZW9mIGZhY2UgPT09ICdvYmplY3QnKSA/IGZhY2UgOiB7aWRlYWw6IGZhY2V9KTsKCiAgICAgIGlmICgoZmFjZSAmJiAoZmFjZS5leGFjdCA9PT0gJ3VzZXInIHx8IGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwKICAgICAgICAgICAgICAgICAgICBmYWNlLmlkZWFsID09PSAndXNlcicgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykpICYmCiAgICAgICAgICAhKG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0U3VwcG9ydGVkQ29uc3RyYWludHMgJiYKICAgICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRTdXBwb3J0ZWRDb25zdHJhaW50cygpLmZhY2luZ01vZGUpKSB7CiAgICAgICAgZGVsZXRlIGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgICAgaWYgKGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykgewogICAgICAgICAgLy8gTG9vayBmb3IgImJhY2siIGluIGxhYmVsLCBvciB1c2UgbGFzdCBjYW0gKHR5cGljYWxseSBiYWNrIGNhbSkuCiAgICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzKCkKICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgZGV2aWNlcyA9IGRldmljZXMuZmlsdGVyKGZ1bmN0aW9uKGQpIHsKICAgICAgICAgICAgICByZXR1cm4gZC5raW5kID09PSAndmlkZW9pbnB1dCc7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgYmFjayA9IGRldmljZXMuZmluZChmdW5jdGlvbihkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGQubGFiZWwudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdiYWNrJykgIT09IC0xOwogICAgICAgICAgICB9KSB8fCAoZGV2aWNlcy5sZW5ndGggJiYgZGV2aWNlc1tkZXZpY2VzLmxlbmd0aCAtIDFdKTsKICAgICAgICAgICAgaWYgKGJhY2spIHsKICAgICAgICAgICAgICBjb25zdHJhaW50cy52aWRlby5kZXZpY2VJZCA9IGZhY2UuZXhhY3QgPyB7ZXhhY3Q6IGJhY2suZGV2aWNlSWR9IDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aWRlYWw6IGJhY2suZGV2aWNlSWR9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0Nocm9tZV8oY29uc3RyYWludHMudmlkZW8pOwogICAgICAgICAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgICAgICAgICByZXR1cm4gZnVuYyhjb25zdHJhaW50cyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3RyYWludHMudmlkZW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy52aWRlbyk7CiAgICB9CiAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgcmV0dXJuIGZ1bmMoY29uc3RyYWludHMpOwogIH07CgogIHZhciBzaGltRXJyb3JfID0gZnVuY3Rpb24oZSkgewogICAgcmV0dXJuIHsKICAgICAgbmFtZTogewogICAgICAgIFBlcm1pc3Npb25EZW5pZWRFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgQ29uc3RyYWludE5vdFNhdGlzZmllZEVycm9yOiAnT3ZlcmNvbnN0cmFpbmVkRXJyb3InCiAgICAgIH1bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50TmFtZSwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgc2hpbUNvbnN0cmFpbnRzXyhjb25zdHJhaW50cywgZnVuY3Rpb24oYykgewogICAgICBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKGMsIG9uU3VjY2VzcywgZnVuY3Rpb24oZSkgewogICAgICAgIG9uRXJyb3Ioc2hpbUVycm9yXyhlKSk7CiAgICAgIH0pOwogICAgfSk7CiAgfTsKCiAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IGdldFVzZXJNZWRpYV87CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICBpZiAoIW5hdmlnYXRvci5tZWRpYURldmljZXMpIHsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMgPSB7CiAgICAgIGdldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGVudW1lcmF0ZURldmljZXM6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIga2luZHMgPSB7YXVkaW86ICdhdWRpb2lucHV0JywgdmlkZW86ICd2aWRlb2lucHV0J307CiAgICAgICAgICByZXR1cm4gTWVkaWFTdHJlYW1UcmFjay5nZXRTb3VyY2VzKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgcmVzb2x2ZShkZXZpY2VzLm1hcChmdW5jdGlvbihkZXZpY2UpIHsKICAgICAgICAgICAgICByZXR1cm4ge2xhYmVsOiBkZXZpY2UubGFiZWwsCiAgICAgICAgICAgICAgICAgICAgICBraW5kOiBraW5kc1tkZXZpY2Uua2luZF0sCiAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZDogZGV2aWNlLmlkLAogICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogJyd9OwogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfTsKICB9CgogIC8vIEEgc2hpbSBmb3IgZ2V0VXNlck1lZGlhIG1ldGhvZCBvbiB0aGUgbWVkaWFEZXZpY2VzIG9iamVjdC4KICAvLyBUT0RPKEthcHRlbkphbnNzb24pIHJlbW92ZSBvbmNlIGltcGxlbWVudGVkIGluIENocm9tZSBzdGFibGUuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSkgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cykgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhUHJvbWlzZV8oY29uc3RyYWludHMpOwogICAgfTsKICB9IGVsc2UgewogICAgLy8gRXZlbiB0aG91Z2ggQ2hyb21lIDQ1IGhhcyBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzIGFuZCBhIGdldFVzZXJNZWRpYQogICAgLy8gZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhIFByb21pc2UsIGl0IGRvZXMgbm90IGFjY2VwdCBzcGVjLXN0eWxlCiAgICAvLyBjb25zdHJhaW50cy4KICAgIHZhciBvcmlnR2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEuCiAgICAgICAgYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY3MpIHsKICAgICAgcmV0dXJuIHNoaW1Db25zdHJhaW50c18oY3MsIGZ1bmN0aW9uKGMpIHsKICAgICAgICByZXR1cm4gb3JpZ0dldFVzZXJNZWRpYShjKS50aGVuKGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICAgIGMudmlkZW8gJiYgIXN0cmVhbS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCkgewogICAgICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJycsICdOb3RGb3VuZEVycm9yJyk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gc3RyZWFtOwogICAgICAgIH0sIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KCiAgLy8gRHVtbXkgZGV2aWNlY2hhbmdlIGV2ZW50IG1ldGhvZHMuCiAgLy8gVE9ETyhLYXB0ZW5KYW5zc29uKSByZW1vdmUgb25jZSBpbXBsZW1lbnRlZCBpbiBDaHJvbWUgc3RhYmxlLgogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQp9OwoKfSx7Ii4uL3V0aWxzLmpzIjoxMX1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7Cgp2YXIgU0RQVXRpbHMgPSByZXF1aXJlKCdzZHAnKTsKdmFyIGJyb3dzZXJEZXRhaWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5icm93c2VyRGV0YWlsczsKCnZhciBlZGdlU2hpbSA9IHsKICBzaGltUGVlckNvbm5lY3Rpb246IGZ1bmN0aW9uKCkgewogICAgaWYgKHdpbmRvdy5SVENJY2VHYXRoZXJlcikgewogICAgICAvLyBPUlRDIGRlZmluZXMgYW4gUlRDSWNlQ2FuZGlkYXRlIG9iamVjdCBidXQgbm8gY29uc3RydWN0b3IuCiAgICAgIC8vIE5vdCBpbXBsZW1lbnRlZCBpbiBFZGdlLgogICAgICBpZiAoIXdpbmRvdy5SVENJY2VDYW5kaWRhdGUpIHsKICAgICAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oYXJncykgewogICAgICAgICAgcmV0dXJuIGFyZ3M7CiAgICAgICAgfTsKICAgICAgfQogICAgICAvLyBPUlRDIGRvZXMgbm90IGhhdmUgYSBzZXNzaW9uIGRlc2NyaXB0aW9uIG9iamVjdCBidXQKICAgICAgLy8gb3RoZXIgYnJvd3NlcnMgKGkuZS4gQ2hyb21lKSB0aGF0IHdpbGwgc3VwcG9ydCBib3RoIFBDIGFuZCBPUlRDCiAgICAgIC8vIGluIHRoZSBmdXR1cmUgbWlnaHQgaGF2ZSB0aGlzIGRlZmluZWQgYWxyZWFkeS4KICAgICAgaWYgKCF3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKSB7CiAgICAgICAgd2luZG93LlJUQ1Nlc3Npb25EZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGFyZ3MpIHsKICAgICAgICAgIHJldHVybiBhcmdzOwogICAgICAgIH07CiAgICAgIH0KICAgICAgLy8gdGhpcyBhZGRzIGFuIGFkZGl0aW9uYWwgZXZlbnQgbGlzdGVuZXIgdG8gTWVkaWFTdHJhY2tUcmFjayB0aGF0IHNpZ25hbHMKICAgICAgLy8gd2hlbiBhIHRyYWNrcyBlbmFibGVkIHByb3BlcnR5IHdhcyBjaGFuZ2VkLiBXb3JrYXJvdW5kIGZvciBhIGJ1ZyBpbgogICAgICAvLyBhZGRTdHJlYW0sIHNlZSBiZWxvdy4gTm8gbG9uZ2VyIHJlcXVpcmVkIGluIDE1MDI1KwogICAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDE1MDI1KSB7CiAgICAgICAgdmFyIG9yaWdNU1RFbmFibGVkID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcigKICAgICAgICAgICAgTWVkaWFTdHJlYW1UcmFjay5wcm90b3R5cGUsICdlbmFibGVkJyk7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLCAnZW5hYmxlZCcsIHsKICAgICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgb3JpZ01TVEVuYWJsZWQuc2V0LmNhbGwodGhpcywgdmFsdWUpOwogICAgICAgICAgICB2YXIgZXYgPSBuZXcgRXZlbnQoJ2VuYWJsZWQnKTsKICAgICAgICAgICAgZXYuZW5hYmxlZCA9IHZhbHVlOwogICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24oY29uZmlnKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgIHZhciBfZXZlbnRUYXJnZXQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CiAgICAgIFsnYWRkRXZlbnRMaXN0ZW5lcicsICdyZW1vdmVFdmVudExpc3RlbmVyJywgJ2Rpc3BhdGNoRXZlbnQnXQogICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgICAgIHNlbGZbbWV0aG9kXSA9IF9ldmVudFRhcmdldFttZXRob2RdLmJpbmQoX2V2ZW50VGFyZ2V0KTsKICAgICAgICAgIH0pOwoKICAgICAgdGhpcy5vbmljZWNhbmRpZGF0ZSA9IG51bGw7CiAgICAgIHRoaXMub25hZGRzdHJlYW0gPSBudWxsOwogICAgICB0aGlzLm9udHJhY2sgPSBudWxsOwogICAgICB0aGlzLm9ucmVtb3Zlc3RyZWFtID0gbnVsbDsKICAgICAgdGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlID0gbnVsbDsKICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCA9IG51bGw7CiAgICAgIHRoaXMub25kYXRhY2hhbm5lbCA9IG51bGw7CgogICAgICB0aGlzLmxvY2FsU3RyZWFtcyA9IFtdOwogICAgICB0aGlzLnJlbW90ZVN0cmVhbXMgPSBbXTsKICAgICAgdGhpcy5nZXRMb2NhbFN0cmVhbXMgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gc2VsZi5sb2NhbFN0cmVhbXM7CiAgICAgIH07CiAgICAgIHRoaXMuZ2V0UmVtb3RlU3RyZWFtcyA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBzZWxmLnJlbW90ZVN0cmVhbXM7CiAgICAgIH07CgogICAgICB0aGlzLmxvY2FsRGVzY3JpcHRpb24gPSBuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHsKICAgICAgICB0eXBlOiAnJywKICAgICAgICBzZHA6ICcnCiAgICAgIH0pOwogICAgICB0aGlzLnJlbW90ZURlc2NyaXB0aW9uID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJycsCiAgICAgICAgc2RwOiAnJwogICAgICB9KTsKICAgICAgdGhpcy5zaWduYWxpbmdTdGF0ZSA9ICdzdGFibGUnOwogICAgICB0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSA9ICduZXcnOwogICAgICB0aGlzLmljZUdhdGhlcmluZ1N0YXRlID0gJ25ldyc7CgogICAgICB0aGlzLmljZU9wdGlvbnMgPSB7CiAgICAgICAgZ2F0aGVyUG9saWN5OiAnYWxsJywKICAgICAgICBpY2VTZXJ2ZXJzOiBbXQogICAgICB9OwogICAgICBpZiAoY29uZmlnICYmIGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICBzd2l0Y2ggKGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICAgIGNhc2UgJ2FsbCc6CiAgICAgICAgICBjYXNlICdyZWxheSc6CiAgICAgICAgICAgIHRoaXMuaWNlT3B0aW9ucy5nYXRoZXJQb2xpY3kgPSBjb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgJ25vbmUnOgogICAgICAgICAgICAvLyBGSVhNRTogcmVtb3ZlIG9uY2UgaW1wbGVtZW50YXRpb24gYW5kIHNwZWMgaGF2ZSBhZGRlZCB0aGlzLgogICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpY2VUcmFuc3BvcnRQb2xpY3kgIm5vbmUiIG5vdCBzdXBwb3J0ZWQnKTsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIC8vIGRvbid0IHNldCBpY2VUcmFuc3BvcnRQb2xpY3kuCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnVzaW5nQnVuZGxlID0gY29uZmlnICYmIGNvbmZpZy5idW5kbGVQb2xpY3kgPT09ICdtYXgtYnVuZGxlJzsKCiAgICAgIGlmIChjb25maWcgJiYgY29uZmlnLmljZVNlcnZlcnMpIHsKICAgICAgICAvLyBFZGdlIGRvZXMgbm90IGxpa2UKICAgICAgICAvLyAxKSBzdHVuOgogICAgICAgIC8vIDIpIHR1cm46IHRoYXQgZG9lcyBub3QgaGF2ZSBhbGwgb2YgdHVybjpob3N0OnBvcnQ/dHJhbnNwb3J0PXVkcAogICAgICAgIC8vIDMpIHR1cm46IHdpdGggaXB2NiBhZGRyZXNzZXMKICAgICAgICB2YXIgaWNlU2VydmVycyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29uZmlnLmljZVNlcnZlcnMpKTsKICAgICAgICB0aGlzLmljZU9wdGlvbnMuaWNlU2VydmVycyA9IGljZVNlcnZlcnMuZmlsdGVyKGZ1bmN0aW9uKHNlcnZlcikgewogICAgICAgICAgaWYgKHNlcnZlciAmJiBzZXJ2ZXIudXJscykgewogICAgICAgICAgICB2YXIgdXJscyA9IHNlcnZlci51cmxzOwogICAgICAgICAgICBpZiAodHlwZW9mIHVybHMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgdXJscyA9IFt1cmxzXTsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cmxzID0gdXJscy5maWx0ZXIoZnVuY3Rpb24odXJsKSB7CiAgICAgICAgICAgICAgcmV0dXJuICh1cmwuaW5kZXhPZigndHVybjonKSA9PT0gMCAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHJhbnNwb3J0PXVkcCcpICE9PSAtMSAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHVybjpbJykgPT09IC0xKSB8fAogICAgICAgICAgICAgICAgICAodXJsLmluZGV4T2YoJ3N0dW46JykgPT09IDAgJiYKICAgICAgICAgICAgICAgICAgICBicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE0MzkzKTsKICAgICAgICAgICAgfSlbMF07CiAgICAgICAgICAgIHJldHVybiAhIXVybHM7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnOwoKICAgICAgLy8gcGVyLXRyYWNrIGljZUdhdGhlcnMsIGljZVRyYW5zcG9ydHMsIGR0bHNUcmFuc3BvcnRzLCBydHBTZW5kZXJzLCAuLi4KICAgICAgLy8gZXZlcnl0aGluZyB0aGF0IGlzIG5lZWRlZCB0byBkZXNjcmliZSBhIFNEUCBtLWxpbmUuCiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzID0gW107CgogICAgICAvLyBzaW5jZSB0aGUgaWNlR2F0aGVyZXIgaXMgY3VycmVudGx5IGNyZWF0ZWQgaW4gY3JlYXRlT2ZmZXIgYnV0IHdlCiAgICAgIC8vIG11c3Qgbm90IGVtaXQgY2FuZGlkYXRlcyB1bnRpbCBhZnRlciBzZXRMb2NhbERlc2NyaXB0aW9uIHdlIGJ1ZmZlcgogICAgICAvLyB0aGVtIGluIHRoaXMgYXJyYXkuCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlciA9IFtdOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZScpOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICBpZiAodGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgdGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlKGV2ZW50KTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLmxvY2FsRGVzY3JpcHRpb24uc2RwKTsKICAgICAgLy8gRklYTUU6IG5lZWQgdG8gYXBwbHkgaWNlIGNhbmRpZGF0ZXMgaW4gYSB3YXkgd2hpY2ggaXMgYXN5bmMgYnV0CiAgICAgIC8vIGluLW9yZGVyCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlci5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgdmFyIGVuZCA9ICFldmVudC5jYW5kaWRhdGUgfHwgT2JqZWN0LmtleXMoZXZlbnQuY2FuZGlkYXRlKS5sZW5ndGggPT09IDA7CiAgICAgICAgaWYgKGVuZCkgewogICAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBzZWN0aW9ucy5sZW5ndGg7IGorKykgewogICAgICAgICAgICBpZiAoc2VjdGlvbnNbal0uaW5kZXhPZignXHJcbmE9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJykgPT09IC0xKSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbal0gKz0gJ2E9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWN0aW9uc1tldmVudC5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleCArIDFdICs9CiAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgfQogICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICBzZWxmLm9uaWNlY2FuZGlkYXRlKGV2ZW50KTsKICAgICAgICB9CiAgICAgICAgaWYgKCFldmVudC5jYW5kaWRhdGUgJiYgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSAhPT0gJ2NvbXBsZXRlJykgewogICAgICAgICAgdmFyIGNvbXBsZXRlID0gc2VsZi50cmFuc2NlaXZlcnMuZXZlcnkoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICB0cmFuc2NlaXZlci5pY2VHYXRoZXJlci5zdGF0ZSA9PT0gJ2NvbXBsZXRlZCc7CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChjb21wbGV0ZSAmJiBzZWxmLmljZUdhdGhlcmluZ1N0YXRlQ2hhbmdlICE9PSAnY29tcGxldGUnKSB7CiAgICAgICAgICAgIHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUgPSAnY29tcGxldGUnOwogICAgICAgICAgICBzZWxmLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIgPSBbXTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRDb25maWd1cmF0aW9uID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLl9jb25maWc7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkU3RyZWFtID0gZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE1MDI1KSB7CiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXMucHVzaChzdHJlYW0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIENsb25lIGlzIG5lY2Vzc2FyeSBmb3IgbG9jYWwgZGVtb3MgbW9zdGx5LCBhdHRhY2hpbmcgZGlyZWN0bHkKICAgICAgICAvLyB0byB0d28gZGlmZmVyZW50IHNlbmRlcnMgZG9lcyBub3Qgd29yayAoYnVpbGQgMTA1NDcpLgogICAgICAgIC8vIEZpeGVkIGluIDE1MDI1IChvciBlYXJsaWVyKQogICAgICAgIHZhciBjbG9uZWRTdHJlYW0gPSBzdHJlYW0uY2xvbmUoKTsKICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaywgaWR4KSB7CiAgICAgICAgICB2YXIgY2xvbmVkVHJhY2sgPSBjbG9uZWRTdHJlYW0uZ2V0VHJhY2tzKClbaWR4XTsKICAgICAgICAgIHRyYWNrLmFkZEV2ZW50TGlzdGVuZXIoJ2VuYWJsZWQnLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBjbG9uZWRUcmFjay5lbmFibGVkID0gZXZlbnQuZW5hYmxlZDsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHRoaXMubG9jYWxTdHJlYW1zLnB1c2goY2xvbmVkU3RyZWFtKTsKICAgICAgfQogICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICB2YXIgaWR4ID0gdGhpcy5sb2NhbFN0cmVhbXMuaW5kZXhPZihzdHJlYW0pOwogICAgICBpZiAoaWR4ID4gLTEpIHsKICAgICAgICB0aGlzLmxvY2FsU3RyZWFtcy5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy50cmFuc2NlaXZlcnMuZmlsdGVyKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuICEhdHJhbnNjZWl2ZXIucnRwU2VuZGVyOwogICAgICB9KQogICAgICAubWFwKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLnJ0cFNlbmRlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVjZWl2ZXJzID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLnRyYW5zY2VpdmVycy5maWx0ZXIoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICByZXR1cm4gISF0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSkKICAgICAgLm1hcChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIHJldHVybiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIC8vIERldGVybWluZXMgdGhlIGludGVyc2VjdGlvbiBvZiBsb2NhbCBhbmQgcmVtb3RlIGNhcGFiaWxpdGllcy4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2dldENvbW1vbkNhcGFiaWxpdGllcyA9CiAgICAgICAgZnVuY3Rpb24obG9jYWxDYXBhYmlsaXRpZXMsIHJlbW90ZUNhcGFiaWxpdGllcykgewogICAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHsKICAgICAgICAgICAgY29kZWNzOiBbXSwKICAgICAgICAgICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICAgICAgICAgIGZlY01lY2hhbmlzbXM6IFtdCiAgICAgICAgICB9OwogICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24obENvZGVjKSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3RlQ2FwYWJpbGl0aWVzLmNvZGVjcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIHZhciByQ29kZWMgPSByZW1vdGVDYXBhYmlsaXRpZXMuY29kZWNzW2ldOwogICAgICAgICAgICAgIGlmIChsQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpID09PSByQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpICYmCiAgICAgICAgICAgICAgICAgIGxDb2RlYy5jbG9ja1JhdGUgPT09IHJDb2RlYy5jbG9ja1JhdGUpIHsKICAgICAgICAgICAgICAgIC8vIG51bWJlciBvZiBjaGFubmVscyBpcyB0aGUgaGlnaGVzdCBjb21tb24gbnVtYmVyIG9mIGNoYW5uZWxzCiAgICAgICAgICAgICAgICByQ29kZWMubnVtQ2hhbm5lbHMgPSBNYXRoLm1pbihsQ29kZWMubnVtQ2hhbm5lbHMsCiAgICAgICAgICAgICAgICAgICAgckNvZGVjLm51bUNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIC8vIHB1c2ggckNvZGVjIHNvIHdlIHJlcGx5IHdpdGggb2ZmZXJlciBwYXlsb2FkIHR5cGUKICAgICAgICAgICAgICAgIGNvbW1vbkNhcGFiaWxpdGllcy5jb2RlY3MucHVzaChyQ29kZWMpOwoKICAgICAgICAgICAgICAgIC8vIGRldGVybWluZSBjb21tb24gZmVlZGJhY2sgbWVjaGFuaXNtcwogICAgICAgICAgICAgICAgckNvZGVjLnJ0Y3BGZWVkYmFjayA9IHJDb2RlYy5ydGNwRmVlZGJhY2suZmlsdGVyKGZ1bmN0aW9uKGZiKSB7CiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbENvZGVjLnJ0Y3BGZWVkYmFjay5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGlmIChsQ29kZWMucnRjcEZlZWRiYWNrW2pdLnR5cGUgPT09IGZiLnR5cGUgJiYKICAgICAgICAgICAgICAgICAgICAgICAgbENvZGVjLnJ0Y3BGZWVkYmFja1tqXS5wYXJhbWV0ZXIgPT09IGZiLnBhcmFtZXRlcikgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFsc28gbmVlZCB0byBkZXRlcm1pbmUgLnBhcmFtZXRlcnMKICAgICAgICAgICAgICAgIC8vICBzZWUgaHR0cHM6Ly9naXRodWIuY29tL29wZW5wZWVyL29ydGMvaXNzdWVzLzU2OQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zCiAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obEhlYWRlckV4dGVuc2lvbikgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZW1vdGVDYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9ucy5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgIGkrKykgewogICAgICAgICAgICAgICAgICB2YXIgckhlYWRlckV4dGVuc2lvbiA9IHJlbW90ZUNhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zW2ldOwogICAgICAgICAgICAgICAgICBpZiAobEhlYWRlckV4dGVuc2lvbi51cmkgPT09IHJIZWFkZXJFeHRlbnNpb24udXJpKSB7CiAgICAgICAgICAgICAgICAgICAgY29tbW9uQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMucHVzaChySGVhZGVyRXh0ZW5zaW9uKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgIC8vIEZJWE1FOiBmZWNNZWNoYW5pc21zCiAgICAgICAgICByZXR1cm4gY29tbW9uQ2FwYWJpbGl0aWVzOwogICAgICAgIH07CgogICAgLy8gQ3JlYXRlIElDRSBnYXRoZXJlciwgSUNFIHRyYW5zcG9ydCBhbmQgRFRMUyB0cmFuc3BvcnQuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyA9CiAgICAgICAgZnVuY3Rpb24obWlkLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgaWNlR2F0aGVyZXIgPSBuZXcgUlRDSWNlR2F0aGVyZXIoc2VsZi5pY2VPcHRpb25zKTsKICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSBuZXcgUlRDSWNlVHJhbnNwb3J0KGljZUdhdGhlcmVyKTsKICAgICAgICAgIGljZUdhdGhlcmVyLm9ubG9jYWxjYW5kaWRhdGUgPSBmdW5jdGlvbihldnQpIHsKICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKTsKICAgICAgICAgICAgZXZlbnQuY2FuZGlkYXRlID0ge3NkcE1pZDogbWlkLCBzZHBNTGluZUluZGV4OiBzZHBNTGluZUluZGV4fTsKCiAgICAgICAgICAgIHZhciBjYW5kID0gZXZ0LmNhbmRpZGF0ZTsKICAgICAgICAgICAgdmFyIGVuZCA9ICFjYW5kIHx8IE9iamVjdC5rZXlzKGNhbmQpLmxlbmd0aCA9PT0gMDsKICAgICAgICAgICAgLy8gRWRnZSBlbWl0cyBhbiBlbXB0eSBvYmplY3QgZm9yIFJUQ0ljZUNhbmRpZGF0ZUNvbXBsZXRl4oClCiAgICAgICAgICAgIGlmIChlbmQpIHsKICAgICAgICAgICAgICAvLyBwb2x5ZmlsbCBzaW5jZSBSVENJY2VHYXRoZXJlci5zdGF0ZSBpcyBub3QgaW1wbGVtZW50ZWQgaW4KICAgICAgICAgICAgICAvLyBFZGdlIDEwNTQ3IHlldC4KICAgICAgICAgICAgICBpZiAoaWNlR2F0aGVyZXIuc3RhdGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgaWNlR2F0aGVyZXIuc3RhdGUgPSAnY29tcGxldGVkJzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gUlRDSWNlQ2FuZGlkYXRlIGRvZXNuJ3QgaGF2ZSBhIGNvbXBvbmVudCwgbmVlZHMgdG8gYmUgYWRkZWQKICAgICAgICAgICAgICBjYW5kLmNvbXBvbmVudCA9IGljZVRyYW5zcG9ydC5jb21wb25lbnQgPT09ICdSVENQJyA/IDIgOiAxOwogICAgICAgICAgICAgIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgPSBTRFBVdGlscy53cml0ZUNhbmRpZGF0ZShjYW5kKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdXBkYXRlIGxvY2FsIGRlc2NyaXB0aW9uLgogICAgICAgICAgICB2YXIgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHApOwogICAgICAgICAgICBpZiAoIWVuZCkgewogICAgICAgICAgICAgIHNlY3Rpb25zW2V2ZW50LmNhbmRpZGF0ZS5zZHBNTGluZUluZGV4ICsgMV0gKz0KICAgICAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbZXZlbnQuY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXggKyAxXSArPQogICAgICAgICAgICAgICAgICAnYT1lbmQtb2YtY2FuZGlkYXRlc1xyXG4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IHNlbGYuX3BlbmRpbmdPZmZlciA/IHNlbGYuX3BlbmRpbmdPZmZlciA6CiAgICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyczsKICAgICAgICAgICAgdmFyIGNvbXBsZXRlID0gdHJhbnNjZWl2ZXJzLmV2ZXJ5KGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLnN0YXRlID09PSAnY29tcGxldGVkJzsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBFbWl0IGNhbmRpZGF0ZSBpZiBsb2NhbERlc2NyaXB0aW9uIGlzIHNldC4KICAgICAgICAgICAgLy8gQWxzbyBlbWl0cyBudWxsIGNhbmRpZGF0ZSB3aGVuIGFsbCBnYXRoZXJlcnMgYXJlIGNvbXBsZXRlLgogICAgICAgICAgICBzd2l0Y2ggKHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUpIHsKICAgICAgICAgICAgICBjYXNlICduZXcnOgogICAgICAgICAgICAgICAgaWYgKCFlbmQpIHsKICAgICAgICAgICAgICAgICAgc2VsZi5fbG9jYWxJY2VDYW5kaWRhdGVzQnVmZmVyLnB1c2goZXZlbnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGVuZCAmJiBjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIucHVzaCgKICAgICAgICAgICAgICAgICAgICAgIG5ldyBFdmVudCgnaWNlY2FuZGlkYXRlJykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAnZ2F0aGVyaW5nJzoKICAgICAgICAgICAgICAgIHNlbGYuX2VtaXRCdWZmZXJlZENhbmRpZGF0ZXMoKTsKICAgICAgICAgICAgICAgIGlmICghZW5kKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShldmVudCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKSk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShuZXcgRXZlbnQoJ2ljZWNhbmRpZGF0ZScpKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBzZWxmLmljZUdhdGhlcmluZ1N0YXRlID0gJ2NvbXBsZXRlJzsKICAgICAgICAgICAgICAgICAgc2VsZi5fZW1pdEdhdGhlcmluZ1N0YXRlQ2hhbmdlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlICdjb21wbGV0ZSc6CiAgICAgICAgICAgICAgICAvLyBzaG91bGQgbm90IGhhcHBlbi4uLiBjdXJyZW50bHkhCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBkZWZhdWx0OiAvLyBuby1vcC4KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgaWNlVHJhbnNwb3J0Lm9uaWNlc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHZhciBkdGxzVHJhbnNwb3J0ID0gbmV3IFJUQ0R0bHNUcmFuc3BvcnQoaWNlVHJhbnNwb3J0KTsKICAgICAgICAgIGR0bHNUcmFuc3BvcnQub25kdGxzc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwogICAgICAgICAgZHRsc1RyYW5zcG9ydC5vbmVycm9yID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIC8vIG9uZXJyb3IgZG9lcyBub3Qgc2V0IHN0YXRlIHRvIGZhaWxlZCBieSBpdHNlbGYuCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQuc3RhdGUgPSAnZmFpbGVkJzsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGljZUdhdGhlcmVyOiBpY2VHYXRoZXJlciwKICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiBpY2VUcmFuc3BvcnQsCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IGR0bHNUcmFuc3BvcnQKICAgICAgICAgIH07CiAgICAgICAgfTsKCiAgICAvLyBTdGFydCB0aGUgUlRQIFNlbmRlciBhbmQgUmVjZWl2ZXIgZm9yIGEgdHJhbnNjZWl2ZXIuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl90cmFuc2NlaXZlID0gZnVuY3Rpb24odHJhbnNjZWl2ZXIsCiAgICAgICAgc2VuZCwgcmVjdikgewogICAgICB2YXIgcGFyYW1zID0gdGhpcy5fZ2V0Q29tbW9uQ2FwYWJpbGl0aWVzKHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLAogICAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzKTsKICAgICAgaWYgKHNlbmQgJiYgdHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgcGFyYW1zLmVuY29kaW5ncyA9IHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgcGFyYW1zLnJ0Y3AgPSB7CiAgICAgICAgICBjbmFtZTogU0RQVXRpbHMubG9jYWxDTmFtZQogICAgICAgIH07CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLnJlY3ZFbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoKSB7CiAgICAgICAgICBwYXJhbXMucnRjcC5zc3JjID0gdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjOwogICAgICAgIH0KICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc2VuZChwYXJhbXMpOwogICAgICB9CiAgICAgIGlmIChyZWN2ICYmIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyKSB7CiAgICAgICAgLy8gcmVtb3ZlIFJUWCBmaWVsZCBpbiBFZGdlIDE0OTQyCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmtpbmQgPT09ICd2aWRlbycKICAgICAgICAgICAgJiYgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycykgewogICAgICAgICAgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHApIHsKICAgICAgICAgICAgZGVsZXRlIHAucnR4OwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHBhcmFtcy5lbmNvZGluZ3MgPSB0cmFuc2NlaXZlci5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgIHBhcmFtcy5ydGNwID0gewogICAgICAgICAgY25hbWU6IHRyYW5zY2VpdmVyLmNuYW1lCiAgICAgICAgfTsKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycy5sZW5ndGgpIHsKICAgICAgICAgIHBhcmFtcy5ydGNwLnNzcmMgPSB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmM7CiAgICAgICAgfQogICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnJlY2VpdmUocGFyYW1zKTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb24gPQogICAgICAgIGZ1bmN0aW9uKGRlc2NyaXB0aW9uKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgc2VjdGlvbnM7CiAgICAgICAgICB2YXIgc2Vzc2lvbnBhcnQ7CiAgICAgICAgICBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ29mZmVyJykgewogICAgICAgICAgICAvLyBGSVhNRTogV2hhdCB3YXMgdGhlIHB1cnBvc2Ugb2YgdGhpcyBlbXB0eSBpZiBzdGF0ZW1lbnQ/CiAgICAgICAgICAgIC8vIGlmICghdGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgICAgIC8vIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nT2ZmZXIpIHsKICAgICAgICAgICAgICAvLyBWRVJZIGxpbWl0ZWQgc3VwcG9ydCBmb3IgU0RQIG11bmdpbmcuIExpbWl0ZWQgdG86CiAgICAgICAgICAgICAgLy8gKiBjaGFuZ2luZyB0aGUgb3JkZXIgb2YgY29kZWNzCiAgICAgICAgICAgICAgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKGRlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQgPSBzZWN0aW9ucy5zaGlmdCgpOwogICAgICAgICAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICAgICAgICB2YXIgY2FwcyA9IFNEUFV0aWxzLnBhcnNlUnRwUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICAgICAgc2VsZi5fcGVuZGluZ09mZmVyW3NkcE1MaW5lSW5kZXhdLmxvY2FsQ2FwYWJpbGl0aWVzID0gY2FwczsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0aGlzLnRyYW5zY2VpdmVycyA9IHRoaXMuX3BlbmRpbmdPZmZlcjsKICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcGVuZGluZ09mZmVyOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgICAgIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgIHNlc3Npb25wYXJ0ID0gc2VjdGlvbnMuc2hpZnQoKTsKICAgICAgICAgICAgdmFyIGlzSWNlTGl0ZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgICBzZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKG1lZGlhU2VjdGlvbiwgc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQ7CiAgICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0OwogICAgICAgICAgICAgIHZhciBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwogICAgICAgICAgICAgIHZhciByZW1vdGVDYXBhYmlsaXRpZXMgPSB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IG1lZGlhU2VjdGlvbi5zcGxpdCgnXG4nLCAxKVswXQogICAgICAgICAgICAgICAgICAuc3BsaXQoJyAnLCAyKVsxXSA9PT0gJzAnOwoKICAgICAgICAgICAgICBpZiAoIXJlamVjdGVkICYmICF0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSWNlUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldEljZVBhcmFtZXRlcnMoCiAgICAgICAgICAgICAgICAgICAgbWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCk7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnMgPSBTRFBVdGlscy5nZXREdGxzUGFyYW1ldGVycygKICAgICAgICAgICAgICAgICAgICBtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICAgIGlmIChpc0ljZUxpdGUpIHsKICAgICAgICAgICAgICAgICAgcmVtb3RlRHRsc1BhcmFtZXRlcnMucm9sZSA9ICdzZXJ2ZXInOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydC5zdGFydChpY2VHYXRoZXJlciwgcmVtb3RlSWNlUGFyYW1ldGVycywKICAgICAgICAgICAgICAgICAgICAgIGlzSWNlTGl0ZSA/ICdjb250cm9sbGluZycgOiAnY29udHJvbGxlZCcpOwogICAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgaW50ZXJzZWN0aW9uIG9mIGNhcGFiaWxpdGllcy4KICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSBzZWxmLl9nZXRDb21tb25DYXBhYmlsaXRpZXMobG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgICAgICAgICAgcmVtb3RlQ2FwYWJpbGl0aWVzKTsKCiAgICAgICAgICAgICAgICAvLyBTdGFydCB0aGUgUlRDUnRwU2VuZGVyLiBUaGUgUlRDUnRwUmVjZWl2ZXIgZm9yIHRoaXMKICAgICAgICAgICAgICAgIC8vIHRyYW5zY2VpdmVyIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBpbiBzZXRSZW1vdGVEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmNvZGVjcy5sZW5ndGggPiAwLAogICAgICAgICAgICAgICAgICAgIGZhbHNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMubG9jYWxEZXNjcmlwdGlvbiA9IHsKICAgICAgICAgICAgdHlwZTogZGVzY3JpcHRpb24udHlwZSwKICAgICAgICAgICAgc2RwOiBkZXNjcmlwdGlvbi5zZHAKICAgICAgICAgIH07CiAgICAgICAgICBzd2l0Y2ggKGRlc2NyaXB0aW9uLnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAnb2ZmZXInOgogICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdoYXZlLWxvY2FsLW9mZmVyJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2Fuc3dlcic6CiAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ3N0YWJsZScpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3Vuc3VwcG9ydGVkIHR5cGUgIicgKyBkZXNjcmlwdGlvbi50eXBlICsKICAgICAgICAgICAgICAgICAgJyInKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBJZiBhIHN1Y2Nlc3MgY2FsbGJhY2sgd2FzIHByb3ZpZGVkLCBlbWl0IElDRSBjYW5kaWRhdGVzIGFmdGVyIGl0CiAgICAgICAgICAvLyBoYXMgYmVlbiBleGVjdXRlZC4gT3RoZXJ3aXNlLCBlbWl0IGNhbGxiYWNrIGFmdGVyIHRoZSBQcm9taXNlIGlzCiAgICAgICAgICAvLyByZXNvbHZlZC4KICAgICAgICAgIHZhciBoYXNDYWxsYmFjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmCiAgICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbic7CiAgICAgICAgICBpZiAoaGFzQ2FsbGJhY2spIHsKICAgICAgICAgICAgdmFyIGNiID0gYXJndW1lbnRzWzFdOwogICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICBjYigpOwogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBzZWxmLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzKCk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHAgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICAgIHAudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgaWYgKCFoYXNDYWxsYmFjaykgewogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBVc3VhbGx5IGNhbmRpZGF0ZXMgd2lsbCBiZSBlbWl0dGVkIGVhcmxpZXIuCiAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoc2VsZi5fZW1pdEJ1ZmZlcmVkQ2FuZGlkYXRlcy5iaW5kKHNlbGYpLCA1MDApOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBwOwogICAgICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbiA9CiAgICAgICAgZnVuY3Rpb24oZGVzY3JpcHRpb24pIHsKICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgIHZhciBzdHJlYW0gPSBuZXcgTWVkaWFTdHJlYW0oKTsKICAgICAgICAgIHZhciByZWNlaXZlckxpc3QgPSBbXTsKICAgICAgICAgIHZhciBzZWN0aW9ucyA9IFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMoZGVzY3JpcHRpb24uc2RwKTsKICAgICAgICAgIHZhciBzZXNzaW9ucGFydCA9IHNlY3Rpb25zLnNoaWZ0KCk7CiAgICAgICAgICB2YXIgaXNJY2VMaXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoc2Vzc2lvbnBhcnQsCiAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgdGhpcy51c2luZ0J1bmRsZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICdhPWdyb3VwOkJVTkRMRSAnKS5sZW5ndGggPiAwOwogICAgICAgICAgc2VjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNkcE1MaW5lSW5kZXgpIHsKICAgICAgICAgICAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICB2YXIgbWxpbmUgPSBsaW5lc1swXS5zdWJzdHIoMikuc3BsaXQoJyAnKTsKICAgICAgICAgICAgdmFyIGtpbmQgPSBtbGluZVswXTsKICAgICAgICAgICAgdmFyIHJlamVjdGVkID0gbWxpbmVbMV0gPT09ICcwJzsKICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IFNEUFV0aWxzLmdldERpcmVjdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKCiAgICAgICAgICAgIHZhciBtaWQgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPW1pZDonKTsKICAgICAgICAgICAgaWYgKG1pZC5sZW5ndGgpIHsKICAgICAgICAgICAgICBtaWQgPSBtaWRbMF0uc3Vic3RyKDYpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG1pZCA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBSZWplY3QgZGF0YWNoYW5uZWxzIHdoaWNoIGFyZSBub3QgaW1wbGVtZW50ZWQgeWV0LgogICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2FwcGxpY2F0aW9uJyAmJiBtbGluZVsyXSA9PT0gJ0RUTFMvU0NUUCcpIHsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIG1pZDogbWlkLAogICAgICAgICAgICAgICAgaXNEYXRhY2hhbm5lbDogdHJ1ZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgdHJhbnNjZWl2ZXI7CiAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlcjsKICAgICAgICAgICAgdmFyIGljZVRyYW5zcG9ydDsKICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQ7CiAgICAgICAgICAgIHZhciBydHBTZW5kZXI7CiAgICAgICAgICAgIHZhciBydHBSZWNlaXZlcjsKICAgICAgICAgICAgdmFyIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgICAgIHZhciByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICB2YXIgdHJhY2s7CiAgICAgICAgICAgIC8vIEZJWE1FOiBlbnN1cmUgdGhlIG1lZGlhU2VjdGlvbiBoYXMgcnRjcC1tdXggc2V0LgogICAgICAgICAgICB2YXIgcmVtb3RlQ2FwYWJpbGl0aWVzID0gU0RQVXRpbHMucGFyc2VSdHBQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CiAgICAgICAgICAgIHZhciByZW1vdGVJY2VQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnM7CiAgICAgICAgICAgIGlmICghcmVqZWN0ZWQpIHsKICAgICAgICAgICAgICByZW1vdGVJY2VQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0SWNlUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24sCiAgICAgICAgICAgICAgICAgIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICByZW1vdGVEdGxzUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbiwKICAgICAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQpOwogICAgICAgICAgICAgIHJlbW90ZUR0bHNQYXJhbWV0ZXJzLnJvbGUgPSAnY2xpZW50JzsKICAgICAgICAgICAgfQogICAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgIFNEUFV0aWxzLnBhcnNlUnRwRW5jb2RpbmdQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CgogICAgICAgICAgICB2YXIgY25hbWU7CiAgICAgICAgICAgIC8vIEdldHMgdGhlIGZpcnN0IFNTUkMuIE5vdGUgdGhhdCB3aXRoIFJUWCB0aGVyZSBtaWdodCBiZSBtdWx0aXBsZQogICAgICAgICAgICAvLyBTU1JDcy4KICAgICAgICAgICAgdmFyIHJlbW90ZVNzcmMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNzcmM6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24obGluZSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihvYmopIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iai5hdHRyaWJ1dGUgPT09ICdjbmFtZSc7CiAgICAgICAgICAgICAgICB9KVswXTsKICAgICAgICAgICAgaWYgKHJlbW90ZVNzcmMpIHsKICAgICAgICAgICAgICBjbmFtZSA9IHJlbW90ZVNzcmMudmFsdWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBpc0NvbXBsZXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLAogICAgICAgICAgICAgICAgJ2E9ZW5kLW9mLWNhbmRpZGF0ZXMnLCBzZXNzaW9ucGFydCkubGVuZ3RoID4gMDsKICAgICAgICAgICAgdmFyIGNhbmRzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1jYW5kaWRhdGU6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24oY2FuZCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUoY2FuZCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihjYW5kKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBjYW5kLmNvbXBvbmVudCA9PT0gJzEnOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInICYmICFyZWplY3RlZCkgewogICAgICAgICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiBzZWxmLnRyYW5zY2VpdmVyc1swXS5pY2VHYXRoZXJlciwKICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uaWNlVHJhbnNwb3J0LAogICAgICAgICAgICAgICAgZHRsc1RyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICAgICAgICBpZiAoaXNDb21wbGV0ZSAmJiAoIXNlbGYudXNpbmdCdW5kbGUgfHwgc2RwTUxpbmVJbmRleCA9PT0gMCkpIHsKICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuaWNlVHJhbnNwb3J0LnNldFJlbW90ZUNhbmRpZGF0ZXMoY2FuZHMpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBSZWNlaXZlci5nZXRDYXBhYmlsaXRpZXMoa2luZCk7CgogICAgICAgICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMgPSBbewogICAgICAgICAgICAgICAgc3NyYzogKDIgKiBzZHBNTGluZUluZGV4ICsgMikgKiAxMDAxCiAgICAgICAgICAgICAgfV07CgogICAgICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CgogICAgICAgICAgICAgIHRyYWNrID0gcnRwUmVjZWl2ZXIudHJhY2s7CiAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgIC8vIEZJWE1FOiBub3QgY29ycmVjdCB3aGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBzdHJlYW1zIGJ1dCB0aGF0IGlzCiAgICAgICAgICAgICAgLy8gbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgaW4gdGhpcyBzaGltLgogICAgICAgICAgICAgIHN0cmVhbS5hZGRUcmFjayh0cmFjayk7CgogICAgICAgICAgICAgIC8vIEZJWE1FOiBsb29rIGF0IGRpcmVjdGlvbi4KICAgICAgICAgICAgICBpZiAoc2VsZi5sb2NhbFN0cmVhbXMubGVuZ3RoID4gMCAmJgogICAgICAgICAgICAgICAgICBzZWxmLmxvY2FsU3RyZWFtc1swXS5nZXRUcmFja3MoKS5sZW5ndGggPj0gc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgICAgdmFyIGxvY2FsVHJhY2s7CiAgICAgICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0QXVkaW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2luZCA9PT0gJ3ZpZGVvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0VmlkZW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChsb2NhbFRyYWNrKSB7CiAgICAgICAgICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIobG9jYWxUcmFjaywKICAgICAgICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc3BvcnRzLmljZUdhdGhlcmVyLAogICAgICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmljZVRyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzOiBsb2NhbENhcGFiaWxpdGllcywKICAgICAgICAgICAgICAgIHJlbW90ZUNhcGFiaWxpdGllczogcmVtb3RlQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAgICAgcnRwU2VuZGVyOiBydHBTZW5kZXIsCiAgICAgICAgICAgICAgICBydHBSZWNlaXZlcjogcnRwUmVjZWl2ZXIsCiAgICAgICAgICAgICAgICBraW5kOiBraW5kLAogICAgICAgICAgICAgICAgbWlkOiBtaWQsCiAgICAgICAgICAgICAgICBjbmFtZTogY25hbWUsCiAgICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzOiBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzLAogICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczogcmVjdkVuY29kaW5nUGFyYW1ldGVycwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgLy8gU3RhcnQgdGhlIFJUQ1J0cFJlY2VpdmVyIG5vdy4gVGhlIFJUUFNlbmRlciBpcyBzdGFydGVkIGluCiAgICAgICAgICAgICAgLy8gc2V0TG9jYWxEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICBzZWxmLl90cmFuc2NlaXZlKHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLAogICAgICAgICAgICAgICAgICBmYWxzZSwKICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uID09PSAnc2VuZHJlY3YnIHx8IGRpcmVjdGlvbiA9PT0gJ3NlbmRvbmx5Jyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ2Fuc3dlcicgJiYgIXJlamVjdGVkKSB7CiAgICAgICAgICAgICAgdHJhbnNjZWl2ZXIgPSBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XTsKICAgICAgICAgICAgICBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIGljZVRyYW5zcG9ydCA9IHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydDsKICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0ID0gdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydDsKICAgICAgICAgICAgICBydHBTZW5kZXIgPSB0cmFuc2NlaXZlci5ydHBTZW5kZXI7CiAgICAgICAgICAgICAgcnRwUmVjZWl2ZXIgPSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzID0gdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZW1vdGVDYXBhYmlsaXRpZXMgPQogICAgICAgICAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM7CiAgICAgICAgICAgICAgc2VsZi50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uY25hbWUgPSBjbmFtZTsKCiAgICAgICAgICAgICAgaWYgKChpc0ljZUxpdGUgfHwgaXNDb21wbGV0ZSkgJiYgY2FuZHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc2V0UmVtb3RlQ2FuZGlkYXRlcyhjYW5kcyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc3RhcnQoaWNlR2F0aGVyZXIsIHJlbW90ZUljZVBhcmFtZXRlcnMsCiAgICAgICAgICAgICAgICAgICAgJ2NvbnRyb2xsaW5nJyk7CiAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdyZWN2b25seScsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpOwoKICAgICAgICAgICAgICBpZiAocnRwUmVjZWl2ZXIgJiYKICAgICAgICAgICAgICAgICAgKGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpKSB7CiAgICAgICAgICAgICAgICB0cmFjayA9IHJ0cFJlY2VpdmVyLnRyYWNrOwogICAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgICAgc3RyZWFtLmFkZFRyYWNrKHRyYWNrKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFjdHVhbGx5IHRoZSByZWNlaXZlciBzaG91bGQgYmUgY3JlYXRlZCBsYXRlci4KICAgICAgICAgICAgICAgIGRlbGV0ZSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIHRoaXMucmVtb3RlRGVzY3JpcHRpb24gPSB7CiAgICAgICAgICAgIHR5cGU6IGRlc2NyaXB0aW9uLnR5cGUsCiAgICAgICAgICAgIHNkcDogZGVzY3JpcHRpb24uc2RwCiAgICAgICAgICB9OwogICAgICAgICAgc3dpdGNoIChkZXNjcmlwdGlvbi50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgJ29mZmVyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnaGF2ZS1yZW1vdGUtb2ZmZXInKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnYW5zd2VyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnc3RhYmxlJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigndW5zdXBwb3J0ZWQgdHlwZSAiJyArIGRlc2NyaXB0aW9uLnR5cGUgKwogICAgICAgICAgICAgICAgICAnIicpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHN0cmVhbS5nZXRUcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgICAgc2VsZi5yZW1vdGVTdHJlYW1zLnB1c2goc3RyZWFtKTsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdhZGRzdHJlYW0nKTsKICAgICAgICAgICAgICBldmVudC5zdHJlYW0gPSBzdHJlYW07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgICBpZiAoc2VsZi5vbmFkZHN0cmVhbSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYub25hZGRzdHJlYW0oZXZlbnQpOwogICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZWNlaXZlckxpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CiAgICAgICAgICAgICAgICB2YXIgdHJhY2sgPSBpdGVtWzBdOwogICAgICAgICAgICAgICAgdmFyIHJlY2VpdmVyID0gaXRlbVsxXTsKICAgICAgICAgICAgICAgIHZhciB0cmFja0V2ZW50ID0gbmV3IEV2ZW50KCd0cmFjaycpOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5yZWNlaXZlciA9IHJlY2VpdmVyOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5zdHJlYW1zID0gW3N0cmVhbV07CiAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQodHJhY2tFdmVudCk7CiAgICAgICAgICAgICAgICBpZiAoc2VsZi5vbnRyYWNrICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHNlbGYub250cmFjayh0cmFja0V2ZW50KTsKICAgICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoYXJndW1lbnRzWzFdLCAwKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIC8qIG5vdCB5ZXQKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgICovCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCkgewogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0b3AoKTsKICAgICAgICB9CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBGSVhNRTogY2xlYW4gdXAgdHJhY2tzLCBsb2NhbCBzdHJlYW1zLCByZW1vdGUgc3RyZWFtcywgZXRjCiAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdjbG9zZWQnKTsKICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBzaWduYWxpbmcgc3RhdGUuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl91cGRhdGVTaWduYWxpbmdTdGF0ZSA9CiAgICAgICAgZnVuY3Rpb24obmV3U3RhdGUpIHsKICAgICAgICAgIHRoaXMuc2lnbmFsaW5nU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnc2lnbmFsaW5nc3RhdGVjaGFuZ2UnKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICBpZiAodGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHRoaXMub25zaWduYWxpbmdzdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAvLyBEZXRlcm1pbmUgd2hldGhlciB0byBmaXJlIHRoZSBuZWdvdGlhdGlvbm5lZWRlZCBldmVudC4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX21heWJlRmlyZU5lZ290aWF0aW9uTmVlZGVkID0KICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgIC8vIEZpcmUgYXdheSAoZm9yIG5vdykuCiAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ25lZ290aWF0aW9ubmVlZGVkJyk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgICAgaWYgKHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCAhPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLm9ubmVnb3RpYXRpb25uZWVkZWQoZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBjb25uZWN0aW9uIHN0YXRlLgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fdXBkYXRlQ29ubmVjdGlvblN0YXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIG5ld1N0YXRlOwogICAgICB2YXIgc3RhdGVzID0gewogICAgICAgICduZXcnOiAwLAogICAgICAgIGNsb3NlZDogMCwKICAgICAgICBjb25uZWN0aW5nOiAwLAogICAgICAgIGNoZWNraW5nOiAwLAogICAgICAgIGNvbm5lY3RlZDogMCwKICAgICAgICBjb21wbGV0ZWQ6IDAsCiAgICAgICAgZmFpbGVkOiAwCiAgICAgIH07CiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICBzdGF0ZXNbdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICAgIHN0YXRlc1t0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICB9KTsKICAgICAgLy8gSUNFVHJhbnNwb3J0LmNvbXBsZXRlZCBhbmQgY29ubmVjdGVkIGFyZSB0aGUgc2FtZSBmb3IgdGhpcyBwdXJwb3NlLgogICAgICBzdGF0ZXMuY29ubmVjdGVkICs9IHN0YXRlcy5jb21wbGV0ZWQ7CgogICAgICBuZXdTdGF0ZSA9ICduZXcnOwogICAgICBpZiAoc3RhdGVzLmZhaWxlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdmYWlsZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5jb25uZWN0aW5nID4gMCB8fCBzdGF0ZXMuY2hlY2tpbmcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnY29ubmVjdGluZyc7CiAgICAgIH0gZWxzZSBpZiAoc3RhdGVzLmRpc2Nvbm5lY3RlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdkaXNjb25uZWN0ZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5uZXcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnbmV3JzsKICAgICAgfSBlbHNlIGlmIChzdGF0ZXMuY29ubmVjdGVkID4gMCB8fCBzdGF0ZXMuY29tcGxldGVkID4gMCkgewogICAgICAgIG5ld1N0YXRlID0gJ2Nvbm5lY3RlZCc7CiAgICAgIH0KCiAgICAgIGlmIChuZXdTdGF0ZSAhPT0gc2VsZi5pY2VDb25uZWN0aW9uU3RhdGUpIHsKICAgICAgICBzZWxmLmljZUNvbm5lY3Rpb25TdGF0ZSA9IG5ld1N0YXRlOwogICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlJyk7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICBpZiAodGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSAhPT0gbnVsbCkgewogICAgICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY3JlYXRlT2ZmZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAodGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjcmVhdGVPZmZlciBjYWxsZWQgd2hpbGUgdGhlcmUgaXMgYSBwZW5kaW5nIG9mZmVyLicpOwogICAgICB9CiAgICAgIHZhciBvZmZlck9wdGlvbnM7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpIHsKICAgICAgICBvZmZlck9wdGlvbnMgPSBhcmd1bWVudHNbMF07CiAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykgewogICAgICAgIG9mZmVyT3B0aW9ucyA9IGFyZ3VtZW50c1syXTsKICAgICAgfQoKICAgICAgdmFyIHRyYWNrcyA9IFtdOwogICAgICB2YXIgbnVtQXVkaW9UcmFja3MgPSAwOwogICAgICB2YXIgbnVtVmlkZW9UcmFja3MgPSAwOwogICAgICAvLyBEZWZhdWx0IHRvIHNlbmRyZWN2LgogICAgICBpZiAodGhpcy5sb2NhbFN0cmVhbXMubGVuZ3RoKSB7CiAgICAgICAgbnVtQXVkaW9UcmFja3MgPSB0aGlzLmxvY2FsU3RyZWFtc1swXS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aDsKICAgICAgICBudW1WaWRlb1RyYWNrcyA9IHRoaXMubG9jYWxTdHJlYW1zWzBdLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoOwogICAgICB9CiAgICAgIC8vIERldGVybWluZSBudW1iZXIgb2YgYXVkaW8gYW5kIHZpZGVvIHRyYWNrcyB3ZSBuZWVkIHRvIHNlbmQvcmVjdi4KICAgICAgaWYgKG9mZmVyT3B0aW9ucykgewogICAgICAgIC8vIFJlamVjdCBDaHJvbWUgbGVnYWN5IGNvbnN0cmFpbnRzLgogICAgICAgIGlmIChvZmZlck9wdGlvbnMubWFuZGF0b3J5IHx8IG9mZmVyT3B0aW9ucy5vcHRpb25hbCkgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigKICAgICAgICAgICAgICAnTGVnYWN5IG1hbmRhdG9yeS9vcHRpb25hbCBjb25zdHJhaW50cyBub3Qgc3VwcG9ydGVkLicpOwogICAgICAgIH0KICAgICAgICBpZiAob2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgbnVtQXVkaW9UcmFja3MgPSBvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbzsKICAgICAgICB9CiAgICAgICAgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzID0gb2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlVmlkZW87CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmxvY2FsU3RyZWFtcy5sZW5ndGgpIHsKICAgICAgICAvLyBQdXNoIGxvY2FsIHN0cmVhbXMuCiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXNbMF0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiB0cmFjay5raW5kLAogICAgICAgICAgICB0cmFjazogdHJhY2ssCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cmFjay5raW5kID09PSAnYXVkaW8nID8KICAgICAgICAgICAgICAgIG51bUF1ZGlvVHJhY2tzID4gMCA6IG51bVZpZGVvVHJhY2tzID4gMAogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAodHJhY2sua2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgICAgfSBlbHNlIGlmICh0cmFjay5raW5kID09PSAndmlkZW8nKSB7CiAgICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgLy8gQ3JlYXRlIE0tbGluZXMgZm9yIHJlY3Zvbmx5IHN0cmVhbXMuCiAgICAgIHdoaWxlIChudW1BdWRpb1RyYWNrcyA+IDAgfHwgbnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgaWYgKG51bUF1ZGlvVHJhY2tzID4gMCkgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiAnYXVkaW8nLAogICAgICAgICAgICB3YW50UmVjZWl2ZTogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgIH0KICAgICAgICBpZiAobnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgICB0cmFja3MucHVzaCh7CiAgICAgICAgICAgIGtpbmQ6ICd2aWRlbycsCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUoKTsKICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IFtdOwogICAgICB0cmFja3MuZm9yRWFjaChmdW5jdGlvbihtbGluZSwgc2RwTUxpbmVJbmRleCkgewogICAgICAgIC8vIEZvciBlYWNoIHRyYWNrLCBjcmVhdGUgYW4gaWNlIGdhdGhlcmVyLCBpY2UgdHJhbnNwb3J0LAogICAgICAgIC8vIGR0bHMgdHJhbnNwb3J0LCBwb3RlbnRpYWxseSBydHBzZW5kZXIgYW5kIHJ0cHJlY2VpdmVyLgogICAgICAgIHZhciB0cmFjayA9IG1saW5lLnRyYWNrOwogICAgICAgIHZhciBraW5kID0gbWxpbmUua2luZDsKICAgICAgICB2YXIgbWlkID0gU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyKCk7CgogICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc2NlaXZlcnNbMF0uaWNlR2F0aGVyZXIsCiAgICAgICAgICBpY2VUcmFuc3BvcnQ6IHRyYW5zY2VpdmVyc1swXS5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBTZW5kZXIuZ2V0Q2FwYWJpbGl0aWVzKGtpbmQpOwogICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgfSk7CiAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgICAgICAgIC8vIHdvcmsgYXJvdW5kIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD02NTUyCiAgICAgICAgICAvLyBieSBhZGRpbmcgbGV2ZWwtYXN5bW1ldHJ5LWFsbG93ZWQ9MQogICAgICAgICAgaWYgKGNvZGVjLm5hbWUgPT09ICdIMjY0JyAmJgogICAgICAgICAgICAgIGNvZGVjLnBhcmFtZXRlcnNbJ2xldmVsLWFzeW1tZXRyeS1hbGxvd2VkJ10gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb2RlYy5wYXJhbWV0ZXJzWydsZXZlbC1hc3ltbWV0cnktYWxsb3dlZCddID0gJzEnOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICB2YXIgcnRwU2VuZGVyOwogICAgICAgIHZhciBydHBSZWNlaXZlcjsKCiAgICAgICAgLy8gZ2VuZXJhdGUgYW4gc3NyYyBub3csIHRvIGJlIHVzZWQgbGF0ZXIgaW4gcnRwU2VuZGVyLnNlbmQKICAgICAgICB2YXIgc2VuZEVuY29kaW5nUGFyYW1ldGVycyA9IFt7CiAgICAgICAgICBzc3JjOiAoMiAqIHNkcE1MaW5lSW5kZXggKyAxKSAqIDEwMDEKICAgICAgICB9XTsKICAgICAgICBpZiAodHJhY2spIHsKICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIodHJhY2ssIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgfQoKICAgICAgICBpZiAobWxpbmUud2FudFJlY2VpdmUpIHsKICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CiAgICAgICAgfQoKICAgICAgICB0cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0gPSB7CiAgICAgICAgICBpY2VHYXRoZXJlcjogdHJhbnNwb3J0cy5pY2VHYXRoZXJlciwKICAgICAgICAgIGljZVRyYW5zcG9ydDogdHJhbnNwb3J0cy5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmR0bHNUcmFuc3BvcnQsCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllczogbG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM6IG51bGwsCiAgICAgICAgICBydHBTZW5kZXI6IHJ0cFNlbmRlciwKICAgICAgICAgIHJ0cFJlY2VpdmVyOiBydHBSZWNlaXZlciwKICAgICAgICAgIGtpbmQ6IGtpbmQsCiAgICAgICAgICBtaWQ6IG1pZCwKICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM6IHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMsCiAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOiBudWxsCiAgICAgICAgfTsKICAgICAgfSk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdHJhbnNjZWl2ZXJzLm1hcChmdW5jdGlvbih0KSB7CiAgICAgICAgICByZXR1cm4gdC5taWQ7CiAgICAgICAgfSkuam9pbignICcpICsgJ1xyXG4nOwogICAgICB9CiAgICAgIHRyYWNrcy5mb3JFYWNoKGZ1bmN0aW9uKG1saW5lLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgdmFyIHRyYW5zY2VpdmVyID0gdHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsICdvZmZlcicsIHNlbGYubG9jYWxTdHJlYW1zWzBdKTsKICAgICAgfSk7CgogICAgICB0aGlzLl9wZW5kaW5nT2ZmZXIgPSB0cmFuc2NlaXZlcnM7CiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ29mZmVyJywKICAgICAgICBzZHA6IHNkcAogICAgICB9KTsKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGFyZ3VtZW50c1swXSwgMCwgZGVzYyk7CiAgICAgIH0KICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZXNjKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVBbnN3ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlU2Vzc2lvbkJvaWxlcnBsYXRlKCk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdGhpcy50cmFuc2NlaXZlcnMubWFwKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgIHJldHVybiB0Lm1pZDsKICAgICAgICB9KS5qb2luKCcgJykgKyAnXHJcbic7CiAgICAgIH0KICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIGlmICh0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICBzZHAgKz0gJ209YXBwbGljYXRpb24gMCBEVExTL1NDVFAgNTAwMFxyXG4nICsKICAgICAgICAgICAgICAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nICsKICAgICAgICAgICAgICAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gQ2FsY3VsYXRlIGludGVyc2VjdGlvbiBvZiBjYXBhYmlsaXRpZXMuCiAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHNlbGYuX2dldENvbW1vbkNhcGFiaWxpdGllcygKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgIHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcyk7CgogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwgY29tbW9uQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAnYW5zd2VyJywgc2VsZi5sb2NhbFN0cmVhbXNbMF0pOwogICAgICB9KTsKCiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ2Fuc3dlcicsCiAgICAgICAgc2RwOiBzZHAKICAgICAgfSk7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMF0sIDAsIGRlc2MpOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGVzYyk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oY2FuZGlkYXRlKSB7CiAgICAgIGlmICghY2FuZGlkYXRlKSB7CiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnRyYW5zY2VpdmVycy5sZW5ndGg7IGorKykgewogICAgICAgICAgdGhpcy50cmFuc2NlaXZlcnNbal0uaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZSh7fSk7CiAgICAgICAgICBpZiAodGhpcy51c2luZ0J1bmRsZSkgewogICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBtTGluZUluZGV4ID0gY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXg7CiAgICAgICAgaWYgKGNhbmRpZGF0ZS5zZHBNaWQpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFuc2NlaXZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNjZWl2ZXJzW2ldLm1pZCA9PT0gY2FuZGlkYXRlLnNkcE1pZCkgewogICAgICAgICAgICAgIG1MaW5lSW5kZXggPSBpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHRoaXMudHJhbnNjZWl2ZXJzW21MaW5lSW5kZXhdOwogICAgICAgIGlmICh0cmFuc2NlaXZlcikgewogICAgICAgICAgdmFyIGNhbmQgPSBPYmplY3Qua2V5cyhjYW5kaWRhdGUuY2FuZGlkYXRlKS5sZW5ndGggPiAwID8KICAgICAgICAgICAgICBTRFBVdGlscy5wYXJzZUNhbmRpZGF0ZShjYW5kaWRhdGUuY2FuZGlkYXRlKSA6IHt9OwogICAgICAgICAgLy8gSWdub3JlIENocm9tZSdzIGludmFsaWQgY2FuZGlkYXRlcyBzaW5jZSBFZGdlIGRvZXMgbm90IGxpa2UgdGhlbS4KICAgICAgICAgIGlmIChjYW5kLnByb3RvY29sID09PSAndGNwJyAmJiAoY2FuZC5wb3J0ID09PSAwIHx8IGNhbmQucG9ydCA9PT0gOSkpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgLy8gSWdub3JlIFJUQ1AgY2FuZGlkYXRlcywgd2UgYXNzdW1lIFJUQ1AtTVVYLgogICAgICAgICAgaWYgKGNhbmQuY29tcG9uZW50ICE9PSAnMScpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZShjYW5kKTsKCiAgICAgICAgICAvLyB1cGRhdGUgdGhlIHJlbW90ZURlc2NyaXB0aW9uLgogICAgICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyh0aGlzLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICBzZWN0aW9uc1ttTGluZUluZGV4ICsgMV0gKz0gKGNhbmQudHlwZSA/IGNhbmRpZGF0ZS5jYW5kaWRhdGUudHJpbSgpCiAgICAgICAgICAgICAgOiAnYT1lbmQtb2YtY2FuZGlkYXRlcycpICsgJ1xyXG4nOwogICAgICAgICAgdGhpcy5yZW1vdGVEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMV0sIDApOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcHJvbWlzZXMgPSBbXTsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIFsncnRwU2VuZGVyJywgJ3J0cFJlY2VpdmVyJywgJ2ljZUdhdGhlcmVyJywgJ2ljZVRyYW5zcG9ydCcsCiAgICAgICAgICAgICdkdGxzVHJhbnNwb3J0J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgICBpZiAodHJhbnNjZWl2ZXJbbWV0aG9kXSkgewogICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0cmFuc2NlaXZlclttZXRob2RdLmdldFN0YXRzKCkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB2YXIgY2IgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnZnVuY3Rpb24nICYmCiAgICAgICAgICBhcmd1bWVudHNbMV07CiAgICAgIHZhciBmaXhTdGF0c1R5cGUgPSBmdW5jdGlvbihzdGF0KSB7CiAgICAgICAgc3RhdC50eXBlID0gewogICAgICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgICAgIG91dGJvdW5kcnRwOiAnb3V0Ym91bmQtcnRwJywKICAgICAgICAgIGNhbmRpZGF0ZXBhaXI6ICdjYW5kaWRhdGUtcGFpcicsCiAgICAgICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgIH1bc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgcmV0dXJuIHN0YXQ7CiAgICAgIH07CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICAgIHZhciByZXN1bHRzID0gbmV3IE1hcCgpOwogICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKHJlcykgewogICAgICAgICAgcmVzLmZvckVhY2goZnVuY3Rpb24ocmVzdWx0KSB7CiAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlc3VsdCkuZm9yRWFjaChmdW5jdGlvbihpZCkgewogICAgICAgICAgICAgIHJlc3VsdFtpZF0udHlwZSA9IGZpeFN0YXRzVHlwZShyZXN1bHRbaWRdKTsKICAgICAgICAgICAgICByZXN1bHRzLnNldChpZCwgcmVzdWx0W2lkXSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoY2IpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoY2IsIDAsIHJlc3VsdHMpOwogICAgICAgICAgfQogICAgICAgICAgcmVzb2x2ZShyZXN1bHRzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KfTsKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbVBlZXJDb25uZWN0aW9uOiBlZGdlU2hpbS5zaGltUGVlckNvbm5lY3Rpb24sCiAgc2hpbUdldFVzZXJNZWRpYTogcmVxdWlyZSgnLi9nZXR1c2VybWVkaWEnKQp9OwoKfSx7Ii4uL3V0aWxzIjoxMSwiLi9nZXR1c2VybWVkaWEiOjcsInNkcCI6MX1dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7UGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJ31bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50LAogICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTsKICAgICAgfQogICAgfTsKICB9OwoKICAvLyBnZXRVc2VyTWVkaWEgZXJyb3Igc2hpbS4KICB2YXIgb3JpZ0dldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhLgogICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oYykgewogICAgcmV0dXJuIG9yaWdHZXRVc2VyTWVkaWEoYykuY2F0Y2goZnVuY3Rpb24oZSkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3Qoc2hpbUVycm9yXyhlKSk7CiAgICB9KTsKICB9Owp9OwoKfSx7fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgZmlyZWZveFNoaW0gPSB7CiAgc2hpbU9uVHJhY2s6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnICYmIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiAmJiAhKCdvbnRyYWNrJyBpbgogICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnb250cmFjaycsIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX29udHJhY2s7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKGYpIHsKICAgICAgICAgIGlmICh0aGlzLl9vbnRyYWNrKSB7CiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrKTsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgdGhpcy5fb250cmFjayA9IGYpOwogICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgZS5zdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTsKICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAoKICBzaGltU291cmNlT2JqZWN0OiBmdW5jdGlvbigpIHsKICAgIC8vIEZpcmVmb3ggaGFzIHN1cHBvcnRlZCBtb3pTcmNPYmplY3Qgc2luY2UgRkYyMiwgdW5wcmVmaXhlZCBpbiA0Mi4KICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgewogICAgICBpZiAod2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAhKCdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgICAvLyBTaGltIHRoZSBzcmNPYmplY3QgcHJvcGVydHksIG9uY2UsIHdoZW4gSFRNTE1lZGlhRWxlbWVudCBpcyBmb3VuZC4KICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLCAnc3JjT2JqZWN0JywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMubW96U3JjT2JqZWN0OwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgICAgIHRoaXMubW96U3JjT2JqZWN0ID0gc3RyZWFtOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAnb2JqZWN0JyB8fCAhKHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiB8fAogICAgICAgIHdpbmRvdy5tb3pSVENQZWVyQ29ubmVjdGlvbikpIHsKICAgICAgcmV0dXJuOyAvLyBwcm9iYWJseSBtZWRpYS5wZWVyY29ubmVjdGlvbi5lbmFibGVkPWZhbHNlIGluIGFib3V0OmNvbmZpZwogICAgfQogICAgLy8gVGhlIFJUQ1BlZXJDb25uZWN0aW9uIG9iamVjdC4KICAgIGlmICghd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uKSB7CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiA9IGZ1bmN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKSB7CiAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICAgICAgLy8gLnVybHMgaXMgbm90IHN1cHBvcnRlZCBpbiBGRiA8IDM4LgogICAgICAgICAgLy8gY3JlYXRlIFJUQ0ljZVNlcnZlcnMgd2l0aCBhIHNpbmdsZSB1cmwuCiAgICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlU2VydmVycykgewogICAgICAgICAgICB2YXIgbmV3SWNlU2VydmVycyA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBjQ29uZmlnLmljZVNlcnZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICB2YXIgc2VydmVyID0gcGNDb25maWcuaWNlU2VydmVyc1tpXTsKICAgICAgICAgICAgICBpZiAoc2VydmVyLmhhc093blByb3BlcnR5KCd1cmxzJykpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VydmVyLnVybHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgdmFyIG5ld1NlcnZlciA9IHsKICAgICAgICAgICAgICAgICAgICB1cmw6IHNlcnZlci51cmxzW2pdCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIGlmIChzZXJ2ZXIudXJsc1tqXS5pbmRleE9mKCd0dXJuJykgPT09IDApIHsKICAgICAgICAgICAgICAgICAgICBuZXdTZXJ2ZXIudXNlcm5hbWUgPSBzZXJ2ZXIudXNlcm5hbWU7CiAgICAgICAgICAgICAgICAgICAgbmV3U2VydmVyLmNyZWRlbnRpYWwgPSBzZXJ2ZXIuY3JlZGVudGlhbDsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBuZXdJY2VTZXJ2ZXJzLnB1c2gobmV3U2VydmVyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV3SWNlU2VydmVycy5wdXNoKHBjQ29uZmlnLmljZVNlcnZlcnNbaV0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBwY0NvbmZpZy5pY2VTZXJ2ZXJzID0gbmV3SWNlU2VydmVyczsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBtb3pSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSBtb3pSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CgogICAgICAvLyB3cmFwIHN0YXRpYyBtZXRob2RzLiBDdXJyZW50bHkganVzdCBnZW5lcmF0ZUNlcnRpZmljYXRlLgogICAgICBpZiAobW96UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24sICdnZW5lcmF0ZUNlcnRpZmljYXRlJywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIG1velJUQ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24gPSBtb3pSVENTZXNzaW9uRGVzY3JpcHRpb247CiAgICAgIHdpbmRvdy5SVENJY2VDYW5kaWRhdGUgPSBtb3pSVENJY2VDYW5kaWRhdGU7CiAgICB9CgogICAgLy8gc2hpbSBhd2F5IG5lZWQgZm9yIG9ic29sZXRlIFJUQ0ljZUNhbmRpZGF0ZS9SVENTZXNzaW9uRGVzY3JpcHRpb24uCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgdmFyIG1ha2VNYXBTdGF0cyA9IGZ1bmN0aW9uKHN0YXRzKSB7CiAgICAgIHZhciBtYXAgPSBuZXcgTWFwKCk7CiAgICAgIE9iamVjdC5rZXlzKHN0YXRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIG1hcC5zZXQoa2V5LCBzdGF0c1trZXldKTsKICAgICAgICBtYXBba2V5XSA9IHN0YXRzW2tleV07CiAgICAgIH0pOwogICAgICByZXR1cm4gbWFwOwogICAgfTsKCiAgICB2YXIgbW9kZXJuU3RhdHNUeXBlcyA9IHsKICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgb3V0Ym91bmRydHA6ICdvdXRib3VuZC1ydHAnLAogICAgICBjYW5kaWRhdGVwYWlyOiAnY2FuZGlkYXRlLXBhaXInLAogICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgIHJlbW90ZWNhbmRpZGF0ZTogJ3JlbW90ZS1jYW5kaWRhdGUnCiAgICB9OwoKICAgIHZhciBuYXRpdmVHZXRTdGF0cyA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0czsKICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBvblN1Y2MsIG9uRXJyKSB7CiAgICAgIHJldHVybiBuYXRpdmVHZXRTdGF0cy5hcHBseSh0aGlzLCBbc2VsZWN0b3IgfHwgbnVsbF0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNDgpIHsKICAgICAgICAgICAgc3RhdHMgPSBtYWtlTWFwU3RhdHMoc3RhdHMpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MyAmJiAhb25TdWNjKSB7CiAgICAgICAgICAgIC8vIFNoaW0gb25seSBwcm9taXNlIGdldFN0YXRzIHdpdGggc3BlYy1oeXBoZW5zIGluIHR5cGUgbmFtZXMKICAgICAgICAgICAgLy8gTGVhdmUgY2FsbGJhY2sgdmVyc2lvbiBhbG9uZTsgbWlzYyBvbGQgdXNlcyBvZiBmb3JFYWNoIGJlZm9yZSBNYXAKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBzdGF0cy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXQpIHsKICAgICAgICAgICAgICAgIHN0YXQudHlwZSA9IG1vZGVyblN0YXRzVHlwZXNbc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICBpZiAoZS5uYW1lICE9PSAnVHlwZUVycm9yJykgewogICAgICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gQXZvaWQgVHlwZUVycm9yOiAidHlwZSIgaXMgcmVhZC1vbmx5LCBpbiBvbGQgdmVyc2lvbnMuIDM0LTQzaXNoCiAgICAgICAgICAgICAgc3RhdHMuZm9yRWFjaChmdW5jdGlvbihzdGF0LCBpKSB7CiAgICAgICAgICAgICAgICBzdGF0cy5zZXQoaSwgT2JqZWN0LmFzc2lnbih7fSwgc3RhdCwgewogICAgICAgICAgICAgICAgICB0eXBlOiBtb2Rlcm5TdGF0c1R5cGVzW3N0YXQudHlwZV0gfHwgc3RhdC50eXBlCiAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBzdGF0czsKICAgICAgICB9KQogICAgICAgIC50aGVuKG9uU3VjYywgb25FcnIpOwogICAgfTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1PblRyYWNrOiBmaXJlZm94U2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBmaXJlZm94U2hpbS5zaGltU291cmNlT2JqZWN0LAogIHNoaW1QZWVyQ29ubmVjdGlvbjogZmlyZWZveFNoaW0uc2hpbVBlZXJDb25uZWN0aW9uLAogIHNoaW1HZXRVc2VyTWVkaWE6IHJlcXVpcmUoJy4vZ2V0dXNlcm1lZGlhJykKfTsKCn0seyIuLi91dGlscyI6MTEsIi4vZ2V0dXNlcm1lZGlhIjo5fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7CiAgICAgICAgU2VjdXJpdHlFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgUGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJwogICAgICB9W2UubmFtZV0gfHwgZS5uYW1lLAogICAgICBtZXNzYWdlOiB7CiAgICAgICAgJ1RoZSBvcGVyYXRpb24gaXMgaW5zZWN1cmUuJzogJ1RoZSByZXF1ZXN0IGlzIG5vdCBhbGxvd2VkIGJ5IHRoZSAnICsKICAgICAgICAndXNlciBhZ2VudCBvciB0aGUgcGxhdGZvcm0gaW4gdGhlIGN1cnJlbnQgY29udGV4dC4nCiAgICAgIH1bZS5tZXNzYWdlXSB8fCBlLm1lc3NhZ2UsCiAgICAgIGNvbnN0cmFpbnQ6IGUuY29uc3RyYWludCwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIC8vIGdldFVzZXJNZWRpYSBjb25zdHJhaW50cyBzaGltLgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgdmFyIGNvbnN0cmFpbnRzVG9GRjM3XyA9IGZ1bmN0aW9uKGMpIHsKICAgICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLnJlcXVpcmUpIHsKICAgICAgICByZXR1cm4gYzsKICAgICAgfQogICAgICB2YXIgcmVxdWlyZSA9IFtdOwogICAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIGlmIChrZXkgPT09ICdyZXF1aXJlJyB8fCBrZXkgPT09ICdhZHZhbmNlZCcgfHwga2V5ID09PSAnbWVkaWFTb3VyY2UnKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciByID0gY1trZXldID0gKHR5cGVvZiBjW2tleV0gPT09ICdvYmplY3QnKSA/CiAgICAgICAgICAgIGNba2V5XSA6IHtpZGVhbDogY1trZXldfTsKICAgICAgICBpZiAoci5taW4gIT09IHVuZGVmaW5lZCB8fAogICAgICAgICAgICByLm1heCAhPT0gdW5kZWZpbmVkIHx8IHIuZXhhY3QgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmVxdWlyZS5wdXNoKGtleSk7CiAgICAgICAgfQogICAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmICh0eXBlb2Ygci5leGFjdCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgci4gbWluID0gci5tYXggPSByLmV4YWN0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY1trZXldID0gci5leGFjdDsKICAgICAgICAgIH0KICAgICAgICAgIGRlbGV0ZSByLmV4YWN0OwogICAgICAgIH0KICAgICAgICBpZiAoci5pZGVhbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBjLmFkdmFuY2VkID0gYy5hZHZhbmNlZCB8fCBbXTsKICAgICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgICAgaWYgKHR5cGVvZiByLmlkZWFsID09PSAnbnVtYmVyJykgewogICAgICAgICAgICBvY1trZXldID0ge21pbjogci5pZGVhbCwgbWF4OiByLmlkZWFsfTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9jW2tleV0gPSByLmlkZWFsOwogICAgICAgICAgfQogICAgICAgICAgYy5hZHZhbmNlZC5wdXNoKG9jKTsKICAgICAgICAgIGRlbGV0ZSByLmlkZWFsOwogICAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhyKS5sZW5ndGgpIHsKICAgICAgICAgICAgZGVsZXRlIGNba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAocmVxdWlyZS5sZW5ndGgpIHsKICAgICAgICBjLnJlcXVpcmUgPSByZXF1aXJlOwogICAgICB9CiAgICAgIHJldHVybiBjOwogICAgfTsKICAgIGNvbnN0cmFpbnRzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICBsb2dnaW5nKCdzcGVjOiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgICAgaWYgKGNvbnN0cmFpbnRzLmF1ZGlvKSB7CiAgICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvRkYzN18oY29uc3RyYWludHMuYXVkaW8pOwogICAgICB9CiAgICAgIGlmIChjb25zdHJhaW50cy52aWRlbykgewogICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0ZGMzdfKGNvbnN0cmFpbnRzLnZpZGVvKTsKICAgICAgfQogICAgICBsb2dnaW5nKCdmZjM3OiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgIH0KICAgIHJldHVybiBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzLCBvblN1Y2Nlc3MsIGZ1bmN0aW9uKGUpIHsKICAgICAgb25FcnJvcihzaGltRXJyb3JfKGUpKTsKICAgIH0pOwogIH07CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGdldFVzZXJNZWRpYV8oY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICAvLyBTaGltIGZvciBtZWRpYURldmljZXMgb24gb2xkZXIgdmVyc2lvbnMuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKSB7CiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzID0ge2dldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKCkgeyB9LAogICAgICByZW1vdmVFdmVudExpc3RlbmVyOiBmdW5jdGlvbigpIHsgfQogICAgfTsKICB9CiAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzID0KICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzIHx8IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIgaW5mb3MgPSBbCiAgICAgICAgICAgIHtraW5kOiAnYXVkaW9pbnB1dCcsIGRldmljZUlkOiAnZGVmYXVsdCcsIGxhYmVsOiAnJywgZ3JvdXBJZDogJyd9LAogICAgICAgICAgICB7a2luZDogJ3ZpZGVvaW5wdXQnLCBkZXZpY2VJZDogJ2RlZmF1bHQnLCBsYWJlbDogJycsIGdyb3VwSWQ6ICcnfQogICAgICAgICAgXTsKICAgICAgICAgIHJlc29sdmUoaW5mb3MpOwogICAgICAgIH0pOwogICAgICB9OwoKICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDQxKSB7CiAgICAvLyBXb3JrIGFyb3VuZCBodHRwOi8vYnVnemlsLmxhLzExNjk2NjUKICAgIHZhciBvcmdFbnVtZXJhdGVEZXZpY2VzID0KICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMuYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gb3JnRW51bWVyYXRlRGV2aWNlcygpLnRoZW4odW5kZWZpbmVkLCBmdW5jdGlvbihlKSB7CiAgICAgICAgaWYgKGUubmFtZSA9PT0gJ05vdEZvdW5kRXJyb3InKSB7CiAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgfQogICAgICAgIHRocm93IGU7CiAgICAgIH0pOwogICAgfTsKICB9CiAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0OSkgewogICAgdmFyIG9yaWdHZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYS4KICAgICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjKSB7CiAgICAgIHJldHVybiBvcmlnR2V0VXNlck1lZGlhKGMpLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgLy8gV29yayBhcm91bmQgaHR0cHM6Ly9idWd6aWwubGEvODAyMzI2CiAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICBjLnZpZGVvICYmICFzdHJlYW0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7CiAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgIH0pOwogICAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignVGhlIG9iamVjdCBjYW4gbm90IGJlIGZvdW5kIGhlcmUuJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ05vdEZvdW5kRXJyb3InKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cmVhbTsKICAgICAgfSwgZnVuY3Rpb24oZSkgewogICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgfSk7CiAgICB9OwogIH0KICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0NCkgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhXyhjb25zdHJhaW50cywgb25TdWNjZXNzLCBvbkVycm9yKTsKICAgIH0KICAgIC8vIFJlcGxhY2UgRmlyZWZveCA0NCsncyBkZXByZWNhdGlvbiB3YXJuaW5nIHdpdGggdW5wcmVmaXhlZCB2ZXJzaW9uLgogICAgY29uc29sZS53YXJuKCduYXZpZ2F0b3IuZ2V0VXNlck1lZGlhIGhhcyBiZWVuIHJlcGxhY2VkIGJ5ICcgKwogICAgICAgICAgICAgICAgICduYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYScpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTsKICB9Owp9OwoKfSx7Ii4uL3V0aWxzIjoxMX1dLDEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLyoKICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICoKICogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlIGxpY2Vuc2UKICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZQogKiAgdHJlZS4KICovCid1c2Ugc3RyaWN0JzsKdmFyIHNhZmFyaVNoaW0gPSB7CiAgLy8gVE9ETzogRHJBbGV4LCBzaG91bGQgYmUgaGVyZSwgZG91YmxlIGNoZWNrIGFnYWluc3QgTGF5b3V0VGVzdHMKICAvLyBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7IH0sCgogIC8vIFRPRE86IG9uY2UgdGhlIGJhY2stZW5kIGZvciB0aGUgbWFjIHBvcnQgaXMgZG9uZSwgYWRkLgogIC8vIFRPRE86IGNoZWNrIGZvciB3ZWJraXRHVEsrCiAgLy8gc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsgfSwKCiAgc2hpbUdldFVzZXJNZWRpYTogZnVuY3Rpb24oKSB7CiAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1HZXRVc2VyTWVkaWE6IHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYQogIC8vIFRPRE8KICAvLyBzaGltT25UcmFjazogc2FmYXJpU2hpbS5zaGltT25UcmFjaywKICAvLyBzaGltUGVlckNvbm5lY3Rpb246IHNhZmFyaVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uCn07Cgp9LHt9XSwxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dEaXNhYmxlZF8gPSB0cnVlOwoKLy8gVXRpbGl0eSBtZXRob2RzLgp2YXIgdXRpbHMgPSB7CiAgZGlzYWJsZUxvZzogZnVuY3Rpb24oYm9vbCkgewogICAgaWYgKHR5cGVvZiBib29sICE9PSAnYm9vbGVhbicpIHsKICAgICAgcmV0dXJuIG5ldyBFcnJvcignQXJndW1lbnQgdHlwZTogJyArIHR5cGVvZiBib29sICsKICAgICAgICAgICcuIFBsZWFzZSB1c2UgYSBib29sZWFuLicpOwogICAgfQogICAgbG9nRGlzYWJsZWRfID0gYm9vbDsKICAgIHJldHVybiAoYm9vbCkgPyAnYWRhcHRlci5qcyBsb2dnaW5nIGRpc2FibGVkJyA6CiAgICAgICAgJ2FkYXB0ZXIuanMgbG9nZ2luZyBlbmFibGVkJzsKICB9LAoKICBsb2c6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSB7CiAgICAgIGlmIChsb2dEaXNhYmxlZF8pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5sb2cgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLyoqCiAgICogRXh0cmFjdCBicm93c2VyIHZlcnNpb24gb3V0IG9mIHRoZSBwcm92aWRlZCB1c2VyIGFnZW50IHN0cmluZy4KICAgKgogICAqIEBwYXJhbSB7IXN0cmluZ30gdWFzdHJpbmcgdXNlckFnZW50IHN0cmluZy4KICAgKiBAcGFyYW0geyFzdHJpbmd9IGV4cHIgUmVndWxhciBleHByZXNzaW9uIHVzZWQgYXMgbWF0Y2ggY3JpdGVyaWEuCiAgICogQHBhcmFtIHshbnVtYmVyfSBwb3MgcG9zaXRpb24gaW4gdGhlIHZlcnNpb24gc3RyaW5nIHRvIGJlIHJldHVybmVkLgogICAqIEByZXR1cm4geyFudW1iZXJ9IGJyb3dzZXIgdmVyc2lvbi4KICAgKi8KICBleHRyYWN0VmVyc2lvbjogZnVuY3Rpb24odWFzdHJpbmcsIGV4cHIsIHBvcykgewogICAgdmFyIG1hdGNoID0gdWFzdHJpbmcubWF0Y2goZXhwcik7CiAgICByZXR1cm4gbWF0Y2ggJiYgbWF0Y2gubGVuZ3RoID49IHBvcyAmJiBwYXJzZUludChtYXRjaFtwb3NdLCAxMCk7CiAgfSwKCiAgLyoqCiAgICogQnJvd3NlciBkZXRlY3Rvci4KICAgKgogICAqIEByZXR1cm4ge29iamVjdH0gcmVzdWx0IGNvbnRhaW5pbmcgYnJvd3NlciBhbmQgdmVyc2lvbgogICAqICAgICBwcm9wZXJ0aWVzLgogICAqLwogIGRldGVjdEJyb3dzZXI6IGZ1bmN0aW9uKCkgewogICAgLy8gUmV0dXJuZWQgcmVzdWx0IG9iamVjdC4KICAgIHZhciByZXN1bHQgPSB7fTsKICAgIHJlc3VsdC5icm93c2VyID0gbnVsbDsKICAgIHJlc3VsdC52ZXJzaW9uID0gbnVsbDsKCiAgICAvLyBGYWlsIGVhcmx5IGlmIGl0J3Mgbm90IGEgYnJvd3NlcgogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8ICF3aW5kb3cubmF2aWdhdG9yKSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIGJyb3dzZXIuJzsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvLyBGaXJlZm94LgogICAgaWYgKG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEpIHsKICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnZmlyZWZveCc7CiAgICAgIHJlc3VsdC52ZXJzaW9uID0gdGhpcy5leHRyYWN0VmVyc2lvbihuYXZpZ2F0b3IudXNlckFnZW50LAogICAgICAgICAgL0ZpcmVmb3hcLyhbMC05XSspXC4vLCAxKTsKCiAgICAvLyBhbGwgd2Via2l0LWJhc2VkIGJyb3dzZXJzCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEpIHsKICAgICAgLy8gQ2hyb21lLCBDaHJvbWl1bSwgV2VidmlldywgT3BlcmEsIGFsbCB1c2UgdGhlIGNocm9tZSBzaGltIGZvciBub3cKICAgICAgaWYgKHdpbmRvdy53ZWJraXRSVENQZWVyQ29ubmVjdGlvbikgewogICAgICAgIHJlc3VsdC5icm93c2VyID0gJ2Nocm9tZSc7CiAgICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvQ2hyb20oZXxpdW0pXC8oWzAtOV0rKVwuLywgMik7CgogICAgICAvLyBTYWZhcmkgb3IgdW5rbm93biB3ZWJraXQtYmFzZWQKICAgICAgLy8gZm9yIHRoZSB0aW1lIGJlaW5nIFNhZmFyaSBoYXMgc3VwcG9ydCBmb3IgTWVkaWFTdHJlYW1zIGJ1dCBub3Qgd2ViUlRDCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gU2FmYXJpIFVBIHN1YnN0cmluZ3Mgb2YgaW50ZXJlc3QgZm9yIHJlZmVyZW5jZToKICAgICAgICAvLyAtIHdlYmtpdCB2ZXJzaW9uOiAgICAgICAgICAgQXBwbGVXZWJLaXQvNjAyLjEuMjUgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLyAtIHNhZmFyaSBVSSB2ZXJzaW9uOiAgICAgICAgVmVyc2lvbi85LjAuMyAodW5pcXVlIHRvIFNhZmFyaSkKICAgICAgICAvLyAtIHNhZmFyaSBVSSB3ZWJraXQgdmVyc2lvbjogU2FmYXJpLzYwMS40LjQgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLwogICAgICAgIC8vIGlmIHRoZSB3ZWJraXQgdmVyc2lvbiBhbmQgc2FmYXJpIFVJIHdlYmtpdCB2ZXJzaW9ucyBhcmUgZXF1YWxzLAogICAgICAgIC8vIC4uLiB0aGlzIGlzIGEgc3RhYmxlIHZlcnNpb24uCiAgICAgICAgLy8KICAgICAgICAvLyBvbmx5IHRoZSBpbnRlcm5hbCB3ZWJraXQgdmVyc2lvbiBpcyBpbXBvcnRhbnQgdG9kYXkgdG8ga25vdyBpZgogICAgICAgIC8vIG1lZGlhIHN0cmVhbXMgYXJlIHN1cHBvcnRlZAogICAgICAgIC8vCiAgICAgICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1ZlcnNpb25cLyhcZCspLihcZCspLykpIHsKICAgICAgICAgIHJlc3VsdC5icm93c2VyID0gJ3NhZmFyaSc7CiAgICAgICAgICByZXN1bHQudmVyc2lvbiA9IHRoaXMuZXh0cmFjdFZlcnNpb24obmF2aWdhdG9yLnVzZXJBZ2VudCwKICAgICAgICAgICAgL0FwcGxlV2ViS2l0XC8oWzAtOV0rKVwuLywgMSk7CgogICAgICAgIC8vIHVua25vd24gd2Via2l0LWJhc2VkIGJyb3dzZXIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnVW5zdXBwb3J0ZWQgd2Via2l0LWJhc2VkIGJyb3dzZXIgJyArCiAgICAgICAgICAgICAgJ3dpdGggR1VNIHN1cHBvcnQgYnV0IG5vIFdlYlJUQyBzdXBwb3J0Lic7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgICAgfQoKICAgIC8vIEVkZ2UuCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMgJiYKICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9FZGdlXC8oXGQrKS4oXGQrKSQvKSkgewogICAgICByZXN1bHQuYnJvd3NlciA9ICdlZGdlJzsKICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvRWRnZVwvKFxkKykuKFxkKykkLywgMik7CgogICAgLy8gRGVmYXVsdCBmYWxsdGhyb3VnaDogbm90IHN1cHBvcnRlZC4KICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIHN1cHBvcnRlZCBicm93c2VyLic7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9LAoKICAvLyBzaGltQ3JlYXRlT2JqZWN0VVJMIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBzaGltU291cmNlT2JqZWN0IHRvIGF2b2lkIGxvb3AuCgogIHNoaW1DcmVhdGVPYmplY3RVUkw6IGZ1bmN0aW9uKCkgewogICAgaWYgKCEodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAgICdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgLy8gT25seSBzaGltIENyZWF0ZU9iamVjdFVSTCB1c2luZyBzcmNPYmplY3QgaWYgc3JjT2JqZWN0IGV4aXN0cy4KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICB2YXIgbmF0aXZlQ3JlYXRlT2JqZWN0VVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgbmF0aXZlUmV2b2tlT2JqZWN0VVJMID0gVVJMLnJldm9rZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgc3RyZWFtcyA9IG5ldyBNYXAoKSwgbmV3SWQgPSAwOwoKICAgIFVSTC5jcmVhdGVPYmplY3RVUkwgPSBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgaWYgKCdnZXRUcmFja3MnIGluIHN0cmVhbSkgewogICAgICAgIHZhciB1cmwgPSAncG9seWJsb2I6JyArICgrK25ld0lkKTsKICAgICAgICBzdHJlYW1zLnNldCh1cmwsIHN0cmVhbSk7CiAgICAgICAgY29uc29sZS5sb2coJ1VSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKSBpcyBkZXByZWNhdGVkISAnICsKICAgICAgICAgICAgICAgICAgICAnVXNlIGVsZW0uc3JjT2JqZWN0ID0gc3RyZWFtIGluc3RlYWQhJyk7CiAgICAgICAgcmV0dXJuIHVybDsKICAgICAgfQogICAgICByZXR1cm4gbmF0aXZlQ3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICB9OwogICAgVVJMLnJldm9rZU9iamVjdFVSTCA9IGZ1bmN0aW9uKHVybCkgewogICAgICBuYXRpdmVSZXZva2VPYmplY3RVUkwodXJsKTsKICAgICAgc3RyZWFtcy5kZWxldGUodXJsKTsKICAgIH07CgogICAgdmFyIGRzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NyYycpOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyYycsIHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gZHNjLmdldC5hcHBseSh0aGlzKTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbih1cmwpIHsKICAgICAgICB0aGlzLnNyY09iamVjdCA9IHN0cmVhbXMuZ2V0KHVybCkgfHwgbnVsbDsKICAgICAgICByZXR1cm4gZHNjLnNldC5hcHBseSh0aGlzLCBbdXJsXSk7CiAgICAgIH0KICAgIH0pOwogIH0KfTsKCi8vIEV4cG9ydC4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgbG9nOiB1dGlscy5sb2csCiAgZGlzYWJsZUxvZzogdXRpbHMuZGlzYWJsZUxvZywKICBicm93c2VyRGV0YWlsczogdXRpbHMuZGV0ZWN0QnJvd3NlcigpLAogIGV4dHJhY3RWZXJzaW9uOiB1dGlscy5leHRyYWN0VmVyc2lvbiwKICBzaGltQ3JlYXRlT2JqZWN0VVJMOiB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMCn07Cgp9LHt9XSwxMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCnJlcXVpcmUoJ3dlYnJ0Yy1hZGFwdGVyJyk7CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCi8qKgogIFRoZSBDb25uZWN0aW9uQ29udHJvbGxlciBoYXMgYSBnZW5lcmljIGRlc2lnbiBzbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGluIGJvdGggc3R1YnMuCiAgSXQgbWFuYWdlcyBhIHNpbmdsZSBEYXRhQ2hhbm5lbCwgaXQgaXMgbm90IHJlcXVlc3RpbmcgYWNjZXNzIHRvIG1lZGlhIGlucHV0LCBpLmUuCiAgZG9lcyBub3QgaGF2ZSBhdWRpby92aWRlbyBzdHJlYW1zLgoqKi8KdmFyIENvbm5lY3Rpb25Db250cm9sbGVyID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENvbm5lY3Rpb25Db250cm9sbGVyKG15VXJsLCBzeW5jaGVyLCBjb25maWd1cmF0aW9uLCBjYWxsZXIpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb25uZWN0aW9uQ29udHJvbGxlcik7CgogICAgaWYgKCFteVVybCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgb3duIHVybCAobXlVcmwpIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFzeW5jaGVyKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzeW5jaGVyIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFjb25maWd1cmF0aW9uKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWd1cmF0aW9uIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoKICAgIHRoaXMuX2RvbWFpbiA9IHRoaXMuX2RpdmlkZVVSTChteVVybClbImRvbWFpbiJdOwogICAgdGhpcy5fb2JqZWN0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovL2NhdGFsb2d1ZS4nICsgdGhpcy5fZG9tYWluICsgJy8ud2VsbC1rbm93bi9kYXRhc2NoZW1hL0Nvbm5lY3Rpb24nOwoKICAgIHRoaXMuX215VXJsID0gbXlVcmw7CiAgICB0aGlzLl9zeW5jaGVyID0gc3luY2hlcjsKICAgIHRoaXMuX2NvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uOwogICAgdGhpcy5fY2FsbGVyID0gY2FsbGVyOwogICAgdGhpcy5fZGF0YU9iamVjdE9ic2VydmVyOwogICAgdGhpcy5fZGF0YU9iamVjdFJlcG9ydGVyOwogICAgdGhpcy5fcGVlclVybDsKICAgIHRoaXMuX2RhdGFDaGFubmVsOwogICAgdGhpcy5fb25TdGF0dXNVcGRhdGU7CiAgICB0aGlzLl9yZW1vdGVSdW50aW1lVVJMOwoKICAgIHRoaXMuX3BlZXJDb25uZWN0aW9uID0gdGhpcy5fY3JlYXRlUGVlckNvbm5lY3Rpb24oKTsKICB9CgogIC8vY3JlYXRlIGEgcGVlciBjb25uZWN0aW9uIHdpdGggaXRzIGV2ZW50IGhhbmRsZXJzCgoKICBfY3JlYXRlQ2xhc3MoQ29ubmVjdGlvbkNvbnRyb2xsZXIsIFt7CiAgICBrZXk6ICdfY3JlYXRlUGVlckNvbm5lY3Rpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVQZWVyQ29ubmVjdGlvbigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBwYyA9IHRoaXMuX3BlZXJDb25uZWN0aW9uOwogICAgICBpZiAoIXBjKSB7CiAgICAgICAgcGMgPSBuZXcgUlRDUGVlckNvbm5lY3Rpb24odGhpcy5fY29uZmlndXJhdGlvbik7CiAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiBjcmVhdGVkIFBlZXJDb25uZWN0aW9uIik7CgogICAgICAgIC8vIGFkZCBoYW5kbGVyIGZvciBkYXRhY2hhbm5lbCBjcmVhdGlvbiBmcm9tIHBlZXIgc2lkZQogICAgICAgIHBjLm9uZGF0YWNoYW5uZWwgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogb25kYXRhY2hhbm5lbCAtPiByZW1vdGUgc2lkZSBoYXMgY3JlYXRlZCBhIGRhdGFjaGFubmVsIik7CiAgICAgICAgICBfdGhpcy5fZGF0YUNoYW5uZWwgPSBldmVudC5jaGFubmVsOwogICAgICAgICAgX3RoaXMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfTsKCiAgICAgICAgLy8gZXZlbnQgaGFuZGxlciBmb3IgbG9jYWwgaWNlIGNhbmRpZGF0ZXMKICAgICAgICBwYy5vbmljZWNhbmRpZGF0ZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IGljZWNhbmRpZGF0ZWV2ZW50IG9jY3VyZWQ6ICIsIGUpOwogICAgICAgICAgaWYgKCFlLmNhbmRpZGF0ZSkgcmV0dXJuOwogICAgICAgICAgdmFyIGljZWNhbmRpZGF0ZSA9IHsKICAgICAgICAgICAgdHlwZTogJ2NhbmRpZGF0ZScsCiAgICAgICAgICAgIGNhbmRpZGF0ZTogZS5jYW5kaWRhdGUuY2FuZGlkYXRlLAogICAgICAgICAgICBzZHBNaWQ6IGUuY2FuZGlkYXRlLnNkcE1pZCwKICAgICAgICAgICAgc2RwTUxpbmVJbmRleDogZS5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleAogICAgICAgICAgfTsKICAgICAgICAgIC8vIHNlbmQgY2FuZGlkYXRlIHRvIHJlbW90ZSBwZWVyIGJ5IHB1c2hpbmcgaXQgdG8gdGhlIHJlcG9ydGVyIG9iamVjdAogICAgICAgICAgX3RoaXMuX2RhdGFPYmplY3RSZXBvcnRlci5kYXRhLmljZUNhbmRpZGF0ZXMucHVzaChpY2VjYW5kaWRhdGUpOwogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIHBjOwogICAgfQoKICAgIC8qKgogICAgUmVhY3QgdG8gdGhlIGdpdmVuIGludml0YXRpb24gZXZlbnQgYnkgc3Vic2NyaWJpbmcgdG8gdGhlIHByb3ZpZGVkIGludml0YXRpb25FdmVudC51cmwuCiAgICAqKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb2JzZXJ2ZShpbnZpdGF0aW9uRXZlbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLl9wZWVyVXJsID0gaW52aXRhdGlvbkV2ZW50LmZyb207CiAgICAgIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwgPSBpbnZpdGF0aW9uRXZlbnQudmFsdWUucnVudGltZVVSTDsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIF90aGlzMi5fc3luY2hlci5zdWJzY3JpYmUoX3RoaXMyLl9vYmplY3REZXNjVVJMLCBpbnZpdGF0aW9uRXZlbnQudXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgICAgIGNvbnNvbGUuaW5mbygnK1tQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIGdvdCBEYXRhIE9iamVjdCBPYnNlcnZlcicsIGRhdGFPYmplY3RPYnNlcnZlcik7CiAgICAgICAgICBfdGhpczIuX3NldHVwT2JzZXJ2ZXIoZGF0YU9iamVjdE9ic2VydmVyKTsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICByZWplY3QoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICBDcmVhdGVzIGEgc3luY2hlciBvYmplY3QgYW5kIGludml0ZSB0aGUgZ2l2ZW4gcGVlclVybCB0byBzdWJzY3JpYmUgZm9yIGl0LgogICAgQWxzbyBjcmVhdGVzIHRoZSBsb2NhbCBvZmZlciwgcGVyZm9ybXMgc2V0TG9jYWxEZXNjcmlwdGlvbiBhbmQgcHVibGlzaGVzIHRoZSBvZmZlciB2aWEgdGhlIHJlcG9ydGVyIG9iamVjdC4KICAgICoqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcG9ydChwZWVyVXJsLCBvd25SdW50aW1lVXJsKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLl9wZWVyVXJsKSB0aGlzLl9wZWVyVXJsID0gcGVlclVybDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgLy8gIGlmIHdlIGFyZSB0aGUgY2FsbGVyIChpLmUuIG5vIHJlcG9ydGVyIG9iamVjdCBwcmVzZW50IHlldCwgaW5pdGFsaXplIHRoZSBjcmVhdGlvbiBvZiB0aGUgRGF0YUNoYW5uZWwpCiAgICAgICAgaWYgKF90aGlzMy5fY2FsbGVyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHdlIGFyZSBpbiBjYWxsZXIgcm9sZSAtLT4gY3JlYXRlRGF0YUNoYW5uZWwgLi4uIik7CiAgICAgICAgICBfdGhpczMuX2RhdGFDaGFubmVsID0gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVEYXRhQ2hhbm5lbCgiUDJQQ2hhbm5lbCIsIHsgcmVsaWFibGU6IGZhbHNlIH0pOwogICAgICAgICAgY29uc29sZS5sb2coIlAyUDogZGF0YWNoYW5uZWwgb2JqZWN0IiwgX3RoaXMzLl9kYXRhQ2hhbm5lbCk7CiAgICAgICAgICBfdGhpczMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBpbml0aWFsIGRhdGEgZm9yIHJlcG9ydGVyIHN5bmMgb2JqZWN0CiAgICAgICAgdmFyIGRhdGFPYmplY3QgPSB7CiAgICAgICAgICBuYW1lOiAiUDJQQ29ubmVjdGlvbiIsCiAgICAgICAgICBzdGF0dXM6ICIiLAogICAgICAgICAgb3duZXI6IF90aGlzMy5fbXlVcmwsCiAgICAgICAgICBydW50aW1lVVJMOiBvd25SdW50aW1lVXJsLCAvLyBwdXQgdGhlIG93biBydW50aW1lVVJMIHRvIHRoZSBkYXRhT2JqZWN0IChhcyBkaXNjdXNzZWQgd2l0aCBQYXVsbykKICAgICAgICAgIGNvbm5lY3Rpb25EZXNjcmlwdGlvbjoge30sCiAgICAgICAgICBpY2VDYW5kaWRhdGVzOiBbXQogICAgICAgIH07CiAgICAgICAgLy8gZW5zdXJlIHRoaXMgdGhlIG9ialJlcG9ydGVyIG9iamVjdCBpcyBjcmVhdGVkIGJlZm9yZSB3ZSBjcmVhdGUgdGhlIG9mZmVyCiAgICAgICAgX3RoaXMzLl9zeW5jaGVyLmNyZWF0ZShfdGhpczMuX29iamVjdERlc2NVUkwsIFtfdGhpczMuX3BlZXJVcmxdLCBkYXRhT2JqZWN0KS50aGVuKGZ1bmN0aW9uIChvYmpSZXBvcnRlcikgewogICAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBDcmVhdGVkIFdlYlJUQyBPYmplY3QgUmVwb3J0ZXInLCBvYmpSZXBvcnRlcik7CgogICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIgPSBvYmpSZXBvcnRlcjsKICAgICAgICAgIF90aGlzMy5fZGF0YU9iamVjdFJlcG9ydGVyLm9uU3Vic2NyaXB0aW9uKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICBldmVudC5hY2NlcHQoKTsgLy8gYWxsIHN1YnNjcmlwdGlvbiByZXF1ZXN0ZWQgYXJlIGFjY2VwdGVkCiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgY29uc3RyYWludHMgPSB7CiAgICAgICAgICAgIG9mZmVyVG9SZWNlaXZlQXVkaW86IGZhbHNlLAogICAgICAgICAgICBvZmZlclRvUmVjZWl2ZVZpZGVvOiBmYWxzZQogICAgICAgICAgfTsKICAgICAgICAgIC8vIGVpdGhlciBpbnZva2UgY3JlYXRlT2ZmZXIgb3IgY3JlYXRlQW5zd2VyLCBkZXBlbmRpbmcgb24gdGhlIHJvbGVzCiAgICAgICAgICB2YXIgc2RwUHJvbWlzZSA9IF90aGlzMy5fY2FsbGVyID8gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVPZmZlcihjb25zdHJhaW50cykgOiBfdGhpczMuX3BlZXJDb25uZWN0aW9uLmNyZWF0ZUFuc3dlcigpOwogICAgICAgICAgc2RwUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChzZHApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIFNEUCBjcmVhdGVkIiwgc2RwKTsKICAgICAgICAgICAgX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5zZXRMb2NhbERlc2NyaXB0aW9uKG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oc2RwKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gbG9jYWxEZXNjcmlwdGlvbiBzZXQgc3VjY2Vzc2Z1bGx5Jyk7CiAgICAgICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIuZGF0YS5jb25uZWN0aW9uRGVzY3JpcHRpb24gPSBzZHA7CiAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHJlamVjdCgic2V0dGluZyBvZiBsb2NhbERlc2NyaXB0aW9uIGZhaWxlZDogIiwgZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICAgIHJlamVjdChyZWFzb24pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25NZXNzYWdlKGNhbGxiYWNrKSB7CiAgICAgIC8vIGFkZCB0aGUgbWVzc2FnZSBjYWxsYmFjawogICAgICB0aGlzLl9vbkRhdGFDaGFubmVsTWVzc2FnZSA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uU3RhdHVzVXBkYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblN0YXR1c1VwZGF0ZShjYWxsYmFjaykgewogICAgICAvLyBhZGQgYSBjb25uZWN0aW9uIHN0YXR1cyB1cGRhdGUgY2FsbGJhY2sKICAgICAgdGhpcy5fb25TdGF0dXNVcGRhdGUgPSBjYWxsYmFjazsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdzZW5kTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZE1lc3NhZ2UobSkgewogICAgICAvLyB0b2RvOiBvbmx5IHNlbmQgaWYgZGF0YSBjaGFubmVsIGlzIGNvbm5lY3RlZAogICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gLS0+IG91dGdvaW5nIG1zZzogIiwgbSk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLnNlbmQobSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnY2xlYW51cCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYW51cCgpIHsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RPYnNlcnZlcjsKICAgICAgaWYgKHRoaXMuX2RhdGFDaGFubmVsKSB0aGlzLl9kYXRhQ2hhbm5lbC5jbG9zZSgpOwogICAgICBpZiAodGhpcy5fcGVlckNvbm5lY3Rpb24pIHRoaXMuX3BlZXJDb25uZWN0aW9uLmNsb3NlKCk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsID0gbnVsbDsKICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24gPSBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogJ19hZGREYXRhQ2hhbm5lbExpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxPcGVuKCk7CiAgICAgIH07CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzNC5fb25EYXRhQ2hhbm5lbEVycm9yKGUpOwogICAgICB9OwogICAgICB0aGlzLl9kYXRhQ2hhbm5lbC5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAobSkgewogICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSA8LS0gaW5jb21pbmcgbXNnOiAiLCBtKTsKICAgICAgICBpZiAoX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZSkgX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZShtKTsKICAgICAgfTsKICAgICAgdGhpcy5fZGF0YUNoYW5uZWwub25jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxDbG9zZSgpOwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZXR1cE9ic2VydmVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0dXBPYnNlcnZlcihkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIgPSBkYXRhT2JqZWN0T2JzZXJ2ZXI7CgogICAgICB2YXIgcGVlckRhdGEgPSB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YTsKICAgICAgY29uc29sZS5pbmZvKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogX3NldHVwT2JzZXJ2ZXIgUGVlciBEYXRhOiIsIHBlZXJEYXRhKTsKCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnY29ubmVjdGlvbkRlc2NyaXB0aW9uJykpIHsKICAgICAgICB0aGlzLl9wcm9jZXNzUGVlckluZm9ybWF0aW9uKHBlZXJEYXRhLmNvbm5lY3Rpb25EZXNjcmlwdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnaWNlQ2FuZGlkYXRlcycpKSB7CiAgICAgICAgcGVlckRhdGEuaWNlQ2FuZGlkYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChpY2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogaGFuZGxlT2JzZXJ2ZXJPYmplY3QgZm9yIGljZSIsIGljZSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oaWNlKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgLy8gc2V0dXAgbGlzdGVuZXIgZm9yIGZ1dHVyZSBjaGFuZ2VzIG9uIHRoZSBvYnNlcnZlZCBkYXRhIG9iamVjdAogICAgICBkYXRhT2JqZWN0T2JzZXJ2ZXIub25DaGFuZ2UoJyonLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBjb25zb2xlLmRlYnVnKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogT2JzZXJ2ZXIgb24gY2hhbmdlIG1lc3NhZ2U6ICcsIGV2ZW50KTsKICAgICAgICAvLyB3ZSBuZWVkIHRvIHByb2Nlc3MgdGhlIGFuc3dlciBmcm9tIGV2ZW50LmRhdGEgYW5kIHRoZSBjYW5kaWRhdGVzIHdoaWNoIG1pZ2h0IHRyaWNrbGUKICAgICAgICAvLyBmcm9tIGV2ZW50LmRhdGFbMF0KICAgICAgICBpZiAoZXZlbnQuZGF0YVswXSkgewogICAgICAgICAgLy8gWzBdIHRoaXMgZG9lcyB0aGUgdHJpY2sgd2hlbiBpY2UgY2FuZGlkYXRlcyBhcmUgdHJpY2tsaW5nIDspCiAgICAgICAgICBjb25zb2xlLmxvZygnPj5ldmVudC5kYXRhWzBdJywgZXZlbnQuZGF0YVswXSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oZXZlbnQuZGF0YVswXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogPj5ldmVudCcsIGV2ZW50KTsKICAgICAgICAgIF90aGlzNS5fcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihldmVudC5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19wcm9jZXNzUGVlckluZm9ybWF0aW9uJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihkYXRhKSB7CiAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246ICIsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgaWYgKCF0aGlzLl9wZWVyQ29ubmVjdGlvbikgewogICAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246IG5vIFBlZXJDb25uZWN0aW9uIGV4aXN0aW5nIC0tPiBtYXliZSBpbiBkaXNjb25uZWN0aW5nIHByb2Nlc3MuIC0tPiBpZ25vcmluZyB0aGlzIHVwZGF0ZSIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGRhdGEudHlwZSA9PT0gJ29mZmVyJyB8fCBkYXRhLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogUHJvY2VzcyBDb25uZWN0aW9uIERlc2NyaXB0aW9uOiAnLCBkYXRhKTsKICAgICAgICB0aGlzLl9wZWVyQ29ubmVjdGlvbi5zZXRSZW1vdGVEZXNjcmlwdGlvbihuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKGRhdGEpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogcmVtb3RlIHN1Y2Nlc3MiKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiByZW1vdGUgZXJyb3I6ICIsIGUpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoZGF0YS5jYW5kaWRhdGUpIHsKICAgICAgICBjb25zb2xlLmluZm8oJ1Byb2Nlc3MgSWNlIENhbmRpZGF0ZTogJywgZGF0YSk7CiAgICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24uYWRkSWNlQ2FuZGlkYXRlKG5ldyBSVENJY2VDYW5kaWRhdGUoewogICAgICAgICAgY2FuZGlkYXRlOiBkYXRhLmNhbmRpZGF0ZQogICAgICAgIH0pKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsT3BlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRGF0YUNoYW5uZWxPcGVuKCkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgb3BlbmVkJyk7CiAgICAgIGlmICh0aGlzLl9vblN0YXR1c1VwZGF0ZSkgdGhpcy5fb25TdGF0dXNVcGRhdGUoImxpdmUiLCB1bmRlZmluZWQsIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsRXJyb3InLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsRXJyb3IoZSkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgZXJyb3I6ICcsIGUpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiIiArIGUpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsQ2xvc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsQ2xvc2UoKSB7CiAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBEYXRhQ2hhbm5lbCBjbG9zZWQ6ICcpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiY2xvc2VkIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICAgICAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAgICAgKiBAcmV0dXJuIHtkaXZpZGVVUkx9IHRoZSByZXN1bHQgb2YgZGl2aWRlVVJMCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnX2RpdmlkZVVSTCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RpdmlkZVVSTCh1cmwpIHsKCiAgICAgIC8vIGxldCByZSA9IC8oW2EtekEtWi1dKik/OlwvXC8oPzpcLik/KFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIpKihcL1tcL1xkXHdcLi1dKikqKD86W1w/XSkqKC4rKSovZ2k7CiAgICAgIHZhciByZSA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogICAgICB2YXIgc3Vic3QgPSAnJDEsJDIsJDMnOwogICAgICB2YXIgcGFydHMgPSB1cmwucmVwbGFjZShyZSwgc3Vic3QpLnNwbGl0KCcsJyk7CgogICAgICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzCiAgICAgIGlmIChwYXJ0c1swXSA9PT0gdXJsKSB7CiAgICAgICAgcGFydHNbMF0gPSAnaHR0cHMnOwogICAgICAgIHBhcnRzWzFdID0gdXJsOwogICAgICB9CgogICAgICB2YXIgcmVzdWx0ID0gewogICAgICAgIHR5cGU6IHBhcnRzWzBdLAogICAgICAgIGRvbWFpbjogcGFydHNbMV0sCiAgICAgICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgICAgIH07CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIENvbm5lY3Rpb25Db250cm9sbGVyOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBDb25uZWN0aW9uQ29udHJvbGxlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsid2VicnRjLWFkYXB0ZXIiOjN9XSwxMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCi8vIFRPRE86IGludGVncmF0ZSB0aGUgc3RhdHVzIGV2ZW50aW5nCgpleHBvcnRzLmRlZmF1bHQgPSBhY3RpdmF0ZTsKCnZhciBfU3luY2hlciA9IHJlcXVpcmUoJ3NlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlcicpOwoKdmFyIF9Db25uZWN0aW9uQ29udHJvbGxlciA9IHJlcXVpcmUoJy4vQ29ubmVjdGlvbkNvbnRyb2xsZXInKTsKCnZhciBfQ29ubmVjdGlvbkNvbnRyb2xsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQ29ubmVjdGlvbkNvbnRyb2xsZXIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKLyoqCiAqIFByb3RvU3R1YiBJbnRlcmZhY2UKICovCnZhciBQMlBIYW5kbGVyU3R1YiA9IGZ1bmN0aW9uICgpIHsKCiAgLyoqCiAgICogSW5pdGlhbGlzZSB0aGUgcHJvdG9jb2wgc3R1YiBpbmNsdWRpbmcgYXMgaW5wdXQgcGFyYW1ldGVycyBpdHMgYWxsb2NhdGVkCiAgICogY29tcG9uZW50IHJ1bnRpbWUgdXJsLCB0aGUgcnVudGltZSBCVVMgcG9zdE1lc3NhZ2UgZnVuY3Rpb24gdG8gYmUgaW52b2tlZAogICAqIG9uIG1lc3NhZ2VzIHJlY2VpdmVkIGJ5IHRoZSBwcm90b2NvbCBzdHViIGFuZCByZXF1aXJlZCBjb25maWd1cmF0aW9uIHJldHJpZXZlZCBmcm9tIHByb3RvY29sU3R1YiBkZXNjcmlwdG9yLgogICAqIEBwYXJhbSAge1VSTC5ydW50aW1lUHJvdG9TdHViVVJMfSAgICAgICAgICAgICAgICAgICBydW50aW1lUHJvdG9TdHViVVJMIHJ1bnRpbWVQcm90b1N1YlVSTAogICAqIEBwYXJhbSAge01lc3NhZ2UuTWVzc2FnZX0gICAgICAgICAgICAgICAgICAgICAgICAgICBidXNQb3N0TWVzc2FnZSAgICAgY29uZmlndXJhdGlvbgogICAqIEBwYXJhbSAge1Byb3RvU3R1YkRlc2NyaXB0b3IuQ29uZmlndXJhdGlvbkRhdGFMaXN0fSBjb25maWd1cmF0aW9uICAgICAgY29uZmlndXJhdGlvbgogICAqLwogIGZ1bmN0aW9uIFAyUEhhbmRsZXJTdHViKHJ1bnRpbWVQcm90b1N0dWJVUkwsIG1pbmlCdXMsIGNvbmZpZ3VyYXRpb24pIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFAyUEhhbmRsZXJTdHViKTsKCiAgICBpZiAoIXJ1bnRpbWVQcm90b1N0dWJVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIHJ1bnRpbWVQcm90b1N0dWJVUkwgaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKICAgIGlmICghbWluaUJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWNvbmZpZ3VyYXRpb24pIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZ3VyYXRpb24gaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKCiAgICBjb25zb2xlLmxvZygnK1tQMlBIYW5kbGVyU3R1Yi5jb25zdHJ1Y3Rvcl0gY29uZmlnIGlzOiAnLCBjb25maWd1cmF0aW9uKTsKCiAgICB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMID0gcnVudGltZVByb3RvU3R1YlVSTDsKICAgIHRoaXMuX3J1bnRpbWVVUkwgPSBjb25maWd1cmF0aW9uLnJ1bnRpbWVVUkw7CiAgICB0aGlzLl9jb25maWd1cmF0aW9uID0gY29uZmlndXJhdGlvbjsKICAgIHRoaXMuX2J1cyA9IG1pbmlCdXM7CiAgICB0aGlzLl9idXMuYWRkTGlzdGVuZXIoJyonLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgIF90aGlzLl9zZW5kQ2hhbm5lbE1zZyhtc2cpOwogICAgfSk7CgogICAgdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXJzID0ge307CgogICAgdGhpcy5fc3luY2hlciA9IG5ldyBfU3luY2hlci5TeW5jaGVyKHJ1bnRpbWVQcm90b1N0dWJVUkwsIG1pbmlCdXMsIGNvbmZpZ3VyYXRpb24pOwogICAgdGhpcy5fc3luY2hlci5vbk5vdGlmaWNhdGlvbihmdW5jdGlvbiAoZXZlbnQpIHsKCiAgICAgIGNvbnNvbGUubG9nKCcrW1AyUEhhbmRsZXJTdHViXSBPbiBTeW5jaGVyIE5vdGlmaWNhdGlvbjogJywgZXZlbnQpOwogICAgICBldmVudC5hY2soMjAwKTsKCiAgICAgIHN3aXRjaCAoZXZlbnQudHlwZSkgewoKICAgICAgICBjYXNlICdjcmVhdGUnOgoKICAgICAgICAgIC8vIGFzIGRpc2N1c3NlZCB3aXRoIFBhdWxvLCB3ZSBleHBlY3QgdGhlICJyZW1vdGVSdW50aW1lVVJMIiBhcyBmaWVsZCAicnVudGltZVVSTCIgaW4gdGhlIGluaXRpYWwgZGF0YU9iamVjdAogICAgICAgICAgLy8gZW1pdCB0aGUgImNyZWF0ZSIgZXZlbnQgYXMgcmVxdWVzdGVkIGluIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2Rldi1wcm90b3N0dWJzL2lzc3Vlcy81CiAgICAgICAgICBfdGhpcy5fc2VuZFN0YXR1cygiY3JlYXRlIiwgdW5kZWZpbmVkLCBldmVudC52YWx1ZS5ydW50aW1lVVJMKTsKCiAgICAgICAgICBfdGhpcy5fY3JlYXRlQ29ubmVjdGlvbkNvbnRyb2xsZXIoZXZlbnQpLnRoZW4oZnVuY3Rpb24gKGNvbm5lY3Rpb25Db250cm9sbGVyKSB7CiAgICAgICAgICAgIF90aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcnNbZXZlbnQuZnJvbV0gPSBjb25uZWN0aW9uQ29udHJvbGxlcjsKICAgICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIub25TdGF0dXNVcGRhdGUoZnVuY3Rpb24gKHN0YXR1cywgcmVhc29uLCByZW1vdGVSdW50aW1lVVJMKSB7CiAgICAgICAgICAgICAgX3RoaXMuX3NlbmRTdGF0dXMoc3RhdHVzLCByZWFzb24sIHJlbW90ZVJ1bnRpbWVVUkwpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIub25NZXNzYWdlKGZ1bmN0aW9uIChtKSB7CiAgICAgICAgICAgICAgX3RoaXMuX2RlbGl2ZXIobSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnZGVsZXRlJzoKICAgICAgICAgIC8vIFRPRE86IHF1ZXN0aW9uIGNvZGUgaW4gQ29ubmVjdG9yIC0tPiB0aGVyZSBpdCBkZWxldGVzIGFsbCBjb250cm9sbGVycyAtLT4gd2h5PwogICAgICAgICAgY29uc29sZS5sb2coIitbUDJQSGFuZGxlclN0dWJdIGRlbGV0aW5nIGNvbm5lY3Rpb24gaGFuZGxlciBmb3IgIiArIGV2ZW50LmZyb20pOwogICAgICAgICAgdmFyIGNvbm5lY3Rpb25Db250cm9sbGVyID0gX3RoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyc1tldmVudC5mcm9tXTsKCiAgICAgICAgICBpZiAoY29ubmVjdGlvbkNvbnRyb2xsZXIpIHsKICAgICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIuY2xlYW51cCgpOwogICAgICAgICAgICBkZWxldGUgX3RoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyc1tldmVudC5mcm9tXTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICB9CiAgICB9KTsKICB9CgogIC8qKgogICAqIFRvIGRpc2Nvbm5lY3QgdGhlIHByb3RvY29sIHN0dWIuCiAgICovCgoKICBfY3JlYXRlQ2xhc3MoUDJQSGFuZGxlclN0dWIsIFt7CiAgICBrZXk6ICdkaXNjb25uZWN0JywKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb25uZWN0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIC8vIGNsZWFudXAgQUxMIGNvbm5lY3Rpb25Db250cm9sbGVycwogICAgICBPYmplY3Qua2V5cyh0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcnMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF90aGlzMi5fY29udHJvbGxlcnNba2V5XS5jbGVhbnVwKCk7OwogICAgICAgIGRlbGV0ZSBfdGhpczIuX2NvbnRyb2xsZXJzW2tleV07CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19jcmVhdGVDb25uZWN0aW9uQ29udHJvbGxlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZUNvbm5lY3Rpb25Db250cm9sbGVyKGludml0YXRpb25FdmVudCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIGNvbm5lY3Rpb25Db250cm9sbGVyID0gbmV3IF9Db25uZWN0aW9uQ29udHJvbGxlcjIuZGVmYXVsdChfdGhpczMuX3J1bnRpbWVQcm90b1N0dWJVUkwsIF90aGlzMy5fc3luY2hlciwgX3RoaXMzLl9jb25maWd1cmF0aW9uLCBmYWxzZSk7CiAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIub2JzZXJ2ZShpbnZpdGF0aW9uRXZlbnQpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgY29uc29sZS5sb2coIitbUDJQSGFuZGxlclN0dWJdIG9ic2VydmVyIHNldHVwIHN1Y2Nlc3NmdWwiKTsKICAgICAgICAgIC8vIGNyZWF0ZSB0aGUgcmVwb3J0ZXIgYXV0b21hdGljYWxseQogICAgICAgICAgY29ubmVjdGlvbkNvbnRyb2xsZXIucmVwb3J0KGludml0YXRpb25FdmVudC5mcm9tLCBfdGhpczMuX3J1bnRpbWVVUkwpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiK1tQMlBIYW5kbGVyU3R1Yl0gcmVwb3J0ZXIgc2V0dXAgc3VjY2Vzc2Z1bCIpOwogICAgICAgICAgICBfdGhpczMuX3NlbmRTdGF0dXMoImluLXByb2dyZXNzIiwgdW5kZWZpbmVkLCBpbnZpdGF0aW9uRXZlbnQudmFsdWUucnVudGltZVVSTCk7CiAgICAgICAgICAgIHJlc29sdmUoY29ubmVjdGlvbkNvbnRyb2xsZXIpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZW5kQ2hhbm5lbE1zZycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRDaGFubmVsTXNnKG1zZykgewogICAgICBpZiAodGhpcy5fZmlsdGVyKG1zZykpIHsKICAgICAgICAvLyBUT0RPOiB2ZXJpZnk6IGlzIHRoaXMgc2VsZWN0aW9uIGNvcnJlY3Q/CiAgICAgICAgdmFyIGNvbm5lY3Rpb25Db250cm9sbGVyID0gdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXJzW21zZy50b107CiAgICAgICAgaWYgKGNvbm5lY3Rpb25Db250cm9sbGVyKSBjb25uZWN0aW9uQ29udHJvbGxlci5zZW5kTWVzc2FnZShKU09OLnN0cmluZ2lmeShtc2cpKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19zZW5kU3RhdHVzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VuZFN0YXR1cyh2YWx1ZSwgcmVhc29uLCByZW1vdGVSdW50aW1lVVJMKSB7CiAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgdHlwZTogJ3VwZGF0ZScsCiAgICAgICAgZnJvbTogdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCwKICAgICAgICB0bzogdGhpcy5fcnVudGltZVByb3RvU3R1YlVSTCArICcvc3RhdHVzJywKICAgICAgICBib2R5OiB7CiAgICAgICAgICB2YWx1ZTogdmFsdWUKICAgICAgICB9CiAgICAgIH07CiAgICAgIGlmIChyZW1vdGVSdW50aW1lVVJMKSBtc2cuYm9keS5yZXNvdXJjZSA9IHJlbW90ZVJ1bnRpbWVVUkw7CgogICAgICBpZiAocmVhc29uKSB7CiAgICAgICAgbXNnLmJvZHkuZGVzYyA9IHJlYXNvbjsKICAgICAgfQogICAgICBjb25zb2xlLmxvZygiK1tQMlBIYW5kbGVyU3R1Yl0gc2VuZGluZyBzdGF0dXMgdXBkYXRlOiAiLCBtc2cpOwogICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UobXNnKTsKICAgIH0KCiAgICAvKioKICAgICAqIEZpbHRlciBtZXRob2QgdGhhdCBzaG91bGQgYmUgdXNlZCBmb3IgZXZlcnkgbWVzc2FnZXMgaW4gZGlyZWN0aW9uOiBQcm90b3N0dWIgLT4gTWVzc2FnZU5vZGUKICAgICAqIEBwYXJhbSAge01lc3NhZ2V9IG1zZyBPcmlnaW5hbCBtZXNzYWdlIGZyb20gdGhlIE1lc3NhZ2VCdXMKICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IHRydWUgaWYgaXQncyB0byBiZSBkZWxpdmVyIGluIHRoZSBNZXNzYWdlTm9kZQogICAgICovCgogIH0sIHsKICAgIGtleTogJ19maWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maWx0ZXIobXNnKSB7CiAgICAgIC8vIHRvZG86IG9ubHkgdHJ5IHRvIHNlbmQgd2hlbiBjb25uZWN0ZWQgKGxpdmUgc3RhdHVzKQogICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkudmlhID09PSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMKSByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogTWV0aG9kIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gZGVsaXZlciB0aGUgbWVzc2FnZSBpbiBkaXJlY3Rpb246IFByb3Rvc3R1YiAtPiBNZXNzYWdlQnVzIChjb3JlKQogICAgICogQHBhcmFtICB7TWVzc2FnZX0gbXNnIE9yaWdpbmFsIG1lc3NhZ2UgZnJvbSB0aGUgTWVzc2FnZU5vZGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdfZGVsaXZlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGl2ZXIobXNnKSB7CgogICAgICBjb25zb2xlLmxvZygiK1tQMlBIYW5kbGVyU3R1Yl0gcG9zdGluZyBtZXNzYWdlIHRvIG1zZyBidXM6ICIsIG1zZyk7CiAgICAgIHZhciBtZXNzYWdlID0gSlNPTi5wYXJzZShtc2cuZGF0YSk7CgogICAgICBpZiAoIW1lc3NhZ2UuYm9keSkgbXNnLmJvZHkgPSB7fTsKCiAgICAgIG1lc3NhZ2UuYm9keS52aWEgPSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMOwogICAgICB0aGlzLl9idXMucG9zdE1lc3NhZ2UobWVzc2FnZSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUDJQSGFuZGxlclN0dWI7Cn0oKTsKCmZ1bmN0aW9uIGFjdGl2YXRlKHVybCwgYnVzLCBjb25maWcpIHsKICByZXR1cm4gewogICAgbmFtZTogJ1AyUEhhbmRsZXJTdHViJywKICAgIGluc3RhbmNlOiBuZXcgUDJQSGFuZGxlclN0dWIodXJsLCBidXMsIGNvbmZpZykKICB9Owp9Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKfSx7Ii4vQ29ubmVjdGlvbkNvbnRyb2xsZXIiOjEyLCJzZXJ2aWNlLWZyYW1ld29yay9kaXN0L1N5bmNoZXIiOjJ9XX0se30sWzEzXSkoMTMpCn0pOw==",
      "sourceCodeClassname": "P2PHandlerProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-63d99d6b-5450-81d4-ac0d-2455628f08d32",
    "version": 0.7999999999999999,
    "description": "Description of P2PHandlerProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "P2PHandlerProtoStub",
    "configuration": {
      "iceServers": [
        {
          "urls": "stun:stun.voiparound.com"
        },
        {
          "urls": "stun:stun.voipbuster.com"
        },
        {
          "urls": "stun:stun.voipstunt.com"
        },
        {
          "urls": "stun:stun.voxgratia.org"
        },
        {
          "urls": "stun:stun.ekiga.net"
        },
        {
          "urls": "stun:stun.schlund.de"
        },
        {
          "urls": "stun:stun.iptel.org"
        },
        {
          "urls": "stun:stun.l.google.com:19302"
        },
        {
          "urls": "stun:stun1.l.google.com:19302"
        },
        {
          "urls": "stun:stun.ideasip.com"
        },
        {
          "urls": "stun:stun4.l.google.com:19302"
        },
        {
          "urls": "stun:stun2.l.google.com:19302"
        },
        {
          "urls": "stun:stun3.l.google.com:19302"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=tcp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=udp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:numb.viagenie.ca",
          "credential": "muazkh",
          "username": "webrtc@live.com"
        }
      ]
    },
    "messageSchemas": "",
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": "{ windowSandbox: true }",
    "interworking": false,
    "dataObjects": []
  },
  "P2PRequesterProtoStub": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBTRFAgaGVscGVycy4KdmFyIFNEUFV0aWxzID0ge307CgovLyBHZW5lcmF0ZSBhbiBhbHBoYW51bWVyaWMgaWRlbnRpZmllciBmb3IgY25hbWUgb3IgbWlkcy4KLy8gVE9ETzogdXNlIFVVSURzIGluc3RlYWQ/IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2plZC85ODI4ODMKU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCAxMCk7Cn07CgovLyBUaGUgUlRDUCBDTkFNRSB1c2VkIGJ5IGFsbCBwZWVyY29ubmVjdGlvbnMgZnJvbSB0aGUgc2FtZSBKUy4KU0RQVXRpbHMubG9jYWxDTmFtZSA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwoKLy8gU3BsaXRzIFNEUCBpbnRvIGxpbmVzLCBkZWFsaW5nIHdpdGggYm90aCBDUkxGIGFuZCBMRi4KU0RQVXRpbHMuc3BsaXRMaW5lcyA9IGZ1bmN0aW9uKGJsb2IpIHsKICByZXR1cm4gYmxvYi50cmltKCkuc3BsaXQoJ1xuJykubWFwKGZ1bmN0aW9uKGxpbmUpIHsKICAgIHJldHVybiBsaW5lLnRyaW0oKTsKICB9KTsKfTsKLy8gU3BsaXRzIFNEUCBpbnRvIHNlc3Npb25wYXJ0IGFuZCBtZWRpYXNlY3Rpb25zLiBFbnN1cmVzIENSTEYuClNEUFV0aWxzLnNwbGl0U2VjdGlvbnMgPSBmdW5jdGlvbihibG9iKSB7CiAgdmFyIHBhcnRzID0gYmxvYi5zcGxpdCgnXG5tPScpOwogIHJldHVybiBwYXJ0cy5tYXAoZnVuY3Rpb24ocGFydCwgaW5kZXgpIHsKICAgIHJldHVybiAoaW5kZXggPiAwID8gJ209JyArIHBhcnQgOiBwYXJ0KS50cmltKCkgKyAnXHJcbic7CiAgfSk7Cn07CgovLyBSZXR1cm5zIGxpbmVzIHRoYXQgc3RhcnQgd2l0aCBhIGNlcnRhaW4gcHJlZml4LgpTRFBVdGlscy5tYXRjaFByZWZpeCA9IGZ1bmN0aW9uKGJsb2IsIHByZWZpeCkgewogIHJldHVybiBTRFBVdGlscy5zcGxpdExpbmVzKGJsb2IpLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gbGluZS5pbmRleE9mKHByZWZpeCkgPT09IDA7CiAgfSk7Cn07CgovLyBQYXJzZXMgYW4gSUNFIGNhbmRpZGF0ZSBsaW5lLiBTYW1wbGUgaW5wdXQ6Ci8vIGNhbmRpZGF0ZTo3MDI3ODYzNTAgMiB1ZHAgNDE4MTk5MDIgOC44LjguOCA2MDc2OSB0eXAgcmVsYXkgcmFkZHIgOC44LjguOAovLyBycG9ydCA1NTk5NiIKU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzOwogIC8vIFBhcnNlIGJvdGggdmFyaWFudHMuCiAgaWYgKGxpbmUuaW5kZXhPZignYT1jYW5kaWRhdGU6JykgPT09IDApIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTIpLnNwbGl0KCcgJyk7CiAgfSBlbHNlIHsKICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTApLnNwbGl0KCcgJyk7CiAgfQoKICB2YXIgY2FuZGlkYXRlID0gewogICAgZm91bmRhdGlvbjogcGFydHNbMF0sCiAgICBjb21wb25lbnQ6IHBhcnRzWzFdLAogICAgcHJvdG9jb2w6IHBhcnRzWzJdLnRvTG93ZXJDYXNlKCksCiAgICBwcmlvcml0eTogcGFyc2VJbnQocGFydHNbM10sIDEwKSwKICAgIGlwOiBwYXJ0c1s0XSwKICAgIHBvcnQ6IHBhcnNlSW50KHBhcnRzWzVdLCAxMCksCiAgICAvLyBza2lwIHBhcnRzWzZdID09ICd0eXAnCiAgICB0eXBlOiBwYXJ0c1s3XQogIH07CgogIGZvciAodmFyIGkgPSA4OyBpIDwgcGFydHMubGVuZ3RoOyBpICs9IDIpIHsKICAgIHN3aXRjaCAocGFydHNbaV0pIHsKICAgICAgY2FzZSAncmFkZHInOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAncnBvcnQnOgogICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCA9IHBhcnNlSW50KHBhcnRzW2kgKyAxXSwgMTApOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICd0Y3B0eXBlJzoKICAgICAgICBjYW5kaWRhdGUudGNwVHlwZSA9IHBhcnRzW2kgKyAxXTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDogLy8gVW5rbm93biBleHRlbnNpb25zIGFyZSBzaWxlbnRseSBpZ25vcmVkLgogICAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gY2FuZGlkYXRlOwp9OwoKLy8gVHJhbnNsYXRlcyBhIGNhbmRpZGF0ZSBvYmplY3QgaW50byBTRFAgY2FuZGlkYXRlIGF0dHJpYnV0ZS4KU0RQVXRpbHMud3JpdGVDYW5kaWRhdGUgPSBmdW5jdGlvbihjYW5kaWRhdGUpIHsKICB2YXIgc2RwID0gW107CiAgc2RwLnB1c2goY2FuZGlkYXRlLmZvdW5kYXRpb24pOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5jb21wb25lbnQpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5wcm90b2NvbC50b1VwcGVyQ2FzZSgpKTsKICBzZHAucHVzaChjYW5kaWRhdGUucHJpb3JpdHkpOwogIHNkcC5wdXNoKGNhbmRpZGF0ZS5pcCk7CiAgc2RwLnB1c2goY2FuZGlkYXRlLnBvcnQpOwoKICB2YXIgdHlwZSA9IGNhbmRpZGF0ZS50eXBlOwogIHNkcC5wdXNoKCd0eXAnKTsKICBzZHAucHVzaCh0eXBlKTsKICBpZiAodHlwZSAhPT0gJ2hvc3QnICYmIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyAmJgogICAgICBjYW5kaWRhdGUucmVsYXRlZFBvcnQpIHsKICAgIHNkcC5wdXNoKCdyYWRkcicpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnJlbGF0ZWRBZGRyZXNzKTsgLy8gd2FzOiByZWxBZGRyCiAgICBzZHAucHVzaCgncnBvcnQnKTsKICAgIHNkcC5wdXNoKGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCk7IC8vIHdhczogcmVsUG9ydAogIH0KICBpZiAoY2FuZGlkYXRlLnRjcFR5cGUgJiYgY2FuZGlkYXRlLnByb3RvY29sLnRvTG93ZXJDYXNlKCkgPT09ICd0Y3AnKSB7CiAgICBzZHAucHVzaCgndGNwdHlwZScpOwogICAgc2RwLnB1c2goY2FuZGlkYXRlLnRjcFR5cGUpOwogIH0KICByZXR1cm4gJ2NhbmRpZGF0ZTonICsgc2RwLmpvaW4oJyAnKTsKfTsKCi8vIFBhcnNlcyBhbiBydHBtYXAgbGluZSwgcmV0dXJucyBSVENSdHBDb2RkZWNQYXJhbWV0ZXJzLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9cnRwbWFwOjExMSBvcHVzLzQ4MDAwLzIKU0RQVXRpbHMucGFyc2VSdHBNYXAgPSBmdW5jdGlvbihsaW5lKSB7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIoOSkuc3BsaXQoJyAnKTsKICB2YXIgcGFyc2VkID0gewogICAgcGF5bG9hZFR5cGU6IHBhcnNlSW50KHBhcnRzLnNoaWZ0KCksIDEwKSAvLyB3YXM6IGlkCiAgfTsKCiAgcGFydHMgPSBwYXJ0c1swXS5zcGxpdCgnLycpOwoKICBwYXJzZWQubmFtZSA9IHBhcnRzWzBdOwogIHBhcnNlZC5jbG9ja1JhdGUgPSBwYXJzZUludChwYXJ0c1sxXSwgMTApOyAvLyB3YXM6IGNsb2NrcmF0ZQogIC8vIHdhczogY2hhbm5lbHMKICBwYXJzZWQubnVtQ2hhbm5lbHMgPSBwYXJ0cy5sZW5ndGggPT09IDMgPyBwYXJzZUludChwYXJ0c1syXSwgMTApIDogMTsKICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGUgYW4gYT1ydHBtYXAgbGluZSBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvcgovLyBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRwTWFwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgcmV0dXJuICdhPXJ0cG1hcDonICsgcHQgKyAnICcgKyBjb2RlYy5uYW1lICsgJy8nICsgY29kZWMuY2xvY2tSYXRlICsKICAgICAgKGNvZGVjLm51bUNoYW5uZWxzICE9PSAxID8gJy8nICsgY29kZWMubnVtQ2hhbm5lbHMgOiAnJykgKyAnXHJcbic7Cn07CgovLyBQYXJzZXMgYW4gYT1leHRtYXAgbGluZSAoaGVhZGVyZXh0ZW5zaW9uIGZyb20gUkZDIDUyODUpLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9ZXh0bWFwOjIgdXJuOmlldGY6cGFyYW1zOnJ0cC1oZHJleHQ6dG9mZnNldApTRFBVdGlscy5wYXJzZUV4dG1hcCA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cig5KS5zcGxpdCgnICcpOwogIHJldHVybiB7CiAgICBpZDogcGFyc2VJbnQocGFydHNbMF0sIDEwKSwKICAgIHVyaTogcGFydHNbMV0KICB9Owp9OwoKLy8gR2VuZXJhdGVzIGE9ZXh0bWFwIGxpbmUgZnJvbSBSVENSdHBIZWFkZXJFeHRlbnNpb25QYXJhbWV0ZXJzIG9yCi8vIFJUQ1J0cEhlYWRlckV4dGVuc2lvbi4KU0RQVXRpbHMud3JpdGVFeHRtYXAgPSBmdW5jdGlvbihoZWFkZXJFeHRlbnNpb24pIHsKICByZXR1cm4gJ2E9ZXh0bWFwOicgKyAoaGVhZGVyRXh0ZW5zaW9uLmlkIHx8IGhlYWRlckV4dGVuc2lvbi5wcmVmZXJyZWRJZCkgKwogICAgICAgJyAnICsgaGVhZGVyRXh0ZW5zaW9uLnVyaSArICdcclxuJzsKfTsKCi8vIFBhcnNlcyBhbiBmdG1wIGxpbmUsIHJldHVybnMgZGljdGlvbmFyeS4gU2FtcGxlIGlucHV0OgovLyBhPWZtdHA6OTYgdmJyPW9uO2NuZz1vbgovLyBBbHNvIGRlYWxzIHdpdGggdmJyPW9uOyBjbmc9b24KU0RQVXRpbHMucGFyc2VGbXRwID0gZnVuY3Rpb24obGluZSkgewogIHZhciBwYXJzZWQgPSB7fTsKICB2YXIga3Y7CiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIobGluZS5pbmRleE9mKCcgJykgKyAxKS5zcGxpdCgnOycpOwogIGZvciAodmFyIGogPSAwOyBqIDwgcGFydHMubGVuZ3RoOyBqKyspIHsKICAgIGt2ID0gcGFydHNbal0udHJpbSgpLnNwbGl0KCc9Jyk7CiAgICBwYXJzZWRba3ZbMF0udHJpbSgpXSA9IGt2WzFdOwogIH0KICByZXR1cm4gcGFyc2VkOwp9OwoKLy8gR2VuZXJhdGVzIGFuIGE9ZnRtcCBsaW5lIGZyb20gUlRDUnRwQ29kZWNDYXBhYmlsaXR5IG9yIFJUQ1J0cENvZGVjUGFyYW1ldGVycy4KU0RQVXRpbHMud3JpdGVGbXRwID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZSA9ICcnOwogIHZhciBwdCA9IGNvZGVjLnBheWxvYWRUeXBlOwogIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICBwdCA9IGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlOwogIH0KICBpZiAoY29kZWMucGFyYW1ldGVycyAmJiBPYmplY3Qua2V5cyhjb2RlYy5wYXJhbWV0ZXJzKS5sZW5ndGgpIHsKICAgIHZhciBwYXJhbXMgPSBbXTsKICAgIE9iamVjdC5rZXlzKGNvZGVjLnBhcmFtZXRlcnMpLmZvckVhY2goZnVuY3Rpb24ocGFyYW0pIHsKICAgICAgcGFyYW1zLnB1c2gocGFyYW0gKyAnPScgKyBjb2RlYy5wYXJhbWV0ZXJzW3BhcmFtXSk7CiAgICB9KTsKICAgIGxpbmUgKz0gJ2E9Zm10cDonICsgcHQgKyAnICcgKyBwYXJhbXMuam9pbignOycpICsgJ1xyXG4nOwogIH0KICByZXR1cm4gbGluZTsKfTsKCi8vIFBhcnNlcyBhbiBydGNwLWZiIGxpbmUsIHJldHVybnMgUlRDUFJ0Y3BGZWVkYmFjayBvYmplY3QuIFNhbXBsZSBpbnB1dDoKLy8gYT1ydGNwLWZiOjk4IG5hY2sgcnBzaQpTRFBVdGlscy5wYXJzZVJ0Y3BGYiA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cihsaW5lLmluZGV4T2YoJyAnKSArIDEpLnNwbGl0KCcgJyk7CiAgcmV0dXJuIHsKICAgIHR5cGU6IHBhcnRzLnNoaWZ0KCksCiAgICBwYXJhbWV0ZXI6IHBhcnRzLmpvaW4oJyAnKQogIH07Cn07Ci8vIEdlbmVyYXRlIGE9cnRjcC1mYiBsaW5lcyBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvciBSVENSdHBDb2RlY1BhcmFtZXRlcnMuClNEUFV0aWxzLndyaXRlUnRjcEZiID0gZnVuY3Rpb24oY29kZWMpIHsKICB2YXIgbGluZXMgPSAnJzsKICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTsKICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICB9CiAgaWYgKGNvZGVjLnJ0Y3BGZWVkYmFjayAmJiBjb2RlYy5ydGNwRmVlZGJhY2subGVuZ3RoKSB7CiAgICAvLyBGSVhNRTogc3BlY2lhbCBoYW5kbGluZyBmb3IgdHJyLWludD8KICAgIGNvZGVjLnJ0Y3BGZWVkYmFjay5mb3JFYWNoKGZ1bmN0aW9uKGZiKSB7CiAgICAgIGxpbmVzICs9ICdhPXJ0Y3AtZmI6JyArIHB0ICsgJyAnICsgZmIudHlwZSArCiAgICAgIChmYi5wYXJhbWV0ZXIgJiYgZmIucGFyYW1ldGVyLmxlbmd0aCA/ICcgJyArIGZiLnBhcmFtZXRlciA6ICcnKSArCiAgICAgICAgICAnXHJcbic7CiAgICB9KTsKICB9CiAgcmV0dXJuIGxpbmVzOwp9OwoKLy8gUGFyc2VzIGFuIFJGQyA1NTc2IHNzcmMgbWVkaWEgYXR0cmlidXRlLiBTYW1wbGUgaW5wdXQ6Ci8vIGE9c3NyYzozNzM1OTI4NTU5IGNuYW1lOnNvbWV0aGluZwpTRFBVdGlscy5wYXJzZVNzcmNNZWRpYSA9IGZ1bmN0aW9uKGxpbmUpIHsKICB2YXIgc3AgPSBsaW5lLmluZGV4T2YoJyAnKTsKICB2YXIgcGFydHMgPSB7CiAgICBzc3JjOiBwYXJzZUludChsaW5lLnN1YnN0cig3LCBzcCAtIDcpLCAxMCkKICB9OwogIHZhciBjb2xvbiA9IGxpbmUuaW5kZXhPZignOicsIHNwKTsKICBpZiAoY29sb24gPiAtMSkgewogICAgcGFydHMuYXR0cmlidXRlID0gbGluZS5zdWJzdHIoc3AgKyAxLCBjb2xvbiAtIHNwIC0gMSk7CiAgICBwYXJ0cy52YWx1ZSA9IGxpbmUuc3Vic3RyKGNvbG9uICsgMSk7CiAgfSBlbHNlIHsKICAgIHBhcnRzLmF0dHJpYnV0ZSA9IGxpbmUuc3Vic3RyKHNwICsgMSk7CiAgfQogIHJldHVybiBwYXJ0czsKfTsKCi8vIEV4dHJhY3RzIERUTFMgcGFyYW1ldGVycyBmcm9tIFNEUCBtZWRpYSBzZWN0aW9uIG9yIHNlc3Npb25wYXJ0LgovLyBGSVhNRTogZm9yIGNvbnNpc3RlbmN5IHdpdGggb3RoZXIgZnVuY3Rpb25zIHRoaXMgc2hvdWxkIG9ubHkKLy8gICBnZXQgdGhlIGZpbmdlcnByaW50IGxpbmUgYXMgaW5wdXQuIFNlZSBhbHNvIGdldEljZVBhcmFtZXRlcnMuClNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBmcExpbmUgPSBsaW5lcy5maWx0ZXIoZnVuY3Rpb24obGluZSkgewogICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1maW5nZXJwcmludDonKSA9PT0gMDsKICB9KVswXS5zdWJzdHIoMTQpOwogIC8vIE5vdGU6IGE9c2V0dXAgbGluZSBpcyBpZ25vcmVkIHNpbmNlIHdlIHVzZSB0aGUgJ2F1dG8nIHJvbGUuCiAgdmFyIGR0bHNQYXJhbWV0ZXJzID0gewogICAgcm9sZTogJ2F1dG8nLAogICAgZmluZ2VycHJpbnRzOiBbewogICAgICBhbGdvcml0aG06IGZwTGluZS5zcGxpdCgnICcpWzBdLAogICAgICB2YWx1ZTogZnBMaW5lLnNwbGl0KCcgJylbMV0KICAgIH1dCiAgfTsKICByZXR1cm4gZHRsc1BhcmFtZXRlcnM7Cn07CgovLyBTZXJpYWxpemVzIERUTFMgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMgPSBmdW5jdGlvbihwYXJhbXMsIHNldHVwVHlwZSkgewogIHZhciBzZHAgPSAnYT1zZXR1cDonICsgc2V0dXBUeXBlICsgJ1xyXG4nOwogIHBhcmFtcy5maW5nZXJwcmludHMuZm9yRWFjaChmdW5jdGlvbihmcCkgewogICAgc2RwICs9ICdhPWZpbmdlcnByaW50OicgKyBmcC5hbGdvcml0aG0gKyAnICcgKyBmcC52YWx1ZSArICdcclxuJzsKICB9KTsKICByZXR1cm4gc2RwOwp9OwovLyBQYXJzZXMgSUNFIGluZm9ybWF0aW9uIGZyb20gU0RQIG1lZGlhIHNlY3Rpb24gb3Igc2Vzc2lvbnBhcnQuCi8vIEZJWE1FOiBmb3IgY29uc2lzdGVuY3kgd2l0aCBvdGhlciBmdW5jdGlvbnMgdGhpcyBzaG91bGQgb25seQovLyAgIGdldCB0aGUgaWNlLXVmcmFnIGFuZCBpY2UtcHdkIGxpbmVzIGFzIGlucHV0LgpTRFBVdGlscy5nZXRJY2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkgewogIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTsKICAvLyBTZWFyY2ggaW4gc2Vzc2lvbiBwYXJ0LCB0b28uCiAgbGluZXMgPSBsaW5lcy5jb25jYXQoU0RQVXRpbHMuc3BsaXRMaW5lcyhzZXNzaW9ucGFydCkpOwogIHZhciBpY2VQYXJhbWV0ZXJzID0gewogICAgdXNlcm5hbWVGcmFnbWVudDogbGluZXMuZmlsdGVyKGZ1bmN0aW9uKGxpbmUpIHsKICAgICAgcmV0dXJuIGxpbmUuaW5kZXhPZignYT1pY2UtdWZyYWc6JykgPT09IDA7CiAgICB9KVswXS5zdWJzdHIoMTIpLAogICAgcGFzc3dvcmQ6IGxpbmVzLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7CiAgICAgIHJldHVybiBsaW5lLmluZGV4T2YoJ2E9aWNlLXB3ZDonKSA9PT0gMDsKICAgIH0pWzBdLnN1YnN0cigxMCkKICB9OwogIHJldHVybiBpY2VQYXJhbWV0ZXJzOwp9OwoKLy8gU2VyaWFsaXplcyBJQ0UgcGFyYW1ldGVycyB0byBTRFAuClNEUFV0aWxzLndyaXRlSWNlUGFyYW1ldGVycyA9IGZ1bmN0aW9uKHBhcmFtcykgewogIHJldHVybiAnYT1pY2UtdWZyYWc6JyArIHBhcmFtcy51c2VybmFtZUZyYWdtZW50ICsgJ1xyXG4nICsKICAgICAgJ2E9aWNlLXB3ZDonICsgcGFyYW1zLnBhc3N3b3JkICsgJ1xyXG4nOwp9OwoKLy8gUGFyc2VzIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBhbmQgcmV0dXJucyBSVENSdHBQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHsKICB2YXIgZGVzY3JpcHRpb24gPSB7CiAgICBjb2RlY3M6IFtdLAogICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICBmZWNNZWNoYW5pc21zOiBbXSwKICAgIHJ0Y3A6IFtdCiAgfTsKICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7CiAgdmFyIG1saW5lID0gbGluZXNbMF0uc3BsaXQoJyAnKTsKICBmb3IgKHZhciBpID0gMzsgaSA8IG1saW5lLmxlbmd0aDsgaSsrKSB7IC8vIGZpbmQgYWxsIGNvZGVjcyBmcm9tIG1saW5lWzMuLl0KICAgIHZhciBwdCA9IG1saW5lW2ldOwogICAgdmFyIHJ0cG1hcGxpbmUgPSBTRFBVdGlscy5tYXRjaFByZWZpeCgKICAgICAgICBtZWRpYVNlY3Rpb24sICdhPXJ0cG1hcDonICsgcHQgKyAnICcpWzBdOwogICAgaWYgKHJ0cG1hcGxpbmUpIHsKICAgICAgdmFyIGNvZGVjID0gU0RQVXRpbHMucGFyc2VSdHBNYXAocnRwbWFwbGluZSk7CiAgICAgIHZhciBmbXRwcyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1mbXRwOicgKyBwdCArICcgJyk7CiAgICAgIC8vIE9ubHkgdGhlIGZpcnN0IGE9Zm10cDo8cHQ+IGlzIGNvbnNpZGVyZWQuCiAgICAgIGNvZGVjLnBhcmFtZXRlcnMgPSBmbXRwcy5sZW5ndGggPyBTRFBVdGlscy5wYXJzZUZtdHAoZm10cHNbMF0pIDoge307CiAgICAgIGNvZGVjLnJ0Y3BGZWVkYmFjayA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KAogICAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1ydGNwLWZiOicgKyBwdCArICcgJykKICAgICAgICAubWFwKFNEUFV0aWxzLnBhcnNlUnRjcEZiKTsKICAgICAgZGVzY3JpcHRpb24uY29kZWNzLnB1c2goY29kZWMpOwogICAgICAvLyBwYXJzZSBGRUMgbWVjaGFuaXNtcyBmcm9tIHJ0cG1hcCBsaW5lcy4KICAgICAgc3dpdGNoIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkpIHsKICAgICAgICBjYXNlICdSRUQnOgogICAgICAgIGNhc2UgJ1VMUEZFQyc6CiAgICAgICAgICBkZXNjcmlwdGlvbi5mZWNNZWNoYW5pc21zLnB1c2goY29kZWMubmFtZS50b1VwcGVyQ2FzZSgpKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6IC8vIG9ubHkgUkVEIGFuZCBVTFBGRUMgYXJlIHJlY29nbml6ZWQgYXMgRkVDIG1lY2hhbmlzbXMuCiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0KICBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPWV4dG1hcDonKS5mb3JFYWNoKGZ1bmN0aW9uKGxpbmUpIHsKICAgIGRlc2NyaXB0aW9uLmhlYWRlckV4dGVuc2lvbnMucHVzaChTRFBVdGlscy5wYXJzZUV4dG1hcChsaW5lKSk7CiAgfSk7CiAgLy8gRklYTUU6IHBhcnNlIHJ0Y3AuCiAgcmV0dXJuIGRlc2NyaXB0aW9uOwp9OwoKLy8gR2VuZXJhdGVzIHBhcnRzIG9mIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBkZXNjcmliaW5nIHRoZSBjYXBhYmlsaXRpZXMgLwovLyBwYXJhbWV0ZXJzLgpTRFBVdGlscy53cml0ZVJ0cERlc2NyaXB0aW9uID0gZnVuY3Rpb24oa2luZCwgY2FwcykgewogIHZhciBzZHAgPSAnJzsKCiAgLy8gQnVpbGQgdGhlIG1saW5lLgogIHNkcCArPSAnbT0nICsga2luZCArICcgJzsKICBzZHAgKz0gY2Fwcy5jb2RlY3MubGVuZ3RoID4gMCA/ICc5JyA6ICcwJzsgLy8gcmVqZWN0IGlmIG5vIGNvZGVjcy4KICBzZHAgKz0gJyBVRFAvVExTL1JUUC9TQVZQRiAnOwogIHNkcCArPSBjYXBzLmNvZGVjcy5tYXAoZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTsKICAgIH0KICAgIHJldHVybiBjb2RlYy5wYXlsb2FkVHlwZTsKICB9KS5qb2luKCcgJykgKyAnXHJcbic7CgogIHNkcCArPSAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nOwogIHNkcCArPSAnYT1ydGNwOjkgSU4gSVA0IDAuMC4wLjBcclxuJzsKCiAgLy8gQWRkIGE9cnRwbWFwIGxpbmVzIGZvciBlYWNoIGNvZGVjLiBBbHNvIGZtdHAgYW5kIHJ0Y3AtZmIuCiAgY2Fwcy5jb2RlY3MuZm9yRWFjaChmdW5jdGlvbihjb2RlYykgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRwTWFwKGNvZGVjKTsKICAgIHNkcCArPSBTRFBVdGlscy53cml0ZUZtdHAoY29kZWMpOwogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRjcEZiKGNvZGVjKTsKICB9KTsKICB2YXIgbWF4cHRpbWUgPSAwOwogIGNhcHMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5tYXhwdGltZSA+IG1heHB0aW1lKSB7CiAgICAgIG1heHB0aW1lID0gY29kZWMubWF4cHRpbWU7CiAgICB9CiAgfSk7CiAgaWYgKG1heHB0aW1lID4gMCkgewogICAgc2RwICs9ICdhPW1heHB0aW1lOicgKyBtYXhwdGltZSArICdcclxuJzsKICB9CiAgc2RwICs9ICdhPXJ0Y3AtbXV4XHJcbic7CgogIGNhcHMuaGVhZGVyRXh0ZW5zaW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGV4dGVuc2lvbikgewogICAgc2RwICs9IFNEUFV0aWxzLndyaXRlRXh0bWFwKGV4dGVuc2lvbik7CiAgfSk7CiAgLy8gRklYTUU6IHdyaXRlIGZlY01lY2hhbmlzbXMuCiAgcmV0dXJuIHNkcDsKfTsKCi8vIFBhcnNlcyB0aGUgU0RQIG1lZGlhIHNlY3Rpb24gYW5kIHJldHVybnMgYW4gYXJyYXkgb2YKLy8gUlRDUnRwRW5jb2RpbmdQYXJhbWV0ZXJzLgpTRFBVdGlscy5wYXJzZVJ0cEVuY29kaW5nUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikgewogIHZhciBlbmNvZGluZ1BhcmFtZXRlcnMgPSBbXTsKICB2YXIgZGVzY3JpcHRpb24gPSBTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMobWVkaWFTZWN0aW9uKTsKICB2YXIgaGFzUmVkID0gZGVzY3JpcHRpb24uZmVjTWVjaGFuaXNtcy5pbmRleE9mKCdSRUQnKSAhPT0gLTE7CiAgdmFyIGhhc1VscGZlYyA9IGRlc2NyaXB0aW9uLmZlY01lY2hhbmlzbXMuaW5kZXhPZignVUxQRkVDJykgIT09IC0xOwoKICAvLyBmaWx0ZXIgYT1zc3JjOi4uLiBjbmFtZTosIGlnbm9yZSBQbGFuQi1tc2lkCiAgdmFyIHNzcmNzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjOicpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgfSkKICAuZmlsdGVyKGZ1bmN0aW9uKHBhcnRzKSB7CiAgICByZXR1cm4gcGFydHMuYXR0cmlidXRlID09PSAnY25hbWUnOwogIH0pOwogIHZhciBwcmltYXJ5U3NyYyA9IHNzcmNzLmxlbmd0aCA+IDAgJiYgc3NyY3NbMF0uc3NyYzsKICB2YXIgc2Vjb25kYXJ5U3NyYzsKCiAgdmFyIGZsb3dzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjLWdyb3VwOkZJRCcpCiAgLm1hcChmdW5jdGlvbihsaW5lKSB7CiAgICB2YXIgcGFydHMgPSBsaW5lLnNwbGl0KCcgJyk7CiAgICBwYXJ0cy5zaGlmdCgpOwogICAgcmV0dXJuIHBhcnRzLm1hcChmdW5jdGlvbihwYXJ0KSB7CiAgICAgIHJldHVybiBwYXJzZUludChwYXJ0LCAxMCk7CiAgICB9KTsKICB9KTsKICBpZiAoZmxvd3MubGVuZ3RoID4gMCAmJiBmbG93c1swXS5sZW5ndGggPiAxICYmIGZsb3dzWzBdWzBdID09PSBwcmltYXJ5U3NyYykgewogICAgc2Vjb25kYXJ5U3NyYyA9IGZsb3dzWzBdWzFdOwogIH0KCiAgZGVzY3JpcHRpb24uY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgIGlmIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkgPT09ICdSVFgnICYmIGNvZGVjLnBhcmFtZXRlcnMuYXB0KSB7CiAgICAgIHZhciBlbmNQYXJhbSA9IHsKICAgICAgICBzc3JjOiBwcmltYXJ5U3NyYywKICAgICAgICBjb2RlY1BheWxvYWRUeXBlOiBwYXJzZUludChjb2RlYy5wYXJhbWV0ZXJzLmFwdCwgMTApLAogICAgICAgIHJ0eDogewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYwogICAgICAgIH0KICAgICAgfTsKICAgICAgZW5jb2RpbmdQYXJhbWV0ZXJzLnB1c2goZW5jUGFyYW0pOwogICAgICBpZiAoaGFzUmVkKSB7CiAgICAgICAgZW5jUGFyYW0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVuY1BhcmFtKSk7CiAgICAgICAgZW5jUGFyYW0uZmVjID0gewogICAgICAgICAgc3NyYzogc2Vjb25kYXJ5U3NyYywKICAgICAgICAgIG1lY2hhbmlzbTogaGFzVWxwZmVjID8gJ3JlZCt1bHBmZWMnIDogJ3JlZCcKICAgICAgICB9OwogICAgICAgIGVuY29kaW5nUGFyYW1ldGVycy5wdXNoKGVuY1BhcmFtKTsKICAgICAgfQogICAgfQogIH0pOwogIGlmIChlbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoID09PSAwICYmIHByaW1hcnlTc3JjKSB7CiAgICBlbmNvZGluZ1BhcmFtZXRlcnMucHVzaCh7CiAgICAgIHNzcmM6IHByaW1hcnlTc3JjCiAgICB9KTsKICB9CgogIC8vIHdlIHN1cHBvcnQgYm90aCBiPUFTIGFuZCBiPVRJQVMgYnV0IGludGVycHJldCBBUyBhcyBUSUFTLgogIHZhciBiYW5kd2lkdGggPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdiPScpOwogIGlmIChiYW5kd2lkdGgubGVuZ3RoKSB7CiAgICBpZiAoYmFuZHdpZHRoWzBdLmluZGV4T2YoJ2I9VElBUzonKSA9PT0gMCkgewogICAgICBiYW5kd2lkdGggPSBwYXJzZUludChiYW5kd2lkdGhbMF0uc3Vic3RyKDcpLCAxMCk7CiAgICB9IGVsc2UgaWYgKGJhbmR3aWR0aFswXS5pbmRleE9mKCdiPUFTOicpID09PSAwKSB7CiAgICAgIGJhbmR3aWR0aCA9IHBhcnNlSW50KGJhbmR3aWR0aFswXS5zdWJzdHIoNSksIDEwKTsKICAgIH0KICAgIGVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtcykgewogICAgICBwYXJhbXMubWF4Qml0cmF0ZSA9IGJhbmR3aWR0aDsKICAgIH0pOwogIH0KICByZXR1cm4gZW5jb2RpbmdQYXJhbWV0ZXJzOwp9OwoKU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUgPSBmdW5jdGlvbigpIHsKICAvLyBGSVhNRTogc2Vzcy1pZCBzaG91bGQgYmUgYW4gTlRQIHRpbWVzdGFtcC4KICByZXR1cm4gJ3Y9MFxyXG4nICsKICAgICAgJ289dGhpc2lzYWRhcHRlcm9ydGMgODE2OTYzOTkxNTY0Njk0MzEzNyAyIElOIElQNCAxMjcuMC4wLjFcclxuJyArCiAgICAgICdzPS1cclxuJyArCiAgICAgICd0PTAgMFxyXG4nOwp9OwoKU0RQVXRpbHMud3JpdGVNZWRpYVNlY3Rpb24gPSBmdW5jdGlvbih0cmFuc2NlaXZlciwgY2FwcywgdHlwZSwgc3RyZWFtKSB7CiAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlUnRwRGVzY3JpcHRpb24odHJhbnNjZWl2ZXIua2luZCwgY2Fwcyk7CgogIC8vIE1hcCBJQ0UgcGFyYW1ldGVycyAodWZyYWcsIHB3ZCkgdG8gU0RQLgogIHNkcCArPSBTRFBVdGlscy53cml0ZUljZVBhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmdldExvY2FsUGFyYW1ldGVycygpKTsKCiAgLy8gTWFwIERUTFMgcGFyYW1ldGVycyB0byBTRFAuCiAgc2RwICs9IFNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMoCiAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuZ2V0TG9jYWxQYXJhbWV0ZXJzKCksCiAgICAgIHR5cGUgPT09ICdvZmZlcicgPyAnYWN0cGFzcycgOiAnYWN0aXZlJyk7CgogIHNkcCArPSAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlciAmJiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcikgewogICAgc2RwICs9ICdhPXNlbmRyZWN2XHJcbic7CiAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHsKICAgIHNkcCArPSAnYT1zZW5kb25seVxyXG4nOwogIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgIHNkcCArPSAnYT1yZWN2b25seVxyXG4nOwogIH0gZWxzZSB7CiAgICBzZHAgKz0gJ2E9aW5hY3RpdmVcclxuJzsKICB9CgogIC8vIEZJWE1FOiBmb3IgUlRYIHRoZXJlIG1pZ2h0IGJlIG11bHRpcGxlIFNTUkNzLiBOb3QgaW1wbGVtZW50ZWQgaW4gRWRnZSB5ZXQuCiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlcikgewogICAgdmFyIG1zaWQgPSAnbXNpZDonICsgc3RyZWFtLmlkICsgJyAnICsKICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIudHJhY2suaWQgKyAnXHJcbic7CiAgICBzZHAgKz0gJ2E9JyArIG1zaWQ7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgICAnICcgKyBtc2lkOwogICAgaWYgKHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICAgIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICcgJyArIG1zaWQ7CiAgICAgIHNkcCArPSAnYT1zc3JjLWdyb3VwOkZJRCAnICsKICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYyArICcgJyArCiAgICAgICAgICB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICsKICAgICAgICAgICdcclxuJzsKICAgIH0KICB9CiAgLy8gRklYTUU6IHRoaXMgc2hvdWxkIGJlIHdyaXR0ZW4gYnkgd3JpdGVSdHBEZXNjcmlwdGlvbi4KICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsKICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7CiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHguc3NyYyArCiAgICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcclxuJzsKICB9CiAgcmV0dXJuIHNkcDsKfTsKCi8vIEdldHMgdGhlIGRpcmVjdGlvbiBmcm9tIHRoZSBtZWRpYVNlY3Rpb24gb3IgdGhlIHNlc3Npb25wYXJ0LgpTRFBVdGlscy5nZXREaXJlY3Rpb24gPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KSB7CiAgLy8gTG9vayBmb3Igc2VuZHJlY3YsIHNlbmRvbmx5LCByZWN2b25seSwgaW5hY3RpdmUsIGRlZmF1bHQgdG8gc2VuZHJlY3YuCiAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHsKICAgIHN3aXRjaCAobGluZXNbaV0pIHsKICAgICAgY2FzZSAnYT1zZW5kcmVjdic6CiAgICAgIGNhc2UgJ2E9c2VuZG9ubHknOgogICAgICBjYXNlICdhPXJlY3Zvbmx5JzoKICAgICAgY2FzZSAnYT1pbmFjdGl2ZSc6CiAgICAgICAgcmV0dXJuIGxpbmVzW2ldLnN1YnN0cigyKTsKICAgICAgZGVmYXVsdDoKICAgICAgICAvLyBGSVhNRTogV2hhdCBzaG91bGQgaGFwcGVuIGhlcmU/CiAgICB9CiAgfQogIGlmIChzZXNzaW9ucGFydCkgewogICAgcmV0dXJuIFNEUFV0aWxzLmdldERpcmVjdGlvbihzZXNzaW9ucGFydCk7CiAgfQogIHJldHVybiAnc2VuZHJlY3YnOwp9OwoKLy8gRXhwb3NlIHB1YmxpYyBtZXRob2RzLgptb2R1bGUuZXhwb3J0cyA9IFNEUFV0aWxzOwoKfSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8vIHZlcnNpb246IDAuNS4xCi8vIGRhdGU6IFR1ZSBGZWIgMDcgMjAxNyAxNjowMDozOSBHTVQrMDAwMCAoV0VUKQovLyBsaWNlbmNlOiAKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgoKKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiU3luY2hlciIsIFtdLCBmYWN0b3J5KTsKCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCWV4cG9ydHNbIlN5bmNoZXIiXSA9IGZhY3RvcnkoKTsKCWVsc2UKCQlyb290WyIiXSA9IHJvb3RbIiJdIHx8IHt9LCByb290WyIiXVsiU3luY2hlciJdID0gZmFjdG9yeSgpOwp9KSh0aGlzLCBmdW5jdGlvbigpIHsKcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXAKLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCXZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307Ci8qKioqKiovCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLwovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQovKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJaTogbW9kdWxlSWQsCi8qKioqKiovIAkJCWw6IGZhbHNlLAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZAovKioqKioqLyAJCW1vZHVsZS5sID0gdHJ1ZTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8KLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7Ci8qKioqKiovCi8qKioqKiovIAkvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0Ci8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07Ci8qKioqKiovCi8qKioqKiovIAkvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHMKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikgewovKioqKioqLyAJCWlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKLyoqKioqKi8gCQkJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsKLyoqKioqKi8gCQkJCWNvbmZpZ3VyYWJsZTogZmFsc2UsCi8qKioqKiovIAkJCQllbnVtZXJhYmxlOiB0cnVlLAovKioqKioqLyAJCQkJZ2V0OiBnZXR0ZXIKLyoqKioqKi8gCQkJfSk7Ci8qKioqKiovIAkJfQovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHsKLyoqKioqKi8gCQl2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID8KLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTsKLyoqKioqKi8gCQlfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7Ci8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKLyoqKioqKi8KLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMTYyKTsKLyoqKioqKi8gfSkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gKFsKLyogMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0ge3ZlcnNpb246ICcyLjQuMCd9OwppZih0eXBlb2YgX19lID09ICdudW1iZXInKV9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy84NiNpc3N1ZWNvbW1lbnQtMTE1NzU5MDI4CnZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aAogID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsKaWYodHlwZW9mIF9fZyA9PSAnbnVtYmVyJylfX2cgPSBnbG9iYWw7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCi8qKiovIH0pLAovKiAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzdG9yZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ3drcycpCiAgLCB1aWQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykKICAsIFN5bWJvbCAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLlN5bWJvbAogICwgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJzsKCnZhciAkZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obmFtZSl7CiAgcmV0dXJuIHN0b3JlW25hbWVdIHx8IChzdG9yZVtuYW1lXSA9CiAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IHVpZCkoJ1N5bWJvbC4nICsgbmFtZSkpOwp9OwoKJGV4cG9ydHMuc3RvcmUgPSBzdG9yZTsKCi8qKiovIH0pLAovKiAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHkKbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGRQICAgICAgICAgICAgID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpewogIGFuT2JqZWN0KE8pOwogIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKICBhbk9iamVjdChBdHRyaWJ1dGVzKTsKICBpZihJRThfRE9NX0RFRklORSl0cnkgewogICAgcmV0dXJuIGRQKE8sIFAsIEF0dHJpYnV0ZXMpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICBpZignZ2V0JyBpbiBBdHRyaWJ1dGVzIHx8ICdzZXQnIGluIEF0dHJpYnV0ZXMpdGhyb3cgVHlwZUVycm9yKCdBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEnKTsKICBpZigndmFsdWUnIGluIEF0dHJpYnV0ZXMpT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZighaXNPYmplY3QoaXQpKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKICAsIGNyZWF0ZURlc2MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpID8gZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICByZXR1cm4gZFAuZihvYmplY3QsIGtleSwgY3JlYXRlRGVzYygxLCB2YWx1ZSkpOwp9IDogZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKICBvYmplY3Rba2V5XSA9IHZhbHVlOwogIHJldHVybiBvYmplY3Q7Cn07CgovKioqLyB9KSwKLyogNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nOwp9OwoKLyoqKi8gfSksCi8qIDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGNvcmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGN0eCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCiAgLCBoaWRlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCiAgLCBQUk9UT1RZUEUgPSAncHJvdG90eXBlJzsKCnZhciAkZXhwb3J0ID0gZnVuY3Rpb24odHlwZSwgbmFtZSwgc291cmNlKXsKICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRgogICAgLCBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HCiAgICAsIElTX1NUQVRJQyA9IHR5cGUgJiAkZXhwb3J0LlMKICAgICwgSVNfUFJPVE8gID0gdHlwZSAmICRleHBvcnQuUAogICAgLCBJU19CSU5EICAgPSB0eXBlICYgJGV4cG9ydC5CCiAgICAsIElTX1dSQVAgICA9IHR5cGUgJiAkZXhwb3J0LlcKICAgICwgZXhwb3J0cyAgID0gSVNfR0xPQkFMID8gY29yZSA6IGNvcmVbbmFtZV0gfHwgKGNvcmVbbmFtZV0gPSB7fSkKICAgICwgZXhwUHJvdG8gID0gZXhwb3J0c1tQUk9UT1RZUEVdCiAgICAsIHRhcmdldCAgICA9IElTX0dMT0JBTCA/IGdsb2JhbCA6IElTX1NUQVRJQyA/IGdsb2JhbFtuYW1lXSA6IChnbG9iYWxbbmFtZV0gfHwge30pW1BST1RPVFlQRV0KICAgICwga2V5LCBvd24sIG91dDsKICBpZihJU19HTE9CQUwpc291cmNlID0gbmFtZTsKICBmb3Ioa2V5IGluIHNvdXJjZSl7CiAgICAvLyBjb250YWlucyBpbiBuYXRpdmUKICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIHRhcmdldFtrZXldICE9PSB1bmRlZmluZWQ7CiAgICBpZihvd24gJiYga2V5IGluIGV4cG9ydHMpY29udGludWU7CiAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZAogICAgb3V0ID0gb3duID8gdGFyZ2V0W2tleV0gOiBzb3VyY2Vba2V5XTsKICAgIC8vIHByZXZlbnQgZ2xvYmFsIHBvbGx1dGlvbiBmb3IgbmFtZXNwYWNlcwogICAgZXhwb3J0c1trZXldID0gSVNfR0xPQkFMICYmIHR5cGVvZiB0YXJnZXRba2V5XSAhPSAnZnVuY3Rpb24nID8gc291cmNlW2tleV0KICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0CiAgICA6IElTX0JJTkQgJiYgb3duID8gY3R4KG91dCwgZ2xvYmFsKQogICAgLy8gd3JhcCBnbG9iYWwgY29uc3RydWN0b3JzIGZvciBwcmV2ZW50IGNoYW5nZSB0aGVtIGluIGxpYnJhcnkKICAgIDogSVNfV1JBUCAmJiB0YXJnZXRba2V5XSA9PSBvdXQgPyAoZnVuY3Rpb24oQyl7CiAgICAgIHZhciBGID0gZnVuY3Rpb24oYSwgYiwgYyl7CiAgICAgICAgaWYodGhpcyBpbnN0YW5jZW9mIEMpewogICAgICAgICAgc3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpewogICAgICAgICAgICBjYXNlIDA6IHJldHVybiBuZXcgQzsKICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gbmV3IEMoYSk7CiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBDKGEsIGIpOwogICAgICAgICAgfSByZXR1cm4gbmV3IEMoYSwgYiwgYyk7CiAgICAgICAgfSByZXR1cm4gQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgICBGW1BST1RPVFlQRV0gPSBDW1BST1RPVFlQRV07CiAgICAgIHJldHVybiBGOwogICAgLy8gbWFrZSBzdGF0aWMgdmVyc2lvbnMgZm9yIHByb3RvdHlwZSBtZXRob2RzCiAgICB9KShvdXQpIDogSVNfUFJPVE8gJiYgdHlwZW9mIG91dCA9PSAnZnVuY3Rpb24nID8gY3R4KEZ1bmN0aW9uLmNhbGwsIG91dCkgOiBvdXQ7CiAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUubWV0aG9kcy4lTkFNRSUKICAgIGlmKElTX1BST1RPKXsKICAgICAgKGV4cG9ydHMudmlydHVhbCB8fCAoZXhwb3J0cy52aXJ0dWFsID0ge30pKVtrZXldID0gb3V0OwogICAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUucHJvdG90eXBlLiVOQU1FJQogICAgICBpZih0eXBlICYgJGV4cG9ydC5SICYmIGV4cFByb3RvICYmICFleHBQcm90b1trZXldKWhpZGUoZXhwUHJvdG8sIGtleSwgb3V0KTsKICAgIH0KICB9Cn07Ci8vIHR5cGUgYml0bWFwCiRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkCiRleHBvcnQuRyA9IDI7ICAgLy8gZ2xvYmFsCiRleHBvcnQuUyA9IDQ7ICAgLy8gc3RhdGljCiRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG8KJGV4cG9ydC5CID0gMTY7ICAvLyBiaW5kCiRleHBvcnQuVyA9IDMyOyAgLy8gd3JhcAokZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmUKJGV4cG9ydC5SID0gMTI4OyAvLyByZWFsIHByb3RvIG1ldGhvZCBmb3IgYGxpYnJhcnlgIAptb2R1bGUuZXhwb3J0cyA9ICRleHBvcnQ7CgovKioqLyB9KSwKLyogOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9OwoKLyoqKi8gfSksCi8qIDEwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMzYpOwoKdmFyIF9kZWZpbmVQcm9wZXJ0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZWZpbmVQcm9wZXJ0eSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICAgICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogICAgfQogIH0KCiAgcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7CiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICAgIHJldHVybiBDb25zdHJ1Y3RvcjsKICB9Owp9KCk7CgovKioqLyB9KSwKLyogMTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjKXsKICB0cnkgewogICAgcmV0dXJuICEhZXhlYygpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn07CgovKioqLyB9KSwKLyogMTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGhhc093blByb3BlcnR5ID0ge30uaGFzT3duUHJvcGVydHk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIGtleSl7CiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoaXQsIGtleSk7Cn07CgovKioqLyB9KSwKLyogMTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzCnZhciBJT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NikKICAsIGRlZmluZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpOwp9OwoKLyoqKi8gfSksCi8qIDE0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZwp2YXIgYUZ1bmN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIHRoYXQsIGxlbmd0aCl7CiAgYUZ1bmN0aW9uKGZuKTsKICBpZih0aGF0ID09PSB1bmRlZmluZWQpcmV0dXJuIGZuOwogIHN3aXRjaChsZW5ndGgpewogICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpOwogICAgfTsKICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTsKICAgIH07CiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7CiAgICB9OwogIH0KICByZXR1cm4gZnVuY3Rpb24oLyogLi4uYXJncyAqLyl7CiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDE1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0ge307CgovKioqLyB9KSwKLyogMTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiaXRtYXAsIHZhbHVlKXsKICByZXR1cm4gewogICAgZW51bWVyYWJsZSAgOiAhKGJpdG1hcCAmIDEpLAogICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLAogICAgd3JpdGFibGUgICAgOiAhKGJpdG1hcCAmIDQpLAogICAgdmFsdWUgICAgICAgOiB2YWx1ZQogIH07Cn07CgovKioqLyB9KSwKLyogMTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjE0IC8gMTUuMi4zLjE0IE9iamVjdC5rZXlzKE8pCnZhciAka2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpOwoKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pewogIHJldHVybiAka2V5cyhPLCBlbnVtQnVnS2V5cyk7Cn07CgovKioqLyB9KSwKLyogMTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpOwp9OwoKLyoqKi8gfSksCi8qIDE5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5kb2N1bWVudAogIC8vIGluIG9sZCBJRSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JwogICwgaXMgPSBpc09iamVjdChkb2N1bWVudCkgJiYgaXNPYmplY3QoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307Cn07CgovKioqLyB9KSwKLyogMjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGRlZiA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaGFzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIFRBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3RvU3RyaW5nVGFnJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCB0YWcsIHN0YXQpewogIGlmKGl0ICYmICFoYXMoaXQgPSBzdGF0ID8gaXQgOiBpdC5wcm90b3R5cGUsIFRBRykpZGVmKGl0LCBUQUcsIHtjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiB0YWd9KTsKfTsKCi8qKiovIH0pLAovKiAyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSkKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2UKLy8gYW5kIHRoZSBzZWNvbmQgYXJndW1lbnQgLSBmbGFnIC0gcHJlZmVycmVkIHR5cGUgaXMgYSBzdHJpbmcKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgUyl7CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gaXQ7CiAgdmFyIGZuLCB2YWw7CiAgaWYoUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIGlmKHR5cGVvZiAoZm4gPSBpdC52YWx1ZU9mKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKICBpZighUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIHRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlIik7Cn07CgovKioqLyB9KSwKLyogMjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGlkID0gMAogICwgcHggPSBNYXRoLnJhbmRvbSgpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7CiAgcmV0dXJuICdTeW1ib2woJy5jb25jYXQoa2V5ID09PSB1bmRlZmluZWQgPyAnJyA6IGtleSwgJylfJywgKCsraWQgKyBweCkudG9TdHJpbmcoMzYpKTsKfTsKCi8qKiovIH0pLAovKiAyNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyA3LjIuMSBSZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGFyZ3VtZW50KQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIiArIGl0KTsKICByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogMjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSB0cnVlOwoKLyoqKi8gfSksCi8qIDI2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBzaGFyZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKSgna2V5cycpCiAgLCB1aWQgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzaGFyZWRba2V5XSB8fCAoc2hhcmVkW2tleV0gPSB1aWQoa2V5KSk7Cn07CgovKioqLyB9KSwKLyogMjcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gNy4xLjQgVG9JbnRlZ2VyCnZhciBjZWlsICA9IE1hdGguY2VpbAogICwgZmxvb3IgPSBNYXRoLmZsb29yOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXNOYU4oaXQgPSAraXQpID8gMCA6IChpdCA+IDAgPyBmbG9vciA6IGNlaWwpKGl0KTsKfTsKCi8qKiovIH0pLAovKiAyOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzCm1vZHVsZS5leHBvcnRzID0gKAogICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnCikuc3BsaXQoJywnKTsKCi8qKiovIH0pLAovKiAyOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDMpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoX193ZWJwYWNrX3JlcXVpcmVfXygxOSkoJ2RpdicpLCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiAzMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXycKICAsIHN0b3JlICA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBzdG9yZVtrZXldIHx8IChzdG9yZVtrZXldID0ge30pOwp9OwoKLyoqKi8gfSksCi8qIDMxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNzkpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogMzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KQp2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gT2JqZWN0KGRlZmluZWQoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAzMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfc2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc1KTsKCnZhciBfc2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jcmVhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc0KTsKCnZhciBfY3JlYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZSk7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzdWJDbGFzcywgc3VwZXJDbGFzcykgewogIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHN1cGVyQ2xhc3MgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoc3VwZXJDbGFzcykpKTsKICB9CgogIHN1YkNsYXNzLnByb3RvdHlwZSA9ICgwLCBfY3JlYXRlMi5kZWZhdWx0KShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7CiAgICBjb25zdHJ1Y3RvcjogewogICAgICB2YWx1ZTogc3ViQ2xhc3MsCiAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICB3cml0YWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9CiAgfSk7CiAgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZjIuZGVmYXVsdCA/ICgwLCBfc2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7Cn07CgovKioqLyB9KSwKLyogMzQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX3R5cGVvZjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzZWxmLCBjYWxsKSB7CiAgaWYgKCFzZWxmKSB7CiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOwogIH0KCiAgcmV0dXJuIGNhbGwgJiYgKCh0eXBlb2YgY2FsbCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6ICgwLCBfdHlwZW9mMy5kZWZhdWx0KShjYWxsKSkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOwp9OwoKLyoqKi8gfSksCi8qIDM1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQp2YXIgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBkUHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpCiAgLCBlbnVtQnVnS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBFbXB0eSAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KICAsIFBST1RPVFlQRSAgID0gJ3Byb3RvdHlwZSc7CgovLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlCnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24oKXsKICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1ZwogIHZhciBpZnJhbWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KSgnaWZyYW1lJykKICAgICwgaSAgICAgID0gZW51bUJ1Z0tleXMubGVuZ3RoCiAgICAsIGx0ICAgICA9ICc8JwogICAgLCBndCAgICAgPSAnPicKICAgICwgaWZyYW1lRG9jdW1lbnQ7CiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg0MikuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsCiAgLy8gY3JlYXRlRGljdCA9IGlmcmFtZS5jb250ZW50V2luZG93Lk9iamVjdDsKICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7CiAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKICBpZnJhbWVEb2N1bWVudC5vcGVuKCk7CiAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpOwogIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7CiAgY3JlYXRlRGljdCA9IGlmcmFtZURvY3VtZW50LkY7CiAgd2hpbGUoaS0tKWRlbGV0ZSBjcmVhdGVEaWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbaV1dOwogIHJldHVybiBjcmVhdGVEaWN0KCk7Cn07Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpewogIHZhciByZXN1bHQ7CiAgaWYoTyAhPT0gbnVsbCl7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7CiAgICByZXN1bHQgPSBuZXcgRW1wdHk7CiAgICBFbXB0eVtQUk9UT1RZUEVdID0gbnVsbDsKICAgIC8vIGFkZCAiX19wcm90b19fIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsCiAgICByZXN1bHRbSUVfUFJPVE9dID0gTzsKICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpOwogIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkUHMocmVzdWx0LCBQcm9wZXJ0aWVzKTsKfTsKCgovKioqLyB9KSwKLyogMzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygzNyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAzNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKXsKICByZXR1cm4gJE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKTsKfTsKCi8qKiovIH0pLAovKiAzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgTElCUkFSWSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBoaWRlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIEl0ZXJhdG9ycyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsICRpdGVyQ3JlYXRlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MikKICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSkKICAsIGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MykKICAsIElURVJBVE9SICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgQlVHR1kgICAgICAgICAgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSkgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YAogICwgRkZfSVRFUkFUT1IgICAgPSAnQEBpdGVyYXRvcicKICAsIEtFWVMgICAgICAgICAgID0gJ2tleXMnCiAgLCBWQUxVRVMgICAgICAgICA9ICd2YWx1ZXMnOwoKdmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKXsKICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7CiAgdmFyIGdldE1ldGhvZCA9IGZ1bmN0aW9uKGtpbmQpewogICAgaWYoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pcmV0dXJuIHByb3RvW2tpbmRdOwogICAgc3dpdGNoKGtpbmQpewogICAgICBjYXNlIEtFWVM6IHJldHVybiBmdW5jdGlvbiBrZXlzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CiAgfTsKICB2YXIgVEFHICAgICAgICA9IE5BTUUgKyAnIEl0ZXJhdG9yJwogICAgLCBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVMKICAgICwgVkFMVUVTX0JVRyA9IGZhbHNlCiAgICAsIHByb3RvICAgICAgPSBCYXNlLnByb3RvdHlwZQogICAgLCAkbmF0aXZlICAgID0gcHJvdG9bSVRFUkFUT1JdIHx8IHByb3RvW0ZGX0lURVJBVE9SXSB8fCBERUZBVUxUICYmIHByb3RvW0RFRkFVTFRdCiAgICAsICRkZWZhdWx0ICAgPSAkbmF0aXZlIHx8IGdldE1ldGhvZChERUZBVUxUKQogICAgLCAkZW50cmllcyAgID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZAogICAgLCAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZQogICAgLCBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlOwogIC8vIEZpeCBuYXRpdmUKICBpZigkYW55TmF0aXZlKXsKICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoJGFueU5hdGl2ZS5jYWxsKG5ldyBCYXNlKSk7CiAgICBpZihJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSl7CiAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnMKICAgICAgc2V0VG9TdHJpbmdUYWcoSXRlcmF0b3JQcm90b3R5cGUsIFRBRywgdHJ1ZSk7CiAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lcwogICAgICBpZighTElCUkFSWSAmJiAhaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikpaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwogICAgfQogIH0KICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGCiAgaWYoREVGX1ZBTFVFUyAmJiAkbmF0aXZlICYmICRuYXRpdmUubmFtZSAhPT0gVkFMVUVTKXsKICAgIFZBTFVFU19CVUcgPSB0cnVlOwogICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTsKICB9CiAgLy8gRGVmaW5lIGl0ZXJhdG9yCiAgaWYoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpewogICAgaGlkZShwcm90bywgSVRFUkFUT1IsICRkZWZhdWx0KTsKICB9CiAgLy8gUGx1ZyBmb3IgbGlicmFyeQogIEl0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0OwogIEl0ZXJhdG9yc1tUQUddICA9IHJldHVyblRoaXM7CiAgaWYoREVGQVVMVCl7CiAgICBtZXRob2RzID0gewogICAgICB2YWx1ZXM6ICBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSwKICAgICAga2V5czogICAgSVNfU0VUICAgICA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLAogICAgICBlbnRyaWVzOiAkZW50cmllcwogICAgfTsKICAgIGlmKEZPUkNFRClmb3Ioa2V5IGluIG1ldGhvZHMpewogICAgICBpZighKGtleSBpbiBwcm90bykpcmVkZWZpbmUocHJvdG8sIGtleSwgbWV0aG9kc1trZXldKTsKICAgIH0gZWxzZSAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7CiAgfQogIHJldHVybiBtZXRob2RzOwp9OwoKLyoqKi8gfSksCi8qIDM5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKLy8gMTkuMS4yLjQgLyAxNS4yLjMuNiBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhX193ZWJwYWNrX3JlcXVpcmVfXygzKSwgJ09iamVjdCcsIHtkZWZpbmVQcm9wZXJ0eTogX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mfSk7CgovKioqLyB9KSwKLyogNDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg1MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA0MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTsKCi8qKiovIH0pLAovKiA0MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZG9jdW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKLyoqKi8gfSksCi8qIDQzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi45IC8gMTUuMi4zLjIgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciBoYXMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCB0b09iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJRV9QUk9UTyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpCiAgLCBPYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihPKXsKICBPID0gdG9PYmplY3QoTyk7CiAgaWYoaGFzKE8sIElFX1BST1RPKSlyZXR1cm4gT1tJRV9QUk9UT107CiAgaWYodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcil7CiAgICByZXR1cm4gTy5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7CiAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvIDogbnVsbDsKfTsKCi8qKiovIH0pLAovKiA0NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaGFzICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIHRvSU9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCiAgLCBhcnJheUluZGV4T2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKShmYWxzZSkKICAsIElFX1BST1RPICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpKCdJRV9QUk9UTycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIG5hbWVzKXsKICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKICAgICwgaSAgICAgID0gMAogICAgLCByZXN1bHQgPSBbXQogICAgLCBrZXk7CiAgZm9yKGtleSBpbiBPKWlmKGtleSAhPSBJRV9QUk9UTyloYXMoTywga2V5KSAmJiByZXN1bHQucHVzaChrZXkpOwogIC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXMKICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKWlmKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSl7CiAgICB+YXJyYXlJbmRleE9mKHJlc3VsdCwga2V5KSB8fCByZXN1bHQucHVzaChrZXkpOwogIH0KICByZXR1cm4gcmVzdWx0Owp9OwoKLyoqKi8gfSksCi8qIDQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIG1vc3QgT2JqZWN0IG1ldGhvZHMgYnkgRVM2IHNob3VsZCBhY2NlcHQgcHJpbWl0aXZlcwp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKICAsIGNvcmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCiAgLCBmYWlscyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBleGVjKXsKICB2YXIgZm4gID0gKGNvcmUuT2JqZWN0IHx8IHt9KVtLRVldIHx8IE9iamVjdFtLRVldCiAgICAsIGV4cCA9IHt9OwogIGV4cFtLRVldID0gZXhlYyhmbik7CiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbigpeyBmbigxKTsgfSksICdPYmplY3QnLCBleHApOwp9OwoKLyoqKi8gfSksCi8qIDQ2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKCi8qKiovIH0pLAovKiA0NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMTUgVG9MZW5ndGgKdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpCiAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ID4gMCA/IG1pbih0b0ludGVnZXIoaXQpLCAweDFmZmZmZmZmZmZmZmZmKSA6IDA7IC8vIHBvdygyLCA1MykgLSAxID09IDkwMDcxOTkyNTQ3NDA5OTEKfTsKCi8qKiovIH0pLAovKiA0OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIExJQlJBUlkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKICAsIHdrc0V4dCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkKICAsIGRlZmluZVByb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewogIHZhciAkU3ltYm9sID0gY29yZS5TeW1ib2wgfHwgKGNvcmUuU3ltYm9sID0gTElCUkFSWSA/IHt9IDogZ2xvYmFsLlN5bWJvbCB8fCB7fSk7CiAgaWYobmFtZS5jaGFyQXQoMCkgIT0gJ18nICYmICEobmFtZSBpbiAkU3ltYm9sKSlkZWZpbmVQcm9wZXJ0eSgkU3ltYm9sLCBuYW1lLCB7dmFsdWU6IHdrc0V4dC5mKG5hbWUpfSk7Cn07CgovKioqLyB9KSwKLyogNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTsKCi8qKiovIH0pLAovKiA1MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgJGF0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNjYpKHRydWUpOwoKLy8gMjEuMS4zLjI3IFN0cmluZy5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQpfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KShTdHJpbmcsICdTdHJpbmcnLCBmdW5jdGlvbihpdGVyYXRlZCl7CiAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4Ci8vIDIxLjEuNS4yLjEgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKfSwgZnVuY3Rpb24oKXsKICB2YXIgTyAgICAgPSB0aGlzLl90CiAgICAsIGluZGV4ID0gdGhpcy5faQogICAgLCBwb2ludDsKICBpZihpbmRleCA+PSBPLmxlbmd0aClyZXR1cm4ge3ZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWV9OwogIHBvaW50ID0gJGF0KE8sIGluZGV4KTsKICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDsKICByZXR1cm4ge3ZhbHVlOiBwb2ludCwgZG9uZTogZmFsc2V9Owp9KTsKCi8qKiovIH0pLAovKiA1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDY5KTsKdmFyIGdsb2JhbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBoaWRlICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgSXRlcmF0b3JzICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCBUT19TVFJJTkdfVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKTsKCmZvcih2YXIgY29sbGVjdGlvbnMgPSBbJ05vZGVMaXN0JywgJ0RPTVRva2VuTGlzdCcsICdNZWRpYUxpc3QnLCAnU3R5bGVTaGVldExpc3QnLCAnQ1NTUnVsZUxpc3QnXSwgaSA9IDA7IGkgPCA1OyBpKyspewogIHZhciBOQU1FICAgICAgID0gY29sbGVjdGlvbnNbaV0KICAgICwgQ29sbGVjdGlvbiA9IGdsb2JhbFtOQU1FXQogICAgLCBwcm90byAgICAgID0gQ29sbGVjdGlvbiAmJiBDb2xsZWN0aW9uLnByb3RvdHlwZTsKICBpZihwcm90byAmJiAhcHJvdG9bVE9fU1RSSU5HX1RBR10paGlkZShwcm90bywgVE9fU1RSSU5HX1RBRywgTkFNRSk7CiAgSXRlcmF0b3JzW05BTUVdID0gSXRlcmF0b3JzLkFycmF5Owp9CgovKioqLyB9KSwKLyogNTIgKi8sCi8qIDUzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjb3JlICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsICRKU09OID0gY29yZS5KU09OIHx8IChjb3JlLkpTT04gPSB7c3RyaW5naWZ5OiBKU09OLnN0cmluZ2lmeX0pOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKICByZXR1cm4gJEpTT04uc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmd1bWVudHMpOwp9OwoKLyoqKi8gfSksCi8qIDU0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgoKLyoqKi8gfSksCi8qIDU1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGdldHRpbmcgdGFnIGZyb20gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KQogICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKQogIC8vIEVTMyB3cm9uZyBoZXJlCiAgLCBBUkcgPSBjb2YoZnVuY3Rpb24oKXsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJzsKCi8vIGZhbGxiYWNrIGZvciBJRTExIFNjcmlwdCBBY2Nlc3MgRGVuaWVkIGVycm9yCnZhciB0cnlHZXQgPSBmdW5jdGlvbihpdCwga2V5KXsKICB0cnkgewogICAgcmV0dXJuIGl0W2tleV07CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgdmFyIE8sIFQsIEI7CiAgcmV0dXJuIGl0ID09PSB1bmRlZmluZWQgPyAnVW5kZWZpbmVkJyA6IGl0ID09PSBudWxsID8gJ051bGwnCiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2UKICAgIDogdHlwZW9mIChUID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUQUcpKSA9PSAnc3RyaW5nJyA/IFQKICAgIC8vIGJ1aWx0aW5UYWcgY2FzZQogICAgOiBBUkcgPyBjb2YoTykKICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2sKICAgIDogKEIgPSBjb2YoTykpID09ICdPYmplY3QnICYmIHR5cGVvZiBPLmNhbGxlZSA9PSAnZnVuY3Rpb24nID8gJ0FyZ3VtZW50cycgOiBCOwp9OwoKLyoqKi8gfSksCi8qIDU2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gY29mKGl0KSA9PSAnU3RyaW5nJyA/IGl0LnNwbGl0KCcnKSA6IE9iamVjdChpdCk7Cn07CgovKioqLyB9KSwKLyogNTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHBJRSAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkKICAsIGdPUEQgICAgICAgICAgID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKCmV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBnT1BEIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApewogIE8gPSB0b0lPYmplY3QoTyk7CiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwogIGlmKElFOF9ET01fREVGSU5FKXRyeSB7CiAgICByZXR1cm4gZ09QRChPLCBQKTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9CiAgaWYoaGFzKE8sIFApKXJldHVybiBjcmVhdGVEZXNjKCFwSUUuZi5jYWxsKE8sIFApLCBPW1BdKTsKfTsKCi8qKiovIH0pLAovKiA1OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKLyoqKi8gfSksCi8qIDU5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9pdGVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oNzcpOwoKdmFyIF9pdGVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pdGVyYXRvcik7Cgp2YXIgX3N5bWJvbCA9IF9fd2VicGFja19yZXF1aXJlX18oNzYpOwoKdmFyIF9zeW1ib2wyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3ltYm9sKTsKCnZhciBfdHlwZW9mID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIF9pdGVyYXRvcjIuZGVmYXVsdCA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIF90eXBlb2YoX2l0ZXJhdG9yMi5kZWZhdWx0KSA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG9iaik7Cn0gOiBmdW5jdGlvbiAob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IF9zeW1ib2wyLmRlZmF1bHQgJiYgb2JqICE9PSBfc3ltYm9sMi5kZWZhdWx0LnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iaiA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yob2JqKTsKfTsKCi8qKiovIH0pLAovKiA2MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH07CgovKioqLyB9KSwKLyogNjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsc2UgLT4gQXJyYXkjaW5kZXhPZgovLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlcwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvTGVuZ3RoICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCB0b0luZGV4ICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY4KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihJU19JTkNMVURFUyl7CiAgcmV0dXJuIGZ1bmN0aW9uKCR0aGlzLCBlbCwgZnJvbUluZGV4KXsKICAgIHZhciBPICAgICAgPSB0b0lPYmplY3QoJHRoaXMpCiAgICAgICwgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpCiAgICAgICwgaW5kZXggID0gdG9JbmRleChmcm9tSW5kZXgsIGxlbmd0aCkKICAgICAgLCB2YWx1ZTsKICAgIC8vIEFycmF5I2luY2x1ZGVzIHVzZXMgU2FtZVZhbHVlWmVybyBlcXVhbGl0eSBhbGdvcml0aG0KICAgIGlmKElTX0lOQ0xVREVTICYmIGVsICE9IGVsKXdoaWxlKGxlbmd0aCA+IGluZGV4KXsKICAgICAgdmFsdWUgPSBPW2luZGV4KytdOwogICAgICBpZih2YWx1ZSAhPSB2YWx1ZSlyZXR1cm4gdHJ1ZTsKICAgIC8vIEFycmF5I3RvSW5kZXggaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3QKICAgIH0gZWxzZSBmb3IoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKWlmKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pewogICAgICBpZihPW2luZGV4XSA9PT0gZWwpcmV0dXJuIElTX0lOQ0xVREVTIHx8IGluZGV4IHx8IDA7CiAgICB9IHJldHVybiAhSVNfSU5DTFVERVMgJiYgLTE7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgY3JlYXRlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KQogICwgZGVzY3JpcHRvciAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTsKCi8vIDI1LjEuMi4xLjEgJUl0ZXJhdG9yUHJvdG90eXBlJVtAQGl0ZXJhdG9yXSgpCl9fd2VicGFja19yZXF1aXJlX18oNikoSXRlcmF0b3JQcm90b3R5cGUsIF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJyksIGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9KTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpewogIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwge25leHQ6IGRlc2NyaXB0b3IoMSwgbmV4dCl9KTsKICBzZXRUb1N0cmluZ1RhZyhDb25zdHJ1Y3RvciwgTkFNRSArICcgSXRlcmF0b3InKTsKfTsKCi8qKiovIH0pLAovKiA2MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGRvbmUsIHZhbHVlKXsKICByZXR1cm4ge3ZhbHVlOiB2YWx1ZSwgZG9uZTogISFkb25lfTsKfTsKCi8qKiovIH0pLAovKiA2NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZFAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIGdldEtleXMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7Cgptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcyl7CiAgYW5PYmplY3QoTyk7CiAgdmFyIGtleXMgICA9IGdldEtleXMoUHJvcGVydGllcykKICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgKICAgICwgaSA9IDAKICAgICwgUDsKICB3aGlsZShsZW5ndGggPiBpKWRQLmYoTywgUCA9IGtleXNbaSsrXSwgUHJvcGVydGllc1tQXSk7CiAgcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjcgLyAxNS4yLjMuNCBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKQp2YXIgJGtleXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCiAgLCBoaWRkZW5LZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7CgpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKE8pewogIHJldHVybiAka2V5cyhPLCBoaWRkZW5LZXlzKTsKfTsKCi8qKiovIH0pLAovKiA2NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykKICAsIGRlZmluZWQgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwovLyB0cnVlICAtPiBTdHJpbmcjYXQKLy8gZmFsc2UgLT4gU3RyaW5nI2NvZGVQb2ludEF0Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oVE9fU1RSSU5HKXsKICByZXR1cm4gZnVuY3Rpb24odGhhdCwgcG9zKXsKICAgIHZhciBzID0gU3RyaW5nKGRlZmluZWQodGhhdCkpCiAgICAgICwgaSA9IHRvSW50ZWdlcihwb3MpCiAgICAgICwgbCA9IHMubGVuZ3RoCiAgICAgICwgYSwgYjsKICAgIGlmKGkgPCAwIHx8IGkgPj0gbClyZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7CiAgICBhID0gcy5jaGFyQ29kZUF0KGkpOwogICAgcmV0dXJuIGEgPCAweGQ4MDAgfHwgYSA+IDB4ZGJmZiB8fCBpICsgMSA9PT0gbCB8fCAoYiA9IHMuY2hhckNvZGVBdChpICsgMSkpIDwgMHhkYzAwIHx8IGIgPiAweGRmZmYKICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGEKICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA2NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGludm9rZSAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODgpCiAgLCBodG1sICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKQogICwgY2VsICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSkKICAsIGdsb2JhbCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBzZXRUYXNrICAgICAgICAgICAgPSBnbG9iYWwuc2V0SW1tZWRpYXRlCiAgLCBjbGVhclRhc2sgICAgICAgICAgPSBnbG9iYWwuY2xlYXJJbW1lZGlhdGUKICAsIE1lc3NhZ2VDaGFubmVsICAgICA9IGdsb2JhbC5NZXNzYWdlQ2hhbm5lbAogICwgY291bnRlciAgICAgICAgICAgID0gMAogICwgcXVldWUgICAgICAgICAgICAgID0ge30KICAsIE9OUkVBRFlTVEFURUNIQU5HRSA9ICdvbnJlYWR5c3RhdGVjaGFuZ2UnCiAgLCBkZWZlciwgY2hhbm5lbCwgcG9ydDsKdmFyIHJ1biA9IGZ1bmN0aW9uKCl7CiAgdmFyIGlkID0gK3RoaXM7CiAgaWYocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKXsKICAgIHZhciBmbiA9IHF1ZXVlW2lkXTsKICAgIGRlbGV0ZSBxdWV1ZVtpZF07CiAgICBmbigpOwogIH0KfTsKdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpewogIHJ1bi5jYWxsKGV2ZW50LmRhdGEpOwp9OwovLyBOb2RlLmpzIDAuOSsgJiBJRTEwKyBoYXMgc2V0SW1tZWRpYXRlLCBvdGhlcndpc2U6CmlmKCFzZXRUYXNrIHx8ICFjbGVhclRhc2spewogIHNldFRhc2sgPSBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoZm4pewogICAgdmFyIGFyZ3MgPSBbXSwgaSA9IDE7CiAgICB3aGlsZShhcmd1bWVudHMubGVuZ3RoID4gaSlhcmdzLnB1c2goYXJndW1lbnRzW2krK10pOwogICAgcXVldWVbKytjb3VudGVyXSA9IGZ1bmN0aW9uKCl7CiAgICAgIGludm9rZSh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pLCBhcmdzKTsKICAgIH07CiAgICBkZWZlcihjb3VudGVyKTsKICAgIHJldHVybiBjb3VudGVyOwogIH07CiAgY2xlYXJUYXNrID0gZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaWQpewogICAgZGVsZXRlIHF1ZXVlW2lkXTsKICB9OwogIC8vIE5vZGUuanMgMC44LQogIGlmKF9fd2VicGFja19yZXF1aXJlX18oMTgpKHByb2Nlc3MpID09ICdwcm9jZXNzJyl7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgcHJvY2Vzcy5uZXh0VGljayhjdHgocnVuLCBpZCwgMSkpOwogICAgfTsKICAvLyBCcm93c2VycyB3aXRoIE1lc3NhZ2VDaGFubmVsLCBpbmNsdWRlcyBXZWJXb3JrZXJzCiAgfSBlbHNlIGlmKE1lc3NhZ2VDaGFubmVsKXsKICAgIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWw7CiAgICBwb3J0ICAgID0gY2hhbm5lbC5wb3J0MjsKICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gbGlzdGVuZXI7CiAgICBkZWZlciA9IGN0eChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTsKICAvLyBCcm93c2VycyB3aXRoIHBvc3RNZXNzYWdlLCBza2lwIFdlYldvcmtlcnMKICAvLyBJRTggaGFzIHBvc3RNZXNzYWdlLCBidXQgaXQncyBzeW5jICYgdHlwZW9mIGl0cyBwb3N0TWVzc2FnZSBpcyAnb2JqZWN0JwogIH0gZWxzZSBpZihnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lciAmJiB0eXBlb2YgcG9zdE1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJyAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShpZCArICcnLCAnKicpOwogICAgfTsKICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbGlzdGVuZXIsIGZhbHNlKTsKICAvLyBJRTgtCiAgfSBlbHNlIGlmKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKXsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBodG1sLmFwcGVuZENoaWxkKGNlbCgnc2NyaXB0JykpW09OUkVBRFlTVEFURUNIQU5HRV0gPSBmdW5jdGlvbigpewogICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7CiAgICAgICAgcnVuLmNhbGwoaWQpOwogICAgICB9OwogICAgfTsKICAvLyBSZXN0IG9sZCBicm93c2VycwogIH0gZWxzZSB7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgc2V0VGltZW91dChjdHgocnVuLCBpZCwgMSksIDApOwogICAgfTsKICB9Cn0KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2V0OiAgIHNldFRhc2ssCiAgY2xlYXI6IGNsZWFyVGFzawp9OwoKLyoqKi8gfSksCi8qIDY4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KQogICwgbWF4ICAgICAgID0gTWF0aC5tYXgKICAsIG1pbiAgICAgICA9IE1hdGgubWluOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGluZGV4LCBsZW5ndGgpewogIGluZGV4ID0gdG9JbnRlZ2VyKGluZGV4KTsKICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbihpbmRleCwgbGVuZ3RoKTsKfTsKCi8qKiovIH0pLAovKiA2OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgYWRkVG9VbnNjb3BhYmxlcyA9IF9fd2VicGFja19yZXF1aXJlX18oNjApCiAgLCBzdGVwICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MykKICAsIEl0ZXJhdG9ycyAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQogICwgdG9JT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwoKLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKQovLyAyMi4xLjMuMTMgQXJyYXkucHJvdG90eXBlLmtleXMoKQovLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpCi8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMzgpKEFycmF5LCAnQXJyYXknLCBmdW5jdGlvbihpdGVyYXRlZCwga2luZCl7CiAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldAogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4CiAgdGhpcy5fayA9IGtpbmQ7ICAgICAgICAgICAgICAgIC8vIGtpbmQKLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpCn0sIGZ1bmN0aW9uKCl7CiAgdmFyIE8gICAgID0gdGhpcy5fdAogICAgLCBraW5kICA9IHRoaXMuX2sKICAgICwgaW5kZXggPSB0aGlzLl9pKys7CiAgaWYoIU8gfHwgaW5kZXggPj0gTy5sZW5ndGgpewogICAgdGhpcy5fdCA9IHVuZGVmaW5lZDsKICAgIHJldHVybiBzdGVwKDEpOwogIH0KICBpZihraW5kID09ICdrZXlzJyAgKXJldHVybiBzdGVwKDAsIGluZGV4KTsKICBpZihraW5kID09ICd2YWx1ZXMnKXJldHVybiBzdGVwKDAsIE9baW5kZXhdKTsKICByZXR1cm4gc3RlcCgwLCBbaW5kZXgsIE9baW5kZXhdXSk7Cn0sICd2YWx1ZXMnKTsKCi8vIGFyZ3VtZW50c0xpc3RbQEBpdGVyYXRvcl0gaXMgJUFycmF5UHJvdG9fdmFsdWVzJSAoOS40LjQuNiwgOS40LjQuNykKSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTsKCmFkZFRvVW5zY29wYWJsZXMoJ2tleXMnKTsKYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7CmFkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTsKCi8qKiovIH0pLAovKiA3MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDcxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODIpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIE1FVEEgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykoJ21ldGEnKQogICwgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBoYXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCiAgLCBzZXREZXNjICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgogICwgaWQgICAgICAgPSAwOwp2YXIgaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZSB8fCBmdW5jdGlvbigpewogIHJldHVybiB0cnVlOwp9Owp2YXIgRlJFRVpFID0gIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGlzRXh0ZW5zaWJsZShPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe30pKTsKfSk7CnZhciBzZXRNZXRhID0gZnVuY3Rpb24oaXQpewogIHNldERlc2MoaXQsIE1FVEEsIHt2YWx1ZTogewogICAgaTogJ08nICsgKytpZCwgLy8gb2JqZWN0IElECiAgICB3OiB7fSAgICAgICAgICAvLyB3ZWFrIGNvbGxlY3Rpb25zIElEcwogIH19KTsKfTsKdmFyIGZhc3RLZXkgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICAvLyByZXR1cm4gcHJpbWl0aXZlIHdpdGggcHJlZml4CiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnID8gaXQgOiAodHlwZW9mIGl0ID09ICdzdHJpbmcnID8gJ1MnIDogJ1AnKSArIGl0OwogIGlmKCFoYXMoaXQsIE1FVEEpKXsKICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0CiAgICBpZighaXNFeHRlbnNpYmxlKGl0KSlyZXR1cm4gJ0YnOwogICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGEKICAgIGlmKCFjcmVhdGUpcmV0dXJuICdFJzsKICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhCiAgICBzZXRNZXRhKGl0KTsKICAvLyByZXR1cm4gb2JqZWN0IElECiAgfSByZXR1cm4gaXRbTUVUQV0uaTsKfTsKdmFyIGdldFdlYWsgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKICBpZighaGFzKGl0LCBNRVRBKSl7CiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdAogICAgaWYoIWlzRXh0ZW5zaWJsZShpdCkpcmV0dXJuIHRydWU7CiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YQogICAgaWYoIWNyZWF0ZSlyZXR1cm4gZmFsc2U7CiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YQogICAgc2V0TWV0YShpdCk7CiAgLy8gcmV0dXJuIGhhc2ggd2VhayBjb2xsZWN0aW9ucyBJRHMKICB9IHJldHVybiBpdFtNRVRBXS53Owp9OwovLyBhZGQgbWV0YWRhdGEgb24gZnJlZXplLWZhbWlseSBtZXRob2RzIGNhbGxpbmcKdmFyIG9uRnJlZXplID0gZnVuY3Rpb24oaXQpewogIGlmKEZSRUVaRSAmJiBtZXRhLk5FRUQgJiYgaXNFeHRlbnNpYmxlKGl0KSAmJiAhaGFzKGl0LCBNRVRBKSlzZXRNZXRhKGl0KTsKICByZXR1cm4gaXQ7Cn07CnZhciBtZXRhID0gbW9kdWxlLmV4cG9ydHMgPSB7CiAgS0VZOiAgICAgIE1FVEEsCiAgTkVFRDogICAgIGZhbHNlLAogIGZhc3RLZXk6ICBmYXN0S2V5LAogIGdldFdlYWs6ICBnZXRXZWFrLAogIG9uRnJlZXplOiBvbkZyZWV6ZQp9OwoKLyoqKi8gfSksCi8qIDczICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjbGFzc29mICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KQogICwgSVRFUkFUT1IgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgSXRlcmF0b3JzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uKGl0KXsKICBpZihpdCAhPSB1bmRlZmluZWQpcmV0dXJuIGl0W0lURVJBVE9SXQogICAgfHwgaXRbJ0BAaXRlcmF0b3InXQogICAgfHwgSXRlcmF0b3JzW2NsYXNzb2YoaXQpXTsKfTsKCi8qKiovIH0pLAovKiA3NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDc4KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODEpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDg0KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAwKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGUoUCwgRCl7CiAgcmV0dXJuICRPYmplY3QuY3JlYXRlKFAsIEQpOwp9OwoKLyoqKi8gfSksCi8qIDc5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAxKTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5nZXRQcm90b3R5cGVPZjsKCi8qKiovIH0pLAovKiA4MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMik7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Qua2V5czsKCi8qKiovIH0pLAovKiA4MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMyk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Quc2V0UHJvdG90eXBlT2Y7CgovKioqLyB9KSwKLyogODIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg1NCk7Cl9fd2VicGFja19yZXF1aXJlX18oNTApOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKX193ZWJwYWNrX3JlcXVpcmVfXygxMDQpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuUHJvbWlzZTsKCi8qKiovIH0pLAovKiA4MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNSk7Cl9fd2VicGFja19yZXF1aXJlX18oNTQpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNik7Cl9fd2VicGFja19yZXF1aXJlX18oMTA3KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLlN5bWJvbDsKCi8qKiovIH0pLAovKiA4NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkuZignaXRlcmF0b3InKTsKCi8qKiovIH0pLAovKiA4NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSwgZm9yYmlkZGVuRmllbGQpewogIGlmKCEoaXQgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikgfHwgKGZvcmJpZGRlbkZpZWxkICE9PSB1bmRlZmluZWQgJiYgZm9yYmlkZGVuRmllbGQgaW4gaXQpKXsKICAgIHRocm93IFR5cGVFcnJvcihuYW1lICsgJzogaW5jb3JyZWN0IGludm9jYXRpb24hJyk7CiAgfSByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogODYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gYWxsIGVudW1lcmFibGUgb2JqZWN0IGtleXMsIGluY2x1ZGVzIHN5bWJvbHMKdmFyIGdldEtleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QUyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHZhciByZXN1bHQgICAgID0gZ2V0S2V5cyhpdCkKICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZjsKICBpZihnZXRTeW1ib2xzKXsKICAgIHZhciBzeW1ib2xzID0gZ2V0U3ltYm9scyhpdCkKICAgICAgLCBpc0VudW0gID0gcElFLmYKICAgICAgLCBpICAgICAgID0gMAogICAgICAsIGtleTsKICAgIHdoaWxlKHN5bWJvbHMubGVuZ3RoID4gaSlpZihpc0VudW0uY2FsbChpdCwga2V5ID0gc3ltYm9sc1tpKytdKSlyZXN1bHQucHVzaChrZXkpOwogIH0gcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiA4NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgY3R4ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgY2FsbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkxKQogICwgaXNBcnJheUl0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg5KQogICwgYW5PYmplY3QgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCB0b0xlbmd0aCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCiAgLCBnZXRJdGVyRm4gICA9IF9fd2VicGFja19yZXF1aXJlX18oNzMpCiAgLCBCUkVBSyAgICAgICA9IHt9CiAgLCBSRVRVUk4gICAgICA9IHt9Owp2YXIgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXRlcmFibGUsIGVudHJpZXMsIGZuLCB0aGF0LCBJVEVSQVRPUil7CiAgdmFyIGl0ZXJGbiA9IElURVJBVE9SID8gZnVuY3Rpb24oKXsgcmV0dXJuIGl0ZXJhYmxlOyB9IDogZ2V0SXRlckZuKGl0ZXJhYmxlKQogICAgLCBmICAgICAgPSBjdHgoZm4sIHRoYXQsIGVudHJpZXMgPyAyIDogMSkKICAgICwgaW5kZXggID0gMAogICAgLCBsZW5ndGgsIHN0ZXAsIGl0ZXJhdG9yLCByZXN1bHQ7CiAgaWYodHlwZW9mIGl0ZXJGbiAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdGVyYWJsZSArICcgaXMgbm90IGl0ZXJhYmxlIScpOwogIC8vIGZhc3QgY2FzZSBmb3IgYXJyYXlzIHdpdGggZGVmYXVsdCBpdGVyYXRvcgogIGlmKGlzQXJyYXlJdGVyKGl0ZXJGbikpZm9yKGxlbmd0aCA9IHRvTGVuZ3RoKGl0ZXJhYmxlLmxlbmd0aCk7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKXsKICAgIHJlc3VsdCA9IGVudHJpZXMgPyBmKGFuT2JqZWN0KHN0ZXAgPSBpdGVyYWJsZVtpbmRleF0pWzBdLCBzdGVwWzFdKSA6IGYoaXRlcmFibGVbaW5kZXhdKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9IGVsc2UgZm9yKGl0ZXJhdG9yID0gaXRlckZuLmNhbGwoaXRlcmFibGUpOyAhKHN0ZXAgPSBpdGVyYXRvci5uZXh0KCkpLmRvbmU7ICl7CiAgICByZXN1bHQgPSBjYWxsKGl0ZXJhdG9yLCBmLCBzdGVwLnZhbHVlLCBlbnRyaWVzKTsKICAgIGlmKHJlc3VsdCA9PT0gQlJFQUsgfHwgcmVzdWx0ID09PSBSRVRVUk4pcmV0dXJuIHJlc3VsdDsKICB9Cn07CmV4cG9ydHMuQlJFQUsgID0gQlJFQUs7CmV4cG9ydHMuUkVUVVJOID0gUkVUVVJOOwoKLyoqKi8gfSksCi8qIDg4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIGZhc3QgYXBwbHksIGh0dHA6Ly9qc3BlcmYubG5raXQuY29tL2Zhc3QtYXBwbHkvNQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCBhcmdzLCB0aGF0KXsKICB2YXIgdW4gPSB0aGF0ID09PSB1bmRlZmluZWQ7CiAgc3dpdGNoKGFyZ3MubGVuZ3RoKXsKICAgIGNhc2UgMDogcmV0dXJuIHVuID8gZm4oKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQpOwogICAgY2FzZSAxOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0pOwogICAgY2FzZSAyOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0pOwogICAgY2FzZSAzOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pOwogICAgY2FzZSA0OiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pOwogIH0gcmV0dXJuICAgICAgICAgICAgICBmbi5hcHBseSh0aGF0LCBhcmdzKTsKfTsKCi8qKiovIH0pLAovKiA4OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBjaGVjayBvbiBkZWZhdWx0IEFycmF5IGl0ZXJhdG9yCnZhciBJdGVyYXRvcnMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsIElURVJBVE9SICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpCiAgLCBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b1tJVEVSQVRPUl0gPT09IGl0KTsKfTsKCi8qKiovIH0pLAovKiA5MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjIuMiBJc0FycmF5KGFyZ3VtZW50KQp2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7Cm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5KGFyZyl7CiAgcmV0dXJuIGNvZihhcmcpID09ICdBcnJheSc7Cn07CgovKioqLyB9KSwKLyogOTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gY2FsbCBzb21ldGhpbmcgb24gaXRlcmF0b3Igc3RlcCB3aXRoIHNhZmUgY2xvc2luZyBvbiBlcnJvcgp2YXIgYW5PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhdG9yLCBmbiwgdmFsdWUsIGVudHJpZXMpewogIHRyeSB7CiAgICByZXR1cm4gZW50cmllcyA/IGZuKGFuT2JqZWN0KHZhbHVlKVswXSwgdmFsdWVbMV0pIDogZm4odmFsdWUpOwogIC8vIDcuNC42IEl0ZXJhdG9yQ2xvc2UoaXRlcmF0b3IsIGNvbXBsZXRpb24pCiAgfSBjYXRjaChlKXsKICAgIHZhciByZXQgPSBpdGVyYXRvclsncmV0dXJuJ107CiAgICBpZihyZXQgIT09IHVuZGVmaW5lZClhbk9iamVjdChyZXQuY2FsbChpdGVyYXRvcikpOwogICAgdGhyb3cgZTsKICB9Cn07CgovKioqLyB9KSwKLyogOTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIElURVJBVE9SICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJykKICAsIFNBRkVfQ0xPU0lORyA9IGZhbHNlOwoKdHJ5IHsKICB2YXIgcml0ZXIgPSBbN11bSVRFUkFUT1JdKCk7CiAgcml0ZXJbJ3JldHVybiddID0gZnVuY3Rpb24oKXsgU0FGRV9DTE9TSU5HID0gdHJ1ZTsgfTsKICBBcnJheS5mcm9tKHJpdGVyLCBmdW5jdGlvbigpeyB0aHJvdyAyOyB9KTsKfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjLCBza2lwQ2xvc2luZyl7CiAgaWYoIXNraXBDbG9zaW5nICYmICFTQUZFX0NMT1NJTkcpcmV0dXJuIGZhbHNlOwogIHZhciBzYWZlID0gZmFsc2U7CiAgdHJ5IHsKICAgIHZhciBhcnIgID0gWzddCiAgICAgICwgaXRlciA9IGFycltJVEVSQVRPUl0oKTsKICAgIGl0ZXIubmV4dCA9IGZ1bmN0aW9uKCl7IHJldHVybiB7ZG9uZTogc2FmZSA9IHRydWV9OyB9OwogICAgYXJyW0lURVJBVE9SXSA9IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyOyB9OwogICAgZXhlYyhhcnIpOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICByZXR1cm4gc2FmZTsKfTsKCi8qKiovIH0pLAovKiA5MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2V0S2V5cyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykKICAsIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgZWwpewogIHZhciBPICAgICAgPSB0b0lPYmplY3Qob2JqZWN0KQogICAgLCBrZXlzICAgPSBnZXRLZXlzKE8pCiAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCiAgICAsIGluZGV4ICA9IDAKICAgICwga2V5OwogIHdoaWxlKGxlbmd0aCA+IGluZGV4KWlmKE9ba2V5ID0ga2V5c1tpbmRleCsrXV0gPT09IGVsKXJldHVybiBrZXk7Cn07CgovKioqLyB9KSwKLyogOTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIG1hY3JvdGFzayA9IF9fd2VicGFja19yZXF1aXJlX18oNjcpLnNldAogICwgT2JzZXJ2ZXIgID0gZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIKICAsIHByb2Nlc3MgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBQcm9taXNlICAgPSBnbG9iYWwuUHJvbWlzZQogICwgaXNOb2RlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkocHJvY2VzcykgPT0gJ3Byb2Nlc3MnOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpewogIHZhciBoZWFkLCBsYXN0LCBub3RpZnk7CgogIHZhciBmbHVzaCA9IGZ1bmN0aW9uKCl7CiAgICB2YXIgcGFyZW50LCBmbjsKICAgIGlmKGlzTm9kZSAmJiAocGFyZW50ID0gcHJvY2Vzcy5kb21haW4pKXBhcmVudC5leGl0KCk7CiAgICB3aGlsZShoZWFkKXsKICAgICAgZm4gICA9IGhlYWQuZm47CiAgICAgIGhlYWQgPSBoZWFkLm5leHQ7CiAgICAgIHRyeSB7CiAgICAgICAgZm4oKTsKICAgICAgfSBjYXRjaChlKXsKICAgICAgICBpZihoZWFkKW5vdGlmeSgpOwogICAgICAgIGVsc2UgbGFzdCA9IHVuZGVmaW5lZDsKICAgICAgICB0aHJvdyBlOwogICAgICB9CiAgICB9IGxhc3QgPSB1bmRlZmluZWQ7CiAgICBpZihwYXJlbnQpcGFyZW50LmVudGVyKCk7CiAgfTsKCiAgLy8gTm9kZS5qcwogIGlmKGlzTm9kZSl7CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBwcm9jZXNzLm5leHRUaWNrKGZsdXNoKTsKICAgIH07CiAgLy8gYnJvd3NlcnMgd2l0aCBNdXRhdGlvbk9ic2VydmVyCiAgfSBlbHNlIGlmKE9ic2VydmVyKXsKICAgIHZhciB0b2dnbGUgPSB0cnVlCiAgICAgICwgbm9kZSAgID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpOwogICAgbmV3IE9ic2VydmVyKGZsdXNoKS5vYnNlcnZlKG5vZGUsIHtjaGFyYWN0ZXJEYXRhOiB0cnVlfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBub2RlLmRhdGEgPSB0b2dnbGUgPSAhdG9nZ2xlOwogICAgfTsKICAvLyBlbnZpcm9ubWVudHMgd2l0aCBtYXliZSBub24tY29tcGxldGVseSBjb3JyZWN0LCBidXQgZXhpc3RlbnQgUHJvbWlzZQogIH0gZWxzZSBpZihQcm9taXNlICYmIFByb21pc2UucmVzb2x2ZSl7CiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpOwogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgcHJvbWlzZS50aGVuKGZsdXNoKTsKICAgIH07CiAgLy8gZm9yIG90aGVyIGVudmlyb25tZW50cyAtIG1hY3JvdGFzayBiYXNlZCBvbjoKICAvLyAtIHNldEltbWVkaWF0ZQogIC8vIC0gTWVzc2FnZUNoYW5uZWwKICAvLyAtIHdpbmRvdy5wb3N0TWVzc2FnCiAgLy8gLSBvbnJlYWR5c3RhdGVjaGFuZ2UKICAvLyAtIHNldFRpbWVvdXQKICB9IGVsc2UgewogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKICAgICAgLy8gc3RyYW5nZSBJRSArIHdlYnBhY2sgZGV2IHNlcnZlciBidWcgLSB1c2UgLmNhbGwoZ2xvYmFsKQogICAgICBtYWNyb3Rhc2suY2FsbChnbG9iYWwsIGZsdXNoKTsKICAgIH07CiAgfQoKICByZXR1cm4gZnVuY3Rpb24oZm4pewogICAgdmFyIHRhc2sgPSB7Zm46IGZuLCBuZXh0OiB1bmRlZmluZWR9OwogICAgaWYobGFzdClsYXN0Lm5leHQgPSB0YXNrOwogICAgaWYoIWhlYWQpewogICAgICBoZWFkID0gdGFzazsKICAgICAgbm90aWZ5KCk7CiAgICB9IGxhc3QgPSB0YXNrOwogIH07Cn07CgovKioqLyB9KSwKLyogOTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsbGJhY2sgZm9yIElFMTEgYnVnZ3kgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgd2l0aCBpZnJhbWUgYW5kIHdpbmRvdwp2YXIgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIGdPUE4gICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjUpLmYKICAsIHRvU3RyaW5nICA9IHt9LnRvU3RyaW5nOwoKdmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMKICA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdykgOiBbXTsKCnZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uKGl0KXsKICB0cnkgewogICAgcmV0dXJuIGdPUE4oaXQpOwogIH0gY2F0Y2goZSl7CiAgICByZXR1cm4gd2luZG93TmFtZXMuc2xpY2UoKTsKICB9Cn07Cgptb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCl7CiAgcmV0dXJuIHdpbmRvd05hbWVzICYmIHRvU3RyaW5nLmNhbGwoaXQpID09ICdbb2JqZWN0IFdpbmRvd10nID8gZ2V0V2luZG93TmFtZXMoaXQpIDogZ09QTih0b0lPYmplY3QoaXQpKTsKfTsKCgovKioqLyB9KSwKLyogOTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGhpZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHRhcmdldCwgc3JjLCBzYWZlKXsKICBmb3IodmFyIGtleSBpbiBzcmMpewogICAgaWYoc2FmZSAmJiB0YXJnZXRba2V5XSl0YXJnZXRba2V5XSA9IHNyY1trZXldOwogICAgZWxzZSBoaWRlKHRhcmdldCwga2V5LCBzcmNba2V5XSk7CiAgfSByZXR1cm4gdGFyZ2V0Owp9OwoKLyoqKi8gfSksCi8qIDk3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIFdvcmtzIHdpdGggX19wcm90b19fIG9ubHkuIE9sZCB2OCBjYW4ndCB3b3JrIHdpdGggbnVsbCBwcm90byBvYmplY3RzLgovKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqLwp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CnZhciBjaGVjayA9IGZ1bmN0aW9uKE8sIHByb3RvKXsKICBhbk9iamVjdChPKTsKICBpZighaXNPYmplY3QocHJvdG8pICYmIHByb3RvICE9PSBudWxsKXRocm93IFR5cGVFcnJvcihwcm90byArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7Cn07Cm1vZHVsZS5leHBvcnRzID0gewogIHNldDogT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8ICgnX19wcm90b19fJyBpbiB7fSA/IC8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAgIGZ1bmN0aW9uKHRlc3QsIGJ1Z2d5LCBzZXQpewogICAgICB0cnkgewogICAgICAgIHNldCA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpKEZ1bmN0aW9uLmNhbGwsIF9fd2VicGFja19yZXF1aXJlX18oNTcpLmYoT2JqZWN0LnByb3RvdHlwZSwgJ19fcHJvdG9fXycpLnNldCwgMik7CiAgICAgICAgc2V0KHRlc3QsIFtdKTsKICAgICAgICBidWdneSA9ICEodGVzdCBpbnN0YW5jZW9mIEFycmF5KTsKICAgICAgfSBjYXRjaChlKXsgYnVnZ3kgPSB0cnVlOyB9CiAgICAgIHJldHVybiBmdW5jdGlvbiBzZXRQcm90b3R5cGVPZihPLCBwcm90byl7CiAgICAgICAgY2hlY2soTywgcHJvdG8pOwogICAgICAgIGlmKGJ1Z2d5KU8uX19wcm90b19fID0gcHJvdG87CiAgICAgICAgZWxzZSBzZXQoTywgcHJvdG8pOwogICAgICAgIHJldHVybiBPOwogICAgICB9OwogICAgfSh7fSwgZmFsc2UpIDogdW5kZWZpbmVkKSwKICBjaGVjazogY2hlY2sKfTsKCi8qKiovIH0pLAovKiA5OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZ2xvYmFsICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjb3JlICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGRQICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgREVTQ1JJUFRPUlMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpCiAgLCBTUEVDSUVTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZKXsKICB2YXIgQyA9IHR5cGVvZiBjb3JlW0tFWV0gPT0gJ2Z1bmN0aW9uJyA/IGNvcmVbS0VZXSA6IGdsb2JhbFtLRVldOwogIGlmKERFU0NSSVBUT1JTICYmIEMgJiYgIUNbU1BFQ0lFU10pZFAuZihDLCBTUEVDSUVTLCB7CiAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9CiAgfSk7Cn07CgovKioqLyB9KSwKLyogOTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpCnZhciBhbk9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCiAgLCBhRnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgU1BFQ0lFUyAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnc3BlY2llcycpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE8sIEQpewogIHZhciBDID0gYW5PYmplY3QoTykuY29uc3RydWN0b3IsIFM7CiAgcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBEIDogYUZ1bmN0aW9uKFMpOwp9OwoKLyoqKi8gfSksCi8qIDEwMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0Jywge2NyZWF0ZTogX193ZWJwYWNrX3JlcXVpcmVfXygzNSl9KTsKCi8qKiovIH0pLAovKiAxMDEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjkgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pCnZhciB0b09iamVjdCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Myk7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KSgnZ2V0UHJvdG90eXBlT2YnLCBmdW5jdGlvbigpewogIHJldHVybiBmdW5jdGlvbiBnZXRQcm90b3R5cGVPZihpdCl7CiAgICByZXR1cm4gJGdldFByb3RvdHlwZU9mKHRvT2JqZWN0KGl0KSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi4xNCBPYmplY3Qua2V5cyhPKQp2YXIgdG9PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQogICwgJGtleXMgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCl9fd2VicGFja19yZXF1aXJlX18oNDUpKCdrZXlzJywgZnVuY3Rpb24oKXsKICByZXR1cm4gZnVuY3Rpb24ga2V5cyhpdCl7CiAgICByZXR1cm4gJGtleXModG9PYmplY3QoaXQpKTsKICB9Owp9KTsKCi8qKiovIH0pLAovKiAxMDMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjE5IE9iamVjdC5zZXRQcm90b3R5cGVPZihPLCBwcm90bykKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwokZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtzZXRQcm90b3R5cGVPZjogX193ZWJwYWNrX3JlcXVpcmVfXyg5Nykuc2V0fSk7CgovKioqLyB9KSwKLyogMTA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBMSUJSQVJZICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgZ2xvYmFsICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGNsYXNzb2YgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTUpCiAgLCAkZXhwb3J0ICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCBpc09iamVjdCAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCiAgLCBhRnVuY3Rpb24gICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKQogICwgYW5JbnN0YW5jZSAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NSkKICAsIGZvck9mICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODcpCiAgLCBzcGVjaWVzQ29uc3RydWN0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KQogICwgdGFzayAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Nykuc2V0CiAgLCBtaWNyb3Rhc2sgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk0KSgpCiAgLCBQUk9NSVNFICAgICAgICAgICAgPSAnUHJvbWlzZScKICAsIFR5cGVFcnJvciAgICAgICAgICA9IGdsb2JhbC5UeXBlRXJyb3IKICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCAkUHJvbWlzZSAgICAgICAgICAgPSBnbG9iYWxbUFJPTUlTRV0KICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzCiAgLCBpc05vZGUgICAgICAgICAgICAgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJwogICwgZW1wdHkgICAgICAgICAgICAgID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfQogICwgSW50ZXJuYWwsIEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSwgV3JhcHBlcjsKCnZhciBVU0VfTkFUSVZFID0gISFmdW5jdGlvbigpewogIHRyeSB7CiAgICAvLyBjb3JyZWN0IHN1YmNsYXNzaW5nIHdpdGggQEBzcGVjaWVzIHN1cHBvcnQKICAgIHZhciBwcm9taXNlICAgICA9ICRQcm9taXNlLnJlc29sdmUoMSkKICAgICAgLCBGYWtlUHJvbWlzZSA9IChwcm9taXNlLmNvbnN0cnVjdG9yID0ge30pW19fd2VicGFja19yZXF1aXJlX18oMikoJ3NwZWNpZXMnKV0gPSBmdW5jdGlvbihleGVjKXsgZXhlYyhlbXB0eSwgZW1wdHkpOyB9OwogICAgLy8gdW5oYW5kbGVkIHJlamVjdGlvbnMgdHJhY2tpbmcgc3VwcG9ydCwgTm9kZUpTIFByb21pc2Ugd2l0aG91dCBpdCBmYWlscyBAQHNwZWNpZXMgdGVzdAogICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKSAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2U7CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQp9KCk7CgovLyBoZWxwZXJzCnZhciBzYW1lQ29uc3RydWN0b3IgPSBmdW5jdGlvbihhLCBiKXsKICAvLyB3aXRoIGxpYnJhcnkgd3JhcHBlciBzcGVjaWFsIGNhc2UKICByZXR1cm4gYSA9PT0gYiB8fCBhID09PSAkUHJvbWlzZSAmJiBiID09PSBXcmFwcGVyOwp9Owp2YXIgaXNUaGVuYWJsZSA9IGZ1bmN0aW9uKGl0KXsKICB2YXIgdGhlbjsKICByZXR1cm4gaXNPYmplY3QoaXQpICYmIHR5cGVvZiAodGhlbiA9IGl0LnRoZW4pID09ICdmdW5jdGlvbicgPyB0aGVuIDogZmFsc2U7Cn07CnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewogIHJldHVybiBzYW1lQ29uc3RydWN0b3IoJFByb21pc2UsIEMpCiAgICA/IG5ldyBQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgOiBuZXcgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5KEMpOwp9Owp2YXIgUHJvbWlzZUNhcGFiaWxpdHkgPSBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbihDKXsKICB2YXIgcmVzb2x2ZSwgcmVqZWN0OwogIHRoaXMucHJvbWlzZSA9IG5ldyBDKGZ1bmN0aW9uKCQkcmVzb2x2ZSwgJCRyZWplY3QpewogICAgaWYocmVzb2x2ZSAhPT0gdW5kZWZpbmVkIHx8IHJlamVjdCAhPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcignQmFkIFByb21pc2UgY29uc3RydWN0b3InKTsKICAgIHJlc29sdmUgPSAkJHJlc29sdmU7CiAgICByZWplY3QgID0gJCRyZWplY3Q7CiAgfSk7CiAgdGhpcy5yZXNvbHZlID0gYUZ1bmN0aW9uKHJlc29sdmUpOwogIHRoaXMucmVqZWN0ICA9IGFGdW5jdGlvbihyZWplY3QpOwp9Owp2YXIgcGVyZm9ybSA9IGZ1bmN0aW9uKGV4ZWMpewogIHRyeSB7CiAgICBleGVjKCk7CiAgfSBjYXRjaChlKXsKICAgIHJldHVybiB7ZXJyb3I6IGV9OwogIH0KfTsKdmFyIG5vdGlmeSA9IGZ1bmN0aW9uKHByb21pc2UsIGlzUmVqZWN0KXsKICBpZihwcm9taXNlLl9uKXJldHVybjsKICBwcm9taXNlLl9uID0gdHJ1ZTsKICB2YXIgY2hhaW4gPSBwcm9taXNlLl9jOwogIG1pY3JvdGFzayhmdW5jdGlvbigpewogICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgogICAgICAsIG9rICAgID0gcHJvbWlzZS5fcyA9PSAxCiAgICAgICwgaSAgICAgPSAwOwogICAgdmFyIHJ1biA9IGZ1bmN0aW9uKHJlYWN0aW9uKXsKICAgICAgdmFyIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbAogICAgICAgICwgcmVzb2x2ZSA9IHJlYWN0aW9uLnJlc29sdmUKICAgICAgICAsIHJlamVjdCAgPSByZWFjdGlvbi5yZWplY3QKICAgICAgICAsIGRvbWFpbiAgPSByZWFjdGlvbi5kb21haW4KICAgICAgICAsIHJlc3VsdCwgdGhlbjsKICAgICAgdHJ5IHsKICAgICAgICBpZihoYW5kbGVyKXsKICAgICAgICAgIGlmKCFvayl7CiAgICAgICAgICAgIGlmKHByb21pc2UuX2ggPT0gMilvbkhhbmRsZVVuaGFuZGxlZChwcm9taXNlKTsKICAgICAgICAgICAgcHJvbWlzZS5faCA9IDE7CiAgICAgICAgICB9CiAgICAgICAgICBpZihoYW5kbGVyID09PSB0cnVlKXJlc3VsdCA9IHZhbHVlOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZW50ZXIoKTsKICAgICAgICAgICAgcmVzdWx0ID0gaGFuZGxlcih2YWx1ZSk7CiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZXhpdCgpOwogICAgICAgICAgfQogICAgICAgICAgaWYocmVzdWx0ID09PSByZWFjdGlvbi5wcm9taXNlKXsKICAgICAgICAgICAgcmVqZWN0KFR5cGVFcnJvcignUHJvbWlzZS1jaGFpbiBjeWNsZScpKTsKICAgICAgICAgIH0gZWxzZSBpZih0aGVuID0gaXNUaGVuYWJsZShyZXN1bHQpKXsKICAgICAgICAgICAgdGhlbi5jYWxsKHJlc3VsdCwgcmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgICAgIH0gZWxzZSByZXNvbHZlKHJlc3VsdCk7CiAgICAgICAgfSBlbHNlIHJlamVjdCh2YWx1ZSk7CiAgICAgIH0gY2F0Y2goZSl7CiAgICAgICAgcmVqZWN0KGUpOwogICAgICB9CiAgICB9OwogICAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSlydW4oY2hhaW5baSsrXSk7IC8vIHZhcmlhYmxlIGxlbmd0aCAtIGNhbid0IHVzZSBmb3JFYWNoCiAgICBwcm9taXNlLl9jID0gW107CiAgICBwcm9taXNlLl9uID0gZmFsc2U7CiAgICBpZihpc1JlamVjdCAmJiAhcHJvbWlzZS5faClvblVuaGFuZGxlZChwcm9taXNlKTsKICB9KTsKfTsKdmFyIG9uVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YKICAgICAgLCBhYnJ1cHQsIGhhbmRsZXIsIGNvbnNvbGU7CiAgICBpZihpc1VuaGFuZGxlZChwcm9taXNlKSl7CiAgICAgIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgICBpZihpc05vZGUpewogICAgICAgICAgcHJvY2Vzcy5lbWl0KCd1bmhhbmRsZWRSZWplY3Rpb24nLCB2YWx1ZSwgcHJvbWlzZSk7CiAgICAgICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub251bmhhbmRsZWRyZWplY3Rpb24pewogICAgICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiB2YWx1ZX0pOwogICAgICAgIH0gZWxzZSBpZigoY29uc29sZSA9IGdsb2JhbC5jb25zb2xlKSAmJiBjb25zb2xlLmVycm9yKXsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbicsIHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBCcm93c2VycyBzaG91bGQgbm90IHRyaWdnZXIgYHJlamVjdGlvbkhhbmRsZWRgIGV2ZW50IGlmIGl0IHdhcyBoYW5kbGVkIGhlcmUsIE5vZGVKUyAtIHNob3VsZAogICAgICBwcm9taXNlLl9oID0gaXNOb2RlIHx8IGlzVW5oYW5kbGVkKHByb21pc2UpID8gMiA6IDE7CiAgICB9IHByb21pc2UuX2EgPSB1bmRlZmluZWQ7CiAgICBpZihhYnJ1cHQpdGhyb3cgYWJydXB0LmVycm9yOwogIH0pOwp9Owp2YXIgaXNVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKICBpZihwcm9taXNlLl9oID09IDEpcmV0dXJuIGZhbHNlOwogIHZhciBjaGFpbiA9IHByb21pc2UuX2EgfHwgcHJvbWlzZS5fYwogICAgLCBpICAgICA9IDAKICAgICwgcmVhY3Rpb247CiAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSl7CiAgICByZWFjdGlvbiA9IGNoYWluW2krK107CiAgICBpZihyZWFjdGlvbi5mYWlsIHx8ICFpc1VuaGFuZGxlZChyZWFjdGlvbi5wcm9taXNlKSlyZXR1cm4gZmFsc2U7CiAgfSByZXR1cm4gdHJ1ZTsKfTsKdmFyIG9uSGFuZGxlVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsKICAgIHZhciBoYW5kbGVyOwogICAgaWYoaXNOb2RlKXsKICAgICAgcHJvY2Vzcy5lbWl0KCdyZWplY3Rpb25IYW5kbGVkJywgcHJvbWlzZSk7CiAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnJlamVjdGlvbmhhbmRsZWQpewogICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHByb21pc2UuX3Z9KTsKICAgIH0KICB9KTsKfTsKdmFyICRyZWplY3QgPSBmdW5jdGlvbih2YWx1ZSl7CiAgdmFyIHByb21pc2UgPSB0aGlzOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHByb21pc2UuX3YgPSB2YWx1ZTsKICBwcm9taXNlLl9zID0gMjsKICBpZighcHJvbWlzZS5fYSlwcm9taXNlLl9hID0gcHJvbWlzZS5fYy5zbGljZSgpOwogIG5vdGlmeShwcm9taXNlLCB0cnVlKTsKfTsKdmFyICRyZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpewogIHZhciBwcm9taXNlID0gdGhpcwogICAgLCB0aGVuOwogIGlmKHByb21pc2UuX2QpcmV0dXJuOwogIHByb21pc2UuX2QgPSB0cnVlOwogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcAogIHRyeSB7CiAgICBpZihwcm9taXNlID09PSB2YWx1ZSl0aHJvdyBUeXBlRXJyb3IoIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmIik7CiAgICBpZih0aGVuID0gaXNUaGVuYWJsZSh2YWx1ZSkpewogICAgICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKICAgICAgICB2YXIgd3JhcHBlciA9IHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfTsgLy8gd3JhcAogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGVuLmNhbGwodmFsdWUsIGN0eCgkcmVzb2x2ZSwgd3JhcHBlciwgMSksIGN0eCgkcmVqZWN0LCB3cmFwcGVyLCAxKSk7CiAgICAgICAgfSBjYXRjaChlKXsKICAgICAgICAgICRyZWplY3QuY2FsbCh3cmFwcGVyLCBlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgcHJvbWlzZS5fdiA9IHZhbHVlOwogICAgICBwcm9taXNlLl9zID0gMTsKICAgICAgbm90aWZ5KHByb21pc2UsIGZhbHNlKTsKICAgIH0KICB9IGNhdGNoKGUpewogICAgJHJlamVjdC5jYWxsKHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfSwgZSk7IC8vIHdyYXAKICB9Cn07CgovLyBjb25zdHJ1Y3RvciBwb2x5ZmlsbAppZighVVNFX05BVElWRSl7CiAgLy8gMjUuNC4zLjEgUHJvbWlzZShleGVjdXRvcikKICAkUHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpewogICAgYW5JbnN0YW5jZSh0aGlzLCAkUHJvbWlzZSwgUFJPTUlTRSwgJ19oJyk7CiAgICBhRnVuY3Rpb24oZXhlY3V0b3IpOwogICAgSW50ZXJuYWwuY2FsbCh0aGlzKTsKICAgIHRyeSB7CiAgICAgIGV4ZWN1dG9yKGN0eCgkcmVzb2x2ZSwgdGhpcywgMSksIGN0eCgkcmVqZWN0LCB0aGlzLCAxKSk7CiAgICB9IGNhdGNoKGVycil7CiAgICAgICRyZWplY3QuY2FsbCh0aGlzLCBlcnIpOwogICAgfQogIH07CiAgSW50ZXJuYWwgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKICAgIHRoaXMuX2MgPSBbXTsgICAgICAgICAgICAgLy8gPC0gYXdhaXRpbmcgcmVhY3Rpb25zCiAgICB0aGlzLl9hID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIGNoZWNrZWQgaW4gaXNVbmhhbmRsZWQgcmVhY3Rpb25zCiAgICB0aGlzLl9zID0gMDsgICAgICAgICAgICAgIC8vIDwtIHN0YXRlCiAgICB0aGlzLl9kID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIGRvbmUKICAgIHRoaXMuX3YgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gdmFsdWUKICAgIHRoaXMuX2ggPSAwOyAgICAgICAgICAgICAgLy8gPC0gcmVqZWN0aW9uIHN0YXRlLCAwIC0gZGVmYXVsdCwgMSAtIGhhbmRsZWQsIDIgLSB1bmhhbmRsZWQKICAgIHRoaXMuX24gPSBmYWxzZTsgICAgICAgICAgLy8gPC0gbm90aWZ5CiAgfTsKICBJbnRlcm5hbC5wcm90b3R5cGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KSgkUHJvbWlzZS5wcm90b3R5cGUsIHsKICAgIC8vIDI1LjQuNS4zIFByb21pc2UucHJvdG90eXBlLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpCiAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKXsKICAgICAgdmFyIHJlYWN0aW9uICAgID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsICRQcm9taXNlKSk7CiAgICAgIHJlYWN0aW9uLm9rICAgICA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PSAnZnVuY3Rpb24nID8gb25GdWxmaWxsZWQgOiB0cnVlOwogICAgICByZWFjdGlvbi5mYWlsICAgPSB0eXBlb2Ygb25SZWplY3RlZCA9PSAnZnVuY3Rpb24nICYmIG9uUmVqZWN0ZWQ7CiAgICAgIHJlYWN0aW9uLmRvbWFpbiA9IGlzTm9kZSA/IHByb2Nlc3MuZG9tYWluIDogdW5kZWZpbmVkOwogICAgICB0aGlzLl9jLnB1c2gocmVhY3Rpb24pOwogICAgICBpZih0aGlzLl9hKXRoaXMuX2EucHVzaChyZWFjdGlvbik7CiAgICAgIGlmKHRoaXMuX3Mpbm90aWZ5KHRoaXMsIGZhbHNlKTsKICAgICAgcmV0dXJuIHJlYWN0aW9uLnByb21pc2U7CiAgICB9LAogICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2gob25SZWplY3RlZCkKICAgICdjYXRjaCc6IGZ1bmN0aW9uKG9uUmVqZWN0ZWQpewogICAgICByZXR1cm4gdGhpcy50aGVuKHVuZGVmaW5lZCwgb25SZWplY3RlZCk7CiAgICB9CiAgfSk7CiAgUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbigpewogICAgdmFyIHByb21pc2UgID0gbmV3IEludGVybmFsOwogICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTsKICAgIHRoaXMucmVzb2x2ZSA9IGN0eCgkcmVzb2x2ZSwgcHJvbWlzZSwgMSk7CiAgICB0aGlzLnJlamVjdCAgPSBjdHgoJHJlamVjdCwgcHJvbWlzZSwgMSk7CiAgfTsKfQoKJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1Byb21pc2U6ICRQcm9taXNlfSk7Cl9fd2VicGFja19yZXF1aXJlX18oMjEpKCRQcm9taXNlLCBQUk9NSVNFKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg5OCkoUFJPTUlTRSk7CldyYXBwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApW1BST01JU0VdOwoKLy8gc3RhdGljcwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCBQUk9NSVNFLCB7CiAgLy8gMjUuNC40LjUgUHJvbWlzZS5yZWplY3QocikKICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyKXsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlamVjdCAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgICAkJHJlamVjdChyKTsKICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgfQp9KTsKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoTElCUkFSWSB8fCAhVVNFX05BVElWRSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuNiBQcm9taXNlLnJlc29sdmUoeCkKICByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKHgpewogICAgLy8gaW5zdGFuY2VvZiBpbnN0ZWFkIG9mIGludGVybmFsIHNsb3QgY2hlY2sgYmVjYXVzZSB3ZSBzaG91bGQgZml4IGl0IHdpdGhvdXQgcmVwbGFjZW1lbnQgbmF0aXZlIFByb21pc2UgY29yZQogICAgaWYoeCBpbnN0YW5jZW9mICRQcm9taXNlICYmIHNhbWVDb25zdHJ1Y3Rvcih4LmNvbnN0cnVjdG9yLCB0aGlzKSlyZXR1cm4geDsKICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKICAgICAgLCAkJHJlc29sdmUgID0gY2FwYWJpbGl0eS5yZXNvbHZlOwogICAgJCRyZXNvbHZlKHgpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoVVNFX05BVElWRSAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fKDkyKShmdW5jdGlvbihpdGVyKXsKICAkUHJvbWlzZS5hbGwoaXRlcilbJ2NhdGNoJ10oZW1wdHkpOwp9KSksIFBST01JU0UsIHsKICAvLyAyNS40LjQuMSBQcm9taXNlLmFsbChpdGVyYWJsZSkKICBhbGw6IGZ1bmN0aW9uIGFsbChpdGVyYWJsZSl7CiAgICB2YXIgQyAgICAgICAgICA9IHRoaXMKICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKICAgICAgLCByZXNvbHZlICAgID0gY2FwYWJpbGl0eS5yZXNvbHZlCiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwogICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgdmFyIHZhbHVlcyAgICA9IFtdCiAgICAgICAgLCBpbmRleCAgICAgPSAwCiAgICAgICAgLCByZW1haW5pbmcgPSAxOwogICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2UpewogICAgICAgIHZhciAkaW5kZXggICAgICAgID0gaW5kZXgrKwogICAgICAgICAgLCBhbHJlYWR5Q2FsbGVkID0gZmFsc2U7CiAgICAgICAgdmFsdWVzLnB1c2godW5kZWZpbmVkKTsKICAgICAgICByZW1haW5pbmcrKzsKICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgICBpZihhbHJlYWR5Q2FsbGVkKXJldHVybjsKICAgICAgICAgIGFscmVhZHlDYWxsZWQgID0gdHJ1ZTsKICAgICAgICAgIHZhbHVlc1skaW5kZXhdID0gdmFsdWU7CiAgICAgICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgfSk7CiAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9LAogIC8vIDI1LjQuNC40IFByb21pc2UucmFjZShpdGVyYWJsZSkKICByYWNlOiBmdW5jdGlvbiByYWNlKGl0ZXJhYmxlKXsKICAgIHZhciBDICAgICAgICAgID0gdGhpcwogICAgICAsIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgICAsIHJlamVjdCAgICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7CiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oY2FwYWJpbGl0eS5yZXNvbHZlLCByZWplY3QpOwogICAgICB9KTsKICAgIH0pOwogICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwoKLyoqKi8gfSksCi8qIDEwNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyBFQ01BU2NyaXB0IDYgc3ltYm9scyBzaGltCnZhciBnbG9iYWwgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIERFU0NSSVBUT1JTICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKQogICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCiAgLCByZWRlZmluZSAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDYpCiAgLCBNRVRBICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpLktFWQogICwgJGZhaWxzICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKQogICwgc2hhcmVkICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgdWlkICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKQogICwgd2tzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpCiAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCiAgLCB3a3NEZWZpbmUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDgpCiAgLCBrZXlPZiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTMpCiAgLCBlbnVtS2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODYpCiAgLCBpc0FycmF5ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTApCiAgLCBhbk9iamVjdCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIHRvUHJpbWl0aXZlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKICAsIF9jcmVhdGUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSkKICAsIGdPUE5FeHQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NSkKICAsICRHT1BEICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NykKICAsICREUCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgJGtleXMgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgZ09QRCAgICAgICAgICAgPSAkR09QRC5mCiAgLCBkUCAgICAgICAgICAgICA9ICREUC5mCiAgLCBnT1BOICAgICAgICAgICA9IGdPUE5FeHQuZgogICwgJFN5bWJvbCAgICAgICAgPSBnbG9iYWwuU3ltYm9sCiAgLCAkSlNPTiAgICAgICAgICA9IGdsb2JhbC5KU09OCiAgLCBfc3RyaW5naWZ5ICAgICA9ICRKU09OICYmICRKU09OLnN0cmluZ2lmeQogICwgUFJPVE9UWVBFICAgICAgPSAncHJvdG90eXBlJwogICwgSElEREVOICAgICAgICAgPSB3a3MoJ19oaWRkZW4nKQogICwgVE9fUFJJTUlUSVZFICAgPSB3a3MoJ3RvUHJpbWl0aXZlJykKICAsIGlzRW51bSAgICAgICAgID0ge30ucHJvcGVydHlJc0VudW1lcmFibGUKICAsIFN5bWJvbFJlZ2lzdHJ5ID0gc2hhcmVkKCdzeW1ib2wtcmVnaXN0cnknKQogICwgQWxsU3ltYm9scyAgICAgPSBzaGFyZWQoJ3N5bWJvbHMnKQogICwgT1BTeW1ib2xzICAgICAgPSBzaGFyZWQoJ29wLXN5bWJvbHMnKQogICwgT2JqZWN0UHJvdG8gICAgPSBPYmplY3RbUFJPVE9UWVBFXQogICwgVVNFX05BVElWRSAgICAgPSB0eXBlb2YgJFN5bWJvbCA9PSAnZnVuY3Rpb24nCiAgLCBRT2JqZWN0ICAgICAgICA9IGdsb2JhbC5RT2JqZWN0OwovLyBEb24ndCB1c2Ugc2V0dGVycyBpbiBRdCBTY3JpcHQsIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8xNzMKdmFyIHNldHRlciA9ICFRT2JqZWN0IHx8ICFRT2JqZWN0W1BST1RPVFlQRV0gfHwgIVFPYmplY3RbUFJPVE9UWVBFXS5maW5kQ2hpbGQ7CgovLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODcKdmFyIHNldFN5bWJvbERlc2MgPSBERVNDUklQVE9SUyAmJiAkZmFpbHMoZnVuY3Rpb24oKXsKICByZXR1cm4gX2NyZWF0ZShkUCh7fSwgJ2EnLCB7CiAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBkUCh0aGlzLCAnYScsIHt2YWx1ZTogN30pLmE7IH0KICB9KSkuYSAhPSA3Owp9KSA/IGZ1bmN0aW9uKGl0LCBrZXksIEQpewogIHZhciBwcm90b0Rlc2MgPSBnT1BEKE9iamVjdFByb3RvLCBrZXkpOwogIGlmKHByb3RvRGVzYylkZWxldGUgT2JqZWN0UHJvdG9ba2V5XTsKICBkUChpdCwga2V5LCBEKTsKICBpZihwcm90b0Rlc2MgJiYgaXQgIT09IE9iamVjdFByb3RvKWRQKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7Cn0gOiBkUDsKCnZhciB3cmFwID0gZnVuY3Rpb24odGFnKXsKICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pOwogIHN5bS5fayA9IHRhZzsKICByZXR1cm4gc3ltOwp9OwoKdmFyIGlzU3ltYm9sID0gVVNFX05BVElWRSAmJiB0eXBlb2YgJFN5bWJvbC5pdGVyYXRvciA9PSAnc3ltYm9sJyA/IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnOwp9IDogZnVuY3Rpb24oaXQpewogIHJldHVybiBpdCBpbnN0YW5jZW9mICRTeW1ib2w7Cn07Cgp2YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCl7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvKSRkZWZpbmVQcm9wZXJ0eShPUFN5bWJvbHMsIGtleSwgRCk7CiAgYW5PYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgYW5PYmplY3QoRCk7CiAgaWYoaGFzKEFsbFN5bWJvbHMsIGtleSkpewogICAgaWYoIUQuZW51bWVyYWJsZSl7CiAgICAgIGlmKCFoYXMoaXQsIEhJRERFTikpZFAoaXQsIEhJRERFTiwgY3JlYXRlRGVzYygxLCB7fSkpOwogICAgICBpdFtISURERU5dW2tleV0gPSB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgaWYoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSlpdFtISURERU5dW2tleV0gPSBmYWxzZTsKICAgICAgRCA9IF9jcmVhdGUoRCwge2VudW1lcmFibGU6IGNyZWF0ZURlc2MoMCwgZmFsc2UpfSk7CiAgICB9IHJldHVybiBzZXRTeW1ib2xEZXNjKGl0LCBrZXksIEQpOwogIH0gcmV0dXJuIGRQKGl0LCBrZXksIEQpOwp9Owp2YXIgJGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKGl0LCBQKXsKICBhbk9iamVjdChpdCk7CiAgdmFyIGtleXMgPSBlbnVtS2V5cyhQID0gdG9JT2JqZWN0KFApKQogICAgLCBpICAgID0gMAogICAgLCBsID0ga2V5cy5sZW5ndGgKICAgICwga2V5OwogIHdoaWxlKGwgPiBpKSRkZWZpbmVQcm9wZXJ0eShpdCwga2V5ID0ga2V5c1tpKytdLCBQW2tleV0pOwogIHJldHVybiBpdDsKfTsKdmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaXQsIFApewogIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfY3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9jcmVhdGUoaXQpLCBQKTsKfTsKdmFyICRwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IGZ1bmN0aW9uIHByb3BlcnR5SXNFbnVtZXJhYmxlKGtleSl7CiAgdmFyIEUgPSBpc0VudW0uY2FsbCh0aGlzLCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKTsKICBpZih0aGlzID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSlyZXR1cm4gZmFsc2U7CiAgcmV0dXJuIEUgfHwgIWhhcyh0aGlzLCBrZXkpIHx8ICFoYXMoQWxsU3ltYm9scywga2V5KSB8fCBoYXModGhpcywgSElEREVOKSAmJiB0aGlzW0hJRERFTl1ba2V5XSA/IEUgOiB0cnVlOwp9Owp2YXIgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICBpdCAgPSB0b0lPYmplY3QoaXQpOwogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CiAgaWYoaXQgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKXJldHVybjsKICB2YXIgRCA9IGdPUEQoaXQsIGtleSk7CiAgaWYoRCAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKUQuZW51bWVyYWJsZSA9IHRydWU7CiAgcmV0dXJuIEQ7Cn07CnZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpewogIHZhciBuYW1lcyAgPSBnT1BOKHRvSU9iamVjdChpdCkpCiAgICAsIHJlc3VsdCA9IFtdCiAgICAsIGkgICAgICA9IDAKICAgICwga2V5OwogIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpewogICAgaWYoIWhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiBrZXkgIT0gSElEREVOICYmIGtleSAhPSBNRVRBKXJlc3VsdC5wdXNoKGtleSk7CiAgfSByZXR1cm4gcmVzdWx0Owp9Owp2YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCl7CiAgdmFyIElTX09QICA9IGl0ID09PSBPYmplY3RQcm90bwogICAgLCBuYW1lcyAgPSBnT1BOKElTX09QID8gT1BTeW1ib2xzIDogdG9JT2JqZWN0KGl0KSkKICAgICwgcmVzdWx0ID0gW10KICAgICwgaSAgICAgID0gMAogICAgLCBrZXk7CiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7CiAgICBpZihoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYgKElTX09QID8gaGFzKE9iamVjdFByb3RvLCBrZXkpIDogdHJ1ZSkpcmVzdWx0LnB1c2goQWxsU3ltYm9sc1trZXldKTsKICB9IHJldHVybiByZXN1bHQ7Cn07CgovLyAxOS40LjEuMSBTeW1ib2woW2Rlc2NyaXB0aW9uXSkKaWYoIVVTRV9OQVRJVkUpewogICRTeW1ib2wgPSBmdW5jdGlvbiBTeW1ib2woKXsKICAgIGlmKHRoaXMgaW5zdGFuY2VvZiAkU3ltYm9sKXRocm93IFR5cGVFcnJvcignU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIScpOwogICAgdmFyIHRhZyA9IHVpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7CiAgICB2YXIgJHNldCA9IGZ1bmN0aW9uKHZhbHVlKXsKICAgICAgaWYodGhpcyA9PT0gT2JqZWN0UHJvdG8pJHNldC5jYWxsKE9QU3ltYm9scywgdmFsdWUpOwogICAgICBpZihoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKXRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7CiAgICAgIHNldFN5bWJvbERlc2ModGhpcywgdGFnLCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7CiAgICB9OwogICAgaWYoREVTQ1JJUFRPUlMgJiYgc2V0dGVyKXNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0fSk7CiAgICByZXR1cm4gd3JhcCh0YWcpOwogIH07CiAgcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEVdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpewogICAgcmV0dXJuIHRoaXMuX2s7CiAgfSk7CgogICRHT1BELmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwogICREUC5mICAgPSAkZGVmaW5lUHJvcGVydHk7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg2NSkuZiA9IGdPUE5FeHQuZiA9ICRnZXRPd25Qcm9wZXJ0eU5hbWVzOwogIF9fd2VicGFja19yZXF1aXJlX18oNDEpLmYgID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlOwogIF9fd2VicGFja19yZXF1aXJlX18oNTgpLmYgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKICBpZihERVNDUklQVE9SUyAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygyNSkpewogICAgcmVkZWZpbmUoT2JqZWN0UHJvdG8sICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsICRwcm9wZXJ0eUlzRW51bWVyYWJsZSwgdHJ1ZSk7CiAgfQoKICB3a3NFeHQuZiA9IGZ1bmN0aW9uKG5hbWUpewogICAgcmV0dXJuIHdyYXAod2tzKG5hbWUpKTsKICB9Cn0KCiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtTeW1ib2w6ICRTeW1ib2x9KTsKCmZvcih2YXIgc3ltYm9scyA9ICgKICAvLyAxOS40LjIuMiwgMTkuNC4yLjMsIDE5LjQuMi40LCAxOS40LjIuNiwgMTkuNC4yLjgsIDE5LjQuMi45LCAxOS40LjIuMTAsIDE5LjQuMi4xMSwgMTkuNC4yLjEyLCAxOS40LjIuMTMsIDE5LjQuMi4xNAogICdoYXNJbnN0YW5jZSxpc0NvbmNhdFNwcmVhZGFibGUsaXRlcmF0b3IsbWF0Y2gscmVwbGFjZSxzZWFyY2gsc3BlY2llcyxzcGxpdCx0b1ByaW1pdGl2ZSx0b1N0cmluZ1RhZyx1bnNjb3BhYmxlcycKKS5zcGxpdCgnLCcpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzKHN5bWJvbHNbaSsrXSk7Cgpmb3IodmFyIHN5bWJvbHMgPSAka2V5cyh3a3Muc3RvcmUpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzRGVmaW5lKHN5bWJvbHNbaSsrXSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywgewogIC8vIDE5LjQuMi4xIFN5bWJvbC5mb3Ioa2V5KQogICdmb3InOiBmdW5jdGlvbihrZXkpewogICAgcmV0dXJuIGhhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKQogICAgICA/IFN5bWJvbFJlZ2lzdHJ5W2tleV0KICAgICAgOiBTeW1ib2xSZWdpc3RyeVtrZXldID0gJFN5bWJvbChrZXkpOwogIH0sCiAgLy8gMTkuNC4yLjUgU3ltYm9sLmtleUZvcihzeW0pCiAga2V5Rm9yOiBmdW5jdGlvbiBrZXlGb3Ioa2V5KXsKICAgIGlmKGlzU3ltYm9sKGtleSkpcmV0dXJuIGtleU9mKFN5bWJvbFJlZ2lzdHJ5LCBrZXkpOwogICAgdGhyb3cgVHlwZUVycm9yKGtleSArICcgaXMgbm90IGEgc3ltYm9sIScpOwogIH0sCiAgdXNlU2V0dGVyOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSB0cnVlOyB9LAogIHVzZVNpbXBsZTogZnVuY3Rpb24oKXsgc2V0dGVyID0gZmFsc2U7IH0KfSk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnT2JqZWN0JywgewogIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKICBjcmVhdGU6ICRjcmVhdGUsCiAgLy8gMTkuMS4yLjQgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCiAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSwKICAvLyAxOS4xLjIuMyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKQogIGRlZmluZVByb3BlcnRpZXM6ICRkZWZpbmVQcm9wZXJ0aWVzLAogIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkKICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsCiAgLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcywKICAvLyAxOS4xLjIuOCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKE8pCiAgZ2V0T3duUHJvcGVydHlTeW1ib2xzOiAkZ2V0T3duUHJvcGVydHlTeW1ib2xzCn0pOwoKLy8gMjQuMy4yIEpTT04uc3RyaW5naWZ5KHZhbHVlIFssIHJlcGxhY2VyIFssIHNwYWNlXV0pCiRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbigpewogIHZhciBTID0gJFN5bWJvbCgpOwogIC8vIE1TIEVkZ2UgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIHt9CiAgLy8gV2ViS2l0IGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyBudWxsCiAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHMKICByZXR1cm4gX3N0cmluZ2lmeShbU10pICE9ICdbbnVsbF0nIHx8IF9zdHJpbmdpZnkoe2E6IFN9KSAhPSAne30nIHx8IF9zdHJpbmdpZnkoT2JqZWN0KFMpKSAhPSAne30nOwp9KSksICdKU09OJywgewogIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXsKICAgIGlmKGl0ID09PSB1bmRlZmluZWQgfHwgaXNTeW1ib2woaXQpKXJldHVybjsgLy8gSUU4IHJldHVybnMgc3RyaW5nIG9uIHVuZGVmaW5lZAogICAgdmFyIGFyZ3MgPSBbaXRdCiAgICAgICwgaSAgICA9IDEKICAgICAgLCByZXBsYWNlciwgJHJlcGxhY2VyOwogICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKICAgIHJlcGxhY2VyID0gYXJnc1sxXTsKICAgIGlmKHR5cGVvZiByZXBsYWNlciA9PSAnZnVuY3Rpb24nKSRyZXBsYWNlciA9IHJlcGxhY2VyOwogICAgaWYoJHJlcGxhY2VyIHx8ICFpc0FycmF5KHJlcGxhY2VyKSlyZXBsYWNlciA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpewogICAgICBpZigkcmVwbGFjZXIpdmFsdWUgPSAkcmVwbGFjZXIuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTsKICAgICAgaWYoIWlzU3ltYm9sKHZhbHVlKSlyZXR1cm4gdmFsdWU7CiAgICB9OwogICAgYXJnc1sxXSA9IHJlcGxhY2VyOwogICAgcmV0dXJuIF9zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3MpOwogIH0KfSk7CgovLyAxOS40LjMuNCBTeW1ib2wucHJvdG90eXBlW0BAdG9QcmltaXRpdmVdKGhpbnQpCiRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IF9fd2VicGFja19yZXF1aXJlX18oNikoJFN5bWJvbFtQUk9UT1RZUEVdLCBUT19QUklNSVRJVkUsICRTeW1ib2xbUFJPVE9UWVBFXS52YWx1ZU9mKTsKLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXQpzZXRUb1N0cmluZ1RhZygkU3ltYm9sLCAnU3ltYm9sJyk7Ci8vIDIwLjIuMS45IE1hdGhbQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTsKLy8gMjQuMy4zIEpTT05bQEB0b1N0cmluZ1RhZ10Kc2V0VG9TdHJpbmdUYWcoZ2xvYmFsLkpTT04sICdKU09OJywgdHJ1ZSk7CgovKioqLyB9KSwKLyogMTA2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdhc3luY0l0ZXJhdG9yJyk7CgovKioqLyB9KSwKLyogMTA3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNDgpKCdvYnNlcnZhYmxlJyk7CgovKioqLyB9KSwKLyogMTA4ICovLAovKiAxMDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfc3RyaW5naWZ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCk7Cgp2YXIgX3N0cmluZ2lmeTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpbmdpZnkpOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsKZXhwb3J0cy5kaXZpZGVFbWFpbCA9IGRpdmlkZUVtYWlsOwpleHBvcnRzLmVtcHR5T2JqZWN0ID0gZW1wdHlPYmplY3Q7CmV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOwpleHBvcnRzLmdldFVzZXJVUkxGcm9tRW1haWwgPSBnZXRVc2VyVVJMRnJvbUVtYWlsOwpleHBvcnRzLmdldFVzZXJFbWFpbEZyb21VUkwgPSBnZXRVc2VyRW1haWxGcm9tVVJMOwpleHBvcnRzLmNvbnZlcnRUb1VzZXJVUkwgPSBjb252ZXJ0VG9Vc2VyVVJMOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwovKioKICogU3VwcG9ydCBtb2R1bGUgd2l0aCBzb21lIGZ1bmN0aW9ucyB3aWxsIGJlIHVzZWZ1bAogKiBAbW9kdWxlIHV0aWxzCiAqLwoKLyoqCiAqIEB0eXBlZGVmIGRpdmlkZVVSTAogKiBAdHlwZSBPYmplY3QKICogQHByb3BlcnR5IHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgVVJMCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkb21haW4gVGhlIGRvbWFpbiBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGlkZW50aXR5IFRoZSBpZGVudGl0eSBvZiBVUkwKICovCgovKioKICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5CiAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAqIEByZXR1cm4ge2RpdmlkZVVSTH0gdGhlIHJlc3VsdCBvZiBkaXZpZGVVUkwKICovCmZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHsKCiAgaWYgKCF1cmwpIHRocm93IEVycm9yKCdVUkwgaXMgbmVlZGVkIHRvIHNwbGl0Jyk7CgogIGZ1bmN0aW9uIHJlY3Vyc2UodmFsdWUpIHsKICAgIHZhciByZWdleCA9IC8oW2EtekEtWi1dKikoOlwvXC8oPzpcLik/fDopKFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTsKICAgIHZhciBzdWJzdCA9ICckMSwkMywkNCc7CiAgICB2YXIgcGFydHMgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBzdWJzdCkuc3BsaXQoJywnKTsKICAgIHJldHVybiBwYXJ0czsKICB9CgogIHZhciBwYXJ0cyA9IHJlY3Vyc2UodXJsKTsKCiAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lCiAgaWYgKHBhcnRzWzBdID09PSB1cmwgJiYgIXBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKCiAgICB2YXIgX3Jlc3VsdCA9IHsKICAgICAgdHlwZTogIiIsCiAgICAgIGRvbWFpbjogdXJsLAogICAgICBpZGVudGl0eTogIiIKICAgIH07CgogICAgY29uc29sZS5lcnJvcignW0RpdmlkZVVSTF0gRGl2aWRlVVJMIGRvblwndCBzdXBwb3J0IHVybCB3aXRob3V0IHNjaGVtZS4gUGxlYXNlIHJldmlldyB5b3VyIHVybCBhZGRyZXNzJywgdXJsKTsKCiAgICByZXR1cm4gX3Jlc3VsdDsKICB9CgogIC8vIGNoZWNrIGlmIHRoZSB1cmwgaGFzIHRoZSBzY2hlbWUgYW5kIGluY2x1ZGVzIGFuIEAKICBpZiAocGFydHNbMF0gPT09IHVybCAmJiBwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CiAgICB2YXIgc2NoZW1lID0gcGFydHNbMF0gPT09IHVybCA/ICdzbXRwJyA6IHBhcnRzWzBdOwogICAgcGFydHMgPSByZWN1cnNlKHNjaGVtZSArICc6Ly8nICsgcGFydHNbMF0pOwogIH0KCiAgLy8gaWYgdGhlIGRvbWFpbiBpbmNsdWRlcyBhbiBALCBkaXZpZGUgaXQgdG8gZG9tYWluIGFuZCBpZGVudGl0eSByZXNwZWN0aXZlbHkKICBpZiAocGFydHNbMV0uaW5jbHVkZXMoJ0AnKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1swXSArICc6Ly8nICsgcGFydHNbMV07CiAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdLnN1YnN0cihwYXJ0c1sxXS5pbmRleE9mKCdAJykgKyAxKTsKICB9IC8qZWxzZSBpZiAocGFydHNbMl0uaW5jbHVkZXMoJy8nKSkgewogICAgcGFydHNbMl0gPSBwYXJ0c1syXS5zdWJzdHIocGFydHNbMl0ubGFzdEluZGV4T2YoJy8nKSsxKTsKICAgIH0qLwoKICB2YXIgcmVzdWx0ID0gewogICAgdHlwZTogcGFydHNbMF0sCiAgICBkb21haW46IHBhcnRzWzFdLAogICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgfTsKCiAgcmV0dXJuIHJlc3VsdDsKfQoKZnVuY3Rpb24gZGl2aWRlRW1haWwoZW1haWwpIHsKICB2YXIgaW5kZXhPZkF0ID0gZW1haWwuaW5kZXhPZignQCcpOwoKICB2YXIgcmVzdWx0ID0gewogICAgdXNlcm5hbWU6IGVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpLAogICAgZG9tYWluOiBlbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgZW1haWwubGVuZ3RoKQogIH07CgogIHJldHVybiByZXN1bHQ7Cn0KCi8qKgogKiBDaGVjayBpZiBhbiBPYmplY3QgaXMgZW1wdHkKICogQHBhcmFtICB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IHRvIGJlIGNoZWNrZWQKICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgc3RhdHVzIG9mIE9iamVjdCwgZW1wdHkgb3Igbm90ICh0cnVlfGZhbHNlKTsKICovCmZ1bmN0aW9uIGVtcHR5T2JqZWN0KG9iamVjdCkgewogIHJldHVybiAoMCwgX2tleXMyLmRlZmF1bHQpKG9iamVjdCkubGVuZ3RoID4gMCA/IGZhbHNlIDogdHJ1ZTsKfQoKLyoqCiAqIE1ha2UgYSBDT1BZIG9mIHRoZSBvcmlnaW5hbCBkYXRhCiAqIEBwYXJhbSAge09iamVjdH0gIG9iaiAtIG9iamVjdCB0byBiZSBjbG9uZWQKICogQHJldHVybiB7T2JqZWN0fQogKi8KZnVuY3Rpb24gZGVlcENsb25lKG9iaikgewogIC8vVE9ETzogc2ltcGxlIGJ1dCBpbmVmZmljaWVudCBKU09OIGRlZXAgY2xvbmUuLi4KICBpZiAob2JqKSByZXR1cm4gSlNPTi5wYXJzZSgoMCwgX3N0cmluZ2lmeTIuZGVmYXVsdCkob2JqKSk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIFVSTCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gZW1haWwKICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICogQHJldHVybiB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICovCmZ1bmN0aW9uIGdldFVzZXJVUkxGcm9tRW1haWwodXNlckVtYWlsKSB7CiAgdmFyIGluZGV4T2ZBdCA9IHVzZXJFbWFpbC5pbmRleE9mKCdAJyk7CiAgcmV0dXJuICd1c2VyOi8vJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgdXNlckVtYWlsLmxlbmd0aCkgKyAnLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCk7Cn0KCi8qKgogKiBPYnRhaW5zIHRoZSB1c2VyIGVtYWlsIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBVUkwKICogQHBhcmFtICB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKICogQHJldHVybiB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKICovCmZ1bmN0aW9uIGdldFVzZXJFbWFpbEZyb21VUkwodXNlclVSTCkgewogIHZhciB1cmwgPSBkaXZpZGVVUkwodXNlclVSTCk7CiAgcmV0dXJuIHVybC5pZGVudGl0eS5yZXBsYWNlKCcvJywgJycpICsgJ0AnICsgdXJsLmRvbWFpbjsgLy8gaWRlbnRpdHkgZmllbGQgaGFzICcvZXhhbXBsZUlEJyBpbnN0ZWFkIG9mICdleGFtcGxlSUQnCn0KCi8qKgogKiBDaGVjayBpZiB0aGUgdXNlciBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIFVSTCBmb3JtYXQsIGlmIG5vdCwgY29udmVydCB0byBVUkwgZm9ybWF0CiAqIEBwYXJhbSAge3N0cmluZ30gICBpZGVudGlmaWVyICB1c2VyIGlkZW50aWZpZXIKICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMCiAqLwpmdW5jdGlvbiBjb252ZXJ0VG9Vc2VyVVJMKGlkZW50aWZpZXIpIHsKCiAgLy8gY2hlY2sgaWYgdGhlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgdXJsIGZvcm1hdAogIGlmIChpZGVudGlmaWVyLnN1YnN0cmluZygwLCA3KSA9PT0gJ3VzZXI6Ly8nKSB7CiAgICB2YXIgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChpZGVudGlmaWVyKTsKCiAgICAvL2NoZWNrIGlmIHRoZSB1cmwgaXMgd2VsbCBmb3JtYXRlZAogICAgaWYgKGRpdmlkZWRVUkwuZG9tYWluICYmIGRpdmlkZWRVUkwuaWRlbnRpdHkpIHsKICAgICAgcmV0dXJuIGlkZW50aWZpZXI7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyAndXNlclVSTCB3aXRoIHdyb25nIGZvcm1hdCc7CiAgICB9CgogICAgLy9pZiBub3QsIGNvbnZlcnQgdGhlIHVzZXIgZW1haWwgdG8gVVJMIGZvcm1hdAogIH0gZWxzZSB7CiAgICByZXR1cm4gZ2V0VXNlclVSTEZyb21FbWFpbChpZGVudGlmaWVyKTsKICB9Cn0KCi8qKiovIH0pLAovKiAxMTAgKi8sCi8qIDExMSAqLywKLyogMTEyICovLAovKiAxMTMgKi8sCi8qIDExNCAqLywKLyogMTE1ICovLAovKiAxMTYgKi8sCi8qIDExNyAqLywKLyogMTE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMik7Cgp2YXIgX2dldDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMyk7Cgp2YXIgX2dldDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXQyKTsKCnZhciBfaW5oZXJpdHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMyk7Cgp2YXIgX2luaGVyaXRzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2luaGVyaXRzMik7Cgp2YXIgX0RhdGFPYmplY3QyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjApOwoKdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCnZhciBfRGF0YU9iamVjdENoaWxkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjEpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdENoaWxkKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBGaWx0ZXJUeXBlID0geyBBTlk6ICdhbnknLCBTVEFSVDogJ3N0YXJ0JywgRVhBQ1Q6ICdleGFjdCcgfTsKCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBzdWJzY3JpYmUgY2FsbC4KICogVG8gYmUgdXNlZCBhcyBhbiBvYnNlcnZhdGlvbiBwb2ludCBmcm9tIGEgRGF0YU9iamVjdFJlcG9ydGVyIGNoYW5nZS4KICovCgp2YXIgRGF0YU9iamVjdE9ic2VydmVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CiAgKDAsIF9pbmhlcml0czMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBfRGF0YU9iamVjdCk7CgogIC8qIHByaXZhdGUKICBfY2hhbmdlTGlzdGVuZXI6IE1zZ0xpc3RlbmVyCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfZmlsdGVyczogezxmaWx0ZXI+OiB7dHlwZTogPHN0YXJ0LCBleGFjdD4sIGNhbGxiYWNrOiA8ZnVuY3Rpb24+fSB9CiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyLnN1YnNjcmliZSBtZXRob2QKICAgKi8KCiAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogIGZ1bmN0aW9uIERhdGFPYmplY3RPYnNlcnZlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucywgaW5pdGlhbFZlcnNpb24sIG11dHVhbCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdE9ic2VydmVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdE9ic2VydmVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YS5kYXRhLCBjaGlsZHJlbnMsIG11dHVhbCkpOwoKICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IGluaXRpYWxWZXJzaW9uOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewogICAgICBfdGhpcy5fb25GaWx0ZXIoZXZlbnQpOwogICAgfSk7CgogICAgLy9zZXR1cCBjaGlsZHJlbnMgZGF0YSBmcm9tIHN1YnNjcmlwdGlvbgogICAgKDAsIF9rZXlzMi5kZWZhdWx0KShpbml0aWFsRGF0YS5jaGlsZHJlbnMpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkSWQpIHsKICAgICAgdmFyIGNoaWxkRGF0YSA9IGluaXRpYWxEYXRhLmNoaWxkcmVuc1tjaGlsZElkXTsKICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBjaGlsZElkLCBjaGlsZERhdGEpOwogICAgfSk7CgogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwgKyAnL2NoYW5nZXMnLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgaWYgKG1zZy50eXBlID09PSAndXBkYXRlJykgewogICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwogICAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChfdGhpcy5fc3luY09iaiwgbXNnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICd1bnN1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsVW5TdWJzY3JpYmUKICAgICAgdmFyIHVuU3Vic2NyaWJlTXNnID0gewogICAgICAgIHR5cGU6ICd1bnN1YnNjcmliZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHVuU3Vic2NyaWJlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdE9ic2VydmVyLVVOU1VCU0NSSUJFOiAnLCByZXBseSk7CiAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9zeW5jaGVyLl9vYnNlcnZlcnNbX3RoaXMuX3VybF07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsdGVyIC0gRmlsdGVyIHRoYXQgaWRlbnRpZmllcyB0aGUgZmllbGQgKHNlcGFyYXRlZCBkb3QgcGF0aCkuIEFjY2VwdHMgKiBhdCB0aGUgZW5kIGZvciBhIG1vcmUgdW5yZXN0cmljdGVkIGZpbHRlcmluZy4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkNoYW5nZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2UoZmlsdGVyLCBjYWxsYmFjaykgewogICAgICB2YXIga2V5ID0gZmlsdGVyOwogICAgICB2YXIgZmlsdGVyT2JqID0gewogICAgICAgIHR5cGU6IEZpbHRlclR5cGUuRVhBQ1QsCiAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrCiAgICAgIH07CgogICAgICB2YXIgaWR4ID0gZmlsdGVyLmluZGV4T2YoJyonKTsKICAgICAgaWYgKGlkeCA9PT0gZmlsdGVyLmxlbmd0aCAtIDEpIHsKICAgICAgICBpZiAoaWR4ID09PSAwKSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuQU5ZOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuU1RBUlQ7CiAgICAgICAgICBrZXkgPSBmaWx0ZXIuc3Vic3RyKDAsIGZpbHRlci5sZW5ndGggLSAxKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuX2ZpbHRlcnNba2V5XSA9IGZpbHRlck9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25GaWx0ZXInLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZpbHRlcihldmVudCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fZmlsdGVycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdmFyIGZpbHRlciA9IF90aGlzLl9maWx0ZXJzW2tleV07CiAgICAgICAgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLkFOWSkgewogICAgICAgICAgLy9tYXRjaCBhbnl0aGluZwogICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKICAgICAgICB9IGVsc2UgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLlNUQVJUKSB7CiAgICAgICAgICAvL2lmIHN0YXJ0cyB3aXRoIGZpbHRlci4uLgogICAgICAgICAgaWYgKGV2ZW50LmZpZWxkLmluZGV4T2Yoa2V5KSA9PT0gMCkgewogICAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuRVhBQ1QpIHsKICAgICAgICAgIC8vZXhhY3QgbWF0Y2gKICAgICAgICAgIGlmIChldmVudC5maWVsZCA9PT0ga2V5KSB7CiAgICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFPYmplY3RPYnNlcnZlcjsKfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdE9ic2VydmVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKdmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yKTsKCnZhciBfZ2V0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCnZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKdmFyIF9pbmhlcml0czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTsKCnZhciBfaW5oZXJpdHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5oZXJpdHMyKTsKCnZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCk7Cgp2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIFN5bmNoZXIgY3JlYXRlIGNhbGwuCiAqIFRvIGJlIHVzZWQgYXMgYSByZXBvcnRlciBwb2ludCwgY2hhbmdlcyB3aWxsIGJlIHN1Ym1pdGVkIHRvIERhdGFPYmplY3RPYnNlcnZlciBpbnN0YW5jZXMuCiAqLwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCnZhciBEYXRhT2JqZWN0UmVwb3J0ZXIgPSBmdW5jdGlvbiAoX0RhdGFPYmplY3QpIHsKICAoMCwgX2luaGVyaXRzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIF9EYXRhT2JqZWN0KTsKCiAgLyogcHJpdmF0ZQogIF9zdWJzY3JpcHRpb25zOiA8aHlwZXJ0eVVybDogeyBzdGF0dXM6IHN0cmluZyB9IH0+CiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25TdWJzY3JpcHRpb25IYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICBfb25SZXNwb25zZUhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlYWRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuY3JlYXRlIG1ldGhvZAogICAqLwogIGZ1bmN0aW9uIERhdGFPYmplY3RSZXBvcnRlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdFJlcG9ydGVyKTsKCiAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdFJlcG9ydGVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSk7CgogICAgdmFyIF90aGlzID0gX3RoaXMyOwoKICAgIF90aGlzLl9zdWJzY3JpcHRpb25zID0ge307CgogICAgX3RoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci0nICsgdXJsICsgJy1TRU5EOiAnLCBldmVudCk7CiAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCk7CiAgICB9KTsKCiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgIHJldHVybiBfdGhpczI7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX2FsbG9jYXRlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9vYmplY3RMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgewogICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0LScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewogICAgICAgICAgY2FzZSAncmVzcG9uc2UnOgogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpO2JyZWFrOwogICAgICAgICAgY2FzZSAncmVhZCc6CiAgICAgICAgICAgIF90aGlzLl9vblJlYWQobXNnKTticmVhazsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlci5wcm90b3R5cGUpLCAnX3JlbGVhc2VMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX29iamVjdExpc3RlbmVyLnJlbW92ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogU2VuZCBpbnZpdGF0aW9ucyAoY3JlYXRlIG1lc3NhZ2VzKSB0byBoeXBlcnRpZXMsIG9ic2VydmVycyBsaXN0LgogICAgICogQHBhcmFtICB7SHlwZXJ0eVVSTFtdfSBvYnNlcnZlcnMgTGlzdCBvZiBIeXBlcnR5IFVSTCdzCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnaW52aXRlT2JzZXJ2ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnZpdGVPYnNlcnZlcnMob2JzZXJ2ZXJzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkNyZWF0ZQogICAgICB2YXIgaW52aXRlTXNnID0gewogICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fc3luY2hlci5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAogICAgICAgIGJvZHk6IHsgcmVzdW1lOiBmYWxzZSwgcmVzb3VyY2U6IF90aGlzLl91cmwsIHNjaGVtYTogX3RoaXMuX3NjaGVtYSwgdmFsdWU6IF90aGlzLl9zeW5jT2JqLmRhdGEsIGF1dGhvcmlzZTogb2JzZXJ2ZXJzIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoaW52aXRlTXNnKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uRGVsZXRlCiAgICAgIHZhciBkZWxldGVNc2cgPSB7CiAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CiAgICAgIH07CgogICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKGRlbGV0ZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1ERUxFVEU6ICcsIHJlcGx5KTsKICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX3JlcG9ydGVyc1tfdGhpcy5fdXJsXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU3Vic2NyaXB0aW9ucyByZXF1ZXN0ZWQgYW5kIGFjY2VwdGVkIHRvIHRoaXMgcmVwb3J0ZXIKICAgICAqIEB0eXBlIHtPYmplY3Q8SHlwZXJ0eVVSTCwgU3luY1N1YnNjcmlwdGlvbj59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25TdWJzY3JpcHRpb24nLAoKCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHN1YnNjcmliZSBhbmQgdW5zdWJzY3JpYmUgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TdWJzY3JpcHRpb24oY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZXNwb25zZSBub3RpZmljYXRpb25zIG9mIHRoZSBjcmVhdGUncwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlYWQgbm90aWZpY2F0aW9ucwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVhZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZWFkKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVhZEhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBwYXJlbnQgU3luY2hlciAtPiBfb25Gb3J3YXJkCgogIH0sIHsKICAgIGtleTogJ19vbkZvcndhcmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLVJDVjogJywgbXNnKTsKICAgICAgc3dpdGNoIChtc2cuYm9keS50eXBlKSB7CiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblN1YnNjcmliZShtc2cpO2JyZWFrOwogICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoKICAgICAgICAgIF90aGlzLl9vblVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGlzIC0+IF9vbkZvcndhcmQ6IGVtaXR0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBzdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uU3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdWJzY3JpYmUobXNnKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwogICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3RSZXBvcnRlci5fb25TdWJzY3JpYmVdJywgbXNnKTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIC8vY3JlYXRlIG5ldyBzdWJzY3JpcHRpb24KICAgICAgICAgIHZhciBzdWIgPSB7IHVybDogaHlwZXJ0eVVybCwgc3RhdHVzOiAnb24nIH07CiAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjsKCiAgICAgICAgICAvL3Byb2Nlc3MgYW5kIHNlbmQgY2hpbGRyZW5zIGRhdGEKICAgICAgICAgIHZhciBjaGlsZHJlblZhbHVlcyA9IHt9OwogICAgICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CiAgICAgICAgICAgIHZhciBjaGlsZERhdGEgPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdLmRhdGE7CiAgICAgICAgICAgIGNoaWxkcmVuVmFsdWVzW2NoaWxkSWRdID0gKDAsIF91dGlscy5kZWVwQ2xvbmUpKGNoaWxkRGF0YSk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgc2VuZE1zZyA9IHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoX3RoaXMuZGF0YSksIGNoaWxkcmVuczogY2hpbGRyZW5WYWx1ZXMgfSB9CiAgICAgICAgICB9OwoKICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsQXV0aGVudGljYXRpb24nKSAmJiAhbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24pIHsKICAgICAgICAgICAgc2VuZE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbjsKICAgICAgICAgICAgX3RoaXMzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBvayByZXNwb25zZSBtZXNzYWdlCiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHNlbmRNc2cpOwoKICAgICAgICAgIHJldHVybiBzdWI7CiAgICAgICAgfSwKCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QocmVhc29uKSB7CiAgICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdTVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoaXMgLT4gX29uRm9yd2FyZDogZW1pdHRlZCBieSBhIHJlbW90ZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgLT4gdW5zdWJzY3JpYmUKCiAgfSwgewogICAga2V5OiAnX29uVW5TdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblVuU3Vic2NyaWJlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgaHlwZXJ0eVVybCA9IG1zZy5ib2R5LmZyb207CgogICAgICB2YXIgc3ViID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CiAgICAgIGRlbGV0ZSBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAogICAgICAgIHVybDogaHlwZXJ0eVVybCwKICAgICAgICBvYmplY3Q6IHN1YgogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnVU4tU1VCU0NSSVBUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBSZXBvcnRlclVSTCBhZGRyZXNzOiBlbWl0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBfb25SZW1vdGVDcmVhdGUgLT4gZXZlbnQuYWNrCgogIH0sIHsKICAgIGtleTogJ19vblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZXNwb25zZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICB1cmw6IG1zZy5mcm9tLAogICAgICAgIGNvZGU6IG1zZy5ib2R5LmNvZGUKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVTUE9OU0UtRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gcmVhZAoKICB9LCB7CiAgICBrZXk6ICdfb25SZWFkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWFkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmZyb20sCgogICAgICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgdmFsdWU6ICgwLCBfdXRpbHMuZGVlcENsb25lKShfdGhpcy5kYXRhKSB9CiAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDEsIGRlc2M6IHJlYXNvbiB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uUmVhZEhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnUkVBRC1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblJlYWRIYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3N1YnNjcmlwdGlvbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb25zOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdFJlcG9ydGVyOwp9KF9EYXRhT2JqZWN0My5kZWZhdWx0IC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0UmVwb3J0ZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEyMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9wcm9taXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7Cgp2YXIgX3Byb21pc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvbWlzZSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX1Byb3h5T2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKdmFyIF9Qcm94eU9iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Qcm94eU9iamVjdCk7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCnZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7Cgp2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBNYWluIGV4dGVuc2lvbiBjbGFzcyBmb3Igb2JzZXJ2ZXJzIGFuZCByZXBvcnRlcnMsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIG1ldGhvZHMuCiAqIENoaWxkcmVuIG1hbmFnZW1lbnQgaXMgY29tbW9uIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycy4KICovCnZhciBEYXRhT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICBfdmVyc2lvbjogbnVtYmVyCiAgIF9vd25lcjogSHlwZXJ0eVVSTAogIF91cmw6IE9iamVjdFVSTAogIF9zY2hlbWE6IFNjaGVtYQogIF9idXM6IE1pbmlCdXMKICBfc3RhdHVzOiBvbiB8IHBhdXNlZAogIF9zeW5jT2JqOiBTeW5jRGF0YQogICBfY2hpbGRyZW46IHsgaWQ6IERhdGFPYmplY3RDaGlsZCB9CiAgX2NoaWxkcmVuTGlzdGVuZXJzOiBbTXNnTGlzdGVuZXJdCiAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KICBfb25BZGRDaGlsZEhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogICovCgogIC8qKgogICAqIEBpZ25vcmUKICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlciBjcmVhdGUgb3Igc3Vic2NyaWJlIG1ldGhvZCdzCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdChzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucykgewogICAgdmFyIG11dHVhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDogdHJ1ZTsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX3N5bmNoZXIgPSBzeW5jaGVyOwogICAgX3RoaXMuX3VybCA9IHVybDsKICAgIF90aGlzLl9zY2hlbWEgPSBzY2hlbWE7CiAgICBfdGhpcy5fc3RhdHVzID0gaW5pdGlhbFN0YXR1czsKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CiAgICBfdGhpcy5fY2hpbGRyZW5zID0gY2hpbGRyZW5zOwoKICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgIF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbDsKCiAgICBfdGhpcy5fdmVyc2lvbiA9IDA7CiAgICBfdGhpcy5fY2hpbGRJZCA9IDA7CiAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzID0ge307CiAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMgPSBbXTsKCiAgICBfdGhpcy5fb3duZXIgPSBzeW5jaGVyLl9vd25lcjsKICAgIF90aGlzLl9idXMgPSBzeW5jaGVyLl9idXM7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0LCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBjaGlsZEJhc2VVUkwgPSBfdGhpcy5fdXJsICsgJy9jaGlsZHJlbi8nOwogICAgICBjb25zb2xlLmxvZygnW0RhdGEgT2JqZWN0IC0gQWxsb2NhdGVMaXN0ZW5lcnNdIC0gJywgX3RoaXMuX2NoaWxkcmVucyk7CiAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW5zKSB7CiAgICAgICAgX3RoaXMuX2NoaWxkcmVucy5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkgewogICAgICAgICAgdmFyIGNoaWxkVVJMID0gY2hpbGRCYXNlVVJMICsgY2hpbGQ7CiAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgICAgICAgaWYgKG1zZy5mcm9tICE9PSBfdGhpczIuX293bmVyKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3QtQ2hpbGRyZW4tUkNWOiAnLCBtc2cpOwogICAgICAgICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6CiAgICAgICAgICAgICAgICAgIF90aGlzLl9vbkNoaWxkQ3JlYXRlKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOgogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO2JyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgX3RoaXMuX2NoYW5nZUNoaWxkcmVuKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHsKICAgICAgICBsaXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfSk7CgogICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNba2V5XS5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBVUkwgb2YgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIKICAgICAqIEB0eXBlIHtPYmplY3RVUkx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncGF1c2UnLAoKCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkgewogICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CiAgICB9CgogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAncmVzdW1lJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7CiAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdG9wJywKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICAvL1RPRE86IHNob3VsZCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBhbmQgc2VuZCBtZXNzYWdlIHVuc3Vic2NyaWJlPwogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgYWRkIGEgRGF0YU9iamVjdENoaWxkIHRvIGEgY2hpbGRyZW4gY29sbGVjdGlvbi4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGlsZHJlbiAtIENoaWxkcmVuIG5hbWUgd2hlcmUgdGhlIGNoaWxkIGlzIGFkZGVkLgogICAgICogQHBhcmFtIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgY2hpbGQKICAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdENoaWxkPn0gLSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBEYXRhT2JqZWN0Q2hpbGQuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnYWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENoaWxkKGNoaWxkcmVuLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9jcmVhdGUgbmV3IGNoaWxkIHVuaXF1ZSBJRCwgYmFzZWQgb24gaHlwZXJ0eVVSTAogICAgICBfdGhpcy5fY2hpbGRJZCsrOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IF90aGlzLl9vd25lciArICcjJyArIF90aGlzLl9jaGlsZElkOwogICAgICB2YXIgbXNnQ2hpbGRQYXRoID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJyArIGNoaWxkcmVuOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byBhIHJlc291cmNlIGNoaWxkIGFkZHJlc3M6IE1lc3NhZ2VCdXMKICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IG1zZ0NoaWxkUGF0aCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBtc2dDaGlsZElkLCB2YWx1ZTogaW5pdGlhbERhdGEgfQogICAgICB9OwoKICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgcmVxdWVzdE1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uOwoKICAgICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbAogICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgdmFyIG1zZ0lkID0gX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZXF1ZXN0TXNnKTsKCiAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZS1yZXBvcnRlci1jaGlsZCggJyArIF90aGlzLl9vd25lciArICcgKTogJywgcmVxdWVzdE1zZyk7CiAgICAgICAgdmFyIG5ld0NoaWxkID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIG1zZ0NoaWxkSWQsIGluaXRpYWxEYXRhLCBfdGhpcy5fb3duZXIsIG1zZ0lkKTsKICAgICAgICBuZXdDaGlsZC5vbkNoYW5nZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCwgeyBwYXRoOiBtc2dDaGlsZFBhdGgsIGNoaWxkSWQ6IG1zZ0NoaWxkSWQgfSk7CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgICAgcmVzb2x2ZShuZXdDaGlsZCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgY3JlYXRlIGFuZCBkZWxldGUgb2YgY2hpbGRyZW5zLgogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uQWRkQ2hpbGQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQWRkQ2hpbGQoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IGFkZENoaWxkCgogIH0sIHsKICAgIGtleTogJ19vbkNoaWxkQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGlsZENyZWF0ZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIG1zZ0NoaWxkSWQgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUtb2JzZXJ2ZXItY2hpbGQoICcgKyBfdGhpcy5fb3duZXIgKyAnICk6ICcsIG1zZyk7CiAgICAgIHZhciBuZXdDaGlsZCA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBtc2dDaGlsZElkLCBtc2cuYm9keS52YWx1ZSk7CiAgICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHNbbXNnQ2hpbGRJZF0gPSBuZXdDaGlsZDsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIC8vRkxPVy1PVVQ6IHdpbGwgZmxvdyB0byBEYXRhT2JqZWN0Q2hpbGQgLT4gX29uUmVzcG9uc2UKICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHNvdXJjZTogX3RoaXMuX293bmVyIH0KICAgICAgICB9KTsKICAgICAgfSk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmZyb20sCiAgICAgICAgdXJsOiBtc2cudG8sCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGNoaWxkSWQ6IG1zZ0NoaWxkSWQsCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5CiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ0FERC1DSElMRFJFTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL3NlbmQgZGVsdGEgbWVzc2FnZXMgdG8gc3Vic2NyaXB0aW9ucwoKICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoYW5nZShldmVudCwgY2hpbGRJbmZvKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fdmVyc2lvbisrOwoKICAgICAgaWYgKF90aGlzLl9zdGF0dXMgPT09ICdvbicpIHsKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIGEgcmVzb3VyY2UgY2hhbmdlcyBhZGRyZXNzOiBNZXNzYWdlQnVzCiAgICAgICAgdmFyIGNoYW5nZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICd1cGRhdGUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogX3RoaXMuX3VybCArICcvY2hhbmdlcycsCiAgICAgICAgICBib2R5OiB7IHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCBzb3VyY2U6IF90aGlzLl9vd25lciwgYXR0cmlidXRlOiBldmVudC5maWVsZCB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0IC0gX29uQ2hhbmdlXSAtICcsIGV2ZW50LCBjaGlsZEluZm8sIGNoYW5nZU1zZyk7CgogICAgICAgIGlmIChldmVudC5vVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuT0JKRUNUKSB7CiAgICAgICAgICBpZiAoZXZlbnQuY1R5cGUgIT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlJFTU9WRSkgewogICAgICAgICAgICBjaGFuZ2VNc2cuYm9keS52YWx1ZSA9IGV2ZW50LmRhdGE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPSBldmVudC5vVHlwZTsKICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKICAgICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuVVBEQVRFKSB7CiAgICAgICAgICAgIGNoYW5nZU1zZy5ib2R5Lm9wZXJhdGlvbiA9IGV2ZW50LmNUeXBlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy9jaGlsZEluZm8gbXVzdCBoYXZlIChwYXRoLCBjaGlsZElkKQogICAgICAgIGlmIChjaGlsZEluZm8pIHsKICAgICAgICAgIGNoYW5nZU1zZy50byA9IGNoaWxkSW5mby5wYXRoOwogICAgICAgICAgY2hhbmdlTXNnLmJvZHkucmVzb3VyY2UgPSBjaGlsZEluZm8uY2hpbGRJZDsKICAgICAgICB9CgogICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICBpZiAoIV90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbikgY2hhbmdlTXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoY2hhbmdlTXNnKTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogZGVsdGEgbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RSZXBvcnRlciBvciBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VPYmplY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VPYmplY3Qoc3luY09iaiwgbXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL1RPRE86IHVwZGF0ZSB2ZXJzaW9uID8KICAgICAgLy9ob3cgdG8gaGFuZGxlIGFuIGluY29ycmVjdCB2ZXJzaW9uID8gRXhhbXBsZTogcmVjZWl2ZSBhIHZlcnNpb24gMyB3aGVuIHRoZSBvYnNlcnZlciBpcyBpbiB2ZXJzaW9uIDEsIHdoZXJlIGlzIHRoZSB2ZXJzaW9uIDIgPwogICAgICAvL3dpbGwgd2UgbmVlZCB0byBjb25maXJtIHRoZSByZWNlcHRpb24gPwogICAgICBpZiAoX3RoaXMuX3ZlcnNpb24gKyAxID09PSBtc2cuYm9keS52ZXJzaW9uKSB7CiAgICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKICAgICAgICB2YXIgcGF0aCA9IG1zZy5ib2R5LmF0dHJpYnV0ZTsKICAgICAgICB2YXIgdmFsdWUgPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkobXNnLmJvZHkudmFsdWUpOwogICAgICAgIHZhciBmaW5kUmVzdWx0ID0gc3luY09iai5maW5kQmVmb3JlKHBhdGgpOwoKICAgICAgICBpZiAobXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuQVJSQVkpIHsKICAgICAgICAgIGlmIChtc2cuYm9keS5vcGVyYXRpb24gPT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLkFERCkgewogICAgICAgICAgICB2YXIgYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBpbmRleCA9IGZpbmRSZXN1bHQubGFzdDsKICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShhcnIsIFtpbmRleCwgMF0uY29uY2F0KHZhbHVlKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CiAgICAgICAgICAgIHZhciBfYXJyID0gZmluZFJlc3VsdC5vYmo7CiAgICAgICAgICAgIHZhciBfaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CiAgICAgICAgICAgIF9hcnIuc3BsaWNlKF9pbmRleCwgdmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XSA9IHZhbHVlOyAvLyBVUERBVEUKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKG1zZy5ib2R5LnZhbHVlKSB7CiAgICAgICAgICAgIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF0gPSB2YWx1ZTsgLy8gVVBEQVRFIG9yIEFERAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVsZXRlIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF07IC8vIFJFTU9WRQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvL1RPRE86IGhvdyB0byBoYW5kbGUgdW5zeW5jaHJvbml6ZWQgdmVyc2lvbnM/CiAgICAgICAgY29uc29sZS5sb2coJ1VOU1lOQ0hST05JWkVEIFZFUlNJT046IChkYXRhID0+ICcgKyBfdGhpcy5fdmVyc2lvbiArICcsIG1zZyA9PiAnICsgbXNnLmJvZHkudmVyc2lvbiArICcpJyk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgogIH0sIHsKICAgIGtleTogJ19jaGFuZ2VDaGlsZHJlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NoYW5nZUNoaWxkcmVuKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBjb25zb2xlLmxvZygnQ2hhbmdlIGNoaWxkcmVuOiAnLCBfdGhpcy5fb3duZXIsIG1zZyk7CgogICAgICB2YXIgY2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlOwogICAgICB2YXIgY2hpbGRyZW4gPSBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdOwoKICAgICAgaWYgKGNoaWxkcmVuKSB7CiAgICAgICAgX3RoaXMuX2NoYW5nZU9iamVjdChjaGlsZHJlbi5fc3luY09iaiwgbXNnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygnTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAnLCBjaGlsZElkKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ3VybCcsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3VybDsKICAgIH0KCiAgICAvKioKICAgICAqIE9iamVjdCBzY2hlbWEgVVJMICh0aGlzIGZpZWxkIGlzIG5vdCB5ZXQgc3RhYmxlLCBhbmQgaXMgc3Vic2plY3QgdG8gY2hhbmdlKQogICAgICogQHR5cGUge1NjaGVtYVVSTH0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzY2hlbWEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zY2hlbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdGF0dXMgb2YgdGhlIHJlcG9ydGVyIG9yIG9ic2VydmVyIGNvbm5lY3Rpb24gKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpCiAgICAgKiBAdHlwZSB7U3RhdHVzfSAtIEVudW0gb2Y6IG9uIHwgcGF1c2VkCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnc3RhdHVzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3RhdHVzOwogICAgfQoKICAgIC8qKgogICAgICogRGF0YSBzdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLgogICAgICogQHR5cGUge0pTT059IC0gSlNPTiBzdHJ1Y3R1cmUgdGhhdCBzaG91bGQgZm9sbG93IHRoZSBkZWZpbmVkIHNjaGVtYSwgaWYgYW55LgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RhdGEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGwgY3JlYXRlZCBjaGlsZHJlbidzIHNpbmNlIHRoZSBzdWJzY3JpcHRpb24sIGRvZXNuJ3QgY29udGFpbiBhbGwgY2hpbGRyZW4ncyBzaW5jZSByZXBvcnRlciBjcmVhdGlvbi4KICAgICAqIEB0eXBlIHtPYmplY3Q8Q2hpbGRJZCwgRGF0YU9iamVjdENoaWxkPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdjaGlsZHJlbnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhT2JqZWN0Owp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTIxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIyKTsKCnZhciBfUHJveHlPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUHJveHlPYmplY3QpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgRGF0YU9iamVjdCBhZGRDaGlsZHJlbiBjYWxsIG9yIGZyb20gb25BZGRDaGlsZHJlbiBpZiByZW1vdGVseSBjcmVhdGVkLgogKiBDaGlsZHJlbiBvYmplY3Qgc3luY2hyb25pemF0aW9uIGlzIGEgYSBmYXN0IGZvcndhcmQgbWVjaGFuaXNtLCBubyBuZWVkIGZvciBkaXJlY3Qgc3Vic2NyaXB0aW9ucywgaXQgdXNlcyB0aGUgYWxyZWFkeSBhdXRob3JpemVkIHN1YnNjcmlwdGlvbiBmcm9tIHRoZSBwYXJlbnQgRGF0YU9iamVjdC4KICovCnZhciBEYXRhT2JqZWN0Q2hpbGQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBEYXRhT2JqZWN0LmFkZENoaWxkcmVuCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdENoaWxkKHBhcmVudCwgY2hpbGRJZCwgaW5pdGlhbERhdGEsIG93bmVyLCBtc2dJZCkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdENoaWxkKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9wYXJlbnQgPSBwYXJlbnQ7CiAgICBfdGhpcy5fY2hpbGRJZCA9IGNoaWxkSWQ7CiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl9tc2dJZCA9IG1zZ0lkOwoKICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CgogICAgX3RoaXMuX2J1cyA9IHBhcmVudC5fYnVzOwogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0Q2hpbGQsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vdGhpcyBpcyBvbmx5IG5lZWRlZCBmb3IgY2hpbGRyZW4gcmVwb3J0ZXJzCiAgICAgIGlmIChfdGhpcy5fb3duZXIpIHsKICAgICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl9vd25lciwgZnVuY3Rpb24gKG1zZykgewogICAgICAgICAgaWYgKG1zZy50eXBlID09PSAncmVzcG9uc2UnICYmIG1zZy5pZCA9PT0gX3RoaXMuX21zZ0lkKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0Q2hpbGQub25SZXNwb25zZTonLCBtc2cpOwogICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKF90aGlzLl9saXN0ZW5lcikgewogICAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgZGVsZXRlIF90aGlzLl9wYXJlbnQuX2NoaWxkcmVuW190aGlzLl9jaGlsZElkXTsKCiAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgogICAgICAvL1RPRE86IHNlbmQgZGVsZXRlIG1lc3NhZ2UgPwogICAgfQoKICAgIC8qKgogICAgICogQ2hpbGRyZW4gSUQgZ2VuZXJhdGVkIG9uIGFkZENoaWxkcmVuLiBVbmlxdWUgaWRlbnRpZmllcgogICAgICogQHR5cGUge1VSTH0gLSBVUkwgb2YgdGhlIGZvcm1hdCA8SHlwZXJ0eVVSTD4jPG51bWVyaWMtc2VxdWVuY2U+CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25DaGFuZ2UnLAoKCiAgICAvKioKICAgICAqIFJlZ2lzdGVyIHRoZSBjaGFuZ2UgbGlzdGVuZXJzIHNlbnQgYnkgdGhlIHJlcG9ydGVyIGNoaWxkCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZShjYWxsYmFjaykgewogICAgICB0aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlc3BvbnNlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIGNyZWF0ZXMKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlc3BvbnNlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uUmVzcG9uc2VIYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdCAtPiBfb25DaGlsZENyZWF0ZQoKICB9LCB7CiAgICBrZXk6ICdfb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVzcG9uc2UobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgdXJsOiBtc2cuYm9keS5zb3VyY2UsCiAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdjaGlsZElkJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRJZDsKICAgIH0KCiAgICAvKioKICAgICAqIERhdGEgU3RydWN0dXJlIHRvIGJlIHN5bmNocm9uaXplZC4KICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fc3luY09iai5kYXRhOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdENoaWxkOwp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdENoaWxkOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5PYmplY3RUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0gdW5kZWZpbmVkOwoKdmFyIF9zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCnZhciBfc3RyaW5naWZ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmeSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKX193ZWJwYWNrX3JlcXVpcmVfXygxNTMpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBvYmplY3RUeXBlID0geyBBUlJBWTogJ1tvYmplY3QgQXJyYXldJywgT0JKRUNUOiAnW29iamVjdCBPYmplY3RdJyB9OwoKLyoqCiAqIEBhY2Nlc3MgcHJpdmF0ZQogKiBNYWluIGNsYXNzIHRoYXQgbWFpbnRhaW5zIGEgSlNPTiBvYmplY3QsIGFuZCBvYnNlcnZlcyBjaGFuZ2VzIGluIHRoaXMgb2JqZWN0LCByZWN1cnNpdmVseS4KICogSW50ZXJuYWwgb2JqZWN0cyBhbmQgYXJyYXlzIGFyZSBhbHNvIG9ic2VydmVkLgogKi8KCnZhciBTeW5jT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFN5bmNPYmplY3QoaW5pdGlhbERhdGEpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFN5bmNPYmplY3QpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX29ic2VydmVycyA9IFtdOwogICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCiAgICB0aGlzLl9kYXRhID0gaW5pdGlhbERhdGEgfHwge307CgogICAgdGhpcy5faW50ZXJuYWxPYnNlcnZlKHRoaXMuX2RhdGEpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoU3luY09iamVjdCwgW3sKICAgIGtleTogJ29ic2VydmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnB1c2goY2FsbGJhY2spOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmQocGF0aCkgewogICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCiAgICAgIHJldHVybiB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwogICAgfQogIH0sIHsKICAgIGtleTogJ2ZpbmRCZWZvcmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRCZWZvcmUocGF0aCkgewogICAgICB2YXIgcmVzdWx0ID0ge307CiAgICAgIHZhciBsaXN0ID0gcGF0aC5zcGxpdCgnLicpOwogICAgICByZXN1bHQubGFzdCA9IGxpc3QucG9wKCk7CiAgICAgIHJlc3VsdC5vYmogPSB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfZmluZFdpdGhTcGxpdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbmRXaXRoU3BsaXQobGlzdCkgewogICAgICB2YXIgb2JqID0gdGhpcy5fZGF0YTsKICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIG9iaiA9IG9ialt2YWx1ZV07CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIG9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfaXNPYnNlcnZhYmxlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNPYnNlcnZhYmxlKG9iaikgewogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBPYmplY3QgfHwgb2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2ludGVybmFsT2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsT2JzZXJ2ZShvYmplY3QpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoY2hhbmdlc2V0KSB7CgogICAgICAgIGNoYW5nZXNldC5ldmVyeShmdW5jdGlvbiAoY2hhbmdlKSB7CiAgICAgICAgICBfdGhpczIuX29uQ2hhbmdlcyhjaGFuZ2UpOwogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgdGhpcy5fZGF0YSA9IE9iamVjdC5kZWVwT2JzZXJ2ZShvYmplY3QsIGhhbmRsZXIpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19maXJlRXZlbnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maXJlRXZlbnQoZXZlbnQpIHsKICAgICAgdGhpcy5fb2JzZXJ2ZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgY2FsbGJhY2soZXZlbnQpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfb25DaGFuZ2VzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGFuZ2VzKGNoYW5nZSkgewoKICAgICAgdmFyIG9iaiA9IGNoYW5nZS5vYmplY3Q7CiAgICAgIHZhciBvYmpUeXBlID0gdm9pZCAwOwoKICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7CiAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuT0JKRUNUOwogICAgICB9CgogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewogICAgICAgIG9ialR5cGUgPSBPYmplY3RUeXBlLkFSUkFZOwogICAgICB9CgogICAgICB2YXIgZmllbGRTdHJpbmcgPSBjaGFuZ2Uua2V5cGF0aDsKCiAgICAgIC8vIGNvbnNvbGUubG9nKCdGaWVsZDonLCBmaWVsZFN0cmluZyk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCd0eXBlOicsIGNoYW5nZS50eXBlKTsKCiAgICAgIC8vbGV0IG9sZFZhbHVlID0gY2hhbmdlLm9sZFZhbHVlOwogICAgICB2YXIgbmV3VmFsdWUgPSBvYmpbY2hhbmdlLm5hbWVdOwoKICAgICAgY29uc29sZS5pbmZvKGNoYW5nZS50eXBlICsgJyB8IEZpZWxkOiAnICsgZmllbGRTdHJpbmcgKyAnIHwgTmV3IFZhbHVlOicsICgwLCBfc3RyaW5naWZ5Mi5kZWZhdWx0KShuZXdWYWx1ZSkpOwoKICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAndXBkYXRlJykgewogICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5VUERBVEUsCiAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZywKICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2FkZCcpIHsKICAgICAgICB0aGlzLl9maXJlRXZlbnQoewogICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuQURELAogICAgICAgICAgb1R5cGU6IG9ialR5cGUsCiAgICAgICAgICBmaWVsZDogZmllbGRTdHJpbmcsCiAgICAgICAgICBkYXRhOiBuZXdWYWx1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdkZWxldGUnKSB7CiAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLlJFTU9WRSwKICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdkYXRhJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fZGF0YTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFN5bmNPYmplY3Q7Cn0oKTsKCnZhciBDaGFuZ2VUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0geyBVUERBVEU6ICd1cGRhdGUnLCBBREQ6ICdhZGQnLCBSRU1PVkU6ICdyZW1vdmUnIH07CnZhciBPYmplY3RUeXBlID0gZXhwb3J0cy5PYmplY3RUeXBlID0geyBPQkpFQ1Q6ICdvYmplY3QnLCBBUlJBWTogJ2FycmF5JyB9OwpleHBvcnRzLmRlZmF1bHQgPSBTeW5jT2JqZWN0OwoKLyoqKi8gfSksCi8qIDEyMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTsKCnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKdmFyIF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzOCk7Cgp2YXIgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgewogIGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsKICB2YXIgZGVzYyA9ICgwLCBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMi5kZWZhdWx0KShvYmplY3QsIHByb3BlcnR5KTsKCiAgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgewogICAgdmFyIHBhcmVudCA9ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKG9iamVjdCk7CgogICAgaWYgKHBhcmVudCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7CiAgICB9CiAgfSBlbHNlIGlmICgidmFsdWUiIGluIGRlc2MpIHsKICAgIHJldHVybiBkZXNjLnZhbHVlOwogIH0gZWxzZSB7CiAgICB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7CgogICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CgogICAgcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsKICB9Cn07CgovKioqLyB9KSwKLyogMTI0ICovLAovKiAxMjUgKi8sCi8qIDEyNiAqLywKLyogMTI3ICovLAovKiAxMjggKi8sCi8qIDEyOSAqLywKLyogMTMwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX3Byb21pc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCnZhciBfYXNzaWduID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzYpOwoKdmFyIF9hc3NpZ24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXNzaWduKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE5KTsKCnZhciBfRGF0YU9iamVjdFJlcG9ydGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RSZXBvcnRlcik7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE4KTsKCnZhciBfRGF0YU9iamVjdE9ic2VydmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RPYnNlcnZlcik7Cgp2YXIgX0RhdGFQcm92aXNpb25hbCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMzKTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFQcm92aXNpb25hbCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogVGhlIG1haW4gY2xhc3MgZm9yIHRoZSBzeW5jaGVyIHBhY2thZ2UuCiogVGhlIFN5bmNoZXIgaXMgYSBzaW5nbGV0b24gY2xhc3MgcGVyIEh5cGVydHkvVVJMIGFuZCBpdCBpcyB0aGUgb3duZXIgb2YgYWxsIGNyZWF0ZWQgRGF0YSBTeW5jIE9iamVjdHMgYWNjb3JkaW5nIHRvIHRoZSBSZXBvcnRlciAtIE9ic2VydmVyIHBhdHRlcm4uCiogTWFpbiBmdW5jdGlvbmFsaXR5IGlzIHRvIGNyZWF0ZSByZXBvcnRlcnMgYW5kIHRvIHN1YnNjcmliZSB0byBleGlzdGluZyBvbmVzLgoqLwp2YXIgU3luY2hlciA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgX293bmVyOiBVUkwKICBfYnVzOiBNaW5pQnVzCiAgIF9zdWJVUkw6IFVSTAogICBfcmVwb3J0ZXJzOiA8dXJsOiBEYXRhT2JqZWN0UmVwb3J0ZXI+CiAgX29ic2VydmVyczogPHVybDogRGF0YU9iamVjdE9ic2VydmVyPgogIF9wcm92aXNpb25hbHM6IDx1cmw6IERhdGFQcm92aXNpb25hbD4KICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vbk5vdGlmaWNhdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlc3VtZTogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgKiBDb25zdHJ1Y3RvciB0aGF0IHNob3VsZCBiZSB1c2VkIGJ5IHRoZSBIeXBlcnR5IG93bmVyCiAgKiBAcGFyYW0ge0h5cGVydHlVUkx9IG93bmVyIC0gSHlwZXJ0eSBVUkwgb3duZXIuIEFuIFVSTCBhbGxvY2F0ZWQgYnkgdGhlIHJ1bnRpbWUgdGhhdCB1bmlxdWVseSBpZGVudGlmaWVzIHRoZSBIeXBlcnR5LgogICogQHBhcmFtIHtNaW5pQnVzfSBidXMgLSBBbiBpbnN0YW5jZSBvZiB0aGUgTWluaUJ1cyBwcm92aWRlZCBpbiB0aGUgc2FuZGJveC4gV2hlbiBhbiBvYmplY3QgKFJlcG9ydGVyIG9yIE9ic2VydmVkKSBpcyBjcmVhdGVkLCB0aGUgU3luY2hlck1hbmFnZXIgd2lsbCBhZGQgYSBsaXN0ZW5lciBpbiB0aGUgTWluaUJ1cyB0byByZWNlaXZlL3NlbmQgTWVzc2FnZXMgb2YgdGhhdCBvYmplY3QuCiAgKiBAcGFyYW0ge0pTT059IGNvbmZpZyAtIENvbmZpZ3VyYXRpb24gZGF0YS4gVGhlIG9ubHkgcmVxdWlyZWQgZmllbGQgZm9yIG5vdyBpcyB0aGUgcnVudGltZVVSTC4KICAqLwogIGZ1bmN0aW9uIFN5bmNoZXIob3duZXIsIGJ1cywgY29uZmlnKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBTeW5jaGVyKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX2J1cyA9IGJ1czsKCiAgICBfdGhpcy5fc3ViVVJMID0gY29uZmlnLnJ1bnRpbWVVUkwgKyAnL3NtJzsKCiAgICBfdGhpcy5fcmVwb3J0ZXJzID0ge307CiAgICBfdGhpcy5fb2JzZXJ2ZXJzID0ge307CiAgICBfdGhpcy5fcHJvdmlzaW9uYWxzID0ge307CgogICAgYnVzLmFkZExpc3RlbmVyKG93bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikgewogICAgICAgIGNvbnNvbGUuaW5mbygnW1N5bmNoZXJdIFN5bmNoZXItUkNWOiAnLCBtc2cpOwogICAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsKICAgICAgICAgIGNhc2UgJ2ZvcndhcmQnOgogICAgICAgICAgICBfdGhpcy5fb25Gb3J3YXJkKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdjcmVhdGUnOgogICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVDcmVhdGUobXNnKTticmVhazsKICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAgIF90aGlzLl9vblJlbW90ZURlbGV0ZShtc2cpO2JyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQoKICAvKioKICAqIFRoZSBvd25lciBvZiB0aGUgU3luY2hlciBhbmQgYWxsIGNyZWF0ZWQgcmVwb3J0ZXJzLgogICogQHR5cGUge0h5cGVydHlVUkx9CiAgKi8KCgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKFN5bmNoZXIsIFt7CiAgICBrZXk6ICdjcmVhdGUnLAoKCiAgICAvKioKICAgICogUmVxdWVzdCBhIERhdGFPYmplY3RSZXBvcnRlciBjcmVhdGlvbi4gVGhlIFVSTCB3aWxsIGJlIGJlIHJlcXVlc3RlZCBieSB0aGUgYWxsb2NhdGlvbiBtZWNoYW5pc20uCiAgICAqIEBwYXJhbSAge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hCiAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIC0gTGlzdCBvZiBoeXBlcnRpZXMgdGhhdCBhcmUgcHJlLWF1dGhvcml6ZWQgZm9yIHN1YnNjcmlwdGlvbgogICAgKiBAcGFyYW0gIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICogQHBhcmFtICB7c3RyaW5nfSBvYmplY3RVUkwgLSByZXVzYWJsZSBkYXRhT2JqZWN0IFVSTAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IFJlcG9ydGVyLiBUaGUgcmVwb3J0ZXIgY2FuIGJlIGFjY2VwdGVkIG9yIHJlamVjdGVkIGJ5IHRoZSBQRVAKICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKHNjaGVtYSwgb2JzZXJ2ZXJzLCBpbml0aWFsRGF0YSkgewogICAgICB2YXIgc3RvcmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgcDJwID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiBmYWxzZTsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBjcml0ZXJpYSA9IHt9OwoKICAgICAgY3JpdGVyaWEucDJwID0gcDJwOwogICAgICBjcml0ZXJpYS5zdG9yZSA9IHN0b3JlOwogICAgICBjcml0ZXJpYS5zY2hlbWEgPSBzY2hlbWE7CiAgICAgIGNyaXRlcmlhLm9ic2VydmVycyA9IG9ic2VydmVyczsKICAgICAgY3JpdGVyaWEuaW5pdGlhbERhdGEgPSBpbml0aWFsRGF0YTsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUgUmVwb3J0ZXIgLSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogZmFsc2UgfSk7CgogICAgICByZXR1cm4gX3RoaXMuX2NyZWF0ZShjcml0ZXJpYSk7CiAgICB9CiAgfSwgewogICAga2V5OiAncmVzdW1lUmVwb3J0ZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVSZXBvcnRlcnMoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBSZXBvcnRlciAtIGNyaXRlcmlhOiAnLCBjcml0ZXJpYSk7CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiB0cnVlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9jcmVhdGUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtTY2hlbWFVUkx9IHNjaGVtYSAtIEh5cGVydHkgQ2F0YWxvZ3VlIFVSTCBhZGRyZXNzIHRoYXQgY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIEpTT04tU2NoZW1hIGRlc2NyaWJpbmcgdGhlIERhdGEgT2JqZWN0IHNjaGVtYQogICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gQWRkcmVzcyBvZiB0aGUgZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIG9ic2VydmVkCiAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3N0b3JlPWZhbHNlXSAtIFNhdmUgdGhlIHN1YnNjcmlwdGlvbiBvbiB0aGUgU3luY2hlciBNYW5hZ2VyIGZvciBmdXJ0aGVyIHJlc3VtZSAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbcDJwPWZhbHNlXSAtIEluZm8gYWJvdXQgaWYgc2hvdWxkIHVzZSBwMnAgY29ubmVjdGlvbiAoRGVmYXVsdCBpcyBmYWxzZSkKICAgICogQHBhcmFtIHtCb29sZWFufSBbbXV0dWFsPXRydWVdIC0gSW5mbyBhYm91dCBpZiBtZXNzYWdlcyBvZiB0aGlzIG9iamVjdCBzaG91bGQgYmUgZW5jcnlwdGVkIChEZWZhdWx0IGlzIHRydWUpCiAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdE9ic2VydmVyPn0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgb2JzZXJ2ZXIuIEl0J3MgYXNzb2NpYXRlZCB3aXRoIHRoZSByZXBvcnRlci4KICAgICovCgogIH0sIHsKICAgIGtleTogJ3N1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3Vic2NyaWJlKHNjaGVtYSwgb2JqVVJMKSB7CiAgICAgIHZhciBzdG9yZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgIHZhciBwMnAgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgbXV0dWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB0cnVlOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGNyaXRlcmlhID0ge307CgogICAgICBjcml0ZXJpYS5wMnAgPSBwMnA7CiAgICAgIGNyaXRlcmlhLnN0b3JlID0gc3RvcmU7CiAgICAgIGNyaXRlcmlhLnNjaGVtYSA9IHNjaGVtYTsKICAgICAgY3JpdGVyaWEucmVzb3VyY2UgPSBvYmpVUkw7CgogICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgIGNyaXRlcmlhLm11dHVhbCA9IG11dHVhbDsKCiAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIHN1YnNjcmliZV0gLSBzdWJzY3JpYmUgY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCiAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShjcml0ZXJpYSwgeyByZXN1bWU6IGZhbHNlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9zdWJzY3JpYmUoY3JpdGVyaWEpOwogICAgfQoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgc3Vic2NyaXB0aW9uIHRvIGFuIGV4aXN0ZW50IHJlcG9ydGVyIG9iamVjdC4KICAgICogQHBhcmFtIHtjcml0ZXJpYX0gY3JpdGVyaWEgLSBJbmZvcm1hdGlvbiB0byBkaXNjb3ZlcnkgdGhlIG9ic2VydmVyIG9iamVjdAogICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXN1bWVPYnNlcnZlcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZU9ic2VydmVycyhjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgX2NyaXRlcmlhID0gY3JpdGVyaWEgfHwge307CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoX2NyaXRlcmlhLCB7IHJlc3VtZTogdHJ1ZSB9KTsKCiAgICAgIHJldHVybiBfdGhpcy5fc3Vic2NyaWJlKF9jcml0ZXJpYSk7CiAgICB9CgogICAgLyoqCiAgICAqIFJlcXVlc3QgYSByZWFkIGFjdGlvbiBvbiB0aGUgcmVwb3J0ZXIgb2JqZWN0CiAgICAqIEBwYXJhbSB7T2JqZWN0VVJMfSBvYmpVUkwgLSBVUkwgb2YgdGhlIHJlcG9ydGVyIG9iamVjdCB0byBiZSByZWFkCiAgICAqIEByZXR1cm4ge1Byb21pc2U8T2JqZWN0Pn0gUmV0dXJuIFByb21pc2UgdG8gbGFzdCBhdmFpbGFibGUgZGF0YSBvZiB0aGUgcmVwb3J0ZXIKICAgICovCgogIH0sIHsKICAgIGtleTogJ3JlYWQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWQob2JqVVJMKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIHJlcG9ydGVyIG9iamVjdCAobWF5YmUgdGhlcmUgaXMgbm8gbGlzdGVuZXIgYXZhaWxhYmxlLCBzbyBpdCB3aWxsIGJlIHJlc29sdmVkIHdpdGggTWVzc2FnZUJ1cyAtPiByZXNvbHZlKQogICAgICAvL3dpbGwgcmVhY2ggdGhlIHJlbW90ZSBvYmplY3QgaW4gRGF0YU9iamVjdFJlcG9ydGVyIC0+IF9vblJlYWQKICAgICAgdmFyIHJlYWRNc2cgPSB7CiAgICAgICAgdHlwZTogJ3JlYWQnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBvYmpVUkwKICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVhZE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygncmVhZC1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIHJlc29sdmUocmVwbHkuYm9keS52YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIGV2ZW50cyBvZiByZW1vdmUgUmVwb3J0ZXIgb2JqZWN0cy4KICAgICogVGhpcyBpcyByZWxlYXRlZCB0byB0aGUgbWVzc2FnZW5zIHNlbnQgYnkgY3JlYXRlIHRvIHRoZSBvYnNlcnZlcnMgSHlwZXJ0eSBhcnJheS4KICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgKi8KCiAgfSwgewogICAga2V5OiAnb25Ob3RpZmljYXRpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uTm90aWZpY2F0aW9uKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ19jcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciByZXN1bWUgPSBjcml0ZXJpYS5yZXN1bWU7CiAgICAgICAgdmFyIGluaXRpYWxEYXRhID0gY3JpdGVyaWEuaW5pdGlhbERhdGEgfHwge307CiAgICAgICAgdmFyIHNjaGVtYSA9IHZvaWQgMDsKCiAgICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKICAgICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keTogeyByZXN1bWU6IHJlc3VtZSB9CiAgICAgICAgfTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXTogJywgY3JpdGVyaWEsIHJlcXVlc3RNc2cpOwoKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUgPSBpbml0aWFsRGF0YTsKICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUucmVwb3J0ZXIgPSBfdGhpcy5fb3duZXI7CgogICAgICAgIGlmIChjcml0ZXJpYS5zY2hlbWEpIHsKICAgICAgICAgIHNjaGVtYSA9IGNyaXRlcmlhLnNjaGVtYTsKICAgICAgICAgIHJlcXVlc3RNc2cuYm9keS5zY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CiAgICAgICAgfQoKICAgICAgICBpZiAoY3JpdGVyaWEucDJwKSByZXF1ZXN0TXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgIGlmIChjcml0ZXJpYS5zdG9yZSkgcmVxdWVzdE1zZy5ib2R5LnN0b3JlID0gY3JpdGVyaWEuc3RvcmU7CiAgICAgICAgaWYgKGNyaXRlcmlhLm9ic2VydmVycykgcmVxdWVzdE1zZy5ib2R5LmF1dGhvcmlzZSA9IGNyaXRlcmlhLm9ic2VydmVyczsKCiAgICAgICAgaWYgKHJlc3VtZSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB9CgogICAgICAgIC8vcmVxdWVzdCBjcmVhdGUgdG8gdGhlIGFsbG9jYXRpb24gc3lzdGVtLiBDYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIFBvbGljeUVuZ2luZS4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXNwb25zZTogJywgcmVwbHkpOwogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gYWNjZXB0ZWQKICAgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgICBpZiAocmVzdW1lKSB7CiAgICAgICAgICAgICAgc2NoZW1hID0gcmVwbHkuYm9keS5zY2hlbWE7CiAgICAgICAgICAgICAgaW5pdGlhbERhdGEgPSByZXBseS5ib2R5LnZhbHVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgc2NoZW1hLCAnb24nLCBpbml0aWFsRGF0YSwgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CiAgICAgICAgICAgIF90aGlzLl9yZXBvcnRlcnNbb2JqVVJMXSA9IG5ld09iajsKCiAgICAgICAgICAgIHJlc29sdmUobmV3T2JqKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gcmVqZWN0ZWQKICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19zdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zdWJzY3JpYmUoY3JpdGVyaWEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkxvY2FsU3Vic2NyaWJlCiAgICAgICAgdmFyIHN1YnNjcmliZU1zZyA9IHsKICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3ViVVJMLAogICAgICAgICAgYm9keToge30KICAgICAgICB9OwoKICAgICAgICAvLyBIeXBlcnR5IHJlcXVlc3QgdG8gYmUgYW4gT2JzZXJ2ZXIKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNoeXBlcnR5LXJlcXVlc3QtdG8tYmUtYW4tb2JzZXJ2ZXIKCiAgICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIHRoZSBzYW1lIEh5cGVydHkgVVJMCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLXRoZS1zYW1lLWh5cGVydHktdXJsCgogICAgICAgIC8vIFJlc3VtZSBTdWJzY3JpcHRpb25zIGZvciBhIGNlcnRhaW4gdXNlciBhbmQgZGF0YSBzY2hlbWEgaW5kZXBlbmRlbnRseSBvZiB0aGUgSHlwZXJ0eSBVUkwuCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLWEtY2VydGFpbi11c2VyLWFuZC1kYXRhLXNjaGVtYS1pbmRlcGVuZGVudGx5LW9mLXRoZS1oeXBlcnR5LXVybAogICAgICAgIGlmIChjcml0ZXJpYSkgewogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdwMnAnKSkgc3Vic2NyaWJlTXNnLmJvZHkucDJwID0gY3JpdGVyaWEucDJwOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzdG9yZScpKSBzdWJzY3JpYmVNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzY2hlbWEnKSkgc3Vic2NyaWJlTXNnLmJvZHkuc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdpZGVudGl0eScpKSBzdWJzY3JpYmVNc2cuYm9keS5pZGVudGl0eSA9IGNyaXRlcmlhLmlkZW50aXR5OwogICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZScpKSBzdWJzY3JpYmVNc2cuYm9keS5yZXNvdXJjZSA9IGNyaXRlcmlhLnJlc291cmNlOwogICAgICAgIH0KCiAgICAgICAgc3Vic2NyaWJlTXNnLmJvZHkucmVzdW1lID0gY3JpdGVyaWEucmVzdW1lOwoKICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgICAgdmFyIG11dHVhbEF1dGhlbnRpY2F0aW9uID0gY3JpdGVyaWEubXV0dWFsOwogICAgICAgIGlmICghbXV0dWFsQXV0aGVudGljYXRpb24pIHN1YnNjcmliZU1zZy5ib2R5Lm11dHVhbEF1dGhlbnRpY2F0aW9uID0gbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUgbWVzc2FnZTogJywgY3JpdGVyaWEsIHN1YnNjcmliZU1zZyk7CgogICAgICAgIC8vcmVxdWVzdCBzdWJzY3JpcHRpb24KICAgICAgICAvL1Byb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICAgICAgICAvL2ZvciBtb3JlIGluZm8gc2VlIHRoZSBEYXRhUHJvdmlzaW9uYWwgY2xhc3MgZG9jdW1lbnRhdGlvbi4KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gc3Vic2NyaWJlLXJlc3BvbnNlOiAnLCByZXBseSk7CgogICAgICAgICAgdmFyIHNjaGVtYSA9IHJlcGx5LmJvZHkuc2NoZW1hOwogICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgogICAgICAgICAgdmFyIG5ld1Byb3Zpc2lvbmFsID0gX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwogICAgICAgICAgZGVsZXRlIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKICAgICAgICAgIGlmIChuZXdQcm92aXNpb25hbCkgbmV3UHJvdmlzaW9uYWwuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlIDwgMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YVByb3Zpc2lvbmFsOiAnLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzLCBvYmpVUkwpOwogICAgICAgICAgICBuZXdQcm92aXNpb25hbCA9IG5ldyBfRGF0YVByb3Zpc2lvbmFsMi5kZWZhdWx0KF90aGlzLl9vd25lciwgb2JqVVJMLCBfdGhpcy5fYnVzLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKICAgICAgICAgICAgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdID0gbmV3UHJvdmlzaW9uYWw7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YSBPYmplY3QgT2JzZXJ2ZXI6ICcsIHJlcGx5LCBfdGhpcy5fcHJvdmlzaW9uYWxzKTsKCiAgICAgICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICAgICAgdmFyIG5ld09iaiA9IG5ldyBfRGF0YU9iamVjdE9ic2VydmVyMi5kZWZhdWx0KF90aGlzLCBvYmpVUkwsIHNjaGVtYSwgJ29uJywgcmVwbHkuYm9keS52YWx1ZSwgbmV3UHJvdmlzaW9uYWwuY2hpbGRyZW4sIHJlcGx5LmJvZHkudmVyc2lvbiwgbXV0dWFsQXV0aGVudGljYXRpb24pOwogICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF0gPSBuZXdPYmo7CgogICAgICAgICAgICByZXNvbHZlKG5ld09iaik7CiAgICAgICAgICAgIG5ld1Byb3Zpc2lvbmFsLmFwcGx5KG5ld09iaik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSBsb2NhbCBydW50aW1lIFJlcG9ydGVyT2JqZWN0IC0+IF9vblJlbW90ZVN1YnNjcmliZQoKICB9LCB7CiAgICBrZXk6ICdfb25Gb3J3YXJkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Gb3J3YXJkKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHJlcG9ydGVyID0gX3RoaXMuX3JlcG9ydGVyc1ttc2cuYm9keS50b107CiAgICAgIHJlcG9ydGVyLl9vbkZvcndhcmQobXNnKTsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBTeW5jaGVyIC0+IGNyZWF0ZSAodGhpcyBpcyBhY3R1YWxseSBhbiBpbnZpdGF0aW9uIHRvIHN1YnNjcmliZSkKCiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlQ3JlYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVDcmVhdGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5mcm9tLnNsaWNlKDAsIC0xMyk7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgZnJvbTogbXNnLmJvZHkuc291cmNlLAogICAgICAgIHVybDogcmVzb3VyY2UsCiAgICAgICAgc2NoZW1hOiBtc2cuYm9keS5zY2hlbWEsCiAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAogICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgYWNrOiBmdW5jdGlvbiBhY2sodHlwZSkgewogICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgbFR5cGUgPSB0eXBlOwogICAgICAgICAgfQoKICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbU3luY2hlcl0gTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gZGVsZXRlCgogIH0sIHsKICAgIGtleTogJ19vblJlbW90ZURlbGV0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVtb3RlRGVsZXRlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9yZW1vdmUgIi9zdWJzY3JpcHRpb24iIGZyb20gdGhlIFVSTAogICAgICB2YXIgcmVzb3VyY2UgPSBtc2cuYm9keS5yZXNvdXJjZTsKCiAgICAgIHZhciBvYmplY3QgPSBfdGhpcy5fb2JzZXJ2ZXJzW3Jlc291cmNlXTsKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIHZhciBldmVudCA9IHsKICAgICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgICAgdXJsOiByZXNvdXJjZSwKICAgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eSwKCiAgICAgICAgICBhY2s6IGZ1bmN0aW9uIGFjayh0eXBlKSB7CiAgICAgICAgICAgIHZhciBsVHlwZSA9IDIwMDsKICAgICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgICBsVHlwZSA9IHR5cGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vVE9ETzogYW55IG90aGVyIGRpZmZlcmVudCBvcHRpb25zIGZvciB0aGUgcmVsZWFzZSBwcm9jZXNzLCBsaWtlIGFjY2VwdCBidXQgbm9yIHJlbGVhc2UgbG9jYWw/CiAgICAgICAgICAgIGlmIChsVHlwZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgb2JqZWN0LmRlbGV0ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL3NlbmQgYWNrIHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgICAgYm9keTogeyBjb2RlOiBsVHlwZSwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBpZiAoX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcikgewogICAgICAgICAgY29uc29sZS5sb2coJ05PVElGSUNBVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgICAgX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcihldmVudCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwNCwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnb3duZXInLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9vd25lcjsKICAgIH0KCiAgICAvKioKICAgICogQWxsIG93bmVkIHJlcG9ydGVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBjcmVhdGUKICAgICogQHR5cGUge09iamVjdDxVUkwsIERhdGFPYmplY3RSZXBvcnRlcj59CiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnRlcnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9yZXBvcnRlcnM7CiAgICB9CgogICAgLyoqCiAgICAqIEFsbCBvd25lZCBvYnNlcnZlcnMsIHRoZSBvbmVzIHRoYXQgd2VyZSBjcmVhdGVkIGJ5IGEgbG9jYWwgc3Vic2NyaXB0aW9uCiAgICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0T2JzZXJ2ZXI+fQogICAgKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZXJzJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fb2JzZXJ2ZXJzOwogICAgfQogIH1dKTsKICByZXR1cm4gU3luY2hlcjsKfSgpOyAvKioKICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICoKICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgKgogICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAqCiAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IFN5bmNoZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEzMSAqLywKLyogMTMyICovLAovKiAxMzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCgovKioKICogQGFjY2VzcyBwcml2YXRlCiAqIFRoaXMgY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIGNvbGxlY3RpbmcgZGVsdGEgY2hhbmdlcyBpbiByZW1vdGUgb2JqZWN0cywgYmVmb3JlIHRoZSByZXNwb25zZSBvZiBzdWJzY3JpcHRpb24gcmVhY2ggdGhlIG9ic2VydmVyLgogKiBJdCdzIHVzZWQgaW4gU3luY2hlciAtPiBzdWJzY3JpYmUuIFRoZSBmbG93IGlzIGRlZmluZWQgYXM6CiAqIDEuIChvYnNlcnZlcikgLS1zdWJzY3JpYmUtLT4gKHJlcG9ydGVyKQogKiAyLiAob2JzZXJ2ZXIpIDwtLWRlbHRhIHVwZGF0ZXMtLSAocmVwb3J0ZXIpCiAqIDMuIChvYnNlcnZlcikgPC0tc3Vic2NyaWJlIHJlc3BvbnNlLS0gKHJlcG9ydGVyKQogKiBUaGlzIG1lYW5zIHRoYXQgdGhlcmUgY291bGQgYmUgZGVsdGEgdXBkYXRlcyB0cmFuc2ZlcnJlZCBiZWZvcmUgdGhlIHN1YnNjcmlwdGlvbiBjb25maXJtYXRpb24uCiAqIFNpbmNlIHRoZXJlIGlzIG5vIERhdGFPYmplY3RPYnNlcnZlciBiZWZvcmUgdGhlIHVic2NyaXB0aW9uIGNvbmZpcm1hdGlvbiwgdGhlcmUgc2hvdWxkIGJlIHNvbWUgb3RoZXIgb2JqZWN0IGNvbGxlY3RpbmcgdGhlIHVwZGF0ZXMuCiAqIFByb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KICovCnZhciBEYXRhUHJvdmlzaW9uYWwgPSBmdW5jdGlvbiAoKSB7CiAgLyogcHJpdmF0ZQogIF9jaGlsZHJlbkxpc3RlbmVyczogW01zZ0xpc3RlbmVyXQogIF9saXN0ZW5lcjogTXNnTGlzdGVuZXIKICAgX2NoYW5nZXM6IFtdCiAgKi8KCiAgZnVuY3Rpb24gRGF0YVByb3Zpc2lvbmFsKG93bmVyLCB1cmwsIGJ1cywgY2hpbGRyZW4pIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFQcm92aXNpb25hbCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKICAgIF90aGlzLl91cmwgPSB1cmw7CiAgICBfdGhpcy5fYnVzID0gYnVzOwogICAgX3RoaXMuX2NoaWxkcmVuID0gY2hpbGRyZW47CgogICAgX3RoaXMuX2NoYW5nZXMgPSBbXTsKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogIH0KCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YVByb3Zpc2lvbmFsLCBbewogICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl91cmwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YVByb3Zpc2lvbmFsLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgX3RoaXMuX2NoYW5nZXMucHVzaChtc2cpOwogICAgICB9KTsKCiAgICAgIC8qCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwogICAgICBpZiAoX3RoaXMuX2NoaWxkcmVuKSB7CiAgICAgICAgbGV0IGNoaWxkQmFzZVVSTCA9IHVybCArICcvY2hpbGRyZW4vJzsKICAgICAgICBfdGhpcy5fY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHsKICAgICAgICAgIGxldCBjaGlsZFVSTCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOwogICAgICAgICAgbGV0IGxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihjaGlsZFVSTCwgKG1zZykgPT4gewogICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCiAgICAgICAgICAgIGlmIChtc2cuZnJvbSAhPT0gb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7CiAgICAgICAgfSk7CiAgICAgIH0qLwogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9saXN0ZW5lci5yZW1vdmUoKTsKCiAgICAgIC8qX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7CiAgICAgICAgbGlzdGVuZXIucmVtb3ZlKCk7CiAgICAgIH0pOyovCiAgICB9CiAgfSwgewogICAga2V5OiAnYXBwbHknLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5KG9ic2VydmVyKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIF90aGlzLl9jaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZSkgewogICAgICAgIG9ic2VydmVyLl9jaGFuZ2VPYmplY3Qob2JzZXJ2ZXIuX3N5bmNPYmosIGNoYW5nZSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ2NoaWxkcmVuJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW47CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhUHJvdmlzaW9uYWw7Cn0oKTsKCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFQcm92aXNpb25hbDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTM0ICovLAovKiAxMzUgKi8sCi8qIDEzNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0MyksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzcgKi8sCi8qIDEzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0NSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAxMzkgKi8sCi8qIDE0MCAqLywKLyogMTQxICovLAovKiAxNDIgKi8sCi8qIDE0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDE0OSk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3QuYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NCAqLywKLyogMTQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTUxKTsKdmFyICRPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7CiAgcmV0dXJuICRPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpOwp9OwoKLyoqKi8gfSksCi8qIDE0NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgovLyAxOS4xLjIuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlLCAuLi4pCnZhciBnZXRLZXlzICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpCiAgLCBnT1BTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTgpCiAgLCBwSUUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCiAgLCB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCBJT2JqZWN0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpCiAgLCAkYXNzaWduICA9IE9iamVjdC5hc3NpZ247CgovLyBzaG91bGQgd29yayB3aXRoIHN5bWJvbHMgYW5kIHNob3VsZCBoYXZlIGRldGVybWluaXN0aWMgcHJvcGVydHkgb3JkZXIgKFY4IGJ1ZykKbW9kdWxlLmV4cG9ydHMgPSAhJGFzc2lnbiB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHZhciBBID0ge30KICAgICwgQiA9IHt9CiAgICAsIFMgPSBTeW1ib2woKQogICAgLCBLID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0JzsKICBBW1NdID0gNzsKICBLLnNwbGl0KCcnKS5mb3JFYWNoKGZ1bmN0aW9uKGspeyBCW2tdID0gazsgfSk7CiAgcmV0dXJuICRhc3NpZ24oe30sIEEpW1NdICE9IDcgfHwgT2JqZWN0LmtleXMoJGFzc2lnbih7fSwgQikpLmpvaW4oJycpICE9IEs7Cn0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycwogIHZhciBUICAgICA9IHRvT2JqZWN0KHRhcmdldCkKICAgICwgYUxlbiAgPSBhcmd1bWVudHMubGVuZ3RoCiAgICAsIGluZGV4ID0gMQogICAgLCBnZXRTeW1ib2xzID0gZ09QUy5mCiAgICAsIGlzRW51bSAgICAgPSBwSUUuZjsKICB3aGlsZShhTGVuID4gaW5kZXgpewogICAgdmFyIFMgICAgICA9IElPYmplY3QoYXJndW1lbnRzW2luZGV4KytdKQogICAgICAsIGtleXMgICA9IGdldFN5bWJvbHMgPyBnZXRLZXlzKFMpLmNvbmNhdChnZXRTeW1ib2xzKFMpKSA6IGdldEtleXMoUykKICAgICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAogICAgICAsIGogICAgICA9IDAKICAgICAgLCBrZXk7CiAgICB3aGlsZShsZW5ndGggPiBqKWlmKGlzRW51bS5jYWxsKFMsIGtleSA9IGtleXNbaisrXSkpVFtrZXldID0gU1trZXldOwogIH0gcmV0dXJuIFQ7Cn0gOiAkYXNzaWduOwoKLyoqKi8gfSksCi8qIDE0NyAqLywKLyogMTQ4ICovLAovKiAxNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4zLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSkKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoKJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYsICdPYmplY3QnLCB7YXNzaWduOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Nil9KTsKCi8qKiovIH0pLAovKiAxNTAgKi8sCi8qIDE1MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApCnZhciB0b0lPYmplY3QgICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KS5mOwoKX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2dldE93blByb3BlcnR5RGVzY3JpcHRvcicsIGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICAgIHJldHVybiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRvSU9iamVjdChpdCksIGtleSk7CiAgfTsKfSk7CgovKioqLyB9KSwKLyogMTUyICovLAovKiAxNTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gICAgIHByb3h5LW9ic2VydmUgdjAuMC4xOAovLyAgICAgQ29weXJpZ2h0IChjKSAyMDE1LCAyMDE2IFNpbW9uIFkuIEJsYWNrd2VsbCwgQW55V2hpY2hXYXkKLy8gICAgIE1JVCBMaWNlbnNlIC0gaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocAooZnVuY3Rpb24oKSB7CgkidXNlIHN0cmljdCI7CgkvLyBDcmVhdGVzIGFuZCByZXR1cm5zIGEgUHJveHkgd3JhcHBpbmcgYSB0YXJnZXQgc28gdGhhdCBhbGwgY2hhbmdlcyBjYW4gYmUgdHJhcHBlZCBhbmQgZm9yd2FyZGVkIHRvCgkvLyBhIGNhbGxiYWNrLiBUaGUgY2FsbGJhY2sgdGFrZXMgYW4gYXJyYXkgb2YgY2hhbmdlcyBqdXN0IGxpa2UgdGhlIHRyYWRpdGlvbmFsIG9yaWdpbmFsIENocm9tZSBPYmplY3Qub2JzZXJ2ZQoJLy8ge29iamVjdDo8b2JqZWN0IGNoYW5nZWQ+LG5hbWU6PGZpZWxkIGNoYW5nZWQ+LHR5cGU6YWRkfHVwZGF0ZXxkZWxldGV8cmVjb25maWd1cmV8cHJldmVudEV4dGVuc2lvbnN8c2V0UHJvdG90eXBlLG9sZFZhbHVlOjxvbGQgdmFsdWUgaWYgdXBkYXRlIHwgZGVsZXRlPn0KCS8vIFRoZSBhY2NlcHRsaXN0IGNhbiBiZSBhZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUuCgkvLyB2IDAuMC4xMCB0byBzdXBwb3J0IHBhdXNpbmcgYW5kIHJlc3RhcnRpbmcgb2JzZXJ2YXRpb24gdHdvIGFkZGl0aW9uYWwgY29uc3RydWN0b3IgYXJndW1lbnRzIGFyZSBhdmFpbGFibGUgdG8gT2JqZWN0Lm9ic2VydmU6CgkvLyBwYXVzYWJsZSAtIGNyZWF0ZSB0aGUgT2JzZXJ2ZXIgc28gaXQgY2FuIGJlIHBhdXNlZAoJLy8gcGF1c2UgLSBjcmVhdGUgb2JzZXJ2ZXIgaW4gcGF1c2VkIHN0YXRlCgkvLyBpZiBwYXVzYWJsZSBpcyB0cnVlIHRoZW4gYW4gYWRkaXRpb25hbCBtZXRob2QgZGVsaXZlcihpZ25vcmVQcmV2aW91cykgaXMgYXZhaWxhYmxlIHRvIHN0YXJ0IGRlbGl2ZXJ5CgkvLyB0byBwYXVzZSBkZWxpdmVyeSBzZXQgYSBwcm9wZXJ0eSBjYWxsZWQgcGF1c2Ugb24gdGhlIGZ1bmN0aW9uIGRlbGl2ZXIgdG8gdHJ1ZQoJLy8gcGF1c2FibGUgaXMgb3B0aW9uYWwgdG8gcmVkdWNlIHRoZSBjaGFuY2Ugb2Ygc2hhZG93aW5nIGEgcHJvcGVydHkgb3IgbWV0aG9kIG9uIGFueSBleGlzdGluZyBjb2RlIGNhbGxlZCBkZWxpdmVyCglpZighT2JqZWN0Lm9ic2VydmUgJiYgdHlwZW9mKFByb3h5KT09PSJmdW5jdGlvbiIpIHsKCQlmdW5jdGlvbiBPYnNlcnZlcih0YXJnZXQsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgewoJICAgIAl2YXIgbWUgPSB0aGlzLCBwcm94eTsKCSAgICAJZnVuY3Rpb24gZGVsaXZlcihpZ25vcmVQcmV2aW91cyxkZWxheSkgewoJICAgIAkJZGVsaXZlci5kZWxheSA9IGRlbGF5OwoJICAgIAkJaWYoIWRlbGl2ZXIucGF1c2UpIHsKCSAgICAgICAgCQlpZihtZS5jaGFuZ2VzZXQubGVuZ3RoPjApIHsKCSAgICAgICAgCQkJaWYoIWlnbm9yZVByZXZpb3VzKSB7CgkJICAgIAkgICAgCQl2YXIgY2hhbmdlcyA9IG1lLmNoYW5nZXNldC5maWx0ZXIoZnVuY3Rpb24oY2hhbmdlKSB7IHJldHVybiAhYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wOyB9KTsKCQkgICAgICAgIAkJCWlmKGNoYW5nZXMubGVuZ3RoPjApIHsKCQkgICAgICAgIAkJCQljYWxsYmFjayhjaGFuZ2VzKTsKCQkgICAgICAgIAkJCX0KCSAgICAgICAgCQkJfQoJICAgICAgICAJCQltZS5jaGFuZ2VzZXQgPSBbXTsKCSAgICAgICAgCQl9CgkgICAgCQl9CgkgICAgCX0KCSAgICAJZGVsaXZlci5wYXVzZSA9IHBhdXNlOwoJICAgIAlkZWxpdmVyLmRlbGF5ID0gZGVsYXk7CgkJICAgIG1lLmdldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCQkgICAgCWlmKHByb3BlcnR5PT09Il9fb2JzZXJ2ZXJfXyIpIHsKCQkgICAgCQlyZXR1cm4gbWU7CgkJICAgIAl9CgkJICAgIAlpZihwcm9wZXJ0eT09PSJ1bm9ic2VydmUiKSB7CgkJICAgIAkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCSAgICAJCQlPYmplY3QudW5vYnNlcnZlKHRhcmdldCk7CgkJICAgIAkJCXJldHVybiB0YXJnZXQ7CgkJICAgIAkJfTsKCQkgICAgCX0KCQkgICAgCWlmKHByb3BlcnR5PT09ImRlbGl2ZXIiKSB7CgkJICAgIAkJcmV0dXJuIGRlbGl2ZXI7CgkJICAgIAl9CgkJICAgIAlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCQkgICAgfQoJICAgIAltZS50YXJnZXQgPSB0YXJnZXQ7CgkgICAgCW1lLmNoYW5nZXNldCA9IFtdOwoJICAgIAlpZighbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXykgewoJICAgIAkJLy8gX19vYnNlcnZlckNhbGxiYWNrc19fIGlzIHVzZWQgYXMgYW4gaW5kZXggdG8gZ2V0IGF0IHRoZSBwcm94eSB3aGljaCBpcyB0aGUgb2JzZXJ2ZXIsIHNvIHdlIGNhbiB1bm9ic2VydmUKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJDYWxsYmFja3NfXyIse2VudW1lcmFibGU6ZmFsc2UsY29uZmlndXJhYmxlOnRydWUsd3JpdGFibGU6ZmFsc2UsdmFsdWU6W119KTsKCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJzX18iLHtlbnVtZXJhYmxlOmZhbHNlLGNvbmZpZ3VyYWJsZTp0cnVlLHdyaXRhYmxlOmZhbHNlLHZhbHVlOltdfSk7CgkgICAgCX0KCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5wdXNoKGNhbGxiYWNrKTsKCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJzX18ucHVzaCh0aGlzKTsKCSAgICAJcHJveHkgPSBuZXcgUHJveHkodGFyZ2V0LG1lKTsKCSAgICAJZGVsaXZlcihmYWxzZSxkZWxheSk7CgkgICAgCXJldHVybiBwcm94eTsKCSAgICB9CgkJT2JzZXJ2ZXIucHJvdG90eXBlLmRlbGl2ZXIgPSBmdW5jdGlvbigpIHsKCQkJcmV0dXJuIHRoaXMuZ2V0KG51bGwsImRlbGl2ZXIiKTsKCQl9CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIHZhbHVlKSB7IC8vICwgcmVjZWl2ZXIKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJdmFyIHR5cGUgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKTsKCSAgICAJdGFyZ2V0W3Byb3BlcnR5XSA9IHZhbHVlOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICghdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKHR5cGUpPj0wKSkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZTp0eXBlfSwKCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAgICAgCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAlpZih0eXBlPT09InVwZGF0ZSIpIHsKCSAgICAgICAgCQljaGFuZ2Uub2xkVmFsdWUgPSBvbGR2YWx1ZTsKCSAgICAgICAgCX0KCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWxldGVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsKCSAgICAJdmFyIG9sZHZhbHVlID0gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJLy9pZih0eXBlb2Yob2xkdmFsdWUpIT09InVuZGVmaW5lZCIpIHsKCQkgICAgCWRlbGV0ZSB0YXJnZXRbcHJvcGVydHldOwoJCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJkZWxldGUiKT49MCkgewoJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6ImRlbGV0ZSIsb2xkVmFsdWU6b2xkdmFsdWV9LAoJCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCQkgICAgICAgIAkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCQkgICAgICAgIAlpZihzdGFydCkgewoJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJCSAgICAgICAgCX0KCQkgICAgCX0KCSAgICAJLy99CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcikgewoJICAgIAlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcik7CgkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigicmVjb25maWd1cmUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZToicmVjb25maWd1cmUifSwKICAgICAgICAJCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKICAgICAgICAJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7CgkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7CgkgICAgICAgIAlpZihzdGFydCkgewoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7CgkgICAgICAgIAl9CgkgICAgCX0KCSAgICAJcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBPYnNlcnZlci5wcm90b3R5cGUuc2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbih0YXJnZXQsIHByb3RvdHlwZSkgewoJICAgIAl2YXIgb2xkdmFsdWUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KTsKCSAgICAJT2JqZWN0LnNldFByb3RvdHlwZU9mKHRhcmdldCwgcHJvdG90eXBlKTsKCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJzZXRQcm90b3R5cGUiKT49MCkgewoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6Il9fcHJvdG9fXyIsdHlwZToic2V0UHJvdG90eXBlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sCiAgICAJCQkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsCiAgICAJCQkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOwoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgICAgICAJaWYoc3RhcnQpIHsKCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgICAgICAJfQoJICAgIAl9CgkgICAgCXJldHVybiB0cnVlOwoJICAgIH07CgkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnByZXZlbnRFeHRlbnNpb25zID0gZnVuY3Rpb24odGFyZ2V0KSB7CgkgICAgICAgIE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh0YXJnZXQpOwoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInByZXZlbnRFeHRlbnNpb25zIik+PTApIHsKCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCx0eXBlOiJwcmV2ZW50RXh0ZW5zaW9ucyJ9LAoJCQkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLAoJCQkJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsKCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsKCSAgICAgICAgCWlmKHN0YXJ0KSB7CgkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsKCSAgICAgICAgCX0KCSAgICAJfQoJICAgIAlyZXR1cm4gdHJ1ZTsKCSAgICB9OwoJICAgIE9iamVjdC5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJcmV0dXJuIG5ldyBPYnNlcnZlcihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSk7CgkgICAgfTsKCSAgICBPYmplY3QudW5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrKSB7CgkgICAgCWlmKG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsKCSAgICAJCWlmKCFjYWxsYmFjaykgewoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uc3BsaWNlKDAsb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5sZW5ndGgpOwoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZSgwLG9iamVjdC5fX29ic2VydmVyc19fLmxlbmd0aCk7CgkgICAgCQkJcmV0dXJuOwoJICAgIAkJfQoJICAgIAkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5mb3JFYWNoKGZ1bmN0aW9uKG9ic2VydmVyY2FsbGJhY2ssaSkgewoJICAgIAkJCWlmKGNhbGxiYWNrPT09b2JzZXJ2ZXJjYWxsYmFjaykgewoJICAgIAkJCQlvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLnNwbGljZShpLDEpOwoJICAgIAkJCQlkZWxldGUgb2JqZWN0Ll9fb2JzZXJ2ZXJzX19baV0uY2FsbGJhY2s7CgkgICAgCQkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZShpLDEpOwoJICAgIAkJCX0KCSAgICAJCX0pOwoJICAgIAl9CgkgICAgfTsKCSAgICBBcnJheS5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsKCSAgICAJaWYoIShvYmplY3QgaW5zdGFuY2VvZiBBcnJheSkgJiYgIUFycmF5LmlzQXJyYXkob2JqZWN0KSkgewoJICAgIAkJdGhyb3cgbmV3IFR5cGVFcnJvcigiRmlyc3QgYXJndW1lbnQgdG8gQXJyYXkub2JzZXJ2ZXIgaXMgbm90IGFuIEFycmF5Iik7CgkgICAgCX0KICAgICAgICAgICAgCWFjY2VwdGxpc3QgPSBhY2NlcHRsaXN0IHx8IFsiYWRkIiwgInVwZGF0ZSIsICJkZWxldGUiLCAic3BsaWNlIl07CgkgICAgCXZhciBhcnJheXByb3h5ID0gbmV3IFByb3h5KG9iamVjdCx7Z2V0OiBmdW5jdGlvbih0YXJnZXQscHJvcGVydHkpIHsKCSAgICAJCWlmKHByb3BlcnR5PT09InVub2JzZXJ2ZSIpIHsKCQkgICAgCQlyZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2spIHsKCQkgICAgCQkJaWYoY2FsbGJhY2spIHsKCQkgICAgCQkJCXJldHVybiBPYmplY3QudW5vYnNlcnZlKHRhcmdldCxjYWxsYmFjayk7CgkJICAgIAkJCX0KCQkgICAgCQkJcmV0dXJuIHRhcmdldC51bm9ic2VydmUoKTsKCQkgICAgCQl9OwoJCSAgICAJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic3BsaWNlIikgewoJICAgIAkJCXJldHVybiBmdW5jdGlvbihzdGFydCxlbmQpIHsKCSAgICAJCQkJaWYodHlwZW9mKHN0YXJ0KSE9PSJudW1iZXIiIHx8IHR5cGVvZihlbmQpIT09Im51bWJlciIpIHsKCSAgICAJCQkJCXRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IHR3byBhcmd1bWVudHMgdG8gQXJyYXkgc3BsaWNlIGFyZSBub3QgbnVtYmVyLCBudW1iZXIiKTsKCSAgICAJCQkJfQoJICAgIAkgICAgCQl2YXIgcmVtb3ZlZCA9IHRoaXMuc2xpY2Uoc3RhcnQsc3RhcnQrZW5kKSwKCSAgICAJICAgIAkJCWFkZGVkQ291bnQgPSAoYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHMubGVuZ3RoLTIgOiAwKSwKCSAgICAJICAgIAkJCWNoYW5nZSA9ICB7b2JqZWN0Om9iamVjdCx0eXBlOiJzcGxpY2UiLGluZGV4OnN0YXJ0LHJlbW92ZWQ6cmVtb3ZlZCxhZGRlZENvdW50OmFkZGVkQ291bnR9OwoJICAgIAkgICAgCQl0YXJnZXQuc3BsaWNlLmFwcGx5KHRhcmdldCxhcmd1bWVudHMpOwoJICAgIAkgICAgCQlpZihhY2NlcHRsaXN0LmluZGV4T2YoInNwbGljZSIpPj0wKSB7CgkgICAgCSAgICAJCQl2YXIgc3RhcnQgPSBwcm94eS5fX29ic2VydmVyX18uY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwKCSAgICAJICAgICAgICAJCQlkZWxpdmVyID0gcHJveHkuX19vYnNlcnZlcl9fLmRlbGl2ZXIoKTsKCSAgICAJICAgIAkJCXByb3h5Ll9fb2JzZXJ2ZXJfXy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOwoJICAgIAkgICAgCQkJaWYoc3RhcnQpIHsKCSAgICAJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOwoJICAgIAkJICAgICAgICAJfQoJICAgIAkgICAgCQl9CgkgICAgCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icHVzaCIpIHsKCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHsKCSAgICAJCSAgICAJcmV0dXJuIHRoaXMuc3BsaWNlKHRoaXMubGVuZ3RoLDAsaXRlbSk7CgkgICAgCQkgICAgfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0icG9wIikgewoJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oKSB7CgkgICAgCQkgICAgCXJldHVybiB0aGlzLnNwbGljZSh0aGlzLmxlbmd0aC0xLDEpOwoJICAgIAkJICAgIH0KCSAgICAJCX0KCSAgICAJCWlmKHByb3BlcnR5PT09InVuc2hpZnQiKSB7CgkgICAgCQkJIHJldHVybiBmdW5jdGlvbihpdGVtKSB7CiAgICAJCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDAsaXRlbSk7CiAgICAJCSAgICAJfQoJICAgIAkJfQoJICAgIAkJaWYocHJvcGVydHk9PT0ic2hpZnQiKSB7CgkgICAgCQkJcmV0dXJuIGZ1bmN0aW9uKCkgewoJICAgIAkgICAgCQlyZXR1cm4gdGhpcy5zcGxpY2UoMCwxKTsKCSAgICAJICAgIAl9CgkgICAgCQl9CgkgICAgCQlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsKCSAgICAJfX0pOwoJICAgIAl2YXIgcHJveHkgPSBPYmplY3Qub2JzZXJ2ZShhcnJheXByb3h5LGZ1bmN0aW9uKGNoYW5nZXNldCkgeyAKCSAgICAJCXZhciBjaGFuZ2VzID0gY2hhbmdlc2V0LmZpbHRlcihmdW5jdGlvbihjaGFuZ2UpIHsgcmV0dXJuIGNoYW5nZS5uYW1lIT09Imxlbmd0aCIgJiYgY2hhbmdlLm5hbWUhPT0iYWRkIiAmJiAoIWFjY2VwdGxpc3QgfHwgYWNjZXB0bGlzdC5pbmRleE9mKGNoYW5nZS50eXBlKT49MCk7IH0pOwoJICAgIAkJaWYoY2hhbmdlcy5sZW5ndGg+MCkgewoJICAgIAkJCWNhbGxiYWNrKGNoYW5nZXMpOwoJICAgIAkJfQoJICAgIAl9LGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpOwoJICAgIAlyZXR1cm4gcHJveHk7CgkgICAgfTsKCSAgICBBcnJheS51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsKCQkgIHJldHVybiBvYmplY3QudW5vYnNlcnZlKGNhbGxiYWNrKTsKCSAgICB9Cgl9CglPYmplY3QuZGVlcE9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2sscGFydHMpIHsKCgkJcGFydHMgPSAocGFydHMgPyBwYXJ0cyA6IFtdKTsKCgkJdmFyIHRvVHlwZU5hbWUgPSBmdW5jdGlvbihvYmopIHsKCQkJcmV0dXJuICh7fSkudG9TdHJpbmcuY2FsbChvYmopLm1hdGNoKC9ccyhbYS16QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKQoJCX0KCgkJZnVuY3Rpb24gcmVvYnNlcnZlKHZhbHVlLCBwYXJ0cykgewoJCQl2YXIga2V5cyA9IE9iamVjdC5rZXlzKHZhbHVlKTsKCQkJa2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJaWYoKHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdvYmplY3QnIHx8IHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdhcnJheScpICYmICF2YWx1ZVtrZXldLmhhc093blByb3BlcnR5KCdfX29ic2VydmVyc19fJykpIHsKCQkJCQl2YXIgbmV3cGFydHMgPSBwYXJ0cy5zbGljZSgwKTsKCQkJCQluZXdwYXJ0cy5wdXNoKGtleSk7CgkJCQkJdmFsdWVba2V5XSA9IE9iamVjdC5kZWVwT2JzZXJ2ZSh2YWx1ZVtrZXldLGNhbGxiYWNrLG5ld3BhcnRzKTsKCQkJCX0KCQkJfSk7CgkJfQoKCQlyZW9ic2VydmUob2JqZWN0LCBwYXJ0cyk7CgoJCXZhciBvYnNlcnZlZCA9IE9iamVjdC5vYnNlcnZlKG9iamVjdCxmdW5jdGlvbihjaGFuZ2VzZXQpIHsKCQkJdmFyIGNoYW5nZXMgPSBbXTsKCQkJZnVuY3Rpb24gcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkT2JqZWN0LG5ld09iamVjdCxwYXRoKSB7CgkJCQlpZihuZXdPYmplY3QgaW5zdGFuY2VvZiBPYmplY3QpIHsKCQkJCQl2YXIgbmV3a2V5cyA9IE9iamVjdC5rZXlzKG5ld09iamVjdCk7CgkJCQkJbmV3a2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewoJCQkJCQlpZighb2xkT2JqZWN0IHx8IChvbGRPYmplY3Rba2V5XSE9PW5ld09iamVjdFtrZXldKSkgewoJCQkJCQkJdmFyIG9sZHZhbHVlID0gKG9sZE9iamVjdCAmJiBvbGRPYmplY3Rba2V5XSE9PXVuZGVmaW5lZCA/IG9sZE9iamVjdFtrZXldIDogdW5kZWZpbmVkKSwKCQkJCQkJCQljaGFuZ2UgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKSwKCQkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCgkJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGR2YWx1ZSxuZXdWYWx1ZTpuZXdPYmplY3Rba2V5XSxrZXlwYXRoOmtleXBhdGh9KTsKCQkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZHZhbHVlLG5ld09iamVjdFtrZXldLGtleXBhdGgpOwoJCQkJCQl9CgkJCQkJfSk7CgkJCQl9IGVsc2UgaWYob2xkT2JqZWN0IGluc3RhbmNlb2YgT2JqZWN0KSB7CgkJCQkJdmFyIG9sZGtleXMgPSBPYmplY3Qua2V5cyhvbGRPYmplY3QpOwoJCQkJCW9sZGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsKCQkJCQkJdmFyIGNoYW5nZSA9IChuZXdPYmplY3Q9PT1udWxsID8gInVwZGF0ZSIgOiAiZGVsZXRlIiksCgkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsKCQkJCQkJCQoJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGRPYmplY3Rba2V5XSxuZXdWYWx1ZTpuZXdPYmplY3Qsa2V5cGF0aDprZXlwYXRofSk7CgkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZE9iamVjdFtrZXldLHVuZGVmaW5lZCxrZXlwYXRoKTsKCQkJCQl9KTsKCQkJCX0KCQkJfQoJCQljaGFuZ2VzZXQuZm9yRWFjaChmdW5jdGlvbihjaGFuZ2UpIHsKCQkJCXZhciBrZXlwYXRoID0gKHBhcnRzLmxlbmd0aD4wID8gcGFydHMuam9pbigiLiIpICsgIi4iIDogIiIpICsgY2hhbmdlLm5hbWU7CgoJCQkJaWYgKGNoYW5nZS50eXBlID09PSAidXBkYXRlIiB8fCBjaGFuZ2UudHlwZSA9PT0gImFkZCIpIHsgCgkJCQkJcmVvYnNlcnZlKGNoYW5nZS5vYmplY3QsIHBhcnRzKTsKCQkJCX0KCgkJCQljaGFuZ2VzLnB1c2goe25hbWU6Y2hhbmdlLm5hbWUsb2JqZWN0OmNoYW5nZS5vYmplY3QsdHlwZTpjaGFuZ2UudHlwZSxvbGRWYWx1ZTpjaGFuZ2Uub2xkVmFsdWUsbmV3VmFsdWU6Y2hhbmdlLm9iamVjdFtjaGFuZ2UubmFtZV0sa2V5cGF0aDprZXlwYXRofSk7CgkJCQlyZWN1cnNlKGNoYW5nZS5uYW1lLGNoYW5nZS5vYmplY3QsY2hhbmdlLm9sZFZhbHVlLGNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGgpOwoJCQl9KTsKCQkJY2FsbGJhY2soY2hhbmdlcyk7CgkJfSk7CgkJcmV0dXJuIG9ic2VydmVkOwoJfTsKfSkoKTsKCgovKioqLyB9KSwKLyogMTU0ICovLAovKiAxNTUgKi8sCi8qIDE1NiAqLywKLyogMTU3ICovLAovKiAxNTggKi8sCi8qIDE1OSAqLywKLyogMTYwICovLAovKiAxNjEgKi8sCi8qIDE2MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkRhdGFPYmplY3RPYnNlcnZlciA9IGV4cG9ydHMuRGF0YU9iamVjdFJlcG9ydGVyID0gZXhwb3J0cy5TeW5jaGVyID0gdW5kZWZpbmVkOwoKdmFyIF9TeW5jaGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzApOwoKdmFyIF9TeW5jaGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1N5bmNoZXIpOwoKdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOSk7Cgp2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7Cgp2YXIgX0RhdGFPYmplY3RPYnNlcnZlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCmV4cG9ydHMuU3luY2hlciA9IF9TeW5jaGVyMi5kZWZhdWx0OwpleHBvcnRzLkRhdGFPYmplY3RSZXBvcnRlciA9IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQ7CmV4cG9ydHMuRGF0YU9iamVjdE9ic2VydmVyID0gX0RhdGFPYmplY3RPYnNlcnZlcjIuZGVmYXVsdDsKCi8qKiovIH0pCi8qKioqKiovIF0pOwp9KTsKCn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwoKJ3VzZSBzdHJpY3QnOwoKLy8gU2hpbW1pbmcgc3RhcnRzIGhlcmUuCihmdW5jdGlvbigpIHsKICAvLyBVdGlscy4KICB2YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7CiAgdmFyIGxvZ2dpbmcgPSB1dGlscy5sb2c7CiAgdmFyIGJyb3dzZXJEZXRhaWxzID0gdXRpbHMuYnJvd3NlckRldGFpbHM7CiAgLy8gRXhwb3J0IHRvIHRoZSBhZGFwdGVyIGdsb2JhbCBvYmplY3QgdmlzaWJsZSBpbiB0aGUgYnJvd3Nlci4KICBtb2R1bGUuZXhwb3J0cy5icm93c2VyRGV0YWlscyA9IGJyb3dzZXJEZXRhaWxzOwogIG1vZHVsZS5leHBvcnRzLmV4dHJhY3RWZXJzaW9uID0gdXRpbHMuZXh0cmFjdFZlcnNpb247CiAgbW9kdWxlLmV4cG9ydHMuZGlzYWJsZUxvZyA9IHV0aWxzLmRpc2FibGVMb2c7CgogIC8vIFVuY29tbWVudCB0aGUgbGluZSBiZWxvdyBpZiB5b3Ugd2FudCBsb2dnaW5nIHRvIG9jY3VyLCBpbmNsdWRpbmcgbG9nZ2luZwogIC8vIGZvciB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdy4gQ2FuIGFsc28gYmUgdHVybmVkIG9uIGluIHRoZSBicm93c2VyIHZpYQogIC8vIGFkYXB0ZXIuZGlzYWJsZUxvZyhmYWxzZSksIGJ1dCB0aGVuIGxvZ2dpbmcgZnJvbSB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvdwogIC8vIHdpbGwgbm90IGFwcGVhci4KICAvLyByZXF1aXJlKCcuL3V0aWxzJykuZGlzYWJsZUxvZyhmYWxzZSk7CgogIC8vIEJyb3dzZXIgc2hpbXMuCiAgdmFyIGNocm9tZVNoaW0gPSByZXF1aXJlKCcuL2Nocm9tZS9jaHJvbWVfc2hpbScpIHx8IG51bGw7CiAgdmFyIGVkZ2VTaGltID0gcmVxdWlyZSgnLi9lZGdlL2VkZ2Vfc2hpbScpIHx8IG51bGw7CiAgdmFyIGZpcmVmb3hTaGltID0gcmVxdWlyZSgnLi9maXJlZm94L2ZpcmVmb3hfc2hpbScpIHx8IG51bGw7CiAgdmFyIHNhZmFyaVNoaW0gPSByZXF1aXJlKCcuL3NhZmFyaS9zYWZhcmlfc2hpbScpIHx8IG51bGw7CgogIC8vIFNoaW0gYnJvd3NlciBpZiBmb3VuZC4KICBzd2l0Y2ggKGJyb3dzZXJEZXRhaWxzLmJyb3dzZXIpIHsKICAgIGNhc2UgJ2Nocm9tZSc6CiAgICAgIGlmICghY2hyb21lU2hpbSB8fCAhY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdDaHJvbWUgc2hpbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhpcyBhZGFwdGVyIHJlbGVhc2UuJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGxvZ2dpbmcoJ2FkYXB0ZXIuanMgc2hpbW1pbmcgY2hyb21lLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGNocm9tZVNoaW07CgogICAgICBjaHJvbWVTaGltLnNoaW1HZXRVc2VyTWVkaWEoKTsKICAgICAgY2hyb21lU2hpbS5zaGltTWVkaWFTdHJlYW0oKTsKICAgICAgdXRpbHMuc2hpbUNyZWF0ZU9iamVjdFVSTCgpOwogICAgICBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QoKTsKICAgICAgY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgY2hyb21lU2hpbS5zaGltT25UcmFjaygpOwogICAgICBicmVhazsKICAgIGNhc2UgJ2ZpcmVmb3gnOgogICAgICBpZiAoIWZpcmVmb3hTaGltIHx8ICFmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24pIHsKICAgICAgICBsb2dnaW5nKCdGaXJlZm94IHNoaW0gaXMgbm90IGluY2x1ZGVkIGluIHRoaXMgYWRhcHRlciByZWxlYXNlLicpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBsb2dnaW5nKCdhZGFwdGVyLmpzIHNoaW1taW5nIGZpcmVmb3guJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gZmlyZWZveFNoaW07CgogICAgICBmaXJlZm94U2hpbS5zaGltR2V0VXNlck1lZGlhKCk7CiAgICAgIHV0aWxzLnNoaW1DcmVhdGVPYmplY3RVUkwoKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbVNvdXJjZU9iamVjdCgpOwogICAgICBmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24oKTsKICAgICAgZmlyZWZveFNoaW0uc2hpbU9uVHJhY2soKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdlZGdlJzoKICAgICAgaWYgKCFlZGdlU2hpbSB8fCAhZWRnZVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uKSB7CiAgICAgICAgbG9nZ2luZygnTVMgZWRnZSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBlZGdlLicpOwogICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLgogICAgICBtb2R1bGUuZXhwb3J0cy5icm93c2VyU2hpbSA9IGVkZ2VTaGltOwoKICAgICAgZWRnZVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMKCk7CiAgICAgIGVkZ2VTaGltLnNoaW1QZWVyQ29ubmVjdGlvbigpOwogICAgICBicmVhazsKICAgIGNhc2UgJ3NhZmFyaSc6CiAgICAgIGlmICghc2FmYXJpU2hpbSkgewogICAgICAgIGxvZ2dpbmcoJ1NhZmFyaSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBzYWZhcmkuJyk7CiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuCiAgICAgIG1vZHVsZS5leHBvcnRzLmJyb3dzZXJTaGltID0gc2FmYXJpU2hpbTsKCiAgICAgIHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYSgpOwogICAgICBicmVhazsKICAgIGRlZmF1bHQ6CiAgICAgIGxvZ2dpbmcoJ1Vuc3VwcG9ydGVkIGJyb3dzZXIhJyk7CiAgfQp9KSgpOwoKfSx7Ii4vY2hyb21lL2Nocm9tZV9zaGltIjo0LCIuL2VkZ2UvZWRnZV9zaGltIjo2LCIuL2ZpcmVmb3gvZmlyZWZveF9zaGltIjo4LCIuL3NhZmFyaS9zYWZhcmlfc2hpbSI6MTAsIi4vdXRpbHMiOjExfV0sNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CgovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzLmpzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgY2hyb21lU2hpbSA9IHsKICBzaGltTWVkaWFTdHJlYW06IGZ1bmN0aW9uKCkgewogICAgd2luZG93Lk1lZGlhU3RyZWFtID0gd2luZG93Lk1lZGlhU3RyZWFtIHx8IHdpbmRvdy53ZWJraXRNZWRpYVN0cmVhbTsKICB9LAoKICBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmICEoJ29udHJhY2snIGluCiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUsICdvbnRyYWNrJywgewogICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5fb250cmFjazsKICAgICAgICB9LAogICAgICAgIHNldDogZnVuY3Rpb24oZikgewogICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgaWYgKHRoaXMuX29udHJhY2spIHsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFjaycsIHRoaXMuX29udHJhY2spOwogICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5KTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrID0gZik7CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5ID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAvLyBvbmFkZHN0cmVhbSBkb2VzIG5vdCBmaXJlIHdoZW4gYSB0cmFjayBpcyBhZGRlZCB0byBhbiBleGlzdGluZwogICAgICAgICAgICAvLyBzdHJlYW0uIEJ1dCBzdHJlYW0ub25hZGR0cmFjayBpcyBpbXBsZW1lbnRlZCBzbyB3ZSB1c2UgdGhhdC4KICAgICAgICAgICAgZS5zdHJlYW0uYWRkRXZlbnRMaXN0ZW5lcignYWRkdHJhY2snLCBmdW5jdGlvbih0ZSkgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRlLnRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0ZS50cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGUuc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHsKICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ3RyYWNrJyk7CiAgICAgICAgICAgICAgZXZlbnQudHJhY2sgPSB0cmFjazsKICAgICAgICAgICAgICBldmVudC5yZWNlaXZlciA9IHt0cmFjazogdHJhY2t9OwogICAgICAgICAgICAgIGV2ZW50LnN0cmVhbXMgPSBbZS5zdHJlYW1dOwogICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgICB9LmJpbmQodGhpcykpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKCiAgc2hpbVNvdXJjZU9iamVjdDogZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHsKICAgICAgaWYgKHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50ICYmCiAgICAgICAgISgnc3JjT2JqZWN0JyBpbiB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUpKSB7CiAgICAgICAgLy8gU2hpbSB0aGUgc3JjT2JqZWN0IHByb3BlcnR5LCBvbmNlLCB3aGVuIEhUTUxNZWRpYUVsZW1lbnQgaXMgZm91bmQuCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyY09iamVjdCcsIHsKICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zcmNPYmplY3Q7CiAgICAgICAgICB9LAogICAgICAgICAgc2V0OiBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgICAvLyBVc2UgX3NyY09iamVjdCBhcyBhIHByaXZhdGUgcHJvcGVydHkgZm9yIHRoaXMgc2hpbQogICAgICAgICAgICB0aGlzLl9zcmNPYmplY3QgPSBzdHJlYW07CiAgICAgICAgICAgIGlmICh0aGlzLnNyYykgewogICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5zcmMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIXN0cmVhbSkgewogICAgICAgICAgICAgIHRoaXMuc3JjID0gJyc7CiAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTsKICAgICAgICAgICAgLy8gV2UgbmVlZCB0byByZWNyZWF0ZSB0aGUgYmxvYiB1cmwgd2hlbiBhIHRyYWNrIGlzIGFkZGVkIG9yCiAgICAgICAgICAgIC8vIHJlbW92ZWQuIERvaW5nIGl0IG1hbnVhbGx5IHNpbmNlIHdlIHdhbnQgdG8gYXZvaWQgYSByZWN1cnNpb24uCiAgICAgICAgICAgIHN0cmVhbS5hZGRFdmVudExpc3RlbmVyKCdhZGR0cmFjaycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIGlmIChzZWxmLnNyYykgewogICAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChzZWxmLnNyYyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHNlbGYuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc3RyZWFtLmFkZEV2ZW50TGlzdGVuZXIoJ3JlbW92ZXRyYWNrJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgaWYgKHNlbGYuc3JjKSB7CiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHNlbGYuc3JjKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgc2VsZi5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIC8vIFRoZSBSVENQZWVyQ29ubmVjdGlvbiBvYmplY3QuCiAgICBpZiAoIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikgewogICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gPSBmdW5jdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cykgewogICAgICAgIC8vIFRyYW5zbGF0ZSBpY2VUcmFuc3BvcnRQb2xpY3kgdG8gaWNlVHJhbnNwb3J0cywKICAgICAgICAvLyBzZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD00ODY5CiAgICAgICAgLy8gdGhpcyB3YXMgZml4ZWQgaW4gTTU2IGFsb25nIHdpdGggdW5wcmVmaXhpbmcgUlRDUGVlckNvbm5lY3Rpb24uCiAgICAgICAgbG9nZ2luZygnUGVlckNvbm5lY3Rpb24nKTsKICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5KSB7CiAgICAgICAgICBwY0NvbmZpZy5pY2VUcmFuc3BvcnRzID0gcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSB3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CiAgICAgIC8vIHdyYXAgc3RhdGljIG1ldGhvZHMuIEN1cnJlbnRseSBqdXN0IGdlbmVyYXRlQ2VydGlmaWNhdGUuCiAgICAgIGlmICh3ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5nZW5lcmF0ZUNlcnRpZmljYXRlKSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiwgJ2dlbmVyYXRlQ2VydGlmaWNhdGUnLCB7CiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gd2Via2l0UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIHZhciBvcmlnR2V0U3RhdHMgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHM7CiAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbihzZWxlY3RvciwKICAgICAgICBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgYXJncyA9IGFyZ3VtZW50czsKCiAgICAgIC8vIElmIHNlbGVjdG9yIGlzIGEgZnVuY3Rpb24gdGhlbiB3ZSBhcmUgaW4gdGhlIG9sZCBzdHlsZSBzdGF0cyBzbyBqdXN0CiAgICAgIC8vIHBhc3MgYmFjayB0aGUgb3JpZ2luYWwgZ2V0U3RhdHMgZm9ybWF0IHRvIGF2b2lkIGJyZWFraW5nIG9sZCB1c2Vycy4KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHJldHVybiBvcmlnR2V0U3RhdHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgLy8gV2hlbiBzcGVjLXN0eWxlIGdldFN0YXRzIGlzIHN1cHBvcnRlZCwgcmV0dXJuIHRob3NlIHdoZW4gY2FsbGVkIHdpdGgKICAgICAgLy8gZWl0aGVyIG5vIGFyZ3VtZW50cyBvciB0aGUgc2VsZWN0b3IgYXJndW1lbnQgaXMgbnVsbC4KICAgICAgaWYgKG9yaWdHZXRTdGF0cy5sZW5ndGggPT09IDAgJiYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHwKICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpKSB7CiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbXSk7CiAgICAgIH0KCiAgICAgIHZhciBmaXhDaHJvbWVTdGF0c18gPSBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgIHZhciBzdGFuZGFyZFJlcG9ydCA9IHt9OwogICAgICAgIHZhciByZXBvcnRzID0gcmVzcG9uc2UucmVzdWx0KCk7CiAgICAgICAgcmVwb3J0cy5mb3JFYWNoKGZ1bmN0aW9uKHJlcG9ydCkgewogICAgICAgICAgdmFyIHN0YW5kYXJkU3RhdHMgPSB7CiAgICAgICAgICAgIGlkOiByZXBvcnQuaWQsCiAgICAgICAgICAgIHRpbWVzdGFtcDogcmVwb3J0LnRpbWVzdGFtcCwKICAgICAgICAgICAgdHlwZTogewogICAgICAgICAgICAgIGxvY2FsY2FuZGlkYXRlOiAnbG9jYWwtY2FuZGlkYXRlJywKICAgICAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgICAgICB9W3JlcG9ydC50eXBlXSB8fCByZXBvcnQudHlwZQogICAgICAgICAgfTsKICAgICAgICAgIHJlcG9ydC5uYW1lcygpLmZvckVhY2goZnVuY3Rpb24obmFtZSkgewogICAgICAgICAgICBzdGFuZGFyZFN0YXRzW25hbWVdID0gcmVwb3J0LnN0YXQobmFtZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHN0YW5kYXJkUmVwb3J0W3N0YW5kYXJkU3RhdHMuaWRdID0gc3RhbmRhcmRTdGF0czsKICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIHN0YW5kYXJkUmVwb3J0OwogICAgICB9OwoKICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICB2YXIgbWFrZU1hcFN0YXRzID0gZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICByZXR1cm4gbmV3IE1hcChPYmplY3Qua2V5cyhzdGF0cykubWFwKGZ1bmN0aW9uKGtleSkgewogICAgICAgICAgcmV0dXJuW2tleSwgc3RhdHNba2V5XV07CiAgICAgICAgfSkpOwogICAgICB9OwoKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMikgewogICAgICAgIHZhciBzdWNjZXNzQ2FsbGJhY2tXcmFwcGVyXyA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICBhcmdzWzFdKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgfTsKCiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbc3VjY2Vzc0NhbGxiYWNrV3JhcHBlcl8sCiAgICAgICAgICAgIGFyZ3VtZW50c1swXV0pOwogICAgICB9CgogICAgICAvLyBwcm9taXNlLXN1cHBvcnQKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIG9yaWdHZXRTdGF0cy5hcHBseShzZWxmLCBbCiAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICByZXNvbHZlKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7CiAgICAgICAgICB9LCByZWplY3RdKTsKICAgICAgfSkudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spOwogICAgfTsKCiAgICAvLyBhZGQgcHJvbWlzZSBzdXBwb3J0IC0tIG5hdGl2ZWx5IGF2YWlsYWJsZSBpbiBDaHJvbWUgNTEKICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNTEpIHsKICAgICAgWydzZXRMb2NhbERlc2NyaXB0aW9uJywgJ3NldFJlbW90ZURlc2NyaXB0aW9uJywgJ2FkZEljZUNhbmRpZGF0ZSddCiAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzOwogICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFthcmdzWzBdLCByZXNvbHZlLCByZWplY3RdKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGFyZ3NbMV0uYXBwbHkobnVsbCwgW10pOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZnVuY3Rpb24oZXJyKSB7CiAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPj0gMykgewogICAgICAgICAgICAgICAgICBhcmdzWzJdLmFwcGx5KG51bGwsIFtlcnJdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgfQoKICAgIC8vIHByb21pc2Ugc3VwcG9ydCBmb3IgY3JlYXRlT2ZmZXIgYW5kIGNyZWF0ZUFuc3dlci4gQXZhaWxhYmxlICh3aXRob3V0CiAgICAvLyBidWdzKSBzaW5jZSBNNTI6IGNyYnVnLzYxOTI4OQogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MikgewogICAgICBbJ2NyZWF0ZU9mZmVyJywgJ2NyZWF0ZUFuc3dlciddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdOwogICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDEgfHwgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYKICAgICAgICAgICAgICB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnb2JqZWN0JykpIHsKICAgICAgICAgICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkOwogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHNlbGYsIFtyZXNvbHZlLCByZWplY3QsIG9wdHNdKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CgogICAgLy8gc2hpbSBpbXBsaWNpdCBjcmVhdGlvbiBvZiBSVENTZXNzaW9uRGVzY3JpcHRpb24vUlRDSWNlQ2FuZGlkYXRlCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfQp9OwoKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbU1lZGlhU3RyZWFtOiBjaHJvbWVTaGltLnNoaW1NZWRpYVN0cmVhbSwKICBzaGltT25UcmFjazogY2hyb21lU2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3QsCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBjaHJvbWVTaGltLnNoaW1QZWVyQ29ubmVjdGlvbiwKICBzaGltR2V0VXNlck1lZGlhOiByZXF1aXJlKCcuL2dldHVzZXJtZWRpYScpCn07Cgp9LHsiLi4vdXRpbHMuanMiOjExLCIuL2dldHVzZXJtZWRpYSI6NX1dLDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKS5sb2c7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIGNvbnN0cmFpbnRzVG9DaHJvbWVfID0gZnVuY3Rpb24oYykgewogICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLm1hbmRhdG9yeSB8fCBjLm9wdGlvbmFsKSB7CiAgICAgIHJldHVybiBjOwogICAgfQogICAgdmFyIGNjID0ge307CiAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICBpZiAoa2V5ID09PSAncmVxdWlyZScgfHwga2V5ID09PSAnYWR2YW5jZWQnIHx8IGtleSA9PT0gJ21lZGlhU291cmNlJykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgciA9ICh0eXBlb2YgY1trZXldID09PSAnb2JqZWN0JykgPyBjW2tleV0gOiB7aWRlYWw6IGNba2V5XX07CiAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHIuZXhhY3QgPT09ICdudW1iZXInKSB7CiAgICAgICAgci5taW4gPSByLm1heCA9IHIuZXhhY3Q7CiAgICAgIH0KICAgICAgdmFyIG9sZG5hbWVfID0gZnVuY3Rpb24ocHJlZml4LCBuYW1lKSB7CiAgICAgICAgaWYgKHByZWZpeCkgewogICAgICAgICAgcmV0dXJuIHByZWZpeCArIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gKG5hbWUgPT09ICdkZXZpY2VJZCcpID8gJ3NvdXJjZUlkJyA6IG5hbWU7CiAgICAgIH07CiAgICAgIGlmIChyLmlkZWFsICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjYy5vcHRpb25hbCA9IGNjLm9wdGlvbmFsIHx8IFtdOwogICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgIGlmICh0eXBlb2Ygci5pZGVhbCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCdtaW4nLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICAgIG9jID0ge307CiAgICAgICAgICBvY1tvbGRuYW1lXygnbWF4Jywga2V5KV0gPSByLmlkZWFsOwogICAgICAgICAgY2Mub3B0aW9uYWwucHVzaChvYyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9jW29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuaWRlYWw7CiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHIuZXhhY3QgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygci5leGFjdCAhPT0gJ251bWJlcicpIHsKICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgY2MubWFuZGF0b3J5W29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuZXhhY3Q7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgWydtaW4nLCAnbWF4J10uZm9yRWFjaChmdW5jdGlvbihtaXgpIHsKICAgICAgICAgIGlmIChyW21peF0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307CiAgICAgICAgICAgIGNjLm1hbmRhdG9yeVtvbGRuYW1lXyhtaXgsIGtleSldID0gclttaXhdOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICAgIGlmIChjLmFkdmFuY2VkKSB7CiAgICAgIGNjLm9wdGlvbmFsID0gKGNjLm9wdGlvbmFsIHx8IFtdKS5jb25jYXQoYy5hZHZhbmNlZCk7CiAgICB9CiAgICByZXR1cm4gY2M7CiAgfTsKCiAgdmFyIHNoaW1Db25zdHJhaW50c18gPSBmdW5jdGlvbihjb25zdHJhaW50cywgZnVuYykgewogICAgY29uc3RyYWludHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7CiAgICBpZiAoY29uc3RyYWludHMgJiYgY29uc3RyYWludHMuYXVkaW8pIHsKICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy5hdWRpbyk7CiAgICB9CiAgICBpZiAoY29uc3RyYWludHMgJiYgdHlwZW9mIGNvbnN0cmFpbnRzLnZpZGVvID09PSAnb2JqZWN0JykgewogICAgICAvLyBTaGltIGZhY2luZ01vZGUgZm9yIG1vYmlsZSwgd2hlcmUgaXQgZGVmYXVsdHMgdG8gInVzZXIiLgogICAgICB2YXIgZmFjZSA9IGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgIGZhY2UgPSBmYWNlICYmICgodHlwZW9mIGZhY2UgPT09ICdvYmplY3QnKSA/IGZhY2UgOiB7aWRlYWw6IGZhY2V9KTsKCiAgICAgIGlmICgoZmFjZSAmJiAoZmFjZS5leGFjdCA9PT0gJ3VzZXInIHx8IGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwKICAgICAgICAgICAgICAgICAgICBmYWNlLmlkZWFsID09PSAndXNlcicgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykpICYmCiAgICAgICAgICAhKG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0U3VwcG9ydGVkQ29uc3RyYWludHMgJiYKICAgICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRTdXBwb3J0ZWRDb25zdHJhaW50cygpLmZhY2luZ01vZGUpKSB7CiAgICAgICAgZGVsZXRlIGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7CiAgICAgICAgaWYgKGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykgewogICAgICAgICAgLy8gTG9vayBmb3IgImJhY2siIGluIGxhYmVsLCBvciB1c2UgbGFzdCBjYW0gKHR5cGljYWxseSBiYWNrIGNhbSkuCiAgICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzKCkKICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgZGV2aWNlcyA9IGRldmljZXMuZmlsdGVyKGZ1bmN0aW9uKGQpIHsKICAgICAgICAgICAgICByZXR1cm4gZC5raW5kID09PSAndmlkZW9pbnB1dCc7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgYmFjayA9IGRldmljZXMuZmluZChmdW5jdGlvbihkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGQubGFiZWwudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdiYWNrJykgIT09IC0xOwogICAgICAgICAgICB9KSB8fCAoZGV2aWNlcy5sZW5ndGggJiYgZGV2aWNlc1tkZXZpY2VzLmxlbmd0aCAtIDFdKTsKICAgICAgICAgICAgaWYgKGJhY2spIHsKICAgICAgICAgICAgICBjb25zdHJhaW50cy52aWRlby5kZXZpY2VJZCA9IGZhY2UuZXhhY3QgPyB7ZXhhY3Q6IGJhY2suZGV2aWNlSWR9IDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aWRlYWw6IGJhY2suZGV2aWNlSWR9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0Nocm9tZV8oY29uc3RyYWludHMudmlkZW8pOwogICAgICAgICAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgICAgICAgICByZXR1cm4gZnVuYyhjb25zdHJhaW50cyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc3RyYWludHMudmlkZW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy52aWRlbyk7CiAgICB9CiAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgcmV0dXJuIGZ1bmMoY29uc3RyYWludHMpOwogIH07CgogIHZhciBzaGltRXJyb3JfID0gZnVuY3Rpb24oZSkgewogICAgcmV0dXJuIHsKICAgICAgbmFtZTogewogICAgICAgIFBlcm1pc3Npb25EZW5pZWRFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgQ29uc3RyYWludE5vdFNhdGlzZmllZEVycm9yOiAnT3ZlcmNvbnN0cmFpbmVkRXJyb3InCiAgICAgIH1bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50TmFtZSwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgc2hpbUNvbnN0cmFpbnRzXyhjb25zdHJhaW50cywgZnVuY3Rpb24oYykgewogICAgICBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKGMsIG9uU3VjY2VzcywgZnVuY3Rpb24oZSkgewogICAgICAgIG9uRXJyb3Ioc2hpbUVycm9yXyhlKSk7CiAgICAgIH0pOwogICAgfSk7CiAgfTsKCiAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IGdldFVzZXJNZWRpYV87CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICBpZiAoIW5hdmlnYXRvci5tZWRpYURldmljZXMpIHsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMgPSB7CiAgICAgIGdldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGVudW1lcmF0ZURldmljZXM6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIga2luZHMgPSB7YXVkaW86ICdhdWRpb2lucHV0JywgdmlkZW86ICd2aWRlb2lucHV0J307CiAgICAgICAgICByZXR1cm4gTWVkaWFTdHJlYW1UcmFjay5nZXRTb3VyY2VzKGZ1bmN0aW9uKGRldmljZXMpIHsKICAgICAgICAgICAgcmVzb2x2ZShkZXZpY2VzLm1hcChmdW5jdGlvbihkZXZpY2UpIHsKICAgICAgICAgICAgICByZXR1cm4ge2xhYmVsOiBkZXZpY2UubGFiZWwsCiAgICAgICAgICAgICAgICAgICAgICBraW5kOiBraW5kc1tkZXZpY2Uua2luZF0sCiAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZDogZGV2aWNlLmlkLAogICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogJyd9OwogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfTsKICB9CgogIC8vIEEgc2hpbSBmb3IgZ2V0VXNlck1lZGlhIG1ldGhvZCBvbiB0aGUgbWVkaWFEZXZpY2VzIG9iamVjdC4KICAvLyBUT0RPKEthcHRlbkphbnNzb24pIHJlbW92ZSBvbmNlIGltcGxlbWVudGVkIGluIENocm9tZSBzdGFibGUuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSkgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cykgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhUHJvbWlzZV8oY29uc3RyYWludHMpOwogICAgfTsKICB9IGVsc2UgewogICAgLy8gRXZlbiB0aG91Z2ggQ2hyb21lIDQ1IGhhcyBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzIGFuZCBhIGdldFVzZXJNZWRpYQogICAgLy8gZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhIFByb21pc2UsIGl0IGRvZXMgbm90IGFjY2VwdCBzcGVjLXN0eWxlCiAgICAvLyBjb25zdHJhaW50cy4KICAgIHZhciBvcmlnR2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEuCiAgICAgICAgYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY3MpIHsKICAgICAgcmV0dXJuIHNoaW1Db25zdHJhaW50c18oY3MsIGZ1bmN0aW9uKGMpIHsKICAgICAgICByZXR1cm4gb3JpZ0dldFVzZXJNZWRpYShjKS50aGVuKGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICAgIGMudmlkZW8gJiYgIXN0cmVhbS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCkgewogICAgICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJycsICdOb3RGb3VuZEVycm9yJyk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gc3RyZWFtOwogICAgICAgIH0sIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KCiAgLy8gRHVtbXkgZGV2aWNlY2hhbmdlIGV2ZW50IG1ldGhvZHMuCiAgLy8gVE9ETyhLYXB0ZW5KYW5zc29uKSByZW1vdmUgb25jZSBpbXBsZW1lbnRlZCBpbiBDaHJvbWUgc3RhYmxlLgogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQogIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykgewogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyIGNhbGxlZC4nKTsKICAgIH07CiAgfQp9OwoKfSx7Ii4uL3V0aWxzLmpzIjoxMX1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7Cgp2YXIgU0RQVXRpbHMgPSByZXF1aXJlKCdzZHAnKTsKdmFyIGJyb3dzZXJEZXRhaWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5icm93c2VyRGV0YWlsczsKCnZhciBlZGdlU2hpbSA9IHsKICBzaGltUGVlckNvbm5lY3Rpb246IGZ1bmN0aW9uKCkgewogICAgaWYgKHdpbmRvdy5SVENJY2VHYXRoZXJlcikgewogICAgICAvLyBPUlRDIGRlZmluZXMgYW4gUlRDSWNlQ2FuZGlkYXRlIG9iamVjdCBidXQgbm8gY29uc3RydWN0b3IuCiAgICAgIC8vIE5vdCBpbXBsZW1lbnRlZCBpbiBFZGdlLgogICAgICBpZiAoIXdpbmRvdy5SVENJY2VDYW5kaWRhdGUpIHsKICAgICAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oYXJncykgewogICAgICAgICAgcmV0dXJuIGFyZ3M7CiAgICAgICAgfTsKICAgICAgfQogICAgICAvLyBPUlRDIGRvZXMgbm90IGhhdmUgYSBzZXNzaW9uIGRlc2NyaXB0aW9uIG9iamVjdCBidXQKICAgICAgLy8gb3RoZXIgYnJvd3NlcnMgKGkuZS4gQ2hyb21lKSB0aGF0IHdpbGwgc3VwcG9ydCBib3RoIFBDIGFuZCBPUlRDCiAgICAgIC8vIGluIHRoZSBmdXR1cmUgbWlnaHQgaGF2ZSB0aGlzIGRlZmluZWQgYWxyZWFkeS4KICAgICAgaWYgKCF3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKSB7CiAgICAgICAgd2luZG93LlJUQ1Nlc3Npb25EZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGFyZ3MpIHsKICAgICAgICAgIHJldHVybiBhcmdzOwogICAgICAgIH07CiAgICAgIH0KICAgICAgLy8gdGhpcyBhZGRzIGFuIGFkZGl0aW9uYWwgZXZlbnQgbGlzdGVuZXIgdG8gTWVkaWFTdHJhY2tUcmFjayB0aGF0IHNpZ25hbHMKICAgICAgLy8gd2hlbiBhIHRyYWNrcyBlbmFibGVkIHByb3BlcnR5IHdhcyBjaGFuZ2VkLiBXb3JrYXJvdW5kIGZvciBhIGJ1ZyBpbgogICAgICAvLyBhZGRTdHJlYW0sIHNlZSBiZWxvdy4gTm8gbG9uZ2VyIHJlcXVpcmVkIGluIDE1MDI1KwogICAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDE1MDI1KSB7CiAgICAgICAgdmFyIG9yaWdNU1RFbmFibGVkID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcigKICAgICAgICAgICAgTWVkaWFTdHJlYW1UcmFjay5wcm90b3R5cGUsICdlbmFibGVkJyk7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLCAnZW5hYmxlZCcsIHsKICAgICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgb3JpZ01TVEVuYWJsZWQuc2V0LmNhbGwodGhpcywgdmFsdWUpOwogICAgICAgICAgICB2YXIgZXYgPSBuZXcgRXZlbnQoJ2VuYWJsZWQnKTsKICAgICAgICAgICAgZXYuZW5hYmxlZCA9IHZhbHVlOwogICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24oY29uZmlnKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgIHZhciBfZXZlbnRUYXJnZXQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CiAgICAgIFsnYWRkRXZlbnRMaXN0ZW5lcicsICdyZW1vdmVFdmVudExpc3RlbmVyJywgJ2Rpc3BhdGNoRXZlbnQnXQogICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgICAgIHNlbGZbbWV0aG9kXSA9IF9ldmVudFRhcmdldFttZXRob2RdLmJpbmQoX2V2ZW50VGFyZ2V0KTsKICAgICAgICAgIH0pOwoKICAgICAgdGhpcy5vbmljZWNhbmRpZGF0ZSA9IG51bGw7CiAgICAgIHRoaXMub25hZGRzdHJlYW0gPSBudWxsOwogICAgICB0aGlzLm9udHJhY2sgPSBudWxsOwogICAgICB0aGlzLm9ucmVtb3Zlc3RyZWFtID0gbnVsbDsKICAgICAgdGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlID0gbnVsbDsKICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZSA9IG51bGw7CiAgICAgIHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCA9IG51bGw7CiAgICAgIHRoaXMub25kYXRhY2hhbm5lbCA9IG51bGw7CgogICAgICB0aGlzLmxvY2FsU3RyZWFtcyA9IFtdOwogICAgICB0aGlzLnJlbW90ZVN0cmVhbXMgPSBbXTsKICAgICAgdGhpcy5nZXRMb2NhbFN0cmVhbXMgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gc2VsZi5sb2NhbFN0cmVhbXM7CiAgICAgIH07CiAgICAgIHRoaXMuZ2V0UmVtb3RlU3RyZWFtcyA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBzZWxmLnJlbW90ZVN0cmVhbXM7CiAgICAgIH07CgogICAgICB0aGlzLmxvY2FsRGVzY3JpcHRpb24gPSBuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHsKICAgICAgICB0eXBlOiAnJywKICAgICAgICBzZHA6ICcnCiAgICAgIH0pOwogICAgICB0aGlzLnJlbW90ZURlc2NyaXB0aW9uID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJycsCiAgICAgICAgc2RwOiAnJwogICAgICB9KTsKICAgICAgdGhpcy5zaWduYWxpbmdTdGF0ZSA9ICdzdGFibGUnOwogICAgICB0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSA9ICduZXcnOwogICAgICB0aGlzLmljZUdhdGhlcmluZ1N0YXRlID0gJ25ldyc7CgogICAgICB0aGlzLmljZU9wdGlvbnMgPSB7CiAgICAgICAgZ2F0aGVyUG9saWN5OiAnYWxsJywKICAgICAgICBpY2VTZXJ2ZXJzOiBbXQogICAgICB9OwogICAgICBpZiAoY29uZmlnICYmIGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICBzd2l0Y2ggKGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHsKICAgICAgICAgIGNhc2UgJ2FsbCc6CiAgICAgICAgICBjYXNlICdyZWxheSc6CiAgICAgICAgICAgIHRoaXMuaWNlT3B0aW9ucy5nYXRoZXJQb2xpY3kgPSBjb25maWcuaWNlVHJhbnNwb3J0UG9saWN5OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgJ25vbmUnOgogICAgICAgICAgICAvLyBGSVhNRTogcmVtb3ZlIG9uY2UgaW1wbGVtZW50YXRpb24gYW5kIHNwZWMgaGF2ZSBhZGRlZCB0aGlzLgogICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpY2VUcmFuc3BvcnRQb2xpY3kgIm5vbmUiIG5vdCBzdXBwb3J0ZWQnKTsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIC8vIGRvbid0IHNldCBpY2VUcmFuc3BvcnRQb2xpY3kuCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnVzaW5nQnVuZGxlID0gY29uZmlnICYmIGNvbmZpZy5idW5kbGVQb2xpY3kgPT09ICdtYXgtYnVuZGxlJzsKCiAgICAgIGlmIChjb25maWcgJiYgY29uZmlnLmljZVNlcnZlcnMpIHsKICAgICAgICAvLyBFZGdlIGRvZXMgbm90IGxpa2UKICAgICAgICAvLyAxKSBzdHVuOgogICAgICAgIC8vIDIpIHR1cm46IHRoYXQgZG9lcyBub3QgaGF2ZSBhbGwgb2YgdHVybjpob3N0OnBvcnQ/dHJhbnNwb3J0PXVkcAogICAgICAgIC8vIDMpIHR1cm46IHdpdGggaXB2NiBhZGRyZXNzZXMKICAgICAgICB2YXIgaWNlU2VydmVycyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29uZmlnLmljZVNlcnZlcnMpKTsKICAgICAgICB0aGlzLmljZU9wdGlvbnMuaWNlU2VydmVycyA9IGljZVNlcnZlcnMuZmlsdGVyKGZ1bmN0aW9uKHNlcnZlcikgewogICAgICAgICAgaWYgKHNlcnZlciAmJiBzZXJ2ZXIudXJscykgewogICAgICAgICAgICB2YXIgdXJscyA9IHNlcnZlci51cmxzOwogICAgICAgICAgICBpZiAodHlwZW9mIHVybHMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgdXJscyA9IFt1cmxzXTsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cmxzID0gdXJscy5maWx0ZXIoZnVuY3Rpb24odXJsKSB7CiAgICAgICAgICAgICAgcmV0dXJuICh1cmwuaW5kZXhPZigndHVybjonKSA9PT0gMCAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHJhbnNwb3J0PXVkcCcpICE9PSAtMSAmJgogICAgICAgICAgICAgICAgICB1cmwuaW5kZXhPZigndHVybjpbJykgPT09IC0xKSB8fAogICAgICAgICAgICAgICAgICAodXJsLmluZGV4T2YoJ3N0dW46JykgPT09IDAgJiYKICAgICAgICAgICAgICAgICAgICBicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE0MzkzKTsKICAgICAgICAgICAgfSlbMF07CiAgICAgICAgICAgIHJldHVybiAhIXVybHM7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnOwoKICAgICAgLy8gcGVyLXRyYWNrIGljZUdhdGhlcnMsIGljZVRyYW5zcG9ydHMsIGR0bHNUcmFuc3BvcnRzLCBydHBTZW5kZXJzLCAuLi4KICAgICAgLy8gZXZlcnl0aGluZyB0aGF0IGlzIG5lZWRlZCB0byBkZXNjcmliZSBhIFNEUCBtLWxpbmUuCiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzID0gW107CgogICAgICAvLyBzaW5jZSB0aGUgaWNlR2F0aGVyZXIgaXMgY3VycmVudGx5IGNyZWF0ZWQgaW4gY3JlYXRlT2ZmZXIgYnV0IHdlCiAgICAgIC8vIG11c3Qgbm90IGVtaXQgY2FuZGlkYXRlcyB1bnRpbCBhZnRlciBzZXRMb2NhbERlc2NyaXB0aW9uIHdlIGJ1ZmZlcgogICAgICAvLyB0aGVtIGluIHRoaXMgYXJyYXkuCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlciA9IFtdOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZScpOwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICBpZiAodGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgdGhpcy5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlKGV2ZW50KTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLmxvY2FsRGVzY3JpcHRpb24uc2RwKTsKICAgICAgLy8gRklYTUU6IG5lZWQgdG8gYXBwbHkgaWNlIGNhbmRpZGF0ZXMgaW4gYSB3YXkgd2hpY2ggaXMgYXN5bmMgYnV0CiAgICAgIC8vIGluLW9yZGVyCiAgICAgIHRoaXMuX2xvY2FsSWNlQ2FuZGlkYXRlc0J1ZmZlci5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgdmFyIGVuZCA9ICFldmVudC5jYW5kaWRhdGUgfHwgT2JqZWN0LmtleXMoZXZlbnQuY2FuZGlkYXRlKS5sZW5ndGggPT09IDA7CiAgICAgICAgaWYgKGVuZCkgewogICAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBzZWN0aW9ucy5sZW5ndGg7IGorKykgewogICAgICAgICAgICBpZiAoc2VjdGlvbnNbal0uaW5kZXhPZignXHJcbmE9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJykgPT09IC0xKSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbal0gKz0gJ2E9ZW5kLW9mLWNhbmRpZGF0ZXNcclxuJzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWN0aW9uc1tldmVudC5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleCArIDFdICs9CiAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgfQogICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICBzZWxmLm9uaWNlY2FuZGlkYXRlKGV2ZW50KTsKICAgICAgICB9CiAgICAgICAgaWYgKCFldmVudC5jYW5kaWRhdGUgJiYgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSAhPT0gJ2NvbXBsZXRlJykgewogICAgICAgICAgdmFyIGNvbXBsZXRlID0gc2VsZi50cmFuc2NlaXZlcnMuZXZlcnkoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICB0cmFuc2NlaXZlci5pY2VHYXRoZXJlci5zdGF0ZSA9PT0gJ2NvbXBsZXRlZCc7CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChjb21wbGV0ZSAmJiBzZWxmLmljZUdhdGhlcmluZ1N0YXRlQ2hhbmdlICE9PSAnY29tcGxldGUnKSB7CiAgICAgICAgICAgIHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUgPSAnY29tcGxldGUnOwogICAgICAgICAgICBzZWxmLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIgPSBbXTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRDb25maWd1cmF0aW9uID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLl9jb25maWc7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkU3RyZWFtID0gZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDE1MDI1KSB7CiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXMucHVzaChzdHJlYW0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIENsb25lIGlzIG5lY2Vzc2FyeSBmb3IgbG9jYWwgZGVtb3MgbW9zdGx5LCBhdHRhY2hpbmcgZGlyZWN0bHkKICAgICAgICAvLyB0byB0d28gZGlmZmVyZW50IHNlbmRlcnMgZG9lcyBub3Qgd29yayAoYnVpbGQgMTA1NDcpLgogICAgICAgIC8vIEZpeGVkIGluIDE1MDI1IChvciBlYXJsaWVyKQogICAgICAgIHZhciBjbG9uZWRTdHJlYW0gPSBzdHJlYW0uY2xvbmUoKTsKICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaywgaWR4KSB7CiAgICAgICAgICB2YXIgY2xvbmVkVHJhY2sgPSBjbG9uZWRTdHJlYW0uZ2V0VHJhY2tzKClbaWR4XTsKICAgICAgICAgIHRyYWNrLmFkZEV2ZW50TGlzdGVuZXIoJ2VuYWJsZWQnLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBjbG9uZWRUcmFjay5lbmFibGVkID0gZXZlbnQuZW5hYmxlZDsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHRoaXMubG9jYWxTdHJlYW1zLnB1c2goY2xvbmVkU3RyZWFtKTsKICAgICAgfQogICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkgewogICAgICB2YXIgaWR4ID0gdGhpcy5sb2NhbFN0cmVhbXMuaW5kZXhPZihzdHJlYW0pOwogICAgICBpZiAoaWR4ID4gLTEpIHsKICAgICAgICB0aGlzLmxvY2FsU3RyZWFtcy5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpOwogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy50cmFuc2NlaXZlcnMuZmlsdGVyKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuICEhdHJhbnNjZWl2ZXIucnRwU2VuZGVyOwogICAgICB9KQogICAgICAubWFwKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLnJ0cFNlbmRlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVjZWl2ZXJzID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLnRyYW5zY2VpdmVycy5maWx0ZXIoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICByZXR1cm4gISF0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSkKICAgICAgLm1hcChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIHJldHVybiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgfSk7CiAgICB9OwoKICAgIC8vIERldGVybWluZXMgdGhlIGludGVyc2VjdGlvbiBvZiBsb2NhbCBhbmQgcmVtb3RlIGNhcGFiaWxpdGllcy4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2dldENvbW1vbkNhcGFiaWxpdGllcyA9CiAgICAgICAgZnVuY3Rpb24obG9jYWxDYXBhYmlsaXRpZXMsIHJlbW90ZUNhcGFiaWxpdGllcykgewogICAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHsKICAgICAgICAgICAgY29kZWNzOiBbXSwKICAgICAgICAgICAgaGVhZGVyRXh0ZW5zaW9uczogW10sCiAgICAgICAgICAgIGZlY01lY2hhbmlzbXM6IFtdCiAgICAgICAgICB9OwogICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24obENvZGVjKSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3RlQ2FwYWJpbGl0aWVzLmNvZGVjcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIHZhciByQ29kZWMgPSByZW1vdGVDYXBhYmlsaXRpZXMuY29kZWNzW2ldOwogICAgICAgICAgICAgIGlmIChsQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpID09PSByQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpICYmCiAgICAgICAgICAgICAgICAgIGxDb2RlYy5jbG9ja1JhdGUgPT09IHJDb2RlYy5jbG9ja1JhdGUpIHsKICAgICAgICAgICAgICAgIC8vIG51bWJlciBvZiBjaGFubmVscyBpcyB0aGUgaGlnaGVzdCBjb21tb24gbnVtYmVyIG9mIGNoYW5uZWxzCiAgICAgICAgICAgICAgICByQ29kZWMubnVtQ2hhbm5lbHMgPSBNYXRoLm1pbihsQ29kZWMubnVtQ2hhbm5lbHMsCiAgICAgICAgICAgICAgICAgICAgckNvZGVjLm51bUNoYW5uZWxzKTsKICAgICAgICAgICAgICAgIC8vIHB1c2ggckNvZGVjIHNvIHdlIHJlcGx5IHdpdGggb2ZmZXJlciBwYXlsb2FkIHR5cGUKICAgICAgICAgICAgICAgIGNvbW1vbkNhcGFiaWxpdGllcy5jb2RlY3MucHVzaChyQ29kZWMpOwoKICAgICAgICAgICAgICAgIC8vIGRldGVybWluZSBjb21tb24gZmVlZGJhY2sgbWVjaGFuaXNtcwogICAgICAgICAgICAgICAgckNvZGVjLnJ0Y3BGZWVkYmFjayA9IHJDb2RlYy5ydGNwRmVlZGJhY2suZmlsdGVyKGZ1bmN0aW9uKGZiKSB7CiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbENvZGVjLnJ0Y3BGZWVkYmFjay5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGlmIChsQ29kZWMucnRjcEZlZWRiYWNrW2pdLnR5cGUgPT09IGZiLnR5cGUgJiYKICAgICAgICAgICAgICAgICAgICAgICAgbENvZGVjLnJ0Y3BGZWVkYmFja1tqXS5wYXJhbWV0ZXIgPT09IGZiLnBhcmFtZXRlcikgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFsc28gbmVlZCB0byBkZXRlcm1pbmUgLnBhcmFtZXRlcnMKICAgICAgICAgICAgICAgIC8vICBzZWUgaHR0cHM6Ly9naXRodWIuY29tL29wZW5wZWVyL29ydGMvaXNzdWVzLzU2OQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zCiAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obEhlYWRlckV4dGVuc2lvbikgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZW1vdGVDYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9ucy5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgIGkrKykgewogICAgICAgICAgICAgICAgICB2YXIgckhlYWRlckV4dGVuc2lvbiA9IHJlbW90ZUNhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zW2ldOwogICAgICAgICAgICAgICAgICBpZiAobEhlYWRlckV4dGVuc2lvbi51cmkgPT09IHJIZWFkZXJFeHRlbnNpb24udXJpKSB7CiAgICAgICAgICAgICAgICAgICAgY29tbW9uQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMucHVzaChySGVhZGVyRXh0ZW5zaW9uKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgIC8vIEZJWE1FOiBmZWNNZWNoYW5pc21zCiAgICAgICAgICByZXR1cm4gY29tbW9uQ2FwYWJpbGl0aWVzOwogICAgICAgIH07CgogICAgLy8gQ3JlYXRlIElDRSBnYXRoZXJlciwgSUNFIHRyYW5zcG9ydCBhbmQgRFRMUyB0cmFuc3BvcnQuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyA9CiAgICAgICAgZnVuY3Rpb24obWlkLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgaWNlR2F0aGVyZXIgPSBuZXcgUlRDSWNlR2F0aGVyZXIoc2VsZi5pY2VPcHRpb25zKTsKICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSBuZXcgUlRDSWNlVHJhbnNwb3J0KGljZUdhdGhlcmVyKTsKICAgICAgICAgIGljZUdhdGhlcmVyLm9ubG9jYWxjYW5kaWRhdGUgPSBmdW5jdGlvbihldnQpIHsKICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKTsKICAgICAgICAgICAgZXZlbnQuY2FuZGlkYXRlID0ge3NkcE1pZDogbWlkLCBzZHBNTGluZUluZGV4OiBzZHBNTGluZUluZGV4fTsKCiAgICAgICAgICAgIHZhciBjYW5kID0gZXZ0LmNhbmRpZGF0ZTsKICAgICAgICAgICAgdmFyIGVuZCA9ICFjYW5kIHx8IE9iamVjdC5rZXlzKGNhbmQpLmxlbmd0aCA9PT0gMDsKICAgICAgICAgICAgLy8gRWRnZSBlbWl0cyBhbiBlbXB0eSBvYmplY3QgZm9yIFJUQ0ljZUNhbmRpZGF0ZUNvbXBsZXRl4oClCiAgICAgICAgICAgIGlmIChlbmQpIHsKICAgICAgICAgICAgICAvLyBwb2x5ZmlsbCBzaW5jZSBSVENJY2VHYXRoZXJlci5zdGF0ZSBpcyBub3QgaW1wbGVtZW50ZWQgaW4KICAgICAgICAgICAgICAvLyBFZGdlIDEwNTQ3IHlldC4KICAgICAgICAgICAgICBpZiAoaWNlR2F0aGVyZXIuc3RhdGUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgaWNlR2F0aGVyZXIuc3RhdGUgPSAnY29tcGxldGVkJzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gUlRDSWNlQ2FuZGlkYXRlIGRvZXNuJ3QgaGF2ZSBhIGNvbXBvbmVudCwgbmVlZHMgdG8gYmUgYWRkZWQKICAgICAgICAgICAgICBjYW5kLmNvbXBvbmVudCA9IGljZVRyYW5zcG9ydC5jb21wb25lbnQgPT09ICdSVENQJyA/IDIgOiAxOwogICAgICAgICAgICAgIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgPSBTRFBVdGlscy53cml0ZUNhbmRpZGF0ZShjYW5kKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdXBkYXRlIGxvY2FsIGRlc2NyaXB0aW9uLgogICAgICAgICAgICB2YXIgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHApOwogICAgICAgICAgICBpZiAoIWVuZCkgewogICAgICAgICAgICAgIHNlY3Rpb25zW2V2ZW50LmNhbmRpZGF0ZS5zZHBNTGluZUluZGV4ICsgMV0gKz0KICAgICAgICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXHJcbic7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc2VjdGlvbnNbZXZlbnQuY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXggKyAxXSArPQogICAgICAgICAgICAgICAgICAnYT1lbmQtb2YtY2FuZGlkYXRlc1xyXG4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGYubG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IHNlbGYuX3BlbmRpbmdPZmZlciA/IHNlbGYuX3BlbmRpbmdPZmZlciA6CiAgICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyczsKICAgICAgICAgICAgdmFyIGNvbXBsZXRlID0gdHJhbnNjZWl2ZXJzLmV2ZXJ5KGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmCiAgICAgICAgICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLnN0YXRlID09PSAnY29tcGxldGVkJzsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBFbWl0IGNhbmRpZGF0ZSBpZiBsb2NhbERlc2NyaXB0aW9uIGlzIHNldC4KICAgICAgICAgICAgLy8gQWxzbyBlbWl0cyBudWxsIGNhbmRpZGF0ZSB3aGVuIGFsbCBnYXRoZXJlcnMgYXJlIGNvbXBsZXRlLgogICAgICAgICAgICBzd2l0Y2ggKHNlbGYuaWNlR2F0aGVyaW5nU3RhdGUpIHsKICAgICAgICAgICAgICBjYXNlICduZXcnOgogICAgICAgICAgICAgICAgaWYgKCFlbmQpIHsKICAgICAgICAgICAgICAgICAgc2VsZi5fbG9jYWxJY2VDYW5kaWRhdGVzQnVmZmVyLnB1c2goZXZlbnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGVuZCAmJiBjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLl9sb2NhbEljZUNhbmRpZGF0ZXNCdWZmZXIucHVzaCgKICAgICAgICAgICAgICAgICAgICAgIG5ldyBFdmVudCgnaWNlY2FuZGlkYXRlJykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAnZ2F0aGVyaW5nJzoKICAgICAgICAgICAgICAgIHNlbGYuX2VtaXRCdWZmZXJlZENhbmRpZGF0ZXMoKTsKICAgICAgICAgICAgICAgIGlmICghZW5kKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShldmVudCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKSk7CiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9uaWNlY2FuZGlkYXRlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbmljZWNhbmRpZGF0ZShuZXcgRXZlbnQoJ2ljZWNhbmRpZGF0ZScpKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBzZWxmLmljZUdhdGhlcmluZ1N0YXRlID0gJ2NvbXBsZXRlJzsKICAgICAgICAgICAgICAgICAgc2VsZi5fZW1pdEdhdGhlcmluZ1N0YXRlQ2hhbmdlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlICdjb21wbGV0ZSc6CiAgICAgICAgICAgICAgICAvLyBzaG91bGQgbm90IGhhcHBlbi4uLiBjdXJyZW50bHkhCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBkZWZhdWx0OiAvLyBuby1vcC4KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgaWNlVHJhbnNwb3J0Lm9uaWNlc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHZhciBkdGxzVHJhbnNwb3J0ID0gbmV3IFJUQ0R0bHNUcmFuc3BvcnQoaWNlVHJhbnNwb3J0KTsKICAgICAgICAgIGR0bHNUcmFuc3BvcnQub25kdGxzc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwogICAgICAgICAgZHRsc1RyYW5zcG9ydC5vbmVycm9yID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIC8vIG9uZXJyb3IgZG9lcyBub3Qgc2V0IHN0YXRlIHRvIGZhaWxlZCBieSBpdHNlbGYuCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQuc3RhdGUgPSAnZmFpbGVkJzsKICAgICAgICAgICAgc2VsZi5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGljZUdhdGhlcmVyOiBpY2VHYXRoZXJlciwKICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiBpY2VUcmFuc3BvcnQsCiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IGR0bHNUcmFuc3BvcnQKICAgICAgICAgIH07CiAgICAgICAgfTsKCiAgICAvLyBTdGFydCB0aGUgUlRQIFNlbmRlciBhbmQgUmVjZWl2ZXIgZm9yIGEgdHJhbnNjZWl2ZXIuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl90cmFuc2NlaXZlID0gZnVuY3Rpb24odHJhbnNjZWl2ZXIsCiAgICAgICAgc2VuZCwgcmVjdikgewogICAgICB2YXIgcGFyYW1zID0gdGhpcy5fZ2V0Q29tbW9uQ2FwYWJpbGl0aWVzKHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLAogICAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzKTsKICAgICAgaWYgKHNlbmQgJiYgdHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgcGFyYW1zLmVuY29kaW5ncyA9IHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgcGFyYW1zLnJ0Y3AgPSB7CiAgICAgICAgICBjbmFtZTogU0RQVXRpbHMubG9jYWxDTmFtZQogICAgICAgIH07CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLnJlY3ZFbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoKSB7CiAgICAgICAgICBwYXJhbXMucnRjcC5zc3JjID0gdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjOwogICAgICAgIH0KICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc2VuZChwYXJhbXMpOwogICAgICB9CiAgICAgIGlmIChyZWN2ICYmIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyKSB7CiAgICAgICAgLy8gcmVtb3ZlIFJUWCBmaWVsZCBpbiBFZGdlIDE0OTQyCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmtpbmQgPT09ICd2aWRlbycKICAgICAgICAgICAgJiYgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycykgewogICAgICAgICAgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHApIHsKICAgICAgICAgICAgZGVsZXRlIHAucnR4OwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHBhcmFtcy5lbmNvZGluZ3MgPSB0cmFuc2NlaXZlci5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgIHBhcmFtcy5ydGNwID0gewogICAgICAgICAgY25hbWU6IHRyYW5zY2VpdmVyLmNuYW1lCiAgICAgICAgfTsKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycy5sZW5ndGgpIHsKICAgICAgICAgIHBhcmFtcy5ydGNwLnNzcmMgPSB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmM7CiAgICAgICAgfQogICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnJlY2VpdmUocGFyYW1zKTsKICAgICAgfQogICAgfTsKCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb24gPQogICAgICAgIGZ1bmN0aW9uKGRlc2NyaXB0aW9uKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgICB2YXIgc2VjdGlvbnM7CiAgICAgICAgICB2YXIgc2Vzc2lvbnBhcnQ7CiAgICAgICAgICBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ29mZmVyJykgewogICAgICAgICAgICAvLyBGSVhNRTogV2hhdCB3YXMgdGhlIHB1cnBvc2Ugb2YgdGhpcyBlbXB0eSBpZiBzdGF0ZW1lbnQ/CiAgICAgICAgICAgIC8vIGlmICghdGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgICAgIC8vIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nT2ZmZXIpIHsKICAgICAgICAgICAgICAvLyBWRVJZIGxpbWl0ZWQgc3VwcG9ydCBmb3IgU0RQIG11bmdpbmcuIExpbWl0ZWQgdG86CiAgICAgICAgICAgICAgLy8gKiBjaGFuZ2luZyB0aGUgb3JkZXIgb2YgY29kZWNzCiAgICAgICAgICAgICAgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKGRlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQgPSBzZWN0aW9ucy5zaGlmdCgpOwogICAgICAgICAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgICAgICAgICB2YXIgY2FwcyA9IFNEUFV0aWxzLnBhcnNlUnRwUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICAgICAgc2VsZi5fcGVuZGluZ09mZmVyW3NkcE1MaW5lSW5kZXhdLmxvY2FsQ2FwYWJpbGl0aWVzID0gY2FwczsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0aGlzLnRyYW5zY2VpdmVycyA9IHRoaXMuX3BlbmRpbmdPZmZlcjsKICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcGVuZGluZ09mZmVyOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgICAgIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhzZWxmLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICAgIHNlc3Npb25wYXJ0ID0gc2VjdGlvbnMuc2hpZnQoKTsKICAgICAgICAgICAgdmFyIGlzSWNlTGl0ZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgICBzZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKG1lZGlhU2VjdGlvbiwgc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQ7CiAgICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0OwogICAgICAgICAgICAgIHZhciBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwogICAgICAgICAgICAgIHZhciByZW1vdGVDYXBhYmlsaXRpZXMgPSB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IG1lZGlhU2VjdGlvbi5zcGxpdCgnXG4nLCAxKVswXQogICAgICAgICAgICAgICAgICAuc3BsaXQoJyAnLCAyKVsxXSA9PT0gJzAnOwoKICAgICAgICAgICAgICBpZiAoIXJlamVjdGVkICYmICF0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlSWNlUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldEljZVBhcmFtZXRlcnMoCiAgICAgICAgICAgICAgICAgICAgbWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCk7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnMgPSBTRFBVdGlscy5nZXREdGxzUGFyYW1ldGVycygKICAgICAgICAgICAgICAgICAgICBtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICAgIGlmIChpc0ljZUxpdGUpIHsKICAgICAgICAgICAgICAgICAgcmVtb3RlRHRsc1BhcmFtZXRlcnMucm9sZSA9ICdzZXJ2ZXInOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydC5zdGFydChpY2VHYXRoZXJlciwgcmVtb3RlSWNlUGFyYW1ldGVycywKICAgICAgICAgICAgICAgICAgICAgIGlzSWNlTGl0ZSA/ICdjb250cm9sbGluZycgOiAnY29udHJvbGxlZCcpOwogICAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgaW50ZXJzZWN0aW9uIG9mIGNhcGFiaWxpdGllcy4KICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSBzZWxmLl9nZXRDb21tb25DYXBhYmlsaXRpZXMobG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgICAgICAgICAgcmVtb3RlQ2FwYWJpbGl0aWVzKTsKCiAgICAgICAgICAgICAgICAvLyBTdGFydCB0aGUgUlRDUnRwU2VuZGVyLiBUaGUgUlRDUnRwUmVjZWl2ZXIgZm9yIHRoaXMKICAgICAgICAgICAgICAgIC8vIHRyYW5zY2VpdmVyIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBpbiBzZXRSZW1vdGVEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmNvZGVjcy5sZW5ndGggPiAwLAogICAgICAgICAgICAgICAgICAgIGZhbHNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMubG9jYWxEZXNjcmlwdGlvbiA9IHsKICAgICAgICAgICAgdHlwZTogZGVzY3JpcHRpb24udHlwZSwKICAgICAgICAgICAgc2RwOiBkZXNjcmlwdGlvbi5zZHAKICAgICAgICAgIH07CiAgICAgICAgICBzd2l0Y2ggKGRlc2NyaXB0aW9uLnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAnb2ZmZXInOgogICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdoYXZlLWxvY2FsLW9mZmVyJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2Fuc3dlcic6CiAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ3N0YWJsZScpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3Vuc3VwcG9ydGVkIHR5cGUgIicgKyBkZXNjcmlwdGlvbi50eXBlICsKICAgICAgICAgICAgICAgICAgJyInKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBJZiBhIHN1Y2Nlc3MgY2FsbGJhY2sgd2FzIHByb3ZpZGVkLCBlbWl0IElDRSBjYW5kaWRhdGVzIGFmdGVyIGl0CiAgICAgICAgICAvLyBoYXMgYmVlbiBleGVjdXRlZC4gT3RoZXJ3aXNlLCBlbWl0IGNhbGxiYWNrIGFmdGVyIHRoZSBQcm9taXNlIGlzCiAgICAgICAgICAvLyByZXNvbHZlZC4KICAgICAgICAgIHZhciBoYXNDYWxsYmFjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmCiAgICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbic7CiAgICAgICAgICBpZiAoaGFzQ2FsbGJhY2spIHsKICAgICAgICAgICAgdmFyIGNiID0gYXJndW1lbnRzWzFdOwogICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICBjYigpOwogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBzZWxmLl9lbWl0QnVmZmVyZWRDYW5kaWRhdGVzKCk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHAgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICAgIHAudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgaWYgKCFoYXNDYWxsYmFjaykgewogICAgICAgICAgICAgIGlmIChzZWxmLmljZUdhdGhlcmluZ1N0YXRlID09PSAnbmV3JykgewogICAgICAgICAgICAgICAgc2VsZi5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdnYXRoZXJpbmcnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBVc3VhbGx5IGNhbmRpZGF0ZXMgd2lsbCBiZSBlbWl0dGVkIGVhcmxpZXIuCiAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoc2VsZi5fZW1pdEJ1ZmZlcmVkQ2FuZGlkYXRlcy5iaW5kKHNlbGYpLCA1MDApOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBwOwogICAgICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbiA9CiAgICAgICAgZnVuY3Rpb24oZGVzY3JpcHRpb24pIHsKICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgIHZhciBzdHJlYW0gPSBuZXcgTWVkaWFTdHJlYW0oKTsKICAgICAgICAgIHZhciByZWNlaXZlckxpc3QgPSBbXTsKICAgICAgICAgIHZhciBzZWN0aW9ucyA9IFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMoZGVzY3JpcHRpb24uc2RwKTsKICAgICAgICAgIHZhciBzZXNzaW9ucGFydCA9IHNlY3Rpb25zLnNoaWZ0KCk7CiAgICAgICAgICB2YXIgaXNJY2VMaXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoc2Vzc2lvbnBhcnQsCiAgICAgICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwOwogICAgICAgICAgdGhpcy51c2luZ0J1bmRsZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LAogICAgICAgICAgICAgICdhPWdyb3VwOkJVTkRMRSAnKS5sZW5ndGggPiAwOwogICAgICAgICAgc2VjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNkcE1MaW5lSW5kZXgpIHsKICAgICAgICAgICAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pOwogICAgICAgICAgICB2YXIgbWxpbmUgPSBsaW5lc1swXS5zdWJzdHIoMikuc3BsaXQoJyAnKTsKICAgICAgICAgICAgdmFyIGtpbmQgPSBtbGluZVswXTsKICAgICAgICAgICAgdmFyIHJlamVjdGVkID0gbWxpbmVbMV0gPT09ICcwJzsKICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IFNEUFV0aWxzLmdldERpcmVjdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTsKCiAgICAgICAgICAgIHZhciBtaWQgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPW1pZDonKTsKICAgICAgICAgICAgaWYgKG1pZC5sZW5ndGgpIHsKICAgICAgICAgICAgICBtaWQgPSBtaWRbMF0uc3Vic3RyKDYpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG1pZCA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBSZWplY3QgZGF0YWNoYW5uZWxzIHdoaWNoIGFyZSBub3QgaW1wbGVtZW50ZWQgeWV0LgogICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2FwcGxpY2F0aW9uJyAmJiBtbGluZVsyXSA9PT0gJ0RUTFMvU0NUUCcpIHsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIG1pZDogbWlkLAogICAgICAgICAgICAgICAgaXNEYXRhY2hhbm5lbDogdHJ1ZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgdHJhbnNjZWl2ZXI7CiAgICAgICAgICAgIHZhciBpY2VHYXRoZXJlcjsKICAgICAgICAgICAgdmFyIGljZVRyYW5zcG9ydDsKICAgICAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQ7CiAgICAgICAgICAgIHZhciBydHBTZW5kZXI7CiAgICAgICAgICAgIHZhciBydHBSZWNlaXZlcjsKICAgICAgICAgICAgdmFyIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7CiAgICAgICAgICAgIHZhciByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXM7CgogICAgICAgICAgICB2YXIgdHJhY2s7CiAgICAgICAgICAgIC8vIEZJWE1FOiBlbnN1cmUgdGhlIG1lZGlhU2VjdGlvbiBoYXMgcnRjcC1tdXggc2V0LgogICAgICAgICAgICB2YXIgcmVtb3RlQ2FwYWJpbGl0aWVzID0gU0RQVXRpbHMucGFyc2VSdHBQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CiAgICAgICAgICAgIHZhciByZW1vdGVJY2VQYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgcmVtb3RlRHRsc1BhcmFtZXRlcnM7CiAgICAgICAgICAgIGlmICghcmVqZWN0ZWQpIHsKICAgICAgICAgICAgICByZW1vdGVJY2VQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0SWNlUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24sCiAgICAgICAgICAgICAgICAgIHNlc3Npb25wYXJ0KTsKICAgICAgICAgICAgICByZW1vdGVEdGxzUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbiwKICAgICAgICAgICAgICAgICAgc2Vzc2lvbnBhcnQpOwogICAgICAgICAgICAgIHJlbW90ZUR0bHNQYXJhbWV0ZXJzLnJvbGUgPSAnY2xpZW50JzsKICAgICAgICAgICAgfQogICAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgIFNEUFV0aWxzLnBhcnNlUnRwRW5jb2RpbmdQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7CgogICAgICAgICAgICB2YXIgY25hbWU7CiAgICAgICAgICAgIC8vIEdldHMgdGhlIGZpcnN0IFNTUkMuIE5vdGUgdGhhdCB3aXRoIFJUWCB0aGVyZSBtaWdodCBiZSBtdWx0aXBsZQogICAgICAgICAgICAvLyBTU1JDcy4KICAgICAgICAgICAgdmFyIHJlbW90ZVNzcmMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNzcmM6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24obGluZSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihvYmopIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iai5hdHRyaWJ1dGUgPT09ICdjbmFtZSc7CiAgICAgICAgICAgICAgICB9KVswXTsKICAgICAgICAgICAgaWYgKHJlbW90ZVNzcmMpIHsKICAgICAgICAgICAgICBjbmFtZSA9IHJlbW90ZVNzcmMudmFsdWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBpc0NvbXBsZXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLAogICAgICAgICAgICAgICAgJ2E9ZW5kLW9mLWNhbmRpZGF0ZXMnLCBzZXNzaW9ucGFydCkubGVuZ3RoID4gMDsKICAgICAgICAgICAgdmFyIGNhbmRzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1jYW5kaWRhdGU6JykKICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24oY2FuZCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUoY2FuZCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihjYW5kKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBjYW5kLmNvbXBvbmVudCA9PT0gJzEnOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInICYmICFyZWplY3RlZCkgewogICAgICAgICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiBzZWxmLnRyYW5zY2VpdmVyc1swXS5pY2VHYXRoZXJlciwKICAgICAgICAgICAgICAgIGljZVRyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uaWNlVHJhbnNwb3J0LAogICAgICAgICAgICAgICAgZHRsc1RyYW5zcG9ydDogc2VsZi50cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICAgICAgICBpZiAoaXNDb21wbGV0ZSAmJiAoIXNlbGYudXNpbmdCdW5kbGUgfHwgc2RwTUxpbmVJbmRleCA9PT0gMCkpIHsKICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuaWNlVHJhbnNwb3J0LnNldFJlbW90ZUNhbmRpZGF0ZXMoY2FuZHMpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBSZWNlaXZlci5nZXRDYXBhYmlsaXRpZXMoa2luZCk7CgogICAgICAgICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMgPSBbewogICAgICAgICAgICAgICAgc3NyYzogKDIgKiBzZHBNTGluZUluZGV4ICsgMikgKiAxMDAxCiAgICAgICAgICAgICAgfV07CgogICAgICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CgogICAgICAgICAgICAgIHRyYWNrID0gcnRwUmVjZWl2ZXIudHJhY2s7CiAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgIC8vIEZJWE1FOiBub3QgY29ycmVjdCB3aGVuIHRoZXJlIGFyZSBtdWx0aXBsZSBzdHJlYW1zIGJ1dCB0aGF0IGlzCiAgICAgICAgICAgICAgLy8gbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgaW4gdGhpcyBzaGltLgogICAgICAgICAgICAgIHN0cmVhbS5hZGRUcmFjayh0cmFjayk7CgogICAgICAgICAgICAgIC8vIEZJWE1FOiBsb29rIGF0IGRpcmVjdGlvbi4KICAgICAgICAgICAgICBpZiAoc2VsZi5sb2NhbFN0cmVhbXMubGVuZ3RoID4gMCAmJgogICAgICAgICAgICAgICAgICBzZWxmLmxvY2FsU3RyZWFtc1swXS5nZXRUcmFja3MoKS5sZW5ndGggPj0gc2RwTUxpbmVJbmRleCkgewogICAgICAgICAgICAgICAgdmFyIGxvY2FsVHJhY2s7CiAgICAgICAgICAgICAgICBpZiAoa2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0QXVkaW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2luZCA9PT0gJ3ZpZGVvJykgewogICAgICAgICAgICAgICAgICBsb2NhbFRyYWNrID0gc2VsZi5sb2NhbFN0cmVhbXNbMF0uZ2V0VmlkZW9UcmFja3MoKVswXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChsb2NhbFRyYWNrKSB7CiAgICAgICAgICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIobG9jYWxUcmFjaywKICAgICAgICAgICAgICAgICAgICAgIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHsKICAgICAgICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc3BvcnRzLmljZUdhdGhlcmVyLAogICAgICAgICAgICAgICAgaWNlVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmljZVRyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQ6IHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwKICAgICAgICAgICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzOiBsb2NhbENhcGFiaWxpdGllcywKICAgICAgICAgICAgICAgIHJlbW90ZUNhcGFiaWxpdGllczogcmVtb3RlQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAgICAgcnRwU2VuZGVyOiBydHBTZW5kZXIsCiAgICAgICAgICAgICAgICBydHBSZWNlaXZlcjogcnRwUmVjZWl2ZXIsCiAgICAgICAgICAgICAgICBraW5kOiBraW5kLAogICAgICAgICAgICAgICAgbWlkOiBtaWQsCiAgICAgICAgICAgICAgICBjbmFtZTogY25hbWUsCiAgICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzOiBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzLAogICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczogcmVjdkVuY29kaW5nUGFyYW1ldGVycwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgLy8gU3RhcnQgdGhlIFJUQ1J0cFJlY2VpdmVyIG5vdy4gVGhlIFJUUFNlbmRlciBpcyBzdGFydGVkIGluCiAgICAgICAgICAgICAgLy8gc2V0TG9jYWxEZXNjcmlwdGlvbi4KICAgICAgICAgICAgICBzZWxmLl90cmFuc2NlaXZlKHNlbGYudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLAogICAgICAgICAgICAgICAgICBmYWxzZSwKICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uID09PSAnc2VuZHJlY3YnIHx8IGRpcmVjdGlvbiA9PT0gJ3NlbmRvbmx5Jyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ2Fuc3dlcicgJiYgIXJlamVjdGVkKSB7CiAgICAgICAgICAgICAgdHJhbnNjZWl2ZXIgPSBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XTsKICAgICAgICAgICAgICBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyOwogICAgICAgICAgICAgIGljZVRyYW5zcG9ydCA9IHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydDsKICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0ID0gdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydDsKICAgICAgICAgICAgICBydHBTZW5kZXIgPSB0cmFuc2NlaXZlci5ydHBTZW5kZXI7CiAgICAgICAgICAgICAgcnRwUmVjZWl2ZXIgPSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzID0gdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzOwoKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0KICAgICAgICAgICAgICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczsKICAgICAgICAgICAgICBzZWxmLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZW1vdGVDYXBhYmlsaXRpZXMgPQogICAgICAgICAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM7CiAgICAgICAgICAgICAgc2VsZi50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uY25hbWUgPSBjbmFtZTsKCiAgICAgICAgICAgICAgaWYgKChpc0ljZUxpdGUgfHwgaXNDb21wbGV0ZSkgJiYgY2FuZHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc2V0UmVtb3RlQ2FuZGlkYXRlcyhjYW5kcyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghc2VsZi51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc3RhcnQoaWNlR2F0aGVyZXIsIHJlbW90ZUljZVBhcmFtZXRlcnMsCiAgICAgICAgICAgICAgICAgICAgJ2NvbnRyb2xsaW5nJyk7CiAgICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNlbGYuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdyZWN2b25seScsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpOwoKICAgICAgICAgICAgICBpZiAocnRwUmVjZWl2ZXIgJiYKICAgICAgICAgICAgICAgICAgKGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpKSB7CiAgICAgICAgICAgICAgICB0cmFjayA9IHJ0cFJlY2VpdmVyLnRyYWNrOwogICAgICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlcl0pOwogICAgICAgICAgICAgICAgc3RyZWFtLmFkZFRyYWNrKHRyYWNrKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gRklYTUU6IGFjdHVhbGx5IHRoZSByZWNlaXZlciBzaG91bGQgYmUgY3JlYXRlZCBsYXRlci4KICAgICAgICAgICAgICAgIGRlbGV0ZSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIHRoaXMucmVtb3RlRGVzY3JpcHRpb24gPSB7CiAgICAgICAgICAgIHR5cGU6IGRlc2NyaXB0aW9uLnR5cGUsCiAgICAgICAgICAgIHNkcDogZGVzY3JpcHRpb24uc2RwCiAgICAgICAgICB9OwogICAgICAgICAgc3dpdGNoIChkZXNjcmlwdGlvbi50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgJ29mZmVyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnaGF2ZS1yZW1vdGUtb2ZmZXInKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnYW5zd2VyJzoKICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnc3RhYmxlJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigndW5zdXBwb3J0ZWQgdHlwZSAiJyArIGRlc2NyaXB0aW9uLnR5cGUgKwogICAgICAgICAgICAgICAgICAnIicpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHN0cmVhbS5nZXRUcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgICAgc2VsZi5yZW1vdGVTdHJlYW1zLnB1c2goc3RyZWFtKTsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdhZGRzdHJlYW0nKTsKICAgICAgICAgICAgICBldmVudC5zdHJlYW0gPSBzdHJlYW07CiAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgICBpZiAoc2VsZi5vbmFkZHN0cmVhbSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYub25hZGRzdHJlYW0oZXZlbnQpOwogICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZWNlaXZlckxpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CiAgICAgICAgICAgICAgICB2YXIgdHJhY2sgPSBpdGVtWzBdOwogICAgICAgICAgICAgICAgdmFyIHJlY2VpdmVyID0gaXRlbVsxXTsKICAgICAgICAgICAgICAgIHZhciB0cmFja0V2ZW50ID0gbmV3IEV2ZW50KCd0cmFjaycpOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5yZWNlaXZlciA9IHJlY2VpdmVyOwogICAgICAgICAgICAgICAgdHJhY2tFdmVudC5zdHJlYW1zID0gW3N0cmVhbV07CiAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQodHJhY2tFdmVudCk7CiAgICAgICAgICAgICAgICBpZiAoc2VsZi5vbnRyYWNrICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHNlbGYub250cmFjayh0cmFja0V2ZW50KTsKICAgICAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sIDApOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoYXJndW1lbnRzWzFdLCAwKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIC8qIG5vdCB5ZXQKICAgICAgICBpZiAodHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgICovCiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCkgewogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0b3AoKTsKICAgICAgICB9CiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7CiAgICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIuc3RvcCgpOwogICAgICAgIH0KICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHsKICAgICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICAvLyBGSVhNRTogY2xlYW4gdXAgdHJhY2tzLCBsb2NhbCBzdHJlYW1zLCByZW1vdGUgc3RyZWFtcywgZXRjCiAgICAgIHRoaXMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdjbG9zZWQnKTsKICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBzaWduYWxpbmcgc3RhdGUuCiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl91cGRhdGVTaWduYWxpbmdTdGF0ZSA9CiAgICAgICAgZnVuY3Rpb24obmV3U3RhdGUpIHsKICAgICAgICAgIHRoaXMuc2lnbmFsaW5nU3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnc2lnbmFsaW5nc3RhdGVjaGFuZ2UnKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICAgICAgICBpZiAodGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlICE9PSBudWxsKSB7CiAgICAgICAgICAgIHRoaXMub25zaWduYWxpbmdzdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAvLyBEZXRlcm1pbmUgd2hldGhlciB0byBmaXJlIHRoZSBuZWdvdGlhdGlvbm5lZWRlZCBldmVudC4KICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX21heWJlRmlyZU5lZ290aWF0aW9uTmVlZGVkID0KICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgIC8vIEZpcmUgYXdheSAoZm9yIG5vdykuCiAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ25lZ290aWF0aW9ubmVlZGVkJyk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgICAgICAgaWYgKHRoaXMub25uZWdvdGlhdGlvbm5lZWRlZCAhPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLm9ubmVnb3RpYXRpb25uZWVkZWQoZXZlbnQpOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgLy8gVXBkYXRlIHRoZSBjb25uZWN0aW9uIHN0YXRlLgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fdXBkYXRlQ29ubmVjdGlvblN0YXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIG5ld1N0YXRlOwogICAgICB2YXIgc3RhdGVzID0gewogICAgICAgICduZXcnOiAwLAogICAgICAgIGNsb3NlZDogMCwKICAgICAgICBjb25uZWN0aW5nOiAwLAogICAgICAgIGNoZWNraW5nOiAwLAogICAgICAgIGNvbm5lY3RlZDogMCwKICAgICAgICBjb21wbGV0ZWQ6IDAsCiAgICAgICAgZmFpbGVkOiAwCiAgICAgIH07CiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHsKICAgICAgICBzdGF0ZXNbdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICAgIHN0YXRlc1t0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LnN0YXRlXSsrOwogICAgICB9KTsKICAgICAgLy8gSUNFVHJhbnNwb3J0LmNvbXBsZXRlZCBhbmQgY29ubmVjdGVkIGFyZSB0aGUgc2FtZSBmb3IgdGhpcyBwdXJwb3NlLgogICAgICBzdGF0ZXMuY29ubmVjdGVkICs9IHN0YXRlcy5jb21wbGV0ZWQ7CgogICAgICBuZXdTdGF0ZSA9ICduZXcnOwogICAgICBpZiAoc3RhdGVzLmZhaWxlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdmYWlsZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5jb25uZWN0aW5nID4gMCB8fCBzdGF0ZXMuY2hlY2tpbmcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnY29ubmVjdGluZyc7CiAgICAgIH0gZWxzZSBpZiAoc3RhdGVzLmRpc2Nvbm5lY3RlZCA+IDApIHsKICAgICAgICBuZXdTdGF0ZSA9ICdkaXNjb25uZWN0ZWQnOwogICAgICB9IGVsc2UgaWYgKHN0YXRlcy5uZXcgPiAwKSB7CiAgICAgICAgbmV3U3RhdGUgPSAnbmV3JzsKICAgICAgfSBlbHNlIGlmIChzdGF0ZXMuY29ubmVjdGVkID4gMCB8fCBzdGF0ZXMuY29tcGxldGVkID4gMCkgewogICAgICAgIG5ld1N0YXRlID0gJ2Nvbm5lY3RlZCc7CiAgICAgIH0KCiAgICAgIGlmIChuZXdTdGF0ZSAhPT0gc2VsZi5pY2VDb25uZWN0aW9uU3RhdGUpIHsKICAgICAgICBzZWxmLmljZUNvbm5lY3Rpb25TdGF0ZSA9IG5ld1N0YXRlOwogICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlJyk7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICBpZiAodGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSAhPT0gbnVsbCkgewogICAgICAgICAgdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZShldmVudCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY3JlYXRlT2ZmZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAodGhpcy5fcGVuZGluZ09mZmVyKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjcmVhdGVPZmZlciBjYWxsZWQgd2hpbGUgdGhlcmUgaXMgYSBwZW5kaW5nIG9mZmVyLicpOwogICAgICB9CiAgICAgIHZhciBvZmZlck9wdGlvbnM7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gIT09ICdmdW5jdGlvbicpIHsKICAgICAgICBvZmZlck9wdGlvbnMgPSBhcmd1bWVudHNbMF07CiAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykgewogICAgICAgIG9mZmVyT3B0aW9ucyA9IGFyZ3VtZW50c1syXTsKICAgICAgfQoKICAgICAgdmFyIHRyYWNrcyA9IFtdOwogICAgICB2YXIgbnVtQXVkaW9UcmFja3MgPSAwOwogICAgICB2YXIgbnVtVmlkZW9UcmFja3MgPSAwOwogICAgICAvLyBEZWZhdWx0IHRvIHNlbmRyZWN2LgogICAgICBpZiAodGhpcy5sb2NhbFN0cmVhbXMubGVuZ3RoKSB7CiAgICAgICAgbnVtQXVkaW9UcmFja3MgPSB0aGlzLmxvY2FsU3RyZWFtc1swXS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aDsKICAgICAgICBudW1WaWRlb1RyYWNrcyA9IHRoaXMubG9jYWxTdHJlYW1zWzBdLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoOwogICAgICB9CiAgICAgIC8vIERldGVybWluZSBudW1iZXIgb2YgYXVkaW8gYW5kIHZpZGVvIHRyYWNrcyB3ZSBuZWVkIHRvIHNlbmQvcmVjdi4KICAgICAgaWYgKG9mZmVyT3B0aW9ucykgewogICAgICAgIC8vIFJlamVjdCBDaHJvbWUgbGVnYWN5IGNvbnN0cmFpbnRzLgogICAgICAgIGlmIChvZmZlck9wdGlvbnMubWFuZGF0b3J5IHx8IG9mZmVyT3B0aW9ucy5vcHRpb25hbCkgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigKICAgICAgICAgICAgICAnTGVnYWN5IG1hbmRhdG9yeS9vcHRpb25hbCBjb25zdHJhaW50cyBub3Qgc3VwcG9ydGVkLicpOwogICAgICAgIH0KICAgICAgICBpZiAob2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgbnVtQXVkaW9UcmFja3MgPSBvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbzsKICAgICAgICB9CiAgICAgICAgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzID0gb2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlVmlkZW87CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmxvY2FsU3RyZWFtcy5sZW5ndGgpIHsKICAgICAgICAvLyBQdXNoIGxvY2FsIHN0cmVhbXMuCiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXNbMF0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiB0cmFjay5raW5kLAogICAgICAgICAgICB0cmFjazogdHJhY2ssCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cmFjay5raW5kID09PSAnYXVkaW8nID8KICAgICAgICAgICAgICAgIG51bUF1ZGlvVHJhY2tzID4gMCA6IG51bVZpZGVvVHJhY2tzID4gMAogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAodHJhY2sua2luZCA9PT0gJ2F1ZGlvJykgewogICAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgICAgfSBlbHNlIGlmICh0cmFjay5raW5kID09PSAndmlkZW8nKSB7CiAgICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgLy8gQ3JlYXRlIE0tbGluZXMgZm9yIHJlY3Zvbmx5IHN0cmVhbXMuCiAgICAgIHdoaWxlIChudW1BdWRpb1RyYWNrcyA+IDAgfHwgbnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgaWYgKG51bUF1ZGlvVHJhY2tzID4gMCkgewogICAgICAgICAgdHJhY2tzLnB1c2goewogICAgICAgICAgICBraW5kOiAnYXVkaW8nLAogICAgICAgICAgICB3YW50UmVjZWl2ZTogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICBudW1BdWRpb1RyYWNrcy0tOwogICAgICAgIH0KICAgICAgICBpZiAobnVtVmlkZW9UcmFja3MgPiAwKSB7CiAgICAgICAgICB0cmFja3MucHVzaCh7CiAgICAgICAgICAgIGtpbmQ6ICd2aWRlbycsCiAgICAgICAgICAgIHdhbnRSZWNlaXZlOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICAgIG51bVZpZGVvVHJhY2tzLS07CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUoKTsKICAgICAgdmFyIHRyYW5zY2VpdmVycyA9IFtdOwogICAgICB0cmFja3MuZm9yRWFjaChmdW5jdGlvbihtbGluZSwgc2RwTUxpbmVJbmRleCkgewogICAgICAgIC8vIEZvciBlYWNoIHRyYWNrLCBjcmVhdGUgYW4gaWNlIGdhdGhlcmVyLCBpY2UgdHJhbnNwb3J0LAogICAgICAgIC8vIGR0bHMgdHJhbnNwb3J0LCBwb3RlbnRpYWxseSBydHBzZW5kZXIgYW5kIHJ0cHJlY2VpdmVyLgogICAgICAgIHZhciB0cmFjayA9IG1saW5lLnRyYWNrOwogICAgICAgIHZhciBraW5kID0gbWxpbmUua2luZDsKICAgICAgICB2YXIgbWlkID0gU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyKCk7CgogICAgICAgIHZhciB0cmFuc3BvcnRzID0gc2VsZi51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCA/IHsKICAgICAgICAgIGljZUdhdGhlcmVyOiB0cmFuc2NlaXZlcnNbMF0uaWNlR2F0aGVyZXIsCiAgICAgICAgICBpY2VUcmFuc3BvcnQ6IHRyYW5zY2VpdmVyc1swXS5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydAogICAgICAgIH0gOiBzZWxmLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyhtaWQsIHNkcE1MaW5lSW5kZXgpOwoKICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXMgPSBSVENSdHBTZW5kZXIuZ2V0Q2FwYWJpbGl0aWVzKGtpbmQpOwogICAgICAgIC8vIGZpbHRlciBSVFggdW50aWwgYWRkaXRpb25hbCBzdHVmZiBuZWVkZWQgZm9yIFJUWCBpcyBpbXBsZW1lbnRlZAogICAgICAgIC8vIGluIGFkYXB0ZXIuanMKICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKAogICAgICAgICAgICBmdW5jdGlvbihjb2RlYykgewogICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JzsKICAgICAgICAgICAgfSk7CiAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHsKICAgICAgICAgIC8vIHdvcmsgYXJvdW5kIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD02NTUyCiAgICAgICAgICAvLyBieSBhZGRpbmcgbGV2ZWwtYXN5bW1ldHJ5LWFsbG93ZWQ9MQogICAgICAgICAgaWYgKGNvZGVjLm5hbWUgPT09ICdIMjY0JyAmJgogICAgICAgICAgICAgIGNvZGVjLnBhcmFtZXRlcnNbJ2xldmVsLWFzeW1tZXRyeS1hbGxvd2VkJ10gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb2RlYy5wYXJhbWV0ZXJzWydsZXZlbC1hc3ltbWV0cnktYWxsb3dlZCddID0gJzEnOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICB2YXIgcnRwU2VuZGVyOwogICAgICAgIHZhciBydHBSZWNlaXZlcjsKCiAgICAgICAgLy8gZ2VuZXJhdGUgYW4gc3NyYyBub3csIHRvIGJlIHVzZWQgbGF0ZXIgaW4gcnRwU2VuZGVyLnNlbmQKICAgICAgICB2YXIgc2VuZEVuY29kaW5nUGFyYW1ldGVycyA9IFt7CiAgICAgICAgICBzc3JjOiAoMiAqIHNkcE1MaW5lSW5kZXggKyAxKSAqIDEwMDEKICAgICAgICB9XTsKICAgICAgICBpZiAodHJhY2spIHsKICAgICAgICAgIHJ0cFNlbmRlciA9IG5ldyBSVENSdHBTZW5kZXIodHJhY2ssIHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCk7CiAgICAgICAgfQoKICAgICAgICBpZiAobWxpbmUud2FudFJlY2VpdmUpIHsKICAgICAgICAgIHJ0cFJlY2VpdmVyID0gbmV3IFJUQ1J0cFJlY2VpdmVyKHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydCwga2luZCk7CiAgICAgICAgfQoKICAgICAgICB0cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0gPSB7CiAgICAgICAgICBpY2VHYXRoZXJlcjogdHJhbnNwb3J0cy5pY2VHYXRoZXJlciwKICAgICAgICAgIGljZVRyYW5zcG9ydDogdHJhbnNwb3J0cy5pY2VUcmFuc3BvcnQsCiAgICAgICAgICBkdGxzVHJhbnNwb3J0OiB0cmFuc3BvcnRzLmR0bHNUcmFuc3BvcnQsCiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllczogbG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXM6IG51bGwsCiAgICAgICAgICBydHBTZW5kZXI6IHJ0cFNlbmRlciwKICAgICAgICAgIHJ0cFJlY2VpdmVyOiBydHBSZWNlaXZlciwKICAgICAgICAgIGtpbmQ6IGtpbmQsCiAgICAgICAgICBtaWQ6IG1pZCwKICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM6IHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMsCiAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzOiBudWxsCiAgICAgICAgfTsKICAgICAgfSk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdHJhbnNjZWl2ZXJzLm1hcChmdW5jdGlvbih0KSB7CiAgICAgICAgICByZXR1cm4gdC5taWQ7CiAgICAgICAgfSkuam9pbignICcpICsgJ1xyXG4nOwogICAgICB9CiAgICAgIHRyYWNrcy5mb3JFYWNoKGZ1bmN0aW9uKG1saW5lLCBzZHBNTGluZUluZGV4KSB7CiAgICAgICAgdmFyIHRyYW5zY2VpdmVyID0gdHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdOwogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsICdvZmZlcicsIHNlbGYubG9jYWxTdHJlYW1zWzBdKTsKICAgICAgfSk7CgogICAgICB0aGlzLl9wZW5kaW5nT2ZmZXIgPSB0cmFuc2NlaXZlcnM7CiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ29mZmVyJywKICAgICAgICBzZHA6IHNkcAogICAgICB9KTsKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGFyZ3VtZW50c1swXSwgMCwgZGVzYyk7CiAgICAgIH0KICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZXNjKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVBbnN3ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlU2Vzc2lvbkJvaWxlcnBsYXRlKCk7CiAgICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlKSB7CiAgICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgdGhpcy50cmFuc2NlaXZlcnMubWFwKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgIHJldHVybiB0Lm1pZDsKICAgICAgICB9KS5qb2luKCcgJykgKyAnXHJcbic7CiAgICAgIH0KICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIGlmICh0cmFuc2NlaXZlci5pc0RhdGFjaGFubmVsKSB7CiAgICAgICAgICBzZHAgKz0gJ209YXBwbGljYXRpb24gMCBEVExTL1NDVFAgNTAwMFxyXG4nICsKICAgICAgICAgICAgICAnYz1JTiBJUDQgMC4wLjAuMFxyXG4nICsKICAgICAgICAgICAgICAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcclxuJzsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gQ2FsY3VsYXRlIGludGVyc2VjdGlvbiBvZiBjYXBhYmlsaXRpZXMuCiAgICAgICAgdmFyIGNvbW1vbkNhcGFiaWxpdGllcyA9IHNlbGYuX2dldENvbW1vbkNhcGFiaWxpdGllcygKICAgICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsCiAgICAgICAgICAgIHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcyk7CgogICAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwgY29tbW9uQ2FwYWJpbGl0aWVzLAogICAgICAgICAgICAnYW5zd2VyJywgc2VsZi5sb2NhbFN0cmVhbXNbMF0pOwogICAgICB9KTsKCiAgICAgIHZhciBkZXNjID0gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7CiAgICAgICAgdHlwZTogJ2Fuc3dlcicsCiAgICAgICAgc2RwOiBzZHAKICAgICAgfSk7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMF0sIDAsIGRlc2MpOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGVzYyk7CiAgICB9OwoKICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oY2FuZGlkYXRlKSB7CiAgICAgIGlmICghY2FuZGlkYXRlKSB7CiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnRyYW5zY2VpdmVycy5sZW5ndGg7IGorKykgewogICAgICAgICAgdGhpcy50cmFuc2NlaXZlcnNbal0uaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZSh7fSk7CiAgICAgICAgICBpZiAodGhpcy51c2luZ0J1bmRsZSkgewogICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBtTGluZUluZGV4ID0gY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXg7CiAgICAgICAgaWYgKGNhbmRpZGF0ZS5zZHBNaWQpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFuc2NlaXZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNjZWl2ZXJzW2ldLm1pZCA9PT0gY2FuZGlkYXRlLnNkcE1pZCkgewogICAgICAgICAgICAgIG1MaW5lSW5kZXggPSBpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHRoaXMudHJhbnNjZWl2ZXJzW21MaW5lSW5kZXhdOwogICAgICAgIGlmICh0cmFuc2NlaXZlcikgewogICAgICAgICAgdmFyIGNhbmQgPSBPYmplY3Qua2V5cyhjYW5kaWRhdGUuY2FuZGlkYXRlKS5sZW5ndGggPiAwID8KICAgICAgICAgICAgICBTRFBVdGlscy5wYXJzZUNhbmRpZGF0ZShjYW5kaWRhdGUuY2FuZGlkYXRlKSA6IHt9OwogICAgICAgICAgLy8gSWdub3JlIENocm9tZSdzIGludmFsaWQgY2FuZGlkYXRlcyBzaW5jZSBFZGdlIGRvZXMgbm90IGxpa2UgdGhlbS4KICAgICAgICAgIGlmIChjYW5kLnByb3RvY29sID09PSAndGNwJyAmJiAoY2FuZC5wb3J0ID09PSAwIHx8IGNhbmQucG9ydCA9PT0gOSkpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgLy8gSWdub3JlIFJUQ1AgY2FuZGlkYXRlcywgd2UgYXNzdW1lIFJUQ1AtTVVYLgogICAgICAgICAgaWYgKGNhbmQuY29tcG9uZW50ICE9PSAnMScpIHsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICAgICAgfQogICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LmFkZFJlbW90ZUNhbmRpZGF0ZShjYW5kKTsKCiAgICAgICAgICAvLyB1cGRhdGUgdGhlIHJlbW90ZURlc2NyaXB0aW9uLgogICAgICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyh0aGlzLnJlbW90ZURlc2NyaXB0aW9uLnNkcCk7CiAgICAgICAgICBzZWN0aW9uc1ttTGluZUluZGV4ICsgMV0gKz0gKGNhbmQudHlwZSA/IGNhbmRpZGF0ZS5jYW5kaWRhdGUudHJpbSgpCiAgICAgICAgICAgICAgOiAnYT1lbmQtb2YtY2FuZGlkYXRlcycpICsgJ1xyXG4nOwogICAgICAgICAgdGhpcy5yZW1vdGVEZXNjcmlwdGlvbi5zZHAgPSBzZWN0aW9ucy5qb2luKCcnKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICB3aW5kb3cuc2V0VGltZW91dChhcmd1bWVudHNbMV0sIDApOwogICAgICB9CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgIH07CgogICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcHJvbWlzZXMgPSBbXTsKICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikgewogICAgICAgIFsncnRwU2VuZGVyJywgJ3J0cFJlY2VpdmVyJywgJ2ljZUdhdGhlcmVyJywgJ2ljZVRyYW5zcG9ydCcsCiAgICAgICAgICAgICdkdGxzVHJhbnNwb3J0J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgICAgICBpZiAodHJhbnNjZWl2ZXJbbWV0aG9kXSkgewogICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0cmFuc2NlaXZlclttZXRob2RdLmdldFN0YXRzKCkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB2YXIgY2IgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiB0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnZnVuY3Rpb24nICYmCiAgICAgICAgICBhcmd1bWVudHNbMV07CiAgICAgIHZhciBmaXhTdGF0c1R5cGUgPSBmdW5jdGlvbihzdGF0KSB7CiAgICAgICAgc3RhdC50eXBlID0gewogICAgICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgICAgIG91dGJvdW5kcnRwOiAnb3V0Ym91bmQtcnRwJywKICAgICAgICAgIGNhbmRpZGF0ZXBhaXI6ICdjYW5kaWRhdGUtcGFpcicsCiAgICAgICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJwogICAgICAgIH1bc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgcmV0dXJuIHN0YXQ7CiAgICAgIH07CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgICAgIHZhciByZXN1bHRzID0gbmV3IE1hcCgpOwogICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKHJlcykgewogICAgICAgICAgcmVzLmZvckVhY2goZnVuY3Rpb24ocmVzdWx0KSB7CiAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlc3VsdCkuZm9yRWFjaChmdW5jdGlvbihpZCkgewogICAgICAgICAgICAgIHJlc3VsdFtpZF0udHlwZSA9IGZpeFN0YXRzVHlwZShyZXN1bHRbaWRdKTsKICAgICAgICAgICAgICByZXN1bHRzLnNldChpZCwgcmVzdWx0W2lkXSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoY2IpIHsKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoY2IsIDAsIHJlc3VsdHMpOwogICAgICAgICAgfQogICAgICAgICAgcmVzb2x2ZShyZXN1bHRzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0KfTsKCi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2hpbVBlZXJDb25uZWN0aW9uOiBlZGdlU2hpbS5zaGltUGVlckNvbm5lY3Rpb24sCiAgc2hpbUdldFVzZXJNZWRpYTogcmVxdWlyZSgnLi9nZXR1c2VybWVkaWEnKQp9OwoKfSx7Ii4uL3V0aWxzIjoxMSwiLi9nZXR1c2VybWVkaWEiOjcsInNkcCI6MX1dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewovKgogKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLgogKgogKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZQogKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlCiAqICB0cmVlLgogKi8KIC8qIGVzbGludC1lbnYgbm9kZSAqLwondXNlIHN0cmljdCc7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7UGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJ31bZS5uYW1lXSB8fCBlLm5hbWUsCiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSwKICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50LAogICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTsKICAgICAgfQogICAgfTsKICB9OwoKICAvLyBnZXRVc2VyTWVkaWEgZXJyb3Igc2hpbS4KICB2YXIgb3JpZ0dldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhLgogICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oYykgewogICAgcmV0dXJuIG9yaWdHZXRVc2VyTWVkaWEoYykuY2F0Y2goZnVuY3Rpb24oZSkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3Qoc2hpbUVycm9yXyhlKSk7CiAgICB9KTsKICB9Owp9OwoKfSx7fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7Cgp2YXIgZmlyZWZveFNoaW0gPSB7CiAgc2hpbU9uVHJhY2s6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnICYmIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiAmJiAhKCdvbnRyYWNrJyBpbgogICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnb250cmFjaycsIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuX29udHJhY2s7CiAgICAgICAgfSwKICAgICAgICBzZXQ6IGZ1bmN0aW9uKGYpIHsKICAgICAgICAgIGlmICh0aGlzLl9vbnRyYWNrKSB7CiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrKTsKICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgdGhpcy5fb250cmFjayA9IGYpOwogICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbnRyYWNrcG9seSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgZS5zdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykgewogICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTsKICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRyYWNrOwogICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0cmFja307CiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07CiAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTsKICAgICAgICAgIH0uYmluZCh0aGlzKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAoKICBzaGltU291cmNlT2JqZWN0OiBmdW5jdGlvbigpIHsKICAgIC8vIEZpcmVmb3ggaGFzIHN1cHBvcnRlZCBtb3pTcmNPYmplY3Qgc2luY2UgRkYyMiwgdW5wcmVmaXhlZCBpbiA0Mi4KICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgewogICAgICBpZiAod2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAhKCdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgICAvLyBTaGltIHRoZSBzcmNPYmplY3QgcHJvcGVydHksIG9uY2UsIHdoZW4gSFRNTE1lZGlhRWxlbWVudCBpcyBmb3VuZC4KICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLCAnc3JjT2JqZWN0JywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMubW96U3JjT2JqZWN0OwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgICAgIHRoaXMubW96U3JjT2JqZWN0ID0gc3RyZWFtOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKCiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsKICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAnb2JqZWN0JyB8fCAhKHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiB8fAogICAgICAgIHdpbmRvdy5tb3pSVENQZWVyQ29ubmVjdGlvbikpIHsKICAgICAgcmV0dXJuOyAvLyBwcm9iYWJseSBtZWRpYS5wZWVyY29ubmVjdGlvbi5lbmFibGVkPWZhbHNlIGluIGFib3V0OmNvbmZpZwogICAgfQogICAgLy8gVGhlIFJUQ1BlZXJDb25uZWN0aW9uIG9iamVjdC4KICAgIGlmICghd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uKSB7CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiA9IGZ1bmN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKSB7CiAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICAgICAgLy8gLnVybHMgaXMgbm90IHN1cHBvcnRlZCBpbiBGRiA8IDM4LgogICAgICAgICAgLy8gY3JlYXRlIFJUQ0ljZVNlcnZlcnMgd2l0aCBhIHNpbmdsZSB1cmwuCiAgICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlU2VydmVycykgewogICAgICAgICAgICB2YXIgbmV3SWNlU2VydmVycyA9IFtdOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBjQ29uZmlnLmljZVNlcnZlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICB2YXIgc2VydmVyID0gcGNDb25maWcuaWNlU2VydmVyc1tpXTsKICAgICAgICAgICAgICBpZiAoc2VydmVyLmhhc093blByb3BlcnR5KCd1cmxzJykpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VydmVyLnVybHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgdmFyIG5ld1NlcnZlciA9IHsKICAgICAgICAgICAgICAgICAgICB1cmw6IHNlcnZlci51cmxzW2pdCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIGlmIChzZXJ2ZXIudXJsc1tqXS5pbmRleE9mKCd0dXJuJykgPT09IDApIHsKICAgICAgICAgICAgICAgICAgICBuZXdTZXJ2ZXIudXNlcm5hbWUgPSBzZXJ2ZXIudXNlcm5hbWU7CiAgICAgICAgICAgICAgICAgICAgbmV3U2VydmVyLmNyZWRlbnRpYWwgPSBzZXJ2ZXIuY3JlZGVudGlhbDsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBuZXdJY2VTZXJ2ZXJzLnB1c2gobmV3U2VydmVyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV3SWNlU2VydmVycy5wdXNoKHBjQ29uZmlnLmljZVNlcnZlcnNbaV0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBwY0NvbmZpZy5pY2VTZXJ2ZXJzID0gbmV3SWNlU2VydmVyczsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBtb3pSVENQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7CiAgICAgIH07CiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSBtb3pSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7CgogICAgICAvLyB3cmFwIHN0YXRpYyBtZXRob2RzLiBDdXJyZW50bHkganVzdCBnZW5lcmF0ZUNlcnRpZmljYXRlLgogICAgICBpZiAobW96UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24sICdnZW5lcmF0ZUNlcnRpZmljYXRlJywgewogICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIG1velJUQ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24gPSBtb3pSVENTZXNzaW9uRGVzY3JpcHRpb247CiAgICAgIHdpbmRvdy5SVENJY2VDYW5kaWRhdGUgPSBtb3pSVENJY2VDYW5kaWRhdGU7CiAgICB9CgogICAgLy8gc2hpbSBhd2F5IG5lZWQgZm9yIG9ic29sZXRlIFJUQ0ljZUNhbmRpZGF0ZS9SVENTZXNzaW9uRGVzY3JpcHRpb24uCiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ10KICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTsKICAgICAgICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID8KICAgICAgICAgICAgICAgIFJUQ0ljZUNhbmRpZGF0ZSA6IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpCiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID0KICAgICAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlOwogICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIWFyZ3VtZW50c1swXSkgewogICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHsKICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwogICAgICB9CiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydAogICAgdmFyIG1ha2VNYXBTdGF0cyA9IGZ1bmN0aW9uKHN0YXRzKSB7CiAgICAgIHZhciBtYXAgPSBuZXcgTWFwKCk7CiAgICAgIE9iamVjdC5rZXlzKHN0YXRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIG1hcC5zZXQoa2V5LCBzdGF0c1trZXldKTsKICAgICAgICBtYXBba2V5XSA9IHN0YXRzW2tleV07CiAgICAgIH0pOwogICAgICByZXR1cm4gbWFwOwogICAgfTsKCiAgICB2YXIgbW9kZXJuU3RhdHNUeXBlcyA9IHsKICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJywKICAgICAgb3V0Ym91bmRydHA6ICdvdXRib3VuZC1ydHAnLAogICAgICBjYW5kaWRhdGVwYWlyOiAnY2FuZGlkYXRlLXBhaXInLAogICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsCiAgICAgIHJlbW90ZWNhbmRpZGF0ZTogJ3JlbW90ZS1jYW5kaWRhdGUnCiAgICB9OwoKICAgIHZhciBuYXRpdmVHZXRTdGF0cyA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0czsKICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBvblN1Y2MsIG9uRXJyKSB7CiAgICAgIHJldHVybiBuYXRpdmVHZXRTdGF0cy5hcHBseSh0aGlzLCBbc2VsZWN0b3IgfHwgbnVsbF0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24oc3RhdHMpIHsKICAgICAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNDgpIHsKICAgICAgICAgICAgc3RhdHMgPSBtYWtlTWFwU3RhdHMoc3RhdHMpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MyAmJiAhb25TdWNjKSB7CiAgICAgICAgICAgIC8vIFNoaW0gb25seSBwcm9taXNlIGdldFN0YXRzIHdpdGggc3BlYy1oeXBoZW5zIGluIHR5cGUgbmFtZXMKICAgICAgICAgICAgLy8gTGVhdmUgY2FsbGJhY2sgdmVyc2lvbiBhbG9uZTsgbWlzYyBvbGQgdXNlcyBvZiBmb3JFYWNoIGJlZm9yZSBNYXAKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBzdGF0cy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXQpIHsKICAgICAgICAgICAgICAgIHN0YXQudHlwZSA9IG1vZGVyblN0YXRzVHlwZXNbc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICBpZiAoZS5uYW1lICE9PSAnVHlwZUVycm9yJykgewogICAgICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gQXZvaWQgVHlwZUVycm9yOiAidHlwZSIgaXMgcmVhZC1vbmx5LCBpbiBvbGQgdmVyc2lvbnMuIDM0LTQzaXNoCiAgICAgICAgICAgICAgc3RhdHMuZm9yRWFjaChmdW5jdGlvbihzdGF0LCBpKSB7CiAgICAgICAgICAgICAgICBzdGF0cy5zZXQoaSwgT2JqZWN0LmFzc2lnbih7fSwgc3RhdCwgewogICAgICAgICAgICAgICAgICB0eXBlOiBtb2Rlcm5TdGF0c1R5cGVzW3N0YXQudHlwZV0gfHwgc3RhdC50eXBlCiAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBzdGF0czsKICAgICAgICB9KQogICAgICAgIC50aGVuKG9uU3VjYywgb25FcnIpOwogICAgfTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1PblRyYWNrOiBmaXJlZm94U2hpbS5zaGltT25UcmFjaywKICBzaGltU291cmNlT2JqZWN0OiBmaXJlZm94U2hpbS5zaGltU291cmNlT2JqZWN0LAogIHNoaW1QZWVyQ29ubmVjdGlvbjogZmlyZWZveFNoaW0uc2hpbVBlZXJDb25uZWN0aW9uLAogIHNoaW1HZXRVc2VyTWVkaWE6IHJlcXVpcmUoJy4vZ2V0dXNlcm1lZGlhJykKfTsKCn0seyIuLi91dGlscyI6MTEsIi4vZ2V0dXNlcm1lZGlhIjo5fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dnaW5nID0gcmVxdWlyZSgnLi4vdXRpbHMnKS5sb2c7CnZhciBicm93c2VyRGV0YWlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJykuYnJvd3NlckRldGFpbHM7CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiB7CiAgICAgICAgU2VjdXJpdHlFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsCiAgICAgICAgUGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJwogICAgICB9W2UubmFtZV0gfHwgZS5uYW1lLAogICAgICBtZXNzYWdlOiB7CiAgICAgICAgJ1RoZSBvcGVyYXRpb24gaXMgaW5zZWN1cmUuJzogJ1RoZSByZXF1ZXN0IGlzIG5vdCBhbGxvd2VkIGJ5IHRoZSAnICsKICAgICAgICAndXNlciBhZ2VudCBvciB0aGUgcGxhdGZvcm0gaW4gdGhlIGN1cnJlbnQgY29udGV4dC4nCiAgICAgIH1bZS5tZXNzYWdlXSB8fCBlLm1lc3NhZ2UsCiAgICAgIGNvbnN0cmFpbnQ6IGUuY29uc3RyYWludCwKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlOwogICAgICB9CiAgICB9OwogIH07CgogIC8vIGdldFVzZXJNZWRpYSBjb25zdHJhaW50cyBzaGltLgogIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgdmFyIGNvbnN0cmFpbnRzVG9GRjM3XyA9IGZ1bmN0aW9uKGMpIHsKICAgICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLnJlcXVpcmUpIHsKICAgICAgICByZXR1cm4gYzsKICAgICAgfQogICAgICB2YXIgcmVxdWlyZSA9IFtdOwogICAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICAgIGlmIChrZXkgPT09ICdyZXF1aXJlJyB8fCBrZXkgPT09ICdhZHZhbmNlZCcgfHwga2V5ID09PSAnbWVkaWFTb3VyY2UnKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciByID0gY1trZXldID0gKHR5cGVvZiBjW2tleV0gPT09ICdvYmplY3QnKSA/CiAgICAgICAgICAgIGNba2V5XSA6IHtpZGVhbDogY1trZXldfTsKICAgICAgICBpZiAoci5taW4gIT09IHVuZGVmaW5lZCB8fAogICAgICAgICAgICByLm1heCAhPT0gdW5kZWZpbmVkIHx8IHIuZXhhY3QgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmVxdWlyZS5wdXNoKGtleSk7CiAgICAgICAgfQogICAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmICh0eXBlb2Ygci5leGFjdCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgci4gbWluID0gci5tYXggPSByLmV4YWN0OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY1trZXldID0gci5leGFjdDsKICAgICAgICAgIH0KICAgICAgICAgIGRlbGV0ZSByLmV4YWN0OwogICAgICAgIH0KICAgICAgICBpZiAoci5pZGVhbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBjLmFkdmFuY2VkID0gYy5hZHZhbmNlZCB8fCBbXTsKICAgICAgICAgIHZhciBvYyA9IHt9OwogICAgICAgICAgaWYgKHR5cGVvZiByLmlkZWFsID09PSAnbnVtYmVyJykgewogICAgICAgICAgICBvY1trZXldID0ge21pbjogci5pZGVhbCwgbWF4OiByLmlkZWFsfTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9jW2tleV0gPSByLmlkZWFsOwogICAgICAgICAgfQogICAgICAgICAgYy5hZHZhbmNlZC5wdXNoKG9jKTsKICAgICAgICAgIGRlbGV0ZSByLmlkZWFsOwogICAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhyKS5sZW5ndGgpIHsKICAgICAgICAgICAgZGVsZXRlIGNba2V5XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAocmVxdWlyZS5sZW5ndGgpIHsKICAgICAgICBjLnJlcXVpcmUgPSByZXF1aXJlOwogICAgICB9CiAgICAgIHJldHVybiBjOwogICAgfTsKICAgIGNvbnN0cmFpbnRzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpOwogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkgewogICAgICBsb2dnaW5nKCdzcGVjOiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgICAgaWYgKGNvbnN0cmFpbnRzLmF1ZGlvKSB7CiAgICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvRkYzN18oY29uc3RyYWludHMuYXVkaW8pOwogICAgICB9CiAgICAgIGlmIChjb25zdHJhaW50cy52aWRlbykgewogICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0ZGMzdfKGNvbnN0cmFpbnRzLnZpZGVvKTsKICAgICAgfQogICAgICBsb2dnaW5nKCdmZjM3OiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTsKICAgIH0KICAgIHJldHVybiBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzLCBvblN1Y2Nlc3MsIGZ1bmN0aW9uKGUpIHsKICAgICAgb25FcnJvcihzaGltRXJyb3JfKGUpKTsKICAgIH0pOwogIH07CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLgogIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGdldFVzZXJNZWRpYV8oY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7CiAgICB9KTsKICB9OwoKICAvLyBTaGltIGZvciBtZWRpYURldmljZXMgb24gb2xkZXIgdmVyc2lvbnMuCiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKSB7CiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzID0ge2dldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sCiAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKCkgeyB9LAogICAgICByZW1vdmVFdmVudExpc3RlbmVyOiBmdW5jdGlvbigpIHsgfQogICAgfTsKICB9CiAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzID0KICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzIHx8IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICB2YXIgaW5mb3MgPSBbCiAgICAgICAgICAgIHtraW5kOiAnYXVkaW9pbnB1dCcsIGRldmljZUlkOiAnZGVmYXVsdCcsIGxhYmVsOiAnJywgZ3JvdXBJZDogJyd9LAogICAgICAgICAgICB7a2luZDogJ3ZpZGVvaW5wdXQnLCBkZXZpY2VJZDogJ2RlZmF1bHQnLCBsYWJlbDogJycsIGdyb3VwSWQ6ICcnfQogICAgICAgICAgXTsKICAgICAgICAgIHJlc29sdmUoaW5mb3MpOwogICAgICAgIH0pOwogICAgICB9OwoKICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDQxKSB7CiAgICAvLyBXb3JrIGFyb3VuZCBodHRwOi8vYnVnemlsLmxhLzExNjk2NjUKICAgIHZhciBvcmdFbnVtZXJhdGVEZXZpY2VzID0KICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMuYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTsKICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gb3JnRW51bWVyYXRlRGV2aWNlcygpLnRoZW4odW5kZWZpbmVkLCBmdW5jdGlvbihlKSB7CiAgICAgICAgaWYgKGUubmFtZSA9PT0gJ05vdEZvdW5kRXJyb3InKSB7CiAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgfQogICAgICAgIHRocm93IGU7CiAgICAgIH0pOwogICAgfTsKICB9CiAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0OSkgewogICAgdmFyIG9yaWdHZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYS4KICAgICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjKSB7CiAgICAgIHJldHVybiBvcmlnR2V0VXNlck1lZGlhKGMpLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7CiAgICAgICAgLy8gV29yayBhcm91bmQgaHR0cHM6Ly9idWd6aWwubGEvODAyMzI2CiAgICAgICAgaWYgKGMuYXVkaW8gJiYgIXN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aCB8fAogICAgICAgICAgICBjLnZpZGVvICYmICFzdHJlYW0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGgpIHsKICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7CiAgICAgICAgICAgIHRyYWNrLnN0b3AoKTsKICAgICAgICAgIH0pOwogICAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignVGhlIG9iamVjdCBjYW4gbm90IGJlIGZvdW5kIGhlcmUuJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ05vdEZvdW5kRXJyb3InKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cmVhbTsKICAgICAgfSwgZnVuY3Rpb24oZSkgewogICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTsKICAgICAgfSk7CiAgICB9OwogIH0KICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikgewogICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0NCkgewogICAgICByZXR1cm4gZ2V0VXNlck1lZGlhXyhjb25zdHJhaW50cywgb25TdWNjZXNzLCBvbkVycm9yKTsKICAgIH0KICAgIC8vIFJlcGxhY2UgRmlyZWZveCA0NCsncyBkZXByZWNhdGlvbiB3YXJuaW5nIHdpdGggdW5wcmVmaXhlZCB2ZXJzaW9uLgogICAgY29uc29sZS53YXJuKCduYXZpZ2F0b3IuZ2V0VXNlck1lZGlhIGhhcyBiZWVuIHJlcGxhY2VkIGJ5ICcgKwogICAgICAgICAgICAgICAgICduYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYScpOwogICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTsKICB9Owp9OwoKfSx7Ii4uL3V0aWxzIjoxMX1dLDEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLyoKICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KICoKICogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlIGxpY2Vuc2UKICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZQogKiAgdHJlZS4KICovCid1c2Ugc3RyaWN0JzsKdmFyIHNhZmFyaVNoaW0gPSB7CiAgLy8gVE9ETzogRHJBbGV4LCBzaG91bGQgYmUgaGVyZSwgZG91YmxlIGNoZWNrIGFnYWluc3QgTGF5b3V0VGVzdHMKICAvLyBzaGltT25UcmFjazogZnVuY3Rpb24oKSB7IH0sCgogIC8vIFRPRE86IG9uY2UgdGhlIGJhY2stZW5kIGZvciB0aGUgbWFjIHBvcnQgaXMgZG9uZSwgYWRkLgogIC8vIFRPRE86IGNoZWNrIGZvciB3ZWJraXRHVEsrCiAgLy8gc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbigpIHsgfSwKCiAgc2hpbUdldFVzZXJNZWRpYTogZnVuY3Rpb24oKSB7CiAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYTsKICB9Cn07CgovLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuCm1vZHVsZS5leHBvcnRzID0gewogIHNoaW1HZXRVc2VyTWVkaWE6IHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYQogIC8vIFRPRE8KICAvLyBzaGltT25UcmFjazogc2FmYXJpU2hpbS5zaGltT25UcmFjaywKICAvLyBzaGltUGVlckNvbm5lY3Rpb246IHNhZmFyaVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uCn07Cgp9LHt9XSwxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Ci8qCiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlCiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2UKICogIHRyZWUuCiAqLwogLyogZXNsaW50LWVudiBub2RlICovCid1c2Ugc3RyaWN0JzsKCnZhciBsb2dEaXNhYmxlZF8gPSB0cnVlOwoKLy8gVXRpbGl0eSBtZXRob2RzLgp2YXIgdXRpbHMgPSB7CiAgZGlzYWJsZUxvZzogZnVuY3Rpb24oYm9vbCkgewogICAgaWYgKHR5cGVvZiBib29sICE9PSAnYm9vbGVhbicpIHsKICAgICAgcmV0dXJuIG5ldyBFcnJvcignQXJndW1lbnQgdHlwZTogJyArIHR5cGVvZiBib29sICsKICAgICAgICAgICcuIFBsZWFzZSB1c2UgYSBib29sZWFuLicpOwogICAgfQogICAgbG9nRGlzYWJsZWRfID0gYm9vbDsKICAgIHJldHVybiAoYm9vbCkgPyAnYWRhcHRlci5qcyBsb2dnaW5nIGRpc2FibGVkJyA6CiAgICAgICAgJ2FkYXB0ZXIuanMgbG9nZ2luZyBlbmFibGVkJzsKICB9LAoKICBsb2c6IGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSB7CiAgICAgIGlmIChsb2dEaXNhYmxlZF8pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5sb2cgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLyoqCiAgICogRXh0cmFjdCBicm93c2VyIHZlcnNpb24gb3V0IG9mIHRoZSBwcm92aWRlZCB1c2VyIGFnZW50IHN0cmluZy4KICAgKgogICAqIEBwYXJhbSB7IXN0cmluZ30gdWFzdHJpbmcgdXNlckFnZW50IHN0cmluZy4KICAgKiBAcGFyYW0geyFzdHJpbmd9IGV4cHIgUmVndWxhciBleHByZXNzaW9uIHVzZWQgYXMgbWF0Y2ggY3JpdGVyaWEuCiAgICogQHBhcmFtIHshbnVtYmVyfSBwb3MgcG9zaXRpb24gaW4gdGhlIHZlcnNpb24gc3RyaW5nIHRvIGJlIHJldHVybmVkLgogICAqIEByZXR1cm4geyFudW1iZXJ9IGJyb3dzZXIgdmVyc2lvbi4KICAgKi8KICBleHRyYWN0VmVyc2lvbjogZnVuY3Rpb24odWFzdHJpbmcsIGV4cHIsIHBvcykgewogICAgdmFyIG1hdGNoID0gdWFzdHJpbmcubWF0Y2goZXhwcik7CiAgICByZXR1cm4gbWF0Y2ggJiYgbWF0Y2gubGVuZ3RoID49IHBvcyAmJiBwYXJzZUludChtYXRjaFtwb3NdLCAxMCk7CiAgfSwKCiAgLyoqCiAgICogQnJvd3NlciBkZXRlY3Rvci4KICAgKgogICAqIEByZXR1cm4ge29iamVjdH0gcmVzdWx0IGNvbnRhaW5pbmcgYnJvd3NlciBhbmQgdmVyc2lvbgogICAqICAgICBwcm9wZXJ0aWVzLgogICAqLwogIGRldGVjdEJyb3dzZXI6IGZ1bmN0aW9uKCkgewogICAgLy8gUmV0dXJuZWQgcmVzdWx0IG9iamVjdC4KICAgIHZhciByZXN1bHQgPSB7fTsKICAgIHJlc3VsdC5icm93c2VyID0gbnVsbDsKICAgIHJlc3VsdC52ZXJzaW9uID0gbnVsbDsKCiAgICAvLyBGYWlsIGVhcmx5IGlmIGl0J3Mgbm90IGEgYnJvd3NlcgogICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8ICF3aW5kb3cubmF2aWdhdG9yKSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIGJyb3dzZXIuJzsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvLyBGaXJlZm94LgogICAgaWYgKG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEpIHsKICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnZmlyZWZveCc7CiAgICAgIHJlc3VsdC52ZXJzaW9uID0gdGhpcy5leHRyYWN0VmVyc2lvbihuYXZpZ2F0b3IudXNlckFnZW50LAogICAgICAgICAgL0ZpcmVmb3hcLyhbMC05XSspXC4vLCAxKTsKCiAgICAvLyBhbGwgd2Via2l0LWJhc2VkIGJyb3dzZXJzCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEpIHsKICAgICAgLy8gQ2hyb21lLCBDaHJvbWl1bSwgV2VidmlldywgT3BlcmEsIGFsbCB1c2UgdGhlIGNocm9tZSBzaGltIGZvciBub3cKICAgICAgaWYgKHdpbmRvdy53ZWJraXRSVENQZWVyQ29ubmVjdGlvbikgewogICAgICAgIHJlc3VsdC5icm93c2VyID0gJ2Nocm9tZSc7CiAgICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvQ2hyb20oZXxpdW0pXC8oWzAtOV0rKVwuLywgMik7CgogICAgICAvLyBTYWZhcmkgb3IgdW5rbm93biB3ZWJraXQtYmFzZWQKICAgICAgLy8gZm9yIHRoZSB0aW1lIGJlaW5nIFNhZmFyaSBoYXMgc3VwcG9ydCBmb3IgTWVkaWFTdHJlYW1zIGJ1dCBub3Qgd2ViUlRDCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gU2FmYXJpIFVBIHN1YnN0cmluZ3Mgb2YgaW50ZXJlc3QgZm9yIHJlZmVyZW5jZToKICAgICAgICAvLyAtIHdlYmtpdCB2ZXJzaW9uOiAgICAgICAgICAgQXBwbGVXZWJLaXQvNjAyLjEuMjUgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLyAtIHNhZmFyaSBVSSB2ZXJzaW9uOiAgICAgICAgVmVyc2lvbi85LjAuMyAodW5pcXVlIHRvIFNhZmFyaSkKICAgICAgICAvLyAtIHNhZmFyaSBVSSB3ZWJraXQgdmVyc2lvbjogU2FmYXJpLzYwMS40LjQgKGFsc28gdXNlZCBpbiBPcCxDcikKICAgICAgICAvLwogICAgICAgIC8vIGlmIHRoZSB3ZWJraXQgdmVyc2lvbiBhbmQgc2FmYXJpIFVJIHdlYmtpdCB2ZXJzaW9ucyBhcmUgZXF1YWxzLAogICAgICAgIC8vIC4uLiB0aGlzIGlzIGEgc3RhYmxlIHZlcnNpb24uCiAgICAgICAgLy8KICAgICAgICAvLyBvbmx5IHRoZSBpbnRlcm5hbCB3ZWJraXQgdmVyc2lvbiBpcyBpbXBvcnRhbnQgdG9kYXkgdG8ga25vdyBpZgogICAgICAgIC8vIG1lZGlhIHN0cmVhbXMgYXJlIHN1cHBvcnRlZAogICAgICAgIC8vCiAgICAgICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL1ZlcnNpb25cLyhcZCspLihcZCspLykpIHsKICAgICAgICAgIHJlc3VsdC5icm93c2VyID0gJ3NhZmFyaSc7CiAgICAgICAgICByZXN1bHQudmVyc2lvbiA9IHRoaXMuZXh0cmFjdFZlcnNpb24obmF2aWdhdG9yLnVzZXJBZ2VudCwKICAgICAgICAgICAgL0FwcGxlV2ViS2l0XC8oWzAtOV0rKVwuLywgMSk7CgogICAgICAgIC8vIHVua25vd24gd2Via2l0LWJhc2VkIGJyb3dzZXIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnVW5zdXBwb3J0ZWQgd2Via2l0LWJhc2VkIGJyb3dzZXIgJyArCiAgICAgICAgICAgICAgJ3dpdGggR1VNIHN1cHBvcnQgYnV0IG5vIFdlYlJUQyBzdXBwb3J0Lic7CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgICAgfQoKICAgIC8vIEVkZ2UuCiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMgJiYKICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9FZGdlXC8oXGQrKS4oXGQrKSQvKSkgewogICAgICByZXN1bHQuYnJvd3NlciA9ICdlZGdlJzsKICAgICAgcmVzdWx0LnZlcnNpb24gPSB0aGlzLmV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAvRWRnZVwvKFxkKykuKFxkKykkLywgMik7CgogICAgLy8gRGVmYXVsdCBmYWxsdGhyb3VnaDogbm90IHN1cHBvcnRlZC4KICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIHN1cHBvcnRlZCBicm93c2VyLic7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9LAoKICAvLyBzaGltQ3JlYXRlT2JqZWN0VVJMIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBzaGltU291cmNlT2JqZWN0IHRvIGF2b2lkIGxvb3AuCgogIHNoaW1DcmVhdGVPYmplY3RVUkw6IGZ1bmN0aW9uKCkgewogICAgaWYgKCEodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiYKICAgICAgICAgICdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSkpIHsKICAgICAgLy8gT25seSBzaGltIENyZWF0ZU9iamVjdFVSTCB1c2luZyBzcmNPYmplY3QgaWYgc3JjT2JqZWN0IGV4aXN0cy4KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICB2YXIgbmF0aXZlQ3JlYXRlT2JqZWN0VVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgbmF0aXZlUmV2b2tlT2JqZWN0VVJMID0gVVJMLnJldm9rZU9iamVjdFVSTC5iaW5kKFVSTCk7CiAgICB2YXIgc3RyZWFtcyA9IG5ldyBNYXAoKSwgbmV3SWQgPSAwOwoKICAgIFVSTC5jcmVhdGVPYmplY3RVUkwgPSBmdW5jdGlvbihzdHJlYW0pIHsKICAgICAgaWYgKCdnZXRUcmFja3MnIGluIHN0cmVhbSkgewogICAgICAgIHZhciB1cmwgPSAncG9seWJsb2I6JyArICgrK25ld0lkKTsKICAgICAgICBzdHJlYW1zLnNldCh1cmwsIHN0cmVhbSk7CiAgICAgICAgY29uc29sZS5sb2coJ1VSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKSBpcyBkZXByZWNhdGVkISAnICsKICAgICAgICAgICAgICAgICAgICAnVXNlIGVsZW0uc3JjT2JqZWN0ID0gc3RyZWFtIGluc3RlYWQhJyk7CiAgICAgICAgcmV0dXJuIHVybDsKICAgICAgfQogICAgICByZXR1cm4gbmF0aXZlQ3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICB9OwogICAgVVJMLnJldm9rZU9iamVjdFVSTCA9IGZ1bmN0aW9uKHVybCkgewogICAgICBuYXRpdmVSZXZva2VPYmplY3RVUkwodXJsKTsKICAgICAgc3RyZWFtcy5kZWxldGUodXJsKTsKICAgIH07CgogICAgdmFyIGRzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NyYycpOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyYycsIHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gZHNjLmdldC5hcHBseSh0aGlzKTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbih1cmwpIHsKICAgICAgICB0aGlzLnNyY09iamVjdCA9IHN0cmVhbXMuZ2V0KHVybCkgfHwgbnVsbDsKICAgICAgICByZXR1cm4gZHNjLnNldC5hcHBseSh0aGlzLCBbdXJsXSk7CiAgICAgIH0KICAgIH0pOwogIH0KfTsKCi8vIEV4cG9ydC4KbW9kdWxlLmV4cG9ydHMgPSB7CiAgbG9nOiB1dGlscy5sb2csCiAgZGlzYWJsZUxvZzogdXRpbHMuZGlzYWJsZUxvZywKICBicm93c2VyRGV0YWlsczogdXRpbHMuZGV0ZWN0QnJvd3NlcigpLAogIGV4dHJhY3RWZXJzaW9uOiB1dGlscy5leHRyYWN0VmVyc2lvbiwKICBzaGltQ3JlYXRlT2JqZWN0VVJMOiB1dGlscy5zaGltQ3JlYXRlT2JqZWN0VVJMCn07Cgp9LHt9XSwxMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCnJlcXVpcmUoJ3dlYnJ0Yy1hZGFwdGVyJyk7CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCi8qKgogIFRoZSBDb25uZWN0aW9uQ29udHJvbGxlciBoYXMgYSBnZW5lcmljIGRlc2lnbiBzbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGluIGJvdGggc3R1YnMuCiAgSXQgbWFuYWdlcyBhIHNpbmdsZSBEYXRhQ2hhbm5lbCwgaXQgaXMgbm90IHJlcXVlc3RpbmcgYWNjZXNzIHRvIG1lZGlhIGlucHV0LCBpLmUuCiAgZG9lcyBub3QgaGF2ZSBhdWRpby92aWRlbyBzdHJlYW1zLgoqKi8KdmFyIENvbm5lY3Rpb25Db250cm9sbGVyID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENvbm5lY3Rpb25Db250cm9sbGVyKG15VXJsLCBzeW5jaGVyLCBjb25maWd1cmF0aW9uLCBjYWxsZXIpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb25uZWN0aW9uQ29udHJvbGxlcik7CgogICAgaWYgKCFteVVybCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgb3duIHVybCAobXlVcmwpIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFzeW5jaGVyKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzeW5jaGVyIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwogICAgaWYgKCFjb25maWd1cmF0aW9uKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWd1cmF0aW9uIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoKICAgIHRoaXMuX2RvbWFpbiA9IHRoaXMuX2RpdmlkZVVSTChteVVybClbImRvbWFpbiJdOwogICAgdGhpcy5fb2JqZWN0RGVzY1VSTCA9ICdoeXBlcnR5LWNhdGFsb2d1ZTovL2NhdGFsb2d1ZS4nICsgdGhpcy5fZG9tYWluICsgJy8ud2VsbC1rbm93bi9kYXRhc2NoZW1hL0Nvbm5lY3Rpb24nOwoKICAgIHRoaXMuX215VXJsID0gbXlVcmw7CiAgICB0aGlzLl9zeW5jaGVyID0gc3luY2hlcjsKICAgIHRoaXMuX2NvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uOwogICAgdGhpcy5fY2FsbGVyID0gY2FsbGVyOwogICAgdGhpcy5fZGF0YU9iamVjdE9ic2VydmVyOwogICAgdGhpcy5fZGF0YU9iamVjdFJlcG9ydGVyOwogICAgdGhpcy5fcGVlclVybDsKICAgIHRoaXMuX2RhdGFDaGFubmVsOwogICAgdGhpcy5fb25TdGF0dXNVcGRhdGU7CiAgICB0aGlzLl9yZW1vdGVSdW50aW1lVVJMOwoKICAgIHRoaXMuX3BlZXJDb25uZWN0aW9uID0gdGhpcy5fY3JlYXRlUGVlckNvbm5lY3Rpb24oKTsKICB9CgogIC8vY3JlYXRlIGEgcGVlciBjb25uZWN0aW9uIHdpdGggaXRzIGV2ZW50IGhhbmRsZXJzCgoKICBfY3JlYXRlQ2xhc3MoQ29ubmVjdGlvbkNvbnRyb2xsZXIsIFt7CiAgICBrZXk6ICdfY3JlYXRlUGVlckNvbm5lY3Rpb24nLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVQZWVyQ29ubmVjdGlvbigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBwYyA9IHRoaXMuX3BlZXJDb25uZWN0aW9uOwogICAgICBpZiAoIXBjKSB7CiAgICAgICAgcGMgPSBuZXcgUlRDUGVlckNvbm5lY3Rpb24odGhpcy5fY29uZmlndXJhdGlvbik7CiAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiBjcmVhdGVkIFBlZXJDb25uZWN0aW9uIik7CgogICAgICAgIC8vIGFkZCBoYW5kbGVyIGZvciBkYXRhY2hhbm5lbCBjcmVhdGlvbiBmcm9tIHBlZXIgc2lkZQogICAgICAgIHBjLm9uZGF0YWNoYW5uZWwgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogb25kYXRhY2hhbm5lbCAtPiByZW1vdGUgc2lkZSBoYXMgY3JlYXRlZCBhIGRhdGFjaGFubmVsIik7CiAgICAgICAgICBfdGhpcy5fZGF0YUNoYW5uZWwgPSBldmVudC5jaGFubmVsOwogICAgICAgICAgX3RoaXMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfTsKCiAgICAgICAgLy8gZXZlbnQgaGFuZGxlciBmb3IgbG9jYWwgaWNlIGNhbmRpZGF0ZXMKICAgICAgICBwYy5vbmljZWNhbmRpZGF0ZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IGljZWNhbmRpZGF0ZWV2ZW50IG9jY3VyZWQ6ICIsIGUpOwogICAgICAgICAgaWYgKCFlLmNhbmRpZGF0ZSkgcmV0dXJuOwogICAgICAgICAgdmFyIGljZWNhbmRpZGF0ZSA9IHsKICAgICAgICAgICAgdHlwZTogJ2NhbmRpZGF0ZScsCiAgICAgICAgICAgIGNhbmRpZGF0ZTogZS5jYW5kaWRhdGUuY2FuZGlkYXRlLAogICAgICAgICAgICBzZHBNaWQ6IGUuY2FuZGlkYXRlLnNkcE1pZCwKICAgICAgICAgICAgc2RwTUxpbmVJbmRleDogZS5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleAogICAgICAgICAgfTsKICAgICAgICAgIC8vIHNlbmQgY2FuZGlkYXRlIHRvIHJlbW90ZSBwZWVyIGJ5IHB1c2hpbmcgaXQgdG8gdGhlIHJlcG9ydGVyIG9iamVjdAogICAgICAgICAgX3RoaXMuX2RhdGFPYmplY3RSZXBvcnRlci5kYXRhLmljZUNhbmRpZGF0ZXMucHVzaChpY2VjYW5kaWRhdGUpOwogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIHBjOwogICAgfQoKICAgIC8qKgogICAgUmVhY3QgdG8gdGhlIGdpdmVuIGludml0YXRpb24gZXZlbnQgYnkgc3Vic2NyaWJpbmcgdG8gdGhlIHByb3ZpZGVkIGludml0YXRpb25FdmVudC51cmwuCiAgICAqKi8KCiAgfSwgewogICAga2V5OiAnb2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb2JzZXJ2ZShpbnZpdGF0aW9uRXZlbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLl9wZWVyVXJsID0gaW52aXRhdGlvbkV2ZW50LmZyb207CiAgICAgIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwgPSBpbnZpdGF0aW9uRXZlbnQudmFsdWUucnVudGltZVVSTDsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIF90aGlzMi5fc3luY2hlci5zdWJzY3JpYmUoX3RoaXMyLl9vYmplY3REZXNjVVJMLCBpbnZpdGF0aW9uRXZlbnQudXJsKS50aGVuKGZ1bmN0aW9uIChkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgICAgIGNvbnNvbGUuaW5mbygnK1tQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIGdvdCBEYXRhIE9iamVjdCBPYnNlcnZlcicsIGRhdGFPYmplY3RPYnNlcnZlcik7CiAgICAgICAgICBfdGhpczIuX3NldHVwT2JzZXJ2ZXIoZGF0YU9iamVjdE9ic2VydmVyKTsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICByZWplY3QoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICBDcmVhdGVzIGEgc3luY2hlciBvYmplY3QgYW5kIGludml0ZSB0aGUgZ2l2ZW4gcGVlclVybCB0byBzdWJzY3JpYmUgZm9yIGl0LgogICAgQWxzbyBjcmVhdGVzIHRoZSBsb2NhbCBvZmZlciwgcGVyZm9ybXMgc2V0TG9jYWxEZXNjcmlwdGlvbiBhbmQgcHVibGlzaGVzIHRoZSBvZmZlciB2aWEgdGhlIHJlcG9ydGVyIG9iamVjdC4KICAgICoqLwoKICB9LCB7CiAgICBrZXk6ICdyZXBvcnQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcG9ydChwZWVyVXJsLCBvd25SdW50aW1lVXJsKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLl9wZWVyVXJsKSB0aGlzLl9wZWVyVXJsID0gcGVlclVybDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCiAgICAgICAgLy8gIGlmIHdlIGFyZSB0aGUgY2FsbGVyIChpLmUuIG5vIHJlcG9ydGVyIG9iamVjdCBwcmVzZW50IHlldCwgaW5pdGFsaXplIHRoZSBjcmVhdGlvbiBvZiB0aGUgRGF0YUNoYW5uZWwpCiAgICAgICAgaWYgKF90aGlzMy5fY2FsbGVyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHdlIGFyZSBpbiBjYWxsZXIgcm9sZSAtLT4gY3JlYXRlRGF0YUNoYW5uZWwgLi4uIik7CiAgICAgICAgICBfdGhpczMuX2RhdGFDaGFubmVsID0gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVEYXRhQ2hhbm5lbCgiUDJQQ2hhbm5lbCIsIHsgcmVsaWFibGU6IGZhbHNlIH0pOwogICAgICAgICAgY29uc29sZS5sb2coIlAyUDogZGF0YWNoYW5uZWwgb2JqZWN0IiwgX3RoaXMzLl9kYXRhQ2hhbm5lbCk7CiAgICAgICAgICBfdGhpczMuX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBpbml0aWFsIGRhdGEgZm9yIHJlcG9ydGVyIHN5bmMgb2JqZWN0CiAgICAgICAgdmFyIGRhdGFPYmplY3QgPSB7CiAgICAgICAgICBuYW1lOiAiUDJQQ29ubmVjdGlvbiIsCiAgICAgICAgICBzdGF0dXM6ICIiLAogICAgICAgICAgb3duZXI6IF90aGlzMy5fbXlVcmwsCiAgICAgICAgICBydW50aW1lVVJMOiBvd25SdW50aW1lVXJsLCAvLyBwdXQgdGhlIG93biBydW50aW1lVVJMIHRvIHRoZSBkYXRhT2JqZWN0IChhcyBkaXNjdXNzZWQgd2l0aCBQYXVsbykKICAgICAgICAgIGNvbm5lY3Rpb25EZXNjcmlwdGlvbjoge30sCiAgICAgICAgICBpY2VDYW5kaWRhdGVzOiBbXQogICAgICAgIH07CiAgICAgICAgLy8gZW5zdXJlIHRoaXMgdGhlIG9ialJlcG9ydGVyIG9iamVjdCBpcyBjcmVhdGVkIGJlZm9yZSB3ZSBjcmVhdGUgdGhlIG9mZmVyCiAgICAgICAgX3RoaXMzLl9zeW5jaGVyLmNyZWF0ZShfdGhpczMuX29iamVjdERlc2NVUkwsIFtfdGhpczMuX3BlZXJVcmxdLCBkYXRhT2JqZWN0KS50aGVuKGZ1bmN0aW9uIChvYmpSZXBvcnRlcikgewogICAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBDcmVhdGVkIFdlYlJUQyBPYmplY3QgUmVwb3J0ZXInLCBvYmpSZXBvcnRlcik7CgogICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIgPSBvYmpSZXBvcnRlcjsKICAgICAgICAgIF90aGlzMy5fZGF0YU9iamVjdFJlcG9ydGVyLm9uU3Vic2NyaXB0aW9uKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICBldmVudC5hY2NlcHQoKTsgLy8gYWxsIHN1YnNjcmlwdGlvbiByZXF1ZXN0ZWQgYXJlIGFjY2VwdGVkCiAgICAgICAgICB9KTsKCiAgICAgICAgICB2YXIgY29uc3RyYWludHMgPSB7CiAgICAgICAgICAgIG9mZmVyVG9SZWNlaXZlQXVkaW86IGZhbHNlLAogICAgICAgICAgICBvZmZlclRvUmVjZWl2ZVZpZGVvOiBmYWxzZQogICAgICAgICAgfTsKICAgICAgICAgIC8vIGVpdGhlciBpbnZva2UgY3JlYXRlT2ZmZXIgb3IgY3JlYXRlQW5zd2VyLCBkZXBlbmRpbmcgb24gdGhlIHJvbGVzCiAgICAgICAgICB2YXIgc2RwUHJvbWlzZSA9IF90aGlzMy5fY2FsbGVyID8gX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5jcmVhdGVPZmZlcihjb25zdHJhaW50cykgOiBfdGhpczMuX3BlZXJDb25uZWN0aW9uLmNyZWF0ZUFuc3dlcigpOwogICAgICAgICAgc2RwUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChzZHApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdIFNEUCBjcmVhdGVkIiwgc2RwKTsKICAgICAgICAgICAgX3RoaXMzLl9wZWVyQ29ubmVjdGlvbi5zZXRMb2NhbERlc2NyaXB0aW9uKG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oc2RwKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gbG9jYWxEZXNjcmlwdGlvbiBzZXQgc3VjY2Vzc2Z1bGx5Jyk7CiAgICAgICAgICAgICAgX3RoaXMzLl9kYXRhT2JqZWN0UmVwb3J0ZXIuZGF0YS5jb25uZWN0aW9uRGVzY3JpcHRpb24gPSBzZHA7CiAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIHJlamVjdCgic2V0dGluZyBvZiBsb2NhbERlc2NyaXB0aW9uIGZhaWxlZDogIiwgZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7CiAgICAgICAgICAgIHJlamVjdChyZWFzb24pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25NZXNzYWdlKGNhbGxiYWNrKSB7CiAgICAgIC8vIGFkZCB0aGUgbWVzc2FnZSBjYWxsYmFjawogICAgICB0aGlzLl9vbkRhdGFDaGFubmVsTWVzc2FnZSA9IGNhbGxiYWNrOwogICAgfQogIH0sIHsKICAgIGtleTogJ29uU3RhdHVzVXBkYXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblN0YXR1c1VwZGF0ZShjYWxsYmFjaykgewogICAgICAvLyBhZGQgYSBjb25uZWN0aW9uIHN0YXR1cyB1cGRhdGUgY2FsbGJhY2sKICAgICAgdGhpcy5fb25TdGF0dXNVcGRhdGUgPSBjYWxsYmFjazsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdzZW5kTWVzc2FnZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZE1lc3NhZ2UobSkgewogICAgICAvLyB0b2RvOiBvbmx5IHNlbmQgaWYgZGF0YSBjaGFubmVsIGlzIGNvbm5lY3RlZAogICAgICBjb25zb2xlLmxvZygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gLS0+IG91dGdvaW5nIG1zZzogIiwgbSk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLnNlbmQobSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnY2xlYW51cCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYW51cCgpIHsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RSZXBvcnRlcjsKICAgICAgZGVsZXRlIHRoaXMuX2RhdGFPYmplY3RPYnNlcnZlcjsKICAgICAgaWYgKHRoaXMuX2RhdGFDaGFubmVsKSB0aGlzLl9kYXRhQ2hhbm5lbC5jbG9zZSgpOwogICAgICBpZiAodGhpcy5fcGVlckNvbm5lY3Rpb24pIHRoaXMuX3BlZXJDb25uZWN0aW9uLmNsb3NlKCk7CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsID0gbnVsbDsKICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24gPSBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogJ19hZGREYXRhQ2hhbm5lbExpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FkZERhdGFDaGFubmVsTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxPcGVuKCk7CiAgICAgIH07CiAgICAgIHRoaXMuX2RhdGFDaGFubmVsLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzNC5fb25EYXRhQ2hhbm5lbEVycm9yKGUpOwogICAgICB9OwogICAgICB0aGlzLl9kYXRhQ2hhbm5lbC5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAobSkgewogICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSA8LS0gaW5jb21pbmcgbXNnOiAiLCBtKTsKICAgICAgICBpZiAoX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZSkgX3RoaXM0Ll9vbkRhdGFDaGFubmVsTWVzc2FnZShtKTsKICAgICAgfTsKICAgICAgdGhpcy5fZGF0YUNoYW5uZWwub25jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczQuX29uRGF0YUNoYW5uZWxDbG9zZSgpOwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogJ19zZXR1cE9ic2VydmVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0dXBPYnNlcnZlcihkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIgPSBkYXRhT2JqZWN0T2JzZXJ2ZXI7CgogICAgICB2YXIgcGVlckRhdGEgPSB0aGlzLl9kYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YTsKICAgICAgY29uc29sZS5pbmZvKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogX3NldHVwT2JzZXJ2ZXIgUGVlciBEYXRhOiIsIHBlZXJEYXRhKTsKCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnY29ubmVjdGlvbkRlc2NyaXB0aW9uJykpIHsKICAgICAgICB0aGlzLl9wcm9jZXNzUGVlckluZm9ybWF0aW9uKHBlZXJEYXRhLmNvbm5lY3Rpb25EZXNjcmlwdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChwZWVyRGF0YS5oYXNPd25Qcm9wZXJ0eSgnaWNlQ2FuZGlkYXRlcycpKSB7CiAgICAgICAgcGVlckRhdGEuaWNlQ2FuZGlkYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChpY2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogaGFuZGxlT2JzZXJ2ZXJPYmplY3QgZm9yIGljZSIsIGljZSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oaWNlKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgLy8gc2V0dXAgbGlzdGVuZXIgZm9yIGZ1dHVyZSBjaGFuZ2VzIG9uIHRoZSBvYnNlcnZlZCBkYXRhIG9iamVjdAogICAgICBkYXRhT2JqZWN0T2JzZXJ2ZXIub25DaGFuZ2UoJyonLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBjb25zb2xlLmRlYnVnKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogT2JzZXJ2ZXIgb24gY2hhbmdlIG1lc3NhZ2U6ICcsIGV2ZW50KTsKICAgICAgICAvLyB3ZSBuZWVkIHRvIHByb2Nlc3MgdGhlIGFuc3dlciBmcm9tIGV2ZW50LmRhdGEgYW5kIHRoZSBjYW5kaWRhdGVzIHdoaWNoIG1pZ2h0IHRyaWNrbGUKICAgICAgICAvLyBmcm9tIGV2ZW50LmRhdGFbMF0KICAgICAgICBpZiAoZXZlbnQuZGF0YVswXSkgewogICAgICAgICAgLy8gWzBdIHRoaXMgZG9lcyB0aGUgdHJpY2sgd2hlbiBpY2UgY2FuZGlkYXRlcyBhcmUgdHJpY2tsaW5nIDspCiAgICAgICAgICBjb25zb2xlLmxvZygnPj5ldmVudC5kYXRhWzBdJywgZXZlbnQuZGF0YVswXSk7CiAgICAgICAgICBfdGhpczUuX3Byb2Nlc3NQZWVySW5mb3JtYXRpb24oZXZlbnQuZGF0YVswXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogPj5ldmVudCcsIGV2ZW50KTsKICAgICAgICAgIF90aGlzNS5fcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihldmVudC5kYXRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19wcm9jZXNzUGVlckluZm9ybWF0aW9uJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcHJvY2Vzc1BlZXJJbmZvcm1hdGlvbihkYXRhKSB7CiAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246ICIsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgaWYgKCF0aGlzLl9wZWVyQ29ubmVjdGlvbikgewogICAgICAgIGNvbnNvbGUuaW5mbygiW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl06IHByb2Nlc3NQZWVySW5mb3JtYXRpb246IG5vIFBlZXJDb25uZWN0aW9uIGV4aXN0aW5nIC0tPiBtYXliZSBpbiBkaXNjb25uZWN0aW5nIHByb2Nlc3MuIC0tPiBpZ25vcmluZyB0aGlzIHVwZGF0ZSIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGRhdGEudHlwZSA9PT0gJ29mZmVyJyB8fCBkYXRhLnR5cGUgPT09ICdhbnN3ZXInKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogUHJvY2VzcyBDb25uZWN0aW9uIERlc2NyaXB0aW9uOiAnLCBkYXRhKTsKICAgICAgICB0aGlzLl9wZWVyQ29ubmVjdGlvbi5zZXRSZW1vdGVEZXNjcmlwdGlvbihuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKGRhdGEpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXTogcmVtb3RlIHN1Y2Nlc3MiKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgY29uc29sZS5sb2coIltQMlAtQ29ubmVjdGlvbkNvbnRyb2xsZXJdOiByZW1vdGUgZXJyb3I6ICIsIGUpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAoZGF0YS5jYW5kaWRhdGUpIHsKICAgICAgICBjb25zb2xlLmluZm8oJ1Byb2Nlc3MgSWNlIENhbmRpZGF0ZTogJywgZGF0YSk7CiAgICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb24uYWRkSWNlQ2FuZGlkYXRlKG5ldyBSVENJY2VDYW5kaWRhdGUoewogICAgICAgICAgY2FuZGlkYXRlOiBkYXRhLmNhbmRpZGF0ZQogICAgICAgIH0pKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsT3BlbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRGF0YUNoYW5uZWxPcGVuKCkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgb3BlbmVkJyk7CiAgICAgIGlmICh0aGlzLl9vblN0YXR1c1VwZGF0ZSkgdGhpcy5fb25TdGF0dXNVcGRhdGUoImxpdmUiLCB1bmRlZmluZWQsIHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsRXJyb3InLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsRXJyb3IoZSkgewogICAgICBjb25zb2xlLmxvZygnW1AyUC1Db25uZWN0aW9uQ29udHJvbGxlcl0gRGF0YUNoYW5uZWwgZXJyb3I6ICcsIGUpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiIiArIGUpOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkRhdGFDaGFubmVsQ2xvc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRhdGFDaGFubmVsQ2xvc2UoKSB7CiAgICAgIGNvbnNvbGUubG9nKCdbUDJQLUNvbm5lY3Rpb25Db250cm9sbGVyXSBEYXRhQ2hhbm5lbCBjbG9zZWQ6ICcpOwogICAgICBpZiAodGhpcy5fb25TdGF0dXNVcGRhdGUpIHRoaXMuX29uU3RhdHVzVXBkYXRlKCJkaXNjb25uZWN0ZWQiLCAiY2xvc2VkIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICAgICAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCiAgICAgKiBAcmV0dXJuIHtkaXZpZGVVUkx9IHRoZSByZXN1bHQgb2YgZGl2aWRlVVJMCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnX2RpdmlkZVVSTCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RpdmlkZVVSTCh1cmwpIHsKCiAgICAgIC8vIGxldCByZSA9IC8oW2EtekEtWi1dKik/OlwvXC8oPzpcLik/KFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIpKihcL1tcL1xkXHdcLi1dKikqKD86W1w/XSkqKC4rKSovZ2k7CiAgICAgIHZhciByZSA9IC8oW2EtekEtWi1dKik6XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogICAgICB2YXIgc3Vic3QgPSAnJDEsJDIsJDMnOwogICAgICB2YXIgcGFydHMgPSB1cmwucmVwbGFjZShyZSwgc3Vic3QpLnNwbGl0KCcsJyk7CgogICAgICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzCiAgICAgIGlmIChwYXJ0c1swXSA9PT0gdXJsKSB7CiAgICAgICAgcGFydHNbMF0gPSAnaHR0cHMnOwogICAgICAgIHBhcnRzWzFdID0gdXJsOwogICAgICB9CgogICAgICB2YXIgcmVzdWx0ID0gewogICAgICAgIHR5cGU6IHBhcnRzWzBdLAogICAgICAgIGRvbWFpbjogcGFydHNbMV0sCiAgICAgICAgaWRlbnRpdHk6IHBhcnRzWzJdCiAgICAgIH07CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIENvbm5lY3Rpb25Db250cm9sbGVyOwp9KCk7CgpleHBvcnRzLmRlZmF1bHQgPSBDb25uZWN0aW9uQ29udHJvbGxlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsid2VicnRjLWFkYXB0ZXIiOjN9XSwxMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCmV4cG9ydHMuZGVmYXVsdCA9IGFjdGl2YXRlOwoKdmFyIF9TeW5jaGVyID0gcmVxdWlyZSgnc2VydmljZS1mcmFtZXdvcmsvZGlzdC9TeW5jaGVyJyk7Cgp2YXIgX0Nvbm5lY3Rpb25Db250cm9sbGVyID0gcmVxdWlyZSgnLi9Db25uZWN0aW9uQ29udHJvbGxlcicpOwoKdmFyIF9Db25uZWN0aW9uQ29udHJvbGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Db25uZWN0aW9uQ29udHJvbGxlcik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgovLyBUT0RPOiBpbnRlZ3JhdGUgdGhlIHN0YXR1cyBldmVudGluZwoKLyoqCiAqIFByb3RvU3R1YiBJbnRlcmZhY2UKICovCnZhciBQMlBSZXF1ZXN0ZXJTdHViID0gZnVuY3Rpb24gKCkgewoKICAvKioKICAgKiBJbml0aWFsaXNlIHRoZSBwcm90b2NvbCBzdHViIGluY2x1ZGluZyBhcyBpbnB1dCBwYXJhbWV0ZXJzIGl0cyBhbGxvY2F0ZWQKICAgKiBjb21wb25lbnQgcnVudGltZSB1cmwsIHRoZSBydW50aW1lIEJVUyBwb3N0TWVzc2FnZSBmdW5jdGlvbiB0byBiZSBpbnZva2VkCiAgICogb24gbWVzc2FnZXMgcmVjZWl2ZWQgYnkgdGhlIHByb3RvY29sIHN0dWIgYW5kIHJlcXVpcmVkIGNvbmZpZ3VyYXRpb24gcmV0cmlldmVkIGZyb20gcHJvdG9jb2xTdHViIGRlc2NyaXB0b3IuCiAgICogQHBhcmFtICB7VVJMLnJ1bnRpbWVQcm90b1N0dWJVUkx9ICAgICAgICAgICAgICAgICAgIHJ1bnRpbWVQcm90b1N0dWJVUkwgcnVudGltZVByb3RvU3ViVVJMCiAgICogQHBhcmFtICB7TWVzc2FnZS5NZXNzYWdlfSAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1c1Bvc3RNZXNzYWdlICAgICBjb25maWd1cmF0aW9uCiAgICogQHBhcmFtICB7UHJvdG9TdHViRGVzY3JpcHRvci5Db25maWd1cmF0aW9uRGF0YUxpc3R9IGNvbmZpZ3VyYXRpb24gICAgICBjb25maWd1cmF0aW9uCiAgICovCiAgZnVuY3Rpb24gUDJQUmVxdWVzdGVyU3R1YihydW50aW1lUHJvdG9TdHViVVJMLCBtaW5pQnVzLCBjb25maWd1cmF0aW9uKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQMlBSZXF1ZXN0ZXJTdHViKTsKCiAgICBpZiAoIXJ1bnRpbWVQcm90b1N0dWJVUkwpIHRocm93IG5ldyBFcnJvcignVGhlIHJ1bnRpbWVQcm90b1N0dWJVUkwgaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKICAgIGlmICghbWluaUJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyJyk7CiAgICBpZiAoIWNvbmZpZ3VyYXRpb24pIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZ3VyYXRpb24gaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXInKTsKICAgIC8vIGlmICghY29uZmlndXJhdGlvbi5wMnBIYW5kbGVyKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBwMnBIYW5kbGVyIGlzIGEgcmVxdWlyZWQgYXR0cmlidXRlIGluIHRoZSBjb25maWd1cmF0aW9uIHBhcmFtZXRlcicpOwoKICAgIGNvbnNvbGUubG9nKCcrW1AyUFJlcXVlc3RlclN0dWIuY29uc3RydWN0b3JdIGNvbmZpZyBpczogJywgY29uZmlndXJhdGlvbik7CiAgICB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMID0gcnVudGltZVByb3RvU3R1YlVSTDsKICAgIHRoaXMuX3J1bnRpbWVVUkwgPSBjb25maWd1cmF0aW9uLnJ1bnRpbWVVUkw7CiAgICB0aGlzLl9yZW1vdGVSdW50aW1lVVJMID0gY29uZmlndXJhdGlvbi5yZW1vdGVSdW50aW1lVVJMOyAvLyByZXF1aXJlZCBmb3Igc3RhdHVzIGV2ZW50cwogICAgdGhpcy5fY29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247CiAgICB0aGlzLl9idXMgPSBtaW5pQnVzOwogICAgdGhpcy5fYnVzLmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24gKG1zZykgewogICAgICBfdGhpcy5fc2VuZENoYW5uZWxNc2cobXNnKTsKICAgIH0pOwoKICAgIHRoaXMuX3N5bmNoZXIgPSBuZXcgX1N5bmNoZXIuU3luY2hlcihydW50aW1lUHJvdG9TdHViVVJMLCBtaW5pQnVzLCBjb25maWd1cmF0aW9uKTsKICAgIHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyID0gbmV3IF9Db25uZWN0aW9uQ29udHJvbGxlcjIuZGVmYXVsdCh0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMLCB0aGlzLl9zeW5jaGVyLCB0aGlzLl9jb25maWd1cmF0aW9uLCB0cnVlKTsKICAgIHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyLm9uU3RhdHVzVXBkYXRlKGZ1bmN0aW9uIChzdGF0dXMsIHJlYXNvbikgewogICAgICBfdGhpcy5fc2VuZFN0YXR1cyhzdGF0dXMsIHJlYXNvbik7CiAgICB9KTsKCiAgICB0aGlzLl9zeW5jaGVyLm9uTm90aWZpY2F0aW9uKGZ1bmN0aW9uIChldmVudCkgewogICAgICBjb25zb2xlLmxvZygnK1tQMlBSZXF1ZXN0ZXJTdHViXSBPbiBTeW5jaGVyIE5vdGlmaWNhdGlvbjogJywgZXZlbnQpOwogICAgICBldmVudC5hY2soMjAwKTsKCiAgICAgIHN3aXRjaCAoZXZlbnQudHlwZSkgewoKICAgICAgICBjYXNlICdjcmVhdGUnOgogICAgICAgICAgLy8gaW5jb21pbmcgb2JzZXJ2ZSBpbnZpdGF0aW9uIGZyb20gcGVlcgogICAgICAgICAgaWYgKF90aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcikgewogICAgICAgICAgICBfdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXIub2JzZXJ2ZShldmVudCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIitbUDJQUmVxdWVzdGVyU3R1Yl0gb2JzZXJ2ZXIgY3JlYXRlZCAiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnZGVsZXRlJzoKICAgICAgICAgIC8vIFRPRE86IHF1ZXN0aW9uIHJlZ2FyZGluZyBjb2RlIGluIENvbm5lY3RvcjogLS0+IHRoZXJlIGl0IGRlbGV0ZXMgYWxsIGNvbnRyb2xsZXJzIC0tPiB3aHk/CiAgICAgICAgICBjb25zb2xlLmxvZygiK1tQMlBSZXF1ZXN0ZXJTdHViXSBkZWxldGluZyBjb25uZWN0aW9uIGhhbmRsZXIgZm9yICIgKyBldmVudC5mcm9tKTsKCiAgICAgICAgICBkaXNjb25uZWN0KCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgfQogICAgfSk7CgogICAgdGhpcy5fc2VuZFN0YXR1cygiY3JlYXRlIik7CgogICAgLy8gdGhlIHRhcmdldCBoYW5kbGVyIHN0dWIgdXJsIG11c3QgYmUgcHJlc2VudCBpbiB0aGUgY29uZmlndXJhdGlvbiBhcyAicDJwSGFuZGxlciIgYXR0cmlidXRlCiAgICBpZiAodGhpcy5fY29uZmlndXJhdGlvbi5wMnBIYW5kbGVyKSB0aGlzLmNvbm5lY3QodGhpcy5fY29uZmlndXJhdGlvbi5wMnBIYW5kbGVyKTsKICB9CgogIF9jcmVhdGVDbGFzcyhQMlBSZXF1ZXN0ZXJTdHViLCBbewogICAga2V5OiAnY29ubmVjdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29ubmVjdChoYW5kbGVyVVJMKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5fY29ubmVjdGlvbkNvbnRyb2xsZXIucmVwb3J0KGhhbmRsZXJVUkwsIHRoaXMuX3J1bnRpbWVVUkwpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIC8vIHNlbmQgImluLXByb2dyZXNzIiBldmVudCwgaWYgdGhlIHN5bmNoZXIuY3JlYXRlIHdhcyBkb25lCiAgICAgICAgX3RoaXMyLl9zZW5kU3RhdHVzKCJpbi1wcm9ncmVzcyIpOwogICAgICAgIF90aGlzMi5fY29ubmVjdGlvbkNvbnRyb2xsZXIub25NZXNzYWdlKGZ1bmN0aW9uIChtKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiK1tQMlBSZXF1ZXN0ZXJTdHViXSBvbk1lc3NhZ2U6ICIsIG0pOwogICAgICAgICAgX3RoaXMyLl9kZWxpdmVyKG0pOwogICAgICAgIH0pOwogICAgICAgIGNvbnNvbGUubG9nKCIrW1AyUFJlcXVlc3RlclN0dWJdIHNldHVwIHJlcG9ydGVyIG9iamVjdCBzdWNjZXNzZnVsbHkiKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUbyBkaXNjb25uZWN0IHRoZSBwcm90b2NvbCBzdHViLgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2Rpc2Nvbm5lY3QnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2Nvbm5lY3QoKSB7CiAgICAgIGlmICh0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlcikgewogICAgICAgIHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyLmNsZWFudXAoKTsKICAgICAgICB0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlciA9IG51bGw7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc2VuZENoYW5uZWxNc2cnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZW5kQ2hhbm5lbE1zZyhtc2cpIHsKICAgICAgaWYgKHRoaXMuX2ZpbHRlcihtc2cpKSB7CiAgICAgICAgaWYgKHRoaXMuX2Nvbm5lY3Rpb25Db250cm9sbGVyKSB7CiAgICAgICAgICB0aGlzLl9jb25uZWN0aW9uQ29udHJvbGxlci5zZW5kTWVzc2FnZShKU09OLnN0cmluZ2lmeShtc2cpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfc2VuZFN0YXR1cycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbmRTdGF0dXModmFsdWUsIHJlYXNvbikgewogICAgICB2YXIgbXNnID0gewogICAgICAgIHR5cGU6ICd1cGRhdGUnLAogICAgICAgIGZyb206IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwsCiAgICAgICAgdG86IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgKyAnL3N0YXR1cycsCiAgICAgICAgYm9keTogewogICAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgICAgcmVzb3VyY2U6IHRoaXMuX3JlbW90ZVJ1bnRpbWVVUkwKICAgICAgICB9CiAgICAgIH07CiAgICAgIGlmIChyZWFzb24pIHsKICAgICAgICBtc2cuYm9keS5kZXNjID0gcmVhc29uOwogICAgICB9CiAgICAgIHRoaXMuX2J1cy5wb3N0TWVzc2FnZShtc2cpOwogICAgICBjb25zb2xlLmxvZygiK1tQMlByZXF1ZXN0ZXJTdHViXSBzZW5kaW5nIHN0YXR1cyB1cGRhdGU6ICIsIG1zZyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBGaWx0ZXIgbWV0aG9kIHRoYXQgc2hvdWxkIGJlIHVzZWQgZm9yIGV2ZXJ5IG1lc3NhZ2VzIGluIGRpcmVjdGlvbjogUHJvdG9zdHViIC0+IE1lc3NhZ2VOb2RlCiAgICAgKiBAcGFyYW0gIHtNZXNzYWdlfSBtc2cgT3JpZ2luYWwgbWVzc2FnZSBmcm9tIHRoZSBNZXNzYWdlQnVzCiAgICAgKiBAcmV0dXJuIHtib29sZWFufSB0cnVlIGlmIGl0J3MgdG8gYmUgZGVsaXZlciBpbiB0aGUgTWVzc2FnZU5vZGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdfZmlsdGVyJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlsdGVyKG1zZykgewogICAgICBpZiAobXNnLmJvZHkgJiYgbXNnLmJvZHkudmlhID09PSB0aGlzLl9ydW50aW1lUHJvdG9TdHViVVJMKSByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogTWV0aG9kIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gZGVsaXZlciB0aGUgbWVzc2FnZSBpbiBkaXJlY3Rpb246IFByb3Rvc3R1YiAtPiBNZXNzYWdlQnVzIChjb3JlKQogICAgICogQHBhcmFtICB7TWVzc2FnZX0gbXNnIE9yaWdpbmFsIG1lc3NhZ2UgZnJvbSB0aGUgTWVzc2FnZU5vZGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdfZGVsaXZlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGl2ZXIobXNnKSB7CiAgICAgIGNvbnNvbGUubG9nKCIrW1AyUHJlcXVlc3RlclN0dWJdIHBvc3RpbmcgbWVzc2FnZSB0byBtc2cgYnVzOiAiLCBtc2cpOwoKICAgICAgdmFyIG1lc3NhZ2UgPSBKU09OLnBhcnNlKG1zZy5kYXRhKTsKCiAgICAgIGlmICghbWVzc2FnZS5ib2R5KSBtc2cuYm9keSA9IHt9OwoKICAgICAgbWVzc2FnZS5ib2R5LnZpYSA9IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkw7CiAgICAgIHRoaXMuX2J1cy5wb3N0TWVzc2FnZShtZXNzYWdlKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBQMlBSZXF1ZXN0ZXJTdHViOwp9KCk7CgpmdW5jdGlvbiBhY3RpdmF0ZSh1cmwsIGJ1cywgY29uZmlnKSB7CiAgcmV0dXJuIHsKICAgIG5hbWU6ICdQMlBSZXF1ZXN0ZXJTdHViJywKICAgIGluc3RhbmNlOiBuZXcgUDJQUmVxdWVzdGVyU3R1Yih1cmwsIGJ1cywgY29uZmlnKQogIH07Cn0KbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi9Db25uZWN0aW9uQ29udHJvbGxlciI6MTIsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlciI6Mn1dfSx7fSxbMTNdKSgxMykKfSk7",
      "sourceCodeClassname": "P2PRequesterProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-63d99d6b-5450-81d4-ac0d-2455628f08d33",
    "version": 0.7999999999999999,
    "description": "Description of P2PRequesterProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "P2PRequesterProtoStub",
    "configuration": {
      "iceServers": [
        {
          "urls": "stun:stun.voiparound.com"
        },
        {
          "urls": "stun:stun.voipbuster.com"
        },
        {
          "urls": "stun:stun.voipstunt.com"
        },
        {
          "urls": "stun:stun.voxgratia.org"
        },
        {
          "urls": "stun:stun.ekiga.net"
        },
        {
          "urls": "stun:stun.schlund.de"
        },
        {
          "urls": "stun:stun.iptel.org"
        },
        {
          "urls": "stun:stun.l.google.com:19302"
        },
        {
          "urls": "stun:stun1.l.google.com:19302"
        },
        {
          "urls": "stun:stun.ideasip.com"
        },
        {
          "urls": "stun:stun4.l.google.com:19302"
        },
        {
          "urls": "stun:stun2.l.google.com:19302"
        },
        {
          "urls": "stun:stun3.l.google.com:19302"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=tcp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:192.158.29.39:3478?transport=udp",
          "credential": "JZEOEt2V3Qb0y27GRntt2u2PAYA=",
          "username": "28224511:1379330808"
        },
        {
          "urls": "turn:numb.viagenie.ca",
          "credential": "muazkh",
          "username": "webrtc@live.com"
        }
      ]
    },
    "messageSchemas": "",
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": "{ windowSandbox: true }",
    "interworking": false,
    "dataObjects": []
  },
  "slack.slack.com": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCWlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JykKCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQoJCWRlZmluZSgiYWN0aXZhdGUiLCBbXSwgZmFjdG9yeSk7CgllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JykKCQlleHBvcnRzWyJhY3RpdmF0ZSJdID0gZmFjdG9yeSgpOwoJZWxzZQoJCXJvb3RbImFjdGl2YXRlIl0gPSBmYWN0b3J5KCk7Cn0pKHRoaXMsIGZ1bmN0aW9uKCkgewpyZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsKCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewoKLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7CgovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewovKioqKioqLyAJCQlleHBvcnRzOiB7fSwKLyoqKioqKi8gCQkJaWQ6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsb2FkZWQ6IGZhbHNlCi8qKioqKiovIAkJfTsKCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7CgovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubG9hZGVkID0gdHJ1ZTsKCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9CgoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzOwoKLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwoKLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSAiIjsKCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwovKioqKioqLyB9KQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAoWwovKiAwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsKCglleHBvcnRzLmRlZmF1bHQgPSBhY3RpdmF0ZTsKCgl2YXIgX3NsYWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTsKCgl2YXIgX3NsYWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NsYWNrKTsKCgl2YXIgX1N5bmNoZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3Nyk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCgl2YXIgU2xhY2tQcm90b1N0dWIgPSBmdW5jdGlvbiAoKSB7CgkgIGZ1bmN0aW9uIFNsYWNrUHJvdG9TdHViKHJ1bnRpbWVQcm90b1N0dWJVUkwsIGJ1cywgY29uZmlnKSB7CgkgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNsYWNrUHJvdG9TdHViKTsKCgkgICAgaWYgKCFydW50aW1lUHJvdG9TdHViVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBydW50aW1lUHJvdG9TdHViVVJMIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoJICAgIGlmICghYnVzKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBidXMgaXMgYSBuZWVkZWQgcGFyYW1ldGVyJyk7CgkgICAgaWYgKCFjb25maWcpIHRocm93IG5ldyBFcnJvcignVGhlIGNvbmZpZyBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsKCgkgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gQ29uc3RydWN0b3IgTG9hZGVkJyk7CgoJICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgIHRoaXMuX3N1YnNjcmliZWRMaXN0ID0gW107CgkgICAgdGhpcy5fdXNlcnNMaXN0ID0gW107CgkgICAgdGhpcy5fZ3JvdXBzTGlzdCA9IFtdOwoJICAgIHRoaXMuX2NoYW5uZWxzTGlzdCA9IFtdOwoJICAgIHRoaXMuX2ltc0xpc3QgPSBbXTsKCSAgICB0aGlzLl9vYnNlcnZlcjsKCSAgICB0aGlzLl9jaGFubmVsSUQgPSAnJzsKCSAgICB0aGlzLl9pZCA9IDA7CgkgICAgdGhpcy5fY29udGludW91c09wZW4gPSB0cnVlOwoJICAgIHRoaXMuX3Rva2VuID0gJyc7CgoJICAgIHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgPSBydW50aW1lUHJvdG9TdHViVVJMOwoJICAgIHRoaXMuX2J1cyA9IGJ1czsKCSAgICB0aGlzLl9jb25maWcgPSBjb25maWc7CgoJICAgIHRoaXMuX3J1bnRpbWVTZXNzaW9uVVJMID0gY29uZmlnLnJ1bnRpbWVVUkw7CgkgICAgdGhpcy5fcmVPcGVuID0gZmFsc2U7CgkgICAgdGhpcy5fc2xhY2sgPSBfc2xhY2syLmRlZmF1bHQ7CgkgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gaW5zdGF0aWF0ZSBzeW5jaGVyIHdpdGggcnVudGltZVVybCcsIHJ1bnRpbWVQcm90b1N0dWJVUkwpOwoJICAgIHRoaXMuX3N5bmNoZXIgPSBuZXcgX1N5bmNoZXIuU3luY2hlcihydW50aW1lUHJvdG9TdHViVVJMLCBidXMsIGNvbmZpZyk7CgoJICAgIHRoaXMuX3N5bmNoZXIub25Ob3RpZmljYXRpb24oZnVuY3Rpb24gKGV2ZW50KSB7CgkgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBPbiBTeW5jaGVyIE5vdGlmaWNhdGlvbicsIGV2ZW50KTsKCSAgICB9KTsKCgkgICAgYnVzLmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24gKG1zZykgewoJICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gbmV3IG1zZycsIG1zZyk7CgkgICAgICBpZiAobXNnLmJvZHkuaGFzT3duUHJvcGVydHkoJ2lkZW50aXR5JykgJiYgbXNnLmJvZHkuaWRlbnRpdHkuaGFzT3duUHJvcGVydHkoJ2FjY2Vzc190b2tlbicpICYmIG1zZy5ib2R5LmlkZW50aXR5LmFjY2Vzc190b2tlbikgewoKCSAgICAgICAgdmFyIHRva2VuID0gbXNnLmJvZHkuaWRlbnRpdHkuYWNjZXNzX3Rva2VuOwoJICAgICAgICBfdGhpcy5fb3Blbih0b2tlbiwgZnVuY3Rpb24gKCkgewoJICAgICAgICAgIGlmIChfdGhpcy5fZmlsdGVyKG1zZykpIHsKCgkgICAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBBZnRlciBGaWx0ZXInLCBtc2cpOwoJICAgICAgICAgICAgdmFyIHNjaGVtYVVybCA9IG1zZy5ib2R5LnNjaGVtYTsKCSAgICAgICAgICAgIGlmIChzY2hlbWFVcmwgJiYgbXNnLmJvZHkudmFsdWUubmFtZSkgewoKCSAgICAgICAgICAgICAgdmFyIHNjaGVtYVNwbGl0dGVkID0gc2NoZW1hVXJsLnNwbGl0KCcvJyk7CgoJICAgICAgICAgICAgICBpZiAoc2NoZW1hU3BsaXR0ZWRbc2NoZW1hU3BsaXR0ZWQubGVuZ3RoIC0gMV0gPT09ICdDb21tdW5pY2F0aW9uJykgewoJICAgICAgICAgICAgICAgIF90aGlzLl9zdWJzY3JpYmUoc2NoZW1hVXJsLCBtc2cuZnJvbSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CgkgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBzdWJzY3JpYmUgcmVzdWx0JywgcmVzdWx0KTsKCSAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHsKCSAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3Rva2VuID0gdG9rZW47CgkgICAgICAgICAgICAgICAgICAgIGlmIChtc2cuYm9keS5pZGVudGl0eS51c2VyUHJvZmlsZS5pZCkgewoJICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9pZCA9IG1zZy5ib2R5LmlkZW50aXR5LnVzZXJQcm9maWxlLmlkOwoJICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgICAgICB2YXIgVVJMVXNlcnNMaXN0ID0gJ2h0dHBzOi8vc2xhY2suY29tL2FwaS91c2Vycy5saXN0P3Rva2VuPScgKyBfdGhpcy5fdG9rZW47CgkgICAgICAgICAgICAgICAgICAgIC8vbGV0IFVSTEdyb3Vwc0xpc3QgPSAnaHR0cHM6Ly9zbGFjay5jb20vYXBpL2dyb3Vwcy5saXN0P3Rva2VuPScgKyBfdGhpcy5fdG9rZW47CgkgICAgICAgICAgICAgICAgICAgIHZhciBVUkxDaGFubmVsc0xpc3QgPSAnaHR0cHM6Ly9zbGFjay5jb20vYXBpL2NoYW5uZWxzLmxpc3Q/dG9rZW49JyArIF90aGlzLl90b2tlbjsKCSAgICAgICAgICAgICAgICAgICAgLy9sZXQgVVJMSW1zTGlzdCA9ICdodHRwczovL3NsYWNrLmNvbS9hcGkvaW0ubGlzdD90b2tlbj0nICsgX3RoaXMuX3Rva2VuOwoKCSAgICAgICAgICAgICAgICAgICAgdmFyIFVzZXJzTGlzdFByb21pc2UgPSBfdGhpcy5fc2VuZEhUVFBSZXF1ZXN0KCdHRVQnLCBVUkxVc2Vyc0xpc3QpOwoJICAgICAgICAgICAgICAgICAgICAvL2xldCBHcm91cHNMaXN0UHJvbWlzZSA9IF90aGlzLl9zZW5kSFRUUFJlcXVlc3QoJ0dFVCcsIFVSTEdyb3Vwc0xpc3QpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgQ2hhbm5lbHNMaXN0UHJvbWlzZSA9IF90aGlzLl9zZW5kSFRUUFJlcXVlc3QoJ0dFVCcsIFVSTENoYW5uZWxzTGlzdCk7CgkgICAgICAgICAgICAgICAgICAgIC8vbGV0IEltc0xpc3RQcm9taXNlID0gX3RoaXMuX3NlbmRIVFRQUmVxdWVzdCgnR0VUJywgVVJMSW1zTGlzdCk7CgoKCSAgICAgICAgICAgICAgICAgICAgUHJvbWlzZS5hbGwoW1VzZXJzTGlzdFByb21pc2UsIENoYW5uZWxzTGlzdFByb21pc2VdKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fdXNlcnNMaXN0ID0gcmVzdWx0WzBdLm1lbWJlcnM7CgkgICAgICAgICAgICAgICAgICAgICAgLy9fdGhpcy5fZ3JvdXBzTGlzdCA9IHJlc3VsdFsxXS5ncm91cHM7CgkgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2NoYW5uZWxzTGlzdCA9IHJlc3VsdFsxXS5jaGFubmVsczsKCSAgICAgICAgICAgICAgICAgICAgICAvL190aGlzLl9pbXNMaXN0ID0gcmVzdWx0WzNdLmltczsKCgkgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoYW5uZWxFeGlzdHMgPSBfdGhpcy5fY2hhbm5lbHNMaXN0LmZpbHRlcihmdW5jdGlvbiAodmFsdWUsIGtleSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLm5hbWUgPT09IG1zZy5ib2R5LnZhbHVlLm5hbWU7CgkgICAgICAgICAgICAgICAgICAgICAgfSlbMF07CgoJICAgICAgICAgICAgICAgICAgICAgIC8vZ2V0IHVzZXJJRCB0byBpbnZpdGUKCSAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9TcGxpdHRlZCA9IG1zZy50by5zcGxpdCgnOi8vJylbMV07CgkgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXIgPSB0b1NwbGl0dGVkLnNwbGl0KCdAJylbMF07CgkgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJJRCA9IF90aGlzLl91c2Vyc0xpc3QuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUubmFtZSA9PT0gdXNlcjsKCSAgICAgICAgICAgICAgICAgICAgICB9KVswXS5pZDsKCgkgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgY2hhbm5lbCBleGlzdCwgaW52aXRlIHVzZXIsIGVsc2UgY2hhbm5lbCBuZWVkIHRvIGJlIGNyZWF0ZWQgYW5kIHRoZW4gaW52aXRlIHVzZXIKCSAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbm5lbEV4aXN0cykgewoJICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gY2hhbm5lbCBleGlzdCcsIGNoYW5uZWxFeGlzdHMpOwoKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGFubmVsTWVtYmVycyA9IF90aGlzLl9jaGFubmVsc0xpc3QuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5uYW1lID09PSBtc2cuYm9keS52YWx1ZS5uYW1lOwoJICAgICAgICAgICAgICAgICAgICAgICAgfSlbMF0ubWVtYmVyczsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbHJlYWR5T25DaGFubmVsID0gZmFsc2U7CgoJICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbE1lbWJlcnMuZm9yRWFjaChmdW5jdGlvbiAocykgewoJICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocyA9PT0gdXNlcklEKSBhbHJlYWR5T25DaGFubmVsID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gY2hhbm5lbCBtZW1iZXJzJywgY2hhbm5lbE1lbWJlcnMsICcgICAtPicsIGFscmVhZHlPbkNoYW5uZWwpOwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgdXNlciBpc250IG9uIENoYW5uZWwgaW52aXRlLCBlbHNlIGp1c3Qgc2V0IGNoYW5uZWxJRAoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbHJlYWR5T25DaGFubmVsKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9pbnZpdGUodXNlcklELCBjaGFubmVsRXhpc3RzLmlkKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9jaGFubmVsSUQgPSBjaGFubmVsRXhpc3RzLmlkOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fY3JlYXRlKG1zZy5ib2R5LnZhbHVlLm5hbWUsIHVzZXJJRCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5faW52aXRlKHVzZXJJRCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7CgkgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnIoJ1tTbGFja1Byb3Rvc3R1Yl0gJywgZXJyb3IpOwoJICAgICAgICAgICAgICAgICAgICB9KTsKCSAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9KTsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0KCSAgICAgICAgfSk7CgkgICAgICB9CgkgICAgfSk7CgkgIH0KCgkgIF9jcmVhdGVDbGFzcyhTbGFja1Byb3RvU3R1YiwgW3sKCSAgICBrZXk6ICdfZmlsdGVyJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbHRlcihtc2cpIHsKCSAgICAgIGlmIChtc2cuYm9keSAmJiBtc2cuYm9keS52aWEgPT09IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwpIHJldHVybiBmYWxzZTsKCSAgICAgIHJldHVybiB0cnVlOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19vcGVuJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29wZW4odG9rZW4sIGNhbGxiYWNrKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIGlmICghX3RoaXMuX3Nlc3Npb24pIHsKCSAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gbmV3IFNlc3Npb24gZm9yIHRva2VuOicsIHRva2VuKTsKCSAgICAgICAgX3RoaXMuX3Nlc3Npb24gPSBfdGhpcy5fc2xhY2sucnRtLmNsaWVudCgpOwoKCSAgICAgICAgX3RoaXMuX3Nlc3Npb24ubGlzdGVuKHsgdG9rZW46IHRva2VuIH0pOwoKCSAgICAgICAgX3RoaXMuX3Nlc3Npb24ubWVzc2FnZShmdW5jdGlvbiAobWVzc2FnZSkgewoJICAgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIG5ldyBtZXNzYWdlIG9uIHNlc3Npb24nLCBtZXNzYWdlKTsKCSAgICAgICAgICBpZiAobWVzc2FnZS5jaGFubmVsKSB7CgkgICAgICAgICAgICBpZiAobWVzc2FnZS5jaGFubmVsID09PSBfdGhpcy5fY2hhbm5lbElEICYmIG1lc3NhZ2UudXNlciAhPT0gX3RoaXMuX2lkIHx8ICFtZXNzYWdlLmhhc093blByb3BlcnR5KCdib3RfaWQnKSAmJiBtZXNzYWdlLnVzZXIgPT09IF90aGlzLl9pZCAmJiBtZXNzYWdlLmNoYW5uZWwgPT09IF90aGlzLl9jaGFubmVsSUQpIHsKCgkgICAgICAgICAgICAgIF90aGlzLl9vYnNlcnZlci5hZGRDaGlsZCgnY2hhdG1lc3NhZ2VzJywgeyBtZXNzYWdlOiBtZXNzYWdlLnRleHQgfSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdbU2xhY2tQcm90b3N0dWJdIHNlc3Npb24gYWxyZWFkeSBleGlzdCcpOwoJICAgICAgfQoJICAgICAgY2FsbGJhY2soKTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfc3Vic2NyaWJlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3N1YnNjcmliZShzY2hlbWEsIHVybERhdGFPYmopIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CgoJICAgICAgICBfdGhpcy5fc3Vic2NyaWJlZExpc3QuZm9yRWFjaChmdW5jdGlvbiAob2JqKSB7CgkgICAgICAgICAgaWYgKG9iai51cmxEYXRhT2JqID09PSB1cmxEYXRhT2JqICYmIG9iai5zdWJzY3JpYmVkKSByZXNvbHZlKHRydWUpOwoJICAgICAgICB9KTsKCgkgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSB7IHVybERhdGFPYmo6IHVybERhdGFPYmosIHNjaGVtYTogc2NoZW1hLCBzdWJzY3JpYmVkOiB0cnVlIH07CgoJICAgICAgICB2YXIgb2JqZWN0RGVzY1VSTCA9IHNjaGVtYTsKCSAgICAgICAgdmFyIGRhdGFPYmplY3RVcmwgPSB1cmxEYXRhT2JqLnN1YnN0cmluZygwLCB1cmxEYXRhT2JqLmxhc3RJbmRleE9mKCcvJykpOwoKCSAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gbmV3IHN1YnNjcmlwdGlvbiBmb3Igc2NoZW1hOicsIG9iamVjdERlc2NVUkwsICcgYW5kIGRhdGFPYmplY3Q6JywgZGF0YU9iamVjdFVybCk7CgoJICAgICAgICByZXR1cm4gX3RoaXMuX3N5bmNoZXIuc3Vic2NyaWJlKG9iamVjdERlc2NVUkwsIGRhdGFPYmplY3RVcmwsIGZhbHNlLCBmYWxzZSwgZmFsc2UpLnRoZW4oZnVuY3Rpb24gKG9ic2VydmVyKSB7CgkgICAgICAgICAgX3RoaXMuX29ic2VydmVyID0gb2JzZXJ2ZXI7CgkgICAgICAgICAgX3RoaXMuX3N1YnNjcmliZWRMaXN0LnB1c2goc3Vic2NyaXB0aW9uKTsKCSAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBzdWJzY3JpYmVkJywgZGF0YU9iamVjdFVybCk7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gT2JzZXJ2ZXInLCBvYnNlcnZlcik7CgkgICAgICAgICAgb2JzZXJ2ZXIub25BZGRDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHsKCSAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnW1NsYWNrUHJvdG9zdHViXSBPYnNlcnZlciAtIEFkZCBDaGlsZDogJywgY2hpbGQpOwoJICAgICAgICAgICAgX3RoaXMuX2RlbGl2ZXIoY2hpbGQpOwoJICAgICAgICAgIH0pOwoKCSAgICAgICAgICBvYnNlcnZlci5vbkNoYW5nZSgnKicsIGZ1bmN0aW9uIChldmVudCkgewoJICAgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gT2JzZXJ2ZXIgLSBvbkNoYW5nZTogJywgZXZlbnQpOwoJICAgICAgICAgIH0pOwoJICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CgkgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewoJICAgICAgICAgIGNvbnNvbGUuZXJyKCdbU2xhY2tQcm90b3N0dWJdIFN1YnNjcmliZScsIGVycm9yKTsKCSAgICAgICAgICByZXNvbHZlKGZhbHNlKTsKCSAgICAgICAgfSk7CgkgICAgICB9KTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfaW52aXRlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2ludml0ZShpZFVzZXIsIGlkQ2hhbm5lbCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBpZiAoIWlkQ2hhbm5lbCkgewoJICAgICAgICBpZENoYW5uZWwgPSBfdGhpcy5fY2hhbm5lbElEOwoJICAgICAgfQoKCSAgICAgIHZhciB0b0ludml0ZSA9IHsgdG9rZW46IF90aGlzLl90b2tlbiwgY2hhbm5lbDogaWRDaGFubmVsLCB1c2VyOiBpZFVzZXIgfTsKCgkgICAgICBfdGhpcy5fc2xhY2suY2hhbm5lbHMuaW52aXRlKHRvSW52aXRlLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7CgkgICAgICAgIGlmIChlcnIpIHsKCSAgICAgICAgICBjb25zb2xlLmVycignW1NsYWNrUHJvdG9zdHViXSBlcnJvcicsIGVycik7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgX3RoaXMuX2NoYW5uZWxJRCA9IGlkQ2hhbm5lbDsKCSAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSB1c2VyIGludml0ZWQgd2l0aCBzdWNlc3MnLCBkYXRhKTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2RlbGl2ZXInLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsaXZlcihjaGlsZCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBpZiAoX3RoaXMuX2NoYW5uZWxJRCAhPT0gJycgJiYgY2hpbGQudmFsdWUubWVzc2FnZSkgewoKCSAgICAgICAgaWYgKGNoaWxkLmhhc093blByb3BlcnR5KCdpZGVudGl0eScpICYmIGNoaWxkLmlkZW50aXR5Lmhhc093blByb3BlcnR5KCd1c2VyUHJvZmlsZScpICYmIGNoaWxkLmlkZW50aXR5LnVzZXJQcm9maWxlLmhhc093blByb3BlcnR5KCd1c2VybmFtZScpICYmIGNoaWxkLmlkZW50aXR5LnVzZXJQcm9maWxlLnVzZXJuYW1lKSB7CgoJICAgICAgICAgIHZhciB0ZXh0ID0gJycgKyBjaGlsZC5pZGVudGl0eS51c2VyUHJvZmlsZS51c2VybmFtZSArICc6ICcgKyBjaGlsZC52YWx1ZS5tZXNzYWdlOwoJICAgICAgICAgIHZhciBtZXNzYWdlID0geyBhc191c2VyOiB0cnVlLCB0b2tlbjogX3RoaXMuX3Rva2VuLCBjaGFubmVsOiBfdGhpcy5fY2hhbm5lbElELCB0ZXh0OiB0ZXh0IH07CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gKFBvc3RNZXNzYWdlIHNsYWNrIGFwaSkgdG9rZW4oJywgX3RoaXMuX3Rva2VuLCAnKSAgY2hhbm5lbCgnLCBfdGhpcy5fY2hhbm5lbElELCAnKSB0ZXh0KCcsIGNoaWxkLnZhbHVlLm1lc3NhZ2UsICcpJyk7CgoJICAgICAgICAgIF90aGlzLl9zbGFjay5jaGF0LnBvc3RNZXNzYWdlKG1lc3NhZ2UsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKCSAgICAgICAgICAgIGlmIChlcnIpIHsKCSAgICAgICAgICAgICAgY29uc29sZS5lcnIoJ1tTbGFja1Byb3Rvc3R1Yl0gZXJyb3InLCBlcnIpOwoJICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tTbGFja1Byb3Rvc3R1Yl0gUG9zdE1lc3NhZ2Ugd2l0aCBTdWNlc3MnLCBkYXRhKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9KTsKCSAgICAgICAgfQoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19jcmVhdGUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfY3JlYXRlKGNoYW5uZWxOYW1lKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewoJICAgICAgICB2YXIgdG9DcmVhdGUgPSB7IHRva2VuOiBfdGhpcy5fdG9rZW4sIG5hbWU6IGNoYW5uZWxOYW1lIH07CgkgICAgICAgIF90aGlzLl9zbGFjay5jaGFubmVscy5jcmVhdGUodG9DcmVhdGUsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKCSAgICAgICAgICBpZiAoZXJyKSB7CgkgICAgICAgICAgICBjb25zb2xlLmVycignW1NsYWNrUHJvdG9zdHViXSAnLCBlcnIpOwoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBpZiAoZGF0YS5vaykgewoJICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW1NsYWNrUHJvdG9zdHViXSBDaGFubmVsIENyZWF0ZWQgd2l0aCBTdWNlc3MgJywgZGF0YSk7CgkgICAgICAgICAgICAgIF90aGlzLl9jaGFubmVsSUQgPSBkYXRhLmNoYW5uZWwuaWQ7CgkgICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19zZW5kSFRUUFJlcXVlc3QnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VuZEhUVFBSZXF1ZXN0KG1ldGhvZCwgdXJsKSB7CgkgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoJICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CgkgICAgICAgIGlmICgnd2l0aENyZWRlbnRpYWxzJyBpbiB4aHIpIHsKCSAgICAgICAgICB4aHIub3BlbihtZXRob2QsIHVybCwgdHJ1ZSk7CgkgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIFhEb21haW5SZXF1ZXN0ICE9PSAndW5kZWZpbmVkJykgewoJICAgICAgICAgIC8vIE90aGVyd2lzZSwgY2hlY2sgaWYgWERvbWFpblJlcXVlc3QuCgkgICAgICAgICAgLy8gWERvbWFpblJlcXVlc3Qgb25seSBleGlzdHMgaW4gSUUsIGFuZCBpcyBJRSdzIHdheSBvZiBtYWtpbmcgQ09SUyByZXF1ZXN0cy4KCSAgICAgICAgICB4aHIgPSBuZXcgWERvbWFpblJlcXVlc3QoKTsKCSAgICAgICAgICB4aHIub3BlbihtZXRob2QsIHVybCk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgLy8gT3RoZXJ3aXNlLCBDT1JTIGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhlIGJyb3dzZXIuCgkgICAgICAgICAgeGhyID0gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoeGhyKSB7CgkgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQpIHsKCSAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPT09IDIwMCkgewoJICAgICAgICAgICAgICAgIHZhciBpbmZvID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTsKCSAgICAgICAgICAgICAgICByZXNvbHZlKGluZm8pOwoJICAgICAgICAgICAgICB9IGVsc2UgaWYgKHhoci5zdGF0dXMgPT09IDQwMCkgewoJICAgICAgICAgICAgICAgIHJlamVjdCgnVGhlcmUgd2FzIGFuIGVycm9yIHByb2Nlc3NpbmcgdGhlIHRva2VuJyk7CgkgICAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgICAgcmVqZWN0KCdzb21ldGhpbmcgZWxzZSBvdGhlciB0aGFuIDIwMCB3YXMgcmV0dXJuZWQnKTsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgIH07CgkgICAgICAgICAgeGhyLnNlbmQoKTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICByZWplY3QoJ0NPUlMgbm90IHN1cHBvcnRlZCcpOwoJICAgICAgICB9CgkgICAgICB9KTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdjb25maWcnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZzsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdydW50aW1lU2Vzc2lvbicsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fcnVudGltZVNlc3Npb25VUkw7CgkgICAgfQoJICB9XSk7CgoJICByZXR1cm4gU2xhY2tQcm90b1N0dWI7Cgl9KCk7CgoJZnVuY3Rpb24gYWN0aXZhdGUodXJsLCBidXMsIGNvbmZpZykgewoJICByZXR1cm4gewoJICAgIG5hbWU6ICdTbGFja1Byb3RvU3R1YicsCgkgICAgaW5zdGFuY2U6IG5ldyBTbGFja1Byb3RvU3R1Yih1cmwsIGJ1cywgY29uZmlnKQoJICB9OwoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2FwaSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7CgoJdmFyIF9hcGkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXBpKTsKCgl2YXIgX2FwaTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKCgl2YXIgX2FwaTQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hcGkzKTsKCgl2YXIgX2JvdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1OCk7CgoJdmFyIF9ib3RzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2JvdHMpOwoKCXZhciBfYXV0aCA9IF9fd2VicGFja19yZXF1aXJlX18oNTIpOwoKCXZhciBfYXV0aDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hdXRoKTsKCgl2YXIgX2NoYW5uZWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTkpOwoKCXZhciBfY2hhbm5lbHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMpOwoKCXZhciBfY2hhdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTYwKTsKCgl2YXIgX2NoYXQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhdCk7CgoJdmFyIF9kbmQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2MSk7CgoJdmFyIF9kbmQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZG5kKTsKCgl2YXIgX2Vtb2ppID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3OCk7CgoJdmFyIF9lbW9qaTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9lbW9qaSk7CgoJdmFyIF9maWxlcyA9IF9fd2VicGFja19yZXF1aXJlX18oMTYyKTsKCgl2YXIgX2ZpbGVzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZpbGVzKTsKCgl2YXIgX2dyb3VwcyA9IF9fd2VicGFja19yZXF1aXJlX18oMTYzKTsKCgl2YXIgX2dyb3VwczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMpOwoKCXZhciBfaW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2NCk7CgoJdmFyIF9pbTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbSk7CgoJdmFyIF9tcGltID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNjUpOwoKCXZhciBfbXBpbTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tcGltKTsKCgl2YXIgX29hdXRoID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNjYpOwoKCXZhciBfb2F1dGgyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfb2F1dGgpOwoKCXZhciBfcmVhY3Rpb25zID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNjcpOwoKCXZhciBfcmVhY3Rpb25zMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0aW9ucyk7CgoJdmFyIF9yZW1pbmRlcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2OCk7CgoJdmFyIF9yZW1pbmRlcnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVtaW5kZXJzKTsKCgl2YXIgX3BpbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2OSk7CgoJdmFyIF9waW5zMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BpbnMpOwoKCXZhciBfcnRtID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNzApOwoKCXZhciBfcnRtMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3J0bSk7CgoJdmFyIF9ydG0zID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjkpOwoKCXZhciBfcnRtNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3J0bTMpOwoKCXZhciBfc2VhcmNoID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNzIpOwoKCXZhciBfc2VhcmNoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NlYXJjaCk7CgoJdmFyIF9zdGFycyA9IF9fd2VicGFja19yZXF1aXJlX18oMTczKTsKCgl2YXIgX3N0YXJzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0YXJzKTsKCgl2YXIgX3RlYW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3NCk7CgoJdmFyIF90ZWFtMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RlYW0pOwoKCXZhciBfdXNlcmdyb3VwcyA9IF9fd2VicGFja19yZXF1aXJlX18oMTc1KTsKCgl2YXIgX3VzZXJncm91cHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcmdyb3Vwcyk7CgoJdmFyIF91c2VycyA9IF9fd2VicGFja19yZXF1aXJlX18oMTc2KTsKCgl2YXIgX3VzZXJzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJzKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCXZhciBkZXNjcmliZSA9ICdcbiAgc2xhY2tcbiAgICBhcGkuY2xpZW50KHRva2VuKVxuICAgIGFwaS50ZXN0KHBhcmFtcywgKGVyciwgZGF0YSk9PilcbiAgICBhdXRoLnRlc3QodG9rZW4sIChlcnIsIGRhdGEpPT4pXG4gICAgYm90cy5pbmZvXG4gICAgY2hhbm5lbHMuYXJjaGl2ZSh7dG9rZW4sIGNoYW5uZWx9LCAoZXJyLCBkYXRhKT0+KVxuICAgIGNoYW5uZWxzLmNyZWF0ZSh7dG9rZW4sIG5hbWV9LCAoZXJyLCBkYXRhKT0+KVxuICAgIGNoYW5uZWxzLmhpc3Rvcnkoe3Rva2VuLCBjaGFubmVsfSwgKGVyciwgZGF0YSk9PilcbiAgICBjaGFubmVscy5pbmZvXG4gICAgY2hhbm5lbHMuaW52aXRlXG4gICAgY2hhbm5lbHMuam9pblxuICAgIGNoYW5uZWxzLmtpY2tcbiAgICBjaGFubmVscy5sZWF2ZVxuICAgIGNoYW5uZWxzLmxpc3Qoe3Rva2VuLCBleGNsdWRlX2FyY2hpdmVkfSwgKGVyciwgZGF0YSk9PilcbiAgICBjaGFubmVscy5tYXJrXG4gICAgY2hhbm5lbHMucmVuYW1lXG4gICAgY2hhbm5lbHMuc2V0UHVycG9zZVxuICAgIGNoYW5uZWxzLnNldFRvcGljXG4gICAgY2hhbm5lbHMudW5hcmNoaXZlXG4gICAgY2hhdC5kZWxldGVcbiAgICBjaGF0LnBvc3RNZXNzYWdlKHt0b2tlbiwgdGV4dCwgY2hhbm5lbH0sIChlcnIsIGRhdGEpPT4pXG4gICAgY2hhdC51cGRhdGVcbiAgICBlbW9qaS5saXN0XG4gICAgZmlsZXMuZGVsZXRlXG4gICAgZmlsZXMuaW5mb1xuICAgIGZpbGVzLmxpc3RcbiAgICBmaWxlcy51cGxvYWRcbiAgICBncm91cHMuYXJjaGl2ZVxuICAgIGdyb3Vwcy5jbG9zZVxuICAgIGdyb3Vwcy5jcmVhdGVcbiAgICBncm91cHMuY3JlYXRlQ2hpbGRcbiAgICBncm91cHMuaGlzdG9yeVxuICAgIGdyb3Vwcy5pbmZvXG4gICAgZ3JvdXBzLmludml0ZVxuICAgIGdyb3Vwcy5raWNrXG4gICAgZ3JvdXBzLmxlYXZlXG4gICAgZ3JvdXBzLmxpc3RcbiAgICBncm91cHMubWFya1xuICAgIGdyb3Vwcy5vcGVuXG4gICAgZ3JvdXBzLnJlbmFtZVxuICAgIGdyb3Vwcy5zZXRQdXJwb3NlXG4gICAgZ3JvdXBzLnNldFRvcGljXG4gICAgZ3JvdXBzLnVuYXJjaGl2ZVxuICAgIGltLmNsb3NlXG4gICAgaW0uaGlzdG9yeVxuICAgIGltLmxpc3RcbiAgICBpbS5tYXJrXG4gICAgaW0ub3BlblxuICAgIG1waW0uY2xvc2VcbiAgICBtcGltLmhpc3RvcnlcbiAgICBtcGltLmxpc3RcbiAgICBtcGltLm1hcmtcbiAgICBtcGltLm9wZW5cbiAgICBvYXV0aC5hY2Nlc3Moe2NsaWVudF9pZCwgY2xpZW50X3NlY3JldCwgY29kZX0sIChlcnIsIGRhdGEpPT4pXG4gICAgcGlucy5hZGRcbiAgICBwaW5zLmxpc3RcbiAgICBwaW5zLnJlbW92ZVxuICAgIHJlYWN0aW9ucy5hZGRcbiAgICByZWFjdGlvbnMuZ2V0XG4gICAgcmVhY3Rpb25zLmxpc3RcbiAgICByZWFjdGlvbnMucmVtb3ZlXG4gICAgcmVtaW5kZXJzLmFkZFxuICAgIHJlbWluZGVycy5jb21wbGV0ZVxuICAgIHJlbWluZGVycy5kZWxldGVcbiAgICByZW1pbmRlcnMuaW5mb1xuICAgIHJlbWluZGVycy5saXN0XG4gICAgcnRtLmNsaWVudCgpXG4gICAgcnRtLnN0YXJ0KHt0b2tlbn0sIChlcnIsIGRhdGEpPT4pXG4gICAgc2VhcmNoLmFsbFxuICAgIHNlYXJjaC5maWxlc1xuICAgIHNlYXJjaC5tZXNzYWdlc1xuICAgIHN0YXJzLmFkZFxuICAgIHN0YXJzLmxpc3RcbiAgICBzdGFycy5yZW1vdmVcbiAgICB0ZWFtLmFjY2Nlc3NMb2dzXG4gICAgdGVhbS5iaWxsYWJsZUluZm9cbiAgICB0ZWFtLmluZm8odG9rZW4sIChlcnIsIGRhdGEpPT4pXG4gICAgdGVhbS5pbnRlZ3JhdGlvbkxvZ3NcbiAgICB0ZWFtLnByb2ZpbGUuZ2V0XG4gICAgdXNlcmdyb3Vwcy5jcmVhdGVcbiAgICB1c2VyZ3JvdXBzLmRpc2FibGVcbiAgICB1c2VyZ3JvdXBzLmVuYWJsZVxuICAgIHVzZXJncm91cHMubGlzdFxuICAgIHVzZXJncm91cHMudXBkYXRlXG4gICAgdXNlcmdyb3Vwcy51c2Vycy5saXN0XG4gICAgdXNlcmdyb3Vwcy51c2Vycy51cGRhdGVcbiAgICB1c2Vycy5nZXRQcmVzZW5jZVxuICAgIHVzZXJzLmlkZW50aXR5XG4gICAgdXNlcnMuaW5mb1xuICAgIHVzZXJzLmxpc3QodG9rZW4sIChlcnIsIGRhdGEpPT4pXG4gICAgdXNlcnMuc2V0QWN0aXZlXG4gICAgdXNlcnMuc2V0UHJlc2VuY2Vcbic7CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBkZXNjcmliZTogZGVzY3JpYmUsCgkgIGFwaTogeyB0ZXN0OiBfYXBpMi5kZWZhdWx0LCBjbGllbnQ6IF9hcGk0LmRlZmF1bHQgfSwKCSAgYXV0aDogeyB0ZXN0OiBfYXV0aDIuZGVmYXVsdCB9LAoJICBib3RzOiBfYm90czIuZGVmYXVsdCwKCSAgY2hhbm5lbHM6IF9jaGFubmVsczIuZGVmYXVsdCwKCSAgY2hhdDogX2NoYXQyLmRlZmF1bHQsCgkgIGRuZDogX2RuZDIuZGVmYXVsdCwKCSAgZW1vamk6IHsgbGlzdDogX2Vtb2ppMi5kZWZhdWx0IH0sCgkgIGZpbGVzOiBfZmlsZXMyLmRlZmF1bHQsCgkgIGdyb3VwczogX2dyb3VwczIuZGVmYXVsdCwKCSAgaW06IF9pbTIuZGVmYXVsdCwKCSAgbXBpbTogX21waW0yLmRlZmF1bHQsCgkgIG9hdXRoOiB7IGFjY2VzczogX29hdXRoMi5kZWZhdWx0IH0sCgkgIHJlYWN0aW9uczogX3JlYWN0aW9uczIuZGVmYXVsdCwKCSAgcmVtaW5kZXJzOiBfcmVtaW5kZXJzMi5kZWZhdWx0LAoJICBwaW5zOiBfcGluczIuZGVmYXVsdCwKCSAgcnRtOiB7IGNsaWVudDogX3J0bTIuZGVmYXVsdCwgc3RhcnQ6IF9ydG00LmRlZmF1bHQgfSwKCSAgc2VhcmNoOiBfc2VhcmNoMi5kZWZhdWx0LAoJICBzdGFyczogX3N0YXJzMi5kZWZhdWx0LAoJICB0ZWFtOiBfdGVhbTIuZGVmYXVsdCwKCSAgdXNlcmdyb3VwczogX3VzZXJncm91cHMyLmRlZmF1bHQsCgkgIHVzZXJzOiBfdXNlcnMyLmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gYXBpdGVzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gYXBpdGVzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdhcGkudGVzdCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsKCglleHBvcnRzLmRlZmF1bHQgPSBleGVjOwoKCXZhciBfdGlueUpzb25IdHRwID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsKCgl2YXIgX3RpbnlKc29uSHR0cDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90aW55SnNvbkh0dHApOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZnVuY3Rpb24gZXhlYyh1cmwsIGZvcm0sIGNhbGxiYWNrKSB7CgoJICAvLyBzdHJpbmdpZnkgYW55IG9iamVjdHMgdW5kZXIga2V5cyBzaW5jZSBmb3JtIGlzIHBvc3RlZCBhcyBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQKCSAgT2JqZWN0LmtleXMoZm9ybSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CgkgICAgaWYgKF90eXBlb2YoZm9ybVtrZXldKSA9PT0gJ29iamVjdCcpIHsKCSAgICAgIGZvcm1ba2V5XSA9IEpTT04uc3RyaW5naWZ5KGZvcm1ba2V5XSk7CgkgICAgfQoJICB9KTsKCgkgIC8vIGFsd2F5cyBwb3N0CgkgIF90aW55SnNvbkh0dHAyLmRlZmF1bHQucG9zdCh7CgkgICAgdXJsOiAnaHR0cHM6Ly9zbGFjay5jb20vYXBpLycgKyB1cmwsCgkgICAgaGVhZGVyczogewoJICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnCgkgICAgfSwKCSAgICBkYXRhOiBmb3JtCgkgIH0sIGZ1bmN0aW9uIF9yZXMoZXJyLCByZXMpIHsKCSAgICAvLyB2YXIgcmF0ZUxpbWl0ID0gJ1lvdSBhcmUgc2VuZGluZyB0b28gbWFueSByZXF1ZXN0cy4gUGxlYXNlIHJlbGF4LicKCSAgICBpZiAocmVzKSByZXMgPSBKU09OLnBhcnNlKHJlcyk7CgkgICAgaWYgKGVycikgewoJICAgICAgLy8gaWYgcmVxdWVzdCBmYWlsZWQgYnViYmxlIHRoZSBlcnJvcgoJICAgICAgY2FsbGJhY2soZXJyKTsKCSAgICB9IGVsc2UgaWYgKHJlcy5lcnJvcikgewoJICAgICAgY2FsbGJhY2soRXJyb3IocmVzLmVycm9yKSk7CgkgICAgfSBlbHNlIHsKCSAgICAgIGNhbGxiYWNrKG51bGwsIHJlcyk7CgkgICAgfQoJICB9KTsKCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogNCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgX2dldCA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKCXZhciBfcG9zdCA9IF9fd2VicGFja19yZXF1aXJlX18oNDgpCgoJbW9kdWxlLmV4cG9ydHMgPSB7CgkgIGdldDogX2dldCwKCSAgcG9zdDogX3Bvc3QsCgl9CgoKLyoqKi8gfSwKLyogNSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgaHR0cCA9IF9fd2VicGFja19yZXF1aXJlX18oNikKCXZhciBodHRwcyA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCgl2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCkKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIEdFVChvcHRpb25zLCBjYWxsYmFjaykgewoKCSAgLy8gcmVxdWlyZSBvcHRpb25zLnVybCBvciBmYWlsIG5vaXNpbHkgCgkgIGlmICghb3B0aW9ucy51cmwpIHsKCSAgICB0aHJvdyBFcnJvcignb3B0aW9ucy51cmwgcmVxdWlyZWQnKQoJICB9CgoJICAvLyBwYXJzZSBvdXQgdGhlIG9wdGlvbnMgZnJvbSBvcHRpb25zLnVybAoJICB2YXIgb3B0cyA9IHVybC5wYXJzZShvcHRpb25zLnVybCkKCSAgdmFyIG1ldGhvZCA9IG9wdHMucHJvdG9jb2wgPT09ICdodHRwczonPyBodHRwcy5nZXQgOiBodHRwLmdldAoKCSAgb3B0cy5yZWplY3RVbmF1dGhvcml6ZWQgPSBmYWxzZQoJICBvcHRzLmFnZW50ID0gZmFsc2UKCSAgb3B0cy5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzIHx8IHt9CgkgIG9wdHMuaGVhZGVyc1snVXNlci1BZ2VudCddID0gb3B0cy5oZWFkZXJzWydVc2VyLUFnZW50J10gfHwgJ3RpbnktaHR0cCcKCSAgb3B0cy5oZWFkZXJzWydDb250ZW50LVR5cGUnXSA9IG9wdHMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gfHwgJ2FwcGxpY2F0aW9uL2pzb24nCgkgIAoJICAvLyBtYWtlIGEgcmVxdWVzdAoJICBtZXRob2Qob3B0cywgZnVuY3Rpb24gX19yZXMocmVzKSB7CgkgICAKCSAgICB2YXIgcmF3RGF0YSA9ICcnCgkgICAgdmFyIHN0YXR1c0NvZGUgPSByZXMuc3RhdHVzQ29kZQoJICAgIHZhciBjb250ZW50VHlwZSA9IHJlcy5oZWFkZXJzWydjb250ZW50LXR5cGUnXQoJICAgIHZhciBpc0pTT04gPSBjb250ZW50VHlwZS5zdGFydHNXaXRoKCdhcHBsaWNhdGlvbi9qc29uJykKCgkgICAgaWYgKHN0YXR1c0NvZGUgIT09IDIwMCkgewoJICAgICAgY2FsbGJhY2soRXJyb3IoJ0dFVCBmYWlsZWQgd2l0aDogJyArIHN0YXR1c0NvZGUpKQoJICAgICAgcmVzLnJlc3VtZSgpCgkgICAgICByZXR1cm4KCSAgICB9CgkgCgkgICAgcmVzLnNldEVuY29kaW5nKCd1dGY4JykKCSAgICByZXMub24oJ2RhdGEnLCBmdW5jdGlvbihjaHVuaykge3Jhd0RhdGEgKz0gY2h1bmt9KQoJICAgIHJlcy5vbignZW5kJywgZnVuY3Rpb24oeCkgewoJICAgICAgdHJ5IHsKCSAgICAgICAgdmFyIHBhcnNlZERhdGEgPSBpc0pTT04/IEpTT04ucGFyc2UocmF3RGF0YSkgOiByYXdEYXRhCgkgICAgICAgIGNhbGxiYWNrKG51bGwsIHBhcnNlZERhdGEpCgkgICAgICB9IAoJICAgICAgY2F0Y2ggKGUpIHsKCSAgICAgICAgY2FsbGJhY2soZS5tZXNzYWdlKQoJICAgICAgfQoJICAgIH0pCgkgIH0pLm9uKCdlcnJvcicsIGZ1bmN0aW9uKGUpIHsgY2FsbGJhY2soRXJyb3IoZS5tZXNzYWdlKSkgfSApCgl9CgoKLyoqKi8gfSwKLyogNiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7dmFyIENsaWVudFJlcXVlc3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCgl2YXIgZXh0ZW5kID0gX193ZWJwYWNrX3JlcXVpcmVfXygzOCkKCXZhciBzdGF0dXNDb2RlcyA9IF9fd2VicGFja19yZXF1aXJlX18oMzkpCgl2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCkKCgl2YXIgaHR0cCA9IGV4cG9ydHMKCglodHRwLnJlcXVlc3QgPSBmdW5jdGlvbiAob3B0cywgY2IpIHsKCQlpZiAodHlwZW9mIG9wdHMgPT09ICdzdHJpbmcnKQoJCQlvcHRzID0gdXJsLnBhcnNlKG9wdHMpCgkJZWxzZQoJCQlvcHRzID0gZXh0ZW5kKG9wdHMpCgoJCS8vIE5vcm1hbGx5LCB0aGUgcGFnZSBpcyBsb2FkZWQgZnJvbSBodHRwIG9yIGh0dHBzLCBzbyBub3Qgc3BlY2lmeWluZyBhIHByb3RvY29sCgkJLy8gd2lsbCByZXN1bHQgaW4gYSAodmFsaWQpIHByb3RvY29sLXJlbGF0aXZlIHVybC4gSG93ZXZlciwgdGhpcyB3b24ndCB3b3JrIGlmCgkJLy8gdGhlIHByb3RvY29sIGlzIHNvbWV0aGluZyBlbHNlLCBsaWtlICdmaWxlOicKCQl2YXIgZGVmYXVsdFByb3RvY29sID0gZ2xvYmFsLmxvY2F0aW9uLnByb3RvY29sLnNlYXJjaCgvXmh0dHBzPzokLykgPT09IC0xID8gJ2h0dHA6JyA6ICcnCgoJCXZhciBwcm90b2NvbCA9IG9wdHMucHJvdG9jb2wgfHwgZGVmYXVsdFByb3RvY29sCgkJdmFyIGhvc3QgPSBvcHRzLmhvc3RuYW1lIHx8IG9wdHMuaG9zdAoJCXZhciBwb3J0ID0gb3B0cy5wb3J0CgkJdmFyIHBhdGggPSBvcHRzLnBhdGggfHwgJy8nCgoJCS8vIE5lY2Vzc2FyeSBmb3IgSVB2NiBhZGRyZXNzZXMKCQlpZiAoaG9zdCAmJiBob3N0LmluZGV4T2YoJzonKSAhPT0gLTEpCgkJCWhvc3QgPSAnWycgKyBob3N0ICsgJ10nCgoJCS8vIFRoaXMgbWF5IGJlIGEgcmVsYXRpdmUgdXJsLiBUaGUgYnJvd3NlciBzaG91bGQgYWx3YXlzIGJlIGFibGUgdG8gaW50ZXJwcmV0IGl0IGNvcnJlY3RseS4KCQlvcHRzLnVybCA9IChob3N0ID8gKHByb3RvY29sICsgJy8vJyArIGhvc3QpIDogJycpICsgKHBvcnQgPyAnOicgKyBwb3J0IDogJycpICsgcGF0aAoJCW9wdHMubWV0aG9kID0gKG9wdHMubWV0aG9kIHx8ICdHRVQnKS50b1VwcGVyQ2FzZSgpCgkJb3B0cy5oZWFkZXJzID0gb3B0cy5oZWFkZXJzIHx8IHt9CgoJCS8vIEFsc28gdmFsaWQgb3B0cy5hdXRoLCBvcHRzLm1vZGUKCgkJdmFyIHJlcSA9IG5ldyBDbGllbnRSZXF1ZXN0KG9wdHMpCgkJaWYgKGNiKQoJCQlyZXEub24oJ3Jlc3BvbnNlJywgY2IpCgkJcmV0dXJuIHJlcQoJfQoKCWh0dHAuZ2V0ID0gZnVuY3Rpb24gZ2V0IChvcHRzLCBjYikgewoJCXZhciByZXEgPSBodHRwLnJlcXVlc3Qob3B0cywgY2IpCgkJcmVxLmVuZCgpCgkJcmV0dXJuIHJlcQoJfQoKCWh0dHAuQWdlbnQgPSBmdW5jdGlvbiAoKSB7fQoJaHR0cC5BZ2VudC5kZWZhdWx0TWF4U29ja2V0cyA9IDQKCglodHRwLlNUQVRVU19DT0RFUyA9IHN0YXR1c0NvZGVzCgoJaHR0cC5NRVRIT0RTID0gWwoJCSdDSEVDS09VVCcsCgkJJ0NPTk5FQ1QnLAoJCSdDT1BZJywKCQknREVMRVRFJywKCQknR0VUJywKCQknSEVBRCcsCgkJJ0xPQ0snLAoJCSdNLVNFQVJDSCcsCgkJJ01FUkdFJywKCQknTUtBQ1RJVklUWScsCgkJJ01LQ09MJywKCQknTU9WRScsCgkJJ05PVElGWScsCgkJJ09QVElPTlMnLAoJCSdQQVRDSCcsCgkJJ1BPU1QnLAoJCSdQUk9QRklORCcsCgkJJ1BST1BQQVRDSCcsCgkJJ1BVUkdFJywKCQknUFVUJywKCQknUkVQT1JUJywKCQknU0VBUkNIJywKCQknU1VCU0NSSUJFJywKCQknVFJBQ0UnLAoJCSdVTkxPQ0snLAoJCSdVTlNVQlNDUklCRScKCV0KCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSkKCi8qKiovIH0sCi8qIDcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKEJ1ZmZlciwgZ2xvYmFsLCBwcm9jZXNzKSB7dmFyIGNhcGFiaWxpdHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQoJdmFyIGluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKCXZhciByZXNwb25zZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCgl2YXIgc3RyZWFtID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKCXZhciB0b0FycmF5QnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNykKCgl2YXIgSW5jb21pbmdNZXNzYWdlID0gcmVzcG9uc2UuSW5jb21pbmdNZXNzYWdlCgl2YXIgclN0YXRlcyA9IHJlc3BvbnNlLnJlYWR5U3RhdGVzCgoJZnVuY3Rpb24gZGVjaWRlTW9kZSAocHJlZmVyQmluYXJ5LCB1c2VGZXRjaCkgewoJCWlmIChjYXBhYmlsaXR5LmZldGNoICYmIHVzZUZldGNoKSB7CgkJCXJldHVybiAnZmV0Y2gnCgkJfSBlbHNlIGlmIChjYXBhYmlsaXR5Lm1vemNodW5rZWRhcnJheWJ1ZmZlcikgewoJCQlyZXR1cm4gJ21vei1jaHVua2VkLWFycmF5YnVmZmVyJwoJCX0gZWxzZSBpZiAoY2FwYWJpbGl0eS5tc3N0cmVhbSkgewoJCQlyZXR1cm4gJ21zLXN0cmVhbScKCQl9IGVsc2UgaWYgKGNhcGFiaWxpdHkuYXJyYXlidWZmZXIgJiYgcHJlZmVyQmluYXJ5KSB7CgkJCXJldHVybiAnYXJyYXlidWZmZXInCgkJfSBlbHNlIGlmIChjYXBhYmlsaXR5LnZiQXJyYXkgJiYgcHJlZmVyQmluYXJ5KSB7CgkJCXJldHVybiAndGV4dDp2YmFycmF5JwoJCX0gZWxzZSB7CgkJCXJldHVybiAndGV4dCcKCQl9Cgl9CgoJdmFyIENsaWVudFJlcXVlc3QgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChvcHRzKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJc3RyZWFtLldyaXRhYmxlLmNhbGwoc2VsZikKCgkJc2VsZi5fb3B0cyA9IG9wdHMKCQlzZWxmLl9ib2R5ID0gW10KCQlzZWxmLl9oZWFkZXJzID0ge30KCQlpZiAob3B0cy5hdXRoKQoJCQlzZWxmLnNldEhlYWRlcignQXV0aG9yaXphdGlvbicsICdCYXNpYyAnICsgbmV3IEJ1ZmZlcihvcHRzLmF1dGgpLnRvU3RyaW5nKCdiYXNlNjQnKSkKCQlPYmplY3Qua2V5cyhvcHRzLmhlYWRlcnMpLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKCQkJc2VsZi5zZXRIZWFkZXIobmFtZSwgb3B0cy5oZWFkZXJzW25hbWVdKQoJCX0pCgoJCXZhciBwcmVmZXJCaW5hcnkKCQl2YXIgdXNlRmV0Y2ggPSB0cnVlCgkJaWYgKG9wdHMubW9kZSA9PT0gJ2Rpc2FibGUtZmV0Y2gnIHx8ICd0aW1lb3V0JyBpbiBvcHRzKSB7CgkJCS8vIElmIHRoZSB1c2Ugb2YgWEhSIHNob3VsZCBiZSBwcmVmZXJyZWQgYW5kIGluY2x1ZGVzIHByZXNlcnZpbmcgdGhlICdjb250ZW50LXR5cGUnIGhlYWRlci4KCQkJLy8gRm9yY2UgWEhSIHRvIGJlIHVzZWQgc2luY2UgdGhlIEZldGNoIEFQSSBkb2VzIG5vdCB5ZXQgc3VwcG9ydCB0aW1lb3V0cy4KCQkJdXNlRmV0Y2ggPSBmYWxzZQoJCQlwcmVmZXJCaW5hcnkgPSB0cnVlCgkJfSBlbHNlIGlmIChvcHRzLm1vZGUgPT09ICdwcmVmZXItc3RyZWFtaW5nJykgewoJCQkvLyBJZiBzdHJlYW1pbmcgaXMgYSBoaWdoIHByaW9yaXR5IGJ1dCBiaW5hcnkgY29tcGF0aWJpbGl0eSBhbmQKCQkJLy8gdGhlIGFjY3VyYWN5IG9mIHRoZSAnY29udGVudC10eXBlJyBoZWFkZXIgYXJlbid0CgkJCXByZWZlckJpbmFyeSA9IGZhbHNlCgkJfSBlbHNlIGlmIChvcHRzLm1vZGUgPT09ICdhbGxvdy13cm9uZy1jb250ZW50LXR5cGUnKSB7CgkJCS8vIElmIHN0cmVhbWluZyBpcyBtb3JlIGltcG9ydGFudCB0aGFuIHByZXNlcnZpbmcgdGhlICdjb250ZW50LXR5cGUnIGhlYWRlcgoJCQlwcmVmZXJCaW5hcnkgPSAhY2FwYWJpbGl0eS5vdmVycmlkZU1pbWVUeXBlCgkJfSBlbHNlIGlmICghb3B0cy5tb2RlIHx8IG9wdHMubW9kZSA9PT0gJ2RlZmF1bHQnIHx8IG9wdHMubW9kZSA9PT0gJ3ByZWZlci1mYXN0JykgewoJCQkvLyBVc2UgYmluYXJ5IGlmIHRleHQgc3RyZWFtaW5nIG1heSBjb3JydXB0IGRhdGEgb3IgdGhlIGNvbnRlbnQtdHlwZSBoZWFkZXIsIG9yIGZvciBzcGVlZAoJCQlwcmVmZXJCaW5hcnkgPSB0cnVlCgkJfSBlbHNlIHsKCQkJdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHZhbHVlIGZvciBvcHRzLm1vZGUnKQoJCX0KCQlzZWxmLl9tb2RlID0gZGVjaWRlTW9kZShwcmVmZXJCaW5hcnksIHVzZUZldGNoKQoKCQlzZWxmLm9uKCdmaW5pc2gnLCBmdW5jdGlvbiAoKSB7CgkJCXNlbGYuX29uRmluaXNoKCkKCQl9KQoJfQoKCWluaGVyaXRzKENsaWVudFJlcXVlc3QsIHN0cmVhbS5Xcml0YWJsZSkKCglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5zZXRIZWFkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCQl2YXIgbG93ZXJOYW1lID0gbmFtZS50b0xvd2VyQ2FzZSgpCgkJLy8gVGhpcyBjaGVjayBpcyBub3QgbmVjZXNzYXJ5LCBidXQgaXQgcHJldmVudHMgd2FybmluZ3MgZnJvbSBicm93c2VycyBhYm91dCBzZXR0aW5nIHVuc2FmZQoJCS8vIGhlYWRlcnMuIFRvIGJlIGhvbmVzdCBJJ20gbm90IGVudGlyZWx5IHN1cmUgaGlkaW5nIHRoZXNlIHdhcm5pbmdzIGlzIGEgZ29vZCB0aGluZywgYnV0CgkJLy8gaHR0cC1icm93c2VyaWZ5IGRpZCBpdCwgc28gSSB3aWxsIHRvby4KCQlpZiAodW5zYWZlSGVhZGVycy5pbmRleE9mKGxvd2VyTmFtZSkgIT09IC0xKQoJCQlyZXR1cm4KCgkJc2VsZi5faGVhZGVyc1tsb3dlck5hbWVdID0gewoJCQluYW1lOiBuYW1lLAoJCQl2YWx1ZTogdmFsdWUKCQl9Cgl9CgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuZ2V0SGVhZGVyID0gZnVuY3Rpb24gKG5hbWUpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCQlyZXR1cm4gc2VsZi5faGVhZGVyc1tuYW1lLnRvTG93ZXJDYXNlKCldLnZhbHVlCgl9CgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUucmVtb3ZlSGVhZGVyID0gZnVuY3Rpb24gKG5hbWUpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCQlkZWxldGUgc2VsZi5faGVhZGVyc1tuYW1lLnRvTG93ZXJDYXNlKCldCgl9CgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuX29uRmluaXNoID0gZnVuY3Rpb24gKCkgewoJCXZhciBzZWxmID0gdGhpcwoKCQlpZiAoc2VsZi5fZGVzdHJveWVkKQoJCQlyZXR1cm4KCQl2YXIgb3B0cyA9IHNlbGYuX29wdHMKCgkJdmFyIGhlYWRlcnNPYmogPSBzZWxmLl9oZWFkZXJzCgkJdmFyIGJvZHkgPSBudWxsCgkJaWYgKG9wdHMubWV0aG9kID09PSAnUE9TVCcgfHwgb3B0cy5tZXRob2QgPT09ICdQVVQnIHx8IG9wdHMubWV0aG9kID09PSAnUEFUQ0gnIHx8IG9wdHMubWV0aG9kID09PSAnTUVSR0UnKSB7CgkJCWlmIChjYXBhYmlsaXR5LmJsb2JDb25zdHJ1Y3RvcikgewoJCQkJYm9keSA9IG5ldyBnbG9iYWwuQmxvYihzZWxmLl9ib2R5Lm1hcChmdW5jdGlvbiAoYnVmZmVyKSB7CgkJCQkJcmV0dXJuIHRvQXJyYXlCdWZmZXIoYnVmZmVyKQoJCQkJfSksIHsKCQkJCQl0eXBlOiAoaGVhZGVyc09ialsnY29udGVudC10eXBlJ10gfHwge30pLnZhbHVlIHx8ICcnCgkJCQl9KQoJCQl9IGVsc2UgewoJCQkJLy8gZ2V0IHV0Zjggc3RyaW5nCgkJCQlib2R5ID0gQnVmZmVyLmNvbmNhdChzZWxmLl9ib2R5KS50b1N0cmluZygpCgkJCX0KCQl9CgoJCWlmIChzZWxmLl9tb2RlID09PSAnZmV0Y2gnKSB7CgkJCXZhciBoZWFkZXJzID0gT2JqZWN0LmtleXMoaGVhZGVyc09iaikubWFwKGZ1bmN0aW9uIChuYW1lKSB7CgkJCQlyZXR1cm4gW2hlYWRlcnNPYmpbbmFtZV0ubmFtZSwgaGVhZGVyc09ialtuYW1lXS52YWx1ZV0KCQkJfSkKCgkJCWdsb2JhbC5mZXRjaChzZWxmLl9vcHRzLnVybCwgewoJCQkJbWV0aG9kOiBzZWxmLl9vcHRzLm1ldGhvZCwKCQkJCWhlYWRlcnM6IGhlYWRlcnMsCgkJCQlib2R5OiBib2R5IHx8IHVuZGVmaW5lZCwKCQkJCW1vZGU6ICdjb3JzJywKCQkJCWNyZWRlbnRpYWxzOiBvcHRzLndpdGhDcmVkZW50aWFscyA/ICdpbmNsdWRlJyA6ICdzYW1lLW9yaWdpbicKCQkJfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKCQkJCXNlbGYuX2ZldGNoUmVzcG9uc2UgPSByZXNwb25zZQoJCQkJc2VsZi5fY29ubmVjdCgpCgkJCX0sIGZ1bmN0aW9uIChyZWFzb24pIHsKCQkJCXNlbGYuZW1pdCgnZXJyb3InLCByZWFzb24pCgkJCX0pCgkJfSBlbHNlIHsKCQkJdmFyIHhociA9IHNlbGYuX3hociA9IG5ldyBnbG9iYWwuWE1MSHR0cFJlcXVlc3QoKQoJCQl0cnkgewoJCQkJeGhyLm9wZW4oc2VsZi5fb3B0cy5tZXRob2QsIHNlbGYuX29wdHMudXJsLCB0cnVlKQoJCQl9IGNhdGNoIChlcnIpIHsKCQkJCXByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gKCkgewoJCQkJCXNlbGYuZW1pdCgnZXJyb3InLCBlcnIpCgkJCQl9KQoJCQkJcmV0dXJuCgkJCX0KCgkJCS8vIENhbid0IHNldCByZXNwb25zZVR5cGUgb24gcmVhbGx5IG9sZCBicm93c2VycwoJCQlpZiAoJ3Jlc3BvbnNlVHlwZScgaW4geGhyKQoJCQkJeGhyLnJlc3BvbnNlVHlwZSA9IHNlbGYuX21vZGUuc3BsaXQoJzonKVswXQoKCQkJaWYgKCd3aXRoQ3JlZGVudGlhbHMnIGluIHhocikKCQkJCXhoci53aXRoQ3JlZGVudGlhbHMgPSAhIW9wdHMud2l0aENyZWRlbnRpYWxzCgoJCQlpZiAoc2VsZi5fbW9kZSA9PT0gJ3RleHQnICYmICdvdmVycmlkZU1pbWVUeXBlJyBpbiB4aHIpCgkJCQl4aHIub3ZlcnJpZGVNaW1lVHlwZSgndGV4dC9wbGFpbjsgY2hhcnNldD14LXVzZXItZGVmaW5lZCcpCgoJCQlpZiAoJ3RpbWVvdXQnIGluIG9wdHMpIHsKCQkJCXhoci50aW1lb3V0ID0gb3B0cy50aW1lb3V0CgkJCQl4aHIub250aW1lb3V0ID0gZnVuY3Rpb24gKCkgewoJCQkJCXNlbGYuZW1pdCgndGltZW91dCcpCgkJCQl9CgkJCX0KCgkJCU9iamVjdC5rZXlzKGhlYWRlcnNPYmopLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKCQkJCXhoci5zZXRSZXF1ZXN0SGVhZGVyKGhlYWRlcnNPYmpbbmFtZV0ubmFtZSwgaGVhZGVyc09ialtuYW1lXS52YWx1ZSkKCQkJfSkKCgkJCXNlbGYuX3Jlc3BvbnNlID0gbnVsbAoJCQl4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewoJCQkJc3dpdGNoICh4aHIucmVhZHlTdGF0ZSkgewoJCQkJCWNhc2UgclN0YXRlcy5MT0FESU5HOgoJCQkJCWNhc2UgclN0YXRlcy5ET05FOgoJCQkJCQlzZWxmLl9vblhIUlByb2dyZXNzKCkKCQkJCQkJYnJlYWsKCQkJCX0KCQkJfQoJCQkvLyBOZWNlc3NhcnkgZm9yIHN0cmVhbWluZyBpbiBGaXJlZm94LCBzaW5jZSB4aHIucmVzcG9uc2UgaXMgT05MWSBkZWZpbmVkCgkJCS8vIGluIG9ucHJvZ3Jlc3MsIG5vdCBpbiBvbnJlYWR5c3RhdGVjaGFuZ2Ugd2l0aCB4aHIucmVhZHlTdGF0ZSA9IDMKCQkJaWYgKHNlbGYuX21vZGUgPT09ICdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcicpIHsKCQkJCXhoci5vbnByb2dyZXNzID0gZnVuY3Rpb24gKCkgewoJCQkJCXNlbGYuX29uWEhSUHJvZ3Jlc3MoKQoJCQkJfQoJCQl9CgoJCQl4aHIub25lcnJvciA9IGZ1bmN0aW9uICgpIHsKCQkJCWlmIChzZWxmLl9kZXN0cm95ZWQpCgkJCQkJcmV0dXJuCgkJCQlzZWxmLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdYSFIgZXJyb3InKSkKCQkJfQoKCQkJdHJ5IHsKCQkJCXhoci5zZW5kKGJvZHkpCgkJCX0gY2F0Y2ggKGVycikgewoJCQkJcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7CgkJCQkJc2VsZi5lbWl0KCdlcnJvcicsIGVycikKCQkJCX0pCgkJCQlyZXR1cm4KCQkJfQoJCX0KCX0KCgkvKioKCSAqIENoZWNrcyBpZiB4aHIuc3RhdHVzIGlzIHJlYWRhYmxlIGFuZCBub24temVybywgaW5kaWNhdGluZyBubyBlcnJvci4KCSAqIEV2ZW4gdGhvdWdoIHRoZSBzcGVjIHNheXMgaXQgc2hvdWxkIGJlIGF2YWlsYWJsZSBpbiByZWFkeVN0YXRlIDMsCgkgKiBhY2Nlc3NpbmcgaXQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpbiBJRTgKCSAqLwoJZnVuY3Rpb24gc3RhdHVzVmFsaWQgKHhocikgewoJCXRyeSB7CgkJCXZhciBzdGF0dXMgPSB4aHIuc3RhdHVzCgkJCXJldHVybiAoc3RhdHVzICE9PSBudWxsICYmIHN0YXR1cyAhPT0gMCkKCQl9IGNhdGNoIChlKSB7CgkJCXJldHVybiBmYWxzZQoJCX0KCX0KCglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5fb25YSFJQcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCgkJaWYgKCFzdGF0dXNWYWxpZChzZWxmLl94aHIpIHx8IHNlbGYuX2Rlc3Ryb3llZCkKCQkJcmV0dXJuCgoJCWlmICghc2VsZi5fcmVzcG9uc2UpCgkJCXNlbGYuX2Nvbm5lY3QoKQoKCQlzZWxmLl9yZXNwb25zZS5fb25YSFJQcm9ncmVzcygpCgl9CgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuX2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgoJCWlmIChzZWxmLl9kZXN0cm95ZWQpCgkJCXJldHVybgoKCQlzZWxmLl9yZXNwb25zZSA9IG5ldyBJbmNvbWluZ01lc3NhZ2Uoc2VsZi5feGhyLCBzZWxmLl9mZXRjaFJlc3BvbnNlLCBzZWxmLl9tb2RlKQoJCXNlbGYuX3Jlc3BvbnNlLm9uKCdlcnJvcicsIGZ1bmN0aW9uKGVycikgewoJCQlzZWxmLmVtaXQoJ2Vycm9yJywgZXJyKQoJCX0pCgoJCXNlbGYuZW1pdCgncmVzcG9uc2UnLCBzZWxmLl9yZXNwb25zZSkKCX0KCglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5fd3JpdGUgPSBmdW5jdGlvbiAoY2h1bmssIGVuY29kaW5nLCBjYikgewoJCXZhciBzZWxmID0gdGhpcwoKCQlzZWxmLl9ib2R5LnB1c2goY2h1bmspCgkJY2IoKQoJfQoKCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLmFib3J0ID0gQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHsKCQl2YXIgc2VsZiA9IHRoaXMKCQlzZWxmLl9kZXN0cm95ZWQgPSB0cnVlCgkJaWYgKHNlbGYuX3Jlc3BvbnNlKQoJCQlzZWxmLl9yZXNwb25zZS5fZGVzdHJveWVkID0gdHJ1ZQoJCWlmIChzZWxmLl94aHIpCgkJCXNlbGYuX3hoci5hYm9ydCgpCgkJLy8gQ3VycmVudGx5LCB0aGVyZSBpc24ndCBhIHdheSB0byB0cnVseSBhYm9ydCBhIGZldGNoLgoJCS8vIElmIHlvdSBsaWtlIGJpa2VzaGVkZGluZywgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93aGF0d2cvZmV0Y2gvaXNzdWVzLzI3Cgl9CgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24gKGRhdGEsIGVuY29kaW5nLCBjYikgewoJCXZhciBzZWxmID0gdGhpcwoJCWlmICh0eXBlb2YgZGF0YSA9PT0gJ2Z1bmN0aW9uJykgewoJCQljYiA9IGRhdGEKCQkJZGF0YSA9IHVuZGVmaW5lZAoJCX0KCgkJc3RyZWFtLldyaXRhYmxlLnByb3RvdHlwZS5lbmQuY2FsbChzZWxmLCBkYXRhLCBlbmNvZGluZywgY2IpCgl9CgoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuZmx1c2hIZWFkZXJzID0gZnVuY3Rpb24gKCkge30KCUNsaWVudFJlcXVlc3QucHJvdG90eXBlLnNldFRpbWVvdXQgPSBmdW5jdGlvbiAoKSB7fQoJQ2xpZW50UmVxdWVzdC5wcm90b3R5cGUuc2V0Tm9EZWxheSA9IGZ1bmN0aW9uICgpIHt9CglDbGllbnRSZXF1ZXN0LnByb3RvdHlwZS5zZXRTb2NrZXRLZWVwQWxpdmUgPSBmdW5jdGlvbiAoKSB7fQoKCS8vIFRha2VuIGZyb20gaHR0cDovL3d3dy53My5vcmcvVFIvWE1MSHR0cFJlcXVlc3QvI3RoZS1zZXRyZXF1ZXN0aGVhZGVyJTI4JTI5LW1ldGhvZAoJdmFyIHVuc2FmZUhlYWRlcnMgPSBbCgkJJ2FjY2VwdC1jaGFyc2V0JywKCQknYWNjZXB0LWVuY29kaW5nJywKCQknYWNjZXNzLWNvbnRyb2wtcmVxdWVzdC1oZWFkZXJzJywKCQknYWNjZXNzLWNvbnRyb2wtcmVxdWVzdC1tZXRob2QnLAoJCSdjb25uZWN0aW9uJywKCQknY29udGVudC1sZW5ndGgnLAoJCSdjb29raWUnLAoJCSdjb29raWUyJywKCQknZGF0ZScsCgkJJ2RudCcsCgkJJ2V4cGVjdCcsCgkJJ2hvc3QnLAoJCSdrZWVwLWFsaXZlJywKCQknb3JpZ2luJywKCQkncmVmZXJlcicsCgkJJ3RlJywKCQkndHJhaWxlcicsCgkJJ3RyYW5zZmVyLWVuY29kaW5nJywKCQkndXBncmFkZScsCgkJJ3VzZXItYWdlbnQnLAoJCSd2aWEnCgldCgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oOCkuQnVmZmVyLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKSkpCgovKioqLyB9LAovKiA4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHsvKiEKCSAqIFRoZSBidWZmZXIgbW9kdWxlIGZyb20gbm9kZS5qcywgZm9yIHRoZSBicm93c2VyLgoJICoKCSAqIEBhdXRob3IgICBGZXJvc3MgQWJvdWtoYWRpamVoIDxmZXJvc3NAZmVyb3NzLm9yZz4gPGh0dHA6Ly9mZXJvc3Mub3JnPgoJICogQGxpY2Vuc2UgIE1JVAoJICovCgkvKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqLwoKCSd1c2Ugc3RyaWN0JwoKCXZhciBiYXNlNjQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpCgl2YXIgaWVlZTc1NCA9IF9fd2VicGFja19yZXF1aXJlX18oMTApCgl2YXIgaXNBcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpCgoJZXhwb3J0cy5CdWZmZXIgPSBCdWZmZXIKCWV4cG9ydHMuU2xvd0J1ZmZlciA9IFNsb3dCdWZmZXIKCWV4cG9ydHMuSU5TUEVDVF9NQVhfQllURVMgPSA1MAoKCS8qKgoJICogSWYgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYDoKCSAqICAgPT09IHRydWUgICAgVXNlIFVpbnQ4QXJyYXkgaW1wbGVtZW50YXRpb24gKGZhc3Rlc3QpCgkgKiAgID09PSBmYWxzZSAgIFVzZSBPYmplY3QgaW1wbGVtZW50YXRpb24gKG1vc3QgY29tcGF0aWJsZSwgZXZlbiBJRTYpCgkgKgoJICogQnJvd3NlcnMgdGhhdCBzdXBwb3J0IHR5cGVkIGFycmF5cyBhcmUgSUUgMTArLCBGaXJlZm94IDQrLCBDaHJvbWUgNyssIFNhZmFyaSA1LjErLAoJICogT3BlcmEgMTEuNissIGlPUyA0LjIrLgoJICoKCSAqIER1ZSB0byB2YXJpb3VzIGJyb3dzZXIgYnVncywgc29tZXRpbWVzIHRoZSBPYmplY3QgaW1wbGVtZW50YXRpb24gd2lsbCBiZSB1c2VkIGV2ZW4KCSAqIHdoZW4gdGhlIGJyb3dzZXIgc3VwcG9ydHMgdHlwZWQgYXJyYXlzLgoJICoKCSAqIE5vdGU6CgkgKgoJICogICAtIEZpcmVmb3ggNC0yOSBsYWNrcyBzdXBwb3J0IGZvciBhZGRpbmcgbmV3IHByb3BlcnRpZXMgdG8gYFVpbnQ4QXJyYXlgIGluc3RhbmNlcywKCSAqICAgICBTZWU6IGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY5NTQzOC4KCSAqCgkgKiAgIC0gQ2hyb21lIDktMTAgaXMgbWlzc2luZyB0aGUgYFR5cGVkQXJyYXkucHJvdG90eXBlLnN1YmFycmF5YCBmdW5jdGlvbi4KCSAqCgkgKiAgIC0gSUUxMCBoYXMgYSBicm9rZW4gYFR5cGVkQXJyYXkucHJvdG90eXBlLnN1YmFycmF5YCBmdW5jdGlvbiB3aGljaCByZXR1cm5zIGFycmF5cyBvZgoJICogICAgIGluY29ycmVjdCBsZW5ndGggaW4gc29tZSBzaXR1YXRpb25zLgoKCSAqIFdlIGRldGVjdCB0aGVzZSBidWdneSBicm93c2VycyBhbmQgc2V0IGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGAgdG8gYGZhbHNlYCBzbyB0aGV5CgkgKiBnZXQgdGhlIE9iamVjdCBpbXBsZW1lbnRhdGlvbiwgd2hpY2ggaXMgc2xvd2VyIGJ1dCBiZWhhdmVzIGNvcnJlY3RseS4KCSAqLwoJQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgPSBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVCAhPT0gdW5kZWZpbmVkCgkgID8gZ2xvYmFsLlRZUEVEX0FSUkFZX1NVUFBPUlQKCSAgOiB0eXBlZEFycmF5U3VwcG9ydCgpCgoJLyoKCSAqIEV4cG9ydCBrTWF4TGVuZ3RoIGFmdGVyIHR5cGVkIGFycmF5IHN1cHBvcnQgaXMgZGV0ZXJtaW5lZC4KCSAqLwoJZXhwb3J0cy5rTWF4TGVuZ3RoID0ga01heExlbmd0aCgpCgoJZnVuY3Rpb24gdHlwZWRBcnJheVN1cHBvcnQgKCkgewoJICB0cnkgewoJICAgIHZhciBhcnIgPSBuZXcgVWludDhBcnJheSgxKQoJICAgIGFyci5fX3Byb3RvX18gPSB7X19wcm90b19fOiBVaW50OEFycmF5LnByb3RvdHlwZSwgZm9vOiBmdW5jdGlvbiAoKSB7IHJldHVybiA0MiB9fQoJICAgIHJldHVybiBhcnIuZm9vKCkgPT09IDQyICYmIC8vIHR5cGVkIGFycmF5IGluc3RhbmNlcyBjYW4gYmUgYXVnbWVudGVkCgkgICAgICAgIHR5cGVvZiBhcnIuc3ViYXJyYXkgPT09ICdmdW5jdGlvbicgJiYgLy8gY2hyb21lIDktMTAgbGFjayBgc3ViYXJyYXlgCgkgICAgICAgIGFyci5zdWJhcnJheSgxLCAxKS5ieXRlTGVuZ3RoID09PSAwIC8vIGllMTAgaGFzIGJyb2tlbiBgc3ViYXJyYXlgCgkgIH0gY2F0Y2ggKGUpIHsKCSAgICByZXR1cm4gZmFsc2UKCSAgfQoJfQoKCWZ1bmN0aW9uIGtNYXhMZW5ndGggKCkgewoJICByZXR1cm4gQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQKCSAgICA/IDB4N2ZmZmZmZmYKCSAgICA6IDB4M2ZmZmZmZmYKCX0KCglmdW5jdGlvbiBjcmVhdGVCdWZmZXIgKHRoYXQsIGxlbmd0aCkgewoJICBpZiAoa01heExlbmd0aCgpIDwgbGVuZ3RoKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgdHlwZWQgYXJyYXkgbGVuZ3RoJykKCSAgfQoJICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2UKCSAgICB0aGF0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKQoJICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZQoJICB9IGVsc2UgewoJICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3MKCSAgICBpZiAodGhhdCA9PT0gbnVsbCkgewoJICAgICAgdGhhdCA9IG5ldyBCdWZmZXIobGVuZ3RoKQoJICAgIH0KCSAgICB0aGF0Lmxlbmd0aCA9IGxlbmd0aAoJICB9CgoJICByZXR1cm4gdGhhdAoJfQoKCS8qKgoJICogVGhlIEJ1ZmZlciBjb25zdHJ1Y3RvciByZXR1cm5zIGluc3RhbmNlcyBvZiBgVWludDhBcnJheWAgdGhhdCBoYXZlIHRoZWlyCgkgKiBwcm90b3R5cGUgY2hhbmdlZCB0byBgQnVmZmVyLnByb3RvdHlwZWAuIEZ1cnRoZXJtb3JlLCBgQnVmZmVyYCBpcyBhIHN1YmNsYXNzIG9mCgkgKiBgVWludDhBcnJheWAsIHNvIHRoZSByZXR1cm5lZCBpbnN0YW5jZXMgd2lsbCBoYXZlIGFsbCB0aGUgbm9kZSBgQnVmZmVyYCBtZXRob2RzCgkgKiBhbmQgdGhlIGBVaW50OEFycmF5YCBtZXRob2RzLiBTcXVhcmUgYnJhY2tldCBub3RhdGlvbiB3b3JrcyBhcyBleHBlY3RlZCAtLSBpdAoJICogcmV0dXJucyBhIHNpbmdsZSBvY3RldC4KCSAqCgkgKiBUaGUgYFVpbnQ4QXJyYXlgIHByb3RvdHlwZSByZW1haW5zIHVubW9kaWZpZWQuCgkgKi8KCglmdW5jdGlvbiBCdWZmZXIgKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7CgkgIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgJiYgISh0aGlzIGluc3RhbmNlb2YgQnVmZmVyKSkgewoJICAgIHJldHVybiBuZXcgQnVmZmVyKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKQoJICB9CgoJICAvLyBDb21tb24gY2FzZS4KCSAgaWYgKHR5cGVvZiBhcmcgPT09ICdudW1iZXInKSB7CgkgICAgaWYgKHR5cGVvZiBlbmNvZGluZ09yT2Zmc2V0ID09PSAnc3RyaW5nJykgewoJICAgICAgdGhyb3cgbmV3IEVycm9yKAoJICAgICAgICAnSWYgZW5jb2RpbmcgaXMgc3BlY2lmaWVkIHRoZW4gdGhlIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcnCgkgICAgICApCgkgICAgfQoJICAgIHJldHVybiBhbGxvY1Vuc2FmZSh0aGlzLCBhcmcpCgkgIH0KCSAgcmV0dXJuIGZyb20odGhpcywgYXJnLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpCgl9CgoJQnVmZmVyLnBvb2xTaXplID0gODE5MiAvLyBub3QgdXNlZCBieSB0aGlzIGltcGxlbWVudGF0aW9uCgoJLy8gVE9ETzogTGVnYWN5LCBub3QgbmVlZGVkIGFueW1vcmUuIFJlbW92ZSBpbiBuZXh0IG1ham9yIHZlcnNpb24uCglCdWZmZXIuX2F1Z21lbnQgPSBmdW5jdGlvbiAoYXJyKSB7CgkgIGFyci5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlCgkgIHJldHVybiBhcnIKCX0KCglmdW5jdGlvbiBmcm9tICh0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7CgkgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignInZhbHVlIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpCgkgIH0KCgkgIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIHZhbHVlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsKCSAgICByZXR1cm4gZnJvbUFycmF5QnVmZmVyKHRoYXQsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpCgkgIH0KCgkgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7CgkgICAgcmV0dXJuIGZyb21TdHJpbmcodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQpCgkgIH0KCgkgIHJldHVybiBmcm9tT2JqZWN0KHRoYXQsIHZhbHVlKQoJfQoKCS8qKgoJICogRnVuY3Rpb25hbGx5IGVxdWl2YWxlbnQgdG8gQnVmZmVyKGFyZywgZW5jb2RpbmcpIGJ1dCB0aHJvd3MgYSBUeXBlRXJyb3IKCSAqIGlmIHZhbHVlIGlzIGEgbnVtYmVyLgoJICogQnVmZmVyLmZyb20oc3RyWywgZW5jb2RpbmddKQoJICogQnVmZmVyLmZyb20oYXJyYXkpCgkgKiBCdWZmZXIuZnJvbShidWZmZXIpCgkgKiBCdWZmZXIuZnJvbShhcnJheUJ1ZmZlclssIGJ5dGVPZmZzZXRbLCBsZW5ndGhdXSkKCSAqKi8KCUJ1ZmZlci5mcm9tID0gZnVuY3Rpb24gKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHsKCSAgcmV0dXJuIGZyb20obnVsbCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkKCX0KCglpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgQnVmZmVyLnByb3RvdHlwZS5fX3Byb3RvX18gPSBVaW50OEFycmF5LnByb3RvdHlwZQoJICBCdWZmZXIuX19wcm90b19fID0gVWludDhBcnJheQoJICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnNwZWNpZXMgJiYKCSAgICAgIEJ1ZmZlcltTeW1ib2wuc3BlY2llc10gPT09IEJ1ZmZlcikgewoJICAgIC8vIEZpeCBzdWJhcnJheSgpIGluIEVTMjAxNi4gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZmVyb3NzL2J1ZmZlci9wdWxsLzk3CgkgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1ZmZlciwgU3ltYm9sLnNwZWNpZXMsIHsKCSAgICAgIHZhbHVlOiBudWxsLAoJICAgICAgY29uZmlndXJhYmxlOiB0cnVlCgkgICAgfSkKCSAgfQoJfQoKCWZ1bmN0aW9uIGFzc2VydFNpemUgKHNpemUpIHsKCSAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJyJzaXplIiBhcmd1bWVudCBtdXN0IGJlIGEgbnVtYmVyJykKCSAgfSBlbHNlIGlmIChzaXplIDwgMCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCcic2l6ZSIgYXJndW1lbnQgbXVzdCBub3QgYmUgbmVnYXRpdmUnKQoJICB9Cgl9CgoJZnVuY3Rpb24gYWxsb2MgKHRoYXQsIHNpemUsIGZpbGwsIGVuY29kaW5nKSB7CgkgIGFzc2VydFNpemUoc2l6ZSkKCSAgaWYgKHNpemUgPD0gMCkgewoJICAgIHJldHVybiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkKCSAgfQoJICBpZiAoZmlsbCAhPT0gdW5kZWZpbmVkKSB7CgkgICAgLy8gT25seSBwYXkgYXR0ZW50aW9uIHRvIGVuY29kaW5nIGlmIGl0J3MgYSBzdHJpbmcuIFRoaXMKCSAgICAvLyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgc2VuZGluZyBpbiBhIG51bWJlciB0aGF0IHdvdWxkCgkgICAgLy8gYmUgaW50ZXJwcmV0dGVkIGFzIGEgc3RhcnQgb2Zmc2V0LgoJICAgIHJldHVybiB0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnCgkgICAgICA/IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKS5maWxsKGZpbGwsIGVuY29kaW5nKQoJICAgICAgOiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkuZmlsbChmaWxsKQoJICB9CgkgIHJldHVybiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkKCX0KCgkvKioKCSAqIENyZWF0ZXMgYSBuZXcgZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS4KCSAqIGFsbG9jKHNpemVbLCBmaWxsWywgZW5jb2RpbmddXSkKCSAqKi8KCUJ1ZmZlci5hbGxvYyA9IGZ1bmN0aW9uIChzaXplLCBmaWxsLCBlbmNvZGluZykgewoJICByZXR1cm4gYWxsb2MobnVsbCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpCgl9CgoJZnVuY3Rpb24gYWxsb2NVbnNhZmUgKHRoYXQsIHNpemUpIHsKCSAgYXNzZXJ0U2l6ZShzaXplKQoJICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUgPCAwID8gMCA6IGNoZWNrZWQoc2l6ZSkgfCAwKQoJICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyArK2kpIHsKCSAgICAgIHRoYXRbaV0gPSAwCgkgICAgfQoJICB9CgkgIHJldHVybiB0aGF0Cgl9CgoJLyoqCgkgKiBFcXVpdmFsZW50IHRvIEJ1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLgoJICogKi8KCUJ1ZmZlci5hbGxvY1Vuc2FmZSA9IGZ1bmN0aW9uIChzaXplKSB7CgkgIHJldHVybiBhbGxvY1Vuc2FmZShudWxsLCBzaXplKQoJfQoJLyoqCgkgKiBFcXVpdmFsZW50IHRvIFNsb3dCdWZmZXIobnVtKSwgYnkgZGVmYXVsdCBjcmVhdGVzIGEgbm9uLXplcm8tZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS4KCSAqLwoJQnVmZmVyLmFsbG9jVW5zYWZlU2xvdyA9IGZ1bmN0aW9uIChzaXplKSB7CgkgIHJldHVybiBhbGxvY1Vuc2FmZShudWxsLCBzaXplKQoJfQoKCWZ1bmN0aW9uIGZyb21TdHJpbmcgKHRoYXQsIHN0cmluZywgZW5jb2RpbmcpIHsKCSAgaWYgKHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycgfHwgZW5jb2RpbmcgPT09ICcnKSB7CgkgICAgZW5jb2RpbmcgPSAndXRmOCcKCSAgfQoKCSAgaWYgKCFCdWZmZXIuaXNFbmNvZGluZyhlbmNvZGluZykpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCciZW5jb2RpbmciIG11c3QgYmUgYSB2YWxpZCBzdHJpbmcgZW5jb2RpbmcnKQoJICB9CgoJICB2YXIgbGVuZ3RoID0gYnl0ZUxlbmd0aChzdHJpbmcsIGVuY29kaW5nKSB8IDAKCSAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBsZW5ndGgpCgoJICB2YXIgYWN0dWFsID0gdGhhdC53cml0ZShzdHJpbmcsIGVuY29kaW5nKQoKCSAgaWYgKGFjdHVhbCAhPT0gbGVuZ3RoKSB7CgkgICAgLy8gV3JpdGluZyBhIGhleCBzdHJpbmcsIGZvciBleGFtcGxlLCB0aGF0IGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycyB3aWxsCgkgICAgLy8gY2F1c2UgZXZlcnl0aGluZyBhZnRlciB0aGUgZmlyc3QgaW52YWxpZCBjaGFyYWN0ZXIgdG8gYmUgaWdub3JlZC4gKGUuZy4KCSAgICAvLyAnYWJ4eGNkJyB3aWxsIGJlIHRyZWF0ZWQgYXMgJ2FiJykKCSAgICB0aGF0ID0gdGhhdC5zbGljZSgwLCBhY3R1YWwpCgkgIH0KCgkgIHJldHVybiB0aGF0Cgl9CgoJZnVuY3Rpb24gZnJvbUFycmF5TGlrZSAodGhhdCwgYXJyYXkpIHsKCSAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aCA8IDAgPyAwIDogY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMAoJICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbmd0aCkKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkgewoJICAgIHRoYXRbaV0gPSBhcnJheVtpXSAmIDI1NQoJICB9CgkgIHJldHVybiB0aGF0Cgl9CgoJZnVuY3Rpb24gZnJvbUFycmF5QnVmZmVyICh0aGF0LCBhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKSB7CgkgIGFycmF5LmJ5dGVMZW5ndGggLy8gdGhpcyB0aHJvd3MgaWYgYGFycmF5YCBpcyBub3QgYSB2YWxpZCBBcnJheUJ1ZmZlcgoKCSAgaWYgKGJ5dGVPZmZzZXQgPCAwIHx8IGFycmF5LmJ5dGVMZW5ndGggPCBieXRlT2Zmc2V0KSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wnb2Zmc2V0XCcgaXMgb3V0IG9mIGJvdW5kcycpCgkgIH0KCgkgIGlmIChhcnJheS5ieXRlTGVuZ3RoIDwgYnl0ZU9mZnNldCArIChsZW5ndGggfHwgMCkpIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXCdsZW5ndGhcJyBpcyBvdXQgb2YgYm91bmRzJykKCSAgfQoKCSAgaWYgKGJ5dGVPZmZzZXQgPT09IHVuZGVmaW5lZCAmJiBsZW5ndGggPT09IHVuZGVmaW5lZCkgewoJICAgIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXkpCgkgIH0gZWxzZSBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIHsKCSAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0KQoJICB9IGVsc2UgewoJICAgIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXksIGJ5dGVPZmZzZXQsIGxlbmd0aCkKCSAgfQoKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlCgkgICAgdGhhdCA9IGFycmF5CgkgICAgdGhhdC5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlCgkgIH0gZWxzZSB7CgkgICAgLy8gRmFsbGJhY2s6IFJldHVybiBhbiBvYmplY3QgaW5zdGFuY2Ugb2YgdGhlIEJ1ZmZlciBjbGFzcwoJICAgIHRoYXQgPSBmcm9tQXJyYXlMaWtlKHRoYXQsIGFycmF5KQoJICB9CgkgIHJldHVybiB0aGF0Cgl9CgoJZnVuY3Rpb24gZnJvbU9iamVjdCAodGhhdCwgb2JqKSB7CgkgIGlmIChCdWZmZXIuaXNCdWZmZXIob2JqKSkgewoJICAgIHZhciBsZW4gPSBjaGVja2VkKG9iai5sZW5ndGgpIHwgMAoJICAgIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuKQoKCSAgICBpZiAodGhhdC5sZW5ndGggPT09IDApIHsKCSAgICAgIHJldHVybiB0aGF0CgkgICAgfQoKCSAgICBvYmouY29weSh0aGF0LCAwLCAwLCBsZW4pCgkgICAgcmV0dXJuIHRoYXQKCSAgfQoKCSAgaWYgKG9iaikgewoJICAgIGlmICgodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJgoJICAgICAgICBvYmouYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHx8ICdsZW5ndGgnIGluIG9iaikgewoJICAgICAgaWYgKHR5cGVvZiBvYmoubGVuZ3RoICE9PSAnbnVtYmVyJyB8fCBpc25hbihvYmoubGVuZ3RoKSkgewoJICAgICAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIDApCgkgICAgICB9CgkgICAgICByZXR1cm4gZnJvbUFycmF5TGlrZSh0aGF0LCBvYmopCgkgICAgfQoKCSAgICBpZiAob2JqLnR5cGUgPT09ICdCdWZmZXInICYmIGlzQXJyYXkob2JqLmRhdGEpKSB7CgkgICAgICByZXR1cm4gZnJvbUFycmF5TGlrZSh0aGF0LCBvYmouZGF0YSkKCSAgICB9CgkgIH0KCgkgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgQXJyYXlCdWZmZXIsIEFycmF5LCBvciBhcnJheS1saWtlIG9iamVjdC4nKQoJfQoKCWZ1bmN0aW9uIGNoZWNrZWQgKGxlbmd0aCkgewoJICAvLyBOb3RlOiBjYW5ub3QgdXNlIGBsZW5ndGggPCBrTWF4TGVuZ3RoKClgIGhlcmUgYmVjYXVzZSB0aGF0IGZhaWxzIHdoZW4KCSAgLy8gbGVuZ3RoIGlzIE5hTiAod2hpY2ggaXMgb3RoZXJ3aXNlIGNvZXJjZWQgdG8gemVyby4pCgkgIGlmIChsZW5ndGggPj0ga01heExlbmd0aCgpKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gYWxsb2NhdGUgQnVmZmVyIGxhcmdlciB0aGFuIG1heGltdW0gJyArCgkgICAgICAgICAgICAgICAgICAgICAgICAgJ3NpemU6IDB4JyArIGtNYXhMZW5ndGgoKS50b1N0cmluZygxNikgKyAnIGJ5dGVzJykKCSAgfQoJICByZXR1cm4gbGVuZ3RoIHwgMAoJfQoKCWZ1bmN0aW9uIFNsb3dCdWZmZXIgKGxlbmd0aCkgewoJICBpZiAoK2xlbmd0aCAhPSBsZW5ndGgpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBlcWVxZXEKCSAgICBsZW5ndGggPSAwCgkgIH0KCSAgcmV0dXJuIEJ1ZmZlci5hbGxvYygrbGVuZ3RoKQoJfQoKCUJ1ZmZlci5pc0J1ZmZlciA9IGZ1bmN0aW9uIGlzQnVmZmVyIChiKSB7CgkgIHJldHVybiAhIShiICE9IG51bGwgJiYgYi5faXNCdWZmZXIpCgl9CgoJQnVmZmVyLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlIChhLCBiKSB7CgkgIGlmICghQnVmZmVyLmlzQnVmZmVyKGEpIHx8ICFCdWZmZXIuaXNCdWZmZXIoYikpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzJykKCSAgfQoKCSAgaWYgKGEgPT09IGIpIHJldHVybiAwCgoJICB2YXIgeCA9IGEubGVuZ3RoCgkgIHZhciB5ID0gYi5sZW5ndGgKCgkgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBNYXRoLm1pbih4LCB5KTsgaSA8IGxlbjsgKytpKSB7CgkgICAgaWYgKGFbaV0gIT09IGJbaV0pIHsKCSAgICAgIHggPSBhW2ldCgkgICAgICB5ID0gYltpXQoJICAgICAgYnJlYWsKCSAgICB9CgkgIH0KCgkgIGlmICh4IDwgeSkgcmV0dXJuIC0xCgkgIGlmICh5IDwgeCkgcmV0dXJuIDEKCSAgcmV0dXJuIDAKCX0KCglCdWZmZXIuaXNFbmNvZGluZyA9IGZ1bmN0aW9uIGlzRW5jb2RpbmcgKGVuY29kaW5nKSB7CgkgIHN3aXRjaCAoU3RyaW5nKGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpKSB7CgkgICAgY2FzZSAnaGV4JzoKCSAgICBjYXNlICd1dGY4JzoKCSAgICBjYXNlICd1dGYtOCc6CgkgICAgY2FzZSAnYXNjaWknOgoJICAgIGNhc2UgJ2xhdGluMSc6CgkgICAgY2FzZSAnYmluYXJ5JzoKCSAgICBjYXNlICdiYXNlNjQnOgoJICAgIGNhc2UgJ3VjczInOgoJICAgIGNhc2UgJ3Vjcy0yJzoKCSAgICBjYXNlICd1dGYxNmxlJzoKCSAgICBjYXNlICd1dGYtMTZsZSc6CgkgICAgICByZXR1cm4gdHJ1ZQoJICAgIGRlZmF1bHQ6CgkgICAgICByZXR1cm4gZmFsc2UKCSAgfQoJfQoKCUJ1ZmZlci5jb25jYXQgPSBmdW5jdGlvbiBjb25jYXQgKGxpc3QsIGxlbmd0aCkgewoJICBpZiAoIWlzQXJyYXkobGlzdCkpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcibGlzdCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJykKCSAgfQoKCSAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7CgkgICAgcmV0dXJuIEJ1ZmZlci5hbGxvYygwKQoJICB9CgoJICB2YXIgaQoJICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIHsKCSAgICBsZW5ndGggPSAwCgkgICAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyArK2kpIHsKCSAgICAgIGxlbmd0aCArPSBsaXN0W2ldLmxlbmd0aAoJICAgIH0KCSAgfQoKCSAgdmFyIGJ1ZmZlciA9IEJ1ZmZlci5hbGxvY1Vuc2FmZShsZW5ndGgpCgkgIHZhciBwb3MgPSAwCgkgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7CgkgICAgdmFyIGJ1ZiA9IGxpc3RbaV0KCSAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB7CgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCcibGlzdCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJykKCSAgICB9CgkgICAgYnVmLmNvcHkoYnVmZmVyLCBwb3MpCgkgICAgcG9zICs9IGJ1Zi5sZW5ndGgKCSAgfQoJICByZXR1cm4gYnVmZmVyCgl9CgoJZnVuY3Rpb24gYnl0ZUxlbmd0aCAoc3RyaW5nLCBlbmNvZGluZykgewoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKHN0cmluZykpIHsKCSAgICByZXR1cm4gc3RyaW5nLmxlbmd0aAoJICB9CgkgIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBBcnJheUJ1ZmZlci5pc1ZpZXcgPT09ICdmdW5jdGlvbicgJiYKCSAgICAgIChBcnJheUJ1ZmZlci5pc1ZpZXcoc3RyaW5nKSB8fCBzdHJpbmcgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikpIHsKCSAgICByZXR1cm4gc3RyaW5nLmJ5dGVMZW5ndGgKCSAgfQoJICBpZiAodHlwZW9mIHN0cmluZyAhPT0gJ3N0cmluZycpIHsKCSAgICBzdHJpbmcgPSAnJyArIHN0cmluZwoJICB9CgoJICB2YXIgbGVuID0gc3RyaW5nLmxlbmd0aAoJICBpZiAobGVuID09PSAwKSByZXR1cm4gMAoKCSAgLy8gVXNlIGEgZm9yIGxvb3AgdG8gYXZvaWQgcmVjdXJzaW9uCgkgIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlCgkgIGZvciAoOzspIHsKCSAgICBzd2l0Y2ggKGVuY29kaW5nKSB7CgkgICAgICBjYXNlICdhc2NpaSc6CgkgICAgICBjYXNlICdsYXRpbjEnOgoJICAgICAgY2FzZSAnYmluYXJ5JzoKCSAgICAgICAgcmV0dXJuIGxlbgoJICAgICAgY2FzZSAndXRmOCc6CgkgICAgICBjYXNlICd1dGYtOCc6CgkgICAgICBjYXNlIHVuZGVmaW5lZDoKCSAgICAgICAgcmV0dXJuIHV0ZjhUb0J5dGVzKHN0cmluZykubGVuZ3RoCgkgICAgICBjYXNlICd1Y3MyJzoKCSAgICAgIGNhc2UgJ3Vjcy0yJzoKCSAgICAgIGNhc2UgJ3V0ZjE2bGUnOgoJICAgICAgY2FzZSAndXRmLTE2bGUnOgoJICAgICAgICByZXR1cm4gbGVuICogMgoJICAgICAgY2FzZSAnaGV4JzoKCSAgICAgICAgcmV0dXJuIGxlbiA+Pj4gMQoJICAgICAgY2FzZSAnYmFzZTY0JzoKCSAgICAgICAgcmV0dXJuIGJhc2U2NFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGgKCSAgICAgIGRlZmF1bHQ6CgkgICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgcmV0dXJuIHV0ZjhUb0J5dGVzKHN0cmluZykubGVuZ3RoIC8vIGFzc3VtZSB1dGY4CgkgICAgICAgIGVuY29kaW5nID0gKCcnICsgZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkKCSAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlCgkgICAgfQoJICB9Cgl9CglCdWZmZXIuYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGgKCglmdW5jdGlvbiBzbG93VG9TdHJpbmcgKGVuY29kaW5nLCBzdGFydCwgZW5kKSB7CgkgIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlCgoJICAvLyBObyBuZWVkIHRvIHZlcmlmeSB0aGF0ICJ0aGlzLmxlbmd0aCA8PSBNQVhfVUlOVDMyIiBzaW5jZSBpdCdzIGEgcmVhZC1vbmx5CgkgIC8vIHByb3BlcnR5IG9mIGEgdHlwZWQgYXJyYXkuCgoJICAvLyBUaGlzIGJlaGF2ZXMgbmVpdGhlciBsaWtlIFN0cmluZyBub3IgVWludDhBcnJheSBpbiB0aGF0IHdlIHNldCBzdGFydC9lbmQKCSAgLy8gdG8gdGhlaXIgdXBwZXIvbG93ZXIgYm91bmRzIGlmIHRoZSB2YWx1ZSBwYXNzZWQgaXMgb3V0IG9mIHJhbmdlLgoJICAvLyB1bmRlZmluZWQgaXMgaGFuZGxlZCBzcGVjaWFsbHkgYXMgcGVyIEVDTUEtMjYyIDZ0aCBFZGl0aW9uLAoJICAvLyBTZWN0aW9uIDEzLjMuMy43IFJ1bnRpbWUgU2VtYW50aWNzOiBLZXllZEJpbmRpbmdJbml0aWFsaXphdGlvbi4KCSAgaWYgKHN0YXJ0ID09PSB1bmRlZmluZWQgfHwgc3RhcnQgPCAwKSB7CgkgICAgc3RhcnQgPSAwCgkgIH0KCSAgLy8gUmV0dXJuIGVhcmx5IGlmIHN0YXJ0ID4gdGhpcy5sZW5ndGguIERvbmUgaGVyZSB0byBwcmV2ZW50IHBvdGVudGlhbCB1aW50MzIKCSAgLy8gY29lcmNpb24gZmFpbCBiZWxvdy4KCSAgaWYgKHN0YXJ0ID4gdGhpcy5sZW5ndGgpIHsKCSAgICByZXR1cm4gJycKCSAgfQoKCSAgaWYgKGVuZCA9PT0gdW5kZWZpbmVkIHx8IGVuZCA+IHRoaXMubGVuZ3RoKSB7CgkgICAgZW5kID0gdGhpcy5sZW5ndGgKCSAgfQoKCSAgaWYgKGVuZCA8PSAwKSB7CgkgICAgcmV0dXJuICcnCgkgIH0KCgkgIC8vIEZvcmNlIGNvZXJzaW9uIHRvIHVpbnQzMi4gVGhpcyB3aWxsIGFsc28gY29lcmNlIGZhbHNleS9OYU4gdmFsdWVzIHRvIDAuCgkgIGVuZCA+Pj49IDAKCSAgc3RhcnQgPj4+PSAwCgoJICBpZiAoZW5kIDw9IHN0YXJ0KSB7CgkgICAgcmV0dXJuICcnCgkgIH0KCgkgIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnCgoJICB3aGlsZSAodHJ1ZSkgewoJICAgIHN3aXRjaCAoZW5jb2RpbmcpIHsKCSAgICAgIGNhc2UgJ2hleCc6CgkgICAgICAgIHJldHVybiBoZXhTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGNhc2UgJ3V0ZjgnOgoJICAgICAgY2FzZSAndXRmLTgnOgoJICAgICAgICByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgY2FzZSAnYXNjaWknOgoJICAgICAgICByZXR1cm4gYXNjaWlTbGljZSh0aGlzLCBzdGFydCwgZW5kKQoKCSAgICAgIGNhc2UgJ2xhdGluMSc6CgkgICAgICBjYXNlICdiaW5hcnknOgoJICAgICAgICByZXR1cm4gbGF0aW4xU2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICdiYXNlNjQnOgoJICAgICAgICByZXR1cm4gYmFzZTY0U2xpY2UodGhpcywgc3RhcnQsIGVuZCkKCgkgICAgICBjYXNlICd1Y3MyJzoKCSAgICAgIGNhc2UgJ3Vjcy0yJzoKCSAgICAgIGNhc2UgJ3V0ZjE2bGUnOgoJICAgICAgY2FzZSAndXRmLTE2bGUnOgoJICAgICAgICByZXR1cm4gdXRmMTZsZVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpCgoJICAgICAgZGVmYXVsdDoKCSAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpCgkgICAgICAgIGVuY29kaW5nID0gKGVuY29kaW5nICsgJycpLnRvTG93ZXJDYXNlKCkKCSAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlCgkgICAgfQoJICB9Cgl9CgoJLy8gVGhlIHByb3BlcnR5IGlzIHVzZWQgYnkgYEJ1ZmZlci5pc0J1ZmZlcmAgYW5kIGBpcy1idWZmZXJgIChpbiBTYWZhcmkgNS03KSB0byBkZXRlY3QKCS8vIEJ1ZmZlciBpbnN0YW5jZXMuCglCdWZmZXIucHJvdG90eXBlLl9pc0J1ZmZlciA9IHRydWUKCglmdW5jdGlvbiBzd2FwIChiLCBuLCBtKSB7CgkgIHZhciBpID0gYltuXQoJICBiW25dID0gYlttXQoJICBiW21dID0gaQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuc3dhcDE2ID0gZnVuY3Rpb24gc3dhcDE2ICgpIHsKCSAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoCgkgIGlmIChsZW4gJSAyICE9PSAwKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAxNi1iaXRzJykKCSAgfQoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7CgkgICAgc3dhcCh0aGlzLCBpLCBpICsgMSkKCSAgfQoJICByZXR1cm4gdGhpcwoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuc3dhcDMyID0gZnVuY3Rpb24gc3dhcDMyICgpIHsKCSAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoCgkgIGlmIChsZW4gJSA0ICE9PSAwKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAzMi1iaXRzJykKCSAgfQoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSA0KSB7CgkgICAgc3dhcCh0aGlzLCBpLCBpICsgMykKCSAgICBzd2FwKHRoaXMsIGkgKyAxLCBpICsgMikKCSAgfQoJICByZXR1cm4gdGhpcwoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuc3dhcDY0ID0gZnVuY3Rpb24gc3dhcDY0ICgpIHsKCSAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoCgkgIGlmIChsZW4gJSA4ICE9PSAwKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA2NC1iaXRzJykKCSAgfQoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSA4KSB7CgkgICAgc3dhcCh0aGlzLCBpLCBpICsgNykKCSAgICBzd2FwKHRoaXMsIGkgKyAxLCBpICsgNikKCSAgICBzd2FwKHRoaXMsIGkgKyAyLCBpICsgNSkKCSAgICBzd2FwKHRoaXMsIGkgKyAzLCBpICsgNCkKCSAgfQoJICByZXR1cm4gdGhpcwoJfQoKCUJ1ZmZlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZyAoKSB7CgkgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCB8IDAKCSAgaWYgKGxlbmd0aCA9PT0gMCkgcmV0dXJuICcnCgkgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIDAsIGxlbmd0aCkKCSAgcmV0dXJuIHNsb3dUb1N0cmluZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiBlcXVhbHMgKGIpIHsKCSAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYikpIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKQoJICBpZiAodGhpcyA9PT0gYikgcmV0dXJuIHRydWUKCSAgcmV0dXJuIEJ1ZmZlci5jb21wYXJlKHRoaXMsIGIpID09PSAwCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5pbnNwZWN0ID0gZnVuY3Rpb24gaW5zcGVjdCAoKSB7CgkgIHZhciBzdHIgPSAnJwoJICB2YXIgbWF4ID0gZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFUwoJICBpZiAodGhpcy5sZW5ndGggPiAwKSB7CgkgICAgc3RyID0gdGhpcy50b1N0cmluZygnaGV4JywgMCwgbWF4KS5tYXRjaCgvLnsyfS9nKS5qb2luKCcgJykKCSAgICBpZiAodGhpcy5sZW5ndGggPiBtYXgpIHN0ciArPSAnIC4uLiAnCgkgIH0KCSAgcmV0dXJuICc8QnVmZmVyICcgKyBzdHIgKyAnPicKCX0KCglCdWZmZXIucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlICh0YXJnZXQsIHN0YXJ0LCBlbmQsIHRoaXNTdGFydCwgdGhpc0VuZCkgewoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcih0YXJnZXQpKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpCgkgIH0KCgkgIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgc3RhcnQgPSAwCgkgIH0KCSAgaWYgKGVuZCA9PT0gdW5kZWZpbmVkKSB7CgkgICAgZW5kID0gdGFyZ2V0ID8gdGFyZ2V0Lmxlbmd0aCA6IDAKCSAgfQoJICBpZiAodGhpc1N0YXJ0ID09PSB1bmRlZmluZWQpIHsKCSAgICB0aGlzU3RhcnQgPSAwCgkgIH0KCSAgaWYgKHRoaXNFbmQgPT09IHVuZGVmaW5lZCkgewoJICAgIHRoaXNFbmQgPSB0aGlzLmxlbmd0aAoJICB9CgoJICBpZiAoc3RhcnQgPCAwIHx8IGVuZCA+IHRhcmdldC5sZW5ndGggfHwgdGhpc1N0YXJ0IDwgMCB8fCB0aGlzRW5kID4gdGhpcy5sZW5ndGgpIHsKCSAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignb3V0IG9mIHJhbmdlIGluZGV4JykKCSAgfQoKCSAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kICYmIHN0YXJ0ID49IGVuZCkgewoJICAgIHJldHVybiAwCgkgIH0KCSAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kKSB7CgkgICAgcmV0dXJuIC0xCgkgIH0KCSAgaWYgKHN0YXJ0ID49IGVuZCkgewoJICAgIHJldHVybiAxCgkgIH0KCgkgIHN0YXJ0ID4+Pj0gMAoJICBlbmQgPj4+PSAwCgkgIHRoaXNTdGFydCA+Pj49IDAKCSAgdGhpc0VuZCA+Pj49IDAKCgkgIGlmICh0aGlzID09PSB0YXJnZXQpIHJldHVybiAwCgoJICB2YXIgeCA9IHRoaXNFbmQgLSB0aGlzU3RhcnQKCSAgdmFyIHkgPSBlbmQgLSBzdGFydAoJICB2YXIgbGVuID0gTWF0aC5taW4oeCwgeSkKCgkgIHZhciB0aGlzQ29weSA9IHRoaXMuc2xpY2UodGhpc1N0YXJ0LCB0aGlzRW5kKQoJICB2YXIgdGFyZ2V0Q29weSA9IHRhcmdldC5zbGljZShzdGFydCwgZW5kKQoKCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkgewoJICAgIGlmICh0aGlzQ29weVtpXSAhPT0gdGFyZ2V0Q29weVtpXSkgewoJICAgICAgeCA9IHRoaXNDb3B5W2ldCgkgICAgICB5ID0gdGFyZ2V0Q29weVtpXQoJICAgICAgYnJlYWsKCSAgICB9CgkgIH0KCgkgIGlmICh4IDwgeSkgcmV0dXJuIC0xCgkgIGlmICh5IDwgeCkgcmV0dXJuIDEKCSAgcmV0dXJuIDAKCX0KCgkvLyBGaW5kcyBlaXRoZXIgdGhlIGZpcnN0IGluZGV4IG9mIGB2YWxgIGluIGBidWZmZXJgIGF0IG9mZnNldCA+PSBgYnl0ZU9mZnNldGAsCgkvLyBPUiB0aGUgbGFzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPD0gYGJ5dGVPZmZzZXRgLgoJLy8KCS8vIEFyZ3VtZW50czoKCS8vIC0gYnVmZmVyIC0gYSBCdWZmZXIgdG8gc2VhcmNoCgkvLyAtIHZhbCAtIGEgc3RyaW5nLCBCdWZmZXIsIG9yIG51bWJlcgoJLy8gLSBieXRlT2Zmc2V0IC0gYW4gaW5kZXggaW50byBgYnVmZmVyYDsgd2lsbCBiZSBjbGFtcGVkIHRvIGFuIGludDMyCgkvLyAtIGVuY29kaW5nIC0gYW4gb3B0aW9uYWwgZW5jb2RpbmcsIHJlbGV2YW50IGlzIHZhbCBpcyBhIHN0cmluZwoJLy8gLSBkaXIgLSB0cnVlIGZvciBpbmRleE9mLCBmYWxzZSBmb3IgbGFzdEluZGV4T2YKCWZ1bmN0aW9uIGJpZGlyZWN0aW9uYWxJbmRleE9mIChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikgewoJICAvLyBFbXB0eSBidWZmZXIgbWVhbnMgbm8gbWF0Y2gKCSAgaWYgKGJ1ZmZlci5sZW5ndGggPT09IDApIHJldHVybiAtMQoKCSAgLy8gTm9ybWFsaXplIGJ5dGVPZmZzZXQKCSAgaWYgKHR5cGVvZiBieXRlT2Zmc2V0ID09PSAnc3RyaW5nJykgewoJICAgIGVuY29kaW5nID0gYnl0ZU9mZnNldAoJICAgIGJ5dGVPZmZzZXQgPSAwCgkgIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA+IDB4N2ZmZmZmZmYpIHsKCSAgICBieXRlT2Zmc2V0ID0gMHg3ZmZmZmZmZgoJICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAtMHg4MDAwMDAwMCkgewoJICAgIGJ5dGVPZmZzZXQgPSAtMHg4MDAwMDAwMAoJICB9CgkgIGJ5dGVPZmZzZXQgPSArYnl0ZU9mZnNldCAgLy8gQ29lcmNlIHRvIE51bWJlci4KCSAgaWYgKGlzTmFOKGJ5dGVPZmZzZXQpKSB7CgkgICAgLy8gYnl0ZU9mZnNldDogaXQgaXQncyB1bmRlZmluZWQsIG51bGwsIE5hTiwgImZvbyIsIGV0Yywgc2VhcmNoIHdob2xlIGJ1ZmZlcgoJICAgIGJ5dGVPZmZzZXQgPSBkaXIgPyAwIDogKGJ1ZmZlci5sZW5ndGggLSAxKQoJICB9CgoJICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldDogbmVnYXRpdmUgb2Zmc2V0cyBzdGFydCBmcm9tIHRoZSBlbmQgb2YgdGhlIGJ1ZmZlcgoJICBpZiAoYnl0ZU9mZnNldCA8IDApIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoICsgYnl0ZU9mZnNldAoJICBpZiAoYnl0ZU9mZnNldCA+PSBidWZmZXIubGVuZ3RoKSB7CgkgICAgaWYgKGRpcikgcmV0dXJuIC0xCgkgICAgZWxzZSBieXRlT2Zmc2V0ID0gYnVmZmVyLmxlbmd0aCAtIDEKCSAgfSBlbHNlIGlmIChieXRlT2Zmc2V0IDwgMCkgewoJICAgIGlmIChkaXIpIGJ5dGVPZmZzZXQgPSAwCgkgICAgZWxzZSByZXR1cm4gLTEKCSAgfQoKCSAgLy8gTm9ybWFsaXplIHZhbAoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHsKCSAgICB2YWwgPSBCdWZmZXIuZnJvbSh2YWwsIGVuY29kaW5nKQoJICB9CgoJICAvLyBGaW5hbGx5LCBzZWFyY2ggZWl0aGVyIGluZGV4T2YgKGlmIGRpciBpcyB0cnVlKSBvciBsYXN0SW5kZXhPZgoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKHZhbCkpIHsKCSAgICAvLyBTcGVjaWFsIGNhc2U6IGxvb2tpbmcgZm9yIGVtcHR5IHN0cmluZy9idWZmZXIgYWx3YXlzIGZhaWxzCgkgICAgaWYgKHZhbC5sZW5ndGggPT09IDApIHsKCSAgICAgIHJldHVybiAtMQoJICAgIH0KCSAgICByZXR1cm4gYXJyYXlJbmRleE9mKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKQoJICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7CgkgICAgdmFsID0gdmFsICYgMHhGRiAvLyBTZWFyY2ggZm9yIGEgYnl0ZSB2YWx1ZSBbMC0yNTVdCgkgICAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmCgkgICAgICAgIHR5cGVvZiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICBpZiAoZGlyKSB7CgkgICAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpCgkgICAgICB9IGVsc2UgewoJICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUubGFzdEluZGV4T2YuY2FsbChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCkKCSAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIFsgdmFsIF0sIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpCgkgIH0KCgkgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ZhbCBtdXN0IGJlIHN0cmluZywgbnVtYmVyIG9yIEJ1ZmZlcicpCgl9CgoJZnVuY3Rpb24gYXJyYXlJbmRleE9mIChhcnIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikgewoJICB2YXIgaW5kZXhTaXplID0gMQoJICB2YXIgYXJyTGVuZ3RoID0gYXJyLmxlbmd0aAoJICB2YXIgdmFsTGVuZ3RoID0gdmFsLmxlbmd0aAoKCSAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQpIHsKCSAgICBlbmNvZGluZyA9IFN0cmluZyhlbmNvZGluZykudG9Mb3dlckNhc2UoKQoJICAgIGlmIChlbmNvZGluZyA9PT0gJ3VjczInIHx8IGVuY29kaW5nID09PSAndWNzLTInIHx8CgkgICAgICAgIGVuY29kaW5nID09PSAndXRmMTZsZScgfHwgZW5jb2RpbmcgPT09ICd1dGYtMTZsZScpIHsKCSAgICAgIGlmIChhcnIubGVuZ3RoIDwgMiB8fCB2YWwubGVuZ3RoIDwgMikgewoJICAgICAgICByZXR1cm4gLTEKCSAgICAgIH0KCSAgICAgIGluZGV4U2l6ZSA9IDIKCSAgICAgIGFyckxlbmd0aCAvPSAyCgkgICAgICB2YWxMZW5ndGggLz0gMgoJICAgICAgYnl0ZU9mZnNldCAvPSAyCgkgICAgfQoJICB9CgoJICBmdW5jdGlvbiByZWFkIChidWYsIGkpIHsKCSAgICBpZiAoaW5kZXhTaXplID09PSAxKSB7CgkgICAgICByZXR1cm4gYnVmW2ldCgkgICAgfSBlbHNlIHsKCSAgICAgIHJldHVybiBidWYucmVhZFVJbnQxNkJFKGkgKiBpbmRleFNpemUpCgkgICAgfQoJICB9CgoJICB2YXIgaQoJICBpZiAoZGlyKSB7CgkgICAgdmFyIGZvdW5kSW5kZXggPSAtMQoJICAgIGZvciAoaSA9IGJ5dGVPZmZzZXQ7IGkgPCBhcnJMZW5ndGg7IGkrKykgewoJICAgICAgaWYgKHJlYWQoYXJyLCBpKSA9PT0gcmVhZCh2YWwsIGZvdW5kSW5kZXggPT09IC0xID8gMCA6IGkgLSBmb3VuZEluZGV4KSkgewoJICAgICAgICBpZiAoZm91bmRJbmRleCA9PT0gLTEpIGZvdW5kSW5kZXggPSBpCgkgICAgICAgIGlmIChpIC0gZm91bmRJbmRleCArIDEgPT09IHZhbExlbmd0aCkgcmV0dXJuIGZvdW5kSW5kZXggKiBpbmRleFNpemUKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGlmIChmb3VuZEluZGV4ICE9PSAtMSkgaSAtPSBpIC0gZm91bmRJbmRleAoJICAgICAgICBmb3VuZEluZGV4ID0gLTEKCSAgICAgIH0KCSAgICB9CgkgIH0gZWxzZSB7CgkgICAgaWYgKGJ5dGVPZmZzZXQgKyB2YWxMZW5ndGggPiBhcnJMZW5ndGgpIGJ5dGVPZmZzZXQgPSBhcnJMZW5ndGggLSB2YWxMZW5ndGgKCSAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpID49IDA7IGktLSkgewoJICAgICAgdmFyIGZvdW5kID0gdHJ1ZQoJICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB2YWxMZW5ndGg7IGorKykgewoJICAgICAgICBpZiAocmVhZChhcnIsIGkgKyBqKSAhPT0gcmVhZCh2YWwsIGopKSB7CgkgICAgICAgICAgZm91bmQgPSBmYWxzZQoJICAgICAgICAgIGJyZWFrCgkgICAgICAgIH0KCSAgICAgIH0KCSAgICAgIGlmIChmb3VuZCkgcmV0dXJuIGkKCSAgICB9CgkgIH0KCgkgIHJldHVybiAtMQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuaW5jbHVkZXMgPSBmdW5jdGlvbiBpbmNsdWRlcyAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgewoJICByZXR1cm4gdGhpcy5pbmRleE9mKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpICE9PSAtMQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHsKCSAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIHRydWUpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5sYXN0SW5kZXhPZiA9IGZ1bmN0aW9uIGxhc3RJbmRleE9mICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7CgkgIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBmYWxzZSkKCX0KCglmdW5jdGlvbiBoZXhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIG9mZnNldCA9IE51bWJlcihvZmZzZXQpIHx8IDAKCSAgdmFyIHJlbWFpbmluZyA9IGJ1Zi5sZW5ndGggLSBvZmZzZXQKCSAgaWYgKCFsZW5ndGgpIHsKCSAgICBsZW5ndGggPSByZW1haW5pbmcKCSAgfSBlbHNlIHsKCSAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKQoJICAgIGlmIChsZW5ndGggPiByZW1haW5pbmcpIHsKCSAgICAgIGxlbmd0aCA9IHJlbWFpbmluZwoJICAgIH0KCSAgfQoKCSAgLy8gbXVzdCBiZSBhbiBldmVuIG51bWJlciBvZiBkaWdpdHMKCSAgdmFyIHN0ckxlbiA9IHN0cmluZy5sZW5ndGgKCSAgaWYgKHN0ckxlbiAlIDIgIT09IDApIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpCgoJICBpZiAobGVuZ3RoID4gc3RyTGVuIC8gMikgewoJICAgIGxlbmd0aCA9IHN0ckxlbiAvIDIKCSAgfQoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CgkgICAgdmFyIHBhcnNlZCA9IHBhcnNlSW50KHN0cmluZy5zdWJzdHIoaSAqIDIsIDIpLCAxNikKCSAgICBpZiAoaXNOYU4ocGFyc2VkKSkgcmV0dXJuIGkKCSAgICBidWZbb2Zmc2V0ICsgaV0gPSBwYXJzZWQKCSAgfQoJICByZXR1cm4gaQoJfQoKCWZ1bmN0aW9uIHV0ZjhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKHV0ZjhUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpCgl9CgoJZnVuY3Rpb24gYXNjaWlXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKGFzY2lpVG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIGxhdGluMVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHsKCSAgcmV0dXJuIGFzY2lpV3JpdGUoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIGJhc2U2NFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHsKCSAgcmV0dXJuIGJsaXRCdWZmZXIoYmFzZTY0VG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKQoJfQoKCWZ1bmN0aW9uIHVjczJXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7CgkgIHJldHVybiBibGl0QnVmZmVyKHV0ZjE2bGVUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIHdyaXRlIChzdHJpbmcsIG9mZnNldCwgbGVuZ3RoLCBlbmNvZGluZykgewoJICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nKQoJICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIHsKCSAgICBlbmNvZGluZyA9ICd1dGY4JwoJICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoCgkgICAgb2Zmc2V0ID0gMAoJICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBlbmNvZGluZykKCSAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygb2Zmc2V0ID09PSAnc3RyaW5nJykgewoJICAgIGVuY29kaW5nID0gb2Zmc2V0CgkgICAgbGVuZ3RoID0gdGhpcy5sZW5ndGgKCSAgICBvZmZzZXQgPSAwCgkgIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcsIG9mZnNldFssIGxlbmd0aF1bLCBlbmNvZGluZ10pCgkgIH0gZWxzZSBpZiAoaXNGaW5pdGUob2Zmc2V0KSkgewoJICAgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgICBpZiAoaXNGaW5pdGUobGVuZ3RoKSkgewoJICAgICAgbGVuZ3RoID0gbGVuZ3RoIHwgMAoJICAgICAgaWYgKGVuY29kaW5nID09PSB1bmRlZmluZWQpIGVuY29kaW5nID0gJ3V0ZjgnCgkgICAgfSBlbHNlIHsKCSAgICAgIGVuY29kaW5nID0gbGVuZ3RoCgkgICAgICBsZW5ndGggPSB1bmRlZmluZWQKCSAgICB9CgkgIC8vIGxlZ2FjeSB3cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXQsIGxlbmd0aCkgLSByZW1vdmUgaW4gdjAuMTMKCSAgfSBlbHNlIHsKCSAgICB0aHJvdyBuZXcgRXJyb3IoCgkgICAgICAnQnVmZmVyLndyaXRlKHN0cmluZywgZW5jb2RpbmcsIG9mZnNldFssIGxlbmd0aF0pIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQnCgkgICAgKQoJICB9CgoJICB2YXIgcmVtYWluaW5nID0gdGhpcy5sZW5ndGggLSBvZmZzZXQKCSAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkIHx8IGxlbmd0aCA+IHJlbWFpbmluZykgbGVuZ3RoID0gcmVtYWluaW5nCgoJICBpZiAoKHN0cmluZy5sZW5ndGggPiAwICYmIChsZW5ndGggPCAwIHx8IG9mZnNldCA8IDApKSB8fCBvZmZzZXQgPiB0aGlzLmxlbmd0aCkgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIHdyaXRlIG91dHNpZGUgYnVmZmVyIGJvdW5kcycpCgkgIH0KCgkgIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnCgoJICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZQoJICBmb3IgKDs7KSB7CgkgICAgc3dpdGNoIChlbmNvZGluZykgewoJICAgICAgY2FzZSAnaGV4JzoKCSAgICAgICAgcmV0dXJuIGhleFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgY2FzZSAndXRmOCc6CgkgICAgICBjYXNlICd1dGYtOCc6CgkgICAgICAgIHJldHVybiB1dGY4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBjYXNlICdhc2NpaSc6CgkgICAgICAgIHJldHVybiBhc2NpaVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpCgoJICAgICAgY2FzZSAnbGF0aW4xJzoKCSAgICAgIGNhc2UgJ2JpbmFyeSc6CgkgICAgICAgIHJldHVybiBsYXRpbjFXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGNhc2UgJ2Jhc2U2NCc6CgkgICAgICAgIC8vIFdhcm5pbmc6IG1heExlbmd0aCBub3QgdGFrZW4gaW50byBhY2NvdW50IGluIGJhc2U2NFdyaXRlCgkgICAgICAgIHJldHVybiBiYXNlNjRXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKQoKCSAgICAgIGNhc2UgJ3VjczInOgoJICAgICAgY2FzZSAndWNzLTInOgoJICAgICAgY2FzZSAndXRmMTZsZSc6CgkgICAgICBjYXNlICd1dGYtMTZsZSc6CgkgICAgICAgIHJldHVybiB1Y3MyV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkKCgkgICAgICBkZWZhdWx0OgoJICAgICAgICBpZiAobG93ZXJlZENhc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZykKCSAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKQoJICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWUKCSAgICB9CgkgIH0KCX0KCglCdWZmZXIucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIHRvSlNPTiAoKSB7CgkgIHJldHVybiB7CgkgICAgdHlwZTogJ0J1ZmZlcicsCgkgICAgZGF0YTogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5fYXJyIHx8IHRoaXMsIDApCgkgIH0KCX0KCglmdW5jdGlvbiBiYXNlNjRTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIGlmIChzdGFydCA9PT0gMCAmJiBlbmQgPT09IGJ1Zi5sZW5ndGgpIHsKCSAgICByZXR1cm4gYmFzZTY0LmZyb21CeXRlQXJyYXkoYnVmKQoJICB9IGVsc2UgewoJICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYuc2xpY2Uoc3RhcnQsIGVuZCkpCgkgIH0KCX0KCglmdW5jdGlvbiB1dGY4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpCgkgIHZhciByZXMgPSBbXQoKCSAgdmFyIGkgPSBzdGFydAoJICB3aGlsZSAoaSA8IGVuZCkgewoJICAgIHZhciBmaXJzdEJ5dGUgPSBidWZbaV0KCSAgICB2YXIgY29kZVBvaW50ID0gbnVsbAoJICAgIHZhciBieXRlc1BlclNlcXVlbmNlID0gKGZpcnN0Qnl0ZSA+IDB4RUYpID8gNAoJICAgICAgOiAoZmlyc3RCeXRlID4gMHhERikgPyAzCgkgICAgICA6IChmaXJzdEJ5dGUgPiAweEJGKSA/IDIKCSAgICAgIDogMQoKCSAgICBpZiAoaSArIGJ5dGVzUGVyU2VxdWVuY2UgPD0gZW5kKSB7CgkgICAgICB2YXIgc2Vjb25kQnl0ZSwgdGhpcmRCeXRlLCBmb3VydGhCeXRlLCB0ZW1wQ29kZVBvaW50CgoJICAgICAgc3dpdGNoIChieXRlc1BlclNlcXVlbmNlKSB7CgkgICAgICAgIGNhc2UgMToKCSAgICAgICAgICBpZiAoZmlyc3RCeXRlIDwgMHg4MCkgewoJICAgICAgICAgICAgY29kZVBvaW50ID0gZmlyc3RCeXRlCgkgICAgICAgICAgfQoJICAgICAgICAgIGJyZWFrCgkgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXQoJICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4MUYpIDw8IDB4NiB8IChzZWNvbmRCeXRlICYgMHgzRikKCSAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3RikgewoJICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfQoJICAgICAgICAgIGJyZWFrCgkgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXQoJICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl0KCSAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAodGhpcmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHsKCSAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweEMgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpIDw8IDB4NiB8ICh0aGlyZEJ5dGUgJiAweDNGKQoJICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGRiAmJiAodGVtcENvZGVQb2ludCA8IDB4RDgwMCB8fCB0ZW1wQ29kZVBvaW50ID4gMHhERkZGKSkgewoJICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfQoJICAgICAgICAgIGJyZWFrCgkgICAgICAgIGNhc2UgNDoKCSAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXQoJICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl0KCSAgICAgICAgICBmb3VydGhCeXRlID0gYnVmW2kgKyAzXQoJICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAoZm91cnRoQnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHgxMiB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHhDIHwgKHRoaXJkQnl0ZSAmIDB4M0YpIDw8IDB4NiB8IChmb3VydGhCeXRlICYgMHgzRikKCSAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHhGRkZGICYmIHRlbXBDb2RlUG9pbnQgPCAweDExMDAwMCkgewoJICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfQoJICAgICAgfQoJICAgIH0KCgkgICAgaWYgKGNvZGVQb2ludCA9PT0gbnVsbCkgewoJICAgICAgLy8gd2UgZGlkIG5vdCBnZW5lcmF0ZSBhIHZhbGlkIGNvZGVQb2ludCBzbyBpbnNlcnQgYQoJICAgICAgLy8gcmVwbGFjZW1lbnQgY2hhciAoVStGRkZEKSBhbmQgYWR2YW5jZSBvbmx5IDEgYnl0ZQoJICAgICAgY29kZVBvaW50ID0gMHhGRkZECgkgICAgICBieXRlc1BlclNlcXVlbmNlID0gMQoJICAgIH0gZWxzZSBpZiAoY29kZVBvaW50ID4gMHhGRkZGKSB7CgkgICAgICAvLyBlbmNvZGUgdG8gdXRmMTYgKHN1cnJvZ2F0ZSBwYWlyIGRhbmNlKQoJICAgICAgY29kZVBvaW50IC09IDB4MTAwMDAKCSAgICAgIHJlcy5wdXNoKGNvZGVQb2ludCA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMCkKCSAgICAgIGNvZGVQb2ludCA9IDB4REMwMCB8IGNvZGVQb2ludCAmIDB4M0ZGCgkgICAgfQoKCSAgICByZXMucHVzaChjb2RlUG9pbnQpCgkgICAgaSArPSBieXRlc1BlclNlcXVlbmNlCgkgIH0KCgkgIHJldHVybiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkocmVzKQoJfQoKCS8vIEJhc2VkIG9uIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIyNzQ3MjcyLzY4MDc0MiwgdGhlIGJyb3dzZXIgd2l0aAoJLy8gdGhlIGxvd2VzdCBsaW1pdCBpcyBDaHJvbWUsIHdpdGggMHgxMDAwMCBhcmdzLgoJLy8gV2UgZ28gMSBtYWduaXR1ZGUgbGVzcywgZm9yIHNhZmV0eQoJdmFyIE1BWF9BUkdVTUVOVFNfTEVOR1RIID0gMHgxMDAwCgoJZnVuY3Rpb24gZGVjb2RlQ29kZVBvaW50c0FycmF5IChjb2RlUG9pbnRzKSB7CgkgIHZhciBsZW4gPSBjb2RlUG9pbnRzLmxlbmd0aAoJICBpZiAobGVuIDw9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKSB7CgkgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLCBjb2RlUG9pbnRzKSAvLyBhdm9pZCBleHRyYSBzbGljZSgpCgkgIH0KCgkgIC8vIERlY29kZSBpbiBjaHVua3MgdG8gYXZvaWQgImNhbGwgc3RhY2sgc2l6ZSBleGNlZWRlZCIuCgkgIHZhciByZXMgPSAnJwoJICB2YXIgaSA9IDAKCSAgd2hpbGUgKGkgPCBsZW4pIHsKCSAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseSgKCSAgICAgIFN0cmluZywKCSAgICAgIGNvZGVQb2ludHMuc2xpY2UoaSwgaSArPSBNQVhfQVJHVU1FTlRTX0xFTkdUSCkKCSAgICApCgkgIH0KCSAgcmV0dXJuIHJlcwoJfQoKCWZ1bmN0aW9uIGFzY2lpU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICB2YXIgcmV0ID0gJycKCSAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKQoKCSAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHsKCSAgICByZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZbaV0gJiAweDdGKQoJICB9CgkgIHJldHVybiByZXQKCX0KCglmdW5jdGlvbiBsYXRpbjFTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7CgkgIHZhciByZXQgPSAnJwoJICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpCgoJICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkgewoJICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSkKCSAgfQoJICByZXR1cm4gcmV0Cgl9CgoJZnVuY3Rpb24gaGV4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICB2YXIgbGVuID0gYnVmLmxlbmd0aAoKCSAgaWYgKCFzdGFydCB8fCBzdGFydCA8IDApIHN0YXJ0ID0gMAoJICBpZiAoIWVuZCB8fCBlbmQgPCAwIHx8IGVuZCA+IGxlbikgZW5kID0gbGVuCgoJICB2YXIgb3V0ID0gJycKCSAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHsKCSAgICBvdXQgKz0gdG9IZXgoYnVmW2ldKQoJICB9CgkgIHJldHVybiBvdXQKCX0KCglmdW5jdGlvbiB1dGYxNmxlU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkgewoJICB2YXIgYnl0ZXMgPSBidWYuc2xpY2Uoc3RhcnQsIGVuZCkKCSAgdmFyIHJlcyA9ICcnCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpICs9IDIpIHsKCSAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1tpXSArIGJ5dGVzW2kgKyAxXSAqIDI1NikKCSAgfQoJICByZXR1cm4gcmVzCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5zbGljZSA9IGZ1bmN0aW9uIHNsaWNlIChzdGFydCwgZW5kKSB7CgkgIHZhciBsZW4gPSB0aGlzLmxlbmd0aAoJICBzdGFydCA9IH5+c3RhcnQKCSAgZW5kID0gZW5kID09PSB1bmRlZmluZWQgPyBsZW4gOiB+fmVuZAoKCSAgaWYgKHN0YXJ0IDwgMCkgewoJICAgIHN0YXJ0ICs9IGxlbgoJICAgIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMAoJICB9IGVsc2UgaWYgKHN0YXJ0ID4gbGVuKSB7CgkgICAgc3RhcnQgPSBsZW4KCSAgfQoKCSAgaWYgKGVuZCA8IDApIHsKCSAgICBlbmQgKz0gbGVuCgkgICAgaWYgKGVuZCA8IDApIGVuZCA9IDAKCSAgfSBlbHNlIGlmIChlbmQgPiBsZW4pIHsKCSAgICBlbmQgPSBsZW4KCSAgfQoKCSAgaWYgKGVuZCA8IHN0YXJ0KSBlbmQgPSBzdGFydAoKCSAgdmFyIG5ld0J1ZgoJICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgICBuZXdCdWYgPSB0aGlzLnN1YmFycmF5KHN0YXJ0LCBlbmQpCgkgICAgbmV3QnVmLl9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGUKCSAgfSBlbHNlIHsKCSAgICB2YXIgc2xpY2VMZW4gPSBlbmQgLSBzdGFydAoJICAgIG5ld0J1ZiA9IG5ldyBCdWZmZXIoc2xpY2VMZW4sIHVuZGVmaW5lZCkKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNsaWNlTGVuOyArK2kpIHsKCSAgICAgIG5ld0J1ZltpXSA9IHRoaXNbaSArIHN0YXJ0XQoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIG5ld0J1ZgoJfQoKCS8qCgkgKiBOZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IGJ1ZmZlciBpc24ndCB0cnlpbmcgdG8gd3JpdGUgb3V0IG9mIGJvdW5kcy4KCSAqLwoJZnVuY3Rpb24gY2hlY2tPZmZzZXQgKG9mZnNldCwgZXh0LCBsZW5ndGgpIHsKCSAgaWYgKChvZmZzZXQgJSAxKSAhPT0gMCB8fCBvZmZzZXQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignb2Zmc2V0IGlzIG5vdCB1aW50JykKCSAgaWYgKG9mZnNldCArIGV4dCA+IGxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RyeWluZyB0byBhY2Nlc3MgYmV5b25kIGJ1ZmZlciBsZW5ndGgnKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRMRSA9IGZ1bmN0aW9uIHJlYWRVSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCkKCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldF0KCSAgdmFyIG11bCA9IDEKCSAgdmFyIGkgPSAwCgkgIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWwKCSAgfQoKCSAgcmV0dXJuIHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRCRSA9IGZ1bmN0aW9uIHJlYWRVSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgewoJICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpCgkgIH0KCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0KCSAgdmFyIG11bCA9IDEKCSAgd2hpbGUgKGJ5dGVMZW5ndGggPiAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXSAqIG11bAoJICB9CgoJICByZXR1cm4gdmFsCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiByZWFkVUludDggKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aCkKCSAgcmV0dXJuIHRoaXNbb2Zmc2V0XQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkxFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiB0aGlzW29mZnNldF0gfCAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkJFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDgpIHwgdGhpc1tvZmZzZXQgKyAxXQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgoJICByZXR1cm4gKCh0aGlzW29mZnNldF0pIHwKCSAgICAgICh0aGlzW29mZnNldCArIDFdIDw8IDgpIHwKCSAgICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSkgKwoJICAgICAgKHRoaXNbb2Zmc2V0ICsgM10gKiAweDEwMDAwMDApCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDMyQkUgPSBmdW5jdGlvbiByZWFkVUludDMyQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aCkKCgkgIHJldHVybiAodGhpc1tvZmZzZXRdICogMHgxMDAwMDAwKSArCgkgICAgKCh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfAoJICAgIHRoaXNbb2Zmc2V0ICsgM10pCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50TEUgPSBmdW5jdGlvbiByZWFkSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aCkKCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldF0KCSAgdmFyIG11bCA9IDEKCSAgdmFyIGkgPSAwCgkgIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWwKCSAgfQoJICBtdWwgKj0gMHg4MAoKCSAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkKCgkgIHJldHVybiB2YWwKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnRCRSA9IGZ1bmN0aW9uIHJlYWRJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKQoKCSAgdmFyIGkgPSBieXRlTGVuZ3RoCgkgIHZhciBtdWwgPSAxCgkgIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0taV0KCSAgd2hpbGUgKGkgPiAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1pXSAqIG11bAoJICB9CgkgIG11bCAqPSAweDgwCgoJICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKQoKCSAgcmV0dXJuIHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDggPSBmdW5jdGlvbiByZWFkSW50OCAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKQoJICBpZiAoISh0aGlzW29mZnNldF0gJiAweDgwKSkgcmV0dXJuICh0aGlzW29mZnNldF0pCgkgIHJldHVybiAoKDB4ZmYgLSB0aGlzW29mZnNldF0gKyAxKSAqIC0xKQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2TEUgPSBmdW5jdGlvbiByZWFkSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKQoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkKCSAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2QkUgPSBmdW5jdGlvbiByZWFkSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKQoJICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAxXSB8ICh0aGlzW29mZnNldF0gPDwgOCkKCSAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyTEUgPSBmdW5jdGlvbiByZWFkSW50MzJMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKQoKCSAgcmV0dXJuICh0aGlzW29mZnNldF0pIHwKCSAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgMTYpIHwKCSAgICAodGhpc1tvZmZzZXQgKyAzXSA8PCAyNCkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkJFID0gZnVuY3Rpb24gcmVhZEludDMyQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aCkKCgkgIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDI0KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHwKCSAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8CgkgICAgKHRoaXNbb2Zmc2V0ICsgM10pCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRMRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdExFIChvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpCgkgIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCAyMywgNCkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWRGbG9hdEJFID0gZnVuY3Rpb24gcmVhZEZsb2F0QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aCkKCSAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIGZhbHNlLCAyMywgNCkKCX0KCglCdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVMRSA9IGZ1bmN0aW9uIHJlYWREb3VibGVMRSAob2Zmc2V0LCBub0Fzc2VydCkgewoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDgsIHRoaXMubGVuZ3RoKQoJICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgNTIsIDgpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlQkUgPSBmdW5jdGlvbiByZWFkRG91YmxlQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aCkKCSAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIGZhbHNlLCA1MiwgOCkKCX0KCglmdW5jdGlvbiBjaGVja0ludCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBleHQsIG1heCwgbWluKSB7CgkgIGlmICghQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHRocm93IG5ldyBUeXBlRXJyb3IoJyJidWZmZXIiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKQoJICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHRocm93IG5ldyBSYW5nZUVycm9yKCcidmFsdWUiIGFyZ3VtZW50IGlzIG91dCBvZiBib3VuZHMnKQoJICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlVUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMQoJICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKQoJICB9CgoJICB2YXIgbXVsID0gMQoJICB2YXIgaSA9IDAKCSAgdGhpc1tvZmZzZXRdID0gdmFsdWUgJiAweEZGCgkgIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGCgkgIH0KCgkgIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlVUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMQoJICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKQoJICB9CgoJICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxCgkgIHZhciBtdWwgPSAxCgkgIHRoaXNbb2Zmc2V0ICsgaV0gPSB2YWx1ZSAmIDB4RkYKCSAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGCgkgIH0KCgkgIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVVSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweGZmLCAwKQoJICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpCgkgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgIHJldHVybiBvZmZzZXQgKyAxCgl9CgoJZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MTYgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7CgkgIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmICsgdmFsdWUgKyAxCgkgIGZvciAodmFyIGkgPSAwLCBqID0gTWF0aC5taW4oYnVmLmxlbmd0aCAtIG9mZnNldCwgMik7IGkgPCBqOyArK2kpIHsKCSAgICBidWZbb2Zmc2V0ICsgaV0gPSAodmFsdWUgJiAoMHhmZiA8PCAoOCAqIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpKSkpID4+PgoJICAgICAgKGxpdHRsZUVuZGlhbiA/IGkgOiAxIC0gaSkgKiA4CgkgIH0KCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpCgkgIH0KCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KQoJICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKQoJICB9CgkgIHJldHVybiBvZmZzZXQgKyAyCgl9CgoJZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MzIgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7CgkgIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMQoJICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDQpOyBpIDwgajsgKytpKSB7CgkgICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlID4+PiAobGl0dGxlRW5kaWFuID8gaSA6IDMgLSBpKSAqIDgpICYgMHhmZgoJICB9Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKQoJICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlID4+PiAyNCkKCSAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiAxNikKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KQoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpCgkgIH0gZWxzZSB7CgkgICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgNAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHZhbHVlID0gK3ZhbHVlCgkgIG9mZnNldCA9IG9mZnNldCB8IDAKCSAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiAyNCkKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiAxNikKCSAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KQoJICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgJiAweGZmKQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKQoJICB9CgkgIHJldHVybiBvZmZzZXQgKyA0Cgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUludExFID0gZnVuY3Rpb24gd3JpdGVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSB7CgkgICAgdmFyIGxpbWl0ID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGggLSAxKQoKCSAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdCkKCSAgfQoKCSAgdmFyIGkgPSAwCgkgIHZhciBtdWwgPSAxCgkgIHZhciBzdWIgPSAwCgkgIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRgoJICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkgewoJICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSAtIDFdICE9PSAwKSB7CgkgICAgICBzdWIgPSAxCgkgICAgfQoJICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkYKCSAgfQoKCSAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGgKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50QkUgPSBmdW5jdGlvbiB3cml0ZUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICB2YXIgbGltaXQgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCAtIDEpCgoJICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KQoJICB9CgoJICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxCgkgIHZhciBtdWwgPSAxCgkgIHZhciBzdWIgPSAwCgkgIHRoaXNbb2Zmc2V0ICsgaV0gPSB2YWx1ZSAmIDB4RkYKCSAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7CgkgICAgaWYgKHZhbHVlIDwgMCAmJiBzdWIgPT09IDAgJiYgdGhpc1tvZmZzZXQgKyBpICsgMV0gIT09IDApIHsKCSAgICAgIHN1YiA9IDEKCSAgICB9CgkgICAgdGhpc1tvZmZzZXQgKyBpXSA9ICgodmFsdWUgLyBtdWwpID4+IDApIC0gc3ViICYgMHhGRgoJICB9CgoJICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVJbnQ4ICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4N2YsIC0weDgwKQoJICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpCgkgIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZiArIHZhbHVlICsgMQoJICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKQoJICByZXR1cm4gb2Zmc2V0ICsgMQoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVJbnQxNkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMCkKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZikKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpCgkgIH0KCSAgcmV0dXJuIG9mZnNldCArIDIKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgdmFsdWUgPSArdmFsdWUKCSAgb2Zmc2V0ID0gb2Zmc2V0IHwgMAoJICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApCgkgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgewoJICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOCkKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZikKCSAgfSBlbHNlIHsKCSAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgMgoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKQoJICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHsKCSAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKQoJICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpCgkgICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpCgkgICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpCgkgIH0gZWxzZSB7CgkgICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSkKCSAgfQoJICByZXR1cm4gb2Zmc2V0ICsgNAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkJFID0gZnVuY3Rpb24gd3JpdGVJbnQzMkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICB2YWx1ZSA9ICt2YWx1ZQoJICBvZmZzZXQgPSBvZmZzZXQgfCAwCgkgIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKQoJICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZmZmZmYgKyB2YWx1ZSArIDEKCSAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiAyNCkKCSAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiAxNikKCSAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KQoJICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgJiAweGZmKQoJICB9IGVsc2UgewoJICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKQoJICB9CgkgIHJldHVybiBvZmZzZXQgKyA0Cgl9CgoJZnVuY3Rpb24gY2hlY2tJRUVFNzU0IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHsKCSAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKQoJICBpZiAob2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpCgl9CgoJZnVuY3Rpb24gd3JpdGVGbG9hdCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA0LCAzLjQwMjgyMzQ2NjM4NTI4ODZlKzM4LCAtMy40MDI4MjM0NjYzODUyODg2ZSszOCkKCSAgfQoJICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCAyMywgNCkKCSAgcmV0dXJuIG9mZnNldCArIDQKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRMRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHsKCSAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpCgl9CgoJQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0QkUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydCkKCX0KCglmdW5jdGlvbiB3cml0ZURvdWJsZSAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7CgkgIGlmICghbm9Bc3NlcnQpIHsKCSAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA4LCAxLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCwgLTEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4KQoJICB9CgkgIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDUyLCA4KQoJICByZXR1cm4gb2Zmc2V0ICsgOAoJfQoKCUJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVMRSA9IGZ1bmN0aW9uIHdyaXRlRG91YmxlTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7CgkgIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlLCBub0Fzc2VydCkKCX0KCglCdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlQkUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkgewoJICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KQoJfQoKCS8vIGNvcHkodGFyZ2V0QnVmZmVyLCB0YXJnZXRTdGFydD0wLCBzb3VyY2VTdGFydD0wLCBzb3VyY2VFbmQ9YnVmZmVyLmxlbmd0aCkKCUJ1ZmZlci5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIGNvcHkgKHRhcmdldCwgdGFyZ2V0U3RhcnQsIHN0YXJ0LCBlbmQpIHsKCSAgaWYgKCFzdGFydCkgc3RhcnQgPSAwCgkgIGlmICghZW5kICYmIGVuZCAhPT0gMCkgZW5kID0gdGhpcy5sZW5ndGgKCSAgaWYgKHRhcmdldFN0YXJ0ID49IHRhcmdldC5sZW5ndGgpIHRhcmdldFN0YXJ0ID0gdGFyZ2V0Lmxlbmd0aAoJICBpZiAoIXRhcmdldFN0YXJ0KSB0YXJnZXRTdGFydCA9IDAKCSAgaWYgKGVuZCA+IDAgJiYgZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0CgoJICAvLyBDb3B5IDAgYnl0ZXM7IHdlJ3JlIGRvbmUKCSAgaWYgKGVuZCA9PT0gc3RhcnQpIHJldHVybiAwCgkgIGlmICh0YXJnZXQubGVuZ3RoID09PSAwIHx8IHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm4gMAoKCSAgLy8gRmF0YWwgZXJyb3IgY29uZGl0aW9ucwoJICBpZiAodGFyZ2V0U3RhcnQgPCAwKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3RhcmdldFN0YXJ0IG91dCBvZiBib3VuZHMnKQoJICB9CgkgIGlmIChzdGFydCA8IDAgfHwgc3RhcnQgPj0gdGhpcy5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdzb3VyY2VTdGFydCBvdXQgb2YgYm91bmRzJykKCSAgaWYgKGVuZCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdzb3VyY2VFbmQgb3V0IG9mIGJvdW5kcycpCgoJICAvLyBBcmUgd2Ugb29iPwoJICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpIGVuZCA9IHRoaXMubGVuZ3RoCgkgIGlmICh0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgPCBlbmQgLSBzdGFydCkgewoJICAgIGVuZCA9IHRhcmdldC5sZW5ndGggLSB0YXJnZXRTdGFydCArIHN0YXJ0CgkgIH0KCgkgIHZhciBsZW4gPSBlbmQgLSBzdGFydAoJICB2YXIgaQoKCSAgaWYgKHRoaXMgPT09IHRhcmdldCAmJiBzdGFydCA8IHRhcmdldFN0YXJ0ICYmIHRhcmdldFN0YXJ0IDwgZW5kKSB7CgkgICAgLy8gZGVzY2VuZGluZyBjb3B5IGZyb20gZW5kCgkgICAgZm9yIChpID0gbGVuIC0gMTsgaSA+PSAwOyAtLWkpIHsKCSAgICAgIHRhcmdldFtpICsgdGFyZ2V0U3RhcnRdID0gdGhpc1tpICsgc3RhcnRdCgkgICAgfQoJICB9IGVsc2UgaWYgKGxlbiA8IDEwMDAgfHwgIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7CgkgICAgLy8gYXNjZW5kaW5nIGNvcHkgZnJvbSBzdGFydAoJICAgIGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSkgewoJICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF0KCSAgICB9CgkgIH0gZWxzZSB7CgkgICAgVWludDhBcnJheS5wcm90b3R5cGUuc2V0LmNhbGwoCgkgICAgICB0YXJnZXQsCgkgICAgICB0aGlzLnN1YmFycmF5KHN0YXJ0LCBzdGFydCArIGxlbiksCgkgICAgICB0YXJnZXRTdGFydAoJICAgICkKCSAgfQoKCSAgcmV0dXJuIGxlbgoJfQoKCS8vIFVzYWdlOgoJLy8gICAgYnVmZmVyLmZpbGwobnVtYmVyWywgb2Zmc2V0WywgZW5kXV0pCgkvLyAgICBidWZmZXIuZmlsbChidWZmZXJbLCBvZmZzZXRbLCBlbmRdXSkKCS8vICAgIGJ1ZmZlci5maWxsKHN0cmluZ1ssIG9mZnNldFssIGVuZF1dWywgZW5jb2RpbmddKQoJQnVmZmVyLnByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gZmlsbCAodmFsLCBzdGFydCwgZW5kLCBlbmNvZGluZykgewoJICAvLyBIYW5kbGUgc3RyaW5nIGNhc2VzOgoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHsKCSAgICBpZiAodHlwZW9mIHN0YXJ0ID09PSAnc3RyaW5nJykgewoJICAgICAgZW5jb2RpbmcgPSBzdGFydAoJICAgICAgc3RhcnQgPSAwCgkgICAgICBlbmQgPSB0aGlzLmxlbmd0aAoJICAgIH0gZWxzZSBpZiAodHlwZW9mIGVuZCA9PT0gJ3N0cmluZycpIHsKCSAgICAgIGVuY29kaW5nID0gZW5kCgkgICAgICBlbmQgPSB0aGlzLmxlbmd0aAoJICAgIH0KCSAgICBpZiAodmFsLmxlbmd0aCA9PT0gMSkgewoJICAgICAgdmFyIGNvZGUgPSB2YWwuY2hhckNvZGVBdCgwKQoJICAgICAgaWYgKGNvZGUgPCAyNTYpIHsKCSAgICAgICAgdmFsID0gY29kZQoJICAgICAgfQoJICAgIH0KCSAgICBpZiAoZW5jb2RpbmcgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnKSB7CgkgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdlbmNvZGluZyBtdXN0IGJlIGEgc3RyaW5nJykKCSAgICB9CgkgICAgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycgJiYgIUJ1ZmZlci5pc0VuY29kaW5nKGVuY29kaW5nKSkgewoJICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKQoJICAgIH0KCSAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykgewoJICAgIHZhbCA9IHZhbCAmIDI1NQoJICB9CgoJICAvLyBJbnZhbGlkIHJhbmdlcyBhcmUgbm90IHNldCB0byBhIGRlZmF1bHQsIHNvIGNhbiByYW5nZSBjaGVjayBlYXJseS4KCSAgaWYgKHN0YXJ0IDwgMCB8fCB0aGlzLmxlbmd0aCA8IHN0YXJ0IHx8IHRoaXMubGVuZ3RoIDwgZW5kKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ091dCBvZiByYW5nZSBpbmRleCcpCgkgIH0KCgkgIGlmIChlbmQgPD0gc3RhcnQpIHsKCSAgICByZXR1cm4gdGhpcwoJICB9CgoJICBzdGFydCA9IHN0YXJ0ID4+PiAwCgkgIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gdGhpcy5sZW5ndGggOiBlbmQgPj4+IDAKCgkgIGlmICghdmFsKSB2YWwgPSAwCgoJICB2YXIgaQoJICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHsKCSAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7CgkgICAgICB0aGlzW2ldID0gdmFsCgkgICAgfQoJICB9IGVsc2UgewoJICAgIHZhciBieXRlcyA9IEJ1ZmZlci5pc0J1ZmZlcih2YWwpCgkgICAgICA/IHZhbAoJICAgICAgOiB1dGY4VG9CeXRlcyhuZXcgQnVmZmVyKHZhbCwgZW5jb2RpbmcpLnRvU3RyaW5nKCkpCgkgICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aAoJICAgIGZvciAoaSA9IDA7IGkgPCBlbmQgLSBzdGFydDsgKytpKSB7CgkgICAgICB0aGlzW2kgKyBzdGFydF0gPSBieXRlc1tpICUgbGVuXQoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIHRoaXMKCX0KCgkvLyBIRUxQRVIgRlVOQ1RJT05TCgkvLyA9PT09PT09PT09PT09PT09CgoJdmFyIElOVkFMSURfQkFTRTY0X1JFID0gL1teK1wvMC05QS1aYS16LV9dL2cKCglmdW5jdGlvbiBiYXNlNjRjbGVhbiAoc3RyKSB7CgkgIC8vIE5vZGUgc3RyaXBzIG91dCBpbnZhbGlkIGNoYXJhY3RlcnMgbGlrZSBcbiBhbmQgXHQgZnJvbSB0aGUgc3RyaW5nLCBiYXNlNjQtanMgZG9lcyBub3QKCSAgc3RyID0gc3RyaW5ndHJpbShzdHIpLnJlcGxhY2UoSU5WQUxJRF9CQVNFNjRfUkUsICcnKQoJICAvLyBOb2RlIGNvbnZlcnRzIHN0cmluZ3Mgd2l0aCBsZW5ndGggPCAyIHRvICcnCgkgIGlmIChzdHIubGVuZ3RoIDwgMikgcmV0dXJuICcnCgkgIC8vIE5vZGUgYWxsb3dzIGZvciBub24tcGFkZGVkIGJhc2U2NCBzdHJpbmdzIChtaXNzaW5nIHRyYWlsaW5nID09PSksIGJhc2U2NC1qcyBkb2VzIG5vdAoJICB3aGlsZSAoc3RyLmxlbmd0aCAlIDQgIT09IDApIHsKCSAgICBzdHIgPSBzdHIgKyAnPScKCSAgfQoJICByZXR1cm4gc3RyCgl9CgoJZnVuY3Rpb24gc3RyaW5ndHJpbSAoc3RyKSB7CgkgIGlmIChzdHIudHJpbSkgcmV0dXJuIHN0ci50cmltKCkKCSAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXHMrfFxzKyQvZywgJycpCgl9CgoJZnVuY3Rpb24gdG9IZXggKG4pIHsKCSAgaWYgKG4gPCAxNikgcmV0dXJuICcwJyArIG4udG9TdHJpbmcoMTYpCgkgIHJldHVybiBuLnRvU3RyaW5nKDE2KQoJfQoKCWZ1bmN0aW9uIHV0ZjhUb0J5dGVzIChzdHJpbmcsIHVuaXRzKSB7CgkgIHVuaXRzID0gdW5pdHMgfHwgSW5maW5pdHkKCSAgdmFyIGNvZGVQb2ludAoJICB2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aAoJICB2YXIgbGVhZFN1cnJvZ2F0ZSA9IG51bGwKCSAgdmFyIGJ5dGVzID0gW10KCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKCSAgICBjb2RlUG9pbnQgPSBzdHJpbmcuY2hhckNvZGVBdChpKQoKCSAgICAvLyBpcyBzdXJyb2dhdGUgY29tcG9uZW50CgkgICAgaWYgKGNvZGVQb2ludCA+IDB4RDdGRiAmJiBjb2RlUG9pbnQgPCAweEUwMDApIHsKCSAgICAgIC8vIGxhc3QgY2hhciB3YXMgYSBsZWFkCgkgICAgICBpZiAoIWxlYWRTdXJyb2dhdGUpIHsKCSAgICAgICAgLy8gbm8gbGVhZCB5ZXQKCSAgICAgICAgaWYgKGNvZGVQb2ludCA+IDB4REJGRikgewoJICAgICAgICAgIC8vIHVuZXhwZWN0ZWQgdHJhaWwKCSAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRCkKCSAgICAgICAgICBjb250aW51ZQoJICAgICAgICB9IGVsc2UgaWYgKGkgKyAxID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAvLyB1bnBhaXJlZCBsZWFkCgkgICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpCgkgICAgICAgICAgY29udGludWUKCSAgICAgICAgfQoKCSAgICAgICAgLy8gdmFsaWQgbGVhZAoJICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50CgoJICAgICAgICBjb250aW51ZQoJICAgICAgfQoKCSAgICAgIC8vIDIgbGVhZHMgaW4gYSByb3cKCSAgICAgIGlmIChjb2RlUG9pbnQgPCAweERDMDApIHsKCSAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpCgkgICAgICAgIGxlYWRTdXJyb2dhdGUgPSBjb2RlUG9pbnQKCSAgICAgICAgY29udGludWUKCSAgICAgIH0KCgkgICAgICAvLyB2YWxpZCBzdXJyb2dhdGUgcGFpcgoJICAgICAgY29kZVBvaW50ID0gKGxlYWRTdXJyb2dhdGUgLSAweEQ4MDAgPDwgMTAgfCBjb2RlUG9pbnQgLSAweERDMDApICsgMHgxMDAwMAoJICAgIH0gZWxzZSBpZiAobGVhZFN1cnJvZ2F0ZSkgewoJICAgICAgLy8gdmFsaWQgYm1wIGNoYXIsIGJ1dCBsYXN0IGNoYXIgd2FzIGEgbGVhZAoJICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpCgkgICAgfQoKCSAgICBsZWFkU3Vycm9nYXRlID0gbnVsbAoKCSAgICAvLyBlbmNvZGUgdXRmOAoJICAgIGlmIChjb2RlUG9pbnQgPCAweDgwKSB7CgkgICAgICBpZiAoKHVuaXRzIC09IDEpIDwgMCkgYnJlYWsKCSAgICAgIGJ5dGVzLnB1c2goY29kZVBvaW50KQoJICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHg4MDApIHsKCSAgICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVhawoJICAgICAgYnl0ZXMucHVzaCgKCSAgICAgICAgY29kZVBvaW50ID4+IDB4NiB8IDB4QzAsCgkgICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwCgkgICAgICApCgkgICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDEwMDAwKSB7CgkgICAgICBpZiAoKHVuaXRzIC09IDMpIDwgMCkgYnJlYWsKCSAgICAgIGJ5dGVzLnB1c2goCgkgICAgICAgIGNvZGVQb2ludCA+PiAweEMgfCAweEUwLAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsCgkgICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwCgkgICAgICApCgkgICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDExMDAwMCkgewoJICAgICAgaWYgKCh1bml0cyAtPSA0KSA8IDApIGJyZWFrCgkgICAgICBieXRlcy5wdXNoKAoJICAgICAgICBjb2RlUG9pbnQgPj4gMHgxMiB8IDB4RjAsCgkgICAgICAgIGNvZGVQb2ludCA+PiAweEMgJiAweDNGIHwgMHg4MCwKCSAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLAoJICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MAoJICAgICAgKQoJICAgIH0gZWxzZSB7CgkgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY29kZSBwb2ludCcpCgkgICAgfQoJICB9CgoJICByZXR1cm4gYnl0ZXMKCX0KCglmdW5jdGlvbiBhc2NpaVRvQnl0ZXMgKHN0cikgewoJICB2YXIgYnl0ZUFycmF5ID0gW10KCSAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyArK2kpIHsKCSAgICAvLyBOb2RlJ3MgY29kZSBzZWVtcyB0byBiZSBkb2luZyB0aGlzIGFuZCBub3QgJiAweDdGLi4KCSAgICBieXRlQXJyYXkucHVzaChzdHIuY2hhckNvZGVBdChpKSAmIDB4RkYpCgkgIH0KCSAgcmV0dXJuIGJ5dGVBcnJheQoJfQoKCWZ1bmN0aW9uIHV0ZjE2bGVUb0J5dGVzIChzdHIsIHVuaXRzKSB7CgkgIHZhciBjLCBoaSwgbG8KCSAgdmFyIGJ5dGVBcnJheSA9IFtdCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7CgkgICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrCgoJICAgIGMgPSBzdHIuY2hhckNvZGVBdChpKQoJICAgIGhpID0gYyA+PiA4CgkgICAgbG8gPSBjICUgMjU2CgkgICAgYnl0ZUFycmF5LnB1c2gobG8pCgkgICAgYnl0ZUFycmF5LnB1c2goaGkpCgkgIH0KCgkgIHJldHVybiBieXRlQXJyYXkKCX0KCglmdW5jdGlvbiBiYXNlNjRUb0J5dGVzIChzdHIpIHsKCSAgcmV0dXJuIGJhc2U2NC50b0J5dGVBcnJheShiYXNlNjRjbGVhbihzdHIpKQoJfQoKCWZ1bmN0aW9uIGJsaXRCdWZmZXIgKHNyYywgZHN0LCBvZmZzZXQsIGxlbmd0aCkgewoJICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CgkgICAgaWYgKChpICsgb2Zmc2V0ID49IGRzdC5sZW5ndGgpIHx8IChpID49IHNyYy5sZW5ndGgpKSBicmVhawoJICAgIGRzdFtpICsgb2Zmc2V0XSA9IHNyY1tpXQoJICB9CgkgIHJldHVybiBpCgl9CgoJZnVuY3Rpb24gaXNuYW4gKHZhbCkgewoJICByZXR1cm4gdmFsICE9PSB2YWwgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zZWxmLWNvbXBhcmUKCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpCgovKioqLyB9LAovKiA5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JwoKCWV4cG9ydHMuYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGgKCWV4cG9ydHMudG9CeXRlQXJyYXkgPSB0b0J5dGVBcnJheQoJZXhwb3J0cy5mcm9tQnl0ZUFycmF5ID0gZnJvbUJ5dGVBcnJheQoKCXZhciBsb29rdXAgPSBbXQoJdmFyIHJldkxvb2t1cCA9IFtdCgl2YXIgQXJyID0gdHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnID8gVWludDhBcnJheSA6IEFycmF5CgoJdmFyIGNvZGUgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLycKCWZvciAodmFyIGkgPSAwLCBsZW4gPSBjb2RlLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7CgkgIGxvb2t1cFtpXSA9IGNvZGVbaV0KCSAgcmV2TG9va3VwW2NvZGUuY2hhckNvZGVBdChpKV0gPSBpCgl9CgoJcmV2TG9va3VwWyctJy5jaGFyQ29kZUF0KDApXSA9IDYyCglyZXZMb29rdXBbJ18nLmNoYXJDb2RlQXQoMCldID0gNjMKCglmdW5jdGlvbiBwbGFjZUhvbGRlcnNDb3VudCAoYjY0KSB7CgkgIHZhciBsZW4gPSBiNjQubGVuZ3RoCgkgIGlmIChsZW4gJSA0ID4gMCkgewoJICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdHJpbmcuIExlbmd0aCBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNCcpCgkgIH0KCgkgIC8vIHRoZSBudW1iZXIgb2YgZXF1YWwgc2lnbnMgKHBsYWNlIGhvbGRlcnMpCgkgIC8vIGlmIHRoZXJlIGFyZSB0d28gcGxhY2Vob2xkZXJzLCB0aGFuIHRoZSB0d28gY2hhcmFjdGVycyBiZWZvcmUgaXQKCSAgLy8gcmVwcmVzZW50IG9uZSBieXRlCgkgIC8vIGlmIHRoZXJlIGlzIG9ubHkgb25lLCB0aGVuIHRoZSB0aHJlZSBjaGFyYWN0ZXJzIGJlZm9yZSBpdCByZXByZXNlbnQgMiBieXRlcwoJICAvLyB0aGlzIGlzIGp1c3QgYSBjaGVhcCBoYWNrIHRvIG5vdCBkbyBpbmRleE9mIHR3aWNlCgkgIHJldHVybiBiNjRbbGVuIC0gMl0gPT09ICc9JyA/IDIgOiBiNjRbbGVuIC0gMV0gPT09ICc9JyA/IDEgOiAwCgl9CgoJZnVuY3Rpb24gYnl0ZUxlbmd0aCAoYjY0KSB7CgkgIC8vIGJhc2U2NCBpcyA0LzMgKyB1cCB0byB0d28gY2hhcmFjdGVycyBvZiB0aGUgb3JpZ2luYWwgZGF0YQoJICByZXR1cm4gYjY0Lmxlbmd0aCAqIDMgLyA0IC0gcGxhY2VIb2xkZXJzQ291bnQoYjY0KQoJfQoKCWZ1bmN0aW9uIHRvQnl0ZUFycmF5IChiNjQpIHsKCSAgdmFyIGksIGosIGwsIHRtcCwgcGxhY2VIb2xkZXJzLCBhcnIKCSAgdmFyIGxlbiA9IGI2NC5sZW5ndGgKCSAgcGxhY2VIb2xkZXJzID0gcGxhY2VIb2xkZXJzQ291bnQoYjY0KQoKCSAgYXJyID0gbmV3IEFycihsZW4gKiAzIC8gNCAtIHBsYWNlSG9sZGVycykKCgkgIC8vIGlmIHRoZXJlIGFyZSBwbGFjZWhvbGRlcnMsIG9ubHkgZ2V0IHVwIHRvIHRoZSBsYXN0IGNvbXBsZXRlIDQgY2hhcnMKCSAgbCA9IHBsYWNlSG9sZGVycyA+IDAgPyBsZW4gLSA0IDogbGVuCgoJICB2YXIgTCA9IDAKCgkgIGZvciAoaSA9IDAsIGogPSAwOyBpIDwgbDsgaSArPSA0LCBqICs9IDMpIHsKCSAgICB0bXAgPSAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAxOCkgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPDwgMTIpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMildIDw8IDYpIHwgcmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAzKV0KCSAgICBhcnJbTCsrXSA9ICh0bXAgPj4gMTYpICYgMHhGRgoJICAgIGFycltMKytdID0gKHRtcCA+PiA4KSAmIDB4RkYKCSAgICBhcnJbTCsrXSA9IHRtcCAmIDB4RkYKCSAgfQoKCSAgaWYgKHBsYWNlSG9sZGVycyA9PT0gMikgewoJICAgIHRtcCA9IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDIpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldID4+IDQpCgkgICAgYXJyW0wrK10gPSB0bXAgJiAweEZGCgkgIH0gZWxzZSBpZiAocGxhY2VIb2xkZXJzID09PSAxKSB7CgkgICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMTApIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDQpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMildID4+IDIpCgkgICAgYXJyW0wrK10gPSAodG1wID4+IDgpICYgMHhGRgoJICAgIGFycltMKytdID0gdG1wICYgMHhGRgoJICB9CgoJICByZXR1cm4gYXJyCgl9CgoJZnVuY3Rpb24gdHJpcGxldFRvQmFzZTY0IChudW0pIHsKCSAgcmV0dXJuIGxvb2t1cFtudW0gPj4gMTggJiAweDNGXSArIGxvb2t1cFtudW0gPj4gMTIgJiAweDNGXSArIGxvb2t1cFtudW0gPj4gNiAmIDB4M0ZdICsgbG9va3VwW251bSAmIDB4M0ZdCgl9CgoJZnVuY3Rpb24gZW5jb2RlQ2h1bmsgKHVpbnQ4LCBzdGFydCwgZW5kKSB7CgkgIHZhciB0bXAKCSAgdmFyIG91dHB1dCA9IFtdCgkgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSArPSAzKSB7CgkgICAgdG1wID0gKHVpbnQ4W2ldIDw8IDE2KSArICh1aW50OFtpICsgMV0gPDwgOCkgKyAodWludDhbaSArIDJdKQoJICAgIG91dHB1dC5wdXNoKHRyaXBsZXRUb0Jhc2U2NCh0bXApKQoJICB9CgkgIHJldHVybiBvdXRwdXQuam9pbignJykKCX0KCglmdW5jdGlvbiBmcm9tQnl0ZUFycmF5ICh1aW50OCkgewoJICB2YXIgdG1wCgkgIHZhciBsZW4gPSB1aW50OC5sZW5ndGgKCSAgdmFyIGV4dHJhQnl0ZXMgPSBsZW4gJSAzIC8vIGlmIHdlIGhhdmUgMSBieXRlIGxlZnQsIHBhZCAyIGJ5dGVzCgkgIHZhciBvdXRwdXQgPSAnJwoJICB2YXIgcGFydHMgPSBbXQoJICB2YXIgbWF4Q2h1bmtMZW5ndGggPSAxNjM4MyAvLyBtdXN0IGJlIG11bHRpcGxlIG9mIDMKCgkgIC8vIGdvIHRocm91Z2ggdGhlIGFycmF5IGV2ZXJ5IHRocmVlIGJ5dGVzLCB3ZSdsbCBkZWFsIHdpdGggdHJhaWxpbmcgc3R1ZmYgbGF0ZXIKCSAgZm9yICh2YXIgaSA9IDAsIGxlbjIgPSBsZW4gLSBleHRyYUJ5dGVzOyBpIDwgbGVuMjsgaSArPSBtYXhDaHVua0xlbmd0aCkgewoJICAgIHBhcnRzLnB1c2goZW5jb2RlQ2h1bmsodWludDgsIGksIChpICsgbWF4Q2h1bmtMZW5ndGgpID4gbGVuMiA/IGxlbjIgOiAoaSArIG1heENodW5rTGVuZ3RoKSkpCgkgIH0KCgkgIC8vIHBhZCB0aGUgZW5kIHdpdGggemVyb3MsIGJ1dCBtYWtlIHN1cmUgdG8gbm90IGZvcmdldCB0aGUgZXh0cmEgYnl0ZXMKCSAgaWYgKGV4dHJhQnl0ZXMgPT09IDEpIHsKCSAgICB0bXAgPSB1aW50OFtsZW4gLSAxXQoJICAgIG91dHB1dCArPSBsb29rdXBbdG1wID4+IDJdCgkgICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wIDw8IDQpICYgMHgzRl0KCSAgICBvdXRwdXQgKz0gJz09JwoJICB9IGVsc2UgaWYgKGV4dHJhQnl0ZXMgPT09IDIpIHsKCSAgICB0bXAgPSAodWludDhbbGVuIC0gMl0gPDwgOCkgKyAodWludDhbbGVuIC0gMV0pCgkgICAgb3V0cHV0ICs9IGxvb2t1cFt0bXAgPj4gMTBdCgkgICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wID4+IDQpICYgMHgzRl0KCSAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPDwgMikgJiAweDNGXQoJICAgIG91dHB1dCArPSAnPScKCSAgfQoKCSAgcGFydHMucHVzaChvdXRwdXQpCgoJICByZXR1cm4gcGFydHMuam9pbignJykKCX0KCgovKioqLyB9LAovKiAxMCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCglleHBvcnRzLnJlYWQgPSBmdW5jdGlvbiAoYnVmZmVyLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykgewoJICB2YXIgZSwgbQoJICB2YXIgZUxlbiA9IG5CeXRlcyAqIDggLSBtTGVuIC0gMQoJICB2YXIgZU1heCA9ICgxIDw8IGVMZW4pIC0gMQoJICB2YXIgZUJpYXMgPSBlTWF4ID4+IDEKCSAgdmFyIG5CaXRzID0gLTcKCSAgdmFyIGkgPSBpc0xFID8gKG5CeXRlcyAtIDEpIDogMAoJICB2YXIgZCA9IGlzTEUgPyAtMSA6IDEKCSAgdmFyIHMgPSBidWZmZXJbb2Zmc2V0ICsgaV0KCgkgIGkgKz0gZAoKCSAgZSA9IHMgJiAoKDEgPDwgKC1uQml0cykpIC0gMSkKCSAgcyA+Pj0gKC1uQml0cykKCSAgbkJpdHMgKz0gZUxlbgoJICBmb3IgKDsgbkJpdHMgPiAwOyBlID0gZSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fQoKCSAgbSA9IGUgJiAoKDEgPDwgKC1uQml0cykpIC0gMSkKCSAgZSA+Pj0gKC1uQml0cykKCSAgbkJpdHMgKz0gbUxlbgoJICBmb3IgKDsgbkJpdHMgPiAwOyBtID0gbSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fQoKCSAgaWYgKGUgPT09IDApIHsKCSAgICBlID0gMSAtIGVCaWFzCgkgIH0gZWxzZSBpZiAoZSA9PT0gZU1heCkgewoJICAgIHJldHVybiBtID8gTmFOIDogKChzID8gLTEgOiAxKSAqIEluZmluaXR5KQoJICB9IGVsc2UgewoJICAgIG0gPSBtICsgTWF0aC5wb3coMiwgbUxlbikKCSAgICBlID0gZSAtIGVCaWFzCgkgIH0KCSAgcmV0dXJuIChzID8gLTEgOiAxKSAqIG0gKiBNYXRoLnBvdygyLCBlIC0gbUxlbikKCX0KCglleHBvcnRzLndyaXRlID0gZnVuY3Rpb24gKGJ1ZmZlciwgdmFsdWUsIG9mZnNldCwgaXNMRSwgbUxlbiwgbkJ5dGVzKSB7CgkgIHZhciBlLCBtLCBjCgkgIHZhciBlTGVuID0gbkJ5dGVzICogOCAtIG1MZW4gLSAxCgkgIHZhciBlTWF4ID0gKDEgPDwgZUxlbikgLSAxCgkgIHZhciBlQmlhcyA9IGVNYXggPj4gMQoJICB2YXIgcnQgPSAobUxlbiA9PT0gMjMgPyBNYXRoLnBvdygyLCAtMjQpIC0gTWF0aC5wb3coMiwgLTc3KSA6IDApCgkgIHZhciBpID0gaXNMRSA/IDAgOiAobkJ5dGVzIC0gMSkKCSAgdmFyIGQgPSBpc0xFID8gMSA6IC0xCgkgIHZhciBzID0gdmFsdWUgPCAwIHx8ICh2YWx1ZSA9PT0gMCAmJiAxIC8gdmFsdWUgPCAwKSA/IDEgOiAwCgoJICB2YWx1ZSA9IE1hdGguYWJzKHZhbHVlKQoKCSAgaWYgKGlzTmFOKHZhbHVlKSB8fCB2YWx1ZSA9PT0gSW5maW5pdHkpIHsKCSAgICBtID0gaXNOYU4odmFsdWUpID8gMSA6IDAKCSAgICBlID0gZU1heAoJICB9IGVsc2UgewoJICAgIGUgPSBNYXRoLmZsb29yKE1hdGgubG9nKHZhbHVlKSAvIE1hdGguTE4yKQoJICAgIGlmICh2YWx1ZSAqIChjID0gTWF0aC5wb3coMiwgLWUpKSA8IDEpIHsKCSAgICAgIGUtLQoJICAgICAgYyAqPSAyCgkgICAgfQoJICAgIGlmIChlICsgZUJpYXMgPj0gMSkgewoJICAgICAgdmFsdWUgKz0gcnQgLyBjCgkgICAgfSBlbHNlIHsKCSAgICAgIHZhbHVlICs9IHJ0ICogTWF0aC5wb3coMiwgMSAtIGVCaWFzKQoJICAgIH0KCSAgICBpZiAodmFsdWUgKiBjID49IDIpIHsKCSAgICAgIGUrKwoJICAgICAgYyAvPSAyCgkgICAgfQoKCSAgICBpZiAoZSArIGVCaWFzID49IGVNYXgpIHsKCSAgICAgIG0gPSAwCgkgICAgICBlID0gZU1heAoJICAgIH0gZWxzZSBpZiAoZSArIGVCaWFzID49IDEpIHsKCSAgICAgIG0gPSAodmFsdWUgKiBjIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKQoJICAgICAgZSA9IGUgKyBlQmlhcwoJICAgIH0gZWxzZSB7CgkgICAgICBtID0gdmFsdWUgKiBNYXRoLnBvdygyLCBlQmlhcyAtIDEpICogTWF0aC5wb3coMiwgbUxlbikKCSAgICAgIGUgPSAwCgkgICAgfQoJICB9CgoJICBmb3IgKDsgbUxlbiA+PSA4OyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBtICYgMHhmZiwgaSArPSBkLCBtIC89IDI1NiwgbUxlbiAtPSA4KSB7fQoKCSAgZSA9IChlIDw8IG1MZW4pIHwgbQoJICBlTGVuICs9IG1MZW4KCSAgZm9yICg7IGVMZW4gPiAwOyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBlICYgMHhmZiwgaSArPSBkLCBlIC89IDI1NiwgZUxlbiAtPSA4KSB7fQoKCSAgYnVmZmVyW29mZnNldCArIGkgLSBkXSB8PSBzICogMTI4Cgl9CgoKLyoqKi8gfSwKLyogMTEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7CgoJbW9kdWxlLmV4cG9ydHMgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChhcnIpIHsKCSAgcmV0dXJuIHRvU3RyaW5nLmNhbGwoYXJyKSA9PSAnW29iamVjdCBBcnJheV0nOwoJfTsKCgovKioqLyB9LAovKiAxMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXIKCXZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTsKCgkvLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXQKCS8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpcwoJLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYQoJLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy4KCgl2YXIgY2FjaGVkU2V0VGltZW91dDsKCXZhciBjYWNoZWRDbGVhclRpbWVvdXQ7CgoJZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHsKCSAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTsKCX0KCWZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkgewoJICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7Cgl9CgkoZnVuY3Rpb24gKCkgewoJICAgIHRyeSB7CgkgICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykgewoJICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDsKCSAgICAgICAgfQoJICAgIH0gY2F0Y2ggKGUpIHsKCSAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7CgkgICAgfQoJICAgIHRyeSB7CgkgICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0OwoJICAgICAgICB9CgkgICAgfSBjYXRjaCAoZSkgewoJICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0OwoJICAgIH0KCX0gKCkpCglmdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikgewoJICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7CgkgICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9ucwoJICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApOwoJICAgIH0KCSAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZAoJICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkgewoJICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDsKCSAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTsKCSAgICB9CgkgICAgdHJ5IHsKCSAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzcwoJICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApOwoJICAgIH0gY2F0Y2goZSl7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHkKCSAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTsKCSAgICAgICAgfSBjYXRjaChlKXsKCSAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yCgkgICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7CgkgICAgICAgIH0KCSAgICB9CgoKCX0KCWZ1bmN0aW9uIHJ1bkNsZWFyVGltZW91dChtYXJrZXIpIHsKCSAgICBpZiAoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBjbGVhclRpbWVvdXQpIHsKCSAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zCgkgICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTsKCSAgICB9CgkgICAgLy8gaWYgY2xlYXJUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZAoJICAgIGlmICgoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBkZWZhdWx0Q2xlYXJUaW1lb3V0IHx8ICFjYWNoZWRDbGVhclRpbWVvdXQpICYmIGNsZWFyVGltZW91dCkgewoJICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7CgkgICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTsKCSAgICB9CgkgICAgdHJ5IHsKCSAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzcwoJICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0KG1hcmtlcik7CgkgICAgfSBjYXRjaCAoZSl7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgIHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5CgkgICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwobnVsbCwgbWFya2VyKTsKCSAgICAgICAgfSBjYXRjaCAoZSl7CgkgICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvci4KCSAgICAgICAgICAgIC8vIFNvbWUgdmVyc2lvbnMgb2YgSS5FLiBoYXZlIGRpZmZlcmVudCBydWxlcyBmb3IgY2xlYXJUaW1lb3V0IHZzIHNldFRpbWVvdXQKCSAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbCh0aGlzLCBtYXJrZXIpOwoJICAgICAgICB9CgkgICAgfQoKCgoJfQoJdmFyIHF1ZXVlID0gW107Cgl2YXIgZHJhaW5pbmcgPSBmYWxzZTsKCXZhciBjdXJyZW50UXVldWU7Cgl2YXIgcXVldWVJbmRleCA9IC0xOwoKCWZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHsKCSAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHsKCSAgICAgICAgcmV0dXJuOwoJICAgIH0KCSAgICBkcmFpbmluZyA9IGZhbHNlOwoJICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7CgkgICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7CgkgICAgfSBlbHNlIHsKCSAgICAgICAgcXVldWVJbmRleCA9IC0xOwoJICAgIH0KCSAgICBpZiAocXVldWUubGVuZ3RoKSB7CgkgICAgICAgIGRyYWluUXVldWUoKTsKCSAgICB9Cgl9CgoJZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHsKCSAgICBpZiAoZHJhaW5pbmcpIHsKCSAgICAgICAgcmV0dXJuOwoJICAgIH0KCSAgICB2YXIgdGltZW91dCA9IHJ1blRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTsKCSAgICBkcmFpbmluZyA9IHRydWU7CgoJICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7CgkgICAgd2hpbGUobGVuKSB7CgkgICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlOwoJICAgICAgICBxdWV1ZSA9IFtdOwoJICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7CgkgICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7CgkgICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHF1ZXVlSW5kZXggPSAtMTsKCSAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoOwoJICAgIH0KCSAgICBjdXJyZW50UXVldWUgPSBudWxsOwoJICAgIGRyYWluaW5nID0gZmFsc2U7CgkgICAgcnVuQ2xlYXJUaW1lb3V0KHRpbWVvdXQpOwoJfQoKCXByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7CgkgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpOwoJICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkgewoJICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07CgkgICAgICAgIH0KCSAgICB9CgkgICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTsKCSAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykgewoJICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpOwoJICAgIH0KCX07CgoJLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0cwoJZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7CgkgICAgdGhpcy5mdW4gPSBmdW47CgkgICAgdGhpcy5hcnJheSA9IGFycmF5OwoJfQoJSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkgewoJICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpOwoJfTsKCXByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7Cglwcm9jZXNzLmJyb3dzZXIgPSB0cnVlOwoJcHJvY2Vzcy5lbnYgPSB7fTsKCXByb2Nlc3MuYXJndiA9IFtdOwoJcHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzCglwcm9jZXNzLnZlcnNpb25zID0ge307CgoJZnVuY3Rpb24gbm9vcCgpIHt9CgoJcHJvY2Vzcy5vbiA9IG5vb3A7Cglwcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDsKCXByb2Nlc3Mub25jZSA9IG5vb3A7Cglwcm9jZXNzLm9mZiA9IG5vb3A7Cglwcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDsKCXByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDsKCXByb2Nlc3MuZW1pdCA9IG5vb3A7CgoJcHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHsKCSAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7Cgl9OwoKCXByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07Cglwcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikgewoJICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7Cgl9OwoJcHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gMDsgfTsKCgovKioqLyB9LAovKiAxMyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7ZXhwb3J0cy5mZXRjaCA9IGlzRnVuY3Rpb24oZ2xvYmFsLmZldGNoKSAmJiBpc0Z1bmN0aW9uKGdsb2JhbC5SZWFkYWJsZVN0cmVhbSkKCglleHBvcnRzLmJsb2JDb25zdHJ1Y3RvciA9IGZhbHNlCgl0cnkgewoJCW5ldyBCbG9iKFtuZXcgQXJyYXlCdWZmZXIoMSldKQoJCWV4cG9ydHMuYmxvYkNvbnN0cnVjdG9yID0gdHJ1ZQoJfSBjYXRjaCAoZSkge30KCgkvLyBUaGUgeGhyIHJlcXVlc3QgdG8gZXhhbXBsZS5jb20gbWF5IHZpb2xhdGUgc29tZSByZXN0cmljdGl2ZSBDU1AgY29uZmlndXJhdGlvbnMsCgkvLyBzbyBpZiB3ZSdyZSBydW5uaW5nIGluIGEgYnJvd3NlciB0aGF0IHN1cHBvcnRzIGBmZXRjaGAsIGF2b2lkIGNhbGxpbmcgZ2V0WEhSKCkKCS8vIGFuZCBhc3N1bWUgc3VwcG9ydCBmb3IgY2VydGFpbiBmZWF0dXJlcyBiZWxvdy4KCXZhciB4aHIKCWZ1bmN0aW9uIGdldFhIUiAoKSB7CgkJLy8gQ2FjaGUgdGhlIHhociB2YWx1ZQoJCWlmICh4aHIgIT09IHVuZGVmaW5lZCkgcmV0dXJuIHhocgoKCQlpZiAoZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0KSB7CgkJCXhociA9IG5ldyBnbG9iYWwuWE1MSHR0cFJlcXVlc3QoKQoJCQkvLyBJZiBYRG9tYWluUmVxdWVzdCBpcyBhdmFpbGFibGUgKGllIG9ubHksIHdoZXJlIHhociBtaWdodCBub3Qgd29yawoJCQkvLyBjcm9zcyBkb21haW4pLCB1c2UgdGhlIHBhZ2UgbG9jYXRpb24uIE90aGVyd2lzZSB1c2UgZXhhbXBsZS5jb20KCQkJLy8gTm90ZTogdGhpcyBkb2Vzbid0IGFjdHVhbGx5IG1ha2UgYW4gaHR0cCByZXF1ZXN0LgoJCQl0cnkgewoJCQkJeGhyLm9wZW4oJ0dFVCcsIGdsb2JhbC5YRG9tYWluUmVxdWVzdCA/ICcvJyA6ICdodHRwczovL2V4YW1wbGUuY29tJykKCQkJfSBjYXRjaChlKSB7CgkJCQl4aHIgPSBudWxsCgkJCX0KCQl9IGVsc2UgewoJCQkvLyBTZXJ2aWNlIHdvcmtlcnMgZG9uJ3QgaGF2ZSBYSFIKCQkJeGhyID0gbnVsbAoJCX0KCQlyZXR1cm4geGhyCgl9CgoJZnVuY3Rpb24gY2hlY2tUeXBlU3VwcG9ydCAodHlwZSkgewoJCXZhciB4aHIgPSBnZXRYSFIoKQoJCWlmICgheGhyKSByZXR1cm4gZmFsc2UKCQl0cnkgewoJCQl4aHIucmVzcG9uc2VUeXBlID0gdHlwZQoJCQlyZXR1cm4geGhyLnJlc3BvbnNlVHlwZSA9PT0gdHlwZQoJCX0gY2F0Y2ggKGUpIHt9CgkJcmV0dXJuIGZhbHNlCgl9CgoJLy8gRm9yIHNvbWUgc3RyYW5nZSByZWFzb24sIFNhZmFyaSA3LjAgcmVwb3J0cyB0eXBlb2YgZ2xvYmFsLkFycmF5QnVmZmVyID09PSAnb2JqZWN0Jy4KCS8vIFNhZmFyaSA3LjEgYXBwZWFycyB0byBoYXZlIGZpeGVkIHRoaXMgYnVnLgoJdmFyIGhhdmVBcnJheUJ1ZmZlciA9IHR5cGVvZiBnbG9iYWwuQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnCgl2YXIgaGF2ZVNsaWNlID0gaGF2ZUFycmF5QnVmZmVyICYmIGlzRnVuY3Rpb24oZ2xvYmFsLkFycmF5QnVmZmVyLnByb3RvdHlwZS5zbGljZSkKCgkvLyBJZiBmZXRjaCBpcyBzdXBwb3J0ZWQsIHRoZW4gYXJyYXlidWZmZXIgd2lsbCBiZSBzdXBwb3J0ZWQgdG9vLiBTa2lwIGNhbGxpbmcKCS8vIGNoZWNrVHlwZVN1cHBvcnQoKSwgc2luY2UgdGhhdCBjYWxscyBnZXRYSFIoKS4KCWV4cG9ydHMuYXJyYXlidWZmZXIgPSBleHBvcnRzLmZldGNoIHx8IChoYXZlQXJyYXlCdWZmZXIgJiYgY2hlY2tUeXBlU3VwcG9ydCgnYXJyYXlidWZmZXInKSkKCgkvLyBUaGVzZSBuZXh0IHR3byB0ZXN0cyB1bmF2b2lkYWJseSBzaG93IHdhcm5pbmdzIGluIENocm9tZS4gU2luY2UgZmV0Y2ggd2lsbCBhbHdheXMKCS8vIGJlIHVzZWQgaWYgaXQncyBhdmFpbGFibGUsIGp1c3QgcmV0dXJuIGZhbHNlIGZvciB0aGVzZSB0byBhdm9pZCB0aGUgd2FybmluZ3MuCglleHBvcnRzLm1zc3RyZWFtID0gIWV4cG9ydHMuZmV0Y2ggJiYgaGF2ZVNsaWNlICYmIGNoZWNrVHlwZVN1cHBvcnQoJ21zLXN0cmVhbScpCglleHBvcnRzLm1vemNodW5rZWRhcnJheWJ1ZmZlciA9ICFleHBvcnRzLmZldGNoICYmIGhhdmVBcnJheUJ1ZmZlciAmJgoJCWNoZWNrVHlwZVN1cHBvcnQoJ21vei1jaHVua2VkLWFycmF5YnVmZmVyJykKCgkvLyBJZiBmZXRjaCBpcyBzdXBwb3J0ZWQsIHRoZW4gb3ZlcnJpZGVNaW1lVHlwZSB3aWxsIGJlIHN1cHBvcnRlZCB0b28uIFNraXAgY2FsbGluZwoJLy8gZ2V0WEhSKCkuCglleHBvcnRzLm92ZXJyaWRlTWltZVR5cGUgPSBleHBvcnRzLmZldGNoIHx8IChnZXRYSFIoKSA/IGlzRnVuY3Rpb24oZ2V0WEhSKCkub3ZlcnJpZGVNaW1lVHlwZSkgOiBmYWxzZSkKCglleHBvcnRzLnZiQXJyYXkgPSBpc0Z1bmN0aW9uKGdsb2JhbC5WQkFycmF5KQoKCWZ1bmN0aW9uIGlzRnVuY3Rpb24gKHZhbHVlKSB7CgkJcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJwoJfQoKCXhociA9IG51bGwgLy8gSGVscCBnYwoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSkKCi8qKiovIH0sCi8qIDE0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCWlmICh0eXBlb2YgT2JqZWN0LmNyZWF0ZSA9PT0gJ2Z1bmN0aW9uJykgewoJICAvLyBpbXBsZW1lbnRhdGlvbiBmcm9tIHN0YW5kYXJkIG5vZGUuanMgJ3V0aWwnIG1vZHVsZQoJICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluaGVyaXRzKGN0b3IsIHN1cGVyQ3RvcikgewoJICAgIGN0b3Iuc3VwZXJfID0gc3VwZXJDdG9yCgkgICAgY3Rvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ3Rvci5wcm90b3R5cGUsIHsKCSAgICAgIGNvbnN0cnVjdG9yOiB7CgkgICAgICAgIHZhbHVlOiBjdG9yLAoJICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKCSAgICAgICAgd3JpdGFibGU6IHRydWUsCgkgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQoJICAgICAgfQoJICAgIH0pOwoJICB9OwoJfSBlbHNlIHsKCSAgLy8gb2xkIHNjaG9vbCBzaGltIGZvciBvbGQgYnJvd3NlcnMKCSAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpbmhlcml0cyhjdG9yLCBzdXBlckN0b3IpIHsKCSAgICBjdG9yLnN1cGVyXyA9IHN1cGVyQ3RvcgoJICAgIHZhciBUZW1wQ3RvciA9IGZ1bmN0aW9uICgpIHt9CgkgICAgVGVtcEN0b3IucHJvdG90eXBlID0gc3VwZXJDdG9yLnByb3RvdHlwZQoJICAgIGN0b3IucHJvdG90eXBlID0gbmV3IFRlbXBDdG9yKCkKCSAgICBjdG9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGN0b3IKCSAgfQoJfQoKCi8qKiovIH0sCi8qIDE1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihwcm9jZXNzLCBCdWZmZXIsIGdsb2JhbCkge3ZhciBjYXBhYmlsaXR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKCXZhciBpbmhlcml0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCgl2YXIgc3RyZWFtID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKCgl2YXIgclN0YXRlcyA9IGV4cG9ydHMucmVhZHlTdGF0ZXMgPSB7CgkJVU5TRU5UOiAwLAoJCU9QRU5FRDogMSwKCQlIRUFERVJTX1JFQ0VJVkVEOiAyLAoJCUxPQURJTkc6IDMsCgkJRE9ORTogNAoJfQoKCXZhciBJbmNvbWluZ01lc3NhZ2UgPSBleHBvcnRzLkluY29taW5nTWVzc2FnZSA9IGZ1bmN0aW9uICh4aHIsIHJlc3BvbnNlLCBtb2RlKSB7CgkJdmFyIHNlbGYgPSB0aGlzCgkJc3RyZWFtLlJlYWRhYmxlLmNhbGwoc2VsZikKCgkJc2VsZi5fbW9kZSA9IG1vZGUKCQlzZWxmLmhlYWRlcnMgPSB7fQoJCXNlbGYucmF3SGVhZGVycyA9IFtdCgkJc2VsZi50cmFpbGVycyA9IHt9CgkJc2VsZi5yYXdUcmFpbGVycyA9IFtdCgoJCS8vIEZha2UgdGhlICdjbG9zZScgZXZlbnQsIGJ1dCBvbmx5IG9uY2UgJ2VuZCcgZmlyZXMKCQlzZWxmLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CgkJCS8vIFRoZSBuZXh0VGljayBpcyBuZWNlc3NhcnkgdG8gcHJldmVudCB0aGUgJ3JlcXVlc3QnIG1vZHVsZSBmcm9tIGNhdXNpbmcgYW4gaW5maW5pdGUgbG9vcAoJCQlwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsKCQkJCXNlbGYuZW1pdCgnY2xvc2UnKQoJCQl9KQoJCX0pCgoJCWlmIChtb2RlID09PSAnZmV0Y2gnKSB7CgkJCXNlbGYuX2ZldGNoUmVzcG9uc2UgPSByZXNwb25zZQoKCQkJc2VsZi51cmwgPSByZXNwb25zZS51cmwKCQkJc2VsZi5zdGF0dXNDb2RlID0gcmVzcG9uc2Uuc3RhdHVzCgkJCXNlbGYuc3RhdHVzTWVzc2FnZSA9IHJlc3BvbnNlLnN0YXR1c1RleHQKCQkJCgkJCXJlc3BvbnNlLmhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbihoZWFkZXIsIGtleSl7CgkJCQlzZWxmLmhlYWRlcnNba2V5LnRvTG93ZXJDYXNlKCldID0gaGVhZGVyCgkJCQlzZWxmLnJhd0hlYWRlcnMucHVzaChrZXksIGhlYWRlcikKCQkJfSkKCgoJCQkvLyBUT0RPOiB0aGlzIGRvZXNuJ3QgcmVzcGVjdCBiYWNrcHJlc3N1cmUuIE9uY2UgV3JpdGFibGVTdHJlYW0gaXMgYXZhaWxhYmxlLCB0aGlzIGNhbiBiZSBmaXhlZAoJCQl2YXIgcmVhZGVyID0gcmVzcG9uc2UuYm9keS5nZXRSZWFkZXIoKQoJCQlmdW5jdGlvbiByZWFkICgpIHsKCQkJCXJlYWRlci5yZWFkKCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CgkJCQkJaWYgKHNlbGYuX2Rlc3Ryb3llZCkKCQkJCQkJcmV0dXJuCgkJCQkJaWYgKHJlc3VsdC5kb25lKSB7CgkJCQkJCXNlbGYucHVzaChudWxsKQoJCQkJCQlyZXR1cm4KCQkJCQl9CgkJCQkJc2VsZi5wdXNoKG5ldyBCdWZmZXIocmVzdWx0LnZhbHVlKSkKCQkJCQlyZWFkKCkKCQkJCX0pLmNhdGNoKGZ1bmN0aW9uKGVycikgewoJCQkJCXNlbGYuZW1pdCgnZXJyb3InLCBlcnIpCgkJCQl9KQoJCQl9CgkJCXJlYWQoKQoKCQl9IGVsc2UgewoJCQlzZWxmLl94aHIgPSB4aHIKCQkJc2VsZi5fcG9zID0gMAoKCQkJc2VsZi51cmwgPSB4aHIucmVzcG9uc2VVUkwKCQkJc2VsZi5zdGF0dXNDb2RlID0geGhyLnN0YXR1cwoJCQlzZWxmLnN0YXR1c01lc3NhZ2UgPSB4aHIuc3RhdHVzVGV4dAoJCQl2YXIgaGVhZGVycyA9IHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKS5zcGxpdCgvXHI/XG4vKQoJCQloZWFkZXJzLmZvckVhY2goZnVuY3Rpb24gKGhlYWRlcikgewoJCQkJdmFyIG1hdGNoZXMgPSBoZWFkZXIubWF0Y2goL14oW146XSspOlxzKiguKikvKQoJCQkJaWYgKG1hdGNoZXMpIHsKCQkJCQl2YXIga2V5ID0gbWF0Y2hlc1sxXS50b0xvd2VyQ2FzZSgpCgkJCQkJaWYgKGtleSA9PT0gJ3NldC1jb29raWUnKSB7CgkJCQkJCWlmIChzZWxmLmhlYWRlcnNba2V5XSA9PT0gdW5kZWZpbmVkKSB7CgkJCQkJCQlzZWxmLmhlYWRlcnNba2V5XSA9IFtdCgkJCQkJCX0KCQkJCQkJc2VsZi5oZWFkZXJzW2tleV0ucHVzaChtYXRjaGVzWzJdKQoJCQkJCX0gZWxzZSBpZiAoc2VsZi5oZWFkZXJzW2tleV0gIT09IHVuZGVmaW5lZCkgewoJCQkJCQlzZWxmLmhlYWRlcnNba2V5XSArPSAnLCAnICsgbWF0Y2hlc1syXQoJCQkJCX0gZWxzZSB7CgkJCQkJCXNlbGYuaGVhZGVyc1trZXldID0gbWF0Y2hlc1syXQoJCQkJCX0KCQkJCQlzZWxmLnJhd0hlYWRlcnMucHVzaChtYXRjaGVzWzFdLCBtYXRjaGVzWzJdKQoJCQkJfQoJCQl9KQoKCQkJc2VsZi5fY2hhcnNldCA9ICd4LXVzZXItZGVmaW5lZCcKCQkJaWYgKCFjYXBhYmlsaXR5Lm92ZXJyaWRlTWltZVR5cGUpIHsKCQkJCXZhciBtaW1lVHlwZSA9IHNlbGYucmF3SGVhZGVyc1snbWltZS10eXBlJ10KCQkJCWlmIChtaW1lVHlwZSkgewoJCQkJCXZhciBjaGFyc2V0TWF0Y2ggPSBtaW1lVHlwZS5tYXRjaCgvO1xzKmNoYXJzZXQ9KFteO10pKDt8JCkvKQoJCQkJCWlmIChjaGFyc2V0TWF0Y2gpIHsKCQkJCQkJc2VsZi5fY2hhcnNldCA9IGNoYXJzZXRNYXRjaFsxXS50b0xvd2VyQ2FzZSgpCgkJCQkJfQoJCQkJfQoJCQkJaWYgKCFzZWxmLl9jaGFyc2V0KQoJCQkJCXNlbGYuX2NoYXJzZXQgPSAndXRmLTgnIC8vIGJlc3QgZ3Vlc3MKCQkJfQoJCX0KCX0KCglpbmhlcml0cyhJbmNvbWluZ01lc3NhZ2UsIHN0cmVhbS5SZWFkYWJsZSkKCglJbmNvbWluZ01lc3NhZ2UucHJvdG90eXBlLl9yZWFkID0gZnVuY3Rpb24gKCkge30KCglJbmNvbWluZ01lc3NhZ2UucHJvdG90eXBlLl9vblhIUlByb2dyZXNzID0gZnVuY3Rpb24gKCkgewoJCXZhciBzZWxmID0gdGhpcwoKCQl2YXIgeGhyID0gc2VsZi5feGhyCgoJCXZhciByZXNwb25zZSA9IG51bGwKCQlzd2l0Y2ggKHNlbGYuX21vZGUpIHsKCQkJY2FzZSAndGV4dDp2YmFycmF5JzogLy8gRm9yIElFOQoJCQkJaWYgKHhoci5yZWFkeVN0YXRlICE9PSByU3RhdGVzLkRPTkUpCgkJCQkJYnJlYWsKCQkJCXRyeSB7CgkJCQkJLy8gVGhpcyBmYWlscyBpbiBJRTgKCQkJCQlyZXNwb25zZSA9IG5ldyBnbG9iYWwuVkJBcnJheSh4aHIucmVzcG9uc2VCb2R5KS50b0FycmF5KCkKCQkJCX0gY2F0Y2ggKGUpIHt9CgkJCQlpZiAocmVzcG9uc2UgIT09IG51bGwpIHsKCQkJCQlzZWxmLnB1c2gobmV3IEJ1ZmZlcihyZXNwb25zZSkpCgkJCQkJYnJlYWsKCQkJCX0KCQkJCS8vIEZhbGxzIHRocm91Z2ggaW4gSUU4CQoJCQljYXNlICd0ZXh0JzoKCQkJCXRyeSB7IC8vIFRoaXMgd2lsbCBmYWlsIHdoZW4gcmVhZHlTdGF0ZSA9IDMgaW4gSUU5LiBTd2l0Y2ggbW9kZSBhbmQgd2FpdCBmb3IgcmVhZHlTdGF0ZSA9IDQKCQkJCQlyZXNwb25zZSA9IHhoci5yZXNwb25zZVRleHQKCQkJCX0gY2F0Y2ggKGUpIHsKCQkJCQlzZWxmLl9tb2RlID0gJ3RleHQ6dmJhcnJheScKCQkJCQlicmVhawoJCQkJfQoJCQkJaWYgKHJlc3BvbnNlLmxlbmd0aCA+IHNlbGYuX3BvcykgewoJCQkJCXZhciBuZXdEYXRhID0gcmVzcG9uc2Uuc3Vic3RyKHNlbGYuX3BvcykKCQkJCQlpZiAoc2VsZi5fY2hhcnNldCA9PT0gJ3gtdXNlci1kZWZpbmVkJykgewoJCQkJCQl2YXIgYnVmZmVyID0gbmV3IEJ1ZmZlcihuZXdEYXRhLmxlbmd0aCkKCQkJCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBuZXdEYXRhLmxlbmd0aDsgaSsrKQoJCQkJCQkJYnVmZmVyW2ldID0gbmV3RGF0YS5jaGFyQ29kZUF0KGkpICYgMHhmZgoKCQkJCQkJc2VsZi5wdXNoKGJ1ZmZlcikKCQkJCQl9IGVsc2UgewoJCQkJCQlzZWxmLnB1c2gobmV3RGF0YSwgc2VsZi5fY2hhcnNldCkKCQkJCQl9CgkJCQkJc2VsZi5fcG9zID0gcmVzcG9uc2UubGVuZ3RoCgkJCQl9CgkJCQlicmVhawoJCQljYXNlICdhcnJheWJ1ZmZlcic6CgkJCQlpZiAoeGhyLnJlYWR5U3RhdGUgIT09IHJTdGF0ZXMuRE9ORSB8fCAheGhyLnJlc3BvbnNlKQoJCQkJCWJyZWFrCgkJCQlyZXNwb25zZSA9IHhoci5yZXNwb25zZQoJCQkJc2VsZi5wdXNoKG5ldyBCdWZmZXIobmV3IFVpbnQ4QXJyYXkocmVzcG9uc2UpKSkKCQkJCWJyZWFrCgkJCWNhc2UgJ21vei1jaHVua2VkLWFycmF5YnVmZmVyJzogLy8gdGFrZSB3aG9sZQoJCQkJcmVzcG9uc2UgPSB4aHIucmVzcG9uc2UKCQkJCWlmICh4aHIucmVhZHlTdGF0ZSAhPT0gclN0YXRlcy5MT0FESU5HIHx8ICFyZXNwb25zZSkKCQkJCQlicmVhawoJCQkJc2VsZi5wdXNoKG5ldyBCdWZmZXIobmV3IFVpbnQ4QXJyYXkocmVzcG9uc2UpKSkKCQkJCWJyZWFrCgkJCWNhc2UgJ21zLXN0cmVhbSc6CgkJCQlyZXNwb25zZSA9IHhoci5yZXNwb25zZQoJCQkJaWYgKHhoci5yZWFkeVN0YXRlICE9PSByU3RhdGVzLkxPQURJTkcpCgkJCQkJYnJlYWsKCQkJCXZhciByZWFkZXIgPSBuZXcgZ2xvYmFsLk1TU3RyZWFtUmVhZGVyKCkKCQkJCXJlYWRlci5vbnByb2dyZXNzID0gZnVuY3Rpb24gKCkgewoJCQkJCWlmIChyZWFkZXIucmVzdWx0LmJ5dGVMZW5ndGggPiBzZWxmLl9wb3MpIHsKCQkJCQkJc2VsZi5wdXNoKG5ldyBCdWZmZXIobmV3IFVpbnQ4QXJyYXkocmVhZGVyLnJlc3VsdC5zbGljZShzZWxmLl9wb3MpKSkpCgkJCQkJCXNlbGYuX3BvcyA9IHJlYWRlci5yZXN1bHQuYnl0ZUxlbmd0aAoJCQkJCX0KCQkJCX0KCQkJCXJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CgkJCQkJc2VsZi5wdXNoKG51bGwpCgkJCQl9CgkJCQkvLyByZWFkZXIub25lcnJvciA9ID8/PyAvLyBUT0RPOiB0aGlzCgkJCQlyZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIocmVzcG9uc2UpCgkJCQlicmVhawoJCX0KCgkJLy8gVGhlIG1zLXN0cmVhbSBjYXNlIGhhbmRsZXMgZW5kIHNlcGFyYXRlbHkgaW4gcmVhZGVyLm9ubG9hZCgpCgkJaWYgKHNlbGYuX3hoci5yZWFkeVN0YXRlID09PSByU3RhdGVzLkRPTkUgJiYgc2VsZi5fbW9kZSAhPT0gJ21zLXN0cmVhbScpIHsKCQkJc2VsZi5wdXNoKG51bGwpCgkJfQoJfQoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKSwgX193ZWJwYWNrX3JlcXVpcmVfXyg4KS5CdWZmZXIsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKQoKLyoqKi8gfSwKLyogMTYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKHByb2Nlc3MpIHt2YXIgU3RyZWFtID0gKGZ1bmN0aW9uICgpewoJICB0cnkgewoJICAgIHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsgLy8gaGFjayB0byBmaXggYSBjaXJjdWxhciBkZXBlbmRlbmN5IGlzc3VlIHdoZW4gdXNlZCB3aXRoIGJyb3dzZXJpZnkKCSAgfSBjYXRjaChfKXt9Cgl9KCkpOwoJZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCk7CglleHBvcnRzLlN0cmVhbSA9IFN0cmVhbSB8fCBleHBvcnRzOwoJZXhwb3J0cy5SZWFkYWJsZSA9IGV4cG9ydHM7CglleHBvcnRzLldyaXRhYmxlID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7CglleHBvcnRzLkR1cGxleCA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpOwoJZXhwb3J0cy5UcmFuc2Zvcm0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCWV4cG9ydHMuUGFzc1Rocm91Z2ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM2KTsKCglpZiAoIXByb2Nlc3MuYnJvd3NlciAmJiBwcm9jZXNzLmVudi5SRUFEQUJMRV9TVFJFQU0gPT09ICdkaXNhYmxlJyAmJiBTdHJlYW0pIHsKCSAgbW9kdWxlLmV4cG9ydHMgPSBTdHJlYW07Cgl9CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMTIpKSkKCi8qKiovIH0sCi8qIDE3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLgoJLy8KCS8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCgkvLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCgkvLyAiU29mdHdhcmUiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nCgkvLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCgkvLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0CgkvLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUKCS8vIGZvbGxvd2luZyBjb25kaXRpb25zOgoJLy8KCS8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkCgkvLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCS8vCgkvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUwoJLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgoJLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTgoJLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sCgkvLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKCS8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUKCS8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCgoJbW9kdWxlLmV4cG9ydHMgPSBTdHJlYW07CgoJdmFyIEVFID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkuRXZlbnRFbWl0dGVyOwoJdmFyIGluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CgoJaW5oZXJpdHMoU3RyZWFtLCBFRSk7CglTdHJlYW0uUmVhZGFibGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTsKCVN0cmVhbS5Xcml0YWJsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpOwoJU3RyZWFtLkR1cGxleCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpOwoJU3RyZWFtLlRyYW5zZm9ybSA9IF9fd2VicGFja19yZXF1aXJlX18oMzMpOwoJU3RyZWFtLlBhc3NUaHJvdWdoID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSk7CgoJLy8gQmFja3dhcmRzLWNvbXBhdCB3aXRoIG5vZGUgMC40LngKCVN0cmVhbS5TdHJlYW0gPSBTdHJlYW07CgoKCgkvLyBvbGQtc3R5bGUgc3RyZWFtcy4gIE5vdGUgdGhhdCB0aGUgcGlwZSBtZXRob2QgKHRoZSBvbmx5IHJlbGV2YW50CgkvLyBwYXJ0IG9mIHRoaXMgY2xhc3MpIGlzIG92ZXJyaWRkZW4gaW4gdGhlIFJlYWRhYmxlIGNsYXNzLgoKCWZ1bmN0aW9uIFN0cmVhbSgpIHsKCSAgRUUuY2FsbCh0aGlzKTsKCX0KCglTdHJlYW0ucHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbihkZXN0LCBvcHRpb25zKSB7CgkgIHZhciBzb3VyY2UgPSB0aGlzOwoKCSAgZnVuY3Rpb24gb25kYXRhKGNodW5rKSB7CgkgICAgaWYgKGRlc3Qud3JpdGFibGUpIHsKCSAgICAgIGlmIChmYWxzZSA9PT0gZGVzdC53cml0ZShjaHVuaykgJiYgc291cmNlLnBhdXNlKSB7CgkgICAgICAgIHNvdXJjZS5wYXVzZSgpOwoJICAgICAgfQoJICAgIH0KCSAgfQoKCSAgc291cmNlLm9uKCdkYXRhJywgb25kYXRhKTsKCgkgIGZ1bmN0aW9uIG9uZHJhaW4oKSB7CgkgICAgaWYgKHNvdXJjZS5yZWFkYWJsZSAmJiBzb3VyY2UucmVzdW1lKSB7CgkgICAgICBzb3VyY2UucmVzdW1lKCk7CgkgICAgfQoJICB9CgoJICBkZXN0Lm9uKCdkcmFpbicsIG9uZHJhaW4pOwoKCSAgLy8gSWYgdGhlICdlbmQnIG9wdGlvbiBpcyBub3Qgc3VwcGxpZWQsIGRlc3QuZW5kKCkgd2lsbCBiZSBjYWxsZWQgd2hlbgoJICAvLyBzb3VyY2UgZ2V0cyB0aGUgJ2VuZCcgb3IgJ2Nsb3NlJyBldmVudHMuICBPbmx5IGRlc3QuZW5kKCkgb25jZS4KCSAgaWYgKCFkZXN0Ll9pc1N0ZGlvICYmICghb3B0aW9ucyB8fCBvcHRpb25zLmVuZCAhPT0gZmFsc2UpKSB7CgkgICAgc291cmNlLm9uKCdlbmQnLCBvbmVuZCk7CgkgICAgc291cmNlLm9uKCdjbG9zZScsIG9uY2xvc2UpOwoJICB9CgoJICB2YXIgZGlkT25FbmQgPSBmYWxzZTsKCSAgZnVuY3Rpb24gb25lbmQoKSB7CgkgICAgaWYgKGRpZE9uRW5kKSByZXR1cm47CgkgICAgZGlkT25FbmQgPSB0cnVlOwoKCSAgICBkZXN0LmVuZCgpOwoJICB9CgoKCSAgZnVuY3Rpb24gb25jbG9zZSgpIHsKCSAgICBpZiAoZGlkT25FbmQpIHJldHVybjsKCSAgICBkaWRPbkVuZCA9IHRydWU7CgoJICAgIGlmICh0eXBlb2YgZGVzdC5kZXN0cm95ID09PSAnZnVuY3Rpb24nKSBkZXN0LmRlc3Ryb3koKTsKCSAgfQoKCSAgLy8gZG9uJ3QgbGVhdmUgZGFuZ2xpbmcgcGlwZXMgd2hlbiB0aGVyZSBhcmUgZXJyb3JzLgoJICBmdW5jdGlvbiBvbmVycm9yKGVyKSB7CgkgICAgY2xlYW51cCgpOwoJICAgIGlmIChFRS5saXN0ZW5lckNvdW50KHRoaXMsICdlcnJvcicpID09PSAwKSB7CgkgICAgICB0aHJvdyBlcjsgLy8gVW5oYW5kbGVkIHN0cmVhbSBlcnJvciBpbiBwaXBlLgoJICAgIH0KCSAgfQoKCSAgc291cmNlLm9uKCdlcnJvcicsIG9uZXJyb3IpOwoJICBkZXN0Lm9uKCdlcnJvcicsIG9uZXJyb3IpOwoKCSAgLy8gcmVtb3ZlIGFsbCB0aGUgZXZlbnQgbGlzdGVuZXJzIHRoYXQgd2VyZSBhZGRlZC4KCSAgZnVuY3Rpb24gY2xlYW51cCgpIHsKCSAgICBzb3VyY2UucmVtb3ZlTGlzdGVuZXIoJ2RhdGEnLCBvbmRhdGEpOwoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2RyYWluJywgb25kcmFpbik7CgoJICAgIHNvdXJjZS5yZW1vdmVMaXN0ZW5lcignZW5kJywgb25lbmQpOwoJICAgIHNvdXJjZS5yZW1vdmVMaXN0ZW5lcignY2xvc2UnLCBvbmNsb3NlKTsKCgkgICAgc291cmNlLnJlbW92ZUxpc3RlbmVyKCdlcnJvcicsIG9uZXJyb3IpOwoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25lcnJvcik7CgoJICAgIHNvdXJjZS5yZW1vdmVMaXN0ZW5lcignZW5kJywgY2xlYW51cCk7CgkgICAgc291cmNlLnJlbW92ZUxpc3RlbmVyKCdjbG9zZScsIGNsZWFudXApOwoKCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdjbG9zZScsIGNsZWFudXApOwoJICB9CgoJICBzb3VyY2Uub24oJ2VuZCcsIGNsZWFudXApOwoJICBzb3VyY2Uub24oJ2Nsb3NlJywgY2xlYW51cCk7CgoJICBkZXN0Lm9uKCdjbG9zZScsIGNsZWFudXApOwoKCSAgZGVzdC5lbWl0KCdwaXBlJywgc291cmNlKTsKCgkgIC8vIEFsbG93IGZvciB1bml4LWxpa2UgdXNhZ2U6IEEucGlwZShCKS5waXBlKEMpCgkgIHJldHVybiBkZXN0OwoJfTsKCgovKioqLyB9LAovKiAxOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCWZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHsKCSAgdGhpcy5fZXZlbnRzID0gdGhpcy5fZXZlbnRzIHx8IHt9OwoJICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkOwoJfQoJbW9kdWxlLmV4cG9ydHMgPSBFdmVudEVtaXR0ZXI7CgoJLy8gQmFja3dhcmRzLWNvbXBhdCB3aXRoIG5vZGUgMC4xMC54CglFdmVudEVtaXR0ZXIuRXZlbnRFbWl0dGVyID0gRXZlbnRFbWl0dGVyOwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50cyA9IHVuZGVmaW5lZDsKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDsKCgkvLyBCeSBkZWZhdWx0IEV2ZW50RW1pdHRlcnMgd2lsbCBwcmludCBhIHdhcm5pbmcgaWYgbW9yZSB0aGFuIDEwIGxpc3RlbmVycyBhcmUKCS8vIGFkZGVkIHRvIGl0LiBUaGlzIGlzIGEgdXNlZnVsIGRlZmF1bHQgd2hpY2ggaGVscHMgZmluZGluZyBtZW1vcnkgbGVha3MuCglFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycyA9IDEwOwoKCS8vIE9idmlvdXNseSBub3QgYWxsIEVtaXR0ZXJzIHNob3VsZCBiZSBsaW1pdGVkIHRvIDEwLiBUaGlzIGZ1bmN0aW9uIGFsbG93cwoJLy8gdGhhdCB0byBiZSBpbmNyZWFzZWQuIFNldCB0byB6ZXJvIGZvciB1bmxpbWl0ZWQuCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLnNldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uKG4pIHsKCSAgaWYgKCFpc051bWJlcihuKSB8fCBuIDwgMCB8fCBpc05hTihuKSkKCSAgICB0aHJvdyBUeXBlRXJyb3IoJ24gbXVzdCBiZSBhIHBvc2l0aXZlIG51bWJlcicpOwoJICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSBuOwoJICByZXR1cm4gdGhpczsKCX07CgoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24odHlwZSkgewoJICB2YXIgZXIsIGhhbmRsZXIsIGxlbiwgYXJncywgaSwgbGlzdGVuZXJzOwoKCSAgaWYgKCF0aGlzLl9ldmVudHMpCgkgICAgdGhpcy5fZXZlbnRzID0ge307CgoJICAvLyBJZiB0aGVyZSBpcyBubyAnZXJyb3InIGV2ZW50IGxpc3RlbmVyIHRoZW4gdGhyb3cuCgkgIGlmICh0eXBlID09PSAnZXJyb3InKSB7CgkgICAgaWYgKCF0aGlzLl9ldmVudHMuZXJyb3IgfHwKCSAgICAgICAgKGlzT2JqZWN0KHRoaXMuX2V2ZW50cy5lcnJvcikgJiYgIXRoaXMuX2V2ZW50cy5lcnJvci5sZW5ndGgpKSB7CgkgICAgICBlciA9IGFyZ3VtZW50c1sxXTsKCSAgICAgIGlmIChlciBpbnN0YW5jZW9mIEVycm9yKSB7CgkgICAgICAgIHRocm93IGVyOyAvLyBVbmhhbmRsZWQgJ2Vycm9yJyBldmVudAoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgLy8gQXQgbGVhc3QgZ2l2ZSBzb21lIGtpbmQgb2YgY29udGV4dCB0byB0aGUgdXNlcgoJICAgICAgICB2YXIgZXJyID0gbmV3IEVycm9yKCdVbmNhdWdodCwgdW5zcGVjaWZpZWQgImVycm9yIiBldmVudC4gKCcgKyBlciArICcpJyk7CgkgICAgICAgIGVyci5jb250ZXh0ID0gZXI7CgkgICAgICAgIHRocm93IGVycjsKCSAgICAgIH0KCSAgICB9CgkgIH0KCgkgIGhhbmRsZXIgPSB0aGlzLl9ldmVudHNbdHlwZV07CgoJICBpZiAoaXNVbmRlZmluZWQoaGFuZGxlcikpCgkgICAgcmV0dXJuIGZhbHNlOwoKCSAgaWYgKGlzRnVuY3Rpb24oaGFuZGxlcikpIHsKCSAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHsKCSAgICAgIC8vIGZhc3QgY2FzZXMKCSAgICAgIGNhc2UgMToKCSAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMpOwoJICAgICAgICBicmVhazsKCSAgICAgIGNhc2UgMjoKCSAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSk7CgkgICAgICAgIGJyZWFrOwoJICAgICAgY2FzZSAzOgoJICAgICAgICBoYW5kbGVyLmNhbGwodGhpcywgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0pOwoJICAgICAgICBicmVhazsKCSAgICAgIC8vIHNsb3dlcgoJICAgICAgZGVmYXVsdDoKCSAgICAgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CgkgICAgICAgIGhhbmRsZXIuYXBwbHkodGhpcywgYXJncyk7CgkgICAgfQoJICB9IGVsc2UgaWYgKGlzT2JqZWN0KGhhbmRsZXIpKSB7CgkgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CgkgICAgbGlzdGVuZXJzID0gaGFuZGxlci5zbGljZSgpOwoJICAgIGxlbiA9IGxpc3RlbmVycy5sZW5ndGg7CgkgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKQoJICAgICAgbGlzdGVuZXJzW2ldLmFwcGx5KHRoaXMsIGFyZ3MpOwoJICB9CgoJICByZXR1cm4gdHJ1ZTsKCX07CgoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7CgkgIHZhciBtOwoKCSAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSkKCSAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpOwoKCSAgaWYgKCF0aGlzLl9ldmVudHMpCgkgICAgdGhpcy5fZXZlbnRzID0ge307CgoJICAvLyBUbyBhdm9pZCByZWN1cnNpb24gaW4gdGhlIGNhc2UgdGhhdCB0eXBlID09PSAibmV3TGlzdGVuZXIiISBCZWZvcmUKCSAgLy8gYWRkaW5nIGl0IHRvIHRoZSBsaXN0ZW5lcnMsIGZpcnN0IGVtaXQgIm5ld0xpc3RlbmVyIi4KCSAgaWYgKHRoaXMuX2V2ZW50cy5uZXdMaXN0ZW5lcikKCSAgICB0aGlzLmVtaXQoJ25ld0xpc3RlbmVyJywgdHlwZSwKCSAgICAgICAgICAgICAgaXNGdW5jdGlvbihsaXN0ZW5lci5saXN0ZW5lcikgPwoJICAgICAgICAgICAgICBsaXN0ZW5lci5saXN0ZW5lciA6IGxpc3RlbmVyKTsKCgkgIGlmICghdGhpcy5fZXZlbnRzW3R5cGVdKQoJICAgIC8vIE9wdGltaXplIHRoZSBjYXNlIG9mIG9uZSBsaXN0ZW5lci4gRG9uJ3QgbmVlZCB0aGUgZXh0cmEgYXJyYXkgb2JqZWN0LgoJICAgIHRoaXMuX2V2ZW50c1t0eXBlXSA9IGxpc3RlbmVyOwoJICBlbHNlIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pKQoJICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgZ290IGFuIGFycmF5LCBqdXN0IGFwcGVuZC4KCSAgICB0aGlzLl9ldmVudHNbdHlwZV0ucHVzaChsaXN0ZW5lcik7CgkgIGVsc2UKCSAgICAvLyBBZGRpbmcgdGhlIHNlY29uZCBlbGVtZW50LCBuZWVkIHRvIGNoYW5nZSB0byBhcnJheS4KCSAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBbdGhpcy5fZXZlbnRzW3R5cGVdLCBsaXN0ZW5lcl07CgoJICAvLyBDaGVjayBmb3IgbGlzdGVuZXIgbGVhawoJICBpZiAoaXNPYmplY3QodGhpcy5fZXZlbnRzW3R5cGVdKSAmJiAhdGhpcy5fZXZlbnRzW3R5cGVdLndhcm5lZCkgewoJICAgIGlmICghaXNVbmRlZmluZWQodGhpcy5fbWF4TGlzdGVuZXJzKSkgewoJICAgICAgbSA9IHRoaXMuX21heExpc3RlbmVyczsKCSAgICB9IGVsc2UgewoJICAgICAgbSA9IEV2ZW50RW1pdHRlci5kZWZhdWx0TWF4TGlzdGVuZXJzOwoJICAgIH0KCgkgICAgaWYgKG0gJiYgbSA+IDAgJiYgdGhpcy5fZXZlbnRzW3R5cGVdLmxlbmd0aCA+IG0pIHsKCSAgICAgIHRoaXMuX2V2ZW50c1t0eXBlXS53YXJuZWQgPSB0cnVlOwoJICAgICAgY29uc29sZS5lcnJvcignKG5vZGUpIHdhcm5pbmc6IHBvc3NpYmxlIEV2ZW50RW1pdHRlciBtZW1vcnkgJyArCgkgICAgICAgICAgICAgICAgICAgICdsZWFrIGRldGVjdGVkLiAlZCBsaXN0ZW5lcnMgYWRkZWQuICcgKwoJICAgICAgICAgICAgICAgICAgICAnVXNlIGVtaXR0ZXIuc2V0TWF4TGlzdGVuZXJzKCkgdG8gaW5jcmVhc2UgbGltaXQuJywKCSAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLmxlbmd0aCk7CgkgICAgICBpZiAodHlwZW9mIGNvbnNvbGUudHJhY2UgPT09ICdmdW5jdGlvbicpIHsKCSAgICAgICAgLy8gbm90IHN1cHBvcnRlZCBpbiBJRSAxMAoJICAgICAgICBjb25zb2xlLnRyYWNlKCk7CgkgICAgICB9CgkgICAgfQoJICB9CgoJICByZXR1cm4gdGhpczsKCX07CgoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXI7CgoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHsKCSAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSkKCSAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpOwoKCSAgdmFyIGZpcmVkID0gZmFsc2U7CgoJICBmdW5jdGlvbiBnKCkgewoJICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgZyk7CgoJICAgIGlmICghZmlyZWQpIHsKCSAgICAgIGZpcmVkID0gdHJ1ZTsKCSAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgkgICAgfQoJICB9CgoJICBnLmxpc3RlbmVyID0gbGlzdGVuZXI7CgkgIHRoaXMub24odHlwZSwgZyk7CgoJICByZXR1cm4gdGhpczsKCX07CgoJLy8gZW1pdHMgYSAncmVtb3ZlTGlzdGVuZXInIGV2ZW50IGlmZiB0aGUgbGlzdGVuZXIgd2FzIHJlbW92ZWQKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikgewoJICB2YXIgbGlzdCwgcG9zaXRpb24sIGxlbmd0aCwgaTsKCgkgIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpCgkgICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTsKCgkgIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pCgkgICAgcmV0dXJuIHRoaXM7CgoJICBsaXN0ID0gdGhpcy5fZXZlbnRzW3R5cGVdOwoJICBsZW5ndGggPSBsaXN0Lmxlbmd0aDsKCSAgcG9zaXRpb24gPSAtMTsKCgkgIGlmIChsaXN0ID09PSBsaXN0ZW5lciB8fAoJICAgICAgKGlzRnVuY3Rpb24obGlzdC5saXN0ZW5lcikgJiYgbGlzdC5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7CgkgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTsKCSAgICBpZiAodGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKQoJICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTsKCgkgIH0gZWxzZSBpZiAoaXNPYmplY3QobGlzdCkpIHsKCSAgICBmb3IgKGkgPSBsZW5ndGg7IGktLSA+IDA7KSB7CgkgICAgICBpZiAobGlzdFtpXSA9PT0gbGlzdGVuZXIgfHwKCSAgICAgICAgICAobGlzdFtpXS5saXN0ZW5lciAmJiBsaXN0W2ldLmxpc3RlbmVyID09PSBsaXN0ZW5lcikpIHsKCSAgICAgICAgcG9zaXRpb24gPSBpOwoJICAgICAgICBicmVhazsKCSAgICAgIH0KCSAgICB9CgoJICAgIGlmIChwb3NpdGlvbiA8IDApCgkgICAgICByZXR1cm4gdGhpczsKCgkgICAgaWYgKGxpc3QubGVuZ3RoID09PSAxKSB7CgkgICAgICBsaXN0Lmxlbmd0aCA9IDA7CgkgICAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdOwoJICAgIH0gZWxzZSB7CgkgICAgICBsaXN0LnNwbGljZShwb3NpdGlvbiwgMSk7CgkgICAgfQoKCSAgICBpZiAodGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKQoJICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTsKCSAgfQoKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCUV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID0gZnVuY3Rpb24odHlwZSkgewoJICB2YXIga2V5LCBsaXN0ZW5lcnM7CgoJICBpZiAoIXRoaXMuX2V2ZW50cykKCSAgICByZXR1cm4gdGhpczsKCgkgIC8vIG5vdCBsaXN0ZW5pbmcgZm9yIHJlbW92ZUxpc3RlbmVyLCBubyBuZWVkIHRvIGVtaXQKCSAgaWYgKCF0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpIHsKCSAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkKCSAgICAgIHRoaXMuX2V2ZW50cyA9IHt9OwoJICAgIGVsc2UgaWYgKHRoaXMuX2V2ZW50c1t0eXBlXSkKCSAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07CgkgICAgcmV0dXJuIHRoaXM7CgkgIH0KCgkgIC8vIGVtaXQgcmVtb3ZlTGlzdGVuZXIgZm9yIGFsbCBsaXN0ZW5lcnMgb24gYWxsIGV2ZW50cwoJICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgewoJICAgIGZvciAoa2V5IGluIHRoaXMuX2V2ZW50cykgewoJICAgICAgaWYgKGtleSA9PT0gJ3JlbW92ZUxpc3RlbmVyJykgY29udGludWU7CgkgICAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycyhrZXkpOwoJICAgIH0KCSAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycygncmVtb3ZlTGlzdGVuZXInKTsKCSAgICB0aGlzLl9ldmVudHMgPSB7fTsKCSAgICByZXR1cm4gdGhpczsKCSAgfQoKCSAgbGlzdGVuZXJzID0gdGhpcy5fZXZlbnRzW3R5cGVdOwoKCSAgaWYgKGlzRnVuY3Rpb24obGlzdGVuZXJzKSkgewoJICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzKTsKCSAgfSBlbHNlIGlmIChsaXN0ZW5lcnMpIHsKCSAgICAvLyBMSUZPIG9yZGVyCgkgICAgd2hpbGUgKGxpc3RlbmVycy5sZW5ndGgpCgkgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVyc1tsaXN0ZW5lcnMubGVuZ3RoIC0gMV0pOwoJICB9CgkgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07CgoJICByZXR1cm4gdGhpczsKCX07CgoJRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lcnMgPSBmdW5jdGlvbih0eXBlKSB7CgkgIHZhciByZXQ7CgkgIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pCgkgICAgcmV0ID0gW107CgkgIGVsc2UgaWYgKGlzRnVuY3Rpb24odGhpcy5fZXZlbnRzW3R5cGVdKSkKCSAgICByZXQgPSBbdGhpcy5fZXZlbnRzW3R5cGVdXTsKCSAgZWxzZQoJICAgIHJldCA9IHRoaXMuX2V2ZW50c1t0eXBlXS5zbGljZSgpOwoJICByZXR1cm4gcmV0OwoJfTsKCglFdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbih0eXBlKSB7CgkgIGlmICh0aGlzLl9ldmVudHMpIHsKCSAgICB2YXIgZXZsaXN0ZW5lciA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCgkgICAgaWYgKGlzRnVuY3Rpb24oZXZsaXN0ZW5lcikpCgkgICAgICByZXR1cm4gMTsKCSAgICBlbHNlIGlmIChldmxpc3RlbmVyKQoJICAgICAgcmV0dXJuIGV2bGlzdGVuZXIubGVuZ3RoOwoJICB9CgkgIHJldHVybiAwOwoJfTsKCglFdmVudEVtaXR0ZXIubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKGVtaXR0ZXIsIHR5cGUpIHsKCSAgcmV0dXJuIGVtaXR0ZXIubGlzdGVuZXJDb3VudCh0eXBlKTsKCX07CgoJZnVuY3Rpb24gaXNGdW5jdGlvbihhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdmdW5jdGlvbic7Cgl9CgoJZnVuY3Rpb24gaXNOdW1iZXIoYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnbnVtYmVyJzsKCX0KCglmdW5jdGlvbiBpc09iamVjdChhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdvYmplY3QnICYmIGFyZyAhPT0gbnVsbDsKCX0KCglmdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHsKCSAgcmV0dXJuIGFyZyA9PT0gdm9pZCAwOwoJfQoKCi8qKiovIH0sCi8qIDE5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCkKCgovKioqLyB9LAovKiAyMCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24ocHJvY2Vzcywgc2V0SW1tZWRpYXRlKSB7Ly8gQSBiaXQgc2ltcGxlciB0aGFuIHJlYWRhYmxlIHN0cmVhbXMuCgkvLyBJbXBsZW1lbnQgYW4gYXN5bmMgLl93cml0ZShjaHVuaywgZW5jb2RpbmcsIGNiKSwgYW5kIGl0J2xsIGhhbmRsZSBhbGwKCS8vIHRoZSBkcmFpbiBldmVudCBlbWlzc2lvbiBhbmQgYnVmZmVyaW5nLgoKCSd1c2Ugc3RyaWN0JzsKCgltb2R1bGUuZXhwb3J0cyA9IFdyaXRhYmxlOwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgcHJvY2Vzc05leHRUaWNrID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIGFzeW5jV3JpdGUgPSAhcHJvY2Vzcy5icm93c2VyICYmIFsndjAuMTAnLCAndjAuOS4nXS5pbmRleE9mKHByb2Nlc3MudmVyc2lvbi5zbGljZSgwLCA1KSkgPiAtMSA/IHNldEltbWVkaWF0ZSA6IHByb2Nlc3NOZXh0VGljazsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgRHVwbGV4OwoJLyo8L3JlcGxhY2VtZW50PiovCgoJV3JpdGFibGUuV3JpdGFibGVTdGF0ZSA9IFdyaXRhYmxlU3RhdGU7CgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cgl1dGlsLmluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIGludGVybmFsVXRpbCA9IHsKCSAgZGVwcmVjYXRlOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQoJfTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgU3RyZWFtOwoJKGZ1bmN0aW9uICgpIHsKCSAgdHJ5IHsKCSAgICBTdHJlYW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCSAgfSBjYXRjaCAoXykge30gZmluYWxseSB7CgkgICAgaWYgKCFTdHJlYW0pIFN0cmVhbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpLkV2ZW50RW1pdHRlcjsKCSAgfQoJfSkoKTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXZhciBCdWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpLkJ1ZmZlcjsKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgYnVmZmVyU2hpbSA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJdXRpbC5pbmhlcml0cyhXcml0YWJsZSwgU3RyZWFtKTsKCglmdW5jdGlvbiBub3AoKSB7fQoKCWZ1bmN0aW9uIFdyaXRlUmVxKGNodW5rLCBlbmNvZGluZywgY2IpIHsKCSAgdGhpcy5jaHVuayA9IGNodW5rOwoJICB0aGlzLmVuY29kaW5nID0gZW5jb2Rpbmc7CgkgIHRoaXMuY2FsbGJhY2sgPSBjYjsKCSAgdGhpcy5uZXh0ID0gbnVsbDsKCX0KCglmdW5jdGlvbiBXcml0YWJsZVN0YXRlKG9wdGlvbnMsIHN0cmVhbSkgewoJICBEdXBsZXggPSBEdXBsZXggfHwgX193ZWJwYWNrX3JlcXVpcmVfXygyNyk7CgoJICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCgkgIC8vIG9iamVjdCBzdHJlYW0gZmxhZyB0byBpbmRpY2F0ZSB3aGV0aGVyIG9yIG5vdCB0aGlzIHN0cmVhbQoJICAvLyBjb250YWlucyBidWZmZXJzIG9yIG9iamVjdHMuCgkgIHRoaXMub2JqZWN0TW9kZSA9ICEhb3B0aW9ucy5vYmplY3RNb2RlOwoKCSAgaWYgKHN0cmVhbSBpbnN0YW5jZW9mIER1cGxleCkgdGhpcy5vYmplY3RNb2RlID0gdGhpcy5vYmplY3RNb2RlIHx8ICEhb3B0aW9ucy53cml0YWJsZU9iamVjdE1vZGU7CgoJICAvLyB0aGUgcG9pbnQgYXQgd2hpY2ggd3JpdGUoKSBzdGFydHMgcmV0dXJuaW5nIGZhbHNlCgkgIC8vIE5vdGU6IDAgaXMgYSB2YWxpZCB2YWx1ZSwgbWVhbnMgdGhhdCB3ZSBhbHdheXMgcmV0dXJuIGZhbHNlIGlmCgkgIC8vIHRoZSBlbnRpcmUgYnVmZmVyIGlzIG5vdCBmbHVzaGVkIGltbWVkaWF0ZWx5IG9uIHdyaXRlKCkKCSAgdmFyIGh3bSA9IG9wdGlvbnMuaGlnaFdhdGVyTWFyazsKCSAgdmFyIGRlZmF1bHRId20gPSB0aGlzLm9iamVjdE1vZGUgPyAxNiA6IDE2ICogMTAyNDsKCSAgdGhpcy5oaWdoV2F0ZXJNYXJrID0gaHdtIHx8IGh3bSA9PT0gMCA/IGh3bSA6IGRlZmF1bHRId207CgoJICAvLyBjYXN0IHRvIGludHMuCgkgIHRoaXMuaGlnaFdhdGVyTWFyayA9IH4gfnRoaXMuaGlnaFdhdGVyTWFyazsKCgkgIC8vIGRyYWluIGV2ZW50IGZsYWcuCgkgIHRoaXMubmVlZERyYWluID0gZmFsc2U7CgkgIC8vIGF0IHRoZSBzdGFydCBvZiBjYWxsaW5nIGVuZCgpCgkgIHRoaXMuZW5kaW5nID0gZmFsc2U7CgkgIC8vIHdoZW4gZW5kKCkgaGFzIGJlZW4gY2FsbGVkLCBhbmQgcmV0dXJuZWQKCSAgdGhpcy5lbmRlZCA9IGZhbHNlOwoJICAvLyB3aGVuICdmaW5pc2gnIGlzIGVtaXR0ZWQKCSAgdGhpcy5maW5pc2hlZCA9IGZhbHNlOwoKCSAgLy8gc2hvdWxkIHdlIGRlY29kZSBzdHJpbmdzIGludG8gYnVmZmVycyBiZWZvcmUgcGFzc2luZyB0byBfd3JpdGU/CgkgIC8vIHRoaXMgaXMgaGVyZSBzbyB0aGF0IHNvbWUgbm9kZS1jb3JlIHN0cmVhbXMgY2FuIG9wdGltaXplIHN0cmluZwoJICAvLyBoYW5kbGluZyBhdCBhIGxvd2VyIGxldmVsLgoJICB2YXIgbm9EZWNvZGUgPSBvcHRpb25zLmRlY29kZVN0cmluZ3MgPT09IGZhbHNlOwoJICB0aGlzLmRlY29kZVN0cmluZ3MgPSAhbm9EZWNvZGU7CgoJICAvLyBDcnlwdG8gaXMga2luZCBvZiBvbGQgYW5kIGNydXN0eS4gIEhpc3RvcmljYWxseSwgaXRzIGRlZmF1bHQgc3RyaW5nCgkgIC8vIGVuY29kaW5nIGlzICdiaW5hcnknIHNvIHdlIGhhdmUgdG8gbWFrZSB0aGlzIGNvbmZpZ3VyYWJsZS4KCSAgLy8gRXZlcnl0aGluZyBlbHNlIGluIHRoZSB1bml2ZXJzZSB1c2VzICd1dGY4JywgdGhvdWdoLgoJICB0aGlzLmRlZmF1bHRFbmNvZGluZyA9IG9wdGlvbnMuZGVmYXVsdEVuY29kaW5nIHx8ICd1dGY4JzsKCgkgIC8vIG5vdCBhbiBhY3R1YWwgYnVmZmVyIHdlIGtlZXAgdHJhY2sgb2YsIGJ1dCBhIG1lYXN1cmVtZW50CgkgIC8vIG9mIGhvdyBtdWNoIHdlJ3JlIHdhaXRpbmcgdG8gZ2V0IHB1c2hlZCB0byBzb21lIHVuZGVybHlpbmcKCSAgLy8gc29ja2V0IG9yIGZpbGUuCgkgIHRoaXMubGVuZ3RoID0gMDsKCgkgIC8vIGEgZmxhZyB0byBzZWUgd2hlbiB3ZSdyZSBpbiB0aGUgbWlkZGxlIG9mIGEgd3JpdGUuCgkgIHRoaXMud3JpdGluZyA9IGZhbHNlOwoKCSAgLy8gd2hlbiB0cnVlIGFsbCB3cml0ZXMgd2lsbCBiZSBidWZmZXJlZCB1bnRpbCAudW5jb3JrKCkgY2FsbAoJICB0aGlzLmNvcmtlZCA9IDA7CgoJICAvLyBhIGZsYWcgdG8gYmUgYWJsZSB0byB0ZWxsIGlmIHRoZSBvbndyaXRlIGNiIGlzIGNhbGxlZCBpbW1lZGlhdGVseSwKCSAgLy8gb3Igb24gYSBsYXRlciB0aWNrLiAgV2Ugc2V0IHRoaXMgdG8gdHJ1ZSBhdCBmaXJzdCwgYmVjYXVzZSBhbnkKCSAgLy8gYWN0aW9ucyB0aGF0IHNob3VsZG4ndCBoYXBwZW4gdW50aWwgImxhdGVyIiBzaG91bGQgZ2VuZXJhbGx5IGFsc28KCSAgLy8gbm90IGhhcHBlbiBiZWZvcmUgdGhlIGZpcnN0IHdyaXRlIGNhbGwuCgkgIHRoaXMuc3luYyA9IHRydWU7CgoJICAvLyBhIGZsYWcgdG8ga25vdyBpZiB3ZSdyZSBwcm9jZXNzaW5nIHByZXZpb3VzbHkgYnVmZmVyZWQgaXRlbXMsIHdoaWNoCgkgIC8vIG1heSBjYWxsIHRoZSBfd3JpdGUoKSBjYWxsYmFjayBpbiB0aGUgc2FtZSB0aWNrLCBzbyB0aGF0IHdlIGRvbid0CgkgIC8vIGVuZCB1cCBpbiBhbiBvdmVybGFwcGVkIG9ud3JpdGUgc2l0dWF0aW9uLgoJICB0aGlzLmJ1ZmZlclByb2Nlc3NpbmcgPSBmYWxzZTsKCgkgIC8vIHRoZSBjYWxsYmFjayB0aGF0J3MgcGFzc2VkIHRvIF93cml0ZShjaHVuayxjYikKCSAgdGhpcy5vbndyaXRlID0gZnVuY3Rpb24gKGVyKSB7CgkgICAgb253cml0ZShzdHJlYW0sIGVyKTsKCSAgfTsKCgkgIC8vIHRoZSBjYWxsYmFjayB0aGF0IHRoZSB1c2VyIHN1cHBsaWVzIHRvIHdyaXRlKGNodW5rLGVuY29kaW5nLGNiKQoJICB0aGlzLndyaXRlY2IgPSBudWxsOwoKCSAgLy8gdGhlIGFtb3VudCB0aGF0IGlzIGJlaW5nIHdyaXR0ZW4gd2hlbiBfd3JpdGUgaXMgY2FsbGVkLgoJICB0aGlzLndyaXRlbGVuID0gMDsKCgkgIHRoaXMuYnVmZmVyZWRSZXF1ZXN0ID0gbnVsbDsKCSAgdGhpcy5sYXN0QnVmZmVyZWRSZXF1ZXN0ID0gbnVsbDsKCgkgIC8vIG51bWJlciBvZiBwZW5kaW5nIHVzZXItc3VwcGxpZWQgd3JpdGUgY2FsbGJhY2tzCgkgIC8vIHRoaXMgbXVzdCBiZSAwIGJlZm9yZSAnZmluaXNoJyBjYW4gYmUgZW1pdHRlZAoJICB0aGlzLnBlbmRpbmdjYiA9IDA7CgoJICAvLyBlbWl0IHByZWZpbmlzaCBpZiB0aGUgb25seSB0aGluZyB3ZSdyZSB3YWl0aW5nIGZvciBpcyBfd3JpdGUgY2JzCgkgIC8vIFRoaXMgaXMgcmVsZXZhbnQgZm9yIHN5bmNocm9ub3VzIFRyYW5zZm9ybSBzdHJlYW1zCgkgIHRoaXMucHJlZmluaXNoZWQgPSBmYWxzZTsKCgkgIC8vIFRydWUgaWYgdGhlIGVycm9yIHdhcyBhbHJlYWR5IGVtaXR0ZWQgYW5kIHNob3VsZCBub3QgYmUgdGhyb3duIGFnYWluCgkgIHRoaXMuZXJyb3JFbWl0dGVkID0gZmFsc2U7CgoJICAvLyBjb3VudCBidWZmZXJlZCByZXF1ZXN0cwoJICB0aGlzLmJ1ZmZlcmVkUmVxdWVzdENvdW50ID0gMDsKCgkgIC8vIGFsbG9jYXRlIHRoZSBmaXJzdCBDb3JrZWRSZXF1ZXN0LCB0aGVyZSBpcyBhbHdheXMKCSAgLy8gb25lIGFsbG9jYXRlZCBhbmQgZnJlZSB0byB1c2UsIGFuZCB3ZSBtYWludGFpbiBhdCBtb3N0IHR3bwoJICB0aGlzLmNvcmtlZFJlcXVlc3RzRnJlZSA9IG5ldyBDb3JrZWRSZXF1ZXN0KHRoaXMpOwoJfQoKCVdyaXRhYmxlU3RhdGUucHJvdG90eXBlLmdldEJ1ZmZlciA9IGZ1bmN0aW9uIGdldEJ1ZmZlcigpIHsKCSAgdmFyIGN1cnJlbnQgPSB0aGlzLmJ1ZmZlcmVkUmVxdWVzdDsKCSAgdmFyIG91dCA9IFtdOwoJICB3aGlsZSAoY3VycmVudCkgewoJICAgIG91dC5wdXNoKGN1cnJlbnQpOwoJICAgIGN1cnJlbnQgPSBjdXJyZW50Lm5leHQ7CgkgIH0KCSAgcmV0dXJuIG91dDsKCX07CgoJKGZ1bmN0aW9uICgpIHsKCSAgdHJ5IHsKCSAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV3JpdGFibGVTdGF0ZS5wcm90b3R5cGUsICdidWZmZXInLCB7CgkgICAgICBnZXQ6IGludGVybmFsVXRpbC5kZXByZWNhdGUoZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5nZXRCdWZmZXIoKTsKCSAgICAgIH0sICdfd3JpdGFibGVTdGF0ZS5idWZmZXIgaXMgZGVwcmVjYXRlZC4gVXNlIF93cml0YWJsZVN0YXRlLmdldEJ1ZmZlciAnICsgJ2luc3RlYWQuJykKCSAgICB9KTsKCSAgfSBjYXRjaCAoXykge30KCX0pKCk7CgoJLy8gVGVzdCBfd3JpdGFibGVTdGF0ZSBmb3IgaW5oZXJpdGFuY2UgdG8gYWNjb3VudCBmb3IgRHVwbGV4IHN0cmVhbXMsCgkvLyB3aG9zZSBwcm90b3R5cGUgY2hhaW4gb25seSBwb2ludHMgdG8gUmVhZGFibGUuCgl2YXIgcmVhbEhhc0luc3RhbmNlOwoJaWYgKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgU3ltYm9sLmhhc0luc3RhbmNlICYmIHR5cGVvZiBGdW5jdGlvbi5wcm90b3R5cGVbU3ltYm9sLmhhc0luc3RhbmNlXSA9PT0gJ2Z1bmN0aW9uJykgewoJICByZWFsSGFzSW5zdGFuY2UgPSBGdW5jdGlvbi5wcm90b3R5cGVbU3ltYm9sLmhhc0luc3RhbmNlXTsKCSAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFdyaXRhYmxlLCBTeW1ib2wuaGFzSW5zdGFuY2UsIHsKCSAgICB2YWx1ZTogZnVuY3Rpb24gKG9iamVjdCkgewoJICAgICAgaWYgKHJlYWxIYXNJbnN0YW5jZS5jYWxsKHRoaXMsIG9iamVjdCkpIHJldHVybiB0cnVlOwoKCSAgICAgIHJldHVybiBvYmplY3QgJiYgb2JqZWN0Ll93cml0YWJsZVN0YXRlIGluc3RhbmNlb2YgV3JpdGFibGVTdGF0ZTsKCSAgICB9CgkgIH0pOwoJfSBlbHNlIHsKCSAgcmVhbEhhc0luc3RhbmNlID0gZnVuY3Rpb24gKG9iamVjdCkgewoJICAgIHJldHVybiBvYmplY3QgaW5zdGFuY2VvZiB0aGlzOwoJICB9OwoJfQoKCWZ1bmN0aW9uIFdyaXRhYmxlKG9wdGlvbnMpIHsKCSAgRHVwbGV4ID0gRHVwbGV4IHx8IF9fd2VicGFja19yZXF1aXJlX18oMjcpOwoKCSAgLy8gV3JpdGFibGUgY3RvciBpcyBhcHBsaWVkIHRvIER1cGxleGVzLCB0b28uCgkgIC8vIGByZWFsSGFzSW5zdGFuY2VgIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHVzaW5nIHBsYWluIGBpbnN0YW5jZW9mYAoJICAvLyB3b3VsZCByZXR1cm4gZmFsc2UsIGFzIG5vIGBfd3JpdGFibGVTdGF0ZWAgcHJvcGVydHkgaXMgYXR0YWNoZWQuCgoJICAvLyBUcnlpbmcgdG8gdXNlIHRoZSBjdXN0b20gYGluc3RhbmNlb2ZgIGZvciBXcml0YWJsZSBoZXJlIHdpbGwgYWxzbyBicmVhayB0aGUKCSAgLy8gTm9kZS5qcyBMYXp5VHJhbnNmb3JtIGltcGxlbWVudGF0aW9uLCB3aGljaCBoYXMgYSBub24tdHJpdmlhbCBnZXR0ZXIgZm9yCgkgIC8vIGBfd3JpdGFibGVTdGF0ZWAgdGhhdCB3b3VsZCBsZWFkIHRvIGluZmluaXRlIHJlY3Vyc2lvbi4KCSAgaWYgKCFyZWFsSGFzSW5zdGFuY2UuY2FsbChXcml0YWJsZSwgdGhpcykgJiYgISh0aGlzIGluc3RhbmNlb2YgRHVwbGV4KSkgewoJICAgIHJldHVybiBuZXcgV3JpdGFibGUob3B0aW9ucyk7CgkgIH0KCgkgIHRoaXMuX3dyaXRhYmxlU3RhdGUgPSBuZXcgV3JpdGFibGVTdGF0ZShvcHRpb25zLCB0aGlzKTsKCgkgIC8vIGxlZ2FjeS4KCSAgdGhpcy53cml0YWJsZSA9IHRydWU7CgoJICBpZiAob3B0aW9ucykgewoJICAgIGlmICh0eXBlb2Ygb3B0aW9ucy53cml0ZSA9PT0gJ2Z1bmN0aW9uJykgdGhpcy5fd3JpdGUgPSBvcHRpb25zLndyaXRlOwoKCSAgICBpZiAodHlwZW9mIG9wdGlvbnMud3JpdGV2ID09PSAnZnVuY3Rpb24nKSB0aGlzLl93cml0ZXYgPSBvcHRpb25zLndyaXRldjsKCSAgfQoKCSAgU3RyZWFtLmNhbGwodGhpcyk7Cgl9CgoJLy8gT3RoZXJ3aXNlIHBlb3BsZSBjYW4gcGlwZSBXcml0YWJsZSBzdHJlYW1zLCB3aGljaCBpcyBqdXN0IHdyb25nLgoJV3JpdGFibGUucHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbiAoKSB7CgkgIHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ0Nhbm5vdCBwaXBlLCBub3QgcmVhZGFibGUnKSk7Cgl9OwoKCWZ1bmN0aW9uIHdyaXRlQWZ0ZXJFbmQoc3RyZWFtLCBjYikgewoJICB2YXIgZXIgPSBuZXcgRXJyb3IoJ3dyaXRlIGFmdGVyIGVuZCcpOwoJICAvLyBUT0RPOiBkZWZlciBlcnJvciBldmVudHMgY29uc2lzdGVudGx5IGV2ZXJ5d2hlcmUsIG5vdCBqdXN0IHRoZSBjYgoJICBzdHJlYW0uZW1pdCgnZXJyb3InLCBlcik7CgkgIHByb2Nlc3NOZXh0VGljayhjYiwgZXIpOwoJfQoKCS8vIElmIHdlIGdldCBzb21ldGhpbmcgdGhhdCBpcyBub3QgYSBidWZmZXIsIHN0cmluZywgbnVsbCwgb3IgdW5kZWZpbmVkLAoJLy8gYW5kIHdlJ3JlIG5vdCBpbiBvYmplY3RNb2RlLCB0aGVuIHRoYXQncyBhbiBlcnJvci4KCS8vIE90aGVyd2lzZSBzdHJlYW0gY2h1bmtzIGFyZSBhbGwgY29uc2lkZXJlZCB0byBiZSBvZiBsZW5ndGg9MSwgYW5kIHRoZQoJLy8gd2F0ZXJtYXJrcyBkZXRlcm1pbmUgaG93IG1hbnkgb2JqZWN0cyB0byBrZWVwIGluIHRoZSBidWZmZXIsIHJhdGhlciB0aGFuCgkvLyBob3cgbWFueSBieXRlcyBvciBjaGFyYWN0ZXJzLgoJZnVuY3Rpb24gdmFsaWRDaHVuayhzdHJlYW0sIHN0YXRlLCBjaHVuaywgY2IpIHsKCSAgdmFyIHZhbGlkID0gdHJ1ZTsKCSAgdmFyIGVyID0gZmFsc2U7CgkgIC8vIEFsd2F5cyB0aHJvdyBlcnJvciBpZiBhIG51bGwgaXMgd3JpdHRlbgoJICAvLyBpZiB3ZSBhcmUgbm90IGluIG9iamVjdCBtb2RlIHRoZW4gdGhyb3cKCSAgLy8gaWYgaXQgaXMgbm90IGEgYnVmZmVyLCBzdHJpbmcsIG9yIHVuZGVmaW5lZC4KCSAgaWYgKGNodW5rID09PSBudWxsKSB7CgkgICAgZXIgPSBuZXcgVHlwZUVycm9yKCdNYXkgbm90IHdyaXRlIG51bGwgdmFsdWVzIHRvIHN0cmVhbScpOwoJICB9IGVsc2UgaWYgKCFCdWZmZXIuaXNCdWZmZXIoY2h1bmspICYmIHR5cGVvZiBjaHVuayAhPT0gJ3N0cmluZycgJiYgY2h1bmsgIT09IHVuZGVmaW5lZCAmJiAhc3RhdGUub2JqZWN0TW9kZSkgewoJICAgIGVyID0gbmV3IFR5cGVFcnJvcignSW52YWxpZCBub24tc3RyaW5nL2J1ZmZlciBjaHVuaycpOwoJICB9CgkgIGlmIChlcikgewoJICAgIHN0cmVhbS5lbWl0KCdlcnJvcicsIGVyKTsKCSAgICBwcm9jZXNzTmV4dFRpY2soY2IsIGVyKTsKCSAgICB2YWxpZCA9IGZhbHNlOwoJICB9CgkgIHJldHVybiB2YWxpZDsKCX0KCglXcml0YWJsZS5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiAoY2h1bmssIGVuY29kaW5nLCBjYikgewoJICB2YXIgc3RhdGUgPSB0aGlzLl93cml0YWJsZVN0YXRlOwoJICB2YXIgcmV0ID0gZmFsc2U7CgoJICBpZiAodHlwZW9mIGVuY29kaW5nID09PSAnZnVuY3Rpb24nKSB7CgkgICAgY2IgPSBlbmNvZGluZzsKCSAgICBlbmNvZGluZyA9IG51bGw7CgkgIH0KCgkgIGlmIChCdWZmZXIuaXNCdWZmZXIoY2h1bmspKSBlbmNvZGluZyA9ICdidWZmZXInO2Vsc2UgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSBzdGF0ZS5kZWZhdWx0RW5jb2Rpbmc7CgoJICBpZiAodHlwZW9mIGNiICE9PSAnZnVuY3Rpb24nKSBjYiA9IG5vcDsKCgkgIGlmIChzdGF0ZS5lbmRlZCkgd3JpdGVBZnRlckVuZCh0aGlzLCBjYik7ZWxzZSBpZiAodmFsaWRDaHVuayh0aGlzLCBzdGF0ZSwgY2h1bmssIGNiKSkgewoJICAgIHN0YXRlLnBlbmRpbmdjYisrOwoJICAgIHJldCA9IHdyaXRlT3JCdWZmZXIodGhpcywgc3RhdGUsIGNodW5rLCBlbmNvZGluZywgY2IpOwoJICB9CgoJICByZXR1cm4gcmV0OwoJfTsKCglXcml0YWJsZS5wcm90b3R5cGUuY29yayA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIHN0YXRlID0gdGhpcy5fd3JpdGFibGVTdGF0ZTsKCgkgIHN0YXRlLmNvcmtlZCsrOwoJfTsKCglXcml0YWJsZS5wcm90b3R5cGUudW5jb3JrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgc3RhdGUgPSB0aGlzLl93cml0YWJsZVN0YXRlOwoKCSAgaWYgKHN0YXRlLmNvcmtlZCkgewoJICAgIHN0YXRlLmNvcmtlZC0tOwoKCSAgICBpZiAoIXN0YXRlLndyaXRpbmcgJiYgIXN0YXRlLmNvcmtlZCAmJiAhc3RhdGUuZmluaXNoZWQgJiYgIXN0YXRlLmJ1ZmZlclByb2Nlc3NpbmcgJiYgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0KSBjbGVhckJ1ZmZlcih0aGlzLCBzdGF0ZSk7CgkgIH0KCX07CgoJV3JpdGFibGUucHJvdG90eXBlLnNldERlZmF1bHRFbmNvZGluZyA9IGZ1bmN0aW9uIHNldERlZmF1bHRFbmNvZGluZyhlbmNvZGluZykgewoJICAvLyBub2RlOjpQYXJzZUVuY29kaW5nKCkgcmVxdWlyZXMgbG93ZXIgY2FzZS4KCSAgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycpIGVuY29kaW5nID0gZW5jb2RpbmcudG9Mb3dlckNhc2UoKTsKCSAgaWYgKCEoWydoZXgnLCAndXRmOCcsICd1dGYtOCcsICdhc2NpaScsICdiaW5hcnknLCAnYmFzZTY0JywgJ3VjczInLCAndWNzLTInLCAndXRmMTZsZScsICd1dGYtMTZsZScsICdyYXcnXS5pbmRleE9mKChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpKSA+IC0xKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKTsKCSAgdGhpcy5fd3JpdGFibGVTdGF0ZS5kZWZhdWx0RW5jb2RpbmcgPSBlbmNvZGluZzsKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCWZ1bmN0aW9uIGRlY29kZUNodW5rKHN0YXRlLCBjaHVuaywgZW5jb2RpbmcpIHsKCSAgaWYgKCFzdGF0ZS5vYmplY3RNb2RlICYmIHN0YXRlLmRlY29kZVN0cmluZ3MgIT09IGZhbHNlICYmIHR5cGVvZiBjaHVuayA9PT0gJ3N0cmluZycpIHsKCSAgICBjaHVuayA9IGJ1ZmZlclNoaW0uZnJvbShjaHVuaywgZW5jb2RpbmcpOwoJICB9CgkgIHJldHVybiBjaHVuazsKCX0KCgkvLyBpZiB3ZSdyZSBhbHJlYWR5IHdyaXRpbmcgc29tZXRoaW5nLCB0aGVuIGp1c3QgcHV0IHRoaXMKCS8vIGluIHRoZSBxdWV1ZSwgYW5kIHdhaXQgb3VyIHR1cm4uICBPdGhlcndpc2UsIGNhbGwgX3dyaXRlCgkvLyBJZiB3ZSByZXR1cm4gZmFsc2UsIHRoZW4gd2UgbmVlZCBhIGRyYWluIGV2ZW50LCBzbyBzZXQgdGhhdCBmbGFnLgoJZnVuY3Rpb24gd3JpdGVPckJ1ZmZlcihzdHJlYW0sIHN0YXRlLCBjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIGNodW5rID0gZGVjb2RlQ2h1bmsoc3RhdGUsIGNodW5rLCBlbmNvZGluZyk7CgoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKGNodW5rKSkgZW5jb2RpbmcgPSAnYnVmZmVyJzsKCSAgdmFyIGxlbiA9IHN0YXRlLm9iamVjdE1vZGUgPyAxIDogY2h1bmsubGVuZ3RoOwoKCSAgc3RhdGUubGVuZ3RoICs9IGxlbjsKCgkgIHZhciByZXQgPSBzdGF0ZS5sZW5ndGggPCBzdGF0ZS5oaWdoV2F0ZXJNYXJrOwoJICAvLyB3ZSBtdXN0IGVuc3VyZSB0aGF0IHByZXZpb3VzIG5lZWREcmFpbiB3aWxsIG5vdCBiZSByZXNldCB0byBmYWxzZS4KCSAgaWYgKCFyZXQpIHN0YXRlLm5lZWREcmFpbiA9IHRydWU7CgoJICBpZiAoc3RhdGUud3JpdGluZyB8fCBzdGF0ZS5jb3JrZWQpIHsKCSAgICB2YXIgbGFzdCA9IHN0YXRlLmxhc3RCdWZmZXJlZFJlcXVlc3Q7CgkgICAgc3RhdGUubGFzdEJ1ZmZlcmVkUmVxdWVzdCA9IG5ldyBXcml0ZVJlcShjaHVuaywgZW5jb2RpbmcsIGNiKTsKCSAgICBpZiAobGFzdCkgewoJICAgICAgbGFzdC5uZXh0ID0gc3RhdGUubGFzdEJ1ZmZlcmVkUmVxdWVzdDsKCSAgICB9IGVsc2UgewoJICAgICAgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0ID0gc3RhdGUubGFzdEJ1ZmZlcmVkUmVxdWVzdDsKCSAgICB9CgkgICAgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0Q291bnQgKz0gMTsKCSAgfSBlbHNlIHsKCSAgICBkb1dyaXRlKHN0cmVhbSwgc3RhdGUsIGZhbHNlLCBsZW4sIGNodW5rLCBlbmNvZGluZywgY2IpOwoJICB9CgoJICByZXR1cm4gcmV0OwoJfQoKCWZ1bmN0aW9uIGRvV3JpdGUoc3RyZWFtLCBzdGF0ZSwgd3JpdGV2LCBsZW4sIGNodW5rLCBlbmNvZGluZywgY2IpIHsKCSAgc3RhdGUud3JpdGVsZW4gPSBsZW47CgkgIHN0YXRlLndyaXRlY2IgPSBjYjsKCSAgc3RhdGUud3JpdGluZyA9IHRydWU7CgkgIHN0YXRlLnN5bmMgPSB0cnVlOwoJICBpZiAod3JpdGV2KSBzdHJlYW0uX3dyaXRldihjaHVuaywgc3RhdGUub253cml0ZSk7ZWxzZSBzdHJlYW0uX3dyaXRlKGNodW5rLCBlbmNvZGluZywgc3RhdGUub253cml0ZSk7CgkgIHN0YXRlLnN5bmMgPSBmYWxzZTsKCX0KCglmdW5jdGlvbiBvbndyaXRlRXJyb3Ioc3RyZWFtLCBzdGF0ZSwgc3luYywgZXIsIGNiKSB7CgkgIC0tc3RhdGUucGVuZGluZ2NiOwoJICBpZiAoc3luYykgcHJvY2Vzc05leHRUaWNrKGNiLCBlcik7ZWxzZSBjYihlcik7CgoJICBzdHJlYW0uX3dyaXRhYmxlU3RhdGUuZXJyb3JFbWl0dGVkID0gdHJ1ZTsKCSAgc3RyZWFtLmVtaXQoJ2Vycm9yJywgZXIpOwoJfQoKCWZ1bmN0aW9uIG9ud3JpdGVTdGF0ZVVwZGF0ZShzdGF0ZSkgewoJICBzdGF0ZS53cml0aW5nID0gZmFsc2U7CgkgIHN0YXRlLndyaXRlY2IgPSBudWxsOwoJICBzdGF0ZS5sZW5ndGggLT0gc3RhdGUud3JpdGVsZW47CgkgIHN0YXRlLndyaXRlbGVuID0gMDsKCX0KCglmdW5jdGlvbiBvbndyaXRlKHN0cmVhbSwgZXIpIHsKCSAgdmFyIHN0YXRlID0gc3RyZWFtLl93cml0YWJsZVN0YXRlOwoJICB2YXIgc3luYyA9IHN0YXRlLnN5bmM7CgkgIHZhciBjYiA9IHN0YXRlLndyaXRlY2I7CgoJICBvbndyaXRlU3RhdGVVcGRhdGUoc3RhdGUpOwoKCSAgaWYgKGVyKSBvbndyaXRlRXJyb3Ioc3RyZWFtLCBzdGF0ZSwgc3luYywgZXIsIGNiKTtlbHNlIHsKCSAgICAvLyBDaGVjayBpZiB3ZSdyZSBhY3R1YWxseSByZWFkeSB0byBmaW5pc2gsIGJ1dCBkb24ndCBlbWl0IHlldAoJICAgIHZhciBmaW5pc2hlZCA9IG5lZWRGaW5pc2goc3RhdGUpOwoKCSAgICBpZiAoIWZpbmlzaGVkICYmICFzdGF0ZS5jb3JrZWQgJiYgIXN0YXRlLmJ1ZmZlclByb2Nlc3NpbmcgJiYgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0KSB7CgkgICAgICBjbGVhckJ1ZmZlcihzdHJlYW0sIHN0YXRlKTsKCSAgICB9CgoJICAgIGlmIChzeW5jKSB7CgkgICAgICAvKjxyZXBsYWNlbWVudD4qLwoJICAgICAgYXN5bmNXcml0ZShhZnRlcldyaXRlLCBzdHJlYW0sIHN0YXRlLCBmaW5pc2hlZCwgY2IpOwoJICAgICAgLyo8L3JlcGxhY2VtZW50PiovCgkgICAgfSBlbHNlIHsKCSAgICAgICAgYWZ0ZXJXcml0ZShzdHJlYW0sIHN0YXRlLCBmaW5pc2hlZCwgY2IpOwoJICAgICAgfQoJICB9Cgl9CgoJZnVuY3Rpb24gYWZ0ZXJXcml0ZShzdHJlYW0sIHN0YXRlLCBmaW5pc2hlZCwgY2IpIHsKCSAgaWYgKCFmaW5pc2hlZCkgb253cml0ZURyYWluKHN0cmVhbSwgc3RhdGUpOwoJICBzdGF0ZS5wZW5kaW5nY2ItLTsKCSAgY2IoKTsKCSAgZmluaXNoTWF5YmUoc3RyZWFtLCBzdGF0ZSk7Cgl9CgoJLy8gTXVzdCBmb3JjZSBjYWxsYmFjayB0byBiZSBjYWxsZWQgb24gbmV4dFRpY2ssIHNvIHRoYXQgd2UgZG9uJ3QKCS8vIGVtaXQgJ2RyYWluJyBiZWZvcmUgdGhlIHdyaXRlKCkgY29uc3VtZXIgZ2V0cyB0aGUgJ2ZhbHNlJyByZXR1cm4KCS8vIHZhbHVlLCBhbmQgaGFzIGEgY2hhbmNlIHRvIGF0dGFjaCBhICdkcmFpbicgbGlzdGVuZXIuCglmdW5jdGlvbiBvbndyaXRlRHJhaW4oc3RyZWFtLCBzdGF0ZSkgewoJICBpZiAoc3RhdGUubGVuZ3RoID09PSAwICYmIHN0YXRlLm5lZWREcmFpbikgewoJICAgIHN0YXRlLm5lZWREcmFpbiA9IGZhbHNlOwoJICAgIHN0cmVhbS5lbWl0KCdkcmFpbicpOwoJICB9Cgl9CgoJLy8gaWYgdGhlcmUncyBzb21ldGhpbmcgaW4gdGhlIGJ1ZmZlciB3YWl0aW5nLCB0aGVuIHByb2Nlc3MgaXQKCWZ1bmN0aW9uIGNsZWFyQnVmZmVyKHN0cmVhbSwgc3RhdGUpIHsKCSAgc3RhdGUuYnVmZmVyUHJvY2Vzc2luZyA9IHRydWU7CgkgIHZhciBlbnRyeSA9IHN0YXRlLmJ1ZmZlcmVkUmVxdWVzdDsKCgkgIGlmIChzdHJlYW0uX3dyaXRldiAmJiBlbnRyeSAmJiBlbnRyeS5uZXh0KSB7CgkgICAgLy8gRmFzdCBjYXNlLCB3cml0ZSBldmVyeXRoaW5nIHVzaW5nIF93cml0ZXYoKQoJICAgIHZhciBsID0gc3RhdGUuYnVmZmVyZWRSZXF1ZXN0Q291bnQ7CgkgICAgdmFyIGJ1ZmZlciA9IG5ldyBBcnJheShsKTsKCSAgICB2YXIgaG9sZGVyID0gc3RhdGUuY29ya2VkUmVxdWVzdHNGcmVlOwoJICAgIGhvbGRlci5lbnRyeSA9IGVudHJ5OwoKCSAgICB2YXIgY291bnQgPSAwOwoJICAgIHdoaWxlIChlbnRyeSkgewoJICAgICAgYnVmZmVyW2NvdW50XSA9IGVudHJ5OwoJICAgICAgZW50cnkgPSBlbnRyeS5uZXh0OwoJICAgICAgY291bnQgKz0gMTsKCSAgICB9CgoJICAgIGRvV3JpdGUoc3RyZWFtLCBzdGF0ZSwgdHJ1ZSwgc3RhdGUubGVuZ3RoLCBidWZmZXIsICcnLCBob2xkZXIuZmluaXNoKTsKCgkgICAgLy8gZG9Xcml0ZSBpcyBhbG1vc3QgYWx3YXlzIGFzeW5jLCBkZWZlciB0aGVzZSB0byBzYXZlIGEgYml0IG9mIHRpbWUKCSAgICAvLyBhcyB0aGUgaG90IHBhdGggZW5kcyB3aXRoIGRvV3JpdGUKCSAgICBzdGF0ZS5wZW5kaW5nY2IrKzsKCSAgICBzdGF0ZS5sYXN0QnVmZmVyZWRSZXF1ZXN0ID0gbnVsbDsKCSAgICBpZiAoaG9sZGVyLm5leHQpIHsKCSAgICAgIHN0YXRlLmNvcmtlZFJlcXVlc3RzRnJlZSA9IGhvbGRlci5uZXh0OwoJICAgICAgaG9sZGVyLm5leHQgPSBudWxsOwoJICAgIH0gZWxzZSB7CgkgICAgICBzdGF0ZS5jb3JrZWRSZXF1ZXN0c0ZyZWUgPSBuZXcgQ29ya2VkUmVxdWVzdChzdGF0ZSk7CgkgICAgfQoJICB9IGVsc2UgewoJICAgIC8vIFNsb3cgY2FzZSwgd3JpdGUgY2h1bmtzIG9uZS1ieS1vbmUKCSAgICB3aGlsZSAoZW50cnkpIHsKCSAgICAgIHZhciBjaHVuayA9IGVudHJ5LmNodW5rOwoJICAgICAgdmFyIGVuY29kaW5nID0gZW50cnkuZW5jb2Rpbmc7CgkgICAgICB2YXIgY2IgPSBlbnRyeS5jYWxsYmFjazsKCSAgICAgIHZhciBsZW4gPSBzdGF0ZS5vYmplY3RNb2RlID8gMSA6IGNodW5rLmxlbmd0aDsKCgkgICAgICBkb1dyaXRlKHN0cmVhbSwgc3RhdGUsIGZhbHNlLCBsZW4sIGNodW5rLCBlbmNvZGluZywgY2IpOwoJICAgICAgZW50cnkgPSBlbnRyeS5uZXh0OwoJICAgICAgLy8gaWYgd2UgZGlkbid0IGNhbGwgdGhlIG9ud3JpdGUgaW1tZWRpYXRlbHksIHRoZW4KCSAgICAgIC8vIGl0IG1lYW5zIHRoYXQgd2UgbmVlZCB0byB3YWl0IHVudGlsIGl0IGRvZXMuCgkgICAgICAvLyBhbHNvLCB0aGF0IG1lYW5zIHRoYXQgdGhlIGNodW5rIGFuZCBjYiBhcmUgY3VycmVudGx5CgkgICAgICAvLyBiZWluZyBwcm9jZXNzZWQsIHNvIG1vdmUgdGhlIGJ1ZmZlciBjb3VudGVyIHBhc3QgdGhlbS4KCSAgICAgIGlmIChzdGF0ZS53cml0aW5nKSB7CgkgICAgICAgIGJyZWFrOwoJICAgICAgfQoJICAgIH0KCgkgICAgaWYgKGVudHJ5ID09PSBudWxsKSBzdGF0ZS5sYXN0QnVmZmVyZWRSZXF1ZXN0ID0gbnVsbDsKCSAgfQoKCSAgc3RhdGUuYnVmZmVyZWRSZXF1ZXN0Q291bnQgPSAwOwoJICBzdGF0ZS5idWZmZXJlZFJlcXVlc3QgPSBlbnRyeTsKCSAgc3RhdGUuYnVmZmVyUHJvY2Vzc2luZyA9IGZhbHNlOwoJfQoKCVdyaXRhYmxlLnByb3RvdHlwZS5fd3JpdGUgPSBmdW5jdGlvbiAoY2h1bmssIGVuY29kaW5nLCBjYikgewoJICBjYihuZXcgRXJyb3IoJ193cml0ZSgpIGlzIG5vdCBpbXBsZW1lbnRlZCcpKTsKCX07CgoJV3JpdGFibGUucHJvdG90eXBlLl93cml0ZXYgPSBudWxsOwoKCVdyaXRhYmxlLnByb3RvdHlwZS5lbmQgPSBmdW5jdGlvbiAoY2h1bmssIGVuY29kaW5nLCBjYikgewoJICB2YXIgc3RhdGUgPSB0aGlzLl93cml0YWJsZVN0YXRlOwoKCSAgaWYgKHR5cGVvZiBjaHVuayA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIGNiID0gY2h1bms7CgkgICAgY2h1bmsgPSBudWxsOwoJICAgIGVuY29kaW5nID0gbnVsbDsKCSAgfSBlbHNlIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdmdW5jdGlvbicpIHsKCSAgICBjYiA9IGVuY29kaW5nOwoJICAgIGVuY29kaW5nID0gbnVsbDsKCSAgfQoKCSAgaWYgKGNodW5rICE9PSBudWxsICYmIGNodW5rICE9PSB1bmRlZmluZWQpIHRoaXMud3JpdGUoY2h1bmssIGVuY29kaW5nKTsKCgkgIC8vIC5lbmQoKSBmdWxseSB1bmNvcmtzCgkgIGlmIChzdGF0ZS5jb3JrZWQpIHsKCSAgICBzdGF0ZS5jb3JrZWQgPSAxOwoJICAgIHRoaXMudW5jb3JrKCk7CgkgIH0KCgkgIC8vIGlnbm9yZSB1bm5lY2Vzc2FyeSBlbmQoKSBjYWxscy4KCSAgaWYgKCFzdGF0ZS5lbmRpbmcgJiYgIXN0YXRlLmZpbmlzaGVkKSBlbmRXcml0YWJsZSh0aGlzLCBzdGF0ZSwgY2IpOwoJfTsKCglmdW5jdGlvbiBuZWVkRmluaXNoKHN0YXRlKSB7CgkgIHJldHVybiBzdGF0ZS5lbmRpbmcgJiYgc3RhdGUubGVuZ3RoID09PSAwICYmIHN0YXRlLmJ1ZmZlcmVkUmVxdWVzdCA9PT0gbnVsbCAmJiAhc3RhdGUuZmluaXNoZWQgJiYgIXN0YXRlLndyaXRpbmc7Cgl9CgoJZnVuY3Rpb24gcHJlZmluaXNoKHN0cmVhbSwgc3RhdGUpIHsKCSAgaWYgKCFzdGF0ZS5wcmVmaW5pc2hlZCkgewoJICAgIHN0YXRlLnByZWZpbmlzaGVkID0gdHJ1ZTsKCSAgICBzdHJlYW0uZW1pdCgncHJlZmluaXNoJyk7CgkgIH0KCX0KCglmdW5jdGlvbiBmaW5pc2hNYXliZShzdHJlYW0sIHN0YXRlKSB7CgkgIHZhciBuZWVkID0gbmVlZEZpbmlzaChzdGF0ZSk7CgkgIGlmIChuZWVkKSB7CgkgICAgaWYgKHN0YXRlLnBlbmRpbmdjYiA9PT0gMCkgewoJICAgICAgcHJlZmluaXNoKHN0cmVhbSwgc3RhdGUpOwoJICAgICAgc3RhdGUuZmluaXNoZWQgPSB0cnVlOwoJICAgICAgc3RyZWFtLmVtaXQoJ2ZpbmlzaCcpOwoJICAgIH0gZWxzZSB7CgkgICAgICBwcmVmaW5pc2goc3RyZWFtLCBzdGF0ZSk7CgkgICAgfQoJICB9CgkgIHJldHVybiBuZWVkOwoJfQoKCWZ1bmN0aW9uIGVuZFdyaXRhYmxlKHN0cmVhbSwgc3RhdGUsIGNiKSB7CgkgIHN0YXRlLmVuZGluZyA9IHRydWU7CgkgIGZpbmlzaE1heWJlKHN0cmVhbSwgc3RhdGUpOwoJICBpZiAoY2IpIHsKCSAgICBpZiAoc3RhdGUuZmluaXNoZWQpIHByb2Nlc3NOZXh0VGljayhjYik7ZWxzZSBzdHJlYW0ub25jZSgnZmluaXNoJywgY2IpOwoJICB9CgkgIHN0YXRlLmVuZGVkID0gdHJ1ZTsKCSAgc3RyZWFtLndyaXRhYmxlID0gZmFsc2U7Cgl9CgoJLy8gSXQgc2VlbXMgYSBsaW5rZWQgbGlzdCBidXQgaXQgaXMgbm90CgkvLyB0aGVyZSB3aWxsIGJlIG9ubHkgMiBvZiB0aGVzZSBmb3IgZWFjaCBzdHJlYW0KCWZ1bmN0aW9uIENvcmtlZFJlcXVlc3Qoc3RhdGUpIHsKCSAgdmFyIF90aGlzID0gdGhpczsKCgkgIHRoaXMubmV4dCA9IG51bGw7CgkgIHRoaXMuZW50cnkgPSBudWxsOwoKCSAgdGhpcy5maW5pc2ggPSBmdW5jdGlvbiAoZXJyKSB7CgkgICAgdmFyIGVudHJ5ID0gX3RoaXMuZW50cnk7CgkgICAgX3RoaXMuZW50cnkgPSBudWxsOwoJICAgIHdoaWxlIChlbnRyeSkgewoJICAgICAgdmFyIGNiID0gZW50cnkuY2FsbGJhY2s7CgkgICAgICBzdGF0ZS5wZW5kaW5nY2ItLTsKCSAgICAgIGNiKGVycik7CgkgICAgICBlbnRyeSA9IGVudHJ5Lm5leHQ7CgkgICAgfQoJICAgIGlmIChzdGF0ZS5jb3JrZWRSZXF1ZXN0c0ZyZWUpIHsKCSAgICAgIHN0YXRlLmNvcmtlZFJlcXVlc3RzRnJlZS5uZXh0ID0gX3RoaXM7CgkgICAgfSBlbHNlIHsKCSAgICAgIHN0YXRlLmNvcmtlZFJlcXVlc3RzRnJlZSA9IF90aGlzOwoJICAgIH0KCSAgfTsKCX0KCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKSwgX193ZWJwYWNrX3JlcXVpcmVfXygyMSkuc2V0SW1tZWRpYXRlKSkKCi8qKiovIH0sCi8qIDIxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBhcHBseSA9IEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseTsKCgkvLyBET00gQVBJcywgZm9yIGNvbXBsZXRlbmVzcwoKCWV4cG9ydHMuc2V0VGltZW91dCA9IGZ1bmN0aW9uKCkgewoJICByZXR1cm4gbmV3IFRpbWVvdXQoYXBwbHkuY2FsbChzZXRUaW1lb3V0LCB3aW5kb3csIGFyZ3VtZW50cyksIGNsZWFyVGltZW91dCk7Cgl9OwoJZXhwb3J0cy5zZXRJbnRlcnZhbCA9IGZ1bmN0aW9uKCkgewoJICByZXR1cm4gbmV3IFRpbWVvdXQoYXBwbHkuY2FsbChzZXRJbnRlcnZhbCwgd2luZG93LCBhcmd1bWVudHMpLCBjbGVhckludGVydmFsKTsKCX07CglleHBvcnRzLmNsZWFyVGltZW91dCA9CglleHBvcnRzLmNsZWFySW50ZXJ2YWwgPSBmdW5jdGlvbih0aW1lb3V0KSB7CgkgIGlmICh0aW1lb3V0KSB7CgkgICAgdGltZW91dC5jbG9zZSgpOwoJICB9Cgl9OwoKCWZ1bmN0aW9uIFRpbWVvdXQoaWQsIGNsZWFyRm4pIHsKCSAgdGhpcy5faWQgPSBpZDsKCSAgdGhpcy5fY2xlYXJGbiA9IGNsZWFyRm47Cgl9CglUaW1lb3V0LnByb3RvdHlwZS51bnJlZiA9IFRpbWVvdXQucHJvdG90eXBlLnJlZiA9IGZ1bmN0aW9uKCkge307CglUaW1lb3V0LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkgewoJICB0aGlzLl9jbGVhckZuLmNhbGwod2luZG93LCB0aGlzLl9pZCk7Cgl9OwoKCS8vIERvZXMgbm90IHN0YXJ0IHRoZSB0aW1lLCBqdXN0IHNldHMgdXAgdGhlIG1lbWJlcnMgbmVlZGVkLgoJZXhwb3J0cy5lbnJvbGwgPSBmdW5jdGlvbihpdGVtLCBtc2VjcykgewoJICBjbGVhclRpbWVvdXQoaXRlbS5faWRsZVRpbWVvdXRJZCk7CgkgIGl0ZW0uX2lkbGVUaW1lb3V0ID0gbXNlY3M7Cgl9OwoKCWV4cG9ydHMudW5lbnJvbGwgPSBmdW5jdGlvbihpdGVtKSB7CgkgIGNsZWFyVGltZW91dChpdGVtLl9pZGxlVGltZW91dElkKTsKCSAgaXRlbS5faWRsZVRpbWVvdXQgPSAtMTsKCX07CgoJZXhwb3J0cy5fdW5yZWZBY3RpdmUgPSBleHBvcnRzLmFjdGl2ZSA9IGZ1bmN0aW9uKGl0ZW0pIHsKCSAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpOwoKCSAgdmFyIG1zZWNzID0gaXRlbS5faWRsZVRpbWVvdXQ7CgkgIGlmIChtc2VjcyA+PSAwKSB7CgkgICAgaXRlbS5faWRsZVRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gb25UaW1lb3V0KCkgewoJICAgICAgaWYgKGl0ZW0uX29uVGltZW91dCkKCSAgICAgICAgaXRlbS5fb25UaW1lb3V0KCk7CgkgICAgfSwgbXNlY3MpOwoJICB9Cgl9OwoKCS8vIHNldGltbWVkaWF0ZSBhdHRhY2hlcyBpdHNlbGYgdG8gdGhlIGdsb2JhbCBvYmplY3QKCV9fd2VicGFja19yZXF1aXJlX18oMjIpOwoJZXhwb3J0cy5zZXRJbW1lZGlhdGUgPSBzZXRJbW1lZGlhdGU7CglleHBvcnRzLmNsZWFySW1tZWRpYXRlID0gY2xlYXJJbW1lZGlhdGU7CgoKLyoqKi8gfSwKLyogMjIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCwgcHJvY2VzcykgeyhmdW5jdGlvbiAoZ2xvYmFsLCB1bmRlZmluZWQpIHsKCSAgICAidXNlIHN0cmljdCI7CgoJICAgIGlmIChnbG9iYWwuc2V0SW1tZWRpYXRlKSB7CgkgICAgICAgIHJldHVybjsKCSAgICB9CgoJICAgIHZhciBuZXh0SGFuZGxlID0gMTsgLy8gU3BlYyBzYXlzIGdyZWF0ZXIgdGhhbiB6ZXJvCgkgICAgdmFyIHRhc2tzQnlIYW5kbGUgPSB7fTsKCSAgICB2YXIgY3VycmVudGx5UnVubmluZ0FUYXNrID0gZmFsc2U7CgkgICAgdmFyIGRvYyA9IGdsb2JhbC5kb2N1bWVudDsKCSAgICB2YXIgcmVnaXN0ZXJJbW1lZGlhdGU7CgoJICAgIGZ1bmN0aW9uIHNldEltbWVkaWF0ZShjYWxsYmFjaykgewoJICAgICAgLy8gQ2FsbGJhY2sgY2FuIGVpdGhlciBiZSBhIGZ1bmN0aW9uIG9yIGEgc3RyaW5nCgkgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSAiZnVuY3Rpb24iKSB7CgkgICAgICAgIGNhbGxiYWNrID0gbmV3IEZ1bmN0aW9uKCIiICsgY2FsbGJhY2spOwoJICAgICAgfQoJICAgICAgLy8gQ29weSBmdW5jdGlvbiBhcmd1bWVudHMKCSAgICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTsKCSAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykgewoJICAgICAgICAgIGFyZ3NbaV0gPSBhcmd1bWVudHNbaSArIDFdOwoJICAgICAgfQoJICAgICAgLy8gU3RvcmUgYW5kIHJlZ2lzdGVyIHRoZSB0YXNrCgkgICAgICB2YXIgdGFzayA9IHsgY2FsbGJhY2s6IGNhbGxiYWNrLCBhcmdzOiBhcmdzIH07CgkgICAgICB0YXNrc0J5SGFuZGxlW25leHRIYW5kbGVdID0gdGFzazsKCSAgICAgIHJlZ2lzdGVySW1tZWRpYXRlKG5leHRIYW5kbGUpOwoJICAgICAgcmV0dXJuIG5leHRIYW5kbGUrKzsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGNsZWFySW1tZWRpYXRlKGhhbmRsZSkgewoJICAgICAgICBkZWxldGUgdGFza3NCeUhhbmRsZVtoYW5kbGVdOwoJICAgIH0KCgkgICAgZnVuY3Rpb24gcnVuKHRhc2spIHsKCSAgICAgICAgdmFyIGNhbGxiYWNrID0gdGFzay5jYWxsYmFjazsKCSAgICAgICAgdmFyIGFyZ3MgPSB0YXNrLmFyZ3M7CgkgICAgICAgIHN3aXRjaCAoYXJncy5sZW5ndGgpIHsKCSAgICAgICAgY2FzZSAwOgoJICAgICAgICAgICAgY2FsbGJhY2soKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBjYXNlIDE6CgkgICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBjYXNlIDI6CgkgICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBjYXNlIDM6CgkgICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodW5kZWZpbmVkLCBhcmdzKTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBmdW5jdGlvbiBydW5JZlByZXNlbnQoaGFuZGxlKSB7CgkgICAgICAgIC8vIEZyb20gdGhlIHNwZWM6ICJXYWl0IHVudGlsIGFueSBpbnZvY2F0aW9ucyBvZiB0aGlzIGFsZ29yaXRobSBzdGFydGVkIGJlZm9yZSB0aGlzIG9uZSBoYXZlIGNvbXBsZXRlZC4iCgkgICAgICAgIC8vIFNvIGlmIHdlJ3JlIGN1cnJlbnRseSBydW5uaW5nIGEgdGFzaywgd2UnbGwgbmVlZCB0byBkZWxheSB0aGlzIGludm9jYXRpb24uCgkgICAgICAgIGlmIChjdXJyZW50bHlSdW5uaW5nQVRhc2spIHsKCSAgICAgICAgICAgIC8vIERlbGF5IGJ5IGRvaW5nIGEgc2V0VGltZW91dC4gc2V0SW1tZWRpYXRlIHdhcyB0cmllZCBpbnN0ZWFkLCBidXQgaW4gRmlyZWZveCA3IGl0IGdlbmVyYXRlZCBhCgkgICAgICAgICAgICAvLyAidG9vIG11Y2ggcmVjdXJzaW9uIiBlcnJvci4KCSAgICAgICAgICAgIHNldFRpbWVvdXQocnVuSWZQcmVzZW50LCAwLCBoYW5kbGUpOwoJICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgdmFyIHRhc2sgPSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07CgkgICAgICAgICAgICBpZiAodGFzaykgewoJICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IHRydWU7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgcnVuKHRhc2spOwoJICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CgkgICAgICAgICAgICAgICAgICAgIGNsZWFySW1tZWRpYXRlKGhhbmRsZSk7CgkgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCgkgICAgZnVuY3Rpb24gaW5zdGFsbE5leHRUaWNrSW1wbGVtZW50YXRpb24oKSB7CgkgICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7CgkgICAgICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsgcnVuSWZQcmVzZW50KGhhbmRsZSk7IH0pOwoJICAgICAgICB9OwoJICAgIH0KCgkgICAgZnVuY3Rpb24gY2FuVXNlUG9zdE1lc3NhZ2UoKSB7CgkgICAgICAgIC8vIFRoZSB0ZXN0IGFnYWluc3QgYGltcG9ydFNjcmlwdHNgIHByZXZlbnRzIHRoaXMgaW1wbGVtZW50YXRpb24gZnJvbSBiZWluZyBpbnN0YWxsZWQgaW5zaWRlIGEgd2ViIHdvcmtlciwKCSAgICAgICAgLy8gd2hlcmUgYGdsb2JhbC5wb3N0TWVzc2FnZWAgbWVhbnMgc29tZXRoaW5nIGNvbXBsZXRlbHkgZGlmZmVyZW50IGFuZCBjYW4ndCBiZSB1c2VkIGZvciB0aGlzIHB1cnBvc2UuCgkgICAgICAgIGlmIChnbG9iYWwucG9zdE1lc3NhZ2UgJiYgIWdsb2JhbC5pbXBvcnRTY3JpcHRzKSB7CgkgICAgICAgICAgICB2YXIgcG9zdE1lc3NhZ2VJc0FzeW5jaHJvbm91cyA9IHRydWU7CgkgICAgICAgICAgICB2YXIgb2xkT25NZXNzYWdlID0gZ2xvYmFsLm9ubWVzc2FnZTsKCSAgICAgICAgICAgIGdsb2JhbC5vbm1lc3NhZ2UgPSBmdW5jdGlvbigpIHsKCSAgICAgICAgICAgICAgICBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzID0gZmFsc2U7CgkgICAgICAgICAgICB9OwoJICAgICAgICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKCIiLCAiKiIpOwoJICAgICAgICAgICAgZ2xvYmFsLm9ubWVzc2FnZSA9IG9sZE9uTWVzc2FnZTsKCSAgICAgICAgICAgIHJldHVybiBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBmdW5jdGlvbiBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpIHsKCSAgICAgICAgLy8gSW5zdGFsbHMgYW4gZXZlbnQgaGFuZGxlciBvbiBgZ2xvYmFsYCBmb3IgdGhlIGBtZXNzYWdlYCBldmVudDogc2VlCgkgICAgICAgIC8vICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vRE9NL3dpbmRvdy5wb3N0TWVzc2FnZQoJICAgICAgICAvLyAqIGh0dHA6Ly93d3cud2hhdHdnLm9yZy9zcGVjcy93ZWItYXBwcy9jdXJyZW50LXdvcmsvbXVsdGlwYWdlL2NvbW1zLmh0bWwjY3Jvc3NEb2N1bWVudE1lc3NhZ2VzCgoJICAgICAgICB2YXIgbWVzc2FnZVByZWZpeCA9ICJzZXRJbW1lZGlhdGUkIiArIE1hdGgucmFuZG9tKCkgKyAiJCI7CgkgICAgICAgIHZhciBvbkdsb2JhbE1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkgewoJICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gZ2xvYmFsICYmCgkgICAgICAgICAgICAgICAgdHlwZW9mIGV2ZW50LmRhdGEgPT09ICJzdHJpbmciICYmCgkgICAgICAgICAgICAgICAgZXZlbnQuZGF0YS5pbmRleE9mKG1lc3NhZ2VQcmVmaXgpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcnVuSWZQcmVzZW50KCtldmVudC5kYXRhLnNsaWNlKG1lc3NhZ2VQcmVmaXgubGVuZ3RoKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH07CgoJICAgICAgICBpZiAoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIpIHsKCSAgICAgICAgICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgb25HbG9iYWxNZXNzYWdlLCBmYWxzZSk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBnbG9iYWwuYXR0YWNoRXZlbnQoIm9ubWVzc2FnZSIsIG9uR2xvYmFsTWVzc2FnZSk7CgkgICAgICAgIH0KCgkgICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7CgkgICAgICAgICAgICBnbG9iYWwucG9zdE1lc3NhZ2UobWVzc2FnZVByZWZpeCArIGhhbmRsZSwgIioiKTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGluc3RhbGxNZXNzYWdlQ2hhbm5lbEltcGxlbWVudGF0aW9uKCkgewoJICAgICAgICB2YXIgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpOwoJICAgICAgICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkgICAgICAgICAgICB2YXIgaGFuZGxlID0gZXZlbnQuZGF0YTsKCSAgICAgICAgICAgIHJ1bklmUHJlc2VudChoYW5kbGUpOwoJICAgICAgICB9OwoKCSAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHsKCSAgICAgICAgICAgIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoaGFuZGxlKTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGluc3RhbGxSZWFkeVN0YXRlQ2hhbmdlSW1wbGVtZW50YXRpb24oKSB7CgkgICAgICAgIHZhciBodG1sID0gZG9jLmRvY3VtZW50RWxlbWVudDsKCSAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHsKCSAgICAgICAgICAgIC8vIENyZWF0ZSBhIDxzY3JpcHQ+IGVsZW1lbnQ7IGl0cyByZWFkeXN0YXRlY2hhbmdlIGV2ZW50IHdpbGwgYmUgZmlyZWQgYXN5bmNocm9ub3VzbHkgb25jZSBpdCBpcyBpbnNlcnRlZAoJICAgICAgICAgICAgLy8gaW50byB0aGUgZG9jdW1lbnQuIERvIHNvLCB0aHVzIHF1ZXVpbmcgdXAgdGhlIHRhc2suIFJlbWVtYmVyIHRvIGNsZWFuIHVwIG9uY2UgaXQncyBiZWVuIGNhbGxlZC4KCSAgICAgICAgICAgIHZhciBzY3JpcHQgPSBkb2MuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CgkgICAgICAgICAgICBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgICAgIHJ1bklmUHJlc2VudChoYW5kbGUpOwoJICAgICAgICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsOwoJICAgICAgICAgICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQoc2NyaXB0KTsKCSAgICAgICAgICAgICAgICBzY3JpcHQgPSBudWxsOwoJICAgICAgICAgICAgfTsKCSAgICAgICAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoc2NyaXB0KTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGluc3RhbGxTZXRUaW1lb3V0SW1wbGVtZW50YXRpb24oKSB7CgkgICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7CgkgICAgICAgICAgICBzZXRUaW1lb3V0KHJ1bklmUHJlc2VudCwgMCwgaGFuZGxlKTsKCSAgICAgICAgfTsKCSAgICB9CgoJICAgIC8vIElmIHN1cHBvcnRlZCwgd2Ugc2hvdWxkIGF0dGFjaCB0byB0aGUgcHJvdG90eXBlIG9mIGdsb2JhbCwgc2luY2UgdGhhdCBpcyB3aGVyZSBzZXRUaW1lb3V0IGV0IGFsLiBsaXZlLgoJICAgIHZhciBhdHRhY2hUbyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiAmJiBPYmplY3QuZ2V0UHJvdG90eXBlT2YoZ2xvYmFsKTsKCSAgICBhdHRhY2hUbyA9IGF0dGFjaFRvICYmIGF0dGFjaFRvLnNldFRpbWVvdXQgPyBhdHRhY2hUbyA6IGdsb2JhbDsKCgkgICAgLy8gRG9uJ3QgZ2V0IGZvb2xlZCBieSBlLmcuIGJyb3dzZXJpZnkgZW52aXJvbm1lbnRzLgoJICAgIGlmICh7fS50b1N0cmluZy5jYWxsKGdsb2JhbC5wcm9jZXNzKSA9PT0gIltvYmplY3QgcHJvY2Vzc10iKSB7CgkgICAgICAgIC8vIEZvciBOb2RlLmpzIGJlZm9yZSAwLjkKCSAgICAgICAgaW5zdGFsbE5leHRUaWNrSW1wbGVtZW50YXRpb24oKTsKCgkgICAgfSBlbHNlIGlmIChjYW5Vc2VQb3N0TWVzc2FnZSgpKSB7CgkgICAgICAgIC8vIEZvciBub24tSUUxMCBtb2Rlcm4gYnJvd3NlcnMKCSAgICAgICAgaW5zdGFsbFBvc3RNZXNzYWdlSW1wbGVtZW50YXRpb24oKTsKCgkgICAgfSBlbHNlIGlmIChnbG9iYWwuTWVzc2FnZUNoYW5uZWwpIHsKCSAgICAgICAgLy8gRm9yIHdlYiB3b3JrZXJzLCB3aGVyZSBzdXBwb3J0ZWQKCSAgICAgICAgaW5zdGFsbE1lc3NhZ2VDaGFubmVsSW1wbGVtZW50YXRpb24oKTsKCgkgICAgfSBlbHNlIGlmIChkb2MgJiYgIm9ucmVhZHlzdGF0ZWNoYW5nZSIgaW4gZG9jLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpKSB7CgkgICAgICAgIC8vIEZvciBJRSA24oCTOAoJICAgICAgICBpbnN0YWxsUmVhZHlTdGF0ZUNoYW5nZUltcGxlbWVudGF0aW9uKCk7CgoJICAgIH0gZWxzZSB7CgkgICAgICAgIC8vIEZvciBvbGRlciBicm93c2VycwoJICAgICAgICBpbnN0YWxsU2V0VGltZW91dEltcGxlbWVudGF0aW9uKCk7CgkgICAgfQoKCSAgICBhdHRhY2hUby5zZXRJbW1lZGlhdGUgPSBzZXRJbW1lZGlhdGU7CgkgICAgYXR0YWNoVG8uY2xlYXJJbW1lZGlhdGUgPSBjbGVhckltbWVkaWF0ZTsKCX0odHlwZW9mIHNlbGYgPT09ICJ1bmRlZmluZWQiID8gdHlwZW9mIGdsb2JhbCA9PT0gInVuZGVmaW5lZCIgPyB0aGlzIDogZ2xvYmFsIDogc2VsZikpOwoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKSkpCgovKioqLyB9LAovKiAyMyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24ocHJvY2Vzcykgeyd1c2Ugc3RyaWN0JzsKCglpZiAoIXByb2Nlc3MudmVyc2lvbiB8fAoJICAgIHByb2Nlc3MudmVyc2lvbi5pbmRleE9mKCd2MC4nKSA9PT0gMCB8fAoJICAgIHByb2Nlc3MudmVyc2lvbi5pbmRleE9mKCd2MS4nKSA9PT0gMCAmJiBwcm9jZXNzLnZlcnNpb24uaW5kZXhPZigndjEuOC4nKSAhPT0gMCkgewoJICBtb2R1bGUuZXhwb3J0cyA9IG5leHRUaWNrOwoJfSBlbHNlIHsKCSAgbW9kdWxlLmV4cG9ydHMgPSBwcm9jZXNzLm5leHRUaWNrOwoJfQoKCWZ1bmN0aW9uIG5leHRUaWNrKGZuLCBhcmcxLCBhcmcyLCBhcmczKSB7CgkgIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCciY2FsbGJhY2siIGFyZ3VtZW50IG11c3QgYmUgYSBmdW5jdGlvbicpOwoJICB9CgkgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOwoJICB2YXIgYXJncywgaTsKCSAgc3dpdGNoIChsZW4pIHsKCSAgY2FzZSAwOgoJICBjYXNlIDE6CgkgICAgcmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZm4pOwoJICBjYXNlIDI6CgkgICAgcmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gYWZ0ZXJUaWNrT25lKCkgewoJICAgICAgZm4uY2FsbChudWxsLCBhcmcxKTsKCSAgICB9KTsKCSAgY2FzZSAzOgoJICAgIHJldHVybiBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uIGFmdGVyVGlja1R3bygpIHsKCSAgICAgIGZuLmNhbGwobnVsbCwgYXJnMSwgYXJnMik7CgkgICAgfSk7CgkgIGNhc2UgNDoKCSAgICByZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiBhZnRlclRpY2tUaHJlZSgpIHsKCSAgICAgIGZuLmNhbGwobnVsbCwgYXJnMSwgYXJnMiwgYXJnMyk7CgkgICAgfSk7CgkgIGRlZmF1bHQ6CgkgICAgYXJncyA9IG5ldyBBcnJheShsZW4gLSAxKTsKCSAgICBpID0gMDsKCSAgICB3aGlsZSAoaSA8IGFyZ3MubGVuZ3RoKSB7CgkgICAgICBhcmdzW2krK10gPSBhcmd1bWVudHNbaV07CgkgICAgfQoJICAgIHJldHVybiBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uIGFmdGVyVGljaygpIHsKCSAgICAgIGZuLmFwcGx5KG51bGwsIGFyZ3MpOwoJICAgIH0pOwoJICB9Cgl9CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMTIpKSkKCi8qKiovIH0sCi8qIDI0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihCdWZmZXIpIHsvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCS8vIE5PVEU6IFRoZXNlIHR5cGUgY2hlY2tpbmcgZnVuY3Rpb25zIGludGVudGlvbmFsbHkgZG9uJ3QgdXNlIGBpbnN0YW5jZW9mYAoJLy8gYmVjYXVzZSBpdCBpcyBmcmFnaWxlIGFuZCBjYW4gYmUgZWFzaWx5IGZha2VkIHdpdGggYE9iamVjdC5jcmVhdGUoKWAuCgoJZnVuY3Rpb24gaXNBcnJheShhcmcpIHsKCSAgaWYgKEFycmF5LmlzQXJyYXkpIHsKCSAgICByZXR1cm4gQXJyYXkuaXNBcnJheShhcmcpOwoJICB9CgkgIHJldHVybiBvYmplY3RUb1N0cmluZyhhcmcpID09PSAnW29iamVjdCBBcnJheV0nOwoJfQoJZXhwb3J0cy5pc0FycmF5ID0gaXNBcnJheTsKCglmdW5jdGlvbiBpc0Jvb2xlYW4oYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnYm9vbGVhbic7Cgl9CglleHBvcnRzLmlzQm9vbGVhbiA9IGlzQm9vbGVhbjsKCglmdW5jdGlvbiBpc051bGwoYXJnKSB7CgkgIHJldHVybiBhcmcgPT09IG51bGw7Cgl9CglleHBvcnRzLmlzTnVsbCA9IGlzTnVsbDsKCglmdW5jdGlvbiBpc051bGxPclVuZGVmaW5lZChhcmcpIHsKCSAgcmV0dXJuIGFyZyA9PSBudWxsOwoJfQoJZXhwb3J0cy5pc051bGxPclVuZGVmaW5lZCA9IGlzTnVsbE9yVW5kZWZpbmVkOwoKCWZ1bmN0aW9uIGlzTnVtYmVyKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ251bWJlcic7Cgl9CglleHBvcnRzLmlzTnVtYmVyID0gaXNOdW1iZXI7CgoJZnVuY3Rpb24gaXNTdHJpbmcoYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnc3RyaW5nJzsKCX0KCWV4cG9ydHMuaXNTdHJpbmcgPSBpc1N0cmluZzsKCglmdW5jdGlvbiBpc1N5bWJvbChhcmcpIHsKCSAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdzeW1ib2wnOwoJfQoJZXhwb3J0cy5pc1N5bWJvbCA9IGlzU3ltYm9sOwoKCWZ1bmN0aW9uIGlzVW5kZWZpbmVkKGFyZykgewoJICByZXR1cm4gYXJnID09PSB2b2lkIDA7Cgl9CglleHBvcnRzLmlzVW5kZWZpbmVkID0gaXNVbmRlZmluZWQ7CgoJZnVuY3Rpb24gaXNSZWdFeHAocmUpIHsKCSAgcmV0dXJuIG9iamVjdFRvU3RyaW5nKHJlKSA9PT0gJ1tvYmplY3QgUmVnRXhwXSc7Cgl9CglleHBvcnRzLmlzUmVnRXhwID0gaXNSZWdFeHA7CgoJZnVuY3Rpb24gaXNPYmplY3QoYXJnKSB7CgkgIHJldHVybiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiBhcmcgIT09IG51bGw7Cgl9CglleHBvcnRzLmlzT2JqZWN0ID0gaXNPYmplY3Q7CgoJZnVuY3Rpb24gaXNEYXRlKGQpIHsKCSAgcmV0dXJuIG9iamVjdFRvU3RyaW5nKGQpID09PSAnW29iamVjdCBEYXRlXSc7Cgl9CglleHBvcnRzLmlzRGF0ZSA9IGlzRGF0ZTsKCglmdW5jdGlvbiBpc0Vycm9yKGUpIHsKCSAgcmV0dXJuIChvYmplY3RUb1N0cmluZyhlKSA9PT0gJ1tvYmplY3QgRXJyb3JdJyB8fCBlIGluc3RhbmNlb2YgRXJyb3IpOwoJfQoJZXhwb3J0cy5pc0Vycm9yID0gaXNFcnJvcjsKCglmdW5jdGlvbiBpc0Z1bmN0aW9uKGFyZykgewoJICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Z1bmN0aW9uJzsKCX0KCWV4cG9ydHMuaXNGdW5jdGlvbiA9IGlzRnVuY3Rpb247CgoJZnVuY3Rpb24gaXNQcmltaXRpdmUoYXJnKSB7CgkgIHJldHVybiBhcmcgPT09IG51bGwgfHwKCSAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdib29sZWFuJyB8fAoJICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ251bWJlcicgfHwKCSAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnIHx8CgkgICAgICAgICB0eXBlb2YgYXJnID09PSAnc3ltYm9sJyB8fCAgLy8gRVM2IHN5bWJvbAoJICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ3VuZGVmaW5lZCc7Cgl9CglleHBvcnRzLmlzUHJpbWl0aXZlID0gaXNQcmltaXRpdmU7CgoJZXhwb3J0cy5pc0J1ZmZlciA9IEJ1ZmZlci5pc0J1ZmZlcjsKCglmdW5jdGlvbiBvYmplY3RUb1N0cmluZyhvKSB7CgkgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobyk7Cgl9CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oOCkuQnVmZmVyKSkKCi8qKiovIH0sCi8qIDI1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHsKCS8qKgoJICogTW9kdWxlIGV4cG9ydHMuCgkgKi8KCgltb2R1bGUuZXhwb3J0cyA9IGRlcHJlY2F0ZTsKCgkvKioKCSAqIE1hcmsgdGhhdCBhIG1ldGhvZCBzaG91bGQgbm90IGJlIHVzZWQuCgkgKiBSZXR1cm5zIGEgbW9kaWZpZWQgZnVuY3Rpb24gd2hpY2ggd2FybnMgb25jZSBieSBkZWZhdWx0LgoJICoKCSAqIElmIGBsb2NhbFN0b3JhZ2Uubm9EZXByZWNhdGlvbiA9IHRydWVgIGlzIHNldCwgdGhlbiBpdCBpcyBhIG5vLW9wLgoJICoKCSAqIElmIGBsb2NhbFN0b3JhZ2UudGhyb3dEZXByZWNhdGlvbiA9IHRydWVgIGlzIHNldCwgdGhlbiBkZXByZWNhdGVkIGZ1bmN0aW9ucwoJICogd2lsbCB0aHJvdyBhbiBFcnJvciB3aGVuIGludm9rZWQuCgkgKgoJICogSWYgYGxvY2FsU3RvcmFnZS50cmFjZURlcHJlY2F0aW9uID0gdHJ1ZWAgaXMgc2V0LCB0aGVuIGRlcHJlY2F0ZWQgZnVuY3Rpb25zCgkgKiB3aWxsIGludm9rZSBgY29uc29sZS50cmFjZSgpYCBpbnN0ZWFkIG9mIGBjb25zb2xlLmVycm9yKClgLgoJICoKCSAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gdGhlIGZ1bmN0aW9uIHRvIGRlcHJlY2F0ZQoJICogQHBhcmFtIHtTdHJpbmd9IG1zZyAtIHRoZSBzdHJpbmcgdG8gcHJpbnQgdG8gdGhlIGNvbnNvbGUgd2hlbiBgZm5gIGlzIGludm9rZWQKCSAqIEByZXR1cm5zIHtGdW5jdGlvbn0gYSBuZXcgImRlcHJlY2F0ZWQiIHZlcnNpb24gb2YgYGZuYAoJICogQGFwaSBwdWJsaWMKCSAqLwoKCWZ1bmN0aW9uIGRlcHJlY2F0ZSAoZm4sIG1zZykgewoJICBpZiAoY29uZmlnKCdub0RlcHJlY2F0aW9uJykpIHsKCSAgICByZXR1cm4gZm47CgkgIH0KCgkgIHZhciB3YXJuZWQgPSBmYWxzZTsKCSAgZnVuY3Rpb24gZGVwcmVjYXRlZCgpIHsKCSAgICBpZiAoIXdhcm5lZCkgewoJICAgICAgaWYgKGNvbmZpZygndGhyb3dEZXByZWNhdGlvbicpKSB7CgkgICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpOwoJICAgICAgfSBlbHNlIGlmIChjb25maWcoJ3RyYWNlRGVwcmVjYXRpb24nKSkgewoJICAgICAgICBjb25zb2xlLnRyYWNlKG1zZyk7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBjb25zb2xlLndhcm4obXNnKTsKCSAgICAgIH0KCSAgICAgIHdhcm5lZCA9IHRydWU7CgkgICAgfQoJICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICB9CgoJICByZXR1cm4gZGVwcmVjYXRlZDsKCX0KCgkvKioKCSAqIENoZWNrcyBgbG9jYWxTdG9yYWdlYCBmb3IgYm9vbGVhbiB2YWx1ZXMgZm9yIHRoZSBnaXZlbiBgbmFtZWAuCgkgKgoJICogQHBhcmFtIHtTdHJpbmd9IG5hbWUKCSAqIEByZXR1cm5zIHtCb29sZWFufQoJICogQGFwaSBwcml2YXRlCgkgKi8KCglmdW5jdGlvbiBjb25maWcgKG5hbWUpIHsKCSAgLy8gYWNjZXNzaW5nIGdsb2JhbC5sb2NhbFN0b3JhZ2UgY2FuIHRyaWdnZXIgYSBET01FeGNlcHRpb24gaW4gc2FuZGJveGVkIGlmcmFtZXMKCSAgdHJ5IHsKCSAgICBpZiAoIWdsb2JhbC5sb2NhbFN0b3JhZ2UpIHJldHVybiBmYWxzZTsKCSAgfSBjYXRjaCAoXykgewoJICAgIHJldHVybiBmYWxzZTsKCSAgfQoJICB2YXIgdmFsID0gZ2xvYmFsLmxvY2FsU3RvcmFnZVtuYW1lXTsKCSAgaWYgKG51bGwgPT0gdmFsKSByZXR1cm4gZmFsc2U7CgkgIHJldHVybiBTdHJpbmcodmFsKS50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZSc7Cgl9CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKQoKLyoqKi8gfSwKLyogMjYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCkgeyd1c2Ugc3RyaWN0JzsKCgl2YXIgYnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCXZhciBCdWZmZXIgPSBidWZmZXIuQnVmZmVyOwoJdmFyIFNsb3dCdWZmZXIgPSBidWZmZXIuU2xvd0J1ZmZlcjsKCXZhciBNQVhfTEVOID0gYnVmZmVyLmtNYXhMZW5ndGggfHwgMjE0NzQ4MzY0NzsKCWV4cG9ydHMuYWxsb2MgPSBmdW5jdGlvbiBhbGxvYyhzaXplLCBmaWxsLCBlbmNvZGluZykgewoJICBpZiAodHlwZW9mIEJ1ZmZlci5hbGxvYyA9PT0gJ2Z1bmN0aW9uJykgewoJICAgIHJldHVybiBCdWZmZXIuYWxsb2Moc2l6ZSwgZmlsbCwgZW5jb2RpbmcpOwoJICB9CgkgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZW5jb2RpbmcgbXVzdCBub3QgYmUgbnVtYmVyJyk7CgkgIH0KCSAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3NpemUgbXVzdCBiZSBhIG51bWJlcicpOwoJICB9CgkgIGlmIChzaXplID4gTUFYX0xFTikgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdzaXplIGlzIHRvbyBsYXJnZScpOwoJICB9CgkgIHZhciBlbmMgPSBlbmNvZGluZzsKCSAgdmFyIF9maWxsID0gZmlsbDsKCSAgaWYgKF9maWxsID09PSB1bmRlZmluZWQpIHsKCSAgICBlbmMgPSB1bmRlZmluZWQ7CgkgICAgX2ZpbGwgPSAwOwoJICB9CgkgIHZhciBidWYgPSBuZXcgQnVmZmVyKHNpemUpOwoJICBpZiAodHlwZW9mIF9maWxsID09PSAnc3RyaW5nJykgewoJICAgIHZhciBmaWxsQnVmID0gbmV3IEJ1ZmZlcihfZmlsbCwgZW5jKTsKCSAgICB2YXIgZmxlbiA9IGZpbGxCdWYubGVuZ3RoOwoJICAgIHZhciBpID0gLTE7CgkgICAgd2hpbGUgKCsraSA8IHNpemUpIHsKCSAgICAgIGJ1ZltpXSA9IGZpbGxCdWZbaSAlIGZsZW5dOwoJICAgIH0KCSAgfSBlbHNlIHsKCSAgICBidWYuZmlsbChfZmlsbCk7CgkgIH0KCSAgcmV0dXJuIGJ1ZjsKCX0KCWV4cG9ydHMuYWxsb2NVbnNhZmUgPSBmdW5jdGlvbiBhbGxvY1Vuc2FmZShzaXplKSB7CgkgIGlmICh0eXBlb2YgQnVmZmVyLmFsbG9jVW5zYWZlID09PSAnZnVuY3Rpb24nKSB7CgkgICAgcmV0dXJuIEJ1ZmZlci5hbGxvY1Vuc2FmZShzaXplKTsKCSAgfQoJICBpZiAodHlwZW9mIHNpemUgIT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignc2l6ZSBtdXN0IGJlIGEgbnVtYmVyJyk7CgkgIH0KCSAgaWYgKHNpemUgPiBNQVhfTEVOKSB7CgkgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NpemUgaXMgdG9vIGxhcmdlJyk7CgkgIH0KCSAgcmV0dXJuIG5ldyBCdWZmZXIoc2l6ZSk7Cgl9CglleHBvcnRzLmZyb20gPSBmdW5jdGlvbiBmcm9tKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHsKCSAgaWYgKHR5cGVvZiBCdWZmZXIuZnJvbSA9PT0gJ2Z1bmN0aW9uJyAmJiAoIWdsb2JhbC5VaW50OEFycmF5IHx8IFVpbnQ4QXJyYXkuZnJvbSAhPT0gQnVmZmVyLmZyb20pKSB7CgkgICAgcmV0dXJuIEJ1ZmZlci5mcm9tKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpOwoJICB9CgkgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignInZhbHVlIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpOwoJICB9CgkgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7CgkgICAgcmV0dXJuIG5ldyBCdWZmZXIodmFsdWUsIGVuY29kaW5nT3JPZmZzZXQpOwoJICB9CgkgIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIHZhbHVlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHsKCSAgICB2YXIgb2Zmc2V0ID0gZW5jb2RpbmdPck9mZnNldDsKCSAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkgewoJICAgICAgcmV0dXJuIG5ldyBCdWZmZXIodmFsdWUpOwoJICAgIH0KCSAgICBpZiAodHlwZW9mIG9mZnNldCA9PT0gJ3VuZGVmaW5lZCcpIHsKCSAgICAgIG9mZnNldCA9IDA7CgkgICAgfQoJICAgIHZhciBsZW4gPSBsZW5ndGg7CgkgICAgaWYgKHR5cGVvZiBsZW4gPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICBsZW4gPSB2YWx1ZS5ieXRlTGVuZ3RoIC0gb2Zmc2V0OwoJICAgIH0KCSAgICBpZiAob2Zmc2V0ID49IHZhbHVlLmJ5dGVMZW5ndGgpIHsKCSAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcJ29mZnNldFwnIGlzIG91dCBvZiBib3VuZHMnKTsKCSAgICB9CgkgICAgaWYgKGxlbiA+IHZhbHVlLmJ5dGVMZW5ndGggLSBvZmZzZXQpIHsKCSAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcJ2xlbmd0aFwnIGlzIG91dCBvZiBib3VuZHMnKTsKCSAgICB9CgkgICAgcmV0dXJuIG5ldyBCdWZmZXIodmFsdWUuc2xpY2Uob2Zmc2V0LCBvZmZzZXQgKyBsZW4pKTsKCSAgfQoJICBpZiAoQnVmZmVyLmlzQnVmZmVyKHZhbHVlKSkgewoJICAgIHZhciBvdXQgPSBuZXcgQnVmZmVyKHZhbHVlLmxlbmd0aCk7CgkgICAgdmFsdWUuY29weShvdXQsIDAsIDAsIHZhbHVlLmxlbmd0aCk7CgkgICAgcmV0dXJuIG91dDsKCSAgfQoJICBpZiAodmFsdWUpIHsKCSAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgfHwgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHx8ICdsZW5ndGgnIGluIHZhbHVlKSB7CgkgICAgICByZXR1cm4gbmV3IEJ1ZmZlcih2YWx1ZSk7CgkgICAgfQoJICAgIGlmICh2YWx1ZS50eXBlID09PSAnQnVmZmVyJyAmJiBBcnJheS5pc0FycmF5KHZhbHVlLmRhdGEpKSB7CgkgICAgICByZXR1cm4gbmV3IEJ1ZmZlcih2YWx1ZS5kYXRhKTsKCSAgICB9CgkgIH0KCgkgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgJyArICdBcnJheUJ1ZmZlciwgQXJyYXksIG9yIGFycmF5LWxpa2Ugb2JqZWN0LicpOwoJfQoJZXhwb3J0cy5hbGxvY1Vuc2FmZVNsb3cgPSBmdW5jdGlvbiBhbGxvY1Vuc2FmZVNsb3coc2l6ZSkgewoJICBpZiAodHlwZW9mIEJ1ZmZlci5hbGxvY1Vuc2FmZVNsb3cgPT09ICdmdW5jdGlvbicpIHsKCSAgICByZXR1cm4gQnVmZmVyLmFsbG9jVW5zYWZlU2xvdyhzaXplKTsKCSAgfQoJICBpZiAodHlwZW9mIHNpemUgIT09ICdudW1iZXInKSB7CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignc2l6ZSBtdXN0IGJlIGEgbnVtYmVyJyk7CgkgIH0KCSAgaWYgKHNpemUgPj0gTUFYX0xFTikgewoJICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdzaXplIGlzIHRvbyBsYXJnZScpOwoJICB9CgkgIHJldHVybiBuZXcgU2xvd0J1ZmZlcihzaXplKTsKCX0KCgkvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpCgovKioqLyB9LAovKiAyNyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBhIGR1cGxleCBzdHJlYW0gaXMganVzdCBhIHN0cmVhbSB0aGF0IGlzIGJvdGggcmVhZGFibGUgYW5kIHdyaXRhYmxlLgoJLy8gU2luY2UgSlMgZG9lc24ndCBoYXZlIG11bHRpcGxlIHByb3RvdHlwYWwgaW5oZXJpdGFuY2UsIHRoaXMgY2xhc3MKCS8vIHByb3RvdHlwYWxseSBpbmhlcml0cyBmcm9tIFJlYWRhYmxlLCBhbmQgdGhlbiBwYXJhc2l0aWNhbGx5IGZyb20KCS8vIFdyaXRhYmxlLgoKCSd1c2Ugc3RyaWN0JzsKCgkvKjxyZXBsYWNlbWVudD4qLwoKCXZhciBvYmplY3RLZXlzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24gKG9iaikgewoJICB2YXIga2V5cyA9IFtdOwoJICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CgkgICAga2V5cy5wdXNoKGtleSk7CgkgIH1yZXR1cm4ga2V5czsKCX07CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgltb2R1bGUuZXhwb3J0cyA9IER1cGxleDsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHByb2Nlc3NOZXh0VGljayA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cgl1dGlsLmluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl2YXIgUmVhZGFibGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KTsKCXZhciBXcml0YWJsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwoKCXV0aWwuaW5oZXJpdHMoRHVwbGV4LCBSZWFkYWJsZSk7CgoJdmFyIGtleXMgPSBvYmplY3RLZXlzKFdyaXRhYmxlLnByb3RvdHlwZSk7Cglmb3IgKHZhciB2ID0gMDsgdiA8IGtleXMubGVuZ3RoOyB2KyspIHsKCSAgdmFyIG1ldGhvZCA9IGtleXNbdl07CgkgIGlmICghRHVwbGV4LnByb3RvdHlwZVttZXRob2RdKSBEdXBsZXgucHJvdG90eXBlW21ldGhvZF0gPSBXcml0YWJsZS5wcm90b3R5cGVbbWV0aG9kXTsKCX0KCglmdW5jdGlvbiBEdXBsZXgob3B0aW9ucykgewoJICBpZiAoISh0aGlzIGluc3RhbmNlb2YgRHVwbGV4KSkgcmV0dXJuIG5ldyBEdXBsZXgob3B0aW9ucyk7CgoJICBSZWFkYWJsZS5jYWxsKHRoaXMsIG9wdGlvbnMpOwoJICBXcml0YWJsZS5jYWxsKHRoaXMsIG9wdGlvbnMpOwoKCSAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5yZWFkYWJsZSA9PT0gZmFsc2UpIHRoaXMucmVhZGFibGUgPSBmYWxzZTsKCgkgIGlmIChvcHRpb25zICYmIG9wdGlvbnMud3JpdGFibGUgPT09IGZhbHNlKSB0aGlzLndyaXRhYmxlID0gZmFsc2U7CgoJICB0aGlzLmFsbG93SGFsZk9wZW4gPSB0cnVlOwoJICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmFsbG93SGFsZk9wZW4gPT09IGZhbHNlKSB0aGlzLmFsbG93SGFsZk9wZW4gPSBmYWxzZTsKCgkgIHRoaXMub25jZSgnZW5kJywgb25lbmQpOwoJfQoKCS8vIHRoZSBuby1oYWxmLW9wZW4gZW5mb3JjZXIKCWZ1bmN0aW9uIG9uZW5kKCkgewoJICAvLyBpZiB3ZSBhbGxvdyBoYWxmLW9wZW4gc3RhdGUsIG9yIGlmIHRoZSB3cml0YWJsZSBzaWRlIGVuZGVkLAoJICAvLyB0aGVuIHdlJ3JlIG9rLgoJICBpZiAodGhpcy5hbGxvd0hhbGZPcGVuIHx8IHRoaXMuX3dyaXRhYmxlU3RhdGUuZW5kZWQpIHJldHVybjsKCgkgIC8vIG5vIG1vcmUgZGF0YSBjYW4gYmUgd3JpdHRlbi4KCSAgLy8gQnV0IGFsbG93IG1vcmUgd3JpdGVzIHRvIGhhcHBlbiBpbiB0aGlzIHRpY2suCgkgIHByb2Nlc3NOZXh0VGljayhvbkVuZE5ULCB0aGlzKTsKCX0KCglmdW5jdGlvbiBvbkVuZE5UKHNlbGYpIHsKCSAgc2VsZi5lbmQoKTsKCX0KCglmdW5jdGlvbiBmb3JFYWNoKHhzLCBmKSB7CgkgIGZvciAodmFyIGkgPSAwLCBsID0geHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgZih4c1tpXSwgaSk7CgkgIH0KCX0KCi8qKiovIH0sCi8qIDI4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihwcm9jZXNzKSB7J3VzZSBzdHJpY3QnOwoKCW1vZHVsZS5leHBvcnRzID0gUmVhZGFibGU7CgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBwcm9jZXNzTmV4dFRpY2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgaXNBcnJheSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciBEdXBsZXg7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCglSZWFkYWJsZS5SZWFkYWJsZVN0YXRlID0gUmVhZGFibGVTdGF0ZTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIEVFID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkuRXZlbnRFbWl0dGVyOwoKCXZhciBFRWxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbiAoZW1pdHRlciwgdHlwZSkgewoJICByZXR1cm4gZW1pdHRlci5saXN0ZW5lcnModHlwZSkubGVuZ3RoOwoJfTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgU3RyZWFtOwoJKGZ1bmN0aW9uICgpIHsKCSAgdHJ5IHsKCSAgICBTdHJlYW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCSAgfSBjYXRjaCAoXykge30gZmluYWxseSB7CgkgICAgaWYgKCFTdHJlYW0pIFN0cmVhbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpLkV2ZW50RW1pdHRlcjsKCSAgfQoJfSkoKTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXZhciBCdWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpLkJ1ZmZlcjsKCS8qPHJlcGxhY2VtZW50PiovCgl2YXIgYnVmZmVyU2hpbSA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpOwoJLyo8L3JlcGxhY2VtZW50PiovCgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cgl1dGlsLmluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIGRlYnVnVXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpOwoJdmFyIGRlYnVnID0gdm9pZCAwOwoJaWYgKGRlYnVnVXRpbCAmJiBkZWJ1Z1V0aWwuZGVidWdsb2cpIHsKCSAgZGVidWcgPSBkZWJ1Z1V0aWwuZGVidWdsb2coJ3N0cmVhbScpOwoJfSBlbHNlIHsKCSAgZGVidWcgPSBmdW5jdGlvbiAoKSB7fTsKCX0KCS8qPC9yZXBsYWNlbWVudD4qLwoKCXZhciBCdWZmZXJMaXN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCk7Cgl2YXIgU3RyaW5nRGVjb2RlcjsKCgl1dGlsLmluaGVyaXRzKFJlYWRhYmxlLCBTdHJlYW0pOwoKCWZ1bmN0aW9uIHByZXBlbmRMaXN0ZW5lcihlbWl0dGVyLCBldmVudCwgZm4pIHsKCSAgLy8gU2FkbHkgdGhpcyBpcyBub3QgY2FjaGVhYmxlIGFzIHNvbWUgbGlicmFyaWVzIGJ1bmRsZSB0aGVpciBvd24KCSAgLy8gZXZlbnQgZW1pdHRlciBpbXBsZW1lbnRhdGlvbiB3aXRoIHRoZW0uCgkgIGlmICh0eXBlb2YgZW1pdHRlci5wcmVwZW5kTGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHsKCSAgICByZXR1cm4gZW1pdHRlci5wcmVwZW5kTGlzdGVuZXIoZXZlbnQsIGZuKTsKCSAgfSBlbHNlIHsKCSAgICAvLyBUaGlzIGlzIGEgaGFjayB0byBtYWtlIHN1cmUgdGhhdCBvdXIgZXJyb3IgaGFuZGxlciBpcyBhdHRhY2hlZCBiZWZvcmUgYW55CgkgICAgLy8gdXNlcmxhbmQgb25lcy4gIE5FVkVSIERPIFRISVMuIFRoaXMgaXMgaGVyZSBvbmx5IGJlY2F1c2UgdGhpcyBjb2RlIG5lZWRzCgkgICAgLy8gdG8gY29udGludWUgdG8gd29yayB3aXRoIG9sZGVyIHZlcnNpb25zIG9mIE5vZGUuanMgdGhhdCBkbyBub3QgaW5jbHVkZQoJICAgIC8vIHRoZSBwcmVwZW5kTGlzdGVuZXIoKSBtZXRob2QuIFRoZSBnb2FsIGlzIHRvIGV2ZW50dWFsbHkgcmVtb3ZlIHRoaXMgaGFjay4KCSAgICBpZiAoIWVtaXR0ZXIuX2V2ZW50cyB8fCAhZW1pdHRlci5fZXZlbnRzW2V2ZW50XSkgZW1pdHRlci5vbihldmVudCwgZm4pO2Vsc2UgaWYgKGlzQXJyYXkoZW1pdHRlci5fZXZlbnRzW2V2ZW50XSkpIGVtaXR0ZXIuX2V2ZW50c1tldmVudF0udW5zaGlmdChmbik7ZWxzZSBlbWl0dGVyLl9ldmVudHNbZXZlbnRdID0gW2ZuLCBlbWl0dGVyLl9ldmVudHNbZXZlbnRdXTsKCSAgfQoJfQoKCWZ1bmN0aW9uIFJlYWRhYmxlU3RhdGUob3B0aW9ucywgc3RyZWFtKSB7CgkgIER1cGxleCA9IER1cGxleCB8fCBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTsKCgkgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKCSAgLy8gb2JqZWN0IHN0cmVhbSBmbGFnLiBVc2VkIHRvIG1ha2UgcmVhZChuKSBpZ25vcmUgbiBhbmQgdG8KCSAgLy8gbWFrZSBhbGwgdGhlIGJ1ZmZlciBtZXJnaW5nIGFuZCBsZW5ndGggY2hlY2tzIGdvIGF3YXkKCSAgdGhpcy5vYmplY3RNb2RlID0gISFvcHRpb25zLm9iamVjdE1vZGU7CgoJICBpZiAoc3RyZWFtIGluc3RhbmNlb2YgRHVwbGV4KSB0aGlzLm9iamVjdE1vZGUgPSB0aGlzLm9iamVjdE1vZGUgfHwgISFvcHRpb25zLnJlYWRhYmxlT2JqZWN0TW9kZTsKCgkgIC8vIHRoZSBwb2ludCBhdCB3aGljaCBpdCBzdG9wcyBjYWxsaW5nIF9yZWFkKCkgdG8gZmlsbCB0aGUgYnVmZmVyCgkgIC8vIE5vdGU6IDAgaXMgYSB2YWxpZCB2YWx1ZSwgbWVhbnMgImRvbid0IGNhbGwgX3JlYWQgcHJlZW1wdGl2ZWx5IGV2ZXIiCgkgIHZhciBod20gPSBvcHRpb25zLmhpZ2hXYXRlck1hcms7CgkgIHZhciBkZWZhdWx0SHdtID0gdGhpcy5vYmplY3RNb2RlID8gMTYgOiAxNiAqIDEwMjQ7CgkgIHRoaXMuaGlnaFdhdGVyTWFyayA9IGh3bSB8fCBod20gPT09IDAgPyBod20gOiBkZWZhdWx0SHdtOwoKCSAgLy8gY2FzdCB0byBpbnRzLgoJICB0aGlzLmhpZ2hXYXRlck1hcmsgPSB+IH50aGlzLmhpZ2hXYXRlck1hcms7CgoJICAvLyBBIGxpbmtlZCBsaXN0IGlzIHVzZWQgdG8gc3RvcmUgZGF0YSBjaHVua3MgaW5zdGVhZCBvZiBhbiBhcnJheSBiZWNhdXNlIHRoZQoJICAvLyBsaW5rZWQgbGlzdCBjYW4gcmVtb3ZlIGVsZW1lbnRzIGZyb20gdGhlIGJlZ2lubmluZyBmYXN0ZXIgdGhhbgoJICAvLyBhcnJheS5zaGlmdCgpCgkgIHRoaXMuYnVmZmVyID0gbmV3IEJ1ZmZlckxpc3QoKTsKCSAgdGhpcy5sZW5ndGggPSAwOwoJICB0aGlzLnBpcGVzID0gbnVsbDsKCSAgdGhpcy5waXBlc0NvdW50ID0gMDsKCSAgdGhpcy5mbG93aW5nID0gbnVsbDsKCSAgdGhpcy5lbmRlZCA9IGZhbHNlOwoJICB0aGlzLmVuZEVtaXR0ZWQgPSBmYWxzZTsKCSAgdGhpcy5yZWFkaW5nID0gZmFsc2U7CgoJICAvLyBhIGZsYWcgdG8gYmUgYWJsZSB0byB0ZWxsIGlmIHRoZSBvbndyaXRlIGNiIGlzIGNhbGxlZCBpbW1lZGlhdGVseSwKCSAgLy8gb3Igb24gYSBsYXRlciB0aWNrLiAgV2Ugc2V0IHRoaXMgdG8gdHJ1ZSBhdCBmaXJzdCwgYmVjYXVzZSBhbnkKCSAgLy8gYWN0aW9ucyB0aGF0IHNob3VsZG4ndCBoYXBwZW4gdW50aWwgImxhdGVyIiBzaG91bGQgZ2VuZXJhbGx5IGFsc28KCSAgLy8gbm90IGhhcHBlbiBiZWZvcmUgdGhlIGZpcnN0IHdyaXRlIGNhbGwuCgkgIHRoaXMuc3luYyA9IHRydWU7CgoJICAvLyB3aGVuZXZlciB3ZSByZXR1cm4gbnVsbCwgdGhlbiB3ZSBzZXQgYSBmbGFnIHRvIHNheQoJICAvLyB0aGF0IHdlJ3JlIGF3YWl0aW5nIGEgJ3JlYWRhYmxlJyBldmVudCBlbWlzc2lvbi4KCSAgdGhpcy5uZWVkUmVhZGFibGUgPSBmYWxzZTsKCSAgdGhpcy5lbWl0dGVkUmVhZGFibGUgPSBmYWxzZTsKCSAgdGhpcy5yZWFkYWJsZUxpc3RlbmluZyA9IGZhbHNlOwoJICB0aGlzLnJlc3VtZVNjaGVkdWxlZCA9IGZhbHNlOwoKCSAgLy8gQ3J5cHRvIGlzIGtpbmQgb2Ygb2xkIGFuZCBjcnVzdHkuICBIaXN0b3JpY2FsbHksIGl0cyBkZWZhdWx0IHN0cmluZwoJICAvLyBlbmNvZGluZyBpcyAnYmluYXJ5JyBzbyB3ZSBoYXZlIHRvIG1ha2UgdGhpcyBjb25maWd1cmFibGUuCgkgIC8vIEV2ZXJ5dGhpbmcgZWxzZSBpbiB0aGUgdW5pdmVyc2UgdXNlcyAndXRmOCcsIHRob3VnaC4KCSAgdGhpcy5kZWZhdWx0RW5jb2RpbmcgPSBvcHRpb25zLmRlZmF1bHRFbmNvZGluZyB8fCAndXRmOCc7CgoJICAvLyB3aGVuIHBpcGluZywgd2Ugb25seSBjYXJlIGFib3V0ICdyZWFkYWJsZScgZXZlbnRzIHRoYXQgaGFwcGVuCgkgIC8vIGFmdGVyIHJlYWQoKWluZyBhbGwgdGhlIGJ5dGVzIGFuZCBub3QgZ2V0dGluZyBhbnkgcHVzaGJhY2suCgkgIHRoaXMucmFuT3V0ID0gZmFsc2U7CgoJICAvLyB0aGUgbnVtYmVyIG9mIHdyaXRlcnMgdGhhdCBhcmUgYXdhaXRpbmcgYSBkcmFpbiBldmVudCBpbiAucGlwZSgpcwoJICB0aGlzLmF3YWl0RHJhaW4gPSAwOwoKCSAgLy8gaWYgdHJ1ZSwgYSBtYXliZVJlYWRNb3JlIGhhcyBiZWVuIHNjaGVkdWxlZAoJICB0aGlzLnJlYWRpbmdNb3JlID0gZmFsc2U7CgoJICB0aGlzLmRlY29kZXIgPSBudWxsOwoJICB0aGlzLmVuY29kaW5nID0gbnVsbDsKCSAgaWYgKG9wdGlvbnMuZW5jb2RpbmcpIHsKCSAgICBpZiAoIVN0cmluZ0RlY29kZXIpIFN0cmluZ0RlY29kZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKS5TdHJpbmdEZWNvZGVyOwoJICAgIHRoaXMuZGVjb2RlciA9IG5ldyBTdHJpbmdEZWNvZGVyKG9wdGlvbnMuZW5jb2RpbmcpOwoJICAgIHRoaXMuZW5jb2RpbmcgPSBvcHRpb25zLmVuY29kaW5nOwoJICB9Cgl9CgoJZnVuY3Rpb24gUmVhZGFibGUob3B0aW9ucykgewoJICBEdXBsZXggPSBEdXBsZXggfHwgX193ZWJwYWNrX3JlcXVpcmVfXygyNyk7CgoJICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUmVhZGFibGUpKSByZXR1cm4gbmV3IFJlYWRhYmxlKG9wdGlvbnMpOwoKCSAgdGhpcy5fcmVhZGFibGVTdGF0ZSA9IG5ldyBSZWFkYWJsZVN0YXRlKG9wdGlvbnMsIHRoaXMpOwoKCSAgLy8gbGVnYWN5CgkgIHRoaXMucmVhZGFibGUgPSB0cnVlOwoKCSAgaWYgKG9wdGlvbnMgJiYgdHlwZW9mIG9wdGlvbnMucmVhZCA9PT0gJ2Z1bmN0aW9uJykgdGhpcy5fcmVhZCA9IG9wdGlvbnMucmVhZDsKCgkgIFN0cmVhbS5jYWxsKHRoaXMpOwoJfQoKCS8vIE1hbnVhbGx5IHNob3ZlIHNvbWV0aGluZyBpbnRvIHRoZSByZWFkKCkgYnVmZmVyLgoJLy8gVGhpcyByZXR1cm5zIHRydWUgaWYgdGhlIGhpZ2hXYXRlck1hcmsgaGFzIG5vdCBiZWVuIGhpdCB5ZXQsCgkvLyBzaW1pbGFyIHRvIGhvdyBXcml0YWJsZS53cml0ZSgpIHJldHVybnMgdHJ1ZSBpZiB5b3Ugc2hvdWxkCgkvLyB3cml0ZSgpIHNvbWUgbW9yZS4KCVJlYWRhYmxlLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKGNodW5rLCBlbmNvZGluZykgewoJICB2YXIgc3RhdGUgPSB0aGlzLl9yZWFkYWJsZVN0YXRlOwoKCSAgaWYgKCFzdGF0ZS5vYmplY3RNb2RlICYmIHR5cGVvZiBjaHVuayA9PT0gJ3N0cmluZycpIHsKCSAgICBlbmNvZGluZyA9IGVuY29kaW5nIHx8IHN0YXRlLmRlZmF1bHRFbmNvZGluZzsKCSAgICBpZiAoZW5jb2RpbmcgIT09IHN0YXRlLmVuY29kaW5nKSB7CgkgICAgICBjaHVuayA9IGJ1ZmZlclNoaW0uZnJvbShjaHVuaywgZW5jb2RpbmcpOwoJICAgICAgZW5jb2RpbmcgPSAnJzsKCSAgICB9CgkgIH0KCgkgIHJldHVybiByZWFkYWJsZUFkZENodW5rKHRoaXMsIHN0YXRlLCBjaHVuaywgZW5jb2RpbmcsIGZhbHNlKTsKCX07CgoJLy8gVW5zaGlmdCBzaG91bGQgKmFsd2F5cyogYmUgc29tZXRoaW5nIGRpcmVjdGx5IG91dCBvZiByZWFkKCkKCVJlYWRhYmxlLnByb3RvdHlwZS51bnNoaWZ0ID0gZnVuY3Rpb24gKGNodW5rKSB7CgkgIHZhciBzdGF0ZSA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgkgIHJldHVybiByZWFkYWJsZUFkZENodW5rKHRoaXMsIHN0YXRlLCBjaHVuaywgJycsIHRydWUpOwoJfTsKCglSZWFkYWJsZS5wcm90b3R5cGUuaXNQYXVzZWQgPSBmdW5jdGlvbiAoKSB7CgkgIHJldHVybiB0aGlzLl9yZWFkYWJsZVN0YXRlLmZsb3dpbmcgPT09IGZhbHNlOwoJfTsKCglmdW5jdGlvbiByZWFkYWJsZUFkZENodW5rKHN0cmVhbSwgc3RhdGUsIGNodW5rLCBlbmNvZGluZywgYWRkVG9Gcm9udCkgewoJICB2YXIgZXIgPSBjaHVua0ludmFsaWQoc3RhdGUsIGNodW5rKTsKCSAgaWYgKGVyKSB7CgkgICAgc3RyZWFtLmVtaXQoJ2Vycm9yJywgZXIpOwoJICB9IGVsc2UgaWYgKGNodW5rID09PSBudWxsKSB7CgkgICAgc3RhdGUucmVhZGluZyA9IGZhbHNlOwoJICAgIG9uRW9mQ2h1bmsoc3RyZWFtLCBzdGF0ZSk7CgkgIH0gZWxzZSBpZiAoc3RhdGUub2JqZWN0TW9kZSB8fCBjaHVuayAmJiBjaHVuay5sZW5ndGggPiAwKSB7CgkgICAgaWYgKHN0YXRlLmVuZGVkICYmICFhZGRUb0Zyb250KSB7CgkgICAgICB2YXIgZSA9IG5ldyBFcnJvcignc3RyZWFtLnB1c2goKSBhZnRlciBFT0YnKTsKCSAgICAgIHN0cmVhbS5lbWl0KCdlcnJvcicsIGUpOwoJICAgIH0gZWxzZSBpZiAoc3RhdGUuZW5kRW1pdHRlZCAmJiBhZGRUb0Zyb250KSB7CgkgICAgICB2YXIgX2UgPSBuZXcgRXJyb3IoJ3N0cmVhbS51bnNoaWZ0KCkgYWZ0ZXIgZW5kIGV2ZW50Jyk7CgkgICAgICBzdHJlYW0uZW1pdCgnZXJyb3InLCBfZSk7CgkgICAgfSBlbHNlIHsKCSAgICAgIHZhciBza2lwQWRkOwoJICAgICAgaWYgKHN0YXRlLmRlY29kZXIgJiYgIWFkZFRvRnJvbnQgJiYgIWVuY29kaW5nKSB7CgkgICAgICAgIGNodW5rID0gc3RhdGUuZGVjb2Rlci53cml0ZShjaHVuayk7CgkgICAgICAgIHNraXBBZGQgPSAhc3RhdGUub2JqZWN0TW9kZSAmJiBjaHVuay5sZW5ndGggPT09IDA7CgkgICAgICB9CgoJICAgICAgaWYgKCFhZGRUb0Zyb250KSBzdGF0ZS5yZWFkaW5nID0gZmFsc2U7CgoJICAgICAgLy8gRG9uJ3QgYWRkIHRvIHRoZSBidWZmZXIgaWYgd2UndmUgZGVjb2RlZCB0byBhbiBlbXB0eSBzdHJpbmcgY2h1bmsgYW5kCgkgICAgICAvLyB3ZSdyZSBub3QgaW4gb2JqZWN0IG1vZGUKCSAgICAgIGlmICghc2tpcEFkZCkgewoJICAgICAgICAvLyBpZiB3ZSB3YW50IHRoZSBkYXRhIG5vdywganVzdCBlbWl0IGl0LgoJICAgICAgICBpZiAoc3RhdGUuZmxvd2luZyAmJiBzdGF0ZS5sZW5ndGggPT09IDAgJiYgIXN0YXRlLnN5bmMpIHsKCSAgICAgICAgICBzdHJlYW0uZW1pdCgnZGF0YScsIGNodW5rKTsKCSAgICAgICAgICBzdHJlYW0ucmVhZCgwKTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAvLyB1cGRhdGUgdGhlIGJ1ZmZlciBpbmZvLgoJICAgICAgICAgIHN0YXRlLmxlbmd0aCArPSBzdGF0ZS5vYmplY3RNb2RlID8gMSA6IGNodW5rLmxlbmd0aDsKCSAgICAgICAgICBpZiAoYWRkVG9Gcm9udCkgc3RhdGUuYnVmZmVyLnVuc2hpZnQoY2h1bmspO2Vsc2Ugc3RhdGUuYnVmZmVyLnB1c2goY2h1bmspOwoKCSAgICAgICAgICBpZiAoc3RhdGUubmVlZFJlYWRhYmxlKSBlbWl0UmVhZGFibGUoc3RyZWFtKTsKCSAgICAgICAgfQoJICAgICAgfQoKCSAgICAgIG1heWJlUmVhZE1vcmUoc3RyZWFtLCBzdGF0ZSk7CgkgICAgfQoJICB9IGVsc2UgaWYgKCFhZGRUb0Zyb250KSB7CgkgICAgc3RhdGUucmVhZGluZyA9IGZhbHNlOwoJICB9CgoJICByZXR1cm4gbmVlZE1vcmVEYXRhKHN0YXRlKTsKCX0KCgkvLyBpZiBpdCdzIHBhc3QgdGhlIGhpZ2ggd2F0ZXIgbWFyaywgd2UgY2FuIHB1c2ggaW4gc29tZSBtb3JlLgoJLy8gQWxzbywgaWYgd2UgaGF2ZSBubyBkYXRhIHlldCwgd2UgY2FuIHN0YW5kIHNvbWUKCS8vIG1vcmUgYnl0ZXMuICBUaGlzIGlzIHRvIHdvcmsgYXJvdW5kIGNhc2VzIHdoZXJlIGh3bT0wLAoJLy8gc3VjaCBhcyB0aGUgcmVwbC4gIEFsc28sIGlmIHRoZSBwdXNoKCkgdHJpZ2dlcmVkIGEKCS8vIHJlYWRhYmxlIGV2ZW50LCBhbmQgdGhlIHVzZXIgY2FsbGVkIHJlYWQobGFyZ2VOdW1iZXIpIHN1Y2ggdGhhdAoJLy8gbmVlZFJlYWRhYmxlIHdhcyBzZXQsIHRoZW4gd2Ugb3VnaHQgdG8gcHVzaCBtb3JlLCBzbyB0aGF0IGFub3RoZXIKCS8vICdyZWFkYWJsZScgZXZlbnQgd2lsbCBiZSB0cmlnZ2VyZWQuCglmdW5jdGlvbiBuZWVkTW9yZURhdGEoc3RhdGUpIHsKCSAgcmV0dXJuICFzdGF0ZS5lbmRlZCAmJiAoc3RhdGUubmVlZFJlYWRhYmxlIHx8IHN0YXRlLmxlbmd0aCA8IHN0YXRlLmhpZ2hXYXRlck1hcmsgfHwgc3RhdGUubGVuZ3RoID09PSAwKTsKCX0KCgkvLyBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eS4KCVJlYWRhYmxlLnByb3RvdHlwZS5zZXRFbmNvZGluZyA9IGZ1bmN0aW9uIChlbmMpIHsKCSAgaWYgKCFTdHJpbmdEZWNvZGVyKSBTdHJpbmdEZWNvZGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMSkuU3RyaW5nRGVjb2RlcjsKCSAgdGhpcy5fcmVhZGFibGVTdGF0ZS5kZWNvZGVyID0gbmV3IFN0cmluZ0RlY29kZXIoZW5jKTsKCSAgdGhpcy5fcmVhZGFibGVTdGF0ZS5lbmNvZGluZyA9IGVuYzsKCSAgcmV0dXJuIHRoaXM7Cgl9OwoKCS8vIERvbid0IHJhaXNlIHRoZSBod20gPiA4TUIKCXZhciBNQVhfSFdNID0gMHg4MDAwMDA7CglmdW5jdGlvbiBjb21wdXRlTmV3SGlnaFdhdGVyTWFyayhuKSB7CgkgIGlmIChuID49IE1BWF9IV00pIHsKCSAgICBuID0gTUFYX0hXTTsKCSAgfSBlbHNlIHsKCSAgICAvLyBHZXQgdGhlIG5leHQgaGlnaGVzdCBwb3dlciBvZiAyIHRvIHByZXZlbnQgaW5jcmVhc2luZyBod20gZXhjZXNzaXZlbHkgaW4KCSAgICAvLyB0aW55IGFtb3VudHMKCSAgICBuLS07CgkgICAgbiB8PSBuID4+PiAxOwoJICAgIG4gfD0gbiA+Pj4gMjsKCSAgICBuIHw9IG4gPj4+IDQ7CgkgICAgbiB8PSBuID4+PiA4OwoJICAgIG4gfD0gbiA+Pj4gMTY7CgkgICAgbisrOwoJICB9CgkgIHJldHVybiBuOwoJfQoKCS8vIFRoaXMgZnVuY3Rpb24gaXMgZGVzaWduZWQgdG8gYmUgaW5saW5hYmxlLCBzbyBwbGVhc2UgdGFrZSBjYXJlIHdoZW4gbWFraW5nCgkvLyBjaGFuZ2VzIHRvIHRoZSBmdW5jdGlvbiBib2R5LgoJZnVuY3Rpb24gaG93TXVjaFRvUmVhZChuLCBzdGF0ZSkgewoJICBpZiAobiA8PSAwIHx8IHN0YXRlLmxlbmd0aCA9PT0gMCAmJiBzdGF0ZS5lbmRlZCkgcmV0dXJuIDA7CgkgIGlmIChzdGF0ZS5vYmplY3RNb2RlKSByZXR1cm4gMTsKCSAgaWYgKG4gIT09IG4pIHsKCSAgICAvLyBPbmx5IGZsb3cgb25lIGJ1ZmZlciBhdCBhIHRpbWUKCSAgICBpZiAoc3RhdGUuZmxvd2luZyAmJiBzdGF0ZS5sZW5ndGgpIHJldHVybiBzdGF0ZS5idWZmZXIuaGVhZC5kYXRhLmxlbmd0aDtlbHNlIHJldHVybiBzdGF0ZS5sZW5ndGg7CgkgIH0KCSAgLy8gSWYgd2UncmUgYXNraW5nIGZvciBtb3JlIHRoYW4gdGhlIGN1cnJlbnQgaHdtLCB0aGVuIHJhaXNlIHRoZSBod20uCgkgIGlmIChuID4gc3RhdGUuaGlnaFdhdGVyTWFyaykgc3RhdGUuaGlnaFdhdGVyTWFyayA9IGNvbXB1dGVOZXdIaWdoV2F0ZXJNYXJrKG4pOwoJICBpZiAobiA8PSBzdGF0ZS5sZW5ndGgpIHJldHVybiBuOwoJICAvLyBEb24ndCBoYXZlIGVub3VnaAoJICBpZiAoIXN0YXRlLmVuZGVkKSB7CgkgICAgc3RhdGUubmVlZFJlYWRhYmxlID0gdHJ1ZTsKCSAgICByZXR1cm4gMDsKCSAgfQoJICByZXR1cm4gc3RhdGUubGVuZ3RoOwoJfQoKCS8vIHlvdSBjYW4gb3ZlcnJpZGUgZWl0aGVyIHRoaXMgbWV0aG9kLCBvciB0aGUgYXN5bmMgX3JlYWQobikgYmVsb3cuCglSZWFkYWJsZS5wcm90b3R5cGUucmVhZCA9IGZ1bmN0aW9uIChuKSB7CgkgIGRlYnVnKCdyZWFkJywgbik7CgkgIG4gPSBwYXJzZUludChuLCAxMCk7CgkgIHZhciBzdGF0ZSA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgkgIHZhciBuT3JpZyA9IG47CgoJICBpZiAobiAhPT0gMCkgc3RhdGUuZW1pdHRlZFJlYWRhYmxlID0gZmFsc2U7CgoJICAvLyBpZiB3ZSdyZSBkb2luZyByZWFkKDApIHRvIHRyaWdnZXIgYSByZWFkYWJsZSBldmVudCwgYnV0IHdlCgkgIC8vIGFscmVhZHkgaGF2ZSBhIGJ1bmNoIG9mIGRhdGEgaW4gdGhlIGJ1ZmZlciwgdGhlbiBqdXN0IHRyaWdnZXIKCSAgLy8gdGhlICdyZWFkYWJsZScgZXZlbnQgYW5kIG1vdmUgb24uCgkgIGlmIChuID09PSAwICYmIHN0YXRlLm5lZWRSZWFkYWJsZSAmJiAoc3RhdGUubGVuZ3RoID49IHN0YXRlLmhpZ2hXYXRlck1hcmsgfHwgc3RhdGUuZW5kZWQpKSB7CgkgICAgZGVidWcoJ3JlYWQ6IGVtaXRSZWFkYWJsZScsIHN0YXRlLmxlbmd0aCwgc3RhdGUuZW5kZWQpOwoJICAgIGlmIChzdGF0ZS5sZW5ndGggPT09IDAgJiYgc3RhdGUuZW5kZWQpIGVuZFJlYWRhYmxlKHRoaXMpO2Vsc2UgZW1pdFJlYWRhYmxlKHRoaXMpOwoJICAgIHJldHVybiBudWxsOwoJICB9CgoJICBuID0gaG93TXVjaFRvUmVhZChuLCBzdGF0ZSk7CgoJICAvLyBpZiB3ZSd2ZSBlbmRlZCwgYW5kIHdlJ3JlIG5vdyBjbGVhciwgdGhlbiBmaW5pc2ggaXQgdXAuCgkgIGlmIChuID09PSAwICYmIHN0YXRlLmVuZGVkKSB7CgkgICAgaWYgKHN0YXRlLmxlbmd0aCA9PT0gMCkgZW5kUmVhZGFibGUodGhpcyk7CgkgICAgcmV0dXJuIG51bGw7CgkgIH0KCgkgIC8vIEFsbCB0aGUgYWN0dWFsIGNodW5rIGdlbmVyYXRpb24gbG9naWMgbmVlZHMgdG8gYmUKCSAgLy8gKmJlbG93KiB0aGUgY2FsbCB0byBfcmVhZC4gIFRoZSByZWFzb24gaXMgdGhhdCBpbiBjZXJ0YWluCgkgIC8vIHN5bnRoZXRpYyBzdHJlYW0gY2FzZXMsIHN1Y2ggYXMgcGFzc3Rocm91Z2ggc3RyZWFtcywgX3JlYWQKCSAgLy8gbWF5IGJlIGEgY29tcGxldGVseSBzeW5jaHJvbm91cyBvcGVyYXRpb24gd2hpY2ggbWF5IGNoYW5nZQoJICAvLyB0aGUgc3RhdGUgb2YgdGhlIHJlYWQgYnVmZmVyLCBwcm92aWRpbmcgZW5vdWdoIGRhdGEgd2hlbgoJICAvLyBiZWZvcmUgdGhlcmUgd2FzICpub3QqIGVub3VnaC4KCSAgLy8KCSAgLy8gU28sIHRoZSBzdGVwcyBhcmU6CgkgIC8vIDEuIEZpZ3VyZSBvdXQgd2hhdCB0aGUgc3RhdGUgb2YgdGhpbmdzIHdpbGwgYmUgYWZ0ZXIgd2UgZG8KCSAgLy8gYSByZWFkIGZyb20gdGhlIGJ1ZmZlci4KCSAgLy8KCSAgLy8gMi4gSWYgdGhhdCByZXN1bHRpbmcgc3RhdGUgd2lsbCB0cmlnZ2VyIGEgX3JlYWQsIHRoZW4gY2FsbCBfcmVhZC4KCSAgLy8gTm90ZSB0aGF0IHRoaXMgbWF5IGJlIGFzeW5jaHJvbm91cywgb3Igc3luY2hyb25vdXMuICBZZXMsIGl0IGlzCgkgIC8vIGRlZXBseSB1Z2x5IHRvIHdyaXRlIEFQSXMgdGhpcyB3YXksIGJ1dCB0aGF0IHN0aWxsIGRvZXNuJ3QgbWVhbgoJICAvLyB0aGF0IHRoZSBSZWFkYWJsZSBjbGFzcyBzaG91bGQgYmVoYXZlIGltcHJvcGVybHksIGFzIHN0cmVhbXMgYXJlCgkgIC8vIGRlc2lnbmVkIHRvIGJlIHN5bmMvYXN5bmMgYWdub3N0aWMuCgkgIC8vIFRha2Ugbm90ZSBpZiB0aGUgX3JlYWQgY2FsbCBpcyBzeW5jIG9yIGFzeW5jIChpZSwgaWYgdGhlIHJlYWQgY2FsbAoJICAvLyBoYXMgcmV0dXJuZWQgeWV0KSwgc28gdGhhdCB3ZSBrbm93IHdoZXRoZXIgb3Igbm90IGl0J3Mgc2FmZSB0byBlbWl0CgkgIC8vICdyZWFkYWJsZScgZXRjLgoJICAvLwoJICAvLyAzLiBBY3R1YWxseSBwdWxsIHRoZSByZXF1ZXN0ZWQgY2h1bmtzIG91dCBvZiB0aGUgYnVmZmVyIGFuZCByZXR1cm4uCgoJICAvLyBpZiB3ZSBuZWVkIGEgcmVhZGFibGUgZXZlbnQsIHRoZW4gd2UgbmVlZCB0byBkbyBzb21lIHJlYWRpbmcuCgkgIHZhciBkb1JlYWQgPSBzdGF0ZS5uZWVkUmVhZGFibGU7CgkgIGRlYnVnKCduZWVkIHJlYWRhYmxlJywgZG9SZWFkKTsKCgkgIC8vIGlmIHdlIGN1cnJlbnRseSBoYXZlIGxlc3MgdGhhbiB0aGUgaGlnaFdhdGVyTWFyaywgdGhlbiBhbHNvIHJlYWQgc29tZQoJICBpZiAoc3RhdGUubGVuZ3RoID09PSAwIHx8IHN0YXRlLmxlbmd0aCAtIG4gPCBzdGF0ZS5oaWdoV2F0ZXJNYXJrKSB7CgkgICAgZG9SZWFkID0gdHJ1ZTsKCSAgICBkZWJ1ZygnbGVuZ3RoIGxlc3MgdGhhbiB3YXRlcm1hcmsnLCBkb1JlYWQpOwoJICB9CgoJICAvLyBob3dldmVyLCBpZiB3ZSd2ZSBlbmRlZCwgdGhlbiB0aGVyZSdzIG5vIHBvaW50LCBhbmQgaWYgd2UncmUgYWxyZWFkeQoJICAvLyByZWFkaW5nLCB0aGVuIGl0J3MgdW5uZWNlc3NhcnkuCgkgIGlmIChzdGF0ZS5lbmRlZCB8fCBzdGF0ZS5yZWFkaW5nKSB7CgkgICAgZG9SZWFkID0gZmFsc2U7CgkgICAgZGVidWcoJ3JlYWRpbmcgb3IgZW5kZWQnLCBkb1JlYWQpOwoJICB9IGVsc2UgaWYgKGRvUmVhZCkgewoJICAgIGRlYnVnKCdkbyByZWFkJyk7CgkgICAgc3RhdGUucmVhZGluZyA9IHRydWU7CgkgICAgc3RhdGUuc3luYyA9IHRydWU7CgkgICAgLy8gaWYgdGhlIGxlbmd0aCBpcyBjdXJyZW50bHkgemVybywgdGhlbiB3ZSAqbmVlZCogYSByZWFkYWJsZSBldmVudC4KCSAgICBpZiAoc3RhdGUubGVuZ3RoID09PSAwKSBzdGF0ZS5uZWVkUmVhZGFibGUgPSB0cnVlOwoJICAgIC8vIGNhbGwgaW50ZXJuYWwgcmVhZCBtZXRob2QKCSAgICB0aGlzLl9yZWFkKHN0YXRlLmhpZ2hXYXRlck1hcmspOwoJICAgIHN0YXRlLnN5bmMgPSBmYWxzZTsKCSAgICAvLyBJZiBfcmVhZCBwdXNoZWQgZGF0YSBzeW5jaHJvbm91c2x5LCB0aGVuIGByZWFkaW5nYCB3aWxsIGJlIGZhbHNlLAoJICAgIC8vIGFuZCB3ZSBuZWVkIHRvIHJlLWV2YWx1YXRlIGhvdyBtdWNoIGRhdGEgd2UgY2FuIHJldHVybiB0byB0aGUgdXNlci4KCSAgICBpZiAoIXN0YXRlLnJlYWRpbmcpIG4gPSBob3dNdWNoVG9SZWFkKG5PcmlnLCBzdGF0ZSk7CgkgIH0KCgkgIHZhciByZXQ7CgkgIGlmIChuID4gMCkgcmV0ID0gZnJvbUxpc3Qobiwgc3RhdGUpO2Vsc2UgcmV0ID0gbnVsbDsKCgkgIGlmIChyZXQgPT09IG51bGwpIHsKCSAgICBzdGF0ZS5uZWVkUmVhZGFibGUgPSB0cnVlOwoJICAgIG4gPSAwOwoJICB9IGVsc2UgewoJICAgIHN0YXRlLmxlbmd0aCAtPSBuOwoJICB9CgoJICBpZiAoc3RhdGUubGVuZ3RoID09PSAwKSB7CgkgICAgLy8gSWYgd2UgaGF2ZSBub3RoaW5nIGluIHRoZSBidWZmZXIsIHRoZW4gd2Ugd2FudCB0byBrbm93CgkgICAgLy8gYXMgc29vbiBhcyB3ZSAqZG8qIGdldCBzb21ldGhpbmcgaW50byB0aGUgYnVmZmVyLgoJICAgIGlmICghc3RhdGUuZW5kZWQpIHN0YXRlLm5lZWRSZWFkYWJsZSA9IHRydWU7CgoJICAgIC8vIElmIHdlIHRyaWVkIHRvIHJlYWQoKSBwYXN0IHRoZSBFT0YsIHRoZW4gZW1pdCBlbmQgb24gdGhlIG5leHQgdGljay4KCSAgICBpZiAobk9yaWcgIT09IG4gJiYgc3RhdGUuZW5kZWQpIGVuZFJlYWRhYmxlKHRoaXMpOwoJICB9CgoJICBpZiAocmV0ICE9PSBudWxsKSB0aGlzLmVtaXQoJ2RhdGEnLCByZXQpOwoKCSAgcmV0dXJuIHJldDsKCX07CgoJZnVuY3Rpb24gY2h1bmtJbnZhbGlkKHN0YXRlLCBjaHVuaykgewoJICB2YXIgZXIgPSBudWxsOwoJICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihjaHVuaykgJiYgdHlwZW9mIGNodW5rICE9PSAnc3RyaW5nJyAmJiBjaHVuayAhPT0gbnVsbCAmJiBjaHVuayAhPT0gdW5kZWZpbmVkICYmICFzdGF0ZS5vYmplY3RNb2RlKSB7CgkgICAgZXIgPSBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIG5vbi1zdHJpbmcvYnVmZmVyIGNodW5rJyk7CgkgIH0KCSAgcmV0dXJuIGVyOwoJfQoKCWZ1bmN0aW9uIG9uRW9mQ2h1bmsoc3RyZWFtLCBzdGF0ZSkgewoJICBpZiAoc3RhdGUuZW5kZWQpIHJldHVybjsKCSAgaWYgKHN0YXRlLmRlY29kZXIpIHsKCSAgICB2YXIgY2h1bmsgPSBzdGF0ZS5kZWNvZGVyLmVuZCgpOwoJICAgIGlmIChjaHVuayAmJiBjaHVuay5sZW5ndGgpIHsKCSAgICAgIHN0YXRlLmJ1ZmZlci5wdXNoKGNodW5rKTsKCSAgICAgIHN0YXRlLmxlbmd0aCArPSBzdGF0ZS5vYmplY3RNb2RlID8gMSA6IGNodW5rLmxlbmd0aDsKCSAgICB9CgkgIH0KCSAgc3RhdGUuZW5kZWQgPSB0cnVlOwoKCSAgLy8gZW1pdCAncmVhZGFibGUnIG5vdyB0byBtYWtlIHN1cmUgaXQgZ2V0cyBwaWNrZWQgdXAuCgkgIGVtaXRSZWFkYWJsZShzdHJlYW0pOwoJfQoKCS8vIERvbid0IGVtaXQgcmVhZGFibGUgcmlnaHQgYXdheSBpbiBzeW5jIG1vZGUsIGJlY2F1c2UgdGhpcyBjYW4gdHJpZ2dlcgoJLy8gYW5vdGhlciByZWFkKCkgY2FsbCA9PiBzdGFjayBvdmVyZmxvdy4gIFRoaXMgd2F5LCBpdCBtaWdodCB0cmlnZ2VyCgkvLyBhIG5leHRUaWNrIHJlY3Vyc2lvbiB3YXJuaW5nLCBidXQgdGhhdCdzIG5vdCBzbyBiYWQuCglmdW5jdGlvbiBlbWl0UmVhZGFibGUoc3RyZWFtKSB7CgkgIHZhciBzdGF0ZSA9IHN0cmVhbS5fcmVhZGFibGVTdGF0ZTsKCSAgc3RhdGUubmVlZFJlYWRhYmxlID0gZmFsc2U7CgkgIGlmICghc3RhdGUuZW1pdHRlZFJlYWRhYmxlKSB7CgkgICAgZGVidWcoJ2VtaXRSZWFkYWJsZScsIHN0YXRlLmZsb3dpbmcpOwoJICAgIHN0YXRlLmVtaXR0ZWRSZWFkYWJsZSA9IHRydWU7CgkgICAgaWYgKHN0YXRlLnN5bmMpIHByb2Nlc3NOZXh0VGljayhlbWl0UmVhZGFibGVfLCBzdHJlYW0pO2Vsc2UgZW1pdFJlYWRhYmxlXyhzdHJlYW0pOwoJICB9Cgl9CgoJZnVuY3Rpb24gZW1pdFJlYWRhYmxlXyhzdHJlYW0pIHsKCSAgZGVidWcoJ2VtaXQgcmVhZGFibGUnKTsKCSAgc3RyZWFtLmVtaXQoJ3JlYWRhYmxlJyk7CgkgIGZsb3coc3RyZWFtKTsKCX0KCgkvLyBhdCB0aGlzIHBvaW50LCB0aGUgdXNlciBoYXMgcHJlc3VtYWJseSBzZWVuIHRoZSAncmVhZGFibGUnIGV2ZW50LAoJLy8gYW5kIGNhbGxlZCByZWFkKCkgdG8gY29uc3VtZSBzb21lIGRhdGEuICB0aGF0IG1heSBoYXZlIHRyaWdnZXJlZAoJLy8gaW4gdHVybiBhbm90aGVyIF9yZWFkKG4pIGNhbGwsIGluIHdoaWNoIGNhc2UgcmVhZGluZyA9IHRydWUgaWYKCS8vIGl0J3MgaW4gcHJvZ3Jlc3MuCgkvLyBIb3dldmVyLCBpZiB3ZSdyZSBub3QgZW5kZWQsIG9yIHJlYWRpbmcsIGFuZCB0aGUgbGVuZ3RoIDwgaHdtLAoJLy8gdGhlbiBnbyBhaGVhZCBhbmQgdHJ5IHRvIHJlYWQgc29tZSBtb3JlIHByZWVtcHRpdmVseS4KCWZ1bmN0aW9uIG1heWJlUmVhZE1vcmUoc3RyZWFtLCBzdGF0ZSkgewoJICBpZiAoIXN0YXRlLnJlYWRpbmdNb3JlKSB7CgkgICAgc3RhdGUucmVhZGluZ01vcmUgPSB0cnVlOwoJICAgIHByb2Nlc3NOZXh0VGljayhtYXliZVJlYWRNb3JlXywgc3RyZWFtLCBzdGF0ZSk7CgkgIH0KCX0KCglmdW5jdGlvbiBtYXliZVJlYWRNb3JlXyhzdHJlYW0sIHN0YXRlKSB7CgkgIHZhciBsZW4gPSBzdGF0ZS5sZW5ndGg7CgkgIHdoaWxlICghc3RhdGUucmVhZGluZyAmJiAhc3RhdGUuZmxvd2luZyAmJiAhc3RhdGUuZW5kZWQgJiYgc3RhdGUubGVuZ3RoIDwgc3RhdGUuaGlnaFdhdGVyTWFyaykgewoJICAgIGRlYnVnKCdtYXliZVJlYWRNb3JlIHJlYWQgMCcpOwoJICAgIHN0cmVhbS5yZWFkKDApOwoJICAgIGlmIChsZW4gPT09IHN0YXRlLmxlbmd0aCkKCSAgICAgIC8vIGRpZG4ndCBnZXQgYW55IGRhdGEsIHN0b3Agc3Bpbm5pbmcuCgkgICAgICBicmVhaztlbHNlIGxlbiA9IHN0YXRlLmxlbmd0aDsKCSAgfQoJICBzdGF0ZS5yZWFkaW5nTW9yZSA9IGZhbHNlOwoJfQoKCS8vIGFic3RyYWN0IG1ldGhvZC4gIHRvIGJlIG92ZXJyaWRkZW4gaW4gc3BlY2lmaWMgaW1wbGVtZW50YXRpb24gY2xhc3Nlcy4KCS8vIGNhbGwgY2IoZXIsIGRhdGEpIHdoZXJlIGRhdGEgaXMgPD0gbiBpbiBsZW5ndGguCgkvLyBmb3IgdmlydHVhbCAobm9uLXN0cmluZywgbm9uLWJ1ZmZlcikgc3RyZWFtcywgImxlbmd0aCIgaXMgc29tZXdoYXQKCS8vIGFyYml0cmFyeSwgYW5kIHBlcmhhcHMgbm90IHZlcnkgbWVhbmluZ2Z1bC4KCVJlYWRhYmxlLnByb3RvdHlwZS5fcmVhZCA9IGZ1bmN0aW9uIChuKSB7CgkgIHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ19yZWFkKCkgaXMgbm90IGltcGxlbWVudGVkJykpOwoJfTsKCglSZWFkYWJsZS5wcm90b3R5cGUucGlwZSA9IGZ1bmN0aW9uIChkZXN0LCBwaXBlT3B0cykgewoJICB2YXIgc3JjID0gdGhpczsKCSAgdmFyIHN0YXRlID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsKCgkgIHN3aXRjaCAoc3RhdGUucGlwZXNDb3VudCkgewoJICAgIGNhc2UgMDoKCSAgICAgIHN0YXRlLnBpcGVzID0gZGVzdDsKCSAgICAgIGJyZWFrOwoJICAgIGNhc2UgMToKCSAgICAgIHN0YXRlLnBpcGVzID0gW3N0YXRlLnBpcGVzLCBkZXN0XTsKCSAgICAgIGJyZWFrOwoJICAgIGRlZmF1bHQ6CgkgICAgICBzdGF0ZS5waXBlcy5wdXNoKGRlc3QpOwoJICAgICAgYnJlYWs7CgkgIH0KCSAgc3RhdGUucGlwZXNDb3VudCArPSAxOwoJICBkZWJ1ZygncGlwZSBjb3VudD0lZCBvcHRzPSVqJywgc3RhdGUucGlwZXNDb3VudCwgcGlwZU9wdHMpOwoKCSAgdmFyIGRvRW5kID0gKCFwaXBlT3B0cyB8fCBwaXBlT3B0cy5lbmQgIT09IGZhbHNlKSAmJiBkZXN0ICE9PSBwcm9jZXNzLnN0ZG91dCAmJiBkZXN0ICE9PSBwcm9jZXNzLnN0ZGVycjsKCgkgIHZhciBlbmRGbiA9IGRvRW5kID8gb25lbmQgOiBjbGVhbnVwOwoJICBpZiAoc3RhdGUuZW5kRW1pdHRlZCkgcHJvY2Vzc05leHRUaWNrKGVuZEZuKTtlbHNlIHNyYy5vbmNlKCdlbmQnLCBlbmRGbik7CgoJICBkZXN0Lm9uKCd1bnBpcGUnLCBvbnVucGlwZSk7CgkgIGZ1bmN0aW9uIG9udW5waXBlKHJlYWRhYmxlKSB7CgkgICAgZGVidWcoJ29udW5waXBlJyk7CgkgICAgaWYgKHJlYWRhYmxlID09PSBzcmMpIHsKCSAgICAgIGNsZWFudXAoKTsKCSAgICB9CgkgIH0KCgkgIGZ1bmN0aW9uIG9uZW5kKCkgewoJICAgIGRlYnVnKCdvbmVuZCcpOwoJICAgIGRlc3QuZW5kKCk7CgkgIH0KCgkgIC8vIHdoZW4gdGhlIGRlc3QgZHJhaW5zLCBpdCByZWR1Y2VzIHRoZSBhd2FpdERyYWluIGNvdW50ZXIKCSAgLy8gb24gdGhlIHNvdXJjZS4gIFRoaXMgd291bGQgYmUgbW9yZSBlbGVnYW50IHdpdGggYSAub25jZSgpCgkgIC8vIGhhbmRsZXIgaW4gZmxvdygpLCBidXQgYWRkaW5nIGFuZCByZW1vdmluZyByZXBlYXRlZGx5IGlzCgkgIC8vIHRvbyBzbG93LgoJICB2YXIgb25kcmFpbiA9IHBpcGVPbkRyYWluKHNyYyk7CgkgIGRlc3Qub24oJ2RyYWluJywgb25kcmFpbik7CgoJICB2YXIgY2xlYW5lZFVwID0gZmFsc2U7CgkgIGZ1bmN0aW9uIGNsZWFudXAoKSB7CgkgICAgZGVidWcoJ2NsZWFudXAnKTsKCSAgICAvLyBjbGVhbnVwIGV2ZW50IGhhbmRsZXJzIG9uY2UgdGhlIHBpcGUgaXMgYnJva2VuCgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignY2xvc2UnLCBvbmNsb3NlKTsKCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdmaW5pc2gnLCBvbmZpbmlzaCk7CgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignZHJhaW4nLCBvbmRyYWluKTsKCSAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdlcnJvcicsIG9uZXJyb3IpOwoJICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ3VucGlwZScsIG9udW5waXBlKTsKCSAgICBzcmMucmVtb3ZlTGlzdGVuZXIoJ2VuZCcsIG9uZW5kKTsKCSAgICBzcmMucmVtb3ZlTGlzdGVuZXIoJ2VuZCcsIGNsZWFudXApOwoJICAgIHNyYy5yZW1vdmVMaXN0ZW5lcignZGF0YScsIG9uZGF0YSk7CgoJICAgIGNsZWFuZWRVcCA9IHRydWU7CgoJICAgIC8vIGlmIHRoZSByZWFkZXIgaXMgd2FpdGluZyBmb3IgYSBkcmFpbiBldmVudCBmcm9tIHRoaXMKCSAgICAvLyBzcGVjaWZpYyB3cml0ZXIsIHRoZW4gaXQgd291bGQgY2F1c2UgaXQgdG8gbmV2ZXIgc3RhcnQKCSAgICAvLyBmbG93aW5nIGFnYWluLgoJICAgIC8vIFNvLCBpZiB0aGlzIGlzIGF3YWl0aW5nIGEgZHJhaW4sIHRoZW4gd2UganVzdCBjYWxsIGl0IG5vdy4KCSAgICAvLyBJZiB3ZSBkb24ndCBrbm93LCB0aGVuIGFzc3VtZSB0aGF0IHdlIGFyZSB3YWl0aW5nIGZvciBvbmUuCgkgICAgaWYgKHN0YXRlLmF3YWl0RHJhaW4gJiYgKCFkZXN0Ll93cml0YWJsZVN0YXRlIHx8IGRlc3QuX3dyaXRhYmxlU3RhdGUubmVlZERyYWluKSkgb25kcmFpbigpOwoJICB9CgoJICAvLyBJZiB0aGUgdXNlciBwdXNoZXMgbW9yZSBkYXRhIHdoaWxlIHdlJ3JlIHdyaXRpbmcgdG8gZGVzdCB0aGVuIHdlJ2xsIGVuZCB1cAoJICAvLyBpbiBvbmRhdGEgYWdhaW4uIEhvd2V2ZXIsIHdlIG9ubHkgd2FudCB0byBpbmNyZWFzZSBhd2FpdERyYWluIG9uY2UgYmVjYXVzZQoJICAvLyBkZXN0IHdpbGwgb25seSBlbWl0IG9uZSAnZHJhaW4nIGV2ZW50IGZvciB0aGUgbXVsdGlwbGUgd3JpdGVzLgoJICAvLyA9PiBJbnRyb2R1Y2UgYSBndWFyZCBvbiBpbmNyZWFzaW5nIGF3YWl0RHJhaW4uCgkgIHZhciBpbmNyZWFzZWRBd2FpdERyYWluID0gZmFsc2U7CgkgIHNyYy5vbignZGF0YScsIG9uZGF0YSk7CgkgIGZ1bmN0aW9uIG9uZGF0YShjaHVuaykgewoJICAgIGRlYnVnKCdvbmRhdGEnKTsKCSAgICBpbmNyZWFzZWRBd2FpdERyYWluID0gZmFsc2U7CgkgICAgdmFyIHJldCA9IGRlc3Qud3JpdGUoY2h1bmspOwoJICAgIGlmIChmYWxzZSA9PT0gcmV0ICYmICFpbmNyZWFzZWRBd2FpdERyYWluKSB7CgkgICAgICAvLyBJZiB0aGUgdXNlciB1bnBpcGVkIGR1cmluZyBgZGVzdC53cml0ZSgpYCwgaXQgaXMgcG9zc2libGUKCSAgICAgIC8vIHRvIGdldCBzdHVjayBpbiBhIHBlcm1hbmVudGx5IHBhdXNlZCBzdGF0ZSBpZiB0aGF0IHdyaXRlCgkgICAgICAvLyBhbHNvIHJldHVybmVkIGZhbHNlLgoJICAgICAgLy8gPT4gQ2hlY2sgd2hldGhlciBgZGVzdGAgaXMgc3RpbGwgYSBwaXBpbmcgZGVzdGluYXRpb24uCgkgICAgICBpZiAoKHN0YXRlLnBpcGVzQ291bnQgPT09IDEgJiYgc3RhdGUucGlwZXMgPT09IGRlc3QgfHwgc3RhdGUucGlwZXNDb3VudCA+IDEgJiYgaW5kZXhPZihzdGF0ZS5waXBlcywgZGVzdCkgIT09IC0xKSAmJiAhY2xlYW5lZFVwKSB7CgkgICAgICAgIGRlYnVnKCdmYWxzZSB3cml0ZSByZXNwb25zZSwgcGF1c2UnLCBzcmMuX3JlYWRhYmxlU3RhdGUuYXdhaXREcmFpbik7CgkgICAgICAgIHNyYy5fcmVhZGFibGVTdGF0ZS5hd2FpdERyYWluKys7CgkgICAgICAgIGluY3JlYXNlZEF3YWl0RHJhaW4gPSB0cnVlOwoJICAgICAgfQoJICAgICAgc3JjLnBhdXNlKCk7CgkgICAgfQoJICB9CgoJICAvLyBpZiB0aGUgZGVzdCBoYXMgYW4gZXJyb3IsIHRoZW4gc3RvcCBwaXBpbmcgaW50byBpdC4KCSAgLy8gaG93ZXZlciwgZG9uJ3Qgc3VwcHJlc3MgdGhlIHRocm93aW5nIGJlaGF2aW9yIGZvciB0aGlzLgoJICBmdW5jdGlvbiBvbmVycm9yKGVyKSB7CgkgICAgZGVidWcoJ29uZXJyb3InLCBlcik7CgkgICAgdW5waXBlKCk7CgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBvbmVycm9yKTsKCSAgICBpZiAoRUVsaXN0ZW5lckNvdW50KGRlc3QsICdlcnJvcicpID09PSAwKSBkZXN0LmVtaXQoJ2Vycm9yJywgZXIpOwoJICB9CgoJICAvLyBNYWtlIHN1cmUgb3VyIGVycm9yIGhhbmRsZXIgaXMgYXR0YWNoZWQgYmVmb3JlIHVzZXJsYW5kIG9uZXMuCgkgIHByZXBlbmRMaXN0ZW5lcihkZXN0LCAnZXJyb3InLCBvbmVycm9yKTsKCgkgIC8vIEJvdGggY2xvc2UgYW5kIGZpbmlzaCBzaG91bGQgdHJpZ2dlciB1bnBpcGUsIGJ1dCBvbmx5IG9uY2UuCgkgIGZ1bmN0aW9uIG9uY2xvc2UoKSB7CgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignZmluaXNoJywgb25maW5pc2gpOwoJICAgIHVucGlwZSgpOwoJICB9CgkgIGRlc3Qub25jZSgnY2xvc2UnLCBvbmNsb3NlKTsKCSAgZnVuY3Rpb24gb25maW5pc2goKSB7CgkgICAgZGVidWcoJ29uZmluaXNoJyk7CgkgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignY2xvc2UnLCBvbmNsb3NlKTsKCSAgICB1bnBpcGUoKTsKCSAgfQoJICBkZXN0Lm9uY2UoJ2ZpbmlzaCcsIG9uZmluaXNoKTsKCgkgIGZ1bmN0aW9uIHVucGlwZSgpIHsKCSAgICBkZWJ1ZygndW5waXBlJyk7CgkgICAgc3JjLnVucGlwZShkZXN0KTsKCSAgfQoKCSAgLy8gdGVsbCB0aGUgZGVzdCB0aGF0IGl0J3MgYmVpbmcgcGlwZWQgdG8KCSAgZGVzdC5lbWl0KCdwaXBlJywgc3JjKTsKCgkgIC8vIHN0YXJ0IHRoZSBmbG93IGlmIGl0IGhhc24ndCBiZWVuIHN0YXJ0ZWQgYWxyZWFkeS4KCSAgaWYgKCFzdGF0ZS5mbG93aW5nKSB7CgkgICAgZGVidWcoJ3BpcGUgcmVzdW1lJyk7CgkgICAgc3JjLnJlc3VtZSgpOwoJICB9CgoJICByZXR1cm4gZGVzdDsKCX07CgoJZnVuY3Rpb24gcGlwZU9uRHJhaW4oc3JjKSB7CgkgIHJldHVybiBmdW5jdGlvbiAoKSB7CgkgICAgdmFyIHN0YXRlID0gc3JjLl9yZWFkYWJsZVN0YXRlOwoJICAgIGRlYnVnKCdwaXBlT25EcmFpbicsIHN0YXRlLmF3YWl0RHJhaW4pOwoJICAgIGlmIChzdGF0ZS5hd2FpdERyYWluKSBzdGF0ZS5hd2FpdERyYWluLS07CgkgICAgaWYgKHN0YXRlLmF3YWl0RHJhaW4gPT09IDAgJiYgRUVsaXN0ZW5lckNvdW50KHNyYywgJ2RhdGEnKSkgewoJICAgICAgc3RhdGUuZmxvd2luZyA9IHRydWU7CgkgICAgICBmbG93KHNyYyk7CgkgICAgfQoJICB9OwoJfQoKCVJlYWRhYmxlLnByb3RvdHlwZS51bnBpcGUgPSBmdW5jdGlvbiAoZGVzdCkgewoJICB2YXIgc3RhdGUgPSB0aGlzLl9yZWFkYWJsZVN0YXRlOwoKCSAgLy8gaWYgd2UncmUgbm90IHBpcGluZyBhbnl3aGVyZSwgdGhlbiBkbyBub3RoaW5nLgoJICBpZiAoc3RhdGUucGlwZXNDb3VudCA9PT0gMCkgcmV0dXJuIHRoaXM7CgoJICAvLyBqdXN0IG9uZSBkZXN0aW5hdGlvbi4gIG1vc3QgY29tbW9uIGNhc2UuCgkgIGlmIChzdGF0ZS5waXBlc0NvdW50ID09PSAxKSB7CgkgICAgLy8gcGFzc2VkIGluIG9uZSwgYnV0IGl0J3Mgbm90IHRoZSByaWdodCBvbmUuCgkgICAgaWYgKGRlc3QgJiYgZGVzdCAhPT0gc3RhdGUucGlwZXMpIHJldHVybiB0aGlzOwoKCSAgICBpZiAoIWRlc3QpIGRlc3QgPSBzdGF0ZS5waXBlczsKCgkgICAgLy8gZ290IGEgbWF0Y2guCgkgICAgc3RhdGUucGlwZXMgPSBudWxsOwoJICAgIHN0YXRlLnBpcGVzQ291bnQgPSAwOwoJICAgIHN0YXRlLmZsb3dpbmcgPSBmYWxzZTsKCSAgICBpZiAoZGVzdCkgZGVzdC5lbWl0KCd1bnBpcGUnLCB0aGlzKTsKCSAgICByZXR1cm4gdGhpczsKCSAgfQoKCSAgLy8gc2xvdyBjYXNlLiBtdWx0aXBsZSBwaXBlIGRlc3RpbmF0aW9ucy4KCgkgIGlmICghZGVzdCkgewoJICAgIC8vIHJlbW92ZSBhbGwuCgkgICAgdmFyIGRlc3RzID0gc3RhdGUucGlwZXM7CgkgICAgdmFyIGxlbiA9IHN0YXRlLnBpcGVzQ291bnQ7CgkgICAgc3RhdGUucGlwZXMgPSBudWxsOwoJICAgIHN0YXRlLnBpcGVzQ291bnQgPSAwOwoJICAgIHN0YXRlLmZsb3dpbmcgPSBmYWxzZTsKCgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewoJICAgICAgZGVzdHNbaV0uZW1pdCgndW5waXBlJywgdGhpcyk7CgkgICAgfXJldHVybiB0aGlzOwoJICB9CgoJICAvLyB0cnkgdG8gZmluZCB0aGUgcmlnaHQgb25lLgoJICB2YXIgaW5kZXggPSBpbmRleE9mKHN0YXRlLnBpcGVzLCBkZXN0KTsKCSAgaWYgKGluZGV4ID09PSAtMSkgcmV0dXJuIHRoaXM7CgoJICBzdGF0ZS5waXBlcy5zcGxpY2UoaW5kZXgsIDEpOwoJICBzdGF0ZS5waXBlc0NvdW50IC09IDE7CgkgIGlmIChzdGF0ZS5waXBlc0NvdW50ID09PSAxKSBzdGF0ZS5waXBlcyA9IHN0YXRlLnBpcGVzWzBdOwoKCSAgZGVzdC5lbWl0KCd1bnBpcGUnLCB0aGlzKTsKCgkgIHJldHVybiB0aGlzOwoJfTsKCgkvLyBzZXQgdXAgZGF0YSBldmVudHMgaWYgdGhleSBhcmUgYXNrZWQgZm9yCgkvLyBFbnN1cmUgcmVhZGFibGUgbGlzdGVuZXJzIGV2ZW50dWFsbHkgZ2V0IHNvbWV0aGluZwoJUmVhZGFibGUucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gKGV2LCBmbikgewoJICB2YXIgcmVzID0gU3RyZWFtLnByb3RvdHlwZS5vbi5jYWxsKHRoaXMsIGV2LCBmbik7CgoJICBpZiAoZXYgPT09ICdkYXRhJykgewoJICAgIC8vIFN0YXJ0IGZsb3dpbmcgb24gbmV4dCB0aWNrIGlmIHN0cmVhbSBpc24ndCBleHBsaWNpdGx5IHBhdXNlZAoJICAgIGlmICh0aGlzLl9yZWFkYWJsZVN0YXRlLmZsb3dpbmcgIT09IGZhbHNlKSB0aGlzLnJlc3VtZSgpOwoJICB9IGVsc2UgaWYgKGV2ID09PSAncmVhZGFibGUnKSB7CgkgICAgdmFyIHN0YXRlID0gdGhpcy5fcmVhZGFibGVTdGF0ZTsKCSAgICBpZiAoIXN0YXRlLmVuZEVtaXR0ZWQgJiYgIXN0YXRlLnJlYWRhYmxlTGlzdGVuaW5nKSB7CgkgICAgICBzdGF0ZS5yZWFkYWJsZUxpc3RlbmluZyA9IHN0YXRlLm5lZWRSZWFkYWJsZSA9IHRydWU7CgkgICAgICBzdGF0ZS5lbWl0dGVkUmVhZGFibGUgPSBmYWxzZTsKCSAgICAgIGlmICghc3RhdGUucmVhZGluZykgewoJICAgICAgICBwcm9jZXNzTmV4dFRpY2soblJlYWRpbmdOZXh0VGljaywgdGhpcyk7CgkgICAgICB9IGVsc2UgaWYgKHN0YXRlLmxlbmd0aCkgewoJICAgICAgICBlbWl0UmVhZGFibGUodGhpcywgc3RhdGUpOwoJICAgICAgfQoJICAgIH0KCSAgfQoKCSAgcmV0dXJuIHJlczsKCX07CglSZWFkYWJsZS5wcm90b3R5cGUuYWRkTGlzdGVuZXIgPSBSZWFkYWJsZS5wcm90b3R5cGUub247CgoJZnVuY3Rpb24gblJlYWRpbmdOZXh0VGljayhzZWxmKSB7CgkgIGRlYnVnKCdyZWFkYWJsZSBuZXh0dGljayByZWFkIDAnKTsKCSAgc2VsZi5yZWFkKDApOwoJfQoKCS8vIHBhdXNlKCkgYW5kIHJlc3VtZSgpIGFyZSByZW1uYW50cyBvZiB0aGUgbGVnYWN5IHJlYWRhYmxlIHN0cmVhbSBBUEkKCS8vIElmIHRoZSB1c2VyIHVzZXMgdGhlbSwgdGhlbiBzd2l0Y2ggaW50byBvbGQgbW9kZS4KCVJlYWRhYmxlLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7CgkgIHZhciBzdGF0ZSA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgkgIGlmICghc3RhdGUuZmxvd2luZykgewoJICAgIGRlYnVnKCdyZXN1bWUnKTsKCSAgICBzdGF0ZS5mbG93aW5nID0gdHJ1ZTsKCSAgICByZXN1bWUodGhpcywgc3RhdGUpOwoJICB9CgkgIHJldHVybiB0aGlzOwoJfTsKCglmdW5jdGlvbiByZXN1bWUoc3RyZWFtLCBzdGF0ZSkgewoJICBpZiAoIXN0YXRlLnJlc3VtZVNjaGVkdWxlZCkgewoJICAgIHN0YXRlLnJlc3VtZVNjaGVkdWxlZCA9IHRydWU7CgkgICAgcHJvY2Vzc05leHRUaWNrKHJlc3VtZV8sIHN0cmVhbSwgc3RhdGUpOwoJICB9Cgl9CgoJZnVuY3Rpb24gcmVzdW1lXyhzdHJlYW0sIHN0YXRlKSB7CgkgIGlmICghc3RhdGUucmVhZGluZykgewoJICAgIGRlYnVnKCdyZXN1bWUgcmVhZCAwJyk7CgkgICAgc3RyZWFtLnJlYWQoMCk7CgkgIH0KCgkgIHN0YXRlLnJlc3VtZVNjaGVkdWxlZCA9IGZhbHNlOwoJICBzdGF0ZS5hd2FpdERyYWluID0gMDsKCSAgc3RyZWFtLmVtaXQoJ3Jlc3VtZScpOwoJICBmbG93KHN0cmVhbSk7CgkgIGlmIChzdGF0ZS5mbG93aW5nICYmICFzdGF0ZS5yZWFkaW5nKSBzdHJlYW0ucmVhZCgwKTsKCX0KCglSZWFkYWJsZS5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7CgkgIGRlYnVnKCdjYWxsIHBhdXNlIGZsb3dpbmc9JWonLCB0aGlzLl9yZWFkYWJsZVN0YXRlLmZsb3dpbmcpOwoJICBpZiAoZmFsc2UgIT09IHRoaXMuX3JlYWRhYmxlU3RhdGUuZmxvd2luZykgewoJICAgIGRlYnVnKCdwYXVzZScpOwoJICAgIHRoaXMuX3JlYWRhYmxlU3RhdGUuZmxvd2luZyA9IGZhbHNlOwoJICAgIHRoaXMuZW1pdCgncGF1c2UnKTsKCSAgfQoJICByZXR1cm4gdGhpczsKCX07CgoJZnVuY3Rpb24gZmxvdyhzdHJlYW0pIHsKCSAgdmFyIHN0YXRlID0gc3RyZWFtLl9yZWFkYWJsZVN0YXRlOwoJICBkZWJ1ZygnZmxvdycsIHN0YXRlLmZsb3dpbmcpOwoJICB3aGlsZSAoc3RhdGUuZmxvd2luZyAmJiBzdHJlYW0ucmVhZCgpICE9PSBudWxsKSB7fQoJfQoKCS8vIHdyYXAgYW4gb2xkLXN0eWxlIHN0cmVhbSBhcyB0aGUgYXN5bmMgZGF0YSBzb3VyY2UuCgkvLyBUaGlzIGlzICpub3QqIHBhcnQgb2YgdGhlIHJlYWRhYmxlIHN0cmVhbSBpbnRlcmZhY2UuCgkvLyBJdCBpcyBhbiB1Z2x5IHVuZm9ydHVuYXRlIG1lc3Mgb2YgaGlzdG9yeS4KCVJlYWRhYmxlLnByb3RvdHlwZS53cmFwID0gZnVuY3Rpb24gKHN0cmVhbSkgewoJICB2YXIgc3RhdGUgPSB0aGlzLl9yZWFkYWJsZVN0YXRlOwoJICB2YXIgcGF1c2VkID0gZmFsc2U7CgoJICB2YXIgc2VsZiA9IHRoaXM7CgkgIHN0cmVhbS5vbignZW5kJywgZnVuY3Rpb24gKCkgewoJICAgIGRlYnVnKCd3cmFwcGVkIGVuZCcpOwoJICAgIGlmIChzdGF0ZS5kZWNvZGVyICYmICFzdGF0ZS5lbmRlZCkgewoJICAgICAgdmFyIGNodW5rID0gc3RhdGUuZGVjb2Rlci5lbmQoKTsKCSAgICAgIGlmIChjaHVuayAmJiBjaHVuay5sZW5ndGgpIHNlbGYucHVzaChjaHVuayk7CgkgICAgfQoKCSAgICBzZWxmLnB1c2gobnVsbCk7CgkgIH0pOwoKCSAgc3RyZWFtLm9uKCdkYXRhJywgZnVuY3Rpb24gKGNodW5rKSB7CgkgICAgZGVidWcoJ3dyYXBwZWQgZGF0YScpOwoJICAgIGlmIChzdGF0ZS5kZWNvZGVyKSBjaHVuayA9IHN0YXRlLmRlY29kZXIud3JpdGUoY2h1bmspOwoKCSAgICAvLyBkb24ndCBza2lwIG92ZXIgZmFsc3kgdmFsdWVzIGluIG9iamVjdE1vZGUKCSAgICBpZiAoc3RhdGUub2JqZWN0TW9kZSAmJiAoY2h1bmsgPT09IG51bGwgfHwgY2h1bmsgPT09IHVuZGVmaW5lZCkpIHJldHVybjtlbHNlIGlmICghc3RhdGUub2JqZWN0TW9kZSAmJiAoIWNodW5rIHx8ICFjaHVuay5sZW5ndGgpKSByZXR1cm47CgoJICAgIHZhciByZXQgPSBzZWxmLnB1c2goY2h1bmspOwoJICAgIGlmICghcmV0KSB7CgkgICAgICBwYXVzZWQgPSB0cnVlOwoJICAgICAgc3RyZWFtLnBhdXNlKCk7CgkgICAgfQoJICB9KTsKCgkgIC8vIHByb3h5IGFsbCB0aGUgb3RoZXIgbWV0aG9kcy4KCSAgLy8gaW1wb3J0YW50IHdoZW4gd3JhcHBpbmcgZmlsdGVycyBhbmQgZHVwbGV4ZXMuCgkgIGZvciAodmFyIGkgaW4gc3RyZWFtKSB7CgkgICAgaWYgKHRoaXNbaV0gPT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygc3RyZWFtW2ldID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICB0aGlzW2ldID0gZnVuY3Rpb24gKG1ldGhvZCkgewoJICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewoJICAgICAgICAgIHJldHVybiBzdHJlYW1bbWV0aG9kXS5hcHBseShzdHJlYW0sIGFyZ3VtZW50cyk7CgkgICAgICAgIH07CgkgICAgICB9KGkpOwoJICAgIH0KCSAgfQoKCSAgLy8gcHJveHkgY2VydGFpbiBpbXBvcnRhbnQgZXZlbnRzLgoJICB2YXIgZXZlbnRzID0gWydlcnJvcicsICdjbG9zZScsICdkZXN0cm95JywgJ3BhdXNlJywgJ3Jlc3VtZSddOwoJICBmb3JFYWNoKGV2ZW50cywgZnVuY3Rpb24gKGV2KSB7CgkgICAgc3RyZWFtLm9uKGV2LCBzZWxmLmVtaXQuYmluZChzZWxmLCBldikpOwoJICB9KTsKCgkgIC8vIHdoZW4gd2UgdHJ5IHRvIGNvbnN1bWUgc29tZSBtb3JlIGJ5dGVzLCBzaW1wbHkgdW5wYXVzZSB0aGUKCSAgLy8gdW5kZXJseWluZyBzdHJlYW0uCgkgIHNlbGYuX3JlYWQgPSBmdW5jdGlvbiAobikgewoJICAgIGRlYnVnKCd3cmFwcGVkIF9yZWFkJywgbik7CgkgICAgaWYgKHBhdXNlZCkgewoJICAgICAgcGF1c2VkID0gZmFsc2U7CgkgICAgICBzdHJlYW0ucmVzdW1lKCk7CgkgICAgfQoJICB9OwoKCSAgcmV0dXJuIHNlbGY7Cgl9OwoKCS8vIGV4cG9zZWQgZm9yIHRlc3RpbmcgcHVycG9zZXMgb25seS4KCVJlYWRhYmxlLl9mcm9tTGlzdCA9IGZyb21MaXN0OwoKCS8vIFBsdWNrIG9mZiBuIGJ5dGVzIGZyb20gYW4gYXJyYXkgb2YgYnVmZmVycy4KCS8vIExlbmd0aCBpcyB0aGUgY29tYmluZWQgbGVuZ3RocyBvZiBhbGwgdGhlIGJ1ZmZlcnMgaW4gdGhlIGxpc3QuCgkvLyBUaGlzIGZ1bmN0aW9uIGlzIGRlc2lnbmVkIHRvIGJlIGlubGluYWJsZSwgc28gcGxlYXNlIHRha2UgY2FyZSB3aGVuIG1ha2luZwoJLy8gY2hhbmdlcyB0byB0aGUgZnVuY3Rpb24gYm9keS4KCWZ1bmN0aW9uIGZyb21MaXN0KG4sIHN0YXRlKSB7CgkgIC8vIG5vdGhpbmcgYnVmZmVyZWQKCSAgaWYgKHN0YXRlLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7CgoJICB2YXIgcmV0OwoJICBpZiAoc3RhdGUub2JqZWN0TW9kZSkgcmV0ID0gc3RhdGUuYnVmZmVyLnNoaWZ0KCk7ZWxzZSBpZiAoIW4gfHwgbiA+PSBzdGF0ZS5sZW5ndGgpIHsKCSAgICAvLyByZWFkIGl0IGFsbCwgdHJ1bmNhdGUgdGhlIGxpc3QKCSAgICBpZiAoc3RhdGUuZGVjb2RlcikgcmV0ID0gc3RhdGUuYnVmZmVyLmpvaW4oJycpO2Vsc2UgaWYgKHN0YXRlLmJ1ZmZlci5sZW5ndGggPT09IDEpIHJldCA9IHN0YXRlLmJ1ZmZlci5oZWFkLmRhdGE7ZWxzZSByZXQgPSBzdGF0ZS5idWZmZXIuY29uY2F0KHN0YXRlLmxlbmd0aCk7CgkgICAgc3RhdGUuYnVmZmVyLmNsZWFyKCk7CgkgIH0gZWxzZSB7CgkgICAgLy8gcmVhZCBwYXJ0IG9mIGxpc3QKCSAgICByZXQgPSBmcm9tTGlzdFBhcnRpYWwobiwgc3RhdGUuYnVmZmVyLCBzdGF0ZS5kZWNvZGVyKTsKCSAgfQoKCSAgcmV0dXJuIHJldDsKCX0KCgkvLyBFeHRyYWN0cyBvbmx5IGVub3VnaCBidWZmZXJlZCBkYXRhIHRvIHNhdGlzZnkgdGhlIGFtb3VudCByZXF1ZXN0ZWQuCgkvLyBUaGlzIGZ1bmN0aW9uIGlzIGRlc2lnbmVkIHRvIGJlIGlubGluYWJsZSwgc28gcGxlYXNlIHRha2UgY2FyZSB3aGVuIG1ha2luZwoJLy8gY2hhbmdlcyB0byB0aGUgZnVuY3Rpb24gYm9keS4KCWZ1bmN0aW9uIGZyb21MaXN0UGFydGlhbChuLCBsaXN0LCBoYXNTdHJpbmdzKSB7CgkgIHZhciByZXQ7CgkgIGlmIChuIDwgbGlzdC5oZWFkLmRhdGEubGVuZ3RoKSB7CgkgICAgLy8gc2xpY2UgaXMgdGhlIHNhbWUgZm9yIGJ1ZmZlcnMgYW5kIHN0cmluZ3MKCSAgICByZXQgPSBsaXN0LmhlYWQuZGF0YS5zbGljZSgwLCBuKTsKCSAgICBsaXN0LmhlYWQuZGF0YSA9IGxpc3QuaGVhZC5kYXRhLnNsaWNlKG4pOwoJICB9IGVsc2UgaWYgKG4gPT09IGxpc3QuaGVhZC5kYXRhLmxlbmd0aCkgewoJICAgIC8vIGZpcnN0IGNodW5rIGlzIGEgcGVyZmVjdCBtYXRjaAoJICAgIHJldCA9IGxpc3Quc2hpZnQoKTsKCSAgfSBlbHNlIHsKCSAgICAvLyByZXN1bHQgc3BhbnMgbW9yZSB0aGFuIG9uZSBidWZmZXIKCSAgICByZXQgPSBoYXNTdHJpbmdzID8gY29weUZyb21CdWZmZXJTdHJpbmcobiwgbGlzdCkgOiBjb3B5RnJvbUJ1ZmZlcihuLCBsaXN0KTsKCSAgfQoJICByZXR1cm4gcmV0OwoJfQoKCS8vIENvcGllcyBhIHNwZWNpZmllZCBhbW91bnQgb2YgY2hhcmFjdGVycyBmcm9tIHRoZSBsaXN0IG9mIGJ1ZmZlcmVkIGRhdGEKCS8vIGNodW5rcy4KCS8vIFRoaXMgZnVuY3Rpb24gaXMgZGVzaWduZWQgdG8gYmUgaW5saW5hYmxlLCBzbyBwbGVhc2UgdGFrZSBjYXJlIHdoZW4gbWFraW5nCgkvLyBjaGFuZ2VzIHRvIHRoZSBmdW5jdGlvbiBib2R5LgoJZnVuY3Rpb24gY29weUZyb21CdWZmZXJTdHJpbmcobiwgbGlzdCkgewoJICB2YXIgcCA9IGxpc3QuaGVhZDsKCSAgdmFyIGMgPSAxOwoJICB2YXIgcmV0ID0gcC5kYXRhOwoJICBuIC09IHJldC5sZW5ndGg7CgkgIHdoaWxlIChwID0gcC5uZXh0KSB7CgkgICAgdmFyIHN0ciA9IHAuZGF0YTsKCSAgICB2YXIgbmIgPSBuID4gc3RyLmxlbmd0aCA/IHN0ci5sZW5ndGggOiBuOwoJICAgIGlmIChuYiA9PT0gc3RyLmxlbmd0aCkgcmV0ICs9IHN0cjtlbHNlIHJldCArPSBzdHIuc2xpY2UoMCwgbik7CgkgICAgbiAtPSBuYjsKCSAgICBpZiAobiA9PT0gMCkgewoJICAgICAgaWYgKG5iID09PSBzdHIubGVuZ3RoKSB7CgkgICAgICAgICsrYzsKCSAgICAgICAgaWYgKHAubmV4dCkgbGlzdC5oZWFkID0gcC5uZXh0O2Vsc2UgbGlzdC5oZWFkID0gbGlzdC50YWlsID0gbnVsbDsKCSAgICAgIH0gZWxzZSB7CgkgICAgICAgIGxpc3QuaGVhZCA9IHA7CgkgICAgICAgIHAuZGF0YSA9IHN0ci5zbGljZShuYik7CgkgICAgICB9CgkgICAgICBicmVhazsKCSAgICB9CgkgICAgKytjOwoJICB9CgkgIGxpc3QubGVuZ3RoIC09IGM7CgkgIHJldHVybiByZXQ7Cgl9CgoJLy8gQ29waWVzIGEgc3BlY2lmaWVkIGFtb3VudCBvZiBieXRlcyBmcm9tIHRoZSBsaXN0IG9mIGJ1ZmZlcmVkIGRhdGEgY2h1bmtzLgoJLy8gVGhpcyBmdW5jdGlvbiBpcyBkZXNpZ25lZCB0byBiZSBpbmxpbmFibGUsIHNvIHBsZWFzZSB0YWtlIGNhcmUgd2hlbiBtYWtpbmcKCS8vIGNoYW5nZXMgdG8gdGhlIGZ1bmN0aW9uIGJvZHkuCglmdW5jdGlvbiBjb3B5RnJvbUJ1ZmZlcihuLCBsaXN0KSB7CgkgIHZhciByZXQgPSBidWZmZXJTaGltLmFsbG9jVW5zYWZlKG4pOwoJICB2YXIgcCA9IGxpc3QuaGVhZDsKCSAgdmFyIGMgPSAxOwoJICBwLmRhdGEuY29weShyZXQpOwoJICBuIC09IHAuZGF0YS5sZW5ndGg7CgkgIHdoaWxlIChwID0gcC5uZXh0KSB7CgkgICAgdmFyIGJ1ZiA9IHAuZGF0YTsKCSAgICB2YXIgbmIgPSBuID4gYnVmLmxlbmd0aCA/IGJ1Zi5sZW5ndGggOiBuOwoJICAgIGJ1Zi5jb3B5KHJldCwgcmV0Lmxlbmd0aCAtIG4sIDAsIG5iKTsKCSAgICBuIC09IG5iOwoJICAgIGlmIChuID09PSAwKSB7CgkgICAgICBpZiAobmIgPT09IGJ1Zi5sZW5ndGgpIHsKCSAgICAgICAgKytjOwoJICAgICAgICBpZiAocC5uZXh0KSBsaXN0LmhlYWQgPSBwLm5leHQ7ZWxzZSBsaXN0LmhlYWQgPSBsaXN0LnRhaWwgPSBudWxsOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgbGlzdC5oZWFkID0gcDsKCSAgICAgICAgcC5kYXRhID0gYnVmLnNsaWNlKG5iKTsKCSAgICAgIH0KCSAgICAgIGJyZWFrOwoJICAgIH0KCSAgICArK2M7CgkgIH0KCSAgbGlzdC5sZW5ndGggLT0gYzsKCSAgcmV0dXJuIHJldDsKCX0KCglmdW5jdGlvbiBlbmRSZWFkYWJsZShzdHJlYW0pIHsKCSAgdmFyIHN0YXRlID0gc3RyZWFtLl9yZWFkYWJsZVN0YXRlOwoKCSAgLy8gSWYgd2UgZ2V0IGhlcmUgYmVmb3JlIGNvbnN1bWluZyBhbGwgdGhlIGJ5dGVzLCB0aGVuIHRoYXQgaXMgYQoJICAvLyBidWcgaW4gbm9kZS4gIFNob3VsZCBuZXZlciBoYXBwZW4uCgkgIGlmIChzdGF0ZS5sZW5ndGggPiAwKSB0aHJvdyBuZXcgRXJyb3IoJyJlbmRSZWFkYWJsZSgpIiBjYWxsZWQgb24gbm9uLWVtcHR5IHN0cmVhbScpOwoKCSAgaWYgKCFzdGF0ZS5lbmRFbWl0dGVkKSB7CgkgICAgc3RhdGUuZW5kZWQgPSB0cnVlOwoJICAgIHByb2Nlc3NOZXh0VGljayhlbmRSZWFkYWJsZU5ULCBzdGF0ZSwgc3RyZWFtKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIGVuZFJlYWRhYmxlTlQoc3RhdGUsIHN0cmVhbSkgewoJICAvLyBDaGVjayB0aGF0IHdlIGRpZG4ndCBnZXQgb25lIGxhc3QgdW5zaGlmdC4KCSAgaWYgKCFzdGF0ZS5lbmRFbWl0dGVkICYmIHN0YXRlLmxlbmd0aCA9PT0gMCkgewoJICAgIHN0YXRlLmVuZEVtaXR0ZWQgPSB0cnVlOwoJICAgIHN0cmVhbS5yZWFkYWJsZSA9IGZhbHNlOwoJICAgIHN0cmVhbS5lbWl0KCdlbmQnKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIGZvckVhY2goeHMsIGYpIHsKCSAgZm9yICh2YXIgaSA9IDAsIGwgPSB4cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKCSAgICBmKHhzW2ldLCBpKTsKCSAgfQoJfQoKCWZ1bmN0aW9uIGluZGV4T2YoeHMsIHgpIHsKCSAgZm9yICh2YXIgaSA9IDAsIGwgPSB4cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKCSAgICBpZiAoeHNbaV0gPT09IHgpIHJldHVybiBpOwoJICB9CgkgIHJldHVybiAtMTsKCX0KCS8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKSkpCgovKioqLyB9LAovKiAyOSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvKiAoaWdub3JlZCkgKi8KCi8qKiovIH0sCi8qIDMwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCgl2YXIgQnVmZmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KS5CdWZmZXI7CgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIGJ1ZmZlclNoaW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCW1vZHVsZS5leHBvcnRzID0gQnVmZmVyTGlzdDsKCglmdW5jdGlvbiBCdWZmZXJMaXN0KCkgewoJICB0aGlzLmhlYWQgPSBudWxsOwoJICB0aGlzLnRhaWwgPSBudWxsOwoJICB0aGlzLmxlbmd0aCA9IDA7Cgl9CgoJQnVmZmVyTGlzdC5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uICh2KSB7CgkgIHZhciBlbnRyeSA9IHsgZGF0YTogdiwgbmV4dDogbnVsbCB9OwoJICBpZiAodGhpcy5sZW5ndGggPiAwKSB0aGlzLnRhaWwubmV4dCA9IGVudHJ5O2Vsc2UgdGhpcy5oZWFkID0gZW50cnk7CgkgIHRoaXMudGFpbCA9IGVudHJ5OwoJICArK3RoaXMubGVuZ3RoOwoJfTsKCglCdWZmZXJMaXN0LnByb3RvdHlwZS51bnNoaWZ0ID0gZnVuY3Rpb24gKHYpIHsKCSAgdmFyIGVudHJ5ID0geyBkYXRhOiB2LCBuZXh0OiB0aGlzLmhlYWQgfTsKCSAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSB0aGlzLnRhaWwgPSBlbnRyeTsKCSAgdGhpcy5oZWFkID0gZW50cnk7CgkgICsrdGhpcy5sZW5ndGg7Cgl9OwoKCUJ1ZmZlckxpc3QucHJvdG90eXBlLnNoaWZ0ID0gZnVuY3Rpb24gKCkgewoJICBpZiAodGhpcy5sZW5ndGggPT09IDApIHJldHVybjsKCSAgdmFyIHJldCA9IHRoaXMuaGVhZC5kYXRhOwoJICBpZiAodGhpcy5sZW5ndGggPT09IDEpIHRoaXMuaGVhZCA9IHRoaXMudGFpbCA9IG51bGw7ZWxzZSB0aGlzLmhlYWQgPSB0aGlzLmhlYWQubmV4dDsKCSAgLS10aGlzLmxlbmd0aDsKCSAgcmV0dXJuIHJldDsKCX07CgoJQnVmZmVyTGlzdC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7CgkgIHRoaXMuaGVhZCA9IHRoaXMudGFpbCA9IG51bGw7CgkgIHRoaXMubGVuZ3RoID0gMDsKCX07CgoJQnVmZmVyTGlzdC5wcm90b3R5cGUuam9pbiA9IGZ1bmN0aW9uIChzKSB7CgkgIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuICcnOwoJICB2YXIgcCA9IHRoaXMuaGVhZDsKCSAgdmFyIHJldCA9ICcnICsgcC5kYXRhOwoJICB3aGlsZSAocCA9IHAubmV4dCkgewoJICAgIHJldCArPSBzICsgcC5kYXRhOwoJICB9cmV0dXJuIHJldDsKCX07CgoJQnVmZmVyTGlzdC5wcm90b3R5cGUuY29uY2F0ID0gZnVuY3Rpb24gKG4pIHsKCSAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm4gYnVmZmVyU2hpbS5hbGxvYygwKTsKCSAgaWYgKHRoaXMubGVuZ3RoID09PSAxKSByZXR1cm4gdGhpcy5oZWFkLmRhdGE7CgkgIHZhciByZXQgPSBidWZmZXJTaGltLmFsbG9jVW5zYWZlKG4gPj4+IDApOwoJICB2YXIgcCA9IHRoaXMuaGVhZDsKCSAgdmFyIGkgPSAwOwoJICB3aGlsZSAocCkgewoJICAgIHAuZGF0YS5jb3B5KHJldCwgaSk7CgkgICAgaSArPSBwLmRhdGEubGVuZ3RoOwoJICAgIHAgPSBwLm5leHQ7CgkgIH0KCSAgcmV0dXJuIHJldDsKCX07CgovKioqLyB9LAovKiAzMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCXZhciBCdWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpLkJ1ZmZlcjsKCgl2YXIgaXNCdWZmZXJFbmNvZGluZyA9IEJ1ZmZlci5pc0VuY29kaW5nCgkgIHx8IGZ1bmN0aW9uKGVuY29kaW5nKSB7CgkgICAgICAgc3dpdGNoIChlbmNvZGluZyAmJiBlbmNvZGluZy50b0xvd2VyQ2FzZSgpKSB7CgkgICAgICAgICBjYXNlICdoZXgnOiBjYXNlICd1dGY4JzogY2FzZSAndXRmLTgnOiBjYXNlICdhc2NpaSc6IGNhc2UgJ2JpbmFyeSc6IGNhc2UgJ2Jhc2U2NCc6IGNhc2UgJ3VjczInOiBjYXNlICd1Y3MtMic6IGNhc2UgJ3V0ZjE2bGUnOiBjYXNlICd1dGYtMTZsZSc6IGNhc2UgJ3Jhdyc6IHJldHVybiB0cnVlOwoJICAgICAgICAgZGVmYXVsdDogcmV0dXJuIGZhbHNlOwoJICAgICAgIH0KCSAgICAgfQoKCglmdW5jdGlvbiBhc3NlcnRFbmNvZGluZyhlbmNvZGluZykgewoJICBpZiAoZW5jb2RpbmcgJiYgIWlzQnVmZmVyRW5jb2RpbmcoZW5jb2RpbmcpKSB7CgkgICAgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpOwoJICB9Cgl9CgoJLy8gU3RyaW5nRGVjb2RlciBwcm92aWRlcyBhbiBpbnRlcmZhY2UgZm9yIGVmZmljaWVudGx5IHNwbGl0dGluZyBhIHNlcmllcyBvZgoJLy8gYnVmZmVycyBpbnRvIGEgc2VyaWVzIG9mIEpTIHN0cmluZ3Mgd2l0aG91dCBicmVha2luZyBhcGFydCBtdWx0aS1ieXRlCgkvLyBjaGFyYWN0ZXJzLiBDRVNVLTggaXMgaGFuZGxlZCBhcyBwYXJ0IG9mIHRoZSBVVEYtOCBlbmNvZGluZy4KCS8vCgkvLyBAVE9ETyBIYW5kbGluZyBhbGwgZW5jb2RpbmdzIGluc2lkZSBhIHNpbmdsZSBvYmplY3QgbWFrZXMgaXQgdmVyeSBkaWZmaWN1bHQKCS8vIHRvIHJlYXNvbiBhYm91dCB0aGlzIGNvZGUsIHNvIGl0IHNob3VsZCBiZSBzcGxpdCB1cCBpbiB0aGUgZnV0dXJlLgoJLy8gQFRPRE8gVGhlcmUgc2hvdWxkIGJlIGEgdXRmOC1zdHJpY3QgZW5jb2RpbmcgdGhhdCByZWplY3RzIGludmFsaWQgVVRGLTggY29kZQoJLy8gcG9pbnRzIGFzIHVzZWQgYnkgQ0VTVS04LgoJdmFyIFN0cmluZ0RlY29kZXIgPSBleHBvcnRzLlN0cmluZ0RlY29kZXIgPSBmdW5jdGlvbihlbmNvZGluZykgewoJICB0aGlzLmVuY29kaW5nID0gKGVuY29kaW5nIHx8ICd1dGY4JykudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bLV9dLywgJycpOwoJICBhc3NlcnRFbmNvZGluZyhlbmNvZGluZyk7CgkgIHN3aXRjaCAodGhpcy5lbmNvZGluZykgewoJICAgIGNhc2UgJ3V0ZjgnOgoJICAgICAgLy8gQ0VTVS04IHJlcHJlc2VudHMgZWFjaCBvZiBTdXJyb2dhdGUgUGFpciBieSAzLWJ5dGVzCgkgICAgICB0aGlzLnN1cnJvZ2F0ZVNpemUgPSAzOwoJICAgICAgYnJlYWs7CgkgICAgY2FzZSAndWNzMic6CgkgICAgY2FzZSAndXRmMTZsZSc6CgkgICAgICAvLyBVVEYtMTYgcmVwcmVzZW50cyBlYWNoIG9mIFN1cnJvZ2F0ZSBQYWlyIGJ5IDItYnl0ZXMKCSAgICAgIHRoaXMuc3Vycm9nYXRlU2l6ZSA9IDI7CgkgICAgICB0aGlzLmRldGVjdEluY29tcGxldGVDaGFyID0gdXRmMTZEZXRlY3RJbmNvbXBsZXRlQ2hhcjsKCSAgICAgIGJyZWFrOwoJICAgIGNhc2UgJ2Jhc2U2NCc6CgkgICAgICAvLyBCYXNlLTY0IHN0b3JlcyAzIGJ5dGVzIGluIDQgY2hhcnMsIGFuZCBwYWRzIHRoZSByZW1haW5kZXIuCgkgICAgICB0aGlzLnN1cnJvZ2F0ZVNpemUgPSAzOwoJICAgICAgdGhpcy5kZXRlY3RJbmNvbXBsZXRlQ2hhciA9IGJhc2U2NERldGVjdEluY29tcGxldGVDaGFyOwoJICAgICAgYnJlYWs7CgkgICAgZGVmYXVsdDoKCSAgICAgIHRoaXMud3JpdGUgPSBwYXNzVGhyb3VnaFdyaXRlOwoJICAgICAgcmV0dXJuOwoJICB9CgoJICAvLyBFbm91Z2ggc3BhY2UgdG8gc3RvcmUgYWxsIGJ5dGVzIG9mIGEgc2luZ2xlIGNoYXJhY3Rlci4gVVRGLTggbmVlZHMgNAoJICAvLyBieXRlcywgYnV0IENFU1UtOCBtYXkgcmVxdWlyZSB1cCB0byA2ICgzIGJ5dGVzIHBlciBzdXJyb2dhdGUpLgoJICB0aGlzLmNoYXJCdWZmZXIgPSBuZXcgQnVmZmVyKDYpOwoJICAvLyBOdW1iZXIgb2YgYnl0ZXMgcmVjZWl2ZWQgZm9yIHRoZSBjdXJyZW50IGluY29tcGxldGUgbXVsdGktYnl0ZSBjaGFyYWN0ZXIuCgkgIHRoaXMuY2hhclJlY2VpdmVkID0gMDsKCSAgLy8gTnVtYmVyIG9mIGJ5dGVzIGV4cGVjdGVkIGZvciB0aGUgY3VycmVudCBpbmNvbXBsZXRlIG11bHRpLWJ5dGUgY2hhcmFjdGVyLgoJICB0aGlzLmNoYXJMZW5ndGggPSAwOwoJfTsKCgoJLy8gd3JpdGUgZGVjb2RlcyB0aGUgZ2l2ZW4gYnVmZmVyIGFuZCByZXR1cm5zIGl0IGFzIEpTIHN0cmluZyB0aGF0IGlzCgkvLyBndWFyYW50ZWVkIHRvIG5vdCBjb250YWluIGFueSBwYXJ0aWFsIG11bHRpLWJ5dGUgY2hhcmFjdGVycy4gQW55IHBhcnRpYWwKCS8vIGNoYXJhY3RlciBmb3VuZCBhdCB0aGUgZW5kIG9mIHRoZSBidWZmZXIgaXMgYnVmZmVyZWQgdXAsIGFuZCB3aWxsIGJlCgkvLyByZXR1cm5lZCB3aGVuIGNhbGxpbmcgd3JpdGUgYWdhaW4gd2l0aCB0aGUgcmVtYWluaW5nIGJ5dGVzLgoJLy8KCS8vIE5vdGU6IENvbnZlcnRpbmcgYSBCdWZmZXIgY29udGFpbmluZyBhbiBvcnBoYW4gc3Vycm9nYXRlIHRvIGEgU3RyaW5nCgkvLyBjdXJyZW50bHkgd29ya3MsIGJ1dCBjb252ZXJ0aW5nIGEgU3RyaW5nIHRvIGEgQnVmZmVyICh2aWEgYG5ldyBCdWZmZXJgLCBvcgoJLy8gQnVmZmVyI3dyaXRlKSB3aWxsIHJlcGxhY2UgaW5jb21wbGV0ZSBzdXJyb2dhdGVzIHdpdGggdGhlIHVuaWNvZGUKCS8vIHJlcGxhY2VtZW50IGNoYXJhY3Rlci4gU2VlIGh0dHBzOi8vY29kZXJldmlldy5jaHJvbWl1bS5vcmcvMTIxMTczMDA5LyAuCglTdHJpbmdEZWNvZGVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uKGJ1ZmZlcikgewoJICB2YXIgY2hhclN0ciA9ICcnOwoJICAvLyBpZiBvdXIgbGFzdCB3cml0ZSBlbmRlZCB3aXRoIGFuIGluY29tcGxldGUgbXVsdGlieXRlIGNoYXJhY3RlcgoJICB3aGlsZSAodGhpcy5jaGFyTGVuZ3RoKSB7CgkgICAgLy8gZGV0ZXJtaW5lIGhvdyBtYW55IHJlbWFpbmluZyBieXRlcyB0aGlzIGJ1ZmZlciBoYXMgdG8gb2ZmZXIgZm9yIHRoaXMgY2hhcgoJICAgIHZhciBhdmFpbGFibGUgPSAoYnVmZmVyLmxlbmd0aCA+PSB0aGlzLmNoYXJMZW5ndGggLSB0aGlzLmNoYXJSZWNlaXZlZCkgPwoJICAgICAgICB0aGlzLmNoYXJMZW5ndGggLSB0aGlzLmNoYXJSZWNlaXZlZCA6CgkgICAgICAgIGJ1ZmZlci5sZW5ndGg7CgoJICAgIC8vIGFkZCB0aGUgbmV3IGJ5dGVzIHRvIHRoZSBjaGFyIGJ1ZmZlcgoJICAgIGJ1ZmZlci5jb3B5KHRoaXMuY2hhckJ1ZmZlciwgdGhpcy5jaGFyUmVjZWl2ZWQsIDAsIGF2YWlsYWJsZSk7CgkgICAgdGhpcy5jaGFyUmVjZWl2ZWQgKz0gYXZhaWxhYmxlOwoKCSAgICBpZiAodGhpcy5jaGFyUmVjZWl2ZWQgPCB0aGlzLmNoYXJMZW5ndGgpIHsKCSAgICAgIC8vIHN0aWxsIG5vdCBlbm91Z2ggY2hhcnMgaW4gdGhpcyBidWZmZXI/IHdhaXQgZm9yIG1vcmUgLi4uCgkgICAgICByZXR1cm4gJyc7CgkgICAgfQoKCSAgICAvLyByZW1vdmUgYnl0ZXMgYmVsb25naW5nIHRvIHRoZSBjdXJyZW50IGNoYXJhY3RlciBmcm9tIHRoZSBidWZmZXIKCSAgICBidWZmZXIgPSBidWZmZXIuc2xpY2UoYXZhaWxhYmxlLCBidWZmZXIubGVuZ3RoKTsKCgkgICAgLy8gZ2V0IHRoZSBjaGFyYWN0ZXIgdGhhdCB3YXMgc3BsaXQKCSAgICBjaGFyU3RyID0gdGhpcy5jaGFyQnVmZmVyLnNsaWNlKDAsIHRoaXMuY2hhckxlbmd0aCkudG9TdHJpbmcodGhpcy5lbmNvZGluZyk7CgoJICAgIC8vIENFU1UtODogbGVhZCBzdXJyb2dhdGUgKEQ4MDAtREJGRikgaXMgYWxzbyB0aGUgaW5jb21wbGV0ZSBjaGFyYWN0ZXIKCSAgICB2YXIgY2hhckNvZGUgPSBjaGFyU3RyLmNoYXJDb2RlQXQoY2hhclN0ci5sZW5ndGggLSAxKTsKCSAgICBpZiAoY2hhckNvZGUgPj0gMHhEODAwICYmIGNoYXJDb2RlIDw9IDB4REJGRikgewoJICAgICAgdGhpcy5jaGFyTGVuZ3RoICs9IHRoaXMuc3Vycm9nYXRlU2l6ZTsKCSAgICAgIGNoYXJTdHIgPSAnJzsKCSAgICAgIGNvbnRpbnVlOwoJICAgIH0KCSAgICB0aGlzLmNoYXJSZWNlaXZlZCA9IHRoaXMuY2hhckxlbmd0aCA9IDA7CgoJICAgIC8vIGlmIHRoZXJlIGFyZSBubyBtb3JlIGJ5dGVzIGluIHRoaXMgYnVmZmVyLCBqdXN0IGVtaXQgb3VyIGNoYXIKCSAgICBpZiAoYnVmZmVyLmxlbmd0aCA9PT0gMCkgewoJICAgICAgcmV0dXJuIGNoYXJTdHI7CgkgICAgfQoJICAgIGJyZWFrOwoJICB9CgoJICAvLyBkZXRlcm1pbmUgYW5kIHNldCBjaGFyTGVuZ3RoIC8gY2hhclJlY2VpdmVkCgkgIHRoaXMuZGV0ZWN0SW5jb21wbGV0ZUNoYXIoYnVmZmVyKTsKCgkgIHZhciBlbmQgPSBidWZmZXIubGVuZ3RoOwoJICBpZiAodGhpcy5jaGFyTGVuZ3RoKSB7CgkgICAgLy8gYnVmZmVyIHRoZSBpbmNvbXBsZXRlIGNoYXJhY3RlciBieXRlcyB3ZSBnb3QKCSAgICBidWZmZXIuY29weSh0aGlzLmNoYXJCdWZmZXIsIDAsIGJ1ZmZlci5sZW5ndGggLSB0aGlzLmNoYXJSZWNlaXZlZCwgZW5kKTsKCSAgICBlbmQgLT0gdGhpcy5jaGFyUmVjZWl2ZWQ7CgkgIH0KCgkgIGNoYXJTdHIgKz0gYnVmZmVyLnRvU3RyaW5nKHRoaXMuZW5jb2RpbmcsIDAsIGVuZCk7CgoJICB2YXIgZW5kID0gY2hhclN0ci5sZW5ndGggLSAxOwoJICB2YXIgY2hhckNvZGUgPSBjaGFyU3RyLmNoYXJDb2RlQXQoZW5kKTsKCSAgLy8gQ0VTVS04OiBsZWFkIHN1cnJvZ2F0ZSAoRDgwMC1EQkZGKSBpcyBhbHNvIHRoZSBpbmNvbXBsZXRlIGNoYXJhY3RlcgoJICBpZiAoY2hhckNvZGUgPj0gMHhEODAwICYmIGNoYXJDb2RlIDw9IDB4REJGRikgewoJICAgIHZhciBzaXplID0gdGhpcy5zdXJyb2dhdGVTaXplOwoJICAgIHRoaXMuY2hhckxlbmd0aCArPSBzaXplOwoJICAgIHRoaXMuY2hhclJlY2VpdmVkICs9IHNpemU7CgkgICAgdGhpcy5jaGFyQnVmZmVyLmNvcHkodGhpcy5jaGFyQnVmZmVyLCBzaXplLCAwLCBzaXplKTsKCSAgICBidWZmZXIuY29weSh0aGlzLmNoYXJCdWZmZXIsIDAsIDAsIHNpemUpOwoJICAgIHJldHVybiBjaGFyU3RyLnN1YnN0cmluZygwLCBlbmQpOwoJICB9CgoJICAvLyBvciBqdXN0IGVtaXQgdGhlIGNoYXJTdHIKCSAgcmV0dXJuIGNoYXJTdHI7Cgl9OwoKCS8vIGRldGVjdEluY29tcGxldGVDaGFyIGRldGVybWluZXMgaWYgdGhlcmUgaXMgYW4gaW5jb21wbGV0ZSBVVEYtOCBjaGFyYWN0ZXIgYXQKCS8vIHRoZSBlbmQgb2YgdGhlIGdpdmVuIGJ1ZmZlci4gSWYgc28sIGl0IHNldHMgdGhpcy5jaGFyTGVuZ3RoIHRvIHRoZSBieXRlCgkvLyBsZW5ndGggdGhhdCBjaGFyYWN0ZXIsIGFuZCBzZXRzIHRoaXMuY2hhclJlY2VpdmVkIHRvIHRoZSBudW1iZXIgb2YgYnl0ZXMKCS8vIHRoYXQgYXJlIGF2YWlsYWJsZSBmb3IgdGhpcyBjaGFyYWN0ZXIuCglTdHJpbmdEZWNvZGVyLnByb3RvdHlwZS5kZXRlY3RJbmNvbXBsZXRlQ2hhciA9IGZ1bmN0aW9uKGJ1ZmZlcikgewoJICAvLyBkZXRlcm1pbmUgaG93IG1hbnkgYnl0ZXMgd2UgaGF2ZSB0byBjaGVjayBhdCB0aGUgZW5kIG9mIHRoaXMgYnVmZmVyCgkgIHZhciBpID0gKGJ1ZmZlci5sZW5ndGggPj0gMykgPyAzIDogYnVmZmVyLmxlbmd0aDsKCgkgIC8vIEZpZ3VyZSBvdXQgaWYgb25lIG9mIHRoZSBsYXN0IGkgYnl0ZXMgb2Ygb3VyIGJ1ZmZlciBhbm5vdW5jZXMgYW4KCSAgLy8gaW5jb21wbGV0ZSBjaGFyLgoJICBmb3IgKDsgaSA+IDA7IGktLSkgewoJICAgIHZhciBjID0gYnVmZmVyW2J1ZmZlci5sZW5ndGggLSBpXTsKCgkgICAgLy8gU2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVVRGLTgjRGVzY3JpcHRpb24KCgkgICAgLy8gMTEwWFhYWFgKCSAgICBpZiAoaSA9PSAxICYmIGMgPj4gNSA9PSAweDA2KSB7CgkgICAgICB0aGlzLmNoYXJMZW5ndGggPSAyOwoJICAgICAgYnJlYWs7CgkgICAgfQoKCSAgICAvLyAxMTEwWFhYWAoJICAgIGlmIChpIDw9IDIgJiYgYyA+PiA0ID09IDB4MEUpIHsKCSAgICAgIHRoaXMuY2hhckxlbmd0aCA9IDM7CgkgICAgICBicmVhazsKCSAgICB9CgoJICAgIC8vIDExMTEwWFhYCgkgICAgaWYgKGkgPD0gMyAmJiBjID4+IDMgPT0gMHgxRSkgewoJICAgICAgdGhpcy5jaGFyTGVuZ3RoID0gNDsKCSAgICAgIGJyZWFrOwoJICAgIH0KCSAgfQoJICB0aGlzLmNoYXJSZWNlaXZlZCA9IGk7Cgl9OwoKCVN0cmluZ0RlY29kZXIucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uKGJ1ZmZlcikgewoJICB2YXIgcmVzID0gJyc7CgkgIGlmIChidWZmZXIgJiYgYnVmZmVyLmxlbmd0aCkKCSAgICByZXMgPSB0aGlzLndyaXRlKGJ1ZmZlcik7CgoJICBpZiAodGhpcy5jaGFyUmVjZWl2ZWQpIHsKCSAgICB2YXIgY3IgPSB0aGlzLmNoYXJSZWNlaXZlZDsKCSAgICB2YXIgYnVmID0gdGhpcy5jaGFyQnVmZmVyOwoJICAgIHZhciBlbmMgPSB0aGlzLmVuY29kaW5nOwoJICAgIHJlcyArPSBidWYuc2xpY2UoMCwgY3IpLnRvU3RyaW5nKGVuYyk7CgkgIH0KCgkgIHJldHVybiByZXM7Cgl9OwoKCWZ1bmN0aW9uIHBhc3NUaHJvdWdoV3JpdGUoYnVmZmVyKSB7CgkgIHJldHVybiBidWZmZXIudG9TdHJpbmcodGhpcy5lbmNvZGluZyk7Cgl9CgoJZnVuY3Rpb24gdXRmMTZEZXRlY3RJbmNvbXBsZXRlQ2hhcihidWZmZXIpIHsKCSAgdGhpcy5jaGFyUmVjZWl2ZWQgPSBidWZmZXIubGVuZ3RoICUgMjsKCSAgdGhpcy5jaGFyTGVuZ3RoID0gdGhpcy5jaGFyUmVjZWl2ZWQgPyAyIDogMDsKCX0KCglmdW5jdGlvbiBiYXNlNjREZXRlY3RJbmNvbXBsZXRlQ2hhcihidWZmZXIpIHsKCSAgdGhpcy5jaGFyUmVjZWl2ZWQgPSBidWZmZXIubGVuZ3RoICUgMzsKCSAgdGhpcy5jaGFyTGVuZ3RoID0gdGhpcy5jaGFyUmVjZWl2ZWQgPyAzIDogMDsKCX0KCgovKioqLyB9LAovKiAzMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpCgoKLyoqKi8gfSwKLyogMzMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KQoKCi8qKiovIH0sCi8qIDM0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGEgdHJhbnNmb3JtIHN0cmVhbSBpcyBhIHJlYWRhYmxlL3dyaXRhYmxlIHN0cmVhbSB3aGVyZSB5b3UgZG8KCS8vIHNvbWV0aGluZyB3aXRoIHRoZSBkYXRhLiAgU29tZXRpbWVzIGl0J3MgY2FsbGVkIGEgImZpbHRlciIsCgkvLyBidXQgdGhhdCdzIG5vdCBhIGdyZWF0IG5hbWUgZm9yIGl0LCBzaW5jZSB0aGF0IGltcGxpZXMgYSB0aGluZyB3aGVyZQoJLy8gc29tZSBiaXRzIHBhc3MgdGhyb3VnaCwgYW5kIG90aGVycyBhcmUgc2ltcGx5IGlnbm9yZWQuICAoVGhhdCB3b3VsZAoJLy8gYmUgYSB2YWxpZCBleGFtcGxlIG9mIGEgdHJhbnNmb3JtLCBvZiBjb3Vyc2UuKQoJLy8KCS8vIFdoaWxlIHRoZSBvdXRwdXQgaXMgY2F1c2FsbHkgcmVsYXRlZCB0byB0aGUgaW5wdXQsIGl0J3Mgbm90IGEKCS8vIG5lY2Vzc2FyaWx5IHN5bW1ldHJpYyBvciBzeW5jaHJvbm91cyB0cmFuc2Zvcm1hdGlvbi4gIEZvciBleGFtcGxlLAoJLy8gYSB6bGliIHN0cmVhbSBtaWdodCB0YWtlIG11bHRpcGxlIHBsYWluLXRleHQgd3JpdGVzKCksIGFuZCB0aGVuCgkvLyBlbWl0IGEgc2luZ2xlIGNvbXByZXNzZWQgY2h1bmsgc29tZSB0aW1lIGluIHRoZSBmdXR1cmUuCgkvLwoJLy8gSGVyZSdzIGhvdyB0aGlzIHdvcmtzOgoJLy8KCS8vIFRoZSBUcmFuc2Zvcm0gc3RyZWFtIGhhcyBhbGwgdGhlIGFzcGVjdHMgb2YgdGhlIHJlYWRhYmxlIGFuZCB3cml0YWJsZQoJLy8gc3RyZWFtIGNsYXNzZXMuICBXaGVuIHlvdSB3cml0ZShjaHVuayksIHRoYXQgY2FsbHMgX3dyaXRlKGNodW5rLGNiKQoJLy8gaW50ZXJuYWxseSwgYW5kIHJldHVybnMgZmFsc2UgaWYgdGhlcmUncyBhIGxvdCBvZiBwZW5kaW5nIHdyaXRlcwoJLy8gYnVmZmVyZWQgdXAuICBXaGVuIHlvdSBjYWxsIHJlYWQoKSwgdGhhdCBjYWxscyBfcmVhZChuKSB1bnRpbAoJLy8gdGhlcmUncyBlbm91Z2ggcGVuZGluZyByZWFkYWJsZSBkYXRhIGJ1ZmZlcmVkIHVwLgoJLy8KCS8vIEluIGEgdHJhbnNmb3JtIHN0cmVhbSwgdGhlIHdyaXR0ZW4gZGF0YSBpcyBwbGFjZWQgaW4gYSBidWZmZXIuICBXaGVuCgkvLyBfcmVhZChuKSBpcyBjYWxsZWQsIGl0IHRyYW5zZm9ybXMgdGhlIHF1ZXVlZCB1cCBkYXRhLCBjYWxsaW5nIHRoZQoJLy8gYnVmZmVyZWQgX3dyaXRlIGNiJ3MgYXMgaXQgY29uc3VtZXMgY2h1bmtzLiAgSWYgY29uc3VtaW5nIGEgc2luZ2xlCgkvLyB3cml0dGVuIGNodW5rIHdvdWxkIHJlc3VsdCBpbiBtdWx0aXBsZSBvdXRwdXQgY2h1bmtzLCB0aGVuIHRoZSBmaXJzdAoJLy8gb3V0cHV0dGVkIGJpdCBjYWxscyB0aGUgcmVhZGNiLCBhbmQgc3Vic2VxdWVudCBjaHVua3MganVzdCBnbyBpbnRvCgkvLyB0aGUgcmVhZCBidWZmZXIsIGFuZCB3aWxsIGNhdXNlIGl0IHRvIGVtaXQgJ3JlYWRhYmxlJyBpZiBuZWNlc3NhcnkuCgkvLwoJLy8gVGhpcyB3YXksIGJhY2stcHJlc3N1cmUgaXMgYWN0dWFsbHkgZGV0ZXJtaW5lZCBieSB0aGUgcmVhZGluZyBzaWRlLAoJLy8gc2luY2UgX3JlYWQgaGFzIHRvIGJlIGNhbGxlZCB0byBzdGFydCBwcm9jZXNzaW5nIGEgbmV3IGNodW5rLiAgSG93ZXZlciwKCS8vIGEgcGF0aG9sb2dpY2FsIGluZmxhdGUgdHlwZSBvZiB0cmFuc2Zvcm0gY2FuIGNhdXNlIGV4Y2Vzc2l2ZSBidWZmZXJpbmcKCS8vIGhlcmUuICBGb3IgZXhhbXBsZSwgaW1hZ2luZSBhIHN0cmVhbSB3aGVyZSBldmVyeSBieXRlIG9mIGlucHV0IGlzCgkvLyBpbnRlcnByZXRlZCBhcyBhbiBpbnRlZ2VyIGZyb20gMC0yNTUsIGFuZCB0aGVuIHJlc3VsdHMgaW4gdGhhdCBtYW55CgkvLyBieXRlcyBvZiBvdXRwdXQuICBXcml0aW5nIHRoZSA0IGJ5dGVzIHtmZixmZixmZixmZn0gd291bGQgcmVzdWx0IGluCgkvLyAxa2Igb2YgZGF0YSBiZWluZyBvdXRwdXQuICBJbiB0aGlzIGNhc2UsIHlvdSBjb3VsZCB3cml0ZSBhIHZlcnkgc21hbGwKCS8vIGFtb3VudCBvZiBpbnB1dCwgYW5kIGVuZCB1cCB3aXRoIGEgdmVyeSBsYXJnZSBhbW91bnQgb2Ygb3V0cHV0LiAgSW4KCS8vIHN1Y2ggYSBwYXRob2xvZ2ljYWwgaW5mbGF0aW5nIG1lY2hhbmlzbSwgdGhlcmUnZCBiZSBubyB3YXkgdG8gdGVsbAoJLy8gdGhlIHN5c3RlbSB0byBzdG9wIGRvaW5nIHRoZSB0cmFuc2Zvcm0uICBBIHNpbmdsZSA0TUIgd3JpdGUgY291bGQKCS8vIGNhdXNlIHRoZSBzeXN0ZW0gdG8gcnVuIG91dCBvZiBtZW1vcnkuCgkvLwoJLy8gSG93ZXZlciwgZXZlbiBpbiBzdWNoIGEgcGF0aG9sb2dpY2FsIGNhc2UsIG9ubHkgYSBzaW5nbGUgd3JpdHRlbiBjaHVuawoJLy8gd291bGQgYmUgY29uc3VtZWQsIGFuZCB0aGVuIHRoZSByZXN0IHdvdWxkIHdhaXQgKHVuLXRyYW5zZm9ybWVkKSB1bnRpbAoJLy8gdGhlIHJlc3VsdHMgb2YgdGhlIHByZXZpb3VzIHRyYW5zZm9ybWVkIGNodW5rIHdlcmUgY29uc3VtZWQuCgoJJ3VzZSBzdHJpY3QnOwoKCW1vZHVsZS5leHBvcnRzID0gVHJhbnNmb3JtOwoKCXZhciBEdXBsZXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTsKCgkvKjxyZXBsYWNlbWVudD4qLwoJdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTsKCXV0aWwuaW5oZXJpdHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KTsKCS8qPC9yZXBsYWNlbWVudD4qLwoKCXV0aWwuaW5oZXJpdHMoVHJhbnNmb3JtLCBEdXBsZXgpOwoKCWZ1bmN0aW9uIFRyYW5zZm9ybVN0YXRlKHN0cmVhbSkgewoJICB0aGlzLmFmdGVyVHJhbnNmb3JtID0gZnVuY3Rpb24gKGVyLCBkYXRhKSB7CgkgICAgcmV0dXJuIGFmdGVyVHJhbnNmb3JtKHN0cmVhbSwgZXIsIGRhdGEpOwoJICB9OwoKCSAgdGhpcy5uZWVkVHJhbnNmb3JtID0gZmFsc2U7CgkgIHRoaXMudHJhbnNmb3JtaW5nID0gZmFsc2U7CgkgIHRoaXMud3JpdGVjYiA9IG51bGw7CgkgIHRoaXMud3JpdGVjaHVuayA9IG51bGw7CgkgIHRoaXMud3JpdGVlbmNvZGluZyA9IG51bGw7Cgl9CgoJZnVuY3Rpb24gYWZ0ZXJUcmFuc2Zvcm0oc3RyZWFtLCBlciwgZGF0YSkgewoJICB2YXIgdHMgPSBzdHJlYW0uX3RyYW5zZm9ybVN0YXRlOwoJICB0cy50cmFuc2Zvcm1pbmcgPSBmYWxzZTsKCgkgIHZhciBjYiA9IHRzLndyaXRlY2I7CgoJICBpZiAoIWNiKSByZXR1cm4gc3RyZWFtLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdubyB3cml0ZWNiIGluIFRyYW5zZm9ybSBjbGFzcycpKTsKCgkgIHRzLndyaXRlY2h1bmsgPSBudWxsOwoJICB0cy53cml0ZWNiID0gbnVsbDsKCgkgIGlmIChkYXRhICE9PSBudWxsICYmIGRhdGEgIT09IHVuZGVmaW5lZCkgc3RyZWFtLnB1c2goZGF0YSk7CgoJICBjYihlcik7CgoJICB2YXIgcnMgPSBzdHJlYW0uX3JlYWRhYmxlU3RhdGU7CgkgIHJzLnJlYWRpbmcgPSBmYWxzZTsKCSAgaWYgKHJzLm5lZWRSZWFkYWJsZSB8fCBycy5sZW5ndGggPCBycy5oaWdoV2F0ZXJNYXJrKSB7CgkgICAgc3RyZWFtLl9yZWFkKHJzLmhpZ2hXYXRlck1hcmspOwoJICB9Cgl9CgoJZnVuY3Rpb24gVHJhbnNmb3JtKG9wdGlvbnMpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFRyYW5zZm9ybSkpIHJldHVybiBuZXcgVHJhbnNmb3JtKG9wdGlvbnMpOwoKCSAgRHVwbGV4LmNhbGwodGhpcywgb3B0aW9ucyk7CgoJICB0aGlzLl90cmFuc2Zvcm1TdGF0ZSA9IG5ldyBUcmFuc2Zvcm1TdGF0ZSh0aGlzKTsKCgkgIHZhciBzdHJlYW0gPSB0aGlzOwoKCSAgLy8gc3RhcnQgb3V0IGFza2luZyBmb3IgYSByZWFkYWJsZSBldmVudCBvbmNlIGRhdGEgaXMgdHJhbnNmb3JtZWQuCgkgIHRoaXMuX3JlYWRhYmxlU3RhdGUubmVlZFJlYWRhYmxlID0gdHJ1ZTsKCgkgIC8vIHdlIGhhdmUgaW1wbGVtZW50ZWQgdGhlIF9yZWFkIG1ldGhvZCwgYW5kIGRvbmUgdGhlIG90aGVyIHRoaW5ncwoJICAvLyB0aGF0IFJlYWRhYmxlIHdhbnRzIGJlZm9yZSB0aGUgZmlyc3QgX3JlYWQgY2FsbCwgc28gdW5zZXQgdGhlCgkgIC8vIHN5bmMgZ3VhcmQgZmxhZy4KCSAgdGhpcy5fcmVhZGFibGVTdGF0ZS5zeW5jID0gZmFsc2U7CgoJICBpZiAob3B0aW9ucykgewoJICAgIGlmICh0eXBlb2Ygb3B0aW9ucy50cmFuc2Zvcm0gPT09ICdmdW5jdGlvbicpIHRoaXMuX3RyYW5zZm9ybSA9IG9wdGlvbnMudHJhbnNmb3JtOwoKCSAgICBpZiAodHlwZW9mIG9wdGlvbnMuZmx1c2ggPT09ICdmdW5jdGlvbicpIHRoaXMuX2ZsdXNoID0gb3B0aW9ucy5mbHVzaDsKCSAgfQoKCSAgLy8gV2hlbiB0aGUgd3JpdGFibGUgc2lkZSBmaW5pc2hlcywgdGhlbiBmbHVzaCBvdXQgYW55dGhpbmcgcmVtYWluaW5nLgoJICB0aGlzLm9uY2UoJ3ByZWZpbmlzaCcsIGZ1bmN0aW9uICgpIHsKCSAgICBpZiAodHlwZW9mIHRoaXMuX2ZsdXNoID09PSAnZnVuY3Rpb24nKSB0aGlzLl9mbHVzaChmdW5jdGlvbiAoZXIsIGRhdGEpIHsKCSAgICAgIGRvbmUoc3RyZWFtLCBlciwgZGF0YSk7CgkgICAgfSk7ZWxzZSBkb25lKHN0cmVhbSk7CgkgIH0pOwoJfQoKCVRyYW5zZm9ybS5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcpIHsKCSAgdGhpcy5fdHJhbnNmb3JtU3RhdGUubmVlZFRyYW5zZm9ybSA9IGZhbHNlOwoJICByZXR1cm4gRHVwbGV4LnByb3RvdHlwZS5wdXNoLmNhbGwodGhpcywgY2h1bmssIGVuY29kaW5nKTsKCX07CgoJLy8gVGhpcyBpcyB0aGUgcGFydCB3aGVyZSB5b3UgZG8gc3R1ZmYhCgkvLyBvdmVycmlkZSB0aGlzIGZ1bmN0aW9uIGluIGltcGxlbWVudGF0aW9uIGNsYXNzZXMuCgkvLyAnY2h1bmsnIGlzIGFuIGlucHV0IGNodW5rLgoJLy8KCS8vIENhbGwgYHB1c2gobmV3Q2h1bmspYCB0byBwYXNzIGFsb25nIHRyYW5zZm9ybWVkIG91dHB1dAoJLy8gdG8gdGhlIHJlYWRhYmxlIHNpZGUuICBZb3UgbWF5IGNhbGwgJ3B1c2gnIHplcm8gb3IgbW9yZSB0aW1lcy4KCS8vCgkvLyBDYWxsIGBjYihlcnIpYCB3aGVuIHlvdSBhcmUgZG9uZSB3aXRoIHRoaXMgY2h1bmsuICBJZiB5b3UgcGFzcwoJLy8gYW4gZXJyb3IsIHRoZW4gdGhhdCdsbCBwdXQgdGhlIGh1cnQgb24gdGhlIHdob2xlIG9wZXJhdGlvbi4gIElmIHlvdQoJLy8gbmV2ZXIgY2FsbCBjYigpLCB0aGVuIHlvdSdsbCBuZXZlciBnZXQgYW5vdGhlciBjaHVuay4KCVRyYW5zZm9ybS5wcm90b3R5cGUuX3RyYW5zZm9ybSA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIHRocm93IG5ldyBFcnJvcignX3RyYW5zZm9ybSgpIGlzIG5vdCBpbXBsZW1lbnRlZCcpOwoJfTsKCglUcmFuc2Zvcm0ucHJvdG90eXBlLl93cml0ZSA9IGZ1bmN0aW9uIChjaHVuaywgZW5jb2RpbmcsIGNiKSB7CgkgIHZhciB0cyA9IHRoaXMuX3RyYW5zZm9ybVN0YXRlOwoJICB0cy53cml0ZWNiID0gY2I7CgkgIHRzLndyaXRlY2h1bmsgPSBjaHVuazsKCSAgdHMud3JpdGVlbmNvZGluZyA9IGVuY29kaW5nOwoJICBpZiAoIXRzLnRyYW5zZm9ybWluZykgewoJICAgIHZhciBycyA9IHRoaXMuX3JlYWRhYmxlU3RhdGU7CgkgICAgaWYgKHRzLm5lZWRUcmFuc2Zvcm0gfHwgcnMubmVlZFJlYWRhYmxlIHx8IHJzLmxlbmd0aCA8IHJzLmhpZ2hXYXRlck1hcmspIHRoaXMuX3JlYWQocnMuaGlnaFdhdGVyTWFyayk7CgkgIH0KCX07CgoJLy8gRG9lc24ndCBtYXR0ZXIgd2hhdCB0aGUgYXJncyBhcmUgaGVyZS4KCS8vIF90cmFuc2Zvcm0gZG9lcyBhbGwgdGhlIHdvcmsuCgkvLyBUaGF0IHdlIGdvdCBoZXJlIG1lYW5zIHRoYXQgdGhlIHJlYWRhYmxlIHNpZGUgd2FudHMgbW9yZSBkYXRhLgoJVHJhbnNmb3JtLnByb3RvdHlwZS5fcmVhZCA9IGZ1bmN0aW9uIChuKSB7CgkgIHZhciB0cyA9IHRoaXMuX3RyYW5zZm9ybVN0YXRlOwoKCSAgaWYgKHRzLndyaXRlY2h1bmsgIT09IG51bGwgJiYgdHMud3JpdGVjYiAmJiAhdHMudHJhbnNmb3JtaW5nKSB7CgkgICAgdHMudHJhbnNmb3JtaW5nID0gdHJ1ZTsKCSAgICB0aGlzLl90cmFuc2Zvcm0odHMud3JpdGVjaHVuaywgdHMud3JpdGVlbmNvZGluZywgdHMuYWZ0ZXJUcmFuc2Zvcm0pOwoJICB9IGVsc2UgewoJICAgIC8vIG1hcmsgdGhhdCB3ZSBuZWVkIGEgdHJhbnNmb3JtLCBzbyB0aGF0IGFueSBkYXRhIHRoYXQgY29tZXMgaW4KCSAgICAvLyB3aWxsIGdldCBwcm9jZXNzZWQsIG5vdyB0aGF0IHdlJ3ZlIGFza2VkIGZvciBpdC4KCSAgICB0cy5uZWVkVHJhbnNmb3JtID0gdHJ1ZTsKCSAgfQoJfTsKCglmdW5jdGlvbiBkb25lKHN0cmVhbSwgZXIsIGRhdGEpIHsKCSAgaWYgKGVyKSByZXR1cm4gc3RyZWFtLmVtaXQoJ2Vycm9yJywgZXIpOwoKCSAgaWYgKGRhdGEgIT09IG51bGwgJiYgZGF0YSAhPT0gdW5kZWZpbmVkKSBzdHJlYW0ucHVzaChkYXRhKTsKCgkgIC8vIGlmIHRoZXJlJ3Mgbm90aGluZyBpbiB0aGUgd3JpdGUgYnVmZmVyLCB0aGVuIHRoYXQgbWVhbnMKCSAgLy8gdGhhdCBub3RoaW5nIG1vcmUgd2lsbCBldmVyIGJlIHByb3ZpZGVkCgkgIHZhciB3cyA9IHN0cmVhbS5fd3JpdGFibGVTdGF0ZTsKCSAgdmFyIHRzID0gc3RyZWFtLl90cmFuc2Zvcm1TdGF0ZTsKCgkgIGlmICh3cy5sZW5ndGgpIHRocm93IG5ldyBFcnJvcignQ2FsbGluZyB0cmFuc2Zvcm0gZG9uZSB3aGVuIHdzLmxlbmd0aCAhPSAwJyk7CgoJICBpZiAodHMudHJhbnNmb3JtaW5nKSB0aHJvdyBuZXcgRXJyb3IoJ0NhbGxpbmcgdHJhbnNmb3JtIGRvbmUgd2hlbiBzdGlsbCB0cmFuc2Zvcm1pbmcnKTsKCgkgIHJldHVybiBzdHJlYW0ucHVzaChudWxsKTsKCX0KCi8qKiovIH0sCi8qIDM1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNikKCgovKioqLyB9LAovKiAzNiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBhIHBhc3N0aHJvdWdoIHN0cmVhbS4KCS8vIGJhc2ljYWxseSBqdXN0IHRoZSBtb3N0IG1pbmltYWwgc29ydCBvZiBUcmFuc2Zvcm0gc3RyZWFtLgoJLy8gRXZlcnkgd3JpdHRlbiBjaHVuayBnZXRzIG91dHB1dCBhcy1pcy4KCgkndXNlIHN0cmljdCc7CgoJbW9kdWxlLmV4cG9ydHMgPSBQYXNzVGhyb3VnaDsKCgl2YXIgVHJhbnNmb3JtID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNCk7CgoJLyo8cmVwbGFjZW1lbnQ+Ki8KCXZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cgl1dGlsLmluaGVyaXRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CgkvKjwvcmVwbGFjZW1lbnQ+Ki8KCgl1dGlsLmluaGVyaXRzKFBhc3NUaHJvdWdoLCBUcmFuc2Zvcm0pOwoKCWZ1bmN0aW9uIFBhc3NUaHJvdWdoKG9wdGlvbnMpIHsKCSAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFBhc3NUaHJvdWdoKSkgcmV0dXJuIG5ldyBQYXNzVGhyb3VnaChvcHRpb25zKTsKCgkgIFRyYW5zZm9ybS5jYWxsKHRoaXMsIG9wdGlvbnMpOwoJfQoKCVBhc3NUaHJvdWdoLnByb3RvdHlwZS5fdHJhbnNmb3JtID0gZnVuY3Rpb24gKGNodW5rLCBlbmNvZGluZywgY2IpIHsKCSAgY2IobnVsbCwgY2h1bmspOwoJfTsKCi8qKiovIH0sCi8qIDM3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBCdWZmZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpLkJ1ZmZlcgoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGJ1ZikgewoJCS8vIElmIHRoZSBidWZmZXIgaXMgYmFja2VkIGJ5IGEgVWludDhBcnJheSwgYSBmYXN0ZXIgdmVyc2lvbiB3aWxsIHdvcmsKCQlpZiAoYnVmIGluc3RhbmNlb2YgVWludDhBcnJheSkgewoJCQkvLyBJZiB0aGUgYnVmZmVyIGlzbid0IGEgc3ViYXJyYXksIHJldHVybiB0aGUgdW5kZXJseWluZyBBcnJheUJ1ZmZlcgoJCQlpZiAoYnVmLmJ5dGVPZmZzZXQgPT09IDAgJiYgYnVmLmJ5dGVMZW5ndGggPT09IGJ1Zi5idWZmZXIuYnl0ZUxlbmd0aCkgewoJCQkJcmV0dXJuIGJ1Zi5idWZmZXIKCQkJfSBlbHNlIGlmICh0eXBlb2YgYnVmLmJ1ZmZlci5zbGljZSA9PT0gJ2Z1bmN0aW9uJykgewoJCQkJLy8gT3RoZXJ3aXNlIHdlIG5lZWQgdG8gZ2V0IGEgcHJvcGVyIGNvcHkKCQkJCXJldHVybiBidWYuYnVmZmVyLnNsaWNlKGJ1Zi5ieXRlT2Zmc2V0LCBidWYuYnl0ZU9mZnNldCArIGJ1Zi5ieXRlTGVuZ3RoKQoJCQl9CgkJfQoKCQlpZiAoQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHsKCQkJLy8gVGhpcyBpcyB0aGUgc2xvdyB2ZXJzaW9uIHRoYXQgd2lsbCB3b3JrIHdpdGggYW55IEJ1ZmZlcgoJCQkvLyBpbXBsZW1lbnRhdGlvbiAoZXZlbiBpbiBvbGQgYnJvd3NlcnMpCgkJCXZhciBhcnJheUNvcHkgPSBuZXcgVWludDhBcnJheShidWYubGVuZ3RoKQoJCQl2YXIgbGVuID0gYnVmLmxlbmd0aAoJCQlmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CgkJCQlhcnJheUNvcHlbaV0gPSBidWZbaV0KCQkJfQoJCQlyZXR1cm4gYXJyYXlDb3B5LmJ1ZmZlcgoJCX0gZWxzZSB7CgkJCXRocm93IG5ldyBFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpCgkJfQoJfQoKCi8qKiovIH0sCi8qIDM4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZXh0ZW5kCgoJdmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsKCglmdW5jdGlvbiBleHRlbmQoKSB7CgkgICAgdmFyIHRhcmdldCA9IHt9CgoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0KCgkgICAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsKCSAgICAgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgewoJICAgICAgICAgICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCgkgICAgcmV0dXJuIHRhcmdldAoJfQoKCi8qKiovIH0sCi8qIDM5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gewoJICAiMTAwIjogIkNvbnRpbnVlIiwKCSAgIjEwMSI6ICJTd2l0Y2hpbmcgUHJvdG9jb2xzIiwKCSAgIjEwMiI6ICJQcm9jZXNzaW5nIiwKCSAgIjIwMCI6ICJPSyIsCgkgICIyMDEiOiAiQ3JlYXRlZCIsCgkgICIyMDIiOiAiQWNjZXB0ZWQiLAoJICAiMjAzIjogIk5vbi1BdXRob3JpdGF0aXZlIEluZm9ybWF0aW9uIiwKCSAgIjIwNCI6ICJObyBDb250ZW50IiwKCSAgIjIwNSI6ICJSZXNldCBDb250ZW50IiwKCSAgIjIwNiI6ICJQYXJ0aWFsIENvbnRlbnQiLAoJICAiMjA3IjogIk11bHRpLVN0YXR1cyIsCgkgICIyMDgiOiAiQWxyZWFkeSBSZXBvcnRlZCIsCgkgICIyMjYiOiAiSU0gVXNlZCIsCgkgICIzMDAiOiAiTXVsdGlwbGUgQ2hvaWNlcyIsCgkgICIzMDEiOiAiTW92ZWQgUGVybWFuZW50bHkiLAoJICAiMzAyIjogIkZvdW5kIiwKCSAgIjMwMyI6ICJTZWUgT3RoZXIiLAoJICAiMzA0IjogIk5vdCBNb2RpZmllZCIsCgkgICIzMDUiOiAiVXNlIFByb3h5IiwKCSAgIjMwNyI6ICJUZW1wb3JhcnkgUmVkaXJlY3QiLAoJICAiMzA4IjogIlBlcm1hbmVudCBSZWRpcmVjdCIsCgkgICI0MDAiOiAiQmFkIFJlcXVlc3QiLAoJICAiNDAxIjogIlVuYXV0aG9yaXplZCIsCgkgICI0MDIiOiAiUGF5bWVudCBSZXF1aXJlZCIsCgkgICI0MDMiOiAiRm9yYmlkZGVuIiwKCSAgIjQwNCI6ICJOb3QgRm91bmQiLAoJICAiNDA1IjogIk1ldGhvZCBOb3QgQWxsb3dlZCIsCgkgICI0MDYiOiAiTm90IEFjY2VwdGFibGUiLAoJICAiNDA3IjogIlByb3h5IEF1dGhlbnRpY2F0aW9uIFJlcXVpcmVkIiwKCSAgIjQwOCI6ICJSZXF1ZXN0IFRpbWVvdXQiLAoJICAiNDA5IjogIkNvbmZsaWN0IiwKCSAgIjQxMCI6ICJHb25lIiwKCSAgIjQxMSI6ICJMZW5ndGggUmVxdWlyZWQiLAoJICAiNDEyIjogIlByZWNvbmRpdGlvbiBGYWlsZWQiLAoJICAiNDEzIjogIlBheWxvYWQgVG9vIExhcmdlIiwKCSAgIjQxNCI6ICJVUkkgVG9vIExvbmciLAoJICAiNDE1IjogIlVuc3VwcG9ydGVkIE1lZGlhIFR5cGUiLAoJICAiNDE2IjogIlJhbmdlIE5vdCBTYXRpc2ZpYWJsZSIsCgkgICI0MTciOiAiRXhwZWN0YXRpb24gRmFpbGVkIiwKCSAgIjQxOCI6ICJJJ20gYSB0ZWFwb3QiLAoJICAiNDIxIjogIk1pc2RpcmVjdGVkIFJlcXVlc3QiLAoJICAiNDIyIjogIlVucHJvY2Vzc2FibGUgRW50aXR5IiwKCSAgIjQyMyI6ICJMb2NrZWQiLAoJICAiNDI0IjogIkZhaWxlZCBEZXBlbmRlbmN5IiwKCSAgIjQyNSI6ICJVbm9yZGVyZWQgQ29sbGVjdGlvbiIsCgkgICI0MjYiOiAiVXBncmFkZSBSZXF1aXJlZCIsCgkgICI0MjgiOiAiUHJlY29uZGl0aW9uIFJlcXVpcmVkIiwKCSAgIjQyOSI6ICJUb28gTWFueSBSZXF1ZXN0cyIsCgkgICI0MzEiOiAiUmVxdWVzdCBIZWFkZXIgRmllbGRzIFRvbyBMYXJnZSIsCgkgICI0NTEiOiAiVW5hdmFpbGFibGUgRm9yIExlZ2FsIFJlYXNvbnMiLAoJICAiNTAwIjogIkludGVybmFsIFNlcnZlciBFcnJvciIsCgkgICI1MDEiOiAiTm90IEltcGxlbWVudGVkIiwKCSAgIjUwMiI6ICJCYWQgR2F0ZXdheSIsCgkgICI1MDMiOiAiU2VydmljZSBVbmF2YWlsYWJsZSIsCgkgICI1MDQiOiAiR2F0ZXdheSBUaW1lb3V0IiwKCSAgIjUwNSI6ICJIVFRQIFZlcnNpb24gTm90IFN1cHBvcnRlZCIsCgkgICI1MDYiOiAiVmFyaWFudCBBbHNvIE5lZ290aWF0ZXMiLAoJICAiNTA3IjogIkluc3VmZmljaWVudCBTdG9yYWdlIiwKCSAgIjUwOCI6ICJMb29wIERldGVjdGVkIiwKCSAgIjUwOSI6ICJCYW5kd2lkdGggTGltaXQgRXhjZWVkZWQiLAoJICAiNTEwIjogIk5vdCBFeHRlbmRlZCIsCgkgICI1MTEiOiAiTmV0d29yayBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCIKCX0KCgovKioqLyB9LAovKiA0MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCSd1c2Ugc3RyaWN0JzsKCgl2YXIgcHVueWNvZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQxKTsKCXZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Myk7CgoJZXhwb3J0cy5wYXJzZSA9IHVybFBhcnNlOwoJZXhwb3J0cy5yZXNvbHZlID0gdXJsUmVzb2x2ZTsKCWV4cG9ydHMucmVzb2x2ZU9iamVjdCA9IHVybFJlc29sdmVPYmplY3Q7CglleHBvcnRzLmZvcm1hdCA9IHVybEZvcm1hdDsKCglleHBvcnRzLlVybCA9IFVybDsKCglmdW5jdGlvbiBVcmwoKSB7CgkgIHRoaXMucHJvdG9jb2wgPSBudWxsOwoJICB0aGlzLnNsYXNoZXMgPSBudWxsOwoJICB0aGlzLmF1dGggPSBudWxsOwoJICB0aGlzLmhvc3QgPSBudWxsOwoJICB0aGlzLnBvcnQgPSBudWxsOwoJICB0aGlzLmhvc3RuYW1lID0gbnVsbDsKCSAgdGhpcy5oYXNoID0gbnVsbDsKCSAgdGhpcy5zZWFyY2ggPSBudWxsOwoJICB0aGlzLnF1ZXJ5ID0gbnVsbDsKCSAgdGhpcy5wYXRobmFtZSA9IG51bGw7CgkgIHRoaXMucGF0aCA9IG51bGw7CgkgIHRoaXMuaHJlZiA9IG51bGw7Cgl9CgoJLy8gUmVmZXJlbmNlOiBSRkMgMzk4NiwgUkZDIDE4MDgsIFJGQyAyMzk2CgoJLy8gZGVmaW5lIHRoZXNlIGhlcmUgc28gYXQgbGVhc3QgdGhleSBvbmx5IGhhdmUgdG8gYmUKCS8vIGNvbXBpbGVkIG9uY2Ugb24gdGhlIGZpcnN0IG1vZHVsZSBsb2FkLgoJdmFyIHByb3RvY29sUGF0dGVybiA9IC9eKFthLXowLTkuKy1dKzopL2ksCgkgICAgcG9ydFBhdHRlcm4gPSAvOlswLTldKiQvLAoKCSAgICAvLyBTcGVjaWFsIGNhc2UgZm9yIGEgc2ltcGxlIHBhdGggVVJMCgkgICAgc2ltcGxlUGF0aFBhdHRlcm4gPSAvXihcL1wvPyg/IVwvKVteXD9cc10qKShcP1teXHNdKik/JC8sCgoJICAgIC8vIFJGQyAyMzk2OiBjaGFyYWN0ZXJzIHJlc2VydmVkIGZvciBkZWxpbWl0aW5nIFVSTHMuCgkgICAgLy8gV2UgYWN0dWFsbHkganVzdCBhdXRvLWVzY2FwZSB0aGVzZS4KCSAgICBkZWxpbXMgPSBbJzwnLCAnPicsICciJywgJ2AnLCAnICcsICdccicsICdcbicsICdcdCddLAoKCSAgICAvLyBSRkMgMjM5NjogY2hhcmFjdGVycyBub3QgYWxsb3dlZCBmb3IgdmFyaW91cyByZWFzb25zLgoJICAgIHVud2lzZSA9IFsneycsICd9JywgJ3wnLCAnXFwnLCAnXicsICdgJ10uY29uY2F0KGRlbGltcyksCgoJICAgIC8vIEFsbG93ZWQgYnkgUkZDcywgYnV0IGNhdXNlIG9mIFhTUyBhdHRhY2tzLiAgQWx3YXlzIGVzY2FwZSB0aGVzZS4KCSAgICBhdXRvRXNjYXBlID0gWydcJyddLmNvbmNhdCh1bndpc2UpLAoJICAgIC8vIENoYXJhY3RlcnMgdGhhdCBhcmUgbmV2ZXIgZXZlciBhbGxvd2VkIGluIGEgaG9zdG5hbWUuCgkgICAgLy8gTm90ZSB0aGF0IGFueSBpbnZhbGlkIGNoYXJzIGFyZSBhbHNvIGhhbmRsZWQsIGJ1dCB0aGVzZQoJICAgIC8vIGFyZSB0aGUgb25lcyB0aGF0IGFyZSAqZXhwZWN0ZWQqIHRvIGJlIHNlZW4sIHNvIHdlIGZhc3QtcGF0aAoJICAgIC8vIHRoZW0uCgkgICAgbm9uSG9zdENoYXJzID0gWyclJywgJy8nLCAnPycsICc7JywgJyMnXS5jb25jYXQoYXV0b0VzY2FwZSksCgkgICAgaG9zdEVuZGluZ0NoYXJzID0gWycvJywgJz8nLCAnIyddLAoJICAgIGhvc3RuYW1lTWF4TGVuID0gMjU1LAoJICAgIGhvc3RuYW1lUGFydFBhdHRlcm4gPSAvXlsrYS16MC05QS1aXy1dezAsNjN9JC8sCgkgICAgaG9zdG5hbWVQYXJ0U3RhcnQgPSAvXihbK2EtejAtOUEtWl8tXXswLDYzfSkoLiopJC8sCgkgICAgLy8gcHJvdG9jb2xzIHRoYXQgY2FuIGFsbG93ICJ1bnNhZmUiIGFuZCAidW53aXNlIiBjaGFycy4KCSAgICB1bnNhZmVQcm90b2NvbCA9IHsKCSAgICAgICdqYXZhc2NyaXB0JzogdHJ1ZSwKCSAgICAgICdqYXZhc2NyaXB0Oic6IHRydWUKCSAgICB9LAoJICAgIC8vIHByb3RvY29scyB0aGF0IG5ldmVyIGhhdmUgYSBob3N0bmFtZS4KCSAgICBob3N0bGVzc1Byb3RvY29sID0gewoJICAgICAgJ2phdmFzY3JpcHQnOiB0cnVlLAoJICAgICAgJ2phdmFzY3JpcHQ6JzogdHJ1ZQoJICAgIH0sCgkgICAgLy8gcHJvdG9jb2xzIHRoYXQgYWx3YXlzIGNvbnRhaW4gYSAvLyBiaXQuCgkgICAgc2xhc2hlZFByb3RvY29sID0gewoJICAgICAgJ2h0dHAnOiB0cnVlLAoJICAgICAgJ2h0dHBzJzogdHJ1ZSwKCSAgICAgICdmdHAnOiB0cnVlLAoJICAgICAgJ2dvcGhlcic6IHRydWUsCgkgICAgICAnZmlsZSc6IHRydWUsCgkgICAgICAnaHR0cDonOiB0cnVlLAoJICAgICAgJ2h0dHBzOic6IHRydWUsCgkgICAgICAnZnRwOic6IHRydWUsCgkgICAgICAnZ29waGVyOic6IHRydWUsCgkgICAgICAnZmlsZTonOiB0cnVlCgkgICAgfSwKCSAgICBxdWVyeXN0cmluZyA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpOwoKCWZ1bmN0aW9uIHVybFBhcnNlKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpIHsKCSAgaWYgKHVybCAmJiB1dGlsLmlzT2JqZWN0KHVybCkgJiYgdXJsIGluc3RhbmNlb2YgVXJsKSByZXR1cm4gdXJsOwoKCSAgdmFyIHUgPSBuZXcgVXJsOwoJICB1LnBhcnNlKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpOwoJICByZXR1cm4gdTsKCX0KCglVcmwucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24odXJsLCBwYXJzZVF1ZXJ5U3RyaW5nLCBzbGFzaGVzRGVub3RlSG9zdCkgewoJICBpZiAoIXV0aWwuaXNTdHJpbmcodXJsKSkgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlBhcmFtZXRlciAndXJsJyBtdXN0IGJlIGEgc3RyaW5nLCBub3QgIiArIHR5cGVvZiB1cmwpOwoJICB9CgoJICAvLyBDb3B5IGNocm9tZSwgSUUsIG9wZXJhIGJhY2tzbGFzaC1oYW5kbGluZyBiZWhhdmlvci4KCSAgLy8gQmFjayBzbGFzaGVzIGJlZm9yZSB0aGUgcXVlcnkgc3RyaW5nIGdldCBjb252ZXJ0ZWQgdG8gZm9yd2FyZCBzbGFzaGVzCgkgIC8vIFNlZTogaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTI1OTE2CgkgIHZhciBxdWVyeUluZGV4ID0gdXJsLmluZGV4T2YoJz8nKSwKCSAgICAgIHNwbGl0dGVyID0KCSAgICAgICAgICAocXVlcnlJbmRleCAhPT0gLTEgJiYgcXVlcnlJbmRleCA8IHVybC5pbmRleE9mKCcjJykpID8gJz8nIDogJyMnLAoJICAgICAgdVNwbGl0ID0gdXJsLnNwbGl0KHNwbGl0dGVyKSwKCSAgICAgIHNsYXNoUmVnZXggPSAvXFwvZzsKCSAgdVNwbGl0WzBdID0gdVNwbGl0WzBdLnJlcGxhY2Uoc2xhc2hSZWdleCwgJy8nKTsKCSAgdXJsID0gdVNwbGl0LmpvaW4oc3BsaXR0ZXIpOwoKCSAgdmFyIHJlc3QgPSB1cmw7CgoJICAvLyB0cmltIGJlZm9yZSBwcm9jZWVkaW5nLgoJICAvLyBUaGlzIGlzIHRvIHN1cHBvcnQgcGFyc2Ugc3R1ZmYgbGlrZSAiICBodHRwOi8vZm9vLmNvbSAgXG4iCgkgIHJlc3QgPSByZXN0LnRyaW0oKTsKCgkgIGlmICghc2xhc2hlc0Rlbm90ZUhvc3QgJiYgdXJsLnNwbGl0KCcjJykubGVuZ3RoID09PSAxKSB7CgkgICAgLy8gVHJ5IGZhc3QgcGF0aCByZWdleHAKCSAgICB2YXIgc2ltcGxlUGF0aCA9IHNpbXBsZVBhdGhQYXR0ZXJuLmV4ZWMocmVzdCk7CgkgICAgaWYgKHNpbXBsZVBhdGgpIHsKCSAgICAgIHRoaXMucGF0aCA9IHJlc3Q7CgkgICAgICB0aGlzLmhyZWYgPSByZXN0OwoJICAgICAgdGhpcy5wYXRobmFtZSA9IHNpbXBsZVBhdGhbMV07CgkgICAgICBpZiAoc2ltcGxlUGF0aFsyXSkgewoJICAgICAgICB0aGlzLnNlYXJjaCA9IHNpbXBsZVBhdGhbMl07CgkgICAgICAgIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7CgkgICAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5c3RyaW5nLnBhcnNlKHRoaXMuc2VhcmNoLnN1YnN0cigxKSk7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgdGhpcy5xdWVyeSA9IHRoaXMuc2VhcmNoLnN1YnN0cigxKTsKCSAgICAgICAgfQoJICAgICAgfSBlbHNlIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7CgkgICAgICAgIHRoaXMuc2VhcmNoID0gJyc7CgkgICAgICAgIHRoaXMucXVlcnkgPSB7fTsKCSAgICAgIH0KCSAgICAgIHJldHVybiB0aGlzOwoJICAgIH0KCSAgfQoKCSAgdmFyIHByb3RvID0gcHJvdG9jb2xQYXR0ZXJuLmV4ZWMocmVzdCk7CgkgIGlmIChwcm90bykgewoJICAgIHByb3RvID0gcHJvdG9bMF07CgkgICAgdmFyIGxvd2VyUHJvdG8gPSBwcm90by50b0xvd2VyQ2FzZSgpOwoJICAgIHRoaXMucHJvdG9jb2wgPSBsb3dlclByb3RvOwoJICAgIHJlc3QgPSByZXN0LnN1YnN0cihwcm90by5sZW5ndGgpOwoJICB9CgoJICAvLyBmaWd1cmUgb3V0IGlmIGl0J3MgZ290IGEgaG9zdAoJICAvLyB1c2VyQHNlcnZlciBpcyAqYWx3YXlzKiBpbnRlcnByZXRlZCBhcyBhIGhvc3RuYW1lLCBhbmQgdXJsCgkgIC8vIHJlc29sdXRpb24gd2lsbCB0cmVhdCAvL2Zvby9iYXIgYXMgaG9zdD1mb28scGF0aD1iYXIgYmVjYXVzZSB0aGF0J3MKCSAgLy8gaG93IHRoZSBicm93c2VyIHJlc29sdmVzIHJlbGF0aXZlIFVSTHMuCgkgIGlmIChzbGFzaGVzRGVub3RlSG9zdCB8fCBwcm90byB8fCByZXN0Lm1hdGNoKC9eXC9cL1teQFwvXStAW15AXC9dKy8pKSB7CgkgICAgdmFyIHNsYXNoZXMgPSByZXN0LnN1YnN0cigwLCAyKSA9PT0gJy8vJzsKCSAgICBpZiAoc2xhc2hlcyAmJiAhKHByb3RvICYmIGhvc3RsZXNzUHJvdG9jb2xbcHJvdG9dKSkgewoJICAgICAgcmVzdCA9IHJlc3Quc3Vic3RyKDIpOwoJICAgICAgdGhpcy5zbGFzaGVzID0gdHJ1ZTsKCSAgICB9CgkgIH0KCgkgIGlmICghaG9zdGxlc3NQcm90b2NvbFtwcm90b10gJiYKCSAgICAgIChzbGFzaGVzIHx8IChwcm90byAmJiAhc2xhc2hlZFByb3RvY29sW3Byb3RvXSkpKSB7CgoJICAgIC8vIHRoZXJlJ3MgYSBob3N0bmFtZS4KCSAgICAvLyB0aGUgZmlyc3QgaW5zdGFuY2Ugb2YgLywgPywgOywgb3IgIyBlbmRzIHRoZSBob3N0LgoJICAgIC8vCgkgICAgLy8gSWYgdGhlcmUgaXMgYW4gQCBpbiB0aGUgaG9zdG5hbWUsIHRoZW4gbm9uLWhvc3QgY2hhcnMgKmFyZSogYWxsb3dlZAoJICAgIC8vIHRvIHRoZSBsZWZ0IG9mIHRoZSBsYXN0IEAgc2lnbiwgdW5sZXNzIHNvbWUgaG9zdC1lbmRpbmcgY2hhcmFjdGVyCgkgICAgLy8gY29tZXMgKmJlZm9yZSogdGhlIEAtc2lnbi4KCSAgICAvLyBVUkxzIGFyZSBvYm5veGlvdXMuCgkgICAgLy8KCSAgICAvLyBleDoKCSAgICAvLyBodHRwOi8vYUBiQGMvID0+IHVzZXI6YUBiIGhvc3Q6YwoJICAgIC8vIGh0dHA6Ly9hQGI/QGMgPT4gdXNlcjphIGhvc3Q6YyBwYXRoOi8/QGMKCgkgICAgLy8gdjAuMTIgVE9ETyhpc2FhY3MpOiBUaGlzIGlzIG5vdCBxdWl0ZSBob3cgQ2hyb21lIGRvZXMgdGhpbmdzLgoJICAgIC8vIFJldmlldyBvdXIgdGVzdCBjYXNlIGFnYWluc3QgYnJvd3NlcnMgbW9yZSBjb21wcmVoZW5zaXZlbHkuCgoJICAgIC8vIGZpbmQgdGhlIGZpcnN0IGluc3RhbmNlIG9mIGFueSBob3N0RW5kaW5nQ2hhcnMKCSAgICB2YXIgaG9zdEVuZCA9IC0xOwoJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaG9zdEVuZGluZ0NoYXJzLmxlbmd0aDsgaSsrKSB7CgkgICAgICB2YXIgaGVjID0gcmVzdC5pbmRleE9mKGhvc3RFbmRpbmdDaGFyc1tpXSk7CgkgICAgICBpZiAoaGVjICE9PSAtMSAmJiAoaG9zdEVuZCA9PT0gLTEgfHwgaGVjIDwgaG9zdEVuZCkpCgkgICAgICAgIGhvc3RFbmQgPSBoZWM7CgkgICAgfQoKCSAgICAvLyBhdCB0aGlzIHBvaW50LCBlaXRoZXIgd2UgaGF2ZSBhbiBleHBsaWNpdCBwb2ludCB3aGVyZSB0aGUKCSAgICAvLyBhdXRoIHBvcnRpb24gY2Fubm90IGdvIHBhc3QsIG9yIHRoZSBsYXN0IEAgY2hhciBpcyB0aGUgZGVjaWRlci4KCSAgICB2YXIgYXV0aCwgYXRTaWduOwoJICAgIGlmIChob3N0RW5kID09PSAtMSkgewoJICAgICAgLy8gYXRTaWduIGNhbiBiZSBhbnl3aGVyZS4KCSAgICAgIGF0U2lnbiA9IHJlc3QubGFzdEluZGV4T2YoJ0AnKTsKCSAgICB9IGVsc2UgewoJICAgICAgLy8gYXRTaWduIG11c3QgYmUgaW4gYXV0aCBwb3J0aW9uLgoJICAgICAgLy8gaHR0cDovL2FAYi9jQGQgPT4gaG9zdDpiIGF1dGg6YSBwYXRoOi9jQGQKCSAgICAgIGF0U2lnbiA9IHJlc3QubGFzdEluZGV4T2YoJ0AnLCBob3N0RW5kKTsKCSAgICB9CgoJICAgIC8vIE5vdyB3ZSBoYXZlIGEgcG9ydGlvbiB3aGljaCBpcyBkZWZpbml0ZWx5IHRoZSBhdXRoLgoJICAgIC8vIFB1bGwgdGhhdCBvZmYuCgkgICAgaWYgKGF0U2lnbiAhPT0gLTEpIHsKCSAgICAgIGF1dGggPSByZXN0LnNsaWNlKDAsIGF0U2lnbik7CgkgICAgICByZXN0ID0gcmVzdC5zbGljZShhdFNpZ24gKyAxKTsKCSAgICAgIHRoaXMuYXV0aCA9IGRlY29kZVVSSUNvbXBvbmVudChhdXRoKTsKCSAgICB9CgoJICAgIC8vIHRoZSBob3N0IGlzIHRoZSByZW1haW5pbmcgdG8gdGhlIGxlZnQgb2YgdGhlIGZpcnN0IG5vbi1ob3N0IGNoYXIKCSAgICBob3N0RW5kID0gLTE7CgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub25Ib3N0Q2hhcnMubGVuZ3RoOyBpKyspIHsKCSAgICAgIHZhciBoZWMgPSByZXN0LmluZGV4T2Yobm9uSG9zdENoYXJzW2ldKTsKCSAgICAgIGlmIChoZWMgIT09IC0xICYmIChob3N0RW5kID09PSAtMSB8fCBoZWMgPCBob3N0RW5kKSkKCSAgICAgICAgaG9zdEVuZCA9IGhlYzsKCSAgICB9CgkgICAgLy8gaWYgd2Ugc3RpbGwgaGF2ZSBub3QgaGl0IGl0LCB0aGVuIHRoZSBlbnRpcmUgdGhpbmcgaXMgYSBob3N0LgoJICAgIGlmIChob3N0RW5kID09PSAtMSkKCSAgICAgIGhvc3RFbmQgPSByZXN0Lmxlbmd0aDsKCgkgICAgdGhpcy5ob3N0ID0gcmVzdC5zbGljZSgwLCBob3N0RW5kKTsKCSAgICByZXN0ID0gcmVzdC5zbGljZShob3N0RW5kKTsKCgkgICAgLy8gcHVsbCBvdXQgcG9ydC4KCSAgICB0aGlzLnBhcnNlSG9zdCgpOwoKCSAgICAvLyB3ZSd2ZSBpbmRpY2F0ZWQgdGhhdCB0aGVyZSBpcyBhIGhvc3RuYW1lLAoJICAgIC8vIHNvIGV2ZW4gaWYgaXQncyBlbXB0eSwgaXQgaGFzIHRvIGJlIHByZXNlbnQuCgkgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUgfHwgJyc7CgoJICAgIC8vIGlmIGhvc3RuYW1lIGJlZ2lucyB3aXRoIFsgYW5kIGVuZHMgd2l0aCBdCgkgICAgLy8gYXNzdW1lIHRoYXQgaXQncyBhbiBJUHY2IGFkZHJlc3MuCgkgICAgdmFyIGlwdjZIb3N0bmFtZSA9IHRoaXMuaG9zdG5hbWVbMF0gPT09ICdbJyAmJgoJICAgICAgICB0aGlzLmhvc3RuYW1lW3RoaXMuaG9zdG5hbWUubGVuZ3RoIC0gMV0gPT09ICddJzsKCgkgICAgLy8gdmFsaWRhdGUgYSBsaXR0bGUuCgkgICAgaWYgKCFpcHY2SG9zdG5hbWUpIHsKCSAgICAgIHZhciBob3N0cGFydHMgPSB0aGlzLmhvc3RuYW1lLnNwbGl0KC9cLi8pOwoJICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBob3N0cGFydHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgICAgIHZhciBwYXJ0ID0gaG9zdHBhcnRzW2ldOwoJICAgICAgICBpZiAoIXBhcnQpIGNvbnRpbnVlOwoJICAgICAgICBpZiAoIXBhcnQubWF0Y2goaG9zdG5hbWVQYXJ0UGF0dGVybikpIHsKCSAgICAgICAgICB2YXIgbmV3cGFydCA9ICcnOwoJICAgICAgICAgIGZvciAodmFyIGogPSAwLCBrID0gcGFydC5sZW5ndGg7IGogPCBrOyBqKyspIHsKCSAgICAgICAgICAgIGlmIChwYXJ0LmNoYXJDb2RlQXQoaikgPiAxMjcpIHsKCSAgICAgICAgICAgICAgLy8gd2UgcmVwbGFjZSBub24tQVNDSUkgY2hhciB3aXRoIGEgdGVtcG9yYXJ5IHBsYWNlaG9sZGVyCgkgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdGhpcyB0byBtYWtlIHN1cmUgc2l6ZSBvZiBob3N0bmFtZSBpcyBub3QKCSAgICAgICAgICAgICAgLy8gYnJva2VuIGJ5IHJlcGxhY2luZyBub24tQVNDSUkgYnkgbm90aGluZwoJICAgICAgICAgICAgICBuZXdwYXJ0ICs9ICd4JzsKCSAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgIG5ld3BhcnQgKz0gcGFydFtqXTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgICAgLy8gd2UgdGVzdCBhZ2FpbiB3aXRoIEFTQ0lJIGNoYXIgb25seQoJICAgICAgICAgIGlmICghbmV3cGFydC5tYXRjaChob3N0bmFtZVBhcnRQYXR0ZXJuKSkgewoJICAgICAgICAgICAgdmFyIHZhbGlkUGFydHMgPSBob3N0cGFydHMuc2xpY2UoMCwgaSk7CgkgICAgICAgICAgICB2YXIgbm90SG9zdCA9IGhvc3RwYXJ0cy5zbGljZShpICsgMSk7CgkgICAgICAgICAgICB2YXIgYml0ID0gcGFydC5tYXRjaChob3N0bmFtZVBhcnRTdGFydCk7CgkgICAgICAgICAgICBpZiAoYml0KSB7CgkgICAgICAgICAgICAgIHZhbGlkUGFydHMucHVzaChiaXRbMV0pOwoJICAgICAgICAgICAgICBub3RIb3N0LnVuc2hpZnQoYml0WzJdKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChub3RIb3N0Lmxlbmd0aCkgewoJICAgICAgICAgICAgICByZXN0ID0gJy8nICsgbm90SG9zdC5qb2luKCcuJykgKyByZXN0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdGhpcy5ob3N0bmFtZSA9IHZhbGlkUGFydHMuam9pbignLicpOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICB9CgkgICAgfQoKCSAgICBpZiAodGhpcy5ob3N0bmFtZS5sZW5ndGggPiBob3N0bmFtZU1heExlbikgewoJICAgICAgdGhpcy5ob3N0bmFtZSA9ICcnOwoJICAgIH0gZWxzZSB7CgkgICAgICAvLyBob3N0bmFtZXMgYXJlIGFsd2F5cyBsb3dlciBjYXNlLgoJICAgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTsKCSAgICB9CgoJICAgIGlmICghaXB2Nkhvc3RuYW1lKSB7CgkgICAgICAvLyBJRE5BIFN1cHBvcnQ6IFJldHVybnMgYSBwdW55Y29kZWQgcmVwcmVzZW50YXRpb24gb2YgImRvbWFpbiIuCgkgICAgICAvLyBJdCBvbmx5IGNvbnZlcnRzIHBhcnRzIG9mIHRoZSBkb21haW4gbmFtZSB0aGF0CgkgICAgICAvLyBoYXZlIG5vbi1BU0NJSSBjaGFyYWN0ZXJzLCBpLmUuIGl0IGRvZXNuJ3QgbWF0dGVyIGlmCgkgICAgICAvLyB5b3UgY2FsbCBpdCB3aXRoIGEgZG9tYWluIHRoYXQgYWxyZWFkeSBpcyBBU0NJSS1vbmx5LgoJICAgICAgdGhpcy5ob3N0bmFtZSA9IHB1bnljb2RlLnRvQVNDSUkodGhpcy5ob3N0bmFtZSk7CgkgICAgfQoKCSAgICB2YXIgcCA9IHRoaXMucG9ydCA/ICc6JyArIHRoaXMucG9ydCA6ICcnOwoJICAgIHZhciBoID0gdGhpcy5ob3N0bmFtZSB8fCAnJzsKCSAgICB0aGlzLmhvc3QgPSBoICsgcDsKCSAgICB0aGlzLmhyZWYgKz0gdGhpcy5ob3N0OwoKCSAgICAvLyBzdHJpcCBbIGFuZCBdIGZyb20gdGhlIGhvc3RuYW1lCgkgICAgLy8gdGhlIGhvc3QgZmllbGQgc3RpbGwgcmV0YWlucyB0aGVtLCB0aG91Z2gKCSAgICBpZiAoaXB2Nkhvc3RuYW1lKSB7CgkgICAgICB0aGlzLmhvc3RuYW1lID0gdGhpcy5ob3N0bmFtZS5zdWJzdHIoMSwgdGhpcy5ob3N0bmFtZS5sZW5ndGggLSAyKTsKCSAgICAgIGlmIChyZXN0WzBdICE9PSAnLycpIHsKCSAgICAgICAgcmVzdCA9ICcvJyArIHJlc3Q7CgkgICAgICB9CgkgICAgfQoJICB9CgoJICAvLyBub3cgcmVzdCBpcyBzZXQgdG8gdGhlIHBvc3QtaG9zdCBzdHVmZi4KCSAgLy8gY2hvcCBvZmYgYW55IGRlbGltIGNoYXJzLgoJICBpZiAoIXVuc2FmZVByb3RvY29sW2xvd2VyUHJvdG9dKSB7CgoJICAgIC8vIEZpcnN0LCBtYWtlIDEwMCUgc3VyZSB0aGF0IGFueSAiYXV0b0VzY2FwZSIgY2hhcnMgZ2V0CgkgICAgLy8gZXNjYXBlZCwgZXZlbiBpZiBlbmNvZGVVUklDb21wb25lbnQgZG9lc24ndCB0aGluayB0aGV5CgkgICAgLy8gbmVlZCB0byBiZS4KCSAgICBmb3IgKHZhciBpID0gMCwgbCA9IGF1dG9Fc2NhcGUubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CgkgICAgICB2YXIgYWUgPSBhdXRvRXNjYXBlW2ldOwoJICAgICAgaWYgKHJlc3QuaW5kZXhPZihhZSkgPT09IC0xKQoJICAgICAgICBjb250aW51ZTsKCSAgICAgIHZhciBlc2MgPSBlbmNvZGVVUklDb21wb25lbnQoYWUpOwoJICAgICAgaWYgKGVzYyA9PT0gYWUpIHsKCSAgICAgICAgZXNjID0gZXNjYXBlKGFlKTsKCSAgICAgIH0KCSAgICAgIHJlc3QgPSByZXN0LnNwbGl0KGFlKS5qb2luKGVzYyk7CgkgICAgfQoJICB9CgoKCSAgLy8gY2hvcCBvZmYgZnJvbSB0aGUgdGFpbCBmaXJzdC4KCSAgdmFyIGhhc2ggPSByZXN0LmluZGV4T2YoJyMnKTsKCSAgaWYgKGhhc2ggIT09IC0xKSB7CgkgICAgLy8gZ290IGEgZnJhZ21lbnQgc3RyaW5nLgoJICAgIHRoaXMuaGFzaCA9IHJlc3Quc3Vic3RyKGhhc2gpOwoJICAgIHJlc3QgPSByZXN0LnNsaWNlKDAsIGhhc2gpOwoJICB9CgkgIHZhciBxbSA9IHJlc3QuaW5kZXhPZignPycpOwoJICBpZiAocW0gIT09IC0xKSB7CgkgICAgdGhpcy5zZWFyY2ggPSByZXN0LnN1YnN0cihxbSk7CgkgICAgdGhpcy5xdWVyeSA9IHJlc3Quc3Vic3RyKHFtICsgMSk7CgkgICAgaWYgKHBhcnNlUXVlcnlTdHJpbmcpIHsKCSAgICAgIHRoaXMucXVlcnkgPSBxdWVyeXN0cmluZy5wYXJzZSh0aGlzLnF1ZXJ5KTsKCSAgICB9CgkgICAgcmVzdCA9IHJlc3Quc2xpY2UoMCwgcW0pOwoJICB9IGVsc2UgaWYgKHBhcnNlUXVlcnlTdHJpbmcpIHsKCSAgICAvLyBubyBxdWVyeSBzdHJpbmcsIGJ1dCBwYXJzZVF1ZXJ5U3RyaW5nIHN0aWxsIHJlcXVlc3RlZAoJICAgIHRoaXMuc2VhcmNoID0gJyc7CgkgICAgdGhpcy5xdWVyeSA9IHt9OwoJICB9CgkgIGlmIChyZXN0KSB0aGlzLnBhdGhuYW1lID0gcmVzdDsKCSAgaWYgKHNsYXNoZWRQcm90b2NvbFtsb3dlclByb3RvXSAmJgoJICAgICAgdGhpcy5ob3N0bmFtZSAmJiAhdGhpcy5wYXRobmFtZSkgewoJICAgIHRoaXMucGF0aG5hbWUgPSAnLyc7CgkgIH0KCgkgIC8vdG8gc3VwcG9ydCBodHRwLnJlcXVlc3QKCSAgaWYgKHRoaXMucGF0aG5hbWUgfHwgdGhpcy5zZWFyY2gpIHsKCSAgICB2YXIgcCA9IHRoaXMucGF0aG5hbWUgfHwgJyc7CgkgICAgdmFyIHMgPSB0aGlzLnNlYXJjaCB8fCAnJzsKCSAgICB0aGlzLnBhdGggPSBwICsgczsKCSAgfQoKCSAgLy8gZmluYWxseSwgcmVjb25zdHJ1Y3QgdGhlIGhyZWYgYmFzZWQgb24gd2hhdCBoYXMgYmVlbiB2YWxpZGF0ZWQuCgkgIHRoaXMuaHJlZiA9IHRoaXMuZm9ybWF0KCk7CgkgIHJldHVybiB0aGlzOwoJfTsKCgkvLyBmb3JtYXQgYSBwYXJzZWQgb2JqZWN0IGludG8gYSB1cmwgc3RyaW5nCglmdW5jdGlvbiB1cmxGb3JtYXQob2JqKSB7CgkgIC8vIGVuc3VyZSBpdCdzIGFuIG9iamVjdCwgYW5kIG5vdCBhIHN0cmluZyB1cmwuCgkgIC8vIElmIGl0J3MgYW4gb2JqLCB0aGlzIGlzIGEgbm8tb3AuCgkgIC8vIHRoaXMgd2F5LCB5b3UgY2FuIGNhbGwgdXJsX2Zvcm1hdCgpIG9uIHN0cmluZ3MKCSAgLy8gdG8gY2xlYW4gdXAgcG90ZW50aWFsbHkgd29ua3kgdXJscy4KCSAgaWYgKHV0aWwuaXNTdHJpbmcob2JqKSkgb2JqID0gdXJsUGFyc2Uob2JqKTsKCSAgaWYgKCEob2JqIGluc3RhbmNlb2YgVXJsKSkgcmV0dXJuIFVybC5wcm90b3R5cGUuZm9ybWF0LmNhbGwob2JqKTsKCSAgcmV0dXJuIG9iai5mb3JtYXQoKTsKCX0KCglVcmwucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uKCkgewoJICB2YXIgYXV0aCA9IHRoaXMuYXV0aCB8fCAnJzsKCSAgaWYgKGF1dGgpIHsKCSAgICBhdXRoID0gZW5jb2RlVVJJQ29tcG9uZW50KGF1dGgpOwoJICAgIGF1dGggPSBhdXRoLnJlcGxhY2UoLyUzQS9pLCAnOicpOwoJICAgIGF1dGggKz0gJ0AnOwoJICB9CgoJICB2YXIgcHJvdG9jb2wgPSB0aGlzLnByb3RvY29sIHx8ICcnLAoJICAgICAgcGF0aG5hbWUgPSB0aGlzLnBhdGhuYW1lIHx8ICcnLAoJICAgICAgaGFzaCA9IHRoaXMuaGFzaCB8fCAnJywKCSAgICAgIGhvc3QgPSBmYWxzZSwKCSAgICAgIHF1ZXJ5ID0gJyc7CgoJICBpZiAodGhpcy5ob3N0KSB7CgkgICAgaG9zdCA9IGF1dGggKyB0aGlzLmhvc3Q7CgkgIH0gZWxzZSBpZiAodGhpcy5ob3N0bmFtZSkgewoJICAgIGhvc3QgPSBhdXRoICsgKHRoaXMuaG9zdG5hbWUuaW5kZXhPZignOicpID09PSAtMSA/CgkgICAgICAgIHRoaXMuaG9zdG5hbWUgOgoJICAgICAgICAnWycgKyB0aGlzLmhvc3RuYW1lICsgJ10nKTsKCSAgICBpZiAodGhpcy5wb3J0KSB7CgkgICAgICBob3N0ICs9ICc6JyArIHRoaXMucG9ydDsKCSAgICB9CgkgIH0KCgkgIGlmICh0aGlzLnF1ZXJ5ICYmCgkgICAgICB1dGlsLmlzT2JqZWN0KHRoaXMucXVlcnkpICYmCgkgICAgICBPYmplY3Qua2V5cyh0aGlzLnF1ZXJ5KS5sZW5ndGgpIHsKCSAgICBxdWVyeSA9IHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeSh0aGlzLnF1ZXJ5KTsKCSAgfQoKCSAgdmFyIHNlYXJjaCA9IHRoaXMuc2VhcmNoIHx8IChxdWVyeSAmJiAoJz8nICsgcXVlcnkpKSB8fCAnJzsKCgkgIGlmIChwcm90b2NvbCAmJiBwcm90b2NvbC5zdWJzdHIoLTEpICE9PSAnOicpIHByb3RvY29sICs9ICc6JzsKCgkgIC8vIG9ubHkgdGhlIHNsYXNoZWRQcm90b2NvbHMgZ2V0IHRoZSAvLy4gIE5vdCBtYWlsdG86LCB4bXBwOiwgZXRjLgoJICAvLyB1bmxlc3MgdGhleSBoYWQgdGhlbSB0byBiZWdpbiB3aXRoLgoJICBpZiAodGhpcy5zbGFzaGVzIHx8CgkgICAgICAoIXByb3RvY29sIHx8IHNsYXNoZWRQcm90b2NvbFtwcm90b2NvbF0pICYmIGhvc3QgIT09IGZhbHNlKSB7CgkgICAgaG9zdCA9ICcvLycgKyAoaG9zdCB8fCAnJyk7CgkgICAgaWYgKHBhdGhuYW1lICYmIHBhdGhuYW1lLmNoYXJBdCgwKSAhPT0gJy8nKSBwYXRobmFtZSA9ICcvJyArIHBhdGhuYW1lOwoJICB9IGVsc2UgaWYgKCFob3N0KSB7CgkgICAgaG9zdCA9ICcnOwoJICB9CgoJICBpZiAoaGFzaCAmJiBoYXNoLmNoYXJBdCgwKSAhPT0gJyMnKSBoYXNoID0gJyMnICsgaGFzaDsKCSAgaWYgKHNlYXJjaCAmJiBzZWFyY2guY2hhckF0KDApICE9PSAnPycpIHNlYXJjaCA9ICc/JyArIHNlYXJjaDsKCgkgIHBhdGhuYW1lID0gcGF0aG5hbWUucmVwbGFjZSgvWz8jXS9nLCBmdW5jdGlvbihtYXRjaCkgewoJICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQobWF0Y2gpOwoJICB9KTsKCSAgc2VhcmNoID0gc2VhcmNoLnJlcGxhY2UoJyMnLCAnJTIzJyk7CgoJICByZXR1cm4gcHJvdG9jb2wgKyBob3N0ICsgcGF0aG5hbWUgKyBzZWFyY2ggKyBoYXNoOwoJfTsKCglmdW5jdGlvbiB1cmxSZXNvbHZlKHNvdXJjZSwgcmVsYXRpdmUpIHsKCSAgcmV0dXJuIHVybFBhcnNlKHNvdXJjZSwgZmFsc2UsIHRydWUpLnJlc29sdmUocmVsYXRpdmUpOwoJfQoKCVVybC5wcm90b3R5cGUucmVzb2x2ZSA9IGZ1bmN0aW9uKHJlbGF0aXZlKSB7CgkgIHJldHVybiB0aGlzLnJlc29sdmVPYmplY3QodXJsUGFyc2UocmVsYXRpdmUsIGZhbHNlLCB0cnVlKSkuZm9ybWF0KCk7Cgl9OwoKCWZ1bmN0aW9uIHVybFJlc29sdmVPYmplY3Qoc291cmNlLCByZWxhdGl2ZSkgewoJICBpZiAoIXNvdXJjZSkgcmV0dXJuIHJlbGF0aXZlOwoJICByZXR1cm4gdXJsUGFyc2Uoc291cmNlLCBmYWxzZSwgdHJ1ZSkucmVzb2x2ZU9iamVjdChyZWxhdGl2ZSk7Cgl9CgoJVXJsLnByb3RvdHlwZS5yZXNvbHZlT2JqZWN0ID0gZnVuY3Rpb24ocmVsYXRpdmUpIHsKCSAgaWYgKHV0aWwuaXNTdHJpbmcocmVsYXRpdmUpKSB7CgkgICAgdmFyIHJlbCA9IG5ldyBVcmwoKTsKCSAgICByZWwucGFyc2UocmVsYXRpdmUsIGZhbHNlLCB0cnVlKTsKCSAgICByZWxhdGl2ZSA9IHJlbDsKCSAgfQoKCSAgdmFyIHJlc3VsdCA9IG5ldyBVcmwoKTsKCSAgdmFyIHRrZXlzID0gT2JqZWN0LmtleXModGhpcyk7CgkgIGZvciAodmFyIHRrID0gMDsgdGsgPCB0a2V5cy5sZW5ndGg7IHRrKyspIHsKCSAgICB2YXIgdGtleSA9IHRrZXlzW3RrXTsKCSAgICByZXN1bHRbdGtleV0gPSB0aGlzW3RrZXldOwoJICB9CgoJICAvLyBoYXNoIGlzIGFsd2F5cyBvdmVycmlkZGVuLCBubyBtYXR0ZXIgd2hhdC4KCSAgLy8gZXZlbiBocmVmPSIiIHdpbGwgcmVtb3ZlIGl0LgoJICByZXN1bHQuaGFzaCA9IHJlbGF0aXZlLmhhc2g7CgoJICAvLyBpZiB0aGUgcmVsYXRpdmUgdXJsIGlzIGVtcHR5LCB0aGVuIHRoZXJlJ3Mgbm90aGluZyBsZWZ0IHRvIGRvIGhlcmUuCgkgIGlmIChyZWxhdGl2ZS5ocmVmID09PSAnJykgewoJICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpOwoJICAgIHJldHVybiByZXN1bHQ7CgkgIH0KCgkgIC8vIGhyZWZzIGxpa2UgLy9mb28vYmFyIGFsd2F5cyBjdXQgdG8gdGhlIHByb3RvY29sLgoJICBpZiAocmVsYXRpdmUuc2xhc2hlcyAmJiAhcmVsYXRpdmUucHJvdG9jb2wpIHsKCSAgICAvLyB0YWtlIGV2ZXJ5dGhpbmcgZXhjZXB0IHRoZSBwcm90b2NvbCBmcm9tIHJlbGF0aXZlCgkgICAgdmFyIHJrZXlzID0gT2JqZWN0LmtleXMocmVsYXRpdmUpOwoJICAgIGZvciAodmFyIHJrID0gMDsgcmsgPCBya2V5cy5sZW5ndGg7IHJrKyspIHsKCSAgICAgIHZhciBya2V5ID0gcmtleXNbcmtdOwoJICAgICAgaWYgKHJrZXkgIT09ICdwcm90b2NvbCcpCgkgICAgICAgIHJlc3VsdFtya2V5XSA9IHJlbGF0aXZlW3JrZXldOwoJICAgIH0KCgkgICAgLy91cmxQYXJzZSBhcHBlbmRzIHRyYWlsaW5nIC8gdG8gdXJscyBsaWtlIGh0dHA6Ly93d3cuZXhhbXBsZS5jb20KCSAgICBpZiAoc2xhc2hlZFByb3RvY29sW3Jlc3VsdC5wcm90b2NvbF0gJiYKCSAgICAgICAgcmVzdWx0Lmhvc3RuYW1lICYmICFyZXN1bHQucGF0aG5hbWUpIHsKCSAgICAgIHJlc3VsdC5wYXRoID0gcmVzdWx0LnBhdGhuYW1lID0gJy8nOwoJICAgIH0KCgkgICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7CgkgICAgcmV0dXJuIHJlc3VsdDsKCSAgfQoKCSAgaWYgKHJlbGF0aXZlLnByb3RvY29sICYmIHJlbGF0aXZlLnByb3RvY29sICE9PSByZXN1bHQucHJvdG9jb2wpIHsKCSAgICAvLyBpZiBpdCdzIGEga25vd24gdXJsIHByb3RvY29sLCB0aGVuIGNoYW5naW5nCgkgICAgLy8gdGhlIHByb3RvY29sIGRvZXMgd2VpcmQgdGhpbmdzCgkgICAgLy8gZmlyc3QsIGlmIGl0J3Mgbm90IGZpbGU6LCB0aGVuIHdlIE1VU1QgaGF2ZSBhIGhvc3QsCgkgICAgLy8gYW5kIGlmIHRoZXJlIHdhcyBhIHBhdGgKCSAgICAvLyB0byBiZWdpbiB3aXRoLCB0aGVuIHdlIE1VU1QgaGF2ZSBhIHBhdGguCgkgICAgLy8gaWYgaXQgaXMgZmlsZTosIHRoZW4gdGhlIGhvc3QgaXMgZHJvcHBlZCwKCSAgICAvLyBiZWNhdXNlIHRoYXQncyBrbm93biB0byBiZSBob3N0bGVzcy4KCSAgICAvLyBhbnl0aGluZyBlbHNlIGlzIGFzc3VtZWQgdG8gYmUgYWJzb2x1dGUuCgkgICAgaWYgKCFzbGFzaGVkUHJvdG9jb2xbcmVsYXRpdmUucHJvdG9jb2xdKSB7CgkgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHJlbGF0aXZlKTsKCSAgICAgIGZvciAodmFyIHYgPSAwOyB2IDwga2V5cy5sZW5ndGg7IHYrKykgewoJICAgICAgICB2YXIgayA9IGtleXNbdl07CgkgICAgICAgIHJlc3VsdFtrXSA9IHJlbGF0aXZlW2tdOwoJICAgICAgfQoJICAgICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7CgkgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH0KCgkgICAgcmVzdWx0LnByb3RvY29sID0gcmVsYXRpdmUucHJvdG9jb2w7CgkgICAgaWYgKCFyZWxhdGl2ZS5ob3N0ICYmICFob3N0bGVzc1Byb3RvY29sW3JlbGF0aXZlLnByb3RvY29sXSkgewoJICAgICAgdmFyIHJlbFBhdGggPSAocmVsYXRpdmUucGF0aG5hbWUgfHwgJycpLnNwbGl0KCcvJyk7CgkgICAgICB3aGlsZSAocmVsUGF0aC5sZW5ndGggJiYgIShyZWxhdGl2ZS5ob3N0ID0gcmVsUGF0aC5zaGlmdCgpKSk7CgkgICAgICBpZiAoIXJlbGF0aXZlLmhvc3QpIHJlbGF0aXZlLmhvc3QgPSAnJzsKCSAgICAgIGlmICghcmVsYXRpdmUuaG9zdG5hbWUpIHJlbGF0aXZlLmhvc3RuYW1lID0gJyc7CgkgICAgICBpZiAocmVsUGF0aFswXSAhPT0gJycpIHJlbFBhdGgudW5zaGlmdCgnJyk7CgkgICAgICBpZiAocmVsUGF0aC5sZW5ndGggPCAyKSByZWxQYXRoLnVuc2hpZnQoJycpOwoJICAgICAgcmVzdWx0LnBhdGhuYW1lID0gcmVsUGF0aC5qb2luKCcvJyk7CgkgICAgfSBlbHNlIHsKCSAgICAgIHJlc3VsdC5wYXRobmFtZSA9IHJlbGF0aXZlLnBhdGhuYW1lOwoJICAgIH0KCSAgICByZXN1bHQuc2VhcmNoID0gcmVsYXRpdmUuc2VhcmNoOwoJICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5OwoJICAgIHJlc3VsdC5ob3N0ID0gcmVsYXRpdmUuaG9zdCB8fCAnJzsKCSAgICByZXN1bHQuYXV0aCA9IHJlbGF0aXZlLmF1dGg7CgkgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVsYXRpdmUuaG9zdG5hbWUgfHwgcmVsYXRpdmUuaG9zdDsKCSAgICByZXN1bHQucG9ydCA9IHJlbGF0aXZlLnBvcnQ7CgkgICAgLy8gdG8gc3VwcG9ydCBodHRwLnJlcXVlc3QKCSAgICBpZiAocmVzdWx0LnBhdGhuYW1lIHx8IHJlc3VsdC5zZWFyY2gpIHsKCSAgICAgIHZhciBwID0gcmVzdWx0LnBhdGhuYW1lIHx8ICcnOwoJICAgICAgdmFyIHMgPSByZXN1bHQuc2VhcmNoIHx8ICcnOwoJICAgICAgcmVzdWx0LnBhdGggPSBwICsgczsKCSAgICB9CgkgICAgcmVzdWx0LnNsYXNoZXMgPSByZXN1bHQuc2xhc2hlcyB8fCByZWxhdGl2ZS5zbGFzaGVzOwoJICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpOwoJICAgIHJldHVybiByZXN1bHQ7CgkgIH0KCgkgIHZhciBpc1NvdXJjZUFicyA9IChyZXN1bHQucGF0aG5hbWUgJiYgcmVzdWx0LnBhdGhuYW1lLmNoYXJBdCgwKSA9PT0gJy8nKSwKCSAgICAgIGlzUmVsQWJzID0gKAoJICAgICAgICAgIHJlbGF0aXZlLmhvc3QgfHwKCSAgICAgICAgICByZWxhdGl2ZS5wYXRobmFtZSAmJiByZWxhdGl2ZS5wYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJwoJICAgICAgKSwKCSAgICAgIG11c3RFbmRBYnMgPSAoaXNSZWxBYnMgfHwgaXNTb3VyY2VBYnMgfHwKCSAgICAgICAgICAgICAgICAgICAgKHJlc3VsdC5ob3N0ICYmIHJlbGF0aXZlLnBhdGhuYW1lKSksCgkgICAgICByZW1vdmVBbGxEb3RzID0gbXVzdEVuZEFicywKCSAgICAgIHNyY1BhdGggPSByZXN1bHQucGF0aG5hbWUgJiYgcmVzdWx0LnBhdGhuYW1lLnNwbGl0KCcvJykgfHwgW10sCgkgICAgICByZWxQYXRoID0gcmVsYXRpdmUucGF0aG5hbWUgJiYgcmVsYXRpdmUucGF0aG5hbWUuc3BsaXQoJy8nKSB8fCBbXSwKCSAgICAgIHBzeWNob3RpYyA9IHJlc3VsdC5wcm90b2NvbCAmJiAhc2xhc2hlZFByb3RvY29sW3Jlc3VsdC5wcm90b2NvbF07CgoJICAvLyBpZiB0aGUgdXJsIGlzIGEgbm9uLXNsYXNoZWQgdXJsLCB0aGVuIHJlbGF0aXZlCgkgIC8vIGxpbmtzIGxpa2UgLi4vLi4gc2hvdWxkIGJlIGFibGUKCSAgLy8gdG8gY3Jhd2wgdXAgdG8gdGhlIGhvc3RuYW1lLCBhcyB3ZWxsLiAgVGhpcyBpcyBzdHJhbmdlLgoJICAvLyByZXN1bHQucHJvdG9jb2wgaGFzIGFscmVhZHkgYmVlbiBzZXQgYnkgbm93LgoJICAvLyBMYXRlciBvbiwgcHV0IHRoZSBmaXJzdCBwYXRoIHBhcnQgaW50byB0aGUgaG9zdCBmaWVsZC4KCSAgaWYgKHBzeWNob3RpYykgewoJICAgIHJlc3VsdC5ob3N0bmFtZSA9ICcnOwoJICAgIHJlc3VsdC5wb3J0ID0gbnVsbDsKCSAgICBpZiAocmVzdWx0Lmhvc3QpIHsKCSAgICAgIGlmIChzcmNQYXRoWzBdID09PSAnJykgc3JjUGF0aFswXSA9IHJlc3VsdC5ob3N0OwoJICAgICAgZWxzZSBzcmNQYXRoLnVuc2hpZnQocmVzdWx0Lmhvc3QpOwoJICAgIH0KCSAgICByZXN1bHQuaG9zdCA9ICcnOwoJICAgIGlmIChyZWxhdGl2ZS5wcm90b2NvbCkgewoJICAgICAgcmVsYXRpdmUuaG9zdG5hbWUgPSBudWxsOwoJICAgICAgcmVsYXRpdmUucG9ydCA9IG51bGw7CgkgICAgICBpZiAocmVsYXRpdmUuaG9zdCkgewoJICAgICAgICBpZiAocmVsUGF0aFswXSA9PT0gJycpIHJlbFBhdGhbMF0gPSByZWxhdGl2ZS5ob3N0OwoJICAgICAgICBlbHNlIHJlbFBhdGgudW5zaGlmdChyZWxhdGl2ZS5ob3N0KTsKCSAgICAgIH0KCSAgICAgIHJlbGF0aXZlLmhvc3QgPSBudWxsOwoJICAgIH0KCSAgICBtdXN0RW5kQWJzID0gbXVzdEVuZEFicyAmJiAocmVsUGF0aFswXSA9PT0gJycgfHwgc3JjUGF0aFswXSA9PT0gJycpOwoJICB9CgoJICBpZiAoaXNSZWxBYnMpIHsKCSAgICAvLyBpdCdzIGFic29sdXRlLgoJICAgIHJlc3VsdC5ob3N0ID0gKHJlbGF0aXZlLmhvc3QgfHwgcmVsYXRpdmUuaG9zdCA9PT0gJycpID8KCSAgICAgICAgICAgICAgICAgIHJlbGF0aXZlLmhvc3QgOiByZXN1bHQuaG9zdDsKCSAgICByZXN1bHQuaG9zdG5hbWUgPSAocmVsYXRpdmUuaG9zdG5hbWUgfHwgcmVsYXRpdmUuaG9zdG5hbWUgPT09ICcnKSA/CgkgICAgICAgICAgICAgICAgICAgICAgcmVsYXRpdmUuaG9zdG5hbWUgOiByZXN1bHQuaG9zdG5hbWU7CgkgICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDsKCSAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTsKCSAgICBzcmNQYXRoID0gcmVsUGF0aDsKCSAgICAvLyBmYWxsIHRocm91Z2ggdG8gdGhlIGRvdC1oYW5kbGluZyBiZWxvdy4KCSAgfSBlbHNlIGlmIChyZWxQYXRoLmxlbmd0aCkgewoJICAgIC8vIGl0J3MgcmVsYXRpdmUKCSAgICAvLyB0aHJvdyBhd2F5IHRoZSBleGlzdGluZyBmaWxlLCBhbmQgdGFrZSB0aGUgbmV3IHBhdGggaW5zdGVhZC4KCSAgICBpZiAoIXNyY1BhdGgpIHNyY1BhdGggPSBbXTsKCSAgICBzcmNQYXRoLnBvcCgpOwoJICAgIHNyY1BhdGggPSBzcmNQYXRoLmNvbmNhdChyZWxQYXRoKTsKCSAgICByZXN1bHQuc2VhcmNoID0gcmVsYXRpdmUuc2VhcmNoOwoJICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5OwoJICB9IGVsc2UgaWYgKCF1dGlsLmlzTnVsbE9yVW5kZWZpbmVkKHJlbGF0aXZlLnNlYXJjaCkpIHsKCSAgICAvLyBqdXN0IHB1bGwgb3V0IHRoZSBzZWFyY2guCgkgICAgLy8gbGlrZSBocmVmPSc/Zm9vJy4KCSAgICAvLyBQdXQgdGhpcyBhZnRlciB0aGUgb3RoZXIgdHdvIGNhc2VzIGJlY2F1c2UgaXQgc2ltcGxpZmllcyB0aGUgYm9vbGVhbnMKCSAgICBpZiAocHN5Y2hvdGljKSB7CgkgICAgICByZXN1bHQuaG9zdG5hbWUgPSByZXN1bHQuaG9zdCA9IHNyY1BhdGguc2hpZnQoKTsKCSAgICAgIC8vb2NjYXRpb25hbHkgdGhlIGF1dGggY2FuIGdldCBzdHVjayBvbmx5IGluIGhvc3QKCSAgICAgIC8vdGhpcyBlc3BlY2lhbGx5IGhhcHBlbnMgaW4gY2FzZXMgbGlrZQoJICAgICAgLy91cmwucmVzb2x2ZU9iamVjdCgnbWFpbHRvOmxvY2FsMUBkb21haW4xJywgJ2xvY2FsMkBkb21haW4yJykKCSAgICAgIHZhciBhdXRoSW5Ib3N0ID0gcmVzdWx0Lmhvc3QgJiYgcmVzdWx0Lmhvc3QuaW5kZXhPZignQCcpID4gMCA/CgkgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ob3N0LnNwbGl0KCdAJykgOiBmYWxzZTsKCSAgICAgIGlmIChhdXRoSW5Ib3N0KSB7CgkgICAgICAgIHJlc3VsdC5hdXRoID0gYXV0aEluSG9zdC5zaGlmdCgpOwoJICAgICAgICByZXN1bHQuaG9zdCA9IHJlc3VsdC5ob3N0bmFtZSA9IGF1dGhJbkhvc3Quc2hpZnQoKTsKCSAgICAgIH0KCSAgICB9CgkgICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDsKCSAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTsKCSAgICAvL3RvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0CgkgICAgaWYgKCF1dGlsLmlzTnVsbChyZXN1bHQucGF0aG5hbWUpIHx8ICF1dGlsLmlzTnVsbChyZXN1bHQuc2VhcmNoKSkgewoJICAgICAgcmVzdWx0LnBhdGggPSAocmVzdWx0LnBhdGhuYW1lID8gcmVzdWx0LnBhdGhuYW1lIDogJycpICsKCSAgICAgICAgICAgICAgICAgICAgKHJlc3VsdC5zZWFyY2ggPyByZXN1bHQuc2VhcmNoIDogJycpOwoJICAgIH0KCSAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTsKCSAgICByZXR1cm4gcmVzdWx0OwoJICB9CgoJICBpZiAoIXNyY1BhdGgubGVuZ3RoKSB7CgkgICAgLy8gbm8gcGF0aCBhdCBhbGwuICBlYXN5LgoJICAgIC8vIHdlJ3ZlIGFscmVhZHkgaGFuZGxlZCB0aGUgb3RoZXIgc3R1ZmYgYWJvdmUuCgkgICAgcmVzdWx0LnBhdGhuYW1lID0gbnVsbDsKCSAgICAvL3RvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0CgkgICAgaWYgKHJlc3VsdC5zZWFyY2gpIHsKCSAgICAgIHJlc3VsdC5wYXRoID0gJy8nICsgcmVzdWx0LnNlYXJjaDsKCSAgICB9IGVsc2UgewoJICAgICAgcmVzdWx0LnBhdGggPSBudWxsOwoJICAgIH0KCSAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTsKCSAgICByZXR1cm4gcmVzdWx0OwoJICB9CgoJICAvLyBpZiBhIHVybCBFTkRzIGluIC4gb3IgLi4sIHRoZW4gaXQgbXVzdCBnZXQgYSB0cmFpbGluZyBzbGFzaC4KCSAgLy8gaG93ZXZlciwgaWYgaXQgZW5kcyBpbiBhbnl0aGluZyBlbHNlIG5vbi1zbGFzaHksCgkgIC8vIHRoZW4gaXQgbXVzdCBOT1QgZ2V0IGEgdHJhaWxpbmcgc2xhc2guCgkgIHZhciBsYXN0ID0gc3JjUGF0aC5zbGljZSgtMSlbMF07CgkgIHZhciBoYXNUcmFpbGluZ1NsYXNoID0gKAoJICAgICAgKHJlc3VsdC5ob3N0IHx8IHJlbGF0aXZlLmhvc3QgfHwgc3JjUGF0aC5sZW5ndGggPiAxKSAmJgoJICAgICAgKGxhc3QgPT09ICcuJyB8fCBsYXN0ID09PSAnLi4nKSB8fCBsYXN0ID09PSAnJyk7CgoJICAvLyBzdHJpcCBzaW5nbGUgZG90cywgcmVzb2x2ZSBkb3VibGUgZG90cyB0byBwYXJlbnQgZGlyCgkgIC8vIGlmIHRoZSBwYXRoIHRyaWVzIHRvIGdvIGFib3ZlIHRoZSByb290LCBgdXBgIGVuZHMgdXAgPiAwCgkgIHZhciB1cCA9IDA7CgkgIGZvciAodmFyIGkgPSBzcmNQYXRoLmxlbmd0aDsgaSA+PSAwOyBpLS0pIHsKCSAgICBsYXN0ID0gc3JjUGF0aFtpXTsKCSAgICBpZiAobGFzdCA9PT0gJy4nKSB7CgkgICAgICBzcmNQYXRoLnNwbGljZShpLCAxKTsKCSAgICB9IGVsc2UgaWYgKGxhc3QgPT09ICcuLicpIHsKCSAgICAgIHNyY1BhdGguc3BsaWNlKGksIDEpOwoJICAgICAgdXArKzsKCSAgICB9IGVsc2UgaWYgKHVwKSB7CgkgICAgICBzcmNQYXRoLnNwbGljZShpLCAxKTsKCSAgICAgIHVwLS07CgkgICAgfQoJICB9CgoJICAvLyBpZiB0aGUgcGF0aCBpcyBhbGxvd2VkIHRvIGdvIGFib3ZlIHRoZSByb290LCByZXN0b3JlIGxlYWRpbmcgLi5zCgkgIGlmICghbXVzdEVuZEFicyAmJiAhcmVtb3ZlQWxsRG90cykgewoJICAgIGZvciAoOyB1cC0tOyB1cCkgewoJICAgICAgc3JjUGF0aC51bnNoaWZ0KCcuLicpOwoJICAgIH0KCSAgfQoKCSAgaWYgKG11c3RFbmRBYnMgJiYgc3JjUGF0aFswXSAhPT0gJycgJiYKCSAgICAgICghc3JjUGF0aFswXSB8fCBzcmNQYXRoWzBdLmNoYXJBdCgwKSAhPT0gJy8nKSkgewoJICAgIHNyY1BhdGgudW5zaGlmdCgnJyk7CgkgIH0KCgkgIGlmIChoYXNUcmFpbGluZ1NsYXNoICYmIChzcmNQYXRoLmpvaW4oJy8nKS5zdWJzdHIoLTEpICE9PSAnLycpKSB7CgkgICAgc3JjUGF0aC5wdXNoKCcnKTsKCSAgfQoKCSAgdmFyIGlzQWJzb2x1dGUgPSBzcmNQYXRoWzBdID09PSAnJyB8fAoJICAgICAgKHNyY1BhdGhbMF0gJiYgc3JjUGF0aFswXS5jaGFyQXQoMCkgPT09ICcvJyk7CgoJICAvLyBwdXQgdGhlIGhvc3QgYmFjawoJICBpZiAocHN5Y2hvdGljKSB7CgkgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVzdWx0Lmhvc3QgPSBpc0Fic29sdXRlID8gJycgOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjUGF0aC5sZW5ndGggPyBzcmNQYXRoLnNoaWZ0KCkgOiAnJzsKCSAgICAvL29jY2F0aW9uYWx5IHRoZSBhdXRoIGNhbiBnZXQgc3R1Y2sgb25seSBpbiBob3N0CgkgICAgLy90aGlzIGVzcGVjaWFsbHkgaGFwcGVucyBpbiBjYXNlcyBsaWtlCgkgICAgLy91cmwucmVzb2x2ZU9iamVjdCgnbWFpbHRvOmxvY2FsMUBkb21haW4xJywgJ2xvY2FsMkBkb21haW4yJykKCSAgICB2YXIgYXV0aEluSG9zdCA9IHJlc3VsdC5ob3N0ICYmIHJlc3VsdC5ob3N0LmluZGV4T2YoJ0AnKSA+IDAgPwoJICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3Quc3BsaXQoJ0AnKSA6IGZhbHNlOwoJICAgIGlmIChhdXRoSW5Ib3N0KSB7CgkgICAgICByZXN1bHQuYXV0aCA9IGF1dGhJbkhvc3Quc2hpZnQoKTsKCSAgICAgIHJlc3VsdC5ob3N0ID0gcmVzdWx0Lmhvc3RuYW1lID0gYXV0aEluSG9zdC5zaGlmdCgpOwoJICAgIH0KCSAgfQoKCSAgbXVzdEVuZEFicyA9IG11c3RFbmRBYnMgfHwgKHJlc3VsdC5ob3N0ICYmIHNyY1BhdGgubGVuZ3RoKTsKCgkgIGlmIChtdXN0RW5kQWJzICYmICFpc0Fic29sdXRlKSB7CgkgICAgc3JjUGF0aC51bnNoaWZ0KCcnKTsKCSAgfQoKCSAgaWYgKCFzcmNQYXRoLmxlbmd0aCkgewoJICAgIHJlc3VsdC5wYXRobmFtZSA9IG51bGw7CgkgICAgcmVzdWx0LnBhdGggPSBudWxsOwoJICB9IGVsc2UgewoJICAgIHJlc3VsdC5wYXRobmFtZSA9IHNyY1BhdGguam9pbignLycpOwoJICB9CgoJICAvL3RvIHN1cHBvcnQgcmVxdWVzdC5odHRwCgkgIGlmICghdXRpbC5pc051bGwocmVzdWx0LnBhdGhuYW1lKSB8fCAhdXRpbC5pc051bGwocmVzdWx0LnNlYXJjaCkpIHsKCSAgICByZXN1bHQucGF0aCA9IChyZXN1bHQucGF0aG5hbWUgPyByZXN1bHQucGF0aG5hbWUgOiAnJykgKwoJICAgICAgICAgICAgICAgICAgKHJlc3VsdC5zZWFyY2ggPyByZXN1bHQuc2VhcmNoIDogJycpOwoJICB9CgkgIHJlc3VsdC5hdXRoID0gcmVsYXRpdmUuYXV0aCB8fCByZXN1bHQuYXV0aDsKCSAgcmVzdWx0LnNsYXNoZXMgPSByZXN1bHQuc2xhc2hlcyB8fCByZWxhdGl2ZS5zbGFzaGVzOwoJICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTsKCSAgcmV0dXJuIHJlc3VsdDsKCX07CgoJVXJsLnByb3RvdHlwZS5wYXJzZUhvc3QgPSBmdW5jdGlvbigpIHsKCSAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7CgkgIHZhciBwb3J0ID0gcG9ydFBhdHRlcm4uZXhlYyhob3N0KTsKCSAgaWYgKHBvcnQpIHsKCSAgICBwb3J0ID0gcG9ydFswXTsKCSAgICBpZiAocG9ydCAhPT0gJzonKSB7CgkgICAgICB0aGlzLnBvcnQgPSBwb3J0LnN1YnN0cigxKTsKCSAgICB9CgkgICAgaG9zdCA9IGhvc3Quc3Vic3RyKDAsIGhvc3QubGVuZ3RoIC0gcG9ydC5sZW5ndGgpOwoJICB9CgkgIGlmIChob3N0KSB0aGlzLmhvc3RuYW1lID0gaG9zdDsKCX07CgoKLyoqKi8gfSwKLyogNDEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihtb2R1bGUsIGdsb2JhbCkgey8qISBodHRwczovL210aHMuYmUvcHVueWNvZGUgdjEuMy4yIGJ5IEBtYXRoaWFzICovCgk7KGZ1bmN0aW9uKHJvb3QpIHsKCgkJLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlcyAqLwoJCXZhciBmcmVlRXhwb3J0cyA9IHR5cGVvZiBleHBvcnRzID09ICdvYmplY3QnICYmIGV4cG9ydHMgJiYKCQkJIWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0czsKCQl2YXIgZnJlZU1vZHVsZSA9IHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlICYmCgkJCSFtb2R1bGUubm9kZVR5cGUgJiYgbW9kdWxlOwoJCXZhciBmcmVlR2xvYmFsID0gdHlwZW9mIGdsb2JhbCA9PSAnb2JqZWN0JyAmJiBnbG9iYWw7CgkJaWYgKAoJCQlmcmVlR2xvYmFsLmdsb2JhbCA9PT0gZnJlZUdsb2JhbCB8fAoJCQlmcmVlR2xvYmFsLndpbmRvdyA9PT0gZnJlZUdsb2JhbCB8fAoJCQlmcmVlR2xvYmFsLnNlbGYgPT09IGZyZWVHbG9iYWwKCQkpIHsKCQkJcm9vdCA9IGZyZWVHbG9iYWw7CgkJfQoKCQkvKioKCQkgKiBUaGUgYHB1bnljb2RlYCBvYmplY3QuCgkJICogQG5hbWUgcHVueWNvZGUKCQkgKiBAdHlwZSBPYmplY3QKCQkgKi8KCQl2YXIgcHVueWNvZGUsCgoJCS8qKiBIaWdoZXN0IHBvc2l0aXZlIHNpZ25lZCAzMi1iaXQgZmxvYXQgdmFsdWUgKi8KCQltYXhJbnQgPSAyMTQ3NDgzNjQ3LCAvLyBha2EuIDB4N0ZGRkZGRkYgb3IgMl4zMS0xCgoJCS8qKiBCb290c3RyaW5nIHBhcmFtZXRlcnMgKi8KCQliYXNlID0gMzYsCgkJdE1pbiA9IDEsCgkJdE1heCA9IDI2LAoJCXNrZXcgPSAzOCwKCQlkYW1wID0gNzAwLAoJCWluaXRpYWxCaWFzID0gNzIsCgkJaW5pdGlhbE4gPSAxMjgsIC8vIDB4ODAKCQlkZWxpbWl0ZXIgPSAnLScsIC8vICdceDJEJwoKCQkvKiogUmVndWxhciBleHByZXNzaW9ucyAqLwoJCXJlZ2V4UHVueWNvZGUgPSAvXnhuLS0vLAoJCXJlZ2V4Tm9uQVNDSUkgPSAvW15ceDIwLVx4N0VdLywgLy8gdW5wcmludGFibGUgQVNDSUkgY2hhcnMgKyBub24tQVNDSUkgY2hhcnMKCQlyZWdleFNlcGFyYXRvcnMgPSAvW1x4MkVcdTMwMDJcdUZGMEVcdUZGNjFdL2csIC8vIFJGQyAzNDkwIHNlcGFyYXRvcnMKCgkJLyoqIEVycm9yIG1lc3NhZ2VzICovCgkJZXJyb3JzID0gewoJCQknb3ZlcmZsb3cnOiAnT3ZlcmZsb3c6IGlucHV0IG5lZWRzIHdpZGVyIGludGVnZXJzIHRvIHByb2Nlc3MnLAoJCQknbm90LWJhc2ljJzogJ0lsbGVnYWwgaW5wdXQgPj0gMHg4MCAobm90IGEgYmFzaWMgY29kZSBwb2ludCknLAoJCQknaW52YWxpZC1pbnB1dCc6ICdJbnZhbGlkIGlucHV0JwoJCX0sCgoJCS8qKiBDb252ZW5pZW5jZSBzaG9ydGN1dHMgKi8KCQliYXNlTWludXNUTWluID0gYmFzZSAtIHRNaW4sCgkJZmxvb3IgPSBNYXRoLmZsb29yLAoJCXN0cmluZ0Zyb21DaGFyQ29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGUsCgoJCS8qKiBUZW1wb3JhcnkgdmFyaWFibGUgKi8KCQlrZXk7CgoJCS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwoKCQkvKioKCQkgKiBBIGdlbmVyaWMgZXJyb3IgdXRpbGl0eSBmdW5jdGlvbi4KCQkgKiBAcHJpdmF0ZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIFRoZSBlcnJvciB0eXBlLgoJCSAqIEByZXR1cm5zIHtFcnJvcn0gVGhyb3dzIGEgYFJhbmdlRXJyb3JgIHdpdGggdGhlIGFwcGxpY2FibGUgZXJyb3IgbWVzc2FnZS4KCQkgKi8KCQlmdW5jdGlvbiBlcnJvcih0eXBlKSB7CgkJCXRocm93IFJhbmdlRXJyb3IoZXJyb3JzW3R5cGVdKTsKCQl9CgoJCS8qKgoJCSAqIEEgZ2VuZXJpYyBgQXJyYXkjbWFwYCB1dGlsaXR5IGZ1bmN0aW9uLgoJCSAqIEBwcml2YXRlCgkJICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci4KCQkgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCBmb3IgZXZlcnkgYXJyYXkKCQkgKiBpdGVtLgoJCSAqIEByZXR1cm5zIHtBcnJheX0gQSBuZXcgYXJyYXkgb2YgdmFsdWVzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFjayBmdW5jdGlvbi4KCQkgKi8KCQlmdW5jdGlvbiBtYXAoYXJyYXksIGZuKSB7CgkJCXZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7CgkJCXZhciByZXN1bHQgPSBbXTsKCQkJd2hpbGUgKGxlbmd0aC0tKSB7CgkJCQlyZXN1bHRbbGVuZ3RoXSA9IGZuKGFycmF5W2xlbmd0aF0pOwoJCQl9CgkJCXJldHVybiByZXN1bHQ7CgkJfQoKCQkvKioKCQkgKiBBIHNpbXBsZSBgQXJyYXkjbWFwYC1saWtlIHdyYXBwZXIgdG8gd29yayB3aXRoIGRvbWFpbiBuYW1lIHN0cmluZ3Mgb3IgZW1haWwKCQkgKiBhZGRyZXNzZXMuCgkJICogQHByaXZhdGUKCQkgKiBAcGFyYW0ge1N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzLgoJCSAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIGZvciBldmVyeQoJCSAqIGNoYXJhY3Rlci4KCQkgKiBAcmV0dXJucyB7QXJyYXl9IEEgbmV3IHN0cmluZyBvZiBjaGFyYWN0ZXJzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFjawoJCSAqIGZ1bmN0aW9uLgoJCSAqLwoJCWZ1bmN0aW9uIG1hcERvbWFpbihzdHJpbmcsIGZuKSB7CgkJCXZhciBwYXJ0cyA9IHN0cmluZy5zcGxpdCgnQCcpOwoJCQl2YXIgcmVzdWx0ID0gJyc7CgkJCWlmIChwYXJ0cy5sZW5ndGggPiAxKSB7CgkJCQkvLyBJbiBlbWFpbCBhZGRyZXNzZXMsIG9ubHkgdGhlIGRvbWFpbiBuYW1lIHNob3VsZCBiZSBwdW55Y29kZWQuIExlYXZlCgkJCQkvLyB0aGUgbG9jYWwgcGFydCAoaS5lLiBldmVyeXRoaW5nIHVwIHRvIGBAYCkgaW50YWN0LgoJCQkJcmVzdWx0ID0gcGFydHNbMF0gKyAnQCc7CgkJCQlzdHJpbmcgPSBwYXJ0c1sxXTsKCQkJfQoJCQkvLyBBdm9pZCBgc3BsaXQocmVnZXgpYCBmb3IgSUU4IGNvbXBhdGliaWxpdHkuIFNlZSAjMTcuCgkJCXN0cmluZyA9IHN0cmluZy5yZXBsYWNlKHJlZ2V4U2VwYXJhdG9ycywgJ1x4MkUnKTsKCQkJdmFyIGxhYmVscyA9IHN0cmluZy5zcGxpdCgnLicpOwoJCQl2YXIgZW5jb2RlZCA9IG1hcChsYWJlbHMsIGZuKS5qb2luKCcuJyk7CgkJCXJldHVybiByZXN1bHQgKyBlbmNvZGVkOwoJCX0KCgkJLyoqCgkJICogQ3JlYXRlcyBhbiBhcnJheSBjb250YWluaW5nIHRoZSBudW1lcmljIGNvZGUgcG9pbnRzIG9mIGVhY2ggVW5pY29kZQoJCSAqIGNoYXJhY3RlciBpbiB0aGUgc3RyaW5nLiBXaGlsZSBKYXZhU2NyaXB0IHVzZXMgVUNTLTIgaW50ZXJuYWxseSwKCQkgKiB0aGlzIGZ1bmN0aW9uIHdpbGwgY29udmVydCBhIHBhaXIgb2Ygc3Vycm9nYXRlIGhhbHZlcyAoZWFjaCBvZiB3aGljaAoJCSAqIFVDUy0yIGV4cG9zZXMgYXMgc2VwYXJhdGUgY2hhcmFjdGVycykgaW50byBhIHNpbmdsZSBjb2RlIHBvaW50LAoJCSAqIG1hdGNoaW5nIFVURi0xNi4KCQkgKiBAc2VlIGBwdW55Y29kZS51Y3MyLmVuY29kZWAKCQkgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz4KCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUudWNzMgoJCSAqIEBuYW1lIGRlY29kZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSBzdHJpbmcgVGhlIFVuaWNvZGUgaW5wdXQgc3RyaW5nIChVQ1MtMikuCgkJICogQHJldHVybnMge0FycmF5fSBUaGUgbmV3IGFycmF5IG9mIGNvZGUgcG9pbnRzLgoJCSAqLwoJCWZ1bmN0aW9uIHVjczJkZWNvZGUoc3RyaW5nKSB7CgkJCXZhciBvdXRwdXQgPSBbXSwKCQkJICAgIGNvdW50ZXIgPSAwLAoJCQkgICAgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aCwKCQkJICAgIHZhbHVlLAoJCQkgICAgZXh0cmE7CgkJCXdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7CgkJCQl2YWx1ZSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7CgkJCQlpZiAodmFsdWUgPj0gMHhEODAwICYmIHZhbHVlIDw9IDB4REJGRiAmJiBjb3VudGVyIDwgbGVuZ3RoKSB7CgkJCQkJLy8gaGlnaCBzdXJyb2dhdGUsIGFuZCB0aGVyZSBpcyBhIG5leHQgY2hhcmFjdGVyCgkJCQkJZXh0cmEgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspOwoJCQkJCWlmICgoZXh0cmEgJiAweEZDMDApID09IDB4REMwMCkgeyAvLyBsb3cgc3Vycm9nYXRlCgkJCQkJCW91dHB1dC5wdXNoKCgodmFsdWUgJiAweDNGRikgPDwgMTApICsgKGV4dHJhICYgMHgzRkYpICsgMHgxMDAwMCk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJLy8gdW5tYXRjaGVkIHN1cnJvZ2F0ZTsgb25seSBhcHBlbmQgdGhpcyBjb2RlIHVuaXQsIGluIGNhc2UgdGhlIG5leHQKCQkJCQkJLy8gY29kZSB1bml0IGlzIHRoZSBoaWdoIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyCgkJCQkJCW91dHB1dC5wdXNoKHZhbHVlKTsKCQkJCQkJY291bnRlci0tOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJb3V0cHV0LnB1c2godmFsdWUpOwoJCQkJfQoJCQl9CgkJCXJldHVybiBvdXRwdXQ7CgkJfQoKCQkvKioKCQkgKiBDcmVhdGVzIGEgc3RyaW5nIGJhc2VkIG9uIGFuIGFycmF5IG9mIG51bWVyaWMgY29kZSBwb2ludHMuCgkJICogQHNlZSBgcHVueWNvZGUudWNzMi5kZWNvZGVgCgkJICogQG1lbWJlck9mIHB1bnljb2RlLnVjczIKCQkgKiBAbmFtZSBlbmNvZGUKCQkgKiBAcGFyYW0ge0FycmF5fSBjb2RlUG9pbnRzIFRoZSBhcnJheSBvZiBudW1lcmljIGNvZGUgcG9pbnRzLgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBuZXcgVW5pY29kZSBzdHJpbmcgKFVDUy0yKS4KCQkgKi8KCQlmdW5jdGlvbiB1Y3MyZW5jb2RlKGFycmF5KSB7CgkJCXJldHVybiBtYXAoYXJyYXksIGZ1bmN0aW9uKHZhbHVlKSB7CgkJCQl2YXIgb3V0cHV0ID0gJyc7CgkJCQlpZiAodmFsdWUgPiAweEZGRkYpIHsKCQkJCQl2YWx1ZSAtPSAweDEwMDAwOwoJCQkJCW91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApOwoJCQkJCXZhbHVlID0gMHhEQzAwIHwgdmFsdWUgJiAweDNGRjsKCQkJCX0KCQkJCW91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUpOwoJCQkJcmV0dXJuIG91dHB1dDsKCQkJfSkuam9pbignJyk7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIGJhc2ljIGNvZGUgcG9pbnQgaW50byBhIGRpZ2l0L2ludGVnZXIuCgkJICogQHNlZSBgZGlnaXRUb0Jhc2ljKClgCgkJICogQHByaXZhdGUKCQkgKiBAcGFyYW0ge051bWJlcn0gY29kZVBvaW50IFRoZSBiYXNpYyBudW1lcmljIGNvZGUgcG9pbnQgdmFsdWUuCgkJICogQHJldHVybnMge051bWJlcn0gVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50IChmb3IgdXNlIGluCgkJICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpbiB0aGUgcmFuZ2UgYDBgIHRvIGBiYXNlIC0gMWAsIG9yIGBiYXNlYCBpZgoJCSAqIHRoZSBjb2RlIHBvaW50IGRvZXMgbm90IHJlcHJlc2VudCBhIHZhbHVlLgoJCSAqLwoJCWZ1bmN0aW9uIGJhc2ljVG9EaWdpdChjb2RlUG9pbnQpIHsKCQkJaWYgKGNvZGVQb2ludCAtIDQ4IDwgMTApIHsKCQkJCXJldHVybiBjb2RlUG9pbnQgLSAyMjsKCQkJfQoJCQlpZiAoY29kZVBvaW50IC0gNjUgPCAyNikgewoJCQkJcmV0dXJuIGNvZGVQb2ludCAtIDY1OwoJCQl9CgkJCWlmIChjb2RlUG9pbnQgLSA5NyA8IDI2KSB7CgkJCQlyZXR1cm4gY29kZVBvaW50IC0gOTc7CgkJCX0KCQkJcmV0dXJuIGJhc2U7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIGRpZ2l0L2ludGVnZXIgaW50byBhIGJhc2ljIGNvZGUgcG9pbnQuCgkJICogQHNlZSBgYmFzaWNUb0RpZ2l0KClgCgkJICogQHByaXZhdGUKCQkgKiBAcGFyYW0ge051bWJlcn0gZGlnaXQgVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50LgoJCSAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBiYXNpYyBjb2RlIHBvaW50IHdob3NlIHZhbHVlICh3aGVuIHVzZWQgZm9yCgkJICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpcyBgZGlnaXRgLCB3aGljaCBuZWVkcyB0byBiZSBpbiB0aGUgcmFuZ2UKCQkgKiBgMGAgdG8gYGJhc2UgLSAxYC4gSWYgYGZsYWdgIGlzIG5vbi16ZXJvLCB0aGUgdXBwZXJjYXNlIGZvcm0gaXMKCQkgKiB1c2VkOyBlbHNlLCB0aGUgbG93ZXJjYXNlIGZvcm0gaXMgdXNlZC4gVGhlIGJlaGF2aW9yIGlzIHVuZGVmaW5lZAoJCSAqIGlmIGBmbGFnYCBpcyBub24temVybyBhbmQgYGRpZ2l0YCBoYXMgbm8gdXBwZXJjYXNlIGZvcm0uCgkJICovCgkJZnVuY3Rpb24gZGlnaXRUb0Jhc2ljKGRpZ2l0LCBmbGFnKSB7CgkJCS8vICAwLi4yNSBtYXAgdG8gQVNDSUkgYS4ueiBvciBBLi5aCgkJCS8vIDI2Li4zNSBtYXAgdG8gQVNDSUkgMC4uOQoJCQlyZXR1cm4gZGlnaXQgKyAyMiArIDc1ICogKGRpZ2l0IDwgMjYpIC0gKChmbGFnICE9IDApIDw8IDUpOwoJCX0KCgkJLyoqCgkJICogQmlhcyBhZGFwdGF0aW9uIGZ1bmN0aW9uIGFzIHBlciBzZWN0aW9uIDMuNCBvZiBSRkMgMzQ5Mi4KCQkgKiBodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzNDkyI3NlY3Rpb24tMy40CgkJICogQHByaXZhdGUKCQkgKi8KCQlmdW5jdGlvbiBhZGFwdChkZWx0YSwgbnVtUG9pbnRzLCBmaXJzdFRpbWUpIHsKCQkJdmFyIGsgPSAwOwoJCQlkZWx0YSA9IGZpcnN0VGltZSA/IGZsb29yKGRlbHRhIC8gZGFtcCkgOiBkZWx0YSA+PiAxOwoJCQlkZWx0YSArPSBmbG9vcihkZWx0YSAvIG51bVBvaW50cyk7CgkJCWZvciAoLyogbm8gaW5pdGlhbGl6YXRpb24gKi87IGRlbHRhID4gYmFzZU1pbnVzVE1pbiAqIHRNYXggPj4gMTsgayArPSBiYXNlKSB7CgkJCQlkZWx0YSA9IGZsb29yKGRlbHRhIC8gYmFzZU1pbnVzVE1pbik7CgkJCX0KCQkJcmV0dXJuIGZsb29yKGsgKyAoYmFzZU1pbnVzVE1pbiArIDEpICogZGVsdGEgLyAoZGVsdGEgKyBza2V3KSk7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMgdG8gYSBzdHJpbmcgb2YgVW5pY29kZQoJCSAqIHN5bWJvbHMuCgkJICogQG1lbWJlck9mIHB1bnljb2RlCgkJICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSByZXN1bHRpbmcgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scy4KCQkgKi8KCQlmdW5jdGlvbiBkZWNvZGUoaW5wdXQpIHsKCQkJLy8gRG9uJ3QgdXNlIFVDUy0yCgkJCXZhciBvdXRwdXQgPSBbXSwKCQkJICAgIGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoLAoJCQkgICAgb3V0LAoJCQkgICAgaSA9IDAsCgkJCSAgICBuID0gaW5pdGlhbE4sCgkJCSAgICBiaWFzID0gaW5pdGlhbEJpYXMsCgkJCSAgICBiYXNpYywKCQkJICAgIGosCgkJCSAgICBpbmRleCwKCQkJICAgIG9sZGksCgkJCSAgICB3LAoJCQkgICAgaywKCQkJICAgIGRpZ2l0LAoJCQkgICAgdCwKCQkJICAgIC8qKiBDYWNoZWQgY2FsY3VsYXRpb24gcmVzdWx0cyAqLwoJCQkgICAgYmFzZU1pbnVzVDsKCgkJCS8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHM6IGxldCBgYmFzaWNgIGJlIHRoZSBudW1iZXIgb2YgaW5wdXQgY29kZQoJCQkvLyBwb2ludHMgYmVmb3JlIHRoZSBsYXN0IGRlbGltaXRlciwgb3IgYDBgIGlmIHRoZXJlIGlzIG5vbmUsIHRoZW4gY29weQoJCQkvLyB0aGUgZmlyc3QgYmFzaWMgY29kZSBwb2ludHMgdG8gdGhlIG91dHB1dC4KCgkJCWJhc2ljID0gaW5wdXQubGFzdEluZGV4T2YoZGVsaW1pdGVyKTsKCQkJaWYgKGJhc2ljIDwgMCkgewoJCQkJYmFzaWMgPSAwOwoJCQl9CgoJCQlmb3IgKGogPSAwOyBqIDwgYmFzaWM7ICsraikgewoJCQkJLy8gaWYgaXQncyBub3QgYSBiYXNpYyBjb2RlIHBvaW50CgkJCQlpZiAoaW5wdXQuY2hhckNvZGVBdChqKSA+PSAweDgwKSB7CgkJCQkJZXJyb3IoJ25vdC1iYXNpYycpOwoJCQkJfQoJCQkJb3V0cHV0LnB1c2goaW5wdXQuY2hhckNvZGVBdChqKSk7CgkJCX0KCgkJCS8vIE1haW4gZGVjb2RpbmcgbG9vcDogc3RhcnQganVzdCBhZnRlciB0aGUgbGFzdCBkZWxpbWl0ZXIgaWYgYW55IGJhc2ljIGNvZGUKCQkJLy8gcG9pbnRzIHdlcmUgY29waWVkOyBzdGFydCBhdCB0aGUgYmVnaW5uaW5nIG90aGVyd2lzZS4KCgkJCWZvciAoaW5kZXggPSBiYXNpYyA+IDAgPyBiYXNpYyArIDEgOiAwOyBpbmRleCA8IGlucHV0TGVuZ3RoOyAvKiBubyBmaW5hbCBleHByZXNzaW9uICovKSB7CgoJCQkJLy8gYGluZGV4YCBpcyB0aGUgaW5kZXggb2YgdGhlIG5leHQgY2hhcmFjdGVyIHRvIGJlIGNvbnN1bWVkLgoJCQkJLy8gRGVjb2RlIGEgZ2VuZXJhbGl6ZWQgdmFyaWFibGUtbGVuZ3RoIGludGVnZXIgaW50byBgZGVsdGFgLAoJCQkJLy8gd2hpY2ggZ2V0cyBhZGRlZCB0byBgaWAuIFRoZSBvdmVyZmxvdyBjaGVja2luZyBpcyBlYXNpZXIKCQkJCS8vIGlmIHdlIGluY3JlYXNlIGBpYCBhcyB3ZSBnbywgdGhlbiBzdWJ0cmFjdCBvZmYgaXRzIHN0YXJ0aW5nCgkJCQkvLyB2YWx1ZSBhdCB0aGUgZW5kIHRvIG9idGFpbiBgZGVsdGFgLgoJCQkJZm9yIChvbGRpID0gaSwgdyA9IDEsIGsgPSBiYXNlOyAvKiBubyBjb25kaXRpb24gKi87IGsgKz0gYmFzZSkgewoKCQkJCQlpZiAoaW5kZXggPj0gaW5wdXRMZW5ndGgpIHsKCQkJCQkJZXJyb3IoJ2ludmFsaWQtaW5wdXQnKTsKCQkJCQl9CgoJCQkJCWRpZ2l0ID0gYmFzaWNUb0RpZ2l0KGlucHV0LmNoYXJDb2RlQXQoaW5kZXgrKykpOwoKCQkJCQlpZiAoZGlnaXQgPj0gYmFzZSB8fCBkaWdpdCA+IGZsb29yKChtYXhJbnQgLSBpKSAvIHcpKSB7CgkJCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQkJCX0KCgkJCQkJaSArPSBkaWdpdCAqIHc7CgkJCQkJdCA9IGsgPD0gYmlhcyA/IHRNaW4gOiAoayA+PSBiaWFzICsgdE1heCA/IHRNYXggOiBrIC0gYmlhcyk7CgoJCQkJCWlmIChkaWdpdCA8IHQpIHsKCQkJCQkJYnJlYWs7CgkJCQkJfQoKCQkJCQliYXNlTWludXNUID0gYmFzZSAtIHQ7CgkJCQkJaWYgKHcgPiBmbG9vcihtYXhJbnQgLyBiYXNlTWludXNUKSkgewoJCQkJCQllcnJvcignb3ZlcmZsb3cnKTsKCQkJCQl9CgoJCQkJCXcgKj0gYmFzZU1pbnVzVDsKCgkJCQl9CgoJCQkJb3V0ID0gb3V0cHV0Lmxlbmd0aCArIDE7CgkJCQliaWFzID0gYWRhcHQoaSAtIG9sZGksIG91dCwgb2xkaSA9PSAwKTsKCgkJCQkvLyBgaWAgd2FzIHN1cHBvc2VkIHRvIHdyYXAgYXJvdW5kIGZyb20gYG91dGAgdG8gYDBgLAoJCQkJLy8gaW5jcmVtZW50aW5nIGBuYCBlYWNoIHRpbWUsIHNvIHdlJ2xsIGZpeCB0aGF0IG5vdzoKCQkJCWlmIChmbG9vcihpIC8gb3V0KSA+IG1heEludCAtIG4pIHsKCQkJCQllcnJvcignb3ZlcmZsb3cnKTsKCQkJCX0KCgkJCQluICs9IGZsb29yKGkgLyBvdXQpOwoJCQkJaSAlPSBvdXQ7CgoJCQkJLy8gSW5zZXJ0IGBuYCBhdCBwb3NpdGlvbiBgaWAgb2YgdGhlIG91dHB1dAoJCQkJb3V0cHV0LnNwbGljZShpKyssIDAsIG4pOwoKCQkJfQoKCQkJcmV0dXJuIHVjczJlbmNvZGUob3V0cHV0KTsKCQl9CgoJCS8qKgoJCSAqIENvbnZlcnRzIGEgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scyAoZS5nLiBhIGRvbWFpbiBuYW1lIGxhYmVsKSB0byBhCgkJICogUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy4KCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUKCQkgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMuCgkJICogQHJldHVybnMge1N0cmluZ30gVGhlIHJlc3VsdGluZyBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLgoJCSAqLwoJCWZ1bmN0aW9uIGVuY29kZShpbnB1dCkgewoJCQl2YXIgbiwKCQkJICAgIGRlbHRhLAoJCQkgICAgaGFuZGxlZENQQ291bnQsCgkJCSAgICBiYXNpY0xlbmd0aCwKCQkJICAgIGJpYXMsCgkJCSAgICBqLAoJCQkgICAgbSwKCQkJICAgIHEsCgkJCSAgICBrLAoJCQkgICAgdCwKCQkJICAgIGN1cnJlbnRWYWx1ZSwKCQkJICAgIG91dHB1dCA9IFtdLAoJCQkgICAgLyoqIGBpbnB1dExlbmd0aGAgd2lsbCBob2xkIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgaW4gYGlucHV0YC4gKi8KCQkJICAgIGlucHV0TGVuZ3RoLAoJCQkgICAgLyoqIENhY2hlZCBjYWxjdWxhdGlvbiByZXN1bHRzICovCgkJCSAgICBoYW5kbGVkQ1BDb3VudFBsdXNPbmUsCgkJCSAgICBiYXNlTWludXNULAoJCQkgICAgcU1pbnVzVDsKCgkJCS8vIENvbnZlcnQgdGhlIGlucHV0IGluIFVDUy0yIHRvIFVuaWNvZGUKCQkJaW5wdXQgPSB1Y3MyZGVjb2RlKGlucHV0KTsKCgkJCS8vIENhY2hlIHRoZSBsZW5ndGgKCQkJaW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGg7CgoJCQkvLyBJbml0aWFsaXplIHRoZSBzdGF0ZQoJCQluID0gaW5pdGlhbE47CgkJCWRlbHRhID0gMDsKCQkJYmlhcyA9IGluaXRpYWxCaWFzOwoKCQkJLy8gSGFuZGxlIHRoZSBiYXNpYyBjb2RlIHBvaW50cwoJCQlmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikgewoJCQkJY3VycmVudFZhbHVlID0gaW5wdXRbal07CgkJCQlpZiAoY3VycmVudFZhbHVlIDwgMHg4MCkgewoJCQkJCW91dHB1dC5wdXNoKHN0cmluZ0Zyb21DaGFyQ29kZShjdXJyZW50VmFsdWUpKTsKCQkJCX0KCQkJfQoKCQkJaGFuZGxlZENQQ291bnQgPSBiYXNpY0xlbmd0aCA9IG91dHB1dC5sZW5ndGg7CgoJCQkvLyBgaGFuZGxlZENQQ291bnRgIGlzIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgdGhhdCBoYXZlIGJlZW4gaGFuZGxlZDsKCQkJLy8gYGJhc2ljTGVuZ3RoYCBpcyB0aGUgbnVtYmVyIG9mIGJhc2ljIGNvZGUgcG9pbnRzLgoKCQkJLy8gRmluaXNoIHRoZSBiYXNpYyBzdHJpbmcgLSBpZiBpdCBpcyBub3QgZW1wdHkgLSB3aXRoIGEgZGVsaW1pdGVyCgkJCWlmIChiYXNpY0xlbmd0aCkgewoJCQkJb3V0cHV0LnB1c2goZGVsaW1pdGVyKTsKCQkJfQoKCQkJLy8gTWFpbiBlbmNvZGluZyBsb29wOgoJCQl3aGlsZSAoaGFuZGxlZENQQ291bnQgPCBpbnB1dExlbmd0aCkgewoKCQkJCS8vIEFsbCBub24tYmFzaWMgY29kZSBwb2ludHMgPCBuIGhhdmUgYmVlbiBoYW5kbGVkIGFscmVhZHkuIEZpbmQgdGhlIG5leHQKCQkJCS8vIGxhcmdlciBvbmU6CgkJCQlmb3IgKG0gPSBtYXhJbnQsIGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikgewoJCQkJCWN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdOwoJCQkJCWlmIChjdXJyZW50VmFsdWUgPj0gbiAmJiBjdXJyZW50VmFsdWUgPCBtKSB7CgkJCQkJCW0gPSBjdXJyZW50VmFsdWU7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIEluY3JlYXNlIGBkZWx0YWAgZW5vdWdoIHRvIGFkdmFuY2UgdGhlIGRlY29kZXIncyA8bixpPiBzdGF0ZSB0byA8bSwwPiwKCQkJCS8vIGJ1dCBndWFyZCBhZ2FpbnN0IG92ZXJmbG93CgkJCQloYW5kbGVkQ1BDb3VudFBsdXNPbmUgPSBoYW5kbGVkQ1BDb3VudCArIDE7CgkJCQlpZiAobSAtIG4gPiBmbG9vcigobWF4SW50IC0gZGVsdGEpIC8gaGFuZGxlZENQQ291bnRQbHVzT25lKSkgewoJCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQkJfQoKCQkJCWRlbHRhICs9IChtIC0gbikgKiBoYW5kbGVkQ1BDb3VudFBsdXNPbmU7CgkJCQluID0gbTsKCgkJCQlmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikgewoJCQkJCWN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdOwoKCQkJCQlpZiAoY3VycmVudFZhbHVlIDwgbiAmJiArK2RlbHRhID4gbWF4SW50KSB7CgkJCQkJCWVycm9yKCdvdmVyZmxvdycpOwoJCQkJCX0KCgkJCQkJaWYgKGN1cnJlbnRWYWx1ZSA9PSBuKSB7CgkJCQkJCS8vIFJlcHJlc2VudCBkZWx0YSBhcyBhIGdlbmVyYWxpemVkIHZhcmlhYmxlLWxlbmd0aCBpbnRlZ2VyCgkJCQkJCWZvciAocSA9IGRlbHRhLCBrID0gYmFzZTsgLyogbm8gY29uZGl0aW9uICovOyBrICs9IGJhc2UpIHsKCQkJCQkJCXQgPSBrIDw9IGJpYXMgPyB0TWluIDogKGsgPj0gYmlhcyArIHRNYXggPyB0TWF4IDogayAtIGJpYXMpOwoJCQkJCQkJaWYgKHEgPCB0KSB7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQl9CgkJCQkJCQlxTWludXNUID0gcSAtIHQ7CgkJCQkJCQliYXNlTWludXNUID0gYmFzZSAtIHQ7CgkJCQkJCQlvdXRwdXQucHVzaCgKCQkJCQkJCQlzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHQgKyBxTWludXNUICUgYmFzZU1pbnVzVCwgMCkpCgkJCQkJCQkpOwoJCQkJCQkJcSA9IGZsb29yKHFNaW51c1QgLyBiYXNlTWludXNUKTsKCQkJCQkJfQoKCQkJCQkJb3V0cHV0LnB1c2goc3RyaW5nRnJvbUNoYXJDb2RlKGRpZ2l0VG9CYXNpYyhxLCAwKSkpOwoJCQkJCQliaWFzID0gYWRhcHQoZGVsdGEsIGhhbmRsZWRDUENvdW50UGx1c09uZSwgaGFuZGxlZENQQ291bnQgPT0gYmFzaWNMZW5ndGgpOwoJCQkJCQlkZWx0YSA9IDA7CgkJCQkJCSsraGFuZGxlZENQQ291bnQ7CgkJCQkJfQoJCQkJfQoKCQkJCSsrZGVsdGE7CgkJCQkrK247CgoJCQl9CgkJCXJldHVybiBvdXRwdXQuam9pbignJyk7CgkJfQoKCQkvKioKCQkgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSBvciBhbiBlbWFpbCBhZGRyZXNzCgkJICogdG8gVW5pY29kZS4gT25seSB0aGUgUHVueWNvZGVkIHBhcnRzIG9mIHRoZSBpbnB1dCB3aWxsIGJlIGNvbnZlcnRlZCwgaS5lLgoJCSAqIGl0IGRvZXNuJ3QgbWF0dGVyIGlmIHlvdSBjYWxsIGl0IG9uIGEgc3RyaW5nIHRoYXQgaGFzIGFscmVhZHkgYmVlbgoJCSAqIGNvbnZlcnRlZCB0byBVbmljb2RlLgoJCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgUHVueWNvZGVkIGRvbWFpbiBuYW1lIG9yIGVtYWlsIGFkZHJlc3MgdG8KCQkgKiBjb252ZXJ0IHRvIFVuaWNvZGUuCgkJICogQHJldHVybnMge1N0cmluZ30gVGhlIFVuaWNvZGUgcmVwcmVzZW50YXRpb24gb2YgdGhlIGdpdmVuIFB1bnljb2RlCgkJICogc3RyaW5nLgoJCSAqLwoJCWZ1bmN0aW9uIHRvVW5pY29kZShpbnB1dCkgewoJCQlyZXR1cm4gbWFwRG9tYWluKGlucHV0LCBmdW5jdGlvbihzdHJpbmcpIHsKCQkJCXJldHVybiByZWdleFB1bnljb2RlLnRlc3Qoc3RyaW5nKQoJCQkJCT8gZGVjb2RlKHN0cmluZy5zbGljZSg0KS50b0xvd2VyQ2FzZSgpKQoJCQkJCTogc3RyaW5nOwoJCQl9KTsKCQl9CgoJCS8qKgoJCSAqIENvbnZlcnRzIGEgVW5pY29kZSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgZG9tYWluIG5hbWUgb3IgYW4gZW1haWwgYWRkcmVzcyB0bwoJCSAqIFB1bnljb2RlLiBPbmx5IHRoZSBub24tQVNDSUkgcGFydHMgb2YgdGhlIGRvbWFpbiBuYW1lIHdpbGwgYmUgY29udmVydGVkLAoJCSAqIGkuZS4gaXQgZG9lc24ndCBtYXR0ZXIgaWYgeW91IGNhbGwgaXQgd2l0aCBhIGRvbWFpbiB0aGF0J3MgYWxyZWFkeSBpbgoJCSAqIEFTQ0lJLgoJCSAqIEBtZW1iZXJPZiBwdW55Y29kZQoJCSAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcyB0byBjb252ZXJ0LCBhcyBhCgkJICogVW5pY29kZSBzdHJpbmcuCgkJICogQHJldHVybnMge1N0cmluZ30gVGhlIFB1bnljb2RlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBkb21haW4gbmFtZSBvcgoJCSAqIGVtYWlsIGFkZHJlc3MuCgkJICovCgkJZnVuY3Rpb24gdG9BU0NJSShpbnB1dCkgewoJCQlyZXR1cm4gbWFwRG9tYWluKGlucHV0LCBmdW5jdGlvbihzdHJpbmcpIHsKCQkJCXJldHVybiByZWdleE5vbkFTQ0lJLnRlc3Qoc3RyaW5nKQoJCQkJCT8gJ3huLS0nICsgZW5jb2RlKHN0cmluZykKCQkJCQk6IHN0cmluZzsKCQkJfSk7CgkJfQoKCQkvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KCgkJLyoqIERlZmluZSB0aGUgcHVibGljIEFQSSAqLwoJCXB1bnljb2RlID0gewoJCQkvKioKCQkJICogQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBjdXJyZW50IFB1bnljb2RlLmpzIHZlcnNpb24gbnVtYmVyLgoJCQkgKiBAbWVtYmVyT2YgcHVueWNvZGUKCQkJICogQHR5cGUgU3RyaW5nCgkJCSAqLwoJCQkndmVyc2lvbic6ICcxLjMuMicsCgkJCS8qKgoJCQkgKiBBbiBvYmplY3Qgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGZyb20gSmF2YVNjcmlwdCdzIGludGVybmFsIGNoYXJhY3RlcgoJCQkgKiByZXByZXNlbnRhdGlvbiAoVUNTLTIpIHRvIFVuaWNvZGUgY29kZSBwb2ludHMsIGFuZCBiYWNrLgoJCQkgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz4KCQkJICogQG1lbWJlck9mIHB1bnljb2RlCgkJCSAqIEB0eXBlIE9iamVjdAoJCQkgKi8KCQkJJ3VjczInOiB7CgkJCQknZGVjb2RlJzogdWNzMmRlY29kZSwKCQkJCSdlbmNvZGUnOiB1Y3MyZW5jb2RlCgkJCX0sCgkJCSdkZWNvZGUnOiBkZWNvZGUsCgkJCSdlbmNvZGUnOiBlbmNvZGUsCgkJCSd0b0FTQ0lJJzogdG9BU0NJSSwKCQkJJ3RvVW5pY29kZSc6IHRvVW5pY29kZQoJCX07CgoJCS8qKiBFeHBvc2UgYHB1bnljb2RlYCAqLwoJCS8vIFNvbWUgQU1EIGJ1aWxkIG9wdGltaXplcnMsIGxpa2Ugci5qcywgY2hlY2sgZm9yIHNwZWNpZmljIGNvbmRpdGlvbiBwYXR0ZXJucwoJCS8vIGxpa2UgdGhlIGZvbGxvd2luZzoKCQlpZiAoCgkJCXRydWUKCQkpIHsKCQkJIShfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCkgewoJCQkJcmV0dXJuIHB1bnljb2RlOwoJCQl9LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXywgZXhwb3J0cywgbW9kdWxlKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpOwoJCX0gZWxzZSBpZiAoZnJlZUV4cG9ydHMgJiYgZnJlZU1vZHVsZSkgewoJCQlpZiAobW9kdWxlLmV4cG9ydHMgPT0gZnJlZUV4cG9ydHMpIHsgLy8gaW4gTm9kZS5qcyBvciBSaW5nb0pTIHYwLjguMCsKCQkJCWZyZWVNb2R1bGUuZXhwb3J0cyA9IHB1bnljb2RlOwoJCQl9IGVsc2UgeyAvLyBpbiBOYXJ3aGFsIG9yIFJpbmdvSlMgdjAuNy4wLQoJCQkJZm9yIChrZXkgaW4gcHVueWNvZGUpIHsKCQkJCQlwdW55Y29kZS5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIChmcmVlRXhwb3J0c1trZXldID0gcHVueWNvZGVba2V5XSk7CgkJCQl9CgkJCX0KCQl9IGVsc2UgeyAvLyBpbiBSaGlubyBvciBhIHdlYiBicm93c2VyCgkJCXJvb3QucHVueWNvZGUgPSBwdW55Y29kZTsKCQl9CgoJfSh0aGlzKSk7CgoJLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oNDIpKG1vZHVsZSksIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKQoKLyoqKi8gfSwKLyogNDIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtb2R1bGUpIHsNCgkJaWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHsNCgkJCW1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9Ow0KCQkJbW9kdWxlLnBhdGhzID0gW107DQoJCQkvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHQNCgkJCW1vZHVsZS5jaGlsZHJlbiA9IFtdOw0KCQkJbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7DQoJCX0NCgkJcmV0dXJuIG1vZHVsZTsNCgl9DQoKCi8qKiovIH0sCi8qIDQzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCSd1c2Ugc3RyaWN0JzsKCgltb2R1bGUuZXhwb3J0cyA9IHsKCSAgaXNTdHJpbmc6IGZ1bmN0aW9uKGFyZykgewoJICAgIHJldHVybiB0eXBlb2YoYXJnKSA9PT0gJ3N0cmluZyc7CgkgIH0sCgkgIGlzT2JqZWN0OiBmdW5jdGlvbihhcmcpIHsKCSAgICByZXR1cm4gdHlwZW9mKGFyZykgPT09ICdvYmplY3QnICYmIGFyZyAhPT0gbnVsbDsKCSAgfSwKCSAgaXNOdWxsOiBmdW5jdGlvbihhcmcpIHsKCSAgICByZXR1cm4gYXJnID09PSBudWxsOwoJICB9LAoJICBpc051bGxPclVuZGVmaW5lZDogZnVuY3Rpb24oYXJnKSB7CgkgICAgcmV0dXJuIGFyZyA9PSBudWxsOwoJICB9Cgl9OwoKCi8qKiovIH0sCi8qIDQ0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglleHBvcnRzLmRlY29kZSA9IGV4cG9ydHMucGFyc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KTsKCWV4cG9ydHMuZW5jb2RlID0gZXhwb3J0cy5zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ2KTsKCgovKioqLyB9LAovKiA0NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy4KCS8vCgkvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYQoJLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoJLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwoJLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAoJLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdAoJLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCgkvLyBmb2xsb3dpbmcgY29uZGl0aW9uczoKCS8vCgkvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAoJLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgkvLwoJLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKCS8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YKCS8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4KCS8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAoJLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SCgkvLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFCgkvLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKCSd1c2Ugc3RyaWN0JzsKCgkvLyBJZiBvYmouaGFzT3duUHJvcGVydHkgaGFzIGJlZW4gb3ZlcnJpZGRlbiwgdGhlbiBjYWxsaW5nCgkvLyBvYmouaGFzT3duUHJvcGVydHkocHJvcCkgd2lsbCBicmVhay4KCS8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2pveWVudC9ub2RlL2lzc3Vlcy8xNzA3CglmdW5jdGlvbiBoYXNPd25Qcm9wZXJ0eShvYmosIHByb3ApIHsKCSAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApOwoJfQoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocXMsIHNlcCwgZXEsIG9wdGlvbnMpIHsKCSAgc2VwID0gc2VwIHx8ICcmJzsKCSAgZXEgPSBlcSB8fCAnPSc7CgkgIHZhciBvYmogPSB7fTsKCgkgIGlmICh0eXBlb2YgcXMgIT09ICdzdHJpbmcnIHx8IHFzLmxlbmd0aCA9PT0gMCkgewoJICAgIHJldHVybiBvYmo7CgkgIH0KCgkgIHZhciByZWdleHAgPSAvXCsvZzsKCSAgcXMgPSBxcy5zcGxpdChzZXApOwoKCSAgdmFyIG1heEtleXMgPSAxMDAwOwoJICBpZiAob3B0aW9ucyAmJiB0eXBlb2Ygb3B0aW9ucy5tYXhLZXlzID09PSAnbnVtYmVyJykgewoJICAgIG1heEtleXMgPSBvcHRpb25zLm1heEtleXM7CgkgIH0KCgkgIHZhciBsZW4gPSBxcy5sZW5ndGg7CgkgIC8vIG1heEtleXMgPD0gMCBtZWFucyB0aGF0IHdlIHNob3VsZCBub3QgbGltaXQga2V5cyBjb3VudAoJICBpZiAobWF4S2V5cyA+IDAgJiYgbGVuID4gbWF4S2V5cykgewoJICAgIGxlbiA9IG1heEtleXM7CgkgIH0KCgkgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHsKCSAgICB2YXIgeCA9IHFzW2ldLnJlcGxhY2UocmVnZXhwLCAnJTIwJyksCgkgICAgICAgIGlkeCA9IHguaW5kZXhPZihlcSksCgkgICAgICAgIGtzdHIsIHZzdHIsIGssIHY7CgoJICAgIGlmIChpZHggPj0gMCkgewoJICAgICAga3N0ciA9IHguc3Vic3RyKDAsIGlkeCk7CgkgICAgICB2c3RyID0geC5zdWJzdHIoaWR4ICsgMSk7CgkgICAgfSBlbHNlIHsKCSAgICAgIGtzdHIgPSB4OwoJICAgICAgdnN0ciA9ICcnOwoJICAgIH0KCgkgICAgayA9IGRlY29kZVVSSUNvbXBvbmVudChrc3RyKTsKCSAgICB2ID0gZGVjb2RlVVJJQ29tcG9uZW50KHZzdHIpOwoKCSAgICBpZiAoIWhhc093blByb3BlcnR5KG9iaiwgaykpIHsKCSAgICAgIG9ialtrXSA9IHY7CgkgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KG9ialtrXSkpIHsKCSAgICAgIG9ialtrXS5wdXNoKHYpOwoJICAgIH0gZWxzZSB7CgkgICAgICBvYmpba10gPSBbb2JqW2tdLCB2XTsKCSAgICB9CgkgIH0KCgkgIHJldHVybiBvYmo7Cgl9OwoKCi8qKiovIH0sCi8qIDQ2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLgoJLy8KCS8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCgkvLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCgkvLyAiU29mdHdhcmUiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nCgkvLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCgkvLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0CgkvLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUKCS8vIGZvbGxvd2luZyBjb25kaXRpb25zOgoJLy8KCS8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkCgkvLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KCS8vCgkvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUwoJLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgoJLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTgoJLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sCgkvLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKCS8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUKCS8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCgoJJ3VzZSBzdHJpY3QnOwoKCXZhciBzdHJpbmdpZnlQcmltaXRpdmUgPSBmdW5jdGlvbih2KSB7CgkgIHN3aXRjaCAodHlwZW9mIHYpIHsKCSAgICBjYXNlICdzdHJpbmcnOgoJICAgICAgcmV0dXJuIHY7CgoJICAgIGNhc2UgJ2Jvb2xlYW4nOgoJICAgICAgcmV0dXJuIHYgPyAndHJ1ZScgOiAnZmFsc2UnOwoKCSAgICBjYXNlICdudW1iZXInOgoJICAgICAgcmV0dXJuIGlzRmluaXRlKHYpID8gdiA6ICcnOwoKCSAgICBkZWZhdWx0OgoJICAgICAgcmV0dXJuICcnOwoJICB9Cgl9OwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqLCBzZXAsIGVxLCBuYW1lKSB7CgkgIHNlcCA9IHNlcCB8fCAnJic7CgkgIGVxID0gZXEgfHwgJz0nOwoJICBpZiAob2JqID09PSBudWxsKSB7CgkgICAgb2JqID0gdW5kZWZpbmVkOwoJICB9CgoJICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHsKCSAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5tYXAoZnVuY3Rpb24oaykgewoJICAgICAgdmFyIGtzID0gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShrKSkgKyBlcTsKCSAgICAgIGlmIChBcnJheS5pc0FycmF5KG9ialtrXSkpIHsKCSAgICAgICAgcmV0dXJuIG9ialtrXS5tYXAoZnVuY3Rpb24odikgewoJICAgICAgICAgIHJldHVybiBrcyArIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUodikpOwoJICAgICAgICB9KS5qb2luKHNlcCk7CgkgICAgICB9IGVsc2UgewoJICAgICAgICByZXR1cm4ga3MgKyBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG9ialtrXSkpOwoJICAgICAgfQoJICAgIH0pLmpvaW4oc2VwKTsKCgkgIH0KCgkgIGlmICghbmFtZSkgcmV0dXJuICcnOwoJICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShuYW1lKSkgKyBlcSArCgkgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG9iaikpOwoJfTsKCgovKioqLyB9LAovKiA0NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgaHR0cCA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CgoJdmFyIGh0dHBzID0gbW9kdWxlLmV4cG9ydHM7CgoJZm9yICh2YXIga2V5IGluIGh0dHApIHsKCSAgICBpZiAoaHR0cC5oYXNPd25Qcm9wZXJ0eShrZXkpKSBodHRwc1trZXldID0gaHR0cFtrZXldOwoJfTsKCglodHRwcy5yZXF1ZXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2IpIHsKCSAgICBpZiAoIXBhcmFtcykgcGFyYW1zID0ge307CgkgICAgcGFyYW1zLnNjaGVtZSA9ICdodHRwcyc7CgkgICAgcGFyYW1zLnByb3RvY29sID0gJ2h0dHBzOic7CgkgICAgcmV0dXJuIGh0dHAucmVxdWVzdC5jYWxsKHRoaXMsIHBhcmFtcywgY2IpOwoJfQoKCi8qKiovIH0sCi8qIDQ4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBxcyA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCgl2YXIgaHR0cCA9IF9fd2VicGFja19yZXF1aXJlX18oNikKCXZhciBodHRwcyA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCgl2YXIgdXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MCkKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIFBPU1Qob3B0aW9ucywgY2FsbGJhY2spIHsKCgkgIC8vIHJlcXVpcmUgb3B0aW9ucy51cmwgb3IgZmFpbCBub2lzaWx5IAoJICBpZiAoIW9wdGlvbnMudXJsKSB7CgkgICAgdGhyb3cgRXJyb3IoJ29wdGlvbnMudXJsIHJlcXVpcmVkJykKCSAgfQoKCSAgLy8gcGFyc2Ugb3V0IHRoZSBvcHRpb25zIGZyb20gb3B0aW9ucy51cmwKCSAgdmFyIG9wdHMgPSB1cmwucGFyc2Uob3B0aW9ucy51cmwpCgkgIHZhciBtZXRob2QgPSBvcHRzLnByb3RvY29sID09PSAnaHR0cHM6Jz8gaHR0cHMucmVxdWVzdCA6IGh0dHAucmVxdWVzdAoJICB2YXIgZGVmYXVsdENvbnRlbnRUeXBlID0gJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnCgoJICBvcHRzLm1ldGhvZCA9ICdQT1NUJwoJICBvcHRzLnJlamVjdFVuYXV0aG9yaXplZCA9IGZhbHNlCgkgIG9wdHMuYWdlbnQgPSBmYWxzZQoJICBvcHRzLmhlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnMgfHwge30KCSAgb3B0cy5oZWFkZXJzWydVc2VyLUFnZW50J10gPSBvcHRzLmhlYWRlcnNbJ1VzZXItQWdlbnQnXSB8fCAndGlueS1odHRwJwoJICBvcHRzLmhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddID0gb3B0cy5oZWFkZXJzWydDb250ZW50LVR5cGUnXSB8fCBkZWZhdWx0Q29udGVudFR5cGUKCSAgLy8gb3B0cy5oZWFkZXJzWydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnCgkgIHZhciByZXFKU09OID0gb3B0cy5oZWFkZXJzWydDb250ZW50LVR5cGUnXS5zdGFydHNXaXRoKCdhcHBsaWNhdGlvbi9qc29uJykKCSAgdmFyIHBvc3REYXRhID0gcmVxSlNPTj8gSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5kYXRhIHx8IHt9KSA6IHFzLnN0cmluZ2lmeShvcHRpb25zLmRhdGEgfHwge30pCgoJICAvLyBtYWtlIGEgUE9TVCByZXF1ZXN0CgkgIHZhciByZXEgPSBtZXRob2Qob3B0cywgZnVuY3Rpb24ocmVzKSB7CgkgICAKCSAgICB2YXIgcmF3RGF0YSA9ICcnCgkgICAgdmFyIHN0YXR1c0NvZGUgPSByZXMuc3RhdHVzQ29kZQoJICAgIHZhciBjb250ZW50VHlwZSA9IHJlcy5oZWFkZXJzWydjb250ZW50LXR5cGUnXQoJICAgIHZhciBpc0pTT04gPSBjb250ZW50VHlwZSA9PT0gJ2FwcGxpY2F0aW9uL2pzb24nCgoJICAgIGlmIChzdGF0dXNDb2RlICE9PSAyMDApIHsKCSAgICAgIGNhbGxiYWNrKEVycm9yKCdHRVQgZmFpbGVkIHdpdGg6ICcgKyBzdGF0dXNDb2RlKSkKCSAgICAgIHJlcy5yZXN1bWUoKQoJICAgICAgcmV0dXJuCgkgICAgfQoJIAoJICAgIHJlcy5zZXRFbmNvZGluZygndXRmOCcpCgkgICAgcmVzLm9uKCdkYXRhJywgZnVuY3Rpb24oY2h1bmspIHsgcmF3RGF0YSArPSBjaHVuayB9KQoJICAgIHJlcy5vbignZW5kJywgZnVuY3Rpb24oeCkgewoJICAgICAgdHJ5IHsKCSAgICAgICAgdmFyIHBhcnNlZERhdGEgPSBpc0pTT04/IEpTT04ucGFyc2UocmF3RGF0YSkgOiByYXdEYXRhCgkgICAgICAgIGNhbGxiYWNrKG51bGwsIHBhcnNlZERhdGEpCgkgICAgICB9IAoJICAgICAgY2F0Y2ggKGUpIHsKCSAgICAgICAgY2FsbGJhY2soZS5tZXNzYWdlKQoJICAgICAgfQoJICAgIH0pCgkgIH0pCgoJICByZXEub24oJ2Vycm9yJywgZnVuY3Rpb24oZSkgeyBjYWxsYmFjayhFcnJvcihlLm1lc3NhZ2UpKSB9KQoKCSAgcmVxLndyaXRlKHBvc3REYXRhKQoJIAoJICByZXEuZW5kKCkKCX0KCgovKioqLyB9LAovKiA0OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB2YWxpZGF0ZTsKCgl2YXIgX2FwaSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwoKCXZhciBfYXBpMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2FwaSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglmdW5jdGlvbiB2YWxpZGF0ZShtZXRob2QsIHBhcmFtcykgewoJICAvLyBnZXQgYWxsIHRoZSByZXF1cmllZCBwYXJhbXMgZm9yIHRoaXMgbWV0aG9kCgkgIHZhciByZXF1aXJlZCA9IF9hcGkyLmRlZmF1bHRbbWV0aG9kXS5maWx0ZXIoZnVuY3Rpb24gKHBhcmFtKSB7CgkgICAgcmV0dXJuIHBhcmFtLnJlcXVpcmVkID09PSAnUmVxdWlyZWQnOwoJICB9KTsKCSAgLy8gY29sbGVjdCBhbnkgbWlzc2luZyBwYXJhbXMKCSAgdmFyIG1pc3NpbmcgPSByZXF1aXJlZC5maWx0ZXIoZnVuY3Rpb24gKHBhcmFtKSB7CgkgICAgcmV0dXJuIHR5cGVvZiBwYXJhbXNbcGFyYW0ubmFtZV0gPT09ICd1bmRlZmluZWQnOwoJICB9KTsKCSAgLy8gb3B0aW1pc2l0Y2FsbHkgYXNzdW1lIHRoZSBiZXN0CgkgIHZhciBlcnIgPSBmYWxzZTsKCSAgLy8gYnV0IGhhdmUgYSBwbGFuIGZvciB0aGUgd29yc3QKCSAgaWYgKG1pc3NpbmcubGVuZ3RoKSB7CgkgICAgdmFyIGJ1bGxldHMgPSBtaXNzaW5nLm1hcChmdW5jdGlvbiAocGFyYW0pIHsKCSAgICAgIHJldHVybiAnLSAnICsgcGFyYW0ubmFtZSArICcgLi4uICcgKyBwYXJhbS5kZXNjcmlwdGlvbjsKCSAgICB9KTsKCSAgICB2YXIgbXNnID0gbWV0aG9kICsgJyBtaXNzaW5nIHBhcmFtczpcbicgKyBidWxsZXRzLmpvaW4oJ1xuJyk7CgkgICAgZXJyID0gRXJyb3IobXNnKTsKCSAgfQoJICByZXR1cm4gZXJyOwoJfSAvLwoJLy8gdmFsaWRhdGUgcmV0dXJucyBhbiBlcnJvciBvYmplY3QgaWYgYW55IHJlcXVpcmVkIHBhcmFtcyBhcmUgbWlzc2luZwoJLy8KCS8vIGV4YW1wbGUgdXNhZ2U6CgkvLyAKCS8vICAgLy8gdG9rZW4gYW5kIGlkIGFyZSByZXF1aXJlZCBwYXJhbXMKCS8vICAgZnVuY3Rpb24gYXBpQ2FsbChwYXJhbXMsIGNhbGxiYWNrKSB7IAoJLy8gICAgIGxldCBlcnIgPSB2YWxpZGF0ZSgnYXBpLnNpZ25hdHVyZScsIHBhcmFtcykKCS8vICAgICBpZiAoZXJyKSB7CgkvLyAgICAgICBjYWxsYmFjayhlcnIpCgkvLyAgICAgfQoJLy8gICAgIGVsc2UgewoJLy8gICAgICAgLy8gZG8gYXBpIGNhbGwKCS8vICAgICB9CgkvLyAgIH0KCS8vCgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDUwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gewoJCSJhcGkudGVzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAiZXJyb3IiLAoJCQkJImV4YW1wbGUiOiAibXlfZXJyb3IiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJFcnJvciByZXNwb25zZSB0byByZXR1cm5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZm9vIiwKCQkJCSJleGFtcGxlIjogImJhciIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogImV4YW1wbGUgcHJvcGVydHkgdG8gcmV0dXJuXG4iCgkJCX0KCQldLAoJCSJhdXRoLnJldm9rZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0ZXN0IiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTZXR0aW5nIHRoaXMgcGFyYW1ldGVyIHRvIDEgdHJpZ2dlcnMgYSB0ZXN0aW5nIG1vZGUgd2hlcmUgdGhlIHNwZWNpZmllZCB0b2tlbiB3aWxsIG5vdCBhY3R1YWxseSBiZSByZXZva2VkLlxuIgoJCQl9CgkJXSwKCQkiYXV0aC50ZXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogaWRlbnRpZnlcbiIKCQkJfQoJCV0sCgkJImJvdHMuaW5mbyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJzOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYm90IiwKCQkJCSJleGFtcGxlIjogIkIxMjM0NTY3OCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkJvdCB1c2VyIHRvIGdldCBpbmZvIG9uXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5hcmNoaXZlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gYXJjaGl2ZVxuIgoJCQl9CgkJXSwKCQkiY2hhbm5lbHMuY3JlYXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJteWNoYW5uZWwiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOYW1lIG9mIGNoYW5uZWwgdG8gY3JlYXRlXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5oaXN0b3J5IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6aGlzdG9yeVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byBmZXRjaCBoaXN0b3J5IGZvci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibGF0ZXN0IiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1ub3ciLAoJCQkJImRlc2NyaXB0aW9uIjogIkVuZCBvZiB0aW1lIHJhbmdlIG9mIG1lc3NhZ2VzIHRvIGluY2x1ZGUgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAib2xkZXN0IiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTdGFydCBvZiB0aW1lIHJhbmdlIG9mIG1lc3NhZ2VzIHRvIGluY2x1ZGUgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVzaXZlIiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgbWVzc2FnZXMgd2l0aCBsYXRlc3Qgb3Igb2xkZXN0IHRpbWVzdGFtcCBpbiByZXN1bHRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIxMDAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIG1lc3NhZ2VzIHRvIHJldHVybiwgYmV0d2VlbiAxIGFuZCAxMDAwLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1bnJlYWRzIiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgdW5yZWFkX2NvdW50X2Rpc3BsYXkgaW4gdGhlIG91dHB1dD9cbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLmluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIGdldCBpbmZvIG9uXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5pbnZpdGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byBpbnZpdGUgdXNlciB0by5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVzZXIgdG8gaW52aXRlIHRvIGNoYW5uZWwuXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5qb2luIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIk5hbWUgb2YgY2hhbm5lbCB0byBqb2luXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5raWNrIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gcmVtb3ZlIHVzZXIgZnJvbS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVzZXIgdG8gcmVtb3ZlIGZyb20gY2hhbm5lbC5cbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLmxlYXZlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gbGVhdmVcbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImV4Y2x1ZGVfYXJjaGl2ZWQiLAoJCQkJImV4YW1wbGUiOiAiMSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRG9uJ3QgcmV0dXJuIGFyY2hpdmVkIGNoYW5uZWxzLlxuIgoJCQl9CgkJXSwKCQkiY2hhbm5lbHMubWFyayI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIHNldCByZWFkaW5nIGN1cnNvciBpbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1vc3QgcmVjZW50bHkgc2VlbiBtZXNzYWdlLlxuIgoJCQl9CgkJXSwKCQkiY2hhbm5lbHMucmVuYW1lIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhbm5lbHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gcmVuYW1lXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm5hbWUiLAoJCQkJImV4YW1wbGUiOiAiwqAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOZXcgbmFtZSBmb3IgY2hhbm5lbC5cbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLnJlcGxpZXMiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczpoaXN0b3J5XG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIGZldGNoIHRocmVhZCBmcm9tXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRocmVhZF90cyIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVuaXF1ZSBpZGVudGlmaWVyIG9mIGEgdGhyZWFkJ3MgcGFyZW50IG1lc3NhZ2VcbiIKCQkJfQoJCV0sCgkJImNoYW5uZWxzLnNldFB1cnBvc2UiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byBzZXQgdGhlIHB1cnBvc2Ugb2ZcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicHVycG9zZSIsCgkJCQkiZXhhbXBsZSI6ICJNeSBQdXJwb3NlIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIG5ldyBwdXJwb3NlXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy5zZXRUb3BpYyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYW5uZWxzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHRvIHNldCB0aGUgdG9waWMgb2ZcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidG9waWMiLAoJCQkJImV4YW1wbGUiOiAiTXkgVG9waWMiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgbmV3IHRvcGljXG4iCgkJCX0KCQldLAoJCSJjaGFubmVscy51bmFyY2hpdmUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGFubmVsczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byB1bmFyY2hpdmVcbiIKCQkJfQoJCV0sCgkJImNoYXQuZGVsZXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2hhdDp3cml0ZTpib3Qgb3IgY2hhdDp3cml0ZTp1c2VyXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRzIiwKCQkJCSJleGFtcGxlIjogIjE0MDU4OTQzMjIuMDAyNzY4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtZXNzYWdlIHRvIGJlIGRlbGV0ZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIGNvbnRhaW5pbmcgdGhlIG1lc3NhZ2UgdG8gYmUgZGVsZXRlZC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYXNfdXNlciIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyB0cnVlIHRvIGRlbGV0ZSB0aGUgbWVzc2FnZSBhcyB0aGUgYXV0aGVkIHVzZXIuIEJvdCB1c2VycyBpbiB0aGlzIGNvbnRleHQgYXJlIGNvbnNpZGVyZWQgYXV0aGVkIHVzZXJzLlxuIgoJCQl9CgkJXSwKCQkiY2hhdC5tZU1lc3NhZ2UiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBjaGF0OndyaXRlOnVzZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gc2VuZCBtZXNzYWdlIHRvLiBDYW4gYmUgYSBwdWJsaWMgY2hhbm5lbCwgcHJpdmF0ZSBncm91cCBvciBJTSBjaGFubmVsLiBDYW4gYmUgYW4gZW5jb2RlZCBJRCwgb3IgYSBuYW1lLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0ZXh0IiwKCQkJCSJleGFtcGxlIjogIkhlbGxvIHdvcmxkIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGV4dCBvZiB0aGUgbWVzc2FnZSB0byBzZW5kLlxuIgoJCQl9CgkJXSwKCQkiY2hhdC5wb3N0TWVzc2FnZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYXQ6d3JpdGU6Ym90IG9yIGNoYXQ6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCwgcHJpdmF0ZSBncm91cCwgb3IgSU0gY2hhbm5lbCB0byBzZW5kIG1lc3NhZ2UgdG8uIENhbiBiZSBhbiBlbmNvZGVkIElELCBvciBhIG5hbWUuIFNlZSBiZWxvdyBmb3IgbW9yZSBkZXRhaWxzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0ZXh0IiwKCQkJCSJleGFtcGxlIjogIkhlbGxvIHdvcmxkIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGV4dCBvZiB0aGUgbWVzc2FnZSB0byBzZW5kLiBTZWUgYmVsb3cgZm9yIGFuIGV4cGxhbmF0aW9uIG9mIGZvcm1hdHRpbmcuIFRoaXMgZmllbGQgaXMgdXN1YWxseSByZXF1aXJlZCwgdW5sZXNzIHlvdSdyZSBwcm92aWRpbmcgb25seSBhdHRhY2htZW50cyBpbnN0ZWFkLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYXJzZSIsCgkJCQkiZXhhbXBsZSI6ICJmdWxsIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbmdlIGhvdyBtZXNzYWdlcyBhcmUgdHJlYXRlZC4gRGVmYXVsdHMgdG8gbm9uZS4gU2VlIGJlbG93LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJsaW5rX25hbWVzIiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaW5kIGFuZCBsaW5rIGNoYW5uZWwgbmFtZXMgYW5kIHVzZXJuYW1lcy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYXR0YWNobWVudHMiLAoJCQkJImV4YW1wbGUiOiAiW3tcInByZXRleHRcIjogXCJwcmUtaGVsbG9cIiwgXCJ0ZXh0XCI6IFwidGV4dC13b3JsZFwifV0iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTdHJ1Y3R1cmVkIG1lc3NhZ2UgYXR0YWNobWVudHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVuZnVybF9saW5rcyIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyB0cnVlIHRvIGVuYWJsZSB1bmZ1cmxpbmcgb2YgcHJpbWFyaWx5IHRleHQtYmFzZWQgY29udGVudC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidW5mdXJsX21lZGlhIiwKCQkJCSJleGFtcGxlIjogImZhbHNlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyBmYWxzZSB0byBkaXNhYmxlIHVuZnVybGluZyBvZiBtZWRpYSBjb250ZW50LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VybmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJNeSBCb3QiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJTZXQgeW91ciBib3QncyB1c2VyIG5hbWUuIE11c3QgYmUgdXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIGFzX3VzZXIgc2V0IHRvIGZhbHNlLCBvdGhlcndpc2UgaWdub3JlZC4gU2VlIGF1dGhvcnNoaXAgYmVsb3cuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImFzX3VzZXIiLAoJCQkJImV4YW1wbGUiOiAidHJ1ZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhc3MgdHJ1ZSB0byBwb3N0IHRoZSBtZXNzYWdlIGFzIHRoZSBhdXRoZWQgdXNlciwgaW5zdGVhZCBvZiBhcyBhIGJvdC4gRGVmYXVsdHMgdG8gZmFsc2UuIFNlZSBhdXRob3JzaGlwIGJlbG93LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpY29uX3VybCIsCgkJCQkiZXhhbXBsZSI6ICJodHRwOi8vbG9yZW1waXhlbC5jb20vNDgvNDgiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVUkwgdG8gYW4gaW1hZ2UgdG8gdXNlIGFzIHRoZSBpY29uIGZvciB0aGlzIG1lc3NhZ2UuIE11c3QgYmUgdXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIGFzX3VzZXIgc2V0IHRvIGZhbHNlLCBvdGhlcndpc2UgaWdub3JlZC4gU2VlIGF1dGhvcnNoaXAgYmVsb3cuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImljb25fZW1vamkiLAoJCQkJImV4YW1wbGUiOiAiOmNoYXJ0X3dpdGhfdXB3YXJkc190cmVuZDoiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJFbW9qaSB0byB1c2UgYXMgdGhlIGljb24gZm9yIHRoaXMgbWVzc2FnZS4gT3ZlcnJpZGVzIGljb25fdXJsLiBNdXN0IGJlIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCBhc191c2VyIHNldCB0byBmYWxzZSwgb3RoZXJ3aXNlIGlnbm9yZWQuIFNlZSBhdXRob3JzaGlwIGJlbG93LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aHJlYWRfdHMiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcm92aWRlIGFub3RoZXIgbWVzc2FnZSdzIHRzIHZhbHVlIHRvIG1ha2UgdGhpcyBtZXNzYWdlIGEgcmVwbHkuIEF2b2lkIHVzaW5nIGEgcmVwbHkncyB0cyB2YWx1ZTsgdXNlIGl0cyBwYXJlbnQgaW5zdGVhZC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicmVwbHlfYnJvYWRjYXN0IiwKCQkJCSJleGFtcGxlIjogInRydWUiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJVc2VkIGluIGNvbmp1bmN0aW9uIHdpdGggdGhyZWFkX3RzIGFuZCBpbmRpY2F0ZXMgd2hldGhlciByZXBseSBzaG91bGQgYmUgbWFkZSB2aXNpYmxlIHRvIGV2ZXJ5b25lIGluIHRoZSBjaGFubmVsIG9yIGNvbnZlcnNhdGlvbi4gRGVmYXVsdHMgdG8gZmFsc2UuXG4iCgkJCX0KCQldLAoJCSJjaGF0LnVwZGF0ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGNoYXQ6d3JpdGU6Ym90IG9yIGNoYXQ6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0cyIsCgkJCQkiZXhhbXBsZSI6ICIxNDA1ODk0MzIyLjAwMjc2OCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbWVzc2FnZSB0byBiZSB1cGRhdGVkLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCBjb250YWluaW5nIHRoZSBtZXNzYWdlIHRvIGJlIHVwZGF0ZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRleHQiLAoJCQkJImV4YW1wbGUiOiAiSGVsbG8gd29ybGQiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOZXcgdGV4dCBmb3IgdGhlIG1lc3NhZ2UsIHVzaW5nIHRoZSBkZWZhdWx0IGZvcm1hdHRpbmcgcnVsZXMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImF0dGFjaG1lbnRzIiwKCQkJCSJleGFtcGxlIjogIlt7XCJwcmV0ZXh0XCI6IFwicHJlLWhlbGxvXCIsIFwidGV4dFwiOiBcInRleHQtd29ybGRcIn1dIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU3RydWN0dXJlZCBtZXNzYWdlIGF0dGFjaG1lbnRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYXJzZSIsCgkJCQkiZXhhbXBsZSI6ICJub25lIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbmdlIGhvdyBtZXNzYWdlcyBhcmUgdHJlYXRlZC4gRGVmYXVsdHMgdG8gY2xpZW50LCB1bmxpa2UgY2hhdC5wb3N0TWVzc2FnZS4gU2VlIGJlbG93LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJsaW5rX25hbWVzIiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaW5kIGFuZCBsaW5rIGNoYW5uZWwgbmFtZXMgYW5kIHVzZXJuYW1lcy4gRGVmYXVsdHMgdG8gbm9uZS4gVGhpcyBwYXJhbWV0ZXIgc2hvdWxkIGJlIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCBwYXJzZS4gVG8gc2V0IGxpbmtfbmFtZXMgdG8gMSwgc3BlY2lmeSBhIHBhcnNlIG1vZGUgb2YgZnVsbC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYXNfdXNlciIsCgkJCQkiZXhhbXBsZSI6ICJ0cnVlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFzcyB0cnVlIHRvIHVwZGF0ZSB0aGUgbWVzc2FnZSBhcyB0aGUgYXV0aGVkIHVzZXIuIEJvdCB1c2VycyBpbiB0aGlzIGNvbnRleHQgYXJlIGNvbnNpZGVyZWQgYXV0aGVkIHVzZXJzLlxuIgoJCQl9CgkJXSwKCQkiZG5kLmVuZERuZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGRuZDp3cml0ZVxuIgoJCQl9CgkJXSwKCQkiZG5kLmVuZFNub296ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGRuZDp3cml0ZVxuIgoJCQl9CgkJXSwKCQkiZG5kLmluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBkbmQ6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVXNlciB0byBmZXRjaCBzdGF0dXMgZm9yIChkZWZhdWx0cyB0byBjdXJyZW50IHVzZXIpXG4iCgkJCX0KCQldLAoJCSJkbmQuc2V0U25vb3plIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZG5kOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm51bV9taW51dGVzIiwKCQkJCSJleGFtcGxlIjogIjYwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIG1pbnV0ZXMsIGZyb20gbm93LCB0byBzbm9vemUgdW50aWwuXG4iCgkJCX0KCQldLAoJCSJkbmQudGVhbUluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBkbmQ6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VycyIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNCxVNDU2NyIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIHVzZXJzIHRvIGZldGNoIERvIE5vdCBEaXN0dXJiIHN0YXR1cyBmb3JcbiIKCQkJfQoJCV0sCgkJImVtb2ppLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBlbW9qaTpyZWFkXG4iCgkJCX0KCQldLAoJCSJmaWxlcy5jb21tZW50cy5hZGQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBmaWxlczp3cml0ZTp1c2VyXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGUiLAoJCQkJImV4YW1wbGUiOiAiRjEyMzQ0Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIHRvIGFkZCBhIGNvbW1lbnQgdG8uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNvbW1lbnQiLAoJCQkJImV4YW1wbGUiOiAiRXZlcnlvbmUgc2hvdWxkIHRha2UgYSBtb21lbnQgdG8gcmVhZCB0aGlzIGZpbGUuIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGV4dCBvZiB0aGUgY29tbWVudCB0byBhZGQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ0Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIGlkIChlbmNvZGVkKSBvZiB3aGljaCBsb2NhdGlvbiB0byBhc3NvY2lhdGUgd2l0aCB0aGUgbmV3IGNvbW1lbnQuXG4iCgkJCX0KCQldLAoJCSJmaWxlcy5jb21tZW50cy5kZWxldGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBmaWxlczp3cml0ZTp1c2VyXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGUiLAoJCQkJImV4YW1wbGUiOiAiRjEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIHRvIGRlbGV0ZSBhIGNvbW1lbnQgZnJvbS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaWQiLAoJCQkJImV4YW1wbGUiOiAiRmMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIGNvbW1lbnQgdG8gZGVsZXRlLlxuIgoJCQl9CgkJXSwKCQkiZmlsZXMuY29tbWVudHMuZWRpdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGZpbGVzOndyaXRlOnVzZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgY29udGFpbmluZyB0aGUgY29tbWVudCB0byBlZGl0LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpZCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgY29tbWVudCB0byBlZGl0LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb21tZW50IiwKCQkJCSJleGFtcGxlIjogIkV2ZXJ5b25lIHNob3VsZCB0YWtlIGEgbW9tZW50IHRvIHJlYWQgdGhpcyBmaWxlLCBzZXJpb3VzbHkuIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGV4dCBvZiB0aGUgY29tbWVudCB0byBlZGl0LlxuIgoJCQl9CgkJXSwKCQkiZmlsZXMuZGVsZXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZmlsZXM6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIsKgIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSUQgb2YgZmlsZSB0byBkZWxldGUuXG4iCgkJCX0KCQldLAoJCSJmaWxlcy5pbmZvIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZmlsZXM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYyMTQ3NDgzODYyIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU3BlY2lmeSBhIGZpbGUgYnkgcHJvdmlkaW5nIGl0cyBJRC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMjAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIGl0ZW1zIHRvIHJldHVybiBwZXIgcGFnZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicGFnZSIsCgkJCQkiZXhhbXBsZSI6ICIyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYWdlIG51bWJlciBvZiByZXN1bHRzIHRvIHJldHVybi5cbiIKCQkJfQoJCV0sCgkJImZpbGVzLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBmaWxlczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgZmlsZXMgY3JlYXRlZCBieSBhIHNpbmdsZSB1c2VyLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsdGVyIGZpbGVzIGFwcGVhcmluZyBpbiBhIHNwZWNpZmljIGNoYW5uZWwsIGluZGljYXRlZCBieSBpdHMgSUQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRzX2Zyb20iLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgZmlsZXMgY3JlYXRlZCBhZnRlciB0aGlzIHRpbWVzdGFtcCAoaW5jbHVzaXZlKS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHNfdG8iLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1ub3ciLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbHRlciBmaWxlcyBjcmVhdGVkIGJlZm9yZSB0aGlzIHRpbWVzdGFtcCAoaW5jbHVzaXZlKS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidHlwZXMiLAoJCQkJImV4YW1wbGUiOiAiaW1hZ2VzIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1hbGwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbHRlciBmaWxlcyBieSB0eXBlOlxuXG5cbmFsbCAtIEFsbCBmaWxlc1xuc3BhY2VzIC0gUG9zdHNcbnNuaXBwZXRzIC0gU25pcHBldHNcbmltYWdlcyAtIEltYWdlIGZpbGVzXG5nZG9jcyAtIEdvb2dsZSBkb2NzXG56aXBzIC0gWmlwIGZpbGVzXG5wZGZzIC0gUERGIGZpbGVzXG5cblxuWW91IGNhbiBwYXNzIG11bHRpcGxlIHZhbHVlcyBpbiB0aGUgdHlwZXMgYXJndW1lbnQsIGxpa2UgdHlwZXM9c3BhY2VzLHNuaXBwZXRzLlRoZSBkZWZhdWx0IHZhbHVlIGlzIGFsbCwgd2hpY2ggZG9lcyBub3QgZmlsdGVyIHRoZSBsaXN0LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIyMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkiZmlsZXMucmV2b2tlUHVibGljVVJMIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZmlsZXM6d3JpdGU6dXNlclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSB0byByZXZva2VcbiIKCQkJfQoJCV0sCgkJImZpbGVzLnNoYXJlZFB1YmxpY1VSTCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGZpbGVzOndyaXRlOnVzZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gc2hhcmVcbiIKCQkJfQoJCV0sCgkJImZpbGVzLnVwbG9hZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGZpbGVzOndyaXRlOnVzZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICIuLi4iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbnRlbnRzIHZpYSBtdWx0aXBhcnQvZm9ybS1kYXRhLiBJZiBvbWl0dGluZyB0aGlzIHBhcmFtZXRlciwgeW91IG11c3Qgc3VibWl0IGNvbnRlbnQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNvbnRlbnQiLAoJCQkJImV4YW1wbGUiOiAiLi4uIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSBjb250ZW50cyB2aWEgYSBQT1NUIHZhcmlhYmxlLiBJZiBvbWl0dGluZyB0aGlzIHBhcmFtZXRlciwgeW91IG11c3QgcHJvdmlkZSBhIGZpbGUuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGV0eXBlIiwKCQkJCSJleGFtcGxlIjogInBocCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkEgZmlsZSB0eXBlIGlkZW50aWZpZXIuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVuYW1lIiwKCQkJCSJleGFtcGxlIjogImZvby50eHQiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlbmFtZSBvZiBmaWxlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aXRsZSIsCgkJCQkiZXhhbXBsZSI6ICJNeSBGaWxlIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGl0bGUgb2YgZmlsZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5pdGlhbF9jb21tZW50IiwKCQkJCSJleGFtcGxlIjogIkJlc3QhIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5pdGlhbCBjb21tZW50IHRvIGFkZCB0byBmaWxlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVscyIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIGNoYW5uZWwgbmFtZXMgb3IgSURzIHdoZXJlIHRoZSBmaWxlIHdpbGwgYmUgc2hhcmVkLlxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLmFyY2hpdmUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBhcmNoaXZlXG4iCgkJCX0KCQldLAoJCSJncm91cHMuY2xvc2UiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBjbG9zZS5cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5jcmVhdGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIk5hbWUgb2YgcHJpdmF0ZSBjaGFubmVsIHRvIGNyZWF0ZVxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLmNyZWF0ZUNoaWxkIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gY2xvbmUgYW5kIGFyY2hpdmUuXG4iCgkJCX0KCQldLAoJCSJncm91cHMuaGlzdG9yeSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3VwczpoaXN0b3J5XG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gZmV0Y2ggaGlzdG9yeSBmb3IuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImxhdGVzdCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9bm93IiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJFbmQgb2YgdGltZSByYW5nZSBvZiBtZXNzYWdlcyB0byBpbmNsdWRlIGluIHJlc3VsdHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm9sZGVzdCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU3RhcnQgb2YgdGltZSByYW5nZSBvZiBtZXNzYWdlcyB0byBpbmNsdWRlIGluIHJlc3VsdHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImluY2x1c2l2ZSIsCgkJCQkiZXhhbXBsZSI6ICIxIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIG1lc3NhZ2VzIHdpdGggbGF0ZXN0IG9yIG9sZGVzdCB0aW1lc3RhbXAgaW4gcmVzdWx0cy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMTAwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xMDAiLAoJCQkJImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBtZXNzYWdlcyB0byByZXR1cm4sIGJldHdlZW4gMSBhbmQgMTAwMC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidW5yZWFkcyIsCgkJCQkiZXhhbXBsZSI6ICIxIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHVucmVhZF9jb3VudF9kaXNwbGF5IGluIHRoZSBvdXRwdXQ/XG4iCgkJCX0KCQldLAoJCSJncm91cHMuaW5mbyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3VwczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gZ2V0IGluZm8gb25cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5pbnZpdGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBpbnZpdGUgdXNlciB0by5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVzZXIgdG8gaW52aXRlLlxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLmtpY2siOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byByZW1vdmUgdXNlciBmcm9tLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVXNlciB0byByZW1vdmUgZnJvbSBwcml2YXRlIGNoYW5uZWwuXG4iCgkJCX0KCQldLAoJCSJncm91cHMubGVhdmUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBsZWF2ZVxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJleGNsdWRlX2FyY2hpdmVkIiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIkRvbid0IHJldHVybiBhcmNoaXZlZCBwcml2YXRlIGNoYW5uZWxzLlxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLm1hcmsiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBzZXQgcmVhZGluZyBjdXJzb3IgaW4uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRzIiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtb3N0IHJlY2VudGx5IHNlZW4gbWVzc2FnZS5cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5vcGVuIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gb3Blbi5cbiIKCQkJfQoJCV0sCgkJImdyb3Vwcy5yZW5hbWUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byByZW5hbWVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIk5ldyBuYW1lIGZvciBwcml2YXRlIGNoYW5uZWwuXG4iCgkJCX0KCQldLAoJCSJncm91cHMucmVwbGllcyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3VwczpoaXN0b3J5XG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQcml2YXRlIGNoYW5uZWwgdG8gZmV0Y2ggdGhyZWFkIGZyb21cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGhyZWFkX3RzIiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVW5pcXVlIGlkZW50aWZpZXIgb2YgYSB0aHJlYWQncyBwYXJlbnQgbWVzc2FnZVxuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLnNldFB1cnBvc2UiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBzZXQgdGhlIHB1cnBvc2Ugb2ZcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicHVycG9zZSIsCgkJCQkiZXhhbXBsZSI6ICJNeSBQdXJwb3NlIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIG5ldyBwdXJwb3NlXG4iCgkJCX0KCQldLAoJCSJncm91cHMuc2V0VG9waWMiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJHMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlByaXZhdGUgY2hhbm5lbCB0byBzZXQgdGhlIHRvcGljIG9mXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRvcGljIiwKCQkJCSJleGFtcGxlIjogIk15IFRvcGljIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIG5ldyB0b3BpY1xuIgoJCQl9CgkJXSwKCQkiZ3JvdXBzLnVuYXJjaGl2ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkcxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUHJpdmF0ZSBjaGFubmVsIHRvIHVuYXJjaGl2ZVxuIgoJCQl9CgkJXSwKCQkiaW0uY2xvc2UiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBpbTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkQxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRGlyZWN0IG1lc3NhZ2UgY2hhbm5lbCB0byBjbG9zZS5cbiIKCQkJfQoJCV0sCgkJImltLmhpc3RvcnkiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBpbTpoaXN0b3J5XG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRDEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJEaXJlY3QgbWVzc2FnZSBjaGFubmVsIHRvIGZldGNoIGhpc3RvcnkgZm9yLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJsYXRlc3QiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PW5vdyIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRW5kIG9mIHRpbWUgcmFuZ2Ugb2YgbWVzc2FnZXMgdG8gaW5jbHVkZSBpbiByZXN1bHRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJvbGRlc3QiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIlN0YXJ0IG9mIHRpbWUgcmFuZ2Ugb2YgbWVzc2FnZXMgdG8gaW5jbHVkZSBpbiByZXN1bHRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdXNpdmUiLAoJCQkJImV4YW1wbGUiOiAiMSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSBtZXNzYWdlcyB3aXRoIGxhdGVzdCBvciBvbGRlc3QgdGltZXN0YW1wIGluIHJlc3VsdHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNvdW50IiwKCQkJCSJleGFtcGxlIjogIjEwMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgbWVzc2FnZXMgdG8gcmV0dXJuLCBiZXR3ZWVuIDEgYW5kIDEwMDAuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVucmVhZHMiLAoJCQkJImV4YW1wbGUiOiAiMSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSB1bnJlYWRfY291bnRfZGlzcGxheSBpbiB0aGUgb3V0cHV0P1xuIgoJCQl9CgkJXSwKCQkiaW0ubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGltOnJlYWRcbiIKCQkJfQoJCV0sCgkJImltLm1hcmsiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBpbTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkQxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRGlyZWN0IG1lc3NhZ2UgY2hhbm5lbCB0byBzZXQgcmVhZGluZyBjdXJzb3IgaW4uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRzIiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtb3N0IHJlY2VudGx5IHNlZW4gbWVzc2FnZS5cbiIKCQkJfQoJCV0sCgkJImltLm9wZW4iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBpbTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVXNlciB0byBvcGVuIGEgZGlyZWN0IG1lc3NhZ2UgY2hhbm5lbCB3aXRoLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJyZXR1cm5faW0iLAoJCQkJImV4YW1wbGUiOiAiwqAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJCb29sZWFuLCBpbmRpY2F0ZXMgeW91IHdhbnQgdGhlIGZ1bGwgSU0gY2hhbm5lbCBkZWZpbml0aW9uIGluIHRoZSByZXNwb25zZS5cbiIKCQkJfQoJCV0sCgkJImltLnJlcGxpZXMiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBpbTpoaXN0b3J5XG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJEaXJlY3QgbWVzc2FnZSBjaGFubmVsIHRvIGZldGNoIHRocmVhZCBmcm9tXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRocmVhZF90cyIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVuaXF1ZSBpZGVudGlmaWVyIG9mIGEgdGhyZWFkJ3MgcGFyZW50IG1lc3NhZ2VcbiIKCQkJfQoJCV0sCgkJIm1waW0uY2xvc2UiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBtcGltOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJNUElNIHRvIGNsb3NlLlxuIgoJCQl9CgkJXSwKCQkibXBpbS5oaXN0b3J5IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogbXBpbTpoaXN0b3J5XG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJNdWx0aXBhcnR5IGRpcmVjdCBtZXNzYWdlIHRvIGZldGNoIGhpc3RvcnkgZm9yLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJsYXRlc3QiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PW5vdyIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRW5kIG9mIHRpbWUgcmFuZ2Ugb2YgbWVzc2FnZXMgdG8gaW5jbHVkZSBpbiByZXN1bHRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJvbGRlc3QiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTAiLAoJCQkJImRlc2NyaXB0aW9uIjogIlN0YXJ0IG9mIHRpbWUgcmFuZ2Ugb2YgbWVzc2FnZXMgdG8gaW5jbHVkZSBpbiByZXN1bHRzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdXNpdmUiLAoJCQkJImV4YW1wbGUiOiAiMSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSBtZXNzYWdlcyB3aXRoIGxhdGVzdCBvciBvbGRlc3QgdGltZXN0YW1wIGluIHJlc3VsdHMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNvdW50IiwKCQkJCSJleGFtcGxlIjogIjEwMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MTAwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgbWVzc2FnZXMgdG8gcmV0dXJuLCBiZXR3ZWVuIDEgYW5kIDEwMDAuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVucmVhZHMiLAoJCQkJImV4YW1wbGUiOiAiMSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSB1bnJlYWRfY291bnRfZGlzcGxheSBpbiB0aGUgb3V0cHV0P1xuIgoJCQl9CgkJXSwKCQkibXBpbS5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogbXBpbTpyZWFkXG4iCgkJCX0KCQldLAoJCSJtcGltLm1hcmsiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBtcGltOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiRzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJtdWx0aXBhcnR5IGRpcmVjdCBtZXNzYWdlIGNoYW5uZWwgdG8gc2V0IHJlYWRpbmcgY3Vyc29yIGluLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0cyIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbW9zdCByZWNlbnRseSBzZWVuIG1lc3NhZ2UuXG4iCgkJCX0KCQldLAoJCSJtcGltLm9wZW4iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBtcGltOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXJzIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0NTY3ODkwLFUyMzQ1Njc4OTAxLFUzNDU2Nzg5MDEyIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ29tbWEgc2VwYXJhdGVkIGxpc3RzIG9mIHVzZXJzLiAgVGhlIG9yZGVyaW5nIG9mIHRoZSB1c2VycyBpcyBwcmVzZXJ2ZWQgd2hlbmV2ZXIgYSBNUElNIGdyb3VwIGlzIHJldHVybmVkLlxuIgoJCQl9CgkJXSwKCQkibXBpbS5yZXBsaWVzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogbXBpbTpoaXN0b3J5XG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJNdWx0aXBhcnR5IGRpcmVjdCBtZXNzYWdlIGNoYW5uZWwgdG8gZmV0Y2ggdGhyZWFkIGZyb20uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRocmVhZF90cyIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVuaXF1ZSBpZGVudGlmaWVyIG9mIGEgdGhyZWFkJ3MgcGFyZW50IG1lc3NhZ2UuXG4iCgkJCX0KCQldLAoJCSJvYXV0aC5hY2Nlc3MiOiBbCgkJCXsKCQkJCSJuYW1lIjogImNsaWVudF9pZCIsCgkJCQkiZXhhbXBsZSI6ICI0YjM5ZTktNzUyYzQiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJc3N1ZWQgd2hlbiB5b3UgY3JlYXRlZCB5b3VyIGFwcGxpY2F0aW9uLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjbGllbnRfc2VjcmV0IiwKCQkJCSJleGFtcGxlIjogIjMzZmVhMDExM2Y1YjEiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJc3N1ZWQgd2hlbiB5b3UgY3JlYXRlZCB5b3VyIGFwcGxpY2F0aW9uLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjb2RlIiwKCQkJCSJleGFtcGxlIjogImNjZGFhNzJhZCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRoZSBjb2RlIHBhcmFtIHJldHVybmVkIHZpYSB0aGUgT0F1dGggY2FsbGJhY2suXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInJlZGlyZWN0X3VyaSIsCgkJCQkiZXhhbXBsZSI6ICJodHRwOi8vZXhhbXBsZS5jb20iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGlzIG11c3QgbWF0Y2ggdGhlIG9yaWdpbmFsbHkgc3VibWl0dGVkIFVSSSAoaWYgb25lIHdhcyBzZW50KS5cbiIKCQkJfQoJCV0sCgkJInBpbnMuYWRkIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogcGluczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byBwaW4gdGhlIGl0ZW0gaW4uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGUiLAoJCQkJImV4YW1wbGUiOiAiRjEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIHRvIHBpbi5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZV9jb21tZW50IiwKCQkJCSJleGFtcGxlIjogIkZjMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgY29tbWVudCB0byBwaW4uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRpbWVzdGFtcCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbWVzc2FnZSB0byBwaW4uXG4iCgkJCX0KCQldLAoJCSJwaW5zLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBwaW5zOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gZ2V0IHBpbm5lZCBpdGVtcyBmb3IuXG4iCgkJCX0KCQldLAoJCSJwaW5zLnJlbW92ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHBpbnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgd2hlcmUgdGhlIGl0ZW0gaXMgcGlubmVkIHRvLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSB0byB1bi1waW4uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVfY29tbWVudCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbW1lbnQgdG8gdW4tcGluLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aW1lc3RhbXAiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1lc3NhZ2UgdG8gdW4tcGluLlxuIgoJCQl9CgkJXSwKCQkicmVhY3Rpb25zLmFkZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHJlYWN0aW9uczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJuYW1lIiwKCQkJCSJleGFtcGxlIjogInRodW1ic3VwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUmVhY3Rpb24gKGVtb2ppKSBuYW1lLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSB0byBhZGQgcmVhY3Rpb24gdG8uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVfY29tbWVudCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbW1lbnQgdG8gYWRkIHJlYWN0aW9uIHRvLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB3aGVyZSB0aGUgbWVzc2FnZSB0byBhZGQgcmVhY3Rpb24gdG8gd2FzIHBvc3RlZC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGltZXN0YW1wIiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtZXNzYWdlIHRvIGFkZCByZWFjdGlvbiB0by5cbiIKCQkJfQoJCV0sCgkJInJlYWN0aW9ucy5nZXQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZWFjdGlvbnM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlIiwKCQkJCSJleGFtcGxlIjogIkYxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSB0byBnZXQgcmVhY3Rpb25zIGZvci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZV9jb21tZW50IiwKCQkJCSJleGFtcGxlIjogIkZjMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgY29tbWVudCB0byBnZXQgcmVhY3Rpb25zIGZvci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgd2hlcmUgdGhlIG1lc3NhZ2UgdG8gZ2V0IHJlYWN0aW9ucyBmb3Igd2FzIHBvc3RlZC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGltZXN0YW1wIiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtZXNzYWdlIHRvIGdldCByZWFjdGlvbnMgZm9yLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmdWxsIiwKCQkJCSJleGFtcGxlIjogIsKgIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSWYgdHJ1ZSBhbHdheXMgcmV0dXJuIHRoZSBjb21wbGV0ZSByZWFjdGlvbiBsaXN0LlxuIgoJCQl9CgkJXSwKCQkicmVhY3Rpb25zLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZWFjdGlvbnM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU2hvdyByZWFjdGlvbnMgbWFkZSBieSB0aGlzIHVzZXIuIERlZmF1bHRzIHRvIHRoZSBhdXRoZWQgdXNlci5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZnVsbCIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIklmIHRydWUgYWx3YXlzIHJldHVybiB0aGUgY29tcGxldGUgcmVhY3Rpb24gbGlzdC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMjAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIGl0ZW1zIHRvIHJldHVybiBwZXIgcGFnZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicGFnZSIsCgkJCQkiZXhhbXBsZSI6ICIyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYWdlIG51bWJlciBvZiByZXN1bHRzIHRvIHJldHVybi5cbiIKCQkJfQoJCV0sCgkJInJlYWN0aW9ucy5yZW1vdmUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZWFjdGlvbnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJ0aHVtYnN1cCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlJlYWN0aW9uIChlbW9qaSkgbmFtZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZmlsZSIsCgkJCQkiZXhhbXBsZSI6ICJGMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgdG8gcmVtb3ZlIHJlYWN0aW9uIGZyb20uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVfY29tbWVudCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbW1lbnQgdG8gcmVtb3ZlIHJlYWN0aW9uIGZyb20uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWwiLAoJCQkJImV4YW1wbGUiOiAiQzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFubmVsIHdoZXJlIHRoZSBtZXNzYWdlIHRvIHJlbW92ZSByZWFjdGlvbiBmcm9tIHdhcyBwb3N0ZWQuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInRpbWVzdGFtcCIsCgkJCQkiZXhhbXBsZSI6ICIxMjM0NTY3ODkwLjEyMzQ1NiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBvZiB0aGUgbWVzc2FnZSB0byByZW1vdmUgcmVhY3Rpb24gZnJvbS5cbiIKCQkJfQoJCV0sCgkJInJlbWluZGVycy5hZGQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZW1pbmRlcnM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGV4dCIsCgkJCQkiZXhhbXBsZSI6ICJlYXQgYSBiYW5hbmEiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgY29udGVudCBvZiB0aGUgcmVtaW5kZXJcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGltZSIsCgkJCQkiZXhhbXBsZSI6ICIxNjAyMjg4MDAwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiV2hlbiB0aGlzIHJlbWluZGVyIHNob3VsZCBoYXBwZW46IHRoZSBVbml4IHRpbWVzdGFtcCAodXAgdG8gZml2ZSB5ZWFycyBmcm9tIG5vdyksIHRoZSBudW1iZXIgb2Ygc2Vjb25kcyB1bnRpbCB0aGUgcmVtaW5kZXIgKGlmIHdpdGhpbiAyNCBob3VycyksIG9yIGEgbmF0dXJhbCBsYW5ndWFnZSBkZXNjcmlwdGlvbiAoRXguIFwiaW4gMTUgbWludXRlcyxcIiBvciBcImV2ZXJ5IFRodXJzZGF5XCIpXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXIiLAoJCQkJImV4YW1wbGUiOiAiVTE4ODg4ODg4IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIHVzZXIgd2hvIHdpbGwgcmVjZWl2ZSB0aGUgcmVtaW5kZXIuIElmIG5vIHVzZXIgaXMgc3BlY2lmaWVkLCB0aGUgcmVtaW5kZXIgd2lsbCBnbyB0byB1c2VyIHdobyBjcmVhdGVkIGl0LlxuIgoJCQl9CgkJXSwKCQkicmVtaW5kZXJzLmNvbXBsZXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogcmVtaW5kZXJzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInJlbWluZGVyIiwKCQkJCSJleGFtcGxlIjogIlJtMTIzNDU2NzgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgSUQgb2YgdGhlIHJlbWluZGVyIHRvIGJlIG1hcmtlZCBhcyBjb21wbGV0ZVxuIgoJCQl9CgkJXSwKCQkicmVtaW5kZXJzLmRlbGV0ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHJlbWluZGVyczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJyZW1pbmRlciIsCgkJCQkiZXhhbXBsZSI6ICJSbTEyMzQ1Njc4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIElEIG9mIHRoZSByZW1pbmRlclxuIgoJCQl9CgkJXSwKCQkicmVtaW5kZXJzLmluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZW1pbmRlcnM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJyZW1pbmRlciIsCgkJCQkiZXhhbXBsZSI6ICJSbTIzNDU2Nzg5IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIElEIG9mIHRoZSByZW1pbmRlclxuIgoJCQl9CgkJXSwKCQkicmVtaW5kZXJzLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiByZW1pbmRlcnM6cmVhZFxuIgoJCQl9CgkJXSwKCQkicnRtLnN0YXJ0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogY2xpZW50XG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInNpbXBsZV9sYXRlc3QiLAoJCQkJImV4YW1wbGUiOiAiwqAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJSZXR1cm4gdGltZXN0YW1wIG9ubHkgZm9yIGxhdGVzdCBtZXNzYWdlIG9iamVjdCBvZiBlYWNoIGNoYW5uZWwgKGltcHJvdmVzIHBlcmZvcm1hbmNlKS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibm9fdW5yZWFkcyIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlNraXAgdW5yZWFkIGNvdW50cyBmb3IgZWFjaCBjaGFubmVsIChpbXByb3ZlcyBwZXJmb3JtYW5jZSkuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm1waW1fYXdhcmUiLAoJCQkJImV4YW1wbGUiOiAiwqAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJSZXR1cm5zIE1QSU1zIHRvIHRoZSBjbGllbnQgaW4gdGhlIEFQSSByZXNwb25zZS5cbiIKCQkJfQoJCV0sCgkJInNlYXJjaC5hbGwiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBzZWFyY2g6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJxdWVyeSIsCgkJCQkiZXhhbXBsZSI6ICJwaWNrbGVmYWNlIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiU2VhcmNoIHF1ZXJ5LiBNYXkgY29udGFpbnMgYm9vbGVhbnMsIGV0Yy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAic29ydCIsCgkJCQkiZXhhbXBsZSI6ICJ0aW1lc3RhbXAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PXNjb3JlIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJSZXR1cm4gbWF0Y2hlcyBzb3J0ZWQgYnkgZWl0aGVyIHNjb3JlIG9yIHRpbWVzdGFtcC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAic29ydF9kaXIiLAoJCQkJImV4YW1wbGUiOiAiYXNjIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1kZXNjIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFuZ2Ugc29ydCBkaXJlY3Rpb24gdG8gYXNjZW5kaW5nIChhc2MpIG9yIGRlc2NlbmRpbmcgKGRlc2MpLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJoaWdobGlnaHQiLAoJCQkJImV4YW1wbGUiOiAiMSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhc3MgYSB2YWx1ZSBvZiAxIHRvIGVuYWJsZSBxdWVyeSBoaWdobGlnaHQgbWFya2VycyAoc2VlIGJlbG93KS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMjAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTIwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkic2VhcmNoLmZpbGVzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogc2VhcmNoOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicXVlcnkiLAoJCQkJImV4YW1wbGUiOiAicGlja2xlZmFjZSIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlNlYXJjaCBxdWVyeS4gTWF5IGNvbnRhaW4gYm9vbGVhbnMsIGV0Yy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAic29ydCIsCgkJCQkiZXhhbXBsZSI6ICJ0aW1lc3RhbXAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PXNjb3JlIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJSZXR1cm4gbWF0Y2hlcyBzb3J0ZWQgYnkgZWl0aGVyIHNjb3JlIG9yIHRpbWVzdGFtcC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAic29ydF9kaXIiLAoJCQkJImV4YW1wbGUiOiAiYXNjIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1kZXNjIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDaGFuZ2Ugc29ydCBkaXJlY3Rpb24gdG8gYXNjZW5kaW5nIChhc2MpIG9yIGRlc2NlbmRpbmcgKGRlc2MpLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJoaWdobGlnaHQiLAoJCQkJImV4YW1wbGUiOiAiMSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhc3MgYSB2YWx1ZSBvZiAxIHRvIGVuYWJsZSBxdWVyeSBoaWdobGlnaHQgbWFya2VycyAoc2VlIGJlbG93KS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMjAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTIwIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJOdW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuIHBlciBwYWdlLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwYWdlIiwKCQkJCSJleGFtcGxlIjogIjIiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEiLAoJCQkJImRlc2NyaXB0aW9uIjogIlBhZ2UgbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuLlxuIgoJCQl9CgkJXSwKCQkic2VhcmNoLm1lc3NhZ2VzIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogc2VhcmNoOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicXVlcnkiLAoJCQkJImV4YW1wbGUiOiAicGlja2xlZmFjZSIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlNlYXJjaCBxdWVyeS4gTWF5IGNvbnRhaW5zIGJvb2xlYW5zLCBldGMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInNvcnQiLAoJCQkJImV4YW1wbGUiOiAidGltZXN0YW1wIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1zY29yZSIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUmV0dXJuIG1hdGNoZXMgc29ydGVkIGJ5IGVpdGhlciBzY29yZSBvciB0aW1lc3RhbXAuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInNvcnRfZGlyIiwKCQkJCSJleGFtcGxlIjogImFzYyIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9ZGVzYyIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbmdlIHNvcnQgZGlyZWN0aW9uIHRvIGFzY2VuZGluZyAoYXNjKSBvciBkZXNjZW5kaW5nIChkZXNjKS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaGlnaGxpZ2h0IiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYXNzIGEgdmFsdWUgb2YgMSB0byBlbmFibGUgcXVlcnkgaGlnaGxpZ2h0IG1hcmtlcnMgKHNlZSBiZWxvdykuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNvdW50IiwKCQkJCSJleGFtcGxlIjogIjIwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0yMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIGl0ZW1zIHRvIHJldHVybiBwZXIgcGFnZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicGFnZSIsCgkJCQkiZXhhbXBsZSI6ICIyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYWdlIG51bWJlciBvZiByZXN1bHRzIHRvIHJldHVybi5cbiIKCQkJfQoJCV0sCgkJInN0YXJzLmFkZCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHN0YXJzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGUiLAoJCQkJImV4YW1wbGUiOiAiRjEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIHRvIGFkZCBzdGFyIHRvLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJmaWxlX2NvbW1lbnQiLAoJCQkJImV4YW1wbGUiOiAiRmMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsZSBjb21tZW50IHRvIGFkZCBzdGFyIHRvLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVsIiwKCQkJCSJleGFtcGxlIjogIkMxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQ2hhbm5lbCB0byBhZGQgc3RhciB0bywgb3IgY2hhbm5lbCB3aGVyZSB0aGUgbWVzc2FnZSB0byBhZGQgc3RhciB0byB3YXMgcG9zdGVkICh1c2VkIHdpdGggdGltZXN0YW1wKS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidGltZXN0YW1wIiwKCQkJCSJleGFtcGxlIjogIjEyMzQ1Njc4OTAuMTIzNDU2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGltZXN0YW1wIG9mIHRoZSBtZXNzYWdlIHRvIGFkZCBzdGFyIHRvLlxuIgoJCQl9CgkJXSwKCQkic3RhcnMubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHN0YXJzOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMjAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIGl0ZW1zIHRvIHJldHVybiBwZXIgcGFnZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicGFnZSIsCgkJCQkiZXhhbXBsZSI6ICIyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYWdlIG51bWJlciBvZiByZXN1bHRzIHRvIHJldHVybi5cbiIKCQkJfQoJCV0sCgkJInN0YXJzLnJlbW92ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHN0YXJzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGUiLAoJCQkJImV4YW1wbGUiOiAiRjEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIHRvIHJlbW92ZSBzdGFyIGZyb20uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImZpbGVfY29tbWVudCIsCgkJCQkiZXhhbXBsZSI6ICJGYzEyMzQ1Njc4OTAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWxlIGNvbW1lbnQgdG8gcmVtb3ZlIHN0YXIgZnJvbS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY2hhbm5lbCIsCgkJCQkiZXhhbXBsZSI6ICJDMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkNoYW5uZWwgdG8gcmVtb3ZlIHN0YXIgZnJvbSwgb3IgY2hhbm5lbCB3aGVyZSB0aGUgbWVzc2FnZSB0byByZW1vdmUgc3RhciBmcm9tIHdhcyBwb3N0ZWQgKHVzZWQgd2l0aCB0aW1lc3RhbXApLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ0aW1lc3RhbXAiLAoJCQkJImV4YW1wbGUiOiAiMTIzNDU2Nzg5MC4xMjM0NTYiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaW1lc3RhbXAgb2YgdGhlIG1lc3NhZ2UgdG8gcmVtb3ZlIHN0YXIgZnJvbS5cbiIKCQkJfQoJCV0sCgkJInRlYW0uYWNjZXNzTG9ncyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IGFkbWluXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNvdW50IiwKCQkJCSJleGFtcGxlIjogIjIwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xMDAiLAoJCQkJImRlc2NyaXB0aW9uIjogIk51bWJlciBvZiBpdGVtcyB0byByZXR1cm4gcGVyIHBhZ2UuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInBhZ2UiLAoJCQkJImV4YW1wbGUiOiAiMiIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwsIGRlZmF1bHQ9MSIsCgkJCQkiZGVzY3JpcHRpb24iOiAiUGFnZSBudW1iZXIgb2YgcmVzdWx0cyB0byByZXR1cm4uXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImJlZm9yZSIsCgkJCQkiZXhhbXBsZSI6ICIxNDU3OTg5MTY2IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD1ub3ciLAoJCQkJImRlc2NyaXB0aW9uIjogIkVuZCBvZiB0aW1lIHJhbmdlIG9mIGxvZ3MgdG8gaW5jbHVkZSBpbiByZXN1bHRzIChpbmNsdXNpdmUpLlxuIgoJCQl9CgkJXSwKCQkidGVhbS5iaWxsYWJsZUluZm8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBhZG1pblxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSB1c2VyIHRvIHJldHJpZXZlIHRoZSBiaWxsYWJsZSBpbmZvcm1hdGlvbiBmb3IuIERlZmF1bHRzIHRvIGFsbCB1c2Vycy5cbiIKCQkJfQoJCV0sCgkJInRlYW0uaW5mbyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHRlYW06cmVhZFxuIgoJCQl9CgkJXSwKCQkidGVhbS5pbnRlZ3JhdGlvbkxvZ3MiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBhZG1pblxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJzZXJ2aWNlX2lkIiwKCQkJCSJleGFtcGxlIjogIsKgIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsdGVyIGxvZ3MgdG8gdGhpcyBzZXJ2aWNlLiBEZWZhdWx0cyB0byBhbGwgbG9ncy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiYXBwX2lkIiwKCQkJCSJleGFtcGxlIjogIsKgIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsdGVyIGxvZ3MgdG8gdGhpcyBTbGFjayBhcHAuIERlZmF1bHRzIHRvIGFsbCBsb2dzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsdGVyIGxvZ3MgZ2VuZXJhdGVkIGJ5IHRoaXMgdXNlcuKAmXMgYWN0aW9ucy4gRGVmYXVsdHMgdG8gYWxsIGxvZ3MuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5nZV90eXBlIiwKCQkJCSJleGFtcGxlIjogImFkZGVkIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRmlsdGVyIGxvZ3Mgd2l0aCB0aGlzIGNoYW5nZSB0eXBlLiBEZWZhdWx0cyB0byBhbGwgbG9ncy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMjAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsLCBkZWZhdWx0PTEwMCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiTnVtYmVyIG9mIGl0ZW1zIHRvIHJldHVybiBwZXIgcGFnZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAicGFnZSIsCgkJCQkiZXhhbXBsZSI6ICIyIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0xIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJQYWdlIG51bWJlciBvZiByZXN1bHRzIHRvIHJldHVybi5cbiIKCQkJfQoJCV0sCgkJInRlYW0ucHJvZmlsZS5nZXQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2Vycy5wcm9maWxlOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidmlzaWJpbGl0eSIsCgkJCQkiZXhhbXBsZSI6ICJhbGwiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJGaWx0ZXIgYnkgdmlzaWJpbGl0eS5cbiIKCQkJfQoJCV0sCgkJInVzZXJncm91cHMuY3JlYXRlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcmdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJuYW1lIiwKCQkJCSJleGFtcGxlIjogIk15IFRlc3QgVGVhbSIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkEgbmFtZSBmb3IgdGhlIFVzZXIgR3JvdXAuIE11c3QgYmUgdW5pcXVlIGFtb25nIFVzZXIgR3JvdXBzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJoYW5kbGUiLAoJCQkJImV4YW1wbGUiOiAiwqAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIG1lbnRpb24gaGFuZGxlLiBNdXN0IGJlIHVuaXF1ZSBhbW9uZyBjaGFubmVscywgdXNlcnMgYW5kIFVzZXIgR3JvdXBzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJkZXNjcmlwdGlvbiIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkEgc2hvcnQgZGVzY3JpcHRpb24gb2YgdGhlIFVzZXIgR3JvdXAuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNoYW5uZWxzIiwKCQkJCSJleGFtcGxlIjogIsKgIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSBjb21tYSBzZXBhcmF0ZWQgc3RyaW5nIG9mIGVuY29kZWQgY2hhbm5lbCBJRHMgZm9yIHdoaWNoIHRoZSBVc2VyIEdyb3VwIHVzZXMgYXMgYSBkZWZhdWx0LlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2NvdW50IiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHRoZSBudW1iZXIgb2YgdXNlcnMgaW4gZWFjaCBVc2VyIEdyb3VwLlxuIgoJCQl9CgkJXSwKCQkidXNlcmdyb3Vwcy5kaXNhYmxlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcmdyb3Vwczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyZ3JvdXAiLAoJCQkJImV4YW1wbGUiOiAiUzA2MDRRU0pDIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVGhlIGVuY29kZWQgSUQgb2YgdGhlIFVzZXIgR3JvdXAgdG8gZGlzYWJsZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVkZV9jb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIxIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSB0aGUgbnVtYmVyIG9mIHVzZXJzIGluIHRoZSBVc2VyIEdyb3VwLlxuIgoJCQl9CgkJXSwKCQkidXNlcmdyb3Vwcy5lbmFibGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2VyZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXJncm91cCIsCgkJCQkiZXhhbXBsZSI6ICJTMDYwNFFTSkMiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgZW5jb2RlZCBJRCBvZiB0aGUgVXNlciBHcm91cCB0byBlbmFibGUuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImluY2x1ZGVfY291bnQiLAoJCQkJImV4YW1wbGUiOiAiMSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkluY2x1ZGUgdGhlIG51bWJlciBvZiB1c2VycyBpbiB0aGUgVXNlciBHcm91cC5cbiIKCQkJfQoJCV0sCgkJInVzZXJncm91cHMubGlzdCI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJncm91cHM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2Rpc2FibGVkIiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIGRpc2FibGVkIFVzZXIgR3JvdXBzLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2NvdW50IiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHRoZSBudW1iZXIgb2YgdXNlcnMgaW4gZWFjaCBVc2VyIEdyb3VwLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX3VzZXJzIiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHRoZSBsaXN0IG9mIHVzZXJzIGZvciBlYWNoIFVzZXIgR3JvdXAuXG4iCgkJCX0KCQldLAoJCSJ1c2VyZ3JvdXBzLnVwZGF0ZSI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJncm91cHM6d3JpdGVcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlcmdyb3VwIiwKCQkJCSJleGFtcGxlIjogIlMwNjA0UVNKQyIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlRoZSBlbmNvZGVkIElEIG9mIHRoZSBVc2VyIEdyb3VwIHRvIHVwZGF0ZS5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAibmFtZSIsCgkJCQkiZXhhbXBsZSI6ICJNeSBUZXN0IFRlYW0iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIG5hbWUgZm9yIHRoZSBVc2VyIEdyb3VwLiBNdXN0IGJlIHVuaXF1ZSBhbW9uZyBVc2VyIEdyb3Vwcy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaGFuZGxlIiwKCQkJCSJleGFtcGxlIjogIsKgIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQSBtZW50aW9uIGhhbmRsZS4gTXVzdCBiZSB1bmlxdWUgYW1vbmcgY2hhbm5lbHMsIHVzZXJzIGFuZCBVc2VyIEdyb3Vwcy5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiZGVzY3JpcHRpb24iLAoJCQkJImV4YW1wbGUiOiAiwqAiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIHNob3J0IGRlc2NyaXB0aW9uIG9mIHRoZSBVc2VyIEdyb3VwLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjaGFubmVscyIsCgkJCQkiZXhhbXBsZSI6ICLCoCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkEgY29tbWEgc2VwYXJhdGVkIHN0cmluZyBvZiBlbmNvZGVkIGNoYW5uZWwgSURzIGZvciB3aGljaCB0aGUgVXNlciBHcm91cCB1c2VzIGFzIGEgZGVmYXVsdC5cbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiaW5jbHVkZV9jb3VudCIsCgkJCQkiZXhhbXBsZSI6ICIxIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSW5jbHVkZSB0aGUgbnVtYmVyIG9mIHVzZXJzIGluIHRoZSBVc2VyIEdyb3VwLlxuIgoJCQl9CgkJXSwKCQkidXNlcmdyb3Vwcy51c2Vycy5saXN0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcmdyb3VwczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXJncm91cCIsCgkJCQkiZXhhbXBsZSI6ICJTMDYwNFFTSkMiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgZW5jb2RlZCBJRCBvZiB0aGUgVXNlciBHcm91cCB0byB1cGRhdGUuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImluY2x1ZGVfZGlzYWJsZWQiLAoJCQkJImV4YW1wbGUiOiAiMSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIkFsbG93IHJlc3VsdHMgdGhhdCBpbnZvbHZlIGRpc2FibGVkIFVzZXIgR3JvdXBzLlxuIgoJCQl9CgkJXSwKCQkidXNlcmdyb3Vwcy51c2Vycy51cGRhdGUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2VyZ3JvdXBzOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXJncm91cCIsCgkJCQkiZXhhbXBsZSI6ICJTMDYwNFFTSkMiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJUaGUgZW5jb2RlZCBJRCBvZiB0aGUgVXNlciBHcm91cCB0byB1cGRhdGUuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInVzZXJzIiwKCQkJCSJleGFtcGxlIjogIlUwNjBSNEJKNCxVMDYwUk5SQ1oiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBIGNvbW1hIHNlcGFyYXRlZCBzdHJpbmcgb2YgZW5jb2RlZCB1c2VyIElEcyB0aGF0IHJlcHJlc2VudCB0aGUgZW50aXJlIGxpc3Qgb2YgdXNlcnMgZm9yIHRoZSBVc2VyIEdyb3VwLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2NvdW50IiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIHRoZSBudW1iZXIgb2YgdXNlcnMgaW4gdGhlIFVzZXIgR3JvdXAuXG4iCgkJCX0KCQldLAoJCSJ1c2Vycy5kZWxldGVQaG90byI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJzLnByb2ZpbGU6d3JpdGVcbiIKCQkJfQoJCV0sCgkJInVzZXJzLmdldFByZXNlbmNlIjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnM6cmVhZFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVXNlciB0byBnZXQgcHJlc2VuY2UgaW5mbyBvbi4gRGVmYXVsdHMgdG8gdGhlIGF1dGhlZCB1c2VyLlxuIgoJCQl9CgkJXSwKCQkidXNlcnMuaWRlbnRpdHkiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiBpZGVudGl0eS5iYXNpY1xuIgoJCQl9CgkJXSwKCQkidXNlcnMuaW5mbyI6IFsKCQkJewoJCQkJIm5hbWUiOiAidG9rZW4iLAoJCQkJImV4YW1wbGUiOiAieHh4eC14eHh4eHh4eHgteHh4eCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkF1dGhlbnRpY2F0aW9uIHRva2VuLlxuUmVxdWlyZXMgc2NvcGU6IHVzZXJzOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVzZXIgdG8gZ2V0IGluZm8gb25cbiIKCQkJfQoJCV0sCgkJInVzZXJzLmxpc3QiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2VyczpyZWFkXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInByZXNlbmNlIiwKCQkJCSJleGFtcGxlIjogIjEiLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJXaGV0aGVyIHRvIGluY2x1ZGUgcHJlc2VuY2UgZGF0YSBpbiB0aGUgb3V0cHV0XG4iCgkJCX0KCQldLAoJCSJ1c2Vycy5zZXRBY3RpdmUiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2Vyczp3cml0ZVxuIgoJCQl9CgkJXSwKCQkidXNlcnMuc2V0UGhvdG8iOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2Vycy5wcm9maWxlOndyaXRlXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImltYWdlIiwKCQkJCSJleGFtcGxlIjogIi4uLiIsCgkJCQkicmVxdWlyZWQiOiAiUmVxdWlyZWQiLAoJCQkJImRlc2NyaXB0aW9uIjogIkZpbGUgY29udGVudHMgdmlhIG11bHRpcGFydC9mb3JtLWRhdGEuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogImNyb3BfeCIsCgkJCQkiZXhhbXBsZSI6ICIxMCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlggY29vcmRpbmF0ZSBvZiB0b3AtbGVmdCBjb3JuZXIgb2YgY3JvcCBib3hcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAiY3JvcF95IiwKCQkJCSJleGFtcGxlIjogIjE1IiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiWSBjb29yZGluYXRlIG9mIHRvcC1sZWZ0IGNvcm5lciBvZiBjcm9wIGJveFxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJjcm9wX3ciLAoJCQkJImV4YW1wbGUiOiAiMTAwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiV2lkdGgvaGVpZ2h0IG9mIGNyb3AgYm94IChhbHdheXMgc3F1YXJlKVxuIgoJCQl9CgkJXSwKCQkidXNlcnMuc2V0UHJlc2VuY2UiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2Vyczp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJwcmVzZW5jZSIsCgkJCQkiZXhhbXBsZSI6ICJhd2F5IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiRWl0aGVyIGF1dG8gb3IgYXdheVxuIgoJCQl9CgkJXSwKCQkidXNlcnMucHJvZmlsZS5nZXQiOiBbCgkJCXsKCQkJCSJuYW1lIjogInRva2VuIiwKCQkJCSJleGFtcGxlIjogInh4eHgteHh4eHh4eHh4LXh4eHgiLAoJCQkJInJlcXVpcmVkIjogIlJlcXVpcmVkIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJBdXRoZW50aWNhdGlvbiB0b2tlbi5cblJlcXVpcmVzIHNjb3BlOiB1c2Vycy5wcm9maWxlOnJlYWRcbiIKCQkJfSwKCQkJewoJCQkJIm5hbWUiOiAidXNlciIsCgkJCQkiZXhhbXBsZSI6ICJVMTIzNDU2Nzg5MCIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIlVzZXIgdG8gcmV0cmlldmUgcHJvZmlsZSBpbmZvIGZvclxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJpbmNsdWRlX2xhYmVscyIsCgkJCQkiZXhhbXBsZSI6ICIxIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCwgZGVmYXVsdD0wIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJJbmNsdWRlIGxhYmVscyBmb3IgZWFjaCBJRCBpbiBjdXN0b20gcHJvZmlsZSBmaWVsZHNcbiIKCQkJfQoJCV0sCgkJInVzZXJzLnByb2ZpbGUuc2V0IjogWwoJCQl7CgkJCQkibmFtZSI6ICJ0b2tlbiIsCgkJCQkiZXhhbXBsZSI6ICJ4eHh4LXh4eHh4eHh4eC14eHh4IiwKCQkJCSJyZXF1aXJlZCI6ICJSZXF1aXJlZCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiQXV0aGVudGljYXRpb24gdG9rZW4uXG5SZXF1aXJlcyBzY29wZTogdXNlcnMucHJvZmlsZTp3cml0ZVxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ1c2VyIiwKCQkJCSJleGFtcGxlIjogIlUxMjM0NTY3ODkwIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiSUQgb2YgdXNlciB0byBjaGFuZ2UuIFRoaXMgYXJndW1lbnQgbWF5IG9ubHkgYmUgc3BlY2lmaWVkIGJ5IHRlYW0gYWRtaW5zIG9uIHBhaWQgdGVhbXMuXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogInByb2ZpbGUiLAoJCQkJImV4YW1wbGUiOiAieyBmaXJzdF9uYW1lOiBcIkpvaG5cIiwgLi4uIH0iLAoJCQkJInJlcXVpcmVkIjogIk9wdGlvbmFsIiwKCQkJCSJkZXNjcmlwdGlvbiI6ICJDb2xsZWN0aW9uIG9mIGtleTp2YWx1ZSBwYWlycyBwcmVzZW50ZWQgYXMgYSBVUkwtZW5jb2RlZCBKU09OIGhhc2guXG4iCgkJCX0sCgkJCXsKCQkJCSJuYW1lIjogIm5hbWUiLAoJCQkJImV4YW1wbGUiOiAiZmlyc3RfbmFtZSIsCgkJCQkicmVxdWlyZWQiOiAiT3B0aW9uYWwiLAoJCQkJImRlc2NyaXB0aW9uIjogIk5hbWUgb2YgYSBzaW5nbGUga2V5IHRvIHNldC4gVXNhYmxlIG9ubHkgaWYgcHJvZmlsZSBpcyBub3QgcGFzc2VkLlxuIgoJCQl9LAoJCQl7CgkJCQkibmFtZSI6ICJ2YWx1ZSIsCgkJCQkiZXhhbXBsZSI6ICJKb2huIiwKCQkJCSJyZXF1aXJlZCI6ICJPcHRpb25hbCIsCgkJCQkiZGVzY3JpcHRpb24iOiAiVmFsdWUgdG8gc2V0IGEgc2luZ2xlIGtleSB0by4gVXNhYmxlIG9ubHkgaWYgcHJvZmlsZSBpcyBub3QgcGFzc2VkLlxuIgoJCQl9CgkJXQoJfTsKCi8qKiovIH0sCi8qIDUxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGNsaWVudDsKCgkvLyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXN0YXRlZnVsLWNsaWVudAoJZnVuY3Rpb24gY2xpZW50KHRva2VuKSB7CgkgIHZhciBhcHBsaWVkID0gewoJICAgIGF1dGg6IHsKCSAgICAgIHRlc3Q6IHt9CgkgICAgfSwKCSAgICBib3RzOiB7CgkgICAgICBpbmZvOiB7fQoJICAgIH0sCgkgICAgY2hhbm5lbHM6IHsKCSAgICAgIGFyY2hpdmU6IHt9LAoJICAgICAgY3JlYXRlOiB7fSwKCSAgICAgIGhpc3Rvcnk6IHt9LAoJICAgICAgaW5mbzoge30sCgkgICAgICBpbnZpdGU6IHt9LAoJICAgICAgam9pbjoge30sCgkgICAgICBraWNrOiB7fSwKCSAgICAgIGxlYXZlOiB7fSwKCSAgICAgIGxpc3Q6IHt9LAoJICAgICAgbWFyazoge30sCgkgICAgICByZW5hbWU6IHt9LAoJICAgICAgcmVwbGllczoge30sCgkgICAgICBzZXRQdXJwb3NlOiB7fSwKCSAgICAgIHNldFRvcGljOiB7fSwKCSAgICAgIHVuYXJjaGl2ZToge30KCSAgICB9LAoJICAgIGNoYXQ6IHsKCSAgICAgIGRlbGV0ZToge30sCgkgICAgICBtZU1lc3NhZ2U6IHt9LAoJICAgICAgcG9zdE1lc3NhZ2U6IHt9LAoJICAgICAgdXBkYXRlOiB7fQoJICAgIH0sCgkgICAgZG5kOiB7CgkgICAgICBlbmREbmQ6IHt9LAoJICAgICAgZW5kU25vb3plOiB7fSwKCSAgICAgIGluZm86IHt9LAoJICAgICAgc2V0U25vb3plOiB7fSwKCSAgICAgIHRlYW1JbmZvOiB7fQoJICAgIH0sCgkgICAgZW1vamk6IHsKCSAgICAgIGxpc3Q6IHt9CgkgICAgfSwKCSAgICBmaWxlczogewoJICAgICAgY29tbWVudHM6IHsKCSAgICAgICAgYWRkOiB7fSwKCSAgICAgICAgZGVsZXRlOiB7fSwKCSAgICAgICAgZWRpdDoge30KCSAgICAgIH0sCgkgICAgICBkZWxldGU6IHt9LAoJICAgICAgaW5mbzoge30sCgkgICAgICBsaXN0OiB7fSwKCSAgICAgIHJldm9rZVB1YmxpY1VSTDoge30sCgkgICAgICBzaGFyZWRQdWJsaWNVUkw6IHt9LAoJICAgICAgdXBsb2FkOiB7fQoJICAgIH0sCgkgICAgZ3JvdXBzOiB7CgkgICAgICBhcmNoaXZlOiB7fSwKCSAgICAgIGNsb3NlOiB7fSwKCSAgICAgIGNyZWF0ZToge30sCgkgICAgICBjcmVhdGVDaGlsZDoge30sCgkgICAgICBoaXN0b3J5OiB7fSwKCSAgICAgIGluZm86IHt9LAoJICAgICAgaW52aXRlOiB7fSwKCSAgICAgIGtpY2s6IHt9LAoJICAgICAgbGVhdmU6IHt9LAoJICAgICAgbGlzdDoge30sCgkgICAgICBtYXJrOiB7fSwKCSAgICAgIG9wZW46IHt9LAoJICAgICAgcmVuYW1lOiB7fSwKCSAgICAgIHJlcGxpZXM6IHt9LAoJICAgICAgc2V0UHVycG9zZToge30sCgkgICAgICBzZXRUb3BpYzoge30sCgkgICAgICB1bmFyY2hpdmU6IHt9CgkgICAgfSwKCSAgICBpbTogewoJICAgICAgY2xvc2U6IHt9LAoJICAgICAgaGlzdG9yeToge30sCgkgICAgICBsaXN0OiB7fSwKCSAgICAgIG1hcms6IHt9LAoJICAgICAgb3Blbjoge30sCgkgICAgICByZXBsaWVzOiB7fQoJICAgIH0sCgkgICAgbXBpbTogewoJICAgICAgY2xvc2U6IHt9LAoJICAgICAgaGlzdG9yeToge30sCgkgICAgICBsaXN0OiB7fSwKCSAgICAgIG1hcms6IHt9LAoJICAgICAgb3Blbjoge30sCgkgICAgICByZXBsaWVzOiB7fQoJICAgIH0sCgkgICAgcGluczogewoJICAgICAgYWRkOiB7fSwKCSAgICAgIGxpc3Q6IHt9LAoJICAgICAgcmVtb3ZlOiB7fQoJICAgIH0sCgkgICAgcmVhY3Rpb25zOiB7CgkgICAgICBhZGQ6IHt9LAoJICAgICAgZ2V0OiB7fSwKCSAgICAgIGxpc3Q6IHt9LAoJICAgICAgcmVtb3ZlOiB7fQoJICAgIH0sCgkgICAgcmVtaW5kZXJzOiB7CgkgICAgICBhZGQ6IHt9LAoJICAgICAgY29tcGxldGU6IHt9LAoJICAgICAgZGVsZXRlOiB7fSwKCSAgICAgIGluZm86IHt9LAoJICAgICAgbGlzdDoge30KCSAgICB9LAoJICAgIHJ0bTogewoJICAgICAgc3RhcnQ6IHt9CgkgICAgfSwKCSAgICBzZWFyY2g6IHsKCSAgICAgIGFsbDoge30sCgkgICAgICBmaWxlczoge30sCgkgICAgICBtZXNzYWdlczoge30KCSAgICB9LAoJICAgIHN0YXJzOiB7CgkgICAgICBhZGQ6IHt9LAoJICAgICAgbGlzdDoge30sCgkgICAgICByZW1vdmU6IHt9CgkgICAgfSwKCSAgICB0ZWFtOiB7CgkgICAgICBhY2Nlc3NMb2dzOiB7fSwKCSAgICAgIGJpbGxhYmxlSW5mbzoge30sCgkgICAgICBpbmZvOiB7fSwKCSAgICAgIGludGVncmF0aW9uTG9nczoge30sCgkgICAgICBwcm9maWxlOiB7CgkgICAgICAgIGdldDoge30KCSAgICAgIH0KCSAgICB9LAoJICAgIHVzZXJncm91cHM6IHsKCSAgICAgIGNyZWF0ZToge30sCgkgICAgICBkaXNhYmxlOiB7fSwKCSAgICAgIGVuYWJsZToge30sCgkgICAgICBsaXN0OiB7fSwKCSAgICAgIHVwZGF0ZToge30sCgkgICAgICB1c2VyczogewoJICAgICAgICBsaXN0OiB7fSwKCSAgICAgICAgdXBkYXRlOiB7fQoJICAgICAgfQoJICAgIH0sCgkgICAgdXNlcnM6IHsKCSAgICAgIGRlbGV0ZVBob3RvOiB7fSwKCSAgICAgIGdldFByZXNlbmNlOiB7fSwKCSAgICAgIGlkZW50aXR5OiB7fSwKCSAgICAgIGluZm86IHt9LAoJICAgICAgbGlzdDoge30sCgkgICAgICBwcm9maWxlOiB7CgkgICAgICAgIGdldDoge30sCgkgICAgICAgIHNldDoge30KCSAgICAgIH0sCgkgICAgICBzZXRBY3RpdmU6IHt9LAoJICAgICAgc2V0UGhvdG86IHt9LAoJICAgICAgc2V0UHJlc2VuY2U6IHt9CgkgICAgfQoJICB9OwoKCSAgYXBwbGllZC5hdXRoLnRlc3QgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNTIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmJvdHMuaW5mbyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg1MykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhbm5lbHMuYXJjaGl2ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg1NCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhbm5lbHMuY3JlYXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5oaXN0b3J5ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDU2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5pbmZvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5pbnZpdGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNTgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLmpvaW4gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNTkpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLmtpY2sgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLmxlYXZlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDYyKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5tYXJrID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDYzKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy5yZW5hbWUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLnJlcGxpZXMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjUpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLnNldFB1cnBvc2UgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjYpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYW5uZWxzLnNldFRvcGljID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGFubmVscy51bmFyY2hpdmUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNjgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmNoYXQuZGVsZXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDY5KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5jaGF0Lm1lTWVzc2FnZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3MCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhdC5wb3N0TWVzc2FnZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3MSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuY2hhdC51cGRhdGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNzIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmRuZC5lbmREbmQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNzMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmRuZC5lbmRTbm9vemUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNzQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmRuZC5pbmZvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDc1KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5kbmQuc2V0U25vb3plID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDc2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5kbmQudGVhbUluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNzcpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmVtb2ppLmxpc3QgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oNzgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmZpbGVzLmNvbW1lbnRzLmFkZCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg3OSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZmlsZXMuY29tbWVudHMuZGVsZXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5maWxlcy5jb21tZW50cy5lZGl0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDgxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5maWxlcy5kZWxldGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oODIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmZpbGVzLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oODMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmZpbGVzLmxpc3QgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oODQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmZpbGVzLnJldm9rZVB1YmxpY1VSTCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg4NSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZmlsZXMuc2hhcmVkUHVibGljVVJMID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDg2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5maWxlcy51cGxvYWQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oODcpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5hcmNoaXZlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDg4KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMuY2xvc2UgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oODkpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5jcmVhdGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oOTApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5jcmVhdGVDaGlsZCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5MSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLmhpc3RvcnkgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oOTIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5pbmZvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDkzKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMuaW52aXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDk0KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMua2ljayA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5NSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLmxlYXZlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDk2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMubGlzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXyg5NykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLm1hcmsgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oOTgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5vcGVuID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMucmVuYW1lID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuZ3JvdXBzLnJlcGxpZXMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTAxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5ncm91cHMuc2V0UHVycG9zZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy5zZXRUb3BpYyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmdyb3Vwcy51bmFyY2hpdmUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTA0KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5pbS5jbG9zZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDUpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmltLmhpc3RvcnkgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTA2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5pbS5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuaW0ubWFyayA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMDgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLmltLm9wZW4gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTA5KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5pbS5yZXBsaWVzID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDExMCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQubXBpbS5jbG9zZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTEpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0uaGlzdG9yeSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ubGlzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ubWFyayA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ub3BlbiA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTUpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLm1waW0ucmVwbGllcyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMTYpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnBpbnMuYWRkID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDExNykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucGlucy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucGlucy5yZW1vdmUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTE5KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZWFjdGlvbnMuYWRkID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucmVhY3Rpb25zLmdldCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMjEpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnJlYWN0aW9ucy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucmVhY3Rpb25zLnJlbW92ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMjMpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnJlbWluZGVycy5hZGQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTI0KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZW1pbmRlcnMuY29tcGxldGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTI1KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZW1pbmRlcnMuZGVsZXRlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyNikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQucmVtaW5kZXJzLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTI3KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5yZW1pbmRlcnMubGlzdCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMjgpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnJ0bS5zdGFydCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMjkpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnNlYXJjaC5hbGwgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTMwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zZWFyY2guZmlsZXMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTMxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zZWFyY2gubWVzc2FnZXMgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTMyKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zdGFycy5hZGQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTMzKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC5zdGFycy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQuc3RhcnMucmVtb3ZlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNSkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudGVhbS5hY2Nlc3NMb2dzID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudGVhbS5iaWxsYWJsZUluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTM3KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC50ZWFtLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTM4KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC50ZWFtLmludGVncmF0aW9uTG9ncyA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxMzkpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnRlYW0ucHJvZmlsZS5nZXQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTQwKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2VyZ3JvdXBzLmNyZWF0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNDEpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJncm91cHMuZGlzYWJsZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNDIpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJncm91cHMuZW5hYmxlID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0MykuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcmdyb3Vwcy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0NCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcmdyb3Vwcy51cGRhdGUgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTQ1KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2VyZ3JvdXBzLnVzZXJzLmxpc3QgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTQ2KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2VyZ3JvdXBzLnVzZXJzLnVwZGF0ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNDcpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLmRlbGV0ZVBob3RvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0OCkuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcnMuZ2V0UHJlc2VuY2UgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTQ5KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2Vycy5pZGVudGl0eSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNTApLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLmluZm8gPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTUxKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2Vycy5saXN0ID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1MikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcnMucHJvZmlsZS5nZXQgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTUzKS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCSAgYXBwbGllZC51c2Vycy5wcm9maWxlLnNldCA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNTQpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLnNldEFjdGl2ZSA9IGZ1bmN0aW9uIChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgICAgcGFyYW1zLnRva2VuID0gdG9rZW47CgkgICAgX193ZWJwYWNrX3JlcXVpcmVfXygxNTUpLmNhbGwoe30sIHBhcmFtcywgY2FsbGJhY2spOwoJICB9OwoJICBhcHBsaWVkLnVzZXJzLnNldFBob3RvID0gZnVuY3Rpb24gKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgICBwYXJhbXMudG9rZW4gPSB0b2tlbjsKCSAgICBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1NikuY2FsbCh7fSwgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH07CgkgIGFwcGxpZWQudXNlcnMuc2V0UHJlc2VuY2UgPSBmdW5jdGlvbiAocGFyYW1zLCBjYWxsYmFjaykgewoJICAgIHBhcmFtcy50b2tlbiA9IHRva2VuOwoJICAgIF9fd2VicGFja19yZXF1aXJlX18oMTU3KS5jYWxsKHt9LCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfTsKCgkgIHJldHVybiBhcHBsaWVkOwoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBhdXRodGVzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gYXV0aHRlc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnYXV0aC50ZXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBib3RzaW5mbzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gYm90c2luZm8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnYm90cy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2FyY2hpdmU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzYXJjaGl2ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5hcmNoaXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2NyZWF0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHNjcmVhdGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMuY3JlYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2hpc3Rvcnk7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzaGlzdG9yeShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5oaXN0b3J5JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2luZm87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzaW5mbyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2ludml0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHNpbnZpdGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMuaW52aXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA1OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2pvaW47CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzam9pbihwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5qb2luJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2tpY2s7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxza2ljayhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5raWNrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2xlYXZlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGFubmVsc2xlYXZlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYW5uZWxzLmxlYXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc21hcms7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzbWFyayhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5tYXJrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3JlbmFtZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHNyZW5hbWUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMucmVuYW1lJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3JlcGxpZXM7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzcmVwbGllcyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5yZXBsaWVzJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3NldFB1cnBvc2U7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYW5uZWxzc2V0UHVycG9zZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGFubmVscy5zZXRQdXJwb3NlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3NldFRvcGljOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGFubmVsc3NldFRvcGljKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYW5uZWxzLnNldFRvcGljJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGFubmVsc3VuYXJjaGl2ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gY2hhbm5lbHN1bmFyY2hpdmUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnY2hhbm5lbHMudW5hcmNoaXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA2OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0ZGVsZXRlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGF0ZGVsZXRlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYXQuZGVsZXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0bWVNZXNzYWdlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGF0bWVNZXNzYWdlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYXQubWVNZXNzYWdlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0cG9zdE1lc3NhZ2U7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGNoYXRwb3N0TWVzc2FnZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdjaGF0LnBvc3RNZXNzYWdlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBjaGF0dXBkYXRlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBjaGF0dXBkYXRlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2NoYXQudXBkYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRlbmREbmQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGRuZGVuZERuZChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdkbmQuZW5kRG5kJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRlbmRTbm9vemU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGRuZGVuZFNub296ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdkbmQuZW5kU25vb3plJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRpbmZvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBkbmRpbmZvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2RuZC5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmRzZXRTbm9vemU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGRuZHNldFNub296ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdkbmQuc2V0U25vb3plJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBkbmR0ZWFtSW5mbzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZG5kdGVhbUluZm8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZG5kLnRlYW1JbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBlbW9qaWxpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGVtb2ppbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdlbW9qaS5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA3OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2NvbW1lbnRzYWRkOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBmaWxlc2NvbW1lbnRzYWRkKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2ZpbGVzLmNvbW1lbnRzLmFkZCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogODAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gZmlsZXNjb21tZW50c2RlbGV0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNjb21tZW50c2RlbGV0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5jb21tZW50cy5kZWxldGUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDgxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGZpbGVzY29tbWVudHNlZGl0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBmaWxlc2NvbW1lbnRzZWRpdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5jb21tZW50cy5lZGl0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2RlbGV0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNkZWxldGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMuZGVsZXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2luZm87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGZpbGVzaW5mbyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGZpbGVzbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdmaWxlcy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc3Jldm9rZVB1YmxpY1VSTDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNyZXZva2VQdWJsaWNVUkwocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMucmV2b2tlUHVibGljVVJMJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc3NoYXJlZFB1YmxpY1VSTDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXNzaGFyZWRQdWJsaWNVUkwocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMuc2hhcmVkUHVibGljVVJMJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBmaWxlc3VwbG9hZDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZmlsZXN1cGxvYWQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZmlsZXMudXBsb2FkJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNhcmNoaXZlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNhcmNoaXZlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5hcmNoaXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA4OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNjbG9zZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzY2xvc2UocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLmNsb3NlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNjcmVhdGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGdyb3Vwc2NyZWF0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMuY3JlYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNjcmVhdGVDaGlsZDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzY3JlYXRlQ2hpbGQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLmNyZWF0ZUNoaWxkJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNoaXN0b3J5OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNoaXN0b3J5KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5oaXN0b3J5JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNpbmZvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNpbmZvKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNpbnZpdGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGdyb3Vwc2ludml0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdncm91cHMuaW52aXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNraWNrOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNraWNrKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5raWNrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNsZWF2ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzbGVhdmUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLmxlYXZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNsaXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNsaXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5saXN0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5OCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNtYXJrOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNtYXJrKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5tYXJrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiA5OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNvcGVuOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNvcGVuKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5vcGVuJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gZ3JvdXBzcmVuYW1lOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNyZW5hbWUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLnJlbmFtZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTAxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGdyb3Vwc3JlcGxpZXM7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGdyb3Vwc3JlcGxpZXMocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnZ3JvdXBzLnJlcGxpZXMnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEwMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBncm91cHNzZXRQdXJwb3NlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBncm91cHNzZXRQdXJwb3NlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5zZXRQdXJwb3NlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gZ3JvdXBzc2V0VG9waWM7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGdyb3Vwc3NldFRvcGljKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy5zZXRUb3BpYyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTA0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGdyb3Vwc3VuYXJjaGl2ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gZ3JvdXBzdW5hcmNoaXZlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2dyb3Vwcy51bmFyY2hpdmUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEwNSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBpbWNsb3NlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBpbWNsb3NlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2ltLmNsb3NlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gaW1oaXN0b3J5OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBpbWhpc3RvcnkocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnaW0uaGlzdG9yeSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTA3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGltbGlzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gaW1saXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2ltLmxpc3QnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEwOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBpbW1hcms7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIGltbWFyayhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdpbS5tYXJrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMDkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gaW1vcGVuOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBpbW9wZW4ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnaW0ub3Blbic7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTEwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IGltcmVwbGllczsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gaW1yZXBsaWVzKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ2ltLnJlcGxpZXMnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDExMSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBtcGltY2xvc2U7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIG1waW1jbG9zZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdtcGltLmNsb3NlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMTIgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gbXBpbWhpc3Rvcnk7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIG1waW1oaXN0b3J5KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ21waW0uaGlzdG9yeSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTEzICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IG1waW1saXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBtcGltbGlzdChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdtcGltLmxpc3QnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDExNCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBtcGltbWFyazsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gbXBpbW1hcmsocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnbXBpbS5tYXJrJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMTUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gbXBpbW9wZW47CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIG1waW1vcGVuKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ21waW0ub3Blbic7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTE2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IG1waW1yZXBsaWVzOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBtcGltcmVwbGllcyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdtcGltLnJlcGxpZXMnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDExNyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBwaW5zYWRkOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBwaW5zYWRkKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3BpbnMuYWRkJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMTggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcGluc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHBpbnNsaXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3BpbnMubGlzdCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTE5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHBpbnNyZW1vdmU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHBpbnNyZW1vdmUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncGlucy5yZW1vdmUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyMCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSByZWFjdGlvbnNhZGQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHJlYWN0aW9uc2FkZChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdyZWFjdGlvbnMuYWRkJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMjEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcmVhY3Rpb25zZ2V0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiByZWFjdGlvbnNnZXQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncmVhY3Rpb25zLmdldCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTIyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHJlYWN0aW9uc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHJlYWN0aW9uc2xpc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncmVhY3Rpb25zLmxpc3QnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyMyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSByZWFjdGlvbnNyZW1vdmU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHJlYWN0aW9uc3JlbW92ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdyZWFjdGlvbnMucmVtb3ZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMjQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcmVtaW5kZXJzYWRkOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiByZW1pbmRlcnNhZGQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncmVtaW5kZXJzLmFkZCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTI1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHJlbWluZGVyc2NvbXBsZXRlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiByZW1pbmRlcnNjb21wbGV0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdyZW1pbmRlcnMuY29tcGxldGUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyNiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSByZW1pbmRlcnNkZWxldGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHJlbWluZGVyc2RlbGV0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdyZW1pbmRlcnMuZGVsZXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMjcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gcmVtaW5kZXJzaW5mbzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcmVtaW5kZXJzaW5mbyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdyZW1pbmRlcnMuaW5mbyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTI4ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHJlbWluZGVyc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHJlbWluZGVyc2xpc3QocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncmVtaW5kZXJzLmxpc3QnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEyOSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBydG1zdGFydDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gcnRtc3RhcnQocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAncnRtLnN0YXJ0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gc2VhcmNoYWxsOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBzZWFyY2hhbGwocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnc2VhcmNoLmFsbCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTMxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHNlYXJjaGZpbGVzOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiBzZWFyY2hmaWxlcyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICdzZWFyY2guZmlsZXMnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEzMiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBzZWFyY2htZXNzYWdlczsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gc2VhcmNobWVzc2FnZXMocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnc2VhcmNoLm1lc3NhZ2VzJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gc3RhcnNhZGQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHN0YXJzYWRkKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3N0YXJzLmFkZCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTM0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHN0YXJzbGlzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gc3RhcnNsaXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3N0YXJzLmxpc3QnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEzNSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSBzdGFyc3JlbW92ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gc3RhcnNyZW1vdmUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAnc3RhcnMucmVtb3ZlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdGVhbWFjY2Vzc0xvZ3M7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHRlYW1hY2Nlc3NMb2dzKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3RlYW0uYWNjZXNzTG9ncyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTM3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHRlYW1iaWxsYWJsZUluZm87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHRlYW1iaWxsYWJsZUluZm8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndGVhbS5iaWxsYWJsZUluZm8nOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDEzOCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB0ZWFtaW5mbzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdGVhbWluZm8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndGVhbS5pbmZvJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxMzkgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdGVhbWludGVncmF0aW9uTG9nczsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdGVhbWludGVncmF0aW9uTG9ncyhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd0ZWFtLmludGVncmF0aW9uTG9ncyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHRlYW1wcm9maWxlZ2V0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB0ZWFtcHJvZmlsZWdldChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd0ZWFtLnByb2ZpbGUuZ2V0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNDEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcmdyb3Vwc2NyZWF0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcmdyb3Vwc2NyZWF0ZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2VyZ3JvdXBzLmNyZWF0ZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJncm91cHNkaXNhYmxlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2VyZ3JvdXBzZGlzYWJsZShwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2VyZ3JvdXBzLmRpc2FibGUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE0MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2VyZ3JvdXBzZW5hYmxlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2VyZ3JvdXBzZW5hYmxlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJncm91cHMuZW5hYmxlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNDQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcmdyb3Vwc2xpc3Q7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJncm91cHNsaXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJncm91cHMubGlzdCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQ1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJncm91cHN1cGRhdGU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJncm91cHN1cGRhdGUocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcmdyb3Vwcy51cGRhdGUnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE0NiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2VyZ3JvdXBzdXNlcnNsaXN0OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2VyZ3JvdXBzdXNlcnNsaXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJncm91cHMudXNlcnMubGlzdCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQ3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJncm91cHN1c2Vyc3VwZGF0ZTsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcmdyb3Vwc3VzZXJzdXBkYXRlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJncm91cHMudXNlcnMudXBkYXRlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNDggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcnNkZWxldGVQaG90bzsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcnNkZWxldGVQaG90byhwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2Vycy5kZWxldGVQaG90byc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTQ5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJzZ2V0UHJlc2VuY2U7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJzZ2V0UHJlc2VuY2UocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcnMuZ2V0UHJlc2VuY2UnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE1MCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2Vyc2lkZW50aXR5OwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2Vyc2lkZW50aXR5KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJzLmlkZW50aXR5JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNTEgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcnNpbmZvOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2Vyc2luZm8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcnMuaW5mbyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTUyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJzbGlzdDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcnNsaXN0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJzLmxpc3QnOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE1MyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2Vyc3Byb2ZpbGVnZXQ7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJzcHJvZmlsZWdldChwYXJhbXMsIGNhbGxiYWNrKSB7CgkgIHZhciBucyA9ICd1c2Vycy5wcm9maWxlLmdldCc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTU0ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJzcHJvZmlsZXNldDsKCgl2YXIgX2V4ZWMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwoKCXZhciBfZXhlYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leGVjKTsKCgl2YXIgX3ZhbGlkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSk7CgoJdmFyIF92YWxpZGF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF92YWxpZGF0ZSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvLyB0aGlzIGZpbGUgd2FzIGdlbmVyYXRlZCBieSAuL3NjcmlwdHMvZ2VuZXJhdGUtd2ViLWFwaQoJZnVuY3Rpb24gdXNlcnNwcm9maWxlc2V0KHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJzLnByb2ZpbGUuc2V0JzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNTUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gdXNlcnNzZXRBY3RpdmU7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJzc2V0QWN0aXZlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJzLnNldEFjdGl2ZSc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTU2ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuZGVmYXVsdCA9IHVzZXJzc2V0UGhvdG87CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIHVzZXJzc2V0UGhvdG8ocGFyYW1zLCBjYWxsYmFjaykgewoJICB2YXIgbnMgPSAndXNlcnMuc2V0UGhvdG8nOwoJICB2YXIgZXJyID0gKDAsIF92YWxpZGF0ZTIuZGVmYXVsdCkobnMsIHBhcmFtcyk7CgkgIGlmIChlcnIpIHsKCSAgICBjYWxsYmFjayhlcnIpOwoJICB9IGVsc2UgewoJICAgICgwLCBfZXhlYzIuZGVmYXVsdCkobnMsIHBhcmFtcywgY2FsbGJhY2spOwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE1NyAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLmRlZmF1bHQgPSB1c2Vyc3NldFByZXNlbmNlOwoKCXZhciBfZXhlYyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJdmFyIF9leGVjMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4ZWMpOwoKCXZhciBfdmFsaWRhdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KTsKCgl2YXIgX3ZhbGlkYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ZhbGlkYXRlKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8vIHRoaXMgZmlsZSB3YXMgZ2VuZXJhdGVkIGJ5IC4vc2NyaXB0cy9nZW5lcmF0ZS13ZWItYXBpCglmdW5jdGlvbiB1c2Vyc3NldFByZXNlbmNlKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ3VzZXJzLnNldFByZXNlbmNlJzsKCSAgdmFyIGVyciA9ICgwLCBfdmFsaWRhdGUyLmRlZmF1bHQpKG5zLCBwYXJhbXMpOwoJICBpZiAoZXJyKSB7CgkgICAgY2FsbGJhY2soZXJyKTsKCSAgfSBlbHNlIHsKCSAgICAoMCwgX2V4ZWMyLmRlZmF1bHQpKG5zLCBwYXJhbXMsIGNhbGxiYWNrKTsKCSAgfQoJfQoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNTggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfYm90cyA9IF9fd2VicGFja19yZXF1aXJlX18oNTMpOwoKCXZhciBfYm90czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ib3RzKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgaW5mbzogX2JvdHMyLmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE1OSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9jaGFubmVscyA9IF9fd2VicGFja19yZXF1aXJlX18oNTQpOwoKCXZhciBfY2hhbm5lbHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHMpOwoKCXZhciBfY2hhbm5lbHMzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NSk7CgoJdmFyIF9jaGFubmVsczQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczMpOwoKCXZhciBfY2hhbm5lbHM1ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1Nik7CgoJdmFyIF9jaGFubmVsczYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczUpOwoKCXZhciBfY2hhbm5lbHM3ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1Nyk7CgoJdmFyIF9jaGFubmVsczggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczcpOwoKCXZhciBfY2hhbm5lbHM5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OCk7CgoJdmFyIF9jaGFubmVsczEwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhbm5lbHM5KTsKCgl2YXIgX2NoYW5uZWxzMTEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU5KTsKCgl2YXIgX2NoYW5uZWxzMTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczExKTsKCgl2YXIgX2NoYW5uZWxzMTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYwKTsKCgl2YXIgX2NoYW5uZWxzMTQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczEzKTsKCgl2YXIgX2NoYW5uZWxzMTUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKTsKCgl2YXIgX2NoYW5uZWxzMTYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczE1KTsKCgl2YXIgX2NoYW5uZWxzMTcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYyKTsKCgl2YXIgX2NoYW5uZWxzMTggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczE3KTsKCgl2YXIgX2NoYW5uZWxzMTkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYzKTsKCgl2YXIgX2NoYW5uZWxzMjAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczE5KTsKCgl2YXIgX2NoYW5uZWxzMjEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY0KTsKCgl2YXIgX2NoYW5uZWxzMjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczIxKTsKCgl2YXIgX2NoYW5uZWxzMjMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY2KTsKCgl2YXIgX2NoYW5uZWxzMjQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczIzKTsKCgl2YXIgX2NoYW5uZWxzMjUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KTsKCgl2YXIgX2NoYW5uZWxzMjYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczI1KTsKCgl2YXIgX2NoYW5uZWxzMjcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY4KTsKCgl2YXIgX2NoYW5uZWxzMjggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGFubmVsczI3KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgYXJjaGl2ZTogX2NoYW5uZWxzMi5kZWZhdWx0LAoJICBjcmVhdGU6IF9jaGFubmVsczQuZGVmYXVsdCwKCSAgaGlzdG9yeTogX2NoYW5uZWxzNi5kZWZhdWx0LAoJICBpbmZvOiBfY2hhbm5lbHM4LmRlZmF1bHQsCgkgIGludml0ZTogX2NoYW5uZWxzMTAuZGVmYXVsdCwKCSAgam9pbjogX2NoYW5uZWxzMTIuZGVmYXVsdCwKCSAga2ljazogX2NoYW5uZWxzMTQuZGVmYXVsdCwKCSAgbGVhdmU6IF9jaGFubmVsczE2LmRlZmF1bHQsCgkgIGxpc3Q6IF9jaGFubmVsczE4LmRlZmF1bHQsCgkgIG1hcms6IF9jaGFubmVsczIwLmRlZmF1bHQsCgkgIHJlbmFtZTogX2NoYW5uZWxzMjIuZGVmYXVsdCwKCSAgc2V0UHVycG9zZTogX2NoYW5uZWxzMjQuZGVmYXVsdCwKCSAgc2V0VG9waWM6IF9jaGFubmVsczI2LmRlZmF1bHQsCgkgIHVuYXJjaGl2ZTogX2NoYW5uZWxzMjguZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTYwICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2NoYXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY5KTsKCgl2YXIgX2NoYXQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2hhdCk7CgoJdmFyIF9jaGF0MyA9IF9fd2VicGFja19yZXF1aXJlX18oNzEpOwoKCXZhciBfY2hhdDQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGF0Myk7CgoJdmFyIF9jaGF0NSA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpOwoKCXZhciBfY2hhdDYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGF0NSk7CgoJdmFyIF9jaGF0NyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKCXZhciBfY2hhdDggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jaGF0Nyk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIHBvc3RNZXNzYWdlOiBfY2hhdDQuZGVmYXVsdCwgZGVsZXRlOiBfY2hhdDIuZGVmYXVsdCwgdXBkYXRlOiBfY2hhdDYuZGVmYXVsdCwgbWVNZXNzYWdlOiBfY2hhdDguZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTYxICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2RuZCA9IF9fd2VicGFja19yZXF1aXJlX18oNzUpOwoKCXZhciBfZG5kMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RuZCk7CgoJdmFyIF9kbmQzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3Myk7CgoJdmFyIF9kbmQ0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZG5kMyk7CgoJdmFyIF9kbmQ1ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3NCk7CgoJdmFyIF9kbmQ2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZG5kNSk7CgoJdmFyIF9kbmQ3ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3Nik7CgoJdmFyIF9kbmQ4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZG5kNyk7CgoJdmFyIF9kbmQ5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3Nyk7CgoJdmFyIF9kbmQxMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RuZDkpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBpbmZvOiBfZG5kMi5kZWZhdWx0LCBlbmREbmQ6IF9kbmQ0LmRlZmF1bHQsIGVuZFNub296ZTogX2RuZDYuZGVmYXVsdCwgc2V0U25vb3plOiBfZG5kOC5kZWZhdWx0LCB0ZWFtSW5mbzogX2RuZDEwLmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE2MiAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9maWxlcyA9IF9fd2VicGFja19yZXF1aXJlX18oODIpOwoKCXZhciBfZmlsZXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmlsZXMpOwoKCXZhciBfZmlsZXMzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4Myk7CgoJdmFyIF9maWxlczQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlczMpOwoKCXZhciBfZmlsZXM1ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NCk7CgoJdmFyIF9maWxlczYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlczUpOwoKCXZhciBfZmlsZXM3ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4Nyk7CgoJdmFyIF9maWxlczggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlczcpOwoKCXZhciBfZmlsZXNDb21tZW50cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzkpOwoKCXZhciBfZmlsZXNDb21tZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maWxlc0NvbW1lbnRzKTsKCgl2YXIgX2ZpbGVzQ29tbWVudHMzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4MCk7CgoJdmFyIF9maWxlc0NvbW1lbnRzNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZpbGVzQ29tbWVudHMzKTsKCgl2YXIgX2ZpbGVzQ29tbWVudHM1ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4MSk7CgoJdmFyIF9maWxlc0NvbW1lbnRzNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZpbGVzQ29tbWVudHM1KTsKCgl2YXIgX2ZpbGVzOSA9IF9fd2VicGFja19yZXF1aXJlX18oODUpOwoKCXZhciBfZmlsZXMxMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZpbGVzOSk7CgoJdmFyIF9maWxlczExID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4Nik7CgoJdmFyIF9maWxlczEyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmlsZXMxMSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGRlbGV0ZTogX2ZpbGVzMi5kZWZhdWx0LAoJICBpbmZvOiBfZmlsZXM0LmRlZmF1bHQsCgkgIGxpc3Q6IF9maWxlczYuZGVmYXVsdCwKCSAgdXBsb2FkOiBfZmlsZXM4LmRlZmF1bHQsCgkgIGNvbW1lbnRzOiB7CgkgICAgYWRkOiBfZmlsZXNDb21tZW50czIuZGVmYXVsdCwKCSAgICBkZWxldGU6IF9maWxlc0NvbW1lbnRzNC5kZWZhdWx0LAoJICAgIGVkaXQ6IF9maWxlc0NvbW1lbnRzNi5kZWZhdWx0CgkgIH0sCgkgIHJldm9rZVB1YmxpY1VSTDogX2ZpbGVzMTAuZGVmYXVsdCwKCSAgc2hhcmVkUHVibGljVVJMOiBfZmlsZXMxMi5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfZ3JvdXBzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4OCk7CgoJdmFyIF9ncm91cHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzKTsKCgl2YXIgX2dyb3VwczMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg5KTsKCgl2YXIgX2dyb3VwczQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMzKTsKCgl2YXIgX2dyb3VwczUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkwKTsKCgl2YXIgX2dyb3VwczYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHM1KTsKCgl2YXIgX2dyb3VwczcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkxKTsKCgl2YXIgX2dyb3VwczggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHM3KTsKCgl2YXIgX2dyb3VwczkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkyKTsKCgl2YXIgX2dyb3VwczEwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzOSk7CgoJdmFyIF9ncm91cHMxMSA9IF9fd2VicGFja19yZXF1aXJlX18oOTMpOwoKCXZhciBfZ3JvdXBzMTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMxMSk7CgoJdmFyIF9ncm91cHMxMyA9IF9fd2VicGFja19yZXF1aXJlX18oOTQpOwoKCXZhciBfZ3JvdXBzMTQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMxMyk7CgoJdmFyIF9ncm91cHMxNSA9IF9fd2VicGFja19yZXF1aXJlX18oOTUpOwoKCXZhciBfZ3JvdXBzMTYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMxNSk7CgoJdmFyIF9ncm91cHMxNyA9IF9fd2VicGFja19yZXF1aXJlX18oOTYpOwoKCXZhciBfZ3JvdXBzMTggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMxNyk7CgoJdmFyIF9ncm91cHMxOSA9IF9fd2VicGFja19yZXF1aXJlX18oOTcpOwoKCXZhciBfZ3JvdXBzMjAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMxOSk7CgoJdmFyIF9ncm91cHMyMSA9IF9fd2VicGFja19yZXF1aXJlX18oOTgpOwoKCXZhciBfZ3JvdXBzMjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMyMSk7CgoJdmFyIF9ncm91cHMyMyA9IF9fd2VicGFja19yZXF1aXJlX18oOTkpOwoKCXZhciBfZ3JvdXBzMjQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMyMyk7CgoJdmFyIF9ncm91cHMyNSA9IF9fd2VicGFja19yZXF1aXJlX18oMTAwKTsKCgl2YXIgX2dyb3VwczI2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMjUpOwoKCXZhciBfZ3JvdXBzMjcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMik7CgoJdmFyIF9ncm91cHMyOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dyb3VwczI3KTsKCgl2YXIgX2dyb3VwczI5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDMpOwoKCXZhciBfZ3JvdXBzMzAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ncm91cHMyOSk7CgoJdmFyIF9ncm91cHMzMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTA0KTsKCgl2YXIgX2dyb3VwczMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ3JvdXBzMzEpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBhcmNoaXZlOiBfZ3JvdXBzMi5kZWZhdWx0LAoJICBjbG9zZTogX2dyb3VwczQuZGVmYXVsdCwKCSAgY3JlYXRlOiBfZ3JvdXBzNi5kZWZhdWx0LAoJICBjcmVhdGVDaGlsZDogX2dyb3VwczguZGVmYXVsdCwKCSAgaGlzdG9yeTogX2dyb3VwczEwLmRlZmF1bHQsCgkgIGluZm86IF9ncm91cHMxMi5kZWZhdWx0LAoJICBpbnZpdGU6IF9ncm91cHMxNC5kZWZhdWx0LAoJICBraWNrOiBfZ3JvdXBzMTYuZGVmYXVsdCwKCSAgbGVhdmU6IF9ncm91cHMxOC5kZWZhdWx0LAoJICBsaXN0OiBfZ3JvdXBzMjAuZGVmYXVsdCwKCSAgbWFyazogX2dyb3VwczIyLmRlZmF1bHQsCgkgIG9wZW46IF9ncm91cHMyNC5kZWZhdWx0LAoJICByZW5hbWU6IF9ncm91cHMyNi5kZWZhdWx0LAoJICBzZXRQdXJwb3NlOiBfZ3JvdXBzMjguZGVmYXVsdCwKCSAgc2V0VG9waWM6IF9ncm91cHMzMC5kZWZhdWx0LAoJICB1bmFyY2hpdmU6IF9ncm91cHMzMi5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjQgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfaW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNSk7CgoJdmFyIF9pbTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbSk7CgoJdmFyIF9pbTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNik7CgoJdmFyIF9pbTQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbTMpOwoKCXZhciBfaW01ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDcpOwoKCXZhciBfaW02ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW01KTsKCgl2YXIgX2ltNyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA4KTsKCgl2YXIgX2ltOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ltNyk7CgoJdmFyIF9pbTkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwOSk7CgoJdmFyIF9pbTEwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW05KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgY2xvc2U6IF9pbTIuZGVmYXVsdCwgaGlzdG9yeTogX2ltNC5kZWZhdWx0LCBsaXN0OiBfaW02LmRlZmF1bHQsIG1hcms6IF9pbTguZGVmYXVsdCwgb3BlbjogX2ltMTAuZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTY1ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX21waW0gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExMSk7CgoJdmFyIF9tcGltMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21waW0pOwoKCXZhciBfbXBpbTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExMik7CgoJdmFyIF9tcGltNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21waW0zKTsKCgl2YXIgX21waW01ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTMpOwoKCXZhciBfbXBpbTYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tcGltNSk7CgoJdmFyIF9tcGltNyA9IF9fd2VicGFja19yZXF1aXJlX18oMTE0KTsKCgl2YXIgX21waW04ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXBpbTcpOwoKCXZhciBfbXBpbTkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExNSk7CgoJdmFyIF9tcGltMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tcGltOSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGNsb3NlOiBfbXBpbTIuZGVmYXVsdCwKCSAgaGlzdG9yeTogX21waW00LmRlZmF1bHQsCgkgIGxpc3Q6IF9tcGltNi5kZWZhdWx0LAoJICBtYXJrOiBfbXBpbTguZGVmYXVsdCwKCSAgb3BlbjogX21waW0xMC5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gb2F1dGhhY2Nlc3M7CgoJdmFyIF9leGVjID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKCgl2YXIgX2V4ZWMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhlYyk7CgoJdmFyIF92YWxpZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwoKCXZhciBfdmFsaWRhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdmFsaWRhdGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gdGhpcyBmaWxlIHdhcyBnZW5lcmF0ZWQgYnkgLi9zY3JpcHRzL2dlbmVyYXRlLXdlYi1hcGkKCWZ1bmN0aW9uIG9hdXRoYWNjZXNzKHBhcmFtcywgY2FsbGJhY2spIHsKCSAgdmFyIG5zID0gJ29hdXRoLmFjY2Vzcyc7CgkgIHZhciBlcnIgPSAoMCwgX3ZhbGlkYXRlMi5kZWZhdWx0KShucywgcGFyYW1zKTsKCSAgaWYgKGVycikgewoJICAgIGNhbGxiYWNrKGVycik7CgkgIH0gZWxzZSB7CgkgICAgKDAsIF9leGVjMi5kZWZhdWx0KShucywgcGFyYW1zLCBjYWxsYmFjayk7CgkgIH0KCX0KCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTY3ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3JlYWN0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oMTIwKTsKCgl2YXIgX3JlYWN0aW9uczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdGlvbnMpOwoKCXZhciBfcmVhY3Rpb25zMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCgl2YXIgX3JlYWN0aW9uczQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdGlvbnMzKTsKCgl2YXIgX3JlYWN0aW9uczUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMik7CgoJdmFyIF9yZWFjdGlvbnM2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3Rpb25zNSk7CgoJdmFyIF9yZWFjdGlvbnM3ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjMpOwoKCXZhciBfcmVhY3Rpb25zOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0aW9uczcpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBhZGQ6IF9yZWFjdGlvbnMyLmRlZmF1bHQsIGdldDogX3JlYWN0aW9uczQuZGVmYXVsdCwgbGlzdDogX3JlYWN0aW9uczYuZGVmYXVsdCwgcmVtb3ZlOiBfcmVhY3Rpb25zOC5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNjggKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfcmVtaW5kZXJzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjQpOwoKCXZhciBfcmVtaW5kZXJzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlbWluZGVycyk7CgoJdmFyIF9yZW1pbmRlcnMzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjUpOwoKCXZhciBfcmVtaW5kZXJzNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlbWluZGVyczMpOwoKCXZhciBfcmVtaW5kZXJzNSA9IF9fd2VicGFja19yZXF1aXJlX18oMTI2KTsKCgl2YXIgX3JlbWluZGVyczYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW1pbmRlcnM1KTsKCgl2YXIgX3JlbWluZGVyczcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyNyk7CgoJdmFyIF9yZW1pbmRlcnM4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVtaW5kZXJzNyk7CgoJdmFyIF9yZW1pbmRlcnM5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjgpOwoKCXZhciBfcmVtaW5kZXJzMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW1pbmRlcnM5KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgYWRkOiBfcmVtaW5kZXJzMi5kZWZhdWx0LCBjb21wbGV0ZTogX3JlbWluZGVyczQuZGVmYXVsdCwgZGVsZXRlOiBfcmVtaW5kZXJzNi5kZWZhdWx0LCBpbmZvOiBfcmVtaW5kZXJzOC5kZWZhdWx0LCBsaXN0OiBfcmVtaW5kZXJzMTAuZGVmYXVsdAoJfTsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTY5ICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3BpbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExNyk7CgoJdmFyIF9waW5zMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BpbnMpOwoKCXZhciBfcGluczMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7CgoJdmFyIF9waW5zNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BpbnMzKTsKCgl2YXIgX3BpbnM1ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTkpOwoKCXZhciBfcGluczYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9waW5zNSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGFkZDogX3BpbnMyLmRlZmF1bHQsIGxpc3Q6IF9waW5zNC5kZWZhdWx0LCByZW1vdmU6IF9waW5zNi5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNzAgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoJZXhwb3J0cy5kZWZhdWx0ID0gY2xpZW50OwoKCXZhciBfcnRtID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjkpOwoKCXZhciBfcnRtMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3J0bSk7CgoJdmFyIF9ydG0zID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNzEpOwoKCXZhciBfcnRtNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3J0bTMpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLy8gc29ja2V0IGZhY3RvcnkKCWZ1bmN0aW9uIGNsaWVudCgpIHsKCgkgIC8vIGJ1aWxkIGEgbmV3IGJvdCBldmVyeSB0aW1lCgkgIHZhciBib3QgPSB7CgkgICAgaGFuZGxlcnM6IHsKCSAgICAgIHN0YXJ0ZWQ6IFtdCgkgICAgfQoJICB9OwoKCSAgLy8gYWRkIHVuZG9jdW1lbnRlZCBwaW5nIGV2ZW50CgkgIF9ydG00LmRlZmF1bHQucHVzaCgncG9uZycpOwoKCSAgLy8gZ2VuZXJhdGUgZXZlbnQgaGFuZGxlciByZWdpc3RyYXRpb24gbWV0aG9kcwoJICBfcnRtNC5kZWZhdWx0LmZvckVhY2goZnVuY3Rpb24gKGUpIHsKCSAgICBib3QuaGFuZGxlcnNbZV0gPSBbXTsKCSAgICBib3RbZV0gPSBmdW5jdGlvbiAoaGFuZGxlcikgewoJICAgICAgYm90LmhhbmRsZXJzW2VdLnB1c2goaGFuZGxlcik7CgkgICAgfTsKCSAgfSk7CgoJICBib3Quc3RhcnRlZCA9IGZ1bmN0aW9uIChoYW5kbGVyKSB7CgkgICAgYm90LmhhbmRsZXJzWydzdGFydGVkJ10ucHVzaChoYW5kbGVyKTsKCSAgfTsKCgkgIC8vIGtpY2tzIHVwIGEgd2ViIHNvY2tldCBjb25uZWN0aW9uCgkgIGJvdC5saXN0ZW4gPSBmdW5jdGlvbiBib3RMaXN0ZW4ocGFyYW1zLCBjYWxsYmFjaykgewoJICAgICgwLCBfcnRtMi5kZWZhdWx0KShwYXJhbXMsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKCSAgICAgIGlmIChlcnIpIHsKCSAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjayhlcnIpO2Vsc2UgdGhyb3cgZXJyOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgLy8gZ3JhYiBhIGhhbmRsZSBvbiB0aGUgc29ja2V0CgkgICAgICAgIGJvdC53cyA9IG5ldyBXZWJTb2NrZXQoZGF0YS51cmwpOwoJICAgICAgICAvLyBkZWxlZ2F0ZSBldmVyeXRoaW5nCgkgICAgICAgIGJvdC53cy5vbm1lc3NhZ2UgPSBmdW5jdGlvbiBtZXNzYWdlKGUpIHsKCSAgICAgICAgICB2YXIganNvbiA9IEpTT04ucGFyc2UoZS5kYXRhKTsKCSAgICAgICAgICBib3QuaGFuZGxlcnNbanNvbi50eXBlXS5mb3JFYWNoKGZ1bmN0aW9uIChtKSB7CgkgICAgICAgICAgICByZXR1cm4gbS5jYWxsKHt9LCBqc29uKTsKCSAgICAgICAgICB9KTsKCSAgICAgICAgfTsKCSAgICAgICAgLy8gY2FsbCBzdGFydGVkIGNhbGxiYWNrcwoJICAgICAgICBib3QuaGFuZGxlcnNbJ3N0YXJ0ZWQnXS5mb3JFYWNoKGZ1bmN0aW9uIChtKSB7CgkgICAgICAgICAgcmV0dXJuIG0uY2FsbCh7fSwgZGF0YSk7CgkgICAgICAgIH0pOwoJICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKG51bGwsIGRhdGEpOwoJICAgICAgfQoJICAgIH0pOwoJICB9OwoKCSAgLy8gY2xvc2VzIHRoZSBzb2NrZXQKCSAgYm90LmNsb3NlID0gZnVuY3Rpb24gYm90Q2xvc2UoKSB7CgkgICAgYm90LndzLmNsb3NlKCk7CgkgIH07CgoJICAvLy8vLy8vLy8vCgkgIHJldHVybiBib3Q7Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE3MSAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJLy8gZ2VuZXJhdGVkIHVzaW5nIC4vc2NyaXB0cy9nZW5lcmF0ZS1hbGwKCXZhciBldmVudHMgPSBbJ2FjY291bnRzX2NoYW5nZWQnLCAnYm90X2FkZGVkJywgJ2JvdF9jaGFuZ2VkJywgJ2NoYW5uZWxfYXJjaGl2ZScsICdjaGFubmVsX2NyZWF0ZWQnLCAnY2hhbm5lbF9kZWxldGVkJywgJ2NoYW5uZWxfaGlzdG9yeV9jaGFuZ2VkJywgJ2NoYW5uZWxfam9pbmVkJywgJ2NoYW5uZWxfbGVmdCcsICdjaGFubmVsX21hcmtlZCcsICdjaGFubmVsX3JlbmFtZScsICdjaGFubmVsX3VuYXJjaGl2ZScsICdjb21tYW5kc19jaGFuZ2VkJywgJ2RuZF91cGRhdGVkJywgJ2RuZF91cGRhdGVkX3VzZXInLCAnZW1haWxfZG9tYWluX2NoYW5nZWQnLCAnZW1vamlfY2hhbmdlZCcsICdmaWxlX2NoYW5nZScsICdmaWxlX2NvbW1lbnRfYWRkZWQnLCAnZmlsZV9jb21tZW50X2RlbGV0ZWQnLCAnZmlsZV9jb21tZW50X2VkaXRlZCcsICdmaWxlX2NyZWF0ZWQnLCAnZmlsZV9kZWxldGVkJywgJ2ZpbGVfcHVibGljJywgJ2ZpbGVfc2hhcmVkJywgJ2ZpbGVfdW5zaGFyZWQnLCAnZ29vZGJ5ZScsICdncm91cF9hcmNoaXZlJywgJ2dyb3VwX2Nsb3NlJywgJ2dyb3VwX2hpc3RvcnlfY2hhbmdlZCcsICdncm91cF9qb2luZWQnLCAnZ3JvdXBfbGVmdCcsICdncm91cF9tYXJrZWQnLCAnZ3JvdXBfb3BlbicsICdncm91cF9yZW5hbWUnLCAnZ3JvdXBfdW5hcmNoaXZlJywgJ2hlbGxvJywgJ2ltX2Nsb3NlJywgJ2ltX2NyZWF0ZWQnLCAnaW1faGlzdG9yeV9jaGFuZ2VkJywgJ2ltX21hcmtlZCcsICdpbV9vcGVuJywgJ21hbnVhbF9wcmVzZW5jZV9jaGFuZ2UnLCAnbWVzc2FnZScsICdtZXNzYWdlLmNoYW5uZWxzJywgJ21lc3NhZ2UuZ3JvdXBzJywgJ21lc3NhZ2UuaW0nLCAnbWVzc2FnZS5tcGltJywgJ3Bpbl9hZGRlZCcsICdwaW5fcmVtb3ZlZCcsICdwb25nJywgJ3ByZWZfY2hhbmdlJywgJ3ByZXNlbmNlX2NoYW5nZScsICdyZWFjdGlvbl9hZGRlZCcsICdyZWFjdGlvbl9yZW1vdmVkJywgJ3JlY29ubmVjdF91cmwnLCAnc3Rhcl9hZGRlZCcsICdzdGFyX3JlbW92ZWQnLCAnc3VidGVhbV9jcmVhdGVkJywgJ3N1YnRlYW1fc2VsZl9hZGRlZCcsICdzdWJ0ZWFtX3NlbGZfcmVtb3ZlZCcsICdzdWJ0ZWFtX3VwZGF0ZWQnLCAndGVhbV9kb21haW5fY2hhbmdlJywgJ3RlYW1fam9pbicsICd0ZWFtX21pZ3JhdGlvbl9zdGFydGVkJywgJ3RlYW1fcGxhbl9jaGFuZ2UnLCAndGVhbV9wcmVmX2NoYW5nZScsICd0ZWFtX3Byb2ZpbGVfY2hhbmdlJywgJ3RlYW1fcHJvZmlsZV9kZWxldGUnLCAndGVhbV9wcm9maWxlX3Jlb3JkZXInLCAndGVhbV9yZW5hbWUnLCAndXJsX3ZlcmlmaWNhdGlvbicsICd1c2VyX2NoYW5nZScsICd1c2VyX3R5cGluZyddOwoKCWV4cG9ydHMuZGVmYXVsdCA9IGV2ZW50czsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSwKLyogMTcyICovCi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSd1c2Ugc3RyaWN0JzsKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3NlYXJjaCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMwKTsKCgl2YXIgX3NlYXJjaDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZWFyY2gpOwoKCXZhciBfc2VhcmNoMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTMxKTsKCgl2YXIgX3NlYXJjaDQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZWFyY2gzKTsKCgl2YXIgX3NlYXJjaDUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzMik7CgoJdmFyIF9zZWFyY2g2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2VhcmNoNSk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGFsbDogX3NlYXJjaDIuZGVmYXVsdCwgZmlsZXM6IF9zZWFyY2g0LmRlZmF1bHQsIG1lc3NhZ2VzOiBfc2VhcmNoNi5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNzMgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfc3RhcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzMyk7CgoJdmFyIF9zdGFyczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdGFycyk7CgoJdmFyIF9zdGFyczMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNCk7CgoJdmFyIF9zdGFyczQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdGFyczMpOwoKCXZhciBfc3RhcnM1ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzUpOwoKCXZhciBfc3RhcnM2ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3RhcnM1KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgYWRkOiBfc3RhcnMyLmRlZmF1bHQsIGxpc3Q6IF9zdGFyczQuZGVmYXVsdCwgcmVtb3ZlOiBfc3RhcnM2LmRlZmF1bHQKCX07Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0sCi8qIDE3NCAqLwovKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkndXNlIHN0cmljdCc7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF90ZWFtID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzYpOwoKCXZhciBfdGVhbTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZWFtKTsKCgl2YXIgX3RlYW0zID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzcpOwoKCXZhciBfdGVhbTQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90ZWFtMyk7CgoJdmFyIF90ZWFtNSA9IF9fd2VicGFja19yZXF1aXJlX18oMTM4KTsKCgl2YXIgX3RlYW02ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGVhbTUpOwoKCXZhciBfdGVhbTcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzOSk7CgoJdmFyIF90ZWFtOCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RlYW03KTsKCgl2YXIgX3RlYW1Qcm9maWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDApOwoKCXZhciBfdGVhbVByb2ZpbGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdGVhbVByb2ZpbGUpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gewoJICBhY2Nlc3NMb2dzOiBfdGVhbTIuZGVmYXVsdCwKCSAgYmlsbGFibGVJbmZvOiBfdGVhbTQuZGVmYXVsdCwKCSAgaW5mbzogX3RlYW02LmRlZmF1bHQsCgkgIGludGVncmF0aW9uTG9nczogX3RlYW04LmRlZmF1bHQsCgkgIHByb2ZpbGU6IHsKCSAgICBnZXQ6IF90ZWFtUHJvZmlsZTIuZGVmYXVsdAoJICB9Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNzUgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfdXNlcmdyb3VwcyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQxKTsKCgl2YXIgX3VzZXJncm91cHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcmdyb3Vwcyk7CgoJdmFyIF91c2VyZ3JvdXBzMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQyKTsKCgl2YXIgX3VzZXJncm91cHM0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcmdyb3VwczMpOwoKCXZhciBfdXNlcmdyb3VwczUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0Myk7CgoJdmFyIF91c2VyZ3JvdXBzNiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJncm91cHM1KTsKCgl2YXIgX3VzZXJncm91cHM3ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDQpOwoKCXZhciBfdXNlcmdyb3VwczggPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyZ3JvdXBzNyk7CgoJdmFyIF91c2VyZ3JvdXBzOSA9IF9fd2VicGFja19yZXF1aXJlX18oMTQ1KTsKCgl2YXIgX3VzZXJncm91cHMxMCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJncm91cHM5KTsKCgl2YXIgX3VzZXJncm91cHNVc2VycyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQ2KTsKCgl2YXIgX3VzZXJncm91cHNVc2VyczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyZ3JvdXBzVXNlcnMpOwoKCXZhciBfdXNlcmdyb3Vwc1VzZXJzMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTQ3KTsKCgl2YXIgX3VzZXJncm91cHNVc2VyczQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyZ3JvdXBzVXNlcnMzKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCWV4cG9ydHMuZGVmYXVsdCA9IHsKCSAgY3JlYXRlOiBfdXNlcmdyb3VwczIuZGVmYXVsdCwKCSAgZGlzYWJsZTogX3VzZXJncm91cHM0LmRlZmF1bHQsCgkgIGVuYWJsZTogX3VzZXJncm91cHM2LmRlZmF1bHQsCgkgIGxpc3Q6IF91c2VyZ3JvdXBzOC5kZWZhdWx0LAoJICB1cGRhdGU6IF91c2VyZ3JvdXBzMTAuZGVmYXVsdCwKCSAgdXNlcnM6IHsKCSAgICBsaXN0OiBfdXNlcmdyb3Vwc1VzZXJzMi5kZWZhdWx0LAoJICAgIHVwZGF0ZTogX3VzZXJncm91cHNVc2VyczQuZGVmYXVsdAoJICB9Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNzYgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJJ3VzZSBzdHJpY3QnOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfdXNlcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0OSk7CgoJdmFyIF91c2VyczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2Vycyk7CgoJdmFyIF91c2Vyc1Byb2ZpbGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1Myk7CgoJdmFyIF91c2Vyc1Byb2ZpbGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcnNQcm9maWxlKTsKCgl2YXIgX3VzZXJzMyA9IF9fd2VicGFja19yZXF1aXJlX18oMTUwKTsKCgl2YXIgX3VzZXJzNCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3VzZXJzMyk7CgoJdmFyIF91c2VyczUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1MSk7CgoJdmFyIF91c2VyczYgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyczUpOwoKCXZhciBfdXNlcnM3ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTIpOwoKCXZhciBfdXNlcnM4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcnM3KTsKCgl2YXIgX3VzZXJzOSA9IF9fd2VicGFja19yZXF1aXJlX18oMTU1KTsKCgl2YXIgX3VzZXJzMTAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyczkpOwoKCXZhciBfdXNlcnMxMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTU3KTsKCgl2YXIgX3VzZXJzMTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91c2VyczExKTsKCgl2YXIgX3VzZXJzUHJvZmlsZTMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1NCk7CgoJdmFyIF91c2Vyc1Byb2ZpbGU0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXNlcnNQcm9maWxlMyk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSB7CgkgIGdldFByZXNlbmNlOiBfdXNlcnMyLmRlZmF1bHQsCgkgIGlkZW50aXR5OiBfdXNlcnM0LmRlZmF1bHQsCgkgIGluZm86IF91c2VyczYuZGVmYXVsdCwKCSAgbGlzdDogX3VzZXJzOC5kZWZhdWx0LAoJICBwcm9maWxlOiB7CgkgICAgZ2V0OiBfdXNlcnNQcm9maWxlMi5kZWZhdWx0LAoJICAgIHNldDogX3VzZXJzUHJvZmlsZTQuZGVmYXVsdAoJICB9LAoJICBzZXRBY3RpdmU6IF91c2VyczEwLmRlZmF1bHQsCgkgIHNldFByZXNlbmNlOiBfdXNlcnMxMi5kZWZhdWx0Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9LAovKiAxNzcgKi8KLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gdmVyc2lvbjogMC41LjEKCS8vIGRhdGU6IEZyaSBGZWIgMTAgMjAxNyAxNzo0Nzo1NiBHTVQrMDAwMCAoV0VUKQoJLy8gbGljZW5jZTogCgkvKioKCSogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCgkqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoJKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKCSogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSoKCSogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkqCgkqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkqCgkqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkqKi8KCgoJKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKCQlpZih0cnVlKQoJCQltb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTsKCQllbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkKCQkJZGVmaW5lKCJTeW5jaGVyIiwgW10sIGZhY3RvcnkpOwoJCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCQlleHBvcnRzWyJTeW5jaGVyIl0gPSBmYWN0b3J5KCk7CgkJZWxzZQoJCQlyb290WyIiXSA9IHJvb3RbIiJdIHx8IHt9LCByb290WyIiXVsiU3luY2hlciJdID0gZmFjdG9yeSgpOwoJfSkodGhpcywgZnVuY3Rpb24oKSB7CglyZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAoJLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKCS8qKioqKiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgoJLyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKCS8qKioqKiovCgkvKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQoJLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkKCS8qKioqKiovIAkJCXJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzOwoJLyoqKioqKi8KCS8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKCS8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewoJLyoqKioqKi8gCQkJaTogbW9kdWxlSWQsCgkvKioqKioqLyAJCQlsOiBmYWxzZSwKCS8qKioqKiovIAkJCWV4cG9ydHM6IHt9CgkvKioqKioqLyAJCX07CgkvKioqKioqLwoJLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KCS8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7CgkvKioqKioqLwoJLyoqKioqKi8gCQkvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkCgkvKioqKioqLyAJCW1vZHVsZS5sID0gdHJ1ZTsKCS8qKioqKiovCgkvKioqKioqLyAJCS8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlCgkvKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKCS8qKioqKiovIAl9CgkvKioqKioqLwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKQoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlczsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gaWRlbnRpdHkgZnVuY3Rpb24gZm9yIGNhbGxpbmcgaGFybW9ueSBpbXBvcnRzIHdpdGggdGhlIGNvcnJlY3QgY29udGV4dAoJLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTsKCS8qKioqKiovCgkvKioqKioqLyAJLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7CgkvKioqKioqLyAJCWlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHsKCS8qKioqKiovIAkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7CgkvKioqKioqLyAJCQkJY29uZmlndXJhYmxlOiBmYWxzZSwKCS8qKioqKiovIAkJCQllbnVtZXJhYmxlOiB0cnVlLAoJLyoqKioqKi8gCQkJCWdldDogZ2V0dGVyCgkvKioqKioqLyAJCQl9KTsKCS8qKioqKiovIAkJfQoJLyoqKioqKi8gCX07CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7CgkvKioqKioqLyAJCXZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgPwoJLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKCS8qKioqKiovIAkJCWZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07CgkvKioqKioqLyAJCV9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTsKCS8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKCS8qKioqKiovIAl9OwoJLyoqKioqKi8KCS8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKCS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCgkvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gIiI7CgkvKioqKioqLwoJLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwoJLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDE2Myk7CgkvKioqKioqLyB9KQoJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCS8qKioqKiovIChbCgkvKiAwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJdmFyIGNvcmUgPSBtb2R1bGUuZXhwb3J0cyA9IHt2ZXJzaW9uOiAnMi40LjAnfTsKCWlmKHR5cGVvZiBfX2UgPT0gJ251bWJlcicpX19lID0gY29yZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZgoKCS8qKiovIH0pLAoJLyogMSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy84NiNpc3N1ZWNvbW1lbnQtMTE1NzU5MDI4Cgl2YXIgZ2xvYmFsID0gbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdy5NYXRoID09IE1hdGgKCSAgPyB3aW5kb3cgOiB0eXBlb2Ygc2VsZiAhPSAndW5kZWZpbmVkJyAmJiBzZWxmLk1hdGggPT0gTWF0aCA/IHNlbGYgOiBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpOwoJaWYodHlwZW9mIF9fZyA9PSAnbnVtYmVyJylfX2cgPSBnbG9iYWw7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKCgkvKioqLyB9KSwKCS8qIDIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBUaGFuaydzIElFOCBmb3IgaGlzIGZ1bm55IGRlZmluZVByb3BlcnR5Cgltb2R1bGUuZXhwb3J0cyA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewoJICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3OwoJfSk7CgoJLyoqKi8gfSksCgkvKiAzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIHN0b3JlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKSgnd2tzJykKCSAgLCB1aWQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykKCSAgLCBTeW1ib2wgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5TeW1ib2wKCSAgLCBVU0VfU1lNQk9MID0gdHlwZW9mIFN5bWJvbCA9PSAnZnVuY3Rpb24nOwoKCXZhciAkZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obmFtZSl7CgkgIHJldHVybiBzdG9yZVtuYW1lXSB8fCAoc3RvcmVbbmFtZV0gPQoJICAgIFVTRV9TWU1CT0wgJiYgU3ltYm9sW25hbWVdIHx8IChVU0VfU1lNQk9MID8gU3ltYm9sIDogdWlkKSgnU3ltYm9sLicgKyBuYW1lKSk7Cgl9OwoKCSRleHBvcnRzLnN0b3JlID0gc3RvcmU7CgoJLyoqKi8gfSksCgkvKiA0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGFuT2JqZWN0ICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQoJICAsIElFOF9ET01fREVGSU5FID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSkKCSAgLCB0b1ByaW1pdGl2ZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpCgkgICwgZFAgICAgICAgICAgICAgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7CgoJZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpewoJICBhbk9iamVjdChPKTsKCSAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwoJICBhbk9iamVjdChBdHRyaWJ1dGVzKTsKCSAgaWYoSUU4X0RPTV9ERUZJTkUpdHJ5IHsKCSAgICByZXR1cm4gZFAoTywgUCwgQXR0cmlidXRlcyk7CgkgIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCSAgaWYoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKXRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhJyk7CgkgIGlmKCd2YWx1ZScgaW4gQXR0cmlidXRlcylPW1BdID0gQXR0cmlidXRlcy52YWx1ZTsKCSAgcmV0dXJuIE87Cgl9OwoKCS8qKiovIH0pLAoJLyogNSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNik7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgaWYoIWlzT2JqZWN0KGl0KSl0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhbiBvYmplY3QhJyk7CgkgIHJldHVybiBpdDsKCX07CgoJLyoqKi8gfSksCgkvKiA2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiB0eXBlb2YgaXQgPT09ICdvYmplY3QnID8gaXQgIT09IG51bGwgOiB0eXBlb2YgaXQgPT09ICdmdW5jdGlvbic7Cgl9OwoKCS8qKiovIH0pLAoJLyogNyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBkUCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQoJICAsIGNyZWF0ZURlc2MgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTsKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSA/IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7CgkgIHJldHVybiBkUC5mKG9iamVjdCwga2V5LCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7Cgl9IDogZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsKCSAgb2JqZWN0W2tleV0gPSB2YWx1ZTsKCSAgcmV0dXJuIG9iamVjdDsKCX07CgoJLyoqKi8gfSksCgkvKiA4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKCSAgLCBjb3JlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCgkgICwgY3R4ICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKCSAgLCBoaWRlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCgkgICwgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7CgoJdmFyICRleHBvcnQgPSBmdW5jdGlvbih0eXBlLCBuYW1lLCBzb3VyY2UpewoJICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRgoJICAgICwgSVNfR0xPQkFMID0gdHlwZSAmICRleHBvcnQuRwoJICAgICwgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuUwoJICAgICwgSVNfUFJPVE8gID0gdHlwZSAmICRleHBvcnQuUAoJICAgICwgSVNfQklORCAgID0gdHlwZSAmICRleHBvcnQuQgoJICAgICwgSVNfV1JBUCAgID0gdHlwZSAmICRleHBvcnQuVwoJICAgICwgZXhwb3J0cyAgID0gSVNfR0xPQkFMID8gY29yZSA6IGNvcmVbbmFtZV0gfHwgKGNvcmVbbmFtZV0gPSB7fSkKCSAgICAsIGV4cFByb3RvICA9IGV4cG9ydHNbUFJPVE9UWVBFXQoJICAgICwgdGFyZ2V0ICAgID0gSVNfR0xPQkFMID8gZ2xvYmFsIDogSVNfU1RBVElDID8gZ2xvYmFsW25hbWVdIDogKGdsb2JhbFtuYW1lXSB8fCB7fSlbUFJPVE9UWVBFXQoJICAgICwga2V5LCBvd24sIG91dDsKCSAgaWYoSVNfR0xPQkFMKXNvdXJjZSA9IG5hbWU7CgkgIGZvcihrZXkgaW4gc291cmNlKXsKCSAgICAvLyBjb250YWlucyBpbiBuYXRpdmUKCSAgICBvd24gPSAhSVNfRk9SQ0VEICYmIHRhcmdldCAmJiB0YXJnZXRba2V5XSAhPT0gdW5kZWZpbmVkOwoJICAgIGlmKG93biAmJiBrZXkgaW4gZXhwb3J0cyljb250aW51ZTsKCSAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZAoJICAgIG91dCA9IG93biA/IHRhcmdldFtrZXldIDogc291cmNlW2tleV07CgkgICAgLy8gcHJldmVudCBnbG9iYWwgcG9sbHV0aW9uIGZvciBuYW1lc3BhY2VzCgkgICAgZXhwb3J0c1trZXldID0gSVNfR0xPQkFMICYmIHR5cGVvZiB0YXJnZXRba2V5XSAhPSAnZnVuY3Rpb24nID8gc291cmNlW2tleV0KCSAgICAvLyBiaW5kIHRpbWVycyB0byBnbG9iYWwgZm9yIGNhbGwgZnJvbSBleHBvcnQgY29udGV4dAoJICAgIDogSVNfQklORCAmJiBvd24gPyBjdHgob3V0LCBnbG9iYWwpCgkgICAgLy8gd3JhcCBnbG9iYWwgY29uc3RydWN0b3JzIGZvciBwcmV2ZW50IGNoYW5nZSB0aGVtIGluIGxpYnJhcnkKCSAgICA6IElTX1dSQVAgJiYgdGFyZ2V0W2tleV0gPT0gb3V0ID8gKGZ1bmN0aW9uKEMpewoJICAgICAgdmFyIEYgPSBmdW5jdGlvbihhLCBiLCBjKXsKCSAgICAgICAgaWYodGhpcyBpbnN0YW5jZW9mIEMpewoJICAgICAgICAgIHN3aXRjaChhcmd1bWVudHMubGVuZ3RoKXsKCSAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIG5ldyBDOwoJICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gbmV3IEMoYSk7CgkgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBuZXcgQyhhLCBiKTsKCSAgICAgICAgICB9IHJldHVybiBuZXcgQyhhLCBiLCBjKTsKCSAgICAgICAgfSByZXR1cm4gQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICAgICAgfTsKCSAgICAgIEZbUFJPVE9UWVBFXSA9IENbUFJPVE9UWVBFXTsKCSAgICAgIHJldHVybiBGOwoJICAgIC8vIG1ha2Ugc3RhdGljIHZlcnNpb25zIGZvciBwcm90b3R5cGUgbWV0aG9kcwoJICAgIH0pKG91dCkgOiBJU19QUk9UTyAmJiB0eXBlb2Ygb3V0ID09ICdmdW5jdGlvbicgPyBjdHgoRnVuY3Rpb24uY2FsbCwgb3V0KSA6IG91dDsKCSAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUubWV0aG9kcy4lTkFNRSUKCSAgICBpZihJU19QUk9UTyl7CgkgICAgICAoZXhwb3J0cy52aXJ0dWFsIHx8IChleHBvcnRzLnZpcnR1YWwgPSB7fSkpW2tleV0gPSBvdXQ7CgkgICAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUucHJvdG90eXBlLiVOQU1FJQoJICAgICAgaWYodHlwZSAmICRleHBvcnQuUiAmJiBleHBQcm90byAmJiAhZXhwUHJvdG9ba2V5XSloaWRlKGV4cFByb3RvLCBrZXksIG91dCk7CgkgICAgfQoJICB9Cgl9OwoJLy8gdHlwZSBiaXRtYXAKCSRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkCgkkZXhwb3J0LkcgPSAyOyAgIC8vIGdsb2JhbAoJJGV4cG9ydC5TID0gNDsgICAvLyBzdGF0aWMKCSRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG8KCSRleHBvcnQuQiA9IDE2OyAgLy8gYmluZAoJJGV4cG9ydC5XID0gMzI7ICAvLyB3cmFwCgkkZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmUKCSRleHBvcnQuUiA9IDEyODsgLy8gcmVhbCBwcm90byBtZXRob2QgZm9yIGBsaWJyYXJ5YCAKCW1vZHVsZS5leHBvcnRzID0gJGV4cG9ydDsKCgkvKioqLyB9KSwKCS8qIDkgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewoJICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwoJICB9Cgl9OwoKCS8qKiovIH0pLAoJLyogMTAgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJdmFyIF9kZWZpbmVQcm9wZXJ0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMzMpOwoKCXZhciBfZGVmaW5lUHJvcGVydHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVmaW5lUHJvcGVydHkpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkgewoJICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CgkgICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwoJICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwoJICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwoJICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CgkgICAgICAoMCwgX2RlZmluZVByb3BlcnR5Mi5kZWZhdWx0KSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKCSAgICB9CgkgIH0KCgkgIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7CgkgICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKCSAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKCSAgICByZXR1cm4gQ29uc3RydWN0b3I7CgkgIH07Cgl9KCk7CgoJLyoqKi8gfSksCgkvKiAxMSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYyl7CgkgIHRyeSB7CgkgICAgcmV0dXJuICEhZXhlYygpOwoJICB9IGNhdGNoKGUpewoJICAgIHJldHVybiB0cnVlOwoJICB9Cgl9OwoKCS8qKiovIH0pLAoJLyogMTIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgl2YXIgaGFzT3duUHJvcGVydHkgPSB7fS5oYXNPd25Qcm9wZXJ0eTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIGtleSl7CgkgIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGl0LCBrZXkpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDEzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzCgl2YXIgSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNTYpCgkgICwgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiBJT2JqZWN0KGRlZmluZWQoaXQpKTsKCX07CgoJLyoqKi8gfSksCgkvKiAxNCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZwoJdmFyIGFGdW5jdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmbiwgdGhhdCwgbGVuZ3RoKXsKCSAgYUZ1bmN0aW9uKGZuKTsKCSAgaWYodGhhdCA9PT0gdW5kZWZpbmVkKXJldHVybiBmbjsKCSAgc3dpdGNoKGxlbmd0aCl7CgkgICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7CgkgICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhKTsKCSAgICB9OwoJICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpewoJICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYik7CgkgICAgfTsKCSAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsKCSAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIsIGMpOwoJICAgIH07CgkgIH0KCSAgcmV0dXJuIGZ1bmN0aW9uKC8qIC4uLmFyZ3MgKi8pewoJICAgIHJldHVybiBmbi5hcHBseSh0aGF0LCBhcmd1bWVudHMpOwoJICB9OwoJfTsKCgkvKioqLyB9KSwKCS8qIDE1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiaXRtYXAsIHZhbHVlKXsKCSAgcmV0dXJuIHsKCSAgICBlbnVtZXJhYmxlICA6ICEoYml0bWFwICYgMSksCgkgICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLAoJICAgIHdyaXRhYmxlICAgIDogIShiaXRtYXAgJiA0KSwKCSAgICB2YWx1ZSAgICAgICA6IHZhbHVlCgkgIH07Cgl9OwoKCS8qKiovIH0pLAoJLyogMTYgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgltb2R1bGUuZXhwb3J0cyA9IHt9OwoKCS8qKiovIH0pLAoJLyogMTcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCgkgICwgZG9jdW1lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLmRvY3VtZW50CgkgIC8vIGluIG9sZCBJRSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JwoJICAsIGlzID0gaXNPYmplY3QoZG9jdW1lbnQpICYmIGlzT2JqZWN0KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307Cgl9OwoKCS8qKiovIH0pLAoJLyogMTggKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjIuMTQgLyAxNS4yLjMuMTQgT2JqZWN0LmtleXMoTykKCXZhciAka2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpCgkgICwgZW51bUJ1Z0tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KTsKCgltb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIGtleXMoTyl7CgkgIHJldHVybiAka2V5cyhPLCBlbnVtQnVnS2V5cyk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMTkgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgaWYodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTsKCSAgcmV0dXJuIGl0OwoJfTsKCgkvKioqLyB9KSwKCS8qIDIwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiB0b1N0cmluZy5jYWxsKGl0KS5zbGljZSg4LCAtMSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMjEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSkKCXZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CgkvLyBpbnN0ZWFkIG9mIHRoZSBFUzYgc3BlYyB2ZXJzaW9uLCB3ZSBkaWRuJ3QgaW1wbGVtZW50IEBAdG9QcmltaXRpdmUgY2FzZQoJLy8gYW5kIHRoZSBzZWNvbmQgYXJndW1lbnQgLSBmbGFnIC0gcHJlZmVycmVkIHR5cGUgaXMgYSBzdHJpbmcKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIFMpewoJICBpZighaXNPYmplY3QoaXQpKXJldHVybiBpdDsKCSAgdmFyIGZuLCB2YWw7CgkgIGlmKFMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsKCSAgaWYodHlwZW9mIChmbiA9IGl0LnZhbHVlT2YpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwoJICBpZighUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwoJICB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDIyICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGRlZiA9IF9fd2VicGFja19yZXF1aXJlX18oNCkuZgoJICAsIGhhcyA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCgkgICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSgndG9TdHJpbmdUYWcnKTsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCB0YWcsIHN0YXQpewoJICBpZihpdCAmJiAhaGFzKGl0ID0gc3RhdCA/IGl0IDogaXQucHJvdG90eXBlLCBUQUcpKWRlZihpdCwgVEFHLCB7Y29uZmlndXJhYmxlOiB0cnVlLCB2YWx1ZTogdGFnfSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMjMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgl2YXIgaWQgPSAwCgkgICwgcHggPSBNYXRoLnJhbmRvbSgpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewoJICByZXR1cm4gJ1N5bWJvbCgnLmNvbmNhdChrZXkgPT09IHVuZGVmaW5lZCA/ICcnIDoga2V5LCAnKV8nLCAoKytpZCArIHB4KS50b1N0cmluZygzNikpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDI0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudCkKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewoJICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIiArIGl0KTsKCSAgcmV0dXJuIGl0OwoJfTsKCgkvKioqLyB9KSwKCS8qIDI1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygyKSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKCSAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KSgnZGl2JyksICdhJywge2dldDogZnVuY3Rpb24oKXsgcmV0dXJuIDc7IH19KS5hICE9IDc7Cgl9KTsKCgkvKioqLyB9KSwKCS8qIDI2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB0cnVlOwoKCS8qKiovIH0pLAoJLyogMjcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgc2hhcmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMCkoJ2tleXMnKQoJICAsIHVpZCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpewoJICByZXR1cm4gc2hhcmVkW2tleV0gfHwgKHNoYXJlZFtrZXldID0gdWlkKGtleSkpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDI4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJLy8gNy4xLjQgVG9JbnRlZ2VyCgl2YXIgY2VpbCAgPSBNYXRoLmNlaWwKCSAgLCBmbG9vciA9IE1hdGguZmxvb3I7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgcmV0dXJuIGlzTmFOKGl0ID0gK2l0KSA/IDAgOiAoaXQgPiAwID8gZmxvb3IgOiBjZWlsKShpdCk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMjkgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzCgltb2R1bGUuZXhwb3J0cyA9ICgKCSAgJ2NvbnN0cnVjdG9yLGhhc093blByb3BlcnR5LGlzUHJvdG90eXBlT2YscHJvcGVydHlJc0VudW1lcmFibGUsdG9Mb2NhbGVTdHJpbmcsdG9TdHJpbmcsdmFsdWVPZicKCSkuc3BsaXQoJywnKTsKCgkvKioqLyB9KSwKCS8qIDMwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGdsb2JhbCA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKCSAgLCBTSEFSRUQgPSAnX19jb3JlLWpzX3NoYXJlZF9fJwoJICAsIHN0b3JlICA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsKCSAgcmV0dXJuIHN0b3JlW2tleV0gfHwgKHN0b3JlW2tleV0gPSB7fSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMzEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDc5KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKCS8qKiovIH0pLAoJLyogMzIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyA3LjEuMTMgVG9PYmplY3QoYXJndW1lbnQpCgl2YXIgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CgkgIHJldHVybiBPYmplY3QoZGVmaW5lZChpdCkpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDMzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygzNiksIF9fZXNNb2R1bGU6IHRydWUgfTsKCgkvKioqLyB9KSwKCS8qIDM0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCXZhciBfc2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc1KTsKCgl2YXIgX3NldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NldFByb3RvdHlwZU9mKTsKCgl2YXIgX2NyZWF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNzQpOwoKCXZhciBfY3JlYXRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZSk7CgoJdmFyIF90eXBlb2YyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OSk7CgoJdmFyIF90eXBlb2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHlwZW9mMik7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsKCSAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyAodHlwZW9mIHN1cGVyQ2xhc3MgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoc3VwZXJDbGFzcykpKTsKCSAgfQoKCSAgc3ViQ2xhc3MucHJvdG90eXBlID0gKDAsIF9jcmVhdGUyLmRlZmF1bHQpKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsKCSAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgdmFsdWU6IHN1YkNsYXNzLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQoJICAgIH0KCSAgfSk7CgkgIGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2YyLmRlZmF1bHQgPyAoMCwgX3NldFByb3RvdHlwZU9mMi5kZWZhdWx0KShzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOwoJfTsKCgkvKioqLyB9KSwKCS8qIDM1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKCXZhciBfdHlwZW9mMiA9IF9fd2VicGFja19yZXF1aXJlX18oNTkpOwoKCXZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKHNlbGYsIGNhbGwpIHsKCSAgaWYgKCFzZWxmKSB7CgkgICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsKCSAgfQoKCSAgcmV0dXJuIGNhbGwgJiYgKCh0eXBlb2YgY2FsbCA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6ICgwLCBfdHlwZW9mMy5kZWZhdWx0KShjYWxsKSkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOwoJfTsKCgkvKioqLyB9KSwKCS8qIDM2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygzOCk7Cgl2YXIgJE9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0OwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKXsKCSAgcmV0dXJuICRPYmplY3QuZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMzcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKCXZhciBhbk9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKCSAgLCBkUHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpCgkgICwgZW51bUJ1Z0tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KQoJICAsIElFX1BST1RPICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykoJ0lFX1BST1RPJykKCSAgLCBFbXB0eSAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0KCSAgLCBQUk9UT1RZUEUgICA9ICdwcm90b3R5cGUnOwoKCS8vIENyZWF0ZSBvYmplY3Qgd2l0aCBmYWtlIGBudWxsYCBwcm90b3R5cGU6IHVzZSBpZnJhbWUgT2JqZWN0IHdpdGggY2xlYXJlZCBwcm90b3R5cGUKCXZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24oKXsKCSAgLy8gVGhyYXNoLCB3YXN0ZSBhbmQgc29kb215OiBJRSBHQyBidWcKCSAgdmFyIGlmcmFtZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpKCdpZnJhbWUnKQoJICAgICwgaSAgICAgID0gZW51bUJ1Z0tleXMubGVuZ3RoCgkgICAgLCBsdCAgICAgPSAnPCcKCSAgICAsIGd0ICAgICA9ICc+JwoJICAgICwgaWZyYW1lRG9jdW1lbnQ7CgkgIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwoJICBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKS5hcHBlbmRDaGlsZChpZnJhbWUpOwoJICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsCgkgIC8vIGNyZWF0ZURpY3QgPSBpZnJhbWUuY29udGVudFdpbmRvdy5PYmplY3Q7CgkgIC8vIGh0bWwucmVtb3ZlQ2hpbGQoaWZyYW1lKTsKCSAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKCSAgaWZyYW1lRG9jdW1lbnQub3BlbigpOwoJICBpZnJhbWVEb2N1bWVudC53cml0ZShsdCArICdzY3JpcHQnICsgZ3QgKyAnZG9jdW1lbnQuRj1PYmplY3QnICsgbHQgKyAnL3NjcmlwdCcgKyBndCk7CgkgIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7CgkgIGNyZWF0ZURpY3QgPSBpZnJhbWVEb2N1bWVudC5GOwoJICB3aGlsZShpLS0pZGVsZXRlIGNyZWF0ZURpY3RbUFJPVE9UWVBFXVtlbnVtQnVnS2V5c1tpXV07CgkgIHJldHVybiBjcmVhdGVEaWN0KCk7Cgl9OwoKCW1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBjcmVhdGUoTywgUHJvcGVydGllcyl7CgkgIHZhciByZXN1bHQ7CgkgIGlmKE8gIT09IG51bGwpewoJICAgIEVtcHR5W1BST1RPVFlQRV0gPSBhbk9iamVjdChPKTsKCSAgICByZXN1bHQgPSBuZXcgRW1wdHk7CgkgICAgRW1wdHlbUFJPVE9UWVBFXSA9IG51bGw7CgkgICAgLy8gYWRkICJfX3Byb3RvX18iIGZvciBPYmplY3QuZ2V0UHJvdG90eXBlT2YgcG9seWZpbGwKCSAgICByZXN1bHRbSUVfUFJPVE9dID0gTzsKCSAgfSBlbHNlIHJlc3VsdCA9IGNyZWF0ZURpY3QoKTsKCSAgcmV0dXJuIFByb3BlcnRpZXMgPT09IHVuZGVmaW5lZCA/IHJlc3VsdCA6IGRQcyhyZXN1bHQsIFByb3BlcnRpZXMpOwoJfTsKCgoJLyoqKi8gfSksCgkvKiAzOCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCS8vIDE5LjEuMi40IC8gMTUuMi4zLjYgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpCgkkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFfX3dlYnBhY2tfcmVxdWlyZV9fKDIpLCAnT2JqZWN0Jywge2RlZmluZVByb3BlcnR5OiBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmZ9KTsKCgkvKioqLyB9KSwKCS8qIDM5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCXZhciBMSUJSQVJZICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpCgkgICwgJGV4cG9ydCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCgkgICwgcmVkZWZpbmUgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ2KQoJICAsIGhpZGUgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KQoJICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKCSAgLCBJdGVyYXRvcnMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCgkgICwgJGl0ZXJDcmVhdGUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYyKQoJICAsIHNldFRvU3RyaW5nVGFnID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMikKCSAgLCBnZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oNDMpCgkgICwgSVRFUkFUT1IgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdpdGVyYXRvcicpCgkgICwgQlVHR1kgICAgICAgICAgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSkgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YAoJICAsIEZGX0lURVJBVE9SICAgID0gJ0BAaXRlcmF0b3InCgkgICwgS0VZUyAgICAgICAgICAgPSAna2V5cycKCSAgLCBWQUxVRVMgICAgICAgICA9ICd2YWx1ZXMnOwoKCXZhciByZXR1cm5UaGlzID0gZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH07CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihCYXNlLCBOQU1FLCBDb25zdHJ1Y3RvciwgbmV4dCwgREVGQVVMVCwgSVNfU0VULCBGT1JDRUQpewoJICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7CgkgIHZhciBnZXRNZXRob2QgPSBmdW5jdGlvbihraW5kKXsKCSAgICBpZighQlVHR1kgJiYga2luZCBpbiBwcm90bylyZXR1cm4gcHJvdG9ba2luZF07CgkgICAgc3dpdGNoKGtpbmQpewoJICAgICAgY2FzZSBLRVlTOiByZXR1cm4gZnVuY3Rpb24ga2V5cygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9OwoJICAgICAgY2FzZSBWQUxVRVM6IHJldHVybiBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTsKCSAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07CgkgIH07CgkgIHZhciBUQUcgICAgICAgID0gTkFNRSArICcgSXRlcmF0b3InCgkgICAgLCBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVMKCSAgICAsIFZBTFVFU19CVUcgPSBmYWxzZQoJICAgICwgcHJvdG8gICAgICA9IEJhc2UucHJvdG90eXBlCgkgICAgLCAkbmF0aXZlICAgID0gcHJvdG9bSVRFUkFUT1JdIHx8IHByb3RvW0ZGX0lURVJBVE9SXSB8fCBERUZBVUxUICYmIHByb3RvW0RFRkFVTFRdCgkgICAgLCAkZGVmYXVsdCAgID0gJG5hdGl2ZSB8fCBnZXRNZXRob2QoREVGQVVMVCkKCSAgICAsICRlbnRyaWVzICAgPSBERUZBVUxUID8gIURFRl9WQUxVRVMgPyAkZGVmYXVsdCA6IGdldE1ldGhvZCgnZW50cmllcycpIDogdW5kZWZpbmVkCgkgICAgLCAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZQoJICAgICwgbWV0aG9kcywga2V5LCBJdGVyYXRvclByb3RvdHlwZTsKCSAgLy8gRml4IG5hdGl2ZQoJICBpZigkYW55TmF0aXZlKXsKCSAgICBJdGVyYXRvclByb3RvdHlwZSA9IGdldFByb3RvdHlwZU9mKCRhbnlOYXRpdmUuY2FsbChuZXcgQmFzZSkpOwoJICAgIGlmKEl0ZXJhdG9yUHJvdG90eXBlICE9PSBPYmplY3QucHJvdG90eXBlKXsKCSAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnMKCSAgICAgIHNldFRvU3RyaW5nVGFnKEl0ZXJhdG9yUHJvdG90eXBlLCBUQUcsIHRydWUpOwoJICAgICAgLy8gZml4IGZvciBzb21lIG9sZCBlbmdpbmVzCgkgICAgICBpZighTElCUkFSWSAmJiAhaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikpaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwoJICAgIH0KCSAgfQoJICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGCgkgIGlmKERFRl9WQUxVRVMgJiYgJG5hdGl2ZSAmJiAkbmF0aXZlLm5hbWUgIT09IFZBTFVFUyl7CgkgICAgVkFMVUVTX0JVRyA9IHRydWU7CgkgICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTsKCSAgfQoJICAvLyBEZWZpbmUgaXRlcmF0b3IKCSAgaWYoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpewoJICAgIGhpZGUocHJvdG8sIElURVJBVE9SLCAkZGVmYXVsdCk7CgkgIH0KCSAgLy8gUGx1ZyBmb3IgbGlicmFyeQoJICBJdGVyYXRvcnNbTkFNRV0gPSAkZGVmYXVsdDsKCSAgSXRlcmF0b3JzW1RBR10gID0gcmV0dXJuVGhpczsKCSAgaWYoREVGQVVMVCl7CgkgICAgbWV0aG9kcyA9IHsKCSAgICAgIHZhbHVlczogIERFRl9WQUxVRVMgPyAkZGVmYXVsdCA6IGdldE1ldGhvZChWQUxVRVMpLAoJICAgICAga2V5czogICAgSVNfU0VUICAgICA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLAoJICAgICAgZW50cmllczogJGVudHJpZXMKCSAgICB9OwoJICAgIGlmKEZPUkNFRClmb3Ioa2V5IGluIG1ldGhvZHMpewoJICAgICAgaWYoIShrZXkgaW4gcHJvdG8pKXJlZGVmaW5lKHByb3RvLCBrZXksIG1ldGhvZHNba2V5XSk7CgkgICAgfSBlbHNlICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKEJVR0dZIHx8IFZBTFVFU19CVUcpLCBOQU1FLCBtZXRob2RzKTsKCSAgfQoJICByZXR1cm4gbWV0aG9kczsKCX07CgoJLyoqKi8gfSksCgkvKiA0MCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNTMpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiA0MSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCWV4cG9ydHMuZiA9IHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlOwoKCS8qKiovIH0pLAoJLyogNDIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZG9jdW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKCS8qKiovIH0pLAoJLyogNDMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjIuOSAvIDE1LjIuMy4yIE9iamVjdC5nZXRQcm90b3R5cGVPZihPKQoJdmFyIGhhcyAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKCSAgLCB0b09iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCgkgICwgSUVfUFJPVE8gICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KSgnSUVfUFJPVE8nKQoJICAsIE9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTsKCgltb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihPKXsKCSAgTyA9IHRvT2JqZWN0KE8pOwoJICBpZihoYXMoTywgSUVfUFJPVE8pKXJldHVybiBPW0lFX1BST1RPXTsKCSAgaWYodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcil7CgkgICAgcmV0dXJuIE8uY29uc3RydWN0b3IucHJvdG90eXBlOwoJICB9IHJldHVybiBPIGluc3RhbmNlb2YgT2JqZWN0ID8gT2JqZWN0UHJvdG8gOiBudWxsOwoJfTsKCgkvKioqLyB9KSwKCS8qIDQ0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGhhcyAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCgkgICwgdG9JT2JqZWN0ICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKCSAgLCBhcnJheUluZGV4T2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKShmYWxzZSkKCSAgLCBJRV9QUk9UTyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KSgnSUVfUFJPVE8nKTsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgbmFtZXMpewoJICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkKCSAgICAsIGkgICAgICA9IDAKCSAgICAsIHJlc3VsdCA9IFtdCgkgICAgLCBrZXk7CgkgIGZvcihrZXkgaW4gTylpZihrZXkgIT0gSUVfUFJPVE8paGFzKE8sIGtleSkgJiYgcmVzdWx0LnB1c2goa2V5KTsKCSAgLy8gRG9uJ3QgZW51bSBidWcgJiBoaWRkZW4ga2V5cwoJICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKWlmKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSl7CgkgICAgfmFycmF5SW5kZXhPZihyZXN1bHQsIGtleSkgfHwgcmVzdWx0LnB1c2goa2V5KTsKCSAgfQoJICByZXR1cm4gcmVzdWx0OwoJfTsKCgkvKioqLyB9KSwKCS8qIDQ1ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gbW9zdCBPYmplY3QgbWV0aG9kcyBieSBFUzYgc2hvdWxkIGFjY2VwdCBwcmltaXRpdmVzCgl2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKCSAgLCBjb3JlICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQoJICAsIGZhaWxzICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBleGVjKXsKCSAgdmFyIGZuICA9IChjb3JlLk9iamVjdCB8fCB7fSlbS0VZXSB8fCBPYmplY3RbS0VZXQoJICAgICwgZXhwID0ge307CgkgIGV4cFtLRVldID0gZXhlYyhmbik7CgkgICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogZmFpbHMoZnVuY3Rpb24oKXsgZm4oMSk7IH0pLCAnT2JqZWN0JywgZXhwKTsKCX07CgoJLyoqKi8gfSksCgkvKiA0NiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTsKCgkvKioqLyB9KSwKCS8qIDQ3ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gNy4xLjE1IFRvTGVuZ3RoCgl2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkKCSAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewoJICByZXR1cm4gaXQgPiAwID8gbWluKHRvSW50ZWdlcihpdCksIDB4MWZmZmZmZmZmZmZmZmYpIDogMDsgLy8gcG93KDIsIDUzKSAtIDEgPT0gOTAwNzE5OTI1NDc0MDk5MQoJfTsKCgkvKioqLyB9KSwKCS8qIDQ4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGdsb2JhbCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQoJICAsIGNvcmUgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQoJICAsIExJQlJBUlkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNikKCSAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCgkgICwgZGVmaW5lUHJvcGVydHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmY7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpewoJICB2YXIgJFN5bWJvbCA9IGNvcmUuU3ltYm9sIHx8IChjb3JlLlN5bWJvbCA9IExJQlJBUlkgPyB7fSA6IGdsb2JhbC5TeW1ib2wgfHwge30pOwoJICBpZihuYW1lLmNoYXJBdCgwKSAhPSAnXycgJiYgIShuYW1lIGluICRTeW1ib2wpKWRlZmluZVByb3BlcnR5KCRTeW1ib2wsIG5hbWUsIHt2YWx1ZTogd2tzRXh0LmYobmFtZSl9KTsKCX07CgoJLyoqKi8gfSksCgkvKiA0OSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCWV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CgoJLyoqKi8gfSksCgkvKiA1MCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgl2YXIgJGF0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNjYpKHRydWUpOwoKCS8vIDIxLjEuMy4yNyBTdHJpbmcucHJvdG90eXBlW0BAaXRlcmF0b3JdKCkKCV9fd2VicGFja19yZXF1aXJlX18oMzkpKFN0cmluZywgJ1N0cmluZycsIGZ1bmN0aW9uKGl0ZXJhdGVkKXsKCSAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldAoJICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleAoJLy8gMjEuMS41LjIuMSAlU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUlLm5leHQoKQoJfSwgZnVuY3Rpb24oKXsKCSAgdmFyIE8gICAgID0gdGhpcy5fdAoJICAgICwgaW5kZXggPSB0aGlzLl9pCgkgICAgLCBwb2ludDsKCSAgaWYoaW5kZXggPj0gTy5sZW5ndGgpcmV0dXJuIHt2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlfTsKCSAgcG9pbnQgPSAkYXQoTywgaW5kZXgpOwoJICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDsKCSAgcmV0dXJuIHt2YWx1ZTogcG9pbnQsIGRvbmU6IGZhbHNlfTsKCX0pOwoKCS8qKiovIH0pLAoJLyogNTEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDY5KTsKCXZhciBnbG9iYWwgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQoJICAsIGhpZGUgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpCgkgICwgSXRlcmF0b3JzICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCgkgICwgVE9fU1RSSU5HX1RBRyA9IF9fd2VicGFja19yZXF1aXJlX18oMykoJ3RvU3RyaW5nVGFnJyk7CgoJZm9yKHZhciBjb2xsZWN0aW9ucyA9IFsnTm9kZUxpc3QnLCAnRE9NVG9rZW5MaXN0JywgJ01lZGlhTGlzdCcsICdTdHlsZVNoZWV0TGlzdCcsICdDU1NSdWxlTGlzdCddLCBpID0gMDsgaSA8IDU7IGkrKyl7CgkgIHZhciBOQU1FICAgICAgID0gY29sbGVjdGlvbnNbaV0KCSAgICAsIENvbGxlY3Rpb24gPSBnbG9iYWxbTkFNRV0KCSAgICAsIHByb3RvICAgICAgPSBDb2xsZWN0aW9uICYmIENvbGxlY3Rpb24ucHJvdG90eXBlOwoJICBpZihwcm90byAmJiAhcHJvdG9bVE9fU1RSSU5HX1RBR10paGlkZShwcm90bywgVE9fU1RSSU5HX1RBRywgTkFNRSk7CgkgIEl0ZXJhdG9yc1tOQU1FXSA9IEl0ZXJhdG9ycy5BcnJheTsKCX0KCgkvKioqLyB9KSwKCS8qIDUyICovLAoJLyogNTMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgY29yZSAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApCgkgICwgJEpTT04gPSBjb3JlLkpTT04gfHwgKGNvcmUuSlNPTiA9IHtzdHJpbmdpZnk6IEpTT04uc3RyaW5naWZ5fSk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKCSAgcmV0dXJuICRKU09OLnN0cmluZ2lmeS5hcHBseSgkSlNPTiwgYXJndW1lbnRzKTsKCX07CgoJLyoqKi8gfSksCgkvKiA1NCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCgoJLyoqKi8gfSksCgkvKiA1NSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGdldHRpbmcgdGFnIGZyb20gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpCgl2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCkKCSAgLCBUQUcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCd0b1N0cmluZ1RhZycpCgkgIC8vIEVTMyB3cm9uZyBoZXJlCgkgICwgQVJHID0gY29mKGZ1bmN0aW9uKCl7IHJldHVybiBhcmd1bWVudHM7IH0oKSkgPT0gJ0FyZ3VtZW50cyc7CgoJLy8gZmFsbGJhY2sgZm9yIElFMTEgU2NyaXB0IEFjY2VzcyBEZW5pZWQgZXJyb3IKCXZhciB0cnlHZXQgPSBmdW5jdGlvbihpdCwga2V5KXsKCSAgdHJ5IHsKCSAgICByZXR1cm4gaXRba2V5XTsKCSAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQoJfTsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgdmFyIE8sIFQsIEI7CgkgIHJldHVybiBpdCA9PT0gdW5kZWZpbmVkID8gJ1VuZGVmaW5lZCcgOiBpdCA9PT0gbnVsbCA/ICdOdWxsJwoJICAgIC8vIEBAdG9TdHJpbmdUYWcgY2FzZQoJICAgIDogdHlwZW9mIChUID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUQUcpKSA9PSAnc3RyaW5nJyA/IFQKCSAgICAvLyBidWlsdGluVGFnIGNhc2UKCSAgICA6IEFSRyA/IGNvZihPKQoJICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2sKCSAgICA6IChCID0gY29mKE8pKSA9PSAnT2JqZWN0JyAmJiB0eXBlb2YgTy5jYWxsZWUgPT0gJ2Z1bmN0aW9uJyA/ICdBcmd1bWVudHMnIDogQjsKCX07CgoJLyoqKi8gfSksCgkvKiA1NiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzCgl2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7Cgltb2R1bGUuZXhwb3J0cyA9IE9iamVjdCgneicpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApID8gT2JqZWN0IDogZnVuY3Rpb24oaXQpewoJICByZXR1cm4gY29mKGl0KSA9PSAnU3RyaW5nJyA/IGl0LnNwbGl0KCcnKSA6IE9iamVjdChpdCk7Cgl9OwoKCS8qKiovIH0pLAoJLyogNTcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgcElFICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQxKQoJICAsIGNyZWF0ZURlc2MgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKCSAgLCB0b0lPYmplY3QgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCgkgICwgdG9QcmltaXRpdmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQoJICAsIGhhcyAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKCSAgLCBJRThfRE9NX0RFRklORSA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpCgkgICwgZ09QRCAgICAgICAgICAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwoKCWV4cG9ydHMuZiA9IF9fd2VicGFja19yZXF1aXJlX18oMikgPyBnT1BEIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApewoJICBPID0gdG9JT2JqZWN0KE8pOwoJICBQID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSk7CgkgIGlmKElFOF9ET01fREVGSU5FKXRyeSB7CgkgICAgcmV0dXJuIGdPUEQoTywgUCk7CgkgIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCSAgaWYoaGFzKE8sIFApKXJldHVybiBjcmVhdGVEZXNjKCFwSUUuZi5jYWxsKE8sIFApLCBPW1BdKTsKCX07CgoJLyoqKi8gfSksCgkvKiA1OCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCWV4cG9ydHMuZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7CgoJLyoqKi8gfSksCgkvKiA1OSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCgl2YXIgX2l0ZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3Nyk7CgoJdmFyIF9pdGVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pdGVyYXRvcik7CgoJdmFyIF9zeW1ib2wgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc2KTsKCgl2YXIgX3N5bWJvbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zeW1ib2wpOwoKCXZhciBfdHlwZW9mID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIF9pdGVyYXRvcjIuZGVmYXVsdCA9PT0gInN5bWJvbCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5kZWZhdWx0ID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgX3R5cGVvZihfaXRlcmF0b3IyLmRlZmF1bHQpID09PSAic3ltYm9sIiA/IGZ1bmN0aW9uIChvYmopIHsKCSAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKG9iaik7Cgl9IDogZnVuY3Rpb24gKG9iaikgewoJICByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihvYmopOwoJfTsKCgkvKioqLyB9KSwKCS8qIDYwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9OwoKCS8qKiovIH0pLAoJLyogNjEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBmYWxzZSAtPiBBcnJheSNpbmRleE9mCgkvLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlcwoJdmFyIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpCgkgICwgdG9MZW5ndGggID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NykKCSAgLCB0b0luZGV4ICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY4KTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oSVNfSU5DTFVERVMpewoJICByZXR1cm4gZnVuY3Rpb24oJHRoaXMsIGVsLCBmcm9tSW5kZXgpewoJICAgIHZhciBPICAgICAgPSB0b0lPYmplY3QoJHRoaXMpCgkgICAgICAsIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKQoJICAgICAgLCBpbmRleCAgPSB0b0luZGV4KGZyb21JbmRleCwgbGVuZ3RoKQoJICAgICAgLCB2YWx1ZTsKCSAgICAvLyBBcnJheSNpbmNsdWRlcyB1c2VzIFNhbWVWYWx1ZVplcm8gZXF1YWxpdHkgYWxnb3JpdGhtCgkgICAgaWYoSVNfSU5DTFVERVMgJiYgZWwgIT0gZWwpd2hpbGUobGVuZ3RoID4gaW5kZXgpewoJICAgICAgdmFsdWUgPSBPW2luZGV4KytdOwoJICAgICAgaWYodmFsdWUgIT0gdmFsdWUpcmV0dXJuIHRydWU7CgkgICAgLy8gQXJyYXkjdG9JbmRleCBpZ25vcmVzIGhvbGVzLCBBcnJheSNpbmNsdWRlcyAtIG5vdAoJICAgIH0gZWxzZSBmb3IoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKWlmKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pewoJICAgICAgaWYoT1tpbmRleF0gPT09IGVsKXJldHVybiBJU19JTkNMVURFUyB8fCBpbmRleCB8fCAwOwoJICAgIH0gcmV0dXJuICFJU19JTkNMVURFUyAmJiAtMTsKCSAgfTsKCX07CgoJLyoqKi8gfSksCgkvKiA2MiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgl2YXIgY3JlYXRlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM3KQoJICAsIGRlc2NyaXB0b3IgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKCSAgLCBzZXRUb1N0cmluZ1RhZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjIpCgkgICwgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTsKCgkvLyAyNS4xLjIuMS4xICVJdGVyYXRvclByb3RvdHlwZSVbQEBpdGVyYXRvcl0oKQoJX193ZWJwYWNrX3JlcXVpcmVfXyg3KShJdGVyYXRvclByb3RvdHlwZSwgX193ZWJwYWNrX3JlcXVpcmVfXygzKSgnaXRlcmF0b3InKSwgZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH0pOwoKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpewoJICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSBjcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUsIHtuZXh0OiBkZXNjcmlwdG9yKDEsIG5leHQpfSk7CgkgIHNldFRvU3RyaW5nVGFnKENvbnN0cnVjdG9yLCBOQU1FICsgJyBJdGVyYXRvcicpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDYzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihkb25lLCB2YWx1ZSl7CgkgIHJldHVybiB7dmFsdWU6IHZhbHVlLCBkb25lOiAhIWRvbmV9OwoJfTsKCgkvKioqLyB9KSwKCS8qIDY0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGRQICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQoJICAsIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQoJICAsIGdldEtleXMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7CgoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpewoJICBhbk9iamVjdChPKTsKCSAgdmFyIGtleXMgICA9IGdldEtleXMoUHJvcGVydGllcykKCSAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCgkgICAgLCBpID0gMAoJICAgICwgUDsKCSAgd2hpbGUobGVuZ3RoID4gaSlkUC5mKE8sIFAgPSBrZXlzW2krK10sIFByb3BlcnRpZXNbUF0pOwoJICByZXR1cm4gTzsKCX07CgoJLyoqKi8gfSksCgkvKiA2NSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIDE5LjEuMi43IC8gMTUuMi4zLjQgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykKCXZhciAka2V5cyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NCkKCSAgLCBoaWRkZW5LZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSkuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7CgoJZXhwb3J0cy5mID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgfHwgZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhPKXsKCSAgcmV0dXJuICRrZXlzKE8sIGhpZGRlbktleXMpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDY2ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpCgkgICwgZGVmaW5lZCAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7CgkvLyB0cnVlICAtPiBTdHJpbmcjYXQKCS8vIGZhbHNlIC0+IFN0cmluZyNjb2RlUG9pbnRBdAoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihUT19TVFJJTkcpewoJICByZXR1cm4gZnVuY3Rpb24odGhhdCwgcG9zKXsKCSAgICB2YXIgcyA9IFN0cmluZyhkZWZpbmVkKHRoYXQpKQoJICAgICAgLCBpID0gdG9JbnRlZ2VyKHBvcykKCSAgICAgICwgbCA9IHMubGVuZ3RoCgkgICAgICAsIGEsIGI7CgkgICAgaWYoaSA8IDAgfHwgaSA+PSBsKXJldHVybiBUT19TVFJJTkcgPyAnJyA6IHVuZGVmaW5lZDsKCSAgICBhID0gcy5jaGFyQ29kZUF0KGkpOwoJICAgIHJldHVybiBhIDwgMHhkODAwIHx8IGEgPiAweGRiZmYgfHwgaSArIDEgPT09IGwgfHwgKGIgPSBzLmNoYXJDb2RlQXQoaSArIDEpKSA8IDB4ZGMwMCB8fCBiID4gMHhkZmZmCgkgICAgICA/IFRPX1NUUklORyA/IHMuY2hhckF0KGkpIDogYQoJICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7CgkgIH07Cgl9OwoKCS8qKiovIH0pLAoJLyogNjcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgY3R4ICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKCSAgLCBpbnZva2UgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg4KQoJICAsIGh0bWwgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDIpCgkgICwgY2VsICAgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykKCSAgLCBnbG9iYWwgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCgkgICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MKCSAgLCBzZXRUYXNrICAgICAgICAgICAgPSBnbG9iYWwuc2V0SW1tZWRpYXRlCgkgICwgY2xlYXJUYXNrICAgICAgICAgID0gZ2xvYmFsLmNsZWFySW1tZWRpYXRlCgkgICwgTWVzc2FnZUNoYW5uZWwgICAgID0gZ2xvYmFsLk1lc3NhZ2VDaGFubmVsCgkgICwgY291bnRlciAgICAgICAgICAgID0gMAoJICAsIHF1ZXVlICAgICAgICAgICAgICA9IHt9CgkgICwgT05SRUFEWVNUQVRFQ0hBTkdFID0gJ29ucmVhZHlzdGF0ZWNoYW5nZScKCSAgLCBkZWZlciwgY2hhbm5lbCwgcG9ydDsKCXZhciBydW4gPSBmdW5jdGlvbigpewoJICB2YXIgaWQgPSArdGhpczsKCSAgaWYocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKXsKCSAgICB2YXIgZm4gPSBxdWV1ZVtpZF07CgkgICAgZGVsZXRlIHF1ZXVlW2lkXTsKCSAgICBmbigpOwoJICB9Cgl9OwoJdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpewoJICBydW4uY2FsbChldmVudC5kYXRhKTsKCX07CgkvLyBOb2RlLmpzIDAuOSsgJiBJRTEwKyBoYXMgc2V0SW1tZWRpYXRlLCBvdGhlcndpc2U6CglpZighc2V0VGFzayB8fCAhY2xlYXJUYXNrKXsKCSAgc2V0VGFzayA9IGZ1bmN0aW9uIHNldEltbWVkaWF0ZShmbil7CgkgICAgdmFyIGFyZ3MgPSBbXSwgaSA9IDE7CgkgICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsKCSAgICBxdWV1ZVsrK2NvdW50ZXJdID0gZnVuY3Rpb24oKXsKCSAgICAgIGludm9rZSh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pLCBhcmdzKTsKCSAgICB9OwoJICAgIGRlZmVyKGNvdW50ZXIpOwoJICAgIHJldHVybiBjb3VudGVyOwoJICB9OwoJICBjbGVhclRhc2sgPSBmdW5jdGlvbiBjbGVhckltbWVkaWF0ZShpZCl7CgkgICAgZGVsZXRlIHF1ZXVlW2lkXTsKCSAgfTsKCSAgLy8gTm9kZS5qcyAwLjgtCgkgIGlmKF9fd2VicGFja19yZXF1aXJlX18oMjApKHByb2Nlc3MpID09ICdwcm9jZXNzJyl7CgkgICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CgkgICAgICBwcm9jZXNzLm5leHRUaWNrKGN0eChydW4sIGlkLCAxKSk7CgkgICAgfTsKCSAgLy8gQnJvd3NlcnMgd2l0aCBNZXNzYWdlQ2hhbm5lbCwgaW5jbHVkZXMgV2ViV29ya2VycwoJICB9IGVsc2UgaWYoTWVzc2FnZUNoYW5uZWwpewoJICAgIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWw7CgkgICAgcG9ydCAgICA9IGNoYW5uZWwucG9ydDI7CgkgICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBsaXN0ZW5lcjsKCSAgICBkZWZlciA9IGN0eChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTsKCSAgLy8gQnJvd3NlcnMgd2l0aCBwb3N0TWVzc2FnZSwgc2tpcCBXZWJXb3JrZXJzCgkgIC8vIElFOCBoYXMgcG9zdE1lc3NhZ2UsIGJ1dCBpdCdzIHN5bmMgJiB0eXBlb2YgaXRzIHBvc3RNZXNzYWdlIGlzICdvYmplY3QnCgkgIH0gZWxzZSBpZihnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lciAmJiB0eXBlb2YgcG9zdE1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJyAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpewoJICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewoJICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKGlkICsgJycsICcqJyk7CgkgICAgfTsKCSAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGxpc3RlbmVyLCBmYWxzZSk7CgkgIC8vIElFOC0KCSAgfSBlbHNlIGlmKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKXsKCSAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKCSAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoY2VsKCdzY3JpcHQnKSlbT05SRUFEWVNUQVRFQ0hBTkdFXSA9IGZ1bmN0aW9uKCl7CgkgICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7CgkgICAgICAgIHJ1bi5jYWxsKGlkKTsKCSAgICAgIH07CgkgICAgfTsKCSAgLy8gUmVzdCBvbGQgYnJvd3NlcnMKCSAgfSBlbHNlIHsKCSAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKCSAgICAgIHNldFRpbWVvdXQoY3R4KHJ1biwgaWQsIDEpLCAwKTsKCSAgICB9OwoJICB9Cgl9Cgltb2R1bGUuZXhwb3J0cyA9IHsKCSAgc2V0OiAgIHNldFRhc2ssCgkgIGNsZWFyOiBjbGVhclRhc2sKCX07CgoJLyoqKi8gfSksCgkvKiA2OCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KQoJICAsIG1heCAgICAgICA9IE1hdGgubWF4CgkgICwgbWluICAgICAgID0gTWF0aC5taW47Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGluZGV4LCBsZW5ndGgpewoJICBpbmRleCA9IHRvSW50ZWdlcihpbmRleCk7CgkgIHJldHVybiBpbmRleCA8IDAgPyBtYXgoaW5kZXggKyBsZW5ndGgsIDApIDogbWluKGluZGV4LCBsZW5ndGgpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDY5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCXZhciBhZGRUb1Vuc2NvcGFibGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MCkKCSAgLCBzdGVwICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MykKCSAgLCBJdGVyYXRvcnMgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNikKCSAgLCB0b0lPYmplY3QgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyk7CgoJLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKQoJLy8gMjIuMS4zLjEzIEFycmF5LnByb3RvdHlwZS5rZXlzKCkKCS8vIDIyLjEuMy4yOSBBcnJheS5wcm90b3R5cGUudmFsdWVzKCkKCS8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKQoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KShBcnJheSwgJ0FycmF5JywgZnVuY3Rpb24oaXRlcmF0ZWQsIGtpbmQpewoJICB0aGlzLl90ID0gdG9JT2JqZWN0KGl0ZXJhdGVkKTsgLy8gdGFyZ2V0CgkgIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4CgkgIHRoaXMuX2sgPSBraW5kOyAgICAgICAgICAgICAgICAvLyBraW5kCgkvLyAyMi4xLjUuMi4xICVBcnJheUl0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKCX0sIGZ1bmN0aW9uKCl7CgkgIHZhciBPICAgICA9IHRoaXMuX3QKCSAgICAsIGtpbmQgID0gdGhpcy5fawoJICAgICwgaW5kZXggPSB0aGlzLl9pKys7CgkgIGlmKCFPIHx8IGluZGV4ID49IE8ubGVuZ3RoKXsKCSAgICB0aGlzLl90ID0gdW5kZWZpbmVkOwoJICAgIHJldHVybiBzdGVwKDEpOwoJICB9CgkgIGlmKGtpbmQgPT0gJ2tleXMnICApcmV0dXJuIHN0ZXAoMCwgaW5kZXgpOwoJICBpZihraW5kID09ICd2YWx1ZXMnKXJldHVybiBzdGVwKDAsIE9baW5kZXhdKTsKCSAgcmV0dXJuIHN0ZXAoMCwgW2luZGV4LCBPW2luZGV4XV0pOwoJfSwgJ3ZhbHVlcycpOwoKCS8vIGFyZ3VtZW50c0xpc3RbQEBpdGVyYXRvcl0gaXMgJUFycmF5UHJvdG9fdmFsdWVzJSAoOS40LjQuNiwgOS40LjQuNykKCUl0ZXJhdG9ycy5Bcmd1bWVudHMgPSBJdGVyYXRvcnMuQXJyYXk7CgoJYWRkVG9VbnNjb3BhYmxlcygna2V5cycpOwoJYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7CglhZGRUb1Vuc2NvcGFibGVzKCdlbnRyaWVzJyk7CgoJLyoqKi8gfSksCgkvKiA3MCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODApLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiA3MSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODIpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiA3MiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBNRVRBICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpKCdtZXRhJykKCSAgLCBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNikKCSAgLCBoYXMgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpCgkgICwgc2V0RGVzYyAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmYKCSAgLCBpZCAgICAgICA9IDA7Cgl2YXIgaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZSB8fCBmdW5jdGlvbigpewoJICByZXR1cm4gdHJ1ZTsKCX07Cgl2YXIgRlJFRVpFID0gIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CgkgIHJldHVybiBpc0V4dGVuc2libGUoT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKHt9KSk7Cgl9KTsKCXZhciBzZXRNZXRhID0gZnVuY3Rpb24oaXQpewoJICBzZXREZXNjKGl0LCBNRVRBLCB7dmFsdWU6IHsKCSAgICBpOiAnTycgKyArK2lkLCAvLyBvYmplY3QgSUQKCSAgICB3OiB7fSAgICAgICAgICAvLyB3ZWFrIGNvbGxlY3Rpb25zIElEcwoJICB9fSk7Cgl9OwoJdmFyIGZhc3RLZXkgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXsKCSAgLy8gcmV0dXJuIHByaW1pdGl2ZSB3aXRoIHByZWZpeAoJICBpZighaXNPYmplY3QoaXQpKXJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCcgPyBpdCA6ICh0eXBlb2YgaXQgPT0gJ3N0cmluZycgPyAnUycgOiAnUCcpICsgaXQ7CgkgIGlmKCFoYXMoaXQsIE1FVEEpKXsKCSAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdAoJICAgIGlmKCFpc0V4dGVuc2libGUoaXQpKXJldHVybiAnRic7CgkgICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGEKCSAgICBpZighY3JlYXRlKXJldHVybiAnRSc7CgkgICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGEKCSAgICBzZXRNZXRhKGl0KTsKCSAgLy8gcmV0dXJuIG9iamVjdCBJRAoJICB9IHJldHVybiBpdFtNRVRBXS5pOwoJfTsKCXZhciBnZXRXZWFrID0gZnVuY3Rpb24oaXQsIGNyZWF0ZSl7CgkgIGlmKCFoYXMoaXQsIE1FVEEpKXsKCSAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdAoJICAgIGlmKCFpc0V4dGVuc2libGUoaXQpKXJldHVybiB0cnVlOwoJICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhCgkgICAgaWYoIWNyZWF0ZSlyZXR1cm4gZmFsc2U7CgkgICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGEKCSAgICBzZXRNZXRhKGl0KTsKCSAgLy8gcmV0dXJuIGhhc2ggd2VhayBjb2xsZWN0aW9ucyBJRHMKCSAgfSByZXR1cm4gaXRbTUVUQV0udzsKCX07CgkvLyBhZGQgbWV0YWRhdGEgb24gZnJlZXplLWZhbWlseSBtZXRob2RzIGNhbGxpbmcKCXZhciBvbkZyZWV6ZSA9IGZ1bmN0aW9uKGl0KXsKCSAgaWYoRlJFRVpFICYmIG1ldGEuTkVFRCAmJiBpc0V4dGVuc2libGUoaXQpICYmICFoYXMoaXQsIE1FVEEpKXNldE1ldGEoaXQpOwoJICByZXR1cm4gaXQ7Cgl9OwoJdmFyIG1ldGEgPSBtb2R1bGUuZXhwb3J0cyA9IHsKCSAgS0VZOiAgICAgIE1FVEEsCgkgIE5FRUQ6ICAgICBmYWxzZSwKCSAgZmFzdEtleTogIGZhc3RLZXksCgkgIGdldFdlYWs6ICBnZXRXZWFrLAoJICBvbkZyZWV6ZTogb25GcmVlemUKCX07CgoJLyoqKi8gfSksCgkvKiA3MyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBjbGFzc29mICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KQoJICAsIElURVJBVE9SICA9IF9fd2VicGFja19yZXF1aXJlX18oMykoJ2l0ZXJhdG9yJykKCSAgLCBJdGVyYXRvcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTsKCW1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uKGl0KXsKCSAgaWYoaXQgIT0gdW5kZWZpbmVkKXJldHVybiBpdFtJVEVSQVRPUl0KCSAgICB8fCBpdFsnQEBpdGVyYXRvciddCgkgICAgfHwgSXRlcmF0b3JzW2NsYXNzb2YoaXQpXTsKCX07CgoJLyoqKi8gfSksCgkvKiA3NCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNzgpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiA3NSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODEpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiA3NiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODMpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiA3NyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODQpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiA3OCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oMTAwKTsKCXZhciAkT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Q7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNyZWF0ZShQLCBEKXsKCSAgcmV0dXJuICRPYmplY3QuY3JlYXRlKFAsIEQpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDc5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygxMDEpOwoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5nZXRQcm90b3R5cGVPZjsKCgkvKioqLyB9KSwKCS8qIDgwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygxMDIpOwoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5rZXlzOwoKCS8qKiovIH0pLAoJLyogODEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDEwMyk7Cgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0LnNldFByb3RvdHlwZU9mOwoKCS8qKiovIH0pLAoJLyogODIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KTsKCV9fd2VicGFja19yZXF1aXJlX18oNTApOwoJX193ZWJwYWNrX3JlcXVpcmVfXyg1MSk7CglfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNCk7Cgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuUHJvbWlzZTsKCgkvKioqLyB9KSwKCS8qIDgzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJX193ZWJwYWNrX3JlcXVpcmVfXygxMDUpOwoJX193ZWJwYWNrX3JlcXVpcmVfXyg1NCk7CglfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNik7CglfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNyk7Cgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuU3ltYm9sOwoKCS8qKiovIH0pLAoJLyogODQgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDUwKTsKCV9fd2VicGFja19yZXF1aXJlX18oNTEpOwoJbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KS5mKCdpdGVyYXRvcicpOwoKCS8qKiovIH0pLAoJLyogODUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSwgZm9yYmlkZGVuRmllbGQpewoJICBpZighKGl0IGluc3RhbmNlb2YgQ29uc3RydWN0b3IpIHx8IChmb3JiaWRkZW5GaWVsZCAhPT0gdW5kZWZpbmVkICYmIGZvcmJpZGRlbkZpZWxkIGluIGl0KSl7CgkgICAgdGhyb3cgVHlwZUVycm9yKG5hbWUgKyAnOiBpbmNvcnJlY3QgaW52b2NhdGlvbiEnKTsKCSAgfSByZXR1cm4gaXQ7Cgl9OwoKCS8qKiovIH0pLAoJLyogODYgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyBhbGwgZW51bWVyYWJsZSBvYmplY3Qga2V5cywgaW5jbHVkZXMgc3ltYm9scwoJdmFyIGdldEtleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KQoJICAsIGdPUFMgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU4KQoJICAsIHBJRSAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQxKTsKCW1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewoJICB2YXIgcmVzdWx0ICAgICA9IGdldEtleXMoaXQpCgkgICAgLCBnZXRTeW1ib2xzID0gZ09QUy5mOwoJICBpZihnZXRTeW1ib2xzKXsKCSAgICB2YXIgc3ltYm9scyA9IGdldFN5bWJvbHMoaXQpCgkgICAgICAsIGlzRW51bSAgPSBwSUUuZgoJICAgICAgLCBpICAgICAgID0gMAoJICAgICAgLCBrZXk7CgkgICAgd2hpbGUoc3ltYm9scy5sZW5ndGggPiBpKWlmKGlzRW51bS5jYWxsKGl0LCBrZXkgPSBzeW1ib2xzW2krK10pKXJlc3VsdC5wdXNoKGtleSk7CgkgIH0gcmV0dXJuIHJlc3VsdDsKCX07CgoJLyoqKi8gfSksCgkvKiA4NyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBjdHggICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCgkgICwgY2FsbCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkxKQoJICAsIGlzQXJyYXlJdGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4OSkKCSAgLCBhbk9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKCSAgLCB0b0xlbmd0aCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpCgkgICwgZ2V0SXRlckZuICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDczKQoJICAsIEJSRUFLICAgICAgID0ge30KCSAgLCBSRVRVUk4gICAgICA9IHt9OwoJdmFyIGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhYmxlLCBlbnRyaWVzLCBmbiwgdGhhdCwgSVRFUkFUT1IpewoJICB2YXIgaXRlckZuID0gSVRFUkFUT1IgPyBmdW5jdGlvbigpeyByZXR1cm4gaXRlcmFibGU7IH0gOiBnZXRJdGVyRm4oaXRlcmFibGUpCgkgICAgLCBmICAgICAgPSBjdHgoZm4sIHRoYXQsIGVudHJpZXMgPyAyIDogMSkKCSAgICAsIGluZGV4ICA9IDAKCSAgICAsIGxlbmd0aCwgc3RlcCwgaXRlcmF0b3IsIHJlc3VsdDsKCSAgaWYodHlwZW9mIGl0ZXJGbiAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdGVyYWJsZSArICcgaXMgbm90IGl0ZXJhYmxlIScpOwoJICAvLyBmYXN0IGNhc2UgZm9yIGFycmF5cyB3aXRoIGRlZmF1bHQgaXRlcmF0b3IKCSAgaWYoaXNBcnJheUl0ZXIoaXRlckZuKSlmb3IobGVuZ3RoID0gdG9MZW5ndGgoaXRlcmFibGUubGVuZ3RoKTsgbGVuZ3RoID4gaW5kZXg7IGluZGV4KyspewoJICAgIHJlc3VsdCA9IGVudHJpZXMgPyBmKGFuT2JqZWN0KHN0ZXAgPSBpdGVyYWJsZVtpbmRleF0pWzBdLCBzdGVwWzFdKSA6IGYoaXRlcmFibGVbaW5kZXhdKTsKCSAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7CgkgIH0gZWxzZSBmb3IoaXRlcmF0b3IgPSBpdGVyRm4uY2FsbChpdGVyYWJsZSk7ICEoc3RlcCA9IGl0ZXJhdG9yLm5leHQoKSkuZG9uZTsgKXsKCSAgICByZXN1bHQgPSBjYWxsKGl0ZXJhdG9yLCBmLCBzdGVwLnZhbHVlLCBlbnRyaWVzKTsKCSAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7CgkgIH0KCX07CglleHBvcnRzLkJSRUFLICA9IEJSRUFLOwoJZXhwb3J0cy5SRVRVUk4gPSBSRVRVUk47CgoJLyoqKi8gfSksCgkvKiA4OCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCS8vIGZhc3QgYXBwbHksIGh0dHA6Ly9qc3BlcmYubG5raXQuY29tL2Zhc3QtYXBwbHkvNQoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmbiwgYXJncywgdGhhdCl7CgkgIHZhciB1biA9IHRoYXQgPT09IHVuZGVmaW5lZDsKCSAgc3dpdGNoKGFyZ3MubGVuZ3RoKXsKCSAgICBjYXNlIDA6IHJldHVybiB1biA/IGZuKCkKCSAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCk7CgkgICAgY2FzZSAxOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdKQoJICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdKTsKCSAgICBjYXNlIDI6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0sIGFyZ3NbMV0pCgkgICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0pOwoJICAgIGNhc2UgMzogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSkKCSAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSk7CgkgICAgY2FzZSA0OiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKQoJICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKTsKCSAgfSByZXR1cm4gICAgICAgICAgICAgIGZuLmFwcGx5KHRoYXQsIGFyZ3MpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDg5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gY2hlY2sgb24gZGVmYXVsdCBBcnJheSBpdGVyYXRvcgoJdmFyIEl0ZXJhdG9ycyAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQoJICAsIElURVJBVE9SICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdpdGVyYXRvcicpCgkgICwgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZTsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKCSAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b1tJVEVSQVRPUl0gPT09IGl0KTsKCX07CgoJLyoqKi8gfSksCgkvKiA5MCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIDcuMi4yIElzQXJyYXkoYXJndW1lbnQpCgl2YXIgY29mID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7Cgltb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gaXNBcnJheShhcmcpewoJICByZXR1cm4gY29mKGFyZykgPT0gJ0FycmF5JzsKCX07CgoJLyoqKi8gfSksCgkvKiA5MSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGNhbGwgc29tZXRoaW5nIG9uIGl0ZXJhdG9yIHN0ZXAgd2l0aCBzYWZlIGNsb3Npbmcgb24gZXJyb3IKCXZhciBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhdG9yLCBmbiwgdmFsdWUsIGVudHJpZXMpewoJICB0cnkgewoJICAgIHJldHVybiBlbnRyaWVzID8gZm4oYW5PYmplY3QodmFsdWUpWzBdLCB2YWx1ZVsxXSkgOiBmbih2YWx1ZSk7CgkgIC8vIDcuNC42IEl0ZXJhdG9yQ2xvc2UoaXRlcmF0b3IsIGNvbXBsZXRpb24pCgkgIH0gY2F0Y2goZSl7CgkgICAgdmFyIHJldCA9IGl0ZXJhdG9yWydyZXR1cm4nXTsKCSAgICBpZihyZXQgIT09IHVuZGVmaW5lZClhbk9iamVjdChyZXQuY2FsbChpdGVyYXRvcikpOwoJICAgIHRocm93IGU7CgkgIH0KCX07CgoJLyoqKi8gfSksCgkvKiA5MiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBJVEVSQVRPUiAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdpdGVyYXRvcicpCgkgICwgU0FGRV9DTE9TSU5HID0gZmFsc2U7CgoJdHJ5IHsKCSAgdmFyIHJpdGVyID0gWzddW0lURVJBVE9SXSgpOwoJICByaXRlclsncmV0dXJuJ10gPSBmdW5jdGlvbigpeyBTQUZFX0NMT1NJTkcgPSB0cnVlOyB9OwoJICBBcnJheS5mcm9tKHJpdGVyLCBmdW5jdGlvbigpeyB0aHJvdyAyOyB9KTsKCX0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGV4ZWMsIHNraXBDbG9zaW5nKXsKCSAgaWYoIXNraXBDbG9zaW5nICYmICFTQUZFX0NMT1NJTkcpcmV0dXJuIGZhbHNlOwoJICB2YXIgc2FmZSA9IGZhbHNlOwoJICB0cnkgewoJICAgIHZhciBhcnIgID0gWzddCgkgICAgICAsIGl0ZXIgPSBhcnJbSVRFUkFUT1JdKCk7CgkgICAgaXRlci5uZXh0ID0gZnVuY3Rpb24oKXsgcmV0dXJuIHtkb25lOiBzYWZlID0gdHJ1ZX07IH07CgkgICAgYXJyW0lURVJBVE9SXSA9IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyOyB9OwoJICAgIGV4ZWMoYXJyKTsKCSAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQoJICByZXR1cm4gc2FmZTsKCX07CgoJLyoqKi8gfSksCgkvKiA5MyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCXZhciBnZXRLZXlzICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KQoJICAsIHRvSU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpOwoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIGVsKXsKCSAgdmFyIE8gICAgICA9IHRvSU9iamVjdChvYmplY3QpCgkgICAgLCBrZXlzICAgPSBnZXRLZXlzKE8pCgkgICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAoJICAgICwgaW5kZXggID0gMAoJICAgICwga2V5OwoJICB3aGlsZShsZW5ndGggPiBpbmRleClpZihPW2tleSA9IGtleXNbaW5kZXgrK11dID09PSBlbClyZXR1cm4ga2V5OwoJfTsKCgkvKioqLyB9KSwKCS8qIDk0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyIGdsb2JhbCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKCSAgLCBtYWNyb3Rhc2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KS5zZXQKCSAgLCBPYnNlcnZlciAgPSBnbG9iYWwuTXV0YXRpb25PYnNlcnZlciB8fCBnbG9iYWwuV2ViS2l0TXV0YXRpb25PYnNlcnZlcgoJICAsIHByb2Nlc3MgICA9IGdsb2JhbC5wcm9jZXNzCgkgICwgUHJvbWlzZSAgID0gZ2xvYmFsLlByb21pc2UKCSAgLCBpc05vZGUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKShwcm9jZXNzKSA9PSAncHJvY2Vzcyc7CgoJbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpewoJICB2YXIgaGVhZCwgbGFzdCwgbm90aWZ5OwoKCSAgdmFyIGZsdXNoID0gZnVuY3Rpb24oKXsKCSAgICB2YXIgcGFyZW50LCBmbjsKCSAgICBpZihpc05vZGUgJiYgKHBhcmVudCA9IHByb2Nlc3MuZG9tYWluKSlwYXJlbnQuZXhpdCgpOwoJICAgIHdoaWxlKGhlYWQpewoJICAgICAgZm4gICA9IGhlYWQuZm47CgkgICAgICBoZWFkID0gaGVhZC5uZXh0OwoJICAgICAgdHJ5IHsKCSAgICAgICAgZm4oKTsKCSAgICAgIH0gY2F0Y2goZSl7CgkgICAgICAgIGlmKGhlYWQpbm90aWZ5KCk7CgkgICAgICAgIGVsc2UgbGFzdCA9IHVuZGVmaW5lZDsKCSAgICAgICAgdGhyb3cgZTsKCSAgICAgIH0KCSAgICB9IGxhc3QgPSB1bmRlZmluZWQ7CgkgICAgaWYocGFyZW50KXBhcmVudC5lbnRlcigpOwoJICB9OwoKCSAgLy8gTm9kZS5qcwoJICBpZihpc05vZGUpewoJICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CgkgICAgICBwcm9jZXNzLm5leHRUaWNrKGZsdXNoKTsKCSAgICB9OwoJICAvLyBicm93c2VycyB3aXRoIE11dGF0aW9uT2JzZXJ2ZXIKCSAgfSBlbHNlIGlmKE9ic2VydmVyKXsKCSAgICB2YXIgdG9nZ2xlID0gdHJ1ZQoJICAgICAgLCBub2RlICAgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyk7CgkgICAgbmV3IE9ic2VydmVyKGZsdXNoKS5vYnNlcnZlKG5vZGUsIHtjaGFyYWN0ZXJEYXRhOiB0cnVlfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3CgkgICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsKCSAgICAgIG5vZGUuZGF0YSA9IHRvZ2dsZSA9ICF0b2dnbGU7CgkgICAgfTsKCSAgLy8gZW52aXJvbm1lbnRzIHdpdGggbWF5YmUgbm9uLWNvbXBsZXRlbHkgY29ycmVjdCwgYnV0IGV4aXN0ZW50IFByb21pc2UKCSAgfSBlbHNlIGlmKFByb21pc2UgJiYgUHJvbWlzZS5yZXNvbHZlKXsKCSAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpOwoJICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CgkgICAgICBwcm9taXNlLnRoZW4oZmx1c2gpOwoJICAgIH07CgkgIC8vIGZvciBvdGhlciBlbnZpcm9ubWVudHMgLSBtYWNyb3Rhc2sgYmFzZWQgb246CgkgIC8vIC0gc2V0SW1tZWRpYXRlCgkgIC8vIC0gTWVzc2FnZUNoYW5uZWwKCSAgLy8gLSB3aW5kb3cucG9zdE1lc3NhZwoJICAvLyAtIG9ucmVhZHlzdGF0ZWNoYW5nZQoJICAvLyAtIHNldFRpbWVvdXQKCSAgfSBlbHNlIHsKCSAgICBub3RpZnkgPSBmdW5jdGlvbigpewoJICAgICAgLy8gc3RyYW5nZSBJRSArIHdlYnBhY2sgZGV2IHNlcnZlciBidWcgLSB1c2UgLmNhbGwoZ2xvYmFsKQoJICAgICAgbWFjcm90YXNrLmNhbGwoZ2xvYmFsLCBmbHVzaCk7CgkgICAgfTsKCSAgfQoKCSAgcmV0dXJuIGZ1bmN0aW9uKGZuKXsKCSAgICB2YXIgdGFzayA9IHtmbjogZm4sIG5leHQ6IHVuZGVmaW5lZH07CgkgICAgaWYobGFzdClsYXN0Lm5leHQgPSB0YXNrOwoJICAgIGlmKCFoZWFkKXsKCSAgICAgIGhlYWQgPSB0YXNrOwoJICAgICAgbm90aWZ5KCk7CgkgICAgfSBsYXN0ID0gdGFzazsKCSAgfTsKCX07CgoJLyoqKi8gfSksCgkvKiA5NSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIGZhbGxiYWNrIGZvciBJRTExIGJ1Z2d5IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHdpdGggaWZyYW1lIGFuZCB3aW5kb3cKCXZhciB0b0lPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQoJICAsIGdPUE4gICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjUpLmYKCSAgLCB0b1N0cmluZyAgPSB7fS50b1N0cmluZzsKCgl2YXIgd2luZG93TmFtZXMgPSB0eXBlb2Ygd2luZG93ID09ICdvYmplY3QnICYmIHdpbmRvdyAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcwoJICA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdykgOiBbXTsKCgl2YXIgZ2V0V2luZG93TmFtZXMgPSBmdW5jdGlvbihpdCl7CgkgIHRyeSB7CgkgICAgcmV0dXJuIGdPUE4oaXQpOwoJICB9IGNhdGNoKGUpewoJICAgIHJldHVybiB3aW5kb3dOYW1lcy5zbGljZSgpOwoJICB9Cgl9OwoKCW1vZHVsZS5leHBvcnRzLmYgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKGl0KXsKCSAgcmV0dXJuIHdpbmRvd05hbWVzICYmIHRvU3RyaW5nLmNhbGwoaXQpID09ICdbb2JqZWN0IFdpbmRvd10nID8gZ2V0V2luZG93TmFtZXMoaXQpIDogZ09QTih0b0lPYmplY3QoaXQpKTsKCX07CgoKCS8qKiovIH0pLAoJLyogOTYgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgl2YXIgaGlkZSA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHRhcmdldCwgc3JjLCBzYWZlKXsKCSAgZm9yKHZhciBrZXkgaW4gc3JjKXsKCSAgICBpZihzYWZlICYmIHRhcmdldFtrZXldKXRhcmdldFtrZXldID0gc3JjW2tleV07CgkgICAgZWxzZSBoaWRlKHRhcmdldCwga2V5LCBzcmNba2V5XSk7CgkgIH0gcmV0dXJuIHRhcmdldDsKCX07CgoJLyoqKi8gfSksCgkvKiA5NyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIFdvcmtzIHdpdGggX19wcm90b19fIG9ubHkuIE9sZCB2OCBjYW4ndCB3b3JrIHdpdGggbnVsbCBwcm90byBvYmplY3RzLgoJLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi8KCXZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNikKCSAgLCBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7Cgl2YXIgY2hlY2sgPSBmdW5jdGlvbihPLCBwcm90byl7CgkgIGFuT2JqZWN0KE8pOwoJICBpZighaXNPYmplY3QocHJvdG8pICYmIHByb3RvICE9PSBudWxsKXRocm93IFR5cGVFcnJvcihwcm90byArICI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIik7Cgl9OwoJbW9kdWxlLmV4cG9ydHMgPSB7CgkgIHNldDogT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8ICgnX19wcm90b19fJyBpbiB7fSA/IC8vIGVzbGludC1kaXNhYmxlLWxpbmUKCSAgICBmdW5jdGlvbih0ZXN0LCBidWdneSwgc2V0KXsKCSAgICAgIHRyeSB7CgkgICAgICAgIHNldCA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpKEZ1bmN0aW9uLmNhbGwsIF9fd2VicGFja19yZXF1aXJlX18oNTcpLmYoT2JqZWN0LnByb3RvdHlwZSwgJ19fcHJvdG9fXycpLnNldCwgMik7CgkgICAgICAgIHNldCh0ZXN0LCBbXSk7CgkgICAgICAgIGJ1Z2d5ID0gISh0ZXN0IGluc3RhbmNlb2YgQXJyYXkpOwoJICAgICAgfSBjYXRjaChlKXsgYnVnZ3kgPSB0cnVlOyB9CgkgICAgICByZXR1cm4gZnVuY3Rpb24gc2V0UHJvdG90eXBlT2YoTywgcHJvdG8pewoJICAgICAgICBjaGVjayhPLCBwcm90byk7CgkgICAgICAgIGlmKGJ1Z2d5KU8uX19wcm90b19fID0gcHJvdG87CgkgICAgICAgIGVsc2Ugc2V0KE8sIHByb3RvKTsKCSAgICAgICAgcmV0dXJuIE87CgkgICAgICB9OwoJICAgIH0oe30sIGZhbHNlKSA6IHVuZGVmaW5lZCksCgkgIGNoZWNrOiBjaGVjawoJfTsKCgkvKioqLyB9KSwKCS8qIDk4ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCXZhciBnbG9iYWwgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKCSAgLCBjb3JlICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKCSAgLCBkUCAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKCSAgLCBERVNDUklQVE9SUyA9IF9fd2VicGFja19yZXF1aXJlX18oMikKCSAgLCBTUEVDSUVTICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMykoJ3NwZWNpZXMnKTsKCgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEtFWSl7CgkgIHZhciBDID0gdHlwZW9mIGNvcmVbS0VZXSA9PSAnZnVuY3Rpb24nID8gY29yZVtLRVldIDogZ2xvYmFsW0tFWV07CgkgIGlmKERFU0NSSVBUT1JTICYmIEMgJiYgIUNbU1BFQ0lFU10pZFAuZihDLCBTUEVDSUVTLCB7CgkgICAgY29uZmlndXJhYmxlOiB0cnVlLAoJICAgIGdldDogZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH0KCSAgfSk7Cgl9OwoKCS8qKiovIH0pLAoJLyogOTkgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyA3LjMuMjAgU3BlY2llc0NvbnN0cnVjdG9yKE8sIGRlZmF1bHRDb25zdHJ1Y3RvcikKCXZhciBhbk9iamVjdCAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpCgkgICwgYUZ1bmN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSkKCSAgLCBTUEVDSUVTICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpKCdzcGVjaWVzJyk7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE8sIEQpewoJICB2YXIgQyA9IGFuT2JqZWN0KE8pLmNvbnN0cnVjdG9yLCBTOwoJICByZXR1cm4gQyA9PT0gdW5kZWZpbmVkIHx8IChTID0gYW5PYmplY3QoQylbU1BFQ0lFU10pID09IHVuZGVmaW5lZCA/IEQgOiBhRnVuY3Rpb24oUyk7Cgl9OwoKCS8qKiovIH0pLAoJLyogMTAwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpCgkvLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKCSRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0Jywge2NyZWF0ZTogX193ZWJwYWNrX3JlcXVpcmVfXygzNyl9KTsKCgkvKioqLyB9KSwKCS8qIDEwMSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIDE5LjEuMi45IE9iamVjdC5nZXRQcm90b3R5cGVPZihPKQoJdmFyIHRvT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCgkgICwgJGdldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0Myk7CgoJX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2dldFByb3RvdHlwZU9mJywgZnVuY3Rpb24oKXsKCSAgcmV0dXJuIGZ1bmN0aW9uIGdldFByb3RvdHlwZU9mKGl0KXsKCSAgICByZXR1cm4gJGdldFByb3RvdHlwZU9mKHRvT2JqZWN0KGl0KSk7CgkgIH07Cgl9KTsKCgkvKioqLyB9KSwKCS8qIDEwMiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCS8vIDE5LjEuMi4xNCBPYmplY3Qua2V5cyhPKQoJdmFyIHRvT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMikKCSAgLCAka2V5cyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpOwoKCV9fd2VicGFja19yZXF1aXJlX18oNDUpKCdrZXlzJywgZnVuY3Rpb24oKXsKCSAgcmV0dXJuIGZ1bmN0aW9uIGtleXMoaXQpewoJICAgIHJldHVybiAka2V5cyh0b09iamVjdChpdCkpOwoJICB9OwoJfSk7CgoJLyoqKi8gfSksCgkvKiAxMDMgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkvLyAxOS4xLjMuMTkgT2JqZWN0LnNldFByb3RvdHlwZU9mKE8sIHByb3RvKQoJdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwoJJGV4cG9ydCgkZXhwb3J0LlMsICdPYmplY3QnLCB7c2V0UHJvdG90eXBlT2Y6IF9fd2VicGFja19yZXF1aXJlX18oOTcpLnNldH0pOwoKCS8qKiovIH0pLAoJLyogMTA0ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCXZhciBMSUJSQVJZICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KQoJICAsIGdsb2JhbCAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKCSAgLCBjdHggICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQoJICAsIGNsYXNzb2YgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTUpCgkgICwgJGV4cG9ydCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KQoJICAsIGlzT2JqZWN0ICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKCSAgLCBhRnVuY3Rpb24gICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KQoJICAsIGFuSW5zdGFuY2UgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODUpCgkgICwgZm9yT2YgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NykKCSAgLCBzcGVjaWVzQ29uc3RydWN0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk5KQoJICAsIHRhc2sgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNjcpLnNldAoJICAsIG1pY3JvdGFzayAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTQpKCkKCSAgLCBQUk9NSVNFICAgICAgICAgICAgPSAnUHJvbWlzZScKCSAgLCBUeXBlRXJyb3IgICAgICAgICAgPSBnbG9iYWwuVHlwZUVycm9yCgkgICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MKCSAgLCAkUHJvbWlzZSAgICAgICAgICAgPSBnbG9iYWxbUFJPTUlTRV0KCSAgLCBwcm9jZXNzICAgICAgICAgICAgPSBnbG9iYWwucHJvY2VzcwoJICAsIGlzTm9kZSAgICAgICAgICAgICA9IGNsYXNzb2YocHJvY2VzcykgPT0gJ3Byb2Nlc3MnCgkgICwgZW1wdHkgICAgICAgICAgICAgID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfQoJICAsIEludGVybmFsLCBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHksIFdyYXBwZXI7CgoJdmFyIFVTRV9OQVRJVkUgPSAhIWZ1bmN0aW9uKCl7CgkgIHRyeSB7CgkgICAgLy8gY29ycmVjdCBzdWJjbGFzc2luZyB3aXRoIEBAc3BlY2llcyBzdXBwb3J0CgkgICAgdmFyIHByb21pc2UgICAgID0gJFByb21pc2UucmVzb2x2ZSgxKQoJICAgICAgLCBGYWtlUHJvbWlzZSA9IChwcm9taXNlLmNvbnN0cnVjdG9yID0ge30pW19fd2VicGFja19yZXF1aXJlX18oMykoJ3NwZWNpZXMnKV0gPSBmdW5jdGlvbihleGVjKXsgZXhlYyhlbXB0eSwgZW1wdHkpOyB9OwoJICAgIC8vIHVuaGFuZGxlZCByZWplY3Rpb25zIHRyYWNraW5nIHN1cHBvcnQsIE5vZGVKUyBQcm9taXNlIHdpdGhvdXQgaXQgZmFpbHMgQEBzcGVjaWVzIHRlc3QKCSAgICByZXR1cm4gKGlzTm9kZSB8fCB0eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50ID09ICdmdW5jdGlvbicpICYmIHByb21pc2UudGhlbihlbXB0eSkgaW5zdGFuY2VvZiBGYWtlUHJvbWlzZTsKCSAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQoJfSgpOwoKCS8vIGhlbHBlcnMKCXZhciBzYW1lQ29uc3RydWN0b3IgPSBmdW5jdGlvbihhLCBiKXsKCSAgLy8gd2l0aCBsaWJyYXJ5IHdyYXBwZXIgc3BlY2lhbCBjYXNlCgkgIHJldHVybiBhID09PSBiIHx8IGEgPT09ICRQcm9taXNlICYmIGIgPT09IFdyYXBwZXI7Cgl9OwoJdmFyIGlzVGhlbmFibGUgPSBmdW5jdGlvbihpdCl7CgkgIHZhciB0aGVuOwoJICByZXR1cm4gaXNPYmplY3QoaXQpICYmIHR5cGVvZiAodGhlbiA9IGl0LnRoZW4pID09ICdmdW5jdGlvbicgPyB0aGVuIDogZmFsc2U7Cgl9OwoJdmFyIG5ld1Byb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24oQyl7CgkgIHJldHVybiBzYW1lQ29uc3RydWN0b3IoJFByb21pc2UsIEMpCgkgICAgPyBuZXcgUHJvbWlzZUNhcGFiaWxpdHkoQykKCSAgICA6IG5ldyBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkoQyk7Cgl9OwoJdmFyIFByb21pc2VDYXBhYmlsaXR5ID0gR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24oQyl7CgkgIHZhciByZXNvbHZlLCByZWplY3Q7CgkgIHRoaXMucHJvbWlzZSA9IG5ldyBDKGZ1bmN0aW9uKCQkcmVzb2x2ZSwgJCRyZWplY3QpewoJICAgIGlmKHJlc29sdmUgIT09IHVuZGVmaW5lZCB8fCByZWplY3QgIT09IHVuZGVmaW5lZCl0aHJvdyBUeXBlRXJyb3IoJ0JhZCBQcm9taXNlIGNvbnN0cnVjdG9yJyk7CgkgICAgcmVzb2x2ZSA9ICQkcmVzb2x2ZTsKCSAgICByZWplY3QgID0gJCRyZWplY3Q7CgkgIH0pOwoJICB0aGlzLnJlc29sdmUgPSBhRnVuY3Rpb24ocmVzb2x2ZSk7CgkgIHRoaXMucmVqZWN0ICA9IGFGdW5jdGlvbihyZWplY3QpOwoJfTsKCXZhciBwZXJmb3JtID0gZnVuY3Rpb24oZXhlYyl7CgkgIHRyeSB7CgkgICAgZXhlYygpOwoJICB9IGNhdGNoKGUpewoJICAgIHJldHVybiB7ZXJyb3I6IGV9OwoJICB9Cgl9OwoJdmFyIG5vdGlmeSA9IGZ1bmN0aW9uKHByb21pc2UsIGlzUmVqZWN0KXsKCSAgaWYocHJvbWlzZS5fbilyZXR1cm47CgkgIHByb21pc2UuX24gPSB0cnVlOwoJICB2YXIgY2hhaW4gPSBwcm9taXNlLl9jOwoJICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsKCSAgICB2YXIgdmFsdWUgPSBwcm9taXNlLl92CgkgICAgICAsIG9rICAgID0gcHJvbWlzZS5fcyA9PSAxCgkgICAgICAsIGkgICAgID0gMDsKCSAgICB2YXIgcnVuID0gZnVuY3Rpb24ocmVhY3Rpb24pewoJICAgICAgdmFyIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbAoJICAgICAgICAsIHJlc29sdmUgPSByZWFjdGlvbi5yZXNvbHZlCgkgICAgICAgICwgcmVqZWN0ICA9IHJlYWN0aW9uLnJlamVjdAoJICAgICAgICAsIGRvbWFpbiAgPSByZWFjdGlvbi5kb21haW4KCSAgICAgICAgLCByZXN1bHQsIHRoZW47CgkgICAgICB0cnkgewoJICAgICAgICBpZihoYW5kbGVyKXsKCSAgICAgICAgICBpZighb2spewoJICAgICAgICAgICAgaWYocHJvbWlzZS5faCA9PSAyKW9uSGFuZGxlVW5oYW5kbGVkKHByb21pc2UpOwoJICAgICAgICAgICAgcHJvbWlzZS5faCA9IDE7CgkgICAgICAgICAgfQoJICAgICAgICAgIGlmKGhhbmRsZXIgPT09IHRydWUpcmVzdWx0ID0gdmFsdWU7CgkgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBpZihkb21haW4pZG9tYWluLmVudGVyKCk7CgkgICAgICAgICAgICByZXN1bHQgPSBoYW5kbGVyKHZhbHVlKTsKCSAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZXhpdCgpOwoJICAgICAgICAgIH0KCSAgICAgICAgICBpZihyZXN1bHQgPT09IHJlYWN0aW9uLnByb21pc2UpewoJICAgICAgICAgICAgcmVqZWN0KFR5cGVFcnJvcignUHJvbWlzZS1jaGFpbiBjeWNsZScpKTsKCSAgICAgICAgICB9IGVsc2UgaWYodGhlbiA9IGlzVGhlbmFibGUocmVzdWx0KSl7CgkgICAgICAgICAgICB0aGVuLmNhbGwocmVzdWx0LCByZXNvbHZlLCByZWplY3QpOwoJICAgICAgICAgIH0gZWxzZSByZXNvbHZlKHJlc3VsdCk7CgkgICAgICAgIH0gZWxzZSByZWplY3QodmFsdWUpOwoJICAgICAgfSBjYXRjaChlKXsKCSAgICAgICAgcmVqZWN0KGUpOwoJICAgICAgfQoJICAgIH07CgkgICAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSlydW4oY2hhaW5baSsrXSk7IC8vIHZhcmlhYmxlIGxlbmd0aCAtIGNhbid0IHVzZSBmb3JFYWNoCgkgICAgcHJvbWlzZS5fYyA9IFtdOwoJICAgIHByb21pc2UuX24gPSBmYWxzZTsKCSAgICBpZihpc1JlamVjdCAmJiAhcHJvbWlzZS5faClvblVuaGFuZGxlZChwcm9taXNlKTsKCSAgfSk7Cgl9OwoJdmFyIG9uVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CgkgIHRhc2suY2FsbChnbG9iYWwsIGZ1bmN0aW9uKCl7CgkgICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgoJICAgICAgLCBhYnJ1cHQsIGhhbmRsZXIsIGNvbnNvbGU7CgkgICAgaWYoaXNVbmhhbmRsZWQocHJvbWlzZSkpewoJICAgICAgYWJydXB0ID0gcGVyZm9ybShmdW5jdGlvbigpewoJICAgICAgICBpZihpc05vZGUpewoJICAgICAgICAgIHByb2Nlc3MuZW1pdCgndW5oYW5kbGVkUmVqZWN0aW9uJywgdmFsdWUsIHByb21pc2UpOwoJICAgICAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnVuaGFuZGxlZHJlamVjdGlvbil7CgkgICAgICAgICAgaGFuZGxlcih7cHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiB2YWx1ZX0pOwoJICAgICAgICB9IGVsc2UgaWYoKGNvbnNvbGUgPSBnbG9iYWwuY29uc29sZSkgJiYgY29uc29sZS5lcnJvcil7CgkgICAgICAgICAgY29uc29sZS5lcnJvcignVW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uJywgdmFsdWUpOwoJICAgICAgICB9CgkgICAgICB9KTsKCSAgICAgIC8vIEJyb3dzZXJzIHNob3VsZCBub3QgdHJpZ2dlciBgcmVqZWN0aW9uSGFuZGxlZGAgZXZlbnQgaWYgaXQgd2FzIGhhbmRsZWQgaGVyZSwgTm9kZUpTIC0gc2hvdWxkCgkgICAgICBwcm9taXNlLl9oID0gaXNOb2RlIHx8IGlzVW5oYW5kbGVkKHByb21pc2UpID8gMiA6IDE7CgkgICAgfSBwcm9taXNlLl9hID0gdW5kZWZpbmVkOwoJICAgIGlmKGFicnVwdCl0aHJvdyBhYnJ1cHQuZXJyb3I7CgkgIH0pOwoJfTsKCXZhciBpc1VuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2UpewoJICBpZihwcm9taXNlLl9oID09IDEpcmV0dXJuIGZhbHNlOwoJICB2YXIgY2hhaW4gPSBwcm9taXNlLl9hIHx8IHByb21pc2UuX2MKCSAgICAsIGkgICAgID0gMAoJICAgICwgcmVhY3Rpb247CgkgIHdoaWxlKGNoYWluLmxlbmd0aCA+IGkpewoJICAgIHJlYWN0aW9uID0gY2hhaW5baSsrXTsKCSAgICBpZihyZWFjdGlvbi5mYWlsIHx8ICFpc1VuaGFuZGxlZChyZWFjdGlvbi5wcm9taXNlKSlyZXR1cm4gZmFsc2U7CgkgIH0gcmV0dXJuIHRydWU7Cgl9OwoJdmFyIG9uSGFuZGxlVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7CgkgIHRhc2suY2FsbChnbG9iYWwsIGZ1bmN0aW9uKCl7CgkgICAgdmFyIGhhbmRsZXI7CgkgICAgaWYoaXNOb2RlKXsKCSAgICAgIHByb2Nlc3MuZW1pdCgncmVqZWN0aW9uSGFuZGxlZCcsIHByb21pc2UpOwoJICAgIH0gZWxzZSBpZihoYW5kbGVyID0gZ2xvYmFsLm9ucmVqZWN0aW9uaGFuZGxlZCl7CgkgICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHByb21pc2UuX3Z9KTsKCSAgICB9CgkgIH0pOwoJfTsKCXZhciAkcmVqZWN0ID0gZnVuY3Rpb24odmFsdWUpewoJICB2YXIgcHJvbWlzZSA9IHRoaXM7CgkgIGlmKHByb21pc2UuX2QpcmV0dXJuOwoJICBwcm9taXNlLl9kID0gdHJ1ZTsKCSAgcHJvbWlzZSA9IHByb21pc2UuX3cgfHwgcHJvbWlzZTsgLy8gdW53cmFwCgkgIHByb21pc2UuX3YgPSB2YWx1ZTsKCSAgcHJvbWlzZS5fcyA9IDI7CgkgIGlmKCFwcm9taXNlLl9hKXByb21pc2UuX2EgPSBwcm9taXNlLl9jLnNsaWNlKCk7CgkgIG5vdGlmeShwcm9taXNlLCB0cnVlKTsKCX07Cgl2YXIgJHJlc29sdmUgPSBmdW5jdGlvbih2YWx1ZSl7CgkgIHZhciBwcm9taXNlID0gdGhpcwoJICAgICwgdGhlbjsKCSAgaWYocHJvbWlzZS5fZClyZXR1cm47CgkgIHByb21pc2UuX2QgPSB0cnVlOwoJICBwcm9taXNlID0gcHJvbWlzZS5fdyB8fCBwcm9taXNlOyAvLyB1bndyYXAKCSAgdHJ5IHsKCSAgICBpZihwcm9taXNlID09PSB2YWx1ZSl0aHJvdyBUeXBlRXJyb3IoIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmIik7CgkgICAgaWYodGhlbiA9IGlzVGhlbmFibGUodmFsdWUpKXsKCSAgICAgIG1pY3JvdGFzayhmdW5jdGlvbigpewoJICAgICAgICB2YXIgd3JhcHBlciA9IHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfTsgLy8gd3JhcAoJICAgICAgICB0cnkgewoJICAgICAgICAgIHRoZW4uY2FsbCh2YWx1ZSwgY3R4KCRyZXNvbHZlLCB3cmFwcGVyLCAxKSwgY3R4KCRyZWplY3QsIHdyYXBwZXIsIDEpKTsKCSAgICAgICAgfSBjYXRjaChlKXsKCSAgICAgICAgICAkcmVqZWN0LmNhbGwod3JhcHBlciwgZSk7CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0gZWxzZSB7CgkgICAgICBwcm9taXNlLl92ID0gdmFsdWU7CgkgICAgICBwcm9taXNlLl9zID0gMTsKCSAgICAgIG5vdGlmeShwcm9taXNlLCBmYWxzZSk7CgkgICAgfQoJICB9IGNhdGNoKGUpewoJICAgICRyZWplY3QuY2FsbCh7X3c6IHByb21pc2UsIF9kOiBmYWxzZX0sIGUpOyAvLyB3cmFwCgkgIH0KCX07CgoJLy8gY29uc3RydWN0b3IgcG9seWZpbGwKCWlmKCFVU0VfTkFUSVZFKXsKCSAgLy8gMjUuNC4zLjEgUHJvbWlzZShleGVjdXRvcikKCSAgJFByb21pc2UgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsKCSAgICBhbkluc3RhbmNlKHRoaXMsICRQcm9taXNlLCBQUk9NSVNFLCAnX2gnKTsKCSAgICBhRnVuY3Rpb24oZXhlY3V0b3IpOwoJICAgIEludGVybmFsLmNhbGwodGhpcyk7CgkgICAgdHJ5IHsKCSAgICAgIGV4ZWN1dG9yKGN0eCgkcmVzb2x2ZSwgdGhpcywgMSksIGN0eCgkcmVqZWN0LCB0aGlzLCAxKSk7CgkgICAgfSBjYXRjaChlcnIpewoJICAgICAgJHJlamVjdC5jYWxsKHRoaXMsIGVycik7CgkgICAgfQoJICB9OwoJICBJbnRlcm5hbCA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpewoJICAgIHRoaXMuX2MgPSBbXTsgICAgICAgICAgICAgLy8gPC0gYXdhaXRpbmcgcmVhY3Rpb25zCgkgICAgdGhpcy5fYSA9IHVuZGVmaW5lZDsgICAgICAvLyA8LSBjaGVja2VkIGluIGlzVW5oYW5kbGVkIHJlYWN0aW9ucwoJICAgIHRoaXMuX3MgPSAwOyAgICAgICAgICAgICAgLy8gPC0gc3RhdGUKCSAgICB0aGlzLl9kID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIGRvbmUKCSAgICB0aGlzLl92ID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIHZhbHVlCgkgICAgdGhpcy5faCA9IDA7ICAgICAgICAgICAgICAvLyA8LSByZWplY3Rpb24gc3RhdGUsIDAgLSBkZWZhdWx0LCAxIC0gaGFuZGxlZCwgMiAtIHVuaGFuZGxlZAoJICAgIHRoaXMuX24gPSBmYWxzZTsgICAgICAgICAgLy8gPC0gbm90aWZ5CgkgIH07CgkgIEludGVybmFsLnByb3RvdHlwZSA9IF9fd2VicGFja19yZXF1aXJlX18oOTYpKCRQcm9taXNlLnByb3RvdHlwZSwgewoJICAgIC8vIDI1LjQuNS4zIFByb21pc2UucHJvdG90eXBlLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpCgkgICAgdGhlbjogZnVuY3Rpb24gdGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCl7CgkgICAgICB2YXIgcmVhY3Rpb24gICAgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShzcGVjaWVzQ29uc3RydWN0b3IodGhpcywgJFByb21pc2UpKTsKCSAgICAgIHJlYWN0aW9uLm9rICAgICA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PSAnZnVuY3Rpb24nID8gb25GdWxmaWxsZWQgOiB0cnVlOwoJICAgICAgcmVhY3Rpb24uZmFpbCAgID0gdHlwZW9mIG9uUmVqZWN0ZWQgPT0gJ2Z1bmN0aW9uJyAmJiBvblJlamVjdGVkOwoJICAgICAgcmVhY3Rpb24uZG9tYWluID0gaXNOb2RlID8gcHJvY2Vzcy5kb21haW4gOiB1bmRlZmluZWQ7CgkgICAgICB0aGlzLl9jLnB1c2gocmVhY3Rpb24pOwoJICAgICAgaWYodGhpcy5fYSl0aGlzLl9hLnB1c2gocmVhY3Rpb24pOwoJICAgICAgaWYodGhpcy5fcylub3RpZnkodGhpcywgZmFsc2UpOwoJICAgICAgcmV0dXJuIHJlYWN0aW9uLnByb21pc2U7CgkgICAgfSwKCSAgICAvLyAyNS40LjUuMSBQcm9taXNlLnByb3RvdHlwZS5jYXRjaChvblJlamVjdGVkKQoJICAgICdjYXRjaCc6IGZ1bmN0aW9uKG9uUmVqZWN0ZWQpewoJICAgICAgcmV0dXJuIHRoaXMudGhlbih1bmRlZmluZWQsIG9uUmVqZWN0ZWQpOwoJICAgIH0KCSAgfSk7CgkgIFByb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24oKXsKCSAgICB2YXIgcHJvbWlzZSAgPSBuZXcgSW50ZXJuYWw7CgkgICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTsKCSAgICB0aGlzLnJlc29sdmUgPSBjdHgoJHJlc29sdmUsIHByb21pc2UsIDEpOwoJICAgIHRoaXMucmVqZWN0ICA9IGN0eCgkcmVqZWN0LCBwcm9taXNlLCAxKTsKCSAgfTsKCX0KCgkkZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuVyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCB7UHJvbWlzZTogJFByb21pc2V9KTsKCV9fd2VicGFja19yZXF1aXJlX18oMjIpKCRQcm9taXNlLCBQUk9NSVNFKTsKCV9fd2VicGFja19yZXF1aXJlX18oOTgpKFBST01JU0UpOwoJV3JhcHBlciA9IF9fd2VicGFja19yZXF1aXJlX18oMClbUFJPTUlTRV07CgoJLy8gc3RhdGljcwoJJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgUFJPTUlTRSwgewoJICAvLyAyNS40LjQuNSBQcm9taXNlLnJlamVjdChyKQoJICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyKXsKCSAgICB2YXIgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHRoaXMpCgkgICAgICAsICQkcmVqZWN0ICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKCSAgICAkJHJlamVjdChyKTsKCSAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwoJICB9Cgl9KTsKCSRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKExJQlJBUlkgfHwgIVVTRV9OQVRJVkUpLCBQUk9NSVNFLCB7CgkgIC8vIDI1LjQuNC42IFByb21pc2UucmVzb2x2ZSh4KQoJICByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKHgpewoJICAgIC8vIGluc3RhbmNlb2YgaW5zdGVhZCBvZiBpbnRlcm5hbCBzbG90IGNoZWNrIGJlY2F1c2Ugd2Ugc2hvdWxkIGZpeCBpdCB3aXRob3V0IHJlcGxhY2VtZW50IG5hdGl2ZSBQcm9taXNlIGNvcmUKCSAgICBpZih4IGluc3RhbmNlb2YgJFByb21pc2UgJiYgc2FtZUNvbnN0cnVjdG9yKHguY29uc3RydWN0b3IsIHRoaXMpKXJldHVybiB4OwoJICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykKCSAgICAgICwgJCRyZXNvbHZlICA9IGNhcGFiaWxpdHkucmVzb2x2ZTsKCSAgICAkJHJlc29sdmUoeCk7CgkgICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKCSAgfQoJfSk7CgkkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoVVNFX05BVElWRSAmJiBfX3dlYnBhY2tfcmVxdWlyZV9fKDkyKShmdW5jdGlvbihpdGVyKXsKCSAgJFByb21pc2UuYWxsKGl0ZXIpWydjYXRjaCddKGVtcHR5KTsKCX0pKSwgUFJPTUlTRSwgewoJICAvLyAyNS40LjQuMSBQcm9taXNlLmFsbChpdGVyYWJsZSkKCSAgYWxsOiBmdW5jdGlvbiBhbGwoaXRlcmFibGUpewoJICAgIHZhciBDICAgICAgICAgID0gdGhpcwoJICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykKCSAgICAgICwgcmVzb2x2ZSAgICA9IGNhcGFiaWxpdHkucmVzb2x2ZQoJICAgICAgLCByZWplY3QgICAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CgkgICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKCSAgICAgIHZhciB2YWx1ZXMgICAgPSBbXQoJICAgICAgICAsIGluZGV4ICAgICA9IDAKCSAgICAgICAgLCByZW1haW5pbmcgPSAxOwoJICAgICAgZm9yT2YoaXRlcmFibGUsIGZhbHNlLCBmdW5jdGlvbihwcm9taXNlKXsKCSAgICAgICAgdmFyICRpbmRleCAgICAgICAgPSBpbmRleCsrCgkgICAgICAgICAgLCBhbHJlYWR5Q2FsbGVkID0gZmFsc2U7CgkgICAgICAgIHZhbHVlcy5wdXNoKHVuZGVmaW5lZCk7CgkgICAgICAgIHJlbWFpbmluZysrOwoJICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihmdW5jdGlvbih2YWx1ZSl7CgkgICAgICAgICAgaWYoYWxyZWFkeUNhbGxlZClyZXR1cm47CgkgICAgICAgICAgYWxyZWFkeUNhbGxlZCAgPSB0cnVlOwoJICAgICAgICAgIHZhbHVlc1skaW5kZXhdID0gdmFsdWU7CgkgICAgICAgICAgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpOwoJICAgICAgICB9LCByZWplY3QpOwoJICAgICAgfSk7CgkgICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CgkgICAgfSk7CgkgICAgaWYoYWJydXB0KXJlamVjdChhYnJ1cHQuZXJyb3IpOwoJICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CgkgIH0sCgkgIC8vIDI1LjQuNC40IFByb21pc2UucmFjZShpdGVyYWJsZSkKCSAgcmFjZTogZnVuY3Rpb24gcmFjZShpdGVyYWJsZSl7CgkgICAgdmFyIEMgICAgICAgICAgPSB0aGlzCgkgICAgICAsIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKQoJICAgICAgLCByZWplY3QgICAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CgkgICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKCSAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CgkgICAgICAgIEMucmVzb2x2ZShwcm9taXNlKS50aGVuKGNhcGFiaWxpdHkucmVzb2x2ZSwgcmVqZWN0KTsKCSAgICAgIH0pOwoJICAgIH0pOwoJICAgIGlmKGFicnVwdClyZWplY3QoYWJydXB0LmVycm9yKTsKCSAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwoJICB9Cgl9KTsKCgkvKioqLyB9KSwKCS8qIDEwNSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgkvLyBFQ01BU2NyaXB0IDYgc3ltYm9scyBzaGltCgl2YXIgZ2xvYmFsICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCgkgICwgaGFzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQoJICAsIERFU0NSSVBUT1JTICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKQoJICAsICRleHBvcnQgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KQoJICAsIHJlZGVmaW5lICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NikKCSAgLCBNRVRBICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpLktFWQoJICAsICRmYWlscyAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSkKCSAgLCBzaGFyZWQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzApCgkgICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKQoJICAsIHVpZCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMykKCSAgLCB3a3MgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMykKCSAgLCB3a3NFeHQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpCgkgICwgd2tzRGVmaW5lICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ4KQoJICAsIGtleU9mICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MykKCSAgLCBlbnVtS2V5cyAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oODYpCgkgICwgaXNBcnJheSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkwKQoJICAsIGFuT2JqZWN0ICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQoJICAsIHRvSU9iamVjdCAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKCSAgLCB0b1ByaW1pdGl2ZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpCgkgICwgY3JlYXRlRGVzYyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQoJICAsIF9jcmVhdGUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNykKCSAgLCBnT1BORXh0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTUpCgkgICwgJEdPUEQgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KQoJICAsICREUCAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQoJICAsICRrZXlzICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCkKCSAgLCBnT1BEICAgICAgICAgICA9ICRHT1BELmYKCSAgLCBkUCAgICAgICAgICAgICA9ICREUC5mCgkgICwgZ09QTiAgICAgICAgICAgPSBnT1BORXh0LmYKCSAgLCAkU3ltYm9sICAgICAgICA9IGdsb2JhbC5TeW1ib2wKCSAgLCAkSlNPTiAgICAgICAgICA9IGdsb2JhbC5KU09OCgkgICwgX3N0cmluZ2lmeSAgICAgPSAkSlNPTiAmJiAkSlNPTi5zdHJpbmdpZnkKCSAgLCBQUk9UT1RZUEUgICAgICA9ICdwcm90b3R5cGUnCgkgICwgSElEREVOICAgICAgICAgPSB3a3MoJ19oaWRkZW4nKQoJICAsIFRPX1BSSU1JVElWRSAgID0gd2tzKCd0b1ByaW1pdGl2ZScpCgkgICwgaXNFbnVtICAgICAgICAgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZQoJICAsIFN5bWJvbFJlZ2lzdHJ5ID0gc2hhcmVkKCdzeW1ib2wtcmVnaXN0cnknKQoJICAsIEFsbFN5bWJvbHMgICAgID0gc2hhcmVkKCdzeW1ib2xzJykKCSAgLCBPUFN5bWJvbHMgICAgICA9IHNoYXJlZCgnb3Atc3ltYm9scycpCgkgICwgT2JqZWN0UHJvdG8gICAgPSBPYmplY3RbUFJPVE9UWVBFXQoJICAsIFVTRV9OQVRJVkUgICAgID0gdHlwZW9mICRTeW1ib2wgPT0gJ2Z1bmN0aW9uJwoJICAsIFFPYmplY3QgICAgICAgID0gZ2xvYmFsLlFPYmplY3Q7CgkvLyBEb24ndCB1c2Ugc2V0dGVycyBpbiBRdCBTY3JpcHQsIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8xNzMKCXZhciBzZXR0ZXIgPSAhUU9iamVjdCB8fCAhUU9iamVjdFtQUk9UT1RZUEVdIHx8ICFRT2JqZWN0W1BST1RPVFlQRV0uZmluZENoaWxkOwoKCS8vIGZhbGxiYWNrIGZvciBvbGQgQW5kcm9pZCwgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTY4NwoJdmFyIHNldFN5bWJvbERlc2MgPSBERVNDUklQVE9SUyAmJiAkZmFpbHMoZnVuY3Rpb24oKXsKCSAgcmV0dXJuIF9jcmVhdGUoZFAoe30sICdhJywgewoJICAgIGdldDogZnVuY3Rpb24oKXsgcmV0dXJuIGRQKHRoaXMsICdhJywge3ZhbHVlOiA3fSkuYTsgfQoJICB9KSkuYSAhPSA3OwoJfSkgPyBmdW5jdGlvbihpdCwga2V5LCBEKXsKCSAgdmFyIHByb3RvRGVzYyA9IGdPUEQoT2JqZWN0UHJvdG8sIGtleSk7CgkgIGlmKHByb3RvRGVzYylkZWxldGUgT2JqZWN0UHJvdG9ba2V5XTsKCSAgZFAoaXQsIGtleSwgRCk7CgkgIGlmKHByb3RvRGVzYyAmJiBpdCAhPT0gT2JqZWN0UHJvdG8pZFAoT2JqZWN0UHJvdG8sIGtleSwgcHJvdG9EZXNjKTsKCX0gOiBkUDsKCgl2YXIgd3JhcCA9IGZ1bmN0aW9uKHRhZyl7CgkgIHZhciBzeW0gPSBBbGxTeW1ib2xzW3RhZ10gPSBfY3JlYXRlKCRTeW1ib2xbUFJPVE9UWVBFXSk7CgkgIHN5bS5fayA9IHRhZzsKCSAgcmV0dXJuIHN5bTsKCX07CgoJdmFyIGlzU3ltYm9sID0gVVNFX05BVElWRSAmJiB0eXBlb2YgJFN5bWJvbC5pdGVyYXRvciA9PSAnc3ltYm9sJyA/IGZ1bmN0aW9uKGl0KXsKCSAgcmV0dXJuIHR5cGVvZiBpdCA9PSAnc3ltYm9sJzsKCX0gOiBmdW5jdGlvbihpdCl7CgkgIHJldHVybiBpdCBpbnN0YW5jZW9mICRTeW1ib2w7Cgl9OwoKCXZhciAkZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBEKXsKCSAgaWYoaXQgPT09IE9iamVjdFByb3RvKSRkZWZpbmVQcm9wZXJ0eShPUFN5bWJvbHMsIGtleSwgRCk7CgkgIGFuT2JqZWN0KGl0KTsKCSAga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKTsKCSAgYW5PYmplY3QoRCk7CgkgIGlmKGhhcyhBbGxTeW1ib2xzLCBrZXkpKXsKCSAgICBpZighRC5lbnVtZXJhYmxlKXsKCSAgICAgIGlmKCFoYXMoaXQsIEhJRERFTikpZFAoaXQsIEhJRERFTiwgY3JlYXRlRGVzYygxLCB7fSkpOwoJICAgICAgaXRbSElEREVOXVtrZXldID0gdHJ1ZTsKCSAgICB9IGVsc2UgewoJICAgICAgaWYoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSlpdFtISURERU5dW2tleV0gPSBmYWxzZTsKCSAgICAgIEQgPSBfY3JlYXRlKEQsIHtlbnVtZXJhYmxlOiBjcmVhdGVEZXNjKDAsIGZhbHNlKX0pOwoJICAgIH0gcmV0dXJuIHNldFN5bWJvbERlc2MoaXQsIGtleSwgRCk7CgkgIH0gcmV0dXJuIGRQKGl0LCBrZXksIEQpOwoJfTsKCXZhciAkZGVmaW5lUHJvcGVydGllcyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoaXQsIFApewoJICBhbk9iamVjdChpdCk7CgkgIHZhciBrZXlzID0gZW51bUtleXMoUCA9IHRvSU9iamVjdChQKSkKCSAgICAsIGkgICAgPSAwCgkgICAgLCBsID0ga2V5cy5sZW5ndGgKCSAgICAsIGtleTsKCSAgd2hpbGUobCA+IGkpJGRlZmluZVByb3BlcnR5KGl0LCBrZXkgPSBrZXlzW2krK10sIFBba2V5XSk7CgkgIHJldHVybiBpdDsKCX07Cgl2YXIgJGNyZWF0ZSA9IGZ1bmN0aW9uIGNyZWF0ZShpdCwgUCl7CgkgIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfY3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9jcmVhdGUoaXQpLCBQKTsKCX07Cgl2YXIgJHByb3BlcnR5SXNFbnVtZXJhYmxlID0gZnVuY3Rpb24gcHJvcGVydHlJc0VudW1lcmFibGUoa2V5KXsKCSAgdmFyIEUgPSBpc0VudW0uY2FsbCh0aGlzLCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKTsKCSAgaWYodGhpcyA9PT0gT2JqZWN0UHJvdG8gJiYgaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIWhhcyhPUFN5bWJvbHMsIGtleSkpcmV0dXJuIGZhbHNlOwoJICByZXR1cm4gRSB8fCAhaGFzKHRoaXMsIGtleSkgfHwgIWhhcyhBbGxTeW1ib2xzLCBrZXkpIHx8IGhhcyh0aGlzLCBISURERU4pICYmIHRoaXNbSElEREVOXVtrZXldID8gRSA6IHRydWU7Cgl9OwoJdmFyICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7CgkgIGl0ICA9IHRvSU9iamVjdChpdCk7CgkgIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7CgkgIGlmKGl0ID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSlyZXR1cm47CgkgIHZhciBEID0gZ09QRChpdCwga2V5KTsKCSAgaWYoRCAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKUQuZW51bWVyYWJsZSA9IHRydWU7CgkgIHJldHVybiBEOwoJfTsKCXZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpewoJICB2YXIgbmFtZXMgID0gZ09QTih0b0lPYmplY3QoaXQpKQoJICAgICwgcmVzdWx0ID0gW10KCSAgICAsIGkgICAgICA9IDAKCSAgICAsIGtleTsKCSAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7CgkgICAgaWYoIWhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiBrZXkgIT0gSElEREVOICYmIGtleSAhPSBNRVRBKXJlc3VsdC5wdXNoKGtleSk7CgkgIH0gcmV0dXJuIHJlc3VsdDsKCX07Cgl2YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCl7CgkgIHZhciBJU19PUCAgPSBpdCA9PT0gT2JqZWN0UHJvdG8KCSAgICAsIG5hbWVzICA9IGdPUE4oSVNfT1AgPyBPUFN5bWJvbHMgOiB0b0lPYmplY3QoaXQpKQoJICAgICwgcmVzdWx0ID0gW10KCSAgICAsIGkgICAgICA9IDAKCSAgICAsIGtleTsKCSAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7CgkgICAgaWYoaGFzKEFsbFN5bWJvbHMsIGtleSA9IG5hbWVzW2krK10pICYmIChJU19PUCA/IGhhcyhPYmplY3RQcm90bywga2V5KSA6IHRydWUpKXJlc3VsdC5wdXNoKEFsbFN5bWJvbHNba2V5XSk7CgkgIH0gcmV0dXJuIHJlc3VsdDsKCX07CgoJLy8gMTkuNC4xLjEgU3ltYm9sKFtkZXNjcmlwdGlvbl0pCglpZighVVNFX05BVElWRSl7CgkgICRTeW1ib2wgPSBmdW5jdGlvbiBTeW1ib2woKXsKCSAgICBpZih0aGlzIGluc3RhbmNlb2YgJFN5bWJvbCl0aHJvdyBUeXBlRXJyb3IoJ1N5bWJvbCBpcyBub3QgYSBjb25zdHJ1Y3RvciEnKTsKCSAgICB2YXIgdGFnID0gdWlkKGFyZ3VtZW50cy5sZW5ndGggPiAwID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkKTsKCSAgICB2YXIgJHNldCA9IGZ1bmN0aW9uKHZhbHVlKXsKCSAgICAgIGlmKHRoaXMgPT09IE9iamVjdFByb3RvKSRzZXQuY2FsbChPUFN5bWJvbHMsIHZhbHVlKTsKCSAgICAgIGlmKGhhcyh0aGlzLCBISURERU4pICYmIGhhcyh0aGlzW0hJRERFTl0sIHRhZykpdGhpc1tISURERU5dW3RhZ10gPSBmYWxzZTsKCSAgICAgIHNldFN5bWJvbERlc2ModGhpcywgdGFnLCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7CgkgICAgfTsKCSAgICBpZihERVNDUklQVE9SUyAmJiBzZXR0ZXIpc2V0U3ltYm9sRGVzYyhPYmplY3RQcm90bywgdGFnLCB7Y29uZmlndXJhYmxlOiB0cnVlLCBzZXQ6ICRzZXR9KTsKCSAgICByZXR1cm4gd3JhcCh0YWcpOwoJICB9OwoJICByZWRlZmluZSgkU3ltYm9sW1BST1RPVFlQRV0sICd0b1N0cmluZycsIGZ1bmN0aW9uIHRvU3RyaW5nKCl7CgkgICAgcmV0dXJuIHRoaXMuX2s7CgkgIH0pOwoKCSAgJEdPUEQuZiA9ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CgkgICREUC5mICAgPSAkZGVmaW5lUHJvcGVydHk7CgkgIF9fd2VicGFja19yZXF1aXJlX18oNjUpLmYgPSBnT1BORXh0LmYgPSAkZ2V0T3duUHJvcGVydHlOYW1lczsKCSAgX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkuZiAgPSAkcHJvcGVydHlJc0VudW1lcmFibGU7CgkgIF9fd2VicGFja19yZXF1aXJlX18oNTgpLmYgPSAkZ2V0T3duUHJvcGVydHlTeW1ib2xzOwoKCSAgaWYoREVTQ1JJUFRPUlMgJiYgIV9fd2VicGFja19yZXF1aXJlX18oMjYpKXsKCSAgICByZWRlZmluZShPYmplY3RQcm90bywgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJywgJHByb3BlcnR5SXNFbnVtZXJhYmxlLCB0cnVlKTsKCSAgfQoKCSAgd2tzRXh0LmYgPSBmdW5jdGlvbihuYW1lKXsKCSAgICByZXR1cm4gd3JhcCh3a3MobmFtZSkpOwoJICB9Cgl9CgoJJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1N5bWJvbDogJFN5bWJvbH0pOwoKCWZvcih2YXIgc3ltYm9scyA9ICgKCSAgLy8gMTkuNC4yLjIsIDE5LjQuMi4zLCAxOS40LjIuNCwgMTkuNC4yLjYsIDE5LjQuMi44LCAxOS40LjIuOSwgMTkuNC4yLjEwLCAxOS40LjIuMTEsIDE5LjQuMi4xMiwgMTkuNC4yLjEzLCAxOS40LjIuMTQKCSAgJ2hhc0luc3RhbmNlLGlzQ29uY2F0U3ByZWFkYWJsZSxpdGVyYXRvcixtYXRjaCxyZXBsYWNlLHNlYXJjaCxzcGVjaWVzLHNwbGl0LHRvUHJpbWl0aXZlLHRvU3RyaW5nVGFnLHVuc2NvcGFibGVzJwoJKS5zcGxpdCgnLCcpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzKHN5bWJvbHNbaSsrXSk7CgoJZm9yKHZhciBzeW1ib2xzID0gJGtleXMod2tzLnN0b3JlKSwgaSA9IDA7IHN5bWJvbHMubGVuZ3RoID4gaTsgKXdrc0RlZmluZShzeW1ib2xzW2krK10pOwoKCSRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsICdTeW1ib2wnLCB7CgkgIC8vIDE5LjQuMi4xIFN5bWJvbC5mb3Ioa2V5KQoJICAnZm9yJzogZnVuY3Rpb24oa2V5KXsKCSAgICByZXR1cm4gaGFzKFN5bWJvbFJlZ2lzdHJ5LCBrZXkgKz0gJycpCgkgICAgICA/IFN5bWJvbFJlZ2lzdHJ5W2tleV0KCSAgICAgIDogU3ltYm9sUmVnaXN0cnlba2V5XSA9ICRTeW1ib2woa2V5KTsKCSAgfSwKCSAgLy8gMTkuNC4yLjUgU3ltYm9sLmtleUZvcihzeW0pCgkgIGtleUZvcjogZnVuY3Rpb24ga2V5Rm9yKGtleSl7CgkgICAgaWYoaXNTeW1ib2woa2V5KSlyZXR1cm4ga2V5T2YoU3ltYm9sUmVnaXN0cnksIGtleSk7CgkgICAgdGhyb3cgVHlwZUVycm9yKGtleSArICcgaXMgbm90IGEgc3ltYm9sIScpOwoJICB9LAoJICB1c2VTZXR0ZXI6IGZ1bmN0aW9uKCl7IHNldHRlciA9IHRydWU7IH0sCgkgIHVzZVNpbXBsZTogZnVuY3Rpb24oKXsgc2V0dGVyID0gZmFsc2U7IH0KCX0pOwoKCSRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsICdPYmplY3QnLCB7CgkgIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKCSAgY3JlYXRlOiAkY3JlYXRlLAoJICAvLyAxOS4xLjIuNCBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykKCSAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSwKCSAgLy8gMTkuMS4yLjMgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcykKCSAgZGVmaW5lUHJvcGVydGllczogJGRlZmluZVByb3BlcnRpZXMsCgkgIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkKCSAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLAoJICAvLyAxOS4xLjIuNyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKQoJICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcywKCSAgLy8gMTkuMS4yLjggT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhPKQoJICBnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6ICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHMKCX0pOwoKCS8vIDI0LjMuMiBKU09OLnN0cmluZ2lmeSh2YWx1ZSBbLCByZXBsYWNlciBbLCBzcGFjZV1dKQoJJEpTT04gJiYgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoIVVTRV9OQVRJVkUgfHwgJGZhaWxzKGZ1bmN0aW9uKCl7CgkgIHZhciBTID0gJFN5bWJvbCgpOwoJICAvLyBNUyBFZGdlIGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyB7fQoJICAvLyBXZWJLaXQgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIG51bGwKCSAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHMKCSAgcmV0dXJuIF9zdHJpbmdpZnkoW1NdKSAhPSAnW251bGxdJyB8fCBfc3RyaW5naWZ5KHthOiBTfSkgIT0gJ3t9JyB8fCBfc3RyaW5naWZ5KE9iamVjdChTKSkgIT0gJ3t9JzsKCX0pKSwgJ0pTT04nLCB7CgkgIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXsKCSAgICBpZihpdCA9PT0gdW5kZWZpbmVkIHx8IGlzU3ltYm9sKGl0KSlyZXR1cm47IC8vIElFOCByZXR1cm5zIHN0cmluZyBvbiB1bmRlZmluZWQKCSAgICB2YXIgYXJncyA9IFtpdF0KCSAgICAgICwgaSAgICA9IDEKCSAgICAgICwgcmVwbGFjZXIsICRyZXBsYWNlcjsKCSAgICB3aGlsZShhcmd1bWVudHMubGVuZ3RoID4gaSlhcmdzLnB1c2goYXJndW1lbnRzW2krK10pOwoJICAgIHJlcGxhY2VyID0gYXJnc1sxXTsKCSAgICBpZih0eXBlb2YgcmVwbGFjZXIgPT0gJ2Z1bmN0aW9uJykkcmVwbGFjZXIgPSByZXBsYWNlcjsKCSAgICBpZigkcmVwbGFjZXIgfHwgIWlzQXJyYXkocmVwbGFjZXIpKXJlcGxhY2VyID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSl7CgkgICAgICBpZigkcmVwbGFjZXIpdmFsdWUgPSAkcmVwbGFjZXIuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTsKCSAgICAgIGlmKCFpc1N5bWJvbCh2YWx1ZSkpcmV0dXJuIHZhbHVlOwoJICAgIH07CgkgICAgYXJnc1sxXSA9IHJlcGxhY2VyOwoJICAgIHJldHVybiBfc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmdzKTsKCSAgfQoJfSk7CgoJLy8gMTkuNC4zLjQgU3ltYm9sLnByb3RvdHlwZVtAQHRvUHJpbWl0aXZlXShoaW50KQoJJFN5bWJvbFtQUk9UT1RZUEVdW1RPX1BSSU1JVElWRV0gfHwgX193ZWJwYWNrX3JlcXVpcmVfXyg3KSgkU3ltYm9sW1BST1RPVFlQRV0sIFRPX1BSSU1JVElWRSwgJFN5bWJvbFtQUk9UT1RZUEVdLnZhbHVlT2YpOwoJLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXQoJc2V0VG9TdHJpbmdUYWcoJFN5bWJvbCwgJ1N5bWJvbCcpOwoJLy8gMjAuMi4xLjkgTWF0aFtAQHRvU3RyaW5nVGFnXQoJc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTsKCS8vIDI0LjMuMyBKU09OW0BAdG9TdHJpbmdUYWddCglzZXRUb1N0cmluZ1RhZyhnbG9iYWwuSlNPTiwgJ0pTT04nLCB0cnVlKTsKCgkvKioqLyB9KSwKCS8qIDEwNiAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oNDgpKCdhc3luY0l0ZXJhdG9yJyk7CgoJLyoqKi8gfSksCgkvKiAxMDcgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDQ4KSgnb2JzZXJ2YWJsZScpOwoKCS8qKiovIH0pLAoJLyogMTA4ICovLAoJLyogMTA5ICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX3N0cmluZ2lmeSA9IF9fd2VicGFja19yZXF1aXJlX18oNDApOwoKCXZhciBfc3RyaW5naWZ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmeSk7CgoJdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7CgoJdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKCWV4cG9ydHMuZGl2aWRlVVJMID0gZGl2aWRlVVJMOwoJZXhwb3J0cy5kaXZpZGVFbWFpbCA9IGRpdmlkZUVtYWlsOwoJZXhwb3J0cy5lbXB0eU9iamVjdCA9IGVtcHR5T2JqZWN0OwoJZXhwb3J0cy5kZWVwQ2xvbmUgPSBkZWVwQ2xvbmU7CglleHBvcnRzLmdldFVzZXJVUkxGcm9tRW1haWwgPSBnZXRVc2VyVVJMRnJvbUVtYWlsOwoJZXhwb3J0cy5nZXRVc2VyRW1haWxGcm9tVVJMID0gZ2V0VXNlckVtYWlsRnJvbVVSTDsKCWV4cG9ydHMuY29udmVydFRvVXNlclVSTCA9IGNvbnZlcnRUb1VzZXJVUkw7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvKioKCSogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCgkqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoJKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKCSogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSoKCSogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkqCgkqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkqCgkqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkqKi8KCS8qKgoJICogU3VwcG9ydCBtb2R1bGUgd2l0aCBzb21lIGZ1bmN0aW9ucyB3aWxsIGJlIHVzZWZ1bAoJICogQG1vZHVsZSB1dGlscwoJICovCgoJLyoqCgkgKiBAdHlwZWRlZiBkaXZpZGVVUkwKCSAqIEB0eXBlIE9iamVjdAoJICogQHByb3BlcnR5IHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgVVJMCgkgKiBAcHJvcGVydHkge3N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gb2YgVVJMCgkgKiBAcHJvcGVydHkge3N0cmluZ30gaWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIFVSTAoJICovCgoJLyoqCgkgKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKCSAqIEBwYXJhbSAge1VSTC5VUkx9IHVybCAtIHVybCBhZGRyZXNzCgkgKiBAcmV0dXJuIHtkaXZpZGVVUkx9IHRoZSByZXN1bHQgb2YgZGl2aWRlVVJMCgkgKi8KCWZ1bmN0aW9uIGRpdmlkZVVSTCh1cmwpIHsKCgkgIGlmICghdXJsKSB0aHJvdyBFcnJvcignVVJMIGlzIG5lZWRlZCB0byBzcGxpdCcpOwoKCSAgZnVuY3Rpb24gcmVjdXJzZSh2YWx1ZSkgewoJICAgIHZhciByZWdleCA9IC8oW2EtekEtWi1dKikoOlwvXC8oPzpcLik/fDopKFstYS16QS1aMC05QDolLl9cK34jPV17MiwyNTZ9KShbLWEtekEtWjAtOUA6JS5fXCt+Iz1cL10qKS9naTsKCSAgICB2YXIgc3Vic3QgPSAnJDEsJDMsJDQnOwoJICAgIHZhciBwYXJ0cyA9IHZhbHVlLnJlcGxhY2UocmVnZXgsIHN1YnN0KS5zcGxpdCgnLCcpOwoJICAgIHJldHVybiBwYXJ0czsKCSAgfQoKCSAgdmFyIHBhcnRzID0gcmVjdXJzZSh1cmwpOwoKCSAgLy8gSWYgdGhlIHVybCBoYXMgbm8gc2NoZW1lCgkgIGlmIChwYXJ0c1swXSA9PT0gdXJsICYmICFwYXJ0c1swXS5pbmNsdWRlcygnQCcpKSB7CgoJICAgIHZhciBfcmVzdWx0ID0gewoJICAgICAgdHlwZTogIiIsCgkgICAgICBkb21haW46IHVybCwKCSAgICAgIGlkZW50aXR5OiAiIgoJICAgIH07CgoJICAgIGNvbnNvbGUuZXJyb3IoJ1tEaXZpZGVVUkxdIERpdmlkZVVSTCBkb25cJ3Qgc3VwcG9ydCB1cmwgd2l0aG91dCBzY2hlbWUuIFBsZWFzZSByZXZpZXcgeW91ciB1cmwgYWRkcmVzcycsIHVybCk7CgoJICAgIHJldHVybiBfcmVzdWx0OwoJICB9CgoJICAvLyBjaGVjayBpZiB0aGUgdXJsIGhhcyB0aGUgc2NoZW1lIGFuZCBpbmNsdWRlcyBhbiBACgkgIGlmIChwYXJ0c1swXSA9PT0gdXJsICYmIHBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKCSAgICB2YXIgc2NoZW1lID0gcGFydHNbMF0gPT09IHVybCA/ICdzbXRwJyA6IHBhcnRzWzBdOwoJICAgIHBhcnRzID0gcmVjdXJzZShzY2hlbWUgKyAnOi8vJyArIHBhcnRzWzBdKTsKCSAgfQoKCSAgLy8gaWYgdGhlIGRvbWFpbiBpbmNsdWRlcyBhbiBALCBkaXZpZGUgaXQgdG8gZG9tYWluIGFuZCBpZGVudGl0eSByZXNwZWN0aXZlbHkKCSAgaWYgKHBhcnRzWzFdLmluY2x1ZGVzKCdAJykpIHsKCSAgICBwYXJ0c1syXSA9IHBhcnRzWzBdICsgJzovLycgKyBwYXJ0c1sxXTsKCSAgICBwYXJ0c1sxXSA9IHBhcnRzWzFdLnN1YnN0cihwYXJ0c1sxXS5pbmRleE9mKCdAJykgKyAxKTsKCSAgfSAvKmVsc2UgaWYgKHBhcnRzWzJdLmluY2x1ZGVzKCcvJykpIHsKCSAgICBwYXJ0c1syXSA9IHBhcnRzWzJdLnN1YnN0cihwYXJ0c1syXS5sYXN0SW5kZXhPZignLycpKzEpOwoJICAgIH0qLwoKCSAgdmFyIHJlc3VsdCA9IHsKCSAgICB0eXBlOiBwYXJ0c1swXSwKCSAgICBkb21haW46IHBhcnRzWzFdLAoJICAgIGlkZW50aXR5OiBwYXJ0c1syXQoJICB9OwoKCSAgcmV0dXJuIHJlc3VsdDsKCX0KCglmdW5jdGlvbiBkaXZpZGVFbWFpbChlbWFpbCkgewoJICB2YXIgaW5kZXhPZkF0ID0gZW1haWwuaW5kZXhPZignQCcpOwoKCSAgdmFyIHJlc3VsdCA9IHsKCSAgICB1c2VybmFtZTogZW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCksCgkgICAgZG9tYWluOiBlbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgZW1haWwubGVuZ3RoKQoJICB9OwoKCSAgcmV0dXJuIHJlc3VsdDsKCX0KCgkvKioKCSAqIENoZWNrIGlmIGFuIE9iamVjdCBpcyBlbXB0eQoJICogQHBhcmFtICB7T2JqZWN0fSBvYmplY3QgT2JqZWN0IHRvIGJlIGNoZWNrZWQKCSAqIEByZXR1cm4ge0Jvb2xlYW59ICAgICAgIHN0YXR1cyBvZiBPYmplY3QsIGVtcHR5IG9yIG5vdCAodHJ1ZXxmYWxzZSk7CgkgKi8KCWZ1bmN0aW9uIGVtcHR5T2JqZWN0KG9iamVjdCkgewoJICByZXR1cm4gKDAsIF9rZXlzMi5kZWZhdWx0KShvYmplY3QpLmxlbmd0aCA+IDAgPyBmYWxzZSA6IHRydWU7Cgl9CgoJLyoqCgkgKiBNYWtlIGEgQ09QWSBvZiB0aGUgb3JpZ2luYWwgZGF0YQoJICogQHBhcmFtICB7T2JqZWN0fSAgb2JqIC0gb2JqZWN0IHRvIGJlIGNsb25lZAoJICogQHJldHVybiB7T2JqZWN0fQoJICovCglmdW5jdGlvbiBkZWVwQ2xvbmUob2JqKSB7CgkgIC8vVE9ETzogc2ltcGxlIGJ1dCBpbmVmZmljaWVudCBKU09OIGRlZXAgY2xvbmUuLi4KCSAgaWYgKG9iaikgcmV0dXJuIEpTT04ucGFyc2UoKDAsIF9zdHJpbmdpZnkyLmRlZmF1bHQpKG9iaikpOwoJfQoKCS8qKgoJICogT2J0YWlucyB0aGUgdXNlciBVUkwgdGhhdCBjb3JyZXNwb25kcyB0byBhIGdpdmVuIGVtYWlsCgkgKiBAcGFyYW0gIHtzdHJpbmd9IHVzZXJFbWFpbCBUaGUgdXNlciBlbWFpbAoJICogQHJldHVybiB7VVJMLlVSTH0gdXNlclVSTCBUaGUgdXNlciBVUkwKCSAqLwoJZnVuY3Rpb24gZ2V0VXNlclVSTEZyb21FbWFpbCh1c2VyRW1haWwpIHsKCSAgdmFyIGluZGV4T2ZBdCA9IHVzZXJFbWFpbC5pbmRleE9mKCdAJyk7CgkgIHJldHVybiAndXNlcjovLycgKyB1c2VyRW1haWwuc3Vic3RyaW5nKGluZGV4T2ZBdCArIDEsIHVzZXJFbWFpbC5sZW5ndGgpICsgJy8nICsgdXNlckVtYWlsLnN1YnN0cmluZygwLCBpbmRleE9mQXQpOwoJfQoKCS8qKgoJICogT2J0YWlucyB0aGUgdXNlciBlbWFpbCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEgZ2l2ZW4gVVJMCgkgKiBAcGFyYW0gIHtVUkwuVVJMfSB1c2VyVVJMIFRoZSB1c2VyIFVSTAoJICogQHJldHVybiB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwKCSAqLwoJZnVuY3Rpb24gZ2V0VXNlckVtYWlsRnJvbVVSTCh1c2VyVVJMKSB7CgkgIHZhciB1cmwgPSBkaXZpZGVVUkwodXNlclVSTCk7CgkgIHJldHVybiB1cmwuaWRlbnRpdHkucmVwbGFjZSgnLycsICcnKSArICdAJyArIHVybC5kb21haW47IC8vIGlkZW50aXR5IGZpZWxkIGhhcyAnL2V4YW1wbGVJRCcgaW5zdGVhZCBvZiAnZXhhbXBsZUlEJwoJfQoKCS8qKgoJICogQ2hlY2sgaWYgdGhlIHVzZXIgaWRlbnRpZmllciBpcyBhbHJlYWR5IGluIHRoZSBVUkwgZm9ybWF0LCBpZiBub3QsIGNvbnZlcnQgdG8gVVJMIGZvcm1hdAoJICogQHBhcmFtICB7c3RyaW5nfSAgIGlkZW50aWZpZXIgIHVzZXIgaWRlbnRpZmllcgoJICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMCgkgKi8KCWZ1bmN0aW9uIGNvbnZlcnRUb1VzZXJVUkwoaWRlbnRpZmllcikgewoKCSAgLy8gY2hlY2sgaWYgdGhlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgdXJsIGZvcm1hdAoJICBpZiAoaWRlbnRpZmllci5zdWJzdHJpbmcoMCwgNykgPT09ICd1c2VyOi8vJykgewoJICAgIHZhciBkaXZpZGVkVVJMID0gZGl2aWRlVVJMKGlkZW50aWZpZXIpOwoKCSAgICAvL2NoZWNrIGlmIHRoZSB1cmwgaXMgd2VsbCBmb3JtYXRlZAoJICAgIGlmIChkaXZpZGVkVVJMLmRvbWFpbiAmJiBkaXZpZGVkVVJMLmlkZW50aXR5KSB7CgkgICAgICByZXR1cm4gaWRlbnRpZmllcjsKCSAgICB9IGVsc2UgewoJICAgICAgdGhyb3cgJ3VzZXJVUkwgd2l0aCB3cm9uZyBmb3JtYXQnOwoJICAgIH0KCgkgICAgLy9pZiBub3QsIGNvbnZlcnQgdGhlIHVzZXIgZW1haWwgdG8gVVJMIGZvcm1hdAoJICB9IGVsc2UgewoJICAgIHJldHVybiBnZXRVc2VyVVJMRnJvbUVtYWlsKGlkZW50aWZpZXIpOwoJICB9Cgl9CgoJLyoqKi8gfSksCgkvKiAxMTAgKi8sCgkvKiAxMTEgKi8sCgkvKiAxMTIgKi8sCgkvKiAxMTMgKi8sCgkvKiAxMTQgKi8sCgkvKiAxMTUgKi8sCgkvKiAxMTYgKi8sCgkvKiAxMTcgKi8sCgkvKiAxMTggKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCgkvLyAgICAgcHJveHktb2JzZXJ2ZSB2MC4wLjE4DQoJLy8gICAgIENvcHlyaWdodCAoYykgMjAxNSwgMjAxNiBTaW1vbiBZLiBCbGFja3dlbGwsIEFueVdoaWNoV2F5DQoJLy8gICAgIE1JVCBMaWNlbnNlIC0gaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocA0KCShmdW5jdGlvbigpIHsNCgkJInVzZSBzdHJpY3QiOw0KCQkvLyBDcmVhdGVzIGFuZCByZXR1cm5zIGEgUHJveHkgd3JhcHBpbmcgYSB0YXJnZXQgc28gdGhhdCBhbGwgY2hhbmdlcyBjYW4gYmUgdHJhcHBlZCBhbmQgZm9yd2FyZGVkIHRvDQoJCS8vIGEgY2FsbGJhY2suIFRoZSBjYWxsYmFjayB0YWtlcyBhbiBhcnJheSBvZiBjaGFuZ2VzIGp1c3QgbGlrZSB0aGUgdHJhZGl0aW9uYWwgb3JpZ2luYWwgQ2hyb21lIE9iamVjdC5vYnNlcnZlDQoJCS8vIHtvYmplY3Q6PG9iamVjdCBjaGFuZ2VkPixuYW1lOjxmaWVsZCBjaGFuZ2VkPix0eXBlOmFkZHx1cGRhdGV8ZGVsZXRlfHJlY29uZmlndXJlfHByZXZlbnRFeHRlbnNpb25zfHNldFByb3RvdHlwZSxvbGRWYWx1ZTo8b2xkIHZhbHVlIGlmIHVwZGF0ZSB8IGRlbGV0ZT59DQoJCS8vIFRoZSBhY2NlcHRsaXN0IGNhbiBiZSBhZGR8dXBkYXRlfGRlbGV0ZXxyZWNvbmZpZ3VyZXxwcmV2ZW50RXh0ZW5zaW9uc3xzZXRQcm90b3R5cGUuDQoJCS8vIHYgMC4wLjEwIHRvIHN1cHBvcnQgcGF1c2luZyBhbmQgcmVzdGFydGluZyBvYnNlcnZhdGlvbiB0d28gYWRkaXRpb25hbCBjb25zdHJ1Y3RvciBhcmd1bWVudHMgYXJlIGF2YWlsYWJsZSB0byBPYmplY3Qub2JzZXJ2ZToNCgkJLy8gcGF1c2FibGUgLSBjcmVhdGUgdGhlIE9ic2VydmVyIHNvIGl0IGNhbiBiZSBwYXVzZWQNCgkJLy8gcGF1c2UgLSBjcmVhdGUgb2JzZXJ2ZXIgaW4gcGF1c2VkIHN0YXRlDQoJCS8vIGlmIHBhdXNhYmxlIGlzIHRydWUgdGhlbiBhbiBhZGRpdGlvbmFsIG1ldGhvZCBkZWxpdmVyKGlnbm9yZVByZXZpb3VzKSBpcyBhdmFpbGFibGUgdG8gc3RhcnQgZGVsaXZlcnkNCgkJLy8gdG8gcGF1c2UgZGVsaXZlcnkgc2V0IGEgcHJvcGVydHkgY2FsbGVkIHBhdXNlIG9uIHRoZSBmdW5jdGlvbiBkZWxpdmVyIHRvIHRydWUNCgkJLy8gcGF1c2FibGUgaXMgb3B0aW9uYWwgdG8gcmVkdWNlIHRoZSBjaGFuY2Ugb2Ygc2hhZG93aW5nIGEgcHJvcGVydHkgb3IgbWV0aG9kIG9uIGFueSBleGlzdGluZyBjb2RlIGNhbGxlZCBkZWxpdmVyDQoJCWlmKCFPYmplY3Qub2JzZXJ2ZSAmJiB0eXBlb2YoUHJveHkpPT09ImZ1bmN0aW9uIikgew0KCQkJZnVuY3Rpb24gT2JzZXJ2ZXIodGFyZ2V0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsNCgkJICAgIAl2YXIgbWUgPSB0aGlzLCBwcm94eTsNCgkJICAgIAlmdW5jdGlvbiBkZWxpdmVyKGlnbm9yZVByZXZpb3VzLGRlbGF5KSB7DQoJCSAgICAJCWRlbGl2ZXIuZGVsYXkgPSBkZWxheTsNCgkJICAgIAkJaWYoIWRlbGl2ZXIucGF1c2UpIHsNCgkJICAgICAgICAJCWlmKG1lLmNoYW5nZXNldC5sZW5ndGg+MCkgew0KCQkgICAgICAgIAkJCWlmKCFpZ25vcmVQcmV2aW91cykgew0KCQkJICAgIAkgICAgCQl2YXIgY2hhbmdlcyA9IG1lLmNoYW5nZXNldC5maWx0ZXIoZnVuY3Rpb24oY2hhbmdlKSB7IHJldHVybiAhYWNjZXB0bGlzdCB8fCBhY2NlcHRsaXN0LmluZGV4T2YoY2hhbmdlLnR5cGUpPj0wOyB9KTsNCgkJCSAgICAgICAgCQkJaWYoY2hhbmdlcy5sZW5ndGg+MCkgew0KCQkJICAgICAgICAJCQkJY2FsbGJhY2soY2hhbmdlcyk7DQoJCQkgICAgICAgIAkJCX0NCgkJICAgICAgICAJCQl9DQoJCSAgICAgICAgCQkJbWUuY2hhbmdlc2V0ID0gW107DQoJCSAgICAgICAgCQl9DQoJCSAgICAJCX0NCgkJICAgIAl9DQoJCSAgICAJZGVsaXZlci5wYXVzZSA9IHBhdXNlOw0KCQkgICAgCWRlbGl2ZXIuZGVsYXkgPSBkZWxheTsNCgkJCSAgICBtZS5nZXQgPSBmdW5jdGlvbih0YXJnZXQsIHByb3BlcnR5KSB7DQoJCQkgICAgCWlmKHByb3BlcnR5PT09Il9fb2JzZXJ2ZXJfXyIpIHsNCgkJCSAgICAJCXJldHVybiBtZTsNCgkJCSAgICAJfQ0KCQkJICAgIAlpZihwcm9wZXJ0eT09PSJ1bm9ic2VydmUiKSB7DQoJCQkgICAgCQlyZXR1cm4gZnVuY3Rpb24oKSB7DQoJCQkgICAgCQkJT2JqZWN0LnVub2JzZXJ2ZSh0YXJnZXQpOw0KCQkJICAgIAkJCXJldHVybiB0YXJnZXQ7DQoJCQkgICAgCQl9Ow0KCQkJICAgIAl9DQoJCQkgICAgCWlmKHByb3BlcnR5PT09ImRlbGl2ZXIiKSB7DQoJCQkgICAgCQlyZXR1cm4gZGVsaXZlcjsNCgkJCSAgICAJfQ0KCQkJICAgIAlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsNCgkJCSAgICB9DQoJCSAgICAJbWUudGFyZ2V0ID0gdGFyZ2V0Ow0KCQkgICAgCW1lLmNoYW5nZXNldCA9IFtdOw0KCQkgICAgCWlmKCFtZS50YXJnZXQuX19vYnNlcnZlckNhbGxiYWNrc19fKSB7DQoJCSAgICAJCS8vIF9fb2JzZXJ2ZXJDYWxsYmFja3NfXyBpcyB1c2VkIGFzIGFuIGluZGV4IHRvIGdldCBhdCB0aGUgcHJveHkgd2hpY2ggaXMgdGhlIG9ic2VydmVyLCBzbyB3ZSBjYW4gdW5vYnNlcnZlDQoJCSAgICAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIl9fb2JzZXJ2ZXJDYWxsYmFja3NfXyIse2VudW1lcmFibGU6ZmFsc2UsY29uZmlndXJhYmxlOnRydWUsd3JpdGFibGU6ZmFsc2UsdmFsdWU6W119KTsNCgkJICAgIAkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwiX19vYnNlcnZlcnNfXyIse2VudW1lcmFibGU6ZmFsc2UsY29uZmlndXJhYmxlOnRydWUsd3JpdGFibGU6ZmFsc2UsdmFsdWU6W119KTsNCgkJICAgIAl9DQoJCSAgICAJbWUudGFyZ2V0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5wdXNoKGNhbGxiYWNrKTsNCgkJICAgIAltZS50YXJnZXQuX19vYnNlcnZlcnNfXy5wdXNoKHRoaXMpOw0KCQkgICAgCXByb3h5ID0gbmV3IFByb3h5KHRhcmdldCxtZSk7DQoJCSAgICAJZGVsaXZlcihmYWxzZSxkZWxheSk7DQoJCSAgICAJcmV0dXJuIHByb3h5Ow0KCQkgICAgfQ0KCQkJT2JzZXJ2ZXIucHJvdG90eXBlLmRlbGl2ZXIgPSBmdW5jdGlvbigpIHsNCgkJCQlyZXR1cm4gdGhpcy5nZXQobnVsbCwiZGVsaXZlciIpOw0KCQkJfQ0KCQkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHksIHZhbHVlKSB7IC8vICwgcmVjZWl2ZXINCgkJICAgIAl2YXIgb2xkdmFsdWUgPSB0YXJnZXRbcHJvcGVydHldOw0KCQkgICAgCXZhciB0eXBlID0gKG9sZHZhbHVlPT09dW5kZWZpbmVkID8gImFkZCIgOiAidXBkYXRlIik7DQoJCSAgICAJdGFyZ2V0W3Byb3BlcnR5XSA9IHZhbHVlOw0KCQkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgKCF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YodHlwZSk+PTApKSB7DQoJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6dHlwZX0sDQoJCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkJICAgICAgICAJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsNCgkJICAgICAgICAJaWYodHlwZT09PSJ1cGRhdGUiKSB7DQoJCSAgICAgICAgCQljaGFuZ2Uub2xkVmFsdWUgPSBvbGR2YWx1ZTsNCgkJICAgICAgICAJfQ0KCQkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7DQoJCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOw0KCQkgICAgICAgIAl9DQoJCSAgICAJfQ0KCQkgICAgCXJldHVybiB0cnVlOw0KCQkgICAgfTsNCgkJICAgIE9ic2VydmVyLnByb3RvdHlwZS5kZWxldGVQcm9wZXJ0eSA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsNCgkJICAgIAl2YXIgb2xkdmFsdWUgPSB0YXJnZXRbcHJvcGVydHldOw0KCQkgICAgCS8vaWYodHlwZW9mKG9sZHZhbHVlKSE9PSJ1bmRlZmluZWQiKSB7DQoJCQkgICAgCWRlbGV0ZSB0YXJnZXRbcHJvcGVydHldOw0KCQkJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoImRlbGV0ZSIpPj0wKSB7DQoJCQkgICAgICAgIAl2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsbmFtZTpwcm9wZXJ0eSx0eXBlOiJkZWxldGUiLG9sZFZhbHVlOm9sZHZhbHVlfSwNCgkJCSAgICAgICAgCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkJCSAgICAgICAgCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7DQoJCQkgICAgICAgIAl0aGlzLmNoYW5nZXNldC5wdXNoKGNoYW5nZSk7DQoJCQkgICAgICAgIAlpZihzdGFydCkgew0KCQkJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJCQkgICAgICAgIAl9DQoJCQkgICAgCX0NCgkJICAgIAkvL30NCgkJICAgIAlyZXR1cm4gdHJ1ZTsNCgkJICAgIH07DQoJCSAgICBPYnNlcnZlci5wcm90b3R5cGUuZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbih0YXJnZXQsIHByb3BlcnR5LCBkZXNjcmlwdG9yKSB7DQoJCSAgICAJT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgcHJvcGVydHksIGRlc2NyaXB0b3IpOw0KCQkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigicmVjb25maWd1cmUiKT49MCkgew0KCQkgICAgICAgIAl2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsbmFtZTpwcm9wZXJ0eSx0eXBlOiJyZWNvbmZpZ3VyZSJ9LA0KCSAgICAgICAgCQkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsDQoJICAgICAgICAJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7DQoJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsNCgkJICAgICAgICAJaWYoc3RhcnQpIHsNCgkJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJCSAgICAgICAgCX0NCgkJICAgIAl9DQoJCSAgICAJcmV0dXJuIHRydWU7DQoJCSAgICB9Ow0KCQkgICAgT2JzZXJ2ZXIucHJvdG90eXBlLnNldFByb3RvdHlwZU9mID0gZnVuY3Rpb24odGFyZ2V0LCBwcm90b3R5cGUpIHsNCgkJICAgIAl2YXIgb2xkdmFsdWUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KTsNCgkJICAgIAlPYmplY3Quc2V0UHJvdG90eXBlT2YodGFyZ2V0LCBwcm90b3R5cGUpOw0KCQkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgIXRoaXMuYWNjZXB0bGlzdCB8fCB0aGlzLmFjY2VwdGxpc3QuaW5kZXhPZigic2V0UHJvdG90eXBlIik+PTApIHsNCgkJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6Il9fcHJvdG9fXyIsdHlwZToic2V0UHJvdG90eXBlIixvbGRWYWx1ZTpvbGR2YWx1ZX0sDQoJICAgIAkJCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkgICAgCQkJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsNCgkJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCQkgICAgICAgIAlpZihzdGFydCkgew0KCQkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkJICAgICAgICAJfQ0KCQkgICAgCX0NCgkJICAgIAlyZXR1cm4gdHJ1ZTsNCgkJICAgIH07DQoJCSAgICBPYnNlcnZlci5wcm90b3R5cGUucHJldmVudEV4dGVuc2lvbnMgPSBmdW5jdGlvbih0YXJnZXQpIHsNCgkJICAgICAgICBPYmplY3QucHJldmVudEV4dGVuc2lvbnModGFyZ2V0KTsNCgkJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInByZXZlbnRFeHRlbnNpb25zIik+PTApIHsNCgkJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LHR5cGU6InByZXZlbnRFeHRlbnNpb25zIn0sDQoJCQkJCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkJCQkJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsNCgkJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCQkgICAgICAgIAlpZihzdGFydCkgew0KCQkgICAgICAgIAkJZGVsaXZlcihmYWxzZSwodHlwZW9mKGRlbGl2ZXIuZGVsYXkpPT09Im51bWJlciIgPyBkZWxpdmVyLmRlbGF5IDogMTApKTsNCgkJICAgICAgICAJfQ0KCQkgICAgCX0NCgkJICAgIAlyZXR1cm4gdHJ1ZTsNCgkJICAgIH07DQoJCSAgICBPYmplY3Qub2JzZXJ2ZSA9IGZ1bmN0aW9uKG9iamVjdCxjYWxsYmFjayxhY2NlcHRsaXN0LHBhdXNhYmxlLHBhdXNlLGRlbGF5KSB7DQoJCSAgICAJcmV0dXJuIG5ldyBPYnNlcnZlcihvYmplY3QsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSk7DQoJCSAgICB9Ow0KCQkgICAgT2JqZWN0LnVub2JzZXJ2ZSA9IGZ1bmN0aW9uKG9iamVjdCxjYWxsYmFjaykgew0KCQkgICAgCWlmKG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18pIHsNCgkJICAgIAkJaWYoIWNhbGxiYWNrKSB7DQoJCSAgICAJCQlvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLnNwbGljZSgwLG9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18ubGVuZ3RoKTsNCgkJICAgIAkJCW9iamVjdC5fX29ic2VydmVyc19fLnNwbGljZSgwLG9iamVjdC5fX29ic2VydmVyc19fLmxlbmd0aCk7DQoJCSAgICAJCQlyZXR1cm47DQoJCSAgICAJCX0NCgkJICAgIAkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5mb3JFYWNoKGZ1bmN0aW9uKG9ic2VydmVyY2FsbGJhY2ssaSkgew0KCQkgICAgCQkJaWYoY2FsbGJhY2s9PT1vYnNlcnZlcmNhbGxiYWNrKSB7DQoJCSAgICAJCQkJb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5zcGxpY2UoaSwxKTsNCgkJICAgIAkJCQlkZWxldGUgb2JqZWN0Ll9fb2JzZXJ2ZXJzX19baV0uY2FsbGJhY2s7DQoJCSAgICAJCQkJb2JqZWN0Ll9fb2JzZXJ2ZXJzX18uc3BsaWNlKGksMSk7DQoJCSAgICAJCQl9DQoJCSAgICAJCX0pOw0KCQkgICAgCX0NCgkJICAgIH07DQoJCSAgICBBcnJheS5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsNCgkJICAgIAlpZighKG9iamVjdCBpbnN0YW5jZW9mIEFycmF5KSAmJiAhQXJyYXkuaXNBcnJheShvYmplY3QpKSB7DQoJCSAgICAJCXRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IGFyZ3VtZW50IHRvIEFycmF5Lm9ic2VydmVyIGlzIG5vdCBhbiBBcnJheSIpOw0KCQkgICAgCX0NCgkgICAgICAgICAgICAJYWNjZXB0bGlzdCA9IGFjY2VwdGxpc3QgfHwgWyJhZGQiLCAidXBkYXRlIiwgImRlbGV0ZSIsICJzcGxpY2UiXTsNCgkJICAgIAl2YXIgYXJyYXlwcm94eSA9IG5ldyBQcm94eShvYmplY3Qse2dldDogZnVuY3Rpb24odGFyZ2V0LHByb3BlcnR5KSB7DQoJCSAgICAJCWlmKHByb3BlcnR5PT09InVub2JzZXJ2ZSIpIHsNCgkJCSAgICAJCXJldHVybiBmdW5jdGlvbihjYWxsYmFjaykgew0KCQkJICAgIAkJCWlmKGNhbGxiYWNrKSB7DQoJCQkgICAgCQkJCXJldHVybiBPYmplY3QudW5vYnNlcnZlKHRhcmdldCxjYWxsYmFjayk7DQoJCQkgICAgCQkJfQ0KCQkJICAgIAkJCXJldHVybiB0YXJnZXQudW5vYnNlcnZlKCk7DQoJCQkgICAgCQl9Ow0KCQkJICAgIAl9DQoJCSAgICAJCWlmKHByb3BlcnR5PT09InNwbGljZSIpIHsNCgkJICAgIAkJCXJldHVybiBmdW5jdGlvbihzdGFydCxlbmQpIHsNCgkJICAgIAkJCQlpZih0eXBlb2Yoc3RhcnQpIT09Im51bWJlciIgfHwgdHlwZW9mKGVuZCkhPT0ibnVtYmVyIikgew0KCQkgICAgCQkJCQl0aHJvdyBuZXcgVHlwZUVycm9yKCJGaXJzdCB0d28gYXJndW1lbnRzIHRvIEFycmF5IHNwbGljZSBhcmUgbm90IG51bWJlciwgbnVtYmVyIik7DQoJCSAgICAJCQkJfQ0KCQkgICAgCSAgICAJCXZhciByZW1vdmVkID0gdGhpcy5zbGljZShzdGFydCxzdGFydCtlbmQpLA0KCQkgICAgCSAgICAJCQlhZGRlZENvdW50ID0gKGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzLmxlbmd0aC0yIDogMCksDQoJCSAgICAJICAgIAkJCWNoYW5nZSA9ICB7b2JqZWN0Om9iamVjdCx0eXBlOiJzcGxpY2UiLGluZGV4OnN0YXJ0LHJlbW92ZWQ6cmVtb3ZlZCxhZGRlZENvdW50OmFkZGVkQ291bnR9Ow0KCQkgICAgCSAgICAJCXRhcmdldC5zcGxpY2UuYXBwbHkodGFyZ2V0LGFyZ3VtZW50cyk7DQoJCSAgICAJICAgIAkJaWYoYWNjZXB0bGlzdC5pbmRleE9mKCJzcGxpY2UiKT49MCkgew0KCQkgICAgCSAgICAJCQl2YXIgc3RhcnQgPSBwcm94eS5fX29ic2VydmVyX18uY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCgkJICAgIAkgICAgICAgIAkJCWRlbGl2ZXIgPSBwcm94eS5fX29ic2VydmVyX18uZGVsaXZlcigpOw0KCQkgICAgCSAgICAJCQlwcm94eS5fX29ic2VydmVyX18uY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsNCgkJICAgIAkgICAgCQkJaWYoc3RhcnQpIHsNCgkJICAgIAkJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJCSAgICAJCSAgICAgICAgCX0NCgkJICAgIAkgICAgCQl9DQoJCSAgICAJICAgIAl9DQoJCSAgICAJCX0NCgkJICAgIAkJaWYocHJvcGVydHk9PT0icHVzaCIpIHsNCgkJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oaXRlbSkgew0KCQkgICAgCQkgICAgCXJldHVybiB0aGlzLnNwbGljZSh0aGlzLmxlbmd0aCwwLGl0ZW0pOw0KCQkgICAgCQkgICAgfQ0KCQkgICAgCQl9DQoJCSAgICAJCWlmKHByb3BlcnR5PT09InBvcCIpIHsNCgkJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oKSB7DQoJCSAgICAJCSAgICAJcmV0dXJuIHRoaXMuc3BsaWNlKHRoaXMubGVuZ3RoLTEsMSk7DQoJCSAgICAJCSAgICB9DQoJCSAgICAJCX0NCgkJICAgIAkJaWYocHJvcGVydHk9PT0idW5zaGlmdCIpIHsNCgkJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oaXRlbSkgew0KCSAgICAJCSAgICAJCXJldHVybiB0aGlzLnNwbGljZSgwLDAsaXRlbSk7DQoJICAgIAkJICAgIAl9DQoJCSAgICAJCX0NCgkJICAgIAkJaWYocHJvcGVydHk9PT0ic2hpZnQiKSB7DQoJCSAgICAJCQlyZXR1cm4gZnVuY3Rpb24oKSB7DQoJCSAgICAJICAgIAkJcmV0dXJuIHRoaXMuc3BsaWNlKDAsMSk7DQoJCSAgICAJICAgIAl9DQoJCSAgICAJCX0NCgkJICAgIAkJcmV0dXJuIHRhcmdldFtwcm9wZXJ0eV07DQoJCSAgICAJfX0pOw0KCQkgICAgCXZhciBwcm94eSA9IE9iamVjdC5vYnNlcnZlKGFycmF5cHJveHksZnVuY3Rpb24oY2hhbmdlc2V0KSB7IA0KCQkgICAgCQl2YXIgY2hhbmdlcyA9IGNoYW5nZXNldC5maWx0ZXIoZnVuY3Rpb24oY2hhbmdlKSB7IHJldHVybiBjaGFuZ2UubmFtZSE9PSJsZW5ndGgiICYmIGNoYW5nZS5uYW1lIT09ImFkZCIgJiYgKCFhY2NlcHRsaXN0IHx8IGFjY2VwdGxpc3QuaW5kZXhPZihjaGFuZ2UudHlwZSk+PTApOyB9KTsNCgkJICAgIAkJaWYoY2hhbmdlcy5sZW5ndGg+MCkgew0KCQkgICAgCQkJY2FsbGJhY2soY2hhbmdlcyk7DQoJCSAgICAJCX0NCgkJICAgIAl9LGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpOw0KCQkgICAgCXJldHVybiBwcm94eTsNCgkJICAgIH07DQoJCSAgICBBcnJheS51bm9ic2VydmUgPSBmdW5jdGlvbihvYmplY3QsY2FsbGJhY2spIHsNCgkJCSAgcmV0dXJuIG9iamVjdC51bm9ic2VydmUoY2FsbGJhY2spOw0KCQkgICAgfQ0KCQl9DQoJCU9iamVjdC5kZWVwT2JzZXJ2ZSA9IGZ1bmN0aW9uKG9iamVjdCxjYWxsYmFjayxwYXJ0cykgew0KDQoJCQlwYXJ0cyA9IChwYXJ0cyA/IHBhcnRzIDogW10pOw0KDQoJCQl2YXIgdG9UeXBlTmFtZSA9IGZ1bmN0aW9uKG9iaikgew0KCQkJCXJldHVybiAoe30pLnRvU3RyaW5nLmNhbGwob2JqKS5tYXRjaCgvXHMoW2EtekEtWl0rKS8pWzFdLnRvTG93ZXJDYXNlKCkNCgkJCX0NCg0KCQkJZnVuY3Rpb24gcmVvYnNlcnZlKHZhbHVlLCBwYXJ0cykgew0KCQkJCXZhciBrZXlzID0gT2JqZWN0LmtleXModmFsdWUpOw0KCQkJCWtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsNCgkJCQkJaWYoKHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdvYmplY3QnIHx8IHRvVHlwZU5hbWUodmFsdWVba2V5XSkgPT09ICdhcnJheScpICYmICF2YWx1ZVtrZXldLmhhc093blByb3BlcnR5KCdfX29ic2VydmVyc19fJykpIHsNCgkJCQkJCXZhciBuZXdwYXJ0cyA9IHBhcnRzLnNsaWNlKDApOw0KCQkJCQkJbmV3cGFydHMucHVzaChrZXkpOw0KCQkJCQkJdmFsdWVba2V5XSA9IE9iamVjdC5kZWVwT2JzZXJ2ZSh2YWx1ZVtrZXldLGNhbGxiYWNrLG5ld3BhcnRzKTsNCgkJCQkJfQ0KCQkJCX0pOw0KCQkJfQ0KDQoJCQlyZW9ic2VydmUob2JqZWN0LCBwYXJ0cyk7DQoNCgkJCXZhciBvYnNlcnZlZCA9IE9iamVjdC5vYnNlcnZlKG9iamVjdCxmdW5jdGlvbihjaGFuZ2VzZXQpIHsNCgkJCQl2YXIgY2hhbmdlcyA9IFtdOw0KCQkJCWZ1bmN0aW9uIHJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZE9iamVjdCxuZXdPYmplY3QscGF0aCkgew0KCQkJCQlpZihuZXdPYmplY3QgaW5zdGFuY2VvZiBPYmplY3QpIHsNCgkJCQkJCXZhciBuZXdrZXlzID0gT2JqZWN0LmtleXMobmV3T2JqZWN0KTsNCgkJCQkJCW5ld2tleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsNCgkJCQkJCQlpZighb2xkT2JqZWN0IHx8IChvbGRPYmplY3Rba2V5XSE9PW5ld09iamVjdFtrZXldKSkgew0KCQkJCQkJCQl2YXIgb2xkdmFsdWUgPSAob2xkT2JqZWN0ICYmIG9sZE9iamVjdFtrZXldIT09dW5kZWZpbmVkID8gb2xkT2JqZWN0W2tleV0gOiB1bmRlZmluZWQpLA0KCQkJCQkJCQkJY2hhbmdlID0gKG9sZHZhbHVlPT09dW5kZWZpbmVkID8gImFkZCIgOiAidXBkYXRlIiksDQoJCQkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsNCg0KCQkJCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6bmFtZSxvYmplY3Q6cm9vdE9iamVjdCx0eXBlOmNoYW5nZSxvbGRWYWx1ZTpvbGR2YWx1ZSxuZXdWYWx1ZTpuZXdPYmplY3Rba2V5XSxrZXlwYXRoOmtleXBhdGh9KTsNCgkJCQkJCQkJcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkdmFsdWUsbmV3T2JqZWN0W2tleV0sa2V5cGF0aCk7DQoJCQkJCQkJfQ0KCQkJCQkJfSk7DQoJCQkJCX0gZWxzZSBpZihvbGRPYmplY3QgaW5zdGFuY2VvZiBPYmplY3QpIHsNCgkJCQkJCXZhciBvbGRrZXlzID0gT2JqZWN0LmtleXMob2xkT2JqZWN0KTsNCgkJCQkJCW9sZGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsNCgkJCQkJCQl2YXIgY2hhbmdlID0gKG5ld09iamVjdD09PW51bGwgPyAidXBkYXRlIiA6ICJkZWxldGUiKSwNCgkJCQkJCQkJa2V5cGF0aCA9IHBhdGggKyAiLiIgKyBrZXk7DQoJCQkJCQkJCQ0KCQkJCQkJCWNoYW5nZXMucHVzaCh7bmFtZTpuYW1lLG9iamVjdDpyb290T2JqZWN0LHR5cGU6Y2hhbmdlLG9sZFZhbHVlOm9sZE9iamVjdFtrZXldLG5ld1ZhbHVlOm5ld09iamVjdCxrZXlwYXRoOmtleXBhdGh9KTsNCgkJCQkJCQlyZWN1cnNlKG5hbWUscm9vdE9iamVjdCxvbGRPYmplY3Rba2V5XSx1bmRlZmluZWQsa2V5cGF0aCk7DQoJCQkJCQl9KTsNCgkJCQkJfQ0KCQkJCX0NCgkJCQljaGFuZ2VzZXQuZm9yRWFjaChmdW5jdGlvbihjaGFuZ2UpIHsNCgkJCQkJdmFyIGtleXBhdGggPSAocGFydHMubGVuZ3RoPjAgPyBwYXJ0cy5qb2luKCIuIikgKyAiLiIgOiAiIikgKyBjaGFuZ2UubmFtZTsNCg0KCQkJCQlpZiAoY2hhbmdlLnR5cGUgPT09ICJ1cGRhdGUiIHx8IGNoYW5nZS50eXBlID09PSAiYWRkIikgeyANCgkJCQkJCXJlb2JzZXJ2ZShjaGFuZ2Uub2JqZWN0LCBwYXJ0cyk7DQoJCQkJCX0NCg0KCQkJCQljaGFuZ2VzLnB1c2goe25hbWU6Y2hhbmdlLm5hbWUsb2JqZWN0OmNoYW5nZS5vYmplY3QsdHlwZTpjaGFuZ2UudHlwZSxvbGRWYWx1ZTpjaGFuZ2Uub2xkVmFsdWUsbmV3VmFsdWU6Y2hhbmdlLm9iamVjdFtjaGFuZ2UubmFtZV0sa2V5cGF0aDprZXlwYXRofSk7DQoJCQkJCXJlY3Vyc2UoY2hhbmdlLm5hbWUsY2hhbmdlLm9iamVjdCxjaGFuZ2Uub2xkVmFsdWUsY2hhbmdlLm9iamVjdFtjaGFuZ2UubmFtZV0sa2V5cGF0aCk7DQoJCQkJfSk7DQoJCQkJY2FsbGJhY2soY2hhbmdlcyk7DQoJCQl9KTsNCgkJCXJldHVybiBvYnNlcnZlZDsNCgkJfTsNCgl9KSgpOw0KCgoJLyoqKi8gfSksCgkvKiAxMTkgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKCXZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCgl2YXIgX2dldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMSk7CgoJdmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKCXZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCgl2YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNSk7CgoJdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yKTsKCgl2YXIgX2dldDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyNCk7CgoJdmFyIF9nZXQzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0Mik7CgoJdmFyIF9pbmhlcml0czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKCgl2YXIgX2luaGVyaXRzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2luaGVyaXRzMik7CgoJdmFyIF9EYXRhT2JqZWN0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTIxKTsKCgl2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKCXZhciBfRGF0YU9iamVjdENoaWxkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKCXZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvKioKCSogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCgkqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoJKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKCSogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSoKCSogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkqCgkqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkqCgkqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkqKi8KCgl2YXIgRmlsdGVyVHlwZSA9IHsgQU5ZOiAnYW55JywgU1RBUlQ6ICdzdGFydCcsIEVYQUNUOiAnZXhhY3QnIH07CgoJLyoqCgkgKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBzdWJzY3JpYmUgY2FsbC4KCSAqIFRvIGJlIHVzZWQgYXMgYW4gb2JzZXJ2YXRpb24gcG9pbnQgZnJvbSBhIERhdGFPYmplY3RSZXBvcnRlciBjaGFuZ2UuCgkgKi8KCgl2YXIgRGF0YU9iamVjdE9ic2VydmVyID0gZnVuY3Rpb24gKF9EYXRhT2JqZWN0KSB7CgkgICgwLCBfaW5oZXJpdHMzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlciwgX0RhdGFPYmplY3QpOwoKCSAgLyogcHJpdmF0ZQoJICBfY2hhbmdlTGlzdGVuZXI6IE1zZ0xpc3RlbmVyCgkgICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCgkgIF9maWx0ZXJzOiB7PGZpbHRlcj46IHt0eXBlOiA8c3RhcnQsIGV4YWN0PiwgY2FsbGJhY2s6IDxmdW5jdGlvbj59IH0KCSAgKi8KCgkgIC8qKgoJICAgKiBAaWdub3JlCgkgICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyLnN1YnNjcmliZSBtZXRob2QKCSAgICovCgoJICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CgkgIGZ1bmN0aW9uIERhdGFPYmplY3RPYnNlcnZlcihzeW5jaGVyLCB1cmwsIHNjaGVtYSwgaW5pdGlhbFN0YXR1cywgaW5pdGlhbERhdGEsIGNoaWxkcmVucywgaW5pdGlhbFZlcnNpb24sIG11dHVhbCkgewoJICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3RPYnNlcnZlcik7CgoJICAgIHZhciBfdGhpczIgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4zLmRlZmF1bHQpKHRoaXMsIChEYXRhT2JqZWN0T2JzZXJ2ZXIuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlcikpLmNhbGwodGhpcywgc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLmRhdGEsIGNoaWxkcmVucywgbXV0dWFsKSk7CgoJICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCgkgICAgX3RoaXMuX3ZlcnNpb24gPSBpbml0aWFsVmVyc2lvbjsKCSAgICBfdGhpcy5fZmlsdGVycyA9IHt9OwoKCSAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewoJICAgICAgX3RoaXMuX29uRmlsdGVyKGV2ZW50KTsKCSAgICB9KTsKCgkgICAgLy9zZXR1cCBjaGlsZHJlbnMgZGF0YSBmcm9tIHN1YnNjcmlwdGlvbgoJICAgICgwLCBfa2V5czIuZGVmYXVsdCkoaW5pdGlhbERhdGEuY2hpbGRyZW5zKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CgkgICAgICB2YXIgY2hpbGREYXRhID0gaW5pdGlhbERhdGEuY2hpbGRyZW5zW2NoaWxkSWRdOwoJICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXSA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBjaGlsZElkLCBjaGlsZERhdGEpOwoJICAgIH0pOwoKCSAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKCSAgICByZXR1cm4gX3RoaXMyOwoJICB9CgoJICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIsIFt7CgkgICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewoJICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUpLCAnX2FsbG9jYXRlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsICsgJy9jaGFuZ2VzJywgZnVuY3Rpb24gKG1zZykgewoJICAgICAgICBpZiAobXNnLnR5cGUgPT09ICd1cGRhdGUnKSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RPYnNlcnZlci0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwoJICAgICAgICAgIF90aGlzLl9jaGFuZ2VPYmplY3QoX3RoaXMuX3N5bmNPYmosIG1zZyk7CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CgkgICAgICAoMCwgX2dldDMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZSksICdfcmVsZWFzZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lci5yZW1vdmUoKTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ2RlbGV0ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgkgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX29ic2VydmVyc1tfdGhpcy5fdXJsXTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3Vuc3Vic2NyaWJlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uTG9jYWxVblN1YnNjcmliZQoJICAgICAgdmFyIHVuU3Vic2NyaWJlTXNnID0gewoJICAgICAgICB0eXBlOiAndW5zdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAoJICAgICAgICBib2R5OiB7IHJlc291cmNlOiBfdGhpcy5fdXJsIH0KCSAgICAgIH07CgoJICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh1blN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0T2JzZXJ2ZXItVU5TVUJTQ1JJQkU6ICcsIHJlcGx5KTsKCSAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CgkgICAgICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCSAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX29ic2VydmVyc1tfdGhpcy5fdXJsXTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBSZWdpc3RlciB0aGUgY2hhbmdlIGxpc3RlbmVycyBzZW50IGJ5IHRoZSByZXBvcnRlcgoJICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWx0ZXIgLSBGaWx0ZXIgdGhhdCBpZGVudGlmaWVzIHRoZSBmaWVsZCAoc2VwYXJhdGVkIGRvdCBwYXRoKS4gQWNjZXB0cyAqIGF0IHRoZSBlbmQgZm9yIGEgbW9yZSB1bnJlc3RyaWN0ZWQgZmlsdGVyaW5nLgoJICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvbkNoYW5nZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlKGZpbHRlciwgY2FsbGJhY2spIHsKCSAgICAgIHZhciBrZXkgPSBmaWx0ZXI7CgkgICAgICB2YXIgZmlsdGVyT2JqID0gewoJICAgICAgICB0eXBlOiBGaWx0ZXJUeXBlLkVYQUNULAoJICAgICAgICBjYWxsYmFjazogY2FsbGJhY2sKCSAgICAgIH07CgoJICAgICAgdmFyIGlkeCA9IGZpbHRlci5pbmRleE9mKCcqJyk7CgkgICAgICBpZiAoaWR4ID09PSBmaWx0ZXIubGVuZ3RoIC0gMSkgewoJICAgICAgICBpZiAoaWR4ID09PSAwKSB7CgkgICAgICAgICAgZmlsdGVyT2JqLnR5cGUgPSBGaWx0ZXJUeXBlLkFOWTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICBmaWx0ZXJPYmoudHlwZSA9IEZpbHRlclR5cGUuU1RBUlQ7CgkgICAgICAgICAga2V5ID0gZmlsdGVyLnN1YnN0cigwLCBmaWx0ZXIubGVuZ3RoIC0gMSk7CgkgICAgICAgIH0KCSAgICAgIH0KCgkgICAgICB0aGlzLl9maWx0ZXJzW2tleV0gPSBmaWx0ZXJPYmo7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX29uRmlsdGVyJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uRmlsdGVyKGV2ZW50KSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgICgwLCBfa2V5czIuZGVmYXVsdCkoX3RoaXMuX2ZpbHRlcnMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewoJICAgICAgICB2YXIgZmlsdGVyID0gX3RoaXMuX2ZpbHRlcnNba2V5XTsKCSAgICAgICAgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLkFOWSkgewoJICAgICAgICAgIC8vbWF0Y2ggYW55dGhpbmcKCSAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwoJICAgICAgICB9IGVsc2UgaWYgKGZpbHRlci50eXBlID09PSBGaWx0ZXJUeXBlLlNUQVJUKSB7CgkgICAgICAgICAgLy9pZiBzdGFydHMgd2l0aCBmaWx0ZXIuLi4KCSAgICAgICAgICBpZiAoZXZlbnQuZmllbGQuaW5kZXhPZihrZXkpID09PSAwKSB7CgkgICAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwoJICAgICAgICAgIH0KCSAgICAgICAgfSBlbHNlIGlmIChmaWx0ZXIudHlwZSA9PT0gRmlsdGVyVHlwZS5FWEFDVCkgewoJICAgICAgICAgIC8vZXhhY3QgbWF0Y2gKCSAgICAgICAgICBpZiAoZXZlbnQuZmllbGQgPT09IGtleSkgewoJICAgICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKCSAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgIH0pOwoJICAgIH0KCSAgfV0pOwoJICByZXR1cm4gRGF0YU9iamVjdE9ic2VydmVyOwoJfShfRGF0YU9iamVjdDMuZGVmYXVsdCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8pOwoKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3RPYnNlcnZlcjsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0pLAoJLyogMTIwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCgl2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCgl2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgoJdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKCXZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7CgoJdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgoJdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpOwoKCXZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMik7CgoJdmFyIF9nZXQyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjQpOwoKCXZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKCXZhciBfaW5oZXJpdHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNCk7CgoJdmFyIF9pbmhlcml0czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbmhlcml0czIpOwoKCXZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMSk7CgoJdmFyIF9EYXRhT2JqZWN0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3QyKTsKCgl2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJLyoqCgkgKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBjcmVhdGUgY2FsbC4KCSAqIFRvIGJlIHVzZWQgYXMgYSByZXBvcnRlciBwb2ludCwgY2hhbmdlcyB3aWxsIGJlIHN1Ym1pdGVkIHRvIERhdGFPYmplY3RPYnNlcnZlciBpbnN0YW5jZXMuCgkgKi8KCS8qKgoJKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKCSogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKCSogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCgkqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCgkqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoJKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCgkqIENvcHlyaWdodCAyMDE2IEFwaXplZQoJKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoJKgoJKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSoKCSogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSoKCSogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSoqLwoKCXZhciBEYXRhT2JqZWN0UmVwb3J0ZXIgPSBmdW5jdGlvbiAoX0RhdGFPYmplY3QpIHsKCSAgKDAsIF9pbmhlcml0czMuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLCBfRGF0YU9iamVjdCk7CgoJICAvKiBwcml2YXRlCgkgIF9zdWJzY3JpcHRpb25zOiA8aHlwZXJ0eVVybDogeyBzdGF0dXM6IHN0cmluZyB9IH0+CgkgICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCgkgIF9vblN1YnNjcmlwdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAoJICBfb25SZXNwb25zZUhhbmRsZXI6IChldmVudCkgPT4gdm9pZAoJICBfb25SZWFkSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCgkgICovCgoJICAvKioKCSAgICogQGlnbm9yZQoJICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlci5jcmVhdGUgbWV0aG9kCgkgICAqLwoJICBmdW5jdGlvbiBEYXRhT2JqZWN0UmVwb3J0ZXIoc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlbnMpIHsKCSAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBEYXRhT2JqZWN0UmVwb3J0ZXIpOwoKCSAgICB2YXIgX3RoaXMyID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMy5kZWZhdWx0KSh0aGlzLCAoRGF0YU9iamVjdFJlcG9ydGVyLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIpKS5jYWxsKHRoaXMsIHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSk7CgoJICAgIHZhciBfdGhpcyA9IF90aGlzMjsKCgkgICAgX3RoaXMuX3N1YnNjcmlwdGlvbnMgPSB7fTsKCgkgICAgX3RoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKCSAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0UmVwb3J0ZXItJyArIHVybCArICctU0VORDogJywgZXZlbnQpOwoJICAgICAgX3RoaXMuX29uQ2hhbmdlKGV2ZW50KTsKCSAgICB9KTsKCgkgICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CgkgICAgcmV0dXJuIF90aGlzMjsKCSAgfQoKCSAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLCBbewoJICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKCSAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlKSwgJ19hbGxvY2F0ZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIF90aGlzLl9vYmplY3RMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgewoJICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdC0nICsgX3RoaXMuX3VybCArICctUkNWOiAnLCBtc2cpOwoJICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CgkgICAgICAgICAgY2FzZSAncmVzcG9uc2UnOgoJICAgICAgICAgICAgX3RoaXMuX29uUmVzcG9uc2UobXNnKTticmVhazsKCSAgICAgICAgICBjYXNlICdyZWFkJzoKCSAgICAgICAgICAgIF90aGlzLl9vblJlYWQobXNnKTticmVhazsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKCSAgICAgICgwLCBfZ2V0My5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShEYXRhT2JqZWN0UmVwb3J0ZXIucHJvdG90eXBlKSwgJ19yZWxlYXNlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX29iamVjdExpc3RlbmVyLnJlbW92ZSgpOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogU2VuZCBpbnZpdGF0aW9ucyAoY3JlYXRlIG1lc3NhZ2VzKSB0byBoeXBlcnRpZXMsIG9ic2VydmVycyBsaXN0LgoJICAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIExpc3Qgb2YgSHlwZXJ0eSBVUkwncwoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ2ludml0ZU9ic2VydmVycycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIGludml0ZU9ic2VydmVycyhvYnNlcnZlcnMpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25DcmVhdGUKCSAgICAgIHZhciBpbnZpdGVNc2cgPSB7CgkgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fc3luY2hlci5fb3duZXIsIHRvOiBfdGhpcy5fc3luY2hlci5fc3ViVVJMLAoJICAgICAgICBib2R5OiB7IHJlc3VtZTogZmFsc2UsIHJlc291cmNlOiBfdGhpcy5fdXJsLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZhbHVlOiBfdGhpcy5fc3luY09iai5kYXRhLCBhdXRob3Jpc2U6IG9ic2VydmVycyB9CgkgICAgICB9OwoKCSAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoaW52aXRlTXNnKTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ2RlbGV0ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uRGVsZXRlCgkgICAgICB2YXIgZGVsZXRlTXNnID0gewoJICAgICAgICB0eXBlOiAnZGVsZXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCwKCSAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCB9CgkgICAgICB9OwoKCSAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoZGVsZXRlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKCSAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1ERUxFVEU6ICcsIHJlcGx5KTsKCSAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CgkgICAgICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCSAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX3JlcG9ydGVyc1tfdGhpcy5fdXJsXTsKCSAgICAgICAgfQoJICAgICAgfSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBTdWJzY3JpcHRpb25zIHJlcXVlc3RlZCBhbmQgYWNjZXB0ZWQgdG8gdGhpcyByZXBvcnRlcgoJICAgICAqIEB0eXBlIHtPYmplY3Q8SHlwZXJ0eVVSTCwgU3luY1N1YnNjcmlwdGlvbj59CgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25TdWJzY3JpcHRpb24nLAoKCgkgICAgLyoqCgkgICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3Mgc3Vic2NyaWJlIGFuZCB1bnN1YnNjcmliZSBub3RpZmljYXRpb25zCgkgICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjayBmdW5jdGlvbiB0byByZWNlaXZlIGV2ZW50cwoJICAgICAqLwoJICAgIHZhbHVlOiBmdW5jdGlvbiBvblN1YnNjcmlwdGlvbihjYWxsYmFjaykgewoJICAgICAgdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyID0gY2FsbGJhY2s7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZXNwb25zZSBub3RpZmljYXRpb25zIG9mIHRoZSBjcmVhdGUncwoJICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sgZnVuY3Rpb24gdG8gcmVjZWl2ZSBldmVudHMKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvblJlc3BvbnNlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gb25SZXNwb25zZShjYWxsYmFjaykgewoJICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlYWQgbm90aWZpY2F0aW9ucwoJICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvblJlYWQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlYWQoY2FsbGJhY2spIHsKCSAgICAgIHRoaXMuX29uUmVhZEhhbmRsZXIgPSBjYWxsYmFjazsKCSAgICB9CgoJICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHBhcmVudCBTeW5jaGVyIC0+IF9vbkZvcndhcmQKCgkgIH0sIHsKCSAgICBrZXk6ICdfb25Gb3J3YXJkJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uRm9yd2FyZChtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RSZXBvcnRlci1SQ1Y6ICcsIG1zZyk7CgkgICAgICBzd2l0Y2ggKG1zZy5ib2R5LnR5cGUpIHsKCSAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKCSAgICAgICAgICBfdGhpcy5fb25TdWJzY3JpYmUobXNnKTticmVhazsKCSAgICAgICAgY2FzZSAndW5zdWJzY3JpYmUnOgoJICAgICAgICAgIF90aGlzLl9vblVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7CgkgICAgICB9CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGlzIC0+IF9vbkZvcndhcmQ6IGVtaXR0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBzdWJzY3JpYmUKCgkgIH0sIHsKCSAgICBrZXk6ICdfb25TdWJzY3JpYmUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdWJzY3JpYmUobXNnKSB7CgkgICAgICB2YXIgX3RoaXMzID0gdGhpczsKCgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoJICAgICAgdmFyIGh5cGVydHlVcmwgPSBtc2cuYm9keS5mcm9tOwoJICAgICAgY29uc29sZS5sb2coJ1tEYXRhT2JqZWN0UmVwb3J0ZXIuX29uU3Vic2NyaWJlXScsIG1zZyk7CgoJICAgICAgdmFyIGV2ZW50ID0gewoJICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAoJICAgICAgICB1cmw6IGh5cGVydHlVcmwsCgoJICAgICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHksCgoJICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKCSAgICAgICAgICAvL2NyZWF0ZSBuZXcgc3Vic2NyaXB0aW9uCgkgICAgICAgICAgdmFyIHN1YiA9IHsgdXJsOiBoeXBlcnR5VXJsLCBzdGF0dXM6ICdvbicgfTsKCSAgICAgICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXSA9IHN1YjsKCgkgICAgICAgICAgLy9wcm9jZXNzIGFuZCBzZW5kIGNoaWxkcmVucyBkYXRhCgkgICAgICAgICAgdmFyIGNoaWxkcmVuVmFsdWVzID0ge307CgkgICAgICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZElkKSB7CgkgICAgICAgICAgICB2YXIgY2hpbGREYXRhID0gX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1tjaGlsZElkXS5kYXRhOwoJICAgICAgICAgICAgY2hpbGRyZW5WYWx1ZXNbY2hpbGRJZF0gPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoY2hpbGREYXRhKTsKCSAgICAgICAgICB9KTsKCgkgICAgICAgICAgdmFyIHNlbmRNc2cgPSB7CgkgICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKCSAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzY2hlbWE6IF90aGlzLl9zY2hlbWEsIHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCB2YWx1ZTogeyBkYXRhOiAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoX3RoaXMuZGF0YSksIGNoaWxkcmVuczogY2hpbGRyZW5WYWx1ZXMgfSB9CgkgICAgICAgICAgfTsKCgkgICAgICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQoJICAgICAgICAgIGlmIChtc2cuYm9keS5oYXNPd25Qcm9wZXJ0eSgnbXV0dWFsQXV0aGVudGljYXRpb24nKSAmJiAhbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24pIHsKCSAgICAgICAgICAgIHNlbmRNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IF90aGlzMy5fbXV0dWFsQXV0aGVudGljYXRpb247CgkgICAgICAgICAgICBfdGhpczMuX211dHVhbEF1dGhlbnRpY2F0aW9uID0gbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb247CgkgICAgICAgICAgfQoKCSAgICAgICAgICAvL3NlbmQgb2sgcmVzcG9uc2UgbWVzc2FnZQoJICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoc2VuZE1zZyk7CgoJICAgICAgICAgIHJldHVybiBzdWI7CgkgICAgICAgIH0sCgoJICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsKCSAgICAgICAgICAvL3NlbmQgcmVqZWN0IHJlc3BvbnNlIG1lc3NhZ2UKCSAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKCSAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAoJICAgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDMsIGRlc2M6IHJlYXNvbiB9CgkgICAgICAgICAgfSk7CgkgICAgICAgIH0KCSAgICAgIH07CgoJICAgICAgaWYgKF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIpIHsKCSAgICAgICAgY29uc29sZS5sb2coJ1NVQlNDUklQVElPTi1FVkVOVDogJywgZXZlbnQpOwoJICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKCSAgICAgIH0KCSAgICB9CgoJICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoaXMgLT4gX29uRm9yd2FyZDogZW1pdHRlZCBieSBhIHJlbW90ZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgLT4gdW5zdWJzY3JpYmUKCgkgIH0sIHsKCSAgICBrZXk6ICdfb25VblN1YnNjcmliZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblVuU3Vic2NyaWJlKG1zZykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCSAgICAgIHZhciBoeXBlcnR5VXJsID0gbXNnLmJvZHkuZnJvbTsKCgkgICAgICB2YXIgc3ViID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CgkgICAgICBkZWxldGUgX3RoaXMuX3N1YnNjcmlwdGlvbnNbaHlwZXJ0eVVybF07CgoJICAgICAgdmFyIGV2ZW50ID0gewoJICAgICAgICB0eXBlOiBtc2cuYm9keS50eXBlLAoJICAgICAgICB1cmw6IGh5cGVydHlVcmwsCgkgICAgICAgIG9iamVjdDogc3ViCgkgICAgICB9OwoKCSAgICAgIGlmIChfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdVTi1TVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKCSAgICAgICAgX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcihldmVudCk7CgkgICAgICB9CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBSZXBvcnRlclVSTCBhZGRyZXNzOiBlbWl0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiBfb25SZW1vdGVDcmVhdGUgLT4gZXZlbnQuYWNrCgoJICB9LCB7CgkgICAga2V5OiAnX29uUmVzcG9uc2UnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZXNwb25zZShtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgdmFyIGV2ZW50ID0gewoJICAgICAgICB0eXBlOiBtc2cudHlwZSwKCSAgICAgICAgdXJsOiBtc2cuZnJvbSwKCSAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyKSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdSRVNQT05TRS1FVkVOVDogJywgZXZlbnQpOwoJICAgICAgICBfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIoZXZlbnQpOwoJICAgICAgfQoJICAgIH0KCgkgICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gUmVwb3J0ZXJVUkwgYWRkcmVzczogZW1pdGVkIGJ5IGEgcmVtb3RlIFN5bmNoZXIgLT4gcmVhZAoKCSAgfSwgewoJICAgIGtleTogJ19vblJlYWQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWFkKG1zZykgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICB2YXIgZXZlbnQgPSB7CgkgICAgICAgIHR5cGU6IG1zZy50eXBlLAoJICAgICAgICB1cmw6IG1zZy5mcm9tLAoKCSAgICAgICAgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQoKSB7CgkgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CgkgICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKCSAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCB2YWx1ZTogKDAsIF91dGlscy5kZWVwQ2xvbmUpKF90aGlzLmRhdGEpIH0KCSAgICAgICAgICB9KTsKCSAgICAgICAgfSwKCgkgICAgICAgIHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KHJlYXNvbikgewoJICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewoJICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCgkgICAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwMSwgZGVzYzogcmVhc29uIH0KCSAgICAgICAgICB9KTsKCSAgICAgICAgfQoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX29uUmVhZEhhbmRsZXIpIHsKCSAgICAgICAgY29uc29sZS5sb2coJ1JFQUQtRVZFTlQ6ICcsIGV2ZW50KTsKCSAgICAgICAgX3RoaXMuX29uUmVhZEhhbmRsZXIoZXZlbnQpOwoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ3N1YnNjcmlwdGlvbnMnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmlwdGlvbnM7CgkgICAgfQoJICB9XSk7CgkgIHJldHVybiBEYXRhT2JqZWN0UmVwb3J0ZXI7Cgl9KF9EYXRhT2JqZWN0My5kZWZhdWx0IC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyk7CgoJZXhwb3J0cy5kZWZhdWx0ID0gRGF0YU9iamVjdFJlcG9ydGVyOwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSksCgkvKiAxMjEgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfcHJvbWlzZSA9IF9fd2VicGFja19yZXF1aXJlX18oNzEpOwoKCXZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCgl2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCgl2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKCXZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCgl2YXIgX1Byb3h5T2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjMpOwoKCXZhciBfUHJveHlPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUHJveHlPYmplY3QpOwoKCXZhciBfRGF0YU9iamVjdENoaWxkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKCXZhciBfRGF0YU9iamVjdENoaWxkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RDaGlsZCk7CgoJdmFyIF91dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTA5KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8qKgoJICogTWFpbiBleHRlbnNpb24gY2xhc3MgZm9yIG9ic2VydmVycyBhbmQgcmVwb3J0ZXJzLCB3aXRoIGNvbW1vbiBwcm9wZXJ0aWVzIGFuZCBtZXRob2RzLgoJICogQ2hpbGRyZW4gbWFuYWdlbWVudCBpcyBjb21tb24gZm9yIG9ic2VydmVycyBhbmQgcmVwb3J0ZXJzLgoJICovCgl2YXIgRGF0YU9iamVjdCA9IGZ1bmN0aW9uICgpIHsKCSAgLyogcHJpdmF0ZQoJICBfdmVyc2lvbjogbnVtYmVyCgkgICBfb3duZXI6IEh5cGVydHlVUkwKCSAgX3VybDogT2JqZWN0VVJMCgkgIF9zY2hlbWE6IFNjaGVtYQoJICBfYnVzOiBNaW5pQnVzCgkgIF9zdGF0dXM6IG9uIHwgcGF1c2VkCgkgIF9zeW5jT2JqOiBTeW5jRGF0YQoJICAgX2NoaWxkcmVuOiB7IGlkOiBEYXRhT2JqZWN0Q2hpbGQgfQoJICBfY2hpbGRyZW5MaXN0ZW5lcnM6IFtNc2dMaXN0ZW5lcl0KCSAgIC0tLS1ldmVudCBoYW5kbGVycy0tLS0KCSAgX29uQWRkQ2hpbGRIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKCSAgKi8KCgkgIC8qKgoJICAgKiBAaWdub3JlCgkgICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyIGNyZWF0ZSBvciBzdWJzY3JpYmUgbWV0aG9kJ3MKCSAgICovCgkgIGZ1bmN0aW9uIERhdGFPYmplY3Qoc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlbnMpIHsKCSAgICB2YXIgbXV0dWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDYgJiYgYXJndW1lbnRzWzZdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNl0gOiB0cnVlOwoJICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFPYmplY3QpOwoKCSAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICBfdGhpcy5fc3luY2hlciA9IHN5bmNoZXI7CgkgICAgX3RoaXMuX3VybCA9IHVybDsKCSAgICBfdGhpcy5fc2NoZW1hID0gc2NoZW1hOwoJICAgIF90aGlzLl9zdGF0dXMgPSBpbml0aWFsU3RhdHVzOwoJICAgIF90aGlzLl9zeW5jT2JqID0gbmV3IF9Qcm94eU9iamVjdDIuZGVmYXVsdChpbml0aWFsRGF0YSk7CgkgICAgX3RoaXMuX2NoaWxkcmVucyA9IGNoaWxkcmVuczsKCgkgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQoJICAgIF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbiA9IG11dHVhbDsKCgkgICAgX3RoaXMuX3ZlcnNpb24gPSAwOwoJICAgIF90aGlzLl9jaGlsZElkID0gMDsKCSAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzID0ge307CgkgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzID0gW107CgoJICAgIF90aGlzLl9vd25lciA9IHN5bmNoZXIuX293bmVyOwoJICAgIF90aGlzLl9idXMgPSBzeW5jaGVyLl9idXM7CgkgIH0KCgkgICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERhdGFPYmplY3QsIFt7CgkgICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewoJICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICB2YXIgY2hpbGRCYXNlVVJMID0gX3RoaXMuX3VybCArICcvY2hpbGRyZW4vJzsKCSAgICAgIGNvbnNvbGUubG9nKCdbRGF0YSBPYmplY3QgLSBBbGxvY2F0ZUxpc3RlbmVyc10gLSAnLCBfdGhpcy5fY2hpbGRyZW5zKTsKCSAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW5zKSB7CgkgICAgICAgIF90aGlzLl9jaGlsZHJlbnMuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHsKCSAgICAgICAgICB2YXIgY2hpbGRVUkwgPSBjaGlsZEJhc2VVUkwgKyBjaGlsZDsKCSAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCBmdW5jdGlvbiAobXNnKSB7CgkgICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCgkgICAgICAgICAgICBpZiAobXNnLmZyb20gIT09IF90aGlzMi5fb3duZXIpIHsKCSAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3QtQ2hpbGRyZW4tUkNWOiAnLCBtc2cpOwoJICAgICAgICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CgkgICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlJzoKCSAgICAgICAgICAgICAgICAgIF90aGlzLl9vbkNoaWxkQ3JlYXRlKG1zZyk7YnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzoKCSAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7YnJlYWs7CgkgICAgICAgICAgICAgICAgZGVmYXVsdDoKCSAgICAgICAgICAgICAgICAgIF90aGlzLl9jaGFuZ2VDaGlsZHJlbihtc2cpO2JyZWFrOwoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfSk7CgoJICAgICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTsKCSAgICAgICAgfSk7CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKGxpc3RlbmVyKSB7CgkgICAgICAgIGxpc3RlbmVyLnJlbW92ZSgpOwoJICAgICAgfSk7CgoJICAgICAgKDAsIF9rZXlzMi5kZWZhdWx0KShfdGhpcy5fY2hpbGRyZW5PYmplY3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKCSAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1trZXldLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgkgICAgICB9KTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIE9iamVjdCBVUkwgb2YgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIKCSAgICAgKiBAdHlwZSB7T2JqZWN0VVJMfQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3BhdXNlJywKCgoJICAgIC8qKgoJICAgICAqIEBpZ25vcmUKCSAgICAgKi8KCSAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2UoKSB7CgkgICAgICAvL1RPRE86IHRoaXMgZmVhdHVyZSBuZWVkcyBtb3JlIGFuYWxpc2UKCSAgICAgIHRocm93ICdOb3QgaW1wbGVtZW50ZWQnOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogQGlnbm9yZQoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3Jlc3VtZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZSgpIHsKCSAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQoJICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBAaWdub3JlCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnc3RvcCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3AoKSB7CgkgICAgICAvL1RPRE86IHNob3VsZCByZW1vdmUgdGhlIHN1YnNjcmlwdGlvbiBhbmQgc2VuZCBtZXNzYWdlIHVuc3Vic2NyaWJlPwoJICAgICAgdGhyb3cgJ05vdCBpbXBsZW1lbnRlZCc7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBDcmVhdGUgYW5kIGFkZCBhIERhdGFPYmplY3RDaGlsZCB0byBhIGNoaWxkcmVuIGNvbGxlY3Rpb24uCgkgICAgICogQHBhcmFtIHtTdHJpbmd9IGNoaWxkcmVuIC0gQ2hpbGRyZW4gbmFtZSB3aGVyZSB0aGUgY2hpbGQgaXMgYWRkZWQuCgkgICAgICogQHBhcmFtIHtKU09OfSBpbml0aWFsRGF0YSAtIEluaXRpYWwgZGF0YSBvZiB0aGUgY2hpbGQKCSAgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RDaGlsZD59IC0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgRGF0YU9iamVjdENoaWxkLgoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ2FkZENoaWxkJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gYWRkQ2hpbGQoY2hpbGRyZW4sIGluaXRpYWxEYXRhKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIC8vY3JlYXRlIG5ldyBjaGlsZCB1bmlxdWUgSUQsIGJhc2VkIG9uIGh5cGVydHlVUkwKCSAgICAgIF90aGlzLl9jaGlsZElkKys7CgkgICAgICB2YXIgbXNnQ2hpbGRJZCA9IF90aGlzLl9vd25lciArICcjJyArIF90aGlzLl9jaGlsZElkOwoJICAgICAgdmFyIG1zZ0NoaWxkUGF0aCA9IF90aGlzLl91cmwgKyAnL2NoaWxkcmVuLycgKyBjaGlsZHJlbjsKCgkgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIGEgcmVzb3VyY2UgY2hpbGQgYWRkcmVzczogTWVzc2FnZUJ1cwoJICAgICAgdmFyIHJlcXVlc3RNc2cgPSB7CgkgICAgICAgIHR5cGU6ICdjcmVhdGUnLCBmcm9tOiBfdGhpcy5fb3duZXIsIHRvOiBtc2dDaGlsZFBhdGgsCgkgICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IG1zZ0NoaWxkSWQsIHZhbHVlOiBpbml0aWFsRGF0YSB9CgkgICAgICB9OwoKCSAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKCSAgICAgIGlmICghX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uKSByZXF1ZXN0TXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb247CgoJICAgICAgLy9yZXR1cm5zIHByb21pc2UsIGluIHRoZSBmdXR1cmUsIHRoZSBBUEkgbWF5IGNoYW5nZSB0byBhc3luY2hyb25vdXMgY2FsbAoJICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSkgewoJICAgICAgICB2YXIgbXNnSWQgPSBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2cpOwoKCSAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZS1yZXBvcnRlci1jaGlsZCggJyArIF90aGlzLl9vd25lciArICcgKTogJywgcmVxdWVzdE1zZyk7CgkgICAgICAgIHZhciBuZXdDaGlsZCA9IG5ldyBfRGF0YU9iamVjdENoaWxkMi5kZWZhdWx0KF90aGlzLCBtc2dDaGlsZElkLCBpbml0aWFsRGF0YSwgX3RoaXMuX293bmVyLCBtc2dJZCk7CgkgICAgICAgIG5ld0NoaWxkLm9uQ2hhbmdlKGZ1bmN0aW9uIChldmVudCkgewoJICAgICAgICAgIF90aGlzLl9vbkNoYW5nZShldmVudCwgeyBwYXRoOiBtc2dDaGlsZFBhdGgsIGNoaWxkSWQ6IG1zZ0NoaWxkSWQgfSk7CgkgICAgICAgIH0pOwoKCSAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1ttc2dDaGlsZElkXSA9IG5ld0NoaWxkOwoKCSAgICAgICAgcmVzb2x2ZShuZXdDaGlsZCk7CgkgICAgICB9KTsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIG9mIGNoaWxkcmVucy4KCSAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb25BZGRDaGlsZCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9uQWRkQ2hpbGQoY2FsbGJhY2spIHsKCSAgICAgIHRoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyID0gY2FsbGJhY2s7CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IGFkZENoaWxkCgoJICB9LCB7CgkgICAga2V5OiAnX29uQ2hpbGRDcmVhdGUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25DaGlsZENyZWF0ZShtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICB2YXIgbXNnQ2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlOwoKCSAgICAgIGNvbnNvbGUubG9nKCdjcmVhdGUtb2JzZXJ2ZXItY2hpbGQoICcgKyBfdGhpcy5fb3duZXIgKyAnICk6ICcsIG1zZyk7CgkgICAgICB2YXIgbmV3Q2hpbGQgPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpcywgbXNnQ2hpbGRJZCwgbXNnLmJvZHkudmFsdWUpOwoJICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1ttc2dDaGlsZElkXSA9IG5ld0NoaWxkOwoKCSAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewoJICAgICAgICAvL0ZMT1ctT1VUOiB3aWxsIGZsb3cgdG8gRGF0YU9iamVjdENoaWxkIC0+IF9vblJlc3BvbnNlCgkgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewoJICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAoJICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCBzb3VyY2U6IF90aGlzLl9vd25lciB9CgkgICAgICAgIH0pOwoJICAgICAgfSk7CgoJICAgICAgdmFyIGV2ZW50ID0gewoJICAgICAgICB0eXBlOiBtc2cudHlwZSwKCSAgICAgICAgZnJvbTogbXNnLmZyb20sCgkgICAgICAgIHVybDogbXNnLnRvLAoJICAgICAgICB2YWx1ZTogbXNnLmJvZHkudmFsdWUsCgkgICAgICAgIGNoaWxkSWQ6IG1zZ0NoaWxkSWQsCgkgICAgICAgIGlkZW50aXR5OiBtc2cuYm9keS5pZGVudGl0eQoJICAgICAgfTsKCgkgICAgICBpZiAoX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdBREQtQ0hJTERSRU4tRVZFTlQ6ICcsIGV2ZW50KTsKCSAgICAgICAgX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKGV2ZW50KTsKCSAgICAgIH0KCSAgICB9CgoJICAgIC8vc2VuZCBkZWx0YSBtZXNzYWdlcyB0byBzdWJzY3JpcHRpb25zCgoJICB9LCB7CgkgICAga2V5OiAnX29uQ2hhbmdlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uQ2hhbmdlKGV2ZW50LCBjaGlsZEluZm8pIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKCgkgICAgICBpZiAoX3RoaXMuX3N0YXR1cyA9PT0gJ29uJykgewoJICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIGEgcmVzb3VyY2UgY2hhbmdlcyBhZGRyZXNzOiBNZXNzYWdlQnVzCgkgICAgICAgIHZhciBjaGFuZ2VNc2cgPSB7CgkgICAgICAgICAgdHlwZTogJ3VwZGF0ZScsIGZyb206IF90aGlzLl91cmwsIHRvOiBfdGhpcy5fdXJsICsgJy9jaGFuZ2VzJywKCSAgICAgICAgICBib2R5OiB7IHZlcnNpb246IF90aGlzLl92ZXJzaW9uLCBzb3VyY2U6IF90aGlzLl9vd25lciwgYXR0cmlidXRlOiBldmVudC5maWVsZCB9CgkgICAgICAgIH07CgoJICAgICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3QgLSBfb25DaGFuZ2VdIC0gJywgZXZlbnQsIGNoaWxkSW5mbywgY2hhbmdlTXNnKTsKCgkgICAgICAgIGlmIChldmVudC5vVHlwZSA9PT0gX1Byb3h5T2JqZWN0Lk9iamVjdFR5cGUuT0JKRUNUKSB7CgkgICAgICAgICAgaWYgKGV2ZW50LmNUeXBlICE9PSBfUHJveHlPYmplY3QuQ2hhbmdlVHlwZS5SRU1PVkUpIHsKCSAgICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKCSAgICAgICAgICB9CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgY2hhbmdlTXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9IGV2ZW50Lm9UeXBlOwoJICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKCSAgICAgICAgICBpZiAoZXZlbnQuY1R5cGUgIT09IF9Qcm94eU9iamVjdC5DaGFuZ2VUeXBlLlVQREFURSkgewoJICAgICAgICAgICAgY2hhbmdlTXNnLmJvZHkub3BlcmF0aW9uID0gZXZlbnQuY1R5cGU7CgkgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgICAvL2NoaWxkSW5mbyBtdXN0IGhhdmUgKHBhdGgsIGNoaWxkSWQpCgkgICAgICAgIGlmIChjaGlsZEluZm8pIHsKCSAgICAgICAgICBjaGFuZ2VNc2cudG8gPSBjaGlsZEluZm8ucGF0aDsKCSAgICAgICAgICBjaGFuZ2VNc2cuYm9keS5yZXNvdXJjZSA9IGNoaWxkSW5mby5jaGlsZElkOwoJICAgICAgICB9CgoJICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CgkgICAgICAgIGlmICghX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uKSBjaGFuZ2VNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbjsKCgkgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoY2hhbmdlTXNnKTsKCSAgICAgIH0KCSAgICB9CgoJICAgIC8vRkxPVy1JTjogZGVsdGEgbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RSZXBvcnRlciBvciBEYXRhT2JqZWN0Q2hpbGQgd2hlbiBjaGFuZ2luZyBkYXRhCgoJICB9LCB7CgkgICAga2V5OiAnX2NoYW5nZU9iamVjdCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VPYmplY3Qoc3luY09iaiwgbXNnKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIC8vVE9ETzogdXBkYXRlIHZlcnNpb24gPwoJICAgICAgLy9ob3cgdG8gaGFuZGxlIGFuIGluY29ycmVjdCB2ZXJzaW9uID8gRXhhbXBsZTogcmVjZWl2ZSBhIHZlcnNpb24gMyB3aGVuIHRoZSBvYnNlcnZlciBpcyBpbiB2ZXJzaW9uIDEsIHdoZXJlIGlzIHRoZSB2ZXJzaW9uIDIgPwoJICAgICAgLy93aWxsIHdlIG5lZWQgdG8gY29uZmlybSB0aGUgcmVjZXB0aW9uID8KCSAgICAgIGlmIChfdGhpcy5fdmVyc2lvbiArIDEgPT09IG1zZy5ib2R5LnZlcnNpb24pIHsKCSAgICAgICAgX3RoaXMuX3ZlcnNpb24rKzsKCSAgICAgICAgdmFyIHBhdGggPSBtc2cuYm9keS5hdHRyaWJ1dGU7CgkgICAgICAgIHZhciB2YWx1ZSA9ICgwLCBfdXRpbHMuZGVlcENsb25lKShtc2cuYm9keS52YWx1ZSk7CgkgICAgICAgIHZhciBmaW5kUmVzdWx0ID0gc3luY09iai5maW5kQmVmb3JlKHBhdGgpOwoKCSAgICAgICAgaWYgKG1zZy5ib2R5LmF0dHJpYnV0ZVR5cGUgPT09IF9Qcm94eU9iamVjdC5PYmplY3RUeXBlLkFSUkFZKSB7CgkgICAgICAgICAgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuQUREKSB7CgkgICAgICAgICAgICB2YXIgYXJyID0gZmluZFJlc3VsdC5vYmo7CgkgICAgICAgICAgICB2YXIgaW5kZXggPSBmaW5kUmVzdWx0Lmxhc3Q7CgkgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuc3BsaWNlLmFwcGx5KGFyciwgW2luZGV4LCAwXS5jb25jYXQodmFsdWUpKTsKCSAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CgkgICAgICAgICAgICB2YXIgX2FyciA9IGZpbmRSZXN1bHQub2JqOwoJICAgICAgICAgICAgdmFyIF9pbmRleCA9IGZpbmRSZXN1bHQubGFzdDsKCSAgICAgICAgICAgIF9hcnIuc3BsaWNlKF9pbmRleCwgdmFsdWUpOwoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdID0gdmFsdWU7IC8vIFVQREFURQoJICAgICAgICAgIH0KCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICBpZiAobXNnLmJvZHkudmFsdWUpIHsKCSAgICAgICAgICAgIGZpbmRSZXN1bHQub2JqW2ZpbmRSZXN1bHQubGFzdF0gPSB2YWx1ZTsgLy8gVVBEQVRFIG9yIEFERAoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBkZWxldGUgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XTsgLy8gUkVNT1ZFCgkgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICB9IGVsc2UgewoJICAgICAgICAvL1RPRE86IGhvdyB0byBoYW5kbGUgdW5zeW5jaHJvbml6ZWQgdmVyc2lvbnM/CgkgICAgICAgIGNvbnNvbGUubG9nKCdVTlNZTkNIUk9OSVpFRCBWRVJTSU9OOiAoZGF0YSA9PiAnICsgX3RoaXMuX3ZlcnNpb24gKyAnLCBtc2cgPT4gJyArIG1zZy5ib2R5LnZlcnNpb24gKyAnKScpOwoJICAgICAgfQoJICAgIH0KCgkgICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdENoaWxkIHdoZW4gY2hhbmdpbmcgZGF0YQoKCSAgfSwgewoJICAgIGtleTogJ19jaGFuZ2VDaGlsZHJlbicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFuZ2VDaGlsZHJlbihtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICBjb25zb2xlLmxvZygnQ2hhbmdlIGNoaWxkcmVuOiAnLCBfdGhpcy5fb3duZXIsIG1zZyk7CgoJICAgICAgdmFyIGNoaWxkSWQgPSBtc2cuYm9keS5yZXNvdXJjZTsKCSAgICAgIHZhciBjaGlsZHJlbiA9IF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF07CgoJICAgICAgaWYgKGNoaWxkcmVuKSB7CgkgICAgICAgIF90aGlzLl9jaGFuZ2VPYmplY3QoY2hpbGRyZW4uX3N5bmNPYmosIG1zZyk7CgkgICAgICB9IGVsc2UgewoJICAgICAgICBjb25zb2xlLmxvZygnTm8gY2hpbGRyZW4gZm91bmQgZm9yOiAnLCBjaGlsZElkKTsKCSAgICAgIH0KCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICd1cmwnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX3VybDsKCSAgICB9CgoJICAgIC8qKgoJICAgICAqIE9iamVjdCBzY2hlbWEgVVJMICh0aGlzIGZpZWxkIGlzIG5vdCB5ZXQgc3RhYmxlLCBhbmQgaXMgc3Vic2plY3QgdG8gY2hhbmdlKQoJICAgICAqIEB0eXBlIHtTY2hlbWFVUkx9CgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnc2NoZW1hJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9zY2hlbWE7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBTdGF0dXMgb2YgdGhlIHJlcG9ydGVyIG9yIG9ic2VydmVyIGNvbm5lY3Rpb24gKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpCgkgICAgICogQHR5cGUge1N0YXR1c30gLSBFbnVtIG9mOiBvbiB8IHBhdXNlZAoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ3N0YXR1cycsCgkgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CgkgICAgICByZXR1cm4gdGhpcy5fc3RhdHVzOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogRGF0YSBzdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLgoJICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdkYXRhJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBBbGwgY3JlYXRlZCBjaGlsZHJlbidzIHNpbmNlIHRoZSBzdWJzY3JpcHRpb24sIGRvZXNuJ3QgY29udGFpbiBhbGwgY2hpbGRyZW4ncyBzaW5jZSByZXBvcnRlciBjcmVhdGlvbi4KCSAgICAgKiBAdHlwZSB7T2JqZWN0PENoaWxkSWQsIERhdGFPYmplY3RDaGlsZD59CgkgICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnY2hpbGRyZW5zJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbk9iamVjdHM7CgkgICAgfQoJICB9XSk7CgkgIHJldHVybiBEYXRhT2JqZWN0OwoJfSgpOyAvKioKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoJICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCgkgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCgkgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQoJICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCgkgICAgICoKCSAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgICAgICoKCSAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICAgICAqCgkgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICAgICAqKi8KCglleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0OwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSksCgkvKiAxMjIgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7CgoJdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgoJdmFyIF9Qcm94eU9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCgl2YXIgX1Byb3h5T2JqZWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1Byb3h5T2JqZWN0KTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8qKgoJICogVGhlIGNsYXNzIHJldHVybmVkIGZyb20gdGhlIERhdGFPYmplY3QgYWRkQ2hpbGRyZW4gY2FsbCBvciBmcm9tIG9uQWRkQ2hpbGRyZW4gaWYgcmVtb3RlbHkgY3JlYXRlZC4KCSAqIENoaWxkcmVuIG9iamVjdCBzeW5jaHJvbml6YXRpb24gaXMgYSBhIGZhc3QgZm9yd2FyZCBtZWNoYW5pc20sIG5vIG5lZWQgZm9yIGRpcmVjdCBzdWJzY3JpcHRpb25zLCBpdCB1c2VzIHRoZSBhbHJlYWR5IGF1dGhvcml6ZWQgc3Vic2NyaXB0aW9uIGZyb20gdGhlIHBhcmVudCBEYXRhT2JqZWN0LgoJICovCgl2YXIgRGF0YU9iamVjdENoaWxkIC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyA9IGZ1bmN0aW9uICgpIHsKCSAgLyogcHJpdmF0ZQoJICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQoJICBfb25SZXNwb25zZUhhbmRsZXI6IChldmVudCkgPT4gdm9pZAoJICAqLwoKCSAgLyoqCgkgICAqIEBpZ25vcmUKCSAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIERhdGFPYmplY3QuYWRkQ2hpbGRyZW4KCSAgICovCgkgIGZ1bmN0aW9uIERhdGFPYmplY3RDaGlsZChwYXJlbnQsIGNoaWxkSWQsIGluaXRpYWxEYXRhLCBvd25lciwgbXNnSWQpIHsKCSAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBEYXRhT2JqZWN0Q2hpbGQpOwoKCSAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICBfdGhpcy5fcGFyZW50ID0gcGFyZW50OwoJICAgIF90aGlzLl9jaGlsZElkID0gY2hpbGRJZDsKCSAgICBfdGhpcy5fb3duZXIgPSBvd25lcjsKCSAgICBfdGhpcy5fbXNnSWQgPSBtc2dJZDsKCgkgICAgX3RoaXMuX3N5bmNPYmogPSBuZXcgX1Byb3h5T2JqZWN0Mi5kZWZhdWx0KGluaXRpYWxEYXRhKTsKCgkgICAgX3RoaXMuX2J1cyA9IHBhcmVudC5fYnVzOwoJICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwoJICB9CgoJICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0Q2hpbGQsIFt7CgkgICAga2V5OiAnX2FsbG9jYXRlTGlzdGVuZXJzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICAvL3RoaXMgaXMgb25seSBuZWVkZWQgZm9yIGNoaWxkcmVuIHJlcG9ydGVycwoJICAgICAgaWYgKF90aGlzLl9vd25lcikgewoJICAgICAgICBfdGhpcy5fbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKF90aGlzLl9vd25lciwgZnVuY3Rpb24gKG1zZykgewoJICAgICAgICAgIGlmIChtc2cudHlwZSA9PT0gJ3Jlc3BvbnNlJyAmJiBtc2cuaWQgPT09IF90aGlzLl9tc2dJZCkgewoJICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RDaGlsZC5vblJlc3BvbnNlOicsIG1zZyk7CgkgICAgICAgICAgICBfdGhpcy5fb25SZXNwb25zZShtc2cpOwoJICAgICAgICAgIH0KCSAgICAgICAgfSk7CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgaWYgKF90aGlzLl9saXN0ZW5lcikgewoJICAgICAgICBfdGhpcy5fbGlzdGVuZXIucmVtb3ZlKCk7CgkgICAgICB9CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdkZWxldGUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBkZWxldGUgX3RoaXMuX3BhcmVudC5fY2hpbGRyZW5bX3RoaXMuX2NoaWxkSWRdOwoKCSAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgoJICAgICAgLy9UT0RPOiBzZW5kIGRlbGV0ZSBtZXNzYWdlID8KCSAgICB9CgoJICAgIC8qKgoJICAgICAqIENoaWxkcmVuIElEIGdlbmVyYXRlZCBvbiBhZGRDaGlsZHJlbi4gVW5pcXVlIGlkZW50aWZpZXIKCSAgICAgKiBAdHlwZSB7VVJMfSAtIFVSTCBvZiB0aGUgZm9ybWF0IDxIeXBlcnR5VVJMPiM8bnVtZXJpYy1zZXF1ZW5jZT4KCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvbkNoYW5nZScsCgoKCSAgICAvKioKCSAgICAgKiBSZWdpc3RlciB0aGUgY2hhbmdlIGxpc3RlbmVycyBzZW50IGJ5IHRoZSByZXBvcnRlciBjaGlsZAoJICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKCSAgICAgKi8KCSAgICB2YWx1ZTogZnVuY3Rpb24gb25DaGFuZ2UoY2FsbGJhY2spIHsKCSAgICAgIHRoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKCSAgICAgICAgY2FsbGJhY2soZXZlbnQpOwoJICAgICAgfSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyByZXNwb25zZSBub3RpZmljYXRpb25zIG9mIHRoZSBjcmVhdGVzCgkgICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawoJICAgICAqLwoKCSAgfSwgewoJICAgIGtleTogJ29uUmVzcG9uc2UnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlc3BvbnNlKGNhbGxiYWNrKSB7CgkgICAgICB0aGlzLl9vblJlc3BvbnNlSGFuZGxlciA9IGNhbGxiYWNrOwoJICAgIH0KCgkgICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdCAtPiBfb25DaGlsZENyZWF0ZQoKCSAgfSwgewoJICAgIGtleTogJ19vblJlc3BvbnNlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVzcG9uc2UobXNnKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIHZhciBldmVudCA9IHsKCSAgICAgICAgdHlwZTogbXNnLnR5cGUsCgkgICAgICAgIHVybDogbXNnLmJvZHkuc291cmNlLAoJICAgICAgICBjb2RlOiBtc2cuYm9keS5jb2RlCgkgICAgICB9OwoKCSAgICAgIGlmIChfdGhpcy5fb25SZXNwb25zZUhhbmRsZXIpIHsKCSAgICAgICAgX3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyKGV2ZW50KTsKCSAgICAgIH0KCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdjaGlsZElkJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9jaGlsZElkOwoJICAgIH0KCgkgICAgLyoqCgkgICAgICogRGF0YSBTdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLgoJICAgICAqIEB0eXBlIHtKU09OfSAtIEpTT04gc3RydWN0dXJlIHRoYXQgc2hvdWxkIGZvbGxvdyB0aGUgZGVmaW5lZCBzY2hlbWEsIGlmIGFueS4KCSAgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdkYXRhJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CgkgICAgfQoJICB9XSk7CgkgIHJldHVybiBEYXRhT2JqZWN0Q2hpbGQ7Cgl9KCk7IC8qKgoJICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoJICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkgICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCgkgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCgkgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlCgkgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSAgICAgKgoJICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAgICAgKgoJICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgICAgICoKCSAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgICAgICoqLwoKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3RDaGlsZDsKCW1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKCS8qKiovIH0pLAoJLyogMTIzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJInVzZSBzdHJpY3QiOwoKCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CgkgIHZhbHVlOiB0cnVlCgl9KTsKCWV4cG9ydHMuT2JqZWN0VHlwZSA9IGV4cG9ydHMuQ2hhbmdlVHlwZSA9IHVuZGVmaW5lZDsKCgl2YXIgX3N0cmluZ2lmeSA9IF9fd2VicGFja19yZXF1aXJlX18oNDApOwoKCXZhciBfc3RyaW5naWZ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmeSk7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKCXZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDExOCk7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgl2YXIgb2JqZWN0VHlwZSA9IHsgQVJSQVk6ICdbb2JqZWN0IEFycmF5XScsIE9CSkVDVDogJ1tvYmplY3QgT2JqZWN0XScgfTsKCgkvKioKCSAqIEBhY2Nlc3MgcHJpdmF0ZQoJICogTWFpbiBjbGFzcyB0aGF0IG1haW50YWlucyBhIEpTT04gb2JqZWN0LCBhbmQgb2JzZXJ2ZXMgY2hhbmdlcyBpbiB0aGlzIG9iamVjdCwgcmVjdXJzaXZlbHkuCgkgKiBJbnRlcm5hbCBvYmplY3RzIGFuZCBhcnJheXMgYXJlIGFsc28gb2JzZXJ2ZWQuCgkgKi8KCgl2YXIgU3luY09iamVjdCA9IGZ1bmN0aW9uICgpIHsKCSAgZnVuY3Rpb24gU3luY09iamVjdChpbml0aWFsRGF0YSkgewoJICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFN5bmNPYmplY3QpOwoKCSAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICBfdGhpcy5fb2JzZXJ2ZXJzID0gW107CgkgICAgX3RoaXMuX2ZpbHRlcnMgPSB7fTsKCgkgICAgdGhpcy5fZGF0YSA9IGluaXRpYWxEYXRhIHx8IHt9OwoKCSAgICB0aGlzLl9pbnRlcm5hbE9ic2VydmUodGhpcy5fZGF0YSk7CgkgIH0KCgkgICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKFN5bmNPYmplY3QsIFt7CgkgICAga2V5OiAnb2JzZXJ2ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoY2FsbGJhY2spIHsKCSAgICAgIHRoaXMuX29ic2VydmVycy5wdXNoKGNhbGxiYWNrKTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdmaW5kJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gZmluZChwYXRoKSB7CgkgICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCgkgICAgICByZXR1cm4gdGhpcy5fZmluZFdpdGhTcGxpdChsaXN0KTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdmaW5kQmVmb3JlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gZmluZEJlZm9yZShwYXRoKSB7CgkgICAgICB2YXIgcmVzdWx0ID0ge307CgkgICAgICB2YXIgbGlzdCA9IHBhdGguc3BsaXQoJy4nKTsKCSAgICAgIHJlc3VsdC5sYXN0ID0gbGlzdC5wb3AoKTsKCSAgICAgIHJlc3VsdC5vYmogPSB0aGlzLl9maW5kV2l0aFNwbGl0KGxpc3QpOwoKCSAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2ZpbmRXaXRoU3BsaXQnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfZmluZFdpdGhTcGxpdChsaXN0KSB7CgkgICAgICB2YXIgb2JqID0gdGhpcy5fZGF0YTsKCSAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHsKCSAgICAgICAgb2JqID0gb2JqW3ZhbHVlXTsKCSAgICAgIH0pOwoKCSAgICAgIHJldHVybiBvYmo7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2lzT2JzZXJ2YWJsZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9pc09ic2VydmFibGUob2JqKSB7CgkgICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBPYmplY3QgfHwgb2JqLmNvbnN0cnVjdG9yID09PSBBcnJheSkgewoJICAgICAgICByZXR1cm4gdHJ1ZTsKCSAgICAgIH0KCgkgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2ludGVybmFsT2JzZXJ2ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbE9ic2VydmUob2JqZWN0KSB7CgkgICAgICB2YXIgX3RoaXMyID0gdGhpczsKCgkgICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoY2hhbmdlc2V0KSB7CgoJICAgICAgICBjaGFuZ2VzZXQuZXZlcnkoZnVuY3Rpb24gKGNoYW5nZSkgewoJICAgICAgICAgIF90aGlzMi5fb25DaGFuZ2VzKGNoYW5nZSk7CgkgICAgICAgIH0pOwoJICAgICAgfTsKCgkgICAgICB0aGlzLl9kYXRhID0gT2JqZWN0LmRlZXBPYnNlcnZlKG9iamVjdCwgaGFuZGxlcik7CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnX2ZpcmVFdmVudCcsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9maXJlRXZlbnQoZXZlbnQpIHsKCSAgICAgIHRoaXMuX29ic2VydmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykgewoJICAgICAgICBjYWxsYmFjayhldmVudCk7CgkgICAgICB9KTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfb25DaGFuZ2VzJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uQ2hhbmdlcyhjaGFuZ2UpIHsKCgkgICAgICB2YXIgb2JqID0gY2hhbmdlLm9iamVjdDsKCSAgICAgIHZhciBvYmpUeXBlID0gdm9pZCAwOwoKCSAgICAgIGlmIChvYmouY29uc3RydWN0b3IgPT09IE9iamVjdCkgewoJICAgICAgICBvYmpUeXBlID0gT2JqZWN0VHlwZS5PQkpFQ1Q7CgkgICAgICB9CgoJICAgICAgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHsKCSAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuQVJSQVk7CgkgICAgICB9CgoJICAgICAgdmFyIGZpZWxkU3RyaW5nID0gY2hhbmdlLmtleXBhdGg7CgoJICAgICAgLy8gY29uc29sZS5sb2coJ0ZpZWxkOicsIGZpZWxkU3RyaW5nKTsKCSAgICAgIC8vIGNvbnNvbGUubG9nKCd0eXBlOicsIGNoYW5nZS50eXBlKTsKCgkgICAgICAvL2xldCBvbGRWYWx1ZSA9IGNoYW5nZS5vbGRWYWx1ZTsKCSAgICAgIHZhciBuZXdWYWx1ZSA9IG9ialtjaGFuZ2UubmFtZV07CgoJICAgICAgY29uc29sZS5pbmZvKGNoYW5nZS50eXBlICsgJyB8IEZpZWxkOiAnICsgZmllbGRTdHJpbmcgKyAnIHwgTmV3IFZhbHVlOicsICgwLCBfc3RyaW5naWZ5Mi5kZWZhdWx0KShuZXdWYWx1ZSkpOwoKCSAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ3VwZGF0ZScpIHsKCSAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKCSAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5VUERBVEUsCgkgICAgICAgICAgb1R5cGU6IG9ialR5cGUsCgkgICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nLAoJICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlCgkgICAgICAgIH0pOwoJICAgICAgfQoKCSAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2FkZCcpIHsKCSAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKCSAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5BREQsCgkgICAgICAgICAgb1R5cGU6IG9ialR5cGUsCgkgICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nLAoJICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlCgkgICAgICAgIH0pOwoJICAgICAgfQoKCSAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2RlbGV0ZScpIHsKCSAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKCSAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5SRU1PVkUsCgkgICAgICAgICAgb1R5cGU6IG9ialR5cGUsCgkgICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nCgkgICAgICAgIH0pOwoJICAgICAgfQoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ2RhdGEnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7CgkgICAgfQoJICB9XSk7CgkgIHJldHVybiBTeW5jT2JqZWN0OwoJfSgpOwoKCXZhciBDaGFuZ2VUeXBlID0gZXhwb3J0cy5DaGFuZ2VUeXBlID0geyBVUERBVEU6ICd1cGRhdGUnLCBBREQ6ICdhZGQnLCBSRU1PVkU6ICdyZW1vdmUnIH07Cgl2YXIgT2JqZWN0VHlwZSA9IGV4cG9ydHMuT2JqZWN0VHlwZSA9IHsgT0JKRUNUOiAnb2JqZWN0JywgQVJSQVk6ICdhcnJheScgfTsKCWV4cG9ydHMuZGVmYXVsdCA9IFN5bmNPYmplY3Q7CgoJLyoqKi8gfSksCgkvKiAxMjQgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCWV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7CgoJdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKCXZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UHJvdG90eXBlT2YpOwoKCXZhciBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNDApOwoKCXZhciBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldE93blByb3BlcnR5RGVzY3JpcHRvcik7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCglleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsKCSAgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOwoJICB2YXIgZGVzYyA9ICgwLCBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMi5kZWZhdWx0KShvYmplY3QsIHByb3BlcnR5KTsKCgkgIGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsKCSAgICB2YXIgcGFyZW50ID0gKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkob2JqZWN0KTsKCgkgICAgaWYgKHBhcmVudCA9PT0gbnVsbCkgewoJICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKCSAgICB9IGVsc2UgewoJICAgICAgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7CgkgICAgfQoJICB9IGVsc2UgaWYgKCJ2YWx1ZSIgaW4gZGVzYykgewoJICAgIHJldHVybiBkZXNjLnZhbHVlOwoJICB9IGVsc2UgewoJICAgIHZhciBnZXR0ZXIgPSBkZXNjLmdldDsKCgkgICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7CgkgICAgICByZXR1cm4gdW5kZWZpbmVkOwoJICAgIH0KCgkgICAgcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsKCSAgfQoJfTsKCgkvKioqLyB9KSwKCS8qIDEyNSAqLywKCS8qIDEyNiAqLywKCS8qIDEyNyAqLywKCS8qIDEyOCAqLywKCS8qIDEyOSAqLywKCS8qIDEzMCAqLywKCS8qIDEzMSAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CgoJdmFyIF9wcm9taXNlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MSk7CgoJdmFyIF9wcm9taXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Byb21pc2UpOwoKCXZhciBfYXNzaWduID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzgpOwoKCXZhciBfYXNzaWduMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Fzc2lnbik7CgoJdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKCXZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCgl2YXIgX0RhdGFPYmplY3RSZXBvcnRlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTIwKTsKCgl2YXIgX0RhdGFPYmplY3RSZXBvcnRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0UmVwb3J0ZXIpOwoKCXZhciBfRGF0YU9iamVjdE9ic2VydmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTkpOwoKCXZhciBfRGF0YU9iamVjdE9ic2VydmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0RhdGFPYmplY3RPYnNlcnZlcik7CgoJdmFyIF9EYXRhUHJvdmlzaW9uYWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNSk7CgoJdmFyIF9EYXRhUHJvdmlzaW9uYWwyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YVByb3Zpc2lvbmFsKTsKCglmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKCS8qKgoJKiBUaGUgbWFpbiBjbGFzcyBmb3IgdGhlIHN5bmNoZXIgcGFja2FnZS4KCSogVGhlIFN5bmNoZXIgaXMgYSBzaW5nbGV0b24gY2xhc3MgcGVyIEh5cGVydHkvVVJMIGFuZCBpdCBpcyB0aGUgb3duZXIgb2YgYWxsIGNyZWF0ZWQgRGF0YSBTeW5jIE9iamVjdHMgYWNjb3JkaW5nIHRvIHRoZSBSZXBvcnRlciAtIE9ic2VydmVyIHBhdHRlcm4uCgkqIE1haW4gZnVuY3Rpb25hbGl0eSBpcyB0byBjcmVhdGUgcmVwb3J0ZXJzIGFuZCB0byBzdWJzY3JpYmUgdG8gZXhpc3Rpbmcgb25lcy4KCSovCgl2YXIgU3luY2hlciA9IGZ1bmN0aW9uICgpIHsKCSAgLyogcHJpdmF0ZQoJICBfb3duZXI6IFVSTAoJICBfYnVzOiBNaW5pQnVzCgkgICBfc3ViVVJMOiBVUkwKCSAgIF9yZXBvcnRlcnM6IDx1cmw6IERhdGFPYmplY3RSZXBvcnRlcj4KCSAgX29ic2VydmVyczogPHVybDogRGF0YU9iamVjdE9ic2VydmVyPgoJICBfcHJvdmlzaW9uYWxzOiA8dXJsOiBEYXRhUHJvdmlzaW9uYWw+CgkgICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCgkgIF9vbk5vdGlmaWNhdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAoJICBfb25SZXN1bWU6IChldmVudCkgPT4gdm9pZAoJICAqLwoKCSAgLyoqCgkgICogQ29uc3RydWN0b3IgdGhhdCBzaG91bGQgYmUgdXNlZCBieSB0aGUgSHlwZXJ0eSBvd25lcgoJICAqIEBwYXJhbSB7SHlwZXJ0eVVSTH0gb3duZXIgLSBIeXBlcnR5IFVSTCBvd25lci4gQW4gVVJMIGFsbG9jYXRlZCBieSB0aGUgcnVudGltZSB0aGF0IHVuaXF1ZWx5IGlkZW50aWZpZXMgdGhlIEh5cGVydHkuCgkgICogQHBhcmFtIHtNaW5pQnVzfSBidXMgLSBBbiBpbnN0YW5jZSBvZiB0aGUgTWluaUJ1cyBwcm92aWRlZCBpbiB0aGUgc2FuZGJveC4gV2hlbiBhbiBvYmplY3QgKFJlcG9ydGVyIG9yIE9ic2VydmVkKSBpcyBjcmVhdGVkLCB0aGUgU3luY2hlck1hbmFnZXIgd2lsbCBhZGQgYSBsaXN0ZW5lciBpbiB0aGUgTWluaUJ1cyB0byByZWNlaXZlL3NlbmQgTWVzc2FnZXMgb2YgdGhhdCBvYmplY3QuCgkgICogQHBhcmFtIHtKU09OfSBjb25maWcgLSBDb25maWd1cmF0aW9uIGRhdGEuIFRoZSBvbmx5IHJlcXVpcmVkIGZpZWxkIGZvciBub3cgaXMgdGhlIHJ1bnRpbWVVUkwuCgkgICovCgkgIGZ1bmN0aW9uIFN5bmNoZXIob3duZXIsIGJ1cywgY29uZmlnKSB7CgkgICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgU3luY2hlcik7CgoJICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgIF90aGlzLl9vd25lciA9IG93bmVyOwoJICAgIF90aGlzLl9idXMgPSBidXM7CgoJICAgIF90aGlzLl9zdWJVUkwgPSBjb25maWcucnVudGltZVVSTCArICcvc20nOwoKCSAgICBfdGhpcy5fcmVwb3J0ZXJzID0ge307CgkgICAgX3RoaXMuX29ic2VydmVycyA9IHt9OwoJICAgIF90aGlzLl9wcm92aXNpb25hbHMgPSB7fTsKCgkgICAgYnVzLmFkZExpc3RlbmVyKG93bmVyLCBmdW5jdGlvbiAobXNnKSB7CgkgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCgkgICAgICBpZiAobXNnLmZyb20gIT09IG93bmVyKSB7CgkgICAgICAgIGNvbnNvbGUuaW5mbygnW1N5bmNoZXJdIFN5bmNoZXItUkNWOiAnLCBtc2cpOwoJICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CgkgICAgICAgICAgY2FzZSAnZm9yd2FyZCc6CgkgICAgICAgICAgICBfdGhpcy5fb25Gb3J3YXJkKG1zZyk7YnJlYWs7CgkgICAgICAgICAgY2FzZSAnY3JlYXRlJzoKCSAgICAgICAgICAgIF90aGlzLl9vblJlbW90ZUNyZWF0ZShtc2cpO2JyZWFrOwoJICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CgkgICAgICAgICAgICBfdGhpcy5fb25SZW1vdGVEZWxldGUobXNnKTticmVhazsKCSAgICAgICAgfQoJICAgICAgfQoJICAgIH0pOwoJICB9CgoJICAvKioKCSAgKiBUaGUgb3duZXIgb2YgdGhlIFN5bmNoZXIgYW5kIGFsbCBjcmVhdGVkIHJlcG9ydGVycy4KCSAgKiBAdHlwZSB7SHlwZXJ0eVVSTH0KCSAgKi8KCgoJICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShTeW5jaGVyLCBbewoJICAgIGtleTogJ2NyZWF0ZScsCgoKCSAgICAvKioKCSAgICAqIFJlcXVlc3QgYSBEYXRhT2JqZWN0UmVwb3J0ZXIgY3JlYXRpb24uIFRoZSBVUkwgd2lsbCBiZSBiZSByZXF1ZXN0ZWQgYnkgdGhlIGFsbG9jYXRpb24gbWVjaGFuaXNtLgoJICAgICogQHBhcmFtICB7U2NoZW1hVVJMfSBzY2hlbWEgLSBIeXBlcnR5IENhdGFsb2d1ZSBVUkwgYWRkcmVzcyB0aGF0IGNhbiBiZSB1c2VkIHRvIHJldHJpZXZlIHRoZSBKU09OLVNjaGVtYSBkZXNjcmliaW5nIHRoZSBEYXRhIE9iamVjdCBzY2hlbWEKCSAgICAqIEBwYXJhbSAge0h5cGVydHlVUkxbXX0gb2JzZXJ2ZXJzIC0gTGlzdCBvZiBoeXBlcnRpZXMgdGhhdCBhcmUgcHJlLWF1dGhvcml6ZWQgZm9yIHN1YnNjcmlwdGlvbgoJICAgICogQHBhcmFtICB7SlNPTn0gaW5pdGlhbERhdGEgLSBJbml0aWFsIGRhdGEgb2YgdGhlIHJlcG9ydGVyCgkgICAgKiBAcGFyYW0gIHtzdHJpbmd9IG9iamVjdFVSTCAtIHJldXNhYmxlIGRhdGFPYmplY3QgVVJMCgkgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RSZXBvcnRlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IFJlcG9ydGVyLiBUaGUgcmVwb3J0ZXIgY2FuIGJlIGFjY2VwdGVkIG9yIHJlamVjdGVkIGJ5IHRoZSBQRVAKCSAgICAqLwoJICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGUoc2NoZW1hLCBvYnNlcnZlcnMsIGluaXRpYWxEYXRhKSB7CgkgICAgICB2YXIgc3RvcmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwoJICAgICAgdmFyIHAycCA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogZmFsc2U7CgoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCSAgICAgIHZhciBjcml0ZXJpYSA9IHt9OwoKCSAgICAgIGNyaXRlcmlhLnAycCA9IHAycDsKCSAgICAgIGNyaXRlcmlhLnN0b3JlID0gc3RvcmU7CgkgICAgICBjcml0ZXJpYS5zY2hlbWEgPSBzY2hlbWE7CgkgICAgICBjcml0ZXJpYS5vYnNlcnZlcnMgPSBvYnNlcnZlcnM7CgkgICAgICBjcml0ZXJpYS5pbml0aWFsRGF0YSA9IGluaXRpYWxEYXRhOwoKCSAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV0gLSBjcmVhdGUgUmVwb3J0ZXIgLSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKCSAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShjcml0ZXJpYSwgeyByZXN1bWU6IGZhbHNlIH0pOwoKCSAgICAgIHJldHVybiBfdGhpcy5fY3JlYXRlKGNyaXRlcmlhKTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdyZXN1bWVSZXBvcnRlcnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVSZXBvcnRlcnMoY3JpdGVyaWEpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdIC0gcmVzdW1lIFJlcG9ydGVyIC0gY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCgkgICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiB0cnVlIH0pOwoKCSAgICAgIHJldHVybiBfdGhpcy5fY3JlYXRlKGNyaXRlcmlhKTsKCSAgICB9CgoJICAgIC8qKgoJICAgICogUmVxdWVzdCBhIHN1YnNjcmlwdGlvbiB0byBhbiBleGlzdGVudCByZXBvcnRlciBvYmplY3QuCgkgICAgKiBAcGFyYW0ge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hCgkgICAgKiBAcGFyYW0ge09iamVjdFVSTH0gb2JqVVJMIC0gQWRkcmVzcyBvZiB0aGUgZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIG9ic2VydmVkCgkgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtzdG9yZT1mYWxzZV0gLSBTYXZlIHRoZSBzdWJzY3JpcHRpb24gb24gdGhlIFN5bmNoZXIgTWFuYWdlciBmb3IgZnVydGhlciByZXN1bWUgKERlZmF1bHQgaXMgZmFsc2UpCgkgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtwMnA9ZmFsc2VdIC0gSW5mbyBhYm91dCBpZiBzaG91bGQgdXNlIHAycCBjb25uZWN0aW9uIChEZWZhdWx0IGlzIGZhbHNlKQoJICAgICogQHBhcmFtIHtCb29sZWFufSBbbXV0dWFsPXRydWVdIC0gSW5mbyBhYm91dCBpZiBtZXNzYWdlcyBvZiB0aGlzIG9iamVjdCBzaG91bGQgYmUgZW5jcnlwdGVkIChEZWZhdWx0IGlzIHRydWUpCgkgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuCgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdzdWJzY3JpYmUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBzdWJzY3JpYmUoc2NoZW1hLCBvYmpVUkwpIHsKCSAgICAgIHZhciBzdG9yZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CgkgICAgICB2YXIgcDJwID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKCSAgICAgIHZhciBtdXR1YWwgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IHRydWU7CgoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCSAgICAgIHZhciBjcml0ZXJpYSA9IHt9OwoKCSAgICAgIGNyaXRlcmlhLnAycCA9IHAycDsKCSAgICAgIGNyaXRlcmlhLnN0b3JlID0gc3RvcmU7CgkgICAgICBjcml0ZXJpYS5zY2hlbWEgPSBzY2hlbWE7CgkgICAgICBjcml0ZXJpYS5yZXNvdXJjZSA9IG9ialVSTDsKCgkgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CgkgICAgICBjcml0ZXJpYS5tdXR1YWwgPSBtdXR1YWw7CgoJICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gc3Vic2NyaWJlXSAtIHN1YnNjcmliZSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKCSAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShjcml0ZXJpYSwgeyByZXN1bWU6IGZhbHNlIH0pOwoKCSAgICAgIHJldHVybiBfdGhpcy5fc3Vic2NyaWJlKGNyaXRlcmlhKTsKCSAgICB9CgoJICAgIC8qKgoJICAgICogUmVxdWVzdCBhIHN1YnNjcmlwdGlvbiB0byBhbiBleGlzdGVudCByZXBvcnRlciBvYmplY3QuCgkgICAgKiBAcGFyYW0ge2NyaXRlcmlhfSBjcml0ZXJpYSAtIEluZm9ybWF0aW9uIHRvIGRpc2NvdmVyeSB0aGUgb2JzZXJ2ZXIgb2JqZWN0CgkgICAgKiBAcmV0dXJuIHtQcm9taXNlPERhdGFPYmplY3RPYnNlcnZlcj59IFJldHVybiBQcm9taXNlIHRvIGEgbmV3IG9ic2VydmVyLiBJdCdzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVwb3J0ZXIuCgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdyZXN1bWVPYnNlcnZlcnMnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWVPYnNlcnZlcnMoY3JpdGVyaWEpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICB2YXIgX2NyaXRlcmlhID0gY3JpdGVyaWEgfHwge307CgoJICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKF9jcml0ZXJpYSwgeyByZXN1bWU6IHRydWUgfSk7CgoJICAgICAgcmV0dXJuIF90aGlzLl9zdWJzY3JpYmUoX2NyaXRlcmlhKTsKCSAgICB9CgoJICAgIC8qKgoJICAgICogUmVxdWVzdCBhIHJlYWQgYWN0aW9uIG9uIHRoZSByZXBvcnRlciBvYmplY3QKCSAgICAqIEBwYXJhbSB7T2JqZWN0VVJMfSBvYmpVUkwgLSBVUkwgb2YgdGhlIHJlcG9ydGVyIG9iamVjdCB0byBiZSByZWFkCgkgICAgKiBAcmV0dXJuIHtQcm9taXNlPE9iamVjdD59IFJldHVybiBQcm9taXNlIHRvIGxhc3QgYXZhaWxhYmxlIGRhdGEgb2YgdGhlIHJlcG9ydGVyCgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdyZWFkJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZChvYmpVUkwpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCBkaXJlY3RseSB0byByZXBvcnRlciBvYmplY3QgKG1heWJlIHRoZXJlIGlzIG5vIGxpc3RlbmVyIGF2YWlsYWJsZSwgc28gaXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIE1lc3NhZ2VCdXMgLT4gcmVzb2x2ZSkKCSAgICAgIC8vd2lsbCByZWFjaCB0aGUgcmVtb3RlIG9iamVjdCBpbiBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gX29uUmVhZAoJICAgICAgdmFyIHJlYWRNc2cgPSB7CgkgICAgICAgIHR5cGU6ICdyZWFkJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogb2JqVVJMCgkgICAgICB9OwoKCSAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoJICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlYWRNc2csIGZ1bmN0aW9uIChyZXBseSkgewoJICAgICAgICAgIGNvbnNvbGUubG9nKCdyZWFkLXJlc3BvbnNlOiAnLCByZXBseSk7CgkgICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CgkgICAgICAgICAgICByZXNvbHZlKHJlcGx5LmJvZHkudmFsdWUpOwoJICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfSk7CgkgICAgfQoKCSAgICAvKioKCSAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIGNyZWF0ZSBhbmQgZGVsZXRlIGV2ZW50cyBvZiByZW1vdmUgUmVwb3J0ZXIgb2JqZWN0cy4KCSAgICAqIFRoaXMgaXMgcmVsZWF0ZWQgdG8gdGhlIG1lc3NhZ2VucyBzZW50IGJ5IGNyZWF0ZSB0byB0aGUgb2JzZXJ2ZXJzIEh5cGVydHkgYXJyYXkuCgkgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdvbk5vdGlmaWNhdGlvbicsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIG9uTm90aWZpY2F0aW9uKGNhbGxiYWNrKSB7CgkgICAgICB0aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIgPSBjYWxsYmFjazsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfY3JlYXRlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZShjcml0ZXJpYSkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCSAgICAgICAgdmFyIHJlc3VtZSA9IGNyaXRlcmlhLnJlc3VtZTsKCSAgICAgICAgdmFyIGluaXRpYWxEYXRhID0gY3JpdGVyaWEuaW5pdGlhbERhdGEgfHwge307CgkgICAgICAgIHZhciBzY2hlbWEgPSB2b2lkIDA7CgoJICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkNyZWF0ZQoJICAgICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKCSAgICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N1YlVSTCwKCSAgICAgICAgICBib2R5OiB7IHJlc3VtZTogcmVzdW1lIH0KCSAgICAgICAgfTsKCgkgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlciAtIGNyZWF0ZV06ICcsIGNyaXRlcmlhLCByZXF1ZXN0TXNnKTsKCgkgICAgICAgIHJlcXVlc3RNc2cuYm9keS52YWx1ZSA9IGluaXRpYWxEYXRhOwoJICAgICAgICByZXF1ZXN0TXNnLmJvZHkudmFsdWUucmVwb3J0ZXIgPSBfdGhpcy5fb3duZXI7CgoJICAgICAgICBpZiAoY3JpdGVyaWEuc2NoZW1hKSB7CgkgICAgICAgICAgc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwoJICAgICAgICAgIHJlcXVlc3RNc2cuYm9keS5zY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CgkgICAgICAgIH0KCgkgICAgICAgIGlmIChjcml0ZXJpYS5wMnApIHJlcXVlc3RNc2cuYm9keS5wMnAgPSBjcml0ZXJpYS5wMnA7CgkgICAgICAgIGlmIChjcml0ZXJpYS5zdG9yZSkgcmVxdWVzdE1zZy5ib2R5LnN0b3JlID0gY3JpdGVyaWEuc3RvcmU7CgkgICAgICAgIGlmIChjcml0ZXJpYS5vYnNlcnZlcnMpIHJlcXVlc3RNc2cuYm9keS5hdXRob3Jpc2UgPSBjcml0ZXJpYS5vYnNlcnZlcnM7CgoJICAgICAgICBpZiAocmVzdW1lKSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIHJlc3VtZSBtZXNzYWdlOiAnLCByZXF1ZXN0TXNnKTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdIC0gY3JlYXRlIG1lc3NhZ2U6ICcsIHJlcXVlc3RNc2cpOwoJICAgICAgICB9CgoJICAgICAgICAvL3JlcXVlc3QgY3JlYXRlIHRvIHRoZSBhbGxvY2F0aW9uIHN5c3RlbS4gQ2FuIGJlIHJlamVjdGVkIGJ5IHRoZSBQb2xpY3lFbmdpbmUuCgkgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVxdWVzdE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CgkgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZS1yZXNwb25zZTogJywgcmVwbHkpOwoJICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewoJICAgICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiBhY2NlcHRlZAoJICAgICAgICAgICAgdmFyIG9ialVSTCA9IHJlcGx5LmJvZHkucmVzb3VyY2U7CgoJICAgICAgICAgICAgaWYgKHJlc3VtZSkgewoJICAgICAgICAgICAgICBzY2hlbWEgPSByZXBseS5ib2R5LnNjaGVtYTsKCSAgICAgICAgICAgICAgaW5pdGlhbERhdGEgPSByZXBseS5ib2R5LnZhbHVlOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIHZhciBuZXdPYmogPSBuZXcgX0RhdGFPYmplY3RSZXBvcnRlcjIuZGVmYXVsdChfdGhpcywgb2JqVVJMLCBzY2hlbWEsICdvbicsIGluaXRpYWxEYXRhLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKCSAgICAgICAgICAgIF90aGlzLl9yZXBvcnRlcnNbb2JqVVJMXSA9IG5ld09iajsKCgkgICAgICAgICAgICByZXNvbHZlKG5ld09iaik7CgkgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIC8vcmVwb3J0ZXIgY3JlYXRpb24gcmVqZWN0ZWQKCSAgICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpOwoJICAgICAgICAgIH0KCSAgICAgICAgfSk7CgkgICAgICB9KTsKCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfc3Vic2NyaWJlJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX3N1YnNjcmliZShjcml0ZXJpYSkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKCgkgICAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uTG9jYWxTdWJzY3JpYmUKCSAgICAgICAgdmFyIHN1YnNjcmliZU1zZyA9IHsKCSAgICAgICAgICB0eXBlOiAnc3Vic2NyaWJlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N1YlVSTCwKCSAgICAgICAgICBib2R5OiB7fQoJICAgICAgICB9OwoKCSAgICAgICAgLy8gSHlwZXJ0eSByZXF1ZXN0IHRvIGJlIGFuIE9ic2VydmVyCgkgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3Qvc3BlY3MvYmxvYi9tYXN0ZXIvbWVzc2FnZXMvZGF0YS1zeW5jLW1lc3NhZ2VzLm1kI2h5cGVydHktcmVxdWVzdC10by1iZS1hbi1vYnNlcnZlcgoKCSAgICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIHRoZSBzYW1lIEh5cGVydHkgVVJMCgkgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3Qvc3BlY3MvYmxvYi9tYXN0ZXIvbWVzc2FnZXMvZGF0YS1zeW5jLW1lc3NhZ2VzLm1kI3Jlc3VtZS1zdWJzY3JpcHRpb25zLWZvci10aGUtc2FtZS1oeXBlcnR5LXVybAoKCSAgICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIGEgY2VydGFpbiB1c2VyIGFuZCBkYXRhIHNjaGVtYSBpbmRlcGVuZGVudGx5IG9mIHRoZSBIeXBlcnR5IFVSTC4KCSAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9zcGVjcy9ibG9iL21hc3Rlci9tZXNzYWdlcy9kYXRhLXN5bmMtbWVzc2FnZXMubWQjcmVzdW1lLXN1YnNjcmlwdGlvbnMtZm9yLWEtY2VydGFpbi11c2VyLWFuZC1kYXRhLXNjaGVtYS1pbmRlcGVuZGVudGx5LW9mLXRoZS1oeXBlcnR5LXVybAoJICAgICAgICBpZiAoY3JpdGVyaWEpIHsKCSAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ3AycCcpKSBzdWJzY3JpYmVNc2cuYm9keS5wMnAgPSBjcml0ZXJpYS5wMnA7CgkgICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdzdG9yZScpKSBzdWJzY3JpYmVNc2cuYm9keS5zdG9yZSA9IGNyaXRlcmlhLnN0b3JlOwoJICAgICAgICAgIGlmIChjcml0ZXJpYS5oYXNPd25Qcm9wZXJ0eSgnc2NoZW1hJykpIHN1YnNjcmliZU1zZy5ib2R5LnNjaGVtYSA9IGNyaXRlcmlhLnNjaGVtYTsKCSAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ2lkZW50aXR5JykpIHN1YnNjcmliZU1zZy5ib2R5LmlkZW50aXR5ID0gY3JpdGVyaWEuaWRlbnRpdHk7CgkgICAgICAgICAgaWYgKGNyaXRlcmlhLmhhc093blByb3BlcnR5KCdyZXNvdXJjZScpKSBzdWJzY3JpYmVNc2cuYm9keS5yZXNvdXJjZSA9IGNyaXRlcmlhLnJlc291cmNlOwoJICAgICAgICB9CgoJICAgICAgICBzdWJzY3JpYmVNc2cuYm9keS5yZXN1bWUgPSBjcml0ZXJpYS5yZXN1bWU7CgoJICAgICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CgkgICAgICAgIHZhciBtdXR1YWxBdXRoZW50aWNhdGlvbiA9IGNyaXRlcmlhLm11dHVhbDsKCSAgICAgICAgaWYgKCFtdXR1YWxBdXRoZW50aWNhdGlvbikgc3Vic2NyaWJlTXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBtdXR1YWxBdXRoZW50aWNhdGlvbjsKCgkgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUgbWVzc2FnZTogJywgY3JpdGVyaWEsIHN1YnNjcmliZU1zZyk7CgoJICAgICAgICAvL3JlcXVlc3Qgc3Vic2NyaXB0aW9uCgkgICAgICAgIC8vUHJvdmlzaW9uYWwgZGF0YSBpcyBhcHBsaWVkIHRvIHRoZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgYWZ0ZXIgY29uZmlybWF0aW9uLiBPciBkaXNjYXJkZWQgaWYgdGhlcmUgaXMgbm8gY29uZmlybWF0aW9uLgoJICAgICAgICAvL2ZvciBtb3JlIGluZm8gc2VlIHRoZSBEYXRhUHJvdmlzaW9uYWwgY2xhc3MgZG9jdW1lbnRhdGlvbi4KCSAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShzdWJzY3JpYmVNc2csIGZ1bmN0aW9uIChyZXBseSkgewoJICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUtcmVzcG9uc2U6ICcsIHJlcGx5KTsKCgkgICAgICAgICAgdmFyIHNjaGVtYSA9IHJlcGx5LmJvZHkuc2NoZW1hOwoJICAgICAgICAgIHZhciBvYmpVUkwgPSByZXBseS5ib2R5LnJlc291cmNlOwoKCSAgICAgICAgICB2YXIgbmV3UHJvdmlzaW9uYWwgPSBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF07CgkgICAgICAgICAgZGVsZXRlIF90aGlzLl9wcm92aXNpb25hbHNbb2JqVVJMXTsKCSAgICAgICAgICBpZiAobmV3UHJvdmlzaW9uYWwpIG5ld1Byb3Zpc2lvbmFsLl9yZWxlYXNlTGlzdGVuZXJzKCk7CgoJICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPCAyMDApIHsKCSAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBuZXcgRGF0YVByb3Zpc2lvbmFsOiAnLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzLCBvYmpVUkwpOwoJICAgICAgICAgICAgbmV3UHJvdmlzaW9uYWwgPSBuZXcgX0RhdGFQcm92aXNpb25hbDIuZGVmYXVsdChfdGhpcy5fb3duZXIsIG9ialVSTCwgX3RoaXMuX2J1cywgcmVwbHkuYm9keS5jaGlsZHJlblJlc291cmNlcyk7CgkgICAgICAgICAgICBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF0gPSBuZXdQcm92aXNpb25hbDsKCSAgICAgICAgICB9IGVsc2UgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7CgkgICAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXJdIC0gbmV3IERhdGEgT2JqZWN0IE9ic2VydmVyOiAnLCByZXBseSwgX3RoaXMuX3Byb3Zpc2lvbmFscyk7CgoJICAgICAgICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQoJICAgICAgICAgICAgdmFyIG5ld09iaiA9IG5ldyBfRGF0YU9iamVjdE9ic2VydmVyMi5kZWZhdWx0KF90aGlzLCBvYmpVUkwsIHNjaGVtYSwgJ29uJywgcmVwbHkuYm9keS52YWx1ZSwgbmV3UHJvdmlzaW9uYWwuY2hpbGRyZW4sIHJlcGx5LmJvZHkudmVyc2lvbiwgbXV0dWFsQXV0aGVudGljYXRpb24pOwoJICAgICAgICAgICAgX3RoaXMuX29ic2VydmVyc1tvYmpVUkxdID0gbmV3T2JqOwoKCSAgICAgICAgICAgIHJlc29sdmUobmV3T2JqKTsKCSAgICAgICAgICAgIG5ld1Byb3Zpc2lvbmFsLmFwcGx5KG5ld09iaik7CgkgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpOwoJICAgICAgICAgIH0KCSAgICAgICAgfSk7CgkgICAgICB9KTsKCSAgICB9CgoJICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgbG9jYWwgcnVudGltZSBSZXBvcnRlck9iamVjdCAtPiBfb25SZW1vdGVTdWJzY3JpYmUKCgkgIH0sIHsKCSAgICBrZXk6ICdfb25Gb3J3YXJkJywKCSAgICB2YWx1ZTogZnVuY3Rpb24gX29uRm9yd2FyZChtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgdmFyIHJlcG9ydGVyID0gX3RoaXMuX3JlcG9ydGVyc1ttc2cuYm9keS50b107CgkgICAgICByZXBvcnRlci5fb25Gb3J3YXJkKG1zZyk7CgkgICAgfQoKCSAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBTeW5jaGVyIC0+IGNyZWF0ZSAodGhpcyBpcyBhY3R1YWxseSBhbiBpbnZpdGF0aW9uIHRvIHN1YnNjcmliZSkKCgkgIH0sIHsKCSAgICBrZXk6ICdfb25SZW1vdGVDcmVhdGUnLAoJICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVDcmVhdGUobXNnKSB7CgkgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKCSAgICAgIC8vcmVtb3ZlICIvc3Vic2NyaXB0aW9uIiBmcm9tIHRoZSBVUkwKCSAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5mcm9tLnNsaWNlKDAsIC0xMyk7CgoJICAgICAgdmFyIGV2ZW50ID0gewoJICAgICAgICB0eXBlOiBtc2cudHlwZSwKCSAgICAgICAgZnJvbTogbXNnLmJvZHkuc291cmNlLAoJICAgICAgICB1cmw6IHJlc291cmNlLAoJICAgICAgICBzY2hlbWE6IG1zZy5ib2R5LnNjaGVtYSwKCSAgICAgICAgdmFsdWU6IG1zZy5ib2R5LnZhbHVlLAoJICAgICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHksCgoJICAgICAgICBhY2s6IGZ1bmN0aW9uIGFjayh0eXBlKSB7CgkgICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwoJICAgICAgICAgIGlmICh0eXBlKSB7CgkgICAgICAgICAgICBsVHlwZSA9IHR5cGU7CgkgICAgICAgICAgfQoKCSAgICAgICAgICAvL3NlbmQgYWNrIHJlc3BvbnNlIG1lc3NhZ2UKCSAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKCSAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAoJICAgICAgICAgICAgYm9keTogeyBjb2RlOiBsVHlwZSB9CgkgICAgICAgICAgfSk7CgkgICAgICAgIH0KCSAgICAgIH07CgoJICAgICAgaWYgKF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIpIHsKCSAgICAgICAgY29uc29sZS5pbmZvKCdbU3luY2hlcl0gTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7CgkgICAgICAgIF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIoZXZlbnQpOwoJICAgICAgfQoJICAgIH0KCgkgICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdFJlcG9ydGVyIC0+IGRlbGV0ZQoKCSAgfSwgewoJICAgIGtleTogJ19vblJlbW90ZURlbGV0ZScsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlbW90ZURlbGV0ZShtc2cpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgLy9yZW1vdmUgIi9zdWJzY3JpcHRpb24iIGZyb20gdGhlIFVSTAoJICAgICAgdmFyIHJlc291cmNlID0gbXNnLmJvZHkucmVzb3VyY2U7CgoJICAgICAgdmFyIG9iamVjdCA9IF90aGlzLl9vYnNlcnZlcnNbcmVzb3VyY2VdOwoJICAgICAgaWYgKG9iamVjdCkgewoJICAgICAgICB2YXIgZXZlbnQgPSB7CgkgICAgICAgICAgdHlwZTogbXNnLnR5cGUsCgkgICAgICAgICAgdXJsOiByZXNvdXJjZSwKCSAgICAgICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHksCgoJICAgICAgICAgIGFjazogZnVuY3Rpb24gYWNrKHR5cGUpIHsKCSAgICAgICAgICAgIHZhciBsVHlwZSA9IDIwMDsKCSAgICAgICAgICAgIGlmICh0eXBlKSB7CgkgICAgICAgICAgICAgIGxUeXBlID0gdHlwZTsKCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAvL1RPRE86IGFueSBvdGhlciBkaWZmZXJlbnQgb3B0aW9ucyBmb3IgdGhlIHJlbGVhc2UgcHJvY2VzcywgbGlrZSBhY2NlcHQgYnV0IG5vciByZWxlYXNlIGxvY2FsPwoJICAgICAgICAgICAgaWYgKGxUeXBlID09PSAyMDApIHsKCSAgICAgICAgICAgICAgb2JqZWN0LmRlbGV0ZSgpOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQoJICAgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CgkgICAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAoJICAgICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlLCBzb3VyY2U6IF90aGlzLl9vd25lciB9CgkgICAgICAgICAgICB9KTsKCSAgICAgICAgICB9CgkgICAgICAgIH07CgoJICAgICAgICBpZiAoX3RoaXMuX29uTm90aWZpY2F0aW9uSGFuZGxlcikgewoJICAgICAgICAgIGNvbnNvbGUubG9nKCdOT1RJRklDQVRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKCSAgICAgICAgICBfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKGV2ZW50KTsKCSAgICAgICAgfQoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CgkgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCgkgICAgICAgICAgYm9keTogeyBjb2RlOiA0MDQsIHNvdXJjZTogX3RoaXMuX293bmVyIH0KCSAgICAgICAgfSk7CgkgICAgICB9CgkgICAgfQoJICB9LCB7CgkgICAga2V5OiAnb3duZXInLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX293bmVyOwoJICAgIH0KCgkgICAgLyoqCgkgICAgKiBBbGwgb3duZWQgcmVwb3J0ZXJzLCB0aGUgb25lcyB0aGF0IHdlcmUgY3JlYXRlZCBieSBhIGNyZWF0ZQoJICAgICogQHR5cGUge09iamVjdDxVUkwsIERhdGFPYmplY3RSZXBvcnRlcj59CgkgICAgKi8KCgkgIH0sIHsKCSAgICBrZXk6ICdyZXBvcnRlcnMnLAoJICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewoJICAgICAgcmV0dXJuIHRoaXMuX3JlcG9ydGVyczsKCSAgICB9CgoJICAgIC8qKgoJICAgICogQWxsIG93bmVkIG9ic2VydmVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBsb2NhbCBzdWJzY3JpcHRpb24KCSAgICAqIEB0eXBlIHtPYmplY3Q8VVJMLCBEYXRhT2JqZWN0T2JzZXJ2ZXI+fQoJICAgICovCgoJICB9LCB7CgkgICAga2V5OiAnb2JzZXJ2ZXJzJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9vYnNlcnZlcnM7CgkgICAgfQoJICB9XSk7CgkgIHJldHVybiBTeW5jaGVyOwoJfSgpOyAvKioKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKCSAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoJICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCgkgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCgkgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQoJICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCgkgICAgICoKCSAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgICAgICoKCSAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICAgICAqCgkgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICAgICAqKi8KCglleHBvcnRzLmRlZmF1bHQgPSBTeW5jaGVyOwoJbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgoJLyoqKi8gfSksCgkvKiAxMzIgKi8sCgkvKiAxMzMgKi8sCgkvKiAxMzQgKi8sCgkvKiAxMzUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCgkidXNlIHN0cmljdCI7CgoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKCSAgdmFsdWU6IHRydWUKCX0pOwoKCXZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCgl2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7CgoJdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCgl2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgoJZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCgkvKioKCSogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCgkqIENvcHlyaWdodCAyMDE2IElORVNDLUlECgkqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoJKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoJKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKCSogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoJKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKCSogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KCSoKCSogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkqCgkqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkqCgkqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkqKi8KCgkvKioKCSAqIEBhY2Nlc3MgcHJpdmF0ZQoJICogVGhpcyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgY29sbGVjdGluZyBkZWx0YSBjaGFuZ2VzIGluIHJlbW90ZSBvYmplY3RzLCBiZWZvcmUgdGhlIHJlc3BvbnNlIG9mIHN1YnNjcmlwdGlvbiByZWFjaCB0aGUgb2JzZXJ2ZXIuCgkgKiBJdCdzIHVzZWQgaW4gU3luY2hlciAtPiBzdWJzY3JpYmUuIFRoZSBmbG93IGlzIGRlZmluZWQgYXM6CgkgKiAxLiAob2JzZXJ2ZXIpIC0tc3Vic2NyaWJlLS0+IChyZXBvcnRlcikKCSAqIDIuIChvYnNlcnZlcikgPC0tZGVsdGEgdXBkYXRlcy0tIChyZXBvcnRlcikKCSAqIDMuIChvYnNlcnZlcikgPC0tc3Vic2NyaWJlIHJlc3BvbnNlLS0gKHJlcG9ydGVyKQoJICogVGhpcyBtZWFucyB0aGF0IHRoZXJlIGNvdWxkIGJlIGRlbHRhIHVwZGF0ZXMgdHJhbnNmZXJyZWQgYmVmb3JlIHRoZSBzdWJzY3JpcHRpb24gY29uZmlybWF0aW9uLgoJICogU2luY2UgdGhlcmUgaXMgbm8gRGF0YU9iamVjdE9ic2VydmVyIGJlZm9yZSB0aGUgdWJzY3JpcHRpb24gY29uZmlybWF0aW9uLCB0aGVyZSBzaG91bGQgYmUgc29tZSBvdGhlciBvYmplY3QgY29sbGVjdGluZyB0aGUgdXBkYXRlcy4KCSAqIFByb3Zpc2lvbmFsIGRhdGEgaXMgYXBwbGllZCB0byB0aGUgRGF0YU9iamVjdE9ic2VydmVyIGFmdGVyIGNvbmZpcm1hdGlvbi4gT3IgZGlzY2FyZGVkIGlmIHRoZXJlIGlzIG5vIGNvbmZpcm1hdGlvbi4KCSAqLwoJdmFyIERhdGFQcm92aXNpb25hbCA9IGZ1bmN0aW9uICgpIHsKCSAgLyogcHJpdmF0ZQoJICBfY2hpbGRyZW5MaXN0ZW5lcnM6IFtNc2dMaXN0ZW5lcl0KCSAgX2xpc3RlbmVyOiBNc2dMaXN0ZW5lcgoJICAgX2NoYW5nZXM6IFtdCgkgICovCgoJICBmdW5jdGlvbiBEYXRhUHJvdmlzaW9uYWwob3duZXIsIHVybCwgYnVzLCBjaGlsZHJlbikgewoJICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIERhdGFQcm92aXNpb25hbCk7CgoJICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgIF90aGlzLl9vd25lciA9IG93bmVyOwoJICAgIF90aGlzLl91cmwgPSB1cmw7CgkgICAgX3RoaXMuX2J1cyA9IGJ1czsKCSAgICBfdGhpcy5fY2hpbGRyZW4gPSBjaGlsZHJlbjsKCgkgICAgX3RoaXMuX2NoYW5nZXMgPSBbXTsKCSAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKCSAgfQoKCSAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoRGF0YVByb3Zpc2lvbmFsLCBbewoJICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgoJICAgICAgX3RoaXMuX2xpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsLCBmdW5jdGlvbiAobXNnKSB7CgkgICAgICAgIGNvbnNvbGUubG9nKCdEYXRhUHJvdmlzaW9uYWwtJyArIF90aGlzLl91cmwgKyAnLVJDVjogJywgbXNnKTsKCSAgICAgICAgX3RoaXMuX2NoYW5nZXMucHVzaChtc2cpOwoJICAgICAgfSk7CgoJICAgICAgLyoKCSAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwoJICAgICAgaWYgKF90aGlzLl9jaGlsZHJlbikgewoJICAgICAgICBsZXQgY2hpbGRCYXNlVVJMID0gdXJsICsgJy9jaGlsZHJlbi8nOwoJICAgICAgICBfdGhpcy5fY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHsKCSAgICAgICAgICBsZXQgY2hpbGRVUkwgPSBjaGlsZEJhc2VVUkwgKyBjaGlsZDsKCSAgICAgICAgICBsZXQgbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCAobXNnKSA9PiB7CgkgICAgICAgICAgICAvL2lnbm9yZSBtc2cgc2VudCBieSBoaW1zZWxmCgkgICAgICAgICAgICBpZiAobXNnLmZyb20gIT09IG93bmVyKSB7CgkgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfSk7CgkgICAgICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTsKCSAgICAgICAgfSk7CgkgICAgICB9Ki8KCSAgICB9CgkgIH0sIHsKCSAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCgkgICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewoJICAgICAgdmFyIF90aGlzID0gdGhpczsKCgkgICAgICBfdGhpcy5fbGlzdGVuZXIucmVtb3ZlKCk7CgoJICAgICAgLypfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXIpID0+IHsKCSAgICAgICAgbGlzdGVuZXIucmVtb3ZlKCk7CgkgICAgICB9KTsqLwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ2FwcGx5JywKCSAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHkob2JzZXJ2ZXIpIHsKCSAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgkgICAgICBfdGhpcy5fY2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uIChjaGFuZ2UpIHsKCSAgICAgICAgb2JzZXJ2ZXIuX2NoYW5nZU9iamVjdChvYnNlcnZlci5fc3luY09iaiwgY2hhbmdlKTsKCSAgICAgIH0pOwoJICAgIH0KCSAgfSwgewoJICAgIGtleTogJ2NoaWxkcmVuJywKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKCSAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbjsKCSAgICB9CgkgIH1dKTsKCSAgcmV0dXJuIERhdGFQcm92aXNpb25hbDsKCX0oKTsKCglleHBvcnRzLmRlZmF1bHQgPSBEYXRhUHJvdmlzaW9uYWw7Cgltb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCgkvKioqLyB9KSwKCS8qIDEzNiAqLywKCS8qIDEzNyAqLywKCS8qIDEzOCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCW1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oMTQ1KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKCS8qKiovIH0pLAoJLyogMTM5ICovLAoJLyogMTQwICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXygxNDcpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgoJLyoqKi8gfSksCgkvKiAxNDEgKi8sCgkvKiAxNDIgKi8sCgkvKiAxNDMgKi8sCgkvKiAxNDQgKi8sCgkvKiAxNDUgKi8KCS8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCglfX3dlYnBhY2tfcmVxdWlyZV9fKDE1MSk7Cgltb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0LmFzc2lnbjsKCgkvKioqLyB9KSwKCS8qIDE0NiAqLywKCS8qIDE0NyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCV9fd2VicGFja19yZXF1aXJlX18oMTUzKTsKCXZhciAkT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5PYmplY3Q7Cgltb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKCSAgcmV0dXJuICRPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpOwoJfTsKCgkvKioqLyB9KSwKCS8qIDE0OCAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgkvLyAxOS4xLjIuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlLCAuLi4pCgl2YXIgZ2V0S2V5cyAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KQoJICAsIGdPUFMgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OCkKCSAgLCBwSUUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDEpCgkgICwgdG9PYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKQoJICAsIElPYmplY3QgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NikKCSAgLCAkYXNzaWduICA9IE9iamVjdC5hc3NpZ247CgoJLy8gc2hvdWxkIHdvcmsgd2l0aCBzeW1ib2xzIGFuZCBzaG91bGQgaGF2ZSBkZXRlcm1pbmlzdGljIHByb3BlcnR5IG9yZGVyIChWOCBidWcpCgltb2R1bGUuZXhwb3J0cyA9ICEkYXNzaWduIHx8IF9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CgkgIHZhciBBID0ge30KCSAgICAsIEIgPSB7fQoJICAgICwgUyA9IFN5bWJvbCgpCgkgICAgLCBLID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0JzsKCSAgQVtTXSA9IDc7CgkgIEsuc3BsaXQoJycpLmZvckVhY2goZnVuY3Rpb24oayl7IEJba10gPSBrOyB9KTsKCSAgcmV0dXJuICRhc3NpZ24oe30sIEEpW1NdICE9IDcgfHwgT2JqZWN0LmtleXMoJGFzc2lnbih7fSwgQikpLmpvaW4oJycpICE9IEs7Cgl9KSA/IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQsIHNvdXJjZSl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMKCSAgdmFyIFQgICAgID0gdG9PYmplY3QodGFyZ2V0KQoJICAgICwgYUxlbiAgPSBhcmd1bWVudHMubGVuZ3RoCgkgICAgLCBpbmRleCA9IDEKCSAgICAsIGdldFN5bWJvbHMgPSBnT1BTLmYKCSAgICAsIGlzRW51bSAgICAgPSBwSUUuZjsKCSAgd2hpbGUoYUxlbiA+IGluZGV4KXsKCSAgICB2YXIgUyAgICAgID0gSU9iamVjdChhcmd1bWVudHNbaW5kZXgrK10pCgkgICAgICAsIGtleXMgICA9IGdldFN5bWJvbHMgPyBnZXRLZXlzKFMpLmNvbmNhdChnZXRTeW1ib2xzKFMpKSA6IGdldEtleXMoUykKCSAgICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgKCSAgICAgICwgaiAgICAgID0gMAoJICAgICAgLCBrZXk7CgkgICAgd2hpbGUobGVuZ3RoID4gailpZihpc0VudW0uY2FsbChTLCBrZXkgPSBrZXlzW2orK10pKVRba2V5XSA9IFNba2V5XTsKCSAgfSByZXR1cm4gVDsKCX0gOiAkYXNzaWduOwoKCS8qKiovIH0pLAoJLyogMTQ5ICovLAoJLyogMTUwICovLAoJLyogMTUxICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gMTkuMS4zLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSkKCXZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKCgkkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiwgJ09iamVjdCcsIHthc3NpZ246IF9fd2VicGFja19yZXF1aXJlX18oMTQ4KX0pOwoKCS8qKiovIH0pLAoJLyogMTUyICovLAoJLyogMTUzICovCgkvKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoJLy8gMTkuMS4yLjYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKQoJdmFyIHRvSU9iamVjdCAgICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQoJICAsICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KS5mOwoKCV9fd2VicGFja19yZXF1aXJlX18oNDUpKCdnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3InLCBmdW5jdGlvbigpewoJICByZXR1cm4gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpewoJICAgIHJldHVybiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRvSU9iamVjdChpdCksIGtleSk7CgkgIH07Cgl9KTsKCgkvKioqLyB9KSwKCS8qIDE1NCAqLywKCS8qIDE1NSAqLywKCS8qIDE1NiAqLywKCS8qIDE1NyAqLywKCS8qIDE1OCAqLywKCS8qIDE1OSAqLywKCS8qIDE2MCAqLywKCS8qIDE2MSAqLywKCS8qIDE2MiAqLywKCS8qIDE2MyAqLwoJLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKCSJ1c2Ugc3RyaWN0IjsKCgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewoJICB2YWx1ZTogdHJ1ZQoJfSk7CglleHBvcnRzLkRhdGFPYmplY3RPYnNlcnZlciA9IGV4cG9ydHMuRGF0YU9iamVjdFJlcG9ydGVyID0gZXhwb3J0cy5TeW5jaGVyID0gdW5kZWZpbmVkOwoKCXZhciBfU3luY2hlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTMxKTsKCgl2YXIgX1N5bmNoZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfU3luY2hlcik7CgoJdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCk7CgoJdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdFJlcG9ydGVyKTsKCgl2YXIgX0RhdGFPYmplY3RPYnNlcnZlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTE5KTsKCgl2YXIgX0RhdGFPYmplY3RPYnNlcnZlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKCWZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgoJZXhwb3J0cy5TeW5jaGVyID0gX1N5bmNoZXIyLmRlZmF1bHQ7CglleHBvcnRzLkRhdGFPYmplY3RSZXBvcnRlciA9IF9EYXRhT2JqZWN0UmVwb3J0ZXIyLmRlZmF1bHQ7CglleHBvcnRzLkRhdGFPYmplY3RPYnNlcnZlciA9IF9EYXRhT2JqZWN0T2JzZXJ2ZXIyLmRlZmF1bHQ7CgoJLyoqKi8gfSkKCS8qKioqKiovIF0pOwoJfSk7CgkvLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtODtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSnpiM1Z5WTJWeklqcGJJbmRsWW5CaFkyczZMeTh2ZDJWaWNHRmpheTkxYm1sMlpYSnpZV3hOYjJSMWJHVkVaV1pwYm1sMGFXOXVJaXdpZDJWaWNHRmphem92THk5M1pXSndZV05yTDJKdmIzUnpkSEpoY0NBMU5tSmpaV1E1T0RFM09UYzNNamRpWlRFMU5pSXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5amIzSmxMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMmRzYjJKaGJDNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWtaWE5qY21sd2RHOXljeTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTkzYTNNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmIySnFaV04wTFdSd0xtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyRnVMVzlpYW1WamRDNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXBjeTF2WW1wbFkzUXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhR2xrWlM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5bGVIQnZjblF1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMmhsYkhCbGNuTXZZMnhoYzNORFlXeHNRMmhsWTJzdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJobGJIQmxjbk12WTNKbFlYUmxRMnhoYzNNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZlptRnBiSE11YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYUdGekxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzUnZMV2x2WW1wbFkzUXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZM1I0TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDNCeWIzQmxjblI1TFdSbGMyTXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhWFJsY21GMGIzSnpMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMlJ2YlMxamNtVmhkR1V1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMV3RsZVhNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZllTMW1kVzVqZEdsdmJpNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWpiMll1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmZEc4dGNISnBiV2wwYVhabExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzTmxkQzEwYnkxemRISnBibWN0ZEdGbkxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzVnBaQzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlrWldacGJtVmtMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMmxsT0Mxa2IyMHRaR1ZtYVc1bExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyeHBZbkpoY25rdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmMyaGhjbVZrTFd0bGVTNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOTBieTFwYm5SbFoyVnlMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMlZ1ZFcwdFluVm5MV3RsZVhNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmMyaGhjbVZrTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlqYjNKbExXcHpMMjlpYW1WamRDOW5aWFF0Y0hKdmRHOTBlWEJsTFc5bUxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzUnZMVzlpYW1WamRDNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMkpoWW1Wc0xYSjFiblJwYldVdlkyOXlaUzFxY3k5dlltcGxZM1F2WkdWbWFXNWxMWEJ5YjNCbGNuUjVMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOW9aV3h3WlhKekwybHVhR1Z5YVhSekxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZbUZpWld3dGNuVnVkR2x0WlM5b1pXeHdaWEp6TDNCdmMzTnBZbXhsUTI5dWMzUnlkV04wYjNKU1pYUjFjbTR1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmIySnFaV04wTDJSbFptbHVaUzF3Y205d1pYSjBlUzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl2WW1wbFkzUXRZM0psWVhSbExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNWtaV1pwYm1VdGNISnZjR1Z5ZEhrdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFYUmxjaTFrWldacGJtVXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlpWVdKbGJDMXlkVzUwYVcxbEwyTnZjbVV0YW5NdmFuTnZiaTl6ZEhKcGJtZHBabmt1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMWEJwWlM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5b2RHMXNMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMjlpYW1WamRDMW5jRzh1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMV3RsZVhNdGFXNTBaWEp1WVd3dWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmIySnFaV04wTFhOaGNDNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXlaV1JsWm1sdVpTNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOTBieTFzWlc1bmRHZ3Vhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZkMnR6TFdSbFptbHVaUzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTkzYTNNdFpYaDBMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZaWE0yTG5OMGNtbHVaeTVwZEdWeVlYUnZjaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMM2RsWWk1a2IyMHVhWFJsY21GaWJHVXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2YW5OdmJpOXpkSEpwYm1kcFpua3Vhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZMnhoYzNOdlppNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXBiMkpxWldOMExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyOWlhbVZqZEMxbmIzQmtMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMjlpYW1WamRDMW5iM0J6TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlvWld4d1pYSnpMM1I1Y0dWdlppNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWhaR1F0ZEc4dGRXNXpZMjl3WVdKc1pYTXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZZWEp5WVhrdGFXNWpiSFZrWlhNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFYUmxjaTFqY21WaGRHVXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhWFJsY2kxemRHVndMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMjlpYW1WamRDMWtjSE11YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMV2R2Y0c0dWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmMzUnlhVzVuTFdGMExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzUmhjMnN1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmZEc4dGFXNWtaWGd1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlsY3pZdVlYSnlZWGt1YVhSbGNtRjBiM0l1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMk52Y21VdGFuTXZiMkpxWldOMEwydGxlWE11YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMk52Y21VdGFuTXZjSEp2YldselpTNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXRaWFJoTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WTI5eVpTNW5aWFF0YVhSbGNtRjBiM0l0YldWMGFHOWtMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOWpiM0psTFdwekwyOWlhbVZqZEM5amNtVmhkR1V1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMk52Y21VdGFuTXZiMkpxWldOMEwzTmxkQzF3Y205MGIzUjVjR1V0YjJZdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJOdmNtVXRhbk12YzNsdFltOXNMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOWpiM0psTFdwekwzTjViV0p2YkM5cGRHVnlZWFJ2Y2k1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5bWJpOXZZbXBsWTNRdlkzSmxZWFJsTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwyOWlhbVZqZEM5blpYUXRjSEp2ZEc5MGVYQmxMVzltTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwyOWlhbVZqZEM5clpYbHpMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMlp1TDI5aWFtVmpkQzl6WlhRdGNISnZkRzkwZVhCbExXOW1MbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMlp1TDNCeWIyMXBjMlV1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmMzbHRZbTlzTDJsdVpHVjRMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMlp1TDNONWJXSnZiQzlwZEdWeVlYUnZjaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTloYmkxcGJuTjBZVzVqWlM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5bGJuVnRMV3RsZVhNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZlptOXlMVzltTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJsdWRtOXJaUzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlwY3kxaGNuSmhlUzFwZEdWeUxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgybHpMV0Z5Y21GNUxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgybDBaWEl0WTJGc2JDNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXBkR1Z5TFdSbGRHVmpkQzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlyWlhsdlppNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXRhV055YjNSaGMyc3Vhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZiMkpxWldOMExXZHZjRzR0WlhoMExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgzSmxaR1ZtYVc1bExXRnNiQzVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl6WlhRdGNISnZkRzh1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYzJWMExYTndaV05wWlhNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmMzQmxZMmxsY3kxamIyNXpkSEoxWTNSdmNpNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwyVnpOaTV2WW1wbFkzUXVZM0psWVhSbExtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNW5aWFF0Y0hKdmRHOTBlWEJsTFc5bUxtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNXJaWGx6TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNMkxtOWlhbVZqZEM1elpYUXRjSEp2ZEc5MGVYQmxMVzltTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNMkxuQnliMjFwYzJVdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5bGN6WXVjM2x0WW05c0xtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlpYTTNMbk41YldKdmJDNWhjM2x1WXkxcGRHVnlZWFJ2Y2k1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDJWek55NXplVzFpYjJ3dWIySnpaWEoyWVdKc1pTNXFjeUlzSW5kbFluQmhZMnM2THk4dkxpOXpjbU12ZFhScGJITXZkWFJwYkhNdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOXdjbTk0ZVMxdlluTmxjblpsTDJsdVpHVjRMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMM055WXk5emVXNWphR1Z5TDBSaGRHRlBZbXBsWTNSUFluTmxjblpsY2k1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5emNtTXZjM2x1WTJobGNpOUVZWFJoVDJKcVpXTjBVbVZ3YjNKMFpYSXVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZjM0pqTDNONWJtTm9aWEl2UkdGMFlVOWlhbVZqZEM1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5emNtTXZjM2x1WTJobGNpOUVZWFJoVDJKcVpXTjBRMmhwYkdRdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmMzSmpMM041Ym1Ob1pYSXZVSEp2ZUhsUFltcGxZM1F1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMmhsYkhCbGNuTXZaMlYwTG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDNOeVl5OXplVzVqYUdWeUwxTjVibU5vWlhJdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmMzSmpMM041Ym1Ob1pYSXZSR0YwWVZCeWIzWnBjMmx2Ym1Gc0xtcHpJaXdpZDJWaWNHRmphem92THk4dUwzNHZZbUZpWld3dGNuVnVkR2x0WlM5amIzSmxMV3B6TDI5aWFtVmpkQzloYzNOcFoyNHVhbk1pTENKM1pXSndZV05yT2k4dkx5NHZmaTlpWVdKbGJDMXlkVzUwYVcxbEwyTnZjbVV0YW5NdmIySnFaV04wTDJkbGRDMXZkMjR0Y0hKdmNHVnlkSGt0WkdWelkzSnBjSFJ2Y2k1cWN5SXNJbmRsWW5CaFkyczZMeTh2TGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5bWJpOXZZbXBsWTNRdllYTnphV2R1TG1weklpd2lkMlZpY0dGamF6b3ZMeTh1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwyOWlhbVZqZEM5blpYUXRiM2R1TFhCeWIzQmxjblI1TFdSbGMyTnlhWEIwYjNJdWFuTWlMQ0ozWldKd1lXTnJPaTh2THk0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmIySnFaV04wTFdGemMybG5iaTVxY3lJc0luZGxZbkJoWTJzNkx5OHZMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMlZ6Tmk1dlltcGxZM1F1WVhOemFXZHVMbXB6SWl3aWQyVmljR0ZqYXpvdkx5OHVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZaWE0yTG05aWFtVmpkQzVuWlhRdGIzZHVMWEJ5YjNCbGNuUjVMV1JsYzJOeWFYQjBiM0l1YW5NaUxDSjNaV0p3WVdOck9pOHZMeTR2YzNKakwxTjVibU5vWlhJdWFuTWlYU3dpYm1GdFpYTWlPbHNpWkdsMmFXUmxWVkpNSWl3aVpHbDJhV1JsUlcxaGFXd2lMQ0psYlhCMGVVOWlhbVZqZENJc0ltUmxaWEJEYkc5dVpTSXNJbWRsZEZWelpYSlZVa3hHY205dFJXMWhhV3dpTENKblpYUlZjMlZ5UlcxaGFXeEdjbTl0VlZKTUlpd2lZMjl1ZG1WeWRGUnZWWE5sY2xWU1RDSXNJblZ5YkNJc0lrVnljbTl5SWl3aWNtVmpkWEp6WlNJc0luWmhiSFZsSWl3aWNtVm5aWGdpTENKemRXSnpkQ0lzSW5CaGNuUnpJaXdpY21Wd2JHRmpaU0lzSW5Od2JHbDBJaXdpYVc1amJIVmtaWE1pTENKeVpYTjFiSFFpTENKMGVYQmxJaXdpWkc5dFlXbHVJaXdpYVdSbGJuUnBkSGtpTENKamIyNXpiMnhsSWl3aVpYSnliM0lpTENKelkyaGxiV1VpTENKemRXSnpkSElpTENKcGJtUmxlRTltSWl3aVpXMWhhV3dpTENKcGJtUmxlRTltUVhRaUxDSjFjMlZ5Ym1GdFpTSXNJbk4xWW5OMGNtbHVaeUlzSW14bGJtZDBhQ0lzSW05aWFtVmpkQ0lzSW05aWFpSXNJa3BUVDA0aUxDSndZWEp6WlNJc0luVnpaWEpGYldGcGJDSXNJblZ6WlhKVlVrd2lMQ0pwWkdWdWRHbG1hV1Z5SWl3aVpHbDJhV1JsWkZWU1RDSXNJa1pwYkhSbGNsUjVjR1VpTENKQlRsa2lMQ0pUVkVGU1ZDSXNJa1ZZUVVOVUlpd2lSR0YwWVU5aWFtVmpkRTlpYzJWeWRtVnlJaXdpYzNsdVkyaGxjaUlzSW5OamFHVnRZU0lzSW1sdWFYUnBZV3hUZEdGMGRYTWlMQ0pwYm1sMGFXRnNSR0YwWVNJc0ltTm9hV3hrY21WdWN5SXNJbWx1YVhScFlXeFdaWEp6YVc5dUlpd2liWFYwZFdGc0lpd2laR0YwWVNJc0lsOTBhR2x6SWl3aVgzWmxjbk5wYjI0aUxDSmZabWxzZEdWeWN5SXNJbDl6ZVc1alQySnFJaXdpYjJKelpYSjJaU0lzSW1WMlpXNTBJaXdpWDI5dVJtbHNkR1Z5SWl3aVptOXlSV0ZqYUNJc0ltTm9hV3hrU1dRaUxDSmphR2xzWkVSaGRHRWlMQ0pmWTJocGJHUnlaVzVQWW1wbFkzUnpJaXdpWDJGc2JHOWpZWFJsVEdsemRHVnVaWEp6SWl3aVgyTm9ZVzVuWlV4cGMzUmxibVZ5SWl3aVgySjFjeUlzSW1Ga1pFeHBjM1JsYm1WeUlpd2lYM1Z5YkNJc0ltMXpaeUlzSW14dlp5SXNJbDlqYUdGdVoyVlBZbXBsWTNRaUxDSnlaVzF2ZG1VaUxDSmZjbVZzWldGelpVeHBjM1JsYm1WeWN5SXNJbDl6ZVc1amFHVnlJaXdpWDI5aWMyVnlkbVZ5Y3lJc0luVnVVM1ZpYzJOeWFXSmxUWE5uSWl3aVpuSnZiU0lzSWw5dmQyNWxjaUlzSW5Sdklpd2lYM04xWWxWU1RDSXNJbUp2WkhraUxDSnlaWE52ZFhKalpTSXNJbkJ2YzNSTlpYTnpZV2RsSWl3aWNtVndiSGtpTENKamIyUmxJaXdpWm1sc2RHVnlJaXdpWTJGc2JHSmhZMnNpTENKclpYa2lMQ0ptYVd4MFpYSlBZbW9pTENKcFpIZ2lMQ0ptYVdWc1pDSXNJa1JoZEdGUFltcGxZM1JTWlhCdmNuUmxjaUlzSWw5emRXSnpZM0pwY0hScGIyNXpJaXdpWDI5dVEyaGhibWRsSWl3aVgyOWlhbVZqZEV4cGMzUmxibVZ5SWl3aVgyOXVVbVZ6Y0c5dWMyVWlMQ0pmYjI1U1pXRmtJaXdpYjJKelpYSjJaWEp6SWl3aWFXNTJhWFJsVFhObklpd2ljbVZ6ZFcxbElpd2lYM05qYUdWdFlTSXNJbUYxZEdodmNtbHpaU0lzSW1SbGJHVjBaVTF6WnlJc0lsOXlaWEJ2Y25SbGNuTWlMQ0pmYjI1VGRXSnpZM0pwY0hScGIyNUlZVzVrYkdWeUlpd2lYMjl1VW1WemNHOXVjMlZJWVc1a2JHVnlJaXdpWDI5dVVtVmhaRWhoYm1Sc1pYSWlMQ0pmYjI1VGRXSnpZM0pwWW1VaUxDSmZiMjVWYmxOMVluTmpjbWxpWlNJc0ltaDVjR1Z5ZEhsVmNtd2lMQ0poWTJObGNIUWlMQ0p6ZFdJaUxDSnpkR0YwZFhNaUxDSmphR2xzWkhKbGJsWmhiSFZsY3lJc0luTmxibVJOYzJjaUxDSnBaQ0lzSW5abGNuTnBiMjRpTENKb1lYTlBkMjVRY205d1pYSjBlU0lzSW0xMWRIVmhiRUYxZEdobGJuUnBZMkYwYVc5dUlpd2lYMjExZEhWaGJFRjFkR2hsYm5ScFkyRjBhVzl1SWl3aWNtVnFaV04wSWl3aWNtVmhjMjl1SWl3aVpHVnpZeUlzSWtSaGRHRlBZbXBsWTNRaUxDSmZjM1JoZEhWeklpd2lYMk5vYVd4a2NtVnVjeUlzSWw5amFHbHNaRWxrSWl3aVgyTm9hV3hrY21WdVRHbHpkR1Z1WlhKeklpd2lZMmhwYkdSQ1lYTmxWVkpNSWl3aVkyaHBiR1FpTENKamFHbHNaRlZTVENJc0lteHBjM1JsYm1WeUlpd2lYMjl1UTJocGJHUkRjbVZoZEdVaUxDSmZZMmhoYm1kbFEyaHBiR1J5Wlc0aUxDSndkWE5vSWl3aVkyaHBiR1J5Wlc0aUxDSnRjMmREYUdsc1pFbGtJaXdpYlhOblEyaHBiR1JRWVhSb0lpd2ljbVZ4ZFdWemRFMXpaeUlzSW5KbGMyOXNkbVVpTENKdGMyZEpaQ0lzSW01bGQwTm9hV3hrSWl3aWIyNURhR0Z1WjJVaUxDSndZWFJvSWl3aVgyOXVRV1JrUTJocGJHUnlaVzVJWVc1a2JHVnlJaXdpYzJWMFZHbHRaVzkxZENJc0luTnZkWEpqWlNJc0ltTm9hV3hrU1c1bWJ5SXNJbU5vWVc1blpVMXpaeUlzSW1GMGRISnBZblYwWlNJc0ltOVVlWEJsSWl3aVQwSktSVU5VSWl3aVkxUjVjR1VpTENKU1JVMVBWa1VpTENKaGRIUnlhV0oxZEdWVWVYQmxJaXdpVlZCRVFWUkZJaXdpYjNCbGNtRjBhVzl1SWl3aWMzbHVZMDlpYWlJc0ltWnBibVJTWlhOMWJIUWlMQ0ptYVc1a1FtVm1iM0psSWl3aVFWSlNRVmtpTENKQlJFUWlMQ0poY25JaUxDSnBibVJsZUNJc0lteGhjM1FpTENKQmNuSmhlU0lzSW5CeWIzUnZkSGx3WlNJc0luTndiR2xqWlNJc0ltRndjR3g1SWl3aVkyOXVZMkYwSWl3aVJHRjBZVTlpYW1WamRFTm9hV3hrSWl3aWNHRnlaVzUwSWl3aWIzZHVaWElpTENKZmNHRnlaVzUwSWl3aVgyMXpaMGxrSWl3aVgyeHBjM1JsYm1WeUlpd2lYMk5vYVd4a2NtVnVJaXdpYjJKcVpXTjBWSGx3WlNJc0lsTjVibU5QWW1wbFkzUWlMQ0pmWkdGMFlTSXNJbDlwYm5SbGNtNWhiRTlpYzJWeWRtVWlMQ0pzYVhOMElpd2lYMlpwYm1SWGFYUm9VM0JzYVhRaUxDSndiM0FpTENKamIyNXpkSEoxWTNSdmNpSXNJazlpYW1WamRDSXNJbWhoYm1Sc1pYSWlMQ0pqYUdGdVoyVnpaWFFpTENKbGRtVnllU0lzSW1Ob1lXNW5aU0lzSWw5dmJrTm9ZVzVuWlhNaUxDSmtaV1Z3VDJKelpYSjJaU0lzSW05aWFsUjVjR1VpTENKUFltcGxZM1JVZVhCbElpd2labWxsYkdSVGRISnBibWNpTENKclpYbHdZWFJvSWl3aWJtVjNWbUZzZFdVaUxDSnVZVzFsSWl3aWFXNW1ieUlzSWw5bWFYSmxSWFpsYm5RaUxDSkRhR0Z1WjJWVWVYQmxJaXdpVTNsdVkyaGxjaUlzSW1KMWN5SXNJbU52Ym1acFp5SXNJbkoxYm5ScGJXVlZVa3dpTENKZmNISnZkbWx6YVc5dVlXeHpJaXdpWDI5dVJtOXlkMkZ5WkNJc0lsOXZibEpsYlc5MFpVTnlaV0YwWlNJc0lsOXZibEpsYlc5MFpVUmxiR1YwWlNJc0luTjBiM0psSWl3aWNESndJaXdpWTNKcGRHVnlhV0VpTENKZlkzSmxZWFJsSWl3aWIySnFWVkpNSWl3aVgzTjFZbk5qY21saVpTSXNJbDlqY21sMFpYSnBZU0lzSW5KbFlXUk5jMmNpTENKZmIyNU9iM1JwWm1sallYUnBiMjVJWVc1a2JHVnlJaXdpY21Wd2IzSjBaWElpTENKdVpYZFBZbW9pTENKamFHbHNaSEpsYmxKbGMyOTFjbU5sY3lJc0luTjFZbk5qY21saVpVMXpaeUlzSW01bGQxQnliM1pwYzJsdmJtRnNJaXdpYzJ4cFkyVWlMQ0poWTJzaUxDSnNWSGx3WlNJc0ltUmxiR1YwWlNJc0lrUmhkR0ZRY205MmFYTnBiMjVoYkNJc0lsOWphR0Z1WjJWeklpd2liMkp6WlhKMlpYSWlYU3dpYldGd2NHbHVaM01pT2lKQlFVRkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN3eVFrRkJNa0k3UVVGRE0wSXNRMEZCUXp0QlFVTkVMRTg3UVVOV1FUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJPenM3UVVGSFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN08wRkJSVUU3UVVGRFFTeHRSRUZCTWtNc1kwRkJZenM3UVVGRmVrUTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeGhRVUZMTzBGQlEwdzdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeHRRMEZCTWtJc01FSkJRVEJDTEVWQlFVVTdRVUZEZGtRc2VVTkJRV2xETEdWQlFXVTdRVUZEYUVRN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRXNPRVJCUVhORUxDdEVRVUVyUkRzN1FVRkZja2c3UVVGRFFUczdRVUZGUVR0QlFVTkJPenM3T3pzN08wRkRhRVZCTERaQ1FVRTJRanRCUVVNM1FpeHhRMEZCY1VNc1owTTdPenM3T3p0QlEwUnlRenRCUVVOQk8wRkJRMEU3UVVGRFFTeDFRMEZCZFVNc1owTTdPenM3T3p0QlEwaDJRenRCUVVOQk8wRkJRMEVzYVVOQlFXbERMRkZCUVZFc1owSkJRV2RDTEZWQlFWVXNSMEZCUnp0QlFVTjBSU3hEUVVGRExFVTdPenM3T3p0QlEwaEVPMEZCUTBFN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPenRCUVVWQkxIVkNPenM3T3pzN1FVTldRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITEZWQlFWVTdRVUZEWWp0QlFVTkJPMEZCUTBFN1FVRkRRU3hGT3pzN096czdRVU5tUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEwcEJPMEZCUTBFN1FVRkRRU3hGT3pzN096czdRVU5HUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFTkJRVU03UVVGRFJEdEJRVU5CTzBGQlEwRXNSVHM3T3pzN08wRkRVRUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRzFGUVVGdFJUdEJRVU51UlR0QlFVTkJMSEZHUVVGeFJqdEJRVU55Ump0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1YwRkJWenRCUVVOWUxGTkJRVk03UVVGRFZEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRXRCUVVzN1FVRkRURHRCUVVOQk8wRkJRMEVzSzBOQlFTdERPMEZCUXk5RE8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMR05CUVdNN1FVRkRaQ3hqUVVGak8wRkJRMlFzWTBGQll6dEJRVU5rTEdOQlFXTTdRVUZEWkN4bFFVRmxPMEZCUTJZc1pVRkJaVHRCUVVObUxHVkJRV1U3UVVGRFppeG5Ra0ZCWjBJN1FVRkRhRUlzZVVJN096czdPenM3UVVNMVJFRTdPMEZCUlVFN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3TzBGRFVrRTdPMEZCUlVFN08wRkJSVUU3TzBGQlJVRTdPMEZCUlVFc2MwTkJRWE5ETEhWRFFVRjFReXhuUWtGQlowSTdPMEZCUlRkR08wRkJRMEU3UVVGRFFTeHRRa0ZCYlVJc2EwSkJRV3RDTzBGQlEzSkRPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeERRVUZETEVjN096czdPenRCUXpGQ1JEdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEwNUJMSFZDUVVGMVFqdEJRVU4yUWp0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRFNFRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEweEJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRGJrSkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSVHM3T3pzN08wRkRVRUVzYjBJN096czdPenRCUTBGQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMDVCTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEVGtFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEU0VFc2FVSkJRV2xDT3p0QlFVVnFRanRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEU2tFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlExaEJPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTEd0RlFVRnJSU3dyUWtGQkswSTdRVUZEYWtjc1JUczdPenM3TzBGRFRrRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hGT3pzN096czdRVU5LUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEwcEJPMEZCUTBFc2NVVkJRWE5GTEdkQ1FVRm5RaXhWUVVGVkxFZEJRVWM3UVVGRGJrY3NRMEZCUXl4Rk96czdPenM3UVVOR1JDeHpRanM3T3pzN08wRkRRVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4Rk96czdPenM3UVVOS1FUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRFRFRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1lUczdPenM3TzBGRFNFRTdRVUZEUVR0QlFVTkJMRzFFUVVGdFJEdEJRVU51UkR0QlFVTkJMSFZEUVVGMVF6dEJRVU4yUXl4Rk96czdPenM3UVVOTVFTeHJRa0ZCYTBJc2QwUTdPenM3T3p0QlEwRnNRanRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTBwQkxHdENRVUZyUWl4M1JEczdPenM3T3p0QlEwRnNRanM3UVVGRlFUczdRVUZGUVRzN1FVRkZRVHM3UVVGRlFUczdRVUZGUVRzN1FVRkZRVHM3UVVGRlFUczdRVUZGUVN4elEwRkJjME1zZFVOQlFYVkRMR2RDUVVGblFqczdRVUZGTjBZN1FVRkRRVHRCUVVOQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVN4Rk96czdPenM3TzBGRGFFTkJPenRCUVVWQk96dEJRVVZCT3p0QlFVVkJPenRCUVVWQkxITkRRVUZ6UXl4MVEwRkJkVU1zWjBKQlFXZENPenRCUVVVM1JqdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQkxFVTdPenM3T3p0QlEyaENRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTBwQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN3MlFrRkJOa0k3UVVGRE4wSTdPMEZCUlVFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3cyUWtGQk5rSTdRVUZETjBJN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFZEJRVWM3UVVGRFNEdEJRVU5CT3pzN096czdPMEZEZUVOQk8wRkJRMEU3UVVGRFFTeHZSVUZCZFVVc2VVTkJRVEJETEVVN096czdPenM3UVVOR2FrZzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk96dEJRVVZCTERSQ1FVRTBRaXhoUVVGaE96dEJRVVY2UXp0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzZDBOQlFYZERMRzlEUVVGdlF6dEJRVU0xUlN3MFEwRkJORU1zYjBOQlFXOURPMEZCUTJoR0xFdEJRVXNzTWtKQlFUSkNMRzlEUVVGdlF6dEJRVU53UlR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1owSkJRV2RDTEcxQ1FVRnRRanRCUVVOdVF6dEJRVU5CTzBGQlEwRXNhVU5CUVdsRExESkNRVUV5UWp0QlFVTTFSRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRXRCUVVzN1FVRkRURHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEY2tWQkxHdENRVUZyUWl4M1JEczdPenM3TzBGRFFXeENMR05CUVdNc2MwSTdPenM3T3p0QlEwRmtMRFpGT3pzN096czdRVU5CUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGdzUlRzN096czdPMEZEV2tFN1FVRkRRVHRCUVVOQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMmhDUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzT0VKQlFUaENPMEZCUXpsQ08wRkJRMEU3UVVGRFFTeHRSRUZCYlVRc1QwRkJUeXhGUVVGRk8wRkJRelZFTEVVN096czdPenRCUTFSQkxIZERPenM3T3pzN1FVTkJRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTERKRVFVRXlSRHRCUVVNelJDeEZPenM3T3pzN1FVTk1RVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN3d1JFRkJNRVFzYzBKQlFYTkNPMEZCUTJoR0xHZEdRVUZuUml4elFrRkJjMEk3UVVGRGRFY3NSVHM3T3pzN08wRkRVa0VzYlVNN096czdPenM3UVVOQlFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRU3cyUWtGQk5rSTdRVUZETjBJc1kwRkJZenRCUVVOa08wRkJRMEVzUTBGQlF6dEJRVU5FTzBGQlEwRTdRVUZEUVR0QlFVTkJMQ3RDUVVFclFqdEJRVU12UWp0QlFVTkJPMEZCUTBFc1ZVRkJWVHRCUVVOV0xFTkJRVU1zUlRzN096czdPMEZEYUVKRU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFc2QwZEJRWGRITEU5QlFVODdRVUZETDBjN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVNN096czdPenM3UVVOYVFUdEJRVU5CTEhWRFFVRjFReXd3UWtGQk1FSTdRVUZEYWtVc2QwTkJRWGRETzBGQlEzaERPMEZCUTBFc1JUczdPenM3T3pzN096czdPMEZEU2tFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeDVRa0ZCZVVJc2EwSkJRV3RDTEVWQlFVVTdPMEZCUlRkRE8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnl4VlFVRlZPMEZCUTJJN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUlRzN096czdPMEZEZEVKQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSVHM3T3pzN08wRkRTa0U3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRWRCUVVjc1ZVRkJWVHRCUVVOaU8wRkJRMEVzUlRzN096czdPMEZEWmtFc2VVTTdPenM3T3pzN1FVTkJRVHM3UVVGRlFUczdRVUZGUVRzN1FVRkZRVHM3UVVGRlFUczdRVUZGUVRzN1FVRkZRU3hwU0VGQmFVZ3NiVUpCUVcxQ0xFVkJRVVVzYlVKQlFXMUNMRFJLUVVFMFNqczdRVUZGY2xRc2MwTkJRWE5ETEhWRFFVRjFReXhuUWtGQlowSTdPMEZCUlRkR08wRkJRMEU3UVVGRFFTeERRVUZETzBGQlEwUTdRVUZEUVN4Rk96czdPenM3UVVOd1FrRXNORUpCUVRSQ0xHVTdPenM3T3p0QlEwRTFRanRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRXRCUVVzc1YwRkJWeXhsUVVGbE8wRkJReTlDTzBGQlEwRXNTMEZCU3p0QlFVTk1PMEZCUTBFc1JUczdPenM3T3p0QlEzQkNRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFc2VVWkJRV2RHTEdGQlFXRXNSVUZCUlRzN1FVRkZMMFk3UVVGRFFTeHhSRUZCY1VRc01FSkJRVEJDTzBGQlF5OUZPMEZCUTBFc1JUczdPenM3TzBGRFdrRTdRVUZEUVN4VlFVRlZPMEZCUTFZc1JUczdPenM3TzBGRFJrRTdRVUZEUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hGT3pzN096czdRVU5hUVR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUTA1Qk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRGFFSkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVVN096czdPenRCUXpGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hGT3pzN096czdPMEZEVGtFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzWjBOQlFXZERPMEZCUTJoRExHTkJRV003UVVGRFpDeHBRa0ZCYVVJN1FVRkRha0k3UVVGRFFTeERRVUZETzBGQlEwUTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4RFFVRkRPenRCUVVWRU8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJMRFJDT3pzN096czdRVU5xUTBFc2EwSkJRV3RDTEhkRU96czdPenM3UVVOQmJFSXNhMEpCUVd0Q0xIZEVPenM3T3pzN1FVTkJiRUk3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzYVVSQlFXbEVPMEZCUTJwRUxFTkJRVU03UVVGRFJEdEJRVU5CTEhGQ1FVRnhRanRCUVVOeVFqdEJRVU5CTEZOQlFWTTdRVUZEVkN4SlFVRkpPMEZCUTBvN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlEzQkVRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096dEJRMUJCTEd0Q1FVRnJRaXgzUkRzN096czdPMEZEUVd4Q0xHdENRVUZyUWl4M1JEczdPenM3TzBGRFFXeENMR3RDUVVGclFpeDNSRHM3T3pzN08wRkRRV3hDTEd0Q1FVRnJRaXgzUkRzN096czdPMEZEUVd4Q08wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSVHM3T3pzN08wRkRTa0U3UVVGRFFTdzRSRHM3T3pzN08wRkRSRUU3UVVGRFFTeHZSRHM3T3pzN08wRkRSRUU3UVVGRFFTdzRSRHM3T3pzN08wRkRSRUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4blJEczdPenM3TzBGRFNrRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3dyUXpzN096czdPMEZEU2tFN1FVRkRRVHRCUVVOQkxIVkVPenM3T3pzN1FVTkdRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZ3NSVHM3T3pzN08wRkRTa0U3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnc1JUczdPenM3TzBGRFpFRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNjVU5CUVhGRExHbENRVUZwUWl4RlFVRkZPMEZCUTNoRU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4blJVRkJaMFVzWjBKQlFXZENPMEZCUTJoR08wRkJRMEU3UVVGRFFTeEhRVUZITERKRFFVRXlReXhuUTBGQlowTTdRVUZET1VVN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEhkQ096czdPenM3UVVONFFrRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFZEJRVWM3UVVGRFNDeEZPenM3T3pzN1FVTm1RVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFc1JUczdPenM3TzBGRFVFRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hGT3pzN096czdRVU5LUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hGT3pzN096czdRVU5ZUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3UVVGRFFTd3JRa0ZCSzBJc2NVSkJRWEZDTzBGQlEzQkVMQ3RDUVVFclFpeFRRVUZUTEVWQlFVVTdRVUZETVVNc1EwRkJReXhWUVVGVk96dEJRVVZZTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxESkNRVUV5UWl4VFFVRlRMRzFDUVVGdFFqdEJRVU4yUkN3clFrRkJLMElzWVVGQllUdEJRVU0xUXp0QlFVTkJMRWRCUVVjc1ZVRkJWVHRCUVVOaU8wRkJRMEVzUlRzN096czdPMEZEY0VKQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlExUkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hQUVVGUE8wRkJRMUE3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4TFFVRkxPMEZCUTB3N1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGc3UVVGRFFUdEJRVU5CTEhWRFFVRjFReXh2UWtGQmIwSXNSVUZCUlR0QlFVTTNSRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVkQlFVYzdRVUZEU0R0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRWRCUVVjN1FVRkRTRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFc1owSkJRV2RDTzBGQlEyaENPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUzBGQlN6dEJRVU5NTzBGQlEwRXNSVHM3T3pzN08wRkRia1ZCTzBGQlEwRTdRVUZEUVR0QlFVTkJMR3RDUVVGclFqczdRVUZGYkVJN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4SFFVRkhPMEZCUTBnN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVRzN096czdPenRCUTJ4Q1FUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSUxFVTdPenM3T3p0QlEwNUJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMR3RFUVVGclJEdEJRVU5zUkR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzVDBGQlR5eFZRVUZWTEdOQlFXTTdRVUZETDBJN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNTMEZCU3l4SFFVRkhPMEZCUTFJN1FVRkRRU3hGT3pzN096czdPMEZEZUVKQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEc5Q1FVRnZRaXhoUVVGaE8wRkJRMnBETEVkQlFVYzdRVUZEU0N4Rk96czdPenM3UVVOaVFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFVTdPenM3T3p0QlExQkJPMEZCUTBFN1FVRkRRU3c0UWtGQk9FSXNaME5CUVc5RExFVTdPenM3T3p0QlEwWnNSVHRCUVVOQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hEUVVGRExFVTdPenM3T3p0QlExSkVPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRU5CUVVNc1JUczdPenM3TzBGRFVrUTdRVUZEUVR0QlFVTkJMRGhDUVVFNFFpdzBRMEZCTkVNc1JUczdPenM3T3p0QlEwWXhSVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxHOURRVUZ2UXp0QlFVTndRenM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMQ3REUVVFclF5eHpSRUZCYVVRc2IwSkJRVzlDTzBGQlEzQklPMEZCUTBFN1FVRkRRU3hIUVVGSExGVkJRVlU3UVVGRFlpeERRVUZET3p0QlFVVkVPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGc3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSUxGbEJRVms3UVVGRFdqdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4WFFVRlhPMEZCUTFnN1FVRkRRU3hYUVVGWE8wRkJRMWdzVTBGQlV6dEJRVU5VTEU5QlFVODdRVUZEVUR0QlFVTkJPMEZCUTBFN1FVRkRRU3d5UTBGQk1rTTdRVUZETTBNN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEZOQlFWTTdRVUZEVkN4dFFrRkJiVUlzWjBOQlFXZERPMEZCUTI1RUxGTkJRVk03UVVGRFZEdEJRVU5CTzBGQlEwRXNUMEZCVHp0QlFVTlFPMEZCUTBFN1FVRkRRU3hMUVVGTE8wRkJRMHc3UVVGRFFTeEhRVUZITzBGQlEwZzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNSMEZCUnp0QlFVTklPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEV0QlFVczdRVUZEVEN4bFFVRmxMSEZEUVVGeFF6dEJRVU53UkR0QlFVTkJMRWRCUVVjN1FVRkRTRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNhME5CUVd0RE8wRkJRMnhETzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNhME5CUVd0RE8wRkJRMnhETzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc2RVSkJRWFZDTEhkQ1FVRjNRanRCUVVNdlF6dEJRVU5CTzBGQlEwRXNVMEZCVXp0QlFVTlVPMEZCUTBFN1FVRkRRU3hQUVVGUE8wRkJRMUFzUzBGQlN6dEJRVU5NTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSUxHdENRVUZyUWl4MVFrRkJkVUlzUzBGQlN6dEJRVU01UXp0QlFVTkJPenRCUVVWQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxFdEJRVXM3UVVGRFREdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMR2xDUVVGcFFqdEJRVU5xUWl4M1FrRkJkMEk3UVVGRGVFSXNaMEpCUVdkQ08wRkJRMmhDTEc5Q1FVRnZRanRCUVVOd1FpeDNRa0ZCZDBJN1FVRkRlRUlzWjBKQlFXZENPMEZCUTJoQ0xHOUNRVUZ2UWp0QlFVTndRanRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeExRVUZMTzBGQlEwdzdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGc3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN08wRkJSVUVzTUVSQlFUQkVMR3RDUVVGclFqdEJRVU0xUlR0QlFVTkJPMEZCUTBFN08wRkJSVUU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUTBGQlF6dEJRVU5FTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNRMEZCUXp0QlFVTkVPMEZCUTBFN1FVRkRRU3hEUVVGRE8wRkJRMFE3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEZOQlFWTTdRVUZEVkN4UFFVRlBPMEZCUTFBN1FVRkRRU3hMUVVGTE8wRkJRMHc3UVVGRFFUdEJRVU5CTEVkQlFVYzdRVUZEU0R0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNUMEZCVHp0QlFVTlFMRXRCUVVzN1FVRkRURHRCUVVOQk8wRkJRMEU3UVVGRFFTeERRVUZETEVVN096czdPenM3UVVNeFUwUTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNkVUpCUVhWQ08wRkJRM1pDTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJMSE5DUVVGelFqdEJRVU4wUWl4dlFrRkJiMElzZFVKQlFYVkNMRk5CUVZNc1NVRkJTVHRCUVVONFJDeEhRVUZITzBGQlEwZ3NRMEZCUXp0QlFVTkVPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUTBGQlF6czdRVUZGUkR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk96dEJRVVZCTzBGQlEwRTdRVUZEUVN4RFFVRkRPMEZCUTBRN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxIbEVRVUY1UkR0QlFVTjZSRHRCUVVOQkxFdEJRVXM3UVVGRFREdEJRVU5CTEhOQ1FVRnpRaXhwUTBGQmFVTTdRVUZEZGtRc1MwRkJTenRCUVVOTUxFZEJRVWM3UVVGRFNEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hIUVVGSE8wRkJRMGc3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc09FUkJRVGhFTERoQ1FVRTRRanRCUVVNMVJqdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRWRCUVVjN08wRkJSVWc3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHRCUVVOQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJPMEZCUTBFN08wRkJSVUVzTUVSQlFUQkVMR2RDUVVGblFqczdRVUZGTVVVN1FVRkRRVHRCUVVOQk8wRkJRMEVzYjBKQlFXOUNMRzlDUVVGdlFqczdRVUZGZUVNc01FTkJRVEJETEc5Q1FVRnZRanM3UVVGRk9VUTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1IwRkJSenRCUVVOSUxIZENRVUYzUWl4bFFVRmxMRVZCUVVVN1FVRkRla01zZDBKQlFYZENMR2RDUVVGblFqdEJRVU40UXl4RFFVRkRPenRCUVVWRU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNRMEZCUXpzN1FVRkZSRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4dlJFRkJiMFFzUzBGQlN5eFJRVUZSTEdsRFFVRnBRenRCUVVOc1J5eERRVUZETzBGQlEwUTdRVUZEUVN3clEwRkJLME03UVVGREwwTTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3hEUVVGRE96dEJRVVZFTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEVzTUVNN096czdPenRCUXpGUFFTeDVRenM3T3pzN08wRkRRVUVzYzBNN096czdPenM3T3pzN096czdPenM3T3pzN096czdVVU4zUTJkQ1FTeFRMRWRCUVVGQkxGTTdVVUZyUkVGRExGY3NSMEZCUVVFc1Z6dFJRV2RDUVVNc1Z5eEhRVUZCUVN4WE8xRkJVMEZETEZNc1IwRkJRVUVzVXp0UlFWVkJReXh0UWl4SFFVRkJRU3h0UWp0UlFWVkJReXh0UWl4SFFVRkJRU3h0UWp0UlFWZEJReXhuUWl4SFFVRkJRU3huUWpzN096dEJRV3hLYUVJN096czdPenM3T3pzN096czdPenM3T3pzN096czdRVUZ6UWtFN096czdPMEZCUzBFN096czdPenM3TzBGQlVVRTdPenM3TzBGQlMwOHNVMEZCVTA0c1UwRkJWQ3hEUVVGdFFrOHNSMEZCYmtJc1JVRkJkMEk3TzBGQlJUZENMRTFCUVVrc1EwRkJRMEVzUjBGQlRDeEZRVUZWTEUxQlFVMURMRTFCUVUwc2QwSkJRVTRzUTBGQlRqczdRVUZGV0N4WFFVRlRReXhQUVVGVUxFTkJRV2xDUXl4TFFVRnFRaXhGUVVGM1FqdEJRVU4yUWl4UlFVRk5ReXhSUVVGUkxEQkdRVUZrTzBGQlEwVXNVVUZCVFVNc1VVRkJVU3hWUVVGa08wRkJRMFFzVVVGQlNVTXNVVUZCVVVnc1RVRkJUVWtzVDBGQlRpeERRVUZqU0N4TFFVRmtMRVZCUVhGQ1F5eExRVUZ5UWl4RlFVRTBRa2NzUzBGQk5VSXNRMEZCYTBNc1IwRkJiRU1zUTBGQldqdEJRVU5FTEZkQlFVOUdMRXRCUVZBN1FVRkRRVHM3UVVGRlJDeE5RVUZKUVN4UlFVRlJTaXhSUVVGUlJpeEhRVUZTTEVOQlFWbzdPMEZCUlVNN1FVRkRRU3hOUVVGSlRTeE5RVUZOTEVOQlFVNHNUVUZCWVU0c1IwRkJZaXhKUVVGdlFpeERRVUZEVFN4TlFVRk5MRU5CUVU0c1JVRkJVMGNzVVVGQlZDeERRVUZyUWl4SFFVRnNRaXhEUVVGNlFpeEZRVUZwUkRzN1FVRkZMME1zVVVGQlNVTXNWVUZCVXp0QlFVTllReXhaUVVGTkxFVkJSRXM3UVVGRldFTXNZMEZCVVZvc1IwRkdSenRCUVVkWVlTeG5Ra0ZCVlR0QlFVaERMRXRCUVdJN08wRkJUVUZETEZsQlFWRkRMRXRCUVZJc1EwRkJZeXg1UmtGQlpDeEZRVUY1UjJZc1IwRkJla2M3TzBGQlJVRXNWMEZCVDFVc1QwRkJVRHRCUVVORU96dEJRVVZHTzBGQlEwRXNUVUZCU1Vvc1RVRkJUU3hEUVVGT0xFMUJRV0ZPTEVkQlFXSXNTVUZCYjBKTkxFMUJRVTBzUTBGQlRpeEZRVUZUUnl4UlFVRlVMRU5CUVd0Q0xFZEJRV3hDTEVOQlFYaENMRVZCUVdkRU8wRkJReTlETEZGQlFVbFBMRk5CUVZOV0xFMUJRVTBzUTBGQlRpeE5RVUZoVGl4SFFVRmlMRWRCUVcxQ0xFMUJRVzVDTEVkQlFUUkNUU3hOUVVGTkxFTkJRVTRzUTBGQmVrTTdRVUZEUVVFc1dVRkJVVW9zVVVGQlVXTXNVMEZCVXl4TFFVRlVMRWRCUVdsQ1ZpeE5RVUZOTEVOQlFVNHNRMEZCZWtJc1EwRkJVanRCUVVOQk96dEJRVVZFTzBGQlEwRXNUVUZCU1VFc1RVRkJUU3hEUVVGT0xFVkJRVk5ITEZGQlFWUXNRMEZCYTBJc1IwRkJiRUlzUTBGQlNpeEZRVUUwUWp0QlFVTXpRa2dzVlVGQlRTeERRVUZPTEVsQlFWZEJMRTFCUVUwc1EwRkJUaXhKUVVGWExFdEJRVmdzUjBGQmJVSkJMRTFCUVUwc1EwRkJUaXhEUVVFNVFqdEJRVU5CUVN4VlFVRk5MRU5CUVU0c1NVRkJWMEVzVFVGQlRTeERRVUZPTEVWQlFWTlhMRTFCUVZRc1EwRkJaMEpZTEUxQlFVMHNRMEZCVGl4RlFVRlRXU3hQUVVGVUxFTkJRV2xDTEVkQlFXcENMRWxCUVhkQ0xFTkJRWGhETEVOQlFWZzdRVUZEUnl4SFFYSkRNRUlzUTBGeFEzaENPenM3TzBGQlNVd3NUVUZCU1ZJc1UwRkJVenRCUVVOWVF5eFZRVUZOVEN4TlFVRk5MRU5CUVU0c1EwRkVTenRCUVVWWVRTeFpRVUZSVGl4TlFVRk5MRU5CUVU0c1EwRkdSenRCUVVkWVR5eGpRVUZWVUN4TlFVRk5MRU5CUVU0N1FVRklReXhIUVVGaU96dEJRVTFCTEZOQlFVOUpMRTFCUVZBN1FVRkRSRHM3UVVGRlRTeFRRVUZUYUVJc1YwRkJWQ3hEUVVGeFFubENMRXRCUVhKQ0xFVkJRVFJDTzBGQlEycERMRTFCUVVsRExGbEJRVmxFTEUxQlFVMUVMRTlCUVU0c1EwRkJZeXhIUVVGa0xFTkJRV2hDT3p0QlFVVkJMRTFCUVVsU0xGTkJRVk03UVVGRFdGY3NZMEZCVlVZc1RVRkJUVWNzVTBGQlRpeERRVUZuUWl4RFFVRm9RaXhGUVVGdFFrWXNVMEZCYmtJc1EwRkVRenRCUVVWWVVpeFpRVUZSVHl4TlFVRk5SeXhUUVVGT0xFTkJRV2RDUml4WlFVRlpMRU5CUVRWQ0xFVkJRU3RDUkN4TlFVRk5TU3hOUVVGeVF6dEJRVVpITEVkQlFXSTdPMEZCUzBFc1UwRkJUMklzVFVGQlVEdEJRVU5FT3p0QlFVVkVPenM3T3p0QlFVdFBMRk5CUVZObUxGZEJRVlFzUTBGQmNVSTJRaXhOUVVGeVFpeEZRVUUyUWp0QlFVTnNReXhUUVVGUExHOUNRVUZaUVN4TlFVRmFMRVZCUVc5Q1JDeE5RVUZ3UWl4SFFVRTJRaXhEUVVFM1FpeEhRVUZwUXl4TFFVRnFReXhIUVVGNVF5eEpRVUZvUkR0QlFVTkVPenRCUVVWRU96czdPenRCUVV0UExGTkJRVk16UWl4VFFVRlVMRU5CUVcxQ05rSXNSMEZCYmtJc1JVRkJkMEk3UVVGRE4wSTdRVUZEUVN4TlFVRkpRU3hIUVVGS0xFVkJRVk1zVDBGQlQwTXNTMEZCUzBNc1MwRkJUQ3hEUVVGWExIbENRVUZsUml4SFFVRm1MRU5CUVZnc1EwRkJVRHRCUVVOV096dEJRVVZFT3pzN096dEJRVXRQTEZOQlFWTTFRaXh0UWtGQlZDeERRVUUyUWl0Q0xGTkJRVGRDTEVWQlFYZERPMEZCUXpkRExFMUJRVWxTTEZsQlFWbFJMRlZCUVZWV0xFOUJRVllzUTBGQmEwSXNSMEZCYkVJc1EwRkJhRUk3UVVGRFFTeFRRVUZQTEZsQlFWbFZMRlZCUVZWT0xGTkJRVllzUTBGQmIwSkdMRmxCUVZrc1EwRkJhRU1zUlVGQmJVTlJMRlZCUVZWTUxFMUJRVGRETEVOQlFWb3NSMEZCYlVVc1IwRkJia1VzUjBGQmVVVkxMRlZCUVZWT0xGTkJRVllzUTBGQmIwSXNRMEZCY0VJc1JVRkJkVUpHTEZOQlFYWkNMRU5CUVdoR08wRkJRMFE3TzBGQlJVUTdPenM3TzBGQlMwOHNVMEZCVTNSQ0xHMUNRVUZVTEVOQlFUWkNLMElzVDBGQk4wSXNSVUZCYzBNN1FVRkRNME1zVFVGQlNUZENMRTFCUVUxUUxGVkJRVlZ2UXl4UFFVRldMRU5CUVZZN1FVRkRRU3hUUVVGUE4wSXNTVUZCU1dFc1VVRkJTaXhEUVVGaFRpeFBRVUZpTEVOQlFYRkNMRWRCUVhKQ0xFVkJRVEJDTEVWQlFURkNMRWxCUVdkRExFZEJRV2hETEVkQlFYTkRVQ3hKUVVGSldTeE5RVUZxUkN4RFFVWXlReXhEUVVWak8wRkJRekZFT3p0QlFVZEVPenM3T3p0QlFVdFBMRk5CUVZOaUxHZENRVUZVTEVOQlFUQkNLMElzVlVGQk1VSXNSVUZCYzBNN08wRkJSVE5ETzBGQlEwRXNUVUZCU1VFc1YwRkJWMUlzVTBGQldDeERRVUZ4UWl4RFFVRnlRaXhGUVVGM1FpeERRVUY0UWl4TlFVRXJRaXhUUVVGdVF5eEZRVUU0UXp0QlFVTTFReXhSUVVGSlV5eGhRVUZoZEVNc1ZVRkJWWEZETEZWQlFWWXNRMEZCYWtJN08wRkJSVUU3UVVGRFFTeFJRVUZKUXl4WFFVRlhia0lzVFVGQldDeEpRVUZ4UW0xQ0xGZEJRVmRzUWl4UlFVRndReXhGUVVFNFF6dEJRVU0xUXl4aFFVRlBhVUlzVlVGQlVEdEJRVU5FTEV0QlJrUXNUVUZGVHp0QlFVTk1MRmxCUVUwc01rSkJRVTQ3UVVGRFJEczdRVUZGU0R0QlFVTkRMRWRCV0VRc1RVRlhUenRCUVVOTUxGZEJRVTlxUXl4dlFrRkJiMEpwUXl4VlFVRndRaXhEUVVGUU8wRkJRMFE3UVVGRFJpeERPenM3T3pzN096czdPenM3T3p0QlEyNUxSRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRXRCUVVzN1FVRkRURHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4cFJVRkJhVVVzTUVSQlFUQkVMRVZCUVVVN1FVRkROMGc3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTERaRVFVRTJSQ3d5UkVGQk1rUTdRVUZEZUVnc2NVUkJRWEZFTERKRVFVRXlSRHRCUVVOb1NEdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEdsRlFVRnBSVHRCUVVOcVJUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMSGRDUVVGM1FpeHpRMEZCYzBNN1FVRkRPVVE3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQkxIbENRVUY1UWl3MFJFRkJORVE3UVVGRGNrWTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRU3gzUWtGQmQwSXNLME5CUVN0RE8wRkJRM1pGTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc2QwSkJRWGRDTEhGRlFVRnhSVHRCUVVNM1JqdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVN4M1FrRkJkMElzZFVOQlFYVkRPMEZCUXk5RU8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1VVRkJVVHRCUVVOU08wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc2VVTkJRWGxETzBGQlEzcERPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEhkQ1FVRjNRanRCUVVONFFqdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1VVRkJVVHRCUVVOU0xHbEZPMEZCUTBFc2QwUkJRWGRFTERaSFFVRTJSeXhGUVVGRk8wRkJRM1pMTzBGQlEwRTdRVUZEUVR0QlFVTkJMRTlCUVU4N1FVRkRVRHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVRzN1FVRkZRVHM3UVVGRlFUdEJRVU5CTEdGQlFXRTdRVUZEWWpzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFc1NVRkJTVHRCUVVOS096dEJRVVZCT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPenRCUVVWQkxIRkNRVUZ4UWl4clIwRkJhMGM3UVVGRGRrZzdRVUZEUVR0QlFVTkJMRTFCUVUwN1FVRkRUaXhMUVVGTE8wRkJRMHc3UVVGRFFUdEJRVU5CTzBGQlEwRTdPMEZCUlVFc2IwSkJRVzlDTEcxSFFVRnRSenRCUVVOMlNEdEJRVU5CTEUxQlFVMDdRVUZEVGp0QlFVTkJPMEZCUTBFN1FVRkRRVHM3UVVGRlFTdzBSRHRCUVVOQk8wRkJRMEU3TzBGQlJVRXNhMEpCUVd0Q0xHOUpRVUZ2U1R0QlFVTjBTanRCUVVOQkxFbEJRVWs3UVVGRFNqdEJRVU5CTEVkQlFVYzdRVUZEU0R0QlFVTkJPMEZCUTBFc1EwRkJRenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN08wRkRkbEZFT3pzN08wRkJRMEU3T3pzN096dEJRWGhDUVRzN096czdPenM3T3pzN096czdPenM3T3pzN096czdRVUV3UWtFc1NVRkJTVVVzWVVGQllTeEZRVUZEUXl4TFFVRkxMRXRCUVU0c1JVRkJZVU1zVDBGQlR5eFBRVUZ3UWl4RlFVRTJRa01zVDBGQlR5eFBRVUZ3UXl4RlFVRnFRanM3UVVGRlFUczdPenM3U1VGSlRVTXNhMEk3T3p0QlFVTktPenM3T3pzN1FVRlBRVHM3T3pzN1FVRkxRVHRCUVVOQkxEaENRVUZaUXl4UFFVRmFMRVZCUVhGQ2NrTXNSMEZCY2tJc1JVRkJNRUp6UXl4TlFVRXhRaXhGUVVGclEwTXNZVUZCYkVNc1JVRkJhVVJETEZkQlFXcEVMRVZCUVRoRVF5eFRRVUU1UkN4RlFVRjVSVU1zWTBGQmVrVXNSVUZCZVVaRExFMUJRWHBHTEVWQlFXbEhPMEZCUVVFN08wRkJRVUVzSzBwQlEzcEdUaXhQUVVSNVJpeEZRVU5vUm5KRExFZEJSR2RHTEVWQlF6TkZjME1zVFVGRU1rVXNSVUZEYmtWRExHRkJSRzFGTEVWQlEzQkVReXhaUVVGWlNTeEpRVVIzUXl4RlFVTnNRMGdzVTBGRWEwTXNSVUZEZGtKRkxFMUJSSFZDT3p0QlFVVXZSaXhSUVVGSlJTeGpRVUZLT3p0QlFVVkJRU3hWUVVGTlF5eFJRVUZPTEVkQlFXbENTaXhqUVVGcVFqdEJRVU5CUnl4VlFVRk5SU3hSUVVGT0xFZEJRV2xDTEVWQlFXcENPenRCUVVWQlJpeFZRVUZOUnl4UlFVRk9MRU5CUVdWRExFOUJRV1lzUTBGQmRVSXNWVUZCUTBNc1MwRkJSQ3hGUVVGWE8wRkJRMmhEVEN4WlFVRk5UU3hUUVVGT0xFTkJRV2RDUkN4TFFVRm9RanRCUVVORUxFdEJSa1E3TzBGQlNVRTdRVUZEUVN4M1FrRkJXVllzV1VGQldVTXNVMEZCZUVJc1JVRkJiVU5YTEU5QlFXNURMRU5CUVRKRExGVkJRVU5ETEU5QlFVUXNSVUZCWVR0QlFVTjBSQ3hWUVVGSlF5eFpRVUZaWkN4WlFVRlpReXhUUVVGYUxFTkJRWE5DV1N4UFFVRjBRaXhEUVVGb1FqdEJRVU5CVWl4WlFVRk5WU3huUWtGQlRpeERRVUYxUWtZc1QwRkJka0lzU1VGQmEwTXNPRUpCUVc5Q1VpeExRVUZ3UWl4RlFVRXlRbEVzVDBGQk0wSXNSVUZCYjBORExGTkJRWEJETEVOQlFXeERPMEZCUTBRc1MwRklSRHM3UVVGTFFWUXNWVUZCVFZjc2EwSkJRVTQ3UVVGcVFpdEdPMEZCYTBKb1J6czdPenQ1UTBGRmIwSTdRVUZEYmtJN1FVRkRRU3hWUVVGSldDeFJRVUZSTEVsQlFWbzdPMEZCUlVGQkxGbEJRVTFaTEdWQlFVNHNSMEZCZDBKYUxFMUJRVTFoTEVsQlFVNHNRMEZCVjBNc1YwRkJXQ3hEUVVGMVFtUXNUVUZCVFdVc1NVRkJUaXhIUVVGaExGVkJRWEJETEVWQlFXZEVMRlZCUVVORExFZEJRVVFzUlVGQlV6dEJRVU12UlN4WlFVRkpRU3hKUVVGSmJFUXNTVUZCU2l4TFFVRmhMRkZCUVdwQ0xFVkJRVEpDTzBGQlEzcENSeXhyUWtGQlVXZEVMRWRCUVZJc1EwRkJXU3gzUWtGQmQwSnFRaXhOUVVGTlpTeEpRVUU1UWl4SFFVRnhReXhSUVVGcVJDeEZRVUV5UkVNc1IwRkJNMFE3UVVGRFFXaENMR2RDUVVGTmEwSXNZVUZCVGl4RFFVRnZRbXhDTEUxQlFVMUhMRkZCUVRGQ0xFVkJRVzlEWVN4SFFVRndRenRCUVVORU8wRkJRMFlzVDBGTWRVSXNRMEZCZUVJN1FVRk5SRHM3TzNkRFFVVnRRanRCUVVOc1FqdEJRVU5CTEZWQlFVbG9RaXhSUVVGUkxFbEJRVm83TzBGQlJVRkJMRmxCUVUxWkxHVkJRVTRzUTBGQmMwSlBMRTFCUVhSQ08wRkJRMFE3TzBGQlJVUTdPenM3T3pzNFFrRkhVenRCUVVOUUxGVkJRVWx1UWl4UlFVRlJMRWxCUVZvN08wRkJSVUZCTEZsQlFVMXZRaXhwUWtGQlRqdEJRVU5CTEdGQlFVOXdRaXhOUVVGTmNVSXNVVUZCVGl4RFFVRmxReXhWUVVGbUxFTkJRVEJDZEVJc1RVRkJUV1VzU1VGQmFFTXNRMEZCVUR0QlFVTkVPenRCUVVWRU96czdPenM3YTBOQlIyTTdRVUZEV2l4VlFVRkpaaXhSUVVGUkxFbEJRVm83TzBGQlJVRTdRVUZEUVN4VlFVRkpkVUlzYVVKQlFXbENPMEZCUTI1Q2VrUXNZMEZCVFN4aFFVUmhMRVZCUTBVd1JDeE5RVUZOZUVJc1RVRkJUWGxDTEUxQlJHUXNSVUZEYzBKRExFbEJRVWt4UWl4TlFVRk5jVUlzVVVGQlRpeERRVUZsVFN4UFFVUjZRenRCUVVWdVFrTXNZMEZCVFN4RlFVRkZReXhWUVVGVk4wSXNUVUZCVFdVc1NVRkJiRUk3UVVGR1lTeFBRVUZ5UWpzN1FVRkxRV1lzV1VGQlRXRXNTVUZCVGl4RFFVRlhhVUlzVjBGQldDeERRVUYxUWxBc1kwRkJka0lzUlVGQmRVTXNWVUZCUTFFc1MwRkJSQ3hGUVVGWE8wRkJRMmhFT1VRc1owSkJRVkZuUkN4SFFVRlNMRU5CUVZrc2EwTkJRVm9zUlVGQlowUmpMRXRCUVdoRU8wRkJRMEVzV1VGQlNVRXNUVUZCVFVnc1NVRkJUaXhEUVVGWFNTeEpRVUZZTEV0QlFXOUNMRWRCUVhoQ0xFVkJRVFpDTzBGQlF6TkNhRU1zWjBKQlFVMXZRaXhwUWtGQlRqdEJRVU5CTEdsQ1FVRlBjRUlzVFVGQlRYRkNMRkZCUVU0c1EwRkJaVU1zVlVGQlppeERRVUV3UW5SQ0xFMUJRVTFsTEVsQlFXaERMRU5CUVZBN1FVRkRSRHRCUVVOR0xFOUJUa1E3UVVGUFJEczdRVUZGUkRzN096czdPenM3TmtKQlMxTnJRaXhOTEVWQlFWRkRMRkVzUlVGQlZUdEJRVU42UWl4VlFVRkpReXhOUVVGTlJpeE5RVUZXTzBGQlEwRXNWVUZCU1Vjc1dVRkJXVHRCUVVOa2RFVXNZMEZCVFhGQ0xGZEJRVmRITEV0QlJFZzdRVUZGWkRSRExHdENRVUZWUVR0QlFVWkpMRTlCUVdoQ096dEJRVXRCTEZWQlFVbEhMRTFCUVUxS0xFOUJRVTgxUkN4UFFVRlFMRU5CUVdVc1IwRkJaaXhEUVVGV08wRkJRMEVzVlVGQlNXZEZMRkZCUVZGS0xFOUJRVTkyUkN4TlFVRlFMRWRCUVdkQ0xFTkJRVFZDTEVWQlFTdENPMEZCUXpkQ0xGbEJRVWt5UkN4UlFVRlJMRU5CUVZvc1JVRkJaVHRCUVVOaVJDeHZRa0ZCVlhSRkxFbEJRVllzUjBGQmFVSnhRaXhYUVVGWFF5eEhRVUUxUWp0QlFVTkVMRk5CUmtRc1RVRkZUenRCUVVOTVowUXNiMEpCUVZWMFJTeEpRVUZXTEVkQlFXbENjVUlzVjBGQlYwVXNTMEZCTlVJN1FVRkRRVGhETEdkQ1FVRk5SaXhQUVVGUE4wUXNUVUZCVUN4RFFVRmpMRU5CUVdRc1JVRkJhVUkyUkN4UFFVRlBka1FzVFVGQlVDeEhRVUZuUWl4RFFVRnFReXhEUVVGT08wRkJRMFE3UVVGRFJqczdRVUZGUkN4WFFVRkxkMElzVVVGQlRDeERRVUZqYVVNc1IwRkJaQ3hKUVVGeFFrTXNVMEZCY2tJN1FVRkRSRHM3T3poQ1FVVlRMMElzU3l4RlFVRlBPMEZCUTJZc1ZVRkJTVXdzVVVGQlVTeEpRVUZhT3p0QlFVVkJMREJDUVVGWlFTeE5RVUZOUlN4UlFVRnNRaXhGUVVFMFFrc3NUMEZCTlVJc1EwRkJiME1zVlVGQlF6UkNMRWRCUVVRc1JVRkJVenRCUVVNelF5eFpRVUZKUml4VFFVRlRha01zVFVGQlRVVXNVVUZCVGl4RFFVRmxhVU1zUjBGQlppeERRVUZpTzBGQlEwRXNXVUZCU1VZc1QwRkJUMjVGTEVsQlFWQXNTMEZCWjBKeFFpeFhRVUZYUXl4SFFVRXZRaXhGUVVGdlF6dEJRVU5zUXp0QlFVTkJOa01zYVVKQlFVOURMRkZCUVZBc1EwRkJaMEkzUWl4TFFVRm9RanRCUVVORUxGTkJTRVFzVFVGSFR5eEpRVUZKTkVJc1QwRkJUMjVGTEVsQlFWQXNTMEZCWjBKeFFpeFhRVUZYUlN4TFFVRXZRaXhGUVVGelF6dEJRVU16UXp0QlFVTkJMR05CUVVsblFpeE5RVUZOYVVNc1MwRkJUaXhEUVVGWmFrVXNUMEZCV2l4RFFVRnZRamhFTEVkQlFYQkNMRTFCUVRaQ0xFTkJRV3BETEVWQlFXOURPMEZCUTJ4RFJpeHRRa0ZCVDBNc1VVRkJVQ3hEUVVGblFqZENMRXRCUVdoQ08wRkJRMFE3UVVGRFJpeFRRVXhOTEUxQlMwRXNTVUZCU1RSQ0xFOUJRVTl1UlN4SlFVRlFMRXRCUVdkQ2NVSXNWMEZCVjBjc1MwRkJMMElzUlVGQmMwTTdRVUZETTBNN1FVRkRRU3hqUVVGSlpTeE5RVUZOYVVNc1MwRkJUaXhMUVVGblFrZ3NSMEZCY0VJc1JVRkJlVUk3UVVGRGRrSkdMRzFDUVVGUFF5eFJRVUZRTEVOQlFXZENOMElzUzBGQmFFSTdRVUZEUkR0QlFVTkdPMEZCUTBZc1QwRm9Ra1E3UVVGcFFrUTdPenQxUWtGcVNYbERMREpDT3p0clFrRnZTVGRDWkN4clFqczdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3TzBGRE4wbG1PenM3TzBGQlEwRTdPenM3UVVGRlFUczdPenRCUVRGQ1FUczdPenM3T3pzN096czdPenM3T3pzN096czdPenM3U1VFNFFrMW5SQ3hyUWpzN08wRkJRMG83T3pzN096czdPMEZCVTBFN096czdRVUZKUVN3NFFrRkJXUzlETEU5QlFWb3NSVUZCY1VKeVF5eEhRVUZ5UWl4RlFVRXdRbk5ETEUxQlFURkNMRVZCUVd0RFF5eGhRVUZzUXl4RlFVRnBSRU1zVjBGQmFrUXNSVUZCT0VSRExGTkJRVGxFTEVWQlFYbEZPMEZCUVVFN08wRkJRVUVzSzBwQlEycEZTaXhQUVVScFJTeEZRVU40UkhKRExFZEJSSGRFTEVWQlEyNUVjME1zVFVGRWJVUXNSVUZETTBORExHRkJSREpETEVWQlF6VkNReXhYUVVRMFFpeEZRVU5tUXl4VFFVUmxPenRCUVVWMlJTeFJRVUZKU1N4alFVRktPenRCUVVWQlFTeFZRVUZOZDBNc1kwRkJUaXhIUVVGMVFpeEZRVUYyUWpzN1FVRkZRWGhETEZWQlFVMUhMRkZCUVU0c1EwRkJaVU1zVDBGQlppeERRVUYxUWl4VlFVRkRReXhMUVVGRUxFVkJRVmM3UVVGRGFFTndReXhqUVVGUlowUXNSMEZCVWl4RFFVRlpMSGRDUVVGM1FqbEVMRWRCUVhoQ0xFZEJRVGhDTEZOQlFURkRMRVZCUVhGRWEwUXNTMEZCY2tRN1FVRkRRVXdzV1VGQlRYbERMRk5CUVU0c1EwRkJaMEp3UXl4TFFVRm9RanRCUVVORUxFdEJTRVE3TzBGQlMwRk1MRlZCUVUxWExHdENRVUZPTzBGQldIVkZPMEZCV1hoRk96czdPM2xEUVVWdlFqdEJRVU51UWp0QlFVTkJMRlZCUVVsWUxGRkJRVkVzU1VGQldqczdRVUZGUVVFc1dVRkJUVEJETEdWQlFVNHNSMEZCZDBJeFF5eE5RVUZOWVN4SlFVRk9MRU5CUVZkRExGZEJRVmdzUTBGQmRVSmtMRTFCUVUxbExFbEJRVGRDTEVWQlFXMURMRlZCUVVORExFZEJRVVFzUlVGQlV6dEJRVU5zUlM5RExHZENRVUZSWjBRc1IwRkJVaXhEUVVGWkxHZENRVUZuUW1wQ0xFMUJRVTFsTEVsQlFYUkNMRWRCUVRaQ0xGRkJRWHBETEVWQlFXMUVReXhIUVVGdVJEdEJRVU5CTEdkQ1FVRlJRU3hKUVVGSmJFUXNTVUZCV2p0QlFVTkZMR1ZCUVVzc1ZVRkJURHRCUVVGcFFtdERMR3RDUVVGTk1rTXNWMEZCVGl4RFFVRnJRak5DTEVkQlFXeENMRVZCUVhkQ08wRkJRM3BETEdWQlFVc3NUVUZCVER0QlFVRmhhRUlzYTBKQlFVMDBReXhQUVVGT0xFTkJRV00xUWl4SFFVRmtMRVZCUVc5Q08wRkJSbTVETzBGQlNVUXNUMEZPZFVJc1EwRkJlRUk3UVVGUFJEczdPM2REUVVWdFFqdEJRVU5zUWp0QlFVTkJMRlZCUVVsb1FpeFJRVUZSTEVsQlFWbzdPMEZCUlVGQkxGbEJRVTB3UXl4bFFVRk9MRU5CUVhOQ2RrSXNUVUZCZEVJN1FVRkRSRHM3UVVGRlJEczdPenM3T3p0dlEwRkpaMEl3UWl4VExFVkJRVmM3UVVGRGVrSXNWVUZCU1RkRExGRkJRVkVzU1VGQldqczdRVUZGUVR0QlFVTkJMRlZCUVVrNFF5eFpRVUZaTzBGQlEyUm9SaXhqUVVGTkxGRkJSRkVzUlVGRFJUQkVMRTFCUVUxNFFpeE5RVUZOY1VJc1VVRkJUaXhEUVVGbFNTeE5RVVIyUWl4RlFVTXJRa01zU1VGQlNURkNMRTFCUVUxeFFpeFJRVUZPTEVOQlFXVk5MRTlCUkd4RU8wRkJSV1JETEdOQlFVMHNSVUZCUlcxQ0xGRkJRVkVzUzBGQlZpeEZRVUZwUW14Q0xGVkJRVlUzUWl4TlFVRk5aU3hKUVVGcVF5eEZRVUYxUTNSQ0xGRkJRVkZQTEUxQlFVMW5SQ3hQUVVGeVJDeEZRVUU0UkRGR0xFOUJRVTh3UXl4TlFVRk5SeXhSUVVGT0xFTkJRV1ZLTEVsQlFYQkdMRVZCUVRCR2EwUXNWMEZCVjBvc1UwRkJja2M3UVVGR1VTeFBRVUZvUWpzN1FVRkxRVGRETEZsQlFVMWhMRWxCUVU0c1EwRkJWMmxDTEZkQlFWZ3NRMEZCZFVKblFpeFRRVUYyUWp0QlFVTkVPenRCUVVWRU96czdPenM3T0VKQlIxTTdRVUZEVUN4VlFVRkpPVU1zVVVGQlVTeEpRVUZhT3p0QlFVVkJPMEZCUTBFc1ZVRkJTV3RFTEZsQlFWazdRVUZEWkhCR0xHTkJRVTBzVVVGRVVTeEZRVU5GTUVRc1RVRkJUWGhDTEUxQlFVMTVRaXhOUVVSa0xFVkJRM05DUXl4SlFVRkpNVUlzVFVGQlRYRkNMRkZCUVU0c1EwRkJaVTBzVDBGRWVrTTdRVUZGWkVNc1kwRkJUU3hGUVVGRlF5eFZRVUZWTjBJc1RVRkJUV1VzU1VGQmJFSTdRVUZHVVN4UFFVRm9RanM3UVVGTFFXWXNXVUZCVFdFc1NVRkJUaXhEUVVGWGFVSXNWMEZCV0N4RFFVRjFRbTlDTEZOQlFYWkNMRVZCUVd0RExGVkJRVU51UWl4TFFVRkVMRVZCUVZjN1FVRkRNME01UkN4blFrRkJVV2RFTEVkQlFWSXNRMEZCV1N3MlFrRkJXaXhGUVVFeVEyTXNTMEZCTTBNN1FVRkRRU3haUVVGSlFTeE5RVUZOU0N4SlFVRk9MRU5CUVZkSkxFbEJRVmdzUzBGQmIwSXNSMEZCZUVJc1JVRkJOa0k3UVVGRE0wSm9ReXhuUWtGQlRXOUNMR2xDUVVGT08wRkJRMEVzYVVKQlFVOXdRaXhOUVVGTmNVSXNVVUZCVGl4RFFVRmxPRUlzVlVGQlppeERRVUV3UW01RUxFMUJRVTFsTEVsQlFXaERMRU5CUVZBN1FVRkRSRHRCUVVOR0xFOUJUa1E3UVVGUFJEczdRVUZGUkRzN096czdPenM3TzBGQlRVRTdPenM3YlVOQlNXVnRRaXhSTEVWQlFWVTdRVUZEZGtJc1YwRkJTMnRDTEhOQ1FVRk1MRWRCUVRoQ2JFSXNVVUZCT1VJN1FVRkRSRHM3UVVGRlJEczdPenM3T3pzclFrRkpWMEVzVVN4RlFVRlZPMEZCUTI1Q0xGZEJRVXR0UWl4clFrRkJUQ3hIUVVFd1FtNUNMRkZCUVRGQ08wRkJRMFE3TzBGQlJVUTdPenM3T3pzN01rSkJTVTlCTEZFc1JVRkJWVHRCUVVObUxGZEJRVXR2UWl4alFVRk1MRWRCUVhOQ2NFSXNVVUZCZEVJN1FVRkRSRHM3UVVGRlJEczdPenNyUWtGRFYyeENMRWNzUlVGQlN6dEJRVU5rTEZWQlFVbG9RaXhSUVVGUkxFbEJRVm83TzBGQlJVRXZRaXhqUVVGUlowUXNSMEZCVWl4RFFVRlpMREJDUVVGYUxFVkJRWGREUkN4SFFVRjRRenRCUVVOQkxHTkJRVkZCTEVsQlFVbFpMRWxCUVVvc1EwRkJVemxFTEVsQlFXcENPMEZCUTBVc1lVRkJTeXhYUVVGTU8wRkJRV3RDYTBNc1owSkJRVTExUkN4WlFVRk9MRU5CUVcxQ2RrTXNSMEZCYmtJc1JVRkJlVUk3UVVGRE0wTXNZVUZCU3l4aFFVRk1PMEZCUVc5Q2FFSXNaMEpCUVUxM1JDeGpRVUZPTEVOQlFYRkNlRU1zUjBGQmNrSXNSVUZCTWtJN1FVRkdha1E3UVVGSlJEczdRVUZGUkRzN096dHBRMEZEWVVFc1J5eEZRVUZMTzBGQlFVRTdPMEZCUTJoQ0xGVkJRVWxvUWl4UlFVRlJMRWxCUVZvN1FVRkRRU3hWUVVGSmVVUXNZVUZCWVhwRExFbEJRVWxaTEVsQlFVb3NRMEZCVTBvc1NVRkJNVUk3UVVGRFFYWkVMR05CUVZGblJDeEhRVUZTTEVOQlFWa3NiVU5CUVZvc1JVRkJhVVJFTEVkQlFXcEVPenRCUVVWQkxGVkJRVWxZTEZGQlFWRTdRVUZEVm5aRExHTkJRVTFyUkN4SlFVRkpXU3hKUVVGS0xFTkJRVk01UkN4SlFVUk1PMEZCUlZaWUxHRkJRVXR6Unl4VlFVWkxPenRCUVVsV2VrWXNhMEpCUVZWblJDeEpRVUZKV1N4SlFVRktMRU5CUVZNMVJDeFJRVXBVT3p0QlFVMVdNRVlzWjBKQlFWRXNhMEpCUVUwN1FVRkRXanRCUVVOQkxHTkJRVWxETEUxQlFVMHNSVUZCUlhoSExFdEJRVXR6Unl4VlFVRlFMRVZCUVcxQ1J5eFJRVUZSTEVsQlFUTkNMRVZCUVZZN1FVRkRRVFZFTEdkQ1FVRk5kME1zWTBGQlRpeERRVUZ4UW1sQ0xGVkJRWEpDTEVsQlFXMURSU3hIUVVGdVF6czdRVUZGUVR0QlFVTkJMR05CUVVsRkxHbENRVUZwUWl4RlFVRnlRanRCUVVOQkxEaENRVUZaTjBRc1RVRkJUVlVzWjBKQlFXeENMRVZCUVc5RFNDeFBRVUZ3UXl4RFFVRTBReXhWUVVGRFF5eFBRVUZFTEVWQlFXRTdRVUZEZGtRc1owSkJRVWxETEZsQlFWbFVMRTFCUVUxVkxHZENRVUZPTEVOQlFYVkNSaXhQUVVGMlFpeEZRVUZuUTFRc1NVRkJhRVE3UVVGRFFUaEVMREpDUVVGbGNrUXNUMEZCWml4SlFVRXdRaXh6UWtGQlZVTXNVMEZCVml4RFFVRXhRanRCUVVORUxGZEJTRVE3TzBGQlMwRXNZMEZCU1hGRUxGVkJRVlU3UVVGRFdrTXNaMEpCUVVrdlF5eEpRVUZKSzBNc1JVRkVTU3hGUVVOQmFrY3NUVUZCVFN4VlFVUk9MRVZCUTJ0Q01FUXNUVUZCVFZJc1NVRkJTVlVzUlVGRU5VSXNSVUZEWjBOQkxFbEJRVWxXTEVsQlFVbFJMRWxCUkhoRE8wRkJSVnBKTEd0Q1FVRk5MRVZCUVVWSkxFMUJRVTBzUjBGQlVpeEZRVUZoZGtNc1VVRkJVVThzVFVGQlRXZEVMRTlCUVROQ0xFVkJRVzlEWjBJc1UwRkJVMmhGTEUxQlFVMURMRkZCUVc1RUxFVkJRVFpFTTBNc1QwRkJUeXhGUVVGRmVVTXNUVUZCVFN4elFrRkJWVU1zVFVGQlRVUXNTVUZCYUVJc1EwRkJVaXhGUVVFclFrZ3NWMEZCVjJsRkxHTkJRVEZETEVWQlFYQkZPMEZCUmswc1YwRkJaRHM3UVVGTFFUdEJRVU5CTEdOQlFVazNReXhKUVVGSldTeEpRVUZLTEVOQlFWTnhReXhqUVVGVUxFTkJRWGRDTEhOQ1FVRjRRaXhMUVVGdFJDeERRVUZEYWtRc1NVRkJTVmtzU1VGQlNpeERRVUZUYzBNc2IwSkJRV3BGTEVWQlFYVkdPMEZCUTNKR1NpeHZRa0ZCVVd4RExFbEJRVklzUTBGQllYTkRMRzlDUVVGaUxFZEJRVzlETEU5QlFVdERMSEZDUVVGNlF6dEJRVU5CTEcxQ1FVRkxRU3h4UWtGQlRDeEhRVUUyUW01RUxFbEJRVWxaTEVsQlFVb3NRMEZCVTNORExHOUNRVUYwUXp0QlFVTkVPenRCUVVWRU8wRkJRMEZzUlN4blFrRkJUV0VzU1VGQlRpeERRVUZYYVVJc1YwRkJXQ3hEUVVGMVFtZERMRTlCUVhaQ096dEJRVVZCTEdsQ1FVRlBTQ3hIUVVGUU8wRkJRMFFzVTBGcVExTTdPMEZCYlVOV1V5eG5Ra0ZCVVN4blFrRkJRME1zVFVGQlJDeEZRVUZaTzBGQlEyeENPMEZCUTBGeVJTeG5Ra0ZCVFdFc1NVRkJUaXhEUVVGWGFVSXNWMEZCV0N4RFFVRjFRanRCUVVOeVFtbERMR2RDUVVGSkwwTXNTVUZCU1N0RExFVkJSR0VzUlVGRFZHcEhMRTFCUVUwc1ZVRkVSeXhGUVVOVE1FUXNUVUZCVFZJc1NVRkJTVlVzUlVGRWJrSXNSVUZEZFVKQkxFbEJRVWxXTEVsQlFVbFJMRWxCUkM5Q08wRkJSWEpDU1N4clFrRkJUU3hGUVVGRlNTeE5RVUZOTEVkQlFWSXNSVUZCWVhORExFMUJRVTFFTEUxQlFXNUNPMEZCUm1Vc1YwRkJka0k3UVVGSlJEdEJRWHBEVXl4UFFVRmFPenRCUVRSRFFTeFZRVUZKY2tVc1RVRkJUVzlFTEhOQ1FVRldMRVZCUVd0RE8wRkJRMmhEYmtZc1owSkJRVkZuUkN4SFFVRlNMRU5CUVZrc2MwSkJRVm9zUlVGQmIwTmFMRXRCUVhCRE8wRkJRMEZNTEdOQlFVMXZSQ3h6UWtGQlRpeERRVUUyUWk5RExFdEJRVGRDTzBGQlEwUTdRVUZEUmpzN1FVRkZSRHM3T3p0dFEwRkRaVmNzUnl4RlFVRkxPMEZCUTJ4Q0xGVkJRVWxvUWl4UlFVRlJMRWxCUVZvN1FVRkRRU3hWUVVGSmVVUXNZVUZCWVhwRExFbEJRVWxaTEVsQlFVb3NRMEZCVTBvc1NVRkJNVUk3TzBGQlJVRXNWVUZCU1cxRExFMUJRVTB6UkN4TlFVRk5kME1zWTBGQlRpeERRVUZ4UW1sQ0xGVkJRWEpDTEVOQlFWWTdRVUZEUVN4aFFVRlBla1FzVFVGQlRYZERMR05CUVU0c1EwRkJjVUpwUWl4VlFVRnlRaXhEUVVGUU96dEJRVVZCTEZWQlFVbHdSQ3hSUVVGUk8wRkJRMVoyUXl4alFVRk5hMFFzU1VGQlNWa3NTVUZCU2l4RFFVRlRPVVFzU1VGRVREdEJRVVZXV0N4aFFVRkxjMGNzVlVGR1N6dEJRVWRXT1VVc1owSkJRVkZuUmp0QlFVaEZMRTlCUVZvN08wRkJUVUVzVlVGQlNUTkVMRTFCUVUxdlJDeHpRa0ZCVml4RlFVRnJRenRCUVVOb1EyNUdMR2RDUVVGUlowUXNSMEZCVWl4RFFVRlpMSGxDUVVGYUxFVkJRWFZEV2l4TFFVRjJRenRCUVVOQlRDeGpRVUZOYjBRc2MwSkJRVTRzUTBGQk5rSXZReXhMUVVFM1FqdEJRVU5FTzBGQlEwWTdPMEZCUlVRN096czdaME5CUTFsWExFY3NSVUZCU3p0QlFVTm1MRlZCUVVsb1FpeFJRVUZSTEVsQlFWbzdPMEZCUlVFc1ZVRkJTVXNzVVVGQlVUdEJRVU5XZGtNc1kwRkJUV3RFTEVsQlFVbHNSQ3hKUVVSQk8wRkJSVlpZTEdGQlFVczJSQ3hKUVVGSlVTeEpRVVpETzBGQlIxWlJMR05CUVUxb1FpeEpRVUZKV1N4SlFVRktMRU5CUVZOSk8wRkJTRXdzVDBGQldqczdRVUZOUVN4VlFVRkphRU1zVFVGQlRYRkVMR3RDUVVGV0xFVkJRVGhDTzBGQlF6VkNjRVlzWjBKQlFWRm5SQ3hIUVVGU0xFTkJRVmtzYTBKQlFWb3NSVUZCWjBOYUxFdEJRV2hETzBGQlEwRk1MR05CUVUxeFJDeHJRa0ZCVGl4RFFVRjVRbWhFTEV0QlFYcENPMEZCUTBRN1FVRkRSanM3UVVGRlJEczdPenMwUWtGRFVWY3NSeXhGUVVGTE8wRkJRMWdzVlVGQlNXaENMRkZCUVZFc1NVRkJXanM3UVVGRlFTeFZRVUZKU3l4UlFVRlJPMEZCUTFaMlF5eGpRVUZOYTBRc1NVRkJTV3hFTEVsQlJFRTdRVUZGVmxnc1lVRkJTelpFTEVsQlFVbFJMRWxCUmtNN08wRkJTVlpyUXl4blFrRkJVU3hyUWtGQlRUdEJRVU5hTVVRc1owSkJRVTFoTEVsQlFVNHNRMEZCVjJsQ0xGZEJRVmdzUTBGQmRVSTdRVUZEY2tKcFF5eG5Ra0ZCU1M5RExFbEJRVWtyUXl4RlFVUmhMRVZCUTFScVJ5eE5RVUZOTEZWQlJFY3NSVUZEVXpCRUxFMUJRVTFTTEVsQlFVbFZMRVZCUkc1Q0xFVkJRM1ZDUVN4SlFVRkpWaXhKUVVGSlVTeEpRVVF2UWp0QlFVVnlRa2tzYTBKQlFVMHNSVUZCUlVrc1RVRkJUU3hIUVVGU0xFVkJRV0V4UlN4UFFVRlBMSE5DUVVGVk1FTXNUVUZCVFVRc1NVRkJhRUlzUTBGQmNFSTdRVUZHWlN4WFFVRjJRanRCUVVsRUxGTkJWRk03TzBGQlYxWnhSU3huUWtGQlVTeG5Ra0ZCUTBNc1RVRkJSQ3hGUVVGWk8wRkJRMnhDY2tVc1owSkJRVTFoTEVsQlFVNHNRMEZCVjJsQ0xGZEJRVmdzUTBGQmRVSTdRVUZEY2tKcFF5eG5Ra0ZCU1M5RExFbEJRVWtyUXl4RlFVUmhMRVZCUTFScVJ5eE5RVUZOTEZWQlJFY3NSVUZEVXpCRUxFMUJRVTFTTEVsQlFVbFZMRVZCUkc1Q0xFVkJRM1ZDUVN4SlFVRkpWaXhKUVVGSlVTeEpRVVF2UWp0QlFVVnlRa2tzYTBKQlFVMHNSVUZCUlVrc1RVRkJUU3hIUVVGU0xFVkJRV0Z6UXl4TlFVRk5SQ3hOUVVGdVFqdEJRVVpsTEZkQlFYWkNPMEZCU1VRN1FVRm9RbE1zVDBGQldqczdRVUZ0UWtFc1ZVRkJTWEpGTEUxQlFVMXpSQ3hqUVVGV0xFVkJRVEJDTzBGQlEzaENja1lzWjBKQlFWRm5SQ3hIUVVGU0xFTkJRVmtzWTBGQldpeEZRVUUwUWxvc1MwRkJOVUk3UVVGRFFVd3NZMEZCVFhORUxHTkJRVTRzUTBGQmNVSnFSQ3hMUVVGeVFqdEJRVU5FTzBGQlEwWTdPenQzUWtFMVNtMUNPMEZCUVVVc1lVRkJUeXhMUVVGTGJVTXNZMEZCV2p0QlFVRTJRanM3TzNWQ1FYcEdWQ3d5UWpzN2EwSkJlVkEzUWtRc2EwSTdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenRCUTJoUlpqczdPenRCUVVOQk96czdPMEZCUTBFN096czdRVUZGUVRzN096dEpRVWxOWjBNc1ZUdEJRVU5LT3pzN096czdPenM3T3pzN096dEJRV2xDUVRzN096dEJRVWxCTEhOQ1FVRlpMMFVzVDBGQldpeEZRVUZ4UW5KRExFZEJRWEpDTEVWQlFUQkNjME1zVFVGQk1VSXNSVUZCYTBORExHRkJRV3hETEVWQlFXbEVReXhYUVVGcVJDeEZRVUU0UkVNc1UwRkJPVVFzUlVGQmQwWTdRVUZCUVN4UlFVRm1SU3hOUVVGbExIVkZRVUZPTEVsQlFVMDdRVUZCUVRzN1FVRkRkRVlzVVVGQlNVVXNVVUZCVVN4SlFVRmFPenRCUVVWQlFTeFZRVUZOY1VJc1VVRkJUaXhIUVVGcFFqZENMRTlCUVdwQ08wRkJRMEZSTEZWQlFVMWxMRWxCUVU0c1IwRkJZVFZFTEVkQlFXSTdRVUZEUVRaRExGVkJRVTFuUkN4UFFVRk9MRWRCUVdkQ2RrUXNUVUZCYUVJN1FVRkRRVThzVlVGQlRYZEZMRTlCUVU0c1IwRkJaMEk1UlN4aFFVRm9RanRCUVVOQlRTeFZRVUZOUnl4UlFVRk9MRWRCUVdsQ0xEQkNRVUZsVWl4WFFVRm1MRU5CUVdwQ08wRkJRMEZMTEZWQlFVMTVSU3hWUVVGT0xFZEJRVzFDTjBVc1UwRkJia0k3TzBGQlJVRTdRVUZEUVVrc1ZVRkJUVzFGTEhGQ1FVRk9MRWRCUVRoQ2NrVXNUVUZCT1VJN08wRkJSVUZGTEZWQlFVMURMRkZCUVU0c1IwRkJhVUlzUTBGQmFrSTdRVUZEUVVRc1ZVRkJUVEJGTEZGQlFVNHNSMEZCYVVJc1EwRkJha0k3UVVGRFFURkZMRlZCUVUxVkxHZENRVUZPTEVkQlFYbENMRVZCUVhwQ08wRkJRMEZXTEZWQlFVMHlSU3hyUWtGQlRpeEhRVUV5UWl4RlFVRXpRanM3UVVGRlFUTkZMRlZCUVUxNVFpeE5RVUZPTEVkQlFXVnFReXhSUVVGUmFVTXNUVUZCZGtJN1FVRkRRWHBDTEZWQlFVMWhMRWxCUVU0c1IwRkJZWEpDTEZGQlFWRnhRaXhKUVVGeVFqdEJRVU5FT3pzN08zbERRVVZ2UWp0QlFVRkJPenRCUVVOdVFpeFZRVUZKWWl4UlFVRlJMRWxCUVZvN08wRkJSVUVzVlVGQlNUUkZMR1ZCUVdVMVJTeE5RVUZOWlN4SlFVRk9MRWRCUVdFc1dVRkJhRU03UVVGRFFUbERMR05CUVZGblJDeEhRVUZTTEVOQlFWa3NjME5CUVZvc1JVRkJiMFJxUWl4TlFVRk5lVVVzVlVGQk1VUTdRVUZEUVN4VlFVRkpla1VzVFVGQlRYbEZMRlZCUVZZc1JVRkJjMEk3UVVGRGNFSjZSU3hqUVVGTmVVVXNWVUZCVGl4RFFVRnBRbXhGTEU5QlFXcENMRU5CUVhsQ0xGVkJRVU56UlN4TFFVRkVMRVZCUVZjN1FVRkRiRU1zWTBGQlNVTXNWMEZCVjBZc1pVRkJaVU1zUzBGQk9VSTdRVUZEUVN4alFVRkpSU3hYUVVGWEwwVXNUVUZCVFdFc1NVRkJUaXhEUVVGWFF5eFhRVUZZTEVOQlFYVkNaMFVzVVVGQmRrSXNSVUZCYVVNc1ZVRkJRemxFTEVkQlFVUXNSVUZCVXp0QlFVTjJSRHRCUVVOQkxHZENRVUZKUVN4SlFVRkpVU3hKUVVGS0xFdEJRV0VzVDBGQlMwTXNUVUZCZEVJc1JVRkJPRUk3UVVGRE5VSjRSQ3h6UWtGQlVXZEVMRWRCUVZJc1EwRkJXU3d5UWtGQldpeEZRVUY1UTBRc1IwRkJla003UVVGRFFTeHpRa0ZCVVVFc1NVRkJTV3hFTEVsQlFWbzdRVUZEUlN4eFFrRkJTeXhSUVVGTU8wRkJRV1ZyUXl4M1FrRkJUV2RHTEdOQlFVNHNRMEZCY1VKb1JTeEhRVUZ5UWl4RlFVRXlRanRCUVVNeFF5eHhRa0ZCU3l4UlFVRk1PMEZCUVdVdlF5d3dRa0ZCVVdkRUxFZEJRVklzUTBGQldVUXNSMEZCV2l4RlFVRnJRanRCUVVOcVF6dEJRVUZUYUVJc2QwSkJRVTFwUml4bFFVRk9MRU5CUVhOQ2FrVXNSMEZCZEVJc1JVRkJORUk3UVVGSWRrTTdRVUZMUkR0QlFVTkdMRmRCVm1Nc1EwRkJaanM3UVVGWlFXaENMR2RDUVVGTk1rVXNhMEpCUVU0c1EwRkJlVUpQTEVsQlFYcENMRU5CUVRoQ1NDeFJRVUU1UWp0QlFVTkVMRk5CWmtRN1FVRm5Ra1E3UVVGRFJqczdPM2REUVVWdFFqdEJRVU5zUWl4VlFVRkpMMFVzVVVGQlVTeEpRVUZhT3p0QlFVVkJRU3haUVVGTk1rVXNhMEpCUVU0c1EwRkJlVUp3UlN4UFFVRjZRaXhEUVVGcFF5eFZRVUZEZDBVc1VVRkJSQ3hGUVVGak8wRkJRemREUVN4cFFrRkJVelZFTEUxQlFWUTdRVUZEUkN4UFFVWkVPenRCUVVsQkxEQkNRVUZaYmtJc1RVRkJUVlVzWjBKQlFXeENMRVZCUVc5RFNDeFBRVUZ3UXl4RFFVRTBReXhWUVVGRE5FSXNSMEZCUkN4RlFVRlRPMEZCUTI1RWJrTXNZMEZCVFZVc1owSkJRVTRzUTBGQmRVSjVRaXhIUVVGMlFpeEZRVUUwUW1Zc2FVSkJRVFZDTzBGQlEwUXNUMEZHUkR0QlFVZEVPenRCUVVWRU96czdPenM3T3pzN1FVRTRRa0U3T3pzMFFrRkhVVHRCUVVOT08wRkJRMEVzV1VGQlRTeHBRa0ZCVGp0QlFVTkVPenRCUVVWRU96czdPenM3TmtKQlIxTTdRVUZEVUR0QlFVTkJMRmxCUVUwc2FVSkJRVTQ3UVVGRFJEczdRVUZGUkRzN096czdPekpDUVVkUE8wRkJRMHc3UVVGRFFTeFpRVUZOTEdsQ1FVRk9PMEZCUTBRN08wRkJSVVE3T3pzN096czdPenMyUWtGTlV5dEVMRkVzUlVGQlZYaEdMRmNzUlVGQllUdEJRVU01UWl4VlFVRkpTeXhSUVVGUkxFbEJRVm83TzBGQlJVRTdRVUZEUVVFc1dVRkJUVEJGTEZGQlFVNDdRVUZEUVN4VlFVRkpWU3hoUVVGaGNFWXNUVUZCVFhsQ0xFMUJRVTRzUjBGQlpTeEhRVUZtTEVkQlFYRkNla0lzVFVGQlRUQkZMRkZCUVRWRE8wRkJRMEVzVlVGQlNWY3NaVUZCWlhKR0xFMUJRVTFsTEVsQlFVNHNSMEZCWVN4WlFVRmlMRWRCUVRSQ2IwVXNVVUZCTDBNN08wRkJSVUU3UVVGRFFTeFZRVUZKUnl4aFFVRmhPMEZCUTJaNFNDeGpRVUZOTEZGQlJGTXNSVUZEUXpCRUxFMUJRVTE0UWl4TlFVRk5lVUlzVFVGRVlpeEZRVU54UWtNc1NVRkJTVEpFTEZsQlJIcENPMEZCUldaNlJDeGpRVUZOTEVWQlFVVkRMRlZCUVZWMVJDeFZRVUZhTEVWQlFYZENPVWdzVDBGQlQzRkRMRmRCUVM5Q08wRkJSbE1zVDBGQmFrSTdPMEZCUzBFN1FVRkRRU3hWUVVGSkxFTkJRVU5MTEUxQlFVMXRSU3h4UWtGQldDeEZRVUZyUTIxQ0xGZEJRVmN4UkN4SlFVRllMRU5CUVdkQ2MwTXNiMEpCUVdoQ0xFZEJRWFZEYkVVc1RVRkJUVzFGTEhGQ1FVRTNRenM3UVVGRmJFTTdRVUZEUVN4aFFVRlBMSE5DUVVGWkxGVkJRVU52UWl4UFFVRkVMRVZCUVdFN1FVRkRPVUlzV1VGQlNVTXNVVUZCVVhoR0xFMUJRVTFoTEVsQlFVNHNRMEZCVjJsQ0xGZEJRVmdzUTBGQmRVSjNSQ3hWUVVGMlFpeERRVUZhT3p0QlFVVkJja2dzWjBKQlFWRm5SQ3hIUVVGU0xFTkJRVmtzTkVKQlFUUkNha0lzVFVGQlRYbENMRTFCUVd4RExFZEJRVEpETEUxQlFYWkVMRVZCUVN0RU5rUXNWVUZCTDBRN1FVRkRRU3haUVVGSlJ5eFhRVUZYTERoQ1FVRnZRbnBHTEV0QlFYQkNMRVZCUVRKQ2IwWXNWVUZCTTBJc1JVRkJkVU42Uml4WFFVRjJReXhGUVVGdlJFc3NUVUZCVFhsQ0xFMUJRVEZFTEVWQlFXdEZLMFFzUzBGQmJFVXNRMEZCWmp0QlFVTkJReXhwUWtGQlUwTXNVVUZCVkN4RFFVRnJRaXhWUVVGRGNrWXNTMEZCUkN4RlFVRlhPMEZCUXpOQ1RDeG5Ra0ZCVFhsRExGTkJRVTRzUTBGQlowSndReXhMUVVGb1FpeEZRVUYxUWl4RlFVRkZjMFlzVFVGQlRVNHNXVUZCVWl4RlFVRnpRamRGTEZOQlFWTTBSU3hWUVVFdlFpeEZRVUYyUWp0QlFVTkVMRk5CUmtRN08wRkJTVUZ3Uml4alFVRk5WU3huUWtGQlRpeERRVUYxUWpCRkxGVkJRWFpDTEVsQlFYRkRTeXhSUVVGeVF6czdRVUZGUVVZc1owSkJRVkZGTEZGQlFWSTdRVUZEUkN4UFFWcE5MRU5CUVZBN1FVRmhSRHM3UVVGRlJEczdPenM3T3pzclFrRkpWM1pFTEZFc1JVRkJWVHRCUVVOdVFpeFhRVUZMTUVRc2NVSkJRVXdzUjBGQk5rSXhSQ3hSUVVFM1FqdEJRVU5FT3p0QlFVVkVPenM3TzIxRFFVTmxiRUlzUnl4RlFVRkxPMEZCUTJ4Q0xGVkJRVWxvUWl4UlFVRlJMRWxCUVZvN1FVRkRRU3hWUVVGSmIwWXNZVUZCWVhCRkxFbEJRVWxaTEVsQlFVb3NRMEZCVTBNc1VVRkJNVUk3TzBGQlJVRTFSQ3hqUVVGUlowUXNSMEZCVWl4RFFVRlpMRFJDUVVFMFFtcENMRTFCUVUxNVFpeE5RVUZzUXl4SFFVRXlReXhOUVVGMlJDeEZRVUVyUkZRc1IwRkJMMFE3UVVGRFFTeFZRVUZKZVVVc1YwRkJWeXc0UWtGQmIwSjZSaXhMUVVGd1FpeEZRVUV5UW05R0xGVkJRVE5DTEVWQlFYVkRjRVVzU1VGQlNWa3NTVUZCU2l4RFFVRlRkRVVzUzBGQmFFUXNRMEZCWmp0QlFVTkJNRU1zV1VGQlRWVXNaMEpCUVU0c1EwRkJkVUl3UlN4VlFVRjJRaXhKUVVGeFEwc3NVVUZCY2tNN08wRkJSVUZKTEdsQ1FVRlhMRmxCUVUwN1FVRkRaanRCUVVOQk4wWXNZMEZCVFdFc1NVRkJUaXhEUVVGWGFVSXNWMEZCV0N4RFFVRjFRanRCUVVOeVFtbERMR05CUVVrdlF5eEpRVUZKSzBNc1JVRkVZU3hGUVVOVWFrY3NUVUZCVFN4VlFVUkhMRVZCUTFNd1JDeE5RVUZOVWl4SlFVRkpWU3hGUVVSdVFpeEZRVU4xUWtFc1NVRkJTVllzU1VGQlNWRXNTVUZFTDBJN1FVRkZja0pKTEdkQ1FVRk5MRVZCUVVWSkxFMUJRVTBzUjBGQlVpeEZRVUZoT0VRc1VVRkJVVGxHTEUxQlFVMTVRaXhOUVVFelFqdEJRVVpsTEZOQlFYWkNPMEZCU1VRc1QwRk9SRHM3UVVGUlFTeFZRVUZKY0VJc1VVRkJVVHRCUVVOV2RrTXNZMEZCVFd0RUxFbEJRVWxzUkN4SlFVUkJPMEZCUlZZd1JDeGpRVUZOVWl4SlFVRkpVU3hKUVVaQk8wRkJSMVp5UlN4aFFVRkxOa1FzU1VGQlNWVXNSVUZJUXp0QlFVbFdjRVVzWlVGQlR6QkVMRWxCUVVsWkxFbEJRVW9zUTBGQlUzUkZMRXRCU2s0N1FVRkxWbXRFTEdsQ1FVRlRORVVzVlVGTVF6dEJRVTFXY0Vnc2EwSkJRVlZuUkN4SlFVRkpXU3hKUVVGS0xFTkJRVk0xUkR0QlFVNVVMRTlCUVZvN08wRkJVMEVzVlVGQlNXZERMRTFCUVUwMFJpeHhRa0ZCVml4RlFVRnBRenRCUVVNdlFqTklMR2RDUVVGUlowUXNSMEZCVWl4RFFVRlpMSE5DUVVGYUxFVkJRVzlEV2l4TFFVRndRenRCUVVOQlRDeGpRVUZOTkVZc2NVSkJRVTRzUTBGQk5FSjJSaXhMUVVFMVFqdEJRVU5FTzBGQlEwWTdPMEZCUlVRN096czdPRUpCUTFWQkxFc3NSVUZCVHpCR0xGTXNSVUZCVnp0QlFVTXhRaXhWUVVGSkwwWXNVVUZCVVN4SlFVRmFPenRCUVVWQlFTeFpRVUZOUXl4UlFVRk9PenRCUVVWQkxGVkJRVWxFTEUxQlFVMTNSU3hQUVVGT0xFdEJRV3RDTEVsQlFYUkNMRVZCUVRSQ08wRkJRekZDTzBGQlEwRXNXVUZCU1hkQ0xGbEJRVms3UVVGRFpHeEpMR2RDUVVGTkxGRkJSRkVzUlVGRFJUQkVMRTFCUVUxNFFpeE5RVUZOWlN4SlFVUmtMRVZCUTI5Q1Z5eEpRVUZKTVVJc1RVRkJUV1VzU1VGQlRpeEhRVUZoTEZWQlJISkRPMEZCUldSaExHZENRVUZOTEVWQlFVVnZReXhUUVVGVGFFVXNUVUZCVFVNc1VVRkJha0lzUlVGQk1rSTJSaXhSUVVGUk9VWXNUVUZCVFhsQ0xFMUJRWHBETEVWQlFXbEVkMFVzVjBGQlZ6VkdMRTFCUVUxcFF5eExRVUZzUlR0QlFVWlJMRk5CUVdoQ096dEJRVXRCY2tVc1owSkJRVkZuUkN4SFFVRlNMRU5CUVZrc05rSkJRVm9zUlVGQk1rTmFMRXRCUVRORExFVkJRV3RFTUVZc1UwRkJiRVFzUlVGQk5rUkRMRk5CUVRkRU96dEJRVVZCTEZsQlFVa3pSaXhOUVVGTk5rWXNTMEZCVGl4TFFVRm5RaXgzUWtGQlYwTXNUVUZCTDBJc1JVRkJkVU03UVVGRGNrTXNZMEZCU1RsR0xFMUJRVTByUml4TFFVRk9MRXRCUVdkQ0xIZENRVUZYUXl4TlFVRXZRaXhGUVVGMVF6dEJRVU55UTB3c2MwSkJRVlZ3UlN4SlFVRldMRU5CUVdWMFJTeExRVUZtTEVkQlFYVkNLME1zVFVGQlRVNHNTVUZCTjBJN1FVRkRSRHRCUVVOR0xGTkJTa1FzVFVGSlR6dEJRVU5NYVVjc2IwSkJRVlZ3UlN4SlFVRldMRU5CUVdVd1JTeGhRVUZtTEVkQlFTdENha2NzVFVGQlRUWkdMRXRCUVhKRE8wRkJRMEZHTEc5Q1FVRlZjRVVzU1VGQlZpeERRVUZsZEVVc1MwRkJaaXhIUVVGMVFpdERMRTFCUVUxT0xFbEJRVGRDTzBGQlEwRXNZMEZCU1Uwc1RVRkJUU3RHTEV0QlFVNHNTMEZCWjBJc2QwSkJRVmRITEUxQlFTOUNMRVZCUVhWRE8wRkJRM0pEVUN4elFrRkJWWEJGTEVsQlFWWXNRMEZCWlRSRkxGTkJRV1lzUjBGQk1rSnVSeXhOUVVGTkswWXNTMEZCYWtNN1FVRkRSRHRCUVVOR096dEJRVVZFTzBGQlEwRXNXVUZCU1V3c1UwRkJTaXhGUVVGbE8wRkJRMkpETEc5Q1FVRlZkRVVzUlVGQlZpeEhRVUZsY1VVc1ZVRkJWVW9zU1VGQmVrSTdRVUZEUVVzc2IwSkJRVlZ3UlN4SlFVRldMRU5CUVdWRExGRkJRV1lzUjBGQk1FSnJSU3hWUVVGVmRrWXNUMEZCY0VNN1FVRkRSRHM3UVVGRlJEdEJRVU5CTEZsQlFVa3NRMEZCUTFJc1RVRkJUVzFGTEhGQ1FVRllMRVZCUVd0RE5rSXNWVUZCVlhCRkxFbEJRVllzUTBGQlpYTkRMRzlDUVVGbUxFZEJRWE5EYkVVc1RVRkJUVzFGTEhGQ1FVRTFRenM3UVVGRmJFTnVSU3hqUVVGTllTeEpRVUZPTEVOQlFWZHBRaXhYUVVGWUxFTkJRWFZDYTBVc1UwRkJka0k3UVVGRFJEdEJRVU5HT3p0QlFVVkVPenM3TzJ0RFFVTmpVeXhQTEVWQlFWTjZSaXhITEVWQlFVczdRVUZETVVJc1ZVRkJTV2hDTEZGQlFWRXNTVUZCV2pzN1FVRkZRVHRCUVVOQk8wRkJRMEU3UVVGRFFTeFZRVUZKUVN4TlFVRk5ReXhSUVVGT0xFZEJRV2xDTEVOQlFXcENMRXRCUVhWQ1pTeEpRVUZKV1N4SlFVRktMRU5CUVZOdlF5eFBRVUZ3UXl4RlFVRTJRenRCUVVNelEyaEZMR05CUVUxRExGRkJRVTQ3UVVGRFFTeFpRVUZKTUVZc1QwRkJUek5GTEVsQlFVbFpMRWxCUVVvc1EwRkJVM0ZGTEZOQlFYQkNPMEZCUTBFc1dVRkJTVE5KTEZGQlFWRXNjMEpCUVZVd1JDeEpRVUZKV1N4SlFVRktMRU5CUVZOMFJTeExRVUZ1UWl4RFFVRmFPMEZCUTBFc1dVRkJTVzlLTEdGQlFXRkVMRkZCUVZGRkxGVkJRVklzUTBGQmJVSm9RaXhKUVVGdVFpeERRVUZxUWpzN1FVRkZRU3haUVVGSk0wVXNTVUZCU1Zrc1NVRkJTaXhEUVVGVE1FVXNZVUZCVkN4TFFVRXlRaXgzUWtGQlYwMHNTMEZCTVVNc1JVRkJhVVE3UVVGREwwTXNZMEZCU1RWR0xFbEJRVWxaTEVsQlFVb3NRMEZCVXpSRkxGTkJRVlFzUzBGQmRVSXNkMEpCUVZkTExFZEJRWFJETEVWQlFUSkRPMEZCUTNwRExHZENRVUZKUXl4TlFVRk5TaXhYUVVGWE9VZ3NSMEZCY2tJN1FVRkRRU3huUWtGQlNXMUpMRkZCUVZGTUxGZEJRVmROTEVsQlFYWkNPMEZCUTBGRExHdENRVUZOUXl4VFFVRk9MRU5CUVdkQ1F5eE5RVUZvUWl4RFFVRjFRa01zUzBGQmRrSXNRMEZCTmtKT0xFZEJRVGRDTEVWQlFXdERMRU5CUVVORExFdEJRVVFzUlVGQlVTeERRVUZTTEVWQlFWZE5MRTFCUVZnc1EwRkJhMEl2U2l4TFFVRnNRaXhEUVVGc1F6dEJRVU5FTEZkQlNrUXNUVUZKVHl4SlFVRkpNRVFzU1VGQlNWa3NTVUZCU2l4RFFVRlRORVVzVTBGQlZDeExRVUYxUWl4M1FrRkJWMGdzVFVGQmRFTXNSVUZCT0VNN1FVRkRia1FzWjBKQlFVbFRMRTlCUVUxS0xGZEJRVmM1U0N4SFFVRnlRanRCUVVOQkxHZENRVUZKYlVrc1UwRkJVVXdzVjBGQlYwMHNTVUZCZGtJN1FVRkRRVVlzYVVKQlFVbExMRTFCUVVvc1EwRkJWMG9zVFVGQldDeEZRVUZyUW5wS0xFdEJRV3hDTzBGQlEwUXNWMEZLVFN4TlFVbEJPMEZCUTB4dlNpeDFRa0ZCVnpsSUxFZEJRVmdzUTBGQlpUaElMRmRCUVZkTkxFbEJRVEZDTEVsQlFXdERNVW9zUzBGQmJFTXNRMEZFU3l4RFFVTnZRenRCUVVNeFF6dEJRVU5HTEZOQldrUXNUVUZaVHp0QlFVTk1MR05CUVVrd1JDeEpRVUZKV1N4SlFVRktMRU5CUVZOMFJTeExRVUZpTEVWQlFXOUNPMEZCUTJ4Q2Iwb3NkVUpCUVZjNVNDeEhRVUZZTEVOQlFXVTRTQ3hYUVVGWFRTeEpRVUV4UWl4SlFVRnJRekZLTEV0QlFXeERMRU5CUkd0Q0xFTkJRM1ZDTzBGQlF6RkRMRmRCUmtRc1RVRkZUenRCUVVOTUxHMUNRVUZQYjBvc1YwRkJWemxJTEVkQlFWZ3NRMEZCWlRoSUxGZEJRVmROTEVsQlFURkNMRU5CUVZBc1EwRkVTeXhEUVVOdFF6dEJRVU42UXp0QlFVTkdPMEZCUTBZc1QwRjZRa1FzVFVGNVFrODdRVUZEVER0QlFVTkJMMGtzWjBKQlFWRm5SQ3hIUVVGU0xFTkJRVmtzYzBOQlFYTkRha0lzVFVGQlRVTXNVVUZCTlVNc1IwRkJkVVFzVjBGQmRrUXNSMEZCY1VWbExFbEJRVWxaTEVsQlFVb3NRMEZCVTI5RExFOUJRVGxGTEVkQlFYZEdMRWRCUVhCSE8wRkJRMFE3UVVGRFJqczdRVUZGUkRzN096dHZRMEZEWjBKb1JDeEhMRVZCUVVzN1FVRkRia0lzVlVGQlNXaENMRkZCUVZFc1NVRkJXanRCUVVOQkwwSXNZMEZCVVdkRUxFZEJRVklzUTBGQldTeHRRa0ZCV2l4RlFVRnBRMnBDTEUxQlFVMTVRaXhOUVVGMlF5eEZRVUVyUTFRc1IwRkJMME03TzBGQlJVRXNWVUZCU1ZJc1ZVRkJWVkVzU1VGQlNWa3NTVUZCU2l4RFFVRlRReXhSUVVGMlFqdEJRVU5CTEZWQlFVbHpSQ3hYUVVGWGJrWXNUVUZCVFZVc1owSkJRVTRzUTBGQmRVSkdMRTlCUVhaQ0xFTkJRV1k3TzBGQlJVRXNWVUZCU1RKRkxGRkJRVW9zUlVGQll6dEJRVU5hYmtZc1kwRkJUV3RDTEdGQlFVNHNRMEZCYjBKcFJTeFRRVUZUYUVZc1VVRkJOMElzUlVGQmRVTmhMRWRCUVhaRE8wRkJRMFFzVDBGR1JDeE5RVVZQTzBGQlEwd3ZReXhuUWtGQlVXZEVMRWRCUVZJc1EwRkJXU3g1UWtGQldpeEZRVUYxUTFRc1QwRkJka003UVVGRFJEdEJRVU5HT3pzN2QwSkJOVTVUTzBGQlFVVXNZVUZCVHl4TFFVRkxUeXhKUVVGYU8wRkJRVzFDT3p0QlFVVXZRanM3T3pzN096dDNRa0ZKWVR0QlFVRkZMR0ZCUVU4c1MwRkJTMmxETEU5QlFWbzdRVUZCYzBJN08wRkJSWEpET3pzN096czdPM2RDUVVsaE8wRkJRVVVzWVVGQlR5eExRVUZMZDBJc1QwRkJXanRCUVVGelFqczdRVUZGY2tNN096czdPenM3ZDBKQlNWYzdRVUZCUlN4aFFVRlBMRXRCUVV0eVJTeFJRVUZNTEVOQlFXTktMRWxCUVhKQ08wRkJRVFJDT3p0QlFVVjZRenM3T3pzN096dDNRa0ZKWjBJN1FVRkJSU3hoUVVGUExFdEJRVXRYTEdkQ1FVRmFPMEZCUVN0Q096czdTMEUxU1c1RU96czdPenM3T3pzN096czdPenM3T3pzN096czdPenRyUWtGdlZtVTJSQ3hWT3pzN096czdPenM3T3pzN096czdPenM3T3pzN08wRkROMVJtT3pzN096czdRVUZGUVRzN096dEpRVWxOSzBNc1pTeERRVUZuUWl3eVFqdEJRVU53UWpzN096czdRVUZOUVRzN096dEJRVWxCTERKQ1FVRlpReXhOUVVGYUxFVkJRVzlDTDBjc1QwRkJjRUlzUlVGQk5rSmlMRmRCUVRkQ0xFVkJRVEJETmtnc1MwRkJNVU1zUlVGQmFVUm9ReXhMUVVGcVJDeEZRVUYzUkR0QlFVRkJPenRCUVVOMFJDeFJRVUZKZUVZc1VVRkJVU3hKUVVGYU96dEJRVVZCUVN4VlFVRk5lVWdzVDBGQlRpeEhRVUZuUWtZc1RVRkJhRUk3UVVGRFFYWklMRlZCUVUwd1JTeFJRVUZPTEVkQlFXbENiRVVzVDBGQmFrSTdRVUZEUVZJc1ZVRkJUWGxDTEUxQlFVNHNSMEZCWlN0R0xFdEJRV1k3UVVGRFFYaElMRlZCUVUwd1NDeE5RVUZPTEVkQlFXVnNReXhMUVVGbU96dEJRVVZCZUVZc1ZVRkJUVWNzVVVGQlRpeEhRVUZwUWl3d1FrRkJaVklzVjBGQlppeERRVUZxUWpzN1FVRkZRVXNzVlVGQlRXRXNTVUZCVGl4SFFVRmhNRWNzVDBGQlR6RkhMRWxCUVhCQ08wRkJRMEZpTEZWQlFVMVhMR3RDUVVGT08wRkJRMFE3T3pzN2VVTkJSVzlDTzBGQlEyNUNMRlZCUVVsWUxGRkJRVkVzU1VGQldqczdRVUZGUVR0QlFVTkJMRlZCUVVsQkxFMUJRVTE1UWl4TlFVRldMRVZCUVd0Q08wRkJRMmhDZWtJc1kwRkJUVEpJTEZOQlFVNHNSMEZCYTBJelNDeE5RVUZOWVN4SlFVRk9MRU5CUVZkRExGZEJRVmdzUTBGQmRVSmtMRTFCUVUxNVFpeE5RVUUzUWl4RlFVRnhReXhWUVVGRFZDeEhRVUZFTEVWQlFWTTdRVUZET1VRc1kwRkJTVUVzU1VGQlNXeEVMRWxCUVVvc1MwRkJZU3hWUVVGaUxFbEJRVEpDYTBRc1NVRkJTU3RETEVWQlFVb3NTMEZCVnk5RUxFMUJRVTB3U0N4TlFVRm9SQ3hGUVVGM1JEdEJRVU4wUkhwS0xHOUNRVUZSWjBRc1IwRkJVaXhEUVVGWkxEWkNRVUZhTEVWQlFUSkRSQ3hIUVVFelF6dEJRVU5CYUVJc2EwSkJRVTB5UXl4WFFVRk9MRU5CUVd0Q00wSXNSMEZCYkVJN1FVRkRSRHRCUVVOR0xGTkJUR2xDTEVOQlFXeENPMEZCVFVRN1FVRkRSanM3TzNkRFFVVnRRanRCUVVOc1FpeFZRVUZKYUVJc1VVRkJVU3hKUVVGYU96dEJRVVZCTEZWQlFVbEJMRTFCUVUweVNDeFRRVUZXTEVWQlFYRkNPMEZCUTI1Q00wZ3NZMEZCVFRKSUxGTkJRVTRzUTBGQlowSjRSeXhOUVVGb1FqdEJRVU5FTzBGQlEwWTdPMEZCUlVRN096czdPenM0UWtGSFV6dEJRVU5RTEZWQlFVbHVRaXhSUVVGUkxFbEJRVm83TzBGQlJVRXNZVUZCVDBFc1RVRkJUWGxJTEU5QlFVNHNRMEZCWTBjc1UwRkJaQ3hEUVVGM1FqVklMRTFCUVUwd1JTeFJRVUU1UWl4RFFVRlFPenRCUVVWQk1VVXNXVUZCVFc5Q0xHbENRVUZPT3p0QlFVVkJPMEZCUTBRN08wRkJSVVE3T3pzN096czdPenRCUVZsQk96czdPelpDUVVsVFl5eFJMRVZCUVZVN1FVRkRha0lzVjBGQlN5OUNMRkZCUVV3c1EwRkJZME1zVDBGQlpDeERRVUZ6UWl4VlFVRkRReXhMUVVGRUxFVkJRVmM3UVVGREwwSTJRaXhwUWtGQlV6ZENMRXRCUVZRN1FVRkRSQ3hQUVVaRU8wRkJSMFE3TzBGQlJVUTdPenM3T3pzN0swSkJTVmMyUWl4UkxFVkJRVlU3UVVGRGJrSXNWMEZCUzIxQ0xHdENRVUZNTEVkQlFUQkNia0lzVVVGQk1VSTdRVUZEUkRzN1FVRkZSRHM3T3p0blEwRkRXV3hDTEVjc1JVRkJTenRCUVVObUxGVkJRVWxvUWl4UlFVRlJMRWxCUVZvN08wRkJSVUVzVlVGQlNVc3NVVUZCVVR0QlFVTldka01zWTBGQlRXdEVMRWxCUVVsc1JDeEpRVVJCTzBGQlJWWllMR0ZCUVVzMlJDeEpRVUZKV1N4SlFVRktMRU5CUVZOclJTeE5RVVpLTzBGQlIxWTVSQ3hqUVVGTmFFSXNTVUZCU1Zrc1NVRkJTaXhEUVVGVFNUdEJRVWhNTEU5QlFWbzdPMEZCVFVFc1ZVRkJTV2hETEUxQlFVMXhSQ3hyUWtGQlZpeEZRVUU0UWp0QlFVTTFRbkpFTEdOQlFVMXhSQ3hyUWtGQlRpeERRVUY1UW1oRUxFdEJRWHBDTzBGQlEwUTdRVUZEUmpzN08zZENRWFpEWVR0QlFVRkZMR0ZCUVU4c1MwRkJTM0ZGTEZGQlFWbzdRVUZCZFVJN08wRkJSWFpET3pzN096czdPM2RDUVVsWE8wRkJRVVVzWVVGQlR5eExRVUZMZGtVc1VVRkJUQ3hEUVVGalNpeEpRVUZ5UWp0QlFVRTBRanM3TzB0QmJrY3pRenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN2EwSkJkMGxsZFVnc1pUczdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN08wRkRlRWxtT3pzN08wRkJSVUVzU1VGQlRVOHNZVUZCWVN4RlFVRkRha0lzVDBGQlR5eG5Ra0ZCVWl4RlFVRXdRbFFzVVVGQlVTeHBRa0ZCYkVNc1JVRkJia0k3TzBGQlJVRTdPenM3T3p0SlFVdE5Na0lzVlR0QlFVVktMSE5DUVVGWmJra3NWMEZCV2l4RlFVRjVRanRCUVVGQk96dEJRVU4yUWl4UlFVRkpTeXhSUVVGUkxFbEJRVm83TzBGQlJVRkJMRlZCUVUxelFpeFZRVUZPTEVkQlFXMUNMRVZCUVc1Q08wRkJRMEYwUWl4VlFVRk5SU3hSUVVGT0xFZEJRV2xDTEVWQlFXcENPenRCUVVWQkxGTkJRVXMyU0N4TFFVRk1MRWRCUVdGd1NTeGxRVUZsTEVWQlFUVkNPenRCUVVWQkxGTkJRVXR4U1N4blFrRkJUQ3hEUVVGelFpeExRVUZMUkN4TFFVRXpRanRCUVVORU96czdPelJDUVVsUE4wWXNVU3hGUVVGVk8wRkJRMmhDTEZkQlFVdGFMRlZCUVV3c1EwRkJaMEkwUkN4SlFVRm9RaXhEUVVGeFFtaEVMRkZCUVhKQ08wRkJRMFE3T3p0NVFrRkZTWGxFTEVrc1JVRkJUVHRCUVVOVUxGVkJRVWx6UXl4UFFVRlBkRU1zUzBGQlMyaEpMRXRCUVV3c1EwRkJWeXhIUVVGWUxFTkJRVmc3TzBGQlJVRXNZVUZCVHl4TFFVRkxkVXNzWTBGQlRDeERRVUZ2UWtRc1NVRkJjRUlzUTBGQlVEdEJRVU5FT3pzN0swSkJSVlYwUXl4SkxFVkJRVTA3UVVGRFppeFZRVUZKT1Vnc1UwRkJVeXhGUVVGaU8wRkJRMEVzVlVGQlNXOUxMRTlCUVU5MFF5eExRVUZMYUVrc1MwRkJUQ3hEUVVGWExFZEJRVmdzUTBGQldEdEJRVU5CUlN4aFFVRlBiVW9zU1VGQlVDeEhRVUZqYVVJc1MwRkJTMFVzUjBGQlRDeEZRVUZrTzBGQlEwRjBTeXhoUVVGUFpTeEhRVUZRTEVkQlFXRXNTMEZCUzNOS0xHTkJRVXdzUTBGQmIwSkVMRWxCUVhCQ0xFTkJRV0k3TzBGQlJVRXNZVUZCVDNCTExFMUJRVkE3UVVGRFJEczdPMjFEUVVWamIwc3NTU3hGUVVGTk8wRkJRMjVDTEZWQlFVbHlTaXhOUVVGTkxFdEJRVXR0U2l4TFFVRm1PMEZCUTBGRkxGZEJRVXN4U0N4UFFVRk1MRU5CUVdFc1ZVRkJRMnBFTEV0QlFVUXNSVUZCVnp0QlFVTjBRbk5DTEdOQlFVMUJMRWxCUVVsMFFpeExRVUZLTEVOQlFVNDdRVUZEUkN4UFFVWkVPenRCUVVsQkxHRkJRVTl6UWl4SFFVRlFPMEZCUTBRN096dHJRMEZGWVVFc1J5eEZRVUZMTzBGQlEycENMRlZCUVVsQkxFbEJRVWwzU2l4WFFVRktMRXRCUVc5Q1F5eE5RVUZ3UWl4SlFVRTRRbnBLTEVsQlFVbDNTaXhYUVVGS0xFdEJRVzlDYmtJc1MwRkJkRVFzUlVGQk5rUTdRVUZETTBRc1pVRkJUeXhKUVVGUU8wRkJRMFE3TzBGQlJVUXNZVUZCVHl4TFFVRlFPMEZCUTBRN096dHhRMEZIWjBKMFNTeE5MRVZCUVZFN1FVRkJRVHM3UVVGRmRrSXNWVUZCU1RKS0xGVkJRVlVzVTBGQlZrRXNUMEZCVlN4RFFVRkRReXhUUVVGRUxFVkJRV1U3TzBGQlJUTkNRU3hyUWtGQlZVTXNTMEZCVml4RFFVRm5RaXhWUVVGRFF5eE5RVUZFTEVWQlFWazdRVUZETVVJc2FVSkJRVXRETEZWQlFVd3NRMEZCWjBKRUxFMUJRV2hDTzBGQlEwUXNVMEZHUkR0QlFVbEVMRTlCVGtRN08wRkJVVUVzVjBGQlMxWXNTMEZCVEN4SFFVRmhUU3hQUVVGUFRTeFhRVUZRTEVOQlFXMUNhRXNzVFVGQmJrSXNSVUZCTWtJeVNpeFBRVUV6UWl4RFFVRmlPMEZCUlVRN096c3JRa0ZGVldwSkxFc3NSVUZCVHp0QlFVTm9RaXhYUVVGTGFVSXNWVUZCVEN4RFFVRm5RbVlzVDBGQmFFSXNRMEZCZDBJc1ZVRkJRekpDTEZGQlFVUXNSVUZCWXp0QlFVTndRMEVzYVVKQlFWTTNRaXhMUVVGVU8wRkJRMFFzVDBGR1JEdEJRVWRFT3pzN0swSkJSVlZ2U1N4TkxFVkJRVkU3TzBGQlJXcENMRlZCUVVrM1NpeE5RVUZOTmtvc1QwRkJUemxLTEUxQlFXcENPMEZCUTBFc1ZVRkJTV2xMTEdkQ1FVRktPenRCUVVWQkxGVkJRVWxvU3l4SlFVRkpkMG9zVjBGQlNpeExRVUZ2UWtNc1RVRkJlRUlzUlVGQlowTTdRVUZET1VKUExHdENRVUZWUXl4WFFVRlhNVU1zVFVGQmNrSTdRVUZEUkRzN1FVRkZSQ3hWUVVGSmRrZ3NTVUZCU1hkS0xGZEJRVW9zUzBGQmIwSnVRaXhMUVVGNFFpeEZRVUVyUWp0QlFVTTNRakpDTEd0Q1FVRlZReXhYUVVGWGFrTXNTMEZCY2tJN1FVRkRSRHM3UVVGRlJDeFZRVUZKYTBNc1kwRkJZMHdzVDBGQlQwMHNUMEZCZWtJN08wRkJSVUU3UVVGRFFUczdRVUZGUVR0QlFVTkJMRlZCUVVsRExGZEJRVmR3U3l4SlFVRkpOa29zVDBGQlQxRXNTVUZCV0N4RFFVRm1PenRCUVVWQmFFd3NZMEZCVVdsTUxFbEJRVklzUTBGQllWUXNUMEZCVHpOTExFbEJRVkFzUjBGQll5eFpRVUZrTEVkQlFUWkNaMHdzVjBGQk4wSXNSMEZCTWtNc1pVRkJlRVFzUlVGQmVVVXNlVUpCUVdWRkxGRkJRV1lzUTBGQmVrVTdPMEZCUlVFc1ZVRkJTVkFzVDBGQlR6TkxMRWxCUVZBc1MwRkJaMElzVVVGQmNFSXNSVUZCT0VJN1FVRkROVUlzWVVGQlMzRk1MRlZCUVV3c1EwRkJaMEk3UVVGRFpDOURMR2xDUVVGUFowUXNWMEZCVnpkRExFMUJSRW83UVVGRlpFd3NhVUpCUVU4d1F5eFBRVVpQTzBGQlIyUjBSeXhwUWtGQlQzZEhMRmRCU0U4N1FVRkpaQzlKTEdkQ1FVRk5hVW83UVVGS1VTeFRRVUZvUWp0QlFVMUVPenRCUVVWRUxGVkJRVWxRTEU5QlFVOHpTeXhKUVVGUUxFdEJRV2RDTEV0QlFYQkNMRVZCUVRKQ08wRkJRM3BDTEdGQlFVdHhUQ3hWUVVGTUxFTkJRV2RDTzBGQlEyUXZReXhwUWtGQlQyZEVMRmRCUVZkMlF5eEhRVVJLTzBGQlJXUllMR2xDUVVGUE1FTXNUMEZHVHp0QlFVZGtkRWNzYVVKQlFVOTNSeXhYUVVoUE8wRkJTV1F2U1N4blFrRkJUV2xLTzBGQlNsRXNVMEZCYUVJN1FVRk5SRHM3UVVGRlJDeFZRVUZKVUN4UFFVRlBNMHNzU1VGQlVDeExRVUZuUWl4UlFVRndRaXhGUVVFNFFqdEJRVU0xUWl4aFFVRkxjVXdzVlVGQlRDeERRVUZuUWp0QlFVTmtMME1zYVVKQlFVOW5SQ3hYUVVGWEwwTXNUVUZFU2p0QlFVVmtTQ3hwUWtGQlR6QkRMRTlCUms4N1FVRkhaSFJITEdsQ1FVRlBkMGM3UVVGSVR5eFRRVUZvUWp0QlFVdEVPMEZCUTBZN096dDNRa0V6UjFVN1FVRkJSU3hoUVVGUExFdEJRVXRtTEV0QlFWbzdRVUZCYjBJN096czdPMEZCSzBjMVFpeEpRVUZKY1VJc2EwTkJRV0VzUlVGQlF6ZERMRkZCUVZFc1VVRkJWQ3hGUVVGdFFrMHNTMEZCU3l4TFFVRjRRaXhGUVVFclFsSXNVVUZCVVN4UlFVRjJReXhGUVVGcVFqdEJRVU5CTEVsQlFVbDNReXhyUTBGQllTeEZRVUZETVVNc1VVRkJVU3hSUVVGVUxFVkJRVzFDVXl4UFFVRlBMRTlCUVRGQ0xFVkJRV3BDTzJ0Q1FVTlJhMElzVlRzN096czdPenRCUTNaSlpqczdRVUZGUVRzN1FVRkZRVHM3UVVGRlFUczdRVUZGUVRzN1FVRkZRVHM3UVVGRlFTeHpRMEZCYzBNc2RVTkJRWFZETEdkQ1FVRm5RanM3UVVGRk4wWTdRVUZEUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJMRXRCUVVzN1FVRkRURHRCUVVOQk8wRkJRMEVzUjBGQlJ6dEJRVU5JTzBGQlEwRXNSMEZCUnp0QlFVTklPenRCUVVWQk8wRkJRMEU3UVVGRFFUczdRVUZGUVR0QlFVTkJPMEZCUTBFc1JUczdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN1FVTmtRVHM3T3p0QlFVTkJPenM3TzBGQlEwRTdPenM3T3p0QlFVVkJPenM3T3p0SlFVdE5kVUlzVHp0QlFVTktPenM3T3pzN096czdPenM3UVVGbFFUczdPenM3TzBGQlRVRXNiVUpCUVZrM1FpeExRVUZhTEVWQlFXMUNPRUlzUjBGQmJrSXNSVUZCZDBKRExFMUJRWGhDTEVWQlFXZERPMEZCUVVFN08wRkJRemxDTEZGQlFVbDJTaXhSUVVGUkxFbEJRVm83TzBGQlJVRkJMRlZCUVUxNVFpeE5RVUZPTEVkQlFXVXJSaXhMUVVGbU8wRkJRMEY0U0N4VlFVRk5ZU3hKUVVGT0xFZEJRV0Y1U1N4SFFVRmlPenRCUVVWQmRFb3NWVUZCVFRKQ0xFOUJRVTRzUjBGQlowSTBTQ3hQUVVGUFF5eFZRVUZRTEVkQlFXOUNMRXRCUVhCRE96dEJRVVZCZUVvc1ZVRkJUVzFFTEZWQlFVNHNSMEZCYlVJc1JVRkJia0k3UVVGRFFXNUVMRlZCUVUxelFpeFZRVUZPTEVkQlFXMUNMRVZCUVc1Q08wRkJRMEYwUWl4VlFVRk5lVW9zWVVGQlRpeEhRVUZ6UWl4RlFVRjBRanM3UVVGRlFVZ3NVVUZCU1hoSkxGZEJRVW9zUTBGQlowSXdSeXhMUVVGb1FpeEZRVUYxUWl4VlFVRkRlRWNzUjBGQlJDeEZRVUZUTzBGQlF6bENPMEZCUTBFc1ZVRkJTVUVzU1VGQlNWRXNTVUZCU2l4TFFVRmhaMGNzUzBGQmFrSXNSVUZCZDBJN1FVRkRkRUoyU2l4blFrRkJVV2xNTEVsQlFWSXNRMEZCWVN4NVFrRkJZaXhGUVVGM1EyeEpMRWRCUVhoRE8wRkJRMEVzWjBKQlFWRkJMRWxCUVVsc1JDeEpRVUZhTzBGQlEwVXNaVUZCU3l4VFFVRk1PMEZCUVdkQ2EwTXNhMEpCUVUwd1NpeFZRVUZPTEVOQlFXbENNVWtzUjBGQmFrSXNSVUZCZFVJN1FVRkRka01zWlVGQlN5eFJRVUZNTzBGQlFXVm9RaXhyUWtGQlRUSktMR1ZCUVU0c1EwRkJjMEl6U1N4SFFVRjBRaXhGUVVFMFFqdEJRVU16UXl4bFFVRkxMRkZCUVV3N1FVRkJaV2hDTEd0Q1FVRk5ORW9zWlVGQlRpeERRVUZ6UWpWSkxFZEJRWFJDTEVWQlFUUkNPMEZCU0RkRE8wRkJTMFE3UVVGRFJpeExRVlpFTzBGQlYwUTdPMEZCUlVRN096czdPenM3T3pzN1FVRnJRa0U3T3pzN096czdPekpDUVZGUGRrSXNUU3hGUVVGUmIwUXNVeXhGUVVGWGJFUXNWeXhGUVVGNVF6dEJRVUZCTEZWQlFUVkNhMHNzUzBGQk5FSXNkVVZCUVhCQ0xFdEJRVzlDTzBGQlFVRXNWVUZCWWtNc1IwRkJZU3gxUlVGQlVDeExRVUZQT3p0QlFVTnFSU3hWUVVGSk9Vb3NVVUZCVVN4SlFVRmFPMEZCUTBFc1ZVRkJTU3RLTEZkQlFWY3NSVUZCWmpzN1FVRkZRVUVzWlVGQlUwUXNSMEZCVkN4SFFVRmxRU3hIUVVGbU8wRkJRMEZETEdWQlFWTkdMRXRCUVZRc1IwRkJhVUpCTEV0QlFXcENPMEZCUTBGRkxHVkJRVk4wU3l4TlFVRlVMRWRCUVd0Q1FTeE5RVUZzUWp0QlFVTkJjMHNzWlVGQlUyeElMRk5CUVZRc1IwRkJjVUpCTEZOQlFYSkNPMEZCUTBGclNDeGxRVUZUY0Vzc1YwRkJWQ3hIUVVGMVFrRXNWMEZCZGtJN08wRkJSVUV4UWl4alFVRlJaMFFzUjBGQlVpeERRVUZaTEcxRVFVRmFMRVZCUVdsRk9Fa3NVVUZCYWtVN08wRkJSVUVzTkVKQlFXTkJMRkZCUVdRc1JVRkJkMElzUlVGQlEyaElMRkZCUVZFc1MwRkJWQ3hGUVVGNFFqczdRVUZGUVN4aFFVRlBMME1zVFVGQlRXZExMRTlCUVU0c1EwRkJZMFFzVVVGQlpDeERRVUZRTzBGQlEwUTdPenR2UTBGRlpVRXNVU3hGUVVGVk8wRkJRM2hDTEZWQlFVa3ZTaXhSUVVGUkxFbEJRVm83UVVGRFFTOUNMR05CUVZGblJDeEhRVUZTTEVOQlFWa3NiVVJCUVZvc1JVRkJhVVU0U1N4UlFVRnFSVHM3UVVGRlFTdzBRa0ZCWTBFc1VVRkJaQ3hGUVVGM1FpeEZRVUZEYUVnc1VVRkJVU3hKUVVGVUxFVkJRWGhDT3p0QlFVVkJMR0ZCUVU4dlF5eE5RVUZOWjBzc1QwRkJUaXhEUVVGalJDeFJRVUZrTEVOQlFWQTdRVUZEUkRzN1FVRkZSRHM3T3pzN096czdPenM3T3poQ1FWTlZkRXNzVFN4RlFVRlJkMHNzVFN4RlFVRnRSRHRCUVVGQkxGVkJRVE5EU2l4TFFVRXlReXgxUlVGQmJrTXNTMEZCYlVNN1FVRkJRU3hWUVVFMVFrTXNSMEZCTkVJc2RVVkJRWFJDTEV0QlFYTkNPMEZCUVVFc1ZVRkJabWhMTEUxQlFXVXNkVVZCUVU0c1NVRkJUVHM3UVVGRGJrVXNWVUZCU1VVc1VVRkJVU3hKUVVGYU8wRkJRMEVzVlVGQlNTdEtMRmRCUVZjc1JVRkJaanM3UVVGRlFVRXNaVUZCVTBRc1IwRkJWQ3hIUVVGbFFTeEhRVUZtTzBGQlEwRkRMR1ZCUVZOR0xFdEJRVlFzUjBGQmFVSkJMRXRCUVdwQ08wRkJRMEZGTEdWQlFWTjBTeXhOUVVGVUxFZEJRV3RDUVN4TlFVRnNRanRCUVVOQmMwc3NaVUZCVTJ4SkxGRkJRVlFzUjBGQmIwSnZTU3hOUVVGd1FqczdRVUZGUVR0QlFVTkJSaXhsUVVGVGFrc3NUVUZCVkN4SFFVRnJRa0VzVFVGQmJFSTdPMEZCUjBFM1FpeGpRVUZSWjBRc1IwRkJVaXhEUVVGWkxEaERRVUZhTEVWQlFUUkVPRWtzVVVGQk5VUTdPMEZCUlVFc05FSkJRV05CTEZGQlFXUXNSVUZCZDBJc1JVRkJRMmhJTEZGQlFWRXNTMEZCVkN4RlFVRjRRanM3UVVGRlFTeGhRVUZQTDBNc1RVRkJUV3RMTEZWQlFVNHNRMEZCYVVKSUxGRkJRV3BDTEVOQlFWQTdRVUZEUkRzN1FVRkZSRHM3T3pzN096czdiME5CUzJkQ1FTeFJMRVZCUVZVN1FVRkRlRUlzVlVGQlNTOUtMRkZCUVZFc1NVRkJXanRCUVVOQkxGVkJRVWx0U3l4WlFVRlpTaXhaUVVGWkxFVkJRVFZDT3p0QlFVVkJMRFJDUVVGalNTeFRRVUZrTEVWQlFYbENMRVZCUVVOd1NDeFJRVUZSTEVsQlFWUXNSVUZCZWtJN08wRkJSVUVzWVVGQlR5OURMRTFCUVUxclN5eFZRVUZPTEVOQlFXbENReXhUUVVGcVFpeERRVUZRTzBGQlEwUTdPMEZCUlVRN096czdPenM3TzNsQ1FVdExSaXhOTEVWQlFWRTdRVUZEV0N4VlFVRkpha3NzVVVGQlVTeEpRVUZhT3p0QlFVVkJPMEZCUTBFN1FVRkRRU3hWUVVGSmIwc3NWVUZCVlR0QlFVTmFkRTBzWTBGQlRTeE5RVVJOTEVWQlEwVXdSQ3hOUVVGTmVFSXNUVUZCVFhsQ0xFMUJSR1FzUlVGRGMwSkRMRWxCUVVsMVNUdEJRVVF4UWl4UFFVRmtPenRCUVVsQkxHRkJRVThzYzBKQlFWa3NWVUZCUXpGRkxFOUJRVVFzUlVGQlZXNUNMRTFCUVZZc1JVRkJjVUk3UVVGRGRFTndSU3hqUVVGTllTeEpRVUZPTEVOQlFWZHBRaXhYUVVGWUxFTkJRWFZDYzBrc1QwRkJka0lzUlVGQlowTXNWVUZCUTNKSkxFdEJRVVFzUlVGQlZ6dEJRVU42UXpsRUxHdENRVUZSWjBRc1IwRkJVaXhEUVVGWkxHbENRVUZhTEVWQlFTdENZeXhMUVVFdlFqdEJRVU5CTEdOQlFVbEJMRTFCUVUxSUxFbEJRVTRzUTBGQlYwa3NTVUZCV0N4TFFVRnZRaXhIUVVGNFFpeEZRVUUyUWp0QlFVTXpRblZFTEc5Q1FVRlJlRVFzVFVGQlRVZ3NTVUZCVGl4RFFVRlhkRVVzUzBGQmJrSTdRVUZEUkN4WFFVWkVMRTFCUlU4N1FVRkRURGhITEcxQ1FVRlBja01zVFVGQlRVZ3NTVUZCVGl4RFFVRlhNRU1zU1VGQmJFSTdRVUZEUkR0QlFVTkdMRk5CVUVRN1FVRlJSQ3hQUVZSTkxFTkJRVkE3UVVGVlJEczdRVUZGUkRzN096czdPenM3YlVOQlMyVndReXhSTEVWQlFWVTdRVUZEZGtJc1YwRkJTMjFKTEhOQ1FVRk1MRWRCUVRoQ2Jra3NVVUZCT1VJN1FVRkRSRHM3T3pSQ1FVVlBOa2dzVVN4RlFVRlZPMEZCUTJoQ0xGVkJRVWt2U2l4UlFVRlJMRWxCUVZvN08wRkJSVUVzWVVGQlR5eHpRa0ZCV1N4VlFVRkRkVVlzVDBGQlJDeEZRVUZWYmtJc1RVRkJWaXhGUVVGeFFqdEJRVU4wUXl4WlFVRkpja0lzVTBGQlUyZElMRk5CUVZOb1NDeE5RVUYwUWp0QlFVTkJMRmxCUVVsd1JDeGpRVUZqYjBzc1UwRkJVM0JMTEZkQlFWUXNTVUZCZDBJc1JVRkJNVU03UVVGRFFTeFpRVUZKUml4bFFVRktPenRCUVVWQk8wRkJRMEVzV1VGQlNUWkdMR0ZCUVdFN1FVRkRabmhJTEdkQ1FVRk5MRkZCUkZNc1JVRkRRekJFTEUxQlFVMTRRaXhOUVVGTmVVSXNUVUZFWWl4RlFVTnhRa01zU1VGQlNURkNMRTFCUVUweVFpeFBRVVF2UWp0QlFVVm1ReXhuUWtGQlRTeEZRVUZGYlVJc1VVRkJVVUVzVFVGQlZqdEJRVVpUTEZOQlFXcENPenRCUVV0Qk9VVXNaMEpCUVZGblJDeEhRVUZTTEVOQlFWa3NjMEpCUVZvc1JVRkJiME00U1N4UlFVRndReXhGUVVFNFEzcEZMRlZCUVRsRE96dEJRVVZCUVN4dFFrRkJWekZFTEVsQlFWZ3NRMEZCWjBKMFJTeExRVUZvUWl4SFFVRjNRbkZETEZkQlFYaENPMEZCUTBFeVJpeHRRa0ZCVnpGRUxFbEJRVmdzUTBGQlowSjBSU3hMUVVGb1FpeERRVUZ6UW1kT0xGRkJRWFJDTEVkQlFXbERkRXNzVFVGQlRYbENMRTFCUVhaRE96dEJRVVZCTEZsQlFVbHpTU3hUUVVGVGRFc3NUVUZCWWl4RlFVRnhRanRCUVVOdVFrRXNiVUpCUVZOelN5eFRRVUZUZEVzc1RVRkJiRUk3UVVGRFFUWkdMSEZDUVVGWE1VUXNTVUZCV0N4RFFVRm5RbTVETEUxQlFXaENMRWRCUVhsQ2Mwc3NVMEZCVTNSTExFMUJRV3hETzBGQlEwUTdPMEZCUlVRc1dVRkJTWE5MTEZOQlFWTkVMRWRCUVdJc1JVRkJhMEo0UlN4WFFVRlhNVVFzU1VGQldDeERRVUZuUW10SkxFZEJRV2hDTEVkQlFYTkNReXhUUVVGVFJDeEhRVUV2UWp0QlFVTnNRaXhaUVVGSlF5eFRRVUZUUml4TFFVRmlMRVZCUVc5Q2RrVXNWMEZCVnpGRUxFbEJRVmdzUTBGQlowSnBTU3hMUVVGb1FpeEhRVUYzUWtVc1UwRkJVMFlzUzBGQmFrTTdRVUZEY0VJc1dVRkJTVVVzVTBGQlUyeElMRk5CUVdJc1JVRkJkMEo1UXl4WFFVRlhNVVFzU1VGQldDeERRVUZuUW5GQ0xGTkJRV2hDTEVkQlFUUkNPRWNzVTBGQlUyeElMRk5CUVhKRE96dEJRVVY0UWl4WlFVRkpSU3hOUVVGS0xFVkJRVms3UVVGRFZqbEZMR3RDUVVGUlowUXNSMEZCVWl4RFFVRlpMSFZEUVVGYUxFVkJRWEZFY1VVc1ZVRkJja1E3UVVGRFJDeFRRVVpFTEUxQlJVODdRVUZEVEhKSUxHdENRVUZSWjBRc1IwRkJVaXhEUVVGWkxIVkRRVUZhTEVWQlFYRkVjVVVzVlVGQmNrUTdRVUZEUkRzN1FVRkZSRHRCUVVOQmRFWXNZMEZCVFdFc1NVRkJUaXhEUVVGWGFVSXNWMEZCV0N4RFFVRjFRbmRFTEZWQlFYWkNMRVZCUVcxRExGVkJRVU4yUkN4TFFVRkVMRVZCUVZjN1FVRkROVU01UkN4clFrRkJVV2RFTEVkQlFWSXNRMEZCV1N4M1EwRkJXaXhGUVVGelJHTXNTMEZCZEVRN1FVRkRRU3hqUVVGSlFTeE5RVUZOU0N4SlFVRk9MRU5CUVZkSkxFbEJRVmdzUzBGQmIwSXNSMEZCZUVJc1JVRkJOa0k3UVVGRE0wSTdRVUZEUVN4blFrRkJTV2xKTEZOQlFWTnNTU3hOUVVGTlNDeEpRVUZPTEVOQlFWZERMRkZCUVhoQ096dEJRVVZCTEdkQ1FVRkphMElzVFVGQlNpeEZRVUZaTzBGQlExWjBSQ3gxUWtGQlUzTkRMRTFCUVUxSUxFbEJRVTRzUTBGQlYyNURMRTFCUVhCQ08wRkJRMEZGTERSQ1FVRmpiME1zVFVGQlRVZ3NTVUZCVGl4RFFVRlhkRVVzUzBGQmVrSTdRVUZEUkRzN1FVRkZSQ3huUWtGQlNXbE9MRk5CUVZNc2FVTkJRWFZDZGtzc1MwRkJka0lzUlVGQk9FSnBTeXhOUVVFNVFpeEZRVUZ6UTNoTExFMUJRWFJETEVWQlFUaERMRWxCUVRsRExFVkJRVzlFUlN4WFFVRndSQ3hGUVVGcFJXOURMRTFCUVUxSUxFbEJRVTRzUTBGQlZ6UkpMR2xDUVVFMVJTeERRVUZpTzBGQlEwRjRTeXhyUWtGQlRXMUVMRlZCUVU0c1EwRkJhVUk0Unl4TlFVRnFRaXhKUVVFeVFrMHNUVUZCTTBJN08wRkJSVUZvUml4dlFrRkJVV2RHTEUxQlFWSTdRVUZEUkN4WFFXSkVMRTFCWVU4N1FVRkRURHRCUVVOQmJrY3NiVUpCUVU5eVF5eE5RVUZOU0N4SlFVRk9MRU5CUVZjd1F5eEpRVUZzUWp0QlFVTkVPMEZCUTBZc1UwRnVRa1E3UVVGdlFrUXNUMEZ3UkUwc1EwRkJVRHRCUVhORVJEczdPeXRDUVVWVmVVWXNVU3hGUVVGVk8wRkJRMjVDTEZWQlFVa3ZTaXhSUVVGUkxFbEJRVm83TzBGQlJVRXNZVUZCVHl4elFrRkJXU3hWUVVGRGRVWXNUMEZCUkN4RlFVRlZia0lzVFVGQlZpeEZRVUZ4UWpzN1FVRkZkRU03UVVGRFFTeFpRVUZKY1Vjc1pVRkJaVHRCUVVOcVFqTk5MR2RDUVVGTkxGZEJSRmNzUlVGRFJUQkVMRTFCUVUxNFFpeE5RVUZOZVVJc1RVRkVaQ3hGUVVOelFrTXNTVUZCU1RGQ0xFMUJRVTB5UWl4UFFVUm9RenRCUVVWcVFrTXNaMEpCUVUwN1FVRkdWeXhUUVVGdVFqczdRVUZMUVR0QlFVTkJPenRCUVVWQk8wRkJRMEU3TzBGQlJVRTdRVUZEUVR0QlFVTkJMRmxCUVVsdFNTeFJRVUZLTEVWQlFXTTdRVUZEV2l4alFVRkpRU3hUUVVGVE9VWXNZMEZCVkN4RFFVRjNRaXhMUVVGNFFpeERRVUZLTEVWQlFXOURkMGNzWVVGQllUZEpMRWxCUVdJc1EwRkJhMEpyU1N4SFFVRnNRaXhIUVVGM1FrTXNVMEZCVTBRc1IwRkJha003UVVGRGNFTXNZMEZCU1VNc1UwRkJVemxHTEdOQlFWUXNRMEZCZDBJc1QwRkJlRUlzUTBGQlNpeEZRVUZ6UTNkSExHRkJRV0UzU1N4SlFVRmlMRU5CUVd0Q2FVa3NTMEZCYkVJc1IwRkJNRUpGTEZOQlFWTkdMRXRCUVc1RE8wRkJRM1JETEdOQlFVbEZMRk5CUVZNNVJpeGpRVUZVTEVOQlFYZENMRkZCUVhoQ0xFTkJRVW9zUlVGQmRVTjNSeXhoUVVGaE4wa3NTVUZCWWl4RFFVRnJRbTVETEUxQlFXeENMRWRCUVRKQ2Mwc3NVMEZCVTNSTExFMUJRWEJETzBGQlEzWkRMR05CUVVselN5eFRRVUZUT1VZc1kwRkJWQ3hEUVVGM1FpeFZRVUY0UWl4RFFVRktMRVZCUVhsRGQwY3NZVUZCWVRkSkxFbEJRV0lzUTBGQmEwSTFSQ3hSUVVGc1FpeEhRVUUyUWl0TUxGTkJRVk12VEN4UlFVRjBRenRCUVVONlF5eGpRVUZKSzB3c1UwRkJVemxHTEdOQlFWUXNRMEZCZDBJc1ZVRkJlRUlzUTBGQlNpeEZRVUY1UTNkSExHRkJRV0UzU1N4SlFVRmlMRU5CUVd0Q1F5eFJRVUZzUWl4SFFVRTJRbXRKTEZOQlFWTnNTU3hSUVVGMFF6dEJRVU14UXpzN1FVRkZSRFJKTEhGQ1FVRmhOMGtzU1VGQllpeERRVUZyUW0xQ0xFMUJRV3hDTEVkQlFUSkNaMGdzVTBGQlUyaElMRTFCUVhCRE96dEJRVVZCTzBGQlEwRXNXVUZCU1cxQ0xIVkNRVUYxUWpaR0xGTkJRVk5xU3l4TlFVRndRenRCUVVOQkxGbEJRVWtzUTBGQlEyOUZMRzlDUVVGTUxFVkJRVEpDZFVjc1lVRkJZVGRKTEVsQlFXSXNRMEZCYTBKelF5eHZRa0ZCYkVJc1IwRkJlVU5CTEc5Q1FVRjZRenM3UVVGRk0wSnFSeXhuUWtGQlVXZEVMRWRCUVZJc1EwRkJXU3hwUTBGQldpeEZRVUVyUXpoSkxGRkJRUzlETEVWQlFYbEVWU3haUVVGNlJEczdRVUZGUVR0QlFVTkJPMEZCUTBFN1FVRkRRWHBMTEdOQlFVMWhMRWxCUVU0c1EwRkJWMmxDTEZkQlFWZ3NRMEZCZFVJeVNTeFpRVUYyUWl4RlFVRnhReXhWUVVGRE1Va3NTMEZCUkN4RlFVRlhPMEZCUXpsRE9VUXNhMEpCUVZGblJDeEhRVUZTTEVOQlFWa3NhME5CUVZvc1JVRkJaMFJqTEV0QlFXaEVPenRCUVVWQkxHTkJRVWwwUXl4VFFVRlRjME1zVFVGQlRVZ3NTVUZCVGl4RFFVRlhia01zVFVGQmVFSTdRVUZEUVN4alFVRkpkMHNzVTBGQlUyeEpMRTFCUVUxSUxFbEJRVTRzUTBGQlYwTXNVVUZCZUVJN08wRkJSVUVzWTBGQlNUWkpMR2xDUVVGcFFqRkxMRTFCUVUxNVNpeGhRVUZPTEVOQlFXOUNVU3hOUVVGd1FpeERRVUZ5UWp0QlFVTkJMR2xDUVVGUGFrc3NUVUZCVFhsS0xHRkJRVTRzUTBGQmIwSlJMRTFCUVhCQ0xFTkJRVkE3UVVGRFFTeGpRVUZKVXl4alFVRktMRVZCUVc5Q1FTeGxRVUZsZEVvc2FVSkJRV1k3TzBGQlJYQkNMR05CUVVsWExFMUJRVTFJTEVsQlFVNHNRMEZCVjBrc1NVRkJXQ3hIUVVGclFpeEhRVUYwUWl4RlFVRXlRanRCUVVONlFpOUVMRzlDUVVGUlowUXNSMEZCVWl4RFFVRlpMRzFEUVVGYUxFVkJRV2xFWXl4TlFVRk5TQ3hKUVVGT0xFTkJRVmMwU1N4cFFrRkJOVVFzUlVGQkswVlFMRTFCUVM5Rk8wRkJRMEZUTERaQ1FVRnBRaXc0UWtGQmIwSXhTeXhOUVVGTmVVSXNUVUZCTVVJc1JVRkJhME4zU1N4TlFVRnNReXhGUVVFd1EycExMRTFCUVUxaExFbEJRV2hFTEVWQlFYTkVhMElzVFVGQlRVZ3NTVUZCVGl4RFFVRlhORWtzYVVKQlFXcEZMRU5CUVdwQ08wRkJRMEY0U3l4clFrRkJUWGxLTEdGQlFVNHNRMEZCYjBKUkxFMUJRWEJDTEVsQlFUaENVeXhqUVVFNVFqdEJRVU5FTEZkQlNrUXNUVUZKVHl4SlFVRkpNMGtzVFVGQlRVZ3NTVUZCVGl4RFFVRlhTU3hKUVVGWUxFdEJRVzlDTEVkQlFYaENMRVZCUVRaQ08wRkJRMnhETDBRc2IwSkJRVkZuUkN4SFFVRlNMRU5CUVZrc2QwTkJRVm9zUlVGQmMwUmpMRXRCUVhSRUxFVkJRVFpFTDBJc1RVRkJUWGxLTEdGQlFXNUZPenRCUVVWQk8wRkJRMEVzWjBKQlFVbGpMRk5CUVZNc2FVTkJRWFZDZGtzc1MwRkJka0lzUlVGQk9FSnBTeXhOUVVFNVFpeEZRVUZ6UTNoTExFMUJRWFJETEVWQlFUaERMRWxCUVRsRExFVkJRVzlFYzBNc1RVRkJUVWdzU1VGQlRpeERRVUZYZEVVc1MwRkJMMFFzUlVGQmMwVnZUaXhsUVVGbGRrWXNVVUZCY2tZc1JVRkJLMFp3UkN4TlFVRk5TQ3hKUVVGT0xFTkJRVmR2UXl4UFFVRXhSeXhGUVVGdFNFVXNiMEpCUVc1SUxFTkJRV0k3UVVGRFFXeEZMR3RDUVVGTmMwSXNWVUZCVGl4RFFVRnBRakpKTEUxQlFXcENMRWxCUVRKQ1RTeE5RVUV6UWpzN1FVRkZRV2hHTEc5Q1FVRlJaMFlzVFVGQlVqdEJRVU5CUnl3eVFrRkJaWFJFTEV0QlFXWXNRMEZCY1VKdFJDeE5RVUZ5UWp0QlFVTkVMRmRCVkUwc1RVRlRRVHRCUVVOTWJrY3NiVUpCUVU5eVF5eE5RVUZOU0N4SlFVRk9MRU5CUVZjd1F5eEpRVUZzUWp0QlFVTkVPMEZCUTBZc1UwRXhRa1E3UVVFeVFrUXNUMEU1UkUwc1EwRkJVRHRCUVdkRlJEczdRVUZGUkRzN096c3JRa0ZEVjNSRUxFY3NSVUZCU3p0QlFVTmtMRlZCUVVsb1FpeFJRVUZSTEVsQlFWbzdPMEZCUlVFc1ZVRkJTWE5MTEZkQlFWZDBTeXhOUVVGTmJVUXNWVUZCVGl4RFFVRnBRbTVETEVsQlFVbFpMRWxCUVVvc1EwRkJVMFlzUlVGQk1VSXNRMEZCWmp0QlFVTkJORWtzWlVGQlUxb3NWVUZCVkN4RFFVRnZRakZKTEVkQlFYQkNPMEZCUTBRN08wRkJSVVE3T3pzN2IwTkJRMmRDUVN4SExFVkJRVXM3UVVGRGJrSXNWVUZCU1doQ0xGRkJRVkVzU1VGQldqczdRVUZGUkR0QlFVTkJMRlZCUVVrMlFpeFhRVUZYWWl4SlFVRkpVU3hKUVVGS0xFTkJRVk50U2l4TFFVRlVMRU5CUVdVc1EwRkJaaXhGUVVGclFpeERRVUZETEVWQlFXNUNMRU5CUVdZN08wRkJSVUVzVlVGQlNYUkxMRkZCUVZFN1FVRkRWblpETEdOQlFVMXJSQ3hKUVVGSmJFUXNTVUZFUVR0QlFVVldNRVFzWTBGQlRWSXNTVUZCU1Zrc1NVRkJTaXhEUVVGVGEwVXNUVUZHVER0QlFVZFdNMGtzWVVGQlN6QkZMRkZCU0VzN1FVRkpWbkJETEdkQ1FVRlJkVUlzU1VGQlNWa3NTVUZCU2l4RFFVRlRia01zVFVGS1VEdEJRVXRXYmtNc1pVRkJUekJFTEVsQlFVbFpMRWxCUVVvc1EwRkJVM1JGTEV0QlRFNDdRVUZOVmxVc2EwSkJRVlZuUkN4SlFVRkpXU3hKUVVGS0xFTkJRVk0xUkN4UlFVNVVPenRCUVZGV05FMHNZVUZCU3l4aFFVRkRPVTBzU1VGQlJDeEZRVUZWTzBGQlEySXNZMEZCU1N0TkxGRkJRVkVzUjBGQldqdEJRVU5CTEdOQlFVa3ZUU3hKUVVGS0xFVkJRVlU3UVVGRFVpdE5MRzlDUVVGUkwwMHNTVUZCVWp0QlFVTkVPenRCUVVWRU8wRkJRMEZyUXl4blFrRkJUV0VzU1VGQlRpeERRVUZYYVVJc1YwRkJXQ3hEUVVGMVFqdEJRVU55UW1sRExHZENRVUZKTDBNc1NVRkJTU3RETEVWQlJHRXNSVUZEVkdwSExFMUJRVTBzVlVGRVJ5eEZRVU5UTUVRc1RVRkJUVklzU1VGQlNWVXNSVUZFYmtJc1JVRkRkVUpCTEVsQlFVbFdMRWxCUVVsUkxFbEJSQzlDTzBGQlJYSkNTU3hyUWtGQlRTeEZRVUZGU1N4TlFVRk5Oa2tzUzBGQlVqdEJRVVpsTEZkQlFYWkNPMEZCU1VRN1FVRnVRbE1zVDBGQldqczdRVUZ6UWtFc1ZVRkJTVGRMTEUxQlFVMXhTeXh6UWtGQlZpeEZRVUZyUXp0QlFVTm9RM0JOTEdkQ1FVRlJhVXdzU1VGQlVpeERRVUZoTEdkRFFVRmlMRVZCUVN0RE4wa3NTMEZCTDBNN1FVRkRRVXdzWTBGQlRYRkxMSE5DUVVGT0xFTkJRVFpDYUVzc1MwRkJOMEk3UVVGRFJEdEJRVU5FT3p0QlFVVkVPenM3TzI5RFFVTm5RbGNzUnl4RlFVRkxPMEZCUTI1Q0xGVkJRVWxvUWl4UlFVRlJMRWxCUVZvN08wRkJSVVE3UVVGRFFTeFZRVUZKTmtJc1YwRkJWMklzU1VGQlNWa3NTVUZCU2l4RFFVRlRReXhSUVVGNFFqczdRVUZGUVN4VlFVRkpiRVFzVTBGQlUzRkNMRTFCUVUxelFpeFZRVUZPTEVOQlFXbENUeXhSUVVGcVFpeERRVUZpTzBGQlEwRXNWVUZCU1d4RUxFMUJRVW9zUlVGQldUdEJRVU5XTEZsQlFVa3dRaXhSUVVGUk8wRkJRMVoyUXl4blFrRkJUV3RFTEVsQlFVbHNSQ3hKUVVSQk8wRkJSVlpZTEdWQlFVc3dSU3hSUVVaTE8wRkJSMVkzUkN4dlFrRkJWV2RFTEVsQlFVbFpMRWxCUVVvc1EwRkJVelZFTEZGQlNGUTdPMEZCUzFZMFRTeGxRVUZMTEdGQlFVTTVUU3hKUVVGRUxFVkJRVlU3UVVGRFlpeG5Ra0ZCU1N0TkxGRkJRVkVzUjBGQldqdEJRVU5CTEdkQ1FVRkpMMDBzU1VGQlNpeEZRVUZWTzBGQlExSXJUU3h6UWtGQlVTOU5MRWxCUVZJN1FVRkRSRHM3UVVGRlJEdEJRVU5CTEdkQ1FVRkpLMDBzVlVGQlZTeEhRVUZrTEVWQlFXMUNPMEZCUTJwQ2JFMHNjVUpCUVU5dFRTeE5RVUZRTzBGQlEwUTdPMEZCUlVFN1FVRkRRVGxMTEd0Q1FVRk5ZU3hKUVVGT0xFTkJRVmRwUWl4WFFVRllMRU5CUVhWQ08wRkJRM0pDYVVNc2EwSkJRVWt2UXl4SlFVRkpLME1zUlVGRVlTeEZRVU5VYWtjc1RVRkJUU3hWUVVSSExFVkJRMU13UkN4TlFVRk5VaXhKUVVGSlZTeEZRVVJ1UWl4RlFVTjFRa0VzU1VGQlNWWXNTVUZCU1ZFc1NVRkVMMEk3UVVGRmNrSkpMRzlDUVVGTkxFVkJRVVZKTEUxQlFVMDJTU3hMUVVGU0xFVkJRV1V2UlN4UlFVRlJPVVlzVFVGQlRYbENMRTFCUVRkQ08wRkJSbVVzWVVGQmRrSTdRVUZKUkR0QlFYSkNVU3hUUVVGYU96dEJRWGRDUXl4WlFVRkpla0lzVFVGQlRYRkxMSE5DUVVGV0xFVkJRV3RETzBGQlEyaERjRTBzYTBKQlFWRm5SQ3hIUVVGU0xFTkJRVmtzYzBKQlFWb3NSVUZCYjBOYUxFdEJRWEJETzBGQlEwRk1MR2RDUVVGTmNVc3NjMEpCUVU0c1EwRkJOa0pvU3l4TFFVRTNRanRCUVVORU8wRkJRMFlzVDBFM1FrWXNUVUUyUWxFN1FVRkRURXdzWTBGQlRXRXNTVUZCVGl4RFFVRlhhVUlzVjBGQldDeERRVUYxUWp0QlFVTnlRbWxETEdOQlFVa3ZReXhKUVVGSkswTXNSVUZFWVN4RlFVTlVha2NzVFVGQlRTeFZRVVJITEVWQlExTXdSQ3hOUVVGTlVpeEpRVUZKVlN4RlFVUnVRaXhGUVVOMVFrRXNTVUZCU1ZZc1NVRkJTVkVzU1VGRUwwSTdRVUZGY2tKSkxHZENRVUZOTEVWQlFVVkpMRTFCUVUwc1IwRkJVaXhGUVVGaE9FUXNVVUZCVVRsR0xFMUJRVTE1UWl4TlFVRXpRanRCUVVabExGTkJRWFpDTzBGQlNVUTdRVUZEUmpzN08zZENRWEJXVnp0QlFVRkZMR0ZCUVU4c1MwRkJTMEVzVFVGQldqdEJRVUZ4UWpzN1FVRkZia003T3pzN096czdkMEpCU1dkQ08wRkJRVVVzWVVGQlR5eExRVUZMTUVJc1ZVRkJXanRCUVVGNVFqczdRVUZGTTBNN096czdPenM3ZDBKQlNXZENPMEZCUVVVc1lVRkJUeXhMUVVGTE4wSXNWVUZCV2p0QlFVRjVRanM3TzB0QkwwWTNRenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN2EwSkJNbUZsSzBnc1R6czdPenM3T3pzN096czdPenM3T3pzN096czdPenM3T3pzN08wRkRNMkZtT3pzN096czdPenM3T3pzN096czdPenM3T3pzN096dEJRWFZDUVRzN096czdPenM3T3pzN1NVRlhUVEJDTEdVN1FVRkRTanM3T3pzN08wRkJUMEVzTWtKQlFWbDJSQ3hMUVVGYUxFVkJRVzFDY2tzc1IwRkJia0lzUlVGQmQwSnRUU3hIUVVGNFFpeEZRVUUyUW01RkxGRkJRVGRDTEVWQlFYVkRPMEZCUVVFN08wRkJRM0pETEZGQlFVbHVSaXhSUVVGUkxFbEJRVm83TzBGQlJVRkJMRlZCUVUxNVFpeE5RVUZPTEVkQlFXVXJSaXhMUVVGbU8wRkJRMEY0U0N4VlFVRk5aU3hKUVVGT0xFZEJRV0UxUkN4SFFVRmlPMEZCUTBFMlF5eFZRVUZOWVN4SlFVRk9MRWRCUVdGNVNTeEhRVUZpTzBGQlEwRjBTaXhWUVVGTk5FZ3NVMEZCVGl4SFFVRnJRbnBETEZGQlFXeENPenRCUVVWQmJrWXNWVUZCVFdkTUxGRkJRVTRzUjBGQmFVSXNSVUZCYWtJN1FVRkRRV2hNTEZWQlFVMVhMR3RDUVVGT08wRkJRMFE3T3pzN2VVTkJSVzlDTzBGQlEyNUNMRlZCUVVsWUxGRkJRVkVzU1VGQldqczdRVUZGUVVFc1dVRkJUVEpJTEZOQlFVNHNSMEZCYTBJelNDeE5RVUZOWVN4SlFVRk9MRU5CUVZkRExGZEJRVmdzUTBGQmRVSmtMRTFCUVUxbExFbEJRVGRDTEVWQlFXMURMRlZCUVVORExFZEJRVVFzUlVGQlV6dEJRVU0xUkM5RExHZENRVUZSWjBRc1IwRkJVaXhEUVVGWkxIRkNRVUZ4UW1wQ0xFMUJRVTFsTEVsQlFUTkNMRWRCUVd0RExGRkJRVGxETEVWQlFYZEVReXhIUVVGNFJEdEJRVU5CYUVJc1kwRkJUV2RNTEZGQlFVNHNRMEZCWlRsR0xFbEJRV1lzUTBGQmIwSnNSU3hIUVVGd1FqdEJRVU5FTEU5QlNHbENMRU5CUVd4Q096dEJRVXRCT3pzN096czdPenM3T3pzN096czdRVUZuUWtRN096dDNRMEZGYlVJN1FVRkRiRUlzVlVGQlNXaENMRkZCUVZFc1NVRkJXanM3UVVGRlFVRXNXVUZCVFRKSUxGTkJRVTRzUTBGQlowSjRSeXhOUVVGb1FqczdRVUZGUVRzN08wRkJSMFE3T3pzd1FrRkpTemhLTEZFc1JVRkJWVHRCUVVOa0xGVkJRVWxxVEN4UlFVRlJMRWxCUVZvN1FVRkRRVUVzV1VGQlRXZE1MRkZCUVU0c1EwRkJaWHBMTEU5QlFXWXNRMEZCZFVJc1ZVRkJRMnRKTEUxQlFVUXNSVUZCV1R0QlFVTnFRM2RETEdsQ1FVRlRMMG9zWVVGQlZDeERRVUYxUWl0S0xGTkJRVk01U3l4UlFVRm9ReXhGUVVFd1EzTkpMRTFCUVRGRE8wRkJRMFFzVDBGR1JEdEJRVWRFT3pzN2QwSkJVR003UVVGQlJTeGhRVUZQTEV0QlFVdGlMRk5CUVZvN1FVRkJkMEk3T3pzN08ydENRVlUxUW0xRUxHVTdPenM3T3pzN096dEJRM0JIWml4clFrRkJhMElzZVVRN096czdPenM3UVVOQmJFSXNhMEpCUVd0Q0xIbEVPenM3T3pzN096czdPMEZEUVd4Q08wRkJRMEVzYzBRN096czdPenM3UVVORVFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRVU3T3pzN096czdRVU5LUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CT3p0QlFVVkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRXNhME5CUVd0RExGVkJRVlVzUlVGQlJUdEJRVU01UXl4dFFrRkJiVUlzYzBOQlFYTkRPMEZCUTNwRUxFTkJRVU1zYjBOQlFXOURPMEZCUTNKRE8wRkJRMEU3UVVGRFFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJPMEZCUTBFN1FVRkRRVHRCUVVOQk8wRkJRMEU3UVVGRFFUdEJRVU5CTEVkQlFVYzdRVUZEU0N4RFFVRkRMRmM3T3pzN096czdPMEZEYUVORU8wRkJRMEU3TzBGQlJVRXNNRU5CUVRCRExHbERRVUZ2UXl4Rk96czdPenM3TzBGRFNEbEZPMEZCUTBFN1FVRkRRVHM3UVVGRlFUdEJRVU5CTzBGQlEwRTdRVUZEUVR0QlFVTkJMRU5CUVVNc1JUczdPenM3T3pzN096czdPenM3T3pzN096czdPenM3UVVOU1JEczdPenRCUVVOQk96czdPMEZCUTBFN096czdPenRSUVVWUk1VSXNUenRSUVVGVE9VY3NhMEk3VVVGQmIwSm9SQ3hyUWlJc0ltWnBiR1VpT2lKVGVXNWphR1Z5TG1weklpd2ljMjkxY21ObGMwTnZiblJsYm5RaU9sc2lLR1oxYm1OMGFXOXVJSGRsWW5CaFkydFZibWwyWlhKellXeE5iMlIxYkdWRVpXWnBibWwwYVc5dUtISnZiM1FzSUdaaFkzUnZjbmtwSUh0Y2JseDBhV1lvZEhsd1pXOW1JR1Y0Y0c5eWRITWdQVDA5SUNkdlltcGxZM1FuSUNZbUlIUjVjR1Z2WmlCdGIyUjFiR1VnUFQwOUlDZHZZbXBsWTNRbktWeHVYSFJjZEcxdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm1GamRHOXllU2dwTzF4dVhIUmxiSE5sSUdsbUtIUjVjR1Z2WmlCa1pXWnBibVVnUFQwOUlDZG1kVzVqZEdsdmJpY2dKaVlnWkdWbWFXNWxMbUZ0WkNsY2JseDBYSFJrWldacGJtVW9YQ0pUZVc1amFHVnlYQ0lzSUZ0ZExDQm1ZV04wYjNKNUtUdGNibHgwWld4elpTQnBaaWgwZVhCbGIyWWdaWGh3YjNKMGN5QTlQVDBnSjI5aWFtVmpkQ2NwWEc1Y2RGeDBaWGh3YjNKMGMxdGNJbE41Ym1Ob1pYSmNJbDBnUFNCbVlXTjBiM0o1S0NrN1hHNWNkR1ZzYzJWY2JseDBYSFJ5YjI5MFcxd2lYQ0pkSUQwZ2NtOXZkRnRjSWx3aVhTQjhmQ0I3ZlN3Z2NtOXZkRnRjSWx3aVhWdGNJbE41Ym1Ob1pYSmNJbDBnUFNCbVlXTjBiM0o1S0NrN1hHNTlLU2gwYUdsekxDQm1kVzVqZEdsdmJpZ3BJSHRjYm5KbGRIVnliaUJjYmx4dVhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVpQXZMMXh1THk4Z2QyVmljR0ZqYXk5MWJtbDJaWEp6WVd4TmIyUjFiR1ZFWldacGJtbDBhVzl1SWl3aUlGeDBMeThnVkdobElHMXZaSFZzWlNCallXTm9aVnh1SUZ4MGRtRnlJR2x1YzNSaGJHeGxaRTF2WkhWc1pYTWdQU0I3ZlR0Y2JseHVJRngwTHk4Z1ZHaGxJSEpsY1hWcGNtVWdablZ1WTNScGIyNWNiaUJjZEdaMWJtTjBhVzl1SUY5ZmQyVmljR0ZqYTE5eVpYRjFhWEpsWDE4b2JXOWtkV3hsU1dRcElIdGNibHh1SUZ4MFhIUXZMeUJEYUdWamF5QnBaaUJ0YjJSMWJHVWdhWE1nYVc0Z1kyRmphR1ZjYmlCY2RGeDBhV1lvYVc1emRHRnNiR1ZrVFc5a2RXeGxjMXR0YjJSMWJHVkpaRjBwWEc0Z1hIUmNkRngwY21WMGRYSnVJR2x1YzNSaGJHeGxaRTF2WkhWc1pYTmJiVzlrZFd4bFNXUmRMbVY0Y0c5eWRITTdYRzVjYmlCY2RGeDBMeThnUTNKbFlYUmxJR0VnYm1WM0lHMXZaSFZzWlNBb1lXNWtJSEIxZENCcGRDQnBiblJ2SUhSb1pTQmpZV05vWlNsY2JpQmNkRngwZG1GeUlHMXZaSFZzWlNBOUlHbHVjM1JoYkd4bFpFMXZaSFZzWlhOYmJXOWtkV3hsU1dSZElEMGdlMXh1SUZ4MFhIUmNkR2s2SUcxdlpIVnNaVWxrTEZ4dUlGeDBYSFJjZEd3NklHWmhiSE5sTEZ4dUlGeDBYSFJjZEdWNGNHOXlkSE02SUh0OVhHNGdYSFJjZEgwN1hHNWNiaUJjZEZ4MEx5OGdSWGhsWTNWMFpTQjBhR1VnYlc5a2RXeGxJR1oxYm1OMGFXOXVYRzRnWEhSY2RHMXZaSFZzWlhOYmJXOWtkV3hsU1dSZExtTmhiR3dvYlc5a2RXeGxMbVY0Y0c5eWRITXNJRzF2WkhWc1pTd2diVzlrZFd4bExtVjRjRzl5ZEhNc0lGOWZkMlZpY0dGamExOXlaWEYxYVhKbFgxOHBPMXh1WEc0Z1hIUmNkQzh2SUVac1lXY2dkR2hsSUcxdlpIVnNaU0JoY3lCc2IyRmtaV1JjYmlCY2RGeDBiVzlrZFd4bExtd2dQU0IwY25WbE8xeHVYRzRnWEhSY2RDOHZJRkpsZEhWeWJpQjBhR1VnWlhod2IzSjBjeUJ2WmlCMGFHVWdiVzlrZFd4bFhHNGdYSFJjZEhKbGRIVnliaUJ0YjJSMWJHVXVaWGh3YjNKMGN6dGNiaUJjZEgxY2JseHVYRzRnWEhRdkx5QmxlSEJ2YzJVZ2RHaGxJRzF2WkhWc1pYTWdiMkpxWldOMElDaGZYM2RsWW5CaFkydGZiVzlrZFd4bGMxOWZLVnh1SUZ4MFgxOTNaV0p3WVdOclgzSmxjWFZwY21WZlh5NXRJRDBnYlc5a2RXeGxjenRjYmx4dUlGeDBMeThnWlhod2IzTmxJSFJvWlNCdGIyUjFiR1VnWTJGamFHVmNiaUJjZEY5ZmQyVmljR0ZqYTE5eVpYRjFhWEpsWDE4dVl5QTlJR2x1YzNSaGJHeGxaRTF2WkhWc1pYTTdYRzVjYmlCY2RDOHZJR2xrWlc1MGFYUjVJR1oxYm1OMGFXOXVJR1p2Y2lCallXeHNhVzVuSUdoaGNtMXZibmtnYVcxd2IzSjBjeUIzYVhSb0lIUm9aU0JqYjNKeVpXTjBJR052Ym5SbGVIUmNiaUJjZEY5ZmQyVmljR0ZqYTE5eVpYRjFhWEpsWDE4dWFTQTlJR1oxYm1OMGFXOXVLSFpoYkhWbEtTQjdJSEpsZEhWeWJpQjJZV3gxWlRzZ2ZUdGNibHh1SUZ4MEx5OGdaR1ZtYVc1bElHZGxkSFJsY2lCbWRXNWpkR2x2YmlCbWIzSWdhR0Z5Ylc5dWVTQmxlSEJ2Y25SelhHNGdYSFJmWDNkbFluQmhZMnRmY21WeGRXbHlaVjlmTG1RZ1BTQm1kVzVqZEdsdmJpaGxlSEJ2Y25SekxDQnVZVzFsTENCblpYUjBaWElwSUh0Y2JpQmNkRngwYVdZb0lWOWZkMlZpY0dGamExOXlaWEYxYVhKbFgxOHVieWhsZUhCdmNuUnpMQ0J1WVcxbEtTa2dlMXh1SUZ4MFhIUmNkRTlpYW1WamRDNWtaV1pwYm1WUWNtOXdaWEowZVNobGVIQnZjblJ6TENCdVlXMWxMQ0I3WEc0Z1hIUmNkRngwWEhSamIyNW1hV2QxY21GaWJHVTZJR1poYkhObExGeHVJRngwWEhSY2RGeDBaVzUxYldWeVlXSnNaVG9nZEhKMVpTeGNiaUJjZEZ4MFhIUmNkR2RsZERvZ1oyVjBkR1Z5WEc0Z1hIUmNkRngwZlNrN1hHNGdYSFJjZEgxY2JpQmNkSDA3WEc1Y2JpQmNkQzh2SUdkbGRFUmxabUYxYkhSRmVIQnZjblFnWm5WdVkzUnBiMjRnWm05eUlHTnZiWEJoZEdsaWFXeHBkSGtnZDJsMGFDQnViMjR0YUdGeWJXOXVlU0J0YjJSMWJHVnpYRzRnWEhSZlgzZGxZbkJoWTJ0ZmNtVnhkV2x5WlY5ZkxtNGdQU0JtZFc1amRHbHZiaWh0YjJSMWJHVXBJSHRjYmlCY2RGeDBkbUZ5SUdkbGRIUmxjaUE5SUcxdlpIVnNaU0FtSmlCdGIyUjFiR1V1WDE5bGMwMXZaSFZzWlNBL1hHNGdYSFJjZEZ4MFpuVnVZM1JwYjI0Z1oyVjBSR1ZtWVhWc2RDZ3BJSHNnY21WMGRYSnVJRzF2WkhWc1pWc25aR1ZtWVhWc2RDZGRPeUI5SURwY2JpQmNkRngwWEhSbWRXNWpkR2x2YmlCblpYUk5iMlIxYkdWRmVIQnZjblJ6S0NrZ2V5QnlaWFIxY200Z2JXOWtkV3hsT3lCOU8xeHVJRngwWEhSZlgzZGxZbkJoWTJ0ZmNtVnhkV2x5WlY5ZkxtUW9aMlYwZEdWeUxDQW5ZU2NzSUdkbGRIUmxjaWs3WEc0Z1hIUmNkSEpsZEhWeWJpQm5aWFIwWlhJN1hHNGdYSFI5TzF4dVhHNGdYSFF2THlCUFltcGxZM1F1Y0hKdmRHOTBlWEJsTG1oaGMwOTNibEJ5YjNCbGNuUjVMbU5oYkd4Y2JpQmNkRjlmZDJWaWNHRmphMTl5WlhGMWFYSmxYMTh1YnlBOUlHWjFibU4wYVc5dUtHOWlhbVZqZEN3Z2NISnZjR1Z5ZEhrcElIc2djbVYwZFhKdUlFOWlhbVZqZEM1d2NtOTBiM1I1Y0dVdWFHRnpUM2R1VUhKdmNHVnlkSGt1WTJGc2JDaHZZbXBsWTNRc0lIQnliM0JsY25SNUtUc2dmVHRjYmx4dUlGeDBMeThnWDE5M1pXSndZV05yWDNCMVlteHBZMTl3WVhSb1gxOWNiaUJjZEY5ZmQyVmljR0ZqYTE5eVpYRjFhWEpsWDE4dWNDQTlJRndpWENJN1hHNWNiaUJjZEM4dklFeHZZV1FnWlc1MGNua2diVzlrZFd4bElHRnVaQ0J5WlhSMWNtNGdaWGh3YjNKMGMxeHVJRngwY21WMGRYSnVJRjlmZDJWaWNHRmphMTl5WlhGMWFYSmxYMThvWDE5M1pXSndZV05yWDNKbGNYVnBjbVZmWHk1eklEMGdNVFl6S1R0Y2JseHVYRzVjYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTSUM4dlhHNHZMeUIzWldKd1lXTnJMMkp2YjNSemRISmhjQ0ExTm1KalpXUTVPREUzT1RjM01qZGlaVEUxTmlJc0luWmhjaUJqYjNKbElEMGdiVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQjdkbVZ5YzJsdmJqb2dKekl1TkM0d0ozMDdYRzVwWmloMGVYQmxiMllnWDE5bElEMDlJQ2R1ZFcxaVpYSW5LVjlmWlNBOUlHTnZjbVU3SUM4dklHVnpiR2x1ZEMxa2FYTmhZbXhsTFd4cGJtVWdibTh0ZFc1a1pXWmNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJOdmNtVXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJREJjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TQTJJRGNnT0NBNUlpd2lMeThnYUhSMGNITTZMeTluYVhSb2RXSXVZMjl0TDNwc2IybHliMk5yTDJOdmNtVXRhbk12YVhOemRXVnpMemcySTJsemMzVmxZMjl0YldWdWRDMHhNVFUzTlRrd01qaGNiblpoY2lCbmJHOWlZV3dnUFNCdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhSNWNHVnZaaUIzYVc1a2IzY2dJVDBnSjNWdVpHVm1hVzVsWkNjZ0ppWWdkMmx1Wkc5M0xrMWhkR2dnUFQwZ1RXRjBhRnh1SUNBL0lIZHBibVJ2ZHlBNklIUjVjR1Z2WmlCelpXeG1JQ0U5SUNkMWJtUmxabWx1WldRbklDWW1JSE5sYkdZdVRXRjBhQ0E5UFNCTllYUm9JRDhnYzJWc1ppQTZJRVoxYm1OMGFXOXVLQ2R5WlhSMWNtNGdkR2hwY3ljcEtDazdYRzVwWmloMGVYQmxiMllnWDE5bklEMDlJQ2R1ZFcxaVpYSW5LVjlmWnlBOUlHZHNiMkpoYkRzZ0x5OGdaWE5zYVc1MExXUnBjMkZpYkdVdGJHbHVaU0J1YnkxMWJtUmxabHh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZloyeHZZbUZzTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeFhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVnTmlBM0lEZ2dPU0lzSWk4dklGUm9ZVzVySjNNZ1NVVTRJR1p2Y2lCb2FYTWdablZ1Ym5rZ1pHVm1hVzVsVUhKdmNHVnlkSGxjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnSVhKbGNYVnBjbVVvSnk0dlgyWmhhV3h6Snlrb1puVnVZM1JwYjI0b0tYdGNiaUFnY21WMGRYSnVJRTlpYW1WamRDNWtaV1pwYm1WUWNtOXdaWEowZVNoN2ZTd2dKMkVuTENCN1oyVjBPaUJtZFc1amRHbHZiaWdwZXlCeVpYUjFjbTRnTnpzZ2ZYMHBMbUVnSVQwZ056dGNibjBwTzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZaR1Z6WTNKcGNIUnZjbk11YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURKY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0EySURjZ09DQTVJaXdpZG1GeUlITjBiM0psSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5emFHRnlaV1FuS1NnbmQydHpKeWxjYmlBZ0xDQjFhV1FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmRXbGtKeWxjYmlBZ0xDQlRlVzFpYjJ3Z0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZloyeHZZbUZzSnlrdVUzbHRZbTlzWEc0Z0lDd2dWVk5GWDFOWlRVSlBUQ0E5SUhSNWNHVnZaaUJUZVcxaWIyd2dQVDBnSjJaMWJtTjBhVzl1Snp0Y2JseHVkbUZ5SUNSbGVIQnZjblJ6SUQwZ2JXOWtkV3hsTG1WNGNHOXlkSE1nUFNCbWRXNWpkR2x2YmlodVlXMWxLWHRjYmlBZ2NtVjBkWEp1SUhOMGIzSmxXMjVoYldWZElIeDhJQ2h6ZEc5eVpWdHVZVzFsWFNBOVhHNGdJQ0FnVlZORlgxTlpUVUpQVENBbUppQlRlVzFpYjJ4YmJtRnRaVjBnZkh3Z0tGVlRSVjlUV1UxQ1Qwd2dQeUJUZVcxaWIyd2dPaUIxYVdRcEtDZFRlVzFpYjJ3dUp5QXJJRzVoYldVcEtUdGNibjA3WEc1Y2JpUmxlSEJ2Y25SekxuTjBiM0psSUQwZ2MzUnZjbVU3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOTNhM011YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SUROY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSW5aaGNpQmhiazlpYW1WamRDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMkZ1TFc5aWFtVmpkQ2NwWEc0Z0lDd2dTVVU0WDBSUFRWOUVSVVpKVGtVZ1BTQnlaWEYxYVhKbEtDY3VMMTlwWlRndFpHOXRMV1JsWm1sdVpTY3BYRzRnSUN3Z2RHOVFjbWx0YVhScGRtVWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOTBieTF3Y21sdGFYUnBkbVVuS1Z4dUlDQXNJR1JRSUNBZ0lDQWdJQ0FnSUNBZ0lEMGdUMkpxWldOMExtUmxabWx1WlZCeWIzQmxjblI1TzF4dVhHNWxlSEJ2Y25SekxtWWdQU0J5WlhGMWFYSmxLQ2N1TDE5a1pYTmpjbWx3ZEc5eWN5Y3BJRDhnVDJKcVpXTjBMbVJsWm1sdVpWQnliM0JsY25SNUlEb2dablZ1WTNScGIyNGdaR1ZtYVc1bFVISnZjR1Z5ZEhrb1R5d2dVQ3dnUVhSMGNtbGlkWFJsY3lsN1hHNGdJR0Z1VDJKcVpXTjBLRThwTzF4dUlDQlFJRDBnZEc5UWNtbHRhWFJwZG1Vb1VDd2dkSEoxWlNrN1hHNGdJR0Z1VDJKcVpXTjBLRUYwZEhKcFluVjBaWE1wTzF4dUlDQnBaaWhKUlRoZlJFOU5YMFJGUmtsT1JTbDBjbmtnZTF4dUlDQWdJSEpsZEhWeWJpQmtVQ2hQTENCUUxDQkJkSFJ5YVdKMWRHVnpLVHRjYmlBZ2ZTQmpZWFJqYUNobEtYc2dMeW9nWlcxd2RIa2dLaThnZlZ4dUlDQnBaaWduWjJWMEp5QnBiaUJCZEhSeWFXSjFkR1Z6SUh4OElDZHpaWFFuSUdsdUlFRjBkSEpwWW5WMFpYTXBkR2h5YjNjZ1ZIbHdaVVZ5Y205eUtDZEJZMk5sYzNOdmNuTWdibTkwSUhOMWNIQnZjblJsWkNFbktUdGNiaUFnYVdZb0ozWmhiSFZsSnlCcGJpQkJkSFJ5YVdKMWRHVnpLVTliVUYwZ1BTQkJkSFJ5YVdKMWRHVnpMblpoYkhWbE8xeHVJQ0J5WlhSMWNtNGdUenRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl2WW1wbFkzUXRaSEF1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURSY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0EySURjZ09DQTVJaXdpZG1GeUlHbHpUMkpxWldOMElEMGdjbVZ4ZFdseVpTZ25MaTlmYVhNdGIySnFaV04wSnlrN1hHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHbDBLWHRjYmlBZ2FXWW9JV2x6VDJKcVpXTjBLR2wwS1NsMGFISnZkeUJVZVhCbFJYSnliM0lvYVhRZ0t5QW5JR2x6SUc1dmRDQmhiaUJ2WW1wbFkzUWhKeWs3WEc0Z0lISmxkSFZ5YmlCcGREdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOWhiaTF2WW1wbFkzUXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRFZjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TQTJJRGNnT0NBNUlpd2liVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpaHBkQ2w3WEc0Z0lISmxkSFZ5YmlCMGVYQmxiMllnYVhRZ1BUMDlJQ2R2WW1wbFkzUW5JRDhnYVhRZ0lUMDlJRzUxYkd3Z09pQjBlWEJsYjJZZ2FYUWdQVDA5SUNkbWRXNWpkR2x2YmljN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFYTXRiMkpxWldOMExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTJYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVZ05pQTNJRGdnT1NJc0luWmhjaUJrVUNBZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXUndKeWxjYmlBZ0xDQmpjbVZoZEdWRVpYTmpJRDBnY21WeGRXbHlaU2duTGk5ZmNISnZjR1Z5ZEhrdFpHVnpZeWNwTzF4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCeVpYRjFhWEpsS0NjdUwxOWtaWE5qY21sd2RHOXljeWNwSUQ4Z1puVnVZM1JwYjI0b2IySnFaV04wTENCclpYa3NJSFpoYkhWbEtYdGNiaUFnY21WMGRYSnVJR1JRTG1Zb2IySnFaV04wTENCclpYa3NJR055WldGMFpVUmxjMk1vTVN3Z2RtRnNkV1VwS1R0Y2JuMGdPaUJtZFc1amRHbHZiaWh2WW1wbFkzUXNJR3RsZVN3Z2RtRnNkV1VwZTF4dUlDQnZZbXBsWTNSYmEyVjVYU0E5SUhaaGJIVmxPMXh1SUNCeVpYUjFjbTRnYjJKcVpXTjBPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMmhwWkdVdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEZGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNBMklEY2dPQ0E1SWl3aWRtRnlJR2RzYjJKaGJDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyZHNiMkpoYkNjcFhHNGdJQ3dnWTI5eVpTQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZZMjl5WlNjcFhHNGdJQ3dnWTNSNElDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZZM1I0SnlsY2JpQWdMQ0JvYVdSbElDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOW9hV1JsSnlsY2JpQWdMQ0JRVWs5VVQxUlpVRVVnUFNBbmNISnZkRzkwZVhCbEp6dGNibHh1ZG1GeUlDUmxlSEJ2Y25RZ1BTQm1kVzVqZEdsdmJpaDBlWEJsTENCdVlXMWxMQ0J6YjNWeVkyVXBlMXh1SUNCMllYSWdTVk5mUms5U1EwVkVJRDBnZEhsd1pTQW1JQ1JsZUhCdmNuUXVSbHh1SUNBZ0lDd2dTVk5mUjB4UFFrRk1JRDBnZEhsd1pTQW1JQ1JsZUhCdmNuUXVSMXh1SUNBZ0lDd2dTVk5mVTFSQlZFbERJRDBnZEhsd1pTQW1JQ1JsZUhCdmNuUXVVMXh1SUNBZ0lDd2dTVk5mVUZKUFZFOGdJRDBnZEhsd1pTQW1JQ1JsZUhCdmNuUXVVRnh1SUNBZ0lDd2dTVk5mUWtsT1JDQWdJRDBnZEhsd1pTQW1JQ1JsZUhCdmNuUXVRbHh1SUNBZ0lDd2dTVk5mVjFKQlVDQWdJRDBnZEhsd1pTQW1JQ1JsZUhCdmNuUXVWMXh1SUNBZ0lDd2daWGh3YjNKMGN5QWdJRDBnU1ZOZlIweFBRa0ZNSUQ4Z1kyOXlaU0E2SUdOdmNtVmJibUZ0WlYwZ2ZId2dLR052Y21WYmJtRnRaVjBnUFNCN2ZTbGNiaUFnSUNBc0lHVjRjRkJ5YjNSdklDQTlJR1Y0Y0c5eWRITmJVRkpQVkU5VVdWQkZYVnh1SUNBZ0lDd2dkR0Z5WjJWMElDQWdJRDBnU1ZOZlIweFBRa0ZNSUQ4Z1oyeHZZbUZzSURvZ1NWTmZVMVJCVkVsRElEOGdaMnh2WW1Gc1cyNWhiV1ZkSURvZ0tHZHNiMkpoYkZ0dVlXMWxYU0I4ZkNCN2ZTbGJVRkpQVkU5VVdWQkZYVnh1SUNBZ0lDd2dhMlY1TENCdmQyNHNJRzkxZER0Y2JpQWdhV1lvU1ZOZlIweFBRa0ZNS1hOdmRYSmpaU0E5SUc1aGJXVTdYRzRnSUdadmNpaHJaWGtnYVc0Z2MyOTFjbU5sS1h0Y2JpQWdJQ0F2THlCamIyNTBZV2x1Y3lCcGJpQnVZWFJwZG1WY2JpQWdJQ0J2ZDI0Z1BTQWhTVk5mUms5U1EwVkVJQ1ltSUhSaGNtZGxkQ0FtSmlCMFlYSm5aWFJiYTJWNVhTQWhQVDBnZFc1a1pXWnBibVZrTzF4dUlDQWdJR2xtS0c5M2JpQW1KaUJyWlhrZ2FXNGdaWGh3YjNKMGN5bGpiMjUwYVc1MVpUdGNiaUFnSUNBdkx5QmxlSEJ2Y25RZ2JtRjBhWFpsSUc5eUlIQmhjM05sWkZ4dUlDQWdJRzkxZENBOUlHOTNiaUEvSUhSaGNtZGxkRnRyWlhsZElEb2djMjkxY21ObFcydGxlVjA3WEc0Z0lDQWdMeThnY0hKbGRtVnVkQ0JuYkc5aVlXd2djRzlzYkhWMGFXOXVJR1p2Y2lCdVlXMWxjM0JoWTJWelhHNGdJQ0FnWlhod2IzSjBjMXRyWlhsZElEMGdTVk5mUjB4UFFrRk1JQ1ltSUhSNWNHVnZaaUIwWVhKblpYUmJhMlY1WFNBaFBTQW5ablZ1WTNScGIyNG5JRDhnYzI5MWNtTmxXMnRsZVYxY2JpQWdJQ0F2THlCaWFXNWtJSFJwYldWeWN5QjBieUJuYkc5aVlXd2dabTl5SUdOaGJHd2dabkp2YlNCbGVIQnZjblFnWTI5dWRHVjRkRnh1SUNBZ0lEb2dTVk5mUWtsT1JDQW1KaUJ2ZDI0Z1B5QmpkSGdvYjNWMExDQm5iRzlpWVd3cFhHNGdJQ0FnTHk4Z2QzSmhjQ0JuYkc5aVlXd2dZMjl1YzNSeWRXTjBiM0p6SUdadmNpQndjbVYyWlc1MElHTm9ZVzVuWlNCMGFHVnRJR2x1SUd4cFluSmhjbmxjYmlBZ0lDQTZJRWxUWDFkU1FWQWdKaVlnZEdGeVoyVjBXMnRsZVYwZ1BUMGdiM1YwSUQ4Z0tHWjFibU4wYVc5dUtFTXBlMXh1SUNBZ0lDQWdkbUZ5SUVZZ1BTQm1kVzVqZEdsdmJpaGhMQ0JpTENCaktYdGNiaUFnSUNBZ0lDQWdhV1lvZEdocGN5QnBibk4wWVc1alpXOW1JRU1wZTF4dUlDQWdJQ0FnSUNBZ0lITjNhWFJqYUNoaGNtZDFiV1Z1ZEhNdWJHVnVaM1JvS1h0Y2JpQWdJQ0FnSUNBZ0lDQWdJR05oYzJVZ01Eb2djbVYwZFhKdUlHNWxkeUJETzF4dUlDQWdJQ0FnSUNBZ0lDQWdZMkZ6WlNBeE9pQnlaWFIxY200Z2JtVjNJRU1vWVNrN1hHNGdJQ0FnSUNBZ0lDQWdJQ0JqWVhObElESTZJSEpsZEhWeWJpQnVaWGNnUXloaExDQmlLVHRjYmlBZ0lDQWdJQ0FnSUNCOUlISmxkSFZ5YmlCdVpYY2dReWhoTENCaUxDQmpLVHRjYmlBZ0lDQWdJQ0FnZlNCeVpYUjFjbTRnUXk1aGNIQnNlU2gwYUdsekxDQmhjbWQxYldWdWRITXBPMXh1SUNBZ0lDQWdmVHRjYmlBZ0lDQWdJRVpiVUZKUFZFOVVXVkJGWFNBOUlFTmJVRkpQVkU5VVdWQkZYVHRjYmlBZ0lDQWdJSEpsZEhWeWJpQkdPMXh1SUNBZ0lDOHZJRzFoYTJVZ2MzUmhkR2xqSUhabGNuTnBiMjV6SUdadmNpQndjbTkwYjNSNWNHVWdiV1YwYUc5a2MxeHVJQ0FnSUgwcEtHOTFkQ2tnT2lCSlUxOVFVazlVVHlBbUppQjBlWEJsYjJZZ2IzVjBJRDA5SUNkbWRXNWpkR2x2YmljZ1B5QmpkSGdvUm5WdVkzUnBiMjR1WTJGc2JDd2diM1YwS1NBNklHOTFkRHRjYmlBZ0lDQXZMeUJsZUhCdmNuUWdjSEp2ZEc4Z2JXVjBhRzlrY3lCMGJ5QmpiM0psTGlWRFQwNVRWRkpWUTFSUFVpVXViV1YwYUc5a2N5NGxUa0ZOUlNWY2JpQWdJQ0JwWmloSlUxOVFVazlVVHlsN1hHNGdJQ0FnSUNBb1pYaHdiM0owY3k1MmFYSjBkV0ZzSUh4OElDaGxlSEJ2Y25SekxuWnBjblIxWVd3Z1BTQjdmU2twVzJ0bGVWMGdQU0J2ZFhRN1hHNGdJQ0FnSUNBdkx5QmxlSEJ2Y25RZ2NISnZkRzhnYldWMGFHOWtjeUIwYnlCamIzSmxMaVZEVDA1VFZGSlZRMVJQVWlVdWNISnZkRzkwZVhCbExpVk9RVTFGSlZ4dUlDQWdJQ0FnYVdZb2RIbHdaU0FtSUNSbGVIQnZjblF1VWlBbUppQmxlSEJRY205MGJ5QW1KaUFoWlhod1VISnZkRzliYTJWNVhTbG9hV1JsS0dWNGNGQnliM1J2TENCclpYa3NJRzkxZENrN1hHNGdJQ0FnZlZ4dUlDQjlYRzU5TzF4dUx5OGdkSGx3WlNCaWFYUnRZWEJjYmlSbGVIQnZjblF1UmlBOUlERTdJQ0FnTHk4Z1ptOXlZMlZrWEc0a1pYaHdiM0owTGtjZ1BTQXlPeUFnSUM4dklHZHNiMkpoYkZ4dUpHVjRjRzl5ZEM1VElEMGdORHNnSUNBdkx5QnpkR0YwYVdOY2JpUmxlSEJ2Y25RdVVDQTlJRGc3SUNBZ0x5OGdjSEp2ZEc5Y2JpUmxlSEJ2Y25RdVFpQTlJREUyT3lBZ0x5OGdZbWx1WkZ4dUpHVjRjRzl5ZEM1WElEMGdNekk3SUNBdkx5QjNjbUZ3WEc0a1pYaHdiM0owTGxVZ1BTQTJORHNnSUM4dklITmhabVZjYmlSbGVIQnZjblF1VWlBOUlERXlPRHNnTHk4Z2NtVmhiQ0J3Y205MGJ5QnRaWFJvYjJRZ1ptOXlJR0JzYVdKeVlYSjVZQ0JjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnSkdWNGNHOXlkRHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyVjRjRzl5ZEM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ09GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSURZZ055QTRJRGtpTENKY0luVnpaU0J6ZEhKcFkzUmNJanRjYmx4dVpYaHdiM0owY3k1ZlgyVnpUVzlrZFd4bElEMGdkSEoxWlR0Y2JseHVaWGh3YjNKMGN5NWtaV1poZFd4MElEMGdablZ1WTNScGIyNGdLR2x1YzNSaGJtTmxMQ0JEYjI1emRISjFZM1J2Y2lrZ2UxeHVJQ0JwWmlBb0lTaHBibk4wWVc1alpTQnBibk4wWVc1alpXOW1JRU52Ym5OMGNuVmpkRzl5S1NrZ2UxeHVJQ0FnSUhSb2NtOTNJRzVsZHlCVWVYQmxSWEp5YjNJb1hDSkRZVzV1YjNRZ1kyRnNiQ0JoSUdOc1lYTnpJR0Z6SUdFZ1puVnVZM1JwYjI1Y0lpazdYRzRnSUgxY2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wySmhZbVZzTFhKMWJuUnBiV1V2YUdWc2NHVnljeTlqYkdGemMwTmhiR3hEYUdWamF5NXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdPVnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlEWWdOeUE0SURraUxDSmNJblZ6WlNCemRISnBZM1JjSWp0Y2JseHVaWGh3YjNKMGN5NWZYMlZ6VFc5a2RXeGxJRDBnZEhKMVpUdGNibHh1ZG1GeUlGOWtaV1pwYm1WUWNtOXdaWEowZVNBOUlISmxjWFZwY21Vb1hDSXVMaTlqYjNKbExXcHpMMjlpYW1WamRDOWtaV1pwYm1VdGNISnZjR1Z5ZEhsY0lpazdYRzVjYm5aaGNpQmZaR1ZtYVc1bFVISnZjR1Z5ZEhreUlEMGdYMmx1ZEdWeWIzQlNaWEYxYVhKbFJHVm1ZWFZzZENoZlpHVm1hVzVsVUhKdmNHVnlkSGtwTzF4dVhHNW1kVzVqZEdsdmJpQmZhVzUwWlhKdmNGSmxjWFZwY21WRVpXWmhkV3gwS0c5aWFpa2dleUJ5WlhSMWNtNGdiMkpxSUNZbUlHOWlhaTVmWDJWelRXOWtkV3hsSUQ4Z2IySnFJRG9nZXlCa1pXWmhkV3gwT2lCdlltb2dmVHNnZlZ4dVhHNWxlSEJ2Y25SekxtUmxabUYxYkhRZ1BTQm1kVzVqZEdsdmJpQW9LU0I3WEc0Z0lHWjFibU4wYVc5dUlHUmxabWx1WlZCeWIzQmxjblJwWlhNb2RHRnlaMlYwTENCd2NtOXdjeWtnZTF4dUlDQWdJR1p2Y2lBb2RtRnlJR2tnUFNBd095QnBJRHdnY0hKdmNITXViR1Z1WjNSb095QnBLeXNwSUh0Y2JpQWdJQ0FnSUhaaGNpQmtaWE5qY21sd2RHOXlJRDBnY0hKdmNITmJhVjA3WEc0Z0lDQWdJQ0JrWlhOamNtbHdkRzl5TG1WdWRXMWxjbUZpYkdVZ1BTQmtaWE5qY21sd2RHOXlMbVZ1ZFcxbGNtRmliR1VnZkh3Z1ptRnNjMlU3WEc0Z0lDQWdJQ0JrWlhOamNtbHdkRzl5TG1OdmJtWnBaM1Z5WVdKc1pTQTlJSFJ5ZFdVN1hHNGdJQ0FnSUNCcFppQW9YQ0oyWVd4MVpWd2lJR2x1SUdSbGMyTnlhWEIwYjNJcElHUmxjMk55YVhCMGIzSXVkM0pwZEdGaWJHVWdQU0IwY25WbE8xeHVJQ0FnSUNBZ0tEQXNJRjlrWldacGJtVlFjbTl3WlhKMGVUSXVaR1ZtWVhWc2RDa29kR0Z5WjJWMExDQmtaWE5qY21sd2RHOXlMbXRsZVN3Z1pHVnpZM0pwY0hSdmNpazdYRzRnSUNBZ2ZWeHVJQ0I5WEc1Y2JpQWdjbVYwZFhKdUlHWjFibU4wYVc5dUlDaERiMjV6ZEhKMVkzUnZjaXdnY0hKdmRHOVFjbTl3Y3l3Z2MzUmhkR2xqVUhKdmNITXBJSHRjYmlBZ0lDQnBaaUFvY0hKdmRHOVFjbTl3Y3lrZ1pHVm1hVzVsVUhKdmNHVnlkR2xsY3loRGIyNXpkSEoxWTNSdmNpNXdjbTkwYjNSNWNHVXNJSEJ5YjNSdlVISnZjSE1wTzF4dUlDQWdJR2xtSUNoemRHRjBhV05RY205d2N5a2daR1ZtYVc1bFVISnZjR1Z5ZEdsbGN5aERiMjV6ZEhKMVkzUnZjaXdnYzNSaGRHbGpVSEp2Y0hNcE8xeHVJQ0FnSUhKbGRIVnliaUJEYjI1emRISjFZM1J2Y2p0Y2JpQWdmVHRjYm4wb0tUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlvWld4d1pYSnpMMk55WldGMFpVTnNZWE56TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeE1GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSURZZ055QTRJRGtpTENKdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0dWNFpXTXBlMXh1SUNCMGNua2dlMXh1SUNBZ0lISmxkSFZ5YmlBaElXVjRaV01vS1R0Y2JpQWdmU0JqWVhSamFDaGxLWHRjYmlBZ0lDQnlaWFIxY200Z2RISjFaVHRjYmlBZ2ZWeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyWmhhV3h6TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeE1WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSURZZ055QTRJRGtpTENKMllYSWdhR0Z6VDNkdVVISnZjR1Z5ZEhrZ1BTQjdmUzVvWVhOUGQyNVFjbTl3WlhKMGVUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9hWFFzSUd0bGVTbDdYRzRnSUhKbGRIVnliaUJvWVhOUGQyNVFjbTl3WlhKMGVTNWpZV3hzS0dsMExDQnJaWGtwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJoaGN5NXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVEpjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TSXNJaTh2SUhSdklHbHVaR1Y0WldRZ2IySnFaV04wTENCMGIwOWlhbVZqZENCM2FYUm9JR1poYkd4aVlXTnJJR1p2Y2lCdWIyNHRZWEp5WVhrdGJHbHJaU0JGVXpNZ2MzUnlhVzVuYzF4dWRtRnlJRWxQWW1wbFkzUWdQU0J5WlhGMWFYSmxLQ2N1TDE5cGIySnFaV04wSnlsY2JpQWdMQ0JrWldacGJtVmtJRDBnY21WeGRXbHlaU2duTGk5ZlpHVm1hVzVsWkNjcE8xeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpaHBkQ2w3WEc0Z0lISmxkSFZ5YmlCSlQySnFaV04wS0dSbFptbHVaV1FvYVhRcEtUdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOTBieTFwYjJKcVpXTjBMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F4TTF4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJaXdpTHk4Z2IzQjBhVzl1WVd3Z0x5QnphVzF3YkdVZ1kyOXVkR1Y0ZENCaWFXNWthVzVuWEc1MllYSWdZVVoxYm1OMGFXOXVJRDBnY21WeGRXbHlaU2duTGk5ZllTMW1kVzVqZEdsdmJpY3BPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhtYml3Z2RHaGhkQ3dnYkdWdVozUm9LWHRjYmlBZ1lVWjFibU4wYVc5dUtHWnVLVHRjYmlBZ2FXWW9kR2hoZENBOVBUMGdkVzVrWldacGJtVmtLWEpsZEhWeWJpQm1ianRjYmlBZ2MzZHBkR05vS0d4bGJtZDBhQ2w3WEc0Z0lDQWdZMkZ6WlNBeE9pQnlaWFIxY200Z1puVnVZM1JwYjI0b1lTbDdYRzRnSUNBZ0lDQnlaWFIxY200Z1ptNHVZMkZzYkNoMGFHRjBMQ0JoS1R0Y2JpQWdJQ0I5TzF4dUlDQWdJR05oYzJVZ01qb2djbVYwZFhKdUlHWjFibU4wYVc5dUtHRXNJR0lwZTF4dUlDQWdJQ0FnY21WMGRYSnVJR1p1TG1OaGJHd29kR2hoZEN3Z1lTd2dZaWs3WEc0Z0lDQWdmVHRjYmlBZ0lDQmpZWE5sSURNNklISmxkSFZ5YmlCbWRXNWpkR2x2YmloaExDQmlMQ0JqS1h0Y2JpQWdJQ0FnSUhKbGRIVnliaUJtYmk1allXeHNLSFJvWVhRc0lHRXNJR0lzSUdNcE8xeHVJQ0FnSUgwN1hHNGdJSDFjYmlBZ2NtVjBkWEp1SUdaMWJtTjBhVzl1S0M4cUlDNHVMbUZ5WjNNZ0tpOHBlMXh1SUNBZ0lISmxkSFZ5YmlCbWJpNWhjSEJzZVNoMGFHRjBMQ0JoY21kMWJXVnVkSE1wTzF4dUlDQjlPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMk4wZUM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01UUmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNBMklEY2dPQ0E1SWl3aWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCbWRXNWpkR2x2YmloaWFYUnRZWEFzSUhaaGJIVmxLWHRjYmlBZ2NtVjBkWEp1SUh0Y2JpQWdJQ0JsYm5WdFpYSmhZbXhsSUNBNklDRW9ZbWwwYldGd0lDWWdNU2tzWEc0Z0lDQWdZMjl1Wm1sbmRYSmhZbXhsT2lBaEtHSnBkRzFoY0NBbUlESXBMRnh1SUNBZ0lIZHlhWFJoWW14bElDQWdJRG9nSVNoaWFYUnRZWEFnSmlBMEtTeGNiaUFnSUNCMllXeDFaU0FnSUNBZ0lDQTZJSFpoYkhWbFhHNGdJSDA3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmY0hKdmNHVnlkSGt0WkdWell5NXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVFZjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TQTJJRGNnT0NBNUlpd2liVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQjdmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgybDBaWEpoZEc5eWN5NXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVFpjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TSXNJblpoY2lCcGMwOWlhbVZqZENBOUlISmxjWFZwY21Vb0p5NHZYMmx6TFc5aWFtVmpkQ2NwWEc0Z0lDd2daRzlqZFcxbGJuUWdQU0J5WlhGMWFYSmxLQ2N1TDE5bmJHOWlZV3duS1M1a2IyTjFiV1Z1ZEZ4dUlDQXZMeUJwYmlCdmJHUWdTVVVnZEhsd1pXOW1JR1J2WTNWdFpXNTBMbU55WldGMFpVVnNaVzFsYm5RZ2FYTWdKMjlpYW1WamRDZGNiaUFnTENCcGN5QTlJR2x6VDJKcVpXTjBLR1J2WTNWdFpXNTBLU0FtSmlCcGMwOWlhbVZqZENoa2IyTjFiV1Z1ZEM1amNtVmhkR1ZGYkdWdFpXNTBLVHRjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRvYVhRcGUxeHVJQ0J5WlhSMWNtNGdhWE1nUHlCa2IyTjFiV1Z1ZEM1amNtVmhkR1ZGYkdWdFpXNTBLR2wwS1NBNklIdDlPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMlJ2YlMxamNtVmhkR1V1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURFM1hHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVnTmlBM0lEZ2dPU0lzSWk4dklERTVMakV1TWk0eE5DQXZJREUxTGpJdU15NHhOQ0JQWW1wbFkzUXVhMlY1Y3loUEtWeHVkbUZ5SUNSclpYbHpJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMV3RsZVhNdGFXNTBaWEp1WVd3bktWeHVJQ0FzSUdWdWRXMUNkV2RMWlhseklEMGdjbVZ4ZFdseVpTZ25MaTlmWlc1MWJTMWlkV2N0YTJWNWN5Y3BPMXh1WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUU5aWFtVmpkQzVyWlhseklIeDhJR1oxYm1OMGFXOXVJR3RsZVhNb1R5bDdYRzRnSUhKbGRIVnliaUFrYTJWNWN5aFBMQ0JsYm5WdFFuVm5TMlY1Y3lrN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmIySnFaV04wTFd0bGVYTXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJREU0WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWlMQ0p0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLR2wwS1h0Y2JpQWdhV1lvZEhsd1pXOW1JR2wwSUNFOUlDZG1kVzVqZEdsdmJpY3BkR2h5YjNjZ1ZIbHdaVVZ5Y205eUtHbDBJQ3NnSnlCcGN5QnViM1FnWVNCbWRXNWpkR2x2YmlFbktUdGNiaUFnY21WMGRYSnVJR2wwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJFdFpuVnVZM1JwYjI0dWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlERTVYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVZ05pQTNJRGdnT1NJc0luWmhjaUIwYjFOMGNtbHVaeUE5SUh0OUxuUnZVM1J5YVc1bk8xeHVYRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLR2wwS1h0Y2JpQWdjbVYwZFhKdUlIUnZVM1J5YVc1bkxtTmhiR3dvYVhRcExuTnNhV05sS0Rnc0lDMHhLVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlqYjJZdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlESXdYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSXZMeUEzTGpFdU1TQlViMUJ5YVcxcGRHbDJaU2hwYm5CMWRDQmJMQ0JRY21WbVpYSnlaV1JVZVhCbFhTbGNiblpoY2lCcGMwOWlhbVZqZENBOUlISmxjWFZwY21Vb0p5NHZYMmx6TFc5aWFtVmpkQ2NwTzF4dUx5OGdhVzV6ZEdWaFpDQnZaaUIwYUdVZ1JWTTJJSE53WldNZ2RtVnljMmx2Yml3Z2QyVWdaR2xrYmlkMElHbHRjR3hsYldWdWRDQkFRSFJ2VUhKcGJXbDBhWFpsSUdOaGMyVmNiaTh2SUdGdVpDQjBhR1VnYzJWamIyNWtJR0Z5WjNWdFpXNTBJQzBnWm14aFp5QXRJSEJ5WldabGNuSmxaQ0IwZVhCbElHbHpJR0VnYzNSeWFXNW5YRzV0YjJSMWJHVXVaWGh3YjNKMGN5QTlJR1oxYm1OMGFXOXVLR2wwTENCVEtYdGNiaUFnYVdZb0lXbHpUMkpxWldOMEtHbDBLU2x5WlhSMWNtNGdhWFE3WEc0Z0lIWmhjaUJtYml3Z2RtRnNPMXh1SUNCcFppaFRJQ1ltSUhSNWNHVnZaaUFvWm00Z1BTQnBkQzUwYjFOMGNtbHVaeWtnUFQwZ0oyWjFibU4wYVc5dUp5QW1KaUFoYVhOUFltcGxZM1FvZG1Gc0lEMGdabTR1WTJGc2JDaHBkQ2twS1hKbGRIVnliaUIyWVd3N1hHNGdJR2xtS0hSNWNHVnZaaUFvWm00Z1BTQnBkQzUyWVd4MVpVOW1LU0E5UFNBblpuVnVZM1JwYjI0bklDWW1JQ0ZwYzA5aWFtVmpkQ2gyWVd3Z1BTQm1iaTVqWVd4c0tHbDBLU2twY21WMGRYSnVJSFpoYkR0Y2JpQWdhV1lvSVZNZ0ppWWdkSGx3Wlc5bUlDaG1iaUE5SUdsMExuUnZVM1J5YVc1bktTQTlQU0FuWm5WdVkzUnBiMjRuSUNZbUlDRnBjMDlpYW1WamRDaDJZV3dnUFNCbWJpNWpZV3hzS0dsMEtTa3BjbVYwZFhKdUlIWmhiRHRjYmlBZ2RHaHliM2NnVkhsd1pVVnljbTl5S0Z3aVEyRnVKM1FnWTI5dWRtVnlkQ0J2WW1wbFkzUWdkRzhnY0hKcGJXbDBhWFpsSUhaaGJIVmxYQ0lwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDNSdkxYQnlhVzFwZEdsMlpTNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNakZjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TQTJJRGNnT0NBNUlpd2lkbUZ5SUdSbFppQTlJSEpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzFrY0NjcExtWmNiaUFnTENCb1lYTWdQU0J5WlhGMWFYSmxLQ2N1TDE5b1lYTW5LVnh1SUNBc0lGUkJSeUE5SUhKbGNYVnBjbVVvSnk0dlgzZHJjeWNwS0NkMGIxTjBjbWx1WjFSaFp5Y3BPMXh1WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0dsMExDQjBZV2NzSUhOMFlYUXBlMXh1SUNCcFppaHBkQ0FtSmlBaGFHRnpLR2wwSUQwZ2MzUmhkQ0EvSUdsMElEb2dhWFF1Y0hKdmRHOTBlWEJsTENCVVFVY3BLV1JsWmlocGRDd2dWRUZITENCN1kyOXVabWxuZFhKaFlteGxPaUIwY25WbExDQjJZV3gxWlRvZ2RHRm5mU2s3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYzJWMExYUnZMWE4wY21sdVp5MTBZV2N1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURJeVhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVpTENKMllYSWdhV1FnUFNBd1hHNGdJQ3dnY0hnZ1BTQk5ZWFJvTG5KaGJtUnZiU2dwTzF4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCbWRXNWpkR2x2YmloclpYa3BlMXh1SUNCeVpYUjFjbTRnSjFONWJXSnZiQ2duTG1OdmJtTmhkQ2hyWlhrZ1BUMDlJSFZ1WkdWbWFXNWxaQ0EvSUNjbklEb2dhMlY1TENBbktWOG5MQ0FvS3l0cFpDQXJJSEI0S1M1MGIxTjBjbWx1Wnlnek5pa3BPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM1ZwWkM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01qTmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0lpOHZJRGN1TWk0eElGSmxjWFZwY21WUFltcGxZM1JEYjJWeVkybGliR1VvWVhKbmRXMWxiblFwWEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0dsMEtYdGNiaUFnYVdZb2FYUWdQVDBnZFc1a1pXWnBibVZrS1hSb2NtOTNJRlI1Y0dWRmNuSnZjaWhjSWtOaGJpZDBJR05oYkd3Z2JXVjBhRzlrSUc5dUlDQmNJaUFySUdsMEtUdGNiaUFnY21WMGRYSnVJR2wwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJSbFptbHVaV1F1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURJMFhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVpTENKdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUNGeVpYRjFhWEpsS0NjdUwxOWtaWE5qY21sd2RHOXljeWNwSUNZbUlDRnlaWEYxYVhKbEtDY3VMMTltWVdsc2N5Y3BLR1oxYm1OMGFXOXVLQ2w3WEc0Z0lISmxkSFZ5YmlCUFltcGxZM1F1WkdWbWFXNWxVSEp2Y0dWeWRIa29jbVZ4ZFdseVpTZ25MaTlmWkc5dExXTnlaV0YwWlNjcEtDZGthWFluS1N3Z0oyRW5MQ0I3WjJWME9pQm1kVzVqZEdsdmJpZ3BleUJ5WlhSMWNtNGdOenNnZlgwcExtRWdJVDBnTnp0Y2JuMHBPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmFXVTRMV1J2YlMxa1pXWnBibVV1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURJMVhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVnTmlBM0lEZ2dPU0lzSW0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnZEhKMVpUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJ4cFluSmhjbmt1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURJMlhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVpTENKMllYSWdjMmhoY21Wa0lEMGdjbVZ4ZFdseVpTZ25MaTlmYzJoaGNtVmtKeWtvSjJ0bGVYTW5LVnh1SUNBc0lIVnBaQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYM1ZwWkNjcE8xeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpaHJaWGtwZTF4dUlDQnlaWFIxY200Z2MyaGhjbVZrVzJ0bGVWMGdmSHdnS0hOb1lYSmxaRnRyWlhsZElEMGdkV2xrS0d0bGVTa3BPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM05vWVhKbFpDMXJaWGt1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURJM1hHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVpTENJdkx5QTNMakV1TkNCVWIwbHVkR1ZuWlhKY2JuWmhjaUJqWldsc0lDQTlJRTFoZEdndVkyVnBiRnh1SUNBc0lHWnNiMjl5SUQwZ1RXRjBhQzVtYkc5dmNqdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9hWFFwZTF4dUlDQnlaWFIxY200Z2FYTk9ZVTRvYVhRZ1BTQXJhWFFwSUQ4Z01DQTZJQ2hwZENBK0lEQWdQeUJtYkc5dmNpQTZJR05sYVd3cEtHbDBLVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTkwYnkxcGJuUmxaMlZ5TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeU9GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSWl3aUx5OGdTVVVnT0MwZ1pHOXVKM1FnWlc1MWJTQmlkV2NnYTJWNWMxeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQW9YRzRnSUNkamIyNXpkSEoxWTNSdmNpeG9ZWE5QZDI1UWNtOXdaWEowZVN4cGMxQnliM1J2ZEhsd1pVOW1MSEJ5YjNCbGNuUjVTWE5GYm5WdFpYSmhZbXhsTEhSdlRHOWpZV3hsVTNSeWFXNW5MSFJ2VTNSeWFXNW5MSFpoYkhWbFQyWW5YRzRwTG5Od2JHbDBLQ2NzSnlrN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlsYm5WdExXSjFaeTFyWlhsekxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXlPVnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlpd2lkbUZ5SUdkc2IySmhiQ0E5SUhKbGNYVnBjbVVvSnk0dlgyZHNiMkpoYkNjcFhHNGdJQ3dnVTBoQlVrVkVJRDBnSjE5ZlkyOXlaUzFxYzE5emFHRnlaV1JmWHlkY2JpQWdMQ0J6ZEc5eVpTQWdQU0JuYkc5aVlXeGJVMGhCVWtWRVhTQjhmQ0FvWjJ4dlltRnNXMU5JUVZKRlJGMGdQU0I3ZlNrN1hHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHdGxlU2w3WEc0Z0lISmxkSFZ5YmlCemRHOXlaVnRyWlhsZElIeDhJQ2h6ZEc5eVpWdHJaWGxkSUQwZ2UzMHBPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM05vWVhKbFpDNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNekJjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TSXNJbTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdleUJjSW1SbFptRjFiSFJjSWpvZ2NtVnhkV2x5WlNoY0ltTnZjbVV0YW5NdmJHbGljbUZ5ZVM5bWJpOXZZbXBsWTNRdloyVjBMWEJ5YjNSdmRIbHdaUzF2Wmx3aUtTd2dYMTlsYzAxdlpIVnNaVG9nZEhKMVpTQjlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJOdmNtVXRhbk12YjJKcVpXTjBMMmRsZEMxd2NtOTBiM1I1Y0dVdGIyWXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRE14WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlJc0lpOHZJRGN1TVM0eE15QlViMDlpYW1WamRDaGhjbWQxYldWdWRDbGNiblpoY2lCa1pXWnBibVZrSUQwZ2NtVnhkV2x5WlNnbkxpOWZaR1ZtYVc1bFpDY3BPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhwZENsN1hHNGdJSEpsZEhWeWJpQlBZbXBsWTNRb1pHVm1hVzVsWkNocGRDa3BPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM1J2TFc5aWFtVmpkQzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTXpKY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSW0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnZXlCY0ltUmxabUYxYkhSY0lqb2djbVZ4ZFdseVpTaGNJbU52Y21VdGFuTXZiR2xpY21GeWVTOW1iaTl2WW1wbFkzUXZaR1ZtYVc1bExYQnliM0JsY25SNVhDSXBMQ0JmWDJWelRXOWtkV3hsT2lCMGNuVmxJSDA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMkpoWW1Wc0xYSjFiblJwYldVdlkyOXlaUzFxY3k5dlltcGxZM1F2WkdWbWFXNWxMWEJ5YjNCbGNuUjVMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F6TTF4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNZ05DQTFJRFlnTnlBNElEa2lMQ0pjSW5WelpTQnpkSEpwWTNSY0lqdGNibHh1Wlhod2IzSjBjeTVmWDJWelRXOWtkV3hsSUQwZ2RISjFaVHRjYmx4dWRtRnlJRjl6WlhSUWNtOTBiM1I1Y0dWUFppQTlJSEpsY1hWcGNtVW9YQ0l1TGk5amIzSmxMV3B6TDI5aWFtVmpkQzl6WlhRdGNISnZkRzkwZVhCbExXOW1YQ0lwTzF4dVhHNTJZWElnWDNObGRGQnliM1J2ZEhsd1pVOW1NaUE5SUY5cGJuUmxjbTl3VW1WeGRXbHlaVVJsWm1GMWJIUW9YM05sZEZCeWIzUnZkSGx3WlU5bUtUdGNibHh1ZG1GeUlGOWpjbVZoZEdVZ1BTQnlaWEYxYVhKbEtGd2lMaTR2WTI5eVpTMXFjeTl2WW1wbFkzUXZZM0psWVhSbFhDSXBPMXh1WEc1MllYSWdYMk55WldGMFpUSWdQU0JmYVc1MFpYSnZjRkpsY1hWcGNtVkVaV1poZFd4MEtGOWpjbVZoZEdVcE8xeHVYRzUyWVhJZ1gzUjVjR1Z2WmpJZ1BTQnlaWEYxYVhKbEtGd2lMaTR2YUdWc2NHVnljeTkwZVhCbGIyWmNJaWs3WEc1Y2JuWmhjaUJmZEhsd1pXOW1NeUE5SUY5cGJuUmxjbTl3VW1WeGRXbHlaVVJsWm1GMWJIUW9YM1I1Y0dWdlpqSXBPMXh1WEc1bWRXNWpkR2x2YmlCZmFXNTBaWEp2Y0ZKbGNYVnBjbVZFWldaaGRXeDBLRzlpYWlrZ2V5QnlaWFIxY200Z2IySnFJQ1ltSUc5aWFpNWZYMlZ6VFc5a2RXeGxJRDhnYjJKcUlEb2dleUJrWldaaGRXeDBPaUJ2WW1vZ2ZUc2dmVnh1WEc1bGVIQnZjblJ6TG1SbFptRjFiSFFnUFNCbWRXNWpkR2x2YmlBb2MzVmlRMnhoYzNNc0lITjFjR1Z5UTJ4aGMzTXBJSHRjYmlBZ2FXWWdLSFI1Y0dWdlppQnpkWEJsY2tOc1lYTnpJQ0U5UFNCY0ltWjFibU4wYVc5dVhDSWdKaVlnYzNWd1pYSkRiR0Z6Y3lBaFBUMGdiblZzYkNrZ2UxeHVJQ0FnSUhSb2NtOTNJRzVsZHlCVWVYQmxSWEp5YjNJb1hDSlRkWEJsY2lCbGVIQnlaWE56YVc5dUlHMTFjM1FnWldsMGFHVnlJR0psSUc1MWJHd2diM0lnWVNCbWRXNWpkR2x2Yml3Z2JtOTBJRndpSUNzZ0tIUjVjR1Z2WmlCemRYQmxja05zWVhOeklEMDlQU0JjSW5WdVpHVm1hVzVsWkZ3aUlEOGdYQ0oxYm1SbFptbHVaV1JjSWlBNklDZ3dMQ0JmZEhsd1pXOW1NeTVrWldaaGRXeDBLU2h6ZFhCbGNrTnNZWE56S1NrcE8xeHVJQ0I5WEc1Y2JpQWdjM1ZpUTJ4aGMzTXVjSEp2ZEc5MGVYQmxJRDBnS0RBc0lGOWpjbVZoZEdVeUxtUmxabUYxYkhRcEtITjFjR1Z5UTJ4aGMzTWdKaVlnYzNWd1pYSkRiR0Z6Y3k1d2NtOTBiM1I1Y0dVc0lIdGNiaUFnSUNCamIyNXpkSEoxWTNSdmNqb2dlMXh1SUNBZ0lDQWdkbUZzZFdVNklITjFZa05zWVhOekxGeHVJQ0FnSUNBZ1pXNTFiV1Z5WVdKc1pUb2dabUZzYzJVc1hHNGdJQ0FnSUNCM2NtbDBZV0pzWlRvZ2RISjFaU3hjYmlBZ0lDQWdJR052Ym1acFozVnlZV0pzWlRvZ2RISjFaVnh1SUNBZ0lIMWNiaUFnZlNrN1hHNGdJR2xtSUNoemRYQmxja05zWVhOektTQmZjMlYwVUhKdmRHOTBlWEJsVDJZeUxtUmxabUYxYkhRZ1B5QW9NQ3dnWDNObGRGQnliM1J2ZEhsd1pVOW1NaTVrWldaaGRXeDBLU2h6ZFdKRGJHRnpjeXdnYzNWd1pYSkRiR0Z6Y3lrZ09pQnpkV0pEYkdGemN5NWZYM0J5YjNSdlgxOGdQU0J6ZFhCbGNrTnNZWE56TzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlltRmlaV3d0Y25WdWRHbHRaUzlvWld4d1pYSnpMMmx1YUdWeWFYUnpMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F6TkZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNaUxDSmNJblZ6WlNCemRISnBZM1JjSWp0Y2JseHVaWGh3YjNKMGN5NWZYMlZ6VFc5a2RXeGxJRDBnZEhKMVpUdGNibHh1ZG1GeUlGOTBlWEJsYjJZeUlEMGdjbVZ4ZFdseVpTaGNJaTR1TDJobGJIQmxjbk12ZEhsd1pXOW1YQ0lwTzF4dVhHNTJZWElnWDNSNWNHVnZaak1nUFNCZmFXNTBaWEp2Y0ZKbGNYVnBjbVZFWldaaGRXeDBLRjkwZVhCbGIyWXlLVHRjYmx4dVpuVnVZM1JwYjI0Z1gybHVkR1Z5YjNCU1pYRjFhWEpsUkdWbVlYVnNkQ2h2WW1vcElIc2djbVYwZFhKdUlHOWlhaUFtSmlCdlltb3VYMTlsYzAxdlpIVnNaU0EvSUc5aWFpQTZJSHNnWkdWbVlYVnNkRG9nYjJKcUlIMDdJSDFjYmx4dVpYaHdiM0owY3k1a1pXWmhkV3gwSUQwZ1puVnVZM1JwYjI0Z0tITmxiR1lzSUdOaGJHd3BJSHRjYmlBZ2FXWWdLQ0Z6Wld4bUtTQjdYRzRnSUNBZ2RHaHliM2NnYm1WM0lGSmxabVZ5Wlc1alpVVnljbTl5S0Z3aWRHaHBjeUJvWVhOdUozUWdZbVZsYmlCcGJtbDBhV0ZzYVhObFpDQXRJSE4xY0dWeUtDa2dhR0Z6YmlkMElHSmxaVzRnWTJGc2JHVmtYQ0lwTzF4dUlDQjlYRzVjYmlBZ2NtVjBkWEp1SUdOaGJHd2dKaVlnS0NoMGVYQmxiMllnWTJGc2JDQTlQVDBnWENKMWJtUmxabWx1WldSY0lpQS9JRndpZFc1a1pXWnBibVZrWENJZ09pQW9NQ3dnWDNSNWNHVnZaak11WkdWbVlYVnNkQ2tvWTJGc2JDa3BJRDA5UFNCY0ltOWlhbVZqZEZ3aUlIeDhJSFI1Y0dWdlppQmpZV3hzSUQwOVBTQmNJbVoxYm1OMGFXOXVYQ0lwSUQ4Z1kyRnNiQ0E2SUhObGJHWTdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlpWVdKbGJDMXlkVzUwYVcxbEwyaGxiSEJsY25NdmNHOXpjMmxpYkdWRGIyNXpkSEoxWTNSdmNsSmxkSFZ5Ymk1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ016VmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJaXdpY21WeGRXbHlaU2duTGk0dkxpNHZiVzlrZFd4bGN5OWxjell1YjJKcVpXTjBMbVJsWm1sdVpTMXdjbTl3WlhKMGVTY3BPMXh1ZG1GeUlDUlBZbXBsWTNRZ1BTQnlaWEYxYVhKbEtDY3VMaTh1TGk5dGIyUjFiR1Z6TDE5amIzSmxKeWt1VDJKcVpXTjBPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaUJrWldacGJtVlFjbTl3WlhKMGVTaHBkQ3dnYTJWNUxDQmtaWE5qS1h0Y2JpQWdjbVYwZFhKdUlDUlBZbXBsWTNRdVpHVm1hVzVsVUhKdmNHVnlkSGtvYVhRc0lHdGxlU3dnWkdWell5azdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2YjJKcVpXTjBMMlJsWm1sdVpTMXdjbTl3WlhKMGVTNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNelpjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TQTJJRGNnT0NBNUlpd2lMeThnTVRrdU1TNHlMaklnTHlBeE5TNHlMak11TlNCUFltcGxZM1F1WTNKbFlYUmxLRThnV3l3Z1VISnZjR1Z5ZEdsbGMxMHBYRzUyWVhJZ1lXNVBZbXBsWTNRZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5aGJpMXZZbXBsWTNRbktWeHVJQ0FzSUdSUWN5QWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMV1J3Y3ljcFhHNGdJQ3dnWlc1MWJVSjFaMHRsZVhNZ1BTQnlaWEYxYVhKbEtDY3VMMTlsYm5WdExXSjFaeTFyWlhsekp5bGNiaUFnTENCSlJWOVFVazlVVHlBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDNOb1lYSmxaQzFyWlhrbktTZ25TVVZmVUZKUFZFOG5LVnh1SUNBc0lFVnRjSFI1SUNBZ0lDQWdJRDBnWm5WdVkzUnBiMjRvS1hzZ0x5b2daVzF3ZEhrZ0tpOGdmVnh1SUNBc0lGQlNUMVJQVkZsUVJTQWdJRDBnSjNCeWIzUnZkSGx3WlNjN1hHNWNiaTh2SUVOeVpXRjBaU0J2WW1wbFkzUWdkMmwwYUNCbVlXdGxJR0J1ZFd4c1lDQndjbTkwYjNSNWNHVTZJSFZ6WlNCcFpuSmhiV1VnVDJKcVpXTjBJSGRwZEdnZ1kyeGxZWEpsWkNCd2NtOTBiM1I1Y0dWY2JuWmhjaUJqY21WaGRHVkVhV04wSUQwZ1puVnVZM1JwYjI0b0tYdGNiaUFnTHk4Z1ZHaHlZWE5vTENCM1lYTjBaU0JoYm1RZ2MyOWtiMjE1T2lCSlJTQkhReUJpZFdkY2JpQWdkbUZ5SUdsbWNtRnRaU0E5SUhKbGNYVnBjbVVvSnk0dlgyUnZiUzFqY21WaGRHVW5LU2duYVdaeVlXMWxKeWxjYmlBZ0lDQXNJR2tnSUNBZ0lDQTlJR1Z1ZFcxQ2RXZExaWGx6TG14bGJtZDBhRnh1SUNBZ0lDd2diSFFnSUNBZ0lEMGdKenduWEc0Z0lDQWdMQ0JuZENBZ0lDQWdQU0FuUGlkY2JpQWdJQ0FzSUdsbWNtRnRaVVJ2WTNWdFpXNTBPMXh1SUNCcFpuSmhiV1V1YzNSNWJHVXVaR2x6Y0d4aGVTQTlJQ2R1YjI1bEp6dGNiaUFnY21WeGRXbHlaU2duTGk5ZmFIUnRiQ2NwTG1Gd2NHVnVaRU5vYVd4a0tHbG1jbUZ0WlNrN1hHNGdJR2xtY21GdFpTNXpjbU1nUFNBbmFtRjJZWE5qY21sd2REb25PeUF2THlCbGMyeHBiblF0WkdsellXSnNaUzFzYVc1bElHNXZMWE5qY21sd2RDMTFjbXhjYmlBZ0x5OGdZM0psWVhSbFJHbGpkQ0E5SUdsbWNtRnRaUzVqYjI1MFpXNTBWMmx1Wkc5M0xrOWlhbVZqZER0Y2JpQWdMeThnYUhSdGJDNXlaVzF2ZG1WRGFHbHNaQ2hwWm5KaGJXVXBPMXh1SUNCcFpuSmhiV1ZFYjJOMWJXVnVkQ0E5SUdsbWNtRnRaUzVqYjI1MFpXNTBWMmx1Wkc5M0xtUnZZM1Z0Wlc1ME8xeHVJQ0JwWm5KaGJXVkViMk4xYldWdWRDNXZjR1Z1S0NrN1hHNGdJR2xtY21GdFpVUnZZM1Z0Wlc1MExuZHlhWFJsS0d4MElDc2dKM05qY21sd2RDY2dLeUJuZENBcklDZGtiMk4xYldWdWRDNUdQVTlpYW1WamRDY2dLeUJzZENBcklDY3ZjMk55YVhCMEp5QXJJR2QwS1R0Y2JpQWdhV1p5WVcxbFJHOWpkVzFsYm5RdVkyeHZjMlVvS1R0Y2JpQWdZM0psWVhSbFJHbGpkQ0E5SUdsbWNtRnRaVVJ2WTNWdFpXNTBMa1k3WEc0Z0lIZG9hV3hsS0drdExTbGtaV3hsZEdVZ1kzSmxZWFJsUkdsamRGdFFVazlVVDFSWlVFVmRXMlZ1ZFcxQ2RXZExaWGx6VzJsZFhUdGNiaUFnY21WMGRYSnVJR055WldGMFpVUnBZM1FvS1R0Y2JuMDdYRzVjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnVDJKcVpXTjBMbU55WldGMFpTQjhmQ0JtZFc1amRHbHZiaUJqY21WaGRHVW9UeXdnVUhKdmNHVnlkR2xsY3lsN1hHNGdJSFpoY2lCeVpYTjFiSFE3WEc0Z0lHbG1LRThnSVQwOUlHNTFiR3dwZTF4dUlDQWdJRVZ0Y0hSNVcxQlNUMVJQVkZsUVJWMGdQU0JoYms5aWFtVmpkQ2hQS1R0Y2JpQWdJQ0J5WlhOMWJIUWdQU0J1WlhjZ1JXMXdkSGs3WEc0Z0lDQWdSVzF3ZEhsYlVGSlBWRTlVV1ZCRlhTQTlJRzUxYkd3N1hHNGdJQ0FnTHk4Z1lXUmtJRndpWDE5d2NtOTBiMTlmWENJZ1ptOXlJRTlpYW1WamRDNW5aWFJRY205MGIzUjVjR1ZQWmlCd2IyeDVabWxzYkZ4dUlDQWdJSEpsYzNWc2RGdEpSVjlRVWs5VVQxMGdQU0JQTzF4dUlDQjlJR1ZzYzJVZ2NtVnpkV3gwSUQwZ1kzSmxZWFJsUkdsamRDZ3BPMXh1SUNCeVpYUjFjbTRnVUhKdmNHVnlkR2xsY3lBOVBUMGdkVzVrWldacGJtVmtJRDhnY21WemRXeDBJRG9nWkZCektISmxjM1ZzZEN3Z1VISnZjR1Z5ZEdsbGN5azdYRzU5TzF4dVhHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl2WW1wbFkzUXRZM0psWVhSbExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXpOMXh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlpd2lkbUZ5SUNSbGVIQnZjblFnUFNCeVpYRjFhWEpsS0NjdUwxOWxlSEJ2Y25RbktUdGNiaTh2SURFNUxqRXVNaTQwSUM4Z01UVXVNaTR6TGpZZ1QySnFaV04wTG1SbFptbHVaVkJ5YjNCbGNuUjVLRThzSUZBc0lFRjBkSEpwWW5WMFpYTXBYRzRrWlhod2IzSjBLQ1JsZUhCdmNuUXVVeUFySUNSbGVIQnZjblF1UmlBcUlDRnlaWEYxYVhKbEtDY3VMMTlrWlhOamNtbHdkRzl5Y3ljcExDQW5UMkpxWldOMEp5d2dlMlJsWm1sdVpWQnliM0JsY25SNU9pQnlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRaSEFuS1M1bWZTazdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDJWek5pNXZZbXBsWTNRdVpHVm1hVzVsTFhCeWIzQmxjblI1TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBek9GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSURZZ055QTRJRGtpTENJbmRYTmxJSE4wY21samRDYzdYRzUyWVhJZ1RFbENVa0ZTV1NBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXNhV0p5WVhKNUp5bGNiaUFnTENBa1pYaHdiM0owSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyVjRjRzl5ZENjcFhHNGdJQ3dnY21Wa1pXWnBibVVnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5eVpXUmxabWx1WlNjcFhHNGdJQ3dnYUdsa1pTQWdJQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5b2FXUmxKeWxjYmlBZ0xDQm9ZWE1nSUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMmhoY3ljcFhHNGdJQ3dnU1hSbGNtRjBiM0p6SUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5cGRHVnlZWFJ2Y25NbktWeHVJQ0FzSUNScGRHVnlRM0psWVhSbElDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmFYUmxjaTFqY21WaGRHVW5LVnh1SUNBc0lITmxkRlJ2VTNSeWFXNW5WR0ZuSUQwZ2NtVnhkV2x5WlNnbkxpOWZjMlYwTFhSdkxYTjBjbWx1WnkxMFlXY25LVnh1SUNBc0lHZGxkRkJ5YjNSdmRIbHdaVTltSUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXZHdieWNwWEc0Z0lDd2dTVlJGVWtGVVQxSWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTkzYTNNbktTZ25hWFJsY21GMGIzSW5LVnh1SUNBc0lFSlZSMGRaSUNBZ0lDQWdJQ0FnSUQwZ0lTaGJYUzVyWlhseklDWW1JQ2R1WlhoMEp5QnBiaUJiWFM1clpYbHpLQ2twSUM4dklGTmhabUZ5YVNCb1lYTWdZblZuWjNrZ2FYUmxjbUYwYjNKeklIY3ZieUJnYm1WNGRHQmNiaUFnTENCR1JsOUpWRVZTUVZSUFVpQWdJQ0E5SUNkQVFHbDBaWEpoZEc5eUoxeHVJQ0FzSUV0RldWTWdJQ0FnSUNBZ0lDQWdJRDBnSjJ0bGVYTW5YRzRnSUN3Z1ZrRk1WVVZUSUNBZ0lDQWdJQ0FnUFNBbmRtRnNkV1Z6Snp0Y2JseHVkbUZ5SUhKbGRIVnlibFJvYVhNZ1BTQm1kVzVqZEdsdmJpZ3BleUJ5WlhSMWNtNGdkR2hwY3pzZ2ZUdGNibHh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhDWVhObExDQk9RVTFGTENCRGIyNXpkSEoxWTNSdmNpd2dibVY0ZEN3Z1JFVkdRVlZNVkN3Z1NWTmZVMFZVTENCR1QxSkRSVVFwZTF4dUlDQWthWFJsY2tOeVpXRjBaU2hEYjI1emRISjFZM1J2Y2l3Z1RrRk5SU3dnYm1WNGRDazdYRzRnSUhaaGNpQm5aWFJOWlhSb2IyUWdQU0JtZFc1amRHbHZiaWhyYVc1a0tYdGNiaUFnSUNCcFppZ2hRbFZIUjFrZ0ppWWdhMmx1WkNCcGJpQndjbTkwYnlseVpYUjFjbTRnY0hKdmRHOWJhMmx1WkYwN1hHNGdJQ0FnYzNkcGRHTm9LR3RwYm1RcGUxeHVJQ0FnSUNBZ1kyRnpaU0JMUlZsVE9pQnlaWFIxY200Z1puVnVZM1JwYjI0Z2EyVjVjeWdwZXlCeVpYUjFjbTRnYm1WM0lFTnZibk4wY25WamRHOXlLSFJvYVhNc0lHdHBibVFwT3lCOU8xeHVJQ0FnSUNBZ1kyRnpaU0JXUVV4VlJWTTZJSEpsZEhWeWJpQm1kVzVqZEdsdmJpQjJZV3gxWlhNb0tYc2djbVYwZFhKdUlHNWxkeUJEYjI1emRISjFZM1J2Y2loMGFHbHpMQ0JyYVc1a0tUc2dmVHRjYmlBZ0lDQjlJSEpsZEhWeWJpQm1kVzVqZEdsdmJpQmxiblJ5YVdWektDbDdJSEpsZEhWeWJpQnVaWGNnUTI5dWMzUnlkV04wYjNJb2RHaHBjeXdnYTJsdVpDazdJSDA3WEc0Z0lIMDdYRzRnSUhaaGNpQlVRVWNnSUNBZ0lDQWdJRDBnVGtGTlJTQXJJQ2NnU1hSbGNtRjBiM0luWEc0Z0lDQWdMQ0JFUlVaZlZrRk1WVVZUSUQwZ1JFVkdRVlZNVkNBOVBTQldRVXhWUlZOY2JpQWdJQ0FzSUZaQlRGVkZVMTlDVlVjZ1BTQm1ZV3h6WlZ4dUlDQWdJQ3dnY0hKdmRHOGdJQ0FnSUNBOUlFSmhjMlV1Y0hKdmRHOTBlWEJsWEc0Z0lDQWdMQ0FrYm1GMGFYWmxJQ0FnSUQwZ2NISnZkRzliU1ZSRlVrRlVUMUpkSUh4OElIQnliM1J2VzBaR1gwbFVSVkpCVkU5U1hTQjhmQ0JFUlVaQlZVeFVJQ1ltSUhCeWIzUnZXMFJGUmtGVlRGUmRYRzRnSUNBZ0xDQWtaR1ZtWVhWc2RDQWdJRDBnSkc1aGRHbDJaU0I4ZkNCblpYUk5aWFJvYjJRb1JFVkdRVlZNVkNsY2JpQWdJQ0FzSUNSbGJuUnlhV1Z6SUNBZ1BTQkVSVVpCVlV4VUlEOGdJVVJGUmw5V1FVeFZSVk1nUHlBa1pHVm1ZWFZzZENBNklHZGxkRTFsZEdodlpDZ25aVzUwY21sbGN5Y3BJRG9nZFc1a1pXWnBibVZrWEc0Z0lDQWdMQ0FrWVc1NVRtRjBhWFpsSUQwZ1RrRk5SU0E5UFNBblFYSnlZWGtuSUQ4Z2NISnZkRzh1Wlc1MGNtbGxjeUI4ZkNBa2JtRjBhWFpsSURvZ0pHNWhkR2wyWlZ4dUlDQWdJQ3dnYldWMGFHOWtjeXdnYTJWNUxDQkpkR1Z5WVhSdmNsQnliM1J2ZEhsd1pUdGNiaUFnTHk4Z1JtbDRJRzVoZEdsMlpWeHVJQ0JwWmlna1lXNTVUbUYwYVhabEtYdGNiaUFnSUNCSmRHVnlZWFJ2Y2xCeWIzUnZkSGx3WlNBOUlHZGxkRkJ5YjNSdmRIbHdaVTltS0NSaGJubE9ZWFJwZG1VdVkyRnNiQ2h1WlhjZ1FtRnpaU2twTzF4dUlDQWdJR2xtS0VsMFpYSmhkRzl5VUhKdmRHOTBlWEJsSUNFOVBTQlBZbXBsWTNRdWNISnZkRzkwZVhCbEtYdGNiaUFnSUNBZ0lDOHZJRk5sZENCQVFIUnZVM1J5YVc1blZHRm5JSFJ2SUc1aGRHbDJaU0JwZEdWeVlYUnZjbk5jYmlBZ0lDQWdJSE5sZEZSdlUzUnlhVzVuVkdGbktFbDBaWEpoZEc5eVVISnZkRzkwZVhCbExDQlVRVWNzSUhSeWRXVXBPMXh1SUNBZ0lDQWdMeThnWm1sNElHWnZjaUJ6YjIxbElHOXNaQ0JsYm1kcGJtVnpYRzRnSUNBZ0lDQnBaaWdoVEVsQ1VrRlNXU0FtSmlBaGFHRnpLRWwwWlhKaGRHOXlVSEp2ZEc5MGVYQmxMQ0JKVkVWU1FWUlBVaWtwYUdsa1pTaEpkR1Z5WVhSdmNsQnliM1J2ZEhsd1pTd2dTVlJGVWtGVVQxSXNJSEpsZEhWeWJsUm9hWE1wTzF4dUlDQWdJSDFjYmlBZ2ZWeHVJQ0F2THlCbWFYZ2dRWEp5WVhramUzWmhiSFZsY3l3Z1FFQnBkR1Z5WVhSdmNuMHVibUZ0WlNCcGJpQldPQ0F2SUVaR1hHNGdJR2xtS0VSRlJsOVdRVXhWUlZNZ0ppWWdKRzVoZEdsMlpTQW1KaUFrYm1GMGFYWmxMbTVoYldVZ0lUMDlJRlpCVEZWRlV5bDdYRzRnSUNBZ1ZrRk1WVVZUWDBKVlJ5QTlJSFJ5ZFdVN1hHNGdJQ0FnSkdSbFptRjFiSFFnUFNCbWRXNWpkR2x2YmlCMllXeDFaWE1vS1hzZ2NtVjBkWEp1SUNSdVlYUnBkbVV1WTJGc2JDaDBhR2x6S1RzZ2ZUdGNiaUFnZlZ4dUlDQXZMeUJFWldacGJtVWdhWFJsY21GMGIzSmNiaUFnYVdZb0tDRk1TVUpTUVZKWklIeDhJRVpQVWtORlJDa2dKaVlnS0VKVlIwZFpJSHg4SUZaQlRGVkZVMTlDVlVjZ2ZId2dJWEJ5YjNSdlcwbFVSVkpCVkU5U1hTa3BlMXh1SUNBZ0lHaHBaR1VvY0hKdmRHOHNJRWxVUlZKQlZFOVNMQ0FrWkdWbVlYVnNkQ2s3WEc0Z0lIMWNiaUFnTHk4Z1VHeDFaeUJtYjNJZ2JHbGljbUZ5ZVZ4dUlDQkpkR1Z5WVhSdmNuTmJUa0ZOUlYwZ1BTQWtaR1ZtWVhWc2REdGNiaUFnU1hSbGNtRjBiM0p6VzFSQlIxMGdJRDBnY21WMGRYSnVWR2hwY3p0Y2JpQWdhV1lvUkVWR1FWVk1WQ2w3WEc0Z0lDQWdiV1YwYUc5a2N5QTlJSHRjYmlBZ0lDQWdJSFpoYkhWbGN6b2dJRVJGUmw5V1FVeFZSVk1nUHlBa1pHVm1ZWFZzZENBNklHZGxkRTFsZEdodlpDaFdRVXhWUlZNcExGeHVJQ0FnSUNBZ2EyVjVjem9nSUNBZ1NWTmZVMFZVSUNBZ0lDQS9JQ1JrWldaaGRXeDBJRG9nWjJWMFRXVjBhRzlrS0V0RldWTXBMRnh1SUNBZ0lDQWdaVzUwY21sbGN6b2dKR1Z1ZEhKcFpYTmNiaUFnSUNCOU8xeHVJQ0FnSUdsbUtFWlBVa05GUkNsbWIzSW9hMlY1SUdsdUlHMWxkR2h2WkhNcGUxeHVJQ0FnSUNBZ2FXWW9JU2hyWlhrZ2FXNGdjSEp2ZEc4cEtYSmxaR1ZtYVc1bEtIQnliM1J2TENCclpYa3NJRzFsZEdodlpITmJhMlY1WFNrN1hHNGdJQ0FnZlNCbGJITmxJQ1JsZUhCdmNuUW9KR1Y0Y0c5eWRDNVFJQ3NnSkdWNGNHOXlkQzVHSUNvZ0tFSlZSMGRaSUh4OElGWkJURlZGVTE5Q1ZVY3BMQ0JPUVUxRkxDQnRaWFJvYjJSektUdGNiaUFnZlZ4dUlDQnlaWFIxY200Z2JXVjBhRzlrY3p0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5cGRHVnlMV1JsWm1sdVpTNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNemxjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TSXNJbTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdleUJjSW1SbFptRjFiSFJjSWpvZ2NtVnhkV2x5WlNoY0ltTnZjbVV0YW5NdmJHbGljbUZ5ZVM5bWJpOXFjMjl1TDNOMGNtbHVaMmxtZVZ3aUtTd2dYMTlsYzAxdlpIVnNaVG9nZEhKMVpTQjlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJOdmNtVXRhbk12YW5OdmJpOXpkSEpwYm1kcFpua3Vhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRFF3WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWdOaUlzSW1WNGNHOXlkSE11WmlBOUlIdDlMbkJ5YjNCbGNuUjVTWE5GYm5WdFpYSmhZbXhsTzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZiMkpxWldOMExYQnBaUzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTkRGY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklpd2liVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQnlaWEYxYVhKbEtDY3VMMTluYkc5aVlXd25LUzVrYjJOMWJXVnVkQ0FtSmlCa2IyTjFiV1Z1ZEM1a2IyTjFiV1Z1ZEVWc1pXMWxiblE3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOW9kRzFzTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBME1seHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSWl3aUx5OGdNVGt1TVM0eUxqa2dMeUF4TlM0eUxqTXVNaUJQWW1wbFkzUXVaMlYwVUhKdmRHOTBlWEJsVDJZb1R5bGNiblpoY2lCb1lYTWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJoaGN5Y3BYRzRnSUN3Z2RHOVBZbXBsWTNRZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXZZbXBsWTNRbktWeHVJQ0FzSUVsRlgxQlNUMVJQSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYzJoaGNtVmtMV3RsZVNjcEtDZEpSVjlRVWs5VVR5Y3BYRzRnSUN3Z1QySnFaV04wVUhKdmRHOGdQU0JQWW1wbFkzUXVjSEp2ZEc5MGVYQmxPMXh1WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUU5aWFtVmpkQzVuWlhSUWNtOTBiM1I1Y0dWUFppQjhmQ0JtZFc1amRHbHZiaWhQS1h0Y2JpQWdUeUE5SUhSdlQySnFaV04wS0U4cE8xeHVJQ0JwWmlob1lYTW9UeXdnU1VWZlVGSlBWRThwS1hKbGRIVnliaUJQVzBsRlgxQlNUMVJQWFR0Y2JpQWdhV1lvZEhsd1pXOW1JRTh1WTI5dWMzUnlkV04wYjNJZ1BUMGdKMloxYm1OMGFXOXVKeUFtSmlCUElHbHVjM1JoYm1ObGIyWWdUeTVqYjI1emRISjFZM1J2Y2lsN1hHNGdJQ0FnY21WMGRYSnVJRTh1WTI5dWMzUnlkV04wYjNJdWNISnZkRzkwZVhCbE8xeHVJQ0I5SUhKbGRIVnliaUJQSUdsdWMzUmhibU5sYjJZZ1QySnFaV04wSUQ4Z1QySnFaV04wVUhKdmRHOGdPaUJ1ZFd4c08xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyOWlhbVZqZEMxbmNHOHVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRFF6WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWlMQ0oyWVhJZ2FHRnpJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmFHRnpKeWxjYmlBZ0xDQjBiMGxQWW1wbFkzUWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOTBieTFwYjJKcVpXTjBKeWxjYmlBZ0xDQmhjbkpoZVVsdVpHVjRUMllnUFNCeVpYRjFhWEpsS0NjdUwxOWhjbkpoZVMxcGJtTnNkV1JsY3ljcEtHWmhiSE5sS1Z4dUlDQXNJRWxGWDFCU1QxUlBJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYM05vWVhKbFpDMXJaWGtuS1NnblNVVmZVRkpQVkU4bktUdGNibHh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWh2WW1wbFkzUXNJRzVoYldWektYdGNiaUFnZG1GeUlFOGdJQ0FnSUNBOUlIUnZTVTlpYW1WamRDaHZZbXBsWTNRcFhHNGdJQ0FnTENCcElDQWdJQ0FnUFNBd1hHNGdJQ0FnTENCeVpYTjFiSFFnUFNCYlhWeHVJQ0FnSUN3Z2EyVjVPMXh1SUNCbWIzSW9hMlY1SUdsdUlFOHBhV1lvYTJWNUlDRTlJRWxGWDFCU1QxUlBLV2hoY3loUExDQnJaWGtwSUNZbUlISmxjM1ZzZEM1d2RYTm9LR3RsZVNrN1hHNGdJQzh2SUVSdmJpZDBJR1Z1ZFcwZ1luVm5JQ1lnYUdsa1pHVnVJR3RsZVhOY2JpQWdkMmhwYkdVb2JtRnRaWE11YkdWdVozUm9JRDRnYVNscFppaG9ZWE1vVHl3Z2EyVjVJRDBnYm1GdFpYTmJhU3NyWFNrcGUxeHVJQ0FnSUg1aGNuSmhlVWx1WkdWNFQyWW9jbVZ6ZFd4MExDQnJaWGtwSUh4OElISmxjM1ZzZEM1d2RYTm9LR3RsZVNrN1hHNGdJSDFjYmlBZ2NtVjBkWEp1SUhKbGMzVnNkRHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl2WW1wbFkzUXRhMlY1Y3kxcGJuUmxjbTVoYkM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ05EUmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0lpOHZJRzF2YzNRZ1QySnFaV04wSUcxbGRHaHZaSE1nWW5rZ1JWTTJJSE5vYjNWc1pDQmhZMk5sY0hRZ2NISnBiV2wwYVhabGMxeHVkbUZ5SUNSbGVIQnZjblFnUFNCeVpYRjFhWEpsS0NjdUwxOWxlSEJ2Y25RbktWeHVJQ0FzSUdOdmNtVWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOWpiM0psSnlsY2JpQWdMQ0JtWVdsc2N5QWdJRDBnY21WeGRXbHlaU2duTGk5ZlptRnBiSE1uS1R0Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b1MwVlpMQ0JsZUdWaktYdGNiaUFnZG1GeUlHWnVJQ0E5SUNoamIzSmxMazlpYW1WamRDQjhmQ0I3ZlNsYlMwVlpYU0I4ZkNCUFltcGxZM1JiUzBWWlhWeHVJQ0FnSUN3Z1pYaHdJRDBnZTMwN1hHNGdJR1Y0Y0Z0TFJWbGRJRDBnWlhobFl5aG1iaWs3WEc0Z0lDUmxlSEJ2Y25Rb0pHVjRjRzl5ZEM1VElDc2dKR1Y0Y0c5eWRDNUdJQ29nWm1GcGJITW9ablZ1WTNScGIyNG9LWHNnWm00b01TazdJSDBwTENBblQySnFaV04wSnl3Z1pYaHdLVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl2WW1wbFkzUXRjMkZ3TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBME5WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSWl3aWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCeVpYRjFhWEpsS0NjdUwxOW9hV1JsSnlrN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl5WldSbFptbHVaUzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTkRaY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSWk4dklEY3VNUzR4TlNCVWIweGxibWQwYUZ4dWRtRnlJSFJ2U1c1MFpXZGxjaUE5SUhKbGNYVnBjbVVvSnk0dlgzUnZMV2x1ZEdWblpYSW5LVnh1SUNBc0lHMXBiaUFnSUNBZ0lDQTlJRTFoZEdndWJXbHVPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhwZENsN1hHNGdJSEpsZEhWeWJpQnBkQ0ErSURBZ1B5QnRhVzRvZEc5SmJuUmxaMlZ5S0dsMEtTd2dNSGd4Wm1abVptWm1abVptWm1abVppa2dPaUF3T3lBdkx5QndiM2NvTWl3Z05UTXBJQzBnTVNBOVBTQTVNREEzTVRrNU1qVTBOelF3T1RreFhHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmRHOHRiR1Z1WjNSb0xtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTBOMXh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1nTkNBMUlpd2lkbUZ5SUdkc2IySmhiQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZloyeHZZbUZzSnlsY2JpQWdMQ0JqYjNKbElDQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJOdmNtVW5LVnh1SUNBc0lFeEpRbEpCVWxrZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZiR2xpY21GeWVTY3BYRzRnSUN3Z2QydHpSWGgwSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOTNhM010WlhoMEp5bGNiaUFnTENCa1pXWnBibVZRY205d1pYSjBlU0E5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxa2NDY3BMbVk3WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0c1aGJXVXBlMXh1SUNCMllYSWdKRk41YldKdmJDQTlJR052Y21VdVUzbHRZbTlzSUh4OElDaGpiM0psTGxONWJXSnZiQ0E5SUV4SlFsSkJVbGtnUHlCN2ZTQTZJR2RzYjJKaGJDNVRlVzFpYjJ3Z2ZId2dlMzBwTzF4dUlDQnBaaWh1WVcxbExtTm9ZWEpCZENnd0tTQWhQU0FuWHljZ0ppWWdJU2h1WVcxbElHbHVJQ1JUZVcxaWIyd3BLV1JsWm1sdVpWQnliM0JsY25SNUtDUlRlVzFpYjJ3c0lHNWhiV1VzSUh0MllXeDFaVG9nZDJ0elJYaDBMbVlvYm1GdFpTbDlLVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTkzYTNNdFpHVm1hVzVsTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBME9GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWlMQ0psZUhCdmNuUnpMbVlnUFNCeVpYRjFhWEpsS0NjdUwxOTNhM01uS1R0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYM2RyY3kxbGVIUXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRFE1WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlJc0lpZDFjMlVnYzNSeWFXTjBKenRjYm5aaGNpQWtZWFFnSUQwZ2NtVnhkV2x5WlNnbkxpOWZjM1J5YVc1bkxXRjBKeWtvZEhKMVpTazdYRzVjYmk4dklESXhMakV1TXk0eU55QlRkSEpwYm1jdWNISnZkRzkwZVhCbFcwQkFhWFJsY21GMGIzSmRLQ2xjYm5KbGNYVnBjbVVvSnk0dlgybDBaWEl0WkdWbWFXNWxKeWtvVTNSeWFXNW5MQ0FuVTNSeWFXNW5KeXdnWm5WdVkzUnBiMjRvYVhSbGNtRjBaV1FwZTF4dUlDQjBhR2x6TGw5MElEMGdVM1J5YVc1bktHbDBaWEpoZEdWa0tUc2dMeThnZEdGeVoyVjBYRzRnSUhSb2FYTXVYMmtnUFNBd095QWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBdkx5QnVaWGgwSUdsdVpHVjRYRzR2THlBeU1TNHhMalV1TWk0eElDVlRkSEpwYm1kSmRHVnlZWFJ2Y2xCeWIzUnZkSGx3WlNVdWJtVjRkQ2dwWEc1OUxDQm1kVzVqZEdsdmJpZ3BlMXh1SUNCMllYSWdUeUFnSUNBZ1BTQjBhR2x6TGw5MFhHNGdJQ0FnTENCcGJtUmxlQ0E5SUhSb2FYTXVYMmxjYmlBZ0lDQXNJSEJ2YVc1ME8xeHVJQ0JwWmlocGJtUmxlQ0ErUFNCUExteGxibWQwYUNseVpYUjFjbTRnZTNaaGJIVmxPaUIxYm1SbFptbHVaV1FzSUdSdmJtVTZJSFJ5ZFdWOU8xeHVJQ0J3YjJsdWRDQTlJQ1JoZENoUExDQnBibVJsZUNrN1hHNGdJSFJvYVhNdVgya2dLejBnY0c5cGJuUXViR1Z1WjNSb08xeHVJQ0J5WlhSMWNtNGdlM1poYkhWbE9pQndiMmx1ZEN3Z1pHOXVaVG9nWm1Gc2MyVjlPMXh1ZlNrN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMlZ6Tmk1emRISnBibWN1YVhSbGNtRjBiM0l1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURVd1hHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVpTENKeVpYRjFhWEpsS0NjdUwyVnpOaTVoY25KaGVTNXBkR1Z5WVhSdmNpY3BPMXh1ZG1GeUlHZHNiMkpoYkNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOW5iRzlpWVd3bktWeHVJQ0FzSUdocFpHVWdJQ0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5b2FXUmxKeWxjYmlBZ0xDQkpkR1Z5WVhSdmNuTWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZhWFJsY21GMGIzSnpKeWxjYmlBZ0xDQlVUMTlUVkZKSlRrZGZWRUZISUQwZ2NtVnhkV2x5WlNnbkxpOWZkMnR6Snlrb0ozUnZVM1J5YVc1blZHRm5KeWs3WEc1Y2JtWnZjaWgyWVhJZ1kyOXNiR1ZqZEdsdmJuTWdQU0JiSjA1dlpHVk1hWE4wSnl3Z0owUlBUVlJ2YTJWdVRHbHpkQ2NzSUNkTlpXUnBZVXhwYzNRbkxDQW5VM1I1YkdWVGFHVmxkRXhwYzNRbkxDQW5RMU5UVW5Wc1pVeHBjM1FuWFN3Z2FTQTlJREE3SUdrZ1BDQTFPeUJwS3lzcGUxeHVJQ0IyWVhJZ1RrRk5SU0FnSUNBZ0lDQTlJR052Ykd4bFkzUnBiMjV6VzJsZFhHNGdJQ0FnTENCRGIyeHNaV04wYVc5dUlEMGdaMnh2WW1Gc1cwNUJUVVZkWEc0Z0lDQWdMQ0J3Y205MGJ5QWdJQ0FnSUQwZ1EyOXNiR1ZqZEdsdmJpQW1KaUJEYjJ4c1pXTjBhVzl1TG5CeWIzUnZkSGx3WlR0Y2JpQWdhV1lvY0hKdmRHOGdKaVlnSVhCeWIzUnZXMVJQWDFOVVVrbE9SMTlVUVVkZEtXaHBaR1VvY0hKdmRHOHNJRlJQWDFOVVVrbE9SMTlVUVVjc0lFNUJUVVVwTzF4dUlDQkpkR1Z5WVhSdmNuTmJUa0ZOUlYwZ1BTQkpkR1Z5WVhSdmNuTXVRWEp5WVhrN1hHNTlYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDNkbFlpNWtiMjB1YVhSbGNtRmliR1V1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURVeFhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVpTENKMllYSWdZMjl5WlNBZ1BTQnlaWEYxYVhKbEtDY3VMaTh1TGk5dGIyUjFiR1Z6TDE5amIzSmxKeWxjYmlBZ0xDQWtTbE5QVGlBOUlHTnZjbVV1U2xOUFRpQjhmQ0FvWTI5eVpTNUtVMDlPSUQwZ2UzTjBjbWx1WjJsbWVUb2dTbE5QVGk1emRISnBibWRwWm5sOUtUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNGdjM1J5YVc1bmFXWjVLR2wwS1hzZ0x5OGdaWE5zYVc1MExXUnBjMkZpYkdVdGJHbHVaU0J1YnkxMWJuVnpaV1F0ZG1GeWMxeHVJQ0J5WlhSMWNtNGdKRXBUVDA0dWMzUnlhVzVuYVdaNUxtRndjR3g1S0NSS1UwOU9MQ0JoY21kMWJXVnVkSE1wTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwycHpiMjR2YzNSeWFXNW5hV1o1TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBMU0xeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSURZaUxDSXZMeUJuWlhSMGFXNW5JSFJoWnlCbWNtOXRJREU1TGpFdU15NDJJRTlpYW1WamRDNXdjbTkwYjNSNWNHVXVkRzlUZEhKcGJtY29LVnh1ZG1GeUlHTnZaaUE5SUhKbGNYVnBjbVVvSnk0dlgyTnZaaWNwWEc0Z0lDd2dWRUZISUQwZ2NtVnhkV2x5WlNnbkxpOWZkMnR6Snlrb0ozUnZVM1J5YVc1blZHRm5KeWxjYmlBZ0x5OGdSVk16SUhkeWIyNW5JR2hsY21WY2JpQWdMQ0JCVWtjZ1BTQmpiMllvWm5WdVkzUnBiMjRvS1hzZ2NtVjBkWEp1SUdGeVozVnRaVzUwY3pzZ2ZTZ3BLU0E5UFNBblFYSm5kVzFsYm5Sekp6dGNibHh1THk4Z1ptRnNiR0poWTJzZ1ptOXlJRWxGTVRFZ1UyTnlhWEIwSUVGalkyVnpjeUJFWlc1cFpXUWdaWEp5YjNKY2JuWmhjaUIwY25sSFpYUWdQU0JtZFc1amRHbHZiaWhwZEN3Z2EyVjVLWHRjYmlBZ2RISjVJSHRjYmlBZ0lDQnlaWFIxY200Z2FYUmJhMlY1WFR0Y2JpQWdmU0JqWVhSamFDaGxLWHNnTHlvZ1pXMXdkSGtnS2k4Z2ZWeHVmVHRjYmx4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCbWRXNWpkR2x2YmlocGRDbDdYRzRnSUhaaGNpQlBMQ0JVTENCQ08xeHVJQ0J5WlhSMWNtNGdhWFFnUFQwOUlIVnVaR1ZtYVc1bFpDQS9JQ2RWYm1SbFptbHVaV1FuSURvZ2FYUWdQVDA5SUc1MWJHd2dQeUFuVG5Wc2JDZGNiaUFnSUNBdkx5QkFRSFJ2VTNSeWFXNW5WR0ZuSUdOaGMyVmNiaUFnSUNBNklIUjVjR1Z2WmlBb1ZDQTlJSFJ5ZVVkbGRDaFBJRDBnVDJKcVpXTjBLR2wwS1N3Z1ZFRkhLU2tnUFQwZ0ozTjBjbWx1WnljZ1B5QlVYRzRnSUNBZ0x5OGdZblZwYkhScGJsUmhaeUJqWVhObFhHNGdJQ0FnT2lCQlVrY2dQeUJqYjJZb1R5bGNiaUFnSUNBdkx5QkZVek1nWVhKbmRXMWxiblJ6SUdaaGJHeGlZV05yWEc0Z0lDQWdPaUFvUWlBOUlHTnZaaWhQS1NrZ1BUMGdKMDlpYW1WamRDY2dKaVlnZEhsd1pXOW1JRTh1WTJGc2JHVmxJRDA5SUNkbWRXNWpkR2x2YmljZ1B5QW5RWEpuZFcxbGJuUnpKeUE2SUVJN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZlkyeGhjM052Wmk1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ05UVmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ05DQTFJaXdpTHk4Z1ptRnNiR0poWTJzZ1ptOXlJRzV2YmkxaGNuSmhlUzFzYVd0bElFVlRNeUJoYm1RZ2JtOXVMV1Z1ZFcxbGNtRmliR1VnYjJ4a0lGWTRJSE4wY21sdVozTmNiblpoY2lCamIyWWdQU0J5WlhGMWFYSmxLQ2N1TDE5amIyWW5LVHRjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnVDJKcVpXTjBLQ2Q2SnlrdWNISnZjR1Z5ZEhsSmMwVnVkVzFsY21GaWJHVW9NQ2tnUHlCUFltcGxZM1FnT2lCbWRXNWpkR2x2YmlocGRDbDdYRzRnSUhKbGRIVnliaUJqYjJZb2FYUXBJRDA5SUNkVGRISnBibWNuSUQ4Z2FYUXVjM0JzYVhRb0p5Y3BJRG9nVDJKcVpXTjBLR2wwS1R0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5cGIySnFaV04wTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBMU5seHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSWl3aWRtRnlJSEJKUlNBZ0lDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMWEJwWlNjcFhHNGdJQ3dnWTNKbFlYUmxSR1Z6WXlBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5d2NtOXdaWEowZVMxa1pYTmpKeWxjYmlBZ0xDQjBiMGxQWW1wbFkzUWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYM1J2TFdsdlltcGxZM1FuS1Z4dUlDQXNJSFJ2VUhKcGJXbDBhWFpsSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZEc4dGNISnBiV2wwYVhabEp5bGNiaUFnTENCb1lYTWdJQ0FnSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyaGhjeWNwWEc0Z0lDd2dTVVU0WDBSUFRWOUVSVVpKVGtVZ1BTQnlaWEYxYVhKbEtDY3VMMTlwWlRndFpHOXRMV1JsWm1sdVpTY3BYRzRnSUN3Z1owOVFSQ0FnSUNBZ0lDQWdJQ0FnUFNCUFltcGxZM1F1WjJWMFQzZHVVSEp2Y0dWeWRIbEVaWE5qY21sd2RHOXlPMXh1WEc1bGVIQnZjblJ6TG1ZZ1BTQnlaWEYxYVhKbEtDY3VMMTlrWlhOamNtbHdkRzl5Y3ljcElEOGdaMDlRUkNBNklHWjFibU4wYVc5dUlHZGxkRTkzYmxCeWIzQmxjblI1UkdWelkzSnBjSFJ2Y2loUExDQlFLWHRjYmlBZ1R5QTlJSFJ2U1U5aWFtVmpkQ2hQS1R0Y2JpQWdVQ0E5SUhSdlVISnBiV2wwYVhabEtGQXNJSFJ5ZFdVcE8xeHVJQ0JwWmloSlJUaGZSRTlOWDBSRlJrbE9SU2wwY25rZ2UxeHVJQ0FnSUhKbGRIVnliaUJuVDFCRUtFOHNJRkFwTzF4dUlDQjlJR05oZEdOb0tHVXBleUF2S2lCbGJYQjBlU0FxTHlCOVhHNGdJR2xtS0doaGN5aFBMQ0JRS1NseVpYUjFjbTRnWTNKbFlYUmxSR1Z6WXlnaGNFbEZMbVl1WTJGc2JDaFBMQ0JRS1N3Z1QxdFFYU2s3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmYjJKcVpXTjBMV2R2Y0dRdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEVTNYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUlzSW1WNGNHOXlkSE11WmlBOUlFOWlhbVZqZEM1blpYUlBkMjVRY205d1pYSjBlVk41YldKdmJITTdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5dlltcGxZM1F0WjI5d2N5NXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdOVGhjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SWl3aVhDSjFjMlVnYzNSeWFXTjBYQ0k3WEc1Y2JtVjRjRzl5ZEhNdVgxOWxjMDF2WkhWc1pTQTlJSFJ5ZFdVN1hHNWNiblpoY2lCZmFYUmxjbUYwYjNJZ1BTQnlaWEYxYVhKbEtGd2lMaTR2WTI5eVpTMXFjeTl6ZVcxaWIyd3ZhWFJsY21GMGIzSmNJaWs3WEc1Y2JuWmhjaUJmYVhSbGNtRjBiM0l5SUQwZ1gybHVkR1Z5YjNCU1pYRjFhWEpsUkdWbVlYVnNkQ2hmYVhSbGNtRjBiM0lwTzF4dVhHNTJZWElnWDNONWJXSnZiQ0E5SUhKbGNYVnBjbVVvWENJdUxpOWpiM0psTFdwekwzTjViV0p2YkZ3aUtUdGNibHh1ZG1GeUlGOXplVzFpYjJ3eUlEMGdYMmx1ZEdWeWIzQlNaWEYxYVhKbFJHVm1ZWFZzZENoZmMzbHRZbTlzS1R0Y2JseHVkbUZ5SUY5MGVYQmxiMllnUFNCMGVYQmxiMllnWDNONWJXSnZiREl1WkdWbVlYVnNkQ0E5UFQwZ1hDSm1kVzVqZEdsdmJsd2lJQ1ltSUhSNWNHVnZaaUJmYVhSbGNtRjBiM0l5TG1SbFptRjFiSFFnUFQwOUlGd2ljM2x0WW05c1hDSWdQeUJtZFc1amRHbHZiaUFvYjJKcUtTQjdJSEpsZEhWeWJpQjBlWEJsYjJZZ2IySnFPeUI5SURvZ1puVnVZM1JwYjI0Z0tHOWlhaWtnZXlCeVpYUjFjbTRnYjJKcUlDWW1JSFI1Y0dWdlppQmZjM2x0WW05c01pNWtaV1poZFd4MElEMDlQU0JjSW1aMWJtTjBhVzl1WENJZ0ppWWdiMkpxTG1OdmJuTjBjblZqZEc5eUlEMDlQU0JmYzNsdFltOXNNaTVrWldaaGRXeDBJQ1ltSUc5aWFpQWhQVDBnWDNONWJXSnZiREl1WkdWbVlYVnNkQzV3Y205MGIzUjVjR1VnUHlCY0luTjViV0p2YkZ3aUlEb2dkSGx3Wlc5bUlHOWlhanNnZlR0Y2JseHVablZ1WTNScGIyNGdYMmx1ZEdWeWIzQlNaWEYxYVhKbFJHVm1ZWFZzZENodlltb3BJSHNnY21WMGRYSnVJRzlpYWlBbUppQnZZbW91WDE5bGMwMXZaSFZzWlNBL0lHOWlhaUE2SUhzZ1pHVm1ZWFZzZERvZ2IySnFJSDA3SUgxY2JseHVaWGh3YjNKMGN5NWtaV1poZFd4MElEMGdkSGx3Wlc5bUlGOXplVzFpYjJ3eUxtUmxabUYxYkhRZ1BUMDlJRndpWm5WdVkzUnBiMjVjSWlBbUppQmZkSGx3Wlc5bUtGOXBkR1Z5WVhSdmNqSXVaR1ZtWVhWc2RDa2dQVDA5SUZ3aWMzbHRZbTlzWENJZ1B5Qm1kVzVqZEdsdmJpQW9iMkpxS1NCN1hHNGdJSEpsZEhWeWJpQjBlWEJsYjJZZ2IySnFJRDA5UFNCY0luVnVaR1ZtYVc1bFpGd2lJRDhnWENKMWJtUmxabWx1WldSY0lpQTZJRjkwZVhCbGIyWW9iMkpxS1R0Y2JuMGdPaUJtZFc1amRHbHZiaUFvYjJKcUtTQjdYRzRnSUhKbGRIVnliaUJ2WW1vZ0ppWWdkSGx3Wlc5bUlGOXplVzFpYjJ3eUxtUmxabUYxYkhRZ1BUMDlJRndpWm5WdVkzUnBiMjVjSWlBbUppQnZZbW91WTI5dWMzUnlkV04wYjNJZ1BUMDlJRjl6ZVcxaWIyd3lMbVJsWm1GMWJIUWdKaVlnYjJKcUlDRTlQU0JmYzNsdFltOXNNaTVrWldaaGRXeDBMbkJ5YjNSdmRIbHdaU0EvSUZ3aWMzbHRZbTlzWENJZ09pQjBlWEJsYjJZZ2IySnFJRDA5UFNCY0luVnVaR1ZtYVc1bFpGd2lJRDhnWENKMWJtUmxabWx1WldSY0lpQTZJRjkwZVhCbGIyWW9iMkpxS1R0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wySmhZbVZzTFhKMWJuUnBiV1V2YUdWc2NHVnljeTkwZVhCbGIyWXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRFU1WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlJc0ltMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b0tYc2dMeW9nWlcxd2RIa2dLaThnZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMkZrWkMxMGJ5MTFibk5qYjNCaFlteGxjeTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTmpCY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklEUWdOU0lzSWk4dklHWmhiSE5sSUMwK0lFRnljbUY1STJsdVpHVjRUMlpjYmk4dklIUnlkV1VnSUMwK0lFRnljbUY1STJsdVkyeDFaR1Z6WEc1MllYSWdkRzlKVDJKcVpXTjBJRDBnY21WeGRXbHlaU2duTGk5ZmRHOHRhVzlpYW1WamRDY3BYRzRnSUN3Z2RHOU1aVzVuZEdnZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZEc4dGJHVnVaM1JvSnlsY2JpQWdMQ0IwYjBsdVpHVjRJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOTBieTFwYm1SbGVDY3BPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhKVTE5SlRrTk1WVVJGVXlsN1hHNGdJSEpsZEhWeWJpQm1kVzVqZEdsdmJpZ2tkR2hwY3l3Z1pXd3NJR1p5YjIxSmJtUmxlQ2w3WEc0Z0lDQWdkbUZ5SUU4Z0lDQWdJQ0E5SUhSdlNVOWlhbVZqZENna2RHaHBjeWxjYmlBZ0lDQWdJQ3dnYkdWdVozUm9JRDBnZEc5TVpXNW5kR2dvVHk1c1pXNW5kR2dwWEc0Z0lDQWdJQ0FzSUdsdVpHVjRJQ0E5SUhSdlNXNWtaWGdvWm5KdmJVbHVaR1Y0TENCc1pXNW5kR2dwWEc0Z0lDQWdJQ0FzSUhaaGJIVmxPMXh1SUNBZ0lDOHZJRUZ5Y21GNUkybHVZMngxWkdWeklIVnpaWE1nVTJGdFpWWmhiSFZsV21WeWJ5QmxjWFZoYkdsMGVTQmhiR2R2Y21sMGFHMWNiaUFnSUNCcFppaEpVMTlKVGtOTVZVUkZVeUFtSmlCbGJDQWhQU0JsYkNsM2FHbHNaU2hzWlc1bmRHZ2dQaUJwYm1SbGVDbDdYRzRnSUNBZ0lDQjJZV3gxWlNBOUlFOWJhVzVrWlhncksxMDdYRzRnSUNBZ0lDQnBaaWgyWVd4MVpTQWhQU0IyWVd4MVpTbHlaWFIxY200Z2RISjFaVHRjYmlBZ0lDQXZMeUJCY25KaGVTTjBiMGx1WkdWNElHbG5ibTl5WlhNZ2FHOXNaWE1zSUVGeWNtRjVJMmx1WTJ4MVpHVnpJQzBnYm05MFhHNGdJQ0FnZlNCbGJITmxJR1p2Y2lnN2JHVnVaM1JvSUQ0Z2FXNWtaWGc3SUdsdVpHVjRLeXNwYVdZb1NWTmZTVTVEVEZWRVJWTWdmSHdnYVc1a1pYZ2dhVzRnVHlsN1hHNGdJQ0FnSUNCcFppaFBXMmx1WkdWNFhTQTlQVDBnWld3cGNtVjBkWEp1SUVsVFgwbE9RMHhWUkVWVElIeDhJR2x1WkdWNElIeDhJREE3WEc0Z0lDQWdmU0J5WlhSMWNtNGdJVWxUWDBsT1EweFZSRVZUSUNZbUlDMHhPMXh1SUNCOU8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyRnljbUY1TFdsdVkyeDFaR1Z6TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBMk1WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWdOQ0ExSWl3aUozVnpaU0J6ZEhKcFkzUW5PMXh1ZG1GeUlHTnlaV0YwWlNBZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXTnlaV0YwWlNjcFhHNGdJQ3dnWkdWelkzSnBjSFJ2Y2lBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5d2NtOXdaWEowZVMxa1pYTmpKeWxjYmlBZ0xDQnpaWFJVYjFOMGNtbHVaMVJoWnlBOUlISmxjWFZwY21Vb0p5NHZYM05sZEMxMGJ5MXpkSEpwYm1jdGRHRm5KeWxjYmlBZ0xDQkpkR1Z5WVhSdmNsQnliM1J2ZEhsd1pTQTlJSHQ5TzF4dVhHNHZMeUF5TlM0eExqSXVNUzR4SUNWSmRHVnlZWFJ2Y2xCeWIzUnZkSGx3WlNWYlFFQnBkR1Z5WVhSdmNsMG9LVnh1Y21WeGRXbHlaU2duTGk5ZmFHbGtaU2NwS0VsMFpYSmhkRzl5VUhKdmRHOTBlWEJsTENCeVpYRjFhWEpsS0NjdUwxOTNhM01uS1NnbmFYUmxjbUYwYjNJbktTd2dablZ1WTNScGIyNG9LWHNnY21WMGRYSnVJSFJvYVhNN0lIMHBPMXh1WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0VOdmJuTjBjblZqZEc5eUxDQk9RVTFGTENCdVpYaDBLWHRjYmlBZ1EyOXVjM1J5ZFdOMGIzSXVjSEp2ZEc5MGVYQmxJRDBnWTNKbFlYUmxLRWwwWlhKaGRHOXlVSEp2ZEc5MGVYQmxMQ0I3Ym1WNGREb2daR1Z6WTNKcGNIUnZjaWd4TENCdVpYaDBLWDBwTzF4dUlDQnpaWFJVYjFOMGNtbHVaMVJoWnloRGIyNXpkSEoxWTNSdmNpd2dUa0ZOUlNBcklDY2dTWFJsY21GMGIzSW5LVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlwZEdWeUxXTnlaV0YwWlM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ05qSmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJRFFnTlNJc0ltMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b1pHOXVaU3dnZG1Gc2RXVXBlMXh1SUNCeVpYUjFjbTRnZTNaaGJIVmxPaUIyWVd4MVpTd2daRzl1WlRvZ0lTRmtiMjVsZlR0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5cGRHVnlMWE4wWlhBdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEWXpYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUEwSURVaUxDSjJZWElnWkZBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXZZbXBsWTNRdFpIQW5LVnh1SUNBc0lHRnVUMkpxWldOMElEMGdjbVZ4ZFdseVpTZ25MaTlmWVc0dGIySnFaV04wSnlsY2JpQWdMQ0JuWlhSTFpYbHpJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxclpYbHpKeWs3WEc1Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ2NtVnhkV2x5WlNnbkxpOWZaR1Z6WTNKcGNIUnZjbk1uS1NBL0lFOWlhbVZqZEM1a1pXWnBibVZRY205d1pYSjBhV1Z6SURvZ1puVnVZM1JwYjI0Z1pHVm1hVzVsVUhKdmNHVnlkR2xsY3loUExDQlFjbTl3WlhKMGFXVnpLWHRjYmlBZ1lXNVBZbXBsWTNRb1R5azdYRzRnSUhaaGNpQnJaWGx6SUNBZ1BTQm5aWFJMWlhsektGQnliM0JsY25ScFpYTXBYRzRnSUNBZ0xDQnNaVzVuZEdnZ1BTQnJaWGx6TG14bGJtZDBhRnh1SUNBZ0lDd2dhU0E5SURCY2JpQWdJQ0FzSUZBN1hHNGdJSGRvYVd4bEtHeGxibWQwYUNBK0lHa3BaRkF1WmloUExDQlFJRDBnYTJWNWMxdHBLeXRkTENCUWNtOXdaWEowYVdWelcxQmRLVHRjYmlBZ2NtVjBkWEp1SUU4N1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmIySnFaV04wTFdSd2N5NXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdOalJjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SURRZ05TSXNJaTh2SURFNUxqRXVNaTQzSUM4Z01UVXVNaTR6TGpRZ1QySnFaV04wTG1kbGRFOTNibEJ5YjNCbGNuUjVUbUZ0WlhNb1R5bGNiblpoY2lBa2EyVjVjeUFnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMV3RsZVhNdGFXNTBaWEp1WVd3bktWeHVJQ0FzSUdocFpHUmxia3RsZVhNZ1BTQnlaWEYxYVhKbEtDY3VMMTlsYm5WdExXSjFaeTFyWlhsekp5a3VZMjl1WTJGMEtDZHNaVzVuZEdnbkxDQW5jSEp2ZEc5MGVYQmxKeWs3WEc1Y2JtVjRjRzl5ZEhNdVppQTlJRTlpYW1WamRDNW5aWFJQZDI1UWNtOXdaWEowZVU1aGJXVnpJSHg4SUdaMWJtTjBhVzl1SUdkbGRFOTNibEJ5YjNCbGNuUjVUbUZ0WlhNb1R5bDdYRzRnSUhKbGRIVnliaUFrYTJWNWN5aFBMQ0JvYVdSa1pXNUxaWGx6S1R0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5dlltcGxZM1F0WjI5d2JpNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdOalZjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdNaUF6SWl3aWRtRnlJSFJ2U1c1MFpXZGxjaUE5SUhKbGNYVnBjbVVvSnk0dlgzUnZMV2x1ZEdWblpYSW5LVnh1SUNBc0lHUmxabWx1WldRZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJSbFptbHVaV1FuS1R0Y2JpOHZJSFJ5ZFdVZ0lDMCtJRk4wY21sdVp5TmhkRnh1THk4Z1ptRnNjMlVnTFQ0Z1UzUnlhVzVuSTJOdlpHVlFiMmx1ZEVGMFhHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtGUlBYMU5VVWtsT1J5bDdYRzRnSUhKbGRIVnliaUJtZFc1amRHbHZiaWgwYUdGMExDQndiM01wZTF4dUlDQWdJSFpoY2lCeklEMGdVM1J5YVc1bktHUmxabWx1WldRb2RHaGhkQ2twWEc0Z0lDQWdJQ0FzSUdrZ1BTQjBiMGx1ZEdWblpYSW9jRzl6S1Z4dUlDQWdJQ0FnTENCc0lEMGdjeTVzWlc1bmRHaGNiaUFnSUNBZ0lDd2dZU3dnWWp0Y2JpQWdJQ0JwWmlocElEd2dNQ0I4ZkNCcElENDlJR3dwY21WMGRYSnVJRlJQWDFOVVVrbE9SeUEvSUNjbklEb2dkVzVrWldacGJtVmtPMXh1SUNBZ0lHRWdQU0J6TG1Ob1lYSkRiMlJsUVhRb2FTazdYRzRnSUNBZ2NtVjBkWEp1SUdFZ1BDQXdlR1E0TURBZ2ZId2dZU0ErSURCNFpHSm1aaUI4ZkNCcElDc2dNU0E5UFQwZ2JDQjhmQ0FvWWlBOUlITXVZMmhoY2tOdlpHVkJkQ2hwSUNzZ01Ta3BJRHdnTUhoa1l6QXdJSHg4SUdJZ1BpQXdlR1JtWm1aY2JpQWdJQ0FnSUQ4Z1ZFOWZVMVJTU1U1SElEOGdjeTVqYUdGeVFYUW9hU2tnT2lCaFhHNGdJQ0FnSUNBNklGUlBYMU5VVWtsT1J5QS9JSE11YzJ4cFkyVW9hU3dnYVNBcklESXBJRG9nS0dFZ0xTQXdlR1E0TURBZ1BEd2dNVEFwSUNzZ0tHSWdMU0F3ZUdSak1EQXBJQ3NnTUhneE1EQXdNRHRjYmlBZ2ZUdGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXpkSEpwYm1jdFlYUXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRFkyWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWlMQ0oyWVhJZ1kzUjRJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmWTNSNEp5bGNiaUFnTENCcGJuWnZhMlVnSUNBZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlwYm5admEyVW5LVnh1SUNBc0lHaDBiV3dnSUNBZ0lDQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJoMGJXd25LVnh1SUNBc0lHTmxiQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJSdmJTMWpjbVZoZEdVbktWeHVJQ0FzSUdkc2IySmhiQ0FnSUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMmRzYjJKaGJDY3BYRzRnSUN3Z2NISnZZMlZ6Y3lBZ0lDQWdJQ0FnSUNBZ0lEMGdaMnh2WW1Gc0xuQnliMk5sYzNOY2JpQWdMQ0J6WlhSVVlYTnJJQ0FnSUNBZ0lDQWdJQ0FnUFNCbmJHOWlZV3d1YzJWMFNXMXRaV1JwWVhSbFhHNGdJQ3dnWTJ4bFlYSlVZWE5ySUNBZ0lDQWdJQ0FnSUQwZ1oyeHZZbUZzTG1Oc1pXRnlTVzF0WldScFlYUmxYRzRnSUN3Z1RXVnpjMkZuWlVOb1lXNXVaV3dnSUNBZ0lEMGdaMnh2WW1Gc0xrMWxjM05oWjJWRGFHRnVibVZzWEc0Z0lDd2dZMjkxYm5SbGNpQWdJQ0FnSUNBZ0lDQWdJRDBnTUZ4dUlDQXNJSEYxWlhWbElDQWdJQ0FnSUNBZ0lDQWdJQ0E5SUh0OVhHNGdJQ3dnVDA1U1JVRkVXVk5VUVZSRlEwaEJUa2RGSUQwZ0oyOXVjbVZoWkhsemRHRjBaV05vWVc1blpTZGNiaUFnTENCa1pXWmxjaXdnWTJoaGJtNWxiQ3dnY0c5eWREdGNiblpoY2lCeWRXNGdQU0JtZFc1amRHbHZiaWdwZTF4dUlDQjJZWElnYVdRZ1BTQXJkR2hwY3p0Y2JpQWdhV1lvY1hWbGRXVXVhR0Z6VDNkdVVISnZjR1Z5ZEhrb2FXUXBLWHRjYmlBZ0lDQjJZWElnWm00Z1BTQnhkV1YxWlZ0cFpGMDdYRzRnSUNBZ1pHVnNaWFJsSUhGMVpYVmxXMmxrWFR0Y2JpQWdJQ0JtYmlncE8xeHVJQ0I5WEc1OU8xeHVkbUZ5SUd4cGMzUmxibVZ5SUQwZ1puVnVZM1JwYjI0b1pYWmxiblFwZTF4dUlDQnlkVzR1WTJGc2JDaGxkbVZ1ZEM1a1lYUmhLVHRjYm4wN1hHNHZMeUJPYjJSbExtcHpJREF1T1NzZ0ppQkpSVEV3S3lCb1lYTWdjMlYwU1cxdFpXUnBZWFJsTENCdmRHaGxjbmRwYzJVNlhHNXBaaWdoYzJWMFZHRnpheUI4ZkNBaFkyeGxZWEpVWVhOcktYdGNiaUFnYzJWMFZHRnpheUE5SUdaMWJtTjBhVzl1SUhObGRFbHRiV1ZrYVdGMFpTaG1iaWw3WEc0Z0lDQWdkbUZ5SUdGeVozTWdQU0JiWFN3Z2FTQTlJREU3WEc0Z0lDQWdkMmhwYkdVb1lYSm5kVzFsYm5SekxteGxibWQwYUNBK0lHa3BZWEpuY3k1d2RYTm9LR0Z5WjNWdFpXNTBjMXRwS3l0ZEtUdGNiaUFnSUNCeGRXVjFaVnNySzJOdmRXNTBaWEpkSUQwZ1puVnVZM1JwYjI0b0tYdGNiaUFnSUNBZ0lHbHVkbTlyWlNoMGVYQmxiMllnWm00Z1BUMGdKMloxYm1OMGFXOXVKeUEvSUdadUlEb2dSblZ1WTNScGIyNG9abTRwTENCaGNtZHpLVHRjYmlBZ0lDQjlPMXh1SUNBZ0lHUmxabVZ5S0dOdmRXNTBaWElwTzF4dUlDQWdJSEpsZEhWeWJpQmpiM1Z1ZEdWeU8xeHVJQ0I5TzF4dUlDQmpiR1ZoY2xSaGMyc2dQU0JtZFc1amRHbHZiaUJqYkdWaGNrbHRiV1ZrYVdGMFpTaHBaQ2w3WEc0Z0lDQWdaR1ZzWlhSbElIRjFaWFZsVzJsa1hUdGNiaUFnZlR0Y2JpQWdMeThnVG05a1pTNXFjeUF3TGpndFhHNGdJR2xtS0hKbGNYVnBjbVVvSnk0dlgyTnZaaWNwS0hCeWIyTmxjM01wSUQwOUlDZHdjbTlqWlhOekp5bDdYRzRnSUNBZ1pHVm1aWElnUFNCbWRXNWpkR2x2YmlocFpDbDdYRzRnSUNBZ0lDQndjbTlqWlhOekxtNWxlSFJVYVdOcktHTjBlQ2h5ZFc0c0lHbGtMQ0F4S1NrN1hHNGdJQ0FnZlR0Y2JpQWdMeThnUW5KdmQzTmxjbk1nZDJsMGFDQk5aWE56WVdkbFEyaGhibTVsYkN3Z2FXNWpiSFZrWlhNZ1YyVmlWMjl5YTJWeWMxeHVJQ0I5SUdWc2MyVWdhV1lvVFdWemMyRm5aVU5vWVc1dVpXd3BlMXh1SUNBZ0lHTm9ZVzV1Wld3Z1BTQnVaWGNnVFdWemMyRm5aVU5vWVc1dVpXdzdYRzRnSUNBZ2NHOXlkQ0FnSUNBOUlHTm9ZVzV1Wld3dWNHOXlkREk3WEc0Z0lDQWdZMmhoYm01bGJDNXdiM0owTVM1dmJtMWxjM05oWjJVZ1BTQnNhWE4wWlc1bGNqdGNiaUFnSUNCa1pXWmxjaUE5SUdOMGVDaHdiM0owTG5CdmMzUk5aWE56WVdkbExDQndiM0owTENBeEtUdGNiaUFnTHk4Z1FuSnZkM05sY25NZ2QybDBhQ0J3YjNOMFRXVnpjMkZuWlN3Z2MydHBjQ0JYWldKWGIzSnJaWEp6WEc0Z0lDOHZJRWxGT0NCb1lYTWdjRzl6ZEUxbGMzTmhaMlVzSUdKMWRDQnBkQ2R6SUhONWJtTWdKaUIwZVhCbGIyWWdhWFJ6SUhCdmMzUk5aWE56WVdkbElHbHpJQ2R2WW1wbFkzUW5YRzRnSUgwZ1pXeHpaU0JwWmlobmJHOWlZV3d1WVdSa1JYWmxiblJNYVhOMFpXNWxjaUFtSmlCMGVYQmxiMllnY0c5emRFMWxjM05oWjJVZ1BUMGdKMloxYm1OMGFXOXVKeUFtSmlBaFoyeHZZbUZzTG1sdGNHOXlkRk5qY21sd2RITXBlMXh1SUNBZ0lHUmxabVZ5SUQwZ1puVnVZM1JwYjI0b2FXUXBlMXh1SUNBZ0lDQWdaMnh2WW1Gc0xuQnZjM1JOWlhOellXZGxLR2xrSUNzZ0p5Y3NJQ2NxSnlrN1hHNGdJQ0FnZlR0Y2JpQWdJQ0JuYkc5aVlXd3VZV1JrUlhabGJuUk1hWE4wWlc1bGNpZ25iV1Z6YzJGblpTY3NJR3hwYzNSbGJtVnlMQ0JtWVd4elpTazdYRzRnSUM4dklFbEZPQzFjYmlBZ2ZTQmxiSE5sSUdsbUtFOU9Va1ZCUkZsVFZFRlVSVU5JUVU1SFJTQnBiaUJqWld3b0ozTmpjbWx3ZENjcEtYdGNiaUFnSUNCa1pXWmxjaUE5SUdaMWJtTjBhVzl1S0dsa0tYdGNiaUFnSUNBZ0lHaDBiV3d1WVhCd1pXNWtRMmhwYkdRb1kyVnNLQ2R6WTNKcGNIUW5LU2xiVDA1U1JVRkVXVk5VUVZSRlEwaEJUa2RGWFNBOUlHWjFibU4wYVc5dUtDbDdYRzRnSUNBZ0lDQWdJR2gwYld3dWNtVnRiM1psUTJocGJHUW9kR2hwY3lrN1hHNGdJQ0FnSUNBZ0lISjFiaTVqWVd4c0tHbGtLVHRjYmlBZ0lDQWdJSDA3WEc0Z0lDQWdmVHRjYmlBZ0x5OGdVbVZ6ZENCdmJHUWdZbkp2ZDNObGNuTmNiaUFnZlNCbGJITmxJSHRjYmlBZ0lDQmtaV1psY2lBOUlHWjFibU4wYVc5dUtHbGtLWHRjYmlBZ0lDQWdJSE5sZEZScGJXVnZkWFFvWTNSNEtISjFiaXdnYVdRc0lERXBMQ0F3S1R0Y2JpQWdJQ0I5TzF4dUlDQjlYRzU5WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUh0Y2JpQWdjMlYwT2lBZ0lITmxkRlJoYzJzc1hHNGdJR05zWldGeU9pQmpiR1ZoY2xSaGMydGNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOTBZWE5yTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBMk4xeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBMElEVWlMQ0oyWVhJZ2RHOUpiblJsWjJWeUlEMGdjbVZ4ZFdseVpTZ25MaTlmZEc4dGFXNTBaV2RsY2ljcFhHNGdJQ3dnYldGNElDQWdJQ0FnSUQwZ1RXRjBhQzV0WVhoY2JpQWdMQ0J0YVc0Z0lDQWdJQ0FnUFNCTllYUm9MbTFwYmp0Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0b2FXNWtaWGdzSUd4bGJtZDBhQ2w3WEc0Z0lHbHVaR1Y0SUQwZ2RHOUpiblJsWjJWeUtHbHVaR1Y0S1R0Y2JpQWdjbVYwZFhKdUlHbHVaR1Y0SUR3Z01DQS9JRzFoZUNocGJtUmxlQ0FySUd4bGJtZDBhQ3dnTUNrZ09pQnRhVzRvYVc1a1pYZ3NJR3hsYm1kMGFDazdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZkRzh0YVc1a1pYZ3Vhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRFk0WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlBMElEVWlMQ0luZFhObElITjBjbWxqZENjN1hHNTJZWElnWVdSa1ZHOVZibk5qYjNCaFlteGxjeUE5SUhKbGNYVnBjbVVvSnk0dlgyRmtaQzEwYnkxMWJuTmpiM0JoWW14bGN5Y3BYRzRnSUN3Z2MzUmxjQ0FnSUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMmwwWlhJdGMzUmxjQ2NwWEc0Z0lDd2dTWFJsY21GMGIzSnpJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJsMFpYSmhkRzl5Y3ljcFhHNGdJQ3dnZEc5SlQySnFaV04wSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzUnZMV2x2WW1wbFkzUW5LVHRjYmx4dUx5OGdNakl1TVM0ekxqUWdRWEp5WVhrdWNISnZkRzkwZVhCbExtVnVkSEpwWlhNb0tWeHVMeThnTWpJdU1TNHpMakV6SUVGeWNtRjVMbkJ5YjNSdmRIbHdaUzVyWlhsektDbGNiaTh2SURJeUxqRXVNeTR5T1NCQmNuSmhlUzV3Y205MGIzUjVjR1V1ZG1Gc2RXVnpLQ2xjYmk4dklESXlMakV1TXk0ek1DQkJjbkpoZVM1d2NtOTBiM1I1Y0dWYlFFQnBkR1Z5WVhSdmNsMG9LVnh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0J5WlhGMWFYSmxLQ2N1TDE5cGRHVnlMV1JsWm1sdVpTY3BLRUZ5Y21GNUxDQW5RWEp5WVhrbkxDQm1kVzVqZEdsdmJpaHBkR1Z5WVhSbFpDd2dhMmx1WkNsN1hHNGdJSFJvYVhNdVgzUWdQU0IwYjBsUFltcGxZM1FvYVhSbGNtRjBaV1FwT3lBdkx5QjBZWEpuWlhSY2JpQWdkR2hwY3k1ZmFTQTlJREE3SUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUM4dklHNWxlSFFnYVc1a1pYaGNiaUFnZEdocGN5NWZheUE5SUd0cGJtUTdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDOHZJR3RwYm1SY2JpOHZJREl5TGpFdU5TNHlMakVnSlVGeWNtRjVTWFJsY21GMGIzSlFjbTkwYjNSNWNHVWxMbTVsZUhRb0tWeHVmU3dnWm5WdVkzUnBiMjRvS1h0Y2JpQWdkbUZ5SUU4Z0lDQWdJRDBnZEdocGN5NWZkRnh1SUNBZ0lDd2dhMmx1WkNBZ1BTQjBhR2x6TGw5clhHNGdJQ0FnTENCcGJtUmxlQ0E5SUhSb2FYTXVYMmtyS3p0Y2JpQWdhV1lvSVU4Z2ZId2dhVzVrWlhnZ1BqMGdUeTVzWlc1bmRHZ3BlMXh1SUNBZ0lIUm9hWE11WDNRZ1BTQjFibVJsWm1sdVpXUTdYRzRnSUNBZ2NtVjBkWEp1SUhOMFpYQW9NU2s3WEc0Z0lIMWNiaUFnYVdZb2EybHVaQ0E5UFNBbmEyVjVjeWNnSUNseVpYUjFjbTRnYzNSbGNDZ3dMQ0JwYm1SbGVDazdYRzRnSUdsbUtHdHBibVFnUFQwZ0ozWmhiSFZsY3ljcGNtVjBkWEp1SUhOMFpYQW9NQ3dnVDF0cGJtUmxlRjBwTzF4dUlDQnlaWFIxY200Z2MzUmxjQ2d3TENCYmFXNWtaWGdzSUU5YmFXNWtaWGhkWFNrN1hHNTlMQ0FuZG1Gc2RXVnpKeWs3WEc1Y2JpOHZJR0Z5WjNWdFpXNTBjMHhwYzNSYlFFQnBkR1Z5WVhSdmNsMGdhWE1nSlVGeWNtRjVVSEp2ZEc5ZmRtRnNkV1Z6SlNBb09TNDBMalF1Tml3Z09TNDBMalF1TnlsY2JrbDBaWEpoZEc5eWN5NUJjbWQxYldWdWRITWdQU0JKZEdWeVlYUnZjbk11UVhKeVlYazdYRzVjYm1Ga1pGUnZWVzV6WTI5d1lXSnNaWE1vSjJ0bGVYTW5LVHRjYm1Ga1pGUnZWVzV6WTI5d1lXSnNaWE1vSjNaaGJIVmxjeWNwTzF4dVlXUmtWRzlWYm5OamIzQmhZbXhsY3lnblpXNTBjbWxsY3ljcE8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlsY3pZdVlYSnlZWGt1YVhSbGNtRjBiM0l1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURZNVhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015QTBJRFVpTENKdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhzZ1hDSmtaV1poZFd4MFhDSTZJSEpsY1hWcGNtVW9YQ0pqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2YjJKcVpXTjBMMnRsZVhOY0lpa3NJRjlmWlhOTmIyUjFiR1U2SUhSeWRXVWdmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZbUZpWld3dGNuVnVkR2x0WlM5amIzSmxMV3B6TDI5aWFtVmpkQzlyWlhsekxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTNNRnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01pQTBJRFVpTENKdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhzZ1hDSmtaV1poZFd4MFhDSTZJSEpsY1hWcGNtVW9YQ0pqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2Y0hKdmJXbHpaVndpS1N3Z1gxOWxjMDF2WkhWc1pUb2dkSEoxWlNCOU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMk52Y21VdGFuTXZjSEp2YldselpTNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdOekZjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lERWdOQ0ExSWl3aWRtRnlJRTFGVkVFZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmRXbGtKeWtvSjIxbGRHRW5LVnh1SUNBc0lHbHpUMkpxWldOMElEMGdjbVZ4ZFdseVpTZ25MaTlmYVhNdGIySnFaV04wSnlsY2JpQWdMQ0JvWVhNZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyaGhjeWNwWEc0Z0lDd2djMlYwUkdWell5QWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0WkhBbktTNW1YRzRnSUN3Z2FXUWdJQ0FnSUNBZ1BTQXdPMXh1ZG1GeUlHbHpSWGgwWlc1emFXSnNaU0E5SUU5aWFtVmpkQzVwYzBWNGRHVnVjMmxpYkdVZ2ZId2dablZ1WTNScGIyNG9LWHRjYmlBZ2NtVjBkWEp1SUhSeWRXVTdYRzU5TzF4dWRtRnlJRVpTUlVWYVJTQTlJQ0Z5WlhGMWFYSmxLQ2N1TDE5bVlXbHNjeWNwS0daMWJtTjBhVzl1S0NsN1hHNGdJSEpsZEhWeWJpQnBjMFY0ZEdWdWMybGliR1VvVDJKcVpXTjBMbkJ5WlhabGJuUkZlSFJsYm5OcGIyNXpLSHQ5S1NrN1hHNTlLVHRjYm5aaGNpQnpaWFJOWlhSaElEMGdablZ1WTNScGIyNG9hWFFwZTF4dUlDQnpaWFJFWlhOaktHbDBMQ0JOUlZSQkxDQjdkbUZzZFdVNklIdGNiaUFnSUNCcE9pQW5UeWNnS3lBcksybGtMQ0F2THlCdlltcGxZM1FnU1VSY2JpQWdJQ0IzT2lCN2ZTQWdJQ0FnSUNBZ0lDQXZMeUIzWldGcklHTnZiR3hsWTNScGIyNXpJRWxFYzF4dUlDQjlmU2s3WEc1OU8xeHVkbUZ5SUdaaGMzUkxaWGtnUFNCbWRXNWpkR2x2YmlocGRDd2dZM0psWVhSbEtYdGNiaUFnTHk4Z2NtVjBkWEp1SUhCeWFXMXBkR2wyWlNCM2FYUm9JSEJ5WldacGVGeHVJQ0JwWmlnaGFYTlBZbXBsWTNRb2FYUXBLWEpsZEhWeWJpQjBlWEJsYjJZZ2FYUWdQVDBnSjNONWJXSnZiQ2NnUHlCcGRDQTZJQ2gwZVhCbGIyWWdhWFFnUFQwZ0ozTjBjbWx1WnljZ1B5QW5VeWNnT2lBblVDY3BJQ3NnYVhRN1hHNGdJR2xtS0NGb1lYTW9hWFFzSUUxRlZFRXBLWHRjYmlBZ0lDQXZMeUJqWVc0bmRDQnpaWFFnYldWMFlXUmhkR0VnZEc4Z2RXNWpZWFZuYUhRZ1puSnZlbVZ1SUc5aWFtVmpkRnh1SUNBZ0lHbG1LQ0ZwYzBWNGRHVnVjMmxpYkdVb2FYUXBLWEpsZEhWeWJpQW5SaWM3WEc0Z0lDQWdMeThnYm05MElHNWxZMlZ6YzJGeWVTQjBieUJoWkdRZ2JXVjBZV1JoZEdGY2JpQWdJQ0JwWmlnaFkzSmxZWFJsS1hKbGRIVnliaUFuUlNjN1hHNGdJQ0FnTHk4Z1lXUmtJRzFwYzNOcGJtY2diV1YwWVdSaGRHRmNiaUFnSUNCelpYUk5aWFJoS0dsMEtUdGNiaUFnTHk4Z2NtVjBkWEp1SUc5aWFtVmpkQ0JKUkZ4dUlDQjlJSEpsZEhWeWJpQnBkRnROUlZSQlhTNXBPMXh1ZlR0Y2JuWmhjaUJuWlhSWFpXRnJJRDBnWm5WdVkzUnBiMjRvYVhRc0lHTnlaV0YwWlNsN1hHNGdJR2xtS0NGb1lYTW9hWFFzSUUxRlZFRXBLWHRjYmlBZ0lDQXZMeUJqWVc0bmRDQnpaWFFnYldWMFlXUmhkR0VnZEc4Z2RXNWpZWFZuYUhRZ1puSnZlbVZ1SUc5aWFtVmpkRnh1SUNBZ0lHbG1LQ0ZwYzBWNGRHVnVjMmxpYkdVb2FYUXBLWEpsZEhWeWJpQjBjblZsTzF4dUlDQWdJQzh2SUc1dmRDQnVaV05sYzNOaGNua2dkRzhnWVdSa0lHMWxkR0ZrWVhSaFhHNGdJQ0FnYVdZb0lXTnlaV0YwWlNseVpYUjFjbTRnWm1Gc2MyVTdYRzRnSUNBZ0x5OGdZV1JrSUcxcGMzTnBibWNnYldWMFlXUmhkR0ZjYmlBZ0lDQnpaWFJOWlhSaEtHbDBLVHRjYmlBZ0x5OGdjbVYwZFhKdUlHaGhjMmdnZDJWaGF5QmpiMnhzWldOMGFXOXVjeUJKUkhOY2JpQWdmU0J5WlhSMWNtNGdhWFJiVFVWVVFWMHVkenRjYm4wN1hHNHZMeUJoWkdRZ2JXVjBZV1JoZEdFZ2IyNGdabkpsWlhwbExXWmhiV2xzZVNCdFpYUm9iMlJ6SUdOaGJHeHBibWRjYm5aaGNpQnZia1p5WldWNlpTQTlJR1oxYm1OMGFXOXVLR2wwS1h0Y2JpQWdhV1lvUmxKRlJWcEZJQ1ltSUcxbGRHRXVUa1ZGUkNBbUppQnBjMFY0ZEdWdWMybGliR1VvYVhRcElDWW1JQ0ZvWVhNb2FYUXNJRTFGVkVFcEtYTmxkRTFsZEdFb2FYUXBPMXh1SUNCeVpYUjFjbTRnYVhRN1hHNTlPMXh1ZG1GeUlHMWxkR0VnUFNCdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUh0Y2JpQWdTMFZaT2lBZ0lDQWdJRTFGVkVFc1hHNGdJRTVGUlVRNklDQWdJQ0JtWVd4elpTeGNiaUFnWm1GemRFdGxlVG9nSUdaaGMzUkxaWGtzWEc0Z0lHZGxkRmRsWVdzNklDQm5aWFJYWldGckxGeHVJQ0J2YmtaeVpXVjZaVG9nYjI1R2NtVmxlbVZjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl0WlhSaExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTNNbHh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENKMllYSWdZMnhoYzNOdlppQWdJRDBnY21WeGRXbHlaU2duTGk5ZlkyeGhjM052WmljcFhHNGdJQ3dnU1ZSRlVrRlVUMUlnSUQwZ2NtVnhkV2x5WlNnbkxpOWZkMnR6Snlrb0oybDBaWEpoZEc5eUp5bGNiaUFnTENCSmRHVnlZWFJ2Y25NZ1BTQnlaWEYxYVhKbEtDY3VMMTlwZEdWeVlYUnZjbk1uS1R0Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ2NtVnhkV2x5WlNnbkxpOWZZMjl5WlNjcExtZGxkRWwwWlhKaGRHOXlUV1YwYUc5a0lEMGdablZ1WTNScGIyNG9hWFFwZTF4dUlDQnBaaWhwZENBaFBTQjFibVJsWm1sdVpXUXBjbVYwZFhKdUlHbDBXMGxVUlZKQlZFOVNYVnh1SUNBZ0lIeDhJR2wwV3lkQVFHbDBaWEpoZEc5eUoxMWNiaUFnSUNCOGZDQkpkR1Z5WVhSdmNuTmJZMnhoYzNOdlppaHBkQ2xkTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WTI5eVpTNW5aWFF0YVhSbGNtRjBiM0l0YldWMGFHOWtMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0EzTTF4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0EwSURVaUxDSnRiMlIxYkdVdVpYaHdiM0owY3lBOUlIc2dYQ0prWldaaGRXeDBYQ0k2SUhKbGNYVnBjbVVvWENKamIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmIySnFaV04wTDJOeVpXRjBaVndpS1N3Z1gxOWxjMDF2WkhWc1pUb2dkSEoxWlNCOU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMk52Y21VdGFuTXZiMkpxWldOMEwyTnlaV0YwWlM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ056UmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJaXdpYlc5a2RXeGxMbVY0Y0c5eWRITWdQU0I3SUZ3aVpHVm1ZWFZzZEZ3aU9pQnlaWEYxYVhKbEtGd2lZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMjlpYW1WamRDOXpaWFF0Y0hKdmRHOTBlWEJsTFc5bVhDSXBMQ0JmWDJWelRXOWtkV3hsT2lCMGNuVmxJSDA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMkpoWW1Wc0xYSjFiblJwYldVdlkyOXlaUzFxY3k5dlltcGxZM1F2YzJWMExYQnliM1J2ZEhsd1pTMXZaaTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTnpWY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklpd2liVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQjdJRndpWkdWbVlYVnNkRndpT2lCeVpYRjFhWEpsS0Z3aVkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwzTjViV0p2YkZ3aUtTd2dYMTlsYzAxdlpIVnNaVG9nZEhKMVpTQjlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJOdmNtVXRhbk12YzNsdFltOXNMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0EzTmx4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNaUxDSnRiMlIxYkdVdVpYaHdiM0owY3lBOUlIc2dYQ0prWldaaGRXeDBYQ0k2SUhKbGNYVnBjbVVvWENKamIzSmxMV3B6TDJ4cFluSmhjbmt2Wm00dmMzbHRZbTlzTDJsMFpYSmhkRzl5WENJcExDQmZYMlZ6VFc5a2RXeGxPaUIwY25WbElIMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wySmhZbVZzTFhKMWJuUnBiV1V2WTI5eVpTMXFjeTl6ZVcxaWIyd3ZhWFJsY21GMGIzSXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRGMzWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlJc0luSmxjWFZwY21Vb0p5NHVMeTR1TDIxdlpIVnNaWE12WlhNMkxtOWlhbVZqZEM1amNtVmhkR1VuS1R0Y2JuWmhjaUFrVDJKcVpXTjBJRDBnY21WeGRXbHlaU2duTGk0dkxpNHZiVzlrZFd4bGN5OWZZMjl5WlNjcExrOWlhbVZqZER0Y2JtMXZaSFZzWlM1bGVIQnZjblJ6SUQwZ1puVnVZM1JwYjI0Z1kzSmxZWFJsS0ZBc0lFUXBlMXh1SUNCeVpYUjFjbTRnSkU5aWFtVmpkQzVqY21WaGRHVW9VQ3dnUkNrN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdlptNHZiMkpxWldOMEwyTnlaV0YwWlM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ056aGNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJaXdpY21WeGRXbHlaU2duTGk0dkxpNHZiVzlrZFd4bGN5OWxjell1YjJKcVpXTjBMbWRsZEMxd2NtOTBiM1I1Y0dVdGIyWW5LVHRjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnY21WeGRXbHlaU2duTGk0dkxpNHZiVzlrZFd4bGN5OWZZMjl5WlNjcExrOWlhbVZqZEM1blpYUlFjbTkwYjNSNWNHVlBaanRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyWnVMMjlpYW1WamRDOW5aWFF0Y0hKdmRHOTBlWEJsTFc5bUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTNPVnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQXlJRE1pTENKeVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMlZ6Tmk1dlltcGxZM1F1YTJWNWN5Y3BPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0J5WlhGMWFYSmxLQ2N1TGk4dUxpOXRiMlIxYkdWekwxOWpiM0psSnlrdVQySnFaV04wTG10bGVYTTdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5bWJpOXZZbXBsWTNRdmEyVjVjeTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnT0RCY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJRElnTkNBMUlpd2ljbVZ4ZFdseVpTZ25MaTR2TGk0dmJXOWtkV3hsY3k5bGN6WXViMkpxWldOMExuTmxkQzF3Y205MGIzUjVjR1V0YjJZbktUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdjbVZ4ZFdseVpTZ25MaTR2TGk0dmJXOWtkV3hsY3k5ZlkyOXlaU2NwTGs5aWFtVmpkQzV6WlhSUWNtOTBiM1I1Y0dWUFpqdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDJadUwyOWlhbVZqZEM5elpYUXRjSEp2ZEc5MGVYQmxMVzltTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBNE1WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWlMQ0p5WlhGMWFYSmxLQ2N1TGk5dGIyUjFiR1Z6TDJWek5pNXZZbXBsWTNRdWRHOHRjM1J5YVc1bkp5azdYRzV5WlhGMWFYSmxLQ2N1TGk5dGIyUjFiR1Z6TDJWek5pNXpkSEpwYm1jdWFYUmxjbUYwYjNJbktUdGNibkpsY1hWcGNtVW9KeTR1TDIxdlpIVnNaWE12ZDJWaUxtUnZiUzVwZEdWeVlXSnNaU2NwTzF4dWNtVnhkV2x5WlNnbkxpNHZiVzlrZFd4bGN5OWxjell1Y0hKdmJXbHpaU2NwTzF4dWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCeVpYRjFhWEpsS0NjdUxpOXRiMlIxYkdWekwxOWpiM0psSnlrdVVISnZiV2x6WlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMlp1TDNCeWIyMXBjMlV1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURneVhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURRZ05TSXNJbkpsY1hWcGNtVW9KeTR1THk0dUwyMXZaSFZzWlhNdlpYTTJMbk41YldKdmJDY3BPMXh1Y21WeGRXbHlaU2duTGk0dkxpNHZiVzlrZFd4bGN5OWxjell1YjJKcVpXTjBMblJ2TFhOMGNtbHVaeWNwTzF4dWNtVnhkV2x5WlNnbkxpNHZMaTR2Ylc5a2RXeGxjeTlsY3pjdWMzbHRZbTlzTG1GemVXNWpMV2wwWlhKaGRHOXlKeWs3WEc1eVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMlZ6Tnk1emVXMWliMnd1YjJKelpYSjJZV0pzWlNjcE8xeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQnlaWEYxYVhKbEtDY3VMaTh1TGk5dGIyUjFiR1Z6TDE5amIzSmxKeWt1VTNsdFltOXNPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdlptNHZjM2x0WW05c0wybHVaR1Y0TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBNE0xeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWlMQ0p5WlhGMWFYSmxLQ2N1TGk4dUxpOXRiMlIxYkdWekwyVnpOaTV6ZEhKcGJtY3VhWFJsY21GMGIzSW5LVHRjYm5KbGNYVnBjbVVvSnk0dUx5NHVMMjF2WkhWc1pYTXZkMlZpTG1SdmJTNXBkR1Z5WVdKc1pTY3BPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0J5WlhGMWFYSmxLQ2N1TGk4dUxpOXRiMlIxYkdWekwxOTNhM010WlhoMEp5a3VaaWduYVhSbGNtRjBiM0luS1R0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMlp1TDNONWJXSnZiQzlwZEdWeVlYUnZjaTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnT0RSY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklpd2liVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpaHBkQ3dnUTI5dWMzUnlkV04wYjNJc0lHNWhiV1VzSUdadmNtSnBaR1JsYmtacFpXeGtLWHRjYmlBZ2FXWW9JU2hwZENCcGJuTjBZVzVqWlc5bUlFTnZibk4wY25WamRHOXlLU0I4ZkNBb1ptOXlZbWxrWkdWdVJtbGxiR1FnSVQwOUlIVnVaR1ZtYVc1bFpDQW1KaUJtYjNKaWFXUmtaVzVHYVdWc1pDQnBiaUJwZENrcGUxeHVJQ0FnSUhSb2NtOTNJRlI1Y0dWRmNuSnZjaWh1WVcxbElDc2dKem9nYVc1amIzSnlaV04wSUdsdWRtOWpZWFJwYjI0aEp5azdYRzRnSUgwZ2NtVjBkWEp1SUdsME8xeHVmVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlgyRnVMV2x1YzNSaGJtTmxMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0E0TlZ4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0EwSURVaUxDSXZMeUJoYkd3Z1pXNTFiV1Z5WVdKc1pTQnZZbXBsWTNRZ2EyVjVjeXdnYVc1amJIVmtaWE1nYzNsdFltOXNjMXh1ZG1GeUlHZGxkRXRsZVhNZ1BTQnlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRhMlY1Y3ljcFhHNGdJQ3dnWjA5UVV5QWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxbmIzQnpKeWxjYmlBZ0xDQndTVVVnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMWEJwWlNjcE8xeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpaHBkQ2w3WEc0Z0lIWmhjaUJ5WlhOMWJIUWdJQ0FnSUQwZ1oyVjBTMlY1Y3locGRDbGNiaUFnSUNBc0lHZGxkRk41YldKdmJITWdQU0JuVDFCVExtWTdYRzRnSUdsbUtHZGxkRk41YldKdmJITXBlMXh1SUNBZ0lIWmhjaUJ6ZVcxaWIyeHpJRDBnWjJWMFUzbHRZbTlzY3locGRDbGNiaUFnSUNBZ0lDd2dhWE5GYm5WdElDQTlJSEJKUlM1bVhHNGdJQ0FnSUNBc0lHa2dJQ0FnSUNBZ1BTQXdYRzRnSUNBZ0lDQXNJR3RsZVR0Y2JpQWdJQ0IzYUdsc1pTaHplVzFpYjJ4ekxteGxibWQwYUNBK0lHa3BhV1lvYVhORmJuVnRMbU5oYkd3b2FYUXNJR3RsZVNBOUlITjViV0p2YkhOYmFTc3JYU2twY21WemRXeDBMbkIxYzJnb2EyVjVLVHRjYmlBZ2ZTQnlaWFIxY200Z2NtVnpkV3gwTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJWdWRXMHRhMlY1Y3k1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ09EWmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJaXdpZG1GeUlHTjBlQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZlkzUjRKeWxjYmlBZ0xDQmpZV3hzSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgybDBaWEl0WTJGc2JDY3BYRzRnSUN3Z2FYTkJjbkpoZVVsMFpYSWdQU0J5WlhGMWFYSmxLQ2N1TDE5cGN5MWhjbkpoZVMxcGRHVnlKeWxjYmlBZ0xDQmhiazlpYW1WamRDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyRnVMVzlpYW1WamRDY3BYRzRnSUN3Z2RHOU1aVzVuZEdnZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5MGJ5MXNaVzVuZEdnbktWeHVJQ0FzSUdkbGRFbDBaWEpHYmlBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlqYjNKbExtZGxkQzFwZEdWeVlYUnZjaTF0WlhSb2IyUW5LVnh1SUNBc0lFSlNSVUZMSUNBZ0lDQWdJRDBnZTMxY2JpQWdMQ0JTUlZSVlVrNGdJQ0FnSUNBOUlIdDlPMXh1ZG1GeUlHVjRjRzl5ZEhNZ1BTQnRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHbDBaWEpoWW14bExDQmxiblJ5YVdWekxDQm1iaXdnZEdoaGRDd2dTVlJGVWtGVVQxSXBlMXh1SUNCMllYSWdhWFJsY2tadUlEMGdTVlJGVWtGVVQxSWdQeUJtZFc1amRHbHZiaWdwZXlCeVpYUjFjbTRnYVhSbGNtRmliR1U3SUgwZ09pQm5aWFJKZEdWeVJtNG9hWFJsY21GaWJHVXBYRzRnSUNBZ0xDQm1JQ0FnSUNBZ1BTQmpkSGdvWm00c0lIUm9ZWFFzSUdWdWRISnBaWE1nUHlBeUlEb2dNU2xjYmlBZ0lDQXNJR2x1WkdWNElDQTlJREJjYmlBZ0lDQXNJR3hsYm1kMGFDd2djM1JsY0N3Z2FYUmxjbUYwYjNJc0lISmxjM1ZzZER0Y2JpQWdhV1lvZEhsd1pXOW1JR2wwWlhKR2JpQWhQU0FuWm5WdVkzUnBiMjRuS1hSb2NtOTNJRlI1Y0dWRmNuSnZjaWhwZEdWeVlXSnNaU0FySUNjZ2FYTWdibTkwSUdsMFpYSmhZbXhsSVNjcE8xeHVJQ0F2THlCbVlYTjBJR05oYzJVZ1ptOXlJR0Z5Y21GNWN5QjNhWFJvSUdSbFptRjFiSFFnYVhSbGNtRjBiM0pjYmlBZ2FXWW9hWE5CY25KaGVVbDBaWElvYVhSbGNrWnVLU2xtYjNJb2JHVnVaM1JvSUQwZ2RHOU1aVzVuZEdnb2FYUmxjbUZpYkdVdWJHVnVaM1JvS1RzZ2JHVnVaM1JvSUQ0Z2FXNWtaWGc3SUdsdVpHVjRLeXNwZTF4dUlDQWdJSEpsYzNWc2RDQTlJR1Z1ZEhKcFpYTWdQeUJtS0dGdVQySnFaV04wS0hOMFpYQWdQU0JwZEdWeVlXSnNaVnRwYm1SbGVGMHBXekJkTENCemRHVndXekZkS1NBNklHWW9hWFJsY21GaWJHVmJhVzVrWlhoZEtUdGNiaUFnSUNCcFppaHlaWE4xYkhRZ1BUMDlJRUpTUlVGTElIeDhJSEpsYzNWc2RDQTlQVDBnVWtWVVZWSk9LWEpsZEhWeWJpQnlaWE4xYkhRN1hHNGdJSDBnWld4elpTQm1iM0lvYVhSbGNtRjBiM0lnUFNCcGRHVnlSbTR1WTJGc2JDaHBkR1Z5WVdKc1pTazdJQ0VvYzNSbGNDQTlJR2wwWlhKaGRHOXlMbTVsZUhRb0tTa3VaRzl1WlRzZ0tYdGNiaUFnSUNCeVpYTjFiSFFnUFNCallXeHNLR2wwWlhKaGRHOXlMQ0JtTENCemRHVndMblpoYkhWbExDQmxiblJ5YVdWektUdGNiaUFnSUNCcFppaHlaWE4xYkhRZ1BUMDlJRUpTUlVGTElIeDhJSEpsYzNWc2RDQTlQVDBnVWtWVVZWSk9LWEpsZEhWeWJpQnlaWE4xYkhRN1hHNGdJSDFjYm4wN1hHNWxlSEJ2Y25SekxrSlNSVUZMSUNBOUlFSlNSVUZMTzF4dVpYaHdiM0owY3k1U1JWUlZVazRnUFNCU1JWUlZVazQ3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOW1iM0l0YjJZdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEZzNYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElEUWdOU0lzSWk4dklHWmhjM1FnWVhCd2JIa3NJR2gwZEhBNkx5OXFjM0JsY21ZdWJHNXJhWFF1WTI5dEwyWmhjM1F0WVhCd2JIa3ZOVnh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWhtYml3Z1lYSm5jeXdnZEdoaGRDbDdYRzRnSUhaaGNpQjFiaUE5SUhSb1lYUWdQVDA5SUhWdVpHVm1hVzVsWkR0Y2JpQWdjM2RwZEdOb0tHRnlaM011YkdWdVozUm9LWHRjYmlBZ0lDQmpZWE5sSURBNklISmxkSFZ5YmlCMWJpQS9JR1p1S0NsY2JpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0E2SUdadUxtTmhiR3dvZEdoaGRDazdYRzRnSUNBZ1kyRnpaU0F4T2lCeVpYUjFjbTRnZFc0Z1B5Qm1iaWhoY21keld6QmRLVnh1SUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lEb2dabTR1WTJGc2JDaDBhR0YwTENCaGNtZHpXekJkS1R0Y2JpQWdJQ0JqWVhObElESTZJSEpsZEhWeWJpQjFiaUEvSUdadUtHRnlaM05iTUYwc0lHRnlaM05iTVYwcFhHNGdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnT2lCbWJpNWpZV3hzS0hSb1lYUXNJR0Z5WjNOYk1GMHNJR0Z5WjNOYk1WMHBPMXh1SUNBZ0lHTmhjMlVnTXpvZ2NtVjBkWEp1SUhWdUlEOGdabTRvWVhKbmMxc3dYU3dnWVhKbmMxc3hYU3dnWVhKbmMxc3lYU2xjYmlBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQTZJR1p1TG1OaGJHd29kR2hoZEN3Z1lYSm5jMXN3WFN3Z1lYSm5jMXN4WFN3Z1lYSm5jMXN5WFNrN1hHNGdJQ0FnWTJGelpTQTBPaUJ5WlhSMWNtNGdkVzRnUHlCbWJpaGhjbWR6V3pCZExDQmhjbWR6V3pGZExDQmhjbWR6V3pKZExDQmhjbWR6V3pOZEtWeHVJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSURvZ1ptNHVZMkZzYkNoMGFHRjBMQ0JoY21keld6QmRMQ0JoY21keld6RmRMQ0JoY21keld6SmRMQ0JoY21keld6TmRLVHRjYmlBZ2ZTQnlaWFIxY200Z0lDQWdJQ0FnSUNBZ0lDQWdJR1p1TG1Gd2NHeDVLSFJvWVhRc0lHRnlaM01wTzF4dWZUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WDJsdWRtOXJaUzVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnT0RoY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTkNBMUlpd2lMeThnWTJobFkyc2diMjRnWkdWbVlYVnNkQ0JCY25KaGVTQnBkR1Z5WVhSdmNseHVkbUZ5SUVsMFpYSmhkRzl5Y3lBZ1BTQnlaWEYxYVhKbEtDY3VMMTlwZEdWeVlYUnZjbk1uS1Z4dUlDQXNJRWxVUlZKQlZFOVNJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOTNhM01uS1NnbmFYUmxjbUYwYjNJbktWeHVJQ0FzSUVGeWNtRjVVSEp2ZEc4Z1BTQkJjbkpoZVM1d2NtOTBiM1I1Y0dVN1hHNWNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9hWFFwZTF4dUlDQnlaWFIxY200Z2FYUWdJVDA5SUhWdVpHVm1hVzVsWkNBbUppQW9TWFJsY21GMGIzSnpMa0Z5Y21GNUlEMDlQU0JwZENCOGZDQkJjbkpoZVZCeWIzUnZXMGxVUlZKQlZFOVNYU0E5UFQwZ2FYUXBPMXh1ZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMmx6TFdGeWNtRjVMV2wwWlhJdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEZzVYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElEUWdOU0lzSWk4dklEY3VNaTR5SUVselFYSnlZWGtvWVhKbmRXMWxiblFwWEc1MllYSWdZMjltSUQwZ2NtVnhkV2x5WlNnbkxpOWZZMjltSnlrN1hHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlFRnljbUY1TG1selFYSnlZWGtnZkh3Z1puVnVZM1JwYjI0Z2FYTkJjbkpoZVNoaGNtY3BlMXh1SUNCeVpYUjFjbTRnWTI5bUtHRnlaeWtnUFQwZ0owRnljbUY1Snp0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDE5cGN5MWhjbkpoZVM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ09UQmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJaXdpTHk4Z1kyRnNiQ0J6YjIxbGRHaHBibWNnYjI0Z2FYUmxjbUYwYjNJZ2MzUmxjQ0IzYVhSb0lITmhabVVnWTJ4dmMybHVaeUJ2YmlCbGNuSnZjbHh1ZG1GeUlHRnVUMkpxWldOMElEMGdjbVZ4ZFdseVpTZ25MaTlmWVc0dGIySnFaV04wSnlrN1hHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHbDBaWEpoZEc5eUxDQm1iaXdnZG1Gc2RXVXNJR1Z1ZEhKcFpYTXBlMXh1SUNCMGNua2dlMXh1SUNBZ0lISmxkSFZ5YmlCbGJuUnlhV1Z6SUQ4Z1ptNG9ZVzVQWW1wbFkzUW9kbUZzZFdVcFd6QmRMQ0IyWVd4MVpWc3hYU2tnT2lCbWJpaDJZV3gxWlNrN1hHNGdJQzh2SURjdU5DNDJJRWwwWlhKaGRHOXlRMnh2YzJVb2FYUmxjbUYwYjNJc0lHTnZiWEJzWlhScGIyNHBYRzRnSUgwZ1kyRjBZMmdvWlNsN1hHNGdJQ0FnZG1GeUlISmxkQ0E5SUdsMFpYSmhkRzl5V3lkeVpYUjFjbTRuWFR0Y2JpQWdJQ0JwWmloeVpYUWdJVDA5SUhWdVpHVm1hVzVsWkNsaGJrOWlhbVZqZENoeVpYUXVZMkZzYkNocGRHVnlZWFJ2Y2lrcE8xeHVJQ0FnSUhSb2NtOTNJR1U3WEc0Z0lIMWNibjA3WEc1Y2JseHVMeTh2THk4dkx5OHZMeTh2THk4dkx5OHZYRzR2THlCWFJVSlFRVU5MSUVaUFQxUkZVbHh1THk4Z0xpOStMMk52Y21VdGFuTXZiR2xpY21GeWVTOXRiMlIxYkdWekwxOXBkR1Z5TFdOaGJHd3Vhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRGt4WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRFFnTlNJc0luWmhjaUJKVkVWU1FWUlBVaUFnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTkzYTNNbktTZ25hWFJsY21GMGIzSW5LVnh1SUNBc0lGTkJSa1ZmUTB4UFUwbE9SeUE5SUdaaGJITmxPMXh1WEc1MGNua2dlMXh1SUNCMllYSWdjbWwwWlhJZ1BTQmJOMTFiU1ZSRlVrRlVUMUpkS0NrN1hHNGdJSEpwZEdWeVd5ZHlaWFIxY200blhTQTlJR1oxYm1OMGFXOXVLQ2w3SUZOQlJrVmZRMHhQVTBsT1J5QTlJSFJ5ZFdVN0lIMDdYRzRnSUVGeWNtRjVMbVp5YjIwb2NtbDBaWElzSUdaMWJtTjBhVzl1S0NsN0lIUm9jbTkzSURJN0lIMHBPMXh1ZlNCallYUmphQ2hsS1hzZ0x5b2daVzF3ZEhrZ0tpOGdmVnh1WEc1dGIyUjFiR1V1Wlhod2IzSjBjeUE5SUdaMWJtTjBhVzl1S0dWNFpXTXNJSE5yYVhCRGJHOXphVzVuS1h0Y2JpQWdhV1lvSVhOcmFYQkRiRzl6YVc1bklDWW1JQ0ZUUVVaRlgwTk1UMU5KVGtjcGNtVjBkWEp1SUdaaGJITmxPMXh1SUNCMllYSWdjMkZtWlNBOUlHWmhiSE5sTzF4dUlDQjBjbmtnZTF4dUlDQWdJSFpoY2lCaGNuSWdJRDBnV3pkZFhHNGdJQ0FnSUNBc0lHbDBaWElnUFNCaGNuSmJTVlJGVWtGVVQxSmRLQ2s3WEc0Z0lDQWdhWFJsY2k1dVpYaDBJRDBnWm5WdVkzUnBiMjRvS1hzZ2NtVjBkWEp1SUh0a2IyNWxPaUJ6WVdabElEMGdkSEoxWlgwN0lIMDdYRzRnSUNBZ1lYSnlXMGxVUlZKQlZFOVNYU0E5SUdaMWJtTjBhVzl1S0NsN0lISmxkSFZ5YmlCcGRHVnlPeUI5TzF4dUlDQWdJR1Y0WldNb1lYSnlLVHRjYmlBZ2ZTQmpZWFJqYUNobEtYc2dMeW9nWlcxd2RIa2dLaThnZlZ4dUlDQnlaWFIxY200Z2MyRm1aVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTlwZEdWeUxXUmxkR1ZqZEM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ09USmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ05DQTFJaXdpZG1GeUlHZGxkRXRsZVhNZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzFyWlhsekp5bGNiaUFnTENCMGIwbFBZbXBsWTNRZ1BTQnlaWEYxYVhKbEtDY3VMMTkwYnkxcGIySnFaV04wSnlrN1hHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtHOWlhbVZqZEN3Z1pXd3BlMXh1SUNCMllYSWdUeUFnSUNBZ0lEMGdkRzlKVDJKcVpXTjBLRzlpYW1WamRDbGNiaUFnSUNBc0lHdGxlWE1nSUNBOUlHZGxkRXRsZVhNb1R5bGNiaUFnSUNBc0lHeGxibWQwYUNBOUlHdGxlWE11YkdWdVozUm9YRzRnSUNBZ0xDQnBibVJsZUNBZ1BTQXdYRzRnSUNBZ0xDQnJaWGs3WEc0Z0lIZG9hV3hsS0d4bGJtZDBhQ0ErSUdsdVpHVjRLV2xtS0U5YmEyVjVJRDBnYTJWNWMxdHBibVJsZUNzclhWMGdQVDA5SUdWc0tYSmxkSFZ5YmlCclpYazdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZhMlY1YjJZdWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlEa3pYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBeElESWdNeUlzSW5aaGNpQm5iRzlpWVd3Z0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5bmJHOWlZV3duS1Z4dUlDQXNJRzFoWTNKdmRHRnpheUE5SUhKbGNYVnBjbVVvSnk0dlgzUmhjMnNuS1M1elpYUmNiaUFnTENCUFluTmxjblpsY2lBZ1BTQm5iRzlpWVd3dVRYVjBZWFJwYjI1UFluTmxjblpsY2lCOGZDQm5iRzlpWVd3dVYyVmlTMmwwVFhWMFlYUnBiMjVQWW5ObGNuWmxjbHh1SUNBc0lIQnliMk5sYzNNZ0lDQTlJR2RzYjJKaGJDNXdjbTlqWlhOelhHNGdJQ3dnVUhKdmJXbHpaU0FnSUQwZ1oyeHZZbUZzTGxCeWIyMXBjMlZjYmlBZ0xDQnBjMDV2WkdVZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5amIyWW5LU2h3Y205alpYTnpLU0E5UFNBbmNISnZZMlZ6Y3ljN1hHNWNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdablZ1WTNScGIyNG9LWHRjYmlBZ2RtRnlJR2hsWVdRc0lHeGhjM1FzSUc1dmRHbG1lVHRjYmx4dUlDQjJZWElnWm14MWMyZ2dQU0JtZFc1amRHbHZiaWdwZTF4dUlDQWdJSFpoY2lCd1lYSmxiblFzSUdadU8xeHVJQ0FnSUdsbUtHbHpUbTlrWlNBbUppQW9jR0Z5Wlc1MElEMGdjSEp2WTJWemN5NWtiMjFoYVc0cEtYQmhjbVZ1ZEM1bGVHbDBLQ2s3WEc0Z0lDQWdkMmhwYkdVb2FHVmhaQ2w3WEc0Z0lDQWdJQ0JtYmlBZ0lEMGdhR1ZoWkM1bWJqdGNiaUFnSUNBZ0lHaGxZV1FnUFNCb1pXRmtMbTVsZUhRN1hHNGdJQ0FnSUNCMGNua2dlMXh1SUNBZ0lDQWdJQ0JtYmlncE8xeHVJQ0FnSUNBZ2ZTQmpZWFJqYUNobEtYdGNiaUFnSUNBZ0lDQWdhV1lvYUdWaFpDbHViM1JwWm5rb0tUdGNiaUFnSUNBZ0lDQWdaV3h6WlNCc1lYTjBJRDBnZFc1a1pXWnBibVZrTzF4dUlDQWdJQ0FnSUNCMGFISnZkeUJsTzF4dUlDQWdJQ0FnZlZ4dUlDQWdJSDBnYkdGemRDQTlJSFZ1WkdWbWFXNWxaRHRjYmlBZ0lDQnBaaWh3WVhKbGJuUXBjR0Z5Wlc1MExtVnVkR1Z5S0NrN1hHNGdJSDA3WEc1Y2JpQWdMeThnVG05a1pTNXFjMXh1SUNCcFppaHBjMDV2WkdVcGUxeHVJQ0FnSUc1dmRHbG1lU0E5SUdaMWJtTjBhVzl1S0NsN1hHNGdJQ0FnSUNCd2NtOWpaWE56TG01bGVIUlVhV05yS0dac2RYTm9LVHRjYmlBZ0lDQjlPMXh1SUNBdkx5QmljbTkzYzJWeWN5QjNhWFJvSUUxMWRHRjBhVzl1VDJKelpYSjJaWEpjYmlBZ2ZTQmxiSE5sSUdsbUtFOWljMlZ5ZG1WeUtYdGNiaUFnSUNCMllYSWdkRzluWjJ4bElEMGdkSEoxWlZ4dUlDQWdJQ0FnTENCdWIyUmxJQ0FnUFNCa2IyTjFiV1Z1ZEM1amNtVmhkR1ZVWlhoMFRtOWtaU2duSnlrN1hHNGdJQ0FnYm1WM0lFOWljMlZ5ZG1WeUtHWnNkWE5vS1M1dlluTmxjblpsS0c1dlpHVXNJSHRqYUdGeVlXTjBaWEpFWVhSaE9pQjBjblZsZlNrN0lDOHZJR1Z6YkdsdWRDMWthWE5oWW14bExXeHBibVVnYm04dGJtVjNYRzRnSUNBZ2JtOTBhV1o1SUQwZ1puVnVZM1JwYjI0b0tYdGNiaUFnSUNBZ0lHNXZaR1V1WkdGMFlTQTlJSFJ2WjJkc1pTQTlJQ0YwYjJkbmJHVTdYRzRnSUNBZ2ZUdGNiaUFnTHk4Z1pXNTJhWEp2Ym0xbGJuUnpJSGRwZEdnZ2JXRjVZbVVnYm05dUxXTnZiWEJzWlhSbGJIa2dZMjl5Y21WamRDd2dZblYwSUdWNGFYTjBaVzUwSUZCeWIyMXBjMlZjYmlBZ2ZTQmxiSE5sSUdsbUtGQnliMjFwYzJVZ0ppWWdVSEp2YldselpTNXlaWE52YkhabEtYdGNiaUFnSUNCMllYSWdjSEp2YldselpTQTlJRkJ5YjIxcGMyVXVjbVZ6YjJ4MlpTZ3BPMXh1SUNBZ0lHNXZkR2xtZVNBOUlHWjFibU4wYVc5dUtDbDdYRzRnSUNBZ0lDQndjbTl0YVhObExuUm9aVzRvWm14MWMyZ3BPMXh1SUNBZ0lIMDdYRzRnSUM4dklHWnZjaUJ2ZEdobGNpQmxiblpwY205dWJXVnVkSE1nTFNCdFlXTnliM1JoYzJzZ1ltRnpaV1FnYjI0NlhHNGdJQzh2SUMwZ2MyVjBTVzF0WldScFlYUmxYRzRnSUM4dklDMGdUV1Z6YzJGblpVTm9ZVzV1Wld4Y2JpQWdMeThnTFNCM2FXNWtiM2N1Y0c5emRFMWxjM05oWjF4dUlDQXZMeUF0SUc5dWNtVmhaSGx6ZEdGMFpXTm9ZVzVuWlZ4dUlDQXZMeUF0SUhObGRGUnBiV1Z2ZFhSY2JpQWdmU0JsYkhObElIdGNiaUFnSUNCdWIzUnBabmtnUFNCbWRXNWpkR2x2YmlncGUxeHVJQ0FnSUNBZ0x5OGdjM1J5WVc1blpTQkpSU0FySUhkbFluQmhZMnNnWkdWMklITmxjblpsY2lCaWRXY2dMU0IxYzJVZ0xtTmhiR3dvWjJ4dlltRnNLVnh1SUNBZ0lDQWdiV0ZqY205MFlYTnJMbU5oYkd3b1oyeHZZbUZzTENCbWJIVnphQ2s3WEc0Z0lDQWdmVHRjYmlBZ2ZWeHVYRzRnSUhKbGRIVnliaUJtZFc1amRHbHZiaWhtYmlsN1hHNGdJQ0FnZG1GeUlIUmhjMnNnUFNCN1ptNDZJR1p1TENCdVpYaDBPaUIxYm1SbFptbHVaV1I5TzF4dUlDQWdJR2xtS0d4aGMzUXBiR0Z6ZEM1dVpYaDBJRDBnZEdGemF6dGNiaUFnSUNCcFppZ2hhR1ZoWkNsN1hHNGdJQ0FnSUNCb1pXRmtJRDBnZEdGemF6dGNiaUFnSUNBZ0lHNXZkR2xtZVNncE8xeHVJQ0FnSUgwZ2JHRnpkQ0E5SUhSaGMyczdYRzRnSUgwN1hHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5ZmJXbGpjbTkwWVhOckxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTVORnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQTBJRFVpTENJdkx5Qm1ZV3hzWW1GamF5Qm1iM0lnU1VVeE1TQmlkV2RuZVNCUFltcGxZM1F1WjJWMFQzZHVVSEp2Y0dWeWRIbE9ZVzFsY3lCM2FYUm9JR2xtY21GdFpTQmhibVFnZDJsdVpHOTNYRzUyWVhJZ2RHOUpUMkpxWldOMElEMGdjbVZ4ZFdseVpTZ25MaTlmZEc4dGFXOWlhbVZqZENjcFhHNGdJQ3dnWjA5UVRpQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXZHZjRzRuS1M1bVhHNGdJQ3dnZEc5VGRISnBibWNnSUQwZ2UzMHVkRzlUZEhKcGJtYzdYRzVjYm5aaGNpQjNhVzVrYjNkT1lXMWxjeUE5SUhSNWNHVnZaaUIzYVc1a2IzY2dQVDBnSjI5aWFtVmpkQ2NnSmlZZ2QybHVaRzkzSUNZbUlFOWlhbVZqZEM1blpYUlBkMjVRY205d1pYSjBlVTVoYldWelhHNGdJRDhnVDJKcVpXTjBMbWRsZEU5M2JsQnliM0JsY25SNVRtRnRaWE1vZDJsdVpHOTNLU0E2SUZ0ZE8xeHVYRzUyWVhJZ1oyVjBWMmx1Wkc5M1RtRnRaWE1nUFNCbWRXNWpkR2x2YmlocGRDbDdYRzRnSUhSeWVTQjdYRzRnSUNBZ2NtVjBkWEp1SUdkUFVFNG9hWFFwTzF4dUlDQjlJR05oZEdOb0tHVXBlMXh1SUNBZ0lISmxkSFZ5YmlCM2FXNWtiM2RPWVcxbGN5NXpiR2xqWlNncE8xeHVJQ0I5WEc1OU8xeHVYRzV0YjJSMWJHVXVaWGh3YjNKMGN5NW1JRDBnWm5WdVkzUnBiMjRnWjJWMFQzZHVVSEp2Y0dWeWRIbE9ZVzFsY3locGRDbDdYRzRnSUhKbGRIVnliaUIzYVc1a2IzZE9ZVzFsY3lBbUppQjBiMU4wY21sdVp5NWpZV3hzS0dsMEtTQTlQU0FuVzI5aWFtVmpkQ0JYYVc1a2IzZGRKeUEvSUdkbGRGZHBibVJ2ZDA1aGJXVnpLR2wwS1NBNklHZFBVRTRvZEc5SlQySnFaV04wS0dsMEtTazdYRzU5TzF4dVhHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl2WW1wbFkzUXRaMjl3YmkxbGVIUXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJRGsxWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRElnTXlJc0luWmhjaUJvYVdSbElEMGdjbVZ4ZFdseVpTZ25MaTlmYUdsa1pTY3BPMXh1Ylc5a2RXeGxMbVY0Y0c5eWRITWdQU0JtZFc1amRHbHZiaWgwWVhKblpYUXNJSE55WXl3Z2MyRm1aU2w3WEc0Z0lHWnZjaWgyWVhJZ2EyVjVJR2x1SUhOeVl5bDdYRzRnSUNBZ2FXWW9jMkZtWlNBbUppQjBZWEpuWlhSYmEyVjVYU2wwWVhKblpYUmJhMlY1WFNBOUlITnlZMXRyWlhsZE8xeHVJQ0FnSUdWc2MyVWdhR2xrWlNoMFlYSm5aWFFzSUd0bGVTd2djM0pqVzJ0bGVWMHBPMXh1SUNCOUlISmxkSFZ5YmlCMFlYSm5aWFE3WEc1OU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlmY21Wa1pXWnBibVV0WVd4c0xtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQTVObHh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBZ01TQTBJRFVpTENJdkx5QlhiM0pyY3lCM2FYUm9JRjlmY0hKdmRHOWZYeUJ2Ym14NUxpQlBiR1FnZGpnZ1kyRnVKM1FnZDI5eWF5QjNhWFJvSUc1MWJHd2djSEp2ZEc4Z2IySnFaV04wY3k1Y2JpOHFJR1Z6YkdsdWRDMWthWE5oWW14bElHNXZMWEJ5YjNSdklDb3ZYRzUyWVhJZ2FYTlBZbXBsWTNRZ1BTQnlaWEYxYVhKbEtDY3VMMTlwY3kxdlltcGxZM1FuS1Z4dUlDQXNJR0Z1VDJKcVpXTjBJRDBnY21WeGRXbHlaU2duTGk5ZllXNHRiMkpxWldOMEp5azdYRzUyWVhJZ1kyaGxZMnNnUFNCbWRXNWpkR2x2YmloUExDQndjbTkwYnlsN1hHNGdJR0Z1VDJKcVpXTjBLRThwTzF4dUlDQnBaaWdoYVhOUFltcGxZM1FvY0hKdmRHOHBJQ1ltSUhCeWIzUnZJQ0U5UFNCdWRXeHNLWFJvY205M0lGUjVjR1ZGY25KdmNpaHdjbTkwYnlBcklGd2lPaUJqWVc0bmRDQnpaWFFnWVhNZ2NISnZkRzkwZVhCbElWd2lLVHRjYm4wN1hHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlIdGNiaUFnYzJWME9pQlBZbXBsWTNRdWMyVjBVSEp2ZEc5MGVYQmxUMllnZkh3Z0tDZGZYM0J5YjNSdlgxOG5JR2x1SUh0OUlEOGdMeThnWlhOc2FXNTBMV1JwYzJGaWJHVXRiR2x1WlZ4dUlDQWdJR1oxYm1OMGFXOXVLSFJsYzNRc0lHSjFaMmQ1TENCelpYUXBlMXh1SUNBZ0lDQWdkSEo1SUh0Y2JpQWdJQ0FnSUNBZ2MyVjBJRDBnY21WeGRXbHlaU2duTGk5ZlkzUjRKeWtvUm5WdVkzUnBiMjR1WTJGc2JDd2djbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMV2R2Y0dRbktTNW1LRTlpYW1WamRDNXdjbTkwYjNSNWNHVXNJQ2RmWDNCeWIzUnZYMThuS1M1elpYUXNJRElwTzF4dUlDQWdJQ0FnSUNCelpYUW9kR1Z6ZEN3Z1cxMHBPMXh1SUNBZ0lDQWdJQ0JpZFdkbmVTQTlJQ0VvZEdWemRDQnBibk4wWVc1alpXOW1JRUZ5Y21GNUtUdGNiaUFnSUNBZ0lIMGdZMkYwWTJnb1pTbDdJR0oxWjJkNUlEMGdkSEoxWlRzZ2ZWeHVJQ0FnSUNBZ2NtVjBkWEp1SUdaMWJtTjBhVzl1SUhObGRGQnliM1J2ZEhsd1pVOW1LRThzSUhCeWIzUnZLWHRjYmlBZ0lDQWdJQ0FnWTJobFkyc29UeXdnY0hKdmRHOHBPMXh1SUNBZ0lDQWdJQ0JwWmloaWRXZG5lU2xQTGw5ZmNISnZkRzlmWHlBOUlIQnliM1J2TzF4dUlDQWdJQ0FnSUNCbGJITmxJSE5sZENoUExDQndjbTkwYnlrN1hHNGdJQ0FnSUNBZ0lISmxkSFZ5YmlCUE8xeHVJQ0FnSUNBZ2ZUdGNiaUFnSUNCOUtIdDlMQ0JtWVd4elpTa2dPaUIxYm1SbFptbHVaV1FwTEZ4dUlDQmphR1ZqYXpvZ1kyaGxZMnRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl6WlhRdGNISnZkRzh1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURrM1hHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015SXNJaWQxYzJVZ2MzUnlhV04wSnp0Y2JuWmhjaUJuYkc5aVlXd2dJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMmRzYjJKaGJDY3BYRzRnSUN3Z1kyOXlaU0FnSUNBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5amIzSmxKeWxjYmlBZ0xDQmtVQ0FnSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxa2NDY3BYRzRnSUN3Z1JFVlRRMUpKVUZSUFVsTWdQU0J5WlhGMWFYSmxLQ2N1TDE5a1pYTmpjbWx3ZEc5eWN5Y3BYRzRnSUN3Z1UxQkZRMGxGVXlBZ0lDQWdQU0J5WlhGMWFYSmxLQ2N1TDE5M2EzTW5LU2duYzNCbFkybGxjeWNwTzF4dVhHNXRiMlIxYkdVdVpYaHdiM0owY3lBOUlHWjFibU4wYVc5dUtFdEZXU2w3WEc0Z0lIWmhjaUJESUQwZ2RIbHdaVzltSUdOdmNtVmJTMFZaWFNBOVBTQW5ablZ1WTNScGIyNG5JRDhnWTI5eVpWdExSVmxkSURvZ1oyeHZZbUZzVzB0RldWMDdYRzRnSUdsbUtFUkZVME5TU1ZCVVQxSlRJQ1ltSUVNZ0ppWWdJVU5iVTFCRlEwbEZVMTBwWkZBdVppaERMQ0JUVUVWRFNVVlRMQ0I3WEc0Z0lDQWdZMjl1Wm1sbmRYSmhZbXhsT2lCMGNuVmxMRnh1SUNBZ0lHZGxkRG9nWm5WdVkzUnBiMjRvS1hzZ2NtVjBkWEp1SUhSb2FYTTdJSDFjYmlBZ2ZTazdYRzU5TzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWZjMlYwTFhOd1pXTnBaWE11YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURrNFhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURRZ05TSXNJaTh2SURjdU15NHlNQ0JUY0dWamFXVnpRMjl1YzNSeWRXTjBiM0lvVHl3Z1pHVm1ZWFZzZEVOdmJuTjBjblZqZEc5eUtWeHVkbUZ5SUdGdVQySnFaV04wSUNBOUlISmxjWFZwY21Vb0p5NHZYMkZ1TFc5aWFtVmpkQ2NwWEc0Z0lDd2dZVVoxYm1OMGFXOXVJRDBnY21WeGRXbHlaU2duTGk5ZllTMW1kVzVqZEdsdmJpY3BYRzRnSUN3Z1UxQkZRMGxGVXlBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZDJ0ekp5a29KM053WldOcFpYTW5LVHRjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnWm5WdVkzUnBiMjRvVHl3Z1JDbDdYRzRnSUhaaGNpQkRJRDBnWVc1UFltcGxZM1FvVHlrdVkyOXVjM1J5ZFdOMGIzSXNJRk03WEc0Z0lISmxkSFZ5YmlCRElEMDlQU0IxYm1SbFptbHVaV1FnZkh3Z0tGTWdQU0JoYms5aWFtVmpkQ2hES1Z0VFVFVkRTVVZUWFNrZ1BUMGdkVzVrWldacGJtVmtJRDhnUkNBNklHRkdkVzVqZEdsdmJpaFRLVHRjYm4wN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMTl6Y0dWamFXVnpMV052Ym5OMGNuVmpkRzl5TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBNU9WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBMElEVWlMQ0oyWVhJZ0pHVjRjRzl5ZENBOUlISmxjWFZwY21Vb0p5NHZYMlY0Y0c5eWRDY3BYRzR2THlBeE9TNHhMakl1TWlBdklERTFMakl1TXk0MUlFOWlhbVZqZEM1amNtVmhkR1VvVHlCYkxDQlFjbTl3WlhKMGFXVnpYU2xjYmlSbGVIQnZjblFvSkdWNGNHOXlkQzVUTENBblQySnFaV04wSnl3Z2UyTnlaV0YwWlRvZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXTnlaV0YwWlNjcGZTazdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5dGIyUjFiR1Z6TDJWek5pNXZZbXBsWTNRdVkzSmxZWFJsTG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeE1EQmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SURFZ01pQXpJaXdpTHk4Z01Ua3VNUzR5TGprZ1QySnFaV04wTG1kbGRGQnliM1J2ZEhsd1pVOW1LRThwWEc1MllYSWdkRzlQWW1wbFkzUWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZEc4dGIySnFaV04wSnlsY2JpQWdMQ0FrWjJWMFVISnZkRzkwZVhCbFQyWWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0WjNCdkp5azdYRzVjYm5KbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxellYQW5LU2duWjJWMFVISnZkRzkwZVhCbFQyWW5MQ0JtZFc1amRHbHZiaWdwZTF4dUlDQnlaWFIxY200Z1puVnVZM1JwYjI0Z1oyVjBVSEp2ZEc5MGVYQmxUMllvYVhRcGUxeHVJQ0FnSUhKbGRIVnliaUFrWjJWMFVISnZkRzkwZVhCbFQyWW9kRzlQWW1wbFkzUW9hWFFwS1R0Y2JpQWdmVHRjYm4wcE8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5amIzSmxMV3B6TDJ4cFluSmhjbmt2Ylc5a2RXeGxjeTlsY3pZdWIySnFaV04wTG1kbGRDMXdjbTkwYjNSNWNHVXRiMll1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURFd01WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFnTVNBeUlETWlMQ0l2THlBeE9TNHhMakl1TVRRZ1QySnFaV04wTG10bGVYTW9UeWxjYm5aaGNpQjBiMDlpYW1WamRDQTlJSEpsY1hWcGNtVW9KeTR2WDNSdkxXOWlhbVZqZENjcFhHNGdJQ3dnSkd0bGVYTWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXZZbXBsWTNRdGEyVjVjeWNwTzF4dVhHNXlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRjMkZ3Snlrb0oydGxlWE1uTENCbWRXNWpkR2x2YmlncGUxeHVJQ0J5WlhSMWNtNGdablZ1WTNScGIyNGdhMlY1Y3locGRDbDdYRzRnSUNBZ2NtVjBkWEp1SUNSclpYbHpLSFJ2VDJKcVpXTjBLR2wwS1NrN1hHNGdJSDA3WEc1OUtUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNMkxtOWlhbVZqZEM1clpYbHpMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F4TURKY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJRElnTkNBMUlpd2lMeThnTVRrdU1TNHpMakU1SUU5aWFtVmpkQzV6WlhSUWNtOTBiM1I1Y0dWUFppaFBMQ0J3Y205MGJ5bGNiblpoY2lBa1pYaHdiM0owSUQwZ2NtVnhkV2x5WlNnbkxpOWZaWGh3YjNKMEp5azdYRzRrWlhod2IzSjBLQ1JsZUhCdmNuUXVVeXdnSjA5aWFtVmpkQ2NzSUh0elpYUlFjbTkwYjNSNWNHVlBaam9nY21WeGRXbHlaU2duTGk5ZmMyVjBMWEJ5YjNSdkp5a3VjMlYwZlNrN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMlZ6Tmk1dlltcGxZM1F1YzJWMExYQnliM1J2ZEhsd1pTMXZaaTVxYzF4dUx5OGdiVzlrZFd4bElHbGtJRDBnTVRBelhHNHZMeUJ0YjJSMWJHVWdZMmgxYm10eklEMGdNQ0F4SURJZ015SXNJaWQxYzJVZ2MzUnlhV04wSnp0Y2JuWmhjaUJNU1VKU1FWSlpJQ0FnSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXNhV0p5WVhKNUp5bGNiaUFnTENCbmJHOWlZV3dnSUNBZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTluYkc5aVlXd25LVnh1SUNBc0lHTjBlQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJOMGVDY3BYRzRnSUN3Z1kyeGhjM052WmlBZ0lDQWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmWTJ4aGMzTnZaaWNwWEc0Z0lDd2dKR1Y0Y0c5eWRDQWdJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZlpYaHdiM0owSnlsY2JpQWdMQ0JwYzA5aWFtVmpkQ0FnSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXBjeTF2WW1wbFkzUW5LVnh1SUNBc0lHRkdkVzVqZEdsdmJpQWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJFdFpuVnVZM1JwYjI0bktWeHVJQ0FzSUdGdVNXNXpkR0Z1WTJVZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMkZ1TFdsdWMzUmhibU5sSnlsY2JpQWdMQ0JtYjNKUFppQWdJQ0FnSUNBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOW1iM0l0YjJZbktWeHVJQ0FzSUhOd1pXTnBaWE5EYjI1emRISjFZM1J2Y2lBOUlISmxjWFZwY21Vb0p5NHZYM053WldOcFpYTXRZMjl1YzNSeWRXTjBiM0luS1Z4dUlDQXNJSFJoYzJzZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzUmhjMnNuS1M1elpYUmNiaUFnTENCdGFXTnliM1JoYzJzZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTl0YVdOeWIzUmhjMnNuS1NncFhHNGdJQ3dnVUZKUFRVbFRSU0FnSUNBZ0lDQWdJQ0FnSUQwZ0oxQnliMjFwYzJVblhHNGdJQ3dnVkhsd1pVVnljbTl5SUNBZ0lDQWdJQ0FnSUQwZ1oyeHZZbUZzTGxSNWNHVkZjbkp2Y2x4dUlDQXNJSEJ5YjJObGMzTWdJQ0FnSUNBZ0lDQWdJQ0E5SUdkc2IySmhiQzV3Y205alpYTnpYRzRnSUN3Z0pGQnliMjFwYzJVZ0lDQWdJQ0FnSUNBZ0lEMGdaMnh2WW1Gc1cxQlNUMDFKVTBWZFhHNGdJQ3dnY0hKdlkyVnpjeUFnSUNBZ0lDQWdJQ0FnSUQwZ1oyeHZZbUZzTG5CeWIyTmxjM05jYmlBZ0xDQnBjMDV2WkdVZ0lDQWdJQ0FnSUNBZ0lDQWdQU0JqYkdGemMyOW1LSEJ5YjJObGMzTXBJRDA5SUNkd2NtOWpaWE56SjF4dUlDQXNJR1Z0Y0hSNUlDQWdJQ0FnSUNBZ0lDQWdJQ0E5SUdaMWJtTjBhVzl1S0NsN0lDOHFJR1Z0Y0hSNUlDb3ZJSDFjYmlBZ0xDQkpiblJsY201aGJDd2dSMlZ1WlhKcFkxQnliMjFwYzJWRFlYQmhZbWxzYVhSNUxDQlhjbUZ3Y0dWeU8xeHVYRzUyWVhJZ1ZWTkZYMDVCVkVsV1JTQTlJQ0VoWm5WdVkzUnBiMjRvS1h0Y2JpQWdkSEo1SUh0Y2JpQWdJQ0F2THlCamIzSnlaV04wSUhOMVltTnNZWE56YVc1bklIZHBkR2dnUUVCemNHVmphV1Z6SUhOMWNIQnZjblJjYmlBZ0lDQjJZWElnY0hKdmJXbHpaU0FnSUNBZ1BTQWtVSEp2YldselpTNXlaWE52YkhabEtERXBYRzRnSUNBZ0lDQXNJRVpoYTJWUWNtOXRhWE5sSUQwZ0tIQnliMjFwYzJVdVkyOXVjM1J5ZFdOMGIzSWdQU0I3ZlNsYmNtVnhkV2x5WlNnbkxpOWZkMnR6Snlrb0ozTndaV05wWlhNbktWMGdQU0JtZFc1amRHbHZiaWhsZUdWaktYc2daWGhsWXlobGJYQjBlU3dnWlcxd2RIa3BPeUI5TzF4dUlDQWdJQzh2SUhWdWFHRnVaR3hsWkNCeVpXcGxZM1JwYjI1eklIUnlZV05yYVc1bklITjFjSEJ2Y25Rc0lFNXZaR1ZLVXlCUWNtOXRhWE5sSUhkcGRHaHZkWFFnYVhRZ1ptRnBiSE1nUUVCemNHVmphV1Z6SUhSbGMzUmNiaUFnSUNCeVpYUjFjbTRnS0dselRtOWtaU0I4ZkNCMGVYQmxiMllnVUhKdmJXbHpaVkpsYW1WamRHbHZia1YyWlc1MElEMDlJQ2RtZFc1amRHbHZiaWNwSUNZbUlIQnliMjFwYzJVdWRHaGxiaWhsYlhCMGVTa2dhVzV6ZEdGdVkyVnZaaUJHWVd0bFVISnZiV2x6WlR0Y2JpQWdmU0JqWVhSamFDaGxLWHNnTHlvZ1pXMXdkSGtnS2k4Z2ZWeHVmU2dwTzF4dVhHNHZMeUJvWld4d1pYSnpYRzUyWVhJZ2MyRnRaVU52Ym5OMGNuVmpkRzl5SUQwZ1puVnVZM1JwYjI0b1lTd2dZaWw3WEc0Z0lDOHZJSGRwZEdnZ2JHbGljbUZ5ZVNCM2NtRndjR1Z5SUhOd1pXTnBZV3dnWTJGelpWeHVJQ0J5WlhSMWNtNGdZU0E5UFQwZ1lpQjhmQ0JoSUQwOVBTQWtVSEp2YldselpTQW1KaUJpSUQwOVBTQlhjbUZ3Y0dWeU8xeHVmVHRjYm5aaGNpQnBjMVJvWlc1aFlteGxJRDBnWm5WdVkzUnBiMjRvYVhRcGUxeHVJQ0IyWVhJZ2RHaGxianRjYmlBZ2NtVjBkWEp1SUdselQySnFaV04wS0dsMEtTQW1KaUIwZVhCbGIyWWdLSFJvWlc0Z1BTQnBkQzUwYUdWdUtTQTlQU0FuWm5WdVkzUnBiMjRuSUQ4Z2RHaGxiaUE2SUdaaGJITmxPMXh1ZlR0Y2JuWmhjaUJ1WlhkUWNtOXRhWE5sUTJGd1lXSnBiR2wwZVNBOUlHWjFibU4wYVc5dUtFTXBlMXh1SUNCeVpYUjFjbTRnYzJGdFpVTnZibk4wY25WamRHOXlLQ1JRY205dGFYTmxMQ0JES1Z4dUlDQWdJRDhnYm1WM0lGQnliMjFwYzJWRFlYQmhZbWxzYVhSNUtFTXBYRzRnSUNBZ09pQnVaWGNnUjJWdVpYSnBZMUJ5YjIxcGMyVkRZWEJoWW1sc2FYUjVLRU1wTzF4dWZUdGNiblpoY2lCUWNtOXRhWE5sUTJGd1lXSnBiR2wwZVNBOUlFZGxibVZ5YVdOUWNtOXRhWE5sUTJGd1lXSnBiR2wwZVNBOUlHWjFibU4wYVc5dUtFTXBlMXh1SUNCMllYSWdjbVZ6YjJ4MlpTd2djbVZxWldOME8xeHVJQ0IwYUdsekxuQnliMjFwYzJVZ1BTQnVaWGNnUXlobWRXNWpkR2x2Ymlna0pISmxjMjlzZG1Vc0lDUWtjbVZxWldOMEtYdGNiaUFnSUNCcFppaHlaWE52YkhabElDRTlQU0IxYm1SbFptbHVaV1FnZkh3Z2NtVnFaV04wSUNFOVBTQjFibVJsWm1sdVpXUXBkR2h5YjNjZ1ZIbHdaVVZ5Y205eUtDZENZV1FnVUhKdmJXbHpaU0JqYjI1emRISjFZM1J2Y2ljcE8xeHVJQ0FnSUhKbGMyOXNkbVVnUFNBa0pISmxjMjlzZG1VN1hHNGdJQ0FnY21WcVpXTjBJQ0E5SUNRa2NtVnFaV04wTzF4dUlDQjlLVHRjYmlBZ2RHaHBjeTV5WlhOdmJIWmxJRDBnWVVaMWJtTjBhVzl1S0hKbGMyOXNkbVVwTzF4dUlDQjBhR2x6TG5KbGFtVmpkQ0FnUFNCaFJuVnVZM1JwYjI0b2NtVnFaV04wS1R0Y2JuMDdYRzUyWVhJZ2NHVnlabTl5YlNBOUlHWjFibU4wYVc5dUtHVjRaV01wZTF4dUlDQjBjbmtnZTF4dUlDQWdJR1Y0WldNb0tUdGNiaUFnZlNCallYUmphQ2hsS1h0Y2JpQWdJQ0J5WlhSMWNtNGdlMlZ5Y205eU9pQmxmVHRjYmlBZ2ZWeHVmVHRjYm5aaGNpQnViM1JwWm5rZ1BTQm1kVzVqZEdsdmJpaHdjbTl0YVhObExDQnBjMUpsYW1WamRDbDdYRzRnSUdsbUtIQnliMjFwYzJVdVgyNHBjbVYwZFhKdU8xeHVJQ0J3Y205dGFYTmxMbDl1SUQwZ2RISjFaVHRjYmlBZ2RtRnlJR05vWVdsdUlEMGdjSEp2YldselpTNWZZenRjYmlBZ2JXbGpjbTkwWVhOcktHWjFibU4wYVc5dUtDbDdYRzRnSUNBZ2RtRnlJSFpoYkhWbElEMGdjSEp2YldselpTNWZkbHh1SUNBZ0lDQWdMQ0J2YXlBZ0lDQTlJSEJ5YjIxcGMyVXVYM01nUFQwZ01WeHVJQ0FnSUNBZ0xDQnBJQ0FnSUNBOUlEQTdYRzRnSUNBZ2RtRnlJSEoxYmlBOUlHWjFibU4wYVc5dUtISmxZV04wYVc5dUtYdGNiaUFnSUNBZ0lIWmhjaUJvWVc1a2JHVnlJRDBnYjJzZ1B5QnlaV0ZqZEdsdmJpNXZheUE2SUhKbFlXTjBhVzl1TG1aaGFXeGNiaUFnSUNBZ0lDQWdMQ0J5WlhOdmJIWmxJRDBnY21WaFkzUnBiMjR1Y21WemIyeDJaVnh1SUNBZ0lDQWdJQ0FzSUhKbGFtVmpkQ0FnUFNCeVpXRmpkR2x2Ymk1eVpXcGxZM1JjYmlBZ0lDQWdJQ0FnTENCa2IyMWhhVzRnSUQwZ2NtVmhZM1JwYjI0dVpHOXRZV2x1WEc0Z0lDQWdJQ0FnSUN3Z2NtVnpkV3gwTENCMGFHVnVPMXh1SUNBZ0lDQWdkSEo1SUh0Y2JpQWdJQ0FnSUNBZ2FXWW9hR0Z1Wkd4bGNpbDdYRzRnSUNBZ0lDQWdJQ0FnYVdZb0lXOXJLWHRjYmlBZ0lDQWdJQ0FnSUNBZ0lHbG1LSEJ5YjIxcGMyVXVYMmdnUFQwZ01pbHZia2hoYm1Sc1pWVnVhR0Z1Wkd4bFpDaHdjbTl0YVhObEtUdGNiaUFnSUNBZ0lDQWdJQ0FnSUhCeWIyMXBjMlV1WDJnZ1BTQXhPMXh1SUNBZ0lDQWdJQ0FnSUgxY2JpQWdJQ0FnSUNBZ0lDQnBaaWhvWVc1a2JHVnlJRDA5UFNCMGNuVmxLWEpsYzNWc2RDQTlJSFpoYkhWbE8xeHVJQ0FnSUNBZ0lDQWdJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ0lDQWdJQ0FnYVdZb1pHOXRZV2x1S1dSdmJXRnBiaTVsYm5SbGNpZ3BPMXh1SUNBZ0lDQWdJQ0FnSUNBZ2NtVnpkV3gwSUQwZ2FHRnVaR3hsY2loMllXeDFaU2s3WEc0Z0lDQWdJQ0FnSUNBZ0lDQnBaaWhrYjIxaGFXNHBaRzl0WVdsdUxtVjRhWFFvS1R0Y2JpQWdJQ0FnSUNBZ0lDQjlYRzRnSUNBZ0lDQWdJQ0FnYVdZb2NtVnpkV3gwSUQwOVBTQnlaV0ZqZEdsdmJpNXdjbTl0YVhObEtYdGNiaUFnSUNBZ0lDQWdJQ0FnSUhKbGFtVmpkQ2hVZVhCbFJYSnliM0lvSjFCeWIyMXBjMlV0WTJoaGFXNGdZM2xqYkdVbktTazdYRzRnSUNBZ0lDQWdJQ0FnZlNCbGJITmxJR2xtS0hSb1pXNGdQU0JwYzFSb1pXNWhZbXhsS0hKbGMzVnNkQ2twZTF4dUlDQWdJQ0FnSUNBZ0lDQWdkR2hsYmk1allXeHNLSEpsYzNWc2RDd2djbVZ6YjJ4MlpTd2djbVZxWldOMEtUdGNiaUFnSUNBZ0lDQWdJQ0I5SUdWc2MyVWdjbVZ6YjJ4MlpTaHlaWE4xYkhRcE8xeHVJQ0FnSUNBZ0lDQjlJR1ZzYzJVZ2NtVnFaV04wS0haaGJIVmxLVHRjYmlBZ0lDQWdJSDBnWTJGMFkyZ29aU2w3WEc0Z0lDQWdJQ0FnSUhKbGFtVmpkQ2hsS1R0Y2JpQWdJQ0FnSUgxY2JpQWdJQ0I5TzF4dUlDQWdJSGRvYVd4bEtHTm9ZV2x1TG14bGJtZDBhQ0ErSUdrcGNuVnVLR05vWVdsdVcya3JLMTBwT3lBdkx5QjJZWEpwWVdKc1pTQnNaVzVuZEdnZ0xTQmpZVzRuZENCMWMyVWdabTl5UldGamFGeHVJQ0FnSUhCeWIyMXBjMlV1WDJNZ1BTQmJYVHRjYmlBZ0lDQndjbTl0YVhObExsOXVJRDBnWm1Gc2MyVTdYRzRnSUNBZ2FXWW9hWE5TWldwbFkzUWdKaVlnSVhCeWIyMXBjMlV1WDJncGIyNVZibWhoYm1Sc1pXUW9jSEp2YldselpTazdYRzRnSUgwcE8xeHVmVHRjYm5aaGNpQnZibFZ1YUdGdVpHeGxaQ0E5SUdaMWJtTjBhVzl1S0hCeWIyMXBjMlVwZTF4dUlDQjBZWE5yTG1OaGJHd29aMnh2WW1Gc0xDQm1kVzVqZEdsdmJpZ3BlMXh1SUNBZ0lIWmhjaUIyWVd4MVpTQTlJSEJ5YjIxcGMyVXVYM1pjYmlBZ0lDQWdJQ3dnWVdKeWRYQjBMQ0JvWVc1a2JHVnlMQ0JqYjI1emIyeGxPMXh1SUNBZ0lHbG1LR2x6Vlc1b1lXNWtiR1ZrS0hCeWIyMXBjMlVwS1h0Y2JpQWdJQ0FnSUdGaWNuVndkQ0E5SUhCbGNtWnZjbTBvWm5WdVkzUnBiMjRvS1h0Y2JpQWdJQ0FnSUNBZ2FXWW9hWE5PYjJSbEtYdGNiaUFnSUNBZ0lDQWdJQ0J3Y205alpYTnpMbVZ0YVhRb0ozVnVhR0Z1Wkd4bFpGSmxhbVZqZEdsdmJpY3NJSFpoYkhWbExDQndjbTl0YVhObEtUdGNiaUFnSUNBZ0lDQWdmU0JsYkhObElHbG1LR2hoYm1Sc1pYSWdQU0JuYkc5aVlXd3ViMjUxYm1oaGJtUnNaV1J5WldwbFkzUnBiMjRwZTF4dUlDQWdJQ0FnSUNBZ0lHaGhibVJzWlhJb2UzQnliMjFwYzJVNklIQnliMjFwYzJVc0lISmxZWE52YmpvZ2RtRnNkV1Y5S1R0Y2JpQWdJQ0FnSUNBZ2ZTQmxiSE5sSUdsbUtDaGpiMjV6YjJ4bElEMGdaMnh2WW1Gc0xtTnZibk52YkdVcElDWW1JR052Ym5OdmJHVXVaWEp5YjNJcGUxeHVJQ0FnSUNBZ0lDQWdJR052Ym5OdmJHVXVaWEp5YjNJb0oxVnVhR0Z1Wkd4bFpDQndjbTl0YVhObElISmxhbVZqZEdsdmJpY3NJSFpoYkhWbEtUdGNiaUFnSUNBZ0lDQWdmVnh1SUNBZ0lDQWdmU2s3WEc0Z0lDQWdJQ0F2THlCQ2NtOTNjMlZ5Y3lCemFHOTFiR1FnYm05MElIUnlhV2RuWlhJZ1lISmxhbVZqZEdsdmJraGhibVJzWldSZ0lHVjJaVzUwSUdsbUlHbDBJSGRoY3lCb1lXNWtiR1ZrSUdobGNtVXNJRTV2WkdWS1V5QXRJSE5vYjNWc1pGeHVJQ0FnSUNBZ2NISnZiV2x6WlM1ZmFDQTlJR2x6VG05a1pTQjhmQ0JwYzFWdWFHRnVaR3hsWkNod2NtOXRhWE5sS1NBL0lESWdPaUF4TzF4dUlDQWdJSDBnY0hKdmJXbHpaUzVmWVNBOUlIVnVaR1ZtYVc1bFpEdGNiaUFnSUNCcFppaGhZbkoxY0hRcGRHaHliM2NnWVdKeWRYQjBMbVZ5Y205eU8xeHVJQ0I5S1R0Y2JuMDdYRzUyWVhJZ2FYTlZibWhoYm1Sc1pXUWdQU0JtZFc1amRHbHZiaWh3Y205dGFYTmxLWHRjYmlBZ2FXWW9jSEp2YldselpTNWZhQ0E5UFNBeEtYSmxkSFZ5YmlCbVlXeHpaVHRjYmlBZ2RtRnlJR05vWVdsdUlEMGdjSEp2YldselpTNWZZU0I4ZkNCd2NtOXRhWE5sTGw5alhHNGdJQ0FnTENCcElDQWdJQ0E5SURCY2JpQWdJQ0FzSUhKbFlXTjBhVzl1TzF4dUlDQjNhR2xzWlNoamFHRnBiaTVzWlc1bmRHZ2dQaUJwS1h0Y2JpQWdJQ0J5WldGamRHbHZiaUE5SUdOb1lXbHVXMmtySzEwN1hHNGdJQ0FnYVdZb2NtVmhZM1JwYjI0dVptRnBiQ0I4ZkNBaGFYTlZibWhoYm1Sc1pXUW9jbVZoWTNScGIyNHVjSEp2YldselpTa3BjbVYwZFhKdUlHWmhiSE5sTzF4dUlDQjlJSEpsZEhWeWJpQjBjblZsTzF4dWZUdGNiblpoY2lCdmJraGhibVJzWlZWdWFHRnVaR3hsWkNBOUlHWjFibU4wYVc5dUtIQnliMjFwYzJVcGUxeHVJQ0IwWVhOckxtTmhiR3dvWjJ4dlltRnNMQ0JtZFc1amRHbHZiaWdwZTF4dUlDQWdJSFpoY2lCb1lXNWtiR1Z5TzF4dUlDQWdJR2xtS0dselRtOWtaU2w3WEc0Z0lDQWdJQ0J3Y205alpYTnpMbVZ0YVhRb0ozSmxhbVZqZEdsdmJraGhibVJzWldRbkxDQndjbTl0YVhObEtUdGNiaUFnSUNCOUlHVnNjMlVnYVdZb2FHRnVaR3hsY2lBOUlHZHNiMkpoYkM1dmJuSmxhbVZqZEdsdmJtaGhibVJzWldRcGUxeHVJQ0FnSUNBZ2FHRnVaR3hsY2loN2NISnZiV2x6WlRvZ2NISnZiV2x6WlN3Z2NtVmhjMjl1T2lCd2NtOXRhWE5sTGw5MmZTazdYRzRnSUNBZ2ZWeHVJQ0I5S1R0Y2JuMDdYRzUyWVhJZ0pISmxhbVZqZENBOUlHWjFibU4wYVc5dUtIWmhiSFZsS1h0Y2JpQWdkbUZ5SUhCeWIyMXBjMlVnUFNCMGFHbHpPMXh1SUNCcFppaHdjbTl0YVhObExsOWtLWEpsZEhWeWJqdGNiaUFnY0hKdmJXbHpaUzVmWkNBOUlIUnlkV1U3WEc0Z0lIQnliMjFwYzJVZ1BTQndjbTl0YVhObExsOTNJSHg4SUhCeWIyMXBjMlU3SUM4dklIVnVkM0poY0Z4dUlDQndjbTl0YVhObExsOTJJRDBnZG1Gc2RXVTdYRzRnSUhCeWIyMXBjMlV1WDNNZ1BTQXlPMXh1SUNCcFppZ2hjSEp2YldselpTNWZZU2x3Y205dGFYTmxMbDloSUQwZ2NISnZiV2x6WlM1Zll5NXpiR2xqWlNncE8xeHVJQ0J1YjNScFpua29jSEp2YldselpTd2dkSEoxWlNrN1hHNTlPMXh1ZG1GeUlDUnlaWE52YkhabElEMGdablZ1WTNScGIyNG9kbUZzZFdVcGUxeHVJQ0IyWVhJZ2NISnZiV2x6WlNBOUlIUm9hWE5jYmlBZ0lDQXNJSFJvWlc0N1hHNGdJR2xtS0hCeWIyMXBjMlV1WDJRcGNtVjBkWEp1TzF4dUlDQndjbTl0YVhObExsOWtJRDBnZEhKMVpUdGNiaUFnY0hKdmJXbHpaU0E5SUhCeWIyMXBjMlV1WDNjZ2ZId2djSEp2YldselpUc2dMeThnZFc1M2NtRndYRzRnSUhSeWVTQjdYRzRnSUNBZ2FXWW9jSEp2YldselpTQTlQVDBnZG1Gc2RXVXBkR2h5YjNjZ1ZIbHdaVVZ5Y205eUtGd2lVSEp2YldselpTQmpZVzRuZENCaVpTQnlaWE52YkhabFpDQnBkSE5sYkdaY0lpazdYRzRnSUNBZ2FXWW9kR2hsYmlBOUlHbHpWR2hsYm1GaWJHVW9kbUZzZFdVcEtYdGNiaUFnSUNBZ0lHMXBZM0p2ZEdGemF5aG1kVzVqZEdsdmJpZ3BlMXh1SUNBZ0lDQWdJQ0IyWVhJZ2QzSmhjSEJsY2lBOUlIdGZkem9nY0hKdmJXbHpaU3dnWDJRNklHWmhiSE5sZlRzZ0x5OGdkM0poY0Z4dUlDQWdJQ0FnSUNCMGNua2dlMXh1SUNBZ0lDQWdJQ0FnSUhSb1pXNHVZMkZzYkNoMllXeDFaU3dnWTNSNEtDUnlaWE52YkhabExDQjNjbUZ3Y0dWeUxDQXhLU3dnWTNSNEtDUnlaV3BsWTNRc0lIZHlZWEJ3WlhJc0lERXBLVHRjYmlBZ0lDQWdJQ0FnZlNCallYUmphQ2hsS1h0Y2JpQWdJQ0FnSUNBZ0lDQWtjbVZxWldOMExtTmhiR3dvZDNKaGNIQmxjaXdnWlNrN1hHNGdJQ0FnSUNBZ0lIMWNiaUFnSUNBZ0lIMHBPMXh1SUNBZ0lIMGdaV3h6WlNCN1hHNGdJQ0FnSUNCd2NtOXRhWE5sTGw5MklEMGdkbUZzZFdVN1hHNGdJQ0FnSUNCd2NtOXRhWE5sTGw5eklEMGdNVHRjYmlBZ0lDQWdJRzV2ZEdsbWVTaHdjbTl0YVhObExDQm1ZV3h6WlNrN1hHNGdJQ0FnZlZ4dUlDQjlJR05oZEdOb0tHVXBlMXh1SUNBZ0lDUnlaV3BsWTNRdVkyRnNiQ2g3WDNjNklIQnliMjFwYzJVc0lGOWtPaUJtWVd4elpYMHNJR1VwT3lBdkx5QjNjbUZ3WEc0Z0lIMWNibjA3WEc1Y2JpOHZJR052Ym5OMGNuVmpkRzl5SUhCdmJIbG1hV3hzWEc1cFppZ2hWVk5GWDA1QlZFbFdSU2w3WEc0Z0lDOHZJREkxTGpRdU15NHhJRkJ5YjIxcGMyVW9aWGhsWTNWMGIzSXBYRzRnSUNSUWNtOXRhWE5sSUQwZ1puVnVZM1JwYjI0Z1VISnZiV2x6WlNobGVHVmpkWFJ2Y2lsN1hHNGdJQ0FnWVc1SmJuTjBZVzVqWlNoMGFHbHpMQ0FrVUhKdmJXbHpaU3dnVUZKUFRVbFRSU3dnSjE5b0p5azdYRzRnSUNBZ1lVWjFibU4wYVc5dUtHVjRaV04xZEc5eUtUdGNiaUFnSUNCSmJuUmxjbTVoYkM1allXeHNLSFJvYVhNcE8xeHVJQ0FnSUhSeWVTQjdYRzRnSUNBZ0lDQmxlR1ZqZFhSdmNpaGpkSGdvSkhKbGMyOXNkbVVzSUhSb2FYTXNJREVwTENCamRIZ29KSEpsYW1WamRDd2dkR2hwY3l3Z01Ta3BPMXh1SUNBZ0lIMGdZMkYwWTJnb1pYSnlLWHRjYmlBZ0lDQWdJQ1J5WldwbFkzUXVZMkZzYkNoMGFHbHpMQ0JsY25JcE8xeHVJQ0FnSUgxY2JpQWdmVHRjYmlBZ1NXNTBaWEp1WVd3Z1BTQm1kVzVqZEdsdmJpQlFjbTl0YVhObEtHVjRaV04xZEc5eUtYdGNiaUFnSUNCMGFHbHpMbDlqSUQwZ1cxMDdJQ0FnSUNBZ0lDQWdJQ0FnSUM4dklEd3RJR0YzWVdsMGFXNW5JSEpsWVdOMGFXOXVjMXh1SUNBZ0lIUm9hWE11WDJFZ1BTQjFibVJsWm1sdVpXUTdJQ0FnSUNBZ0x5OGdQQzBnWTJobFkydGxaQ0JwYmlCcGMxVnVhR0Z1Wkd4bFpDQnlaV0ZqZEdsdmJuTmNiaUFnSUNCMGFHbHpMbDl6SUQwZ01Ec2dJQ0FnSUNBZ0lDQWdJQ0FnSUM4dklEd3RJSE4wWVhSbFhHNGdJQ0FnZEdocGN5NWZaQ0E5SUdaaGJITmxPeUFnSUNBZ0lDQWdJQ0F2THlBOExTQmtiMjVsWEc0Z0lDQWdkR2hwY3k1ZmRpQTlJSFZ1WkdWbWFXNWxaRHNnSUNBZ0lDQXZMeUE4TFNCMllXeDFaVnh1SUNBZ0lIUm9hWE11WDJnZ1BTQXdPeUFnSUNBZ0lDQWdJQ0FnSUNBZ0x5OGdQQzBnY21WcVpXTjBhVzl1SUhOMFlYUmxMQ0F3SUMwZ1pHVm1ZWFZzZEN3Z01TQXRJR2hoYm1Sc1pXUXNJRElnTFNCMWJtaGhibVJzWldSY2JpQWdJQ0IwYUdsekxsOXVJRDBnWm1Gc2MyVTdJQ0FnSUNBZ0lDQWdJQzh2SUR3dElHNXZkR2xtZVZ4dUlDQjlPMXh1SUNCSmJuUmxjbTVoYkM1d2NtOTBiM1I1Y0dVZ1BTQnlaWEYxYVhKbEtDY3VMMTl5WldSbFptbHVaUzFoYkd3bktTZ2tVSEp2YldselpTNXdjbTkwYjNSNWNHVXNJSHRjYmlBZ0lDQXZMeUF5TlM0MExqVXVNeUJRY205dGFYTmxMbkJ5YjNSdmRIbHdaUzUwYUdWdUtHOXVSblZzWm1sc2JHVmtMQ0J2YmxKbGFtVmpkR1ZrS1Z4dUlDQWdJSFJvWlc0NklHWjFibU4wYVc5dUlIUm9aVzRvYjI1R2RXeG1hV3hzWldRc0lHOXVVbVZxWldOMFpXUXBlMXh1SUNBZ0lDQWdkbUZ5SUhKbFlXTjBhVzl1SUNBZ0lEMGdibVYzVUhKdmJXbHpaVU5oY0dGaWFXeHBkSGtvYzNCbFkybGxjME52Ym5OMGNuVmpkRzl5S0hSb2FYTXNJQ1JRY205dGFYTmxLU2s3WEc0Z0lDQWdJQ0J5WldGamRHbHZiaTV2YXlBZ0lDQWdQU0IwZVhCbGIyWWdiMjVHZFd4bWFXeHNaV1FnUFQwZ0oyWjFibU4wYVc5dUp5QS9JRzl1Um5Wc1ptbHNiR1ZrSURvZ2RISjFaVHRjYmlBZ0lDQWdJSEpsWVdOMGFXOXVMbVpoYVd3Z0lDQTlJSFI1Y0dWdlppQnZibEpsYW1WamRHVmtJRDA5SUNkbWRXNWpkR2x2YmljZ0ppWWdiMjVTWldwbFkzUmxaRHRjYmlBZ0lDQWdJSEpsWVdOMGFXOXVMbVJ2YldGcGJpQTlJR2x6VG05a1pTQS9JSEJ5YjJObGMzTXVaRzl0WVdsdUlEb2dkVzVrWldacGJtVmtPMXh1SUNBZ0lDQWdkR2hwY3k1Zll5NXdkWE5vS0hKbFlXTjBhVzl1S1R0Y2JpQWdJQ0FnSUdsbUtIUm9hWE11WDJFcGRHaHBjeTVmWVM1d2RYTm9LSEpsWVdOMGFXOXVLVHRjYmlBZ0lDQWdJR2xtS0hSb2FYTXVYM01wYm05MGFXWjVLSFJvYVhNc0lHWmhiSE5sS1R0Y2JpQWdJQ0FnSUhKbGRIVnliaUJ5WldGamRHbHZiaTV3Y205dGFYTmxPMXh1SUNBZ0lIMHNYRzRnSUNBZ0x5OGdNalV1TkM0MUxqRWdVSEp2YldselpTNXdjbTkwYjNSNWNHVXVZMkYwWTJnb2IyNVNaV3BsWTNSbFpDbGNiaUFnSUNBblkyRjBZMmduT2lCbWRXNWpkR2x2YmlodmJsSmxhbVZqZEdWa0tYdGNiaUFnSUNBZ0lISmxkSFZ5YmlCMGFHbHpMblJvWlc0b2RXNWtaV1pwYm1Wa0xDQnZibEpsYW1WamRHVmtLVHRjYmlBZ0lDQjlYRzRnSUgwcE8xeHVJQ0JRY205dGFYTmxRMkZ3WVdKcGJHbDBlU0E5SUdaMWJtTjBhVzl1S0NsN1hHNGdJQ0FnZG1GeUlIQnliMjFwYzJVZ0lEMGdibVYzSUVsdWRHVnlibUZzTzF4dUlDQWdJSFJvYVhNdWNISnZiV2x6WlNBOUlIQnliMjFwYzJVN1hHNGdJQ0FnZEdocGN5NXlaWE52YkhabElEMGdZM1I0S0NSeVpYTnZiSFpsTENCd2NtOXRhWE5sTENBeEtUdGNiaUFnSUNCMGFHbHpMbkpsYW1WamRDQWdQU0JqZEhnb0pISmxhbVZqZEN3Z2NISnZiV2x6WlN3Z01TazdYRzRnSUgwN1hHNTlYRzVjYmlSbGVIQnZjblFvSkdWNGNHOXlkQzVISUNzZ0pHVjRjRzl5ZEM1WElDc2dKR1Y0Y0c5eWRDNUdJQ29nSVZWVFJWOU9RVlJKVmtVc0lIdFFjbTl0YVhObE9pQWtVSEp2YldselpYMHBPMXh1Y21WeGRXbHlaU2duTGk5ZmMyVjBMWFJ2TFhOMGNtbHVaeTEwWVdjbktTZ2tVSEp2YldselpTd2dVRkpQVFVsVFJTazdYRzV5WlhGMWFYSmxLQ2N1TDE5elpYUXRjM0JsWTJsbGN5Y3BLRkJTVDAxSlUwVXBPMXh1VjNKaGNIQmxjaUE5SUhKbGNYVnBjbVVvSnk0dlgyTnZjbVVuS1Z0UVVrOU5TVk5GWFR0Y2JseHVMeThnYzNSaGRHbGpjMXh1SkdWNGNHOXlkQ2drWlhod2IzSjBMbE1nS3lBa1pYaHdiM0owTGtZZ0tpQWhWVk5GWDA1QlZFbFdSU3dnVUZKUFRVbFRSU3dnZTF4dUlDQXZMeUF5TlM0MExqUXVOU0JRY205dGFYTmxMbkpsYW1WamRDaHlLVnh1SUNCeVpXcGxZM1E2SUdaMWJtTjBhVzl1SUhKbGFtVmpkQ2h5S1h0Y2JpQWdJQ0IyWVhJZ1kyRndZV0pwYkdsMGVTQTlJRzVsZDFCeWIyMXBjMlZEWVhCaFltbHNhWFI1S0hSb2FYTXBYRzRnSUNBZ0lDQXNJQ1FrY21WcVpXTjBJQ0FnUFNCallYQmhZbWxzYVhSNUxuSmxhbVZqZER0Y2JpQWdJQ0FrSkhKbGFtVmpkQ2h5S1R0Y2JpQWdJQ0J5WlhSMWNtNGdZMkZ3WVdKcGJHbDBlUzV3Y205dGFYTmxPMXh1SUNCOVhHNTlLVHRjYmlSbGVIQnZjblFvSkdWNGNHOXlkQzVUSUNzZ0pHVjRjRzl5ZEM1R0lDb2dLRXhKUWxKQlVsa2dmSHdnSVZWVFJWOU9RVlJKVmtVcExDQlFVazlOU1ZORkxDQjdYRzRnSUM4dklESTFMalF1TkM0MklGQnliMjFwYzJVdWNtVnpiMngyWlNoNEtWeHVJQ0J5WlhOdmJIWmxPaUJtZFc1amRHbHZiaUJ5WlhOdmJIWmxLSGdwZTF4dUlDQWdJQzh2SUdsdWMzUmhibU5sYjJZZ2FXNXpkR1ZoWkNCdlppQnBiblJsY201aGJDQnpiRzkwSUdOb1pXTnJJR0psWTJGMWMyVWdkMlVnYzJodmRXeGtJR1pwZUNCcGRDQjNhWFJvYjNWMElISmxjR3hoWTJWdFpXNTBJRzVoZEdsMlpTQlFjbTl0YVhObElHTnZjbVZjYmlBZ0lDQnBaaWg0SUdsdWMzUmhibU5sYjJZZ0pGQnliMjFwYzJVZ0ppWWdjMkZ0WlVOdmJuTjBjblZqZEc5eUtIZ3VZMjl1YzNSeWRXTjBiM0lzSUhSb2FYTXBLWEpsZEhWeWJpQjRPMXh1SUNBZ0lIWmhjaUJqWVhCaFltbHNhWFI1SUQwZ2JtVjNVSEp2YldselpVTmhjR0ZpYVd4cGRIa29kR2hwY3lsY2JpQWdJQ0FnSUN3Z0pDUnlaWE52YkhabElDQTlJR05oY0dGaWFXeHBkSGt1Y21WemIyeDJaVHRjYmlBZ0lDQWtKSEpsYzI5c2RtVW9lQ2s3WEc0Z0lDQWdjbVYwZFhKdUlHTmhjR0ZpYVd4cGRIa3VjSEp2YldselpUdGNiaUFnZlZ4dWZTazdYRzRrWlhod2IzSjBLQ1JsZUhCdmNuUXVVeUFySUNSbGVIQnZjblF1UmlBcUlDRW9WVk5GWDA1QlZFbFdSU0FtSmlCeVpYRjFhWEpsS0NjdUwxOXBkR1Z5TFdSbGRHVmpkQ2NwS0daMWJtTjBhVzl1S0dsMFpYSXBlMXh1SUNBa1VISnZiV2x6WlM1aGJHd29hWFJsY2lsYkoyTmhkR05vSjEwb1pXMXdkSGtwTzF4dWZTa3BMQ0JRVWs5TlNWTkZMQ0I3WEc0Z0lDOHZJREkxTGpRdU5DNHhJRkJ5YjIxcGMyVXVZV3hzS0dsMFpYSmhZbXhsS1Z4dUlDQmhiR3c2SUdaMWJtTjBhVzl1SUdGc2JDaHBkR1Z5WVdKc1pTbDdYRzRnSUNBZ2RtRnlJRU1nSUNBZ0lDQWdJQ0FnUFNCMGFHbHpYRzRnSUNBZ0lDQXNJR05oY0dGaWFXeHBkSGtnUFNCdVpYZFFjbTl0YVhObFEyRndZV0pwYkdsMGVTaERLVnh1SUNBZ0lDQWdMQ0J5WlhOdmJIWmxJQ0FnSUQwZ1kyRndZV0pwYkdsMGVTNXlaWE52YkhabFhHNGdJQ0FnSUNBc0lISmxhbVZqZENBZ0lDQWdQU0JqWVhCaFltbHNhWFI1TG5KbGFtVmpkRHRjYmlBZ0lDQjJZWElnWVdKeWRYQjBJRDBnY0dWeVptOXliU2htZFc1amRHbHZiaWdwZTF4dUlDQWdJQ0FnZG1GeUlIWmhiSFZsY3lBZ0lDQTlJRnRkWEc0Z0lDQWdJQ0FnSUN3Z2FXNWtaWGdnSUNBZ0lEMGdNRnh1SUNBZ0lDQWdJQ0FzSUhKbGJXRnBibWx1WnlBOUlERTdYRzRnSUNBZ0lDQm1iM0pQWmlocGRHVnlZV0pzWlN3Z1ptRnNjMlVzSUdaMWJtTjBhVzl1S0hCeWIyMXBjMlVwZTF4dUlDQWdJQ0FnSUNCMllYSWdKR2x1WkdWNElDQWdJQ0FnSUNBOUlHbHVaR1Y0S3l0Y2JpQWdJQ0FnSUNBZ0lDQXNJR0ZzY21WaFpIbERZV3hzWldRZ1BTQm1ZV3h6WlR0Y2JpQWdJQ0FnSUNBZ2RtRnNkV1Z6TG5CMWMyZ29kVzVrWldacGJtVmtLVHRjYmlBZ0lDQWdJQ0FnY21WdFlXbHVhVzVuS3lzN1hHNGdJQ0FnSUNBZ0lFTXVjbVZ6YjJ4MlpTaHdjbTl0YVhObEtTNTBhR1Z1S0daMWJtTjBhVzl1S0haaGJIVmxLWHRjYmlBZ0lDQWdJQ0FnSUNCcFppaGhiSEpsWVdSNVEyRnNiR1ZrS1hKbGRIVnlianRjYmlBZ0lDQWdJQ0FnSUNCaGJISmxZV1I1UTJGc2JHVmtJQ0E5SUhSeWRXVTdYRzRnSUNBZ0lDQWdJQ0FnZG1Gc2RXVnpXeVJwYm1SbGVGMGdQU0IyWVd4MVpUdGNiaUFnSUNBZ0lDQWdJQ0F0TFhKbGJXRnBibWx1WnlCOGZDQnlaWE52YkhabEtIWmhiSFZsY3lrN1hHNGdJQ0FnSUNBZ0lIMHNJSEpsYW1WamRDazdYRzRnSUNBZ0lDQjlLVHRjYmlBZ0lDQWdJQzB0Y21WdFlXbHVhVzVuSUh4OElISmxjMjlzZG1Vb2RtRnNkV1Z6S1R0Y2JpQWdJQ0I5S1R0Y2JpQWdJQ0JwWmloaFluSjFjSFFwY21WcVpXTjBLR0ZpY25Wd2RDNWxjbkp2Y2lrN1hHNGdJQ0FnY21WMGRYSnVJR05oY0dGaWFXeHBkSGt1Y0hKdmJXbHpaVHRjYmlBZ2ZTeGNiaUFnTHk4Z01qVXVOQzQwTGpRZ1VISnZiV2x6WlM1eVlXTmxLR2wwWlhKaFlteGxLVnh1SUNCeVlXTmxPaUJtZFc1amRHbHZiaUJ5WVdObEtHbDBaWEpoWW14bEtYdGNiaUFnSUNCMllYSWdReUFnSUNBZ0lDQWdJQ0E5SUhSb2FYTmNiaUFnSUNBZ0lDd2dZMkZ3WVdKcGJHbDBlU0E5SUc1bGQxQnliMjFwYzJWRFlYQmhZbWxzYVhSNUtFTXBYRzRnSUNBZ0lDQXNJSEpsYW1WamRDQWdJQ0FnUFNCallYQmhZbWxzYVhSNUxuSmxhbVZqZER0Y2JpQWdJQ0IyWVhJZ1lXSnlkWEIwSUQwZ2NHVnlabTl5YlNobWRXNWpkR2x2YmlncGUxeHVJQ0FnSUNBZ1ptOXlUMllvYVhSbGNtRmliR1VzSUdaaGJITmxMQ0JtZFc1amRHbHZiaWh3Y205dGFYTmxLWHRjYmlBZ0lDQWdJQ0FnUXk1eVpYTnZiSFpsS0hCeWIyMXBjMlVwTG5Sb1pXNG9ZMkZ3WVdKcGJHbDBlUzV5WlhOdmJIWmxMQ0J5WldwbFkzUXBPMXh1SUNBZ0lDQWdmU2s3WEc0Z0lDQWdmU2s3WEc0Z0lDQWdhV1lvWVdKeWRYQjBLWEpsYW1WamRDaGhZbkoxY0hRdVpYSnliM0lwTzF4dUlDQWdJSEpsZEhWeWJpQmpZWEJoWW1sc2FYUjVMbkJ5YjIxcGMyVTdYRzRnSUgxY2JuMHBPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWpiM0psTFdwekwyeHBZbkpoY25rdmJXOWtkV3hsY3k5bGN6WXVjSEp2YldselpTNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVEEwWEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DQXhJRFFnTlNJc0lpZDFjMlVnYzNSeWFXTjBKenRjYmk4dklFVkRUVUZUWTNKcGNIUWdOaUJ6ZVcxaWIyeHpJSE5vYVcxY2JuWmhjaUJuYkc5aVlXd2dJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDJkc2IySmhiQ2NwWEc0Z0lDd2dhR0Z6SUNBZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlvWVhNbktWeHVJQ0FzSUVSRlUwTlNTVkJVVDFKVElDQWdJRDBnY21WeGRXbHlaU2duTGk5ZlpHVnpZM0pwY0hSdmNuTW5LVnh1SUNBc0lDUmxlSEJ2Y25RZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZaWGh3YjNKMEp5bGNiaUFnTENCeVpXUmxabWx1WlNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzSmxaR1ZtYVc1bEp5bGNiaUFnTENCTlJWUkJJQ0FnSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyMWxkR0VuS1M1TFJWbGNiaUFnTENBa1ptRnBiSE1nSUNBZ0lDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgyWmhhV3h6SnlsY2JpQWdMQ0J6YUdGeVpXUWdJQ0FnSUNBZ0lDQTlJSEpsY1hWcGNtVW9KeTR2WDNOb1lYSmxaQ2NwWEc0Z0lDd2djMlYwVkc5VGRISnBibWRVWVdjZ1BTQnlaWEYxYVhKbEtDY3VMMTl6WlhRdGRHOHRjM1J5YVc1bkxYUmhaeWNwWEc0Z0lDd2dkV2xrSUNBZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTkxYVdRbktWeHVJQ0FzSUhkcmN5QWdJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmQydHpKeWxjYmlBZ0xDQjNhM05GZUhRZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYM2RyY3kxbGVIUW5LVnh1SUNBc0lIZHJjMFJsWm1sdVpTQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZkMnR6TFdSbFptbHVaU2NwWEc0Z0lDd2dhMlY1VDJZZ0lDQWdJQ0FnSUNBZ1BTQnlaWEYxYVhKbEtDY3VMMTlyWlhsdlppY3BYRzRnSUN3Z1pXNTFiVXRsZVhNZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOWxiblZ0TFd0bGVYTW5LVnh1SUNBc0lHbHpRWEp5WVhrZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZhWE10WVhKeVlYa25LVnh1SUNBc0lHRnVUMkpxWldOMElDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZZVzR0YjJKcVpXTjBKeWxjYmlBZ0xDQjBiMGxQWW1wbFkzUWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYM1J2TFdsdlltcGxZM1FuS1Z4dUlDQXNJSFJ2VUhKcGJXbDBhWFpsSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmZEc4dGNISnBiV2wwYVhabEp5bGNiaUFnTENCamNtVmhkR1ZFWlhOaklDQWdJQ0E5SUhKbGNYVnBjbVVvSnk0dlgzQnliM0JsY25SNUxXUmxjMk1uS1Z4dUlDQXNJRjlqY21WaGRHVWdJQ0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMV055WldGMFpTY3BYRzRnSUN3Z1owOVFUa1Y0ZENBZ0lDQWdJQ0FnUFNCeVpYRjFhWEpsS0NjdUwxOXZZbXBsWTNRdFoyOXdiaTFsZUhRbktWeHVJQ0FzSUNSSFQxQkVJQ0FnSUNBZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmIySnFaV04wTFdkdmNHUW5LVnh1SUNBc0lDUkVVQ0FnSUNBZ0lDQWdJQ0FnSUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXUndKeWxjYmlBZ0xDQWthMlY1Y3lBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMXJaWGx6SnlsY2JpQWdMQ0JuVDFCRUlDQWdJQ0FnSUNBZ0lDQTlJQ1JIVDFCRUxtWmNiaUFnTENCa1VDQWdJQ0FnSUNBZ0lDQWdJQ0E5SUNSRVVDNW1YRzRnSUN3Z1owOVFUaUFnSUNBZ0lDQWdJQ0FnUFNCblQxQk9SWGgwTG1aY2JpQWdMQ0FrVTNsdFltOXNJQ0FnSUNBZ0lDQTlJR2RzYjJKaGJDNVRlVzFpYjJ4Y2JpQWdMQ0FrU2xOUFRpQWdJQ0FnSUNBZ0lDQTlJR2RzYjJKaGJDNUtVMDlPWEc0Z0lDd2dYM04wY21sdVoybG1lU0FnSUNBZ1BTQWtTbE5QVGlBbUppQWtTbE5QVGk1emRISnBibWRwWm5sY2JpQWdMQ0JRVWs5VVQxUlpVRVVnSUNBZ0lDQTlJQ2R3Y205MGIzUjVjR1VuWEc0Z0lDd2dTRWxFUkVWT0lDQWdJQ0FnSUNBZ1BTQjNhM01vSjE5b2FXUmtaVzRuS1Z4dUlDQXNJRlJQWDFCU1NVMUpWRWxXUlNBZ0lEMGdkMnR6S0NkMGIxQnlhVzFwZEdsMlpTY3BYRzRnSUN3Z2FYTkZiblZ0SUNBZ0lDQWdJQ0FnUFNCN2ZTNXdjbTl3WlhKMGVVbHpSVzUxYldWeVlXSnNaVnh1SUNBc0lGTjViV0p2YkZKbFoybHpkSEo1SUQwZ2MyaGhjbVZrS0NkemVXMWliMnd0Y21WbmFYTjBjbmtuS1Z4dUlDQXNJRUZzYkZONWJXSnZiSE1nSUNBZ0lEMGdjMmhoY21Wa0tDZHplVzFpYjJ4ekp5bGNiaUFnTENCUFVGTjViV0p2YkhNZ0lDQWdJQ0E5SUhOb1lYSmxaQ2duYjNBdGMzbHRZbTlzY3ljcFhHNGdJQ3dnVDJKcVpXTjBVSEp2ZEc4Z0lDQWdQU0JQWW1wbFkzUmJVRkpQVkU5VVdWQkZYVnh1SUNBc0lGVlRSVjlPUVZSSlZrVWdJQ0FnSUQwZ2RIbHdaVzltSUNSVGVXMWliMndnUFQwZ0oyWjFibU4wYVc5dUoxeHVJQ0FzSUZGUFltcGxZM1FnSUNBZ0lDQWdJRDBnWjJ4dlltRnNMbEZQWW1wbFkzUTdYRzR2THlCRWIyNG5kQ0IxYzJVZ2MyVjBkR1Z5Y3lCcGJpQlJkQ0JUWTNKcGNIUXNJR2gwZEhCek9pOHZaMmwwYUhWaUxtTnZiUzk2Ykc5cGNtOWpheTlqYjNKbExXcHpMMmx6YzNWbGN5OHhOek5jYm5aaGNpQnpaWFIwWlhJZ1BTQWhVVTlpYW1WamRDQjhmQ0FoVVU5aWFtVmpkRnRRVWs5VVQxUlpVRVZkSUh4OElDRlJUMkpxWldOMFcxQlNUMVJQVkZsUVJWMHVabWx1WkVOb2FXeGtPMXh1WEc0dkx5Qm1ZV3hzWW1GamF5Qm1iM0lnYjJ4a0lFRnVaSEp2YVdRc0lHaDBkSEJ6T2k4dlkyOWtaUzVuYjI5bmJHVXVZMjl0TDNBdmRqZ3ZhWE56ZFdWekwyUmxkR0ZwYkQ5cFpEMDJPRGRjYm5aaGNpQnpaWFJUZVcxaWIyeEVaWE5qSUQwZ1JFVlRRMUpKVUZSUFVsTWdKaVlnSkdaaGFXeHpLR1oxYm1OMGFXOXVLQ2w3WEc0Z0lISmxkSFZ5YmlCZlkzSmxZWFJsS0dSUUtIdDlMQ0FuWVNjc0lIdGNiaUFnSUNCblpYUTZJR1oxYm1OMGFXOXVLQ2w3SUhKbGRIVnliaUJrVUNoMGFHbHpMQ0FuWVNjc0lIdDJZV3gxWlRvZ04zMHBMbUU3SUgxY2JpQWdmU2twTG1FZ0lUMGdOenRjYm4wcElEOGdablZ1WTNScGIyNG9hWFFzSUd0bGVTd2dSQ2w3WEc0Z0lIWmhjaUJ3Y205MGIwUmxjMk1nUFNCblQxQkVLRTlpYW1WamRGQnliM1J2TENCclpYa3BPMXh1SUNCcFppaHdjbTkwYjBSbGMyTXBaR1ZzWlhSbElFOWlhbVZqZEZCeWIzUnZXMnRsZVYwN1hHNGdJR1JRS0dsMExDQnJaWGtzSUVRcE8xeHVJQ0JwWmlod2NtOTBiMFJsYzJNZ0ppWWdhWFFnSVQwOUlFOWlhbVZqZEZCeWIzUnZLV1JRS0U5aWFtVmpkRkJ5YjNSdkxDQnJaWGtzSUhCeWIzUnZSR1Z6WXlrN1hHNTlJRG9nWkZBN1hHNWNiblpoY2lCM2NtRndJRDBnWm5WdVkzUnBiMjRvZEdGbktYdGNiaUFnZG1GeUlITjViU0E5SUVGc2JGTjViV0p2YkhOYmRHRm5YU0E5SUY5amNtVmhkR1VvSkZONWJXSnZiRnRRVWs5VVQxUlpVRVZkS1R0Y2JpQWdjM2x0TGw5cklEMGdkR0ZuTzF4dUlDQnlaWFIxY200Z2MzbHRPMXh1ZlR0Y2JseHVkbUZ5SUdselUzbHRZbTlzSUQwZ1ZWTkZYMDVCVkVsV1JTQW1KaUIwZVhCbGIyWWdKRk41YldKdmJDNXBkR1Z5WVhSdmNpQTlQU0FuYzNsdFltOXNKeUEvSUdaMWJtTjBhVzl1S0dsMEtYdGNiaUFnY21WMGRYSnVJSFI1Y0dWdlppQnBkQ0E5UFNBbmMzbHRZbTlzSnp0Y2JuMGdPaUJtZFc1amRHbHZiaWhwZENsN1hHNGdJSEpsZEhWeWJpQnBkQ0JwYm5OMFlXNWpaVzltSUNSVGVXMWliMnc3WEc1OU8xeHVYRzUyWVhJZ0pHUmxabWx1WlZCeWIzQmxjblI1SUQwZ1puVnVZM1JwYjI0Z1pHVm1hVzVsVUhKdmNHVnlkSGtvYVhRc0lHdGxlU3dnUkNsN1hHNGdJR2xtS0dsMElEMDlQU0JQWW1wbFkzUlFjbTkwYnlra1pHVm1hVzVsVUhKdmNHVnlkSGtvVDFCVGVXMWliMnh6TENCclpYa3NJRVFwTzF4dUlDQmhiazlpYW1WamRDaHBkQ2s3WEc0Z0lHdGxlU0E5SUhSdlVISnBiV2wwYVhabEtHdGxlU3dnZEhKMVpTazdYRzRnSUdGdVQySnFaV04wS0VRcE8xeHVJQ0JwWmlob1lYTW9RV3hzVTNsdFltOXNjeXdnYTJWNUtTbDdYRzRnSUNBZ2FXWW9JVVF1Wlc1MWJXVnlZV0pzWlNsN1hHNGdJQ0FnSUNCcFppZ2hhR0Z6S0dsMExDQklTVVJFUlU0cEtXUlFLR2wwTENCSVNVUkVSVTRzSUdOeVpXRjBaVVJsYzJNb01Td2dlMzBwS1R0Y2JpQWdJQ0FnSUdsMFcwaEpSRVJGVGwxYmEyVjVYU0E5SUhSeWRXVTdYRzRnSUNBZ2ZTQmxiSE5sSUh0Y2JpQWdJQ0FnSUdsbUtHaGhjeWhwZEN3Z1NFbEVSRVZPS1NBbUppQnBkRnRJU1VSRVJVNWRXMnRsZVYwcGFYUmJTRWxFUkVWT1hWdHJaWGxkSUQwZ1ptRnNjMlU3WEc0Z0lDQWdJQ0JFSUQwZ1gyTnlaV0YwWlNoRUxDQjdaVzUxYldWeVlXSnNaVG9nWTNKbFlYUmxSR1Z6WXlnd0xDQm1ZV3h6WlNsOUtUdGNiaUFnSUNCOUlISmxkSFZ5YmlCelpYUlRlVzFpYjJ4RVpYTmpLR2wwTENCclpYa3NJRVFwTzF4dUlDQjlJSEpsZEhWeWJpQmtVQ2hwZEN3Z2EyVjVMQ0JFS1R0Y2JuMDdYRzUyWVhJZ0pHUmxabWx1WlZCeWIzQmxjblJwWlhNZ1BTQm1kVzVqZEdsdmJpQmtaV1pwYm1WUWNtOXdaWEowYVdWektHbDBMQ0JRS1h0Y2JpQWdZVzVQWW1wbFkzUW9hWFFwTzF4dUlDQjJZWElnYTJWNWN5QTlJR1Z1ZFcxTFpYbHpLRkFnUFNCMGIwbFBZbXBsWTNRb1VDa3BYRzRnSUNBZ0xDQnBJQ0FnSUQwZ01GeHVJQ0FnSUN3Z2JDQTlJR3RsZVhNdWJHVnVaM1JvWEc0Z0lDQWdMQ0JyWlhrN1hHNGdJSGRvYVd4bEtHd2dQaUJwS1NSa1pXWnBibVZRY205d1pYSjBlU2hwZEN3Z2EyVjVJRDBnYTJWNWMxdHBLeXRkTENCUVcydGxlVjBwTzF4dUlDQnlaWFIxY200Z2FYUTdYRzU5TzF4dWRtRnlJQ1JqY21WaGRHVWdQU0JtZFc1amRHbHZiaUJqY21WaGRHVW9hWFFzSUZBcGUxeHVJQ0J5WlhSMWNtNGdVQ0E5UFQwZ2RXNWtaV1pwYm1Wa0lEOGdYMk55WldGMFpTaHBkQ2tnT2lBa1pHVm1hVzVsVUhKdmNHVnlkR2xsY3loZlkzSmxZWFJsS0dsMEtTd2dVQ2s3WEc1OU8xeHVkbUZ5SUNSd2NtOXdaWEowZVVselJXNTFiV1Z5WVdKc1pTQTlJR1oxYm1OMGFXOXVJSEJ5YjNCbGNuUjVTWE5GYm5WdFpYSmhZbXhsS0d0bGVTbDdYRzRnSUhaaGNpQkZJRDBnYVhORmJuVnRMbU5oYkd3b2RHaHBjeXdnYTJWNUlEMGdkRzlRY21sdGFYUnBkbVVvYTJWNUxDQjBjblZsS1NrN1hHNGdJR2xtS0hSb2FYTWdQVDA5SUU5aWFtVmpkRkJ5YjNSdklDWW1JR2hoY3loQmJHeFRlVzFpYjJ4ekxDQnJaWGtwSUNZbUlDRm9ZWE1vVDFCVGVXMWliMnh6TENCclpYa3BLWEpsZEhWeWJpQm1ZV3h6WlR0Y2JpQWdjbVYwZFhKdUlFVWdmSHdnSVdoaGN5aDBhR2x6TENCclpYa3BJSHg4SUNGb1lYTW9RV3hzVTNsdFltOXNjeXdnYTJWNUtTQjhmQ0JvWVhNb2RHaHBjeXdnU0VsRVJFVk9LU0FtSmlCMGFHbHpXMGhKUkVSRlRsMWJhMlY1WFNBL0lFVWdPaUIwY25WbE8xeHVmVHRjYm5aaGNpQWtaMlYwVDNkdVVISnZjR1Z5ZEhsRVpYTmpjbWx3ZEc5eUlEMGdablZ1WTNScGIyNGdaMlYwVDNkdVVISnZjR1Z5ZEhsRVpYTmpjbWx3ZEc5eUtHbDBMQ0JyWlhrcGUxeHVJQ0JwZENBZ1BTQjBiMGxQWW1wbFkzUW9hWFFwTzF4dUlDQnJaWGtnUFNCMGIxQnlhVzFwZEdsMlpTaHJaWGtzSUhSeWRXVXBPMXh1SUNCcFppaHBkQ0E5UFQwZ1QySnFaV04wVUhKdmRHOGdKaVlnYUdGektFRnNiRk41YldKdmJITXNJR3RsZVNrZ0ppWWdJV2hoY3loUFVGTjViV0p2YkhNc0lHdGxlU2twY21WMGRYSnVPMXh1SUNCMllYSWdSQ0E5SUdkUFVFUW9hWFFzSUd0bGVTazdYRzRnSUdsbUtFUWdKaVlnYUdGektFRnNiRk41YldKdmJITXNJR3RsZVNrZ0ppWWdJU2hvWVhNb2FYUXNJRWhKUkVSRlRpa2dKaVlnYVhSYlNFbEVSRVZPWFZ0clpYbGRLU2xFTG1WdWRXMWxjbUZpYkdVZ1BTQjBjblZsTzF4dUlDQnlaWFIxY200Z1JEdGNibjA3WEc1MllYSWdKR2RsZEU5M2JsQnliM0JsY25SNVRtRnRaWE1nUFNCbWRXNWpkR2x2YmlCblpYUlBkMjVRY205d1pYSjBlVTVoYldWektHbDBLWHRjYmlBZ2RtRnlJRzVoYldWeklDQTlJR2RQVUU0b2RHOUpUMkpxWldOMEtHbDBLU2xjYmlBZ0lDQXNJSEpsYzNWc2RDQTlJRnRkWEc0Z0lDQWdMQ0JwSUNBZ0lDQWdQU0F3WEc0Z0lDQWdMQ0JyWlhrN1hHNGdJSGRvYVd4bEtHNWhiV1Z6TG14bGJtZDBhQ0ErSUdrcGUxeHVJQ0FnSUdsbUtDRm9ZWE1vUVd4c1UzbHRZbTlzY3l3Z2EyVjVJRDBnYm1GdFpYTmJhU3NyWFNrZ0ppWWdhMlY1SUNFOUlFaEpSRVJGVGlBbUppQnJaWGtnSVQwZ1RVVlVRU2x5WlhOMWJIUXVjSFZ6YUNoclpYa3BPMXh1SUNCOUlISmxkSFZ5YmlCeVpYTjFiSFE3WEc1OU8xeHVkbUZ5SUNSblpYUlBkMjVRY205d1pYSjBlVk41YldKdmJITWdQU0JtZFc1amRHbHZiaUJuWlhSUGQyNVFjbTl3WlhKMGVWTjViV0p2YkhNb2FYUXBlMXh1SUNCMllYSWdTVk5mVDFBZ0lEMGdhWFFnUFQwOUlFOWlhbVZqZEZCeWIzUnZYRzRnSUNBZ0xDQnVZVzFsY3lBZ1BTQm5UMUJPS0VsVFgwOVFJRDhnVDFCVGVXMWliMnh6SURvZ2RHOUpUMkpxWldOMEtHbDBLU2xjYmlBZ0lDQXNJSEpsYzNWc2RDQTlJRnRkWEc0Z0lDQWdMQ0JwSUNBZ0lDQWdQU0F3WEc0Z0lDQWdMQ0JyWlhrN1hHNGdJSGRvYVd4bEtHNWhiV1Z6TG14bGJtZDBhQ0ErSUdrcGUxeHVJQ0FnSUdsbUtHaGhjeWhCYkd4VGVXMWliMnh6TENCclpYa2dQU0J1WVcxbGMxdHBLeXRkS1NBbUppQW9TVk5mVDFBZ1B5Qm9ZWE1vVDJKcVpXTjBVSEp2ZEc4c0lHdGxlU2tnT2lCMGNuVmxLU2x5WlhOMWJIUXVjSFZ6YUNoQmJHeFRlVzFpYjJ4elcydGxlVjBwTzF4dUlDQjlJSEpsZEhWeWJpQnlaWE4xYkhRN1hHNTlPMXh1WEc0dkx5QXhPUzQwTGpFdU1TQlRlVzFpYjJ3b1cyUmxjMk55YVhCMGFXOXVYU2xjYm1sbUtDRlZVMFZmVGtGVVNWWkZLWHRjYmlBZ0pGTjViV0p2YkNBOUlHWjFibU4wYVc5dUlGTjViV0p2YkNncGUxeHVJQ0FnSUdsbUtIUm9hWE1nYVc1emRHRnVZMlZ2WmlBa1UzbHRZbTlzS1hSb2NtOTNJRlI1Y0dWRmNuSnZjaWduVTNsdFltOXNJR2x6SUc1dmRDQmhJR052Ym5OMGNuVmpkRzl5SVNjcE8xeHVJQ0FnSUhaaGNpQjBZV2NnUFNCMWFXUW9ZWEpuZFcxbGJuUnpMbXhsYm1kMGFDQStJREFnUHlCaGNtZDFiV1Z1ZEhOYk1GMGdPaUIxYm1SbFptbHVaV1FwTzF4dUlDQWdJSFpoY2lBa2MyVjBJRDBnWm5WdVkzUnBiMjRvZG1Gc2RXVXBlMXh1SUNBZ0lDQWdhV1lvZEdocGN5QTlQVDBnVDJKcVpXTjBVSEp2ZEc4cEpITmxkQzVqWVd4c0tFOVFVM2x0WW05c2N5d2dkbUZzZFdVcE8xeHVJQ0FnSUNBZ2FXWW9hR0Z6S0hSb2FYTXNJRWhKUkVSRlRpa2dKaVlnYUdGektIUm9hWE5iU0VsRVJFVk9YU3dnZEdGbktTbDBhR2x6VzBoSlJFUkZUbDFiZEdGblhTQTlJR1poYkhObE8xeHVJQ0FnSUNBZ2MyVjBVM2x0WW05c1JHVnpZeWgwYUdsekxDQjBZV2NzSUdOeVpXRjBaVVJsYzJNb01Td2dkbUZzZFdVcEtUdGNiaUFnSUNCOU8xeHVJQ0FnSUdsbUtFUkZVME5TU1ZCVVQxSlRJQ1ltSUhObGRIUmxjaWx6WlhSVGVXMWliMnhFWlhOaktFOWlhbVZqZEZCeWIzUnZMQ0IwWVdjc0lIdGpiMjVtYVdkMWNtRmliR1U2SUhSeWRXVXNJSE5sZERvZ0pITmxkSDBwTzF4dUlDQWdJSEpsZEhWeWJpQjNjbUZ3S0hSaFp5azdYRzRnSUgwN1hHNGdJSEpsWkdWbWFXNWxLQ1JUZVcxaWIyeGJVRkpQVkU5VVdWQkZYU3dnSjNSdlUzUnlhVzVuSnl3Z1puVnVZM1JwYjI0Z2RHOVRkSEpwYm1jb0tYdGNiaUFnSUNCeVpYUjFjbTRnZEdocGN5NWZhenRjYmlBZ2ZTazdYRzVjYmlBZ0pFZFBVRVF1WmlBOUlDUm5aWFJQZDI1UWNtOXdaWEowZVVSbGMyTnlhWEIwYjNJN1hHNGdJQ1JFVUM1bUlDQWdQU0FrWkdWbWFXNWxVSEp2Y0dWeWRIazdYRzRnSUhKbGNYVnBjbVVvSnk0dlgyOWlhbVZqZEMxbmIzQnVKeWt1WmlBOUlHZFBVRTVGZUhRdVppQTlJQ1JuWlhSUGQyNVFjbTl3WlhKMGVVNWhiV1Z6TzF4dUlDQnlaWEYxYVhKbEtDY3VMMTl2WW1wbFkzUXRjR2xsSnlrdVppQWdQU0FrY0hKdmNHVnlkSGxKYzBWdWRXMWxjbUZpYkdVN1hHNGdJSEpsY1hWcGNtVW9KeTR2WDI5aWFtVmpkQzFuYjNCekp5a3VaaUE5SUNSblpYUlBkMjVRY205d1pYSjBlVk41YldKdmJITTdYRzVjYmlBZ2FXWW9SRVZUUTFKSlVGUlBVbE1nSmlZZ0lYSmxjWFZwY21Vb0p5NHZYMnhwWW5KaGNua25LU2w3WEc0Z0lDQWdjbVZrWldacGJtVW9UMkpxWldOMFVISnZkRzhzSUNkd2NtOXdaWEowZVVselJXNTFiV1Z5WVdKc1pTY3NJQ1J3Y205d1pYSjBlVWx6Ulc1MWJXVnlZV0pzWlN3Z2RISjFaU2s3WEc0Z0lIMWNibHh1SUNCM2EzTkZlSFF1WmlBOUlHWjFibU4wYVc5dUtHNWhiV1VwZTF4dUlDQWdJSEpsZEhWeWJpQjNjbUZ3S0hkcmN5aHVZVzFsS1NrN1hHNGdJSDFjYm4xY2JseHVKR1Y0Y0c5eWRDZ2taWGh3YjNKMExrY2dLeUFrWlhod2IzSjBMbGNnS3lBa1pYaHdiM0owTGtZZ0tpQWhWVk5GWDA1QlZFbFdSU3dnZTFONWJXSnZiRG9nSkZONWJXSnZiSDBwTzF4dVhHNW1iM0lvZG1GeUlITjViV0p2YkhNZ1BTQW9YRzRnSUM4dklERTVMalF1TWk0eUxDQXhPUzQwTGpJdU15d2dNVGt1TkM0eUxqUXNJREU1TGpRdU1pNDJMQ0F4T1M0MExqSXVPQ3dnTVRrdU5DNHlMamtzSURFNUxqUXVNaTR4TUN3Z01Ua3VOQzR5TGpFeExDQXhPUzQwTGpJdU1USXNJREU1TGpRdU1pNHhNeXdnTVRrdU5DNHlMakUwWEc0Z0lDZG9ZWE5KYm5OMFlXNWpaU3hwYzBOdmJtTmhkRk53Y21WaFpHRmliR1VzYVhSbGNtRjBiM0lzYldGMFkyZ3NjbVZ3YkdGalpTeHpaV0Z5WTJnc2MzQmxZMmxsY3l4emNHeHBkQ3gwYjFCeWFXMXBkR2wyWlN4MGIxTjBjbWx1WjFSaFp5eDFibk5qYjNCaFlteGxjeWRjYmlrdWMzQnNhWFFvSnl3bktTd2dhU0E5SURBN0lITjViV0p2YkhNdWJHVnVaM1JvSUQ0Z2FUc2dLWGRyY3loemVXMWliMnh6VzJrcksxMHBPMXh1WEc1bWIzSW9kbUZ5SUhONWJXSnZiSE1nUFNBa2EyVjVjeWgzYTNNdWMzUnZjbVVwTENCcElEMGdNRHNnYzNsdFltOXNjeTVzWlc1bmRHZ2dQaUJwT3lBcGQydHpSR1ZtYVc1bEtITjViV0p2YkhOYmFTc3JYU2s3WEc1Y2JpUmxlSEJ2Y25Rb0pHVjRjRzl5ZEM1VElDc2dKR1Y0Y0c5eWRDNUdJQ29nSVZWVFJWOU9RVlJKVmtVc0lDZFRlVzFpYjJ3bkxDQjdYRzRnSUM4dklERTVMalF1TWk0eElGTjViV0p2YkM1bWIzSW9hMlY1S1Z4dUlDQW5abTl5SnpvZ1puVnVZM1JwYjI0b2EyVjVLWHRjYmlBZ0lDQnlaWFIxY200Z2FHRnpLRk41YldKdmJGSmxaMmx6ZEhKNUxDQnJaWGtnS3owZ0p5Y3BYRzRnSUNBZ0lDQS9JRk41YldKdmJGSmxaMmx6ZEhKNVcydGxlVjFjYmlBZ0lDQWdJRG9nVTNsdFltOXNVbVZuYVhOMGNubGJhMlY1WFNBOUlDUlRlVzFpYjJ3b2EyVjVLVHRjYmlBZ2ZTeGNiaUFnTHk4Z01Ua3VOQzR5TGpVZ1UzbHRZbTlzTG10bGVVWnZjaWh6ZVcwcFhHNGdJR3RsZVVadmNqb2dablZ1WTNScGIyNGdhMlY1Um05eUtHdGxlU2w3WEc0Z0lDQWdhV1lvYVhOVGVXMWliMndvYTJWNUtTbHlaWFIxY200Z2EyVjVUMllvVTNsdFltOXNVbVZuYVhOMGNua3NJR3RsZVNrN1hHNGdJQ0FnZEdoeWIzY2dWSGx3WlVWeWNtOXlLR3RsZVNBcklDY2dhWE1nYm05MElHRWdjM2x0WW05c0lTY3BPMXh1SUNCOUxGeHVJQ0IxYzJWVFpYUjBaWEk2SUdaMWJtTjBhVzl1S0NsN0lITmxkSFJsY2lBOUlIUnlkV1U3SUgwc1hHNGdJSFZ6WlZOcGJYQnNaVG9nWm5WdVkzUnBiMjRvS1hzZ2MyVjBkR1Z5SUQwZ1ptRnNjMlU3SUgxY2JuMHBPMXh1WEc0a1pYaHdiM0owS0NSbGVIQnZjblF1VXlBcklDUmxlSEJ2Y25RdVJpQXFJQ0ZWVTBWZlRrRlVTVlpGTENBblQySnFaV04wSnl3Z2UxeHVJQ0F2THlBeE9TNHhMakl1TWlCUFltcGxZM1F1WTNKbFlYUmxLRThnV3l3Z1VISnZjR1Z5ZEdsbGMxMHBYRzRnSUdOeVpXRjBaVG9nSkdOeVpXRjBaU3hjYmlBZ0x5OGdNVGt1TVM0eUxqUWdUMkpxWldOMExtUmxabWx1WlZCeWIzQmxjblI1S0U4c0lGQXNJRUYwZEhKcFluVjBaWE1wWEc0Z0lHUmxabWx1WlZCeWIzQmxjblI1T2lBa1pHVm1hVzVsVUhKdmNHVnlkSGtzWEc0Z0lDOHZJREU1TGpFdU1pNHpJRTlpYW1WamRDNWtaV1pwYm1WUWNtOXdaWEowYVdWektFOHNJRkJ5YjNCbGNuUnBaWE1wWEc0Z0lHUmxabWx1WlZCeWIzQmxjblJwWlhNNklDUmtaV1pwYm1WUWNtOXdaWEowYVdWekxGeHVJQ0F2THlBeE9TNHhMakl1TmlCUFltcGxZM1F1WjJWMFQzZHVVSEp2Y0dWeWRIbEVaWE5qY21sd2RHOXlLRThzSUZBcFhHNGdJR2RsZEU5M2JsQnliM0JsY25SNVJHVnpZM0pwY0hSdmNqb2dKR2RsZEU5M2JsQnliM0JsY25SNVJHVnpZM0pwY0hSdmNpeGNiaUFnTHk4Z01Ua3VNUzR5TGpjZ1QySnFaV04wTG1kbGRFOTNibEJ5YjNCbGNuUjVUbUZ0WlhNb1R5bGNiaUFnWjJWMFQzZHVVSEp2Y0dWeWRIbE9ZVzFsY3pvZ0pHZGxkRTkzYmxCeWIzQmxjblI1VG1GdFpYTXNYRzRnSUM4dklERTVMakV1TWk0NElFOWlhbVZqZEM1blpYUlBkMjVRY205d1pYSjBlVk41YldKdmJITW9UeWxjYmlBZ1oyVjBUM2R1VUhKdmNHVnlkSGxUZVcxaWIyeHpPaUFrWjJWMFQzZHVVSEp2Y0dWeWRIbFRlVzFpYjJ4elhHNTlLVHRjYmx4dUx5OGdNalF1TXk0eUlFcFRUMDR1YzNSeWFXNW5hV1o1S0haaGJIVmxJRnNzSUhKbGNHeGhZMlZ5SUZzc0lITndZV05sWFYwcFhHNGtTbE5QVGlBbUppQWtaWGh3YjNKMEtDUmxlSEJ2Y25RdVV5QXJJQ1JsZUhCdmNuUXVSaUFxSUNnaFZWTkZYMDVCVkVsV1JTQjhmQ0FrWm1GcGJITW9ablZ1WTNScGIyNG9LWHRjYmlBZ2RtRnlJRk1nUFNBa1UzbHRZbTlzS0NrN1hHNGdJQzh2SUUxVElFVmtaMlVnWTI5dWRtVnlkSE1nYzNsdFltOXNJSFpoYkhWbGN5QjBieUJLVTA5T0lHRnpJSHQ5WEc0Z0lDOHZJRmRsWWt0cGRDQmpiMjUyWlhKMGN5QnplVzFpYjJ3Z2RtRnNkV1Z6SUhSdklFcFRUMDRnWVhNZ2JuVnNiRnh1SUNBdkx5QldPQ0IwYUhKdmQzTWdiMjRnWW05NFpXUWdjM2x0WW05c2MxeHVJQ0J5WlhSMWNtNGdYM04wY21sdVoybG1lU2hiVTEwcElDRTlJQ2RiYm5Wc2JGMG5JSHg4SUY5emRISnBibWRwWm5rb2UyRTZJRk45S1NBaFBTQW5lMzBuSUh4OElGOXpkSEpwYm1kcFpua29UMkpxWldOMEtGTXBLU0FoUFNBbmUzMG5PMXh1ZlNrcExDQW5TbE5QVGljc0lIdGNiaUFnYzNSeWFXNW5hV1o1T2lCbWRXNWpkR2x2YmlCemRISnBibWRwWm5rb2FYUXBlMXh1SUNBZ0lHbG1LR2wwSUQwOVBTQjFibVJsWm1sdVpXUWdmSHdnYVhOVGVXMWliMndvYVhRcEtYSmxkSFZ5YmpzZ0x5OGdTVVU0SUhKbGRIVnlibk1nYzNSeWFXNW5JRzl1SUhWdVpHVm1hVzVsWkZ4dUlDQWdJSFpoY2lCaGNtZHpJRDBnVzJsMFhWeHVJQ0FnSUNBZ0xDQnBJQ0FnSUQwZ01WeHVJQ0FnSUNBZ0xDQnlaWEJzWVdObGNpd2dKSEpsY0d4aFkyVnlPMXh1SUNBZ0lIZG9hV3hsS0dGeVozVnRaVzUwY3k1c1pXNW5kR2dnUGlCcEtXRnlaM011Y0hWemFDaGhjbWQxYldWdWRITmJhU3NyWFNrN1hHNGdJQ0FnY21Wd2JHRmpaWElnUFNCaGNtZHpXekZkTzF4dUlDQWdJR2xtS0hSNWNHVnZaaUJ5WlhCc1lXTmxjaUE5UFNBblpuVnVZM1JwYjI0bktTUnlaWEJzWVdObGNpQTlJSEpsY0d4aFkyVnlPMXh1SUNBZ0lHbG1LQ1J5WlhCc1lXTmxjaUI4ZkNBaGFYTkJjbkpoZVNoeVpYQnNZV05sY2lrcGNtVndiR0ZqWlhJZ1BTQm1kVzVqZEdsdmJpaHJaWGtzSUhaaGJIVmxLWHRjYmlBZ0lDQWdJR2xtS0NSeVpYQnNZV05sY2lsMllXeDFaU0E5SUNSeVpYQnNZV05sY2k1allXeHNLSFJvYVhNc0lHdGxlU3dnZG1Gc2RXVXBPMXh1SUNBZ0lDQWdhV1lvSVdselUzbHRZbTlzS0haaGJIVmxLU2x5WlhSMWNtNGdkbUZzZFdVN1hHNGdJQ0FnZlR0Y2JpQWdJQ0JoY21keld6RmRJRDBnY21Wd2JHRmpaWEk3WEc0Z0lDQWdjbVYwZFhKdUlGOXpkSEpwYm1kcFpua3VZWEJ3Ykhrb0pFcFRUMDRzSUdGeVozTXBPMXh1SUNCOVhHNTlLVHRjYmx4dUx5OGdNVGt1TkM0ekxqUWdVM2x0WW05c0xuQnliM1J2ZEhsd1pWdEFRSFJ2VUhKcGJXbDBhWFpsWFNob2FXNTBLVnh1SkZONWJXSnZiRnRRVWs5VVQxUlpVRVZkVzFSUFgxQlNTVTFKVkVsV1JWMGdmSHdnY21WeGRXbHlaU2duTGk5ZmFHbGtaU2NwS0NSVGVXMWliMnhiVUZKUFZFOVVXVkJGWFN3Z1ZFOWZVRkpKVFVsVVNWWkZMQ0FrVTNsdFltOXNXMUJTVDFSUFZGbFFSVjB1ZG1Gc2RXVlBaaWs3WEc0dkx5QXhPUzQwTGpNdU5TQlRlVzFpYjJ3dWNISnZkRzkwZVhCbFcwQkFkRzlUZEhKcGJtZFVZV2RkWEc1elpYUlViMU4wY21sdVoxUmhaeWdrVTNsdFltOXNMQ0FuVTNsdFltOXNKeWs3WEc0dkx5QXlNQzR5TGpFdU9TQk5ZWFJvVzBCQWRHOVRkSEpwYm1kVVlXZGRYRzV6WlhSVWIxTjBjbWx1WjFSaFp5aE5ZWFJvTENBblRXRjBhQ2NzSUhSeWRXVXBPMXh1THk4Z01qUXVNeTR6SUVwVFQwNWJRRUIwYjFOMGNtbHVaMVJoWjExY2JuTmxkRlJ2VTNSeWFXNW5WR0ZuS0dkc2IySmhiQzVLVTA5T0xDQW5TbE5QVGljc0lIUnlkV1VwTzF4dVhHNWNiaTh2THk4dkx5OHZMeTh2THk4dkx5OHZMMXh1THk4Z1YwVkNVRUZEU3lCR1QwOVVSVkpjYmk4dklDNHZmaTlqYjNKbExXcHpMMnhwWW5KaGNua3ZiVzlrZFd4bGN5OWxjell1YzNsdFltOXNMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F4TURWY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklpd2ljbVZ4ZFdseVpTZ25MaTlmZDJ0ekxXUmxabWx1WlNjcEtDZGhjM2x1WTBsMFpYSmhkRzl5SnlrN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMlZ6Tnk1emVXMWliMnd1WVhONWJtTXRhWFJsY21GMGIzSXVhbk5jYmk4dklHMXZaSFZzWlNCcFpDQTlJREV3Tmx4dUx5OGdiVzlrZFd4bElHTm9kVzVyY3lBOUlEQWdNU0F5SURNaUxDSnlaWEYxYVhKbEtDY3VMMTkzYTNNdFpHVm1hVzVsSnlrb0oyOWljMlZ5ZG1GaWJHVW5LVHRjYmx4dVhHNHZMeTh2THk4dkx5OHZMeTh2THk4dkx5OWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNYRzR2THlBdUwzNHZZMjl5WlMxcWN5OXNhV0p5WVhKNUwyMXZaSFZzWlhNdlpYTTNMbk41YldKdmJDNXZZbk5sY25aaFlteGxMbXB6WEc0dkx5QnRiMlIxYkdVZ2FXUWdQU0F4TURkY2JpOHZJRzF2WkhWc1pTQmphSFZ1YTNNZ1BTQXdJREVnTWlBeklpd2lMeW9xWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZCVUlFbHViM1podzZmRG8yOGdaU0JUYVhOMFpXMWhjeUJUUVZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCSlRrVlRReTFKUkZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCUlZVOUNTVk1nVGtWVVYwOVNTMU1nVTB4Y2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1JsSkJWVTVJVDBaRlVpMUhSVk5GVEV4VFEwaEJSbFFnV2xWU0lFWlBSVkpFUlZKVlRrY2dSRVZTSUVGT1IwVlhRVTVFVkVWT0lFWlBVbE5EU0ZWT1J5QkZMbFpjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVDFKQlRrZEZJRk5CWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVSbGRYUnpZMmhsSUZSbGJHVnJiMjBnUVVkY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1FYQnBlbVZsWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZSRlEwaE9TVk5EU0VVZ1ZVNUpWa1ZTVTBsVVFWUWdRa1ZTVEVsT1hHNHFYRzRxSUV4cFkyVnVjMlZrSUhWdVpHVnlJSFJvWlNCQmNHRmphR1VnVEdsalpXNXpaU3dnVm1WeWMybHZiaUF5TGpBZ0tIUm9aU0JjSWt4cFkyVnVjMlZjSWlrN1hHNHFJSGx2ZFNCdFlYa2dibTkwSUhWelpTQjBhR2x6SUdacGJHVWdaWGhqWlhCMElHbHVJR052YlhCc2FXRnVZMlVnZDJsMGFDQjBhR1VnVEdsalpXNXpaUzVjYmlvZ1dXOTFJRzFoZVNCdlluUmhhVzRnWVNCamIzQjVJRzltSUhSb1pTQk1hV05sYm5ObElHRjBYRzRxWEc0cUlDQWdhSFIwY0RvdkwzZDNkeTVoY0dGamFHVXViM0puTDJ4cFkyVnVjMlZ6TDB4SlEwVk9VMFV0TWk0d1hHNHFYRzRxSUZWdWJHVnpjeUJ5WlhGMWFYSmxaQ0JpZVNCaGNIQnNhV05oWW14bElHeGhkeUJ2Y2lCaFozSmxaV1FnZEc4Z2FXNGdkM0pwZEdsdVp5d2djMjltZEhkaGNtVmNiaW9nWkdsemRISnBZblYwWldRZ2RXNWtaWElnZEdobElFeHBZMlZ1YzJVZ2FYTWdaR2x6ZEhKcFluVjBaV1FnYjI0Z1lXNGdYQ0pCVXlCSlUxd2lJRUpCVTBsVExGeHVLaUJYU1ZSSVQxVlVJRmRCVWxKQlRsUkpSVk1nVDFJZ1EwOU9SRWxVU1U5T1V5QlBSaUJCVGxrZ1MwbE9SQ3dnWldsMGFHVnlJR1Y0Y0hKbGMzTWdiM0lnYVcxd2JHbGxaQzVjYmlvZ1UyVmxJSFJvWlNCTWFXTmxibk5sSUdadmNpQjBhR1VnYzNCbFkybG1hV01nYkdGdVozVmhaMlVnWjI5MlpYSnVhVzVuSUhCbGNtMXBjM05wYjI1eklHRnVaRnh1S2lCc2FXMXBkR0YwYVc5dWN5QjFibVJsY2lCMGFHVWdUR2xqWlc1elpTNWNiaW9xTDF4dUx5b3FYRzRnS2lCVGRYQndiM0owSUcxdlpIVnNaU0IzYVhSb0lITnZiV1VnWm5WdVkzUnBiMjV6SUhkcGJHd2dZbVVnZFhObFpuVnNYRzRnS2lCQWJXOWtkV3hsSUhWMGFXeHpYRzRnS2k5Y2JseHVMeW9xWEc0Z0tpQkFkSGx3WldSbFppQmthWFpwWkdWVlVreGNiaUFxSUVCMGVYQmxJRTlpYW1WamRGeHVJQ29nUUhCeWIzQmxjblI1SUh0emRISnBibWQ5SUhSNWNHVWdWR2hsSUhSNWNHVWdiMllnVlZKTVhHNGdLaUJBY0hKdmNHVnlkSGtnZTNOMGNtbHVaMzBnWkc5dFlXbHVJRlJvWlNCa2IyMWhhVzRnYjJZZ1ZWSk1YRzRnS2lCQWNISnZjR1Z5ZEhrZ2UzTjBjbWx1WjMwZ2FXUmxiblJwZEhrZ1ZHaGxJR2xrWlc1MGFYUjVJRzltSUZWU1RGeHVJQ292WEc1Y2JpOHFLbHh1SUNvZ1JHbDJhV1JsSUdGdUlIVnliQ0JwYmlCMGVYQmxMQ0JrYjIxaGFXNGdZVzVrSUdsa1pXNTBhWFI1WEc0Z0tpQkFjR0Z5WVcwZ0lIdFZVa3d1VlZKTWZTQjFjbXdnTFNCMWNtd2dZV1JrY21WemMxeHVJQ29nUUhKbGRIVnliaUI3WkdsMmFXUmxWVkpNZlNCMGFHVWdjbVZ6ZFd4MElHOW1JR1JwZG1sa1pWVlNURnh1SUNvdlhHNWxlSEJ2Y25RZ1puVnVZM1JwYjI0Z1pHbDJhV1JsVlZKTUtIVnliQ2tnZTF4dVhHNGdJR2xtSUNnaGRYSnNLU0IwYUhKdmR5QkZjbkp2Y2lnblZWSk1JR2x6SUc1bFpXUmxaQ0IwYnlCemNHeHBkQ2NwTzF4dVhHNWNkR1oxYm1OMGFXOXVJSEpsWTNWeWMyVW9kbUZzZFdVcElIdGNibHgwWEhSamIyNXpkQ0J5WldkbGVDQTlJQzhvVzJFdGVrRXRXaTFkS2lrb09seGNMMXhjTHlnL09seGNMaWsvZkRvcEtGc3RZUzE2UVMxYU1DMDVRRG9sTGw5Y1hDdCtJejFkZXpJc01qVTJmU2tvV3kxaExYcEJMVm93TFRsQU9pVXVYMXhjSzM0alBWeGNMMTBxS1M5bmFUdGNiaUFnSUNCamIyNXpkQ0J6ZFdKemRDQTlJQ2NrTVN3a015d2tOQ2M3WEc1Y2RDQWdiR1YwSUhCaGNuUnpJRDBnZG1Gc2RXVXVjbVZ3YkdGalpTaHlaV2RsZUN3Z2MzVmljM1FwTG5Od2JHbDBLQ2NzSnlrN1hHNWNkRngwY21WMGRYSnVJSEJoY25Sek8xeHVYSFI5WEc1Y2JseDBiR1YwSUhCaGNuUnpJRDBnY21WamRYSnpaU2gxY213cE8xeHVYRzRnSUM4dklFbG1JSFJvWlNCMWNtd2dhR0Z6SUc1dklITmphR1Z0WlZ4dUlDQnBaaUFvY0dGeWRITmJNRjBnUFQwOUlIVnliQ0FtSmlBaGNHRnlkSE5iTUYwdWFXNWpiSFZrWlhNb0owQW5LU2tnZTF4dVhHNGdJQ0FnYkdWMElISmxjM1ZzZENBOUlIdGNiaUFnSUNBZ0lIUjVjR1U2SUZ3aVhDSXNYRzRnSUNBZ0lDQmtiMjFoYVc0NklIVnliQ3hjYmlBZ0lDQWdJR2xrWlc1MGFYUjVPaUJjSWx3aVhHNGdJQ0FnZlR0Y2JseHVJQ0FnSUdOdmJuTnZiR1V1WlhKeWIzSW9KMXRFYVhacFpHVlZVa3hkSUVScGRtbGtaVlZTVENCa2IyNWNYQ2QwSUhOMWNIQnZjblFnZFhKc0lIZHBkR2h2ZFhRZ2MyTm9aVzFsTGlCUWJHVmhjMlVnY21WMmFXVjNJSGx2ZFhJZ2RYSnNJR0ZrWkhKbGMzTW5MQ0IxY213cE8xeHVYRzRnSUNBZ2NtVjBkWEp1SUhKbGMzVnNkRHRjYmlBZ2ZWeHVYRzVjZEM4dklHTm9aV05ySUdsbUlIUm9aU0IxY213Z2FHRnpJSFJvWlNCelkyaGxiV1VnWVc1a0lHbHVZMngxWkdWeklHRnVJRUJjYmx4MGFXWWdLSEJoY25Seld6QmRJRDA5UFNCMWNtd2dKaVlnY0dGeWRITmJNRjB1YVc1amJIVmtaWE1vSjBBbktTa2dlMXh1WEhSY2RHeGxkQ0J6WTJobGJXVWdQU0J3WVhKMGMxc3dYU0E5UFQwZ2RYSnNJRDhnSjNOdGRIQW5JRG9nY0dGeWRITmJNRjA3WEc1Y2RGeDBjR0Z5ZEhNZ1BTQnlaV04xY25ObEtITmphR1Z0WlNBcklDYzZMeThuSUNzZ2NHRnlkSE5iTUYwcE8xeHVYSFI5WEc1Y2JseDBMeThnYVdZZ2RHaGxJR1J2YldGcGJpQnBibU5zZFdSbGN5QmhiaUJBTENCa2FYWnBaR1VnYVhRZ2RHOGdaRzl0WVdsdUlHRnVaQ0JwWkdWdWRHbDBlU0J5WlhOd1pXTjBhWFpsYkhsY2JseDBhV1lnS0hCaGNuUnpXekZkTG1sdVkyeDFaR1Z6S0NkQUp5a3BJSHRjYmx4MFhIUndZWEowYzFzeVhTQTlJSEJoY25Seld6QmRJQ3NnSnpvdkx5Y2dLeUJ3WVhKMGMxc3hYVHRjYmx4MFhIUndZWEowYzFzeFhTQTlJSEJoY25Seld6RmRMbk4xWW5OMGNpaHdZWEowYzFzeFhTNXBibVJsZUU5bUtDZEFKeWtnS3lBeEtWeHVJQ0FnSUgwZ1hIUXZLbVZzYzJVZ2FXWWdLSEJoY25Seld6SmRMbWx1WTJ4MVpHVnpLQ2N2SnlrcElIdGNiaUFnSUNCd1lYSjBjMXN5WFNBOUlIQmhjblJ6V3pKZExuTjFZbk4wY2lod1lYSjBjMXN5WFM1c1lYTjBTVzVrWlhoUFppZ25MeWNwS3pFcE8xeHVJQ0I5S2k5Y2JseHVJQ0JzWlhRZ2NtVnpkV3gwSUQwZ2UxeHVJQ0FnSUhSNWNHVTZJSEJoY25Seld6QmRMRnh1SUNBZ0lHUnZiV0ZwYmpvZ2NHRnlkSE5iTVYwc1hHNGdJQ0FnYVdSbGJuUnBkSGs2SUhCaGNuUnpXekpkWEc0Z0lIMDdYRzVjYmlBZ2NtVjBkWEp1SUhKbGMzVnNkRHRjYm4xY2JseHVaWGh3YjNKMElHWjFibU4wYVc5dUlHUnBkbWxrWlVWdFlXbHNLR1Z0WVdsc0tTQjdYRzRnSUd4bGRDQnBibVJsZUU5bVFYUWdQU0JsYldGcGJDNXBibVJsZUU5bUtDZEFKeWs3WEc1Y2JpQWdiR1YwSUhKbGMzVnNkQ0E5SUh0Y2JpQWdJQ0IxYzJWeWJtRnRaVG9nWlcxaGFXd3VjM1ZpYzNSeWFXNW5LREFzSUdsdVpHVjRUMlpCZENrc1hHNGdJQ0FnWkc5dFlXbHVPaUJsYldGcGJDNXpkV0p6ZEhKcGJtY29hVzVrWlhoUFprRjBJQ3NnTVN3Z1pXMWhhV3d1YkdWdVozUm9LVnh1SUNCOU8xeHVYRzRnSUhKbGRIVnliaUJ5WlhOMWJIUTdYRzU5WEc1Y2JpOHFLbHh1SUNvZ1EyaGxZMnNnYVdZZ1lXNGdUMkpxWldOMElHbHpJR1Z0Y0hSNVhHNGdLaUJBY0dGeVlXMGdJSHRQWW1wbFkzUjlJRzlpYW1WamRDQlBZbXBsWTNRZ2RHOGdZbVVnWTJobFkydGxaRnh1SUNvZ1FISmxkSFZ5YmlCN1FtOXZiR1ZoYm4wZ0lDQWdJQ0FnYzNSaGRIVnpJRzltSUU5aWFtVmpkQ3dnWlcxd2RIa2diM0lnYm05MElDaDBjblZsZkdaaGJITmxLVHRjYmlBcUwxeHVaWGh3YjNKMElHWjFibU4wYVc5dUlHVnRjSFI1VDJKcVpXTjBLRzlpYW1WamRDa2dlMXh1SUNCeVpYUjFjbTRnVDJKcVpXTjBMbXRsZVhNb2IySnFaV04wS1M1c1pXNW5kR2dnUGlBd0lEOGdabUZzYzJVZ09pQjBjblZsTzF4dWZWeHVYRzR2S2lwY2JpQXFJRTFoYTJVZ1lTQkRUMUJaSUc5bUlIUm9aU0J2Y21sbmFXNWhiQ0JrWVhSaFhHNGdLaUJBY0dGeVlXMGdJSHRQWW1wbFkzUjlJQ0J2WW1vZ0xTQnZZbXBsWTNRZ2RHOGdZbVVnWTJ4dmJtVmtYRzRnS2lCQWNtVjBkWEp1SUh0UFltcGxZM1I5WEc0Z0tpOWNibVY0Y0c5eWRDQm1kVzVqZEdsdmJpQmtaV1Z3UTJ4dmJtVW9iMkpxS1NCN1hHNGdJQzh2VkU5RVR6b2djMmx0Y0d4bElHSjFkQ0JwYm1WbVptbGphV1Z1ZENCS1UwOU9JR1JsWlhBZ1kyeHZibVV1TGk1Y2JpQWdhV1lnS0c5aWFpa2djbVYwZFhKdUlFcFRUMDR1Y0dGeWMyVW9TbE5QVGk1emRISnBibWRwWm5rb2IySnFLU2s3WEc1OVhHNWNiaThxS2x4dUlDb2dUMkowWVdsdWN5QjBhR1VnZFhObGNpQlZVa3dnZEdoaGRDQmpiM0p5WlhOd2IyNWtjeUIwYnlCaElHZHBkbVZ1SUdWdFlXbHNYRzRnS2lCQWNHRnlZVzBnSUh0emRISnBibWQ5SUhWelpYSkZiV0ZwYkNCVWFHVWdkWE5sY2lCbGJXRnBiRnh1SUNvZ1FISmxkSFZ5YmlCN1ZWSk1MbFZTVEgwZ2RYTmxjbFZTVENCVWFHVWdkWE5sY2lCVlVreGNiaUFxTDF4dVpYaHdiM0owSUdaMWJtTjBhVzl1SUdkbGRGVnpaWEpWVWt4R2NtOXRSVzFoYVd3b2RYTmxja1Z0WVdsc0tTQjdYRzRnSUd4bGRDQnBibVJsZUU5bVFYUWdQU0IxYzJWeVJXMWhhV3d1YVc1a1pYaFBaaWduUUNjcE8xeHVJQ0J5WlhSMWNtNGdKM1Z6WlhJNkx5OG5JQ3NnZFhObGNrVnRZV2xzTG5OMVluTjBjbWx1WnlocGJtUmxlRTltUVhRZ0t5QXhMQ0IxYzJWeVJXMWhhV3d1YkdWdVozUm9LU0FySUNjdkp5QXJJSFZ6WlhKRmJXRnBiQzV6ZFdKemRISnBibWNvTUN3Z2FXNWtaWGhQWmtGMEtUdGNibjFjYmx4dUx5b3FYRzRnS2lCUFluUmhhVzV6SUhSb1pTQjFjMlZ5SUdWdFlXbHNJSFJvWVhRZ1kyOXljbVZ6Y0c5dVpITWdkRzhnWVNCbmFYWmxiaUJWVWt4Y2JpQXFJRUJ3WVhKaGJTQWdlMVZTVEM1VlVreDlJSFZ6WlhKVlVrd2dWR2hsSUhWelpYSWdWVkpNWEc0Z0tpQkFjbVYwZFhKdUlIdHpkSEpwYm1kOUlIVnpaWEpGYldGcGJDQlVhR1VnZFhObGNpQmxiV0ZwYkZ4dUlDb3ZYRzVsZUhCdmNuUWdablZ1WTNScGIyNGdaMlYwVlhObGNrVnRZV2xzUm5KdmJWVlNUQ2gxYzJWeVZWSk1LU0I3WEc0Z0lHeGxkQ0IxY213Z1BTQmthWFpwWkdWVlVrd29kWE5sY2xWU1RDazdYRzRnSUhKbGRIVnliaUIxY213dWFXUmxiblJwZEhrdWNtVndiR0ZqWlNnbkx5Y3NJQ2NuS1NBcklDZEFKeUFySUhWeWJDNWtiMjFoYVc0N0lDOHZJR2xrWlc1MGFYUjVJR1pwWld4a0lHaGhjeUFuTDJWNFlXMXdiR1ZKUkNjZ2FXNXpkR1ZoWkNCdlppQW5aWGhoYlhCc1pVbEVKMXh1ZlZ4dVhHNWNiaThxS2x4dUlDb2dRMmhsWTJzZ2FXWWdkR2hsSUhWelpYSWdhV1JsYm5ScFptbGxjaUJwY3lCaGJISmxZV1I1SUdsdUlIUm9aU0JWVWt3Z1ptOXliV0YwTENCcFppQnViM1FzSUdOdmJuWmxjblFnZEc4Z1ZWSk1JR1p2Y20xaGRGeHVJQ29nUUhCaGNtRnRJQ0I3YzNSeWFXNW5mU0FnSUdsa1pXNTBhV1pwWlhJZ0lIVnpaWElnYVdSbGJuUnBabWxsY2x4dUlDb2dRSEpsZEhWeWJpQjdjM1J5YVc1bmZTQWdJSFZ6WlhKVlVrd2dJQ0FnZEdobElIVnpaWElnVlZKTVhHNGdLaTljYm1WNGNHOXlkQ0JtZFc1amRHbHZiaUJqYjI1MlpYSjBWRzlWYzJWeVZWSk1LR2xrWlc1MGFXWnBaWElwSUh0Y2JseHVJQ0F2THlCamFHVmpheUJwWmlCMGFHVWdhV1JsYm5ScFptbGxjaUJwY3lCaGJISmxZV1I1SUdsdUlIUm9aU0IxY213Z1ptOXliV0YwWEc0Z0lHbG1JQ2hwWkdWdWRHbG1hV1Z5TG5OMVluTjBjbWx1Wnlnd0xDQTNLU0E5UFQwZ0ozVnpaWEk2THk4bktTQjdYRzRnSUNBZ2JHVjBJR1JwZG1sa1pXUlZVa3dnUFNCa2FYWnBaR1ZWVWt3b2FXUmxiblJwWm1sbGNpazdYRzVjYmlBZ0lDQXZMMk5vWldOcklHbG1JSFJvWlNCMWNtd2dhWE1nZDJWc2JDQm1iM0p0WVhSbFpGeHVJQ0FnSUdsbUlDaGthWFpwWkdWa1ZWSk1MbVJ2YldGcGJpQW1KaUJrYVhacFpHVmtWVkpNTG1sa1pXNTBhWFI1S1NCN1hHNGdJQ0FnSUNCeVpYUjFjbTRnYVdSbGJuUnBabWxsY2p0Y2JpQWdJQ0I5SUdWc2MyVWdlMXh1SUNBZ0lDQWdkR2h5YjNjZ0ozVnpaWEpWVWt3Z2QybDBhQ0IzY205dVp5Qm1iM0p0WVhRbk8xeHVJQ0FnSUgxY2JseHVJQ0F2TDJsbUlHNXZkQ3dnWTI5dWRtVnlkQ0IwYUdVZ2RYTmxjaUJsYldGcGJDQjBieUJWVWt3Z1ptOXliV0YwWEc0Z0lIMGdaV3h6WlNCN1hHNGdJQ0FnY21WMGRYSnVJR2RsZEZWelpYSlZVa3hHY205dFJXMWhhV3dvYVdSbGJuUnBabWxsY2lrN1hHNGdJSDFjYm4xY2JseHVYRzVjYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTSUM4dlhHNHZMeUF1TDNOeVl5OTFkR2xzY3k5MWRHbHNjeTVxY3lJc0lpOHZJQ0FnSUNCd2NtOTRlUzF2WW5ObGNuWmxJSFl3TGpBdU1UaGNjbHh1THk4Z0lDQWdJRU52Y0hseWFXZG9kQ0FvWXlrZ01qQXhOU3dnTWpBeE5pQlRhVzF2YmlCWkxpQkNiR0ZqYTNkbGJHd3NJRUZ1ZVZkb2FXTm9WMkY1WEhKY2JpOHZJQ0FnSUNCTlNWUWdUR2xqWlc1elpTQXRJR2gwZEhBNkx5OXZjR1Z1YzI5MWNtTmxMbTl5Wnk5c2FXTmxibk5sY3k5dGFYUXRiR2xqWlc1elpTNXdhSEJjY2x4dUtHWjFibU4wYVc5dUtDa2dlMXh5WEc1Y2RGd2lkWE5sSUhOMGNtbGpkRndpTzF4eVhHNWNkQzh2SUVOeVpXRjBaWE1nWVc1a0lISmxkSFZ5Ym5NZ1lTQlFjbTk0ZVNCM2NtRndjR2x1WnlCaElIUmhjbWRsZENCemJ5QjBhR0YwSUdGc2JDQmphR0Z1WjJWeklHTmhiaUJpWlNCMGNtRndjR1ZrSUdGdVpDQm1iM0ozWVhKa1pXUWdkRzljY2x4dVhIUXZMeUJoSUdOaGJHeGlZV05yTGlCVWFHVWdZMkZzYkdKaFkyc2dkR0ZyWlhNZ1lXNGdZWEp5WVhrZ2IyWWdZMmhoYm1kbGN5QnFkWE4wSUd4cGEyVWdkR2hsSUhSeVlXUnBkR2x2Ym1Gc0lHOXlhV2RwYm1Gc0lFTm9jbTl0WlNCUFltcGxZM1F1YjJKelpYSjJaVnh5WEc1Y2RDOHZJSHR2WW1wbFkzUTZQRzlpYW1WamRDQmphR0Z1WjJWa1BpeHVZVzFsT2p4bWFXVnNaQ0JqYUdGdVoyVmtQaXgwZVhCbE9tRmtaSHgxY0dSaGRHVjhaR1ZzWlhSbGZISmxZMjl1Wm1sbmRYSmxmSEJ5WlhabGJuUkZlSFJsYm5OcGIyNXpmSE5sZEZCeWIzUnZkSGx3WlN4dmJHUldZV3gxWlRvOGIyeGtJSFpoYkhWbElHbG1JSFZ3WkdGMFpTQjhJR1JsYkdWMFpUNTlYSEpjYmx4MEx5OGdWR2hsSUdGalkyVndkR3hwYzNRZ1kyRnVJR0psSUdGa1pIeDFjR1JoZEdWOFpHVnNaWFJsZkhKbFkyOXVabWxuZFhKbGZIQnlaWFpsYm5SRmVIUmxibk5wYjI1emZITmxkRkJ5YjNSdmRIbHdaUzVjY2x4dVhIUXZMeUIySURBdU1DNHhNQ0IwYnlCemRYQndiM0owSUhCaGRYTnBibWNnWVc1a0lISmxjM1JoY25ScGJtY2diMkp6WlhKMllYUnBiMjRnZEhkdklHRmtaR2wwYVc5dVlXd2dZMjl1YzNSeWRXTjBiM0lnWVhKbmRXMWxiblJ6SUdGeVpTQmhkbUZwYkdGaWJHVWdkRzhnVDJKcVpXTjBMbTlpYzJWeWRtVTZYSEpjYmx4MEx5OGdjR0YxYzJGaWJHVWdMU0JqY21WaGRHVWdkR2hsSUU5aWMyVnlkbVZ5SUhOdklHbDBJR05oYmlCaVpTQndZWFZ6WldSY2NseHVYSFF2THlCd1lYVnpaU0F0SUdOeVpXRjBaU0J2WW5ObGNuWmxjaUJwYmlCd1lYVnpaV1FnYzNSaGRHVmNjbHh1WEhRdkx5QnBaaUJ3WVhWellXSnNaU0JwY3lCMGNuVmxJSFJvWlc0Z1lXNGdZV1JrYVhScGIyNWhiQ0J0WlhSb2IyUWdaR1ZzYVhabGNpaHBaMjV2Y21WUWNtVjJhVzkxY3lrZ2FYTWdZWFpoYVd4aFlteGxJSFJ2SUhOMFlYSjBJR1JsYkdsMlpYSjVYSEpjYmx4MEx5OGdkRzhnY0dGMWMyVWdaR1ZzYVhabGNua2djMlYwSUdFZ2NISnZjR1Z5ZEhrZ1kyRnNiR1ZrSUhCaGRYTmxJRzl1SUhSb1pTQm1kVzVqZEdsdmJpQmtaV3hwZG1WeUlIUnZJSFJ5ZFdWY2NseHVYSFF2THlCd1lYVnpZV0pzWlNCcGN5QnZjSFJwYjI1aGJDQjBieUJ5WldSMVkyVWdkR2hsSUdOb1lXNWpaU0J2WmlCemFHRmtiM2RwYm1jZ1lTQndjbTl3WlhKMGVTQnZjaUJ0WlhSb2IyUWdiMjRnWVc1NUlHVjRhWE4wYVc1bklHTnZaR1VnWTJGc2JHVmtJR1JsYkdsMlpYSmNjbHh1WEhScFppZ2hUMkpxWldOMExtOWljMlZ5ZG1VZ0ppWWdkSGx3Wlc5bUtGQnliM2g1S1QwOVBWd2lablZ1WTNScGIyNWNJaWtnZTF4eVhHNWNkRngwWm5WdVkzUnBiMjRnVDJKelpYSjJaWElvZEdGeVoyVjBMR05oYkd4aVlXTnJMR0ZqWTJWd2RHeHBjM1FzY0dGMWMyRmliR1VzY0dGMWMyVXNaR1ZzWVhrcElIdGNjbHh1WEhRZ0lDQWdYSFIyWVhJZ2JXVWdQU0IwYUdsekxDQndjbTk0ZVR0Y2NseHVYSFFnSUNBZ1hIUm1kVzVqZEdsdmJpQmtaV3hwZG1WeUtHbG5ibTl5WlZCeVpYWnBiM1Z6TEdSbGJHRjVLU0I3WEhKY2JseDBJQ0FnSUZ4MFhIUmtaV3hwZG1WeUxtUmxiR0Y1SUQwZ1pHVnNZWGs3WEhKY2JseDBJQ0FnSUZ4MFhIUnBaaWdoWkdWc2FYWmxjaTV3WVhWelpTa2dlMXh5WEc1Y2RDQWdJQ0FnSUNBZ1hIUmNkR2xtS0cxbExtTm9ZVzVuWlhObGRDNXNaVzVuZEdnK01Da2dlMXh5WEc1Y2RDQWdJQ0FnSUNBZ1hIUmNkRngwYVdZb0lXbG5ibTl5WlZCeVpYWnBiM1Z6S1NCN1hISmNibHgwWEhRZ0lDQWdYSFFnSUNBZ1hIUmNkSFpoY2lCamFHRnVaMlZ6SUQwZ2JXVXVZMmhoYm1kbGMyVjBMbVpwYkhSbGNpaG1kVzVqZEdsdmJpaGphR0Z1WjJVcElIc2djbVYwZFhKdUlDRmhZMk5sY0hSc2FYTjBJSHg4SUdGalkyVndkR3hwYzNRdWFXNWtaWGhQWmloamFHRnVaMlV1ZEhsd1pTaytQVEE3SUgwcE8xeHlYRzVjZEZ4MElDQWdJQ0FnSUNCY2RGeDBYSFJwWmloamFHRnVaMlZ6TG14bGJtZDBhRDR3S1NCN1hISmNibHgwWEhRZ0lDQWdJQ0FnSUZ4MFhIUmNkRngwWTJGc2JHSmhZMnNvWTJoaGJtZGxjeWs3WEhKY2JseDBYSFFnSUNBZ0lDQWdJRngwWEhSY2RIMWNjbHh1WEhRZ0lDQWdJQ0FnSUZ4MFhIUmNkSDFjY2x4dVhIUWdJQ0FnSUNBZ0lGeDBYSFJjZEcxbExtTm9ZVzVuWlhObGRDQTlJRnRkTzF4eVhHNWNkQ0FnSUNBZ0lDQWdYSFJjZEgxY2NseHVYSFFnSUNBZ1hIUmNkSDFjY2x4dVhIUWdJQ0FnWEhSOVhISmNibHgwSUNBZ0lGeDBaR1ZzYVhabGNpNXdZWFZ6WlNBOUlIQmhkWE5sTzF4eVhHNWNkQ0FnSUNCY2RHUmxiR2wyWlhJdVpHVnNZWGtnUFNCa1pXeGhlVHRjY2x4dVhIUmNkQ0FnSUNCdFpTNW5aWFFnUFNCbWRXNWpkR2x2YmloMFlYSm5aWFFzSUhCeWIzQmxjblI1S1NCN1hISmNibHgwWEhRZ0lDQWdYSFJwWmlod2NtOXdaWEowZVQwOVBWd2lYMTl2WW5ObGNuWmxjbDlmWENJcElIdGNjbHh1WEhSY2RDQWdJQ0JjZEZ4MGNtVjBkWEp1SUcxbE8xeHlYRzVjZEZ4MElDQWdJRngwZlZ4eVhHNWNkRngwSUNBZ0lGeDBhV1lvY0hKdmNHVnlkSGs5UFQxY0luVnViMkp6WlhKMlpWd2lLU0I3WEhKY2JseDBYSFFnSUNBZ1hIUmNkSEpsZEhWeWJpQm1kVzVqZEdsdmJpZ3BJSHRjY2x4dVhIUmNkQ0FnSUNCY2RGeDBYSFJQWW1wbFkzUXVkVzV2WW5ObGNuWmxLSFJoY21kbGRDazdYSEpjYmx4MFhIUWdJQ0FnWEhSY2RGeDBjbVYwZFhKdUlIUmhjbWRsZER0Y2NseHVYSFJjZENBZ0lDQmNkRngwZlR0Y2NseHVYSFJjZENBZ0lDQmNkSDFjY2x4dVhIUmNkQ0FnSUNCY2RHbG1LSEJ5YjNCbGNuUjVQVDA5WENKa1pXeHBkbVZ5WENJcElIdGNjbHh1WEhSY2RDQWdJQ0JjZEZ4MGNtVjBkWEp1SUdSbGJHbDJaWEk3WEhKY2JseDBYSFFnSUNBZ1hIUjlYSEpjYmx4MFhIUWdJQ0FnWEhSeVpYUjFjbTRnZEdGeVoyVjBXM0J5YjNCbGNuUjVYVHRjY2x4dVhIUmNkQ0FnSUNCOVhISmNibHgwSUNBZ0lGeDBiV1V1ZEdGeVoyVjBJRDBnZEdGeVoyVjBPMXh5WEc1Y2RDQWdJQ0JjZEcxbExtTm9ZVzVuWlhObGRDQTlJRnRkTzF4eVhHNWNkQ0FnSUNCY2RHbG1LQ0Z0WlM1MFlYSm5aWFF1WDE5dlluTmxjblpsY2tOaGJHeGlZV05yYzE5ZktTQjdYSEpjYmx4MElDQWdJRngwWEhRdkx5QmZYMjlpYzJWeWRtVnlRMkZzYkdKaFkydHpYMThnYVhNZ2RYTmxaQ0JoY3lCaGJpQnBibVJsZUNCMGJ5Qm5aWFFnWVhRZ2RHaGxJSEJ5YjNoNUlIZG9hV05vSUdseklIUm9aU0J2WW5ObGNuWmxjaXdnYzI4Z2QyVWdZMkZ1SUhWdWIySnpaWEoyWlZ4eVhHNWNkQ0FnSUNCY2RGeDBUMkpxWldOMExtUmxabWx1WlZCeWIzQmxjblI1S0hSaGNtZGxkQ3hjSWw5ZmIySnpaWEoyWlhKRFlXeHNZbUZqYTNOZlgxd2lMSHRsYm5WdFpYSmhZbXhsT21aaGJITmxMR052Ym1acFozVnlZV0pzWlRwMGNuVmxMSGR5YVhSaFlteGxPbVpoYkhObExIWmhiSFZsT2x0ZGZTazdYSEpjYmx4MElDQWdJRngwWEhSUFltcGxZM1F1WkdWbWFXNWxVSEp2Y0dWeWRIa29kR0Z5WjJWMExGd2lYMTl2WW5ObGNuWmxjbk5mWDF3aUxIdGxiblZ0WlhKaFlteGxPbVpoYkhObExHTnZibVpwWjNWeVlXSnNaVHAwY25WbExIZHlhWFJoWW14bE9tWmhiSE5sTEhaaGJIVmxPbHRkZlNrN1hISmNibHgwSUNBZ0lGeDBmVnh5WEc1Y2RDQWdJQ0JjZEcxbExuUmhjbWRsZEM1ZlgyOWljMlZ5ZG1WeVEyRnNiR0poWTJ0elgxOHVjSFZ6YUNoallXeHNZbUZqYXlrN1hISmNibHgwSUNBZ0lGeDBiV1V1ZEdGeVoyVjBMbDlmYjJKelpYSjJaWEp6WDE4dWNIVnphQ2gwYUdsektUdGNjbHh1WEhRZ0lDQWdYSFJ3Y205NGVTQTlJRzVsZHlCUWNtOTRlU2gwWVhKblpYUXNiV1VwTzF4eVhHNWNkQ0FnSUNCY2RHUmxiR2wyWlhJb1ptRnNjMlVzWkdWc1lYa3BPMXh5WEc1Y2RDQWdJQ0JjZEhKbGRIVnliaUJ3Y205NGVUdGNjbHh1WEhRZ0lDQWdmVnh5WEc1Y2RGeDBUMkp6WlhKMlpYSXVjSEp2ZEc5MGVYQmxMbVJsYkdsMlpYSWdQU0JtZFc1amRHbHZiaWdwSUh0Y2NseHVYSFJjZEZ4MGNtVjBkWEp1SUhSb2FYTXVaMlYwS0c1MWJHd3NYQ0prWld4cGRtVnlYQ0lwTzF4eVhHNWNkRngwZlZ4eVhHNWNkQ0FnSUNCUFluTmxjblpsY2k1d2NtOTBiM1I1Y0dVdWMyVjBJRDBnWm5WdVkzUnBiMjRvZEdGeVoyVjBMQ0J3Y205d1pYSjBlU3dnZG1Gc2RXVXBJSHNnTHk4Z0xDQnlaV05sYVhabGNseHlYRzVjZENBZ0lDQmNkSFpoY2lCdmJHUjJZV3gxWlNBOUlIUmhjbWRsZEZ0d2NtOXdaWEowZVYwN1hISmNibHgwSUNBZ0lGeDBkbUZ5SUhSNWNHVWdQU0FvYjJ4a2RtRnNkV1U5UFQxMWJtUmxabWx1WldRZ1B5QmNJbUZrWkZ3aUlEb2dYQ0oxY0dSaGRHVmNJaWs3WEhKY2JseDBJQ0FnSUZ4MGRHRnlaMlYwVzNCeWIzQmxjblI1WFNBOUlIWmhiSFZsTzF4eVhHNWNkQ0FnSUNCY2RHbG1LSFJoY21kbGRDNWZYMjlpYzJWeWRtVnljMTlmTG1sdVpHVjRUMllvZEdocGN5aytQVEFnSmlZZ0tDRjBhR2x6TG1GalkyVndkR3hwYzNRZ2ZId2dkR2hwY3k1aFkyTmxjSFJzYVhOMExtbHVaR1Y0VDJZb2RIbHdaU2srUFRBcEtTQjdYSEpjYmx4MElDQWdJQ0FnSUNCY2RIWmhjaUJqYUdGdVoyVWdQU0I3YjJKcVpXTjBPblJoY21kbGRDeHVZVzFsT25CeWIzQmxjblI1TEhSNWNHVTZkSGx3Wlgwc1hISmNibHgwSUNBZ0lDQWdJQ0JjZEZ4MGMzUmhjblFnUFNCMGFHbHpMbU5vWVc1blpYTmxkQzVzWlc1bmRHZ2dQVDA5SURBc1hISmNibHgwSUNBZ0lDQWdJQ0JjZEZ4MFpHVnNhWFpsY2lBOUlIUm9hWE11WkdWc2FYWmxjaWdwTzF4eVhHNWNkQ0FnSUNBZ0lDQWdYSFJwWmloMGVYQmxQVDA5WENKMWNHUmhkR1ZjSWlrZ2UxeHlYRzVjZENBZ0lDQWdJQ0FnWEhSY2RHTm9ZVzVuWlM1dmJHUldZV3gxWlNBOUlHOXNaSFpoYkhWbE8xeHlYRzVjZENBZ0lDQWdJQ0FnWEhSOVhISmNibHgwSUNBZ0lDQWdJQ0JjZEhSb2FYTXVZMmhoYm1kbGMyVjBMbkIxYzJnb1kyaGhibWRsS1R0Y2NseHVYSFFnSUNBZ0lDQWdJRngwYVdZb2MzUmhjblFwSUh0Y2NseHVYSFFnSUNBZ0lDQWdJRngwWEhSa1pXeHBkbVZ5S0daaGJITmxMQ2gwZVhCbGIyWW9aR1ZzYVhabGNpNWtaV3hoZVNrOVBUMWNJbTUxYldKbGNsd2lJRDhnWkdWc2FYWmxjaTVrWld4aGVTQTZJREV3S1NrN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEgxY2NseHVYSFFnSUNBZ1hIUjlYSEpjYmx4MElDQWdJRngwY21WMGRYSnVJSFJ5ZFdVN1hISmNibHgwSUNBZ0lIMDdYSEpjYmx4MElDQWdJRTlpYzJWeWRtVnlMbkJ5YjNSdmRIbHdaUzVrWld4bGRHVlFjbTl3WlhKMGVTQTlJR1oxYm1OMGFXOXVLSFJoY21kbGRDd2djSEp2Y0dWeWRIa3BJSHRjY2x4dVhIUWdJQ0FnWEhSMllYSWdiMnhrZG1Gc2RXVWdQU0IwWVhKblpYUmJjSEp2Y0dWeWRIbGRPMXh5WEc1Y2RDQWdJQ0JjZEM4dmFXWW9kSGx3Wlc5bUtHOXNaSFpoYkhWbEtTRTlQVndpZFc1a1pXWnBibVZrWENJcElIdGNjbHh1WEhSY2RDQWdJQ0JjZEdSbGJHVjBaU0IwWVhKblpYUmJjSEp2Y0dWeWRIbGRPMXh5WEc1Y2RGeDBJQ0FnSUZ4MGFXWW9kR0Z5WjJWMExsOWZiMkp6WlhKMlpYSnpYMTh1YVc1a1pYaFBaaWgwYUdsektUNDlNQ0FtSmlBaGRHaHBjeTVoWTJObGNIUnNhWE4wSUh4OElIUm9hWE11WVdOalpYQjBiR2x6ZEM1cGJtUmxlRTltS0Z3aVpHVnNaWFJsWENJcFBqMHdLU0I3WEhKY2JseDBYSFFnSUNBZ0lDQWdJRngwZG1GeUlHTm9ZVzVuWlNBOUlIdHZZbXBsWTNRNmRHRnlaMlYwTEc1aGJXVTZjSEp2Y0dWeWRIa3NkSGx3WlRwY0ltUmxiR1YwWlZ3aUxHOXNaRlpoYkhWbE9tOXNaSFpoYkhWbGZTeGNjbHh1WEhSY2RDQWdJQ0FnSUNBZ1hIUmNkSE4wWVhKMElEMGdkR2hwY3k1amFHRnVaMlZ6WlhRdWJHVnVaM1JvSUQwOVBTQXdMRnh5WEc1Y2RGeDBJQ0FnSUNBZ0lDQmNkRngwWkdWc2FYWmxjaUE5SUhSb2FYTXVaR1ZzYVhabGNpZ3BPMXh5WEc1Y2RGeDBJQ0FnSUNBZ0lDQmNkSFJvYVhNdVkyaGhibWRsYzJWMExuQjFjMmdvWTJoaGJtZGxLVHRjY2x4dVhIUmNkQ0FnSUNBZ0lDQWdYSFJwWmloemRHRnlkQ2tnZTF4eVhHNWNkRngwSUNBZ0lDQWdJQ0JjZEZ4MFpHVnNhWFpsY2lobVlXeHpaU3dvZEhsd1pXOW1LR1JsYkdsMlpYSXVaR1ZzWVhrcFBUMDlYQ0p1ZFcxaVpYSmNJaUEvSUdSbGJHbDJaWEl1WkdWc1lYa2dPaUF4TUNrcE8xeHlYRzVjZEZ4MElDQWdJQ0FnSUNCY2RIMWNjbHh1WEhSY2RDQWdJQ0JjZEgxY2NseHVYSFFnSUNBZ1hIUXZMMzFjY2x4dVhIUWdJQ0FnWEhSeVpYUjFjbTRnZEhKMVpUdGNjbHh1WEhRZ0lDQWdmVHRjY2x4dVhIUWdJQ0FnVDJKelpYSjJaWEl1Y0hKdmRHOTBlWEJsTG1SbFptbHVaVkJ5YjNCbGNuUjVJRDBnWm5WdVkzUnBiMjRvZEdGeVoyVjBMQ0J3Y205d1pYSjBlU3dnWkdWelkzSnBjSFJ2Y2lrZ2UxeHlYRzVjZENBZ0lDQmNkRTlpYW1WamRDNWtaV1pwYm1WUWNtOXdaWEowZVNoMFlYSm5aWFFzSUhCeWIzQmxjblI1TENCa1pYTmpjbWx3ZEc5eUtUdGNjbHh1WEhRZ0lDQWdYSFJwWmloMFlYSm5aWFF1WDE5dlluTmxjblpsY25OZlh5NXBibVJsZUU5bUtIUm9hWE1wUGowd0lDWW1JQ0YwYUdsekxtRmpZMlZ3ZEd4cGMzUWdmSHdnZEdocGN5NWhZMk5sY0hSc2FYTjBMbWx1WkdWNFQyWW9YQ0p5WldOdmJtWnBaM1Z5WlZ3aUtUNDlNQ2tnZTF4eVhHNWNkQ0FnSUNBZ0lDQWdYSFIyWVhJZ1kyaGhibWRsSUQwZ2UyOWlhbVZqZERwMFlYSm5aWFFzYm1GdFpUcHdjbTl3WlhKMGVTeDBlWEJsT2x3aWNtVmpiMjVtYVdkMWNtVmNJbjBzWEhKY2JpQWdJQ0FnSUNBZ1hIUmNkRngwYzNSaGNuUWdQU0IwYUdsekxtTm9ZVzVuWlhObGRDNXNaVzVuZEdnZ1BUMDlJREFzWEhKY2JpQWdJQ0FnSUNBZ1hIUmNkRngwWkdWc2FYWmxjaUE5SUhSb2FYTXVaR1ZzYVhabGNpZ3BPMXh5WEc1Y2RDQWdJQ0FnSUNBZ1hIUjBhR2x6TG1Ob1lXNW5aWE5sZEM1d2RYTm9LR05vWVc1blpTazdYSEpjYmx4MElDQWdJQ0FnSUNCY2RHbG1LSE4wWVhKMEtTQjdYSEpjYmx4MElDQWdJQ0FnSUNCY2RGeDBaR1ZzYVhabGNpaG1ZV3h6WlN3b2RIbHdaVzltS0dSbGJHbDJaWEl1WkdWc1lYa3BQVDA5WENKdWRXMWlaWEpjSWlBL0lHUmxiR2wyWlhJdVpHVnNZWGtnT2lBeE1Da3BPMXh5WEc1Y2RDQWdJQ0FnSUNBZ1hIUjlYSEpjYmx4MElDQWdJRngwZlZ4eVhHNWNkQ0FnSUNCY2RISmxkSFZ5YmlCMGNuVmxPMXh5WEc1Y2RDQWdJQ0I5TzF4eVhHNWNkQ0FnSUNCUFluTmxjblpsY2k1d2NtOTBiM1I1Y0dVdWMyVjBVSEp2ZEc5MGVYQmxUMllnUFNCbWRXNWpkR2x2YmloMFlYSm5aWFFzSUhCeWIzUnZkSGx3WlNrZ2UxeHlYRzVjZENBZ0lDQmNkSFpoY2lCdmJHUjJZV3gxWlNBOUlFOWlhbVZqZEM1blpYUlFjbTkwYjNSNWNHVlBaaWgwWVhKblpYUXBPMXh5WEc1Y2RDQWdJQ0JjZEU5aWFtVmpkQzV6WlhSUWNtOTBiM1I1Y0dWUFppaDBZWEpuWlhRc0lIQnliM1J2ZEhsd1pTazdYSEpjYmx4MElDQWdJRngwYVdZb2RHRnlaMlYwTGw5ZmIySnpaWEoyWlhKelgxOHVhVzVrWlhoUFppaDBhR2x6S1Q0OU1DQW1KaUFoZEdocGN5NWhZMk5sY0hSc2FYTjBJSHg4SUhSb2FYTXVZV05qWlhCMGJHbHpkQzVwYm1SbGVFOW1LRndpYzJWMFVISnZkRzkwZVhCbFhDSXBQajB3S1NCN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEhaaGNpQmphR0Z1WjJVZ1BTQjdiMkpxWldOME9uUmhjbWRsZEN4dVlXMWxPbHdpWDE5d2NtOTBiMTlmWENJc2RIbHdaVHBjSW5ObGRGQnliM1J2ZEhsd1pWd2lMRzlzWkZaaGJIVmxPbTlzWkhaaGJIVmxmU3hjY2x4dUlDQWdJRngwWEhSY2RGeDBjM1JoY25RZ1BTQjBhR2x6TG1Ob1lXNW5aWE5sZEM1c1pXNW5kR2dnUFQwOUlEQXNYSEpjYmlBZ0lDQmNkRngwWEhSY2RHUmxiR2wyWlhJZ1BTQjBhR2x6TG1SbGJHbDJaWElvS1R0Y2NseHVYSFFnSUNBZ0lDQWdJRngwZEdocGN5NWphR0Z1WjJWelpYUXVjSFZ6YUNoamFHRnVaMlVwTzF4eVhHNWNkQ0FnSUNBZ0lDQWdYSFJwWmloemRHRnlkQ2tnZTF4eVhHNWNkQ0FnSUNBZ0lDQWdYSFJjZEdSbGJHbDJaWElvWm1Gc2MyVXNLSFI1Y0dWdlppaGtaV3hwZG1WeUxtUmxiR0Y1S1QwOVBWd2liblZ0WW1WeVhDSWdQeUJrWld4cGRtVnlMbVJsYkdGNUlEb2dNVEFwS1R0Y2NseHVYSFFnSUNBZ0lDQWdJRngwZlZ4eVhHNWNkQ0FnSUNCY2RIMWNjbHh1WEhRZ0lDQWdYSFJ5WlhSMWNtNGdkSEoxWlR0Y2NseHVYSFFnSUNBZ2ZUdGNjbHh1WEhRZ0lDQWdUMkp6WlhKMlpYSXVjSEp2ZEc5MGVYQmxMbkJ5WlhabGJuUkZlSFJsYm5OcGIyNXpJRDBnWm5WdVkzUnBiMjRvZEdGeVoyVjBLU0I3WEhKY2JseDBJQ0FnSUNBZ0lDQlBZbXBsWTNRdWNISmxkbVZ1ZEVWNGRHVnVjMmx2Ym5Nb2RHRnlaMlYwS1R0Y2NseHVYSFFnSUNBZ1hIUnBaaWgwWVhKblpYUXVYMTl2WW5ObGNuWmxjbk5mWHk1cGJtUmxlRTltS0hSb2FYTXBQajB3SUNZbUlDRjBhR2x6TG1GalkyVndkR3hwYzNRZ2ZId2dkR2hwY3k1aFkyTmxjSFJzYVhOMExtbHVaR1Y0VDJZb1hDSndjbVYyWlc1MFJYaDBaVzV6YVc5dWMxd2lLVDQ5TUNrZ2UxeHlYRzVjZENBZ0lDQWdJQ0FnWEhSMllYSWdZMmhoYm1kbElEMGdlMjlpYW1WamREcDBZWEpuWlhRc2RIbHdaVHBjSW5CeVpYWmxiblJGZUhSbGJuTnBiMjV6WENKOUxGeHlYRzVjZEZ4MFhIUmNkRngwYzNSaGNuUWdQU0IwYUdsekxtTm9ZVzVuWlhObGRDNXNaVzVuZEdnZ1BUMDlJREFzWEhKY2JseDBYSFJjZEZ4MFhIUmtaV3hwZG1WeUlEMGdkR2hwY3k1a1pXeHBkbVZ5S0NrN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEhSb2FYTXVZMmhoYm1kbGMyVjBMbkIxYzJnb1kyaGhibWRsS1R0Y2NseHVYSFFnSUNBZ0lDQWdJRngwYVdZb2MzUmhjblFwSUh0Y2NseHVYSFFnSUNBZ0lDQWdJRngwWEhSa1pXeHBkbVZ5S0daaGJITmxMQ2gwZVhCbGIyWW9aR1ZzYVhabGNpNWtaV3hoZVNrOVBUMWNJbTUxYldKbGNsd2lJRDhnWkdWc2FYWmxjaTVrWld4aGVTQTZJREV3S1NrN1hISmNibHgwSUNBZ0lDQWdJQ0JjZEgxY2NseHVYSFFnSUNBZ1hIUjlYSEpjYmx4MElDQWdJRngwY21WMGRYSnVJSFJ5ZFdVN1hISmNibHgwSUNBZ0lIMDdYSEpjYmx4MElDQWdJRTlpYW1WamRDNXZZbk5sY25abElEMGdablZ1WTNScGIyNG9iMkpxWldOMExHTmhiR3hpWVdOckxHRmpZMlZ3ZEd4cGMzUXNjR0YxYzJGaWJHVXNjR0YxYzJVc1pHVnNZWGtwSUh0Y2NseHVYSFFnSUNBZ1hIUnlaWFIxY200Z2JtVjNJRTlpYzJWeWRtVnlLRzlpYW1WamRDeGpZV3hzWW1GamF5eGhZMk5sY0hSc2FYTjBMSEJoZFhOaFlteGxMSEJoZFhObExHUmxiR0Y1S1R0Y2NseHVYSFFnSUNBZ2ZUdGNjbHh1WEhRZ0lDQWdUMkpxWldOMExuVnViMkp6WlhKMlpTQTlJR1oxYm1OMGFXOXVLRzlpYW1WamRDeGpZV3hzWW1GamF5a2dlMXh5WEc1Y2RDQWdJQ0JjZEdsbUtHOWlhbVZqZEM1ZlgyOWljMlZ5ZG1WeVEyRnNiR0poWTJ0elgxOHBJSHRjY2x4dVhIUWdJQ0FnWEhSY2RHbG1LQ0ZqWVd4c1ltRmpheWtnZTF4eVhHNWNkQ0FnSUNCY2RGeDBYSFJ2WW1wbFkzUXVYMTl2WW5ObGNuWmxja05oYkd4aVlXTnJjMTlmTG5Od2JHbGpaU2d3TEc5aWFtVmpkQzVmWDI5aWMyVnlkbVZ5UTJGc2JHSmhZMnR6WDE4dWJHVnVaM1JvS1R0Y2NseHVYSFFnSUNBZ1hIUmNkRngwYjJKcVpXTjBMbDlmYjJKelpYSjJaWEp6WDE4dWMzQnNhV05sS0RBc2IySnFaV04wTGw5ZmIySnpaWEoyWlhKelgxOHViR1Z1WjNSb0tUdGNjbHh1WEhRZ0lDQWdYSFJjZEZ4MGNtVjBkWEp1TzF4eVhHNWNkQ0FnSUNCY2RGeDBmVnh5WEc1Y2RDQWdJQ0JjZEZ4MGIySnFaV04wTGw5ZmIySnpaWEoyWlhKRFlXeHNZbUZqYTNOZlh5NW1iM0pGWVdOb0tHWjFibU4wYVc5dUtHOWljMlZ5ZG1WeVkyRnNiR0poWTJzc2FTa2dlMXh5WEc1Y2RDQWdJQ0JjZEZ4MFhIUnBaaWhqWVd4c1ltRmphejA5UFc5aWMyVnlkbVZ5WTJGc2JHSmhZMnNwSUh0Y2NseHVYSFFnSUNBZ1hIUmNkRngwWEhSdlltcGxZM1F1WDE5dlluTmxjblpsY2tOaGJHeGlZV05yYzE5ZkxuTndiR2xqWlNocExERXBPMXh5WEc1Y2RDQWdJQ0JjZEZ4MFhIUmNkR1JsYkdWMFpTQnZZbXBsWTNRdVgxOXZZbk5sY25abGNuTmZYMXRwWFM1allXeHNZbUZqYXp0Y2NseHVYSFFnSUNBZ1hIUmNkRngwWEhSdlltcGxZM1F1WDE5dlluTmxjblpsY25OZlh5NXpjR3hwWTJVb2FTd3hLVHRjY2x4dVhIUWdJQ0FnWEhSY2RGeDBmVnh5WEc1Y2RDQWdJQ0JjZEZ4MGZTazdYSEpjYmx4MElDQWdJRngwZlZ4eVhHNWNkQ0FnSUNCOU8xeHlYRzVjZENBZ0lDQkJjbkpoZVM1dlluTmxjblpsSUQwZ1puVnVZM1JwYjI0b2IySnFaV04wTEdOaGJHeGlZV05yTEdGalkyVndkR3hwYzNRc2NHRjFjMkZpYkdVc2NHRjFjMlVzWkdWc1lYa3BJSHRjY2x4dVhIUWdJQ0FnWEhScFppZ2hLRzlpYW1WamRDQnBibk4wWVc1alpXOW1JRUZ5Y21GNUtTQW1KaUFoUVhKeVlYa3VhWE5CY25KaGVTaHZZbXBsWTNRcEtTQjdYSEpjYmx4MElDQWdJRngwWEhSMGFISnZkeUJ1WlhjZ1ZIbHdaVVZ5Y205eUtGd2lSbWx5YzNRZ1lYSm5kVzFsYm5RZ2RHOGdRWEp5WVhrdWIySnpaWEoyWlhJZ2FYTWdibTkwSUdGdUlFRnljbUY1WENJcE8xeHlYRzVjZENBZ0lDQmNkSDFjY2x4dUlDQWdJQ0FnSUNBZ0lDQWdYSFJoWTJObGNIUnNhWE4wSUQwZ1lXTmpaWEIwYkdsemRDQjhmQ0JiWENKaFpHUmNJaXdnWENKMWNHUmhkR1ZjSWl3Z1hDSmtaV3hsZEdWY0lpd2dYQ0p6Y0d4cFkyVmNJbDA3WEhKY2JseDBJQ0FnSUZ4MGRtRnlJR0Z5Y21GNWNISnZlSGtnUFNCdVpYY2dVSEp2ZUhrb2IySnFaV04wTEh0blpYUTZJR1oxYm1OMGFXOXVLSFJoY21kbGRDeHdjbTl3WlhKMGVTa2dlMXh5WEc1Y2RDQWdJQ0JjZEZ4MGFXWW9jSEp2Y0dWeWRIazlQVDFjSW5WdWIySnpaWEoyWlZ3aUtTQjdYSEpjYmx4MFhIUWdJQ0FnWEhSY2RISmxkSFZ5YmlCbWRXNWpkR2x2YmloallXeHNZbUZqYXlrZ2UxeHlYRzVjZEZ4MElDQWdJRngwWEhSY2RHbG1LR05oYkd4aVlXTnJLU0I3WEhKY2JseDBYSFFnSUNBZ1hIUmNkRngwWEhSeVpYUjFjbTRnVDJKcVpXTjBMblZ1YjJKelpYSjJaU2gwWVhKblpYUXNZMkZzYkdKaFkyc3BPMXh5WEc1Y2RGeDBJQ0FnSUZ4MFhIUmNkSDFjY2x4dVhIUmNkQ0FnSUNCY2RGeDBYSFJ5WlhSMWNtNGdkR0Z5WjJWMExuVnViMkp6WlhKMlpTZ3BPMXh5WEc1Y2RGeDBJQ0FnSUZ4MFhIUjlPMXh5WEc1Y2RGeDBJQ0FnSUZ4MGZWeHlYRzVjZENBZ0lDQmNkRngwYVdZb2NISnZjR1Z5ZEhrOVBUMWNJbk53YkdsalpWd2lLU0I3WEhKY2JseDBJQ0FnSUZ4MFhIUmNkSEpsZEhWeWJpQm1kVzVqZEdsdmJpaHpkR0Z5ZEN4bGJtUXBJSHRjY2x4dVhIUWdJQ0FnWEhSY2RGeDBYSFJwWmloMGVYQmxiMllvYzNSaGNuUXBJVDA5WENKdWRXMWlaWEpjSWlCOGZDQjBlWEJsYjJZb1pXNWtLU0U5UFZ3aWJuVnRZbVZ5WENJcElIdGNjbHh1WEhRZ0lDQWdYSFJjZEZ4MFhIUmNkSFJvY205M0lHNWxkeUJVZVhCbFJYSnliM0lvWENKR2FYSnpkQ0IwZDI4Z1lYSm5kVzFsYm5SeklIUnZJRUZ5Y21GNUlITndiR2xqWlNCaGNtVWdibTkwSUc1MWJXSmxjaXdnYm5WdFltVnlYQ0lwTzF4eVhHNWNkQ0FnSUNCY2RGeDBYSFJjZEgxY2NseHVYSFFnSUNBZ1hIUWdJQ0FnWEhSY2RIWmhjaUJ5WlcxdmRtVmtJRDBnZEdocGN5NXpiR2xqWlNoemRHRnlkQ3h6ZEdGeWRDdGxibVFwTEZ4eVhHNWNkQ0FnSUNCY2RDQWdJQ0JjZEZ4MFhIUmhaR1JsWkVOdmRXNTBJRDBnS0dGeVozVnRaVzUwY3k1c1pXNW5kR2dnUGlBeElEOGdZWEpuZFcxbGJuUnpMbXhsYm1kMGFDMHlJRG9nTUNrc1hISmNibHgwSUNBZ0lGeDBJQ0FnSUZ4MFhIUmNkR05vWVc1blpTQTlJQ0I3YjJKcVpXTjBPbTlpYW1WamRDeDBlWEJsT2x3aWMzQnNhV05sWENJc2FXNWtaWGc2YzNSaGNuUXNjbVZ0YjNabFpEcHlaVzF2ZG1Wa0xHRmtaR1ZrUTI5MWJuUTZZV1JrWldSRGIzVnVkSDA3WEhKY2JseDBJQ0FnSUZ4MElDQWdJRngwWEhSMFlYSm5aWFF1YzNCc2FXTmxMbUZ3Y0d4NUtIUmhjbWRsZEN4aGNtZDFiV1Z1ZEhNcE8xeHlYRzVjZENBZ0lDQmNkQ0FnSUNCY2RGeDBhV1lvWVdOalpYQjBiR2x6ZEM1cGJtUmxlRTltS0Z3aWMzQnNhV05sWENJcFBqMHdLU0I3WEhKY2JseDBJQ0FnSUZ4MElDQWdJRngwWEhSY2RIWmhjaUJ6ZEdGeWRDQTlJSEJ5YjNoNUxsOWZiMkp6WlhKMlpYSmZYeTVqYUdGdVoyVnpaWFF1YkdWdVozUm9JRDA5UFNBd0xGeHlYRzVjZENBZ0lDQmNkQ0FnSUNBZ0lDQWdYSFJjZEZ4MFpHVnNhWFpsY2lBOUlIQnliM2g1TGw5ZmIySnpaWEoyWlhKZlh5NWtaV3hwZG1WeUtDazdYSEpjYmx4MElDQWdJRngwSUNBZ0lGeDBYSFJjZEhCeWIzaDVMbDlmYjJKelpYSjJaWEpmWHk1amFHRnVaMlZ6WlhRdWNIVnphQ2hqYUdGdVoyVXBPMXh5WEc1Y2RDQWdJQ0JjZENBZ0lDQmNkRngwWEhScFppaHpkR0Z5ZENrZ2UxeHlYRzVjZENBZ0lDQmNkRngwSUNBZ0lDQWdJQ0JjZEZ4MFpHVnNhWFpsY2lobVlXeHpaU3dvZEhsd1pXOW1LR1JsYkdsMlpYSXVaR1ZzWVhrcFBUMDlYQ0p1ZFcxaVpYSmNJaUEvSUdSbGJHbDJaWEl1WkdWc1lYa2dPaUF4TUNrcE8xeHlYRzVjZENBZ0lDQmNkRngwSUNBZ0lDQWdJQ0JjZEgxY2NseHVYSFFnSUNBZ1hIUWdJQ0FnWEhSY2RIMWNjbHh1WEhRZ0lDQWdYSFFnSUNBZ1hIUjlYSEpjYmx4MElDQWdJRngwWEhSOVhISmNibHgwSUNBZ0lGeDBYSFJwWmlod2NtOXdaWEowZVQwOVBWd2ljSFZ6YUZ3aUtTQjdYSEpjYmx4MElDQWdJRngwWEhSY2RDQnlaWFIxY200Z1puVnVZM1JwYjI0b2FYUmxiU2tnZTF4eVhHNWNkQ0FnSUNCY2RGeDBJQ0FnSUZ4MGNtVjBkWEp1SUhSb2FYTXVjM0JzYVdObEtIUm9hWE11YkdWdVozUm9MREFzYVhSbGJTazdYSEpjYmx4MElDQWdJRngwWEhRZ0lDQWdmVnh5WEc1Y2RDQWdJQ0JjZEZ4MGZWeHlYRzVjZENBZ0lDQmNkRngwYVdZb2NISnZjR1Z5ZEhrOVBUMWNJbkJ2Y0Z3aUtTQjdYSEpjYmx4MElDQWdJRngwWEhSY2RDQnlaWFIxY200Z1puVnVZM1JwYjI0b0tTQjdYSEpjYmx4MElDQWdJRngwWEhRZ0lDQWdYSFJ5WlhSMWNtNGdkR2hwY3k1emNHeHBZMlVvZEdocGN5NXNaVzVuZEdndE1Td3hLVHRjY2x4dVhIUWdJQ0FnWEhSY2RDQWdJQ0I5WEhKY2JseDBJQ0FnSUZ4MFhIUjlYSEpjYmx4MElDQWdJRngwWEhScFppaHdjbTl3WlhKMGVUMDlQVndpZFc1emFHbG1kRndpS1NCN1hISmNibHgwSUNBZ0lGeDBYSFJjZENCeVpYUjFjbTRnWm5WdVkzUnBiMjRvYVhSbGJTa2dlMXh5WEc0Z0lDQWdYSFJjZENBZ0lDQmNkRngwY21WMGRYSnVJSFJvYVhNdWMzQnNhV05sS0RBc01DeHBkR1Z0S1R0Y2NseHVJQ0FnSUZ4MFhIUWdJQ0FnWEhSOVhISmNibHgwSUNBZ0lGeDBYSFI5WEhKY2JseDBJQ0FnSUZ4MFhIUnBaaWh3Y205d1pYSjBlVDA5UFZ3aWMyaHBablJjSWlrZ2UxeHlYRzVjZENBZ0lDQmNkRngwWEhSeVpYUjFjbTRnWm5WdVkzUnBiMjRvS1NCN1hISmNibHgwSUNBZ0lGeDBJQ0FnSUZ4MFhIUnlaWFIxY200Z2RHaHBjeTV6Y0d4cFkyVW9NQ3d4S1R0Y2NseHVYSFFnSUNBZ1hIUWdJQ0FnWEhSOVhISmNibHgwSUNBZ0lGeDBYSFI5WEhKY2JseDBJQ0FnSUZ4MFhIUnlaWFIxY200Z2RHRnlaMlYwVzNCeWIzQmxjblI1WFR0Y2NseHVYSFFnSUNBZ1hIUjlmU2s3WEhKY2JseDBJQ0FnSUZ4MGRtRnlJSEJ5YjNoNUlEMGdUMkpxWldOMExtOWljMlZ5ZG1Vb1lYSnlZWGx3Y205NGVTeG1kVzVqZEdsdmJpaGphR0Z1WjJWelpYUXBJSHNnWEhKY2JseDBJQ0FnSUZ4MFhIUjJZWElnWTJoaGJtZGxjeUE5SUdOb1lXNW5aWE5sZEM1bWFXeDBaWElvWm5WdVkzUnBiMjRvWTJoaGJtZGxLU0I3SUhKbGRIVnliaUJqYUdGdVoyVXVibUZ0WlNFOVBWd2liR1Z1WjNSb1hDSWdKaVlnWTJoaGJtZGxMbTVoYldVaFBUMWNJbUZrWkZ3aUlDWW1JQ2doWVdOalpYQjBiR2x6ZENCOGZDQmhZMk5sY0hSc2FYTjBMbWx1WkdWNFQyWW9ZMmhoYm1kbExuUjVjR1VwUGowd0tUc2dmU2s3WEhKY2JseDBJQ0FnSUZ4MFhIUnBaaWhqYUdGdVoyVnpMbXhsYm1kMGFENHdLU0I3WEhKY2JseDBJQ0FnSUZ4MFhIUmNkR05oYkd4aVlXTnJLR05vWVc1blpYTXBPMXh5WEc1Y2RDQWdJQ0JjZEZ4MGZWeHlYRzVjZENBZ0lDQmNkSDBzWVdOalpYQjBiR2x6ZEN4d1lYVnpZV0pzWlN4d1lYVnpaU3hrWld4aGVTazdYSEpjYmx4MElDQWdJRngwY21WMGRYSnVJSEJ5YjNoNU8xeHlYRzVjZENBZ0lDQjlPMXh5WEc1Y2RDQWdJQ0JCY25KaGVTNTFibTlpYzJWeWRtVWdQU0JtZFc1amRHbHZiaWh2WW1wbFkzUXNZMkZzYkdKaFkyc3BJSHRjY2x4dVhIUmNkQ0FnY21WMGRYSnVJRzlpYW1WamRDNTFibTlpYzJWeWRtVW9ZMkZzYkdKaFkyc3BPMXh5WEc1Y2RDQWdJQ0I5WEhKY2JseDBmVnh5WEc1Y2RFOWlhbVZqZEM1a1pXVndUMkp6WlhKMlpTQTlJR1oxYm1OMGFXOXVLRzlpYW1WamRDeGpZV3hzWW1GamF5eHdZWEowY3lrZ2UxeHlYRzVjY2x4dVhIUmNkSEJoY25SeklEMGdLSEJoY25SeklEOGdjR0Z5ZEhNZ09pQmJYU2s3WEhKY2JseHlYRzVjZEZ4MGRtRnlJSFJ2Vkhsd1pVNWhiV1VnUFNCbWRXNWpkR2x2Ymlodlltb3BJSHRjY2x4dVhIUmNkRngwY21WMGRYSnVJQ2g3ZlNrdWRHOVRkSEpwYm1jdVkyRnNiQ2h2WW1vcExtMWhkR05vS0M5Y1hITW9XMkV0ZWtFdFdsMHJLUzhwV3pGZExuUnZURzkzWlhKRFlYTmxLQ2xjY2x4dVhIUmNkSDFjY2x4dVhISmNibHgwWEhSbWRXNWpkR2x2YmlCeVpXOWljMlZ5ZG1Vb2RtRnNkV1VzSUhCaGNuUnpLU0I3WEhKY2JseDBYSFJjZEhaaGNpQnJaWGx6SUQwZ1QySnFaV04wTG10bGVYTW9kbUZzZFdVcE8xeHlYRzVjZEZ4MFhIUnJaWGx6TG1admNrVmhZMmdvWm5WdVkzUnBiMjRvYTJWNUtTQjdYSEpjYmx4MFhIUmNkRngwYVdZb0tIUnZWSGx3WlU1aGJXVW9kbUZzZFdWYmEyVjVYU2tnUFQwOUlDZHZZbXBsWTNRbklIeDhJSFJ2Vkhsd1pVNWhiV1VvZG1Gc2RXVmJhMlY1WFNrZ1BUMDlJQ2RoY25KaGVTY3BJQ1ltSUNGMllXeDFaVnRyWlhsZExtaGhjMDkzYmxCeWIzQmxjblI1S0NkZlgyOWljMlZ5ZG1WeWMxOWZKeWtwSUh0Y2NseHVYSFJjZEZ4MFhIUmNkSFpoY2lCdVpYZHdZWEowY3lBOUlIQmhjblJ6TG5Oc2FXTmxLREFwTzF4eVhHNWNkRngwWEhSY2RGeDBibVYzY0dGeWRITXVjSFZ6YUNoclpYa3BPMXh5WEc1Y2RGeDBYSFJjZEZ4MGRtRnNkV1ZiYTJWNVhTQTlJRTlpYW1WamRDNWtaV1Z3VDJKelpYSjJaU2gyWVd4MVpWdHJaWGxkTEdOaGJHeGlZV05yTEc1bGQzQmhjblJ6S1R0Y2NseHVYSFJjZEZ4MFhIUjlYSEpjYmx4MFhIUmNkSDBwTzF4eVhHNWNkRngwZlZ4eVhHNWNjbHh1WEhSY2RISmxiMkp6WlhKMlpTaHZZbXBsWTNRc0lIQmhjblJ6S1R0Y2NseHVYSEpjYmx4MFhIUjJZWElnYjJKelpYSjJaV1FnUFNCUFltcGxZM1F1YjJKelpYSjJaU2h2WW1wbFkzUXNablZ1WTNScGIyNG9ZMmhoYm1kbGMyVjBLU0I3WEhKY2JseDBYSFJjZEhaaGNpQmphR0Z1WjJWeklEMGdXMTA3WEhKY2JseDBYSFJjZEdaMWJtTjBhVzl1SUhKbFkzVnljMlVvYm1GdFpTeHliMjkwVDJKcVpXTjBMRzlzWkU5aWFtVmpkQ3h1WlhkUFltcGxZM1FzY0dGMGFDa2dlMXh5WEc1Y2RGeDBYSFJjZEdsbUtHNWxkMDlpYW1WamRDQnBibk4wWVc1alpXOW1JRTlpYW1WamRDa2dlMXh5WEc1Y2RGeDBYSFJjZEZ4MGRtRnlJRzVsZDJ0bGVYTWdQU0JQWW1wbFkzUXVhMlY1Y3lodVpYZFBZbXBsWTNRcE8xeHlYRzVjZEZ4MFhIUmNkRngwYm1WM2EyVjVjeTVtYjNKRllXTm9LR1oxYm1OMGFXOXVLR3RsZVNrZ2UxeHlYRzVjZEZ4MFhIUmNkRngwWEhScFppZ2hiMnhrVDJKcVpXTjBJSHg4SUNodmJHUlBZbXBsWTNSYmEyVjVYU0U5UFc1bGQwOWlhbVZqZEZ0clpYbGRLU2tnZTF4eVhHNWNkRngwWEhSY2RGeDBYSFJjZEhaaGNpQnZiR1IyWVd4MVpTQTlJQ2h2YkdSUFltcGxZM1FnSmlZZ2IyeGtUMkpxWldOMFcydGxlVjBoUFQxMWJtUmxabWx1WldRZ1B5QnZiR1JQWW1wbFkzUmJhMlY1WFNBNklIVnVaR1ZtYVc1bFpDa3NYSEpjYmx4MFhIUmNkRngwWEhSY2RGeDBYSFJqYUdGdVoyVWdQU0FvYjJ4a2RtRnNkV1U5UFQxMWJtUmxabWx1WldRZ1B5QmNJbUZrWkZ3aUlEb2dYQ0oxY0dSaGRHVmNJaWtzWEhKY2JseDBYSFJjZEZ4MFhIUmNkRngwWEhSclpYbHdZWFJvSUQwZ2NHRjBhQ0FySUZ3aUxsd2lJQ3NnYTJWNU8xeHlYRzVjY2x4dVhIUmNkRngwWEhSY2RGeDBYSFJqYUdGdVoyVnpMbkIxYzJnb2UyNWhiV1U2Ym1GdFpTeHZZbXBsWTNRNmNtOXZkRTlpYW1WamRDeDBlWEJsT21Ob1lXNW5aU3h2YkdSV1lXeDFaVHB2YkdSMllXeDFaU3h1WlhkV1lXeDFaVHB1WlhkUFltcGxZM1JiYTJWNVhTeHJaWGx3WVhSb09tdGxlWEJoZEdoOUtUdGNjbHh1WEhSY2RGeDBYSFJjZEZ4MFhIUnlaV04xY25ObEtHNWhiV1VzY205dmRFOWlhbVZqZEN4dmJHUjJZV3gxWlN4dVpYZFBZbXBsWTNSYmEyVjVYU3hyWlhsd1lYUm9LVHRjY2x4dVhIUmNkRngwWEhSY2RGeDBmVnh5WEc1Y2RGeDBYSFJjZEZ4MGZTazdYSEpjYmx4MFhIUmNkRngwZlNCbGJITmxJR2xtS0c5c1pFOWlhbVZqZENCcGJuTjBZVzVqWlc5bUlFOWlhbVZqZENrZ2UxeHlYRzVjZEZ4MFhIUmNkRngwZG1GeUlHOXNaR3RsZVhNZ1BTQlBZbXBsWTNRdWEyVjVjeWh2YkdSUFltcGxZM1FwTzF4eVhHNWNkRngwWEhSY2RGeDBiMnhrYTJWNWN5NW1iM0pGWVdOb0tHWjFibU4wYVc5dUtHdGxlU2tnZTF4eVhHNWNkRngwWEhSY2RGeDBYSFIyWVhJZ1kyaGhibWRsSUQwZ0tHNWxkMDlpYW1WamREMDlQVzUxYkd3Z1B5QmNJblZ3WkdGMFpWd2lJRG9nWENKa1pXeGxkR1ZjSWlrc1hISmNibHgwWEhSY2RGeDBYSFJjZEZ4MGEyVjVjR0YwYUNBOUlIQmhkR2dnS3lCY0lpNWNJaUFySUd0bGVUdGNjbHh1WEhSY2RGeDBYSFJjZEZ4MFhIUmNjbHh1WEhSY2RGeDBYSFJjZEZ4MFkyaGhibWRsY3k1d2RYTm9LSHR1WVcxbE9tNWhiV1VzYjJKcVpXTjBPbkp2YjNSUFltcGxZM1FzZEhsd1pUcGphR0Z1WjJVc2IyeGtWbUZzZFdVNmIyeGtUMkpxWldOMFcydGxlVjBzYm1WM1ZtRnNkV1U2Ym1WM1QySnFaV04wTEd0bGVYQmhkR2c2YTJWNWNHRjBhSDBwTzF4eVhHNWNkRngwWEhSY2RGeDBYSFJ5WldOMWNuTmxLRzVoYldVc2NtOXZkRTlpYW1WamRDeHZiR1JQWW1wbFkzUmJhMlY1WFN4MWJtUmxabWx1WldRc2EyVjVjR0YwYUNrN1hISmNibHgwWEhSY2RGeDBYSFI5S1R0Y2NseHVYSFJjZEZ4MFhIUjlYSEpjYmx4MFhIUmNkSDFjY2x4dVhIUmNkRngwWTJoaGJtZGxjMlYwTG1admNrVmhZMmdvWm5WdVkzUnBiMjRvWTJoaGJtZGxLU0I3WEhKY2JseDBYSFJjZEZ4MGRtRnlJR3RsZVhCaGRHZ2dQU0FvY0dGeWRITXViR1Z1WjNSb1BqQWdQeUJ3WVhKMGN5NXFiMmx1S0Z3aUxsd2lLU0FySUZ3aUxsd2lJRG9nWENKY0lpa2dLeUJqYUdGdVoyVXVibUZ0WlR0Y2NseHVYSEpjYmx4MFhIUmNkRngwYVdZZ0tHTm9ZVzVuWlM1MGVYQmxJRDA5UFNCY0luVndaR0YwWlZ3aUlIeDhJR05vWVc1blpTNTBlWEJsSUQwOVBTQmNJbUZrWkZ3aUtTQjdJRnh5WEc1Y2RGeDBYSFJjZEZ4MGNtVnZZbk5sY25abEtHTm9ZVzVuWlM1dlltcGxZM1FzSUhCaGNuUnpLVHRjY2x4dVhIUmNkRngwWEhSOVhISmNibHh5WEc1Y2RGeDBYSFJjZEdOb1lXNW5aWE11Y0hWemFDaDdibUZ0WlRwamFHRnVaMlV1Ym1GdFpTeHZZbXBsWTNRNlkyaGhibWRsTG05aWFtVmpkQ3gwZVhCbE9tTm9ZVzVuWlM1MGVYQmxMRzlzWkZaaGJIVmxPbU5vWVc1blpTNXZiR1JXWVd4MVpTeHVaWGRXWVd4MVpUcGphR0Z1WjJVdWIySnFaV04wVzJOb1lXNW5aUzV1WVcxbFhTeHJaWGx3WVhSb09tdGxlWEJoZEdoOUtUdGNjbHh1WEhSY2RGeDBYSFJ5WldOMWNuTmxLR05vWVc1blpTNXVZVzFsTEdOb1lXNW5aUzV2WW1wbFkzUXNZMmhoYm1kbExtOXNaRlpoYkhWbExHTm9ZVzVuWlM1dlltcGxZM1JiWTJoaGJtZGxMbTVoYldWZExHdGxlWEJoZEdncE8xeHlYRzVjZEZ4MFhIUjlLVHRjY2x4dVhIUmNkRngwWTJGc2JHSmhZMnNvWTJoaGJtZGxjeWs3WEhKY2JseDBYSFI5S1R0Y2NseHVYSFJjZEhKbGRIVnliaUJ2WW5ObGNuWmxaRHRjY2x4dVhIUjlPMXh5WEc1OUtTZ3BPMXh5WEc1Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2Y0hKdmVIa3RiMkp6WlhKMlpTOXBibVJsZUM1cWMxeHVMeThnYlc5a2RXeGxJR2xrSUQwZ01URTRYRzR2THlCdGIyUjFiR1VnWTJoMWJtdHpJRDBnTUNBM0lpd2lMeW9xWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZCVUlFbHViM1podzZmRG8yOGdaU0JUYVhOMFpXMWhjeUJUUVZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCSlRrVlRReTFKUkZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCUlZVOUNTVk1nVGtWVVYwOVNTMU1nVTB4Y2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1JsSkJWVTVJVDBaRlVpMUhSVk5GVEV4VFEwaEJSbFFnV2xWU0lFWlBSVkpFUlZKVlRrY2dSRVZTSUVGT1IwVlhRVTVFVkVWT0lFWlBVbE5EU0ZWT1J5QkZMbFpjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVDFKQlRrZEZJRk5CWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVSbGRYUnpZMmhsSUZSbGJHVnJiMjBnUVVkY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1FYQnBlbVZsWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZSRlEwaE9TVk5EU0VVZ1ZVNUpWa1ZTVTBsVVFWUWdRa1ZTVEVsT1hHNHFYRzRxSUV4cFkyVnVjMlZrSUhWdVpHVnlJSFJvWlNCQmNHRmphR1VnVEdsalpXNXpaU3dnVm1WeWMybHZiaUF5TGpBZ0tIUm9aU0JjSWt4cFkyVnVjMlZjSWlrN1hHNHFJSGx2ZFNCdFlYa2dibTkwSUhWelpTQjBhR2x6SUdacGJHVWdaWGhqWlhCMElHbHVJR052YlhCc2FXRnVZMlVnZDJsMGFDQjBhR1VnVEdsalpXNXpaUzVjYmlvZ1dXOTFJRzFoZVNCdlluUmhhVzRnWVNCamIzQjVJRzltSUhSb1pTQk1hV05sYm5ObElHRjBYRzRxWEc0cUlDQWdhSFIwY0RvdkwzZDNkeTVoY0dGamFHVXViM0puTDJ4cFkyVnVjMlZ6TDB4SlEwVk9VMFV0TWk0d1hHNHFYRzRxSUZWdWJHVnpjeUJ5WlhGMWFYSmxaQ0JpZVNCaGNIQnNhV05oWW14bElHeGhkeUJ2Y2lCaFozSmxaV1FnZEc4Z2FXNGdkM0pwZEdsdVp5d2djMjltZEhkaGNtVmNiaW9nWkdsemRISnBZblYwWldRZ2RXNWtaWElnZEdobElFeHBZMlZ1YzJVZ2FYTWdaR2x6ZEhKcFluVjBaV1FnYjI0Z1lXNGdYQ0pCVXlCSlUxd2lJRUpCVTBsVExGeHVLaUJYU1ZSSVQxVlVJRmRCVWxKQlRsUkpSVk1nVDFJZ1EwOU9SRWxVU1U5T1V5QlBSaUJCVGxrZ1MwbE9SQ3dnWldsMGFHVnlJR1Y0Y0hKbGMzTWdiM0lnYVcxd2JHbGxaQzVjYmlvZ1UyVmxJSFJvWlNCTWFXTmxibk5sSUdadmNpQjBhR1VnYzNCbFkybG1hV01nYkdGdVozVmhaMlVnWjI5MlpYSnVhVzVuSUhCbGNtMXBjM05wYjI1eklHRnVaRnh1S2lCc2FXMXBkR0YwYVc5dWN5QjFibVJsY2lCMGFHVWdUR2xqWlc1elpTNWNiaW9xTDF4dVhHNXBiWEJ2Y25RZ1JHRjBZVTlpYW1WamRDQm1jbTl0SUNjdUwwUmhkR0ZQWW1wbFkzUW5PMXh1YVcxd2IzSjBJRVJoZEdGUFltcGxZM1JEYUdsc1pDQm1jbTl0SUNjdUwwUmhkR0ZQWW1wbFkzUkRhR2xzWkNjN1hHNWNibXhsZENCR2FXeDBaWEpVZVhCbElEMGdlMEZPV1RvZ0oyRnVlU2NzSUZOVVFWSlVPaUFuYzNSaGNuUW5MQ0JGV0VGRFZEb2dKMlY0WVdOMEozMDdYRzVjYmk4cUtseHVJQ29nVkdobElHTnNZWE56SUhKbGRIVnlibVZrSUdaeWIyMGdkR2hsSUZONWJtTm9aWElnYzNWaWMyTnlhV0psSUdOaGJHd3VYRzRnS2lCVWJ5QmlaU0IxYzJWa0lHRnpJR0Z1SUc5aWMyVnlkbUYwYVc5dUlIQnZhVzUwSUdaeWIyMGdZU0JFWVhSaFQySnFaV04wVW1Wd2IzSjBaWElnWTJoaGJtZGxMbHh1SUNvdlhHNWpiR0Z6Y3lCRVlYUmhUMkpxWldOMFQySnpaWEoyWlhJZ1pYaDBaVzVrY3lCRVlYUmhUMkpxWldOMElDOHFJR2x0Y0d4bGJXVnVkSE1nVTNsdVkxTjBZWFIxY3lBcUx5QjdYRzRnSUM4cUlIQnlhWFpoZEdWY2JpQWdYMk5vWVc1blpVeHBjM1JsYm1WeU9pQk5jMmRNYVhOMFpXNWxjbHh1WEc0Z0lDMHRMUzFsZG1WdWRDQm9ZVzVrYkdWeWN5MHRMUzFjYmlBZ1gyWnBiSFJsY25NNklIczhabWxzZEdWeVBqb2dlM1I1Y0dVNklEeHpkR0Z5ZEN3Z1pYaGhZM1ErTENCallXeHNZbUZqYXpvZ1BHWjFibU4wYVc5dVBuMGdmVnh1SUNBcUwxeHVYRzRnSUM4cUtseHVJQ0FnS2lCQWFXZHViM0psWEc0Z0lDQXFJRk5vYjNWc1pDQnViM1FnWW1VZ2RYTmxaQ0JrYVhKbFkzUnNlU0JpZVNCSWVYQmxjblJwWlhNdUlFbDBKM01nWTJGc2JHVmtJR0o1SUhSb1pTQlRlVzVqYUdWeUxuTjFZbk5qY21saVpTQnRaWFJvYjJSY2JpQWdJQ292WEc1Y2JpQWdMeTlVVDBSUE9pQkdiM0lnUm5WeWRHaGxjaUJUZEhWa2VWeHVJQ0JqYjI1emRISjFZM1J2Y2loemVXNWphR1Z5TENCMWNtd3NJSE5qYUdWdFlTd2dhVzVwZEdsaGJGTjBZWFIxY3l3Z2FXNXBkR2xoYkVSaGRHRXNJR05vYVd4a2NtVnVjeXdnYVc1cGRHbGhiRlpsY25OcGIyNHNJRzExZEhWaGJDa2dlMXh1SUNBZ0lITjFjR1Z5S0hONWJtTm9aWElzSUhWeWJDd2djMk5vWlcxaExDQnBibWwwYVdGc1UzUmhkSFZ6TENCcGJtbDBhV0ZzUkdGMFlTNWtZWFJoTENCamFHbHNaSEpsYm5Nc0lHMTFkSFZoYkNrN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmx4dUlDQWdJRjkwYUdsekxsOTJaWEp6YVc5dUlEMGdhVzVwZEdsaGJGWmxjbk5wYjI0N1hHNGdJQ0FnWDNSb2FYTXVYMlpwYkhSbGNuTWdQU0I3ZlR0Y2JseHVJQ0FnSUY5MGFHbHpMbDl6ZVc1alQySnFMbTlpYzJWeWRtVW9LR1YyWlc1MEtTQTlQaUI3WEc0Z0lDQWdJQ0JmZEdocGN5NWZiMjVHYVd4MFpYSW9aWFpsYm5RcE8xeHVJQ0FnSUgwcE8xeHVYRzRnSUNBZ0x5OXpaWFIxY0NCamFHbHNaSEpsYm5NZ1pHRjBZU0JtY205dElITjFZbk5qY21sd2RHbHZibHh1SUNBZ0lFOWlhbVZqZEM1clpYbHpLR2x1YVhScFlXeEVZWFJoTG1Ob2FXeGtjbVZ1Y3lrdVptOXlSV0ZqYUNnb1kyaHBiR1JKWkNrZ1BUNGdlMXh1SUNBZ0lDQWdiR1YwSUdOb2FXeGtSR0YwWVNBOUlHbHVhWFJwWVd4RVlYUmhMbU5vYVd4a2NtVnVjMXRqYUdsc1pFbGtYVHRjYmlBZ0lDQWdJRjkwYUdsekxsOWphR2xzWkhKbGJrOWlhbVZqZEhOYlkyaHBiR1JKWkYwZ1BTQnVaWGNnUkdGMFlVOWlhbVZqZEVOb2FXeGtLRjkwYUdsekxDQmphR2xzWkVsa0xDQmphR2xzWkVSaGRHRXBPMXh1SUNBZ0lIMHBPMXh1WEc0Z0lDQWdYM1JvYVhNdVgyRnNiRzlqWVhSbFRHbHpkR1Z1WlhKektDazdYRzRnSUgxY2JseHVJQ0JmWVd4c2IyTmhkR1ZNYVhOMFpXNWxjbk1vS1NCN1hHNGdJQ0FnYzNWd1pYSXVYMkZzYkc5allYUmxUR2x6ZEdWdVpYSnpLQ2s3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lGOTBhR2x6TGw5amFHRnVaMlZNYVhOMFpXNWxjaUE5SUY5MGFHbHpMbDlpZFhNdVlXUmtUR2x6ZEdWdVpYSW9YM1JvYVhNdVgzVnliQ0FySUNjdlkyaGhibWRsY3ljc0lDaHRjMmNwSUQwK0lIdGNiaUFnSUNBZ0lHbG1JQ2h0YzJjdWRIbHdaU0E5UFQwZ0ozVndaR0YwWlNjcElIdGNiaUFnSUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvSjBSaGRHRlBZbXBsWTNSUFluTmxjblpsY2kwbklDc2dYM1JvYVhNdVgzVnliQ0FySUNjdFVrTldPaUFuTENCdGMyY3BPMXh1SUNBZ0lDQWdJQ0JmZEdocGN5NWZZMmhoYm1kbFQySnFaV04wS0Y5MGFHbHpMbDl6ZVc1alQySnFMQ0J0YzJjcE8xeHVJQ0FnSUNBZ2ZWeHVJQ0FnSUgwcE8xeHVJQ0I5WEc1Y2JpQWdYM0psYkdWaGMyVk1hWE4wWlc1bGNuTW9LU0I3WEc0Z0lDQWdjM1Z3WlhJdVgzSmxiR1ZoYzJWTWFYTjBaVzVsY25Nb0tUdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWDNSb2FYTXVYMk5vWVc1blpVeHBjM1JsYm1WeUxuSmxiVzkyWlNncE8xeHVJQ0I5WEc1Y2JpQWdMeW9xWEc0Z0lDQXFJRkpsYkdWaGMyVWdZVzVrSUdSbGJHVjBaU0J2WW1wbFkzUWdaR0YwWVZ4dUlDQWdLaTljYmlBZ1pHVnNaWFJsS0NrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQ0JmZEdocGN5NWZjbVZzWldGelpVeHBjM1JsYm1WeWN5Z3BPMXh1SUNBZ0lHUmxiR1YwWlNCZmRHaHBjeTVmYzNsdVkyaGxjaTVmYjJKelpYSjJaWEp6VzE5MGFHbHpMbDkxY214ZE8xeHVJQ0I5WEc1Y2JpQWdMeW9xWEc0Z0lDQXFJRkpsYkdWaGMyVWdZVzVrSUdSbGJHVjBaU0J2WW1wbFkzUWdaR0YwWVZ4dUlDQWdLaTljYmlBZ2RXNXpkV0p6WTNKcFltVW9LU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lDOHZSa3hQVnkxUFZWUTZJSFJvYVhNZ2JXVnpjMkZuWlNCM2FXeHNJR0psSUhObGJuUWdkRzhnZEdobElISjFiblJwYldVZ2FXNXpkR0Z1WTJVZ2IyWWdVM2x1WTJobGNrMWhibUZuWlhJZ0xUNGdYMjl1VEc5allXeFZibE4xWW5OamNtbGlaVnh1SUNBZ0lHeGxkQ0IxYmxOMVluTmpjbWxpWlUxelp5QTlJSHRjYmlBZ0lDQWdJSFI1Y0dVNklDZDFibk4xWW5OamNtbGlaU2NzSUdaeWIyMDZJRjkwYUdsekxsOXZkMjVsY2l3Z2RHODZJRjkwYUdsekxsOXplVzVqYUdWeUxsOXpkV0pWVWt3c1hHNGdJQ0FnSUNCaWIyUjVPaUI3SUhKbGMyOTFjbU5sT2lCZmRHaHBjeTVmZFhKc0lIMWNiaUFnSUNCOU8xeHVYRzRnSUNBZ1gzUm9hWE11WDJKMWN5NXdiM04wVFdWemMyRm5aU2gxYmxOMVluTmpjbWxpWlUxelp5d2dLSEpsY0d4NUtTQTlQaUI3WEc0Z0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblJHRjBZVTlpYW1WamRFOWljMlZ5ZG1WeUxWVk9VMVZDVTBOU1NVSkZPaUFuTENCeVpYQnNlU2s3WEc0Z0lDQWdJQ0JwWmlBb2NtVndiSGt1WW05a2VTNWpiMlJsSUQwOVBTQXlNREFwSUh0Y2JpQWdJQ0FnSUNBZ1gzUm9hWE11WDNKbGJHVmhjMlZNYVhOMFpXNWxjbk1vS1R0Y2JpQWdJQ0FnSUNBZ1pHVnNaWFJsSUY5MGFHbHpMbDl6ZVc1amFHVnlMbDl2WW5ObGNuWmxjbk5iWDNSb2FYTXVYM1Z5YkYwN1hHNGdJQ0FnSUNCOVhHNGdJQ0FnZlNrN1hHNGdJSDFjYmx4dUlDQXZLaXBjYmlBZ0lDb2dVbVZuYVhOMFpYSWdkR2hsSUdOb1lXNW5aU0JzYVhOMFpXNWxjbk1nYzJWdWRDQmllU0IwYUdVZ2NtVndiM0owWlhKY2JpQWdJQ29nUUhCaGNtRnRJSHR6ZEhKcGJtZDlJR1pwYkhSbGNpQXRJRVpwYkhSbGNpQjBhR0YwSUdsa1pXNTBhV1pwWlhNZ2RHaGxJR1pwWld4a0lDaHpaWEJoY21GMFpXUWdaRzkwSUhCaGRHZ3BMaUJCWTJObGNIUnpJQ29nWVhRZ2RHaGxJR1Z1WkNCbWIzSWdZU0J0YjNKbElIVnVjbVZ6ZEhKcFkzUmxaQ0JtYVd4MFpYSnBibWN1WEc0Z0lDQXFJRUJ3WVhKaGJTQjdablZ1WTNScGIyNG9aWFpsYm5RNklFMXpaMFYyWlc1MEtYMGdZMkZzYkdKaFkydGNiaUFnSUNvdlhHNGdJRzl1UTJoaGJtZGxLR1pwYkhSbGNpd2dZMkZzYkdKaFkyc3BJSHRjYmlBZ0lDQnNaWFFnYTJWNUlEMGdabWxzZEdWeU8xeHVJQ0FnSUd4bGRDQm1hV3gwWlhKUFltb2dQU0I3WEc0Z0lDQWdJQ0IwZVhCbE9pQkdhV3gwWlhKVWVYQmxMa1ZZUVVOVUxGeHVJQ0FnSUNBZ1kyRnNiR0poWTJzNklHTmhiR3hpWVdOclhHNGdJQ0FnZlR0Y2JseHVJQ0FnSUd4bGRDQnBaSGdnUFNCbWFXeDBaWEl1YVc1a1pYaFBaaWduS2ljcE8xeHVJQ0FnSUdsbUlDaHBaSGdnUFQwOUlHWnBiSFJsY2k1c1pXNW5kR2dnTFNBeEtTQjdYRzRnSUNBZ0lDQnBaaUFvYVdSNElEMDlQU0F3S1NCN1hHNGdJQ0FnSUNBZ0lHWnBiSFJsY2s5aWFpNTBlWEJsSUQwZ1JtbHNkR1Z5Vkhsd1pTNUJUbGs3WEc0Z0lDQWdJQ0I5SUdWc2MyVWdlMXh1SUNBZ0lDQWdJQ0JtYVd4MFpYSlBZbW91ZEhsd1pTQTlJRVpwYkhSbGNsUjVjR1V1VTFSQlVsUTdYRzRnSUNBZ0lDQWdJR3RsZVNBOUlHWnBiSFJsY2k1emRXSnpkSElvTUN3Z1ptbHNkR1Z5TG14bGJtZDBhQ0F0SURFcE8xeHVJQ0FnSUNBZ2ZWeHVJQ0FnSUgxY2JseHVJQ0FnSUhSb2FYTXVYMlpwYkhSbGNuTmJhMlY1WFNBOUlHWnBiSFJsY2s5aWFqdGNiaUFnZlZ4dVhHNGdJRjl2YmtacGJIUmxjaWhsZG1WdWRDa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNCUFltcGxZM1F1YTJWNWN5aGZkR2hwY3k1ZlptbHNkR1Z5Y3lrdVptOXlSV0ZqYUNnb2EyVjVLU0E5UGlCN1hHNGdJQ0FnSUNCc1pYUWdabWxzZEdWeUlEMGdYM1JvYVhNdVgyWnBiSFJsY25OYmEyVjVYVHRjYmlBZ0lDQWdJR2xtSUNobWFXeDBaWEl1ZEhsd1pTQTlQVDBnUm1sc2RHVnlWSGx3WlM1QlRsa3BJSHRjYmlBZ0lDQWdJQ0FnTHk5dFlYUmphQ0JoYm5sMGFHbHVaMXh1SUNBZ0lDQWdJQ0JtYVd4MFpYSXVZMkZzYkdKaFkyc29aWFpsYm5RcE8xeHVJQ0FnSUNBZ2ZTQmxiSE5sSUdsbUlDaG1hV3gwWlhJdWRIbHdaU0E5UFQwZ1JtbHNkR1Z5Vkhsd1pTNVRWRUZTVkNrZ2UxeHVJQ0FnSUNBZ0lDQXZMMmxtSUhOMFlYSjBjeUIzYVhSb0lHWnBiSFJsY2k0dUxseHVJQ0FnSUNBZ0lDQnBaaUFvWlhabGJuUXVabWxsYkdRdWFXNWtaWGhQWmloclpYa3BJRDA5UFNBd0tTQjdYRzRnSUNBZ0lDQWdJQ0FnWm1sc2RHVnlMbU5oYkd4aVlXTnJLR1YyWlc1MEtUdGNiaUFnSUNBZ0lDQWdmVnh1SUNBZ0lDQWdmU0JsYkhObElHbG1JQ2htYVd4MFpYSXVkSGx3WlNBOVBUMGdSbWxzZEdWeVZIbHdaUzVGV0VGRFZDa2dlMXh1SUNBZ0lDQWdJQ0F2TDJWNFlXTjBJRzFoZEdOb1hHNGdJQ0FnSUNBZ0lHbG1JQ2hsZG1WdWRDNW1hV1ZzWkNBOVBUMGdhMlY1S1NCN1hHNGdJQ0FnSUNBZ0lDQWdabWxzZEdWeUxtTmhiR3hpWVdOcktHVjJaVzUwS1R0Y2JpQWdJQ0FnSUNBZ2ZWeHVJQ0FnSUNBZ2ZWeHVJQ0FnSUgwcE8xeHVJQ0I5WEc1OVhHNWNibVY0Y0c5eWRDQmtaV1poZFd4MElFUmhkR0ZQWW1wbFkzUlBZbk5sY25abGNqdGNibHh1WEc1Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU0lDOHZYRzR2THlBdUwzTnlZeTl6ZVc1amFHVnlMMFJoZEdGUFltcGxZM1JQWW5ObGNuWmxjaTVxY3lJc0lpOHFLbHh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJRVkNCSmJtOTJZY09udzZOdklHVWdVMmx6ZEdWdFlYTWdVMEZjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnU1U1RlUwTXRTVVJjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVVZWUFFrbFRJRTVGVkZkUFVrdFRJRk5NWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVaU1FWVk9TRTlHUlZJdFIwVlRSVXhNVTBOSVFVWlVJRnBWVWlCR1QwVlNSRVZTVlU1SElFUkZVaUJCVGtkRlYwRk9SRlJGVGlCR1QxSlRRMGhWVGtjZ1JTNVdYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRTlTUVU1SFJTQlRRVnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJFWlhWMGMyTm9aU0JVWld4bGEyOXRJRUZIWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVGd2FYcGxaVnh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJVUlVOSVRrbFRRMGhGSUZWT1NWWkZVbE5KVkVGVUlFSkZVa3hKVGx4dUtseHVLaUJNYVdObGJuTmxaQ0IxYm1SbGNpQjBhR1VnUVhCaFkyaGxJRXhwWTJWdWMyVXNJRlpsY25OcGIyNGdNaTR3SUNoMGFHVWdYQ0pNYVdObGJuTmxYQ0lwTzF4dUtpQjViM1VnYldGNUlHNXZkQ0IxYzJVZ2RHaHBjeUJtYVd4bElHVjRZMlZ3ZENCcGJpQmpiMjF3YkdsaGJtTmxJSGRwZEdnZ2RHaGxJRXhwWTJWdWMyVXVYRzRxSUZsdmRTQnRZWGtnYjJKMFlXbHVJR0VnWTI5d2VTQnZaaUIwYUdVZ1RHbGpaVzV6WlNCaGRGeHVLbHh1S2lBZ0lHaDBkSEE2THk5M2QzY3VZWEJoWTJobExtOXlaeTlzYVdObGJuTmxjeTlNU1VORlRsTkZMVEl1TUZ4dUtseHVLaUJWYm14bGMzTWdjbVZ4ZFdseVpXUWdZbmtnWVhCd2JHbGpZV0pzWlNCc1lYY2diM0lnWVdkeVpXVmtJSFJ2SUdsdUlIZHlhWFJwYm1jc0lITnZablIzWVhKbFhHNHFJR1JwYzNSeWFXSjFkR1ZrSUhWdVpHVnlJSFJvWlNCTWFXTmxibk5sSUdseklHUnBjM1J5YVdKMWRHVmtJRzl1SUdGdUlGd2lRVk1nU1ZOY0lpQkNRVk5KVXl4Y2Jpb2dWMGxVU0U5VlZDQlhRVkpTUVU1VVNVVlRJRTlTSUVOUFRrUkpWRWxQVGxNZ1QwWWdRVTVaSUV0SlRrUXNJR1ZwZEdobGNpQmxlSEJ5WlhOeklHOXlJR2x0Y0d4cFpXUXVYRzRxSUZObFpTQjBhR1VnVEdsalpXNXpaU0JtYjNJZ2RHaGxJSE53WldOcFptbGpJR3hoYm1kMVlXZGxJR2R2ZG1WeWJtbHVaeUJ3WlhKdGFYTnphVzl1Y3lCaGJtUmNiaW9nYkdsdGFYUmhkR2x2Ym5NZ2RXNWtaWElnZEdobElFeHBZMlZ1YzJVdVhHNHFLaTljYmx4dWFXMXdiM0owSUVSaGRHRlBZbXBsWTNRZ1puSnZiU0FuTGk5RVlYUmhUMkpxWldOMEp6dGNibWx0Y0c5eWRDQjdJR1JsWlhCRGJHOXVaU0I5SUdaeWIyMGdKeTR1TDNWMGFXeHpMM1YwYVd4ekxtcHpKenRjYmx4dUx5b3FYRzRnS2lCVWFHVWdZMnhoYzNNZ2NtVjBkWEp1WldRZ1puSnZiU0IwYUdVZ1UzbHVZMmhsY2lCamNtVmhkR1VnWTJGc2JDNWNiaUFxSUZSdklHSmxJSFZ6WldRZ1lYTWdZU0J5WlhCdmNuUmxjaUJ3YjJsdWRDd2dZMmhoYm1kbGN5QjNhV3hzSUdKbElITjFZbTFwZEdWa0lIUnZJRVJoZEdGUFltcGxZM1JQWW5ObGNuWmxjaUJwYm5OMFlXNWpaWE11WEc0Z0tpOWNibU5zWVhOeklFUmhkR0ZQWW1wbFkzUlNaWEJ2Y25SbGNpQmxlSFJsYm1SeklFUmhkR0ZQWW1wbFkzUWdMeW9nYVcxd2JHVnRaVzUwY3lCVGVXNWpVM1JoZEhWeklDb3ZJSHRjYmlBZ0x5b2djSEpwZG1GMFpWeHVJQ0JmYzNWaWMyTnlhWEIwYVc5dWN6b2dQR2g1Y0dWeWRIbFZjbXc2SUhzZ2MzUmhkSFZ6T2lCemRISnBibWNnZlNCOVBseHVYRzRnSUMwdExTMWxkbVZ1ZENCb1lXNWtiR1Z5Y3kwdExTMWNiaUFnWDI5dVUzVmljMk55YVhCMGFXOXVTR0Z1Wkd4bGNqb2dLR1YyWlc1MEtTQTlQaUIyYjJsa1hHNGdJRjl2YmxKbGMzQnZibk5sU0dGdVpHeGxjam9nS0dWMlpXNTBLU0E5UGlCMmIybGtYRzRnSUY5dmJsSmxZV1JJWVc1a2JHVnlPaUFvWlhabGJuUXBJRDArSUhadmFXUmNiaUFnS2k5Y2JseHVJQ0F2S2lwY2JpQWdJQ29nUUdsbmJtOXlaVnh1SUNBZ0tpQlRhRzkxYkdRZ2JtOTBJR0psSUhWelpXUWdaR2x5WldOMGJIa2dZbmtnU0hsd1pYSjBhV1Z6TGlCSmRDZHpJR05oYkd4bFpDQmllU0IwYUdVZ1UzbHVZMmhsY2k1amNtVmhkR1VnYldWMGFHOWtYRzRnSUNBcUwxeHVJQ0JqYjI1emRISjFZM1J2Y2loemVXNWphR1Z5TENCMWNtd3NJSE5qYUdWdFlTd2dhVzVwZEdsaGJGTjBZWFIxY3l3Z2FXNXBkR2xoYkVSaGRHRXNJR05vYVd4a2NtVnVjeWtnZTF4dUlDQWdJSE4xY0dWeUtITjVibU5vWlhJc0lIVnliQ3dnYzJOb1pXMWhMQ0JwYm1sMGFXRnNVM1JoZEhWekxDQnBibWwwYVdGc1JHRjBZU3dnWTJocGJHUnlaVzV6S1R0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdYM1JvYVhNdVgzTjFZbk5qY21sd2RHbHZibk1nUFNCN2ZUdGNibHh1SUNBZ0lGOTBhR2x6TGw5emVXNWpUMkpxTG05aWMyVnlkbVVvS0dWMlpXNTBLU0E5UGlCN1hHNGdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25SR0YwWVU5aWFtVmpkRkpsY0c5eWRHVnlMU2NnS3lCMWNtd2dLeUFuTFZORlRrUTZJQ2NzSUdWMlpXNTBLVHRjYmlBZ0lDQWdJRjkwYUdsekxsOXZia05vWVc1blpTaGxkbVZ1ZENrN1hHNGdJQ0FnZlNrN1hHNWNiaUFnSUNCZmRHaHBjeTVmWVd4c2IyTmhkR1ZNYVhOMFpXNWxjbk1vS1R0Y2JpQWdmVnh1WEc0Z0lGOWhiR3h2WTJGMFpVeHBjM1JsYm1WeWN5Z3BJSHRjYmlBZ0lDQnpkWEJsY2k1ZllXeHNiMk5oZEdWTWFYTjBaVzVsY25Nb0tUdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWDNSb2FYTXVYMjlpYW1WamRFeHBjM1JsYm1WeUlEMGdYM1JvYVhNdVgySjFjeTVoWkdSTWFYTjBaVzVsY2loZmRHaHBjeTVmZFhKc0xDQW9iWE5uS1NBOVBpQjdYRzRnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduUkdGMFlVOWlhbVZqZEMwbklDc2dYM1JvYVhNdVgzVnliQ0FySUNjdFVrTldPaUFuTENCdGMyY3BPMXh1SUNBZ0lDQWdjM2RwZEdOb0lDaHRjMmN1ZEhsd1pTa2dlMXh1SUNBZ0lDQWdJQ0JqWVhObElDZHlaWE53YjI1elpTYzZJRjkwYUdsekxsOXZibEpsYzNCdmJuTmxLRzF6WnlrN0lHSnlaV0ZyTzF4dUlDQWdJQ0FnSUNCallYTmxJQ2R5WldGa0p6b2dYM1JvYVhNdVgyOXVVbVZoWkNodGMyY3BPeUJpY21WaGF6dGNiaUFnSUNBZ0lIMWNiaUFnSUNCOUtUdGNiaUFnZlZ4dVhHNGdJRjl5Wld4bFlYTmxUR2x6ZEdWdVpYSnpLQ2tnZTF4dUlDQWdJSE4xY0dWeUxsOXlaV3hsWVhObFRHbHpkR1Z1WlhKektDazdYRzRnSUNBZ2JHVjBJRjkwYUdseklEMGdkR2hwY3p0Y2JseHVJQ0FnSUY5MGFHbHpMbDl2WW1wbFkzUk1hWE4wWlc1bGNpNXlaVzF2ZG1Vb0tUdGNiaUFnZlZ4dVhHNGdJQzhxS2x4dUlDQWdLaUJUWlc1a0lHbHVkbWwwWVhScGIyNXpJQ2hqY21WaGRHVWdiV1Z6YzJGblpYTXBJSFJ2SUdoNWNHVnlkR2xsY3l3Z2IySnpaWEoyWlhKeklHeHBjM1F1WEc0Z0lDQXFJRUJ3WVhKaGJTQWdlMGg1Y0dWeWRIbFZVa3hiWFgwZ2IySnpaWEoyWlhKeklFeHBjM1FnYjJZZ1NIbHdaWEowZVNCVlVrd25jMXh1SUNBZ0tpOWNiaUFnYVc1MmFYUmxUMkp6WlhKMlpYSnpLRzlpYzJWeWRtVnljeWtnZTF4dUlDQWdJR3hsZENCZmRHaHBjeUE5SUhSb2FYTTdYRzVjYmlBZ0lDQXZMMFpNVDFjdFQxVlVPaUIwYUdseklHMWxjM05oWjJVZ2QybHNiQ0JpWlNCelpXNTBJSFJ2SUhSb1pTQnlkVzUwYVcxbElHbHVjM1JoYm1ObElHOW1JRk41Ym1Ob1pYSk5ZVzVoWjJWeUlDMCtJRjl2YmtOeVpXRjBaVnh1SUNBZ0lHeGxkQ0JwYm5acGRHVk5jMmNnUFNCN1hHNGdJQ0FnSUNCMGVYQmxPaUFuWTNKbFlYUmxKeXdnWm5KdmJUb2dYM1JvYVhNdVgzTjVibU5vWlhJdVgyOTNibVZ5TENCMGJ6b2dYM1JvYVhNdVgzTjVibU5vWlhJdVgzTjFZbFZTVEN4Y2JpQWdJQ0FnSUdKdlpIazZJSHNnY21WemRXMWxPaUJtWVd4elpTd2djbVZ6YjNWeVkyVTZJRjkwYUdsekxsOTFjbXdzSUhOamFHVnRZVG9nWDNSb2FYTXVYM05qYUdWdFlTd2dkbUZzZFdVNklGOTBhR2x6TGw5emVXNWpUMkpxTG1SaGRHRXNJR0YxZEdodmNtbHpaVG9nYjJKelpYSjJaWEp6SUgxY2JpQWdJQ0I5TzF4dVhHNGdJQ0FnWDNSb2FYTXVYMkoxY3k1d2IzTjBUV1Z6YzJGblpTaHBiblpwZEdWTmMyY3BPMXh1SUNCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUZKbGJHVmhjMlVnWVc1a0lHUmxiR1YwWlNCdlltcGxZM1FnWkdGMFlWeHVJQ0FnS2k5Y2JpQWdaR1ZzWlhSbEtDa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNBdkwwWk1UMWN0VDFWVU9pQjBhR2x6SUcxbGMzTmhaMlVnZDJsc2JDQmlaU0J6Wlc1MElIUnZJSFJvWlNCeWRXNTBhVzFsSUdsdWMzUmhibU5sSUc5bUlGTjVibU5vWlhKTllXNWhaMlZ5SUMwK0lGOXZia1JsYkdWMFpWeHVJQ0FnSUd4bGRDQmtaV3hsZEdWTmMyY2dQU0I3WEc0Z0lDQWdJQ0IwZVhCbE9pQW5aR1ZzWlhSbEp5d2dabkp2YlRvZ1gzUm9hWE11WDI5M2JtVnlMQ0IwYnpvZ1gzUm9hWE11WDNONWJtTm9aWEl1WDNOMVlsVlNUQ3hjYmlBZ0lDQWdJR0p2WkhrNklIc2djbVZ6YjNWeVkyVTZJRjkwYUdsekxsOTFjbXdnZlZ4dUlDQWdJSDA3WEc1Y2JpQWdJQ0JmZEdocGN5NWZZblZ6TG5CdmMzUk5aWE56WVdkbEtHUmxiR1YwWlUxelp5d2dLSEpsY0d4NUtTQTlQaUI3WEc0Z0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblJHRjBZVTlpYW1WamRGSmxjRzl5ZEdWeUxVUkZURVZVUlRvZ0p5d2djbVZ3YkhrcE8xeHVJQ0FnSUNBZ2FXWWdLSEpsY0d4NUxtSnZaSGt1WTI5a1pTQTlQVDBnTWpBd0tTQjdYRzRnSUNBZ0lDQWdJRjkwYUdsekxsOXlaV3hsWVhObFRHbHpkR1Z1WlhKektDazdYRzRnSUNBZ0lDQWdJR1JsYkdWMFpTQmZkR2hwY3k1ZmMzbHVZMmhsY2k1ZmNtVndiM0owWlhKelcxOTBhR2x6TGw5MWNteGRPMXh1SUNBZ0lDQWdmVnh1SUNBZ0lIMHBPMXh1SUNCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUZOMVluTmpjbWx3ZEdsdmJuTWdjbVZ4ZFdWemRHVmtJR0Z1WkNCaFkyTmxjSFJsWkNCMGJ5QjBhR2x6SUhKbGNHOXlkR1Z5WEc0Z0lDQXFJRUIwZVhCbElIdFBZbXBsWTNROFNIbHdaWEowZVZWU1RDd2dVM2x1WTFOMVluTmpjbWx3ZEdsdmJqNTlYRzRnSUNBcUwxeHVJQ0JuWlhRZ2MzVmljMk55YVhCMGFXOXVjeWdwSUhzZ2NtVjBkWEp1SUhSb2FYTXVYM04xWW5OamNtbHdkR2x2Ym5NN0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1UyVjBkWEFnZEdobElHTmhiR3hpWVdOcklIUnZJSEJ5YjJObGMzTWdjM1ZpYzJOeWFXSmxJR0Z1WkNCMWJuTjFZbk5qY21saVpTQnViM1JwWm1sallYUnBiMjV6WEc0Z0lDQXFJRUJ3WVhKaGJTQjdablZ1WTNScGIyNG9aWFpsYm5RNklFMXpaMFYyWlc1MEtYMGdZMkZzYkdKaFkyc2dablZ1WTNScGIyNGdkRzhnY21WalpXbDJaU0JsZG1WdWRITmNiaUFnSUNvdlhHNGdJRzl1VTNWaWMyTnlhWEIwYVc5dUtHTmhiR3hpWVdOcktTQjdYRzRnSUNBZ2RHaHBjeTVmYjI1VGRXSnpZM0pwY0hScGIyNUlZVzVrYkdWeUlEMGdZMkZzYkdKaFkyczdYRzRnSUgxY2JseHVJQ0F2S2lwY2JpQWdJQ29nVTJWMGRYQWdkR2hsSUdOaGJHeGlZV05ySUhSdklIQnliMk5sYzNNZ2NtVnpjRzl1YzJVZ2JtOTBhV1pwWTJGMGFXOXVjeUJ2WmlCMGFHVWdZM0psWVhSbEozTmNiaUFnSUNvZ1FIQmhjbUZ0SUh0bWRXNWpkR2x2YmlobGRtVnVkRG9nVFhOblJYWmxiblFwZlNCallXeHNZbUZqYXlCbWRXNWpkR2x2YmlCMGJ5QnlaV05sYVhabElHVjJaVzUwYzF4dUlDQWdLaTljYmlBZ2IyNVNaWE53YjI1elpTaGpZV3hzWW1GamF5a2dlMXh1SUNBZ0lIUm9hWE11WDI5dVVtVnpjRzl1YzJWSVlXNWtiR1Z5SUQwZ1kyRnNiR0poWTJzN1hHNGdJSDFjYmx4dUlDQXZLaXBjYmlBZ0lDb2dVMlYwZFhBZ2RHaGxJR05oYkd4aVlXTnJJSFJ2SUhCeWIyTmxjM01nY21WaFpDQnViM1JwWm1sallYUnBiMjV6WEc0Z0lDQXFJRUJ3WVhKaGJTQjdablZ1WTNScGIyNG9aWFpsYm5RNklFMXpaMFYyWlc1MEtYMGdZMkZzYkdKaFkydGNiaUFnSUNvdlhHNGdJRzl1VW1WaFpDaGpZV3hzWW1GamF5a2dlMXh1SUNBZ0lIUm9hWE11WDI5dVVtVmhaRWhoYm1Sc1pYSWdQU0JqWVd4c1ltRmphenRjYmlBZ2ZWeHVYRzRnSUM4dlJreFBWeTFKVGpvZ2JXVnpjMkZuWlNCeVpXTmxhWFpsWkNCbWNtOXRJSEJoY21WdWRDQlRlVzVqYUdWeUlDMCtJRjl2YmtadmNuZGhjbVJjYmlBZ1gyOXVSbTl5ZDJGeVpDaHRjMmNwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdZMjl1YzI5c1pTNXNiMmNvSjBSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2kxU1ExWTZJQ2NzSUcxelp5azdYRzRnSUNBZ2MzZHBkR05vSUNodGMyY3VZbTlrZVM1MGVYQmxLU0I3WEc0Z0lDQWdJQ0JqWVhObElDZHpkV0p6WTNKcFltVW5PaUJmZEdocGN5NWZiMjVUZFdKelkzSnBZbVVvYlhObktUc2dZbkpsWVdzN1hHNGdJQ0FnSUNCallYTmxJQ2QxYm5OMVluTmpjbWxpWlNjNklGOTBhR2x6TGw5dmJsVnVVM1ZpYzJOeWFXSmxLRzF6WnlrN0lHSnlaV0ZyTzF4dUlDQWdJSDFjYmlBZ2ZWeHVYRzRnSUM4dlJreFBWeTFKVGpvZ2JXVnpjMkZuWlNCeVpXTmxhWFpsWkNCbWNtOXRJSFJvYVhNZ0xUNGdYMjl1Um05eWQyRnlaRG9nWlcxcGRIUmxaQ0JpZVNCaElISmxiVzkwWlNCVGVXNWphR1Z5SUMwK0lITjFZbk5qY21saVpWeHVJQ0JmYjI1VGRXSnpZM0pwWW1Vb2JYTm5LU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNiaUFnSUNCc1pYUWdhSGx3WlhKMGVWVnliQ0E5SUcxelp5NWliMlI1TG1aeWIyMDdYRzRnSUNBZ1kyOXVjMjlzWlM1c2IyY29KMXRFWVhSaFQySnFaV04wVW1Wd2IzSjBaWEl1WDI5dVUzVmljMk55YVdKbFhTY3NJRzF6WnlrN1hHNWNiaUFnSUNCc1pYUWdaWFpsYm5RZ1BTQjdYRzRnSUNBZ0lDQjBlWEJsT2lCdGMyY3VZbTlrZVM1MGVYQmxMRnh1SUNBZ0lDQWdkWEpzT2lCb2VYQmxjblI1VlhKc0xGeHVYRzRnSUNBZ0lDQnBaR1Z1ZEdsMGVUb2diWE5uTG1KdlpIa3VhV1JsYm5ScGRIa3NYRzVjYmlBZ0lDQWdJR0ZqWTJWd2REb2dLQ2tnUFQ0Z2UxeHVJQ0FnSUNBZ0lDQXZMMk55WldGMFpTQnVaWGNnYzNWaWMyTnlhWEIwYVc5dVhHNGdJQ0FnSUNBZ0lHeGxkQ0J6ZFdJZ1BTQjdJSFZ5YkRvZ2FIbHdaWEowZVZWeWJDd2djM1JoZEhWek9pQW5iMjRuSUgwN1hHNGdJQ0FnSUNBZ0lGOTBhR2x6TGw5emRXSnpZM0pwY0hScGIyNXpXMmg1Y0dWeWRIbFZjbXhkSUQwZ2MzVmlPMXh1WEc0Z0lDQWdJQ0FnSUM4dmNISnZZMlZ6Y3lCaGJtUWdjMlZ1WkNCamFHbHNaSEpsYm5NZ1pHRjBZVnh1SUNBZ0lDQWdJQ0JzWlhRZ1kyaHBiR1J5Wlc1V1lXeDFaWE1nUFNCN2ZUdGNiaUFnSUNBZ0lDQWdUMkpxWldOMExtdGxlWE1vWDNSb2FYTXVYMk5vYVd4a2NtVnVUMkpxWldOMGN5a3VabTl5UldGamFDZ29ZMmhwYkdSSlpDa2dQVDRnZTF4dUlDQWdJQ0FnSUNBZ0lHeGxkQ0JqYUdsc1pFUmhkR0VnUFNCZmRHaHBjeTVmWTJocGJHUnlaVzVQWW1wbFkzUnpXMk5vYVd4a1NXUmRMbVJoZEdFN1hHNGdJQ0FnSUNBZ0lDQWdZMmhwYkdSeVpXNVdZV3gxWlhOYlkyaHBiR1JKWkYwZ1BTQmtaV1Z3UTJ4dmJtVW9ZMmhwYkdSRVlYUmhLVHRjYmlBZ0lDQWdJQ0FnZlNrN1hHNWNiaUFnSUNBZ0lDQWdiR1YwSUhObGJtUk5jMmNnUFNCN1hHNGdJQ0FnSUNBZ0lDQWdhV1E2SUcxelp5NXBaQ3dnZEhsd1pUb2dKM0psYzNCdmJuTmxKeXdnWm5KdmJUb2diWE5uTG5SdkxDQjBiem9nYlhObkxtWnliMjBzWEc0Z0lDQWdJQ0FnSUNBZ1ltOWtlVG9nZXlCamIyUmxPaUF5TURBc0lITmphR1Z0WVRvZ1gzUm9hWE11WDNOamFHVnRZU3dnZG1WeWMybHZiam9nWDNSb2FYTXVYM1psY25OcGIyNHNJSFpoYkhWbE9pQjdJR1JoZEdFNklHUmxaWEJEYkc5dVpTaGZkR2hwY3k1a1lYUmhLU3dnWTJocGJHUnlaVzV6T2lCamFHbHNaSEpsYmxaaGJIVmxjeUI5SUgxY2JpQWdJQ0FnSUNBZ2ZUdGNibHh1SUNBZ0lDQWdJQ0F2TDFSUFJFODZJRVp2Y2lCR2RYSjBhR1Z5SUZOMGRXUjVYRzRnSUNBZ0lDQWdJR2xtSUNodGMyY3VZbTlrZVM1b1lYTlBkMjVRY205d1pYSjBlU2duYlhWMGRXRnNRWFYwYUdWdWRHbGpZWFJwYjI0bktTQW1KaUFoYlhObkxtSnZaSGt1YlhWMGRXRnNRWFYwYUdWdWRHbGpZWFJwYjI0cElIdGNiaUFnSUNBZ0lDQWdJQ0J6Wlc1a1RYTm5MbUp2WkhrdWJYVjBkV0ZzUVhWMGFHVnVkR2xqWVhScGIyNGdQU0IwYUdsekxsOXRkWFIxWVd4QmRYUm9aVzUwYVdOaGRHbHZianRjYmlBZ0lDQWdJQ0FnSUNCMGFHbHpMbDl0ZFhSMVlXeEJkWFJvWlc1MGFXTmhkR2x2YmlBOUlHMXpaeTVpYjJSNUxtMTFkSFZoYkVGMWRHaGxiblJwWTJGMGFXOXVPMXh1SUNBZ0lDQWdJQ0I5WEc1Y2JpQWdJQ0FnSUNBZ0x5OXpaVzVrSUc5cklISmxjM0J2Ym5ObElHMWxjM05oWjJWY2JpQWdJQ0FnSUNBZ1gzUm9hWE11WDJKMWN5NXdiM04wVFdWemMyRm5aU2h6Wlc1a1RYTm5LVHRjYmx4dUlDQWdJQ0FnSUNCeVpYUjFjbTRnYzNWaU8xeHVJQ0FnSUNBZ2ZTeGNibHh1SUNBZ0lDQWdjbVZxWldOME9pQW9jbVZoYzI5dUtTQTlQaUI3WEc0Z0lDQWdJQ0FnSUM4dmMyVnVaQ0J5WldwbFkzUWdjbVZ6Y0c5dWMyVWdiV1Z6YzJGblpWeHVJQ0FnSUNBZ0lDQmZkR2hwY3k1ZlluVnpMbkJ2YzNSTlpYTnpZV2RsS0h0Y2JpQWdJQ0FnSUNBZ0lDQnBaRG9nYlhObkxtbGtMQ0IwZVhCbE9pQW5jbVZ6Y0c5dWMyVW5MQ0JtY205dE9pQnRjMmN1ZEc4c0lIUnZPaUJ0YzJjdVpuSnZiU3hjYmlBZ0lDQWdJQ0FnSUNCaWIyUjVPaUI3SUdOdlpHVTZJRFF3TXl3Z1pHVnpZem9nY21WaGMyOXVJSDFjYmlBZ0lDQWdJQ0FnZlNrN1hHNGdJQ0FnSUNCOVhHNGdJQ0FnZlR0Y2JseHVJQ0FnSUdsbUlDaGZkR2hwY3k1ZmIyNVRkV0p6WTNKcGNIUnBiMjVJWVc1a2JHVnlLU0I3WEc0Z0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblUxVkNVME5TU1ZCVVNVOU9MVVZXUlU1VU9pQW5MQ0JsZG1WdWRDazdYRzRnSUNBZ0lDQmZkR2hwY3k1ZmIyNVRkV0p6WTNKcGNIUnBiMjVJWVc1a2JHVnlLR1YyWlc1MEtUdGNiaUFnSUNCOVhHNGdJSDFjYmx4dUlDQXZMMFpNVDFjdFNVNDZJRzFsYzNOaFoyVWdjbVZqWldsMlpXUWdabkp2YlNCMGFHbHpJQzArSUY5dmJrWnZjbmRoY21RNklHVnRhWFIwWldRZ1lua2dZU0J5WlcxdmRHVWdSR0YwWVU5aWFtVmpkRTlpYzJWeWRtVnlJQzArSUhWdWMzVmljMk55YVdKbFhHNGdJRjl2YmxWdVUzVmljMk55YVdKbEtHMXpaeWtnZTF4dUlDQWdJR3hsZENCZmRHaHBjeUE5SUhSb2FYTTdYRzRnSUNBZ2JHVjBJR2g1Y0dWeWRIbFZjbXdnUFNCdGMyY3VZbTlrZVM1bWNtOXRPMXh1WEc0Z0lDQWdiR1YwSUhOMVlpQTlJRjkwYUdsekxsOXpkV0p6WTNKcGNIUnBiMjV6VzJoNWNHVnlkSGxWY214ZE8xeHVJQ0FnSUdSbGJHVjBaU0JmZEdocGN5NWZjM1ZpYzJOeWFYQjBhVzl1YzF0b2VYQmxjblI1VlhKc1hUdGNibHh1SUNBZ0lHeGxkQ0JsZG1WdWRDQTlJSHRjYmlBZ0lDQWdJSFI1Y0dVNklHMXpaeTVpYjJSNUxuUjVjR1VzWEc0Z0lDQWdJQ0IxY213NklHaDVjR1Z5ZEhsVmNtd3NYRzRnSUNBZ0lDQnZZbXBsWTNRNklITjFZbHh1SUNBZ0lIMDdYRzVjYmlBZ0lDQnBaaUFvWDNSb2FYTXVYMjl1VTNWaWMyTnlhWEIwYVc5dVNHRnVaR3hsY2lrZ2UxeHVJQ0FnSUNBZ1kyOXVjMjlzWlM1c2IyY29KMVZPTFZOVlFsTkRVa2xRVkVsUFRpMUZWa1ZPVkRvZ0p5d2daWFpsYm5RcE8xeHVJQ0FnSUNBZ1gzUm9hWE11WDI5dVUzVmljMk55YVhCMGFXOXVTR0Z1Wkd4bGNpaGxkbVZ1ZENrN1hHNGdJQ0FnZlZ4dUlDQjlYRzVjYmlBZ0x5OUdURTlYTFVsT09pQnRaWE56WVdkbElISmxZMlZwZG1Wa0lHWnliMjBnVW1Wd2IzSjBaWEpWVWt3Z1lXUmtjbVZ6Y3pvZ1pXMXBkR1ZrSUdKNUlHRWdjbVZ0YjNSbElGTjVibU5vWlhJZ0xUNGdYMjl1VW1WdGIzUmxRM0psWVhSbElDMCtJR1YyWlc1MExtRmphMXh1SUNCZmIyNVNaWE53YjI1elpTaHRjMmNwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdiR1YwSUdWMlpXNTBJRDBnZTF4dUlDQWdJQ0FnZEhsd1pUb2diWE5uTG5SNWNHVXNYRzRnSUNBZ0lDQjFjbXc2SUcxelp5NW1jbTl0TEZ4dUlDQWdJQ0FnWTI5a1pUb2diWE5uTG1KdlpIa3VZMjlrWlZ4dUlDQWdJSDA3WEc1Y2JpQWdJQ0JwWmlBb1gzUm9hWE11WDI5dVVtVnpjRzl1YzJWSVlXNWtiR1Z5S1NCN1hHNGdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25Va1ZUVUU5T1UwVXRSVlpGVGxRNklDY3NJR1YyWlc1MEtUdGNiaUFnSUNBZ0lGOTBhR2x6TGw5dmJsSmxjM0J2Ym5ObFNHRnVaR3hsY2lobGRtVnVkQ2s3WEc0Z0lDQWdmVnh1SUNCOVhHNWNiaUFnTHk5R1RFOVhMVWxPT2lCdFpYTnpZV2RsSUhKbFkyVnBkbVZrSUdaeWIyMGdVbVZ3YjNKMFpYSlZVa3dnWVdSa2NtVnpjem9nWlcxcGRHVmtJR0o1SUdFZ2NtVnRiM1JsSUZONWJtTm9aWElnTFQ0Z2NtVmhaRnh1SUNCZmIyNVNaV0ZrS0cxelp5a2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNCc1pYUWdaWFpsYm5RZ1BTQjdYRzRnSUNBZ0lDQjBlWEJsT2lCdGMyY3VkSGx3WlN4Y2JpQWdJQ0FnSUhWeWJEb2diWE5uTG1aeWIyMHNYRzVjYmlBZ0lDQWdJR0ZqWTJWd2REb2dLQ2tnUFQ0Z2UxeHVJQ0FnSUNBZ0lDQmZkR2hwY3k1ZlluVnpMbkJ2YzNSTlpYTnpZV2RsS0h0Y2JpQWdJQ0FnSUNBZ0lDQnBaRG9nYlhObkxtbGtMQ0IwZVhCbE9pQW5jbVZ6Y0c5dWMyVW5MQ0JtY205dE9pQnRjMmN1ZEc4c0lIUnZPaUJ0YzJjdVpuSnZiU3hjYmlBZ0lDQWdJQ0FnSUNCaWIyUjVPaUI3SUdOdlpHVTZJREl3TUN3Z2RtRnNkV1U2SUdSbFpYQkRiRzl1WlNoZmRHaHBjeTVrWVhSaEtTQjlYRzRnSUNBZ0lDQWdJSDBwTzF4dUlDQWdJQ0FnZlN4Y2JseHVJQ0FnSUNBZ2NtVnFaV04wT2lBb2NtVmhjMjl1S1NBOVBpQjdYRzRnSUNBZ0lDQWdJRjkwYUdsekxsOWlkWE11Y0c5emRFMWxjM05oWjJVb2UxeHVJQ0FnSUNBZ0lDQWdJR2xrT2lCdGMyY3VhV1FzSUhSNWNHVTZJQ2R5WlhOd2IyNXpaU2NzSUdaeWIyMDZJRzF6Wnk1MGJ5d2dkRzg2SUcxelp5NW1jbTl0TEZ4dUlDQWdJQ0FnSUNBZ0lHSnZaSGs2SUhzZ1kyOWtaVG9nTkRBeExDQmtaWE5qT2lCeVpXRnpiMjRnZlZ4dUlDQWdJQ0FnSUNCOUtUdGNiaUFnSUNBZ0lIMWNiaUFnSUNCOU8xeHVYRzRnSUNBZ2FXWWdLRjkwYUdsekxsOXZibEpsWVdSSVlXNWtiR1Z5S1NCN1hHNGdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25Va1ZCUkMxRlZrVk9WRG9nSnl3Z1pYWmxiblFwTzF4dUlDQWdJQ0FnWDNSb2FYTXVYMjl1VW1WaFpFaGhibVJzWlhJb1pYWmxiblFwTzF4dUlDQWdJSDFjYmlBZ2ZWeHVYRzU5WEc1Y2JtVjRjRzl5ZENCa1pXWmhkV3gwSUVSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2p0Y2JseHVYRzVjYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTSUM4dlhHNHZMeUF1TDNOeVl5OXplVzVqYUdWeUwwUmhkR0ZQWW1wbFkzUlNaWEJ2Y25SbGNpNXFjeUlzSWk4cUtseHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQlFWQ0JKYm05MlljT253Nk52SUdVZ1UybHpkR1Z0WVhNZ1UwRmNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdTVTVGVTBNdFNVUmNiaW9nUTI5d2VYSnBaMmgwSURJd01UWWdVVlZQUWtsVElFNUZWRmRQVWt0VElGTk1YRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRVpTUVZWT1NFOUdSVkl0UjBWVFJVeE1VME5JUVVaVUlGcFZVaUJHVDBWU1JFVlNWVTVISUVSRlVpQkJUa2RGVjBGT1JGUkZUaUJHVDFKVFEwaFZUa2NnUlM1V1hHNHFJRU52Y0hseWFXZG9kQ0F5TURFMklFOVNRVTVIUlNCVFFWeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQkVaWFYwYzJOb1pTQlVaV3hsYTI5dElFRkhYRzRxSUVOdmNIbHlhV2RvZENBeU1ERTJJRUZ3YVhwbFpWeHVLaUJEYjNCNWNtbG5hSFFnTWpBeE5pQlVSVU5JVGtsVFEwaEZJRlZPU1ZaRlVsTkpWRUZVSUVKRlVreEpUbHh1S2x4dUtpQk1hV05sYm5ObFpDQjFibVJsY2lCMGFHVWdRWEJoWTJobElFeHBZMlZ1YzJVc0lGWmxjbk5wYjI0Z01pNHdJQ2gwYUdVZ1hDSk1hV05sYm5ObFhDSXBPMXh1S2lCNWIzVWdiV0Y1SUc1dmRDQjFjMlVnZEdocGN5Qm1hV3hsSUdWNFkyVndkQ0JwYmlCamIyMXdiR2xoYm1ObElIZHBkR2dnZEdobElFeHBZMlZ1YzJVdVhHNHFJRmx2ZFNCdFlYa2diMkowWVdsdUlHRWdZMjl3ZVNCdlppQjBhR1VnVEdsalpXNXpaU0JoZEZ4dUtseHVLaUFnSUdoMGRIQTZMeTkzZDNjdVlYQmhZMmhsTG05eVp5OXNhV05sYm5ObGN5OU1TVU5GVGxORkxUSXVNRnh1S2x4dUtpQlZibXhsYzNNZ2NtVnhkV2x5WldRZ1lua2dZWEJ3YkdsallXSnNaU0JzWVhjZ2IzSWdZV2R5WldWa0lIUnZJR2x1SUhkeWFYUnBibWNzSUhOdlpuUjNZWEpsWEc0cUlHUnBjM1J5YVdKMWRHVmtJSFZ1WkdWeUlIUm9aU0JNYVdObGJuTmxJR2x6SUdScGMzUnlhV0oxZEdWa0lHOXVJR0Z1SUZ3aVFWTWdTVk5jSWlCQ1FWTkpVeXhjYmlvZ1YwbFVTRTlWVkNCWFFWSlNRVTVVU1VWVElFOVNJRU5QVGtSSlZFbFBUbE1nVDBZZ1FVNVpJRXRKVGtRc0lHVnBkR2hsY2lCbGVIQnlaWE56SUc5eUlHbHRjR3hwWldRdVhHNHFJRk5sWlNCMGFHVWdUR2xqWlc1elpTQm1iM0lnZEdobElITndaV05wWm1saklHeGhibWQxWVdkbElHZHZkbVZ5Ym1sdVp5QndaWEp0YVhOemFXOXVjeUJoYm1SY2Jpb2diR2x0YVhSaGRHbHZibk1nZFc1a1pYSWdkR2hsSUV4cFkyVnVjMlV1WEc0cUtpOWNibHh1YVcxd2IzSjBJRk41Ym1OUFltcGxZM1FzSUh0RGFHRnVaMlZVZVhCbExDQlBZbXBsWTNSVWVYQmxmU0JtY205dElDY3VMMUJ5YjNoNVQySnFaV04wSnp0Y2JtbHRjRzl5ZENCRVlYUmhUMkpxWldOMFEyaHBiR1FnWm5KdmJTQW5MaTlFWVhSaFQySnFaV04wUTJocGJHUW5PMXh1YVcxd2IzSjBJSHRrWldWd1EyeHZibVY5SUdaeWIyMGdKeTR1TDNWMGFXeHpMM1YwYVd4ekxtcHpKenRjYmx4dUx5b3FYRzRnS2lCTllXbHVJR1Y0ZEdWdWMybHZiaUJqYkdGemN5Qm1iM0lnYjJKelpYSjJaWEp6SUdGdVpDQnlaWEJ2Y25SbGNuTXNJSGRwZEdnZ1kyOXRiVzl1SUhCeWIzQmxjblJwWlhNZ1lXNWtJRzFsZEdodlpITXVYRzRnS2lCRGFHbHNaSEpsYmlCdFlXNWhaMlZ0Wlc1MElHbHpJR052YlcxdmJpQm1iM0lnYjJKelpYSjJaWEp6SUdGdVpDQnlaWEJ2Y25SbGNuTXVYRzRnS2k5Y2JtTnNZWE56SUVSaGRHRlBZbXBsWTNRZ2UxeHVJQ0F2S2lCd2NtbDJZWFJsWEc0Z0lGOTJaWEp6YVc5dU9pQnVkVzFpWlhKY2JseHVJQ0JmYjNkdVpYSTZJRWg1Y0dWeWRIbFZVa3hjYmlBZ1gzVnliRG9nVDJKcVpXTjBWVkpNWEc0Z0lGOXpZMmhsYldFNklGTmphR1Z0WVZ4dUlDQmZZblZ6T2lCTmFXNXBRblZ6WEc0Z0lGOXpkR0YwZFhNNklHOXVJSHdnY0dGMWMyVmtYRzRnSUY5emVXNWpUMkpxT2lCVGVXNWpSR0YwWVZ4dVhHNGdJRjlqYUdsc1pISmxiam9nZXlCcFpEb2dSR0YwWVU5aWFtVmpkRU5vYVd4a0lIMWNiaUFnWDJOb2FXeGtjbVZ1VEdsemRHVnVaWEp6T2lCYlRYTm5UR2x6ZEdWdVpYSmRYRzVjYmlBZ0xTMHRMV1YyWlc1MElHaGhibVJzWlhKekxTMHRMVnh1SUNCZmIyNUJaR1JEYUdsc1pFaGhibVJzWlhJNklDaGxkbVZ1ZENrZ1BUNGdkbTlwWkZ4dUlDQXFMMXh1WEc0Z0lDOHFLbHh1SUNBZ0tpQkFhV2R1YjNKbFhHNGdJQ0FxSUZOb2IzVnNaQ0J1YjNRZ1ltVWdkWE5sWkNCa2FYSmxZM1JzZVNCaWVTQkllWEJsY25ScFpYTXVJRWwwSjNNZ1kyRnNiR1ZrSUdKNUlIUm9aU0JUZVc1amFHVnlJR055WldGMFpTQnZjaUJ6ZFdKelkzSnBZbVVnYldWMGFHOWtKM05jYmlBZ0lDb3ZYRzRnSUdOdmJuTjBjblZqZEc5eUtITjVibU5vWlhJc0lIVnliQ3dnYzJOb1pXMWhMQ0JwYm1sMGFXRnNVM1JoZEhWekxDQnBibWwwYVdGc1JHRjBZU3dnWTJocGJHUnlaVzV6TENCdGRYUjFZV3dnUFNCMGNuVmxLU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lGOTBhR2x6TGw5emVXNWphR1Z5SUQwZ2MzbHVZMmhsY2p0Y2JpQWdJQ0JmZEdocGN5NWZkWEpzSUQwZ2RYSnNPMXh1SUNBZ0lGOTBhR2x6TGw5elkyaGxiV0VnUFNCelkyaGxiV0U3WEc0Z0lDQWdYM1JvYVhNdVgzTjBZWFIxY3lBOUlHbHVhWFJwWVd4VGRHRjBkWE03WEc0Z0lDQWdYM1JvYVhNdVgzTjVibU5QWW1vZ1BTQnVaWGNnVTNsdVkwOWlhbVZqZENocGJtbDBhV0ZzUkdGMFlTazdYRzRnSUNBZ1gzUm9hWE11WDJOb2FXeGtjbVZ1Y3lBOUlHTm9hV3hrY21WdWN6dGNibHh1SUNBZ0lDOHZWRTlFVHpvZ1JtOXlJRVoxY25Sb1pYSWdVM1IxWkhsY2JpQWdJQ0JmZEdocGN5NWZiWFYwZFdGc1FYVjBhR1Z1ZEdsallYUnBiMjRnUFNCdGRYUjFZV3c3WEc1Y2JpQWdJQ0JmZEdocGN5NWZkbVZ5YzJsdmJpQTlJREE3WEc0Z0lDQWdYM1JvYVhNdVgyTm9hV3hrU1dRZ1BTQXdPMXh1SUNBZ0lGOTBhR2x6TGw5amFHbHNaSEpsYms5aWFtVmpkSE1nUFNCN2ZUdGNiaUFnSUNCZmRHaHBjeTVmWTJocGJHUnlaVzVNYVhOMFpXNWxjbk1nUFNCYlhUdGNibHh1SUNBZ0lGOTBhR2x6TGw5dmQyNWxjaUE5SUhONWJtTm9aWEl1WDI5M2JtVnlPMXh1SUNBZ0lGOTBhR2x6TGw5aWRYTWdQU0J6ZVc1amFHVnlMbDlpZFhNN1hHNGdJSDFjYmx4dUlDQmZZV3hzYjJOaGRHVk1hWE4wWlc1bGNuTW9LU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lHeGxkQ0JqYUdsc1pFSmhjMlZWVWt3Z1BTQmZkR2hwY3k1ZmRYSnNJQ3NnSnk5amFHbHNaSEpsYmk4bk8xeHVJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZGJSR0YwWVNCUFltcGxZM1FnTFNCQmJHeHZZMkYwWlV4cGMzUmxibVZ5YzEwZ0xTQW5MQ0JmZEdocGN5NWZZMmhwYkdSeVpXNXpLVHRjYmlBZ0lDQnBaaUFvWDNSb2FYTXVYMk5vYVd4a2NtVnVjeWtnZTF4dUlDQWdJQ0FnWDNSb2FYTXVYMk5vYVd4a2NtVnVjeTVtYjNKRllXTm9LQ2hqYUdsc1pDa2dQVDRnZTF4dUlDQWdJQ0FnSUNCc1pYUWdZMmhwYkdSVlVrd2dQU0JqYUdsc1pFSmhjMlZWVWt3Z0t5QmphR2xzWkR0Y2JpQWdJQ0FnSUNBZ2JHVjBJR3hwYzNSbGJtVnlJRDBnWDNSb2FYTXVYMkoxY3k1aFpHUk1hWE4wWlc1bGNpaGphR2xzWkZWU1RDd2dLRzF6WnlrZ1BUNGdlMXh1SUNBZ0lDQWdJQ0FnSUM4dmFXZHViM0psSUcxelp5QnpaVzUwSUdKNUlHaHBiWE5sYkdaY2JpQWdJQ0FnSUNBZ0lDQnBaaUFvYlhObkxtWnliMjBnSVQwOUlIUm9hWE11WDI5M2JtVnlLU0I3WEc0Z0lDQWdJQ0FnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduUkdGMFlVOWlhbVZqZEMxRGFHbHNaSEpsYmkxU1ExWTZJQ2NzSUcxelp5azdYRzRnSUNBZ0lDQWdJQ0FnSUNCemQybDBZMmdnS0cxelp5NTBlWEJsS1NCN1hHNGdJQ0FnSUNBZ0lDQWdJQ0FnSUdOaGMyVWdKMk55WldGMFpTYzZJRjkwYUdsekxsOXZia05vYVd4a1EzSmxZWFJsS0cxelp5azdJR0p5WldGck8xeHVJQ0FnSUNBZ0lDQWdJQ0FnSUNCallYTmxJQ2RrWld4bGRHVW5PaUJqYjI1emIyeGxMbXh2WnlodGMyY3BPeUJpY21WaGF6dGNiaUFnSUNBZ0lDQWdJQ0FnSUNBZ1pHVm1ZWFZzZERvZ1gzUm9hWE11WDJOb1lXNW5aVU5vYVd4a2NtVnVLRzF6WnlrN0lHSnlaV0ZyTzF4dUlDQWdJQ0FnSUNBZ0lDQWdmVnh1SUNBZ0lDQWdJQ0FnSUgxY2JpQWdJQ0FnSUNBZ2ZTazdYRzVjYmlBZ0lDQWdJQ0FnWDNSb2FYTXVYMk5vYVd4a2NtVnVUR2x6ZEdWdVpYSnpMbkIxYzJnb2JHbHpkR1Z1WlhJcE8xeHVJQ0FnSUNBZ2ZTazdYRzRnSUNBZ2ZWeHVJQ0I5WEc1Y2JpQWdYM0psYkdWaGMyVk1hWE4wWlc1bGNuTW9LU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lGOTBhR2x6TGw5amFHbHNaSEpsYmt4cGMzUmxibVZ5Y3k1bWIzSkZZV05vS0Noc2FYTjBaVzVsY2lrZ1BUNGdlMXh1SUNBZ0lDQWdiR2x6ZEdWdVpYSXVjbVZ0YjNabEtDazdYRzRnSUNBZ2ZTazdYRzVjYmlBZ0lDQlBZbXBsWTNRdWEyVjVjeWhmZEdocGN5NWZZMmhwYkdSeVpXNVBZbXBsWTNSektTNW1iM0pGWVdOb0tDaHJaWGtwSUQwK0lIdGNiaUFnSUNBZ0lGOTBhR2x6TGw5amFHbHNaSEpsYms5aWFtVmpkSE5iYTJWNVhTNWZjbVZzWldGelpVeHBjM1JsYm1WeWN5Z3BPMXh1SUNBZ0lIMHBPMXh1SUNCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUU5aWFtVmpkQ0JWVWt3Z2IyWWdjbVZ3YjNKMFpYSWdiM0lnYjJKelpYSjJaWEpjYmlBZ0lDb2dRSFI1Y0dVZ2UwOWlhbVZqZEZWU1RIMWNiaUFnSUNvdlhHNGdJR2RsZENCMWNtd29LU0I3SUhKbGRIVnliaUIwYUdsekxsOTFjbXc3SUgxY2JseHVJQ0F2S2lwY2JpQWdJQ29nVDJKcVpXTjBJSE5qYUdWdFlTQlZVa3dnS0hSb2FYTWdabWxsYkdRZ2FYTWdibTkwSUhsbGRDQnpkR0ZpYkdVc0lHRnVaQ0JwY3lCemRXSnphbVZqZENCMGJ5QmphR0Z1WjJVcFhHNGdJQ0FxSUVCMGVYQmxJSHRUWTJobGJXRlZVa3g5WEc0Z0lDQXFMMXh1SUNCblpYUWdjMk5vWlcxaEtDa2dleUJ5WlhSMWNtNGdkR2hwY3k1ZmMyTm9aVzFoT3lCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUZOMFlYUjFjeUJ2WmlCMGFHVWdjbVZ3YjNKMFpYSWdiM0lnYjJKelpYSjJaWElnWTI5dWJtVmpkR2x2YmlBb2RHaHBjeUJtYVdWc1pDQnBjeUJ1YjNRZ2VXVjBJSE4wWVdKc1pTd2dZVzVrSUdseklITjFZbk5xWldOMElIUnZJR05vWVc1blpTbGNiaUFnSUNvZ1FIUjVjR1VnZTFOMFlYUjFjMzBnTFNCRmJuVnRJRzltT2lCdmJpQjhJSEJoZFhObFpGeHVJQ0FnS2k5Y2JpQWdaMlYwSUhOMFlYUjFjeWdwSUhzZ2NtVjBkWEp1SUhSb2FYTXVYM04wWVhSMWN6c2dmVnh1WEc0Z0lDOHFLbHh1SUNBZ0tpQkVZWFJoSUhOMGNuVmpkSFZ5WlNCMGJ5QmlaU0J6ZVc1amFISnZibWw2WldRdVhHNGdJQ0FxSUVCMGVYQmxJSHRLVTA5T2ZTQXRJRXBUVDA0Z2MzUnlkV04wZFhKbElIUm9ZWFFnYzJodmRXeGtJR1p2Ykd4dmR5QjBhR1VnWkdWbWFXNWxaQ0J6WTJobGJXRXNJR2xtSUdGdWVTNWNiaUFnSUNvdlhHNGdJR2RsZENCa1lYUmhLQ2tnZXlCeVpYUjFjbTRnZEdocGN5NWZjM2x1WTA5aWFpNWtZWFJoT3lCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUVGc2JDQmpjbVZoZEdWa0lHTm9hV3hrY21WdUozTWdjMmx1WTJVZ2RHaGxJSE4xWW5OamNtbHdkR2x2Yml3Z1pHOWxjMjRuZENCamIyNTBZV2x1SUdGc2JDQmphR2xzWkhKbGJpZHpJSE5wYm1ObElISmxjRzl5ZEdWeUlHTnlaV0YwYVc5dUxseHVJQ0FnS2lCQWRIbHdaU0I3VDJKcVpXTjBQRU5vYVd4a1NXUXNJRVJoZEdGUFltcGxZM1JEYUdsc1pENTlYRzRnSUNBcUwxeHVJQ0JuWlhRZ1kyaHBiR1J5Wlc1ektDa2dleUJ5WlhSMWNtNGdkR2hwY3k1ZlkyaHBiR1J5Wlc1UFltcGxZM1J6T3lCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUVCcFoyNXZjbVZjYmlBZ0lDb3ZYRzRnSUhCaGRYTmxLQ2tnZTF4dUlDQWdJQzh2VkU5RVR6b2dkR2hwY3lCbVpXRjBkWEpsSUc1bFpXUnpJRzF2Y21VZ1lXNWhiR2x6WlZ4dUlDQWdJSFJvY205M0lDZE9iM1FnYVcxd2JHVnRaVzUwWldRbk8xeHVJQ0I5WEc1Y2JpQWdMeW9xWEc0Z0lDQXFJRUJwWjI1dmNtVmNiaUFnSUNvdlhHNGdJSEpsYzNWdFpTZ3BJSHRjYmlBZ0lDQXZMMVJQUkU4NklIUm9hWE1nWm1WaGRIVnlaU0J1WldWa2N5QnRiM0psSUdGdVlXeHBjMlZjYmlBZ0lDQjBhSEp2ZHlBblRtOTBJR2x0Y0d4bGJXVnVkR1ZrSnp0Y2JpQWdmVnh1WEc0Z0lDOHFLbHh1SUNBZ0tpQkFhV2R1YjNKbFhHNGdJQ0FxTDF4dUlDQnpkRzl3S0NrZ2UxeHVJQ0FnSUM4dlZFOUVUem9nYzJodmRXeGtJSEpsYlc5MlpTQjBhR1VnYzNWaWMyTnlhWEIwYVc5dUlHRnVaQ0J6Wlc1a0lHMWxjM05oWjJVZ2RXNXpkV0p6WTNKcFltVS9YRzRnSUNBZ2RHaHliM2NnSjA1dmRDQnBiWEJzWlcxbGJuUmxaQ2M3WEc0Z0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1EzSmxZWFJsSUdGdVpDQmhaR1FnWVNCRVlYUmhUMkpxWldOMFEyaHBiR1FnZEc4Z1lTQmphR2xzWkhKbGJpQmpiMnhzWldOMGFXOXVMbHh1SUNBZ0tpQkFjR0Z5WVcwZ2UxTjBjbWx1WjMwZ1kyaHBiR1J5Wlc0Z0xTQkRhR2xzWkhKbGJpQnVZVzFsSUhkb1pYSmxJSFJvWlNCamFHbHNaQ0JwY3lCaFpHUmxaQzVjYmlBZ0lDb2dRSEJoY21GdElIdEtVMDlPZlNCcGJtbDBhV0ZzUkdGMFlTQXRJRWx1YVhScFlXd2daR0YwWVNCdlppQjBhR1VnWTJocGJHUmNiaUFnSUNvZ1FISmxkSFZ5YmlCN1VISnZiV2x6WlR4RVlYUmhUMkpxWldOMFEyaHBiR1ErZlNBdElGSmxkSFZ5YmlCUWNtOXRhWE5sSUhSdklHRWdibVYzSUVSaGRHRlBZbXBsWTNSRGFHbHNaQzVjYmlBZ0lDb3ZYRzRnSUdGa1pFTm9hV3hrS0dOb2FXeGtjbVZ1TENCcGJtbDBhV0ZzUkdGMFlTa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNBdkwyTnlaV0YwWlNCdVpYY2dZMmhwYkdRZ2RXNXBjWFZsSUVsRUxDQmlZWE5sWkNCdmJpQm9lWEJsY25SNVZWSk1YRzRnSUNBZ1gzUm9hWE11WDJOb2FXeGtTV1FyS3p0Y2JpQWdJQ0JzWlhRZ2JYTm5RMmhwYkdSSlpDQTlJRjkwYUdsekxsOXZkMjVsY2lBcklDY2pKeUFySUY5MGFHbHpMbDlqYUdsc1pFbGtPMXh1SUNBZ0lHeGxkQ0J0YzJkRGFHbHNaRkJoZEdnZ1BTQmZkR2hwY3k1ZmRYSnNJQ3NnSnk5amFHbHNaSEpsYmk4bklDc2dZMmhwYkdSeVpXNDdYRzVjYmlBZ0lDQXZMMFpNVDFjdFQxVlVPaUIwYUdseklHMWxjM05oWjJVZ2QybHNiQ0JpWlNCelpXNTBJR1JwY21WamRHeDVJSFJ2SUdFZ2NtVnpiM1Z5WTJVZ1kyaHBiR1FnWVdSa2NtVnpjem9nVFdWemMyRm5aVUoxYzF4dUlDQWdJR3hsZENCeVpYRjFaWE4wVFhObklEMGdlMXh1SUNBZ0lDQWdkSGx3WlRvZ0oyTnlaV0YwWlNjc0lHWnliMjA2SUY5MGFHbHpMbDl2ZDI1bGNpd2dkRzg2SUcxelowTm9hV3hrVUdGMGFDeGNiaUFnSUNBZ0lHSnZaSGs2SUhzZ2NtVnpiM1Z5WTJVNklHMXpaME5vYVd4a1NXUXNJSFpoYkhWbE9pQnBibWwwYVdGc1JHRjBZU0I5WEc0Z0lDQWdmVHRjYmx4dUlDQWdJQzh2VkU5RVR6b2dSbTl5SUVaMWNuUm9aWElnVTNSMVpIbGNiaUFnSUNCcFppQW9JVjkwYUdsekxsOXRkWFIxWVd4QmRYUm9aVzUwYVdOaGRHbHZiaWtnY21WeGRXVnpkRTF6Wnk1aWIyUjVMbTExZEhWaGJFRjFkR2hsYm5ScFkyRjBhVzl1SUQwZ1gzUm9hWE11WDIxMWRIVmhiRUYxZEdobGJuUnBZMkYwYVc5dU8xeHVYRzRnSUNBZ0x5OXlaWFIxY201eklIQnliMjFwYzJVc0lHbHVJSFJvWlNCbWRYUjFjbVVzSUhSb1pTQkJVRWtnYldGNUlHTm9ZVzVuWlNCMGJ5QmhjM2x1WTJoeWIyNXZkWE1nWTJGc2JGeHVJQ0FnSUhKbGRIVnliaUJ1WlhjZ1VISnZiV2x6WlNnb2NtVnpiMngyWlNrZ1BUNGdlMXh1SUNBZ0lDQWdiR1YwSUcxelowbGtJRDBnWDNSb2FYTXVYMkoxY3k1d2IzTjBUV1Z6YzJGblpTaHlaWEYxWlhOMFRYTm5LVHRjYmx4dUlDQWdJQ0FnWTI5dWMyOXNaUzVzYjJjb0oyTnlaV0YwWlMxeVpYQnZjblJsY2kxamFHbHNaQ2dnSnlBcklGOTBhR2x6TGw5dmQyNWxjaUFySUNjZ0tUb2dKeXdnY21WeGRXVnpkRTF6WnlrN1hHNGdJQ0FnSUNCc1pYUWdibVYzUTJocGJHUWdQU0J1WlhjZ1JHRjBZVTlpYW1WamRFTm9hV3hrS0Y5MGFHbHpMQ0J0YzJkRGFHbHNaRWxrTENCcGJtbDBhV0ZzUkdGMFlTd2dYM1JvYVhNdVgyOTNibVZ5TENCdGMyZEpaQ2s3WEc0Z0lDQWdJQ0J1WlhkRGFHbHNaQzV2YmtOb1lXNW5aU2dvWlhabGJuUXBJRDArSUh0Y2JpQWdJQ0FnSUNBZ1gzUm9hWE11WDI5dVEyaGhibWRsS0dWMlpXNTBMQ0I3SUhCaGRHZzZJRzF6WjBOb2FXeGtVR0YwYUN3Z1kyaHBiR1JKWkRvZ2JYTm5RMmhwYkdSSlpDQjlLVHRjYmlBZ0lDQWdJSDBwTzF4dVhHNGdJQ0FnSUNCZmRHaHBjeTVmWTJocGJHUnlaVzVQWW1wbFkzUnpXMjF6WjBOb2FXeGtTV1JkSUQwZ2JtVjNRMmhwYkdRN1hHNWNiaUFnSUNBZ0lISmxjMjlzZG1Vb2JtVjNRMmhwYkdRcE8xeHVJQ0FnSUgwcE8xeHVJQ0I5WEc1Y2JpQWdMeW9xWEc0Z0lDQXFJRk5sZEhWd0lIUm9aU0JqWVd4c1ltRmpheUIwYnlCd2NtOWpaWE56SUdOeVpXRjBaU0JoYm1RZ1pHVnNaWFJsSUc5bUlHTm9hV3hrY21WdWN5NWNiaUFnSUNvZ1FIQmhjbUZ0SUh0bWRXNWpkR2x2YmlobGRtVnVkRG9nVFhOblJYWmxiblFwZlNCallXeHNZbUZqYTF4dUlDQWdLaTljYmlBZ2IyNUJaR1JEYUdsc1pDaGpZV3hzWW1GamF5a2dlMXh1SUNBZ0lIUm9hWE11WDI5dVFXUmtRMmhwYkdSeVpXNUlZVzVrYkdWeUlEMGdZMkZzYkdKaFkyczdYRzRnSUgxY2JseHVJQ0F2TDBaTVQxY3RTVTQ2SUcxbGMzTmhaMlVnY21WalpXbDJaV1FnWm5KdmJTQmhJSEpsYlc5MFpTQkVZWFJoVDJKcVpXTjBJQzArSUdGa1pFTm9hV3hrWEc0Z0lGOXZia05vYVd4a1EzSmxZWFJsS0cxelp5a2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNGdJQ0FnYkdWMElHMXpaME5vYVd4a1NXUWdQU0J0YzJjdVltOWtlUzV5WlhOdmRYSmpaVHRjYmx4dUlDQWdJR052Ym5OdmJHVXViRzluS0NkamNtVmhkR1V0YjJKelpYSjJaWEl0WTJocGJHUW9JQ2NnS3lCZmRHaHBjeTVmYjNkdVpYSWdLeUFuSUNrNklDY3NJRzF6WnlrN1hHNGdJQ0FnYkdWMElHNWxkME5vYVd4a0lEMGdibVYzSUVSaGRHRlBZbXBsWTNSRGFHbHNaQ2hmZEdocGN5d2diWE5uUTJocGJHUkpaQ3dnYlhObkxtSnZaSGt1ZG1Gc2RXVXBPMXh1SUNBZ0lGOTBhR2x6TGw5amFHbHNaSEpsYms5aWFtVmpkSE5iYlhOblEyaHBiR1JKWkYwZ1BTQnVaWGREYUdsc1pEdGNibHh1SUNBZ0lITmxkRlJwYldWdmRYUW9LQ2tnUFQ0Z2UxeHVJQ0FnSUNBZ0x5OUdURTlYTFU5VlZEb2dkMmxzYkNCbWJHOTNJSFJ2SUVSaGRHRlBZbXBsWTNSRGFHbHNaQ0F0UGlCZmIyNVNaWE53YjI1elpWeHVJQ0FnSUNBZ1gzUm9hWE11WDJKMWN5NXdiM04wVFdWemMyRm5aU2g3WEc0Z0lDQWdJQ0FnSUdsa09pQnRjMmN1YVdRc0lIUjVjR1U2SUNkeVpYTndiMjV6WlNjc0lHWnliMjA2SUcxelp5NTBieXdnZEc4NklHMXpaeTVtY205dExGeHVJQ0FnSUNBZ0lDQmliMlI1T2lCN0lHTnZaR1U2SURJd01Dd2djMjkxY21ObE9pQmZkR2hwY3k1ZmIzZHVaWElnZlZ4dUlDQWdJQ0FnZlNrN1hHNGdJQ0FnZlNrN1hHNWNiaUFnSUNCc1pYUWdaWFpsYm5RZ1BTQjdYRzRnSUNBZ0lDQjBlWEJsT2lCdGMyY3VkSGx3WlN4Y2JpQWdJQ0FnSUdaeWIyMDZJRzF6Wnk1bWNtOXRMRnh1SUNBZ0lDQWdkWEpzT2lCdGMyY3VkRzhzWEc0Z0lDQWdJQ0IyWVd4MVpUb2diWE5uTG1KdlpIa3VkbUZzZFdVc1hHNGdJQ0FnSUNCamFHbHNaRWxrT2lCdGMyZERhR2xzWkVsa0xGeHVJQ0FnSUNBZ2FXUmxiblJwZEhrNklHMXpaeTVpYjJSNUxtbGtaVzUwYVhSNVhHNGdJQ0FnZlR0Y2JseHVJQ0FnSUdsbUlDaGZkR2hwY3k1ZmIyNUJaR1JEYUdsc1pISmxia2hoYm1Sc1pYSXBJSHRjYmlBZ0lDQWdJR052Ym5OdmJHVXViRzluS0NkQlJFUXRRMGhKVEVSU1JVNHRSVlpGVGxRNklDY3NJR1YyWlc1MEtUdGNiaUFnSUNBZ0lGOTBhR2x6TGw5dmJrRmtaRU5vYVd4a2NtVnVTR0Z1Wkd4bGNpaGxkbVZ1ZENrN1hHNGdJQ0FnZlZ4dUlDQjlYRzVjYmlBZ0x5OXpaVzVrSUdSbGJIUmhJRzFsYzNOaFoyVnpJSFJ2SUhOMVluTmpjbWx3ZEdsdmJuTmNiaUFnWDI5dVEyaGhibWRsS0dWMlpXNTBMQ0JqYUdsc1pFbHVabThwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdYM1JvYVhNdVgzWmxjbk5wYjI0ckt6dGNibHh1SUNBZ0lHbG1JQ2hmZEdocGN5NWZjM1JoZEhWeklEMDlQU0FuYjI0bktTQjdYRzRnSUNBZ0lDQXZMMFpNVDFjdFQxVlVPaUIwYUdseklHMWxjM05oWjJVZ2QybHNiQ0JpWlNCelpXNTBJR1JwY21WamRHeDVJSFJ2SUdFZ2NtVnpiM1Z5WTJVZ1kyaGhibWRsY3lCaFpHUnlaWE56T2lCTlpYTnpZV2RsUW5WelhHNGdJQ0FnSUNCc1pYUWdZMmhoYm1kbFRYTm5JRDBnZTF4dUlDQWdJQ0FnSUNCMGVYQmxPaUFuZFhCa1lYUmxKeXdnWm5KdmJUb2dYM1JvYVhNdVgzVnliQ3dnZEc4NklGOTBhR2x6TGw5MWNtd2dLeUFuTDJOb1lXNW5aWE1uTEZ4dUlDQWdJQ0FnSUNCaWIyUjVPaUI3SUhabGNuTnBiMjQ2SUY5MGFHbHpMbDkyWlhKemFXOXVMQ0J6YjNWeVkyVTZJRjkwYUdsekxsOXZkMjVsY2l3Z1lYUjBjbWxpZFhSbE9pQmxkbVZ1ZEM1bWFXVnNaQ0I5WEc0Z0lDQWdJQ0I5TzF4dVhHNGdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25XMFJoZEdGUFltcGxZM1FnTFNCZmIyNURhR0Z1WjJWZElDMGdKeXdnWlhabGJuUXNJR05vYVd4a1NXNW1ieXdnWTJoaGJtZGxUWE5uS1R0Y2JseHVJQ0FnSUNBZ2FXWWdLR1YyWlc1MExtOVVlWEJsSUQwOVBTQlBZbXBsWTNSVWVYQmxMazlDU2tWRFZDa2dlMXh1SUNBZ0lDQWdJQ0JwWmlBb1pYWmxiblF1WTFSNWNHVWdJVDA5SUVOb1lXNW5aVlI1Y0dVdVVrVk5UMVpGS1NCN1hHNGdJQ0FnSUNBZ0lDQWdZMmhoYm1kbFRYTm5MbUp2WkhrdWRtRnNkV1VnUFNCbGRtVnVkQzVrWVhSaE8xeHVJQ0FnSUNBZ0lDQjlYRzRnSUNBZ0lDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ0lDQmphR0Z1WjJWTmMyY3VZbTlrZVM1aGRIUnlhV0oxZEdWVWVYQmxJRDBnWlhabGJuUXViMVI1Y0dVN1hHNGdJQ0FnSUNBZ0lHTm9ZVzVuWlUxelp5NWliMlI1TG5aaGJIVmxJRDBnWlhabGJuUXVaR0YwWVR0Y2JpQWdJQ0FnSUNBZ2FXWWdLR1YyWlc1MExtTlVlWEJsSUNFOVBTQkRhR0Z1WjJWVWVYQmxMbFZRUkVGVVJTa2dlMXh1SUNBZ0lDQWdJQ0FnSUdOb1lXNW5aVTF6Wnk1aWIyUjVMbTl3WlhKaGRHbHZiaUE5SUdWMlpXNTBMbU5VZVhCbE8xeHVJQ0FnSUNBZ0lDQjlYRzRnSUNBZ0lDQjlYRzVjYmlBZ0lDQWdJQzh2WTJocGJHUkpibVp2SUcxMWMzUWdhR0YyWlNBb2NHRjBhQ3dnWTJocGJHUkpaQ2xjYmlBZ0lDQWdJR2xtSUNoamFHbHNaRWx1Wm04cElIdGNiaUFnSUNBZ0lDQWdZMmhoYm1kbFRYTm5MblJ2SUQwZ1kyaHBiR1JKYm1adkxuQmhkR2c3WEc0Z0lDQWdJQ0FnSUdOb1lXNW5aVTF6Wnk1aWIyUjVMbkpsYzI5MWNtTmxJRDBnWTJocGJHUkpibVp2TG1Ob2FXeGtTV1E3WEc0Z0lDQWdJQ0I5WEc1Y2JpQWdJQ0FnSUM4dlZFOUVUem9nUm05eUlFWjFjblJvWlhJZ1UzUjFaSGxjYmlBZ0lDQWdJR2xtSUNnaFgzUm9hWE11WDIxMWRIVmhiRUYxZEdobGJuUnBZMkYwYVc5dUtTQmphR0Z1WjJWTmMyY3VZbTlrZVM1dGRYUjFZV3hCZFhSb1pXNTBhV05oZEdsdmJpQTlJRjkwYUdsekxsOXRkWFIxWVd4QmRYUm9aVzUwYVdOaGRHbHZianRjYmx4dUlDQWdJQ0FnWDNSb2FYTXVYMkoxY3k1d2IzTjBUV1Z6YzJGblpTaGphR0Z1WjJWTmMyY3BPMXh1SUNBZ0lIMWNiaUFnZlZ4dVhHNGdJQzh2Umt4UFZ5MUpUam9nWkdWc2RHRWdiV1Z6YzJGblpTQnlaV05sYVhabFpDQm1jbTl0SUdFZ2NtVnRiM1JsSUVSaGRHRlBZbXBsWTNSU1pYQnZjblJsY2lCdmNpQkVZWFJoVDJKcVpXTjBRMmhwYkdRZ2QyaGxiaUJqYUdGdVoybHVaeUJrWVhSaFhHNGdJRjlqYUdGdVoyVlBZbXBsWTNRb2MzbHVZMDlpYWl3Z2JYTm5LU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNibHh1SUNBZ0lDOHZWRTlFVHpvZ2RYQmtZWFJsSUhabGNuTnBiMjRnUDF4dUlDQWdJQzh2YUc5M0lIUnZJR2hoYm1Sc1pTQmhiaUJwYm1OdmNuSmxZM1FnZG1WeWMybHZiaUEvSUVWNFlXMXdiR1U2SUhKbFkyVnBkbVVnWVNCMlpYSnphVzl1SURNZ2QyaGxiaUIwYUdVZ2IySnpaWEoyWlhJZ2FYTWdhVzRnZG1WeWMybHZiaUF4TENCM2FHVnlaU0JwY3lCMGFHVWdkbVZ5YzJsdmJpQXlJRDljYmlBZ0lDQXZMM2RwYkd3Z2QyVWdibVZsWkNCMGJ5QmpiMjVtYVhKdElIUm9aU0J5WldObGNIUnBiMjRnUDF4dUlDQWdJR2xtSUNoZmRHaHBjeTVmZG1WeWMybHZiaUFySURFZ1BUMDlJRzF6Wnk1aWIyUjVMblpsY25OcGIyNHBJSHRjYmlBZ0lDQWdJRjkwYUdsekxsOTJaWEp6YVc5dUt5czdYRzRnSUNBZ0lDQnNaWFFnY0dGMGFDQTlJRzF6Wnk1aWIyUjVMbUYwZEhKcFluVjBaVHRjYmlBZ0lDQWdJR3hsZENCMllXeDFaU0E5SUdSbFpYQkRiRzl1WlNodGMyY3VZbTlrZVM1MllXeDFaU2s3WEc0Z0lDQWdJQ0JzWlhRZ1ptbHVaRkpsYzNWc2RDQTlJSE41Ym1OUFltb3VabWx1WkVKbFptOXlaU2h3WVhSb0tUdGNibHh1SUNBZ0lDQWdhV1lnS0cxelp5NWliMlI1TG1GMGRISnBZblYwWlZSNWNHVWdQVDA5SUU5aWFtVmpkRlI1Y0dVdVFWSlNRVmtwSUh0Y2JpQWdJQ0FnSUNBZ2FXWWdLRzF6Wnk1aWIyUjVMbTl3WlhKaGRHbHZiaUE5UFQwZ1EyaGhibWRsVkhsd1pTNUJSRVFwSUh0Y2JpQWdJQ0FnSUNBZ0lDQnNaWFFnWVhKeUlEMGdabWx1WkZKbGMzVnNkQzV2WW1vN1hHNGdJQ0FnSUNBZ0lDQWdiR1YwSUdsdVpHVjRJRDBnWm1sdVpGSmxjM1ZzZEM1c1lYTjBPMXh1SUNBZ0lDQWdJQ0FnSUVGeWNtRjVMbkJ5YjNSdmRIbHdaUzV6Y0d4cFkyVXVZWEJ3Ykhrb1lYSnlMQ0JiYVc1a1pYZ3NJREJkTG1OdmJtTmhkQ2gyWVd4MVpTa3BPMXh1SUNBZ0lDQWdJQ0I5SUdWc2MyVWdhV1lnS0cxelp5NWliMlI1TG05d1pYSmhkR2x2YmlBOVBUMGdRMmhoYm1kbFZIbHdaUzVTUlUxUFZrVXBJSHRjYmlBZ0lDQWdJQ0FnSUNCc1pYUWdZWEp5SUQwZ1ptbHVaRkpsYzNWc2RDNXZZbW83WEc0Z0lDQWdJQ0FnSUNBZ2JHVjBJR2x1WkdWNElEMGdabWx1WkZKbGMzVnNkQzVzWVhOME8xeHVJQ0FnSUNBZ0lDQWdJR0Z5Y2k1emNHeHBZMlVvYVc1a1pYZ3NJSFpoYkhWbEtUdGNiaUFnSUNBZ0lDQWdmU0JsYkhObElIdGNiaUFnSUNBZ0lDQWdJQ0JtYVc1a1VtVnpkV3gwTG05aWFsdG1hVzVrVW1WemRXeDBMbXhoYzNSZElEMGdkbUZzZFdVN0lDOHZJRlZRUkVGVVJWeHVJQ0FnSUNBZ0lDQjlYRzRnSUNBZ0lDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ0lDQnBaaUFvYlhObkxtSnZaSGt1ZG1Gc2RXVXBJSHRjYmlBZ0lDQWdJQ0FnSUNCbWFXNWtVbVZ6ZFd4MExtOWlhbHRtYVc1a1VtVnpkV3gwTG14aGMzUmRJRDBnZG1Gc2RXVTdJQzh2SUZWUVJFRlVSU0J2Y2lCQlJFUmNiaUFnSUNBZ0lDQWdmU0JsYkhObElIdGNiaUFnSUNBZ0lDQWdJQ0JrWld4bGRHVWdabWx1WkZKbGMzVnNkQzV2WW1wYlptbHVaRkpsYzNWc2RDNXNZWE4wWFRzZ0x5OGdVa1ZOVDFaRlhHNGdJQ0FnSUNBZ0lIMWNiaUFnSUNBZ0lIMWNiaUFnSUNCOUlHVnNjMlVnZTF4dUlDQWdJQ0FnTHk5VVQwUlBPaUJvYjNjZ2RHOGdhR0Z1Wkd4bElIVnVjM2x1WTJoeWIyNXBlbVZrSUhabGNuTnBiMjV6UDF4dUlDQWdJQ0FnWTI5dWMyOXNaUzVzYjJjb0oxVk9VMWxPUTBoU1QwNUpXa1ZFSUZaRlVsTkpUMDQ2SUNoa1lYUmhJRDArSUNjZ0t5QmZkR2hwY3k1ZmRtVnljMmx2YmlBcklDY3NJRzF6WnlBOVBpQW5JQ3NnYlhObkxtSnZaSGt1ZG1WeWMybHZiaUFySUNjcEp5azdYRzRnSUNBZ2ZWeHVJQ0I5WEc1Y2JpQWdMeTlHVEU5WExVbE9PaUJ0WlhOellXZGxJSEpsWTJWcGRtVmtJR1p5YjIwZ1lTQnlaVzF2ZEdVZ1JHRjBZVTlpYW1WamRFTm9hV3hrSUhkb1pXNGdZMmhoYm1kcGJtY2daR0YwWVZ4dUlDQmZZMmhoYm1kbFEyaHBiR1J5Wlc0b2JYTm5LU0I3WEc0Z0lDQWdiR1YwSUY5MGFHbHpJRDBnZEdocGN6dGNiaUFnSUNCamIyNXpiMnhsTG14dlp5Z25RMmhoYm1kbElHTm9hV3hrY21WdU9pQW5MQ0JmZEdocGN5NWZiM2R1WlhJc0lHMXpaeWs3WEc1Y2JpQWdJQ0JzWlhRZ1kyaHBiR1JKWkNBOUlHMXpaeTVpYjJSNUxuSmxjMjkxY21ObE8xeHVJQ0FnSUd4bGRDQmphR2xzWkhKbGJpQTlJRjkwYUdsekxsOWphR2xzWkhKbGJrOWlhbVZqZEhOYlkyaHBiR1JKWkYwN1hHNWNiaUFnSUNCcFppQW9ZMmhwYkdSeVpXNHBJSHRjYmlBZ0lDQWdJRjkwYUdsekxsOWphR0Z1WjJWUFltcGxZM1FvWTJocGJHUnlaVzR1WDNONWJtTlBZbW9zSUcxelp5azdYRzRnSUNBZ2ZTQmxiSE5sSUh0Y2JpQWdJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZE9ieUJqYUdsc1pISmxiaUJtYjNWdVpDQm1iM0k2SUNjc0lHTm9hV3hrU1dRcE8xeHVJQ0FnSUgxY2JpQWdmVnh1WEc1OVhHNWNibVY0Y0c5eWRDQmtaV1poZFd4MElFUmhkR0ZQWW1wbFkzUTdYRzVjYmx4dVhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVpQXZMMXh1THk4Z0xpOXpjbU12YzNsdVkyaGxjaTlFWVhSaFQySnFaV04wTG1weklpd2lMeW9xWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZCVUlFbHViM1podzZmRG8yOGdaU0JUYVhOMFpXMWhjeUJUUVZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCSlRrVlRReTFKUkZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCUlZVOUNTVk1nVGtWVVYwOVNTMU1nVTB4Y2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1JsSkJWVTVJVDBaRlVpMUhSVk5GVEV4VFEwaEJSbFFnV2xWU0lFWlBSVkpFUlZKVlRrY2dSRVZTSUVGT1IwVlhRVTVFVkVWT0lFWlBVbE5EU0ZWT1J5QkZMbFpjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVDFKQlRrZEZJRk5CWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVSbGRYUnpZMmhsSUZSbGJHVnJiMjBnUVVkY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1FYQnBlbVZsWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZSRlEwaE9TVk5EU0VVZ1ZVNUpWa1ZTVTBsVVFWUWdRa1ZTVEVsT1hHNHFYRzRxSUV4cFkyVnVjMlZrSUhWdVpHVnlJSFJvWlNCQmNHRmphR1VnVEdsalpXNXpaU3dnVm1WeWMybHZiaUF5TGpBZ0tIUm9aU0JjSWt4cFkyVnVjMlZjSWlrN1hHNHFJSGx2ZFNCdFlYa2dibTkwSUhWelpTQjBhR2x6SUdacGJHVWdaWGhqWlhCMElHbHVJR052YlhCc2FXRnVZMlVnZDJsMGFDQjBhR1VnVEdsalpXNXpaUzVjYmlvZ1dXOTFJRzFoZVNCdlluUmhhVzRnWVNCamIzQjVJRzltSUhSb1pTQk1hV05sYm5ObElHRjBYRzRxWEc0cUlDQWdhSFIwY0RvdkwzZDNkeTVoY0dGamFHVXViM0puTDJ4cFkyVnVjMlZ6TDB4SlEwVk9VMFV0TWk0d1hHNHFYRzRxSUZWdWJHVnpjeUJ5WlhGMWFYSmxaQ0JpZVNCaGNIQnNhV05oWW14bElHeGhkeUJ2Y2lCaFozSmxaV1FnZEc4Z2FXNGdkM0pwZEdsdVp5d2djMjltZEhkaGNtVmNiaW9nWkdsemRISnBZblYwWldRZ2RXNWtaWElnZEdobElFeHBZMlZ1YzJVZ2FYTWdaR2x6ZEhKcFluVjBaV1FnYjI0Z1lXNGdYQ0pCVXlCSlUxd2lJRUpCVTBsVExGeHVLaUJYU1ZSSVQxVlVJRmRCVWxKQlRsUkpSVk1nVDFJZ1EwOU9SRWxVU1U5T1V5QlBSaUJCVGxrZ1MwbE9SQ3dnWldsMGFHVnlJR1Y0Y0hKbGMzTWdiM0lnYVcxd2JHbGxaQzVjYmlvZ1UyVmxJSFJvWlNCTWFXTmxibk5sSUdadmNpQjBhR1VnYzNCbFkybG1hV01nYkdGdVozVmhaMlVnWjI5MlpYSnVhVzVuSUhCbGNtMXBjM05wYjI1eklHRnVaRnh1S2lCc2FXMXBkR0YwYVc5dWN5QjFibVJsY2lCMGFHVWdUR2xqWlc1elpTNWNiaW9xTDF4dVhHNXBiWEJ2Y25RZ1UzbHVZMDlpYW1WamRDQm1jbTl0SUNjdUwxQnliM2g1VDJKcVpXTjBKenRjYmx4dUx5b3FYRzRnS2lCVWFHVWdZMnhoYzNNZ2NtVjBkWEp1WldRZ1puSnZiU0IwYUdVZ1JHRjBZVTlpYW1WamRDQmhaR1JEYUdsc1pISmxiaUJqWVd4c0lHOXlJR1p5YjIwZ2IyNUJaR1JEYUdsc1pISmxiaUJwWmlCeVpXMXZkR1ZzZVNCamNtVmhkR1ZrTGx4dUlDb2dRMmhwYkdSeVpXNGdiMkpxWldOMElITjVibU5vY205dWFYcGhkR2x2YmlCcGN5QmhJR0VnWm1GemRDQm1iM0ozWVhKa0lHMWxZMmhoYm1semJTd2dibThnYm1WbFpDQm1iM0lnWkdseVpXTjBJSE4xWW5OamNtbHdkR2x2Ym5Nc0lHbDBJSFZ6WlhNZ2RHaGxJR0ZzY21WaFpIa2dZWFYwYUc5eWFYcGxaQ0J6ZFdKelkzSnBjSFJwYjI0Z1puSnZiU0IwYUdVZ2NHRnlaVzUwSUVSaGRHRlBZbXBsWTNRdVhHNGdLaTljYm1Oc1lYTnpJRVJoZEdGUFltcGxZM1JEYUdsc1pDQXZLaUJwYlhCc1pXMWxiblJ6SUZONWJtTlRkR0YwZFhNZ0tpOGdlMXh1SUNBdktpQndjbWwyWVhSbFhHNWNiaUFnTFMwdExXVjJaVzUwSUdoaGJtUnNaWEp6TFMwdExWeHVJQ0JmYjI1U1pYTndiMjV6WlVoaGJtUnNaWEk2SUNobGRtVnVkQ2tnUFQ0Z2RtOXBaRnh1SUNBcUwxeHVYRzRnSUM4cUtseHVJQ0FnS2lCQWFXZHViM0psWEc0Z0lDQXFJRk5vYjNWc1pDQnViM1FnWW1VZ2RYTmxaQ0JrYVhKbFkzUnNlU0JpZVNCSWVYQmxjblJwWlhNdUlFbDBKM01nWTJGc2JHVmtJR0o1SUhSb1pTQkVZWFJoVDJKcVpXTjBMbUZrWkVOb2FXeGtjbVZ1WEc0Z0lDQXFMMXh1SUNCamIyNXpkSEoxWTNSdmNpaHdZWEpsYm5Rc0lHTm9hV3hrU1dRc0lHbHVhWFJwWVd4RVlYUmhMQ0J2ZDI1bGNpd2diWE5uU1dRcElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWDNSb2FYTXVYM0JoY21WdWRDQTlJSEJoY21WdWREdGNiaUFnSUNCZmRHaHBjeTVmWTJocGJHUkpaQ0E5SUdOb2FXeGtTV1E3WEc0Z0lDQWdYM1JvYVhNdVgyOTNibVZ5SUQwZ2IzZHVaWEk3WEc0Z0lDQWdYM1JvYVhNdVgyMXpaMGxrSUQwZ2JYTm5TV1E3WEc1Y2JpQWdJQ0JmZEdocGN5NWZjM2x1WTA5aWFpQTlJRzVsZHlCVGVXNWpUMkpxWldOMEtHbHVhWFJwWVd4RVlYUmhLVHRjYmx4dUlDQWdJRjkwYUdsekxsOWlkWE1nUFNCd1lYSmxiblF1WDJKMWN6dGNiaUFnSUNCZmRHaHBjeTVmWVd4c2IyTmhkR1ZNYVhOMFpXNWxjbk1vS1R0Y2JpQWdmVnh1WEc0Z0lGOWhiR3h2WTJGMFpVeHBjM1JsYm1WeWN5Z3BJSHRjYmlBZ0lDQnNaWFFnWDNSb2FYTWdQU0IwYUdsek8xeHVYRzRnSUNBZ0x5OTBhR2x6SUdseklHOXViSGtnYm1WbFpHVmtJR1p2Y2lCamFHbHNaSEpsYmlCeVpYQnZjblJsY25OY2JpQWdJQ0JwWmlBb1gzUm9hWE11WDI5M2JtVnlLU0I3WEc0Z0lDQWdJQ0JmZEdocGN5NWZiR2x6ZEdWdVpYSWdQU0JmZEdocGN5NWZZblZ6TG1Ga1pFeHBjM1JsYm1WeUtGOTBhR2x6TGw5dmQyNWxjaXdnS0cxelp5a2dQVDRnZTF4dUlDQWdJQ0FnSUNCcFppQW9iWE5uTG5SNWNHVWdQVDA5SUNkeVpYTndiMjV6WlNjZ0ppWWdiWE5uTG1sa0lEMDlQU0JmZEdocGN5NWZiWE5uU1dRcElIdGNiaUFnSUNBZ0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblJHRjBZVTlpYW1WamRFTm9hV3hrTG05dVVtVnpjRzl1YzJVNkp5d2diWE5uS1R0Y2JpQWdJQ0FnSUNBZ0lDQmZkR2hwY3k1ZmIyNVNaWE53YjI1elpTaHRjMmNwTzF4dUlDQWdJQ0FnSUNCOVhHNGdJQ0FnSUNCOUtUdGNiaUFnSUNCOVhHNGdJSDFjYmx4dUlDQmZjbVZzWldGelpVeHBjM1JsYm1WeWN5Z3BJSHRjYmlBZ0lDQnNaWFFnWDNSb2FYTWdQU0IwYUdsek8xeHVYRzRnSUNBZ2FXWWdLRjkwYUdsekxsOXNhWE4wWlc1bGNpa2dlMXh1SUNBZ0lDQWdYM1JvYVhNdVgyeHBjM1JsYm1WeUxuSmxiVzkyWlNncE8xeHVJQ0FnSUgxY2JpQWdmVnh1WEc0Z0lDOHFLbHh1SUNBZ0tpQlNaV3hsWVhObElHRnVaQ0JrWld4bGRHVWdiMkpxWldOMElHUmhkR0ZjYmlBZ0lDb3ZYRzRnSUdSbGJHVjBaU2dwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdaR1ZzWlhSbElGOTBhR2x6TGw5d1lYSmxiblF1WDJOb2FXeGtjbVZ1VzE5MGFHbHpMbDlqYUdsc1pFbGtYVHRjYmx4dUlDQWdJRjkwYUdsekxsOXlaV3hsWVhObFRHbHpkR1Z1WlhKektDazdYRzVjYmlBZ0lDQXZMMVJQUkU4NklITmxibVFnWkdWc1pYUmxJRzFsYzNOaFoyVWdQMXh1SUNCOVhHNWNiaUFnTHlvcVhHNGdJQ0FxSUVOb2FXeGtjbVZ1SUVsRUlHZGxibVZ5WVhSbFpDQnZiaUJoWkdSRGFHbHNaSEpsYmk0Z1ZXNXBjWFZsSUdsa1pXNTBhV1pwWlhKY2JpQWdJQ29nUUhSNWNHVWdlMVZTVEgwZ0xTQlZVa3dnYjJZZ2RHaGxJR1p2Y20xaGRDQThTSGx3WlhKMGVWVlNURDRqUEc1MWJXVnlhV010YzJWeGRXVnVZMlUrWEc0Z0lDQXFMMXh1SUNCblpYUWdZMmhwYkdSSlpDZ3BJSHNnY21WMGRYSnVJSFJvYVhNdVgyTm9hV3hrU1dRN0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1JHRjBZU0JUZEhKMVkzUjFjbVVnZEc4Z1ltVWdjM2x1WTJoeWIyNXBlbVZrTGx4dUlDQWdLaUJBZEhsd1pTQjdTbE5QVG4wZ0xTQktVMDlPSUhOMGNuVmpkSFZ5WlNCMGFHRjBJSE5vYjNWc1pDQm1iMnhzYjNjZ2RHaGxJR1JsWm1sdVpXUWdjMk5vWlcxaExDQnBaaUJoYm5rdVhHNGdJQ0FxTDF4dUlDQm5aWFFnWkdGMFlTZ3BJSHNnY21WMGRYSnVJSFJvYVhNdVgzTjVibU5QWW1vdVpHRjBZVHNnZlZ4dVhHNGdJQzhxS2x4dUlDQWdLaUJTWldkcGMzUmxjaUIwYUdVZ1kyaGhibWRsSUd4cGMzUmxibVZ5Y3lCelpXNTBJR0o1SUhSb1pTQnlaWEJ2Y25SbGNpQmphR2xzWkZ4dUlDQWdLaUJBY0dGeVlXMGdlMloxYm1OMGFXOXVLR1YyWlc1ME9pQk5jMmRGZG1WdWRDbDlJR05oYkd4aVlXTnJYRzRnSUNBcUwxeHVJQ0J2YmtOb1lXNW5aU2hqWVd4c1ltRmpheWtnZTF4dUlDQWdJSFJvYVhNdVgzTjVibU5QWW1vdWIySnpaWEoyWlNnb1pYWmxiblFwSUQwK0lIdGNiaUFnSUNBZ0lHTmhiR3hpWVdOcktHVjJaVzUwS1R0Y2JpQWdJQ0I5S1R0Y2JpQWdmVnh1WEc0Z0lDOHFLbHh1SUNBZ0tpQlRaWFIxY0NCMGFHVWdZMkZzYkdKaFkyc2dkRzhnY0hKdlkyVnpjeUJ5WlhOd2IyNXpaU0J1YjNScFptbGpZWFJwYjI1eklHOW1JSFJvWlNCamNtVmhkR1Z6WEc0Z0lDQXFJRUJ3WVhKaGJTQjdablZ1WTNScGIyNG9aWFpsYm5RNklFMXpaMFYyWlc1MEtYMGdZMkZzYkdKaFkydGNiaUFnSUNvdlhHNGdJRzl1VW1WemNHOXVjMlVvWTJGc2JHSmhZMnNwSUh0Y2JpQWdJQ0IwYUdsekxsOXZibEpsYzNCdmJuTmxTR0Z1Wkd4bGNpQTlJR05oYkd4aVlXTnJPMXh1SUNCOVhHNWNiaUFnTHk5R1RFOVhMVWxPT2lCdFpYTnpZV2RsSUhKbFkyVnBkbVZrSUdaeWIyMGdZU0J5WlcxdmRHVWdSR0YwWVU5aWFtVmpkQ0F0UGlCZmIyNURhR2xzWkVOeVpXRjBaVnh1SUNCZmIyNVNaWE53YjI1elpTaHRjMmNwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdiR1YwSUdWMlpXNTBJRDBnZTF4dUlDQWdJQ0FnZEhsd1pUb2diWE5uTG5SNWNHVXNYRzRnSUNBZ0lDQjFjbXc2SUcxelp5NWliMlI1TG5OdmRYSmpaU3hjYmlBZ0lDQWdJR052WkdVNklHMXpaeTVpYjJSNUxtTnZaR1ZjYmlBZ0lDQjlPMXh1WEc0Z0lDQWdhV1lnS0Y5MGFHbHpMbDl2YmxKbGMzQnZibk5sU0dGdVpHeGxjaWtnZTF4dUlDQWdJQ0FnWDNSb2FYTXVYMjl1VW1WemNHOXVjMlZJWVc1a2JHVnlLR1YyWlc1MEtUdGNiaUFnSUNCOVhHNGdJSDFjYmx4dWZWeHVYRzVsZUhCdmNuUWdaR1ZtWVhWc2RDQkVZWFJoVDJKcVpXTjBRMmhwYkdRN1hHNWNibHh1WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWlBdkwxeHVMeThnTGk5emNtTXZjM2x1WTJobGNpOUVZWFJoVDJKcVpXTjBRMmhwYkdRdWFuTWlMQ0pwYlhCdmNuUWdKM0J5YjNoNUxXOWljMlZ5ZG1Vbk8xeHVYRzVqYjI1emRDQnZZbXBsWTNSVWVYQmxJRDBnZTBGU1VrRlpPaUFuVzI5aWFtVmpkQ0JCY25KaGVWMG5MQ0JQUWtwRlExUTZJQ2RiYjJKcVpXTjBJRTlpYW1WamRGMG5JSDA3WEc1Y2JpOHFLbHh1SUNvZ1FHRmpZMlZ6Y3lCd2NtbDJZWFJsWEc0Z0tpQk5ZV2x1SUdOc1lYTnpJSFJvWVhRZ2JXRnBiblJoYVc1eklHRWdTbE5QVGlCdlltcGxZM1FzSUdGdVpDQnZZbk5sY25abGN5QmphR0Z1WjJWeklHbHVJSFJvYVhNZ2IySnFaV04wTENCeVpXTjFjbk5wZG1Wc2VTNWNiaUFxSUVsdWRHVnlibUZzSUc5aWFtVmpkSE1nWVc1a0lHRnljbUY1Y3lCaGNtVWdZV3h6YnlCdlluTmxjblpsWkM1Y2JpQXFMMXh1WTJ4aGMzTWdVM2x1WTA5aWFtVmpkQ0I3WEc1Y2JpQWdZMjl1YzNSeWRXTjBiM0lvYVc1cGRHbGhiRVJoZEdFcElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWDNSb2FYTXVYMjlpYzJWeWRtVnljeUE5SUZ0ZE8xeHVJQ0FnSUY5MGFHbHpMbDltYVd4MFpYSnpJRDBnZTMwN1hHNWNiaUFnSUNCMGFHbHpMbDlrWVhSaElEMGdhVzVwZEdsaGJFUmhkR0VnZkh3Z2UzMDdYRzVjYmlBZ0lDQjBhR2x6TGw5cGJuUmxjbTVoYkU5aWMyVnlkbVVvZEdocGN5NWZaR0YwWVNrN1hHNGdJSDFjYmx4dUlDQm5aWFFnWkdGMFlTZ3BJSHNnY21WMGRYSnVJSFJvYVhNdVgyUmhkR0U3SUgxY2JseHVJQ0J2WW5ObGNuWmxLR05oYkd4aVlXTnJLU0I3WEc0Z0lDQWdkR2hwY3k1ZmIySnpaWEoyWlhKekxuQjFjMmdvWTJGc2JHSmhZMnNwTzF4dUlDQjlYRzVjYmlBZ1ptbHVaQ2h3WVhSb0tTQjdYRzRnSUNBZ2JHVjBJR3hwYzNRZ1BTQndZWFJvTG5Od2JHbDBLQ2N1SnlrN1hHNWNiaUFnSUNCeVpYUjFjbTRnZEdocGN5NWZabWx1WkZkcGRHaFRjR3hwZENoc2FYTjBLVHRjYmlBZ2ZWeHVYRzRnSUdacGJtUkNaV1p2Y21Vb2NHRjBhQ2tnZTF4dUlDQWdJR3hsZENCeVpYTjFiSFFnUFNCN2ZUdGNiaUFnSUNCc1pYUWdiR2x6ZENBOUlIQmhkR2d1YzNCc2FYUW9KeTRuS1R0Y2JpQWdJQ0J5WlhOMWJIUXViR0Z6ZENBOUlHeHBjM1F1Y0c5d0tDazdYRzRnSUNBZ2NtVnpkV3gwTG05aWFpQTlJSFJvYVhNdVgyWnBibVJYYVhSb1UzQnNhWFFvYkdsemRDazdYRzVjYmlBZ0lDQnlaWFIxY200Z2NtVnpkV3gwTzF4dUlDQjlYRzVjYmlBZ1gyWnBibVJYYVhSb1UzQnNhWFFvYkdsemRDa2dlMXh1SUNBZ0lHeGxkQ0J2WW1vZ1BTQjBhR2x6TGw5a1lYUmhPMXh1SUNBZ0lHeHBjM1F1Wm05eVJXRmphQ2dvZG1Gc2RXVXBJRDArSUh0Y2JpQWdJQ0FnSUc5aWFpQTlJRzlpYWx0MllXeDFaVjA3WEc0Z0lDQWdmU2s3WEc1Y2JpQWdJQ0J5WlhSMWNtNGdiMkpxTzF4dUlDQjlYRzVjYmlBZ1gybHpUMkp6WlhKMllXSnNaU2h2WW1vcElIdGNiaUFnSUNCcFppQW9iMkpxTG1OdmJuTjBjblZqZEc5eUlEMDlQU0JQWW1wbFkzUWdmSHdnYjJKcUxtTnZibk4wY25WamRHOXlJRDA5UFNCQmNuSmhlU2tnZTF4dUlDQWdJQ0FnY21WMGRYSnVJSFJ5ZFdVN1hHNGdJQ0FnZlZ4dVhHNGdJQ0FnY21WMGRYSnVJR1poYkhObE8xeHVJQ0I5WEc1Y2JseHVJQ0JmYVc1MFpYSnVZV3hQWW5ObGNuWmxLRzlpYW1WamRDa2dlMXh1WEc0Z0lDQWdiR1YwSUdoaGJtUnNaWElnUFNBb1kyaGhibWRsYzJWMEtTQTlQaUI3WEc1Y2JpQWdJQ0FnSUdOb1lXNW5aWE5sZEM1bGRtVnllU2dvWTJoaGJtZGxLU0E5UGlCN1hHNGdJQ0FnSUNBZ0lIUm9hWE11WDI5dVEyaGhibWRsY3loamFHRnVaMlVwTzF4dUlDQWdJQ0FnZlNrN1hHNWNiaUFnSUNCOU8xeHVYRzRnSUNBZ2RHaHBjeTVmWkdGMFlTQTlJRTlpYW1WamRDNWtaV1Z3VDJKelpYSjJaU2h2WW1wbFkzUXNJR2hoYm1Sc1pYSXBPMXh1WEc0Z0lIMWNibHh1SUNCZlptbHlaVVYyWlc1MEtHVjJaVzUwS1NCN1hHNGdJQ0FnZEdocGN5NWZiMkp6WlhKMlpYSnpMbVp2Y2tWaFkyZ29LR05oYkd4aVlXTnJLU0E5UGlCN1hHNGdJQ0FnSUNCallXeHNZbUZqYXlobGRtVnVkQ2s3WEc0Z0lDQWdmU2s3WEc0Z0lIMWNibHh1SUNCZmIyNURhR0Z1WjJWektHTm9ZVzVuWlNrZ2UxeHVYRzRnSUNBZ2JHVjBJRzlpYWlBOUlHTm9ZVzVuWlM1dlltcGxZM1E3WEc0Z0lDQWdiR1YwSUc5aWFsUjVjR1U3WEc1Y2JpQWdJQ0JwWmlBb2IySnFMbU52Ym5OMGNuVmpkRzl5SUQwOVBTQlBZbXBsWTNRcElIdGNiaUFnSUNBZ0lHOWlhbFI1Y0dVZ1BTQlBZbXBsWTNSVWVYQmxMazlDU2tWRFZEdGNiaUFnSUNCOVhHNWNiaUFnSUNCcFppQW9iMkpxTG1OdmJuTjBjblZqZEc5eUlEMDlQU0JCY25KaGVTa2dlMXh1SUNBZ0lDQWdiMkpxVkhsd1pTQTlJRTlpYW1WamRGUjVjR1V1UVZKU1FWazdYRzRnSUNBZ2ZWeHVYRzRnSUNBZ2JHVjBJR1pwWld4a1UzUnlhVzVuSUQwZ1kyaGhibWRsTG10bGVYQmhkR2c3WEc1Y2JpQWdJQ0F2THlCamIyNXpiMnhsTG14dlp5Z25SbWxsYkdRNkp5d2dabWxsYkdSVGRISnBibWNwTzF4dUlDQWdJQzh2SUdOdmJuTnZiR1V1Ykc5bktDZDBlWEJsT2ljc0lHTm9ZVzVuWlM1MGVYQmxLVHRjYmx4dUlDQWdJQzh2YkdWMElHOXNaRlpoYkhWbElEMGdZMmhoYm1kbExtOXNaRlpoYkhWbE8xeHVJQ0FnSUd4bGRDQnVaWGRXWVd4MVpTQTlJRzlpYWx0amFHRnVaMlV1Ym1GdFpWMDdYRzVjYmlBZ0lDQmpiMjV6YjJ4bExtbHVabThvWTJoaGJtZGxMblI1Y0dVZ0t5QW5JSHdnUm1sbGJHUTZJQ2NnS3lCbWFXVnNaRk4wY21sdVp5QXJJQ2NnZkNCT1pYY2dWbUZzZFdVNkp5d2dTbE5QVGk1emRISnBibWRwWm5rb2JtVjNWbUZzZFdVcEtUdGNibHh1SUNBZ0lHbG1JQ2hqYUdGdVoyVXVkSGx3WlNBOVBUMGdKM1Z3WkdGMFpTY3BJSHRjYmlBZ0lDQWdJSFJvYVhNdVgyWnBjbVZGZG1WdWRDaDdYRzRnSUNBZ0lDQWdJR05VZVhCbE9pQkRhR0Z1WjJWVWVYQmxMbFZRUkVGVVJTeGNiaUFnSUNBZ0lDQWdiMVI1Y0dVNklHOWlhbFI1Y0dVc1hHNGdJQ0FnSUNBZ0lHWnBaV3hrT2lCbWFXVnNaRk4wY21sdVp5eGNiaUFnSUNBZ0lDQWdaR0YwWVRvZ2JtVjNWbUZzZFdWY2JpQWdJQ0FnSUgwcE8xeHVJQ0FnSUgxY2JseHVJQ0FnSUdsbUlDaGphR0Z1WjJVdWRIbHdaU0E5UFQwZ0oyRmtaQ2NwSUh0Y2JpQWdJQ0FnSUhSb2FYTXVYMlpwY21WRmRtVnVkQ2g3WEc0Z0lDQWdJQ0FnSUdOVWVYQmxPaUJEYUdGdVoyVlVlWEJsTGtGRVJDeGNiaUFnSUNBZ0lDQWdiMVI1Y0dVNklHOWlhbFI1Y0dVc1hHNGdJQ0FnSUNBZ0lHWnBaV3hrT2lCbWFXVnNaRk4wY21sdVp5eGNiaUFnSUNBZ0lDQWdaR0YwWVRvZ2JtVjNWbUZzZFdWY2JpQWdJQ0FnSUgwcE8xeHVJQ0FnSUgxY2JseHVJQ0FnSUdsbUlDaGphR0Z1WjJVdWRIbHdaU0E5UFQwZ0oyUmxiR1YwWlNjcElIdGNiaUFnSUNBZ0lIUm9hWE11WDJacGNtVkZkbVZ1ZENoN1hHNGdJQ0FnSUNBZ0lHTlVlWEJsT2lCRGFHRnVaMlZVZVhCbExsSkZUVTlXUlN4Y2JpQWdJQ0FnSUNBZ2IxUjVjR1U2SUc5aWFsUjVjR1VzWEc0Z0lDQWdJQ0FnSUdacFpXeGtPaUJtYVdWc1pGTjBjbWx1WjF4dUlDQWdJQ0FnZlNrN1hHNGdJQ0FnZlZ4dUlDQjlYRzVjYm4xY2JseHVaWGh3YjNKMElHeGxkQ0JEYUdGdVoyVlVlWEJsSUQwZ2UxVlFSRUZVUlRvZ0ozVndaR0YwWlNjc0lFRkVSRG9nSjJGa1pDY3NJRkpGVFU5V1JUb2dKM0psYlc5MlpTZDlPMXh1Wlhod2IzSjBJR3hsZENCUFltcGxZM1JVZVhCbElEMGdlMDlDU2tWRFZEb2dKMjlpYW1WamRDY3NJRUZTVWtGWk9pQW5ZWEp5WVhrbmZUdGNibVY0Y0c5eWRDQmtaV1poZFd4MElGTjVibU5QWW1wbFkzUTdYRzVjYmx4dVhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVpQXZMMXh1THk4Z0xpOXpjbU12YzNsdVkyaGxjaTlRY205NGVVOWlhbVZqZEM1cWN5SXNJbHdpZFhObElITjBjbWxqZEZ3aU8xeHVYRzVsZUhCdmNuUnpMbDlmWlhOTmIyUjFiR1VnUFNCMGNuVmxPMXh1WEc1MllYSWdYMmRsZEZCeWIzUnZkSGx3WlU5bUlEMGdjbVZ4ZFdseVpTaGNJaTR1TDJOdmNtVXRhbk12YjJKcVpXTjBMMmRsZEMxd2NtOTBiM1I1Y0dVdGIyWmNJaWs3WEc1Y2JuWmhjaUJmWjJWMFVISnZkRzkwZVhCbFQyWXlJRDBnWDJsdWRHVnliM0JTWlhGMWFYSmxSR1ZtWVhWc2RDaGZaMlYwVUhKdmRHOTBlWEJsVDJZcE8xeHVYRzUyWVhJZ1gyZGxkRTkzYmxCeWIzQmxjblI1UkdWelkzSnBjSFJ2Y2lBOUlISmxjWFZwY21Vb1hDSXVMaTlqYjNKbExXcHpMMjlpYW1WamRDOW5aWFF0YjNkdUxYQnliM0JsY25SNUxXUmxjMk55YVhCMGIzSmNJaWs3WEc1Y2JuWmhjaUJmWjJWMFQzZHVVSEp2Y0dWeWRIbEVaWE5qY21sd2RHOXlNaUE5SUY5cGJuUmxjbTl3VW1WeGRXbHlaVVJsWm1GMWJIUW9YMmRsZEU5M2JsQnliM0JsY25SNVJHVnpZM0pwY0hSdmNpazdYRzVjYm1aMWJtTjBhVzl1SUY5cGJuUmxjbTl3VW1WeGRXbHlaVVJsWm1GMWJIUW9iMkpxS1NCN0lISmxkSFZ5YmlCdlltb2dKaVlnYjJKcUxsOWZaWE5OYjJSMWJHVWdQeUJ2WW1vZ09pQjdJR1JsWm1GMWJIUTZJRzlpYWlCOU95QjlYRzVjYm1WNGNHOXlkSE11WkdWbVlYVnNkQ0E5SUdaMWJtTjBhVzl1SUdkbGRDaHZZbXBsWTNRc0lIQnliM0JsY25SNUxDQnlaV05sYVhabGNpa2dlMXh1SUNCcFppQW9iMkpxWldOMElEMDlQU0J1ZFd4c0tTQnZZbXBsWTNRZ1BTQkdkVzVqZEdsdmJpNXdjbTkwYjNSNWNHVTdYRzRnSUhaaGNpQmtaWE5qSUQwZ0tEQXNJRjluWlhSUGQyNVFjbTl3WlhKMGVVUmxjMk55YVhCMGIzSXlMbVJsWm1GMWJIUXBLRzlpYW1WamRDd2djSEp2Y0dWeWRIa3BPMXh1WEc0Z0lHbG1JQ2hrWlhOaklEMDlQU0IxYm1SbFptbHVaV1FwSUh0Y2JpQWdJQ0IyWVhJZ2NHRnlaVzUwSUQwZ0tEQXNJRjluWlhSUWNtOTBiM1I1Y0dWUFpqSXVaR1ZtWVhWc2RDa29iMkpxWldOMEtUdGNibHh1SUNBZ0lHbG1JQ2h3WVhKbGJuUWdQVDA5SUc1MWJHd3BJSHRjYmlBZ0lDQWdJSEpsZEhWeWJpQjFibVJsWm1sdVpXUTdYRzRnSUNBZ2ZTQmxiSE5sSUh0Y2JpQWdJQ0FnSUhKbGRIVnliaUJuWlhRb2NHRnlaVzUwTENCd2NtOXdaWEowZVN3Z2NtVmpaV2wyWlhJcE8xeHVJQ0FnSUgxY2JpQWdmU0JsYkhObElHbG1JQ2hjSW5aaGJIVmxYQ0lnYVc0Z1pHVnpZeWtnZTF4dUlDQWdJSEpsZEhWeWJpQmtaWE5qTG5aaGJIVmxPMXh1SUNCOUlHVnNjMlVnZTF4dUlDQWdJSFpoY2lCblpYUjBaWElnUFNCa1pYTmpMbWRsZER0Y2JseHVJQ0FnSUdsbUlDaG5aWFIwWlhJZ1BUMDlJSFZ1WkdWbWFXNWxaQ2tnZTF4dUlDQWdJQ0FnY21WMGRYSnVJSFZ1WkdWbWFXNWxaRHRjYmlBZ0lDQjlYRzVjYmlBZ0lDQnlaWFIxY200Z1oyVjBkR1Z5TG1OaGJHd29jbVZqWldsMlpYSXBPMXh1SUNCOVhHNTlPMXh1WEc1Y2JpOHZMeTh2THk4dkx5OHZMeTh2THk4dkwxeHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSmNiaTh2SUM0dmZpOWlZV0psYkMxeWRXNTBhVzFsTDJobGJIQmxjbk12WjJWMExtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXhNalJjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lpd2lMeW9xWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZCVUlFbHViM1podzZmRG8yOGdaU0JUYVhOMFpXMWhjeUJUUVZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCSlRrVlRReTFKUkZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCUlZVOUNTVk1nVGtWVVYwOVNTMU1nVTB4Y2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1JsSkJWVTVJVDBaRlVpMUhSVk5GVEV4VFEwaEJSbFFnV2xWU0lFWlBSVkpFUlZKVlRrY2dSRVZTSUVGT1IwVlhRVTVFVkVWT0lFWlBVbE5EU0ZWT1J5QkZMbFpjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVDFKQlRrZEZJRk5CWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVSbGRYUnpZMmhsSUZSbGJHVnJiMjBnUVVkY2Jpb2dRMjl3ZVhKcFoyaDBJREl3TVRZZ1FYQnBlbVZsWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZSRlEwaE9TVk5EU0VVZ1ZVNUpWa1ZTVTBsVVFWUWdRa1ZTVEVsT1hHNHFYRzRxSUV4cFkyVnVjMlZrSUhWdVpHVnlJSFJvWlNCQmNHRmphR1VnVEdsalpXNXpaU3dnVm1WeWMybHZiaUF5TGpBZ0tIUm9aU0JjSWt4cFkyVnVjMlZjSWlrN1hHNHFJSGx2ZFNCdFlYa2dibTkwSUhWelpTQjBhR2x6SUdacGJHVWdaWGhqWlhCMElHbHVJR052YlhCc2FXRnVZMlVnZDJsMGFDQjBhR1VnVEdsalpXNXpaUzVjYmlvZ1dXOTFJRzFoZVNCdlluUmhhVzRnWVNCamIzQjVJRzltSUhSb1pTQk1hV05sYm5ObElHRjBYRzRxWEc0cUlDQWdhSFIwY0RvdkwzZDNkeTVoY0dGamFHVXViM0puTDJ4cFkyVnVjMlZ6TDB4SlEwVk9VMFV0TWk0d1hHNHFYRzRxSUZWdWJHVnpjeUJ5WlhGMWFYSmxaQ0JpZVNCaGNIQnNhV05oWW14bElHeGhkeUJ2Y2lCaFozSmxaV1FnZEc4Z2FXNGdkM0pwZEdsdVp5d2djMjltZEhkaGNtVmNiaW9nWkdsemRISnBZblYwWldRZ2RXNWtaWElnZEdobElFeHBZMlZ1YzJVZ2FYTWdaR2x6ZEhKcFluVjBaV1FnYjI0Z1lXNGdYQ0pCVXlCSlUxd2lJRUpCVTBsVExGeHVLaUJYU1ZSSVQxVlVJRmRCVWxKQlRsUkpSVk1nVDFJZ1EwOU9SRWxVU1U5T1V5QlBSaUJCVGxrZ1MwbE9SQ3dnWldsMGFHVnlJR1Y0Y0hKbGMzTWdiM0lnYVcxd2JHbGxaQzVjYmlvZ1UyVmxJSFJvWlNCTWFXTmxibk5sSUdadmNpQjBhR1VnYzNCbFkybG1hV01nYkdGdVozVmhaMlVnWjI5MlpYSnVhVzVuSUhCbGNtMXBjM05wYjI1eklHRnVaRnh1S2lCc2FXMXBkR0YwYVc5dWN5QjFibVJsY2lCMGFHVWdUR2xqWlc1elpTNWNiaW9xTDF4dVhHNXBiWEJ2Y25RZ1JHRjBZVTlpYW1WamRGSmxjRzl5ZEdWeUlHWnliMjBnSnk0dlJHRjBZVTlpYW1WamRGSmxjRzl5ZEdWeUp6dGNibWx0Y0c5eWRDQkVZWFJoVDJKcVpXTjBUMkp6WlhKMlpYSWdabkp2YlNBbkxpOUVZWFJoVDJKcVpXTjBUMkp6WlhKMlpYSW5PMXh1YVcxd2IzSjBJRVJoZEdGUWNtOTJhWE5wYjI1aGJDQm1jbTl0SUNjdUwwUmhkR0ZRY205MmFYTnBiMjVoYkNjN1hHNWNiaThxS2x4dUtpQlVhR1VnYldGcGJpQmpiR0Z6Y3lCbWIzSWdkR2hsSUhONWJtTm9aWElnY0dGamEyRm5aUzVjYmlvZ1ZHaGxJRk41Ym1Ob1pYSWdhWE1nWVNCemFXNW5iR1YwYjI0Z1kyeGhjM01nY0dWeUlFaDVjR1Z5ZEhrdlZWSk1JR0Z1WkNCcGRDQnBjeUIwYUdVZ2IzZHVaWElnYjJZZ1lXeHNJR055WldGMFpXUWdSR0YwWVNCVGVXNWpJRTlpYW1WamRITWdZV05qYjNKa2FXNW5JSFJ2SUhSb1pTQlNaWEJ2Y25SbGNpQXRJRTlpYzJWeWRtVnlJSEJoZEhSbGNtNHVYRzRxSUUxaGFXNGdablZ1WTNScGIyNWhiR2wwZVNCcGN5QjBieUJqY21WaGRHVWdjbVZ3YjNKMFpYSnpJR0Z1WkNCMGJ5QnpkV0p6WTNKcFltVWdkRzhnWlhocGMzUnBibWNnYjI1bGN5NWNiaW92WEc1amJHRnpjeUJUZVc1amFHVnlJSHRjYmlBZ0x5b2djSEpwZG1GMFpWeHVJQ0JmYjNkdVpYSTZJRlZTVEZ4dUlDQmZZblZ6T2lCTmFXNXBRblZ6WEc1Y2JpQWdYM04xWWxWU1REb2dWVkpNWEc1Y2JpQWdYM0psY0c5eWRHVnljem9nUEhWeWJEb2dSR0YwWVU5aWFtVmpkRkpsY0c5eWRHVnlQbHh1SUNCZmIySnpaWEoyWlhKek9pQThkWEpzT2lCRVlYUmhUMkpxWldOMFQySnpaWEoyWlhJK1hHNGdJRjl3Y205MmFYTnBiMjVoYkhNNklEeDFjbXc2SUVSaGRHRlFjbTkyYVhOcGIyNWhiRDVjYmx4dUlDQXRMUzB0WlhabGJuUWdhR0Z1Wkd4bGNuTXRMUzB0WEc0Z0lGOXZiazV2ZEdsbWFXTmhkR2x2YmtoaGJtUnNaWEk2SUNobGRtVnVkQ2tnUFQ0Z2RtOXBaRnh1SUNCZmIyNVNaWE4xYldVNklDaGxkbVZ1ZENrZ1BUNGdkbTlwWkZ4dUlDQXFMMXh1WEc0Z0lDOHFLbHh1SUNBcUlFTnZibk4wY25WamRHOXlJSFJvWVhRZ2MyaHZkV3hrSUdKbElIVnpaV1FnWW5rZ2RHaGxJRWg1Y0dWeWRIa2diM2R1WlhKY2JpQWdLaUJBY0dGeVlXMGdlMGg1Y0dWeWRIbFZVa3g5SUc5M2JtVnlJQzBnU0hsd1pYSjBlU0JWVWt3Z2IzZHVaWEl1SUVGdUlGVlNUQ0JoYkd4dlkyRjBaV1FnWW5rZ2RHaGxJSEoxYm5ScGJXVWdkR2hoZENCMWJtbHhkV1ZzZVNCcFpHVnVkR2xtYVdWeklIUm9aU0JJZVhCbGNuUjVMbHh1SUNBcUlFQndZWEpoYlNCN1RXbHVhVUoxYzMwZ1luVnpJQzBnUVc0Z2FXNXpkR0Z1WTJVZ2IyWWdkR2hsSUUxcGJtbENkWE1nY0hKdmRtbGtaV1FnYVc0Z2RHaGxJSE5oYm1SaWIzZ3VJRmRvWlc0Z1lXNGdiMkpxWldOMElDaFNaWEJ2Y25SbGNpQnZjaUJQWW5ObGNuWmxaQ2tnYVhNZ1kzSmxZWFJsWkN3Z2RHaGxJRk41Ym1Ob1pYSk5ZVzVoWjJWeUlIZHBiR3dnWVdSa0lHRWdiR2x6ZEdWdVpYSWdhVzRnZEdobElFMXBibWxDZFhNZ2RHOGdjbVZqWldsMlpTOXpaVzVrSUUxbGMzTmhaMlZ6SUc5bUlIUm9ZWFFnYjJKcVpXTjBMbHh1SUNBcUlFQndZWEpoYlNCN1NsTlBUbjBnWTI5dVptbG5JQzBnUTI5dVptbG5kWEpoZEdsdmJpQmtZWFJoTGlCVWFHVWdiMjVzZVNCeVpYRjFhWEpsWkNCbWFXVnNaQ0JtYjNJZ2JtOTNJR2x6SUhSb1pTQnlkVzUwYVcxbFZWSk1MbHh1SUNBcUwxeHVJQ0JqYjI1emRISjFZM1J2Y2lodmQyNWxjaXdnWW5WekxDQmpiMjVtYVdjcElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dVhHNGdJQ0FnWDNSb2FYTXVYMjkzYm1WeUlEMGdiM2R1WlhJN1hHNGdJQ0FnWDNSb2FYTXVYMkoxY3lBOUlHSjFjenRjYmx4dUlDQWdJRjkwYUdsekxsOXpkV0pWVWt3Z1BTQmpiMjVtYVdjdWNuVnVkR2x0WlZWU1RDQXJJQ2N2YzIwbk8xeHVYRzRnSUNBZ1gzUm9hWE11WDNKbGNHOXlkR1Z5Y3lBOUlIdDlPMXh1SUNBZ0lGOTBhR2x6TGw5dlluTmxjblpsY25NZ1BTQjdmVHRjYmlBZ0lDQmZkR2hwY3k1ZmNISnZkbWx6YVc5dVlXeHpJRDBnZTMwN1hHNWNiaUFnSUNCaWRYTXVZV1JrVEdsemRHVnVaWElvYjNkdVpYSXNJQ2h0YzJjcElEMCtJSHRjYmlBZ0lDQWdJQzh2YVdkdWIzSmxJRzF6WnlCelpXNTBJR0o1SUdocGJYTmxiR1pjYmlBZ0lDQWdJR2xtSUNodGMyY3Vabkp2YlNBaFBUMGdiM2R1WlhJcElIdGNiaUFnSUNBZ0lDQWdZMjl1YzI5c1pTNXBibVp2S0NkYlUzbHVZMmhsY2wwZ1UzbHVZMmhsY2kxU1ExWTZJQ2NzSUcxelp5azdYRzRnSUNBZ0lDQWdJSE4zYVhSamFDQW9iWE5uTG5SNWNHVXBJSHRjYmlBZ0lDQWdJQ0FnSUNCallYTmxJQ2RtYjNKM1lYSmtKem9nWDNSb2FYTXVYMjl1Um05eWQyRnlaQ2h0YzJjcE95QmljbVZoYXp0Y2JpQWdJQ0FnSUNBZ0lDQmpZWE5sSUNkamNtVmhkR1VuT2lCZmRHaHBjeTVmYjI1U1pXMXZkR1ZEY21WaGRHVW9iWE5uS1RzZ1luSmxZV3M3WEc0Z0lDQWdJQ0FnSUNBZ1kyRnpaU0FuWkdWc1pYUmxKem9nWDNSb2FYTXVYMjl1VW1WdGIzUmxSR1ZzWlhSbEtHMXpaeWs3SUdKeVpXRnJPMXh1SUNBZ0lDQWdJQ0I5WEc0Z0lDQWdJQ0I5WEc0Z0lDQWdmU2s3WEc0Z0lIMWNibHh1SUNBdktpcGNiaUFnS2lCVWFHVWdiM2R1WlhJZ2IyWWdkR2hsSUZONWJtTm9aWElnWVc1a0lHRnNiQ0JqY21WaGRHVmtJSEpsY0c5eWRHVnljeTVjYmlBZ0tpQkFkSGx3WlNCN1NIbHdaWEowZVZWU1RIMWNiaUFnS2k5Y2JpQWdaMlYwSUc5M2JtVnlLQ2tnZXlCeVpYUjFjbTRnZEdocGN5NWZiM2R1WlhJN0lIMWNibHh1SUNBdktpcGNiaUFnS2lCQmJHd2diM2R1WldRZ2NtVndiM0owWlhKekxDQjBhR1VnYjI1bGN5QjBhR0YwSUhkbGNtVWdZM0psWVhSbFpDQmllU0JoSUdOeVpXRjBaVnh1SUNBcUlFQjBlWEJsSUh0UFltcGxZM1E4VlZKTUxDQkVZWFJoVDJKcVpXTjBVbVZ3YjNKMFpYSStmVnh1SUNBcUwxeHVJQ0JuWlhRZ2NtVndiM0owWlhKektDa2dleUJ5WlhSMWNtNGdkR2hwY3k1ZmNtVndiM0owWlhKek95QjlYRzVjYmlBZ0x5b3FYRzRnSUNvZ1FXeHNJRzkzYm1Wa0lHOWljMlZ5ZG1WeWN5d2dkR2hsSUc5dVpYTWdkR2hoZENCM1pYSmxJR055WldGMFpXUWdZbmtnWVNCc2IyTmhiQ0J6ZFdKelkzSnBjSFJwYjI1Y2JpQWdLaUJBZEhsd1pTQjdUMkpxWldOMFBGVlNUQ3dnUkdGMFlVOWlhbVZqZEU5aWMyVnlkbVZ5UG4xY2JpQWdLaTljYmlBZ1oyVjBJRzlpYzJWeWRtVnljeWdwSUhzZ2NtVjBkWEp1SUhSb2FYTXVYMjlpYzJWeWRtVnljenNnZlZ4dVhHNGdJQzhxS2x4dUlDQXFJRkpsY1hWbGMzUWdZU0JFWVhSaFQySnFaV04wVW1Wd2IzSjBaWElnWTNKbFlYUnBiMjR1SUZSb1pTQlZVa3dnZDJsc2JDQmlaU0JpWlNCeVpYRjFaWE4wWldRZ1lua2dkR2hsSUdGc2JHOWpZWFJwYjI0Z2JXVmphR0Z1YVhOdExseHVJQ0FxSUVCd1lYSmhiU0FnZTFOamFHVnRZVlZTVEgwZ2MyTm9aVzFoSUMwZ1NIbHdaWEowZVNCRFlYUmhiRzluZFdVZ1ZWSk1JR0ZrWkhKbGMzTWdkR2hoZENCallXNGdZbVVnZFhObFpDQjBieUJ5WlhSeWFXVjJaU0IwYUdVZ1NsTlBUaTFUWTJobGJXRWdaR1Z6WTNKcFltbHVaeUIwYUdVZ1JHRjBZU0JQWW1wbFkzUWdjMk5vWlcxaFhHNGdJQ29nUUhCaGNtRnRJQ0I3U0hsd1pYSjBlVlZTVEZ0ZGZTQnZZbk5sY25abGNuTWdMU0JNYVhOMElHOW1JR2g1Y0dWeWRHbGxjeUIwYUdGMElHRnlaU0J3Y21VdFlYVjBhRzl5YVhwbFpDQm1iM0lnYzNWaWMyTnlhWEIwYVc5dVhHNGdJQ29nUUhCaGNtRnRJQ0I3U2xOUFRuMGdhVzVwZEdsaGJFUmhkR0VnTFNCSmJtbDBhV0ZzSUdSaGRHRWdiMllnZEdobElISmxjRzl5ZEdWeVhHNGdJQ29nUUhCaGNtRnRJQ0I3YzNSeWFXNW5mU0J2WW1wbFkzUlZVa3dnTFNCeVpYVnpZV0pzWlNCa1lYUmhUMkpxWldOMElGVlNURnh1SUNBcUlFQnlaWFIxY200Z2UxQnliMjFwYzJVOFJHRjBZVTlpYW1WamRGSmxjRzl5ZEdWeVBuMGdVbVYwZFhKdUlGQnliMjFwYzJVZ2RHOGdZU0J1WlhjZ1VtVndiM0owWlhJdUlGUm9aU0J5WlhCdmNuUmxjaUJqWVc0Z1ltVWdZV05qWlhCMFpXUWdiM0lnY21WcVpXTjBaV1FnWW5rZ2RHaGxJRkJGVUZ4dUlDQXFMMXh1SUNCamNtVmhkR1VvYzJOb1pXMWhMQ0J2WW5ObGNuWmxjbk1zSUdsdWFYUnBZV3hFWVhSaExDQnpkRzl5WlNBOUlHWmhiSE5sTENCd01uQWdQU0JtWVd4elpTa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNGdJQ0FnYkdWMElHTnlhWFJsY21saElEMGdlMzA3WEc1Y2JpQWdJQ0JqY21sMFpYSnBZUzV3TW5BZ1BTQndNbkE3WEc0Z0lDQWdZM0pwZEdWeWFXRXVjM1J2Y21VZ1BTQnpkRzl5WlR0Y2JpQWdJQ0JqY21sMFpYSnBZUzV6WTJobGJXRWdQU0J6WTJobGJXRTdYRzRnSUNBZ1kzSnBkR1Z5YVdFdWIySnpaWEoyWlhKeklEMGdiMkp6WlhKMlpYSnpPMXh1SUNBZ0lHTnlhWFJsY21saExtbHVhWFJwWVd4RVlYUmhJRDBnYVc1cGRHbGhiRVJoZEdFN1hHNWNiaUFnSUNCamIyNXpiMnhsTG14dlp5Z25XM041Ym1Ob1pYSWdMU0JqY21WaGRHVmRJQzBnWTNKbFlYUmxJRkpsY0c5eWRHVnlJQzBnWTNKcGRHVnlhV0U2SUNjc0lHTnlhWFJsY21saEtUdGNibHh1SUNBZ0lFOWlhbVZqZEM1aGMzTnBaMjRvWTNKcGRHVnlhV0VzSUh0eVpYTjFiV1U2SUdaaGJITmxmU2s3WEc1Y2JpQWdJQ0J5WlhSMWNtNGdYM1JvYVhNdVgyTnlaV0YwWlNoamNtbDBaWEpwWVNrN1hHNGdJSDFjYmx4dUlDQnlaWE4xYldWU1pYQnZjblJsY25Nb1kzSnBkR1Z5YVdFcElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dUlDQWdJR052Ym5OdmJHVXViRzluS0NkYmMzbHVZMmhsY2lBdElHTnlaV0YwWlYwZ0xTQnlaWE4xYldVZ1VtVndiM0owWlhJZ0xTQmpjbWwwWlhKcFlUb2dKeXdnWTNKcGRHVnlhV0VwTzF4dVhHNGdJQ0FnVDJKcVpXTjBMbUZ6YzJsbmJpaGpjbWwwWlhKcFlTd2dlM0psYzNWdFpUb2dkSEoxWlgwcE8xeHVYRzRnSUNBZ2NtVjBkWEp1SUY5MGFHbHpMbDlqY21WaGRHVW9ZM0pwZEdWeWFXRXBPMXh1SUNCOVhHNWNiaUFnTHlvcVhHNGdJQ29nVW1WeGRXVnpkQ0JoSUhOMVluTmpjbWx3ZEdsdmJpQjBieUJoYmlCbGVHbHpkR1Z1ZENCeVpYQnZjblJsY2lCdlltcGxZM1F1WEc0Z0lDb2dRSEJoY21GdElIdFRZMmhsYldGVlVreDlJSE5qYUdWdFlTQXRJRWg1Y0dWeWRIa2dRMkYwWVd4dlozVmxJRlZTVENCaFpHUnlaWE56SUhSb1lYUWdZMkZ1SUdKbElIVnpaV1FnZEc4Z2NtVjBjbWxsZG1VZ2RHaGxJRXBUVDA0dFUyTm9aVzFoSUdSbGMyTnlhV0pwYm1jZ2RHaGxJRVJoZEdFZ1QySnFaV04wSUhOamFHVnRZVnh1SUNBcUlFQndZWEpoYlNCN1QySnFaV04wVlZKTWZTQnZZbXBWVWt3Z0xTQkJaR1J5WlhOeklHOW1JSFJvWlNCbGVHbHpkR1Z1ZENCeVpYQnZjblJsY2lCdlltcGxZM1FnZEc4Z1ltVWdiMkp6WlhKMlpXUmNiaUFnS2lCQWNHRnlZVzBnZTBKdmIyeGxZVzU5SUZ0emRHOXlaVDFtWVd4elpWMGdMU0JUWVhabElIUm9aU0J6ZFdKelkzSnBjSFJwYjI0Z2IyNGdkR2hsSUZONWJtTm9aWElnVFdGdVlXZGxjaUJtYjNJZ1puVnlkR2hsY2lCeVpYTjFiV1VnS0VSbFptRjFiSFFnYVhNZ1ptRnNjMlVwWEc0Z0lDb2dRSEJoY21GdElIdENiMjlzWldGdWZTQmJjREp3UFdaaGJITmxYU0F0SUVsdVptOGdZV0p2ZFhRZ2FXWWdjMmh2ZFd4a0lIVnpaU0J3TW5BZ1kyOXVibVZqZEdsdmJpQW9SR1ZtWVhWc2RDQnBjeUJtWVd4elpTbGNiaUFnS2lCQWNHRnlZVzBnZTBKdmIyeGxZVzU5SUZ0dGRYUjFZV3c5ZEhKMVpWMGdMU0JKYm1adklHRmliM1YwSUdsbUlHMWxjM05oWjJWeklHOW1JSFJvYVhNZ2IySnFaV04wSUhOb2IzVnNaQ0JpWlNCbGJtTnllWEIwWldRZ0tFUmxabUYxYkhRZ2FYTWdkSEoxWlNsY2JpQWdLaUJBY21WMGRYSnVJSHRRY205dGFYTmxQRVJoZEdGUFltcGxZM1JQWW5ObGNuWmxjajU5SUZKbGRIVnliaUJRY205dGFYTmxJSFJ2SUdFZ2JtVjNJRzlpYzJWeWRtVnlMaUJKZENkeklHRnpjMjlqYVdGMFpXUWdkMmwwYUNCMGFHVWdjbVZ3YjNKMFpYSXVYRzRnSUNvdlhHNGdJSE4xWW5OamNtbGlaU2h6WTJobGJXRXNJRzlpYWxWU1RDd2djM1J2Y21VZ1BTQm1ZV3h6WlN3Z2NESndJRDBnWm1Gc2MyVXNJRzExZEhWaGJDQTlJSFJ5ZFdVcElIdGNiaUFnSUNCc1pYUWdYM1JvYVhNZ1BTQjBhR2x6TzF4dUlDQWdJR3hsZENCamNtbDBaWEpwWVNBOUlIdDlPMXh1WEc0Z0lDQWdZM0pwZEdWeWFXRXVjREp3SUQwZ2NESndPMXh1SUNBZ0lHTnlhWFJsY21saExuTjBiM0psSUQwZ2MzUnZjbVU3WEc0Z0lDQWdZM0pwZEdWeWFXRXVjMk5vWlcxaElEMGdjMk5vWlcxaE8xeHVJQ0FnSUdOeWFYUmxjbWxoTG5KbGMyOTFjbU5sSUQwZ2IySnFWVkpNTzF4dVhHNGdJQ0FnTHk5VVQwUlBPaUJHYjNJZ1JuVnlkR2hsY2lCVGRIVmtlVnh1SUNBZ0lHTnlhWFJsY21saExtMTFkSFZoYkNBOUlHMTFkSFZoYkR0Y2JseHVYRzRnSUNBZ1kyOXVjMjlzWlM1c2IyY29KMXR6ZVc1amFHVnlJQzBnYzNWaWMyTnlhV0psWFNBdElITjFZbk5qY21saVpTQmpjbWwwWlhKcFlUb2dKeXdnWTNKcGRHVnlhV0VwTzF4dVhHNGdJQ0FnVDJKcVpXTjBMbUZ6YzJsbmJpaGpjbWwwWlhKcFlTd2dlM0psYzNWdFpUb2dabUZzYzJWOUtUdGNibHh1SUNBZ0lISmxkSFZ5YmlCZmRHaHBjeTVmYzNWaWMyTnlhV0psS0dOeWFYUmxjbWxoS1R0Y2JpQWdmVnh1WEc0Z0lDOHFLbHh1SUNBcUlGSmxjWFZsYzNRZ1lTQnpkV0p6WTNKcGNIUnBiMjRnZEc4Z1lXNGdaWGhwYzNSbGJuUWdjbVZ3YjNKMFpYSWdiMkpxWldOMExseHVJQ0FxSUVCd1lYSmhiU0I3WTNKcGRHVnlhV0Y5SUdOeWFYUmxjbWxoSUMwZ1NXNW1iM0p0WVhScGIyNGdkRzhnWkdselkyOTJaWEo1SUhSb1pTQnZZbk5sY25abGNpQnZZbXBsWTNSY2JpQWdLaUJBY21WMGRYSnVJSHRRY205dGFYTmxQRVJoZEdGUFltcGxZM1JQWW5ObGNuWmxjajU5SUZKbGRIVnliaUJRY205dGFYTmxJSFJ2SUdFZ2JtVjNJRzlpYzJWeWRtVnlMaUJKZENkeklHRnpjMjlqYVdGMFpXUWdkMmwwYUNCMGFHVWdjbVZ3YjNKMFpYSXVYRzRnSUNvdlhHNGdJSEpsYzNWdFpVOWljMlZ5ZG1WeWN5aGpjbWwwWlhKcFlTa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNGdJQ0FnYkdWMElGOWpjbWwwWlhKcFlTQTlJR055YVhSbGNtbGhJSHg4SUh0OU8xeHVYRzRnSUNBZ1QySnFaV04wTG1GemMybG5iaWhmWTNKcGRHVnlhV0VzSUh0eVpYTjFiV1U2SUhSeWRXVjlLVHRjYmx4dUlDQWdJSEpsZEhWeWJpQmZkR2hwY3k1ZmMzVmljMk55YVdKbEtGOWpjbWwwWlhKcFlTazdYRzRnSUgxY2JseHVJQ0F2S2lwY2JpQWdLaUJTWlhGMVpYTjBJR0VnY21WaFpDQmhZM1JwYjI0Z2IyNGdkR2hsSUhKbGNHOXlkR1Z5SUc5aWFtVmpkRnh1SUNBcUlFQndZWEpoYlNCN1QySnFaV04wVlZKTWZTQnZZbXBWVWt3Z0xTQlZVa3dnYjJZZ2RHaGxJSEpsY0c5eWRHVnlJRzlpYW1WamRDQjBieUJpWlNCeVpXRmtYRzRnSUNvZ1FISmxkSFZ5YmlCN1VISnZiV2x6WlR4UFltcGxZM1ErZlNCU1pYUjFjbTRnVUhKdmJXbHpaU0IwYnlCc1lYTjBJR0YyWVdsc1lXSnNaU0JrWVhSaElHOW1JSFJvWlNCeVpYQnZjblJsY2x4dUlDQXFMMXh1SUNCeVpXRmtLRzlpYWxWU1RDa2dlMXh1SUNBZ0lHeGxkQ0JmZEdocGN5QTlJSFJvYVhNN1hHNWNiaUFnSUNBdkwwWk1UMWN0VDFWVU9pQjBhR2x6SUcxbGMzTmhaMlVnZDJsc2JDQmlaU0J6Wlc1MElHUnBjbVZqZEd4NUlIUnZJSEpsY0c5eWRHVnlJRzlpYW1WamRDQW9iV0Y1WW1VZ2RHaGxjbVVnYVhNZ2JtOGdiR2x6ZEdWdVpYSWdZWFpoYVd4aFlteGxMQ0J6YnlCcGRDQjNhV3hzSUdKbElISmxjMjlzZG1Wa0lIZHBkR2dnVFdWemMyRm5aVUoxY3lBdFBpQnlaWE52YkhabEtWeHVJQ0FnSUM4dmQybHNiQ0J5WldGamFDQjBhR1VnY21WdGIzUmxJRzlpYW1WamRDQnBiaUJFWVhSaFQySnFaV04wVW1Wd2IzSjBaWElnTFQ0Z1gyOXVVbVZoWkZ4dUlDQWdJR3hsZENCeVpXRmtUWE5uSUQwZ2UxeHVJQ0FnSUNBZ2RIbHdaVG9nSjNKbFlXUW5MQ0JtY205dE9pQmZkR2hwY3k1ZmIzZHVaWElzSUhSdk9pQnZZbXBWVWt4Y2JpQWdJQ0I5TzF4dVhHNGdJQ0FnY21WMGRYSnVJRzVsZHlCUWNtOXRhWE5sS0NoeVpYTnZiSFpsTENCeVpXcGxZM1FwSUQwK0lIdGNiaUFnSUNBZ0lGOTBhR2x6TGw5aWRYTXVjRzl6ZEUxbGMzTmhaMlVvY21WaFpFMXpaeXdnS0hKbGNHeDVLU0E5UGlCN1hHNGdJQ0FnSUNBZ0lHTnZibk52YkdVdWJHOW5LQ2R5WldGa0xYSmxjM0J2Ym5ObE9pQW5MQ0J5WlhCc2VTazdYRzRnSUNBZ0lDQWdJR2xtSUNoeVpYQnNlUzVpYjJSNUxtTnZaR1VnUFQwOUlESXdNQ2tnZTF4dUlDQWdJQ0FnSUNBZ0lISmxjMjlzZG1Vb2NtVndiSGt1WW05a2VTNTJZV3gxWlNrN1hHNGdJQ0FnSUNBZ0lIMGdaV3h6WlNCN1hHNGdJQ0FnSUNBZ0lDQWdjbVZxWldOMEtISmxjR3g1TG1KdlpIa3VaR1Z6WXlrN1hHNGdJQ0FnSUNBZ0lIMWNiaUFnSUNBZ0lIMHBPMXh1SUNBZ0lIMHBPMXh1SUNCOVhHNWNiaUFnTHlvcVhHNGdJQ29nVTJWMGRYQWdkR2hsSUdOaGJHeGlZV05ySUhSdklIQnliMk5sYzNNZ1kzSmxZWFJsSUdGdVpDQmtaV3hsZEdVZ1pYWmxiblJ6SUc5bUlISmxiVzkyWlNCU1pYQnZjblJsY2lCdlltcGxZM1J6TGx4dUlDQXFJRlJvYVhNZ2FYTWdjbVZzWldGMFpXUWdkRzhnZEdobElHMWxjM05oWjJWdWN5QnpaVzUwSUdKNUlHTnlaV0YwWlNCMGJ5QjBhR1VnYjJKelpYSjJaWEp6SUVoNWNHVnlkSGtnWVhKeVlYa3VYRzRnSUNvZ1FIQmhjbUZ0SUh0bWRXNWpkR2x2YmlobGRtVnVkRG9nVFhOblJYWmxiblFwZlNCallXeHNZbUZqYTF4dUlDQXFMMXh1SUNCdmJrNXZkR2xtYVdOaGRHbHZiaWhqWVd4c1ltRmpheWtnZTF4dUlDQWdJSFJvYVhNdVgyOXVUbTkwYVdacFkyRjBhVzl1U0dGdVpHeGxjaUE5SUdOaGJHeGlZV05yTzF4dUlDQjlYRzVjYmlBZ1gyTnlaV0YwWlNoamNtbDBaWEpwWVNrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQ0J5WlhSMWNtNGdibVYzSUZCeWIyMXBjMlVvS0hKbGMyOXNkbVVzSUhKbGFtVmpkQ2tnUFQ0Z2UxeHVJQ0FnSUNBZ2JHVjBJSEpsYzNWdFpTQTlJR055YVhSbGNtbGhMbkpsYzNWdFpUdGNiaUFnSUNBZ0lHeGxkQ0JwYm1sMGFXRnNSR0YwWVNBOUlHTnlhWFJsY21saExtbHVhWFJwWVd4RVlYUmhJSHg4SUh0OU8xeHVJQ0FnSUNBZ2JHVjBJSE5qYUdWdFlUdGNibHh1SUNBZ0lDQWdMeTlHVEU5WExVOVZWRG9nZEdocGN5QnRaWE56WVdkbElIZHBiR3dnWW1VZ2MyVnVkQ0IwYnlCMGFHVWdjblZ1ZEdsdFpTQnBibk4wWVc1alpTQnZaaUJUZVc1amFHVnlUV0Z1WVdkbGNpQXRQaUJmYjI1RGNtVmhkR1ZjYmlBZ0lDQWdJR3hsZENCeVpYRjFaWE4wVFhObklEMGdlMXh1SUNBZ0lDQWdJQ0IwZVhCbE9pQW5ZM0psWVhSbEp5d2dabkp2YlRvZ1gzUm9hWE11WDI5M2JtVnlMQ0IwYnpvZ1gzUm9hWE11WDNOMVlsVlNUQ3hjYmlBZ0lDQWdJQ0FnWW05a2VUb2dleUJ5WlhOMWJXVTZJSEpsYzNWdFpTQjlYRzRnSUNBZ0lDQjlPMXh1WEc0Z0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblczTjVibU5vWlhJZ0xTQmpjbVZoZEdWZE9pQW5MQ0JqY21sMFpYSnBZU3dnY21WeGRXVnpkRTF6WnlrN1hHNWNiaUFnSUNBZ0lISmxjWFZsYzNSTmMyY3VZbTlrZVM1MllXeDFaU0E5SUdsdWFYUnBZV3hFWVhSaE8xeHVJQ0FnSUNBZ2NtVnhkV1Z6ZEUxelp5NWliMlI1TG5aaGJIVmxMbkpsY0c5eWRHVnlJRDBnWDNSb2FYTXVYMjkzYm1WeU8xeHVYRzRnSUNBZ0lDQnBaaUFvWTNKcGRHVnlhV0V1YzJOb1pXMWhLU0I3WEc0Z0lDQWdJQ0FnSUhOamFHVnRZU0E5SUdOeWFYUmxjbWxoTG5OamFHVnRZVHRjYmlBZ0lDQWdJQ0FnY21WeGRXVnpkRTF6Wnk1aWIyUjVMbk5qYUdWdFlTQTlJR055YVhSbGNtbGhMbk5qYUdWdFlUdGNiaUFnSUNBZ0lIMWNibHh1SUNBZ0lDQWdhV1lnS0dOeWFYUmxjbWxoTG5BeWNDa2djbVZ4ZFdWemRFMXpaeTVpYjJSNUxuQXljQ0E5SUdOeWFYUmxjbWxoTG5BeWNEdGNiaUFnSUNBZ0lHbG1JQ2hqY21sMFpYSnBZUzV6ZEc5eVpTa2djbVZ4ZFdWemRFMXpaeTVpYjJSNUxuTjBiM0psSUQwZ1kzSnBkR1Z5YVdFdWMzUnZjbVU3WEc0Z0lDQWdJQ0JwWmlBb1kzSnBkR1Z5YVdFdWIySnpaWEoyWlhKektTQnlaWEYxWlhOMFRYTm5MbUp2WkhrdVlYVjBhRzl5YVhObElEMGdZM0pwZEdWeWFXRXViMkp6WlhKMlpYSnpPMXh1WEc0Z0lDQWdJQ0JwWmlBb2NtVnpkVzFsS1NCN1hHNGdJQ0FnSUNBZ0lHTnZibk52YkdVdWJHOW5LQ2RiYzNsdVkyaGxjaUF0SUdOeVpXRjBaVjBnTFNCeVpYTjFiV1VnYldWemMyRm5aVG9nSnl3Z2NtVnhkV1Z6ZEUxelp5azdYRzRnSUNBZ0lDQjlJR1ZzYzJVZ2UxeHVJQ0FnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVzNONWJtTm9aWElnTFNCamNtVmhkR1ZkSUMwZ1kzSmxZWFJsSUcxbGMzTmhaMlU2SUNjc0lISmxjWFZsYzNSTmMyY3BPMXh1SUNBZ0lDQWdmVnh1WEc0Z0lDQWdJQ0F2TDNKbGNYVmxjM1FnWTNKbFlYUmxJSFJ2SUhSb1pTQmhiR3h2WTJGMGFXOXVJSE41YzNSbGJTNGdRMkZ1SUdKbElISmxhbVZqZEdWa0lHSjVJSFJvWlNCUWIyeHBZM2xGYm1kcGJtVXVYRzRnSUNBZ0lDQmZkR2hwY3k1ZlluVnpMbkJ2YzNSTlpYTnpZV2RsS0hKbGNYVmxjM1JOYzJjc0lDaHlaWEJzZVNrZ1BUNGdlMXh1SUNBZ0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlnblczTjVibU5vWlhJZ0xTQmpjbVZoZEdWZElDMGdZM0psWVhSbExYSmxjM0J2Ym5ObE9pQW5MQ0J5WlhCc2VTazdYRzRnSUNBZ0lDQWdJR2xtSUNoeVpYQnNlUzVpYjJSNUxtTnZaR1VnUFQwOUlESXdNQ2tnZTF4dUlDQWdJQ0FnSUNBZ0lDOHZjbVZ3YjNKMFpYSWdZM0psWVhScGIyNGdZV05qWlhCMFpXUmNiaUFnSUNBZ0lDQWdJQ0JzWlhRZ2IySnFWVkpNSUQwZ2NtVndiSGt1WW05a2VTNXlaWE52ZFhKalpUdGNibHh1SUNBZ0lDQWdJQ0FnSUdsbUlDaHlaWE4xYldVcElIdGNiaUFnSUNBZ0lDQWdJQ0FnSUhOamFHVnRZU0E5SUhKbGNHeDVMbUp2WkhrdWMyTm9aVzFoTzF4dUlDQWdJQ0FnSUNBZ0lDQWdhVzVwZEdsaGJFUmhkR0VnUFNCeVpYQnNlUzVpYjJSNUxuWmhiSFZsTzF4dUlDQWdJQ0FnSUNBZ0lIMWNibHh1SUNBZ0lDQWdJQ0FnSUd4bGRDQnVaWGRQWW1vZ1BTQnVaWGNnUkdGMFlVOWlhbVZqZEZKbGNHOXlkR1Z5S0Y5MGFHbHpMQ0J2WW1wVlVrd3NJSE5qYUdWdFlTd2dKMjl1Snl3Z2FXNXBkR2xoYkVSaGRHRXNJSEpsY0d4NUxtSnZaSGt1WTJocGJHUnlaVzVTWlhOdmRYSmpaWE1wTzF4dUlDQWdJQ0FnSUNBZ0lGOTBhR2x6TGw5eVpYQnZjblJsY25OYmIySnFWVkpNWFNBOUlHNWxkMDlpYWp0Y2JseHVJQ0FnSUNBZ0lDQWdJSEpsYzI5c2RtVW9ibVYzVDJKcUtUdGNiaUFnSUNBZ0lDQWdmU0JsYkhObElIdGNiaUFnSUNBZ0lDQWdJQ0F2TDNKbGNHOXlkR1Z5SUdOeVpXRjBhVzl1SUhKbGFtVmpkR1ZrWEc0Z0lDQWdJQ0FnSUNBZ2NtVnFaV04wS0hKbGNHeDVMbUp2WkhrdVpHVnpZeWs3WEc0Z0lDQWdJQ0FnSUgxY2JpQWdJQ0FnSUgwcE8xeHVJQ0FnSUgwcE8xeHVYRzRnSUgxY2JseHVJQ0JmYzNWaWMyTnlhV0psS0dOeWFYUmxjbWxoS1NCN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmx4dUlDQWdJSEpsZEhWeWJpQnVaWGNnVUhKdmJXbHpaU2dvY21WemIyeDJaU3dnY21WcVpXTjBLU0E5UGlCN1hHNWNiaUFnSUNBZ0lDOHZSa3hQVnkxUFZWUTZJSFJvYVhNZ2JXVnpjMkZuWlNCM2FXeHNJR0psSUhObGJuUWdkRzhnZEdobElISjFiblJwYldVZ2FXNXpkR0Z1WTJVZ2IyWWdVM2x1WTJobGNrMWhibUZuWlhJZ0xUNGdYMjl1VEc5allXeFRkV0p6WTNKcFltVmNiaUFnSUNBZ0lHeGxkQ0J6ZFdKelkzSnBZbVZOYzJjZ1BTQjdYRzRnSUNBZ0lDQWdJSFI1Y0dVNklDZHpkV0p6WTNKcFltVW5MQ0JtY205dE9pQmZkR2hwY3k1ZmIzZHVaWElzSUhSdk9pQmZkR2hwY3k1ZmMzVmlWVkpNTEZ4dUlDQWdJQ0FnSUNCaWIyUjVPaUI3ZlZ4dUlDQWdJQ0FnZlR0Y2JseHVJQ0FnSUNBZ0x5OGdTSGx3WlhKMGVTQnlaWEYxWlhOMElIUnZJR0psSUdGdUlFOWljMlZ5ZG1WeVhHNGdJQ0FnSUNBdkx5Qm9kSFJ3Y3pvdkwyZHBkR2gxWWk1amIyMHZjbVZVU0VsT1N5MXdjbTlxWldOMEwzTndaV056TDJKc2IySXZiV0Z6ZEdWeUwyMWxjM05oWjJWekwyUmhkR0V0YzNsdVl5MXRaWE56WVdkbGN5NXRaQ05vZVhCbGNuUjVMWEpsY1hWbGMzUXRkRzh0WW1VdFlXNHRiMkp6WlhKMlpYSmNibHh1SUNBZ0lDQWdMeThnVW1WemRXMWxJRk4xWW5OamNtbHdkR2x2Ym5NZ1ptOXlJSFJvWlNCellXMWxJRWg1Y0dWeWRIa2dWVkpNWEc0Z0lDQWdJQ0F2THlCb2RIUndjem92TDJkcGRHaDFZaTVqYjIwdmNtVlVTRWxPU3kxd2NtOXFaV04wTDNOd1pXTnpMMkpzYjJJdmJXRnpkR1Z5TDIxbGMzTmhaMlZ6TDJSaGRHRXRjM2x1WXkxdFpYTnpZV2RsY3k1dFpDTnlaWE4xYldVdGMzVmljMk55YVhCMGFXOXVjeTFtYjNJdGRHaGxMWE5oYldVdGFIbHdaWEowZVMxMWNteGNibHh1SUNBZ0lDQWdMeThnVW1WemRXMWxJRk4xWW5OamNtbHdkR2x2Ym5NZ1ptOXlJR0VnWTJWeWRHRnBiaUIxYzJWeUlHRnVaQ0JrWVhSaElITmphR1Z0WVNCcGJtUmxjR1Z1WkdWdWRHeDVJRzltSUhSb1pTQkllWEJsY25SNUlGVlNUQzVjYmlBZ0lDQWdJQzh2SUdoMGRIQnpPaTh2WjJsMGFIVmlMbU52YlM5eVpWUklTVTVMTFhCeWIycGxZM1F2YzNCbFkzTXZZbXh2WWk5dFlYTjBaWEl2YldWemMyRm5aWE12WkdGMFlTMXplVzVqTFcxbGMzTmhaMlZ6TG0xa0kzSmxjM1Z0WlMxemRXSnpZM0pwY0hScGIyNXpMV1p2Y2kxaExXTmxjblJoYVc0dGRYTmxjaTFoYm1RdFpHRjBZUzF6WTJobGJXRXRhVzVrWlhCbGJtUmxiblJzZVMxdlppMTBhR1V0YUhsd1pYSjBlUzExY214Y2JpQWdJQ0FnSUdsbUlDaGpjbWwwWlhKcFlTa2dlMXh1SUNBZ0lDQWdJQ0JwWmlBb1kzSnBkR1Z5YVdFdWFHRnpUM2R1VUhKdmNHVnlkSGtvSjNBeWNDY3BLU0J6ZFdKelkzSnBZbVZOYzJjdVltOWtlUzV3TW5BZ1BTQmpjbWwwWlhKcFlTNXdNbkE3WEc0Z0lDQWdJQ0FnSUdsbUlDaGpjbWwwWlhKcFlTNW9ZWE5QZDI1UWNtOXdaWEowZVNnbmMzUnZjbVVuS1NrZ2MzVmljMk55YVdKbFRYTm5MbUp2WkhrdWMzUnZjbVVnUFNCamNtbDBaWEpwWVM1emRHOXlaVHRjYmlBZ0lDQWdJQ0FnYVdZZ0tHTnlhWFJsY21saExtaGhjMDkzYmxCeWIzQmxjblI1S0NkelkyaGxiV0VuS1NrZ2MzVmljMk55YVdKbFRYTm5MbUp2WkhrdWMyTm9aVzFoSUQwZ1kzSnBkR1Z5YVdFdWMyTm9aVzFoTzF4dUlDQWdJQ0FnSUNCcFppQW9ZM0pwZEdWeWFXRXVhR0Z6VDNkdVVISnZjR1Z5ZEhrb0oybGtaVzUwYVhSNUp5a3BJSE4xWW5OamNtbGlaVTF6Wnk1aWIyUjVMbWxrWlc1MGFYUjVJRDBnWTNKcGRHVnlhV0V1YVdSbGJuUnBkSGs3WEc0Z0lDQWdJQ0FnSUdsbUlDaGpjbWwwWlhKcFlTNW9ZWE5QZDI1UWNtOXdaWEowZVNnbmNtVnpiM1Z5WTJVbktTa2djM1ZpYzJOeWFXSmxUWE5uTG1KdlpIa3VjbVZ6YjNWeVkyVWdQU0JqY21sMFpYSnBZUzV5WlhOdmRYSmpaVHRjYmlBZ0lDQWdJSDFjYmx4dUlDQWdJQ0FnYzNWaWMyTnlhV0psVFhObkxtSnZaSGt1Y21WemRXMWxJRDBnWTNKcGRHVnlhV0V1Y21WemRXMWxPMXh1WEc0Z0lDQWdJQ0F2TDFSUFJFODZJRVp2Y2lCR2RYSjBhR1Z5SUZOMGRXUjVYRzRnSUNBZ0lDQnNaWFFnYlhWMGRXRnNRWFYwYUdWdWRHbGpZWFJwYjI0Z1BTQmpjbWwwWlhKcFlTNXRkWFIxWVd3N1hHNGdJQ0FnSUNCcFppQW9JVzExZEhWaGJFRjFkR2hsYm5ScFkyRjBhVzl1S1NCemRXSnpZM0pwWW1WTmMyY3VZbTlrZVM1dGRYUjFZV3hCZFhSb1pXNTBhV05oZEdsdmJpQTlJRzExZEhWaGJFRjFkR2hsYm5ScFkyRjBhVzl1TzF4dVhHNGdJQ0FnSUNCamIyNXpiMnhsTG14dlp5Z25XM041Ym1Ob1pYSmRJQzBnYzNWaWMyTnlhV0psSUcxbGMzTmhaMlU2SUNjc0lHTnlhWFJsY21saExDQnpkV0p6WTNKcFltVk5jMmNwTzF4dVhHNGdJQ0FnSUNBdkwzSmxjWFZsYzNRZ2MzVmljMk55YVhCMGFXOXVYRzRnSUNBZ0lDQXZMMUJ5YjNacGMybHZibUZzSUdSaGRHRWdhWE1nWVhCd2JHbGxaQ0IwYnlCMGFHVWdSR0YwWVU5aWFtVmpkRTlpYzJWeWRtVnlJR0ZtZEdWeUlHTnZibVpwY20xaGRHbHZiaTRnVDNJZ1pHbHpZMkZ5WkdWa0lHbG1JSFJvWlhKbElHbHpJRzV2SUdOdmJtWnBjbTFoZEdsdmJpNWNiaUFnSUNBZ0lDOHZabTl5SUcxdmNtVWdhVzVtYnlCelpXVWdkR2hsSUVSaGRHRlFjbTkyYVhOcGIyNWhiQ0JqYkdGemN5QmtiMk4xYldWdWRHRjBhVzl1TGx4dUlDQWdJQ0FnWDNSb2FYTXVYMkoxY3k1d2IzTjBUV1Z6YzJGblpTaHpkV0p6WTNKcFltVk5jMmNzSUNoeVpYQnNlU2tnUFQ0Z2UxeHVJQ0FnSUNBZ0lDQmpiMjV6YjJ4bExteHZaeWduVzNONWJtTm9aWEpkSUMwZ2MzVmljMk55YVdKbExYSmxjM0J2Ym5ObE9pQW5MQ0J5WlhCc2VTazdYRzVjYmlBZ0lDQWdJQ0FnYkdWMElITmphR1Z0WVNBOUlISmxjR3g1TG1KdlpIa3VjMk5vWlcxaE8xeHVJQ0FnSUNBZ0lDQnNaWFFnYjJKcVZWSk1JRDBnY21Wd2JIa3VZbTlrZVM1eVpYTnZkWEpqWlR0Y2JseHVJQ0FnSUNBZ0lDQnNaWFFnYm1WM1VISnZkbWx6YVc5dVlXd2dQU0JmZEdocGN5NWZjSEp2ZG1semFXOXVZV3h6VzI5aWFsVlNURjA3WEc0Z0lDQWdJQ0FnSUdSbGJHVjBaU0JmZEdocGN5NWZjSEp2ZG1semFXOXVZV3h6VzI5aWFsVlNURjA3WEc0Z0lDQWdJQ0FnSUdsbUlDaHVaWGRRY205MmFYTnBiMjVoYkNrZ2JtVjNVSEp2ZG1semFXOXVZV3d1WDNKbGJHVmhjMlZNYVhOMFpXNWxjbk1vS1R0Y2JseHVJQ0FnSUNBZ0lDQnBaaUFvY21Wd2JIa3VZbTlrZVM1amIyUmxJRHdnTWpBd0tTQjdYRzRnSUNBZ0lDQWdJQ0FnWTI5dWMyOXNaUzVzYjJjb0oxdHplVzVqYUdWeVhTQXRJRzVsZHlCRVlYUmhVSEp2ZG1semFXOXVZV3c2SUNjc0lISmxjR3g1TG1KdlpIa3VZMmhwYkdSeVpXNVNaWE52ZFhKalpYTXNJRzlpYWxWU1RDazdYRzRnSUNBZ0lDQWdJQ0FnYm1WM1VISnZkbWx6YVc5dVlXd2dQU0J1WlhjZ1JHRjBZVkJ5YjNacGMybHZibUZzS0Y5MGFHbHpMbDl2ZDI1bGNpd2diMkpxVlZKTUxDQmZkR2hwY3k1ZlluVnpMQ0J5WlhCc2VTNWliMlI1TG1Ob2FXeGtjbVZ1VW1WemIzVnlZMlZ6S1R0Y2JpQWdJQ0FnSUNBZ0lDQmZkR2hwY3k1ZmNISnZkbWx6YVc5dVlXeHpXMjlpYWxWU1RGMGdQU0J1WlhkUWNtOTJhWE5wYjI1aGJEdGNiaUFnSUNBZ0lDQWdmU0JsYkhObElHbG1JQ2h5WlhCc2VTNWliMlI1TG1OdlpHVWdQVDA5SURJd01Da2dlMXh1SUNBZ0lDQWdJQ0FnSUdOdmJuTnZiR1V1Ykc5bktDZGJjM2x1WTJobGNsMGdMU0J1WlhjZ1JHRjBZU0JQWW1wbFkzUWdUMkp6WlhKMlpYSTZJQ2NzSUhKbGNHeDVMQ0JmZEdocGN5NWZjSEp2ZG1semFXOXVZV3h6S1R0Y2JseHVJQ0FnSUNBZ0lDQWdJQzh2VkU5RVR6b2dSbTl5SUVaMWNuUm9aWElnVTNSMVpIbGNiaUFnSUNBZ0lDQWdJQ0JzWlhRZ2JtVjNUMkpxSUQwZ2JtVjNJRVJoZEdGUFltcGxZM1JQWW5ObGNuWmxjaWhmZEdocGN5d2diMkpxVlZKTUxDQnpZMmhsYldFc0lDZHZiaWNzSUhKbGNHeDVMbUp2WkhrdWRtRnNkV1VzSUc1bGQxQnliM1pwYzJsdmJtRnNMbU5vYVd4a2NtVnVMQ0J5WlhCc2VTNWliMlI1TG5abGNuTnBiMjRzSUcxMWRIVmhiRUYxZEdobGJuUnBZMkYwYVc5dUtUdGNiaUFnSUNBZ0lDQWdJQ0JmZEdocGN5NWZiMkp6WlhKMlpYSnpXMjlpYWxWU1RGMGdQU0J1WlhkUFltbzdYRzVjYmlBZ0lDQWdJQ0FnSUNCeVpYTnZiSFpsS0c1bGQwOWlhaWs3WEc0Z0lDQWdJQ0FnSUNBZ2JtVjNVSEp2ZG1semFXOXVZV3d1WVhCd2JIa29ibVYzVDJKcUtUdGNiaUFnSUNBZ0lDQWdmU0JsYkhObElIdGNiaUFnSUNBZ0lDQWdJQ0J5WldwbFkzUW9jbVZ3YkhrdVltOWtlUzVrWlhOaktUdGNiaUFnSUNBZ0lDQWdmVnh1SUNBZ0lDQWdmU2s3WEc0Z0lDQWdmU2s3WEc1Y2JpQWdmVnh1WEc0Z0lDOHZSa3hQVnkxSlRqb2diV1Z6YzJGblpTQnlaV05sYVhabFpDQm1jbTl0SUdFZ2JHOWpZV3dnY25WdWRHbHRaU0JTWlhCdmNuUmxjazlpYW1WamRDQXRQaUJmYjI1U1pXMXZkR1ZUZFdKelkzSnBZbVZjYmlBZ1gyOXVSbTl5ZDJGeVpDaHRjMmNwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdiR1YwSUhKbGNHOXlkR1Z5SUQwZ1gzUm9hWE11WDNKbGNHOXlkR1Z5YzF0dGMyY3VZbTlrZVM1MGIxMDdYRzRnSUNBZ2NtVndiM0owWlhJdVgyOXVSbTl5ZDJGeVpDaHRjMmNwTzF4dUlDQjlYRzVjYmlBZ0x5OUdURTlYTFVsT09pQnRaWE56WVdkbElISmxZMlZwZG1Wa0lHWnliMjBnWVNCeVpXMXZkR1VnVTNsdVkyaGxjaUF0UGlCamNtVmhkR1VnS0hSb2FYTWdhWE1nWVdOMGRXRnNiSGtnWVc0Z2FXNTJhWFJoZEdsdmJpQjBieUJ6ZFdKelkzSnBZbVVwWEc0Z0lGOXZibEpsYlc5MFpVTnlaV0YwWlNodGMyY3BJSHRjYmlBZ0lDQnNaWFFnWDNSb2FYTWdQU0IwYUdsek8xeHVYRzRnSUNBdkwzSmxiVzkyWlNCY0lpOXpkV0p6WTNKcGNIUnBiMjVjSWlCbWNtOXRJSFJvWlNCVlVreGNiaUFnSUd4bGRDQnlaWE52ZFhKalpTQTlJRzF6Wnk1bWNtOXRMbk5zYVdObEtEQXNJQzB4TXlrN1hHNWNiaUFnSUd4bGRDQmxkbVZ1ZENBOUlIdGNiaUFnSUNBZ2RIbHdaVG9nYlhObkxuUjVjR1VzWEc0Z0lDQWdJR1p5YjIwNklHMXpaeTVpYjJSNUxuTnZkWEpqWlN4Y2JpQWdJQ0FnZFhKc09pQnlaWE52ZFhKalpTeGNiaUFnSUNBZ2MyTm9aVzFoT2lCdGMyY3VZbTlrZVM1elkyaGxiV0VzWEc0Z0lDQWdJSFpoYkhWbE9pQnRjMmN1WW05a2VTNTJZV3gxWlN4Y2JpQWdJQ0FnYVdSbGJuUnBkSGs2SUcxelp5NWliMlI1TG1sa1pXNTBhWFI1TEZ4dVhHNGdJQ0FnSUdGamF6b2dLSFI1Y0dVcElEMCtJSHRjYmlBZ0lDQWdJQ0JzWlhRZ2JGUjVjR1VnUFNBeU1EQTdYRzRnSUNBZ0lDQWdhV1lnS0hSNWNHVXBJSHRjYmlBZ0lDQWdJQ0FnSUd4VWVYQmxJRDBnZEhsd1pUdGNiaUFnSUNBZ0lDQjlYRzVjYmlBZ0lDQWdJQ0F2TDNObGJtUWdZV05ySUhKbGMzQnZibk5sSUcxbGMzTmhaMlZjYmlBZ0lDQWdJQ0JmZEdocGN5NWZZblZ6TG5CdmMzUk5aWE56WVdkbEtIdGNiaUFnSUNBZ0lDQWdJR2xrT2lCdGMyY3VhV1FzSUhSNWNHVTZJQ2R5WlhOd2IyNXpaU2NzSUdaeWIyMDZJRzF6Wnk1MGJ5d2dkRzg2SUcxelp5NW1jbTl0TEZ4dUlDQWdJQ0FnSUNBZ1ltOWtlVG9nZXlCamIyUmxPaUJzVkhsd1pTQjlYRzRnSUNBZ0lDQWdmU2s3WEc0Z0lDQWdJSDFjYmlBZ0lIMDdYRzVjYmlBZ0lHbG1JQ2hmZEdocGN5NWZiMjVPYjNScFptbGpZWFJwYjI1SVlXNWtiR1Z5S1NCN1hHNGdJQ0FnSUdOdmJuTnZiR1V1YVc1bWJ5Z25XMU41Ym1Ob1pYSmRJRTVQVkVsR1NVTkJWRWxQVGkxRlZrVk9WRG9nSnl3Z1pYWmxiblFwTzF4dUlDQWdJQ0JmZEdocGN5NWZiMjVPYjNScFptbGpZWFJwYjI1SVlXNWtiR1Z5S0dWMlpXNTBLVHRjYmlBZ0lIMWNiaUFnZlZ4dVhHNGdJQzh2Umt4UFZ5MUpUam9nYldWemMyRm5aU0J5WldObGFYWmxaQ0JtY205dElHRWdjbVZ0YjNSbElFUmhkR0ZQWW1wbFkzUlNaWEJ2Y25SbGNpQXRQaUJrWld4bGRHVmNiaUFnWDI5dVVtVnRiM1JsUkdWc1pYUmxLRzF6WnlrZ2UxeHVJQ0FnSUd4bGRDQmZkR2hwY3lBOUlIUm9hWE03WEc1Y2JpQWdJQzh2Y21WdGIzWmxJRndpTDNOMVluTmpjbWx3ZEdsdmJsd2lJR1p5YjIwZ2RHaGxJRlZTVEZ4dUlDQWdiR1YwSUhKbGMyOTFjbU5sSUQwZ2JYTm5MbUp2WkhrdWNtVnpiM1Z5WTJVN1hHNWNiaUFnSUd4bGRDQnZZbXBsWTNRZ1BTQmZkR2hwY3k1ZmIySnpaWEoyWlhKelczSmxjMjkxY21ObFhUdGNiaUFnSUdsbUlDaHZZbXBsWTNRcElIdGNiaUFnSUNBZ2JHVjBJR1YyWlc1MElEMGdlMXh1SUNBZ0lDQWdJSFI1Y0dVNklHMXpaeTUwZVhCbExGeHVJQ0FnSUNBZ0lIVnliRG9nY21WemIzVnlZMlVzWEc0Z0lDQWdJQ0FnYVdSbGJuUnBkSGs2SUcxelp5NWliMlI1TG1sa1pXNTBhWFI1TEZ4dVhHNGdJQ0FnSUNBZ1lXTnJPaUFvZEhsd1pTa2dQVDRnZTF4dUlDQWdJQ0FnSUNBZ2JHVjBJR3hVZVhCbElEMGdNakF3TzF4dUlDQWdJQ0FnSUNBZ2FXWWdLSFI1Y0dVcElIdGNiaUFnSUNBZ0lDQWdJQ0FnYkZSNWNHVWdQU0IwZVhCbE8xeHVJQ0FnSUNBZ0lDQWdmVnh1WEc0Z0lDQWdJQ0FnSUNBdkwxUlBSRTg2SUdGdWVTQnZkR2hsY2lCa2FXWm1aWEpsYm5RZ2IzQjBhVzl1Y3lCbWIzSWdkR2hsSUhKbGJHVmhjMlVnY0hKdlkyVnpjeXdnYkdsclpTQmhZMk5sY0hRZ1luVjBJRzV2Y2lCeVpXeGxZWE5sSUd4dlkyRnNQMXh1SUNBZ0lDQWdJQ0FnYVdZZ0tHeFVlWEJsSUQwOVBTQXlNREFwSUh0Y2JpQWdJQ0FnSUNBZ0lDQWdiMkpxWldOMExtUmxiR1YwWlNncE8xeHVJQ0FnSUNBZ0lDQWdmVnh1WEc0Z0lDQWdJQ0FnSUNBZ0x5OXpaVzVrSUdGamF5QnlaWE53YjI1elpTQnRaWE56WVdkbFhHNGdJQ0FnSUNBZ0lDQWdYM1JvYVhNdVgySjFjeTV3YjNOMFRXVnpjMkZuWlNoN1hHNGdJQ0FnSUNBZ0lDQWdJQ0JwWkRvZ2JYTm5MbWxrTENCMGVYQmxPaUFuY21WemNHOXVjMlVuTENCbWNtOXRPaUJ0YzJjdWRHOHNJSFJ2T2lCdGMyY3Vabkp2YlN4Y2JpQWdJQ0FnSUNBZ0lDQWdJR0p2WkhrNklIc2dZMjlrWlRvZ2JGUjVjR1VzSUhOdmRYSmpaVG9nWDNSb2FYTXVYMjkzYm1WeUlIMWNiaUFnSUNBZ0lDQWdJQ0I5S1R0Y2JpQWdJQ0FnSUNBZ2ZWeHVJQ0FnSUNBZ2ZUdGNibHh1SUNBZ0lDQWdhV1lnS0Y5MGFHbHpMbDl2Yms1dmRHbG1hV05oZEdsdmJraGhibVJzWlhJcElIdGNiaUFnSUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvSjA1UFZFbEdTVU5CVkVsUFRpMUZWa1ZPVkRvZ0p5d2daWFpsYm5RcE8xeHVJQ0FnSUNBZ0lDQmZkR2hwY3k1ZmIyNU9iM1JwWm1sallYUnBiMjVJWVc1a2JHVnlLR1YyWlc1MEtUdGNiaUFnSUNBZ0lIMWNiaUFnSUNCOUlHVnNjMlVnZTF4dUlDQWdJQ0FnWDNSb2FYTXVYMkoxY3k1d2IzTjBUV1Z6YzJGblpTaDdYRzRnSUNBZ0lDQWdJR2xrT2lCdGMyY3VhV1FzSUhSNWNHVTZJQ2R5WlhOd2IyNXpaU2NzSUdaeWIyMDZJRzF6Wnk1MGJ5d2dkRzg2SUcxelp5NW1jbTl0TEZ4dUlDQWdJQ0FnSUNCaWIyUjVPaUI3SUdOdlpHVTZJRFF3TkN3Z2MyOTFjbU5sT2lCZmRHaHBjeTVmYjNkdVpYSWdmVnh1SUNBZ0lDQWdmU2s3WEc0Z0lDQWdmVnh1SUNCOVhHNWNibjFjYmx4dVpYaHdiM0owSUdSbFptRjFiSFFnVTNsdVkyaGxjanRjYmx4dVhHNWNiaTh2SUZkRlFsQkJRMHNnUms5UFZFVlNJQzh2WEc0dkx5QXVMM055WXk5emVXNWphR1Z5TDFONWJtTm9aWEl1YW5NaUxDSXZLaXBjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVUZRZ1NXNXZkbUhEcDhPamJ5QmxJRk5wYzNSbGJXRnpJRk5CWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUVsT1JWTkRMVWxFWEc0cUlFTnZjSGx5YVdkb2RDQXlNREUySUZGVlQwSkpVeUJPUlZSWFQxSkxVeUJUVEZ4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCR1VrRlZUa2hQUmtWU0xVZEZVMFZNVEZORFNFRkdWQ0JhVlZJZ1JrOUZVa1JGVWxWT1J5QkVSVklnUVU1SFJWZEJUa1JVUlU0Z1JrOVNVME5JVlU1SElFVXVWbHh1S2lCRGIzQjVjbWxuYUhRZ01qQXhOaUJQVWtGT1IwVWdVMEZjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnUkdWMWRITmphR1VnVkdWc1pXdHZiU0JCUjF4dUtpQkRiM0I1Y21sbmFIUWdNakF4TmlCQmNHbDZaV1ZjYmlvZ1EyOXdlWEpwWjJoMElESXdNVFlnVkVWRFNFNUpVME5JUlNCVlRrbFdSVkpUU1ZSQlZDQkNSVkpNU1U1Y2JpcGNiaW9nVEdsalpXNXpaV1FnZFc1a1pYSWdkR2hsSUVGd1lXTm9aU0JNYVdObGJuTmxMQ0JXWlhKemFXOXVJREl1TUNBb2RHaGxJRndpVEdsalpXNXpaVndpS1R0Y2Jpb2dlVzkxSUcxaGVTQnViM1FnZFhObElIUm9hWE1nWm1sc1pTQmxlR05sY0hRZ2FXNGdZMjl0Y0d4cFlXNWpaU0IzYVhSb0lIUm9aU0JNYVdObGJuTmxMbHh1S2lCWmIzVWdiV0Y1SUc5aWRHRnBiaUJoSUdOdmNIa2diMllnZEdobElFeHBZMlZ1YzJVZ1lYUmNiaXBjYmlvZ0lDQm9kSFJ3T2k4dmQzZDNMbUZ3WVdOb1pTNXZjbWN2YkdsalpXNXpaWE12VEVsRFJVNVRSUzB5TGpCY2JpcGNiaW9nVlc1c1pYTnpJSEpsY1hWcGNtVmtJR0o1SUdGd2NHeHBZMkZpYkdVZ2JHRjNJRzl5SUdGbmNtVmxaQ0IwYnlCcGJpQjNjbWwwYVc1bkxDQnpiMlowZDJGeVpWeHVLaUJrYVhOMGNtbGlkWFJsWkNCMWJtUmxjaUIwYUdVZ1RHbGpaVzV6WlNCcGN5QmthWE4wY21saWRYUmxaQ0J2YmlCaGJpQmNJa0ZUSUVsVFhDSWdRa0ZUU1ZNc1hHNHFJRmRKVkVoUFZWUWdWMEZTVWtGT1ZFbEZVeUJQVWlCRFQwNUVTVlJKVDA1VElFOUdJRUZPV1NCTFNVNUVMQ0JsYVhSb1pYSWdaWGh3Y21WemN5QnZjaUJwYlhCc2FXVmtMbHh1S2lCVFpXVWdkR2hsSUV4cFkyVnVjMlVnWm05eUlIUm9aU0J6Y0dWamFXWnBZeUJzWVc1bmRXRm5aU0JuYjNabGNtNXBibWNnY0dWeWJXbHpjMmx2Ym5NZ1lXNWtYRzRxSUd4cGJXbDBZWFJwYjI1eklIVnVaR1Z5SUhSb1pTQk1hV05sYm5ObExseHVLaW92WEc1Y2JpOHFLbHh1SUNvZ1FHRmpZMlZ6Y3lCd2NtbDJZWFJsWEc0Z0tpQlVhR2x6SUdOc1lYTnpJR2x6SUhKbGMzQnZibk5wWW14bElHWnZjaUJqYjJ4c1pXTjBhVzVuSUdSbGJIUmhJR05vWVc1blpYTWdhVzRnY21WdGIzUmxJRzlpYW1WamRITXNJR0psWm05eVpTQjBhR1VnY21WemNHOXVjMlVnYjJZZ2MzVmljMk55YVhCMGFXOXVJSEpsWVdOb0lIUm9aU0J2WW5ObGNuWmxjaTVjYmlBcUlFbDBKM01nZFhObFpDQnBiaUJUZVc1amFHVnlJQzArSUhOMVluTmpjbWxpWlM0Z1ZHaGxJR1pzYjNjZ2FYTWdaR1ZtYVc1bFpDQmhjenBjYmlBcUlERXVJQ2h2WW5ObGNuWmxjaWtnTFMxemRXSnpZM0pwWW1VdExUNGdLSEpsY0c5eWRHVnlLVnh1SUNvZ01pNGdLRzlpYzJWeWRtVnlLU0E4TFMxa1pXeDBZU0IxY0dSaGRHVnpMUzBnS0hKbGNHOXlkR1Z5S1Z4dUlDb2dNeTRnS0c5aWMyVnlkbVZ5S1NBOExTMXpkV0p6WTNKcFltVWdjbVZ6Y0c5dWMyVXRMU0FvY21Wd2IzSjBaWElwWEc0Z0tpQlVhR2x6SUcxbFlXNXpJSFJvWVhRZ2RHaGxjbVVnWTI5MWJHUWdZbVVnWkdWc2RHRWdkWEJrWVhSbGN5QjBjbUZ1YzJabGNuSmxaQ0JpWldadmNtVWdkR2hsSUhOMVluTmpjbWx3ZEdsdmJpQmpiMjVtYVhKdFlYUnBiMjR1WEc0Z0tpQlRhVzVqWlNCMGFHVnlaU0JwY3lCdWJ5QkVZWFJoVDJKcVpXTjBUMkp6WlhKMlpYSWdZbVZtYjNKbElIUm9aU0IxWW5OamNtbHdkR2x2YmlCamIyNW1hWEp0WVhScGIyNHNJSFJvWlhKbElITm9iM1ZzWkNCaVpTQnpiMjFsSUc5MGFHVnlJRzlpYW1WamRDQmpiMnhzWldOMGFXNW5JSFJvWlNCMWNHUmhkR1Z6TGx4dUlDb2dVSEp2ZG1semFXOXVZV3dnWkdGMFlTQnBjeUJoY0hCc2FXVmtJSFJ2SUhSb1pTQkVZWFJoVDJKcVpXTjBUMkp6WlhKMlpYSWdZV1owWlhJZ1kyOXVabWx5YldGMGFXOXVMaUJQY2lCa2FYTmpZWEprWldRZ2FXWWdkR2hsY21VZ2FYTWdibThnWTI5dVptbHliV0YwYVc5dUxseHVJQ292WEc1amJHRnpjeUJFWVhSaFVISnZkbWx6YVc5dVlXd2dlMXh1SUNBdktpQndjbWwyWVhSbFhHNGdJRjlqYUdsc1pISmxia3hwYzNSbGJtVnljem9nVzAxeloweHBjM1JsYm1WeVhWeHVJQ0JmYkdsemRHVnVaWEk2SUUxeloweHBjM1JsYm1WeVhHNWNiaUFnWDJOb1lXNW5aWE02SUZ0ZFhHNGdJQ292WEc1Y2JpQWdZMjl1YzNSeWRXTjBiM0lvYjNkdVpYSXNJSFZ5YkN3Z1luVnpMQ0JqYUdsc1pISmxiaWtnZTF4dUlDQWdJR3hsZENCZmRHaHBjeUE5SUhSb2FYTTdYRzVjYmlBZ0lDQmZkR2hwY3k1ZmIzZHVaWElnUFNCdmQyNWxjanRjYmlBZ0lDQmZkR2hwY3k1ZmRYSnNJRDBnZFhKc08xeHVJQ0FnSUY5MGFHbHpMbDlpZFhNZ1BTQmlkWE03WEc0Z0lDQWdYM1JvYVhNdVgyTm9hV3hrY21WdUlEMGdZMmhwYkdSeVpXNDdYRzVjYmlBZ0lDQmZkR2hwY3k1ZlkyaGhibWRsY3lBOUlGdGRPMXh1SUNBZ0lGOTBhR2x6TGw5aGJHeHZZMkYwWlV4cGMzUmxibVZ5Y3lncE8xeHVJQ0I5WEc1Y2JpQWdYMkZzYkc5allYUmxUR2x6ZEdWdVpYSnpLQ2tnZTF4dUlDQWdJR3hsZENCZmRHaHBjeUE5SUhSb2FYTTdYRzVjYmlBZ0lDQmZkR2hwY3k1ZmJHbHpkR1Z1WlhJZ1BTQmZkR2hwY3k1ZlluVnpMbUZrWkV4cGMzUmxibVZ5S0Y5MGFHbHpMbDkxY213c0lDaHRjMmNwSUQwK0lIdGNiaUFnSUNBZ0lHTnZibk52YkdVdWJHOW5LQ2RFWVhSaFVISnZkbWx6YVc5dVlXd3RKeUFySUY5MGFHbHpMbDkxY213Z0t5QW5MVkpEVmpvZ0p5d2diWE5uS1R0Y2JpQWdJQ0FnSUY5MGFHbHpMbDlqYUdGdVoyVnpMbkIxYzJnb2JYTm5LVHRjYmlBZ0lDQjlLVHRjYmx4dUlDQWdJQzhxWEc0Z0lDQWdYM1JvYVhNdVgyTm9hV3hrY21WdVRHbHpkR1Z1WlhKeklEMGdXMTA3WEc0Z0lDQWdhV1lnS0Y5MGFHbHpMbDlqYUdsc1pISmxiaWtnZTF4dUlDQWdJQ0FnYkdWMElHTm9hV3hrUW1GelpWVlNUQ0E5SUhWeWJDQXJJQ2N2WTJocGJHUnlaVzR2Snp0Y2JpQWdJQ0FnSUY5MGFHbHpMbDlqYUdsc1pISmxiaTVtYjNKRllXTm9LQ2hqYUdsc1pDa2dQVDRnZTF4dUlDQWdJQ0FnSUNCc1pYUWdZMmhwYkdSVlVrd2dQU0JqYUdsc1pFSmhjMlZWVWt3Z0t5QmphR2xzWkR0Y2JpQWdJQ0FnSUNBZ2JHVjBJR3hwYzNSbGJtVnlJRDBnWDNSb2FYTXVYMkoxY3k1aFpHUk1hWE4wWlc1bGNpaGphR2xzWkZWU1RDd2dLRzF6WnlrZ1BUNGdlMXh1SUNBZ0lDQWdJQ0FnSUM4dmFXZHViM0psSUcxelp5QnpaVzUwSUdKNUlHaHBiWE5sYkdaY2JpQWdJQ0FnSUNBZ0lDQnBaaUFvYlhObkxtWnliMjBnSVQwOUlHOTNibVZ5S1NCN1hHNGdJQ0FnSUNBZ0lDQWdJQ0JqYjI1emIyeGxMbXh2WnlodGMyY3BPMXh1SUNBZ0lDQWdJQ0FnSUgxY2JpQWdJQ0FnSUNBZ2ZTazdYRzVjYmlBZ0lDQWdJQ0FnWDNSb2FYTXVYMk5vYVd4a2NtVnVUR2x6ZEdWdVpYSnpMbkIxYzJnb2JHbHpkR1Z1WlhJcE8xeHVJQ0FnSUNBZ2ZTazdYRzRnSUNBZ2ZTb3ZYRzRnSUgxY2JseHVJQ0JmY21Wc1pXRnpaVXhwYzNSbGJtVnljeWdwSUh0Y2JpQWdJQ0JzWlhRZ1gzUm9hWE1nUFNCMGFHbHpPMXh1WEc0Z0lDQWdYM1JvYVhNdVgyeHBjM1JsYm1WeUxuSmxiVzkyWlNncE8xeHVYRzRnSUNBZ0x5cGZkR2hwY3k1ZlkyaHBiR1J5Wlc1TWFYTjBaVzVsY25NdVptOXlSV0ZqYUNnb2JHbHpkR1Z1WlhJcElEMCtJSHRjYmlBZ0lDQWdJR3hwYzNSbGJtVnlMbkpsYlc5MlpTZ3BPMXh1SUNBZ0lIMHBPeW92WEc0Z0lIMWNibHh1SUNCblpYUWdZMmhwYkdSeVpXNG9LU0I3SUhKbGRIVnliaUIwYUdsekxsOWphR2xzWkhKbGJqc2dmVnh1WEc0Z0lHRndjR3g1S0c5aWMyVnlkbVZ5S1NCN1hHNGdJQ0FnYkdWMElGOTBhR2x6SUQwZ2RHaHBjenRjYmlBZ0lDQmZkR2hwY3k1ZlkyaGhibWRsY3k1bWIzSkZZV05vS0NoamFHRnVaMlVwSUQwK0lIdGNiaUFnSUNBZ0lHOWljMlZ5ZG1WeUxsOWphR0Z1WjJWUFltcGxZM1FvYjJKelpYSjJaWEl1WDNONWJtTlBZbW9zSUdOb1lXNW5aU2s3WEc0Z0lDQWdmU2s3WEc0Z0lIMWNibjFjYmx4dVpYaHdiM0owSUdSbFptRjFiSFFnUkdGMFlWQnliM1pwYzJsdmJtRnNPMXh1WEc1Y2JseHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSWdMeTljYmk4dklDNHZjM0pqTDNONWJtTm9aWEl2UkdGMFlWQnliM1pwYzJsdmJtRnNMbXB6SWl3aWJXOWtkV3hsTG1WNGNHOXlkSE1nUFNCN0lGd2laR1ZtWVhWc2RGd2lPaUJ5WlhGMWFYSmxLRndpWTI5eVpTMXFjeTlzYVdKeVlYSjVMMlp1TDI5aWFtVmpkQzloYzNOcFoyNWNJaWtzSUY5ZlpYTk5iMlIxYkdVNklIUnlkV1VnZlR0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WW1GaVpXd3RjblZ1ZEdsdFpTOWpiM0psTFdwekwyOWlhbVZqZEM5aGMzTnBaMjR1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURFek9GeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFpTENKdGIyUjFiR1V1Wlhod2IzSjBjeUE5SUhzZ1hDSmtaV1poZFd4MFhDSTZJSEpsY1hWcGNtVW9YQ0pqYjNKbExXcHpMMnhwWW5KaGNua3ZabTR2YjJKcVpXTjBMMmRsZEMxdmQyNHRjSEp2Y0dWeWRIa3RaR1Z6WTNKcGNIUnZjbHdpS1N3Z1gxOWxjMDF2WkhWc1pUb2dkSEoxWlNCOU8xeHVYRzVjYmk4dkx5OHZMeTh2THk4dkx5OHZMeTh2TDF4dUx5OGdWMFZDVUVGRFN5QkdUMDlVUlZKY2JpOHZJQzR2Zmk5aVlXSmxiQzF5ZFc1MGFXMWxMMk52Y21VdGFuTXZiMkpxWldOMEwyZGxkQzF2ZDI0dGNISnZjR1Z5ZEhrdFpHVnpZM0pwY0hSdmNpNXFjMXh1THk4Z2JXOWtkV3hsSUdsa0lEMGdNVFF3WEc0dkx5QnRiMlIxYkdVZ1kyaDFibXR6SUQwZ01DSXNJbkpsY1hWcGNtVW9KeTR1THk0dUwyMXZaSFZzWlhNdlpYTTJMbTlpYW1WamRDNWhjM05wWjI0bktUdGNibTF2WkhWc1pTNWxlSEJ2Y25SeklEMGdjbVZ4ZFdseVpTZ25MaTR2TGk0dmJXOWtkV3hsY3k5ZlkyOXlaU2NwTGs5aWFtVmpkQzVoYzNOcFoyNDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5bWJpOXZZbXBsWTNRdllYTnphV2R1TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeE5EVmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SWl3aWNtVnhkV2x5WlNnbkxpNHZMaTR2Ylc5a2RXeGxjeTlsY3pZdWIySnFaV04wTG1kbGRDMXZkMjR0Y0hKdmNHVnlkSGt0WkdWelkzSnBjSFJ2Y2ljcE8xeHVkbUZ5SUNSUFltcGxZM1FnUFNCeVpYRjFhWEpsS0NjdUxpOHVMaTl0YjJSMWJHVnpMMTlqYjNKbEp5a3VUMkpxWldOME8xeHViVzlrZFd4bExtVjRjRzl5ZEhNZ1BTQm1kVzVqZEdsdmJpQm5aWFJQZDI1UWNtOXdaWEowZVVSbGMyTnlhWEIwYjNJb2FYUXNJR3RsZVNsN1hHNGdJSEpsZEhWeWJpQWtUMkpxWldOMExtZGxkRTkzYmxCeWIzQmxjblI1UkdWelkzSnBjSFJ2Y2locGRDd2dhMlY1S1R0Y2JuMDdYRzVjYmx4dUx5OHZMeTh2THk4dkx5OHZMeTh2THk4dlhHNHZMeUJYUlVKUVFVTkxJRVpQVDFSRlVseHVMeThnTGk5K0wyTnZjbVV0YW5NdmJHbGljbUZ5ZVM5bWJpOXZZbXBsWTNRdloyVjBMVzkzYmkxd2NtOXdaWEowZVMxa1pYTmpjbWx3ZEc5eUxtcHpYRzR2THlCdGIyUjFiR1VnYVdRZ1BTQXhORGRjYmk4dklHMXZaSFZzWlNCamFIVnVhM01nUFNBd0lpd2lKM1Z6WlNCemRISnBZM1FuTzF4dUx5OGdNVGt1TVM0eUxqRWdUMkpxWldOMExtRnpjMmxuYmloMFlYSm5aWFFzSUhOdmRYSmpaU3dnTGk0dUtWeHVkbUZ5SUdkbGRFdGxlWE1nSUQwZ2NtVnhkV2x5WlNnbkxpOWZiMkpxWldOMExXdGxlWE1uS1Z4dUlDQXNJR2RQVUZNZ0lDQWdJRDBnY21WeGRXbHlaU2duTGk5ZmIySnFaV04wTFdkdmNITW5LVnh1SUNBc0lIQkpSU0FnSUNBZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYjJKcVpXTjBMWEJwWlNjcFhHNGdJQ3dnZEc5UFltcGxZM1FnUFNCeVpYRjFhWEpsS0NjdUwxOTBieTF2WW1wbFkzUW5LVnh1SUNBc0lFbFBZbXBsWTNRZ0lEMGdjbVZ4ZFdseVpTZ25MaTlmYVc5aWFtVmpkQ2NwWEc0Z0lDd2dKR0Z6YzJsbmJpQWdQU0JQWW1wbFkzUXVZWE56YVdkdU8xeHVYRzR2THlCemFHOTFiR1FnZDI5eWF5QjNhWFJvSUhONWJXSnZiSE1nWVc1a0lITm9iM1ZzWkNCb1lYWmxJR1JsZEdWeWJXbHVhWE4wYVdNZ2NISnZjR1Z5ZEhrZ2IzSmtaWElnS0ZZNElHSjFaeWxjYm0xdlpIVnNaUzVsZUhCdmNuUnpJRDBnSVNSaGMzTnBaMjRnZkh3Z2NtVnhkV2x5WlNnbkxpOWZabUZwYkhNbktTaG1kVzVqZEdsdmJpZ3BlMXh1SUNCMllYSWdRU0E5SUh0OVhHNGdJQ0FnTENCQ0lEMGdlMzFjYmlBZ0lDQXNJRk1nUFNCVGVXMWliMndvS1Z4dUlDQWdJQ3dnU3lBOUlDZGhZbU5rWldabmFHbHFhMnh0Ym05d2NYSnpkQ2M3WEc0Z0lFRmJVMTBnUFNBM08xeHVJQ0JMTG5Od2JHbDBLQ2NuS1M1bWIzSkZZV05vS0daMWJtTjBhVzl1S0dzcGV5QkNXMnRkSUQwZ2F6c2dmU2s3WEc0Z0lISmxkSFZ5YmlBa1lYTnphV2R1S0h0OUxDQkJLVnRUWFNBaFBTQTNJSHg4SUU5aWFtVmpkQzVyWlhsektDUmhjM05wWjI0b2UzMHNJRUlwS1M1cWIybHVLQ2NuS1NBaFBTQkxPMXh1ZlNrZ1B5Qm1kVzVqZEdsdmJpQmhjM05wWjI0b2RHRnlaMlYwTENCemIzVnlZMlVwZXlBdkx5QmxjMnhwYm5RdFpHbHpZV0pzWlMxc2FXNWxJRzV2TFhWdWRYTmxaQzEyWVhKelhHNGdJSFpoY2lCVUlDQWdJQ0E5SUhSdlQySnFaV04wS0hSaGNtZGxkQ2xjYmlBZ0lDQXNJR0ZNWlc0Z0lEMGdZWEpuZFcxbGJuUnpMbXhsYm1kMGFGeHVJQ0FnSUN3Z2FXNWtaWGdnUFNBeFhHNGdJQ0FnTENCblpYUlRlVzFpYjJ4eklEMGdaMDlRVXk1bVhHNGdJQ0FnTENCcGMwVnVkVzBnSUNBZ0lEMGdjRWxGTG1ZN1hHNGdJSGRvYVd4bEtHRk1aVzRnUGlCcGJtUmxlQ2w3WEc0Z0lDQWdkbUZ5SUZNZ0lDQWdJQ0E5SUVsUFltcGxZM1FvWVhKbmRXMWxiblJ6VzJsdVpHVjRLeXRkS1Z4dUlDQWdJQ0FnTENCclpYbHpJQ0FnUFNCblpYUlRlVzFpYjJ4eklEOGdaMlYwUzJWNWN5aFRLUzVqYjI1allYUW9aMlYwVTNsdFltOXNjeWhUS1NrZ09pQm5aWFJMWlhsektGTXBYRzRnSUNBZ0lDQXNJR3hsYm1kMGFDQTlJR3RsZVhNdWJHVnVaM1JvWEc0Z0lDQWdJQ0FzSUdvZ0lDQWdJQ0E5SURCY2JpQWdJQ0FnSUN3Z2EyVjVPMXh1SUNBZ0lIZG9hV3hsS0d4bGJtZDBhQ0ErSUdvcGFXWW9hWE5GYm5WdExtTmhiR3dvVXl3Z2EyVjVJRDBnYTJWNWMxdHFLeXRkS1NsVVcydGxlVjBnUFNCVFcydGxlVjA3WEc0Z0lIMGdjbVYwZFhKdUlGUTdYRzU5SURvZ0pHRnpjMmxuYmp0Y2JseHVYRzR2THk4dkx5OHZMeTh2THk4dkx5OHZMeTljYmk4dklGZEZRbEJCUTBzZ1JrOVBWRVZTWEc0dkx5QXVMMzR2WTI5eVpTMXFjeTlzYVdKeVlYSjVMMjF2WkhWc1pYTXZYMjlpYW1WamRDMWhjM05wWjI0dWFuTmNiaTh2SUcxdlpIVnNaU0JwWkNBOUlERTBPRnh1THk4Z2JXOWtkV3hsSUdOb2RXNXJjeUE5SURBaUxDSXZMeUF4T1M0eExqTXVNU0JQWW1wbFkzUXVZWE56YVdkdUtIUmhjbWRsZEN3Z2MyOTFjbU5sS1Z4dWRtRnlJQ1JsZUhCdmNuUWdQU0J5WlhGMWFYSmxLQ2N1TDE5bGVIQnZjblFuS1R0Y2JseHVKR1Y0Y0c5eWRDZ2taWGh3YjNKMExsTWdLeUFrWlhod2IzSjBMa1lzSUNkUFltcGxZM1FuTENCN1lYTnphV2R1T2lCeVpYRjFhWEpsS0NjdUwxOXZZbXBsWTNRdFlYTnphV2R1SnlsOUtUdGNibHh1WEc0dkx5OHZMeTh2THk4dkx5OHZMeTh2THk5Y2JpOHZJRmRGUWxCQlEwc2dSazlQVkVWU1hHNHZMeUF1TDM0dlkyOXlaUzFxY3k5c2FXSnlZWEo1TDIxdlpIVnNaWE12WlhNMkxtOWlhbVZqZEM1aGMzTnBaMjR1YW5OY2JpOHZJRzF2WkhWc1pTQnBaQ0E5SURFMU1WeHVMeThnYlc5a2RXeGxJR05vZFc1cmN5QTlJREFpTENJdkx5QXhPUzR4TGpJdU5pQlBZbXBsWTNRdVoyVjBUM2R1VUhKdmNHVnlkSGxFWlhOamNtbHdkRzl5S0U4c0lGQXBYRzUyWVhJZ2RHOUpUMkpxWldOMElDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBOUlISmxjWFZwY21Vb0p5NHZYM1J2TFdsdlltcGxZM1FuS1Z4dUlDQXNJQ1JuWlhSUGQyNVFjbTl3WlhKMGVVUmxjMk55YVhCMGIzSWdQU0J5WlhGMWFYSmxLQ2N1TDE5dlltcGxZM1F0WjI5d1pDY3BMbVk3WEc1Y2JuSmxjWFZwY21Vb0p5NHZYMjlpYW1WamRDMXpZWEFuS1NnbloyVjBUM2R1VUhKdmNHVnlkSGxFWlhOamNtbHdkRzl5Snl3Z1puVnVZM1JwYjI0b0tYdGNiaUFnY21WMGRYSnVJR1oxYm1OMGFXOXVJR2RsZEU5M2JsQnliM0JsY25SNVJHVnpZM0pwY0hSdmNpaHBkQ3dnYTJWNUtYdGNiaUFnSUNCeVpYUjFjbTRnSkdkbGRFOTNibEJ5YjNCbGNuUjVSR1Z6WTNKcGNIUnZjaWgwYjBsUFltcGxZM1FvYVhRcExDQnJaWGtwTzF4dUlDQjlPMXh1ZlNrN1hHNWNibHh1THk4dkx5OHZMeTh2THk4dkx5OHZMeTh2WEc0dkx5QlhSVUpRUVVOTElFWlBUMVJGVWx4dUx5OGdMaTkrTDJOdmNtVXRhbk12YkdsaWNtRnllUzl0YjJSMWJHVnpMMlZ6Tmk1dlltcGxZM1F1WjJWMExXOTNiaTF3Y205d1pYSjBlUzFrWlhOamNtbHdkRzl5TG1welhHNHZMeUJ0YjJSMWJHVWdhV1FnUFNBeE5UTmNiaTh2SUcxdlpIVnNaU0JqYUhWdWEzTWdQU0F3SWl3aWFXMXdiM0owSUZONWJtTm9aWElnWm5KdmJTQW5MaTl6ZVc1amFHVnlMMU41Ym1Ob1pYSW5PMXh1YVcxd2IzSjBJRVJoZEdGUFltcGxZM1JTWlhCdmNuUmxjaUJtY205dElDY3VMM041Ym1Ob1pYSXZSR0YwWVU5aWFtVmpkRkpsY0c5eWRHVnlKenRjYm1sdGNHOXlkQ0JFWVhSaFQySnFaV04wVDJKelpYSjJaWElnWm5KdmJTQW5MaTl6ZVc1amFHVnlMMFJoZEdGUFltcGxZM1JQWW5ObGNuWmxjaWM3WEc1Y2JtVjRjRzl5ZENCN1UzbHVZMmhsY2l3Z1JHRjBZVTlpYW1WamRGSmxjRzl5ZEdWeUxDQkVZWFJoVDJKcVpXTjBUMkp6WlhKMlpYSjlPMXh1WEc1Y2JseHVMeThnVjBWQ1VFRkRTeUJHVDA5VVJWSWdMeTljYmk4dklDNHZjM0pqTDFONWJtTm9aWEl1YW5NaVhTd2ljMjkxY21ObFVtOXZkQ0k2SWlKOQoKLyoqKi8gfQovKioqKioqLyBdKQp9KTsKOw==",
      "sourceCodeClassname": "SlackProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-63d99d6b-5450-81d4-ac0d-2455628f08d34",
    "version": 2.700000000000001,
    "description": "Description of SlackProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "SlackProtoStub",
    "configuration": {},
    "messageSchemas": "",
    "signature": "",
    "interworking": true,
    "accessControlPolicy": "somePolicy",
    "constraints": {},
    "dataObjects": []
  },
  "sip.rethink-project.eu": {
    "sourcePackage": {
      "sourceCode": "KGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09Im9iamVjdCImJnR5cGVvZiBtb2R1bGUhPT0idW5kZWZpbmVkIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PSJmdW5jdGlvbiImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT0idW5kZWZpbmVkIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09InVuZGVmaW5lZCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT0idW5kZWZpbmVkIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuYWN0aXZhdGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIitvKyInIik7dGhyb3cgZi5jb2RlPSJNT0RVTEVfTk9UX0ZPVU5EIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PSJmdW5jdGlvbiImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKdmFyIGdyYW1tYXIgPSBtb2R1bGUuZXhwb3J0cyA9IHsKICB2OiBbewogICAgICBuYW1lOiAndmVyc2lvbicsCiAgICAgIHJlZzogL14oXGQqKSQvCiAgfV0sCiAgbzogW3sgLy9vPS0gMjA1MTggMCBJTiBJUDQgMjAzLjAuMTEzLjEKICAgIC8vIE5COiBzZXNzaW9uSWQgd2lsbCBiZSBhIFN0cmluZyBpbiBtb3N0IGNhc2VzIGJlY2F1c2UgaXQgaXMgaHVnZQogICAgbmFtZTogJ29yaWdpbicsCiAgICByZWc6IC9eKFxTKikgKFxkKikgKFxkKikgKFxTKikgSVAoXGQpIChcUyopLywKICAgIG5hbWVzOiBbJ3VzZXJuYW1lJywgJ3Nlc3Npb25JZCcsICdzZXNzaW9uVmVyc2lvbicsICduZXRUeXBlJywgJ2lwVmVyJywgJ2FkZHJlc3MnXSwKICAgIGZvcm1hdDogIiVzICVzICVkICVzIElQJWQgJXMiCiAgfV0sCiAgLy8gZGVmYXVsdCBwYXJzaW5nIG9mIHRoZXNlIG9ubHkgKHRob3VnaCBzb21lIG9mIHRoZXNlIGZlZWwgb3V0ZGF0ZWQpCiAgczogW3sgbmFtZTogJ25hbWUnIH1dLAogIGk6IFt7IG5hbWU6ICdkZXNjcmlwdGlvbicgfV0sCiAgdTogW3sgbmFtZTogJ3VyaScgfV0sCiAgZTogW3sgbmFtZTogJ2VtYWlsJyB9XSwKICBwOiBbeyBuYW1lOiAncGhvbmUnIH1dLAogIHo6IFt7IG5hbWU6ICd0aW1lem9uZXMnIH1dLCAvLyBUT0RPOiB0aGlzIG9uZSBjYW4gYWN0dWFsbHkgYmUgcGFyc2VkIHByb3Blcmx5Li4KICByOiBbeyBuYW1lOiAncmVwZWF0cycgfV0sICAgLy8gVE9ETzogdGhpcyBvbmUgY2FuIGFsc28gYmUgcGFyc2VkIHByb3Blcmx5CiAgLy9rOiBbe31dLCAvLyBvdXRkYXRlZCB0aGluZyBpZ25vcmVkCiAgdDogW3sgLy90PTAgMAogICAgbmFtZTogJ3RpbWluZycsCiAgICByZWc6IC9eKFxkKikgKFxkKikvLAogICAgbmFtZXM6IFsnc3RhcnQnLCAnc3RvcCddLAogICAgZm9ybWF0OiAiJWQgJWQiCiAgfV0sCiAgYzogW3sgLy9jPUlOIElQNCAxMC40Ny4xOTcuMjYKICAgICAgbmFtZTogJ2Nvbm5lY3Rpb24nLAogICAgICByZWc6IC9eSU4gSVAoXGQpIChcUyopLywKICAgICAgbmFtZXM6IFsndmVyc2lvbicsICdpcCddLAogICAgICBmb3JtYXQ6ICJJTiBJUCVkICVzIgogIH1dLAogIGI6IFt7IC8vYj1BUzo0MDAwCiAgICAgIHB1c2g6ICdiYW5kd2lkdGgnLAogICAgICByZWc6IC9eKFRJQVN8QVN8Q1R8UlJ8UlMpOihcZCopLywKICAgICAgbmFtZXM6IFsndHlwZScsICdsaW1pdCddLAogICAgICBmb3JtYXQ6ICIlczolcyIKICB9XSwKICBtOiBbeyAvL209dmlkZW8gNTE3NDQgUlRQL0FWUCAxMjYgOTcgOTggMzQgMzEKICAgICAgLy8gTkI6IHNwZWNpYWwgLSBwdXNoZXMgdG8gc2Vzc2lvbgogICAgICAvLyBUT0RPOiBydHAvZm10cCBzaG91bGQgYmUgZmlsdGVyZWQgYnkgdGhlIHBheWxvYWRzIGZvdW5kIGhlcmU/CiAgICAgIHJlZzogL14oXHcqKSAoXGQqKSAoW1x3XC9dKikoPzogKC4qKSk/LywKICAgICAgbmFtZXM6IFsndHlwZScsICdwb3J0JywgJ3Byb3RvY29sJywgJ3BheWxvYWRzJ10sCiAgICAgIGZvcm1hdDogIiVzICVkICVzICVzIgogIH1dLAogIGE6IFsKICAgIHsgLy9hPXJ0cG1hcDoxMTAgb3B1cy80ODAwMC8yCiAgICAgIHB1c2g6ICdydHAnLAogICAgICByZWc6IC9ecnRwbWFwOihcZCopIChbXHdcLVwuXSopKD86XHMqXC8oXGQqKSg/OlxzKlwvKFxTKikpPyk/LywKICAgICAgbmFtZXM6IFsncGF5bG9hZCcsICdjb2RlYycsICdyYXRlJywgJ2VuY29kaW5nJ10sCiAgICAgIGZvcm1hdDogZnVuY3Rpb24gKG8pIHsKICAgICAgICByZXR1cm4gKG8uZW5jb2RpbmcpID8KICAgICAgICAgICJydHBtYXA6JWQgJXMvJXMvJXMiOgogICAgICAgICAgby5yYXRlID8KICAgICAgICAgICJydHBtYXA6JWQgJXMvJXMiOgogICAgICAgICAgInJ0cG1hcDolZCAlcyI7CiAgICAgIH0KICAgIH0sCiAgICB7CiAgICAgIC8vYT1mbXRwOjEwOCBwcm9maWxlLWxldmVsLWlkPTI0O29iamVjdD0yMztiaXRyYXRlPTY0MDAwCiAgICAgIC8vYT1mbXRwOjExMSBtaW5wdGltZT0xMDsgdXNlaW5iYW5kZmVjPTEKICAgICAgcHVzaDogJ2ZtdHAnLAogICAgICByZWc6IC9eZm10cDooXGQqKSAoW1xTfCBdKikvLAogICAgICBuYW1lczogWydwYXlsb2FkJywgJ2NvbmZpZyddLAogICAgICBmb3JtYXQ6ICJmbXRwOiVkICVzIgogICAgfSwKICAgIHsgLy9hPWNvbnRyb2w6c3RyZWFtaWQ9MAogICAgICAgIG5hbWU6ICdjb250cm9sJywKICAgICAgICByZWc6IC9eY29udHJvbDooLiopLywKICAgICAgICBmb3JtYXQ6ICJjb250cm9sOiVzIgogICAgfSwKICAgIHsgLy9hPXJ0Y3A6NjUxNzkgSU4gSVA0IDE5My44NC43Ny4xOTQKICAgICAgbmFtZTogJ3J0Y3AnLAogICAgICByZWc6IC9ecnRjcDooXGQqKSg/OiAoXFMqKSBJUChcZCkgKFxTKikpPy8sCiAgICAgIG5hbWVzOiBbJ3BvcnQnLCAnbmV0VHlwZScsICdpcFZlcicsICdhZGRyZXNzJ10sCiAgICAgIGZvcm1hdDogZnVuY3Rpb24gKG8pIHsKICAgICAgICByZXR1cm4gKG8uYWRkcmVzcyAhPSBudWxsKSA/CiAgICAgICAgICAicnRjcDolZCAlcyBJUCVkICVzIjoKICAgICAgICAgICJydGNwOiVkIjsKICAgICAgfQogICAgfSwKICAgIHsgLy9hPXJ0Y3AtZmI6OTggdHJyLWludCAxMDAKICAgICAgcHVzaDogJ3J0Y3BGYlRyckludCcsCiAgICAgIHJlZzogL15ydGNwLWZiOihcKnxcZCopIHRyci1pbnQgKFxkKikvLAogICAgICBuYW1lczogWydwYXlsb2FkJywgJ3ZhbHVlJ10sCiAgICAgIGZvcm1hdDogInJ0Y3AtZmI6JWQgdHJyLWludCAlZCIKICAgIH0sCiAgICB7IC8vYT1ydGNwLWZiOjk4IG5hY2sgcnBzaQogICAgICBwdXNoOiAncnRjcEZiJywKICAgICAgcmVnOiAvXnJ0Y3AtZmI6KFwqfFxkKikgKFtcdy1fXSopKD86IChbXHctX10qKSk/LywKICAgICAgbmFtZXM6IFsncGF5bG9hZCcsICd0eXBlJywgJ3N1YnR5cGUnXSwKICAgICAgZm9ybWF0OiBmdW5jdGlvbiAobykgewogICAgICAgIHJldHVybiAoby5zdWJ0eXBlICE9IG51bGwpID8KICAgICAgICAgICJydGNwLWZiOiVzICVzICVzIjoKICAgICAgICAgICJydGNwLWZiOiVzICVzIjsKICAgICAgfQogICAgfSwKICAgIHsgLy9hPWV4dG1hcDoyIHVybjppZXRmOnBhcmFtczpydHAtaGRyZXh0OnRvZmZzZXQKICAgICAgLy9hPWV4dG1hcDoxL3JlY3Zvbmx5IFVSSS1ncHMtc3RyaW5nCiAgICAgIHB1c2g6ICdleHQnLAogICAgICByZWc6IC9eZXh0bWFwOihbXHdfXC9dKikgKFxTKikoPzogKFxTKikpPy8sCiAgICAgIG5hbWVzOiBbJ3ZhbHVlJywgJ3VyaScsICdjb25maWcnXSwgLy8gdmFsdWUgbWF5IGluY2x1ZGUgIi9kaXJlY3Rpb24iIHN1ZmZpeAogICAgICBmb3JtYXQ6IGZ1bmN0aW9uIChvKSB7CiAgICAgICAgcmV0dXJuIChvLmNvbmZpZyAhPSBudWxsKSA/CiAgICAgICAgICAiZXh0bWFwOiVzICVzICVzIjoKICAgICAgICAgICJleHRtYXA6JXMgJXMiOwogICAgICB9CiAgICB9LAogICAgewogICAgICAvL2E9Y3J5cHRvOjEgQUVTX0NNXzEyOF9ITUFDX1NIQTFfODAgaW5saW5lOlBTMXVRQ1ZlZUNGQ2FuVm1jamtwUHl3ak5XaGNZRDBtWFh0eGFWQlJ8Ml4yMHwxOjMyCiAgICAgIHB1c2g6ICdjcnlwdG8nLAogICAgICByZWc6IC9eY3J5cHRvOihcZCopIChbXHdfXSopIChcUyopKD86IChcUyopKT8vLAogICAgICBuYW1lczogWydpZCcsICdzdWl0ZScsICdjb25maWcnLCAnc2Vzc2lvbkNvbmZpZyddLAogICAgICBmb3JtYXQ6IGZ1bmN0aW9uIChvKSB7CiAgICAgICAgcmV0dXJuIChvLnNlc3Npb25Db25maWcgIT0gbnVsbCkgPwogICAgICAgICAgImNyeXB0bzolZCAlcyAlcyAlcyI6CiAgICAgICAgICAiY3J5cHRvOiVkICVzICVzIjsKICAgICAgfQogICAgfSwKICAgIHsgLy9hPXNldHVwOmFjdHBhc3MKICAgICAgbmFtZTogJ3NldHVwJywKICAgICAgcmVnOiAvXnNldHVwOihcdyopLywKICAgICAgZm9ybWF0OiAic2V0dXA6JXMiCiAgICB9LAogICAgeyAvL2E9bWlkOjEKICAgICAgbmFtZTogJ21pZCcsCiAgICAgIHJlZzogL15taWQ6KFteXHNdKikvLAogICAgICBmb3JtYXQ6ICJtaWQ6JXMiCiAgICB9LAogICAgeyAvL2E9bXNpZDowYzhiMDY0ZC1kODA3LTQzYjQtYjQzNC1mOTJhODg5ZDg1ODcgOTgxNzg2ODUtZDQwOS00NmUwLThlMTYtN2VmMGRiMGRiNjRhCiAgICAgIG5hbWU6ICdtc2lkJywKICAgICAgcmVnOiAvXm1zaWQ6KC4qKS8sCiAgICAgIGZvcm1hdDogIm1zaWQ6JXMiCiAgICB9LAogICAgeyAvL2E9cHRpbWU6MjAKICAgICAgbmFtZTogJ3B0aW1lJywKICAgICAgcmVnOiAvXnB0aW1lOihcZCopLywKICAgICAgZm9ybWF0OiAicHRpbWU6JWQiCiAgICB9LAogICAgeyAvL2E9bWF4cHRpbWU6NjAKICAgICAgbmFtZTogJ21heHB0aW1lJywKICAgICAgcmVnOiAvXm1heHB0aW1lOihcZCopLywKICAgICAgZm9ybWF0OiAibWF4cHRpbWU6JWQiCiAgICB9LAogICAgeyAvL2E9c2VuZHJlY3YKICAgICAgbmFtZTogJ2RpcmVjdGlvbicsCiAgICAgIHJlZzogL14oc2VuZHJlY3Z8cmVjdm9ubHl8c2VuZG9ubHl8aW5hY3RpdmUpLwogICAgfSwKICAgIHsgLy9hPWljZS1saXRlCiAgICAgIG5hbWU6ICdpY2VsaXRlJywKICAgICAgcmVnOiAvXihpY2UtbGl0ZSkvCiAgICB9LAogICAgeyAvL2E9aWNlLXVmcmFnOkY3Z0kKICAgICAgbmFtZTogJ2ljZVVmcmFnJywKICAgICAgcmVnOiAvXmljZS11ZnJhZzooXFMqKS8sCiAgICAgIGZvcm1hdDogImljZS11ZnJhZzolcyIKICAgIH0sCiAgICB7IC8vYT1pY2UtcHdkOng5Y21sL1l6aWNoVjIrWGxoaU11OGcKICAgICAgbmFtZTogJ2ljZVB3ZCcsCiAgICAgIHJlZzogL15pY2UtcHdkOihcUyopLywKICAgICAgZm9ybWF0OiAiaWNlLXB3ZDolcyIKICAgIH0sCiAgICB7IC8vYT1maW5nZXJwcmludDpTSEEtMSAwMDoxMToyMjozMzo0NDo1NTo2Njo3Nzo4ODo5OTpBQTpCQjpDQzpERDpFRTpGRjowMDoxMToyMjozMwogICAgICBuYW1lOiAnZmluZ2VycHJpbnQnLAogICAgICByZWc6IC9eZmluZ2VycHJpbnQ6KFxTKikgKFxTKikvLAogICAgICBuYW1lczogWyd0eXBlJywgJ2hhc2gnXSwKICAgICAgZm9ybWF0OiAiZmluZ2VycHJpbnQ6JXMgJXMiCiAgICB9LAogICAgewogICAgICAvL2E9Y2FuZGlkYXRlOjAgMSBVRFAgMjExMzY2NzMyNyAyMDMuMC4xMTMuMSA1NDQwMCB0eXAgaG9zdAogICAgICAvL2E9Y2FuZGlkYXRlOjExNjI4NzUwODEgMSB1ZHAgMjExMzkzNzE1MSAxOTIuMTY4LjM0Ljc1IDYwMDE3IHR5cCBob3N0IGdlbmVyYXRpb24gMCBuZXR3b3JrLWlkIDMgbmV0d29yay1jb3N0IDEwCiAgICAgIC8vYT1jYW5kaWRhdGU6MzI4OTkxMjk1NyAyIHVkcCAxODQ1NTAxNjk1IDE5My44NC43Ny4xOTQgNjAwMTcgdHlwIHNyZmx4IHJhZGRyIDE5Mi4xNjguMzQuNzUgcnBvcnQgNjAwMTcgZ2VuZXJhdGlvbiAwIG5ldHdvcmstaWQgMyBuZXR3b3JrLWNvc3QgMTAKICAgICAgLy9hPWNhbmRpZGF0ZToyMjk4MTU2MjAgMSB0Y3AgMTUxODI4MDQ0NyAxOTIuMTY4LjE1MC4xOSA2MDAxNyB0eXAgaG9zdCB0Y3B0eXBlIGFjdGl2ZSBnZW5lcmF0aW9uIDAgbmV0d29yay1pZCAzIG5ldHdvcmstY29zdCAxMAogICAgICAvL2E9Y2FuZGlkYXRlOjMyODk5MTI5NTcgMiB0Y3AgMTg0NTUwMTY5NSAxOTMuODQuNzcuMTk0IDYwMDE3IHR5cCBzcmZseCByYWRkciAxOTIuMTY4LjM0Ljc1IHJwb3J0IDYwMDE3IHRjcHR5cGUgcGFzc2l2ZSBnZW5lcmF0aW9uIDAgbmV0d29yay1pZCAzIG5ldHdvcmstY29zdCAxMAogICAgICBwdXNoOidjYW5kaWRhdGVzJywKICAgICAgcmVnOiAvXmNhbmRpZGF0ZTooXFMqKSAoXGQqKSAoXFMqKSAoXGQqKSAoXFMqKSAoXGQqKSB0eXAgKFxTKikoPzogcmFkZHIgKFxTKikgcnBvcnQgKFxkKikpPyg/OiB0Y3B0eXBlIChcUyopKT8oPzogZ2VuZXJhdGlvbiAoXGQqKSk/KD86IG5ldHdvcmstaWQgKFxkKikpPyg/OiBuZXR3b3JrLWNvc3QgKFxkKikpPy8sCiAgICAgIG5hbWVzOiBbJ2ZvdW5kYXRpb24nLCAnY29tcG9uZW50JywgJ3RyYW5zcG9ydCcsICdwcmlvcml0eScsICdpcCcsICdwb3J0JywgJ3R5cGUnLCAncmFkZHInLCAncnBvcnQnLCAndGNwdHlwZScsICdnZW5lcmF0aW9uJywgJ25ldHdvcmstaWQnLCAnbmV0d29yay1jb3N0J10sCiAgICAgIGZvcm1hdDogZnVuY3Rpb24gKG8pIHsKICAgICAgICB2YXIgc3RyID0gImNhbmRpZGF0ZTolcyAlZCAlcyAlZCAlcyAlZCB0eXAgJXMiOwoKICAgICAgICBzdHIgKz0gKG8ucmFkZHIgIT0gbnVsbCkgPyAiIHJhZGRyICVzIHJwb3J0ICVkIiA6ICIldiV2IjsKCiAgICAgICAgLy8gTkI6IGNhbmRpZGF0ZSBoYXMgdGhyZWUgb3B0aW9uYWwgY2h1bmtzLCBzbyAldm9pZCBtaWRkbGVzIG9uZSBpZiBpdCdzIG1pc3NpbmcKICAgICAgICBzdHIgKz0gKG8udGNwdHlwZSAhPSBudWxsKSA/ICIgdGNwdHlwZSAlcyIgOiAiJXYiOwoKICAgICAgICBpZiAoby5nZW5lcmF0aW9uICE9IG51bGwpIHsKICAgICAgICAgIHN0ciArPSAiIGdlbmVyYXRpb24gJWQiOwogICAgICAgIH0KCiAgICAgICAgc3RyICs9IChvWyduZXR3b3JrLWlkJ10gIT0gbnVsbCkgPyAiIG5ldHdvcmstaWQgJWQiIDogIiV2IjsKICAgICAgICBzdHIgKz0gKG9bJ25ldHdvcmstY29zdCddICE9IG51bGwpID8gIiBuZXR3b3JrLWNvc3QgJWQiIDogIiV2IjsKICAgICAgICByZXR1cm4gc3RyOwogICAgICB9CiAgICB9LAogICAgeyAvL2E9ZW5kLW9mLWNhbmRpZGF0ZXMgKGtlZXAgYWZ0ZXIgdGhlIGNhbmRpZGF0ZXMgbGluZSBmb3IgcmVhZGFiaWxpdHkpCiAgICAgIG5hbWU6ICdlbmRPZkNhbmRpZGF0ZXMnLAogICAgICByZWc6IC9eKGVuZC1vZi1jYW5kaWRhdGVzKS8KICAgIH0sCiAgICB7IC8vYT1yZW1vdGUtY2FuZGlkYXRlczoxIDIwMy4wLjExMy4xIDU0NDAwIDIgMjAzLjAuMTEzLjEgNTQ0MDEgLi4uCiAgICAgIG5hbWU6ICdyZW1vdGVDYW5kaWRhdGVzJywKICAgICAgcmVnOiAvXnJlbW90ZS1jYW5kaWRhdGVzOiguKikvLAogICAgICBmb3JtYXQ6ICJyZW1vdGUtY2FuZGlkYXRlczolcyIKICAgIH0sCiAgICB7IC8vYT1pY2Utb3B0aW9uczpnb29nbGUtaWNlCiAgICAgIG5hbWU6ICdpY2VPcHRpb25zJywKICAgICAgcmVnOiAvXmljZS1vcHRpb25zOihcUyopLywKICAgICAgZm9ybWF0OiAiaWNlLW9wdGlvbnM6JXMiCiAgICB9LAogICAgeyAvL2E9c3NyYzoyNTY2MTA3NTY5IGNuYW1lOnQ5WVU4TTFVeFRGOFkxQTEKICAgICAgcHVzaDogInNzcmNzIiwKICAgICAgcmVnOiAvXnNzcmM6KFxkKikgKFtcd19dKikoPzo6KC4qKSk/LywKICAgICAgbmFtZXM6IFsnaWQnLCAnYXR0cmlidXRlJywgJ3ZhbHVlJ10sCiAgICAgIGZvcm1hdDogZnVuY3Rpb24gKG8pIHsKICAgICAgICB2YXIgc3RyID0gInNzcmM6JWQiOwogICAgICAgIGlmIChvLmF0dHJpYnV0ZSAhPSBudWxsKSB7CiAgICAgICAgICBzdHIgKz0gIiAlcyI7CiAgICAgICAgICBpZiAoby52YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgICAgIHN0ciArPSAiOiVzIjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0cjsKICAgICAgfQogICAgfSwKICAgIHsgLy9hPXNzcmMtZ3JvdXA6RkVDIDEgMgogICAgICBwdXNoOiAic3NyY0dyb3VwcyIsCiAgICAgIHJlZzogL15zc3JjLWdyb3VwOihcdyopICguKikvLAogICAgICBuYW1lczogWydzZW1hbnRpY3MnLCAnc3NyY3MnXSwKICAgICAgZm9ybWF0OiAic3NyYy1ncm91cDolcyAlcyIKICAgIH0sCiAgICB7IC8vYT1tc2lkLXNlbWFudGljOiBXTVMgSnZsYW01WDNTWDFPUDZwbjIweldvZ3ZhS0p6NUhqZjlPbmxWCiAgICAgIG5hbWU6ICJtc2lkU2VtYW50aWMiLAogICAgICByZWc6IC9ebXNpZC1zZW1hbnRpYzpccz8oXHcqKSAoXFMqKS8sCiAgICAgIG5hbWVzOiBbJ3NlbWFudGljJywgJ3Rva2VuJ10sCiAgICAgIGZvcm1hdDogIm1zaWQtc2VtYW50aWM6ICVzICVzIiAvLyBzcGFjZSBhZnRlciAiOiIgaXMgbm90IGFjY2lkZW50YWwKICAgIH0sCiAgICB7IC8vYT1ncm91cDpCVU5ETEUgYXVkaW8gdmlkZW8KICAgICAgcHVzaDogJ2dyb3VwcycsCiAgICAgIHJlZzogL15ncm91cDooXHcqKSAoLiopLywKICAgICAgbmFtZXM6IFsndHlwZScsICdtaWRzJ10sCiAgICAgIGZvcm1hdDogImdyb3VwOiVzICVzIgogICAgfSwKICAgIHsgLy9hPXJ0Y3AtbXV4CiAgICAgIG5hbWU6ICdydGNwTXV4JywKICAgICAgcmVnOiAvXihydGNwLW11eCkvCiAgICB9LAogICAgeyAvL2E9cnRjcC1yc2l6ZQogICAgICBuYW1lOiAncnRjcFJzaXplJywKICAgICAgcmVnOiAvXihydGNwLXJzaXplKS8KICAgIH0sCiAgICB7IC8vYT1zY3RwbWFwOjUwMDAgd2VicnRjLWRhdGFjaGFubmVsIDEwMjQKICAgICAgbmFtZTogJ3NjdHBtYXAnLAogICAgICByZWc6IC9ec2N0cG1hcDooW1x3X1wvXSopIChcUyopKD86IChcUyopKT8vLAogICAgICBuYW1lczogWydzY3RwbWFwTnVtYmVyJywgJ2FwcCcsICdtYXhNZXNzYWdlU2l6ZSddLAogICAgICBmb3JtYXQ6IGZ1bmN0aW9uIChvKSB7CiAgICAgICAgcmV0dXJuIChvLm1heE1lc3NhZ2VTaXplICE9IG51bGwpID8KICAgICAgICAgICJzY3RwbWFwOiVzICVzICVzIiA6CiAgICAgICAgICAic2N0cG1hcDolcyAlcyI7CiAgICAgIH0KICAgIH0sCiAgICB7IC8vIGFueSBhPSB0aGF0IHdlIGRvbid0IHVuZGVyc3RhbmQgaXMga2VwdHMgdmVyYmF0aW0gb24gbWVkaWEuaW52YWxpZAogICAgICBwdXNoOiAnaW52YWxpZCcsCiAgICAgIG5hbWVzOiBbInZhbHVlIl0KICAgIH0KICBdCn07CgovLyBzZXQgc2Vuc2libGUgZGVmYXVsdHMgdG8gYXZvaWQgcG9sbHV0aW5nIHRoZSBncmFtbWFyIHdpdGggYm9yaW5nIGRldGFpbHMKT2JqZWN0LmtleXMoZ3JhbW1hcikuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgdmFyIG9ianMgPSBncmFtbWFyW2tleV07CiAgb2Jqcy5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHsKICAgIGlmICghb2JqLnJlZykgewogICAgICBvYmoucmVnID0gLyguKikvOwogICAgfQogICAgaWYgKCFvYmouZm9ybWF0KSB7CiAgICAgIG9iai5mb3JtYXQgPSAiJXMiOwogICAgfQogIH0pOwp9KTsKCn0se31dLDI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewp2YXIgcGFyc2VyID0gcmVxdWlyZSgnLi9wYXJzZXInKTsKdmFyIHdyaXRlciA9IHJlcXVpcmUoJy4vd3JpdGVyJyk7CgpleHBvcnRzLndyaXRlID0gd3JpdGVyOwpleHBvcnRzLnBhcnNlID0gcGFyc2VyLnBhcnNlOwpleHBvcnRzLnBhcnNlRm10cENvbmZpZyA9IHBhcnNlci5wYXJzZUZtdHBDb25maWc7CmV4cG9ydHMucGFyc2VQYXlsb2FkcyA9IHBhcnNlci5wYXJzZVBheWxvYWRzOwpleHBvcnRzLnBhcnNlUmVtb3RlQ2FuZGlkYXRlcyA9IHBhcnNlci5wYXJzZVJlbW90ZUNhbmRpZGF0ZXM7Cgp9LHsiLi9wYXJzZXIiOjMsIi4vd3JpdGVyIjo0fV0sMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CnZhciB0b0ludElmSW50ID0gZnVuY3Rpb24gKHYpIHsKICByZXR1cm4gU3RyaW5nKE51bWJlcih2KSkgPT09IHYgPyBOdW1iZXIodikgOiB2Owp9OwoKdmFyIGF0dGFjaFByb3BlcnRpZXMgPSBmdW5jdGlvbiAobWF0Y2gsIGxvY2F0aW9uLCBuYW1lcywgcmF3TmFtZSkgewogIGlmIChyYXdOYW1lICYmICFuYW1lcykgewogICAgbG9jYXRpb25bcmF3TmFtZV0gPSB0b0ludElmSW50KG1hdGNoWzFdKTsKICB9CiAgZWxzZSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5hbWVzLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgIGlmIChtYXRjaFtpKzFdICE9IG51bGwpIHsKICAgICAgICBsb2NhdGlvbltuYW1lc1tpXV0gPSB0b0ludElmSW50KG1hdGNoW2krMV0pOwogICAgICB9CiAgICB9CiAgfQp9OwoKdmFyIHBhcnNlUmVnID0gZnVuY3Rpb24gKG9iaiwgbG9jYXRpb24sIGNvbnRlbnQpIHsKICB2YXIgbmVlZHNCbGFuayA9IG9iai5uYW1lICYmIG9iai5uYW1lczsKICBpZiAob2JqLnB1c2ggJiYgIWxvY2F0aW9uW29iai5wdXNoXSkgewogICAgbG9jYXRpb25bb2JqLnB1c2hdID0gW107CiAgfQogIGVsc2UgaWYgKG5lZWRzQmxhbmsgJiYgIWxvY2F0aW9uW29iai5uYW1lXSkgewogICAgbG9jYXRpb25bb2JqLm5hbWVdID0ge307CiAgfQogIHZhciBrZXlMb2NhdGlvbiA9IG9iai5wdXNoID8KICAgIHt9IDogIC8vIGJsYW5rIG9iamVjdCB0aGF0IHdpbGwgYmUgcHVzaGVkCiAgICBuZWVkc0JsYW5rID8gbG9jYXRpb25bb2JqLm5hbWVdIDogbG9jYXRpb247IC8vIG90aGVyd2lzZSwgbmFtZWQgbG9jYXRpb24gb3Igcm9vdAoKICBhdHRhY2hQcm9wZXJ0aWVzKGNvbnRlbnQubWF0Y2gob2JqLnJlZyksIGtleUxvY2F0aW9uLCBvYmoubmFtZXMsIG9iai5uYW1lKTsKCiAgaWYgKG9iai5wdXNoKSB7CiAgICBsb2NhdGlvbltvYmoucHVzaF0ucHVzaChrZXlMb2NhdGlvbik7CiAgfQp9OwoKdmFyIGdyYW1tYXIgPSByZXF1aXJlKCcuL2dyYW1tYXInKTsKdmFyIHZhbGlkTGluZSA9IFJlZ0V4cC5wcm90b3R5cGUudGVzdC5iaW5kKC9eKFthLXpdKT0oLiopLyk7CgpleHBvcnRzLnBhcnNlID0gZnVuY3Rpb24gKHNkcCkgewogIHZhciBzZXNzaW9uID0ge30KICAgICwgbWVkaWEgPSBbXQogICAgLCBsb2NhdGlvbiA9IHNlc3Npb247IC8vIHBvaW50cyBhdCB3aGVyZSBwcm9wZXJ0aWVzIGdvIHVuZGVyIChvbmUgb2YgdGhlIGFib3ZlKQoKICAvLyBwYXJzZSBsaW5lcyB3ZSB1bmRlcnN0YW5kCiAgc2RwLnNwbGl0KC8oXHJcbnxccnxcbikvKS5maWx0ZXIodmFsaWRMaW5lKS5mb3JFYWNoKGZ1bmN0aW9uIChsKSB7CiAgICB2YXIgdHlwZSA9IGxbMF07CiAgICB2YXIgY29udGVudCA9IGwuc2xpY2UoMik7CiAgICBpZiAodHlwZSA9PT0gJ20nKSB7CiAgICAgIG1lZGlhLnB1c2goe3J0cDogW10sIGZtdHA6IFtdfSk7CiAgICAgIGxvY2F0aW9uID0gbWVkaWFbbWVkaWEubGVuZ3RoLTFdOyAvLyBwb2ludCBhdCBsYXRlc3QgbWVkaWEgbGluZQogICAgfQoKICAgIGZvciAodmFyIGogPSAwOyBqIDwgKGdyYW1tYXJbdHlwZV0gfHwgW10pLmxlbmd0aDsgaiArPSAxKSB7CiAgICAgIHZhciBvYmogPSBncmFtbWFyW3R5cGVdW2pdOwogICAgICBpZiAob2JqLnJlZy50ZXN0KGNvbnRlbnQpKSB7CiAgICAgICAgcmV0dXJuIHBhcnNlUmVnKG9iaiwgbG9jYXRpb24sIGNvbnRlbnQpOwogICAgICB9CiAgICB9CiAgfSk7CgogIHNlc3Npb24ubWVkaWEgPSBtZWRpYTsgLy8gbGluayBpdCB1cAogIHJldHVybiBzZXNzaW9uOwp9OwoKdmFyIGZtdHBSZWR1Y2VyID0gZnVuY3Rpb24gKGFjYywgZXhwcikgewogIHZhciBzID0gZXhwci5zcGxpdCgvPSguKykvLCAyKTsKICBpZiAocy5sZW5ndGggPT09IDIpIHsKICAgIGFjY1tzWzBdXSA9IHRvSW50SWZJbnQoc1sxXSk7CiAgfQogIHJldHVybiBhY2M7Cn07CgpleHBvcnRzLnBhcnNlRm10cENvbmZpZyA9IGZ1bmN0aW9uIChzdHIpIHsKICByZXR1cm4gc3RyLnNwbGl0KC9cO1xzPy8pLnJlZHVjZShmbXRwUmVkdWNlciwge30pOwp9OwoKZXhwb3J0cy5wYXJzZVBheWxvYWRzID0gZnVuY3Rpb24gKHN0cikgewogIHJldHVybiBzdHIuc3BsaXQoJyAnKS5tYXAoTnVtYmVyKTsKfTsKCmV4cG9ydHMucGFyc2VSZW1vdGVDYW5kaWRhdGVzID0gZnVuY3Rpb24gKHN0cikgewogIHZhciBjYW5kaWRhdGVzID0gW107CiAgdmFyIHBhcnRzID0gc3RyLnNwbGl0KCcgJykubWFwKHRvSW50SWZJbnQpOwogIGZvciAodmFyIGkgPSAwOyBpIDwgcGFydHMubGVuZ3RoOyBpICs9IDMpIHsKICAgIGNhbmRpZGF0ZXMucHVzaCh7CiAgICAgIGNvbXBvbmVudDogcGFydHNbaV0sCiAgICAgIGlwOiBwYXJ0c1tpICsgMV0sCiAgICAgIHBvcnQ6IHBhcnRzW2kgKyAyXQogICAgfSk7CiAgfQogIHJldHVybiBjYW5kaWRhdGVzOwp9OwoKfSx7Ii4vZ3JhbW1hciI6MX1dLDQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewp2YXIgZ3JhbW1hciA9IHJlcXVpcmUoJy4vZ3JhbW1hcicpOwoKLy8gY3VzdG9taXplZCB1dGlsLmZvcm1hdCAtIGRpc2NhcmRzIGV4Y2VzcyBhcmd1bWVudHMgYW5kIGNhbiB2b2lkIG1pZGRsZSBvbmVzCnZhciBmb3JtYXRSZWdFeHAgPSAvJVtzZHYlXS9nOwp2YXIgZm9ybWF0ID0gZnVuY3Rpb24gKGZvcm1hdFN0cikgewogIHZhciBpID0gMTsKICB2YXIgYXJncyA9IGFyZ3VtZW50czsKICB2YXIgbGVuID0gYXJncy5sZW5ndGg7CiAgcmV0dXJuIGZvcm1hdFN0ci5yZXBsYWNlKGZvcm1hdFJlZ0V4cCwgZnVuY3Rpb24gKHgpIHsKICAgIGlmIChpID49IGxlbikgewogICAgICByZXR1cm4geDsgLy8gbWlzc2luZyBhcmd1bWVudAogICAgfQogICAgdmFyIGFyZyA9IGFyZ3NbaV07CiAgICBpICs9IDE7CiAgICBzd2l0Y2ggKHgpIHsKICAgICAgY2FzZSAnJSUnOgogICAgICAgIHJldHVybiAnJSc7CiAgICAgIGNhc2UgJyVzJzoKICAgICAgICByZXR1cm4gU3RyaW5nKGFyZyk7CiAgICAgIGNhc2UgJyVkJzoKICAgICAgICByZXR1cm4gTnVtYmVyKGFyZyk7CiAgICAgIGNhc2UgJyV2JzoKICAgICAgICByZXR1cm4gJyc7CiAgICB9CiAgfSk7CiAgLy8gTkI6IHdlIGRpc2NhcmQgZXhjZXNzIGFyZ3VtZW50cyAtIHRoZXkgYXJlIHR5cGljYWxseSB1bmRlZmluZWQgZnJvbSBtYWtlTGluZQp9OwoKdmFyIG1ha2VMaW5lID0gZnVuY3Rpb24gKHR5cGUsIG9iaiwgbG9jYXRpb24pIHsKICB2YXIgc3RyID0gb2JqLmZvcm1hdCBpbnN0YW5jZW9mIEZ1bmN0aW9uID8KICAgIChvYmouZm9ybWF0KG9iai5wdXNoID8gbG9jYXRpb24gOiBsb2NhdGlvbltvYmoubmFtZV0pKSA6CiAgICBvYmouZm9ybWF0OwoKICB2YXIgYXJncyA9IFt0eXBlICsgJz0nICsgc3RyXTsKICBpZiAob2JqLm5hbWVzKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iai5uYW1lcy5sZW5ndGg7IGkgKz0gMSkgewogICAgICB2YXIgbiA9IG9iai5uYW1lc1tpXTsKICAgICAgaWYgKG9iai5uYW1lKSB7CiAgICAgICAgYXJncy5wdXNoKGxvY2F0aW9uW29iai5uYW1lXVtuXSk7CiAgICAgIH0KICAgICAgZWxzZSB7IC8vIGZvciBtTGluZSBhbmQgcHVzaCBhdHRyaWJ1dGVzCiAgICAgICAgYXJncy5wdXNoKGxvY2F0aW9uW29iai5uYW1lc1tpXV0pOwogICAgICB9CiAgICB9CiAgfQogIGVsc2UgewogICAgYXJncy5wdXNoKGxvY2F0aW9uW29iai5uYW1lXSk7CiAgfQogIHJldHVybiBmb3JtYXQuYXBwbHkobnVsbCwgYXJncyk7Cn07CgovLyBSRkMgc3BlY2lmaWVkIG9yZGVyCi8vIFRPRE86IGV4dGVuZCB0aGlzIHdpdGggYWxsIHRoZSByZXN0CnZhciBkZWZhdWx0T3V0ZXJPcmRlciA9IFsKICAndicsICdvJywgJ3MnLCAnaScsCiAgJ3UnLCAnZScsICdwJywgJ2MnLAogICdiJywgJ3QnLCAncicsICd6JywgJ2EnCl07CnZhciBkZWZhdWx0SW5uZXJPcmRlciA9IFsnaScsICdjJywgJ2InLCAnYSddOwoKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHNlc3Npb24sIG9wdHMpIHsKICBvcHRzID0gb3B0cyB8fCB7fTsKICAvLyBlbnN1cmUgY2VydGFpbiBwcm9wZXJ0aWVzIGV4aXN0CiAgaWYgKHNlc3Npb24udmVyc2lvbiA9PSBudWxsKSB7CiAgICBzZXNzaW9uLnZlcnNpb24gPSAwOyAvLyAidj0wIiBtdXN0IGJlIHRoZXJlIChvbmx5IGRlZmluZWQgdmVyc2lvbiBhdG0pCiAgfQogIGlmIChzZXNzaW9uLm5hbWUgPT0gbnVsbCkgewogICAgc2Vzc2lvbi5uYW1lID0gIiAiOyAvLyAicz0gIiBtdXN0IGJlIHRoZXJlIGlmIG5vIG1lYW5pbmdmdWwgbmFtZSBzZXQKICB9CiAgc2Vzc2lvbi5tZWRpYS5mb3JFYWNoKGZ1bmN0aW9uIChtTGluZSkgewogICAgaWYgKG1MaW5lLnBheWxvYWRzID09IG51bGwpIHsKICAgICAgbUxpbmUucGF5bG9hZHMgPSAiIjsKICAgIH0KICB9KTsKCiAgdmFyIG91dGVyT3JkZXIgPSBvcHRzLm91dGVyT3JkZXIgfHwgZGVmYXVsdE91dGVyT3JkZXI7CiAgdmFyIGlubmVyT3JkZXIgPSBvcHRzLmlubmVyT3JkZXIgfHwgZGVmYXVsdElubmVyT3JkZXI7CiAgdmFyIHNkcCA9IFtdOwoKICAvLyBsb29wIHRocm91Z2ggb3V0ZXJPcmRlciBmb3IgbWF0Y2hpbmcgcHJvcGVydGllcyBvbiBzZXNzaW9uCiAgb3V0ZXJPcmRlci5mb3JFYWNoKGZ1bmN0aW9uICh0eXBlKSB7CiAgICBncmFtbWFyW3R5cGVdLmZvckVhY2goZnVuY3Rpb24gKG9iaikgewogICAgICBpZiAob2JqLm5hbWUgaW4gc2Vzc2lvbiAmJiBzZXNzaW9uW29iai5uYW1lXSAhPSBudWxsKSB7CiAgICAgICAgc2RwLnB1c2gobWFrZUxpbmUodHlwZSwgb2JqLCBzZXNzaW9uKSk7CiAgICAgIH0KICAgICAgZWxzZSBpZiAob2JqLnB1c2ggaW4gc2Vzc2lvbiAmJiBzZXNzaW9uW29iai5wdXNoXSAhPSBudWxsKSB7CiAgICAgICAgc2Vzc2lvbltvYmoucHVzaF0uZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHNkcC5wdXNoKG1ha2VMaW5lKHR5cGUsIG9iaiwgZWwpKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CiAgfSk7CgogIC8vIHRoZW4gZm9yIGVhY2ggbWVkaWEgbGluZSwgZm9sbG93IHRoZSBpbm5lck9yZGVyCiAgc2Vzc2lvbi5tZWRpYS5mb3JFYWNoKGZ1bmN0aW9uIChtTGluZSkgewogICAgc2RwLnB1c2gobWFrZUxpbmUoJ20nLCBncmFtbWFyLm1bMF0sIG1MaW5lKSk7CgogICAgaW5uZXJPcmRlci5mb3JFYWNoKGZ1bmN0aW9uICh0eXBlKSB7CiAgICAgIGdyYW1tYXJbdHlwZV0uZm9yRWFjaChmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgaWYgKG9iai5uYW1lIGluIG1MaW5lICYmIG1MaW5lW29iai5uYW1lXSAhPSBudWxsKSB7CiAgICAgICAgICBzZHAucHVzaChtYWtlTGluZSh0eXBlLCBvYmosIG1MaW5lKSk7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKG9iai5wdXNoIGluIG1MaW5lICYmIG1MaW5lW29iai5wdXNoXSAhPSBudWxsKSB7CiAgICAgICAgICBtTGluZVtvYmoucHVzaF0uZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgc2RwLnB1c2gobWFrZUxpbmUodHlwZSwgb2JqLCBlbCkpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwogIH0pOwoKICByZXR1cm4gc2RwLmpvaW4oJ1xyXG4nKSArICdcclxuJzsKfTsKCn0seyIuL2dyYW1tYXIiOjF9XSw1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLy8gdmVyc2lvbjogMC41LjEKLy8gZGF0ZTogVHVlIEZlYiAwNyAyMDE3IDE2OjAwOjM5IEdNVCswMDAwIChXRVQpCi8vIGxpY2VuY2U6IAovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCgooZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkgewoJaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKQoJCW1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpOwoJZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpCgkJZGVmaW5lKCJTeW5jaGVyIiwgW10sIGZhY3RvcnkpOwoJZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpCgkJZXhwb3J0c1siU3luY2hlciJdID0gZmFjdG9yeSgpOwoJZWxzZQoJCXJvb3RbIiJdID0gcm9vdFsiIl0gfHwge30sIHJvb3RbIiJdWyJTeW5jaGVyIl0gPSBmYWN0b3J5KCk7Cn0pKHRoaXMsIGZ1bmN0aW9uKCkgewpyZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uCi8qKioqKiovIAlmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlCi8qKioqKiovIAkJaWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pCi8qKioqKiovIAkJCXJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzOwovKioqKioqLwovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewovKioqKioqLyAJCQlpOiBtb2R1bGVJZCwKLyoqKioqKi8gCQkJbDogZmFsc2UsCi8qKioqKiovIAkJCWV4cG9ydHM6IHt9Ci8qKioqKiovIAkJfTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KLyoqKioqKi8gCQltb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkCi8qKioqKiovIAkJbW9kdWxlLmwgPSB0cnVlOwovKioqKioqLwovKioqKioqLyAJCS8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlCi8qKioqKiovIAkJcmV0dXJuIG1vZHVsZS5leHBvcnRzOwovKioqKioqLyAJfQovKioqKioqLwovKioqKioqLwovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXykKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7Ci8qKioqKiovCi8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlczsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGlkZW50aXR5IGZ1bmN0aW9uIGZvciBjYWxsaW5nIGhhcm1vbnkgaW1wb3J0cyB3aXRoIHRoZSBjb3JyZWN0IGNvbnRleHQKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0cwovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7Ci8qKioqKiovIAkJaWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkgewovKioqKioqLyAJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgewovKioqKioqLyAJCQkJY29uZmlndXJhYmxlOiBmYWxzZSwKLyoqKioqKi8gCQkJCWVudW1lcmFibGU6IHRydWUsCi8qKioqKiovIAkJCQlnZXQ6IGdldHRlcgovKioqKioqLyAJCQl9KTsKLyoqKioqKi8gCQl9Ci8qKioqKiovIAl9OwovKioqKioqLwovKioqKioqLyAJLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXMKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkgewovKioqKioqLyAJCXZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgPwovKioqKioqLyAJCQlmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOgovKioqKioqLyAJCQlmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9OwovKioqKioqLyAJCV9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTsKLyoqKioqKi8gCQlyZXR1cm4gZ2V0dGVyOwovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbAovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9OwovKioqKioqLwovKioqKioqLyAJLy8gX193ZWJwYWNrX3B1YmxpY19wYXRoX18KLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ucCA9ICIiOwovKioqKioqLwovKioqKioqLyAJLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzCi8qKioqKiovIAlyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxNjIpOwovKioqKioqLyB9KQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAoWwovKiAwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciBjb3JlID0gbW9kdWxlLmV4cG9ydHMgPSB7dmVyc2lvbjogJzIuNC4wJ307CmlmKHR5cGVvZiBfX2UgPT0gJ251bWJlcicpX19lID0gY29yZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZgoKLyoqKi8gfSksCi8qIDEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzg2I2lzc3VlY29tbWVudC0xMTU3NTkwMjgKdmFyIGdsb2JhbCA9IG1vZHVsZS5leHBvcnRzID0gdHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoCiAgPyB3aW5kb3cgOiB0eXBlb2Ygc2VsZiAhPSAndW5kZWZpbmVkJyAmJiBzZWxmLk1hdGggPT0gTWF0aCA/IHNlbGYgOiBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpOwppZih0eXBlb2YgX19nID09ICdudW1iZXInKV9fZyA9IGdsb2JhbDsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZgoKLyoqKi8gfSksCi8qIDIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHN0b3JlICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKSgnd2tzJykKICAsIHVpZCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKQogICwgU3ltYm9sICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuU3ltYm9sCiAgLCBVU0VfU1lNQk9MID0gdHlwZW9mIFN5bWJvbCA9PSAnZnVuY3Rpb24nOwoKdmFyICRleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihuYW1lKXsKICByZXR1cm4gc3RvcmVbbmFtZV0gfHwgKHN0b3JlW25hbWVdID0KICAgIFVTRV9TWU1CT0wgJiYgU3ltYm9sW25hbWVdIHx8IChVU0VfU1lNQk9MID8gU3ltYm9sIDogdWlkKSgnU3ltYm9sLicgKyBuYW1lKSk7Cn07CgokZXhwb3J0cy5zdG9yZSA9IHN0b3JlOwoKLyoqKi8gfSksCi8qIDMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gVGhhbmsncyBJRTggZm9yIGhpcyBmdW5ueSBkZWZpbmVQcm9wZXJ0eQptb2R1bGUuZXhwb3J0cyA9ICFfX3dlYnBhY2tfcmVxdWlyZV9fKDExKShmdW5jdGlvbigpewogIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdhJywge2dldDogZnVuY3Rpb24oKXsgcmV0dXJuIDc7IH19KS5hICE9IDc7Cn0pOwoKLyoqKi8gfSksCi8qIDQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGFuT2JqZWN0ICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQogICwgSUU4X0RPTV9ERUZJTkUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KQogICwgdG9QcmltaXRpdmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKQogICwgZFAgICAgICAgICAgICAgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7CgpleHBvcnRzLmYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpID8gT2JqZWN0LmRlZmluZVByb3BlcnR5IDogZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcyl7CiAgYW5PYmplY3QoTyk7CiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwogIGFuT2JqZWN0KEF0dHJpYnV0ZXMpOwogIGlmKElFOF9ET01fREVGSU5FKXRyeSB7CiAgICByZXR1cm4gZFAoTywgUCwgQXR0cmlidXRlcyk7CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQogIGlmKCdnZXQnIGluIEF0dHJpYnV0ZXMgfHwgJ3NldCcgaW4gQXR0cmlidXRlcyl0aHJvdyBUeXBlRXJyb3IoJ0FjY2Vzc29ycyBub3Qgc3VwcG9ydGVkIScpOwogIGlmKCd2YWx1ZScgaW4gQXR0cmlidXRlcylPW1BdID0gQXR0cmlidXRlcy52YWx1ZTsKICByZXR1cm4gTzsKfTsKCi8qKiovIH0pLAovKiA1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIGlmKCFpc09iamVjdChpdCkpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYW4gb2JqZWN0IScpOwogIHJldHVybiBpdDsKfTsKCi8qKiovIH0pLAovKiA2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBkUCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KQogICwgY3JlYXRlRGVzYyA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMykgPyBmdW5jdGlvbihvYmplY3QsIGtleSwgdmFsdWUpewogIHJldHVybiBkUC5mKG9iamVjdCwga2V5LCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7Cn0gOiBmdW5jdGlvbihvYmplY3QsIGtleSwgdmFsdWUpewogIG9iamVjdFtrZXldID0gdmFsdWU7CiAgcmV0dXJuIG9iamVjdDsKfTsKCi8qKiovIH0pLAovKiA3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiB0eXBlb2YgaXQgPT09ICdvYmplY3QnID8gaXQgIT09IG51bGwgOiB0eXBlb2YgaXQgPT09ICdmdW5jdGlvbic7Cn07CgovKioqLyB9KSwKLyogOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgY29yZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQogICwgY3R4ICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkKICAsIGhpZGUgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNikKICAsIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnOwoKdmFyICRleHBvcnQgPSBmdW5jdGlvbih0eXBlLCBuYW1lLCBzb3VyY2UpewogIHZhciBJU19GT1JDRUQgPSB0eXBlICYgJGV4cG9ydC5GCiAgICAsIElTX0dMT0JBTCA9IHR5cGUgJiAkZXhwb3J0LkcKICAgICwgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuUwogICAgLCBJU19QUk9UTyAgPSB0eXBlICYgJGV4cG9ydC5QCiAgICAsIElTX0JJTkQgICA9IHR5cGUgJiAkZXhwb3J0LkIKICAgICwgSVNfV1JBUCAgID0gdHlwZSAmICRleHBvcnQuVwogICAgLCBleHBvcnRzICAgPSBJU19HTE9CQUwgPyBjb3JlIDogY29yZVtuYW1lXSB8fCAoY29yZVtuYW1lXSA9IHt9KQogICAgLCBleHBQcm90byAgPSBleHBvcnRzW1BST1RPVFlQRV0KICAgICwgdGFyZ2V0ICAgID0gSVNfR0xPQkFMID8gZ2xvYmFsIDogSVNfU1RBVElDID8gZ2xvYmFsW25hbWVdIDogKGdsb2JhbFtuYW1lXSB8fCB7fSlbUFJPVE9UWVBFXQogICAgLCBrZXksIG93biwgb3V0OwogIGlmKElTX0dMT0JBTClzb3VyY2UgPSBuYW1lOwogIGZvcihrZXkgaW4gc291cmNlKXsKICAgIC8vIGNvbnRhaW5zIGluIG5hdGl2ZQogICAgb3duID0gIUlTX0ZPUkNFRCAmJiB0YXJnZXQgJiYgdGFyZ2V0W2tleV0gIT09IHVuZGVmaW5lZDsKICAgIGlmKG93biAmJiBrZXkgaW4gZXhwb3J0cyljb250aW51ZTsKICAgIC8vIGV4cG9ydCBuYXRpdmUgb3IgcGFzc2VkCiAgICBvdXQgPSBvd24gPyB0YXJnZXRba2V5XSA6IHNvdXJjZVtrZXldOwogICAgLy8gcHJldmVudCBnbG9iYWwgcG9sbHV0aW9uIGZvciBuYW1lc3BhY2VzCiAgICBleHBvcnRzW2tleV0gPSBJU19HTE9CQUwgJiYgdHlwZW9mIHRhcmdldFtrZXldICE9ICdmdW5jdGlvbicgPyBzb3VyY2Vba2V5XQogICAgLy8gYmluZCB0aW1lcnMgdG8gZ2xvYmFsIGZvciBjYWxsIGZyb20gZXhwb3J0IGNvbnRleHQKICAgIDogSVNfQklORCAmJiBvd24gPyBjdHgob3V0LCBnbG9iYWwpCiAgICAvLyB3cmFwIGdsb2JhbCBjb25zdHJ1Y3RvcnMgZm9yIHByZXZlbnQgY2hhbmdlIHRoZW0gaW4gbGlicmFyeQogICAgOiBJU19XUkFQICYmIHRhcmdldFtrZXldID09IG91dCA/IChmdW5jdGlvbihDKXsKICAgICAgdmFyIEYgPSBmdW5jdGlvbihhLCBiLCBjKXsKICAgICAgICBpZih0aGlzIGluc3RhbmNlb2YgQyl7CiAgICAgICAgICBzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7CiAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIG5ldyBDOwogICAgICAgICAgICBjYXNlIDE6IHJldHVybiBuZXcgQyhhKTsKICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gbmV3IEMoYSwgYik7CiAgICAgICAgICB9IHJldHVybiBuZXcgQyhhLCBiLCBjKTsKICAgICAgICB9IHJldHVybiBDLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICAgIEZbUFJPVE9UWVBFXSA9IENbUFJPVE9UWVBFXTsKICAgICAgcmV0dXJuIEY7CiAgICAvLyBtYWtlIHN0YXRpYyB2ZXJzaW9ucyBmb3IgcHJvdG90eXBlIG1ldGhvZHMKICAgIH0pKG91dCkgOiBJU19QUk9UTyAmJiB0eXBlb2Ygb3V0ID09ICdmdW5jdGlvbicgPyBjdHgoRnVuY3Rpb24uY2FsbCwgb3V0KSA6IG91dDsKICAgIC8vIGV4cG9ydCBwcm90byBtZXRob2RzIHRvIGNvcmUuJUNPTlNUUlVDVE9SJS5tZXRob2RzLiVOQU1FJQogICAgaWYoSVNfUFJPVE8pewogICAgICAoZXhwb3J0cy52aXJ0dWFsIHx8IChleHBvcnRzLnZpcnR1YWwgPSB7fSkpW2tleV0gPSBvdXQ7CiAgICAgIC8vIGV4cG9ydCBwcm90byBtZXRob2RzIHRvIGNvcmUuJUNPTlNUUlVDVE9SJS5wcm90b3R5cGUuJU5BTUUlCiAgICAgIGlmKHR5cGUgJiAkZXhwb3J0LlIgJiYgZXhwUHJvdG8gJiYgIWV4cFByb3RvW2tleV0paGlkZShleHBQcm90bywga2V5LCBvdXQpOwogICAgfQogIH0KfTsKLy8gdHlwZSBiaXRtYXAKJGV4cG9ydC5GID0gMTsgICAvLyBmb3JjZWQKJGV4cG9ydC5HID0gMjsgICAvLyBnbG9iYWwKJGV4cG9ydC5TID0gNDsgICAvLyBzdGF0aWMKJGV4cG9ydC5QID0gODsgICAvLyBwcm90bwokZXhwb3J0LkIgPSAxNjsgIC8vIGJpbmQKJGV4cG9ydC5XID0gMzI7ICAvLyB3cmFwCiRleHBvcnQuVSA9IDY0OyAgLy8gc2FmZQokZXhwb3J0LlIgPSAxMjg7IC8vIHJlYWwgcHJvdG8gbWV0aG9kIGZvciBgbGlicmFyeWAgCm1vZHVsZS5leHBvcnRzID0gJGV4cG9ydDsKCi8qKiovIH0pLAovKiA5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgewogIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsKICB9Cn07CgovKioqLyB9KSwKLyogMTAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX2RlZmluZVByb3BlcnR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNik7Cgp2YXIgX2RlZmluZVByb3BlcnR5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlZmluZVByb3BlcnR5KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07CiAgICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOwogICAgICBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsKICAgICAgKDAsIF9kZWZpbmVQcm9wZXJ0eTIuZGVmYXVsdCkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgICB9CiAgfQoKICByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKICAgIGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogICAgcmV0dXJuIENvbnN0cnVjdG9yOwogIH07Cn0oKTsKCi8qKiovIH0pLAovKiAxMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGV4ZWMpewogIHRyeSB7CiAgICByZXR1cm4gISFleGVjKCk7CiAgfSBjYXRjaChlKXsKICAgIHJldHVybiB0cnVlOwogIH0KfTsKCi8qKiovIH0pLAovKiAxMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgaGFzT3duUHJvcGVydHkgPSB7fS5oYXNPd25Qcm9wZXJ0eTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwga2V5KXsKICByZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChpdCwga2V5KTsKfTsKCi8qKiovIH0pLAovKiAxMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyB0byBpbmRleGVkIG9iamVjdCwgdG9PYmplY3Qgd2l0aCBmYWxsYmFjayBmb3Igbm9uLWFycmF5LWxpa2UgRVMzIHN0cmluZ3MKdmFyIElPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU2KQogICwgZGVmaW5lZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gSU9iamVjdChkZWZpbmVkKGl0KSk7Cn07CgovKioqLyB9KSwKLyogMTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gb3B0aW9uYWwgLyBzaW1wbGUgY29udGV4dCBiaW5kaW5nCnZhciBhRnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIwKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmbiwgdGhhdCwgbGVuZ3RoKXsKICBhRnVuY3Rpb24oZm4pOwogIGlmKHRoYXQgPT09IHVuZGVmaW5lZClyZXR1cm4gZm47CiAgc3dpdGNoKGxlbmd0aCl7CiAgICBjYXNlIDE6IHJldHVybiBmdW5jdGlvbihhKXsKICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSk7CiAgICB9OwogICAgY2FzZSAyOiByZXR1cm4gZnVuY3Rpb24oYSwgYil7CiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIpOwogICAgfTsKICAgIGNhc2UgMzogcmV0dXJuIGZ1bmN0aW9uKGEsIGIsIGMpewogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiLCBjKTsKICAgIH07CiAgfQogIHJldHVybiBmdW5jdGlvbigvKiAuLi5hcmdzICovKXsKICAgIHJldHVybiBmbi5hcHBseSh0aGF0LCBhcmd1bWVudHMpOwogIH07Cn07CgovKioqLyB9KSwKLyogMTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSB7fTsKCi8qKiovIH0pLAovKiAxNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGJpdG1hcCwgdmFsdWUpewogIHJldHVybiB7CiAgICBlbnVtZXJhYmxlICA6ICEoYml0bWFwICYgMSksCiAgICBjb25maWd1cmFibGU6ICEoYml0bWFwICYgMiksCiAgICB3cml0YWJsZSAgICA6ICEoYml0bWFwICYgNCksCiAgICB2YWx1ZSAgICAgICA6IHZhbHVlCiAgfTsKfTsKCi8qKiovIH0pLAovKiAxNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuMTQgLyAxNS4yLjMuMTQgT2JqZWN0LmtleXMoTykKdmFyICRrZXlzICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NCkKICAsIGVudW1CdWdLZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCk7Cgptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIGtleXMoTyl7CiAgcmV0dXJuICRrZXlzKE8sIGVudW1CdWdLZXlzKTsKfTsKCi8qKiovIH0pLAovKiAxOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZzsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiB0b1N0cmluZy5jYWxsKGl0KS5zbGljZSg4LCAtMSk7Cn07CgovKioqLyB9KSwKLyogMTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGlzT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KQogICwgZG9jdW1lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLmRvY3VtZW50CiAgLy8gaW4gb2xkIElFIHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFbGVtZW50IGlzICdvYmplY3QnCiAgLCBpcyA9IGlzT2JqZWN0KGRvY3VtZW50KSAmJiBpc09iamVjdChkb2N1bWVudC5jcmVhdGVFbGVtZW50KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGlzID8gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChpdCkgOiB7fTsKfTsKCi8qKiovIH0pLAovKiAyMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICBpZih0eXBlb2YgaXQgIT0gJ2Z1bmN0aW9uJyl0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhIGZ1bmN0aW9uIScpOwogIHJldHVybiBpdDsKfTsKCi8qKiovIH0pLAovKiAyMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZGVmID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mCiAgLCBoYXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQogICwgVEFHID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgndG9TdHJpbmdUYWcnKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIHRhZywgc3RhdCl7CiAgaWYoaXQgJiYgIWhhcyhpdCA9IHN0YXQgPyBpdCA6IGl0LnByb3RvdHlwZSwgVEFHKSlkZWYoaXQsIFRBRywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgdmFsdWU6IHRhZ30pOwp9OwoKLyoqKi8gfSksCi8qIDIyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDcuMS4xIFRvUHJpbWl0aXZlKGlucHV0IFssIFByZWZlcnJlZFR5cGVdKQp2YXIgaXNPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwovLyBpbnN0ZWFkIG9mIHRoZSBFUzYgc3BlYyB2ZXJzaW9uLCB3ZSBkaWRuJ3QgaW1wbGVtZW50IEBAdG9QcmltaXRpdmUgY2FzZQovLyBhbmQgdGhlIHNlY29uZCBhcmd1bWVudCAtIGZsYWcgLSBwcmVmZXJyZWQgdHlwZSBpcyBhIHN0cmluZwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBTKXsKICBpZighaXNPYmplY3QoaXQpKXJldHVybiBpdDsKICB2YXIgZm4sIHZhbDsKICBpZihTICYmIHR5cGVvZiAoZm4gPSBpdC50b1N0cmluZykgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKXJldHVybiB2YWw7CiAgaWYodHlwZW9mIChmbiA9IGl0LnZhbHVlT2YpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOwogIGlmKCFTICYmIHR5cGVvZiAoZm4gPSBpdC50b1N0cmluZykgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKXJldHVybiB2YWw7CiAgdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWUiKTsKfTsKCi8qKiovIH0pLAovKiAyMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgaWQgPSAwCiAgLCBweCA9IE1hdGgucmFuZG9tKCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsKICByZXR1cm4gJ1N5bWJvbCgnLmNvbmNhdChrZXkgPT09IHVuZGVmaW5lZCA/ICcnIDoga2V5LCAnKV8nLCAoKytpZCArIHB4KS50b1N0cmluZygzNikpOwp9OwoKLyoqKi8gfSksCi8qIDI0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIDcuMi4xIFJlcXVpcmVPYmplY3RDb2VyY2libGUoYXJndW1lbnQpCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIGlmKGl0ID09IHVuZGVmaW5lZCl0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNhbGwgbWV0aG9kIG9uICAiICsgaXQpOwogIHJldHVybiBpdDsKfTsKCi8qKiovIH0pLAovKiAyNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHRydWU7CgovKioqLyB9KSwKLyogMjYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHNoYXJlZCA9IF9fd2VicGFja19yZXF1aXJlX18oMzApKCdrZXlzJykKICAsIHVpZCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7CiAgcmV0dXJuIHNoYXJlZFtrZXldIHx8IChzaGFyZWRba2V5XSA9IHVpZChrZXkpKTsKfTsKCi8qKiovIH0pLAovKiAyNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyA3LjEuNCBUb0ludGVnZXIKdmFyIGNlaWwgID0gTWF0aC5jZWlsCiAgLCBmbG9vciA9IE1hdGguZmxvb3I7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBpc05hTihpdCA9ICtpdCkgPyAwIDogKGl0ID4gMCA/IGZsb29yIDogY2VpbCkoaXQpOwp9OwoKLyoqKi8gfSksCi8qIDI4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCi8vIElFIDgtIGRvbid0IGVudW0gYnVnIGtleXMKbW9kdWxlLmV4cG9ydHMgPSAoCiAgJ2NvbnN0cnVjdG9yLGhhc093blByb3BlcnR5LGlzUHJvdG90eXBlT2YscHJvcGVydHlJc0VudW1lcmFibGUsdG9Mb2NhbGVTdHJpbmcsdG9TdHJpbmcsdmFsdWVPZicKKS5zcGxpdCgnLCcpOwoKLyoqKi8gfSksCi8qIDI5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0gIV9fd2VicGFja19yZXF1aXJlX18oMykgJiYgIV9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KSgnZGl2JyksICdhJywge2dldDogZnVuY3Rpb24oKXsgcmV0dXJuIDc7IH19KS5hICE9IDc7Cn0pOwoKLyoqKi8gfSksCi8qIDMwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBTSEFSRUQgPSAnX19jb3JlLWpzX3NoYXJlZF9fJwogICwgc3RvcmUgID0gZ2xvYmFsW1NIQVJFRF0gfHwgKGdsb2JhbFtTSEFSRURdID0ge30pOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7CiAgcmV0dXJuIHN0b3JlW2tleV0gfHwgKHN0b3JlW2tleV0gPSB7fSk7Cn07CgovKioqLyB9KSwKLyogMzEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg3OSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiAzMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjEuMTMgVG9PYmplY3QoYXJndW1lbnQpCnZhciBkZWZpbmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpewogIHJldHVybiBPYmplY3QoZGVmaW5lZChpdCkpOwp9OwoKLyoqKi8gfSksCi8qIDMzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9zZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oNzUpOwoKdmFyIF9zZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZXRQcm90b3R5cGVPZik7Cgp2YXIgX2NyZWF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oNzQpOwoKdmFyIF9jcmVhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlKTsKCnZhciBfdHlwZW9mMiA9IF9fd2VicGFja19yZXF1aXJlX18oNTkpOwoKdmFyIF90eXBlb2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHlwZW9mMik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7CiAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIiArICh0eXBlb2Ygc3VwZXJDbGFzcyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6ICgwLCBfdHlwZW9mMy5kZWZhdWx0KShzdXBlckNsYXNzKSkpOwogIH0KCiAgc3ViQ2xhc3MucHJvdG90eXBlID0gKDAsIF9jcmVhdGUyLmRlZmF1bHQpKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsKICAgIGNvbnN0cnVjdG9yOiB7CiAgICAgIHZhbHVlOiBzdWJDbGFzcywKICAgICAgZW51bWVyYWJsZTogZmFsc2UsCiAgICAgIHdyaXRhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0KICB9KTsKICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mMi5kZWZhdWx0ID8gKDAsIF9zZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsKfTsKCi8qKiovIH0pLAovKiAzNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsKCnZhciBfdHlwZW9mMiA9IF9fd2VicGFja19yZXF1aXJlX18oNTkpOwoKdmFyIF90eXBlb2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHlwZW9mMik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKHNlbGYsIGNhbGwpIHsKICBpZiAoIXNlbGYpIHsKICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7CiAgfQoKICByZXR1cm4gY2FsbCAmJiAoKHR5cGVvZiBjYWxsID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogKDAsIF90eXBlb2YzLmRlZmF1bHQpKGNhbGwpKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpID8gY2FsbCA6IHNlbGY7Cn07CgovKioqLyB9KSwKLyogMzUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pCnZhciBhbk9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIGRQcyAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2NCkKICAsIGVudW1CdWdLZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCkKICAsIElFX1BST1RPICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNikoJ0lFX1BST1RPJykKICAsIEVtcHR5ICAgICAgID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfQogICwgUFJPVE9UWVBFICAgPSAncHJvdG90eXBlJzsKCi8vIENyZWF0ZSBvYmplY3Qgd2l0aCBmYWtlIGBudWxsYCBwcm90b3R5cGU6IHVzZSBpZnJhbWUgT2JqZWN0IHdpdGggY2xlYXJlZCBwcm90b3R5cGUKdmFyIGNyZWF0ZURpY3QgPSBmdW5jdGlvbigpewogIC8vIFRocmFzaCwgd2FzdGUgYW5kIHNvZG9teTogSUUgR0MgYnVnCiAgdmFyIGlmcmFtZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpKCdpZnJhbWUnKQogICAgLCBpICAgICAgPSBlbnVtQnVnS2V5cy5sZW5ndGgKICAgICwgbHQgICAgID0gJzwnCiAgICAsIGd0ICAgICA9ICc+JwogICAgLCBpZnJhbWVEb2N1bWVudDsKICBpZnJhbWUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICBfX3dlYnBhY2tfcmVxdWlyZV9fKDQyKS5hcHBlbmRDaGlsZChpZnJhbWUpOwogIGlmcmFtZS5zcmMgPSAnamF2YXNjcmlwdDonOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXNjcmlwdC11cmwKICAvLyBjcmVhdGVEaWN0ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuT2JqZWN0OwogIC8vIGh0bWwucmVtb3ZlQ2hpbGQoaWZyYW1lKTsKICBpZnJhbWVEb2N1bWVudCA9IGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50OwogIGlmcmFtZURvY3VtZW50Lm9wZW4oKTsKICBpZnJhbWVEb2N1bWVudC53cml0ZShsdCArICdzY3JpcHQnICsgZ3QgKyAnZG9jdW1lbnQuRj1PYmplY3QnICsgbHQgKyAnL3NjcmlwdCcgKyBndCk7CiAgaWZyYW1lRG9jdW1lbnQuY2xvc2UoKTsKICBjcmVhdGVEaWN0ID0gaWZyYW1lRG9jdW1lbnQuRjsKICB3aGlsZShpLS0pZGVsZXRlIGNyZWF0ZURpY3RbUFJPVE9UWVBFXVtlbnVtQnVnS2V5c1tpXV07CiAgcmV0dXJuIGNyZWF0ZURpY3QoKTsKfTsKCm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBjcmVhdGUoTywgUHJvcGVydGllcyl7CiAgdmFyIHJlc3VsdDsKICBpZihPICE9PSBudWxsKXsKICAgIEVtcHR5W1BST1RPVFlQRV0gPSBhbk9iamVjdChPKTsKICAgIHJlc3VsdCA9IG5ldyBFbXB0eTsKICAgIEVtcHR5W1BST1RPVFlQRV0gPSBudWxsOwogICAgLy8gYWRkICJfX3Byb3RvX18iIGZvciBPYmplY3QuZ2V0UHJvdG90eXBlT2YgcG9seWZpbGwKICAgIHJlc3VsdFtJRV9QUk9UT10gPSBPOwogIH0gZWxzZSByZXN1bHQgPSBjcmVhdGVEaWN0KCk7CiAgcmV0dXJuIFByb3BlcnRpZXMgPT09IHVuZGVmaW5lZCA/IHJlc3VsdCA6IGRQcyhyZXN1bHQsIFByb3BlcnRpZXMpOwp9OwoKCi8qKiovIH0pLAovKiAzNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDM3KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDM3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMzkpOwp2YXIgJE9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KGl0LCBrZXksIGRlc2MpewogIHJldHVybiAkT2JqZWN0LmRlZmluZVByb3BlcnR5KGl0LCBrZXksIGRlc2MpOwp9OwoKLyoqKi8gfSksCi8qIDM4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBMSUJSQVJZICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpCiAgLCAkZXhwb3J0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKICAsIHJlZGVmaW5lICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NikKICAsIGhpZGUgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KQogICwgaGFzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQogICwgSXRlcmF0b3JzICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQogICwgJGl0ZXJDcmVhdGUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYyKQogICwgc2V0VG9TdHJpbmdUYWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKQogICwgZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQzKQogICwgSVRFUkFUT1IgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpCiAgLCBCVUdHWSAgICAgICAgICA9ICEoW10ua2V5cyAmJiAnbmV4dCcgaW4gW10ua2V5cygpKSAvLyBTYWZhcmkgaGFzIGJ1Z2d5IGl0ZXJhdG9ycyB3L28gYG5leHRgCiAgLCBGRl9JVEVSQVRPUiAgICA9ICdAQGl0ZXJhdG9yJwogICwgS0VZUyAgICAgICAgICAgPSAna2V5cycKICAsIFZBTFVFUyAgICAgICAgID0gJ3ZhbHVlcyc7Cgp2YXIgcmV0dXJuVGhpcyA9IGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzOyB9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihCYXNlLCBOQU1FLCBDb25zdHJ1Y3RvciwgbmV4dCwgREVGQVVMVCwgSVNfU0VULCBGT1JDRUQpewogICRpdGVyQ3JlYXRlKENvbnN0cnVjdG9yLCBOQU1FLCBuZXh0KTsKICB2YXIgZ2V0TWV0aG9kID0gZnVuY3Rpb24oa2luZCl7CiAgICBpZighQlVHR1kgJiYga2luZCBpbiBwcm90bylyZXR1cm4gcHJvdG9ba2luZF07CiAgICBzd2l0Y2goa2luZCl7CiAgICAgIGNhc2UgS0VZUzogcmV0dXJuIGZ1bmN0aW9uIGtleXMoKXsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTsKICAgICAgY2FzZSBWQUxVRVM6IHJldHVybiBmdW5jdGlvbiB2YWx1ZXMoKXsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTsKICAgIH0gcmV0dXJuIGZ1bmN0aW9uIGVudHJpZXMoKXsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTsKICB9OwogIHZhciBUQUcgICAgICAgID0gTkFNRSArICcgSXRlcmF0b3InCiAgICAsIERFRl9WQUxVRVMgPSBERUZBVUxUID09IFZBTFVFUwogICAgLCBWQUxVRVNfQlVHID0gZmFsc2UKICAgICwgcHJvdG8gICAgICA9IEJhc2UucHJvdG90eXBlCiAgICAsICRuYXRpdmUgICAgPSBwcm90b1tJVEVSQVRPUl0gfHwgcHJvdG9bRkZfSVRFUkFUT1JdIHx8IERFRkFVTFQgJiYgcHJvdG9bREVGQVVMVF0KICAgICwgJGRlZmF1bHQgICA9ICRuYXRpdmUgfHwgZ2V0TWV0aG9kKERFRkFVTFQpCiAgICAsICRlbnRyaWVzICAgPSBERUZBVUxUID8gIURFRl9WQUxVRVMgPyAkZGVmYXVsdCA6IGdldE1ldGhvZCgnZW50cmllcycpIDogdW5kZWZpbmVkCiAgICAsICRhbnlOYXRpdmUgPSBOQU1FID09ICdBcnJheScgPyBwcm90by5lbnRyaWVzIHx8ICRuYXRpdmUgOiAkbmF0aXZlCiAgICAsIG1ldGhvZHMsIGtleSwgSXRlcmF0b3JQcm90b3R5cGU7CiAgLy8gRml4IG5hdGl2ZQogIGlmKCRhbnlOYXRpdmUpewogICAgSXRlcmF0b3JQcm90b3R5cGUgPSBnZXRQcm90b3R5cGVPZigkYW55TmF0aXZlLmNhbGwobmV3IEJhc2UpKTsKICAgIGlmKEl0ZXJhdG9yUHJvdG90eXBlICE9PSBPYmplY3QucHJvdG90eXBlKXsKICAgICAgLy8gU2V0IEBAdG9TdHJpbmdUYWcgdG8gbmF0aXZlIGl0ZXJhdG9ycwogICAgICBzZXRUb1N0cmluZ1RhZyhJdGVyYXRvclByb3RvdHlwZSwgVEFHLCB0cnVlKTsKICAgICAgLy8gZml4IGZvciBzb21lIG9sZCBlbmdpbmVzCiAgICAgIGlmKCFMSUJSQVJZICYmICFoYXMoSXRlcmF0b3JQcm90b3R5cGUsIElURVJBVE9SKSloaWRlKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUiwgcmV0dXJuVGhpcyk7CiAgICB9CiAgfQogIC8vIGZpeCBBcnJheSN7dmFsdWVzLCBAQGl0ZXJhdG9yfS5uYW1lIGluIFY4IC8gRkYKICBpZihERUZfVkFMVUVTICYmICRuYXRpdmUgJiYgJG5hdGl2ZS5uYW1lICE9PSBWQUxVRVMpewogICAgVkFMVUVTX0JVRyA9IHRydWU7CiAgICAkZGVmYXVsdCA9IGZ1bmN0aW9uIHZhbHVlcygpeyByZXR1cm4gJG5hdGl2ZS5jYWxsKHRoaXMpOyB9OwogIH0KICAvLyBEZWZpbmUgaXRlcmF0b3IKICBpZigoIUxJQlJBUlkgfHwgRk9SQ0VEKSAmJiAoQlVHR1kgfHwgVkFMVUVTX0JVRyB8fCAhcHJvdG9bSVRFUkFUT1JdKSl7CiAgICBoaWRlKHByb3RvLCBJVEVSQVRPUiwgJGRlZmF1bHQpOwogIH0KICAvLyBQbHVnIGZvciBsaWJyYXJ5CiAgSXRlcmF0b3JzW05BTUVdID0gJGRlZmF1bHQ7CiAgSXRlcmF0b3JzW1RBR10gID0gcmV0dXJuVGhpczsKICBpZihERUZBVUxUKXsKICAgIG1ldGhvZHMgPSB7CiAgICAgIHZhbHVlczogIERFRl9WQUxVRVMgPyAkZGVmYXVsdCA6IGdldE1ldGhvZChWQUxVRVMpLAogICAgICBrZXlzOiAgICBJU19TRVQgICAgID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoS0VZUyksCiAgICAgIGVudHJpZXM6ICRlbnRyaWVzCiAgICB9OwogICAgaWYoRk9SQ0VEKWZvcihrZXkgaW4gbWV0aG9kcyl7CiAgICAgIGlmKCEoa2V5IGluIHByb3RvKSlyZWRlZmluZShwcm90bywga2V5LCBtZXRob2RzW2tleV0pOwogICAgfSBlbHNlICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKEJVR0dZIHx8IFZBTFVFU19CVUcpLCBOQU1FLCBtZXRob2RzKTsKICB9CiAgcmV0dXJuIG1ldGhvZHM7Cn07CgovKioqLyB9KSwKLyogMzkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyICRleHBvcnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwovLyAxOS4xLjIuNCAvIDE1LjIuMy42IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFfX3dlYnBhY2tfcmVxdWlyZV9fKDMpLCAnT2JqZWN0Jywge2RlZmluZVByb3BlcnR5OiBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmZ9KTsKCi8qKiovIH0pLAovKiA0MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDUzKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDQxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCmV4cG9ydHMuZiA9IHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlOwoKLyoqKi8gfSksCi8qIDQyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5kb2N1bWVudCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CgovKioqLyB9KSwKLyogNDMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjkgLyAxNS4yLjMuMiBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTykKdmFyIGhhcyAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIHRvT2JqZWN0ICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMikKICAsIElFX1BST1RPICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNikoJ0lFX1BST1RPJykKICAsIE9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTsKCm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmdldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uKE8pewogIE8gPSB0b09iamVjdChPKTsKICBpZihoYXMoTywgSUVfUFJPVE8pKXJldHVybiBPW0lFX1BST1RPXTsKICBpZih0eXBlb2YgTy5jb25zdHJ1Y3RvciA9PSAnZnVuY3Rpb24nICYmIE8gaW5zdGFuY2VvZiBPLmNvbnN0cnVjdG9yKXsKICAgIHJldHVybiBPLmNvbnN0cnVjdG9yLnByb3RvdHlwZTsKICB9IHJldHVybiBPIGluc3RhbmNlb2YgT2JqZWN0ID8gT2JqZWN0UHJvdG8gOiBudWxsOwp9OwoKLyoqKi8gfSksCi8qIDQ0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBoYXMgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQogICwgdG9JT2JqZWN0ICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMykKICAsIGFycmF5SW5kZXhPZiA9IF9fd2VicGFja19yZXF1aXJlX18oNjEpKGZhbHNlKQogICwgSUVfUFJPVE8gICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNikoJ0lFX1BST1RPJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgbmFtZXMpewogIHZhciBPICAgICAgPSB0b0lPYmplY3Qob2JqZWN0KQogICAgLCBpICAgICAgPSAwCiAgICAsIHJlc3VsdCA9IFtdCiAgICAsIGtleTsKICBmb3Ioa2V5IGluIE8paWYoa2V5ICE9IElFX1BST1RPKWhhcyhPLCBrZXkpICYmIHJlc3VsdC5wdXNoKGtleSk7CiAgLy8gRG9uJ3QgZW51bSBidWcgJiBoaWRkZW4ga2V5cwogIHdoaWxlKG5hbWVzLmxlbmd0aCA+IGkpaWYoaGFzKE8sIGtleSA9IG5hbWVzW2krK10pKXsKICAgIH5hcnJheUluZGV4T2YocmVzdWx0LCBrZXkpIHx8IHJlc3VsdC5wdXNoKGtleSk7CiAgfQogIHJldHVybiByZXN1bHQ7Cn07CgovKioqLyB9KSwKLyogNDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gbW9zdCBPYmplY3QgbWV0aG9kcyBieSBFUzYgc2hvdWxkIGFjY2VwdCBwcmltaXRpdmVzCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KQogICwgY29yZSAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMCkKICAsIGZhaWxzICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihLRVksIGV4ZWMpewogIHZhciBmbiAgPSAoY29yZS5PYmplY3QgfHwge30pW0tFWV0gfHwgT2JqZWN0W0tFWV0KICAgICwgZXhwID0ge307CiAgZXhwW0tFWV0gPSBleGVjKGZuKTsKICAkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIGZhaWxzKGZ1bmN0aW9uKCl7IGZuKDEpOyB9KSwgJ09iamVjdCcsIGV4cCk7Cn07CgovKioqLyB9KSwKLyogNDYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpOwoKLyoqKi8gfSksCi8qIDQ3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDcuMS4xNSBUb0xlbmd0aAp2YXIgdG9JbnRlZ2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNykKICAsIG1pbiAgICAgICA9IE1hdGgubWluOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXQgPiAwID8gbWluKHRvSW50ZWdlcihpdCksIDB4MWZmZmZmZmZmZmZmZmYpIDogMDsgLy8gcG93KDIsIDUzKSAtIDEgPT0gOTAwNzE5OTI1NDc0MDk5MQp9OwoKLyoqKi8gfSksCi8qIDQ4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGNvcmUgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQogICwgTElCUkFSWSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KQogICwgd2tzRXh0ICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KQogICwgZGVmaW5lUHJvcGVydHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpLmY7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obmFtZSl7CiAgdmFyICRTeW1ib2wgPSBjb3JlLlN5bWJvbCB8fCAoY29yZS5TeW1ib2wgPSBMSUJSQVJZID8ge30gOiBnbG9iYWwuU3ltYm9sIHx8IHt9KTsKICBpZihuYW1lLmNoYXJBdCgwKSAhPSAnXycgJiYgIShuYW1lIGluICRTeW1ib2wpKWRlZmluZVByb3BlcnR5KCRTeW1ib2wsIG5hbWUsIHt2YWx1ZTogd2tzRXh0LmYobmFtZSl9KTsKfTsKCi8qKiovIH0pLAovKiA0OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpleHBvcnRzLmYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpOwoKLyoqKi8gfSksCi8qIDUwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciAkYXQgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2NikodHJ1ZSk7CgovLyAyMS4xLjMuMjcgU3RyaW5nLnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpCl9fd2VicGFja19yZXF1aXJlX18oMzgpKFN0cmluZywgJ1N0cmluZycsIGZ1bmN0aW9uKGl0ZXJhdGVkKXsKICB0aGlzLl90ID0gU3RyaW5nKGl0ZXJhdGVkKTsgLy8gdGFyZ2V0CiAgdGhpcy5faSA9IDA7ICAgICAgICAgICAgICAgIC8vIG5leHQgaW5kZXgKLy8gMjEuMS41LjIuMSAlU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUlLm5leHQoKQp9LCBmdW5jdGlvbigpewogIHZhciBPICAgICA9IHRoaXMuX3QKICAgICwgaW5kZXggPSB0aGlzLl9pCiAgICAsIHBvaW50OwogIGlmKGluZGV4ID49IE8ubGVuZ3RoKXJldHVybiB7dmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZX07CiAgcG9pbnQgPSAkYXQoTywgaW5kZXgpOwogIHRoaXMuX2kgKz0gcG9pbnQubGVuZ3RoOwogIHJldHVybiB7dmFsdWU6IHBvaW50LCBkb25lOiBmYWxzZX07Cn0pOwoKLyoqKi8gfSksCi8qIDUxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNjkpOwp2YXIgZ2xvYmFsICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGhpZGUgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpCiAgLCBJdGVyYXRvcnMgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSkKICAsIFRPX1NUUklOR19UQUcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCd0b1N0cmluZ1RhZycpOwoKZm9yKHZhciBjb2xsZWN0aW9ucyA9IFsnTm9kZUxpc3QnLCAnRE9NVG9rZW5MaXN0JywgJ01lZGlhTGlzdCcsICdTdHlsZVNoZWV0TGlzdCcsICdDU1NSdWxlTGlzdCddLCBpID0gMDsgaSA8IDU7IGkrKyl7CiAgdmFyIE5BTUUgICAgICAgPSBjb2xsZWN0aW9uc1tpXQogICAgLCBDb2xsZWN0aW9uID0gZ2xvYmFsW05BTUVdCiAgICAsIHByb3RvICAgICAgPSBDb2xsZWN0aW9uICYmIENvbGxlY3Rpb24ucHJvdG90eXBlOwogIGlmKHByb3RvICYmICFwcm90b1tUT19TVFJJTkdfVEFHXSloaWRlKHByb3RvLCBUT19TVFJJTkdfVEFHLCBOQU1FKTsKICBJdGVyYXRvcnNbTkFNRV0gPSBJdGVyYXRvcnMuQXJyYXk7Cn0KCi8qKiovIH0pLAovKiA1MiAqLywKLyogNTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGNvcmUgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQogICwgJEpTT04gPSBjb3JlLkpTT04gfHwgKGNvcmUuSlNPTiA9IHtzdHJpbmdpZnk6IEpTT04uc3RyaW5naWZ5fSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gc3RyaW5naWZ5KGl0KXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycwogIHJldHVybiAkSlNPTi5zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3VtZW50cyk7Cn07CgovKioqLyB9KSwKLyogNTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKCgovKioqLyB9KSwKLyogNTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZ2V0dGluZyB0YWcgZnJvbSAxOS4xLjMuNiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nKCkKdmFyIGNvZiA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpCiAgLCBUQUcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCd0b1N0cmluZ1RhZycpCiAgLy8gRVMzIHdyb25nIGhlcmUKICAsIEFSRyA9IGNvZihmdW5jdGlvbigpeyByZXR1cm4gYXJndW1lbnRzOyB9KCkpID09ICdBcmd1bWVudHMnOwoKLy8gZmFsbGJhY2sgZm9yIElFMTEgU2NyaXB0IEFjY2VzcyBEZW5pZWQgZXJyb3IKdmFyIHRyeUdldCA9IGZ1bmN0aW9uKGl0LCBrZXkpewogIHRyeSB7CiAgICByZXR1cm4gaXRba2V5XTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9Cn07Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICB2YXIgTywgVCwgQjsKICByZXR1cm4gaXQgPT09IHVuZGVmaW5lZCA/ICdVbmRlZmluZWQnIDogaXQgPT09IG51bGwgPyAnTnVsbCcKICAgIC8vIEBAdG9TdHJpbmdUYWcgY2FzZQogICAgOiB0eXBlb2YgKFQgPSB0cnlHZXQoTyA9IE9iamVjdChpdCksIFRBRykpID09ICdzdHJpbmcnID8gVAogICAgLy8gYnVpbHRpblRhZyBjYXNlCiAgICA6IEFSRyA/IGNvZihPKQogICAgLy8gRVMzIGFyZ3VtZW50cyBmYWxsYmFjawogICAgOiAoQiA9IGNvZihPKSkgPT0gJ09iamVjdCcgJiYgdHlwZW9mIE8uY2FsbGVlID09ICdmdW5jdGlvbicgPyAnQXJndW1lbnRzJyA6IEI7Cn07CgovKioqLyB9KSwKLyogNTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBhbmQgbm9uLWVudW1lcmFibGUgb2xkIFY4IHN0cmluZ3MKdmFyIGNvZiA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpOwptb2R1bGUuZXhwb3J0cyA9IE9iamVjdCgneicpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApID8gT2JqZWN0IDogZnVuY3Rpb24oaXQpewogIHJldHVybiBjb2YoaXQpID09ICdTdHJpbmcnID8gaXQuc3BsaXQoJycpIDogT2JqZWN0KGl0KTsKfTsKCi8qKiovIH0pLAovKiA1NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgcElFICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQxKQogICwgY3JlYXRlRGVzYyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQogICwgdG9JT2JqZWN0ICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQogICwgdG9QcmltaXRpdmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKQogICwgaGFzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQogICwgSUU4X0RPTV9ERUZJTkUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KQogICwgZ09QRCAgICAgICAgICAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwoKZXhwb3J0cy5mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSA/IGdPUEQgOiBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCl7CiAgTyA9IHRvSU9iamVjdChPKTsKICBQID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSk7CiAgaWYoSUU4X0RPTV9ERUZJTkUpdHJ5IHsKICAgIHJldHVybiBnT1BEKE8sIFApOwogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0KICBpZihoYXMoTywgUCkpcmV0dXJuIGNyZWF0ZURlc2MoIXBJRS5mLmNhbGwoTywgUCksIE9bUF0pOwp9OwoKLyoqKi8gfSksCi8qIDU4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCmV4cG9ydHMuZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7CgovKioqLyB9KSwKLyogNTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7Cgp2YXIgX2l0ZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3Nyk7Cgp2YXIgX2l0ZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2l0ZXJhdG9yKTsKCnZhciBfc3ltYm9sID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3Nik7Cgp2YXIgX3N5bWJvbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zeW1ib2wpOwoKdmFyIF90eXBlb2YgPSB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgX2l0ZXJhdG9yMi5kZWZhdWx0ID09PSAic3ltYm9sIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBfc3ltYm9sMi5kZWZhdWx0ICYmIG9iaiAhPT0gX3N5bWJvbDIuZGVmYXVsdC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5kZWZhdWx0ID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09ICJmdW5jdGlvbiIgJiYgX3R5cGVvZihfaXRlcmF0b3IyLmRlZmF1bHQpID09PSAic3ltYm9sIiA/IGZ1bmN0aW9uIChvYmopIHsKICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yob2JqKTsKfSA6IGZ1bmN0aW9uIChvYmopIHsKICByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihvYmopOwp9OwoKLyoqKi8gfSksCi8qIDYwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfTsKCi8qKiovIH0pLAovKiA2MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBmYWxzZSAtPiBBcnJheSNpbmRleE9mCi8vIHRydWUgIC0+IEFycmF5I2luY2x1ZGVzCnZhciB0b0lPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQogICwgdG9MZW5ndGggID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NykKICAsIHRvSW5kZXggICA9IF9fd2VicGFja19yZXF1aXJlX18oNjgpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKElTX0lOQ0xVREVTKXsKICByZXR1cm4gZnVuY3Rpb24oJHRoaXMsIGVsLCBmcm9tSW5kZXgpewogICAgdmFyIE8gICAgICA9IHRvSU9iamVjdCgkdGhpcykKICAgICAgLCBsZW5ndGggPSB0b0xlbmd0aChPLmxlbmd0aCkKICAgICAgLCBpbmRleCAgPSB0b0luZGV4KGZyb21JbmRleCwgbGVuZ3RoKQogICAgICAsIHZhbHVlOwogICAgLy8gQXJyYXkjaW5jbHVkZXMgdXNlcyBTYW1lVmFsdWVaZXJvIGVxdWFsaXR5IGFsZ29yaXRobQogICAgaWYoSVNfSU5DTFVERVMgJiYgZWwgIT0gZWwpd2hpbGUobGVuZ3RoID4gaW5kZXgpewogICAgICB2YWx1ZSA9IE9baW5kZXgrK107CiAgICAgIGlmKHZhbHVlICE9IHZhbHVlKXJldHVybiB0cnVlOwogICAgLy8gQXJyYXkjdG9JbmRleCBpZ25vcmVzIGhvbGVzLCBBcnJheSNpbmNsdWRlcyAtIG5vdAogICAgfSBlbHNlIGZvcig7bGVuZ3RoID4gaW5kZXg7IGluZGV4KyspaWYoSVNfSU5DTFVERVMgfHwgaW5kZXggaW4gTyl7CiAgICAgIGlmKE9baW5kZXhdID09PSBlbClyZXR1cm4gSVNfSU5DTFVERVMgfHwgaW5kZXggfHwgMDsKICAgIH0gcmV0dXJuICFJU19JTkNMVURFUyAmJiAtMTsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDYyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBjcmVhdGUgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpCiAgLCBkZXNjcmlwdG9yICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpCiAgLCBzZXRUb1N0cmluZ1RhZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpCiAgLCBJdGVyYXRvclByb3RvdHlwZSA9IHt9OwoKLy8gMjUuMS4yLjEuMSAlSXRlcmF0b3JQcm90b3R5cGUlW0BAaXRlcmF0b3JdKCkKX193ZWJwYWNrX3JlcXVpcmVfXyg2KShJdGVyYXRvclByb3RvdHlwZSwgX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKSwgZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH0pOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCl7CiAgQ29uc3RydWN0b3IucHJvdG90eXBlID0gY3JlYXRlKEl0ZXJhdG9yUHJvdG90eXBlLCB7bmV4dDogZGVzY3JpcHRvcigxLCBuZXh0KX0pOwogIHNldFRvU3RyaW5nVGFnKENvbnN0cnVjdG9yLCBOQU1FICsgJyBJdGVyYXRvcicpOwp9OwoKLyoqKi8gfSksCi8qIDYzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZG9uZSwgdmFsdWUpewogIHJldHVybiB7dmFsdWU6IHZhbHVlLCBkb25lOiAhIWRvbmV9Owp9OwoKLyoqKi8gfSksCi8qIDY0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBkUCAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNCkKICAsIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQogICwgZ2V0S2V5cyAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKCm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzIDogZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKXsKICBhbk9iamVjdChPKTsKICB2YXIga2V5cyAgID0gZ2V0S2V5cyhQcm9wZXJ0aWVzKQogICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aAogICAgLCBpID0gMAogICAgLCBQOwogIHdoaWxlKGxlbmd0aCA+IGkpZFAuZihPLCBQID0ga2V5c1tpKytdLCBQcm9wZXJ0aWVzW1BdKTsKICByZXR1cm4gTzsKfTsKCi8qKiovIH0pLAovKiA2NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuNyAvIDE1LjIuMy40IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKE8pCnZhciAka2V5cyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NCkKICAsIGhpZGRlbktleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KS5jb25jYXQoJ2xlbmd0aCcsICdwcm90b3R5cGUnKTsKCmV4cG9ydHMuZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHx8IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoTyl7CiAgcmV0dXJuICRrZXlzKE8sIGhpZGRlbktleXMpOwp9OwoKLyoqKi8gfSksCi8qIDY2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciB0b0ludGVnZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KQogICwgZGVmaW5lZCAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7Ci8vIHRydWUgIC0+IFN0cmluZyNhdAovLyBmYWxzZSAtPiBTdHJpbmcjY29kZVBvaW50QXQKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihUT19TVFJJTkcpewogIHJldHVybiBmdW5jdGlvbih0aGF0LCBwb3MpewogICAgdmFyIHMgPSBTdHJpbmcoZGVmaW5lZCh0aGF0KSkKICAgICAgLCBpID0gdG9JbnRlZ2VyKHBvcykKICAgICAgLCBsID0gcy5sZW5ndGgKICAgICAgLCBhLCBiOwogICAgaWYoaSA8IDAgfHwgaSA+PSBsKXJldHVybiBUT19TVFJJTkcgPyAnJyA6IHVuZGVmaW5lZDsKICAgIGEgPSBzLmNoYXJDb2RlQXQoaSk7CiAgICByZXR1cm4gYSA8IDB4ZDgwMCB8fCBhID4gMHhkYmZmIHx8IGkgKyAxID09PSBsIHx8IChiID0gcy5jaGFyQ29kZUF0KGkgKyAxKSkgPCAweGRjMDAgfHwgYiA+IDB4ZGZmZgogICAgICA/IFRPX1NUUklORyA/IHMuY2hhckF0KGkpIDogYQogICAgICA6IFRPX1NUUklORyA/IHMuc2xpY2UoaSwgaSArIDIpIDogKGEgLSAweGQ4MDAgPDwgMTApICsgKGIgLSAweGRjMDApICsgMHgxMDAwMDsKICB9Owp9OwoKLyoqKi8gfSksCi8qIDY3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjdHggICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgaW52b2tlICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4OCkKICAsIGh0bWwgICAgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNDIpCiAgLCBjZWwgICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KQogICwgZ2xvYmFsICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MKICAsIHNldFRhc2sgICAgICAgICAgICA9IGdsb2JhbC5zZXRJbW1lZGlhdGUKICAsIGNsZWFyVGFzayAgICAgICAgICA9IGdsb2JhbC5jbGVhckltbWVkaWF0ZQogICwgTWVzc2FnZUNoYW5uZWwgICAgID0gZ2xvYmFsLk1lc3NhZ2VDaGFubmVsCiAgLCBjb3VudGVyICAgICAgICAgICAgPSAwCiAgLCBxdWV1ZSAgICAgICAgICAgICAgPSB7fQogICwgT05SRUFEWVNUQVRFQ0hBTkdFID0gJ29ucmVhZHlzdGF0ZWNoYW5nZScKICAsIGRlZmVyLCBjaGFubmVsLCBwb3J0Owp2YXIgcnVuID0gZnVuY3Rpb24oKXsKICB2YXIgaWQgPSArdGhpczsKICBpZihxdWV1ZS5oYXNPd25Qcm9wZXJ0eShpZCkpewogICAgdmFyIGZuID0gcXVldWVbaWRdOwogICAgZGVsZXRlIHF1ZXVlW2lkXTsKICAgIGZuKCk7CiAgfQp9Owp2YXIgbGlzdGVuZXIgPSBmdW5jdGlvbihldmVudCl7CiAgcnVuLmNhbGwoZXZlbnQuZGF0YSk7Cn07Ci8vIE5vZGUuanMgMC45KyAmIElFMTArIGhhcyBzZXRJbW1lZGlhdGUsIG90aGVyd2lzZToKaWYoIXNldFRhc2sgfHwgIWNsZWFyVGFzayl7CiAgc2V0VGFzayA9IGZ1bmN0aW9uIHNldEltbWVkaWF0ZShmbil7CiAgICB2YXIgYXJncyA9IFtdLCBpID0gMTsKICAgIHdoaWxlKGFyZ3VtZW50cy5sZW5ndGggPiBpKWFyZ3MucHVzaChhcmd1bWVudHNbaSsrXSk7CiAgICBxdWV1ZVsrK2NvdW50ZXJdID0gZnVuY3Rpb24oKXsKICAgICAgaW52b2tlKHR5cGVvZiBmbiA9PSAnZnVuY3Rpb24nID8gZm4gOiBGdW5jdGlvbihmbiksIGFyZ3MpOwogICAgfTsKICAgIGRlZmVyKGNvdW50ZXIpOwogICAgcmV0dXJuIGNvdW50ZXI7CiAgfTsKICBjbGVhclRhc2sgPSBmdW5jdGlvbiBjbGVhckltbWVkaWF0ZShpZCl7CiAgICBkZWxldGUgcXVldWVbaWRdOwogIH07CiAgLy8gTm9kZS5qcyAwLjgtCiAgaWYoX193ZWJwYWNrX3JlcXVpcmVfXygxOCkocHJvY2VzcykgPT0gJ3Byb2Nlc3MnKXsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBwcm9jZXNzLm5leHRUaWNrKGN0eChydW4sIGlkLCAxKSk7CiAgICB9OwogIC8vIEJyb3dzZXJzIHdpdGggTWVzc2FnZUNoYW5uZWwsIGluY2x1ZGVzIFdlYldvcmtlcnMKICB9IGVsc2UgaWYoTWVzc2FnZUNoYW5uZWwpewogICAgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbDsKICAgIHBvcnQgICAgPSBjaGFubmVsLnBvcnQyOwogICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBsaXN0ZW5lcjsKICAgIGRlZmVyID0gY3R4KHBvcnQucG9zdE1lc3NhZ2UsIHBvcnQsIDEpOwogIC8vIEJyb3dzZXJzIHdpdGggcG9zdE1lc3NhZ2UsIHNraXAgV2ViV29ya2VycwogIC8vIElFOCBoYXMgcG9zdE1lc3NhZ2UsIGJ1dCBpdCdzIHN5bmMgJiB0eXBlb2YgaXRzIHBvc3RNZXNzYWdlIGlzICdvYmplY3QnCiAgfSBlbHNlIGlmKGdsb2JhbC5hZGRFdmVudExpc3RlbmVyICYmIHR5cGVvZiBwb3N0TWVzc2FnZSA9PSAnZnVuY3Rpb24nICYmICFnbG9iYWwuaW1wb3J0U2NyaXB0cyl7CiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsKICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKGlkICsgJycsICcqJyk7CiAgICB9OwogICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBsaXN0ZW5lciwgZmFsc2UpOwogIC8vIElFOC0KICB9IGVsc2UgaWYoT05SRUFEWVNUQVRFQ0hBTkdFIGluIGNlbCgnc2NyaXB0JykpewogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7CiAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoY2VsKCdzY3JpcHQnKSlbT05SRUFEWVNUQVRFQ0hBTkdFXSA9IGZ1bmN0aW9uKCl7CiAgICAgICAgaHRtbC5yZW1vdmVDaGlsZCh0aGlzKTsKICAgICAgICBydW4uY2FsbChpZCk7CiAgICAgIH07CiAgICB9OwogIC8vIFJlc3Qgb2xkIGJyb3dzZXJzCiAgfSBlbHNlIHsKICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpewogICAgICBzZXRUaW1lb3V0KGN0eChydW4sIGlkLCAxKSwgMCk7CiAgICB9OwogIH0KfQptb2R1bGUuZXhwb3J0cyA9IHsKICBzZXQ6ICAgc2V0VGFzaywKICBjbGVhcjogY2xlYXJUYXNrCn07CgovKioqLyB9KSwKLyogNjggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIHRvSW50ZWdlciA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpCiAgLCBtYXggICAgICAgPSBNYXRoLm1heAogICwgbWluICAgICAgID0gTWF0aC5taW47Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaW5kZXgsIGxlbmd0aCl7CiAgaW5kZXggPSB0b0ludGVnZXIoaW5kZXgpOwogIHJldHVybiBpbmRleCA8IDAgPyBtYXgoaW5kZXggKyBsZW5ndGgsIDApIDogbWluKGluZGV4LCBsZW5ndGgpOwp9OwoKLyoqKi8gfSksCi8qIDY5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBhZGRUb1Vuc2NvcGFibGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MCkKICAsIHN0ZXAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYzKQogICwgSXRlcmF0b3JzICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpCiAgLCB0b0lPYmplY3QgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyk7CgovLyAyMi4xLjMuNCBBcnJheS5wcm90b3R5cGUuZW50cmllcygpCi8vIDIyLjEuMy4xMyBBcnJheS5wcm90b3R5cGUua2V5cygpCi8vIDIyLjEuMy4yOSBBcnJheS5wcm90b3R5cGUudmFsdWVzKCkKLy8gMjIuMS4zLjMwIEFycmF5LnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpCm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygzOCkoQXJyYXksICdBcnJheScsIGZ1bmN0aW9uKGl0ZXJhdGVkLCBraW5kKXsKICB0aGlzLl90ID0gdG9JT2JqZWN0KGl0ZXJhdGVkKTsgLy8gdGFyZ2V0CiAgdGhpcy5faSA9IDA7ICAgICAgICAgICAgICAgICAgIC8vIG5leHQgaW5kZXgKICB0aGlzLl9rID0ga2luZDsgICAgICAgICAgICAgICAgLy8ga2luZAovLyAyMi4xLjUuMi4xICVBcnJheUl0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkKfSwgZnVuY3Rpb24oKXsKICB2YXIgTyAgICAgPSB0aGlzLl90CiAgICAsIGtpbmQgID0gdGhpcy5fawogICAgLCBpbmRleCA9IHRoaXMuX2krKzsKICBpZighTyB8fCBpbmRleCA+PSBPLmxlbmd0aCl7CiAgICB0aGlzLl90ID0gdW5kZWZpbmVkOwogICAgcmV0dXJuIHN0ZXAoMSk7CiAgfQogIGlmKGtpbmQgPT0gJ2tleXMnICApcmV0dXJuIHN0ZXAoMCwgaW5kZXgpOwogIGlmKGtpbmQgPT0gJ3ZhbHVlcycpcmV0dXJuIHN0ZXAoMCwgT1tpbmRleF0pOwogIHJldHVybiBzdGVwKDAsIFtpbmRleCwgT1tpbmRleF1dKTsKfSwgJ3ZhbHVlcycpOwoKLy8gYXJndW1lbnRzTGlzdFtAQGl0ZXJhdG9yXSBpcyAlQXJyYXlQcm90b192YWx1ZXMlICg5LjQuNC42LCA5LjQuNC43KQpJdGVyYXRvcnMuQXJndW1lbnRzID0gSXRlcmF0b3JzLkFycmF5OwoKYWRkVG9VbnNjb3BhYmxlcygna2V5cycpOwphZGRUb1Vuc2NvcGFibGVzKCd2YWx1ZXMnKTsKYWRkVG9VbnNjb3BhYmxlcygnZW50cmllcycpOwoKLyoqKi8gfSksCi8qIDcwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODApLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MiksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgTUVUQSAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKSgnbWV0YScpCiAgLCBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIGhhcyAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMikKICAsIHNldERlc2MgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS5mCiAgLCBpZCAgICAgICA9IDA7CnZhciBpc0V4dGVuc2libGUgPSBPYmplY3QuaXNFeHRlbnNpYmxlIHx8IGZ1bmN0aW9uKCl7CiAgcmV0dXJuIHRydWU7Cn07CnZhciBGUkVFWkUgPSAhX193ZWJwYWNrX3JlcXVpcmVfXygxMSkoZnVuY3Rpb24oKXsKICByZXR1cm4gaXNFeHRlbnNpYmxlKE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpOwp9KTsKdmFyIHNldE1ldGEgPSBmdW5jdGlvbihpdCl7CiAgc2V0RGVzYyhpdCwgTUVUQSwge3ZhbHVlOiB7CiAgICBpOiAnTycgKyArK2lkLCAvLyBvYmplY3QgSUQKICAgIHc6IHt9ICAgICAgICAgIC8vIHdlYWsgY29sbGVjdGlvbnMgSURzCiAgfX0pOwp9Owp2YXIgZmFzdEtleSA9IGZ1bmN0aW9uKGl0LCBjcmVhdGUpewogIC8vIHJldHVybiBwcmltaXRpdmUgd2l0aCBwcmVmaXgKICBpZighaXNPYmplY3QoaXQpKXJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCcgPyBpdCA6ICh0eXBlb2YgaXQgPT0gJ3N0cmluZycgPyAnUycgOiAnUCcpICsgaXQ7CiAgaWYoIWhhcyhpdCwgTUVUQSkpewogICAgLy8gY2FuJ3Qgc2V0IG1ldGFkYXRhIHRvIHVuY2F1Z2h0IGZyb3plbiBvYmplY3QKICAgIGlmKCFpc0V4dGVuc2libGUoaXQpKXJldHVybiAnRic7CiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YQogICAgaWYoIWNyZWF0ZSlyZXR1cm4gJ0UnOwogICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGEKICAgIHNldE1ldGEoaXQpOwogIC8vIHJldHVybiBvYmplY3QgSUQKICB9IHJldHVybiBpdFtNRVRBXS5pOwp9Owp2YXIgZ2V0V2VhayA9IGZ1bmN0aW9uKGl0LCBjcmVhdGUpewogIGlmKCFoYXMoaXQsIE1FVEEpKXsKICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0CiAgICBpZighaXNFeHRlbnNpYmxlKGl0KSlyZXR1cm4gdHJ1ZTsKICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhCiAgICBpZighY3JlYXRlKXJldHVybiBmYWxzZTsKICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhCiAgICBzZXRNZXRhKGl0KTsKICAvLyByZXR1cm4gaGFzaCB3ZWFrIGNvbGxlY3Rpb25zIElEcwogIH0gcmV0dXJuIGl0W01FVEFdLnc7Cn07Ci8vIGFkZCBtZXRhZGF0YSBvbiBmcmVlemUtZmFtaWx5IG1ldGhvZHMgY2FsbGluZwp2YXIgb25GcmVlemUgPSBmdW5jdGlvbihpdCl7CiAgaWYoRlJFRVpFICYmIG1ldGEuTkVFRCAmJiBpc0V4dGVuc2libGUoaXQpICYmICFoYXMoaXQsIE1FVEEpKXNldE1ldGEoaXQpOwogIHJldHVybiBpdDsKfTsKdmFyIG1ldGEgPSBtb2R1bGUuZXhwb3J0cyA9IHsKICBLRVk6ICAgICAgTUVUQSwKICBORUVEOiAgICAgZmFsc2UsCiAgZmFzdEtleTogIGZhc3RLZXksCiAgZ2V0V2VhazogIGdldFdlYWssCiAgb25GcmVlemU6IG9uRnJlZXplCn07CgovKioqLyB9KSwKLyogNzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKdmFyIGNsYXNzb2YgICA9IF9fd2VicGFja19yZXF1aXJlX18oNTUpCiAgLCBJVEVSQVRPUiAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdpdGVyYXRvcicpCiAgLCBJdGVyYXRvcnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLmdldEl0ZXJhdG9yTWV0aG9kID0gZnVuY3Rpb24oaXQpewogIGlmKGl0ICE9IHVuZGVmaW5lZClyZXR1cm4gaXRbSVRFUkFUT1JdCiAgICB8fCBpdFsnQEBpdGVyYXRvciddCiAgICB8fCBJdGVyYXRvcnNbY2xhc3NvZihpdCldOwp9OwoKLyoqKi8gfSksCi8qIDc0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oNzgpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKbW9kdWxlLmV4cG9ydHMgPSB7ICJkZWZhdWx0IjogX193ZWJwYWNrX3JlcXVpcmVfXyg4MSksIF9fZXNNb2R1bGU6IHRydWUgfTsKCi8qKiovIH0pLAovKiA3NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsgImRlZmF1bHQiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDgzKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDc3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oODQpLCBfX2VzTW9kdWxlOiB0cnVlIH07CgovKioqLyB9KSwKLyogNzggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygxMDApOwp2YXIgJE9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNyZWF0ZShQLCBEKXsKICByZXR1cm4gJE9iamVjdC5jcmVhdGUoUCwgRCk7Cn07CgovKioqLyB9KSwKLyogNzkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygxMDEpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0LmdldFByb3RvdHlwZU9mOwoKLyoqKi8gfSksCi8qIDgwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAyKTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5rZXlzOwoKLyoqKi8gfSksCi8qIDgxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTAzKTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5zZXRQcm90b3R5cGVPZjsKCi8qKiovIH0pLAovKiA4MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDU0KTsKX193ZWJwYWNrX3JlcXVpcmVfXyg1MCk7Cl9fd2VicGFja19yZXF1aXJlX18oNTEpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDEwNCk7Cm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKS5Qcm9taXNlOwoKLyoqKi8gfSksCi8qIDgzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTA1KTsKX193ZWJwYWNrX3JlcXVpcmVfXyg1NCk7Cl9fd2VicGFja19yZXF1aXJlX18oMTA2KTsKX193ZWJwYWNrX3JlcXVpcmVfXygxMDcpOwptb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuU3ltYm9sOwoKLyoqKi8gfSksCi8qIDg0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oNTApOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ5KS5mKCdpdGVyYXRvcicpOwoKLyoqKi8gfSksCi8qIDg1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIENvbnN0cnVjdG9yLCBuYW1lLCBmb3JiaWRkZW5GaWVsZCl7CiAgaWYoIShpdCBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSB8fCAoZm9yYmlkZGVuRmllbGQgIT09IHVuZGVmaW5lZCAmJiBmb3JiaWRkZW5GaWVsZCBpbiBpdCkpewogICAgdGhyb3cgVHlwZUVycm9yKG5hbWUgKyAnOiBpbmNvcnJlY3QgaW52b2NhdGlvbiEnKTsKICB9IHJldHVybiBpdDsKfTsKCi8qKiovIH0pLAovKiA4NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBhbGwgZW51bWVyYWJsZSBvYmplY3Qga2V5cywgaW5jbHVkZXMgc3ltYm9scwp2YXIgZ2V0S2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpCiAgLCBnT1BTICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OCkKICAsIHBJRSAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQxKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7CiAgdmFyIHJlc3VsdCAgICAgPSBnZXRLZXlzKGl0KQogICAgLCBnZXRTeW1ib2xzID0gZ09QUy5mOwogIGlmKGdldFN5bWJvbHMpewogICAgdmFyIHN5bWJvbHMgPSBnZXRTeW1ib2xzKGl0KQogICAgICAsIGlzRW51bSAgPSBwSUUuZgogICAgICAsIGkgICAgICAgPSAwCiAgICAgICwga2V5OwogICAgd2hpbGUoc3ltYm9scy5sZW5ndGggPiBpKWlmKGlzRW51bS5jYWxsKGl0LCBrZXkgPSBzeW1ib2xzW2krK10pKXJlc3VsdC5wdXNoKGtleSk7CiAgfSByZXR1cm4gcmVzdWx0Owp9OwoKLyoqKi8gfSksCi8qIDg3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBjdHggICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTQpCiAgLCBjYWxsICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTEpCiAgLCBpc0FycmF5SXRlciA9IF9fd2VicGFja19yZXF1aXJlX18oODkpCiAgLCBhbk9iamVjdCAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIHRvTGVuZ3RoICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NykKICAsIGdldEl0ZXJGbiAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MykKICAsIEJSRUFLICAgICAgID0ge30KICAsIFJFVFVSTiAgICAgID0ge307CnZhciBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdGVyYWJsZSwgZW50cmllcywgZm4sIHRoYXQsIElURVJBVE9SKXsKICB2YXIgaXRlckZuID0gSVRFUkFUT1IgPyBmdW5jdGlvbigpeyByZXR1cm4gaXRlcmFibGU7IH0gOiBnZXRJdGVyRm4oaXRlcmFibGUpCiAgICAsIGYgICAgICA9IGN0eChmbiwgdGhhdCwgZW50cmllcyA/IDIgOiAxKQogICAgLCBpbmRleCAgPSAwCiAgICAsIGxlbmd0aCwgc3RlcCwgaXRlcmF0b3IsIHJlc3VsdDsKICBpZih0eXBlb2YgaXRlckZuICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ZXJhYmxlICsgJyBpcyBub3QgaXRlcmFibGUhJyk7CiAgLy8gZmFzdCBjYXNlIGZvciBhcnJheXMgd2l0aCBkZWZhdWx0IGl0ZXJhdG9yCiAgaWYoaXNBcnJheUl0ZXIoaXRlckZuKSlmb3IobGVuZ3RoID0gdG9MZW5ndGgoaXRlcmFibGUubGVuZ3RoKTsgbGVuZ3RoID4gaW5kZXg7IGluZGV4KyspewogICAgcmVzdWx0ID0gZW50cmllcyA/IGYoYW5PYmplY3Qoc3RlcCA9IGl0ZXJhYmxlW2luZGV4XSlbMF0sIHN0ZXBbMV0pIDogZihpdGVyYWJsZVtpbmRleF0pOwogICAgaWYocmVzdWx0ID09PSBCUkVBSyB8fCByZXN1bHQgPT09IFJFVFVSTilyZXR1cm4gcmVzdWx0OwogIH0gZWxzZSBmb3IoaXRlcmF0b3IgPSBpdGVyRm4uY2FsbChpdGVyYWJsZSk7ICEoc3RlcCA9IGl0ZXJhdG9yLm5leHQoKSkuZG9uZTsgKXsKICAgIHJlc3VsdCA9IGNhbGwoaXRlcmF0b3IsIGYsIHN0ZXAudmFsdWUsIGVudHJpZXMpOwogICAgaWYocmVzdWx0ID09PSBCUkVBSyB8fCByZXN1bHQgPT09IFJFVFVSTilyZXR1cm4gcmVzdWx0OwogIH0KfTsKZXhwb3J0cy5CUkVBSyAgPSBCUkVBSzsKZXhwb3J0cy5SRVRVUk4gPSBSRVRVUk47CgovKioqLyB9KSwKLyogODggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKLy8gZmFzdCBhcHBseSwgaHR0cDovL2pzcGVyZi5sbmtpdC5jb20vZmFzdC1hcHBseS81Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIGFyZ3MsIHRoYXQpewogIHZhciB1biA9IHRoYXQgPT09IHVuZGVmaW5lZDsKICBzd2l0Y2goYXJncy5sZW5ndGgpewogICAgY2FzZSAwOiByZXR1cm4gdW4gPyBmbigpCiAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCk7CiAgICBjYXNlIDE6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0pCiAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSk7CiAgICBjYXNlIDI6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0sIGFyZ3NbMV0pCiAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSwgYXJnc1sxXSk7CiAgICBjYXNlIDM6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pCiAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSk7CiAgICBjYXNlIDQ6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pCiAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSk7CiAgfSByZXR1cm4gICAgICAgICAgICAgIGZuLmFwcGx5KHRoYXQsIGFyZ3MpOwp9OwoKLyoqKi8gfSksCi8qIDg5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIGNoZWNrIG9uIGRlZmF1bHQgQXJyYXkgaXRlcmF0b3IKdmFyIEl0ZXJhdG9ycyAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KQogICwgSVRFUkFUT1IgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikoJ2l0ZXJhdG9yJykKICAsIEFycmF5UHJvdG8gPSBBcnJheS5wcm90b3R5cGU7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsKICByZXR1cm4gaXQgIT09IHVuZGVmaW5lZCAmJiAoSXRlcmF0b3JzLkFycmF5ID09PSBpdCB8fCBBcnJheVByb3RvW0lURVJBVE9SXSA9PT0gaXQpOwp9OwoKLyoqKi8gfSksCi8qIDkwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDcuMi4yIElzQXJyYXkoYXJndW1lbnQpCnZhciBjb2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTsKbW9kdWxlLmV4cG9ydHMgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIGlzQXJyYXkoYXJnKXsKICByZXR1cm4gY29mKGFyZykgPT0gJ0FycmF5JzsKfTsKCi8qKiovIH0pLAovKiA5MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBjYWxsIHNvbWV0aGluZyBvbiBpdGVyYXRvciBzdGVwIHdpdGggc2FmZSBjbG9zaW5nIG9uIGVycm9yCnZhciBhbk9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXRlcmF0b3IsIGZuLCB2YWx1ZSwgZW50cmllcyl7CiAgdHJ5IHsKICAgIHJldHVybiBlbnRyaWVzID8gZm4oYW5PYmplY3QodmFsdWUpWzBdLCB2YWx1ZVsxXSkgOiBmbih2YWx1ZSk7CiAgLy8gNy40LjYgSXRlcmF0b3JDbG9zZShpdGVyYXRvciwgY29tcGxldGlvbikKICB9IGNhdGNoKGUpewogICAgdmFyIHJldCA9IGl0ZXJhdG9yWydyZXR1cm4nXTsKICAgIGlmKHJldCAhPT0gdW5kZWZpbmVkKWFuT2JqZWN0KHJldC5jYWxsKGl0ZXJhdG9yKSk7CiAgICB0aHJvdyBlOwogIH0KfTsKCi8qKiovIH0pLAovKiA5MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgSVRFUkFUT1IgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnaXRlcmF0b3InKQogICwgU0FGRV9DTE9TSU5HID0gZmFsc2U7Cgp0cnkgewogIHZhciByaXRlciA9IFs3XVtJVEVSQVRPUl0oKTsKICByaXRlclsncmV0dXJuJ10gPSBmdW5jdGlvbigpeyBTQUZFX0NMT1NJTkcgPSB0cnVlOyB9OwogIEFycmF5LmZyb20ocml0ZXIsIGZ1bmN0aW9uKCl7IHRocm93IDI7IH0pOwp9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGV4ZWMsIHNraXBDbG9zaW5nKXsKICBpZighc2tpcENsb3NpbmcgJiYgIVNBRkVfQ0xPU0lORylyZXR1cm4gZmFsc2U7CiAgdmFyIHNhZmUgPSBmYWxzZTsKICB0cnkgewogICAgdmFyIGFyciAgPSBbN10KICAgICAgLCBpdGVyID0gYXJyW0lURVJBVE9SXSgpOwogICAgaXRlci5uZXh0ID0gZnVuY3Rpb24oKXsgcmV0dXJuIHtkb25lOiBzYWZlID0gdHJ1ZX07IH07CiAgICBhcnJbSVRFUkFUT1JdID0gZnVuY3Rpb24oKXsgcmV0dXJuIGl0ZXI7IH07CiAgICBleGVjKGFycik7CiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQogIHJldHVybiBzYWZlOwp9OwoKLyoqKi8gfSksCi8qIDkzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciBnZXRLZXlzICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KQogICwgdG9JT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqZWN0LCBlbCl7CiAgdmFyIE8gICAgICA9IHRvSU9iamVjdChvYmplY3QpCiAgICAsIGtleXMgICA9IGdldEtleXMoTykKICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgKICAgICwgaW5kZXggID0gMAogICAgLCBrZXk7CiAgd2hpbGUobGVuZ3RoID4gaW5kZXgpaWYoT1trZXkgPSBrZXlzW2luZGV4KytdXSA9PT0gZWwpcmV0dXJuIGtleTsKfTsKCi8qKiovIH0pLAovKiA5NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgbWFjcm90YXNrID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Nykuc2V0CiAgLCBPYnNlcnZlciAgPSBnbG9iYWwuTXV0YXRpb25PYnNlcnZlciB8fCBnbG9iYWwuV2ViS2l0TXV0YXRpb25PYnNlcnZlcgogICwgcHJvY2VzcyAgID0gZ2xvYmFsLnByb2Nlc3MKICAsIFByb21pc2UgICA9IGdsb2JhbC5Qcm9taXNlCiAgLCBpc05vZGUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KShwcm9jZXNzKSA9PSAncHJvY2Vzcyc7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCl7CiAgdmFyIGhlYWQsIGxhc3QsIG5vdGlmeTsKCiAgdmFyIGZsdXNoID0gZnVuY3Rpb24oKXsKICAgIHZhciBwYXJlbnQsIGZuOwogICAgaWYoaXNOb2RlICYmIChwYXJlbnQgPSBwcm9jZXNzLmRvbWFpbikpcGFyZW50LmV4aXQoKTsKICAgIHdoaWxlKGhlYWQpewogICAgICBmbiAgID0gaGVhZC5mbjsKICAgICAgaGVhZCA9IGhlYWQubmV4dDsKICAgICAgdHJ5IHsKICAgICAgICBmbigpOwogICAgICB9IGNhdGNoKGUpewogICAgICAgIGlmKGhlYWQpbm90aWZ5KCk7CiAgICAgICAgZWxzZSBsYXN0ID0gdW5kZWZpbmVkOwogICAgICAgIHRocm93IGU7CiAgICAgIH0KICAgIH0gbGFzdCA9IHVuZGVmaW5lZDsKICAgIGlmKHBhcmVudClwYXJlbnQuZW50ZXIoKTsKICB9OwoKICAvLyBOb2RlLmpzCiAgaWYoaXNOb2RlKXsKICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CiAgICAgIHByb2Nlc3MubmV4dFRpY2soZmx1c2gpOwogICAgfTsKICAvLyBicm93c2VycyB3aXRoIE11dGF0aW9uT2JzZXJ2ZXIKICB9IGVsc2UgaWYoT2JzZXJ2ZXIpewogICAgdmFyIHRvZ2dsZSA9IHRydWUKICAgICAgLCBub2RlICAgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyk7CiAgICBuZXcgT2JzZXJ2ZXIoZmx1c2gpLm9ic2VydmUobm9kZSwge2NoYXJhY3RlckRhdGE6IHRydWV9KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXcKICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7CiAgICAgIG5vZGUuZGF0YSA9IHRvZ2dsZSA9ICF0b2dnbGU7CiAgICB9OwogIC8vIGVudmlyb25tZW50cyB3aXRoIG1heWJlIG5vbi1jb21wbGV0ZWx5IGNvcnJlY3QsIGJ1dCBleGlzdGVudCBQcm9taXNlCiAgfSBlbHNlIGlmKFByb21pc2UgJiYgUHJvbWlzZS5yZXNvbHZlKXsKICAgIHZhciBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICBwcm9taXNlLnRoZW4oZmx1c2gpOwogICAgfTsKICAvLyBmb3Igb3RoZXIgZW52aXJvbm1lbnRzIC0gbWFjcm90YXNrIGJhc2VkIG9uOgogIC8vIC0gc2V0SW1tZWRpYXRlCiAgLy8gLSBNZXNzYWdlQ2hhbm5lbAogIC8vIC0gd2luZG93LnBvc3RNZXNzYWcKICAvLyAtIG9ucmVhZHlzdGF0ZWNoYW5nZQogIC8vIC0gc2V0VGltZW91dAogIH0gZWxzZSB7CiAgICBub3RpZnkgPSBmdW5jdGlvbigpewogICAgICAvLyBzdHJhbmdlIElFICsgd2VicGFjayBkZXYgc2VydmVyIGJ1ZyAtIHVzZSAuY2FsbChnbG9iYWwpCiAgICAgIG1hY3JvdGFzay5jYWxsKGdsb2JhbCwgZmx1c2gpOwogICAgfTsKICB9CgogIHJldHVybiBmdW5jdGlvbihmbil7CiAgICB2YXIgdGFzayA9IHtmbjogZm4sIG5leHQ6IHVuZGVmaW5lZH07CiAgICBpZihsYXN0KWxhc3QubmV4dCA9IHRhc2s7CiAgICBpZighaGVhZCl7CiAgICAgIGhlYWQgPSB0YXNrOwogICAgICBub3RpZnkoKTsKICAgIH0gbGFzdCA9IHRhc2s7CiAgfTsKfTsKCi8qKiovIH0pLAovKiA5NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyBmYWxsYmFjayBmb3IgSUUxMSBidWdneSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB3aXRoIGlmcmFtZSBhbmQgd2luZG93CnZhciB0b0lPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQogICwgZ09QTiAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2NSkuZgogICwgdG9TdHJpbmcgID0ge30udG9TdHJpbmc7Cgp2YXIgd2luZG93TmFtZXMgPSB0eXBlb2Ygd2luZG93ID09ICdvYmplY3QnICYmIHdpbmRvdyAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcwogID8gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMod2luZG93KSA6IFtdOwoKdmFyIGdldFdpbmRvd05hbWVzID0gZnVuY3Rpb24oaXQpewogIHRyeSB7CiAgICByZXR1cm4gZ09QTihpdCk7CiAgfSBjYXRjaChlKXsKICAgIHJldHVybiB3aW5kb3dOYW1lcy5zbGljZSgpOwogIH0KfTsKCm1vZHVsZS5leHBvcnRzLmYgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKGl0KXsKICByZXR1cm4gd2luZG93TmFtZXMgJiYgdG9TdHJpbmcuY2FsbChpdCkgPT0gJ1tvYmplY3QgV2luZG93XScgPyBnZXRXaW5kb3dOYW1lcyhpdCkgOiBnT1BOKHRvSU9iamVjdChpdCkpOwp9OwoKCi8qKiovIH0pLAovKiA5NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgaGlkZSA9IF9fd2VicGFja19yZXF1aXJlX18oNik7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odGFyZ2V0LCBzcmMsIHNhZmUpewogIGZvcih2YXIga2V5IGluIHNyYyl7CiAgICBpZihzYWZlICYmIHRhcmdldFtrZXldKXRhcmdldFtrZXldID0gc3JjW2tleV07CiAgICBlbHNlIGhpZGUodGFyZ2V0LCBrZXksIHNyY1trZXldKTsKICB9IHJldHVybiB0YXJnZXQ7Cn07CgovKioqLyB9KSwKLyogOTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gV29ya3Mgd2l0aCBfX3Byb3RvX18gb25seS4gT2xkIHY4IGNhbid0IHdvcmsgd2l0aCBudWxsIHByb3RvIG9iamVjdHMuCi8qIGVzbGludC1kaXNhYmxlIG5vLXByb3RvICovCnZhciBpc09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIGFuT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKdmFyIGNoZWNrID0gZnVuY3Rpb24oTywgcHJvdG8pewogIGFuT2JqZWN0KE8pOwogIGlmKCFpc09iamVjdChwcm90bykgJiYgcHJvdG8gIT09IG51bGwpdGhyb3cgVHlwZUVycm9yKHByb3RvICsgIjogY2FuJ3Qgc2V0IGFzIHByb3RvdHlwZSEiKTsKfTsKbW9kdWxlLmV4cG9ydHMgPSB7CiAgc2V0OiBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgKCdfX3Byb3RvX18nIGluIHt9ID8gLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgZnVuY3Rpb24odGVzdCwgYnVnZ3ksIHNldCl7CiAgICAgIHRyeSB7CiAgICAgICAgc2V0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkoRnVuY3Rpb24uY2FsbCwgX193ZWJwYWNrX3JlcXVpcmVfXyg1NykuZihPYmplY3QucHJvdG90eXBlLCAnX19wcm90b19fJykuc2V0LCAyKTsKICAgICAgICBzZXQodGVzdCwgW10pOwogICAgICAgIGJ1Z2d5ID0gISh0ZXN0IGluc3RhbmNlb2YgQXJyYXkpOwogICAgICB9IGNhdGNoKGUpeyBidWdneSA9IHRydWU7IH0KICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKE8sIHByb3RvKXsKICAgICAgICBjaGVjayhPLCBwcm90byk7CiAgICAgICAgaWYoYnVnZ3kpTy5fX3Byb3RvX18gPSBwcm90bzsKICAgICAgICBlbHNlIHNldChPLCBwcm90byk7CiAgICAgICAgcmV0dXJuIE87CiAgICAgIH07CiAgICB9KHt9LCBmYWxzZSkgOiB1bmRlZmluZWQpLAogIGNoZWNrOiBjaGVjawp9OwoKLyoqKi8gfSksCi8qIDk4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBnbG9iYWwgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMSkKICAsIGNvcmUgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKQogICwgZFAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCBERVNDUklQVE9SUyA9IF9fd2VicGFja19yZXF1aXJlX18oMykKICAsIFNQRUNJRVMgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnc3BlY2llcycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihLRVkpewogIHZhciBDID0gdHlwZW9mIGNvcmVbS0VZXSA9PSAnZnVuY3Rpb24nID8gY29yZVtLRVldIDogZ2xvYmFsW0tFWV07CiAgaWYoREVTQ1JJUFRPUlMgJiYgQyAmJiAhQ1tTUEVDSUVTXSlkUC5mKEMsIFNQRUNJRVMsIHsKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgIGdldDogZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH0KICB9KTsKfTsKCi8qKiovIH0pLAovKiA5OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyA3LjMuMjAgU3BlY2llc0NvbnN0cnVjdG9yKE8sIGRlZmF1bHRDb25zdHJ1Y3RvcikKdmFyIGFuT2JqZWN0ICA9IF9fd2VicGFja19yZXF1aXJlX18oNSkKICAsIGFGdW5jdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMjApCiAgLCBTUEVDSUVTICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKCdzcGVjaWVzJyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oTywgRCl7CiAgdmFyIEMgPSBhbk9iamVjdChPKS5jb25zdHJ1Y3RvciwgUzsKICByZXR1cm4gQyA9PT0gdW5kZWZpbmVkIHx8IChTID0gYW5PYmplY3QoQylbU1BFQ0lFU10pID09IHVuZGVmaW5lZCA/IEQgOiBhRnVuY3Rpb24oUyk7Cn07CgovKioqLyB9KSwKLyogMTAwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCnZhciAkZXhwb3J0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KQovLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkKJGV4cG9ydCgkZXhwb3J0LlMsICdPYmplY3QnLCB7Y3JlYXRlOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KX0pOwoKLyoqKi8gfSksCi8qIDEwMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjIuOSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTykKdmFyIHRvT2JqZWN0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCAkZ2V0UHJvdG90eXBlT2YgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQzKTsKCl9fd2VicGFja19yZXF1aXJlX18oNDUpKCdnZXRQcm90b3R5cGVPZicsIGZ1bmN0aW9uKCl7CiAgcmV0dXJuIGZ1bmN0aW9uIGdldFByb3RvdHlwZU9mKGl0KXsKICAgIHJldHVybiAkZ2V0UHJvdG90eXBlT2YodG9PYmplY3QoaXQpKTsKICB9Owp9KTsKCi8qKiovIH0pLAovKiAxMDIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLy8gMTkuMS4yLjE0IE9iamVjdC5rZXlzKE8pCnZhciB0b09iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMzIpCiAgLCAka2V5cyAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpOwoKX193ZWJwYWNrX3JlcXVpcmVfXyg0NSkoJ2tleXMnLCBmdW5jdGlvbigpewogIHJldHVybiBmdW5jdGlvbiBrZXlzKGl0KXsKICAgIHJldHVybiAka2V5cyh0b09iamVjdChpdCkpOwogIH07Cn0pOwoKLyoqKi8gfSksCi8qIDEwMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjMuMTkgT2JqZWN0LnNldFByb3RvdHlwZU9mKE8sIHByb3RvKQp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7CiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0Jywge3NldFByb3RvdHlwZU9mOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDk3KS5zZXR9KTsKCi8qKiovIH0pLAovKiAxMDQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIExJQlJBUlkgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpCiAgLCBnbG9iYWwgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpCiAgLCBjdHggICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KQogICwgY2xhc3NvZiAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NSkKICAsICRleHBvcnQgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKICAsIGlzT2JqZWN0ICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oNykKICAsIGFGdW5jdGlvbiAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjApCiAgLCBhbkluc3RhbmNlICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDg1KQogICwgZm9yT2YgICAgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NykKICAsIHNwZWNpZXNDb25zdHJ1Y3RvciA9IF9fd2VicGFja19yZXF1aXJlX18oOTkpCiAgLCB0YXNrICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY3KS5zZXQKICAsIG1pY3JvdGFzayAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOTQpKCkKICAsIFBST01JU0UgICAgICAgICAgICA9ICdQcm9taXNlJwogICwgVHlwZUVycm9yICAgICAgICAgID0gZ2xvYmFsLlR5cGVFcnJvcgogICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MKICAsICRQcm9taXNlICAgICAgICAgICA9IGdsb2JhbFtQUk9NSVNFXQogICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MKICAsIGlzTm9kZSAgICAgICAgICAgICA9IGNsYXNzb2YocHJvY2VzcykgPT0gJ3Byb2Nlc3MnCiAgLCBlbXB0eSAgICAgICAgICAgICAgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9CiAgLCBJbnRlcm5hbCwgR2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5LCBXcmFwcGVyOwoKdmFyIFVTRV9OQVRJVkUgPSAhIWZ1bmN0aW9uKCl7CiAgdHJ5IHsKICAgIC8vIGNvcnJlY3Qgc3ViY2xhc3Npbmcgd2l0aCBAQHNwZWNpZXMgc3VwcG9ydAogICAgdmFyIHByb21pc2UgICAgID0gJFByb21pc2UucmVzb2x2ZSgxKQogICAgICAsIEZha2VQcm9taXNlID0gKHByb21pc2UuY29uc3RydWN0b3IgPSB7fSlbX193ZWJwYWNrX3JlcXVpcmVfXygyKSgnc3BlY2llcycpXSA9IGZ1bmN0aW9uKGV4ZWMpeyBleGVjKGVtcHR5LCBlbXB0eSk7IH07CiAgICAvLyB1bmhhbmRsZWQgcmVqZWN0aW9ucyB0cmFja2luZyBzdXBwb3J0LCBOb2RlSlMgUHJvbWlzZSB3aXRob3V0IGl0IGZhaWxzIEBAc3BlY2llcyB0ZXN0CiAgICByZXR1cm4gKGlzTm9kZSB8fCB0eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50ID09ICdmdW5jdGlvbicpICYmIHByb21pc2UudGhlbihlbXB0eSkgaW5zdGFuY2VvZiBGYWtlUHJvbWlzZTsKICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9Cn0oKTsKCi8vIGhlbHBlcnMKdmFyIHNhbWVDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKGEsIGIpewogIC8vIHdpdGggbGlicmFyeSB3cmFwcGVyIHNwZWNpYWwgY2FzZQogIHJldHVybiBhID09PSBiIHx8IGEgPT09ICRQcm9taXNlICYmIGIgPT09IFdyYXBwZXI7Cn07CnZhciBpc1RoZW5hYmxlID0gZnVuY3Rpb24oaXQpewogIHZhciB0aGVuOwogIHJldHVybiBpc09iamVjdChpdCkgJiYgdHlwZW9mICh0aGVuID0gaXQudGhlbikgPT0gJ2Z1bmN0aW9uJyA/IHRoZW4gOiBmYWxzZTsKfTsKdmFyIG5ld1Byb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24oQyl7CiAgcmV0dXJuIHNhbWVDb25zdHJ1Y3RvcigkUHJvbWlzZSwgQykKICAgID8gbmV3IFByb21pc2VDYXBhYmlsaXR5KEMpCiAgICA6IG5ldyBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkoQyk7Cn07CnZhciBQcm9taXNlQ2FwYWJpbGl0eSA9IEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKEMpewogIHZhciByZXNvbHZlLCByZWplY3Q7CiAgdGhpcy5wcm9taXNlID0gbmV3IEMoZnVuY3Rpb24oJCRyZXNvbHZlLCAkJHJlamVjdCl7CiAgICBpZihyZXNvbHZlICE9PSB1bmRlZmluZWQgfHwgcmVqZWN0ICE9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCdCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvcicpOwogICAgcmVzb2x2ZSA9ICQkcmVzb2x2ZTsKICAgIHJlamVjdCAgPSAkJHJlamVjdDsKICB9KTsKICB0aGlzLnJlc29sdmUgPSBhRnVuY3Rpb24ocmVzb2x2ZSk7CiAgdGhpcy5yZWplY3QgID0gYUZ1bmN0aW9uKHJlamVjdCk7Cn07CnZhciBwZXJmb3JtID0gZnVuY3Rpb24oZXhlYyl7CiAgdHJ5IHsKICAgIGV4ZWMoKTsKICB9IGNhdGNoKGUpewogICAgcmV0dXJuIHtlcnJvcjogZX07CiAgfQp9Owp2YXIgbm90aWZ5ID0gZnVuY3Rpb24ocHJvbWlzZSwgaXNSZWplY3QpewogIGlmKHByb21pc2UuX24pcmV0dXJuOwogIHByb21pc2UuX24gPSB0cnVlOwogIHZhciBjaGFpbiA9IHByb21pc2UuX2M7CiAgbWljcm90YXNrKGZ1bmN0aW9uKCl7CiAgICB2YXIgdmFsdWUgPSBwcm9taXNlLl92CiAgICAgICwgb2sgICAgPSBwcm9taXNlLl9zID09IDEKICAgICAgLCBpICAgICA9IDA7CiAgICB2YXIgcnVuID0gZnVuY3Rpb24ocmVhY3Rpb24pewogICAgICB2YXIgaGFuZGxlciA9IG9rID8gcmVhY3Rpb24ub2sgOiByZWFjdGlvbi5mYWlsCiAgICAgICAgLCByZXNvbHZlID0gcmVhY3Rpb24ucmVzb2x2ZQogICAgICAgICwgcmVqZWN0ICA9IHJlYWN0aW9uLnJlamVjdAogICAgICAgICwgZG9tYWluICA9IHJlYWN0aW9uLmRvbWFpbgogICAgICAgICwgcmVzdWx0LCB0aGVuOwogICAgICB0cnkgewogICAgICAgIGlmKGhhbmRsZXIpewogICAgICAgICAgaWYoIW9rKXsKICAgICAgICAgICAgaWYocHJvbWlzZS5faCA9PSAyKW9uSGFuZGxlVW5oYW5kbGVkKHByb21pc2UpOwogICAgICAgICAgICBwcm9taXNlLl9oID0gMTsKICAgICAgICAgIH0KICAgICAgICAgIGlmKGhhbmRsZXIgPT09IHRydWUpcmVzdWx0ID0gdmFsdWU7CiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYoZG9tYWluKWRvbWFpbi5lbnRlcigpOwogICAgICAgICAgICByZXN1bHQgPSBoYW5kbGVyKHZhbHVlKTsKICAgICAgICAgICAgaWYoZG9tYWluKWRvbWFpbi5leGl0KCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZihyZXN1bHQgPT09IHJlYWN0aW9uLnByb21pc2UpewogICAgICAgICAgICByZWplY3QoVHlwZUVycm9yKCdQcm9taXNlLWNoYWluIGN5Y2xlJykpOwogICAgICAgICAgfSBlbHNlIGlmKHRoZW4gPSBpc1RoZW5hYmxlKHJlc3VsdCkpewogICAgICAgICAgICB0aGVuLmNhbGwocmVzdWx0LCByZXNvbHZlLCByZWplY3QpOwogICAgICAgICAgfSBlbHNlIHJlc29sdmUocmVzdWx0KTsKICAgICAgICB9IGVsc2UgcmVqZWN0KHZhbHVlKTsKICAgICAgfSBjYXRjaChlKXsKICAgICAgICByZWplY3QoZSk7CiAgICAgIH0KICAgIH07CiAgICB3aGlsZShjaGFpbi5sZW5ndGggPiBpKXJ1bihjaGFpbltpKytdKTsgLy8gdmFyaWFibGUgbGVuZ3RoIC0gY2FuJ3QgdXNlIGZvckVhY2gKICAgIHByb21pc2UuX2MgPSBbXTsKICAgIHByb21pc2UuX24gPSBmYWxzZTsKICAgIGlmKGlzUmVqZWN0ICYmICFwcm9taXNlLl9oKW9uVW5oYW5kbGVkKHByb21pc2UpOwogIH0pOwp9Owp2YXIgb25VbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKICB0YXNrLmNhbGwoZ2xvYmFsLCBmdW5jdGlvbigpewogICAgdmFyIHZhbHVlID0gcHJvbWlzZS5fdgogICAgICAsIGFicnVwdCwgaGFuZGxlciwgY29uc29sZTsKICAgIGlmKGlzVW5oYW5kbGVkKHByb21pc2UpKXsKICAgICAgYWJydXB0ID0gcGVyZm9ybShmdW5jdGlvbigpewogICAgICAgIGlmKGlzTm9kZSl7CiAgICAgICAgICBwcm9jZXNzLmVtaXQoJ3VuaGFuZGxlZFJlamVjdGlvbicsIHZhbHVlLCBwcm9taXNlKTsKICAgICAgICB9IGVsc2UgaWYoaGFuZGxlciA9IGdsb2JhbC5vbnVuaGFuZGxlZHJlamVjdGlvbil7CiAgICAgICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHZhbHVlfSk7CiAgICAgICAgfSBlbHNlIGlmKChjb25zb2xlID0gZ2xvYmFsLmNvbnNvbGUpICYmIGNvbnNvbGUuZXJyb3IpewogICAgICAgICAgY29uc29sZS5lcnJvcignVW5oYW5kbGVkIHByb21pc2UgcmVqZWN0aW9uJywgdmFsdWUpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIC8vIEJyb3dzZXJzIHNob3VsZCBub3QgdHJpZ2dlciBgcmVqZWN0aW9uSGFuZGxlZGAgZXZlbnQgaWYgaXQgd2FzIGhhbmRsZWQgaGVyZSwgTm9kZUpTIC0gc2hvdWxkCiAgICAgIHByb21pc2UuX2ggPSBpc05vZGUgfHwgaXNVbmhhbmRsZWQocHJvbWlzZSkgPyAyIDogMTsKICAgIH0gcHJvbWlzZS5fYSA9IHVuZGVmaW5lZDsKICAgIGlmKGFicnVwdCl0aHJvdyBhYnJ1cHQuZXJyb3I7CiAgfSk7Cn07CnZhciBpc1VuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2UpewogIGlmKHByb21pc2UuX2ggPT0gMSlyZXR1cm4gZmFsc2U7CiAgdmFyIGNoYWluID0gcHJvbWlzZS5fYSB8fCBwcm9taXNlLl9jCiAgICAsIGkgICAgID0gMAogICAgLCByZWFjdGlvbjsKICB3aGlsZShjaGFpbi5sZW5ndGggPiBpKXsKICAgIHJlYWN0aW9uID0gY2hhaW5baSsrXTsKICAgIGlmKHJlYWN0aW9uLmZhaWwgfHwgIWlzVW5oYW5kbGVkKHJlYWN0aW9uLnByb21pc2UpKXJldHVybiBmYWxzZTsKICB9IHJldHVybiB0cnVlOwp9Owp2YXIgb25IYW5kbGVVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsKICB0YXNrLmNhbGwoZ2xvYmFsLCBmdW5jdGlvbigpewogICAgdmFyIGhhbmRsZXI7CiAgICBpZihpc05vZGUpewogICAgICBwcm9jZXNzLmVtaXQoJ3JlamVjdGlvbkhhbmRsZWQnLCBwcm9taXNlKTsKICAgIH0gZWxzZSBpZihoYW5kbGVyID0gZ2xvYmFsLm9ucmVqZWN0aW9uaGFuZGxlZCl7CiAgICAgIGhhbmRsZXIoe3Byb21pc2U6IHByb21pc2UsIHJlYXNvbjogcHJvbWlzZS5fdn0pOwogICAgfQogIH0pOwp9Owp2YXIgJHJlamVjdCA9IGZ1bmN0aW9uKHZhbHVlKXsKICB2YXIgcHJvbWlzZSA9IHRoaXM7CiAgaWYocHJvbWlzZS5fZClyZXR1cm47CiAgcHJvbWlzZS5fZCA9IHRydWU7CiAgcHJvbWlzZSA9IHByb21pc2UuX3cgfHwgcHJvbWlzZTsgLy8gdW53cmFwCiAgcHJvbWlzZS5fdiA9IHZhbHVlOwogIHByb21pc2UuX3MgPSAyOwogIGlmKCFwcm9taXNlLl9hKXByb21pc2UuX2EgPSBwcm9taXNlLl9jLnNsaWNlKCk7CiAgbm90aWZ5KHByb21pc2UsIHRydWUpOwp9Owp2YXIgJHJlc29sdmUgPSBmdW5jdGlvbih2YWx1ZSl7CiAgdmFyIHByb21pc2UgPSB0aGlzCiAgICAsIHRoZW47CiAgaWYocHJvbWlzZS5fZClyZXR1cm47CiAgcHJvbWlzZS5fZCA9IHRydWU7CiAgcHJvbWlzZSA9IHByb21pc2UuX3cgfHwgcHJvbWlzZTsgLy8gdW53cmFwCiAgdHJ5IHsKICAgIGlmKHByb21pc2UgPT09IHZhbHVlKXRocm93IFR5cGVFcnJvcigiUHJvbWlzZSBjYW4ndCBiZSByZXNvbHZlZCBpdHNlbGYiKTsKICAgIGlmKHRoZW4gPSBpc1RoZW5hYmxlKHZhbHVlKSl7CiAgICAgIG1pY3JvdGFzayhmdW5jdGlvbigpewogICAgICAgIHZhciB3cmFwcGVyID0ge193OiBwcm9taXNlLCBfZDogZmFsc2V9OyAvLyB3cmFwCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHRoZW4uY2FsbCh2YWx1ZSwgY3R4KCRyZXNvbHZlLCB3cmFwcGVyLCAxKSwgY3R4KCRyZWplY3QsIHdyYXBwZXIsIDEpKTsKICAgICAgICB9IGNhdGNoKGUpewogICAgICAgICAgJHJlamVjdC5jYWxsKHdyYXBwZXIsIGUpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBwcm9taXNlLl92ID0gdmFsdWU7CiAgICAgIHByb21pc2UuX3MgPSAxOwogICAgICBub3RpZnkocHJvbWlzZSwgZmFsc2UpOwogICAgfQogIH0gY2F0Y2goZSl7CiAgICAkcmVqZWN0LmNhbGwoe193OiBwcm9taXNlLCBfZDogZmFsc2V9LCBlKTsgLy8gd3JhcAogIH0KfTsKCi8vIGNvbnN0cnVjdG9yIHBvbHlmaWxsCmlmKCFVU0VfTkFUSVZFKXsKICAvLyAyNS40LjMuMSBQcm9taXNlKGV4ZWN1dG9yKQogICRQcm9taXNlID0gZnVuY3Rpb24gUHJvbWlzZShleGVjdXRvcil7CiAgICBhbkluc3RhbmNlKHRoaXMsICRQcm9taXNlLCBQUk9NSVNFLCAnX2gnKTsKICAgIGFGdW5jdGlvbihleGVjdXRvcik7CiAgICBJbnRlcm5hbC5jYWxsKHRoaXMpOwogICAgdHJ5IHsKICAgICAgZXhlY3V0b3IoY3R4KCRyZXNvbHZlLCB0aGlzLCAxKSwgY3R4KCRyZWplY3QsIHRoaXMsIDEpKTsKICAgIH0gY2F0Y2goZXJyKXsKICAgICAgJHJlamVjdC5jYWxsKHRoaXMsIGVycik7CiAgICB9CiAgfTsKICBJbnRlcm5hbCA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpewogICAgdGhpcy5fYyA9IFtdOyAgICAgICAgICAgICAvLyA8LSBhd2FpdGluZyByZWFjdGlvbnMKICAgIHRoaXMuX2EgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gY2hlY2tlZCBpbiBpc1VuaGFuZGxlZCByZWFjdGlvbnMKICAgIHRoaXMuX3MgPSAwOyAgICAgICAgICAgICAgLy8gPC0gc3RhdGUKICAgIHRoaXMuX2QgPSBmYWxzZTsgICAgICAgICAgLy8gPC0gZG9uZQogICAgdGhpcy5fdiA9IHVuZGVmaW5lZDsgICAgICAvLyA8LSB2YWx1ZQogICAgdGhpcy5faCA9IDA7ICAgICAgICAgICAgICAvLyA8LSByZWplY3Rpb24gc3RhdGUsIDAgLSBkZWZhdWx0LCAxIC0gaGFuZGxlZCwgMiAtIHVuaGFuZGxlZAogICAgdGhpcy5fbiA9IGZhbHNlOyAgICAgICAgICAvLyA8LSBub3RpZnkKICB9OwogIEludGVybmFsLnByb3RvdHlwZSA9IF9fd2VicGFja19yZXF1aXJlX18oOTYpKCRQcm9taXNlLnByb3RvdHlwZSwgewogICAgLy8gMjUuNC41LjMgUHJvbWlzZS5wcm90b3R5cGUudGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCkKICAgIHRoZW46IGZ1bmN0aW9uIHRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpewogICAgICB2YXIgcmVhY3Rpb24gICAgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShzcGVjaWVzQ29uc3RydWN0b3IodGhpcywgJFByb21pc2UpKTsKICAgICAgcmVhY3Rpb24ub2sgICAgID0gdHlwZW9mIG9uRnVsZmlsbGVkID09ICdmdW5jdGlvbicgPyBvbkZ1bGZpbGxlZCA6IHRydWU7CiAgICAgIHJlYWN0aW9uLmZhaWwgICA9IHR5cGVvZiBvblJlamVjdGVkID09ICdmdW5jdGlvbicgJiYgb25SZWplY3RlZDsKICAgICAgcmVhY3Rpb24uZG9tYWluID0gaXNOb2RlID8gcHJvY2Vzcy5kb21haW4gOiB1bmRlZmluZWQ7CiAgICAgIHRoaXMuX2MucHVzaChyZWFjdGlvbik7CiAgICAgIGlmKHRoaXMuX2EpdGhpcy5fYS5wdXNoKHJlYWN0aW9uKTsKICAgICAgaWYodGhpcy5fcylub3RpZnkodGhpcywgZmFsc2UpOwogICAgICByZXR1cm4gcmVhY3Rpb24ucHJvbWlzZTsKICAgIH0sCiAgICAvLyAyNS40LjUuMSBQcm9taXNlLnByb3RvdHlwZS5jYXRjaChvblJlamVjdGVkKQogICAgJ2NhdGNoJzogZnVuY3Rpb24ob25SZWplY3RlZCl7CiAgICAgIHJldHVybiB0aGlzLnRoZW4odW5kZWZpbmVkLCBvblJlamVjdGVkKTsKICAgIH0KICB9KTsKICBQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uKCl7CiAgICB2YXIgcHJvbWlzZSAgPSBuZXcgSW50ZXJuYWw7CiAgICB0aGlzLnByb21pc2UgPSBwcm9taXNlOwogICAgdGhpcy5yZXNvbHZlID0gY3R4KCRyZXNvbHZlLCBwcm9taXNlLCAxKTsKICAgIHRoaXMucmVqZWN0ICA9IGN0eCgkcmVqZWN0LCBwcm9taXNlLCAxKTsKICB9Owp9CgokZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuVyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCB7UHJvbWlzZTogJFByb21pc2V9KTsKX193ZWJwYWNrX3JlcXVpcmVfXygyMSkoJFByb21pc2UsIFBST01JU0UpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDk4KShQUk9NSVNFKTsKV3JhcHBlciA9IF9fd2VicGFja19yZXF1aXJlX18oMClbUFJPTUlTRV07CgovLyBzdGF0aWNzCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIFBST01JU0UsIHsKICAvLyAyNS40LjQuNSBQcm9taXNlLnJlamVjdChyKQogIHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KHIpewogICAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eSh0aGlzKQogICAgICAsICQkcmVqZWN0ICAgPSBjYXBhYmlsaXR5LnJlamVjdDsKICAgICQkcmVqZWN0KHIpOwogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICB9Cn0pOwokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIChMSUJSQVJZIHx8ICFVU0VfTkFUSVZFKSwgUFJPTUlTRSwgewogIC8vIDI1LjQuNC42IFByb21pc2UucmVzb2x2ZSh4KQogIHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmUoeCl7CiAgICAvLyBpbnN0YW5jZW9mIGluc3RlYWQgb2YgaW50ZXJuYWwgc2xvdCBjaGVjayBiZWNhdXNlIHdlIHNob3VsZCBmaXggaXQgd2l0aG91dCByZXBsYWNlbWVudCBuYXRpdmUgUHJvbWlzZSBjb3JlCiAgICBpZih4IGluc3RhbmNlb2YgJFByb21pc2UgJiYgc2FtZUNvbnN0cnVjdG9yKHguY29uc3RydWN0b3IsIHRoaXMpKXJldHVybiB4OwogICAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eSh0aGlzKQogICAgICAsICQkcmVzb2x2ZSAgPSBjYXBhYmlsaXR5LnJlc29sdmU7CiAgICAkJHJlc29sdmUoeCk7CiAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwogIH0KfSk7CiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIShVU0VfTkFUSVZFICYmIF9fd2VicGFja19yZXF1aXJlX18oOTIpKGZ1bmN0aW9uKGl0ZXIpewogICRQcm9taXNlLmFsbChpdGVyKVsnY2F0Y2gnXShlbXB0eSk7Cn0pKSwgUFJPTUlTRSwgewogIC8vIDI1LjQuNC4xIFByb21pc2UuYWxsKGl0ZXJhYmxlKQogIGFsbDogZnVuY3Rpb24gYWxsKGl0ZXJhYmxlKXsKICAgIHZhciBDICAgICAgICAgID0gdGhpcwogICAgICAsIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKQogICAgICAsIHJlc29sdmUgICAgPSBjYXBhYmlsaXR5LnJlc29sdmUKICAgICAgLCByZWplY3QgICAgID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgICB2YXIgYWJydXB0ID0gcGVyZm9ybShmdW5jdGlvbigpewogICAgICB2YXIgdmFsdWVzICAgID0gW10KICAgICAgICAsIGluZGV4ICAgICA9IDAKICAgICAgICAsIHJlbWFpbmluZyA9IDE7CiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7CiAgICAgICAgdmFyICRpbmRleCAgICAgICAgPSBpbmRleCsrCiAgICAgICAgICAsIGFscmVhZHlDYWxsZWQgPSBmYWxzZTsKICAgICAgICB2YWx1ZXMucHVzaCh1bmRlZmluZWQpOwogICAgICAgIHJlbWFpbmluZysrOwogICAgICAgIEMucmVzb2x2ZShwcm9taXNlKS50aGVuKGZ1bmN0aW9uKHZhbHVlKXsKICAgICAgICAgIGlmKGFscmVhZHlDYWxsZWQpcmV0dXJuOwogICAgICAgICAgYWxyZWFkeUNhbGxlZCAgPSB0cnVlOwogICAgICAgICAgdmFsdWVzWyRpbmRleF0gPSB2YWx1ZTsKICAgICAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKICAgICAgICB9LCByZWplY3QpOwogICAgICB9KTsKICAgICAgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpOwogICAgfSk7CiAgICBpZihhYnJ1cHQpcmVqZWN0KGFicnVwdC5lcnJvcik7CiAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwogIH0sCiAgLy8gMjUuNC40LjQgUHJvbWlzZS5yYWNlKGl0ZXJhYmxlKQogIHJhY2U6IGZ1bmN0aW9uIHJhY2UoaXRlcmFibGUpewogICAgdmFyIEMgICAgICAgICAgPSB0aGlzCiAgICAgICwgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KEMpCiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0OwogICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXsKICAgICAgZm9yT2YoaXRlcmFibGUsIGZhbHNlLCBmdW5jdGlvbihwcm9taXNlKXsKICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihjYXBhYmlsaXR5LnJlc29sdmUsIHJlamVjdCk7CiAgICAgIH0pOwogICAgfSk7CiAgICBpZihhYnJ1cHQpcmVqZWN0KGFicnVwdC5lcnJvcik7CiAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwogIH0KfSk7CgovKioqLyB9KSwKLyogMTA1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCi8vIEVDTUFTY3JpcHQgNiBzeW1ib2xzIHNoaW0KdmFyIGdsb2JhbCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKQogICwgaGFzICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKQogICwgREVTQ1JJUFRPUlMgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpCiAgLCAkZXhwb3J0ICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oOCkKICAsIHJlZGVmaW5lICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0NikKICAsIE1FVEEgICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MikuS0VZCiAgLCAkZmFpbHMgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpCiAgLCBzaGFyZWQgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMzApCiAgLCBzZXRUb1N0cmluZ1RhZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpCiAgLCB1aWQgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpCiAgLCB3a3MgICAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMikKICAsIHdrc0V4dCAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OSkKICAsIHdrc0RlZmluZSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0OCkKICAsIGtleU9mICAgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MykKICAsIGVudW1LZXlzICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4NikKICAsIGlzQXJyYXkgICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5MCkKICAsIGFuT2JqZWN0ICAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KQogICwgdG9JT2JqZWN0ICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQogICwgdG9QcmltaXRpdmUgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKQogICwgY3JlYXRlRGVzYyAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KQogICwgX2NyZWF0ZSAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM1KQogICwgZ09QTkV4dCAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDk1KQogICwgJEdPUEQgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KQogICwgJERQICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpCiAgLCAka2V5cyAgICAgICAgICA9IF9fd2VicGFja19yZXF1aXJlX18oMTcpCiAgLCBnT1BEICAgICAgICAgICA9ICRHT1BELmYKICAsIGRQICAgICAgICAgICAgID0gJERQLmYKICAsIGdPUE4gICAgICAgICAgID0gZ09QTkV4dC5mCiAgLCAkU3ltYm9sICAgICAgICA9IGdsb2JhbC5TeW1ib2wKICAsICRKU09OICAgICAgICAgID0gZ2xvYmFsLkpTT04KICAsIF9zdHJpbmdpZnkgICAgID0gJEpTT04gJiYgJEpTT04uc3RyaW5naWZ5CiAgLCBQUk9UT1RZUEUgICAgICA9ICdwcm90b3R5cGUnCiAgLCBISURERU4gICAgICAgICA9IHdrcygnX2hpZGRlbicpCiAgLCBUT19QUklNSVRJVkUgICA9IHdrcygndG9QcmltaXRpdmUnKQogICwgaXNFbnVtICAgICAgICAgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZQogICwgU3ltYm9sUmVnaXN0cnkgPSBzaGFyZWQoJ3N5bWJvbC1yZWdpc3RyeScpCiAgLCBBbGxTeW1ib2xzICAgICA9IHNoYXJlZCgnc3ltYm9scycpCiAgLCBPUFN5bWJvbHMgICAgICA9IHNoYXJlZCgnb3Atc3ltYm9scycpCiAgLCBPYmplY3RQcm90byAgICA9IE9iamVjdFtQUk9UT1RZUEVdCiAgLCBVU0VfTkFUSVZFICAgICA9IHR5cGVvZiAkU3ltYm9sID09ICdmdW5jdGlvbicKICAsIFFPYmplY3QgICAgICAgID0gZ2xvYmFsLlFPYmplY3Q7Ci8vIERvbid0IHVzZSBzZXR0ZXJzIGluIFF0IFNjcmlwdCwgaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzE3Mwp2YXIgc2V0dGVyID0gIVFPYmplY3QgfHwgIVFPYmplY3RbUFJPVE9UWVBFXSB8fCAhUU9iamVjdFtQUk9UT1RZUEVdLmZpbmRDaGlsZDsKCi8vIGZhbGxiYWNrIGZvciBvbGQgQW5kcm9pZCwgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTY4Nwp2YXIgc2V0U3ltYm9sRGVzYyA9IERFU0NSSVBUT1JTICYmICRmYWlscyhmdW5jdGlvbigpewogIHJldHVybiBfY3JlYXRlKGRQKHt9LCAnYScsIHsKICAgIGdldDogZnVuY3Rpb24oKXsgcmV0dXJuIGRQKHRoaXMsICdhJywge3ZhbHVlOiA3fSkuYTsgfQogIH0pKS5hICE9IDc7Cn0pID8gZnVuY3Rpb24oaXQsIGtleSwgRCl7CiAgdmFyIHByb3RvRGVzYyA9IGdPUEQoT2JqZWN0UHJvdG8sIGtleSk7CiAgaWYocHJvdG9EZXNjKWRlbGV0ZSBPYmplY3RQcm90b1trZXldOwogIGRQKGl0LCBrZXksIEQpOwogIGlmKHByb3RvRGVzYyAmJiBpdCAhPT0gT2JqZWN0UHJvdG8pZFAoT2JqZWN0UHJvdG8sIGtleSwgcHJvdG9EZXNjKTsKfSA6IGRQOwoKdmFyIHdyYXAgPSBmdW5jdGlvbih0YWcpewogIHZhciBzeW0gPSBBbGxTeW1ib2xzW3RhZ10gPSBfY3JlYXRlKCRTeW1ib2xbUFJPVE9UWVBFXSk7CiAgc3ltLl9rID0gdGFnOwogIHJldHVybiBzeW07Cn07Cgp2YXIgaXNTeW1ib2wgPSBVU0VfTkFUSVZFICYmIHR5cGVvZiAkU3ltYm9sLml0ZXJhdG9yID09ICdzeW1ib2wnID8gZnVuY3Rpb24oaXQpewogIHJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCc7Cn0gOiBmdW5jdGlvbihpdCl7CiAgcmV0dXJuIGl0IGluc3RhbmNlb2YgJFN5bWJvbDsKfTsKCnZhciAkZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBEKXsKICBpZihpdCA9PT0gT2JqZWN0UHJvdG8pJGRlZmluZVByb3BlcnR5KE9QU3ltYm9scywga2V5LCBEKTsKICBhbk9iamVjdChpdCk7CiAga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKTsKICBhbk9iamVjdChEKTsKICBpZihoYXMoQWxsU3ltYm9scywga2V5KSl7CiAgICBpZighRC5lbnVtZXJhYmxlKXsKICAgICAgaWYoIWhhcyhpdCwgSElEREVOKSlkUChpdCwgSElEREVOLCBjcmVhdGVEZXNjKDEsIHt9KSk7CiAgICAgIGl0W0hJRERFTl1ba2V5XSA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICBpZihoYXMoaXQsIEhJRERFTikgJiYgaXRbSElEREVOXVtrZXldKWl0W0hJRERFTl1ba2V5XSA9IGZhbHNlOwogICAgICBEID0gX2NyZWF0ZShELCB7ZW51bWVyYWJsZTogY3JlYXRlRGVzYygwLCBmYWxzZSl9KTsKICAgIH0gcmV0dXJuIHNldFN5bWJvbERlc2MoaXQsIGtleSwgRCk7CiAgfSByZXR1cm4gZFAoaXQsIGtleSwgRCk7Cn07CnZhciAkZGVmaW5lUHJvcGVydGllcyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoaXQsIFApewogIGFuT2JqZWN0KGl0KTsKICB2YXIga2V5cyA9IGVudW1LZXlzKFAgPSB0b0lPYmplY3QoUCkpCiAgICAsIGkgICAgPSAwCiAgICAsIGwgPSBrZXlzLmxlbmd0aAogICAgLCBrZXk7CiAgd2hpbGUobCA+IGkpJGRlZmluZVByb3BlcnR5KGl0LCBrZXkgPSBrZXlzW2krK10sIFBba2V5XSk7CiAgcmV0dXJuIGl0Owp9Owp2YXIgJGNyZWF0ZSA9IGZ1bmN0aW9uIGNyZWF0ZShpdCwgUCl7CiAgcmV0dXJuIFAgPT09IHVuZGVmaW5lZCA/IF9jcmVhdGUoaXQpIDogJGRlZmluZVByb3BlcnRpZXMoX2NyZWF0ZShpdCksIFApOwp9Owp2YXIgJHByb3BlcnR5SXNFbnVtZXJhYmxlID0gZnVuY3Rpb24gcHJvcGVydHlJc0VudW1lcmFibGUoa2V5KXsKICB2YXIgRSA9IGlzRW51bS5jYWxsKHRoaXMsIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSkpOwogIGlmKHRoaXMgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKXJldHVybiBmYWxzZTsKICByZXR1cm4gRSB8fCAhaGFzKHRoaXMsIGtleSkgfHwgIWhhcyhBbGxTeW1ib2xzLCBrZXkpIHx8IGhhcyh0aGlzLCBISURERU4pICYmIHRoaXNbSElEREVOXVtrZXldID8gRSA6IHRydWU7Cn07CnZhciAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpewogIGl0ICA9IHRvSU9iamVjdChpdCk7CiAga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKTsKICBpZihpdCA9PT0gT2JqZWN0UHJvdG8gJiYgaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIWhhcyhPUFN5bWJvbHMsIGtleSkpcmV0dXJuOwogIHZhciBEID0gZ09QRChpdCwga2V5KTsKICBpZihEICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICEoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSkpRC5lbnVtZXJhYmxlID0gdHJ1ZTsKICByZXR1cm4gRDsKfTsKdmFyICRnZXRPd25Qcm9wZXJ0eU5hbWVzID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCl7CiAgdmFyIG5hbWVzICA9IGdPUE4odG9JT2JqZWN0KGl0KSkKICAgICwgcmVzdWx0ID0gW10KICAgICwgaSAgICAgID0gMAogICAgLCBrZXk7CiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7CiAgICBpZighaGFzKEFsbFN5bWJvbHMsIGtleSA9IG5hbWVzW2krK10pICYmIGtleSAhPSBISURERU4gJiYga2V5ICE9IE1FVEEpcmVzdWx0LnB1c2goa2V5KTsKICB9IHJldHVybiByZXN1bHQ7Cn07CnZhciAkZ2V0T3duUHJvcGVydHlTeW1ib2xzID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlTeW1ib2xzKGl0KXsKICB2YXIgSVNfT1AgID0gaXQgPT09IE9iamVjdFByb3RvCiAgICAsIG5hbWVzICA9IGdPUE4oSVNfT1AgPyBPUFN5bWJvbHMgOiB0b0lPYmplY3QoaXQpKQogICAgLCByZXN1bHQgPSBbXQogICAgLCBpICAgICAgPSAwCiAgICAsIGtleTsKICB3aGlsZShuYW1lcy5sZW5ndGggPiBpKXsKICAgIGlmKGhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiAoSVNfT1AgPyBoYXMoT2JqZWN0UHJvdG8sIGtleSkgOiB0cnVlKSlyZXN1bHQucHVzaChBbGxTeW1ib2xzW2tleV0pOwogIH0gcmV0dXJuIHJlc3VsdDsKfTsKCi8vIDE5LjQuMS4xIFN5bWJvbChbZGVzY3JpcHRpb25dKQppZighVVNFX05BVElWRSl7CiAgJFN5bWJvbCA9IGZ1bmN0aW9uIFN5bWJvbCgpewogICAgaWYodGhpcyBpbnN0YW5jZW9mICRTeW1ib2wpdGhyb3cgVHlwZUVycm9yKCdTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3IhJyk7CiAgICB2YXIgdGFnID0gdWlkKGFyZ3VtZW50cy5sZW5ndGggPiAwID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkKTsKICAgIHZhciAkc2V0ID0gZnVuY3Rpb24odmFsdWUpewogICAgICBpZih0aGlzID09PSBPYmplY3RQcm90bykkc2V0LmNhbGwoT1BTeW1ib2xzLCB2YWx1ZSk7CiAgICAgIGlmKGhhcyh0aGlzLCBISURERU4pICYmIGhhcyh0aGlzW0hJRERFTl0sIHRhZykpdGhpc1tISURERU5dW3RhZ10gPSBmYWxzZTsKICAgICAgc2V0U3ltYm9sRGVzYyh0aGlzLCB0YWcsIGNyZWF0ZURlc2MoMSwgdmFsdWUpKTsKICAgIH07CiAgICBpZihERVNDUklQVE9SUyAmJiBzZXR0ZXIpc2V0U3ltYm9sRGVzYyhPYmplY3RQcm90bywgdGFnLCB7Y29uZmlndXJhYmxlOiB0cnVlLCBzZXQ6ICRzZXR9KTsKICAgIHJldHVybiB3cmFwKHRhZyk7CiAgfTsKICByZWRlZmluZSgkU3ltYm9sW1BST1RPVFlQRV0sICd0b1N0cmluZycsIGZ1bmN0aW9uIHRvU3RyaW5nKCl7CiAgICByZXR1cm4gdGhpcy5fazsKICB9KTsKCiAgJEdPUEQuZiA9ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CiAgJERQLmYgICA9ICRkZWZpbmVQcm9wZXJ0eTsKICBfX3dlYnBhY2tfcmVxdWlyZV9fKDY1KS5mID0gZ09QTkV4dC5mID0gJGdldE93blByb3BlcnR5TmFtZXM7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkuZiAgPSAkcHJvcGVydHlJc0VudW1lcmFibGU7CiAgX193ZWJwYWNrX3JlcXVpcmVfXyg1OCkuZiA9ICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHM7CgogIGlmKERFU0NSSVBUT1JTICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KSl7CiAgICByZWRlZmluZShPYmplY3RQcm90bywgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJywgJHByb3BlcnR5SXNFbnVtZXJhYmxlLCB0cnVlKTsKICB9CgogIHdrc0V4dC5mID0gZnVuY3Rpb24obmFtZSl7CiAgICByZXR1cm4gd3JhcCh3a3MobmFtZSkpOwogIH0KfQoKJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1N5bWJvbDogJFN5bWJvbH0pOwoKZm9yKHZhciBzeW1ib2xzID0gKAogIC8vIDE5LjQuMi4yLCAxOS40LjIuMywgMTkuNC4yLjQsIDE5LjQuMi42LCAxOS40LjIuOCwgMTkuNC4yLjksIDE5LjQuMi4xMCwgMTkuNC4yLjExLCAxOS40LjIuMTIsIDE5LjQuMi4xMywgMTkuNC4yLjE0CiAgJ2hhc0luc3RhbmNlLGlzQ29uY2F0U3ByZWFkYWJsZSxpdGVyYXRvcixtYXRjaCxyZXBsYWNlLHNlYXJjaCxzcGVjaWVzLHNwbGl0LHRvUHJpbWl0aXZlLHRvU3RyaW5nVGFnLHVuc2NvcGFibGVzJwopLnNwbGl0KCcsJyksIGkgPSAwOyBzeW1ib2xzLmxlbmd0aCA+IGk7ICl3a3Moc3ltYm9sc1tpKytdKTsKCmZvcih2YXIgc3ltYm9scyA9ICRrZXlzKHdrcy5zdG9yZSksIGkgPSAwOyBzeW1ib2xzLmxlbmd0aCA+IGk7ICl3a3NEZWZpbmUoc3ltYm9sc1tpKytdKTsKCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsICdTeW1ib2wnLCB7CiAgLy8gMTkuNC4yLjEgU3ltYm9sLmZvcihrZXkpCiAgJ2Zvcic6IGZ1bmN0aW9uKGtleSl7CiAgICByZXR1cm4gaGFzKFN5bWJvbFJlZ2lzdHJ5LCBrZXkgKz0gJycpCiAgICAgID8gU3ltYm9sUmVnaXN0cnlba2V5XQogICAgICA6IFN5bWJvbFJlZ2lzdHJ5W2tleV0gPSAkU3ltYm9sKGtleSk7CiAgfSwKICAvLyAxOS40LjIuNSBTeW1ib2wua2V5Rm9yKHN5bSkKICBrZXlGb3I6IGZ1bmN0aW9uIGtleUZvcihrZXkpewogICAgaWYoaXNTeW1ib2woa2V5KSlyZXR1cm4ga2V5T2YoU3ltYm9sUmVnaXN0cnksIGtleSk7CiAgICB0aHJvdyBUeXBlRXJyb3Ioa2V5ICsgJyBpcyBub3QgYSBzeW1ib2whJyk7CiAgfSwKICB1c2VTZXR0ZXI6IGZ1bmN0aW9uKCl7IHNldHRlciA9IHRydWU7IH0sCiAgdXNlU2ltcGxlOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSBmYWxzZTsgfQp9KTsKCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsICdPYmplY3QnLCB7CiAgLy8gMTkuMS4yLjIgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQogIGNyZWF0ZTogJGNyZWF0ZSwKICAvLyAxOS4xLjIuNCBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykKICBkZWZpbmVQcm9wZXJ0eTogJGRlZmluZVByb3BlcnR5LAogIC8vIDE5LjEuMi4zIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpCiAgZGVmaW5lUHJvcGVydGllczogJGRlZmluZVByb3BlcnRpZXMsCiAgLy8gMTkuMS4yLjYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKQogIGdldE93blByb3BlcnR5RGVzY3JpcHRvcjogJGdldE93blByb3BlcnR5RGVzY3JpcHRvciwKICAvLyAxOS4xLjIuNyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKQogIGdldE93blByb3BlcnR5TmFtZXM6ICRnZXRPd25Qcm9wZXJ0eU5hbWVzLAogIC8vIDE5LjEuMi44IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoTykKICBnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6ICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHMKfSk7CgovLyAyNC4zLjIgSlNPTi5zdHJpbmdpZnkodmFsdWUgWywgcmVwbGFjZXIgWywgc3BhY2VdXSkKJEpTT04gJiYgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoIVVTRV9OQVRJVkUgfHwgJGZhaWxzKGZ1bmN0aW9uKCl7CiAgdmFyIFMgPSAkU3ltYm9sKCk7CiAgLy8gTVMgRWRnZSBjb252ZXJ0cyBzeW1ib2wgdmFsdWVzIHRvIEpTT04gYXMge30KICAvLyBXZWJLaXQgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIG51bGwKICAvLyBWOCB0aHJvd3Mgb24gYm94ZWQgc3ltYm9scwogIHJldHVybiBfc3RyaW5naWZ5KFtTXSkgIT0gJ1tudWxsXScgfHwgX3N0cmluZ2lmeSh7YTogU30pICE9ICd7fScgfHwgX3N0cmluZ2lmeShPYmplY3QoUykpICE9ICd7fSc7Cn0pKSwgJ0pTT04nLCB7CiAgc3RyaW5naWZ5OiBmdW5jdGlvbiBzdHJpbmdpZnkoaXQpewogICAgaWYoaXQgPT09IHVuZGVmaW5lZCB8fCBpc1N5bWJvbChpdCkpcmV0dXJuOyAvLyBJRTggcmV0dXJucyBzdHJpbmcgb24gdW5kZWZpbmVkCiAgICB2YXIgYXJncyA9IFtpdF0KICAgICAgLCBpICAgID0gMQogICAgICAsIHJlcGxhY2VyLCAkcmVwbGFjZXI7CiAgICB3aGlsZShhcmd1bWVudHMubGVuZ3RoID4gaSlhcmdzLnB1c2goYXJndW1lbnRzW2krK10pOwogICAgcmVwbGFjZXIgPSBhcmdzWzFdOwogICAgaWYodHlwZW9mIHJlcGxhY2VyID09ICdmdW5jdGlvbicpJHJlcGxhY2VyID0gcmVwbGFjZXI7CiAgICBpZigkcmVwbGFjZXIgfHwgIWlzQXJyYXkocmVwbGFjZXIpKXJlcGxhY2VyID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSl7CiAgICAgIGlmKCRyZXBsYWNlcil2YWx1ZSA9ICRyZXBsYWNlci5jYWxsKHRoaXMsIGtleSwgdmFsdWUpOwogICAgICBpZighaXNTeW1ib2wodmFsdWUpKXJldHVybiB2YWx1ZTsKICAgIH07CiAgICBhcmdzWzFdID0gcmVwbGFjZXI7CiAgICByZXR1cm4gX3N0cmluZ2lmeS5hcHBseSgkSlNPTiwgYXJncyk7CiAgfQp9KTsKCi8vIDE5LjQuMy40IFN5bWJvbC5wcm90b3R5cGVbQEB0b1ByaW1pdGl2ZV0oaGludCkKJFN5bWJvbFtQUk9UT1RZUEVdW1RPX1BSSU1JVElWRV0gfHwgX193ZWJwYWNrX3JlcXVpcmVfXyg2KSgkU3ltYm9sW1BST1RPVFlQRV0sIFRPX1BSSU1JVElWRSwgJFN5bWJvbFtQUk9UT1RZUEVdLnZhbHVlT2YpOwovLyAxOS40LjMuNSBTeW1ib2wucHJvdG90eXBlW0BAdG9TdHJpbmdUYWddCnNldFRvU3RyaW5nVGFnKCRTeW1ib2wsICdTeW1ib2wnKTsKLy8gMjAuMi4xLjkgTWF0aFtAQHRvU3RyaW5nVGFnXQpzZXRUb1N0cmluZ1RhZyhNYXRoLCAnTWF0aCcsIHRydWUpOwovLyAyNC4zLjMgSlNPTltAQHRvU3RyaW5nVGFnXQpzZXRUb1N0cmluZ1RhZyhnbG9iYWwuSlNPTiwgJ0pTT04nLCB0cnVlKTsKCi8qKiovIH0pLAovKiAxMDYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg0OCkoJ2FzeW5jSXRlcmF0b3InKTsKCi8qKiovIH0pLAovKiAxMDcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXyg0OCkoJ29ic2VydmFibGUnKTsKCi8qKiovIH0pLAovKiAxMDggKi8sCi8qIDEwOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKCnZhciBfc3RyaW5naWZ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmeSk7Cgp2YXIgX2tleXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKCnZhciBfa2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9rZXlzKTsKCmV4cG9ydHMuZGl2aWRlVVJMID0gZGl2aWRlVVJMOwpleHBvcnRzLmRpdmlkZUVtYWlsID0gZGl2aWRlRW1haWw7CmV4cG9ydHMuZW1wdHlPYmplY3QgPSBlbXB0eU9iamVjdDsKZXhwb3J0cy5kZWVwQ2xvbmUgPSBkZWVwQ2xvbmU7CmV4cG9ydHMuZ2V0VXNlclVSTEZyb21FbWFpbCA9IGdldFVzZXJVUkxGcm9tRW1haWw7CmV4cG9ydHMuZ2V0VXNlckVtYWlsRnJvbVVSTCA9IGdldFVzZXJFbWFpbEZyb21VUkw7CmV4cG9ydHMuY29udmVydFRvVXNlclVSTCA9IGNvbnZlcnRUb1VzZXJVUkw7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQKKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTgoqCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KKiovCi8qKgogKiBTdXBwb3J0IG1vZHVsZSB3aXRoIHNvbWUgZnVuY3Rpb25zIHdpbGwgYmUgdXNlZnVsCiAqIEBtb2R1bGUgdXRpbHMKICovCgovKioKICogQHR5cGVkZWYgZGl2aWRlVVJMCiAqIEB0eXBlIE9iamVjdAogKiBAcHJvcGVydHkge3N0cmluZ30gdHlwZSBUaGUgdHlwZSBvZiBVUkwKICogQHByb3BlcnR5IHtzdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG9mIFVSTAogKiBAcHJvcGVydHkge3N0cmluZ30gaWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIFVSTAogKi8KCi8qKgogKiBEaXZpZGUgYW4gdXJsIGluIHR5cGUsIGRvbWFpbiBhbmQgaWRlbnRpdHkKICogQHBhcmFtICB7VVJMLlVSTH0gdXJsIC0gdXJsIGFkZHJlc3MKICogQHJldHVybiB7ZGl2aWRlVVJMfSB0aGUgcmVzdWx0IG9mIGRpdmlkZVVSTAogKi8KZnVuY3Rpb24gZGl2aWRlVVJMKHVybCkgewoKICBpZiAoIXVybCkgdGhyb3cgRXJyb3IoJ1VSTCBpcyBuZWVkZWQgdG8gc3BsaXQnKTsKCiAgZnVuY3Rpb24gcmVjdXJzZSh2YWx1ZSkgewogICAgdmFyIHJlZ2V4ID0gLyhbYS16QS1aLV0qKSg6XC9cLyg/OlwuKT98OikoWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn0pKFstYS16QS1aMC05QDolLl9cK34jPVwvXSopL2dpOwogICAgdmFyIHN1YnN0ID0gJyQxLCQzLCQ0JzsKICAgIHZhciBwYXJ0cyA9IHZhbHVlLnJlcGxhY2UocmVnZXgsIHN1YnN0KS5zcGxpdCgnLCcpOwogICAgcmV0dXJuIHBhcnRzOwogIH0KCiAgdmFyIHBhcnRzID0gcmVjdXJzZSh1cmwpOwoKICAvLyBJZiB0aGUgdXJsIGhhcyBubyBzY2hlbWUKICBpZiAocGFydHNbMF0gPT09IHVybCAmJiAhcGFydHNbMF0uaW5jbHVkZXMoJ0AnKSkgewoKICAgIHZhciBfcmVzdWx0ID0gewogICAgICB0eXBlOiAiIiwKICAgICAgZG9tYWluOiB1cmwsCiAgICAgIGlkZW50aXR5OiAiIgogICAgfTsKCiAgICBjb25zb2xlLmVycm9yKCdbRGl2aWRlVVJMXSBEaXZpZGVVUkwgZG9uXCd0IHN1cHBvcnQgdXJsIHdpdGhvdXQgc2NoZW1lLiBQbGVhc2UgcmV2aWV3IHlvdXIgdXJsIGFkZHJlc3MnLCB1cmwpOwoKICAgIHJldHVybiBfcmVzdWx0OwogIH0KCiAgLy8gY2hlY2sgaWYgdGhlIHVybCBoYXMgdGhlIHNjaGVtZSBhbmQgaW5jbHVkZXMgYW4gQAogIGlmIChwYXJ0c1swXSA9PT0gdXJsICYmIHBhcnRzWzBdLmluY2x1ZGVzKCdAJykpIHsKICAgIHZhciBzY2hlbWUgPSBwYXJ0c1swXSA9PT0gdXJsID8gJ3NtdHAnIDogcGFydHNbMF07CiAgICBwYXJ0cyA9IHJlY3Vyc2Uoc2NoZW1lICsgJzovLycgKyBwYXJ0c1swXSk7CiAgfQoKICAvLyBpZiB0aGUgZG9tYWluIGluY2x1ZGVzIGFuIEAsIGRpdmlkZSBpdCB0byBkb21haW4gYW5kIGlkZW50aXR5IHJlc3BlY3RpdmVseQogIGlmIChwYXJ0c1sxXS5pbmNsdWRlcygnQCcpKSB7CiAgICBwYXJ0c1syXSA9IHBhcnRzWzBdICsgJzovLycgKyBwYXJ0c1sxXTsKICAgIHBhcnRzWzFdID0gcGFydHNbMV0uc3Vic3RyKHBhcnRzWzFdLmluZGV4T2YoJ0AnKSArIDEpOwogIH0gLyplbHNlIGlmIChwYXJ0c1syXS5pbmNsdWRlcygnLycpKSB7CiAgICBwYXJ0c1syXSA9IHBhcnRzWzJdLnN1YnN0cihwYXJ0c1syXS5sYXN0SW5kZXhPZignLycpKzEpOwogICAgfSovCgogIHZhciByZXN1bHQgPSB7CiAgICB0eXBlOiBwYXJ0c1swXSwKICAgIGRvbWFpbjogcGFydHNbMV0sCiAgICBpZGVudGl0eTogcGFydHNbMl0KICB9OwoKICByZXR1cm4gcmVzdWx0Owp9CgpmdW5jdGlvbiBkaXZpZGVFbWFpbChlbWFpbCkgewogIHZhciBpbmRleE9mQXQgPSBlbWFpbC5pbmRleE9mKCdAJyk7CgogIHZhciByZXN1bHQgPSB7CiAgICB1c2VybmFtZTogZW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCksCiAgICBkb21haW46IGVtYWlsLnN1YnN0cmluZyhpbmRleE9mQXQgKyAxLCBlbWFpbC5sZW5ndGgpCiAgfTsKCiAgcmV0dXJuIHJlc3VsdDsKfQoKLyoqCiAqIENoZWNrIGlmIGFuIE9iamVjdCBpcyBlbXB0eQogKiBAcGFyYW0gIHtPYmplY3R9IG9iamVjdCBPYmplY3QgdG8gYmUgY2hlY2tlZAogKiBAcmV0dXJuIHtCb29sZWFufSAgICAgICBzdGF0dXMgb2YgT2JqZWN0LCBlbXB0eSBvciBub3QgKHRydWV8ZmFsc2UpOwogKi8KZnVuY3Rpb24gZW1wdHlPYmplY3Qob2JqZWN0KSB7CiAgcmV0dXJuICgwLCBfa2V5czIuZGVmYXVsdCkob2JqZWN0KS5sZW5ndGggPiAwID8gZmFsc2UgOiB0cnVlOwp9CgovKioKICogTWFrZSBhIENPUFkgb2YgdGhlIG9yaWdpbmFsIGRhdGEKICogQHBhcmFtICB7T2JqZWN0fSAgb2JqIC0gb2JqZWN0IHRvIGJlIGNsb25lZAogKiBAcmV0dXJuIHtPYmplY3R9CiAqLwpmdW5jdGlvbiBkZWVwQ2xvbmUob2JqKSB7CiAgLy9UT0RPOiBzaW1wbGUgYnV0IGluZWZmaWNpZW50IEpTT04gZGVlcCBjbG9uZS4uLgogIGlmIChvYmopIHJldHVybiBKU09OLnBhcnNlKCgwLCBfc3RyaW5naWZ5Mi5kZWZhdWx0KShvYmopKTsKfQoKLyoqCiAqIE9idGFpbnMgdGhlIHVzZXIgVVJMIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBlbWFpbAogKiBAcGFyYW0gIHtzdHJpbmd9IHVzZXJFbWFpbCBUaGUgdXNlciBlbWFpbAogKiBAcmV0dXJuIHtVUkwuVVJMfSB1c2VyVVJMIFRoZSB1c2VyIFVSTAogKi8KZnVuY3Rpb24gZ2V0VXNlclVSTEZyb21FbWFpbCh1c2VyRW1haWwpIHsKICB2YXIgaW5kZXhPZkF0ID0gdXNlckVtYWlsLmluZGV4T2YoJ0AnKTsKICByZXR1cm4gJ3VzZXI6Ly8nICsgdXNlckVtYWlsLnN1YnN0cmluZyhpbmRleE9mQXQgKyAxLCB1c2VyRW1haWwubGVuZ3RoKSArICcvJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoMCwgaW5kZXhPZkF0KTsKfQoKLyoqCiAqIE9idGFpbnMgdGhlIHVzZXIgZW1haWwgdGhhdCBjb3JyZXNwb25kcyB0byBhIGdpdmVuIFVSTAogKiBAcGFyYW0gIHtVUkwuVVJMfSB1c2VyVVJMIFRoZSB1c2VyIFVSTAogKiBAcmV0dXJuIHtzdHJpbmd9IHVzZXJFbWFpbCBUaGUgdXNlciBlbWFpbAogKi8KZnVuY3Rpb24gZ2V0VXNlckVtYWlsRnJvbVVSTCh1c2VyVVJMKSB7CiAgdmFyIHVybCA9IGRpdmlkZVVSTCh1c2VyVVJMKTsKICByZXR1cm4gdXJsLmlkZW50aXR5LnJlcGxhY2UoJy8nLCAnJykgKyAnQCcgKyB1cmwuZG9tYWluOyAvLyBpZGVudGl0eSBmaWVsZCBoYXMgJy9leGFtcGxlSUQnIGluc3RlYWQgb2YgJ2V4YW1wbGVJRCcKfQoKLyoqCiAqIENoZWNrIGlmIHRoZSB1c2VyIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbiB0aGUgVVJMIGZvcm1hdCwgaWYgbm90LCBjb252ZXJ0IHRvIFVSTCBmb3JtYXQKICogQHBhcmFtICB7c3RyaW5nfSAgIGlkZW50aWZpZXIgIHVzZXIgaWRlbnRpZmllcgogKiBAcmV0dXJuIHtzdHJpbmd9ICAgdXNlclVSTCAgICB0aGUgdXNlciBVUkwKICovCmZ1bmN0aW9uIGNvbnZlcnRUb1VzZXJVUkwoaWRlbnRpZmllcikgewoKICAvLyBjaGVjayBpZiB0aGUgaWRlbnRpZmllciBpcyBhbHJlYWR5IGluIHRoZSB1cmwgZm9ybWF0CiAgaWYgKGlkZW50aWZpZXIuc3Vic3RyaW5nKDAsIDcpID09PSAndXNlcjovLycpIHsKICAgIHZhciBkaXZpZGVkVVJMID0gZGl2aWRlVVJMKGlkZW50aWZpZXIpOwoKICAgIC8vY2hlY2sgaWYgdGhlIHVybCBpcyB3ZWxsIGZvcm1hdGVkCiAgICBpZiAoZGl2aWRlZFVSTC5kb21haW4gJiYgZGl2aWRlZFVSTC5pZGVudGl0eSkgewogICAgICByZXR1cm4gaWRlbnRpZmllcjsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93ICd1c2VyVVJMIHdpdGggd3JvbmcgZm9ybWF0JzsKICAgIH0KCiAgICAvL2lmIG5vdCwgY29udmVydCB0aGUgdXNlciBlbWFpbCB0byBVUkwgZm9ybWF0CiAgfSBlbHNlIHsKICAgIHJldHVybiBnZXRVc2VyVVJMRnJvbUVtYWlsKGlkZW50aWZpZXIpOwogIH0KfQoKLyoqKi8gfSksCi8qIDExMCAqLywKLyogMTExICovLAovKiAxMTIgKi8sCi8qIDExMyAqLywKLyogMTE0ICovLAovKiAxMTUgKi8sCi8qIDExNiAqLywKLyogMTE3ICovLAovKiAxMTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKdmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7Cgp2YXIgX2NsYXNzQ2FsbENoZWNrMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsYXNzQ2FsbENoZWNrMik7Cgp2YXIgX2NyZWF0ZUNsYXNzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwoKdmFyIF9jcmVhdGVDbGFzczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGVDbGFzczIpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpOwoKdmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yKTsKCnZhciBfZ2V0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTIzKTsKCnZhciBfZ2V0MyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldDIpOwoKdmFyIF9pbmhlcml0czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTsKCnZhciBfaW5oZXJpdHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW5oZXJpdHMyKTsKCnZhciBfRGF0YU9iamVjdDIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMCk7Cgp2YXIgX0RhdGFPYmplY3QzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdDIpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMSk7Cgp2YXIgX0RhdGFPYmplY3RDaGlsZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Q2hpbGQpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwoKdmFyIEZpbHRlclR5cGUgPSB7IEFOWTogJ2FueScsIFNUQVJUOiAnc3RhcnQnLCBFWEFDVDogJ2V4YWN0JyB9OwoKLyoqCiAqIFRoZSBjbGFzcyByZXR1cm5lZCBmcm9tIHRoZSBTeW5jaGVyIHN1YnNjcmliZSBjYWxsLgogKiBUbyBiZSB1c2VkIGFzIGFuIG9ic2VydmF0aW9uIHBvaW50IGZyb20gYSBEYXRhT2JqZWN0UmVwb3J0ZXIgY2hhbmdlLgogKi8KCnZhciBEYXRhT2JqZWN0T2JzZXJ2ZXIgPSBmdW5jdGlvbiAoX0RhdGFPYmplY3QpIHsKICAoMCwgX2luaGVyaXRzMy5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIsIF9EYXRhT2JqZWN0KTsKCiAgLyogcHJpdmF0ZQogIF9jaGFuZ2VMaXN0ZW5lcjogTXNnTGlzdGVuZXIKICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9maWx0ZXJzOiB7PGZpbHRlcj46IHt0eXBlOiA8c3RhcnQsIGV4YWN0PiwgY2FsbGJhY2s6IDxmdW5jdGlvbj59IH0KICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIFN5bmNoZXIuc3Vic2NyaWJlIG1ldGhvZAogICAqLwoKICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgZnVuY3Rpb24gRGF0YU9iamVjdE9ic2VydmVyKHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zLCBpbml0aWFsVmVyc2lvbiwgbXV0dWFsKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBEYXRhT2JqZWN0T2JzZXJ2ZXIpOwoKICAgIHZhciBfdGhpczIgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4zLmRlZmF1bHQpKHRoaXMsIChEYXRhT2JqZWN0T2JzZXJ2ZXIuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlcikpLmNhbGwodGhpcywgc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLmRhdGEsIGNoaWxkcmVucywgbXV0dWFsKSk7CgogICAgdmFyIF90aGlzID0gX3RoaXMyOwoKICAgIF90aGlzLl92ZXJzaW9uID0gaW5pdGlhbFZlcnNpb247CiAgICBfdGhpcy5fZmlsdGVycyA9IHt9OwoKICAgIF90aGlzLl9zeW5jT2JqLm9ic2VydmUoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIF90aGlzLl9vbkZpbHRlcihldmVudCk7CiAgICB9KTsKCiAgICAvL3NldHVwIGNoaWxkcmVucyBkYXRhIGZyb20gc3Vic2NyaXB0aW9uCiAgICAoMCwgX2tleXMyLmRlZmF1bHQpKGluaXRpYWxEYXRhLmNoaWxkcmVucykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRJZCkgewogICAgICB2YXIgY2hpbGREYXRhID0gaW5pdGlhbERhdGEuY2hpbGRyZW5zW2NoaWxkSWRdOwogICAgICBfdGhpcy5fY2hpbGRyZW5PYmplY3RzW2NoaWxkSWRdID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIGNoaWxkSWQsIGNoaWxkRGF0YSk7CiAgICB9KTsKCiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICAgIHJldHVybiBfdGhpczI7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhT2JqZWN0T2JzZXJ2ZXIsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgKDAsIF9nZXQzLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RPYnNlcnZlci5wcm90b3R5cGUpLCAnX2FsbG9jYXRlTGlzdGVuZXJzJywgdGhpcykuY2FsbCh0aGlzKTsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCArICcvY2hhbmdlcycsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBpZiAobXNnLnR5cGUgPT09ICd1cGRhdGUnKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdE9ic2VydmVyLScgKyBfdGhpcy5fdXJsICsgJy1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgICBfdGhpcy5fY2hhbmdlT2JqZWN0KF90aGlzLl9zeW5jT2JqLCBtc2cpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewogICAgICAoMCwgX2dldDMuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdE9ic2VydmVyLnByb3RvdHlwZSksICdfcmVsZWFzZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIucmVtb3ZlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkZWxldGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOwogICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX29ic2VydmVyc1tfdGhpcy5fdXJsXTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGVhc2UgYW5kIGRlbGV0ZSBvYmplY3QgZGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3Vuc3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiB1bnN1YnNjcmliZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uTG9jYWxVblN1YnNjcmliZQogICAgICB2YXIgdW5TdWJzY3JpYmVNc2cgPSB7CiAgICAgICAgdHlwZTogJ3Vuc3Vic2NyaWJlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBfdGhpcy5fdXJsIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UodW5TdWJzY3JpYmVNc2csIGZ1bmN0aW9uIChyZXBseSkgewogICAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0T2JzZXJ2ZXItVU5TVUJTQ1JJQkU6ICcsIHJlcGx5KTsKICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIF90aGlzLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N5bmNoZXIuX29ic2VydmVyc1tfdGhpcy5fdXJsXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogUmVnaXN0ZXIgdGhlIGNoYW5nZSBsaXN0ZW5lcnMgc2VudCBieSB0aGUgcmVwb3J0ZXIKICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWx0ZXIgLSBGaWx0ZXIgdGhhdCBpZGVudGlmaWVzIHRoZSBmaWVsZCAoc2VwYXJhdGVkIGRvdCBwYXRoKS4gQWNjZXB0cyAqIGF0IHRoZSBlbmQgZm9yIGEgbW9yZSB1bnJlc3RyaWN0ZWQgZmlsdGVyaW5nLgogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uQ2hhbmdlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNoYW5nZShmaWx0ZXIsIGNhbGxiYWNrKSB7CiAgICAgIHZhciBrZXkgPSBmaWx0ZXI7CiAgICAgIHZhciBmaWx0ZXJPYmogPSB7CiAgICAgICAgdHlwZTogRmlsdGVyVHlwZS5FWEFDVCwKICAgICAgICBjYWxsYmFjazogY2FsbGJhY2sKICAgICAgfTsKCiAgICAgIHZhciBpZHggPSBmaWx0ZXIuaW5kZXhPZignKicpOwogICAgICBpZiAoaWR4ID09PSBmaWx0ZXIubGVuZ3RoIC0gMSkgewogICAgICAgIGlmIChpZHggPT09IDApIHsKICAgICAgICAgIGZpbHRlck9iai50eXBlID0gRmlsdGVyVHlwZS5BTlk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZpbHRlck9iai50eXBlID0gRmlsdGVyVHlwZS5TVEFSVDsKICAgICAgICAgIGtleSA9IGZpbHRlci5zdWJzdHIoMCwgZmlsdGVyLmxlbmd0aCAtIDEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fZmlsdGVyc1trZXldID0gZmlsdGVyT2JqOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkZpbHRlcicsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRmlsdGVyKGV2ZW50KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKF90aGlzLl9maWx0ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICB2YXIgZmlsdGVyID0gX3RoaXMuX2ZpbHRlcnNba2V5XTsKICAgICAgICBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuQU5ZKSB7CiAgICAgICAgICAvL21hdGNoIGFueXRoaW5nCiAgICAgICAgICBmaWx0ZXIuY2FsbGJhY2soZXZlbnQpOwogICAgICAgIH0gZWxzZSBpZiAoZmlsdGVyLnR5cGUgPT09IEZpbHRlclR5cGUuU1RBUlQpIHsKICAgICAgICAgIC8vaWYgc3RhcnRzIHdpdGggZmlsdGVyLi4uCiAgICAgICAgICBpZiAoZXZlbnQuZmllbGQuaW5kZXhPZihrZXkpID09PSAwKSB7CiAgICAgICAgICAgIGZpbHRlci5jYWxsYmFjayhldmVudCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChmaWx0ZXIudHlwZSA9PT0gRmlsdGVyVHlwZS5FWEFDVCkgewogICAgICAgICAgLy9leGFjdCBtYXRjaAogICAgICAgICAgaWYgKGV2ZW50LmZpZWxkID09PSBrZXkpIHsKICAgICAgICAgICAgZmlsdGVyLmNhbGxiYWNrKGV2ZW50KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH1dKTsKICByZXR1cm4gRGF0YU9iamVjdE9ic2VydmVyOwp9KF9EYXRhT2JqZWN0My5kZWZhdWx0IC8qIGltcGxlbWVudHMgU3luY1N0YXR1cyAqLyk7CgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0T2JzZXJ2ZXI7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDExOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9rZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3MCk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7Cgp2YXIgX2dldFByb3RvdHlwZU9mID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMSk7Cgp2YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFByb3RvdHlwZU9mKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNCk7Cgp2YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4zID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIpOwoKdmFyIF9nZXQyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjMpOwoKdmFyIF9nZXQzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0Mik7Cgp2YXIgX2luaGVyaXRzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMzMpOwoKdmFyIF9pbmhlcml0czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbmhlcml0czIpOwoKdmFyIF9EYXRhT2JqZWN0MiA9IF9fd2VicGFja19yZXF1aXJlX18oMTIwKTsKCnZhciBfRGF0YU9iamVjdDMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EYXRhT2JqZWN0Mik7Cgp2YXIgX3V0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMDkpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCi8qKgogKiBUaGUgY2xhc3MgcmV0dXJuZWQgZnJvbSB0aGUgU3luY2hlciBjcmVhdGUgY2FsbC4KICogVG8gYmUgdXNlZCBhcyBhIHJlcG9ydGVyIHBvaW50LCBjaGFuZ2VzIHdpbGwgYmUgc3VibWl0ZWQgdG8gRGF0YU9iamVjdE9ic2VydmVyIGluc3RhbmNlcy4KICovCi8qKgoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYKKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KKgoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKKgoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCioKKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCioqLwoKdmFyIERhdGFPYmplY3RSZXBvcnRlciA9IGZ1bmN0aW9uIChfRGF0YU9iamVjdCkgewogICgwLCBfaW5oZXJpdHMzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlciwgX0RhdGFPYmplY3QpOwoKICAvKiBwcml2YXRlCiAgX3N1YnNjcmlwdGlvbnM6IDxoeXBlcnR5VXJsOiB7IHN0YXR1czogc3RyaW5nIH0gfT4KICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vblN1YnNjcmlwdGlvbkhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogIF9vblJlc3BvbnNlSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgX29uUmVhZEhhbmRsZXI6IChldmVudCkgPT4gdm9pZAogICovCgogIC8qKgogICAqIEBpZ25vcmUKICAgKiBTaG91bGQgbm90IGJlIHVzZWQgZGlyZWN0bHkgYnkgSHlwZXJ0aWVzLiBJdCdzIGNhbGxlZCBieSB0aGUgU3luY2hlci5jcmVhdGUgbWV0aG9kCiAgICovCiAgZnVuY3Rpb24gRGF0YU9iamVjdFJlcG9ydGVyKHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBEYXRhT2JqZWN0UmVwb3J0ZXIpOwoKICAgIHZhciBfdGhpczIgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4zLmRlZmF1bHQpKHRoaXMsIChEYXRhT2JqZWN0UmVwb3J0ZXIuX19wcm90b19fIHx8ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlcikpLmNhbGwodGhpcywgc3luY2hlciwgdXJsLCBzY2hlbWEsIGluaXRpYWxTdGF0dXMsIGluaXRpYWxEYXRhLCBjaGlsZHJlbnMpKTsKCiAgICB2YXIgX3RoaXMgPSBfdGhpczI7CgogICAgX3RoaXMuX3N1YnNjcmlwdGlvbnMgPSB7fTsKCiAgICBfdGhpcy5fc3luY09iai5vYnNlcnZlKGZ1bmN0aW9uIChldmVudCkgewogICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLScgKyB1cmwgKyAnLVNFTkQ6ICcsIGV2ZW50KTsKICAgICAgX3RoaXMuX29uQ2hhbmdlKGV2ZW50KTsKICAgIH0pOwoKICAgIF90aGlzLl9hbGxvY2F0ZUxpc3RlbmVycygpOwogICAgcmV0dXJuIF90aGlzMjsKICB9CgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERhdGFPYmplY3RSZXBvcnRlciwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICAoMCwgX2dldDMuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZSksICdfYWxsb2NhdGVMaXN0ZW5lcnMnLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX29iamVjdExpc3RlbmVyID0gX3RoaXMuX2J1cy5hZGRMaXN0ZW5lcihfdGhpcy5fdXJsLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3QtJyArIF90aGlzLl91cmwgKyAnLVJDVjogJywgbXNnKTsKICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7CiAgICAgICAgICBjYXNlICdyZXNwb25zZSc6CiAgICAgICAgICAgIF90aGlzLl9vblJlc3BvbnNlKG1zZyk7YnJlYWs7CiAgICAgICAgICBjYXNlICdyZWFkJzoKICAgICAgICAgICAgX3RoaXMuX29uUmVhZChtc2cpO2JyZWFrOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewogICAgICAoMCwgX2dldDMuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YU9iamVjdFJlcG9ydGVyLnByb3RvdHlwZSksICdfcmVsZWFzZUxpc3RlbmVycycsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy5fb2JqZWN0TGlzdGVuZXIucmVtb3ZlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZW5kIGludml0YXRpb25zIChjcmVhdGUgbWVzc2FnZXMpIHRvIGh5cGVydGllcywgb2JzZXJ2ZXJzIGxpc3QuCiAgICAgKiBAcGFyYW0gIHtIeXBlcnR5VVJMW119IG9ic2VydmVycyBMaXN0IG9mIEh5cGVydHkgVVJMJ3MKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdpbnZpdGVPYnNlcnZlcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIGludml0ZU9ic2VydmVycyhvYnNlcnZlcnMpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uQ3JlYXRlCiAgICAgIHZhciBpbnZpdGVNc2cgPSB7CiAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9zeW5jaGVyLl9vd25lciwgdG86IF90aGlzLl9zeW5jaGVyLl9zdWJVUkwsCiAgICAgICAgYm9keTogeyByZXN1bWU6IGZhbHNlLCByZXNvdXJjZTogX3RoaXMuX3VybCwgc2NoZW1hOiBfdGhpcy5fc2NoZW1hLCB2YWx1ZTogX3RoaXMuX3N5bmNPYmouZGF0YSwgYXV0aG9yaXNlOiBvYnNlcnZlcnMgfQogICAgICB9OwoKICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShpbnZpdGVNc2cpOwogICAgfQoKICAgIC8qKgogICAgICogUmVsZWFzZSBhbmQgZGVsZXRlIG9iamVjdCBkYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9GTE9XLU9VVDogdGhpcyBtZXNzYWdlIHdpbGwgYmUgc2VudCB0byB0aGUgcnVudGltZSBpbnN0YW5jZSBvZiBTeW5jaGVyTWFuYWdlciAtPiBfb25EZWxldGUKICAgICAgdmFyIGRlbGV0ZU1zZyA9IHsKICAgICAgICB0eXBlOiAnZGVsZXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogX3RoaXMuX3N5bmNoZXIuX3N1YlVSTCwKICAgICAgICBib2R5OiB7IHJlc291cmNlOiBfdGhpcy5fdXJsIH0KICAgICAgfTsKCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoZGVsZXRlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdFJlcG9ydGVyLURFTEVURTogJywgcmVwbHkpOwogICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgewogICAgICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fc3luY2hlci5fcmVwb3J0ZXJzW190aGlzLl91cmxdOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdWJzY3JpcHRpb25zIHJlcXVlc3RlZCBhbmQgYWNjZXB0ZWQgdG8gdGhpcyByZXBvcnRlcgogICAgICogQHR5cGUge09iamVjdDxIeXBlcnR5VVJMLCBTeW5jU3Vic2NyaXB0aW9uPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvblN1YnNjcmlwdGlvbicsCgoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3Mgc3Vic2NyaWJlIGFuZCB1bnN1YnNjcmliZSBub3RpZmljYXRpb25zCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrIGZ1bmN0aW9uIHRvIHJlY2VpdmUgZXZlbnRzCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBvblN1YnNjcmlwdGlvbihjYWxsYmFjaykgewogICAgICB0aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHVwIHRoZSBjYWxsYmFjayB0byBwcm9jZXNzIHJlc3BvbnNlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIGNyZWF0ZSdzCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrIGZ1bmN0aW9uIHRvIHJlY2VpdmUgZXZlbnRzCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25SZXNwb25zZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZXNwb25zZShjYWxsYmFjaykgewogICAgICB0aGlzLl9vblJlc3BvbnNlSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgcmVhZCBub3RpZmljYXRpb25zCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25SZWFkJywKICAgIHZhbHVlOiBmdW5jdGlvbiBvblJlYWQoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZWFkSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHBhcmVudCBTeW5jaGVyIC0+IF9vbkZvcndhcmQKCiAgfSwgewogICAga2V5OiAnX29uRm9yd2FyZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRm9yd2FyZChtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGNvbnNvbGUubG9nKCdEYXRhT2JqZWN0UmVwb3J0ZXItUkNWOiAnLCBtc2cpOwogICAgICBzd2l0Y2ggKG1zZy5ib2R5LnR5cGUpIHsKICAgICAgICBjYXNlICdzdWJzY3JpYmUnOgogICAgICAgICAgX3RoaXMuX29uU3Vic2NyaWJlKG1zZyk7YnJlYWs7CiAgICAgICAgY2FzZSAndW5zdWJzY3JpYmUnOgogICAgICAgICAgX3RoaXMuX29uVW5TdWJzY3JpYmUobXNnKTticmVhazsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIHRoaXMgLT4gX29uRm9yd2FyZDogZW1pdHRlZCBieSBhIHJlbW90ZSBTeW5jaGVyIC0+IHN1YnNjcmliZQoKICB9LCB7CiAgICBrZXk6ICdfb25TdWJzY3JpYmUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblN1YnNjcmliZShtc2cpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgaHlwZXJ0eVVybCA9IG1zZy5ib2R5LmZyb207CiAgICAgIGNvbnNvbGUubG9nKCdbRGF0YU9iamVjdFJlcG9ydGVyLl9vblN1YnNjcmliZV0nLCBtc2cpOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy5ib2R5LnR5cGUsCiAgICAgICAgdXJsOiBoeXBlcnR5VXJsLAoKICAgICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHksCgogICAgICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewogICAgICAgICAgLy9jcmVhdGUgbmV3IHN1YnNjcmlwdGlvbgogICAgICAgICAgdmFyIHN1YiA9IHsgdXJsOiBoeXBlcnR5VXJsLCBzdGF0dXM6ICdvbicgfTsKICAgICAgICAgIF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVcmxdID0gc3ViOwoKICAgICAgICAgIC8vcHJvY2VzcyBhbmQgc2VuZCBjaGlsZHJlbnMgZGF0YQogICAgICAgICAgdmFyIGNoaWxkcmVuVmFsdWVzID0ge307CiAgICAgICAgICAoMCwgX2tleXMyLmRlZmF1bHQpKF90aGlzLl9jaGlsZHJlbk9iamVjdHMpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkSWQpIHsKICAgICAgICAgICAgdmFyIGNoaWxkRGF0YSA9IF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF0uZGF0YTsKICAgICAgICAgICAgY2hpbGRyZW5WYWx1ZXNbY2hpbGRJZF0gPSAoMCwgX3V0aWxzLmRlZXBDbG9uZSkoY2hpbGREYXRhKTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIHZhciBzZW5kTXNnID0gewogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHNjaGVtYTogX3RoaXMuX3NjaGVtYSwgdmVyc2lvbjogX3RoaXMuX3ZlcnNpb24sIHZhbHVlOiB7IGRhdGE6ICgwLCBfdXRpbHMuZGVlcENsb25lKShfdGhpcy5kYXRhKSwgY2hpbGRyZW5zOiBjaGlsZHJlblZhbHVlcyB9IH0KICAgICAgICAgIH07CgogICAgICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgICAgICAgaWYgKG1zZy5ib2R5Lmhhc093blByb3BlcnR5KCdtdXR1YWxBdXRoZW50aWNhdGlvbicpICYmICFtc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbikgewogICAgICAgICAgICBzZW5kTXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpczMuX211dHVhbEF1dGhlbnRpY2F0aW9uOwogICAgICAgICAgICBfdGhpczMuX211dHVhbEF1dGhlbnRpY2F0aW9uID0gbXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb247CiAgICAgICAgICB9CgogICAgICAgICAgLy9zZW5kIG9rIHJlc3BvbnNlIG1lc3NhZ2UKICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoc2VuZE1zZyk7CgogICAgICAgICAgcmV0dXJuIHN1YjsKICAgICAgICB9LAoKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsKICAgICAgICAgIC8vc2VuZCByZWplY3QgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwMywgZGVzYzogcmVhc29uIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1NVQlNDUklQVElPTi1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblN1YnNjcmlwdGlvbkhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gdGhpcyAtPiBfb25Gb3J3YXJkOiBlbWl0dGVkIGJ5IGEgcmVtb3RlIERhdGFPYmplY3RPYnNlcnZlciAtPiB1bnN1YnNjcmliZQoKICB9LCB7CiAgICBrZXk6ICdfb25VblN1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uVW5TdWJzY3JpYmUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBoeXBlcnR5VXJsID0gbXNnLmJvZHkuZnJvbTsKCiAgICAgIHZhciBzdWIgPSBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VXJsXTsKICAgICAgZGVsZXRlIF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVcmxdOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy5ib2R5LnR5cGUsCiAgICAgICAgdXJsOiBoeXBlcnR5VXJsLAogICAgICAgIG9iamVjdDogc3ViCiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uU3Vic2NyaXB0aW9uSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdVTi1TVUJTQ1JJUFRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25TdWJzY3JpcHRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIFJlcG9ydGVyVVJMIGFkZHJlc3M6IGVtaXRlZCBieSBhIHJlbW90ZSBTeW5jaGVyIC0+IF9vblJlbW90ZUNyZWF0ZSAtPiBldmVudC5hY2sKCiAgfSwgewogICAga2V5OiAnX29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlc3BvbnNlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgIHR5cGU6IG1zZy50eXBlLAogICAgICAgIHVybDogbXNnLmZyb20sCiAgICAgICAgY29kZTogbXNnLmJvZHkuY29kZQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdSRVNQT05TRS1FVkVOVDogJywgZXZlbnQpOwogICAgICAgIF90aGlzLl9vblJlc3BvbnNlSGFuZGxlcihldmVudCk7CiAgICAgIH0KICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBSZXBvcnRlclVSTCBhZGRyZXNzOiBlbWl0ZWQgYnkgYSByZW1vdGUgU3luY2hlciAtPiByZWFkCgogIH0sIHsKICAgIGtleTogJ19vblJlYWQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlYWQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZXZlbnQgPSB7CiAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgdXJsOiBtc2cuZnJvbSwKCiAgICAgICAgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQoKSB7CiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwLCB2YWx1ZTogKDAsIF91dGlscy5kZWVwQ2xvbmUpKF90aGlzLmRhdGEpIH0KICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KHJlYXNvbikgewogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLAogICAgICAgICAgICBib2R5OiB7IGNvZGU6IDQwMSwgZGVzYzogcmVhc29uIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25SZWFkSGFuZGxlcikgewogICAgICAgIGNvbnNvbGUubG9nKCdSRUFELUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uUmVhZEhhbmRsZXIoZXZlbnQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAnc3Vic2NyaXB0aW9ucycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmlwdGlvbnM7CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhT2JqZWN0UmVwb3J0ZXI7Cn0oX0RhdGFPYmplY3QzLmRlZmF1bHQgLyogaW1wbGVtZW50cyBTeW5jU3RhdHVzICovKTsKCmV4cG9ydHMuZGVmYXVsdCA9IERhdGFPYmplY3RSZXBvcnRlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTIwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7Cgp2YXIgX3Byb21pc2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCnZhciBfa2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oNzApOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfUHJveHlPYmplY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMik7Cgp2YXIgX1Byb3h5T2JqZWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1Byb3h5T2JqZWN0KTsKCnZhciBfRGF0YU9iamVjdENoaWxkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjEpOwoKdmFyIF9EYXRhT2JqZWN0Q2hpbGQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdENoaWxkKTsKCnZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwOSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiAqIE1haW4gZXh0ZW5zaW9uIGNsYXNzIGZvciBvYnNlcnZlcnMgYW5kIHJlcG9ydGVycywgd2l0aCBjb21tb24gcHJvcGVydGllcyBhbmQgbWV0aG9kcy4KICogQ2hpbGRyZW4gbWFuYWdlbWVudCBpcyBjb21tb24gZm9yIG9ic2VydmVycyBhbmQgcmVwb3J0ZXJzLgogKi8KdmFyIERhdGFPYmplY3QgPSBmdW5jdGlvbiAoKSB7CiAgLyogcHJpdmF0ZQogIF92ZXJzaW9uOiBudW1iZXIKICAgX293bmVyOiBIeXBlcnR5VVJMCiAgX3VybDogT2JqZWN0VVJMCiAgX3NjaGVtYTogU2NoZW1hCiAgX2J1czogTWluaUJ1cwogIF9zdGF0dXM6IG9uIHwgcGF1c2VkCiAgX3N5bmNPYmo6IFN5bmNEYXRhCiAgIF9jaGlsZHJlbjogeyBpZDogRGF0YU9iamVjdENoaWxkIH0KICBfY2hpbGRyZW5MaXN0ZW5lcnM6IFtNc2dMaXN0ZW5lcl0KICAgLS0tLWV2ZW50IGhhbmRsZXJzLS0tLQogIF9vbkFkZENoaWxkSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgKi8KCiAgLyoqCiAgICogQGlnbm9yZQogICAqIFNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBieSBIeXBlcnRpZXMuIEl0J3MgY2FsbGVkIGJ5IHRoZSBTeW5jaGVyIGNyZWF0ZSBvciBzdWJzY3JpYmUgbWV0aG9kJ3MKICAgKi8KICBmdW5jdGlvbiBEYXRhT2JqZWN0KHN5bmNoZXIsIHVybCwgc2NoZW1hLCBpbml0aWFsU3RhdHVzLCBpbml0aWFsRGF0YSwgY2hpbGRyZW5zKSB7CiAgICB2YXIgbXV0dWFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDYgJiYgYXJndW1lbnRzWzZdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNl0gOiB0cnVlOwogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YU9iamVjdCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fc3luY2hlciA9IHN5bmNoZXI7CiAgICBfdGhpcy5fdXJsID0gdXJsOwogICAgX3RoaXMuX3NjaGVtYSA9IHNjaGVtYTsKICAgIF90aGlzLl9zdGF0dXMgPSBpbml0aWFsU3RhdHVzOwogICAgX3RoaXMuX3N5bmNPYmogPSBuZXcgX1Byb3h5T2JqZWN0Mi5kZWZhdWx0KGluaXRpYWxEYXRhKTsKICAgIF90aGlzLl9jaGlsZHJlbnMgPSBjaGlsZHJlbnM7CgogICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uID0gbXV0dWFsOwoKICAgIF90aGlzLl92ZXJzaW9uID0gMDsKICAgIF90aGlzLl9jaGlsZElkID0gMDsKICAgIF90aGlzLl9jaGlsZHJlbk9iamVjdHMgPSB7fTsKICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOwoKICAgIF90aGlzLl9vd25lciA9IHN5bmNoZXIuX293bmVyOwogICAgX3RoaXMuX2J1cyA9IHN5bmNoZXIuX2J1czsKICB9CgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERhdGFPYmplY3QsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGNoaWxkQmFzZVVSTCA9IF90aGlzLl91cmwgKyAnL2NoaWxkcmVuLyc7CiAgICAgIGNvbnNvbGUubG9nKCdbRGF0YSBPYmplY3QgLSBBbGxvY2F0ZUxpc3RlbmVyc10gLSAnLCBfdGhpcy5fY2hpbGRyZW5zKTsKICAgICAgaWYgKF90aGlzLl9jaGlsZHJlbnMpIHsKICAgICAgICBfdGhpcy5fY2hpbGRyZW5zLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7CiAgICAgICAgICB2YXIgY2hpbGRVUkwgPSBjaGlsZEJhc2VVUkwgKyBjaGlsZDsKICAgICAgICAgIHZhciBsaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoY2hpbGRVUkwsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZgogICAgICAgICAgICBpZiAobXNnLmZyb20gIT09IF90aGlzMi5fb3duZXIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRGF0YU9iamVjdC1DaGlsZHJlbi1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewogICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlJzoKICAgICAgICAgICAgICAgICAgX3RoaXMuX29uQ2hpbGRDcmVhdGUobXNnKTticmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7YnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICBfdGhpcy5fY2hhbmdlQ2hpbGRyZW4obXNnKTticmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVsZWFzZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikgewogICAgICAgIGxpc3RlbmVyLnJlbW92ZSgpOwogICAgICB9KTsKCiAgICAgICgwLCBfa2V5czIuZGVmYXVsdCkoX3RoaXMuX2NoaWxkcmVuT2JqZWN0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1trZXldLl9yZWxlYXNlTGlzdGVuZXJzKCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogT2JqZWN0IFVSTCBvZiByZXBvcnRlciBvciBvYnNlcnZlcgogICAgICogQHR5cGUge09iamVjdFVSTH0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdwYXVzZScsCgoKICAgIC8qKgogICAgICogQGlnbm9yZQogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2UoKSB7CiAgICAgIC8vVE9ETzogdGhpcyBmZWF0dXJlIG5lZWRzIG1vcmUgYW5hbGlzZQogICAgICB0aHJvdyAnTm90IGltcGxlbWVudGVkJzsKICAgIH0KCiAgICAvKioKICAgICAqIEBpZ25vcmUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdyZXN1bWUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZSgpIHsKICAgICAgLy9UT0RPOiB0aGlzIGZlYXR1cmUgbmVlZHMgbW9yZSBhbmFsaXNlCiAgICAgIHRocm93ICdOb3QgaW1wbGVtZW50ZWQnOwogICAgfQoKICAgIC8qKgogICAgICogQGlnbm9yZQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3N0b3AnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3AoKSB7CiAgICAgIC8vVE9ETzogc2hvdWxkIHJlbW92ZSB0aGUgc3Vic2NyaXB0aW9uIGFuZCBzZW5kIG1lc3NhZ2UgdW5zdWJzY3JpYmU/CiAgICAgIHRocm93ICdOb3QgaW1wbGVtZW50ZWQnOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuZCBhZGQgYSBEYXRhT2JqZWN0Q2hpbGQgdG8gYSBjaGlsZHJlbiBjb2xsZWN0aW9uLgogICAgICogQHBhcmFtIHtTdHJpbmd9IGNoaWxkcmVuIC0gQ2hpbGRyZW4gbmFtZSB3aGVyZSB0aGUgY2hpbGQgaXMgYWRkZWQuCiAgICAgKiBAcGFyYW0ge0pTT059IGluaXRpYWxEYXRhIC0gSW5pdGlhbCBkYXRhIG9mIHRoZSBjaGlsZAogICAgICogQHJldHVybiB7UHJvbWlzZTxEYXRhT2JqZWN0Q2hpbGQ+fSAtIFJldHVybiBQcm9taXNlIHRvIGEgbmV3IERhdGFPYmplY3RDaGlsZC4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdhZGRDaGlsZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkQ2hpbGQoY2hpbGRyZW4sIGluaXRpYWxEYXRhKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL2NyZWF0ZSBuZXcgY2hpbGQgdW5pcXVlIElELCBiYXNlZCBvbiBoeXBlcnR5VVJMCiAgICAgIF90aGlzLl9jaGlsZElkKys7CiAgICAgIHZhciBtc2dDaGlsZElkID0gX3RoaXMuX293bmVyICsgJyMnICsgX3RoaXMuX2NoaWxkSWQ7CiAgICAgIHZhciBtc2dDaGlsZFBhdGggPSBfdGhpcy5fdXJsICsgJy9jaGlsZHJlbi8nICsgY2hpbGRyZW47CgogICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IGRpcmVjdGx5IHRvIGEgcmVzb3VyY2UgY2hpbGQgYWRkcmVzczogTWVzc2FnZUJ1cwogICAgICB2YXIgcmVxdWVzdE1zZyA9IHsKICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMuX293bmVyLCB0bzogbXNnQ2hpbGRQYXRoLAogICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IG1zZ0NoaWxkSWQsIHZhbHVlOiBpbml0aWFsRGF0YSB9CiAgICAgIH07CgogICAgICAvL1RPRE86IEZvciBGdXJ0aGVyIFN0dWR5CiAgICAgIGlmICghX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uKSByZXF1ZXN0TXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBfdGhpcy5fbXV0dWFsQXV0aGVudGljYXRpb247CgogICAgICAvL3JldHVybnMgcHJvbWlzZSwgaW4gdGhlIGZ1dHVyZSwgdGhlIEFQSSBtYXkgY2hhbmdlIHRvIGFzeW5jaHJvbm91cyBjYWxsCiAgICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICB2YXIgbXNnSWQgPSBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlcXVlc3RNc2cpOwoKICAgICAgICBjb25zb2xlLmxvZygnY3JlYXRlLXJlcG9ydGVyLWNoaWxkKCAnICsgX3RoaXMuX293bmVyICsgJyApOiAnLCByZXF1ZXN0TXNnKTsKICAgICAgICB2YXIgbmV3Q2hpbGQgPSBuZXcgX0RhdGFPYmplY3RDaGlsZDIuZGVmYXVsdChfdGhpcywgbXNnQ2hpbGRJZCwgaW5pdGlhbERhdGEsIF90aGlzLl9vd25lciwgbXNnSWQpOwogICAgICAgIG5ld0NoaWxkLm9uQ2hhbmdlKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgX3RoaXMuX29uQ2hhbmdlKGV2ZW50LCB7IHBhdGg6IG1zZ0NoaWxkUGF0aCwgY2hpbGRJZDogbXNnQ2hpbGRJZCB9KTsKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1ttc2dDaGlsZElkXSA9IG5ld0NoaWxkOwoKICAgICAgICByZXNvbHZlKG5ld0NoaWxkKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgY2FsbGJhY2sgdG8gcHJvY2VzcyBjcmVhdGUgYW5kIGRlbGV0ZSBvZiBjaGlsZHJlbnMuCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnb25BZGRDaGlsZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25BZGRDaGlsZChjYWxsYmFjaykgewogICAgICB0aGlzLl9vbkFkZENoaWxkcmVuSGFuZGxlciA9IGNhbGxiYWNrOwogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3QgLT4gYWRkQ2hpbGQKCiAgfSwgewogICAga2V5OiAnX29uQ2hpbGRDcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoaWxkQ3JlYXRlKG1zZykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgbXNnQ2hpbGRJZCA9IG1zZy5ib2R5LnJlc291cmNlOwoKICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZS1vYnNlcnZlci1jaGlsZCggJyArIF90aGlzLl9vd25lciArICcgKTogJywgbXNnKTsKICAgICAgdmFyIG5ld0NoaWxkID0gbmV3IF9EYXRhT2JqZWN0Q2hpbGQyLmRlZmF1bHQoX3RoaXMsIG1zZ0NoaWxkSWQsIG1zZy5ib2R5LnZhbHVlKTsKICAgICAgX3RoaXMuX2NoaWxkcmVuT2JqZWN0c1ttc2dDaGlsZElkXSA9IG5ld0NoaWxkOwoKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgLy9GTE9XLU9VVDogd2lsbCBmbG93IHRvIERhdGFPYmplY3RDaGlsZCAtPiBfb25SZXNwb25zZQogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoewogICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCwgc291cmNlOiBfdGhpcy5fb3duZXIgfQogICAgICAgIH0pOwogICAgICB9KTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICBmcm9tOiBtc2cuZnJvbSwKICAgICAgICB1cmw6IG1zZy50bywKICAgICAgICB2YWx1ZTogbXNnLmJvZHkudmFsdWUsCiAgICAgICAgY2hpbGRJZDogbXNnQ2hpbGRJZCwKICAgICAgICBpZGVudGl0eTogbXNnLmJvZHkuaWRlbnRpdHkKICAgICAgfTsKCiAgICAgIGlmIChfdGhpcy5fb25BZGRDaGlsZHJlbkhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmxvZygnQURELUNISUxEUkVOLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgX3RoaXMuX29uQWRkQ2hpbGRyZW5IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vc2VuZCBkZWx0YSBtZXNzYWdlcyB0byBzdWJzY3JpcHRpb25zCgogIH0sIHsKICAgIGtleTogJ19vbkNoYW5nZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uQ2hhbmdlKGV2ZW50LCBjaGlsZEluZm8pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl92ZXJzaW9uKys7CgogICAgICBpZiAoX3RoaXMuX3N0YXR1cyA9PT0gJ29uJykgewogICAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgZGlyZWN0bHkgdG8gYSByZXNvdXJjZSBjaGFuZ2VzIGFkZHJlc3M6IE1lc3NhZ2VCdXMKICAgICAgICB2YXIgY2hhbmdlTXNnID0gewogICAgICAgICAgdHlwZTogJ3VwZGF0ZScsIGZyb206IF90aGlzLl91cmwsIHRvOiBfdGhpcy5fdXJsICsgJy9jaGFuZ2VzJywKICAgICAgICAgIGJvZHk6IHsgdmVyc2lvbjogX3RoaXMuX3ZlcnNpb24sIHNvdXJjZTogX3RoaXMuX293bmVyLCBhdHRyaWJ1dGU6IGV2ZW50LmZpZWxkIH0KICAgICAgICB9OwoKICAgICAgICBjb25zb2xlLmxvZygnW0RhdGFPYmplY3QgLSBfb25DaGFuZ2VdIC0gJywgZXZlbnQsIGNoaWxkSW5mbywgY2hhbmdlTXNnKTsKCiAgICAgICAgaWYgKGV2ZW50Lm9UeXBlID09PSBfUHJveHlPYmplY3QuT2JqZWN0VHlwZS5PQkpFQ1QpIHsKICAgICAgICAgIGlmIChldmVudC5jVHlwZSAhPT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuUkVNT1ZFKSB7CiAgICAgICAgICAgIGNoYW5nZU1zZy5ib2R5LnZhbHVlID0gZXZlbnQuZGF0YTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgY2hhbmdlTXNnLmJvZHkuYXR0cmlidXRlVHlwZSA9IGV2ZW50Lm9UeXBlOwogICAgICAgICAgY2hhbmdlTXNnLmJvZHkudmFsdWUgPSBldmVudC5kYXRhOwogICAgICAgICAgaWYgKGV2ZW50LmNUeXBlICE9PSBfUHJveHlPYmplY3QuQ2hhbmdlVHlwZS5VUERBVEUpIHsKICAgICAgICAgICAgY2hhbmdlTXNnLmJvZHkub3BlcmF0aW9uID0gZXZlbnQuY1R5cGU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvL2NoaWxkSW5mbyBtdXN0IGhhdmUgKHBhdGgsIGNoaWxkSWQpCiAgICAgICAgaWYgKGNoaWxkSW5mbykgewogICAgICAgICAgY2hhbmdlTXNnLnRvID0gY2hpbGRJbmZvLnBhdGg7CiAgICAgICAgICBjaGFuZ2VNc2cuYm9keS5yZXNvdXJjZSA9IGNoaWxkSW5mby5jaGlsZElkOwogICAgICAgIH0KCiAgICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgICAgIGlmICghX3RoaXMuX211dHVhbEF1dGhlbnRpY2F0aW9uKSBjaGFuZ2VNc2cuYm9keS5tdXR1YWxBdXRoZW50aWNhdGlvbiA9IF90aGlzLl9tdXR1YWxBdXRoZW50aWNhdGlvbjsKCiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShjaGFuZ2VNc2cpOwogICAgICB9CiAgICB9CgogICAgLy9GTE9XLUlOOiBkZWx0YSBtZXNzYWdlIHJlY2VpdmVkIGZyb20gYSByZW1vdGUgRGF0YU9iamVjdFJlcG9ydGVyIG9yIERhdGFPYmplY3RDaGlsZCB3aGVuIGNoYW5naW5nIGRhdGEKCiAgfSwgewogICAga2V5OiAnX2NoYW5nZU9iamVjdCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NoYW5nZU9iamVjdChzeW5jT2JqLCBtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vVE9ETzogdXBkYXRlIHZlcnNpb24gPwogICAgICAvL2hvdyB0byBoYW5kbGUgYW4gaW5jb3JyZWN0IHZlcnNpb24gPyBFeGFtcGxlOiByZWNlaXZlIGEgdmVyc2lvbiAzIHdoZW4gdGhlIG9ic2VydmVyIGlzIGluIHZlcnNpb24gMSwgd2hlcmUgaXMgdGhlIHZlcnNpb24gMiA/CiAgICAgIC8vd2lsbCB3ZSBuZWVkIHRvIGNvbmZpcm0gdGhlIHJlY2VwdGlvbiA/CiAgICAgIGlmIChfdGhpcy5fdmVyc2lvbiArIDEgPT09IG1zZy5ib2R5LnZlcnNpb24pIHsKICAgICAgICBfdGhpcy5fdmVyc2lvbisrOwogICAgICAgIHZhciBwYXRoID0gbXNnLmJvZHkuYXR0cmlidXRlOwogICAgICAgIHZhciB2YWx1ZSA9ICgwLCBfdXRpbHMuZGVlcENsb25lKShtc2cuYm9keS52YWx1ZSk7CiAgICAgICAgdmFyIGZpbmRSZXN1bHQgPSBzeW5jT2JqLmZpbmRCZWZvcmUocGF0aCk7CgogICAgICAgIGlmIChtc2cuYm9keS5hdHRyaWJ1dGVUeXBlID09PSBfUHJveHlPYmplY3QuT2JqZWN0VHlwZS5BUlJBWSkgewogICAgICAgICAgaWYgKG1zZy5ib2R5Lm9wZXJhdGlvbiA9PT0gX1Byb3h5T2JqZWN0LkNoYW5nZVR5cGUuQUREKSB7CiAgICAgICAgICAgIHZhciBhcnIgPSBmaW5kUmVzdWx0Lm9iajsKICAgICAgICAgICAgdmFyIGluZGV4ID0gZmluZFJlc3VsdC5sYXN0OwogICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuc3BsaWNlLmFwcGx5KGFyciwgW2luZGV4LCAwXS5jb25jYXQodmFsdWUpKTsKICAgICAgICAgIH0gZWxzZSBpZiAobXNnLmJvZHkub3BlcmF0aW9uID09PSBfUHJveHlPYmplY3QuQ2hhbmdlVHlwZS5SRU1PVkUpIHsKICAgICAgICAgICAgdmFyIF9hcnIgPSBmaW5kUmVzdWx0Lm9iajsKICAgICAgICAgICAgdmFyIF9pbmRleCA9IGZpbmRSZXN1bHQubGFzdDsKICAgICAgICAgICAgX2Fyci5zcGxpY2UoX2luZGV4LCB2YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmaW5kUmVzdWx0Lm9ialtmaW5kUmVzdWx0Lmxhc3RdID0gdmFsdWU7IC8vIFVQREFURQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAobXNnLmJvZHkudmFsdWUpIHsKICAgICAgICAgICAgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XSA9IHZhbHVlOyAvLyBVUERBVEUgb3IgQURECiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZWxldGUgZmluZFJlc3VsdC5vYmpbZmluZFJlc3VsdC5sYXN0XTsgLy8gUkVNT1ZFCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vVE9ETzogaG93IHRvIGhhbmRsZSB1bnN5bmNocm9uaXplZCB2ZXJzaW9ucz8KICAgICAgICBjb25zb2xlLmxvZygnVU5TWU5DSFJPTklaRUQgVkVSU0lPTjogKGRhdGEgPT4gJyArIF90aGlzLl92ZXJzaW9uICsgJywgbXNnID0+ICcgKyBtc2cuYm9keS52ZXJzaW9uICsgJyknKTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RDaGlsZCB3aGVuIGNoYW5naW5nIGRhdGEKCiAgfSwgewogICAga2V5OiAnX2NoYW5nZUNoaWxkcmVuJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hhbmdlQ2hpbGRyZW4obXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIGNvbnNvbGUubG9nKCdDaGFuZ2UgY2hpbGRyZW46ICcsIF90aGlzLl9vd25lciwgbXNnKTsKCiAgICAgIHZhciBjaGlsZElkID0gbXNnLmJvZHkucmVzb3VyY2U7CiAgICAgIHZhciBjaGlsZHJlbiA9IF90aGlzLl9jaGlsZHJlbk9iamVjdHNbY2hpbGRJZF07CgogICAgICBpZiAoY2hpbGRyZW4pIHsKICAgICAgICBfdGhpcy5fY2hhbmdlT2JqZWN0KGNoaWxkcmVuLl9zeW5jT2JqLCBtc2cpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKCdObyBjaGlsZHJlbiBmb3VuZCBmb3I6ICcsIGNoaWxkSWQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAndXJsJywKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fdXJsOwogICAgfQoKICAgIC8qKgogICAgICogT2JqZWN0IHNjaGVtYSBVUkwgKHRoaXMgZmllbGQgaXMgbm90IHlldCBzdGFibGUsIGFuZCBpcyBzdWJzamVjdCB0byBjaGFuZ2UpCiAgICAgKiBAdHlwZSB7U2NoZW1hVVJMfQogICAgICovCgogIH0sIHsKICAgIGtleTogJ3NjaGVtYScsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3NjaGVtYTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0YXR1cyBvZiB0aGUgcmVwb3J0ZXIgb3Igb2JzZXJ2ZXIgY29ubmVjdGlvbiAodGhpcyBmaWVsZCBpcyBub3QgeWV0IHN0YWJsZSwgYW5kIGlzIHN1YnNqZWN0IHRvIGNoYW5nZSkKICAgICAqIEB0eXBlIHtTdGF0dXN9IC0gRW51bSBvZjogb24gfCBwYXVzZWQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdzdGF0dXMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdGF0dXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBEYXRhIHN0cnVjdHVyZSB0byBiZSBzeW5jaHJvbml6ZWQuCiAgICAgKiBAdHlwZSB7SlNPTn0gLSBKU09OIHN0cnVjdHVyZSB0aGF0IHNob3VsZCBmb2xsb3cgdGhlIGRlZmluZWQgc2NoZW1hLCBpZiBhbnkuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAnZGF0YScsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3N5bmNPYmouZGF0YTsKICAgIH0KCiAgICAvKioKICAgICAqIEFsbCBjcmVhdGVkIGNoaWxkcmVuJ3Mgc2luY2UgdGhlIHN1YnNjcmlwdGlvbiwgZG9lc24ndCBjb250YWluIGFsbCBjaGlsZHJlbidzIHNpbmNlIHJlcG9ydGVyIGNyZWF0aW9uLgogICAgICogQHR5cGUge09iamVjdDxDaGlsZElkLCBEYXRhT2JqZWN0Q2hpbGQ+fQogICAgICovCgogIH0sIHsKICAgIGtleTogJ2NoaWxkcmVucycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuT2JqZWN0czsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFPYmplY3Q7Cn0oKTsgLyoqCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQogICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KICAgICAqCiAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICoKICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAgICAgKgogICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAgICAgKiovCgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0Owptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7Cgp2YXIgX1Byb3h5T2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMjIpOwoKdmFyIF9Qcm94eU9iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Qcm94eU9iamVjdCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiAqIFRoZSBjbGFzcyByZXR1cm5lZCBmcm9tIHRoZSBEYXRhT2JqZWN0IGFkZENoaWxkcmVuIGNhbGwgb3IgZnJvbSBvbkFkZENoaWxkcmVuIGlmIHJlbW90ZWx5IGNyZWF0ZWQuCiAqIENoaWxkcmVuIG9iamVjdCBzeW5jaHJvbml6YXRpb24gaXMgYSBhIGZhc3QgZm9yd2FyZCBtZWNoYW5pc20sIG5vIG5lZWQgZm9yIGRpcmVjdCBzdWJzY3JpcHRpb25zLCBpdCB1c2VzIHRoZSBhbHJlYWR5IGF1dGhvcml6ZWQgc3Vic2NyaXB0aW9uIGZyb20gdGhlIHBhcmVudCBEYXRhT2JqZWN0LgogKi8KdmFyIERhdGFPYmplY3RDaGlsZCAvKiBpbXBsZW1lbnRzIFN5bmNTdGF0dXMgKi8gPSBmdW5jdGlvbiAoKSB7CiAgLyogcHJpdmF0ZQogICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCiAgX29uUmVzcG9uc2VIYW5kbGVyOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAgKiBAaWdub3JlCiAgICogU2hvdWxkIG5vdCBiZSB1c2VkIGRpcmVjdGx5IGJ5IEh5cGVydGllcy4gSXQncyBjYWxsZWQgYnkgdGhlIERhdGFPYmplY3QuYWRkQ2hpbGRyZW4KICAgKi8KICBmdW5jdGlvbiBEYXRhT2JqZWN0Q2hpbGQocGFyZW50LCBjaGlsZElkLCBpbml0aWFsRGF0YSwgb3duZXIsIG1zZ0lkKSB7CiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMy5kZWZhdWx0KSh0aGlzLCBEYXRhT2JqZWN0Q2hpbGQpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX3BhcmVudCA9IHBhcmVudDsKICAgIF90aGlzLl9jaGlsZElkID0gY2hpbGRJZDsKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX21zZ0lkID0gbXNnSWQ7CgogICAgX3RoaXMuX3N5bmNPYmogPSBuZXcgX1Byb3h5T2JqZWN0Mi5kZWZhdWx0KGluaXRpYWxEYXRhKTsKCiAgICBfdGhpcy5fYnVzID0gcGFyZW50Ll9idXM7CiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsKICB9CgogICgwLCBfY3JlYXRlQ2xhc3MzLmRlZmF1bHQpKERhdGFPYmplY3RDaGlsZCwgW3sKICAgIGtleTogJ19hbGxvY2F0ZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FsbG9jYXRlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy90aGlzIGlzIG9ubHkgbmVlZGVkIGZvciBjaGlsZHJlbiByZXBvcnRlcnMKICAgICAgaWYgKF90aGlzLl9vd25lcikgewogICAgICAgIF90aGlzLl9saXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX293bmVyLCBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICBpZiAobXNnLnR5cGUgPT09ICdyZXNwb25zZScgJiYgbXNnLmlkID09PSBfdGhpcy5fbXNnSWQpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3RDaGlsZC5vblJlc3BvbnNlOicsIG1zZyk7CiAgICAgICAgICAgIF90aGlzLl9vblJlc3BvbnNlKG1zZyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoX3RoaXMuX2xpc3RlbmVyKSB7CiAgICAgICAgX3RoaXMuX2xpc3RlbmVyLnJlbW92ZSgpOwogICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWxlYXNlIGFuZCBkZWxldGUgb2JqZWN0IGRhdGEKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdkZWxldGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBkZWxldGUgX3RoaXMuX3BhcmVudC5fY2hpbGRyZW5bX3RoaXMuX2NoaWxkSWRdOwoKICAgICAgX3RoaXMuX3JlbGVhc2VMaXN0ZW5lcnMoKTsKCiAgICAgIC8vVE9ETzogc2VuZCBkZWxldGUgbWVzc2FnZSA/CiAgICB9CgogICAgLyoqCiAgICAgKiBDaGlsZHJlbiBJRCBnZW5lcmF0ZWQgb24gYWRkQ2hpbGRyZW4uIFVuaXF1ZSBpZGVudGlmaWVyCiAgICAgKiBAdHlwZSB7VVJMfSAtIFVSTCBvZiB0aGUgZm9ybWF0IDxIeXBlcnR5VVJMPiM8bnVtZXJpYy1zZXF1ZW5jZT4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbkNoYW5nZScsCgoKICAgIC8qKgogICAgICogUmVnaXN0ZXIgdGhlIGNoYW5nZSBsaXN0ZW5lcnMgc2VudCBieSB0aGUgcmVwb3J0ZXIgY2hpbGQKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oZXZlbnQ6IE1zZ0V2ZW50KX0gY2FsbGJhY2sKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hhbmdlKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuX3N5bmNPYmoub2JzZXJ2ZShmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBjYWxsYmFjayhldmVudCk7CiAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgcmVzcG9uc2Ugbm90aWZpY2F0aW9ucyBvZiB0aGUgY3JlYXRlcwogICAgICogQHBhcmFtIHtmdW5jdGlvbihldmVudDogTXNnRXZlbnQpfSBjYWxsYmFjawogICAgICovCgogIH0sIHsKICAgIGtleTogJ29uUmVzcG9uc2UnLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVzcG9uc2UoY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25SZXNwb25zZUhhbmRsZXIgPSBjYWxsYmFjazsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIHJlbW90ZSBEYXRhT2JqZWN0IC0+IF9vbkNoaWxkQ3JlYXRlCgogIH0sIHsKICAgIGtleTogJ19vblJlc3BvbnNlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZXNwb25zZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICB1cmw6IG1zZy5ib2R5LnNvdXJjZSwKICAgICAgICBjb2RlOiBtc2cuYm9keS5jb2RlCiAgICAgIH07CgogICAgICBpZiAoX3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyKSB7CiAgICAgICAgX3RoaXMuX29uUmVzcG9uc2VIYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ2NoaWxkSWQnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZElkOwogICAgfQoKICAgIC8qKgogICAgICogRGF0YSBTdHJ1Y3R1cmUgdG8gYmUgc3luY2hyb25pemVkLgogICAgICogQHR5cGUge0pTT059IC0gSlNPTiBzdHJ1Y3R1cmUgdGhhdCBzaG91bGQgZm9sbG93IHRoZSBkZWZpbmVkIHNjaGVtYSwgaWYgYW55LgogICAgICovCgogIH0sIHsKICAgIGtleTogJ2RhdGEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zeW5jT2JqLmRhdGE7CiAgICB9CiAgfV0pOwogIHJldHVybiBEYXRhT2JqZWN0Q2hpbGQ7Cn0oKTsgLyoqCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlECiAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wKICAgICAqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0EKICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcKICAgICAqIENvcHlyaWdodCAyMDE2IEFwaXplZQogICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4KICAgICAqCiAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogICAgICoKICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAgICAgKgogICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAgICAgKiovCgpleHBvcnRzLmRlZmF1bHQgPSBEYXRhT2JqZWN0Q2hpbGQ7Cm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOwoKLyoqKi8gfSksCi8qIDEyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk9iamVjdFR5cGUgPSBleHBvcnRzLkNoYW5nZVR5cGUgPSB1bmRlZmluZWQ7Cgp2YXIgX3N0cmluZ2lmeSA9IF9fd2VicGFja19yZXF1aXJlX18oNDApOwoKdmFyIF9zdHJpbmdpZnkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3RyaW5naWZ5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCnZhciBfY3JlYXRlQ2xhc3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7Cgp2YXIgX2NyZWF0ZUNsYXNzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NyZWF0ZUNsYXNzMik7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDE1Myk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKdmFyIG9iamVjdFR5cGUgPSB7IEFSUkFZOiAnW29iamVjdCBBcnJheV0nLCBPQkpFQ1Q6ICdbb2JqZWN0IE9iamVjdF0nIH07CgovKioKICogQGFjY2VzcyBwcml2YXRlCiAqIE1haW4gY2xhc3MgdGhhdCBtYWludGFpbnMgYSBKU09OIG9iamVjdCwgYW5kIG9ic2VydmVzIGNoYW5nZXMgaW4gdGhpcyBvYmplY3QsIHJlY3Vyc2l2ZWx5LgogKiBJbnRlcm5hbCBvYmplY3RzIGFuZCBhcnJheXMgYXJlIGFsc28gb2JzZXJ2ZWQuCiAqLwoKdmFyIFN5bmNPYmplY3QgPSBmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gU3luY09iamVjdChpbml0aWFsRGF0YSkgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgU3luY09iamVjdCk7CgogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfdGhpcy5fb2JzZXJ2ZXJzID0gW107CiAgICBfdGhpcy5fZmlsdGVycyA9IHt9OwoKICAgIHRoaXMuX2RhdGEgPSBpbml0aWFsRGF0YSB8fCB7fTsKCiAgICB0aGlzLl9pbnRlcm5hbE9ic2VydmUodGhpcy5fZGF0YSk7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShTeW5jT2JqZWN0LCBbewogICAga2V5OiAnb2JzZXJ2ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gb2JzZXJ2ZShjYWxsYmFjaykgewogICAgICB0aGlzLl9vYnNlcnZlcnMucHVzaChjYWxsYmFjayk7CiAgICB9CiAgfSwgewogICAga2V5OiAnZmluZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmluZChwYXRoKSB7CiAgICAgIHZhciBsaXN0ID0gcGF0aC5zcGxpdCgnLicpOwoKICAgICAgcmV0dXJuIHRoaXMuX2ZpbmRXaXRoU3BsaXQobGlzdCk7CiAgICB9CiAgfSwgewogICAga2V5OiAnZmluZEJlZm9yZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmluZEJlZm9yZShwYXRoKSB7CiAgICAgIHZhciByZXN1bHQgPSB7fTsKICAgICAgdmFyIGxpc3QgPSBwYXRoLnNwbGl0KCcuJyk7CiAgICAgIHJlc3VsdC5sYXN0ID0gbGlzdC5wb3AoKTsKICAgICAgcmVzdWx0Lm9iaiA9IHRoaXMuX2ZpbmRXaXRoU3BsaXQobGlzdCk7CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0sIHsKICAgIGtleTogJ19maW5kV2l0aFNwbGl0JywKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmluZFdpdGhTcGxpdChsaXN0KSB7CiAgICAgIHZhciBvYmogPSB0aGlzLl9kYXRhOwogICAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgb2JqID0gb2JqW3ZhbHVlXTsKICAgICAgfSk7CgogICAgICByZXR1cm4gb2JqOwogICAgfQogIH0sIHsKICAgIGtleTogJ19pc09ic2VydmFibGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9pc09ic2VydmFibGUob2JqKSB7CiAgICAgIGlmIChvYmouY29uc3RydWN0b3IgPT09IE9iamVjdCB8fCBvYmouY29uc3RydWN0b3IgPT09IEFycmF5KSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdfaW50ZXJuYWxPYnNlcnZlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfaW50ZXJuYWxPYnNlcnZlKG9iamVjdCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24gaGFuZGxlcihjaGFuZ2VzZXQpIHsKCiAgICAgICAgY2hhbmdlc2V0LmV2ZXJ5KGZ1bmN0aW9uIChjaGFuZ2UpIHsKICAgICAgICAgIF90aGlzMi5fb25DaGFuZ2VzKGNoYW5nZSk7CiAgICAgICAgfSk7CiAgICAgIH07CgogICAgICB0aGlzLl9kYXRhID0gT2JqZWN0LmRlZXBPYnNlcnZlKG9iamVjdCwgaGFuZGxlcik7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2ZpcmVFdmVudCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpcmVFdmVudChldmVudCkgewogICAgICB0aGlzLl9vYnNlcnZlcnMuZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHsKICAgICAgICBjYWxsYmFjayhldmVudCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogJ19vbkNoYW5nZXMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoYW5nZXMoY2hhbmdlKSB7CgogICAgICB2YXIgb2JqID0gY2hhbmdlLm9iamVjdDsKICAgICAgdmFyIG9ialR5cGUgPSB2b2lkIDA7CgogICAgICBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBPYmplY3QpIHsKICAgICAgICBvYmpUeXBlID0gT2JqZWN0VHlwZS5PQkpFQ1Q7CiAgICAgIH0KCiAgICAgIGlmIChvYmouY29uc3RydWN0b3IgPT09IEFycmF5KSB7CiAgICAgICAgb2JqVHlwZSA9IE9iamVjdFR5cGUuQVJSQVk7CiAgICAgIH0KCiAgICAgIHZhciBmaWVsZFN0cmluZyA9IGNoYW5nZS5rZXlwYXRoOwoKICAgICAgLy8gY29uc29sZS5sb2coJ0ZpZWxkOicsIGZpZWxkU3RyaW5nKTsKICAgICAgLy8gY29uc29sZS5sb2coJ3R5cGU6JywgY2hhbmdlLnR5cGUpOwoKICAgICAgLy9sZXQgb2xkVmFsdWUgPSBjaGFuZ2Uub2xkVmFsdWU7CiAgICAgIHZhciBuZXdWYWx1ZSA9IG9ialtjaGFuZ2UubmFtZV07CgogICAgICBjb25zb2xlLmluZm8oY2hhbmdlLnR5cGUgKyAnIHwgRmllbGQ6ICcgKyBmaWVsZFN0cmluZyArICcgfCBOZXcgVmFsdWU6JywgKDAsIF9zdHJpbmdpZnkyLmRlZmF1bHQpKG5ld1ZhbHVlKSk7CgogICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICd1cGRhdGUnKSB7CiAgICAgICAgdGhpcy5fZmlyZUV2ZW50KHsKICAgICAgICAgIGNUeXBlOiBDaGFuZ2VUeXBlLlVQREFURSwKICAgICAgICAgIG9UeXBlOiBvYmpUeXBlLAogICAgICAgICAgZmllbGQ6IGZpZWxkU3RyaW5nLAogICAgICAgICAgZGF0YTogbmV3VmFsdWUKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKGNoYW5nZS50eXBlID09PSAnYWRkJykgewogICAgICAgIHRoaXMuX2ZpcmVFdmVudCh7CiAgICAgICAgICBjVHlwZTogQ2hhbmdlVHlwZS5BREQsCiAgICAgICAgICBvVHlwZTogb2JqVHlwZSwKICAgICAgICAgIGZpZWxkOiBmaWVsZFN0cmluZywKICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChjaGFuZ2UudHlwZSA9PT0gJ2RlbGV0ZScpIHsKICAgICAgICB0aGlzLl9maXJlRXZlbnQoewogICAgICAgICAgY1R5cGU6IENoYW5nZVR5cGUuUkVNT1ZFLAogICAgICAgICAgb1R5cGU6IG9ialR5cGUsCiAgICAgICAgICBmaWVsZDogZmllbGRTdHJpbmcKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogJ2RhdGEnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9kYXRhOwogICAgfQogIH1dKTsKICByZXR1cm4gU3luY09iamVjdDsKfSgpOwoKdmFyIENoYW5nZVR5cGUgPSBleHBvcnRzLkNoYW5nZVR5cGUgPSB7IFVQREFURTogJ3VwZGF0ZScsIEFERDogJ2FkZCcsIFJFTU9WRTogJ3JlbW92ZScgfTsKdmFyIE9iamVjdFR5cGUgPSBleHBvcnRzLk9iamVjdFR5cGUgPSB7IE9CSkVDVDogJ29iamVjdCcsIEFSUkFZOiAnYXJyYXknIH07CmV4cG9ydHMuZGVmYXVsdCA9IFN5bmNPYmplY3Q7CgovKioqLyB9KSwKLyogMTIzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOwoKdmFyIF9nZXRQcm90b3R5cGVPZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpOwoKdmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7Cgp2YXIgX2dldE93blByb3BlcnR5RGVzY3JpcHRvciA9IF9fd2VicGFja19yZXF1aXJlX18oMTM4KTsKCnZhciBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldE93blByb3BlcnR5RGVzY3JpcHRvcik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7CiAgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOwogIHZhciBkZXNjID0gKDAsIF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IyLmRlZmF1bHQpKG9iamVjdCwgcHJvcGVydHkpOwoKICBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7CiAgICB2YXIgcGFyZW50ID0gKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkob2JqZWN0KTsKCiAgICBpZiAocGFyZW50ID09PSBudWxsKSB7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsKICAgIH0KICB9IGVsc2UgaWYgKCJ2YWx1ZSIgaW4gZGVzYykgewogICAgcmV0dXJuIGRlc2MudmFsdWU7CiAgfSBlbHNlIHsKICAgIHZhciBnZXR0ZXIgPSBkZXNjLmdldDsKCiAgICBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOwogIH0KfTsKCi8qKiovIH0pLAovKiAxMjQgKi8sCi8qIDEyNSAqLywKLyogMTI2ICovLAovKiAxMjcgKi8sCi8qIDEyOCAqLywKLyogMTI5ICovLAovKiAxMzAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfcHJvbWlzZSA9IF9fd2VicGFja19yZXF1aXJlX18oNzEpOwoKdmFyIF9wcm9taXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Byb21pc2UpOwoKdmFyIF9hc3NpZ24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzNik7Cgp2YXIgX2Fzc2lnbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hc3NpZ24pOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCnZhciBfRGF0YU9iamVjdFJlcG9ydGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTkpOwoKdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdFJlcG9ydGVyKTsKCnZhciBfRGF0YU9iamVjdE9ic2VydmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTgpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdE9ic2VydmVyKTsKCnZhciBfRGF0YVByb3Zpc2lvbmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMzMpOwoKdmFyIF9EYXRhUHJvdmlzaW9uYWwyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YVByb3Zpc2lvbmFsKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKKiBUaGUgbWFpbiBjbGFzcyBmb3IgdGhlIHN5bmNoZXIgcGFja2FnZS4KKiBUaGUgU3luY2hlciBpcyBhIHNpbmdsZXRvbiBjbGFzcyBwZXIgSHlwZXJ0eS9VUkwgYW5kIGl0IGlzIHRoZSBvd25lciBvZiBhbGwgY3JlYXRlZCBEYXRhIFN5bmMgT2JqZWN0cyBhY2NvcmRpbmcgdG8gdGhlIFJlcG9ydGVyIC0gT2JzZXJ2ZXIgcGF0dGVybi4KKiBNYWluIGZ1bmN0aW9uYWxpdHkgaXMgdG8gY3JlYXRlIHJlcG9ydGVycyBhbmQgdG8gc3Vic2NyaWJlIHRvIGV4aXN0aW5nIG9uZXMuCiovCnZhciBTeW5jaGVyID0gZnVuY3Rpb24gKCkgewogIC8qIHByaXZhdGUKICBfb3duZXI6IFVSTAogIF9idXM6IE1pbmlCdXMKICAgX3N1YlVSTDogVVJMCiAgIF9yZXBvcnRlcnM6IDx1cmw6IERhdGFPYmplY3RSZXBvcnRlcj4KICBfb2JzZXJ2ZXJzOiA8dXJsOiBEYXRhT2JqZWN0T2JzZXJ2ZXI+CiAgX3Byb3Zpc2lvbmFsczogPHVybDogRGF0YVByb3Zpc2lvbmFsPgogICAtLS0tZXZlbnQgaGFuZGxlcnMtLS0tCiAgX29uTm90aWZpY2F0aW9uSGFuZGxlcjogKGV2ZW50KSA9PiB2b2lkCiAgX29uUmVzdW1lOiAoZXZlbnQpID0+IHZvaWQKICAqLwoKICAvKioKICAqIENvbnN0cnVjdG9yIHRoYXQgc2hvdWxkIGJlIHVzZWQgYnkgdGhlIEh5cGVydHkgb3duZXIKICAqIEBwYXJhbSB7SHlwZXJ0eVVSTH0gb3duZXIgLSBIeXBlcnR5IFVSTCBvd25lci4gQW4gVVJMIGFsbG9jYXRlZCBieSB0aGUgcnVudGltZSB0aGF0IHVuaXF1ZWx5IGlkZW50aWZpZXMgdGhlIEh5cGVydHkuCiAgKiBAcGFyYW0ge01pbmlCdXN9IGJ1cyAtIEFuIGluc3RhbmNlIG9mIHRoZSBNaW5pQnVzIHByb3ZpZGVkIGluIHRoZSBzYW5kYm94LiBXaGVuIGFuIG9iamVjdCAoUmVwb3J0ZXIgb3IgT2JzZXJ2ZWQpIGlzIGNyZWF0ZWQsIHRoZSBTeW5jaGVyTWFuYWdlciB3aWxsIGFkZCBhIGxpc3RlbmVyIGluIHRoZSBNaW5pQnVzIHRvIHJlY2VpdmUvc2VuZCBNZXNzYWdlcyBvZiB0aGF0IG9iamVjdC4KICAqIEBwYXJhbSB7SlNPTn0gY29uZmlnIC0gQ29uZmlndXJhdGlvbiBkYXRhLiBUaGUgb25seSByZXF1aXJlZCBmaWVsZCBmb3Igbm93IGlzIHRoZSBydW50aW1lVVJMLgogICovCiAgZnVuY3Rpb24gU3luY2hlcihvd25lciwgYnVzLCBjb25maWcpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2szLmRlZmF1bHQpKHRoaXMsIFN5bmNoZXIpOwoKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX3RoaXMuX293bmVyID0gb3duZXI7CiAgICBfdGhpcy5fYnVzID0gYnVzOwoKICAgIF90aGlzLl9zdWJVUkwgPSBjb25maWcucnVudGltZVVSTCArICcvc20nOwoKICAgIF90aGlzLl9yZXBvcnRlcnMgPSB7fTsKICAgIF90aGlzLl9vYnNlcnZlcnMgPSB7fTsKICAgIF90aGlzLl9wcm92aXNpb25hbHMgPSB7fTsKCiAgICBidXMuYWRkTGlzdGVuZXIob3duZXIsIGZ1bmN0aW9uIChtc2cpIHsKICAgICAgLy9pZ25vcmUgbXNnIHNlbnQgYnkgaGltc2VsZgogICAgICBpZiAobXNnLmZyb20gIT09IG93bmVyKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCdbU3luY2hlcl0gU3luY2hlci1SQ1Y6ICcsIG1zZyk7CiAgICAgICAgc3dpdGNoIChtc2cudHlwZSkgewogICAgICAgICAgY2FzZSAnZm9yd2FyZCc6CiAgICAgICAgICAgIF90aGlzLl9vbkZvcndhcmQobXNnKTticmVhazsKICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6CiAgICAgICAgICAgIF90aGlzLl9vblJlbW90ZUNyZWF0ZShtc2cpO2JyZWFrOwogICAgICAgICAgY2FzZSAnZGVsZXRlJzoKICAgICAgICAgICAgX3RoaXMuX29uUmVtb3RlRGVsZXRlKG1zZyk7YnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9CgogIC8qKgogICogVGhlIG93bmVyIG9mIHRoZSBTeW5jaGVyIGFuZCBhbGwgY3JlYXRlZCByZXBvcnRlcnMuCiAgKiBAdHlwZSB7SHlwZXJ0eVVSTH0KICAqLwoKCiAgKDAsIF9jcmVhdGVDbGFzczMuZGVmYXVsdCkoU3luY2hlciwgW3sKICAgIGtleTogJ2NyZWF0ZScsCgoKICAgIC8qKgogICAgKiBSZXF1ZXN0IGEgRGF0YU9iamVjdFJlcG9ydGVyIGNyZWF0aW9uLiBUaGUgVVJMIHdpbGwgYmUgYmUgcmVxdWVzdGVkIGJ5IHRoZSBhbGxvY2F0aW9uIG1lY2hhbmlzbS4KICAgICogQHBhcmFtICB7U2NoZW1hVVJMfSBzY2hlbWEgLSBIeXBlcnR5IENhdGFsb2d1ZSBVUkwgYWRkcmVzcyB0aGF0IGNhbiBiZSB1c2VkIHRvIHJldHJpZXZlIHRoZSBKU09OLVNjaGVtYSBkZXNjcmliaW5nIHRoZSBEYXRhIE9iamVjdCBzY2hlbWEKICAgICogQHBhcmFtICB7SHlwZXJ0eVVSTFtdfSBvYnNlcnZlcnMgLSBMaXN0IG9mIGh5cGVydGllcyB0aGF0IGFyZSBwcmUtYXV0aG9yaXplZCBmb3Igc3Vic2NyaXB0aW9uCiAgICAqIEBwYXJhbSAge0pTT059IGluaXRpYWxEYXRhIC0gSW5pdGlhbCBkYXRhIG9mIHRoZSByZXBvcnRlcgogICAgKiBAcGFyYW0gIHtzdHJpbmd9IG9iamVjdFVSTCAtIHJldXNhYmxlIGRhdGFPYmplY3QgVVJMCiAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdFJlcG9ydGVyPn0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgUmVwb3J0ZXIuIFRoZSByZXBvcnRlciBjYW4gYmUgYWNjZXB0ZWQgb3IgcmVqZWN0ZWQgYnkgdGhlIFBFUAogICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGUoc2NoZW1hLCBvYnNlcnZlcnMsIGluaXRpYWxEYXRhKSB7CiAgICAgIHZhciBzdG9yZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogZmFsc2U7CiAgICAgIHZhciBwMnAgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IGZhbHNlOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGNyaXRlcmlhID0ge307CgogICAgICBjcml0ZXJpYS5wMnAgPSBwMnA7CiAgICAgIGNyaXRlcmlhLnN0b3JlID0gc3RvcmU7CiAgICAgIGNyaXRlcmlhLnNjaGVtYSA9IHNjaGVtYTsKICAgICAgY3JpdGVyaWEub2JzZXJ2ZXJzID0gb2JzZXJ2ZXJzOwogICAgICBjcml0ZXJpYS5pbml0aWFsRGF0YSA9IGluaXRpYWxEYXRhOwoKICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gY3JlYXRlXSAtIGNyZWF0ZSBSZXBvcnRlciAtIGNyaXRlcmlhOiAnLCBjcml0ZXJpYSk7CgogICAgICAoMCwgX2Fzc2lnbjIuZGVmYXVsdCkoY3JpdGVyaWEsIHsgcmVzdW1lOiBmYWxzZSB9KTsKCiAgICAgIHJldHVybiBfdGhpcy5fY3JlYXRlKGNyaXRlcmlhKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICdyZXN1bWVSZXBvcnRlcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZVJlcG9ydGVycyhjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdIC0gcmVzdW1lIFJlcG9ydGVyIC0gY3JpdGVyaWE6ICcsIGNyaXRlcmlhKTsKCiAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShjcml0ZXJpYSwgeyByZXN1bWU6IHRydWUgfSk7CgogICAgICByZXR1cm4gX3RoaXMuX2NyZWF0ZShjcml0ZXJpYSk7CiAgICB9CgogICAgLyoqCiAgICAqIFJlcXVlc3QgYSBzdWJzY3JpcHRpb24gdG8gYW4gZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0LgogICAgKiBAcGFyYW0ge1NjaGVtYVVSTH0gc2NoZW1hIC0gSHlwZXJ0eSBDYXRhbG9ndWUgVVJMIGFkZHJlc3MgdGhhdCBjYW4gYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgSlNPTi1TY2hlbWEgZGVzY3JpYmluZyB0aGUgRGF0YSBPYmplY3Qgc2NoZW1hCiAgICAqIEBwYXJhbSB7T2JqZWN0VVJMfSBvYmpVUkwgLSBBZGRyZXNzIG9mIHRoZSBleGlzdGVudCByZXBvcnRlciBvYmplY3QgdG8gYmUgb2JzZXJ2ZWQKICAgICogQHBhcmFtIHtCb29sZWFufSBbc3RvcmU9ZmFsc2VdIC0gU2F2ZSB0aGUgc3Vic2NyaXB0aW9uIG9uIHRoZSBTeW5jaGVyIE1hbmFnZXIgZm9yIGZ1cnRoZXIgcmVzdW1lIChEZWZhdWx0IGlzIGZhbHNlKQogICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtwMnA9ZmFsc2VdIC0gSW5mbyBhYm91dCBpZiBzaG91bGQgdXNlIHAycCBjb25uZWN0aW9uIChEZWZhdWx0IGlzIGZhbHNlKQogICAgKiBAcGFyYW0ge0Jvb2xlYW59IFttdXR1YWw9dHJ1ZV0gLSBJbmZvIGFib3V0IGlmIG1lc3NhZ2VzIG9mIHRoaXMgb2JqZWN0IHNob3VsZCBiZSBlbmNyeXB0ZWQgKERlZmF1bHQgaXMgdHJ1ZSkKICAgICogQHJldHVybiB7UHJvbWlzZTxEYXRhT2JqZWN0T2JzZXJ2ZXI+fSBSZXR1cm4gUHJvbWlzZSB0byBhIG5ldyBvYnNlcnZlci4gSXQncyBhc3NvY2lhdGVkIHdpdGggdGhlIHJlcG9ydGVyLgogICAgKi8KCiAgfSwgewogICAga2V5OiAnc3Vic2NyaWJlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBzdWJzY3JpYmUoc2NoZW1hLCBvYmpVUkwpIHsKICAgICAgdmFyIHN0b3JlID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTsKICAgICAgdmFyIHAycCA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogZmFsc2U7CiAgICAgIHZhciBtdXR1YWwgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IHRydWU7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgY3JpdGVyaWEgPSB7fTsKCiAgICAgIGNyaXRlcmlhLnAycCA9IHAycDsKICAgICAgY3JpdGVyaWEuc3RvcmUgPSBzdG9yZTsKICAgICAgY3JpdGVyaWEuc2NoZW1hID0gc2NoZW1hOwogICAgICBjcml0ZXJpYS5yZXNvdXJjZSA9IG9ialVSTDsKCiAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgY3JpdGVyaWEubXV0dWFsID0gbXV0dWFsOwoKICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyIC0gc3Vic2NyaWJlXSAtIHN1YnNjcmliZSBjcml0ZXJpYTogJywgY3JpdGVyaWEpOwoKICAgICAgKDAsIF9hc3NpZ24yLmRlZmF1bHQpKGNyaXRlcmlhLCB7IHJlc3VtZTogZmFsc2UgfSk7CgogICAgICByZXR1cm4gX3RoaXMuX3N1YnNjcmliZShjcml0ZXJpYSk7CiAgICB9CgogICAgLyoqCiAgICAqIFJlcXVlc3QgYSBzdWJzY3JpcHRpb24gdG8gYW4gZXhpc3RlbnQgcmVwb3J0ZXIgb2JqZWN0LgogICAgKiBAcGFyYW0ge2NyaXRlcmlhfSBjcml0ZXJpYSAtIEluZm9ybWF0aW9uIHRvIGRpc2NvdmVyeSB0aGUgb2JzZXJ2ZXIgb2JqZWN0CiAgICAqIEByZXR1cm4ge1Byb21pc2U8RGF0YU9iamVjdE9ic2VydmVyPn0gUmV0dXJuIFByb21pc2UgdG8gYSBuZXcgb2JzZXJ2ZXIuIEl0J3MgYXNzb2NpYXRlZCB3aXRoIHRoZSByZXBvcnRlci4KICAgICovCgogIH0sIHsKICAgIGtleTogJ3Jlc3VtZU9ic2VydmVycycsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzdW1lT2JzZXJ2ZXJzKGNyaXRlcmlhKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHZhciBfY3JpdGVyaWEgPSBjcml0ZXJpYSB8fCB7fTsKCiAgICAgICgwLCBfYXNzaWduMi5kZWZhdWx0KShfY3JpdGVyaWEsIHsgcmVzdW1lOiB0cnVlIH0pOwoKICAgICAgcmV0dXJuIF90aGlzLl9zdWJzY3JpYmUoX2NyaXRlcmlhKTsKICAgIH0KCiAgICAvKioKICAgICogUmVxdWVzdCBhIHJlYWQgYWN0aW9uIG9uIHRoZSByZXBvcnRlciBvYmplY3QKICAgICogQHBhcmFtIHtPYmplY3RVUkx9IG9ialVSTCAtIFVSTCBvZiB0aGUgcmVwb3J0ZXIgb2JqZWN0IHRvIGJlIHJlYWQKICAgICogQHJldHVybiB7UHJvbWlzZTxPYmplY3Q+fSBSZXR1cm4gUHJvbWlzZSB0byBsYXN0IGF2YWlsYWJsZSBkYXRhIG9mIHRoZSByZXBvcnRlcgogICAgKi8KCiAgfSwgewogICAga2V5OiAncmVhZCcsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZChvYmpVUkwpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgZGlyZWN0bHkgdG8gcmVwb3J0ZXIgb2JqZWN0IChtYXliZSB0aGVyZSBpcyBubyBsaXN0ZW5lciBhdmFpbGFibGUsIHNvIGl0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCBNZXNzYWdlQnVzIC0+IHJlc29sdmUpCiAgICAgIC8vd2lsbCByZWFjaCB0aGUgcmVtb3RlIG9iamVjdCBpbiBEYXRhT2JqZWN0UmVwb3J0ZXIgLT4gX29uUmVhZAogICAgICB2YXIgcmVhZE1zZyA9IHsKICAgICAgICB0eXBlOiAncmVhZCcsIGZyb206IF90aGlzLl9vd25lciwgdG86IG9ialVSTAogICAgICB9OwoKICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShyZWFkTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdyZWFkLXJlc3BvbnNlOiAnLCByZXBseSk7CiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LnZhbHVlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICogU2V0dXAgdGhlIGNhbGxiYWNrIHRvIHByb2Nlc3MgY3JlYXRlIGFuZCBkZWxldGUgZXZlbnRzIG9mIHJlbW92ZSBSZXBvcnRlciBvYmplY3RzLgogICAgKiBUaGlzIGlzIHJlbGVhdGVkIHRvIHRoZSBtZXNzYWdlbnMgc2VudCBieSBjcmVhdGUgdG8gdGhlIG9ic2VydmVycyBIeXBlcnR5IGFycmF5LgogICAgKiBAcGFyYW0ge2Z1bmN0aW9uKGV2ZW50OiBNc2dFdmVudCl9IGNhbGxiYWNrCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvbk5vdGlmaWNhdGlvbicsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Ob3RpZmljYXRpb24oY2FsbGJhY2spIHsKICAgICAgdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyID0gY2FsbGJhY2s7CiAgICB9CiAgfSwgewogICAga2V5OiAnX2NyZWF0ZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZShjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIHJlc3VtZSA9IGNyaXRlcmlhLnJlc3VtZTsKICAgICAgICB2YXIgaW5pdGlhbERhdGEgPSBjcml0ZXJpYS5pbml0aWFsRGF0YSB8fCB7fTsKICAgICAgICB2YXIgc2NoZW1hID0gdm9pZCAwOwoKICAgICAgICAvL0ZMT1ctT1VUOiB0aGlzIG1lc3NhZ2Ugd2lsbCBiZSBzZW50IHRvIHRoZSBydW50aW1lIGluc3RhbmNlIG9mIFN5bmNoZXJNYW5hZ2VyIC0+IF9vbkNyZWF0ZQogICAgICAgIHZhciByZXF1ZXN0TXNnID0gewogICAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zdWJVUkwsCiAgICAgICAgICBib2R5OiB7IHJlc3VtZTogcmVzdW1lIH0KICAgICAgICB9OwoKICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdOiAnLCBjcml0ZXJpYSwgcmVxdWVzdE1zZyk7CgogICAgICAgIHJlcXVlc3RNc2cuYm9keS52YWx1ZSA9IGluaXRpYWxEYXRhOwogICAgICAgIHJlcXVlc3RNc2cuYm9keS52YWx1ZS5yZXBvcnRlciA9IF90aGlzLl9vd25lcjsKCiAgICAgICAgaWYgKGNyaXRlcmlhLnNjaGVtYSkgewogICAgICAgICAgc2NoZW1hID0gY3JpdGVyaWEuc2NoZW1hOwogICAgICAgICAgcmVxdWVzdE1zZy5ib2R5LnNjaGVtYSA9IGNyaXRlcmlhLnNjaGVtYTsKICAgICAgICB9CgogICAgICAgIGlmIChjcml0ZXJpYS5wMnApIHJlcXVlc3RNc2cuYm9keS5wMnAgPSBjcml0ZXJpYS5wMnA7CiAgICAgICAgaWYgKGNyaXRlcmlhLnN0b3JlKSByZXF1ZXN0TXNnLmJvZHkuc3RvcmUgPSBjcml0ZXJpYS5zdG9yZTsKICAgICAgICBpZiAoY3JpdGVyaWEub2JzZXJ2ZXJzKSByZXF1ZXN0TXNnLmJvZHkuYXV0aG9yaXNlID0gY3JpdGVyaWEub2JzZXJ2ZXJzOwoKICAgICAgICBpZiAocmVzdW1lKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdIC0gcmVzdW1lIG1lc3NhZ2U6ICcsIHJlcXVlc3RNc2cpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdIC0gY3JlYXRlIG1lc3NhZ2U6ICcsIHJlcXVlc3RNc2cpOwogICAgICAgIH0KCiAgICAgICAgLy9yZXF1ZXN0IGNyZWF0ZSB0byB0aGUgYWxsb2NhdGlvbiBzeXN0ZW0uIENhbiBiZSByZWplY3RlZCBieSB0aGUgUG9saWN5RW5naW5lLgogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UocmVxdWVzdE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnW3N5bmNoZXIgLSBjcmVhdGVdIC0gY3JlYXRlLXJlc3BvbnNlOiAnLCByZXBseSk7CiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiBhY2NlcHRlZAogICAgICAgICAgICB2YXIgb2JqVVJMID0gcmVwbHkuYm9keS5yZXNvdXJjZTsKCiAgICAgICAgICAgIGlmIChyZXN1bWUpIHsKICAgICAgICAgICAgICBzY2hlbWEgPSByZXBseS5ib2R5LnNjaGVtYTsKICAgICAgICAgICAgICBpbml0aWFsRGF0YSA9IHJlcGx5LmJvZHkudmFsdWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBuZXdPYmogPSBuZXcgX0RhdGFPYmplY3RSZXBvcnRlcjIuZGVmYXVsdChfdGhpcywgb2JqVVJMLCBzY2hlbWEsICdvbicsIGluaXRpYWxEYXRhLCByZXBseS5ib2R5LmNoaWxkcmVuUmVzb3VyY2VzKTsKICAgICAgICAgICAgX3RoaXMuX3JlcG9ydGVyc1tvYmpVUkxdID0gbmV3T2JqOwoKICAgICAgICAgICAgcmVzb2x2ZShuZXdPYmopOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy9yZXBvcnRlciBjcmVhdGlvbiByZWplY3RlZAogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnX3N1YnNjcmliZScsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3N1YnNjcmliZShjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgogICAgICAgIC8vRkxPVy1PVVQ6IHRoaXMgbWVzc2FnZSB3aWxsIGJlIHNlbnQgdG8gdGhlIHJ1bnRpbWUgaW5zdGFuY2Ugb2YgU3luY2hlck1hbmFnZXIgLT4gX29uTG9jYWxTdWJzY3JpYmUKICAgICAgICB2YXIgc3Vic2NyaWJlTXNnID0gewogICAgICAgICAgdHlwZTogJ3N1YnNjcmliZScsIGZyb206IF90aGlzLl9vd25lciwgdG86IF90aGlzLl9zdWJVUkwsCiAgICAgICAgICBib2R5OiB7fQogICAgICAgIH07CgogICAgICAgIC8vIEh5cGVydHkgcmVxdWVzdCB0byBiZSBhbiBPYnNlcnZlcgogICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3Qvc3BlY3MvYmxvYi9tYXN0ZXIvbWVzc2FnZXMvZGF0YS1zeW5jLW1lc3NhZ2VzLm1kI2h5cGVydHktcmVxdWVzdC10by1iZS1hbi1vYnNlcnZlcgoKICAgICAgICAvLyBSZXN1bWUgU3Vic2NyaXB0aW9ucyBmb3IgdGhlIHNhbWUgSHlwZXJ0eSBVUkwKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNyZXN1bWUtc3Vic2NyaXB0aW9ucy1mb3ItdGhlLXNhbWUtaHlwZXJ0eS11cmwKCiAgICAgICAgLy8gUmVzdW1lIFN1YnNjcmlwdGlvbnMgZm9yIGEgY2VydGFpbiB1c2VyIGFuZCBkYXRhIHNjaGVtYSBpbmRlcGVuZGVudGx5IG9mIHRoZSBIeXBlcnR5IFVSTC4KICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L3NwZWNzL2Jsb2IvbWFzdGVyL21lc3NhZ2VzL2RhdGEtc3luYy1tZXNzYWdlcy5tZCNyZXN1bWUtc3Vic2NyaXB0aW9ucy1mb3ItYS1jZXJ0YWluLXVzZXItYW5kLWRhdGEtc2NoZW1hLWluZGVwZW5kZW50bHktb2YtdGhlLWh5cGVydHktdXJsCiAgICAgICAgaWYgKGNyaXRlcmlhKSB7CiAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ3AycCcpKSBzdWJzY3JpYmVNc2cuYm9keS5wMnAgPSBjcml0ZXJpYS5wMnA7CiAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ3N0b3JlJykpIHN1YnNjcmliZU1zZy5ib2R5LnN0b3JlID0gY3JpdGVyaWEuc3RvcmU7CiAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ3NjaGVtYScpKSBzdWJzY3JpYmVNc2cuYm9keS5zY2hlbWEgPSBjcml0ZXJpYS5zY2hlbWE7CiAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ2lkZW50aXR5JykpIHN1YnNjcmliZU1zZy5ib2R5LmlkZW50aXR5ID0gY3JpdGVyaWEuaWRlbnRpdHk7CiAgICAgICAgICBpZiAoY3JpdGVyaWEuaGFzT3duUHJvcGVydHkoJ3Jlc291cmNlJykpIHN1YnNjcmliZU1zZy5ib2R5LnJlc291cmNlID0gY3JpdGVyaWEucmVzb3VyY2U7CiAgICAgICAgfQoKICAgICAgICBzdWJzY3JpYmVNc2cuYm9keS5yZXN1bWUgPSBjcml0ZXJpYS5yZXN1bWU7CgogICAgICAgIC8vVE9ETzogRm9yIEZ1cnRoZXIgU3R1ZHkKICAgICAgICB2YXIgbXV0dWFsQXV0aGVudGljYXRpb24gPSBjcml0ZXJpYS5tdXR1YWw7CiAgICAgICAgaWYgKCFtdXR1YWxBdXRoZW50aWNhdGlvbikgc3Vic2NyaWJlTXNnLmJvZHkubXV0dWFsQXV0aGVudGljYXRpb24gPSBtdXR1YWxBdXRoZW50aWNhdGlvbjsKCiAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIHN1YnNjcmliZSBtZXNzYWdlOiAnLCBjcml0ZXJpYSwgc3Vic2NyaWJlTXNnKTsKCiAgICAgICAgLy9yZXF1ZXN0IHN1YnNjcmlwdGlvbgogICAgICAgIC8vUHJvdmlzaW9uYWwgZGF0YSBpcyBhcHBsaWVkIHRvIHRoZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgYWZ0ZXIgY29uZmlybWF0aW9uLiBPciBkaXNjYXJkZWQgaWYgdGhlcmUgaXMgbm8gY29uZmlybWF0aW9uLgogICAgICAgIC8vZm9yIG1vcmUgaW5mbyBzZWUgdGhlIERhdGFQcm92aXNpb25hbCBjbGFzcyBkb2N1bWVudGF0aW9uLgogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoc3Vic2NyaWJlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdbc3luY2hlcl0gLSBzdWJzY3JpYmUtcmVzcG9uc2U6ICcsIHJlcGx5KTsKCiAgICAgICAgICB2YXIgc2NoZW1hID0gcmVwbHkuYm9keS5zY2hlbWE7CiAgICAgICAgICB2YXIgb2JqVVJMID0gcmVwbHkuYm9keS5yZXNvdXJjZTsKCiAgICAgICAgICB2YXIgbmV3UHJvdmlzaW9uYWwgPSBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF07CiAgICAgICAgICBkZWxldGUgX3RoaXMuX3Byb3Zpc2lvbmFsc1tvYmpVUkxdOwogICAgICAgICAgaWYgKG5ld1Byb3Zpc2lvbmFsKSBuZXdQcm92aXNpb25hbC5fcmVsZWFzZUxpc3RlbmVycygpOwoKICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPCAyMDApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIG5ldyBEYXRhUHJvdmlzaW9uYWw6ICcsIHJlcGx5LmJvZHkuY2hpbGRyZW5SZXNvdXJjZXMsIG9ialVSTCk7CiAgICAgICAgICAgIG5ld1Byb3Zpc2lvbmFsID0gbmV3IF9EYXRhUHJvdmlzaW9uYWwyLmRlZmF1bHQoX3RoaXMuX293bmVyLCBvYmpVUkwsIF90aGlzLl9idXMsIHJlcGx5LmJvZHkuY2hpbGRyZW5SZXNvdXJjZXMpOwogICAgICAgICAgICBfdGhpcy5fcHJvdmlzaW9uYWxzW29ialVSTF0gPSBuZXdQcm92aXNpb25hbDsKICAgICAgICAgIH0gZWxzZSBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ1tzeW5jaGVyXSAtIG5ldyBEYXRhIE9iamVjdCBPYnNlcnZlcjogJywgcmVwbHksIF90aGlzLl9wcm92aXNpb25hbHMpOwoKICAgICAgICAgICAgLy9UT0RPOiBGb3IgRnVydGhlciBTdHVkeQogICAgICAgICAgICB2YXIgbmV3T2JqID0gbmV3IF9EYXRhT2JqZWN0T2JzZXJ2ZXIyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgc2NoZW1hLCAnb24nLCByZXBseS5ib2R5LnZhbHVlLCBuZXdQcm92aXNpb25hbC5jaGlsZHJlbiwgcmVwbHkuYm9keS52ZXJzaW9uLCBtdXR1YWxBdXRoZW50aWNhdGlvbik7CiAgICAgICAgICAgIF90aGlzLl9vYnNlcnZlcnNbb2JqVVJMXSA9IG5ld09iajsKCiAgICAgICAgICAgIHJlc29sdmUobmV3T2JqKTsKICAgICAgICAgICAgbmV3UHJvdmlzaW9uYWwuYXBwbHkobmV3T2JqKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBhIGxvY2FsIHJ1bnRpbWUgUmVwb3J0ZXJPYmplY3QgLT4gX29uUmVtb3RlU3Vic2NyaWJlCgogIH0sIHsKICAgIGtleTogJ19vbkZvcndhcmQnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkZvcndhcmQobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgcmVwb3J0ZXIgPSBfdGhpcy5fcmVwb3J0ZXJzW21zZy5ib2R5LnRvXTsKICAgICAgcmVwb3J0ZXIuX29uRm9yd2FyZChtc2cpOwogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIFN5bmNoZXIgLT4gY3JlYXRlICh0aGlzIGlzIGFjdHVhbGx5IGFuIGludml0YXRpb24gdG8gc3Vic2NyaWJlKQoKICB9LCB7CiAgICBrZXk6ICdfb25SZW1vdGVDcmVhdGUnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlbW90ZUNyZWF0ZShtc2cpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vcmVtb3ZlICIvc3Vic2NyaXB0aW9uIiBmcm9tIHRoZSBVUkwKICAgICAgdmFyIHJlc291cmNlID0gbXNnLmZyb20uc2xpY2UoMCwgLTEzKTsKCiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICB0eXBlOiBtc2cudHlwZSwKICAgICAgICBmcm9tOiBtc2cuYm9keS5zb3VyY2UsCiAgICAgICAgdXJsOiByZXNvdXJjZSwKICAgICAgICBzY2hlbWE6IG1zZy5ib2R5LnNjaGVtYSwKICAgICAgICB2YWx1ZTogbXNnLmJvZHkudmFsdWUsCiAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICBhY2s6IGZ1bmN0aW9uIGFjayh0eXBlKSB7CiAgICAgICAgICB2YXIgbFR5cGUgPSAyMDA7CiAgICAgICAgICBpZiAodHlwZSkgewogICAgICAgICAgICBsVHlwZSA9IHR5cGU7CiAgICAgICAgICB9CgogICAgICAgICAgLy9zZW5kIGFjayByZXNwb25zZSBtZXNzYWdlCiAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogbXNnLmZyb20sCiAgICAgICAgICAgIGJvZHk6IHsgY29kZTogbFR5cGUgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgaWYgKF90aGlzLl9vbk5vdGlmaWNhdGlvbkhhbmRsZXIpIHsKICAgICAgICBjb25zb2xlLmluZm8oJ1tTeW5jaGVyXSBOT1RJRklDQVRJT04tRVZFTlQ6ICcsIGV2ZW50KTsKICAgICAgICBfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgfQogICAgfQoKICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGEgcmVtb3RlIERhdGFPYmplY3RSZXBvcnRlciAtPiBkZWxldGUKCiAgfSwgewogICAga2V5OiAnX29uUmVtb3RlRGVsZXRlJywKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVEZWxldGUobXNnKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvL3JlbW92ZSAiL3N1YnNjcmlwdGlvbiIgZnJvbSB0aGUgVVJMCiAgICAgIHZhciByZXNvdXJjZSA9IG1zZy5ib2R5LnJlc291cmNlOwoKICAgICAgdmFyIG9iamVjdCA9IF90aGlzLl9vYnNlcnZlcnNbcmVzb3VyY2VdOwogICAgICBpZiAob2JqZWN0KSB7CiAgICAgICAgdmFyIGV2ZW50ID0gewogICAgICAgICAgdHlwZTogbXNnLnR5cGUsCiAgICAgICAgICB1cmw6IHJlc291cmNlLAogICAgICAgICAgaWRlbnRpdHk6IG1zZy5ib2R5LmlkZW50aXR5LAoKICAgICAgICAgIGFjazogZnVuY3Rpb24gYWNrKHR5cGUpIHsKICAgICAgICAgICAgdmFyIGxUeXBlID0gMjAwOwogICAgICAgICAgICBpZiAodHlwZSkgewogICAgICAgICAgICAgIGxUeXBlID0gdHlwZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9UT0RPOiBhbnkgb3RoZXIgZGlmZmVyZW50IG9wdGlvbnMgZm9yIHRoZSByZWxlYXNlIHByb2Nlc3MsIGxpa2UgYWNjZXB0IGJ1dCBub3IgcmVsZWFzZSBsb2NhbD8KICAgICAgICAgICAgaWYgKGxUeXBlID09PSAyMDApIHsKICAgICAgICAgICAgICBvYmplY3QuZGVsZXRlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vc2VuZCBhY2sgcmVzcG9uc2UgbWVzc2FnZQogICAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgICAgICBib2R5OiB7IGNvZGU6IGxUeXBlLCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGlmIChfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnTk9USUZJQ0FUSU9OLUVWRU5UOiAnLCBldmVudCk7CiAgICAgICAgICBfdGhpcy5fb25Ob3RpZmljYXRpb25IYW5kbGVyKGV2ZW50KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwKICAgICAgICAgIGJvZHk6IHsgY29kZTogNDA0LCBzb3VyY2U6IF90aGlzLl9vd25lciB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICdvd25lcicsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX293bmVyOwogICAgfQoKICAgIC8qKgogICAgKiBBbGwgb3duZWQgcmVwb3J0ZXJzLCB0aGUgb25lcyB0aGF0IHdlcmUgY3JlYXRlZCBieSBhIGNyZWF0ZQogICAgKiBAdHlwZSB7T2JqZWN0PFVSTCwgRGF0YU9iamVjdFJlcG9ydGVyPn0KICAgICovCgogIH0sIHsKICAgIGtleTogJ3JlcG9ydGVycycsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3JlcG9ydGVyczsKICAgIH0KCiAgICAvKioKICAgICogQWxsIG93bmVkIG9ic2VydmVycywgdGhlIG9uZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnkgYSBsb2NhbCBzdWJzY3JpcHRpb24KICAgICogQHR5cGUge09iamVjdDxVUkwsIERhdGFPYmplY3RPYnNlcnZlcj59CiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICdvYnNlcnZlcnMnLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9vYnNlcnZlcnM7CiAgICB9CiAgfV0pOwogIHJldHVybiBTeW5jaGVyOwp9KCk7IC8qKgogICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAogICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVgogICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHCiAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUKICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCiAgICAgKgogICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICAqCiAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogICAgICoKICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogICAgICoqLwoKZXhwb3J0cy5kZWZhdWx0ID0gU3luY2hlcjsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107CgovKioqLyB9KSwKLyogMTMxICovLAovKiAxMzIgKi8sCi8qIDEzMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwoKdmFyIF9jbGFzc0NhbGxDaGVjazMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGFzc0NhbGxDaGVjazIpOwoKdmFyIF9jcmVhdGVDbGFzczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTsKCnZhciBfY3JlYXRlQ2xhc3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlQ2xhc3MyKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgovKioKKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YcOnw6NvIGUgU2lzdGVtYXMgU0EKKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRAoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTAoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRwoqIENvcHlyaWdodCAyMDE2IEFwaXplZQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElOCioKKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoqKi8KCi8qKgogKiBAYWNjZXNzIHByaXZhdGUKICogVGhpcyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgY29sbGVjdGluZyBkZWx0YSBjaGFuZ2VzIGluIHJlbW90ZSBvYmplY3RzLCBiZWZvcmUgdGhlIHJlc3BvbnNlIG9mIHN1YnNjcmlwdGlvbiByZWFjaCB0aGUgb2JzZXJ2ZXIuCiAqIEl0J3MgdXNlZCBpbiBTeW5jaGVyIC0+IHN1YnNjcmliZS4gVGhlIGZsb3cgaXMgZGVmaW5lZCBhczoKICogMS4gKG9ic2VydmVyKSAtLXN1YnNjcmliZS0tPiAocmVwb3J0ZXIpCiAqIDIuIChvYnNlcnZlcikgPC0tZGVsdGEgdXBkYXRlcy0tIChyZXBvcnRlcikKICogMy4gKG9ic2VydmVyKSA8LS1zdWJzY3JpYmUgcmVzcG9uc2UtLSAocmVwb3J0ZXIpCiAqIFRoaXMgbWVhbnMgdGhhdCB0aGVyZSBjb3VsZCBiZSBkZWx0YSB1cGRhdGVzIHRyYW5zZmVycmVkIGJlZm9yZSB0aGUgc3Vic2NyaXB0aW9uIGNvbmZpcm1hdGlvbi4KICogU2luY2UgdGhlcmUgaXMgbm8gRGF0YU9iamVjdE9ic2VydmVyIGJlZm9yZSB0aGUgdWJzY3JpcHRpb24gY29uZmlybWF0aW9uLCB0aGVyZSBzaG91bGQgYmUgc29tZSBvdGhlciBvYmplY3QgY29sbGVjdGluZyB0aGUgdXBkYXRlcy4KICogUHJvdmlzaW9uYWwgZGF0YSBpcyBhcHBsaWVkIHRvIHRoZSBEYXRhT2JqZWN0T2JzZXJ2ZXIgYWZ0ZXIgY29uZmlybWF0aW9uLiBPciBkaXNjYXJkZWQgaWYgdGhlcmUgaXMgbm8gY29uZmlybWF0aW9uLgogKi8KdmFyIERhdGFQcm92aXNpb25hbCA9IGZ1bmN0aW9uICgpIHsKICAvKiBwcml2YXRlCiAgX2NoaWxkcmVuTGlzdGVuZXJzOiBbTXNnTGlzdGVuZXJdCiAgX2xpc3RlbmVyOiBNc2dMaXN0ZW5lcgogICBfY2hhbmdlczogW10KICAqLwoKICBmdW5jdGlvbiBEYXRhUHJvdmlzaW9uYWwob3duZXIsIHVybCwgYnVzLCBjaGlsZHJlbikgewogICAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgRGF0YVByb3Zpc2lvbmFsKTsKCiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF90aGlzLl9vd25lciA9IG93bmVyOwogICAgX3RoaXMuX3VybCA9IHVybDsKICAgIF90aGlzLl9idXMgPSBidXM7CiAgICBfdGhpcy5fY2hpbGRyZW4gPSBjaGlsZHJlbjsKCiAgICBfdGhpcy5fY2hhbmdlcyA9IFtdOwogICAgX3RoaXMuX2FsbG9jYXRlTGlzdGVuZXJzKCk7CiAgfQoKICAoMCwgX2NyZWF0ZUNsYXNzMy5kZWZhdWx0KShEYXRhUHJvdmlzaW9uYWwsIFt7CiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hbGxvY2F0ZUxpc3RlbmVycygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLl9saXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgewogICAgICAgIGNvbnNvbGUubG9nKCdEYXRhUHJvdmlzaW9uYWwtJyArIF90aGlzLl91cmwgKyAnLVJDVjogJywgbXNnKTsKICAgICAgICBfdGhpcy5fY2hhbmdlcy5wdXNoKG1zZyk7CiAgICAgIH0pOwoKICAgICAgLyoKICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzID0gW107CiAgICAgIGlmIChfdGhpcy5fY2hpbGRyZW4pIHsKICAgICAgICBsZXQgY2hpbGRCYXNlVVJMID0gdXJsICsgJy9jaGlsZHJlbi8nOwogICAgICAgIF90aGlzLl9jaGlsZHJlbi5mb3JFYWNoKChjaGlsZCkgPT4gewogICAgICAgICAgbGV0IGNoaWxkVVJMID0gY2hpbGRCYXNlVVJMICsgY2hpbGQ7CiAgICAgICAgICBsZXQgbGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCAobXNnKSA9PiB7CiAgICAgICAgICAgIC8vaWdub3JlIG1zZyBzZW50IGJ5IGhpbXNlbGYKICAgICAgICAgICAgaWYgKG1zZy5mcm9tICE9PSBvd25lcikgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTsKICAgICAgICB9KTsKICAgICAgfSovCiAgICB9CiAgfSwgewogICAga2V5OiAnX3JlbGVhc2VMaXN0ZW5lcnMnLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuX2xpc3RlbmVyLnJlbW92ZSgpOwoKICAgICAgLypfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXIpID0+IHsKICAgICAgICBsaXN0ZW5lci5yZW1vdmUoKTsKICAgICAgfSk7Ki8KICAgIH0KICB9LCB7CiAgICBrZXk6ICdhcHBseScsCiAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHkob2JzZXJ2ZXIpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgX3RoaXMuX2NoYW5nZXMuZm9yRWFjaChmdW5jdGlvbiAoY2hhbmdlKSB7CiAgICAgICAgb2JzZXJ2ZXIuX2NoYW5nZU9iamVjdChvYnNlcnZlci5fc3luY09iaiwgY2hhbmdlKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAnY2hpbGRyZW4nLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbjsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERhdGFQcm92aXNpb25hbDsKfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gRGF0YVByb3Zpc2lvbmFsOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCi8qKiovIH0pLAovKiAxMzQgKi8sCi8qIDEzNSAqLywKLyogMTM2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oMTQzKSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDEzNyAqLywKLyogMTM4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCm1vZHVsZS5leHBvcnRzID0geyAiZGVmYXVsdCI6IF9fd2VicGFja19yZXF1aXJlX18oMTQ1KSwgX19lc01vZHVsZTogdHJ1ZSB9OwoKLyoqKi8gfSksCi8qIDEzOSAqLywKLyogMTQwICovLAovKiAxNDEgKi8sCi8qIDE0MiAqLywKLyogMTQzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCl9fd2VicGFja19yZXF1aXJlX18oMTQ5KTsKbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApLk9iamVjdC5hc3NpZ247CgovKioqLyB9KSwKLyogMTQ0ICovLAovKiAxNDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKX193ZWJwYWNrX3JlcXVpcmVfXygxNTEpOwp2YXIgJE9iamVjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMCkuT2JqZWN0Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXsKICByZXR1cm4gJE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSk7Cn07CgovKioqLyB9KSwKLyogMTQ2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCi8vIDE5LjEuMi4xIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBzb3VyY2UsIC4uLikKdmFyIGdldEtleXMgID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNykKICAsIGdPUFMgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OCkKICAsIHBJRSAgICAgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0MSkKICAsIHRvT2JqZWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMikKICAsIElPYmplY3QgID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1NikKICAsICRhc3NpZ24gID0gT2JqZWN0LmFzc2lnbjsKCi8vIHNob3VsZCB3b3JrIHdpdGggc3ltYm9scyBhbmQgc2hvdWxkIGhhdmUgZGV0ZXJtaW5pc3RpYyBwcm9wZXJ0eSBvcmRlciAoVjggYnVnKQptb2R1bGUuZXhwb3J0cyA9ICEkYXNzaWduIHx8IF9fd2VicGFja19yZXF1aXJlX18oMTEpKGZ1bmN0aW9uKCl7CiAgdmFyIEEgPSB7fQogICAgLCBCID0ge30KICAgICwgUyA9IFN5bWJvbCgpCiAgICAsIEsgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3QnOwogIEFbU10gPSA3OwogIEsuc3BsaXQoJycpLmZvckVhY2goZnVuY3Rpb24oayl7IEJba10gPSBrOyB9KTsKICByZXR1cm4gJGFzc2lnbih7fSwgQSlbU10gIT0gNyB8fCBPYmplY3Qua2V5cygkYXNzaWduKHt9LCBCKSkuam9pbignJykgIT0gSzsKfSkgPyBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0LCBzb3VyY2UpeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzCiAgdmFyIFQgICAgID0gdG9PYmplY3QodGFyZ2V0KQogICAgLCBhTGVuICA9IGFyZ3VtZW50cy5sZW5ndGgKICAgICwgaW5kZXggPSAxCiAgICAsIGdldFN5bWJvbHMgPSBnT1BTLmYKICAgICwgaXNFbnVtICAgICA9IHBJRS5mOwogIHdoaWxlKGFMZW4gPiBpbmRleCl7CiAgICB2YXIgUyAgICAgID0gSU9iamVjdChhcmd1bWVudHNbaW5kZXgrK10pCiAgICAgICwga2V5cyAgID0gZ2V0U3ltYm9scyA/IGdldEtleXMoUykuY29uY2F0KGdldFN5bWJvbHMoUykpIDogZ2V0S2V5cyhTKQogICAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoCiAgICAgICwgaiAgICAgID0gMAogICAgICAsIGtleTsKICAgIHdoaWxlKGxlbmd0aCA+IGopaWYoaXNFbnVtLmNhbGwoUywga2V5ID0ga2V5c1tqKytdKSlUW2tleV0gPSBTW2tleV07CiAgfSByZXR1cm4gVDsKfSA6ICRhc3NpZ247CgovKioqLyB9KSwKLyogMTQ3ICovLAovKiAxNDggKi8sCi8qIDE0OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgovLyAxOS4xLjMuMSBPYmplY3QuYXNzaWduKHRhcmdldCwgc291cmNlKQp2YXIgJGV4cG9ydCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7CgokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiwgJ09iamVjdCcsIHthc3NpZ246IF9fd2VicGFja19yZXF1aXJlX18oMTQ2KX0pOwoKLyoqKi8gfSksCi8qIDE1MCAqLywKLyogMTUxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCi8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkKdmFyIHRvSU9iamVjdCAgICAgICAgICAgICAgICAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKQogICwgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IF9fd2VicGFja19yZXF1aXJlX18oNTcpLmY7CgpfX3dlYnBhY2tfcmVxdWlyZV9fKDQ1KSgnZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yJywgZnVuY3Rpb24oKXsKICByZXR1cm4gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpewogICAgcmV0dXJuICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodG9JT2JqZWN0KGl0KSwga2V5KTsKICB9Owp9KTsKCi8qKiovIH0pLAovKiAxNTIgKi8sCi8qIDE1MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CgovLyAgICAgcHJveHktb2JzZXJ2ZSB2MC4wLjE4DQovLyAgICAgQ29weXJpZ2h0IChjKSAyMDE1LCAyMDE2IFNpbW9uIFkuIEJsYWNrd2VsbCwgQW55V2hpY2hXYXkNCi8vICAgICBNSVQgTGljZW5zZSAtIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHANCihmdW5jdGlvbigpIHsNCgkidXNlIHN0cmljdCI7DQoJLy8gQ3JlYXRlcyBhbmQgcmV0dXJucyBhIFByb3h5IHdyYXBwaW5nIGEgdGFyZ2V0IHNvIHRoYXQgYWxsIGNoYW5nZXMgY2FuIGJlIHRyYXBwZWQgYW5kIGZvcndhcmRlZCB0bw0KCS8vIGEgY2FsbGJhY2suIFRoZSBjYWxsYmFjayB0YWtlcyBhbiBhcnJheSBvZiBjaGFuZ2VzIGp1c3QgbGlrZSB0aGUgdHJhZGl0aW9uYWwgb3JpZ2luYWwgQ2hyb21lIE9iamVjdC5vYnNlcnZlDQoJLy8ge29iamVjdDo8b2JqZWN0IGNoYW5nZWQ+LG5hbWU6PGZpZWxkIGNoYW5nZWQ+LHR5cGU6YWRkfHVwZGF0ZXxkZWxldGV8cmVjb25maWd1cmV8cHJldmVudEV4dGVuc2lvbnN8c2V0UHJvdG90eXBlLG9sZFZhbHVlOjxvbGQgdmFsdWUgaWYgdXBkYXRlIHwgZGVsZXRlPn0NCgkvLyBUaGUgYWNjZXB0bGlzdCBjYW4gYmUgYWRkfHVwZGF0ZXxkZWxldGV8cmVjb25maWd1cmV8cHJldmVudEV4dGVuc2lvbnN8c2V0UHJvdG90eXBlLg0KCS8vIHYgMC4wLjEwIHRvIHN1cHBvcnQgcGF1c2luZyBhbmQgcmVzdGFydGluZyBvYnNlcnZhdGlvbiB0d28gYWRkaXRpb25hbCBjb25zdHJ1Y3RvciBhcmd1bWVudHMgYXJlIGF2YWlsYWJsZSB0byBPYmplY3Qub2JzZXJ2ZToNCgkvLyBwYXVzYWJsZSAtIGNyZWF0ZSB0aGUgT2JzZXJ2ZXIgc28gaXQgY2FuIGJlIHBhdXNlZA0KCS8vIHBhdXNlIC0gY3JlYXRlIG9ic2VydmVyIGluIHBhdXNlZCBzdGF0ZQ0KCS8vIGlmIHBhdXNhYmxlIGlzIHRydWUgdGhlbiBhbiBhZGRpdGlvbmFsIG1ldGhvZCBkZWxpdmVyKGlnbm9yZVByZXZpb3VzKSBpcyBhdmFpbGFibGUgdG8gc3RhcnQgZGVsaXZlcnkNCgkvLyB0byBwYXVzZSBkZWxpdmVyeSBzZXQgYSBwcm9wZXJ0eSBjYWxsZWQgcGF1c2Ugb24gdGhlIGZ1bmN0aW9uIGRlbGl2ZXIgdG8gdHJ1ZQ0KCS8vIHBhdXNhYmxlIGlzIG9wdGlvbmFsIHRvIHJlZHVjZSB0aGUgY2hhbmNlIG9mIHNoYWRvd2luZyBhIHByb3BlcnR5IG9yIG1ldGhvZCBvbiBhbnkgZXhpc3RpbmcgY29kZSBjYWxsZWQgZGVsaXZlcg0KCWlmKCFPYmplY3Qub2JzZXJ2ZSAmJiB0eXBlb2YoUHJveHkpPT09ImZ1bmN0aW9uIikgew0KCQlmdW5jdGlvbiBPYnNlcnZlcih0YXJnZXQsY2FsbGJhY2ssYWNjZXB0bGlzdCxwYXVzYWJsZSxwYXVzZSxkZWxheSkgew0KCSAgICAJdmFyIG1lID0gdGhpcywgcHJveHk7DQoJICAgIAlmdW5jdGlvbiBkZWxpdmVyKGlnbm9yZVByZXZpb3VzLGRlbGF5KSB7DQoJICAgIAkJZGVsaXZlci5kZWxheSA9IGRlbGF5Ow0KCSAgICAJCWlmKCFkZWxpdmVyLnBhdXNlKSB7DQoJICAgICAgICAJCWlmKG1lLmNoYW5nZXNldC5sZW5ndGg+MCkgew0KCSAgICAgICAgCQkJaWYoIWlnbm9yZVByZXZpb3VzKSB7DQoJCSAgICAJICAgIAkJdmFyIGNoYW5nZXMgPSBtZS5jaGFuZ2VzZXQuZmlsdGVyKGZ1bmN0aW9uKGNoYW5nZSkgeyByZXR1cm4gIWFjY2VwdGxpc3QgfHwgYWNjZXB0bGlzdC5pbmRleE9mKGNoYW5nZS50eXBlKT49MDsgfSk7DQoJCSAgICAgICAgCQkJaWYoY2hhbmdlcy5sZW5ndGg+MCkgew0KCQkgICAgICAgIAkJCQljYWxsYmFjayhjaGFuZ2VzKTsNCgkJICAgICAgICAJCQl9DQoJICAgICAgICAJCQl9DQoJICAgICAgICAJCQltZS5jaGFuZ2VzZXQgPSBbXTsNCgkgICAgICAgIAkJfQ0KCSAgICAJCX0NCgkgICAgCX0NCgkgICAgCWRlbGl2ZXIucGF1c2UgPSBwYXVzZTsNCgkgICAgCWRlbGl2ZXIuZGVsYXkgPSBkZWxheTsNCgkJICAgIG1lLmdldCA9IGZ1bmN0aW9uKHRhcmdldCwgcHJvcGVydHkpIHsNCgkJICAgIAlpZihwcm9wZXJ0eT09PSJfX29ic2VydmVyX18iKSB7DQoJCSAgICAJCXJldHVybiBtZTsNCgkJICAgIAl9DQoJCSAgICAJaWYocHJvcGVydHk9PT0idW5vYnNlcnZlIikgew0KCQkgICAgCQlyZXR1cm4gZnVuY3Rpb24oKSB7DQoJCSAgICAJCQlPYmplY3QudW5vYnNlcnZlKHRhcmdldCk7DQoJCSAgICAJCQlyZXR1cm4gdGFyZ2V0Ow0KCQkgICAgCQl9Ow0KCQkgICAgCX0NCgkJICAgIAlpZihwcm9wZXJ0eT09PSJkZWxpdmVyIikgew0KCQkgICAgCQlyZXR1cm4gZGVsaXZlcjsNCgkJICAgIAl9DQoJCSAgICAJcmV0dXJuIHRhcmdldFtwcm9wZXJ0eV07DQoJCSAgICB9DQoJICAgIAltZS50YXJnZXQgPSB0YXJnZXQ7DQoJICAgIAltZS5jaGFuZ2VzZXQgPSBbXTsNCgkgICAgCWlmKCFtZS50YXJnZXQuX19vYnNlcnZlckNhbGxiYWNrc19fKSB7DQoJICAgIAkJLy8gX19vYnNlcnZlckNhbGxiYWNrc19fIGlzIHVzZWQgYXMgYW4gaW5kZXggdG8gZ2V0IGF0IHRoZSBwcm94eSB3aGljaCBpcyB0aGUgb2JzZXJ2ZXIsIHNvIHdlIGNhbiB1bm9ic2VydmUNCgkgICAgCQlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCJfX29ic2VydmVyQ2FsbGJhY2tzX18iLHtlbnVtZXJhYmxlOmZhbHNlLGNvbmZpZ3VyYWJsZTp0cnVlLHdyaXRhYmxlOmZhbHNlLHZhbHVlOltdfSk7DQoJICAgIAkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwiX19vYnNlcnZlcnNfXyIse2VudW1lcmFibGU6ZmFsc2UsY29uZmlndXJhYmxlOnRydWUsd3JpdGFibGU6ZmFsc2UsdmFsdWU6W119KTsNCgkgICAgCX0NCgkgICAgCW1lLnRhcmdldC5fX29ic2VydmVyQ2FsbGJhY2tzX18ucHVzaChjYWxsYmFjayk7DQoJICAgIAltZS50YXJnZXQuX19vYnNlcnZlcnNfXy5wdXNoKHRoaXMpOw0KCSAgICAJcHJveHkgPSBuZXcgUHJveHkodGFyZ2V0LG1lKTsNCgkgICAgCWRlbGl2ZXIoZmFsc2UsZGVsYXkpOw0KCSAgICAJcmV0dXJuIHByb3h5Ow0KCSAgICB9DQoJCU9ic2VydmVyLnByb3RvdHlwZS5kZWxpdmVyID0gZnVuY3Rpb24oKSB7DQoJCQlyZXR1cm4gdGhpcy5nZXQobnVsbCwiZGVsaXZlciIpOw0KCQl9DQoJICAgIE9ic2VydmVyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbih0YXJnZXQsIHByb3BlcnR5LCB2YWx1ZSkgeyAvLyAsIHJlY2VpdmVyDQoJICAgIAl2YXIgb2xkdmFsdWUgPSB0YXJnZXRbcHJvcGVydHldOw0KCSAgICAJdmFyIHR5cGUgPSAob2xkdmFsdWU9PT11bmRlZmluZWQgPyAiYWRkIiA6ICJ1cGRhdGUiKTsNCgkgICAgCXRhcmdldFtwcm9wZXJ0eV0gPSB2YWx1ZTsNCgkgICAgCWlmKHRhcmdldC5fX29ic2VydmVyc19fLmluZGV4T2YodGhpcyk+PTAgJiYgKCF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YodHlwZSk+PTApKSB7DQoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LG5hbWU6cHJvcGVydHksdHlwZTp0eXBlfSwNCgkgICAgICAgIAkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsDQoJICAgICAgICAJCWRlbGl2ZXIgPSB0aGlzLmRlbGl2ZXIoKTsNCgkgICAgICAgIAlpZih0eXBlPT09InVwZGF0ZSIpIHsNCgkgICAgICAgIAkJY2hhbmdlLm9sZFZhbHVlID0gb2xkdmFsdWU7DQoJICAgICAgICAJfQ0KCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsNCgkgICAgICAgIAlpZihzdGFydCkgew0KCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOw0KCSAgICAgICAgCX0NCgkgICAgCX0NCgkgICAgCXJldHVybiB0cnVlOw0KCSAgICB9Ow0KCSAgICBPYnNlcnZlci5wcm90b3R5cGUuZGVsZXRlUHJvcGVydHkgPSBmdW5jdGlvbih0YXJnZXQsIHByb3BlcnR5KSB7DQoJICAgIAl2YXIgb2xkdmFsdWUgPSB0YXJnZXRbcHJvcGVydHldOw0KCSAgICAJLy9pZih0eXBlb2Yob2xkdmFsdWUpIT09InVuZGVmaW5lZCIpIHsNCgkJICAgIAlkZWxldGUgdGFyZ2V0W3Byb3BlcnR5XTsNCgkJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoImRlbGV0ZSIpPj0wKSB7DQoJCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOnByb3BlcnR5LHR5cGU6ImRlbGV0ZSIsb2xkVmFsdWU6b2xkdmFsdWV9LA0KCQkgICAgICAgIAkJc3RhcnQgPSB0aGlzLmNoYW5nZXNldC5sZW5ndGggPT09IDAsDQoJCSAgICAgICAgCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7DQoJCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsNCgkJICAgICAgICAJaWYoc3RhcnQpIHsNCgkJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJCSAgICAgICAgCX0NCgkJICAgIAl9DQoJICAgIAkvL30NCgkgICAgCXJldHVybiB0cnVlOw0KCSAgICB9Ow0KCSAgICBPYnNlcnZlci5wcm90b3R5cGUuZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbih0YXJnZXQsIHByb3BlcnR5LCBkZXNjcmlwdG9yKSB7DQoJICAgIAlPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eSwgZGVzY3JpcHRvcik7DQoJICAgIAlpZih0YXJnZXQuX19vYnNlcnZlcnNfXy5pbmRleE9mKHRoaXMpPj0wICYmICF0aGlzLmFjY2VwdGxpc3QgfHwgdGhpcy5hY2NlcHRsaXN0LmluZGV4T2YoInJlY29uZmlndXJlIik+PTApIHsNCgkgICAgICAgIAl2YXIgY2hhbmdlID0ge29iamVjdDp0YXJnZXQsbmFtZTpwcm9wZXJ0eSx0eXBlOiJyZWNvbmZpZ3VyZSJ9LA0KICAgICAgICAJCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCiAgICAgICAgCQkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOw0KCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsNCgkgICAgICAgIAlpZihzdGFydCkgew0KCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOw0KCSAgICAgICAgCX0NCgkgICAgCX0NCgkgICAgCXJldHVybiB0cnVlOw0KCSAgICB9Ow0KCSAgICBPYnNlcnZlci5wcm90b3R5cGUuc2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbih0YXJnZXQsIHByb3RvdHlwZSkgew0KCSAgICAJdmFyIG9sZHZhbHVlID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHRhcmdldCk7DQoJICAgIAlPYmplY3Quc2V0UHJvdG90eXBlT2YodGFyZ2V0LCBwcm90b3R5cGUpOw0KCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJzZXRQcm90b3R5cGUiKT49MCkgew0KCSAgICAgICAgCXZhciBjaGFuZ2UgPSB7b2JqZWN0OnRhcmdldCxuYW1lOiJfX3Byb3RvX18iLHR5cGU6InNldFByb3RvdHlwZSIsb2xkVmFsdWU6b2xkdmFsdWV9LA0KICAgIAkJCQlzdGFydCA9IHRoaXMuY2hhbmdlc2V0Lmxlbmd0aCA9PT0gMCwNCiAgICAJCQkJZGVsaXZlciA9IHRoaXMuZGVsaXZlcigpOw0KCSAgICAgICAgCXRoaXMuY2hhbmdlc2V0LnB1c2goY2hhbmdlKTsNCgkgICAgICAgIAlpZihzdGFydCkgew0KCSAgICAgICAgCQlkZWxpdmVyKGZhbHNlLCh0eXBlb2YoZGVsaXZlci5kZWxheSk9PT0ibnVtYmVyIiA/IGRlbGl2ZXIuZGVsYXkgOiAxMCkpOw0KCSAgICAgICAgCX0NCgkgICAgCX0NCgkgICAgCXJldHVybiB0cnVlOw0KCSAgICB9Ow0KCSAgICBPYnNlcnZlci5wcm90b3R5cGUucHJldmVudEV4dGVuc2lvbnMgPSBmdW5jdGlvbih0YXJnZXQpIHsNCgkgICAgICAgIE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh0YXJnZXQpOw0KCSAgICAJaWYodGFyZ2V0Ll9fb2JzZXJ2ZXJzX18uaW5kZXhPZih0aGlzKT49MCAmJiAhdGhpcy5hY2NlcHRsaXN0IHx8IHRoaXMuYWNjZXB0bGlzdC5pbmRleE9mKCJwcmV2ZW50RXh0ZW5zaW9ucyIpPj0wKSB7DQoJICAgICAgICAJdmFyIGNoYW5nZSA9IHtvYmplY3Q6dGFyZ2V0LHR5cGU6InByZXZlbnRFeHRlbnNpb25zIn0sDQoJCQkJCXN0YXJ0ID0gdGhpcy5jaGFuZ2VzZXQubGVuZ3RoID09PSAwLA0KCQkJCQlkZWxpdmVyID0gdGhpcy5kZWxpdmVyKCk7DQoJICAgICAgICAJdGhpcy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCSAgICAgICAgCWlmKHN0YXJ0KSB7DQoJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJICAgICAgICAJfQ0KCSAgICAJfQ0KCSAgICAJcmV0dXJuIHRydWU7DQoJICAgIH07DQoJICAgIE9iamVjdC5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpIHsNCgkgICAgCXJldHVybiBuZXcgT2JzZXJ2ZXIob2JqZWN0LGNhbGxiYWNrLGFjY2VwdGxpc3QscGF1c2FibGUscGF1c2UsZGVsYXkpOw0KCSAgICB9Ow0KCSAgICBPYmplY3QudW5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrKSB7DQoJICAgIAlpZihvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fKSB7DQoJICAgIAkJaWYoIWNhbGxiYWNrKSB7DQoJICAgIAkJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uc3BsaWNlKDAsb2JqZWN0Ll9fb2JzZXJ2ZXJDYWxsYmFja3NfXy5sZW5ndGgpOw0KCSAgICAJCQlvYmplY3QuX19vYnNlcnZlcnNfXy5zcGxpY2UoMCxvYmplY3QuX19vYnNlcnZlcnNfXy5sZW5ndGgpOw0KCSAgICAJCQlyZXR1cm47DQoJICAgIAkJfQ0KCSAgICAJCW9iamVjdC5fX29ic2VydmVyQ2FsbGJhY2tzX18uZm9yRWFjaChmdW5jdGlvbihvYnNlcnZlcmNhbGxiYWNrLGkpIHsNCgkgICAgCQkJaWYoY2FsbGJhY2s9PT1vYnNlcnZlcmNhbGxiYWNrKSB7DQoJICAgIAkJCQlvYmplY3QuX19vYnNlcnZlckNhbGxiYWNrc19fLnNwbGljZShpLDEpOw0KCSAgICAJCQkJZGVsZXRlIG9iamVjdC5fX29ic2VydmVyc19fW2ldLmNhbGxiYWNrOw0KCSAgICAJCQkJb2JqZWN0Ll9fb2JzZXJ2ZXJzX18uc3BsaWNlKGksMSk7DQoJICAgIAkJCX0NCgkgICAgCQl9KTsNCgkgICAgCX0NCgkgICAgfTsNCgkgICAgQXJyYXkub2JzZXJ2ZSA9IGZ1bmN0aW9uKG9iamVjdCxjYWxsYmFjayxhY2NlcHRsaXN0LHBhdXNhYmxlLHBhdXNlLGRlbGF5KSB7DQoJICAgIAlpZighKG9iamVjdCBpbnN0YW5jZW9mIEFycmF5KSAmJiAhQXJyYXkuaXNBcnJheShvYmplY3QpKSB7DQoJICAgIAkJdGhyb3cgbmV3IFR5cGVFcnJvcigiRmlyc3QgYXJndW1lbnQgdG8gQXJyYXkub2JzZXJ2ZXIgaXMgbm90IGFuIEFycmF5Iik7DQoJICAgIAl9DQogICAgICAgICAgICAJYWNjZXB0bGlzdCA9IGFjY2VwdGxpc3QgfHwgWyJhZGQiLCAidXBkYXRlIiwgImRlbGV0ZSIsICJzcGxpY2UiXTsNCgkgICAgCXZhciBhcnJheXByb3h5ID0gbmV3IFByb3h5KG9iamVjdCx7Z2V0OiBmdW5jdGlvbih0YXJnZXQscHJvcGVydHkpIHsNCgkgICAgCQlpZihwcm9wZXJ0eT09PSJ1bm9ic2VydmUiKSB7DQoJCSAgICAJCXJldHVybiBmdW5jdGlvbihjYWxsYmFjaykgew0KCQkgICAgCQkJaWYoY2FsbGJhY2spIHsNCgkJICAgIAkJCQlyZXR1cm4gT2JqZWN0LnVub2JzZXJ2ZSh0YXJnZXQsY2FsbGJhY2spOw0KCQkgICAgCQkJfQ0KCQkgICAgCQkJcmV0dXJuIHRhcmdldC51bm9ic2VydmUoKTsNCgkJICAgIAkJfTsNCgkJICAgIAl9DQoJICAgIAkJaWYocHJvcGVydHk9PT0ic3BsaWNlIikgew0KCSAgICAJCQlyZXR1cm4gZnVuY3Rpb24oc3RhcnQsZW5kKSB7DQoJICAgIAkJCQlpZih0eXBlb2Yoc3RhcnQpIT09Im51bWJlciIgfHwgdHlwZW9mKGVuZCkhPT0ibnVtYmVyIikgew0KCSAgICAJCQkJCXRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IHR3byBhcmd1bWVudHMgdG8gQXJyYXkgc3BsaWNlIGFyZSBub3QgbnVtYmVyLCBudW1iZXIiKTsNCgkgICAgCQkJCX0NCgkgICAgCSAgICAJCXZhciByZW1vdmVkID0gdGhpcy5zbGljZShzdGFydCxzdGFydCtlbmQpLA0KCSAgICAJICAgIAkJCWFkZGVkQ291bnQgPSAoYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHMubGVuZ3RoLTIgOiAwKSwNCgkgICAgCSAgICAJCQljaGFuZ2UgPSAge29iamVjdDpvYmplY3QsdHlwZToic3BsaWNlIixpbmRleDpzdGFydCxyZW1vdmVkOnJlbW92ZWQsYWRkZWRDb3VudDphZGRlZENvdW50fTsNCgkgICAgCSAgICAJCXRhcmdldC5zcGxpY2UuYXBwbHkodGFyZ2V0LGFyZ3VtZW50cyk7DQoJICAgIAkgICAgCQlpZihhY2NlcHRsaXN0LmluZGV4T2YoInNwbGljZSIpPj0wKSB7DQoJICAgIAkgICAgCQkJdmFyIHN0YXJ0ID0gcHJveHkuX19vYnNlcnZlcl9fLmNoYW5nZXNldC5sZW5ndGggPT09IDAsDQoJICAgIAkgICAgICAgIAkJCWRlbGl2ZXIgPSBwcm94eS5fX29ic2VydmVyX18uZGVsaXZlcigpOw0KCSAgICAJICAgIAkJCXByb3h5Ll9fb2JzZXJ2ZXJfXy5jaGFuZ2VzZXQucHVzaChjaGFuZ2UpOw0KCSAgICAJICAgIAkJCWlmKHN0YXJ0KSB7DQoJICAgIAkJICAgICAgICAJCWRlbGl2ZXIoZmFsc2UsKHR5cGVvZihkZWxpdmVyLmRlbGF5KT09PSJudW1iZXIiID8gZGVsaXZlci5kZWxheSA6IDEwKSk7DQoJICAgIAkJICAgICAgICAJfQ0KCSAgICAJICAgIAkJfQ0KCSAgICAJICAgIAl9DQoJICAgIAkJfQ0KCSAgICAJCWlmKHByb3BlcnR5PT09InB1c2giKSB7DQoJICAgIAkJCSByZXR1cm4gZnVuY3Rpb24oaXRlbSkgew0KCSAgICAJCSAgICAJcmV0dXJuIHRoaXMuc3BsaWNlKHRoaXMubGVuZ3RoLDAsaXRlbSk7DQoJICAgIAkJICAgIH0NCgkgICAgCQl9DQoJICAgIAkJaWYocHJvcGVydHk9PT0icG9wIikgew0KCSAgICAJCQkgcmV0dXJuIGZ1bmN0aW9uKCkgew0KCSAgICAJCSAgICAJcmV0dXJuIHRoaXMuc3BsaWNlKHRoaXMubGVuZ3RoLTEsMSk7DQoJICAgIAkJICAgIH0NCgkgICAgCQl9DQoJICAgIAkJaWYocHJvcGVydHk9PT0idW5zaGlmdCIpIHsNCgkgICAgCQkJIHJldHVybiBmdW5jdGlvbihpdGVtKSB7DQogICAgCQkgICAgCQlyZXR1cm4gdGhpcy5zcGxpY2UoMCwwLGl0ZW0pOw0KICAgIAkJICAgIAl9DQoJICAgIAkJfQ0KCSAgICAJCWlmKHByb3BlcnR5PT09InNoaWZ0Iikgew0KCSAgICAJCQlyZXR1cm4gZnVuY3Rpb24oKSB7DQoJICAgIAkgICAgCQlyZXR1cm4gdGhpcy5zcGxpY2UoMCwxKTsNCgkgICAgCSAgICAJfQ0KCSAgICAJCX0NCgkgICAgCQlyZXR1cm4gdGFyZ2V0W3Byb3BlcnR5XTsNCgkgICAgCX19KTsNCgkgICAgCXZhciBwcm94eSA9IE9iamVjdC5vYnNlcnZlKGFycmF5cHJveHksZnVuY3Rpb24oY2hhbmdlc2V0KSB7IA0KCSAgICAJCXZhciBjaGFuZ2VzID0gY2hhbmdlc2V0LmZpbHRlcihmdW5jdGlvbihjaGFuZ2UpIHsgcmV0dXJuIGNoYW5nZS5uYW1lIT09Imxlbmd0aCIgJiYgY2hhbmdlLm5hbWUhPT0iYWRkIiAmJiAoIWFjY2VwdGxpc3QgfHwgYWNjZXB0bGlzdC5pbmRleE9mKGNoYW5nZS50eXBlKT49MCk7IH0pOw0KCSAgICAJCWlmKGNoYW5nZXMubGVuZ3RoPjApIHsNCgkgICAgCQkJY2FsbGJhY2soY2hhbmdlcyk7DQoJICAgIAkJfQ0KCSAgICAJfSxhY2NlcHRsaXN0LHBhdXNhYmxlLHBhdXNlLGRlbGF5KTsNCgkgICAgCXJldHVybiBwcm94eTsNCgkgICAgfTsNCgkgICAgQXJyYXkudW5vYnNlcnZlID0gZnVuY3Rpb24ob2JqZWN0LGNhbGxiYWNrKSB7DQoJCSAgcmV0dXJuIG9iamVjdC51bm9ic2VydmUoY2FsbGJhY2spOw0KCSAgICB9DQoJfQ0KCU9iamVjdC5kZWVwT2JzZXJ2ZSA9IGZ1bmN0aW9uKG9iamVjdCxjYWxsYmFjayxwYXJ0cykgew0KDQoJCXBhcnRzID0gKHBhcnRzID8gcGFydHMgOiBbXSk7DQoNCgkJdmFyIHRvVHlwZU5hbWUgPSBmdW5jdGlvbihvYmopIHsNCgkJCXJldHVybiAoe30pLnRvU3RyaW5nLmNhbGwob2JqKS5tYXRjaCgvXHMoW2EtekEtWl0rKS8pWzFdLnRvTG93ZXJDYXNlKCkNCgkJfQ0KDQoJCWZ1bmN0aW9uIHJlb2JzZXJ2ZSh2YWx1ZSwgcGFydHMpIHsNCgkJCXZhciBrZXlzID0gT2JqZWN0LmtleXModmFsdWUpOw0KCQkJa2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgew0KCQkJCWlmKCh0b1R5cGVOYW1lKHZhbHVlW2tleV0pID09PSAnb2JqZWN0JyB8fCB0b1R5cGVOYW1lKHZhbHVlW2tleV0pID09PSAnYXJyYXknKSAmJiAhdmFsdWVba2V5XS5oYXNPd25Qcm9wZXJ0eSgnX19vYnNlcnZlcnNfXycpKSB7DQoJCQkJCXZhciBuZXdwYXJ0cyA9IHBhcnRzLnNsaWNlKDApOw0KCQkJCQluZXdwYXJ0cy5wdXNoKGtleSk7DQoJCQkJCXZhbHVlW2tleV0gPSBPYmplY3QuZGVlcE9ic2VydmUodmFsdWVba2V5XSxjYWxsYmFjayxuZXdwYXJ0cyk7DQoJCQkJfQ0KCQkJfSk7DQoJCX0NCg0KCQlyZW9ic2VydmUob2JqZWN0LCBwYXJ0cyk7DQoNCgkJdmFyIG9ic2VydmVkID0gT2JqZWN0Lm9ic2VydmUob2JqZWN0LGZ1bmN0aW9uKGNoYW5nZXNldCkgew0KCQkJdmFyIGNoYW5nZXMgPSBbXTsNCgkJCWZ1bmN0aW9uIHJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZE9iamVjdCxuZXdPYmplY3QscGF0aCkgew0KCQkJCWlmKG5ld09iamVjdCBpbnN0YW5jZW9mIE9iamVjdCkgew0KCQkJCQl2YXIgbmV3a2V5cyA9IE9iamVjdC5rZXlzKG5ld09iamVjdCk7DQoJCQkJCW5ld2tleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHsNCgkJCQkJCWlmKCFvbGRPYmplY3QgfHwgKG9sZE9iamVjdFtrZXldIT09bmV3T2JqZWN0W2tleV0pKSB7DQoJCQkJCQkJdmFyIG9sZHZhbHVlID0gKG9sZE9iamVjdCAmJiBvbGRPYmplY3Rba2V5XSE9PXVuZGVmaW5lZCA/IG9sZE9iamVjdFtrZXldIDogdW5kZWZpbmVkKSwNCgkJCQkJCQkJY2hhbmdlID0gKG9sZHZhbHVlPT09dW5kZWZpbmVkID8gImFkZCIgOiAidXBkYXRlIiksDQoJCQkJCQkJCWtleXBhdGggPSBwYXRoICsgIi4iICsga2V5Ow0KDQoJCQkJCQkJY2hhbmdlcy5wdXNoKHtuYW1lOm5hbWUsb2JqZWN0OnJvb3RPYmplY3QsdHlwZTpjaGFuZ2Usb2xkVmFsdWU6b2xkdmFsdWUsbmV3VmFsdWU6bmV3T2JqZWN0W2tleV0sa2V5cGF0aDprZXlwYXRofSk7DQoJCQkJCQkJcmVjdXJzZShuYW1lLHJvb3RPYmplY3Qsb2xkdmFsdWUsbmV3T2JqZWN0W2tleV0sa2V5cGF0aCk7DQoJCQkJCQl9DQoJCQkJCX0pOw0KCQkJCX0gZWxzZSBpZihvbGRPYmplY3QgaW5zdGFuY2VvZiBPYmplY3QpIHsNCgkJCQkJdmFyIG9sZGtleXMgPSBPYmplY3Qua2V5cyhvbGRPYmplY3QpOw0KCQkJCQlvbGRrZXlzLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7DQoJCQkJCQl2YXIgY2hhbmdlID0gKG5ld09iamVjdD09PW51bGwgPyAidXBkYXRlIiA6ICJkZWxldGUiKSwNCgkJCQkJCQlrZXlwYXRoID0gcGF0aCArICIuIiArIGtleTsNCgkJCQkJCQkNCgkJCQkJCWNoYW5nZXMucHVzaCh7bmFtZTpuYW1lLG9iamVjdDpyb290T2JqZWN0LHR5cGU6Y2hhbmdlLG9sZFZhbHVlOm9sZE9iamVjdFtrZXldLG5ld1ZhbHVlOm5ld09iamVjdCxrZXlwYXRoOmtleXBhdGh9KTsNCgkJCQkJCXJlY3Vyc2UobmFtZSxyb290T2JqZWN0LG9sZE9iamVjdFtrZXldLHVuZGVmaW5lZCxrZXlwYXRoKTsNCgkJCQkJfSk7DQoJCQkJfQ0KCQkJfQ0KCQkJY2hhbmdlc2V0LmZvckVhY2goZnVuY3Rpb24oY2hhbmdlKSB7DQoJCQkJdmFyIGtleXBhdGggPSAocGFydHMubGVuZ3RoPjAgPyBwYXJ0cy5qb2luKCIuIikgKyAiLiIgOiAiIikgKyBjaGFuZ2UubmFtZTsNCg0KCQkJCWlmIChjaGFuZ2UudHlwZSA9PT0gInVwZGF0ZSIgfHwgY2hhbmdlLnR5cGUgPT09ICJhZGQiKSB7IA0KCQkJCQlyZW9ic2VydmUoY2hhbmdlLm9iamVjdCwgcGFydHMpOw0KCQkJCX0NCg0KCQkJCWNoYW5nZXMucHVzaCh7bmFtZTpjaGFuZ2UubmFtZSxvYmplY3Q6Y2hhbmdlLm9iamVjdCx0eXBlOmNoYW5nZS50eXBlLG9sZFZhbHVlOmNoYW5nZS5vbGRWYWx1ZSxuZXdWYWx1ZTpjaGFuZ2Uub2JqZWN0W2NoYW5nZS5uYW1lXSxrZXlwYXRoOmtleXBhdGh9KTsNCgkJCQlyZWN1cnNlKGNoYW5nZS5uYW1lLGNoYW5nZS5vYmplY3QsY2hhbmdlLm9sZFZhbHVlLGNoYW5nZS5vYmplY3RbY2hhbmdlLm5hbWVdLGtleXBhdGgpOw0KCQkJfSk7DQoJCQljYWxsYmFjayhjaGFuZ2VzKTsNCgkJfSk7DQoJCXJldHVybiBvYnNlcnZlZDsNCgl9Ow0KfSkoKTsNCgoKLyoqKi8gfSksCi8qIDE1NCAqLywKLyogMTU1ICovLAovKiAxNTYgKi8sCi8qIDE1NyAqLywKLyogMTU4ICovLAovKiAxNTkgKi8sCi8qIDE2MCAqLywKLyogMTYxICovLAovKiAxNjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5EYXRhT2JqZWN0T2JzZXJ2ZXIgPSBleHBvcnRzLkRhdGFPYmplY3RSZXBvcnRlciA9IGV4cG9ydHMuU3luY2hlciA9IHVuZGVmaW5lZDsKCnZhciBfU3luY2hlciA9IF9fd2VicGFja19yZXF1aXJlX18oMTMwKTsKCnZhciBfU3luY2hlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9TeW5jaGVyKTsKCnZhciBfRGF0YU9iamVjdFJlcG9ydGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTkpOwoKdmFyIF9EYXRhT2JqZWN0UmVwb3J0ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdFJlcG9ydGVyKTsKCnZhciBfRGF0YU9iamVjdE9ic2VydmVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMTgpOwoKdmFyIF9EYXRhT2JqZWN0T2JzZXJ2ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRGF0YU9iamVjdE9ic2VydmVyKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLlN5bmNoZXIgPSBfU3luY2hlcjIuZGVmYXVsdDsKZXhwb3J0cy5EYXRhT2JqZWN0UmVwb3J0ZXIgPSBfRGF0YU9iamVjdFJlcG9ydGVyMi5kZWZhdWx0OwpleHBvcnRzLkRhdGFPYmplY3RPYnNlcnZlciA9IF9EYXRhT2JqZWN0T2JzZXJ2ZXIyLmRlZmF1bHQ7CgovKioqLyB9KQovKioqKioqLyBdKTsKfSk7Cgp9LHt9XSw2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKbW9kdWxlLmV4cG9ydHM9ewogICJfYXJncyI6IFsKICAgIFsKICAgICAgInNpcC5qc0AwLjcuNSIsCiAgICAgICJDOlxcUHJvamVjdG9zXFxyZVRISU5LXFxXUDNcXGdpdFxcZGV2LXByb3Rvc3R1YnNcXHNyY1xccHJvdG9zdHViXFxpbXNfaXciCiAgICBdCiAgXSwKICAiX2Zyb20iOiAic2lwLmpzQDAuNy41IiwKICAiX2lkIjogInNpcC5qc0AwLjcuNSIsCiAgIl9pbkNhY2hlIjogdHJ1ZSwKICAiX2luc3RhbGxhYmxlIjogdHJ1ZSwKICAiX2xvY2F0aW9uIjogIi9zaXAuanMiLAogICJfbm9kZVZlcnNpb24iOiAiNC40LjMiLAogICJfbnBtT3BlcmF0aW9uYWxJbnRlcm5hbCI6IHsKICAgICJob3N0IjogInBhY2thZ2VzLTEyLXdlc3QuaW50ZXJuYWwubnBtanMuY29tIiwKICAgICJ0bXAiOiAidG1wL3NpcC5qcy0wLjcuNS50Z3pfMTQ2MTU5NDQxODY5MF8wLjU4Mzk5MzMxMjQzNzA4NzMiCiAgfSwKICAiX25wbVVzZXIiOiB7CiAgICAiZW1haWwiOiAiMTIxMmp0cmFjZXVyQGdtYWlsLmNvbSIsCiAgICAibmFtZSI6ICJqb3NlcGhmcmF6aWVyIgogIH0sCiAgIl9ucG1WZXJzaW9uIjogIjIuMTUuMSIsCiAgIl9waGFudG9tQ2hpbGRyZW4iOiB7fSwKICAiX3JlcXVlc3RlZCI6IHsKICAgICJuYW1lIjogInNpcC5qcyIsCiAgICAicmF3IjogInNpcC5qc0AwLjcuNSIsCiAgICAicmF3U3BlYyI6ICIwLjcuNSIsCiAgICAic2NvcGUiOiBudWxsLAogICAgInNwZWMiOiAiMC43LjUiLAogICAgInR5cGUiOiAidmVyc2lvbiIKICB9LAogICJfcmVxdWlyZWRCeSI6IFsKICAgICIvIgogIF0sCiAgIl9yZXNvbHZlZCI6ICJodHRwczovL3JlZ2lzdHJ5Lm5wbWpzLm9yZy9zaXAuanMvLS9zaXAuanMtMC43LjUudGd6IiwKICAiX3NoYXN1bSI6ICI4NmFjZTcwNTE1OTRmOTFiNDU1MWJkYjgxMjBhMTZjNDQ5NjJkM2EyIiwKICAiX3Nocmlua3dyYXAiOiBudWxsLAogICJfc3BlYyI6ICJzaXAuanNAMC43LjUiLAogICJfd2hlcmUiOiAiQzpcXFByb2plY3Rvc1xccmVUSElOS1xcV1AzXFxnaXRcXGRldi1wcm90b3N0dWJzXFxzcmNcXHByb3Rvc3R1YlxcaW1zX2l3IiwKICAiYXV0aG9yIjogewogICAgImVtYWlsIjogImRldmVsb3BlckBvbnNpcC5jb20iLAogICAgIm5hbWUiOiAiT25TSVAiLAogICAgInVybCI6ICJodHRwOi8vc2lwanMuY29tL2F1dGhvcnMvIgogIH0sCiAgImJyb3dzZXIiOiB7CiAgICAiLi9zcmMvZW52aXJvbm1lbnQuanMiOiAiLi9zcmMvZW52aXJvbm1lbnRfYnJvd3Nlci5qcyIKICB9LAogICJidWdzIjogewogICAgInVybCI6ICJodHRwczovL2dpdGh1Yi5jb20vb25zaXAvU0lQLmpzL2lzc3VlcyIKICB9LAogICJjb250cmlidXRvcnMiOiBbCiAgICB7CiAgICAgICJ1cmwiOiAiaHR0cHM6Ly9naXRodWIuY29tL29uc2lwL1NJUC5qcy9ibG9iL21hc3Rlci9USEFOS1MubWQiCiAgICB9CiAgXSwKICAiZGVwZW5kZW5jaWVzIjogewogICAgInByb21pc2N1b3VzIjogIl4wLjYuMCIsCiAgICAid3MiOiAiXjAuNi40IgogIH0sCiAgImRlc2NyaXB0aW9uIjogIkEgc2ltcGxlLCBpbnR1aXRpdmUsIGFuZCBwb3dlcmZ1bCBKYXZhU2NyaXB0IHNpZ25hbGluZyBsaWJyYXJ5IiwKICAiZGV2RGVwZW5kZW5jaWVzIjogewogICAgImJlZWZ5IjogIl4yLjEuNSIsCiAgICAiYnJvd3NlcmlmeSI6ICJeNC4xLjgiLAogICAgImdydW50IjogIn4wLjQuMCIsCiAgICAiZ3J1bnQtYnJvd3NlcmlmeSI6ICJeNC4wLjEiLAogICAgImdydW50LWNsaSI6ICJ+MC4xLjYiLAogICAgImdydW50LWNvbnRyaWItY29weSI6ICJeMC41LjAiLAogICAgImdydW50LWNvbnRyaWItamFzbWluZSI6ICJeMC45LjIiLAogICAgImdydW50LWNvbnRyaWItanNoaW50IjogIj4wLjUuMCIsCiAgICAiZ3J1bnQtY29udHJpYi11Z2xpZnkiOiAifjAuMi4wIiwKICAgICJncnVudC1wZWciOiAifjEuMy4xIiwKICAgICJncnVudC10cmltdHJhaWxpbmdzcGFjZXMiOiAiXjAuNC4wIiwKICAgICJwZWdqcyI6ICJeMC44LjAiCiAgfSwKICAiZGlyZWN0b3JpZXMiOiB7fSwKICAiZGlzdCI6IHsKICAgICJzaGFzdW0iOiAiODZhY2U3MDUxNTk0ZjkxYjQ1NTFiZGI4MTIwYTE2YzQ0OTYyZDNhMiIsCiAgICAidGFyYmFsbCI6ICJodHRwczovL3JlZ2lzdHJ5Lm5wbWpzLm9yZy9zaXAuanMvLS9zaXAuanMtMC43LjUudGd6IgogIH0sCiAgImVuZ2luZXMiOiB7CiAgICAibm9kZSI6ICI+PTAuOCIKICB9LAogICJnaXRIZWFkIjogImJhZTQ0YmQwMzU5ZjRkNzBkZWQzMDlhMzIzNjFmMDRhMDRlNzhkNmUiLAogICJob21lcGFnZSI6ICJodHRwOi8vc2lwanMuY29tIiwKICAia2V5d29yZHMiOiBbCiAgICAiamF2YXNjcmlwdCIsCiAgICAibGlicmFyeSIsCiAgICAic2lwIiwKICAgICJ3ZWJydGMiLAogICAgIndlYnNvY2tldCIKICBdLAogICJsaWNlbnNlIjogIk1JVCIsCiAgIm1haW4iOiAic3JjL2luZGV4LmpzIiwKICAibWFpbnRhaW5lcnMiOiBbCiAgICB7CiAgICAgICJuYW1lIjogImVncmVlbl9vbnNpcCIsCiAgICAgICJlbWFpbCI6ICJlcmljLmdyZWVuQG9uc2lwLmNvbSIKICAgIH0sCiAgICB7CiAgICAgICJuYW1lIjogImphbWVzLWNyaXNjdW9sbyIsCiAgICAgICJlbWFpbCI6ICJqYW1lc0BvbnNpcC5jb20iCiAgICB9LAogICAgewogICAgICAibmFtZSI6ICJqb3NlcGhmcmF6aWVyIiwKICAgICAgImVtYWlsIjogIjEyMTJqdHJhY2V1ckBnbWFpbC5jb20iCiAgICB9CiAgXSwKICAibmFtZSI6ICJzaXAuanMiLAogICJvcHRpb25hbERlcGVuZGVuY2llcyI6IHsKICAgICJwcm9taXNjdW91cyI6ICJeMC42LjAiCiAgfSwKICAicmVhZG1lIjogIkVSUk9SOiBObyBSRUFETUUgZGF0YSBmb3VuZCEiLAogICJyZXBvc2l0b3J5IjogewogICAgInR5cGUiOiAiZ2l0IiwKICAgICJ1cmwiOiAiZ2l0K2h0dHBzOi8vZ2l0aHViLmNvbS9vbnNpcC9TSVAuanMuZ2l0IgogIH0sCiAgInNjcmlwdHMiOiB7CiAgICAiYnVpbGQiOiAiZ3J1bnQgYnVpbGQiLAogICAgInByZXB1Ymxpc2giOiAiY2Qgc3JjL0dyYW1tYXIgJiYgbWtkaXIgLXAgZGlzdCAmJiBwZWdqcyAtLWV4dHJhLW9wdGlvbnMtZmlsZSBwZWcuanNvbiBzcmMvR3JhbW1hci5wZWdqcyBkaXN0L0dyYW1tYXIuanMiLAogICAgInJlcGwiOiAiYmVlZnkgdGVzdC9yZXBsLmpzIC0tb3BlbiIsCiAgICAidGVzdCI6ICJncnVudCB0cmF2aXMgLS12ZXJib3NlIgogIH0sCiAgInRpdGxlIjogIlNJUC5qcyIsCiAgInZlcnNpb24iOiAiMC43LjUiCn0KCn0se31dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewp2YXIgQ2xpZW50Q29udGV4dDsKCkNsaWVudENvbnRleHQgPSBmdW5jdGlvbiAodWEsIG1ldGhvZCwgdGFyZ2V0LCBvcHRpb25zKSB7CiAgdmFyIG9yaWdpbmFsVGFyZ2V0ID0gdGFyZ2V0OwoKICAvLyBWYWxpZGF0ZSBhcmd1bWVudHMKICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ05vdCBlbm91Z2ggYXJndW1lbnRzJyk7CiAgfQoKICB0aGlzLnVhID0gdWE7CiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC5jbGllbnRjb250ZXh0Jyk7CiAgdGhpcy5tZXRob2QgPSBtZXRob2Q7CiAgdGFyZ2V0ID0gdWEubm9ybWFsaXplVGFyZ2V0KHRhcmdldCk7CiAgaWYgKCF0YXJnZXQpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgdGFyZ2V0OiAnICsgb3JpZ2luYWxUYXJnZXQpOwogIH0KCiAgLyogT3B0aW9ucwogICAqIC0gZXh0cmFIZWFkZXJzCiAgICogLSBwYXJhbXMKICAgKiAtIGNvbnRlbnRUeXBlCiAgICogLSBib2R5CiAgICovCiAgb3B0aW9ucyA9IE9iamVjdC5jcmVhdGUob3B0aW9ucyB8fCBPYmplY3QucHJvdG90eXBlKTsKICBvcHRpb25zLmV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKCiAgaWYgKG9wdGlvbnMuY29udGVudFR5cGUpIHsKICAgIHRoaXMuY29udGVudFR5cGUgPSBvcHRpb25zLmNvbnRlbnRUeXBlOwogICAgb3B0aW9ucy5leHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgdGhpcy5jb250ZW50VHlwZSk7CiAgfQoKICAvLyBCdWlsZCB0aGUgcmVxdWVzdAogIHRoaXMucmVxdWVzdCA9IG5ldyBTSVAuT3V0Z29pbmdSZXF1ZXN0KHRoaXMubWV0aG9kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMucGFyYW1zLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzKTsKICBpZiAob3B0aW9ucy5ib2R5KSB7CiAgICB0aGlzLmJvZHkgPSBvcHRpb25zLmJvZHk7CiAgICB0aGlzLnJlcXVlc3QuYm9keSA9IHRoaXMuYm9keTsKICB9CgogIC8qIFNldCBvdGhlciBwcm9wZXJ0aWVzIGZyb20gdGhlIHJlcXVlc3QgKi8KICB0aGlzLmxvY2FsSWRlbnRpdHkgPSB0aGlzLnJlcXVlc3QuZnJvbTsKICB0aGlzLnJlbW90ZUlkZW50aXR5ID0gdGhpcy5yZXF1ZXN0LnRvOwoKICB0aGlzLmRhdGEgPSB7fTsKfTsKQ2xpZW50Q29udGV4dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKCkNsaWVudENvbnRleHQucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAoKSB7CiAgKG5ldyBTSVAuUmVxdWVzdFNlbmRlcih0aGlzLCB0aGlzLnVhKSkuc2VuZCgpOwogIHJldHVybiB0aGlzOwp9OwoKQ2xpZW50Q29udGV4dC5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgdmFyIGNhbmNlbF9yZWFzb24gPSBTSVAuVXRpbHMuZ2V0Q2FuY2VsUmVhc29uKG9wdGlvbnMuc3RhdHVzX2NvZGUsIG9wdGlvbnMucmVhc29uX3BocmFzZSk7CiAgdGhpcy5yZXF1ZXN0LmNhbmNlbChjYW5jZWxfcmVhc29uKTsKCiAgdGhpcy5lbWl0KCdjYW5jZWwnKTsKfTsKCkNsaWVudENvbnRleHQucHJvdG90eXBlLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uIChyZXNwb25zZSkgewogIHZhciBjYXVzZSA9IFNJUC5VdGlscy5nZXRSZWFzb25QaHJhc2UocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOwoKICBzd2l0Y2godHJ1ZSkgewogICAgY2FzZSAvXjFbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UsIGNhdXNlKTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAvXjJbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICBpZih0aGlzLnVhLmFwcGxpY2FudHNbdGhpc10pIHsKICAgICAgICBkZWxldGUgdGhpcy51YS5hcHBsaWNhbnRzW3RoaXNdOwogICAgICB9CiAgICAgIHRoaXMuZW1pdCgnYWNjZXB0ZWQnLCByZXNwb25zZSwgY2F1c2UpOwogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgICBpZih0aGlzLnVhLmFwcGxpY2FudHNbdGhpc10pIHsKICAgICAgICBkZWxldGUgdGhpcy51YS5hcHBsaWNhbnRzW3RoaXNdOwogICAgICB9CiAgICAgIHRoaXMuZW1pdCgncmVqZWN0ZWQnLCByZXNwb25zZSwgY2F1c2UpOwogICAgICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgIGJyZWFrOwogIH0KCn07CgpDbGllbnRDb250ZXh0LnByb3RvdHlwZS5vblJlcXVlc3RUaW1lb3V0ID0gZnVuY3Rpb24gKCkgewogIHRoaXMuZW1pdCgnZmFpbGVkJywgbnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7Cn07CgpDbGllbnRDb250ZXh0LnByb3RvdHlwZS5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24gKCkgewogIHRoaXMuZW1pdCgnZmFpbGVkJywgbnVsbCwgU0lQLkMuY2F1c2VzLkNPTk5FQ1RJT05fRVJST1IpOwp9OwoKU0lQLkNsaWVudENvbnRleHQgPSBDbGllbnRDb250ZXh0Owp9OwoKfSx7fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgU0lQIENvbnN0YW50cwogKi8KCi8qKgogKiBTSVAgQ29uc3RhbnRzLgogKiBAYXVnbWVudHMgU0lQCiAqLwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobmFtZSwgdmVyc2lvbikgewpyZXR1cm4gewogIFVTRVJfQUdFTlQ6IG5hbWUgKycvJysgdmVyc2lvbiwKCiAgLy8gU0lQIHNjaGVtZQogIFNJUDogICdzaXAnLAogIFNJUFM6ICdzaXBzJywKCiAgLy8gRW5kIGFuZCBGYWlsdXJlIGNhdXNlcwogIGNhdXNlczogewogICAgLy8gR2VuZXJpYyBlcnJvciBjYXVzZXMKICAgIENPTk5FQ1RJT05fRVJST1I6ICAgICAgICAgJ0Nvbm5lY3Rpb24gRXJyb3InLAogICAgUkVRVUVTVF9USU1FT1VUOiAgICAgICAgICAnUmVxdWVzdCBUaW1lb3V0JywKICAgIFNJUF9GQUlMVVJFX0NPREU6ICAgICAgICAgJ1NJUCBGYWlsdXJlIENvZGUnLAogICAgSU5URVJOQUxfRVJST1I6ICAgICAgICAgICAnSW50ZXJuYWwgRXJyb3InLAoKICAgIC8vIFNJUCBlcnJvciBjYXVzZXMKICAgIEJVU1k6ICAgICAgICAgICAgICAgICAgICAgJ0J1c3knLAogICAgUkVKRUNURUQ6ICAgICAgICAgICAgICAgICAnUmVqZWN0ZWQnLAogICAgUkVESVJFQ1RFRDogICAgICAgICAgICAgICAnUmVkaXJlY3RlZCcsCiAgICBVTkFWQUlMQUJMRTogICAgICAgICAgICAgICdVbmF2YWlsYWJsZScsCiAgICBOT1RfRk9VTkQ6ICAgICAgICAgICAgICAgICdOb3QgRm91bmQnLAogICAgQUREUkVTU19JTkNPTVBMRVRFOiAgICAgICAnQWRkcmVzcyBJbmNvbXBsZXRlJywKICAgIElOQ09NUEFUSUJMRV9TRFA6ICAgICAgICAgJ0luY29tcGF0aWJsZSBTRFAnLAogICAgQVVUSEVOVElDQVRJT05fRVJST1I6ICAgICAnQXV0aGVudGljYXRpb24gRXJyb3InLAogICAgRElBTE9HX0VSUk9SOiAgICAgICAgICAgICAnRGlhbG9nIEVycm9yJywKCiAgICAvLyBTZXNzaW9uIGVycm9yIGNhdXNlcwogICAgV0VCUlRDX05PVF9TVVBQT1JURUQ6ICAgICAnV2ViUlRDIE5vdCBTdXBwb3J0ZWQnLAogICAgV0VCUlRDX0VSUk9SOiAgICAgICAgICAgICAnV2ViUlRDIEVycm9yJywKICAgIENBTkNFTEVEOiAgICAgICAgICAgICAgICAgJ0NhbmNlbGVkJywKICAgIE5PX0FOU1dFUjogICAgICAgICAgICAgICAgJ05vIEFuc3dlcicsCiAgICBFWFBJUkVTOiAgICAgICAgICAgICAgICAgICdFeHBpcmVzJywKICAgIE5PX0FDSzogICAgICAgICAgICAgICAgICAgJ05vIEFDSycsCiAgICBOT19QUkFDSzogICAgICAgICAgICAgICAgICdObyBQUkFDSycsCiAgICBVU0VSX0RFTklFRF9NRURJQV9BQ0NFU1M6ICdVc2VyIERlbmllZCBNZWRpYSBBY2Nlc3MnLAogICAgQkFEX01FRElBX0RFU0NSSVBUSU9OOiAgICAnQmFkIE1lZGlhIERlc2NyaXB0aW9uJywKICAgIFJUUF9USU1FT1VUOiAgICAgICAgICAgICAgJ1JUUCBUaW1lb3V0JwogIH0sCgogIHN1cHBvcnRlZDogewogICAgVU5TVVBQT1JURUQ6ICAgICAgICAnbm9uZScsCiAgICBTVVBQT1JURUQ6ICAgICAgICAgICdzdXBwb3J0ZWQnLAogICAgUkVRVUlSRUQ6ICAgICAgICAgICAncmVxdWlyZWQnCiAgfSwKCiAgU0lQX0VSUk9SX0NBVVNFUzogewogICAgUkVESVJFQ1RFRDogWzMwMCwzMDEsMzAyLDMwNSwzODBdLAogICAgQlVTWTogWzQ4Niw2MDBdLAogICAgUkVKRUNURUQ6IFs0MDMsNjAzXSwKICAgIE5PVF9GT1VORDogWzQwNCw2MDRdLAogICAgVU5BVkFJTEFCTEU6IFs0ODAsNDEwLDQwOCw0MzBdLAogICAgQUREUkVTU19JTkNPTVBMRVRFOiBbNDg0XSwKICAgIElOQ09NUEFUSUJMRV9TRFA6IFs0ODgsNjA2XSwKICAgIEFVVEhFTlRJQ0FUSU9OX0VSUk9SOls0MDEsNDA3XQogIH0sCgogIC8vIFNJUCBNZXRob2RzCiAgQUNLOiAgICAgICAgJ0FDSycsCiAgQllFOiAgICAgICAgJ0JZRScsCiAgQ0FOQ0VMOiAgICAgJ0NBTkNFTCcsCiAgSU5GTzogICAgICAgJ0lORk8nLAogIElOVklURTogICAgICdJTlZJVEUnLAogIE1FU1NBR0U6ICAgICdNRVNTQUdFJywKICBOT1RJRlk6ICAgICAnTk9USUZZJywKICBPUFRJT05TOiAgICAnT1BUSU9OUycsCiAgUkVHSVNURVI6ICAgJ1JFR0lTVEVSJywKICBVUERBVEU6ICAgICAnVVBEQVRFJywKICBTVUJTQ1JJQkU6ICAnU1VCU0NSSUJFJywKICBSRUZFUjogICAgICAnUkVGRVInLAogIFBSQUNLOiAgICAgICdQUkFDSycsCgogIC8qIFNJUCBSZXNwb25zZSBSZWFzb25zCiAgICogRE9DOiBodHRwOi8vd3d3LmlhbmEub3JnL2Fzc2lnbm1lbnRzL3NpcC1wYXJhbWV0ZXJzCiAgICogQ29waWVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL3ZlcnNhdGljYS9PdmVyU0lQL2Jsb2IvbWFzdGVyL2xpYi9vdmVyc2lwL3NpcC9jb25zdGFudHMucmIjTDcKICAgKi8KICBSRUFTT05fUEhSQVNFOiB7CiAgICAxMDA6ICdUcnlpbmcnLAogICAgMTgwOiAnUmluZ2luZycsCiAgICAxODE6ICdDYWxsIElzIEJlaW5nIEZvcndhcmRlZCcsCiAgICAxODI6ICdRdWV1ZWQnLAogICAgMTgzOiAnU2Vzc2lvbiBQcm9ncmVzcycsCiAgICAxOTk6ICdFYXJseSBEaWFsb2cgVGVybWluYXRlZCcsICAvLyBkcmFmdC1pZXRmLXNpcGNvcmUtMTk5CiAgICAyMDA6ICdPSycsCiAgICAyMDI6ICdBY2NlcHRlZCcsICAvLyBSRkMgMzI2NQogICAgMjA0OiAnTm8gTm90aWZpY2F0aW9uJywgIC8vUkZDIDU4MzkKICAgIDMwMDogJ011bHRpcGxlIENob2ljZXMnLAogICAgMzAxOiAnTW92ZWQgUGVybWFuZW50bHknLAogICAgMzAyOiAnTW92ZWQgVGVtcG9yYXJpbHknLAogICAgMzA1OiAnVXNlIFByb3h5JywKICAgIDM4MDogJ0FsdGVybmF0aXZlIFNlcnZpY2UnLAogICAgNDAwOiAnQmFkIFJlcXVlc3QnLAogICAgNDAxOiAnVW5hdXRob3JpemVkJywKICAgIDQwMjogJ1BheW1lbnQgUmVxdWlyZWQnLAogICAgNDAzOiAnRm9yYmlkZGVuJywKICAgIDQwNDogJ05vdCBGb3VuZCcsCiAgICA0MDU6ICdNZXRob2QgTm90IEFsbG93ZWQnLAogICAgNDA2OiAnTm90IEFjY2VwdGFibGUnLAogICAgNDA3OiAnUHJveHkgQXV0aGVudGljYXRpb24gUmVxdWlyZWQnLAogICAgNDA4OiAnUmVxdWVzdCBUaW1lb3V0JywKICAgIDQxMDogJ0dvbmUnLAogICAgNDEyOiAnQ29uZGl0aW9uYWwgUmVxdWVzdCBGYWlsZWQnLCAgLy8gUkZDIDM5MDMKICAgIDQxMzogJ1JlcXVlc3QgRW50aXR5IFRvbyBMYXJnZScsCiAgICA0MTQ6ICdSZXF1ZXN0LVVSSSBUb28gTG9uZycsCiAgICA0MTU6ICdVbnN1cHBvcnRlZCBNZWRpYSBUeXBlJywKICAgIDQxNjogJ1Vuc3VwcG9ydGVkIFVSSSBTY2hlbWUnLAogICAgNDE3OiAnVW5rbm93biBSZXNvdXJjZS1Qcmlvcml0eScsICAvLyBSRkMgNDQxMgogICAgNDIwOiAnQmFkIEV4dGVuc2lvbicsCiAgICA0MjE6ICdFeHRlbnNpb24gUmVxdWlyZWQnLAogICAgNDIyOiAnU2Vzc2lvbiBJbnRlcnZhbCBUb28gU21hbGwnLCAgLy8gUkZDIDQwMjgKICAgIDQyMzogJ0ludGVydmFsIFRvbyBCcmllZicsCiAgICA0Mjg6ICdVc2UgSWRlbnRpdHkgSGVhZGVyJywgIC8vIFJGQyA0NDc0CiAgICA0Mjk6ICdQcm92aWRlIFJlZmVycmVyIElkZW50aXR5JywgIC8vIFJGQyAzODkyCiAgICA0MzA6ICdGbG93IEZhaWxlZCcsICAvLyBSRkMgNTYyNgogICAgNDMzOiAnQW5vbnltaXR5IERpc2FsbG93ZWQnLCAgLy8gUkZDIDUwNzkKICAgIDQzNjogJ0JhZCBJZGVudGl0eS1JbmZvJywgIC8vIFJGQyA0NDc0CiAgICA0Mzc6ICdVbnN1cHBvcnRlZCBDZXJ0aWZpY2F0ZScsICAvLyBSRkMgNDc0NAogICAgNDM4OiAnSW52YWxpZCBJZGVudGl0eSBIZWFkZXInLCAgLy8gUkZDIDQ3NDQKICAgIDQzOTogJ0ZpcnN0IEhvcCBMYWNrcyBPdXRib3VuZCBTdXBwb3J0JywgIC8vIFJGQyA1NjI2CiAgICA0NDA6ICdNYXgtQnJlYWR0aCBFeGNlZWRlZCcsICAvLyBSRkMgNTM5MwogICAgNDY5OiAnQmFkIEluZm8gUGFja2FnZScsICAvLyBkcmFmdC1pZXRmLXNpcGNvcmUtaW5mby1ldmVudHMKICAgIDQ3MDogJ0NvbnNlbnQgTmVlZGVkJywgIC8vIFJGQyA1MzYwCiAgICA0Nzg6ICdVbnJlc29sdmFibGUgRGVzdGluYXRpb24nLCAgLy8gQ3VzdG9tIGNvZGUgY29waWVkIGZyb20gS2FtYWlsaW8uCiAgICA0ODA6ICdUZW1wb3JhcmlseSBVbmF2YWlsYWJsZScsCiAgICA0ODE6ICdDYWxsL1RyYW5zYWN0aW9uIERvZXMgTm90IEV4aXN0JywKICAgIDQ4MjogJ0xvb3AgRGV0ZWN0ZWQnLAogICAgNDgzOiAnVG9vIE1hbnkgSG9wcycsCiAgICA0ODQ6ICdBZGRyZXNzIEluY29tcGxldGUnLAogICAgNDg1OiAnQW1iaWd1b3VzJywKICAgIDQ4NjogJ0J1c3kgSGVyZScsCiAgICA0ODc6ICdSZXF1ZXN0IFRlcm1pbmF0ZWQnLAogICAgNDg4OiAnTm90IEFjY2VwdGFibGUgSGVyZScsCiAgICA0ODk6ICdCYWQgRXZlbnQnLCAgLy8gUkZDIDMyNjUKICAgIDQ5MTogJ1JlcXVlc3QgUGVuZGluZycsCiAgICA0OTM6ICdVbmRlY2lwaGVyYWJsZScsCiAgICA0OTQ6ICdTZWN1cml0eSBBZ3JlZW1lbnQgUmVxdWlyZWQnLCAgLy8gUkZDIDMzMjkKICAgIDUwMDogJ0ludGVybmFsIFNlcnZlciBFcnJvcicsCiAgICA1MDE6ICdOb3QgSW1wbGVtZW50ZWQnLAogICAgNTAyOiAnQmFkIEdhdGV3YXknLAogICAgNTAzOiAnU2VydmljZSBVbmF2YWlsYWJsZScsCiAgICA1MDQ6ICdTZXJ2ZXIgVGltZS1vdXQnLAogICAgNTA1OiAnVmVyc2lvbiBOb3QgU3VwcG9ydGVkJywKICAgIDUxMzogJ01lc3NhZ2UgVG9vIExhcmdlJywKICAgIDU4MDogJ1ByZWNvbmRpdGlvbiBGYWlsdXJlJywgIC8vIFJGQyAzMzEyCiAgICA2MDA6ICdCdXN5IEV2ZXJ5d2hlcmUnLAogICAgNjAzOiAnRGVjbGluZScsCiAgICA2MDQ6ICdEb2VzIE5vdCBFeGlzdCBBbnl3aGVyZScsCiAgICA2MDY6ICdOb3QgQWNjZXB0YWJsZScKICB9LAoKICAvKiBTSVAgT3B0aW9uIFRhZ3MKICAgKiBET0M6IGh0dHA6Ly93d3cuaWFuYS5vcmcvYXNzaWdubWVudHMvc2lwLXBhcmFtZXRlcnMvc2lwLXBhcmFtZXRlcnMueGh0bWwjc2lwLXBhcmFtZXRlcnMtNAogICAqLwogIE9QVElPTl9UQUdTOiB7CiAgICAnMTAwcmVsJzogICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyAzMjYyCiAgICAxOTk6ICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA2MjI4CiAgICBhbnN3ZXJtb2RlOiAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA1MzczCiAgICAnZWFybHktc2Vzc2lvbic6ICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyAzOTU5CiAgICBldmVudGxpc3Q6ICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA0NjYyCiAgICBleHBsaWNpdHN1YjogICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQy1pZXRmLXNpcGNvcmUtcmVmZXItZXhwbGljaXQtc3Vic2NyaXB0aW9uLTAzCiAgICAnZnJvbS1jaGFuZ2UnOiAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA0OTE2CiAgICAnZ2VvbG9jYXRpb24taHR0cCc6ICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA2NDQyCiAgICAnZ2VvbG9jYXRpb24tc2lwJzogICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA2NDQyCiAgICBnaW46ICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA2MTQwCiAgICBncnV1OiAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA1NjI3CiAgICBoaXN0aW5mbzogICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA3MDQ0CiAgICBpY2U6ICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA1NzY4CiAgICBqb2luOiAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyAzOTExCiAgICAnbXVsdGlwbGUtcmVmZXInOiAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA1MzY4CiAgICBub3JlZmVyc3ViOiAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA0NDg4CiAgICBub3N1YjogICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQy1pZXRmLXNpcGNvcmUtcmVmZXItZXhwbGljaXQtc3Vic2NyaXB0aW9uLTAzCiAgICBvdXRib3VuZDogICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA1NjI2CiAgICBwYXRoOiAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyAzMzI3CiAgICBwb2xpY3k6ICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA2Nzk0CiAgICBwcmVjb25kaXRpb246ICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyAzMzEyCiAgICBwcmVmOiAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyAzODQwCiAgICBwcml2YWN5OiAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyAzMzIzCiAgICAncmVjaXBpZW50LWxpc3QtaW52aXRlJzogICAgdHJ1ZSwgIC8vIFJGQyA1MzY2CiAgICAncmVjaXBpZW50LWxpc3QtbWVzc2FnZSc6ICAgdHJ1ZSwgIC8vIFJGQyA1MzY1CiAgICAncmVjaXBpZW50LWxpc3Qtc3Vic2NyaWJlJzogdHJ1ZSwgIC8vIFJGQyA1MzY3CiAgICByZXBsYWNlczogICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyAzODkxCiAgICAncmVzb3VyY2UtcHJpb3JpdHknOiAgICAgICAgdHJ1ZSwgIC8vIFJGQyA0NDEyCiAgICAnc2RwLWFuYXQnOiAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA0MDkyCiAgICAnc2VjLWFncmVlJzogICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyAzMzI5CiAgICB0ZGlhbG9nOiAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA0NTM4CiAgICB0aW1lcjogICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgIC8vIFJGQyA0MDI4CiAgICB1dWk6ICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAgIC8vIFJGQyA3NDMzCiAgfQp9Owp9OwoKfSx7fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCi8qKgogKiBAZmlsZW92ZXJ2aWV3IEluLURpYWxvZyBSZXF1ZXN0IFNlbmRlcgogKi8KCi8qKgogKiBAYXVnbWVudHMgU0lQLkRpYWxvZwogKiBAY2xhc3MgQ2xhc3MgY3JlYXRpbmcgYW4gSW4tZGlhbG9nIHJlcXVlc3Qgc2VuZGVyLgogKiBAcGFyYW0ge1NJUC5EaWFsb2d9IGRpYWxvZwogKiBAcGFyYW0ge09iamVjdH0gYXBwbGljYW50CiAqIEBwYXJhbSB7U0lQLk91dGdvaW5nUmVxdWVzdH0gcmVxdWVzdAogKi8KLyoqCiAqIEBmaWxlb3ZlcnZpZXcgaW4tRGlhbG9nIFJlcXVlc3QgU2VuZGVyCiAqLwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CnZhciBSZXF1ZXN0U2VuZGVyOwoKUmVxdWVzdFNlbmRlciA9IGZ1bmN0aW9uKGRpYWxvZywgYXBwbGljYW50LCByZXF1ZXN0KSB7CgogIHRoaXMuZGlhbG9nID0gZGlhbG9nOwogIHRoaXMuYXBwbGljYW50ID0gYXBwbGljYW50OwogIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7CgogIC8vIFJGQzMyNjEgMTQuMSBNb2RpZnlpbmcgYW4gRXhpc3RpbmcgU2Vzc2lvbi4gVUFDIEJlaGF2aW9yLgogIHRoaXMucmVhdHRlbXB0ID0gZmFsc2U7CiAgdGhpcy5yZWF0dGVtcHRUaW1lciA9IG51bGw7Cn07CgpSZXF1ZXN0U2VuZGVyLnByb3RvdHlwZSA9IHsKICBzZW5kOiBmdW5jdGlvbigpIHsKICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgcmVxdWVzdF9zZW5kZXIgPSBuZXcgU0lQLlJlcXVlc3RTZW5kZXIodGhpcywgdGhpcy5kaWFsb2cub3duZXIudWEpOwoKICAgICAgcmVxdWVzdF9zZW5kZXIuc2VuZCgpOwoKICAgIC8vIFJGQzMyNjEgMTQuMiBNb2RpZnlpbmcgYW4gRXhpc3RpbmcgU2Vzc2lvbiAtVUFDIEJFSEFWSU9SLQogICAgaWYgKHRoaXMucmVxdWVzdC5tZXRob2QgPT09IFNJUC5DLklOVklURSAmJiByZXF1ZXN0X3NlbmRlci5jbGllbnRUcmFuc2FjdGlvbi5zdGF0ZSAhPT0gU0lQLlRyYW5zYWN0aW9ucy5DLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZGlhbG9nLnVhY19wZW5kaW5nX3JlcGx5ID0gdHJ1ZTsKICAgICAgcmVxdWVzdF9zZW5kZXIuY2xpZW50VHJhbnNhY3Rpb24ub24oJ3N0YXRlQ2hhbmdlZCcsIGZ1bmN0aW9uIHN0YXRlQ2hhbmdlZCgpewogICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX0FDQ0VQVEVEIHx8CiAgICAgICAgICAgIHRoaXMuc3RhdGUgPT09IFNJUC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfQ09NUExFVEVEIHx8CiAgICAgICAgICAgIHRoaXMuc3RhdGUgPT09IFNJUC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfVEVSTUlOQVRFRCkgewoKICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIoJ3N0YXRlQ2hhbmdlZCcsIHN0YXRlQ2hhbmdlZCk7CiAgICAgICAgICBzZWxmLmRpYWxvZy51YWNfcGVuZGluZ19yZXBseSA9IGZhbHNlOwoKICAgICAgICAgIGlmIChzZWxmLmRpYWxvZy51YXNfcGVuZGluZ19yZXBseSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgc2VsZi5kaWFsb2cub3duZXIub25SZWFkeVRvUmVpbnZpdGUoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sCgogIG9uUmVxdWVzdFRpbWVvdXQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5hcHBsaWNhbnQub25SZXF1ZXN0VGltZW91dCgpOwogIH0sCgogIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5hcHBsaWNhbnQub25UcmFuc3BvcnRFcnJvcigpOwogIH0sCgogIHJlY2VpdmVSZXNwb25zZTogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAvLyBSRkMzMjYxIDEyLjIuMS4yIDQwOCBvciA0ODEgaXMgcmVjZWl2ZWQgZm9yIGEgcmVxdWVzdCB3aXRoaW4gYSBkaWFsb2cuCiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT09IDQwOCB8fCByZXNwb25zZS5zdGF0dXNfY29kZSA9PT0gNDgxKSB7CiAgICAgIHRoaXMuYXBwbGljYW50Lm9uRGlhbG9nRXJyb3IocmVzcG9uc2UpOwogICAgfSBlbHNlIGlmIChyZXNwb25zZS5tZXRob2QgPT09IFNJUC5DLklOVklURSAmJiByZXNwb25zZS5zdGF0dXNfY29kZSA9PT0gNDkxKSB7CiAgICAgIGlmICh0aGlzLnJlYXR0ZW1wdCkgewogICAgICAgIHRoaXMuYXBwbGljYW50LnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5yZXF1ZXN0LmNzZXEudmFsdWUgPSB0aGlzLmRpYWxvZy5sb2NhbF9zZXFudW0gKz0gMTsKICAgICAgICB0aGlzLnJlYXR0ZW1wdFRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGlmIChzZWxmLmFwcGxpY2FudC5vd25lci5zdGF0dXMgIT09IFNJUC5TZXNzaW9uLkMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgICAgICBzZWxmLnJlYXR0ZW1wdCA9IHRydWU7CiAgICAgICAgICAgICAgc2VsZi5yZXF1ZXN0X3NlbmRlci5zZW5kKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB0aGlzLmdldFJlYXR0ZW1wdFRpbWVvdXQoKQogICAgICAgICk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuYXBwbGljYW50LnJlY2VpdmVSZXNwb25zZShyZXNwb25zZSk7CiAgICB9CiAgfQp9OwoKcmV0dXJuIFJlcXVlc3RTZW5kZXI7Cn07Cgp9LHt9XSwxMDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgU0lQIERpYWxvZwogKi8KCi8qKgogKiBAYXVnbWVudHMgU0lQCiAqIEBjbGFzcyBDbGFzcyBjcmVhdGluZyBhIFNJUCBkaWFsb2cuCiAqIEBwYXJhbSB7U0lQLlJUQ1Nlc3Npb259IG93bmVyCiAqIEBwYXJhbSB7U0lQLkluY29taW5nUmVxdWVzdHxTSVAuSW5jb21pbmdSZXNwb25zZX0gbWVzc2FnZQogKiBAcGFyYW0ge0VudW19IHR5cGUgVUFDIC8gVUFTCiAqIEBwYXJhbSB7RW51bX0gc3RhdGUgU0lQLkRpYWxvZy5DLlNUQVRVU19FQVJMWSAvIFNJUC5EaWFsb2cuQy5TVEFUVVNfQ09ORklSTUVECiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKCnZhciBSZXF1ZXN0U2VuZGVyID0gcmVxdWlyZSgnLi9EaWFsb2cvUmVxdWVzdFNlbmRlcicpKFNJUCk7Cgp2YXIgRGlhbG9nLAogIEMgPSB7CiAgICAvLyBEaWFsb2cgc3RhdGVzCiAgICBTVEFUVVNfRUFSTFk6ICAgICAgIDEsCiAgICBTVEFUVVNfQ09ORklSTUVEOiAgIDIKICB9OwoKLy8gUkZDIDMyNjEgMTIuMQpEaWFsb2cgPSBmdW5jdGlvbihvd25lciwgbWVzc2FnZSwgdHlwZSwgc3RhdGUpIHsKICB2YXIgY29udGFjdDsKCiAgdGhpcy51YWNfcGVuZGluZ19yZXBseSA9IGZhbHNlOwogIHRoaXMudWFzX3BlbmRpbmdfcmVwbHkgPSBmYWxzZTsKCiAgaWYoIW1lc3NhZ2UuaGFzSGVhZGVyKCdjb250YWN0JykpIHsKICAgIHJldHVybiB7CiAgICAgIGVycm9yOiAndW5hYmxlIHRvIGNyZWF0ZSBhIERpYWxvZyB3aXRob3V0IENvbnRhY3QgaGVhZGVyIGZpZWxkJwogICAgfTsKICB9CgogIGlmKG1lc3NhZ2UgaW5zdGFuY2VvZiBTSVAuSW5jb21pbmdSZXNwb25zZSkgewogICAgc3RhdGUgPSAobWVzc2FnZS5zdGF0dXNfY29kZSA8IDIwMCkgPyBDLlNUQVRVU19FQVJMWSA6IEMuU1RBVFVTX0NPTkZJUk1FRDsKICB9IGVsc2UgewogICAgLy8gQ3JlYXRlIGNvbmZpcm1lZCBkaWFsb2cgaWYgc3RhdGUgaXMgbm90IGRlZmluZWQKICAgIHN0YXRlID0gc3RhdGUgfHwgQy5TVEFUVVNfQ09ORklSTUVEOwogIH0KCiAgY29udGFjdCA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ2NvbnRhY3QnKTsKCiAgLy8gUkZDIDMyNjEgMTIuMS4xCiAgaWYodHlwZSA9PT0gJ1VBUycpIHsKICAgIHRoaXMuaWQgPSB7CiAgICAgIGNhbGxfaWQ6IG1lc3NhZ2UuY2FsbF9pZCwKICAgICAgbG9jYWxfdGFnOiBtZXNzYWdlLnRvX3RhZywKICAgICAgcmVtb3RlX3RhZzogbWVzc2FnZS5mcm9tX3RhZywKICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzLmNhbGxfaWQgKyB0aGlzLmxvY2FsX3RhZyArIHRoaXMucmVtb3RlX3RhZzsKICAgICAgfQogICAgfTsKICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTsKICAgIHRoaXMucmVtb3RlX3NlcW51bSA9IG1lc3NhZ2UuY3NlcTsKICAgIHRoaXMubG9jYWxfdXJpID0gbWVzc2FnZS5wYXJzZUhlYWRlcigndG8nKS51cmk7CiAgICB0aGlzLnJlbW90ZV91cmkgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCdmcm9tJykudXJpOwogICAgdGhpcy5yZW1vdGVfdGFyZ2V0ID0gY29udGFjdC51cmk7CiAgICB0aGlzLnJvdXRlX3NldCA9IG1lc3NhZ2UuZ2V0SGVhZGVycygncmVjb3JkLXJvdXRlJyk7CiAgICB0aGlzLmludml0ZV9zZXFudW0gPSBtZXNzYWdlLmNzZXE7CiAgICB0aGlzLmxvY2FsX3NlcW51bSA9IG1lc3NhZ2UuY3NlcTsKICB9CiAgLy8gUkZDIDMyNjEgMTIuMS4yCiAgZWxzZSBpZih0eXBlID09PSAnVUFDJykgewogICAgdGhpcy5pZCA9IHsKICAgICAgY2FsbF9pZDogbWVzc2FnZS5jYWxsX2lkLAogICAgICBsb2NhbF90YWc6IG1lc3NhZ2UuZnJvbV90YWcsCiAgICAgIHJlbW90ZV90YWc6IG1lc3NhZ2UudG9fdGFnLAogICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY2FsbF9pZCArIHRoaXMubG9jYWxfdGFnICsgdGhpcy5yZW1vdGVfdGFnOwogICAgICB9CiAgICB9OwogICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgdGhpcy5pbnZpdGVfc2VxbnVtID0gbWVzc2FnZS5jc2VxOwogICAgdGhpcy5sb2NhbF9zZXFudW0gPSBtZXNzYWdlLmNzZXE7CiAgICB0aGlzLmxvY2FsX3VyaSA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ2Zyb20nKS51cmk7CiAgICB0aGlzLnByYWNrZWQgPSBbXTsKICAgIHRoaXMucmVtb3RlX3VyaSA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ3RvJykudXJpOwogICAgdGhpcy5yZW1vdGVfdGFyZ2V0ID0gY29udGFjdC51cmk7CiAgICB0aGlzLnJvdXRlX3NldCA9IG1lc3NhZ2UuZ2V0SGVhZGVycygncmVjb3JkLXJvdXRlJykucmV2ZXJzZSgpOwoKICAgIC8vUkVOREVSQk9EWQogICAgaWYgKHRoaXMuc3RhdGUgPT09IEMuU1RBVFVTX0VBUkxZICYmICghb3duZXIuaGFzT2ZmZXIpKSB7CiAgICAgIHRoaXMubWVkaWFIYW5kbGVyID0gb3duZXIubWVkaWFIYW5kbGVyRmFjdG9yeShvd25lcik7CiAgICB9CiAgfQoKICB0aGlzLmxvZ2dlciA9IG93bmVyLnVhLmdldExvZ2dlcignc2lwLmRpYWxvZycsIHRoaXMuaWQudG9TdHJpbmcoKSk7CiAgdGhpcy5vd25lciA9IG93bmVyOwogIG93bmVyLnVhLmRpYWxvZ3NbdGhpcy5pZC50b1N0cmluZygpXSA9IHRoaXM7CiAgdGhpcy5sb2dnZXIubG9nKCduZXcgJyArIHR5cGUgKyAnIGRpYWxvZyBjcmVhdGVkIHdpdGggc3RhdHVzICcgKyAodGhpcy5zdGF0ZSA9PT0gQy5TVEFUVVNfRUFSTFkgPyAnRUFSTFknOiAnQ09ORklSTUVEJykpOwogIG93bmVyLmVtaXQoJ2RpYWxvZycsIHRoaXMpOwp9OwoKRGlhbG9nLnByb3RvdHlwZSA9IHsKICAvKioKICAgKiBAcGFyYW0ge1NJUC5JbmNvbWluZ01lc3NhZ2V9IG1lc3NhZ2UKICAgKiBAcGFyYW0ge0VudW19IFVBQy9VQVMKICAgKi8KICB1cGRhdGU6IGZ1bmN0aW9uKG1lc3NhZ2UsIHR5cGUpIHsKICAgIHRoaXMuc3RhdGUgPSBDLlNUQVRVU19DT05GSVJNRUQ7CgogICAgdGhpcy5sb2dnZXIubG9nKCdkaWFsb2cgJysgdGhpcy5pZC50b1N0cmluZygpICsnICBjaGFuZ2VkIHRvIENPTkZJUk1FRCBzdGF0ZScpOwoKICAgIGlmKHR5cGUgPT09ICdVQUMnKSB7CiAgICAgIC8vIFJGQyAzMjYxIDEzLjIuMi40CiAgICAgIHRoaXMucm91dGVfc2V0ID0gbWVzc2FnZS5nZXRIZWFkZXJzKCdyZWNvcmQtcm91dGUnKS5yZXZlcnNlKCk7CiAgICB9CiAgfSwKCiAgdGVybWluYXRlOiBmdW5jdGlvbigpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygnZGlhbG9nICcgKyB0aGlzLmlkLnRvU3RyaW5nKCkgKyAnIGRlbGV0ZWQnKTsKICAgIGlmICh0aGlzLm1lZGlhSGFuZGxlciAmJiB0aGlzLnN0YXRlICE9PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy5tZWRpYUhhbmRsZXIucGVlckNvbm5lY3Rpb24uY2xvc2UoKTsKICAgIH0KICAgIGRlbGV0ZSB0aGlzLm93bmVyLnVhLmRpYWxvZ3NbdGhpcy5pZC50b1N0cmluZygpXTsKICB9LAoKICAvKioKICAqIEBwYXJhbSB7U3RyaW5nfSBtZXRob2QgcmVxdWVzdCBtZXRob2QKICAqIEBwYXJhbSB7T2JqZWN0fSBleHRyYUhlYWRlcnMgZXh0cmEgaGVhZGVycwogICogQHJldHVybnMge1NJUC5PdXRnb2luZ1JlcXVlc3R9CiAgKi8KCiAgLy8gUkZDIDMyNjEgMTIuMi4xLjEKICBjcmVhdGVSZXF1ZXN0OiBmdW5jdGlvbihtZXRob2QsIGV4dHJhSGVhZGVycywgYm9keSkgewogICAgdmFyIGNzZXEsIHJlcXVlc3Q7CiAgICBleHRyYUhlYWRlcnMgPSAoZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpOwoKICAgIGlmKCF0aGlzLmxvY2FsX3NlcW51bSkgeyB0aGlzLmxvY2FsX3NlcW51bSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKTsgfQoKICAgIGNzZXEgPSAobWV0aG9kID09PSBTSVAuQy5DQU5DRUwgfHwgbWV0aG9kID09PSBTSVAuQy5BQ0spID8gdGhpcy5pbnZpdGVfc2VxbnVtIDogdGhpcy5sb2NhbF9zZXFudW0gKz0gMTsKCiAgICByZXF1ZXN0ID0gbmV3IFNJUC5PdXRnb2luZ1JlcXVlc3QoCiAgICAgIG1ldGhvZCwKICAgICAgdGhpcy5yZW1vdGVfdGFyZ2V0LAogICAgICB0aGlzLm93bmVyLnVhLCB7CiAgICAgICAgJ2NzZXEnOiBjc2VxLAogICAgICAgICdjYWxsX2lkJzogdGhpcy5pZC5jYWxsX2lkLAogICAgICAgICdmcm9tX3VyaSc6IHRoaXMubG9jYWxfdXJpLAogICAgICAgICdmcm9tX3RhZyc6IHRoaXMuaWQubG9jYWxfdGFnLAogICAgICAgICd0b191cmknOiB0aGlzLnJlbW90ZV91cmksCiAgICAgICAgJ3RvX3RhZyc6IHRoaXMuaWQucmVtb3RlX3RhZywKICAgICAgICAncm91dGVfc2V0JzogdGhpcy5yb3V0ZV9zZXQKICAgICAgfSwgZXh0cmFIZWFkZXJzLCBib2R5KTsKCiAgICByZXF1ZXN0LmRpYWxvZyA9IHRoaXM7CgogICAgcmV0dXJuIHJlcXVlc3Q7CiAgfSwKCiAgLyoqCiAgKiBAcGFyYW0ge1NJUC5JbmNvbWluZ1JlcXVlc3R9IHJlcXVlc3QKICAqIEByZXR1cm5zIHtCb29sZWFufQogICovCgogIC8vIFJGQyAzMjYxIDEyLjIuMgogIGNoZWNrSW5EaWFsb2dSZXF1ZXN0OiBmdW5jdGlvbihyZXF1ZXN0KSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgaWYoIXRoaXMucmVtb3RlX3NlcW51bSkgewogICAgICB0aGlzLnJlbW90ZV9zZXFudW0gPSByZXF1ZXN0LmNzZXE7CiAgICB9IGVsc2UgaWYocmVxdWVzdC5jc2VxIDwgdGhpcy5yZW1vdGVfc2VxbnVtKSB7CiAgICAgICAgLy9EbyBub3QgdHJ5IHRvIHJlcGx5IHRvIGFuIEFDSyByZXF1ZXN0LgogICAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCAhPT0gU0lQLkMuQUNLKSB7CiAgICAgICAgICByZXF1ZXN0LnJlcGx5KDUwMCk7CiAgICAgICAgfQogICAgICAgIGlmIChyZXF1ZXN0LmNzZXEgPT09IHRoaXMuaW52aXRlX3NlcW51bSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gZWxzZSBpZihyZXF1ZXN0LmNzZXEgPiB0aGlzLnJlbW90ZV9zZXFudW0pIHsKICAgICAgdGhpcy5yZW1vdGVfc2VxbnVtID0gcmVxdWVzdC5jc2VxOwogICAgfQoKICAgIHN3aXRjaChyZXF1ZXN0Lm1ldGhvZCkgewogICAgICAvLyBSRkMzMjYxIDE0LjIgTW9kaWZ5aW5nIGFuIEV4aXN0aW5nIFNlc3Npb24gLVVBUyBCRUhBVklPUi0KICAgICAgY2FzZSBTSVAuQy5JTlZJVEU6CiAgICAgICAgaWYgKHRoaXMudWFjX3BlbmRpbmdfcmVwbHkgPT09IHRydWUpIHsKICAgICAgICAgIHJlcXVlc3QucmVwbHkoNDkxKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMudWFzX3BlbmRpbmdfcmVwbHkgPT09IHRydWUpIHsKICAgICAgICAgIHZhciByZXRyeUFmdGVyID0gKE1hdGgucmFuZG9tKCkgKiAxMCB8IDApICsgMTsKICAgICAgICAgIHJlcXVlc3QucmVwbHkoNTAwLCBudWxsLCBbJ1JldHJ5LUFmdGVyOicgKyByZXRyeUFmdGVyXSk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudWFzX3BlbmRpbmdfcmVwbHkgPSB0cnVlOwogICAgICAgICAgcmVxdWVzdC5zZXJ2ZXJfdHJhbnNhY3Rpb24ub24oJ3N0YXRlQ2hhbmdlZCcsIGZ1bmN0aW9uIHN0YXRlQ2hhbmdlZCgpewogICAgICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gU0lQLlRyYW5zYWN0aW9ucy5DLlNUQVRVU19BQ0NFUFRFRCB8fAogICAgICAgICAgICAgICAgdGhpcy5zdGF0ZSA9PT0gU0lQLlRyYW5zYWN0aW9ucy5DLlNUQVRVU19DT01QTEVURUQgfHwKICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUgPT09IFNJUC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfVEVSTUlOQVRFRCkgewoKICAgICAgICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKCdzdGF0ZUNoYW5nZWQnLCBzdGF0ZUNoYW5nZWQpOwogICAgICAgICAgICAgIHNlbGYudWFzX3BlbmRpbmdfcmVwbHkgPSBmYWxzZTsKCiAgICAgICAgICAgICAgaWYgKHNlbGYudWFjX3BlbmRpbmdfcmVwbHkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICBzZWxmLm93bmVyLm9uUmVhZHlUb1JlaW52aXRlKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIC8vIFJGQzMyNjEgMTIuMi4yIFJlcGxhY2UgdGhlIGRpYWxvZ2BzIHJlbW90ZSB0YXJnZXQgVVJJIGlmIHRoZSByZXF1ZXN0IGlzIGFjY2VwdGVkCiAgICAgICAgaWYocmVxdWVzdC5oYXNIZWFkZXIoJ2NvbnRhY3QnKSkgewogICAgICAgICAgcmVxdWVzdC5zZXJ2ZXJfdHJhbnNhY3Rpb24ub24oJ3N0YXRlQ2hhbmdlZCcsIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBTSVAuVHJhbnNhY3Rpb25zLkMuU1RBVFVTX0FDQ0VQVEVEKSB7CiAgICAgICAgICAgICAgc2VsZi5yZW1vdGVfdGFyZ2V0ID0gcmVxdWVzdC5wYXJzZUhlYWRlcignY29udGFjdCcpLnVyaTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIFNJUC5DLk5PVElGWToKICAgICAgICAvLyBSRkM2NjY1IDMuMiBSZXBsYWNlIHRoZSBkaWFsb2dgcyByZW1vdGUgdGFyZ2V0IFVSSSBpZiB0aGUgcmVxdWVzdCBpcyBhY2NlcHRlZAogICAgICAgIGlmKHJlcXVlc3QuaGFzSGVhZGVyKCdjb250YWN0JykpIHsKICAgICAgICAgIHJlcXVlc3Quc2VydmVyX3RyYW5zYWN0aW9uLm9uKCdzdGF0ZUNoYW5nZWQnLCBmdW5jdGlvbigpewogICAgICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gU0lQLlRyYW5zYWN0aW9ucy5DLlNUQVRVU19DT01QTEVURUQpIHsKICAgICAgICAgICAgICBzZWxmLnJlbW90ZV90YXJnZXQgPSByZXF1ZXN0LnBhcnNlSGVhZGVyKCdjb250YWN0JykudXJpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfSwKCiAgc2VuZFJlcXVlc3Q6IGZ1bmN0aW9uKGFwcGxpY2FudCwgbWV0aG9kLCBvcHRpb25zKSB7CiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgICB2YXIKICAgICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgICBib2R5ID0gb3B0aW9ucy5ib2R5IHx8IG51bGwsCiAgICAgIHJlcXVlc3QgPSB0aGlzLmNyZWF0ZVJlcXVlc3QobWV0aG9kLCBleHRyYUhlYWRlcnMsIGJvZHkpLAogICAgICByZXF1ZXN0X3NlbmRlciA9IG5ldyBSZXF1ZXN0U2VuZGVyKHRoaXMsIGFwcGxpY2FudCwgcmVxdWVzdCk7CgogICAgcmVxdWVzdF9zZW5kZXIuc2VuZCgpOwoKICAgIHJldHVybiByZXF1ZXN0OwogIH0sCgogIC8qKgogICogQHBhcmFtIHtTSVAuSW5jb21pbmdSZXF1ZXN0fSByZXF1ZXN0CiAgKi8KICByZWNlaXZlUmVxdWVzdDogZnVuY3Rpb24ocmVxdWVzdCkgewogICAgLy9DaGVjayBpbi1kaWFsb2cgcmVxdWVzdAogICAgaWYoIXRoaXMuY2hlY2tJbkRpYWxvZ1JlcXVlc3QocmVxdWVzdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMub3duZXIucmVjZWl2ZVJlcXVlc3QocmVxdWVzdCk7CiAgfQp9OwoKRGlhbG9nLkMgPSBDOwpTSVAuRGlhbG9nID0gRGlhbG9nOwp9OwoKfSx7Ii4vRGlhbG9nL1JlcXVlc3RTZW5kZXIiOjl9XSwxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCi8qKgogKiBAZmlsZW92ZXJ2aWV3IFNJUCBEaWdlc3QgQXV0aGVudGljYXRpb24KICovCgovKioKICogU0lQIERpZ2VzdCBBdXRoZW50aWNhdGlvbi4KICogQGF1Z21lbnRzIFNJUC4KICogQGZ1bmN0aW9uIERpZ2VzdCBBdXRoZW50aWNhdGlvbgogKiBAcGFyYW0ge1NJUC5VQX0gdWEKICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFV0aWxzKSB7CnZhciBEaWdlc3RBdXRoZW50aWNhdGlvbjsKCkRpZ2VzdEF1dGhlbnRpY2F0aW9uID0gZnVuY3Rpb24odWEpIHsKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwanMuZGlnZXN0YXV0aGVudGljYXRpb24nKTsKICB0aGlzLnVzZXJuYW1lID0gdWEuY29uZmlndXJhdGlvbi5hdXRob3JpemF0aW9uVXNlcjsKICB0aGlzLnBhc3N3b3JkID0gdWEuY29uZmlndXJhdGlvbi5wYXNzd29yZDsKICB0aGlzLmNub25jZSA9IG51bGw7CiAgdGhpcy5uYyA9IDA7CiAgdGhpcy5uY0hleCA9ICcwMDAwMDAwMCc7CiAgdGhpcy5yZXNwb25zZSA9IG51bGw7Cn07CgoKLyoqCiogUGVyZm9ybXMgRGlnZXN0IGF1dGhlbnRpY2F0aW9uIGdpdmVuIGEgU0lQIHJlcXVlc3QgYW5kIHRoZSBjaGFsbGVuZ2UKKiByZWNlaXZlZCBpbiBhIHJlc3BvbnNlIHRvIHRoYXQgcmVxdWVzdC4KKiBSZXR1cm5zIHRydWUgaWYgY3JlZGVudGlhbHMgd2VyZSBzdWNjZXNzZnVsbHkgZ2VuZXJhdGVkLCBmYWxzZSBvdGhlcndpc2UuCioKKiBAcGFyYW0ge1NJUC5PdXRnb2luZ1JlcXVlc3R9IHJlcXVlc3QKKiBAcGFyYW0ge09iamVjdH0gY2hhbGxlbmdlCiovCkRpZ2VzdEF1dGhlbnRpY2F0aW9uLnByb3RvdHlwZS5hdXRoZW50aWNhdGUgPSBmdW5jdGlvbihyZXF1ZXN0LCBjaGFsbGVuZ2UpIHsKICAvLyBJbnNwZWN0IGFuZCB2YWxpZGF0ZSB0aGUgY2hhbGxlbmdlLgoKICB0aGlzLmFsZ29yaXRobSA9IGNoYWxsZW5nZS5hbGdvcml0aG07CiAgdGhpcy5yZWFsbSA9IGNoYWxsZW5nZS5yZWFsbTsKICB0aGlzLm5vbmNlID0gY2hhbGxlbmdlLm5vbmNlOwogIHRoaXMub3BhcXVlID0gY2hhbGxlbmdlLm9wYXF1ZTsKICB0aGlzLnN0YWxlID0gY2hhbGxlbmdlLnN0YWxlOwoKICBpZiAodGhpcy5hbGdvcml0aG0pIHsKICAgIGlmICh0aGlzLmFsZ29yaXRobSAhPT0gJ01ENScpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybignY2hhbGxlbmdlIHdpdGggRGlnZXN0IGFsZ29yaXRobSBkaWZmZXJlbnQgdGhhbiAiTUQ1IiwgYXV0aGVudGljYXRpb24gYWJvcnRlZCcpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSBlbHNlIHsKICAgIHRoaXMuYWxnb3JpdGhtID0gJ01ENSc7CiAgfQoKICBpZiAoISB0aGlzLnJlYWxtKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCdjaGFsbGVuZ2Ugd2l0aG91dCBEaWdlc3QgcmVhbG0sIGF1dGhlbnRpY2F0aW9uIGFib3J0ZWQnKTsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGlmICghIHRoaXMubm9uY2UpIHsKICAgIHRoaXMubG9nZ2VyLndhcm4oJ2NoYWxsZW5nZSB3aXRob3V0IERpZ2VzdCBub25jZSwgYXV0aGVudGljYXRpb24gYWJvcnRlZCcpOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgLy8gJ3FvcCcgY2FuIGNvbnRhaW4gYSBsaXN0IG9mIHZhbHVlcyAoQXJyYXkpLiBMZXQncyBjaG9vc2UganVzdCBvbmUuCiAgaWYgKGNoYWxsZW5nZS5xb3ApIHsKICAgIGlmIChjaGFsbGVuZ2UucW9wLmluZGV4T2YoJ2F1dGgnKSA+IC0xKSB7CiAgICAgIHRoaXMucW9wID0gJ2F1dGgnOwogICAgfSBlbHNlIGlmIChjaGFsbGVuZ2UucW9wLmluZGV4T2YoJ2F1dGgtaW50JykgPiAtMSkgewogICAgICB0aGlzLnFvcCA9ICdhdXRoLWludCc7CiAgICB9IGVsc2UgewogICAgICAvLyBPdGhlcndpc2UgJ3FvcCcgaXMgcHJlc2VudCBidXQgZG9lcyBub3QgY29udGFpbiAnYXV0aCcgb3IgJ2F1dGgtaW50Jywgc28gYWJvcnQgaGVyZS4KICAgICAgdGhpcy5sb2dnZXIud2FybignY2hhbGxlbmdlIHdpdGhvdXQgRGlnZXN0IHFvcCBkaWZmZXJlbnQgdGhhbiAiYXV0aCIgb3IgImF1dGgtaW50IiwgYXV0aGVudGljYXRpb24gYWJvcnRlZCcpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSBlbHNlIHsKICAgIHRoaXMucW9wID0gbnVsbDsKICB9CgogIC8vIEZpbGwgb3RoZXIgYXR0cmlidXRlcy4KCiAgdGhpcy5tZXRob2QgPSByZXF1ZXN0Lm1ldGhvZDsKICB0aGlzLnVyaSA9IHJlcXVlc3QucnVyaTsKICB0aGlzLmNub25jZSA9IFV0aWxzLmNyZWF0ZVJhbmRvbVRva2VuKDEyKTsKICB0aGlzLm5jICs9IDE7CiAgdGhpcy51cGRhdGVOY0hleCgpOwoKICAvLyBuYy12YWx1ZSA9IDhMSEVYLiBNYXggdmFsdWUgPSAnRkZGRkZGRkYnLgogIGlmICh0aGlzLm5jID09PSA0Mjk0OTY3Mjk2KSB7CiAgICB0aGlzLm5jID0gMTsKICAgIHRoaXMubmNIZXggPSAnMDAwMDAwMDEnOwogIH0KCiAgLy8gQ2FsY3VsYXRlIHRoZSBEaWdlc3QgInJlc3BvbnNlIiB2YWx1ZS4KICB0aGlzLmNhbGN1bGF0ZVJlc3BvbnNlKCk7CgogIHJldHVybiB0cnVlOwp9OwoKCi8qKgoqIEdlbmVyYXRlIERpZ2VzdCAncmVzcG9uc2UnIHZhbHVlLgoqIEBwcml2YXRlCiovCkRpZ2VzdEF1dGhlbnRpY2F0aW9uLnByb3RvdHlwZS5jYWxjdWxhdGVSZXNwb25zZSA9IGZ1bmN0aW9uKCkgewogIHZhciBoYTEsIGhhMjsKCiAgLy8gSEExID0gTUQ1KEExKSA9IE1ENSh1c2VybmFtZTpyZWFsbTpwYXNzd29yZCkKICBoYTEgPSBVdGlscy5jYWxjdWxhdGVNRDUodGhpcy51c2VybmFtZSArICI6IiArIHRoaXMucmVhbG0gKyAiOiIgKyB0aGlzLnBhc3N3b3JkKTsKCiAgaWYgKHRoaXMucW9wID09PSAnYXV0aCcpIHsKICAgIC8vIEhBMiA9IE1ENShBMikgPSBNRDUobWV0aG9kOmRpZ2VzdFVSSSkKICAgIGhhMiA9IFV0aWxzLmNhbGN1bGF0ZU1ENSh0aGlzLm1ldGhvZCArICI6IiArIHRoaXMudXJpKTsKICAgIC8vIHJlc3BvbnNlID0gTUQ1KEhBMTpub25jZTpub25jZUNvdW50OmNyZWRlbnRpYWxzTm9uY2U6cW9wOkhBMikKICAgIHRoaXMucmVzcG9uc2UgPSBVdGlscy5jYWxjdWxhdGVNRDUoaGExICsgIjoiICsgdGhpcy5ub25jZSArICI6IiArIHRoaXMubmNIZXggKyAiOiIgKyB0aGlzLmNub25jZSArICI6YXV0aDoiICsgaGEyKTsKCiAgfSBlbHNlIGlmICh0aGlzLnFvcCA9PT0gJ2F1dGgtaW50JykgewogICAgLy8gSEEyID0gTUQ1KEEyKSA9IE1ENShtZXRob2Q6ZGlnZXN0VVJJOk1ENShlbnRpdHlCb2R5KSkKICAgIGhhMiA9IFV0aWxzLmNhbGN1bGF0ZU1ENSh0aGlzLm1ldGhvZCArICI6IiArIHRoaXMudXJpICsgIjoiICsgVXRpbHMuY2FsY3VsYXRlTUQ1KHRoaXMuYm9keSA/IHRoaXMuYm9keSA6ICIiKSk7CiAgICAvLyByZXNwb25zZSA9IE1ENShIQTE6bm9uY2U6bm9uY2VDb3VudDpjcmVkZW50aWFsc05vbmNlOnFvcDpIQTIpCiAgICB0aGlzLnJlc3BvbnNlID0gVXRpbHMuY2FsY3VsYXRlTUQ1KGhhMSArICI6IiArIHRoaXMubm9uY2UgKyAiOiIgKyB0aGlzLm5jSGV4ICsgIjoiICsgdGhpcy5jbm9uY2UgKyAiOmF1dGgtaW50OiIgKyBoYTIpOwoKICB9IGVsc2UgaWYgKHRoaXMucW9wID09PSBudWxsKSB7CiAgICAvLyBIQTIgPSBNRDUoQTIpID0gTUQ1KG1ldGhvZDpkaWdlc3RVUkkpCiAgICBoYTIgPSBVdGlscy5jYWxjdWxhdGVNRDUodGhpcy5tZXRob2QgKyAiOiIgKyB0aGlzLnVyaSk7CiAgICAvLyByZXNwb25zZSA9IE1ENShIQTE6bm9uY2U6SEEyKQogICAgdGhpcy5yZXNwb25zZSA9IFV0aWxzLmNhbGN1bGF0ZU1ENShoYTEgKyAiOiIgKyB0aGlzLm5vbmNlICsgIjoiICsgaGEyKTsKICB9Cn07CgoKLyoqCiogUmV0dXJuIHRoZSBQcm94eS1BdXRob3JpemF0aW9uIG9yIFdXVy1BdXRob3JpemF0aW9uIGhlYWRlciB2YWx1ZS4KKi8KRGlnZXN0QXV0aGVudGljYXRpb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7CiAgdmFyIGF1dGhfcGFyYW1zID0gW107CgogIGlmICghIHRoaXMucmVzcG9uc2UpIHsKICAgIHRocm93IG5ldyBFcnJvcigncmVzcG9uc2UgZmllbGQgZG9lcyBub3QgZXhpc3QsIGNhbm5vdCBnZW5lcmF0ZSBBdXRob3JpemF0aW9uIGhlYWRlcicpOwogIH0KCiAgYXV0aF9wYXJhbXMucHVzaCgnYWxnb3JpdGhtPScgKyB0aGlzLmFsZ29yaXRobSk7CiAgYXV0aF9wYXJhbXMucHVzaCgndXNlcm5hbWU9IicgKyB0aGlzLnVzZXJuYW1lICsgJyInKTsKICBhdXRoX3BhcmFtcy5wdXNoKCdyZWFsbT0iJyArIHRoaXMucmVhbG0gKyAnIicpOwogIGF1dGhfcGFyYW1zLnB1c2goJ25vbmNlPSInICsgdGhpcy5ub25jZSArICciJyk7CiAgYXV0aF9wYXJhbXMucHVzaCgndXJpPSInICsgdGhpcy51cmkgKyAnIicpOwogIGF1dGhfcGFyYW1zLnB1c2goJ3Jlc3BvbnNlPSInICsgdGhpcy5yZXNwb25zZSArICciJyk7CiAgaWYgKHRoaXMub3BhcXVlKSB7CiAgICBhdXRoX3BhcmFtcy5wdXNoKCdvcGFxdWU9IicgKyB0aGlzLm9wYXF1ZSArICciJyk7CiAgfQogIGlmICh0aGlzLnFvcCkgewogICAgYXV0aF9wYXJhbXMucHVzaCgncW9wPScgKyB0aGlzLnFvcCk7CiAgICBhdXRoX3BhcmFtcy5wdXNoKCdjbm9uY2U9IicgKyB0aGlzLmNub25jZSArICciJyk7CiAgICBhdXRoX3BhcmFtcy5wdXNoKCduYz0nICsgdGhpcy5uY0hleCk7CiAgfQoKICByZXR1cm4gJ0RpZ2VzdCAnICsgYXV0aF9wYXJhbXMuam9pbignLCAnKTsKfTsKCgovKioKKiBHZW5lcmF0ZSB0aGUgJ25jJyB2YWx1ZSBhcyByZXF1aXJlZCBieSBEaWdlc3QgaW4gdGhpcy5uY0hleCBieSByZWFkaW5nIHRoaXMubmMuCiogQHByaXZhdGUKKi8KRGlnZXN0QXV0aGVudGljYXRpb24ucHJvdG90eXBlLnVwZGF0ZU5jSGV4ID0gZnVuY3Rpb24oKSB7CiAgdmFyIGhleCA9IE51bWJlcih0aGlzLm5jKS50b1N0cmluZygxNik7CiAgdGhpcy5uY0hleCA9ICcwMDAwMDAwMCcuc3Vic3RyKDAsIDgtaGV4Lmxlbmd0aCkgKyBoZXg7Cn07CgpyZXR1cm4gRGlnZXN0QXV0aGVudGljYXRpb247Cn07Cgp9LHt9XSwxMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKdmFyIE5vZGVFdmVudEVtaXR0ZXIgPSByZXF1aXJlKCdldmVudHMnKS5FdmVudEVtaXR0ZXI7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChjb25zb2xlKSB7CgovLyBEb24ndCB1c2UgYG5ldyBTSVAuRXZlbnRFbWl0dGVyKClgIGZvciBpbmhlcml0aW5nLgovLyBVc2UgT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdG95cGUpOwpmdW5jdGlvbiBFdmVudEVtaXR0ZXIgKCkgewogIE5vZGVFdmVudEVtaXR0ZXIuY2FsbCh0aGlzKTsKfQoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTm9kZUV2ZW50RW1pdHRlci5wcm90b3R5cGUsIHsKICBjb25zdHJ1Y3RvcjogewogICAgdmFsdWU6IEV2ZW50RW1pdHRlciwKICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgd3JpdGFibGU6IHRydWUsCiAgICBjb25maWd1cmFibGU6IHRydWUKICB9Cn0pOwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiBvZmYgKGV2ZW50TmFtZSwgbGlzdGVuZXIpIHsKICB2YXIgd2FybmluZyA9ICcnOwogIHdhcm5pbmcgKz0gJ1NJUC5FdmVudEVtaXR0ZXIjb2ZmIGlzIGRlcHJlY2F0ZWQgYW5kIG1heSBiZSByZW1vdmVkIGluIGZ1dHVyZSBTSVAuanMgdmVyc2lvbnMuXG4nOwogIHdhcm5pbmcgKz0gJ1BsZWFzZSB1c2UgcmVtb3ZlTGlzdGVuZXIgb3IgcmVtb3ZlQWxsTGlzdGVuZXJzIGluc3RlYWQuXG4nOwogIHdhcm5pbmcgKz0gJ1NlZSBoZXJlIGZvciBtb3JlIGRldGFpbHM6XG4nOwogIHdhcm5pbmcgKz0gJ2h0dHA6Ly9ub2RlanMub3JnL2FwaS9ldmVudHMuaHRtbCNldmVudHNfZW1pdHRlcl9yZW1vdmVsaXN0ZW5lcl9ldmVudF9saXN0ZW5lcic7CiAgY29uc29sZS53YXJuKHdhcm5pbmcpOwoKICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDIpIHsKICAgIHJldHVybiB0aGlzLnJlbW92ZUFsbExpc3RlbmVycy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdGhpcy5yZW1vdmVMaXN0ZW5lcihldmVudE5hbWUsIGxpc3RlbmVyKTsKICB9Cn07CgpyZXR1cm4gRXZlbnRFbWl0dGVyOwoKfTsKCn0seyJldmVudHMiOjQ0fV0sMTM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IEV4Y2VwdGlvbnMKICovCgovKioKICogU0lQIEV4Y2VwdGlvbnMuCiAqIEBhdWdtZW50cyBTSVAKICovCm1vZHVsZS5leHBvcnRzID0gewogIENvbmZpZ3VyYXRpb25FcnJvcjogKGZ1bmN0aW9uKCl7CiAgICB2YXIgZXhjZXB0aW9uID0gZnVuY3Rpb24ocGFyYW1ldGVyLCB2YWx1ZSkgewogICAgICB0aGlzLmNvZGUgPSAxOwogICAgICB0aGlzLm5hbWUgPSAnQ09ORklHVVJBVElPTl9FUlJPUic7CiAgICAgIHRoaXMucGFyYW1ldGVyID0gcGFyYW1ldGVyOwogICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CiAgICAgIHRoaXMubWVzc2FnZSA9ICghdGhpcy52YWx1ZSk/ICdNaXNzaW5nIHBhcmFtZXRlcjogJysgdGhpcy5wYXJhbWV0ZXIgOiAnSW52YWxpZCB2YWx1ZSAnKyBKU09OLnN0cmluZ2lmeSh0aGlzLnZhbHVlKSArJyBmb3IgcGFyYW1ldGVyICInKyB0aGlzLnBhcmFtZXRlciArJyInOwogICAgfTsKICAgIGV4Y2VwdGlvbi5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTsKICAgIHJldHVybiBleGNlcHRpb247CiAgfSgpKSwKCiAgSW52YWxpZFN0YXRlRXJyb3I6IChmdW5jdGlvbigpewogICAgdmFyIGV4Y2VwdGlvbiA9IGZ1bmN0aW9uKHN0YXR1cykgewogICAgICB0aGlzLmNvZGUgPSAyOwogICAgICB0aGlzLm5hbWUgPSAnSU5WQUxJRF9TVEFURV9FUlJPUic7CiAgICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzOwogICAgICB0aGlzLm1lc3NhZ2UgPSAnSW52YWxpZCBzdGF0dXM6ICcgKyBzdGF0dXM7CiAgICB9OwogICAgZXhjZXB0aW9uLnByb3RvdHlwZSA9IG5ldyBFcnJvcigpOwogICAgcmV0dXJuIGV4Y2VwdGlvbjsKICB9KCkpLAoKICBOb3RTdXBwb3J0ZWRFcnJvcjogKGZ1bmN0aW9uKCl7CiAgICB2YXIgZXhjZXB0aW9uID0gZnVuY3Rpb24obWVzc2FnZSkgewogICAgICB0aGlzLmNvZGUgPSAzOwogICAgICB0aGlzLm5hbWUgPSAnTk9UX1NVUFBPUlRFRF9FUlJPUic7CiAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7CiAgICB9OwogICAgZXhjZXB0aW9uLnByb3RvdHlwZSA9IG5ldyBFcnJvcigpOwogICAgcmV0dXJuIGV4Y2VwdGlvbjsKICB9KCkpLAoKICBHZXREZXNjcmlwdGlvbkVycm9yOiAoZnVuY3Rpb24oKXsKICAgIHZhciBleGNlcHRpb24gPSBmdW5jdGlvbihtZXNzYWdlKSB7CiAgICAgIHRoaXMuY29kZSA9IDQ7CiAgICAgIHRoaXMubmFtZSA9ICdHRVRfREVTQ1JJUFRJT05fRVJST1InOwogICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlOwogICAgfTsKICAgIGV4Y2VwdGlvbi5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTsKICAgIHJldHVybiBleGNlcHRpb247CiAgfSgpKQp9OwoKfSx7fV0sMTQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CnZhciBHcmFtbWFyID0gcmVxdWlyZSgnLi9HcmFtbWFyL2Rpc3QvR3JhbW1hcicpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CgpyZXR1cm4gewogIHBhcnNlOiBmdW5jdGlvbiBwYXJzZUN1c3RvbSAoaW5wdXQsIHN0YXJ0UnVsZSkgewogICAgdmFyIG9wdGlvbnMgPSB7c3RhcnRSdWxlOiBzdGFydFJ1bGUsIFNJUDogU0lQfTsKICAgIHRyeSB7CiAgICAgIEdyYW1tYXIucGFyc2UoaW5wdXQsIG9wdGlvbnMpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBvcHRpb25zLmRhdGEgPSAtMTsKICAgIH0KICAgIHJldHVybiBvcHRpb25zLmRhdGE7CiAgfQp9OwoKfTsKCn0seyIuL0dyYW1tYXIvZGlzdC9HcmFtbWFyIjoxNX1dLDE1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKbW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7CiAgLyoKICAgKiBHZW5lcmF0ZWQgYnkgUEVHLmpzIDAuOC4wLgogICAqCiAgICogaHR0cDovL3BlZ2pzLm1hamRhLmN6LwogICAqLwoKICBmdW5jdGlvbiBwZWckc3ViY2xhc3MoY2hpbGQsIHBhcmVudCkgewogICAgZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9CiAgICBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7CiAgICBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOwogIH0KCiAgZnVuY3Rpb24gU3ludGF4RXJyb3IobWVzc2FnZSwgZXhwZWN0ZWQsIGZvdW5kLCBvZmZzZXQsIGxpbmUsIGNvbHVtbikgewogICAgdGhpcy5tZXNzYWdlICA9IG1lc3NhZ2U7CiAgICB0aGlzLmV4cGVjdGVkID0gZXhwZWN0ZWQ7CiAgICB0aGlzLmZvdW5kICAgID0gZm91bmQ7CiAgICB0aGlzLm9mZnNldCAgID0gb2Zmc2V0OwogICAgdGhpcy5saW5lICAgICA9IGxpbmU7CiAgICB0aGlzLmNvbHVtbiAgID0gY29sdW1uOwoKICAgIHRoaXMubmFtZSAgICAgPSAiU3ludGF4RXJyb3IiOwogIH0KCiAgcGVnJHN1YmNsYXNzKFN5bnRheEVycm9yLCBFcnJvcik7CgogIGZ1bmN0aW9uIHBhcnNlKGlucHV0KSB7CiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDoge30sCgogICAgICAgIHBlZyRGQUlMRUQgPSB7fSwKCiAgICAgICAgcGVnJHN0YXJ0UnVsZUluZGljZXMgPSB7IENvbnRhY3Q6IDExOCwgTmFtZV9BZGRyX0hlYWRlcjogMTU1LCBSZWNvcmRfUm91dGU6IDE3NSwgUmVxdWVzdF9SZXNwb25zZTogODEsIFNJUF9VUkk6IDQ1LCBTdWJzY3JpcHRpb25fU3RhdGU6IDE4NSwgU3VwcG9ydGVkOiAxOTAsIFJlcXVpcmU6IDE4MSwgVmlhOiAxOTMsIGFic29sdXRlVVJJOiA4NCwgQ2FsbF9JRDogMTE3LCBDb250ZW50X0Rpc3Bvc2l0aW9uOiAxMjksIENvbnRlbnRfTGVuZ3RoOiAxMzQsIENvbnRlbnRfVHlwZTogMTM1LCBDU2VxOiAxNDUsIGRpc3BsYXlOYW1lOiAxMjEsIEV2ZW50OiAxNDgsIEZyb206IDE1MCwgaG9zdDogNTIsIE1heF9Gb3J3YXJkczogMTUzLCBNaW5fU0U6IDIxMiwgUHJveHlfQXV0aGVudGljYXRlOiAxNTYsIHF1b3RlZF9zdHJpbmc6IDQwLCBSZWZlcl9UbzogMTc3LCBSZXBsYWNlczogMTc4LCBTZXNzaW9uX0V4cGlyZXM6IDIwOSwgc3R1bl9VUkk6IDIxNiwgVG86IDE5MSwgdHVybl9VUkk6IDIyMywgdXVpZDogMjI2LCBXV1dfQXV0aGVudGljYXRlOiAyMDgsIGNoYWxsZW5nZTogMTU3IH0sCiAgICAgICAgcGVnJHN0YXJ0UnVsZUluZGV4ICAgPSAxMTgsCgogICAgICAgIHBlZyRjb25zdHMgPSBbCiAgICAgICAgICAiXHJcbiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJcclxuIiwgZGVzY3JpcHRpb246ICJcIlxcclxcblwiIiB9LAogICAgICAgICAgL15bMC05XS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiWzAtOV0iLCBkZXNjcmlwdGlvbjogIlswLTldIiB9LAogICAgICAgICAgL15bYS16QS1aXS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW2EtekEtWl0iLCBkZXNjcmlwdGlvbjogIlthLXpBLVpdIiB9LAogICAgICAgICAgL15bMC05YS1mQS1GXS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiWzAtOWEtZkEtRl0iLCBkZXNjcmlwdGlvbjogIlswLTlhLWZBLUZdIiB9LAogICAgICAgICAgL15bXDAtXHhGRl0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcXDAtXFx4RkZdIiwgZGVzY3JpcHRpb246ICJbXFwwLVxceEZGXSIgfSwKICAgICAgICAgIC9eWyJdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbXCJdIiwgZGVzY3JpcHRpb246ICJbXCJdIiB9LAogICAgICAgICAgIiAiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiICIsIGRlc2NyaXB0aW9uOiAiXCIgXCIiIH0sCiAgICAgICAgICAiXHQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiXHQiLCBkZXNjcmlwdGlvbjogIlwiXFx0XCIiIH0sCiAgICAgICAgICAvXlthLXpBLVowLTldLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbYS16QS1aMC05XSIsIGRlc2NyaXB0aW9uOiAiW2EtekEtWjAtOV0iIH0sCiAgICAgICAgICAiOyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICI7IiwgZGVzY3JpcHRpb246ICJcIjtcIiIgfSwKICAgICAgICAgICIvIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIi8iLCBkZXNjcmlwdGlvbjogIlwiL1wiIiB9LAogICAgICAgICAgIj8iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiPyIsIGRlc2NyaXB0aW9uOiAiXCI/XCIiIH0sCiAgICAgICAgICAiOiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICI6IiwgZGVzY3JpcHRpb246ICJcIjpcIiIgfSwKICAgICAgICAgICJAIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIkAiLCBkZXNjcmlwdGlvbjogIlwiQFwiIiB9LAogICAgICAgICAgIiYiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiJiIsIGRlc2NyaXB0aW9uOiAiXCImXCIiIH0sCiAgICAgICAgICAiPSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICI9IiwgZGVzY3JpcHRpb246ICJcIj1cIiIgfSwKICAgICAgICAgICIrIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIisiLCBkZXNjcmlwdGlvbjogIlwiK1wiIiB9LAogICAgICAgICAgIiQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiJCIsIGRlc2NyaXB0aW9uOiAiXCIkXCIiIH0sCiAgICAgICAgICAiLCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIsIiwgZGVzY3JpcHRpb246ICJcIixcIiIgfSwKICAgICAgICAgICItIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIi0iLCBkZXNjcmlwdGlvbjogIlwiLVwiIiB9LAogICAgICAgICAgIl8iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiXyIsIGRlc2NyaXB0aW9uOiAiXCJfXCIiIH0sCiAgICAgICAgICAiLiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIuIiwgZGVzY3JpcHRpb246ICJcIi5cIiIgfSwKICAgICAgICAgICIhIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIiEiLCBkZXNjcmlwdGlvbjogIlwiIVwiIiB9LAogICAgICAgICAgIn4iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAifiIsIGRlc2NyaXB0aW9uOiAiXCJ+XCIiIH0sCiAgICAgICAgICAiKiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIqIiwgZGVzY3JpcHRpb246ICJcIipcIiIgfSwKICAgICAgICAgICInIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIiciLCBkZXNjcmlwdGlvbjogIlwiJ1wiIiB9LAogICAgICAgICAgIigiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiKCIsIGRlc2NyaXB0aW9uOiAiXCIoXCIiIH0sCiAgICAgICAgICAiKSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIpIiwgZGVzY3JpcHRpb246ICJcIilcIiIgfSwKICAgICAgICAgIHBlZyRGQUlMRUQsCiAgICAgICAgICAiJSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICIlIiwgZGVzY3JpcHRpb246ICJcIiVcIiIgfSwKICAgICAgICAgIG51bGwsCiAgICAgICAgICBbXSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiICI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gJzonOyB9LAogICAgICAgICAgL15bIS1+XS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiWyEtfl0iLCBkZXNjcmlwdGlvbjogIlshLX5dIiB9LAogICAgICAgICAgL15bXHg4MC1cdUZGRkZdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbXFx4ODAtXFx1RkZGRl0iLCBkZXNjcmlwdGlvbjogIltcXHg4MC1cXHVGRkZGXSIgfSwKICAgICAgICAgIC9eW1x4ODAtXHhCRl0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcXHg4MC1cXHhCRl0iLCBkZXNjcmlwdGlvbjogIltcXHg4MC1cXHhCRl0iIH0sCiAgICAgICAgICAvXlthLWZdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbYS1mXSIsIGRlc2NyaXB0aW9uOiAiW2EtZl0iIH0sCiAgICAgICAgICAiYCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJgIiwgZGVzY3JpcHRpb246ICJcImBcIiIgfSwKICAgICAgICAgICI8IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIjwiLCBkZXNjcmlwdGlvbjogIlwiPFwiIiB9LAogICAgICAgICAgIj4iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiPiIsIGRlc2NyaXB0aW9uOiAiXCI+XCIiIH0sCiAgICAgICAgICAiXFwiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiXFwiLCBkZXNjcmlwdGlvbjogIlwiXFxcXFwiIiB9LAogICAgICAgICAgIlsiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiWyIsIGRlc2NyaXB0aW9uOiAiXCJbXCIiIH0sCiAgICAgICAgICAiXSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJdIiwgZGVzY3JpcHRpb246ICJcIl1cIiIgfSwKICAgICAgICAgICJ7IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInsiLCBkZXNjcmlwdGlvbjogIlwie1wiIiB9LAogICAgICAgICAgIn0iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAifSIsIGRlc2NyaXB0aW9uOiAiXCJ9XCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIioiOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICIvIjsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiPSI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIigiOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICIpIjsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiPiI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIjwiOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICIsIjsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkge3JldHVybiAiOyI7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHtyZXR1cm4gIjoiOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7cmV0dXJuICJcIiI7IH0sCiAgICAgICAgICAvXlshLSddLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbIS0nXSIsIGRlc2NyaXB0aW9uOiAiWyEtJ10iIH0sCiAgICAgICAgICAvXlsqLVtdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbKi1bXSIsIGRlc2NyaXB0aW9uOiAiWyotW10iIH0sCiAgICAgICAgICAvXltcXS1+XS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW1xcXS1+XSIsIGRlc2NyaXB0aW9uOiAiW1xcXS1+XSIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGNvbnRlbnRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGVudHM7IH0sCiAgICAgICAgICAvXlsjLVtdLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbIy1bXSIsIGRlc2NyaXB0aW9uOiAiWyMtW10iIH0sCiAgICAgICAgICAvXltcMC1cdF0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcXDAtXFx0XSIsIGRlc2NyaXB0aW9uOiAiW1xcMC1cXHRdIiB9LAogICAgICAgICAgL15bXHgwQi1cZl0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcXHgwQi1cXGZdIiwgZGVzY3JpcHRpb246ICJbXFx4MEItXFxmXSIgfSwKICAgICAgICAgIC9eW1x4MEUtf10vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIltcXHgwRS1/XSIsIGRlc2NyaXB0aW9uOiAiW1xceDBFLX9dIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpID0gbmV3IG9wdGlvbnMuU0lQLlVSSShvcHRpb25zLmRhdGEuc2NoZW1lLCBvcHRpb25zLmRhdGEudXNlciwgb3B0aW9ucy5kYXRhLmhvc3QsIG9wdGlvbnMuZGF0YS5wb3J0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEuc2NoZW1lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS51c2VyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5ob3N0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5ob3N0X3R5cGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnBvcnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaSA9IG5ldyBvcHRpb25zLlNJUC5VUkkob3B0aW9ucy5kYXRhLnNjaGVtZSwgb3B0aW9ucy5kYXRhLnVzZXIsIG9wdGlvbnMuZGF0YS5ob3N0LCBvcHRpb25zLmRhdGEucG9ydCwgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXMsIG9wdGlvbnMuZGF0YS51cmlfaGVhZGVycyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnNjaGVtZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEudXNlcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEuaG9zdDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEuaG9zdF90eXBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5wb3J0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS51cmlfcGFyYW1zOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXJ0UnVsZSA9PT0gJ1NJUF9VUkknKSB7IG9wdGlvbnMuZGF0YSA9IG9wdGlvbnMuZGF0YS51cmk7fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAic2lwcyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJzaXBzIiwgZGVzY3JpcHRpb246ICJcInNpcHNcIiIgfSwKICAgICAgICAgICJzaXAiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAic2lwIiwgZGVzY3JpcHRpb246ICJcInNpcFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24odXJpX3NjaGVtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuc2NoZW1lID0gdXJpX3NjaGVtZTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXNlciA9IGRlY29kZVVSSUNvbXBvbmVudCh0ZXh0KCkuc2xpY2UoMCwgLTEpKTt9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5wYXNzd29yZCA9IHRleHQoKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuaG9zdCA9IHRleHQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnMuZGF0YS5ob3N0OyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuaG9zdF90eXBlID0gJ2RvbWFpbic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dCgpOyB9LAogICAgICAgICAgL15bYS16QS1aMC05X1wtXS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiW2EtekEtWjAtOV9cXC1dIiwgZGVzY3JpcHRpb246ICJbYS16QS1aMC05X1xcLV0iIH0sCiAgICAgICAgICAvXlthLXpBLVowLTlcLV0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIlthLXpBLVowLTlcXC1dIiwgZGVzY3JpcHRpb246ICJbYS16QS1aMC05XFwtXSIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuaG9zdF90eXBlID0gJ0lQdjYnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dCgpOyB9LAogICAgICAgICAgIjo6IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIjo6IiwgZGVzY3JpcHRpb246ICJcIjo6XCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5ob3N0X3R5cGUgPSAnSVB2Nic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dCgpOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5ob3N0X3R5cGUgPSAnSVB2NCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0KCk7IH0sCiAgICAgICAgICAiMjUiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiMjUiLCBkZXNjcmlwdGlvbjogIlwiMjVcIiIgfSwKICAgICAgICAgIC9eWzAtNV0vLAogICAgICAgICAgeyB0eXBlOiAiY2xhc3MiLCB2YWx1ZTogIlswLTVdIiwgZGVzY3JpcHRpb246ICJbMC01XSIgfSwKICAgICAgICAgICIyIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIjIiLCBkZXNjcmlwdGlvbjogIlwiMlwiIiB9LAogICAgICAgICAgL15bMC00XS8sCiAgICAgICAgICB7IHR5cGU6ICJjbGFzcyIsIHZhbHVlOiAiWzAtNF0iLCBkZXNjcmlwdGlvbjogIlswLTRdIiB9LAogICAgICAgICAgIjEiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiMSIsIGRlc2NyaXB0aW9uOiAiXCIxXCIiIH0sCiAgICAgICAgICAvXlsxLTldLywKICAgICAgICAgIHsgdHlwZTogImNsYXNzIiwgdmFsdWU6ICJbMS05XSIsIGRlc2NyaXB0aW9uOiAiWzEtOV0iIH0sCiAgICAgICAgICBmdW5jdGlvbihwb3J0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcnQgPSBwYXJzZUludChwb3J0LmpvaW4oJycpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnBvcnQgPSBwb3J0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9ydDsgfSwKICAgICAgICAgICJ0cmFuc3BvcnQ9IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInRyYW5zcG9ydD0iLCBkZXNjcmlwdGlvbjogIlwidHJhbnNwb3J0PVwiIiB9LAogICAgICAgICAgInVkcCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ1ZHAiLCBkZXNjcmlwdGlvbjogIlwidWRwXCIiIH0sCiAgICAgICAgICAidGNwIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInRjcCIsIGRlc2NyaXB0aW9uOiAiXCJ0Y3BcIiIgfSwKICAgICAgICAgICJzY3RwIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInNjdHAiLCBkZXNjcmlwdGlvbjogIlwic2N0cFwiIiB9LAogICAgICAgICAgInRscyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ0bHMiLCBkZXNjcmlwdGlvbjogIlwidGxzXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbih0cmFuc3BvcnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXMpIG9wdGlvbnMuZGF0YS51cmlfcGFyYW1zPXt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS51cmlfcGFyYW1zWyd0cmFuc3BvcnQnXSA9IHRyYW5zcG9ydC50b0xvd2VyQ2FzZSgpOyB9LAogICAgICAgICAgInVzZXI9IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInVzZXI9IiwgZGVzY3JpcHRpb246ICJcInVzZXI9XCIiIH0sCiAgICAgICAgICAicGhvbmUiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicGhvbmUiLCBkZXNjcmlwdGlvbjogIlwicGhvbmVcIiIgfSwKICAgICAgICAgICJpcCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJpcCIsIGRlc2NyaXB0aW9uOiAiXCJpcFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24odXNlcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEudXJpX3BhcmFtcykgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXM9e307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXNbJ3VzZXInXSA9IHVzZXIudG9Mb3dlckNhc2UoKTsgfSwKICAgICAgICAgICJtZXRob2Q9IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm1ldGhvZD0iLCBkZXNjcmlwdGlvbjogIlwibWV0aG9kPVwiIiB9LAogICAgICAgICAgZnVuY3Rpb24obWV0aG9kKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS51cmlfcGFyYW1zKSBvcHRpb25zLmRhdGEudXJpX3BhcmFtcz17fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpX3BhcmFtc1snbWV0aG9kJ10gPSBtZXRob2Q7IH0sCiAgICAgICAgICAidHRsPSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ0dGw9IiwgZGVzY3JpcHRpb246ICJcInR0bD1cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHR0bCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEucGFyYW1zKSBvcHRpb25zLmRhdGEucGFyYW1zPXt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5wYXJhbXNbJ3R0bCddID0gdHRsOyB9LAogICAgICAgICAgIm1hZGRyPSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJtYWRkcj0iLCBkZXNjcmlwdGlvbjogIlwibWFkZHI9XCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihtYWRkcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEudXJpX3BhcmFtcykgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXM9e307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXNbJ21hZGRyJ10gPSBtYWRkcjsgfSwKICAgICAgICAgICJsciIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJsciIsIGRlc2NyaXB0aW9uOiAiXCJsclwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS51cmlfcGFyYW1zKSBvcHRpb25zLmRhdGEudXJpX3BhcmFtcz17fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpX3BhcmFtc1snbHInXSA9IHVuZGVmaW5lZDsgfSwKICAgICAgICAgIGZ1bmN0aW9uKHBhcmFtLCB2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEudXJpX3BhcmFtcykgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXMgPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZVsxXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXNbcGFyYW0udG9Mb3dlckNhc2UoKV0gPSB2YWx1ZSAmJiB2YWx1ZS50b0xvd2VyQ2FzZSgpO30sCiAgICAgICAgICBmdW5jdGlvbihobmFtZSwgaHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG5hbWUgPSBobmFtZS5qb2luKCcnKS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh2YWx1ZSA9IGh2YWx1ZS5qb2luKCcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighb3B0aW9ucy5kYXRhLnVyaV9oZWFkZXJzKSBvcHRpb25zLmRhdGEudXJpX2hlYWRlcnMgPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMuZGF0YS51cmlfaGVhZGVyc1tobmFtZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS51cmlfaGVhZGVyc1tobmFtZV0gPSBbaHZhbHVlXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnVyaV9oZWFkZXJzW2huYW1lXS5wdXNoKGh2YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsb3RzIG9mIHRlc3RzIGZhaWwgaWYgdGhpcyBpc24ndCBndWFyZGVkLi4uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3RhcnRSdWxlID09PSAnUmVmZXJfVG8nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudXJpID0gbmV3IG9wdGlvbnMuU0lQLlVSSShvcHRpb25zLmRhdGEuc2NoZW1lLCBvcHRpb25zLmRhdGEudXNlciwgb3B0aW9ucy5kYXRhLmhvc3QsIG9wdGlvbnMuZGF0YS5wb3J0LCBvcHRpb25zLmRhdGEudXJpX3BhcmFtcywgb3B0aW9ucy5kYXRhLnVyaV9oZWFkZXJzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEuc2NoZW1lOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS51c2VyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5ob3N0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5ob3N0X3R5cGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnBvcnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnVyaV9wYXJhbXM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgIi8vIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIi8vIiwgZGVzY3JpcHRpb246ICJcIi8vXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnNjaGVtZT0gdGV4dCgpOyB9LAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiU0lQIiwgZGVzY3JpcHRpb246ICJcIlNJUFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5zaXBfdmVyc2lvbiA9IHRleHQoKTsgfSwKICAgICAgICAgICJJTlZJVEUiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiSU5WSVRFIiwgZGVzY3JpcHRpb246ICJcIklOVklURVwiIiB9LAogICAgICAgICAgIkFDSyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJBQ0siLCBkZXNjcmlwdGlvbjogIlwiQUNLXCIiIH0sCiAgICAgICAgICAiVlhBQ0giLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiVlhBQ0giLCBkZXNjcmlwdGlvbjogIlwiVlhBQ0hcIiIgfSwKICAgICAgICAgICJPUFRJT05TIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIk9QVElPTlMiLCBkZXNjcmlwdGlvbjogIlwiT1BUSU9OU1wiIiB9LAogICAgICAgICAgIkJZRSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJCWUUiLCBkZXNjcmlwdGlvbjogIlwiQllFXCIiIH0sCiAgICAgICAgICAiQ0FOQ0VMIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIkNBTkNFTCIsIGRlc2NyaXB0aW9uOiAiXCJDQU5DRUxcIiIgfSwKICAgICAgICAgICJSRUdJU1RFUiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJSRUdJU1RFUiIsIGRlc2NyaXB0aW9uOiAiXCJSRUdJU1RFUlwiIiB9LAogICAgICAgICAgIlNVQlNDUklCRSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJTVUJTQ1JJQkUiLCBkZXNjcmlwdGlvbjogIlwiU1VCU0NSSUJFXCIiIH0sCiAgICAgICAgICAiTk9USUZZIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIk5PVElGWSIsIGRlc2NyaXB0aW9uOiAiXCJOT1RJRllcIiIgfSwKICAgICAgICAgICJSRUZFUiIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJSRUZFUiIsIGRlc2NyaXB0aW9uOiAiXCJSRUZFUlwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEubWV0aG9kID0gdGV4dCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9ucy5kYXRhLm1ldGhvZDsgfSwKICAgICAgICAgIGZ1bmN0aW9uKHN0YXR1c19jb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuc3RhdHVzX2NvZGUgPSBwYXJzZUludChzdGF0dXNfY29kZS5qb2luKCcnKSk7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5yZWFzb25fcGhyYXNlID0gdGV4dCgpOyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IHRleHQoKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCwgbGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoID0gb3B0aW9ucy5kYXRhLm11bHRpX2hlYWRlci5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXJbaWR4XS5wYXJzZWQgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5kYXRhICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSAtMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGVhZGVyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXIpIG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXIgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IG5ldyBvcHRpb25zLlNJUC5OYW1lQWRkckhlYWRlcihvcHRpb25zLmRhdGEudXJpLCBvcHRpb25zLmRhdGEuZGlzcGxheU5hbWUsIG9wdGlvbnMuZGF0YS5wYXJhbXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5kYXRhLnVyaTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5kaXNwbGF5TmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS5wYXJhbXM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXIucHVzaCggeyAncG9zaXRpb24nOiBwZWckY3VyclBvcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCc6IG9mZnNldCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncGFyc2VkJzogaGVhZGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTt9LAogICAgICAgICAgZnVuY3Rpb24oZGlzcGxheU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lID0gdGV4dCgpLnRyaW0oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXNwbGF5TmFtZVswXSA9PT0gJ1wiJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZSA9IGRpc3BsYXlOYW1lLnN1YnN0cmluZygxLCBkaXNwbGF5TmFtZS5sZW5ndGgtMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuZGlzcGxheU5hbWUgPSBkaXNwbGF5TmFtZTsgfSwKICAgICAgICAgICJxIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInEiLCBkZXNjcmlwdGlvbjogIlwicVwiIiB9LAogICAgICAgICAgZnVuY3Rpb24ocSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIW9wdGlvbnMuZGF0YS5wYXJhbXMpIG9wdGlvbnMuZGF0YS5wYXJhbXMgPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5wYXJhbXNbJ3EnXSA9IHE7IH0sCiAgICAgICAgICAiZXhwaXJlcyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJleHBpcmVzIiwgZGVzY3JpcHRpb246ICJcImV4cGlyZXNcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGV4cGlyZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEucGFyYW1zKSBvcHRpb25zLmRhdGEucGFyYW1zID0ge307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEucGFyYW1zWydleHBpcmVzJ10gPSBleHBpcmVzOyB9LAogICAgICAgICAgZnVuY3Rpb24oZGVsdGFfc2Vjb25kcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KGRlbHRhX3NlY29uZHMuam9pbignJykpOyB9LAogICAgICAgICAgIjAiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiMCIsIGRlc2NyaXB0aW9uOiAiXCIwXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHRleHQoKSk7IH0sCiAgICAgICAgICBmdW5jdGlvbihwYXJhbSwgdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEucGFyYW1zKSBvcHRpb25zLmRhdGEucGFyYW1zID0ge307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlWzFdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnBhcmFtc1twYXJhbS50b0xvd2VyQ2FzZSgpXSA9IHZhbHVlO30sCiAgICAgICAgICAicmVuZGVyIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJlbmRlciIsIGRlc2NyaXB0aW9uOiAiXCJyZW5kZXJcIiIgfSwKICAgICAgICAgICJzZXNzaW9uIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInNlc3Npb24iLCBkZXNjcmlwdGlvbjogIlwic2Vzc2lvblwiIiB9LAogICAgICAgICAgImljb24iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiaWNvbiIsIGRlc2NyaXB0aW9uOiAiXCJpY29uXCIiIH0sCiAgICAgICAgICAiYWxlcnQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiYWxlcnQiLCBkZXNjcmlwdGlvbjogIlwiYWxlcnRcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXJ0UnVsZSA9PT0gJ0NvbnRlbnRfRGlzcG9zaXRpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudHlwZSA9IHRleHQoKS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICJoYW5kbGluZyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJoYW5kbGluZyIsIGRlc2NyaXB0aW9uOiAiXCJoYW5kbGluZ1wiIiB9LAogICAgICAgICAgIm9wdGlvbmFsIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm9wdGlvbmFsIiwgZGVzY3JpcHRpb246ICJcIm9wdGlvbmFsXCIiIH0sCiAgICAgICAgICAicmVxdWlyZWQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAicmVxdWlyZWQiLCBkZXNjcmlwdGlvbjogIlwicmVxdWlyZWRcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gcGFyc2VJbnQobGVuZ3RoLmpvaW4oJycpKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gdGV4dCgpOyB9LAogICAgICAgICAgInRleHQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidGV4dCIsIGRlc2NyaXB0aW9uOiAiXCJ0ZXh0XCIiIH0sCiAgICAgICAgICAiaW1hZ2UiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiaW1hZ2UiLCBkZXNjcmlwdGlvbjogIlwiaW1hZ2VcIiIgfSwKICAgICAgICAgICJhdWRpbyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJhdWRpbyIsIGRlc2NyaXB0aW9uOiAiXCJhdWRpb1wiIiB9LAogICAgICAgICAgInZpZGVvIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInZpZGVvIiwgZGVzY3JpcHRpb246ICJcInZpZGVvXCIiIH0sCiAgICAgICAgICAiYXBwbGljYXRpb24iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiYXBwbGljYXRpb24iLCBkZXNjcmlwdGlvbjogIlwiYXBwbGljYXRpb25cIiIgfSwKICAgICAgICAgICJtZXNzYWdlIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm1lc3NhZ2UiLCBkZXNjcmlwdGlvbjogIlwibWVzc2FnZVwiIiB9LAogICAgICAgICAgIm11bHRpcGFydCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJtdWx0aXBhcnQiLCBkZXNjcmlwdGlvbjogIlwibXVsdGlwYXJ0XCIiIH0sCiAgICAgICAgICAieC0iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAieC0iLCBkZXNjcmlwdGlvbjogIlwieC1cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGNzZXFfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS52YWx1ZT1wYXJzZUludChjc2VxX3ZhbHVlLmpvaW4oJycpKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKGV4cGlyZXMpIHtvcHRpb25zLmRhdGEgPSBleHBpcmVzOyB9LAogICAgICAgICAgZnVuY3Rpb24oZXZlbnRfdHlwZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuZXZlbnQgPSBldmVudF90eXBlLnRvTG93ZXJDYXNlKCk7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFnID0gb3B0aW9ucy5kYXRhLnRhZzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IG5ldyBvcHRpb25zLlNJUC5OYW1lQWRkckhlYWRlcihvcHRpb25zLmRhdGEudXJpLCBvcHRpb25zLmRhdGEuZGlzcGxheU5hbWUsIG9wdGlvbnMuZGF0YS5wYXJhbXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhZykge29wdGlvbnMuZGF0YS5zZXRQYXJhbSgndGFnJyx0YWcpfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAidGFnIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInRhZyIsIGRlc2NyaXB0aW9uOiAiXCJ0YWdcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHRhZykge29wdGlvbnMuZGF0YS50YWcgPSB0YWc7IH0sCiAgICAgICAgICBmdW5jdGlvbihmb3J3YXJkcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gcGFyc2VJbnQoZm9yd2FyZHMuam9pbignJykpOyB9LAogICAgICAgICAgZnVuY3Rpb24obWluX2V4cGlyZXMpIHtvcHRpb25zLmRhdGEgPSBtaW5fZXhwaXJlczsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gbmV3IG9wdGlvbnMuU0lQLk5hbWVBZGRySGVhZGVyKG9wdGlvbnMuZGF0YS51cmksIG9wdGlvbnMuZGF0YS5kaXNwbGF5TmFtZSwgb3B0aW9ucy5kYXRhLnBhcmFtcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICJkaWdlc3QiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiRGlnZXN0IiwgZGVzY3JpcHRpb246ICJcIkRpZ2VzdFwiIiB9LAogICAgICAgICAgInJlYWxtIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJlYWxtIiwgZGVzY3JpcHRpb246ICJcInJlYWxtXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihyZWFsbSkgeyBvcHRpb25zLmRhdGEucmVhbG0gPSByZWFsbTsgfSwKICAgICAgICAgICJkb21haW4iLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiZG9tYWluIiwgZGVzY3JpcHRpb246ICJcImRvbWFpblwiIiB9LAogICAgICAgICAgIm5vbmNlIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm5vbmNlIiwgZGVzY3JpcHRpb246ICJcIm5vbmNlXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihub25jZSkgeyBvcHRpb25zLmRhdGEubm9uY2U9bm9uY2U7IH0sCiAgICAgICAgICAib3BhcXVlIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm9wYXF1ZSIsIGRlc2NyaXB0aW9uOiAiXCJvcGFxdWVcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKG9wYXF1ZSkgeyBvcHRpb25zLmRhdGEub3BhcXVlPW9wYXF1ZTsgfSwKICAgICAgICAgICJzdGFsZSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJzdGFsZSIsIGRlc2NyaXB0aW9uOiAiXCJzdGFsZVwiIiB9LAogICAgICAgICAgInRydWUiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidHJ1ZSIsIGRlc2NyaXB0aW9uOiAiXCJ0cnVlXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsgb3B0aW9ucy5kYXRhLnN0YWxlPXRydWU7IH0sCiAgICAgICAgICAiZmFsc2UiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiZmFsc2UiLCBkZXNjcmlwdGlvbjogIlwiZmFsc2VcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgeyBvcHRpb25zLmRhdGEuc3RhbGU9ZmFsc2U7IH0sCiAgICAgICAgICAiYWxnb3JpdGhtIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImFsZ29yaXRobSIsIGRlc2NyaXB0aW9uOiAiXCJhbGdvcml0aG1cIiIgfSwKICAgICAgICAgICJtZDUiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiTUQ1IiwgZGVzY3JpcHRpb246ICJcIk1ENVwiIiB9LAogICAgICAgICAgIm1kNS1zZXNzIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIk1ENS1zZXNzIiwgZGVzY3JpcHRpb246ICJcIk1ENS1zZXNzXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihhbGdvcml0aG0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuYWxnb3JpdGhtPWFsZ29yaXRobS50b1VwcGVyQ2FzZSgpOyB9LAogICAgICAgICAgInFvcCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJxb3AiLCBkZXNjcmlwdGlvbjogIlwicW9wXCIiIH0sCiAgICAgICAgICAiYXV0aC1pbnQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiYXV0aC1pbnQiLCBkZXNjcmlwdGlvbjogIlwiYXV0aC1pbnRcIiIgfSwKICAgICAgICAgICJhdXRoIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImF1dGgiLCBkZXNjcmlwdGlvbjogIlwiYXV0aFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24ocW9wX3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEucW9wIHx8IChvcHRpb25zLmRhdGEucW9wPVtdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5xb3AucHVzaChxb3BfdmFsdWUudG9Mb3dlckNhc2UoKSk7IH0sCiAgICAgICAgICBmdW5jdGlvbihyYWNrX3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudmFsdWU9cGFyc2VJbnQocmFja192YWx1ZS5qb2luKCcnKSk7IH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHgsIGxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aCA9IG9wdGlvbnMuZGF0YS5tdWx0aV9oZWFkZXIubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmRhdGEubXVsdGlfaGVhZGVyW2lkeF0ucGFyc2VkID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGF0YSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBvcHRpb25zLmRhdGEubXVsdGlfaGVhZGVyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gLTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFvcHRpb25zLmRhdGEubXVsdGlfaGVhZGVyKSBvcHRpb25zLmRhdGEubXVsdGlfaGVhZGVyID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXIgPSBuZXcgb3B0aW9ucy5TSVAuTmFtZUFkZHJIZWFkZXIob3B0aW9ucy5kYXRhLnVyaSwgb3B0aW9ucy5kYXRhLmRpc3BsYXlOYW1lLCBvcHRpb25zLmRhdGEucGFyYW1zKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnMuZGF0YS51cmk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEuZGlzcGxheU5hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmRhdGEucGFyYW1zOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEubXVsdGlfaGVhZGVyLnB1c2goIHsgJ3Bvc2l0aW9uJzogcGVnJGN1cnJQb3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvZmZzZXQnOiBvZmZzZXQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3BhcnNlZCc6IGhlYWRlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7fSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBuZXcgb3B0aW9ucy5TSVAuTmFtZUFkZHJIZWFkZXIob3B0aW9ucy5kYXRhLnVyaSwgb3B0aW9ucy5kYXRhLmRpc3BsYXlOYW1lLCBvcHRpb25zLmRhdGEucGFyYW1zKTsKICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShvcHRpb25zLmRhdGEucmVwbGFjZXNfZnJvbV90YWcgJiYgb3B0aW9ucy5kYXRhLnJlcGxhY2VzX3RvX3RhZykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IC0xOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxfaWQ6IG9wdGlvbnMuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAiZnJvbS10YWciLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAiZnJvbS10YWciLCBkZXNjcmlwdGlvbjogIlwiZnJvbS10YWdcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKGZyb21fdGFnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnJlcGxhY2VzX2Zyb21fdGFnID0gZnJvbV90YWc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAidG8tdGFnIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInRvLXRhZyIsIGRlc2NyaXB0aW9uOiAiXCJ0by10YWdcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHRvX3RhZykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5yZXBsYWNlc190b190YWcgPSB0b190YWc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAiZWFybHktb25seSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJlYXJseS1vbmx5IiwgZGVzY3JpcHRpb246ICJcImVhcmx5LW9ubHlcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5lYXJseV9vbmx5ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKHIpIHtyZXR1cm4gcjt9LAogICAgICAgICAgZnVuY3Rpb24oZmlyc3QsIHJlc3QpIHsgcmV0dXJuIGxpc3QoZmlyc3QsIHJlc3QpOyB9LAogICAgICAgICAgZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5zdGFydFJ1bGUgPT09ICdSZXF1aXJlJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gdmFsdWUgfHwgW107CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgZnVuY3Rpb24ocnNlcV92YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnZhbHVlPXBhcnNlSW50KHJzZXFfdmFsdWUuam9pbignJykpOyB9LAogICAgICAgICAgImFjdGl2ZSIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJhY3RpdmUiLCBkZXNjcmlwdGlvbjogIlwiYWN0aXZlXCIiIH0sCiAgICAgICAgICAicGVuZGluZyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJwZW5kaW5nIiwgZGVzY3JpcHRpb246ICJcInBlbmRpbmdcIiIgfSwKICAgICAgICAgICJ0ZXJtaW5hdGVkIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInRlcm1pbmF0ZWQiLCBkZXNjcmlwdGlvbjogIlwidGVybWluYXRlZFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuc3RhdGUgPSB0ZXh0KCk7IH0sCiAgICAgICAgICAicmVhc29uIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJlYXNvbiIsIGRlc2NyaXB0aW9uOiAiXCJyZWFzb25cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHJlYXNvbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZWFzb24gIT09ICd1bmRlZmluZWQnKSBvcHRpb25zLmRhdGEucmVhc29uID0gcmVhc29uOyB9LAogICAgICAgICAgZnVuY3Rpb24oZXhwaXJlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBleHBpcmVzICE9PSAndW5kZWZpbmVkJykgb3B0aW9ucy5kYXRhLmV4cGlyZXMgPSBleHBpcmVzOyB9LAogICAgICAgICAgInJldHJ5X2FmdGVyIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJldHJ5X2FmdGVyIiwgZGVzY3JpcHRpb246ICJcInJldHJ5X2FmdGVyXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihyZXRyeV9hZnRlcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZXRyeV9hZnRlciAhPT0gJ3VuZGVmaW5lZCcpIG9wdGlvbnMuZGF0YS5yZXRyeV9hZnRlciA9IHJldHJ5X2FmdGVyOyB9LAogICAgICAgICAgImRlYWN0aXZhdGVkIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImRlYWN0aXZhdGVkIiwgZGVzY3JpcHRpb246ICJcImRlYWN0aXZhdGVkXCIiIH0sCiAgICAgICAgICAicHJvYmF0aW9uIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInByb2JhdGlvbiIsIGRlc2NyaXB0aW9uOiAiXCJwcm9iYXRpb25cIiIgfSwKICAgICAgICAgICJyZWplY3RlZCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJyZWplY3RlZCIsIGRlc2NyaXB0aW9uOiAiXCJyZWplY3RlZFwiIiB9LAogICAgICAgICAgInRpbWVvdXQiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidGltZW91dCIsIGRlc2NyaXB0aW9uOiAiXCJ0aW1lb3V0XCIiIH0sCiAgICAgICAgICAiZ2l2ZXVwIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImdpdmV1cCIsIGRlc2NyaXB0aW9uOiAiXCJnaXZldXBcIiIgfSwKICAgICAgICAgICJub3Jlc291cmNlIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIm5vcmVzb3VyY2UiLCBkZXNjcmlwdGlvbjogIlwibm9yZXNvdXJjZVwiIiB9LAogICAgICAgICAgImludmFyaWFudCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJpbnZhcmlhbnQiLCBkZXNjcmlwdGlvbjogIlwiaW52YXJpYW50XCIiIH0sCiAgICAgICAgICBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXJ0UnVsZSA9PT0gJ1N1cHBvcnRlZCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IHZhbHVlIHx8IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFnID0gb3B0aW9ucy5kYXRhLnRhZzsKICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBuZXcgb3B0aW9ucy5TSVAuTmFtZUFkZHJIZWFkZXIob3B0aW9ucy5kYXRhLnVyaSwgb3B0aW9ucy5kYXRhLmRpc3BsYXlOYW1lLCBvcHRpb25zLmRhdGEucGFyYW1zKTsKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFnKSB7b3B0aW9ucy5kYXRhLnNldFBhcmFtKCd0YWcnLHRhZyl9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAidHRsIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInR0bCIsIGRlc2NyaXB0aW9uOiAiXCJ0dGxcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHZpYV90dGxfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEudHRsID0gdmlhX3R0bF92YWx1ZTsgfSwKICAgICAgICAgICJtYWRkciIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJtYWRkciIsIGRlc2NyaXB0aW9uOiAiXCJtYWRkclwiIiB9LAogICAgICAgICAgZnVuY3Rpb24odmlhX21hZGRyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLm1hZGRyID0gdmlhX21hZGRyOyB9LAogICAgICAgICAgInJlY2VpdmVkIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJlY2VpdmVkIiwgZGVzY3JpcHRpb246ICJcInJlY2VpdmVkXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbih2aWFfcmVjZWl2ZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEucmVjZWl2ZWQgPSB2aWFfcmVjZWl2ZWQ7IH0sCiAgICAgICAgICAiYnJhbmNoIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogImJyYW5jaCIsIGRlc2NyaXB0aW9uOiAiXCJicmFuY2hcIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHZpYV9icmFuY2gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEuYnJhbmNoID0gdmlhX2JyYW5jaDsgfSwKICAgICAgICAgICJycG9ydCIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJycG9ydCIsIGRlc2NyaXB0aW9uOiAiXCJycG9ydFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIHJlc3BvbnNlX3BvcnQgIT09ICd1bmRlZmluZWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnJwb3J0ID0gcmVzcG9uc2VfcG9ydC5qb2luKCcnKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKHZpYV9wcm90b2NvbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5wcm90b2NvbCA9IHZpYV9wcm90b2NvbDsgfSwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlVEUCIsIGRlc2NyaXB0aW9uOiAiXCJVRFBcIiIgfSwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlRDUCIsIGRlc2NyaXB0aW9uOiAiXCJUQ1BcIiIgfSwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlRMUyIsIGRlc2NyaXB0aW9uOiAiXCJUTFNcIiIgfSwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIlNDVFAiLCBkZXNjcmlwdGlvbjogIlwiU0NUUFwiIiB9LAogICAgICAgICAgZnVuY3Rpb24odmlhX3RyYW5zcG9ydCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS50cmFuc3BvcnQgPSB2aWFfdHJhbnNwb3J0OyB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLmhvc3QgPSB0ZXh0KCk7IH0sCiAgICAgICAgICBmdW5jdGlvbih2aWFfc2VudF9ieV9wb3J0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnBvcnQgPSBwYXJzZUludCh2aWFfc2VudF9ieV9wb3J0LmpvaW4oJycpKTsgfSwKICAgICAgICAgIGZ1bmN0aW9uKHR0bCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh0dGwuam9pbignJykpOyB9LAogICAgICAgICAgZnVuY3Rpb24oZGVsdGFTZWNvbmRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3RhcnRSdWxlID09PSAnU2Vzc2lvbl9FeHBpcmVzJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLmRlbHRhU2Vjb25kcyA9IGRlbHRhU2Vjb25kczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAicmVmcmVzaGVyIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInJlZnJlc2hlciIsIGRlc2NyaXB0aW9uOiAiXCJyZWZyZXNoZXJcIiIgfSwKICAgICAgICAgICJ1YXMiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidWFzIiwgZGVzY3JpcHRpb246ICJcInVhc1wiIiB9LAogICAgICAgICAgInVhYyIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJ1YWMiLCBkZXNjcmlwdGlvbjogIlwidWFjXCIiIH0sCiAgICAgICAgICBmdW5jdGlvbihlbmRwb2ludCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXJ0UnVsZSA9PT0gJ1Nlc3Npb25fRXhwaXJlcycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5yZWZyZXNoZXIgPSBlbmRwb2ludDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICBmdW5jdGlvbihkZWx0YVNlY29uZHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5zdGFydFJ1bGUgPT09ICdNaW5fU0UnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRhdGEgPSBkZWx0YVNlY29uZHM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgInN0dW5zIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInN0dW5zIiwgZGVzY3JpcHRpb246ICJcInN0dW5zXCIiIH0sCiAgICAgICAgICAic3R1biIsCiAgICAgICAgICB7IHR5cGU6ICJsaXRlcmFsIiwgdmFsdWU6ICJzdHVuIiwgZGVzY3JpcHRpb246ICJcInN0dW5cIiIgfSwKICAgICAgICAgIGZ1bmN0aW9uKHNjaGVtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YS5zY2hlbWUgPSBzY2hlbWU7IH0sCiAgICAgICAgICBmdW5jdGlvbihob3N0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLmhvc3QgPSBob3N0OyB9LAogICAgICAgICAgIj90cmFuc3BvcnQ9IiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogIj90cmFuc3BvcnQ9IiwgZGVzY3JpcHRpb246ICJcIj90cmFuc3BvcnQ9XCIiIH0sCiAgICAgICAgICAidHVybnMiLAogICAgICAgICAgeyB0eXBlOiAibGl0ZXJhbCIsIHZhbHVlOiAidHVybnMiLCBkZXNjcmlwdGlvbjogIlwidHVybnNcIiIgfSwKICAgICAgICAgICJ0dXJuIiwKICAgICAgICAgIHsgdHlwZTogImxpdGVyYWwiLCB2YWx1ZTogInR1cm4iLCBkZXNjcmlwdGlvbjogIlwidHVyblwiIiB9LAogICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhLnRyYW5zcG9ydCA9IHRyYW5zcG9ydDsgfSwKICAgICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kYXRhID0gdGV4dCgpOyB9CiAgICAgICAgXSwKCiAgICAgICAgcGVnJGJ5dGVjb2RlID0gWwogICAgICAgICAgcGVnJGRlY29kZSgiLiBcIlwiMiAzISIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMFwiXCJcIjEhMyMiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjAkXCJcIjEhMyUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjAmXCJcIjEhMyciKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjcnKiMgXCI3KCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMChcIlwiMSEzKSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMCpcIlwiMSEzKyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLixcIlwiMiwzLSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLi5cIlwiMi4zLyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiMDBcIlwiMSEzMSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLjJcIlwiMjIzMypceDg5IFwiLjRcIlwiMjQzNSp9IFwiLjZcIlwiMjYzNypxIFwiLjhcIlwiMjgzOSplIFwiLjpcIlwiMjozOypZIFwiLjxcIlwiMjwzPSpNIFwiLj5cIlwiMj4zPypBIFwiLkBcIlwiMkAzQSo1IFwiLkJcIlwiMkIzQyopIFwiLkRcIlwiMkQzRSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiNykqIyBcIjcsIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIuRlwiXCIyRjNHKn0gXCIuSFwiXCIySDNJKnEgXCIuSlwiXCIySjNLKmUgXCIuTFwiXCIyTDNNKlkgXCIuTlwiXCIyTjNPKk0gXCIuUFwiXCIyUDNRKkEgXCIuUlwiXCIyUjNTKjUgXCIuVFwiXCIyVDNVKikgXCIuVlwiXCIyVjNXIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIS5ZXCJcIjJZM1orNyQ3IystJTcjKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCshICglIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhISBcXDckLCMmNyRcIistJDcgKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytAJCBcXDckKyYkLCMmNyRcIlwiXCIgWCsnJTRcIjZdXCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3LiojIFwiIFsiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3JyojIFwiNygsKSY3JyojIFwiNyhcIitBJC44XCJcIjI4MzkrMSU3LysnJTQjNl4jICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhISBcXDcyKyYkLCMmNzJcIlwiXCIgWCtvJCBcXCEgXFw3LiwjJjcuXCIrLSQ3MisjJSdcIiUkXCIjIFhcIiMgWCxAJiEgXFw3LiwjJjcuXCIrLSQ3MisjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJ1wiJSRcIiMgWFwiIyBYKyEgKCUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjBfXCJcIjEhM2AqIyBcIjczIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIwYVwiXCIxITNiIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIwY1wiXCIxITNkIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3ISopIFwiMGVcIlwiMSEzZiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDcpKlx4OTUgXCIuRlwiXCIyRjNHKlx4ODkgXCIuSlwiXCIySjNLKn0gXCIuTFwiXCIyTDNNKnEgXCIuWVwiXCIyWTNaKmUgXCIuUFwiXCIyUDNRKlkgXCIuSFwiXCIySDNJKk0gXCIuQFwiXCIyQDNBKkEgXCIuZ1wiXCIyZzNoKjUgXCIuUlwiXCIyUjNTKikgXCIuTlwiXCIyTjNPK1x4OUUkLFx4OUImNykqXHg5NSBcIi5GXCJcIjJGM0cqXHg4OSBcIi5KXCJcIjJKM0sqfSBcIi5MXCJcIjJMM00qcSBcIi5ZXCJcIjJZM1oqZSBcIi5QXCJcIjJQM1EqWSBcIi5IXCJcIjJIM0kqTSBcIi5AXCJcIjJAM0EqQSBcIi5nXCJcIjJnM2gqNSBcIi5SXCJcIjJSM1MqKSBcIi5OXCJcIjJOM09cIlwiXCIgWCshICglIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNykqXHg4OSBcIi5GXCJcIjJGM0cqfSBcIi5MXCJcIjJMM00qcSBcIi5ZXCJcIjJZM1oqZSBcIi5QXCJcIjJQM1EqWSBcIi5IXCJcIjJIM0kqTSBcIi5AXCJcIjJAM0EqQSBcIi5nXCJcIjJnM2gqNSBcIi5SXCJcIjJSM1MqKSBcIi5OXCJcIjJOM08rXHg5MiQsXHg4RiY3KSpceDg5IFwiLkZcIlwiMkYzRyp9IFwiLkxcIlwiMkwzTSpxIFwiLllcIlwiMlkzWiplIFwiLlBcIlwiMlAzUSpZIFwiLkhcIlwiMkgzSSpNIFwiLkBcIlwiMkAzQSpBIFwiLmdcIlwiMmczaCo1IFwiLlJcIlwiMlIzUyopIFwiLk5cIlwiMk4zT1wiXCJcIiBYKyEgKCUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5UXCJcIjJUM1UqXHhFMyBcIi5WXCJcIjJWM1cqXHhENyBcIi5pXCJcIjJpM2oqXHhDQiBcIi5rXCJcIjJrM2wqXHhCRiBcIi46XCJcIjI6MzsqXHhCMyBcIi5EXCJcIjJEM0UqXHhBNyBcIi4yXCJcIjIyMzMqXHg5QiBcIi44XCJcIjI4MzkqXHg4RiBcIi5tXCJcIjJtM24qXHg4MyBcIjcmKn0gXCIuNFwiXCIyNDM1KnEgXCIub1wiXCIybzNwKmUgXCIucVwiXCIycTNyKlkgXCIuNlwiXCIyNjM3Kk0gXCIuPlwiXCIyPjM/KkEgXCIuc1wiXCIyczN0KjUgXCIudVwiXCIydTN2KikgXCI3JyojIFwiNygiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3KSpcdTAxMkIgXCIuRlwiXCIyRjNHKlx1MDExRiBcIi5KXCJcIjJKM0sqXHUwMTEzIFwiLkxcIlwiMkwzTSpcdTAxMDcgXCIuWVwiXCIyWTNaKlx4RkIgXCIuUFwiXCIyUDNRKlx4RUYgXCIuSFwiXCIySDNJKlx4RTMgXCIuQFwiXCIyQDNBKlx4RDcgXCIuZ1wiXCIyZzNoKlx4Q0IgXCIuUlwiXCIyUjNTKlx4QkYgXCIuTlwiXCIyTjNPKlx4QjMgXCIuVFwiXCIyVDNVKlx4QTcgXCIuVlwiXCIyVjNXKlx4OUIgXCIuaVwiXCIyaTNqKlx4OEYgXCIua1wiXCIyazNsKlx4ODMgXCIuOFwiXCIyODM5KncgXCIubVwiXCIybTNuKmsgXCI3JiplIFwiLjRcIlwiMjQzNSpZIFwiLm9cIlwiMm8zcCpNIFwiLnFcIlwiMnEzcipBIFwiLjZcIlwiMjYzNyo1IFwiLnNcIlwiMnMzdCopIFwiLnVcIlwiMnUzditcdTAxMzQkLFx1MDEzMSY3KSpcdTAxMkIgXCIuRlwiXCIyRjNHKlx1MDExRiBcIi5KXCJcIjJKM0sqXHUwMTEzIFwiLkxcIlwiMkwzTSpcdTAxMDcgXCIuWVwiXCIyWTNaKlx4RkIgXCIuUFwiXCIyUDNRKlx4RUYgXCIuSFwiXCIySDNJKlx4RTMgXCIuQFwiXCIyQDNBKlx4RDcgXCIuZ1wiXCIyZzNoKlx4Q0IgXCIuUlwiXCIyUjNTKlx4QkYgXCIuTlwiXCIyTjNPKlx4QjMgXCIuVFwiXCIyVDNVKlx4QTcgXCIuVlwiXCIyVjNXKlx4OUIgXCIuaVwiXCIyaTNqKlx4OEYgXCIua1wiXCIyazNsKlx4ODMgXCIuOFwiXCIyODM5KncgXCIubVwiXCIybTNuKmsgXCI3JiplIFwiLjRcIlwiMjQzNSpZIFwiLm9cIlwiMm8zcCpNIFwiLnFcIlwiMnEzcipBIFwiLjZcIlwiMjYzNyo1IFwiLnNcIlwiMnMzdCopIFwiLnVcIlwiMnUzdlwiXCJcIiBYKyEgKCUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LytBJC5QXCJcIjJQM1ErMSU3LysnJTQjNncjICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rQSQuNFwiXCIyNDM1KzElNy8rJyU0IzZ4IyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITcvK0EkLj5cIlwiMj4zPysxJTcvKyclNCM2eSMgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LytBJC5UXCJcIjJUM1UrMSU3LysnJTQjNnojICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rQSQuVlwiXCIyVjNXKzElNy8rJyU0IzZ7IyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS5rXCJcIjJrM2wrMSQ3LysnJTRcIjZ8XCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rNyQuaVwiXCIyaTNqKyclNFwiNn1cIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LytBJC5EXCJcIjJEM0UrMSU3LysnJTQjNn4jICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rQSQuMlwiXCIyMjMzKzElNy8rJyU0IzZ/IyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITcvK0EkLjhcIlwiMjgzOSsxJTcvKyclNCM2XHg4MCMgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3LysxJDcmKyclNFwiNlx4ODFcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3JisxJDcvKyclNFwiNlx4ODFcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3PStXJCBcXDdHKikgXCI3SyojIFwiN0YsLyY3RyopIFwiN0sqIyBcIjdGXCIrLSU3PisjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjBceDgyXCJcIjEhM1x4ODMqQSBcIjBceDg0XCJcIjEhM1x4ODUqNSBcIjBceDg2XCJcIjEhM1x4ODcqKSBcIjczKiMgXCI3LiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3LytVJDcmK0slIFxcN0oqIyBcIjdLLCkmN0oqIyBcIjdLXCIrLSU3JisjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCshICglIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNy8rYCQ3JitWJSEgXFw3SiojIFwiN0ssKSY3SiojIFwiN0tcIishICglKzIlNyYrKCU0JDZceDg4JCEhJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiNy4qRyBcIi5MXCJcIjJMM00qOyBcIjBceDg5XCJcIjEhM1x4OEEqLyBcIjBceDg2XCJcIjEhM1x4ODcqIyBcIjczIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhLm1cIlwiMm0zbitLJDBceDhCXCJcIjEhM1x4OEMqNSBcIjBceDhEXCJcIjEhM1x4OEUqKSBcIjBceDhGXCJcIjEhM1x4OTArIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3TitRJC44XCJcIjI4MzkrQSU3TyojIFwiIFsrMSU3UysnJTQkNlx4OTEkICUkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3TitrJC44XCJcIjI4MzkrWyU3TyojIFwiIFsrSyU3UytBJTdfKzclN2wqIyBcIiBbKyclNCY2XHg5MiYgJSQmIyBYJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHg5M1wiXCIxJDNceDk0KikgXCIvXHg5NVwiXCIxIzNceDk2KycgNCE2XHg5NyEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3UCtiJCEuOFwiXCIyODM5Ky0kN1IrIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKzclLjpcIlwiMjozOysnJTQjNlx4OTgjICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3KyopIFwiNy0qIyBcIjdRKzIkLC8mNysqKSBcIjctKiMgXCI3UVwiXCJcIiBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIuPFwiXCIyPDM9KnEgXCIuPlwiXCIyPjM/KmUgXCIuQFwiXCIyQDNBKlkgXCIuQlwiXCIyQjNDKk0gXCIuRFwiXCIyRDNFKkEgXCIuMlwiXCIyMjMzKjUgXCIuNlwiXCIyNjM3KikgXCIuNFwiXCIyNDM1IiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNysqXyBcIjctKlkgXCIuPFwiXCIyPDM9Kk0gXCIuPlwiXCIyPjM/KkEgXCIuQFwiXCIyQDNBKjUgXCIuQlwiXCIyQjNDKikgXCIuRFwiXCIyRDNFLGUmNysqXyBcIjctKlkgXCIuPFwiXCIyPDM9Kk0gXCIuPlwiXCIyPjM/KkEgXCIuQFwiXCIyQDNBKjUgXCIuQlwiXCIyQjNDKikgXCIuRFwiXCIyRDNFXCIrJiA0ITZceDk5ISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1QrTiQhLjhcIlwiMjgzOSstJDdeKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWysjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdVKikgXCI3XFwqIyBcIjdYKyYgNCE2XHg5QSEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXCE3ViszJC5KXCJcIjJKM0srIyUnXCIlJFwiIyBYXCIjIFgsPiYhN1YrMyQuSlwiXCIySjNLKyMlJ1wiJSRcIiMgWFwiIyBYXCIrRyQ3Vys9JS5KXCJcIjJKM0sqIyBcIiBbKyclNCM2XHg5QiMgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiBcXDBceDlDXCJcIjEhM1x4OUQrLCQsKSYwXHg5Q1wiXCIxITNceDlEXCJcIlwiIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEwJFwiXCIxITMlK0EkIFxcMFx4OUVcIlwiMSEzXHg5RiwpJjBceDlFXCJcIjEhM1x4OUZcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS5vXCJcIjJvM3ArQSQ3WSs3JS5xXCJcIjJxM3IrJyU0IzZceEEwIyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3WitceEJGJC44XCJcIjI4MzkrXHhBRiU3WitceEE1JS44XCJcIjI4MzkrXHg5NSU3WitceDhCJS44XCJcIjI4MzkreyU3WitxJS44XCJcIjI4MzkrYSU3WitXJS44XCJcIjI4MzkrRyU3Wis9JS44XCJcIjI4MzkrLSU3WysjJSctJSQtIyBYJCwjIFgkKyMgWCQqIyBYJCkjIFgkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA4MzggXCIhLlx4QTFcIlwiMlx4QTEzXHhBMitceEFGJDdaK1x4QTUlLjhcIlwiMjgzOStceDk1JTdaK1x4OEIlLjhcIlwiMjgzOSt7JTdaK3ElLjhcIlwiMjgzOSthJTdaK1clLjhcIlwiMjgzOStHJTdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJywlJCwjIFgkKyMgWCQqIyBYJCkjIFgkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA3OTUgXCIhLlx4QTFcIlwiMlx4QTEzXHhBMitceDk1JDdaK1x4OEIlLjhcIlwiMjgzOSt7JTdaK3ElLjhcIlwiMjgzOSthJTdaK1clLjhcIlwiMjgzOStHJTdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJyolJCojIFgkKSMgWCQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDcwQyBcIiEuXHhBMVwiXCIyXHhBMTNceEEyK3skN1orcSUuOFwiXCIyODM5K2ElN1orVyUuOFwiXCIyODM5K0clN1orPSUuOFwiXCIyODM5Ky0lN1srIyUnKCUkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA2OUQgXCIhLlx4QTFcIlwiMlx4QTEzXHhBMithJDdaK1clLjhcIlwiMjgzOStHJTdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJyYlJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA2NDggXCIhLlx4QTFcIlwiMlx4QTEzXHhBMitHJDdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJyQlJCQjIFgkIyMgWCRcIiMgWFwiIyBYKlx1MDYwRCBcIiEuXHhBMVwiXCIyXHhBMTNceEEyKy0kN1srIyUnXCIlJFwiIyBYXCIjIFgqXHUwNUVDIFwiIS5ceEExXCJcIjJceEExM1x4QTIrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCpcdTA1Q0IgXCIhN1orXHhBNSQuXHhBMVwiXCIyXHhBMTNceEEyK1x4OTUlN1orXHg4QiUuOFwiXCIyODM5K3slN1orcSUuOFwiXCIyODM5K2ElN1orVyUuOFwiXCIyODM5K0clN1orPSUuOFwiXCIyODM5Ky0lN1srIyUnKyUkKyMgWCQqIyBYJCkjIFgkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA1MzggXCIhN1orXHhCNiQhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceDhCJS5ceEExXCJcIjJceEExM1x4QTIreyU3WitxJS44XCJcIjI4MzkrYSU3WitXJS44XCJcIjI4MzkrRyU3Wis9JS44XCJcIjI4MzkrLSU3WysjJScqJSQqIyBYJCkjIFgkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTA0OTQgXCIhN1orXHhDNyQhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceDlDJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK3ElLlx4QTFcIlwiMlx4QTEzXHhBMithJTdaK1clLjhcIlwiMjgzOStHJTdaKz0lLjhcIlwiMjgzOSstJTdbKyMlJyklJCkjIFgkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTAzREYgXCIhN1orXHhEOCQhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceEFEJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4ODIlIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrVyUuXHhBMVwiXCIyXHhBMTNceEEyK0clN1orPSUuOFwiXCIyODM5Ky0lN1srIyUnKCUkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTAzMTkgXCIhN1orXHhFOSQhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceEJFJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4OTMlIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsraCUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWys9JS5ceEExXCJcIjJceEExM1x4QTIrLSU3WysjJScnJSQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTAyNDIgXCIhN1orXHUwMTE0JCEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4RTklIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrXHhCRSUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceDkzJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK2glIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrPSUuXHhBMVwiXCIyXHhBMTNceEEyKy0lN1orIyUnKCUkKCMgWCQnIyBYJCYjIFgkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCpcdTAxNDAgXCIhN1orXHUwMTM1JCEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x1MDEwQSUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWytceERGJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbK1x4QjQlIS44XCJcIjI4MzkrLSQ3WisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrXHg4OSUhLjhcIlwiMjgzOSstJDdaKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWyteJSEuOFwiXCIyODM5Ky0kN1orIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKzMlLlx4QTFcIlwiMlx4QTEzXHhBMisjJScoJSQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKyYgNCE2XHhBMyEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITcjK1MkNyMqIyBcIiBbK0MlNyMqIyBcIiBbKzMlNyMqIyBcIiBbKyMlJyQlJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1orPSQuOFwiXCIyODM5Ky0lN1orIyUnIyUkIyMgWCRcIiMgWFwiIyBYKiMgXCI3XFwiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XSt1JC5KXCJcIjJKM0srZSU3XStbJS5KXCJcIjJKM0srSyU3XStBJS5KXCJcIjJKM0srMSU3XSsnJTQnNlx4QTQnICUkJyMgWCQmIyBYJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEuXHhBNVwiXCIyXHhBNTNceEE2KzMkMFx4QTdcIlwiMSEzXHhBOCsjJSdcIiUkXCIjIFhcIiMgWCpceEEwIFwiIS5ceEE5XCJcIjJceEE5M1x4QUErPSQwXHhBQlwiXCIxITNceEFDKy0lNyErIyUnIyUkIyMgWCRcIiMgWFwiIyBYKm8gXCIhLlx4QURcIlwiMlx4QUQzXHhBRSs3JDchKy0lNyErIyUnIyUkIyMgWCRcIiMgWFwiIyBYKkQgXCIhMFx4QUZcIlwiMSEzXHhCMCstJDchKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCI3ISIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3ISojIFwiIFsrYyQ3ISojIFwiIFsrUyU3ISojIFwiIFsrQyU3ISojIFwiIFsrMyU3ISojIFwiIFsrIyUnJSUkJSMgWCQkIyBYJCMjIFgkXCIjIFhcIiMgWCsnIDQhNlx4QjEhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFwhLjJcIlwiMjIzMystJDdgKyMlJ1wiJSRcIiMgWFwiIyBYLD4mIS4yXCJcIjIyMzMrLSQ3YCsjJSdcIiUkXCIjIFhcIiMgWFwiIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3YSpBIFwiN2IqOyBcIjdjKjUgXCI3ZCovIFwiN2UqKSBcIjdmKiMgXCI3ZyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceEIyXCJcIjEqM1x4QjMrYiQvXHhCNFwiXCIxIzNceEI1KkcgXCIvXHhCNlwiXCIxIzNceEI3KjsgXCIvXHhCOFwiXCIxJDNceEI5Ki8gXCIvXHhCQVwiXCIxIzNceEJCKiMgXCI3NisoJTRcIjZceEJDXCIhICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceEJEXCJcIjElM1x4QkUrSiQvXHhCRlwiXCIxJTNceEMwKi8gXCIvXHhDMVwiXCIxXCIzXHhDMiojIFwiNzYrKCU0XCI2XHhDM1wiISAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhDNFwiXCIxJzNceEM1KzIkN1x4OEYrKCU0XCI2XHhDNlwiISAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhDN1wiXCIxJDNceEM4KzIkN1x4RUYrKCU0XCI2XHhDOVwiISAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhDQVwiXCIxJjNceENCKzIkN1QrKCU0XCI2XHhDQ1wiISAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhDRFwiXCIxXCIzXHhDRStSJCEuPlwiXCIyPjM/Ky0kNzYrIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKyclNFwiNlx4Q0ZcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3aCtUJCEuPlwiXCIyPjM/Ky0kN2krIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKyklNFwiNlx4RDBcIlwiISAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3aismJCwjJjdqXCJcIlwiIFgrISAoJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDdqKyYkLCMmN2pcIlwiXCIgWCshICglIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3ayopIFwiNysqIyBcIjctIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIub1wiXCIybzNwKmUgXCIucVwiXCIycTNyKlkgXCIuNFwiXCIyNDM1Kk0gXCIuOFwiXCIyODM5KkEgXCIuPFwiXCIyPDM9KjUgXCIuQFwiXCIyQDNBKikgXCIuQlwiXCIyQjNDIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhLjZcIlwiMjYzNyt1JDdtK2slIFxcIS48XCJcIjI8Mz0rLSQ3bSsjJSdcIiUkXCIjIFhcIiMgWCw+JiEuPFwiXCIyPDM9Ky0kN20rIyUnXCIlJFwiIyBYXCIjIFhcIisjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3bitDJC4+XCJcIjI+Mz8rMyU3byspJTQjNlx4RDEjXCJcIiAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIFxcN3AqKSBcIjcrKiMgXCI3LSsyJCwvJjdwKikgXCI3KyojIFwiNy1cIlwiXCIgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIFxcN3AqKSBcIjcrKiMgXCI3LSwvJjdwKikgXCI3KyojIFwiNy1cIiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLm9cIlwiMm8zcCplIFwiLnFcIlwiMnEzcipZIFwiLjRcIlwiMjQzNSpNIFwiLjZcIlwiMjYzNypBIFwiLjhcIlwiMjgzOSo1IFwiLkBcIlwiMkAzQSopIFwiLkJcIlwiMkIzQyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4OTAqIyBcIjdyIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4OEYrSyQ3JytBJTdzKzclNycrLSU3XHg4NCsjJSclJSQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3TSojIFwiN3QiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3fytHJC44XCJcIjI4MzkrNyU3dSojIFwiN3grJyU0IzZceEQyIyAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITd2KiMgXCI3dytOJCEuNlwiXCIyNjM3Ky0kN1x4ODMrIyUnXCIlJFwiIyBYXCIjIFgqIyBcIiBbKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhLlx4RDNcIlwiMlx4RDMzXHhENCs9JDdceDgwKzMlN3cqIyBcIiBbKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS40XCJcIjI0MzUrLSQ3eysjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITd6KzUkIFxcN3ksIyY3eVwiKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3KiopIFwiNysqIyBcIjctIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3KypceDhGIFwiNy0qXHg4OSBcIi4yXCJcIjIyMzMqfSBcIi42XCJcIjI2MzcqcSBcIi44XCJcIjI4MzkqZSBcIi46XCJcIjI6MzsqWSBcIi48XCJcIjI8Mz0qTSBcIi4+XCJcIjI+Mz8qQSBcIi5AXCJcIjJAM0EqNSBcIi5CXCJcIjJCM0MqKSBcIi5EXCJcIjJEM0UiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3fCtrJCBcXCEuNFwiXCIyNDM1Ky0kN3wrIyUnXCIlJFwiIyBYXCIjIFgsPiYhLjRcIlwiMjQzNSstJDd8KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3fiwjJjd+XCIrayQgXFwhLjJcIlwiMjIzMystJDd9KyMlJ1wiJSRcIiMgWFwiIyBYLD4mIS4yXCJcIjIyMzMrLSQ3fSsjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3fiwjJjd+XCIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjcrKncgXCI3LSpxIFwiLjhcIlwiMjgzOSplIFwiLjpcIlwiMjozOypZIFwiLjxcIlwiMjwzPSpNIFwiLj5cIlwiMj4zPypBIFwiLkBcIlwiMkAzQSo1IFwiLkJcIlwiMkIzQyopIFwiLkRcIlwiMkQzRSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdcIitceDhEJCBcXDdcIipHIFwiNyEqQSBcIi5AXCJcIjJAM0EqNSBcIi5GXCJcIjJGM0cqKSBcIi5KXCJcIjJKM0ssTSY3XCIqRyBcIjchKkEgXCIuQFwiXCIyQDNBKjUgXCIuRlwiXCIyRjNHKikgXCIuSlwiXCIySjNLXCIrJyU0XCI2XHhENVwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4ODEqIyBcIjdceDgyIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhITdPKzMkLjpcIlwiMjozOysjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrLSQ3UysjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiBcXDcrKlx4ODMgXCI3LSp9IFwiLkJcIlwiMkIzQypxIFwiLkRcIlwiMkQzRSplIFwiLjJcIlwiMjIzMypZIFwiLjhcIlwiMjgzOSpNIFwiLjpcIlwiMjozOypBIFwiLjxcIlwiMjwzPSo1IFwiLj5cIlwiMj4zPyopIFwiLkBcIlwiMkAzQStceDhDJCxceDg5JjcrKlx4ODMgXCI3LSp9IFwiLkJcIlwiMkIzQypxIFwiLkRcIlwiMkQzRSplIFwiLjJcIlwiMjIzMypZIFwiLjhcIlwiMjgzOSpNIFwiLjpcIlwiMjozOypBIFwiLjxcIlwiMjwzPSo1IFwiLj5cIlwiMj4zPyopIFwiLkBcIlwiMkAzQVwiXCJcIiBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3eSwjJjd5XCIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHg5NVwiXCIxIzNceEQ2K3kkLjRcIlwiMjQzNStpJSBcXDchKyYkLCMmNyFcIlwiXCIgWCtQJS5KXCJcIjJKM0srQCUgXFw3ISsmJCwjJjchXCJcIlwiIFgrJyU0JTZceEQ3JSAlJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEQ4XCJcIjJceEQ4M1x4RDkiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceERBXCJcIjJceERBM1x4REIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceERDXCJcIjJceERDM1x4REQiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceERFXCJcIjJceERFM1x4REYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEUwXCJcIjJceEUwM1x4RTEiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEUyXCJcIjJceEUyM1x4RTMiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEU0XCJcIjJceEU0M1x4RTUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEU2XCJcIjJceEU2M1x4RTciKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEU4XCJcIjJceEU4M1x4RTkiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIi5ceEVBXCJcIjJceEVBM1x4RUIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg4NSpTIFwiN1x4ODYqTSBcIjdceDg4KkcgXCI3XHg4OSpBIFwiN1x4OEEqOyBcIjdceDhCKjUgXCI3XHg4QyovIFwiN1x4OEQqKSBcIjdceDhFKiMgXCI3NismIDQhNlx4RUMhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg4NCtLJDcnK0ElN1x4OTErNyU3JystJTdceDkzKyMlJyUlJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg5MisnIDQhNlx4RUQhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNyErNyQ3ISstJTchKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDcqKkEgXCI3Kyo7IFwiNy0qNSBcIjczKi8gXCI3NCopIFwiNycqIyBcIjcoLEcmNyoqQSBcIjcrKjsgXCI3LSo1IFwiNzMqLyBcIjc0KikgXCI3JyojIFwiNyhcIismIDQhNlx4RUUhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhCNStfJCBcXCE3QSstJDdceEI1KyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdBKy0kN1x4QjUrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc5K1IkIS46XCJcIjI6MzsrLSQ3OSsjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrJyU0XCI2XHhFRlwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc6KmogXCIhN1x4OTcrXyQgXFwhN0ErLSQ3XHg5NysjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QSstJDdceDk3KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgrJiA0ITZceEYwISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN0wqIyBcIjdceDk4K2MkIFxcITdCKy0kN1x4OUErIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHg5QSsjJSdcIiUkXCIjIFhcIiMgWFwiKyclNFwiNlx4RjFcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg5OSojIFwiIFsrQSQ3QCs3JTdNKy0lNz8rIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEhNzYrXyQgXFwhNy4rLSQ3NisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3ListJDc2KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgqIyBcIjdIKycgNCE2XHhGMiEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceDlCKikgXCI3XHg5QyojIFwiN1x4OUYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhGM1wiXCIxITNceEY0KzwkNzwrMiU3XHg5RSsoJTQjNlx4RjUjISAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9ceEY2XCJcIjEnM1x4RjcrPCQ3PCsyJTdceDlEKyglNCM2XHhGOCMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNyErJiQsIyY3IVwiXCJcIiBYKycgNCE2XHhGOSEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEuXHhGQVwiXCIyXHhGQTNceEZCK3gkIS5KXCJcIjJKM0srUyQ3ISojIFwiIFsrQyU3ISojIFwiIFsrMyU3ISojIFwiIFsrIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgqIyBcIiBbKyclNFwiNlx4RkNcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3NitOJCE3PCstJDdceEEwKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWyspJTRcIjZceEZEXCJcIiEgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3NiopIFwiN1QqIyBcIjdIIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4QTIrXyQgXFwhN0IrLSQ3XHhBMysjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceEEzKyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHhGRVwiXCIxJjNceEZGKkcgXCIvXHUwMTAwXCJcIjEnM1x1MDEwMSo7IFwiL1x1MDEwMlwiXCIxJDNcdTAxMDMqLyBcIi9cdTAxMDRcIlwiMSUzXHUwMTA1KiMgXCI3NismIDQhNlx1MDEwNiEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4QTQqIyBcIjdceDlGIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDEwN1wiXCIxKDNcdTAxMDgrTyQ3PCtFJS9cdTAxMDlcIlwiMSgzXHUwMTBBKi8gXCIvXHUwMTBCXCJcIjEoM1x1MDEwQyojIFwiNzYrIyUnIyUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNzYrXyQgXFwhN0ErLSQ3NisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QSstJDc2KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3ISsmJCwjJjchXCJcIlwiIFgrJyA0ITZcdTAxMEQhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4QTgrJiA0ITZcdTAxMEUhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhBOStzJDc7K2klN1x4QUUrXyUgXFwhN0IrLSQ3XHhBRisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceEFGKyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceEFBKiMgXCI3XHhBQiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiL1x1MDEwRlwiXCIxJDNcdTAxMTAqUyBcIi9cdTAxMTFcIlwiMSUzXHUwMTEyKkcgXCIvXHUwMTEzXCJcIjElM1x1MDExNCo7IFwiL1x1MDExNVwiXCIxJTNcdTAxMTYqLyBcIi9cdTAxMTdcIlwiMSszXHUwMTE4KiMgXCI3XHhBQyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiL1x1MDExOVwiXCIxJzNcdTAxMUEqLyBcIi9cdTAxMUJcIlwiMSkzXHUwMTFDKiMgXCI3XHhBQyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiNzYqIyBcIjdceEFEIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDExRFwiXCIxXCIzXHUwMTFFKy0kNzYrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceEFDKiMgXCI3NiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc2KzckNzwrLSU3XHhCMCsjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjc2KiMgXCI3SCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEIyKzckNy4rLSU3XHg4RisjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEgXFw3ISsmJCwjJjchXCJcIlwiIFgrJyA0ITZcdTAxMUYhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4OUQrJyA0ITZcdTAxMjAhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4QjUrZCQgXFwhN0IrLSQ3XHg5RisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceDlGKyMlJ1wiJSRcIiMgWFwiIyBYXCIrKCU0XCI2XHUwMTIxXCIhISUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3NytrJCBcXCEuSlwiXCIySjNLKy0kNzcrIyUnXCIlJFwiIyBYXCIjIFgsPiYhLkpcIlwiMkozSystJDc3KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgrISAoJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdMKiMgXCI3XHg5OCtjJCBcXCE3QistJDdceEI3KyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4QjcrIyUnXCIlJFwiIyBYXCIjIFhcIisnJTRcIjZcdTAxMjJcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceEI4KiMgXCI3XHg5RiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxMjNcIlwiMSMzXHUwMTI0KzwkNzwrMiU3NisoJTQjNlx1MDEyNSMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNyErJiQsIyY3IVwiXCJcIiBYKycgNCE2XHUwMTI2ISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDlEKycgNCE2XHUwMTI3ISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDdceDk5LCMmN1x4OTlcIitceDgxJDdAK3clN00rbSU3PytjJSBcXCE3QistJDdceDlGKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFhcIisnJTQlNlx1MDEyOCUgJSQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XHhCRCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxMjlcIlwiMSYzXHUwMTJBK3MkNy4raSU3XHhDMCtfJSBcXCE3QSstJDdceEMwKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdBKy0kN1x4QzArIyUnXCIlJFwiIyBYXCIjIFhcIisjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCojIFwiN1x4QkUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3NitzJDcuK2klN1x4QkYrXyUgXFwhN0ErLSQ3XHhCRisjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QSstJDdceEJGKyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3Nis9JDc8KzMlNzYqIyBcIjdIKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4QzEqRyBcIjdceEMzKkEgXCI3XHhDNSo7IFwiN1x4QzcqNSBcIjdceEM4Ki8gXCI3XHhDOSopIFwiN1x4Q0EqIyBcIjdceEJGIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDEyQlwiXCIxJTNcdTAxMkMrNyQ3PCstJTdceEMyKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdJKycgNCE2XHUwMTJEISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxMkVcIlwiMSYzXHUwMTJGK1x4QTUkNzwrXHg5QiU3RCtceDkxJTdceEM0K1x4ODclIFxcISBcXDcnKyYkLCMmNydcIlwiXCIgWCstJDdceEM0KyMlJ1wiJSRcIiMgWFwiIyBYLEcmISBcXDcnKyYkLCMmNydcIlwiXCIgWCstJDdceEM0KyMlJ1wiJSRcIiMgWFwiIyBYXCIrLSU3RSsjJScmJSQmIyBYJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjd0KiMgXCI3dyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxMzBcIlwiMSUzXHUwMTMxKzckNzwrLSU3XHhDNisjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3SSsnIDQhNlx1MDEzMiEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTMzXCJcIjEmM1x1MDEzNCs8JDc8KzIlN0krKCU0IzZcdTAxMzUjISAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxMzZcIlwiMSUzXHUwMTM3K18kNzwrVSUhL1x1MDEzOFwiXCIxJDNcdTAxMzkrJiA0ITZcdTAxM0EhICUqNCBcIiEvXHUwMTNCXCJcIjElM1x1MDEzQysmIDQhNlx1MDEzRCEgJSsjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTNFXCJcIjEpM1x1MDEzRitUJDc8K0olL1x1MDE0MFwiXCIxIzNcdTAxNDEqLyBcIi9cdTAxNDJcIlwiMSgzXHUwMTQzKiMgXCI3NisoJTQjNlx1MDE0NCMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDE0NVwiXCIxIzNcdTAxNDYrXHg5RSQ3PCtceDk0JTdEK1x4OEElITdceENCK2skIFxcIS5EXCJcIjJEM0UrLSQ3XHhDQisjJSdcIiUkXCIjIFhcIiMgWCw+JiEuRFwiXCIyRDNFKy0kN1x4Q0IrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCstJTdFKyMlJyUlJCUjIFgkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTQ3XCJcIjEoM1x1MDE0OCovIFwiL1x1MDE0OVwiXCIxJDNcdTAxNEEqIyBcIjc2KycgNCE2XHUwMTRCISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITc2K18kIFxcITdBKy0kNzYrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0ErLSQ3NisjJSdcIiUkXCIjIFhcIiMgWFwiKyMlJ1wiJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4Q0UrSyQ3LitBJTdceENFKzclNy4rLSU3XHg4RisjJSclJSQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhIFxcNyErJiQsIyY3IVwiXCJcIiBYKycgNCE2XHUwMTRDISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEQwK2MkIFxcITdBKy0kN1x4RDArIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0ErLSQ3XHhEMCsjJSdcIiUkXCIjIFhcIiMgWFwiKyclNFwiNlx1MDE0RFwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDk4K2MkIFxcITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHg5RisjJSdcIiUkXCIjIFhcIiMgWFwiKyclNFwiNlx1MDE0RVwiICUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdMKlQgXCI3XHg5OCpOIFwiITdAKiMgXCIgWys9JDd0KzMlNz8qIyBcIiBbKyMlJyMlJCMjIFgkXCIjIFhcIiMgWCtjJCBcXCE3QistJDdceDlGKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFhcIisnJTRcIjZcdTAxNEZcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhEMytjJCBcXCE3QistJDdceEQ0KyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4RDQrIyUnXCIlJFwiIyBYXCIjIFhcIisnJTRcIjZcdTAxNTBcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg5NSsmIDQhNlx1MDE1MSEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxNTJcIlwiMSgzXHUwMTUzKzwkNzwrMiU3NisoJTQjNlx1MDE1NCMhICUkIyMgWCRcIiMgWFwiIyBYKmogXCIhL1x1MDE1NVwiXCIxJjNcdTAxNTYrPCQ3PCsyJTc2KyglNCM2XHUwMTU3IyEgJSQjIyBYJFwiIyBYXCIjIFgqOiBcIiEvXHUwMTU4XCJcIjEqM1x1MDE1OSsmIDQhNlx1MDE1QSEgJSojIFwiN1x4OUYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEhNzYrbyQgXFwhN0ErMiQ3NisoJTRcIjZcdTAxNUJcIiEgJSRcIiMgWFwiIyBYLD0mITdBKzIkNzYrKCU0XCI2XHUwMTVCXCIhICUkXCIjIFhcIiMgWFwiKyklNFwiNlx1MDE1Q1wiXCIhICUkXCIjIFhcIiMgWCojIFwiIFsrJyA0ITZcdTAxNUQhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4RDcrXyQgXFwhN0ErLSQ3XHhENysjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QSstJDdceEQ3KyMlJ1wiJSRcIiMgWFwiIyBYXCIrIyUnXCIlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHg5OCtfJCBcXCE3QistJDdceDlGKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDchKyYkLCMmNyFcIlwiXCIgWCsnIDQhNlx1MDE1RSEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhEQStfJCBcXCE3QistJDdceERCKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4REIrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxNUZcIlwiMSYzXHUwMTYwKjsgXCIvXHUwMTYxXCJcIjEnM1x1MDE2MiovIFwiL1x1MDE2M1wiXCIxKjNcdTAxNjQqIyBcIjc2KyYgNCE2XHUwMTY1ISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDE2NlwiXCIxJjNcdTAxNjcrPCQ3PCsyJTdceERDKyglNCM2XHUwMTY4IyEgJSQjIyBYJFwiIyBYXCIjIFgqXHg4MyBcIiEvXHhGNlwiXCIxJzNceEY3KzwkNzwrMiU3XHg5RCsoJTQjNlx1MDE2OSMhICUkIyMgWCRcIiMgWFwiIyBYKlMgXCIhL1x1MDE2QVwiXCIxKzNcdTAxNkIrPCQ3PCsyJTdceDlEKyglNCM2XHUwMTZDIyEgJSQjIyBYJFwiIyBYXCIjIFgqIyBcIjdceDlGIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIvXHUwMTZEXCJcIjErM1x1MDE2RSprIFwiL1x1MDE2RlwiXCIxKTNcdTAxNzAqXyBcIi9cdTAxNzFcIlwiMSgzXHUwMTcyKlMgXCIvXHUwMTczXCJcIjEnM1x1MDE3NCpHIFwiL1x1MDE3NVwiXCIxJjNcdTAxNzYqOyBcIi9cdTAxNzdcIlwiMSozXHUwMTc4Ki8gXCIvXHUwMTc5XCJcIjEpM1x1MDE3QSojIFwiNzYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjcxKiMgXCIgWyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3NitvJCBcXCE3QSsyJDc2KyglNFwiNlx1MDE1QlwiISAlJFwiIyBYXCIjIFgsPSYhN0ErMiQ3NisoJTRcIjZcdTAxNUJcIiEgJSRcIiMgWFwiIyBYXCIrKSU0XCI2XHUwMTVDXCJcIiEgJSRcIiMgWFwiIyBYKiMgXCIgWysnIDQhNlx1MDE3QiEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3TCojIFwiN1x4OTgrYyQgXFwhN0IrLSQ3XHhFMCsjJSdcIiUkXCIjIFhcIiMgWCw4JiE3QistJDdceEUwKyMlJ1wiJSRcIiMgWFwiIyBYXCIrJyU0XCI2XHUwMTdDXCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XHhCOCojIFwiN1x4OUYiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhFMitfJCBcXCE3QSstJDdceEUyKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdBKy0kN1x4RTIrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceEU5K3MkNy4raSU3XHhFQytfJSBcXCE3QistJDdceEUzKyMlJ1wiJSRcIiMgWFwiIyBYLDgmITdCKy0kN1x4RTMrIyUnXCIlJFwiIyBYXCIjIFhcIisjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1x4RTQqOyBcIjdceEU1KjUgXCI3XHhFNiovIFwiN1x4RTcqKSBcIjdceEU4KiMgXCI3XHg5RiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxN0RcIlwiMSMzXHUwMTdFKzwkNzwrMiU3XHhFRisoJTQjNlx1MDE3RiMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDE4MFwiXCIxJTNcdTAxODErPCQ3PCsyJTdUKyglNCM2XHUwMTgyIyEgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTgzXCJcIjEoM1x1MDE4NCtCJDc8KzglN1xcKiMgXCI3WSsoJTQjNlx1MDE4NSMhICUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x1MDE4NlwiXCIxJjNcdTAxODcrPCQ3PCsyJTc2KyglNCM2XHUwMTg4IyEgJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTg5XCJcIjElM1x1MDE4QStUJCE3PCs1JCBcXDchLCMmNyFcIisjJSdcIiUkXCIjIFhcIiMgWCojIFwiIFsrJyU0XCI2XHUwMThCXCIgJSRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4RUErSyQ3OytBJTc2KzclNzsrLSU3XHhFQisjJSclJSQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x4OTVcIlwiMSMzXHhENiojIFwiNzYrJyA0ITZcdTAxOEMhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhL1x4QjRcIlwiMSMzXHUwMThEKkcgXCIvXHhCNlwiXCIxIzNcdTAxOEUqOyBcIi9ceEJBXCJcIjEjM1x1MDE4RiovIFwiL1x4QjhcIlwiMSQzXHUwMTkwKiMgXCI3NisnIDQhNlx1MDE5MSEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhFRCtIJCE3QystJDdceEVFKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWysjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdVKikgXCI3XFwqIyBcIjdYKyYgNCE2XHUwMTkyISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhITchKiMgXCIgWytjJDchKiMgXCIgWytTJTchKiMgXCIgWytDJTchKiMgXCIgWyszJTchKiMgXCIgWysjJSclJSQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYKycgNCE2XHUwMTkzISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISE3IStDJDchKiMgXCIgWyszJTchKiMgXCIgWysjJScjJSQjIyBYJFwiIyBYXCIjIFgrJyA0ITZcdTAxOTQhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCI3XHhCRCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDlEK2QkIFxcITdCKy0kN1x4RjIrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHhGMisjJSdcIiUkXCIjIFhcIiMgWFwiKyglNFwiNlx1MDE5NVwiISElJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIjdceEYzKiMgXCI3XHg5RiIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS5cdTAxOTZcIlwiMlx1MDE5NjNcdTAxOTcrTiQ3PCtEJS5cdTAxOThcIlwiMlx1MDE5ODNcdTAxOTkqKSBcIi5cdTAxOUFcIlwiMlx1MDE5QTNcdTAxOUIrKCU0IzZcdTAxOUMjISAlJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdceDlEK2QkIFxcITdCKy0kN1x4OUYrIyUnXCIlJFwiIyBYXCIjIFgsOCYhN0IrLSQ3XHg5RisjJSdcIiUkXCIjIFhcIiMgWFwiKyglNFwiNlx1MDE5RFwiISElJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3Nis3JDcwKy0lN1x4RjYrIyUnIyUkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3MiopIFwiNzQqIyBcIjcuLC8mNzIqKSBcIjc0KiMgXCI3LlwiIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIgXFw3JSwjJjclXCIiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhGOSs9JC44XCJcIjI4MzkrLSU3XHhGQSsjJScjJSQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiEvXHUwMTlFXCJcIjElM1x1MDE5RiopIFwiL1x1MDFBMFwiXCIxJDNcdTAxQTErJyA0ITZcdTAxQTIhISAlIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhN1x4RkIrTiQhLjhcIlwiMjgzOSstJDdeKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWysjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdcXCopIFwiN1gqIyBcIjdceDgyKycgNCE2XHUwMUEzISEgJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiISBcXDdceEZEKikgXCI3LSojIFwiN1x4RkUsLyY3XHhGRCopIFwiNy0qIyBcIjdceEZFXCIrISAoJSIpLAogICAgICAgICAgcGVnJGRlY29kZSgiN1wiKlMgXCI3ISpNIFwiLkZcIlwiMkYzRypBIFwiLkpcIlwiMkozSyo1IFwiLkhcIlwiMkgzSSopIFwiLk5cIlwiMk4zTyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiLkxcIlwiMkwzTSpceDk1IFwiLkJcIlwiMkIzQypceDg5IFwiLjxcIlwiMjwzPSp9IFwiLlJcIlwiMlIzUypxIFwiLlRcIlwiMlQzVSplIFwiLlZcIlwiMlYzVypZIFwiLlBcIlwiMlAzUSpNIFwiLkBcIlwiMkAzQSpBIFwiLkRcIlwiMkQzRSo1IFwiLjJcIlwiMjIzMyopIFwiLj5cIlwiMj4zPyIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdcdTAxMDAraCQuOFwiXCIyODM5K1glN1x4RkErTiUhLlx1MDFBNFwiXCIyXHUwMUE0M1x1MDFBNSstJDdceEVCKyMlJ1wiJSRcIiMgWFwiIyBYKiMgXCIgWysjJSckJSQkIyBYJCMjIFgkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiIS9cdTAxQTZcIlwiMSUzXHUwMUE3KikgXCIvXHUwMUE4XCJcIjEkM1x1MDFBOSsnIDQhNlx1MDFBMiEhICUiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHhFQitRJC9ceEI0XCJcIjEjM1x4QjUqNyBcIi9ceEI2XCJcIjEjM1x4QjcqKyBcIiBcXDcrLCMmNytcIisnJTRcIjZcdTAxQUFcIiAlJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHUwMTA0K1x4OEYkLkZcIlwiMkYzRyt/JTdcdTAxMDMrdSUuRlwiXCIyRjNHK2UlN1x1MDEwMytbJS5GXCJcIjJGM0crSyU3XHUwMTAzK0ElLkZcIlwiMkYzRysxJTdcdTAxMDUrJyU0KTZcdTAxQUIpICUkKSMgWCQoIyBYJCcjIFgkJiMgWCQlIyBYJCQjIFgkIyMgWCRcIiMgWFwiIyBYIiksCiAgICAgICAgICBwZWckZGVjb2RlKCIhNyMrQSQ3Iys3JTcjKy0lNyMrIyUnJCUkJCMgWCQjIyBYJFwiIyBYXCIjIFgiKSwKICAgICAgICAgIHBlZyRkZWNvZGUoIiE3XHUwMTAzKy0kN1x1MDEwMysjJSdcIiUkXCIjIFhcIiMgWCIpLAogICAgICAgICAgcGVnJGRlY29kZSgiITdcdTAxMDMrNyQ3XHUwMTAzKy0lN1x1MDEwMysjJScjJSQjIyBYJFwiIyBYXCIjIFgiKQogICAgICAgIF0sCgogICAgICAgIHBlZyRjdXJyUG9zICAgICAgICAgID0gMCwKICAgICAgICBwZWckcmVwb3J0ZWRQb3MgICAgICA9IDAsCiAgICAgICAgcGVnJGNhY2hlZFBvcyAgICAgICAgPSAwLAogICAgICAgIHBlZyRjYWNoZWRQb3NEZXRhaWxzID0geyBsaW5lOiAxLCBjb2x1bW46IDEsIHNlZW5DUjogZmFsc2UgfSwKICAgICAgICBwZWckbWF4RmFpbFBvcyAgICAgICA9IDAsCiAgICAgICAgcGVnJG1heEZhaWxFeHBlY3RlZCAgPSBbXSwKICAgICAgICBwZWckc2lsZW50RmFpbHMgICAgICA9IDAsCgogICAgICAgIHBlZyRyZXN1bHQ7CgogICAgaWYgKCJzdGFydFJ1bGUiIGluIG9wdGlvbnMpIHsKICAgICAgaWYgKCEob3B0aW9ucy5zdGFydFJ1bGUgaW4gcGVnJHN0YXJ0UnVsZUluZGljZXMpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDYW4ndCBzdGFydCBwYXJzaW5nIGZyb20gcnVsZSBcIiIgKyBvcHRpb25zLnN0YXJ0UnVsZSArICJcIi4iKTsKICAgICAgfQoKICAgICAgcGVnJHN0YXJ0UnVsZUluZGV4ID0gcGVnJHN0YXJ0UnVsZUluZGljZXNbb3B0aW9ucy5zdGFydFJ1bGVdOwogICAgfQoKICAgIGZ1bmN0aW9uIHRleHQoKSB7CiAgICAgIHJldHVybiBpbnB1dC5zdWJzdHJpbmcocGVnJHJlcG9ydGVkUG9zLCBwZWckY3VyclBvcyk7CiAgICB9CgogICAgZnVuY3Rpb24gb2Zmc2V0KCkgewogICAgICByZXR1cm4gcGVnJHJlcG9ydGVkUG9zOwogICAgfQoKICAgIGZ1bmN0aW9uIGxpbmUoKSB7CiAgICAgIHJldHVybiBwZWckY29tcHV0ZVBvc0RldGFpbHMocGVnJHJlcG9ydGVkUG9zKS5saW5lOwogICAgfQoKICAgIGZ1bmN0aW9uIGNvbHVtbigpIHsKICAgICAgcmV0dXJuIHBlZyRjb21wdXRlUG9zRGV0YWlscyhwZWckcmVwb3J0ZWRQb3MpLmNvbHVtbjsKICAgIH0KCiAgICBmdW5jdGlvbiBleHBlY3RlZChkZXNjcmlwdGlvbikgewogICAgICB0aHJvdyBwZWckYnVpbGRFeGNlcHRpb24oCiAgICAgICAgbnVsbCwKICAgICAgICBbeyB0eXBlOiAib3RoZXIiLCBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfV0sCiAgICAgICAgcGVnJHJlcG9ydGVkUG9zCiAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkgewogICAgICB0aHJvdyBwZWckYnVpbGRFeGNlcHRpb24obWVzc2FnZSwgbnVsbCwgcGVnJHJlcG9ydGVkUG9zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwZWckY29tcHV0ZVBvc0RldGFpbHMocG9zKSB7CiAgICAgIGZ1bmN0aW9uIGFkdmFuY2UoZGV0YWlscywgc3RhcnRQb3MsIGVuZFBvcykgewogICAgICAgIHZhciBwLCBjaDsKCiAgICAgICAgZm9yIChwID0gc3RhcnRQb3M7IHAgPCBlbmRQb3M7IHArKykgewogICAgICAgICAgY2ggPSBpbnB1dC5jaGFyQXQocCk7CiAgICAgICAgICBpZiAoY2ggPT09ICJcbiIpIHsKICAgICAgICAgICAgaWYgKCFkZXRhaWxzLnNlZW5DUikgeyBkZXRhaWxzLmxpbmUrKzsgfQogICAgICAgICAgICBkZXRhaWxzLmNvbHVtbiA9IDE7CiAgICAgICAgICAgIGRldGFpbHMuc2VlbkNSID0gZmFsc2U7CiAgICAgICAgICB9IGVsc2UgaWYgKGNoID09PSAiXHIiIHx8IGNoID09PSAiXHUyMDI4IiB8fCBjaCA9PT0gIlx1MjAyOSIpIHsKICAgICAgICAgICAgZGV0YWlscy5saW5lKys7CiAgICAgICAgICAgIGRldGFpbHMuY29sdW1uID0gMTsKICAgICAgICAgICAgZGV0YWlscy5zZWVuQ1IgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGV0YWlscy5jb2x1bW4rKzsKICAgICAgICAgICAgZGV0YWlscy5zZWVuQ1IgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChwZWckY2FjaGVkUG9zICE9PSBwb3MpIHsKICAgICAgICBpZiAocGVnJGNhY2hlZFBvcyA+IHBvcykgewogICAgICAgICAgcGVnJGNhY2hlZFBvcyA9IDA7CiAgICAgICAgICBwZWckY2FjaGVkUG9zRGV0YWlscyA9IHsgbGluZTogMSwgY29sdW1uOiAxLCBzZWVuQ1I6IGZhbHNlIH07CiAgICAgICAgfQogICAgICAgIGFkdmFuY2UocGVnJGNhY2hlZFBvc0RldGFpbHMsIHBlZyRjYWNoZWRQb3MsIHBvcyk7CiAgICAgICAgcGVnJGNhY2hlZFBvcyA9IHBvczsKICAgICAgfQoKICAgICAgcmV0dXJuIHBlZyRjYWNoZWRQb3NEZXRhaWxzOwogICAgfQoKICAgIGZ1bmN0aW9uIHBlZyRmYWlsKGV4cGVjdGVkKSB7CiAgICAgIGlmIChwZWckY3VyclBvcyA8IHBlZyRtYXhGYWlsUG9zKSB7IHJldHVybjsgfQoKICAgICAgaWYgKHBlZyRjdXJyUG9zID4gcGVnJG1heEZhaWxQb3MpIHsKICAgICAgICBwZWckbWF4RmFpbFBvcyA9IHBlZyRjdXJyUG9zOwogICAgICAgIHBlZyRtYXhGYWlsRXhwZWN0ZWQgPSBbXTsKICAgICAgfQoKICAgICAgcGVnJG1heEZhaWxFeHBlY3RlZC5wdXNoKGV4cGVjdGVkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwZWckYnVpbGRFeGNlcHRpb24obWVzc2FnZSwgZXhwZWN0ZWQsIHBvcykgewogICAgICBmdW5jdGlvbiBjbGVhbnVwRXhwZWN0ZWQoZXhwZWN0ZWQpIHsKICAgICAgICB2YXIgaSA9IDE7CgogICAgICAgIGV4cGVjdGVkLnNvcnQoZnVuY3Rpb24oYSwgYikgewogICAgICAgICAgaWYgKGEuZGVzY3JpcHRpb24gPCBiLmRlc2NyaXB0aW9uKSB7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgIH0gZWxzZSBpZiAoYS5kZXNjcmlwdGlvbiA+IGIuZGVzY3JpcHRpb24pIHsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgd2hpbGUgKGkgPCBleHBlY3RlZC5sZW5ndGgpIHsKICAgICAgICAgIGlmIChleHBlY3RlZFtpIC0gMV0gPT09IGV4cGVjdGVkW2ldKSB7CiAgICAgICAgICAgIGV4cGVjdGVkLnNwbGljZShpLCAxKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGkrKzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGJ1aWxkTWVzc2FnZShleHBlY3RlZCwgZm91bmQpIHsKICAgICAgICBmdW5jdGlvbiBzdHJpbmdFc2NhcGUocykgewogICAgICAgICAgZnVuY3Rpb24gaGV4KGNoKSB7IHJldHVybiBjaC5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpOyB9CgogICAgICAgICAgcmV0dXJuIHMKICAgICAgICAgICAgLnJlcGxhY2UoL1xcL2csICAgJ1xcXFwnKQogICAgICAgICAgICAucmVwbGFjZSgvIi9nLCAgICAnXFwiJykKICAgICAgICAgICAgLnJlcGxhY2UoL1x4MDgvZywgJ1xcYicpCiAgICAgICAgICAgIC5yZXBsYWNlKC9cdC9nLCAgICdcXHQnKQogICAgICAgICAgICAucmVwbGFjZSgvXG4vZywgICAnXFxuJykKICAgICAgICAgICAgLnJlcGxhY2UoL1xmL2csICAgJ1xcZicpCiAgICAgICAgICAgIC5yZXBsYWNlKC9cci9nLCAgICdcXHInKQogICAgICAgICAgICAucmVwbGFjZSgvW1x4MDAtXHgwN1x4MEJceDBFXHgwRl0vZywgZnVuY3Rpb24oY2gpIHsgcmV0dXJuICdcXHgwJyArIGhleChjaCk7IH0pCiAgICAgICAgICAgIC5yZXBsYWNlKC9bXHgxMC1ceDFGXHg4MC1ceEZGXS9nLCAgICBmdW5jdGlvbihjaCkgeyByZXR1cm4gJ1xceCcgICsgaGV4KGNoKTsgfSkKICAgICAgICAgICAgLnJlcGxhY2UoL1tcdTAxODAtXHUwRkZGXS9nLCAgICAgICAgIGZ1bmN0aW9uKGNoKSB7IHJldHVybiAnXFx1MCcgKyBoZXgoY2gpOyB9KQogICAgICAgICAgICAucmVwbGFjZSgvW1x1MTA4MC1cdUZGRkZdL2csICAgICAgICAgZnVuY3Rpb24oY2gpIHsgcmV0dXJuICdcXHUnICArIGhleChjaCk7IH0pOwogICAgICAgIH0KCiAgICAgICAgdmFyIGV4cGVjdGVkRGVzY3MgPSBuZXcgQXJyYXkoZXhwZWN0ZWQubGVuZ3RoKSwKICAgICAgICAgICAgZXhwZWN0ZWREZXNjLCBmb3VuZERlc2MsIGk7CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBleHBlY3RlZC5sZW5ndGg7IGkrKykgewogICAgICAgICAgZXhwZWN0ZWREZXNjc1tpXSA9IGV4cGVjdGVkW2ldLmRlc2NyaXB0aW9uOwogICAgICAgIH0KCiAgICAgICAgZXhwZWN0ZWREZXNjID0gZXhwZWN0ZWQubGVuZ3RoID4gMQogICAgICAgICAgPyBleHBlY3RlZERlc2NzLnNsaWNlKDAsIC0xKS5qb2luKCIsICIpCiAgICAgICAgICAgICAgKyAiIG9yICIKICAgICAgICAgICAgICArIGV4cGVjdGVkRGVzY3NbZXhwZWN0ZWQubGVuZ3RoIC0gMV0KICAgICAgICAgIDogZXhwZWN0ZWREZXNjc1swXTsKCiAgICAgICAgZm91bmREZXNjID0gZm91bmQgPyAiXCIiICsgc3RyaW5nRXNjYXBlKGZvdW5kKSArICJcIiIgOiAiZW5kIG9mIGlucHV0IjsKCiAgICAgICAgcmV0dXJuICJFeHBlY3RlZCAiICsgZXhwZWN0ZWREZXNjICsgIiBidXQgIiArIGZvdW5kRGVzYyArICIgZm91bmQuIjsKICAgICAgfQoKICAgICAgdmFyIHBvc0RldGFpbHMgPSBwZWckY29tcHV0ZVBvc0RldGFpbHMocG9zKSwKICAgICAgICAgIGZvdW5kICAgICAgPSBwb3MgPCBpbnB1dC5sZW5ndGggPyBpbnB1dC5jaGFyQXQocG9zKSA6IG51bGw7CgogICAgICBpZiAoZXhwZWN0ZWQgIT09IG51bGwpIHsKICAgICAgICBjbGVhbnVwRXhwZWN0ZWQoZXhwZWN0ZWQpOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IFN5bnRheEVycm9yKAogICAgICAgIG1lc3NhZ2UgIT09IG51bGwgPyBtZXNzYWdlIDogYnVpbGRNZXNzYWdlKGV4cGVjdGVkLCBmb3VuZCksCiAgICAgICAgZXhwZWN0ZWQsCiAgICAgICAgZm91bmQsCiAgICAgICAgcG9zLAogICAgICAgIHBvc0RldGFpbHMubGluZSwKICAgICAgICBwb3NEZXRhaWxzLmNvbHVtbgogICAgICApOwogICAgfQoKICAgIGZ1bmN0aW9uIHBlZyRkZWNvZGUocykgewogICAgICB2YXIgYmMgPSBuZXcgQXJyYXkocy5sZW5ndGgpLCBpOwoKICAgICAgZm9yIChpID0gMDsgaSA8IHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBiY1tpXSA9IHMuY2hhckNvZGVBdChpKSAtIDMyOwogICAgICB9CgogICAgICByZXR1cm4gYmM7CiAgICB9CgogICAgZnVuY3Rpb24gcGVnJHBhcnNlUnVsZShpbmRleCkgewogICAgICB2YXIgYmMgICAgPSBwZWckYnl0ZWNvZGVbaW5kZXhdLAogICAgICAgICAgaXAgICAgPSAwLAogICAgICAgICAgaXBzICAgPSBbXSwKICAgICAgICAgIGVuZCAgID0gYmMubGVuZ3RoLAogICAgICAgICAgZW5kcyAgPSBbXSwKICAgICAgICAgIHN0YWNrID0gW10sCiAgICAgICAgICBwYXJhbXMsIGk7CgogICAgICBmdW5jdGlvbiBwcm90ZWN0KG9iamVjdCkgewogICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KG9iamVjdCkgPT09ICJbb2JqZWN0IEFycmF5XSIgPyBbXSA6IG9iamVjdDsKICAgICAgfQoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICB3aGlsZSAoaXAgPCBlbmQpIHsKICAgICAgICAgIHN3aXRjaCAoYmNbaXBdKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBzdGFjay5wdXNoKHByb3RlY3QocGVnJGNvbnN0c1tiY1tpcCArIDFdXSkpOwogICAgICAgICAgICAgIGlwICs9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgc3RhY2sucHVzaChwZWckY3VyclBvcyk7CiAgICAgICAgICAgICAgaXArKzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIHBlZyRjdXJyUG9zID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgICAgaXArKzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBzdGFjay5sZW5ndGggLT0gYmNbaXAgKyAxXTsKICAgICAgICAgICAgICBpcCArPSAyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIHN0YWNrLnNwbGljZSgtMiwgMSk7CiAgICAgICAgICAgICAgaXArKzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBzdGFja1tzdGFjay5sZW5ndGggLSAyXS5wdXNoKHN0YWNrLnBvcCgpKTsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIHN0YWNrLnB1c2goc3RhY2suc3BsaWNlKHN0YWNrLmxlbmd0aCAtIGJjW2lwICsgMV0sIGJjW2lwICsgMV0pKTsKICAgICAgICAgICAgICBpcCArPSAyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIHN0YWNrLnBvcCgpOwogICAgICAgICAgICAgIHN0YWNrLnB1c2goaW5wdXQuc3Vic3RyaW5nKHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdLCBwZWckY3VyclBvcykpOwogICAgICAgICAgICAgIGlwKys7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgZW5kcy5wdXNoKGVuZCk7CiAgICAgICAgICAgICAgaXBzLnB1c2goaXAgKyAzICsgYmNbaXAgKyAxXSArIGJjW2lwICsgMl0pOwoKICAgICAgICAgICAgICBpZiAoc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0pIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgMyArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgICBpcCArPSAzOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDMgKyBiY1tpcCArIDFdICsgYmNbaXAgKyAyXTsKICAgICAgICAgICAgICAgIGlwICs9IDMgKyBiY1tpcCArIDFdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGVuZHMucHVzaChlbmQpOwogICAgICAgICAgICAgIGlwcy5wdXNoKGlwICsgMyArIGJjW2lwICsgMV0gKyBiY1tpcCArIDJdKTsKCiAgICAgICAgICAgICAgaWYgKHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdID09PSBwZWckRkFJTEVEKSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDMgKyBiY1tpcCArIDFdOwogICAgICAgICAgICAgICAgaXAgKz0gMzsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyAzICsgYmNbaXAgKyAxXSArIGJjW2lwICsgMl07CiAgICAgICAgICAgICAgICBpcCArPSAzICsgYmNbaXAgKyAxXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBlbmRzLnB1c2goZW5kKTsKICAgICAgICAgICAgICBpcHMucHVzaChpcCArIDMgKyBiY1tpcCArIDFdICsgYmNbaXAgKyAyXSk7CgogICAgICAgICAgICAgIGlmIChzdGFja1tzdGFjay5sZW5ndGggLSAxXSAhPT0gcGVnJEZBSUxFRCkgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyAzICsgYmNbaXAgKyAxXTsKICAgICAgICAgICAgICAgIGlwICs9IDM7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgMyArIGJjW2lwICsgMV0gKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgICAgaXAgKz0gMyArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgaWYgKHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdICE9PSBwZWckRkFJTEVEKSB7CiAgICAgICAgICAgICAgICBlbmRzLnB1c2goZW5kKTsKICAgICAgICAgICAgICAgIGlwcy5wdXNoKGlwKTsKCiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDIgKyBiY1tpcCArIDFdOwogICAgICAgICAgICAgICAgaXAgKz0gMjsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaXAgKz0gMiArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgZW5kcy5wdXNoKGVuZCk7CiAgICAgICAgICAgICAgaXBzLnB1c2goaXAgKyAzICsgYmNbaXAgKyAxXSArIGJjW2lwICsgMl0pOwoKICAgICAgICAgICAgICBpZiAoaW5wdXQubGVuZ3RoID4gcGVnJGN1cnJQb3MpIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgMyArIGJjW2lwICsgMV07CiAgICAgICAgICAgICAgICBpcCArPSAzOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDMgKyBiY1tpcCArIDFdICsgYmNbaXAgKyAyXTsKICAgICAgICAgICAgICAgIGlwICs9IDMgKyBiY1tpcCArIDFdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIGVuZHMucHVzaChlbmQpOwogICAgICAgICAgICAgIGlwcy5wdXNoKGlwICsgNCArIGJjW2lwICsgMl0gKyBiY1tpcCArIDNdKTsKCiAgICAgICAgICAgICAgaWYgKGlucHV0LnN1YnN0cihwZWckY3VyclBvcywgcGVnJGNvbnN0c1tiY1tpcCArIDFdXS5sZW5ndGgpID09PSBwZWckY29uc3RzW2JjW2lwICsgMV1dKSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDQgKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgICAgaXAgKz0gNDsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyA0ICsgYmNbaXAgKyAyXSArIGJjW2lwICsgM107CiAgICAgICAgICAgICAgICBpcCArPSA0ICsgYmNbaXAgKyAyXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICBlbmRzLnB1c2goZW5kKTsKICAgICAgICAgICAgICBpcHMucHVzaChpcCArIDQgKyBiY1tpcCArIDJdICsgYmNbaXAgKyAzXSk7CgogICAgICAgICAgICAgIGlmIChpbnB1dC5zdWJzdHIocGVnJGN1cnJQb3MsIHBlZyRjb25zdHNbYmNbaXAgKyAxXV0ubGVuZ3RoKS50b0xvd2VyQ2FzZSgpID09PSBwZWckY29uc3RzW2JjW2lwICsgMV1dKSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDQgKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgICAgaXAgKz0gNDsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZW5kID0gaXAgKyA0ICsgYmNbaXAgKyAyXSArIGJjW2lwICsgM107CiAgICAgICAgICAgICAgICBpcCArPSA0ICsgYmNbaXAgKyAyXTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICBlbmRzLnB1c2goZW5kKTsKICAgICAgICAgICAgICBpcHMucHVzaChpcCArIDQgKyBiY1tpcCArIDJdICsgYmNbaXAgKyAzXSk7CgogICAgICAgICAgICAgIGlmIChwZWckY29uc3RzW2JjW2lwICsgMV1dLnRlc3QoaW5wdXQuY2hhckF0KHBlZyRjdXJyUG9zKSkpIHsKICAgICAgICAgICAgICAgIGVuZCA9IGlwICsgNCArIGJjW2lwICsgMl07CiAgICAgICAgICAgICAgICBpcCArPSA0OwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlbmQgPSBpcCArIDQgKyBiY1tpcCArIDJdICsgYmNbaXAgKyAzXTsKICAgICAgICAgICAgICAgIGlwICs9IDQgKyBiY1tpcCArIDJdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgIHN0YWNrLnB1c2goaW5wdXQuc3Vic3RyKHBlZyRjdXJyUG9zLCBiY1tpcCArIDFdKSk7CiAgICAgICAgICAgICAgcGVnJGN1cnJQb3MgKz0gYmNbaXAgKyAxXTsKICAgICAgICAgICAgICBpcCArPSAyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICBzdGFjay5wdXNoKHBlZyRjb25zdHNbYmNbaXAgKyAxXV0pOwogICAgICAgICAgICAgIHBlZyRjdXJyUG9zICs9IHBlZyRjb25zdHNbYmNbaXAgKyAxXV0ubGVuZ3RoOwogICAgICAgICAgICAgIGlwICs9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgIHN0YWNrLnB1c2gocGVnJEZBSUxFRCk7CiAgICAgICAgICAgICAgaWYgKHBlZyRzaWxlbnRGYWlscyA9PT0gMCkgewogICAgICAgICAgICAgICAgcGVnJGZhaWwocGVnJGNvbnN0c1tiY1tpcCArIDFdXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlwICs9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgIHBlZyRyZXBvcnRlZFBvcyA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDEgLSBiY1tpcCArIDFdXTsKICAgICAgICAgICAgICBpcCArPSAyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICBwZWckcmVwb3J0ZWRQb3MgPSBwZWckY3VyclBvczsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICBwYXJhbXMgPSBiYy5zbGljZShpcCArIDQsIGlwICsgNCArIGJjW2lwICsgM10pOwogICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBiY1tpcCArIDNdOyBpKyspIHsKICAgICAgICAgICAgICAgIHBhcmFtc1tpXSA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDEgLSBwYXJhbXNbaV1dOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc3RhY2suc3BsaWNlKAogICAgICAgICAgICAgICAgc3RhY2subGVuZ3RoIC0gYmNbaXAgKyAyXSwKICAgICAgICAgICAgICAgIGJjW2lwICsgMl0sCiAgICAgICAgICAgICAgICBwZWckY29uc3RzW2JjW2lwICsgMV1dLmFwcGx5KG51bGwsIHBhcmFtcykKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICBpcCArPSA0ICsgYmNbaXAgKyAzXTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgc3RhY2sucHVzaChwZWckcGFyc2VSdWxlKGJjW2lwICsgMV0pKTsKICAgICAgICAgICAgICBpcCArPSAyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICBwZWckc2lsZW50RmFpbHMrKzsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyNToKICAgICAgICAgICAgICBwZWckc2lsZW50RmFpbHMtLTsKICAgICAgICAgICAgICBpcCsrOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgb3Bjb2RlOiAiICsgYmNbaXBdICsgIi4iKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChlbmRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGVuZCA9IGVuZHMucG9wKCk7CiAgICAgICAgICBpcCA9IGlwcy5wb3AoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gc3RhY2tbMF07CiAgICB9CgoKICAgICAgb3B0aW9ucy5kYXRhID0ge307IC8vIE9iamVjdCB0byB3aGljaCBoZWFkZXIgYXR0cmlidXRlcyB3aWxsIGJlIGFzc2lnbmVkIGR1cmluZyBwYXJzaW5nCgogICAgICBmdW5jdGlvbiBsaXN0IChmaXJzdCwgcmVzdCkgewogICAgICAgIHJldHVybiBbZmlyc3RdLmNvbmNhdChyZXN0KTsKICAgICAgfQoKCiAgICBwZWckcmVzdWx0ID0gcGVnJHBhcnNlUnVsZShwZWckc3RhcnRSdWxlSW5kZXgpOwoKICAgIGlmIChwZWckcmVzdWx0ICE9PSBwZWckRkFJTEVEICYmIHBlZyRjdXJyUG9zID09PSBpbnB1dC5sZW5ndGgpIHsKICAgICAgcmV0dXJuIHBlZyRyZXN1bHQ7CiAgICB9IGVsc2UgewogICAgICBpZiAocGVnJHJlc3VsdCAhPT0gcGVnJEZBSUxFRCAmJiBwZWckY3VyclBvcyA8IGlucHV0Lmxlbmd0aCkgewogICAgICAgIHBlZyRmYWlsKHsgdHlwZTogImVuZCIsIGRlc2NyaXB0aW9uOiAiZW5kIG9mIGlucHV0IiB9KTsKICAgICAgfQoKICAgICAgdGhyb3cgcGVnJGJ1aWxkRXhjZXB0aW9uKG51bGwsIHBlZyRtYXhGYWlsRXhwZWN0ZWQsIHBlZyRtYXhGYWlsUG9zKTsKICAgIH0KICB9CgogIHJldHVybiB7CiAgICBTeW50YXhFcnJvcjogU3ludGF4RXJyb3IsCiAgICBwYXJzZTogICAgICAgcGFyc2UKICB9Owp9KSgpOwoKfSx7fV0sMTY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IEhhY2tzIC0gVGhpcyBmaWxlIGNvbnRhaW5zIGFsbCBvZiB0aGUgdGhpbmdzIHdlCiAqIHdpc2ggd2UgZGlkbid0IGhhdmUgdG8gZG8sIGp1c3QgZm9yIGludGVyb3AuICBJdCBpcyBzaW1pbGFyIHRvCiAqIFV0aWxzLCB3aGljaCBwcm92aWRlcyBhY3R1YWxseSB1c2VmdWwgYW5kIHJlbGV2YW50IGZ1bmN0aW9ucyBmb3IKICogYSBTSVAgbGlicmFyeS4gTWV0aG9kcyBpbiB0aGlzIGZpbGUgYXJlIGdyb3VwZWQgYnkgdmVuZG9yLCBzbwogKiBhcyB0byBtb3N0IGVhc2lseSB0cmFjayB3aGVuIHBhcnRpY3VsYXIgaGFja3MgbWF5IG5vdCBiZSBuZWNlc3NhcnkgYW55bW9yZS4KICovCgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKCi8va2VlcCB0byBxdWlldCBqc2hpbnQsIGFuZCByZW1haW4gY29uc2lzdGVudCB3aXRoIG90aGVyIGZpbGVzClNJUCA9IFNJUDsKCnZhciBIYWNrcyA9IHsKICBBbGxCcm93c2VyczogewogICAgbWFza0R0bHM6IGZ1bmN0aW9uIChtZXNzYWdlKSB7CiAgICAgIGlmIChtZXNzYWdlLmJvZHkpIHsKICAgICAgICBtZXNzYWdlLmJvZHkgPSBtZXNzYWdlLmJvZHkucmVwbGFjZSgvIFVEUFwvVExTXC9SVFBcL1NBVlAvZ21pLCAiIFJUUC9TQVZQIik7CiAgICAgIH0KICAgIH0sCiAgICB1bm1hc2tEdGxzOiBmdW5jdGlvbiAoc2RwKSB7CiAgICAgIC8qKgogICAgICAgKiBDaHJvbWUgZG9lcyBub3QgaGFuZGxlIERUTFMgY29ycmVjdGx5IChDYW5hcmF5IGRvZXMsIGJ1dCBub3QgcHJvZHVjdGlvbikKICAgICAgICoga2VlcGluZyBDaHJvbWUgYXMgU0RFUyB1bnRpbCBEVExTIGlzIGZpeGVkIChjb21tZW50IG91dCAnaXNfb3BlcmEnIGNvbmRpdGlvbikKICAgICAgICoKICAgICAgICogVVBEQVRFOiBNYXkgMjEsIDIwMTQKICAgICAgICogQ2hyb21lIDM1IG5vdyBwcm9wZXJseSBkZWZhdWx0cyB0byBEVExTLiAgT25seSBPcGVyYSByZW1haW5zIHVzaW5nIFNERVMKICAgICAgICoKICAgICAgICogVVBEQVRFOiAyMDE0LTA5LTI0CiAgICAgICAqIE9wZXJhIG5vdyBzdXBwb3J0cyBEVExTIGJ5IGRlZmF1bHQgYXMgd2VsbC4KICAgICAgICoKICAgICAgICoqLwogICAgICByZXR1cm4gc2RwLnJlcGxhY2UoLyBSVFBcL1NBVlAvZ21pLCAiIFVEUC9UTFMvUlRQL1NBVlAiKTsKICAgIH0KICB9LAogIEZpcmVmb3g6IHsKICAgIC8qIENvbmRpdGlvbiB0byBkZXRlY3QgaWYgaGFja3MgYXJlIGFwcGxpY2FibGUgKi8KICAgIGlzRmlyZWZveDogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdHlwZW9mIG1velJUQ1BlZXJDb25uZWN0aW9uICE9PSAndW5kZWZpbmVkJzsKICAgIH0sCgogICAgY2Fubm90SGFuZGxlRXh0cmFXaGl0ZXNwYWNlOiBmdW5jdGlvbiAobWVzc2FnZSkgewogICAgICBpZiAodGhpcy5pc0ZpcmVmb3goKSAmJiBtZXNzYWdlLmJvZHkpIHsKICAgICAgICBtZXNzYWdlLmJvZHkgPSBtZXNzYWdlLmJvZHkucmVwbGFjZSgvIFxyXG4vZywgIlxyXG4iKTsKICAgICAgfQogICAgfSwKCiAgICBoYXNNaXNzaW5nQ0xpbmVJblNEUDogZnVuY3Rpb24gKHNkcCkgewogICAgICAvKgogICAgICAgKiBUaGlzIGlzIGEgRmlyZWZveCBoYWNrIHRvIGluc2VydCB2YWxpZCBzZHAgd2hlbiBnZXREZXNjcmlwdGlvbiBpcwogICAgICAgKiBjYWxsZWQgd2l0aCB0aGUgY29uc3RyYWludCBvZmZlclRvUmVjZWl2ZVZpZGVvID0gZmFsc2UuCiAgICAgICAqIFdlIHNlYXJjaCBmb3IgZWl0aGVyIGEgYy1saW5lIGF0IHRoZSB0b3Agb2YgdGhlIHNkcCBhYm92ZSBhbGwKICAgICAgICogbS1saW5lcy4gSWYgdGhhdCBkb2VzIG5vdCBleGlzdCB0aGVuIHdlIHNlYXJjaCBmb3IgYSBjLWxpbmUKICAgICAgICogYmVuZWF0aCBlYWNoIG0tbGluZS4gSWYgaXQgaXMgbWlzc2luZyBhIGMtbGluZSwgd2UgaW5zZXJ0CiAgICAgICAqIGEgZmFrZSBjLWxpbmUgd2l0aCB0aGUgaXAgYWRkcmVzcyAwLjAuMC4wLiBUaGlzIGlzIHRoZW4gdmFsaWQKICAgICAgICogc2RwIGFuZCBubyBtZWRpYSB3aWxsIGJlIHNlbnQgZm9yIHRoYXQgbS1saW5lLgogICAgICAgKgogICAgICAgKiBWYWxpZCBTRFAgaXM6CiAgICAgICAqIG09CiAgICAgICAqIGk9CiAgICAgICAqIGM9CiAgICAgICAqLwogICAgICB2YXIgaW5zZXJ0QXQsIG1saW5lczsKICAgICAgaWYgKHNkcC5pbmRleE9mKCdjPScpID4gc2RwLmluZGV4T2YoJ209JykpIHsKCiAgICAgICAgLy8gRmluZCBhbGwgbT0gbGluZXMKICAgICAgICBtbGluZXMgPSBzZHAubWF0Y2goL209LipcclxuLiovZyk7CiAgICAgICAgZm9yICh2YXIgaT0wOyBpPG1saW5lcy5sZW5ndGg7IGkrKykgewoKICAgICAgICAgIC8vIElmIGl0IGhhcyBhbiBpPSBsaW5lLCBjaGVjayBpZiB0aGUgbmV4dCBsaW5lIGlzIHRoZSBjPSBsaW5lCiAgICAgICAgICBpZiAobWxpbmVzW2ldLnRvU3RyaW5nKCkuc2VhcmNoKC9pPS4qLykgPj0gMCkgewogICAgICAgICAgICBpbnNlcnRBdCA9IHNkcC5pbmRleE9mKG1saW5lc1tpXS50b1N0cmluZygpKSttbGluZXNbaV0udG9TdHJpbmcoKS5sZW5ndGg7CiAgICAgICAgICAgIGlmIChzZHAuc3Vic3RyKGluc2VydEF0LDIpIT09J2M9JykgewogICAgICAgICAgICAgIHNkcCA9IHNkcC5zdWJzdHIoMCxpbnNlcnRBdCkgKyAnXHJcbmM9SU4gSVA0IDAuMC4wLjAnICsgc2RwLnN1YnN0cihpbnNlcnRBdCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAvLyBlbHNlIGFkZCB0aGUgQyBsaW5lIGlmIGl0J3MgbWlzc2luZwogICAgICAgICAgfSBlbHNlIGlmIChtbGluZXNbaV0udG9TdHJpbmcoKS5zZWFyY2goL2M9LiovKSA8IDApIHsKICAgICAgICAgICAgaW5zZXJ0QXQgPSBzZHAuaW5kZXhPZihtbGluZXNbaV0udG9TdHJpbmcoKS5tYXRjaCgvLiovKSkrbWxpbmVzW2ldLnRvU3RyaW5nKCkubWF0Y2goLy4qLykudG9TdHJpbmcoKS5sZW5ndGg7CiAgICAgICAgICAgIHNkcCA9IHNkcC5zdWJzdHIoMCxpbnNlcnRBdCkgKyAnXHJcbmM9SU4gSVA0IDAuMC4wLjAnICsgc2RwLnN1YnN0cihpbnNlcnRBdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBzZHA7CiAgICB9LAogIH0sCgogIENocm9tZTogewogICAgbmVlZHNFeHBsaWNpdGx5SW5hY3RpdmVTRFA6IGZ1bmN0aW9uIChzZHApIHsKICAgICAgdmFyIHN1YiwgaW5kZXg7CgogICAgICBpZiAoSGFja3MuRmlyZWZveC5pc0ZpcmVmb3goKSkgeyAvLyBGaXggdGhpcyBpbiBGaXJlZm94IGJlZm9yZSBzZW5kaW5nCiAgICAgICAgaW5kZXggPSBzZHAuaW5kZXhPZignbT12aWRlbyAwJyk7CiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgICAgc3ViID0gc2RwLnN1YnN0cihpbmRleCk7CiAgICAgICAgICBzdWIgPSBzdWIucmVwbGFjZSgvXHJcbmM9SU4gSVA0LipcclxuJC8sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXHJcbmM9SU4gSVA0IDAuMC4wLjBcclxuYT1pbmFjdGl2ZVxyXG4nKTsKICAgICAgICAgIHJldHVybiBzZHAuc3Vic3RyKDAsIGluZGV4KSArIHN1YjsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHNkcDsKICAgIH0sCgogICAgZ2V0c0NvbmZ1c2VkQWJvdXRHVU06IGZ1bmN0aW9uIChzZXNzaW9uKSB7CiAgICAgIGlmIChzZXNzaW9uLm1lZGlhSGFuZGxlcikgewogICAgICAgIHNlc3Npb24ubWVkaWFIYW5kbGVyLmNsb3NlKCk7CiAgICAgIH0KICAgIH0KICB9Cn07CnJldHVybiBIYWNrczsKfTsKfSx7fV0sMTc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CnZhciBsZXZlbHMgPSB7CiAgJ2Vycm9yJzogMCwKICAnd2Fybic6IDEsCiAgJ2xvZyc6IDIsCiAgJ2RlYnVnJzogMwp9OwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoY29uc29sZSkgewoKdmFyIExvZ2dlckZhY3RvcnkgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIGxvZ2dlciwKICAgIGxldmVsID0gMiwKICAgIGJ1aWx0aW5FbmFibGVkID0gdHJ1ZSwKICAgIGNvbm5lY3RvciA9IG51bGw7CgogICAgdGhpcy5sb2dnZXJzID0ge307CgogICAgbG9nZ2VyID0gdGhpcy5nZXRMb2dnZXIoJ3NpcC5sb2dnZXJmYWN0b3J5Jyk7CgoKICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB7CiAgICBidWlsdGluRW5hYmxlZDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiBidWlsdGluRW5hYmxlZDsgfSwKICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgICBidWlsdGluRW5hYmxlZCA9IHZhbHVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBsb2dnZXIuZXJyb3IoJ2ludmFsaWQgImJ1aWx0aW5FbmFibGVkIiBwYXJhbWV0ZXIgdmFsdWU6ICcrIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIGxldmVsOiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7cmV0dXJuIGxldmVsOyB9LAogICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgaWYgKHZhbHVlID49IDAgJiYgdmFsdWUgPD0zKSB7CiAgICAgICAgICBsZXZlbCA9IHZhbHVlOwogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPiAzKSB7CiAgICAgICAgICBsZXZlbCA9IDM7CiAgICAgICAgfSBlbHNlIGlmIChsZXZlbHMuaGFzT3duUHJvcGVydHkodmFsdWUpKSB7CiAgICAgICAgICBsZXZlbCA9IGxldmVsc1t2YWx1ZV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGxvZ2dlci5lcnJvcignaW52YWxpZCAibGV2ZWwiIHBhcmFtZXRlciB2YWx1ZTogJysgSlNPTi5zdHJpbmdpZnkodmFsdWUpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgY29ubmVjdG9yOiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7cmV0dXJuIGNvbm5lY3RvcjsgfSwKICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgaWYodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09ICIiIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGNvbm5lY3RvciA9IG51bGw7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGNvbm5lY3RvciA9IHZhbHVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBsb2dnZXIuZXJyb3IoJ2ludmFsaWQgImNvbm5lY3RvciIgcGFyYW1ldGVyIHZhbHVlOiAnKyBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0pOwp9OwoKTG9nZ2VyRmFjdG9yeS5wcm90b3R5cGUucHJpbnQgPSBmdW5jdGlvbih0YXJnZXQsIGNhdGVnb3J5LCBsYWJlbCwgY29udGVudCkgewogIGlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHsKICAgIHZhciBwcmVmaXggPSBbbmV3IERhdGUoKSwgY2F0ZWdvcnldOwogICAgaWYgKGxhYmVsKSB7CiAgICAgIHByZWZpeC5wdXNoKGxhYmVsKTsKICAgIH0KICAgIGNvbnRlbnQgPSBwcmVmaXguY29uY2F0KGNvbnRlbnQpLmpvaW4oJyB8ICcpOwogIH0KICB0YXJnZXQuY2FsbChjb25zb2xlLCBjb250ZW50KTsKfTsKCmZ1bmN0aW9uIExvZ2dlciAobG9nZ2VyLCBjYXRlZ29yeSwgbGFiZWwpIHsKICB0aGlzLmxvZ2dlciA9IGxvZ2dlcjsKICB0aGlzLmNhdGVnb3J5ID0gY2F0ZWdvcnk7CiAgdGhpcy5sYWJlbCA9IGxhYmVsOwp9CgpPYmplY3Qua2V5cyhsZXZlbHMpLmZvckVhY2goZnVuY3Rpb24gKHRhcmdldE5hbWUpIHsKICBMb2dnZXIucHJvdG90eXBlW3RhcmdldE5hbWVdID0gZnVuY3Rpb24gKGNvbnRlbnQpIHsKICAgIHRoaXMubG9nZ2VyW3RhcmdldE5hbWVdKHRoaXMuY2F0ZWdvcnksIHRoaXMubGFiZWwsIGNvbnRlbnQpOwogIH07CgogIExvZ2dlckZhY3RvcnkucHJvdG90eXBlW3RhcmdldE5hbWVdID0gZnVuY3Rpb24gKGNhdGVnb3J5LCBsYWJlbCwgY29udGVudCkgewogICAgaWYgKHRoaXMubGV2ZWwgPj0gbGV2ZWxzW3RhcmdldE5hbWVdKSB7CiAgICAgIGlmICh0aGlzLmJ1aWx0aW5FbmFibGVkKSB7CiAgICAgICAgdGhpcy5wcmludChjb25zb2xlW3RhcmdldE5hbWVdLCBjYXRlZ29yeSwgbGFiZWwsIGNvbnRlbnQpOwogICAgICB9CgogICAgICBpZiAodGhpcy5jb25uZWN0b3IpIHsKICAgICAgICB0aGlzLmNvbm5lY3Rvcih0YXJnZXROYW1lLCBjYXRlZ29yeSwgbGFiZWwsIGNvbnRlbnQpOwogICAgICB9CiAgICB9CiAgfTsKfSk7CgpMb2dnZXJGYWN0b3J5LnByb3RvdHlwZS5nZXRMb2dnZXIgPSBmdW5jdGlvbihjYXRlZ29yeSwgbGFiZWwpIHsKICB2YXIgbG9nZ2VyOwoKICBpZiAobGFiZWwgJiYgdGhpcy5sZXZlbCA9PT0gMykgewogICAgcmV0dXJuIG5ldyBMb2dnZXIodGhpcywgY2F0ZWdvcnksIGxhYmVsKTsKICB9IGVsc2UgaWYgKHRoaXMubG9nZ2Vyc1tjYXRlZ29yeV0pIHsKICAgIHJldHVybiB0aGlzLmxvZ2dlcnNbY2F0ZWdvcnldOwogIH0gZWxzZSB7CiAgICBsb2dnZXIgPSBuZXcgTG9nZ2VyKHRoaXMsIGNhdGVnb3J5KTsKICAgIHRoaXMubG9nZ2Vyc1tjYXRlZ29yeV0gPSBsb2dnZXI7CiAgICByZXR1cm4gbG9nZ2VyOwogIH0KfTsKCnJldHVybiBMb2dnZXJGYWN0b3J5Owp9OwoKfSx7fV0sMTg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IE1lZGlhSGFuZGxlcgogKi8KCi8qIE1lZGlhSGFuZGxlcgogKiBAY2xhc3MgUGVlckNvbm5lY3Rpb24gaGVscGVyIENsYXNzLgogKiBAcGFyYW0ge1NJUC5TZXNzaW9ufSBzZXNzaW9uCiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10KICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEV2ZW50RW1pdHRlcikgewp2YXIgTWVkaWFIYW5kbGVyID0gZnVuY3Rpb24oc2Vzc2lvbiwgb3B0aW9ucykgewogIC8vIGtlZXAganNoaW50IGhhcHB5CiAgc2Vzc2lvbiA9IHNlc3Npb247CiAgb3B0aW9ucyA9IG9wdGlvbnM7Cn07CgpNZWRpYUhhbmRsZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFdmVudEVtaXR0ZXIucHJvdG90eXBlLCB7CiAgaXNSZWFkeToge3ZhbHVlOiBmdW5jdGlvbiBpc1JlYWR5ICgpIHt9fSwKCiAgY2xvc2U6IHt2YWx1ZTogZnVuY3Rpb24gY2xvc2UgKCkge319LAoKICAvKioKICAgKiBAcGFyYW0ge09iamVjdH0gW21lZGlhSGludF0gQSBjdXN0b20gb2JqZWN0IGRlc2NyaWJpbmcgdGhlIG1lZGlhIHRvIGJlIHVzZWQgZHVyaW5nIHRoaXMgc2Vzc2lvbi4KICAgKi8KICBnZXREZXNjcmlwdGlvbjoge3ZhbHVlOiBmdW5jdGlvbiBnZXREZXNjcmlwdGlvbiAobWVkaWFIaW50KSB7CiAgICAvLyBrZWVwIGpzaGludCBoYXBweQogICAgbWVkaWFIaW50ID0gbWVkaWFIaW50OwogIH19LAoKICAvKioKICAqIE1lc3NhZ2UgcmVjZXB0aW9uLgogICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKICAqIEBwYXJhbSB7U3RyaW5nfSBkZXNjcmlwdGlvbgogICovCiAgc2V0RGVzY3JpcHRpb246IHt2YWx1ZTogZnVuY3Rpb24gc2V0RGVzY3JpcHRpb24gKGRlc2NyaXB0aW9uKSB7CiAgICAvLyBrZWVwIGpzaGludCBoYXBweQogICAgZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjsKICB9fQp9KTsKCnJldHVybiBNZWRpYUhhbmRsZXI7Cn07Cgp9LHt9XSwxOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBmaWxlb3ZlcnZpZXcgU0lQIE5hbWVBZGRySGVhZGVyCiAqLwoKLyoqCiAqIEBhdWdtZW50cyBTSVAKICogQGNsYXNzIENsYXNzIGNyZWF0aW5nIGEgTmFtZSBBZGRyZXNzIFNJUCBoZWFkZXIuCiAqCiAqIEBwYXJhbSB7U0lQLlVSSX0gdXJpCiAqIEBwYXJhbSB7U3RyaW5nfSBbZGlzcGxheU5hbWVdCiAqIEBwYXJhbSB7T2JqZWN0fSBbcGFyYW1ldGVyc10KICoKICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewp2YXIgTmFtZUFkZHJIZWFkZXI7CgpOYW1lQWRkckhlYWRlciA9IGZ1bmN0aW9uKHVyaSwgZGlzcGxheU5hbWUsIHBhcmFtZXRlcnMpIHsKICB2YXIgcGFyYW07CgogIC8vIENoZWNrcwogIGlmKCF1cmkgfHwgISh1cmkgaW5zdGFuY2VvZiBTSVAuVVJJKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignbWlzc2luZyBvciBpbnZhbGlkICJ1cmkiIHBhcmFtZXRlcicpOwogIH0KCiAgLy8gSW5pdGlhbGl6ZSBwYXJhbWV0ZXJzCiAgdGhpcy51cmkgPSB1cmk7CiAgdGhpcy5wYXJhbWV0ZXJzID0ge307CgogIGZvciAocGFyYW0gaW4gcGFyYW1ldGVycykgewogICAgdGhpcy5zZXRQYXJhbShwYXJhbSwgcGFyYW1ldGVyc1twYXJhbV0pOwogIH0KCiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywgewogICAgZnJpZW5kbHlOYW1lOiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLmRpc3BsYXlOYW1lIHx8IHVyaS5hb3I7IH0KICAgIH0sCgogICAgZGlzcGxheU5hbWU6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIGRpc3BsYXlOYW1lOyB9LAogICAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgZGlzcGxheU5hbWUgPSAodmFsdWUgPT09IDApID8gJzAnIDogdmFsdWU7CiAgICAgIH0KICAgIH0KICB9KTsKfTsKTmFtZUFkZHJIZWFkZXIucHJvdG90eXBlID0gewogIHNldFBhcmFtOiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgaWYoa2V5KSB7CiAgICAgIHRoaXMucGFyYW1ldGVyc1trZXkudG9Mb3dlckNhc2UoKV0gPSAodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyB8fCB2YWx1ZSA9PT0gbnVsbCkgPyBudWxsIDogdmFsdWUudG9TdHJpbmcoKTsKICAgIH0KICB9LAogIGdldFBhcmFtOiBTSVAuVVJJLnByb3RvdHlwZS5nZXRQYXJhbSwKICBoYXNQYXJhbTogU0lQLlVSSS5wcm90b3R5cGUuaGFzUGFyYW0sCiAgZGVsZXRlUGFyYW06IFNJUC5VUkkucHJvdG90eXBlLmRlbGV0ZVBhcmFtLAogIGNsZWFyUGFyYW1zOiBTSVAuVVJJLnByb3RvdHlwZS5jbGVhclBhcmFtcywKCiAgY2xvbmU6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIG5ldyBOYW1lQWRkckhlYWRlcigKICAgICAgdGhpcy51cmkuY2xvbmUoKSwKICAgICAgdGhpcy5kaXNwbGF5TmFtZSwKICAgICAgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnBhcmFtZXRlcnMpKSk7CiAgfSwKCiAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgdmFyIGJvZHksIHBhcmFtZXRlcjsKCiAgICBib2R5ICA9ICh0aGlzLmRpc3BsYXlOYW1lIHx8IHRoaXMuZGlzcGxheU5hbWUgPT09IDApID8gJyInICsgdGhpcy5kaXNwbGF5TmFtZSArICciICcgOiAnJzsKICAgIGJvZHkgKz0gJzwnICsgdGhpcy51cmkudG9TdHJpbmcoKSArICc+JzsKCiAgICBmb3IgKHBhcmFtZXRlciBpbiB0aGlzLnBhcmFtZXRlcnMpIHsKICAgICAgYm9keSArPSAnOycgKyBwYXJhbWV0ZXI7CgogICAgICBpZiAodGhpcy5wYXJhbWV0ZXJzW3BhcmFtZXRlcl0gIT09IG51bGwpIHsKICAgICAgICBib2R5ICs9ICc9JysgdGhpcy5wYXJhbWV0ZXJzW3BhcmFtZXRlcl07CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gYm9keTsKICB9Cn07CgoKLyoqCiAgKiBQYXJzZSB0aGUgZ2l2ZW4gc3RyaW5nIGFuZCByZXR1cm5zIGEgU0lQLk5hbWVBZGRySGVhZGVyIGluc3RhbmNlIG9yIHVuZGVmaW5lZCBpZgogICogaXQgaXMgYW4gaW52YWxpZCBOYW1lQWRkckhlYWRlci4KICAqIEBwdWJsaWMKICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lX2FkZHJfaGVhZGVyCiAgKi8KTmFtZUFkZHJIZWFkZXIucGFyc2UgPSBmdW5jdGlvbihuYW1lX2FkZHJfaGVhZGVyKSB7CiAgbmFtZV9hZGRyX2hlYWRlciA9IFNJUC5HcmFtbWFyLnBhcnNlKG5hbWVfYWRkcl9oZWFkZXIsJ05hbWVfQWRkcl9IZWFkZXInKTsKCiAgaWYgKG5hbWVfYWRkcl9oZWFkZXIgIT09IC0xKSB7CiAgICByZXR1cm4gbmFtZV9hZGRyX2hlYWRlcjsKICB9IGVsc2UgewogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9Cn07CgpTSVAuTmFtZUFkZHJIZWFkZXIgPSBOYW1lQWRkckhlYWRlcjsKfTsKCn0se31dLDIwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBTSVAgTWVzc2FnZSBQYXJzZXIKICovCgovKioKICogRXh0cmFjdCBhbmQgcGFyc2UgZXZlcnkgaGVhZGVyIG9mIGEgU0lQIG1lc3NhZ2UuCiAqIEBhdWdtZW50cyBTSVAKICogQG5hbWVzcGFjZQogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CnZhciBQYXJzZXI7CgpmdW5jdGlvbiBnZXRIZWFkZXIoZGF0YSwgaGVhZGVyU3RhcnQpIHsKICB2YXIKICAgIC8vICdzdGFydCcgcG9zaXRpb24gb2YgdGhlIGhlYWRlci4KICAgIHN0YXJ0ID0gaGVhZGVyU3RhcnQsCiAgICAvLyAnZW5kJyBwb3NpdGlvbiBvZiB0aGUgaGVhZGVyLgogICAgZW5kID0gMCwKICAgIC8vICdwYXJ0aWFsIGVuZCcgcG9zaXRpb24gb2YgdGhlIGhlYWRlci4KICAgIHBhcnRpYWxFbmQgPSAwOwoKICAvL0VuZCBvZiBtZXNzYWdlLgogIGlmIChkYXRhLnN1YnN0cmluZyhzdGFydCwgc3RhcnQgKyAyKS5tYXRjaCgvKF5cclxuKS8pKSB7CiAgICByZXR1cm4gLTI7CiAgfQoKICB3aGlsZShlbmQgPT09IDApIHsKICAgIC8vIFBhcnRpYWwgRW5kIG9mIEhlYWRlci4KICAgIHBhcnRpYWxFbmQgPSBkYXRhLmluZGV4T2YoJ1xyXG4nLCBzdGFydCk7CgogICAgLy8gJ2luZGV4T2YnIHJldHVybnMgLTEgaWYgdGhlIHZhbHVlIHRvIGJlIGZvdW5kIG5ldmVyIG9jY3Vycy4KICAgIGlmIChwYXJ0aWFsRW5kID09PSAtMSkgewogICAgICByZXR1cm4gcGFydGlhbEVuZDsKICAgIH0KCiAgICBpZighZGF0YS5zdWJzdHJpbmcocGFydGlhbEVuZCArIDIsIHBhcnRpYWxFbmQgKyA0KS5tYXRjaCgvKF5cclxuKS8pICYmIGRhdGEuY2hhckF0KHBhcnRpYWxFbmQgKyAyKS5tYXRjaCgvKF5ccyspLykpIHsKICAgICAgLy8gTm90IHRoZSBlbmQgb2YgdGhlIG1lc3NhZ2UuIENvbnRpbnVlIGZyb20gdGhlIG5leHQgcG9zaXRpb24uCiAgICAgIHN0YXJ0ID0gcGFydGlhbEVuZCArIDI7CiAgICB9IGVsc2UgewogICAgICBlbmQgPSBwYXJ0aWFsRW5kOwogICAgfQogIH0KCiAgcmV0dXJuIGVuZDsKfQoKZnVuY3Rpb24gcGFyc2VIZWFkZXIobWVzc2FnZSwgZGF0YSwgaGVhZGVyU3RhcnQsIGhlYWRlckVuZCkgewogIHZhciBoZWFkZXIsIGlkeCwgbGVuZ3RoLCBwYXJzZWQsCiAgICBoY29sb25JbmRleCA9IGRhdGEuaW5kZXhPZignOicsIGhlYWRlclN0YXJ0KSwKICAgIGhlYWRlck5hbWUgPSBkYXRhLnN1YnN0cmluZyhoZWFkZXJTdGFydCwgaGNvbG9uSW5kZXgpLnRyaW0oKSwKICAgIGhlYWRlclZhbHVlID0gZGF0YS5zdWJzdHJpbmcoaGNvbG9uSW5kZXggKyAxLCBoZWFkZXJFbmQpLnRyaW0oKTsKCiAgLy8gSWYgaGVhZGVyLWZpZWxkIGlzIHdlbGwta25vd24sIHBhcnNlIGl0LgogIHN3aXRjaChoZWFkZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHsKICAgIGNhc2UgJ3ZpYSc6CiAgICBjYXNlICd2JzoKICAgICAgbWVzc2FnZS5hZGRIZWFkZXIoJ3ZpYScsIGhlYWRlclZhbHVlKTsKICAgICAgaWYobWVzc2FnZS5nZXRIZWFkZXJzKCd2aWEnKS5sZW5ndGggPT09IDEpIHsKICAgICAgICBwYXJzZWQgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCdWaWEnKTsKICAgICAgICBpZihwYXJzZWQpIHsKICAgICAgICAgIG1lc3NhZ2UudmlhID0gcGFyc2VkOwogICAgICAgICAgbWVzc2FnZS52aWFfYnJhbmNoID0gcGFyc2VkLmJyYW5jaDsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcGFyc2VkID0gMDsKICAgICAgfQogICAgICBicmVhazsKICAgIGNhc2UgJ2Zyb20nOgogICAgY2FzZSAnZic6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCdmcm9tJywgaGVhZGVyVmFsdWUpOwogICAgICBwYXJzZWQgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCdmcm9tJyk7CiAgICAgIGlmKHBhcnNlZCkgewogICAgICAgIG1lc3NhZ2UuZnJvbSA9IHBhcnNlZDsKICAgICAgICBtZXNzYWdlLmZyb21fdGFnID0gcGFyc2VkLmdldFBhcmFtKCd0YWcnKTsKICAgICAgfQogICAgICBicmVhazsKICAgIGNhc2UgJ3RvJzoKICAgIGNhc2UgJ3QnOgogICAgICBtZXNzYWdlLnNldEhlYWRlcigndG8nLCBoZWFkZXJWYWx1ZSk7CiAgICAgIHBhcnNlZCA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ3RvJyk7CiAgICAgIGlmKHBhcnNlZCkgewogICAgICAgIG1lc3NhZ2UudG8gPSBwYXJzZWQ7CiAgICAgICAgbWVzc2FnZS50b190YWcgPSBwYXJzZWQuZ2V0UGFyYW0oJ3RhZycpOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSAncmVjb3JkLXJvdXRlJzoKICAgICAgcGFyc2VkID0gU0lQLkdyYW1tYXIucGFyc2UoaGVhZGVyVmFsdWUsICdSZWNvcmRfUm91dGUnKTsKCiAgICAgIGlmIChwYXJzZWQgPT09IC0xKSB7CiAgICAgICAgcGFyc2VkID0gdW5kZWZpbmVkOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBsZW5ndGggPSBwYXJzZWQubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBoZWFkZXIgPSBwYXJzZWRbaWR4XTsKICAgICAgICBtZXNzYWdlLmFkZEhlYWRlcigncmVjb3JkLXJvdXRlJywgaGVhZGVyVmFsdWUuc3Vic3RyaW5nKGhlYWRlci5wb3NpdGlvbiwgaGVhZGVyLm9mZnNldCkpOwogICAgICAgIG1lc3NhZ2UuaGVhZGVyc1snUmVjb3JkLVJvdXRlJ11bbWVzc2FnZS5nZXRIZWFkZXJzKCdyZWNvcmQtcm91dGUnKS5sZW5ndGggLSAxXS5wYXJzZWQgPSBoZWFkZXIucGFyc2VkOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSAnY2FsbC1pZCc6CiAgICBjYXNlICdpJzoKICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoJ2NhbGwtaWQnLCBoZWFkZXJWYWx1ZSk7CiAgICAgIHBhcnNlZCA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ2NhbGwtaWQnKTsKICAgICAgaWYocGFyc2VkKSB7CiAgICAgICAgbWVzc2FnZS5jYWxsX2lkID0gaGVhZGVyVmFsdWU7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlICdjb250YWN0JzoKICAgIGNhc2UgJ20nOgogICAgICBwYXJzZWQgPSBTSVAuR3JhbW1hci5wYXJzZShoZWFkZXJWYWx1ZSwgJ0NvbnRhY3QnKTsKCiAgICAgIGlmIChwYXJzZWQgPT09IC0xKSB7CiAgICAgICAgcGFyc2VkID0gdW5kZWZpbmVkOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBsZW5ndGggPSBwYXJzZWQubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBoZWFkZXIgPSBwYXJzZWRbaWR4XTsKICAgICAgICBtZXNzYWdlLmFkZEhlYWRlcignY29udGFjdCcsIGhlYWRlclZhbHVlLnN1YnN0cmluZyhoZWFkZXIucG9zaXRpb24sIGhlYWRlci5vZmZzZXQpKTsKICAgICAgICBtZXNzYWdlLmhlYWRlcnNbJ0NvbnRhY3QnXVttZXNzYWdlLmdldEhlYWRlcnMoJ2NvbnRhY3QnKS5sZW5ndGggLSAxXS5wYXJzZWQgPSBoZWFkZXIucGFyc2VkOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSAnY29udGVudC1sZW5ndGgnOgogICAgY2FzZSAnbCc6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCdjb250ZW50LWxlbmd0aCcsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcignY29udGVudC1sZW5ndGgnKTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdjb250ZW50LXR5cGUnOgogICAgY2FzZSAnYyc6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCdjb250ZW50LXR5cGUnLCBoZWFkZXJWYWx1ZSk7CiAgICAgIHBhcnNlZCA9IG1lc3NhZ2UucGFyc2VIZWFkZXIoJ2NvbnRlbnQtdHlwZScpOwogICAgICBicmVhazsKICAgIGNhc2UgJ2NzZXEnOgogICAgICBtZXNzYWdlLnNldEhlYWRlcignY3NlcScsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcignY3NlcScpOwogICAgICBpZihwYXJzZWQpIHsKICAgICAgICBtZXNzYWdlLmNzZXEgPSBwYXJzZWQudmFsdWU7CiAgICAgIH0KICAgICAgaWYobWVzc2FnZSBpbnN0YW5jZW9mIFNJUC5JbmNvbWluZ1Jlc3BvbnNlKSB7CiAgICAgICAgbWVzc2FnZS5tZXRob2QgPSBwYXJzZWQubWV0aG9kOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSAnbWF4LWZvcndhcmRzJzoKICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoJ21heC1mb3J3YXJkcycsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcignbWF4LWZvcndhcmRzJyk7CiAgICAgIGJyZWFrOwogICAgY2FzZSAnd3d3LWF1dGhlbnRpY2F0ZSc6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCd3d3ctYXV0aGVudGljYXRlJywgaGVhZGVyVmFsdWUpOwogICAgICBwYXJzZWQgPSBtZXNzYWdlLnBhcnNlSGVhZGVyKCd3d3ctYXV0aGVudGljYXRlJyk7CiAgICAgIGJyZWFrOwogICAgY2FzZSAncHJveHktYXV0aGVudGljYXRlJzoKICAgICAgbWVzc2FnZS5zZXRIZWFkZXIoJ3Byb3h5LWF1dGhlbnRpY2F0ZScsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcigncHJveHktYXV0aGVudGljYXRlJyk7CiAgICAgIGJyZWFrOwogICAgY2FzZSAncmVmZXItdG8nOgogICAgY2FzZSAncic6CiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKCdyZWZlci10bycsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gbWVzc2FnZS5wYXJzZUhlYWRlcigncmVmZXItdG8nKTsKICAgICAgaWYgKHBhcnNlZCkgewogICAgICAgIG1lc3NhZ2UucmVmZXJfdG8gPSBwYXJzZWQ7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgogICAgICAvLyBEbyBub3QgcGFyc2UgdGhpcyBoZWFkZXIuCiAgICAgIG1lc3NhZ2Uuc2V0SGVhZGVyKGhlYWRlck5hbWUsIGhlYWRlclZhbHVlKTsKICAgICAgcGFyc2VkID0gMDsKICB9CgogIGlmIChwYXJzZWQgPT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuIHsKICAgICAgZXJyb3I6ICdlcnJvciBwYXJzaW5nIGhlYWRlciAiJysgaGVhZGVyTmFtZSArJyInCiAgICB9OwogIH0gZWxzZSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCi8qKiBQYXJzZSBTSVAgTWVzc2FnZQogKiBAZnVuY3Rpb24KICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2UgU0lQIG1lc3NhZ2UuCiAqIEBwYXJhbSB7T2JqZWN0fSBsb2dnZXIgb2JqZWN0LgogKiBAcmV0dXJucyB7U0lQLkluY29taW5nUmVxdWVzdHxTSVAuSW5jb21pbmdSZXNwb25zZXx1bmRlZmluZWR9CiAqLwpQYXJzZXIgPSB7fTsKUGFyc2VyLnBhcnNlTWVzc2FnZSA9IGZ1bmN0aW9uKGRhdGEsIHVhKSB7CiAgdmFyIG1lc3NhZ2UsIGZpcnN0TGluZSwgY29udGVudExlbmd0aCwgYm9keVN0YXJ0LCBwYXJzZWQsCiAgICBoZWFkZXJTdGFydCA9IDAsCiAgICBoZWFkZXJFbmQgPSBkYXRhLmluZGV4T2YoJ1xyXG4nKSwKICAgIGxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnBhcnNlcicpOwoKICBpZihoZWFkZXJFbmQgPT09IC0xKSB7CiAgICBsb2dnZXIud2Fybignbm8gQ1JMRiBmb3VuZCwgbm90IGEgU0lQIG1lc3NhZ2UsIGRpc2NhcmRlZCcpOwogICAgcmV0dXJuOwogIH0KCiAgLy8gUGFyc2UgZmlyc3QgbGluZS4gQ2hlY2sgaWYgaXQgaXMgYSBSZXF1ZXN0IG9yIGEgUmVwbHkuCiAgZmlyc3RMaW5lID0gZGF0YS5zdWJzdHJpbmcoMCwgaGVhZGVyRW5kKTsKICBwYXJzZWQgPSBTSVAuR3JhbW1hci5wYXJzZShmaXJzdExpbmUsICdSZXF1ZXN0X1Jlc3BvbnNlJyk7CgogIGlmKHBhcnNlZCA9PT0gLTEpIHsKICAgIGxvZ2dlci53YXJuKCdlcnJvciBwYXJzaW5nIGZpcnN0IGxpbmUgb2YgU0lQIG1lc3NhZ2U6ICInICsgZmlyc3RMaW5lICsgJyInKTsKICAgIHJldHVybjsKICB9IGVsc2UgaWYoIXBhcnNlZC5zdGF0dXNfY29kZSkgewogICAgbWVzc2FnZSA9IG5ldyBTSVAuSW5jb21pbmdSZXF1ZXN0KHVhKTsKICAgIG1lc3NhZ2UubWV0aG9kID0gcGFyc2VkLm1ldGhvZDsKICAgIG1lc3NhZ2UucnVyaSA9IHBhcnNlZC51cmk7CiAgfSBlbHNlIHsKICAgIG1lc3NhZ2UgPSBuZXcgU0lQLkluY29taW5nUmVzcG9uc2UodWEpOwogICAgbWVzc2FnZS5zdGF0dXNfY29kZSA9IHBhcnNlZC5zdGF0dXNfY29kZTsKICAgIG1lc3NhZ2UucmVhc29uX3BocmFzZSA9IHBhcnNlZC5yZWFzb25fcGhyYXNlOwogIH0KCiAgbWVzc2FnZS5kYXRhID0gZGF0YTsKICBoZWFkZXJTdGFydCA9IGhlYWRlckVuZCArIDI7CgogIC8qIExvb3Agb3ZlciBldmVyeSBsaW5lIGluIGRhdGEuIERldGVjdCB0aGUgZW5kIG9mIGVhY2ggaGVhZGVyIGFuZCBwYXJzZQogICogaXQgb3Igc2ltcGx5IGFkZCB0byB0aGUgaGVhZGVycyBjb2xsZWN0aW9uLgogICovCiAgd2hpbGUodHJ1ZSkgewogICAgaGVhZGVyRW5kID0gZ2V0SGVhZGVyKGRhdGEsIGhlYWRlclN0YXJ0KTsKCiAgICAvLyBUaGUgU0lQIG1lc3NhZ2UgaGFzIG5vcm1hbGx5IGZpbmlzaGVkLgogICAgaWYoaGVhZGVyRW5kID09PSAtMikgewogICAgICBib2R5U3RhcnQgPSBoZWFkZXJTdGFydCArIDI7CiAgICAgIGJyZWFrOwogICAgfQogICAgLy8gZGF0YS5pbmRleE9mIHJldHVybmVkIC0xIGR1ZSB0byBhIG1hbGZvcm1lZCBtZXNzYWdlLgogICAgZWxzZSBpZihoZWFkZXJFbmQgPT09IC0xKSB7CiAgICAgIGxvZ2dlci5lcnJvcignbWFsZm9ybWVkIG1lc3NhZ2UnKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHBhcnNlZCA9IHBhcnNlSGVhZGVyKG1lc3NhZ2UsIGRhdGEsIGhlYWRlclN0YXJ0LCBoZWFkZXJFbmQpOwoKICAgIGlmKHBhcnNlZCAhPT0gdHJ1ZSkgewogICAgICBsb2dnZXIuZXJyb3IocGFyc2VkLmVycm9yKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGhlYWRlclN0YXJ0ID0gaGVhZGVyRW5kICsgMjsKICB9CgogIC8qIFJGQzMyNjEgMTguMy4KICAgKiBJZiB0aGVyZSBhcmUgYWRkaXRpb25hbCBieXRlcyBpbiB0aGUgdHJhbnNwb3J0IHBhY2tldAogICAqIGJleW9uZCB0aGUgZW5kIG9mIHRoZSBib2R5LCB0aGV5IE1VU1QgYmUgZGlzY2FyZGVkLgogICAqLwogIGlmKG1lc3NhZ2UuaGFzSGVhZGVyKCdjb250ZW50LWxlbmd0aCcpKSB7CiAgICBjb250ZW50TGVuZ3RoID0gbWVzc2FnZS5nZXRIZWFkZXIoJ2NvbnRlbnQtbGVuZ3RoJyk7CiAgICBtZXNzYWdlLmJvZHkgPSBkYXRhLnN1YnN0cihib2R5U3RhcnQsIGNvbnRlbnRMZW5ndGgpOwogIH0gZWxzZSB7CiAgICBtZXNzYWdlLmJvZHkgPSBkYXRhLnN1YnN0cmluZyhib2R5U3RhcnQpOwogIH0KCiAgcmV0dXJuIG1lc3NhZ2U7Cn07CgpTSVAuUGFyc2VyID0gUGFyc2VyOwp9OwoKfSx7fV0sMjE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewoKdmFyIFJlZ2lzdGVyQ29udGV4dDsKClJlZ2lzdGVyQ29udGV4dCA9IGZ1bmN0aW9uICh1YSkgewogIHZhciBwYXJhbXMgPSB7fSwKICAgICAgcmVnSWQgPSAxOwoKICB0aGlzLnJlZ2lzdHJhciA9IHVhLmNvbmZpZ3VyYXRpb24ucmVnaXN0cmFyU2VydmVyOwogIHRoaXMuZXhwaXJlcyA9IHVhLmNvbmZpZ3VyYXRpb24ucmVnaXN0ZXJFeHBpcmVzOwoKCiAgLy8gQ29udGFjdCBoZWFkZXIKICB0aGlzLmNvbnRhY3QgPSB1YS5jb250YWN0LnRvU3RyaW5nKCk7CgogIGlmKHJlZ0lkKSB7CiAgICB0aGlzLmNvbnRhY3QgKz0gJztyZWctaWQ9JysgcmVnSWQ7CiAgICB0aGlzLmNvbnRhY3QgKz0gJzsrc2lwLmluc3RhbmNlPSI8dXJuOnV1aWQ6JysgdWEuY29uZmlndXJhdGlvbi5pbnN0YW5jZUlkKyc+Iic7CiAgfQoKICAvLyBDYWxsLUlEIGFuZCBDU2VxIHZhbHVlcyBSRkMzMjYxIDEwLjIKICB0aGlzLmNhbGxfaWQgPSBTSVAuVXRpbHMuY3JlYXRlUmFuZG9tVG9rZW4oMjIpOwogIHRoaXMuY3NlcSA9IDgwOwoKICB0aGlzLnRvX3VyaSA9IHVhLmNvbmZpZ3VyYXRpb24udXJpOwoKICBwYXJhbXMudG9fdXJpID0gdGhpcy50b191cmk7CiAgcGFyYW1zLnRvX2Rpc3BsYXlOYW1lID0gdWEuY29uZmlndXJhdGlvbi5kaXNwbGF5TmFtZTsKICBwYXJhbXMuY2FsbF9pZCA9IHRoaXMuY2FsbF9pZDsKICBwYXJhbXMuY3NlcSA9IHRoaXMuY3NlcTsKCiAgLy8gRXh0ZW5kcyBDbGllbnRDb250ZXh0CiAgU0lQLlV0aWxzLmF1Z21lbnQodGhpcywgU0lQLkNsaWVudENvbnRleHQsIFt1YSwgJ1JFR0lTVEVSJywgdGhpcy5yZWdpc3RyYXIsIHtwYXJhbXM6IHBhcmFtc31dKTsKCiAgdGhpcy5yZWdpc3RyYXRpb25UaW1lciA9IG51bGw7CiAgdGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIgPSBudWxsOwoKICAvLyBTZXQgc3RhdHVzCiAgdGhpcy5yZWdpc3RlcmVkID0gZmFsc2U7CgogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAucmVnaXN0ZXJjb250ZXh0Jyk7Cn07CgpSZWdpc3RlckNvbnRleHQucHJvdG90eXBlID0gewogIHJlZ2lzdGVyOiBmdW5jdGlvbiAob3B0aW9ucykgewogICAgdmFyIHNlbGYgPSB0aGlzLCBleHRyYUhlYWRlcnM7CgogICAgLy8gSGFuZGxlIE9wdGlvbnMKICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgICBleHRyYUhlYWRlcnMgPSAodGhpcy5vcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250YWN0OiAnICsgdGhpcy5jb250YWN0ICsgJztleHBpcmVzPScgKyB0aGlzLmV4cGlyZXMpOwogICAgZXh0cmFIZWFkZXJzLnB1c2goJ0FsbG93OiAnICsgU0lQLlVBLkMuQUxMT1dFRF9NRVRIT0RTLnRvU3RyaW5nKCkpOwoKICAgIC8vIFNhdmUgb3JpZ2luYWwgZXh0cmFIZWFkZXJzIHRvIGJlIHVzZWQgaW4gLmNsb3NlCiAgICB0aGlzLmNsb3NlSGVhZGVycyA9IHRoaXMub3B0aW9ucy5jbG9zZVdpdGhIZWFkZXJzID8KICAgICAgKHRoaXMub3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCkgOiBbXTsKCiAgICB0aGlzLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgIHZhciBjb250YWN0LCBleHBpcmVzLAogICAgICAgIGNvbnRhY3RzID0gcmVzcG9uc2UuZ2V0SGVhZGVycygnY29udGFjdCcpLmxlbmd0aCwKICAgICAgICBjYXVzZTsKCiAgICAgIC8vIERpc2NhcmQgcmVzcG9uc2VzIHRvIG9sZGVyIFJFR0lTVEVSL3VuLVJFR0lTVEVSIHJlcXVlc3RzLgogICAgICBpZihyZXNwb25zZS5jc2VxICE9PSB0aGlzLmNzZXEpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIENsZWFyIHJlZ2lzdHJhdGlvbiB0aW1lcgogICAgICBpZiAodGhpcy5yZWdpc3RyYXRpb25UaW1lciAhPT0gbnVsbCkgewogICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVnaXN0cmF0aW9uVGltZXIpOwogICAgICAgIHRoaXMucmVnaXN0cmF0aW9uVGltZXIgPSBudWxsOwogICAgICB9CgogICAgICBzd2l0Y2godHJ1ZSkgewogICAgICAgIGNhc2UgL14xWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIC9eMlswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgICB0aGlzLmVtaXQoJ2FjY2VwdGVkJywgcmVzcG9uc2UpOwoKICAgICAgICAgIGlmKHJlc3BvbnNlLmhhc0hlYWRlcignZXhwaXJlcycpKSB7CiAgICAgICAgICAgIGV4cGlyZXMgPSByZXNwb25zZS5nZXRIZWFkZXIoJ2V4cGlyZXMnKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIgIT09IG51bGwpIHsKICAgICAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIpOwogICAgICAgICAgICB0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lciA9IG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gU2VhcmNoIHRoZSBDb250YWN0IHBvaW50aW5nIHRvIHVzIGFuZCB1cGRhdGUgdGhlIGV4cGlyZXMgdmFsdWUgYWNjb3JkaW5nbHkuCiAgICAgICAgICBpZiAoIWNvbnRhY3RzKSB7CiAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ25vIENvbnRhY3QgaGVhZGVyIGluIHJlc3BvbnNlIHRvIFJFR0lTVEVSLCByZXNwb25zZSBpZ25vcmVkJyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIHdoaWxlKGNvbnRhY3RzLS0pIHsKICAgICAgICAgICAgY29udGFjdCA9IHJlc3BvbnNlLnBhcnNlSGVhZGVyKCdjb250YWN0JywgY29udGFjdHMpOwogICAgICAgICAgICBpZihjb250YWN0LnVyaS51c2VyID09PSB0aGlzLnVhLmNvbnRhY3QudXJpLnVzZXIpIHsKICAgICAgICAgICAgICBleHBpcmVzID0gY29udGFjdC5nZXRQYXJhbSgnZXhwaXJlcycpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnRhY3QgPSBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFjb250YWN0KSB7CiAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ25vIENvbnRhY3QgaGVhZGVyIHBvaW50aW5nIHRvIHVzLCByZXNwb25zZSBpZ25vcmVkJyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmKCFleHBpcmVzKSB7CiAgICAgICAgICAgIGV4cGlyZXMgPSB0aGlzLmV4cGlyZXM7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gUmUtUmVnaXN0ZXIgYmVmb3JlIHRoZSBleHBpcmF0aW9uIGludGVydmFsIGhhcyBlbGFwc2VkLgogICAgICAgICAgLy8gRm9yIHRoYXQsIGRlY3JlYXNlIHRoZSBleHBpcmVzIHZhbHVlLiBpZTogMyBzZWNvbmRzCiAgICAgICAgICB0aGlzLnJlZ2lzdHJhdGlvblRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICBzZWxmLnJlZ2lzdHJhdGlvblRpbWVyID0gbnVsbDsKICAgICAgICAgICAgc2VsZi5yZWdpc3RlcihzZWxmLm9wdGlvbnMpOwogICAgICAgICAgfSwgKGV4cGlyZXMgKiAxMDAwKSAtIDMwMDApOwogICAgICAgICAgdGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzZWxmLmxvZ2dlci53YXJuKCdyZWdpc3RyYXRpb24gZXhwaXJlZCcpOwogICAgICAgICAgICBpZiAoc2VsZi5yZWdpc3RlcmVkKSB7CiAgICAgICAgICAgICAgc2VsZi51bnJlZ2lzdGVyZWQobnVsbCwgU0lQLkMuY2F1c2VzLkVYUElSRVMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LCBleHBpcmVzICogMTAwMCk7CgogICAgICAgICAgLy9TYXZlIGdydXUgdmFsdWVzCiAgICAgICAgICBpZiAoY29udGFjdC5oYXNQYXJhbSgndGVtcC1ncnV1JykpIHsKICAgICAgICAgICAgdGhpcy51YS5jb250YWN0LnRlbXBfZ3J1dSA9IFNJUC5VUkkucGFyc2UoY29udGFjdC5nZXRQYXJhbSgndGVtcC1ncnV1JykucmVwbGFjZSgvIi9nLCcnKSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoY29udGFjdC5oYXNQYXJhbSgncHViLWdydXUnKSkgewogICAgICAgICAgICB0aGlzLnVhLmNvbnRhY3QucHViX2dydXUgPSBTSVAuVVJJLnBhcnNlKGNvbnRhY3QuZ2V0UGFyYW0oJ3B1Yi1ncnV1JykucmVwbGFjZSgvIi9nLCcnKSk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5yZWdpc3RlcmVkID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuZW1pdCgncmVnaXN0ZXJlZCcsIHJlc3BvbnNlIHx8IG51bGwpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgLy8gSW50ZXJ2YWwgdG9vIGJyaWVmIFJGQzMyNjEgMTAuMi44CiAgICAgICAgY2FzZSAvXjQyMyQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgICAgaWYocmVzcG9uc2UuaGFzSGVhZGVyKCdtaW4tZXhwaXJlcycpKSB7CiAgICAgICAgICAgIC8vIEluY3JlYXNlIG91ciByZWdpc3RyYXRpb24gaW50ZXJ2YWwgdG8gdGhlIHN1Z2dlc3RlZCBtaW5pbXVtCiAgICAgICAgICAgIHRoaXMuZXhwaXJlcyA9IHJlc3BvbnNlLmdldEhlYWRlcignbWluLWV4cGlyZXMnKTsKICAgICAgICAgICAgLy8gQXR0ZW1wdCB0aGUgcmVnaXN0cmF0aW9uIGFnYWluIGltbWVkaWF0ZWx5CiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXIodGhpcy5vcHRpb25zKTsKICAgICAgICAgIH0gZWxzZSB7IC8vVGhpcyByZXNwb25zZSBNVVNUIGNvbnRhaW4gYSBNaW4tRXhwaXJlcyBoZWFkZXIgZmllbGQKICAgICAgICAgICAgdGhpcy5sb2dnZXIud2FybignNDIzIHJlc3BvbnNlIHJlY2VpdmVkIGZvciBSRUdJU1RFUiB3aXRob3V0IE1pbi1FeHBpcmVzJyk7CiAgICAgICAgICAgIHRoaXMucmVnaXN0cmF0aW9uRmFpbHVyZShyZXNwb25zZSwgU0lQLkMuY2F1c2VzLlNJUF9GQUlMVVJFX0NPREUpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGNhdXNlID0gU0lQLlV0aWxzLnNpcEVycm9yQ2F1c2UocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOwogICAgICAgICAgdGhpcy5yZWdpc3RyYXRpb25GYWlsdXJlKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgIH0KICAgIH07CgogICAgdGhpcy5vblJlcXVlc3RUaW1lb3V0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMucmVnaXN0cmF0aW9uRmFpbHVyZShudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH07CgogICAgdGhpcy5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMucmVnaXN0cmF0aW9uRmFpbHVyZShudWxsLCBTSVAuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICB9OwoKICAgIHRoaXMuY3NlcSsrOwogICAgdGhpcy5yZXF1ZXN0LmNzZXEgPSB0aGlzLmNzZXE7CiAgICB0aGlzLnJlcXVlc3Quc2V0SGVhZGVyKCdjc2VxJywgdGhpcy5jc2VxICsgJyBSRUdJU1RFUicpOwogICAgdGhpcy5yZXF1ZXN0LmV4dHJhSGVhZGVycyA9IGV4dHJhSGVhZGVyczsKICAgIHRoaXMuc2VuZCgpOwogIH0sCgogIHJlZ2lzdHJhdGlvbkZhaWx1cmU6IGZ1bmN0aW9uIChyZXNwb25zZSwgY2F1c2UpIHsKICAgIHRoaXMuZW1pdCgnZmFpbGVkJywgcmVzcG9uc2UgfHwgbnVsbCwgY2F1c2UgfHwgbnVsbCk7CiAgfSwKCiAgb25UcmFuc3BvcnRDbG9zZWQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5yZWdpc3RlcmVkX2JlZm9yZSA9IHRoaXMucmVnaXN0ZXJlZDsKICAgIGlmICh0aGlzLnJlZ2lzdHJhdGlvblRpbWVyICE9PSBudWxsKSB7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVnaXN0cmF0aW9uVGltZXIpOwogICAgICB0aGlzLnJlZ2lzdHJhdGlvblRpbWVyID0gbnVsbDsKICAgIH0KCiAgICBpZiAodGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIgIT09IG51bGwpIHsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5yZWdpc3RyYXRpb25FeHBpcmVkVGltZXIpOwogICAgICB0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lciA9IG51bGw7CiAgICB9CgogICAgaWYodGhpcy5yZWdpc3RlcmVkKSB7CiAgICAgIHRoaXMudW5yZWdpc3RlcmVkKG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgIH0KICB9LAoKICBvblRyYW5zcG9ydENvbm5lY3RlZDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLnJlZ2lzdGVyKHRoaXMub3B0aW9ucyk7CiAgfSwKCiAgY2xvc2U6IGZ1bmN0aW9uKCkgewogICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgIGFsbDogZmFsc2UsCiAgICAgIGV4dHJhSGVhZGVyczogdGhpcy5jbG9zZUhlYWRlcnMKICAgIH07CgogICAgdGhpcy5yZWdpc3RlcmVkX2JlZm9yZSA9IHRoaXMucmVnaXN0ZXJlZDsKICAgIHRoaXMudW5yZWdpc3RlcihvcHRpb25zKTsKICB9LAoKICB1bnJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICB2YXIgZXh0cmFIZWFkZXJzOwoKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIGlmKCF0aGlzLnJlZ2lzdGVyZWQgJiYgIW9wdGlvbnMuYWxsKSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ2FscmVhZHkgdW5yZWdpc3RlcmVkJyk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBleHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCk7CgogICAgdGhpcy5yZWdpc3RlcmVkID0gZmFsc2U7CgogICAgLy8gQ2xlYXIgdGhlIHJlZ2lzdHJhdGlvbiB0aW1lci4KICAgIGlmICh0aGlzLnJlZ2lzdHJhdGlvblRpbWVyICE9PSBudWxsKSB7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVnaXN0cmF0aW9uVGltZXIpOwogICAgICB0aGlzLnJlZ2lzdHJhdGlvblRpbWVyID0gbnVsbDsKICAgIH0KCiAgICBpZihvcHRpb25zLmFsbCkgewogICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogKicpOwogICAgICBleHRyYUhlYWRlcnMucHVzaCgnRXhwaXJlczogMCcpOwogICAgfSBlbHNlIHsKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcrIHRoaXMuY29udGFjdCArICc7ZXhwaXJlcz0wJyk7CiAgICB9CgoKICAgIHRoaXMucmVjZWl2ZVJlc3BvbnNlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgdmFyIGNhdXNlOwoKICAgICAgc3dpdGNoKHRydWUpIHsKICAgICAgICBjYXNlIC9eMVswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAvXjJbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgICAgdGhpcy5lbWl0KCdhY2NlcHRlZCcsIHJlc3BvbnNlKTsKICAgICAgICAgIGlmICh0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lciAhPT0gbnVsbCkgewogICAgICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnJlZ2lzdHJhdGlvbkV4cGlyZWRUaW1lcik7CiAgICAgICAgICAgIHRoaXMucmVnaXN0cmF0aW9uRXhwaXJlZFRpbWVyID0gbnVsbDsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMudW5yZWdpc3RlcmVkKHJlc3BvbnNlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBjYXVzZSA9IFNJUC5VdGlscy5zaXBFcnJvckNhdXNlKHJlc3BvbnNlLnN0YXR1c19jb2RlKTsKICAgICAgICAgIHRoaXMudW5yZWdpc3RlcmVkKHJlc3BvbnNlLGNhdXNlKTsKICAgICAgfQogICAgfTsKCiAgICB0aGlzLm9uUmVxdWVzdFRpbWVvdXQgPSBmdW5jdGlvbigpIHsKICAgICAgLy8gTm90IGFjdHVhbGx5IHVucmVnaXN0ZXJlZC4uLgogICAgICAvL3RoaXMudW5yZWdpc3RlcmVkKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfTsKCiAgICB0aGlzLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICAgICAgLy8gTm90IGFjdHVhbGx5IHVucmVnaXN0ZXJlZC4uLgogICAgICAvL3RoaXMudW5yZWdpc3RlcmVkKG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgIH07CgogICAgdGhpcy5jc2VxKys7CiAgICB0aGlzLnJlcXVlc3QuY3NlcSA9IHRoaXMuY3NlcTsKICAgIHRoaXMucmVxdWVzdC5zZXRIZWFkZXIoJ2NzZXEnLCB0aGlzLmNzZXEgKyAnIFJFR0lTVEVSJyk7CiAgICB0aGlzLnJlcXVlc3QuZXh0cmFIZWFkZXJzID0gZXh0cmFIZWFkZXJzOwoKICAgIHRoaXMuc2VuZCgpOwogIH0sCgogIHVucmVnaXN0ZXJlZDogZnVuY3Rpb24ocmVzcG9uc2UsIGNhdXNlKSB7CiAgICB0aGlzLnJlZ2lzdGVyZWQgPSBmYWxzZTsKICAgIHRoaXMuZW1pdCgndW5yZWdpc3RlcmVkJywgcmVzcG9uc2UgfHwgbnVsbCwgY2F1c2UgfHwgbnVsbCk7CiAgfQoKfTsKCgpTSVAuUmVnaXN0ZXJDb250ZXh0ID0gUmVnaXN0ZXJDb250ZXh0Owp9OwoKfSx7fV0sMjI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7CgovKioKICogQGZpbGVvdmVydmlldyBSZXF1ZXN0IFNlbmRlcgogKi8KCi8qKgogKiBAYXVnbWVudHMgU0lQCiAqIEBjbGFzcyBDbGFzcyBjcmVhdGluZyBhIHJlcXVlc3Qgc2VuZGVyLgogKiBAcGFyYW0ge09iamVjdH0gYXBwbGljYW50CiAqIEBwYXJhbSB7U0lQLlVBfSB1YQogKi8KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoU0lQKSB7CnZhciBSZXF1ZXN0U2VuZGVyOwoKUmVxdWVzdFNlbmRlciA9IGZ1bmN0aW9uKGFwcGxpY2FudCwgdWEpIHsKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnJlcXVlc3RzZW5kZXInKTsKICB0aGlzLnVhID0gdWE7CiAgdGhpcy5hcHBsaWNhbnQgPSBhcHBsaWNhbnQ7CiAgdGhpcy5tZXRob2QgPSBhcHBsaWNhbnQucmVxdWVzdC5tZXRob2Q7CiAgdGhpcy5yZXF1ZXN0ID0gYXBwbGljYW50LnJlcXVlc3Q7CiAgdGhpcy5jcmVkZW50aWFscyA9IG51bGw7CiAgdGhpcy5jaGFsbGVuZ2VkID0gZmFsc2U7CiAgdGhpcy5zdGFsZWQgPSBmYWxzZTsKCiAgLy8gSWYgdWEgaXMgaW4gY2xvc2luZyBwcm9jZXNzIG9yIGV2ZW4gY2xvc2VkIGp1c3QgYWxsb3cgc2VuZGluZyBCeWUgYW5kIEFDSwogIGlmICh1YS5zdGF0dXMgPT09IFNJUC5VQS5DLlNUQVRVU19VU0VSX0NMT1NFRCAmJiAodGhpcy5tZXRob2QgIT09IFNJUC5DLkJZRSB8fCB0aGlzLm1ldGhvZCAhPT0gU0lQLkMuQUNLKSkgewogICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgfQp9OwoKLyoqCiogQ3JlYXRlIHRoZSBjbGllbnQgdHJhbnNhY3Rpb24gYW5kIHNlbmQgdGhlIG1lc3NhZ2UuCiovClJlcXVlc3RTZW5kZXIucHJvdG90eXBlID0gewogIHNlbmQ6IGZ1bmN0aW9uKCkgewogICAgc3dpdGNoKHRoaXMubWV0aG9kKSB7CiAgICAgIGNhc2UgIklOVklURSI6CiAgICAgICAgdGhpcy5jbGllbnRUcmFuc2FjdGlvbiA9IG5ldyBTSVAuVHJhbnNhY3Rpb25zLkludml0ZUNsaWVudFRyYW5zYWN0aW9uKHRoaXMsIHRoaXMucmVxdWVzdCwgdGhpcy51YS50cmFuc3BvcnQpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICJBQ0siOgogICAgICAgIHRoaXMuY2xpZW50VHJhbnNhY3Rpb24gPSBuZXcgU0lQLlRyYW5zYWN0aW9ucy5BY2tDbGllbnRUcmFuc2FjdGlvbih0aGlzLCB0aGlzLnJlcXVlc3QsIHRoaXMudWEudHJhbnNwb3J0KTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICB0aGlzLmNsaWVudFRyYW5zYWN0aW9uID0gbmV3IFNJUC5UcmFuc2FjdGlvbnMuTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24odGhpcywgdGhpcy5yZXF1ZXN0LCB0aGlzLnVhLnRyYW5zcG9ydCk7CiAgICB9CiAgICB0aGlzLmNsaWVudFRyYW5zYWN0aW9uLnNlbmQoKTsKCiAgICByZXR1cm4gdGhpcy5jbGllbnRUcmFuc2FjdGlvbjsKICB9LAoKICAvKioKICAqIENhbGxiYWNrIGZpcmVkIHdoZW4gcmVjZWl2aW5nIGEgcmVxdWVzdCB0aW1lb3V0IGVycm9yIGZyb20gdGhlIGNsaWVudCB0cmFuc2FjdGlvbi4KICAqIFRvIGJlIHJlLWRlZmluZWQgYnkgdGhlIGFwcGxpY2FudC4KICAqIEBldmVudAogICovCiAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmFwcGxpY2FudC5vblJlcXVlc3RUaW1lb3V0KCk7CiAgfSwKCiAgLyoqCiAgKiBDYWxsYmFjayBmaXJlZCB3aGVuIHJlY2VpdmluZyBhIHRyYW5zcG9ydCBlcnJvciBmcm9tIHRoZSBjbGllbnQgdHJhbnNhY3Rpb24uCiAgKiBUbyBiZSByZS1kZWZpbmVkIGJ5IHRoZSBhcHBsaWNhbnQuCiAgKiBAZXZlbnQKICAqLwogIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5hcHBsaWNhbnQub25UcmFuc3BvcnRFcnJvcigpOwogIH0sCgogIC8qKgogICogQ2FsbGVkIGZyb20gY2xpZW50IHRyYW5zYWN0aW9uIHdoZW4gcmVjZWl2aW5nIGEgY29ycmVjdCByZXNwb25zZSB0byB0aGUgcmVxdWVzdC4KICAqIEF1dGhlbnRpY2F0ZSByZXF1ZXN0IGlmIG5lZWRlZCBvciBwYXNzIHRoZSByZXNwb25zZSBiYWNrIHRvIHRoZSBhcHBsaWNhbnQuCiAgKiBAcGFyYW0ge1NJUC5JbmNvbWluZ1Jlc3BvbnNlfSByZXNwb25zZQogICovCiAgcmVjZWl2ZVJlc3BvbnNlOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgdmFyIGNzZXEsIGNoYWxsZW5nZSwgYXV0aG9yaXphdGlvbl9oZWFkZXJfbmFtZSwKICAgICAgc3RhdHVzX2NvZGUgPSByZXNwb25zZS5zdGF0dXNfY29kZTsKCiAgICAvKgogICAgKiBBdXRoZW50aWNhdGlvbgogICAgKiBBdXRoZW50aWNhdGUgb25jZS4gX2NoYWxsZW5nZWRfIGZsYWcgdXNlZCB0byBhdm9pZCBpbmZpbml0ZSBhdXRoZW50aWNhdGlvbnMuCiAgICAqLwogICAgaWYgKHN0YXR1c19jb2RlID09PSA0MDEgfHwgc3RhdHVzX2NvZGUgPT09IDQwNykgewoKICAgICAgLy8gR2V0IGFuZCBwYXJzZSB0aGUgYXBwcm9wcmlhdGUgV1dXLUF1dGhlbnRpY2F0ZSBvciBQcm94eS1BdXRoZW50aWNhdGUgaGVhZGVyLgogICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT09IDQwMSkgewogICAgICAgIGNoYWxsZW5nZSA9IHJlc3BvbnNlLnBhcnNlSGVhZGVyKCd3d3ctYXV0aGVudGljYXRlJyk7CiAgICAgICAgYXV0aG9yaXphdGlvbl9oZWFkZXJfbmFtZSA9ICdhdXRob3JpemF0aW9uJzsKICAgICAgfSBlbHNlIHsKICAgICAgICBjaGFsbGVuZ2UgPSByZXNwb25zZS5wYXJzZUhlYWRlcigncHJveHktYXV0aGVudGljYXRlJyk7CiAgICAgICAgYXV0aG9yaXphdGlvbl9oZWFkZXJfbmFtZSA9ICdwcm94eS1hdXRob3JpemF0aW9uJzsKICAgICAgfQoKICAgICAgLy8gVmVyaWZ5IGl0IHNlZW1zIGEgdmFsaWQgY2hhbGxlbmdlLgogICAgICBpZiAoISBjaGFsbGVuZ2UpIHsKICAgICAgICB0aGlzLmxvZ2dlci53YXJuKHJlc3BvbnNlLnN0YXR1c19jb2RlICsgJyB3aXRoIHdyb25nIG9yIG1pc3NpbmcgY2hhbGxlbmdlLCBjYW5ub3QgYXV0aGVudGljYXRlJyk7CiAgICAgICAgdGhpcy5hcHBsaWNhbnQucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5jaGFsbGVuZ2VkIHx8ICghdGhpcy5zdGFsZWQgJiYgY2hhbGxlbmdlLnN0YWxlID09PSB0cnVlKSkgewogICAgICAgIGlmICghdGhpcy5jcmVkZW50aWFscykgewogICAgICAgICAgdGhpcy5jcmVkZW50aWFscyA9IHRoaXMudWEuY29uZmlndXJhdGlvbi5hdXRoZW50aWNhdGlvbkZhY3RvcnkodGhpcy51YSk7CiAgICAgICAgfQoKICAgICAgICAvLyBWZXJpZnkgdGhhdCB0aGUgY2hhbGxlbmdlIGlzIHJlYWxseSB2YWxpZC4KICAgICAgICBpZiAoIXRoaXMuY3JlZGVudGlhbHMuYXV0aGVudGljYXRlKHRoaXMucmVxdWVzdCwgY2hhbGxlbmdlKSkgewogICAgICAgICAgdGhpcy5hcHBsaWNhbnQucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5jaGFsbGVuZ2VkID0gdHJ1ZTsKCiAgICAgICAgaWYgKGNoYWxsZW5nZS5zdGFsZSkgewogICAgICAgICAgdGhpcy5zdGFsZWQgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHJlc3BvbnNlLm1ldGhvZCA9PT0gU0lQLkMuUkVHSVNURVIpIHsKICAgICAgICAgIGNzZXEgPSB0aGlzLmFwcGxpY2FudC5jc2VxICs9IDE7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJlcXVlc3QuZGlhbG9nKXsKICAgICAgICAgIGNzZXEgPSB0aGlzLnJlcXVlc3QuZGlhbG9nLmxvY2FsX3NlcW51bSArPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjc2VxID0gdGhpcy5yZXF1ZXN0LmNzZXEgKyAxOwogICAgICAgICAgdGhpcy5yZXF1ZXN0LmNzZXEgPSBjc2VxOwogICAgICAgIH0KICAgICAgICB0aGlzLnJlcXVlc3Quc2V0SGVhZGVyKCdjc2VxJywgY3NlcSArJyAnKyB0aGlzLm1ldGhvZCk7CgogICAgICAgIHRoaXMucmVxdWVzdC5zZXRIZWFkZXIoYXV0aG9yaXphdGlvbl9oZWFkZXJfbmFtZSwgdGhpcy5jcmVkZW50aWFscy50b1N0cmluZygpKTsKICAgICAgICB0aGlzLnNlbmQoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmFwcGxpY2FudC5yZWNlaXZlUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLmFwcGxpY2FudC5yZWNlaXZlUmVzcG9uc2UocmVzcG9uc2UpOwogICAgfQogIH0KfTsKClNJUC5SZXF1ZXN0U2VuZGVyID0gUmVxdWVzdFNlbmRlcjsKfTsKCn0se31dLDIzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLyoqCiAqIEBuYW1lIFNJUAogKiBAbmFtZXNwYWNlCiAqLwoidXNlIHN0cmljdCI7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChlbnZpcm9ubWVudCkgewoKdmFyIHBrZyA9IHJlcXVpcmUoJy4uL3BhY2thZ2UuanNvbicpOwoKdmFyIFNJUCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHt9LCB7CiAgdmVyc2lvbjogewogICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gcGtnLnZlcnNpb247IH0KICB9LAogIG5hbWU6IHsKICAgIGdldDogZnVuY3Rpb24oKXsgcmV0dXJuIHBrZy50aXRsZTsgfQogIH0KfSk7CgpyZXF1aXJlKCcuL1V0aWxzJykoU0lQLCBlbnZpcm9ubWVudCk7ClNJUC5Mb2dnZXJGYWN0b3J5ID0gcmVxdWlyZSgnLi9Mb2dnZXJGYWN0b3J5JykoZW52aXJvbm1lbnQuY29uc29sZSk7ClNJUC5FdmVudEVtaXR0ZXIgPSByZXF1aXJlKCcuL0V2ZW50RW1pdHRlcicpKGVudmlyb25tZW50LmNvbnNvbGUpOwpTSVAuQyA9IHJlcXVpcmUoJy4vQ29uc3RhbnRzJykoU0lQLm5hbWUsIFNJUC52ZXJzaW9uKTsKU0lQLkV4Y2VwdGlvbnMgPSByZXF1aXJlKCcuL0V4Y2VwdGlvbnMnKTsKU0lQLlRpbWVycyA9IHJlcXVpcmUoJy4vVGltZXJzJykoZW52aXJvbm1lbnQudGltZXJzKTsKU0lQLlRyYW5zcG9ydCA9IGVudmlyb25tZW50LlRyYW5zcG9ydChTSVAsIGVudmlyb25tZW50LldlYlNvY2tldCk7CnJlcXVpcmUoJy4vUGFyc2VyJykoU0lQKTsKcmVxdWlyZSgnLi9TSVBNZXNzYWdlJykoU0lQKTsKcmVxdWlyZSgnLi9VUkknKShTSVApOwpyZXF1aXJlKCcuL05hbWVBZGRySGVhZGVyJykoU0lQKTsKcmVxdWlyZSgnLi9UcmFuc2FjdGlvbnMnKShTSVApOwpyZXF1aXJlKCcuL0RpYWxvZ3MnKShTSVApOwpyZXF1aXJlKCcuL1JlcXVlc3RTZW5kZXInKShTSVApOwpyZXF1aXJlKCcuL1JlZ2lzdGVyQ29udGV4dCcpKFNJUCk7ClNJUC5NZWRpYUhhbmRsZXIgPSByZXF1aXJlKCcuL01lZGlhSGFuZGxlcicpKFNJUC5FdmVudEVtaXR0ZXIpOwpyZXF1aXJlKCcuL0NsaWVudENvbnRleHQnKShTSVApOwpyZXF1aXJlKCcuL1NlcnZlckNvbnRleHQnKShTSVApOwpyZXF1aXJlKCcuL1Nlc3Npb24nKShTSVAsIGVudmlyb25tZW50KTsKcmVxdWlyZSgnLi9TdWJzY3JpcHRpb24nKShTSVApOwpTSVAuV2ViUlRDID0gcmVxdWlyZSgnLi9XZWJSVEMnKShTSVAsIGVudmlyb25tZW50KTsKcmVxdWlyZSgnLi9VQScpKFNJUCwgZW52aXJvbm1lbnQpOwpTSVAuSGFja3MgPSByZXF1aXJlKCcuL0hhY2tzJykoU0lQKTsKcmVxdWlyZSgnLi9TYW5pdHlDaGVjaycpKFNJUCk7ClNJUC5EaWdlc3RBdXRoZW50aWNhdGlvbiA9IHJlcXVpcmUoJy4vRGlnZXN0QXV0aGVudGljYXRpb24nKShTSVAuVXRpbHMpOwpTSVAuR3JhbW1hciA9IHJlcXVpcmUoJy4vR3JhbW1hcicpKFNJUCk7CgpyZXR1cm4gU0lQOwp9OwoKfSx7Ii4uL3BhY2thZ2UuanNvbiI6NiwiLi9DbGllbnRDb250ZXh0Ijo3LCIuL0NvbnN0YW50cyI6OCwiLi9EaWFsb2dzIjoxMCwiLi9EaWdlc3RBdXRoZW50aWNhdGlvbiI6MTEsIi4vRXZlbnRFbWl0dGVyIjoxMiwiLi9FeGNlcHRpb25zIjoxMywiLi9HcmFtbWFyIjoxNCwiLi9IYWNrcyI6MTYsIi4vTG9nZ2VyRmFjdG9yeSI6MTcsIi4vTWVkaWFIYW5kbGVyIjoxOCwiLi9OYW1lQWRkckhlYWRlciI6MTksIi4vUGFyc2VyIjoyMCwiLi9SZWdpc3RlckNvbnRleHQiOjIxLCIuL1JlcXVlc3RTZW5kZXIiOjIyLCIuL1NJUE1lc3NhZ2UiOjI0LCIuL1Nhbml0eUNoZWNrIjoyNSwiLi9TZXJ2ZXJDb250ZXh0IjoyNiwiLi9TZXNzaW9uIjoyNywiLi9TdWJzY3JpcHRpb24iOjI5LCIuL1RpbWVycyI6MzAsIi4vVHJhbnNhY3Rpb25zIjozMSwiLi9VQSI6MzMsIi4vVVJJIjozNCwiLi9VdGlscyI6MzUsIi4vV2ViUlRDIjozNn1dLDI0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBTSVAgTWVzc2FnZQogKi8KCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewp2YXIKICBPdXRnb2luZ1JlcXVlc3QsCiAgSW5jb21pbmdNZXNzYWdlLAogIEluY29taW5nUmVxdWVzdCwKICBJbmNvbWluZ1Jlc3BvbnNlOwoKZnVuY3Rpb24gZ2V0U3VwcG9ydGVkSGVhZGVyIChyZXF1ZXN0KSB7CiAgdmFyIGFsbG93VW5yZWdpc3RlcmVkID0gcmVxdWVzdC51YS5jb25maWd1cmF0aW9uLmhhY2tBbGxvd1VucmVnaXN0ZXJlZE9wdGlvblRhZ3M7CiAgdmFyIG9wdGlvblRhZ3MgPSBbXTsKICB2YXIgb3B0aW9uVGFnU2V0ID0ge307CgogIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gU0lQLkMuUkVHSVNURVIpIHsKICAgIG9wdGlvblRhZ3MucHVzaCgncGF0aCcsICdncnV1Jyk7CiAgfSBlbHNlIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gU0lQLkMuSU5WSVRFICYmCiAgICAgICAgICAgICAocmVxdWVzdC51YS5jb250YWN0LnB1Yl9ncnV1IHx8IHJlcXVlc3QudWEuY29udGFjdC50ZW1wX2dydXUpKSB7CiAgICBvcHRpb25UYWdzLnB1c2goJ2dydXUnKTsKICB9CgogIGlmIChyZXF1ZXN0LnVhLmNvbmZpZ3VyYXRpb24ucmVsMTAwID09PSBTSVAuQy5zdXBwb3J0ZWQuU1VQUE9SVEVEKSB7CiAgICBvcHRpb25UYWdzLnB1c2goJzEwMHJlbCcpOwogIH0KICBpZiAocmVxdWVzdC51YS5jb25maWd1cmF0aW9uLnJlcGxhY2VzID09PSBTSVAuQy5zdXBwb3J0ZWQuU1VQUE9SVEVEKSB7CiAgICBvcHRpb25UYWdzLnB1c2goJ3JlcGxhY2VzJyk7CiAgfQoKICBvcHRpb25UYWdzLnB1c2goJ291dGJvdW5kJyk7CgogIG9wdGlvblRhZ3MgPSBvcHRpb25UYWdzLmNvbmNhdChyZXF1ZXN0LnVhLmNvbmZpZ3VyYXRpb24uZXh0cmFTdXBwb3J0ZWQpOwoKICBvcHRpb25UYWdzID0gb3B0aW9uVGFncy5maWx0ZXIoZnVuY3Rpb24ob3B0aW9uVGFnKSB7CiAgICB2YXIgcmVnaXN0ZXJlZCA9IFNJUC5DLk9QVElPTl9UQUdTW29wdGlvblRhZ107CiAgICB2YXIgdW5pcXVlID0gIW9wdGlvblRhZ1NldFtvcHRpb25UYWddOwogICAgb3B0aW9uVGFnU2V0W29wdGlvblRhZ10gPSB0cnVlOwogICAgcmV0dXJuIChyZWdpc3RlcmVkIHx8IGFsbG93VW5yZWdpc3RlcmVkKSAmJiB1bmlxdWU7CiAgfSk7CgogIHJldHVybiAnU3VwcG9ydGVkOiAnICsgb3B0aW9uVGFncy5qb2luKCcsICcpICsgJ1xyXG4nOwp9CgovKioKICogQGF1Z21lbnRzIFNJUAogKiBAY2xhc3MgQ2xhc3MgZm9yIG91dGdvaW5nIFNJUCByZXF1ZXN0LgogKiBAcGFyYW0ge1N0cmluZ30gbWV0aG9kIHJlcXVlc3QgbWV0aG9kCiAqIEBwYXJhbSB7U3RyaW5nfSBydXJpIHJlcXVlc3QgdXJpCiAqIEBwYXJhbSB7U0lQLlVBfSB1YQogKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zIHBhcmFtZXRlcnMgdGhhdCB3aWxsIGhhdmUgcHJpb3JpdHkgb3ZlciB1YS5jb25maWd1cmF0aW9uIHBhcmFtZXRlcnM6CiAqIDxicj4KICogIC0gY3NlcSwgY2FsbF9pZCwgZnJvbV90YWcsIGZyb21fdXJpLCBmcm9tX2Rpc3BsYXlOYW1lLCB0b191cmksIHRvX3RhZywgcm91dGVfc2V0CiAqIEBwYXJhbSB7T2JqZWN0fSBbaGVhZGVyc10gZXh0cmEgaGVhZGVycwogKiBAcGFyYW0ge1N0cmluZ30gW2JvZHldCiAqLwpPdXRnb2luZ1JlcXVlc3QgPSBmdW5jdGlvbihtZXRob2QsIHJ1cmksIHVhLCBwYXJhbXMsIGV4dHJhSGVhZGVycywgYm9keSkgewogIHZhcgogICAgdG8sCiAgICBmcm9tLAogICAgY2FsbF9pZCwKICAgIGNzZXEsCiAgICB0b191cmksCiAgICBmcm9tX3VyaTsKCiAgcGFyYW1zID0gcGFyYW1zIHx8IHt9OwoKICAvLyBNYW5kYXRvcnkgcGFyYW1ldGVycyBjaGVjawogIGlmKCFtZXRob2QgfHwgIXJ1cmkgfHwgIXVhKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAuc2lwbWVzc2FnZScpOwogIHRoaXMudWEgPSB1YTsKICB0aGlzLmhlYWRlcnMgPSB7fTsKICB0aGlzLm1ldGhvZCA9IG1ldGhvZDsKICB0aGlzLnJ1cmkgPSBydXJpOwogIHRoaXMuYm9keSA9IGJvZHk7CiAgdGhpcy5leHRyYUhlYWRlcnMgPSAoZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpOwogIHRoaXMuc3RhdHVzQ29kZSA9IHBhcmFtcy5zdGF0dXNfY29kZTsKICB0aGlzLnJlYXNvblBocmFzZSA9IHBhcmFtcy5yZWFzb25fcGhyYXNlOwoKICAvLyBGaWxsIHRoZSBDb21tb24gU0lQIFJlcXVlc3QgSGVhZGVycwoKICAvLyBSb3V0ZQogIGlmIChwYXJhbXMucm91dGVfc2V0KSB7CiAgICB0aGlzLnNldEhlYWRlcigncm91dGUnLCBwYXJhbXMucm91dGVfc2V0KTsKICB9IGVsc2UgaWYgKHVhLmNvbmZpZ3VyYXRpb24udXNlUHJlbG9hZGVkUm91dGUpewogICAgdGhpcy5zZXRIZWFkZXIoJ3JvdXRlJywgdWEudHJhbnNwb3J0LnNlcnZlci5zaXBfdXJpKTsKICB9CgogIC8vIFZpYQogIC8vIEVtcHR5IFZpYSBoZWFkZXIuIFdpbGwgYmUgZmlsbGVkIGJ5IHRoZSBjbGllbnQgdHJhbnNhY3Rpb24uCiAgdGhpcy5zZXRIZWFkZXIoJ3ZpYScsICcnKTsKCiAgLy8gTWF4LUZvcndhcmRzCiAgdGhpcy5zZXRIZWFkZXIoJ21heC1mb3J3YXJkcycsIFNJUC5VQS5DLk1BWF9GT1JXQVJEUyk7CgogIC8vIFRvCiAgdG9fdXJpID0gcGFyYW1zLnRvX3VyaSB8fCBydXJpOwogIHRvID0gKHBhcmFtcy50b19kaXNwbGF5TmFtZSB8fCBwYXJhbXMudG9fZGlzcGxheU5hbWUgPT09IDApID8gJyInICsgcGFyYW1zLnRvX2Rpc3BsYXlOYW1lICsgJyIgJyA6ICcnOwogIHRvICs9ICc8JyArICh0b191cmkgJiYgdG9fdXJpLnRvUmF3ID8gdG9fdXJpLnRvUmF3KCkgOiB0b191cmkpICsgJz4nOwogIHRvICs9IHBhcmFtcy50b190YWcgPyAnO3RhZz0nICsgcGFyYW1zLnRvX3RhZyA6ICcnOwogIHRoaXMudG8gPSBuZXcgU0lQLk5hbWVBZGRySGVhZGVyLnBhcnNlKHRvKTsKICB0aGlzLnNldEhlYWRlcigndG8nLCB0byk7CgogIC8vIEZyb20KICBmcm9tX3VyaSA9IHBhcmFtcy5mcm9tX3VyaSB8fCB1YS5jb25maWd1cmF0aW9uLnVyaTsKICBpZiAocGFyYW1zLmZyb21fZGlzcGxheU5hbWUgfHwgcGFyYW1zLmZyb21fZGlzcGxheU5hbWUgPT09IDApIHsKICAgIGZyb20gPSAnIicgKyBwYXJhbXMuZnJvbV9kaXNwbGF5TmFtZSArICciICc7CiAgfSBlbHNlIGlmICh1YS5jb25maWd1cmF0aW9uLmRpc3BsYXlOYW1lKSB7CiAgICBmcm9tID0gJyInICsgdWEuY29uZmlndXJhdGlvbi5kaXNwbGF5TmFtZSArICciICc7CiAgfSBlbHNlIHsKICAgIGZyb20gPSAnJzsKICB9CiAgZnJvbSArPSAnPCcgKyAoZnJvbV91cmkgJiYgZnJvbV91cmkudG9SYXcgPyBmcm9tX3VyaS50b1JhdygpIDogZnJvbV91cmkpICsgJz47dGFnPSc7CiAgZnJvbSArPSBwYXJhbXMuZnJvbV90YWcgfHwgU0lQLlV0aWxzLm5ld1RhZygpOwogIHRoaXMuZnJvbSA9IG5ldyBTSVAuTmFtZUFkZHJIZWFkZXIucGFyc2UoZnJvbSk7CiAgdGhpcy5zZXRIZWFkZXIoJ2Zyb20nLCBmcm9tKTsKCiAgLy8gQ2FsbC1JRAogIGNhbGxfaWQgPSBwYXJhbXMuY2FsbF9pZCB8fCAodWEuY29uZmlndXJhdGlvbi5zaXBqc0lkICsgU0lQLlV0aWxzLmNyZWF0ZVJhbmRvbVRva2VuKDE1KSk7CiAgdGhpcy5jYWxsX2lkID0gY2FsbF9pZDsKICB0aGlzLnNldEhlYWRlcignY2FsbC1pZCcsIGNhbGxfaWQpOwoKICAvLyBDU2VxCiAgY3NlcSA9IHBhcmFtcy5jc2VxIHx8IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKTsKICB0aGlzLmNzZXEgPSBjc2VxOwogIHRoaXMuc2V0SGVhZGVyKCdjc2VxJywgY3NlcSArICcgJyArIG1ldGhvZCk7Cn07CgpPdXRnb2luZ1JlcXVlc3QucHJvdG90eXBlID0gewogIC8qKgogICAqIFJlcGxhY2UgdGhlIHRoZSBnaXZlbiBoZWFkZXIgYnkgdGhlIGdpdmVuIHZhbHVlLgogICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIGhlYWRlciBuYW1lCiAgICogQHBhcmFtIHtTdHJpbmcgfCBBcnJheX0gdmFsdWUgaGVhZGVyIHZhbHVlCiAgICovCiAgc2V0SGVhZGVyOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgdGhpcy5oZWFkZXJzW1NJUC5VdGlscy5oZWFkZXJpemUobmFtZSldID0gKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpID8gdmFsdWUgOiBbdmFsdWVdOwogIH0sCgogIC8qKgogICAqIEdldCB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGhlYWRlciBuYW1lIGF0IHRoZSBnaXZlbiBwb3NpdGlvbi4KICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICAqIEByZXR1cm5zIHtTdHJpbmd8dW5kZWZpbmVkfSBSZXR1cm5zIHRoZSBzcGVjaWZpZWQgaGVhZGVyLCB1bmRlZmluZWQgaWYgaGVhZGVyIGRvZXNuJ3QgZXhpc3QuCiAgICovCiAgZ2V0SGVhZGVyOiBmdW5jdGlvbihuYW1lKSB7CiAgICB2YXIgcmVnZXhwLCBpZHgsCiAgICAgIGxlbmd0aCA9IHRoaXMuZXh0cmFIZWFkZXJzLmxlbmd0aCwKICAgICAgaGVhZGVyID0gdGhpcy5oZWFkZXJzW1NJUC5VdGlscy5oZWFkZXJpemUobmFtZSldOwoKICAgIGlmKGhlYWRlcikgewogICAgICBpZihoZWFkZXJbMF0pIHsKICAgICAgICByZXR1cm4gaGVhZGVyWzBdOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICByZWdleHAgPSBuZXcgUmVnRXhwKCdeXFxzKicgKyBuYW1lICsgJ1xccyo6JywnaScpOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBoZWFkZXIgPSB0aGlzLmV4dHJhSGVhZGVyc1tpZHhdOwogICAgICAgIGlmIChyZWdleHAudGVzdChoZWFkZXIpKSB7CiAgICAgICAgICByZXR1cm4gaGVhZGVyLnN1YnN0cmluZyhoZWFkZXIuaW5kZXhPZignOicpKzEpLnRyaW0oKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm47CiAgfSwKCiAgLyoqCiAgICogR2V0IHRoZSBoZWFkZXIvcyBvZiB0aGUgZ2l2ZW4gbmFtZS4KICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICAqIEByZXR1cm5zIHtBcnJheX0gQXJyYXkgd2l0aCBhbGwgdGhlIGhlYWRlcnMgb2YgdGhlIHNwZWNpZmllZCBuYW1lLgogICAqLwogIGdldEhlYWRlcnM6IGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciBpZHgsIGxlbmd0aCwgcmVnZXhwLAogICAgICBoZWFkZXIgPSB0aGlzLmhlYWRlcnNbU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKV0sCiAgICAgIHJlc3VsdCA9IFtdOwoKICAgIGlmKGhlYWRlcikgewogICAgICBsZW5ndGggPSBoZWFkZXIubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICByZXN1bHQucHVzaChoZWFkZXJbaWR4XSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0gZWxzZSB7CiAgICAgIGxlbmd0aCA9IHRoaXMuZXh0cmFIZWFkZXJzLmxlbmd0aDsKICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cCgnXlxccyonICsgbmFtZSArICdcXHMqOicsJ2knKTsKICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgaGVhZGVyID0gdGhpcy5leHRyYUhlYWRlcnNbaWR4XTsKICAgICAgICBpZiAocmVnZXhwLnRlc3QoaGVhZGVyKSkgewogICAgICAgICAgcmVzdWx0LnB1c2goaGVhZGVyLnN1YnN0cmluZyhoZWFkZXIuaW5kZXhPZignOicpKzEpLnRyaW0oKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogVmVyaWZ5IHRoZSBleGlzdGVuY2Ugb2YgdGhlIGdpdmVuIGhlYWRlci4KICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlmIGhlYWRlciB3aXRoIGdpdmVuIG5hbWUgZXhpc3RzLCBmYWxzZSBvdGhlcndpc2UKICAgKi8KICBoYXNIZWFkZXI6IGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciByZWdleHAsIGlkeCwKICAgICAgbGVuZ3RoID0gdGhpcy5leHRyYUhlYWRlcnMubGVuZ3RoOwoKICAgIGlmICh0aGlzLmhlYWRlcnNbU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKV0pIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICByZWdleHAgPSBuZXcgUmVnRXhwKCdeXFxzKicgKyBuYW1lICsgJ1xccyo6JywnaScpOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBpZiAocmVnZXhwLnRlc3QodGhpcy5leHRyYUhlYWRlcnNbaWR4XSkpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9LAoKICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICB2YXIgbXNnID0gJycsIGhlYWRlciwgbGVuZ3RoLCBpZHg7CgogICAgbXNnICs9IHRoaXMubWV0aG9kICsgJyAnICsgKHRoaXMucnVyaS50b1JhdyA/IHRoaXMucnVyaS50b1JhdygpIDogdGhpcy5ydXJpKSArICcgU0lQLzIuMFxyXG4nOwoKICAgIGZvciAoaGVhZGVyIGluIHRoaXMuaGVhZGVycykgewogICAgICBsZW5ndGggPSB0aGlzLmhlYWRlcnNbaGVhZGVyXS5sZW5ndGg7CiAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICAgIG1zZyArPSBoZWFkZXIgKyAnOiAnICsgdGhpcy5oZWFkZXJzW2hlYWRlcl1baWR4XSArICdcclxuJzsKICAgICAgfQogICAgfQoKICAgIGxlbmd0aCA9IHRoaXMuZXh0cmFIZWFkZXJzLmxlbmd0aDsKICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICBtc2cgKz0gdGhpcy5leHRyYUhlYWRlcnNbaWR4XS50cmltKCkgKydcclxuJzsKICAgIH0KCiAgICBtc2cgKz0gZ2V0U3VwcG9ydGVkSGVhZGVyKHRoaXMpOwogICAgbXNnICs9ICdVc2VyLUFnZW50OiAnICsgdGhpcy51YS5jb25maWd1cmF0aW9uLnVzZXJBZ2VudFN0cmluZyArJ1xyXG4nOwoKICAgIGlmKHRoaXMuYm9keSkgewogICAgICBsZW5ndGggPSBTSVAuVXRpbHMuc3RyX3V0ZjhfbGVuZ3RoKHRoaXMuYm9keSk7CiAgICAgIG1zZyArPSAnQ29udGVudC1MZW5ndGg6ICcgKyBsZW5ndGggKyAnXHJcblxyXG4nOwogICAgICBtc2cgKz0gdGhpcy5ib2R5OwogICAgfSBlbHNlIHsKICAgICAgbXNnICs9ICdDb250ZW50LUxlbmd0aDogMFxyXG5cclxuJzsKICAgIH0KCiAgICByZXR1cm4gbXNnOwogIH0KfTsKCi8qKgogKiBAYXVnbWVudHMgU0lQCiAqIEBjbGFzcyBDbGFzcyBmb3IgaW5jb21pbmcgU0lQIG1lc3NhZ2UuCiAqLwpJbmNvbWluZ01lc3NhZ2UgPSBmdW5jdGlvbigpewogIHRoaXMuZGF0YSA9IG51bGw7CiAgdGhpcy5oZWFkZXJzID0gbnVsbDsKICB0aGlzLm1ldGhvZCA9ICBudWxsOwogIHRoaXMudmlhID0gbnVsbDsKICB0aGlzLnZpYV9icmFuY2ggPSBudWxsOwogIHRoaXMuY2FsbF9pZCA9IG51bGw7CiAgdGhpcy5jc2VxID0gbnVsbDsKICB0aGlzLmZyb20gPSBudWxsOwogIHRoaXMuZnJvbV90YWcgPSBudWxsOwogIHRoaXMudG8gPSBudWxsOwogIHRoaXMudG9fdGFnID0gbnVsbDsKICB0aGlzLmJvZHkgPSBudWxsOwp9OwoKSW5jb21pbmdNZXNzYWdlLnByb3RvdHlwZSA9IHsKICAvKioKICAqIEluc2VydCBhIGhlYWRlciBvZiB0aGUgZ2l2ZW4gbmFtZSBhbmQgdmFsdWUgaW50byB0aGUgbGFzdCBwb3NpdGlvbiBvZiB0aGUKICAqIGhlYWRlciBhcnJheS4KICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIGhlYWRlciBuYW1lCiAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWUgaGVhZGVyIHZhbHVlCiAgKi8KICBhZGRIZWFkZXI6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7CiAgICB2YXIgaGVhZGVyID0geyByYXc6IHZhbHVlIH07CgogICAgbmFtZSA9IFNJUC5VdGlscy5oZWFkZXJpemUobmFtZSk7CgogICAgaWYodGhpcy5oZWFkZXJzW25hbWVdKSB7CiAgICAgIHRoaXMuaGVhZGVyc1tuYW1lXS5wdXNoKGhlYWRlcik7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmhlYWRlcnNbbmFtZV0gPSBbaGVhZGVyXTsKICAgIH0KICB9LAoKICAvKioKICAgKiBHZXQgdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBoZWFkZXIgbmFtZSBhdCB0aGUgZ2l2ZW4gcG9zaXRpb24uCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgaGVhZGVyIG5hbWUKICAgKiBAcmV0dXJucyB7U3RyaW5nfHVuZGVmaW5lZH0gUmV0dXJucyB0aGUgc3BlY2lmaWVkIGhlYWRlciwgbnVsbCBpZiBoZWFkZXIgZG9lc24ndCBleGlzdC4KICAgKi8KICBnZXRIZWFkZXI6IGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciBoZWFkZXIgPSB0aGlzLmhlYWRlcnNbU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKV07CgogICAgaWYoaGVhZGVyKSB7CiAgICAgIGlmKGhlYWRlclswXSkgewogICAgICAgIHJldHVybiBoZWFkZXJbMF0ucmF3OwogICAgICB9CiAgICB9IGVsc2UgewogICAgICByZXR1cm47CiAgICB9CiAgfSwKCiAgLyoqCiAgICogR2V0IHRoZSBoZWFkZXIvcyBvZiB0aGUgZ2l2ZW4gbmFtZS4KICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBoZWFkZXIgbmFtZQogICAqIEByZXR1cm5zIHtBcnJheX0gQXJyYXkgd2l0aCBhbGwgdGhlIGhlYWRlcnMgb2YgdGhlIHNwZWNpZmllZCBuYW1lLgogICAqLwogIGdldEhlYWRlcnM6IGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciBpZHgsIGxlbmd0aCwKICAgICAgaGVhZGVyID0gdGhpcy5oZWFkZXJzW1NJUC5VdGlscy5oZWFkZXJpemUobmFtZSldLAogICAgICByZXN1bHQgPSBbXTsKCiAgICBpZighaGVhZGVyKSB7CiAgICAgIHJldHVybiBbXTsKICAgIH0KCiAgICBsZW5ndGggPSBoZWFkZXIubGVuZ3RoOwogICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgIHJlc3VsdC5wdXNoKGhlYWRlcltpZHhdLnJhdyk7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9LAoKICAvKioKICAgKiBWZXJpZnkgdGhlIGV4aXN0ZW5jZSBvZiB0aGUgZ2l2ZW4gaGVhZGVyLgogICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIGhlYWRlciBuYW1lCiAgICogQHJldHVybnMge2Jvb2xlYW59IHRydWUgaWYgaGVhZGVyIHdpdGggZ2l2ZW4gbmFtZSBleGlzdHMsIGZhbHNlIG90aGVyd2lzZQogICAqLwogIGhhc0hlYWRlcjogZnVuY3Rpb24obmFtZSkgewogICAgcmV0dXJuKHRoaXMuaGVhZGVyc1tTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpXSkgPyB0cnVlIDogZmFsc2U7CiAgfSwKCiAgLyoqCiAgKiBQYXJzZSB0aGUgZ2l2ZW4gaGVhZGVyIG9uIHRoZSBnaXZlbiBpbmRleC4KICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIGhlYWRlciBuYW1lCiAgKiBAcGFyYW0ge051bWJlcn0gW2lkeD0wXSBoZWFkZXIgaW5kZXgKICAqIEByZXR1cm5zIHtPYmplY3R8dW5kZWZpbmVkfSBQYXJzZWQgaGVhZGVyIG9iamVjdCwgdW5kZWZpbmVkIGlmIHRoZSBoZWFkZXIgaXMgbm90IHByZXNlbnQgb3IgaW4gY2FzZSBvZiBhIHBhcnNpbmcgZXJyb3IuCiAgKi8KICBwYXJzZUhlYWRlcjogZnVuY3Rpb24obmFtZSwgaWR4KSB7CiAgICB2YXIgaGVhZGVyLCB2YWx1ZSwgcGFyc2VkOwoKICAgIG5hbWUgPSBTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpOwoKICAgIGlkeCA9IGlkeCB8fCAwOwoKICAgIGlmKCF0aGlzLmhlYWRlcnNbbmFtZV0pIHsKICAgICAgdGhpcy5sb2dnZXIubG9nKCdoZWFkZXIgIicgKyBuYW1lICsgJyIgbm90IHByZXNlbnQnKTsKICAgICAgcmV0dXJuOwogICAgfSBlbHNlIGlmKGlkeCA+PSB0aGlzLmhlYWRlcnNbbmFtZV0ubGVuZ3RoKSB7CiAgICAgIHRoaXMubG9nZ2VyLmxvZygnbm90IHNvIG1hbnkgIicgKyBuYW1lICsgJyIgaGVhZGVycyBwcmVzZW50Jyk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBoZWFkZXIgPSB0aGlzLmhlYWRlcnNbbmFtZV1baWR4XTsKICAgIHZhbHVlID0gaGVhZGVyLnJhdzsKCiAgICBpZihoZWFkZXIucGFyc2VkKSB7CiAgICAgIHJldHVybiBoZWFkZXIucGFyc2VkOwogICAgfQoKICAgIC8vc3Vic3RpdHV0ZSAnLScgYnkgJ18nIGZvciBncmFtbWFyIHJ1bGUgbWF0Y2hpbmcuCiAgICBwYXJzZWQgPSBTSVAuR3JhbW1hci5wYXJzZSh2YWx1ZSwgbmFtZS5yZXBsYWNlKC8tL2csICdfJykpOwoKICAgIGlmKHBhcnNlZCA9PT0gLTEpIHsKICAgICAgdGhpcy5oZWFkZXJzW25hbWVdLnNwbGljZShpZHgsIDEpOyAvL2RlbGV0ZSBmcm9tIGhlYWRlcnMKICAgICAgdGhpcy5sb2dnZXIud2FybignZXJyb3IgcGFyc2luZyAiJyArIG5hbWUgKyAnIiBoZWFkZXIgZmllbGQgd2l0aCB2YWx1ZSAiJyArIHZhbHVlICsgJyInKTsKICAgICAgcmV0dXJuOwogICAgfSBlbHNlIHsKICAgICAgaGVhZGVyLnBhcnNlZCA9IHBhcnNlZDsKICAgICAgcmV0dXJuIHBhcnNlZDsKICAgIH0KICB9LAoKICAvKioKICAgKiBNZXNzYWdlIEhlYWRlciBhdHRyaWJ1dGUgc2VsZWN0b3IuIEFsaWFzIG9mIHBhcnNlSGVhZGVyLgogICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIGhlYWRlciBuYW1lCiAgICogQHBhcmFtIHtOdW1iZXJ9IFtpZHg9MF0gaGVhZGVyIGluZGV4CiAgICogQHJldHVybnMge09iamVjdHx1bmRlZmluZWR9IFBhcnNlZCBoZWFkZXIgb2JqZWN0LCB1bmRlZmluZWQgaWYgdGhlIGhlYWRlciBpcyBub3QgcHJlc2VudCBvciBpbiBjYXNlIG9mIGEgcGFyc2luZyBlcnJvci4KICAgKgogICAqIEBleGFtcGxlCiAgICogbWVzc2FnZS5zKCd2aWEnLDMpLnBvcnQKICAgKi8KICBzOiBmdW5jdGlvbihuYW1lLCBpZHgpIHsKICAgIHJldHVybiB0aGlzLnBhcnNlSGVhZGVyKG5hbWUsIGlkeCk7CiAgfSwKCiAgLyoqCiAgKiBSZXBsYWNlIHRoZSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gaGVhZGVyIGJ5IHRoZSB2YWx1ZS4KICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIGhlYWRlciBuYW1lCiAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWUgaGVhZGVyIHZhbHVlCiAgKi8KICBzZXRIZWFkZXI6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7CiAgICB2YXIgaGVhZGVyID0geyByYXc6IHZhbHVlIH07CiAgICB0aGlzLmhlYWRlcnNbU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKV0gPSBbaGVhZGVyXTsKICB9LAoKICB0b1N0cmluZzogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5kYXRhOwogIH0KfTsKCi8qKgogKiBAYXVnbWVudHMgSW5jb21pbmdNZXNzYWdlCiAqIEBjbGFzcyBDbGFzcyBmb3IgaW5jb21pbmcgU0lQIHJlcXVlc3QuCiAqLwpJbmNvbWluZ1JlcXVlc3QgPSBmdW5jdGlvbih1YSkgewogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAuc2lwbWVzc2FnZScpOwogIHRoaXMudWEgPSB1YTsKICB0aGlzLmhlYWRlcnMgPSB7fTsKICB0aGlzLnJ1cmkgPSBudWxsOwogIHRoaXMudHJhbnNwb3J0ID0gbnVsbDsKICB0aGlzLnNlcnZlcl90cmFuc2FjdGlvbiA9IG51bGw7Cn07CkluY29taW5nUmVxdWVzdC5wcm90b3R5cGUgPSBuZXcgSW5jb21pbmdNZXNzYWdlKCk7CgovKioKKiBTdGF0ZWZ1bCByZXBseS4KKiBAcGFyYW0ge051bWJlcn0gY29kZSBzdGF0dXMgY29kZQoqIEBwYXJhbSB7U3RyaW5nfSByZWFzb24gcmVhc29uIHBocmFzZQoqIEBwYXJhbSB7T2JqZWN0fSBoZWFkZXJzIGV4dHJhIGhlYWRlcnMKKiBAcGFyYW0ge1N0cmluZ30gYm9keSBib2R5CiogQHBhcmFtIHtGdW5jdGlvbn0gW29uU3VjY2Vzc10gb25TdWNjZXNzIGNhbGxiYWNrCiogQHBhcmFtIHtGdW5jdGlvbn0gW29uRmFpbHVyZV0gb25GYWlsdXJlIGNhbGxiYWNrCiovCkluY29taW5nUmVxdWVzdC5wcm90b3R5cGUucmVwbHkgPSBmdW5jdGlvbihjb2RlLCByZWFzb24sIGV4dHJhSGVhZGVycywgYm9keSwgb25TdWNjZXNzLCBvbkZhaWx1cmUpIHsKICB2YXIgcnIsIHZpYXMsIGxlbmd0aCwgaWR4LCByZXNwb25zZSwKICAgIHRvID0gdGhpcy5nZXRIZWFkZXIoJ1RvJyksCiAgICByID0gMCwKICAgIHYgPSAwOwoKICByZXNwb25zZSA9IFNJUC5VdGlscy5idWlsZFN0YXR1c0xpbmUoY29kZSwgcmVhc29uKTsKICBleHRyYUhlYWRlcnMgPSAoZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpOwoKICBpZih0aGlzLm1ldGhvZCA9PT0gU0lQLkMuSU5WSVRFICYmIGNvZGUgPiAxMDAgJiYgY29kZSA8PSAyMDApIHsKICAgIHJyID0gdGhpcy5nZXRIZWFkZXJzKCdyZWNvcmQtcm91dGUnKTsKICAgIGxlbmd0aCA9IHJyLmxlbmd0aDsKCiAgICBmb3IocjsgciA8IGxlbmd0aDsgcisrKSB7CiAgICAgIHJlc3BvbnNlICs9ICdSZWNvcmQtUm91dGU6ICcgKyBycltyXSArICdcclxuJzsKICAgIH0KICB9CgogIHZpYXMgPSB0aGlzLmdldEhlYWRlcnMoJ3ZpYScpOwogIGxlbmd0aCA9IHZpYXMubGVuZ3RoOwoKICBmb3IodjsgdiA8IGxlbmd0aDsgdisrKSB7CiAgICByZXNwb25zZSArPSAnVmlhOiAnICsgdmlhc1t2XSArICdcclxuJzsKICB9CgogIGlmKCF0aGlzLnRvX3RhZyAmJiBjb2RlID4gMTAwKSB7CiAgICB0byArPSAnO3RhZz0nICsgU0lQLlV0aWxzLm5ld1RhZygpOwogIH0gZWxzZSBpZih0aGlzLnRvX3RhZyAmJiAhdGhpcy5zKCd0bycpLmhhc1BhcmFtKCd0YWcnKSkgewogICAgdG8gKz0gJzt0YWc9JyArIHRoaXMudG9fdGFnOwogIH0KCiAgcmVzcG9uc2UgKz0gJ1RvOiAnICsgdG8gKyAnXHJcbic7CiAgcmVzcG9uc2UgKz0gJ0Zyb206ICcgKyB0aGlzLmdldEhlYWRlcignRnJvbScpICsgJ1xyXG4nOwogIHJlc3BvbnNlICs9ICdDYWxsLUlEOiAnICsgdGhpcy5jYWxsX2lkICsgJ1xyXG4nOwogIHJlc3BvbnNlICs9ICdDU2VxOiAnICsgdGhpcy5jc2VxICsgJyAnICsgdGhpcy5tZXRob2QgKyAnXHJcbic7CgogIGxlbmd0aCA9IGV4dHJhSGVhZGVycy5sZW5ndGg7CiAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICByZXNwb25zZSArPSBleHRyYUhlYWRlcnNbaWR4XS50cmltKCkgKydcclxuJzsKICB9CgogIHJlc3BvbnNlICs9IGdldFN1cHBvcnRlZEhlYWRlcih0aGlzKTsKICByZXNwb25zZSArPSAnVXNlci1BZ2VudDogJyArIHRoaXMudWEuY29uZmlndXJhdGlvbi51c2VyQWdlbnRTdHJpbmcgKydcclxuJzsKCiAgaWYoYm9keSkgewogICAgbGVuZ3RoID0gU0lQLlV0aWxzLnN0cl91dGY4X2xlbmd0aChib2R5KTsKICAgIHJlc3BvbnNlICs9ICdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3NkcFxyXG4nOwogICAgcmVzcG9uc2UgKz0gJ0NvbnRlbnQtTGVuZ3RoOiAnICsgbGVuZ3RoICsgJ1xyXG5cclxuJzsKICAgIHJlc3BvbnNlICs9IGJvZHk7CiAgfSBlbHNlIHsKICAgIHJlc3BvbnNlICs9ICdDb250ZW50LUxlbmd0aDogJyArIDAgKyAnXHJcblxyXG4nOwogIH0KCiAgdGhpcy5zZXJ2ZXJfdHJhbnNhY3Rpb24ucmVjZWl2ZVJlc3BvbnNlKGNvZGUsIHJlc3BvbnNlKS50aGVuKG9uU3VjY2Vzcywgb25GYWlsdXJlKTsKCiAgcmV0dXJuIHJlc3BvbnNlOwp9OwoKLyoqCiogU3RhdGVsZXNzIHJlcGx5LgoqIEBwYXJhbSB7TnVtYmVyfSBjb2RlIHN0YXR1cyBjb2RlCiogQHBhcmFtIHtTdHJpbmd9IHJlYXNvbiByZWFzb24gcGhyYXNlCiovCkluY29taW5nUmVxdWVzdC5wcm90b3R5cGUucmVwbHlfc2wgPSBmdW5jdGlvbihjb2RlLCByZWFzb24pIHsKICB2YXIgdG8sIHJlc3BvbnNlLAogICAgdiA9IDAsCiAgICB2aWFzID0gdGhpcy5nZXRIZWFkZXJzKCd2aWEnKSwKICAgIGxlbmd0aCA9IHZpYXMubGVuZ3RoOwoKICByZXNwb25zZSA9IFNJUC5VdGlscy5idWlsZFN0YXR1c0xpbmUoY29kZSwgcmVhc29uKTsKCiAgZm9yKHY7IHYgPCBsZW5ndGg7IHYrKykgewogICAgcmVzcG9uc2UgKz0gJ1ZpYTogJyArIHZpYXNbdl0gKyAnXHJcbic7CiAgfQoKICB0byA9IHRoaXMuZ2V0SGVhZGVyKCdUbycpOwoKICBpZighdGhpcy50b190YWcgJiYgY29kZSA+IDEwMCkgewogICAgdG8gKz0gJzt0YWc9JyArIFNJUC5VdGlscy5uZXdUYWcoKTsKICB9IGVsc2UgaWYodGhpcy50b190YWcgJiYgIXRoaXMucygndG8nKS5oYXNQYXJhbSgndGFnJykpIHsKICAgIHRvICs9ICc7dGFnPScgKyB0aGlzLnRvX3RhZzsKICB9CgogIHJlc3BvbnNlICs9ICdUbzogJyArIHRvICsgJ1xyXG4nOwogIHJlc3BvbnNlICs9ICdGcm9tOiAnICsgdGhpcy5nZXRIZWFkZXIoJ0Zyb20nKSArICdcclxuJzsKICByZXNwb25zZSArPSAnQ2FsbC1JRDogJyArIHRoaXMuY2FsbF9pZCArICdcclxuJzsKICByZXNwb25zZSArPSAnQ1NlcTogJyArIHRoaXMuY3NlcSArICcgJyArIHRoaXMubWV0aG9kICsgJ1xyXG4nOwogIHJlc3BvbnNlICs9ICdVc2VyLUFnZW50OiAnICsgdGhpcy51YS5jb25maWd1cmF0aW9uLnVzZXJBZ2VudFN0cmluZyArJ1xyXG4nOwogIHJlc3BvbnNlICs9ICdDb250ZW50LUxlbmd0aDogJyArIDAgKyAnXHJcblxyXG4nOwoKICB0aGlzLnRyYW5zcG9ydC5zZW5kKHJlc3BvbnNlKTsKfTsKCgovKioKICogQGF1Z21lbnRzIEluY29taW5nTWVzc2FnZQogKiBAY2xhc3MgQ2xhc3MgZm9yIGluY29taW5nIFNJUCByZXNwb25zZS4KICovCkluY29taW5nUmVzcG9uc2UgPSBmdW5jdGlvbih1YSkgewogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAuc2lwbWVzc2FnZScpOwogIHRoaXMuaGVhZGVycyA9IHt9OwogIHRoaXMuc3RhdHVzX2NvZGUgPSBudWxsOwogIHRoaXMucmVhc29uX3BocmFzZSA9IG51bGw7Cn07CkluY29taW5nUmVzcG9uc2UucHJvdG90eXBlID0gbmV3IEluY29taW5nTWVzc2FnZSgpOwoKU0lQLk91dGdvaW5nUmVxdWVzdCA9IE91dGdvaW5nUmVxdWVzdDsKU0lQLkluY29taW5nUmVxdWVzdCA9IEluY29taW5nUmVxdWVzdDsKU0lQLkluY29taW5nUmVzcG9uc2UgPSBJbmNvbWluZ1Jlc3BvbnNlOwp9OwoKfSx7fV0sMjU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IEluY29taW5nIFNJUCBNZXNzYWdlIFNhbml0eSBDaGVjawogKi8KCi8qKgogKiBTSVAgbWVzc2FnZSBzYW5pdHkgY2hlY2suCiAqIEBhdWdtZW50cyBTSVAKICogQGZ1bmN0aW9uCiAqIEBwYXJhbSB7U0lQLkluY29taW5nTWVzc2FnZX0gbWVzc2FnZQogKiBAcGFyYW0ge1NJUC5VQX0gdWEKICogQHBhcmFtIHtTSVAuVHJhbnNwb3J0fSB0cmFuc3BvcnQKICogQHJldHVybnMge0Jvb2xlYW59CiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyIHNhbml0eUNoZWNrLAogbG9nZ2VyLAogbWVzc2FnZSwgdWEsIHRyYW5zcG9ydCwKIHJlcXVlc3RzID0gW10sCiByZXNwb25zZXMgPSBbXSwKIGFsbCA9IFtdOwoKLy8gUmVwbHkKZnVuY3Rpb24gcmVwbHkoc3RhdHVzX2NvZGUpIHsKICB2YXIgdG8sCiAgICByZXNwb25zZSA9IFNJUC5VdGlscy5idWlsZFN0YXR1c0xpbmUoc3RhdHVzX2NvZGUpLAogICAgdmlhcyA9IG1lc3NhZ2UuZ2V0SGVhZGVycygndmlhJyksCiAgICBsZW5ndGggPSB2aWFzLmxlbmd0aCwKICAgIGlkeCA9IDA7CgogIGZvcihpZHg7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgIHJlc3BvbnNlICs9ICJWaWE6ICIgKyB2aWFzW2lkeF0gKyAiXHJcbiI7CiAgfQoKICB0byA9IG1lc3NhZ2UuZ2V0SGVhZGVyKCdUbycpOwoKICBpZighbWVzc2FnZS50b190YWcpIHsKICAgIHRvICs9ICc7dGFnPScgKyBTSVAuVXRpbHMubmV3VGFnKCk7CiAgfQoKICByZXNwb25zZSArPSAiVG86ICIgKyB0byArICJcclxuIjsKICByZXNwb25zZSArPSAiRnJvbTogIiArIG1lc3NhZ2UuZ2V0SGVhZGVyKCdGcm9tJykgKyAiXHJcbiI7CiAgcmVzcG9uc2UgKz0gIkNhbGwtSUQ6ICIgKyBtZXNzYWdlLmNhbGxfaWQgKyAiXHJcbiI7CiAgcmVzcG9uc2UgKz0gIkNTZXE6ICIgKyBtZXNzYWdlLmNzZXEgKyAiICIgKyBtZXNzYWdlLm1ldGhvZCArICJcclxuIjsKICByZXNwb25zZSArPSAiXHJcbiI7CgogIHRyYW5zcG9ydC5zZW5kKHJlc3BvbnNlKTsKfQoKLyoKICogU2FuaXR5IENoZWNrIGZvciBpbmNvbWluZyBNZXNzYWdlcwogKgogKiBSZXF1ZXN0czoKICogIC0gX3JmYzMyNjFfOF8yXzJfMV8gUmVjZWl2ZSBhIFJlcXVlc3Qgd2l0aCBhIG5vbiBzdXBwb3J0ZWQgVVJJIHNjaGVtZQogKiAgLSBfcmZjMzI2MV8xNl8zXzRfIFJlY2VpdmUgYSBSZXF1ZXN0IGFscmVhZHkgc2VudCBieSB1cwogKiAgIERvZXMgbm90IGxvb2sgYXQgdmlhIHNlbnQtYnkgYnV0IGF0IHNpcGpzSWQsIHdoaWNoIGlzIGluc2VydGVkIGFzCiAqICAgYSBwcmVmaXggaW4gYWxsIGluaXRpYWwgcmVxdWVzdHMgZ2VuZXJhdGVkIGJ5IHRoZSB1YQogKiAgLSBfcmZjMzI2MV8xOF8zX3JlcXVlc3RfIEJvZHkgQ29udGVudC1MZW5ndGgKICogIC0gX3JmYzMyNjFfOF8yXzJfMl8gTWVyZ2VkIFJlcXVlc3RzCiAqCiAqIFJlc3BvbnNlczoKICogIC0gX3JmYzMyNjFfOF8xXzNfM18gTXVsdGlwbGUgVmlhIGhlYWRlcnMKICogIC0gX3JmYzMyNjFfMThfMV8yXyBzZW50LWJ5IG1pc21hdGNoCiAqICAtIF9yZmMzMjYxXzE4XzNfcmVzcG9uc2VfIEJvZHkgQ29udGVudC1MZW5ndGgKICoKICogQWxsOgogKiAgLSBNaW5pbXVtIGhlYWRlcnMgaW4gYSBTSVAgbWVzc2FnZQogKi8KCi8vIFNhbml0eSBDaGVjayBmdW5jdGlvbnMgZm9yIHJlcXVlc3RzCmZ1bmN0aW9uIHJmYzMyNjFfOF8yXzJfMSgpIHsKICBpZighbWVzc2FnZS5ydXJpIHx8IG1lc3NhZ2UucnVyaS5zY2hlbWUgIT09ICdzaXAnKSB7CiAgICByZXBseSg0MTYpOwogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gcmZjMzI2MV8xNl8zXzQoKSB7CiAgaWYoIW1lc3NhZ2UudG9fdGFnKSB7CiAgICBpZihtZXNzYWdlLmNhbGxfaWQuc3Vic3RyKDAsIDUpID09PSB1YS5jb25maWd1cmF0aW9uLnNpcGpzSWQpIHsKICAgICAgcmVwbHkoNDgyKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KfQoKZnVuY3Rpb24gcmZjMzI2MV8xOF8zX3JlcXVlc3QoKSB7CiAgdmFyIGxlbiA9IFNJUC5VdGlscy5zdHJfdXRmOF9sZW5ndGgobWVzc2FnZS5ib2R5KSwKICBjb250ZW50TGVuZ3RoID0gbWVzc2FnZS5nZXRIZWFkZXIoJ2NvbnRlbnQtbGVuZ3RoJyk7CgogIGlmKGxlbiA8IGNvbnRlbnRMZW5ndGgpIHsKICAgIHJlcGx5KDQwMCk7CiAgICByZXR1cm4gZmFsc2U7CiAgfQp9CgpmdW5jdGlvbiByZmMzMjYxXzhfMl8yXzIoKSB7CiAgdmFyIHRyLCBpZHgsCiAgICBmcm9tVGFnID0gbWVzc2FnZS5mcm9tX3RhZywKICAgIGNhbGxfaWQgPSBtZXNzYWdlLmNhbGxfaWQsCiAgICBjc2VxID0gbWVzc2FnZS5jc2VxOwoKICBpZighbWVzc2FnZS50b190YWcpIHsKICAgIGlmKG1lc3NhZ2UubWV0aG9kID09PSBTSVAuQy5JTlZJVEUpIHsKICAgICAgdHIgPSB1YS50cmFuc2FjdGlvbnMuaXN0W21lc3NhZ2UudmlhX2JyYW5jaF07CiAgICAgIGlmKHRyKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIGZvcihpZHggaW4gdWEudHJhbnNhY3Rpb25zLmlzdCkgewogICAgICAgICAgdHIgPSB1YS50cmFuc2FjdGlvbnMuaXN0W2lkeF07CiAgICAgICAgICBpZih0ci5yZXF1ZXN0LmZyb21fdGFnID09PSBmcm9tVGFnICYmIHRyLnJlcXVlc3QuY2FsbF9pZCA9PT0gY2FsbF9pZCAmJiB0ci5yZXF1ZXN0LmNzZXEgPT09IGNzZXEpIHsKICAgICAgICAgICAgcmVwbHkoNDgyKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdHIgPSB1YS50cmFuc2FjdGlvbnMubmlzdFttZXNzYWdlLnZpYV9icmFuY2hdOwogICAgICBpZih0cikgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IoaWR4IGluIHVhLnRyYW5zYWN0aW9ucy5uaXN0KSB7CiAgICAgICAgICB0ciA9IHVhLnRyYW5zYWN0aW9ucy5uaXN0W2lkeF07CiAgICAgICAgICBpZih0ci5yZXF1ZXN0LmZyb21fdGFnID09PSBmcm9tVGFnICYmIHRyLnJlcXVlc3QuY2FsbF9pZCA9PT0gY2FsbF9pZCAmJiB0ci5yZXF1ZXN0LmNzZXEgPT09IGNzZXEpIHsKICAgICAgICAgICAgcmVwbHkoNDgyKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQoKLy8gU2FuaXR5IENoZWNrIGZ1bmN0aW9ucyBmb3IgcmVzcG9uc2VzCmZ1bmN0aW9uIHJmYzMyNjFfOF8xXzNfMygpIHsKICBpZihtZXNzYWdlLmdldEhlYWRlcnMoJ3ZpYScpLmxlbmd0aCA+IDEpIHsKICAgIGxvZ2dlci53YXJuKCdNb3JlIHRoYW4gb25lIFZpYSBoZWFkZXIgZmllbGQgcHJlc2VudCBpbiB0aGUgcmVzcG9uc2UuIERyb3BwaW5nIHRoZSByZXNwb25zZScpOwogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gcmZjMzI2MV8xOF8xXzIoKSB7CiAgdmFyIHZpYUhvc3QgPSB1YS5jb25maWd1cmF0aW9uLnZpYUhvc3Q7CiAgaWYobWVzc2FnZS52aWEuaG9zdCAhPT0gdmlhSG9zdCB8fCBtZXNzYWdlLnZpYS5wb3J0ICE9PSB1bmRlZmluZWQpIHsKICAgIGxvZ2dlci53YXJuKCdWaWEgc2VudC1ieSBpbiB0aGUgcmVzcG9uc2UgZG9lcyBub3QgbWF0Y2ggVUEgVmlhIGhvc3QgdmFsdWUuIERyb3BwaW5nIHRoZSByZXNwb25zZScpOwogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gcmZjMzI2MV8xOF8zX3Jlc3BvbnNlKCkgewogIHZhcgogICAgbGVuID0gU0lQLlV0aWxzLnN0cl91dGY4X2xlbmd0aChtZXNzYWdlLmJvZHkpLAogICAgY29udGVudExlbmd0aCA9IG1lc3NhZ2UuZ2V0SGVhZGVyKCdjb250ZW50LWxlbmd0aCcpOwoKICAgIGlmKGxlbiA8IGNvbnRlbnRMZW5ndGgpIHsKICAgICAgbG9nZ2VyLndhcm4oJ01lc3NhZ2UgYm9keSBsZW5ndGggaXMgbG93ZXIgdGhhbiB0aGUgdmFsdWUgaW4gQ29udGVudC1MZW5ndGggaGVhZGVyIGZpZWxkLiBEcm9wcGluZyB0aGUgcmVzcG9uc2UnKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQp9CgovLyBTYW5pdHkgQ2hlY2sgZnVuY3Rpb25zIGZvciByZXF1ZXN0cyBhbmQgcmVzcG9uc2VzCmZ1bmN0aW9uIG1pbmltdW1IZWFkZXJzKCkgewogIHZhcgogICAgbWFuZGF0b3J5SGVhZGVycyA9IFsnZnJvbScsICd0bycsICdjYWxsX2lkJywgJ2NzZXEnLCAndmlhJ10sCiAgICBpZHggPSBtYW5kYXRvcnlIZWFkZXJzLmxlbmd0aDsKCiAgd2hpbGUoaWR4LS0pIHsKICAgIGlmKCFtZXNzYWdlLmhhc0hlYWRlcihtYW5kYXRvcnlIZWFkZXJzW2lkeF0pKSB7CiAgICAgIGxvZ2dlci53YXJuKCdNaXNzaW5nIG1hbmRhdG9yeSBoZWFkZXIgZmllbGQgOiAnKyBtYW5kYXRvcnlIZWFkZXJzW2lkeF0gKycuIERyb3BwaW5nIHRoZSByZXNwb25zZScpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQp9CgpyZXF1ZXN0cy5wdXNoKHJmYzMyNjFfOF8yXzJfMSk7CnJlcXVlc3RzLnB1c2gocmZjMzI2MV8xNl8zXzQpOwpyZXF1ZXN0cy5wdXNoKHJmYzMyNjFfMThfM19yZXF1ZXN0KTsKcmVxdWVzdHMucHVzaChyZmMzMjYxXzhfMl8yXzIpOwoKcmVzcG9uc2VzLnB1c2gocmZjMzI2MV84XzFfM18zKTsKcmVzcG9uc2VzLnB1c2gocmZjMzI2MV8xOF8xXzIpOwpyZXNwb25zZXMucHVzaChyZmMzMjYxXzE4XzNfcmVzcG9uc2UpOwoKYWxsLnB1c2gobWluaW11bUhlYWRlcnMpOwoKc2FuaXR5Q2hlY2sgPSBmdW5jdGlvbihtLCB1LCB0KSB7CiAgdmFyIGxlbiwgcGFzczsKCiAgbWVzc2FnZSA9IG07CiAgdWEgPSB1OwogIHRyYW5zcG9ydCA9IHQ7CgogIGxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnNhbml0eWNoZWNrJyk7CgogIGxlbiA9IGFsbC5sZW5ndGg7CiAgd2hpbGUobGVuLS0pIHsKICAgIHBhc3MgPSBhbGxbbGVuXShtZXNzYWdlKTsKICAgIGlmKHBhc3MgPT09IGZhbHNlKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9CgogIGlmKG1lc3NhZ2UgaW5zdGFuY2VvZiBTSVAuSW5jb21pbmdSZXF1ZXN0KSB7CiAgICBsZW4gPSByZXF1ZXN0cy5sZW5ndGg7CiAgICB3aGlsZShsZW4tLSkgewogICAgICBwYXNzID0gcmVxdWVzdHNbbGVuXShtZXNzYWdlKTsKICAgICAgaWYocGFzcyA9PT0gZmFsc2UpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9CgogIGVsc2UgaWYobWVzc2FnZSBpbnN0YW5jZW9mIFNJUC5JbmNvbWluZ1Jlc3BvbnNlKSB7CiAgICBsZW4gPSByZXNwb25zZXMubGVuZ3RoOwogICAgd2hpbGUobGVuLS0pIHsKICAgICAgcGFzcyA9IHJlc3BvbnNlc1tsZW5dKG1lc3NhZ2UpOwogICAgICBpZihwYXNzID09PSBmYWxzZSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQogIH0KCiAgLy9FdmVyeXRoaW5nIGlzIE9LCiAgcmV0dXJuIHRydWU7Cn07CgpTSVAuc2FuaXR5Q2hlY2sgPSBzYW5pdHlDaGVjazsKfTsKCn0se31dLDI2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKdmFyIFNlcnZlckNvbnRleHQ7CgpTZXJ2ZXJDb250ZXh0ID0gZnVuY3Rpb24gKHVhLCByZXF1ZXN0KSB7CiAgdGhpcy51YSA9IHVhOwogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAuc2VydmVyY29udGV4dCcpOwogIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7CiAgaWYgKHJlcXVlc3QubWV0aG9kID09PSBTSVAuQy5JTlZJVEUpIHsKICAgIHRoaXMudHJhbnNhY3Rpb24gPSBuZXcgU0lQLlRyYW5zYWN0aW9ucy5JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbihyZXF1ZXN0LCB1YSk7CiAgfSBlbHNlIHsKICAgIHRoaXMudHJhbnNhY3Rpb24gPSBuZXcgU0lQLlRyYW5zYWN0aW9ucy5Ob25JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbihyZXF1ZXN0LCB1YSk7CiAgfQoKICBpZiAocmVxdWVzdC5ib2R5KSB7CiAgICB0aGlzLmJvZHkgPSByZXF1ZXN0LmJvZHk7CiAgfQogIGlmIChyZXF1ZXN0Lmhhc0hlYWRlcignQ29udGVudC1UeXBlJykpIHsKICAgIHRoaXMuY29udGVudFR5cGUgPSByZXF1ZXN0LmdldEhlYWRlcignQ29udGVudC1UeXBlJyk7CiAgfQogIHRoaXMubWV0aG9kID0gcmVxdWVzdC5tZXRob2Q7CgogIHRoaXMuZGF0YSA9IHt9OwoKICB0aGlzLmxvY2FsSWRlbnRpdHkgPSByZXF1ZXN0LnRvOwogIHRoaXMucmVtb3RlSWRlbnRpdHkgPSByZXF1ZXN0LmZyb207Cn07CgpTZXJ2ZXJDb250ZXh0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU0lQLkV2ZW50RW1pdHRlci5wcm90b3R5cGUpOwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUucHJvZ3Jlc3MgPSBmdW5jdGlvbiAob3B0aW9ucykgewogIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKG9wdGlvbnMgfHwgT2JqZWN0LnByb3RvdHlwZSk7CiAgb3B0aW9ucy5zdGF0dXNDb2RlIHx8IChvcHRpb25zLnN0YXR1c0NvZGUgPSAxODApOwogIG9wdGlvbnMubWluQ29kZSA9IDEwMDsKICBvcHRpb25zLm1heENvZGUgPSAxOTk7CiAgb3B0aW9ucy5ldmVudHMgPSBbJ3Byb2dyZXNzJ107CiAgcmV0dXJuIHRoaXMucmVwbHkob3B0aW9ucyk7Cn07CgpTZXJ2ZXJDb250ZXh0LnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbiAob3B0aW9ucykgewogIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKG9wdGlvbnMgfHwgT2JqZWN0LnByb3RvdHlwZSk7CiAgb3B0aW9ucy5zdGF0dXNDb2RlIHx8IChvcHRpb25zLnN0YXR1c0NvZGUgPSAyMDApOwogIG9wdGlvbnMubWluQ29kZSA9IDIwMDsKICBvcHRpb25zLm1heENvZGUgPSAyOTk7CiAgb3B0aW9ucy5ldmVudHMgPSBbJ2FjY2VwdGVkJ107CiAgcmV0dXJuIHRoaXMucmVwbHkob3B0aW9ucyk7Cn07CgpTZXJ2ZXJDb250ZXh0LnByb3RvdHlwZS5yZWplY3QgPSBmdW5jdGlvbiAob3B0aW9ucykgewogIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKG9wdGlvbnMgfHwgT2JqZWN0LnByb3RvdHlwZSk7CiAgb3B0aW9ucy5zdGF0dXNDb2RlIHx8IChvcHRpb25zLnN0YXR1c0NvZGUgPSA0ODApOwogIG9wdGlvbnMubWluQ29kZSA9IDMwMDsKICBvcHRpb25zLm1heENvZGUgPSA2OTk7CiAgb3B0aW9ucy5ldmVudHMgPSBbJ3JlamVjdGVkJywgJ2ZhaWxlZCddOwogIHJldHVybiB0aGlzLnJlcGx5KG9wdGlvbnMpOwp9OwoKU2VydmVyQ29udGV4dC5wcm90b3R5cGUucmVwbHkgPSBmdW5jdGlvbiAob3B0aW9ucykgewogIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OyAvLyBUaGlzIGlzIG9rYXksIHNvIGxvbmcgYXMgd2UgdHJlYXQgb3B0aW9ucyBhcyByZWFkLW9ubHkgaW4gdGhpcyBtZXRob2QKICB2YXIKICAgIHN0YXR1c0NvZGUgPSBvcHRpb25zLnN0YXR1c0NvZGUgfHwgMTAwLAogICAgbWluQ29kZSA9IG9wdGlvbnMubWluQ29kZSB8fCAxMDAsCiAgICBtYXhDb2RlID0gb3B0aW9ucy5tYXhDb2RlIHx8IDY5OSwKICAgIHJlYXNvblBocmFzZSA9IFNJUC5VdGlscy5nZXRSZWFzb25QaHJhc2Uoc3RhdHVzQ29kZSwgb3B0aW9ucy5yZWFzb25QaHJhc2UpLAogICAgZXh0cmFIZWFkZXJzID0gb3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10sCiAgICBib2R5ID0gb3B0aW9ucy5ib2R5LAogICAgZXZlbnRzID0gb3B0aW9ucy5ldmVudHMgfHwgW10sCiAgICByZXNwb25zZTsKCiAgaWYgKHN0YXR1c0NvZGUgPCBtaW5Db2RlIHx8IHN0YXR1c0NvZGUgPiBtYXhDb2RlKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHN0YXR1c0NvZGU6ICcgKyBzdGF0dXNDb2RlKTsKICB9CiAgcmVzcG9uc2UgPSB0aGlzLnJlcXVlc3QucmVwbHkoc3RhdHVzQ29kZSwgcmVhc29uUGhyYXNlLCBleHRyYUhlYWRlcnMsIGJvZHkpOwogIGV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChldmVudCkgewogICAgdGhpcy5lbWl0KGV2ZW50LCByZXNwb25zZSwgcmVhc29uUGhyYXNlKTsKICB9LCB0aGlzKTsKCiAgcmV0dXJuIHRoaXM7Cn07CgpTZXJ2ZXJDb250ZXh0LnByb3RvdHlwZS5vblJlcXVlc3RUaW1lb3V0ID0gZnVuY3Rpb24gKCkgewogIHRoaXMuZW1pdCgnZmFpbGVkJywgbnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7Cn07CgpTZXJ2ZXJDb250ZXh0LnByb3RvdHlwZS5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24gKCkgewogIHRoaXMuZW1pdCgnZmFpbGVkJywgbnVsbCwgU0lQLkMuY2F1c2VzLkNPTk5FQ1RJT05fRVJST1IpOwp9OwoKU0lQLlNlcnZlckNvbnRleHQgPSBTZXJ2ZXJDb250ZXh0Owp9OwoKfSx7fV0sMjc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCwgZW52aXJvbm1lbnQpIHsKCnZhciBEVE1GID0gcmVxdWlyZSgnLi9TZXNzaW9uL0RUTUYnKShTSVApOwoKdmFyIFNlc3Npb24sIEludml0ZVNlcnZlckNvbnRleHQsIEludml0ZUNsaWVudENvbnRleHQsCiBDID0gewogICAgLy9TZXNzaW9uIHN0YXRlcwogICAgU1RBVFVTX05VTEw6ICAgICAgICAgICAgICAgICAgICAgICAgMCwKICAgIFNUQVRVU19JTlZJVEVfU0VOVDogICAgICAgICAgICAgICAgIDEsCiAgICBTVEFUVVNfMVhYX1JFQ0VJVkVEOiAgICAgICAgICAgICAgICAyLAogICAgU1RBVFVTX0lOVklURV9SRUNFSVZFRDogICAgICAgICAgICAgMywKICAgIFNUQVRVU19XQUlUSU5HX0ZPUl9BTlNXRVI6ICAgICAgICAgIDQsCiAgICBTVEFUVVNfQU5TV0VSRUQ6ICAgICAgICAgICAgICAgICAgICA1LAogICAgU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLOiAgICAgICAgICAgNiwKICAgIFNUQVRVU19XQUlUSU5HX0ZPUl9BQ0s6ICAgICAgICAgICAgIDcsCiAgICBTVEFUVVNfQ0FOQ0VMRUQ6ICAgICAgICAgICAgICAgICAgICA4LAogICAgU1RBVFVTX1RFUk1JTkFURUQ6ICAgICAgICAgICAgICAgICAgOSwKICAgIFNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSzogMTAsCiAgICBTVEFUVVNfRUFSTFlfTUVESUE6ICAgICAgICAgICAgICAgIDExLAogICAgU1RBVFVTX0NPTkZJUk1FRDogICAgICAgICAgICAgICAgICAxMgogIH07CgovKgogKiBAcGFyYW0ge2Z1bmN0aW9uIHJldHVybmluZyBTSVAuTWVkaWFIYW5kbGVyfSBbbWVkaWFIYW5kbGVyRmFjdG9yeV0KICogICAgICAgIChTZWUgdGhlIGRvY3VtZW50YXRpb24gZm9yIHRoZSBtZWRpYUhhbmRsZXJGYWN0b3J5IGFyZ3VtZW50IG9mIHRoZSBVQSBjb25zdHJ1Y3Rvci4pCiAqLwpTZXNzaW9uID0gZnVuY3Rpb24gKG1lZGlhSGFuZGxlckZhY3RvcnkpIHsKICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX05VTEw7CiAgdGhpcy5kaWFsb2cgPSBudWxsOwogIHRoaXMuZWFybHlEaWFsb2dzID0ge307CiAgdGhpcy5tZWRpYUhhbmRsZXJGYWN0b3J5ID0gbWVkaWFIYW5kbGVyRmFjdG9yeSB8fCBTSVAuV2ViUlRDLk1lZGlhSGFuZGxlci5kZWZhdWx0RmFjdG9yeTsKICAvLyB0aGlzLm1lZGlhSGFuZGxlciBnZXRzIHNldCBieSBJQ0MvSVNDIGNvbnN0cnVjdG9ycwogIHRoaXMuaGFzT2ZmZXIgPSBmYWxzZTsKICB0aGlzLmhhc0Fuc3dlciA9IGZhbHNlOwoKICAvLyBTZXNzaW9uIFRpbWVycwogIHRoaXMudGltZXJzID0gewogICAgYWNrVGltZXI6IG51bGwsCiAgICBleHBpcmVzVGltZXI6IG51bGwsCiAgICBpbnZpdGUyeHhUaW1lcjogbnVsbCwKICAgIHVzZXJOb0Fuc3dlclRpbWVyOiBudWxsLAogICAgcmVsMXh4VGltZXI6IG51bGwsCiAgICBwcmFja1RpbWVyOiBudWxsCiAgfTsKCiAgLy8gU2Vzc2lvbiBpbmZvCiAgdGhpcy5zdGFydFRpbWUgPSBudWxsOwogIHRoaXMuZW5kVGltZSA9IG51bGw7CiAgdGhpcy50b25lcyA9IG51bGw7CgogIC8vIE11dGUvSG9sZCBzdGF0ZQogIHRoaXMubG9jYWxfaG9sZCA9IGZhbHNlOwogIHRoaXMucmVtb3RlX2hvbGQgPSBmYWxzZTsKCiAgdGhpcy5wZW5kaW5nX2FjdGlvbnMgPSB7CiAgICBhY3Rpb25zOiBbXSwKCiAgICBsZW5ndGg6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5hY3Rpb25zLmxlbmd0aDsKICAgIH0sCgogICAgaXNQZW5kaW5nOiBmdW5jdGlvbihuYW1lKXsKICAgICAgdmFyCiAgICAgIGlkeCA9IDAsCiAgICAgIGxlbmd0aCA9IHRoaXMuYWN0aW9ucy5sZW5ndGg7CgogICAgICBmb3IgKGlkeDsgaWR4PGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBpZiAodGhpcy5hY3Rpb25zW2lkeF0ubmFtZSA9PT0gbmFtZSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCgogICAgc2hpZnQ6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5hY3Rpb25zLnNoaWZ0KCk7CiAgICB9LAoKICAgIHB1c2g6IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgdGhpcy5hY3Rpb25zLnB1c2goewogICAgICAgIG5hbWU6IG5hbWUKICAgICAgfSk7CiAgICB9LAoKICAgIHBvcDogZnVuY3Rpb24obmFtZSkgewogICAgICB2YXIKICAgICAgaWR4ID0gMCwKICAgICAgbGVuZ3RoID0gdGhpcy5hY3Rpb25zLmxlbmd0aDsKCiAgICAgIGZvciAoaWR4OyBpZHg8bGVuZ3RoOyBpZHgrKykgewogICAgICAgIGlmICh0aGlzLmFjdGlvbnNbaWR4XS5uYW1lID09PSBuYW1lKSB7CiAgICAgICAgICB0aGlzLmFjdGlvbnMuc3BsaWNlKGlkeCwxKTsKICAgICAgICAgIGxlbmd0aCAtLTsKICAgICAgICAgIGlkeC0tOwogICAgICAgIH0KICAgICAgfQogICAgfQogICB9OwoKICB0aGlzLmVhcmx5X3NkcCA9IG51bGw7CiAgdGhpcy5yZWwxMDAgPSBTSVAuQy5zdXBwb3J0ZWQuVU5TVVBQT1JURUQ7Cn07CgpTZXNzaW9uLnByb3RvdHlwZSA9IHsKICBkdG1mOiBmdW5jdGlvbih0b25lcywgb3B0aW9ucykgewogICAgdmFyIHRvbmUsIGR0bWZzID0gW10sCiAgICAgICAgc2VsZiA9IHRoaXM7CgogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgogICAgaWYgKHRvbmVzID09PSB1bmRlZmluZWQpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignTm90IGVub3VnaCBhcmd1bWVudHMnKTsKICAgIH0KCiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQgJiYgdGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSykgewogICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogICAgfQoKICAgIC8vIENoZWNrIHRvbmVzCiAgICBpZiAoKHR5cGVvZiB0b25lcyAhPT0gJ3N0cmluZycgJiYgdHlwZW9mIHRvbmVzICE9PSAnbnVtYmVyJykgfHwgIXRvbmVzLnRvU3RyaW5nKCkubWF0Y2goL15bMC05QS1EIyosXSskL2kpKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgdG9uZXM6ICcrIHRvbmVzKTsKICAgIH0KCiAgICB0b25lcyA9IHRvbmVzLnRvU3RyaW5nKCkuc3BsaXQoJycpOwoKICAgIHdoaWxlICh0b25lcy5sZW5ndGggPiAwKSB7IGR0bWZzLnB1c2gobmV3IERUTUYodGhpcywgdG9uZXMuc2hpZnQoKSwgb3B0aW9ucykpOyB9CgogICAgaWYgKHRoaXMudG9uZXMpIHsKICAgICAgLy8gVG9uZXMgYXJlIGFscmVhZHkgcXVldWVkLCBqdXN0IGFkZCB0byB0aGUgcXVldWUKICAgICAgdGhpcy50b25lcyA9ICB0aGlzLnRvbmVzLmNvbmNhdChkdG1mcyk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHZhciBzZW5kRFRNRiA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGR0bWYsIHRpbWVvdXQ7CgogICAgICBpZiAoc2VsZi5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQgfHwgIXNlbGYudG9uZXMgfHwgc2VsZi50b25lcy5sZW5ndGggPT09IDApIHsKICAgICAgICAvLyBTdG9wIHNlbmRpbmcgRFRNRgogICAgICAgIHNlbGYudG9uZXMgPSBudWxsOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CgogICAgICBkdG1mID0gc2VsZi50b25lcy5zaGlmdCgpOwoKICAgICAgaWYgKHRvbmUgPT09ICcsJykgewogICAgICAgIHRpbWVvdXQgPSAyMDAwOwogICAgICB9IGVsc2UgewogICAgICAgIGR0bWYub24oJ2ZhaWxlZCcsIGZ1bmN0aW9uKCl7c2VsZi50b25lcyA9IG51bGw7fSk7CiAgICAgICAgZHRtZi5zZW5kKG9wdGlvbnMpOwogICAgICAgIHRpbWVvdXQgPSBkdG1mLmR1cmF0aW9uICsgZHRtZi5pbnRlclRvbmVHYXA7CiAgICAgIH0KCiAgICAgIC8vIFNldCB0aW1lb3V0IGZvciB0aGUgbmV4dCB0b25lCiAgICAgIFNJUC5UaW1lcnMuc2V0VGltZW91dChzZW5kRFRNRiwgdGltZW91dCk7CiAgICB9OwoKICAgIHRoaXMudG9uZXMgPSBkdG1mczsKICAgIHNlbmREVE1GKCk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBieWU6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKG9wdGlvbnMgfHwgT2JqZWN0LnByb3RvdHlwZSk7CiAgICB2YXIgc3RhdHVzQ29kZSA9IG9wdGlvbnMuc3RhdHVzQ29kZTsKCiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKCdFcnJvcjogQXR0ZW1wdGVkIHRvIHNlbmQgQllFIGluIGEgdGVybWluYXRlZCBzZXNzaW9uLicpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICB0aGlzLmxvZ2dlci5sb2coJ3Rlcm1pbmF0aW5nIFNlc3Npb24nKTsKCiAgICBpZiAoc3RhdHVzQ29kZSAmJiAoc3RhdHVzQ29kZSA8IDIwMCB8fCBzdGF0dXNDb2RlID49IDcwMCkpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdGF0dXNDb2RlOiAnKyBzdGF0dXNDb2RlKTsKICAgIH0KCiAgICBvcHRpb25zLnJlY2VpdmVSZXNwb25zZSA9IGZ1bmN0aW9uICgpIHt9OwoKICAgIHJldHVybiB0aGlzLgogICAgICBzZW5kUmVxdWVzdChTSVAuQy5CWUUsIG9wdGlvbnMpLgogICAgICB0ZXJtaW5hdGVkKCk7CiAgfSwKCiAgcmVmZXI6IGZ1bmN0aW9uKHRhcmdldCwgb3B0aW9ucykgewogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgICB2YXIgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgICAgIHdpdGhSZXBsYWNlcyA9CiAgICAgICAgICB0YXJnZXQgaW5zdGFuY2VvZiBTSVAuSW52aXRlU2VydmVyQ29udGV4dCB8fAogICAgICAgICAgdGFyZ2V0IGluc3RhbmNlb2YgU0lQLkludml0ZUNsaWVudENvbnRleHQsCiAgICAgICAgb3JpZ2luYWxUYXJnZXQgPSB0YXJnZXQ7CgogICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ05vdCBlbm91Z2ggYXJndW1lbnRzJyk7CiAgICB9CgogICAgLy8gQ2hlY2sgU2Vzc2lvbiBTdGF0dXMKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5JbnZhbGlkU3RhdGVFcnJvcih0aGlzLnN0YXR1cyk7CiAgICB9CgogICAgLy8gdHJhbnNmb3JtIGB0YXJnZXRgIHNvIHRoYXQgaXQgY2FuIGJlIGEgUmVmZXItVG8gaGVhZGVyIHZhbHVlCiAgICBpZiAod2l0aFJlcGxhY2VzKSB7CiAgICAgIC8vQXR0ZW5kZWQgVHJhbnNmZXIKICAgICAgLy8gQi50cmFuc2ZlcihDKQogICAgICB0YXJnZXQgPSAnIicgKyB0YXJnZXQucmVtb3RlSWRlbnRpdHkuZnJpZW5kbHlOYW1lICsgJyIgJyArCiAgICAgICAgJzwnICsgdGFyZ2V0LmRpYWxvZy5yZW1vdGVfdGFyZ2V0LnRvU3RyaW5nKCkgKwogICAgICAgICc/UmVwbGFjZXM9JyArIHRhcmdldC5kaWFsb2cuaWQuY2FsbF9pZCArCiAgICAgICAgJyUzQnRvLXRhZyUzRCcgKyB0YXJnZXQuZGlhbG9nLmlkLnJlbW90ZV90YWcgKwogICAgICAgICclM0Jmcm9tLXRhZyUzRCcgKyB0YXJnZXQuZGlhbG9nLmlkLmxvY2FsX3RhZyArICc+JzsKICAgIH0gZWxzZSB7CiAgICAgIC8vQmxpbmQgVHJhbnNmZXIKICAgICAgLy8gbm9ybWFsaXplVGFyZ2V0IGFsbG93cyBpbnN0YW5jZXMgb2YgU0lQLlVSSSB0byBwYXNzIHRocm91Z2ggdW5hbHRlcmVkLAogICAgICAvLyBzbyB0cnkgdG8gbWFrZSBvbmUgYWhlYWQgb2YgdGltZQogICAgICB0cnkgewogICAgICAgIHRhcmdldCA9IFNJUC5HcmFtbWFyLnBhcnNlKHRhcmdldCwgJ1JlZmVyX1RvJykudXJpIHx8IHRhcmdldDsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKCIucmVmZXIoKSBjYW5ub3QgcGFyc2UgUmVmZXJfVG8gZnJvbSIsIHRhcmdldCk7CiAgICAgICAgdGhpcy5sb2dnZXIuZGVidWcoIi4uLmZhbGxpbmcgdGhyb3VnaCB0byBub3JtYWxpemVUYXJnZXQoKSIpOwogICAgICB9CgogICAgICAvLyBDaGVjayB0YXJnZXQgdmFsaWRpdHkKICAgICAgdGFyZ2V0ID0gdGhpcy51YS5ub3JtYWxpemVUYXJnZXQodGFyZ2V0KTsKICAgICAgaWYgKCF0YXJnZXQpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRhcmdldDogJyArIG9yaWdpbmFsVGFyZ2V0KTsKICAgICAgfQogICAgfQoKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250YWN0OiAnKyB0aGlzLmNvbnRhY3QpOwogICAgZXh0cmFIZWFkZXJzLnB1c2goJ0FsbG93OiAnKyBTSVAuVUEuQy5BTExPV0VEX01FVEhPRFMudG9TdHJpbmcoKSk7CiAgICBleHRyYUhlYWRlcnMucHVzaCgnUmVmZXItVG86ICcrIHRhcmdldCk7CgogICAgLy8gU2VuZCB0aGUgcmVxdWVzdAogICAgdGhpcy5zZW5kUmVxdWVzdChTSVAuQy5SRUZFUiwgewogICAgICBleHRyYUhlYWRlcnM6IGV4dHJhSGVhZGVycywKICAgICAgYm9keTogb3B0aW9ucy5ib2R5LAogICAgICByZWNlaXZlUmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmICggISAvXjJbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpICkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAvLyBoYW5nIHVwIG9ubHkgaWYgd2UgdHJhbnNmZXJyZWQgdG8gYSBTSVAgYWRkcmVzcwogICAgICAgIGlmICh3aXRoUmVwbGFjZXMgfHwgKHRhcmdldC5zY2hlbWUgJiYgdGFyZ2V0LnNjaGVtZS5tYXRjaCgiXnNpcHM/JCIpKSkgewogICAgICAgICAgdGhpcy50ZXJtaW5hdGUoKTsKICAgICAgICB9CiAgICAgIH0uYmluZCh0aGlzKQogICAgfSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBmb2xsb3dSZWZlcjogZnVuY3Rpb24gZm9sbG93UmVmZXIgKGNhbGxiYWNrKSB7CiAgICByZXR1cm4gZnVuY3Rpb24gcmVmZXJMaXN0ZW5lciAoY2FsbGJhY2ssIHJlcXVlc3QpIHsKICAgICAgLy8gb3BlbiBub24tU0lQIFVSSXMgaWYgcG9zc2libGUgYW5kIGtlZXAgc2Vzc2lvbiBvcGVuCiAgICAgIHZhciByZWZlclRvID0gcmVxdWVzdC5wYXJzZUhlYWRlcigncmVmZXItdG8nKTsKICAgICAgdmFyIHRhcmdldCA9IHJlZmVyVG8udXJpOwogICAgICBpZiAoIXRhcmdldC5zY2hlbWUubWF0Y2goIl5zaXBzPyQiKSkgewogICAgICAgIHZhciB0YXJnZXRTdHJpbmcgPSB0YXJnZXQudG9TdHJpbmcoKTsKICAgICAgICBpZiAodHlwZW9mIGVudmlyb25tZW50Lm9wZW4gPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgIGVudmlyb25tZW50Lm9wZW4odGFyZ2V0U3RyaW5nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5sb2dnZXIud2FybigicmVmZXJyZWQgdG8gbm9uLVNJUCBVUkkgYnV0IGBvcGVuYCBpc24ndCBpbiB0aGUgZW52aXJvbm1lbnQ6ICIgKyB0YXJnZXRTdHJpbmcpOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBleHRyYUhlYWRlcnMgPSBbXTsKCiAgICAgIC8qIENvcHkgdGhlIFJlcGxhY2VzIHF1ZXJ5IGludG8gYSBSZXBsYWNlcyBoZWFkZXIgKi8KICAgICAgLyogVE9ETyAtIG1ha2Ugc3VyZSB3ZSBkb24ndCBjb3B5IGEgcG9vcmx5IGZvcm1hdHRlZCBoZWFkZXI/ICovCiAgICAgIHZhciByZXBsYWNlcyA9IHRhcmdldC5nZXRIZWFkZXIoJ1JlcGxhY2VzJyk7CiAgICAgIGlmIChyZXBsYWNlcyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JlcGxhY2VzOiAnICsgZGVjb2RlVVJJQ29tcG9uZW50KHJlcGxhY2VzKSk7CiAgICAgIH0KCiAgICAgIC8vIGRvbid0IGVtYmVkIGhlYWRlcnMgaW50byBSZXF1ZXN0LVVSSSBvZiBJTlZJVEUKICAgICAgdGFyZ2V0LmNsZWFySGVhZGVycygpOwoKICAgICAgLyoKICAgICAgICBIYXJtbGVzcyByYWNlIGNvbmRpdGlvbi4gIEJvdGggc2lkZXMgb2YgUkVGRVIKICAgICAgICBtYXkgc2VuZCBhIEJZRSwgYnV0IGluIHRoZSBlbmQgdGhlIGRpYWxvZ3MgYXJlIGRlc3Ryb3llZC4KICAgICAgKi8KICAgICAgdmFyIGdldFJlZmVyTWVkaWEgPSB0aGlzLm1lZGlhSGFuZGxlci5nZXRSZWZlck1lZGlhOwogICAgICB2YXIgbWVkaWFIaW50ID0gZ2V0UmVmZXJNZWRpYSA/IGdldFJlZmVyTWVkaWEuY2FsbCh0aGlzLm1lZGlhSGFuZGxlcikgOiB0aGlzLm1lZGlhSGludDsKCiAgICAgIFNJUC5IYWNrcy5DaHJvbWUuZ2V0c0NvbmZ1c2VkQWJvdXRHVU0odGhpcyk7CgogICAgICB2YXIgcmVmZXJTZXNzaW9uID0gdGhpcy51YS5pbnZpdGUodGFyZ2V0LCB7CiAgICAgICAgbWVkaWE6IG1lZGlhSGludCwKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIHRvX2Rpc3BsYXlOYW1lOiByZWZlclRvLmZyaWVuZGx5TmFtZQogICAgICAgIH0sCiAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMKICAgICAgfSk7CgogICAgICBjYWxsYmFjay5jYWxsKHRoaXMsIHJlcXVlc3QsIHJlZmVyU2Vzc2lvbik7CgogICAgICB0aGlzLnRlcm1pbmF0ZSgpOwogICAgfS5iaW5kKHRoaXMsIGNhbGxiYWNrKTsKICB9LAoKICBzZW5kUmVxdWVzdDogZnVuY3Rpb24obWV0aG9kLG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgIHZhciByZXF1ZXN0ID0gbmV3IFNJUC5PdXRnb2luZ1JlcXVlc3QoCiAgICAgIG1ldGhvZCwKICAgICAgdGhpcy5kaWFsb2cucmVtb3RlX3RhcmdldCwKICAgICAgdGhpcy51YSwKICAgICAgewogICAgICAgIGNzZXE6IG9wdGlvbnMuY3NlcSB8fCAodGhpcy5kaWFsb2cubG9jYWxfc2VxbnVtICs9IDEpLAogICAgICAgIGNhbGxfaWQ6IHRoaXMuZGlhbG9nLmlkLmNhbGxfaWQsCiAgICAgICAgZnJvbV91cmk6IHRoaXMuZGlhbG9nLmxvY2FsX3VyaSwKICAgICAgICBmcm9tX3RhZzogdGhpcy5kaWFsb2cuaWQubG9jYWxfdGFnLAogICAgICAgIHRvX3VyaTogdGhpcy5kaWFsb2cucmVtb3RlX3VyaSwKICAgICAgICB0b190YWc6IHRoaXMuZGlhbG9nLmlkLnJlbW90ZV90YWcsCiAgICAgICAgcm91dGVfc2V0OiB0aGlzLmRpYWxvZy5yb3V0ZV9zZXQsCiAgICAgICAgc3RhdHVzQ29kZTogb3B0aW9ucy5zdGF0dXNDb2RlLAogICAgICAgIHJlYXNvblBocmFzZTogb3B0aW9ucy5yZWFzb25QaHJhc2UKICAgICAgfSwKICAgICAgb3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10sCiAgICAgIG9wdGlvbnMuYm9keQogICAgKTsKCiAgICBuZXcgU0lQLlJlcXVlc3RTZW5kZXIoewogICAgICByZXF1ZXN0OiByZXF1ZXN0LAogICAgICBvblJlcXVlc3RUaW1lb3V0OiBmdW5jdGlvbigpIHsKICAgICAgICBzZWxmLm9uUmVxdWVzdFRpbWVvdXQoKTsKICAgICAgfSwKICAgICAgb25UcmFuc3BvcnRFcnJvcjogZnVuY3Rpb24oKSB7CiAgICAgICAgc2VsZi5vblRyYW5zcG9ydEVycm9yKCk7CiAgICAgIH0sCiAgICAgIHJlY2VpdmVSZXNwb25zZTogb3B0aW9ucy5yZWNlaXZlUmVzcG9uc2UgfHwgZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICBzZWxmLnJlY2VpdmVOb25JbnZpdGVSZXNwb25zZShyZXNwb25zZSk7CiAgICAgIH0KICAgIH0sIHRoaXMudWEpLnNlbmQoKTsKCiAgICAvLyBFbWl0IHRoZSByZXF1ZXN0IGV2ZW50CiAgICB0aGlzLmVtaXQobWV0aG9kLnRvTG93ZXJDYXNlKCksIHJlcXVlc3QpOwoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIGNsb3NlOiBmdW5jdGlvbigpIHsKICAgIHZhciBpZHg7CgogICAgaWYodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgdGhpcy5sb2dnZXIubG9nKCdjbG9zaW5nIElOVklURSBzZXNzaW9uICcgKyB0aGlzLmlkKTsKCiAgICAvLyAxc3QgU3RlcC4gVGVybWluYXRlIG1lZGlhLgogICAgaWYgKHRoaXMubWVkaWFIYW5kbGVyKXsKICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuY2xvc2UoKTsKICAgIH0KCiAgICAvLyAybmQgU3RlcC4gVGVybWluYXRlIHNpZ25hbGluZy4KCiAgICAvLyBDbGVhciBzZXNzaW9uIHRpbWVycwogICAgZm9yKGlkeCBpbiB0aGlzLnRpbWVycykgewogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVyc1tpZHhdKTsKICAgIH0KCiAgICAvLyBUZXJtaW5hdGUgZGlhbG9ncwoKICAgIC8vIFRlcm1pbmF0ZSBjb25maXJtZWQgZGlhbG9nCiAgICBpZih0aGlzLmRpYWxvZykgewogICAgICB0aGlzLmRpYWxvZy50ZXJtaW5hdGUoKTsKICAgICAgZGVsZXRlIHRoaXMuZGlhbG9nOwogICAgfQoKICAgIC8vIFRlcm1pbmF0ZSBlYXJseSBkaWFsb2dzCiAgICBmb3IoaWR4IGluIHRoaXMuZWFybHlEaWFsb2dzKSB7CiAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkeF0udGVybWluYXRlKCk7CiAgICAgIGRlbGV0ZSB0aGlzLmVhcmx5RGlhbG9nc1tpZHhdOwogICAgfQoKICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfVEVSTUlOQVRFRDsKCiAgICBkZWxldGUgdGhpcy51YS5zZXNzaW9uc1t0aGlzLmlkXTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIGNyZWF0ZURpYWxvZzogZnVuY3Rpb24obWVzc2FnZSwgdHlwZSwgZWFybHkpIHsKICAgIHZhciBkaWFsb2csIGVhcmx5X2RpYWxvZywKICAgICAgbG9jYWxfdGFnID0gbWVzc2FnZVsodHlwZSA9PT0gJ1VBUycpID8gJ3RvX3RhZycgOiAnZnJvbV90YWcnXSwKICAgICAgcmVtb3RlX3RhZyA9IG1lc3NhZ2VbKHR5cGUgPT09ICdVQVMnKSA/ICdmcm9tX3RhZycgOiAndG9fdGFnJ10sCiAgICAgIGlkID0gbWVzc2FnZS5jYWxsX2lkICsgbG9jYWxfdGFnICsgcmVtb3RlX3RhZzsKCiAgICBlYXJseV9kaWFsb2cgPSB0aGlzLmVhcmx5RGlhbG9nc1tpZF07CgogICAgLy8gRWFybHkgRGlhbG9nCiAgICBpZiAoZWFybHkpIHsKICAgICAgaWYgKGVhcmx5X2RpYWxvZykgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIGVhcmx5X2RpYWxvZyA9IG5ldyBTSVAuRGlhbG9nKHRoaXMsIG1lc3NhZ2UsIHR5cGUsIFNJUC5EaWFsb2cuQy5TVEFUVVNfRUFSTFkpOwoKICAgICAgICAvLyBEaWFsb2cgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IGNyZWF0ZWQuCiAgICAgICAgaWYoZWFybHlfZGlhbG9nLmVycm9yKSB7CiAgICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcihlYXJseV9kaWFsb2cuZXJyb3IpOwogICAgICAgICAgdGhpcy5mYWlsZWQobWVzc2FnZSwgU0lQLkMuY2F1c2VzLklOVEVSTkFMX0VSUk9SKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdID0gZWFybHlfZGlhbG9nOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvLyBDb25maXJtZWQgRGlhbG9nCiAgICBlbHNlIHsKICAgICAgLy8gSW4gY2FzZSB0aGUgZGlhbG9nIGlzIGluIF9lYXJseV8gc3RhdGUsIHVwZGF0ZSBpdAogICAgICBpZiAoZWFybHlfZGlhbG9nKSB7CiAgICAgICAgZWFybHlfZGlhbG9nLnVwZGF0ZShtZXNzYWdlLCB0eXBlKTsKICAgICAgICB0aGlzLmRpYWxvZyA9IGVhcmx5X2RpYWxvZzsKICAgICAgICBkZWxldGUgdGhpcy5lYXJseURpYWxvZ3NbaWRdOwogICAgICAgIGZvciAodmFyIGRpYSBpbiB0aGlzLmVhcmx5RGlhbG9ncykgewogICAgICAgICAgdGhpcy5lYXJseURpYWxvZ3NbZGlhXS50ZXJtaW5hdGUoKTsKICAgICAgICAgIGRlbGV0ZSB0aGlzLmVhcmx5RGlhbG9nc1tkaWFdOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgLy8gT3RoZXJ3aXNlLCBjcmVhdGUgYSBfY29uZmlybWVkXyBkaWFsb2cKICAgICAgZGlhbG9nID0gbmV3IFNJUC5EaWFsb2codGhpcywgbWVzc2FnZSwgdHlwZSk7CgogICAgICBpZihkaWFsb2cuZXJyb3IpIHsKICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcihkaWFsb2cuZXJyb3IpOwogICAgICAgIHRoaXMuZmFpbGVkKG1lc3NhZ2UsIFNJUC5DLmNhdXNlcy5JTlRFUk5BTF9FUlJPUik7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMudG9fdGFnID0gbWVzc2FnZS50b190YWc7CiAgICAgICAgdGhpcy5kaWFsb2cgPSBkaWFsb2c7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KICB9LAoKICAvKioKICAqIENoZWNrIGlmIFNlc3Npb24gaXMgcmVhZHkgZm9yIGEgcmUtSU5WSVRFCiAgKgogICogQHJldHVybnMge0Jvb2xlYW59CiAgKi8KICBpc1JlYWR5VG9SZWludml0ZTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5tZWRpYUhhbmRsZXIuaXNSZWFkeSgpICYmCiAgICAgICF0aGlzLmRpYWxvZy51YWNfcGVuZGluZ19yZXBseSAmJgogICAgICAhdGhpcy5kaWFsb2cudWFzX3BlbmRpbmdfcmVwbHk7CiAgfSwKCiAgLyoqCiAgICogTXV0ZQogICAqLwogIG11dGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIHZhciByZXQgPSB0aGlzLm1lZGlhSGFuZGxlci5tdXRlKG9wdGlvbnMpOwogICAgaWYgKHJldCkgewogICAgICB0aGlzLm9ubXV0ZShyZXQpOwogICAgfQogIH0sCgogIC8qKgogICAqIFVubXV0ZQogICAqLwogIHVubXV0ZTogZnVuY3Rpb24ob3B0aW9ucykgewogICAgdmFyIHJldCA9IHRoaXMubWVkaWFIYW5kbGVyLnVubXV0ZShvcHRpb25zKTsKICAgIGlmIChyZXQpIHsKICAgICAgdGhpcy5vbnVubXV0ZShyZXQpOwogICAgfQogIH0sCgogIC8qKgogICAqIEhvbGQKICAgKi8KICBob2xkOiBmdW5jdGlvbihvcHRpb25zKSB7CgogICAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0sgJiYgdGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogICAgfQoKICAgIHRoaXMubWVkaWFIYW5kbGVyLmhvbGQoKTsKCiAgICAvLyBDaGVjayBpZiBSVENTZXNzaW9uIGlzIHJlYWR5IHRvIHNlbmQgYSByZUlOVklURQogICAgaWYgKCF0aGlzLmlzUmVhZHlUb1JlaW52aXRlKCkpIHsKICAgICAgLyogSWYgdGhlcmUgaXMgYSBwZW5kaW5nICd1bmhvbGQnIGFjdGlvbiwgY2FuY2VsIGl0IGFuZCBkb24ndCBxdWV1ZSB0aGlzIG9uZQogICAgICAgKiBFbHNlLCBpZiB0aGVyZSBpc24ndCBhbnkgJ2hvbGQnIGFjdGlvbiwgYWRkIHRoaXMgb25lIHRvIHRoZSBxdWV1ZQogICAgICAgKiBFbHNlLCBpZiB0aGVyZSBpcyBhbHJlYWR5IGEgJ2hvbGQnIGFjdGlvbiwgc2tpcAogICAgICAgKi8KICAgICAgaWYgKHRoaXMucGVuZGluZ19hY3Rpb25zLmlzUGVuZGluZygndW5ob2xkJykpIHsKICAgICAgICB0aGlzLnBlbmRpbmdfYWN0aW9ucy5wb3AoJ3VuaG9sZCcpOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnBlbmRpbmdfYWN0aW9ucy5pc1BlbmRpbmcoJ2hvbGQnKSkgewogICAgICAgIHRoaXMucGVuZGluZ19hY3Rpb25zLnB1c2goJ2hvbGQnKTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9IGVsc2UgaWYgKHRoaXMubG9jYWxfaG9sZCA9PT0gdHJ1ZSkgewogICAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLm9uaG9sZCgnbG9jYWwnKTsKCiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgIG9wdGlvbnMubWFuZ2xlID0gZnVuY3Rpb24oYm9keSl7CgogICAgICAvLyBEb24ndCByZWNlaXZlIG1lZGlhCiAgICAgIC8vIFRPRE8gLSBUaGlzIHdpbGwgYnJlYWsgZm9yIG1lZGlhIHN0cmVhbXMgd2l0aCBkaWZmZXJlbnQgZGlyZWN0aW9ucy4KICAgICAgaWYgKCEoL2E9KHNlbmRyZWN2fHNlbmRvbmx5fHJlY3Zvbmx5fGluYWN0aXZlKS8pLnRlc3QoYm9keSkpIHsKICAgICAgICBib2R5ID0gYm9keS5yZXBsYWNlKC8obT1bXlxyXSpcclxuKS9nLCAnJDFhPXNlbmRvbmx5XHJcbicpOwogICAgICB9IGVsc2UgewogICAgICAgIGJvZHkgPSBib2R5LnJlcGxhY2UoL2E9c2VuZHJlY3ZcclxuL2csICdhPXNlbmRvbmx5XHJcbicpOwogICAgICAgIGJvZHkgPSBib2R5LnJlcGxhY2UoL2E9cmVjdm9ubHlcclxuL2csICdhPWluYWN0aXZlXHJcbicpOwogICAgICB9CgogICAgICByZXR1cm4gYm9keTsKICAgIH07CgogICAgdGhpcy5zZW5kUmVpbnZpdGUob3B0aW9ucyk7CiAgfSwKCiAgLyoqCiAgICogVW5ob2xkCiAgICovCiAgdW5ob2xkOiBmdW5jdGlvbihvcHRpb25zKSB7CgogICAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0sgJiYgdGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogICAgfQoKICAgIHRoaXMubWVkaWFIYW5kbGVyLnVuaG9sZCgpOwoKICAgIGlmICghdGhpcy5pc1JlYWR5VG9SZWludml0ZSgpKSB7CiAgICAgIC8qIElmIHRoZXJlIGlzIGEgcGVuZGluZyAnaG9sZCcgYWN0aW9uLCBjYW5jZWwgaXQgYW5kIGRvbid0IHF1ZXVlIHRoaXMgb25lCiAgICAgICAqIEVsc2UsIGlmIHRoZXJlIGlzbid0IGFueSAndW5ob2xkJyBhY3Rpb24sIGFkZCB0aGlzIG9uZSB0byB0aGUgcXVldWUKICAgICAgICogRWxzZSwgaWYgdGhlcmUgaXMgYWxyZWFkeSBhICd1bmhvbGQnIGFjdGlvbiwgc2tpcAogICAgICAgKi8KICAgICAgaWYgKHRoaXMucGVuZGluZ19hY3Rpb25zLmlzUGVuZGluZygnaG9sZCcpKSB7CiAgICAgICAgdGhpcy5wZW5kaW5nX2FjdGlvbnMucG9wKCdob2xkJyk7CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMucGVuZGluZ19hY3Rpb25zLmlzUGVuZGluZygndW5ob2xkJykpIHsKICAgICAgICB0aGlzLnBlbmRpbmdfYWN0aW9ucy5wdXNoKCd1bmhvbGQnKTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9IGVsc2UgaWYgKHRoaXMubG9jYWxfaG9sZCA9PT0gZmFsc2UpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMub251bmhvbGQoJ2xvY2FsJyk7CgogICAgdGhpcy5zZW5kUmVpbnZpdGUob3B0aW9ucyk7CiAgfSwKCiAgLyoqCiAgICogaXNPbkhvbGQKICAgKi8KICBpc09uSG9sZDogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gewogICAgICBsb2NhbDogdGhpcy5sb2NhbF9ob2xkLAogICAgICByZW1vdGU6IHRoaXMucmVtb3RlX2hvbGQKICAgIH07CiAgfSwKCiAgLyoqCiAgICogSW4gZGlhbG9nIElOVklURSBSZWNlcHRpb24KICAgKiBAcHJpdmF0ZQogICAqLwogIHJlY2VpdmVSZWludml0ZTogZnVuY3Rpb24ocmVxdWVzdCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgIGlmICghcmVxdWVzdC5ib2R5KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAocmVxdWVzdC5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpICE9PSAnYXBwbGljYXRpb24vc2RwJykgewogICAgICB0aGlzLmxvZ2dlci53YXJuKCdpbnZhbGlkIENvbnRlbnQtVHlwZScpOwogICAgICByZXF1ZXN0LnJlcGx5KDQxNSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLm1lZGlhSGFuZGxlci5zZXREZXNjcmlwdGlvbihyZXF1ZXN0LmJvZHkpCiAgICAudGhlbih0aGlzLm1lZGlhSGFuZGxlci5nZXREZXNjcmlwdGlvbi5iaW5kKHRoaXMubWVkaWFIYW5kbGVyLCB0aGlzLm1lZGlhSGludCkpCiAgICAudGhlbihmdW5jdGlvbihib2R5KSB7CiAgICAgIHJlcXVlc3QucmVwbHkoMjAwLCBudWxsLCBbJ0NvbnRhY3Q6ICcgKyBzZWxmLmNvbnRhY3RdLCBib2R5LAogICAgICAgIGZ1bmN0aW9uKCkgewogICAgICAgICAgc2VsZi5zdGF0dXMgPSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0s7CiAgICAgICAgICBzZWxmLnNldEludml0ZTJ4eFRpbWVyKHJlcXVlc3QsIGJvZHkpOwogICAgICAgICAgc2VsZi5zZXRBQ0tUaW1lcigpOwoKICAgICAgICAgIC8vIEFyZSB3ZSBob2xkaW5nPwogICAgICAgICAgdmFyIGhvbGQgPSAoL2E9KHNlbmRvbmx5fGluYWN0aXZlKS8pLnRlc3QocmVxdWVzdC5ib2R5KTsKCiAgICAgICAgICBpZiAoc2VsZi5yZW1vdGVfaG9sZCAmJiAhaG9sZCkgewogICAgICAgICAgICBzZWxmLm9udW5ob2xkKCdyZW1vdGUnKTsKICAgICAgICAgIH0gZWxzZSBpZiAoIXNlbGYucmVtb3RlX2hvbGQgJiYgaG9sZCkgewogICAgICAgICAgICBzZWxmLm9uaG9sZCgncmVtb3RlJyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9KQogICAgLmNhdGNoKGZ1bmN0aW9uIG9uRmFpbHVyZSAoZSkgewogICAgICB2YXIgc3RhdHVzQ29kZTsKICAgICAgaWYgKGUgaW5zdGFuY2VvZiBTSVAuRXhjZXB0aW9ucy5HZXREZXNjcmlwdGlvbkVycm9yKSB7CiAgICAgICAgc3RhdHVzQ29kZSA9IDUwMDsKICAgICAgfSBlbHNlIHsKICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcihlKTsKICAgICAgICBzdGF0dXNDb2RlID0gNDg4OwogICAgICB9CiAgICAgIHJlcXVlc3QucmVwbHkoc3RhdHVzQ29kZSk7CiAgICB9KTsKICB9LAoKICBzZW5kUmVpbnZpdGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIHZhcgogICAgICBzZWxmID0gdGhpcywKICAgICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgICBldmVudEhhbmRsZXJzID0gb3B0aW9ucy5ldmVudEhhbmRsZXJzIHx8IHt9LAogICAgICBtYW5nbGUgPSBvcHRpb25zLm1hbmdsZSB8fCBudWxsLAogICAgICBzdWNjZWVkZWQ7CgogICAgaWYgKGV2ZW50SGFuZGxlcnMuc3VjY2VlZGVkKSB7CiAgICAgIHN1Y2NlZWRlZCA9IGV2ZW50SGFuZGxlcnMuc3VjY2VlZGVkOwogICAgfQogICAgdGhpcy5yZWludml0ZVN1Y2NlZWRlZCA9IGZ1bmN0aW9uKCl7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHNlbGYudGltZXJzLmFja1RpbWVyKTsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQoc2VsZi50aW1lcnMuaW52aXRlMnh4VGltZXIpOwogICAgICBzZWxmLnN0YXR1cyA9IEMuU1RBVFVTX0NPTkZJUk1FRDsKICAgICAgc3VjY2VlZGVkICYmIHN1Y2NlZWRlZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfTsKICAgIGlmIChldmVudEhhbmRsZXJzLmZhaWxlZCkgewogICAgICB0aGlzLnJlaW52aXRlRmFpbGVkID0gZXZlbnRIYW5kbGVycy5mYWlsZWQ7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnJlaW52aXRlRmFpbGVkID0gZnVuY3Rpb24oKXt9OwogICAgfQoKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250YWN0OiAnICsgdGhpcy5jb250YWN0KTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdBbGxvdzogJysgU0lQLlVBLkMuQUxMT1dFRF9NRVRIT0RTLnRvU3RyaW5nKCkpOwogICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vc2RwJyk7CgogICAgdGhpcy5yZWNlaXZlUmVzcG9uc2UgPSB0aGlzLnJlY2VpdmVSZWludml0ZVJlc3BvbnNlOwogICAgLy9SRVZJU0lUCiAgICB0aGlzLm1lZGlhSGFuZGxlci5nZXREZXNjcmlwdGlvbihzZWxmLm1lZGlhSGludCkKICAgIC50aGVuKG1hbmdsZSkKICAgIC50aGVuKAogICAgICBmdW5jdGlvbihib2R5KXsKICAgICAgICBzZWxmLmRpYWxvZy5zZW5kUmVxdWVzdChzZWxmLCBTSVAuQy5JTlZJVEUsIHsKICAgICAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzLAogICAgICAgICAgYm9keTogYm9keQogICAgICAgIH0pOwogICAgICB9LAogICAgICBmdW5jdGlvbigpIHsKICAgICAgICBpZiAoc2VsZi5pc1JlYWR5VG9SZWludml0ZSgpKSB7CiAgICAgICAgICBzZWxmLm9uUmVhZHlUb1JlaW52aXRlKCk7CiAgICAgICAgfQogICAgICAgIHNlbGYucmVpbnZpdGVGYWlsZWQoKTsKICAgICAgfQogICAgKTsKICB9LAoKICByZWNlaXZlUmVxdWVzdDogZnVuY3Rpb24gKHJlcXVlc3QpIHsKICAgIHN3aXRjaCAocmVxdWVzdC5tZXRob2QpIHsKICAgICAgY2FzZSBTSVAuQy5CWUU6CiAgICAgICAgcmVxdWVzdC5yZXBseSgyMDApOwogICAgICAgIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgICAgIHRoaXMuZW1pdCgnYnllJywgcmVxdWVzdCk7CiAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkJZRSk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIFNJUC5DLklOVklURToKICAgICAgICBpZih0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ3JlLUlOVklURSByZWNlaXZlZCcpOwogICAgICAgICAgdGhpcy5yZWNlaXZlUmVpbnZpdGUocmVxdWVzdCk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIFNJUC5DLklORk86CiAgICAgICAgaWYodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLKSB7CiAgICAgICAgICB2YXIgYm9keSwgdG9uZSwgZHVyYXRpb24sCiAgICAgICAgICAgICAgY29udGVudFR5cGUgPSByZXF1ZXN0LmdldEhlYWRlcignY29udGVudC10eXBlJyksCiAgICAgICAgICAgICAgcmVnX3RvbmUgPSAvXihTaWduYWxccyo/PVxzKj8pKFswLTlBLUQjKl17MX0pKFxzKT8uKi8sCiAgICAgICAgICAgICAgcmVnX2R1cmF0aW9uID0gL14oRHVyYXRpb25ccz89XHM/KShbMC05XXsxLDR9KShccyk/LiovOwoKICAgICAgICAgIGlmIChjb250ZW50VHlwZSkgewogICAgICAgICAgICBpZiAoY29udGVudFR5cGUubWF0Y2goL15hcHBsaWNhdGlvblwvZHRtZi1yZWxheS9pKSkgewogICAgICAgICAgICAgIGlmIChyZXF1ZXN0LmJvZHkpIHsKICAgICAgICAgICAgICAgIGJvZHkgPSByZXF1ZXN0LmJvZHkuc3BsaXQoJ1xyXG4nLCAyKTsKICAgICAgICAgICAgICAgIGlmIChib2R5Lmxlbmd0aCA9PT0gMikgewogICAgICAgICAgICAgICAgICBpZiAocmVnX3RvbmUudGVzdChib2R5WzBdKSkgewogICAgICAgICAgICAgICAgICAgIHRvbmUgPSBib2R5WzBdLnJlcGxhY2UocmVnX3RvbmUsIiQyIik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgaWYgKHJlZ19kdXJhdGlvbi50ZXN0KGJvZHlbMV0pKSB7CiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb24gPSBwYXJzZUludChib2R5WzFdLnJlcGxhY2UocmVnX2R1cmF0aW9uLCIkMiIpLCAxMCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIG5ldyBEVE1GKHRoaXMsIHRvbmUsIHtkdXJhdGlvbjogZHVyYXRpb259KS5pbml0X2luY29taW5nKHJlcXVlc3QpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJlcXVlc3QucmVwbHkoNDE1LCBudWxsLCBbIkFjY2VwdDogYXBwbGljYXRpb24vZHRtZi1yZWxheSJdKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBTSVAuQy5SRUZFUjoKICAgICAgICBpZih0aGlzLnN0YXR1cyA9PT0gIEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICAgICAgdGhpcy5sb2dnZXIubG9nKCdSRUZFUiByZWNlaXZlZCcpOwogICAgICAgICAgdmFyIGhhc1JlZmVyTGlzdGVuZXIgPSB0aGlzLmxpc3RlbmVycygncmVmZXInKS5sZW5ndGgsCiAgICAgICAgICAgICAgbm90aWZ5Qm9keTsKCiAgICAgICAgICBpZiAoaGFzUmVmZXJMaXN0ZW5lcikgewogICAgICAgICAgICByZXF1ZXN0LnJlcGx5KDIwMiwgJ0FjY2VwdGVkJyk7CiAgICAgICAgICAgIG5vdGlmeUJvZHkgPSAnU0lQLzIuMCAxMDAgVHJ5aW5nJzsKCiAgICAgICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuTk9USUZZLCB7CiAgICAgICAgICAgICAgZXh0cmFIZWFkZXJzOlsKICAgICAgICAgICAgICAgICdFdmVudDogcmVmZXInLAogICAgICAgICAgICAgICAgJ1N1YnNjcmlwdGlvbi1TdGF0ZTogdGVybWluYXRlZCcsCiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlOiBtZXNzYWdlL3NpcGZyYWcnCiAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICBib2R5OiBub3RpZnlCb2R5LAogICAgICAgICAgICAgIHJlY2VpdmVSZXNwb25zZTogZnVuY3Rpb24oKSB7fQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHRoaXMuZW1pdCgncmVmZXInLCByZXF1ZXN0KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFJGQyAzNTE1LjIuNC4yOiAndGhlIFVBIE1BWSBkZWNsaW5lIHRoZSByZXF1ZXN0LicKICAgICAgICAgICAgcmVxdWVzdC5yZXBseSg2MDMsICdEZWNsaW5lZCcpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBTSVAuQy5OT1RJRlk6CiAgICAgICAgcmVxdWVzdC5yZXBseSgyMDAsICdPSycpOwogICAgICAgIHRoaXMuZW1pdCgnbm90aWZ5JywgcmVxdWVzdCk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogUmVjZXB0aW9uIG9mIFJlc3BvbnNlIGZvciBpbi1kaWFsb2cgSU5WSVRFCiAgICogQHByaXZhdGUKICAgKi8KICByZWNlaXZlUmVpbnZpdGVSZXNwb25zZTogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgICBjb250ZW50VHlwZSA9IHJlc3BvbnNlLmdldEhlYWRlcignQ29udGVudC1UeXBlJyk7CgogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzd2l0Y2godHJ1ZSkgewogICAgICBjYXNlIC9eMVswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgL14yWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0NPTkZJUk1FRDsKCiAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChTSVAuQy5BQ0sse2NzZXE6cmVzcG9uc2UuY3NlcX0pOwoKICAgICAgICBpZighcmVzcG9uc2UuYm9keSkgewogICAgICAgICAgdGhpcy5yZWludml0ZUZhaWxlZCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfSBlbHNlIGlmIChjb250ZW50VHlwZSAhPT0gJ2FwcGxpY2F0aW9uL3NkcCcpIHsKICAgICAgICAgIHRoaXMucmVpbnZpdGVGYWlsZWQoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgLy9SRVZJU0lUCiAgICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuc2V0RGVzY3JpcHRpb24ocmVzcG9uc2UuYm9keSkKICAgICAgICAudGhlbigKICAgICAgICAgIGZ1bmN0aW9uIG9uU3VjY2VzcyAoKSB7CiAgICAgICAgICAgIHNlbGYucmVpbnZpdGVTdWNjZWVkZWQoKTsKICAgICAgICAgIH0sCiAgICAgICAgICBmdW5jdGlvbiBvbkZhaWx1cmUgKCkgewogICAgICAgICAgICBzZWxmLnJlaW52aXRlRmFpbGVkKCk7CiAgICAgICAgICB9CiAgICAgICAgKTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICB0aGlzLnJlaW52aXRlRmFpbGVkKCk7CiAgICB9CiAgfSwKCiAgYWNjZXB0QW5kVGVybWluYXRlOiBmdW5jdGlvbihyZXNwb25zZSwgc3RhdHVzX2NvZGUsIHJlYXNvbl9waHJhc2UpIHsKICAgIHZhciBleHRyYUhlYWRlcnMgPSBbXTsKCiAgICBpZiAoc3RhdHVzX2NvZGUpIHsKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JlYXNvbjogJyArIFNJUC5VdGlscy5nZXRSZWFzb25IZWFkZXJWYWx1ZShzdGF0dXNfY29kZSwgcmVhc29uX3BocmFzZSkpOwogICAgfQoKICAgIC8vIEFuIGVycm9yIG9uIGRpYWxvZyBjcmVhdGlvbiB3aWxsIGZpcmUgJ2ZhaWxlZCcgZXZlbnQKICAgIGlmICh0aGlzLmRpYWxvZyB8fCB0aGlzLmNyZWF0ZURpYWxvZyhyZXNwb25zZSwgJ1VBQycpKSB7CiAgICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuQUNLLHtjc2VxOiByZXNwb25zZS5jc2VxfSk7CiAgICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuQllFLCB7CiAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICogUkZDMzI2MSAxMy4zLjEuNAogICAqIFJlc3BvbnNlIHJldHJhbnNtaXNzaW9ucyBjYW5ub3QgYmUgYWNjb21wbGlzaGVkIGJ5IHRyYW5zYWN0aW9uIGxheWVyCiAgICogIHNpbmNlIGl0IGlzIGRlc3Ryb3llZCB3aGVuIHJlY2VpdmluZyB0aGUgZmlyc3QgMnh4IGFuc3dlcgogICAqLwogIHNldEludml0ZTJ4eFRpbWVyOiBmdW5jdGlvbihyZXF1ZXN0LCBib2R5KSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgICAgdGltZW91dCA9IFNJUC5UaW1lcnMuVDE7CgogICAgdGhpcy50aW1lcnMuaW52aXRlMnh4VGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24gaW52aXRlMnh4UmV0cmFuc21pc3Npb24oKSB7CiAgICAgIGlmIChzZWxmLnN0YXR1cyAhPT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBzZWxmLmxvZ2dlci5sb2coJ25vIEFDSyByZWNlaXZlZCwgYXR0ZW1wdGluZyB0byByZXRyYW5zbWl0IE9LJyk7CgogICAgICByZXF1ZXN0LnJlcGx5KDIwMCwgbnVsbCwgWydDb250YWN0OiAnICsgc2VsZi5jb250YWN0XSwgYm9keSk7CgogICAgICB0aW1lb3V0ID0gTWF0aC5taW4odGltZW91dCAqIDIsIFNJUC5UaW1lcnMuVDIpOwoKICAgICAgc2VsZi50aW1lcnMuaW52aXRlMnh4VGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoaW52aXRlMnh4UmV0cmFuc21pc3Npb24sIHRpbWVvdXQpOwogICAgfSwgdGltZW91dCk7CiAgfSwKCiAgLyoqCiAgICogUkZDMzI2MSAxNC4yCiAgICogSWYgYSBVQVMgZ2VuZXJhdGVzIGEgMnh4IHJlc3BvbnNlIGFuZCBuZXZlciByZWNlaXZlcyBhbiBBQ0ssCiAgICogIGl0IFNIT1VMRCBnZW5lcmF0ZSBhIEJZRSB0byB0ZXJtaW5hdGUgdGhlIGRpYWxvZy4KICAgKi8KICBzZXRBQ0tUaW1lcjogZnVuY3Rpb24oKSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgdGhpcy50aW1lcnMuYWNrVGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgIGlmKHNlbGYuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0spIHsKICAgICAgICBzZWxmLmxvZ2dlci5sb2coJ25vIEFDSyByZWNlaXZlZCBmb3IgYW4gZXh0ZW5kZWQgcGVyaW9kIG9mIHRpbWUsIHRlcm1pbmF0aW5nIHRoZSBjYWxsJyk7CiAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQoc2VsZi50aW1lcnMuaW52aXRlMnh4VGltZXIpOwogICAgICAgIHNlbGYuc2VuZFJlcXVlc3QoU0lQLkMuQllFKTsKICAgICAgICBzZWxmLnRlcm1pbmF0ZWQobnVsbCwgU0lQLkMuY2F1c2VzLk5PX0FDSyk7CiAgICAgIH0KICAgIH0sIFNJUC5UaW1lcnMuVElNRVJfSCk7CiAgfSwKCiAgLyoKICAgKiBAcHJpdmF0ZQogICAqLwogIG9uUmVhZHlUb1JlaW52aXRlOiBmdW5jdGlvbigpIHsKICAgIHZhciBhY3Rpb24gPSB0aGlzLnBlbmRpbmdfYWN0aW9ucy5zaGlmdCgpOwoKICAgIGlmICghYWN0aW9uIHx8ICF0aGlzW2FjdGlvbi5uYW1lXSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpc1thY3Rpb24ubmFtZV0oKTsKICB9LAoKICBvblRyYW5zcG9ydEVycm9yOiBmdW5jdGlvbigpIHsKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQ09ORklSTUVEICYmIHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgIH0KICB9LAoKICBvblJlcXVlc3RUaW1lb3V0OiBmdW5jdGlvbigpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5mYWlsZWQobnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH0KICB9LAoKICBvbkRpYWxvZ0Vycm9yOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuRElBTE9HX0VSUk9SKTsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5ESUFMT0dfRVJST1IpOwogICAgICB0aGlzLnRlcm1pbmF0ZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5ESUFMT0dfRVJST1IpOwogICAgfQogIH0sCgogIC8qKgogICAqIEBwcml2YXRlCiAgICovCiAgb25ob2xkOiBmdW5jdGlvbihvcmlnaW5hdG9yKSB7CiAgICB0aGlzW29yaWdpbmF0b3IgPT09ICdsb2NhbCcgPyAnbG9jYWxfaG9sZCcgOiAncmVtb3RlX2hvbGQnXSA9IHRydWU7CiAgICB0aGlzLmVtaXQoJ2hvbGQnLCB7IG9yaWdpbmF0b3I6IG9yaWdpbmF0b3IgfSk7CiAgfSwKCiAgLyoqCiAgICogQHByaXZhdGUKICAgKi8KICBvbnVuaG9sZDogZnVuY3Rpb24ob3JpZ2luYXRvcikgewogICAgdGhpc1tvcmlnaW5hdG9yID09PSAnbG9jYWwnID8gJ2xvY2FsX2hvbGQnIDogJ3JlbW90ZV9ob2xkJ10gPSBmYWxzZTsKICAgIHRoaXMuZW1pdCgndW5ob2xkJywgeyBvcmlnaW5hdG9yOiBvcmlnaW5hdG9yIH0pOwogIH0sCgogIC8qCiAgICogQHByaXZhdGUKICAgKi8KICBvbm11dGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIHRoaXMuZW1pdCgnbXV0ZWQnLCB7CiAgICAgIGF1ZGlvOiBvcHRpb25zLmF1ZGlvLAogICAgICB2aWRlbzogb3B0aW9ucy52aWRlbwogICAgfSk7CiAgfSwKCiAgLyoKICAgKiBAcHJpdmF0ZQogICAqLwogIG9udW5tdXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICB0aGlzLmVtaXQoJ3VubXV0ZWQnLCB7CiAgICAgIGF1ZGlvOiBvcHRpb25zLmF1ZGlvLAogICAgICB2aWRlbzogb3B0aW9ucy52aWRlbwogICAgfSk7CiAgfSwKCiAgZmFpbGVkOiBmdW5jdGlvbihyZXNwb25zZSwgY2F1c2UpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIHRoaXMuZW1pdCgnZmFpbGVkJywgcmVzcG9uc2UgfHwgbnVsbCwgY2F1c2UgfHwgbnVsbCk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICByZWplY3RlZDogZnVuY3Rpb24ocmVzcG9uc2UsIGNhdXNlKSB7CiAgICB0aGlzLmVtaXQoJ3JlamVjdGVkJywKICAgICAgcmVzcG9uc2UgfHwgbnVsbCwKICAgICAgY2F1c2UgfHwgbnVsbAogICAgKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIGNhbmNlbGVkOiBmdW5jdGlvbigpIHsKICAgIHRoaXMuZW1pdCgnY2FuY2VsJyk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBhY2NlcHRlZDogZnVuY3Rpb24ocmVzcG9uc2UsIGNhdXNlKSB7CiAgICBjYXVzZSA9IFNJUC5VdGlscy5nZXRSZWFzb25QaHJhc2UocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUsIGNhdXNlKTsKCiAgICB0aGlzLnN0YXJ0VGltZSA9IG5ldyBEYXRlKCk7CgogICAgaWYgKHRoaXMucmVwbGFjZWUpIHsKICAgICAgdGhpcy5yZXBsYWNlZS5lbWl0KCdyZXBsYWNlZCcsIHRoaXMpOwogICAgICB0aGlzLnJlcGxhY2VlLnRlcm1pbmF0ZSgpOwogICAgfQogICAgdGhpcy5lbWl0KCdhY2NlcHRlZCcsIHJlc3BvbnNlLCBjYXVzZSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICB0ZXJtaW5hdGVkOiBmdW5jdGlvbihtZXNzYWdlLCBjYXVzZSkgewogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHRoaXMuZW5kVGltZSA9IG5ldyBEYXRlKCk7CgogICAgdGhpcy5jbG9zZSgpOwogICAgdGhpcy5lbWl0KCd0ZXJtaW5hdGVkJywKICAgICAgbWVzc2FnZSB8fCBudWxsLAogICAgICBjYXVzZSB8fCBudWxsCiAgICApOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgY29ubmVjdGluZzogZnVuY3Rpb24ocmVxdWVzdCkgewogICAgdGhpcy5lbWl0KCdjb25uZWN0aW5nJywgeyByZXF1ZXN0OiByZXF1ZXN0IH0pOwogICAgcmV0dXJuIHRoaXM7CiAgfQp9OwoKU2Vzc2lvbi5kZXN1Z2FyID0gZnVuY3Rpb24gZGVzdWdhcihvcHRpb25zKSB7CiAgaWYgKGVudmlyb25tZW50LkhUTUxNZWRpYUVsZW1lbnQgJiYgb3B0aW9ucyBpbnN0YW5jZW9mIGVudmlyb25tZW50LkhUTUxNZWRpYUVsZW1lbnQpIHsKICAgIG9wdGlvbnMgPSB7CiAgICAgIG1lZGlhOiB7CiAgICAgICAgY29uc3RyYWludHM6IHsKICAgICAgICAgIGF1ZGlvOiB0cnVlLAogICAgICAgICAgdmlkZW86IG9wdGlvbnMudGFnTmFtZSA9PT0gJ1ZJREVPJwogICAgICAgIH0sCiAgICAgICAgcmVuZGVyOiB7CiAgICAgICAgICByZW1vdGU6IG9wdGlvbnMKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfQogIHJldHVybiBvcHRpb25zIHx8IHt9Owp9OwoKClNlc3Npb24uQyA9IEM7ClNJUC5TZXNzaW9uID0gU2Vzc2lvbjsKCgpJbnZpdGVTZXJ2ZXJDb250ZXh0ID0gZnVuY3Rpb24odWEsIHJlcXVlc3QpIHsKICB2YXIgZXhwaXJlcywKICAgIHNlbGYgPSB0aGlzLAogICAgY29udGVudFR5cGUgPSByZXF1ZXN0LmdldEhlYWRlcignQ29udGVudC1UeXBlJyksCiAgICBjb250ZW50RGlzcCA9IHJlcXVlc3QucGFyc2VIZWFkZXIoJ0NvbnRlbnQtRGlzcG9zaXRpb24nKTsKCiAgLy8gQ2hlY2sgYm9keSBhbmQgY29udGVudCB0eXBlCiAgaWYgKCghY29udGVudERpc3AgJiYgY29udGVudFR5cGUgIT09ICdhcHBsaWNhdGlvbi9zZHAnKSB8fCAoY29udGVudERpc3AgJiYgY29udGVudERpc3AudHlwZSA9PT0gJ3JlbmRlcicpKSB7CiAgICB0aGlzLnJlbmRlcmJvZHkgPSByZXF1ZXN0LmJvZHk7CiAgICB0aGlzLnJlbmRlcnR5cGUgPSBjb250ZW50VHlwZTsKICB9IGVsc2UgaWYgKGNvbnRlbnRUeXBlICE9PSAnYXBwbGljYXRpb24vc2RwJyAmJiAoY29udGVudERpc3AgJiYgY29udGVudERpc3AudHlwZSA9PT0gJ3Nlc3Npb24nKSkgewogICAgcmVxdWVzdC5yZXBseSg0MTUpOwogICAgLy9UT0RPOiBpbnN0ZWFkIG9mIDQxNSwgcGFzcyBvZmYgdG8gdGhlIG1lZGlhIGhhbmRsZXIsIHdobyBjYW4gdGhlbiBkZWNpZGUgaWYgd2UgY2FuIHVzZSBpdAogICAgcmV0dXJuOwogIH0KCiAgLy9UT0RPOiBtb3ZlIHRoaXMgaW50byBtZWRpYSBoYW5kbGVyCiAgU0lQLkhhY2tzLkZpcmVmb3guY2Fubm90SGFuZGxlRXh0cmFXaGl0ZXNwYWNlKHJlcXVlc3QpOwogIFNJUC5IYWNrcy5BbGxCcm93c2Vycy5tYXNrRHRscyhyZXF1ZXN0KTsKCiAgU0lQLlV0aWxzLmF1Z21lbnQodGhpcywgU0lQLlNlcnZlckNvbnRleHQsIFt1YSwgcmVxdWVzdF0pOwogIFNJUC5VdGlscy5hdWdtZW50KHRoaXMsIFNJUC5TZXNzaW9uLCBbdWEuY29uZmlndXJhdGlvbi5tZWRpYUhhbmRsZXJGYWN0b3J5XSk7CgogIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfSU5WSVRFX1JFQ0VJVkVEOwogIHRoaXMuZnJvbV90YWcgPSByZXF1ZXN0LmZyb21fdGFnOwogIHRoaXMuaWQgPSByZXF1ZXN0LmNhbGxfaWQgKyB0aGlzLmZyb21fdGFnOwogIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7CiAgdGhpcy5jb250YWN0ID0gdGhpcy51YS5jb250YWN0LnRvU3RyaW5nKCk7CgogIHRoaXMucmVjZWl2ZU5vbkludml0ZVJlc3BvbnNlID0gZnVuY3Rpb24gKCkge307IC8vIGludGVudGlvbmFsIG5vLW9wCgogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAuaW52aXRlc2VydmVyY29udGV4dCcsIHRoaXMuaWQpOwoKICAvL1NhdmUgdGhlIHNlc3Npb24gaW50byB0aGUgdWEgc2Vzc2lvbnMgY29sbGVjdGlvbi4KICB0aGlzLnVhLnNlc3Npb25zW3RoaXMuaWRdID0gdGhpczsKCiAgLy9HZXQgdGhlIEV4cGlyZXMgaGVhZGVyIHZhbHVlIGlmIGV4aXN0cwogIGlmKHJlcXVlc3QuaGFzSGVhZGVyKCdleHBpcmVzJykpIHsKICAgIGV4cGlyZXMgPSByZXF1ZXN0LmdldEhlYWRlcignZXhwaXJlcycpICogMTAwMDsKICB9CgogIC8vU2V0IDEwMHJlbCBpZiBuZWNlc3NhcnkKICBmdW5jdGlvbiBzZXQxMDByZWwoaCxjKSB7CiAgICBpZiAocmVxdWVzdC5oYXNIZWFkZXIoaCkgJiYgcmVxdWVzdC5nZXRIZWFkZXIoaCkudG9Mb3dlckNhc2UoKS5pbmRleE9mKCcxMDByZWwnKSA+PSAwKSB7CiAgICAgIHNlbGYucmVsMTAwID0gYzsKICAgIH0KICB9CiAgc2V0MTAwcmVsKCdyZXF1aXJlJywgU0lQLkMuc3VwcG9ydGVkLlJFUVVJUkVEKTsKICBzZXQxMDByZWwoJ3N1cHBvcnRlZCcsIFNJUC5DLnN1cHBvcnRlZC5TVVBQT1JURUQpOwoKICAvKiBTZXQgdGhlIHRvX3RhZyBiZWZvcmUKICAgKiByZXBseWluZyBhIHJlc3BvbnNlIGNvZGUgdGhhdCB3aWxsIGNyZWF0ZSBhIGRpYWxvZy4KICAgKi8KICByZXF1ZXN0LnRvX3RhZyA9IFNJUC5VdGlscy5uZXdUYWcoKTsKCiAgLy8gQW4gZXJyb3Igb24gZGlhbG9nIGNyZWF0aW9uIHdpbGwgZmlyZSAnZmFpbGVkJyBldmVudAogIGlmKCF0aGlzLmNyZWF0ZURpYWxvZyhyZXF1ZXN0LCAnVUFTJywgdHJ1ZSkpIHsKICAgIHJlcXVlc3QucmVwbHkoNTAwLCAnTWlzc2luZyBDb250YWN0IGhlYWRlciBmaWVsZCcpOwogICAgcmV0dXJuOwogIH0KCiAgLy9Jbml0aWFsaXplIE1lZGlhIFNlc3Npb24KICB0aGlzLm1lZGlhSGFuZGxlciA9IHRoaXMubWVkaWFIYW5kbGVyRmFjdG9yeSh0aGlzLCB7CiAgICBSVENDb25zdHJhaW50czogeyJvcHRpb25hbCI6IFt7J0R0bHNTcnRwS2V5QWdyZWVtZW50JzogJ3RydWUnfV19CiAgfSk7CgogIGlmICh0aGlzLm1lZGlhSGFuZGxlciAmJiB0aGlzLm1lZGlhSGFuZGxlci5nZXRSZW1vdGVTdHJlYW1zKSB7CiAgICB0aGlzLmdldFJlbW90ZVN0cmVhbXMgPSB0aGlzLm1lZGlhSGFuZGxlci5nZXRSZW1vdGVTdHJlYW1zLmJpbmQodGhpcy5tZWRpYUhhbmRsZXIpOwogICAgdGhpcy5nZXRMb2NhbFN0cmVhbXMgPSB0aGlzLm1lZGlhSGFuZGxlci5nZXRMb2NhbFN0cmVhbXMuYmluZCh0aGlzLm1lZGlhSGFuZGxlcik7CiAgfQoKICBmdW5jdGlvbiBmaXJlTmV3U2Vzc2lvbigpIHsKICAgIHZhciBvcHRpb25zID0ge2V4dHJhSGVhZGVyczogWydDb250YWN0OiAnICsgc2VsZi5jb250YWN0XX07CgogICAgaWYgKHNlbGYucmVsMTAwICE9PSBTSVAuQy5zdXBwb3J0ZWQuUkVRVUlSRUQpIHsKICAgICAgc2VsZi5wcm9ncmVzcyhvcHRpb25zKTsKICAgIH0KICAgIHNlbGYuc3RhdHVzID0gQy5TVEFUVVNfV0FJVElOR19GT1JfQU5TV0VSOwoKICAgIC8vIFNldCB1c2VyTm9BbnN3ZXJUaW1lcgogICAgc2VsZi50aW1lcnMudXNlck5vQW5zd2VyVGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgIHJlcXVlc3QucmVwbHkoNDA4KTsKICAgICAgc2VsZi5mYWlsZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLk5PX0FOU1dFUik7CiAgICAgIHNlbGYudGVybWluYXRlZChyZXF1ZXN0LCBTSVAuQy5jYXVzZXMuTk9fQU5TV0VSKTsKICAgIH0sIHNlbGYudWEuY29uZmlndXJhdGlvbi5ub0Fuc3dlclRpbWVvdXQpOwoKICAgIC8qIFNldCBleHBpcmVzVGltZXIKICAgICAqIFJGQzMyNjEgMTMuMy4xCiAgICAgKi8KICAgIGlmIChleHBpcmVzKSB7CiAgICAgIHNlbGYudGltZXJzLmV4cGlyZXNUaW1lciA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICBpZihzZWxmLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQU5TV0VSKSB7CiAgICAgICAgICByZXF1ZXN0LnJlcGx5KDQ4Nyk7CiAgICAgICAgICBzZWxmLmZhaWxlZChyZXF1ZXN0LCBTSVAuQy5jYXVzZXMuRVhQSVJFUyk7CiAgICAgICAgICBzZWxmLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkVYUElSRVMpOwogICAgICAgIH0KICAgICAgfSwgZXhwaXJlcyk7CiAgICB9CgogICAgc2VsZi5lbWl0KCdpbnZpdGUnLHJlcXVlc3QpOwogIH0KCiAgaWYgKCFyZXF1ZXN0LmJvZHkgfHwgdGhpcy5yZW5kZXJib2R5KSB7CiAgICBTSVAuVGltZXJzLnNldFRpbWVvdXQoZmlyZU5ld1Nlc3Npb24sIDApOwogIH0gZWxzZSB7CiAgICB0aGlzLmhhc09mZmVyID0gdHJ1ZTsKICAgIHRoaXMubWVkaWFIYW5kbGVyLnNldERlc2NyaXB0aW9uKHJlcXVlc3QuYm9keSkKICAgIC50aGVuKAogICAgICBmaXJlTmV3U2Vzc2lvbiwKICAgICAgZnVuY3Rpb24gb25GYWlsdXJlIChlKSB7CiAgICAgICAgc2VsZi5sb2dnZXIud2FybignaW52YWxpZCBTRFAnKTsKICAgICAgICBzZWxmLmxvZ2dlci53YXJuKGUpOwogICAgICAgIHJlcXVlc3QucmVwbHkoNDg4KTsKICAgICAgfQogICAgKTsKICB9Cn07CgpJbnZpdGVTZXJ2ZXJDb250ZXh0LnByb3RvdHlwZSA9IHsKICByZWplY3Q6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkludmFsaWRTdGF0ZUVycm9yKHRoaXMuc3RhdHVzKTsKICAgIH0KCiAgICB0aGlzLmxvZ2dlci5sb2coJ3JlamVjdGluZyBSVENTZXNzaW9uJyk7CgogICAgU0lQLlNlcnZlckNvbnRleHQucHJvdG90eXBlLnJlamVjdC5jYWxsKHRoaXMsIG9wdGlvbnMpOwogICAgcmV0dXJuIHRoaXMudGVybWluYXRlZCgpOwogIH0sCgogIHRlcm1pbmF0ZTogZnVuY3Rpb24ob3B0aW9ucykgewogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgogICAgdmFyCiAgICBleHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCksCiAgICBib2R5ID0gb3B0aW9ucy5ib2R5LAogICAgZGlhbG9nLAogICAgc2VsZiA9IHRoaXM7CgogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0sgJiYKICAgICAgIHRoaXMucmVxdWVzdC5zZXJ2ZXJfdHJhbnNhY3Rpb24uc3RhdGUgIT09IFNJUC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICBkaWFsb2cgPSB0aGlzLmRpYWxvZzsKCiAgICAgIHRoaXMucmVjZWl2ZVJlcXVlc3QgPSBmdW5jdGlvbihyZXF1ZXN0KSB7CiAgICAgICAgaWYgKHJlcXVlc3QubWV0aG9kID09PSBTSVAuQy5BQ0spIHsKICAgICAgICAgIHRoaXMucmVxdWVzdChTSVAuQy5CWUUsIHsKICAgICAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICAgICAgICAgIGJvZHk6IGJvZHkKICAgICAgICAgIH0pOwogICAgICAgICAgZGlhbG9nLnRlcm1pbmF0ZSgpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHRoaXMucmVxdWVzdC5zZXJ2ZXJfdHJhbnNhY3Rpb24ub24oJ3N0YXRlQ2hhbmdlZCcsIGZ1bmN0aW9uKCl7CiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFNJUC5UcmFuc2FjdGlvbnMuQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICAgICAgdGhpcy5yZXF1ZXN0ID0gbmV3IFNJUC5PdXRnb2luZ1JlcXVlc3QoCiAgICAgICAgICAgIFNJUC5DLkJZRSwKICAgICAgICAgICAgdGhpcy5kaWFsb2cucmVtb3RlX3RhcmdldCwKICAgICAgICAgICAgdGhpcy51YSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICdjc2VxJzogdGhpcy5kaWFsb2cubG9jYWxfc2VxbnVtKz0xLAogICAgICAgICAgICAgICdjYWxsX2lkJzogdGhpcy5kaWFsb2cuaWQuY2FsbF9pZCwKICAgICAgICAgICAgICAnZnJvbV91cmknOiB0aGlzLmRpYWxvZy5sb2NhbF91cmksCiAgICAgICAgICAgICAgJ2Zyb21fdGFnJzogdGhpcy5kaWFsb2cuaWQubG9jYWxfdGFnLAogICAgICAgICAgICAgICd0b191cmknOiB0aGlzLmRpYWxvZy5yZW1vdGVfdXJpLAogICAgICAgICAgICAgICd0b190YWcnOiB0aGlzLmRpYWxvZy5pZC5yZW1vdGVfdGFnLAogICAgICAgICAgICAgICdyb3V0ZV9zZXQnOiB0aGlzLmRpYWxvZy5yb3V0ZV9zZXQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZXh0cmFIZWFkZXJzLAogICAgICAgICAgICBib2R5CiAgICAgICAgICApOwoKICAgICAgICAgIG5ldyBTSVAuUmVxdWVzdFNlbmRlcigKICAgICAgICAgICAgewogICAgICAgICAgICAgIHJlcXVlc3Q6IHRoaXMucmVxdWVzdCwKICAgICAgICAgICAgICBvblJlcXVlc3RUaW1lb3V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHNlbGYub25SZXF1ZXN0VGltZW91dCgpOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgb25UcmFuc3BvcnRFcnJvcjogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICBzZWxmLm9uVHJhbnNwb3J0RXJyb3IoKTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHJlY2VpdmVSZXNwb25zZTogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB0aGlzLnVhCiAgICAgICAgICApLnNlbmQoKTsKICAgICAgICAgIGRpYWxvZy50ZXJtaW5hdGUoKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgdGhpcy5lbWl0KCdieWUnLCB0aGlzLnJlcXVlc3QpOwogICAgICB0aGlzLnRlcm1pbmF0ZWQoKTsKCiAgICAgIC8vIFJlc3RvcmUgdGhlIGRpYWxvZyBpbnRvICd0aGlzJyBpbiBvcmRlciB0byBiZSBhYmxlIHRvIHNlbmQgdGhlIGluLWRpYWxvZyBCWUUgOi0pCiAgICAgIHRoaXMuZGlhbG9nID0gZGlhbG9nOwoKICAgICAgLy8gUmVzdG9yZSB0aGUgZGlhbG9nIGludG8gJ3VhJyBzbyB0aGUgQUNLIGNhbiByZWFjaCAndGhpcycgc2Vzc2lvbgogICAgICB0aGlzLnVhLmRpYWxvZ3NbZGlhbG9nLmlkLnRvU3RyaW5nKCldID0gZGlhbG9nOwoKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aGlzLmJ5ZShvcHRpb25zKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucmVqZWN0KG9wdGlvbnMpOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qCiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLm1lZGlhXSBnZXRzIHBhc3NlZCB0byBTSVAuTWVkaWFIYW5kbGVyLmdldERlc2NyaXB0aW9uIGFzIG1lZGlhSGludAogICAqLwogIHByb2dyZXNzOiBmdW5jdGlvbiAob3B0aW9ucykgewogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgICB2YXIKICAgICAgc3RhdHVzQ29kZSA9IG9wdGlvbnMuc3RhdHVzQ29kZSB8fCAxODAsCiAgICAgIHJlYXNvblBocmFzZSA9IG9wdGlvbnMucmVhc29uUGhyYXNlLAogICAgICBleHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCksCiAgICAgIGljZVNlcnZlcnMsCiAgICAgIHN0dW5TZXJ2ZXJzID0gb3B0aW9ucy5zdHVuU2VydmVycyB8fCBudWxsLAogICAgICB0dXJuU2VydmVycyA9IG9wdGlvbnMudHVyblNlcnZlcnMgfHwgbnVsbCwKICAgICAgYm9keSA9IG9wdGlvbnMuYm9keSwKICAgICAgcmVzcG9uc2U7CgogICAgaWYgKHN0YXR1c0NvZGUgPCAxMDAgfHwgc3RhdHVzQ29kZSA+IDE5OSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHN0YXR1c0NvZGU6ICcgKyBzdGF0dXNDb2RlKTsKICAgIH0KCiAgICBpZiAodGhpcy5pc0NhbmNlbGVkIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIGlmIChzdHVuU2VydmVycyB8fCB0dXJuU2VydmVycykgewogICAgICBpZiAoc3R1blNlcnZlcnMpIHsKICAgICAgICBpY2VTZXJ2ZXJzID0gU0lQLlVBLmNvbmZpZ3VyYXRpb25fY2hlY2sub3B0aW9uYWxbJ3N0dW5TZXJ2ZXJzJ10oc3R1blNlcnZlcnMpOwogICAgICAgIGlmICghaWNlU2VydmVycykgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBzdHVuU2VydmVyczogJysgc3R1blNlcnZlcnMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnN0dW5TZXJ2ZXJzID0gaWNlU2VydmVyczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0dXJuU2VydmVycykgewogICAgICAgIGljZVNlcnZlcnMgPSBTSVAuVUEuY29uZmlndXJhdGlvbl9jaGVjay5vcHRpb25hbFsndHVyblNlcnZlcnMnXSh0dXJuU2VydmVycyk7CiAgICAgICAgaWYgKCFpY2VTZXJ2ZXJzKSB7CiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHR1cm5TZXJ2ZXJzOiAnKyB0dXJuU2VydmVycyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudHVyblNlcnZlcnMgPSBpY2VTZXJ2ZXJzOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5tZWRpYUhhbmRsZXIudXBkYXRlSWNlU2VydmVycyh7CiAgICAgICAgc3R1blNlcnZlcnM6IHRoaXMuc3R1blNlcnZlcnMsCiAgICAgICAgdHVyblNlcnZlcnM6IHRoaXMudHVyblNlcnZlcnMKICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gZG8xMDByZWwoKSB7CiAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi8KICAgICAgc3RhdHVzQ29kZSA9IG9wdGlvbnMuc3RhdHVzQ29kZSB8fCAxODM7CgogICAgICAvLyBTZXQgc3RhdHVzIGFuZCBhZGQgZXh0cmEgaGVhZGVycwogICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLOwogICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJysgdGhpcy5jb250YWN0KTsKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JlcXVpcmU6IDEwMHJlbCcpOwogICAgICBleHRyYUhlYWRlcnMucHVzaCgnUlNlcTogJyArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKSk7CgogICAgICAvLyBTYXZlIG1lZGlhIGhpbnQgZm9yIGxhdGVyIChyZWZlcnJlZCBzZXNzaW9ucykKICAgICAgdGhpcy5tZWRpYUhpbnQgPSBvcHRpb25zLm1lZGlhOwoKICAgICAgLy8gR2V0IHRoZSBzZXNzaW9uIGRlc2NyaXB0aW9uIHRvIGFkZCB0byBwcmVhY2NlcHQgd2l0aAogICAgICB0aGlzLm1lZGlhSGFuZGxlci5nZXREZXNjcmlwdGlvbihvcHRpb25zLm1lZGlhKQogICAgICAudGhlbigKICAgICAgICBmdW5jdGlvbiBvblN1Y2Nlc3MgKGJvZHkpIHsKICAgICAgICAgIGlmICh0aGlzLmlzQ2FuY2VsZWQgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuZWFybHlfc2RwID0gYm9keTsKICAgICAgICAgIHRoaXNbdGhpcy5oYXNPZmZlciA/ICdoYXNBbnN3ZXInIDogJ2hhc09mZmVyJ10gPSB0cnVlOwoKICAgICAgICAgIC8vIFJldHJhbnNtaXQgdW50aWwgd2UgZ2V0IGEgcmVzcG9uc2Ugb3Igd2UgdGltZSBvdXQgKHNlZSBwcmFja1RpbWVyIGJlbG93KQogICAgICAgICAgdmFyIHRpbWVvdXQgPSBTSVAuVGltZXJzLlQxOwogICAgICAgICAgdGhpcy50aW1lcnMucmVsMXh4VGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24gcmVsMXh4UmV0cmFuc21pc3Npb24oKSB7CiAgICAgICAgICAgIHRoaXMucmVxdWVzdC5yZXBseShzdGF0dXNDb2RlLCBudWxsLCBleHRyYUhlYWRlcnMsIGJvZHkpOwogICAgICAgICAgICB0aW1lb3V0ICo9IDI7CiAgICAgICAgICAgIHRoaXMudGltZXJzLnJlbDF4eFRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KHJlbDF4eFJldHJhbnNtaXNzaW9uLmJpbmQodGhpcyksIHRpbWVvdXQpOwogICAgICAgICAgfS5iaW5kKHRoaXMpLCB0aW1lb3V0KTsKCiAgICAgICAgICAvLyBUaW1lb3V0IGFuZCByZWplY3QgSU5WSVRFIGlmIG5vIHJlc3BvbnNlCiAgICAgICAgICB0aGlzLnRpbWVycy5wcmFja1RpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy5sb2dnZXIubG9nKCdubyBQUkFDSyByZWNlaXZlZCwgcmVqZWN0aW5nIHRoZSBjYWxsJyk7CiAgICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnJlbDF4eFRpbWVyKTsKICAgICAgICAgICAgdGhpcy5yZXF1ZXN0LnJlcGx5KDUwNCk7CiAgICAgICAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuTk9fUFJBQ0spOwogICAgICAgICAgfS5iaW5kKHRoaXMpLCBTSVAuVGltZXJzLlQxICogNjQpOwoKICAgICAgICAgIC8vIFNlbmQgdGhlIGluaXRpYWwgcmVzcG9uc2UKICAgICAgICAgIHJlc3BvbnNlID0gdGhpcy5yZXF1ZXN0LnJlcGx5KHN0YXR1c0NvZGUsIHJlYXNvblBocmFzZSwgZXh0cmFIZWFkZXJzLCBib2R5KTsKICAgICAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSwgcmVhc29uUGhyYXNlKTsKICAgICAgICB9LmJpbmQodGhpcyksCgogICAgICAgIGZ1bmN0aW9uIG9uRmFpbHVyZSAoKSB7CiAgICAgICAgICB0aGlzLnJlcXVlc3QucmVwbHkoNDgwKTsKICAgICAgICAgIHRoaXMuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5XRUJSVENfRVJST1IpOwogICAgICAgICAgdGhpcy50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5XRUJSVENfRVJST1IpOwogICAgICAgIH0uYmluZCh0aGlzKQogICAgICApOwogICAgfSAvLyBlbmQgZG8xMDByZWwKCiAgICBmdW5jdGlvbiBub3JtYWxSZXBseSgpIHsKICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovCiAgICAgIHJlc3BvbnNlID0gdGhpcy5yZXF1ZXN0LnJlcGx5KHN0YXR1c0NvZGUsIHJlYXNvblBocmFzZSwgZXh0cmFIZWFkZXJzLCBib2R5KTsKICAgICAgdGhpcy5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlLCByZWFzb25QaHJhc2UpOwogICAgfQoKICAgIGlmIChvcHRpb25zLnN0YXR1c0NvZGUgIT09IDEwMCAmJgogICAgICAgICh0aGlzLnJlbDEwMCA9PT0gU0lQLkMuc3VwcG9ydGVkLlJFUVVJUkVEIHx8CiAgICAgICAgICh0aGlzLnJlbDEwMCA9PT0gU0lQLkMuc3VwcG9ydGVkLlNVUFBPUlRFRCAmJiBvcHRpb25zLnJlbDEwMCkgfHwKICAgICAgICAgKHRoaXMucmVsMTAwID09PSBTSVAuQy5zdXBwb3J0ZWQuU1VQUE9SVEVEICYmICh0aGlzLnVhLmNvbmZpZ3VyYXRpb24ucmVsMTAwID09PSBTSVAuQy5zdXBwb3J0ZWQuUkVRVUlSRUQpKSkpIHsKICAgICAgZG8xMDByZWwuYXBwbHkodGhpcyk7CiAgICB9IGVsc2UgewogICAgICBub3JtYWxSZXBseS5hcHBseSh0aGlzKTsKICAgIH0KICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qCiAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zLm1lZGlhXSBnZXRzIHBhc3NlZCB0byBTSVAuTWVkaWFIYW5kbGVyLmdldERlc2NyaXB0aW9uIGFzIG1lZGlhSGludAogICAqLwogIGFjY2VwdDogZnVuY3Rpb24ob3B0aW9ucykgewogICAgb3B0aW9ucyA9IE9iamVjdC5jcmVhdGUoU2Vzc2lvbi5kZXN1Z2FyKG9wdGlvbnMpKTsKICAgIFNJUC5VdGlscy5vcHRpb25zT3ZlcnJpZGUob3B0aW9ucywgJ21lZGlhJywgJ21lZGlhQ29uc3RyYWludHMnLCB0cnVlLCB0aGlzLmxvZ2dlciwgdGhpcy51YS5jb25maWd1cmF0aW9uLm1lZGlhKTsKICAgIHRoaXMubWVkaWFIaW50ID0gb3B0aW9ucy5tZWRpYTsKCiAgICAvLyBjb21tZW50ZWQgb3V0IG5vdy11bnVzZWQgaG9sZC1yZWxhdGVkIHZhcmlhYmxlcyBmb3IganNoaW50LiBTZWUgYmVsb3cuIEpNRiAyMDE0LTEtMjEKICAgIHZhcgogICAgICAvL2lkeCwgbGVuZ3RoLCBoYXNBdWRpbywgaGFzVmlkZW8sCiAgICAgIHNlbGYgPSB0aGlzLAogICAgICByZXF1ZXN0ID0gdGhpcy5yZXF1ZXN0LAogICAgICBleHRyYUhlYWRlcnMgPSAob3B0aW9ucy5leHRyYUhlYWRlcnMgfHwgW10pLnNsaWNlKCksCiAgICAvL21lZGlhU3RyZWFtID0gb3B0aW9ucy5tZWRpYVN0cmVhbSB8fCBudWxsLAogICAgICBpY2VTZXJ2ZXJzLAogICAgICBzdHVuU2VydmVycyA9IG9wdGlvbnMuc3R1blNlcnZlcnMgfHwgbnVsbCwKICAgICAgdHVyblNlcnZlcnMgPSBvcHRpb25zLnR1cm5TZXJ2ZXJzIHx8IG51bGwsCiAgICAgIHNkcENyZWF0aW9uU3VjY2VlZGVkID0gZnVuY3Rpb24oYm9keSkgewogICAgICAgIHZhcgogICAgICAgICAgcmVzcG9uc2UsCiAgICAgICAgICAvLyBydW4gZm9yIHJlcGx5IHN1Y2Nlc3MgY2FsbGJhY2sKICAgICAgICAgIHJlcGx5U3VjY2VlZGVkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHNlbGYuc3RhdHVzID0gQy5TVEFUVVNfV0FJVElOR19GT1JfQUNLOwoKICAgICAgICAgICAgc2VsZi5zZXRJbnZpdGUyeHhUaW1lcihyZXF1ZXN0LCBib2R5KTsKICAgICAgICAgICAgc2VsZi5zZXRBQ0tUaW1lcigpOwogICAgICAgICAgfSwKCiAgICAgICAgICAvLyBydW4gZm9yIHJlcGx5IGZhaWx1cmUgY2FsbGJhY2sKICAgICAgICAgIHJlcGx5RmFpbGVkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHNlbGYuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgICAgICAgICAgc2VsZi50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5DT05ORUNUSU9OX0VSUk9SKTsKICAgICAgICAgIH07CgogICAgICAgIC8vIENocm9tZSBtaWdodCBjYWxsIG9uYWRkc3RyZWFtIGJlZm9yZSBhY2NlcHQoKSBpcyBjYWxsZWQsIHdoaWNoIG1lYW5zCiAgICAgICAgLy8gbWVkaWFIYW5kbGVyLnJlbmRlcigpIHdhcyBjYWxsZWQgd2l0aG91dCBhIHJlbmRlckhpbnQsIHNvIHdlIG5lZWQgdG8KICAgICAgICAvLyByZS1yZW5kZXIgbm93IHRoYXQgbWVkaWFIaW50LnJlbmRlciBoYXMgYmVlbiBzZXQuCiAgICAgICAgLy8KICAgICAgICAvLyBDaHJvbWUgc2VlbXMgdG8gYmUgaW4gdGhlIHJpZ2h0IHJlZ2FyZGluZyB0aGlzLCBzZWUKICAgICAgICAvLyBodHRwOi8vZGV2LnczLm9yZy8yMDExL3dlYnJ0Yy9lZGl0b3Ivd2VicnRjLmh0bWwjd2lkbC1SVENQZWVyQ29ubmVjdGlvbi1vbmFkZHN0cmVhbQogICAgICAgIHNlbGYubWVkaWFIYW5kbGVyLnJlbmRlcigpOwoKICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJyArIHNlbGYuY29udGFjdCk7CiAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0FsbG93OiAnICsgU0lQLlVBLkMuQUxMT1dFRF9NRVRIT0RTLnRvU3RyaW5nKCkpOwoKICAgICAgICBpZighc2VsZi5oYXNPZmZlcikgewogICAgICAgICAgc2VsZi5oYXNPZmZlciA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNlbGYuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0LnJlcGx5KDIwMCwgbnVsbCwgZXh0cmFIZWFkZXJzLAogICAgICAgICAgICAgICAgICAgICAgYm9keSwKICAgICAgICAgICAgICAgICAgICAgIHJlcGx5U3VjY2VlZGVkLAogICAgICAgICAgICAgICAgICAgICAgcmVwbHlGYWlsZWQKICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICBpZiAoc2VsZi5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsgLy8gRGlkbid0IGZhaWwKICAgICAgICAgIHNlbGYuYWNjZXB0ZWQocmVzcG9uc2UsIFNJUC5VdGlscy5nZXRSZWFzb25QaHJhc2UoMjAwKSk7CiAgICAgICAgfQogICAgICB9LAoKICAgICAgc2RwQ3JlYXRpb25GYWlsZWQgPSBmdW5jdGlvbigpIHsKICAgICAgICBpZiAoc2VsZi5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8gVE9ETyAtIGZhaWwgb3V0IG9uIGVycm9yCiAgICAgICAgc2VsZi5yZXF1ZXN0LnJlcGx5KDQ4MCk7CiAgICAgICAgLy9zZWxmLmZhaWxlZChyZXNwb25zZSwgU0lQLkMuY2F1c2VzLlVTRVJfREVOSUVEX01FRElBX0FDQ0VTUyk7CiAgICAgICAgc2VsZi5mYWlsZWQobnVsbCwgU0lQLkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgc2VsZi50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5XRUJSVENfRVJST1IpOwogICAgICB9OwoKICAgIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLKSB7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0s7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfQU5TV0VSKSB7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQU5TV0VSRUQ7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19FQVJMWV9NRURJQSkgewogICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogICAgfQoKICAgIGlmICgoc3R1blNlcnZlcnMgfHwgdHVyblNlcnZlcnMpICYmCiAgICAgICAgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19FQVJMWV9NRURJQSAmJiB0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQU5TV0VSRURfV0FJVElOR19GT1JfUFJBQ0spKSB7CiAgICAgIGlmIChzdHVuU2VydmVycykgewogICAgICAgIGljZVNlcnZlcnMgPSBTSVAuVUEuY29uZmlndXJhdGlvbl9jaGVjay5vcHRpb25hbFsnc3R1blNlcnZlcnMnXShzdHVuU2VydmVycyk7CiAgICAgICAgaWYgKCFpY2VTZXJ2ZXJzKSB7CiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHN0dW5TZXJ2ZXJzOiAnKyBzdHVuU2VydmVycyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuc3R1blNlcnZlcnMgPSBpY2VTZXJ2ZXJzOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHR1cm5TZXJ2ZXJzKSB7CiAgICAgICAgaWNlU2VydmVycyA9IFNJUC5VQS5jb25maWd1cmF0aW9uX2NoZWNrLm9wdGlvbmFsWyd0dXJuU2VydmVycyddKHR1cm5TZXJ2ZXJzKTsKICAgICAgICBpZiAoIWljZVNlcnZlcnMpIHsKICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgdHVyblNlcnZlcnM6ICcrIHR1cm5TZXJ2ZXJzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy50dXJuU2VydmVycyA9IGljZVNlcnZlcnM7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLm1lZGlhSGFuZGxlci51cGRhdGVJY2VTZXJ2ZXJzKHsKICAgICAgICBzdHVuU2VydmVyczogdGhpcy5zdHVuU2VydmVycywKICAgICAgICB0dXJuU2VydmVyczogdGhpcy50dXJuU2VydmVycwogICAgICB9KTsKICAgIH0KCiAgICAvLyBBbiBlcnJvciBvbiBkaWFsb2cgY3JlYXRpb24gd2lsbCBmaXJlICdmYWlsZWQnIGV2ZW50CiAgICBpZighdGhpcy5jcmVhdGVEaWFsb2cocmVxdWVzdCwgJ1VBUycpKSB7CiAgICAgIHJlcXVlc3QucmVwbHkoNTAwLCAnTWlzc2luZyBDb250YWN0IGhlYWRlciBmaWVsZCcpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy51c2VyTm9BbnN3ZXJUaW1lcik7CgogICAgLy8gdGhpcyBob2xkLXJlbGF0ZWQgY29kZSBicmVha3MgRkYgYWNjZXB0aW5nIG5ldyBjYWxscyAtIEpNRiAyMDE0LTEtMjEKICAgIC8qCiAgICBsZW5ndGggPSB0aGlzLmdldFJlbW90ZVN0cmVhbXMoKS5sZW5ndGg7CgogICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgIGlmICh0aGlzLm1lZGlhSGFuZGxlci5nZXRSZW1vdGVTdHJlYW1zKClbaWR4XS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICBoYXNWaWRlbyA9IHRydWU7CiAgICAgIH0KICAgICAgaWYgKHRoaXMubWVkaWFIYW5kbGVyLmdldFJlbW90ZVN0cmVhbXMoKVtpZHhdLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgIGhhc0F1ZGlvID0gdHJ1ZTsKICAgICAgfQogICAgfQoKICAgIGlmICghaGFzQXVkaW8gJiYgdGhpcy5tZWRpYUNvbnN0cmFpbnRzLmF1ZGlvID09PSB0cnVlKSB7CiAgICAgIHRoaXMubWVkaWFDb25zdHJhaW50cy5hdWRpbyA9IGZhbHNlOwogICAgICBpZiAobWVkaWFTdHJlYW0pIHsKICAgICAgICBsZW5ndGggPSBtZWRpYVN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmxlbmd0aDsKICAgICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICAgIG1lZGlhU3RyZWFtLnJlbW92ZVRyYWNrKG1lZGlhU3RyZWFtLmdldEF1ZGlvVHJhY2tzKClbaWR4XSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYgKCFoYXNWaWRlbyAmJiB0aGlzLm1lZGlhQ29uc3RyYWludHMudmlkZW8gPT09IHRydWUpIHsKICAgICAgdGhpcy5tZWRpYUNvbnN0cmFpbnRzLnZpZGVvID0gZmFsc2U7CiAgICAgIGlmIChtZWRpYVN0cmVhbSkgewogICAgICAgIGxlbmd0aCA9IG1lZGlhU3RyZWFtLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoOwogICAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICAgICAgbWVkaWFTdHJlYW0ucmVtb3ZlVHJhY2sobWVkaWFTdHJlYW0uZ2V0VmlkZW9UcmFja3MoKVtpZHhdKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgICovCgogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19FQVJMWV9NRURJQSkgewogICAgICBzZHBDcmVhdGlvblN1Y2NlZWRlZCgpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24oc2VsZi5tZWRpYUhpbnQpCiAgICAgIC50aGVuKAogICAgICAgIHNkcENyZWF0aW9uU3VjY2VlZGVkLAogICAgICAgIHNkcENyZWF0aW9uRmFpbGVkCiAgICAgICk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgcmVjZWl2ZVJlcXVlc3Q6IGZ1bmN0aW9uKHJlcXVlc3QpIHsKCiAgICAvLyBJU0MgUkVDRUlWRSBSRVFVRVNUCgogICAgZnVuY3Rpb24gY29uZmlybVNlc3Npb24oKSB7CiAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqLwogICAgICB2YXIgY29udGVudFR5cGU7CgogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5hY2tUaW1lcik7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmludml0ZTJ4eFRpbWVyKTsKICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgIHRoaXMudW5tdXRlKCk7CgogICAgICAvLyBUT0RPIC0gdGhpcyBsb2dpYyBhc3N1bWVzIENvbnRlbnQtRGlzcG9zaXRpb24gZGVmYXVsdHMKICAgICAgY29udGVudFR5cGUgPSByZXF1ZXN0LmdldEhlYWRlcignQ29udGVudC1UeXBlJyk7CiAgICAgIGlmIChjb250ZW50VHlwZSAhPT0gJ2FwcGxpY2F0aW9uL3NkcCcpIHsKICAgICAgICB0aGlzLnJlbmRlcmJvZHkgPSByZXF1ZXN0LmJvZHk7CiAgICAgICAgdGhpcy5yZW5kZXJ0eXBlID0gY29udGVudFR5cGU7CiAgICAgIH0KICAgIH0KCiAgICBzd2l0Y2gocmVxdWVzdC5tZXRob2QpIHsKICAgIGNhc2UgU0lQLkMuQ0FOQ0VMOgogICAgICAvKiBSRkMzMjYxIDE1IFN0YXRlcyB0aGF0IGEgVUFTIG1heSBoYXZlIGFjY2VwdGVkIGFuIGludml0YXRpb24gd2hpbGUgYSBDQU5DRUwKICAgICAgICogd2FzIGluIHByb2dyZXNzIGFuZCB0aGF0IHRoZSBVQUMgTUFZIGNvbnRpbnVlIHdpdGggdGhlIHNlc3Npb24gZXN0YWJsaXNoZWQgYnkKICAgICAgICogYW55IDJ4eCByZXNwb25zZSwgb3IgTUFZIHRlcm1pbmF0ZSB3aXRoIEJZRS4gU0lQIGRvZXMgY29udGludWUgd2l0aCB0aGUKICAgICAgICogZXN0YWJsaXNoZWQgc2Vzc2lvbi4gU28gdGhlIENBTkNFTCBpcyBwcm9jZXNzZWQgb25seSBpZiB0aGUgc2Vzc2lvbiBpcyBub3QgeWV0CiAgICAgICAqIGVzdGFibGlzaGVkLgogICAgICAgKi8KCiAgICAgIC8qCiAgICAgICAqIFRlcm1pbmF0ZSB0aGUgd2hvbGUgc2Vzc2lvbiBpbiBjYXNlIHRoZSB1c2VyIGRpZG4ndCBhY2NlcHQgKG9yIHlldCB0byBzZW5kIHRoZSBhbnN3ZXIpIG5vciByZWplY3QgdGhlCiAgICAgICAqcmVxdWVzdCBvcGVuaW5nIHRoZSBzZXNzaW9uLgogICAgICAgKi8KICAgICAgaWYodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUiB8fAogICAgICAgICB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfUFJBQ0sgfHwKICAgICAgICAgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0FOU1dFUkVEX1dBSVRJTkdfRk9SX1BSQUNLIHx8CiAgICAgICAgIHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19FQVJMWV9NRURJQSB8fAogICAgICAgICB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQU5TV0VSRUQpIHsKCiAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19DQU5DRUxFRDsKICAgICAgICB0aGlzLnJlcXVlc3QucmVwbHkoNDg3KTsKICAgICAgICB0aGlzLmNhbmNlbGVkKHJlcXVlc3QpOwogICAgICAgIHRoaXMucmVqZWN0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkNBTkNFTEVEKTsKICAgICAgICB0aGlzLmZhaWxlZChyZXF1ZXN0LCBTSVAuQy5jYXVzZXMuQ0FOQ0VMRUQpOwogICAgICAgIHRoaXMudGVybWluYXRlZChyZXF1ZXN0LCBTSVAuQy5jYXVzZXMuQ0FOQ0VMRUQpOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgY2FzZSBTSVAuQy5BQ0s6CiAgICAgIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0spIHsKICAgICAgICBpZiAoIXRoaXMuaGFzQW5zd2VyKSB7CiAgICAgICAgICBpZihyZXF1ZXN0LmJvZHkgJiYgcmVxdWVzdC5nZXRIZWFkZXIoJ2NvbnRlbnQtdHlwZScpID09PSAnYXBwbGljYXRpb24vc2RwJykgewogICAgICAgICAgICAvLyBBQ0sgY29udGFpbnMgYW5zd2VyIHRvIGFuIElOVklURSB3L28gU0RQIG5lZ290aWF0aW9uCiAgICAgICAgICAgIFNJUC5IYWNrcy5GaXJlZm94LmNhbm5vdEhhbmRsZUV4dHJhV2hpdGVzcGFjZShyZXF1ZXN0KTsKICAgICAgICAgICAgU0lQLkhhY2tzLkFsbEJyb3dzZXJzLm1hc2tEdGxzKHJlcXVlc3QpOwoKICAgICAgICAgICAgdGhpcy5oYXNBbnN3ZXIgPSB0cnVlOwogICAgICAgICAgICB0aGlzLm1lZGlhSGFuZGxlci5zZXREZXNjcmlwdGlvbihyZXF1ZXN0LmJvZHkpCiAgICAgICAgICAgIC50aGVuKAogICAgICAgICAgICAgIGNvbmZpcm1TZXNzaW9uLmJpbmQodGhpcyksCiAgICAgICAgICAgICAgZnVuY3Rpb24gb25GYWlsdXJlIChlKSB7CiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKGUpOwogICAgICAgICAgICAgICAgdGhpcy50ZXJtaW5hdGUoewogICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiAnNDg4JywKICAgICAgICAgICAgICAgICAgcmVhc29uUGhyYXNlOiAnQmFkIE1lZGlhIERlc2NyaXB0aW9uJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB0aGlzLmZhaWxlZChyZXF1ZXN0LCBTSVAuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgICAgIHRoaXMudGVybWluYXRlZChyZXF1ZXN0LCBTSVAuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgICAgICB9LmJpbmQodGhpcykKICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5lYXJseV9zZHApIHsKICAgICAgICAgICAgY29uZmlybVNlc3Npb24uYXBwbHkodGhpcyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvL1RPRE86IFBhc3MgdG8gbWVkaWFoYW5kbGVyCiAgICAgICAgICAgIHRoaXMuZmFpbGVkKHJlcXVlc3QsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbmZpcm1TZXNzaW9uLmFwcGx5KHRoaXMpOwogICAgICAgIH0KICAgICAgfQogICAgICBicmVhazsKICAgIGNhc2UgU0lQLkMuUFJBQ0s6CiAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfV0FJVElOR19GT1JfUFJBQ0sgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0FOU1dFUkVEX1dBSVRJTkdfRk9SX1BSQUNLKSB7CiAgICAgICAgLy9sb2NhbE1lZGlhID0gc2Vzc2lvbi5tZWRpYUhhbmRsZXIubG9jYWxNZWRpYTsKICAgICAgICBpZighdGhpcy5oYXNBbnN3ZXIpIHsKICAgICAgICAgIGlmKHJlcXVlc3QuYm9keSAmJiByZXF1ZXN0LmdldEhlYWRlcignY29udGVudC10eXBlJykgPT09ICdhcHBsaWNhdGlvbi9zZHAnKSB7CiAgICAgICAgICAgIHRoaXMuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuc2V0RGVzY3JpcHRpb24ocmVxdWVzdC5ib2R5KQogICAgICAgICAgICAudGhlbigKICAgICAgICAgICAgICBmdW5jdGlvbiBvblN1Y2Nlc3MgKCkgewogICAgICAgICAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMucmVsMXh4VGltZXIpOwogICAgICAgICAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMucHJhY2tUaW1lcik7CiAgICAgICAgICAgICAgICByZXF1ZXN0LnJlcGx5KDIwMCk7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0FOU1dFUkVEX1dBSVRJTkdfRk9SX1BSQUNLKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfRUFSTFlfTUVESUE7CiAgICAgICAgICAgICAgICAgIHRoaXMuYWNjZXB0KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0VBUkxZX01FRElBOwogICAgICAgICAgICAgICAgLy9SRVZJU0lUCiAgICAgICAgICAgICAgICB0aGlzLm11dGUoKTsKICAgICAgICAgICAgICB9LmJpbmQodGhpcyksCiAgICAgICAgICAgICAgZnVuY3Rpb24gb25GYWlsdXJlIChlKSB7CiAgICAgICAgICAgICAgICAvL1RPRE86IFNlbmQgdG8gbWVkaWEgaGFuZGxlcgogICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIud2FybihlKTsKICAgICAgICAgICAgICAgIHRoaXMudGVybWluYXRlKHsKICAgICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogJzQ4OCcsCiAgICAgICAgICAgICAgICAgIHJlYXNvblBocmFzZTogJ0JhZCBNZWRpYSBEZXNjcmlwdGlvbicKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGhpcy5mYWlsZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpCiAgICAgICAgICAgICk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZSh7CiAgICAgICAgICAgICAgc3RhdHVzQ29kZTogJzQ4OCcsCiAgICAgICAgICAgICAgcmVhc29uUGhyYXNlOiAnQmFkIE1lZGlhIERlc2NyaXB0aW9uJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5mYWlsZWQocmVxdWVzdCwgU0lQLkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgIHRoaXMudGVybWluYXRlZChyZXF1ZXN0LCBTSVAuQy5jYXVzZXMuQkFEX01FRElBX0RFU0NSSVBUSU9OKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMucmVsMXh4VGltZXIpOwogICAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMucHJhY2tUaW1lcik7CiAgICAgICAgICByZXF1ZXN0LnJlcGx5KDIwMCk7CgogICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSykgewogICAgICAgICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0VBUkxZX01FRElBOwogICAgICAgICAgICB0aGlzLmFjY2VwdCgpOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19FQVJMWV9NRURJQTsKICAgICAgICAgIC8vUkVWSVNJVAogICAgICAgICAgdGhpcy5tdXRlKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0VBUkxZX01FRElBKSB7CiAgICAgICAgcmVxdWVzdC5yZXBseSgyMDApOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgZGVmYXVsdDoKICAgICAgU2Vzc2lvbi5wcm90b3R5cGUucmVjZWl2ZVJlcXVlc3QuYXBwbHkodGhpcywgW3JlcXVlc3RdKTsKICAgICAgYnJlYWs7CiAgICB9CiAgfSwKCiAgb25UcmFuc3BvcnRFcnJvcjogZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX0NPTkZJUk1FRCAmJiB0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICB0aGlzLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICB9CiAgfSwKCiAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgICB0aGlzLnRlcm1pbmF0ZWQobnVsbCwgU0lQLkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICB9CiAgfQoKfTsKClNJUC5JbnZpdGVTZXJ2ZXJDb250ZXh0ID0gSW52aXRlU2VydmVyQ29udGV4dDsKCkludml0ZUNsaWVudENvbnRleHQgPSBmdW5jdGlvbih1YSwgdGFyZ2V0LCBvcHRpb25zKSB7CiAgb3B0aW9ucyA9IE9iamVjdC5jcmVhdGUoU2Vzc2lvbi5kZXN1Z2FyKG9wdGlvbnMpKTsKICBvcHRpb25zLnBhcmFtcyA9IE9iamVjdC5jcmVhdGUob3B0aW9ucy5wYXJhbXMgfHwgT2JqZWN0LnByb3RvdHlwZSk7CgogIHZhciBpY2VTZXJ2ZXJzLAogICAgZXh0cmFIZWFkZXJzID0gKG9wdGlvbnMuZXh0cmFIZWFkZXJzIHx8IFtdKS5zbGljZSgpLAogICAgc3R1blNlcnZlcnMgPSBvcHRpb25zLnN0dW5TZXJ2ZXJzIHx8IG51bGwsCiAgICB0dXJuU2VydmVycyA9IG9wdGlvbnMudHVyblNlcnZlcnMgfHwgbnVsbCwKICAgIG1lZGlhSGFuZGxlckZhY3RvcnkgPSBvcHRpb25zLm1lZGlhSGFuZGxlckZhY3RvcnkgfHwgdWEuY29uZmlndXJhdGlvbi5tZWRpYUhhbmRsZXJGYWN0b3J5LAogICAgaXNNZWRpYVN1cHBvcnRlZCA9IG1lZGlhSGFuZGxlckZhY3RvcnkuaXNTdXBwb3J0ZWQ7CgogIC8vIENoZWNrIFdlYlJUQyBzdXBwb3J0CiAgaWYgKGlzTWVkaWFTdXBwb3J0ZWQgJiYgIWlzTWVkaWFTdXBwb3J0ZWQoKSkgewogICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLk5vdFN1cHBvcnRlZEVycm9yKCdNZWRpYSBub3Qgc3VwcG9ydGVkJyk7CiAgfQoKICB0aGlzLlJUQ0NvbnN0cmFpbnRzID0gb3B0aW9ucy5SVENDb25zdHJhaW50cyB8fCB7fTsKICB0aGlzLmludml0ZVdpdGhvdXRTZHAgPSBvcHRpb25zLmludml0ZVdpdGhvdXRTZHAgfHwgZmFsc2U7CgogIC8vIFNldCBhbm9ueW1vdXMgcHJvcGVydHkKICB0aGlzLmFub255bW91cyA9IG9wdGlvbnMuYW5vbnltb3VzIHx8IGZhbHNlOwoKICAvLyBDdXN0b20gZGF0YSB0byBiZSBzZW50IGVpdGhlciBpbiBJTlZJVEUgb3IgaW4gQUNLCiAgdGhpcy5yZW5kZXJib2R5ID0gb3B0aW9ucy5yZW5kZXJib2R5IHx8IG51bGw7CiAgdGhpcy5yZW5kZXJ0eXBlID0gb3B0aW9ucy5yZW5kZXJ0eXBlIHx8ICd0ZXh0L3BsYWluJzsKCiAgb3B0aW9ucy5wYXJhbXMuZnJvbV90YWcgPSB0aGlzLmZyb21fdGFnOwoKICAvKiBEbyBub3QgYWRkIDtvYiBpbiBpbml0aWFsIGZvcm1pbmcgZGlhbG9nIHJlcXVlc3RzIGlmIHRoZSByZWdpc3RyYXRpb24gb3ZlcgogICAqICB0aGUgY3VycmVudCBjb25uZWN0aW9uIGdvdCBhIEdSVVUgVVJJLgogICAqLwogIHRoaXMuY29udGFjdCA9IHVhLmNvbnRhY3QudG9TdHJpbmcoewogICAgYW5vbnltb3VzOiB0aGlzLmFub255bW91cywKICAgIG91dGJvdW5kOiB0aGlzLmFub255bW91cyA/ICF1YS5jb250YWN0LnRlbXBfZ3J1dSA6ICF1YS5jb250YWN0LnB1Yl9ncnV1CiAgfSk7CgogIGlmICh0aGlzLmFub255bW91cykgewogICAgb3B0aW9ucy5wYXJhbXMuZnJvbV9kaXNwbGF5TmFtZSA9ICdBbm9ueW1vdXMnOwogICAgb3B0aW9ucy5wYXJhbXMuZnJvbV91cmkgPSAnc2lwOmFub255bW91c0Bhbm9ueW1vdXMuaW52YWxpZCc7CgogICAgZXh0cmFIZWFkZXJzLnB1c2goJ1AtUHJlZmVycmVkLUlkZW50aXR5OiAnKyB1YS5jb25maWd1cmF0aW9uLnVyaS50b1N0cmluZygpKTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdQcml2YWN5OiBpZCcpOwogIH0KICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJysgdGhpcy5jb250YWN0KTsKICBleHRyYUhlYWRlcnMucHVzaCgnQWxsb3c6ICcrIFNJUC5VQS5DLkFMTE9XRURfTUVUSE9EUy50b1N0cmluZygpKTsKICBpZiAoIXRoaXMuaW52aXRlV2l0aG91dFNkcCkgewogICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vc2RwJyk7CiAgfSBlbHNlIGlmICh0aGlzLnJlbmRlcmJvZHkpIHsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6ICcgKyB0aGlzLnJlbmRlcnR5cGUpOwogICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRlbnQtRGlzcG9zaXRpb246IHJlbmRlcjtoYW5kbGluZz1vcHRpb25hbCcpOwogIH0KCiAgaWYgKHVhLmNvbmZpZ3VyYXRpb24ucmVsMTAwID09PSBTSVAuQy5zdXBwb3J0ZWQuUkVRVUlSRUQpIHsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdSZXF1aXJlOiAxMDByZWwnKTsKICB9CiAgaWYgKHVhLmNvbmZpZ3VyYXRpb24ucmVwbGFjZXMgPT09IFNJUC5DLnN1cHBvcnRlZC5SRVFVSVJFRCkgewogICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JlcXVpcmU6IHJlcGxhY2VzJyk7CiAgfQoKICBvcHRpb25zLmV4dHJhSGVhZGVycyA9IGV4dHJhSGVhZGVyczsKCiAgU0lQLlV0aWxzLmF1Z21lbnQodGhpcywgU0lQLkNsaWVudENvbnRleHQsIFt1YSwgU0lQLkMuSU5WSVRFLCB0YXJnZXQsIG9wdGlvbnNdKTsKICBTSVAuVXRpbHMuYXVnbWVudCh0aGlzLCBTSVAuU2Vzc2lvbiwgW21lZGlhSGFuZGxlckZhY3RvcnldKTsKCiAgLy8gQ2hlY2sgU2Vzc2lvbiBTdGF0dXMKICBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX05VTEwpIHsKICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5JbnZhbGlkU3RhdGVFcnJvcih0aGlzLnN0YXR1cyk7CiAgfQoKICAvLyBTZXNzaW9uIHBhcmFtZXRlciBpbml0aWFsaXphdGlvbgogIHRoaXMuZnJvbV90YWcgPSBTSVAuVXRpbHMubmV3VGFnKCk7CgogIC8vIE91dGdvaW5nU2Vzc2lvbiBzcGVjaWZpYyBwYXJhbWV0ZXJzCiAgdGhpcy5pc0NhbmNlbGVkID0gZmFsc2U7CiAgdGhpcy5yZWNlaXZlZF8xMDAgPSBmYWxzZTsKCiAgdGhpcy5tZXRob2QgPSBTSVAuQy5JTlZJVEU7CgogIHRoaXMucmVjZWl2ZU5vbkludml0ZVJlc3BvbnNlID0gdGhpcy5yZWNlaXZlUmVzcG9uc2U7CiAgdGhpcy5yZWNlaXZlUmVzcG9uc2UgPSB0aGlzLnJlY2VpdmVJbnZpdGVSZXNwb25zZTsKCiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC5pbnZpdGVjbGllbnRjb250ZXh0Jyk7CgogIGlmIChzdHVuU2VydmVycykgewogICAgaWNlU2VydmVycyA9IFNJUC5VQS5jb25maWd1cmF0aW9uX2NoZWNrLm9wdGlvbmFsWydzdHVuU2VydmVycyddKHN0dW5TZXJ2ZXJzKTsKICAgIGlmICghaWNlU2VydmVycykgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHN0dW5TZXJ2ZXJzOiAnKyBzdHVuU2VydmVycyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnN0dW5TZXJ2ZXJzID0gaWNlU2VydmVyczsKICAgIH0KICB9CgogIGlmICh0dXJuU2VydmVycykgewogICAgaWNlU2VydmVycyA9IFNJUC5VQS5jb25maWd1cmF0aW9uX2NoZWNrLm9wdGlvbmFsWyd0dXJuU2VydmVycyddKHR1cm5TZXJ2ZXJzKTsKICAgIGlmICghaWNlU2VydmVycykgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHR1cm5TZXJ2ZXJzOiAnKyB0dXJuU2VydmVycyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnR1cm5TZXJ2ZXJzID0gaWNlU2VydmVyczsKICAgIH0KICB9CgogIHVhLmFwcGxpY2FudHNbdGhpc10gPSB0aGlzOwoKICB0aGlzLmlkID0gdGhpcy5yZXF1ZXN0LmNhbGxfaWQgKyB0aGlzLmZyb21fdGFnOwoKICAvL0luaXRpYWxpemUgTWVkaWEgU2Vzc2lvbgogIHRoaXMubWVkaWFIYW5kbGVyID0gdGhpcy5tZWRpYUhhbmRsZXJGYWN0b3J5KHRoaXMsIHsKICAgIFJUQ0NvbnN0cmFpbnRzOiB0aGlzLlJUQ0NvbnN0cmFpbnRzLAogICAgc3R1blNlcnZlcnM6IHRoaXMuc3R1blNlcnZlcnMsCiAgICB0dXJuU2VydmVyczogdGhpcy50dXJuU2VydmVycwogIH0pOwoKICBpZiAodGhpcy5tZWRpYUhhbmRsZXIgJiYgdGhpcy5tZWRpYUhhbmRsZXIuZ2V0UmVtb3RlU3RyZWFtcykgewogICAgdGhpcy5nZXRSZW1vdGVTdHJlYW1zID0gdGhpcy5tZWRpYUhhbmRsZXIuZ2V0UmVtb3RlU3RyZWFtcy5iaW5kKHRoaXMubWVkaWFIYW5kbGVyKTsKICAgIHRoaXMuZ2V0TG9jYWxTdHJlYW1zID0gdGhpcy5tZWRpYUhhbmRsZXIuZ2V0TG9jYWxTdHJlYW1zLmJpbmQodGhpcy5tZWRpYUhhbmRsZXIpOwogIH0KCiAgU0lQLlV0aWxzLm9wdGlvbnNPdmVycmlkZShvcHRpb25zLCAnbWVkaWEnLCAnbWVkaWFDb25zdHJhaW50cycsIHRydWUsIHRoaXMubG9nZ2VyLCB0aGlzLnVhLmNvbmZpZ3VyYXRpb24ubWVkaWEpOwogIHRoaXMubWVkaWFIaW50ID0gb3B0aW9ucy5tZWRpYTsKfTsKCkludml0ZUNsaWVudENvbnRleHQucHJvdG90eXBlID0gewogIGludml0ZTogZnVuY3Rpb24gKCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgIC8vU2F2ZSB0aGUgc2Vzc2lvbiBpbnRvIHRoZSB1YSBzZXNzaW9ucyBjb2xsZWN0aW9uLgogICAgLy9Ob3RlOiBwbGFjaW5nIGluIGNvbnN0cnVjdG9yIGJyZWFrcyBjYWxsIHRvIHJlcXVlc3QuY2FuY2VsIG9uIGNsb3NlLi4uIFVzZXIgZG9lcyBub3QgbmVlZCB0aGlzIGFueXdheQogICAgdGhpcy51YS5zZXNzaW9uc1t0aGlzLmlkXSA9IHRoaXM7CgogICAgLy9Ob3RlOiBkdWUgdG8gdGhlIHdheSBGaXJlZm94IGhhbmRsZXMgZ1VNIGNhbGxzLCBpdCBpcyByZWNvbW1lbmRlZCB0byBtYWtlIHRoZSBnVU0gY2FsbCBhdCB0aGUgYXBwIGxldmVsCiAgICAvLyBhbmQgaGFuZCBzaXAuanMgYSBzdHJlYW0gYXMgdGhlIG1lZGlhSGludAogICAgaWYgKHRoaXMuaW52aXRlV2l0aG91dFNkcCkgewogICAgICAvL2p1c3Qgc2VuZCBhbiBpbnZpdGUgd2l0aCBubyBzZHAuLi4KICAgICAgdGhpcy5yZXF1ZXN0LmJvZHkgPSBzZWxmLnJlbmRlcmJvZHk7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfSU5WSVRFX1NFTlQ7CiAgICAgIHRoaXMuc2VuZCgpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24oc2VsZi5tZWRpYUhpbnQpCiAgICAgIC50aGVuKAogICAgICAgIGZ1bmN0aW9uIG9uU3VjY2VzcyhvZmZlcikgewogICAgICAgICAgaWYgKHNlbGYuaXNDYW5jZWxlZCB8fCBzZWxmLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBzZWxmLmhhc09mZmVyID0gdHJ1ZTsKICAgICAgICAgIHNlbGYucmVxdWVzdC5ib2R5ID0gb2ZmZXI7CiAgICAgICAgICBzZWxmLnN0YXR1cyA9IEMuU1RBVFVTX0lOVklURV9TRU5UOwogICAgICAgICAgc2VsZi5zZW5kKCk7CiAgICAgICAgfSwKICAgICAgICBmdW5jdGlvbiBvbkZhaWx1cmUoKSB7CiAgICAgICAgICBpZiAoc2VsZi5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgLy8gVE9ETy4uLmZhaWwgb3V0CiAgICAgICAgICAvL3NlbGYuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5VU0VSX0RFTklFRF9NRURJQV9BQ0NFU1MpOwogICAgICAgICAgLy9zZWxmLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICAgIHNlbGYuZmFpbGVkKG51bGwsIFNJUC5DLmNhdXNlcy5XRUJSVENfRVJST1IpOwogICAgICAgICAgc2VsZi50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5XRUJSVENfRVJST1IpOwogICAgICAgIH0KICAgICAgKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9LAoKICByZWNlaXZlSW52aXRlUmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICB2YXIgY2F1c2UsIC8vbG9jYWxNZWRpYSwKICAgICAgc2Vzc2lvbiA9IHRoaXMsCiAgICAgIGlkID0gcmVzcG9uc2UuY2FsbF9pZCArIHJlc3BvbnNlLmZyb21fdGFnICsgcmVzcG9uc2UudG9fdGFnLAogICAgICBleHRyYUhlYWRlcnMgPSBbXSwKICAgICAgb3B0aW9ucyA9IHt9OwoKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCB8fCByZXNwb25zZS5tZXRob2QgIT09IFNJUC5DLklOVklURSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHRoaXMuZGlhbG9nICYmIChyZXNwb25zZS5zdGF0dXNfY29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPD0gMjk5KSkgewogICAgICBpZiAoaWQgIT09IHRoaXMuZGlhbG9nLmlkLnRvU3RyaW5nKCkgKSB7CiAgICAgICAgaWYgKCF0aGlzLmNyZWF0ZURpYWxvZyhyZXNwb25zZSwgJ1VBQycsIHRydWUpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5zZW5kUmVxdWVzdCh0aGlzLCBTSVAuQy5BQ0ssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib2R5OiBTSVAuVXRpbHMuZ2VuZXJhdGVGYWtlU0RQKHJlc3BvbnNlLmJvZHkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5zZW5kUmVxdWVzdCh0aGlzLCBTSVAuQy5CWUUpOwoKICAgICAgICAvKiBOT1RFOiBUaGlzIGZhaWxzIGJlY2F1c2UgdGhlIGZvcmtpbmcgcHJveHkgZG9lcyBub3QgcmVjb2duaXplIHRoYXQgYW4gdW5hbnN3ZXJhYmxlCiAgICAgICAgICogbGVnIChkdWUgdG8gcGVlckNvbm5lY3Rpb24gbGltaXRhdGlvbnMpIGhhcyBiZWVuIGFuc3dlcmVkIGZpcnN0LiBJZiB5b3VyIGZvcmtpbmcKICAgICAgICAgKiBwcm94eSBkb2VzIG5vdCBoYW5nIHVwIGFsbCB1bmFuc3dlcmVkIGJyYW5jaGVzIG9uIHRoZSBmaXJzdCBicmFuY2ggYW5zd2VyZWQsIHJlbW92ZSB0aGlzLgogICAgICAgICAqLwogICAgICAgIGlmKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICAgIHRoaXMudGVybWluYXRlZChyZXNwb25zZSwgU0lQLkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChTSVAuQy5BQ0sse2NzZXE6IHJlc3BvbnNlLmNzZXF9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuaGFzQW5zd2VyKSB7CiAgICAgICAgLy8gaW52aXRlIHcvbyBzZHAgaXMgd2FpdGluZyBmb3IgY2FsbGJhY2sKICAgICAgICAvL2FuIGludml0ZSB3aXRoIHNkcCBtdXN0IGdvIG9uLCBhbmQgaGFzQW5zd2VyIGlzIHRydWUKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5kaWFsb2cgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPCAyMDApIHsKICAgICAgLyoKICAgICAgICBFYXJseSBtZWRpYSBoYXMgYmVlbiBzZXQgdXAgd2l0aCBhdCBsZWFzdCBvbmUgb3RoZXIgZGlmZmVyZW50IGJyYW5jaCwKICAgICAgICBidXQgYSBmaW5hbCAyeHggcmVzcG9uc2UgaGFzbid0IGJlZW4gcmVjZWl2ZWQKICAgICAgKi8KICAgICAgaWYgKHRoaXMuZGlhbG9nLnByYWNrZWQuaW5kZXhPZihyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSkgIT09IC0xIHx8CiAgICAgICAgICAodGhpcy5kaWFsb2cucHJhY2tlZFt0aGlzLmRpYWxvZy5wcmFja2VkLmxlbmd0aC0xXSA+PSByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSAmJiB0aGlzLmRpYWxvZy5wcmFja2VkLmxlbmd0aCA+IDApKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuZWFybHlEaWFsb2dzW2lkXSAmJiAhdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnLCB0cnVlKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLmluZGV4T2YocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpICE9PSAtMSB8fAogICAgICAgICAgKHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkW3RoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLmxlbmd0aC0xXSA+PSByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSAmJiB0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5sZW5ndGggPiAwKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JBY2s6ICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSArICcgJyArIHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKTsKICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQucHVzaChyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSk7CgogICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0uc2VuZFJlcXVlc3QodGhpcywgU0lQLkMuUFJBQ0ssIHsKICAgICAgICBleHRyYUhlYWRlcnM6IGV4dHJhSGVhZGVycywKICAgICAgICBib2R5OiBTSVAuVXRpbHMuZ2VuZXJhdGVGYWtlU0RQKHJlc3BvbnNlLmJvZHkpCiAgICAgIH0pOwogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gUHJvY2VlZCB0byBjYW5jZWxsYXRpb24gaWYgdGhlIHVzZXIgcmVxdWVzdGVkLgogICAgaWYodGhpcy5pc0NhbmNlbGVkKSB7CiAgICAgIGlmKHJlc3BvbnNlLnN0YXR1c19jb2RlID49IDEwMCAmJiByZXNwb25zZS5zdGF0dXNfY29kZSA8IDIwMCkgewogICAgICAgIHRoaXMucmVxdWVzdC5jYW5jZWwodGhpcy5jYW5jZWxSZWFzb24pOwogICAgICAgIHRoaXMuY2FuY2VsZWQobnVsbCk7CiAgICAgIH0gZWxzZSBpZihyZXNwb25zZS5zdGF0dXNfY29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPCAyOTkpIHsKICAgICAgICB0aGlzLmFjY2VwdEFuZFRlcm1pbmF0ZShyZXNwb25zZSk7CiAgICAgICAgdGhpcy5lbWl0KCdieWUnLCB0aGlzLnJlcXVlc3QpOwogICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLnN0YXR1c19jb2RlID49IDMwMCkgewogICAgICAgIGNhdXNlID0gU0lQLkMuUkVBU09OX1BIUkFTRVtyZXNwb25zZS5zdGF0dXNfY29kZV0gfHwgU0lQLkMuY2F1c2VzLkNBTkNFTEVEOwogICAgICAgIHRoaXMucmVqZWN0ZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgY2F1c2UpOwogICAgICAgIHRoaXMudGVybWluYXRlZChyZXNwb25zZSwgY2F1c2UpOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzd2l0Y2godHJ1ZSkgewogICAgICBjYXNlIC9eMTAwJC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgdGhpcy5yZWNlaXZlZF8xMDAgPSB0cnVlOwogICAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgKC9eMVswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSkpOgogICAgICAgIC8vIERvIG5vdGhpbmcgd2l0aCAxeHggcmVzcG9uc2VzIHdpdGhvdXQgVG8gdGFnLgogICAgICAgIGlmKCFyZXNwb25zZS50b190YWcpIHsKICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJzF4eCByZXNwb25zZSByZWNlaXZlZCB3aXRob3V0IHRvIHRhZycpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICAvLyBDcmVhdGUgRWFybHkgRGlhbG9nIGlmIDFYWCBjb21lcyB3aXRoIGNvbnRhY3QKICAgICAgICBpZihyZXNwb25zZS5oYXNIZWFkZXIoJ2NvbnRhY3QnKSkgewogICAgICAgICAgLy8gQW4gZXJyb3Igb24gZGlhbG9nIGNyZWF0aW9uIHdpbGwgZmlyZSAnZmFpbGVkJyBldmVudAogICAgICAgICAgaWYgKCF0aGlzLmNyZWF0ZURpYWxvZyhyZXNwb25zZSwgJ1VBQycsIHRydWUpKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU18xWFhfUkVDRUlWRUQ7CgogICAgICAgIGlmKHJlc3BvbnNlLmhhc0hlYWRlcigncmVxdWlyZScpICYmCiAgICAgICAgICAgcmVzcG9uc2UuZ2V0SGVhZGVyKCdyZXF1aXJlJykuaW5kZXhPZignMTAwcmVsJykgIT09IC0xKSB7CgogICAgICAgICAgLy8gRG8gbm90aGluZyBpZiB0aGlzLmRpYWxvZyBpcyBhbHJlYWR5IGNvbmZpcm1lZAogICAgICAgICAgaWYgKHRoaXMuZGlhbG9nIHx8ICF0aGlzLmVhcmx5RGlhbG9nc1tpZF0pIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLmluZGV4T2YocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpICE9PSAtMSB8fAogICAgICAgICAgICAgICh0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZFt0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5sZW5ndGgtMV0gPj0gcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgJiYgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQubGVuZ3RoID4gMCkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIFNJUC5IYWNrcy5GaXJlZm94LmNhbm5vdEhhbmRsZUV4dHJhV2hpdGVzcGFjZShyZXNwb25zZSk7CiAgICAgICAgICBTSVAuSGFja3MuQWxsQnJvd3NlcnMubWFza0R0bHMocmVzcG9uc2UpOwoKICAgICAgICAgIGlmICghcmVzcG9uc2UuYm9keSkgewogICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnUkFjazogJyArIHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpICsgJyAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdjc2VxJykpOwogICAgICAgICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5wdXNoKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKTsKICAgICAgICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnNlbmRSZXF1ZXN0KHRoaXMsIFNJUC5DLlBSQUNLLCB7CiAgICAgICAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CgogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmhhc09mZmVyKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnKSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuaGFzQW5zd2VyID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5kaWFsb2cucHJhY2tlZC5wdXNoKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKTsKCiAgICAgICAgICAgIHRoaXMubWVkaWFIYW5kbGVyLnNldERlc2NyaXB0aW9uKHJlc3BvbnNlLmJvZHkpCiAgICAgICAgICAgIC50aGVuKAogICAgICAgICAgICAgIGZ1bmN0aW9uIG9uU3VjY2VzcyAoKSB7CiAgICAgICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnUkFjazogJyArIHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpICsgJyAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdjc2VxJykpOwoKICAgICAgICAgICAgICAgIHNlc3Npb24uc2VuZFJlcXVlc3QoU0lQLkMuUFJBQ0ssIHsKICAgICAgICAgICAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICAgICAgICAgICAgICAgIHJlY2VpdmVSZXNwb25zZTogZnVuY3Rpb24oKSB7fQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBzZXNzaW9uLnN0YXR1cyA9IEMuU1RBVFVTX0VBUkxZX01FRElBOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5tdXRlKCk7CiAgICAgICAgICAgICAgICBzZXNzaW9uLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwogICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAgIGlmIChzZXNzaW9uLnN0YXR1cyA9PT0gQy5TVEFUVVNfRUFSTFlfTUVESUEpIHsKICAgICAgICAgICAgICAgICAgbG9jYWxNZWRpYSA9IHNlc3Npb24ubWVkaWFIYW5kbGVyLmxvY2FsTWVkaWE7CiAgICAgICAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0QXVkaW9UcmFja3MoKVswXS5lbmFibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgaWYgKGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgbG9jYWxNZWRpYS5nZXRWaWRlb1RyYWNrcygpWzBdLmVuYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSovCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBmdW5jdGlvbiBvbkZhaWx1cmUgKGUpIHsKICAgICAgICAgICAgICAgIHNlc3Npb24ubG9nZ2VyLndhcm4oZSk7CiAgICAgICAgICAgICAgICBzZXNzaW9uLmFjY2VwdEFuZFRlcm1pbmF0ZShyZXNwb25zZSwgNDg4LCAnTm90IEFjY2VwdGFibGUgSGVyZScpOwogICAgICAgICAgICAgICAgc2Vzc2lvbi5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciBlYXJseURpYWxvZyA9IHRoaXMuZWFybHlEaWFsb2dzW2lkXTsKICAgICAgICAgICAgdmFyIGVhcmx5TWVkaWEgPSBlYXJseURpYWxvZy5tZWRpYUhhbmRsZXI7CgogICAgICAgICAgICBlYXJseURpYWxvZy5wcmFja2VkLnB1c2gocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpOwoKICAgICAgICAgICAgZWFybHlNZWRpYS5zZXREZXNjcmlwdGlvbihyZXNwb25zZS5ib2R5KQogICAgICAgICAgICAudGhlbihlYXJseU1lZGlhLmdldERlc2NyaXB0aW9uLmJpbmQoZWFybHlNZWRpYSwgc2Vzc2lvbi5tZWRpYUhpbnQpKQogICAgICAgICAgICAudGhlbihmdW5jdGlvbiBvblN1Y2Nlc3Moc2RwKSB7CiAgICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vc2RwJyk7CiAgICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JBY2s6ICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSArICcgJyArIHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKTsKICAgICAgICAgICAgICBlYXJseURpYWxvZy5zZW5kUmVxdWVzdChzZXNzaW9uLCBTSVAuQy5QUkFDSywgewogICAgICAgICAgICAgICAgZXh0cmFIZWFkZXJzOiBleHRyYUhlYWRlcnMsCiAgICAgICAgICAgICAgICBib2R5OiBzZHAKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBzZXNzaW9uLnN0YXR1cyA9IEMuU1RBVFVTX0VBUkxZX01FRElBOwogICAgICAgICAgICAgIHNlc3Npb24uZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiBvbkZhaWx1cmUoZSkgewogICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgU0lQLkV4Y2VwdGlvbnMuR2V0RGVzY3JpcHRpb25FcnJvcikgewogICAgICAgICAgICAgICAgZWFybHlEaWFsb2cucHJhY2tlZC5wdXNoKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKTsKICAgICAgICAgICAgICAgIGlmIChzZXNzaW9uLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBUT0RPIC0gZmFpbCBvdXQgb24gZXJyb3IKICAgICAgICAgICAgICAgIC8vIHNlc3Npb24uZmFpbGVkKGd1bSBlcnJvcik7CiAgICAgICAgICAgICAgICBzZXNzaW9uLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICAgICAgICAgIHNlc3Npb24udGVybWluYXRlZChudWxsLCBTSVAuQy5jYXVzZXMuV0VCUlRDX0VSUk9SKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZWFybHlEaWFsb2cucHJhY2tlZC5zcGxpY2UoZWFybHlEaWFsb2cucHJhY2tlZC5pbmRleE9mKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKSwgMSk7CiAgICAgICAgICAgICAgICAvLyBDb3VsZCBub3Qgc2V0IHJlbW90ZSBkZXNjcmlwdGlvbgogICAgICAgICAgICAgICAgc2Vzc2lvbi5sb2dnZXIud2FybignaW52YWxpZCBTRFAnKTsKICAgICAgICAgICAgICAgIHNlc3Npb24ubG9nZ2VyLndhcm4oZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgL14yWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgICB2YXIgY3NlcSA9IHRoaXMucmVxdWVzdC5jc2VxICsgJyAnICsgdGhpcy5yZXF1ZXN0Lm1ldGhvZDsKICAgICAgICBpZiAoY3NlcSAhPT0gcmVzcG9uc2UuZ2V0SGVhZGVyKCdjc2VxJykpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19FQVJMWV9NRURJQSAmJiB0aGlzLmRpYWxvZykgewogICAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgICAgICB0aGlzLnVubXV0ZSgpOwogICAgICAgICAgLypsb2NhbE1lZGlhID0gdGhpcy5tZWRpYUhhbmRsZXIubG9jYWxNZWRpYTsKICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICBsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKClbMF0uZW5hYmxlZCA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAobG9jYWxNZWRpYS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgbG9jYWxNZWRpYS5nZXRWaWRlb1RyYWNrcygpWzBdLmVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgfSovCiAgICAgICAgICBvcHRpb25zID0ge307CiAgICAgICAgICBpZiAodGhpcy5yZW5kZXJib2R5KSB7CiAgICAgICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6ICcgKyB0aGlzLnJlbmRlcnR5cGUpOwogICAgICAgICAgICBvcHRpb25zLmV4dHJhSGVhZGVycyA9IGV4dHJhSGVhZGVyczsKICAgICAgICAgICAgb3B0aW9ucy5ib2R5ID0gdGhpcy5yZW5kZXJib2R5OwogICAgICAgICAgfQogICAgICAgICAgb3B0aW9ucy5jc2VxID0gcmVzcG9uc2UuY3NlcTsKICAgICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuQUNLLCBvcHRpb25zKTsKICAgICAgICAgIHRoaXMuYWNjZXB0ZWQocmVzcG9uc2UpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIC8vIERvIG5vdGhpbmcgaWYgdGhpcy5kaWFsb2cgaXMgYWxyZWFkeSBjb25maXJtZWQKICAgICAgICBpZiAodGhpcy5kaWFsb2cpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgU0lQLkhhY2tzLkZpcmVmb3guY2Fubm90SGFuZGxlRXh0cmFXaGl0ZXNwYWNlKHJlc3BvbnNlKTsKICAgICAgICBTSVAuSGFja3MuQWxsQnJvd3NlcnMubWFza0R0bHMocmVzcG9uc2UpOwoKICAgICAgICAvLyBUaGlzIGlzIGFuIGludml0ZSB3aXRob3V0IHNkcAogICAgICAgIGlmICghdGhpcy5oYXNPZmZlcikgewogICAgICAgICAgaWYgKHRoaXMuZWFybHlEaWFsb2dzW2lkXSAmJiB0aGlzLmVhcmx5RGlhbG9nc1tpZF0ubWVkaWFIYW5kbGVyLmxvY2FsTWVkaWEpIHsKICAgICAgICAgICAgLy9SRVZJU0lUCiAgICAgICAgICAgIHRoaXMuaGFzT2ZmZXIgPSB0cnVlOwogICAgICAgICAgICB0aGlzLmhhc0Fuc3dlciA9IHRydWU7CiAgICAgICAgICAgIHRoaXMubWVkaWFIYW5kbGVyID0gdGhpcy5lYXJseURpYWxvZ3NbaWRdLm1lZGlhSGFuZGxlcjsKICAgICAgICAgICAgaWYgKCF0aGlzLmNyZWF0ZURpYWxvZyhyZXNwb25zZSwgJ1VBQycpKSB7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuQUNLLCB7Y3NlcTpyZXNwb25zZS5jc2VxfSk7CgogICAgICAgICAgICB0aGlzLnVubXV0ZSgpOwogICAgICAgICAgICAvKgogICAgICAgICAgICBsb2NhbE1lZGlhID0gc2Vzc2lvbi5tZWRpYUhhbmRsZXIubG9jYWxNZWRpYTsKICAgICAgICAgICAgaWYgKGxvY2FsTWVkaWEuZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgbG9jYWxNZWRpYS5nZXRBdWRpb1RyYWNrcygpWzBdLmVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGxvY2FsTWVkaWEuZ2V0VmlkZW9UcmFja3MoKVswXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgICAgICAgfSovCiAgICAgICAgICAgIHRoaXMuYWNjZXB0ZWQocmVzcG9uc2UpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYoIXJlc3BvbnNlLmJvZHkpIHsKICAgICAgICAgICAgICB0aGlzLmFjY2VwdEFuZFRlcm1pbmF0ZShyZXNwb25zZSwgNDAwLCAnTWlzc2luZyBzZXNzaW9uIGRlc2NyaXB0aW9uJyk7CiAgICAgICAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnKSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuaGFzT2ZmZXIgPSB0cnVlOwogICAgICAgICAgICB0aGlzLm1lZGlhSGFuZGxlci5zZXREZXNjcmlwdGlvbihyZXNwb25zZS5ib2R5KQogICAgICAgICAgICAudGhlbih0aGlzLm1lZGlhSGFuZGxlci5nZXREZXNjcmlwdGlvbi5iaW5kKHRoaXMubWVkaWFIYW5kbGVyLCB0aGlzLm1lZGlhSGludCkpCiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIG9uU3VjY2VzcyhzZHApIHsKICAgICAgICAgICAgICAvL3ZhciBsb2NhbE1lZGlhOwogICAgICAgICAgICAgIGlmKHNlc3Npb24uaXNDYW5jZWxlZCB8fCBzZXNzaW9uLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc2RwID0gU0lQLkhhY2tzLkZpcmVmb3guaGFzTWlzc2luZ0NMaW5lSW5TRFAoc2RwKTsKCiAgICAgICAgICAgICAgc2Vzc2lvbi5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgICAgICAgICAgc2Vzc2lvbi5oYXNBbnN3ZXIgPSB0cnVlOwoKICAgICAgICAgICAgICBzZXNzaW9uLnVubXV0ZSgpOwogICAgICAgICAgICAgIC8qbG9jYWxNZWRpYSA9IHNlc3Npb24ubWVkaWFIYW5kbGVyLmxvY2FsTWVkaWE7CiAgICAgICAgICAgICAgaWYgKGxvY2FsTWVkaWEuZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKClbMF0uZW5hYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgbG9jYWxNZWRpYS5nZXRWaWRlb1RyYWNrcygpWzBdLmVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgIH0qLwogICAgICAgICAgICAgIHNlc3Npb24uc2VuZFJlcXVlc3QoU0lQLkMuQUNLLHsKICAgICAgICAgICAgICAgIGJvZHk6IHNkcCwKICAgICAgICAgICAgICAgIGV4dHJhSGVhZGVyczpbJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vc2RwJ10sCiAgICAgICAgICAgICAgICBjc2VxOnJlc3BvbnNlLmNzZXEKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBzZXNzaW9uLmFjY2VwdGVkKHJlc3BvbnNlKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIG9uRmFpbHVyZShlKSB7CiAgICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBTSVAuRXhjZXB0aW9ucy5HZXREZXNjcmlwdGlvbkVycm9yKSB7CiAgICAgICAgICAgICAgICAvLyBUT0RPIGRvIHNvbWV0aGluZyBoZXJlCiAgICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2dlci53YXJuKCJ0aGVyZSB3YXMgYSBwcm9ibGVtIik7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNlc3Npb24ubG9nZ2VyLndhcm4oJ2ludmFsaWQgU0RQJyk7CiAgICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2dlci53YXJuKGUpOwogICAgICAgICAgICAgICAgcmVzcG9uc2UucmVwbHkoNDg4KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5oYXNBbnN3ZXIpewogICAgICAgICAgaWYgKHRoaXMucmVuZGVyYm9keSkgewogICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgc2Vzc2lvbi5yZW5kZXJ0eXBlKTsKICAgICAgICAgICAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSBleHRyYUhlYWRlcnM7CiAgICAgICAgICAgIG9wdGlvbnMuYm9keSA9IHRoaXMucmVuZGVyYm9keTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuc2VuZFJlcXVlc3QoU0lQLkMuQUNLLCBvcHRpb25zKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYoIXJlc3BvbnNlLmJvZHkpIHsKICAgICAgICAgICAgdGhpcy5hY2NlcHRBbmRUZXJtaW5hdGUocmVzcG9uc2UsIDQwMCwgJ01pc3Npbmcgc2Vzc2lvbiBkZXNjcmlwdGlvbicpOwogICAgICAgICAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgU0lQLkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgaWYgKCF0aGlzLmNyZWF0ZURpYWxvZyhyZXNwb25zZSwgJ1VBQycpKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5oYXNBbnN3ZXIgPSB0cnVlOwogICAgICAgICAgdGhpcy5tZWRpYUhhbmRsZXIuc2V0RGVzY3JpcHRpb24ocmVzcG9uc2UuYm9keSkKICAgICAgICAgIC50aGVuKAogICAgICAgICAgICBmdW5jdGlvbiBvblN1Y2Nlc3MgKCkgewogICAgICAgICAgICAgIHZhciBvcHRpb25zID0ge307Ly8sbG9jYWxNZWRpYTsKICAgICAgICAgICAgICBzZXNzaW9uLnN0YXR1cyA9IEMuU1RBVFVTX0NPTkZJUk1FRDsKICAgICAgICAgICAgICBzZXNzaW9uLnVubXV0ZSgpOwogICAgICAgICAgICAgIC8qbG9jYWxNZWRpYSA9IHNlc3Npb24ubWVkaWFIYW5kbGVyLmxvY2FsTWVkaWE7CiAgICAgICAgICAgICAgaWYgKGxvY2FsTWVkaWEuZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBsb2NhbE1lZGlhLmdldEF1ZGlvVHJhY2tzKClbMF0uZW5hYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChsb2NhbE1lZGlhLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgbG9jYWxNZWRpYS5nZXRWaWRlb1RyYWNrcygpWzBdLmVuYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgIH0qLwogICAgICAgICAgICAgIGlmIChzZXNzaW9uLnJlbmRlcmJvZHkpIHsKICAgICAgICAgICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6ICcgKyBzZXNzaW9uLnJlbmRlcnR5cGUpOwogICAgICAgICAgICAgICAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSBleHRyYUhlYWRlcnM7CiAgICAgICAgICAgICAgICBvcHRpb25zLmJvZHkgPSBzZXNzaW9uLnJlbmRlcmJvZHk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIG9wdGlvbnMuY3NlcSA9IHJlc3BvbnNlLmNzZXE7CiAgICAgICAgICAgICAgc2Vzc2lvbi5zZW5kUmVxdWVzdChTSVAuQy5BQ0ssIG9wdGlvbnMpOwogICAgICAgICAgICAgIHNlc3Npb24uYWNjZXB0ZWQocmVzcG9uc2UpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBmdW5jdGlvbiBvbkZhaWx1cmUgKGUpIHsKICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2dlci53YXJuKGUpOwogICAgICAgICAgICAgIHNlc3Npb24uYWNjZXB0QW5kVGVybWluYXRlKHJlc3BvbnNlLCA0ODgsICdOb3QgQWNjZXB0YWJsZSBIZXJlJyk7CiAgICAgICAgICAgICAgc2Vzc2lvbi5mYWlsZWQocmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5CQURfTUVESUFfREVTQ1JJUFRJT04pOwogICAgICAgICAgICB9CiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICBjYXVzZSA9IFNJUC5VdGlscy5zaXBFcnJvckNhdXNlKHJlc3BvbnNlLnN0YXR1c19jb2RlKTsKICAgICAgICB0aGlzLnJlamVjdGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgIH0KICB9LAoKICBjYW5jZWw6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIC8vIENoZWNrIFNlc3Npb24gU3RhdHVzCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogICAgfQoKICAgIHRoaXMubG9nZ2VyLmxvZygnY2FuY2VsaW5nIFJUQ1Nlc3Npb24nKTsKCiAgICB2YXIgY2FuY2VsX3JlYXNvbiA9IFNJUC5VdGlscy5nZXRDYW5jZWxSZWFzb24ob3B0aW9ucy5zdGF0dXNfY29kZSwgb3B0aW9ucy5yZWFzb25fcGhyYXNlKTsKCiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19OVUxMIHx8CiAgICAgICAgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19JTlZJVEVfU0VOVCAmJiAhdGhpcy5yZWNlaXZlZF8xMDApKSB7CiAgICAgIHRoaXMuaXNDYW5jZWxlZCA9IHRydWU7CiAgICAgIHRoaXMuY2FuY2VsUmVhc29uID0gY2FuY2VsX3JlYXNvbjsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0lOVklURV9TRU5UIHx8CiAgICAgICAgICAgICAgIHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU18xWFhfUkVDRUlWRUQgfHwKICAgICAgICAgICAgICAgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0VBUkxZX01FRElBKSB7CiAgICAgIHRoaXMucmVxdWVzdC5jYW5jZWwoY2FuY2VsX3JlYXNvbik7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuY2FuY2VsZWQoKTsKICB9LAoKICB0ZXJtaW5hdGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1dBSVRJTkdfRk9SX0FDSyB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRoaXMuYnllKG9wdGlvbnMpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5jYW5jZWwob3B0aW9ucyk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgcmVjZWl2ZVJlcXVlc3Q6IGZ1bmN0aW9uKHJlcXVlc3QpIHsKICAgIC8vIElDQyBSRUNFSVZFIFJFUVVFU1QKCiAgICAvLyBSZWplY3QgQ0FOQ0VMcwogICAgaWYgKHJlcXVlc3QubWV0aG9kID09PSBTSVAuQy5DQU5DRUwpIHsKICAgICAgLy8gVE9ETzsgbWFrZSB0aGlzIGEgc3dpdGNoIHdoZW4gaXQgZ2V0cyBhZGRlZAogICAgfQoKICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gU0lQLkMuQUNLICYmIHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0spIHsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuYWNrVGltZXIpOwogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5pbnZpdGUyeHhUaW1lcik7CiAgICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICB0aGlzLnVubXV0ZSgpOwoKICAgICAgdGhpcy5hY2NlcHRlZCgpOwogICAgfQoKICAgIHJldHVybiBTZXNzaW9uLnByb3RvdHlwZS5yZWNlaXZlUmVxdWVzdC5hcHBseSh0aGlzLCBbcmVxdWVzdF0pOwogIH0sCgogIG9uVHJhbnNwb3J0RXJyb3I6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19DT05GSVJNRUQgJiYgdGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgdGhpcy5mYWlsZWQobnVsbCwgU0lQLkMuY2F1c2VzLkNPTk5FQ1RJT05fRVJST1IpOwogICAgfQogIH0sCgogIG9uUmVxdWVzdFRpbWVvdXQ6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhpcy50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfVEVSTUlOQVRFRCkgewogICAgICB0aGlzLmZhaWxlZChudWxsLCBTSVAuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgICAgdGhpcy50ZXJtaW5hdGVkKG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogICAgfQogIH0KCn07CgpTSVAuSW52aXRlQ2xpZW50Q29udGV4dCA9IEludml0ZUNsaWVudENvbnRleHQ7Cgp9OwoKfSx7Ii4vU2Vzc2lvbi9EVE1GIjoyOH1dLDI4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBEVE1GCiAqLwoKLyoqCiAqIEBjbGFzcyBEVE1GCiAqIEBwYXJhbSB7U0lQLlNlc3Npb259IHNlc3Npb24KICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewoKdmFyIERUTUYsCiAgQyA9IHsKICAgIE1JTl9EVVJBVElPTjogICAgICAgICAgICA3MCwKICAgIE1BWF9EVVJBVElPTjogICAgICAgICAgICA2MDAwLAogICAgREVGQVVMVF9EVVJBVElPTjogICAgICAgIDEwMCwKICAgIE1JTl9JTlRFUl9UT05FX0dBUDogICAgICA1MCwKICAgIERFRkFVTFRfSU5URVJfVE9ORV9HQVA6ICA1MDAKICB9OwoKRFRNRiA9IGZ1bmN0aW9uKHNlc3Npb24sIHRvbmUsIG9wdGlvbnMpIHsKICB2YXIgZHVyYXRpb24sIGludGVyVG9uZUdhcDsKCiAgaWYgKHRvbmUgPT09IHVuZGVmaW5lZCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignTm90IGVub3VnaCBhcmd1bWVudHMnKTsKICB9CgogIHRoaXMubG9nZ2VyID0gc2Vzc2lvbi51YS5nZXRMb2dnZXIoJ3NpcC5pbnZpdGVjb250ZXh0LmR0bWYnLCBzZXNzaW9uLmlkKTsKICB0aGlzLm93bmVyID0gc2Vzc2lvbjsKICB0aGlzLmRpcmVjdGlvbiA9IG51bGw7CgogIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogIGR1cmF0aW9uID0gb3B0aW9ucy5kdXJhdGlvbiB8fCBudWxsOwogIGludGVyVG9uZUdhcCA9IG9wdGlvbnMuaW50ZXJUb25lR2FwIHx8IG51bGw7CgogIC8vIENoZWNrIHRvbmUgdHlwZQogIGlmICh0eXBlb2YgdG9uZSA9PT0gJ3N0cmluZycgKSB7CiAgICB0b25lID0gdG9uZS50b1VwcGVyQ2FzZSgpOwogIH0gZWxzZSBpZiAodHlwZW9mIHRvbmUgPT09ICdudW1iZXInKSB7CiAgICB0b25lID0gdG9uZS50b1N0cmluZygpOwogIH0gZWxzZSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHRvbmU6ICcrIHRvbmUpOwogIH0KCiAgLy8gQ2hlY2sgdG9uZSB2YWx1ZQogIGlmICghdG9uZS5tYXRjaCgvXlswLTlBLUQjKl0kLykpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgdG9uZTogJysgdG9uZSk7CiAgfSBlbHNlIHsKICAgIHRoaXMudG9uZSA9IHRvbmU7CiAgfQoKICAvLyBDaGVjayBkdXJhdGlvbgogIGlmIChkdXJhdGlvbiAmJiAhU0lQLlV0aWxzLmlzRGVjaW1hbChkdXJhdGlvbikpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgdG9uZSBkdXJhdGlvbjogJysgZHVyYXRpb24pOwogIH0gZWxzZSBpZiAoIWR1cmF0aW9uKSB7CiAgICBkdXJhdGlvbiA9IERUTUYuQy5ERUZBVUxUX0RVUkFUSU9OOwogIH0gZWxzZSBpZiAoZHVyYXRpb24gPCBEVE1GLkMuTUlOX0RVUkFUSU9OKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCciZHVyYXRpb24iIHZhbHVlIGlzIGxvd2VyIHRoYW4gdGhlIG1pbmltdW0gYWxsb3dlZCwgc2V0dGluZyBpdCB0byAnKyBEVE1GLkMuTUlOX0RVUkFUSU9OKyAnIG1pbGxpc2Vjb25kcycpOwogICAgZHVyYXRpb24gPSBEVE1GLkMuTUlOX0RVUkFUSU9OOwogIH0gZWxzZSBpZiAoZHVyYXRpb24gPiBEVE1GLkMuTUFYX0RVUkFUSU9OKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCciZHVyYXRpb24iIHZhbHVlIGlzIGdyZWF0ZXIgdGhhbiB0aGUgbWF4aW11bSBhbGxvd2VkLCBzZXR0aW5nIGl0IHRvICcrIERUTUYuQy5NQVhfRFVSQVRJT04gKycgbWlsbGlzZWNvbmRzJyk7CiAgICBkdXJhdGlvbiA9IERUTUYuQy5NQVhfRFVSQVRJT047CiAgfSBlbHNlIHsKICAgIGR1cmF0aW9uID0gTWF0aC5hYnMoZHVyYXRpb24pOwogIH0KICB0aGlzLmR1cmF0aW9uID0gZHVyYXRpb247CgogIC8vIENoZWNrIGludGVyVG9uZUdhcAogIGlmIChpbnRlclRvbmVHYXAgJiYgIVNJUC5VdGlscy5pc0RlY2ltYWwoaW50ZXJUb25lR2FwKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBpbnRlclRvbmVHYXA6ICcrIGludGVyVG9uZUdhcCk7CiAgfSBlbHNlIGlmICghaW50ZXJUb25lR2FwKSB7CiAgICBpbnRlclRvbmVHYXAgPSBEVE1GLkMuREVGQVVMVF9JTlRFUl9UT05FX0dBUDsKICB9IGVsc2UgaWYgKGludGVyVG9uZUdhcCA8IERUTUYuQy5NSU5fSU5URVJfVE9ORV9HQVApIHsKICAgIHRoaXMubG9nZ2VyLndhcm4oJyJpbnRlclRvbmVHYXAiIHZhbHVlIGlzIGxvd2VyIHRoYW4gdGhlIG1pbmltdW0gYWxsb3dlZCwgc2V0dGluZyBpdCB0byAnKyBEVE1GLkMuTUlOX0lOVEVSX1RPTkVfR0FQICsnIG1pbGxpc2Vjb25kcycpOwogICAgaW50ZXJUb25lR2FwID0gRFRNRi5DLk1JTl9JTlRFUl9UT05FX0dBUDsKICB9IGVsc2UgewogICAgaW50ZXJUb25lR2FwID0gTWF0aC5hYnMoaW50ZXJUb25lR2FwKTsKICB9CiAgdGhpcy5pbnRlclRvbmVHYXAgPSBpbnRlclRvbmVHYXA7Cn07CkRUTUYucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdHlwZSk7CgoKRFRNRi5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICB2YXIgZXh0cmFIZWFkZXJzLCBib2R5OwoKICB0aGlzLmRpcmVjdGlvbiA9ICdvdXRnb2luZyc7CgogIC8vIENoZWNrIFJUQ1Nlc3Npb24gU3RhdHVzCiAgaWYgKHRoaXMub3duZXIuc3RhdHVzICE9PSBTSVAuU2Vzc2lvbi5DLlNUQVRVU19DT05GSVJNRUQgJiYKICAgIHRoaXMub3duZXIuc3RhdHVzICE9PSBTSVAuU2Vzc2lvbi5DLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0spIHsKICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5JbnZhbGlkU3RhdGVFcnJvcih0aGlzLm93bmVyLnN0YXR1cyk7CiAgfQoKICAvLyBHZXQgRFRNRiBvcHRpb25zCiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgZXh0cmFIZWFkZXJzID0gb3B0aW9ucy5leHRyYUhlYWRlcnMgPyBvcHRpb25zLmV4dHJhSGVhZGVycy5zbGljZSgpIDogW107CgogIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2R0bWYtcmVsYXknKTsKCiAgYm9keSA9ICJTaWduYWw9ICIgKyB0aGlzLnRvbmUgKyAiXHJcbiI7CiAgYm9keSArPSAiRHVyYXRpb249ICIgKyB0aGlzLmR1cmF0aW9uOwoKICB0aGlzLnJlcXVlc3QgPSB0aGlzLm93bmVyLmRpYWxvZy5zZW5kUmVxdWVzdCh0aGlzLCBTSVAuQy5JTkZPLCB7CiAgICBleHRyYUhlYWRlcnM6IGV4dHJhSGVhZGVycywKICAgIGJvZHk6IGJvZHkKICB9KTsKCiAgdGhpcy5vd25lci5lbWl0KCdkdG1mJywgdGhpcy5yZXF1ZXN0LCB0aGlzKTsKfTsKCi8qKgogKiBAcHJpdmF0ZQogKi8KRFRNRi5wcm90b3R5cGUucmVjZWl2ZVJlc3BvbnNlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHsKICB2YXIgY2F1c2U7CgogIHN3aXRjaCh0cnVlKSB7CiAgICBjYXNlIC9eMVswLTldezJ9JC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgIC8vIElnbm9yZSBwcm92aXNpb25hbCByZXNwb25zZXMuCiAgICAgIGJyZWFrOwoKICAgIGNhc2UgL14yWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgdGhpcy5lbWl0KCdzdWNjZWVkZWQnLCB7CiAgICAgICAgb3JpZ2luYXRvcjogJ3JlbW90ZScsCiAgICAgICAgcmVzcG9uc2U6IHJlc3BvbnNlCiAgICAgIH0pOwogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgICBjYXVzZSA9IFNJUC5VdGlscy5zaXBFcnJvckNhdXNlKHJlc3BvbnNlLnN0YXR1c19jb2RlKTsKICAgICAgdGhpcy5lbWl0KCdmYWlsZWQnLCByZXNwb25zZSwgY2F1c2UpOwogICAgICBicmVhazsKICB9Cn07CgovKioKICogQHByaXZhdGUKICovCkRUTUYucHJvdG90eXBlLm9uUmVxdWVzdFRpbWVvdXQgPSBmdW5jdGlvbigpIHsKICB0aGlzLmVtaXQoJ2ZhaWxlZCcsIG51bGwsIFNJUC5DLmNhdXNlcy5SRVFVRVNUX1RJTUVPVVQpOwogIHRoaXMub3duZXIub25SZXF1ZXN0VGltZW91dCgpOwp9OwoKLyoqCiAqIEBwcml2YXRlCiAqLwpEVE1GLnByb3RvdHlwZS5vblRyYW5zcG9ydEVycm9yID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5lbWl0KCdmYWlsZWQnLCBudWxsLCBTSVAuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgdGhpcy5vd25lci5vblRyYW5zcG9ydEVycm9yKCk7Cn07CgovKioKICogQHByaXZhdGUKICovCkRUTUYucHJvdG90eXBlLm9uRGlhbG9nRXJyb3IgPSBmdW5jdGlvbihyZXNwb25zZSkgewogIHRoaXMuZW1pdCgnZmFpbGVkJywgcmVzcG9uc2UsIFNJUC5DLmNhdXNlcy5ESUFMT0dfRVJST1IpOwogIHRoaXMub3duZXIub25EaWFsb2dFcnJvcihyZXNwb25zZSk7Cn07CgovKioKICogQHByaXZhdGUKICovCkRUTUYucHJvdG90eXBlLmluaXRfaW5jb21pbmcgPSBmdW5jdGlvbihyZXF1ZXN0KSB7CiAgdGhpcy5kaXJlY3Rpb24gPSAnaW5jb21pbmcnOwogIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7CgogIHJlcXVlc3QucmVwbHkoMjAwKTsKCiAgaWYgKCF0aGlzLnRvbmUgfHwgIXRoaXMuZHVyYXRpb24pIHsKICAgIHRoaXMubG9nZ2VyLndhcm4oJ2ludmFsaWQgSU5GTyBEVE1GIHJlY2VpdmVkLCBkaXNjYXJkZWQnKTsKICB9IGVsc2UgewogICAgdGhpcy5vd25lci5lbWl0KCdkdG1mJywgcmVxdWVzdCwgdGhpcyk7CiAgfQp9OwoKRFRNRi5DID0gQzsKcmV0dXJuIERUTUY7Cn07Cgp9LHt9XSwyOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CiJ1c2Ugc3RyaWN0IjsKCi8qKgogKiBAZmlsZW92ZXJ2aWV3IFNJUCBTdWJzY3JpYmVyIChTSVAtU3BlY2lmaWMgRXZlbnQgTm90aWZpY2F0aW9ucyBSRkM2NjY1KQogKi8KCi8qKgogKiBAYXVnbWVudHMgU0lQCiAqIEBjbGFzcyBDbGFzcyBjcmVhdGluZyBhIFNJUCBTdWJzY3JpcHRpb24uCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVApIHsKU0lQLlN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uICh1YSwgdGFyZ2V0LCBldmVudCwgb3B0aW9ucykgewogIG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKG9wdGlvbnMgfHwgT2JqZWN0LnByb3RvdHlwZSk7CiAgdGhpcy5leHRyYUhlYWRlcnMgPSBvcHRpb25zLmV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKCiAgdGhpcy5pZCA9IG51bGw7CiAgdGhpcy5zdGF0ZSA9ICdpbml0JzsKCiAgaWYgKCFldmVudCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRXZlbnQgbmVjZXNzYXJ5IHRvIGNyZWF0ZSBhIHN1YnNjcmlwdGlvbi4nKTsKICB9IGVsc2UgewogICAgLy9UT0RPOiBjaGVjayBmb3IgdmFsaWQgZXZlbnRzIGhlcmUgcHJvYmFibHkgbWFrZSBhIGxpc3QgaW4gU0lQLkM7IG9yIGxlYXZlIGl0IHVwIHRvIGFwcCB0byBjaGVjaz8KICAgIC8vVGhlIGNoZWNrIG1heSBuZWVkIHRvL3Nob3VsZCBwcm9iYWJseSBvY2N1ciBvbiB0aGUgb3RoZXIgc2lkZSwKICAgIHRoaXMuZXZlbnQgPSBldmVudDsKICB9CgogIGlmKHR5cGVvZiBvcHRpb25zLmV4cGlyZXMgIT09ICdudW1iZXInKXsKICAgIHVhLmxvZ2dlci53YXJuKCdleHBpcmVzIG11c3QgYmUgYSBudW1iZXIuIFVzaW5nIGRlZmF1bHQgb2YgMzYwMC4nKTsKICAgIHRoaXMuZXhwaXJlcyA9IDM2MDA7CiAgfSBlbHNlIHsKICAgIHRoaXMuZXhwaXJlcyA9IG9wdGlvbnMuZXhwaXJlczsKICB9CgogIG9wdGlvbnMuZXh0cmFIZWFkZXJzLnB1c2goJ0V2ZW50OiAnICsgdGhpcy5ldmVudCk7CiAgb3B0aW9ucy5leHRyYUhlYWRlcnMucHVzaCgnRXhwaXJlczogJyArIHRoaXMuZXhwaXJlcyk7CgogIGlmIChvcHRpb25zLmJvZHkpIHsKICAgIHRoaXMuYm9keSA9IG9wdGlvbnMuYm9keTsKICB9CgogIHRoaXMuY29udGFjdCA9IHVhLmNvbnRhY3QudG9TdHJpbmcoKTsKCiAgb3B0aW9ucy5leHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJysgdGhpcy5jb250YWN0KTsKICBvcHRpb25zLmV4dHJhSGVhZGVycy5wdXNoKCdBbGxvdzogJysgU0lQLlVBLkMuQUxMT1dFRF9NRVRIT0RTLnRvU3RyaW5nKCkpOwoKICBTSVAuVXRpbHMuYXVnbWVudCh0aGlzLCBTSVAuQ2xpZW50Q29udGV4dCwgW3VhLCBTSVAuQy5TVUJTQ1JJQkUsIHRhcmdldCwgb3B0aW9uc10pOwoKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnN1YnNjcmlwdGlvbicpOwoKICB0aGlzLmRpYWxvZyA9IG51bGw7CiAgdGhpcy50aW1lcnMgPSB7TjogbnVsbCwgc3ViX2R1cmF0aW9uOiBudWxsfTsKICB0aGlzLmVycm9yQ29kZXMgID0gWzQwNCw0MDUsNDEwLDQxNiw0ODAsNDgxLDQ4Miw0ODMsNDg0LDQ4NSw0ODksNTAxLDYwNF07Cn07CgpTSVAuU3Vic2NyaXB0aW9uLnByb3RvdHlwZSA9IHsKICBzdWJzY3JpYmU6IGZ1bmN0aW9uKCkgewogICAgdmFyIHN1YiA9IHRoaXM7CgogICAgIC8vdGhlc2Ugc3RhdGVzIHBvaW50IHRvIGFuIGV4aXN0aW5nIHN1YnNjcmlwdGlvbiwgbm8gc3Vic2NyaWJlIGlzIG5lY2Vzc2FyeQogICAgaWYgKHRoaXMuc3RhdGUgPT09ICdhY3RpdmUnKSB7CiAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0ZSA9PT0gJ25vdGlmeV93YWl0JykgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5zdWJfZHVyYXRpb24pOwogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy50aW1lcnMuTik7CiAgICB0aGlzLnRpbWVycy5OID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KHN1Yi50aW1lcl9maXJlLmJpbmQoc3ViKSwgU0lQLlRpbWVycy5USU1FUl9OKTsKCiAgICB0aGlzLnNlbmQoKTsKCiAgICB0aGlzLnN0YXRlID0gJ25vdGlmeV93YWl0JzsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICByZWZyZXNoOiBmdW5jdGlvbiAoKSB7CiAgICBpZiAodGhpcy5zdGF0ZSA9PT0gJ3Rlcm1pbmF0ZWQnIHx8IHRoaXMuc3RhdGUgPT09ICdwZW5kaW5nJyB8fCB0aGlzLnN0YXRlID09PSAnbm90aWZ5X3dhaXQnKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLmRpYWxvZy5zZW5kUmVxdWVzdCh0aGlzLCBTSVAuQy5TVUJTQ1JJQkUsIHsKICAgICAgZXh0cmFIZWFkZXJzOiB0aGlzLmV4dHJhSGVhZGVycywKICAgICAgYm9keTogdGhpcy5ib2R5CiAgICB9KTsKICB9LAoKICByZWNlaXZlUmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICB2YXIgZXhwaXJlcywgc3ViID0gdGhpcywKICAgICAgICBjYXVzZSA9IFNJUC5VdGlscy5nZXRSZWFzb25QaHJhc2UocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOwoKICAgIGlmICgodGhpcy5zdGF0ZSA9PT0gJ25vdGlmeV93YWl0JyAmJiByZXNwb25zZS5zdGF0dXNfY29kZSA+PSAzMDApIHx8CiAgICAgICAgKHRoaXMuc3RhdGUgIT09ICdub3RpZnlfd2FpdCcgJiYgdGhpcy5lcnJvckNvZGVzLmluZGV4T2YocmVzcG9uc2Uuc3RhdHVzX2NvZGUpICE9PSAtMSkpIHsKICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIG51bGwpOwogICAgfSBlbHNlIGlmICgvXjJbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpKXsKICAgICAgZXhwaXJlcyA9IHJlc3BvbnNlLmdldEhlYWRlcignRXhwaXJlcycpOwogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5OKTsKCiAgICAgIGlmICh0aGlzLmNyZWF0ZUNvbmZpcm1lZERpYWxvZyhyZXNwb25zZSwnVUFDJykpIHsKICAgICAgICB0aGlzLmlkID0gdGhpcy5kaWFsb2cuaWQudG9TdHJpbmcoKTsKICAgICAgICB0aGlzLnVhLnN1YnNjcmlwdGlvbnNbdGhpcy5pZF0gPSB0aGlzOwogICAgICAgIHRoaXMuZW1pdCgnYWNjZXB0ZWQnLCByZXNwb25zZSwgY2F1c2UpOwogICAgICAgIC8vIFVQREFURSBST1VURSBTRVQgVE8gQkUgQkFDS1dBUkRTIENPTVBBVElCTEU/CiAgICAgIH0KCiAgICAgIGlmIChleHBpcmVzICYmIGV4cGlyZXMgPD0gdGhpcy5leHBpcmVzKSB7CiAgICAgICAgLy8gUHJlc2VydmUgbmV3IGV4cGlyZXMgdmFsdWUgZm9yIHN1YnNlcXVlbnQgcmVxdWVzdHMKICAgICAgICB0aGlzLmV4cGlyZXMgPSBleHBpcmVzOwogICAgICAgIHRoaXMudGltZXJzLnN1Yl9kdXJhdGlvbiA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChzdWIucmVmcmVzaC5iaW5kKHN1YiksIGV4cGlyZXMgKiA5MDApOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICghZXhwaXJlcykgewogICAgICAgICAgdGhpcy5sb2dnZXIud2FybignRXhwaXJlcyBoZWFkZXIgbWlzc2luZyBpbiBhIDIwMC1jbGFzcyByZXNwb25zZSB0byBTVUJTQ1JJQkUnKTsKICAgICAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBTSVAuQy5FWFBJUkVTX0hFQURFUl9NSVNTSU5HKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5sb2dnZXIud2FybignRXhwaXJlcyBoZWFkZXIgaW4gYSAyMDAtY2xhc3MgcmVzcG9uc2UgdG8gU1VCU0NSSUJFIHdpdGggYSBoaWdoZXIgdmFsdWUgdGhhbiB0aGUgb25lIGluIHRoZSByZXF1ZXN0Jyk7CiAgICAgICAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgU0lQLkMuSU5WQUxJRF9FWFBJUkVTX0hFQURFUik7CiAgICAgICAgfQogICAgICB9CiAgICB9IC8vVXNlZCB0byBqdXN0IGlnbm9yZSBwcm92aXNpb25hbCByZXNwb25zZXM7IG5vdyBpZ25vcmVzIGV2ZXJ5dGhpbmcgZXhjZXB0IGVycm9yQ29kZXMgYW5kIDJ4eAogIH0sCgogIHVuc3Vic2NyaWJlOiBmdW5jdGlvbigpIHsKICAgIHZhciBleHRyYUhlYWRlcnMgPSBbXSwgc3ViID0gdGhpczsKCiAgICB0aGlzLnN0YXRlID0gJ3Rlcm1pbmF0ZWQnOwoKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdFdmVudDogJyArIHRoaXMuZXZlbnQpOwogICAgZXh0cmFIZWFkZXJzLnB1c2goJ0V4cGlyZXM6IDAnKTsKCiAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGFjdDogJysgdGhpcy5jb250YWN0KTsKICAgIGV4dHJhSGVhZGVycy5wdXNoKCdBbGxvdzogJysgU0lQLlVBLkMuQUxMT1dFRF9NRVRIT0RTLnRvU3RyaW5nKCkpOwoKICAgIC8vbWFrZXMgc3VyZSBleHBpcmVzIGlzbid0IHNldCwgYW5kIG90aGVyIHR5cGljYWwgcmVzdWJzY3JpYmUgYmVoYXZpb3IKICAgIHRoaXMucmVjZWl2ZVJlc3BvbnNlID0gZnVuY3Rpb24oKXt9OwoKICAgIHRoaXMuZGlhbG9nLnNlbmRSZXF1ZXN0KHRoaXMsIHRoaXMubWV0aG9kLCB7CiAgICAgIGV4dHJhSGVhZGVyczogZXh0cmFIZWFkZXJzLAogICAgICBib2R5OiB0aGlzLmJvZHkKICAgIH0pOwoKICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnN1Yl9kdXJhdGlvbik7CiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5OKTsKICAgIHRoaXMudGltZXJzLk4gPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoc3ViLnRpbWVyX2ZpcmUuYmluZChzdWIpLCBTSVAuVGltZXJzLlRJTUVSX04pOwogIH0sCgogIC8qKgogICogQHByaXZhdGUKICAqLwogIHRpbWVyX2ZpcmU6IGZ1bmN0aW9uKCl7CiAgICBpZiAodGhpcy5zdGF0ZSA9PT0gJ3Rlcm1pbmF0ZWQnKSB7CiAgICAgIHRoaXMudGVybWluYXRlRGlhbG9nKCk7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLk4pOwogICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5zdWJfZHVyYXRpb24pOwoKICAgICAgZGVsZXRlIHRoaXMudWEuc3Vic2NyaXB0aW9uc1t0aGlzLmlkXTsKICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0ZSA9PT0gJ3BlbmRpbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdub3RpZnlfd2FpdCcpIHsKICAgICAgdGhpcy5jbG9zZSgpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5yZWZyZXNoKCk7CiAgICB9CiAgfSwKCiAgLyoqCiAgKiBAcHJpdmF0ZQogICovCiAgY2xvc2U6IGZ1bmN0aW9uKCkgewogICAgaWYodGhpcy5zdGF0ZSAhPT0gJ25vdGlmeV93YWl0JyAmJiB0aGlzLnN0YXRlICE9PSAndGVybWluYXRlZCcpIHsKICAgICAgdGhpcy51bnN1YnNjcmliZSgpOwogICAgfQogIH0sCgogIC8qKgogICogQHByaXZhdGUKICAqLwogIGNyZWF0ZUNvbmZpcm1lZERpYWxvZzogZnVuY3Rpb24obWVzc2FnZSwgdHlwZSkgewogICAgdmFyIGRpYWxvZzsKCiAgICB0aGlzLnRlcm1pbmF0ZURpYWxvZygpOwogICAgZGlhbG9nID0gbmV3IFNJUC5EaWFsb2codGhpcywgbWVzc2FnZSwgdHlwZSk7CgogICAgaWYoIWRpYWxvZy5lcnJvcikgewogICAgICB0aGlzLmRpYWxvZyA9IGRpYWxvZzsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvLyBEaWFsb2cgbm90IGNyZWF0ZWQgZHVlIHRvIGFuIGVycm9yCiAgICBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0sCgogIC8qKgogICogQHByaXZhdGUKICAqLwogIHRlcm1pbmF0ZURpYWxvZzogZnVuY3Rpb24oKSB7CiAgICBpZih0aGlzLmRpYWxvZykgewogICAgICBkZWxldGUgdGhpcy51YS5zdWJzY3JpcHRpb25zW3RoaXMuaWRdOwogICAgICB0aGlzLmRpYWxvZy50ZXJtaW5hdGUoKTsKICAgICAgZGVsZXRlIHRoaXMuZGlhbG9nOwogICAgfQogIH0sCgogIC8qKgogICogQHByaXZhdGUKICAqLwogIHJlY2VpdmVSZXF1ZXN0OiBmdW5jdGlvbihyZXF1ZXN0KSB7CiAgICB2YXIgc3ViX3N0YXRlLCBzdWIgPSB0aGlzOwoKICAgIGZ1bmN0aW9uIHNldEV4cGlyZXNUaW1lb3V0KCkgewogICAgICBpZiAoc3ViX3N0YXRlLmV4cGlyZXMpIHsKICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dChzdWIudGltZXJzLnN1Yl9kdXJhdGlvbik7CiAgICAgICAgc3ViX3N0YXRlLmV4cGlyZXMgPSBNYXRoLm1pbihzdWIuZXhwaXJlcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWF4KHN1Yl9zdGF0ZS5leHBpcmVzLCAwKSk7CiAgICAgICAgc3ViLnRpbWVycy5zdWJfZHVyYXRpb24gPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoc3ViLnJlZnJlc2guYmluZChzdWIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViX3N0YXRlLmV4cGlyZXMgKiA5MDApOwogICAgICB9CiAgICB9CgogICAgaWYgKCF0aGlzLm1hdGNoRXZlbnQocmVxdWVzdCkpIHsgLy9jaGVja3MgZXZlbnQgYW5kIHN1YnNjcmlwdGlvbl9zdGF0ZSBoZWFkZXJzCiAgICAgIHJlcXVlc3QucmVwbHkoNDg5KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHN1Yl9zdGF0ZSA9IHJlcXVlc3QucGFyc2VIZWFkZXIoJ1N1YnNjcmlwdGlvbi1TdGF0ZScpOwoKICAgIHJlcXVlc3QucmVwbHkoMjAwLCBTSVAuQy5SRUFTT05fMjAwKTsKCiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5OKTsKCiAgICB0aGlzLmVtaXQoJ25vdGlmeScsIHtyZXF1ZXN0OiByZXF1ZXN0fSk7CgogICAgLy8gaWYgd2UndmUgc2V0IHN0YXRlIHRvIHRlcm1pbmF0ZWQsIG5vIGZ1cnRoZXIgcHJvY2Vzc2luZyBzaG91bGQgdGFrZSBwbGFjZQogICAgLy8gYW5kIHdlIGFyZSBvbmx5IGludGVyZXN0ZWQgaW4gY2xlYW5pbmcgdXAgYWZ0ZXIgdGhlIGFwcHJvcHJpYXRlIE5PVElGWQogICAgaWYgKHRoaXMuc3RhdGUgPT09ICd0ZXJtaW5hdGVkJykgewogICAgICBpZiAoc3ViX3N0YXRlLnN0YXRlID09PSAndGVybWluYXRlZCcpIHsKICAgICAgICB0aGlzLnRlcm1pbmF0ZURpYWxvZygpOwogICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLk4pOwogICAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnN1Yl9kdXJhdGlvbik7CgogICAgICAgIGRlbGV0ZSB0aGlzLnVhLnN1YnNjcmlwdGlvbnNbdGhpcy5pZF07CiAgICAgIH0KICAgICAgcmV0dXJuOwogICAgfQoKICAgIHN3aXRjaCAoc3ViX3N0YXRlLnN0YXRlKSB7CiAgICAgIGNhc2UgJ2FjdGl2ZSc6CiAgICAgICAgdGhpcy5zdGF0ZSA9ICdhY3RpdmUnOwogICAgICAgIHNldEV4cGlyZXNUaW1lb3V0KCk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3BlbmRpbmcnOgogICAgICAgIGlmICh0aGlzLnN0YXRlID09PSAnbm90aWZ5X3dhaXQnKSB7CiAgICAgICAgICBzZXRFeHBpcmVzVGltZW91dCgpOwogICAgICAgIH0KICAgICAgICB0aGlzLnN0YXRlID0gJ3BlbmRpbmcnOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICd0ZXJtaW5hdGVkJzoKICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5zdWJfZHVyYXRpb24pOwogICAgICAgIGlmIChzdWJfc3RhdGUucmVhc29uKSB7CiAgICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ3Rlcm1pbmF0aW5nIHN1YnNjcmlwdGlvbiB3aXRoIHJlYXNvbiAnKyBzdWJfc3RhdGUucmVhc29uKTsKICAgICAgICAgIHN3aXRjaCAoc3ViX3N0YXRlLnJlYXNvbikgewogICAgICAgICAgICBjYXNlICdkZWFjdGl2YXRlZCc6CiAgICAgICAgICAgIGNhc2UgJ3RpbWVvdXQnOgogICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlKCk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBjYXNlICdwcm9iYXRpb24nOgogICAgICAgICAgICBjYXNlICdnaXZldXAnOgogICAgICAgICAgICAgIGlmKHN1Yl9zdGF0ZS5wYXJhbXMgJiYgc3ViX3N0YXRlLnBhcmFtc1sncmV0cnktYWZ0ZXInXSkgewogICAgICAgICAgICAgICAgdGhpcy50aW1lcnMuc3ViX2R1cmF0aW9uID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KHN1Yi5zdWJzY3JpYmUuYmluZChzdWIpLCBzdWJfc3RhdGUucGFyYW1zWydyZXRyeS1hZnRlciddKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmUoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBjYXNlICdyZWplY3RlZCc6CiAgICAgICAgICAgIGNhc2UgJ25vcmVzb3VyY2UnOgogICAgICAgICAgICBjYXNlICdpbnZhcmlhbnQnOgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLmNsb3NlKCk7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfSwKCiAgZmFpbGVkOiBmdW5jdGlvbihyZXNwb25zZSwgY2F1c2UpIHsKICAgIHRoaXMuY2xvc2UoKTsKICAgIHRoaXMuZW1pdCgnZmFpbGVkJywgcmVzcG9uc2UsIGNhdXNlKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIG9uRGlhbG9nRXJyb3I6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgU0lQLkMuY2F1c2VzLkRJQUxPR19FUlJPUik7CiAgfSwKCiAgLyoqCiAgKiBAcHJpdmF0ZQogICovCiAgbWF0Y2hFdmVudDogZnVuY3Rpb24ocmVxdWVzdCkgewogICAgdmFyIGV2ZW50OwoKICAgIC8vIENoZWNrIG1hbmRhdG9yeSBoZWFkZXIgRXZlbnQKICAgIGlmICghcmVxdWVzdC5oYXNIZWFkZXIoJ0V2ZW50JykpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybignbWlzc2luZyBFdmVudCBoZWFkZXInKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgLy8gQ2hlY2sgbWFuZGF0b3J5IGhlYWRlciBTdWJzY3JpcHRpb24tU3RhdGUKICAgIGlmICghcmVxdWVzdC5oYXNIZWFkZXIoJ1N1YnNjcmlwdGlvbi1TdGF0ZScpKSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ21pc3NpbmcgU3Vic2NyaXB0aW9uLVN0YXRlIGhlYWRlcicpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLy8gQ2hlY2sgd2hldGhlciB0aGUgZXZlbnQgaW4gTk9USUZZIG1hdGNoZXMgdGhlIGV2ZW50IGluIFNVQlNDUklCRQogICAgZXZlbnQgPSByZXF1ZXN0LnBhcnNlSGVhZGVyKCdldmVudCcpLmV2ZW50OwoKICAgIGlmICh0aGlzLmV2ZW50ICE9PSBldmVudCkgewogICAgICB0aGlzLmxvZ2dlci53YXJuKCdldmVudCBtYXRjaCBmYWlsZWQnKTsKICAgICAgcmVxdWVzdC5yZXBseSg0ODEsICdFdmVudCBNYXRjaCBGYWlsZWQnKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfQp9Owp9OwoKfSx7fV0sMzA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IFNJUCBUSU1FUlMKICovCgovKioKICogQGF1Z21lbnRzIFNJUAogKi8KdmFyCiAgVDEgPSA1MDAsCiAgVDIgPSA0MDAwLAogIFQ0ID0gNTAwMDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodGltZXJzKSB7CiAgdmFyIFRpbWVycyA9IHsKICAgIFQxOiBUMSwKICAgIFQyOiBUMiwKICAgIFQ0OiBUNCwKICAgIFRJTUVSX0I6IDY0ICogVDEsCiAgICBUSU1FUl9EOiAwICAqIFQxLAogICAgVElNRVJfRjogNjQgKiBUMSwKICAgIFRJTUVSX0g6IDY0ICogVDEsCiAgICBUSU1FUl9JOiAwICAqIFQxLAogICAgVElNRVJfSjogMCAgKiBUMSwKICAgIFRJTUVSX0s6IDAgICogVDQsCiAgICBUSU1FUl9MOiA2NCAqIFQxLAogICAgVElNRVJfTTogNjQgKiBUMSwKICAgIFRJTUVSX046IDY0ICogVDEsCiAgICBQUk9WSVNJT05BTF9SRVNQT05TRV9JTlRFUlZBTDogNjAwMDAgIC8vIFNlZSBSRkMgMzI2MSBTZWN0aW9uIDEzLjMuMS4xCiAgfTsKCiAgWydzZXRUaW1lb3V0JywgJ2NsZWFyVGltZW91dCcsICdzZXRJbnRlcnZhbCcsICdjbGVhckludGVydmFsJ10KICAuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkgewogICAgLy8gY2FuJ3QganVzdCB1c2UgdGltZXJzW25hbWVdLmJpbmQodGltZXJzKSBzaW5jZSBpdCBieXBhc3NlcyBqYXNtaW5lJ3MKICAgIC8vIGNsb2NrLW1vY2tpbmcKICAgIFRpbWVyc1tuYW1lXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRpbWVyc1tuYW1lXS5hcHBseSh0aW1lcnMsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0pOwoKICByZXR1cm4gVGltZXJzOwp9OwoKfSx7fV0sMzE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IFNJUCBUcmFuc2FjdGlvbnMKICovCgovKioKICogU0lQIFRyYW5zYWN0aW9ucyBtb2R1bGUuCiAqIEBhdWdtZW50cyBTSVAKICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewp2YXIKICBDID0gewogICAgLy8gVHJhbnNhY3Rpb24gc3RhdGVzCiAgICBTVEFUVVNfVFJZSU5HOiAgICAgMSwKICAgIFNUQVRVU19QUk9DRUVESU5HOiAyLAogICAgU1RBVFVTX0NBTExJTkc6ICAgIDMsCiAgICBTVEFUVVNfQUNDRVBURUQ6ICAgNCwKICAgIFNUQVRVU19DT01QTEVURUQ6ICA1LAogICAgU1RBVFVTX1RFUk1JTkFURUQ6IDYsCiAgICBTVEFUVVNfQ09ORklSTUVEOiAgNywKCiAgICAvLyBUcmFuc2FjdGlvbiB0eXBlcwogICAgTk9OX0lOVklURV9DTElFTlQ6ICduaWN0JywKICAgIE5PTl9JTlZJVEVfU0VSVkVSOiAnbmlzdCcsCiAgICBJTlZJVEVfQ0xJRU5UOiAnaWN0JywKICAgIElOVklURV9TRVJWRVI6ICdpc3QnCiAgfTsKCmZ1bmN0aW9uIGJ1aWxkVmlhSGVhZGVyIChyZXF1ZXN0X3NlbmRlciwgdHJhbnNwb3J0LCBpZCkgewogIHZhciB2aWE7CiAgdmlhID0gJ1NJUC8yLjAvJyArIChyZXF1ZXN0X3NlbmRlci51YS5jb25maWd1cmF0aW9uLmhhY2tWaWFUY3AgPyAnVENQJyA6IHRyYW5zcG9ydC5zZXJ2ZXIuc2NoZW1lKTsKICB2aWEgKz0gJyAnICsgcmVxdWVzdF9zZW5kZXIudWEuY29uZmlndXJhdGlvbi52aWFIb3N0ICsgJzticmFuY2g9JyArIGlkOwogIGlmIChyZXF1ZXN0X3NlbmRlci51YS5jb25maWd1cmF0aW9uLmZvcmNlUnBvcnQpIHsKICAgIHZpYSArPSAnO3Jwb3J0JzsKICB9CiAgcmV0dXJuIHZpYTsKfQoKLyoqCiogQGF1Z21lbnRzIFNJUC5UcmFuc2FjdGlvbnMKKiBAY2xhc3MgTm9uIEludml0ZSBDbGllbnQgVHJhbnNhY3Rpb24KKiBAcGFyYW0ge1NJUC5SZXF1ZXN0U2VuZGVyfSByZXF1ZXN0X3NlbmRlcgoqIEBwYXJhbSB7U0lQLk91dGdvaW5nUmVxdWVzdH0gcmVxdWVzdAoqIEBwYXJhbSB7U0lQLlRyYW5zcG9ydH0gdHJhbnNwb3J0CiovCnZhciBOb25JbnZpdGVDbGllbnRUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uKHJlcXVlc3Rfc2VuZGVyLCByZXF1ZXN0LCB0cmFuc3BvcnQpIHsKICB2YXIgdmlhOwoKICB0aGlzLnR5cGUgPSBDLk5PTl9JTlZJVEVfQ0xJRU5UOwogIHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0OwogIHRoaXMuaWQgPSAnejloRzRiSycgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMCk7CiAgdGhpcy5yZXF1ZXN0X3NlbmRlciA9IHJlcXVlc3Rfc2VuZGVyOwogIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7CgogIHRoaXMubG9nZ2VyID0gcmVxdWVzdF9zZW5kZXIudWEuZ2V0TG9nZ2VyKCdzaXAudHJhbnNhY3Rpb24ubmljdCcsIHRoaXMuaWQpOwoKICB2aWEgPSBidWlsZFZpYUhlYWRlcihyZXF1ZXN0X3NlbmRlciwgdHJhbnNwb3J0LCB0aGlzLmlkKTsKICB0aGlzLnJlcXVlc3Quc2V0SGVhZGVyKCd2aWEnLCB2aWEpOwoKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnVhLm5ld1RyYW5zYWN0aW9uKHRoaXMpOwp9OwpOb25JbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKCk5vbkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5zdGF0ZUNoYW5nZWQgPSBmdW5jdGlvbihzdGF0ZSkgewogIHRoaXMuc3RhdGUgPSBzdGF0ZTsKICB0aGlzLmVtaXQoJ3N0YXRlQ2hhbmdlZCcpOwp9OwoKTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbigpIHsKICB2YXIgdHIgPSB0aGlzOwoKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19UUllJTkcpOwogIHRoaXMuRiA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9GLmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX0YpOwoKICBpZighdGhpcy50cmFuc3BvcnQuc2VuZCh0aGlzLnJlcXVlc3QpKSB7CiAgICB0aGlzLm9uVHJhbnNwb3J0RXJyb3IoKTsKICB9Cn07CgpOb25JbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUub25UcmFuc3BvcnRFcnJvciA9IGZ1bmN0aW9uKCkgewogIHRoaXMubG9nZ2VyLmxvZygndHJhbnNwb3J0IGVycm9yIG9jY3VycmVkLCBkZWxldGluZyBub24tSU5WSVRFIGNsaWVudCB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CiAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5GKTsKICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLkspOwogIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogIHRoaXMucmVxdWVzdF9zZW5kZXIudWEuZGVzdHJveVRyYW5zYWN0aW9uKHRoaXMpOwogIHRoaXMucmVxdWVzdF9zZW5kZXIub25UcmFuc3BvcnRFcnJvcigpOwp9OwoKTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLnRpbWVyX0YgPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ1RpbWVyIEYgZXhwaXJlZCBmb3Igbm9uLUlOVklURSBjbGllbnQgdHJhbnNhY3Rpb24gJyArIHRoaXMuaWQpOwogIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogIHRoaXMucmVxdWVzdF9zZW5kZXIudWEuZGVzdHJveVRyYW5zYWN0aW9uKHRoaXMpOwogIHRoaXMucmVxdWVzdF9zZW5kZXIub25SZXF1ZXN0VGltZW91dCgpOwp9OwoKTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLnRpbWVyX0sgPSBmdW5jdGlvbigpIHsKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKfTsKCk5vbkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5yZWNlaXZlUmVzcG9uc2UgPSBmdW5jdGlvbihyZXNwb25zZSkgewogIHZhcgogICAgdHIgPSB0aGlzLAogICAgc3RhdHVzX2NvZGUgPSByZXNwb25zZS5zdGF0dXNfY29kZTsKCiAgaWYoc3RhdHVzX2NvZGUgPCAyMDApIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfVFJZSU5HOgogICAgICBjYXNlIEMuU1RBVFVTX1BST0NFRURJTkc6CiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfUFJPQ0VFRElORyk7CiAgICAgICAgdGhpcy5yZXF1ZXN0X3NlbmRlci5yZWNlaXZlUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICAgIGJyZWFrOwogICAgfQogIH0gZWxzZSB7CiAgICBzd2l0Y2godGhpcy5zdGF0ZSkgewogICAgICBjYXNlIEMuU1RBVFVTX1RSWUlORzoKICAgICAgY2FzZSBDLlNUQVRVU19QUk9DRUVESU5HOgogICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX0NPTVBMRVRFRCk7CiAgICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5GKTsKCiAgICAgICAgaWYoc3RhdHVzX2NvZGUgPT09IDQwOCkgewogICAgICAgICAgdGhpcy5yZXF1ZXN0X3NlbmRlci5vblJlcXVlc3RUaW1lb3V0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuSyA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9LLmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX0spOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIEMuU1RBVFVTX0NPTVBMRVRFRDoKICAgICAgICBicmVhazsKICAgIH0KICB9Cn07CgoKCi8qKgoqIEBhdWdtZW50cyBTSVAuVHJhbnNhY3Rpb25zCiogQGNsYXNzIEludml0ZSBDbGllbnQgVHJhbnNhY3Rpb24KKiBAcGFyYW0ge1NJUC5SZXF1ZXN0U2VuZGVyfSByZXF1ZXN0X3NlbmRlcgoqIEBwYXJhbSB7U0lQLk91dGdvaW5nUmVxdWVzdH0gcmVxdWVzdAoqIEBwYXJhbSB7U0lQLlRyYW5zcG9ydH0gdHJhbnNwb3J0CiovCnZhciBJbnZpdGVDbGllbnRUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uKHJlcXVlc3Rfc2VuZGVyLCByZXF1ZXN0LCB0cmFuc3BvcnQpIHsKICB2YXIgdmlhLAogICAgdHIgPSB0aGlzOwoKICB0aGlzLnR5cGUgPSBDLklOVklURV9DTElFTlQ7CiAgdGhpcy50cmFuc3BvcnQgPSB0cmFuc3BvcnQ7CiAgdGhpcy5pZCA9ICd6OWhHNGJLJyArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwMDAwKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyID0gcmVxdWVzdF9zZW5kZXI7CiAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDsKCiAgdGhpcy5sb2dnZXIgPSByZXF1ZXN0X3NlbmRlci51YS5nZXRMb2dnZXIoJ3NpcC50cmFuc2FjdGlvbi5pY3QnLCB0aGlzLmlkKTsKCiAgdmlhID0gYnVpbGRWaWFIZWFkZXIocmVxdWVzdF9zZW5kZXIsIHRyYW5zcG9ydCwgdGhpcy5pZCk7CiAgdGhpcy5yZXF1ZXN0LnNldEhlYWRlcigndmlhJywgdmlhKTsKCiAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5uZXdUcmFuc2FjdGlvbih0aGlzKTsKCiAgLy8gQWRkIHRoZSBjYW5jZWwgcHJvcGVydHkgdG8gdGhlIHJlcXVlc3QuCiAgLy9XaWxsIGJlIGNhbGxlZCBmcm9tIHRoZSByZXF1ZXN0IGluc3RhbmNlLCBub3QgdGhlIHRyYW5zYWN0aW9uIGl0c2VsZi4KICB0aGlzLnJlcXVlc3QuY2FuY2VsID0gZnVuY3Rpb24ocmVhc29uKSB7CiAgICB0ci5jYW5jZWxfcmVxdWVzdCh0ciwgcmVhc29uKTsKICB9Owp9OwpJbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKCkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5zdGF0ZUNoYW5nZWQgPSBmdW5jdGlvbihzdGF0ZSkgewogIHRoaXMuc3RhdGUgPSBzdGF0ZTsKICB0aGlzLmVtaXQoJ3N0YXRlQ2hhbmdlZCcpOwp9OwoKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbigpIHsKICB2YXIgdHIgPSB0aGlzOwogIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX0NBTExJTkcpOwogIHRoaXMuQiA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9CLmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX0IpOwoKICBpZighdGhpcy50cmFuc3BvcnQuc2VuZCh0aGlzLnJlcXVlc3QpKSB7CiAgICB0aGlzLm9uVHJhbnNwb3J0RXJyb3IoKTsKICB9Cn07CgpJbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUub25UcmFuc3BvcnRFcnJvciA9IGZ1bmN0aW9uKCkgewogIHRoaXMubG9nZ2VyLmxvZygndHJhbnNwb3J0IGVycm9yIG9jY3VycmVkLCBkZWxldGluZyBJTlZJVEUgY2xpZW50IHRyYW5zYWN0aW9uICcgKyB0aGlzLmlkKTsKICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLkIpOwogIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMuRCk7CiAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5NKTsKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKCiAgaWYgKHRoaXMuc3RhdGUgIT09IEMuU1RBVFVTX0FDQ0VQVEVEKSB7CiAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLm9uVHJhbnNwb3J0RXJyb3IoKTsKICB9Cn07CgovLyBSRkMgNjAyNiA3LjIKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLnRpbWVyX00gPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ1RpbWVyIE0gZXhwaXJlZCBmb3IgSU5WSVRFIGNsaWVudCB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CgogIGlmKHRoaXMuc3RhdGUgPT09IEMuU1RBVFVTX0FDQ0VQVEVEKSB7CiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLkIpOwogICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKICB9Cn07CgovLyBSRkMgMzI2MSAxNy4xLjEKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLnRpbWVyX0IgPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ1RpbWVyIEIgZXhwaXJlZCBmb3IgSU5WSVRFIGNsaWVudCB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CiAgaWYodGhpcy5zdGF0ZSA9PT0gQy5TVEFUVVNfQ0FMTElORykgewogICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgICB0aGlzLnJlcXVlc3Rfc2VuZGVyLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKICAgIHRoaXMucmVxdWVzdF9zZW5kZXIub25SZXF1ZXN0VGltZW91dCgpOwogIH0KfTsKCkludml0ZUNsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS50aW1lcl9EID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5sb2dnZXIubG9nKCdUaW1lciBEIGV4cGlyZWQgZm9yIElOVklURSBjbGllbnQgdHJhbnNhY3Rpb24gJyArIHRoaXMuaWQpOwogIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMuQik7CiAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgdGhpcy5yZXF1ZXN0X3NlbmRlci51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7Cn07CgpJbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUuc2VuZEFDSyA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgdmFyIHRyID0gdGhpczsKCiAgdGhpcy5hY2sgPSAnQUNLICcgKyB0aGlzLnJlcXVlc3QucnVyaSArICcgU0lQLzIuMFxyXG4nOwogIHRoaXMuYWNrICs9ICdWaWE6ICcgKyB0aGlzLnJlcXVlc3QuaGVhZGVyc1snVmlhJ10udG9TdHJpbmcoKSArICdcclxuJzsKCiAgaWYodGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ1JvdXRlJ10pIHsKICAgIHRoaXMuYWNrICs9ICdSb3V0ZTogJyArIHRoaXMucmVxdWVzdC5oZWFkZXJzWydSb3V0ZSddLnRvU3RyaW5nKCkgKyAnXHJcbic7CiAgfQoKICB0aGlzLmFjayArPSAnVG86ICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ3RvJykgKyAnXHJcbic7CiAgdGhpcy5hY2sgKz0gJ0Zyb206ICcgKyB0aGlzLnJlcXVlc3QuaGVhZGVyc1snRnJvbSddLnRvU3RyaW5nKCkgKyAnXHJcbic7CiAgdGhpcy5hY2sgKz0gJ0NhbGwtSUQ6ICcgKyB0aGlzLnJlcXVlc3QuaGVhZGVyc1snQ2FsbC1JRCddLnRvU3RyaW5nKCkgKyAnXHJcbic7CiAgdGhpcy5hY2sgKz0gJ0NvbnRlbnQtTGVuZ3RoOiAwXHJcbic7CiAgdGhpcy5hY2sgKz0gJ0NTZXE6ICcgKyB0aGlzLnJlcXVlc3QuaGVhZGVyc1snQ1NlcSddLnRvU3RyaW5nKCkuc3BsaXQoJyAnKVswXTsKICB0aGlzLmFjayArPSAnIEFDS1xyXG5cclxuJzsKCiAgdGhpcy5EID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KHRyLnRpbWVyX0QuYmluZCh0ciksIFNJUC5UaW1lcnMuVElNRVJfRCk7CgogIHRoaXMudHJhbnNwb3J0LnNlbmQodGhpcy5hY2spOwp9OwoKSW52aXRlQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLmNhbmNlbF9yZXF1ZXN0ID0gZnVuY3Rpb24odHIsIHJlYXNvbikgewogIHZhciByZXF1ZXN0ID0gdHIucmVxdWVzdDsKCiAgdGhpcy5jYW5jZWwgPSBTSVAuQy5DQU5DRUwgKyAnICcgKyByZXF1ZXN0LnJ1cmkgKyAnIFNJUC8yLjBcclxuJzsKICB0aGlzLmNhbmNlbCArPSAnVmlhOiAnICsgcmVxdWVzdC5oZWFkZXJzWydWaWEnXS50b1N0cmluZygpICsgJ1xyXG4nOwoKICBpZih0aGlzLnJlcXVlc3QuaGVhZGVyc1snUm91dGUnXSkgewogICAgdGhpcy5jYW5jZWwgKz0gJ1JvdXRlOiAnICsgcmVxdWVzdC5oZWFkZXJzWydSb3V0ZSddLnRvU3RyaW5nKCkgKyAnXHJcbic7CiAgfQoKICB0aGlzLmNhbmNlbCArPSAnVG86ICcgKyByZXF1ZXN0LmhlYWRlcnNbJ1RvJ10udG9TdHJpbmcoKSArICdcclxuJzsKICB0aGlzLmNhbmNlbCArPSAnRnJvbTogJyArIHJlcXVlc3QuaGVhZGVyc1snRnJvbSddLnRvU3RyaW5nKCkgKyAnXHJcbic7CiAgdGhpcy5jYW5jZWwgKz0gJ0NhbGwtSUQ6ICcgKyByZXF1ZXN0LmhlYWRlcnNbJ0NhbGwtSUQnXS50b1N0cmluZygpICsgJ1xyXG4nOwogIHRoaXMuY2FuY2VsICs9ICdDU2VxOiAnICsgcmVxdWVzdC5oZWFkZXJzWydDU2VxJ10udG9TdHJpbmcoKS5zcGxpdCgnICcpWzBdICsKICAnIENBTkNFTFxyXG4nOwoKICBpZihyZWFzb24pIHsKICAgIHRoaXMuY2FuY2VsICs9ICdSZWFzb246ICcgKyByZWFzb24gKyAnXHJcbic7CiAgfQoKICB0aGlzLmNhbmNlbCArPSAnQ29udGVudC1MZW5ndGg6IDBcclxuXHJcbic7CgogIC8vIFNlbmQgb25seSBpZiBhIHByb3Zpc2lvbmFsIHJlc3BvbnNlICg+MTAwKSBoYXMgYmVlbiByZWNlaXZlZC4KICBpZih0aGlzLnN0YXRlID09PSBDLlNUQVRVU19QUk9DRUVESU5HKSB7CiAgICB0aGlzLnRyYW5zcG9ydC5zZW5kKHRoaXMuY2FuY2VsKTsKICB9Cn07CgpJbnZpdGVDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUucmVjZWl2ZVJlc3BvbnNlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHsKICB2YXIKICB0ciA9IHRoaXMsCiAgc3RhdHVzX2NvZGUgPSByZXNwb25zZS5zdGF0dXNfY29kZTsKCiAgaWYoc3RhdHVzX2NvZGUgPj0gMTAwICYmIHN0YXR1c19jb2RlIDw9IDE5OSkgewogICAgc3dpdGNoKHRoaXMuc3RhdGUpIHsKICAgICAgY2FzZSBDLlNUQVRVU19DQUxMSU5HOgogICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1BST0NFRURJTkcpOwogICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICBpZih0aGlzLmNhbmNlbCkgewogICAgICAgICAgdGhpcy50cmFuc3BvcnQuc2VuZCh0aGlzLmNhbmNlbCk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIEMuU1RBVFVTX1BST0NFRURJTkc6CiAgICAgICAgdGhpcy5yZXF1ZXN0X3NlbmRlci5yZWNlaXZlUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICAgIGJyZWFrOwogICAgfQogIH0gZWxzZSBpZihzdGF0dXNfY29kZSA+PSAyMDAgJiYgc3RhdHVzX2NvZGUgPD0gMjk5KSB7CiAgICBzd2l0Y2godGhpcy5zdGF0ZSkgewogICAgICBjYXNlIEMuU1RBVFVTX0NBTExJTkc6CiAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19BQ0NFUFRFRCk7CiAgICAgICAgdGhpcy5NID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KHRyLnRpbWVyX00uYmluZCh0ciksIFNJUC5UaW1lcnMuVElNRVJfTSk7CiAgICAgICAgdGhpcy5yZXF1ZXN0X3NlbmRlci5yZWNlaXZlUmVzcG9uc2UocmVzcG9uc2UpOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIEMuU1RBVFVTX0FDQ0VQVEVEOgogICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICBicmVhazsKICAgIH0KICB9IGVsc2UgaWYoc3RhdHVzX2NvZGUgPj0gMzAwICYmIHN0YXR1c19jb2RlIDw9IDY5OSkgewogICAgc3dpdGNoKHRoaXMuc3RhdGUpIHsKICAgICAgY2FzZSBDLlNUQVRVU19DQUxMSU5HOgogICAgICBjYXNlIEMuU1RBVFVTX1BST0NFRURJTkc6CiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfQ09NUExFVEVEKTsKICAgICAgICB0aGlzLnNlbmRBQ0socmVzcG9uc2UpOwogICAgICAgIHRoaXMucmVxdWVzdF9zZW5kZXIucmVjZWl2ZVJlc3BvbnNlKHJlc3BvbnNlKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBDLlNUQVRVU19DT01QTEVURUQ6CiAgICAgICAgdGhpcy5zZW5kQUNLKHJlc3BvbnNlKTsKICAgICAgICBicmVhazsKICAgIH0KICB9Cn07CgoKLyoqCiAqIEBhdWdtZW50cyBTSVAuVHJhbnNhY3Rpb25zCiAqIEBjbGFzcyBBQ0sgQ2xpZW50IFRyYW5zYWN0aW9uCiAqIEBwYXJhbSB7U0lQLlJlcXVlc3RTZW5kZXJ9IHJlcXVlc3Rfc2VuZGVyCiAqIEBwYXJhbSB7U0lQLk91dGdvaW5nUmVxdWVzdH0gcmVxdWVzdAogKiBAcGFyYW0ge1NJUC5UcmFuc3BvcnR9IHRyYW5zcG9ydAogKi8KdmFyIEFja0NsaWVudFRyYW5zYWN0aW9uID0gZnVuY3Rpb24ocmVxdWVzdF9zZW5kZXIsIHJlcXVlc3QsIHRyYW5zcG9ydCkgewogIHZhciB2aWE7CgogIHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0OwogIHRoaXMuaWQgPSAnejloRzRiSycgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMCk7CiAgdGhpcy5yZXF1ZXN0X3NlbmRlciA9IHJlcXVlc3Rfc2VuZGVyOwogIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7CgogIHRoaXMubG9nZ2VyID0gcmVxdWVzdF9zZW5kZXIudWEuZ2V0TG9nZ2VyKCdzaXAudHJhbnNhY3Rpb24ubmljdCcsIHRoaXMuaWQpOwoKICB2aWEgPSBidWlsZFZpYUhlYWRlcihyZXF1ZXN0X3NlbmRlciwgdHJhbnNwb3J0LCB0aGlzLmlkKTsKICB0aGlzLnJlcXVlc3Quc2V0SGVhZGVyKCd2aWEnLCB2aWEpOwp9OwpBY2tDbGllbnRUcmFuc2FjdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKCkFja0NsaWVudFRyYW5zYWN0aW9uLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24oKSB7CiAgaWYoIXRoaXMudHJhbnNwb3J0LnNlbmQodGhpcy5yZXF1ZXN0KSkgewogICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgfQp9OwoKQWNrQ2xpZW50VHJhbnNhY3Rpb24ucHJvdG90eXBlLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICB0aGlzLmxvZ2dlci5sb2coJ3RyYW5zcG9ydCBlcnJvciBvY2N1cnJlZCwgZm9yIGFuIEFDSyBjbGllbnQgdHJhbnNhY3Rpb24gJyArIHRoaXMuaWQpOwogIHRoaXMucmVxdWVzdF9zZW5kZXIub25UcmFuc3BvcnRFcnJvcigpOwp9OwoKCi8qKgoqIEBhdWdtZW50cyBTSVAuVHJhbnNhY3Rpb25zCiogQGNsYXNzIE5vbiBJbnZpdGUgU2VydmVyIFRyYW5zYWN0aW9uCiogQHBhcmFtIHtTSVAuSW5jb21pbmdSZXF1ZXN0fSByZXF1ZXN0CiogQHBhcmFtIHtTSVAuVUF9IHVhCiovCnZhciBOb25JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uKHJlcXVlc3QsIHVhKSB7CiAgdGhpcy50eXBlID0gQy5OT05fSU5WSVRFX1NFUlZFUjsKICB0aGlzLmlkID0gcmVxdWVzdC52aWFfYnJhbmNoOwogIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7CiAgdGhpcy50cmFuc3BvcnQgPSByZXF1ZXN0LnRyYW5zcG9ydDsKICB0aGlzLnVhID0gdWE7CiAgdGhpcy5sYXN0X3Jlc3BvbnNlID0gJyc7CiAgcmVxdWVzdC5zZXJ2ZXJfdHJhbnNhY3Rpb24gPSB0aGlzOwoKICB0aGlzLmxvZ2dlciA9IHVhLmdldExvZ2dlcignc2lwLnRyYW5zYWN0aW9uLm5pc3QnLCB0aGlzLmlkKTsKCiAgdGhpcy5zdGF0ZSA9IEMuU1RBVFVTX1RSWUlORzsKCiAgdWEubmV3VHJhbnNhY3Rpb24odGhpcyk7Cn07Ck5vbkludml0ZVNlcnZlclRyYW5zYWN0aW9uLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU0lQLkV2ZW50RW1pdHRlci5wcm90b3R5cGUpOwoKTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnN0YXRlQ2hhbmdlZCA9IGZ1bmN0aW9uKHN0YXRlKSB7CiAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogIHRoaXMuZW1pdCgnc3RhdGVDaGFuZ2VkJyk7Cn07CgpOb25JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUudGltZXJfSiA9IGZ1bmN0aW9uKCkgewogIHRoaXMubG9nZ2VyLmxvZygnVGltZXIgSiBleHBpcmVkIGZvciBub24tSU5WSVRFIHNlcnZlciB0cmFuc2FjdGlvbiAnICsgdGhpcy5pZCk7CiAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgdGhpcy51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7Cn07CgpOb25JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUub25UcmFuc3BvcnRFcnJvciA9IGZ1bmN0aW9uKCkgewogIGlmICghdGhpcy50cmFuc3BvcnRFcnJvcikgewogICAgdGhpcy50cmFuc3BvcnRFcnJvciA9IHRydWU7CgogICAgdGhpcy5sb2dnZXIubG9nKCd0cmFuc3BvcnQgZXJyb3Igb2NjdXJyZWQsIGRlbGV0aW5nIG5vbi1JTlZJVEUgc2VydmVyIHRyYW5zYWN0aW9uICcgKyB0aGlzLmlkKTsKCiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLkopOwogICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfVEVSTUlOQVRFRCk7CiAgICB0aGlzLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKICB9Cn07CgpOb25JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUucmVjZWl2ZVJlc3BvbnNlID0gZnVuY3Rpb24oc3RhdHVzX2NvZGUsIHJlc3BvbnNlKSB7CiAgdmFyIHRyID0gdGhpczsKICB2YXIgZGVmZXJyZWQgPSBTSVAuVXRpbHMuZGVmZXIoKTsKCiAgaWYoc3RhdHVzX2NvZGUgPT09IDEwMCkgewogICAgLyogUkZDIDQzMjAgNC4xCiAgICAgKiAnQSBTSVAgZWxlbWVudCBNVVNUIE5PVAogICAgICogc2VuZCBhbnkgcHJvdmlzaW9uYWwgcmVzcG9uc2Ugd2l0aCBhCiAgICAgKiBTdGF0dXMtQ29kZSBvdGhlciB0aGFuIDEwMCB0byBhIG5vbi1JTlZJVEUgcmVxdWVzdC4nCiAgICAgKi8KICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfVFJZSU5HOgogICAgICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1BST0NFRURJTkcpOwogICAgICAgIGlmKCF0aGlzLnRyYW5zcG9ydC5zZW5kKHJlc3BvbnNlKSkgIHsKICAgICAgICAgIHRoaXMub25UcmFuc3BvcnRFcnJvcigpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBDLlNUQVRVU19QUk9DRUVESU5HOgogICAgICAgIHRoaXMubGFzdF9yZXNwb25zZSA9IHJlc3BvbnNlOwogICAgICAgIGlmKCF0aGlzLnRyYW5zcG9ydC5zZW5kKHJlc3BvbnNlKSkgewogICAgICAgICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgIH0KICB9IGVsc2UgaWYoc3RhdHVzX2NvZGUgPj0gMjAwICYmIHN0YXR1c19jb2RlIDw9IDY5OSkgewogICAgc3dpdGNoKHRoaXMuc3RhdGUpIHsKICAgICAgY2FzZSBDLlNUQVRVU19UUllJTkc6CiAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19DT01QTEVURUQpOwogICAgICAgIHRoaXMubGFzdF9yZXNwb25zZSA9IHJlc3BvbnNlOwogICAgICAgIHRoaXMuSiA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9KLmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX0opOwogICAgICAgIGlmKCF0aGlzLnRyYW5zcG9ydC5zZW5kKHJlc3BvbnNlKSkgewogICAgICAgICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSBDLlNUQVRVU19DT01QTEVURUQ6CiAgICAgICAgYnJlYWs7CiAgICB9CiAgfQoKICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTsKfTsKCi8qKgoqIEBhdWdtZW50cyBTSVAuVHJhbnNhY3Rpb25zCiogQGNsYXNzIEludml0ZSBTZXJ2ZXIgVHJhbnNhY3Rpb24KKiBAcGFyYW0ge1NJUC5JbmNvbWluZ1JlcXVlc3R9IHJlcXVlc3QKKiBAcGFyYW0ge1NJUC5VQX0gdWEKKi8KdmFyIEludml0ZVNlcnZlclRyYW5zYWN0aW9uID0gZnVuY3Rpb24ocmVxdWVzdCwgdWEpIHsKICB0aGlzLnR5cGUgPSBDLklOVklURV9TRVJWRVI7CiAgdGhpcy5pZCA9IHJlcXVlc3QudmlhX2JyYW5jaDsKICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0OwogIHRoaXMudHJhbnNwb3J0ID0gcmVxdWVzdC50cmFuc3BvcnQ7CiAgdGhpcy51YSA9IHVhOwogIHRoaXMubGFzdF9yZXNwb25zZSA9ICcnOwogIHJlcXVlc3Quc2VydmVyX3RyYW5zYWN0aW9uID0gdGhpczsKCiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC50cmFuc2FjdGlvbi5pc3QnLCB0aGlzLmlkKTsKCiAgdGhpcy5zdGF0ZSA9IEMuU1RBVFVTX1BST0NFRURJTkc7CgogIHVhLm5ld1RyYW5zYWN0aW9uKHRoaXMpOwoKICB0aGlzLnJlc2VuZFByb3Zpc2lvbmFsVGltZXIgPSBudWxsOwoKICByZXF1ZXN0LnJlcGx5KDEwMCk7Cn07Ckludml0ZVNlcnZlclRyYW5zYWN0aW9uLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU0lQLkV2ZW50RW1pdHRlci5wcm90b3R5cGUpOwoKSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnN0YXRlQ2hhbmdlZCA9IGZ1bmN0aW9uKHN0YXRlKSB7CiAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogIHRoaXMuZW1pdCgnc3RhdGVDaGFuZ2VkJyk7Cn07CgpJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUudGltZXJfSCA9IGZ1bmN0aW9uKCkgewogIHRoaXMubG9nZ2VyLmxvZygnVGltZXIgSCBleHBpcmVkIGZvciBJTlZJVEUgc2VydmVyIHRyYW5zYWN0aW9uICcgKyB0aGlzLmlkKTsKCiAgaWYodGhpcy5zdGF0ZSA9PT0gQy5TVEFUVVNfQ09NUExFVEVEKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCd0cmFuc2FjdGlvbnMnLCAnQUNLIGZvciBJTlZJVEUgc2VydmVyIHRyYW5zYWN0aW9uIHdhcyBuZXZlciByZWNlaXZlZCwgY2FsbCB3aWxsIGJlIHRlcm1pbmF0ZWQnKTsKICB9CgogIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogIHRoaXMudWEuZGVzdHJveVRyYW5zYWN0aW9uKHRoaXMpOwp9OwoKSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLnRpbWVyX0kgPSBmdW5jdGlvbigpIHsKICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICB0aGlzLnVhLmRlc3Ryb3lUcmFuc2FjdGlvbih0aGlzKTsKfTsKCi8vIFJGQyA2MDI2IDcuMQpJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUudGltZXJfTCA9IGZ1bmN0aW9uKCkgewogIHRoaXMubG9nZ2VyLmxvZygnVGltZXIgTCBleHBpcmVkIGZvciBJTlZJVEUgc2VydmVyIHRyYW5zYWN0aW9uICcgKyB0aGlzLmlkKTsKCiAgaWYodGhpcy5zdGF0ZSA9PT0gQy5TVEFUVVNfQUNDRVBURUQpIHsKICAgIHRoaXMuc3RhdGVDaGFuZ2VkKEMuU1RBVFVTX1RFUk1JTkFURUQpOwogICAgdGhpcy51YS5kZXN0cm95VHJhbnNhY3Rpb24odGhpcyk7CiAgfQp9OwoKSW52aXRlU2VydmVyVHJhbnNhY3Rpb24ucHJvdG90eXBlLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbigpIHsKICBpZiAoIXRoaXMudHJhbnNwb3J0RXJyb3IpIHsKICAgIHRoaXMudHJhbnNwb3J0RXJyb3IgPSB0cnVlOwoKICAgIHRoaXMubG9nZ2VyLmxvZygndHJhbnNwb3J0IGVycm9yIG9jY3VycmVkLCBkZWxldGluZyBJTlZJVEUgc2VydmVyIHRyYW5zYWN0aW9uICcgKyB0aGlzLmlkKTsKCiAgICBpZiAodGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyICE9PSBudWxsKSB7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJJbnRlcnZhbCh0aGlzLnJlc2VuZFByb3Zpc2lvbmFsVGltZXIpOwogICAgICB0aGlzLnJlc2VuZFByb3Zpc2lvbmFsVGltZXIgPSBudWxsOwogICAgfQoKICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMuTCk7CiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLkgpOwogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5JKTsKCiAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19URVJNSU5BVEVEKTsKICAgIHRoaXMudWEuZGVzdHJveVRyYW5zYWN0aW9uKHRoaXMpOwogIH0KfTsKCkludml0ZVNlcnZlclRyYW5zYWN0aW9uLnByb3RvdHlwZS5yZXNlbmRfcHJvdmlzaW9uYWwgPSBmdW5jdGlvbigpIHsKICBpZighdGhpcy50cmFuc3BvcnQuc2VuZCh0aGlzLmxhc3RfcmVzcG9uc2UpKSB7CiAgICB0aGlzLm9uVHJhbnNwb3J0RXJyb3IoKTsKICB9Cn07CgovLyBJTlZJVEUgU2VydmVyIFRyYW5zYWN0aW9uIFJGQyAzMjYxIDE3LjIuMQpJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbi5wcm90b3R5cGUucmVjZWl2ZVJlc3BvbnNlID0gZnVuY3Rpb24oc3RhdHVzX2NvZGUsIHJlc3BvbnNlKSB7CiAgdmFyIHRyID0gdGhpczsKICB2YXIgZGVmZXJyZWQgPSBTSVAuVXRpbHMuZGVmZXIoKTsKCiAgaWYoc3RhdHVzX2NvZGUgPj0gMTAwICYmIHN0YXR1c19jb2RlIDw9IDE5OSkgewogICAgc3dpdGNoKHRoaXMuc3RhdGUpIHsKICAgICAgY2FzZSBDLlNUQVRVU19QUk9DRUVESU5HOgogICAgICAgIGlmKCF0aGlzLnRyYW5zcG9ydC5zZW5kKHJlc3BvbnNlKSkgewogICAgICAgICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgICAgICAgfQogICAgICAgIHRoaXMubGFzdF9yZXNwb25zZSA9IHJlc3BvbnNlOwogICAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgaWYoc3RhdHVzX2NvZGUgPiAxMDAgJiYgc3RhdHVzX2NvZGUgPD0gMTk5ICYmIHRoaXMuc3RhdGUgPT09IEMuU1RBVFVTX1BST0NFRURJTkcpIHsKICAgIC8vIFRyaWdnZXIgdGhlIHJlc2VuZFByb3Zpc2lvbmFsVGltZXIgb25seSBmb3IgdGhlIGZpcnN0IG5vbiAxMDAgcHJvdmlzaW9uYWwgcmVzcG9uc2UuCiAgICBpZih0aGlzLnJlc2VuZFByb3Zpc2lvbmFsVGltZXIgPT09IG51bGwpIHsKICAgICAgdGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyID0gU0lQLlRpbWVycy5zZXRJbnRlcnZhbCh0ci5yZXNlbmRfcHJvdmlzaW9uYWwuYmluZCh0ciksCiAgICAgICAgU0lQLlRpbWVycy5QUk9WSVNJT05BTF9SRVNQT05TRV9JTlRFUlZBTCk7CiAgICB9CiAgfSBlbHNlIGlmKHN0YXR1c19jb2RlID49IDIwMCAmJiBzdGF0dXNfY29kZSA8PSAyOTkpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICB0aGlzLnN0YXRlQ2hhbmdlZChDLlNUQVRVU19BQ0NFUFRFRCk7CiAgICAgICAgdGhpcy5sYXN0X3Jlc3BvbnNlID0gcmVzcG9uc2U7CiAgICAgICAgdGhpcy5MID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KHRyLnRpbWVyX0wuYmluZCh0ciksIFNJUC5UaW1lcnMuVElNRVJfTCk7CgogICAgICAgIGlmICh0aGlzLnJlc2VuZFByb3Zpc2lvbmFsVGltZXIgIT09IG51bGwpIHsKICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJJbnRlcnZhbCh0aGlzLnJlc2VuZFByb3Zpc2lvbmFsVGltZXIpOwogICAgICAgICAgdGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgLyogZmFsbHMgdGhyb3VnaCAqLwogICAgICAgIGNhc2UgQy5TVEFUVVNfQUNDRVBURUQ6CiAgICAgICAgICAvLyBOb3RlIHRoYXQgdGhpcyBwb2ludCB3aWxsIGJlIHJlYWNoZWQgZm9yIHByb2NlZWRpbmcgdHIuc3RhdGUgYWxzby4KICAgICAgICAgIGlmKCF0aGlzLnRyYW5zcG9ydC5zZW5kKHJlc3BvbnNlKSkgewogICAgICAgICAgICB0aGlzLm9uVHJhbnNwb3J0RXJyb3IoKTsKICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgIH0KICB9IGVsc2UgaWYoc3RhdHVzX2NvZGUgPj0gMzAwICYmIHN0YXR1c19jb2RlIDw9IDY5OSkgewogICAgc3dpdGNoKHRoaXMuc3RhdGUpIHsKICAgICAgY2FzZSBDLlNUQVRVU19QUk9DRUVESU5HOgogICAgICAgIGlmICh0aGlzLnJlc2VuZFByb3Zpc2lvbmFsVGltZXIgIT09IG51bGwpIHsKICAgICAgICAgIFNJUC5UaW1lcnMuY2xlYXJJbnRlcnZhbCh0aGlzLnJlc2VuZFByb3Zpc2lvbmFsVGltZXIpOwogICAgICAgICAgdGhpcy5yZXNlbmRQcm92aXNpb25hbFRpbWVyID0gbnVsbDsKICAgICAgICB9CgogICAgICAgIGlmKCF0aGlzLnRyYW5zcG9ydC5zZW5kKHJlc3BvbnNlKSkgewogICAgICAgICAgdGhpcy5vblRyYW5zcG9ydEVycm9yKCk7CiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZWQoQy5TVEFUVVNfQ09NUExFVEVEKTsKICAgICAgICAgIHRoaXMuSCA9IFNJUC5UaW1lcnMuc2V0VGltZW91dCh0ci50aW1lcl9ILmJpbmQodHIpLCBTSVAuVGltZXJzLlRJTUVSX0gpOwogICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgIH0KICB9CgogIHJldHVybiBkZWZlcnJlZC5wcm9taXNlOwp9OwoKLyoqCiAqIEBmdW5jdGlvbgogKiBAcGFyYW0ge1NJUC5VQX0gdWEKICogQHBhcmFtIHtTSVAuSW5jb21pbmdSZXF1ZXN0fSByZXF1ZXN0CiAqCiAqIEByZXR1cm4ge2Jvb2xlYW59CiAqIElOVklURToKICogIF90cnVlXyBpZiByZXRyYW5zbWlzc2lvbgogKiAgX2ZhbHNlXyBuZXcgcmVxdWVzdAogKgogKiBBQ0s6CiAqICBfdHJ1ZV8gIEFDSyB0byBub24yeHggcmVzcG9uc2UKICogIF9mYWxzZV8gQUNLIG11c3QgYmUgcGFzc2VkIHRvIFRVIChhY2NlcHRlZCBzdGF0ZSkKICogICAgICAgICAgQUNLIHRvIDJ4eCByZXNwb25zZQogKgogKiBDQU5DRUw6CiAqICBfdHJ1ZV8gIG5vIG1hdGNoaW5nIGludml0ZSB0cmFuc2FjdGlvbgogKiAgX2ZhbHNlXyBtYXRjaGluZyBpbnZpdGUgdHJhbnNhY3Rpb24gYW5kIG5vIGZpbmFsIHJlc3BvbnNlIHNlbnQKICoKICogT1RIRVI6CiAqICBfdHJ1ZV8gIHJldHJhbnNtaXNzaW9uCiAqICBfZmFsc2VfIG5ldyByZXF1ZXN0CiAqLwp2YXIgY2hlY2tUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uKHVhLCByZXF1ZXN0KSB7CiAgdmFyIHRyOwoKICBzd2l0Y2gocmVxdWVzdC5tZXRob2QpIHsKICAgIGNhc2UgU0lQLkMuSU5WSVRFOgogICAgICB0ciA9IHVhLnRyYW5zYWN0aW9ucy5pc3RbcmVxdWVzdC52aWFfYnJhbmNoXTsKICAgICAgaWYodHIpIHsKICAgICAgICBzd2l0Y2godHIuc3RhdGUpIHsKICAgICAgICAgIGNhc2UgQy5TVEFUVVNfUFJPQ0VFRElORzoKICAgICAgICAgICAgdHIudHJhbnNwb3J0LnNlbmQodHIubGFzdF9yZXNwb25zZSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgLy8gUkZDIDYwMjYgNy4xIEludml0ZSByZXRyYW5zbWlzc2lvbgogICAgICAgICAgICAvL3JlY2VpdmVkIHdoaWxlIGluIEMuU1RBVFVTX0FDQ0VQVEVEIHN0YXRlLiBBYnNvcmIgaXQuCiAgICAgICAgICBjYXNlIEMuU1RBVFVTX0FDQ0VQVEVEOgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICBjYXNlIFNJUC5DLkFDSzoKICAgICAgdHIgPSB1YS50cmFuc2FjdGlvbnMuaXN0W3JlcXVlc3QudmlhX2JyYW5jaF07CgogICAgICAvLyBSRkMgNjAyNiA3LjEKICAgICAgaWYodHIpIHsKICAgICAgICBpZih0ci5zdGF0ZSA9PT0gQy5TVEFUVVNfQUNDRVBURUQpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgaWYodHIuc3RhdGUgPT09IEMuU1RBVFVTX0NPTVBMRVRFRCkgewogICAgICAgICAgdHIuc3RhdGUgPSBDLlNUQVRVU19DT05GSVJNRUQ7CiAgICAgICAgICB0ci5JID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KHRyLnRpbWVyX0kuYmluZCh0ciksIFNJUC5UaW1lcnMuVElNRVJfSSk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIEFDSyB0byAyWFggUmVzcG9uc2UuCiAgICAgIGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBicmVhazsKICAgIGNhc2UgU0lQLkMuQ0FOQ0VMOgogICAgICB0ciA9IHVhLnRyYW5zYWN0aW9ucy5pc3RbcmVxdWVzdC52aWFfYnJhbmNoXTsKICAgICAgaWYodHIpIHsKICAgICAgICByZXF1ZXN0LnJlcGx5X3NsKDIwMCk7CiAgICAgICAgaWYodHIuc3RhdGUgPT09IEMuU1RBVFVTX1BST0NFRURJTkcpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHJlcXVlc3QucmVwbHlfc2woNDgxKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICBicmVhazsKICAgIGRlZmF1bHQ6CgogICAgICAvLyBOb24tSU5WSVRFIFNlcnZlciBUcmFuc2FjdGlvbiBSRkMgMzI2MSAxNy4yLjIKICAgICAgdHIgPSB1YS50cmFuc2FjdGlvbnMubmlzdFtyZXF1ZXN0LnZpYV9icmFuY2hdOwogICAgICBpZih0cikgewogICAgICAgIHN3aXRjaCh0ci5zdGF0ZSkgewogICAgICAgICAgY2FzZSBDLlNUQVRVU19UUllJTkc6CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSBDLlNUQVRVU19QUk9DRUVESU5HOgogICAgICAgICAgY2FzZSBDLlNUQVRVU19DT01QTEVURUQ6CiAgICAgICAgICAgIHRyLnRyYW5zcG9ydC5zZW5kKHRyLmxhc3RfcmVzcG9uc2UpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgfQp9OwoKU0lQLlRyYW5zYWN0aW9ucyA9IHsKICBDOiBDLAogIGNoZWNrVHJhbnNhY3Rpb246IGNoZWNrVHJhbnNhY3Rpb24sCiAgTm9uSW52aXRlQ2xpZW50VHJhbnNhY3Rpb246IE5vbkludml0ZUNsaWVudFRyYW5zYWN0aW9uLAogIEludml0ZUNsaWVudFRyYW5zYWN0aW9uOiBJbnZpdGVDbGllbnRUcmFuc2FjdGlvbiwKICBBY2tDbGllbnRUcmFuc2FjdGlvbjogQWNrQ2xpZW50VHJhbnNhY3Rpb24sCiAgTm9uSW52aXRlU2VydmVyVHJhbnNhY3Rpb246IE5vbkludml0ZVNlcnZlclRyYW5zYWN0aW9uLAogIEludml0ZVNlcnZlclRyYW5zYWN0aW9uOiBJbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbgp9OwoKfTsKCn0se31dLDMyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBUcmFuc3BvcnQKICovCgovKioKICogQGF1Z21lbnRzIFNJUAogKiBAY2xhc3MgVHJhbnNwb3J0CiAqIEBwYXJhbSB7U0lQLlVBfSB1YQogKiBAcGFyYW0ge09iamVjdH0gc2VydmVyIHdzX3NlcnZlciBPYmplY3QKICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCwgV2ViU29ja2V0KSB7CnZhciBUcmFuc3BvcnQsCiAgQyA9IHsKICAgIC8vIFRyYW5zcG9ydCBzdGF0dXMgY29kZXMKICAgIFNUQVRVU19SRUFEWTogICAgICAgIDAsCiAgICBTVEFUVVNfRElTQ09OTkVDVEVEOiAxLAogICAgU1RBVFVTX0VSUk9SOiAgICAgICAgMgogIH07CgovKioKICogQ29tcHV0ZSBhbiBhbW91bnQgb2YgdGltZSBpbiBzZWNvbmRzIHRvIHdhaXQgYmVmb3JlIHNlbmRpbmcgYW5vdGhlcgogKiBrZWVwLWFsaXZlLgogKiBAcmV0dXJucyB7TnVtYmVyfQogKi8KZnVuY3Rpb24gY29tcHV0ZUtlZXBBbGl2ZVRpbWVvdXQodXBwZXJCb3VuZCkgewogIHZhciBsb3dlckJvdW5kID0gdXBwZXJCb3VuZCAqIDAuODsKICByZXR1cm4gMTAwMCAqIChNYXRoLnJhbmRvbSgpICogKHVwcGVyQm91bmQgLSBsb3dlckJvdW5kKSArIGxvd2VyQm91bmQpOwp9CgpUcmFuc3BvcnQgPSBmdW5jdGlvbih1YSwgc2VydmVyKSB7CgogIHRoaXMubG9nZ2VyID0gdWEuZ2V0TG9nZ2VyKCdzaXAudHJhbnNwb3J0Jyk7CiAgdGhpcy51YSA9IHVhOwogIHRoaXMud3MgPSBudWxsOwogIHRoaXMuc2VydmVyID0gc2VydmVyOwogIHRoaXMucmVjb25uZWN0aW9uX2F0dGVtcHRzID0gMDsKICB0aGlzLmNsb3NlZCA9IGZhbHNlOwogIHRoaXMuY29ubmVjdGVkID0gZmFsc2U7CiAgdGhpcy5yZWNvbm5lY3RUaW1lciA9IG51bGw7CiAgdGhpcy5sYXN0VHJhbnNwb3J0RXJyb3IgPSB7fTsKCiAgdGhpcy5rZWVwQWxpdmVJbnRlcnZhbCA9IHVhLmNvbmZpZ3VyYXRpb24ua2VlcEFsaXZlSW50ZXJ2YWw7CiAgdGhpcy5rZWVwQWxpdmVUaW1lb3V0ID0gbnVsbDsKICB0aGlzLmtlZXBBbGl2ZVRpbWVyID0gbnVsbDsKCiAgdGhpcy51YS50cmFuc3BvcnQgPSB0aGlzOwoKICAvLyBDb25uZWN0CiAgdGhpcy5jb25uZWN0KCk7Cn07CgpUcmFuc3BvcnQucHJvdG90eXBlID0gewogIC8qKgogICAqIFNlbmQgYSBtZXNzYWdlLgogICAqIEBwYXJhbSB7U0lQLk91dGdvaW5nUmVxdWVzdHxTdHJpbmd9IG1zZwogICAqIEByZXR1cm5zIHtCb29sZWFufQogICAqLwogIHNlbmQ6IGZ1bmN0aW9uKG1zZykgewogICAgdmFyIG1lc3NhZ2UgPSBtc2cudG9TdHJpbmcoKTsKCiAgICBpZih0aGlzLndzICYmIHRoaXMud3MucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pIHsKICAgICAgaWYgKHRoaXMudWEuY29uZmlndXJhdGlvbi50cmFjZVNpcCA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMubG9nZ2VyLmxvZygnc2VuZGluZyBXZWJTb2NrZXQgbWVzc2FnZTpcblxuJyArIG1lc3NhZ2UgKyAnXG4nKTsKICAgICAgfQogICAgICB0aGlzLndzLnNlbmQobWVzc2FnZSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5sb2dnZXIud2FybigndW5hYmxlIHRvIHNlbmQgbWVzc2FnZSwgV2ViU29ja2V0IGlzIG5vdCBvcGVuJyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LAoKICAvKioKICAgKiBTZW5kIGEga2VlcC1hbGl2ZSAoYSBkb3VibGUtQ1JMRiBzZXF1ZW5jZSkuCiAgICogQHByaXZhdGUKICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0KICAgKi8KICBzZW5kS2VlcEFsaXZlOiBmdW5jdGlvbigpIHsKICAgIGlmKHRoaXMua2VlcEFsaXZlVGltZW91dCkgeyByZXR1cm47IH0KCiAgICB0aGlzLmtlZXBBbGl2ZVRpbWVvdXQgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMudWEuZW1pdCgna2VlcEFsaXZlVGltZW91dCcpOwogICAgfS5iaW5kKHRoaXMpLCAxMDAwMCk7CgogICAgcmV0dXJuIHRoaXMuc2VuZCgnXHJcblxyXG4nKTsKICB9LAoKICAvKioKICAgKiBTdGFydCBzZW5kaW5nIGtlZXAtYWxpdmVzLgogICAqIEBwcml2YXRlCiAgICovCiAgc3RhcnRTZW5kaW5nS2VlcEFsaXZlczogZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5rZWVwQWxpdmVJbnRlcnZhbCAmJiAhdGhpcy5rZWVwQWxpdmVUaW1lcikgewogICAgICB0aGlzLmtlZXBBbGl2ZVRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgIHRoaXMuc2VuZEtlZXBBbGl2ZSgpOwogICAgICAgIHRoaXMua2VlcEFsaXZlVGltZXIgPSBudWxsOwogICAgICAgIHRoaXMuc3RhcnRTZW5kaW5nS2VlcEFsaXZlcygpOwogICAgICB9LmJpbmQodGhpcyksIGNvbXB1dGVLZWVwQWxpdmVUaW1lb3V0KHRoaXMua2VlcEFsaXZlSW50ZXJ2YWwpKTsKICAgIH0KICB9LAoKICAvKioKICAgKiBTdG9wIHNlbmRpbmcga2VlcC1hbGl2ZXMuCiAgICogQHByaXZhdGUKICAgKi8KICBzdG9wU2VuZGluZ0tlZXBBbGl2ZXM6IGZ1bmN0aW9uKCkgewogICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5rZWVwQWxpdmVUaW1lcik7CiAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLmtlZXBBbGl2ZVRpbWVvdXQpOwogICAgdGhpcy5rZWVwQWxpdmVUaW1lciA9IG51bGw7CiAgICB0aGlzLmtlZXBBbGl2ZVRpbWVvdXQgPSBudWxsOwogIH0sCgogIC8qKgogICogRGlzY29ubmVjdCBzb2NrZXQuCiAgKi8KICBkaXNjb25uZWN0OiBmdW5jdGlvbigpIHsKICAgIGlmKHRoaXMud3MpIHsKICAgICAgLy8gQ2xlYXIgcmVjb25uZWN0VGltZXIKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5yZWNvbm5lY3RUaW1lcik7CgogICAgICB0aGlzLnN0b3BTZW5kaW5nS2VlcEFsaXZlcygpOwoKICAgICAgdGhpcy5jbG9zZWQgPSB0cnVlOwogICAgICB0aGlzLmxvZ2dlci5sb2coJ2Nsb3NpbmcgV2ViU29ja2V0ICcgKyB0aGlzLnNlcnZlci53c191cmkpOwogICAgICB0aGlzLndzLmNsb3NlKCk7CiAgICB9CgogICAgaWYgKHRoaXMucmVjb25uZWN0VGltZXIgIT09IG51bGwpIHsKICAgICAgU0lQLlRpbWVycy5jbGVhclRpbWVvdXQodGhpcy5yZWNvbm5lY3RUaW1lcik7CiAgICAgIHRoaXMucmVjb25uZWN0VGltZXIgPSBudWxsOwogICAgICB0aGlzLnVhLmVtaXQoJ2Rpc2Nvbm5lY3RlZCcsIHsKICAgICAgICB0cmFuc3BvcnQ6IHRoaXMsCiAgICAgICAgY29kZTogdGhpcy5sYXN0VHJhbnNwb3J0RXJyb3IuY29kZSwKICAgICAgICByZWFzb246IHRoaXMubGFzdFRyYW5zcG9ydEVycm9yLnJlYXNvbgogICAgICB9KTsKICAgIH0KICB9LAoKICAvKioKICAqIENvbm5lY3Qgc29ja2V0LgogICovCiAgY29ubmVjdDogZnVuY3Rpb24oKSB7CiAgICB2YXIgdHJhbnNwb3J0ID0gdGhpczsKCiAgICBpZih0aGlzLndzICYmICh0aGlzLndzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOIHx8IHRoaXMud3MucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0LkNPTk5FQ1RJTkcpKSB7CiAgICAgIHRoaXMubG9nZ2VyLmxvZygnV2ViU29ja2V0ICcgKyB0aGlzLnNlcnZlci53c191cmkgKyAnIGlzIGFscmVhZHkgY29ubmVjdGVkJyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZih0aGlzLndzKSB7CiAgICAgIHRoaXMud3MuY2xvc2UoKTsKICAgIH0KCiAgICB0aGlzLmxvZ2dlci5sb2coJ2Nvbm5lY3RpbmcgdG8gV2ViU29ja2V0ICcgKyB0aGlzLnNlcnZlci53c191cmkpOwogICAgdGhpcy51YS5vblRyYW5zcG9ydENvbm5lY3RpbmcodGhpcywKICAgICAgKHRoaXMucmVjb25uZWN0aW9uX2F0dGVtcHRzID09PSAwKT8xOnRoaXMucmVjb25uZWN0aW9uX2F0dGVtcHRzKTsKCiAgICB0cnkgewogICAgICB0aGlzLndzID0gbmV3IFdlYlNvY2tldCh0aGlzLnNlcnZlci53c191cmksICdzaXAnKTsKICAgIH0gY2F0Y2goZSkgewogICAgICB0aGlzLmxvZ2dlci53YXJuKCdlcnJvciBjb25uZWN0aW5nIHRvIFdlYlNvY2tldCAnICsgdGhpcy5zZXJ2ZXIud3NfdXJpICsgJzogJyArIGUpOwogICAgfQoKICAgIHRoaXMud3MuYmluYXJ5VHlwZSA9ICdhcnJheWJ1ZmZlcic7CgogICAgdGhpcy53cy5vbm9wZW4gPSBmdW5jdGlvbigpIHsKICAgICAgdHJhbnNwb3J0Lm9uT3BlbigpOwogICAgfTsKCiAgICB0aGlzLndzLm9uY2xvc2UgPSBmdW5jdGlvbihlKSB7CiAgICAgIHRyYW5zcG9ydC5vbkNsb3NlKGUpOwogICAgfTsKCiAgICB0aGlzLndzLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgdHJhbnNwb3J0Lm9uTWVzc2FnZShlKTsKICAgIH07CgogICAgdGhpcy53cy5vbmVycm9yID0gZnVuY3Rpb24oZSkgewogICAgICB0cmFuc3BvcnQub25FcnJvcihlKTsKICAgIH07CiAgfSwKCiAgLy8gVHJhbnNwb3J0IEV2ZW50IEhhbmRsZXJzCgogIC8qKgogICogQGV2ZW50CiAgKiBAcGFyYW0ge2V2ZW50fSBlCiAgKi8KICBvbk9wZW46IGZ1bmN0aW9uKCkgewogICAgdGhpcy5jb25uZWN0ZWQgPSB0cnVlOwoKICAgIHRoaXMubG9nZ2VyLmxvZygnV2ViU29ja2V0ICcgKyB0aGlzLnNlcnZlci53c191cmkgKyAnIGNvbm5lY3RlZCcpOwogICAgLy8gQ2xlYXIgcmVjb25uZWN0VGltZXIgc2luY2Ugd2UgYXJlIG5vdCBkaXNjb25uZWN0ZWQKICAgIGlmICh0aGlzLnJlY29ubmVjdFRpbWVyICE9PSBudWxsKSB7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMucmVjb25uZWN0VGltZXIpOwogICAgICB0aGlzLnJlY29ubmVjdFRpbWVyID0gbnVsbDsKICAgIH0KICAgIC8vIFJlc2V0IHJlY29ubmVjdGlvbl9hdHRlbXB0cwogICAgdGhpcy5yZWNvbm5lY3Rpb25fYXR0ZW1wdHMgPSAwOwogICAgLy8gRGlzYWJsZSBjbG9zZWQKICAgIHRoaXMuY2xvc2VkID0gZmFsc2U7CiAgICAvLyBUcmlnZ2VyIG9uVHJhbnNwb3J0Q29ubmVjdGVkIGNhbGxiYWNrCiAgICB0aGlzLnVhLm9uVHJhbnNwb3J0Q29ubmVjdGVkKHRoaXMpOwogICAgLy8gU3RhcnQgc2VuZGluZyBrZWVwLWFsaXZlcwogICAgdGhpcy5zdGFydFNlbmRpbmdLZWVwQWxpdmVzKCk7CiAgfSwKCiAgLyoqCiAgKiBAZXZlbnQKICAqIEBwYXJhbSB7ZXZlbnR9IGUKICAqLwogIG9uQ2xvc2U6IGZ1bmN0aW9uKGUpIHsKICAgIHZhciBjb25uZWN0ZWRfYmVmb3JlID0gdGhpcy5jb25uZWN0ZWQ7CgogICAgdGhpcy5sYXN0VHJhbnNwb3J0RXJyb3IuY29kZSA9IGUuY29kZTsKICAgIHRoaXMubGFzdFRyYW5zcG9ydEVycm9yLnJlYXNvbiA9IGUucmVhc29uOwoKICAgIHRoaXMuc3RvcFNlbmRpbmdLZWVwQWxpdmVzKCk7CgogICAgaWYgKHRoaXMucmVjb25uZWN0aW9uX2F0dGVtcHRzID4gMCkgewogICAgICB0aGlzLmxvZ2dlci5sb2coJ1JlY29ubmVjdGlvbiBhdHRlbXB0ICcgKyB0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyArICcgZmFpbGVkIChjb2RlOiAnICsgZS5jb2RlICsgKGUucmVhc29uPyAnfCByZWFzb246ICcgKyBlLnJlYXNvbiA6ICcnKSArJyknKTsKICAgICAgdGhpcy5yZWNvbm5lY3QoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuY29ubmVjdGVkID0gZmFsc2U7CiAgICAgIHRoaXMubG9nZ2VyLmxvZygnV2ViU29ja2V0IGRpc2Nvbm5lY3RlZCAoY29kZTogJyArIGUuY29kZSArIChlLnJlYXNvbj8gJ3wgcmVhc29uOiAnICsgZS5yZWFzb24gOiAnJykgKycpJyk7CgogICAgICBpZihlLndhc0NsZWFuID09PSBmYWxzZSkgewogICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ1dlYlNvY2tldCBhYnJ1cHQgZGlzY29ubmVjdGlvbicpOwogICAgICB9CiAgICAgIC8vIFRyYW5zcG9ydCB3YXMgY29ubmVjdGVkCiAgICAgIGlmKGNvbm5lY3RlZF9iZWZvcmUgPT09IHRydWUpIHsKICAgICAgICB0aGlzLnVhLm9uVHJhbnNwb3J0Q2xvc2VkKHRoaXMpOwogICAgICAgIC8vIENoZWNrIHdoZXRoZXIgdGhlIHVzZXIgcmVxdWVzdGVkIHRvIGNsb3NlLgogICAgICAgIGlmKCF0aGlzLmNsb3NlZCkgewogICAgICAgICAgdGhpcy5yZWNvbm5lY3QoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy51YS5lbWl0KCdkaXNjb25uZWN0ZWQnLCB7CiAgICAgICAgICAgIHRyYW5zcG9ydDogdGhpcywKICAgICAgICAgICAgY29kZTogdGhpcy5sYXN0VHJhbnNwb3J0RXJyb3IuY29kZSwKICAgICAgICAgICAgcmVhc29uOiB0aGlzLmxhc3RUcmFuc3BvcnRFcnJvci5yZWFzb24KICAgICAgICAgIH0pOwoKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgY29ubmVjdGlvbiBhdHRlbXB0CiAgICAgICAgLy9OZXR3b3JrIGVycm9yCiAgICAgICAgdGhpcy51YS5vblRyYW5zcG9ydEVycm9yKHRoaXMpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLyoqCiAgKiBAZXZlbnQKICAqIEBwYXJhbSB7ZXZlbnR9IGUKICAqLwogIG9uTWVzc2FnZTogZnVuY3Rpb24oZSkgewogICAgdmFyIG1lc3NhZ2UsIHRyYW5zYWN0aW9uLAogICAgICBkYXRhID0gZS5kYXRhOwoKICAgIC8vIENSTEYgS2VlcCBBbGl2ZSByZXNwb25zZSBmcm9tIHNlcnZlci4gSWdub3JlIGl0LgogICAgaWYoZGF0YSA9PT0gJ1xyXG4nKSB7CiAgICAgIFNJUC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMua2VlcEFsaXZlVGltZW91dCk7CiAgICAgIHRoaXMua2VlcEFsaXZlVGltZW91dCA9IG51bGw7CgogICAgICBpZiAodGhpcy51YS5jb25maWd1cmF0aW9uLnRyYWNlU2lwID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy5sb2dnZXIubG9nKCdyZWNlaXZlZCBXZWJTb2NrZXQgbWVzc2FnZSB3aXRoIENSTEYgS2VlcCBBbGl2ZSByZXNwb25zZScpOwogICAgICB9CgogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gV2ViU29ja2V0IGJpbmFyeSBtZXNzYWdlLgogICAgZWxzZSBpZiAodHlwZW9mIGRhdGEgIT09ICdzdHJpbmcnKSB7CiAgICAgIHRyeSB7CiAgICAgICAgZGF0YSA9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQ4QXJyYXkoZGF0YSkpOwogICAgICB9IGNhdGNoKGV2dCkgewogICAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ3JlY2VpdmVkIFdlYlNvY2tldCBiaW5hcnkgbWVzc2FnZSBmYWlsZWQgdG8gYmUgY29udmVydGVkIGludG8gc3RyaW5nLCBtZXNzYWdlIGRpc2NhcmRlZCcpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMudWEuY29uZmlndXJhdGlvbi50cmFjZVNpcCA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMubG9nZ2VyLmxvZygncmVjZWl2ZWQgV2ViU29ja2V0IGJpbmFyeSBtZXNzYWdlOlxuXG4nICsgZGF0YSArICdcbicpOwogICAgICB9CiAgICB9CgogICAgLy8gV2ViU29ja2V0IHRleHQgbWVzc2FnZS4KICAgIGVsc2UgewogICAgICBpZiAodGhpcy51YS5jb25maWd1cmF0aW9uLnRyYWNlU2lwID09PSB0cnVlKSB7CiAgICAgICAgdGhpcy5sb2dnZXIubG9nKCdyZWNlaXZlZCBXZWJTb2NrZXQgdGV4dCBtZXNzYWdlOlxuXG4nICsgZGF0YSArICdcbicpOwogICAgICB9CiAgICB9CgogICAgbWVzc2FnZSA9IFNJUC5QYXJzZXIucGFyc2VNZXNzYWdlKGRhdGEsIHRoaXMudWEpOwoKICAgIGlmICghbWVzc2FnZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYodGhpcy51YS5zdGF0dXMgPT09IFNJUC5VQS5DLlNUQVRVU19VU0VSX0NMT1NFRCAmJiBtZXNzYWdlIGluc3RhbmNlb2YgU0lQLkluY29taW5nUmVxdWVzdCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gRG8gc29tZSBzYW5pdHkgY2hlY2sKICAgIGlmKFNJUC5zYW5pdHlDaGVjayhtZXNzYWdlLCB0aGlzLnVhLCB0aGlzKSkgewogICAgICBpZihtZXNzYWdlIGluc3RhbmNlb2YgU0lQLkluY29taW5nUmVxdWVzdCkgewogICAgICAgIG1lc3NhZ2UudHJhbnNwb3J0ID0gdGhpczsKICAgICAgICB0aGlzLnVhLnJlY2VpdmVSZXF1ZXN0KG1lc3NhZ2UpOwogICAgICB9IGVsc2UgaWYobWVzc2FnZSBpbnN0YW5jZW9mIFNJUC5JbmNvbWluZ1Jlc3BvbnNlKSB7CiAgICAgICAgLyogVW5pa2Ugc3RhdGVkIGluIDE4LjEuMiwgaWYgYSByZXNwb25zZSBkb2VzIG5vdCBtYXRjaAogICAgICAgICogYW55IHRyYW5zYWN0aW9uLCBpdCBpcyBkaXNjYXJkZWQgaGVyZSBhbmQgbm8gcGFzc2VkIHRvIHRoZSBjb3JlCiAgICAgICAgKiBpbiBvcmRlciB0byBiZSBkaXNjYXJkZWQgdGhlcmUuCiAgICAgICAgKi8KICAgICAgICBzd2l0Y2gobWVzc2FnZS5tZXRob2QpIHsKICAgICAgICAgIGNhc2UgU0lQLkMuSU5WSVRFOgogICAgICAgICAgICB0cmFuc2FjdGlvbiA9IHRoaXMudWEudHJhbnNhY3Rpb25zLmljdFttZXNzYWdlLnZpYV9icmFuY2hdOwogICAgICAgICAgICBpZih0cmFuc2FjdGlvbikgewogICAgICAgICAgICAgIHRyYW5zYWN0aW9uLnJlY2VpdmVSZXNwb25zZShtZXNzYWdlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgU0lQLkMuQUNLOgogICAgICAgICAgICAvLyBKdXN0IGluIGNhc2UgOy0pCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgdHJhbnNhY3Rpb24gPSB0aGlzLnVhLnRyYW5zYWN0aW9ucy5uaWN0W21lc3NhZ2UudmlhX2JyYW5jaF07CiAgICAgICAgICAgIGlmKHRyYW5zYWN0aW9uKSB7CiAgICAgICAgICAgICAgdHJhbnNhY3Rpb24ucmVjZWl2ZVJlc3BvbnNlKG1lc3NhZ2UpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCgogIC8qKgogICogQGV2ZW50CiAgKiBAcGFyYW0ge2V2ZW50fSBlCiAgKi8KICBvbkVycm9yOiBmdW5jdGlvbihlKSB7CiAgICB0aGlzLmxvZ2dlci53YXJuKCdXZWJTb2NrZXQgY29ubmVjdGlvbiBlcnJvcjogJyArIEpTT04uc3RyaW5naWZ5KGUpKTsKICB9LAoKICAvKioKICAqIFJlY29ubmVjdGlvbiBhdHRlbXB0IGxvZ2ljLgogICogQHByaXZhdGUKICAqLwogIHJlY29ubmVjdDogZnVuY3Rpb24oKSB7CiAgICB2YXIgdHJhbnNwb3J0ID0gdGhpczsKCiAgICB0aGlzLnJlY29ubmVjdGlvbl9hdHRlbXB0cyArPSAxOwoKICAgIGlmKHRoaXMucmVjb25uZWN0aW9uX2F0dGVtcHRzID4gdGhpcy51YS5jb25maWd1cmF0aW9uLndzU2VydmVyTWF4UmVjb25uZWN0aW9uKSB7CiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ21heGltdW0gcmVjb25uZWN0aW9uIGF0dGVtcHRzIGZvciBXZWJTb2NrZXQgJyArIHRoaXMuc2VydmVyLndzX3VyaSk7CiAgICAgIHRoaXMudWEub25UcmFuc3BvcnRFcnJvcih0aGlzKTsKICAgIH0gZWxzZSBpZiAodGhpcy5yZWNvbm5lY3Rpb25fYXR0ZW1wdHMgPT09IDEpIHsKICAgICAgdGhpcy5sb2dnZXIubG9nKCdDb25uZWN0aW9uIHRvIFdlYlNvY2tldCAnICsgdGhpcy5zZXJ2ZXIud3NfdXJpICsgJyBzZXZlcmVkLCBhdHRlbXB0aW5nIGZpcnN0IHJlY29ubmVjdCcpOwogICAgICB0cmFuc3BvcnQuY29ubmVjdCgpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5sb2dnZXIubG9nKCd0cnlpbmcgdG8gcmVjb25uZWN0IHRvIFdlYlNvY2tldCAnICsgdGhpcy5zZXJ2ZXIud3NfdXJpICsgJyAocmVjb25uZWN0aW9uIGF0dGVtcHQgJyArIHRoaXMucmVjb25uZWN0aW9uX2F0dGVtcHRzICsgJyknKTsKCiAgICAgIHRoaXMucmVjb25uZWN0VGltZXIgPSBTSVAuVGltZXJzLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgdHJhbnNwb3J0LmNvbm5lY3QoKTsKICAgICAgICB0cmFuc3BvcnQucmVjb25uZWN0VGltZXIgPSBudWxsOwogICAgICB9LCB0aGlzLnVhLmNvbmZpZ3VyYXRpb24ud3NTZXJ2ZXJSZWNvbm5lY3Rpb25UaW1lb3V0ICogMTAwMCk7CiAgICB9CiAgfQp9OwoKVHJhbnNwb3J0LkMgPSBDOwpyZXR1cm4gVHJhbnNwb3J0Owp9OwoKfSx7fV0sMzM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewooZnVuY3Rpb24gKGdsb2JhbCl7CiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIEBhdWdtZW50cyBTSVAKICogQGNsYXNzIENsYXNzIGNyZWF0aW5nIGEgU0lQIFVzZXIgQWdlbnQuCiAqIEBwYXJhbSB7ZnVuY3Rpb24gcmV0dXJuaW5nIFNJUC5NZWRpYUhhbmRsZXJ9IFtjb25maWd1cmF0aW9uLm1lZGlhSGFuZGxlckZhY3RvcnldCiAqICAgICAgICBBIGZ1bmN0aW9uIHdpbGwgYmUgaW52b2tlZCBieSBlYWNoIG9mIHRoZSBVQSdzIFNlc3Npb25zIHRvIGJ1aWxkIHRoZSBNZWRpYUhhbmRsZXIgZm9yIHRoYXQgU2Vzc2lvbi4KICogICAgICAgIElmIG5vIChvciBhIGZhbHN5KSB2YWx1ZSBpcyBwcm92aWRlZCwgZWFjaCBTZXNzaW9uIHdpbGwgdXNlIGEgZGVmYXVsdCAoV2ViUlRDKSBNZWRpYUhhbmRsZXIuCiAqCiAqIEBwYXJhbSB7T2JqZWN0fSBbY29uZmlndXJhdGlvbi5tZWRpYV0gZ2V0cyBwYXNzZWQgdG8gU0lQLk1lZGlhSGFuZGxlci5nZXREZXNjcmlwdGlvbiBhcyBtZWRpYUhpbnQKICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCwgZW52aXJvbm1lbnQpIHsKdmFyIFVBLAogIEMgPSB7CiAgICAvLyBVQSBzdGF0dXMgY29kZXMKICAgIFNUQVRVU19JTklUOiAgICAgICAgICAgICAgICAwLAogICAgU1RBVFVTX1NUQVJUSU5HOiAgICAgICAgICAgIDEsCiAgICBTVEFUVVNfUkVBRFk6ICAgICAgICAgICAgICAgMiwKICAgIFNUQVRVU19VU0VSX0NMT1NFRDogICAgICAgICAzLAogICAgU1RBVFVTX05PVF9SRUFEWTogICAgICAgICAgIDQsCgogICAgLy8gVUEgZXJyb3IgY29kZXMKICAgIENPTkZJR1VSQVRJT05fRVJST1I6ICAxLAogICAgTkVUV09SS19FUlJPUjogICAgICAgIDIsCgogICAgQUxMT1dFRF9NRVRIT0RTOiBbCiAgICAgICdBQ0snLAogICAgICAnQ0FOQ0VMJywKICAgICAgJ0lOVklURScsCiAgICAgICdNRVNTQUdFJywKICAgICAgJ0JZRScsCiAgICAgICdPUFRJT05TJywKICAgICAgJ0lORk8nLAogICAgICAnTk9USUZZJywKICAgICAgJ1JFRkVSJwogICAgXSwKCiAgICBBQ0NFUFRFRF9CT0RZX1RZUEVTOiBbCiAgICAgICdhcHBsaWNhdGlvbi9zZHAnLAogICAgICAnYXBwbGljYXRpb24vZHRtZi1yZWxheScKICAgIF0sCgogICAgTUFYX0ZPUldBUkRTOiA3MCwKICAgIFRBR19MRU5HVEg6IDEwCiAgfTsKClVBID0gZnVuY3Rpb24oY29uZmlndXJhdGlvbikgewogIHZhciBzZWxmID0gdGhpczsKCiAgLy8gSGVscGVyIGZ1bmN0aW9uIGZvciBmb3J3YXJkaW5nIGV2ZW50cwogIGZ1bmN0aW9uIHNlbGZFbWl0KHR5cGUpIHsKICAgIC8vcmVnaXN0cmF0aW9uRmFpbGVkIGhhbmRsZXIgaXMgaW52b2tlZCB3aXRoIHR3byBhcmd1bWVudHMuIEFsbG93IGV2ZW50IGhhbmRsZXJzIHRvIGJlIGludm9rZWQgd2l0aCBhIHZhcmlhYmxlIG5vLiBvZiBhcmd1bWVudHMKICAgIHJldHVybiBzZWxmLmVtaXQuYmluZChzZWxmLCB0eXBlKTsKICB9CgogIC8vIFNldCBBY2NlcHRlZCBCb2R5IFR5cGVzCiAgQy5BQ0NFUFRFRF9CT0RZX1RZUEVTID0gQy5BQ0NFUFRFRF9CT0RZX1RZUEVTLnRvU3RyaW5nKCk7CgogIHRoaXMubG9nID0gbmV3IFNJUC5Mb2dnZXJGYWN0b3J5KCk7CiAgdGhpcy5sb2dnZXIgPSB0aGlzLmdldExvZ2dlcignc2lwLnVhJyk7CgogIHRoaXMuY2FjaGUgPSB7CiAgICBjcmVkZW50aWFsczoge30KICB9OwoKICB0aGlzLmNvbmZpZ3VyYXRpb24gPSB7fTsKICB0aGlzLmRpYWxvZ3MgPSB7fTsKCiAgLy9Vc2VyIGFjdGlvbnMgb3V0c2lkZSBhbnkgc2Vzc2lvbi9kaWFsb2cgKE1FU1NBR0UpCiAgdGhpcy5hcHBsaWNhbnRzID0ge307CgogIHRoaXMuZGF0YSA9IHt9OwogIHRoaXMuc2Vzc2lvbnMgPSB7fTsKICB0aGlzLnN1YnNjcmlwdGlvbnMgPSB7fTsKICB0aGlzLnRyYW5zcG9ydCA9IG51bGw7CiAgdGhpcy5jb250YWN0ID0gbnVsbDsKICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0lOSVQ7CiAgdGhpcy5lcnJvciA9IG51bGw7CiAgdGhpcy50cmFuc2FjdGlvbnMgPSB7CiAgICBuaXN0OiB7fSwKICAgIG5pY3Q6IHt9LAogICAgaXN0OiB7fSwKICAgIGljdDoge30KICB9OwoKICB0aGlzLnRyYW5zcG9ydFJlY292ZXJBdHRlbXB0cyA9IDA7CiAgdGhpcy50cmFuc3BvcnRSZWNvdmVyeVRpbWVyID0gbnVsbDsKCiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywgewogICAgdHJhbnNhY3Rpb25zQ291bnQ6IHsKICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgdHlwZSwKICAgICAgICAgIHRyYW5zYWN0aW9ucyA9IFsnbmlzdCcsJ25pY3QnLCdpc3QnLCdpY3QnXSwKICAgICAgICAgIGNvdW50ID0gMDsKCiAgICAgICAgZm9yICh0eXBlIGluIHRyYW5zYWN0aW9ucykgewogICAgICAgICAgY291bnQgKz0gT2JqZWN0LmtleXModGhpcy50cmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25zW3R5cGVdXSkubGVuZ3RoOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGNvdW50OwogICAgICB9CiAgICB9LAoKICAgIG5pY3RUcmFuc2FjdGlvbnNDb3VudDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnRyYW5zYWN0aW9uc1snbmljdCddKS5sZW5ndGg7CiAgICAgIH0KICAgIH0sCgogICAgbmlzdFRyYW5zYWN0aW9uc0NvdW50OiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMudHJhbnNhY3Rpb25zWyduaXN0J10pLmxlbmd0aDsKICAgICAgfQogICAgfSwKCiAgICBpY3RUcmFuc2FjdGlvbnNDb3VudDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnRyYW5zYWN0aW9uc1snaWN0J10pLmxlbmd0aDsKICAgICAgfQogICAgfSwKCiAgICBpc3RUcmFuc2FjdGlvbnNDb3VudDogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnRyYW5zYWN0aW9uc1snaXN0J10pLmxlbmd0aDsKICAgICAgfQogICAgfQogIH0pOwoKICAvKioKICAgKiBMb2FkIGNvbmZpZ3VyYXRpb24KICAgKgogICAqIEB0aHJvd3Mge1NJUC5FeGNlcHRpb25zLkNvbmZpZ3VyYXRpb25FcnJvcn0KICAgKiBAdGhyb3dzIHtUeXBlRXJyb3J9CiAgICovCgogIGlmKGNvbmZpZ3VyYXRpb24gPT09IHVuZGVmaW5lZCkgewogICAgY29uZmlndXJhdGlvbiA9IHt9OwogIH0gZWxzZSBpZiAodHlwZW9mIGNvbmZpZ3VyYXRpb24gPT09ICdzdHJpbmcnIHx8IGNvbmZpZ3VyYXRpb24gaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgIGNvbmZpZ3VyYXRpb24gPSB7CiAgICAgIHVyaTogY29uZmlndXJhdGlvbgogICAgfTsKICB9CgogIC8vIEFwcGx5IGxvZyBjb25maWd1cmF0aW9uIGlmIHByZXNlbnQKICBpZiAoY29uZmlndXJhdGlvbi5sb2cpIHsKICAgIGlmIChjb25maWd1cmF0aW9uLmxvZy5oYXNPd25Qcm9wZXJ0eSgnYnVpbHRpbkVuYWJsZWQnKSkgewogICAgICB0aGlzLmxvZy5idWlsdGluRW5hYmxlZCA9IGNvbmZpZ3VyYXRpb24ubG9nLmJ1aWx0aW5FbmFibGVkOwogICAgfQoKICAgIGlmIChjb25maWd1cmF0aW9uLmxvZy5oYXNPd25Qcm9wZXJ0eSgnbGV2ZWwnKSkgewogICAgICB0aGlzLmxvZy5sZXZlbCA9IGNvbmZpZ3VyYXRpb24ubG9nLmxldmVsOwogICAgfQoKICAgIGlmIChjb25maWd1cmF0aW9uLmxvZy5oYXNPd25Qcm9wZXJ0eSgnY29ubmVjdG9yJykpIHsKICAgICAgdGhpcy5sb2cuY29ubmVjdG9yID0gY29uZmlndXJhdGlvbi5sb2cuY29ubmVjdG9yOwogICAgfQogIH0KCiAgdHJ5IHsKICAgIHRoaXMubG9hZENvbmZpZyhjb25maWd1cmF0aW9uKTsKICB9IGNhdGNoKGUpIHsKICAgIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfTk9UX1JFQURZOwogICAgdGhpcy5lcnJvciA9IEMuQ09ORklHVVJBVElPTl9FUlJPUjsKICAgIHRocm93IGU7CiAgfQoKICAvLyBJbml0aWFsaXplIHJlZ2lzdGVyQ29udGV4dAogIHRoaXMucmVnaXN0ZXJDb250ZXh0ID0gbmV3IFNJUC5SZWdpc3RlckNvbnRleHQodGhpcyk7CiAgdGhpcy5yZWdpc3RlckNvbnRleHQub24oJ2ZhaWxlZCcsIHNlbGZFbWl0KCdyZWdpc3RyYXRpb25GYWlsZWQnKSk7CiAgdGhpcy5yZWdpc3RlckNvbnRleHQub24oJ3JlZ2lzdGVyZWQnLCBzZWxmRW1pdCgncmVnaXN0ZXJlZCcpKTsKICB0aGlzLnJlZ2lzdGVyQ29udGV4dC5vbigndW5yZWdpc3RlcmVkJywgc2VsZkVtaXQoJ3VucmVnaXN0ZXJlZCcpKTsKCiAgaWYodGhpcy5jb25maWd1cmF0aW9uLmF1dG9zdGFydCkgewogICAgdGhpcy5zdGFydCgpOwogIH0KCiAgaWYgKHR5cGVvZiBlbnZpcm9ubWVudC5hZGRFdmVudExpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7CiAgICAvLyBHb29nbGUgQ2hyb21lIFBhY2thZ2VkIEFwcHMgZG9uJ3QgYWxsb3cgJ3VubG9hZCcgbGlzdGVuZXJzOgogICAgLy8gdW5sb2FkIGlzIG5vdCBhdmFpbGFibGUgaW4gcGFja2FnZWQgYXBwcwogICAgaWYgKCEoZ2xvYmFsLmNocm9tZSAmJiBnbG9iYWwuY2hyb21lLmFwcCAmJiBnbG9iYWwuY2hyb21lLmFwcC5ydW50aW1lKSkgewogICAgICBlbnZpcm9ubWVudC5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCB0aGlzLnN0b3AuYmluZCh0aGlzKSk7CiAgICB9CiAgfQp9OwpVQS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNJUC5FdmVudEVtaXR0ZXIucHJvdG90eXBlKTsKCi8vPT09PT09PT09PT09PT09PT0KLy8gIEhpZ2ggTGV2ZWwgQVBJCi8vPT09PT09PT09PT09PT09PT0KClVBLnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICB0aGlzLmNvbmZpZ3VyYXRpb24ucmVnaXN0ZXIgPSB0cnVlOwogIHRoaXMucmVnaXN0ZXJDb250ZXh0LnJlZ2lzdGVyKG9wdGlvbnMpOwoKICByZXR1cm4gdGhpczsKfTsKCi8qKgogKiBVbnJlZ2lzdGVyLgogKgogKiBAcGFyYW0ge0Jvb2xlYW59IFthbGxdIHVucmVnaXN0ZXIgYWxsIHVzZXIgYmluZGluZ3MuCiAqCiAqLwpVQS5wcm90b3R5cGUudW5yZWdpc3RlciA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICB0aGlzLmNvbmZpZ3VyYXRpb24ucmVnaXN0ZXIgPSBmYWxzZTsKCiAgdmFyIGNvbnRleHQgPSB0aGlzLnJlZ2lzdGVyQ29udGV4dDsKICB0aGlzLmFmdGVyQ29ubmVjdGVkKGNvbnRleHQudW5yZWdpc3Rlci5iaW5kKGNvbnRleHQsIG9wdGlvbnMpKTsKCiAgcmV0dXJuIHRoaXM7Cn07CgpVQS5wcm90b3R5cGUuaXNSZWdpc3RlcmVkID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIHRoaXMucmVnaXN0ZXJDb250ZXh0LnJlZ2lzdGVyZWQ7Cn07CgovKioKICogQ29ubmVjdGlvbiBzdGF0ZS4KICogQHBhcmFtIHtCb29sZWFufQogKi8KVUEucHJvdG90eXBlLmlzQ29ubmVjdGVkID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIHRoaXMudHJhbnNwb3J0ID8gdGhpcy50cmFuc3BvcnQuY29ubmVjdGVkIDogZmFsc2U7Cn07CgpVQS5wcm90b3R5cGUuYWZ0ZXJDb25uZWN0ZWQgPSBmdW5jdGlvbiBhZnRlckNvbm5lY3RlZCAoY2FsbGJhY2spIHsKICBpZiAodGhpcy5pc0Nvbm5lY3RlZCgpKSB7CiAgICBjYWxsYmFjaygpOwogIH0gZWxzZSB7CiAgICB0aGlzLm9uY2UoJ2Nvbm5lY3RlZCcsIGNhbGxiYWNrKTsKICB9Cn07CgovKioKICogTWFrZSBhbiBvdXRnb2luZyBjYWxsLgogKgogKiBAcGFyYW0ge1N0cmluZ30gdGFyZ2V0CiAqIEBwYXJhbSB7T2JqZWN0fSB2aWV3cwogKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMubWVkaWFdIGdldHMgcGFzc2VkIHRvIFNJUC5NZWRpYUhhbmRsZXIuZ2V0RGVzY3JpcHRpb24gYXMgbWVkaWFIaW50CiAqCiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0KICoKICovClVBLnByb3RvdHlwZS5pbnZpdGUgPSBmdW5jdGlvbih0YXJnZXQsIG9wdGlvbnMpIHsKICB2YXIgY29udGV4dCA9IG5ldyBTSVAuSW52aXRlQ2xpZW50Q29udGV4dCh0aGlzLCB0YXJnZXQsIG9wdGlvbnMpOwoKICB0aGlzLmFmdGVyQ29ubmVjdGVkKGNvbnRleHQuaW52aXRlLmJpbmQoY29udGV4dCkpOwogIHJldHVybiBjb250ZXh0Owp9OwoKVUEucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uKHRhcmdldCwgZXZlbnQsIG9wdGlvbnMpIHsKICB2YXIgc3ViID0gbmV3IFNJUC5TdWJzY3JpcHRpb24odGhpcywgdGFyZ2V0LCBldmVudCwgb3B0aW9ucyk7CgogIHRoaXMuYWZ0ZXJDb25uZWN0ZWQoc3ViLnN1YnNjcmliZS5iaW5kKHN1YikpOwogIHJldHVybiBzdWI7Cn07CgovKioKICogU2VuZCBhIG1lc3NhZ2UuCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSB0YXJnZXQKICogQHBhcmFtIHtTdHJpbmd9IGJvZHkKICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXQogKgogKiBAdGhyb3dzIHtUeXBlRXJyb3J9CiAqCiAqLwpVQS5wcm90b3R5cGUubWVzc2FnZSA9IGZ1bmN0aW9uKHRhcmdldCwgYm9keSwgb3B0aW9ucykgewogIGlmIChib2R5ID09PSB1bmRlZmluZWQpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ05vdCBlbm91Z2ggYXJndW1lbnRzJyk7CiAgfQoKICAvLyBUaGVyZSBpcyBubyBNZXNzYWdlIG1vZHVsZSwgc28gaXQgaXMgb2theSB0aGF0IHRoZSBVQSBoYW5kbGVzIGRlZmF1bHRzIGhlcmUuCiAgb3B0aW9ucyA9IE9iamVjdC5jcmVhdGUob3B0aW9ucyB8fCBPYmplY3QucHJvdG90eXBlKTsKICBvcHRpb25zLmNvbnRlbnRUeXBlIHx8IChvcHRpb25zLmNvbnRlbnRUeXBlID0gJ3RleHQvcGxhaW4nKTsKICBvcHRpb25zLmJvZHkgPSBib2R5OwoKICByZXR1cm4gdGhpcy5yZXF1ZXN0KFNJUC5DLk1FU1NBR0UsIHRhcmdldCwgb3B0aW9ucyk7Cn07CgpVQS5wcm90b3R5cGUucmVxdWVzdCA9IGZ1bmN0aW9uIChtZXRob2QsIHRhcmdldCwgb3B0aW9ucykgewogIHZhciByZXEgPSBuZXcgU0lQLkNsaWVudENvbnRleHQodGhpcywgbWV0aG9kLCB0YXJnZXQsIG9wdGlvbnMpOwoKICB0aGlzLmFmdGVyQ29ubmVjdGVkKHJlcS5zZW5kLmJpbmQocmVxKSk7CiAgcmV0dXJuIHJlcTsKfTsKCi8qKgogKiBHcmFjZWZ1bGx5IGNsb3NlLgogKgogKi8KVUEucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIHsKICB2YXIgc2Vzc2lvbiwgc3Vic2NyaXB0aW9uLCBhcHBsaWNhbnQsCiAgICB1YSA9IHRoaXM7CgogIGZ1bmN0aW9uIHRyYW5zYWN0aW9uc0xpc3RlbmVyKCkgewogICAgaWYgKHVhLm5pc3RUcmFuc2FjdGlvbnNDb3VudCA9PT0gMCAmJiB1YS5uaWN0VHJhbnNhY3Rpb25zQ291bnQgPT09IDApIHsKICAgICAgICB1YS5yZW1vdmVMaXN0ZW5lcigndHJhbnNhY3Rpb25EZXN0cm95ZWQnLCB0cmFuc2FjdGlvbnNMaXN0ZW5lcik7CiAgICAgICAgdWEudHJhbnNwb3J0LmRpc2Nvbm5lY3QoKTsKICAgIH0KICB9CgogIHRoaXMubG9nZ2VyLmxvZygndXNlciByZXF1ZXN0ZWQgY2xvc3VyZS4uLicpOwoKICBpZih0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVVNFUl9DTE9TRUQpIHsKICAgIHRoaXMubG9nZ2VyLndhcm4oJ1VBIGFscmVhZHkgY2xvc2VkJyk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8vIENsZWFyIHRyYW5zcG9ydFJlY292ZXJ5VGltZXIKICBTSVAuVGltZXJzLmNsZWFyVGltZW91dCh0aGlzLnRyYW5zcG9ydFJlY292ZXJ5VGltZXIpOwoKICAvLyBDbG9zZSByZWdpc3RlckNvbnRleHQKICB0aGlzLmxvZ2dlci5sb2coJ2Nsb3NpbmcgcmVnaXN0ZXJDb250ZXh0Jyk7CiAgdGhpcy5yZWdpc3RlckNvbnRleHQuY2xvc2UoKTsKCiAgLy8gUnVuICBfdGVybWluYXRlXyBvbiBldmVyeSBTZXNzaW9uCiAgZm9yKHNlc3Npb24gaW4gdGhpcy5zZXNzaW9ucykgewogICAgdGhpcy5sb2dnZXIubG9nKCdjbG9zaW5nIHNlc3Npb24gJyArIHNlc3Npb24pOwogICAgdGhpcy5zZXNzaW9uc1tzZXNzaW9uXS50ZXJtaW5hdGUoKTsKICB9CgogIC8vUnVuIF9jbG9zZV8gb24gZXZlcnkgU3Vic2NyaXB0aW9uCiAgZm9yKHN1YnNjcmlwdGlvbiBpbiB0aGlzLnN1YnNjcmlwdGlvbnMpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygndW5zdWJzY3JpYmluZyBmcm9tIHN1YnNjcmlwdGlvbiAnICsgc3Vic2NyaXB0aW9uKTsKICAgIHRoaXMuc3Vic2NyaXB0aW9uc1tzdWJzY3JpcHRpb25dLmNsb3NlKCk7CiAgfQoKICAvLyBSdW4gIF9jbG9zZV8gb24gZXZlcnkgYXBwbGljYW50CiAgZm9yKGFwcGxpY2FudCBpbiB0aGlzLmFwcGxpY2FudHMpIHsKICAgIHRoaXMuYXBwbGljYW50c1thcHBsaWNhbnRdLmNsb3NlKCk7CiAgfQoKICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX1VTRVJfQ0xPU0VEOwoKICAvKgogICAqIElmIHRoZSByZW1haW5pbmcgdHJhbnNhY3Rpb25zIGFyZSBhbGwgSU5WSVRFIHRyYW5zYWN0aW9ucywgdGhlcmUgaXMgbm8gbmVlZCB0bwogICAqIHdhaXQgYW55bW9yZSBiZWNhdXNlIGV2ZXJ5IHNlc3Npb24gaGFzIGFscmVhZHkgYmVlbiBjbG9zZWQgYnkgdGhpcyBtZXRob2QuCiAgICogLSBsb2NhbGx5IG9yaWdpbmF0ZWQgc2Vzc2lvbnMgd2hlcmUgdGVybWluYXRlZCAoQ0FOQ0VMIG9yIEJZRSkKICAgKiAtIHJlbW90ZWx5IG9yaWdpbmF0ZWQgc2Vzc2lvbnMgd2hlcmUgcmVqZWN0ZWQgKDRYWCkgb3IgdGVybWluYXRlZCAoQllFKQogICAqIFJlbWFpbmluZyBJTlZJVEUgdHJhbnNhY3Rpb25zIGJlbG9uZyB0aG8gc2Vzc2lvbnMgdGhhdCB3aGVyZSBhbnN3ZXJlZC4gVGhpcyBhcmUgaW4KICAgKiAnYWNjZXB0ZWQnIHN0YXRlIGR1ZSB0byB0aW1lcnMgJ0wnIGFuZCAnTScgZGVmaW5lZCBpbiBbUkZDIDYwMjZdCiAgICovCiAgaWYgKHRoaXMubmlzdFRyYW5zYWN0aW9uc0NvdW50ID09PSAwICYmIHRoaXMubmljdFRyYW5zYWN0aW9uc0NvdW50ID09PSAwKSB7CiAgICB0aGlzLnRyYW5zcG9ydC5kaXNjb25uZWN0KCk7CiAgfSBlbHNlIHsKICAgIHRoaXMub24oJ3RyYW5zYWN0aW9uRGVzdHJveWVkJywgdHJhbnNhY3Rpb25zTGlzdGVuZXIpOwogIH0KCiAgcmV0dXJuIHRoaXM7Cn07CgovKioKICogQ29ubmVjdCB0byB0aGUgV1Mgc2VydmVyIGlmIHN0YXR1cyA9IFNUQVRVU19JTklULgogKiBSZXN1bWUgVUEgYWZ0ZXIgYmVpbmcgY2xvc2VkLgogKgogKi8KVUEucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24oKSB7CiAgdmFyIHNlcnZlcjsKCiAgdGhpcy5sb2dnZXIubG9nKCd1c2VyIHJlcXVlc3RlZCBzdGFydHVwLi4uJyk7CiAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19JTklUKSB7CiAgICBzZXJ2ZXIgPSB0aGlzLmdldE5leHRXc1NlcnZlcigpOwogICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19TVEFSVElORzsKICAgIG5ldyBTSVAuVHJhbnNwb3J0KHRoaXMsIHNlcnZlcik7CiAgfSBlbHNlIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19VU0VSX0NMT1NFRCkgewogICAgdGhpcy5sb2dnZXIubG9nKCdyZXN1bWluZycpOwogICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19SRUFEWTsKICAgIHRoaXMudHJhbnNwb3J0LmNvbm5lY3QoKTsKICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19TVEFSVElORykgewogICAgdGhpcy5sb2dnZXIubG9nKCdVQSBpcyBpbiBTVEFSVElORyBzdGF0dXMsIG5vdCBvcGVuaW5nIG5ldyBjb25uZWN0aW9uJyk7CiAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfUkVBRFkpIHsKICAgIHRoaXMubG9nZ2VyLmxvZygnVUEgaXMgaW4gUkVBRFkgc3RhdHVzLCBub3QgcmVzdW1pbmcnKTsKICB9IGVsc2UgewogICAgdGhpcy5sb2dnZXIuZXJyb3IoJ0Nvbm5lY3Rpb24gaXMgZG93bi4gQXV0by1SZWNvdmVyeSBzeXN0ZW0gaXMgdHJ5aW5nIHRvIGNvbm5lY3QnKTsKICB9CgogIHJldHVybiB0aGlzOwp9OwoKLyoqCiAqIE5vcm1hbGl6ZSBhIHN0cmluZyBpbnRvIGEgdmFsaWQgU0lQIHJlcXVlc3QgVVJJCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSB0YXJnZXQKICoKICogQHJldHVybnMge1NJUC5VUkl8dW5kZWZpbmVkfQogKi8KVUEucHJvdG90eXBlLm5vcm1hbGl6ZVRhcmdldCA9IGZ1bmN0aW9uKHRhcmdldCkgewogIHJldHVybiBTSVAuVXRpbHMubm9ybWFsaXplVGFyZ2V0KHRhcmdldCwgdGhpcy5jb25maWd1cmF0aW9uLmhvc3Rwb3J0UGFyYW1zKTsKfTsKCgovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gIFByaXZhdGUgKEZvciBpbnRlcm5hbCB1c2UpCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKVUEucHJvdG90eXBlLnNhdmVDcmVkZW50aWFscyA9IGZ1bmN0aW9uKGNyZWRlbnRpYWxzKSB7CiAgdGhpcy5jYWNoZS5jcmVkZW50aWFsc1tjcmVkZW50aWFscy5yZWFsbV0gPSB0aGlzLmNhY2hlLmNyZWRlbnRpYWxzW2NyZWRlbnRpYWxzLnJlYWxtXSB8fCB7fTsKICB0aGlzLmNhY2hlLmNyZWRlbnRpYWxzW2NyZWRlbnRpYWxzLnJlYWxtXVtjcmVkZW50aWFscy51cmldID0gY3JlZGVudGlhbHM7CgogIHJldHVybiB0aGlzOwp9OwoKVUEucHJvdG90eXBlLmdldENyZWRlbnRpYWxzID0gZnVuY3Rpb24ocmVxdWVzdCkgewogIHZhciByZWFsbSwgY3JlZGVudGlhbHM7CgogIHJlYWxtID0gcmVxdWVzdC5ydXJpLmhvc3Q7CgogIGlmICh0aGlzLmNhY2hlLmNyZWRlbnRpYWxzW3JlYWxtXSAmJiB0aGlzLmNhY2hlLmNyZWRlbnRpYWxzW3JlYWxtXVtyZXF1ZXN0LnJ1cmldKSB7CiAgICBjcmVkZW50aWFscyA9IHRoaXMuY2FjaGUuY3JlZGVudGlhbHNbcmVhbG1dW3JlcXVlc3QucnVyaV07CiAgICBjcmVkZW50aWFscy5tZXRob2QgPSByZXF1ZXN0Lm1ldGhvZDsKICB9CgogIHJldHVybiBjcmVkZW50aWFsczsKfTsKClVBLnByb3RvdHlwZS5nZXRMb2dnZXIgPSBmdW5jdGlvbihjYXRlZ29yeSwgbGFiZWwpIHsKICByZXR1cm4gdGhpcy5sb2cuZ2V0TG9nZ2VyKGNhdGVnb3J5LCBsYWJlbCk7Cn07CgoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gRXZlbnQgSGFuZGxlcnMKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCi8qKgogKiBUcmFuc3BvcnQgQ2xvc2UgZXZlbnQKICogQHByaXZhdGUKICogQGV2ZW50CiAqIEBwYXJhbSB7U0lQLlRyYW5zcG9ydH0gdHJhbnNwb3J0LgogKi8KVUEucHJvdG90eXBlLm9uVHJhbnNwb3J0Q2xvc2VkID0gZnVuY3Rpb24odHJhbnNwb3J0KSB7CiAgLy8gUnVuIF9vblRyYW5zcG9ydEVycm9yXyBjYWxsYmFjayBvbiBldmVyeSBjbGllbnQgdHJhbnNhY3Rpb24gdXNpbmcgX3RyYW5zcG9ydF8KICB2YXIgdHlwZSwgaWR4LCBsZW5ndGgsCiAgICBjbGllbnRfdHJhbnNhY3Rpb25zID0gWyduaWN0JywgJ2ljdCcsICduaXN0JywgJ2lzdCddOwoKICB0cmFuc3BvcnQuc2VydmVyLnN0YXR1cyA9IFNJUC5UcmFuc3BvcnQuQy5TVEFUVVNfRElTQ09OTkVDVEVEOwogIHRoaXMubG9nZ2VyLmxvZygnY29ubmVjdGlvbiBzdGF0ZSBzZXQgdG8gJysgU0lQLlRyYW5zcG9ydC5DLlNUQVRVU19ESVNDT05ORUNURUQpOwoKICBsZW5ndGggPSBjbGllbnRfdHJhbnNhY3Rpb25zLmxlbmd0aDsKICBmb3IgKHR5cGUgPSAwOyB0eXBlIDwgbGVuZ3RoOyB0eXBlKyspIHsKICAgIGZvcihpZHggaW4gdGhpcy50cmFuc2FjdGlvbnNbY2xpZW50X3RyYW5zYWN0aW9uc1t0eXBlXV0pIHsKICAgICAgdGhpcy50cmFuc2FjdGlvbnNbY2xpZW50X3RyYW5zYWN0aW9uc1t0eXBlXV1baWR4XS5vblRyYW5zcG9ydEVycm9yKCk7CiAgICB9CiAgfQoKICAvLyBDbG9zZSBzZXNzaW9ucyBpZiBHUlVVIGlzIG5vdCBiZWluZyB1c2VkCiAgaWYgKCF0aGlzLmNvbnRhY3QucHViX2dydXUpIHsKICAgIHRoaXMuY2xvc2VTZXNzaW9uc09uVHJhbnNwb3J0RXJyb3IoKTsKICB9Cgp9OwoKLyoqCiAqIFVucmVjb3ZlcmFibGUgdHJhbnNwb3J0IGV2ZW50LgogKiBDb25uZWN0aW9uIHJlYXR0ZW1wdCBsb2dpYyBoYXMgYmVlbiBkb25lIGFuZCBkaWRuJ3Qgc3VjY2Vzcy4KICogQHByaXZhdGUKICogQGV2ZW50CiAqIEBwYXJhbSB7U0lQLlRyYW5zcG9ydH0gdHJhbnNwb3J0LgogKi8KVUEucHJvdG90eXBlLm9uVHJhbnNwb3J0RXJyb3IgPSBmdW5jdGlvbih0cmFuc3BvcnQpIHsKICB2YXIgc2VydmVyOwoKICB0aGlzLmxvZ2dlci5sb2coJ3RyYW5zcG9ydCAnICsgdHJhbnNwb3J0LnNlcnZlci53c191cmkgKyAnIGZhaWxlZCB8IGNvbm5lY3Rpb24gc3RhdGUgc2V0IHRvICcrIFNJUC5UcmFuc3BvcnQuQy5TVEFUVVNfRVJST1IpOwoKICAvLyBDbG9zZSBzZXNzaW9ucy4KICAvL01hcmsgdGhpcyB0cmFuc3BvcnQgYXMgJ2Rvd24nCiAgdHJhbnNwb3J0LnNlcnZlci5zdGF0dXMgPSBTSVAuVHJhbnNwb3J0LkMuU1RBVFVTX0VSUk9SOwoKICB0aGlzLmVtaXQoJ2Rpc2Nvbm5lY3RlZCcsIHsKICAgIHRyYW5zcG9ydDogdHJhbnNwb3J0CiAgfSk7CgogIC8vIHRyeSB0aGUgbmV4dCB0cmFuc3BvcnQgaWYgdGhlIFVBIGlzbid0IGNsb3NlZAogIGlmKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19VU0VSX0NMT1NFRCkgewogICAgcmV0dXJuOwogIH0KCiAgc2VydmVyID0gdGhpcy5nZXROZXh0V3NTZXJ2ZXIoKTsKCiAgaWYoc2VydmVyKSB7CiAgICBuZXcgU0lQLlRyYW5zcG9ydCh0aGlzLCBzZXJ2ZXIpOwogIH1lbHNlIHsKICAgIHRoaXMuY2xvc2VTZXNzaW9uc09uVHJhbnNwb3J0RXJyb3IoKTsKICAgIGlmICghdGhpcy5lcnJvciB8fCB0aGlzLmVycm9yICE9PSBDLk5FVFdPUktfRVJST1IpIHsKICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19OT1RfUkVBRFk7CiAgICAgIHRoaXMuZXJyb3IgPSBDLk5FVFdPUktfRVJST1I7CiAgICB9CiAgICAvLyBUcmFuc3BvcnQgUmVjb3ZlcnkgcHJvY2VzcwogICAgdGhpcy5yZWNvdmVyVHJhbnNwb3J0KCk7CiAgfQp9OwoKLyoqCiAqIFRyYW5zcG9ydCBjb25uZWN0aW9uIGV2ZW50LgogKiBAcHJpdmF0ZQogKiBAZXZlbnQKICogQHBhcmFtIHtTSVAuVHJhbnNwb3J0fSB0cmFuc3BvcnQuCiAqLwpVQS5wcm90b3R5cGUub25UcmFuc3BvcnRDb25uZWN0ZWQgPSBmdW5jdGlvbih0cmFuc3BvcnQpIHsKICB0aGlzLnRyYW5zcG9ydCA9IHRyYW5zcG9ydDsKCiAgLy8gUmVzZXQgdHJhbnNwb3J0IHJlY292ZXJ5IGNvdW50ZXIKICB0aGlzLnRyYW5zcG9ydFJlY292ZXJBdHRlbXB0cyA9IDA7CgogIHRyYW5zcG9ydC5zZXJ2ZXIuc3RhdHVzID0gU0lQLlRyYW5zcG9ydC5DLlNUQVRVU19SRUFEWTsKICB0aGlzLmxvZ2dlci5sb2coJ2Nvbm5lY3Rpb24gc3RhdGUgc2V0IHRvICcrIFNJUC5UcmFuc3BvcnQuQy5TVEFUVVNfUkVBRFkpOwoKICBpZih0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfVVNFUl9DTE9TRUQpIHsKICAgIHJldHVybjsKICB9CgogIHRoaXMuc3RhdHVzID0gQy5TVEFUVVNfUkVBRFk7CiAgdGhpcy5lcnJvciA9IG51bGw7CgogIGlmKHRoaXMuY29uZmlndXJhdGlvbi5yZWdpc3RlcikgewogICAgdGhpcy5jb25maWd1cmF0aW9uLmF1dGhlbnRpY2F0aW9uRmFjdG9yeS5pbml0aWFsaXplKCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMucmVnaXN0ZXJDb250ZXh0Lm9uVHJhbnNwb3J0Q29ubmVjdGVkKCk7CiAgICB9LmJpbmQodGhpcykpOwogIH0KCiAgdGhpcy5lbWl0KCdjb25uZWN0ZWQnLCB7CiAgICB0cmFuc3BvcnQ6IHRyYW5zcG9ydAogIH0pOwp9OwoKCi8qKgogKiBUcmFuc3BvcnQgY29ubmVjdGluZyBldmVudAogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge1NJUC5UcmFuc3BvcnR9IHRyYW5zcG9ydC4KICogI3BhcmFtIHtJbnRlZ2VyfSBhdHRlbXB0cy4KICovCiAgVUEucHJvdG90eXBlLm9uVHJhbnNwb3J0Q29ubmVjdGluZyA9IGZ1bmN0aW9uKHRyYW5zcG9ydCwgYXR0ZW1wdHMpIHsKICAgIHRoaXMuZW1pdCgnY29ubmVjdGluZycsIHsKICAgICAgdHJhbnNwb3J0OiB0cmFuc3BvcnQsCiAgICAgIGF0dGVtcHRzOiBhdHRlbXB0cwogICAgfSk7CiAgfTsKCgovKioKICogbmV3IFRyYW5zYWN0aW9uCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7U0lQLlRyYW5zYWN0aW9ufSB0cmFuc2FjdGlvbi4KICovClVBLnByb3RvdHlwZS5uZXdUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uKHRyYW5zYWN0aW9uKSB7CiAgdGhpcy50cmFuc2FjdGlvbnNbdHJhbnNhY3Rpb24udHlwZV1bdHJhbnNhY3Rpb24uaWRdID0gdHJhbnNhY3Rpb247CiAgdGhpcy5lbWl0KCduZXdUcmFuc2FjdGlvbicsIHt0cmFuc2FjdGlvbjogdHJhbnNhY3Rpb259KTsKfTsKCgovKioKICogZGVzdHJveSBUcmFuc2FjdGlvbgogKiBAcHJpdmF0ZQogKiBAcGFyYW0ge1NJUC5UcmFuc2FjdGlvbn0gdHJhbnNhY3Rpb24uCiAqLwpVQS5wcm90b3R5cGUuZGVzdHJveVRyYW5zYWN0aW9uID0gZnVuY3Rpb24odHJhbnNhY3Rpb24pIHsKICBkZWxldGUgdGhpcy50cmFuc2FjdGlvbnNbdHJhbnNhY3Rpb24udHlwZV1bdHJhbnNhY3Rpb24uaWRdOwogIHRoaXMuZW1pdCgndHJhbnNhY3Rpb25EZXN0cm95ZWQnLCB7CiAgICB0cmFuc2FjdGlvbjogdHJhbnNhY3Rpb24KICB9KTsKfTsKCgovLz09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gcmVjZWl2ZVJlcXVlc3QKLy89PT09PT09PT09PT09PT09PT09PT09PT09CgovKioKICogUmVxdWVzdCByZWNlcHRpb24KICogQHByaXZhdGUKICogQHBhcmFtIHtTSVAuSW5jb21pbmdSZXF1ZXN0fSByZXF1ZXN0LgogKi8KVUEucHJvdG90eXBlLnJlY2VpdmVSZXF1ZXN0ID0gZnVuY3Rpb24ocmVxdWVzdCkgewogIHZhciBkaWFsb2csIHNlc3Npb24sIG1lc3NhZ2UsCiAgICBtZXRob2QgPSByZXF1ZXN0Lm1ldGhvZCwKICAgIHRyYW5zYWN0aW9uLAogICAgcmVwbGFjZXMsCiAgICByZXBsYWNlZERpYWxvZywKICAgIHNlbGYgPSB0aGlzOwoKICBmdW5jdGlvbiBydXJpTWF0Y2hlcyAodXJpKSB7CiAgICByZXR1cm4gdXJpICYmIHVyaS51c2VyID09PSByZXF1ZXN0LnJ1cmkudXNlcjsKICB9CgogIC8vIENoZWNrIHRoYXQgcmVxdWVzdCBVUkkgcG9pbnRzIHRvIHVzCiAgaWYoIShydXJpTWF0Y2hlcyh0aGlzLmNvbmZpZ3VyYXRpb24udXJpKSB8fAogICAgICAgcnVyaU1hdGNoZXModGhpcy5jb250YWN0LnVyaSkgfHwKICAgICAgIHJ1cmlNYXRjaGVzKHRoaXMuY29udGFjdC5wdWJfZ3J1dSkgfHwKICAgICAgIHJ1cmlNYXRjaGVzKHRoaXMuY29udGFjdC50ZW1wX2dydXUpKSkgewogICAgdGhpcy5sb2dnZXIud2FybignUmVxdWVzdC1VUkkgZG9lcyBub3QgcG9pbnQgdG8gdXMnKTsKICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCAhPT0gU0lQLkMuQUNLKSB7CiAgICAgIHJlcXVlc3QucmVwbHlfc2woNDA0KTsKICAgIH0KICAgIHJldHVybjsKICB9CgogIC8vIENoZWNrIHJlcXVlc3QgVVJJIHNjaGVtZQogIGlmKHJlcXVlc3QucnVyaS5zY2hlbWUgPT09IFNJUC5DLlNJUFMpIHsKICAgIHJlcXVlc3QucmVwbHlfc2woNDE2KTsKICAgIHJldHVybjsKICB9CgogIC8vIENoZWNrIHRyYW5zYWN0aW9uCiAgaWYoU0lQLlRyYW5zYWN0aW9ucy5jaGVja1RyYW5zYWN0aW9uKHRoaXMsIHJlcXVlc3QpKSB7CiAgICByZXR1cm47CiAgfQoKICAvKiBSRkMzMjYxIDEyLjIuMgogICAqIFJlcXVlc3RzIHRoYXQgZG8gbm90IGNoYW5nZSBpbiBhbnkgd2F5IHRoZSBzdGF0ZSBvZiBhIGRpYWxvZyBtYXkgYmUKICAgKiByZWNlaXZlZCB3aXRoaW4gYSBkaWFsb2cgKGZvciBleGFtcGxlLCBhbiBPUFRJT05TIHJlcXVlc3QpLgogICAqIFRoZXkgYXJlIHByb2Nlc3NlZCBhcyBpZiB0aGV5IGhhZCBiZWVuIHJlY2VpdmVkIG91dHNpZGUgdGhlIGRpYWxvZy4KICAgKi8KICBpZihtZXRob2QgPT09IFNJUC5DLk9QVElPTlMpIHsKICAgIG5ldyBTSVAuVHJhbnNhY3Rpb25zLk5vbkludml0ZVNlcnZlclRyYW5zYWN0aW9uKHJlcXVlc3QsIHRoaXMpOwogICAgcmVxdWVzdC5yZXBseSgyMDAsIG51bGwsIFsKICAgICAgJ0FsbG93OiAnKyBTSVAuVUEuQy5BTExPV0VEX01FVEhPRFMudG9TdHJpbmcoKSwKICAgICAgJ0FjY2VwdDogJysgQy5BQ0NFUFRFRF9CT0RZX1RZUEVTCiAgICBdKTsKICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gU0lQLkMuTUVTU0FHRSkgewogICAgbWVzc2FnZSA9IG5ldyBTSVAuU2VydmVyQ29udGV4dCh0aGlzLCByZXF1ZXN0KTsKICAgIG1lc3NhZ2UuYm9keSA9IHJlcXVlc3QuYm9keTsKICAgIG1lc3NhZ2UuY29udGVudF90eXBlID0gcmVxdWVzdC5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpIHx8ICd0ZXh0L3BsYWluJzsKCiAgICByZXF1ZXN0LnJlcGx5KDIwMCwgbnVsbCk7CiAgICB0aGlzLmVtaXQoJ21lc3NhZ2UnLCBtZXNzYWdlKTsKICB9IGVsc2UgaWYgKG1ldGhvZCAhPT0gU0lQLkMuSU5WSVRFICYmCiAgICAgICAgICAgICBtZXRob2QgIT09IFNJUC5DLkFDSykgewogICAgLy8gTGV0IHRob3NlIG1ldGhvZHMgcGFzcyB0aHJvdWdoIHRvIG5vcm1hbCBwcm9jZXNzaW5nIGZvciBub3cuCiAgICB0cmFuc2FjdGlvbiA9IG5ldyBTSVAuU2VydmVyQ29udGV4dCh0aGlzLCByZXF1ZXN0KTsKICB9CgogIC8vIEluaXRpYWwgUmVxdWVzdAogIGlmKCFyZXF1ZXN0LnRvX3RhZykgewogICAgc3dpdGNoKG1ldGhvZCkgewogICAgICBjYXNlIFNJUC5DLklOVklURToKICAgICAgICByZXBsYWNlcyA9CiAgICAgICAgICB0aGlzLmNvbmZpZ3VyYXRpb24ucmVwbGFjZXMgIT09IFNJUC5DLnN1cHBvcnRlZC5VTlNVUFBPUlRFRCAmJgogICAgICAgICAgcmVxdWVzdC5wYXJzZUhlYWRlcigncmVwbGFjZXMnKTsKCiAgICAgICAgaWYgKHJlcGxhY2VzKSB7CiAgICAgICAgICByZXBsYWNlZERpYWxvZyA9IHRoaXMuZGlhbG9nc1tyZXBsYWNlcy5jYWxsX2lkICsgcmVwbGFjZXMucmVwbGFjZXNfdG9fdGFnICsgcmVwbGFjZXMucmVwbGFjZXNfZnJvbV90YWddOwoKICAgICAgICAgIGlmICghcmVwbGFjZWREaWFsb2cpIHsKICAgICAgICAgICAgLy9SZXBsYWNlZCBoZWFkZXIgd2l0aG91dCBhIG1hdGNoaW5nIGRpYWxvZywgcmVqZWN0CiAgICAgICAgICAgIHJlcXVlc3QucmVwbHlfc2woNDgxLCBudWxsKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSBlbHNlIGlmIChyZXBsYWNlZERpYWxvZy5vd25lci5zdGF0dXMgPT09IFNJUC5TZXNzaW9uLkMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgICAgICAgcmVxdWVzdC5yZXBseV9zbCg2MDMsIG51bGwpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgaWYgKHJlcGxhY2VkRGlhbG9nLnN0YXRlID09PSBTSVAuRGlhbG9nLkMuU1RBVFVTX0NPTkZJUk1FRCAmJiByZXBsYWNlcy5lYXJseV9vbmx5KSB7CiAgICAgICAgICAgIHJlcXVlc3QucmVwbHlfc2woNDg2LCBudWxsKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdmFyIGlzTWVkaWFTdXBwb3J0ZWQgPSB0aGlzLmNvbmZpZ3VyYXRpb24ubWVkaWFIYW5kbGVyRmFjdG9yeS5pc1N1cHBvcnRlZDsKICAgICAgICBpZighaXNNZWRpYVN1cHBvcnRlZCB8fCBpc01lZGlhU3VwcG9ydGVkKCkpIHsKICAgICAgICAgIHNlc3Npb24gPSBuZXcgU0lQLkludml0ZVNlcnZlckNvbnRleHQodGhpcywgcmVxdWVzdCk7CiAgICAgICAgICBzZXNzaW9uLnJlcGxhY2VlID0gcmVwbGFjZWREaWFsb2cgJiYgcmVwbGFjZWREaWFsb2cub3duZXI7CiAgICAgICAgICBzZXNzaW9uLm9uKCdpbnZpdGUnLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5lbWl0KCdpbnZpdGUnLCB0aGlzKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCdJTlZJVEUgcmVjZWl2ZWQgYnV0IFdlYlJUQyBpcyBub3Qgc3VwcG9ydGVkJyk7CiAgICAgICAgICByZXF1ZXN0LnJlcGx5KDQ4OCk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlIFNJUC5DLkJZRToKICAgICAgICAvLyBPdXQgb2YgZGlhbG9nIEJZRSByZWNlaXZlZAogICAgICAgIHJlcXVlc3QucmVwbHkoNDgxKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSBTSVAuQy5DQU5DRUw6CiAgICAgICAgc2Vzc2lvbiA9IHRoaXMuZmluZFNlc3Npb24ocmVxdWVzdCk7CiAgICAgICAgaWYoc2Vzc2lvbikgewogICAgICAgICAgc2Vzc2lvbi5yZWNlaXZlUmVxdWVzdChyZXF1ZXN0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5sb2dnZXIud2FybigncmVjZWl2ZWQgQ0FOQ0VMIHJlcXVlc3QgZm9yIGEgbm9uIGV4aXN0ZW50IHNlc3Npb24nKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgU0lQLkMuQUNLOgogICAgICAgIC8qIEFic29yYiBpdC4KICAgICAgICAgKiBBQ0sgcmVxdWVzdCB3aXRob3V0IGEgY29ycmVzcG9uZGluZyBJbnZpdGUgVHJhbnNhY3Rpb24KICAgICAgICAgKiBhbmQgd2l0aG91dCBUbyB0YWcuCiAgICAgICAgICovCiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgcmVxdWVzdC5yZXBseSg0MDUpOwogICAgICAgIGJyZWFrOwogICAgfQogIH0KICAvLyBJbi1kaWFsb2cgcmVxdWVzdAogIGVsc2UgewogICAgZGlhbG9nID0gdGhpcy5maW5kRGlhbG9nKHJlcXVlc3QpOwoKICAgIGlmKGRpYWxvZykgewogICAgICBpZiAobWV0aG9kID09PSBTSVAuQy5JTlZJVEUpIHsKICAgICAgICBuZXcgU0lQLlRyYW5zYWN0aW9ucy5JbnZpdGVTZXJ2ZXJUcmFuc2FjdGlvbihyZXF1ZXN0LCB0aGlzKTsKICAgICAgfQogICAgICBkaWFsb2cucmVjZWl2ZVJlcXVlc3QocmVxdWVzdCk7CiAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gU0lQLkMuTk9USUZZKSB7CiAgICAgIHNlc3Npb24gPSB0aGlzLmZpbmRTZXNzaW9uKHJlcXVlc3QpOwogICAgICBpZihzZXNzaW9uKSB7CiAgICAgICAgc2Vzc2lvbi5yZWNlaXZlUmVxdWVzdChyZXF1ZXN0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCdyZWNlaXZlZCBOT1RJRlkgcmVxdWVzdCBmb3IgYSBub24gZXhpc3RlbnQgc2Vzc2lvbicpOwogICAgICAgIHJlcXVlc3QucmVwbHkoNDgxLCAnU3Vic2NyaXB0aW9uIGRvZXMgbm90IGV4aXN0Jyk7CiAgICAgIH0KICAgIH0KICAgIC8qIFJGQzMyNjEgMTIuMi4yCiAgICAgKiBSZXF1ZXN0IHdpdGggdG8gdGFnLCBidXQgbm8gbWF0Y2hpbmcgZGlhbG9nIGZvdW5kLgogICAgICogRXhjZXB0aW9uOiBBQ0sgZm9yIGFuIEludml0ZSByZXF1ZXN0IGZvciB3aGljaCBhIGRpYWxvZyBoYXMgbm90CiAgICAgKiBiZWVuIGNyZWF0ZWQuCiAgICAgKi8KICAgIGVsc2UgewogICAgICBpZihtZXRob2QgIT09IFNJUC5DLkFDSykgewogICAgICAgIHJlcXVlc3QucmVwbHkoNDgxKTsKICAgICAgfQogICAgfQogIH0KfTsKCi8vPT09PT09PT09PT09PT09PT0KLy8gVXRpbHMKLy89PT09PT09PT09PT09PT09PQoKLyoqCiAqIEdldCB0aGUgc2Vzc2lvbiB0byB3aGljaCB0aGUgcmVxdWVzdCBiZWxvbmdzIHRvLCBpZiBhbnkuCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7U0lQLkluY29taW5nUmVxdWVzdH0gcmVxdWVzdC4KICogQHJldHVybnMge1NJUC5PdXRnb2luZ1Nlc3Npb258U0lQLkluY29taW5nU2Vzc2lvbnxudWxsfQogKi8KVUEucHJvdG90eXBlLmZpbmRTZXNzaW9uID0gZnVuY3Rpb24ocmVxdWVzdCkgewogIHJldHVybiB0aGlzLnNlc3Npb25zW3JlcXVlc3QuY2FsbF9pZCArIHJlcXVlc3QuZnJvbV90YWddIHx8CiAgICAgICAgICB0aGlzLnNlc3Npb25zW3JlcXVlc3QuY2FsbF9pZCArIHJlcXVlc3QudG9fdGFnXSB8fAogICAgICAgICAgbnVsbDsKfTsKCi8qKgogKiBHZXQgdGhlIGRpYWxvZyB0byB3aGljaCB0aGUgcmVxdWVzdCBiZWxvbmdzIHRvLCBpZiBhbnkuCiAqIEBwcml2YXRlCiAqIEBwYXJhbSB7U0lQLkluY29taW5nUmVxdWVzdH0KICogQHJldHVybnMge1NJUC5EaWFsb2d8bnVsbH0KICovClVBLnByb3RvdHlwZS5maW5kRGlhbG9nID0gZnVuY3Rpb24ocmVxdWVzdCkgewogIHJldHVybiB0aGlzLmRpYWxvZ3NbcmVxdWVzdC5jYWxsX2lkICsgcmVxdWVzdC5mcm9tX3RhZyArIHJlcXVlc3QudG9fdGFnXSB8fAogICAgICAgICAgdGhpcy5kaWFsb2dzW3JlcXVlc3QuY2FsbF9pZCArIHJlcXVlc3QudG9fdGFnICsgcmVxdWVzdC5mcm9tX3RhZ10gfHwKICAgICAgICAgIG51bGw7Cn07CgovKioKICogUmV0cmlldmUgdGhlIG5leHQgc2VydmVyIHRvIHdoaWNoIGNvbm5lY3QuCiAqIEBwcml2YXRlCiAqIEByZXR1cm5zIHtPYmplY3R9IHdzX3NlcnZlcgogKi8KVUEucHJvdG90eXBlLmdldE5leHRXc1NlcnZlciA9IGZ1bmN0aW9uKCkgewogIC8vIE9yZGVyIHNlcnZlcnMgYnkgd2VpZ2h0CiAgdmFyIGlkeCwgbGVuZ3RoLCB3c19zZXJ2ZXIsCiAgICBjYW5kaWRhdGVzID0gW107CgogIGxlbmd0aCA9IHRoaXMuY29uZmlndXJhdGlvbi53c1NlcnZlcnMubGVuZ3RoOwogIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgd3Nfc2VydmVyID0gdGhpcy5jb25maWd1cmF0aW9uLndzU2VydmVyc1tpZHhdOwoKICAgIGlmICh3c19zZXJ2ZXIuc3RhdHVzID09PSBTSVAuVHJhbnNwb3J0LkMuU1RBVFVTX0VSUk9SKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfSBlbHNlIGlmIChjYW5kaWRhdGVzLmxlbmd0aCA9PT0gMCkgewogICAgICBjYW5kaWRhdGVzLnB1c2god3Nfc2VydmVyKTsKICAgIH0gZWxzZSBpZiAod3Nfc2VydmVyLndlaWdodCA+IGNhbmRpZGF0ZXNbMF0ud2VpZ2h0KSB7CiAgICAgIGNhbmRpZGF0ZXMgPSBbd3Nfc2VydmVyXTsKICAgIH0gZWxzZSBpZiAod3Nfc2VydmVyLndlaWdodCA9PT0gY2FuZGlkYXRlc1swXS53ZWlnaHQpIHsKICAgICAgY2FuZGlkYXRlcy5wdXNoKHdzX3NlcnZlcik7CiAgICB9CiAgfQoKICBpZHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjYW5kaWRhdGVzLmxlbmd0aCk7CgogIHJldHVybiBjYW5kaWRhdGVzW2lkeF07Cn07CgovKioKICogQ2xvc2UgYWxsIHNlc3Npb25zIG9uIHRyYW5zcG9ydCBlcnJvci4KICogQHByaXZhdGUKICovClVBLnByb3RvdHlwZS5jbG9zZVNlc3Npb25zT25UcmFuc3BvcnRFcnJvciA9IGZ1bmN0aW9uKCkgewogIHZhciBpZHg7CgogIC8vIFJ1biBfdHJhbnNwb3J0RXJyb3JfIGZvciBldmVyeSBTZXNzaW9uCiAgZm9yKGlkeCBpbiB0aGlzLnNlc3Npb25zKSB7CiAgICB0aGlzLnNlc3Npb25zW2lkeF0ub25UcmFuc3BvcnRFcnJvcigpOwogIH0KICAvLyBDYWxsIHJlZ2lzdGVyQ29udGV4dCBfb25UcmFuc3BvcnRDbG9zZWRfCiAgdGhpcy5yZWdpc3RlckNvbnRleHQub25UcmFuc3BvcnRDbG9zZWQoKTsKfTsKClVBLnByb3RvdHlwZS5yZWNvdmVyVHJhbnNwb3J0ID0gZnVuY3Rpb24odWEpIHsKICB2YXIgaWR4LCBsZW5ndGgsIGssIG5leHRSZXRyeSwgY291bnQsIHNlcnZlcjsKCiAgdWEgPSB1YSB8fCB0aGlzOwogIGNvdW50ID0gdWEudHJhbnNwb3J0UmVjb3ZlckF0dGVtcHRzOwoKICBsZW5ndGggPSB1YS5jb25maWd1cmF0aW9uLndzU2VydmVycy5sZW5ndGg7CiAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICB1YS5jb25maWd1cmF0aW9uLndzU2VydmVyc1tpZHhdLnN0YXR1cyA9IDA7CiAgfQoKICBzZXJ2ZXIgPSB1YS5nZXROZXh0V3NTZXJ2ZXIoKTsKCiAgayA9IE1hdGguZmxvb3IoKE1hdGgucmFuZG9tKCkgKiBNYXRoLnBvdygyLGNvdW50KSkgKzEpOwogIG5leHRSZXRyeSA9IGsgKiB1YS5jb25maWd1cmF0aW9uLmNvbm5lY3Rpb25SZWNvdmVyeU1pbkludGVydmFsOwoKICBpZiAobmV4dFJldHJ5ID4gdWEuY29uZmlndXJhdGlvbi5jb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbCkgewogICAgdGhpcy5sb2dnZXIubG9nKCd0aW1lIGZvciBuZXh0IGNvbm5lY3Rpb24gYXR0ZW1wdCBleGNlZWRzIGNvbm5lY3Rpb25SZWNvdmVyeU1heEludGVydmFsLCByZXNldHRpbmcgY291bnRlcicpOwogICAgbmV4dFJldHJ5ID0gdWEuY29uZmlndXJhdGlvbi5jb25uZWN0aW9uUmVjb3ZlcnlNaW5JbnRlcnZhbDsKICAgIGNvdW50ID0gMDsKICB9CgogIHRoaXMubG9nZ2VyLmxvZygnbmV4dCBjb25uZWN0aW9uIGF0dGVtcHQgaW4gJysgbmV4dFJldHJ5ICsnIHNlY29uZHMnKTsKCiAgdGhpcy50cmFuc3BvcnRSZWNvdmVyeVRpbWVyID0gU0lQLlRpbWVycy5zZXRUaW1lb3V0KAogICAgZnVuY3Rpb24oKXsKICAgICAgdWEudHJhbnNwb3J0UmVjb3ZlckF0dGVtcHRzID0gY291bnQgKyAxOwogICAgICBuZXcgU0lQLlRyYW5zcG9ydCh1YSwgc2VydmVyKTsKICAgIH0sIG5leHRSZXRyeSAqIDEwMDApOwp9OwoKZnVuY3Rpb24gY2hlY2tBdXRoZW50aWNhdGlvbkZhY3RvcnkgKGF1dGhlbnRpY2F0aW9uRmFjdG9yeSkgewogIGlmICghKGF1dGhlbnRpY2F0aW9uRmFjdG9yeSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSkgewogICAgcmV0dXJuOwogIH0KICBpZiAoIWF1dGhlbnRpY2F0aW9uRmFjdG9yeS5pbml0aWFsaXplKSB7CiAgICBhdXRoZW50aWNhdGlvbkZhY3RvcnkuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIGluaXRpYWxpemUgKCkgewogICAgICByZXR1cm4gU0lQLlV0aWxzLlByb21pc2UucmVzb2x2ZSgpOwogICAgfTsKICB9CiAgcmV0dXJuIGF1dGhlbnRpY2F0aW9uRmFjdG9yeTsKfQoKLyoqCiAqIENvbmZpZ3VyYXRpb24gbG9hZC4KICogQHByaXZhdGUKICogcmV0dXJucyB7Qm9vbGVhbn0KICovClVBLnByb3RvdHlwZS5sb2FkQ29uZmlnID0gZnVuY3Rpb24oY29uZmlndXJhdGlvbikgewogIC8vIFNldHRpbmdzIGFuZCBkZWZhdWx0IHZhbHVlcwogIHZhciBwYXJhbWV0ZXIsIHZhbHVlLCBjaGVja2VkX3ZhbHVlLCBob3N0cG9ydFBhcmFtcywgcmVnaXN0cmFyU2VydmVyLAogICAgc2V0dGluZ3MgPSB7CiAgICAgIC8qIEhvc3QgYWRkcmVzcwogICAgICAqIFZhbHVlIHRvIGJlIHNldCBpbiBWaWEgc2VudF9ieSBhbmQgaG9zdCBwYXJ0IG9mIENvbnRhY3QgRlFETgogICAgICAqLwogICAgICB2aWFIb3N0OiBTSVAuVXRpbHMuY3JlYXRlUmFuZG9tVG9rZW4oMTIpICsgJy5pbnZhbGlkJywKCiAgICAgIHVyaTogbmV3IFNJUC5VUkkoJ3NpcCcsICdhbm9ueW1vdXMuJyArIFNJUC5VdGlscy5jcmVhdGVSYW5kb21Ub2tlbig2KSwgJ2Fub255bW91cy5pbnZhbGlkJywgbnVsbCwgbnVsbCksCiAgICAgIHdzU2VydmVyczogW3sKICAgICAgICBzY2hlbWU6ICdXU1MnLAogICAgICAgIHNpcF91cmk6ICc8c2lwOmVkZ2Uuc2lwLm9uc2lwLmNvbTt0cmFuc3BvcnQ9d3M7bHI+JywKICAgICAgICBzdGF0dXM6IDAsCiAgICAgICAgd2VpZ2h0OiAwLAogICAgICAgIHdzX3VyaTogJ3dzczovL2VkZ2Uuc2lwLm9uc2lwLmNvbScKICAgICAgfV0sCgogICAgICAvLyBQYXNzd29yZAogICAgICBwYXNzd29yZDogbnVsbCwKCiAgICAgIC8vIFJlZ2lzdHJhdGlvbiBwYXJhbWV0ZXJzCiAgICAgIHJlZ2lzdGVyRXhwaXJlczogNjAwLAogICAgICByZWdpc3RlcjogdHJ1ZSwKICAgICAgcmVnaXN0cmFyU2VydmVyOiBudWxsLAoKICAgICAgLy8gVHJhbnNwb3J0IHJlbGF0ZWQgcGFyYW1ldGVycwogICAgICB3c1NlcnZlck1heFJlY29ubmVjdGlvbjogMywKICAgICAgd3NTZXJ2ZXJSZWNvbm5lY3Rpb25UaW1lb3V0OiA0LAoKICAgICAgY29ubmVjdGlvblJlY292ZXJ5TWluSW50ZXJ2YWw6IDIsCiAgICAgIGNvbm5lY3Rpb25SZWNvdmVyeU1heEludGVydmFsOiAzMCwKCiAgICAgIGtlZXBBbGl2ZUludGVydmFsOiAwLAoKICAgICAgZXh0cmFTdXBwb3J0ZWQ6IFtdLAoKICAgICAgdXNlUHJlbG9hZGVkUm91dGU6IGZhbHNlLAoKICAgICAgLy9zdHJpbmcgdG8gYmUgaW5zZXJ0ZWQgaW50byBVc2VyLUFnZW50IHJlcXVlc3QgaGVhZGVyCiAgICAgIHVzZXJBZ2VudFN0cmluZzogU0lQLkMuVVNFUl9BR0VOVCwKCiAgICAgIC8vIFNlc3Npb24gcGFyYW1ldGVycwogICAgICBpY2VDaGVja2luZ1RpbWVvdXQ6IDUwMDAsCiAgICAgIG5vQW5zd2VyVGltZW91dDogNjAsCiAgICAgIHN0dW5TZXJ2ZXJzOiBbJ3N0dW46c3R1bi5sLmdvb2dsZS5jb206MTkzMDInXSwKICAgICAgdHVyblNlcnZlcnM6IFtdLAoKICAgICAgLy8gTG9nZ2luZyBwYXJhbWV0ZXJzCiAgICAgIHRyYWNlU2lwOiBmYWxzZSwKCiAgICAgIC8vIEhhY2tzCiAgICAgIGhhY2tWaWFUY3A6IGZhbHNlLAogICAgICBoYWNrSXBJbkNvbnRhY3Q6IGZhbHNlLAogICAgICBoYWNrV3NzSW5UcmFuc3BvcnQ6IGZhbHNlLAogICAgICBoYWNrQWxsb3dVbnJlZ2lzdGVyZWRPcHRpb25UYWdzOiBmYWxzZSwKCiAgICAgIGNvbnRhY3RUcmFuc3BvcnQ6ICd3cycsCiAgICAgIGZvcmNlUnBvcnQ6IGZhbHNlLAoKICAgICAgLy9hdXRvc3RhcnRpbmcKICAgICAgYXV0b3N0YXJ0OiB0cnVlLAoKICAgICAgLy9SZWxpYWJsZSBQcm92aXNpb25hbCBSZXNwb25zZXMKICAgICAgcmVsMTAwOiBTSVAuQy5zdXBwb3J0ZWQuVU5TVVBQT1JURUQsCgogICAgICAvLyBSZXBsYWNlcyBoZWFkZXIgKFJGQyAzODkxKQogICAgICAvLyBodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzODkxCiAgICAgIHJlcGxhY2VzOiBTSVAuQy5zdXBwb3J0ZWQuVU5TVVBQT1JURUQsCgogICAgICBtZWRpYUhhbmRsZXJGYWN0b3J5OiBTSVAuV2ViUlRDLk1lZGlhSGFuZGxlci5kZWZhdWx0RmFjdG9yeSwKCiAgICAgIGF1dGhlbnRpY2F0aW9uRmFjdG9yeTogY2hlY2tBdXRoZW50aWNhdGlvbkZhY3RvcnkoZnVuY3Rpb24gYXV0aGVudGljYXRpb25GYWN0b3J5ICh1YSkgewogICAgICAgIHJldHVybiBuZXcgU0lQLkRpZ2VzdEF1dGhlbnRpY2F0aW9uKHVhKTsKICAgICAgfSkKICAgIH07CgogIC8vIFByZS1Db25maWd1cmF0aW9uCiAgZnVuY3Rpb24gYWxpYXNVbmRlcnNjb3JlZCAocGFyYW1ldGVyLCBsb2dnZXIpIHsKICAgIHZhciB1bmRlcnNjb3JlZCA9IHBhcmFtZXRlci5yZXBsYWNlKC8oW2Etel1bQS1aXSkvZywgZnVuY3Rpb24gKG0pIHsKICAgICAgcmV0dXJuIG1bMF0gKyAnXycgKyBtWzFdLnRvTG93ZXJDYXNlKCk7CiAgICB9KTsKCiAgICBpZiAocGFyYW1ldGVyID09PSB1bmRlcnNjb3JlZCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGhhc1BhcmFtZXRlciA9IGNvbmZpZ3VyYXRpb24uaGFzT3duUHJvcGVydHkocGFyYW1ldGVyKTsKICAgIGlmIChjb25maWd1cmF0aW9uLmhhc093blByb3BlcnR5KHVuZGVyc2NvcmVkKSkgewogICAgICBsb2dnZXIud2Fybih1bmRlcnNjb3JlZCArICcgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHVzZSAnICsgcGFyYW1ldGVyKTsKICAgICAgaWYgKGhhc1BhcmFtZXRlcikgewogICAgICAgIGxvZ2dlci53YXJuKHBhcmFtZXRlciArICcgb3ZlcnJpZGluZyAnICsgdW5kZXJzY29yZWQpOwogICAgICB9CiAgICB9CgogICAgY29uZmlndXJhdGlvbltwYXJhbWV0ZXJdID0gaGFzUGFyYW1ldGVyID8gY29uZmlndXJhdGlvbltwYXJhbWV0ZXJdIDogY29uZmlndXJhdGlvblt1bmRlcnNjb3JlZF07CiAgfQoKICAvLyBDaGVjayBNYW5kYXRvcnkgcGFyYW1ldGVycwogIGZvcihwYXJhbWV0ZXIgaW4gVUEuY29uZmlndXJhdGlvbl9jaGVjay5tYW5kYXRvcnkpIHsKICAgIGFsaWFzVW5kZXJzY29yZWQocGFyYW1ldGVyLCB0aGlzLmxvZ2dlcik7CiAgICBpZighY29uZmlndXJhdGlvbi5oYXNPd25Qcm9wZXJ0eShwYXJhbWV0ZXIpKSB7CiAgICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5Db25maWd1cmF0aW9uRXJyb3IocGFyYW1ldGVyKTsKICAgIH0gZWxzZSB7CiAgICAgIHZhbHVlID0gY29uZmlndXJhdGlvbltwYXJhbWV0ZXJdOwogICAgICBjaGVja2VkX3ZhbHVlID0gVUEuY29uZmlndXJhdGlvbl9jaGVjay5tYW5kYXRvcnlbcGFyYW1ldGVyXSh2YWx1ZSk7CiAgICAgIGlmIChjaGVja2VkX3ZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBzZXR0aW5nc1twYXJhbWV0ZXJdID0gY2hlY2tlZF92YWx1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuQ29uZmlndXJhdGlvbkVycm9yKHBhcmFtZXRlciwgdmFsdWUpOwogICAgICB9CiAgICB9CiAgfQoKICBTSVAuVXRpbHMub3B0aW9uc092ZXJyaWRlKGNvbmZpZ3VyYXRpb24sICdyZWwxMDAnLCAncmVsaWFibGUnLCB0cnVlLCB0aGlzLmxvZ2dlciwgU0lQLkMuc3VwcG9ydGVkLlVOU1VQUE9SVEVEKTsKCiAgdmFyIGVtcHR5QXJyYXlzQWxsb3dlZCA9IFsnc3R1blNlcnZlcnMnLCAndHVyblNlcnZlcnMnXTsKCiAgLy8gQ2hlY2sgT3B0aW9uYWwgcGFyYW1ldGVycwogIGZvcihwYXJhbWV0ZXIgaW4gVUEuY29uZmlndXJhdGlvbl9jaGVjay5vcHRpb25hbCkgewogICAgYWxpYXNVbmRlcnNjb3JlZChwYXJhbWV0ZXIsIHRoaXMubG9nZ2VyKTsKICAgIGlmKGNvbmZpZ3VyYXRpb24uaGFzT3duUHJvcGVydHkocGFyYW1ldGVyKSkgewogICAgICB2YWx1ZSA9IGNvbmZpZ3VyYXRpb25bcGFyYW1ldGVyXTsKCiAgICAgIC8vIElmIHRoZSBwYXJhbWV0ZXIgdmFsdWUgaXMgYW4gZW1wdHkgYXJyYXksIGJ1dCBzaG91bGRuJ3QgYmUsIGFwcGx5IGl0cyBkZWZhdWx0IHZhbHVlLgogICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSAmJiB2YWx1ZS5sZW5ndGggPT09IDAgJiYgZW1wdHlBcnJheXNBbGxvd2VkLmluZGV4T2YocGFyYW1ldGVyKSA8IDApIHsgY29udGludWU7IH0KCiAgICAgIC8vIElmIHRoZSBwYXJhbWV0ZXIgdmFsdWUgaXMgbnVsbCwgZW1wdHkgc3RyaW5nLCBvciB1bmRlZmluZWQgdGhlbiBhcHBseSBpdHMgZGVmYXVsdCB2YWx1ZS4KICAgICAgaWYodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09ICIiIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHsgY29udGludWU7IH0KICAgICAgLy8gSWYgaXQncyBhIG51bWJlciB3aXRoIE5hTiB2YWx1ZSB0aGVuIGFsc28gYXBwbHkgaXRzIGRlZmF1bHQgdmFsdWUuCiAgICAgIC8vIE5PVEU6IEpTIGRvZXMgbm90IGFsbG93ICJ2YWx1ZSA9PT0gTmFOIiwgdGhlIGZvbGxvd2luZyBkb2VzIHRoZSB3b3JrOgogICAgICBlbHNlIGlmKHR5cGVvZih2YWx1ZSkgPT09ICdudW1iZXInICYmIGlzTmFOKHZhbHVlKSkgeyBjb250aW51ZTsgfQoKICAgICAgY2hlY2tlZF92YWx1ZSA9IFVBLmNvbmZpZ3VyYXRpb25fY2hlY2sub3B0aW9uYWxbcGFyYW1ldGVyXSh2YWx1ZSk7CiAgICAgIGlmIChjaGVja2VkX3ZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBzZXR0aW5nc1twYXJhbWV0ZXJdID0gY2hlY2tlZF92YWx1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBuZXcgU0lQLkV4Y2VwdGlvbnMuQ29uZmlndXJhdGlvbkVycm9yKHBhcmFtZXRlciwgdmFsdWUpOwogICAgICB9CiAgICB9CiAgfQoKICAvLyBTYW5pdHkgQ2hlY2tzCgogIC8vIENvbm5lY3Rpb24gcmVjb3ZlcnkgaW50ZXJ2YWxzCiAgaWYoc2V0dGluZ3MuY29ubmVjdGlvblJlY292ZXJ5TWF4SW50ZXJ2YWwgPCBzZXR0aW5ncy5jb25uZWN0aW9uUmVjb3ZlcnlNaW5JbnRlcnZhbCkgewogICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLkNvbmZpZ3VyYXRpb25FcnJvcignY29ubmVjdGlvblJlY292ZXJ5TWF4SW50ZXJ2YWwnLCBzZXR0aW5ncy5jb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbCk7CiAgfQoKICAvLyBQb3N0IENvbmZpZ3VyYXRpb24gUHJvY2VzcwoKICAvLyBBbGxvdyBwYXNzaW5nIDAgbnVtYmVyIGFzIGRpc3BsYXlOYW1lLgogIGlmIChzZXR0aW5ncy5kaXNwbGF5TmFtZSA9PT0gMCkgewogICAgc2V0dGluZ3MuZGlzcGxheU5hbWUgPSAnMCc7CiAgfQoKICAvLyBJbnN0YW5jZS1pZCBmb3IgR1JVVQogIGlmICghc2V0dGluZ3MuaW5zdGFuY2VJZCkgewogICAgc2V0dGluZ3MuaW5zdGFuY2VJZCA9IFNJUC5VdGlscy5uZXdVVUlEKCk7CiAgfQoKICAvLyBzaXBqc0lkIGluc3RhbmNlIHBhcmFtZXRlci4gU3RhdGljIHJhbmRvbSB0YWcgb2YgbGVuZ3RoIDUKICBzZXR0aW5ncy5zaXBqc0lkID0gU0lQLlV0aWxzLmNyZWF0ZVJhbmRvbVRva2VuKDUpOwoKICAvLyBTdHJpbmcgY29udGFpbmluZyBzZXR0aW5ncy51cmkgd2l0aG91dCBzY2hlbWUgYW5kIHVzZXIuCiAgaG9zdHBvcnRQYXJhbXMgPSBzZXR0aW5ncy51cmkuY2xvbmUoKTsKICBob3N0cG9ydFBhcmFtcy51c2VyID0gbnVsbDsKICBzZXR0aW5ncy5ob3N0cG9ydFBhcmFtcyA9IGhvc3Rwb3J0UGFyYW1zLnRvUmF3KCkucmVwbGFjZSgvXnNpcDovaSwgJycpOwoKICAvKiBDaGVjayB3aGV0aGVyIGF1dGhvcml6YXRpb25Vc2VyIGlzIGV4cGxpY2l0bHkgZGVmaW5lZC4KICAgKiBUYWtlICdzZXR0aW5ncy51cmkudXNlcicgdmFsdWUgaWYgbm90LgogICAqLwogIGlmICghc2V0dGluZ3MuYXV0aG9yaXphdGlvblVzZXIpIHsKICAgIHNldHRpbmdzLmF1dGhvcml6YXRpb25Vc2VyID0gc2V0dGluZ3MudXJpLnVzZXI7CiAgfQoKICAvKiBJZiBubyAncmVnaXN0cmFyU2VydmVyJyBpcyBzZXQgdXNlIHRoZSAndXJpJyB2YWx1ZSB3aXRob3V0IHVzZXIgcG9ydGlvbi4gKi8KICBpZiAoIXNldHRpbmdzLnJlZ2lzdHJhclNlcnZlcikgewogICAgcmVnaXN0cmFyU2VydmVyID0gc2V0dGluZ3MudXJpLmNsb25lKCk7CiAgICByZWdpc3RyYXJTZXJ2ZXIudXNlciA9IG51bGw7CiAgICBzZXR0aW5ncy5yZWdpc3RyYXJTZXJ2ZXIgPSByZWdpc3RyYXJTZXJ2ZXI7CiAgfQoKICAvLyBVc2VyIG5vQW5zd2VyVGltZW91dAogIHNldHRpbmdzLm5vQW5zd2VyVGltZW91dCA9IHNldHRpbmdzLm5vQW5zd2VyVGltZW91dCAqIDEwMDA7CgogIC8vIFZpYSBIb3N0CiAgaWYgKHNldHRpbmdzLmhhY2tJcEluQ29udGFjdCkgewogICAgaWYgKHR5cGVvZiBzZXR0aW5ncy5oYWNrSXBJbkNvbnRhY3QgPT09ICdib29sZWFuJykgewogICAgICBzZXR0aW5ncy52aWFIb3N0ID0gU0lQLlV0aWxzLmdldFJhbmRvbVRlc3ROZXRJUCgpOwogICAgfQogICAgZWxzZSBpZiAodHlwZW9mIHNldHRpbmdzLmhhY2tJcEluQ29udGFjdCA9PT0gJ3N0cmluZycpIHsKICAgICAgc2V0dGluZ3MudmlhSG9zdCA9IHNldHRpbmdzLmhhY2tJcEluQ29udGFjdDsKICAgIH0KICB9CgogIC8vIENvbnRhY3QgdHJhbnNwb3J0IHBhcmFtZXRlcgogIGlmIChzZXR0aW5ncy5oYWNrV3NzSW5UcmFuc3BvcnQpIHsKICAgIHNldHRpbmdzLmNvbnRhY3RUcmFuc3BvcnQgPSAnd3NzJzsKICB9CgogIHRoaXMuY29udGFjdCA9IHsKICAgIHB1Yl9ncnV1OiBudWxsLAogICAgdGVtcF9ncnV1OiBudWxsLAogICAgdXJpOiBuZXcgU0lQLlVSSSgnc2lwJywgU0lQLlV0aWxzLmNyZWF0ZVJhbmRvbVRva2VuKDgpLCBzZXR0aW5ncy52aWFIb3N0LCBudWxsLCB7dHJhbnNwb3J0OiBzZXR0aW5ncy5jb250YWN0VHJhbnNwb3J0fSksCiAgICB0b1N0cmluZzogZnVuY3Rpb24ob3B0aW9ucyl7CiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgICAgdmFyCiAgICAgICAgYW5vbnltb3VzID0gb3B0aW9ucy5hbm9ueW1vdXMgfHwgbnVsbCwKICAgICAgICBvdXRib3VuZCA9IG9wdGlvbnMub3V0Ym91bmQgfHwgbnVsbCwKICAgICAgICBjb250YWN0ID0gJzwnOwoKICAgICAgaWYgKGFub255bW91cykgewogICAgICAgIGNvbnRhY3QgKz0gKHRoaXMudGVtcF9ncnV1IHx8ICgnc2lwOmFub255bW91c0Bhbm9ueW1vdXMuaW52YWxpZDt0cmFuc3BvcnQ9JytzZXR0aW5ncy5jb250YWN0VHJhbnNwb3J0KSkudG9TdHJpbmcoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb250YWN0ICs9ICh0aGlzLnB1Yl9ncnV1IHx8IHRoaXMudXJpKS50b1N0cmluZygpOwogICAgICB9CgogICAgICBpZiAob3V0Ym91bmQpIHsKICAgICAgICBjb250YWN0ICs9ICc7b2InOwogICAgICB9CgogICAgICBjb250YWN0ICs9ICc+JzsKCiAgICAgIHJldHVybiBjb250YWN0OwogICAgfQogIH07CgogIC8vIG1lZGlhIG92ZXJyaWRlcyBtZWRpYUNvbnN0cmFpbnRzCiAgU0lQLlV0aWxzLm9wdGlvbnNPdmVycmlkZShzZXR0aW5ncywgJ21lZGlhJywgJ21lZGlhQ29uc3RyYWludHMnLCB0cnVlLCB0aGlzLmxvZ2dlcik7CgogIC8vIEZpbGwgdGhlIHZhbHVlIG9mIHRoZSBjb25maWd1cmF0aW9uX3NrZWxldG9uCiAgZm9yKHBhcmFtZXRlciBpbiBzZXR0aW5ncykgewogICAgVUEuY29uZmlndXJhdGlvbl9za2VsZXRvbltwYXJhbWV0ZXJdLnZhbHVlID0gc2V0dGluZ3NbcGFyYW1ldGVyXTsKICB9CgogIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMuY29uZmlndXJhdGlvbiwgVUEuY29uZmlndXJhdGlvbl9za2VsZXRvbik7CgogIC8vIENsZWFuIFVBLmNvbmZpZ3VyYXRpb25fc2tlbGV0b24KICBmb3IocGFyYW1ldGVyIGluIHNldHRpbmdzKSB7CiAgICBVQS5jb25maWd1cmF0aW9uX3NrZWxldG9uW3BhcmFtZXRlcl0udmFsdWUgPSAnJzsKICB9CgogIHRoaXMubG9nZ2VyLmxvZygnY29uZmlndXJhdGlvbiBwYXJhbWV0ZXJzIGFmdGVyIHZhbGlkYXRpb246Jyk7CiAgZm9yKHBhcmFtZXRlciBpbiBzZXR0aW5ncykgewogICAgc3dpdGNoKHBhcmFtZXRlcikgewogICAgICBjYXNlICd1cmknOgogICAgICBjYXNlICdyZWdpc3RyYXJTZXJ2ZXInOgogICAgICBjYXNlICdtZWRpYUhhbmRsZXJGYWN0b3J5JzoKICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ8K3ICcgKyBwYXJhbWV0ZXIgKyAnOiAnICsgc2V0dGluZ3NbcGFyYW1ldGVyXSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3Bhc3N3b3JkJzoKICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ8K3ICcgKyBwYXJhbWV0ZXIgKyAnOiAnICsgJ05PVCBTSE9XTicpOwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIHRoaXMubG9nZ2VyLmxvZygnwrcgJyArIHBhcmFtZXRlciArICc6ICcgKyBKU09OLnN0cmluZ2lmeShzZXR0aW5nc1twYXJhbWV0ZXJdKSk7CiAgICB9CiAgfQoKICByZXR1cm47Cn07CgovKioKICogQ29uZmlndXJhdGlvbiBPYmplY3Qgc2tlbGV0b24uCiAqIEBwcml2YXRlCiAqLwpVQS5jb25maWd1cmF0aW9uX3NrZWxldG9uID0gKGZ1bmN0aW9uKCkgewogIHZhciBpZHgsICBwYXJhbWV0ZXIsCiAgICBza2VsZXRvbiA9IHt9LAogICAgcGFyYW1ldGVycyA9IFsKICAgICAgLy8gSW50ZXJuYWwgcGFyYW1ldGVycwogICAgICAic2lwanNJZCIsCiAgICAgICJob3N0cG9ydFBhcmFtcyIsCgogICAgICAvLyBPcHRpb25hbCB1c2VyIGNvbmZpZ3VyYWJsZSBwYXJhbWV0ZXJzCiAgICAgICJ1cmkiLAogICAgICAid3NTZXJ2ZXJzIiwKICAgICAgImF1dGhvcml6YXRpb25Vc2VyIiwKICAgICAgImNvbm5lY3Rpb25SZWNvdmVyeU1heEludGVydmFsIiwKICAgICAgImNvbm5lY3Rpb25SZWNvdmVyeU1pbkludGVydmFsIiwKICAgICAgImtlZXBBbGl2ZUludGVydmFsIiwKICAgICAgImV4dHJhU3VwcG9ydGVkIiwKICAgICAgImRpc3BsYXlOYW1lIiwKICAgICAgImhhY2tWaWFUY3AiLCAvLyBmYWxzZS4KICAgICAgImhhY2tJcEluQ29udGFjdCIsIC8vZmFsc2UKICAgICAgImhhY2tXc3NJblRyYW5zcG9ydCIsIC8vZmFsc2UKICAgICAgImhhY2tBbGxvd1VucmVnaXN0ZXJlZE9wdGlvblRhZ3MiLCAvL2ZhbHNlCiAgICAgICJjb250YWN0VHJhbnNwb3J0IiwgLy8gJ3dzJwogICAgICAiZm9yY2VScG9ydCIsIC8vIGZhbHNlCiAgICAgICJpY2VDaGVja2luZ1RpbWVvdXQiLAogICAgICAiaW5zdGFuY2VJZCIsCiAgICAgICJub0Fuc3dlclRpbWVvdXQiLCAvLyAzMCBzZWNvbmRzLgogICAgICAicGFzc3dvcmQiLAogICAgICAicmVnaXN0ZXJFeHBpcmVzIiwgLy8gNjAwIHNlY29uZHMuCiAgICAgICJyZWdpc3RyYXJTZXJ2ZXIiLAogICAgICAicmVsaWFibGUiLAogICAgICAicmVsMTAwIiwKICAgICAgInJlcGxhY2VzIiwKICAgICAgInVzZXJBZ2VudFN0cmluZyIsIC8vU0lQLkMuVVNFUl9BR0VOVAogICAgICAiYXV0b3N0YXJ0IiwKICAgICAgInN0dW5TZXJ2ZXJzIiwKICAgICAgInRyYWNlU2lwIiwKICAgICAgInR1cm5TZXJ2ZXJzIiwKICAgICAgInVzZVByZWxvYWRlZFJvdXRlIiwKICAgICAgIndzU2VydmVyTWF4UmVjb25uZWN0aW9uIiwKICAgICAgIndzU2VydmVyUmVjb25uZWN0aW9uVGltZW91dCIsCiAgICAgICJtZWRpYUhhbmRsZXJGYWN0b3J5IiwKICAgICAgIm1lZGlhIiwKICAgICAgIm1lZGlhQ29uc3RyYWludHMiLAogICAgICAiYXV0aGVudGljYXRpb25GYWN0b3J5IiwKCiAgICAgIC8vIFBvc3QtY29uZmlndXJhdGlvbiBnZW5lcmF0ZWQgcGFyYW1ldGVycwogICAgICAidmlhX2NvcmVfdmFsdWUiLAogICAgICAidmlhSG9zdCIKICAgIF07CgogIGZvcihpZHggaW4gcGFyYW1ldGVycykgewogICAgcGFyYW1ldGVyID0gcGFyYW1ldGVyc1tpZHhdOwogICAgc2tlbGV0b25bcGFyYW1ldGVyXSA9IHsKICAgICAgdmFsdWU6ICcnLAogICAgICB3cml0YWJsZTogZmFsc2UsCiAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UKICAgIH07CiAgfQoKICBza2VsZXRvblsncmVnaXN0ZXInXSA9IHsKICAgIHZhbHVlOiAnJywKICAgIHdyaXRhYmxlOiB0cnVlLAogICAgY29uZmlndXJhYmxlOiBmYWxzZQogIH07CgogIHJldHVybiBza2VsZXRvbjsKfSgpKTsKCi8qKgogKiBDb25maWd1cmF0aW9uIGNoZWNrZXIuCiAqIEBwcml2YXRlCiAqIEByZXR1cm4ge0Jvb2xlYW59CiAqLwpVQS5jb25maWd1cmF0aW9uX2NoZWNrID0gewogIG1hbmRhdG9yeTogewogIH0sCgogIG9wdGlvbmFsOiB7CgogICAgdXJpOiBmdW5jdGlvbih1cmkpIHsKICAgICAgdmFyIHBhcnNlZDsKCiAgICAgIGlmICghKC9ec2lwOi9pKS50ZXN0KHVyaSkpIHsKICAgICAgICB1cmkgPSBTSVAuQy5TSVAgKyAnOicgKyB1cmk7CiAgICAgIH0KICAgICAgcGFyc2VkID0gU0lQLlVSSS5wYXJzZSh1cmkpOwoKICAgICAgaWYoIXBhcnNlZCkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmKCFwYXJzZWQudXNlcikgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcGFyc2VkOwogICAgICB9CiAgICB9LAoKICAgIC8vTm90ZTogdGhpcyBmdW5jdGlvbiB1c2VkIHRvIGNhbGwgJ3RoaXMubG9nZ2VyLmVycm9yJyBidXQgY2FsbGluZyAndGhpcycgd2l0aCBhbnl0aGluZyBoZXJlIGlzIGludmFsaWQKICAgIHdzU2VydmVyczogZnVuY3Rpb24od3NTZXJ2ZXJzKSB7CiAgICAgIHZhciBpZHgsIGxlbmd0aCwgdXJsOwoKICAgICAgLyogQWxsb3cgZGVmaW5pbmcgd3NTZXJ2ZXJzIHBhcmFtZXRlciBhczoKICAgICAgICogIFN0cmluZzogImhvc3QiCiAgICAgICAqICBBcnJheSBvZiBTdHJpbmdzOiBbImhvc3QxIiwgImhvc3QyIl0KICAgICAgICogIEFycmF5IG9mIE9iamVjdHM6IFt7d3NfdXJpOiJob3N0MSIsIHdlaWdodDoxfSwge3dzX3VyaToiaG9zdDIiLCB3ZWlnaHQ6MH1dCiAgICAgICAqICBBcnJheSBvZiBPYmplY3RzIGFuZCBTdHJpbmdzOiBbe3dzX3VyaToiaG9zdDEifSwgImhvc3QyIl0KICAgICAgICovCiAgICAgIGlmICh0eXBlb2Ygd3NTZXJ2ZXJzID09PSAnc3RyaW5nJykgewogICAgICAgIHdzU2VydmVycyA9IFt7d3NfdXJpOiB3c1NlcnZlcnN9XTsKICAgICAgfSBlbHNlIGlmICh3c1NlcnZlcnMgaW5zdGFuY2VvZiBBcnJheSkgewogICAgICAgIGxlbmd0aCA9IHdzU2VydmVycy5sZW5ndGg7CiAgICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CiAgICAgICAgICBpZiAodHlwZW9mIHdzU2VydmVyc1tpZHhdID09PSAnc3RyaW5nJyl7CiAgICAgICAgICAgIHdzU2VydmVyc1tpZHhdID0ge3dzX3VyaTogd3NTZXJ2ZXJzW2lkeF19OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh3c1NlcnZlcnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBsZW5ndGggPSB3c1NlcnZlcnMubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBpZiAoIXdzU2VydmVyc1tpZHhdLndzX3VyaSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAod3NTZXJ2ZXJzW2lkeF0ud2VpZ2h0ICYmICFOdW1iZXIod3NTZXJ2ZXJzW2lkeF0ud2VpZ2h0KSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdXJsID0gU0lQLkdyYW1tYXIucGFyc2Uod3NTZXJ2ZXJzW2lkeF0ud3NfdXJpLCAnYWJzb2x1dGVVUkknKTsKCiAgICAgICAgaWYodXJsID09PSAtMSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZihbJ3dzcycsICd3cycsICd1ZHAnXS5pbmRleE9mKHVybC5zY2hlbWUpIDwgMCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3c1NlcnZlcnNbaWR4XS5zaXBfdXJpID0gJzxzaXA6JyArIHVybC5ob3N0ICsgKHVybC5wb3J0ID8gJzonICsgdXJsLnBvcnQgOiAnJykgKyAnO3RyYW5zcG9ydD0nICsgdXJsLnNjaGVtZS5yZXBsYWNlKC9ed3NzJC9pLCAnd3MnKSArICc7bHI+JzsKCiAgICAgICAgICBpZiAoIXdzU2VydmVyc1tpZHhdLndlaWdodCkgewogICAgICAgICAgICB3c1NlcnZlcnNbaWR4XS53ZWlnaHQgPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIHdzU2VydmVyc1tpZHhdLnN0YXR1cyA9IDA7CiAgICAgICAgICB3c1NlcnZlcnNbaWR4XS5zY2hlbWUgPSB1cmwuc2NoZW1lLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB3c1NlcnZlcnM7CiAgICB9LAoKICAgIGF1dGhvcml6YXRpb25Vc2VyOiBmdW5jdGlvbihhdXRob3JpemF0aW9uVXNlcikgewogICAgICBpZihTSVAuR3JhbW1hci5wYXJzZSgnIicrIGF1dGhvcml6YXRpb25Vc2VyICsnIicsICdxdW90ZWRfc3RyaW5nJykgPT09IC0xKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBhdXRob3JpemF0aW9uVXNlcjsKICAgICAgfQogICAgfSwKCiAgICBjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbDogZnVuY3Rpb24oY29ubmVjdGlvblJlY292ZXJ5TWF4SW50ZXJ2YWwpIHsKICAgICAgdmFyIHZhbHVlOwogICAgICBpZihTSVAuVXRpbHMuaXNEZWNpbWFsKGNvbm5lY3Rpb25SZWNvdmVyeU1heEludGVydmFsKSkgewogICAgICAgIHZhbHVlID0gTnVtYmVyKGNvbm5lY3Rpb25SZWNvdmVyeU1heEludGVydmFsKTsKICAgICAgICBpZih2YWx1ZSA+IDApIHsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgY29ubmVjdGlvblJlY292ZXJ5TWluSW50ZXJ2YWw6IGZ1bmN0aW9uKGNvbm5lY3Rpb25SZWNvdmVyeU1pbkludGVydmFsKSB7CiAgICAgIHZhciB2YWx1ZTsKICAgICAgaWYoU0lQLlV0aWxzLmlzRGVjaW1hbChjb25uZWN0aW9uUmVjb3ZlcnlNaW5JbnRlcnZhbCkpIHsKICAgICAgICB2YWx1ZSA9IE51bWJlcihjb25uZWN0aW9uUmVjb3ZlcnlNaW5JbnRlcnZhbCk7CiAgICAgICAgaWYodmFsdWUgPiAwKSB7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIGRpc3BsYXlOYW1lOiBmdW5jdGlvbihkaXNwbGF5TmFtZSkgewogICAgICBpZihTSVAuR3JhbW1hci5wYXJzZSgnIicgKyBkaXNwbGF5TmFtZSArICciJywgJ2Rpc3BsYXlOYW1lJykgPT09IC0xKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBkaXNwbGF5TmFtZTsKICAgICAgfQogICAgfSwKCiAgICBoYWNrVmlhVGNwOiBmdW5jdGlvbihoYWNrVmlhVGNwKSB7CiAgICAgIGlmICh0eXBlb2YgaGFja1ZpYVRjcCA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgcmV0dXJuIGhhY2tWaWFUY3A7CiAgICAgIH0KICAgIH0sCgogICAgaGFja0lwSW5Db250YWN0OiBmdW5jdGlvbihoYWNrSXBJbkNvbnRhY3QpIHsKICAgICAgaWYgKHR5cGVvZiBoYWNrSXBJbkNvbnRhY3QgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiBoYWNrSXBJbkNvbnRhY3Q7CiAgICAgIH0KICAgICAgZWxzZSBpZiAodHlwZW9mIGhhY2tJcEluQ29udGFjdCA9PT0gJ3N0cmluZycgJiYgU0lQLkdyYW1tYXIucGFyc2UoaGFja0lwSW5Db250YWN0LCAnaG9zdCcpICE9PSAtMSkgewogICAgICAgIHJldHVybiBoYWNrSXBJbkNvbnRhY3Q7CiAgICAgIH0KICAgIH0sCgogICAgaWNlQ2hlY2tpbmdUaW1lb3V0OiBmdW5jdGlvbihpY2VDaGVja2luZ1RpbWVvdXQpIHsKICAgICAgaWYoU0lQLlV0aWxzLmlzRGVjaW1hbChpY2VDaGVja2luZ1RpbWVvdXQpKSB7CiAgICAgICAgcmV0dXJuIE1hdGgubWF4KDUwMCwgaWNlQ2hlY2tpbmdUaW1lb3V0KTsKICAgICAgfQogICAgfSwKCiAgICBoYWNrV3NzSW5UcmFuc3BvcnQ6IGZ1bmN0aW9uKGhhY2tXc3NJblRyYW5zcG9ydCkgewogICAgICBpZiAodHlwZW9mIGhhY2tXc3NJblRyYW5zcG9ydCA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgcmV0dXJuIGhhY2tXc3NJblRyYW5zcG9ydDsKICAgICAgfQogICAgfSwKCiAgICBoYWNrQWxsb3dVbnJlZ2lzdGVyZWRPcHRpb25UYWdzOiBmdW5jdGlvbihoYWNrQWxsb3dVbnJlZ2lzdGVyZWRPcHRpb25UYWdzKSB7CiAgICAgIGlmICh0eXBlb2YgaGFja0FsbG93VW5yZWdpc3RlcmVkT3B0aW9uVGFncyA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgcmV0dXJuIGhhY2tBbGxvd1VucmVnaXN0ZXJlZE9wdGlvblRhZ3M7CiAgICAgIH0KICAgIH0sCgogICAgY29udGFjdFRyYW5zcG9ydDogZnVuY3Rpb24oY29udGFjdFRyYW5zcG9ydCkgewogICAgICBpZiAodHlwZW9mIGNvbnRhY3RUcmFuc3BvcnQgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgcmV0dXJuIGNvbnRhY3RUcmFuc3BvcnQ7CiAgICAgIH0KICAgIH0sCgogICAgZm9yY2VScG9ydDogZnVuY3Rpb24oZm9yY2VScG9ydCkgewogICAgICBpZiAodHlwZW9mIGZvcmNlUnBvcnQgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiBmb3JjZVJwb3J0OwogICAgICB9CiAgICB9LAoKICAgIGluc3RhbmNlSWQ6IGZ1bmN0aW9uKGluc3RhbmNlSWQpIHsKICAgICAgaWYodHlwZW9mIGluc3RhbmNlSWQgIT09ICdzdHJpbmcnKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoKC9edXVpZDovaS50ZXN0KGluc3RhbmNlSWQpKSkgewogICAgICAgIGluc3RhbmNlSWQgPSBpbnN0YW5jZUlkLnN1YnN0cig1KTsKICAgICAgfQoKICAgICAgaWYoU0lQLkdyYW1tYXIucGFyc2UoaW5zdGFuY2VJZCwgJ3V1aWQnKSA9PT0gLTEpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGluc3RhbmNlSWQ7CiAgICAgIH0KICAgIH0sCgogICAga2VlcEFsaXZlSW50ZXJ2YWw6IGZ1bmN0aW9uKGtlZXBBbGl2ZUludGVydmFsKSB7CiAgICAgIHZhciB2YWx1ZTsKICAgICAgaWYgKFNJUC5VdGlscy5pc0RlY2ltYWwoa2VlcEFsaXZlSW50ZXJ2YWwpKSB7CiAgICAgICAgdmFsdWUgPSBOdW1iZXIoa2VlcEFsaXZlSW50ZXJ2YWwpOwogICAgICAgIGlmICh2YWx1ZSA+IDApIHsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgZXh0cmFTdXBwb3J0ZWQ6IGZ1bmN0aW9uKG9wdGlvblRhZ3MpIHsKICAgICAgdmFyIGlkeCwgbGVuZ3RoOwoKICAgICAgaWYgKCEob3B0aW9uVGFncyBpbnN0YW5jZW9mIEFycmF5KSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgbGVuZ3RoID0gb3B0aW9uVGFncy5sZW5ndGg7CiAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICAgIGlmICh0eXBlb2Ygb3B0aW9uVGFnc1tpZHhdICE9PSAnc3RyaW5nJykgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG9wdGlvblRhZ3M7CiAgICB9LAoKICAgIG5vQW5zd2VyVGltZW91dDogZnVuY3Rpb24obm9BbnN3ZXJUaW1lb3V0KSB7CiAgICAgIHZhciB2YWx1ZTsKICAgICAgaWYgKFNJUC5VdGlscy5pc0RlY2ltYWwobm9BbnN3ZXJUaW1lb3V0KSkgewogICAgICAgIHZhbHVlID0gTnVtYmVyKG5vQW5zd2VyVGltZW91dCk7CiAgICAgICAgaWYgKHZhbHVlID4gMCkgewogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBwYXNzd29yZDogZnVuY3Rpb24ocGFzc3dvcmQpIHsKICAgICAgcmV0dXJuIFN0cmluZyhwYXNzd29yZCk7CiAgICB9LAoKICAgIHJlbDEwMDogZnVuY3Rpb24ocmVsMTAwKSB7CiAgICAgIGlmKHJlbDEwMCA9PT0gU0lQLkMuc3VwcG9ydGVkLlJFUVVJUkVEKSB7CiAgICAgICAgcmV0dXJuIFNJUC5DLnN1cHBvcnRlZC5SRVFVSVJFRDsKICAgICAgfSBlbHNlIGlmIChyZWwxMDAgPT09IFNJUC5DLnN1cHBvcnRlZC5TVVBQT1JURUQpIHsKICAgICAgICByZXR1cm4gU0lQLkMuc3VwcG9ydGVkLlNVUFBPUlRFRDsKICAgICAgfSBlbHNlICB7CiAgICAgICAgcmV0dXJuIFNJUC5DLnN1cHBvcnRlZC5VTlNVUFBPUlRFRDsKICAgICAgfQogICAgfSwKCiAgICByZXBsYWNlczogZnVuY3Rpb24ocmVwbGFjZXMpIHsKICAgICAgaWYocmVwbGFjZXMgPT09IFNJUC5DLnN1cHBvcnRlZC5SRVFVSVJFRCkgewogICAgICAgIHJldHVybiBTSVAuQy5zdXBwb3J0ZWQuUkVRVUlSRUQ7CiAgICAgIH0gZWxzZSBpZiAocmVwbGFjZXMgPT09IFNJUC5DLnN1cHBvcnRlZC5TVVBQT1JURUQpIHsKICAgICAgICByZXR1cm4gU0lQLkMuc3VwcG9ydGVkLlNVUFBPUlRFRDsKICAgICAgfSBlbHNlICB7CiAgICAgICAgcmV0dXJuIFNJUC5DLnN1cHBvcnRlZC5VTlNVUFBPUlRFRDsKICAgICAgfQogICAgfSwKCiAgICByZWdpc3RlcjogZnVuY3Rpb24ocmVnaXN0ZXIpIHsKICAgICAgaWYgKHR5cGVvZiByZWdpc3RlciA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgcmV0dXJuIHJlZ2lzdGVyOwogICAgICB9CiAgICB9LAoKICAgIHJlZ2lzdGVyRXhwaXJlczogZnVuY3Rpb24ocmVnaXN0ZXJFeHBpcmVzKSB7CiAgICAgIHZhciB2YWx1ZTsKICAgICAgaWYgKFNJUC5VdGlscy5pc0RlY2ltYWwocmVnaXN0ZXJFeHBpcmVzKSkgewogICAgICAgIHZhbHVlID0gTnVtYmVyKHJlZ2lzdGVyRXhwaXJlcyk7CiAgICAgICAgaWYgKHZhbHVlID4gMCkgewogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICByZWdpc3RyYXJTZXJ2ZXI6IGZ1bmN0aW9uKHJlZ2lzdHJhclNlcnZlcikgewogICAgICB2YXIgcGFyc2VkOwoKICAgICAgaWYodHlwZW9mIHJlZ2lzdHJhclNlcnZlciAhPT0gJ3N0cmluZycpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghL15zaXA6L2kudGVzdChyZWdpc3RyYXJTZXJ2ZXIpKSB7CiAgICAgICAgcmVnaXN0cmFyU2VydmVyID0gU0lQLkMuU0lQICsgJzonICsgcmVnaXN0cmFyU2VydmVyOwogICAgICB9CiAgICAgIHBhcnNlZCA9IFNJUC5VUkkucGFyc2UocmVnaXN0cmFyU2VydmVyKTsKCiAgICAgIGlmKCFwYXJzZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZihwYXJzZWQudXNlcikgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcGFyc2VkOwogICAgICB9CiAgICB9LAoKICAgIHN0dW5TZXJ2ZXJzOiBmdW5jdGlvbihzdHVuU2VydmVycykgewogICAgICB2YXIgaWR4LCBsZW5ndGgsIHN0dW5fc2VydmVyOwoKICAgICAgaWYgKHR5cGVvZiBzdHVuU2VydmVycyA9PT0gJ3N0cmluZycpIHsKICAgICAgICBzdHVuU2VydmVycyA9IFtzdHVuU2VydmVyc107CiAgICAgIH0gZWxzZSBpZiAoIShzdHVuU2VydmVycyBpbnN0YW5jZW9mIEFycmF5KSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgbGVuZ3RoID0gc3R1blNlcnZlcnMubGVuZ3RoOwogICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbmd0aDsgaWR4KyspIHsKICAgICAgICBzdHVuX3NlcnZlciA9IHN0dW5TZXJ2ZXJzW2lkeF07CiAgICAgICAgaWYgKCEoL15zdHVucz86Ly50ZXN0KHN0dW5fc2VydmVyKSkpIHsKICAgICAgICAgIHN0dW5fc2VydmVyID0gJ3N0dW46JyArIHN0dW5fc2VydmVyOwogICAgICAgIH0KCiAgICAgICAgaWYoU0lQLkdyYW1tYXIucGFyc2Uoc3R1bl9zZXJ2ZXIsICdzdHVuX1VSSScpID09PSAtMSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdHVuU2VydmVyc1tpZHhdID0gc3R1bl9zZXJ2ZXI7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBzdHVuU2VydmVyczsKICAgIH0sCgogICAgdHJhY2VTaXA6IGZ1bmN0aW9uKHRyYWNlU2lwKSB7CiAgICAgIGlmICh0eXBlb2YgdHJhY2VTaXAgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiB0cmFjZVNpcDsKICAgICAgfQogICAgfSwKCiAgICB0dXJuU2VydmVyczogZnVuY3Rpb24odHVyblNlcnZlcnMpIHsKICAgICAgdmFyIGlkeCwgamR4LCBsZW5ndGgsIHR1cm5fc2VydmVyLCBudW1fdHVybl9zZXJ2ZXJfdXJscywgdXJsOwoKICAgICAgaWYgKHR1cm5TZXJ2ZXJzIGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgICAvLyBEbyBub3RoaW5nCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHVyblNlcnZlcnMgPSBbdHVyblNlcnZlcnNdOwogICAgICB9CgogICAgICBsZW5ndGggPSB0dXJuU2VydmVycy5sZW5ndGg7CiAgICAgIGZvciAoaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykgewogICAgICAgIHR1cm5fc2VydmVyID0gdHVyblNlcnZlcnNbaWR4XTsKICAgICAgICAvL0JhY2t3YXJkcyBjb21wYXRpYmlsaXR5OiBBbGxvdyBkZWZpbmluZyB0aGUgdHVybl9zZXJ2ZXIgdXJsIHdpdGggdGhlICdzZXJ2ZXInIHByb3BlcnR5LgogICAgICAgIGlmICh0dXJuX3NlcnZlci5zZXJ2ZXIpIHsKICAgICAgICAgIHR1cm5fc2VydmVyLnVybHMgPSBbdHVybl9zZXJ2ZXIuc2VydmVyXTsKICAgICAgICB9CgogICAgICAgIGlmICghdHVybl9zZXJ2ZXIudXJscyB8fCAhdHVybl9zZXJ2ZXIudXNlcm5hbWUgfHwgIXR1cm5fc2VydmVyLnBhc3N3b3JkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodHVybl9zZXJ2ZXIudXJscyBpbnN0YW5jZW9mIEFycmF5KSB7CiAgICAgICAgICBudW1fdHVybl9zZXJ2ZXJfdXJscyA9IHR1cm5fc2VydmVyLnVybHMubGVuZ3RoOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0dXJuX3NlcnZlci51cmxzID0gW3R1cm5fc2VydmVyLnVybHNdOwogICAgICAgICAgbnVtX3R1cm5fc2VydmVyX3VybHMgPSAxOwogICAgICAgIH0KCiAgICAgICAgZm9yIChqZHggPSAwOyBqZHggPCBudW1fdHVybl9zZXJ2ZXJfdXJsczsgamR4KyspIHsKICAgICAgICAgIHVybCA9IHR1cm5fc2VydmVyLnVybHNbamR4XTsKCiAgICAgICAgICBpZiAoISgvXnR1cm5zPzovLnRlc3QodXJsKSkpIHsKICAgICAgICAgICAgdXJsID0gJ3R1cm46JyArIHVybDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZihTSVAuR3JhbW1hci5wYXJzZSh1cmwsICd0dXJuX1VSSScpID09PSAtMSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB0dXJuU2VydmVyczsKICAgIH0sCgogICAgdXNlckFnZW50U3RyaW5nOiBmdW5jdGlvbih1c2VyQWdlbnRTdHJpbmcpIHsKICAgICAgaWYgKHR5cGVvZiB1c2VyQWdlbnRTdHJpbmcgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgcmV0dXJuIHVzZXJBZ2VudFN0cmluZzsKICAgICAgfQogICAgfSwKCiAgICB1c2VQcmVsb2FkZWRSb3V0ZTogZnVuY3Rpb24odXNlUHJlbG9hZGVkUm91dGUpIHsKICAgICAgaWYgKHR5cGVvZiB1c2VQcmVsb2FkZWRSb3V0ZSA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgcmV0dXJuIHVzZVByZWxvYWRlZFJvdXRlOwogICAgICB9CiAgICB9LAoKICAgIHdzU2VydmVyTWF4UmVjb25uZWN0aW9uOiBmdW5jdGlvbih3c1NlcnZlck1heFJlY29ubmVjdGlvbikgewogICAgICB2YXIgdmFsdWU7CiAgICAgIGlmIChTSVAuVXRpbHMuaXNEZWNpbWFsKHdzU2VydmVyTWF4UmVjb25uZWN0aW9uKSkgewogICAgICAgIHZhbHVlID0gTnVtYmVyKHdzU2VydmVyTWF4UmVjb25uZWN0aW9uKTsKICAgICAgICBpZiAodmFsdWUgPiAwKSB7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIHdzU2VydmVyUmVjb25uZWN0aW9uVGltZW91dDogZnVuY3Rpb24od3NTZXJ2ZXJSZWNvbm5lY3Rpb25UaW1lb3V0KSB7CiAgICAgIHZhciB2YWx1ZTsKICAgICAgaWYgKFNJUC5VdGlscy5pc0RlY2ltYWwod3NTZXJ2ZXJSZWNvbm5lY3Rpb25UaW1lb3V0KSkgewogICAgICAgIHZhbHVlID0gTnVtYmVyKHdzU2VydmVyUmVjb25uZWN0aW9uVGltZW91dCk7CiAgICAgICAgaWYgKHZhbHVlID4gMCkgewogICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBhdXRvc3RhcnQ6IGZ1bmN0aW9uKGF1dG9zdGFydCkgewogICAgICBpZiAodHlwZW9mIGF1dG9zdGFydCA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgcmV0dXJuIGF1dG9zdGFydDsKICAgICAgfQogICAgfSwKCiAgICBtZWRpYUhhbmRsZXJGYWN0b3J5OiBmdW5jdGlvbihtZWRpYUhhbmRsZXJGYWN0b3J5KSB7CiAgICAgIGlmIChtZWRpYUhhbmRsZXJGYWN0b3J5IGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICB2YXIgcHJvbWlzaWZpZWRGYWN0b3J5ID0gZnVuY3Rpb24gcHJvbWlzaWZpZWRGYWN0b3J5ICgpIHsKICAgICAgICAgIHZhciBtZWRpYUhhbmRsZXIgPSBtZWRpYUhhbmRsZXJGYWN0b3J5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgogICAgICAgICAgZnVuY3Rpb24gcGF0Y2hNZXRob2QgKG1ldGhvZE5hbWUpIHsKICAgICAgICAgICAgdmFyIG1ldGhvZCA9IG1lZGlhSGFuZGxlclttZXRob2ROYW1lXTsKICAgICAgICAgICAgaWYgKG1ldGhvZC5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgdmFyIGNhbGxiYWNrc0ZpcnN0ID0gbWV0aG9kTmFtZSA9PT0gJ2dldERlc2NyaXB0aW9uJzsKICAgICAgICAgICAgICBtZWRpYUhhbmRsZXJbbWV0aG9kTmFtZV0gPSBTSVAuVXRpbHMucHJvbWlzaWZ5KG1lZGlhSGFuZGxlciwgbWV0aG9kTmFtZSwgY2FsbGJhY2tzRmlyc3QpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcGF0Y2hNZXRob2QoJ2dldERlc2NyaXB0aW9uJyk7CiAgICAgICAgICBwYXRjaE1ldGhvZCgnc2V0RGVzY3JpcHRpb24nKTsKCiAgICAgICAgICByZXR1cm4gbWVkaWFIYW5kbGVyOwogICAgICAgIH07CgogICAgICAgIHByb21pc2lmaWVkRmFjdG9yeS5pc1N1cHBvcnRlZCA9IG1lZGlhSGFuZGxlckZhY3RvcnkuaXNTdXBwb3J0ZWQ7CiAgICAgICAgcmV0dXJuIHByb21pc2lmaWVkRmFjdG9yeTsKICAgICAgfQogICAgfSwKCiAgICBhdXRoZW50aWNhdGlvbkZhY3Rvcnk6IGNoZWNrQXV0aGVudGljYXRpb25GYWN0b3J5CiAgfQp9OwoKVUEuQyA9IEM7ClNJUC5VQSA9IFVBOwp9OwoKfSkuY2FsbCh0aGlzLHR5cGVvZiBnbG9iYWwgIT09ICJ1bmRlZmluZWQiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICJ1bmRlZmluZWQiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09ICJ1bmRlZmluZWQiID8gd2luZG93IDoge30pCn0se31dLDM0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBTSVAgVVJJCiAqLwoKLyoqCiAqIEBhdWdtZW50cyBTSVAKICogQGNsYXNzIENsYXNzIGNyZWF0aW5nIGEgU0lQIFVSSS4KICoKICogQHBhcmFtIHtTdHJpbmd9IFtzY2hlbWVdCiAqIEBwYXJhbSB7U3RyaW5nfSBbdXNlcl0KICogQHBhcmFtIHtTdHJpbmd9IGhvc3QKICogQHBhcmFtIHtTdHJpbmd9IFtwb3J0XQogKiBAcGFyYW0ge09iamVjdH0gW3BhcmFtZXRlcnNdCiAqIEBwYXJhbSB7T2JqZWN0fSBbaGVhZGVyc10KICoKICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewp2YXIgVVJJOwoKVVJJID0gZnVuY3Rpb24oc2NoZW1lLCB1c2VyLCBob3N0LCBwb3J0LCBwYXJhbWV0ZXJzLCBoZWFkZXJzKSB7CiAgdmFyIHBhcmFtLCBoZWFkZXIsIHJhdywgbm9ybWFsOwoKICAvLyBDaGVja3MKICBpZighaG9zdCkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignbWlzc2luZyBvciBpbnZhbGlkICJob3N0IiBwYXJhbWV0ZXInKTsKICB9CgogIC8vIEluaXRpYWxpemUgcGFyYW1ldGVycwogIHNjaGVtZSA9IHNjaGVtZSB8fCBTSVAuQy5TSVA7CiAgdGhpcy5wYXJhbWV0ZXJzID0ge307CiAgdGhpcy5oZWFkZXJzID0ge307CgogIGZvciAocGFyYW0gaW4gcGFyYW1ldGVycykgewogICAgdGhpcy5zZXRQYXJhbShwYXJhbSwgcGFyYW1ldGVyc1twYXJhbV0pOwogIH0KCiAgZm9yIChoZWFkZXIgaW4gaGVhZGVycykgewogICAgdGhpcy5zZXRIZWFkZXIoaGVhZGVyLCBoZWFkZXJzW2hlYWRlcl0pOwogIH0KCiAgLy8gUmF3IFVSSQogIHJhdyA9IHsKICAgIHNjaGVtZTogc2NoZW1lLAogICAgdXNlcjogdXNlciwKICAgIGhvc3Q6IGhvc3QsCiAgICBwb3J0OiBwb3J0CiAgfTsKCiAgLy8gTm9ybWFsaXplZCBVUkkKICBub3JtYWwgPSB7CiAgICBzY2hlbWU6IHNjaGVtZS50b0xvd2VyQ2FzZSgpLAogICAgdXNlcjogdXNlciwKICAgIGhvc3Q6IGhvc3QudG9Mb3dlckNhc2UoKSwKICAgIHBvcnQ6IHBvcnQKICB9OwoKICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB7CiAgICBfbm9ybWFsOiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBub3JtYWw7IH0KICAgIH0sCgogICAgX3JhdzogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gcmF3OyB9CiAgICB9LAoKICAgIHNjaGVtZTogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbm9ybWFsLnNjaGVtZTsgfSwKICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgIHJhdy5zY2hlbWUgPSB2YWx1ZTsKICAgICAgICBub3JtYWwuc2NoZW1lID0gdmFsdWUudG9Mb3dlckNhc2UoKTsKICAgICAgfQogICAgfSwKCiAgICB1c2VyOiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBub3JtYWwudXNlcjsgfSwKICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgIG5vcm1hbC51c2VyID0gcmF3LnVzZXIgPSB2YWx1ZTsKICAgICAgfQogICAgfSwKCiAgICBob3N0OiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBub3JtYWwuaG9zdDsgfSwKICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgIHJhdy5ob3N0ID0gdmFsdWU7CiAgICAgICAgbm9ybWFsLmhvc3QgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpOwogICAgICB9CiAgICB9LAoKICAgIGFvcjogewogICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbm9ybWFsLnVzZXIgKyAnQCcgKyBub3JtYWwuaG9zdDsgfQogICAgfSwKCiAgICBwb3J0OiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBub3JtYWwucG9ydDsgfSwKICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICAgIG5vcm1hbC5wb3J0ID0gcmF3LnBvcnQgPSB2YWx1ZSA9PT0gMCA/IHZhbHVlIDogKHBhcnNlSW50KHZhbHVlLDEwKSB8fCBudWxsKTsKICAgICAgfQogICAgfQogIH0pOwp9OwoKVVJJLnByb3RvdHlwZSA9IHsKICBzZXRQYXJhbTogZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewogICAgaWYoa2V5KSB7CiAgICAgIHRoaXMucGFyYW1ldGVyc1trZXkudG9Mb3dlckNhc2UoKV0gPSAodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyB8fCB2YWx1ZSA9PT0gbnVsbCkgPyBudWxsIDogdmFsdWUudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpOwogICAgfQogIH0sCgogIGdldFBhcmFtOiBmdW5jdGlvbihrZXkpIHsKICAgIGlmKGtleSkgewogICAgICByZXR1cm4gdGhpcy5wYXJhbWV0ZXJzW2tleS50b0xvd2VyQ2FzZSgpXTsKICAgIH0KICB9LAoKICBoYXNQYXJhbTogZnVuY3Rpb24oa2V5KSB7CiAgICBpZihrZXkpIHsKICAgICAgcmV0dXJuICh0aGlzLnBhcmFtZXRlcnMuaGFzT3duUHJvcGVydHkoa2V5LnRvTG93ZXJDYXNlKCkpICYmIHRydWUpIHx8IGZhbHNlOwogICAgfQogIH0sCgogIGRlbGV0ZVBhcmFtOiBmdW5jdGlvbihwYXJhbWV0ZXIpIHsKICAgIHZhciB2YWx1ZTsKICAgIHBhcmFtZXRlciA9IHBhcmFtZXRlci50b0xvd2VyQ2FzZSgpOwogICAgaWYgKHRoaXMucGFyYW1ldGVycy5oYXNPd25Qcm9wZXJ0eShwYXJhbWV0ZXIpKSB7CiAgICAgIHZhbHVlID0gdGhpcy5wYXJhbWV0ZXJzW3BhcmFtZXRlcl07CiAgICAgIGRlbGV0ZSB0aGlzLnBhcmFtZXRlcnNbcGFyYW1ldGVyXTsKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQogIH0sCgogIGNsZWFyUGFyYW1zOiBmdW5jdGlvbigpIHsKICAgIHRoaXMucGFyYW1ldGVycyA9IHt9OwogIH0sCgogIHNldEhlYWRlcjogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHsKICAgIHRoaXMuaGVhZGVyc1tTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpXSA9ICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSA/IHZhbHVlIDogW3ZhbHVlXTsKICB9LAoKICBnZXRIZWFkZXI6IGZ1bmN0aW9uKG5hbWUpIHsKICAgIGlmKG5hbWUpIHsKICAgICAgcmV0dXJuIHRoaXMuaGVhZGVyc1tTSVAuVXRpbHMuaGVhZGVyaXplKG5hbWUpXTsKICAgIH0KICB9LAoKICBoYXNIZWFkZXI6IGZ1bmN0aW9uKG5hbWUpIHsKICAgIGlmKG5hbWUpIHsKICAgICAgcmV0dXJuICh0aGlzLmhlYWRlcnMuaGFzT3duUHJvcGVydHkoU0lQLlV0aWxzLmhlYWRlcml6ZShuYW1lKSkgJiYgdHJ1ZSkgfHwgZmFsc2U7CiAgICB9CiAgfSwKCiAgZGVsZXRlSGVhZGVyOiBmdW5jdGlvbihoZWFkZXIpIHsKICAgIHZhciB2YWx1ZTsKICAgIGhlYWRlciA9IFNJUC5VdGlscy5oZWFkZXJpemUoaGVhZGVyKTsKICAgIGlmKHRoaXMuaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShoZWFkZXIpKSB7CiAgICAgIHZhbHVlID0gdGhpcy5oZWFkZXJzW2hlYWRlcl07CiAgICAgIGRlbGV0ZSB0aGlzLmhlYWRlcnNbaGVhZGVyXTsKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQogIH0sCgogIGNsZWFySGVhZGVyczogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmhlYWRlcnMgPSB7fTsKICB9LAoKICBjbG9uZTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gbmV3IFVSSSgKICAgICAgdGhpcy5fcmF3LnNjaGVtZSwKICAgICAgdGhpcy5fcmF3LnVzZXIsCiAgICAgIHRoaXMuX3Jhdy5ob3N0LAogICAgICB0aGlzLl9yYXcucG9ydCwKICAgICAgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnBhcmFtZXRlcnMpKSwKICAgICAgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmhlYWRlcnMpKSk7CiAgfSwKCiAgdG9SYXc6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMuX3RvU3RyaW5nKHRoaXMuX3Jhdyk7CiAgfSwKCiAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMuX3RvU3RyaW5nKHRoaXMuX25vcm1hbCk7CiAgfSwKCiAgX3RvU3RyaW5nOiBmdW5jdGlvbih1cmkpIHsKICAgIHZhciBoZWFkZXIsIHBhcmFtZXRlciwgaWR4LCB1cmlTdHJpbmcsIGhlYWRlcnMgPSBbXTsKCiAgICB1cmlTdHJpbmcgID0gdXJpLnNjaGVtZSArICc6JzsKICAgIC8vIGFkZCBzbGFzaGVzIGlmIGl0J3Mgbm90IGEgc2lwKHMpIFVSSQogICAgaWYgKCF1cmkuc2NoZW1lLnRvTG93ZXJDYXNlKCkubWF0Y2goIl5zaXBzPyQiKSkgewogICAgICB1cmlTdHJpbmcgKz0gIi8vIjsKICAgIH0KICAgIGlmICh1cmkudXNlcikgewogICAgICB1cmlTdHJpbmcgKz0gU0lQLlV0aWxzLmVzY2FwZVVzZXIodXJpLnVzZXIpICsgJ0AnOwogICAgfQogICAgdXJpU3RyaW5nICs9IHVyaS5ob3N0OwogICAgaWYgKHVyaS5wb3J0IHx8IHVyaS5wb3J0ID09PSAwKSB7CiAgICAgIHVyaVN0cmluZyArPSAnOicgKyB1cmkucG9ydDsKICAgIH0KCiAgICBmb3IgKHBhcmFtZXRlciBpbiB0aGlzLnBhcmFtZXRlcnMpIHsKICAgICAgdXJpU3RyaW5nICs9ICc7JyArIHBhcmFtZXRlcjsKCiAgICAgIGlmICh0aGlzLnBhcmFtZXRlcnNbcGFyYW1ldGVyXSAhPT0gbnVsbCkgewogICAgICAgIHVyaVN0cmluZyArPSAnPScrIHRoaXMucGFyYW1ldGVyc1twYXJhbWV0ZXJdOwogICAgICB9CiAgICB9CgogICAgZm9yKGhlYWRlciBpbiB0aGlzLmhlYWRlcnMpIHsKICAgICAgZm9yKGlkeCBpbiB0aGlzLmhlYWRlcnNbaGVhZGVyXSkgewogICAgICAgIGhlYWRlcnMucHVzaChoZWFkZXIgKyAnPScgKyB0aGlzLmhlYWRlcnNbaGVhZGVyXVtpZHhdKTsKICAgICAgfQogICAgfQoKICAgIGlmIChoZWFkZXJzLmxlbmd0aCA+IDApIHsKICAgICAgdXJpU3RyaW5nICs9ICc/JyArIGhlYWRlcnMuam9pbignJicpOwogICAgfQoKICAgIHJldHVybiB1cmlTdHJpbmc7CiAgfQp9OwoKCi8qKgogICogUGFyc2UgdGhlIGdpdmVuIHN0cmluZyBhbmQgcmV0dXJucyBhIFNJUC5VUkkgaW5zdGFuY2Ugb3IgdW5kZWZpbmVkIGlmCiAgKiBpdCBpcyBhbiBpbnZhbGlkIFVSSS4KICAqIEBwdWJsaWMKICAqIEBwYXJhbSB7U3RyaW5nfSB1cmkKICAqLwpVUkkucGFyc2UgPSBmdW5jdGlvbih1cmkpIHsKICB1cmkgPSBTSVAuR3JhbW1hci5wYXJzZSh1cmksJ1NJUF9VUkknKTsKCiAgaWYgKHVyaSAhPT0gLTEpIHsKICAgIHJldHVybiB1cmk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQp9OwoKU0lQLlVSSSA9IFVSSTsKfTsKCn0se31dLDM1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKInVzZSBzdHJpY3QiOwovKioKICogQGZpbGVvdmVydmlldyBVdGlscwogKi8KCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCwgZW52aXJvbm1lbnQpIHsKdmFyIFV0aWxzOwoKVXRpbHM9IHsKCiAgUHJvbWlzZTogZW52aXJvbm1lbnQuUHJvbWlzZSwKCiAgZGVmZXI6IGZ1bmN0aW9uIGRlZmVyICgpIHsKICAgIHZhciBkZWZlcnJlZCA9IHt9OwogICAgZGVmZXJyZWQucHJvbWlzZSA9IG5ldyBVdGlscy5Qcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgZGVmZXJyZWQucmVzb2x2ZSA9IHJlc29sdmU7CiAgICAgIGRlZmVycmVkLnJlamVjdCA9IHJlamVjdDsKICAgIH0pOwogICAgcmV0dXJuIGRlZmVycmVkOwogIH0sCgogIHByb21pc2lmeTogZnVuY3Rpb24gcHJvbWlzaWZ5IChvYmplY3QsIG1ldGhvZE5hbWUsIGNhbGxiYWNrc0ZpcnN0KSB7CiAgICB2YXIgb2xkTWV0aG9kID0gb2JqZWN0W21ldGhvZE5hbWVdOwogICAgcmV0dXJuIGZ1bmN0aW9uIHByb21pc2lmaWVkTWV0aG9kIChhcmcsIG9uU3VjY2Vzcywgb25GYWlsdXJlKSB7CiAgICAgIHJldHVybiBuZXcgVXRpbHMuUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIG9sZEFyZ3MgPSBbYXJnLCByZXNvbHZlLCByZWplY3RdOwogICAgICAgIGlmIChjYWxsYmFja3NGaXJzdCkgewogICAgICAgICAgb2xkQXJncyA9IFtyZXNvbHZlLCByZWplY3QsIGFyZ107CiAgICAgICAgfQogICAgICAgIG9sZE1ldGhvZC5hcHBseShvYmplY3QsIG9sZEFyZ3MpOwogICAgICB9KS50aGVuKG9uU3VjY2Vzcywgb25GYWlsdXJlKTsKICAgIH07CiAgfSwKCiAgYXVnbWVudDogZnVuY3Rpb24gKG9iamVjdCwgY29uc3RydWN0b3IsIGFyZ3MsIG92ZXJyaWRlKSB7CiAgICB2YXIgaWR4LCBwcm90bzsKCiAgICAvLyBBZGQgcHVibGljIHByb3BlcnRpZXMgZnJvbSBjb25zdHJ1Y3RvcidzIHByb3RvdHlwZSBvbnRvIG9iamVjdAogICAgcHJvdG8gPSBjb25zdHJ1Y3Rvci5wcm90b3R5cGU7CiAgICBmb3IgKGlkeCBpbiBwcm90bykgewogICAgICBpZiAob3ZlcnJpZGUgfHwgb2JqZWN0W2lkeF0gPT09IHVuZGVmaW5lZCkgewogICAgICAgIG9iamVjdFtpZHhdID0gcHJvdG9baWR4XTsKICAgICAgfQogICAgfQoKICAgIC8vIENvbnN0cnVjdCB0aGUgb2JqZWN0IGFzIHRob3VnaCBpdCB3ZXJlIGp1c3QgY3JlYXRlZCBieSBjb25zdHJ1Y3RvcgogICAgY29uc3RydWN0b3IuYXBwbHkob2JqZWN0LCBhcmdzKTsKICB9LAoKICBvcHRpb25zT3ZlcnJpZGU6IGZ1bmN0aW9uIChvcHRpb25zLCB3aW5uZXIsIGxvc2VyLCBpc0RlcHJlY2F0ZWQsIGxvZ2dlciwgZGVmYXVsdFZhbHVlKSB7CiAgICBpZiAoaXNEZXByZWNhdGVkICYmIG9wdGlvbnNbbG9zZXJdKSB7CiAgICAgIGxvZ2dlci53YXJuKGxvc2VyICsgJyBpcyBkZXByZWNhdGVkLCBwbGVhc2UgdXNlICcgKyB3aW5uZXIgKyAnIGluc3RlYWQnKTsKICAgIH0KCiAgICBpZiAob3B0aW9uc1t3aW5uZXJdICYmIG9wdGlvbnNbbG9zZXJdKSB7CiAgICAgIGxvZ2dlci53YXJuKHdpbm5lciArICcgb3ZlcnJpZGluZyAnICsgbG9zZXIpOwogICAgfQoKICAgIG9wdGlvbnNbd2lubmVyXSA9IG9wdGlvbnNbd2lubmVyXSB8fCBvcHRpb25zW2xvc2VyXSB8fCBkZWZhdWx0VmFsdWU7CiAgfSwKCiAgc3RyX3V0ZjhfbGVuZ3RoOiBmdW5jdGlvbihzdHJpbmcpIHsKICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5nKS5yZXBsYWNlKC8lW0EtRlxkXXsyfS9nLCAnVScpLmxlbmd0aDsKICB9LAoKICBnZW5lcmF0ZUZha2VTRFA6IGZ1bmN0aW9uKGJvZHkpIHsKICAgIGlmICghYm9keSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIHN0YXJ0ID0gYm9keS5pbmRleE9mKCdvPScpOwogICAgdmFyIGVuZCA9IGJvZHkuaW5kZXhPZignXHJcbicsIHN0YXJ0KTsKCiAgICByZXR1cm4gJ3Y9MFxyXG4nICsgYm9keS5zbGljZShzdGFydCwgZW5kKSArICdcclxucz0tXHJcbnQ9MCAwXHJcbmM9SU4gSVA0IDAuMC4wLjAnOwogIH0sCgogIGlzRnVuY3Rpb246IGZ1bmN0aW9uKGZuKSB7CiAgICBpZiAoZm4gIT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGZuKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJzsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LAoKICBpc0RlY2ltYWw6IGZ1bmN0aW9uIChudW0pIHsKICAgIHJldHVybiAhaXNOYU4obnVtKSAmJiAocGFyc2VGbG9hdChudW0pID09PSBwYXJzZUludChudW0sMTApKTsKICB9LAoKICBjcmVhdGVSYW5kb21Ub2tlbjogZnVuY3Rpb24oc2l6ZSwgYmFzZSkgewogICAgdmFyIGksIHIsCiAgICAgIHRva2VuID0gJyc7CgogICAgYmFzZSA9IGJhc2UgfHwgMzI7CgogICAgZm9yKCBpPTA7IGkgPCBzaXplOyBpKysgKSB7CiAgICAgIHIgPSBNYXRoLnJhbmRvbSgpICogYmFzZXwwOwogICAgICB0b2tlbiArPSByLnRvU3RyaW5nKGJhc2UpOwogICAgfQoKICAgIHJldHVybiB0b2tlbjsKICB9LAoKICBuZXdUYWc6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIFNJUC5VdGlscy5jcmVhdGVSYW5kb21Ub2tlbihTSVAuVUEuQy5UQUdfTEVOR1RIKTsKICB9LAoKICAvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vdXNlcnMvMTA5NTM4L2Jyb29mYQogIG5ld1VVSUQ6IGZ1bmN0aW9uKCkgewogICAgdmFyIFVVSUQgPSAgJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbihjKSB7CiAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKSoxNnwwLCB2ID0gYyA9PT0gJ3gnID8gciA6IChyJjB4M3wweDgpOwogICAgICByZXR1cm4gdi50b1N0cmluZygxNik7CiAgICB9KTsKCiAgICByZXR1cm4gVVVJRDsKICB9LAoKICBob3N0VHlwZTogZnVuY3Rpb24oaG9zdCkgewogICAgaWYgKCFob3N0KSB7CiAgICAgIHJldHVybjsKICAgIH0gZWxzZSB7CiAgICAgIGhvc3QgPSBTSVAuR3JhbW1hci5wYXJzZShob3N0LCdob3N0Jyk7CiAgICAgIGlmIChob3N0ICE9PSAtMSkgewogICAgICAgIHJldHVybiBob3N0Lmhvc3RfdHlwZTsKICAgICAgfQogICAgfQogIH0sCgogIC8qKgogICogTm9ybWFsaXplIFNJUCBVUkkuCiAgKiBOT1RFOiBJdCBkb2VzIG5vdCBhbGxvdyBhIFNJUCBVUkkgd2l0aG91dCB1c2VybmFtZS4KICAqIEFjY2VwdHMgJ3NpcCcsICdzaXBzJyBhbmQgJ3RlbCcgVVJJcyBhbmQgY29udmVydCB0aGVtIGludG8gJ3NpcCcuCiAgKiBEZXRlY3RzIHRoZSBkb21haW4gcGFydCAoaWYgZ2l2ZW4pIGFuZCBwcm9wZXJseSBoZXgtZXNjYXBlcyB0aGUgdXNlciBwb3J0aW9uLgogICogSWYgdGhlIHVzZXIgcG9ydGlvbiBoYXMgb25seSAndGVsJyBudW1iZXIgc3ltYm9scyB0aGUgdXNlciBwb3J0aW9uIGlzIGNsZWFuIG9mICd0ZWwnIHZpc3VhbCBzZXBhcmF0b3JzLgogICogQHByaXZhdGUKICAqIEBwYXJhbSB7U3RyaW5nfSB0YXJnZXQKICAqIEBwYXJhbSB7U3RyaW5nfSBbZG9tYWluXQogICovCiAgbm9ybWFsaXplVGFyZ2V0OiBmdW5jdGlvbih0YXJnZXQsIGRvbWFpbikgewogICAgdmFyIHVyaSwgdGFyZ2V0X2FycmF5LCB0YXJnZXRfdXNlciwgdGFyZ2V0X2RvbWFpbjsKCiAgICAvLyBJZiBubyB0YXJnZXQgaXMgZ2l2ZW4gdGhlbiByYWlzZSBhbiBlcnJvci4KICAgIGlmICghdGFyZ2V0KSB7CiAgICAgIHJldHVybjsKICAgIC8vIElmIGEgU0lQLlVSSSBpbnN0YW5jZSBpcyBnaXZlbiB0aGVuIHJldHVybiBpdC4KICAgIH0gZWxzZSBpZiAodGFyZ2V0IGluc3RhbmNlb2YgU0lQLlVSSSkgewogICAgICByZXR1cm4gdGFyZ2V0OwoKICAgIC8vIElmIGEgc3RyaW5nIGlzIGdpdmVuIHNwbGl0IGl0IGJ5ICdAJzoKICAgIC8vIC0gTGFzdCBmcmFnbWVudCBpcyB0aGUgZGVzaXJlZCBkb21haW4uCiAgICAvLyAtIE90aGVyd2lzZSBhcHBlbmQgdGhlIGdpdmVuIGRvbWFpbiBhcmd1bWVudC4KICAgIH0gZWxzZSBpZiAodHlwZW9mIHRhcmdldCA9PT0gJ3N0cmluZycpIHsKICAgICAgdGFyZ2V0X2FycmF5ID0gdGFyZ2V0LnNwbGl0KCdAJyk7CgogICAgICBzd2l0Y2godGFyZ2V0X2FycmF5Lmxlbmd0aCkgewogICAgICAgIGNhc2UgMToKICAgICAgICAgIGlmICghZG9tYWluKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIHRhcmdldF91c2VyID0gdGFyZ2V0OwogICAgICAgICAgdGFyZ2V0X2RvbWFpbiA9IGRvbWFpbjsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHRhcmdldF91c2VyID0gdGFyZ2V0X2FycmF5WzBdOwogICAgICAgICAgdGFyZ2V0X2RvbWFpbiA9IHRhcmdldF9hcnJheVsxXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0YXJnZXRfdXNlciA9IHRhcmdldF9hcnJheS5zbGljZSgwLCB0YXJnZXRfYXJyYXkubGVuZ3RoLTEpLmpvaW4oJ0AnKTsKICAgICAgICAgIHRhcmdldF9kb21haW4gPSB0YXJnZXRfYXJyYXlbdGFyZ2V0X2FycmF5Lmxlbmd0aC0xXTsKICAgICAgfQoKICAgICAgLy8gUmVtb3ZlIHRoZSBVUkkgc2NoZW1lIChpZiBwcmVzZW50KS4KICAgICAgdGFyZ2V0X3VzZXIgPSB0YXJnZXRfdXNlci5yZXBsYWNlKC9eKHNpcHM/fHRlbCk6L2ksICcnKTsKCiAgICAgIC8vIFJlbW92ZSAndGVsJyB2aXN1YWwgc2VwYXJhdG9ycyBpZiB0aGUgdXNlciBwb3J0aW9uIGp1c3QgY29udGFpbnMgJ3RlbCcgbnVtYmVyIHN5bWJvbHMuCiAgICAgIGlmICgvXltcLVwuXChcKV0qXCs/WzAtOVwtXC5cKFwpXSskLy50ZXN0KHRhcmdldF91c2VyKSkgewogICAgICAgIHRhcmdldF91c2VyID0gdGFyZ2V0X3VzZXIucmVwbGFjZSgvW1wtXC5cKFwpXS9nLCAnJyk7CiAgICAgIH0KCiAgICAgIC8vIEJ1aWxkIHRoZSBjb21wbGV0ZSBTSVAgVVJJLgogICAgICB0YXJnZXQgPSBTSVAuQy5TSVAgKyAnOicgKyBTSVAuVXRpbHMuZXNjYXBlVXNlcih0YXJnZXRfdXNlcikgKyAnQCcgKyB0YXJnZXRfZG9tYWluOwoKICAgICAgLy8gRmluYWxseSBwYXJzZSB0aGUgcmVzdWx0aW5nIFVSSS4KICAgICAgaWYgKHVyaSA9IFNJUC5VUkkucGFyc2UodGFyZ2V0KSkgewogICAgICAgIHJldHVybiB1cmk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICByZXR1cm47CiAgICB9CiAgfSwKCiAgLyoqCiAgKiBIZXgtZXNjYXBlIGEgU0lQIFVSSSB1c2VyLgogICogQHByaXZhdGUKICAqIEBwYXJhbSB7U3RyaW5nfSB1c2VyCiAgKi8KICBlc2NhcGVVc2VyOiBmdW5jdGlvbih1c2VyKSB7CiAgICAvLyBEb24ndCBoZXgtZXNjYXBlICc6JyAoJTNBKSwgJysnICglMkIpLCAnPycgKCUzRiIpLCAnLycgKCUyRikuCiAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGRlY29kZVVSSUNvbXBvbmVudCh1c2VyKSkucmVwbGFjZSgvJTNBL2lnLCAnOicpLnJlcGxhY2UoLyUyQi9pZywgJysnKS5yZXBsYWNlKC8lM0YvaWcsICc/JykucmVwbGFjZSgvJTJGL2lnLCAnLycpOwogIH0sCgogIGhlYWRlcml6ZTogZnVuY3Rpb24oc3RyaW5nKSB7CiAgICB2YXIgZXhjZXB0aW9ucyA9IHsKICAgICAgJ0NhbGwtSWQnOiAnQ2FsbC1JRCcsCiAgICAgICdDc2VxJzogJ0NTZXEnLAogICAgICAnTWluLVNlJzogJ01pbi1TRScsCiAgICAgICdSYWNrJzogJ1JBY2snLAogICAgICAnUnNlcSc6ICdSU2VxJywKICAgICAgJ1d3dy1BdXRoZW50aWNhdGUnOiAnV1dXLUF1dGhlbnRpY2F0ZScKICAgICAgfSwKICAgICAgbmFtZSA9IHN0cmluZy50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL18vZywnLScpLnNwbGl0KCctJyksCiAgICAgIGhuYW1lID0gJycsCiAgICAgIHBhcnRzID0gbmFtZS5sZW5ndGgsIHBhcnQ7CgogICAgZm9yIChwYXJ0ID0gMDsgcGFydCA8IHBhcnRzOyBwYXJ0KyspIHsKICAgICAgaWYgKHBhcnQgIT09IDApIHsKICAgICAgICBobmFtZSArPSctJzsKICAgICAgfQogICAgICBobmFtZSArPSBuYW1lW3BhcnRdLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK25hbWVbcGFydF0uc3Vic3RyaW5nKDEpOwogICAgfQogICAgaWYgKGV4Y2VwdGlvbnNbaG5hbWVdKSB7CiAgICAgIGhuYW1lID0gZXhjZXB0aW9uc1tobmFtZV07CiAgICB9CiAgICByZXR1cm4gaG5hbWU7CiAgfSwKCiAgc2lwRXJyb3JDYXVzZTogZnVuY3Rpb24oc3RhdHVzX2NvZGUpIHsKICAgIHZhciBjYXVzZTsKCiAgICBmb3IgKGNhdXNlIGluIFNJUC5DLlNJUF9FUlJPUl9DQVVTRVMpIHsKICAgICAgaWYgKFNJUC5DLlNJUF9FUlJPUl9DQVVTRVNbY2F1c2VdLmluZGV4T2Yoc3RhdHVzX2NvZGUpICE9PSAtMSkgewogICAgICAgIHJldHVybiBTSVAuQy5jYXVzZXNbY2F1c2VdOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIFNJUC5DLmNhdXNlcy5TSVBfRkFJTFVSRV9DT0RFOwogIH0sCgogIGdldFJlYXNvblBocmFzZTogZnVuY3Rpb24gZ2V0UmVhc29uUGhyYXNlIChjb2RlLCBzcGVjaWZpYykgewogICAgcmV0dXJuIHNwZWNpZmljIHx8IFNJUC5DLlJFQVNPTl9QSFJBU0VbY29kZV0gfHwgJyc7CiAgfSwKCiAgZ2V0UmVhc29uSGVhZGVyVmFsdWU6IGZ1bmN0aW9uIGdldFJlYXNvbkhlYWRlclZhbHVlIChjb2RlLCByZWFzb24pIHsKICAgIHJlYXNvbiA9IFNJUC5VdGlscy5nZXRSZWFzb25QaHJhc2UoY29kZSwgcmVhc29uKTsKICAgIHJldHVybiAnU0lQIDtjYXVzZT0nICsgY29kZSArICcgO3RleHQ9IicgKyByZWFzb24gKyAnIic7CiAgfSwKCiAgZ2V0Q2FuY2VsUmVhc29uOiBmdW5jdGlvbiBnZXRDYW5jZWxSZWFzb24gKGNvZGUsIHJlYXNvbikgewogICAgaWYgKGNvZGUgJiYgY29kZSA8IDIwMCB8fCBjb2RlID4gNjk5KSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgc3RhdHVzX2NvZGU6ICcgKyBjb2RlKTsKICAgIH0gZWxzZSBpZiAoY29kZSkgewogICAgICByZXR1cm4gU0lQLlV0aWxzLmdldFJlYXNvbkhlYWRlclZhbHVlKGNvZGUsIHJlYXNvbik7CiAgICB9CiAgfSwKCiAgYnVpbGRTdGF0dXNMaW5lOiBmdW5jdGlvbiBidWlsZFN0YXR1c0xpbmUgKGNvZGUsIHJlYXNvbikgewogICAgY29kZSA9IGNvZGUgfHwgbnVsbDsKICAgIHJlYXNvbiA9IHJlYXNvbiB8fCBudWxsOwoKICAgIC8vIFZhbGlkYXRlIGNvZGUgYW5kIHJlYXNvbiB2YWx1ZXMKICAgIGlmICghY29kZSB8fCAoY29kZSA8IDEwMCB8fCBjb2RlID4gNjk5KSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHN0YXR1c19jb2RlOiAnKyBjb2RlKTsKICAgIH0gZWxzZSBpZiAocmVhc29uICYmIHR5cGVvZiByZWFzb24gIT09ICdzdHJpbmcnICYmICEocmVhc29uIGluc3RhbmNlb2YgU3RyaW5nKSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHJlYXNvbl9waHJhc2U6ICcrIHJlYXNvbik7CiAgICB9CgogICAgcmVhc29uID0gVXRpbHMuZ2V0UmVhc29uUGhyYXNlKGNvZGUsIHJlYXNvbik7CgogICAgcmV0dXJuICdTSVAvMi4wICcgKyBjb2RlICsgJyAnICsgcmVhc29uICsgJ1xyXG4nOwogIH0sCgogIC8qKgogICogR2VuZXJhdGUgYSByYW5kb20gVGVzdC1OZXQgSVAgKGh0dHA6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzU3MzUpCiAgKiBAcHJpdmF0ZQogICovCiAgZ2V0UmFuZG9tVGVzdE5ldElQOiBmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIGdldE9jdGV0KGZyb20sdG8pIHsKICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoodG8tZnJvbSsxKStmcm9tKTsKICAgIH0KICAgIHJldHVybiAnMTkyLjAuMi4nICsgZ2V0T2N0ZXQoMSwgMjU0KTsKICB9LAoKICAvLyBNRDUgKE1lc3NhZ2UtRGlnZXN0IEFsZ29yaXRobSkgaHR0cDovL3d3dy53ZWJ0b29sa2l0LmluZm8KICBjYWxjdWxhdGVNRDU6IGZ1bmN0aW9uKHN0cmluZykgewogICAgZnVuY3Rpb24gUm90YXRlTGVmdChsVmFsdWUsIGlTaGlmdEJpdHMpIHsKICAgICAgcmV0dXJuIChsVmFsdWU8PGlTaGlmdEJpdHMpIHwgKGxWYWx1ZT4+PigzMi1pU2hpZnRCaXRzKSk7CiAgICB9CgogICAgZnVuY3Rpb24gQWRkVW5zaWduZWQobFgsbFkpIHsKICAgICAgdmFyIGxYNCxsWTQsbFg4LGxZOCxsUmVzdWx0OwogICAgICBsWDggPSAobFggJiAweDgwMDAwMDAwKTsKICAgICAgbFk4ID0gKGxZICYgMHg4MDAwMDAwMCk7CiAgICAgIGxYNCA9IChsWCAmIDB4NDAwMDAwMDApOwogICAgICBsWTQgPSAobFkgJiAweDQwMDAwMDAwKTsKICAgICAgbFJlc3VsdCA9IChsWCAmIDB4M0ZGRkZGRkYpKyhsWSAmIDB4M0ZGRkZGRkYpOwogICAgICBpZiAobFg0ICYgbFk0KSB7CiAgICAgICAgcmV0dXJuIChsUmVzdWx0IF4gMHg4MDAwMDAwMCBeIGxYOCBeIGxZOCk7CiAgICAgIH0KICAgICAgaWYgKGxYNCB8IGxZNCkgewogICAgICAgIGlmIChsUmVzdWx0ICYgMHg0MDAwMDAwMCkgewogICAgICAgICAgcmV0dXJuIChsUmVzdWx0IF4gMHhDMDAwMDAwMCBeIGxYOCBeIGxZOCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiAobFJlc3VsdCBeIDB4NDAwMDAwMDAgXiBsWDggXiBsWTgpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gKGxSZXN1bHQgXiBsWDggXiBsWTgpOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gRih4LHkseikgewogICAgICByZXR1cm4gKHggJiB5KSB8ICgofngpICYgeik7CiAgICB9CgogICAgZnVuY3Rpb24gRyh4LHkseikgewogICAgICByZXR1cm4gKHggJiB6KSB8ICh5ICYgKH56KSk7CiAgICB9CgogICAgZnVuY3Rpb24gSCh4LHkseikgewogICAgICByZXR1cm4gKHggXiB5IF4geik7CiAgICB9CgogICAgZnVuY3Rpb24gSSh4LHkseikgewogICAgICByZXR1cm4gKHkgXiAoeCB8ICh+eikpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBGRihhLGIsYyxkLHgscyxhYykgewogICAgICBhID0gQWRkVW5zaWduZWQoYSwgQWRkVW5zaWduZWQoQWRkVW5zaWduZWQoRihiLCBjLCBkKSwgeCksIGFjKSk7CiAgICAgIHJldHVybiBBZGRVbnNpZ25lZChSb3RhdGVMZWZ0KGEsIHMpLCBiKTsKICAgIH0KCiAgICBmdW5jdGlvbiBHRyhhLGIsYyxkLHgscyxhYykgewogICAgICBhID0gQWRkVW5zaWduZWQoYSwgQWRkVW5zaWduZWQoQWRkVW5zaWduZWQoRyhiLCBjLCBkKSwgeCksIGFjKSk7CiAgICAgIHJldHVybiBBZGRVbnNpZ25lZChSb3RhdGVMZWZ0KGEsIHMpLCBiKTsKICAgIH0KCiAgICBmdW5jdGlvbiBISChhLGIsYyxkLHgscyxhYykgewogICAgICBhID0gQWRkVW5zaWduZWQoYSwgQWRkVW5zaWduZWQoQWRkVW5zaWduZWQoSChiLCBjLCBkKSwgeCksIGFjKSk7CiAgICAgIHJldHVybiBBZGRVbnNpZ25lZChSb3RhdGVMZWZ0KGEsIHMpLCBiKTsKICAgIH0KCiAgICBmdW5jdGlvbiBJSShhLGIsYyxkLHgscyxhYykgewogICAgICBhID0gQWRkVW5zaWduZWQoYSwgQWRkVW5zaWduZWQoQWRkVW5zaWduZWQoSShiLCBjLCBkKSwgeCksIGFjKSk7CiAgICAgIHJldHVybiBBZGRVbnNpZ25lZChSb3RhdGVMZWZ0KGEsIHMpLCBiKTsKICAgIH0KCiAgICBmdW5jdGlvbiBDb252ZXJ0VG9Xb3JkQXJyYXkoc3RyaW5nKSB7CiAgICAgIHZhciBsV29yZENvdW50OwogICAgICB2YXIgbE1lc3NhZ2VMZW5ndGggPSBzdHJpbmcubGVuZ3RoOwogICAgICB2YXIgbE51bWJlck9mV29yZHNfdGVtcDE9bE1lc3NhZ2VMZW5ndGggKyA4OwogICAgICB2YXIgbE51bWJlck9mV29yZHNfdGVtcDI9KGxOdW1iZXJPZldvcmRzX3RlbXAxLShsTnVtYmVyT2ZXb3Jkc190ZW1wMSAlIDY0KSkvNjQ7CiAgICAgIHZhciBsTnVtYmVyT2ZXb3JkcyA9IChsTnVtYmVyT2ZXb3Jkc190ZW1wMisxKSoxNjsKICAgICAgdmFyIGxXb3JkQXJyYXk9QXJyYXkobE51bWJlck9mV29yZHMtMSk7CiAgICAgIHZhciBsQnl0ZVBvc2l0aW9uID0gMDsKICAgICAgdmFyIGxCeXRlQ291bnQgPSAwOwogICAgICB3aGlsZSAoIGxCeXRlQ291bnQgPCBsTWVzc2FnZUxlbmd0aCApIHsKICAgICAgICBsV29yZENvdW50ID0gKGxCeXRlQ291bnQtKGxCeXRlQ291bnQgJSA0KSkvNDsKICAgICAgICBsQnl0ZVBvc2l0aW9uID0gKGxCeXRlQ291bnQgJSA0KSo4OwogICAgICAgIGxXb3JkQXJyYXlbbFdvcmRDb3VudF0gPSAobFdvcmRBcnJheVtsV29yZENvdW50XSB8IChzdHJpbmcuY2hhckNvZGVBdChsQnl0ZUNvdW50KTw8bEJ5dGVQb3NpdGlvbikpOwogICAgICAgIGxCeXRlQ291bnQrKzsKICAgICAgfQogICAgICBsV29yZENvdW50ID0gKGxCeXRlQ291bnQtKGxCeXRlQ291bnQgJSA0KSkvNDsKICAgICAgbEJ5dGVQb3NpdGlvbiA9IChsQnl0ZUNvdW50ICUgNCkqODsKICAgICAgbFdvcmRBcnJheVtsV29yZENvdW50XSA9IGxXb3JkQXJyYXlbbFdvcmRDb3VudF0gfCAoMHg4MDw8bEJ5dGVQb3NpdGlvbik7CiAgICAgIGxXb3JkQXJyYXlbbE51bWJlck9mV29yZHMtMl0gPSBsTWVzc2FnZUxlbmd0aDw8MzsKICAgICAgbFdvcmRBcnJheVtsTnVtYmVyT2ZXb3Jkcy0xXSA9IGxNZXNzYWdlTGVuZ3RoPj4+Mjk7CiAgICAgIHJldHVybiBsV29yZEFycmF5OwogICAgfQoKICAgIGZ1bmN0aW9uIFdvcmRUb0hleChsVmFsdWUpIHsKICAgICAgdmFyIFdvcmRUb0hleFZhbHVlPSIiLFdvcmRUb0hleFZhbHVlX3RlbXA9IiIsbEJ5dGUsbENvdW50OwogICAgICBmb3IgKGxDb3VudCA9IDA7bENvdW50PD0zO2xDb3VudCsrKSB7CiAgICAgICAgbEJ5dGUgPSAobFZhbHVlPj4+KGxDb3VudCo4KSkgJiAyNTU7CiAgICAgICAgV29yZFRvSGV4VmFsdWVfdGVtcCA9ICIwIiArIGxCeXRlLnRvU3RyaW5nKDE2KTsKICAgICAgICBXb3JkVG9IZXhWYWx1ZSA9IFdvcmRUb0hleFZhbHVlICsgV29yZFRvSGV4VmFsdWVfdGVtcC5zdWJzdHIoV29yZFRvSGV4VmFsdWVfdGVtcC5sZW5ndGgtMiwyKTsKICAgICAgfQogICAgICByZXR1cm4gV29yZFRvSGV4VmFsdWU7CiAgICB9CgogICAgZnVuY3Rpb24gVXRmOEVuY29kZShzdHJpbmcpIHsKICAgICAgc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UoL1xyXG4vZywiXG4iKTsKICAgICAgdmFyIHV0ZnRleHQgPSAiIjsKCiAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgc3RyaW5nLmxlbmd0aDsgbisrKSB7CiAgICAgICAgdmFyIGMgPSBzdHJpbmcuY2hhckNvZGVBdChuKTsKCiAgICAgICAgaWYgKGMgPCAxMjgpIHsKICAgICAgICAgIHV0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjKTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZigoYyA+IDEyNykgJiYgKGMgPCAyMDQ4KSkgewogICAgICAgICAgdXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKChjID4+IDYpIHwgMTkyKTsKICAgICAgICAgIHV0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYyAmIDYzKSB8IDEyOCk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgdXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKChjID4+IDEyKSB8IDIyNCk7CiAgICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjID4+IDYpICYgNjMpIHwgMTI4KTsKICAgICAgICAgIHV0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYyAmIDYzKSB8IDEyOCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB1dGZ0ZXh0OwogICAgfQoKICAgIHZhciB4PVtdOwogICAgdmFyIGssQUEsQkIsQ0MsREQsYSxiLGMsZDsKICAgIHZhciBTMTE9NywgUzEyPTEyLCBTMTM9MTcsIFMxND0yMjsKICAgIHZhciBTMjE9NSwgUzIyPTkgLCBTMjM9MTQsIFMyND0yMDsKICAgIHZhciBTMzE9NCwgUzMyPTExLCBTMzM9MTYsIFMzND0yMzsKICAgIHZhciBTNDE9NiwgUzQyPTEwLCBTNDM9MTUsIFM0ND0yMTsKCiAgICBzdHJpbmcgPSBVdGY4RW5jb2RlKHN0cmluZyk7CgogICAgeCA9IENvbnZlcnRUb1dvcmRBcnJheShzdHJpbmcpOwoKICAgIGEgPSAweDY3NDUyMzAxOyBiID0gMHhFRkNEQUI4OTsgYyA9IDB4OThCQURDRkU7IGQgPSAweDEwMzI1NDc2OwoKICAgIGZvciAoaz0wO2s8eC5sZW5ndGg7ays9MTYpIHsKICAgICAgQUE9YTsgQkI9YjsgQ0M9YzsgREQ9ZDsKICAgICAgYT1GRihhLGIsYyxkLHhbayswXSwgUzExLDB4RDc2QUE0NzgpOwogICAgICBkPUZGKGQsYSxiLGMseFtrKzFdLCBTMTIsMHhFOEM3Qjc1Nik7CiAgICAgIGM9RkYoYyxkLGEsYix4W2srMl0sIFMxMywweDI0MjA3MERCKTsKICAgICAgYj1GRihiLGMsZCxhLHhbayszXSwgUzE0LDB4QzFCRENFRUUpOwogICAgICBhPUZGKGEsYixjLGQseFtrKzRdLCBTMTEsMHhGNTdDMEZBRik7CiAgICAgIGQ9RkYoZCxhLGIsYyx4W2srNV0sIFMxMiwweDQ3ODdDNjJBKTsKICAgICAgYz1GRihjLGQsYSxiLHhbays2XSwgUzEzLDB4QTgzMDQ2MTMpOwogICAgICBiPUZGKGIsYyxkLGEseFtrKzddLCBTMTQsMHhGRDQ2OTUwMSk7CiAgICAgIGE9RkYoYSxiLGMsZCx4W2srOF0sIFMxMSwweDY5ODA5OEQ4KTsKICAgICAgZD1GRihkLGEsYixjLHhbays5XSwgUzEyLDB4OEI0NEY3QUYpOwogICAgICBjPUZGKGMsZCxhLGIseFtrKzEwXSxTMTMsMHhGRkZGNUJCMSk7CiAgICAgIGI9RkYoYixjLGQsYSx4W2srMTFdLFMxNCwweDg5NUNEN0JFKTsKICAgICAgYT1GRihhLGIsYyxkLHhbaysxMl0sUzExLDB4NkI5MDExMjIpOwogICAgICBkPUZGKGQsYSxiLGMseFtrKzEzXSxTMTIsMHhGRDk4NzE5Myk7CiAgICAgIGM9RkYoYyxkLGEsYix4W2srMTRdLFMxMywweEE2Nzk0MzhFKTsKICAgICAgYj1GRihiLGMsZCxhLHhbaysxNV0sUzE0LDB4NDlCNDA4MjEpOwogICAgICBhPUdHKGEsYixjLGQseFtrKzFdLCBTMjEsMHhGNjFFMjU2Mik7CiAgICAgIGQ9R0coZCxhLGIsYyx4W2srNl0sIFMyMiwweEMwNDBCMzQwKTsKICAgICAgYz1HRyhjLGQsYSxiLHhbaysxMV0sUzIzLDB4MjY1RTVBNTEpOwogICAgICBiPUdHKGIsYyxkLGEseFtrKzBdLCBTMjQsMHhFOUI2QzdBQSk7CiAgICAgIGE9R0coYSxiLGMsZCx4W2srNV0sIFMyMSwweEQ2MkYxMDVEKTsKICAgICAgZD1HRyhkLGEsYixjLHhbaysxMF0sUzIyLDB4MjQ0MTQ1Myk7CiAgICAgIGM9R0coYyxkLGEsYix4W2srMTVdLFMyMywweEQ4QTFFNjgxKTsKICAgICAgYj1HRyhiLGMsZCxhLHhbays0XSwgUzI0LDB4RTdEM0ZCQzgpOwogICAgICBhPUdHKGEsYixjLGQseFtrKzldLCBTMjEsMHgyMUUxQ0RFNik7CiAgICAgIGQ9R0coZCxhLGIsYyx4W2srMTRdLFMyMiwweEMzMzcwN0Q2KTsKICAgICAgYz1HRyhjLGQsYSxiLHhbayszXSwgUzIzLDB4RjRENTBEODcpOwogICAgICBiPUdHKGIsYyxkLGEseFtrKzhdLCBTMjQsMHg0NTVBMTRFRCk7CiAgICAgIGE9R0coYSxiLGMsZCx4W2srMTNdLFMyMSwweEE5RTNFOTA1KTsKICAgICAgZD1HRyhkLGEsYixjLHhbaysyXSwgUzIyLDB4RkNFRkEzRjgpOwogICAgICBjPUdHKGMsZCxhLGIseFtrKzddLCBTMjMsMHg2NzZGMDJEOSk7CiAgICAgIGI9R0coYixjLGQsYSx4W2srMTJdLFMyNCwweDhEMkE0QzhBKTsKICAgICAgYT1ISChhLGIsYyxkLHhbays1XSwgUzMxLDB4RkZGQTM5NDIpOwogICAgICBkPUhIKGQsYSxiLGMseFtrKzhdLCBTMzIsMHg4NzcxRjY4MSk7CiAgICAgIGM9SEgoYyxkLGEsYix4W2srMTFdLFMzMywweDZEOUQ2MTIyKTsKICAgICAgYj1ISChiLGMsZCxhLHhbaysxNF0sUzM0LDB4RkRFNTM4MEMpOwogICAgICBhPUhIKGEsYixjLGQseFtrKzFdLCBTMzEsMHhBNEJFRUE0NCk7CiAgICAgIGQ9SEgoZCxhLGIsYyx4W2srNF0sIFMzMiwweDRCREVDRkE5KTsKICAgICAgYz1ISChjLGQsYSxiLHhbays3XSwgUzMzLDB4RjZCQjRCNjApOwogICAgICBiPUhIKGIsYyxkLGEseFtrKzEwXSxTMzQsMHhCRUJGQkM3MCk7CiAgICAgIGE9SEgoYSxiLGMsZCx4W2srMTNdLFMzMSwweDI4OUI3RUM2KTsKICAgICAgZD1ISChkLGEsYixjLHhbayswXSwgUzMyLDB4RUFBMTI3RkEpOwogICAgICBjPUhIKGMsZCxhLGIseFtrKzNdLCBTMzMsMHhENEVGMzA4NSk7CiAgICAgIGI9SEgoYixjLGQsYSx4W2srNl0sIFMzNCwweDQ4ODFEMDUpOwogICAgICBhPUhIKGEsYixjLGQseFtrKzldLCBTMzEsMHhEOUQ0RDAzOSk7CiAgICAgIGQ9SEgoZCxhLGIsYyx4W2srMTJdLFMzMiwweEU2REI5OUU1KTsKICAgICAgYz1ISChjLGQsYSxiLHhbaysxNV0sUzMzLDB4MUZBMjdDRjgpOwogICAgICBiPUhIKGIsYyxkLGEseFtrKzJdLCBTMzQsMHhDNEFDNTY2NSk7CiAgICAgIGE9SUkoYSxiLGMsZCx4W2srMF0sIFM0MSwweEY0MjkyMjQ0KTsKICAgICAgZD1JSShkLGEsYixjLHhbays3XSwgUzQyLDB4NDMyQUZGOTcpOwogICAgICBjPUlJKGMsZCxhLGIseFtrKzE0XSxTNDMsMHhBQjk0MjNBNyk7CiAgICAgIGI9SUkoYixjLGQsYSx4W2srNV0sIFM0NCwweEZDOTNBMDM5KTsKICAgICAgYT1JSShhLGIsYyxkLHhbaysxMl0sUzQxLDB4NjU1QjU5QzMpOwogICAgICBkPUlJKGQsYSxiLGMseFtrKzNdLCBTNDIsMHg4RjBDQ0M5Mik7CiAgICAgIGM9SUkoYyxkLGEsYix4W2srMTBdLFM0MywweEZGRUZGNDdEKTsKICAgICAgYj1JSShiLGMsZCxhLHhbaysxXSwgUzQ0LDB4ODU4NDVERDEpOwogICAgICBhPUlJKGEsYixjLGQseFtrKzhdLCBTNDEsMHg2RkE4N0U0Rik7CiAgICAgIGQ9SUkoZCxhLGIsYyx4W2srMTVdLFM0MiwweEZFMkNFNkUwKTsKICAgICAgYz1JSShjLGQsYSxiLHhbays2XSwgUzQzLDB4QTMwMTQzMTQpOwogICAgICBiPUlJKGIsYyxkLGEseFtrKzEzXSxTNDQsMHg0RTA4MTFBMSk7CiAgICAgIGE9SUkoYSxiLGMsZCx4W2srNF0sIFM0MSwweEY3NTM3RTgyKTsKICAgICAgZD1JSShkLGEsYixjLHhbaysxMV0sUzQyLDB4QkQzQUYyMzUpOwogICAgICBjPUlJKGMsZCxhLGIseFtrKzJdLCBTNDMsMHgyQUQ3RDJCQik7CiAgICAgIGI9SUkoYixjLGQsYSx4W2srOV0sIFM0NCwweEVCODZEMzkxKTsKICAgICAgYT1BZGRVbnNpZ25lZChhLEFBKTsKICAgICAgYj1BZGRVbnNpZ25lZChiLEJCKTsKICAgICAgYz1BZGRVbnNpZ25lZChjLENDKTsKICAgICAgZD1BZGRVbnNpZ25lZChkLEREKTsKICAgIH0KCiAgICB2YXIgdGVtcCA9IFdvcmRUb0hleChhKStXb3JkVG9IZXgoYikrV29yZFRvSGV4KGMpK1dvcmRUb0hleChkKTsKCiAgICByZXR1cm4gdGVtcC50b0xvd2VyQ2FzZSgpOwogIH0KfTsKClNJUC5VdGlscyA9IFV0aWxzOwp9OwoKfSx7fV0sMzY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IFdlYlJUQwogKi8KCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCwgZW52aXJvbm1lbnQpIHsKdmFyIFdlYlJUQzsKCldlYlJUQyA9IHt9OwoKV2ViUlRDLk1lZGlhSGFuZGxlciA9IHJlcXVpcmUoJy4vV2ViUlRDL01lZGlhSGFuZGxlcicpKFNJUCk7CldlYlJUQy5NZWRpYVN0cmVhbU1hbmFnZXIgPSByZXF1aXJlKCcuL1dlYlJUQy9NZWRpYVN0cmVhbU1hbmFnZXInKShTSVAsIGVudmlyb25tZW50KTsKCnZhciBfaXNTdXBwb3J0ZWQ7CgpXZWJSVEMuaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CiAgaWYgKF9pc1N1cHBvcnRlZCAhPT0gdW5kZWZpbmVkKSB7CiAgICByZXR1cm4gX2lzU3VwcG9ydGVkOwogIH0KCiAgV2ViUlRDLk1lZGlhU3RyZWFtID0gZW52aXJvbm1lbnQuTWVkaWFTdHJlYW07CiAgV2ViUlRDLmdldFVzZXJNZWRpYSA9IGVudmlyb25tZW50LmdldFVzZXJNZWRpYTsKICBXZWJSVEMuUlRDUGVlckNvbm5lY3Rpb24gPSBlbnZpcm9ubWVudC5SVENQZWVyQ29ubmVjdGlvbjsKICBXZWJSVEMuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uID0gZW52aXJvbm1lbnQuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uOwoKICBpZiAoV2ViUlRDLlJUQ1BlZXJDb25uZWN0aW9uICYmIFdlYlJUQy5SVENTZXNzaW9uRGVzY3JpcHRpb24pIHsKICAgIGlmIChXZWJSVEMuZ2V0VXNlck1lZGlhKSB7CiAgICAgIFdlYlJUQy5nZXRVc2VyTWVkaWEgPSBTSVAuVXRpbHMucHJvbWlzaWZ5KGVudmlyb25tZW50LCAnZ2V0VXNlck1lZGlhJyk7CiAgICB9CiAgICBfaXNTdXBwb3J0ZWQgPSB0cnVlOwogIH0KICBlbHNlIHsKICAgIF9pc1N1cHBvcnRlZCA9IGZhbHNlOwogIH0KICByZXR1cm4gX2lzU3VwcG9ydGVkOwp9OwoKcmV0dXJuIFdlYlJUQzsKfTsKCn0seyIuL1dlYlJUQy9NZWRpYUhhbmRsZXIiOjM3LCIuL1dlYlJUQy9NZWRpYVN0cmVhbU1hbmFnZXIiOjM4fV0sMzc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IE1lZGlhSGFuZGxlcgogKi8KCi8qIE1lZGlhSGFuZGxlcgogKiBAY2xhc3MgUGVlckNvbm5lY3Rpb24gaGVscGVyIENsYXNzLgogKiBAcGFyYW0ge1NJUC5TZXNzaW9ufSBzZXNzaW9uCiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10KICogQHBhcmFtIHtTSVAuV2ViUlRDLk1lZGlhU3RyZWFtTWFuYWdlcn0gW29wdGlvbnMubWVkaWFTdHJlYW1NYW5hZ2VyXQogKiAgICAgICAgVGhlIE1lZGlhU3RyZWFtTWFuYWdlciB0byBhY3F1aXJlL3JlbGVhc2Ugc3RyZWFtcyBmcm9tL3RvLgogKiAgICAgICAgSWYgbm90IHByb3ZpZGVkLCBhIGRlZmF1bHQgTWVkaWFTdHJlYW1NYW5hZ2VyIHdpbGwgYmUgdXNlZC4KICovCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFNJUCkgewoKdmFyIE1lZGlhSGFuZGxlciA9IGZ1bmN0aW9uKHNlc3Npb24sIG9wdGlvbnMpIHsKICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgdGhpcy5sb2dnZXIgPSBzZXNzaW9uLnVhLmdldExvZ2dlcignc2lwLmludml0ZWNvbnRleHQubWVkaWFoYW5kbGVyJywgc2Vzc2lvbi5pZCk7CiAgdGhpcy5zZXNzaW9uID0gc2Vzc2lvbjsKICB0aGlzLmxvY2FsTWVkaWEgPSBudWxsOwogIHRoaXMucmVhZHkgPSB0cnVlOwogIHRoaXMubWVkaWFTdHJlYW1NYW5hZ2VyID0gb3B0aW9ucy5tZWRpYVN0cmVhbU1hbmFnZXIgfHwgbmV3IFNJUC5XZWJSVEMuTWVkaWFTdHJlYW1NYW5hZ2VyKHRoaXMubG9nZ2VyKTsKICB0aGlzLmF1ZGlvTXV0ZWQgPSBmYWxzZTsKICB0aGlzLnZpZGVvTXV0ZWQgPSBmYWxzZTsKCiAgLy8gb2xkIGluaXQoKSBmcm9tIGhlcmUgb24KICB2YXIgc2VydmVycyA9IHRoaXMucHJlcGFyZUljZVNlcnZlcnMob3B0aW9ucy5zdHVuU2VydmVycywgb3B0aW9ucy50dXJuU2VydmVycyk7CiAgdGhpcy5SVENDb25zdHJhaW50cyA9IG9wdGlvbnMuUlRDQ29uc3RyYWludHMgfHwge307CgogIHRoaXMuaW5pdFBlZXJDb25uZWN0aW9uKHNlcnZlcnMsIHRoaXMuUlRDQ29uc3RyYWludHMpOwoKICBmdW5jdGlvbiBzZWxmRW1pdChtaCwgZXZlbnQpIHsKICAgIGlmIChtaC5tZWRpYVN0cmVhbU1hbmFnZXIub24pIHsKICAgICAgbWgubWVkaWFTdHJlYW1NYW5hZ2VyLm9uKGV2ZW50LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgbWguZW1pdC5hcHBseShtaCwgW2V2ZW50XS5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHNlbGZFbWl0KHRoaXMsICd1c2VyTWVkaWFSZXF1ZXN0Jyk7CiAgc2VsZkVtaXQodGhpcywgJ3VzZXJNZWRpYScpOwogIHNlbGZFbWl0KHRoaXMsICd1c2VyTWVkaWFGYWlsZWQnKTsKfTsKCk1lZGlhSGFuZGxlci5kZWZhdWx0RmFjdG9yeSA9IGZ1bmN0aW9uIGRlZmF1bHRGYWN0b3J5IChzZXNzaW9uLCBvcHRpb25zKSB7CiAgcmV0dXJuIG5ldyBNZWRpYUhhbmRsZXIoc2Vzc2lvbiwgb3B0aW9ucyk7Cn07Ck1lZGlhSGFuZGxlci5kZWZhdWx0RmFjdG9yeS5pc1N1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gU0lQLldlYlJUQy5pc1N1cHBvcnRlZCgpOwp9OwoKTWVkaWFIYW5kbGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU0lQLk1lZGlhSGFuZGxlci5wcm90b3R5cGUsIHsKLy8gRnVuY3Rpb25zIHRoZSBzZXNzaW9uIGNhbiB1c2UKICBpc1JlYWR5OiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBpc1JlYWR5ICgpIHsKICAgIHJldHVybiB0aGlzLnJlYWR5OwogIH19LAoKICBjbG9zZToge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gY2xvc2UgKCkgewogICAgdGhpcy5sb2dnZXIubG9nKCdjbG9zaW5nIFBlZXJDb25uZWN0aW9uJyk7CiAgICB0aGlzLl9yZW1vdGVTdHJlYW1zID0gW107CiAgICAvLyBoYXZlIHRvIGNoZWNrIHNpZ25hbGluZ1N0YXRlIHNpbmNlIHRoaXMuY2xvc2UoKSBnZXRzIGNhbGxlZCBtdWx0aXBsZSB0aW1lcwogICAgLy8gVE9ETyBmaWd1cmUgb3V0IHdoeSB0aGF0IGhhcHBlbnMKICAgIGlmKHRoaXMucGVlckNvbm5lY3Rpb24gJiYgdGhpcy5wZWVyQ29ubmVjdGlvbi5zaWduYWxpbmdTdGF0ZSAhPT0gJ2Nsb3NlZCcpIHsKICAgICAgdGhpcy5wZWVyQ29ubmVjdGlvbi5jbG9zZSgpOwoKICAgICAgaWYodGhpcy5sb2NhbE1lZGlhKSB7CiAgICAgICAgdGhpcy5tZWRpYVN0cmVhbU1hbmFnZXIucmVsZWFzZSh0aGlzLmxvY2FsTWVkaWEpOwogICAgICB9CiAgICB9CiAgfX0sCgogIC8qKgogICAqIEBwYXJhbSB7U0lQLldlYlJUQy5NZWRpYVN0cmVhbSB8IChnZXRVc2VyTWVkaWEgY29uc3RyYWludHMpfSBbbWVkaWFIaW50XQogICAqICAgICAgICB0aGUgTWVkaWFTdHJlYW0gKG9yIHRoZSBjb25zdHJhaW50cyBkZXNjcmliaW5nIGl0KSB0byBiZSB1c2VkIGZvciB0aGUgc2Vzc2lvbgogICAqLwogIGdldERlc2NyaXB0aW9uOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBnZXREZXNjcmlwdGlvbiAobWVkaWFIaW50KSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICB2YXIgYWNxdWlyZSA9IHNlbGYubWVkaWFTdHJlYW1NYW5hZ2VyLmFjcXVpcmU7CiAgICBpZiAoYWNxdWlyZS5sZW5ndGggPiAxKSB7CiAgICAgIGFjcXVpcmUgPSBTSVAuVXRpbHMucHJvbWlzaWZ5KHRoaXMubWVkaWFTdHJlYW1NYW5hZ2VyLCAnYWNxdWlyZScsIHRydWUpOwogICAgfQogICAgbWVkaWFIaW50ID0gbWVkaWFIaW50IHx8IHt9OwogICAgaWYgKG1lZGlhSGludC5kYXRhQ2hhbm5lbCA9PT0gdHJ1ZSkgewogICAgICBtZWRpYUhpbnQuZGF0YUNoYW5uZWwgPSB7fTsKICAgIH0KICAgIHRoaXMubWVkaWFIaW50ID0gbWVkaWFIaW50OwoKICAgIC8qCiAgICAgKiAxLiBhY3F1aXJlIHN0cmVhbXMgKHNraXAgaWYgTWVkaWFTdHJlYW1zIHBhc3NlZCBpbikKICAgICAqIDIuIGFkZFN0cmVhbXMKICAgICAqIDMuIGNyZWF0ZU9mZmVyL2NyZWF0ZUFuc3dlcgogICAgICovCgogICAgdmFyIHN0cmVhbVByb21pc2U7CiAgICBpZiAoc2VsZi5sb2NhbE1lZGlhKSB7CiAgICAgIHNlbGYubG9nZ2VyLmxvZygnYWxyZWFkeSBoYXZlIGxvY2FsIG1lZGlhJyk7CiAgICAgIHN0cmVhbVByb21pc2UgPSBTSVAuVXRpbHMuUHJvbWlzZS5yZXNvbHZlKHNlbGYubG9jYWxNZWRpYSk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgc2VsZi5sb2dnZXIubG9nKCdhY3F1aXJpbmcgbG9jYWwgbWVkaWEnKTsKICAgICAgc3RyZWFtUHJvbWlzZSA9IGFjcXVpcmUuY2FsbChzZWxmLm1lZGlhU3RyZWFtTWFuYWdlciwgbWVkaWFIaW50KQogICAgICAgIC50aGVuKGZ1bmN0aW9uIGFjcXVpcmVTdWNjZWVkZWQoc3RyZWFtcykgewogICAgICAgICAgc2VsZi5sb2dnZXIubG9nKCdhY3F1aXJlZCBsb2NhbCBtZWRpYSBzdHJlYW1zJyk7CiAgICAgICAgICBzZWxmLmxvY2FsTWVkaWEgPSBzdHJlYW1zOwogICAgICAgICAgc2VsZi5zZXNzaW9uLmNvbm5lY3RpbmcoKTsKICAgICAgICAgIHJldHVybiBzdHJlYW1zOwogICAgICAgIH0sIGZ1bmN0aW9uIGFjcXVpcmVGYWlsZWQoZXJyKSB7CiAgICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcigndW5hYmxlIHRvIGFjcXVpcmUgc3RyZWFtcycpOwogICAgICAgICAgc2VsZi5sb2dnZXIuZXJyb3IoZXJyKTsKICAgICAgICAgIHNlbGYuc2Vzc2lvbi5jb25uZWN0aW5nKCk7CiAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgfSkKICAgICAgICAudGhlbih0aGlzLmFkZFN0cmVhbXMuYmluZCh0aGlzKSkKICAgICAgOwogICAgfQoKICAgIHJldHVybiBzdHJlYW1Qcm9taXNlCiAgICAgIC50aGVuKGZ1bmN0aW9uIHN0cmVhbUFkZGl0aW9uU3VjY2VlZGVkKCkgewogICAgICAgIGlmIChzZWxmLmhhc09mZmVyKCdyZW1vdGUnKSkgewogICAgICAgICAgc2VsZi5wZWVyQ29ubmVjdGlvbi5vbmRhdGFjaGFubmVsID0gZnVuY3Rpb24gKGV2dCkgewogICAgICAgICAgICBzZWxmLmRhdGFDaGFubmVsID0gZXZ0LmNoYW5uZWw7CiAgICAgICAgICAgIHNlbGYuZW1pdCgnZGF0YUNoYW5uZWwnLCBzZWxmLmRhdGFDaGFubmVsKTsKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIGlmIChtZWRpYUhpbnQuZGF0YUNoYW5uZWwgJiYKICAgICAgICAgICAgICAgICAgIHNlbGYucGVlckNvbm5lY3Rpb24uY3JlYXRlRGF0YUNoYW5uZWwpIHsKICAgICAgICAgIHNlbGYuZGF0YUNoYW5uZWwgPSBzZWxmLnBlZXJDb25uZWN0aW9uLmNyZWF0ZURhdGFDaGFubmVsKAogICAgICAgICAgICAnc2lwanMnLAogICAgICAgICAgICBtZWRpYUhpbnQuZGF0YUNoYW5uZWwKICAgICAgICAgICk7CiAgICAgICAgICBzZWxmLmVtaXQoJ2RhdGFDaGFubmVsJywgc2VsZi5kYXRhQ2hhbm5lbCk7CiAgICAgICAgfQoKICAgICAgICBzZWxmLnJlbmRlcigpOwogICAgICAgIHJldHVybiBzZWxmLmNyZWF0ZU9mZmVyT3JBbnN3ZXIoc2VsZi5SVENDb25zdHJhaW50cyk7CiAgICAgIH0pCiAgICA7CiAgfX0sCgogIC8qKgogICogTWVzc2FnZSByZWNlcHRpb24uCiAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZQogICogQHBhcmFtIHtTdHJpbmd9IHNkcAogICovCiAgc2V0RGVzY3JpcHRpb246IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIHNldERlc2NyaXB0aW9uIChzZHApIHsKICAgIHZhciByYXdEZXNjcmlwdGlvbiA9IHsKICAgICAgdHlwZTogdGhpcy5oYXNPZmZlcignbG9jYWwnKSA/ICdhbnN3ZXInIDogJ29mZmVyJywKICAgICAgc2RwOiBzZHAKICAgIH07CgogICAgdGhpcy5lbWl0KCdzZXREZXNjcmlwdGlvbicsIHJhd0Rlc2NyaXB0aW9uKTsKCiAgICB2YXIgZGVzY3JpcHRpb24gPSBuZXcgU0lQLldlYlJUQy5SVENTZXNzaW9uRGVzY3JpcHRpb24ocmF3RGVzY3JpcHRpb24pOwogICAgcmV0dXJuIFNJUC5VdGlscy5wcm9taXNpZnkodGhpcy5wZWVyQ29ubmVjdGlvbiwgJ3NldFJlbW90ZURlc2NyaXB0aW9uJykoZGVzY3JpcHRpb24pOwogIH19LAoKICAvKioKICAgKiBJZiB0aGUgU2Vzc2lvbiBhc3NvY2lhdGVkIHdpdGggdGhpcyBNZWRpYUhhbmRsZXIgd2VyZSB0byBiZSByZWZlcnJlZCwKICAgKiB3aGF0IG1lZGlhSGludCBzaG91bGQgYmUgcHJvdmlkZWQgdG8gdGhlIFVBJ3MgaW52aXRlIG1ldGhvZD8KICAgKi8KICBnZXRSZWZlck1lZGlhOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBnZXRSZWZlck1lZGlhICgpIHsKICAgIGZ1bmN0aW9uIGhhc1RyYWNrcyAodHJhY2tHZXR0ZXIsIHN0cmVhbSkgewogICAgICByZXR1cm4gc3RyZWFtW3RyYWNrR2V0dGVyXSgpLmxlbmd0aCA+IDA7CiAgICB9CgogICAgZnVuY3Rpb24gYm90aEhhdmVUcmFja3MgKHRyYWNrR2V0dGVyKSB7CiAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqLwogICAgICByZXR1cm4gdGhpcy5nZXRMb2NhbFN0cmVhbXMoKS5zb21lKGhhc1RyYWNrcy5iaW5kKG51bGwsIHRyYWNrR2V0dGVyKSkgJiYKICAgICAgICAgICAgIHRoaXMuZ2V0UmVtb3RlU3RyZWFtcygpLnNvbWUoaGFzVHJhY2tzLmJpbmQobnVsbCwgdHJhY2tHZXR0ZXIpKTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBjb25zdHJhaW50czogewogICAgICAgIGF1ZGlvOiBib3RoSGF2ZVRyYWNrcy5jYWxsKHRoaXMsICdnZXRBdWRpb1RyYWNrcycpLAogICAgICAgIHZpZGVvOiBib3RoSGF2ZVRyYWNrcy5jYWxsKHRoaXMsICdnZXRWaWRlb1RyYWNrcycpCiAgICAgIH0KICAgIH07CiAgfX0sCgogIHVwZGF0ZUljZVNlcnZlcnM6IHt3cml0ZWFibGU6dHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICB2YXIgc2VydmVycyA9IHRoaXMucHJlcGFyZUljZVNlcnZlcnMob3B0aW9ucy5zdHVuU2VydmVycywgb3B0aW9ucy50dXJuU2VydmVycyk7CiAgICB0aGlzLlJUQ0NvbnN0cmFpbnRzID0gb3B0aW9ucy5SVENDb25zdHJhaW50cyB8fCB0aGlzLlJUQ0NvbnN0cmFpbnRzOwoKICAgIHRoaXMuaW5pdFBlZXJDb25uZWN0aW9uKHNlcnZlcnMsIHRoaXMuUlRDQ29uc3RyYWludHMpOwoKICAgIC8qIG9uY2UgdXBkYXRlSWNlIGlzIGltcGxlbWVudGVkIGNvcnJlY3RseSwgdGhpcyBpcyBiZXR0ZXIgdGhhbiBhYm92ZQogICAgLy9ubyBvcCBpZiBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgdGhpcwogICAgaWYgKCF0aGlzLnBlZXJDb25uZWN0aW9uLnVwZGF0ZUljZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5wZWVyQ29ubmVjdGlvbi51cGRhdGVJY2UoeydpY2VTZXJ2ZXJzJzogc2VydmVyc30sIHRoaXMuUlRDQ29uc3RyYWludHMpOwogICAgKi8KICB9fSwKCi8vIEZ1bmN0aW9ucyB0aGUgc2Vzc2lvbiBjYW4gdXNlLCBidXQgb25seSBiZWNhdXNlIGl0J3MgY29udmVuaWVudCBmb3IgdGhlIGFwcGxpY2F0aW9uCiAgaXNNdXRlZDoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gaXNNdXRlZCAoKSB7CiAgICByZXR1cm4gewogICAgICBhdWRpbzogdGhpcy5hdWRpb011dGVkLAogICAgICB2aWRlbzogdGhpcy52aWRlb011dGVkCiAgICB9OwogIH19LAoKICBtdXRlOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBtdXRlIChvcHRpb25zKSB7CiAgICBpZiAodGhpcy5nZXRMb2NhbFN0cmVhbXMoKS5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHsKICAgICAgYXVkaW86IHRoaXMuZ2V0TG9jYWxTdHJlYW1zKClbMF0uZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGggPiAwLAogICAgICB2aWRlbzogdGhpcy5nZXRMb2NhbFN0cmVhbXMoKVswXS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCA+IDAKICAgIH07CgogICAgdmFyIGF1ZGlvTXV0ZWQgPSBmYWxzZSwKICAgICAgICB2aWRlb011dGVkID0gZmFsc2U7CgogICAgaWYgKG9wdGlvbnMuYXVkaW8gJiYgIXRoaXMuYXVkaW9NdXRlZCkgewogICAgICBhdWRpb011dGVkID0gdHJ1ZTsKICAgICAgdGhpcy5hdWRpb011dGVkID0gdHJ1ZTsKICAgICAgdGhpcy50b2dnbGVNdXRlQXVkaW8odHJ1ZSk7CiAgICB9CgogICAgaWYgKG9wdGlvbnMudmlkZW8gJiYgIXRoaXMudmlkZW9NdXRlZCkgewogICAgICB2aWRlb011dGVkID0gdHJ1ZTsKICAgICAgdGhpcy52aWRlb011dGVkID0gdHJ1ZTsKICAgICAgdGhpcy50b2dnbGVNdXRlVmlkZW8odHJ1ZSk7CiAgICB9CgogICAgLy9SRVZJU0lUCiAgICBpZiAoYXVkaW9NdXRlZCB8fCB2aWRlb011dGVkKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgYXVkaW86IGF1ZGlvTXV0ZWQsCiAgICAgICAgdmlkZW86IHZpZGVvTXV0ZWQKICAgICAgfTsKICAgICAgLyp0aGlzLnNlc3Npb24ub25tdXRlKHsKICAgICAgICBhdWRpbzogYXVkaW9NdXRlZCwKICAgICAgICB2aWRlbzogdmlkZW9NdXRlZAogICAgICB9KTsqLwogICAgfQogIH19LAoKICB1bm11dGU6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIHVubXV0ZSAob3B0aW9ucykgewogICAgaWYgKHRoaXMuZ2V0TG9jYWxTdHJlYW1zKCkubGVuZ3RoID09PSAwKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7CiAgICAgIGF1ZGlvOiB0aGlzLmdldExvY2FsU3RyZWFtcygpWzBdLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoID4gMCwKICAgICAgdmlkZW86IHRoaXMuZ2V0TG9jYWxTdHJlYW1zKClbMF0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGggPiAwCiAgICB9OwoKICAgIHZhciBhdWRpb1VuTXV0ZWQgPSBmYWxzZSwKICAgICAgICB2aWRlb1VuTXV0ZWQgPSBmYWxzZTsKCiAgICBpZiAob3B0aW9ucy5hdWRpbyAmJiB0aGlzLmF1ZGlvTXV0ZWQpIHsKICAgICAgYXVkaW9Vbk11dGVkID0gdHJ1ZTsKICAgICAgdGhpcy5hdWRpb011dGVkID0gZmFsc2U7CiAgICAgIHRoaXMudG9nZ2xlTXV0ZUF1ZGlvKGZhbHNlKTsKICAgIH0KCiAgICBpZiAob3B0aW9ucy52aWRlbyAmJiB0aGlzLnZpZGVvTXV0ZWQpIHsKICAgICAgdmlkZW9Vbk11dGVkID0gdHJ1ZTsKICAgICAgdGhpcy52aWRlb011dGVkID0gZmFsc2U7CiAgICAgIHRoaXMudG9nZ2xlTXV0ZVZpZGVvKGZhbHNlKTsKICAgIH0KCiAgICAvL1JFVklTSVQKICAgIGlmIChhdWRpb1VuTXV0ZWQgfHwgdmlkZW9Vbk11dGVkKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgYXVkaW86IGF1ZGlvVW5NdXRlZCwKICAgICAgICB2aWRlbzogdmlkZW9Vbk11dGVkCiAgICAgIH07CiAgICAgIC8qdGhpcy5zZXNzaW9uLm9udW5tdXRlKHsKICAgICAgICBhdWRpbzogYXVkaW9Vbk11dGVkLAogICAgICAgIHZpZGVvOiB2aWRlb1VuTXV0ZWQKICAgICAgfSk7Ki8KICAgIH0KICB9fSwKCiAgaG9sZDoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gaG9sZCAoKSB7CiAgICB0aGlzLnRvZ2dsZU11dGVBdWRpbyh0cnVlKTsKICAgIHRoaXMudG9nZ2xlTXV0ZVZpZGVvKHRydWUpOwogIH19LAoKICB1bmhvbGQ6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIHVuaG9sZCAoKSB7CiAgICBpZiAoIXRoaXMuYXVkaW9NdXRlZCkgewogICAgICB0aGlzLnRvZ2dsZU11dGVBdWRpbyhmYWxzZSk7CiAgICB9CgogICAgaWYgKCF0aGlzLnZpZGVvTXV0ZWQpIHsKICAgICAgdGhpcy50b2dnbGVNdXRlVmlkZW8oZmFsc2UpOwogICAgfQogIH19LAoKLy8gRnVuY3Rpb25zIHRoZSBhcHBsaWNhdGlvbiBjYW4gdXNlLCBidXQgbm90IHRoZSBzZXNzaW9uCiAgZ2V0TG9jYWxTdHJlYW1zOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBnZXRMb2NhbFN0cmVhbXMgKCkgewogICAgdmFyIHBjID0gdGhpcy5wZWVyQ29ubmVjdGlvbjsKICAgIGlmIChwYyAmJiBwYy5zaWduYWxpbmdTdGF0ZSA9PT0gJ2Nsb3NlZCcpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybigncGVlckNvbm5lY3Rpb24gaXMgY2xvc2VkLCBnZXRMb2NhbFN0cmVhbXMgcmV0dXJuaW5nIFtdJyk7CiAgICAgIHJldHVybiBbXTsKICAgIH0KICAgIHJldHVybiAocGMuZ2V0TG9jYWxTdHJlYW1zICYmIHBjLmdldExvY2FsU3RyZWFtcygpKSB8fAogICAgICBwYy5sb2NhbFN0cmVhbXMgfHwgW107CiAgfX0sCgogIGdldFJlbW90ZVN0cmVhbXM6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGdldFJlbW90ZVN0cmVhbXMgKCkgewogICAgdmFyIHBjID0gdGhpcy5wZWVyQ29ubmVjdGlvbjsKICAgIGlmIChwYyAmJiBwYy5zaWduYWxpbmdTdGF0ZSA9PT0gJ2Nsb3NlZCcpIHsKICAgICAgdGhpcy5sb2dnZXIud2FybigncGVlckNvbm5lY3Rpb24gaXMgY2xvc2VkLCBnZXRSZW1vdGVTdHJlYW1zIHJldHVybmluZyB0aGlzLl9yZW1vdGVTdHJlYW1zJyk7CiAgICAgIHJldHVybiB0aGlzLl9yZW1vdGVTdHJlYW1zOwogICAgfQogICAgcmV0dXJuKHBjLmdldFJlbW90ZVN0cmVhbXMgJiYgcGMuZ2V0UmVtb3RlU3RyZWFtcygpKSB8fAogICAgICBwYy5yZW1vdGVTdHJlYW1zIHx8IFtdOwogIH19LAoKICByZW5kZXI6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlciAocmVuZGVySGludCkgewogICAgcmVuZGVySGludCA9IHJlbmRlckhpbnQgfHwgKHRoaXMubWVkaWFIaW50ICYmIHRoaXMubWVkaWFIaW50LnJlbmRlcik7CiAgICBpZiAoIXJlbmRlckhpbnQpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgdmFyIHN0cmVhbUdldHRlcnMgPSB7CiAgICAgIGxvY2FsOiAnZ2V0TG9jYWxTdHJlYW1zJywKICAgICAgcmVtb3RlOiAnZ2V0UmVtb3RlU3RyZWFtcycKICAgIH07CiAgICBPYmplY3Qua2V5cyhzdHJlYW1HZXR0ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChsb2MpIHsKICAgICAgdmFyIHN0cmVhbUdldHRlciA9IHN0cmVhbUdldHRlcnNbbG9jXTsKICAgICAgdmFyIHN0cmVhbXMgPSB0aGlzW3N0cmVhbUdldHRlcl0oKTsKICAgICAgU0lQLldlYlJUQy5NZWRpYVN0cmVhbU1hbmFnZXIucmVuZGVyKHN0cmVhbXMsIHJlbmRlckhpbnRbbG9jXSk7CiAgICB9LmJpbmQodGhpcykpOwogIH19LAoKLy8gSW50ZXJuYWwgZnVuY3Rpb25zCiAgaGFzT2ZmZXI6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIGhhc09mZmVyICh3aGVyZSkgewogICAgdmFyIG9mZmVyU3RhdGUgPSAnaGF2ZS0nICsgd2hlcmUgKyAnLW9mZmVyJzsKICAgIHJldHVybiB0aGlzLnBlZXJDb25uZWN0aW9uLnNpZ25hbGluZ1N0YXRlID09PSBvZmZlclN0YXRlOwogICAgLy8gVE9ETyBjb25zaWRlciBzaWduYWxpbmdTdGF0ZXMgd2l0aCAncHJhbnN3ZXInPwogIH19LAoKICBwcmVwYXJlSWNlU2VydmVyczoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gcHJlcGFyZUljZVNlcnZlcnMgKHN0dW5TZXJ2ZXJzLCB0dXJuU2VydmVycykgewogICAgdmFyIHNlcnZlcnMgPSBbXSwKICAgICAgY29uZmlnID0gdGhpcy5zZXNzaW9uLnVhLmNvbmZpZ3VyYXRpb247CgogICAgc3R1blNlcnZlcnMgPSBzdHVuU2VydmVycyB8fCBjb25maWcuc3R1blNlcnZlcnM7CiAgICB0dXJuU2VydmVycyA9IHR1cm5TZXJ2ZXJzIHx8IGNvbmZpZy50dXJuU2VydmVyczsKCiAgICBbXS5jb25jYXQoc3R1blNlcnZlcnMpLmZvckVhY2goZnVuY3Rpb24gKHNlcnZlcikgewogICAgICBzZXJ2ZXJzLnB1c2goeyd1cmxzJzogc2VydmVyfSk7CiAgICB9KTsKCiAgICBbXS5jb25jYXQodHVyblNlcnZlcnMpLmZvckVhY2goZnVuY3Rpb24gKHNlcnZlcikgewogICAgICBzZXJ2ZXJzLnB1c2goewogICAgICAgICd1cmxzJzogc2VydmVyLnVybHMsCiAgICAgICAgJ3VzZXJuYW1lJzogc2VydmVyLnVzZXJuYW1lLAogICAgICAgICdjcmVkZW50aWFsJzogc2VydmVyLnBhc3N3b3JkCiAgICAgIH0pOwogICAgfSk7CgogICAgcmV0dXJuIHNlcnZlcnM7CiAgfX0sCgogIGluaXRQZWVyQ29ubmVjdGlvbjoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gaW5pdFBlZXJDb25uZWN0aW9uKHNlcnZlcnMsIFJUQ0NvbnN0cmFpbnRzKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsCiAgICAgIGNvbmZpZyA9IHRoaXMuc2Vzc2lvbi51YS5jb25maWd1cmF0aW9uOwoKICAgIHRoaXMub25JY2VDb21wbGV0ZWQgPSBTSVAuVXRpbHMuZGVmZXIoKTsKICAgIHRoaXMub25JY2VDb21wbGV0ZWQucHJvbWlzZS50aGVuKGZ1bmN0aW9uKHBjKSB7CiAgICAgIHNlbGYuZW1pdCgnaWNlR2F0aGVyaW5nQ29tcGxldGUnLCBwYyk7CiAgICAgIGlmIChzZWxmLmljZUNoZWNraW5nVGltZXIpIHsKICAgICAgICBTSVAuVGltZXJzLmNsZWFyVGltZW91dChzZWxmLmljZUNoZWNraW5nVGltZXIpOwogICAgICAgIHNlbGYuaWNlQ2hlY2tpbmdUaW1lciA9IG51bGw7CiAgICAgIH0KICAgIH0pOwoKICAgIGlmICh0aGlzLnBlZXJDb25uZWN0aW9uKSB7CiAgICAgIHRoaXMucGVlckNvbm5lY3Rpb24uY2xvc2UoKTsKICAgIH0KCiAgICB0aGlzLnBlZXJDb25uZWN0aW9uID0gbmV3IFNJUC5XZWJSVEMuUlRDUGVlckNvbm5lY3Rpb24oeydpY2VTZXJ2ZXJzJzogc2VydmVyc30sIFJUQ0NvbnN0cmFpbnRzKTsKCiAgICAvLyBGaXJlZm94ICgzNS4wLjEpIHNvbWV0aW1lcyB0aHJvd3Mgb24gY2FsbHMgdG8gcGVlckNvbm5lY3Rpb24uZ2V0UmVtb3RlU3RyZWFtcwogICAgLy8gZXZlbiBpZiBwZWVyQ29ubmVjdGlvbi5vbmFkZHN0cmVhbSB3YXMganVzdCBjYWxsZWQuIEluIG9yZGVyIHRvIG1ha2UKICAgIC8vIE1lZGlhSGFuZGxlci5wcm90b3R5cGUuZ2V0UmVtb3RlU3RyZWFtcyB3b3JrLCBrZWVwIHRyYWNrIG9mIHRoZW0gbWFudWFsbHkKICAgIHRoaXMuX3JlbW90ZVN0cmVhbXMgPSBbXTsKCiAgICB0aGlzLnBlZXJDb25uZWN0aW9uLm9uYWRkc3RyZWFtID0gZnVuY3Rpb24oZSkgewogICAgICBzZWxmLmxvZ2dlci5sb2coJ3N0cmVhbSBhZGRlZDogJysgZS5zdHJlYW0uaWQpOwogICAgICBzZWxmLl9yZW1vdGVTdHJlYW1zLnB1c2goZS5zdHJlYW0pOwogICAgICBzZWxmLnJlbmRlcigpOwogICAgICBzZWxmLmVtaXQoJ2FkZFN0cmVhbScsIGUpOwogICAgfTsKCiAgICB0aGlzLnBlZXJDb25uZWN0aW9uLm9ucmVtb3Zlc3RyZWFtID0gZnVuY3Rpb24oZSkgewogICAgICBzZWxmLmxvZ2dlci5sb2coJ3N0cmVhbSByZW1vdmVkOiAnKyBlLnN0cmVhbS5pZCk7CiAgICB9OwoKICAgIHRoaXMuc3RhcnRJY2VDaGVja2luZ1RpbWVyID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoIXNlbGYuaWNlQ2hlY2tpbmdUaW1lcikgewogICAgICAgIHNlbGYuaWNlQ2hlY2tpbmdUaW1lciA9IFNJUC5UaW1lcnMuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgIHNlbGYubG9nZ2VyLmxvZygnUlRDSWNlQ2hlY2tpbmcgVGltZW91dCBUcmlnZ2VyZWQgYWZ0ZXIgJytjb25maWcuaWNlQ2hlY2tpbmdUaW1lb3V0KycgbWlsbGlzZWNvbmRzJyk7CiAgICAgICAgICBzZWxmLm9uSWNlQ29tcGxldGVkLnJlc29sdmUodGhpcyk7CiAgICAgICAgfS5iaW5kKHRoaXMucGVlckNvbm5lY3Rpb24pLCBjb25maWcuaWNlQ2hlY2tpbmdUaW1lb3V0KTsKICAgICAgfQogICAgfTsKCiAgICB0aGlzLnBlZXJDb25uZWN0aW9uLm9uaWNlY2FuZGlkYXRlID0gZnVuY3Rpb24oZSkgewogICAgICBzZWxmLmVtaXQoJ2ljZUNhbmRpZGF0ZScsIGUpOwogICAgICBpZiAoZS5jYW5kaWRhdGUpIHsKICAgICAgICBzZWxmLmxvZ2dlci5sb2coJ0lDRSBjYW5kaWRhdGUgcmVjZWl2ZWQ6ICcrIChlLmNhbmRpZGF0ZS5jYW5kaWRhdGUgPT09IG51bGwgPyBudWxsIDogZS5jYW5kaWRhdGUuY2FuZGlkYXRlLnRyaW0oKSkpOwogICAgICAgIHNlbGYuc3RhcnRJY2VDaGVja2luZ1RpbWVyKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2VsZi5vbkljZUNvbXBsZXRlZC5yZXNvbHZlKHRoaXMpOwogICAgICB9CiAgICB9OwoKICAgIHRoaXMucGVlckNvbm5lY3Rpb24ub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgc2VsZi5sb2dnZXIubG9nKCdSVENJY2VHYXRoZXJpbmdTdGF0ZSBjaGFuZ2VkOiAnICsgdGhpcy5pY2VHYXRoZXJpbmdTdGF0ZSk7CiAgICAgIGlmICh0aGlzLmljZUdhdGhlcmluZ1N0YXRlID09PSAnZ2F0aGVyaW5nJykgewogICAgICAgIHNlbGYuZW1pdCgnaWNlR2F0aGVyaW5nJywgdGhpcyk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaWNlR2F0aGVyaW5nU3RhdGUgPT09ICdjb21wbGV0ZScpIHsKICAgICAgICBzZWxmLm9uSWNlQ29tcGxldGVkLnJlc29sdmUodGhpcyk7CiAgICAgIH0KICAgIH07CgogICAgdGhpcy5wZWVyQ29ubmVjdGlvbi5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgeyAgLy9uZWVkIGUgZm9yIGNvbW1lbnRlZCBvdXQgY2FzZQogICAgICB2YXIgc3RhdGVFdmVudDsKCiAgICAgIGlmICh0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSA9PT0gJ2NoZWNraW5nJykgewogICAgICAgIHNlbGYuc3RhcnRJY2VDaGVja2luZ1RpbWVyKCk7CiAgICAgIH0KCiAgICAgIHN3aXRjaCAodGhpcy5pY2VDb25uZWN0aW9uU3RhdGUpIHsKICAgICAgY2FzZSAnbmV3JzoKICAgICAgICBzdGF0ZUV2ZW50ID0gJ2ljZUNvbm5lY3Rpb24nOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdjaGVja2luZyc6CiAgICAgICAgc3RhdGVFdmVudCA9ICdpY2VDb25uZWN0aW9uQ2hlY2tpbmcnOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdjb25uZWN0ZWQnOgogICAgICAgIHN0YXRlRXZlbnQgPSAnaWNlQ29ubmVjdGlvbkNvbm5lY3RlZCc7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2NvbXBsZXRlZCc6CiAgICAgICAgc3RhdGVFdmVudCA9ICdpY2VDb25uZWN0aW9uQ29tcGxldGVkJzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAnZmFpbGVkJzoKICAgICAgICBzdGF0ZUV2ZW50ID0gJ2ljZUNvbm5lY3Rpb25GYWlsZWQnOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdkaXNjb25uZWN0ZWQnOgogICAgICAgIHN0YXRlRXZlbnQgPSAnaWNlQ29ubmVjdGlvbkRpc2Nvbm5lY3RlZCc7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ2Nsb3NlZCc6CiAgICAgICAgc3RhdGVFdmVudCA9ICdpY2VDb25uZWN0aW9uQ2xvc2VkJzsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICBzZWxmLmxvZ2dlci53YXJuKCdVbmtub3duIGljZUNvbm5lY3Rpb24gc3RhdGU6JywgdGhpcy5pY2VDb25uZWN0aW9uU3RhdGUpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBzZWxmLmVtaXQoc3RhdGVFdmVudCwgdGhpcyk7CgogICAgICAvL0JyaWEgc3RhdGUgY2hhbmdlcyBhcmUgYWx3YXlzIGNvbm5lY3RlZCAtPiBkaXNjb25uZWN0ZWQgLT4gY29ubmVjdGVkIG9uIGFjY2VwdCwgc28gc2Vzc2lvbiBnZXRzIHRlcm1pbmF0ZWQKICAgICAgLy9ub3JtYWwgY2FsbHMgc3dpdGNoIGZyb20gZmFpbGVkIHRvIGNvbm5lY3RlZCBpbiBzb21lIGNhc2VzLCBzbyBjaGVja2luZyBmb3IgZmFpbGVkIGFuZCB0ZXJtaW5hdGVkCiAgICAgIC8qaWYgKHRoaXMuaWNlQ29ubmVjdGlvblN0YXRlID09PSAnZmFpbGVkJykgewogICAgICAgIHNlbGYuc2Vzc2lvbi50ZXJtaW5hdGUoewogICAgICAgIGNhdXNlOiBTSVAuQy5jYXVzZXMuUlRQX1RJTUVPVVQsCiAgICAgICAgc3RhdHVzX2NvZGU6IDIwMCwKICAgICAgICByZWFzb25fcGhyYXNlOiBTSVAuQy5jYXVzZXMuUlRQX1RJTUVPVVQKICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdXJyZW50VGFyZ2V0LmljZUdhdGhlcmluZ1N0YXRlID09PSAnY29tcGxldGUnICYmIHRoaXMuaWNlQ29ubmVjdGlvblN0YXRlICE9PSAnY2xvc2VkJykgewogICAgICBzZWxmLm9uSWNlQ29tcGxldGVkKHRoaXMpOwogICAgICB9Ki8KICAgIH07CgogICAgdGhpcy5wZWVyQ29ubmVjdGlvbi5vbnN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgIHNlbGYubG9nZ2VyLmxvZygnUGVlckNvbm5lY3Rpb24gc3RhdGUgY2hhbmdlZCB0byAiJysgdGhpcy5yZWFkeVN0YXRlICsnIicpOwogICAgfTsKICB9fSwKCiAgY3JlYXRlT2ZmZXJPckFuc3dlcjoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlT2ZmZXJPckFuc3dlciAoY29uc3RyYWludHMpIHsKICAgIHZhciBzZWxmID0gdGhpczsKICAgIHZhciBtZXRob2ROYW1lOwogICAgdmFyIHBjID0gc2VsZi5wZWVyQ29ubmVjdGlvbjsKCiAgICBzZWxmLnJlYWR5ID0gZmFsc2U7CiAgICBtZXRob2ROYW1lID0gc2VsZi5oYXNPZmZlcigncmVtb3RlJykgPyAnY3JlYXRlQW5zd2VyJyA6ICdjcmVhdGVPZmZlcic7CgogICAgcmV0dXJuIFNJUC5VdGlscy5wcm9taXNpZnkocGMsIG1ldGhvZE5hbWUsIHRydWUpKGNvbnN0cmFpbnRzKQogICAgICAudGhlbihTSVAuVXRpbHMucHJvbWlzaWZ5KHBjLCAnc2V0TG9jYWxEZXNjcmlwdGlvbicpKQogICAgICAudGhlbihmdW5jdGlvbiBvblNldExvY2FsRGVzY3JpcHRpb25TdWNjZXNzKCkgewogICAgICAgIHZhciBkZWZlcnJlZCA9IFNJUC5VdGlscy5kZWZlcigpOwogICAgICAgIGlmIChwYy5pY2VHYXRoZXJpbmdTdGF0ZSA9PT0gJ2NvbXBsZXRlJyAmJiAocGMuaWNlQ29ubmVjdGlvblN0YXRlID09PSAnY29ubmVjdGVkJyB8fCBwYy5pY2VDb25uZWN0aW9uU3RhdGUgPT09ICdjb21wbGV0ZWQnKSkgewogICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWxmLm9uSWNlQ29tcGxldGVkLnByb21pc2UudGhlbihkZWZlcnJlZC5yZXNvbHZlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7CiAgICAgIH0pCiAgICAgIC50aGVuKGZ1bmN0aW9uIHJlYWR5U3VjY2VzcyAoKSB7CiAgICAgICAgdmFyIHNkcCA9IHBjLmxvY2FsRGVzY3JpcHRpb24uc2RwOwoKICAgICAgICBzZHAgPSBTSVAuSGFja3MuQ2hyb21lLm5lZWRzRXhwbGljaXRseUluYWN0aXZlU0RQKHNkcCk7CiAgICAgICAgc2RwID0gU0lQLkhhY2tzLkFsbEJyb3dzZXJzLnVubWFza0R0bHMoc2RwKTsKCiAgICAgICAgdmFyIHNkcFdyYXBwZXIgPSB7CiAgICAgICAgICB0eXBlOiBtZXRob2ROYW1lID09PSAnY3JlYXRlT2ZmZXInID8gJ29mZmVyJyA6ICdhbnN3ZXInLAogICAgICAgICAgc2RwOiBzZHAKICAgICAgICB9OwoKICAgICAgICBzZWxmLmVtaXQoJ2dldERlc2NyaXB0aW9uJywgc2RwV3JhcHBlcik7CgogICAgICAgIHNlbGYucmVhZHkgPSB0cnVlOwogICAgICAgIHJldHVybiBzZHBXcmFwcGVyLnNkcDsKICAgICAgfSkKICAgICAgLmNhdGNoKGZ1bmN0aW9uIG1ldGhvZEZhaWxlZCAoZSkgewogICAgICAgIHNlbGYubG9nZ2VyLmVycm9yKGUpOwogICAgICAgIHNlbGYucmVhZHkgPSB0cnVlOwogICAgICAgIHRocm93IG5ldyBTSVAuRXhjZXB0aW9ucy5HZXREZXNjcmlwdGlvbkVycm9yKGUpOwogICAgICB9KQogICAgOwogIH19LAoKICBhZGRTdHJlYW1zOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiBhZGRTdHJlYW1zIChzdHJlYW1zKSB7CiAgICB0cnkgewogICAgICBzdHJlYW1zID0gW10uY29uY2F0KHN0cmVhbXMpOwogICAgICBzdHJlYW1zLmZvckVhY2goZnVuY3Rpb24gKHN0cmVhbSkgewogICAgICAgIHRoaXMucGVlckNvbm5lY3Rpb24uYWRkU3RyZWFtKHN0cmVhbSk7CiAgICAgIH0sIHRoaXMpOwogICAgfSBjYXRjaChlKSB7CiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKCdlcnJvciBhZGRpbmcgc3RyZWFtJyk7CiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKGUpOwogICAgICByZXR1cm4gU0lQLlV0aWxzLlByb21pc2UucmVqZWN0KGUpOwogICAgfQoKICAgIHJldHVybiBTSVAuVXRpbHMuUHJvbWlzZS5yZXNvbHZlKCk7CiAgfX0sCgogIHRvZ2dsZU11dGVIZWxwZXI6IHt3cml0YWJsZTogdHJ1ZSwgdmFsdWU6IGZ1bmN0aW9uIHRvZ2dsZU11dGVIZWxwZXIgKHRyYWNrR2V0dGVyLCBtdXRlKSB7CiAgICB0aGlzLmdldExvY2FsU3RyZWFtcygpLmZvckVhY2goZnVuY3Rpb24gKHN0cmVhbSkgewogICAgICBzdHJlYW1bdHJhY2tHZXR0ZXJdKCkuZm9yRWFjaChmdW5jdGlvbiAodHJhY2spIHsKICAgICAgICB0cmFjay5lbmFibGVkID0gIW11dGU7CiAgICAgIH0pOwogICAgfSk7CiAgfX0sCgogIHRvZ2dsZU11dGVBdWRpbzoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gdG9nZ2xlTXV0ZUF1ZGlvIChtdXRlKSB7CiAgICB0aGlzLnRvZ2dsZU11dGVIZWxwZXIoJ2dldEF1ZGlvVHJhY2tzJywgbXV0ZSk7CiAgfX0sCgogIHRvZ2dsZU11dGVWaWRlbzoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gdG9nZ2xlTXV0ZVZpZGVvIChtdXRlKSB7CiAgICB0aGlzLnRvZ2dsZU11dGVIZWxwZXIoJ2dldFZpZGVvVHJhY2tzJywgbXV0ZSk7CiAgfX0KfSk7CgovLyBSZXR1cm4gc2luY2UgaXQgd2lsbCBiZSBhc3NpZ25lZCB0byBhIHZhcmlhYmxlLgpyZXR1cm4gTWVkaWFIYW5kbGVyOwp9OwoKfSx7fV0sMzg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Ci8qKgogKiBAZmlsZW92ZXJ2aWV3IE1lZGlhU3RyZWFtTWFuYWdlcgogKi8KCi8qIE1lZGlhU3RyZWFtTWFuYWdlcgogKiBAY2xhc3MgTWFuYWdlcyB0aGUgYWNxdWlzaXRpb24gYW5kIHJlbGVhc2Ugb2YgTWVkaWFTdHJlYW1zLgogKiBAcGFyYW0ge21lZGlhSGludH0gW2RlZmF1bHRNZWRpYUhpbnRdIFRoZSBtZWRpYUhpbnQgdG8gdXNlIGlmIG5vbmUgaXMgcHJvdmlkZWQgdG8gYWNxdWlyZSgpCiAqLwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChTSVAsIGVudmlyb25tZW50KSB7CgovLyBEZWZhdWx0IE1lZGlhU3RyZWFtTWFuYWdlciBwcm92aWRlcyBzaW5nbGUtdXNlIHN0cmVhbXMgY3JlYXRlZCB3aXRoIGdldFVzZXJNZWRpYQp2YXIgTWVkaWFTdHJlYW1NYW5hZ2VyID0gZnVuY3Rpb24gTWVkaWFTdHJlYW1NYW5hZ2VyIChsb2dnZXIsIGRlZmF1bHRNZWRpYUhpbnQpIHsKICBpZiAoIVNJUC5XZWJSVEMuaXNTdXBwb3J0ZWQoKSkgewogICAgdGhyb3cgbmV3IFNJUC5FeGNlcHRpb25zLk5vdFN1cHBvcnRlZEVycm9yKCdNZWRpYSBub3Qgc3VwcG9ydGVkJyk7CiAgfQoKICB0aGlzLm1lZGlhSGludCA9IGRlZmF1bHRNZWRpYUhpbnQgfHwgewogICAgY29uc3RyYWludHM6IHthdWRpbzogdHJ1ZSwgdmlkZW86IHRydWV9CiAgfTsKCiAgLy8gbWFwIG9mIHN0cmVhbXMgdG8gYWNxdWlzaXRpb24gbWFubmVyOgogIC8vIHRydWUgLT4gcGFzc2VkIGluIGFzIG1lZGlhSGludC5zdHJlYW0KICAvLyBmYWxzZSAtPiBnZXRVc2VyTWVkaWEKICB0aGlzLmFjcXVpc2l0aW9ucyA9IHt9Owp9OwpNZWRpYVN0cmVhbU1hbmFnZXIuc3RyZWFtSWQgPSBmdW5jdGlvbiAoc3RyZWFtKSB7CiAgcmV0dXJuIHN0cmVhbS5nZXRBdWRpb1RyYWNrcygpLmNvbmNhdChzdHJlYW0uZ2V0VmlkZW9UcmFja3MoKSkKICAgIC5tYXAoZnVuY3Rpb24gdHJhY2tJZCAodHJhY2spIHsKICAgICAgcmV0dXJuIHRyYWNrLmlkOwogICAgfSkKICAgIC5qb2luKCcnKTsKfTsKCi8qKgogKiBAcGFyYW0geyhBcnJheSBvZikgTWVkaWFTdHJlYW19IHN0cmVhbXMgLSBUaGUgc3RyZWFtcyB0byByZW5kZXIKICoKICogQHBhcmFtIHsoQXJyYXkgb2YpIEhUTUxNZWRpYUVsZW1lbnR9IGVsZW1lbnRzCiAqICAgICAgICAtIFRoZSA8YXVkaW8+Lzx2aWRlbz4gZWxlbWVudChzKSB0aGF0IHNob3VsZCByZW5kZXIgdGhlIHN0cmVhbXMKICoKICogRWFjaCBzdHJlYW0gaW4gc3RyZWFtcyByZW5kZXJzIHRvIHRoZSBjb3JyZXNwb25kaW5nIGVsZW1lbnQgaW4gZWxlbWVudHMsCiAqIHdyYXBwaW5nIGFyb3VuZCBlbGVtZW50cyBpZiBuZWVkZWQuCiAqLwpNZWRpYVN0cmVhbU1hbmFnZXIucmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyIChzdHJlYW1zLCBlbGVtZW50cykgewogIGlmICghZWxlbWVudHMpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgaWYgKEFycmF5LmlzQXJyYXkoZWxlbWVudHMpICYmICFlbGVtZW50cy5sZW5ndGgpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2VsZW1lbnRzIG11c3Qgbm90IGJlIGVtcHR5Jyk7CiAgfQoKICBmdW5jdGlvbiBhdHRhY2hNZWRpYVN0cmVhbShlbGVtZW50LCBzdHJlYW0pIHsKICAgIGlmICh0eXBlb2YgZWxlbWVudC5zcmMgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgIGVudmlyb25tZW50LnJldm9rZU9iamVjdFVSTChlbGVtZW50LnNyYyk7CiAgICAgIGVsZW1lbnQuc3JjID0gZW52aXJvbm1lbnQuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7CiAgICB9IGVsc2UgaWYgKHR5cGVvZiAoZWxlbWVudC5zcmNPYmplY3QgfHwgZWxlbWVudC5tb3pTcmNPYmplY3QpICE9PSAndW5kZWZpbmVkJykgewogICAgICBlbGVtZW50LnNyY09iamVjdCA9IGVsZW1lbnQubW96U3JjT2JqZWN0ID0gc3RyZWFtOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gZW5zdXJlTWVkaWFQbGF5aW5nIChtZWRpYUVsZW1lbnQpIHsKICAgIHZhciBpbnRlcnZhbCA9IDEwMDsKICAgIG1lZGlhRWxlbWVudC5lbnN1cmVQbGF5aW5nSW50ZXJ2YWxJZCA9IFNJUC5UaW1lcnMuc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICBpZiAobWVkaWFFbGVtZW50LnBhdXNlZCkgewogICAgICAgIG1lZGlhRWxlbWVudC5wbGF5KCk7CiAgICAgIH0KICAgICAgZWxzZSB7CiAgICAgICAgU0lQLlRpbWVycy5jbGVhckludGVydmFsKG1lZGlhRWxlbWVudC5lbnN1cmVQbGF5aW5nSW50ZXJ2YWxJZCk7CiAgICAgIH0KICAgIH0sIGludGVydmFsKTsKICB9CgogIGZ1bmN0aW9uIGF0dGFjaEFuZFBsYXkgKGVsZW1lbnRzLCBzdHJlYW0sIGluZGV4KSB7CiAgICBpZiAodHlwZW9mIGVsZW1lbnRzID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIGVsZW1lbnRzID0gZWxlbWVudHMoKTsKICAgIH0KICAgIHZhciBlbGVtZW50ID0gZWxlbWVudHNbaW5kZXggJSBlbGVtZW50cy5sZW5ndGhdOwogICAgKGVudmlyb25tZW50LmF0dGFjaE1lZGlhU3RyZWFtIHx8IGF0dGFjaE1lZGlhU3RyZWFtKShlbGVtZW50LCBzdHJlYW0pOwogICAgZW5zdXJlTWVkaWFQbGF5aW5nKGVsZW1lbnQpOwogIH0KCiAgLy8gW10uY29uY2F0ICJjYXN0cyIgYGVsZW1lbnRzYCBpbnRvIGFuIGFycmF5CiAgLy8gc28gZm9yRWFjaCB3b3JrcyBldmVuIGlmIGBlbGVtZW50c2Agd2FzIGEgc2luZ2xlIGVsZW1lbnQKICBlbGVtZW50cyA9IFtdLmNvbmNhdChlbGVtZW50cyk7CiAgW10uY29uY2F0KHN0cmVhbXMpLmZvckVhY2goYXR0YWNoQW5kUGxheS5iaW5kKG51bGwsIGVsZW1lbnRzKSk7Cn07CgpNZWRpYVN0cmVhbU1hbmFnZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShTSVAuRXZlbnRFbWl0dGVyLnByb3RvdHlwZSwgewogICdhY3F1aXJlJzoge3dyaXRhYmxlOiB0cnVlLCB2YWx1ZTogZnVuY3Rpb24gYWNxdWlyZSAobWVkaWFIaW50KSB7CiAgICBtZWRpYUhpbnQgPSBPYmplY3Qua2V5cyhtZWRpYUhpbnQgfHwge30pLmxlbmd0aCA/IG1lZGlhSGludCA6IHRoaXMubWVkaWFIaW50OwoKICAgIHZhciBzYXZlU3VjY2VzcyA9IGZ1bmN0aW9uIChpc0hpbnRTdHJlYW0sIHN0cmVhbXMpIHsKICAgICAgc3RyZWFtcyA9IFtdLmNvbmNhdChzdHJlYW1zKTsKICAgICAgc3RyZWFtcy5mb3JFYWNoKGZ1bmN0aW9uIChzdHJlYW0pIHsKICAgICAgICB2YXIgc3RyZWFtSWQgPSBNZWRpYVN0cmVhbU1hbmFnZXIuc3RyZWFtSWQoc3RyZWFtKTsKICAgICAgICB0aGlzLmFjcXVpc2l0aW9uc1tzdHJlYW1JZF0gPSAhIWlzSGludFN0cmVhbTsKICAgICAgfSwgdGhpcyk7CiAgICAgIHJldHVybiBTSVAuVXRpbHMuUHJvbWlzZS5yZXNvbHZlKHN0cmVhbXMpOwogICAgfS5iaW5kKHRoaXMpOwoKICAgIGlmIChtZWRpYUhpbnQuc3RyZWFtKSB7CiAgICAgIHJldHVybiBzYXZlU3VjY2Vzcyh0cnVlLCBtZWRpYUhpbnQuc3RyZWFtKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIEZhbGxiYWNrIHRvIGF1ZGlvL3ZpZGVvIGVuYWJsZWQgaWYgbm8gbWVkaWFIaW50IGNhbiBiZSBmb3VuZC4KICAgICAgdmFyIGNvbnN0cmFpbnRzID0gbWVkaWFIaW50LmNvbnN0cmFpbnRzIHx8CiAgICAgICAgKHRoaXMubWVkaWFIaW50ICYmIHRoaXMubWVkaWFIaW50LmNvbnN0cmFpbnRzKSB8fAogICAgICAgIHthdWRpbzogdHJ1ZSwgdmlkZW86IHRydWV9OwoKICAgICAgdmFyIGRlZmVycmVkID0gU0lQLlV0aWxzLmRlZmVyKCk7CgogICAgICAvKgogICAgICAgKiBNYWtlIHRoZSBjYWxsIGFzeW5jaHJvbm91cywgc28gdGhhdCBJQ0NzIGhhdmUgYSBjaGFuY2UKICAgICAgICogdG8gZGVmaW5lIGNhbGxiYWNrcyB0byBgdXNlck1lZGlhUmVxdWVzdGAKICAgICAgICovCiAgICAgIFNJUC5UaW1lcnMuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy5lbWl0KCd1c2VyTWVkaWFSZXF1ZXN0JywgY29uc3RyYWludHMpOwoKICAgICAgICB2YXIgZW1pdFRoZW5DYWxsID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgY2FsbGJhY2spIHsKICAgICAgICAgIHZhciBjYWxsYmFja0FyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpOwogICAgICAgICAgLy8gRW1pdCB3aXRoIGFsbCBvZiB0aGUgYXJndW1lbnRzIGZyb20gdGhlIHJlYWwgY2FsbGJhY2suCiAgICAgICAgICB2YXIgbmV3QXJncyA9IFtldmVudE5hbWVdLmNvbmNhdChjYWxsYmFja0FyZ3MpOwoKICAgICAgICAgIHRoaXMuZW1pdC5hcHBseSh0aGlzLCBuZXdBcmdzKTsKCiAgICAgICAgICByZXR1cm4gY2FsbGJhY2suYXBwbHkobnVsbCwgY2FsbGJhY2tBcmdzKTsKICAgICAgICB9LmJpbmQodGhpcyk7CgogICAgICAgIGlmIChjb25zdHJhaW50cy5hdWRpbyB8fCBjb25zdHJhaW50cy52aWRlbykgewogICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgKICAgICAgICAgICAgU0lQLldlYlJUQy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpCiAgICAgICAgICAgIC50aGVuKAogICAgICAgICAgICAgIGVtaXRUaGVuQ2FsbC5iaW5kKHRoaXMsICd1c2VyTWVkaWEnLCBzYXZlU3VjY2Vzcy5iaW5kKG51bGwsIGZhbHNlKSksCiAgICAgICAgICAgICAgZW1pdFRoZW5DYWxsLmJpbmQodGhpcywgJ3VzZXJNZWRpYUZhaWxlZCcsIGZ1bmN0aW9uKGUpe3Rocm93IGU7fSkKICAgICAgICAgICAgKQogICAgICAgICAgKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gTG9jYWwgc3RyZWFtcyB3ZXJlIGV4cGxpY2l0bHkgZXhjbHVkZWQuCiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKFtdKTsKICAgICAgICB9CiAgICAgIH0uYmluZCh0aGlzKSwgMCk7CgogICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTsKICAgIH0KICB9fSwKCiAgJ3JlbGVhc2UnOiB7d3JpdGFibGU6IHRydWUsIHZhbHVlOiBmdW5jdGlvbiByZWxlYXNlIChzdHJlYW1zKSB7CiAgICBzdHJlYW1zID0gW10uY29uY2F0KHN0cmVhbXMpOwogICAgc3RyZWFtcy5mb3JFYWNoKGZ1bmN0aW9uIChzdHJlYW0pIHsKICAgICAgdmFyIHN0cmVhbUlkID0gTWVkaWFTdHJlYW1NYW5hZ2VyLnN0cmVhbUlkKHN0cmVhbSk7CiAgICAgIGlmICh0aGlzLmFjcXVpc2l0aW9uc1tzdHJlYW1JZF0gPT09IGZhbHNlKSB7CiAgICAgICAgc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24gKHRyYWNrKSB7CiAgICAgICAgICB0cmFjay5zdG9wKCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgZGVsZXRlIHRoaXMuYWNxdWlzaXRpb25zW3N0cmVhbUlkXTsKICAgIH0sIHRoaXMpOwogIH19LAp9KTsKCi8vIFJldHVybiBzaW5jZSBpdCB3aWxsIGJlIGFzc2lnbmVkIHRvIGEgdmFyaWFibGUuCnJldHVybiBNZWRpYVN0cmVhbU1hbmFnZXI7Cn07Cgp9LHt9XSwzOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7CihmdW5jdGlvbiAoZ2xvYmFsKXsKInVzZSBzdHJpY3QiOwoKdmFyIHRvcGxldmVsID0gZ2xvYmFsLndpbmRvdyB8fCBnbG9iYWw7CgpmdW5jdGlvbiBnZXRQcmVmaXhlZFByb3BlcnR5IChvYmplY3QsIG5hbWUpIHsKICBpZiAob2JqZWN0ID09IG51bGwpIHsKICAgIHJldHVybjsKICB9CiAgdmFyIGNhcGl0YWxpemVkTmFtZSA9IG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpOwogIHZhciBwcmVmaXhlZE5hbWVzID0gW25hbWUsICd3ZWJraXQnICsgY2FwaXRhbGl6ZWROYW1lLCAnbW96JyArIGNhcGl0YWxpemVkTmFtZV07CiAgZm9yICh2YXIgaSBpbiBwcmVmaXhlZE5hbWVzKSB7CiAgICB2YXIgcHJvcGVydHkgPSBvYmplY3RbcHJlZml4ZWROYW1lc1tpXV07CiAgICBpZiAocHJvcGVydHkpIHsKICAgICAgcmV0dXJuIHByb3BlcnR5LmJpbmQob2JqZWN0KTsKICAgIH0KICB9Cn0KCm1vZHVsZS5leHBvcnRzID0gewogIFdlYlNvY2tldDogdG9wbGV2ZWwuV2ViU29ja2V0LAogIFRyYW5zcG9ydDogcmVxdWlyZSgnLi9UcmFuc3BvcnQnKSwKICBvcGVuOiB0b3BsZXZlbC5vcGVuLAogIFByb21pc2U6IHRvcGxldmVsLlByb21pc2UsCiAgdGltZXJzOiB0b3BsZXZlbCwKCiAgLy8gQ29uc29sZSBpcyBub3QgZGVmaW5lZCBpbiBFQ01BU2NyaXB0LCBzbyBqdXN0IGluIGNhc2UuLi4KICBjb25zb2xlOiB0b3BsZXZlbC5jb25zb2xlIHx8IHsKICAgIGRlYnVnOiBmdW5jdGlvbiAoKSB7fSwKICAgIGxvZzogZnVuY3Rpb24gKCkge30sCiAgICB3YXJuOiBmdW5jdGlvbiAoKSB7fSwKICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7fQogIH0sCgogIE1lZGlhU3RyZWFtOiBnZXRQcmVmaXhlZFByb3BlcnR5KHRvcGxldmVsLCAnTWVkaWFTdHJlYW0nKSwKICBnZXRVc2VyTWVkaWE6IGdldFByZWZpeGVkUHJvcGVydHkodG9wbGV2ZWwubmF2aWdhdG9yLCAnZ2V0VXNlck1lZGlhJyksCiAgUlRDUGVlckNvbm5lY3Rpb246IGdldFByZWZpeGVkUHJvcGVydHkodG9wbGV2ZWwsICdSVENQZWVyQ29ubmVjdGlvbicpLAogIFJUQ1Nlc3Npb25EZXNjcmlwdGlvbjogZ2V0UHJlZml4ZWRQcm9wZXJ0eSh0b3BsZXZlbCwgJ1JUQ1Nlc3Npb25EZXNjcmlwdGlvbicpLAoKICBhZGRFdmVudExpc3RlbmVyOiBnZXRQcmVmaXhlZFByb3BlcnR5KHRvcGxldmVsLCAnYWRkRXZlbnRMaXN0ZW5lcicpLAogIEhUTUxNZWRpYUVsZW1lbnQ6IHRvcGxldmVsLkhUTUxNZWRpYUVsZW1lbnQsCgogIGF0dGFjaE1lZGlhU3RyZWFtOiB0b3BsZXZlbC5hdHRhY2hNZWRpYVN0cmVhbSwKICBjcmVhdGVPYmplY3RVUkw6IHRvcGxldmVsLlVSTCAmJiB0b3BsZXZlbC5VUkwuY3JlYXRlT2JqZWN0VVJMLAogIHJldm9rZU9iamVjdFVSTDogdG9wbGV2ZWwuVVJMICYmIHRvcGxldmVsLlVSTC5yZXZva2VPYmplY3RVUkwKfTsKCn0pLmNhbGwodGhpcyx0eXBlb2YgZ2xvYmFsICE9PSAidW5kZWZpbmVkIiA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSAidW5kZWZpbmVkIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSAidW5kZWZpbmVkIiA/IHdpbmRvdyA6IHt9KQp9LHsiLi9UcmFuc3BvcnQiOjMyfV0sNDA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewoidXNlIHN0cmljdCI7Cm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9TSVAnKShyZXF1aXJlKCcuL2Vudmlyb25tZW50JykpOwoKfSx7Ii4vU0lQIjoyMywiLi9lbnZpcm9ubWVudCI6Mzl9XSw0MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7Cid1c2Ugc3RyaWN0JzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICAgIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFBUIElub3Zhw6fDo28gZSBTaXN0ZW1hcyBTQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlEDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0ENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqLwoKCnZhciBfc2lwID0gcmVxdWlyZSgnc2lwLmpzJyk7Cgp2YXIgX3NpcDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zaXApOwoKdmFyIF9zZHBUcmFuc2Zvcm0gPSByZXF1aXJlKCdzZHAtdHJhbnNmb3JtJyk7Cgp2YXIgX3NkcFRyYW5zZm9ybTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZHBUcmFuc2Zvcm0pOwoKdmFyIF9JbnZpdGVDbGllbnRDb250ZXh0ID0gcmVxdWlyZSgnLi9JbnZpdGVDbGllbnRDb250ZXh0Jyk7Cgp2YXIgX0ludml0ZUNsaWVudENvbnRleHQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfSW52aXRlQ2xpZW50Q29udGV4dCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9Cgp2YXIgYWRkQ2FuZGlkYXRlc1RvU0RQID0gZnVuY3Rpb24gYWRkQ2FuZGlkYXRlc1RvU0RQKHR4dFNkcCwgY2FuZGlkYXRlcykgewogICAgdmFyIHNkcCA9IF9zZHBUcmFuc2Zvcm0yLmRlZmF1bHQucGFyc2UodHh0U2RwKTsKICAgIHNkcC5tZWRpYVswXS5jYW5kaWRhdGVzID0gW107CiAgICBpZiAoc2RwLm1lZGlhLmxlbmd0aCA+IDEpIHNkcC5tZWRpYVsxXS5jYW5kaWRhdGVzID0gW107CiAgICBjYW5kaWRhdGVzLmZvckVhY2goZnVuY3Rpb24gKGNhbmRpZGF0ZSkgewogICAgICAgIHZhciBwYXJ0cyA9IGNhbmRpZGF0ZS5jYW5kaWRhdGUuc3Vic3RyaW5nKDEwKS5zcGxpdCgnICcpOwogICAgICAgIHZhciBjID0gewogICAgICAgICAgICBmb3VuZGF0aW9uOiBwYXJ0c1swXSwKICAgICAgICAgICAgY29tcG9uZW50OiBwYXJ0c1sxXSwKICAgICAgICAgICAgdHJhbnNwb3J0OiBwYXJ0c1syXS50b0xvd2VyQ2FzZSgpLAogICAgICAgICAgICBwcmlvcml0eTogcGFydHNbM10sCiAgICAgICAgICAgIGlwOiBwYXJ0c1s0XSwKICAgICAgICAgICAgcG9ydDogcGFydHNbNV0sCiAgICAgICAgICAgIHR5cGU6IHBhcnRzWzddLAogICAgICAgICAgICBnZW5lcmF0aW9uOiAnMCcKICAgICAgICB9OwogICAgICAgIGZvciAodmFyIGkgPSA4OyBpIDwgcGFydHMubGVuZ3RoOyBpICs9IDIpIHsKICAgICAgICAgICAgaWYgKHBhcnRzW2ldID09PSAncmFkZHInKSB7CiAgICAgICAgICAgICAgICBjLnJhZGRyID0gcGFydHNbaSArIDFdOwogICAgICAgICAgICB9IGVsc2UgaWYgKHBhcnRzW2ldID09PSAncnBvcnQnKSB7CiAgICAgICAgICAgICAgICBjLnJwb3J0ID0gcGFydHNbaSArIDFdOwogICAgICAgICAgICB9IGVsc2UgaWYgKHBhcnRzW2ldID09PSAnZ2VuZXJhdGlvbicpIHsKICAgICAgICAgICAgICAgIGMuZ2VuZXJhdGlvbiA9IHBhcnRzW2kgKyAxXTsKICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJ0c1tpXSA9PT0gJ3RjcHR5cGUnKSB7CiAgICAgICAgICAgICAgICBjLnRjcHR5cGUgPSBwYXJ0c1tpICsgMV07CiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFydHNbaV0gPT09ICduZXR3b3JrLWlkJykgewogICAgICAgICAgICAgICAgY1snbmV0d29yay1pZCddID0gcGFydHNbaSArIDFdOwogICAgICAgICAgICB9IGVsc2UgaWYgKHBhcnRzW2ldID09PSAnbmV0d29yay1jb3N0JykgewogICAgICAgICAgICAgICAgY1snbmV0d29yay1jb3N0J10gPSBwYXJ0c1tpICsgMV07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2RwLm1lZGlhLmZpbHRlcihmdW5jdGlvbiAobSkgewogICAgICAgICAgICByZXR1cm4gbS50eXBlID09PSBjYW5kaWRhdGUuc2RwTWlkOwogICAgICAgIH0pWzBdLmNhbmRpZGF0ZXMucHVzaChjKTsKICAgIH0pOwoKICAgIHJldHVybiBfc2RwVHJhbnNmb3JtMi5kZWZhdWx0LndyaXRlKHNkcCk7Cn07Cgp2YXIgQ29ubmVjdGlvbkNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBDb25uZWN0aW9uQ29udHJvbGxlcihjb25maWd1cmF0aW9uKSB7CiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbm5lY3Rpb25Db250cm9sbGVyKTsKCiAgICAgICAgaWYgKCFjb25maWd1cmF0aW9uKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWd1cmF0aW9uIGlzIGEgbmVlZGVkIHBhcmFtZXRlcicpOwoKICAgICAgICB0aGlzLmNvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uOwogICAgfQoKICAgIF9jcmVhdGVDbGFzcyhDb25uZWN0aW9uQ29udHJvbGxlciwgW3sKICAgICAgICBrZXk6ICdjb25uZWN0JywKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29ubmVjdChhY2Nlc3NUb2tlbikgewogICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgICAgICAgIGlmIChfdGhpcy51c2VyQWdlbnQpIHJldHVybiByZXNvbHZlKCk7CgogICAgICAgICAgICAgICAgZmV0Y2goX3RoaXMuY29uZmlndXJhdGlvbi5jcmVkZW50aWFsX3NlcnZlciwgeyBtZXRob2Q6ICdHRVQnLCBoZWFkZXJzOiB7ICdBdXRob3JpemF0aW9uJzogJ0JlYXJlcjogJyArIGFjY2Vzc1Rva2VuIH0gfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzLmpzb24oKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnVzZXJBZ2VudCA9IG5ldyBfc2lwMi5kZWZhdWx0LlVBKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVyaTogdXNlci51c2VybmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdzU2VydmVyczogdXNlci51cmlzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHVzZXIucGFzc3dvcmQKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9LCB7CiAgICAgICAga2V5OiAnaW52aXRlJywKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW52aXRlKHRvLCBkYXRhT2JqZWN0T2JzZXJ2ZXIpIHsKICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgICAgICAgICAgICBzZHA6IGFkZENhbmRpZGF0ZXNUb1NEUChkYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YS5jb25uZWN0aW9uRGVzY3JpcHRpb24uc2RwLCBkYXRhT2JqZWN0T2JzZXJ2ZXIuZGF0YS5pY2VDYW5kaWRhdGVzKQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBuZXcgX0ludml0ZUNsaWVudENvbnRleHQyLmRlZmF1bHQodGhpcy51c2VyQWdlbnQsIHRvLnJlcGxhY2UoJy8vJywgJycpLCBvcHRpb25zKTsKICAgICAgICAgICAgdGhpcy51c2VyQWdlbnQuYWZ0ZXJDb25uZWN0ZWQoY29udGV4dC5pbnZpdGUuYmluZChjb250ZXh0KSk7CiAgICAgICAgICAgIHJldHVybiBjb250ZXh0OwogICAgICAgIH0KICAgIH1dKTsKCiAgICByZXR1cm4gQ29ubmVjdGlvbkNvbnRyb2xsZXI7Cn0oKTsKCmV4cG9ydHMuZGVmYXVsdCA9IENvbm5lY3Rpb25Db250cm9sbGVyOwptb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsKCn0seyIuL0ludml0ZUNsaWVudENvbnRleHQiOjQzLCJzZHAtdHJhbnNmb3JtIjoyLCJzaXAuanMiOjQwfV0sNDI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpewondXNlIHN0cmljdCc7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgICB2YWx1ZTogdHJ1ZQp9KTsKCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOwoKZXhwb3J0cy5kZWZhdWx0ID0gYWN0aXZhdGU7Cgp2YXIgX1N5bmNoZXIgPSByZXF1aXJlKCdzZXJ2aWNlLWZyYW1ld29yay9kaXN0L1N5bmNoZXInKTsKCnZhciBfQ29ubmVjdGlvbkNvbnRyb2xsZXIgPSByZXF1aXJlKCcuL0Nvbm5lY3Rpb25Db250cm9sbGVyJyk7Cgp2YXIgX0Nvbm5lY3Rpb25Db250cm9sbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0Nvbm5lY3Rpb25Db250cm9sbGVyKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0gLyoqDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHDp8OjbyBlIFNpc3RlbWFzIFNBDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8KCnZhciBDb25uZWN0aW9uID0gZnVuY3Rpb24gQ29ubmVjdGlvbihkYXRhT2JqZWN0VXJsKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29ubmVjdGlvbik7CgogICAgdGhpcy5uYW1lID0gJ0Nvbm5lY3Rpb24nOwogICAgdGhpcy5zdGF0dXMgPSAnJzsKICAgIHRoaXMub3duZXIgPSBkYXRhT2JqZWN0VXJsOwogICAgdGhpcy5jb25uZWN0aW9uRGVzY3JpcHRpb24gPSB7fTsKICAgIHRoaXMuaWNlQ2FuZGlkYXRlcyA9IFtdOwp9OwoKLyoqDQogKiBQcm90b1N0dWIgSW50ZXJmYWNlDQogKi8KCgp2YXIgSU1TSVdQcm90b1N0dWIgPSBmdW5jdGlvbiAoKSB7CgogICAgLyoqDQogICAgICogSW5pdGlhbGlzZSB0aGUgcHJvdG9jb2wgc3R1YiBpbmNsdWRpbmcgYXMgaW5wdXQgcGFyYW1ldGVycyBpdHMgYWxsb2NhdGVkDQogICAgICogY29tcG9uZW50IHJ1bnRpbWUgdXJsLCB0aGUgcnVudGltZSBCVVMgcG9zdE1lc3NhZ2UgZnVuY3Rpb24gdG8gYmUgaW52b2tlZA0KICAgICAqIG9uIG1lc3NhZ2VzIHJlY2VpdmVkIGJ5IHRoZSBwcm90b2NvbCBzdHViIGFuZCByZXF1aXJlZCBjb25maWd1cmF0aW9uIHJldHJpZXZlZCBmcm9tIHByb3RvY29sU3R1YiBkZXNjcmlwdG9yLg0KICAgICAqIEBwYXJhbSAge1VSTC5ydW50aW1lUHJvdG9TdHViVVJMfSAgICAgICAgICAgICAgICAgICBydW50aW1lUHJvdG9TdHViVVJMIHJ1bnRpbWVQcm90b1N1YlVSTA0KICAgICAqIEBwYXJhbSAge01lc3NhZ2UuTWVzc2FnZX0gICAgICAgICAgICAgICAgICAgICAgICAgICBidXNQb3N0TWVzc2FnZSAgICAgY29uZmlndXJhdGlvbg0KICAgICAqIEBwYXJhbSAge1Byb3RvU3R1YkRlc2NyaXB0b3IuQ29uZmlndXJhdGlvbkRhdGFMaXN0fSBjb25maWd1cmF0aW9uICAgICAgY29uZmlndXJhdGlvbg0KICAgICAqLwogICAgZnVuY3Rpb24gSU1TSVdQcm90b1N0dWIocnVudGltZVByb3RvU3R1YlVSTCwgbWluaUJ1cywgY29uZmlndXJhdGlvbikgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJTVNJV1Byb3RvU3R1Yik7CgogICAgICAgIGlmICghcnVudGltZVByb3RvU3R1YlVSTCkgdGhyb3cgbmV3IEVycm9yKCdUaGUgcnVudGltZVByb3RvU3R1YlVSTCBpcyBhIHJlcXVpcmVkIHBhcmFtZXRlcicpOwogICAgICAgIGlmICghbWluaUJ1cykgdGhyb3cgbmV3IEVycm9yKCdUaGUgYnVzIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyJyk7CiAgICAgICAgaWYgKCFjb25maWd1cmF0aW9uKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb25maWd1cmF0aW9uIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyJyk7CgogICAgICAgIHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwgPSBydW50aW1lUHJvdG9TdHViVVJMOwogICAgICAgIHRoaXMuX2Nvbm5lY3Rpb24gPSBuZXcgX0Nvbm5lY3Rpb25Db250cm9sbGVyMi5kZWZhdWx0KGNvbmZpZ3VyYXRpb24pOwogICAgICAgIHRoaXMuX2J1cyA9IG1pbmlCdXM7CiAgICAgICAgdGhpcy5fc3luY2hlciA9IG5ldyBfU3luY2hlci5TeW5jaGVyKHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwsIG1pbmlCdXMsIGNvbmZpZ3VyYXRpb24pOwoKICAgICAgICBtaW5pQnVzLmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24gKG1zZykgewogICAgICAgICAgICBjb25zb2xlLmxvZygnTkVXIE1TRyAtPicsIG1zZyk7CiAgICAgICAgICAgIGlmIChtc2cuYm9keS5pZGVudGl0eSAmJiBfdGhpcy5fZmlsdGVyKG1zZykgJiYgbXNnLmJvZHkuc2NoZW1hKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5fc3Vic2NyaWJlKG1zZyk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KCiAgICBfY3JlYXRlQ2xhc3MoSU1TSVdQcm90b1N0dWIsIFt7CiAgICAgICAga2V5OiAnX3N1YnNjcmliZScsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zdWJzY3JpYmUobXNnKSB7CiAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgICAgICAgdmFyIHNjaGVtYSA9IG1zZy5ib2R5LnNjaGVtYTsKICAgICAgICAgICAgdmFyIGRhdGFPYmplY3RVcmwgPSBtc2cuZnJvbS5zdWJzdHJpbmcoMCwgbXNnLmZyb20ubGFzdEluZGV4T2YoJy8nKSk7CgogICAgICAgICAgICB0aGlzLl9zeW5jaGVyLnN1YnNjcmliZShzY2hlbWEsIGRhdGFPYmplY3RVcmwpLnRoZW4oZnVuY3Rpb24gKGRhdGFPYmplY3RPYnNlcnZlcikgewogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5fb25DYWxsKGRhdGFPYmplY3RPYnNlcnZlciwgZGF0YU9iamVjdFVybCwgc2NoZW1hLCBtc2cpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9LCB7CiAgICAgICAga2V5OiAnX29uQ2FsbCcsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNhbGwoZGF0YU9iamVjdE9ic2VydmVyLCBkYXRhT2JqZWN0VXJsLCBzY2hlbWEsIG1zZykgewogICAgICAgICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjYWxsJywgZGF0YU9iamVjdE9ic2VydmVyKTsKICAgICAgICAgICAgdGhpcy5fY29ubmVjdGlvbi5jb25uZWN0KG1zZy5ib2R5LmlkZW50aXR5KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBjb250ZXh0ID0gX3RoaXMzLl9jb25uZWN0aW9uLmludml0ZShtc2cudG8sIGRhdGFPYmplY3RPYnNlcnZlcik7CiAgICAgICAgICAgICAgICBjb250ZXh0Lm9uKCdhY2NlcHRlZCcsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5fcmV0dXJuU0RQKGUsIGRhdGFPYmplY3RVcmwsIHNjaGVtYSwgbXNnKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29udGV4dC5vbignZmFpbCcsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKCdmYWlsJywgZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGNvbnRleHQub24oJ3JlamVjdGVkJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc29sZS5sb2coJ3JlamVjdGVkJywgZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfSwgewogICAgICAgIGtleTogJ19yZXR1cm5TRFAnLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcmV0dXJuU0RQKGUsIGRhdGFPYmplY3RVcmwsIHNjaGVtYSwgbXNnKSB7CiAgICAgICAgICAgIHZhciBkYXRhT2JqZWN0ID0gbmV3IENvbm5lY3Rpb24oZGF0YU9iamVjdFVybCk7CgogICAgICAgICAgICB0aGlzLl9zeW5jaGVyLmNyZWF0ZShzY2hlbWEsIFttc2cuYm9keS5zb3VyY2VdLCBkYXRhT2JqZWN0KS50aGVuKGZ1bmN0aW9uIChvYmpSZXBvcnRlcikgewogICAgICAgICAgICAgICAgb2JqUmVwb3J0ZXIub25TdWJzY3JpcHRpb24oZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKCctLS0tLS0tLSBSZWNlaXZlciByZWNlaXZlZCBzdWJzY3JpcHRpb24gcmVxdWVzdCAtLS0tLS0tLS0gXG4nKTsKICAgICAgICAgICAgICAgICAgICBldmVudC5hY2NlcHQoKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgb2JqUmVwb3J0ZXIuZGF0YS5jb25uZWN0aW9uRGVzY3JpcHRpb24gPSB7IHR5cGU6ICdhbnN3ZXInLCBzZHA6IGUuYm9keSB9OwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9LCB7CiAgICAgICAga2V5OiAnX2ZpbHRlcicsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9maWx0ZXIobXNnKSB7CiAgICAgICAgICAgIGlmIChtc2cuYm9keSAmJiBtc2cuYm9keS52aWEgPT09IHRoaXMuX3J1bnRpbWVQcm90b1N0dWJVUkwpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgfV0pOwoKICAgIHJldHVybiBJTVNJV1Byb3RvU3R1YjsKfSgpOwoKZnVuY3Rpb24gYWN0aXZhdGUodXJsLCBidXMsIGNvbmZpZykgewogICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAnSU1TSVdQcm90b1N0dWInLAogICAgICAgIGluc3RhbmNlOiBuZXcgSU1TSVdQcm90b1N0dWIodXJsLCBidXMsIGNvbmZpZykKICAgIH07Cn0KbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsiLi9Db25uZWN0aW9uQ29udHJvbGxlciI6NDEsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvU3luY2hlciI6NX1dLDQzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKJ3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9zaXAgPSByZXF1aXJlKCdzaXAuanMnKTsKCnZhciBfc2lwMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NpcCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKdmFyIFNlc3Npb24gPSBfc2lwMi5kZWZhdWx0LlNlc3Npb247CnZhciBDID0gewogIFNUQVRVU19OVUxMOiAwLAogIFNUQVRVU19JTlZJVEVfU0VOVDogMSwKICBTVEFUVVNfMVhYX1JFQ0VJVkVEOiAyLAogIFNUQVRVU19JTlZJVEVfUkVDRUlWRUQ6IDMsCiAgU1RBVFVTX1dBSVRJTkdfRk9SX0FOU1dFUjogNCwKICBTVEFUVVNfQU5TV0VSRUQ6IDUsCiAgU1RBVFVTX1dBSVRJTkdfRk9SX1BSQUNLOiA2LAogIFNUQVRVU19XQUlUSU5HX0ZPUl9BQ0s6IDcsCiAgU1RBVFVTX0NBTkNFTEVEOiA4LAogIFNUQVRVU19URVJNSU5BVEVEOiA5LAogIFNUQVRVU19BTlNXRVJFRF9XQUlUSU5HX0ZPUl9QUkFDSzogMTAsCiAgU1RBVFVTX0VBUkxZX01FRElBOiAxMSwKICBTVEFUVVNfQ09ORklSTUVEOiAxMgp9OwoKdmFyIEludml0ZUNsaWVudENvbnRleHQgPSBmdW5jdGlvbiBJbnZpdGVDbGllbnRDb250ZXh0KHVhLCB0YXJnZXQsIG9wdGlvbnMpIHsKICBvcHRpb25zID0gT2JqZWN0LmNyZWF0ZShTZXNzaW9uLmRlc3VnYXIob3B0aW9ucykpOwogIG9wdGlvbnMucGFyYW1zID0gT2JqZWN0LmNyZWF0ZShvcHRpb25zLnBhcmFtcyB8fCBPYmplY3QucHJvdG90eXBlKTsKCiAgdmFyIGV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKCiAgLy8gQ3VzdG9tIGRhdGEgdG8gYmUgc2VudCBlaXRoZXIgaW4gSU5WSVRFIG9yIGluIEFDSwogIHRoaXMucmVuZGVyYm9keSA9IG9wdGlvbnMucmVuZGVyYm9keSB8fCBudWxsOwogIHRoaXMucmVuZGVydHlwZSA9IG9wdGlvbnMucmVuZGVydHlwZSB8fCAndGV4dC9wbGFpbic7CgogIHRoaXMuc2RwID0gb3B0aW9ucy5zZHA7CiAgb3B0aW9ucy5wYXJhbXMuZnJvbV90YWcgPSB0aGlzLmZyb21fdGFnOwoKICAvKiBEbyBub3QgYWRkIDtvYiBpbiBpbml0aWFsIGZvcm1pbmcgZGlhbG9nIHJlcXVlc3RzIGlmIHRoZSByZWdpc3RyYXRpb24gb3Zlcg0KICAgKiAgdGhlIGN1cnJlbnQgY29ubmVjdGlvbiBnb3QgYSBHUlVVIFVSSS4NCiAgICovCiAgdGhpcy5jb250YWN0ID0gdWEuY29udGFjdC50b1N0cmluZyh7CiAgICBhbm9ueW1vdXM6IHRoaXMuYW5vbnltb3VzLAogICAgb3V0Ym91bmQ6IHRoaXMuYW5vbnltb3VzID8gIXVhLmNvbnRhY3QudGVtcF9ncnV1IDogIXVhLmNvbnRhY3QucHViX2dydXUKICB9KTsKCiAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRhY3Q6ICcgKyB0aGlzLmNvbnRhY3QpOwogIGV4dHJhSGVhZGVycy5wdXNoKCdBbGxvdzogJyArIF9zaXAyLmRlZmF1bHQuVUEuQy5BTExPV0VEX01FVEhPRFMudG9TdHJpbmcoKSk7CgogIGlmICh1YS5jb25maWd1cmF0aW9uLnJlbDEwMCA9PT0gX3NpcDIuZGVmYXVsdC5DLnN1cHBvcnRlZC5SRVFVSVJFRCkgewogICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JlcXVpcmU6IDEwMHJlbCcpOwogIH0KICBpZiAodWEuY29uZmlndXJhdGlvbi5yZXBsYWNlcyA9PT0gX3NpcDIuZGVmYXVsdC5DLnN1cHBvcnRlZC5SRVFVSVJFRCkgewogICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JlcXVpcmU6IHJlcGxhY2VzJyk7CiAgfQogIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3NkcCcpOwogIG9wdGlvbnMuZXh0cmFIZWFkZXJzID0gZXh0cmFIZWFkZXJzOwoKICBfc2lwMi5kZWZhdWx0LlV0aWxzLmF1Z21lbnQodGhpcywgX3NpcDIuZGVmYXVsdC5DbGllbnRDb250ZXh0LCBbdWEsIF9zaXAyLmRlZmF1bHQuQy5JTlZJVEUsIHRhcmdldCwgb3B0aW9uc10pOwogIF9zaXAyLmRlZmF1bHQuVXRpbHMuYXVnbWVudCh0aGlzLCBfc2lwMi5kZWZhdWx0LlNlc3Npb24sIFtdKTsKCiAgLy8gQ2hlY2sgU2Vzc2lvbiBTdGF0dXMKICBpZiAodGhpcy5zdGF0dXMgIT09IEMuU1RBVFVTX05VTEwpIHsKICAgIHRocm93IG5ldyBfc2lwMi5kZWZhdWx0LkV4Y2VwdGlvbnMuSW52YWxpZFN0YXRlRXJyb3IodGhpcy5zdGF0dXMpOwogIH0KCiAgLy8gU2Vzc2lvbiBwYXJhbWV0ZXIgaW5pdGlhbGl6YXRpb24KICB0aGlzLmZyb21fdGFnID0gX3NpcDIuZGVmYXVsdC5VdGlscy5uZXdUYWcoKTsKCiAgLy8gT3V0Z29pbmdTZXNzaW9uIHNwZWNpZmljIHBhcmFtZXRlcnMKICB0aGlzLmlzQ2FuY2VsZWQgPSBmYWxzZTsKICB0aGlzLnJlY2VpdmVkXzEwMCA9IGZhbHNlOwoKICB0aGlzLm1ldGhvZCA9IF9zaXAyLmRlZmF1bHQuQy5JTlZJVEU7CgogIHRoaXMucmVjZWl2ZU5vbkludml0ZVJlc3BvbnNlID0gdGhpcy5yZWNlaXZlUmVzcG9uc2U7CiAgdGhpcy5yZWNlaXZlUmVzcG9uc2UgPSB0aGlzLnJlY2VpdmVJbnZpdGVSZXNwb25zZTsKCiAgdGhpcy5sb2dnZXIgPSB1YS5nZXRMb2dnZXIoJ3NpcC5pbnZpdGVjbGllbnRjb250ZXh0Jyk7CgogIHRoaXMub25JbmZvID0gb3B0aW9ucy5vbkluZm87Cn07CgpJbnZpdGVDbGllbnRDb250ZXh0LnByb3RvdHlwZSA9IHsKICBpbnZpdGU6IGZ1bmN0aW9uIGludml0ZSgpIHsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAvL1NhdmUgdGhlIHNlc3Npb24gaW50byB0aGUgdWEgc2Vzc2lvbnMgY29sbGVjdGlvbi4KICAgIC8vTm90ZTogcGxhY2luZyBpbiBjb25zdHJ1Y3RvciBicmVha3MgY2FsbCB0byByZXF1ZXN0LmNhbmNlbCBvbiBjbG9zZS4uLiBVc2VyIGRvZXMgbm90IG5lZWQgdGhpcyBhbnl3YXkKICAgIHRoaXMudWEuc2Vzc2lvbnNbdGhpcy5pZF0gPSB0aGlzOwoKICAgIC8vTm90ZTogZHVlIHRvIHRoZSB3YXkgRmlyZWZveCBoYW5kbGVzIGdVTSBjYWxscywgaXQgaXMgcmVjb21tZW5kZWQgdG8gbWFrZSB0aGUgZ1VNIGNhbGwgYXQgdGhlIGFwcCBsZXZlbAogICAgLy8gYW5kIGhhbmQgc2lwLmpzIGEgc3RyZWFtIGFzIHRoZSBtZWRpYUhpbnQKICAgIGlmIChzZWxmLmlzQ2FuY2VsZWQgfHwgc2VsZi5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgc2VsZi5oYXNPZmZlciA9IHRydWU7CiAgICBzZWxmLnJlcXVlc3QuYm9keSA9IHRoaXMuc2RwOwogICAgc2VsZi5zdGF0dXMgPSBDLlNUQVRVU19JTlZJVEVfU0VOVDsKICAgIHNlbGYuc2VuZCgpOwoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIGhhc0Rlc2NyaXB0aW9uOiBmdW5jdGlvbiBoYXNEZXNjcmlwdGlvbihtZXNzYWdlKSB7CiAgICByZXR1cm4gbWVzc2FnZS5nZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScpID09PSAnYXBwbGljYXRpb24vc2RwJyAmJiAhIW1lc3NhZ2UuYm9keTsKICB9LAoKICByZWNlaXZlSW52aXRlUmVzcG9uc2U6IGZ1bmN0aW9uIHJlY2VpdmVJbnZpdGVSZXNwb25zZShyZXNwb25zZSkgewogICAgdmFyIGNhdXNlLAogICAgICAgIC8vbG9jYWxNZWRpYSwKICAgIHNlc3Npb24gPSB0aGlzLAogICAgICAgIGlkID0gcmVzcG9uc2UuY2FsbF9pZCArIHJlc3BvbnNlLmZyb21fdGFnICsgcmVzcG9uc2UudG9fdGFnLAogICAgICAgIGV4dHJhSGVhZGVycyA9IFtdLAogICAgICAgIG9wdGlvbnMgPSB7fTsKCiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQgfHwgcmVzcG9uc2UubWV0aG9kICE9PSBfc2lwMi5kZWZhdWx0LkMuSU5WSVRFKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy5kaWFsb2cgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlIDw9IDI5OSkgewogICAgICBpZiAoaWQgIT09IHRoaXMuZGlhbG9nLmlkLnRvU3RyaW5nKCkpIHsKICAgICAgICBpZiAoIXRoaXMuY3JlYXRlRGlhbG9nKHJlc3BvbnNlLCAnVUFDJywgdHJ1ZSkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnNlbmRSZXF1ZXN0KHRoaXMsIF9zaXAyLmRlZmF1bHQuQy5BQ0ssIHsKICAgICAgICAgIGJvZHk6IF9zaXAyLmRlZmF1bHQuVXRpbHMuZ2VuZXJhdGVGYWtlU0RQKHJlc3BvbnNlLmJvZHkpCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnNlbmRSZXF1ZXN0KHRoaXMsIF9zaXAyLmRlZmF1bHQuQy5CWUUpOwoKICAgICAgICAvKiBOT1RFOiBUaGlzIGZhaWxzIGJlY2F1c2UgdGhlIGZvcmtpbmcgcHJveHkgZG9lcyBub3QgcmVjb2duaXplIHRoYXQgYW4gdW5hbnN3ZXJhYmxlDQogICAgICAgICAqIGxlZyAoZHVlIHRvIHBlZXJDb25uZWN0aW9uIGxpbWl0YXRpb25zKSBoYXMgYmVlbiBhbnN3ZXJlZCBmaXJzdC4gSWYgeW91ciBmb3JraW5nDQogICAgICAgICAqIHByb3h5IGRvZXMgbm90IGhhbmcgdXAgYWxsIHVuYW5zd2VyZWQgYnJhbmNoZXMgb24gdGhlIGZpcnN0IGJyYW5jaCBhbnN3ZXJlZCwgcmVtb3ZlIHRoaXMuDQogICAgICAgICAqLwogICAgICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgICAgICB0aGlzLmZhaWxlZChyZXNwb25zZSwgX3NpcDIuZGVmYXVsdC5DLmNhdXNlcy5XRUJSVENfRVJST1IpOwogICAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlc3BvbnNlLCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLldFQlJUQ19FUlJPUik7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChfc2lwMi5kZWZhdWx0LkMuQUNLLCB7IGNzZXE6IHJlc3BvbnNlLmNzZXEgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLmhhc0Fuc3dlcikgewogICAgICAgIC8vIGludml0ZSB3L28gc2RwIGlzIHdhaXRpbmcgZm9yIGNhbGxiYWNrCiAgICAgICAgLy9hbiBpbnZpdGUgd2l0aCBzZHAgbXVzdCBnbyBvbiwgYW5kIGhhc0Fuc3dlciBpcyB0cnVlCiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CgogICAgaWYgKHRoaXMuZGlhbG9nICYmIHJlc3BvbnNlLnN0YXR1c19jb2RlIDwgMjAwKSB7CiAgICAgIC8qDQogICAgICAgIEVhcmx5IG1lZGlhIGhhcyBiZWVuIHNldCB1cCB3aXRoIGF0IGxlYXN0IG9uZSBvdGhlciBkaWZmZXJlbnQgYnJhbmNoLA0KICAgICAgICBidXQgYSBmaW5hbCAyeHggcmVzcG9uc2UgaGFzbid0IGJlZW4gcmVjZWl2ZWQNCiAgICAgICovCiAgICAgIGlmICh0aGlzLmRpYWxvZy5wcmFja2VkLmluZGV4T2YocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpICE9PSAtMSB8fCB0aGlzLmRpYWxvZy5wcmFja2VkW3RoaXMuZGlhbG9nLnByYWNrZWQubGVuZ3RoIC0gMV0gPj0gcmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykgJiYgdGhpcy5kaWFsb2cucHJhY2tlZC5sZW5ndGggPiAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuZWFybHlEaWFsb2dzW2lkXSAmJiAhdGhpcy5jcmVhdGVEaWFsb2cocmVzcG9uc2UsICdVQUMnLCB0cnVlKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLmluZGV4T2YocmVzcG9uc2UuZ2V0SGVhZGVyKCdyc2VxJykpICE9PSAtMSB8fCB0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZFt0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5sZW5ndGggLSAxXSA+PSByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSAmJiB0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5sZW5ndGggPiAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBleHRyYUhlYWRlcnMucHVzaCgnUkFjazogJyArIHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpICsgJyAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdjc2VxJykpOwogICAgICB0aGlzLmVhcmx5RGlhbG9nc1tpZF0ucHJhY2tlZC5wdXNoKHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpKTsKCiAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5zZW5kUmVxdWVzdCh0aGlzLCBfc2lwMi5kZWZhdWx0LkMuUFJBQ0ssIHsKICAgICAgICBleHRyYUhlYWRlcnM6IGV4dHJhSGVhZGVycywKICAgICAgICBib2R5OiBfc2lwMi5kZWZhdWx0LlV0aWxzLmdlbmVyYXRlRmFrZVNEUChyZXNwb25zZS5ib2R5KQogICAgICB9KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIFByb2NlZWQgdG8gY2FuY2VsbGF0aW9uIGlmIHRoZSB1c2VyIHJlcXVlc3RlZC4KICAgIGlmICh0aGlzLmlzQ2FuY2VsZWQpIHsKICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c19jb2RlID49IDEwMCAmJiByZXNwb25zZS5zdGF0dXNfY29kZSA8IDIwMCkgewogICAgICAgIHRoaXMucmVxdWVzdC5jYW5jZWwodGhpcy5jYW5jZWxSZWFzb24sIGV4dHJhSGVhZGVycyk7CiAgICAgICAgdGhpcy5jYW5jZWxlZChudWxsKTsKICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXNfY29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPCAyOTkpIHsKICAgICAgICB0aGlzLmFjY2VwdEFuZFRlcm1pbmF0ZShyZXNwb25zZSk7CiAgICAgICAgdGhpcy5lbWl0KCdieWUnLCB0aGlzLnJlcXVlc3QpOwogICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLnN0YXR1c19jb2RlID49IDMwMCkgewogICAgICAgIGNhdXNlID0gX3NpcDIuZGVmYXVsdC5DLlJFQVNPTl9QSFJBU0VbcmVzcG9uc2Uuc3RhdHVzX2NvZGVdIHx8IF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuQ0FOQ0VMRUQ7CiAgICAgICAgdGhpcy5yZWplY3RlZChyZXNwb25zZSwgY2F1c2UpOwogICAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgICAgdGhpcy50ZXJtaW5hdGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgIH0KICAgICAgcmV0dXJuOwogICAgfQoKICAgIHN3aXRjaCAodHJ1ZSkgewogICAgICBjYXNlIC9eMTAwJC8udGVzdChyZXNwb25zZS5zdGF0dXNfY29kZSk6CiAgICAgICAgdGhpcy5yZWNlaXZlZF8xMDAgPSB0cnVlOwogICAgICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCByZXNwb25zZSk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgL14xWzAtOV17Mn0kLy50ZXN0KHJlc3BvbnNlLnN0YXR1c19jb2RlKToKICAgICAgICAvLyBEbyBub3RoaW5nIHdpdGggMXh4IHJlc3BvbnNlcyB3aXRob3V0IFRvIHRhZy4KICAgICAgICBpZiAoIXJlc3BvbnNlLnRvX3RhZykgewogICAgICAgICAgdGhpcy5sb2dnZXIud2FybignMXh4IHJlc3BvbnNlIHJlY2VpdmVkIHdpdGhvdXQgdG8gdGFnJyk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIC8vIENyZWF0ZSBFYXJseSBEaWFsb2cgaWYgMVhYIGNvbWVzIHdpdGggY29udGFjdAogICAgICAgIGlmIChyZXNwb25zZS5oYXNIZWFkZXIoJ2NvbnRhY3QnKSkgewogICAgICAgICAgLy8gQW4gZXJyb3Igb24gZGlhbG9nIGNyZWF0aW9uIHdpbGwgZmlyZSAnZmFpbGVkJyBldmVudAogICAgICAgICAgaWYgKCF0aGlzLmNyZWF0ZURpYWxvZyhyZXNwb25zZSwgJ1VBQycsIHRydWUpKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU18xWFhfUkVDRUlWRUQ7CgogICAgICAgIGlmIChyZXNwb25zZS5oYXNIZWFkZXIoJ3JlcXVpcmUnKSAmJiByZXNwb25zZS5nZXRIZWFkZXIoJ3JlcXVpcmUnKS5pbmRleE9mKCcxMDByZWwnKSAhPT0gLTEpIHsKCiAgICAgICAgICAvLyBEbyBub3RoaW5nIGlmIHRoaXMuZGlhbG9nIGlzIGFscmVhZHkgY29uZmlybWVkCiAgICAgICAgICBpZiAodGhpcy5kaWFsb2cgfHwgIXRoaXMuZWFybHlEaWFsb2dzW2lkXSkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQuaW5kZXhPZihyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSkgIT09IC0xIHx8IHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkW3RoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLmxlbmd0aCAtIDFdID49IHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpICYmIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5wcmFja2VkLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghdGhpcy5oYXNEZXNjcmlwdGlvbihyZXNwb25zZSkpIHsKICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ1JBY2s6ICcgKyByZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSArICcgJyArIHJlc3BvbnNlLmdldEhlYWRlcignY3NlcScpKTsKICAgICAgICAgICAgdGhpcy5lYXJseURpYWxvZ3NbaWRdLnByYWNrZWQucHVzaChyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSk7CiAgICAgICAgICAgIHRoaXMuZWFybHlEaWFsb2dzW2lkXS5zZW5kUmVxdWVzdCh0aGlzLCBfc2lwMi5kZWZhdWx0LkMuUFJBQ0ssIHsKICAgICAgICAgICAgICBleHRyYUhlYWRlcnM6IGV4dHJhSGVhZGVycwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5lbWl0KCdwcm9ncmVzcycsIHJlc3BvbnNlKTsKICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5oYXNPZmZlcikgewogICAgICAgICAgICBpZiAoIXRoaXMuY3JlYXRlRGlhbG9nKHJlc3BvbnNlLCAnVUFDJykpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmhhc0Fuc3dlciA9IHRydWU7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nLnByYWNrZWQucHVzaChyZXNwb25zZS5nZXRIZWFkZXIoJ3JzZXEnKSk7CgogICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnUkFjazogJyArIHJlc3BvbnNlLmdldEhlYWRlcigncnNlcScpICsgJyAnICsgcmVzcG9uc2UuZ2V0SGVhZGVyKCdjc2VxJykpOwoKICAgICAgICAgICAgc2Vzc2lvbi5zZW5kUmVxdWVzdChfc2lwMi5kZWZhdWx0LkMuUFJBQ0ssIHsKICAgICAgICAgICAgICBleHRyYUhlYWRlcnM6IGV4dHJhSGVhZGVycywKICAgICAgICAgICAgICByZWNlaXZlUmVzcG9uc2U6IGZ1bmN0aW9uIHJlY2VpdmVSZXNwb25zZSgpIHt9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBzZXNzaW9uLnN0YXR1cyA9IEMuU1RBVFVTX0VBUkxZX01FRElBOwogICAgICAgICAgICBzZXNzaW9uLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmVtaXQoJ3Byb2dyZXNzJywgcmVzcG9uc2UpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAvXjJbMC05XXsyfSQvLnRlc3QocmVzcG9uc2Uuc3RhdHVzX2NvZGUpOgogICAgICAgIHZhciBjc2VxID0gdGhpcy5yZXF1ZXN0LmNzZXEgKyAnICcgKyB0aGlzLnJlcXVlc3QubWV0aG9kOwogICAgICAgIGlmIChjc2VxICE9PSByZXNwb25zZS5nZXRIZWFkZXIoJ2NzZXEnKSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0VBUkxZX01FRElBICYmIHRoaXMuZGlhbG9nKSB7CiAgICAgICAgICB0aGlzLnN0YXR1cyA9IEMuU1RBVFVTX0NPTkZJUk1FRDsKICAgICAgICAgIG9wdGlvbnMgPSB7fTsKICAgICAgICAgIGlmICh0aGlzLnJlbmRlcmJvZHkpIHsKICAgICAgICAgICAgZXh0cmFIZWFkZXJzLnB1c2goJ0NvbnRlbnQtVHlwZTogJyArIHRoaXMucmVuZGVydHlwZSk7CiAgICAgICAgICAgIG9wdGlvbnMuZXh0cmFIZWFkZXJzID0gZXh0cmFIZWFkZXJzOwogICAgICAgICAgICBvcHRpb25zLmJvZHkgPSB0aGlzLnJlbmRlcmJvZHk7CiAgICAgICAgICB9CiAgICAgICAgICBvcHRpb25zLmNzZXEgPSByZXNwb25zZS5jc2VxOwogICAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChfc2lwMi5kZWZhdWx0LkMuQUNLLCBvcHRpb25zKTsKICAgICAgICAgIHRoaXMuYWNjZXB0ZWQocmVzcG9uc2UpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIC8vIERvIG5vdGhpbmcgaWYgdGhpcy5kaWFsb2cgaXMgYWxyZWFkeSBjb25maXJtZWQKICAgICAgICBpZiAodGhpcy5kaWFsb2cpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuaGFzQW5zd2VyKSB7CiAgICAgICAgICBpZiAodGhpcy5yZW5kZXJib2R5KSB7CiAgICAgICAgICAgIGV4dHJhSGVhZGVycy5wdXNoKCdDb250ZW50LVR5cGU6ICcgKyBzZXNzaW9uLnJlbmRlcnR5cGUpOwogICAgICAgICAgICBvcHRpb25zLmV4dHJhSGVhZGVycyA9IGV4dHJhSGVhZGVyczsKICAgICAgICAgICAgb3B0aW9ucy5ib2R5ID0gdGhpcy5yZW5kZXJib2R5OwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChfc2lwMi5kZWZhdWx0LkMuQUNLLCBvcHRpb25zKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKCF0aGlzLmhhc0Rlc2NyaXB0aW9uKHJlc3BvbnNlKSkgewogICAgICAgICAgICB0aGlzLmFjY2VwdEFuZFRlcm1pbmF0ZShyZXNwb25zZSwgNDAwLCAnTWlzc2luZyBzZXNzaW9uIGRlc2NyaXB0aW9uJyk7CiAgICAgICAgICAgIHRoaXMuZmFpbGVkKHJlc3BvbnNlLCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLkJBRF9NRURJQV9ERVNDUklQVElPTik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgaWYgKCF0aGlzLmNyZWF0ZURpYWxvZyhyZXNwb25zZSwgJ1VBQycpKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5oYXNBbnN3ZXIgPSB0cnVlOwogICAgICAgICAgdmFyIG9wdGlvbnMgPSB7fTsgLy8sbG9jYWxNZWRpYTsKICAgICAgICAgIHNlc3Npb24uc3RhdHVzID0gQy5TVEFUVVNfQ09ORklSTUVEOwogICAgICAgICAgaWYgKHNlc3Npb24ucmVuZGVyYm9keSkgewogICAgICAgICAgICBleHRyYUhlYWRlcnMucHVzaCgnQ29udGVudC1UeXBlOiAnICsgc2Vzc2lvbi5yZW5kZXJ0eXBlKTsKICAgICAgICAgICAgb3B0aW9ucy5leHRyYUhlYWRlcnMgPSBleHRyYUhlYWRlcnM7CiAgICAgICAgICAgIG9wdGlvbnMuYm9keSA9IHNlc3Npb24ucmVuZGVyYm9keTsKICAgICAgICAgIH0KICAgICAgICAgIG9wdGlvbnMuY3NlcSA9IHJlc3BvbnNlLmNzZXE7CiAgICAgICAgICBzZXNzaW9uLnNlbmRSZXF1ZXN0KF9zaXAyLmRlZmF1bHQuQy5BQ0ssIG9wdGlvbnMpOwogICAgICAgICAgc2Vzc2lvbi5hY2NlcHRlZChyZXNwb25zZSk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIGNhdXNlID0gX3NpcDIuZGVmYXVsdC5VdGlscy5zaXBFcnJvckNhdXNlKHJlc3BvbnNlLnN0YXR1c19jb2RlKTsKICAgICAgICB0aGlzLnJlamVjdGVkKHJlc3BvbnNlLCBjYXVzZSk7CiAgICAgICAgdGhpcy5mYWlsZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgICAgICB0aGlzLnRlcm1pbmF0ZWQocmVzcG9uc2UsIGNhdXNlKTsKICAgIH0KICB9LAoKICBjYW5jZWw6IGZ1bmN0aW9uIGNhbmNlbChvcHRpb25zKSB7CiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAgICBvcHRpb25zLmV4dHJhSGVhZGVycyA9IChvcHRpb25zLmV4dHJhSGVhZGVycyB8fCBbXSkuc2xpY2UoKTsKCiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19URVJNSU5BVEVEIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19DT05GSVJNRUQpIHsKICAgICAgdGhyb3cgbmV3IF9zaXAyLmRlZmF1bHQuRXhjZXB0aW9ucy5JbnZhbGlkU3RhdGVFcnJvcih0aGlzLnN0YXR1cyk7CiAgICB9CgogICAgdGhpcy5sb2dnZXIubG9nKCdjYW5jZWxpbmcgUlRDU2Vzc2lvbicpOwoKICAgIHZhciBjYW5jZWxfcmVhc29uID0gX3NpcDIuZGVmYXVsdC5VdGlscy5nZXRDYW5jZWxSZWFzb24ob3B0aW9ucy5zdGF0dXNfY29kZSwgb3B0aW9ucy5yZWFzb25fcGhyYXNlKTsKCiAgICAvLyBDaGVjayBTZXNzaW9uIFN0YXR1cwogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19OVUxMIHx8IHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19JTlZJVEVfU0VOVCAmJiAhdGhpcy5yZWNlaXZlZF8xMDApIHsKICAgICAgdGhpcy5pc0NhbmNlbGVkID0gdHJ1ZTsKICAgICAgdGhpcy5jYW5jZWxSZWFzb24gPSBjYW5jZWxfcmVhc29uOwogICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfSU5WSVRFX1NFTlQgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTXzFYWF9SRUNFSVZFRCB8fCB0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfRUFSTFlfTUVESUEpIHsKICAgICAgdGhpcy5yZXF1ZXN0LmNhbmNlbChjYW5jZWxfcmVhc29uLCBvcHRpb25zLmV4dHJhSGVhZGVycyk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuY2FuY2VsZWQoKTsKICB9LAoKICB0ZXJtaW5hdGU6IGZ1bmN0aW9uIHRlcm1pbmF0ZShvcHRpb25zKSB7CiAgICBpZiAodGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX1RFUk1JTkFURUQpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgaWYgKHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0sgfHwgdGhpcy5zdGF0dXMgPT09IEMuU1RBVFVTX0NPTkZJUk1FRCkgewogICAgICB0aGlzLmJ5ZShvcHRpb25zKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuY2FuY2VsKG9wdGlvbnMpOwogICAgfQoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIHJlY2VpdmVSZXF1ZXN0OiBmdW5jdGlvbiByZWNlaXZlUmVxdWVzdChyZXF1ZXN0KSB7CiAgICAvLyBJQ0MgUkVDRUlWRSBSRVFVRVNUCgogICAgLy8gUmVqZWN0IENBTkNFTHMKICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gX3NpcDIuZGVmYXVsdC5DLkNBTkNFTCkgewogICAgICAvLyBUT0RPOyBtYWtlIHRoaXMgYSBzd2l0Y2ggd2hlbiBpdCBnZXRzIGFkZGVkCiAgICB9CgogICAgaWYgKHJlcXVlc3QubWV0aG9kID09PSBfc2lwMi5kZWZhdWx0LkMuQUNLICYmIHRoaXMuc3RhdHVzID09PSBDLlNUQVRVU19XQUlUSU5HX0ZPUl9BQ0spIHsKICAgICAgX3NpcDIuZGVmYXVsdC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmFja1RpbWVyKTsKICAgICAgX3NpcDIuZGVmYXVsdC5UaW1lcnMuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmludml0ZTJ4eFRpbWVyKTsKICAgICAgdGhpcy5zdGF0dXMgPSBDLlNUQVRVU19DT05GSVJNRUQ7CgogICAgICB0aGlzLmFjY2VwdGVkKCk7CiAgICB9CgogICAgcmV0dXJuIFNlc3Npb24ucHJvdG90eXBlLnJlY2VpdmVSZXF1ZXN0LmFwcGx5KHRoaXMsIFtyZXF1ZXN0XSk7CiAgfSwKCiAgb25UcmFuc3BvcnRFcnJvcjogZnVuY3Rpb24gb25UcmFuc3BvcnRFcnJvcigpIHsKICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gQy5TVEFUVVNfQ09ORklSTUVEICYmIHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKG51bGwsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuQ09OTkVDVElPTl9FUlJPUik7CiAgICB9CiAgfSwKCiAgb25SZXF1ZXN0VGltZW91dDogZnVuY3Rpb24gb25SZXF1ZXN0VGltZW91dCgpIHsKICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQy5TVEFUVVNfQ09ORklSTUVEKSB7CiAgICAgIHRoaXMudGVybWluYXRlZChudWxsLCBfc2lwMi5kZWZhdWx0LkMuY2F1c2VzLlJFUVVFU1RfVElNRU9VVCk7CiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzICE9PSBDLlNUQVRVU19URVJNSU5BVEVEKSB7CiAgICAgIHRoaXMuZmFpbGVkKG51bGwsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgICAgdGhpcy50ZXJtaW5hdGVkKG51bGwsIF9zaXAyLmRlZmF1bHQuQy5jYXVzZXMuUkVRVUVTVF9USU1FT1VUKTsKICAgIH0KICB9Cgp9OwoKZXhwb3J0cy5kZWZhdWx0ID0gSW52aXRlQ2xpZW50Q29udGV4dDsKbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107Cgp9LHsic2lwLmpzIjo0MH1dLDQ0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsKLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuCi8vCi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhCi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKLy8gIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwovLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQKLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlCi8vIGZvbGxvd2luZyBjb25kaXRpb25zOgovLwovLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZAovLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KLy8KLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MKLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgovLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOCi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLAovLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IKLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRQovLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgoKZnVuY3Rpb24gRXZlbnRFbWl0dGVyKCkgewogIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fTsKICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkOwp9Cm1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyOwoKLy8gQmFja3dhcmRzLWNvbXBhdCB3aXRoIG5vZGUgMC4xMC54CkV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7CgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLl9ldmVudHMgPSB1bmRlZmluZWQ7CkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDsKCi8vIEJ5IGRlZmF1bHQgRXZlbnRFbWl0dGVycyB3aWxsIHByaW50IGEgd2FybmluZyBpZiBtb3JlIHRoYW4gMTAgbGlzdGVuZXJzIGFyZQovLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLgpFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycyA9IDEwOwoKLy8gT2J2aW91c2x5IG5vdCBhbGwgRW1pdHRlcnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gMTAuIFRoaXMgZnVuY3Rpb24gYWxsb3dzCi8vIHRoYXQgdG8gYmUgaW5jcmVhc2VkLiBTZXQgdG8gemVybyBmb3IgdW5saW1pdGVkLgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLnNldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uKG4pIHsKICBpZiAoIWlzTnVtYmVyKG4pIHx8IG4gPCAwIHx8IGlzTmFOKG4pKQogICAgdGhyb3cgVHlwZUVycm9yKCduIG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXInKTsKICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSBuOwogIHJldHVybiB0aGlzOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24odHlwZSkgewogIHZhciBlciwgaGFuZGxlciwgbGVuLCBhcmdzLCBpLCBsaXN0ZW5lcnM7CgogIGlmICghdGhpcy5fZXZlbnRzKQogICAgdGhpcy5fZXZlbnRzID0ge307CgogIC8vIElmIHRoZXJlIGlzIG5vICdlcnJvcicgZXZlbnQgbGlzdGVuZXIgdGhlbiB0aHJvdy4KICBpZiAodHlwZSA9PT0gJ2Vycm9yJykgewogICAgaWYgKCF0aGlzLl9ldmVudHMuZXJyb3IgfHwKICAgICAgICAoaXNPYmplY3QodGhpcy5fZXZlbnRzLmVycm9yKSAmJiAhdGhpcy5fZXZlbnRzLmVycm9yLmxlbmd0aCkpIHsKICAgICAgZXIgPSBhcmd1bWVudHNbMV07CiAgICAgIGlmIChlciBpbnN0YW5jZW9mIEVycm9yKSB7CiAgICAgICAgdGhyb3cgZXI7IC8vIFVuaGFuZGxlZCAnZXJyb3InIGV2ZW50CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gQXQgbGVhc3QgZ2l2ZSBzb21lIGtpbmQgb2YgY29udGV4dCB0byB0aGUgdXNlcgogICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoJ1VuY2F1Z2h0LCB1bnNwZWNpZmllZCAiZXJyb3IiIGV2ZW50LiAoJyArIGVyICsgJyknKTsKICAgICAgICBlcnIuY29udGV4dCA9IGVyOwogICAgICAgIHRocm93IGVycjsKICAgICAgfQogICAgfQogIH0KCiAgaGFuZGxlciA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCiAgaWYgKGlzVW5kZWZpbmVkKGhhbmRsZXIpKQogICAgcmV0dXJuIGZhbHNlOwoKICBpZiAoaXNGdW5jdGlvbihoYW5kbGVyKSkgewogICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7CiAgICAgIC8vIGZhc3QgY2FzZXMKICAgICAgY2FzZSAxOgogICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzKTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAyOgogICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0pOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIDM6CiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTsKICAgICAgICBicmVhazsKICAgICAgLy8gc2xvd2VyCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CiAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKTsKICAgIH0KICB9IGVsc2UgaWYgKGlzT2JqZWN0KGhhbmRsZXIpKSB7CiAgICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKICAgIGxpc3RlbmVycyA9IGhhbmRsZXIuc2xpY2UoKTsKICAgIGxlbiA9IGxpc3RlbmVycy5sZW5ndGg7CiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspCiAgICAgIGxpc3RlbmVyc1tpXS5hcHBseSh0aGlzLCBhcmdzKTsKICB9CgogIHJldHVybiB0cnVlOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7CiAgdmFyIG07CgogIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpCiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpOwoKICBpZiAoIXRoaXMuX2V2ZW50cykKICAgIHRoaXMuX2V2ZW50cyA9IHt9OwoKICAvLyBUbyBhdm9pZCByZWN1cnNpb24gaW4gdGhlIGNhc2UgdGhhdCB0eXBlID09PSAibmV3TGlzdGVuZXIiISBCZWZvcmUKICAvLyBhZGRpbmcgaXQgdG8gdGhlIGxpc3RlbmVycywgZmlyc3QgZW1pdCAibmV3TGlzdGVuZXIiLgogIGlmICh0aGlzLl9ldmVudHMubmV3TGlzdGVuZXIpCiAgICB0aGlzLmVtaXQoJ25ld0xpc3RlbmVyJywgdHlwZSwKICAgICAgICAgICAgICBpc0Z1bmN0aW9uKGxpc3RlbmVyLmxpc3RlbmVyKSA/CiAgICAgICAgICAgICAgbGlzdGVuZXIubGlzdGVuZXIgOiBsaXN0ZW5lcik7CgogIGlmICghdGhpcy5fZXZlbnRzW3R5cGVdKQogICAgLy8gT3B0aW1pemUgdGhlIGNhc2Ugb2Ygb25lIGxpc3RlbmVyLiBEb24ndCBuZWVkIHRoZSBleHRyYSBhcnJheSBvYmplY3QuCiAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjsKICBlbHNlIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pKQogICAgLy8gSWYgd2UndmUgYWxyZWFkeSBnb3QgYW4gYXJyYXksIGp1c3QgYXBwZW5kLgogICAgdGhpcy5fZXZlbnRzW3R5cGVdLnB1c2gobGlzdGVuZXIpOwogIGVsc2UKICAgIC8vIEFkZGluZyB0aGUgc2Vjb25kIGVsZW1lbnQsIG5lZWQgdG8gY2hhbmdlIHRvIGFycmF5LgogICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gW3RoaXMuX2V2ZW50c1t0eXBlXSwgbGlzdGVuZXJdOwoKICAvLyBDaGVjayBmb3IgbGlzdGVuZXIgbGVhawogIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pICYmICF0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkKSB7CiAgICBpZiAoIWlzVW5kZWZpbmVkKHRoaXMuX21heExpc3RlbmVycykpIHsKICAgICAgbSA9IHRoaXMuX21heExpc3RlbmVyczsKICAgIH0gZWxzZSB7CiAgICAgIG0gPSBFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVyczsKICAgIH0KCiAgICBpZiAobSAmJiBtID4gMCAmJiB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoID4gbSkgewogICAgICB0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkID0gdHJ1ZTsKICAgICAgY29uc29sZS5lcnJvcignKG5vZGUpIHdhcm5pbmc6IHBvc3NpYmxlIEV2ZW50RW1pdHRlciBtZW1vcnkgJyArCiAgICAgICAgICAgICAgICAgICAgJ2xlYWsgZGV0ZWN0ZWQuICVkIGxpc3RlbmVycyBhZGRlZC4gJyArCiAgICAgICAgICAgICAgICAgICAgJ1VzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvIGluY3JlYXNlIGxpbWl0LicsCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLmxlbmd0aCk7CiAgICAgIGlmICh0eXBlb2YgY29uc29sZS50cmFjZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIC8vIG5vdCBzdXBwb3J0ZWQgaW4gSUUgMTAKICAgICAgICBjb25zb2xlLnRyYWNlKCk7CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiB0aGlzOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXI7CgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikgewogIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpCiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpOwoKICB2YXIgZmlyZWQgPSBmYWxzZTsKCiAgZnVuY3Rpb24gZygpIHsKICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgZyk7CgogICAgaWYgKCFmaXJlZCkgewogICAgICBmaXJlZCA9IHRydWU7CiAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CiAgfQoKICBnLmxpc3RlbmVyID0gbGlzdGVuZXI7CiAgdGhpcy5vbih0eXBlLCBnKTsKCiAgcmV0dXJuIHRoaXM7Cn07CgovLyBlbWl0cyBhICdyZW1vdmVMaXN0ZW5lcicgZXZlbnQgaWZmIHRoZSBsaXN0ZW5lciB3YXMgcmVtb3ZlZApFdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHsKICB2YXIgbGlzdCwgcG9zaXRpb24sIGxlbmd0aCwgaTsKCiAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSkKICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7CgogIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pCiAgICByZXR1cm4gdGhpczsKCiAgbGlzdCA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKICBsZW5ndGggPSBsaXN0Lmxlbmd0aDsKICBwb3NpdGlvbiA9IC0xOwoKICBpZiAobGlzdCA9PT0gbGlzdGVuZXIgfHwKICAgICAgKGlzRnVuY3Rpb24obGlzdC5saXN0ZW5lcikgJiYgbGlzdC5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7CiAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdOwogICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikKICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTsKCiAgfSBlbHNlIGlmIChpc09iamVjdChsaXN0KSkgewogICAgZm9yIChpID0gbGVuZ3RoOyBpLS0gPiAwOykgewogICAgICBpZiAobGlzdFtpXSA9PT0gbGlzdGVuZXIgfHwKICAgICAgICAgIChsaXN0W2ldLmxpc3RlbmVyICYmIGxpc3RbaV0ubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkgewogICAgICAgIHBvc2l0aW9uID0gaTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGlmIChwb3NpdGlvbiA8IDApCiAgICAgIHJldHVybiB0aGlzOwoKICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMSkgewogICAgICBsaXN0Lmxlbmd0aCA9IDA7CiAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07CiAgICB9IGVsc2UgewogICAgICBsaXN0LnNwbGljZShwb3NpdGlvbiwgMSk7CiAgICB9CgogICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikKICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTsKICB9CgogIHJldHVybiB0aGlzOwp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbih0eXBlKSB7CiAgdmFyIGtleSwgbGlzdGVuZXJzOwoKICBpZiAoIXRoaXMuX2V2ZW50cykKICAgIHJldHVybiB0aGlzOwoKICAvLyBub3QgbGlzdGVuaW5nIGZvciByZW1vdmVMaXN0ZW5lciwgbm8gbmVlZCB0byBlbWl0CiAgaWYgKCF0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpIHsKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKQogICAgICB0aGlzLl9ldmVudHMgPSB7fTsKICAgIGVsc2UgaWYgKHRoaXMuX2V2ZW50c1t0eXBlXSkKICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLy8gZW1pdCByZW1vdmVMaXN0ZW5lciBmb3IgYWxsIGxpc3RlbmVycyBvbiBhbGwgZXZlbnRzCiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsKICAgIGZvciAoa2V5IGluIHRoaXMuX2V2ZW50cykgewogICAgICBpZiAoa2V5ID09PSAncmVtb3ZlTGlzdGVuZXInKSBjb250aW51ZTsKICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoa2V5KTsKICAgIH0KICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCdyZW1vdmVMaXN0ZW5lcicpOwogICAgdGhpcy5fZXZlbnRzID0ge307CiAgICByZXR1cm4gdGhpczsKICB9CgogIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1t0eXBlXTsKCiAgaWYgKGlzRnVuY3Rpb24obGlzdGVuZXJzKSkgewogICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpOwogIH0gZWxzZSBpZiAobGlzdGVuZXJzKSB7CiAgICAvLyBMSUZPIG9yZGVyCiAgICB3aGlsZSAobGlzdGVuZXJzLmxlbmd0aCkKICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnNbbGlzdGVuZXJzLmxlbmd0aCAtIDFdKTsKICB9CiAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTsKCiAgcmV0dXJuIHRoaXM7Cn07CgpFdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uKHR5cGUpIHsKICB2YXIgcmV0OwogIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pCiAgICByZXQgPSBbXTsKICBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoaXMuX2V2ZW50c1t0eXBlXSkpCiAgICByZXQgPSBbdGhpcy5fZXZlbnRzW3R5cGVdXTsKICBlbHNlCiAgICByZXQgPSB0aGlzLl9ldmVudHNbdHlwZV0uc2xpY2UoKTsKICByZXR1cm4gcmV0Owp9OwoKRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24odHlwZSkgewogIGlmICh0aGlzLl9ldmVudHMpIHsKICAgIHZhciBldmxpc3RlbmVyID0gdGhpcy5fZXZlbnRzW3R5cGVdOwoKICAgIGlmIChpc0Z1bmN0aW9uKGV2bGlzdGVuZXIpKQogICAgICByZXR1cm4gMTsKICAgIGVsc2UgaWYgKGV2bGlzdGVuZXIpCiAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDsKICB9CiAgcmV0dXJuIDA7Cn07CgpFdmVudEVtaXR0ZXIubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKGVtaXR0ZXIsIHR5cGUpIHsKICByZXR1cm4gZW1pdHRlci5saXN0ZW5lckNvdW50KHR5cGUpOwp9OwoKZnVuY3Rpb24gaXNGdW5jdGlvbihhcmcpIHsKICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Z1bmN0aW9uJzsKfQoKZnVuY3Rpb24gaXNOdW1iZXIoYXJnKSB7CiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdudW1iZXInOwp9CgpmdW5jdGlvbiBpc09iamVjdChhcmcpIHsKICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsOwp9CgpmdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHsKICByZXR1cm4gYXJnID09PSB2b2lkIDA7Cn0KCn0se31dfSx7fSxbNDJdKSg0MikKfSk7",
      "sourceCodeClassname": "IMSIWProtoStub",
      "encoding": "base64",
      "signature": ""
    },
    "sourcePackageURL": "/sourcePackage",
    "cguid": "4-63d99d6b-5450-81d4-ac0d-2455628f08d35",
    "version": 0.5,
    "description": "Description of IMSIWProtoStub",
    "language": "Javascript",
    "type": "ProtoStubs",
    "objectName": "IMSIWProtoStub",
    "configuration": {
      "credential_server": "https://ims.rethink-project.eu/credential"
    },
    "messageSchemas": "",
    "signature": "",
    "accessControlPolicy": "somePolicy",
    "constraints": {},
    "dataObjects": [],
    "interworking": true
  }
}